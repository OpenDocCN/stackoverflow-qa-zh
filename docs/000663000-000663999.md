# StackOverflow 问答 000663000-000663999

# java - 测试 Java 方法输出的“正确”方法是什么？

> ID：663005
> 
> 赞同：5
> 
> 时间：2009-03-19T16:45:19.693
> 
> 标签：java, unit-testing, testing, junit

在 Python 中，我经常有如下所示的测试：

```
tests = [
    (2, 4),
    (3, 9),
    (10, 100),
]
for (input, expected_output) in tests:
    assert f(input) == expected_output 
```

使用 JUnit 在 Java 中编写这样的测试（指定一组测试用例，然后循环运行每个测试用例）的“正确”方法是什么？

谢谢！

**先发制人的回应**：我意识到我*可以*做类似的事情：

```
assertEquals(4, f(2))
assertEquals(9, f(3))
.... 
```

但是...我希望有更好的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T16:53:08.723

一样。

```
 int[][] tests = {
            {2, 4},
            {3, 9},
            {10, 100}
    };
    for (int[] test : tests) {
        assertEquals(test[1], f(test[0]));
    } 
```

当然不如 python 漂亮，但很少有东西漂亮。

您可能还想研究[JUnit Theories](http://junit.sourceforge.net/doc/ReleaseNotes4.4.html)，这是一个未来的功能......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T17:06:03.793

正确的方法是编写单独的断言语句，即使您不喜欢它。

它避免了不必要的复杂性，并且当它失败时，有时更容易查看哪个值失败（无需启动调试器）。

但是，如果您自动生成测试数据，那就另当别论了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T17:06:39.173

看看 Junit 中的参数化测试运行器。

[http://junit.org/apidocs/org/junit/runners/Parameterized.html](http://junit.org/apidocs/org/junit/runners/Parameterized.html)

看起来它会做你正在寻找的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T16:54:01.857

嗯...

```
int[][] tests = new int[][]{
        {2, 4},
        {3, 9},
        {10, 100},
    };

for(int[] i : tests)
{
    assertEquals(i[1], f(i[0]);
} 
```

一样的，真​​的。唯一的问题是 Java 缺少元组文字，因此对于更复杂的情况，您必须使用 Object[] 数组和强制转换，或者编写一个 Tuple 类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T16:51:26.467

您不会只定义一个包含两个字段（真实结果和预期结果）的简单类，然后以与您的 Python 代码片段类似的方式循环该集合吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T16:53:51.593

Java 中没有元组，但您可以使用 Map 或两个并行数组来指定输入/输出对，然后像 Python 示例一样执行循环。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T17:10:17.340

绝对不是单元测试专家，但我更愿意为我正在测试的每个案例使用单独的方法，并使用一些测试运行工具（如 NUnit-GUI，用于 C#）。这样我就可以确切地知道哪种情况会失败，如果确实如此。它还有更多的工作要做，但我认为它最终会得到很好的回报。

# iphone - 在新的 UIWebView 中打开链接？

> ID：663014
> 
> 赞同：-1
> 
> 时间：2009-03-19T16:47:47.800
> 
> 标签：iphone, objective-c

我在一个窗口中制作了一个带有 Tabbar 和 RSS 阅读器的应用程序。我知道如何在 safari 浏览器的构建中打开 RSS 链接，但是如何在同一选项卡中的 UIWebView 中打开链接呢？我不想退出我的应用程序来查看网页，如何返回 RSS 视图？只需隐藏网页视图？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T17:48:05.160

使用`UIWebViewDelegate`方法：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
```

在那，拦截链接，然后加载你喜欢的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T19:03:07.553

我认为您需要的是导航设置。

你应该有一个导航控制器，它有你的 RSS 阅读器作为它的根视图控制器。然后，每当用户在您的 RSS 提要中选择一个故事时，创建一个新视图控制器的实例，该控制器具有一个 WebView 作为它的视图。然后，您可以将 URL 传递给新的 Web 视图并将 Web 视图“推送”到导航堆栈上。

你所要做的就是告诉 webview 加载你传递给它的 URL，它会做它的事情。

然后当用户完成后，他们所要做的就是点击导航控制器为您创建的后退按钮。

# msbuild - 为什么我从 Membership.GetCurrentUserName 获得 NullReferenceException？

> ID：663018
> 
> 赞同：2
> 
> 时间：2009-03-19T16:50:17.920
> 
> 标签：msbuild, asp.net-membership, nullreferenceexception

我刚刚切换到使用 msbuild 来预编译我的网站，现在我收到了这个奇怪的错误：

我打电话给 Membership.GetUser() ，它抛出：

```
[NullReferenceException: Object reference not set to an instance of an object.]
System.Web.Security.Membership.GetCurrentUserName() +36
System.Web.Security.Membership.GetUser() +7
... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T17:08:17.610

Reflector 显示 Membership.GetCurrentUserName 的实现是：

```
private static string GetCurrentUserName()
{
    if (HostingEnvironment.IsHosted)
    {
        HttpContext current = HttpContext.Current;
        if (current != null)
        {
            return current.User.Identity.Name;
        }
    }
    IPrincipal currentPrincipal = Thread.CurrentPrincipal;
    if ((currentPrincipal != null) && (currentPrincipal.Identity != null))
    {
        return currentPrincipal.Identity.Name;
    }
    return string.Empty;
} 
```

乍一看，最可能的解释是：

*   HttpContext.Current 不为空，并且

*   HttpContext.Current.User 为 null 或具有 null Identity 属性。

所有其他路径似乎都对 null 进行了测试。

所以我建议你跟踪HttpContext.User的类型和内容。

HttpContext.Current.User 是一个 IPrincipal，并且我所知道的 IPrincipal 的大多数具体实现都不允许空标识，所以我打赌 HttpContext.User 为空。

# asp.net - 将图像保存在数据库中时获取图像的高度和宽度

> ID：663025
> 
> 赞同：3
> 
> 时间：2009-03-19T16:52:54.403
> 
> 标签：asp.net, sql, sql-server, vb.net

我使用 ASP.NET(2.0) 将图像保存到我的 SQL Server 数据库中。

(imageData -> image) (imageType -> varchar) (imageLength -> bigint)

因此，imageData 将是“二进制数据”，imageType 将类似于“image/gif”，而 imageLength 将类似于“6458”......

是否可以从我的 ASP.NET 中的 VB.NET 代码中获取图像高度和宽度？我想让我的 web 表单上的图片框与保存在我的数据库中的实际图像的大小相同。

问候艾蒂安

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T16:57:56.153

假设您在流中有数据：

`System.Drawing.Image.FromStream(yourStream).Height`

当您将图像保存到数据库时，您可能会更好地执行此操作，因为我确信加载图像对象不会很便宜。

# 编辑

如果我们将此发送到电子邮件，那么下一个遇到此问题的人将不会记录我们的解决方案。让我们暂时将其保留在论坛中。

我们知道，我是一名 C# 开发人员，所以如果这是一个问题，我不会尝试记住 vb.net 语法，并且您需要帮助转换让我知道。

您有一个 IDataReader 我假设它正在从您的数据库中提取图像或二进制 varbinary 等字段。您需要将其加载到派生自 System.IO.Stream 的对象中。对于我们的目的，MemoryStream 是完美的选择，因为它不需要像磁盘这样的后备存储。

```
System.IO.MemoryStream yourStream = new System.IO.MemoryStream(dr["imgLength"] as byte[]);
System.Drawing.Image yourImage=System.Drawing.Image.FromStream(yourStream);

yourImage.Height;
yourImage.width 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T16:57:52.223

当您最初将图像保存到数据库时，我会将图像的高度和宽度保存在单独的列中。然后，当您执行 select 语句从数据库中读取图像时，您还可以访问数据库中的高度和宽度字段。

或者，您可以在从数据库中加载图像时访问高度和宽度信息，然后在将图像分配给图片框之前设置高度和宽度属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T17:09:53.410

您可以获得高度和宽度，但每次需要该信息时，您都必须使用 system.drawing.image 库将整个图像加载到内存中。

最好在第一次将其保存到数据库时将其保存为单独的字段，这通常是我所做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T16:55:29.840

听起来您希望数据库中还有 2 个字段，即高度和宽度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-05T20:47:40.153

我坚信，在几百 GB 的图像之后，您会发现自己认为文件系统和静态文件 http 服务器比存储图像的数据库更适合。它还允许您使用数千种现有的免费工具来处理、移动、托管等图像。您的数据库可能会很忙，并且不容易集群。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T11:04:49.073

```
Dim mobj_wc As New System.Net.WebClient
Dim obj_BookOriginalImage As System.Drawing.Bitmap
Dim ImageInBytes() As Byte = mobj_wc.DownloadData(mstr_BookURL & mds_BookDetails.Tables(0).Rows(0).Item("BookImage"))

'CREATE A MEMORY STREAM USING THE BYTES
Dim ImageStream As New IO.MemoryStream(ImageInBytes)
obj_BookOriginalImage = New System.Drawing.Bitmap(ImageStream)
mint_ImageWidth = obj_BookOriginalImage.Width 
```

# ruby - 红宝石语法

> ID：663027
> 
> 赞同：42
> 
> 时间：2009-03-19T16:53:34.790
> 
> 标签：ruby, grammar, bnf

我正在寻找 BNF 形式的 Ruby 语法。有**正式**版吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-05-18T21:49:38.040

YACC 语法在 Ruby 源代码中。下载它并运行捆绑的实用程序以获得可读的语法。

```
wget ftp://ftp.ruby-lang.org/pub/ruby/2.0/ruby-2.0.0-p195.tar.gz
tar xvzf ruby-2.0.0-p195.tar.gz
cd ruby-2.0.0-p195
ruby sample/exyacc.rb < parse.y 
```

输出样本（v2.0.0-p195 共 918 行）

```
program         : top_compstmt
                ;

top_compstmt    : top_stmts opt_terms
                ;

top_stmts       : none
                | top_stmt
                | top_stmts terms top_stmt
                | error top_stmt
                ;

top_stmt        : stmt
                | keyword_BEGIN
                  '{' top_compstmt '}'
                ;

bodystmt        : compstmt
                  opt_rescue
                  opt_else
                  opt_ensure
                ;

compstmt        : stmts opt_terms
                ; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-19T16:55:05.397

是的，布法罗大学有一种[Ruby BNF 语法。](http://www.cse.buffalo.edu/~regan/cse305/RubyBNF.pdf)

编辑：我还发现了这种替代的[Ruby BNF 语法](https://web.archive.org/web/20150106021034/http://web.njit.edu/all_topics/Prog_Lang_Docs/html/ruby/yacc.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-07-07T04:29:18.320

还有一个正式版本：Ruby Draft Specification。你可以在那里找到语法。

Ruby 草案规范：[http](http://ruby-std.netlab.jp) ://ruby-std.netlab.jp 。服务器已关闭，但您可以从 [http://www.ipa.go.jp/osc/english/ruby下载它](http://www.ipa.go.jp/osc/english/ruby)

# sharepoint - 有没有可靠的方法来找出 MOSS 2007 中的最后访问日期？

> ID：663029
> 
> 赞同：1
> 
> 时间：2009-03-19T16:53:58.160
> 
> 标签：sharepoint, moss, sharepoint-2007, wss-3.0

站点管理中的站点使用报告没有帮助。我还尝试查询 SQL Db 以读取 daylastaccessed 但这无济于事。对象模型的“GetUsageData”方法仅读取最近 1 个月的数据，“最近日期”值不准确。我还想要一份过去 6 个月的报告。

搜索爬虫也会修改上次访问日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:59:14.937

尝试从 IIS 日志中获取信息。否则编写一个自定义 http 模块来记录新会话（并忽略搜索爬虫）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:17:17.247

IIS 日志是一个很好的建议。如果您已经设置了跟踪系统，则可以将网络跟踪错误添加到您的母版页。

# java - Scala中变量声明中的通用通配符

> ID：663032
> 
> 赞同：19
> 
> 时间：2009-03-19T16:54:12.467
> 
> 标签：java, generics, scala, covariance, contravariance

在 Java 中，我可能会这样做：

```
class MyClass {
    private List<? extends MyInterface> list;

    public void setList(List<MyImpl> l) { list = l; }
} 
```

...假设（`MyImpl implements MyInterface`）当然。

使用**Scala**中的类似物是`Buffer`什么？

```
import java.lang.reflect._
import scala.collection.mutable._

class ScalaClass {
   val list:Buffer[MyInterface]  = null

   def setList(l: Buffer[MyImpl]) = {
     list = l
   }
} 
```

这（当然）不会编译 - 但是我如何`list`以这样的方式声明变量呢？

**编辑**；我再补充一点。区别显然与以下事实有关：在 Java 中，泛型*在 T 中永远不会协变*，而在 Scala 中，它们可以是协变的，也可以不是协变的。例如，Scala 类`List`在 T 中是协变的（并且必然是不可变的）。因此以下**将编译**：

```
class ScalaClass {
   val list:List[MyInterface]  = null

   def setList(l: List[MyImpl]) = {
     list = l
   }
} 
```

我仍然在为编译器错误苦苦挣扎：

> `Covariant type T occurs in contravariant position in ...`

例如; 此编译器错误发生在类声明中：

```
class Wibble[+T] {
  var some: T = _ //COMPILER ERROR HERE!
 } 
```

我要问一个单独的问题...

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-23T14:03:33.483

直接模拟

```
import java.util.List;
List<? extends MyInterface> list; 
```

是

```
import java.util.List
var list : List[_ <: MyInterface]  = _; 
```

同样处理 Buffer

要回答您之前发表的评论，Java 类型参数始终是不变的，而不是协变的。

# java - 硒可以处理自动完成吗？

> ID：663034
> 
> 赞同：17
> 
> 时间：2009-03-19T16:54:43.947
> 
> 标签：java, firefox, junit, selenium

我有一个测试用例，需要在基于 ajax 的文本字段中输入部分值并验证列表是否具有预期内容。如果是，请选择内容。知道如何进行这项工作吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T01:22:09.547

**type**命令可能不足以触发自动完成。戴夫韦伯的建议在其他方面是正确的。我唯一的补充是您可能需要**typeKeys**命令，这会导致触发稍微不同的 JavaScript 事件，这可能更有可能触发自动完成小部件。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-19T17:07:34.010

我会这样做：

*   `type`在文本字段中输入值。
*   `waitForTextPresent`或`verifyTextPresent`检查自动完成内容
*   `click`或`mouseDown`单击自动完成列表中的项目

诀窍是让决赛`click`在正确的地方进行。您应该能够使用 XPath 表达式来搜索您希望找到的文本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-16T10:36:19.937

对于**WebDriver**，试试这个

以下代码用于从自动建议中自动搜索文本；主要用于一个**列表项**。

```
driver.findElement(By.id("your searchBox")).sendKeys("your partial keyword");
Thread.sleep(3000);
List <WebElement> listItems = driver.findElements(By.xpath("your list item locator"));
listItems.get(0).click();
driver.findElement(By.id("your searchButton")).click(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-11T18:08:21.393

我最近写了一篇关于这个主题的 HOWTO -[使用 Selenium 测试 AJAX 驱动的 JQuery 自动完成菜单](http://blog.buberel.org/2010/07/howto-test-jquery-ajax-autocomplete-menus-with-selenium.html)：

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-10-19T07:15:39.917

我在IDE中使用了以下序列，

1.  类型键
2.  waitForTextPresent
3.  鼠标移到
4.  点击At

并且工作得很好

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T17:00:47.050

你的问题有点模棱两可。

大多数浏览器保留基于字段名称的值缓存：即使您以前可能从未访问过该站点，浏览器也会建议您自动完成该值。此功能在所有浏览器中都是非标准的，并且 selenium 将没有标准的方法来检测/分析这一点。您仍然可以这样做，但您必须制作自己确定值的 javascript 函数。然后您可以在 selenium 中使用“eval”来执行这些功能。我还没有看到任何 js 库可以以跨浏览器兼容的方式告诉你这些值。

另一种选择是使用 ajax 对部分输入的值进行服务器端提交。在这种情况下，只需在文本框中输入值并断言预期值出现。通常，自动完成建议会显示在客户端的某个层中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-26T17:02:49.787

**我发现在执行typeKeys**之前我需要**关注**该领域才能使其工作。

 *** * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-20T03:00:40.857

这可能不适用于所有人，但我只是添加了一种方法，允许我延迟输入字符。

```
Actions builder = new Actions(this.webDriver);
    WebElement element = this.getWebElement();
    for (char c : value.toCharArray()) {
        builder = builder.sendKeys(element, c + "");
        builder.pause(100);
    }

    builder.build().perform(); 
```

然后我找到了我想点击的项目（

```
resultsElement.findElement(By.xpath("//li[.='" + valueLabel + "']")) 
```

其中 container 是 resultsElement 是包含结果集的 WebElement，而 value label 是我要单击的值。

同样，它可能并不适合所有人，但它对我有用，我认为分享是谨慎的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-08T05:22:56.887

请使用 typeKeys 而不是 type。也使用 mouseDown 而不是单击。它工作正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-10T20:59:59.620

Patrick的回答肯定很重要，我还发现Jquery UI的最后一个版本需要focus和mouseDown。我录制了一段测试视频，以便您可以看到它在 Sauce Labs 中运行： [https ://saucelabs.com/jobs/ad8c561be39bb7a42c9bb3a063214c95](https://saucelabs.com/jobs/ad8c561be39bb7a42c9bb3a063214c95)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-24T11:33:27.543

我们在使用 typeKeys 时遇到了一些问题。sendKeys 似乎成为了最终的解决方案，但它仍处于试验阶段。从参考：

> 此命令是实验性的。将来它可能会取代 typeKeys 命令。
> 
> 对于那些对细节感兴趣的人，与试图触发 keyDown、keyUp 和 keyPress 事件的 typeKeys 命令不同，此命令由 Selenium 2 中的原子支持，并提供了一个更健壮的实现，该实现将在未来。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-08-14T10:24:51.820

在 typeKeys 命令的帮助文本中，它说：

> 在某些情况下，您可能需要使用简单的“type”命令来设置字段的值，然后使用“typeKeys”命令发送与您刚刚键入的内容相对应的击键事件。

所以使用这个组合

```
type(selector, text);
typeKeys(selector, text); 
```

这似乎运作良好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-04T07:24:12.770

有时 TypeKeys 不起作用。这时候可以使用keyDown

单击输入框并在框中键入 value 和 keyDown。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-10-07T23:50:40.227

我可以通过使用下面的函数来解决这个问题：下面的函数将您要选择的文本作为参数。例如：如果您想选择“javascript”，只需在您的文本框中输入“java”并传递您要选择的文本，在这种特定情况下它是“javascript”。

```
 public void selectOptionWithText(String textToSelect) {
    try {
       //Add the below sleep if necessary  
       // Thread.sleep(1000);

 WebElement autoOptions = driver.findElement(By.className("autocomplete"));

        List<WebElement> optionsToSelect = autoOptions().findElements(By.tagName("div"));
        for (WebElement option : optionsToSelect) {
            if (option.getText().equals(textToSelect)) {
                System.out.println("Trying to select: " + textToSelect);
                option.click();
                break;
            }
        }
    }
    catch(Exception e){
        System.out.println("Error");
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-10-06T13:29:24.913

使用 Prashanth 的答案的一点变化：

```
 /**
 * Selects the element at position idx from the autocomplete combo, considering the partialKeyword
 * @param driver
 * @param element
 * @param partialKeyword
 * @param idx
 * @throws InterruptedException
 */
public static void selectAutoCompleteValue(WebDriver driver, WebElement element, String partialKeyword, Integer idx) throws InterruptedException{
    element.sendKeys(partialKeyword);
    Thread.sleep(1000);
    List <WebElement> listItems = driver.findElements(By.cssSelector(".ui-autocomplete-item.ui-autocomplete-list-item"));
    listItems.get(idx).click();
} 
```

希望这可以帮助！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-10-25T13:58:43.860

我在 Selenium IDE 2.9.1 版本中将这些命令用于自动完成文本字段。sendKeys (locator,value) clickAt(locator, coordString) click(locator)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-11-29T15:39:27.763

这里的代码几乎没有答案。所以，我会做我的贡献。

我用来从 PrimeFaces 2.2 的自动完成组件中选择一个项目的代码：

```
driver.findElement(By.id(codigoBanco_input)).sendKeys("text");
waitForElementLocated(By.cssSelector(listItensSelector), 5);
List<WebElement> listItems = driver.findElements(By.cssSelector(listItensSelector));
Actions builder = new Actions(driver);
builder.moveToElement(listItems.get(0)).build().perform();
WebDriverWait wait = new WebDriverWait(driver, 5); 

wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector(itemSelector)));
        driver.findElement(By.cssSelector(itemSelector)).click(); 
```

# iphone - 带有 UITabBarController 的 UITableViewController 不显示

> ID：663039
> 
> 赞同：0
> 
> 时间：2009-03-19T16:55:59.717
> 
> 标签：iphone, cocoa-touch, uitableview, uitabbarcontroller

我遇到了一个有趣的情况，我有一个 iPhone 应用程序，`UITableViewController`每个 3 秒显示或多或少相同的数据（你可以说这是过滤问题）。迄今为止，我为此有 3 个独立的 NIB，每个都有自己的控制器，此外，为了顶部的按钮，`UITableViewController`s 在里面。`UINavigationController`

现在为了优化应用程序并减少它的占用空间，我将所有逻辑打包到一个通用控制器 (an `UITableViewController`) 中，并且只保留了一个 NIB。公共控制器将负责过滤掉数据，并指向正确的数据。

因此，我将**相同**的通用控制器加载到 3 个导航控制器：

```
navControllerA = [[UINavigationController alloc] initWithRootViewController: commonTableController]; 
```

并将这些导航控制器添加到`UITabBarController`：

```
navigationControllersArray = [NSArray arrayWithObjects: navControllerA, navControllerB, navControllerC, nil];
[tabController setViewControllers:[NSArray arrayWithArray:navigationControllersArray]]; 
```

现在一切都很好，选项卡显示，表格视图显示。但是，一旦您触摸下一个`UITabBarItem`并返回上一个，`UITableViewController`则不会显示，您只能`UIWindow`在其位置看到 a。仅在`UITableViewController`最后一次触摸时保持可见`UITabBarItem`。

是否有某种`UITabBar`我不知道的视图加载机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:57:38.917

每个视图控制器只能位于一个导航控制器的堆栈中，并且不能位于该堆栈的多个位置。

如果您真的想通过仅使用一个视图控制器来节省内存，我建议您不要使用标签栏控制器，而只需使用标签栏视图并将根视图控制器设置为其委托。然后根视图控制器将直接解释标签栏事件并相应地更改其过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:17:34.723

如果您真的想在一个视图中切换数据集，似乎更好的方法是使用工具栏而不是标签栏。标签栏是关于切换视图的，正如另一张海报所指出的，所有视图都必须是一个视图和一个导航控制器的子级。拥有一个调用此单个控制器以切换数据集的选项卡栏更有意义，否则使用 UISegmentedControl 也可以很好地工作（因为您有三个元素，并且最多只能有三个段）。

# sql - Query several EAV attributes in separate columns

> ID：663040
> 
> 赞同：0
> 
> 时间：2009-03-19T16:56:09.433
> 
> 标签：sql, entity-attribute-value

I am facing issues trying to write a query. (this is slightly modified from my previous question)

My tables are laid out as follows:

```
 tblTicketIssues.TicketID
 tblTicketIssues.RequesterID

 tblPersonnelProfile.PersonnelID
 tblPersonnelProfile.FirstName
 tblPersonnelProfile.LastName

 tblTicketAttribute.TicketID
 tblTicketAttribute.Attribute
 tblTicketAttribute.AttributeValue 
```

I have to display the following fields:

```
 TicketID, RequesterFullName, UrgentPriorityID, MediumPriorityID, 
 LowPrioritytID 
```

This is the part that is challenging:

If tblTicketAttribute.Attribute= "Urgent" then the value from tblTicketAttribute.AttributeValue is displayed in UrgentPriority column

If tblTicketAttribute.Attribute= "Medium" then the value from tblTicketAttribute.AttributeValue is displayed in MediumPriority column

If tblTicketAttribute.Attribute= "Low" then the value from tblTicketAttribute.AttributeValue is displayed in LowPriority column

If tblTicketAttribute.Attribute= "Closed" then

The values in tblTicketAttribute.Attribute include "Urgent", "Medium", "Low", "Over30", "Over60", "Over90", "Closed"

I don't need to display all records. Only "Urgent", "Medium" & "Low".

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T17:06:33.683

I'm not 100% sure that I understand, but I think this satisfies what you're asking for. Note that this was assuming that the database is MySQL, you didn't specify. The syntax of the IF() and CONCAT() may be slightly different if it's something else.

*EDIT: updated query as per Csharp's "answer" below. `MAX`-ing the name is a bit of a hack.*

```
SELECT t.TicketID,
    MAX(CONCAT(p.FirstName, ' ', p.LastName)) AS RequesterFullName,
    MAX(IF(a.Attribute = 'Urgent', a.AttributeValue, NULL)) AS UrgentPriorityID,
    MAX(IF(a.Attribute = 'Medium', a.AttributeValue, NULL)) AS MediumPriorityID,
    MAX(IF(a.Attribute = 'Low', a.AttributeValue, NULL)) AS LowPriorityID
FROM tblTicketIssues AS t
    LEFT JOIN tblPersonnelProfile AS p ON p.PersonnelID = t.RequesterID
    LEFT JOIN tblTicketAttribute AS a ON a.TicketID = t.TicketID
WHERE a.Attribute IN ('Urgent', 'Medium', 'Low')
GROUP BY t.TicketID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:22:39.787

数据库设计使用表的[实体-属性-值](https://stackoverflow.com/questions/tagged/eav)模式`tblTicketAttribute`。您试图获得这个相当普通的查询结果所面临的困难表明 EAV 如何导致很多问题。

@Chad Birch的[解决方案](https://stackoverflow.com/questions/663040/query-several-eav-attributes-in-separate-columns/663074#663074)是获得结果的一种方法。这是获得所需结果的另一种方法：

```
SELECT t.TicketID,
    CONCAT(p.FirstName, ' ', p.LastName) AS RequesterFullName,
    a1.AttributeValue AS UrgentPriorityID,
    a2.AttributeValue AS MediumPriorityID,
    a3.AttributeValue AS LowPriorityID
FROM tblTicketIssues AS t
  JOIN tblPersonnelProfile AS p ON (p.PersonnelID = t.RequesterID)
  LEFT JOIN tblTicketAttribute AS a1 
    ON (a1.TicketID = t.TicketID AND a1.Attribute = 'Urgent')
  LEFT JOIN tblTicketAttribute AS a2 
    ON (a2.TicketID = t.TicketID AND a2.Attribute = 'Medium')
  LEFT JOIN tblTicketAttribute AS a3 
    ON (a3.TicketID = t.TicketID AND a3.Attribute = 'Low'); 
```

此解决方案不使用子句，但它确实需要为您要检索的每个属性`GROUP BY`单独设置。`JOIN`

另一个解决方案是在结果集的多行上获取属性：

```
SELECT t.TicketID,
    CONCAT(p.FirstName, ' ', p.LastName) AS RequesterFullName,
    a.AttributeValue AS AnyPriorityID
FROM tblTicketIssues AS t
  JOIN tblPersonnelProfile AS p ON (p.PersonnelID = t.RequesterID)
  LEFT JOIN tblTicketAttribute AS a 
    ON (a1.TicketID = t.TicketID AND a.Attribute IN ('Urgent', 'Medium', 'Low')); 
```

该解决方案可以更好地作为 SQL 查询进行扩展，因为您不必在`JOIN`获取更多属性时添加更多子句。但这确实意味着您必须对应用程序代码中的结果集进行一些后处理，才能将其转换为您想要的格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:09:29.870

I have no idea why you want to do it this way, but here goes (assuming SQL Server):

```
 SELECT TicketID, FirstName + ' ' + LastName AS RequestFullName,
 CASE WHEN Attribute = "Low" THEN AttributeValue ELSE "" END AS LowPriorityID,
 CASE WHEN Attribute = "Medium" THEN AttributeValue ELSE "" END AS MediumPriorityID,
 CASE WHEN Attribute = "Urgent" THEN AttributeValue ELSE "" END AS UrgentPriorityID
 FROM ...
 WHERE Attribute IN ("Urgent", "Low", "Medium") 
```

But that seems like a bizarre way to do things to me.

Can you clarify if the relationship between tbTicketIssues and tbTicketAttributes is one-to-one, or one-to-many?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T17:12:47.490

One relatively straightforward way to do something like this would be to just union three queries together. I suspect that what you're looking for would be something like this:

```
SELECT i.TicketID, a.FirstName, pp.AttributeValue AS UrgentPriorityID, null AS MediumPriorityID, null AS LowPrioritytID
FROM tblTicketIssues i, tblTicketAttribute a, tblPersonnelProfile pp
WHERE i.RequesterID = a.PersonnelID
AND i.TicketID = pp.TicketID
AND pp.Attribute = "Urgent"
UNION
SELECT i.TicketID, a.FirstName, null AS UrgentPriorityID, pp.AttributeValue AS MediumPriorityID, null AS LowPrioritytID
FROM tblTicketIssues i, tblTicketAttribute a, tblPersonnelProfile pp
WHERE i.RequesterID = a.PersonnelID
AND i.TicketID = pp.TicketID
AND pp.Attribute = "Medium"
UNION
SELECT i.TicketID, a.FirstName, null AS UrgentPriorityID, null AS MediumPriorityID, pp.AttributeValue AS LowPrioritytID
FROM tblTicketIssues i, tblTicketAttribute a, tblPersonnelProfile pp
WHERE i.RequesterID = a.PersonnelID
AND i.TicketID = pp.TicketID
AND pp.Attribute = "Low" 
```

(this is SQL Server btw, though I doubt it would be much different on pretty much any RDBMS)

There are doubtless "slicker" ways that this could be done, but I like this way because it's very straightforward when reading it.

# sql - 如何在 html 中嵌入图像并通过 msdb.dbo.sp_send_dbmail 将 html 作为电子邮件发送？

> ID：663048
> 
> 赞同：7
> 
> 时间：2009-03-19T16:58:19.647
> 
> 标签：sql, html, sql-server, tsql

我可以使用 msdb.dbo.sp_send_dbmail 以 html 格式发送电子邮件。仅就格式而言，文本非常好。例如：

```
EXEC msdb.dbo.sp_send_dbmail
  @recipients = @p_recipients,
  @subject = @v_subject,
  @body=@emailHTML, 
  @body_format = 'HTML'; 
```

但是，如果我想包含从我的 SQL 服务器上的数据生成的趋势等图像，并将它们嵌入到 html (@emailHTML) 中，我应该使用什么 html 标记？

如果我使用 [img] 标签，那么我需要设置 src 属性。生成的图像保存在我本地 SQL Server 的硬盘中。我可以将它们放在 IS 服务器网页区域。但是所有这些 Web 服务器都可以通过 Intranet 访问，但不在我的工作范围内。

有没有办法在电子邮件中嵌入图像？如何设置 html 以嵌入图像？

我使用的是 Microsoft SQL Server 2005。我更喜欢 msdb.dbo.sp_send_dbmail 以电子邮件形式发送报告。我对html格式有很多控制权。如果没有办法，我可能不得不将图像作为附件发送。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-19T17:46:11.107

我想我得到了答案：

```
EXEC msdb.dbo.sp_send_dbmail
   @recipients = 'myemail@someemail.com',
   @subject = 'test',
   @file_attachments = 'C:\MyFolder\Test\Google.gif;C:\MyFolder\Test\Yahoo.gif',
   @body=N'<p>Image Test</p><img src="Google.gif" /><p>See image there?</p>
        <img src="Yaoo.gif" /><p>Yahoo!</p>', 
   @body_format = 'HTML'; 
```

基本上，将图片添加为附件，src 属性只包含图片文件名，不需要任何路径。如果需要多个图像文件，只需使用“;” 将它们分开。

我将电子邮件发送到我的 Outlook 电子邮件，它可以正常工作。试试我的雅虎邮箱....

# .net - Slow performance of SqlDataReader

> ID：663050
> 
> 赞同：11
> 
> 时间：2009-03-19T16:58:52.173
> 
> 标签：.net, sql-server, sql-server-2005, sqldatareader

I've query executing ~2 secs in MSSMS (returning 25K of rows)

Same query used in .NET (sqlReader) exetuting few minutes!

I've also tried to execute only reader

(commented all code in while loop just leaving reader.Read() ) - still same!

Any idea what's up?

* * *

I'm not DBA and not priviledged to play with Profiler - will ask my DBA and let all know.

In the meantime I'm noticed essential performance boost after adding "**WITH RECOMPILE**" param to SP I'm talking

So, from my perspective it seems to be the case with execution plan... What do you think?

**[EDIT]** Also what I've checked was performing below query from QA and .NET

```
select @@options 
```

My understanding is it shall return same value for both environements. (If not differnet ex.plans will be used) Am I right?

**[EDIT2]** I've read (from [http://www.sqldev.net/misc/fn_setopts.htm](http://www.sqldev.net/misc/fn_setopts.htm)) that **ARITHABOIRT**=ON in QA (in .NET it is off)

Does enybody know how to force ARITHABOIRT=ON for every .NET connections?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T17:36:02.833

I would set up a trace in SQL Server Profiler to see what SET options settings the connection is using when connecting from .NET code, and what settings are being used in SSMS. By SET options settings, I mean

```
ARITHABORT
ANSI_NULLS
CONCAT_NULL_YIELDS_NULL
//etc 
```

Take a look at [MSDN](http://msdn.microsoft.com/en-us/library/ms190707(SQL.90).aspx) for a table of options

I have seen the problem before where the options were different (in that case, `ARITHABORT`) and the performance difference was huge.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-10T12:54:07.797

我有这个问题。在数据库服务器的连接设置中勾选“算术中止”设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:46:57.160

此外，查询分析器不会下载大文本或大二进制字段的全部内容。您的 SqlDataReader 可能需要更长时间，因为它确实会下载全部内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T17:12:17.413

I would check to see how long the actual retrieval is taking.

for instance:

```
 Private Sub timeCheck()
    'NOTE: Assuming you have a sqlconnection object named conn

    'Create stopwatch
    Dim sw As New System.Diagnostics.Stopwatch

    'Setup query
    Dim com As New SqlClient.SqlCommand("QUERY GOES HERE", conn)

    sw.Start()

    'Run query
    Dim dr As SqlClient.SqlDataReader = com.ExecuteReader()

    sw.Stop()

    'Check the time
    Dim sql_query_time As String = CStr((sw.ElapsedMilliseconds / 1000)) & " seconds"
  End Sub 
```

This will allow you to see whether the hold-up is in the retrieval, or in the execution of the reader.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T17:13:40.080

If you ar executing the reader in a loop, where it executes many times, then make sure you are using CommandBehavior.CloseConnection

```
 SqlCommand cmd = new SqlCommand();
    SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection) 
```

If you don't, each time the loop processes the line, when it finishes and the rdr and the connection object drops out of scope, the connection object will not be explicitly closed, so it will only get closed and released back to the pool when the Garbage Collector finally gets around to finalizing it...

Then, if your loop is fast enough, (which is very likely), you will run out of connections. (The pool has a maximum limit it can generate)

This will cause extra latency and delays as the code keeps creating extra unnecessary connections, (up to the maximum) and waiting for the GC to "catch up" with the loop that is using them...

# python - HTML 实体代码到文本

> ID：663058
> 
> 赞同：14
> 
> 时间：2009-03-19T17:01:25.943
> 
> 标签：python, html, beautifulsoup

有谁知道在 Python 中将带有 HTML 实体代码（例如`&lt;` `&amp;`）的字符串转换为普通字符串（例如 < &）的简单方法？

`cgi.escape()`将转义字符串（很差），但没有`unescape()`.

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-19T17:20:56.613

[HTMLParser](https://docs.python.org/2.7/library/htmlparser.html)具有标准库中的功能。不幸的是，它没有记录：

（Python2[文档](https://docs.python.org/2.7/library/htmlparser.html)）

```
>>> import HTMLParser
>>> h= HTMLParser.HTMLParser()
>>> h.unescape('alpha &lt; &beta;')
u'alpha < \u03b2' 
```

（Python 3[文档](https://docs.python.org/3/library/html.parser.html)）

```
>>> import html.parser
>>> h = html.parser.HTMLParser()
>>> h.unescape('alpha &lt; &beta;')
'alpha < \u03b2' 
```

[htmlentitydefs](http://docs.python.org/library/htmllib.html#module-htmlentitydefs)已记录在案，但需要您自己完成大量工作。

如果您只需要 XML 预定义实体（lt、gt、amp、quot、apos），您可以使用 minidom 来解析它们。如果您只需要预定义的实体而不需要数字字符引用，您甚至可以使用普通的旧字符串替换来提高速度。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-19T17:45:15.713

一开始我忘了标记它，但我使用的是 BeautifulSoup。

在文档中挖掘，我发现：

```
soup = BeautifulSoup(html, convertEntities=BeautifulSoup.HTML_ENTITIES) 
```

完全按照我的希望进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:03:50.447

Python stdlib 中没有内置任何内容来对 HTML 进行转义，但是您可以在[http://www.w3.org/QA/2008/04/unescape-html-entities-python](http://www.w3.org/QA/2008/04/unescape-html-entities-python) .html 上根据您的需要定制一个简短的脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T17:22:30.447

使用[htmlentitydefs](http://docs.python.org/library/htmllib.html#module-htmlentitydefs)模块。这是我的旧代码，它有效，但我确信有更清洁和更 Pythonic 的方式来做到这一点：

```
e2c = dict(('&%s;'%k,eval("u'\\u%04x'"%v)) for k, v in htmlentitydefs.name2codepoint.items()) 
```

# java - 为什么内部类可以访问私有方法？

> ID：663059
> 
> 赞同：32
> 
> 时间：2009-03-19T17:01:44.287
> 
> 标签：java, inner-classes

我不明白为什么会编译。f() 和 g() 在内部类中是可见的，尽管它们是私有的。他们是否因为是内部类而受到特殊对待？

如果 A 和 B 不是静态类，它仍然是相同的。

```
class NotPrivate {
    private static class A {
        private void f() {
            new B().g();
        }
    }

    private static class B {
        private void g() {
            new A().f();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-19T17:24:35.420

（编辑：扩展答案以回答一些评论）

编译器采用内部类并将它们转换为顶级类。由于私有方法仅对内部类可用，编译器必须添加具有包级别访问权限的新“合成”方法，以便顶级类可以访问它。

像这样的东西（编译器添加的 $ ）：

```
class A 
{
    private void f() 
    {
        final B b;

        b = new B();

        // call changed by the compiler
        b.$g();
    }

    // method generated by the compiler - visible by classes in the same package
    void $f()
    {
        f();
    }
}

class B
{
    private void g() 
    {
        final A a;

        a = new A();

        // call changed by the compiler
        a.$f();
    }

    // method generated by the compiler - visible by classes in the same package
    void $g()
    {
        g();
    }
} 
```

非静态类是相同的，但它们增加了对外部类的引用，以便可以在其上调用方法。

Java 这样做的原因是他们不想要求 VM 更改以支持内部类，因此所有更改都必须在编译器级别进行。

编译器获取内部类并将其转换为顶级类（因此，在 VM 级别没有内部类之类的东西）。然后编译器还必须生成新的“转发”方法。它们是在包级别（非公共）制作的，以确保只有同一包中的类可以访问它们。编译器还将私有方法的方法调用更新为生成的“转发”方法。

您可以避免让编译器生成将方法声明为“包”的方法（缺少公共、私有和受保护的方法）。这样做的缺点是包中的任何类都可以调用方法。

编辑：

是的，您可以调用生成（合成）方法，但不要这样做！：

```
import java.lang.reflect.Constructor;
import java.lang.reflect.Method;

public class Main
{
    public static void main(final String[] argv)
        throws Exception
    {
        final Class<?> clazz;

        clazz = Class.forName("NotPrivate$A");        

        for(final Method method : clazz.getDeclaredMethods())
        {
            if(method.isSynthetic())
            {
                final Constructor constructor;
                final Object instance;

                constructor = clazz.getDeclaredConstructor(new Class[0]);
                constructor.setAccessible(true);
                instance = constructor.newInstance();
                method.setAccessible(true);
                method.invoke(null, instance);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-19T17:09:46.407

我认为[这句话](http://www.onjava.com/pub/a/onjava/excerpt/HardcoreJava_chap06/index.html)很好地总结了它：

*...内部类可以访问声明类的所有成员，甚至是私有成员。实际上，内部类本身就是类的成员；因此，遵循面向对象工程的规则，它应该可以访问类的所有成员。*

从那以后，由于两个内部类实际上只是包含类的一部分，因此它们也应该能够访问彼此的私有成员。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T17:06:38.520

Java 在特殊的访问器中编译，其中包含 $。所以你不能编写访问私有方法的Java。在这里解释：

[http://www.retrologic.com/innerclasses.doc7.html](http://www.retrologic.com/innerclasses.doc7.html)

> 还有一类编译器生成的成员。如果一个类包含另一个类，或者如果它们被一个公共类包含，则另一个类 D 可以使用类 C 的私有成员 m。由于虚拟机不知道这种分组，编译器在 C 中创建了一个本地访问方法协议，以允许 D 读取、写入或调用成员 m。这些方法的名称形式为 access$0、access$1 等。它们从不公开。访问方法的独特之处在于它们可以添加到封闭类，而不仅仅是内部类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-05T15:30:28.860

正如用户“A Dude”在已接受答案的评论中解释的那样：

它可以编译，因为语言规范要求它以这种方式工作，即。Java 语言规范是这样说的：

6.6.1 确定可访问性（至少从 JLS6 开始）

“否则，如果成员或构造函数被声明为私有，那么当且仅当它发生在包含成员或构造函数声明的顶级类（第 7.6 节）的主体内时，才允许访问。”

即私有成员的“访问范围”是：在顶级类主体的词汇边界内的任何地方。

这意味着：在最外层类的类体内定义的所有私有成员都可以从该类体内的其他任何地方访问。

例如，可以从外部类的方法或外部类的另一个内部类的任何方法访问内部类的私有方法。

# excel - Excel 数据透视表

> ID：663063
> 
> 赞同：0
> 
> 时间：2009-03-19T17:02:24.613
> 
> 标签：excel, pivot, crosstab

我是一个 excel 新手，想知道 excel 是否具有执行以下操作的内置功能。

转这个数据：

```
Name  | Activity          | Option
Bob   | Monday Activities | Golf
Bob   | Tuesday Activities| Kayak
Marge | Monday Activities | Spa
John  | Tuesday Activities| Soccer
Liz   | Tuesday Activities| Spa 
```

进入：

```
Name  | Monday Activities | Tuesday Activities
Bob   | Golf              | Kayak
Marge | Spa               |
John  |                   | Soccer
Liz   |                   | Spa 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T17:14:35.600

Excel 将在某种程度上支持您在其数据透视图功能中寻找的内容，该功能将您提供的格式的数据转换为自定义的、用户定义的表格或图表。

[Excel 2003 说明](http://www.microsoft.com/dynamics/using/excel_pivot_tables_collins.mspx)

[Excel 2007 说明](http://www.timeatlas.com/mos/5_Minute_Tips/Chunkers/Learn_to_use_Pivot_Tables_in_Excel_2007_to_Organize_Data/)

该表将支持在第一列中列出唯一名称，在第一行中列出唯一活动，但对于选项，Excel 无法知道如何显示它们，并将尝试将它们转换为数字，因为可能不止一个每个名称/活动组合都可能存在选项。

最后，有些人可能会建议您使用 Excel 的**转置**功能。这是通过选择表并复制它来完成的。然后，您可以右键单击一个空单元格并选择**Paste Special**，然后选择**Transpose**。这只会翻转不是您要查找的行的列。

我建议您使用数据透视表功能，但考虑将选项值转换为数字。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T07:48:45.967

数据透视表允许您操作和显示数字数据，而不是诸如“kayak”之类的字符串，因此虽然您可以非常轻松地创建数据透视表，但它只会计算/求和等 kayak、soccer 等的实例，而不显示价值观。

您可以重新格式化数据以产生一些可以为您提供所需输出的近似值：

```
名称 活动 Golf Kayak Soccer Spa
鲍勃星期一 1

鲍勃星期二 1

玛吉星期一 1
约翰星期二 1

丽兹星期二 1
```

（上面可能无法正确显示，但如果使用选择性粘贴>文本粘贴到 Excel 中会正确显示）

但是，即使那样，您仍然必须使用 =GETPIVOTDATA 和其他公式的组合来获得令人满意的结果。由于非常有可能将错误引入数据（拼写、尾随空格等），这可能会变得非常混乱。考虑到这将需要你重新格式化数据（如果你这样做，你也可以按照你的意愿格式化它），我猜这对你来说可能没有多大用处。

实现您想要的东西所需的 VBA 非常重要，并且很大程度上取决于您的数据的确切布局以及哪些信息是已知的或可以从其他地方提取的，例如活动、名称。如果数据集不是很大，那么重新格式化的工作可能比尝试编程解决方案要少。

# c - 将字符串复制到缓冲区

> ID：663064
> 
> 赞同：1
> 
> 时间：2009-03-19T17:02:40.447
> 
> 标签：c, arrays, copy, pointers

我有一些代码在使用 sprintf 将 aa 指针复制到字符串时进行堆栈转储。我正在尝试将动物的内容复制到一个名为 output 的新指针数组中。但是，我得到了一个堆栈转储。

输出中应该有以下内容：新动物兔子新动物马新动物驴

我会以正确的方式解决这个问题吗？

非常感谢

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void p_init(const char **animals, char **output);

int main(int argc, char **argv)
{
    char *animals[] = {"rabbit", "horse", "donkey", '\0'};  
    char **prt_animals = animals;
    char *output[sizeof(*animals)];

        /* print the contents here */
    while(*prt_animals)
    {
        printf("Animal: %s\n", *prt_animals++);
    }

        /* copy and update in the output buffer */
    p_init(*&animals, *&output);

    getchar();

    return 0;

void p_init(const char **animals, char **output)
{
    while(*animals)
    {
        sprintf(*output, "new animal %s", *animals); 
        *output++;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T17:15:07.173

该数组`animals`是一个指针数组。它不是某个大小的缓冲区数组。因此，如果你这样做

```
sizeof(*animals) 
```

您将获得该数组第一个元素的 sizeof。相当于

```
sizeof(char*) 
```

因为您的数组存储指针。因此，在读取的行中

```
char *output[sizeof(*animals)]; 
```

您在一个数组中分配 4 或 8 个指针（取决于平台上指针的宽度。通常是 4 或 8）。但这当然没有意义！您想要做的是创建一个与`animals`. 您必须首先获取动物数组的总大小，然后除以一个元素的大小

```
char *output[sizeof(animals)/sizeof(*animals)]; 
```

现在，这就是你想要的。但是指针仍将具有不确定的值...接下来，您使用数组传递数组`*&animals`（另一个相同）。为什么？可以`animals`直接通过。获取它的地址然后取消引用与一开始什么都不做是一样的。

然后在您调用的函数中，将元素指向的字符串复制`animal`到某个不确定的目的地（请记住`output`数组的元素 - 指针 - 尚未确定值。我们还没有分配它们！）。您首先必须分配适量的内存并使元素指向它。

```
while(*animals) {
        // now after this line, the pointer points to something sensible
        *output = malloc(sizeof("new animal ") + strlen(*animals));
        sprintf(*output, "new animal %s", *animals); 
        output++; // no need to dereference the result
        animals++; // don't forget to increment animals too!
} 
```

**另外，大约上面的sizeof**

您必须确定一件重要的事情。这是我们计算大小的方式。无论您做什么，请确保您始终有足够的空间容纳您的琴弦！AC 字符串由字符和一个终止空字符组成，它标志着字符串的结束。因此，`*output`应该指向一个缓冲区，该缓冲区至少要包含`"new animal "`和的空间`*animals`。第一个包含 11 个字符。第二个取决于我们实际复制的内容 - 它的长度是`strlen`返回的内容。所以，总的来说我们需要

```
12 + strlen(*animals) 
```

所有字符的空间，包括终止的空值。现在，将该数字硬编码到您的代码中并不是一种好的风格。前缀可能会发生变化，您可能会忘记更新数字或误数一两个字符。这就是我们使用 的原因`sizeof`，我们提供了我们想要预先添加的字符串文字。回想一下，`sizeof`表达式的计算结果是其操作数的大小。您之前使用它`main`来获取数组的总大小。现在您将它用于字符串文字。所有字符串文字都是字符数组。字符串文字由您键入的字符*和*空字符组成。因此，以下条件成立，因为`strlen`计算 C 字符串的长度，并且不包括终止空字符到它的长度

```
// "abc" would have the type char[4] (array of 4 characters)
sizeof "..." == strlen("...") + 1 
```

我们不必除以一个元素的大小，因为 char 的 sizeof 无论如何都是 1，所以不会有任何区别。为什么我们使用`sizeof`而不是strlen？因为它已经考虑了终止空字符，并且它在编译时进行评估。编译器可以从字面上替换 sizeof 表达式返回的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:12:40.970

```
char *output[sizeof(*animals)]; 
```

创建一个大小为 4 的指针数组`char`。但是，它不会为这些指针分配内存。这些数组成员包含垃圾（即指向您不拥有的内存）。尝试写入该内存会调用 UB。在您的情况下，UB 通过堆栈转储显示自己。您的函数的其他一些问题`p_init`如下所示：

```
void p_init(const char **animals, char **output)
{
    /* runs an infinite loop -- since *animals is never incremented */
    /* need to pass size of *animals so that you can terminate your loop */
    while(*animals)
    {
        /* allocate some memory */
        sprintf(*output, "new animal %s", *animals); 
        *output++;
    }
} 
```

一个固定的代码将是这样的：

```
void p_init(const char ** animals, const size_t nanimals, char **output)
{
    const char **w = animals;
    size_t len = 0;
    while (w < animals + nanimals)
    {
        len = strlen(*w);
        *output = malloc(len + sizeof "new animal " + 1);
        sprintf(*output, "new animal %s", *w); 
        output++;          
        w++;
    }
}

int main(int argc, char **argv)
{
    char *a[] = { "rat", "dog", "lion" };
    char *o[ sizeof a/ sizeof *a ];
    p_init((const char**)a, sizeof a / sizeof *a, o);
    for (size_t i = 0; i < sizeof a / sizeof *a; ++i) printf("%s\n", o[ i ]);
    for (size_t i = 0; i < sizeof a / sizeof *a; ++i) free(o[ i ]);
    return 0;
} 
```

随意放入所需的标题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T17:13:03.230

您尚未在输出数组中分配任何空间来放入副本。在使用 sprintf 复制到该缓冲区之前，您需要使用 malloc 分配一些空间。

```
void p_init(const char **animals, char **output)
{
    while(*animals)
    {
        size_t stringSize = 42; /* Use strlen etc to calculate the size you need, and don't for get space for the NULL! */
        *output = (char *)malloc(stringSize);
        sprintf(*output, "new animal %s", *animals); 
        output++;
        animals++;
    }
} 
```

完成后不要忘记在分配的内存上调用 free() 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T17:12:27.290

首先，有什么意义

```
p_init(*&animals, *&output); 
```

与

```
p_init(animals, *&output); 
```

?

[其次，出于此处](http://c-faq.com/ansi/constmismatch.html)解释的原因，将 char** 转换为 const char** 是非法的。

最后，您的主要问题是测试

```
while (*animals) 
```

当您到达动物数组末尾的空字符串时，您期望失败，这是错误的。该语句实际上是检查指向字符串的指针是否为 NULL，而不是检查字符串是否为 EMPTY。空字符串（包含单个字符 '\0' 的字符串）与空指针不同。

换句话说，一旦你到达了 animals 数组的最后一个元素，*animals 的计算结果就是一个非 NULL 指针，它恰好指向一个空字符串。因此测试通过了，你的循环永远继续下去（嗯，它一直持续到你跑到动物数组的末尾足够远而导致段错误）。

您可以通过在创建动物数组时将 '\0' 替换为 NULL 来解决此问题，或者您可以更改 while 检查以检查 strlen(*animals) == 0 （或任何其他检查空字符串而不是一个空指针。

**编辑：**请注意，其他人指出了我错过的同样严重的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T17:14:38.657

您没有创建一个非常大的缓冲区 -在 32 位系统`sizeof(*animals)`上`sizeof(char*)`是 4 个字节；您没有创建任何地方来放置输出字符串；并且您没有使用诸如`snprintf`写入缓冲区之类的安全机制，因此您会崩溃而不是安全失败。

以下是针对这些的修复，保持您的零终止数组使用：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void p_init ( const char **animals, char **output );

int main(int argc, char **argv) {
    // no reason to use char 0 rather than int 0 to mark end here
    const char* animals[] = {"rabbit", "horse", "donkey", "pig", 0};

    printf("sizeof(*animals) = %zd\n", sizeof(*animals));
    printf("number of elements in animals = %zd\n", sizeof(animals) / sizeof(*animals));

    char *output[sizeof(animals)/sizeof(*animals)];

    // print animals
    for ( const char**p = animals; *p; ++p)
        printf ( "Animal: %s\n", *p );

    // format animals to output
    p_init ( animals, output);

    // print output
    for ( char**p = output; *p; ++p)
        printf ( "Animal: %s\n", *p );

    // free output
    for ( char**p = output; *p; ++p )
        free(*p);

    return 0;
}

void p_init ( const char **animals, char **output ) {
    while ( *animals ) {
        size_t  len = strlen ( *animals );
        char*   buf = malloc ( len + 13 );

        snprintf ( buf, len + 13, "new animal %s", *animals );

        *output = buf;

        ++animals;
        ++output;
    }

    *output = 0;
} 
```

# c++ - 在 Win32/MFC 中停止线程

> ID：663071
> 
> 赞同：4
> 
> 时间：2009-03-19T17:04:55.903
> 
> 标签：c++, multithreading, winapi, mfc

我正在阅读一些与线程相关的代码，并找到了这段代码：

```
MyThread::start()
{
  //Create a thread
  m_pThread = AfxBeginThread(/*some parameters*/)

  //Create a duplicate handle for the created thread
  m_hDuplicateHandle = DuplicateHandle(/* some more parameters*/)
}

MyThread::stop()
{
  //Set some variables so that the thread comes out of its run() function
  WaitForSingleObject(m_hDuplicateHandle, defaultTimeout);

  CloseHandle(m_hDuplicateHandle);
} 
```

我的问题，为什么需要重复的句柄？我们不能直接等待原始线程句柄吗？它会以某种方式变得无效吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T17:15:32.790

AfxBeginThread 返回一个`CWinThread*`并且 MFC 假定它将管理与线程关联的句柄。

因此，为了安全地直接使用句柄，您需要复制它，否则当线程结束时，MFC 可能在调用 WaitForSingleObject 之前已经关闭了句柄。

如果您直接使用 win32 CreateThread API，那么您当然可以直接等待返回的句柄。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T17:15:49.607

CWinThread 的 m_hThread 成员仅在销毁 CWinThread 对象时关闭。如果 m_bAutoDelete 设置为 TRUE，该对象将自行删除。线程将在其工作函数或消息循环等完成后自行删除，请参阅_AfxThreadEntry。句柄重复的原因是为了避免使用无效句柄或访问无效的 CWinThread* 如果线程在调用 stop() 之前退出并被销毁。

# c++ - 如何捕捉临界区抛出的异常？

> ID：663072
> 
> 赞同：5
> 
> 时间：2009-03-19T17:05:06.527
> 
> 标签：c++, multithreading, winapi, exception

我正在使用 c++ 开发 win 32 多线程。场景：我有一个由多个线程使用的函数。此功能用作关键部分（或任何可以锁定资源的构造）。在临界区会抛出异常。此时我需要注意解锁异常捕获块中的资源。

有没有其他方法可以做到这一点？我的意思是，假设我不想记住释放catch块中的锁，有没有什么常见的方法来处理这个问题以避免这种容易出错的情况？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-19T17:10:53.097

这个想法是将获取和释放关键部分的行为封装在一个对象中，以便构造对象获取CS并销毁对象释放它。

```
struct CSHolder {
    explicit CSHolder(CRITICAL_SECTION& cs): lock(cs) {
        ::EnterCriticalSection(&lock);
    }
    ~CSHolder() { ::LeaveCriticalSection(&lock); }
    CRITICAL_SECTION& lock;
};

CRITICAL_SECTION gLock;
void foo() {
    CSHolder lockIt(gLock);
    // lock is held until lockIt is destroyed
} 
```

这个概念被称为[RAII](http://en.wikipedia.org/wiki/RAII) - 资源获取就是初始化。这是现代 C++ 中非常常见的习语。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T17:34:23.477

如果您使用的是现有框架，您可能已经有一个可以为您执行此操作的 RAII 容器类。如果您使用的是 MFC，请查看`CSingleLock`，如果您使用的是 boost，请查看[`scoped_lock`](http://www.boost.org/doc/libs/1_36_0/doc/html/boost/interprocess/scoped_lock.html).

令人遗憾的是，每个人似乎都必须（或认为他们必须）推出自己的产品。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T17:09:10.883

编写一个将临界区作为构造函数参数的括号类。在构造函数中调用 EnterCriticalSection，在析构函数中调用 LeaveCriticalSection。如果抛出 C++ 异常，堆栈展开将完成其余的工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T17:23:08.247

如果您可以使用 MFC，那么您可以使用[CSingleLock](http://msdn.microsoft.com/en-us/library/bwk62eb7(VS.80).aspx)来执行此操作。你可以像这样使用它：

```
void f()
{
  try
  {
    CSingleLock lock(&m_criticalSection, TRUE);

  }
  catch(/*some exception*/)
} 
```

锁将负责解锁其析构函数中的关键部分。由于lock，是一个本地对象，当抛出异常时堆栈展开并且锁对象析构函数被执行以解锁您的关键部分。

# java - 克隆是否比构造函数/工厂方法提供了性能改进？

> ID：663079
> 
> 赞同：7
> 
> 时间：2009-03-19T17:07:38.143
> 
> 标签：java, optimization, clone, cloneable

我正在维护一个较旧的 Java 代码库（jvm 1.4），它似乎使用克隆作为对象实例化的替代方法，我猜它是一种性能优化。这是一个人为的例子：

```
public class Foo {
  private SomeObject obj; // SomeObject implements Cloneable
  public Foo() {
    obj = new SomeObject();
    obj.setField1("abc"); // these fields will have the same value every time
    obj.setField2("def");
  }
  public void doStuff() {
    SomeObject newObj = obj.clone(); // clone it instead of using a factory method
    // do stuff with newObj
  }
} 
```

尽管有关于过早优化的常见警告，但这实际上是在某些时候推荐的习语吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T17:10:09.307

大概他们想要一份副本。也许他们想将它传递给另一个函数，并且不能确定该函数不会改变它。这是一种确保方法 doStuff() 相对于它所调用的 Foo 对象的状态为 const 的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-11T19:03:20.520

调用`clone()`而不是复制构造函数或工厂方法的一个原因是可能没有其他选项可用。

与实现`clone()`复制构造函数或工厂方法来执行相同操作相比，实现执行浅对象复制（涉及深度复制更多）是微不足道的。要实现`clone()`，一个类需要简单地实现`Cloneable`接口并`clone()`用一个调用`super.clone()`通常调用的方法覆盖方法`Object.clone()`。 `Object.clone()`将原始对象的每个属性复制到副本的相应属性中，从而创建浅拷贝。

虽然实现`clone()`很简单，但仍然很容易忘记实现`Cloneable`。因此，使用`clone()`复制对象的潜在风险是，如果该对象的类确实忽略了直接或间接实现`Cloneable`和`clone()`调用`Object.clone()`，它将抛出`CloneNotSupportedException`.

请参阅此[代码示例](https://stackoverflow.com/questions/1138769/why-is-the-clone-method-protected-in-java-lang-object/1255990#1255990)和先前关于界面[设计不佳](https://stackoverflow.com/questions/1138769/why-is-the-clone-method-protected-in-java-lang-object/1138790#1138790)的[讨论。](https://stackoverflow.com/questions/1138769/why-is-the-clone-method-protected-in-java-lang-object)`Cloneable`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-09T18:21:32.390

复制构造函数的一个主要问题是必须在编译时知道对象的类型。如果可继承类支持复制构造函数，并且构造函数传递了派生类对象，则构造函数将生成一个基类对象，其基类属性通常与传入对象的属性匹配，但新对象不会t 支持传入对象中存在但基类中不存在的任何特性。

可以通过使复制构造函数“受保护”并在每个派生类中拥有一个可覆盖的工厂复制方法来解决这个问题，该方法调用该类自己的复制构造函数，而后者又调用其基类的复制构造函数。但是，无论是否添加任何新字段，每个派生类都需要一个复制构造函数和复制方法的覆盖。如果案例类使用“克隆”，则可以消除此额外代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T17:10:46.013

这可能是一种性能优化，具体取决于构造函数中完成了多少工作。

它更有可能被使用，因为语义不同。克隆提供了一种以通常不倾向于这种方式的语言实现“原型语义”（如在 javascript、self 等中）的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T17:27:58.763

如果 SomeObject 构造函数执行昂贵的工作，例如从数据库中获取某些内容或解析某些内容，或者从文件中读取某些内容，那么克隆将有意义以避免执行该工作。

如果构造函数什么都不做，那么真的没有必要使用克隆。

编辑：添加代码以显示克隆不必与构造函数执行相同的工作：

```
class Main
    implements Cloneable
{
    private final double pi;

    public Main()
    {
        System.out.println("in Main");
        // compute pi to 1,000,000,000 decimal palaces
        pi = 3.14f;
    }

    public Object clone()
    {
        try
        {
            return (super.clone());
        }
        catch(final CloneNotSupportedException ex)
        {
            throw new Error(); // would not throw this in real code
        }
    }

    public String toString()
    {
        return (Double.toString(pi));
    }

    public static void main(String[] args)
    {
        final Main a;
        final Main b;

        a = new Main();
        b = (Main)a.clone();

        System.out.println("a = " + a);
        System.out.println("b = " + b);
    }
} 
```

Main 构造器被调用一次，计算 pi 被执行一次。

# chmod - 无法使应用程序文件夹在 Mac 中可写

> ID：663089
> 
> 赞同：1
> 
> 时间：2009-03-19T17:10:31.037
> 
> 标签：chmod

我的 Vuze 无法自我更新，因为它声称我的应用程序文件夹不可写。

我试图让它可写

```
chmod 777 /Applications 
```

我收到以下错误

```
$chmod 777 /Applications/
chmod: /Applications/: Operation not permitted 
```

**如何使 /Applications 文件夹可写？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T17:16:37.607

假设您的帐户具有管理员权限，请尝试：

```
 $sudo chmod 777 /Applications 
```

然后输入您的密码。

starblue 提到的危险是，通过这样做，您基本上允许系统上的任何用户对您的应用程序文件夹进行完全和完整的读/写/执行访问。

我希望很明显为什么这通常是一个坏主意，你知道你在做什么，等等。

编辑进一步补充：如果你只是想给自己写权限，你可能会更好：

```
 $sudo chmod u+w /Applications 
```

而不是授予每个人完全访问权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:13:18.020

您可能不是 root，因此无法修改该目录。

如果您真的*非常*想这样做，请在您的命令前面添加“sudo”，这将使命令的运行具有 root 访问权限。

你是否真的需要这样做，这取决于你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T23:45:23.477

在 OS X 上，用户通常可以在 Applications 文件夹中添加或删除应用程序，但不能修改应用程序。根据尝试自我更新的应用程序，您可以将其删除，或者您可以 chmod -R u+w 应用程序包本身。不过，您不希望对整个 Applications 目录执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T20:06:38.123

sudo chmod -R 755 /目录

或为所有用户制作：777

不过要小心这样做..

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-19T17:14:47.750

尝试运行磁盘工具的修复权限按钮。

# c# - 如何优化 Linq to Xml 查询反对属性？

> ID：663094
> 
> 赞同：2
> 
> 时间：2009-03-19T17:12:16.620
> 
> 标签：c#, optimization, .net-3.5, linq-to-xml

给定以下 Xml 片段：

```
<root>
  <sheetData>
    <row r="1" />
    <row r="2" />
    <row r="3" />
    <row r="4" />
    <row r="5" />
    <row r="6" />
    <row r="7" />
  </sheetData>
</root> 
```

可以使用以下代码创建：

```
XElement testElement = new XElement("root",
    new XElement("sheetData",
        new XElement("row",
            new XAttribute("r", 1)),
        new XElement("row",
            new XAttribute("r", 2)),
        new XElement("row",
            new XAttribute("r", 3)),
        new XElement("row",
            new XAttribute("r", 4)),
        new XElement("row",
            new XAttribute("r", 5)),
        new XElement("row",
            new XAttribute("r", 6)),
        new XElement("row",
            new XAttribute("r", 7)))); 
```

这是找到 r 属性为 2 的行的最佳方法吗？这行得通，但是我在 select 语句中重复了 Where 子句，我想知道是否有更好的方法和更有效的方法。

```
int rowNumber = 2;

XElement rowElement = testElement
    .Descendants("sheetData")
    .Where<XElement>(item => item.Descendants("row")
                                  .Where<XElement>(i => i.Attribute("r").Value == rowNumber.ToString())
                                  .FirstOrDefault<XElement>() != null)
    .Select<XElement, XElement>(item => item.Descendants("row")
                                  .Where<XElement>(i => i.Attribute("r").Value == rowNumber.ToString())
                                  .FirstOrDefault<XElement>())
    .FirstOrDefault<XElement>(); 
```

一般来说，确定 Linq to Xml 查询是否优化的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T17:21:23.883

最好的方法是：

```
var row = testElement
   .XPathSelectElements("sheetData/row[@r='2']")
   .FirstOrDefault(); 
```

不重复`Where`调用的纯 LINQ 查询：

```
var row = testElement
    .Descendants("sheetData")
    .Descendants("row")
    .Where(x => x.Attribute("r").Value == "2")
    .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T17:21:01.653

```
//if sheetData appears multiple times
    XElement rowElement = testElement
        .Descendants("sheetData")
        .SelectMany(s=>s.Descendats("row))
        .Where(i=>i.Attribute("r").Value == rowNumber.ToString());
//if sheetData appears once
    XElement rowElement = testElement
        .Element("sheetData")
        .Descendants("row))
        .Where(i=>i.Attribute("r").Value == rowNumber.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T17:22:17.577

您的代码中的 Select 子句不是多余的吗？Where`IEnumerable<XElement>`已经返回一个。我认为

```
var row = testElements.Descendents("row").Where(e => (int)e.Attribute("r") == rowNumber).SingleOrDefault(); 
```

应该做你想做的

# design-patterns - 将第 3 方 Web 服务安装到您的应用程序设计中

> ID：663097
> 
> 赞同：0
> 
> 时间：2009-03-19T17:12:27.897
> 
> 标签：design-patterns

我们有一个每天运行几次（通过 Windows 服务）的进程，管理员级别的用户也可以随时调用（通过 Web 应用程序）。这个过程通过网络服务从合作伙伴那里获取数据集，然后我们将这些数据与我们自己格式的本地副本合并。很简单。

我的问题是这如何适合我们的应用程序设计。我们有一个相当直接的应用程序服务层，它与我们的存储库交互以处理我们的域对象。域是持久性无知的。

这个过程应该如何适应这个架构？我们要不要，

1.  将大部分逻辑放在应用程序服务中？只需让它调用 3rd 方服务，从存储库中获取我们的本地对象并执行更新/添加/等操作并保存回存储库。基本上只是将 3rd 方服务视为另一个存储库。
2.  让应用服务获取我们的本地数据（暂时不用担心数据量），将其传递给将调用 3rd 方服务的域级服务，根据需要合并数据，然后将新数据集返回给应用服务以提交到存储库？
3.  其他选择……</li>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T18:47:37.420

我会尝试远程服务网关“模式”。
下面是从 Ajax 的角度来看这个概念的链接，而不是一个过程。然而，当我在 2006 年第一次看到 Dobbs Architecture and Design world 提出的概念时，这个例子更像你的案例 - 一个服务偶尔调用一次。

[http://blog.ontheheap.com/2008/06/06/ajax-and-the-service-gateway-pattern/](http://blog.ontheheap.com/2008/06/06/ajax-and-the-service-gateway-pattern/)

链接中的示例提供了基础知识。在这种情况下，它不必进行翻译。但是，网关可以分成不同的部分，以便它包括转换层或数据合并层。

我用这种方法取得了成功。

# jquery - 如何使用 jquery 在 asp.net mvc 中交替表行颜色？

> ID：663107
> 
> 赞同：4
> 
> 时间：2009-03-19T17:14:21.323
> 
> 标签：jquery

可能是一个愚蠢的问题，但我是 MVC 和 jQuery 的新手。我想改变表格的行颜色，我决定使用 jQuery 来完成。我知道我可以编写扩展方法（[http://haacked.com/archive/2008/08/07/aspnetmvc_cycle.aspx](http://haacked.com/archive/2008/08/07/aspnetmvc_cycle.aspx)）等，但是在阅读了 SH 对[http://haacked.com/archive上文章的评论之后/2008/05/03/code-based-repeater-for-asp.net-mvc.aspx](http://haacked.com/archive/2008/05/03/code-based-repeater-for-asp.net-mvc.aspx)我选择了 jQuery 作为我想要实现的解决方案。

我想实现[http://www.packtpub.com/article/jquery-table-manipulation-part2](http://www.packtpub.com/article/jquery-table-manipulation-part2)中描述的方法，但我还没有弄清楚将初始 jQuery 调用放在哪里（例如：$(document).ready （功能（） {...}）;

就像我说的，我是 jQuery 的新手......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T17:17:53.063

您可以通过在表的所有偶数行上设置一个类来完成此操作。

```
<html>
    <head>
        <title>Example Title</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('tr:even').addClass('alt-row-class');
            });
        </script>
    </head>
    <body>...</body>
</html> 
```

然后使用标准 css 将样式应用于该类：

```
.alt-row-class { background-color: green; } 
```

一位评论者正确地指出，您可能希望使用选择器 ( `tr:even`) 来获得您想要的相对于`tbody`,`thead`和`tfoot`元素的结果。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-19T17:27:46.627

请注意，如果您使用 jQuery 并且用户关闭了 javascript，则您的 UI 不会按照您想要的方式设置样式。您可能需要考虑为视图代码本身的样式分配 CSS 类。

```
 @{ var alternating = false;
      foreach (var row in Model) {
          <tr class='@(alternating ? "alternating-row" : "normal-row")'>
          ...
          alternating = !alternating;
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:16:12.507

如果您使用 jQuery 插件[Tablesorter](http://tablesorter.com/docs/index.html)，它有一个内置的“小部件”，称为“斑马”（在所有其他功能中）。

# visual-studio - VMware Workstation overrides VS2008 hotkeys

> ID：663117
> 
> 赞同：0
> 
> 时间：2009-03-19T17:16:07.840
> 
> 标签：visual-studio, vmware, hotkeys

I recently installed VMware Workstation on my computer, and it is causing me some trouble. I'm used to pressing F6 to build in VS2008, but Workstation keeps replacing the hotkey for build with Ctrl+Alt+B, and assigning its own hotkey to F6\. Every time I change the hotkey back and restart VS, VMware messes it up again. How do I get my hotkey back without uninstalling Workstation?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T00:07:38.150

我建议在 VMware 论坛上询问，有很多人抱怨它弄乱了 VS2005 热键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T18:29:33.640

VMWare 用于从客户操作系统中取消键盘/鼠标输入的默认组合键是 Control + Alt。您可以从编辑->首选项->热键选项卡将组合键更改为其他内容（可能是 ctrl + win？）。

# c# - SQL Server CLR 集成生命周期是什么？

> ID：663124
> 
> 赞同：8
> 
> 时间：2009-03-19T17:19:05.947
> 
> 标签：c#, .net, sql-server, sql-server-2005, stored-procedures

如何在 SQL Server 中管理 CLR (.NET) 对象？

SQL Server 中任何 CLR 代码的入口点都是静态方法。通常，您只会创建存在于该方法范围内的对象。但是，您可以想象将对象的引用存储在静态成员中，让它们脱离方法调用范围。如果 SQL Server 跨多个存储过程/函数调用将这些对象保留在内存中，那么它们可能对缓存应用程序很有用——尽管它们也会更危险。

SQL Server 如何处理这个问题？它甚至允许（非方法）静态成员吗​​？如果是这样，它会在内存中保留多长时间？每次 CLR 调用后它会垃圾收集所有内容吗？它如何处理并发？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-28T19:04:17.087

在 Robin Dewson 和 Julian Skinner 的“Pro SQL Server 2005 程序集”中，它说“加载到数据库中的程序集与其他数据库对象一样，由数据库用户拥有。同一数据库中同一用户拥有的所有程序集都将运行在同一个 AppDomain 中。不同用户拥有的程序集将在单独的 AppDomain 中运行。”

这告诉我的是，如果您正在使用单个数据库并且使用 CREATE ASSEMBLY 语句加载的所有程序集都具有相同的所有者，那么您的程序集将全部在同一个应用程序域中运行。但是，在同一个 AppDomain 中并不意味着使用相同的代码库，因此即使同一个 dll 可以多次加载到同一个应用程序域中，并且它的类型不会匹配，即使它们具有相同的名称。当同名类型来自不同的代码库时，它们的静态变量也将是不同的实例。

我可以看到在具有多个程序集的 SQL Server CLR 环境中安全地使用静态变量的唯一方法是实际上只使用一个程序集。您可以使用带有“UnionMerge”选项的 ILMerge 实用程序将所有程序集打包成一个并合并具有相同名称的类。这应该保证对于给定的数据库，在您的唯一程序集中，您的静态变量将像在独立应用程序中一样工作。我认为可以安全地假设应用程序域不会在每次请求时都被卸载和重新加载，但你不能依赖它永远不会被卸载，因为只要有未处理的错误就会发生这种情况（至少如果它在不安全模式下运行）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-28T14:24:41.993

如果程序集以不安全权限级别部署，SQL Server 允许静态只读成员。

实际上，对象会保留在内存中，直到 SQL 服务停止/重新启动。

关于并发性，您的对象和方法应该像其他任何地方一样是线程安全的。

例如：

```
public static class MyCLRClass
{
    private static readonly ReaderWriterLock rwlock = new ReaderWriterLock();
    private static readonly ArrayList list = new ArrayList();

    private static void AddToList(object obj)
    {
        rwlock.AcquireWriterLock(1000);
        try
        {
            list.Add(obj);
        }
        finally
        {
            rwlock.ReleaseLock();
        }
    }

    [SqlProcedure(Name="MyCLRProc")]
    public static void MyCLRProc()
    {
        rwlock.AcquireReaderLock(1000);
        try
        {
            SqlContext.Pipe.Send(string.Format("items in list: {0}", list.Count));
        }
        finally
        {
            rwlock.ReleaseLock();
        }
    }
} 
```

我在 SQL CLR 中使用了这些东西，它可以工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-05T06:26:32.733

不可想象；你非常可以创建静态成员。但是，它们需要标记为`readonly`具有`PERMISSION_SET`或`SAFE`的程序集`EXTERNAL_ACCESS`。只有标记为的程序集`UNSAFE`可以具有可写静态成员。这种限制是由于静态成员的本质：它们在线程和会话之间共享*。*

程序集在第一次访问其中的方法时被加载。它共享给所有会话使用，这就是为什么只能访问静态方法的原因。这个想法是编写函数，而不是应用程序，因此保持状态没有太多用处。如果各种会话相互覆盖，它很容易（尽管肯定不总是）导致不可预测的行为。所以根本不处理并发，除非你自己写那部分。

应该预计，一旦加载，类（以及它所在的应用程序域）将保留在内存中，直到 SQL Server 服务重新启动或`PERMISSION_SET`值更改。但这不能保证。根据此页面，[SQL CLR 中的内存使用情况](http://blogs.msdn.com/b/sqlclr/archive/2006/03/24/560154.aspx)：

> 当服务器上存在内存压力时，SQL CLR 将尝试通过显式运行垃圾回收并在必要时卸载应用程序域来释放内存。

所以你在关于静态成员的两个方面都是正确的：

*   它们可用于缓存（非常酷）
*   它们可能更危险：
    *   它们可能导致意外行为
    *   它们可以占用内存，因为没有固有的机制或自然事件来清理它们，因为类保持活跃。

And, the amount of memory available for CLR routines varies greatly depending on whether SQL Server is 32 or 64 bit, and whether you are using SQL Server 2005 / 2008 / 2008 R2 or using SQL Server 2012 / 2014\. For more info on how much memory SQLCLR has to play with, check out [SQL Server 2012 Memory](http://mssqlwiki.com/tag/sql-server-2012-memory-architecture/) and [Memory Usage in SQL CLR](http://blogs.msdn.com/b/sqlclr/archive/2006/03/24/560154.aspx) (same as the first link, posted above the quote).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T23:44:43.510

这是我找到的一些信息。

[SQLCLR 中共享状态和匿名委托的问题](http://www.hedgate.net/articles/2006/10/04/troubles-with-shared-state-and-anonymous-delegates-in-sqlclr/)

不仅在非 UNSAFE 程序集中不允许共享状态，而且匿名代表（不幸的是）触发了这种“共享状态”限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T17:33:28.440

来自 C# 规范 3.0 (5.1.1)

> 静态变量在执行其包含类型的静态构造函数（第 10.12 节）之前就存在，并在关联的应用程序域不存在时不存在。

当然，它不会在每次调用后关闭整个应用程序域，因为它会有点低效。所以是的，只要数据库没有停止或重新启动，这些静态对象就会保留在那里。

# c# - 有没有办法检查是否调用了所有定义的函数？

> ID：663129
> 
> 赞同：1
> 
> 时间：2009-03-19T17:20:58.313
> 
> 标签：c#, visual-studio-2005

有没有办法确定代码中定义的每个函数是否在某处被调用？

我一直在对我的一个大型项目进行重大代码更新，我想确保从代码中删除不再使用的旧功能。

有没有比在解决方案中搜索每个函数更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T17:31:28.773

将您尝试删除的每个方法标记为[已过时](http://msdn.microsoft.com/en-us/library/system.obsoleteattribute.iserror.aspx)并`IsError`设置为`true`。当您将方法标记为此类时，您将收到编译错误，并且能够确定您是否可以*安全地*删除该方法。

```
 [Obsolete("Don't use this method", /* IsError */ true)]
    public void Foo () {} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:26:01.907

[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)应该能够找到孤立/未使用的方法。我认为静态分析是您要寻找的，而不是代码覆盖率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T17:23:04.690

像 NCover 这样的代码覆盖工具？

编辑：这假设您对功能进行了足够的测试，并决心摆脱所有不必要的功能。Delete-then-compile 可以工作，但不可扩展。无论如何，关键是您将需要某种源分析工具（静态或运行时分析）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T17:23:47.667

这是一种可以捕捉除反射之外的所有内容的方法。

1.  删除方法
2.  编译

这似乎有点矫枉过正，但它的优点是您可以通过删除多个函数来“批量”查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T17:28:12.710

两个建议：

*   根据您的开发工具，您可能能够为已声明但从未调用的函数生成警告。

*   您可以生成链接器映射，然后将其函数列表与您直接从源生成的列表（使用`grep`或`ctags`？）进行比较。

# windows - 检测终止的挂起应用程序

> ID：663133
> 
> 赞同：1
> 
> 时间：2009-03-19T17:21:24.100
> 
> 标签：windows, debugging, freeze, hung

我创建了一个运行和调试进程的最小调试循环。

当进程挂起并且用户尝试关闭它时，Windows 会提供消息框，其中包含等待或立即结束的选项。我想尝试检测它们现在何时结束，以便我的调试器可以收集相关信息。但是我似乎无法弄清楚如何检测这种情况。线程和进程退出代码保持在 0。有一次我以为它们返回 0xCFFFFFFF，但这种情况不再发生。

或者，也许可以修改一些注册表项以在应用程序关闭后运行此调试器，例如 Dr. Watson。也许这只是我的机器，但我似乎无法在关闭挂起的应用程序时启动调试器（VS JIT 调试、Watson 博士等）。

我知道这一定是可能的，因为我以前见过 HUNGAPP 转储。

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T00:21:21.427

有一个关于该主题的[msdn 博客系列](http://blogs.msdn.com/wer/archive/2009/03/19/let-there-be-hangs-part-3-the-hungapp-module.aspx)，其中描述了 Windows 如何处理崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:00:21.877

您可以使用 WinDbg 出于相同目的运行您的应用程序，当应用程序挂起时，它会为您生成转储文件。

# proxy - 将 DNS 保存在一处。有哪些可能性？

> ID：663142
> 
> 赞同：0
> 
> 时间：2009-03-19T17:23:52.720
> 
> 标签：proxy, dns, load-balancing, a-records

我为一些客户托管了几个网站。所以基本上他们所做的就是将他们的 A 记录更改为我的服务器的 IP，一切正常。

现在我想升级我的服务器，当然我的客户必须更改他们的 A 记录。

所以我未来想要的是保持我在选择服务器时的灵活性，而不必因为更改他们的 A 记录而惹恼我的客户。

基本上，好的服务是可靠的，让我可以将 A 记录重定向到新服务器。我还想过使用第二台服务器作为负载平衡器。

任何人都对这些解决方案有很好的经验，甚至有其他想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T17:32:44.057

您的客户可以创建一个`www`子域而不是`www`A 记录，并将该域委托给您的 DNS 服务器。然后，您可以决定使用默认`*` A 记录将用户的 HTTP 请求发送到哪个网络服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T17:34:06.253

我们托管自己的 DNS 服务器，并指示客户端将域指向它们。真的没有其他*好的*方法来处理它。就负载平衡而言，获取负载平衡器（专用硬件或软件设备）并将其设置为将信息从负载平衡器上的公共 IP 路由到服务器的私有 IP。这使您可以灵活地在内部移动服务器，而无需更改公共 IP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T17:30:49.740

您正在寻找的是动态 DNS 服务（有*很多*），或者只是运行您自己的 DNS 服务器并让您的客户使您的服务器对其域具有权威性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T15:15:08.407

在您的区域中创建一个 www.myhostingservice.example 并要求您的客户将 www.clientdomain.example 设为指向 www.myhostingservice.example 的别名 (CNAME)。

# linq - 如何一次查询多个实体？

> ID：663143
> 
> 赞同：3
> 
> 时间：2009-03-19T17:23:58.773
> 
> 标签：linq, linq-to-entities

我正在尝试查询实体以基于过滤器返回多行。

例如在 SQL 中，我们有：

```
SELECT * FROM table WHERE field IN (1, 2, 3) 
```

如何在 LINQ to Entities 中执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T14:54:32.277

虽然我确实收到了一些及时的答案，但我感谢大家。我收到的回复中显示的方法不起作用。

[我不得不继续搜索，直到我最终在Microsoft 论坛](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/095745fe-dcf0-4142-b684-b7e4a1ab59f0)的 Frederic Ouellet 的帖子中找到了一种方法来做我需要的事情。

简而言之，它是下面的扩展方法：

```
 public static IQueryable<T> WhereIn<T, TValue>(this IQueryable<T> source, Expression<Func<T, TValue>> propertySelector, params TValue[] values)
    {
        return source.Where(GetWhereInExpression(propertySelector, values));
    }

    public static IQueryable<T> WhereIn<T, TValue>(this IQueryable<T> source, Expression<Func<T, TValue>> propertySelector, IEnumerable<TValue> values)
    {
        return source.Where(GetWhereInExpression(propertySelector, values));
    }

    private static Expression<Func<T, bool>> GetWhereInExpression<T, TValue>(Expression<Func<T, TValue>> propertySelector, IEnumerable<TValue> values)
    {
        ParameterExpression p = propertySelector.Parameters.Single();
        if (!values.Any())
            return e => false;

        var equals = values.Select(value => (Expression)Expression.Equal(propertySelector.Body, Expression.Constant(value, typeof(TValue))));
        var body = equals.Aggregate<Expression>((accumulate, equal) => Expression.Or(accumulate, equal));

        return Expression.Lambda<Func<T, bool>>(body, p);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T17:29:12.460

你可以这样做：

```
int[] productList = new int[] { 1, 2, 3, 4 };

var myProducts = from p in db.Products
                 where productList.Contains(p.ProductID)
                select p; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:29:09.603

这是您在 SQL 中的查询的精确表示。

int[] productList = new int[] { 1, 2, 3};

```
var myProducts = from p in db.Products
                 where productList.Contains(p.ProductID)
                select p; 
```

如果是实体，您能否更好地描述问题？

确切的 SQL 表示将是......

```
SELECT [t0].[ProductID], [t0].[Name], [t0].[ProductNumber], [t0].[MakeFlag], [t0].[FinishedGoodsFlag], 
[t0].[Color], [t0].[SafetyStockLevel], [t0].[ReorderPoint], [t0].[StandardCost], [t0].[ListPrice], 
[t0].[Size], [t0].[SizeUnitMeasureCode], [t0].[WeightUnitMeasureCode], [t0].[Weight], [t0].[DaysToManufacture], 
[t0].[ProductLine], [t0].[Class], [t0].[Style], [t0].[ProductSubcategoryID], [t0].[ProductModelID], 
[t0].[SellStartDate], [t0].[SellEndDate], [t0].[DiscontinuedDate], [t0].[rowguid], [t0].[ModifiedDate]
FROM [Production].[Product] AS [t0]
WHERE [t0].[ProductID] IN (@p0, @p1, @p2, @p3) 
```

# asp.net - 为什么我在安装 IE8 后无法从 Visual Studio 2005 调试？

> ID：663144
> 
> 赞同：32
> 
> 时间：2009-03-19T17:24:18.773
> 
> 标签：asp.net, debugging, visual-studio-2005, internet-explorer-8

我刚刚安装了 IE8（最终版）并重新启动。我无法再在 Windows Server 2003 Enterprise R2 上使用 Visual Studio 2005 调试 Web 应用程序项目。我收到消息“Internet Explorer 无法显示网页”，然后 WebDev.WebServer.exe 退出，没有可见的错误消息，事件查看器中也没有任何内容。

有没有人有任何想法？

没有帮助的事情：

*   将 localhost 添加到受信任的站点
*   将端口更改为 8080 或 80
*   检查我的主机文件（里面只有 127.0.0.1 localhost）

有点帮助的事情：

*   使用 CTRL-F5 运行（不是调试），效果很好（除非您需要调试）
*   将默认的 Visual Studio 浏览器更改为 Firefox，它允许我进行调试

我的主机文件包含：

```
# Copyright (c) 1993-1999 Microsoft Corp.
#
# This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
#
# This file contains the mappings of IP addresses to host names. Each
# entry should be kept on an individual line. The IP address should
# be placed in the first column followed by the corresponding host name.
# The IP address and the host name should be separated by at least one
# space.
#
# Additionally, comments (such as these) may be inserted on individual
# lines or following the machine name denoted by a '#' symbol.
#
# For example:
#
#      102.54.94.97     rhino.acme.com          # source server
#       38.25.63.10     x.acme.com              # x client host

127.0.0.1       localhost 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-23T12:54:11.153

我的一位同事遇到了类似的问题并发现了这一点：

> IE 8 有一个称为松耦合 Internet Explorer (LCIE) 的功能，它导致 IE 跨多个进程运行。
> 
> [http://www.microsoft.com/windows/internet-explorer/beta/readiness/developers-existing.aspx#lcie](http://www.microsoft.com/windows/internet-explorer/beta/readiness/developers-existing.aspx#lcie)
> 
> 旧版本的 Visual Studio 调试器对此感到困惑，无法弄清楚如何附加到正确的进程。您可以通过禁用 LCIE 的进程增长功能来解决此问题。就是这样：
> 
> 1.  打开注册编辑
> 2.  浏览到 HKEY_LOCALMACHINE -> SOFTWARE -> Microsoft -> Internet Explorer -> Main
> 3.  在此键下添加一个名为 TabProcGrowth 的 dword
> 4.  将 TabProcGrowth 设置为 0
> 
> 由于您在 Windows Server 2003 上运行，这就是您需要做的所有事情。如果您在 Vista 或更新版本上遇到同样的问题，您还需要关闭保护模式。

信用：Brad Sullivan，项目经理，Visual Studio 调试器，MSFT

资料来源：[http ://social.microsoft.com/Forums/en-US/vsdebug/thread/e2c795cd-b7a0-4fad-b7c9-b1ca40d7302e](http://social.microsoft.com/Forums/en-US/vsdebug/thread/e2c795cd-b7a0-4fad-b7c9-b1ca40d7302e)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T20:01:46.337

我最近在安装 Windows Vista 更新后遇到了类似的问题。基本上更新更改了主机文件，这导致了您描述的相同问题。

显然，hosts文件中的条目需要以三个冒号作为前缀，即：

:::1 本地主机

由于某种原因，对 Vista 的更新将其更改为两个冒号。我不确定你是否有同样的问题，但听起来值得一试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T21:30:57.273

如果您在 IE8 和 Visual Studio 2008 中遇到此问题，请修改您的主机文件并将 localhost 指向 127.0.0.1：

# ::1 本地主机

127.0.0.1 本地主机

# c++ - 任何重载布尔运算符的库？

> ID：663145
> 
> 赞同：1
> 
> 时间：2009-03-19T17:24:25.187
> 
> 标签：c++, operator-overloading, boolean

您是否见过任何重载布尔运算符的库/代码，据说这是邪恶的？它给用户带来了什么好处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T17:28:25.067

标准库本身重载**operator ！**对于输入流，也许“邪恶”有点强？

但我怀疑你在谈论**&&**和**||** . 不重载这些的原因是它们的短路能力不能在用户定义的重载中复制，而且我不知道有任何库重载它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:28:17.937

不知道有没有人做过，但是|| ~~ORACLE~~ SQL 将其用作字符串连接。看这里：

[http://www.java2s.com/Code/Oracle/Char-Functions/StringStringconcatenatestwostrings.htm](http://www.java2s.com/Code/Oracle/Char-Functions/StringStringconcatenatestwostrings.htm)

所以，如果你想创建一个在 C++ 中模仿~~Oracle~~ SQL 并且有一个 SQLString 类的库，我猜想使用 || for 连接将被认为是正常的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T17:32:06.367

重载布尔运算符正是为此有用 - 当您希望您的类型能够像布尔值一样表现时。
像任何其他语言功能一样，它既有优点也有危险。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T17:42:40.087

很好的文章，描述了为什么要小心操作员 bool
[http://www.artima.com/cppsource/safebool.html](http://www.artima.com/cppsource/safebool.html)

boost 有操作符重载的助手

重载此运算符时，您应该谨慎行事。例如 something::operator != 应该和 ! 某事::操作员 ==

# c# - 如何测试 C# Hashtable 是否包含特定的键/值对？

> ID：663150
> 
> 赞同：7
> 
> 时间：2009-03-19T17:26:35.680
> 
> 标签：c#, hashtable

在遍历表时，我将一堆所谓的唯一项目 ID 作为键存储，并将文件位置作为哈希表中的值存储。当我运行它时，我需要确保它们的键/位置对是唯一的或抛出错误消息。我已经设置了哈希表并正在加载值，但不确定要测试什么：

```
Hashtable check_for_duplicates = new HashTable();
foreach (object item in items)
{
    if (check_for_duplicates.ContainsKey(item["ItemID"]) &&
        //what goes here?  Would be contains item["Path"] as the value for the key)
    {
        //throw error
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T17:30:08.743

试试这个：

```
Hashtable check_for_duplicates = new HashTable();
foreach (object item in items)
{
    if (check_for_duplicates.ContainsKey(item["ItemID"]) &&
        check_for_duplicates[item["ItemID"]].Equals(item["Path"]))
    {
        //throw error
    }
} 
```

此外，如果您使用的是 .NET 2.0 或更高版本，请考虑使用泛型，如下所示：

```
List<Item> items; // Filled somewhere else

// Filters out duplicates, but won't throw an error like you want.
HashSet<Item> dupeCheck = new HashSet<Item>(items); 

items = dupeCheck.ToList(); 
```

实际上，我刚刚检查过，看起来 HashSet 只是 .NET 3.5。字典更适合 2.0：

```
Dictionary<int, string> dupeCheck = new Dictionary<int, string>();

foreach(Item item in items) {
    if(dupeCheck.ContainsKey(item.ItemID) && 
       dupeCheck[item.ItemID].Equals(item.Path)) {
        // throw error
    }
    else {
        dupeCheck[item.ItemID] = item.Path;
    }    
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T17:29:06.297

如果您`Dictionary`改用该方法，则该`TryGetValue`方法会有所帮助。我不认为对于几乎不推荐使用的`Hashtable`类有更好的方法。

```
object value;
if (dic.TryGetValue("key", out value) && value == thisValue)
  // found duplicate 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T17:29:46.827

```
if (check_for_duplicates.ContainsKey(item["ItemID"]) &&
    check_for_duplicates[item["ItemID"]] == item["Path"])
{
    //throw error
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T17:32:12.360

ContainsKey 是最好的方法。

如果您不被迫使用 .NET 1.1，我会使用 .NET 2.0 中引入的 Dictionary。

从性能上看，它比 Hashtable 好得多，并且是强类型的。

```
Dictionary<string, int> betterThanAHash = new Dictionary<string, int>();

betterThanAHash.ContainsKey("MyKey"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T17:34:56.953

```
Hashtable check_for_duplicates = new HashTable();

foreach (object item in items) 
{
    if (check_for_duplicates.ContainsKey(item["ItemID"]) && check_for_duplicates[item["ItemID"]] == item["Path"])
    {
        //throw error
    } 
} 
```

我相信这就是你要找的。

编辑 - 看起来我被打败了：P

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-19T18:23:56.103

为什么不使用 a[`Dictionary`](http://msdn.microsoft.com/en-us/library/xfhwa508(VS.80).aspx)代替？

如果您尝试`Add`使用已存在于`Dictionary`.

这样，您可以在添加副本时立即捕获副本，而不是`check_for_duplicates`稍后执行测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-19T17:31:28.710

这有点取决于 items 数组是什么......你会想要这样的东西：

```
check_for_duplicates.ContainsValue(item["Path"]); 
```

假设该项目是某种形式的查找。确实，您需要强制转换项目，或使用类型系统通过索引实际访问任何值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-17T17:51:19.527

你没有说你使用的是什么版本的东西。您是否有理由必须使用 Hashtable 与 HashSet？如果您的数据结构不允许重复，则无需检查重复项。也可以看看：

[http://www.vcskicks.com/csharp_data_structures2.html](http://www.vcskicks.com/csharp_data_structures2.html)

除此之外，这里已经回答了如何在 Hashtable 中完成同样的事情的问题。我只是指出，如果你一开始就禁止，你就不需要做所有的病理检查。

# sql - 将数据从现有行复制到 SQL 中的另一现有行？

> ID：663154
> 
> 赞同：52
> 
> 时间：2009-03-19T17:27:02.090
> 
> 标签：sql, insert, copy, row

我有一张表，其中包含特定课程的跟踪数据，课程编号 6。

现在，我为 11 号课程添加了新的跟踪数据。

每一行数据是针对一门课程的一个用户，因此对于分配给课程 6 和课程 11 的用户，有两行数据。

客户希望在 2008 年 8 月 1 日之后的任何时间完成第 6 课程的所有用户也将完成第 11 课程的标记。但是我不能将 6 转换为 11，因为他们想保留第 6 课程的旧数据。

因此，对于课程编号为 6、标记为已完成且大于 2008 年 8 月 1 日的每一行，我想在包含该特定用户的课程 11 跟踪的行上写入完成数据。

我需要将数据从课程 6 行转移到课程 11 行，以便将用户分数和发布完成日期之类的东西移过来。

这是表的结构：

```
userID (int)
courseID (int)
course (bit)
bookmark (varchar(100))
course_date (datetime)
posttest (bit)
post_attempts (int)
post_score (float)
post_date (datetime)
complete (bit)
complete_date (datetime)
exempted (bit)
exempted_date (datetime)
exempted_reason (int)
emailSent (bit) 
```

一些值将是 NULL 并且 userID/courseID 显然不会被保留，因为它已经在正确的位置。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-19T17:40:24.773

也许我读错了问题，但我相信您已经插入了课程 11 记录，只需要使用课程 6 的数据更新符合您列出的标准的记录。

如果是这种情况，您将需要使用`UPDATE`...`FROM`语句：

```
UPDATE MyTable
SET
    complete = 1,
    complete_date = newdata.complete_date,
    post_score = newdata.post_score
FROM
    (
    SELECT
        userID,
        complete_date,
        post_score
    FROM MyTable
    WHERE
        courseID = 6
        AND complete = 1
        AND complete_date > '8/1/2008'
    ) newdata
WHERE
    CourseID = 11
    AND userID = newdata.userID 
```

[有关更多信息，请参阅此相关 SO 问题](https://stackoverflow.com/questions/2334712/update-from-select-using-sql-server)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-19T17:50:25.623

```
UPDATE c11
SET
    c11.completed= c6.completed,
    c11.complete_date = c6.complete_date,
-- rest of columns to be copied
FROM courses c11 inner join courses c6 on
    c11.userID = c6.userID 
    and c11.courseID = 11 and c6.courseID = 6
     -- and any other checks 
```

我一直查看更新的 From 子句，就像普通选择之一。实际上，如果您想在运行更新之前检查将更新的内容，您可以使用选择 c11.* 替换更新部分。请参阅我对跛鸭答案的评论。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-01-21T12:20:05.007

**将一行中的值复制到同一表（或不同表）中的任何其他合格行：**

```
UPDATE `your_table` t1, `your_table` t2
SET t1.your_field = t2.your_field
WHERE t1.other_field = some_condition
AND t1.another_field = another_condition
AND t2.source_id = 'explicit_value' 
```

首先将表别名为 2 个唯一引用，以便 SQL 服务器可以区分它们

接下来，指定要复制的字段。

最后，指定控制行选择的条件

根据条件，您可以从单行复制到系列，也可以将系列复制到系列。您还可以指定不同的表，甚至可以使用子选择或连接来允许使用其他表来控制关系。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-19T17:33:59.640

[使用 SELECT 插入记录](http://www.sqlteam.com/article/using-select-to-insert-records)

```
INSERT tracking (userID, courseID, course, bookmark, course_date, posttest, post_attempts, post_score, post_date, complete, complete_date, exempted, exempted_date, exempted_reason, emailSent) 
SELECT userID, 11, course, bookmark, course_date, posttest, post_attempts, post_score, post_date, complete, complete_date, exempted, exempted_date, exempted_reason, emailSent
FROM tracking WHERE courseID = 6 AND course_date > '08-01-2008' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-19T03:56:28.887

试试这个：

```
UPDATE barang
SET ID FROM(SELECT tblkatalog.tblkatalog_id FROM tblkatalog 
WHERE tblkatalog.tblkatalog_nomor = barang.NO_CAT) WHERE barang.NO_CAT <>''; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-09T00:19:38.747

这适用于处理整个记录。

```
UPDATE your_table
SET new_field = sourse_field 
```

# svn - 如何开始使用 svn:externals？

> ID：663155
> 
> 赞同：84
> 
> 时间：2009-03-19T17:27:25.223
> 
> 标签：svn, tortoisesvn, externals

我正在寻找关于使用 svn:externals 的简洁且编写良好的教程。

我自己已经知道如何以基本方式使用它们，但我想要一篇好文章，在回答最近出现的类似问题时可以链接到：

[如何处理依赖于同一来源的多个项目？](https://stackoverflow.com/questions/662898/what-to-do-with-multiple-projects-depend-on-the-same-source/662905)

我会自己做，但我不经常使用它们，以至于想伸出脖子写一篇教程。谷歌对这个话题毫无帮助。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-19T17:43:39.507

以下是 svnbook / TortoiseSVN 手册中有关它的一些部分：

[这](http://svnbook.red-bean.com/en/1.7/svn.advanced.externals.html)是 svn:externals 上的 svnbook 页面。它是该主题最有用的资源。

[这个](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-howto-common-projects.html#tsvn-howto-common-externals)解释了在工作流中包含子项目的四种方法（并且在这个过程中错过了第五种方法：符号链接）。

最后[一个](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-import.html#tsvn-dug-import-4)是 TortoiseSVN 特定页面，介绍如何在存储库中导入内容（与 svn:externals 没有直接关系）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-01-27T17:36:43.777

如果从上面提供的链接中不清楚，您设置与`svn:externals`特定修订版（固定）相关的属性的方式，这里是：

```
svn propset svn:externals "plugins -r12345 https://svn.example.com/common/plugins" extras 
```

这将`plugins`在该目录下创建一个子目录并将其链接到外部 SVN URL 的`extras`修订版。`12345``https://svn.example.com/common/plugins`

有一篇 Red Bean 文章建议使用，`propedit`因为`svn:externals`可以是多行值。上面的示例将更改如下以使用`propedit`.

```
svn propedit svn:externals extras 
```

然后，您将为每个外部链接添加一行，格式与上面显示的值相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-18T03:02:16.957

```
root/repo1/proj/base/common/log.c
root/repo1/proj/base/common/log.h
root/repo1/proj/base/client

root/repo2/proj/test/base 
```

如上图，我们要将 2 个文件和 1 个目录复制到`repo2`

> 第1步
> 
> 目录：/home/jack/repo2/proj/

```
cd /home/jack 
```

> 第2步

```
svn propset svn:externals "../repo1/proj/base/client proj/base/client" repo2 
```

就像是：`ln repo1/proj/base/client repo2/proj/base/client`

> 第三步

```
export SVN_EDITOR=vim 
```

> 第4步

```
svn propedit svn:externals repo2 
```

vim 显示：

../repo1/proj/base/client proj/base/client

> Step5：添加另外两个文件

```
../repo1/proj/base/client proj/base/client
../repo1/proj/base/common/log.c proj/base/common/log.c
../repo1/proj/base/common/log.h proj/base/common/log.h 
```

# sql - 从两个表中删除行

> ID：663158
> 
> 赞同：1
> 
> 时间：2009-03-19T17:28:00.420
> 
> 标签：sql, cascade, delete-row

我有两张桌子。这些表之间有两个关系。

```
Table 1
   * ID_XPTO (PK)
   * Detail

Table 2
   * ID_XPTO (FK) (PK)
   * ID_XPTO2 (FK) (PK) 
```

这两种关系是存在的。

```
Table 1 -< Table2 
Table 1 -< Table2 
```

我的问题是我需要删除表 1 中的一些行。我目前正在做，

```
declare @table Table (xptoTable2 int)
insert into @table
        select ID_XPTO2
        from Table2 
        where ID_XPTO = @ID_XPTO

delete from Table2
where ID_XPTO = @ID_XPTO

delete from Table
where ID_XPTO in (select xptoTable2from @table) 
```

我知道我可以在 table2 上使用 ON DELETE SET NULL。这样我就可以在 ID_XPTO2 上搜索所有具有空值的行并删除它们，但 DBA 不想使用它。

有没有更好的解决方案来完成这个过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T17:31:10.910

使用`ON DELETE CASCADE`. 它会自动*删除*引用行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:50:39.100

您有以下选择：

*   就像您现在所做的那样，在两个语句中删除。先从 Table2 中删除。

*   如果您的数据库品牌支持多表`DELETE`语法（例如 MySQL），则在一个语句中从两个表中删除。这不是标准的 SQL，但它很方便。

*   使用级联引用完整性约束（我了解您的 DBA 已取消此选项）。

*   在 Table1 上编写一个触发器`BEFORE DELETE`，以删除 Table2 中的任何引用或将其设置为 NULL。请咨询您的 DBA，看看这是否比级联 RI 约束更可接受。

最后，我建议与您的 DBA 交谈并提出您在此处提出的相同问题。找出他/她希望您使用的解决方案。StackOverflow 上的人可以回答技术问题，但听起来您正在处理**IT 政策问题**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T17:33:27.893

你为什么不使用`ON DELETE CASCASE`？

```
DROP TABLE t_f
DROP TABLE t_m
CREATE TABLE t_m (id INT NOT NULL IDENTITY PRIMARY KEY , value VARCHAR(50))
CREATE TABLE t_f (id INT NOT NULL IDENTITY PRIMARY KEY, m INT, CONSTRAINT fk_m FOREIGN KEY (m) REFERENCES t_m(id) ON DELETE CASCADE)
INSERT INTO t_m (value) VALUES ('test')
INSERT INTO t_f (m) VALUES (1)
DELETE FROM t_m
SELECT * FROM t_m
SELECT * FROM t_f

id           value
------------ ------
0 rows selected

id           m
------------ ------
0 rows selected 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T17:47:47.063

我知道的两种方法：

1.  您可以使用 ON DELETE CASCADE

2.  编写您的 SQL 以自行清理，即：

    ```
     DECLARE @DetailCriteria ...

     SET @DetailCriteria = '....'

     BEGIN TRAN
     -- First clear the Table2 of any child records
        DELETE FROM Table2 
        WHERE 
          ID_XPTO IN (SELECT ID_XPTO FROM Table1 WHERE Detail = @DetailCriteria)
          OR ID_XPTO2 IN (SELECT ID_XPTO FROM Table1 WHERE Detail = @DetailCriteria)

     -- Next clear Table2 (which will delete fine because you've followed the referential chain)
        DELETE FROM Table1 WHERE Detail = @DetailCriteria

     -- commit if you're happy (should check @@ERROR first)
     COMMIT 
    ```

# ruby - Need to write a ruby script to create a csv file of the data on the website

> ID：663160
> 
> 赞同：3
> 
> 时间：2009-03-19T17:28:05.690
> 
> 标签：ruby, scripting

There is a website which gives me the information of pin codes of a particular state for example [indian postal website](http://www.indiapost.gov.in/pin/pinsearch.aspx), gives the details when I select the state in the drop down.

I need to write the script in ruby which would create the CSV file with all the data for a particular state.

Today is my first day on ruby and not sure how to approach this. Any help in the right direction would be appreciated.

Thanks

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-19T17:38:37.727

您应该对 FasterCSV gem 感兴趣

[http://fastercsv.rubyforge.org/](http://fastercsv.rubyforge.org/)

```
gem install fastercsv 
```

然后，像这样：

```
require 'fastercsv'
FasterCSV.open("temp.csv", "w") do |csv|
  csv << ["line1row1", "line1row2"]
  csv << ["line2row1", "line2row2"]
  # ...
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T17:42:12.380

您需要澄清/提供更多信息。

*   您是在尝试对该网站进行屏幕抓取，还是在尝试制作类似的内容？
*   如果是前者，您将需要使用 Net::HTTP 和一些正则表达式
*   如果是后者，数据来自哪里（例如，您以什么形式获得它）？

无论如何，ruby 是一种很好的语言。尝试 irb 进行片段的交互式测试。生成 CSV 非常容易，尤其是在您没有任何复杂的字符串字段（例如，可能嵌入引号的内容）的情况下。

屏幕抓取：

*   [使用Net::HTTP](http://www.ruby-doc.org/stdlib/libdoc/net/http/rdoc/index.html)抓取页面
*   使用正则表达式通过正文[grep以挑选出您想要的值](http://www.oreillynet.com/ruby/blog/2007/03/getting_to_know_the_ruby_core.html)
*   [使用字符串插值](http://railsreal.blogspot.com/2007/03/shortening-code-via-string.html)或使用其他答案中提到的包将其转换为 CSV

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T00:30:46.707

您应该能够使用以下 ruby​​ gem 来完成此操作：

*   [机械化](http://mechanize.rubyforge.org/)（与网站交互）
*   [Nokogiri](http://github.com/tenderlove/nokogiri/tree/master)或[hpricot](http://wiki.github.com/why/hpricot)（解析网站的 html 并获取您想要的数据）
*   [FasterCSV](http://fastercsv.rubyforge.org/)（将数据保存为 csv）

您可以在上述 url 和[Google](http://www.google.com/search?q=ruby+scrape+website)上找到每个 gem 的文档和示例。除此之外，一[本关于 Ruby](http://www.humblelittlerubybook.com/book/html/index.html)的书可能有助于提高你的 Ruby 技能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T17:27:37.557

碰巧的是，我最近完成了一个名为 bankjob 的 ruby​​ 程序，它只为一个在线银行网站做这件事。

它是完全开源的并且有文档记录，所以去[bankjob.rubyforge.org](http://bankjob.rubyforge.org)看看吧。

Bankjob 使用 Mechanize、Hpricot（如其他答案中所建议）来抓取一个带有表格的网站并生成 CSV 输出（它还会生成与您的需求无关的 OFX​​ - 因为它是银行对账单数据，但 CSV 应该适用于任何类型的数据）。

您至少应该能够从 Bankjob 开始并删除不需要获取邮政信息的内容，但实际上，您可以按原样使用它，创建一个特定的刮板（已记录在案）来获取您的数据并使用 --csv 选项转储到 csv。

祝你好运

# stored-procedures - how to insert into oledb destination from oledb command

> ID：663165
> 
> 赞同：0
> 
> 时间：2009-03-19T17:28:39.230
> 
> 标签：stored-procedures, ssis, oledbcommand

I'm trying to insert in a ole db destination the result of a sp for each record in an ole db source,

the sp returns a record set

I have found this [how to call a stored procedure in SSIS](http://social.msdn.microsoft.com/Forums/en-US/sqlintegrationservices/thread/ee686cf8-0880-4a1d-8706-ba72fbb2eba8/?ffpr=0#page:1)

but i still can't see the outpout columns in OleDb Command Output Columns

here is my sp:

```
create PROCEDURE [dbo].[GetData] (
    @user        varchar(50)
) AS
set nocount on
-- Publish metadata for ssis
if 1=0
begin
    select '' x, '' y, '' z
end

declare @user_tmp table
(
    x varchar(max),
    y varchar(max),
    z varchar(max)
)

insert into @user_tmp
    select 'x1' x, 'y1' y, 'z1' z

select distinct *  from @user_tmp
set nocount off 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T22:47:47.550

是否可能得到插入语句的结果？尝试 SET NOCOUNT ON。

[http://msdn.microsoft.com/en-us/library/aa259204(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa259204(SQL.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T18:17:43.297

*   一定要使用***OLE DB 源***来获取数据流中存储过程的输出。
*   不要使用***OLE DB 命令***作为源。
*   请使用***OLE DB 目标***作为 OLE DB 源输出的目标（获取 SP 结果数据）。

*   在源和目标之间添加 ETL 设计选择或要求（派生列、数据转换等）。

***OLE DB 命令***用于对每一个经过的行执行一条 SQL，而不是创建数据流，例如您需要逐行类型执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-19T16:47:05.183

我没有尝试过表变量，但我知道如果您使用临时表，SSIS 将无法识别字段，并且表变量可能具有相同的限制。但是，如果您使用 CTE，它将识别这些字段。如果您可以转换为使用 CTE，则您的 proc 可能会起作用。

# python - 如何在 Python 中获取字符串的子字符串？

> ID：663171
> 
> 赞同：2472
> 
> 时间：2009-03-19T17:29:41.583
> 
> 标签：python, string, substring

有没有办法在 Python 中对字符串进行子字符串化，以从第三个字符到字符串末尾获取一个新字符串？

也许喜欢`myString[2:end]`？

如果离开第二部分意味着“直到最后”，如果你离开第一部分，它是否从头开始？

* * *

## 回答 #1

> 赞同：3545
> 
> 时间：2009-03-19T17:30:44.780

```
>>> x = "Hello World!"
>>> x[2:]
'llo World!'
>>> x[:2]
'He'
>>> x[:-2]
'Hello Worl'
>>> x[-2:]
'd!'
>>> x[2:-2]
'llo Worl' 
```

Python 将此概念称为“切片”，它不仅仅适用于字符串。在[这里](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)查看一个全面的介绍。

* * *

## 回答 #2

> 赞同：457
> 
> 时间：2012-03-20T00:58:50.573

只是为了完整性，因为没有其他人提到它。数组切片的第三个参数是一个步骤。所以反转一个字符串很简单：

```
some_string[::-1] 
```

或者选择替代字符是：

```
"H-e-l-l-o- -W-o-r-l-d"[::2] # outputs "Hello World" 
```

通过字符串向前和向后步进的能力与能够从开头或结尾排列切片保持一致。

* * *

## 回答 #3

> 赞同：151
> 
> 时间：2012-08-04T11:43:03.103

Substr() 通常（即 PHP 和 Perl）以这种方式工作：

```
s = Substr(s, beginning, LENGTH) 
```

所以参数是`beginning`和`LENGTH`。

但是 Python 的行为是不同的；它期望开始和 END (!) 之后的一个。**这是初学者很难发现的。**所以 Substr(s, beginning, LENGTH) 的正确替换是

```
s = s[ beginning : beginning + LENGTH] 
```

* * *

## 回答 #4

> 赞同：72
> 
> 时间：2012-03-02T05:19:02.317

实现此目的的常用方法是字符串切片。

`MyString[a:b]`为您提供从索引 a 到 (b - 1) 的子字符串。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2009-03-19T18:02:38.807

这里似乎缺少一个示例：完整（浅）副本。

```
>>> x = "Hello World!"
>>> x
'Hello World!'
>>> x[:]
'Hello World!'
>>> x==x[:]
True
>>> 
```

这是创建序列类型（不是内部字符串）副本的常见习惯用法，`[:]`. 浅复制列表，请参阅*[Python 列表切片语法无明显原因使用](https://stackoverflow.com/questions/323689/python-list-slice-used-for-no-obvious-reason)*。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2017-06-23T21:53:56.940

> 有没有办法在 Python 中对字符串进行子串化，以获取从第 3 个字符到字符串末尾的新字符串？
> 
> 也许喜欢`myString[2:end]`？

是的，如果您将名称 ,分配或[绑定](https://docs.python.org/reference/simple_stmts.html#assignment-statements)`end`到常量单例，这实际上是有效的`None`：

```
>>> end = None
>>> myString = '1234567890'
>>> myString[2:end]
'34567890' 
```

切片表示法有 3 个重要参数：

*   开始
*   停止
*   步

没有给出它们的默认值是`None`- 但我们可以明确地传递它们：

```
>>> stop = step = None
>>> start = 2
>>> myString[start:stop:step]
'34567890' 
```

> 如果离开第二部分意味着“直到最后”，如果你离开第一部分，它是否从头开始？

是的，例如：

```
>>> start = None
>>> stop = 2
>>> myString[start:stop:step]
'12' 
```

请注意，我们在切片中包含了开始，但我们只上升到停止，而不包括停止。

当 step 为`None`时，默认情况下切片`1`用于 step。如果你使用负整数，Python 足够聪明，可以从头到尾。

```
>>> myString[::-1]
'0987654321' 
```

[我在对解释切片符号问题的回答](https://stackoverflow.com/a/24713353/541136)中非常详细地解释了切片符号。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-03-19T17:31:34.060

除了“结束”之外，你已经得到了它。它被称为切片符号。您的示例应为：

```
new_sub_string = myString[2:] 
```

如果省略第二个参数，则它隐含地是字符串的结尾。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2016-08-31T04:28:09.603

我想在讨论中补充两点：

1.  您可以`None`在空白处使用来指定“从开始”或“到结束”：

    ```
    'abcde'[2:None] == 'abcde'[2:] == 'cde' 
    ```

    这在函数中特别有用，因为您不能提供空格作为参数：

    ```
    def substring(s, start, end):
        """Remove `start` characters from the beginning and `end` 
        characters from the end of string `s`.

        Examples
        --------
        >>> substring('abcde', 0, 3)
        'abc'
        >>> substring('abcde', 1, None)
        'bcde'
        """
        return s[start:end] 
    ```

2.  Python 有[切片](https://docs.python.org/3/library/functions.html#slice)对象：

    ```
    idx = slice(2, None)
    'abcde'[idx] == 'abcde'[2:] == 'cde' 
    ```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2019-02-17T13:01:50.863

如果 myString 包含从偏移量 6 开始且长度为 9 的帐号，那么您可以通过以下方式提取帐号`acct = myString[6:][:9]`：

如果 OP 接受这一点，他们可能想以实验方式尝试，

```
myString[2:][:999999] 
```

它有效 - 不会引发错误，也不会发生默认的“字符串填充”。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2020-04-29T18:31:46.270

好吧，我遇到了需要将 PHP 脚本翻译成 Python 的情况，它有很多`substr(string, beginning, LENGTH)`.
如果我选择 Python 的`string[beginning:end]`，我必须计算**很多**结束索引，所以更简单的方法是使用`string[beginning:][:length]`，它为我省去了很多麻烦。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2021-03-29T06:18:29.577

```
str1='There you are'
>>> str1[:]
'There you are'

>>> str1[1:]
'here you are'

#To print alternate characters skipping one element in between

>>> str1[::2]
'Teeyuae'

#To print last element of last two elements
>>> str1[:-2:-1]
'e'

#Similarly
>>> str1[:-2:-1]
'e'

#Using slice datatype

>>> str1='There you are'
>>> s1=slice(2,6)
>>> str1[s1]
'ere ' 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2015-03-18T12:01:43.047

也许我错过了它，但我无法在此页面上找到原始问题的完整答案，因为这里没有进一步讨论变量。所以我不得不继续寻找。

由于我还不能发表评论，让我在这里添加我的结论。访问此页面时，我确定我不是唯一对此感兴趣的人：

```
 >>>myString = 'Hello World'
 >>>end = 5

 >>>myString[2:end]
 'llo' 
```

如果你离开第一部分，你会得到

```
 >>>myString[:end]
 'Hello' 
```

如果你把 : 也留在中间，你会得到最简单的子字符串，这将是第 5 个字符（从 0 开始计数，所以在这种情况下它是空白）：

```
 >>>myString[end]
 ' ' 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-08-31T04:50:52.077

使用硬编码索引本身可能是一团糟。

为了避免这种情况，Python 提供了一个内置对象`slice()`。

```
string = "my company has 1000$ on profit, but I lost 500$ gambling." 
```

如果我们想知道我还剩下多少钱。

正常解决方案：

```
final = int(string[15:19]) - int(string[43:46])
print(final)
>>>500 
```

使用切片：

```
EARNINGS = slice(15, 19)
LOSSES = slice(43, 46)
final = int(string[EARNINGS]) - int(string[LOSSES])
print(final)
>>>500 
```

使用 slice 可以获得可读性。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-07-03T14:26:48.367

```
a="Helloo"
print(a[:-1]) 
```

在上面的代码中，[:-1] 声明从开始打印到最大限制-1。

**输出 ：**

```
>>> Hello 
```

> 注意：这里的 [:-1] 也与 [0:-1] 和 [0:len(a)-1] 相同

```
a="I Am Siva"
print(a[2:]) 
```

**输出：**

```
>>> Am Siva 
```

在上面的代码中，a [2:] 声明从索引 2 到最后一个元素打印 a。

> 请记住，如果您设置打印字符串的最大限制，如 (x)，那么它将打印字符串直到 (x-1)，并且还要记住列表或字符串的索引将始终从 0 开始。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-22T06:55:27.297

我有一个更简单的解决方案，使用**for 循环**在字符串中查找给定的子字符串。假设我们有两个字符串变量，

```
main_string = "lullaby"
match_string = "ll" 
```

如果要检查给定的匹配字符串是否存在于主字符串中，可以这样做，

```
match_string_len = len(match_string)
for index,value in enumerate(main_string):
    sub_string = main_string[index:match_string_len+index]
    if sub_string == match_string:
       print("match string found in main string") 
```

# http - 如何在 .NET 中创建 HTTP 请求侦听器 Windows 服务

> ID：663174
> 
> 赞同：4
> 
> 时间：2009-03-19T17:30:27.900
> 
> 标签：http, service, tcp

我想创建充当 HTTP 侦听器并可以处理大约 500 个客户端的 Windows 服务。这种服务有什么特别的考虑。

我对 HTTPListener 类和 TCPListener 类有点困惑。哪个用于 Windows 服务，它将：

1.  接受客户端连接（500左右）
2.  处理客户请求
3.  调用另一个基于 Http 的服务
4.  向调用客户端返回一些值

* * *

这就是我为启动监听器所做的事情。

```
 listener = new HttpListener();
    listener.Prefixes.Add("http://localhost:8080/");
    listener.Start();
    listener.BeginGetContext(new AsyncCallback(OnRequestReceive), listener);

private void OnRequestReceive(IAsyncResult result)
{
     HttpListener listener = (HttpListener)result.AsyncState;
     // Call EndGetContext to complete the asynchronous operation.
     HttpListenerContext context = listener.EndGetContext(result);
     HttpListenerRequest request = context.Request;
} 
```

我可以同时处理 N 个客户吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T17:54:28.827

如果您需要能够高度响应[`HttpListener`](http://msdn.microsoft.com/library/system.net.httplistener)，则无法很好地扩展（一次不能接受多个连接）。但是对于小规模使用，小心获取上下文并异步编写响应它可以工作。

编辑：似乎我误解`HttpListener`了接受连接的能力。您可以同时接受多个连接（见评论）。然而，IIS 的其他托管代码设施将避免重新发明轮子。因此，除非有非常具体的要求排除 IIS，否则为什么不走捷径呢？

对于严重的使用，使用 IIS，创建一个 Http Handler（实现 IHttpHandler 或 IHttpHandlerFactory 的类，甚至是 IHttpAsyncHandler）来处理请求（这是实现 .aspx 等的底层类型）。

正确的解决方案实际上取决于您所说的“处理大约 500 个客户”的含义：一次一个还是一次全部？

根据评论回答：500 一次，并注意到第 3 步中的处理包括另一个 HTTP 调用，我怀疑使用 HttpListner 是否能够在不确保每个操作都是异步的情况下处理负载（获取上下文和请求，执行向前的 HTTP 请求，然后发送响应）......这将导致一些更困难的编码。

除非有很好的理由避免使用 IIS，否则使用 IIS 会更容易，因为它旨在支持具有丰富功能的大规模客户端请求负载，而 HttpListener “提供了一个简单的、以编程方式控制的 HTTP 协议侦听器。”。

编辑：根据负载的更多细节进行扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T17:46:48.890

我会使用`HttpListener`类。它为你做了很多事情，你不需要重新发明轮子。它还与`http.sys`Windows Server 2003 中的内核模式驱动程序集成，应该提供更好的性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T03:33:37.190

我创建了一个 TcpListener 并使用 BeginAcceptTcpClient 方法启动了监听器。每个传入的请求都被带到一个单独的线程进行处理，其中客户端连接被连续用于从客户端获取/发送数据。它似乎适用于大量客户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-19T21:28:56.410

BeginGetContext 只接受一个请求。每次收到请求时都需要重复异步调用，以便处理多个请求。

有些人通过在循环中同步等待（即使用同步GetContext）的侦听器线程来简化他们的设计。这不是一个好的设计，因为您最终有一个线程坐在那里等待（浪费系统资源），但如果您对性能/概念验证实现不感兴趣，它可能是可以接受的。

您还需要在服务关闭方法中调用 listener.Close()。小心地将其与可能的异步线程处理请求同步。

# sql - 为什么查询中的“Where 1 <> 1”会返回所有行？

> ID：663187
> 
> 赞同：6
> 
> 时间：2009-03-19T17:31:53.577
> 
> 标签：sql, oracle, views

我在继承的应用程序中遇到了一个查询，如下所示：

```
Select *
From foo
where
    1 <> 1 
```

当我解析它时，它应该什么都不返回（`1 <> 1`应该评估为假，对）。但是（至少在我的 Oracle 机器上）它会返回一个完整的`foo`. 当我在 MSAccess/Jet 和 MSSQL 中尝试同样的事情时，我得到了我期望的行为。为什么 Oracle 会有所不同（以及为什么最初的开发人员想要这样做）？

注意：我已经看到一些关于使用“where 1 = 1”的 +s 和 -s 的迷信，它会导致全表扫描；但我认为这不是原始开发人员的意图。

**小更新：**
在这种情况下`foo`是一个视图。当我在一张实际的桌子上尝试同样的事情时，我得到了我所期望的（没有行）。

**更新 2：**
我已经在兔子洞中进一步跟踪代码，并确定他所做的只是试图获取字段/列名。我仍然不知道为什么它会返回完整的记录集。但仅限于意见。

从字面上看，他在字符串中构建查询并将其传递给另一个函数以原样执行。

```
'VB6
strSQL = "SELECT * FROM " & strTableName & " WHERE 1 <> 1" 
```

在这种情况下，strTableName 包含视图的名称。

**更新 3：**
作为参考，这是我遇到问题的视图之一（我更改了字段/表/模式名称）

```
CREATE OR REPLACE FORCE VIEW scott.foo (field1,
                                        field2,
                                        field4,
                                        field5,
                                        field12,
                                        field8,
                                        field6,
                                        field7,
                                        field16,
                                        field11,
                                        field13,
                                        field14,
                                        field15,
                                        field17
                                       )
AS
   SELECT   bar.field1,
            bar.field2,
            DECODE
               (yadda.field9, NULL, 'N',
                DECODE (yadda.field3, NULL, 'Y', 'N')
               ) AS field4,
            bar.field5,
            snafu.field6,
            DECODE
                (snafu.field6,
                 NULL,
                bar.field8,
                   bar.field8
                 - snafu.field6
                ) AS field7,
            DECODE
               (yadda.field10,
                NULL,
            bar.field12,
                yadda.field10
               ) AS field11,
            DECODE
               (SIGN (  yadda.field10 - bar.field12),
                NULL, 'N', 1, 'N', 0, 'N', -1, 'Y'
               ) AS field13,
            bar.field14,
            ADD_MONTHS
               (DECODE (yadda.field10, NULL, bar.field12, yadda.field10
                       ),
                bar.field14 * 12
               ) AS field15,
       FROM clbuttic,
            bar,
            yadda,
            snafu
      WHERE clbuttic.asset_type = bar.asset_type
        AND bar.field16 = yadda.field9(+)
        AND bar.field1 = snafu.field1(+)
        AND (bar.field17 IS NULL)
   ; 
```

附加`Order By 1`（或 foo 上的选择中的某些列名）似乎说服 Oracle 将空集还给我。这是一个长期解决方案，但不是短期解决方案（更改代码和重新部署是主要的 PITA）。我希望数据库端有一个鲜为人知的设置，或者视图中有问题，这是导致这种奇怪行为的原因。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-19T17:34:28.843

好的......为什么这会在 Oracle 中发生，这超出了我的理解。但是，我可以告诉你为什么它经常在其他数据库中使用：当人们想要返回列但没有值时。（例如为新表创建模式）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T17:38:22.187

Oracle 不会为我这样做：

```
SQL*Plus: Release 10.2.0.1.0 - Production on Thu Mar 19 13:36:20 2009

Copyright (c) 1982, 2005, Oracle.  All rights reserved.

Connected to:
Oracle Database 10g Express Edition Release 10.2.0.1.0 - Production

SQL> select * from wrkr where 1 <> 1;

no rows selected

SQL> select count(*) from wrkr;

  COUNT(*)
----------
        88 
```

编辑：视图不是固有的，要么：

```
SQL> create view foo as select * from wrkr;

View created.

SQL> select count(*) from foo;

  COUNT(*)
----------
        88

SQL> select * from foo where 1 <> 1;

no rows selected 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T17:34:34.117

当您要动态生成`WHERE`子句时。这样，您可以只附加一些`OR [another-condition]`子句并使其工作，而无需检查条件是否是第一个条件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-20T12:08:57.497

它绝对看起来像是 Oracle 优化器的视图合并代码中的一个错误。我敢打赌，只有包含外部连接的视图才能获得此信息。你`ORDER BY`解决了它，因为它实际上强制了`NO_MERGE`视图。

不过，我不会在视图中放置一个`ORDER BY`或`NO_MERGE`提示，因为（取决于您的数据量）它可能会降低使用该视图的其他查询的性能。您应该在外部查询中放置一个 no_merge 提示：

```
Select /*+ NO_MERGE(foo) */ *
From foo
where
    1 <> 1 
```

您还应该在 Oracle 支持下提出 SR，因为这绝对是一个错误。无论您选择什么，或者里面有多复杂，该查询都不应该返回任何行。永远不能。

我无法重现它，所以它可能已在我使用的版本中修复。您使用的数据库版本是什么？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-19T17:36:56.137

## 为什么使用 WHERE 1<>1？

我见过的一个地方使用它，甚至自己使用它是一种快速复制表格结构而不复制内容的方法：

```
create table foo2
as select * from foo where 1 <> 1; 
```

（除了我总是使用 != 而不是 <> - 我真的不应该（见比尔的评论））

## 明显的甲骨文错误

如果您有一个案例，当您执行“select * from my_view where 1<>1”时，您可以清楚地证明 Oracle 在 SQL Plus 中返回行，那么您应该联系 Oracle 支持（或让您公司的授权人员这样做） )：这将表明存在重大**错误**。当然，如果您使用的是旧版本的 Oracle，他们可能只会告诉您升级！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-19T23:42:35.993

听起来像是 Oracle 中视图合并代码中的错误。Oracle 会将您的 WHERE 子句合并到视图 SQL 中，然后为此制定计划。

使用此提示尝试您的选择，看看问题是否消失：

```
SELECT /*+ NO_MERGE */ ... 
```

您还可以查看 EXPLAIN PLAN 以了解问题所在。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-19T18:13:38.547

这听起来很奇怪，但是视图/表是否有一个名为“1”的列？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-19T18:45:12.153

只是在这里集思广益，可能是完全错误的，但我想说我已经看到一些 SQL 解析器将未引用的整数解析为“列 X”。您可以通过尝试确认这一点：

从 foo 中选择 1，其中 1 <> 1

如果 1 充满了表第一列的值，您可能希望坚持使用带引号的整数：

SELECT * FROM WHERE '1' <> '1'

但是，再一次，我在这里可能完全错了。我没有方便的 Oracle 安装来试用它。:p

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-19T17:37:45.497

`WHERE 1 = 1` *应该*导致全表扫描，就像`WHERE`完全省略子句一样。如果您要从表中检索每一行，那当然是全表扫描。

我无法评论`WHERE 1 <> 1`未能在 Oracle 上按预期工作。这听起来真的不对。您确定您从*该*查询中看到了您描述的结果吗？再试一次以确定。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-19T17:48:20.043

当您只想返回 SQL 表的所有列时，通常会使用类似的方法。如果它在 Oracle 中不起作用，您可能想尝试类似的错误，例如：

```
Select *
From foo
where
    1 == 2 
```

或者可能

```
where
    key < 0 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-19T17:50:07.463

也许如果您想简单地测试与数据库的连接。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-20T03:52:20.420

使用 ... 查看查询的执行计划将非常有趣

```
explain plan for select ...;

select * from table(dbms_xplan.display); 
```

如果您正在查询视图，那么这可能会显示在错误阶段如何评估谓词

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-19T21:15:17.923

`SELECT`应该没有坏 首先，获取导致此行为的确切查询字符串。直接在数据库上运行查询，而不是通过 VB 6 应用程序。问题是否仍然存在？从那里去。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-19T21:45:54.887

部分解决方案

通过附加`order by 1`以下`where`子句来更新视图。

```
WHERE clbuttic.asset_type = bar.asset_type
    AND bar.field16 = yadda.field9(+)
    AND bar.field1 = snafu.field1(+)
    AND (bar.field17 IS NULL)
order by 1; 
```

它处理了症状（我不必重新编译和重新部署代码），但没有告诉我为什么会出现这种奇怪的行为。

更新：对字符串常量进行排序具有相同的效果，但不会改变计划（如解释计划所示）。我怀疑它会以 1 的顺序更快地执行（我认为应该按第一列排序）。

```
WHERE clbuttic.asset_type = bar.asset_type
    AND bar.field16 = yadda.field9(+)
    AND bar.field1 = snafu.field1(+)
    AND (bar.field17 IS NULL)
order by "a"; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-19T22:04:59.193

与 Cody Casterline 的想法有关：视图中的第 1 列是否可能充满了 NULL 值？如果 Oracle 将 WHERE 解释为“第 1 列中的值不等于第 1 列中的值”并且第 1 列中的值是 NULL，我们就进入了 SQL NULL 的奇怪世界。在我知道的每种 SQL 方言中都是这种情况，NULL=NULL 是不正确的。也许 Oracle 决定 NULL<>NULL 因此必须为真？

# .net - 单元测试中的代码覆盖率

> ID：663197
> 
> 赞同：5
> 
> 时间：2009-03-19T17:33:56.630
> 
> 标签：.net, unit-testing, code-coverage

这是关于 .NET 库 (DLL) 的。

测量单元测试用例涵盖的代码的选项有哪些？它真的值得付出努力（测量代码覆盖率）吗？我想知道覆盖 70% 的代码可能太容易了，而超过 90% 几乎不可能。

[编辑] 另一个有趣的问题（由“E Rolnicki”提出）是：什么被认为是合理的覆盖率？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T17:46:15.990

NCover（商业版和开源版同名）和 Visual Studio 中的代码覆盖工具几乎是您在 MS 世界中的主要工具。

代码覆盖率是一个反向指标。它并没有真正向您展示哪些代码经过充分测试。就像尼克提到的那样，您可以测试该封面，但不要真正测试太多。相反，代码覆盖率会告诉您代码的哪些区域绝对没有测试。从那里，您可以决定为此代码编写测试是否有意义。

一般来说，我认为您应该进行代码覆盖，因为设置起来并不费力，而且它至少为您提供了比以前更多的代码信息。

我同意获取最后一部分代码可能是最困难的，并且可能有一点它的投资回报率没有意义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T17:39:13.027

[NCover](http://www.ncover.com/)将帮助您显示覆盖范围。覆盖范围非常有用，不幸的是它显然可以被玩弄。如果你有糟糕的开发人员覆盖代码只是为了提高 %age，是的，它最终将毫无用处并隐藏未覆盖的区域。一旦你解雇了这些人，你就可以修复它并返回有用的信息。设定无法实现的覆盖目标是获得糟糕覆盖的可靠方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T17:47:11.543

如果你在做测试驱动开发，你的代码应该在不尝试的情况下达到至少 70%。有些领域你不能或没有意义的测试覆盖，这就是 NCover 的 NoCoverage 属性派上用场的地方（你可以标记要被代码覆盖排除的类）。

不应严格遵守代码覆盖率，它应该只是一种有用的方式，可以提示您在测试中遗漏的区域。它应该是你的朋友，而不是纳粹分子！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-19T17:48:45.063

在查看代码覆盖率时需要考虑两件事。

1.  代码覆盖率是一场收益递减的战斗：超过某个点，每增加一个百分比就会产生更少的价值。一些代码（如核心库）应该 100% 覆盖，而 UI 代码/交互可能很难覆盖。
2.  代码覆盖率是一个具有欺骗性的指标：100% 的代码覆盖率并不等同于经过全面测试的应用程序。

以这个片段为例：

```
if (a == 2)
{
    do_A_Stuff();
}

if (b == 3)
{
    do_B_Stuff();
} 
```

运行 a = 2 的测试和 b = 3 的第二个测试。这是 100% 的代码覆盖率。但是当 a = 2 & b = 3 的测试时会发生什么？这些是“变量关系”，可能导致对覆盖率指标的过度自信。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T17:40:30.747

我没有亲自使用它，但我的一位同事对 nCover ( [http://www.ncover.com/](http://www.ncover.com/) ) 发誓。

就覆盖率而言，至少在 Ruby 中，70% 是容易的，90% 是可行的，而 100% 几乎是不可能的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T18:16:53.063

Visual Studio Team System Developer Edition 包括代码覆盖率。这可以在运行单元测试时包括在内。

打开 .testrunco​​nfig 并选择您想要数据的程序集。

# c# - 适用于 Windows Mobile 5.0 的无线网络 API

> ID：663203
> 
> 赞同：1
> 
> 时间：2009-03-19T17:34:30.200
> 
> 标签：c#, windows-mobile, mobile, wireless

我想使用 Windows Mobile 5/6 设备以编程方式获取可用无线网络的列表（通过 SSID）。有谁知道如何做到这一点，或者我可以在哪里找到有关访问 WIFI 适配器的信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T18:42:27.447

OpenNETCF[智能设备框架在](http://smartdeviceframework.com)[OpenNETCF.Net.NetworkInformation](http://opennetcf.com/library/sdf/html/d79a4a4f-93be-3c85-477b-5298d1141978.htm)命名空间中实现了一组相当强大的 WZC API 。

# xml - XMLStarlet：XML 解析错误

> ID：663206
> 
> 赞同：0
> 
> 时间：2009-03-19T17:35:30.383
> 
> 标签：xml, xslt

```
xsltCopyText: text allocation failed
runtime error: element value-of
xsltValueOf: text copy failed 
```

使用 XMLStarlet 解析 XML（实际上是维基百科转储）时出现此错误。我可以获取页面标题和 ID，但是当涉及到页面文本时，它会失败。

使用的表达式：

```
xml sel -N xmlns=http://www.mediawiki.org/xml/export-0.3/ -T -t -m "//xmlns:revision" -v "xmlns:text" -n d:\wiki\translated.wiki.xml 
```

PS我在Windows上做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T16:20:30.790

的内容是`translated.wiki.xml`什么？只需检查前几行，它可能已在某处损坏。

你能在 的一小部分上重现这个问题`translated.wiki.xml`吗？Wikipedia 转储是**巨大的**并且经常崩溃的工具，它们过于贪婪地分配内存。

# c - 如何将 UTF-8 支持和关联的字体表添加到嵌入式项目？

> ID：663207
> 
> 赞同：2
> 
> 时间：2009-03-19T17:35:54.363
> 
> 标签：c, utf-8, embedded

我目前正在为嵌入式显示器设计字体引擎。基本问题如下：

我需要获取一个动态生成的文本字符串，在 UTF-8 表中查找该字符串中的值，然后使用该表指向所有受支持字符的压缩位图数组。完成后，我调用一个位复制例程，将数据从位图数组移动到显示器。

我将不支持完整的 UTF-8 字符集，因为我可以使用的系统资源非常有限（32K ROM，8K RAM），但我希望能够稍后添加所需的字形以用于本地化目的。所有开发都在 C 和汇编中完成。

字形大小最大为 16 位宽 x 16 位高。我们可能需要支持整个基本多语言平面（3 个字节），因为我们的一些大客户在亚洲。但是，我们不会将整个表格包含在任何特定的本地化中。

我的问题是：
添加此 UTF-8 支持和关联表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T21:42:19.480

下面的解决方案假定 Unicode 空间的低 16 位对您来说已经足够了。如果您的位图表在 0x00 到 0x5E 的位置有 U+0020 到 U+007E，在 0x5F 到 0xBE 的位置有 U+00A0 到 U+00FF，在 0xBF 到 0xFF 的位置有 U+1200 到 U+1241，您可以执行类似的操作下面的代码（未经测试，甚至未经编译测试）。

位图包含一系列的值对。第一对中的第一个值是索引 0 处的位图表示的 Unicode 代码点。假设是位图表包含一系列直接相邻的 Unicode 代码点。所以第二个值表示这个系列有多长。

while 循环的第一部分遍历 UTF-8 输入并在 ucs2char 中构建一个 Unicode 代码点。一旦找到一个完整的字符，第二部分在位图中提到的范围之一中搜索该字符。如果找到合适的位图索引，则将其添加到索引中。不存在位图的字符会被静默删除。

该函数返回找到的位图索引数。

就 unicode->bitmap 表而言，这种做事方式应该是内存高效的，相当快且相当灵活。

```
// Code below assumes C99, but is about three cut-and-pastes from C89
// Assuming an unsigned short is 16-bit

unsigned short bitmapmap[]={0x0020, 0x005E,
                            0x00A0, 0x0060,
                            0x1200, 0x0041,
                            0x0000};

int utf8_to_bitmap_indexes(unsigned char *utf8, unsigned short *indexes)
{
    int bitmapsfound=0;
    int utf8numchars;
    unsigned char c;
    unsigned short ucs2char;
    while (*utf8)
    {
        c=*utf8;
        if (c>=0xc0)
        {
            utf8numchars=0;
            while (c&0x80)
            {
                utf8numchars++;
                c<<=1;
            }
            c>>=utf8numchars;
            ucs2char=0;
        }
        else if (utf8numchars && c<0x80)
        {
            // This is invalid UTF-8\.  Do our best.
            utf8numchars=0;
        }

        if (utf8numchars)
        {
            c&=0x3f;
            ucs2char<<=6;
            ucs2char+=c;
            utf8numchars--;
            if (utf8numchars)
                continue; // Our work here is done - no char yet
        }
        else
            ucs2char=c;

        // At this point, we have a complete UCS-2 char in ucs2char

        unsigned short bmpsearch=0;
        unsigned short bmpix=0;
        while (bitmapmap[bmpsearch])
        {
            if (ucs2char>=bitmapmap[bmpsearch] && ucs2char<=bitmapmap[bmpsearch]+bitmapmap[bmpsearch+1])
            {
                *indexes++ = bmpix+(ucs2char-bitmapmap[bmpsearch]);
                bitmapsfound++;
                break;
            }

            bmpix+=bitmapmap[bmpsearch+1];
            bmpsearch+=2;
        }
    }
    return bitmapsfound;
} 
```

编辑：您提到您需要的不仅仅是低 16 位。s/unsigned short/unsigned int/;s/ucs2char/codepoint/; 在上面的代码中，它可以完成整个 Unicode 空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:07:40.610

您没有指定字符的大小或字符集的大小，因此很难估计大小要求。

我会将位图存储为直接数组格式，具体取决于字符的大小，它可能会相当有效地存储，而无需打包/解包元素。

例如，如果我们使用 8x6 字符的 36 字符字母表，则数组需要 216 字节的存储空间。（6 个字节/字符 * 36 - 每个字节都是字符的垂直切片）。

对于解析，只需在表中进行偏移即可。
旧的 (char - 'A') 和 (char - '0') 技巧做得很好。

另一个问题是在哪里存储位图数组。在 ROM 中是显而易见的答案，但如果您需要支持其他字形，则可能需要重新编程，您没有指定是否存在问题。

如果字形必须动态编程，那么您别无选择，只能将其放入 RAM。

# c++ - 有人可以解释一下 Linux 库命名吗？

> ID：663209
> 
> 赞同：21
> 
> 时间：2009-03-19T17:36:25.623
> 
> 标签：c++, linux, shared-libraries

在 Linux 上创建库时，我使用这种方法：

1.  构建：libhelloworld.so.1.0.0
2.  链接：libhelloworld.so.1.0.0 libhelloworld.so
3.  链接：libhelloworld.so.1.0.0 libhelloworld.so.1

版本控制是这样的，如果您更改面向公众的方法，您可以构建到 libhelloworld.so.2.0.0 例如（并将 1.0.0 保留在原处），这样使用旧库的应用程序就不会中断。

但是，将其命名为 1.0.0 有什么意义 - 为什么不坚持使用 libhelloworld.so 和 libhelloworld.so.1？

**此外**，最好的做法是使用 1.0.0 来命名您的库，还是仅使用 1？

```
g++ ... -Wl,-soname,libhelloworld.1 
```

或者：

```
g++ ... -Wl,-soname,libhelloworld.1.0.0 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-19T17:58:38.113

你应该形成 xyz 版本的方式是这样的：

1.  第一个数字 (x) 是库的接口版本。每当您更改公共接口时，此数字都会增加。
2.  第二个数字 (y) 是当前接口的版本号。每当您在不更改公共接口的情况下进行内部更改时，这个数字就会上升。
3.  第三个数字 (z)**不是**内部版本号，它是向后兼容计数。这告诉您支持多少*以前*的接口。例如，如果接口版本 4 严格来说是接口 3 和 2 的超集，但与 1 完全不兼容，则 z=2（4-2 = 2，支持的最低接口号）

因此，x 和 z 数字对于系统确定给定应用程序是否可以使用给定库非常重要，给定应用程序的编译对象。y 数字主要用于跟踪错误修复。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-01-30T16:47:08.400

## 库命名约定

根据[Wheeler](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)的说法，我们有`real name`、`soname`和`linker name`：

```
 Real name  libfoo.so.1.2.3
     Soname  libfoo.so.1
Linker name  libfoo.so 
```

这`real name`是包含实际库代码的文件的名称。`soname`通常是指向 的符号链接，当`real name`接口以不兼容的方式更改时，其编号会增加。最后，这`linker name`是链接器在请求库时使用的，它是没有任何版本号的 soname。

因此，要首先回答您的最后一个问题，您应该[在创建共享库时](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html#AEN95)`soname`使用, `libhelloworld.so.1`, 作为链接器选项：

```
g++ ... -Wl,-soname,libhelloworld.so.1 ... 
```

[在本文档](http://man7.org/conf/lca2006/shared_libraries/slide6.html)中，Kerrisk 提供了一个非常简短的示例，说明如何使用标准命名约定创建共享库。如果您想了解更多有关 Linux 库的信息，我认为[Kerrisk](http://man7.org/conf/lca2006/shared_libraries/index.html)和[Wheeler](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)都值得一读。

## 库编号约定

`real name`关于图书馆中每个数字的意图和目的存在一些混淆。我个人认为[Apache Portable Runtime Project](http://apr.apache.org/versioning.html)很好地解释了每个数字何时应该递增的规则。

简而言之，版本号可以被认为是`libfoo.MAJOR.MINOR.PATCH`.

*   `PATCH`对于与其他版本向前和向后兼容的更改增加。
*   `MINOR`如果库的新版本与旧版本的源代码和二进制兼容，则应递增。不同的次要版本相互向后兼容，但不一定向前兼容。
*   `MAJOR`当引入破坏 API 的更改或与先前版本不兼容的更改时递增。

这意味着`PATCH`版本可能仅在内部有所不同，例如功能的实现方式。**不允许**更改 API、公共函数的签名或函数参数的解释。

新`MINOR`版本可能会引入新函数或常量，并弃用现有函数，但**可能不会删除**任何外部公开的内容。这确保*了向后兼容性*。换句话说，次要版本`1.12.3`可用于替换任何其他`1.12.x` *或更早*版本，例如`1.11.2`或`1.5.0`。不过，它并不是替代品`1.16.1`，因为不同的次要版本不一定是*向前兼容*的。

随着新版本的发布，可以进行任何类型的更改`MAJOR`；常量可能会被删除或更改，（不推荐使用的）函数可能会被删除，当然，通常会增加`MINOR`or数字的任何更改（尽管将此类更改也向后移植到以前的版本`PATCH`可能是值得的）。`MAJOR`

当然，还有一些因素会使这进一步复杂化。您可能已经开发了您的库，以便同一个文件可以[同时保存多个版本](https://docs.google.com/viewer?url=http://people.redhat.com/drepper/dsohowto.pdf&embedded=true#:0.page.36)，或者您可能使用. 但这是另一次讨论。:)`libtool``current:revision:age`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T17:49:57.027

这种方法的主要优点是很容易让用户知道他们拥有哪个版本的库。例如，如果我知道我遇到的错误已在 1.0.4 中修复，我可以轻松检查我链接的库版本，并知道这是否是修复错误的正确方法。

这个数字被称为“共享对象版本”或“soversion”，是 ELF 二进制标准的一部分。[IBM 在http://www.ibm.com/developerworks/power/library/pa-spec12/](http://www.ibm.com/developerworks/power/library/pa-spec12/)上有很好的 ELF 概述。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T23:05:32.403

从我发给同事的一封关于这个问题的旧电子邮件中：

我们以 libxml 为例。首先，共享对象存储在 /usr/lib 中，并带有一系列符号链接来表示可用库的版本：

```
lrwxrwxrwx 1 root root     16 Apr  4  2002 libxml.so -> libxml.so.1.8.14
lrwxrwxrwx 1 root root     16 Apr  4  2002 libxml.so.1 -> libxml.so.1.8.14
-rwxr-xr-x 1 root root 498438 Aug 13  2001 libxml.so.1.8.14 
```

如果我是 libxml 的作者并且我推出了一个新版本 libxml 2.0.0，它破坏了与以前版本的接口兼容性，我可以将它安装为 libxml.so.2 和 libxml.so.2.0.0。请注意，由应用程序程序员负责他链接到的内容。如果我真的是肛门，我可以直接链接到 libxml.so.1.8.14，任何其他版本都会导致我的程序无法运行。或者我可以链接 libxml.so.1 并希望 libxml 开发人员在 1.X 版本中不会破坏我的符号兼容性。或者，如果您不在乎并且鲁莽，只需链接到 libxml.so 并获取任何版本。有时，当有足够多的人这样做时，图书馆作者必须在以后的版本中发挥创意。因此，libxml2：

```
lrwxrwxrwx 1 root root     17 Apr  4  2002 libxml2.so.2 -> libxml2.so.2.4.10
-rwxr-xr-x 1 root root 692727 Nov 13  2001 libxml2.so.2.4.10 
```

请注意，此文件中没有 libxml2.so。看起来开发人员已经厌倦了不负责任的应用程序开发人员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T12:25:05.230

有几种命名库的方法：

1.  Solaris 风格：.so -> .so.1
2.  GNU 风格：.so -> .so.1 -> .so.1.2.3
3.  随机：.so -> .so.1.2

看：

[https://blogs.oracle.com/ali/entry/how_to_name_a_solaris](https://blogs.oracle.com/ali/entry/how_to_name_a_solaris) http://www.gnu.org/software/libtool/manual/libtool.html#Versioning

# iphone - 为 iPhone 应用程序使用 libtidy

> ID：663211
> 
> 赞同：1
> 
> 时间：2009-03-19T17:37:03.890
> 
> 标签：iphone, objective-c, xcode, tidy, htmltidy

我正在尝试将 libtidy 用于 iPhone 应用程序（因为 iPhone 2.2 SDK 不包含具有整洁功能的 NSXMLDocument），但在构建应用程序时出现链接器错误，提示“找不到 -ltidy 的库”。

至于其他框架/库引用，我已将 libtidy.dylib 添加到我的引用框架列表中，并将关联的 libtidy 头文件添加到我的 Header Search Paths 构建设置中列出的路径中。Xcode 似乎在我构建应用程序时自动添加 -ltidy 链接器选项，但它仍然抱怨找不到关联的 libtidy.dylib 文件，即使我可以在指定路径中的文件系统上看到它并在框架中列出参考。

在 Xcode 中添加对 libtidy 的引用时，有没有其他人遇到过类似的问题？我将 Xcode 3.1.2 与 iPhone SDK 2.2.1 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-29T08:57:14.407

这是一个很大的疏忽，但解决此问题的唯一方法是手动处理这两个文件：

```
/Developer/SDKs/MacOSX10.5.sdk/usr/lib/libtidy.dylib
/Developer/SDKs/MacOSX10.5.sdk/usr/lib/libtidy.A.dylib 
```

...进入不同的模拟器目录：

```
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/usr/lib/
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.1.sdk/usr/lib/
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.sdk/usr/lib/
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk/usr/lib/ 
```

不知道为什么他们一开始就不在那里。您可以从终端执行此操作：

```
for directory in $( echo /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator*.sdk/usr/lib/ ); do
  sudo cp /Developer/SDKs/MacOSX10.5.sdk/usr/lib/libtidy.* $directory
done; 
```

# jquery - jQuery 选项卡 - 需要带有整个表单的“全部”选项卡和每个表单部分的单独选项卡

> ID：663217
> 
> 赞同：0
> 
> 时间：2009-03-19T17:39:07.413
> 
> 标签：jquery, forms, tabs

我试图用谷歌搜索我的要求，但没有运气。我所拥有的是一个分为几个选项卡的表单，所有这些都可以完美运行。但是，现在我被要求提供一个包含整个表单的“全部”选项卡，以及每个部分的单独选项卡。

似乎是一个相当简单的请求，但我看不出如何使用 jQuery 选项卡功能来实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T17:44:30.800

我对 jQuery 比较陌生，所以可能有更好的方法。[`select`但是，如果我必须自己实现这一点，我会考虑在选项卡的情况](http://jqueryui.com/demos/tabs/#event-select)下重新设置“选项卡 div”的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:52:31.190

我认为 Ken 走在了正确的道路上，但我可能只是克隆了适当的 DOM 元素。如果有表单，您可能会想要一个提交而不是多个提交，因此重新设置并不理想。

如果您的选项卡根据内容展开，克隆它们还将保持高度和大小更加一致。

也许看看以下内容： [http ://www.evotech.net/blog/2008/11/jquery-tutorial-dom-manipulation-and-sorting/](http://www.evotech.net/blog/2008/11/jquery-tutorial-dom-manipulation-and-sorting/)

另一方面，重新设置可避免您在每个屏幕之间可能遇到的任何同步问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-25T20:04:11.647

与实际的选项卡相比，您的“选项卡”按钮可能更容易隐藏所有不属于该“选项卡”的表单元素。

# sql - oracle 10g - 监控大行删除

> ID：663220
> 
> 赞同：0
> 
> 时间：2009-03-19T17:39:27.410
> 
> 标签：sql, database, oracle, monitoring

我如何监控被删除的行（比如 20 行）？考虑一下，我是一名 dba，正在监视一个 oracle 数据库。如果有人删除了超过 20 行，我必须收到警报。我应该避免使用触发器，因为它很昂贵。还有其他方法吗？

如何解析重做日志并捕获可能导致批量行删除的 sql？我的情况是，一旦发生批量行删除，就应该提示 DBA.. 除了触发器还有其他方式吗？我一直在使用触发器，我正在寻找一种避免触发器的方法..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T19:25:59.607

如果发生这样的删除，您希望做什么？除非您已将已删除的行保存在某处（这需要触发器），否则您无法将它们取回，甚至无法知道它们是什么。

如果删除行是一个问题并且可能需要恢复，请不要删除行：添加“已删除”列并将其值设置为 UPDATE 而不是 DELETE（或添加触发器。）

或者，也许您可​​以找到解析重做日志的方法？我从未尝试过，但我想只要付出足够的努力，它是可能的。

就个人而言，我认为我会：

1.  重新检查“需要”了解删除，如果我不能改变它，
2.  克服我对触发器的恐惧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T18:51:12.107

因此，回顾一下：您正在寻求一种监控方式，但不使用触发器，因为在每个 DELETE 语句上执行该代码是“昂贵的”。

基本上，您正在尝试找到一种无需监控开销的监控方法。那是不可能的。触发器会很好地完成这项工作，我非常怀疑您是否会注意到简单检查被删除行数的任何性能差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T14:56:41.727

使用删除过程的过程并添加 SQL%ROWCOUNT 来监控已删除的行数。以下是 Oracle 文档中有关如何使用 SQL%ROWCOUNT 的示例：

```
CREATE TABLE employees_temp AS SELECT * FROM employees;

DECLARE
  mgr_no NUMBER(6) := 122;
BEGIN
  DELETE FROM employees_temp WHERE manager_id = mgr_no;
  DBMS_OUTPUT.PUT_LINE('Number of employees deleted: ' || TO_CHAR(SQL%ROWCOUNT));
END;
/ 
```

如果您想使用 FORALL 语句，您可以使用 SQL%BULK_ROWCOUNT 与 SQL%ROWCOUNT 相同的方式，这是 Oracle 文档中的另一个示例：

```
CREATE TABLE emp_temp AS SELECT * FROM employees;

DECLARE
   TYPE NumList IS TABLE OF NUMBER;
   depts NumList := NumList(30, 50, 60);
BEGIN

   FORALL j IN depts.FIRST..depts.LAST
      DELETE FROM emp_temp WHERE department_id = depts(j);

   -- How many rows were affected by each DELETE statement?
   FOR i IN depts.FIRST..depts.LAST
   LOOP
      DBMS_OUTPUT.PUT_LINE('Iteration #' || i || ' deleted ' || SQL%BULK_ROWCOUNT(i) || ' rows.');
   END LOOP;

END;
/ 
```

如果您真的有或想要避免触发因素，我认为您应该这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T21:18:38.687

"how can i parse the redo log and trap the sql that might have caused a bulk row delete? my scenario is, as soon as a bulk row delete happens" What sort of delete are you talking about ?

A DELETE FROM table WHERE pk IN (1,....50) can delete fifty rows in one statement execution

```
FORALL i IN 1..50
 DELETE FROM table WHERE pk = i; 
```

will have fifty executions, each deleting a single row in one transaction.

```
FOR i IN 1..50 LOOP
 DELETE FROM table WHERE pk = i;
 COMMIT;
END LOOP; 
```

will have fifty executions, each deleting a single row in fifty transactions in one session.

So are you looking for deletes of more than 20 rows in a single statement, transaction or session ? Taking the simplest option. Logically, after each DELETE statement, you'd need to look at the number of rows processed and, if greater than 20, create an audit record. Technically, the way to execute such a test is to create an AFTER DELETE row level trigger on the table. Any alternative would have exactly the same performance impact as it would need to do exactly the same work. Transaction or session level limits would be similar, but you'd need the trigger to maintain a count of the number of records deleted (eg in a package level variable).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T20:07:17.890

如果您不想使用触发器，您作为 dba 的选择是安装和设置数据库审计。使用审核功能，您可以跟踪谁做了什么，何时以及应该通知谁。如果删除期限未超过撤消保留期限，您还可以使用闪回功能恢复已删除的行。之后，您可以使用 logminer 通过挖掘该时间段的日志来从存档/重做日志中取回已删除的行。

# c# - 包含 Richtextbox C# 的用户控件上的 ContextMenuStrip

> ID：663224
> 
> 赞同：0
> 
> 时间：2009-03-19T17:40:14.913
> 
> 标签：c#, richtextbox, user-controls, contextmenustrip

我制作了一个自定义控件，它由一个richtextbox 和一个图片框组成。现在我想在richtextbox 上包含一个上下文菜单条。但是我想在菜单条上单击不同菜单时调用的代码属于我将在其中添加此控件的主项目。所以我想在项目中将 contextmenustrip 添加到用户控件中。但是现在的问题是，如果我右键单击图片框，我会得到菜单条，但是当我右键单击 Richtextbox 时，我没有得到 contextmenustrip，有什么理由或建议吗？

同样奇怪的是，我为处理项目中的用户控件而编写的任何事件都不会触发。是因为我把它放在面板控件中吗？有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T17:42:53.487

与您最初所做的一样，将上下文菜单添加到富文本框中。现在，不是执行代码，而是在单击菜单项时引发事件。

在主项目中处理这个新事件。

# oracle - 当 Hibernate 应用程序加载数据以供只读使用时 Oracle 死锁

> ID：663250
> 
> 赞同：6
> 
> 时间：2009-03-19T17:45:39.253
> 
> 标签：oracle, hibernate, spring, deadlock

我们遇到了 Oracle 死锁（org.hibernate.util.JDBCExceptionReporter - ORA-00060：在等待资源时检测到死锁）错误。有人建议问题出在使用 Hibernate 执行只读操作的进程，而另一个进程正在对同一行执行更新。

有问题的只读进程是使用 Hibernate 和 Spring 配置的。我们没有明确定义服务的事务。虽然这可能并不理想 - 我不明白为什么 Hibernate 会在没有执行保存/更新操作时尝试在一行上获得排他锁 - 只有一个获取/加载。

所以我的问题是：Hibernate 在没有定义明确的事务管理时是否尝试在行上获得读/写锁，即使只执行对象的“加载”。不执行保存/更新。

是否有可能围绕正在加载数据的服务定义一个事务，然后在 transactionAttributes 上明确说 READONLY 会导致 Hibernate 忽略已经存在的行锁并仅出于只读目的加载数据？

以下是一些代码示例：

为了加载记录，我们使用 HibernateDaoTemplate

```
public class HibernatePurchaseOrderDataService extends HibernateDaoSupport implements PurchaseOrderDataService {
    public PurchaseOrderData retrieveById(Long id) {
        return (PurchaseOrderData)getHibernateTemplate().get(PurchaseOrderData.class, id);
    }
} 
```

调用此方法的服务的 Spring 配置为：

```
<bean id="orderDataService"
      class="com.example.orderdata.HibernatePurchaseOrderDataService">
    <property name="sessionFactory" ref="orderDataSessionFactory"/>
</bean>

<bean id="orderDataSessionFactory"
      class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource" ref="hibernateDataSource"/>
    <property name="hibernateProperties" ref="hibernateProperties"/>
    <property name="mappingResources">
        <list>
            <value>com/example/orderdata/PurchaseOrderData.hbm.xml</value>
            <value>com/example/orderdata/PurchaseOrderItem.hbm.xml</value>
        </list>
    </property>
</bean> 
```

实际死锁发生在通过调用加载 PurchaseOrder 加载的 PurchaseOrderItem 记录之一上。

如果正在加载的记录被另一个进程锁定，这会导致死锁吗？如果是这样 - 添加一个如下所示的事务包装器会解决问题吗？

```
<bean id="txWrappedOrderDataService"
      class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
    <property name="transactionManager" ref="transactionManager"/>
    <property name="target" ref="orderDataService"/>
    <property name="transactionAttributes">
    <props>
        <!-- all methods require a transaction -->
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
    </props>
    </property>
</bean> 
```

更新：数据库团队在服务器上看到了似乎表明我们的“只读”进程实际上正在自动写入数据库的跟踪消息。在我们从数据库中读取的确切列上执行了记录的“更新”命令。似乎 Hibernate 会自动将这些记录写回数据库（即使我们没有要求它这样做）。这可能可以解释为什么会出现死锁。

这可能是因为 Session FLUSH 或类似的原因吗？看起来更像是解决方案可能是使用带有 readOnly 的事务包装器......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T18:14:00.273

当您使用操纵它们实际设置的值的设置器时，休眠可能会发生非自愿更新。例如，String 属性的 setter 将 null 值替换为 ""。一个可能的候选者也是收藏品。确保 setter 不会替换包含的集合。如果你用另一个包含相同内容的集合替换一个实体的集合，hibernate 将无法意识到这一点并更新整个集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:40:31.073

我们最终确定解决方案是将其包装在只读事务中。

我不清楚为什么，我们根本没有使用设置器（只是读取数据） - 数据库中没有任何改变。但由于某种原因，Hibernate 试图重新写回相同的数据，并在另一个进程试图读取这些记录时导致锁定。

使用 readOnly 事务导致问题消失！

```
<bean id="txWrappedOrderDataService"
  class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
<property name="transactionManager" ref="transactionManager"/>
<property name="target" ref="orderDataService"/>
<property name="transactionAttributes">
    <props>
        <!-- all methods require a transaction -->
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
    </props>
</property> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T22:08:39.573

您是否检查过数据库中的任何触发器？您确定它是 Hibernate 而不是其他更新这些相同行的进程吗？也许有一列存储了最后一次读取的时间戳，并且每次读取该行时都会更新它（尽管我不记得你可以制作 SELECT 触发器）......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T16:19:41.007

詹斯是对的

要添加-您需要仔细检查您的setter和getter，看看它们是否在不同的调用中返回不同的值，例如new Date()-这将返回一个新值-每次调用它都会让hibernate认为对象已经改变

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-24T14:22:09.933

有趣的一件事是添加

log4j.logger.org.hibernate.persister.entity.AbstractEntityPersister=TRACE

在您的 log4j 配置中。通过这样做，休眠将记录为什么实体需要在数据库中更新。当属性为空导致数据库更新时，我们遇到了一些实体返回“”的问题。通过这样做，我们能够查明此类问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-24T18:21:19.050

当我们缺少索引时，我已经看到我们的系统中发生了这个问题。由于缺少键列上的索引，因此在数据库中执行的查询运行时间过长，从而锁定了表。

# generics - 为什么示例不编译，也就是（co-，contra-和in-）方差如何工作？

> ID：663254
> 
> 赞同：148
> 
> 时间：2009-03-19T17:46:16.257
> 
> 标签：generics, scala, covariance, contravariance

继[this question](https://stackoverflow.com/questions/663032/generic-wildcards-in-variable-declarations-in-scala)之后，有人可以在Scala中解释以下内容：

```
class Slot[+T] (var some: T) { 
   //  DOES NOT COMPILE 
   //  "COVARIANT parameter in CONTRAVARIANT position"

} 
```

**`+T`**我理解类型声明中和之间的区别**`T`**（如果我使用它会编译**`T`**）。但是，如何在不诉诸于创建未参数化的事物的情况下，实际编写一个类型参数协变的*类*？如何确保只能使用 的实例创建以下内容**`T`**？

```
class Slot[+T] (var some: Object){    
  def get() = { some.asInstanceOf[T] }
} 
```

**编辑**-现在将其归结为以下内容：

```
abstract class _Slot[+T, V <: T] (var some: V) {
    def getT() = { some }
} 
```

这一切都很好，但我现在有两个类型参数，我只想要一个。我将重新提出这个问题：

**如何编写一个类型*协变的**不可变* `Slot`类？**

 ***编辑2**：呃！我用过`var`，没有`val`。以下是我想要的：

```
class Slot[+T] (val some: T) { 
} 
```

* * *

## 回答 #1

> 赞同：304
> 
> 时间：2009-03-23T16:27:32.433

通常，*协变*类型参数是允许随着类被子类型化而向下变化的类型参数（或者，随着子类型而变化，因此使用“co-”前缀）。更具体地说：

```
trait List[+A] 
```

`List[Int]`是 的子类型，`List[AnyVal]`因为`Int`是 的子类型`AnyVal`。这意味着您可以提供一个实例来说明`List[Int]`何时需要类型的值`List[AnyVal]`。对于泛型来说，这确实是一种非常直观的工作方式，但事实证明，在存在可变数据的情况下使用它是不合理的（破坏了类型系统）。这就是为什么泛型在 Java 中是不变的。使用 Java 数组（错误地协变）的不健全的简要示例：

```
Object[] arr = new Integer[1];
arr[0] = "Hello, there!"; 
```

我们只是将 type 的值分配给 type`String`的数组`Integer[]`。出于显而易见的原因，这是个坏消息。Java 的类型系统实际上在编译时允许这样做。JVM 将“有帮助地”`ArrayStoreException`在运行时抛出一个。Scala 的类型系统防止了这个问题，因为类上的类型参数`Array`是不变的（声明是`[A]`而不是`[+A]`）。

请注意，还有另一种称为*逆变*的方差。这非常重要，因为它解释了为什么协方差会导致一些问题。逆变实际上与协方差相反：参数随着子类型而*向上*变化。它不太常见，部分原因是它非常违反直觉，尽管它确实有一个非常重要的应用：函数。

```
trait Function1[-P, +R] {
  def apply(p: P): R
} 
```

注意类型参数上的“ **-** ”方差注释。`P`这个声明作为一个整体意味着在 中`Function1`是逆变的，在中是`P`协变的`R`。因此，我们可以推导出以下公理：

```
T1' <: T1
T2 <: T2'
---------------------------------------- S-Fun
Function1[T1, T2] <: Function1[T1', T2'] 
```

注意`T1'`必须是 的子类型（或相同类型） ，而和`T1`则相反。在英语中，这可以被解读为：`T2``T2'`

> *如果A*的参数类型是*B*的参数类型的超类型，而*A的返回类型是**B*的返回类型的子类型，则函数*A*是另一个函数*B*的子类型。

 ***这条规则的原因留给读者作为练习（提示：考虑不同的情况，因为函数是子类型的，就像我上面的数组示例一样）。

有了你新发现的协变和逆变知识，你应该能够明白为什么下面的例子不能编译：

```
trait List[+A] {
  def cons(hd: A): List[A]
} 
```

问题是它`A`是协变的，而`cons`函数期望它的类型参数是*不变*的。因此，`A`正在改变错误的方向。有趣的是，我们可以通过使`List`in 逆变来解决这个问题`A`，但是返回类型`List[A]`将是无效的，因为`cons`函数期望它的返回类型是*协变*的。

我们这里仅有的两个选择是 a) 保持`A`不变，失去协方差的良好、直观的子类型属性，或者 b) 向`cons`定义`A`为下限的方法添加局部类型参数：

```
def cons[B >: A](v: B): List[B] 
```

这现在是有效的。您可以想象它`A`向下变化，但能够`B`相对于它的下限向上变化。使用此方法声明，我们可以协变，一切顺利。`A``A``A`

请注意，这个技巧只有在我们返回一个`List`专门针对不太具体的类型的实例时才有效`B`。如果您尝试使其`List`可变，那么事情就会崩溃，因为您最终尝试将 type 的值分配给 type`B`的变量`A`，这是编译器不允许的。每当您具有可变性时，您就需要某种类型的mutator，它需要某种类型的方法参数，这（与访问器一起）意味着不变性。协变适用于不可变数据，因为唯一可能的操作是访问器，它可以被赋予协变返回类型。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-12-17T07:56:43.533

@Daniel 已经很好地解释了它。但简而言之，如果允许的话：

```
 class Slot[+T](var some: T) {
    def get: T = some   
  }

  val slot: Slot[Dog] = new Slot[Dog](new Dog)   
  val slot2: Slot[Animal] = slot  //because of co-variance 
  slot2.some = new Animal   //legal as some is a var
  slot.get ?? 
```

`slot.get`然后将在运行时抛出一个错误，因为它无法将 an 转换`Animal`为`Dog`（duh！）。

一般来说，可变性不适用于协方差和逆变。这就是为什么所有 Java 集合都是不变的原因。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-19T18:00:58.607

有关此问题的完整讨论，请参见[Scala by example](http://www.scala-lang.org/sites/default/files/linuxsoft_archives/docu/files/ScalaByExample.pdf#) , page 57+。

如果我正确理解您的评论，您需要重新阅读从第 56 页底部开始的段落（基本上，我认为您所要求的如果没有运行时检查就不是类型安全的，而 scala 不会这样做，所以你运气不好）。翻译他们的示例以使用您的构造：

```
val x = new Slot[String]("test") // Make a slot
val y: Slot[Any] = x             // Ok, 'cause String is a subtype of Any
y.set(new Rational(1, 2))        // Works, but now x.get() will blow up 
```

如果您觉得我不理解您的问题（很可能），请尝试在问题描述中添加更多解释/上下文，我会再试一次。

回应您的编辑：不可变插槽是完全不同的情况......*微笑*我希望上面的示例有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-19T18:33:38.343

您需要对参数应用下限。我很难记住语法，但我认为它看起来像这样：

```
class Slot[+T, V <: T](var some: V) {
  //blah
} 
```

Scala-by-example 有点难以理解，一些具体的例子会有所帮助。

# asp.net - 我可以在 GridView 中插入一行吗？

> ID：663257
> 
> 赞同：2
> 
> 时间：2009-03-19T17:46:47.923
> 
> 标签：asp.net, gridview

我正在维护一个在 GridView 中显示产品的 ASP.Net 2.0 网站。客户询问我是否可以每 10 行显示一个“添加到购物车”按钮。我可以通过将按钮放在它自己的列中并翻转可见性来做到这一点，但我想知道是否可以在每 10 个项目之后注入一个新行。这会将按钮放在自己的一行中，并且在不可见时不会占用列空间。关于如何做到这一点的任何想法？TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T19:13:23.317

向 GridView 中插入行是出了名的困难。您是否考虑过使用中继器？

给定以下标记：

```
<asp:Repeater id="repeater" runat="server">
    <ItemTemplate>
        <h1><%#Container.DataItem%></h1>
    </ItemTemplate>
</asp:Repeater> 
```

您可以使用以下代码隐藏在您选择的任何行之后插入自定义控件：

```
using System;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Collections.Generic;

public partial class Default : Page
{
    protected override void OnInit(EventArgs e)
    {
        this.repeater.ItemCreated += repeater_ItemCreated;

        base.OnInit(e);
    }

    protected override void OnLoad(EventArgs e)
    {
        this.repeater.DataSource = new List<String>
        {
            "one", "two", "three", "four", "five", "six", "seven"
        };

        this.repeater.DataBind();

        base.OnLoad(e);
    }

    void repeater_ItemCreated(Object sender, RepeaterItemEventArgs e)
    {
        if (this.repeater.Items.Count > 0
            && this.repeater.Items.Count % 3 == 0)
        {
            this.repeater.Controls.Add(new LiteralControl("<h4>hello world</h4>"));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T19:05:57.547

我认为无论如何都不能直接使用 GridView 来执行此操作（无需中断源代码）。但是您可以做的是在呈现 GridView 后使用一些 javascript 将按钮的 html 注入页面的 DOM 中。

您将遍历由 gridview 创建的表中的所有行，然后在每 10 行之后，创建一个新行（包含所有单元格或单个 colspan 单元格）。在该单元格内插入带有 onClick 的按钮，调用您的 javascript 例程以将项目添加到购物车。

# nhibernate - 复制对象图并在 nhibernate 中作为新对象持久存在

> ID：663261
> 
> 赞同：2
> 
> 时间：2009-03-19T17:47:05.210
> 
> 标签：nhibernate

我想创建“以前的版本”，以便用户可以撤消所做的更改并回滚到以前的版本。

我有一个具有各种属性的管理器对象和一组托管员工。这与数据库中的两个表有关，其中员工通过外键链接到经理。

我想要做的是复制经理和他的所有员工并将其保存回数据库作为经理表中的新条目和员工表中与新经理相关的一系列新条目。

我正在使用 nhibernate，想知道是否有一种聪明的方法可以做到这一点。

我能想到的唯一方法是手动：

```
manager old = getManager(); // get the original for copying 

manager newManager = new manager(); // create a blank object
newManager .name = old.name //give the new manager the old one's props;

//cycle through the staff duplicate and add to new managers staff collection
foreach(staff s in old.staffCollection)
{
  staff newStaff = new staff();
  newstaff.name = s.name;
  newManager.staffCollection.Add(newstaff); 
} 
```

上面的例子并不完全是我的做法，但你明白了我希望的想法。

我曾考虑过使用反射来获取道具，而不是手动设置它们，但这与我所拥有的一样聪明。

在 nhibernate 中有没有办法复制对象图并将其作为新条目保留回来？

或者有人有什么好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T17:51:46.990

如果您将实体标记为可序列化，则可以进行二进制序列化。

```
 public static MemoryStream Serialize(object data)
    {

        MemoryStream streamMemory = new MemoryStream();
        BinaryFormatter formatter = new BinaryFormatter();
        formatter.AssemblyFormat = FormatterAssemblyStyle.Simple;

        formatter.Serialize(streamMemory, data);

        return streamMemory;
    }
    public static Object Deserialize(MemoryStream stream)
    {

        BinaryFormatter formatter = new BinaryFormatter();
        formatter.AssemblyFormat = FormatterAssemblyStyle.Simple;
        return formatter.Deserialize(stream);

    } 
```

本质上，您将调用 Serialize 然后调用 DeSerialize 方法，这将为您提供图形的深层副本，然后您必须更新您可能拥有的任何 ID。

请注意，我不确定这将如何与 nHibernates 延迟加载功能一起使用。我已经做了很多，但不是我从 nHibernate 中提取的对象。也不要忘记将 Serializable 放在您的对象上。

# javascript - jQuery 鼠标悬停问题

> ID：663266
> 
> 赞同：1
> 
> 时间：2009-03-19T17:48:03.990
> 
> 标签：javascript, jquery, events

我有图像，鼠标悬停在两个箭头上（左侧和右侧）淡出，然后在鼠标移出时，这些箭头淡出。我的问题是，当用户将鼠标悬停在箭头上时，图像将其视为鼠标移出（因为箭头漂浮在图像上方），并使箭头淡出，导致无限的淡入/淡出循环，直到您将鼠标移开。当鼠标悬停在箭头上时，防止箭头消失的最佳方法是什么？我已经尝试了一种方法，您将在下面看到，但一直没有奏效......

这是一些代码：

```
$(".arrow").mouseover(function() {
    overArrow = 1;
    $("#debug_oar").text(1)
})

$(".arrow").mouseout(function() { 
    overArrow = 0;
    $("#debug_oar").text(0)
})

$("#image").mouseout(function() {
    $(".arrow").fadeOut(250,function() { $(".arrow").remove();})
})

$("#image").mouseover(function() {
    if(overArrow == 0) {
        $("#image").after("<div class='arrow' id='lArrow' style='display:none;position:absolute;'>&larr;</div><div class='arrow' id='rArrow' style='display:none;position:absolute;'>&rarr;</div>")
        // Define variables...
        aWidth = $("#lArrow").width();
        aHeight = $("#lArrow").height();
        height = $("#image").height()
        width = $("#image").width()
        pos = $("#image").position();
        // Calculate positioning
        nHeight = height/2
        y = pos.top + nHeight - (aHeight/2)
        // Position the left arrow
        $("#lArrow").css("top",y)
        $("#lArrow").css("left",pos.left+10)
        // Now the right...
        $("#rArrow").css("top",y)
        $("#rArrow").css("left",pos.left+width-aWidth-20)
        // Display 'em
        $(".arrow").fadeIn(250);
        // Debug info
        $("#debug_x").text(pos.left)
        $("#debug_y").text(y)
        $("#debug_height").text(height)
    }
}) 
```

谢谢

对于那些对最终代码感兴趣的人：

```
$("#image").mouseenter(function() {
    $("#image").append("<div class='arrow' id='lArrow' style='display:none;position:absolute;'>&larr;</div><div class='arrow' id='rArrow' style='display:none;position:absolute;'>&rarr;</div>")
    // Define variables...
    aWidth = $("#lArrow").width();
    aHeight = $("#lArrow").height();
    height = $("#image").height()
    width = $("#image").width()
    pos = $("#image").position();
    // Calculate positioning
    nHeight = height/2
    y = pos.top + nHeight - (aHeight/2)
    // Position the left arrow
    $("#lArrow").css("top",y)
    $("#lArrow").css("left",pos.left+10)
    // Now the right...
    $("#rArrow").css("top",y)
    $("#rArrow").css("left",pos.left+width-aWidth-20)
    // Display 'em
    $(".arrow").fadeIn(250);
    // Debug info
    $("#debug_x").text(pos.left)
    $("#debug_y").text(y)
    $("#debug_height").text(height)
});
$("#image").mouseleave(function() {
    $(".arrow").fadeOut(250,function() { $(".arrow").remove();})
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T17:56:32.207

尝试在您的事件上调用[stopPropagation()](http://docs.jquery.com/Events/jQuery.Event#event.stopPropagation.28.29)，或使用默认停止传播的替代事件，例如[mouseenter](http://docs.jquery.com/Events/mouseenter)、[mouseleave](http://docs.jquery.com/Events/mouseleave)或[hover(over, out)](http://docs.jquery.com/Events/hover)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T18:03:59.677

箭头可能不是图像的子级，因此将它们悬停*会*离开图像。

您想用包装器元素包装图像和箭头，并将 hover() 调用放在该元素上。这样，悬停在图像或箭头上就会触发它。

或者，学习如何使用事件委托。将 hover() 附加到恰好包含它们的更高元素，然后每次检查悬停的目标。如果它与图像或箭头匹配，则在箭头上触发相应的动画。

[这是一个很好的教程，解释了 jQuery 中的事件委托以及如何使用它。](http://lab.distilldesign.com/event-delegation/)

最后，为了简单起见，使用 hover() 而不是 mouseover()/mouseout()。它更清楚地捕捉到你的意图。传递给 hover() 的第一个函数在鼠标悬停时应用，第二个函数在鼠标悬停时应用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T18:04:32.280

可能最简单的解决方案是将淡出转换处理程序打开`body`并像您现在拥有的那样淡入。

这样，您获得的 mouseout 事件不会导致任何事情发生，只有当您将鼠标移离整个区域时，它才会消失。

# silverlight - Silverlight 3：导航页面总是左对齐！

> ID：663268
> 
> 赞同：1
> 
> 时间：2009-03-19T17:48:18.247
> 
> 标签：silverlight, silverlight-3.0

我有一个愚蠢的问题。如何使导航页面的内容居中？？？

我一直在关注本教程： [http](http://silverlight.net/learn/learnvideo.aspx?video=187319) ://silverlight.net/learn/learnvideo.aspx?video=187319 （页面上的源代码）

我尝试将水平对齐设置为以所有可能的东西为中心，但内容总是在左上角结束。

其他人有这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T18:11:57.007

好的发现我的错误。我使用的是 Horizo​​ntalAlignment=Stretch 而不是 Horizo​​ntalContentAlignment=Stretch === – vidalsasoon（0 秒前）[删除此评论]

# sql-server - Reset Identity column in SQL Server

> ID：663275
> 
> 赞同：7
> 
> 时间：2009-03-19T17:48:52.990
> 
> 标签：sql-server, database-design, identity

I am making an SQL database that stores contacts. I want to be able to delete contacts, and the correct id for each contact is crucial for my software connecting to it. Lets say I have contact James and he is the first one. His id is 0\. I add Mary and her id is 1\. If I delete James, how can Mary's id be set to 0 instead of staying 1? It has to reset since she is the first one now. In other words, how can I reset all of the IDs in the database when someone gets deleted? Thanks

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-19T17:56:05.903

This is such a bad idea in so many ways. I am debating if I should show you how to do this. There should never be a reason to change a row's identity once it's set.

If there is you are probably using the wrong field as your PK identifier. I am making an assumption here that you're talking about your PK field which is also an identity column.

Keep in mind if you create any tables which link to your contact table and you start changing your Id you need to update all those tables as well. Which will get expensive...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T17:52:08.723

That's going to get real slow once you have more than a trivial amount of records in the database. The identity column will not work for you, you need to do some custom T-SQL to keep changing all the numbers - but a very bad idea, IMO.

Why not use a date/time stamp if you need to keep track of the order they were added?

You need to re-think your design.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-19T17:53:04.587

That's not how IDs work, and not how they should work. The ID should never change, or all the linked information would point to the wrong row.

Instead, why not add a "External_ID" column that you control? Or number them dynamically in your query (with a computed column?)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-19T18:01:49.883

The ID is the **unique identifier** of the row.

It can be used to link a row to another row in another table. The absence of ID holds information in itself as well, as it would clearly say that it was deleted. Starting to recycle ID numbers defeats completely the purpose of having a unique identifier, and doesn't make any sense really. Once an ID is assigned to a row, you must not arbitrarily change it.

Imagine for a second that when someone dies, they hand over his social insurance number (ID) to someone else. That will result in transferring all the old information that was linked to the dead person's social insurance number to that new person, which doesn't make any sense. Same happens with IDs, if an ID is reassigned, it'll be inheriting any old data that was previously linked to it.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-20T14:24:10.180

It makes no sense to do this on an auto-incrementing primary key column, as even if it was trivial to do, without mass updates in related tables you affect your data integrity. To do so you would likely need to drop the index and primary key constraint from the column (at which point your application may flake out), renumber all later records, renumber all related tables, then re-apply the primary key constraint and index.

If you really must have some form of linear identifier which always starts at 0 (this may then indicate a problem with the software design) then you can have a secondary ID column in addition to the primary key, which you then update to shuffle higher values down a rung with a statement such as:

```
UPDATE table
SET secondaryID = secondaryID - 1
WHERE secondaryID > (SELECT secondaryID FROM table WHERE primaryID = [id to delete]);

DELETE FROM table
WHERE primaryID = [id to delete]; 
```

I strongly discourage such a practice - if your IDs are 'missing' values because of deleted records, the software should test for existence of these values rather than just wigging out.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-19T17:57:15.713

This would be much better solved using another method than renumbering the identity column each time a row is deleted.

Hard to say exactly what else you would do without knowing why your application has this need, but the fact that your application needs this functionality is probably indicative of a design problem somewhere.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-19T17:52:23.370

You're using id's as more than just an identifier. If that's the case, you won't be able to use an auto increment field. You'll need to handle this in your code.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-01T21:23:11.070

A 1 minute google search gave me a page that I can't display. Google this and it'll be your first link as of 6/1/2009: tsql fix "identity column"

Essentially, I would suggest adding a foreign key constraint between all of your relational fields to the ID field in question prior to doing any renumbering (which is also a horrible idea if there are any relationships whatsoever, strictly because if you are asking this question, you will have a heck of a time).

If your contacts table is your ONLY table or has ZERO relationships based on this ID field, you could set the Identity property to NO, renumber the values from 1 to COUNT(ID), then set the Identity property to YES, and reseed the identity for completion using:

DECLARE @MaxID INT

SELECT @MaxID = COUNT(ID) FROM TableID

DBCC CHECKIDENT('TableID', RESEED, @MaxID)

In this scenario, you could use the above reseed script after each set of deletions (but change COUNT(ID) to MAX(ID) once everything is initially and correctly set up, this adds a little speed as the table gets larger), prior to any additional inserts or foreign key constraint updates. Ensure you use TRANSACTIONS wrapped around the deletes and reseeding blocks, and ensure the table only allows synchronous transactions, this will prevent any data hosing in the middle of the reseeds.

Complex eh? That's why it's best to start out on the right foot. ;) (I learned this from experience) E-mail me at mraarone et yahoo d0t com if you have any more questions.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-22T17:34:54.827

I wrote an application to handle a multi-level sales program. Of course, people drop out. In ours, people had to be inserted as well.

You're on the right track with one modification.

The identity number (ID) and the sequence number (seq) are two different things. They have no relationship with each other at all.

Never change an ID. Once assigned, always assigned.

Create a column (cNEXT) in your table for the sequence and populate it with IDs. "What ID is to be the next one in this sequence?"

Shuffle the IDs in cNEXT around, reassigning cNEXT, any time you want. Any stored proc can do that.

Then you also have the flexibility to create non-sequential chains of IDs. This is useful when people move to different regions or get promotions to different groups.

Hope this helps! :)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-26T20:26:46.213

All the answers are assuming this is a production environment. If your testing a database design, then want to quickly truncate all the tables there should be an easy way to accomplish this:

DBCC CHECKIDENT({table name}, reseed, 0)

*Delete all rows from all tables using the id first

# c++ - 这种间接函数调用有什么好处？

> ID：663280
> 
> 赞同：8
> 
> 时间：2009-03-19T17:50:09.180
> 
> 标签：c++, inheritance, function, abstract-class, virtual-functions

我在库中找到了以下代码：

```
class Bar {
public:
  bool foo(int i) {
   return foo_(i);
  }
private:
  virtual bool foo_(int i) = 0;
}; 
```

现在我想知道：为什么要使用这种间接方式？是否有任何理由说明上述方法比简单的替代方法更好：

```
class Bar {
public:
  virtual bool foo(int i) = 0;
}; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T18:02:54.530

这[是非虚拟接口惯用语](http://www.gotw.ca/publications/mill18.htm)(NVI)。Herb Sutter 的那页有很多关于它的细节。[但是，请使用 C++ FAQ Lite在这里](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.3)和[这里](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.4)所说的内容来调整您在那里阅读的内容。

NVI 的主要优点是将接口与实现分离。基类可以实现通用算法并将其呈现给世界，而其子类可以通过虚函数实现算法的细节。外部用户不受算法细节更改的影响，尤其是当您后来决定要添加预处理和后处理代码时。

明显的缺点是您必须编写额外的代码。此外，`private`虚拟功能让很多人感到困惑。许多编码人员错误地认为您不能覆盖它们。Herb Sutter 似乎喜欢`private`虚拟，但恕我直言，在实践中遵循 C++ FAQ Lite 的建议并制作它们会更有效`protected`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T17:54:16.033

这通常被称为由 Wolfgang Pree 创造的 Template-Hook 对（又名 Hotspot）。

请参阅此[PDF](http://www.exciton.cs.rice.edu/comp410/frameworks/Pree/J008.pdf)、[PowerPoint](http://davidvancamp.com/OODWkshp_files/Ood_wk18.ppt)、[HTML](http://alumni.media.mit.edu/~tpminka/patterns/ET++/)

*像您所说的那样进行间接*处理的一个原因是，通常可以/必须在方法之前*设置*一些东西，并且在方法调用*之后*进行一些清理。在子类中，您只需要提供必要的行为而无需进行*设置*和*清理*......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T17:58:27.273

这是模板模式。foo 方法包含必须由所有子类执行的代码。当你这样看时，它会更有意义：

```
class Bar {
public:
  bool foo(int i) {
   // Setup / initialization / error checking / input validation etc 
   // that must be done for all subclasses
   return foo_(i);
  }
private:
  virtual bool foo_(int i) = 0;
}; 
```

它比替代方法更好，即尝试记住单独调用每个子类中的公共代码。不可避免地，有人创建了一个子类但忘记调用公共代码，从而导致许多问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T17:55:25.953

如果一个子类可以改变 foo_? 的定义，但是消费者需要一个静态函数（为了效率）？或者对于委托模式？

# language-agnostic - 重构非常结合的代码

> ID：663295
> 
> 赞同：1
> 
> 时间：2009-03-19T17:54:20.760
> 
> 标签：language-agnostic, refactoring

我现在必须重构一些代码，它基本上是一种方法（大约 1000 行代码），它进行大量计算并具有很多变量。我不确定如何重构它。代码喜欢吗

```
...
calculateSth(param1,param2,param3,param4,param5, params6);
calculateSthElse(param1,param2,param3);
... 
```

看起来不错？

我可以引入参数对象，但这些对象只会用作某些方法的参数，所以它看起来像这样

```
...
calculateSth(calculateSthObject);
calculateSthElse(calculateSthElseObject);
... 
```

或者我可以把所有东西都放在一个大物体里然后做成

```
...
calculateSth(calculateObject);
calculateSthElse(calculateObject);
... 
```

但是，在该解决方案中，我必须在方法的开头提取私有方法中所需的所有内容并在最后设置，并且要找出私有方法中使用的值要困难得多。需要大约一半的变量作为输出。

你会怎么做？

PS 计算不是微不足道的，所以做类似的事情

```
calculateObject.setMagicValue4((calculateObject.getMagicValue() * calculateObject.getMagicValue2() / calculateObject.getMagicValue3()) 
```

只会让人难以阅读。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T18:01:46.810

我会花任何必要的时间来确保我理解算法的实际作用。然后，如果可以选择，我会尝试找出我将如何*真正*解决问题，这可能涉及许多类和概念。然后我会尝试将这些概念一一引入现有代码中，确保在我引入每个概念时获得适当的测试覆盖率。

# jquery - 如何强制 Firefox 重绘视频元素？

> ID：663296
> 
> 赞同：1
> 
> 时间：2009-03-19T17:54:21.027
> 
> 标签：jquery, css, firefox, video, google-chrome

我正在使用 jQuery 开发一个动态 html 弹出窗口（一个绝对定位的 div），它会自动在屏幕上居中。它还可以容纳适合或超过窗口屏幕尺寸的内容。

这个想法是我们的​​客户点击我们产品列表旁边的“阅读更多”链接，然后这个弹出窗口出现并显示其销售信。每封销售信函还包含一个进一步描述产品的视频。

弹出窗口将保持在屏幕中央，直到通过单击窗口中的关闭按钮或单击窗口外部将其关闭。它通过根据用户滚动的位置以及是否调整窗口大小来调整其绝对位置来保持在中心。

我的问题在于视频元素。在除 Firefox（所有事物）之外的所有其他浏览器中，当用户滚动文档或调整视频大小时，视频会在弹出窗口中完美呈现。但是，在 Firefox 中，当用户滚动/调整大小并且弹出窗口调整其绝对位置时，视频看起来像是从原来的位置弄脏到现在的位置，或者视频屏幕变得透明。

我想也许需要做的是强制 Firefox 重新绘制视频屏幕。我尝试了几种不同的方法来实现这一点。简单地让元素消失并快速重新出现似乎并不能完成这项工作。但是，如果我快速来回调整它的边距或位置，它似乎可以工作。

起初，我打算采用这个解决方案。但是，当我开始在其他浏览器上测试它时，这种“摆动”动作似乎会减慢浏览器的速度，特别是我在 Chrome 中注意到它（我还没有在其他浏览器上测试过）。

我考虑过将此修复限制为 Firefox，但 jQuery 中的浏览器数据字段在 1.3 中已弃用。我总是可以自己制作 javascript 来识别浏览器，但我想知道是否有更好的方法来强制浏览器重绘视频元素。或者也许我走错了路，不需要重新绘制。

我正在使用 FireFox 3.0.1、Chrome 1.0.154.48、Internet Explorer 7 和 Safari 3。

任何输入将不胜感激:) 这是 wiggleVids 函数的代码：

**更新：我更改了代码，以便嵌入元素仅在弹出框的位置发生变化时摆动，而不是将其绑定到窗口滚动功能。这加快了 chrome 的执行速度，但它还没有完成。它仍然是一个明显的滞后。

**更新 2：根据 Lee 的建议，我更改了代码，以便将弹出窗口中的嵌入视频存储在一个数组中。这样，当这个函数被执行时，浏览器就不必一次又一次地在 DOM 中搜索嵌入的对象。myVids 在弹出窗口关闭时被全局声明和清除。

```
function wiggleVids3() {
    if ( myVids.length <= 0 ) {
        $('#popup embed').each( function(ctr) { myVids[ctr] = $(this); } );
    }

    if ( myVids.length > 0 ) {
        for( var ctr = 0; ctr < myVids.length; ctr++ ) {
            var myObj = myVids[ctr];
            var temp = myObj.css("margin-top");
            var suffix =  temp.substr( temp.length - 2,temp.length );
            var currentMargin =  ( ( suffix == 'px' ) || ( suffix == 'em' ) ) ? parseInt( temp.substr( 0, temp.length - 2 ) ) : parseInt( temp );
            var newMargin = currentMargin + 2;
            myObj.css('margin-top', newMargin + 'px');
            setTimeout( function(){ myObj.css('margin-top', currentMargin ); }, 1 );
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T18:20:04.693

基于@Adam 所说的，

将[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)与[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)结合使用来创建具有类似界面的对象以生成 HTML，然后您可以为每个行为不同的浏览器创建一个。

哦，工厂完成所有的浏览器检测......以及设置您的对象。

这个问题与我的回答有关：

*   [策略模式如何运作](https://stackoverflow.com/questions/91932/how-does-the-strategy-pattern-work)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T18:15:17.513

即使 jquery 不支持它，我认为您最好为每个浏览器使用不同的代码，或者仅在检测到 firefox 浏览器时“启用”特殊的 firefox 代码。似乎它可以用很少的工作解决你的问题。

-亚当

# wpf - 尝试停靠 ItemsControl 时 LastChildFill 不起作用

> ID：663310
> 
> 赞同：1
> 
> 时间：2009-03-19T17:56:55.823
> 
> 标签：wpf, itemscontrol

我在 WPF 用户控件中有以下标记：

```
<Border Name="_border" BorderThickness="4" BorderBrush="Blue">
    <Canvas Name="_canvas" Background="Black" >
        <DockPanel LastChildFill="True">
            <ItemsControl Name="_itemsControl" Background="Bisque" AllowDrop="True" Height="100" Width="100"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      ItemTemplate="{StaticResource pictureTemplate}"
                      ItemsPanel="{StaticResource panelTemplate}"
                      Drop="_itemsControl_Drop" 
                      DragOver="_itemsControl_DragOver" 
                      DragLeave="_itemsControl_DragLeave" 
                      PreviewMouseLeftButtonDown="_itemsControl_PreviewMouseLeftButtonDown"
                      PreviewMouseMove="_itemsControl_PreviewMouseMove">

        </ItemsControl>
             </DockPanel>
    </Canvas>
</Border> 
```

我希望 ItemsControl 填充所有可用空间，但它不遵守 DockPanel 的 LastChildFill 属性。水平和垂直“拉伸”值也无济于事。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T18:29:13.517

你的 DockPanel 有多大？尝试在 DockPanel 上设置背景以进行测试。

我不认为你的问题是你的 ItemsControl 没有拉伸以填充你的 DockPanel，但实际上你的 DockPanel 没有拉伸以适应 Canvas 控件。画布控件及其子控件不会调整大小以适合其父控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:51:30.593

如果您完全删除 Canvas，您将不会遇到此问题。引入画布后，您需要设置画布中元素的大小和位置（如 DockPanel）。

# c++ - 是否有任何对 C++ win32 多线程编程很重要的常见设计模式或常见习语？

> ID：663322
> 
> 赞同：1
> 
> 时间：2009-03-19T17:58:38.927
> 
> 标签：c++, multithreading, winapi, design-patterns, idioms

一个示例可能是：RAII - 资源获取是与关键部分一起使用的初始化

还有其他重要的、流行的并且您经常使用的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T18:09:52.860

[这个链接](http://www.cs.wustl.edu/~schmidt/patterns-ace.html)提到了很多。命令模式在将请求分派给线程时派上用场。领导者/追随者似乎也是一个有趣的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T18:13:40.980

你也可以试试这个：[模式和成语](http://paulbridger.net/multithreading_patterns_and_idioms)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T02:17:23.197

我使用消息传递，对于我当前的产品和我过去编写的高性能桌面应用程序都[没有共享任何并发性。](http://en.wikipedia.org/wiki/Message_passing)根据我的经验，最好避免共享数据同步。您可以使用 NamedPipes、窗口消息或套接字在线程之间进行通信。

如果您决定尝试同步对共享数据[的访问，请查看此主题。](https://stackoverflow.com/questions/520837/what-are-common-concurrency-pitfalls/520920#520920)

# c++ - if (!this) { return false; }

> ID：663326
> 
> 赞同：10
> 
> 时间：2009-03-19T17:59:57.597
> 
> 标签：c++, null, this

我偶然发现了这段对我来说似乎完全被破坏的代码，但它确实发生`this`了`null`。我只是不明白这怎么可能`null`

它在正常的方法调用中，例如

```
myObject->func(); 
```

在里面`MyObject::func()`我们有

```
if (!this) { return false; } 
```

有什么办法可以让第一行抛出 a`NullPointerException`而不是进入`null`(?) 方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-19T18:04:13.110

如果你有：

```
MyObject *o = NULL;

o->func(); 
```

接下来会发生什么取决于是否`func`是虚拟的。如果是，那么它将崩溃，因为它需要一个对象来从中获取 vtable。但如果它不是虚拟的，则调用会继续将 this 指针设置为 NULL。

我相信标准说这是“未定义的行为”，所以任何事情都可能发生，但典型的编译器只是生成代码而不检查指针是否为 NULL。一些著名的库依赖于我描述的行为：MFC 有一个函数，叫做类似的函数`SafeGetHandle`，可以在空指针上调用，在这种情况下返回 NULL。

您可能想编写一个可重用的辅助函数：

```
void CheckNotNull(void *p)
{
    if (p == NULL)
        throw NullPointerException();
} 
```

然后，您可以在函数的开头使用它来检查其所有参数，包括`this`：

```
CheckNotNull(this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:12:12.480

捕获此类错误的一种方法（通过设计）是使用指针包装类（类似于 a `shared_ptr`），该类在创建时使用空指针参数抛出。取消引用时它也可能抛出，但这有点晚了 - 我猜总比没有好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T18:03:18.133

```
if(this == null)
   throw new NullPointerException;
if(!this)
   return false; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T18:06:44.913

有可能为`this`空。我怀疑此代码正试图（严重）检测竞争条件，其中对象尚未完成初始化或已被删除。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T18:07:51.680

(this == NULL) 根据标准是未定义的行为。我认为您应该删除此检查:)

假设我们进行以下调用：

```
((CSomeClass*) 0)->method(); 
```

行为已经未定义，那么为什么还要在 CSomeClass::method 中检查 this == NULL 呢？

**已编辑：** 我假设如果您不使用成员变量，您的编译器将处理 (0 == this)，但它会在哪里找到虚拟表指针？在这种情况下，您的班级不能使用多态性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T18:06:10.357

在以下情况下，此指针可能变为空：

```
class Test
{

public:
    bool f();

private:
    int m_i;
};

bool Test::f()
{
    if(!this)
    {
        return false;
    }

    m_i = 0;
    return true;

}

int main(int argc, char **argv)
{
    Test* p = new Test;
    delete p;
    p = NULL;

    p->f();
} 
```

我猜有人做了一个快速破解来避免访问冲突异常。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-19T18:04:18.927

this == null 仅当您在已删除对象上调用方法时才会发生，或者如果某些内容正在写入不应写入的内存（特别是覆盖对象的 this 指针）。

您应该调查代码的真正问题，而不是像这样尝试解决它。

# ant - 捕捉蚂蚁 任务输出

> ID：663328
> 
> 赞同：4
> 
> 时间：2009-03-19T18:01:41.803
> 
> 标签：ant, javadoc

`javadoc`是否可以捕获通过Ant 任务运行时 Javadoc 打印的警告？我没有看到任务中的输出属性。似乎有警告说 Checkstyle 没有捕捉到，最好在文件中捕获该输出。

似乎很奇怪，这将无法捕获，希望我遗漏了一些明显的东西。

~*~*~*~**编辑**（下面的答案）~*~*~*~

看来 Ant <record> 任务正是我想要的。请参阅[Ant 文档](http://ant.apache.org/manual/Tasks/recorder.html)。

```
<target name="generate.docs">
    <record name="javadoc.log" action="start"/>
    <javadoc ... />
    <record name="javadoc.log" action="stop"/>
<target/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T01:04:28.903

我假设以前的重定向答案被否决，因为每次都通过 build.xml 脚本命令执行此操作的未说明要求。

是的。任务中似乎没有该功能。一个更好的问题可能是：Ant 中是否有一个任务/标签可以重定向来自任何嵌套标签的所有输出？这样的任务/标签将保存 System.out 和/或 System.err，将它们设置为创建或附加到文件，然后在块的末尾恢复它们。

就像是：

```
<redirect file='foo.txt' append='true'>
  <anytag you='want' />
</redirect> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T02:50:15.810

看起来这可以使用`<exec>`标签（[参考这里](http://ant.apache.org/faq.html#shell-redirect-1)）......这可能会很痛苦，但它可能可以执行 javadoc 可执行文件并重建生成 javadoc 所需的命令参数。然而，作为一个巨大的反响，它似乎只使用你的自然 shell 重定向，所以在 Win32 和 Linux 上构建需要一些特殊情况的 mojo。

[编写自己的任务](http://ant.apache.org/manual/develop.html)来完成这项工作可能是值得的；或者`<redirect>`上面提到的 Roboprog 的标签，或者扩展 Javadoc 任务......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T13:44:06.800

您可以使用 com.sun.tools.javadoc.Main 类将 javadoc 作为 Java 类执行，调用 execute 方法（它位于 JDK 中包含的 tools.jar 中），因此您可以包装从中调用的 java 类Ant java 任务，它允许重定向输出。您将不得不自己重建 javadoc 命令行参数，而不是拥有 Ant 任务的细节，但它应该可以工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-03T13:50:57.680

以防万一其他人仍然感兴趣 - Ant`javadoc`任务可以很容易地通过选项`outputFile`将生成的消息存储到文件中进行改进：

```
public class MyJavaDoc extends org.apache.tools.ant.taskdefs.Javadoc{

    private File _outFile;

    private Writer _writer;

    /**
     * The file to write error output to.
     */
    public void setOutputFile(File outFile) {
        _outFile = outFile;
    }

    @Override
    public void execute() throws BuildException {
        if (_outFile == null) {
            throw new BuildException("Missing 'outputFile' parameter.");
        }
        try (OutputStream out = new FileOutputStream(_outFile)) {
            _writer = new OutputStreamWriter(out);
            try {
                super.execute();
            } finally {
                _writer.close();
            }
        } catch (IOException ex) {
            throw new BuildException("Cannot write error output: " + ex.getMessage(), ex);
        }
    }

    @Override
    public void log(String msg, int msgLevel) {
        if (msgLevel <= Project.MSG_WARN) {
            try {
                _writer.write(msg);
                _writer.write("\n");
            } catch (IOException ex) {
                throw new IOError(ex);
            }
        }
        super.log(msg, msgLevel);
    }

} 
```

# c# - 本地化组名

> ID：663332
> 
> 赞同：14
> 
> 时间：2009-03-19T18:02:35.453
> 
> 标签：c#, .net, localization

我想通过为“每个人”组分配权限来配置互斥访问规则。当我创建我的规则时，它看起来如下所示

```
new MutexAccessRule("Everyone", MutexRights.Modify | MutexRights.Synchronize | MutexRights.TakeOwnership | MutexRights.ReadPermissions, AccessControlType.Allow) 
```

如何获得本地化的“Everyone”组名，以便在非英语版本的操作系统上工作。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-19T18:27:43.460

不要使用组名，而是使用未本地化的基础 SID。

```
var rule = new MutexAccessRule(new SecurityIdentifier(WellKnownSidType.WorldSid, null),
                               MutexRights.Modify
                                | MutexRights.Synchronize 
                                | MutexRights.TakeOwnership
                                | MutexRights.ReadPermissions,
                               AccessControlType.Allow) 
```

# java - 扩展 Eclipse 的 JavaEditor（类似于 Vim/更改 KeyListener）

> ID：663336
> 
> 赞同：4
> 
> 时间：2009-03-19T18:03:02.177
> 
> 标签：java, eclipse, vim, eclipse-plugin, eclipse-rcp

## 简介 aka 我打算做什么

*随意跳过这部分，这里不包含任何真实信息*

`vim`由于Eclipse(3.4) 中出色的 JavaEditor缺乏良好的、免费的（如语音）模式，我正在考虑编写一个。可用的解决方案是：

*   [ViPlugin](http://www.viplugin.com/viplugin/) : 商业的，不好的（eg no `vim` `text-objects`, such as `daW`）
*   [VimPlugin](http://vimplugin.org/) : 新编辑器，而不是内置 JavaEditor 的强大功能
*   请参阅[SO：Eclipse 与 Vim 的*无痛集成？*](https://stackoverflow.com/questions/597117/painless-integration-of-eclipse-with-vim): 没有什么好东西出现

（但是，请随意提及上述可能对我有所帮助的**其他解决方案。）**

在我看来，基于[`TextEditor`](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/editors/text/TextEditor.html).

我正在考虑普通 JavaEditor 的“皮肤”，它的行为类似于`vim`，其他一切都应该保持不变。

## 现在的问题

*   如何检测[`IWorkbenchPart`](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/IWorkbenchPart.html)给定的 by[`IPartListener.partActivated()`](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/IPartListener.html#partActivated(org.eclipse.ui.IWorkbenchPart))是否是 JavaEditor？
*   那么我该如何替换 JavaEditor 的[`KeyListener`](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/events/KeyListener.html); 需要类似的东西[`ITextViewerExtension.prependVerifyKeyListener`](http://help.eclipse.org/stable/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/text/ITextViewerExtension.html#prependVerifyKeyListener(org.eclipse.swt.custom.VerifyKeyListener))吗？
*   这是继续下去的好方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-21T15:33:05.687

我是您可能正在寻找的东西的开发者。它仍在大力开发中，并没有您正在寻找的所有功能，但我正在努力开发它，我总是对功能和增强请求持开放态度。

该插件称为[Vrapper](http://vrapper.sourceforge.net)。它是 FOSS 并遵循您描述的原则，尽管我认为目前它并不比 ViPlugin 强大得多。但正如我所说，我一直在努力，并尝试快速响应功能请求。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T21:58:37.150

[我从这里](http://www.satokar.com/viplugin/)使用 VI 插件（注意：此链接在撰写本文时已关闭，我希望它会很快回来）。这确实非常有效，并且与 Eclipse 的编码/重构功能非常吻合（请参阅[此答案](https://stackoverflow.com/questions/495268/any-good-tutorial-for-moving-from-eclipse-to-vim)）。

因此，在着手设计自己的解决方案之前，您可能想尝试该链接（如果出现！）:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-08T03:22:54.813

我试试 Vrapper，很舒服。在eclipse中获得vim功能，naver失去了原来的功能

# .net - 如何从关联属性访问方法的参数？

> ID：663338
> 
> 赞同：0
> 
> 时间：2009-03-19T18:03:11.207
> 
> 标签：.net, vb.net, attributes, custom-attributes

给定以下类，我如何从 SampleAttribute 中截取 Class1.SampleMethod 的值？谢谢

```
Public Class Class1
    <SampleAttribute()> _
    Public Function SampleMethod(ByVal Value As Integer) As Boolean
        Return True
    End Function
End Class

<AttributeUsage(AttributeTargets.Method)> _
Public Class SampleAttribute
    Inherits System.Attribute

    Private _Value As Integer

    Property Value() As Integer
        Get
            Return _Value
        End Get
        Set(ByVal value As Integer)
            _Value = value
        End Set
    End Property

    Public Sub New()

    End Sub
End Class 
```

* * *

编辑：

鉴于 Andrew Hare 的回答，也许我正在尝试使用错误的构造。我有一长串类似的方法，每次调用其中一个时我都需要执行一组操作。我认为为它们中的每一个附加一个属性将是最直接的解决方案。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T22:36:49.880

如果您正在尝试对横切行为进行建模（不相关的对象需要做类似/相同的事情），那么 AOP 就是要走的路。我已经使用 PostSharp 取得了很好的效果，无论是编译还是运行时编织。它基本上会在编译（或运行）时将代码注入已编译的程序集中，该程序集将根据您的定义调用您的方法。

**更新RE：PostSharp：在**[codeplex](http://www.codeproject.com/KB/cs/ps-custom-attributes-1.aspx)
上有很多很好的教程。您需要构建一个继承自 PostSharp.Laos.OnMethodBoundaryAspect 的新属性。覆盖该基类的方法将告诉后编译器在编译期间插入什么代码。codeplex 上的跟踪示例应该向您展示您需要做的所有事情。**结束更新**

 **您可能想要查看的另一种架构模式是[观察者](http://en.wikipedia.org/wiki/Observer_pattern)（例如[，快速谷歌发现了这篇 msdn 文章）](http://msdn.microsoft.com/en-us/library/ms998543.aspx)。

如果这些方法实际上是某些相关类中的对象行为，则可以通知观察者活动，然后做出相应的响应。像这样的发布-订阅模式的缺点是您需要向观察者注册您的依赖列表。如果您只有一堆关于类的方法，那么这个概念在某种程度上仍然适用，但不一定是理想的。

当然，可怜的男人/女人的方法是在所有方法的末尾添加一行代码;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T18:19:27.283

## 编辑：

[听起来您正在尝试通过AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)做某事。也许像[PostSharp](http://www.postsharp.org/)这样的东西会有所帮助——它可以让你通过属性做你想做的事。

* * *

鉴于您发布的类型，请尝试以下操作：

```
Imports System
Imports System.Reflection

Class Program
    Private Shared Sub Main()
        Dim type As Type = GetType(Class1)
        Dim members As MemberInfo() = type.GetMembers()

        For Each member As MemberInfo In members
            Dim attributes As Object() = member.GetCustomAttributes(GetType(SampleAttribute), True)

            If attributes.Length > 0 Then
                ' this means that the current "member"
                ' has your custom attribute
            End If
        Next
    End Sub
End Class 
```

# internet-explorer-7 - IE7 中的奇怪错误（惊喜）

> ID：663341
> 
> 赞同：0
> 
> 时间：2009-03-19T18:03:18.400
> 
> 标签：internet-explorer-7

在[这个 url](http://centralpa.floorcoveringsinternational.com/)上，如果你慢慢地上下滚动几次，页脚中 Flash 片段下面的文本有时会在 IE7 中消失。难以重现，但似乎与闪光灯遮住部分窗口然后消失后不刷新有关。很难解释，但任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T18:08:28.653

由于我现在在移动设备上，因此无法检查您的 URL，但是在阅读您的描述时，这听起来像是 IE 中“Peekaboo bug”的经典案例。在谷歌上查找；有相当可靠的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:37:44.433

通过添加修复它：

```
html { background : url(null) fixed no-repeat; } 
```

不要问>.<

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T18:07:54.830

有趣的是，如果您最小化页面并恢复它可以修复故障。我认为这是一个 IE 图形缺陷，与您的网站无关。

# c# - 如何打开新的浏览器窗口

> ID：663342
> 
> 赞同：2
> 
> 时间：2009-03-19T18:03:37.150
> 
> 标签：c#, asp.net

我正在使用 Asp.net c# 开发 web 应用程序

如何在新的浏览器窗口中打开 response.redirect？

例如 Response.Redirect( [http://www.asp.net](http://www.asp.net) );

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T18:12:03.137

这是一个很常见的问题，答案是你不能。

原因是浏览器何时将请求发送到将加载页面的服务器已经确定，因此当代码开始在服务器上运行时，更改页面的加载位置为时已晚。

您可以将javascript添加到将打开一个新窗口的页面，但您仍然必须将页面发送回浏览器作为对请求的响应（即您不能将当前页面留在浏览器中，因为浏览器有已经请求了一个页面来替换它）。

```
ClientScript.RegisterStartupScript(this.GetType(), "aspnet", "window.open('http://www.asp.net','_blank');", true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T18:07:03.977

不幸的是，您不能从服务器执行此操作，您必须使用客户端代码来创建新的浏览器窗口。您可以使用 Javascript 函数来执行此操作[`window.open`](http://www.javascript-coder.com/window-popup/javascript-window-open.phtml)。

这样做的一种方法是将您希望发送给用户的 URL 嵌入到隐藏的输入中，然后在页面呈现时具有一个 Javascript 函数，该函数将检查该输入的值，如果找到一个值，它将执行`window.open`调用.

# wcf - WCF 服务向后兼容性检查

> ID：663343
> 
> 赞同：6
> 
> 时间：2009-03-19T18:03:38.647
> 
> 标签：wcf, web-services, metadata, versioning, backwards-compatibility

我刚刚编写了一个新版本的 WCF Web 服务，我想确保我没有对服务和数据合同进行任何重大更改。

回想我作为 VB6 Com Api 开发人员的日子，我回想起在编译时指定组件的先前发布版本并让编译器检查二进制兼容性是否得到维护是多么容易。

我设想了类似的东西，称为（希望）“合同兼容性”检查。它将使用元数据执行与 VB6 开发环境类似的检查。这可以作为执行实用程序的单独构建步骤来完成。

我准备接受不存在这样的实用程序。如果是这种情况，是否有人对实现这一目标的算法有任何想法？

1.  从当前实时服务版本中检索元数据
2.  从新服务版本中检索元数据
3.  检查服务合同和每个数据合同的兼容性。仅报告重大更改。

第 3 步似乎很复杂，但肯定是可自动化的……

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-07T12:51:34.857

这些情况通过集成/回归测试来解决。您为初始版本编写集成测试，并在将服务修改为新版本后使用旧客户端再次运行集成测试。如果他们成功了，你就不会破坏任何东西。如果他们失败了，你会确切地看到是什么调用导致了问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T19:51:06.427

安迪不存在这样的东西，但如果你启动并运行了一些有 2 个 DLL（一个旧的，一个新的）的东西，那么你可以使用 BitDiffer 之类的东西来比较它们。

Codeplex 上有一个项目帮助 WCF 发布，但我不记得它叫什么，抱歉。

祝你好运，

-基思

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-07T13:17:07.140

尝试使用[“Codeplex WCF 负载测试”](http://wcfloadtest.codeplex.com/)为旧接口合约生成单元测试，并在新接口合约上运行它们：

> 此工具采用 WCF 跟踪文件和 WCF 客户端代理或 WCF 接口协定，并生成 C# 单元测试，该测试重放在跟踪文件中找到的相同调用序列。然后可以使用单元测试对目标进行负载测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-07T13:05:34.333

请参阅[“版本化 WCF 服务：第一部分”](http://www.devproconnections.com/article/net-framework2/versioning-wcf-services-part-i.aspx)和[“版本化 WCF 服务：第二部分”](http://www.windowsitpro.com/article/net-framework2/versioning-wcf-services-part-ii.aspx)。

# .net - Crsytal 报告：VS 2005 部署

> ID：663345
> 
> 赞同：1
> 
> 时间：2009-03-19T18:04:04.997
> 
> 标签：.net, visual-studio-2005, crystal-reports

嗨，我正在使用 VS 2005 中包含的 CR。它在本地运行良好，但是当我部署到我的生产机器时，我收到以下错误：

```
Could not load file or assembly 'CrystalDecisions.ReportAppServer.CommLayer, Version=10.2.3600.0, Culture=neutral, PublicKeyToken=692fbea5521e1304' or one of its dependencies. The system cannot find the file specified. 
```

不确定这意味着什么；但是谷歌搜索让我相信这是很多人都遇到过的问题。我想知道是否有人知道任何解决方案？我已经在我的生产服务器上安装了 CR 运行时，它是从本地机器的 Bootstrapper 文件夹中获得的。除此之外，我不确定我错过了什么？我没有 Crystal Reports 的许可证。（我需要一个吗？）谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-23T19:17:56.920

尝试将程序集的构建选项设置为复制本地 True。

# php - PHP 类方法中的前导下划线是怎么回事？

> ID：663350
> 
> 赞同：167
> 
> 时间：2009-03-19T18:04:31.017
> 
> 标签：php, coding-style

在查看各种 PHP 库时，我注意到很多人选择在某些类方法前加上一个下划线，例如

```
public function _foo() 
```

...代替...

```
public function foo() 
```

我意识到这最终归结为个人喜好，但我想知道是否有人对这种习惯的来源有所了解。

我的想法是它可能是从 PHP 4 继承而来的，在类方法可以被标记为受保护或私有之前，作为暗示“不要从类外部调用此方法”的一种方式。但是，我也想到它可能起源于我不熟悉的某个地方（一种语言），或者它背后可能有很好的推理，我会从了解中受益。

任何想法、见解和/或意见将不胜感激。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-03-19T18:08:32.537

它来自面向对象的 PHP (PHP 4) 的糟糕旧时代。OO 的实现非常糟糕，并且不包括私有方法之类的东西。作为补偿，PHP 开发人员在原本是私有的方法前面加上了下划线。在一些较早的课程中，您会看到`/**private*/ __foo() {`给它一些额外的重量。

我从来没有听说过开发人员在他们所有的方法前都使用下划线，所以我无法开始解释是什么原因造成的。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-06-12T03:19:16.713

我相信目前这些 PHP 约定最权威的来源是[PSR-2：编码风格指南](http://www.php-fig.org/psr/psr-2/)，因为 Zend 框架是[PSR](http://www.php-fig.org/members/)的一部分：

> 属性名称不应以单个下划线作为前缀来表示受保护或私有可见性。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2013-09-29T20:11:45.563

现在，在 2013 年，这是PSR-2 编码指南**“正式”的糟糕风格**：

> 属性名称不应以单个下划线作为前缀来表示受保护或私有可见性`

来源：[https ://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-04-09T09:22:02.423

我强烈反对使用下划线作为私有/受保护方法的前缀，因为您可以为此使用私有/受保护关键字，IDE 会为您标记它。

我仍然是，但是，我找到了它可以成为一种好习惯的一个原因。想象一下，您有公共方法`addFoo()`，并且在该方法中，您有一些与其他方法通用的任务`addFooWhenBar()`，`addFooWhenBaz()`...现在，该通用方法的最佳名称`addFoo()`是丑陋的名字像`addFooInternal()`or `addFooCommon()`or ... 但`_addFoo()`私有方法看起来是最好的。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-19T18:07:18.937

前导下划线**通常用于私有属性和方法**。这不是我通常使用的技术，但在一些程序员中仍然很流行。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-03-20T16:42:10.723

我在为私有方法编写的 PHP 5 类中使用前导下划线。对于开发人员来说，一个特定的类成员是私有的，这是一个小的视觉提示。在使用为您区分公共和私有成员的 IDE 时，这种类型的提示没有那么有用。我从我的 C# 时代开始学习它。老习惯...

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-12-30T11:32:13.910

我一直在寻找相同的答案，我做了一些研究，我刚刚发现 php 框架建议不同的风格：

**代码点火器**

官方手册有一个[编码风格部分鼓励这种做法](https://www.codeigniter.com/user_guide/general/styleguide.html#private-methods-and-variables)：

> 私有方法和变量
> 
> 仅在内部访问的方法和变量，例如公共方法用于代码抽象的实用程序和辅助函数，应使用下划线作为前缀。

```
public function convert_text()

private function _convert_text() 
```

其他框架也这样做，比如

**蛋糕PHP：**

[做同样的事情](http://book.cakephp.org/3.0/en/contributing/cakephp-coding-conventions.html#member-visibility)：

> 会员知名度
> 
> 对方法和变量使用 PHP5 的私有和受保护关键字。此外，非公共方法或变量名称以单个下划线 (_) 开头。例子：

```
class A
{
    protected $_iAmAProtectedVariable;

    protected function _iAmAProtectedMethod()
    {
       /* ... */
    }

    private $_iAmAPrivateVariable;

    private function _iAmAPrivateMethod()
    {
        /* ... */
    }
} 
```

并且

**梨**

[做同样的事情](http://pear.php.net/manual/en/standards.naming.php)：

> 私有类成员前面有一个下划线。例如：

```
$_status    _sort()     _initTree() 
```

尽管

**德鲁巴**

代码风格特别[警告这一点](https://www.drupal.org/node/608152#naming)：

> 9.  受保护或私有的属性和方法不应使用下划线前缀。

**交响乐**

另一方面，[声明](http://symfony.com/doc/current/contributing/code/standards.html)：

> Symfony 遵循 PSR-0、PSR-1、PSR-2 和 PSR-4 文档中定义的标准。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-19T18:07:35.410

我相信您最初的假设是正确的，我发现某些语言在方法/成员等前加上下划线是一种常见的做法，这些方法/成员等旨在对“对象”保持私有。只是一种直观的说法，虽然你可以，但你不应该打电话给这个！

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-04-08T18:52:28.353

我从 python 中知道，在变量前加下划线会导致编译器在实际变量名前面翻译一些随机的字母和数字序列。这意味着任何从类外部访问变量的尝试都会导致“变量未定义”错误。

不过，我不知道这是否仍然是在 python 中使用的约定

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-11-01T09:16:08.517

在 Drupal（一个 php CMS）中，下划线可用于防止调用挂钩（[https://api.drupal.org/api/drupal/includes!module.inc/group/hooks/7](https://api.drupal.org/api/drupal/includes!module.inc/group/hooks/7)）。

如果我有一个名为“my_module”的模块并想命名一个函数 my_module_insert，它将“挂钩”函数 hook_insert。为了防止这种情况，我可以将我的函数重命名为 _my_module_insert。

ps 钩子在 Drupal 中的工作方式可能会错误地实现钩子，这是非常糟糕的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-05-07T19:36:47.030

Drupal，并使用下划线：

一般来说，下划线是为了简单地标记一个函数可能只会被相关的父函数调用的事实......

```
function mymodule_tool($sting="page title"){
    $out ='';
    //do stuff 
    $out  .= _mymodule_tool_decor($sting);
    return $out;
}

function _mymodule_tool_decor($sting){
    return '<h1>'.$string.'</h1>';
} 
```

当然，只是一个简单的例子......

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-02-23T08:26:56.683

使用下划线只是为了记住我们不会在类外“修改变量”/“调用函数”。

因为我们声明了所有大写的 const 变量，所以在看到变量名时可以猜测它是一个 const 变量。类似于我们不想在类外修改的变量，我们用下划线声明它以符合我们自己的约定。

* * *

## 回答 #13

> 赞同：-22
> 
> 时间：2010-09-28T15:30:23.587

它们被称为[“魔术方法”](http://php.net/manual/en/language.oop5.magic.php)。

# c# - 通过对象树中的反射调用单例对象上的方法

> ID：663354
> 
> 赞同：0
> 
> 时间：2009-03-19T18:05:57.830
> 
> 标签：c#, reflection, console

这类似于[在单例对象上使用反射调用方法，](https://stackoverflow.com/questions/204468/invoking-a-method-using-reflection-on-a-singleton-object)但它具有更深的上下文。首先，我想说这是一个我只是在玩弄想法的项目，这绝不是生产代码，并且该项目采取了非常不同的路径，但是这个问题仍然困扰着我，所以就在这里。

我有一个只包含对象实例的单例（虽然非静态本质上也是单例，但由基本单例引用）

```
 static CoreInstance()
    {
        Kernel = new Kernel();
        Devices = new Devices();
        Interfaces = new Interfaces();
        Interoperability = new Interoperability();
        Environment = new Environment();
        Data = new Data();
    } 
```

通常这一切都很好，但这些本身通常是容器对象，例如，我可能想做以下事情：

```
CoreInstance.Kernel.RaiseError("I'm an error lol!", ErrorLevel.Trivial); 
```

-或者-

```
string username = CoreInstance.Environment.User.FullName; 
```

但我是从用户命令控制台执行此操作的，这是稍后的 SO 问题的另一个讨论；-)

**所以这里的主要问题是：如何编写递归反射函数来分解这样的类路径字符串以执行方法/评估属性？**

注意：假设调用已经被分解成一个结构，其中包含一个用于路径元素的有序字符串数组、一个用于方法/属性的字符串以及一个用于参数的对象数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T18:32:45.443

好吧，如果您有两个包含属性/方法名称和每个参数的数组，那么我认为这样的事情会起作用：

```
public object Execute(object target, IEnumerable<string> memberNames, IEnumerable<object[]> args)
    {
        if(memberNames.Count() == 0)
            return target;

        string currentMember = memberNames.First();
        object[] currentArgs = args.First();

        object value;

        if (currentArgs.Length == 0)
        {
            //property
            PropertyInfo pi = target.GetType().GetProperty(currentMember);
            value = pi.GetValue(target, null);
        }
        else
        {
            //method
            MethodInfo mi = target.GetType().GetMethod(currentMember);
            value = mi.Invoke(target, currentArgs);
        }

        return Execute(value, memberNames.Skip(1), args.Skip(1));
    } 
```

因此，对于您的第一个示例，您可以这样称呼它：

```
string[] members = { "Kernel", "RaiseError" };
object[][] arguments = new[]{ new object[]{}, new object[]{"I'm an error lol!", ErrorLevel.Trivial}};
Execute(CoreInstance, members, arguments); 
```

# c# - 如何使用 TabItem 名称的参数调用 XAML 中的绑定方法？

> ID：663356
> 
> 赞同：0
> 
> 时间：2009-03-19T18:06:18.190
> 
> 标签：c#, wpf, data-binding, xaml

我有一个绑定在 XAML 中的对象的实例。它有一个方法会返回给我一个其他对象的列表（基于我传递这个方法的属性值，它会返回所有具有该属性值的对象）。

```
<ObjectDataProvider ObjectInstance="_this.DataContext" MethodName="GetListByCategory" x:Key="List">
        <ObjectDataProvider.MethodParameters>
            <System:String>Windows</System:String>
        </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider> 
```

我（最终）想在带有一些复杂数据模板的选项卡上显示此列表。但不要超越自己。

我想获取应该在 TabControl 内的特定 TabItem 上显示的所有对象（具有与 TabItem 的名称或标题匹配的类别的对象 - 这是在方法中完成的）。如何将我的绑定方法传递给相关的 TabItem 的标题或名称？

请记住，我需要绑定到此绑定方法的返回值以显示在 TabItem 的 DataTemplate 中。我不知道这是否必然与问题的答案相关，但我想确保我清楚地定义它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T19:32:15.847

不幸的`MethodParameters`是 an 的`ObjectDataProvider`不能直接绑定。

您可以通过使用`TwoWay`or`OneWayToSource`绑定来解决此问题。`Directory.GetFiles`这是一个替代您的`GetListByCategory`方法的示例：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:io="clr-namespace:System.IO;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <x:Array x:Key="directories" Type="{x:Type sys:String}">
            <sys:String>C:\</sys:String>
            <sys:String>C:\Windows\</sys:String>
            <sys:String>C:\Windows\System32\</sys:String>
        </x:Array>
        <ObjectDataProvider x:Key="fileList" ObjectType="{x:Type io:Directory}" MethodName="GetFiles">
            <ObjectDataProvider.MethodParameters>
                <!-- Initial value, this will get wiped out by the Binding below. -->
                <sys:String>C:\</sys:String>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Grid.Resources>
    <TabControl ItemsSource="{StaticResource directories}">
        <TabControl.ItemContainerStyle>
            <Style TargetType="{x:Type TabItem}">
                <Setter Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type sys:String}">
                            <ListBox ItemsSource="{Binding Source={StaticResource fileList}}"/>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </TabControl.ItemContainerStyle>
        <TabControl.SelectedItem>
            <Binding Source="{StaticResource fileList}"    
                     Path="MethodParameters[0]"
                     BindsDirectlyToSource="True"  
                     Mode="OneWayToSource"/>
        </TabControl.SelectedItem>
    </TabControl>
</Grid> 
```

`TabControl.SelectedItem`绑定到`ObjectDataProvider.MethodParameters[0]`using OneWayToSource，这样当我们改变标签页时，method 参数会更改到新目录。

# c# - 如何覆盖另一个程序集中的方法？

> ID：663366
> 
> 赞同：1
> 
> 时间：2009-03-19T18:08:14.130
> 
> 标签：c#, asp.net, community-server

我之前问过一个关于接口的问题，得到了一些很好的回答。我很高兴开始开发真正灵活的代码。

我现在有一个关于覆盖虚拟方法的问题。

我目前正在使用社区服务器 SDK。其中一个控件是“标记”面包屑。因此它将列出相关对象上的“标签”。

```
<CSBlog:TagBreadCrumb /> 
```

我正在使用标签来允许管理员定位特定位置以使内容出现在布局中，但是这些标签与最终用户无关。例如，“Home_Main”标签用于定位主页上的主面板，但我不希望用户看到它。

由于我有社区服务器的 SDK，我找到了呈现“标签列表”的控件，并对其进行了修改以实现我想要的 - 但是我的理解是，出于多种原因修改核心并不好。

所以我想做的是创建我自己的控件，它基本上与基本控件几乎 100% 相同，但覆盖了一种方法。

这是方法：

```
 public virtual string FormatTags(string[] tagList) 
```

里面有格式化标签的代码，我想编写自己的代码来做所有相同的事情，除了检查配置文件中的“标签”以排除。

所以我的理解是我创建了我的控件，从基本控件派生 - 我可以编写自己的 FormatTags() 方法 - 对吗？

我只需要改变它的一个方面，但这是否意味着我必须从基类复制该方法的原始代码 - 并在那里改变我需要的东西？它只是从一个地方感觉不正确的copyign代码，但我不知道在不更改基类中的代码的情况下扩展该方法的另一种方法。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T18:16:54.420

在您的情况下（您想禁止在面包屑中打印某些标签），您将在调用基本方法之前删除所有特殊标签。

所以你的代码看起来像：

```
public override string FormatTags(string[] tagList)
{
  // strip special tags
  string[] newTagList = stripTags(tagList);
  return base.FormatTags(newTagList);
} 
```

这样您就不需要了解基类如何格式化输出字符串。

如果您想修改输出字符串的格式，则不会对基本方法进行任何调用（因为该方法可能会在将来的版本中更改其格式，您不希望受到影响）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T18:13:17.143

您仍然可以运行派生方法并对其结果进行操作：

```
public override string FormatTags(string[] tagList) {
    string result = base.FormatTags(tagList);
    // do something with result
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T18:14:33.457

> 所以我的理解是我创建了我的控件，从基本控件派生 - 我可以编写自己的 FormatTags() 方法 - 对吗？

**这是正确的; 当你重写时，你提供了你自己的基类方法的实现。**

在最好的情况下，会发生以下两种情况之一：

*   有一种简单的方法可以将基类方法的输出转换为所需的结果。

*   基类使用策略模式或其变体，因此您只需提供策略适当部分的替代实现。

不幸的是，这听起来不像这里的任何一个，所以你可能不得不从头开始编写它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T18:16:29.490

> 所以我的理解是我创建了我的控件，从基本控件派生 - 我可以编写自己的 FormatTags() 方法 - 对吗？

完全正确。

如果你发现你需要复制大量代码，你应该考虑重组你的方法。将要复制的代码放入您不会覆盖的另一个方法中，然后当您覆盖 FormatTags 时，更改您需要的内容，并通过调用另一个方法访问您将复制的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T18:16:38.243

看看[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。这些允许您通过在自己的静态类中定义函数来扩展无法编辑或扩展的密封类的功能。这是我刚刚写的一个例子（可能有语法错误）。

```
public static class MyExtensions
{
    public static string AppendCrazyText(this string s, string crazyText)
    {
        return s + crazyText;
    }
} 
```

现在，要访问它，我可以简单地调用：

```
string myString = "Hello world";
string myCrazyText = ", lets go crazy!";

string myResult = myString.AppendCrazyText(myCrazyText); 
```

# java - Java 有序映射

> ID：663374
> 
> 赞同：364
> 
> 时间：2009-03-19T18:11:01.627
> 
> 标签：java, collections

在 Java 中，是否有一个对象可以像 Map 一样存储和访问键/值对，但可以返回键的有序列表和值的有序列表，使得键和值列表的顺序相同？

因此，作为代码解释，我正在寻找类似于我虚构的 OrderedMap 的东西：

```
OrderedMap<Integer, String> om = new OrderedMap<>();
om.put(0, "Zero");
om.put(7, "Seven");

String o = om.get(7); // o is "Seven"
List<Integer> keys = om.getKeys();
List<String> values = om.getValues();

for(int i = 0; i < keys.size(); i++)
{
    Integer key = keys.get(i);
    String value = values.get(i);
    Assert(om.get(key) == value);
} 
```

* * *

## 回答 #1

> 赞同：452
> 
> 时间：2009-03-19T18:17:14.497

[SortedMap](https://docs.oracle.com/javase/8/docs/api/java/util/SortedMap.html)接口（带有实现[TreeMap](https://docs.oracle.com/javase/8/docs/api/java/util/TreeMap.html)）应该是您的朋友。

该接口具有以下方法：

*   [`keySet()`](https://docs.oracle.com/javase/8/docs/api/java/util/SortedMap.html#keySet--)它按升序返回一组键
*   [`values()`](https://docs.oracle.com/javase/8/docs/api/java/util/SortedMap.html#values--)它以相应键的升序返回所有值的集合

所以这个接口完全符合您的要求。但是，键必须具有有意义的顺序。否则，您可以使用顺序由插入顺序确定的[LinkedHashMap 。](https://docs.oracle.com/javase/8/docs/api/java/util/LinkedHashMap.html)

* * *

## 回答 #2

> 赞同：237
> 
> 时间：2009-03-19T18:15:53.877

> 是否有一个对象可以像 Map 一样存储和访问键/值对，但可以返回键的有序列表和值的有序列表，使得键和值列表的顺序相同？

您正在寻找[**java.util.LinkedHashMap**](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html)。您将获得[**Map.Entry<K,V>**](http://java.sun.com/javase/6/docs/api/java/util/Map.Entry.html)对的列表，它们总是以相同的顺序迭代。该顺序与您放入项目的顺序相同。或者，使用[**java.util.SortedMap**](http://java.sun.com/javase/6/docs/api/java/util/SortedMap.html)，其中键必须具有*自然顺序*或由 a 指定`Comparator`。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2015-01-05T22:35:18.400

LinkedHashMap 维护键的顺序。

java.util.LinkedHashMap 看起来就像普通的 HashMap 一样工作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-19T18:16:34.560

我认为您将从框架中获得的最接近的集合是[SortedMap](http://java.sun.com/j2se/1.5.0/docs/api/java/util/SortedMap.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-06-22T22:05:02.607

您可以利用可以按升序或降序键顺序访问和遍历的[NavigableMap接口。](http://docs.oracle.com/javase/7/docs/api/java/util/NavigableMap.html)此接口[旨在取代](http://docs.oracle.com/javase/6/docs/technotes/guides/collections/changes6.html)SortedMap 接口。可导航地图通常根据其键的自然顺序进行排序，或者通过在地图创建时提供的比较器进行排序。

它有三个最有用的实现：[TreeMap](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)、[ImmutableSortedMap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableSortedMap.html)和[ConcurrentSkipListMap](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)。

树图示例：

```
TreeMap<String, Integer> users = new TreeMap<String, Integer>();
users.put("Bob", 1);
users.put("Alice", 2);
users.put("John", 3);

for (String key: users.keySet()) {
  System.out.println(key + " (ID = "+ users.get(key) + ")");
} 
```

输出：

```
Alice (ID = 2)
Bob (ID = 1)
John (ID = 3) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-12-29T01:01:43.347

# tl;博士

要保持`Map< Integer , String >`按键排序，请使用实现[`SortedMap`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/SortedMap.html)/[`NavigableMap`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/NavigableMap.html)接口的两个类中的任何一个：

*   [`TreeMap`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/TreeMap.html)
*   [`ConcurrentSkipListMap`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ConcurrentSkipListMap.html)

… 或第三方实现。也许在[*Google Guava*](https://en.wikipedia.org/wiki/Google_Guava)或[*Eclipse Collections*](https://www.eclipse.org/collections/)中（我没有检查过）。

如果在单个线程中操作地图，请使用第一个`TreeMap`. 如果跨线程操作，请使用第二个，`ConcurrentSkipListMap`.

有关详细信息，请参见下表和以下讨论。

# 细节

这是我制作的图表，显示了`Map`与 Java 11 捆绑的十种实现的特性。

该[`NavigableMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/NavigableMap.html)接口是[`SortedMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/SortedMap.html). 逻辑上应该删除，`SortedMap`但不能因为某些第 3 方地图实现可能正在使用接口。

正如您在此表中看到的，只有两个类实现了`SortedMap`/`NavigableMap`接口：

*   [`TreeMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/TreeMap.html)
*   [`ConcurrentSkipListMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ConcurrentSkipListMap.html)

这两个都按自然顺序（[`compareTo`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Comparable.html#compareTo(T))使用`Comparable`（[https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/ Comparable.html](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Comparable.html) ) 接口）或通过[`Comparator`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Comparator.html)您传递的实现。这两个类之间的区别在于，第二个类[`ConcurrentSkipListMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ConcurrentSkipListMap.html)是[线程安全的](https://en.wikipedia.org/wiki/Thread_safety)、高度[并发](https://en.wikipedia.org/wiki/Concurrent_computing)的。

另请参阅下表中的*迭代顺序*列。

*   该类按**最初插入**[`LinkedHashMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/LinkedHashMap.html)的顺序返回其条目。
***   [`EnumMap`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/EnumMap.html)**按照定义键的枚举类**的顺序返回条目。例如，哪个员工覆盖一周中的哪一天 ( `Map< DayOfWeek , Person >`) 的地图使用[`DayOfWeek`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/DayOfWeek.html)Java 中内置的枚举类。该枚举定义为第一个星期一和最后一个星期日。因此迭代器中的条目将按该顺序出现。**

 **其他六个实现不承诺它们报告条目的顺序。

[![Java 11 中的地图实现表，比较它们的特性](https://i.stack.imgur.com/kZ8BU.png)](https://i.stack.imgur.com/kZ8BU.png)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-19T18:21:05.690

我认为 SortedMap 接口强制执行您的要求，而 TreeMap 实现了它。

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/SortedMap.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/SortedMap.html) [http://java.sun.com/j2se/1.5.0/docs/api/java/util /TreeMap.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/TreeMap.html)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-06T12:10:27.357

[从 Java 6 开始， TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)也有了非阻塞线程安全的替代方案。请参阅[ConcurrentSkipListMap](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-10-08T11:36:11.120

我使用了**简单哈希映射、链表和集合**来按值对映射进行排序。

```
import java.util.*;
import java.util.Map.*;
public class Solution {

    public static void main(String[] args) {
        // create a simple hash map and insert some key-value pairs into it
        Map<String, Integer> map = new HashMap<String, Integer>();
        map.put("Python", 3);
        map.put("C", 0);
        map.put("JavaScript", 4);
        map.put("C++", 1);
        map.put("Golang", 5);
        map.put("Java", 2);
        // Create a linked list from the above map entries
        List<Entry<String, Integer>> list = new LinkedList<Entry<String, Integer>>(map.entrySet());
        // sort the linked list using Collections.sort()
        Collections.sort(list, new Comparator<Entry<String, Integer>>(){
        @Override
         public int compare(Entry<String, Integer> m1, Entry<String, Integer> m2) {
        return m1.getValue().compareTo(m2.getValue());
        }
      });
      for(Entry<String, Integer> value: list) {
         System.out.println(value);
     }
   }
} 
```

输出是：

```
C=0
C++=1
Java=2
Python=3
JavaScript=4
Golang=5 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-16T08:36:57.423

Steffi Keran 答案的现代 Java 版本

```
public class Solution {
    public static void main(String[] args) {
        // create a simple hash map and insert some key-value pairs into it
        Map<String, Integer> map = new HashMap<>();
        map.put("Python", 3);
        map.put("C", 0);
        map.put("JavaScript", 4);
        map.put("C++", 1);
        map.put("Golang", 5);
        map.put("Java", 2);
        // Create a linked list from the above map entries
        List<Map.Entry<String, Integer>> list = new LinkedList<>(map.entrySet());
        // sort the linked list using Collections.sort()
        list.sort(Comparator.comparing(Map.Entry::getValue));
        list.forEach(System.out::println);
    }
} 
```

# perl - 将二进制文件中的矩阵映射到 Perl

> ID：663375
> 
> 赞同：2
> 
> 时间：2009-03-19T18:11:53.073
> 
> 标签：perl, matrix

我有一个带有矩阵的 14 MB 文件，采用原始二进制格式。我想啜饮它并拥有类似数组的东西，所以我可以读取一些值。我希望找到一些神奇的 Perl 模块，考虑到矩阵的大小，它可以为我完成所有工作:)

但我找不到它，我怀疑我只是错过了一种更明显的方法。PDL::IO::FlexRaw 接近我需要的，尽管我对 F77 添加的奇怪字符的警告有点困惑。

矩阵是二进制文件，原始格式，64 位浮点数。二进制文件的前 8 个字节是矩阵 (1,1) 的第一个“单元”。接下来的八个字节是第二个单元格 (2,1)。它没有页眉和页脚。我知道它的尺寸，所以我可以告诉模块“我每 64000 个字节就有一行”。

我正在查看 tie::mmapArray，但我不知道我是否可以使它工作。也许我更好地使用 lseek() 来回找到我需要的八个字节，然后 unpack() 它？

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T19:53:06.030

除非你的内存很紧，否则只需读入整个文件。

```
$size = -s $filename;
open(DATA, $filename);
sysread DATA, $buffer, $size;
@floats = unpack("d*", $buffer);
$float2x1 = $floats[ 2 + (1-1)*$width ]; 
```

那应该访问（2,1）。（虽然我没有测试它......）

编辑：

好的，低内存版本：

```
use Sys::Mmap;
new Sys::Mmap $buffer, -s $filename, $filename or die $!;
$float2x1 = unpack("d", substr($buffer,8*( (2-1) + (1-1)*$width ),8)); 
```

只需要来自 CPAN 的 Sys::Mmap。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T18:28:27.187

在不知道文件结构的情况下，任何图书馆都希望阅读它吗？如果它是某种标准化的矩阵二进制格式，那么您可以尝试搜索[CPAN](http://search.cpan.org/)。否则，我猜你将不得不自己做这项工作。

假设它不是[稀疏矩阵](http://en.wikipedia.org/wiki/Sparse_matrix)，可能只是读取维度，然后读取适当大小的块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T18:24:42.670

看看[pack](http://perldoc.perl.org/functions/pack.html)和[unpack](http://perldoc.perl.org/functions/unpack.html)（尤其是 unpack）可能会让你走上正轨，看看 b 格式。

# c# - 多种类型的单一方法？

> ID：663382
> 
> 赞同：0
> 
> 时间：2009-03-19T18:14:12.477
> 
> 标签：c#, .net, casting, types

如果您的函数适用于具有相同实现的许多不同自定义类型，那么可以使用这样的设计模式吗？：

```
type1 implicitly casts to type0
type2 implicitly casts to type0
type3 implicitly casts to type0

Operate ( type0 ) 
```

并致电：

```
type1 a
type2 b
type3 c

Operate ( a )
Operate ( b )
Operate ( c ) 
```

这种技术有问题吗？性能明智，清晰度等？

编辑：同样通过隐式转换，我的意思是自定义实现的类型转换，没有数据丢失，只是方便。假设您有一个 Pixel 类，然后将其实例发送到采用 Point2 的方法，该方法自动将像素转换为 Point2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T18:21:22.240

这是接口如何工作的基础。

```
public interface IBlah {
    void DoSomething();
}
public class Type1 : IBlah {
    void DoSomething() { /* implementation */ }
}
public class Type2 : IBlah {
    void DoSomething() { /* implementation */ }
}
public class Type3 : IBlah {
    void DoSomething() { /* implementation */ }
}

public class Foo {
    void Operate(IBlah blah) {
        blah.DoSomething();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:18:23.137

强制转换通常会创建一个新对象，在这种情况下是不必要的

执行此操作的更多 OOP 方法是通过基类或接口。

```
class Type1 : IOperatableType {}
class Type2 : IOperatableType {}
class Type3 : IOperatableType {}

void Operate ( IOperatableType a ) 
```

或者

```
class Type1 : Type0 {}
class Type2 : Type0 {}
class Type3 : Type0 {}

void Operate ( Type0 a ) 
```

调用方法（在这种情况下为操作）取决于使用其参数的方法或属性。如果在所有类型（type1、type2、type3）中定义了这些属性/方法，请考虑使用定义通用功能的接口。如果属性和方法的实现相同，请避免重复代码并考虑从基类继承。

此外，在尝试理解您的代码时，开发人员更有可能首先查看类图，这使他们能够看到类之间的关系，或者至少是类定义（将显示基本类型和实现的接口），而不是查看（隐式/显式）运算符以查看哪个类可转换为哪个其他类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T18:19:13.493

这是完全正常的做法。

性能方面，我认为没有任何问题。

清晰明智，由于 Intellisense，您也不太可能对此有问题。

# c# - 使用 WebRequest 进行 SOAP Web 服务调用

> ID：663385
> 
> 赞同：0
> 
> 时间：2009-03-19T18:14:38.467
> 
> 标签：c#, asp.net, web-services, asmx

我们有一个 ASP.Net Web 应用程序，它调用部署在同一虚拟目录中的 Web 服务。调用在开发机器中返回没有任何问题。但是当部署到生产服务器时，它会返回一个“400 Bad Request”错误。通过创建 WebRequest 并设置 SoapAction 标头进行调用，然后 WebResponse.GetRepsonseStream() 获取 SOAP 响应。暂时，我们通过使用生成的代理进行调用来解决此问题。

任何人都可以建议使用 WebRequest 和 WebResponse 调用 Web 服务而不会遇到 400 错误的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T18:29:08.027

我不明白你为什么要那样做。我会添加一个对服务 WSDL 的 Web 引用，让框架来处理其余的事情！根据我对 Web 服务和 ASP.NET 的经验，这是最简单的方法。

# macos - 没有主目录的用户的 SSH 公钥

> ID：663397
> 
> 赞同：3
> 
> 时间：2009-03-19T18:17:24.950
> 
> 标签：macos, ssh, rsa, osx-leopard

我正在运行 Mac OS X Leopard Server，我创建了一个新用户，但没有为该用户指定主目录。是否可以让该用户使用公钥进行身份验证？

我知道当用户**确实**有一个主目录时，它会进入`~/.ssh/authorized_keys`

我不想为这个用户创建一个主目录，因为我的理解是，如果给予物理访问权限，它将允许他们登录。

**更新：**我只需要允许该用户进行安全 FTP 连接。将 Login Shell 设置为`/bin/false/`也将阻止它们进行远程连接。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T18:32:46.443

您必须编辑`/etc/ssh/sshd_config`或它在您的机器上的位置并更改`AuthorizedKeysFile`设置。

文档说：

```
 AuthorizedKeysFile
         Specifies the file that contains the public keys that can be used
         for user authentication.  AuthorizedKeysFile may contain tokens of
         the form %T which are substituted during connection setup.  The fol-
         lowing tokens are defined: %% is replaced by a literal '%', %h is
         replaced by the home directory of the user being authenticated, and
         %u is replaced by the username of that user.  After expansion,
         AuthorizedKeysFile is taken to be an absolute path or one relative
         to the user's home directory.  The default is
         ``.ssh/authorized_keys''. 
```

但是为什么你有没有家的用户（可以登录）？

# active-directory - LDAP 和 Active Directory 有什么区别？

> ID：663402
> 
> 赞同：417
> 
> 时间：2009-03-19T18:18:27.723
> 
> 标签：active-directory, ldap

LDAP 和 Active Directory 有什么区别？

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2009-03-19T18:26:09.500

Active Directory 是基于数据库的系统，可在 Windows 环境中提供身份验证、目录、策略和其他服务

LDAP（轻量级目录访问协议）是一种应用程序协议，用于查询和修改目录服务提供商（如 Active Directory）中的项目，它支持一种 LDAP 形式。

简短的回答：AD 是一个目录服务数据库，而 LDAP 是您可以用来与之对话的协议之一。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2009-03-19T18:26:40.247

LDAP 是一种标准，AD 是 Microsoft 的（专有）实现（以及更多）。[维基百科](http://en.wikipedia.org/wiki/Active_Directory)有一篇很好的文章，深入研究了细节。我发现[这份文档](ftp://ftp.uni-duisburg.de/LDAP/Adam-Eval1-0.pdf)从 LDAP 的角度对 AD 进行了非常详细的评估。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-03-19T18:26:56.597

轻量级目录访问协议或 LDAP，是用于与目录数据交互的基于标准的规范。目录服务可以实现对 LDAP 的支持，以提供 3rd 方应用程序之间的互操作性。

Active Directory 是 Microsoft 实施的目录服务，除其他协议外，它还支持 LDAP 查询其数据。

虽然它支持 LDAP，但 Active Directory 提供了许多扩展和便利，例如密码过期和帐户锁定。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2015-07-09T07:38:38.527

**简短的摘要**

`Active Directory`是微软实现的目录服务，它支持`Lightweight Directory Access Protocol`（LDAP）。

**长答案**

首先，需要知道什么是`Directory Service`.

目录服务是一种软件系统，用于存储、组织和提供对计算机操作系统目录中信息的访问。在软件工程中，目录是名称和值之间的映射。它允许查找命名值，类似于字典。

有关更多详细信息，请阅读[https://en.wikipedia.org/wiki/Directory_service](https://en.wikipedia.org/wiki/Directory_service)

其次，可以想象，不同的供应商实现了各种形式的目录服务，这不利于多供应商的互操作性。

第三，因此在 1980 年代，ITU 和 ISO 提出了一套标准——X.500，用于目录服务，最初是为了支持跨运营商电子信息和网络名称查找的要求。

第四，基于该标准，开发了轻量级目录访问协议LDAP。它使用 TCP/IP 堆栈和 X.500 目录访问协议 (DAP) 的字符串编码方案，使其在 Internet 上更具相关性。

最后，基于此 LDAP/X.500 堆栈，Microsoft 为 Windows 实施了现代目录服务，源自 X.500 目录，创建用于 Exchange Server。而这个实现被称为`Active Directory`.

所以简而言之，`Active Directory`是微软实现的目录服务，并且它支持`Lightweight Directory Access Protocol`（LDAP）。

PS[0]：这个答案大量复制了上面列出的维基百科页面的内容。

PS[1]：要了解为什么最好使用目录服务而不是仅使用关系数据库，请阅读[https://en.wikipedia.org/wiki/Directory_service#Comparison_with_relational_databases](https://en.wikipedia.org/wiki/Directory_service#Comparison_with_relational_databases)

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2010-05-20T15:34:26.460

Active Directory 不仅仅是 Microsoft 的 LDAP 实现，它只是 AD 的一小部分。Active Directory 是（以一种过于简化的方式）提供基于 LDAP 的身份验证和基于 Kerberos 的授权的服务。

当然，他们在 AD 中的 LDAP 和 Kerberos 实现并不完全可以 100% 与其他 LDAP/Kerberos 实现互操作......

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2010-09-10T06:59:07.293

Active Directory 是一个目录服务提供商，您可以在其中向目录添加新用户、删除或修改、指定权限、分配策略等。它就像一个电话目录，每个人都有一个唯一的联系号码。AD（Active Directory）中的每一件事都被视为对象，并且每个对象都被赋予一个唯一 ID。（类似于电话目录中的唯一联系人号码。

Ldap 是专为目录服务提供商设计的协议。Windows 服务器操作系统使用 AD 作为目录服务器，IBM 的 UNIX 版本的 AIX 使用 Tivoli 目录服务器。它们都使用 LDAP 协议与目录进行交互。

除了协议之外，还有 LDAP 服务器和 LDAP 浏览器。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-08-16T07:15:25.357

活动目录是目录服务数据库，用于存储基于组织的数据、策略、身份验证等，而 ldap 是用于与 ad 或 adam 目录服务数据库通信的协议。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-11-07T15:49:53.467

LDAP 位于 TCP/IP 堆栈之上并控制 Internet 目录访问。它与环境无关。

AD & ADSI 是围绕 LDAP 层的 COM 包装器，并且是特定于 Windows 的。

[你可以在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366149%28v=vs.85%29.aspx)看到微软的解释 。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-10-30T19:28:30.747

[https://jumpcloud.com/blog/difference-between-ldap-and-active-directory/](https://jumpcloud.com/blog/difference-between-ldap-and-active-directory/)

实际上，这两个目录解决方案之间的差异可能比相似之处更多。Microsoft 的 AD 在很大程度上是 Windows 用户、设备和应用程序的目录。AD 需要存在 Microsoft 域控制器，如果存在，用户可以单点登录到域结构中的 Windows 资源。

另一方面，LDAP 主要在 Windows 结构之外工作，专注于 Linux / Unix 环境和更多技术应用程序。LDAP 没有相同的域或单点登录概念。LDAP 在很大程度上是通过开源解决方案实现的，因此比 AD 具有更大的灵活性。

LDAP 和 Active Directory 之间的另一个关键区别是 AD 和 LDAP 各自处理设备管理的方式。AD 通过组策略对象 (GPO) 管理 Windows 设备。LDAP 中不存在类似的概念。LDAP 和 AD 都是非常不同的解决方案，因此许多组织必须利用两者来服务于不同的目的。

这就是为什么有一个明显的创新机会。为什么要利用和管理两个完整的系统，当一个系统可以有效地合并两者时？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-20T00:38:05.503

有很多系统支持 LDAP 与它们通信，而不仅仅是 Active Directory。

Sun、IBM、Novell 都有非常有效的目录服务作为 LDAP 服务器。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-10T16:01:19.333

Active Directory 是 LDAP 协议的超集。根据组织使用 Active Directory 的方式，您的 LDAP 搜索/设置查询可能有效，也可能无效。

# unix - 我在哪里可以获得 Open Group 基本规范的印刷版？

> ID：663409
> 
> 赞同：0
> 
> 时间：2009-03-19T18:19:35.677
> 
> 标签：unix, printing, specifications

我发现自己在工作时经常使用 Open Group 的基本规范。在线使用它们很好，但我想要一个印刷版。

我在[这里](http://www.opengroup.org/bookstore/catalog/c082.htm)找到了该网站，但该网站说印刷版不可用。html 版本是免费提供的，但 PDF 需要支付 4 位数的会员费，我做不到。

无论如何，我可以解析 html 页面并将它们发送到某个地方为我打印吗？或者有谁知道我可以通过其他方式得到这个印刷品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T18:40:49.433

使用 curl 下载 HTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T18:42:47.183

有许多托管的 html 到 pdf 转换服务可以为您进行快速而肮脏的转换。[这是](http://www.pdfonfly.com/)我用过的一个。

对于更专业的工作，您必须将 html 下载到您的硬盘上。然后，您可以随心所欲地操纵它。我会将网页合并为一个 word 文档，然后使用 pdf 打印机生成 pdf（如果您使用开放式办公室，您可以直接导出为 pdf）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T18:45:16.567

您也可以考虑使用 wget 并将其用作基本 URL：

[http://www.opengroup.org/onlinepubs/9699919799/basedefs/contents.html](http://www.opengroup.org/onlinepubs/9699919799/basedefs/contents.html)

# svn - 如何在 Nant 中检测现有的 SVN 目录？

> ID：663412
> 
> 赞同：1
> 
> 时间：2009-03-19T18:20:35.847
> 
> 标签：svn, build-process, nant

我正在构建一个分支我们项目的目标。

它在 SVN 中创建一个分支，签出该分支，使用新提供的版本号更新该分支中的各种文件，并将其全部签入。

SVN 分支第一次运行良好（使用复制命令 URL->URL），但如果第二次运行，它将主干复制到 BranchName/trunk，而不是说它已经存在。

Nant 是否有合理的方法来检测分支已经存在并且不尝试第二次进行 SVN 复制？

我正在尝试在脚本中构建一些智能，以便如果它以相同的输入第二次运行，则不会发生任何不好的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T18:34:14.393

我不知道特定于 Nant 的方法，但您可以使用`svn info`以下方法检查：

```
>svn info http://svn.host.com/repo/no-such-path
http://svn.host.com/repo/no-such-path:  (Not a valid URL) 
```

相对

```
>svn info http://svn.host.com/repo/existing-path
Path: existing-path
URL: http://svn.host.com/repo/existing-path
Repository Root: http://svn.host.com/repo
Repository UUID: ...
Revision: ...
Node Kind: ...
Last Changed Author: ...
Last Changed Rev: ..
Last Changed Date: ... 
```

遗憾的是，ERRORLEVEL`0`在任何一种情况下都适用，但如果有帮助，您可以使用该`--xml`开关。或者查看一些 Subversion 的 .NET 绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:29:16.253

这是我的最终脚本：

```
<target name="branchSvn">
    <exec program="${svn.executable}" 
    commandline='info ${svn.build.root.path}/branches/${branch.name}/ --xml' output='svn_${branch.name}.xml' />
    <xmlpeek file='svn_${branch.name}.xml' xpath='/info' 
    property='branch.info' />
    <echo message='${svn.build.root.path}/branches/${branch.name}/ already exists.' 
    if="${branch.info!=''}" />
    <delete file='svn_${branch.name}.xml' />
    <exec program="${svn.executable}" 
    commandline='copy ${svn.build.root.path}/trunk ${svn.build.root.path}/branches/${branch.name}/ -m "Branched ${branch.name} by nant script."' 
    if="${branch.info==''}" />
</target> 
```

我使用 -xml 函数和 xmlpeek 来获取我需要的信息。

# c# - 从 c# 中的 namevaluecollection 填充对象数组

> ID：663416
> 
> 赞同：1
> 
> 时间：2009-03-19T18:22:17.667
> 
> 标签：c#, arrays, object, namevaluecollection

我是 C# 新手。这是我开始工作的硬编码：

```
InputProperty grantNumber = new InputProperty();
grantNumber.Name = "udf:Grant Number";
grantNumber.Val = "571-1238";

Update update = new Update();
update.Items = new InputProperty[] { grantNumber }; 
```

现在我想推广它以支持 Update 对象中无限数量的项目，我想出了这个但它无法编译：

```
Update update = BuildMetaData(nvc);  //call function to build Update object 
```

以及这里的函数本身：

```
private Update BuildMetaData(NameValueCollection nvPairs)
{
    Update update = new Update();
    InputProperty[] metaData;       // declare array of InputProperty objects
    int i = 0;
    foreach (string key in nvPairs.Keys)
    {
        metaData[i] = new InputProperty();      // compiler complains on this line
        metaData[i].Name = "udf:" + key;
        foreach (string value in nvPairs.GetValues(key))
            metaData[i].Val = value;
    }
    update.Items = metaData;
    return update;      // return the Update object
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T18:26:18.860

由于您的 Items 集合的大小可能会有所不同，因此您应该使用集合类型，例如`List<T>`或`Dictionary<K,V>`代替数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:29:24.437

对于当前的编译器错误，需要初始化 metaData 数组，如：

```
InputProperty[] metaData = new InputProperty[](nvPairs.Count); 
```

使用 linq 你可以：

```
private Update BuildMetaData(NameValueCollection nvPairs)
{
    Update update = new Update();
    update.Items = nvPairs.Keys
        .Select(k=> new InputProperty
                    {
                       Name = "udf:" + k,
                       Val = nvPairs[k] // or Values = nvPairs.GetValues(k)
                    }
         )
        .ToArray();
    return update;      // return the Update object
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T18:29:54.670

如果我没记错的话，你的 InputProperty 数组永远不会被初始化。如果将第 2 行更改为：

```
InputProperty[] metaData = new InputProperty[nvPairs.Count]; 
```

那应该解决它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T18:31:42.310

当你声明你的数组 InputProperty[] 元数据时，你没有初始化它。因此，当您尝试访问成员时，它根本不存在，这就是您遇到错误的原因。

As Joel recommended, I'd advise you to look at the collection types provided in System.Collections.Generic for something suitable.

# .net - 使用 FileHelpers 导出 DataTable

> ID：663425
> 
> 赞同：3
> 
> 时间：2009-03-19T18:25:40.250
> 
> 标签：.net, filehelpers

我想使用 FileHelpers 将 DataTable 的内容导出到文本分隔文件，这可能吗？这是我到目前为止所拥有的：

```
// dt is a DataTable with Rows in it
DelimitedClassBuilder cb = new DelimitedClassBuilder("MyClassName", "|", dt);
Type t = cb.CreateRecordClass();
FileHelperEngine engine = new FileHelperEngine(t); 
```

我必须将 dt 的内容转换为“MyClassName”类型的数组，但我不知道该怎么做？我知道有一个 FileDataLink 类，但它们都不能与 DataTable（甚至是 DataSet）一起使用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T19:53:22.537

也许你可以使用这个：

```
CommonEngine.DataTableToCsv(dt, "customers.csv", '|'); 
```

# iphone - 实现类似于标准 iPhone 短信聊天气泡视图的视图

> ID：663435
> 
> 赞同：18
> 
> 时间：2009-03-19T18:28:42.770
> 
> 标签：iphone

有谁知道如何实现这样的视图，任何教程，代码示例，想法。

这种观点的另一个很好的例子是 Tweetie 应用程序，它位于社交网络应用商店应用程序之上。在 appstore 上查看该应用程序的第一个屏幕截图。

我很欣赏这方面的任何想法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-07-23T06:26:14.190

查看[Acani 聊天](https://github.com/acani/Chats)。

[它为 UITextView](http://www.mercuryintermedia.com/blog/index.php/2009/03/iphone-ui-vector-elements)使用相同的背景图像。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T20:16:12.857

这是答案，带有示例代码，直接来自源（Tweetie 的创建者）：[http ://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/](http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/)

来自博客文章：“该技术几乎可以扩展到您需要的任何样式单元格 - 我在 Tweetie 中使用相同的东西，并将聊天气泡、文本和头像一起绘制到一个视图中。” 您可以使用`- (UIImage *)stretchableImageWithLeftCapWidth:(NSInteger)leftCapWidth topCapHeight:(NSInteger)topCapHeight`创建一个可拉伸的聊天气泡来放置在表格视图中的每个单元格后面

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T19:27:46.527

这里有一些想法：

[打造“聊天泡泡”用户体验](https://stackoverflow.com/questions/351602/creating-a-chat-bubble-user-experience)

请务必阅读对答案的评论！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-10T11:05:28.233

搜索[jsqmessagesviewcontroller](http://www.jessesquires.com/JSQMessagesViewController/)，这是一个很好的库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T19:18:45.053

我很确定它们基本上是带有自定义绘制的不同高度的单元格的表格视图。您可以通过在 UITableViewCell 中提供自己的背景和内容视图来做很多事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-26T03:37:12.080

查看[BubbleThingie](https://github.com/tkirby/BubbleThingie/blob/master/README.md)示例代码，了解如何使用蒙版制作图像气泡。它还提供了如何使用 UIButton 或 UILabel 制作文本气泡的示例。

![在此处输入图像描述](https://i.stack.imgur.com/VmHq2.png)

# c# - 使用 NegotiateStream 的套接字身份验证失败

> ID：663440
> 
> 赞同：1
> 
> 时间：2009-03-19T18:29:13.517
> 
> 标签：c#, authentication, sockets

我有一个已连接的 Socket，用于获取 HTTP 标头响应。如果我跳过身份验证，一切正常（除非页面需要身份验证）。但是当我进入这段代码时，它总是在 AuthenticateAsClient 行上抛出一个 IOException 。消息是：“无法从传输连接读取数据：连接已关闭。” 我已经尝试过 DefaultCredentials 和 DefaultNetworkCredentials。

关于我缺少什么的任何想法？是什么导致连接关闭？

谢谢

```
if (Authenticate)
{

    NetworkStream clientStream = new NetworkStream(webSocket, false);
    NegotiateStream authStream = new NegotiateStream(clientStream);

    NetworkCredential netcred = CredentialCache.DefaultNetworkCredentials;

    try
    {
        authStream.AuthenticateAsClient(netcred,
            String.Empty,
            ProtectionLevel.None,
            TokenImpersonationLevel.Identification);

        if (!authStream.IsAuthenticated)
        {
            Console.WriteLine("Authentication failed");
            ErrorText = "Authentication using default credentials failed";
            return (HttpStatusCode)(-1);
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
        ErrorText = ex.Message;
        return (HttpStatusCode)(-1);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T18:37:09.067

[`NegotiateStream`](http://msdn.microsoft.com/en-us/library/system.net.security.negotiatestream.aspx)不执行 HTTP 身份验证：

> 在 Windows 95/98 系统上，Windows NT LAN Manager (NTLM) 是用于身份验证的协议。在其他平台上，如果客户端和服务器都支持，则使用 Kerberos 协议进行身份验证；否则使用 NTLM。

查看提供[Credentials](http://msdn.microsoft.com/en-us/library/system.net.webclient.credentials.aspx)和[ResponseHeaders](http://msdn.microsoft.com/en-us/library/system.net.webclient.responseheaders.aspx)属性的[WebClient类。](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)

# php - 未保留 PHP 会话变量

> ID：663442
> 
> 赞同：7
> 
> 时间：2009-03-19T18:29:28.960
> 
> 标签：php, session, session-variables

除了设置它们的页面之外，我无法在页面上使用会话变量，IOW 它们就像非会话变量一样。我在六个其他类似的论坛上发现了一个类似的问题，但在其他情况下的答案总是不适用。

这是我的文件：

*sess1.php*

```
<?php
session_start();

session_register("userid");
session_register("textvar");

$_SESSION['userid'] = 10333 ;
$_SESSION['textvar'] = TextVariable ;

echo "<p>User ID is: " . $_SESSION['userid'] . "</p>" ;
echo "<p>Another variable is: " . $_SESSION['textvar'] . "</p>" ;
?>
<p>Go to the <a href="sess2.php">next page</a>.</p> 
```

并且， *sess2.php*

```
<?php
session_start();

echo "<p>The userid session variable is: " . $_SESSION['userid'] . "</p>";
echo "<p>The other session variable is: " . $_SESSION['newvar']. "</p> ";
?> 
```

每种情况下的浏览器输出为：

*sess1.php*

> 用户 ID 为：10333
> 
> 另一个变量是：TextVariable
> 
> 转到[下一页]。

并且， *sess2.php*

> userid 会话变量是：
> 
> 另一个会话变量是：
> 
> 转到[最后一页]。

有几件事不是：

*   我确实在两个文件的顶部都有 session_start() 。
*   变量目录是可写的，会话变量显示在那里。（我有大约一百个名为 sess_b62 的小文件，里面有这个：'userid|i:10333;textvar|s:12:"TextVariable";'。）
*   phpinfo() 告诉我 php.ini 文件被正确读取，并且生命周期设置为默认值 0，即直到浏览器关闭。

我无计可施。有什么建议么？

非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T18:33:10.280

`session_register()`不是必需的，可能会在此处引起问题。阅读文档`session_register()`- 它旨在使用现有变量分配会话变量。

从[这里开始](http://p2p.wrox.com/pro-php/1918-why-session_register-bad.html)：

> 好吧， session_register() 告诉 PHP 某个全局变量应该被视为会话变量。这意味着在脚本执行结束时（通常发生会话数据写入时），该全局变量的结果值将使用当前启用的会话处理程序写入。

我认为这是您遇到的问题。在脚本执行结束时，会话变量被覆盖。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-27T07:31:49.360

我面临着同样的问题。原因是，在**php.ini**中，我将 `session.cookie_secure`参数的值设置为`1`. 但是我使用的是 http 协议而不是 http *s*协议；使用 https 协议解决了这个问题。

设置`session.cookie_secure = 1`表明 cookie 只能通过安全连接发送。因此，在使用 http 时，我在每个新页面上都获得了新的 session_id。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T18:38:10.953

我看到的一个错误是在您正在设置的第一个文件`$_SESSION['textvar']`和您正在调用的第二个文件中`$_SESSION['newvar']`。

此外，我在我知道正在运行的服务器上测试了您的代码，并且除了上述错误之外它运行良好。

我也尝试删除`session_register()`，代码仍然可以正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T18:38:49.330

必须以某种方式携带会话 ID，以便可以在多个页面上使用相同的会话。通常这是通过 cookie 完成的（参见[`session.use_cookies`](http://docs.php.net/manual/en/session.configuration.php#ini.session.use-cookies)），但也可以在 URL 或表单中完成（参见[`session.use_trans_sid`](http://docs.php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)）。

因此，首先您必须确保传输会话 ID，以便 PHP 可以加载正确的会话和会话数据。

另请参阅[我对 PHP 会话的理解是否正确？](https://stackoverflow.com/questions/523703/is-my-understanding-of-php-sessions-correct)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T18:39:26.473

*“session_register() 接受可变数量的参数，其中任何一个都可以是包含变量名称的字符串**或**由变量名称或其他数组组成的数组。对于每个名称， session_register() 使用该名称注册全局变量在当前会话中。”*

因为您没有具有这些名称的变量，所以结果将不可预测。

只需使用`$_SESSION[$key] = $value;`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T19:18:29.093

如果以上所有方法都不能解决问题，我会问一个显而易见的问题：在开始的 php 标记之前不会有任何空格或换行符？

您还可以检查服务器错误日志文件中的消息，它应该告诉您是否定义了变量（尽管我猜这也取决于错误报告的级别）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T18:36:15.513

使用某种工具并检查 http 标头，以便查看 cookie 是如何发送的。也许您的网络服务器配置错误，并使用无效的不同域发送 cookie。

您可能希望查看对每个请求执行 session_set_cookie_params() 并确保设置了正确的域、路径等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-09T22:35:33.237

另一个明显的检查：

确保您的磁盘空间未满；这将阻止会话数据被保存。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-20T21:58:24.330

知道这是一篇较旧的帖子，但我遇到了类似的问题（不使用 session_register()）。

必须将会话转换为 cookie，因为会话超时太频繁，并且由于服务器设置（“特殊”Windows 服务器托管环境（使用 Apache）），无法更改 PHP 会话超时值。

最终结果是/现在转换为延长寿命的 Cookie 后，Cookie 数据仍然丢失（在传输中）？有时。

非常令人沮丧。

我从来没有在 LAMP 环境中发生过这种情况，所以可能要问的问题是您是否使用的是 LAMP 服务器。

希望这可以帮助。我认为这不是 PHP 问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-13T17:49:15.107

检查您的 PHP 服务器的服务器日志，例如，nginx 或 apache。

您可以在 nginx error.log 中找到为什么会话不起作用的信息。该文件的路径通常是：`/var/log/nginx/error.log`.

就我而言，它是说无法保存会话数据。事实证明，在同一目录中，旧`error.log.1`文件的大小为 17 GB，并占用了所有可用磁盘空间。

Simply freeing disk space restored normal behavior of sessions.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-19T18:38:00.110

**在两个**文件中都使用 session_register，它应该可以工作。

# c++ - OLE 入门 - 什么是好的学习项目选择？

> ID：663447
> 
> 赞同：0
> 
> 时间：2009-03-19T18:30:28.350
> 
> 标签：c++, windows, visual-c++, ole

我怀疑我很快将需要编写一个“集成”库，该库需要从 Java 调用 Windows 上的 OLE 对象。

我之前已经在 Windows 上完成了 Java 到 C/C++ 的集成（使用 C/C++ 和 JNI）——所以我对等式的这一部分并不陌生。

然而; 我想尝试围绕 OLE 对象编写一个 C/C++ 包装器，以便为项目的该部分提供测试旋转。

所以，一些问题：

1.  我可以用 VS C++ Express Edition 做 OLE。我相信答案是，“是的，但是你没有 MFC，所以你不能调用 Microsoft OLE 对象（例如 Excel、Word 等）”

2.  如果我对#1 的假设是正确的，我需要一个“测试”应用程序，它提供一个我可以调用的 OLE 对象——对于一些好的做法有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T19:01:19.133

目前尚不清楚您是指实际的 OLE（具有就地编辑的嵌入/链接文档）还是只是自动化（调用 Office 应用程序的编程模型）。

无论哪种方式，您都可以使用 Visual C++ Express Edition 执行 OLE，只是不会获得 MFC 的（有点可疑的）优势来帮助您执行此操作。您也不会拥有 ATL，它不像 MFC 那样糟糕，但也不是那么好。

OLE 的问题在于，除非您有某种库可以作为您工作的基础，否则您将不得不编写大量样板代码。你需要参考一些[古代文献](https://rads.stackoverflow.com/amzn/click/com/1556158432)。

至于一个测试应用，为什么不用Word、Excel等呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T19:03:52.140

1.  是的，您可以使用 VC++ Express 进行 OLE，我建议安装 Windows Platform SDK。您不需要 MFC 即可使用办公应用程序。使用 VC++ Express 2005，您可以安装旧版本的 Platform SDK 2003 R1，其中包括 ATL，它是 COM 功能的便捷包装器。如果您无法安装它，您可以创建自己的包装，请参阅这篇更高级的文章[COM in Plain C](http://www.codeproject.com/KB/COM/com_in_c1.aspx)。

2.  一个众所周知的提供 COM 对象的应用程序是 Internet Explorer，还有 Windows Media Player，并且可以通过 COM 访问 Flash。

你也可以看看[Jacob](http://danadler.com/jacob/) “The JACOB Project: A JAva-COM Bridge”

您可以认为 COM 是构建 OLE 功能的层。

# c++ - 在正确的时间点将调试器附加到 VC++ 中的进程的最佳方法是什么？

> ID：663449
> 
> 赞同：15
> 
> 时间：2009-03-19T18:31:41.670
> 
> 标签：c++, debugging, visual-c++, debugbreak

调试时，有时您需要附加一个已经在运行的进程，而不是仅仅在调试器中启动应用程序。

我自己通常会调用 Sleep() 或 MessageBox，以便更容易附加调试器。我担心其中一些可能最终会提交到源代码控制。

为了避免这种情况，最好的办法是什么，同时仍然延迟足够的时间，以便您可以将调试器附加到正在运行的进程？

用 an 保护睡眠或消息框`#ifdef _DEBUG`是一种方法，但我想知道是否有更好的方法。

使用睡眠，您还会遇到无法及时连接的问题。使用 MessageBox，您可能会遇到问题，您可能正在远程调试，或者调试没有可见 GUI 的进程（例如在 Vista 上作为服务运行）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2016-01-26T15:51:07.020

我有时使用的另一个变体是

```
while( !::IsDebuggerPresent() )
    ::Sleep( 100 ); // to avoid 100% CPU load 
```

它应该静静地等待，直到您将调试器附加到进程。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-19T18:43:04.560

您可以使用 DebugBreak，检查以下链接：

[http://www.epsilon-delta.net/articles/vc6_debug.html#break-with-debugbreak](http://www.epsilon-delta.net/articles/vc6_debug.html#breaking-with-debugbreak)

[http://blogs.msdn.com/calvin_hsia/archive/2006/08/25/724572.aspx](http://blogs.msdn.com/calvin_hsia/archive/2006/08/25/724572.aspx)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-19T18:54:53.720

要在特定点附加调试器，您有几个选项：

最简单的就是调用`DebugBreak`，它几乎等同于`__asm int 3`，但也适用于其他架构（如果我没记错的话，x64 的 MSVC 不允许内联汇编）。这将打开即时调试器窗口，您将能够从已注册的调试器（即 Visual Studio）中进行选择以附加到进程。

或者，您可以引入对 的调用`Sleep`，让您有机会附加调试器。您应该使用`#ifdef _DEBUG`它，以确保您实际上并未包含此代码。

一个问题：为什么不能从 IDE 运行代码？它是服务还是加载 IIS 的 DLL 或类似的？

在这种情况下，您可以查看`ImageFileExecutionOptions`注册表项，它允许您在进程启动时附加调试器。

如果为此使用 cdb，则可以将其配置为 WinDbg 实例的服务器或客户端，并以这种方式进行调试。过去我通过使用 WinDbg 作为内核调试器并使用 ImageFileExecutionOptions 从`ntsd -d`命名进程开始来完成此操作。这会导致 WinDbg 进入用户模式。这有时是一种有用的技术。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-19T18:52:57.003

Freddy 和 Reoa 有正确的解决方案。但我想添加一个不使用 MessageBox 的原因。

显示 MessageBox 只会部分停止您的应用程序。因为您正在显示 UI，所以消息泵仍在程序中的至少一个线程上运行。因此，如果您的代码执行以下任何操作。

1.  通过 Windows 消息进行通信
2.  有非平凡的用户界面
3.  是多线程的

您实际上将在一种状态下请求调试器，但以完全不同的状态附加到您的程序。这可能会导致令人困惑的情况和错误。

我们最近对我们的代码库进行了更改，不再显示 MessageBox 以方便中断，正是出于这个原因。对于非平凡的应用程序，它会产生非常糟糕的行为。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T18:44:43.217

必须在“恰到好处”处附加是一种痛苦……一种选择是将显式 DebugBreak() 语句添加到代码中以强制解决问题，并用它们来保护它们`#ifdef _DEBUG`是个好主意。我们使用一个可以调用 DebugBreak() 的 ASSERT 宏，所以你可以只写 ASSERT(false)

另一个需要考虑的选项是使用“图像文件执行选项”来自动启动调试器。请参阅此[博客](http://weblogs.asp.net/whaggard/archive/2007/02/08/image-file-execution-options.aspx)和[MSDN](http://msdn.microsoft.com/en-us/library/a329t4ed(VS.71).aspx)文档。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T18:43:21.097

抬头：

DebugBreak ， __debugbreak 和朋友们

或者

静态无效 timeToChase() { __asm { int 3; }; }

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-19T18:44:55.523

```
__asm int 3 
```

这个硬断点将打开调试对话框，让您附加到进程。将其包装在 #ifdef _DEBUG 中，您只会在调试版本中使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-09T19:17:48.343

如果 __debugbreak() 或 DebugBreak() 对你有用，那么我认为这可能是最好的方法。

但是，我遇到了一些情况，由于未知原因，__debugbreak() 只是立即终止程序，而不是等待调试器连接。我尝试了各种方法来解决这个问题（注册表黑客等），但似乎没有任何效果。（在这种情况下，我尝试调试的进程不是直接从命令行启动，而是由 Java 程序启动，这可能是相关的。）

无论如何，在那种情况下，我使用了这种方法，似乎效果很好：

```
void waitForDebuggerToConnect() {
    #ifdef _DEBUG
    static volatile bool spin = true;
    while (spin)
    {}
    #endif
} 
```

调用此函数后，我的程序将无限期地挂在“while”循环中。然后我可以调用 VC++ 调试器并附加到该进程。然后我可以使用“全部中断”来停止所有线程。然后我可以找到卡住的线程的调用堆栈，并可以使用调试器检查顶部帧，并可以检查'spin'的值，然后将其设置为'false'。此时，我可以退出该函数和/或设置断点，然后恢复部分或所有线程运行。

# asp.net - 使用 IIs6 或 IIs7 的命令行更改 IIS 中虚拟目录或站点的物理路径

> ID：663453
> 
> 赞同：9
> 
> 时间：2009-03-19T18:32:02.717
> 
> 标签：asp.net, iis, deployment, scripting, appcmd

我需要为我支持的应用程序部署一些版本控制，我可以将站点复制到 c:\inetpub\wwwroot\app_v2，然后从 c:\inetpub\wwwroot\app_v1 切换虚拟目录。

有没有办法从命令行更改 IIS 中虚拟目录的物理路径？

编辑：

我发现在 IIS7 中，您可以使用 appcmd 在此页面上使用此格式设置虚拟目录[的物理路径 Change the Physical Path of Virtual Directory Content](http://technet.microsoft.com/en-us/library/cc754640.aspx)。我一直在寻找更普遍的东西......

appcmd 设置 vdir /vdir.name:string /physicalPath:string

但是，似乎没有 IIS 6 的等价物。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T18:45:47.987

是的，看看 WMI 脚本。

[http://learn.iis.net/page.aspx/163/managing-applications-and-application-pools-on-iis-7-with-wmi/](http://learn.iis.net/page.aspx/163/managing-applications-and-application-pools-on-iis-7-with-wmi/)

[http://www.aspfree.com/c/a/IIS/IIS-60-Getting-Information-Using-WMI/3/](http://www.aspfree.com/c/a/IIS/IIS-60-Getting-Information-Using-WMI/3/)

缺口

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T20:39:44.483

我今天也有同样的问题：“如何使用命令行更改 IIS6 vdir 的路径？”

WMI 脚本是要走的路，所以我想我会发布为此创建的 vb。

要使用它，只需传递 vdir 名称和路径。因此，如果我有一个名为“Web”的 vdir 并想将路径更改为“d:\theNewPath\to\Website”，那么我将在命令提示符下运行以下命令：

```
updateVDirPath web d:\theNewPath\to\Website 
```

此外，要检查 Vdir 的路径，只需传递 vdir 名称：

```
updateVDirPath web 
```

这里是updateVDirPath.vbs的内容

```
If WScript.Arguments.Count = 0 or WScript.Arguments.Count > 2  Then
    WScript.Echo "To check the vDirs path, call updateVDirPath <vDir>" & vbCrLf & "To update the vDir's path, call updateVDirPath <vDir> <newPath>"
Else
    set providerObj = GetObject("winmgmts://localhost/root/MicrosoftIISv2") 
    set IIsWebVirtualDirSettingObj = providerObj.get("IIsWebVirtualDirSetting='W3SVC/1/ROOT/" & WScript.Arguments(0) & "'") 

    If WScript.Arguments.Count = 1 Then
        WScript.Echo "Current path is: " & IIsWebVirtualDirSettingObj.Path
    Else
        IIsWebVirtualDirSettingObj.Path = WScript.Arguments(1)
        IIsWebVirtualDirSettingObj.Put_ () 
    End If
End If 
```

# active-directory - 如何找出登录脚本所在的位置？

> ID：663459
> 
> 赞同：15
> 
> 时间：2009-03-19T18:33:46.953
> 
> 标签：active-directory

我正在寻找一种方法（手动或程序）来找出用户的活动目录登录脚本所在的位置。

我可以解析“net user”的结果以获取脚本名称，但这并不能告诉我脚本所在的文件共享。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-20T02:07:32.370

此外，从命令提示符运行 SET。

这显示了“LOGONSERVER”值，该值指示您正在使用的特定域控制器（可以有多个）。

然后您进入该服务器的 NetBios Share \Servername\SYSVOL\domain.local\scripts。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T19:16:17.960

登录脚本的默认位置是域控制器的 netlogon 共享。在服务器上，它位于：

%SystemRoot%'SYSVOL'sysvol''脚本

它可能是这个默认值的变化，但我从来没有遇到过有理由这样做的人。

要以编程方式获取域控制器列表，请参阅本文： http: [//www.microsoft.com/technet/scriptcenter/resources/qanda/dec04/hey1216.mspx](http://www.microsoft.com/technet/scriptcenter/resources/qanda/dec04/hey1216.mspx)

# fogbugz - 使用 FogBugz API 获取票证列表

> ID：663462
> 
> 赞同：8
> 
> 时间：2009-03-19T18:35:13.207
> 
> 标签：fogbugz

我有一个 .NET Web 应用程序，它利用 FogBugz API 将问题票证写入我们的 FB 服务器...它使用*新*命令和...在所有其他属性中...使用*sCustomerEmail*参数发送用户的电子邮箱用票邮寄。

我的问题是：有没有一种方法可以获得分配给此电子邮件的所有票证的列表（当然是通过 API）？我们想要写另一个页面，报告当前分配给此电子邮件的票证。我们不想为每个用户创建 FB 帐户。

我可能会在 API 文档中看到提示，但没有具体内容。

感谢您的任何建议

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T13:50:51.963

是的，您需要向 API 发送自定义搜索，将电子邮件地址作为通讯轴传递。

因此，一旦您获得了登录令牌：

```
https://example.fogbugz.com/api.asp?cmd=logon&email=jdoe@example.com&password=SecretPwd 
```

然后，您可以进行搜索：

```
https://example.fogbugz.com/api.asp?cmd=search&q=correspondent:customer@client.com&cols=ixBug,correspondent,sTicket,sTitle,dtOpened&token=cc83o7ri9c49t4vfvm3bn252ljvp23 
```

在这里，我将“q”参数传递给搜索命令以将搜索轴设置为“correspondent:customer@client.com”。

我还指定了一些我想要返回的列，例如案例编号（ixBug）、通讯员的电子邮件地址（我喜欢验证这样的事情）、客户作为响应获得的票证 ID（sTicket，我是'不确定这是您想要的还是案例编号）、标题 (sTitle) 和案例打开的日期 (dtOpened)。

从技术上讲，您不需要请求 ixBug 列，因为它始终可以作为 xml 中返回的每个 case 元素的属性使用，但有时将这些东西作为元素更容易。

您可以使用许多不同的搜索轴，并且可以返回许多列。

查看[API 参考底部的](http://www.fogcreek.com/FogBugz/docs/60/topics/advanced/API.html)[搜索参考](http://www.fogcreek.com/FogBugz/docs/60/topics/basics/Searchingforcases.html)和示例 xml 有效负载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T18:38:38.707

直接向 FB 支持人员或在他们的论坛上询问这个问题可能会更好......

# asp.net - 当只有一件事发生变化时，为什么 ASP.NET 会重新编译（重新 JIT）所有 内容？

> ID：663466
> 
> 赞同：4
> 
> 时间：2009-03-19T18:35:53.220
> 
> 标签：asp.net, performance, jit

我有一个 ASP.NET 2.0 应用程序（从 MSI 安装在 IIS 6.0 上），它被编译为“网站”，并在 Visual Studio 2005 中使用 Web 部署项目进行预编译/打包。（我已提出请求开发人员考虑更改为下一个版本的 Web 应用程序，但不会更改此版本）。

每当应用程序被回收（例如，对 web.config 进行更改）时，第一次命中时，ASP.NET JITs 应用程序。作为其中的一部分，它获取登录页面所需的所有程序集，并将它们编译为 Temporary ASP.NET Files 'assembly\dl3' 目录中的本机代码，这需要 20 到 60 秒。这只发生在回收站上，这种情况很少发生——但是当它发生时，它会导致页面加载时间更长，我相信有可能对此进行优化。

似乎有 122 个 DLL 需要考虑，其中一些是预编译的代码隐藏，其他是网站的第三方组件（例如 NHibernate.dll、报告组件等）

为什么它要重新编译/重新 JIT*一切*？为什么它没有检测到大多数程序集没有更改，并且没有尝试更改它们？我可以证明导致问题的不是批处理编译吗？（我`<compilation debug="false"`在 web.config 中设置了 >。）

[其他问题](https://stackoverflow.com/questions/446211/can-i-avoid-jit-in-net)表明 NGEN 可能有用，但我读到无法在 ASP.NET 1.x 上使用它；我们使用的是 2.0，无论哪种方式我都找不到一个干净的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T18:40:20.543

你在运行 IIS 吗？我相当肯定，如果您在 IIS 中重新启动您的站点，它会在不复制 dll 的情况下获取对配置的任何更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T19:11:12.540

您可以通过将不经常更改的常见 DLL（例如 NHibernate 或报告工具）安装到 GAC 中来缩短回收时间。这应该可以防止他们被重新调整。

[如何：将程序集安装到全局程序集缓存中](http://msdn.microsoft.com/en-us/library/dkkx7f79.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T17:32:52.463

从我个人的经验来看，如果你有很多实体，缓慢的回收通常是由 NHibernate/ActiveRecord 引起的。有关解释 + 可能的解决方案，请参阅[http://nhibernate.info/blog/2009/03/13/an-improvement-on-sessionfactory-initialization.html 。](http://nhibernate.info/blog/2009/03/13/an-improvement-on-sessionfactory-initialization.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T23:12:14.943

奇怪的是只复制dll需要20秒。我建议再做一次检查并确定瓶颈在哪里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T20:55:05.910

如果不回收/重置（或发生任何事情）AppDomain，您如何确定一切都处于正确状态？想象您在应用程序启动（global.asax）中有一些东西，它根据配置值设置静态字段的值。除非您重置整个 AppDomain，否则您无法确定。

另一个原因：一旦加载.NET dll，就无法卸载它，因此您必须在更新某些内容时重新创建应用程序域。

# hash - 您将用哈希表示的事物的真实示例是什么？

> ID：663468
> 
> 赞同：3
> 
> 时间：2009-03-19T18:36:38.103
> 
> 标签：hash, string

我只是想了解何时需要使用哈希以及何时使用数组可能更好。例如，在字符串的情况下，散列代表什么样的现实世界对象？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-19T18:39:49.937

我相信有时哈希被称为“字典”，我认为这本身就是一个很好的例子。如果您想查找单词的定义，最好执行以下操作：

```
definition['pernicious'] 
```

而不是试图找出存储定义的正确数字索引。

*这个答案假设通过“散列”你基本上只是指一个关联数组。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T18:40:24.100

我认为你看错了方向。决定是否应该使用散列的不是对象，而是访问它的方式。哈希的常见用途是使用查找表时。如果您的对象是字符串，并且您想检查它们是否存在于 a 中`Dictionary`，那么通过 O(1) 查找它们（假设哈希工作正常）。通过排序，时间将改为 O(logn)，这可能是不可接受的。

因此，散列非常适合与字典（散列映射）、集合（[散列](http://www.sgi.com/tech/stl/hash_set.html)集）等一起使用。

它们也是表示对象而不存储对象本身（用于密码）的有用方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T18:41:45.470

电话簿 - 键 = 名称，值 = 电话号码。

我还想到了旧的世界图书百科全书（实际书籍）。每篇文章都被“散列”成一本书（猫在“C”卷中）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T18:41:38.247

任何时候您的数据都可以通过 1 对 1 映射得到很好的服务。

例如，一个班级的成绩：

“约翰·史密斯”=>“B+”

“雅各布詹肯斯”=>“C”

ETC

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T18:44:13.980

一般来说，哈希用于快速查找事物 - 哈希映射可用于将一个事物与另一个事物快速关联，哈希集只会“快速”存储事物。

在考虑使用散列容器还是普通的小于容器更好时，还请考虑散列函数的复杂性和成本 - 散列值的额外大小和计算“完美”散列所需的时间，以及所需的时间在哈希函数冲突的情况下最后进行 1:1 比较实际上可能比使用 less then 运算符通过具有对数复杂度的树结构要高得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T18:39:08.500

当您需要将一个变量与另一个相关联时。哈希中的键/值没有“类型限制”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T18:41:56.187

哈希有很多用途。除了加密用途外，它们通常用于快速查找信息。要使用数组获得类似的快速查找，您需要保持数组排序，然后使用二进制搜索。使用哈希，您无需排序即可快速查找。这就是大多数脚本语言以一个名称或另一个名称（字典等）实现散列的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-19T18:58:57.080

我经常将一个用于我的应用程序设置的“字典”。

设置 | 价值

我将它们从数据库或配置文件加载到哈希表中以供我的应用程序使用。

效果很好，而且很简单。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-19T19:11:43.807

一个示例可以是与地区、城市或任何邮政地址相关联的邮政编码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-19T19:25:48.063

一个很好的例子是一个包含很多元素的缓存。你有一些标识符，你想通过它来查找 a 值（比如一个 URL，你想找到相应的缓存网页）。您希望这些查找尽可能快，并且不希望每次请求某个 URL 时都搜索所有存储的页面。对于此类问题，哈希表是一种很好的数据结构。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-19T19:36:13.763

我刚刚写的一个真实世界的例子是，当我在提交费用报告时将人们在膳食上的花费加起来。

我需要获取每日总计，但不知道某一天会存在多少项目，也不知道费用报告的日期范围是什么。一个人可以通过许多变量（哪个城市、周末等）花费多少是有限制的，

哈希表是处理这个问题的完美工具。关键是值是收据金额（转换为美元）的日期。收据可以按任何顺序出现，我只是不断获取该日期的值并添加到它，直到工作完成。显示也很容易。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-19T19:44:52.820

（PHP代码）

```
$david        = new stdclass();
$david->name  = "david";
$david->age   = 12;
$david->id    = 1;
$david->title = "manager";

$joe        = new stdclass();
$joe->name  = "joe";
$joe->age   = 17;
$joe->id    = 2;
$joe->title = "employee";

// option 1: lets put users by index
$users[] = $david;
$users[] = $joe;

// option 2: lets put users by title
$users[$david->title] = $david;
$users[$joe->title]   = $joe; 
```

现在的问题是：谁是经理？回答：

```
$users["manager"] 
```

# ruby - Ruby 的 Time 类可以表示的时间范围是多少？

> ID：663471
> 
> 赞同：2
> 
> 时间：2009-03-19T18:37:27.053
> 
> 标签：ruby, datetime, time

可以代表的过去最远和未来最远的时代？

是时间上的绝对瞬间，还是与现在的时间上的距离？

[我在 Time 类](http://www.noobkit.com/show/ruby/ruby/ruby-core/time.html)的文档中找不到它。

它取决于系统吗？如果是这样，我如何在我的代码中访问它？

更新

经过一番实验，我发现是从过去108年左右到未来29年左右。仍然想知道它是否依赖于系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:29:05.417

“时间在内部存储为自纪元 1970 年 1 月 1 日 00:00 UTC 以来的秒数和微秒数。在某些操作系统上，此偏移量允许为负数。”

很明显，这是一个与现在无关的绝对时间

听起来好像有一个“C”时间实现在掩护下（整数可以有符号或无符号，具体取决于操作系统/处理器/编译器）：这意味着边界取决于系统。

但是，如果您需要处理很久以前/很久以后的日期，我想您将不需要“一天中的时间”部分并且可以使用 Date ！？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T19:53:57.073

DateTime（在日期库中，包含在 ruby​​ 中）可以追溯到公元前 4713 年 1 月 1 日，并且比您可能需要的更远。

# .net - Flex RemoteObject .Net 会话混淆

> ID：663477
> 
> 赞同：0
> 
> 时间：2009-03-19T18:38:32.403
> 
> 标签：.net, apache-flex, session, weborb, remoteobject

好吧，这个真的很奇怪。我使用 .net 作为后端，使用 Flex 作为前端。我还使用 WebOrb.Net 来管理我的 RemoteObject 调用。

当用户第一次打开我的 Flex 应用程序时，我会回调 .Net 并将一些设置保存在会话变量中，以便所有后续对 .Net 的请求都可以将这些值拉出会话，因此我没有每次都通过它们。现在在.Net 端，我有一个模型，我将这些值存储在其中，然后我让模型将自身保存到会话中。因此，任何 .Net 类都可以在需要时获取对模型的静态引用，并且该引用将从会话中加载值。

如果我只有一个用户使用该应用程序，一切都会很好！如果我有两个用户同时使用该应用程序，我们就会开始遇到问题。用户 A 将开始获取用户 B 的设置。这怎么可能。我认为会话应该是用户独有的。

如果有人可以在这方面提供一些帮助，那就太棒了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T22:15:19.777

您的问题可能在于您处理静态对象的方式。因为它是静态的，所以只有一个静态对象在所有会话之间共享。设置变量时，您可能会无意中在每个会话中覆盖其值。您能否发布一些代码，我们可以进一步分析您如何设置变量？

# c# - 监控代码触发事件的软件

> ID：663489
> 
> 赞同：2
> 
> 时间：2009-03-19T18:40:32.803
> 
> 标签：c#, events, monitoring, deadlock

我在我认为与鼠标单击事件有关的代码块中遇到问题，但我似乎无法在我的代码中捕获确切的事件。我已经使用 C# 调试器单步执行我的代码，并且在我的一个事件结束后，代码只是锁定了。

我的帖子的目的是询问是否有任何软件可以监视我的过程并让我知道在我按下 F11 键并且代码冻结后触发的事件。我试过 SysInternals'`procmon.exe`但这并没有告诉我哪些事件正在触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T03:08:06.907

你试过间谍++吗？它是 Visual Studio 附带的工具（至少 2003 和 2005 年）。在我的默认 2003 和 2005 安装中，Spy++ 位于：开始 | 程序文件 | 微软Visual Studio 200X | Visual Studio 工具 | 间谍++

运行 Spy++ 后，从“搜索”菜单中选择“查找窗口...”。将“Finder Tool”拖到您要观看事件的窗口或控件上，然后单击“确定”。右键单击树中选定的项目，然后选择“消息”。这将打开一个窗口，在消息到达您感兴趣的窗口时显示消息。

如果 Spy++ 没有得到你需要的东西，那么[Managed Spy](http://msdn.microsoft.com/en-us/magazine/cc163617.aspx)呢？它看起来像 Spy++，但专门用于托管代码。我没试过。

> [它] 在基于 .NET 的客户端应用程序中显示控件的树状视图。您可以选择任何控件并获取或设置其上的任何属性。您还可以记录控件引发的一组过滤事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T18:43:42.423

你在使用多线程吗？如果是这样，请尽量避免将控件和其他 Windows 窗体对象传递到窗体线程之外，因为调试器将尝试访问对象的值，这将导致调试器冻结一段时间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-19T18:47:37.280

[CLRProfiler](http://www.microsoft.com/downloads/details.aspx?FamilyID=a362781c-3870-43be-8926-862b40aa0cd0&DisplayLang=en)可能会做你想做的事。

工具概述状态

> CLR Profiler 包括许多非常有用的分配配置文件视图，包括已分配类型的直方图、分配和调用图、显示各代 GC 的时间线以及这些收集后托管堆的结果状态，以及一个调用显示每个方法分配和程序集负载的树。

内存使用确实在此描述中出售，但它确实提到了“调用树”，以及[如何使用](http://msdn.microsoft.com/en-us/library/ms979205.aspx)它的链接，提到

> 调用树视图 提供应用程序执行的基于文本的、按时间顺序排列的分层视图。

祝你好运。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-19T18:50:10.847

为什么不使用[log4net 之](http://logging.apache.org/log4net/index.html)类的日志记录工具？

# python - Python：如何登录页面并在浏览器中查看生成的页面？

> ID：663490
> 
> 赞同：3
> 
> 时间：2009-03-19T18:40:44.630
> 
> 标签：python, login

我已经在谷歌上搜索了很长一段时间，但似乎无法让它发挥作用。我的很多搜索都指出我发现了类似的问题，但它们似乎都与 cookie 抓取/存储有关。我想我已经正确设置了，但是当我尝试打开“隐藏”页面时，它一直让我回到登录页面，说我的会话已过期。

```
import urllib, urllib2, cookielib, webbrowser

username = 'userhere'
password = 'passwordhere'
url = 'http://example.com'
webbrowser.open(url, new=1, autoraise=1)
cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
login_data = urllib.urlencode({'username' : username, 'j_password' : password})
opener.open('http://example.com', login_data)
resp = opener.open('http://example.com/afterlogin')
print resp
webbrowser.open(url, new=1, autoraise=1) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T21:21:16.147

首先，在进行基于 cookie 的身份验证时，您需要有一个[`CookieJar`](http://docs.python.org/library/cookielib.html#cookielib.CookieJar)cookie 来存储您的 cookie，就像您的浏览器将其 cookie 存储在一个可以再次找到它们的地方一样。

通过python打开登录页面并保存成功登录的cookie后，您应该使用将[`MozillaCookieJar`](http://docs.python.org/library/cookielib.html#cookielib.MozillaCookieJar)python创建的cookie传递给firefox浏览器可以解析的格式。Firefox 3.x 不再使用 MozillaCookieJar 生成的 cookie 格式，而且我还没有找到可行的替代方案。

如果您需要做的只是检索特定（预先知道的格式化格式）数据，那么我建议您将所有 HTTP 交互保留在 python 中。这要容易得多，而且您不必依赖可用的特定浏览器。如果绝对有必要在浏览器中显示内容，您可以通过 urllib2（顺便与 cookielib 很好地集成）呈现所谓的“隐藏”页面，将 html 保存到临时文件并将其传递给[`webbrowser.open`](http://docs.python.org/library/webbrowser.html?highlight=webbrowser#webbrowser.open)which will then呈现该特定页面。无法进行进一步的重定向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T21:41:43.397

我通常使用[mechanize 库](http://wwwsearch.sourceforge.net/mechanize/)来处理这样的事情。这并不能回答您关于为什么现有代码无法正常工作的问题，但这是可以使用的其他东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T04:02:01.827

提供的代码调用：

```
opener.open('http://example.com', login_data) 
```

但会丢弃响应。我会查看此回复，看看它是否显示“密码错误”或“我只接受 IE”或类似内容。

# sql - SQL替换智能引号

> ID：663492
> 
> 赞同：6
> 
> 时间：2009-03-19T18:41:01.103
> 
> 标签：sql, oracle, smart-quotes

有谁知道用他们的 ASCII 表亲替换 MS Office 智能引号的 SQL 命令？我正在使用 oracle 数据库，字段类型为 varchar2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T18:50:40.970

更新表集列=替换（替换（列，chr（147），'“'），chr（148），'”'）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T18:46:12.383

```
REPLACE(REPLACE(str, '`', ''''), '´', '''') 
```

还是我错过了你的问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-13T09:56:02.703

我有一个类似的问题。对我来说，在将引号存储在数据库中之后，它们就出现了“Â'”。

```
SELECT abstract FROM foo WHERE version = '1.0' and newscode = 'au20309'; 
```

MaeÂ'r ffordd gynaliadwy y mae bwyd yn cael ei dyfu, ei brynu aÂ'i baratoi ...

这就是我更换它们的方式。首先找到那个不寻常的“Â”字符的 ascii 值。

```
SELECT ascii('Â') FROM DUAL; -- returns 50050 
```

然后使用 chr 函数来渲染“Â”。|| 函数连接两个字符。q 函数对于“引用”智能引号字符串很有用。

```
SELECT REPLACE(abstract,chr(50050) || q'#’#' , q'#'#') 
FROM foo 
WHERE version = '1.0' and newscode = 'au20309'; 
```

Mae'r ffordd gynaliadwy y mae bwyd yn cael ei dyfu, ei brynu a'i baratoi ...

这对我来说在我们的 Oracle 10 系统上工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T03:47:36.390

TRANSLATE 比 REPLACE 更合适。

```
TRANSLATE(str, '`´', '''''') 
```

[http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/functions204.htm#sthref2477](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/functions204.htm#sthref2477)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-19T18:46:21.057

```
update table set column = replace( column, string_to_replace, [ replacement_string ] ) 
```

# java - 在Java中，为什么我不能在父类中声明一个最终成员（没有初始化它）并在子类中设置它的值？我该如何解决？

> ID：663512
> 
> 赞同：12
> 
> 时间：2009-03-19T18:45:35.757
> 
> 标签：java, final

在 Java 程序中，我有多个子类继承自父类（这是抽象的）。我想表达每个孩子都应该有一个只设置一次的成员（我打算从构造函数中这样做）。我的计划是编写某事。像这样：

```
public abstract class Parent {
    protected final String birthmark;
}

public class Child extends Parent {
    public Child(String s) {
        this.birthmark = s;
    }
} 
```

然而，这似乎并不能取悦 Java 之神。在父类中，我收到`birthmark`“可能尚未初始化”的消息，在子类中，我收到“`birthmark`无法访问最终字段”。

那么，Java 的方式是什么？我错过了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-19T18:48:42.923

你不能这样做，因为在比较父类时，编译器不能确定子类会初始化它。您必须在父级的构造函数中对其进行初始化，并让子级调用父级的构造函数：

```
public abstract class Parent {
    protected final String birthmark;
    protected Parent(String s) {
        birthmark = s;
    }
}

public class Child extends Parent {
    public Child(String s) {
        super(s);
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T18:48:31.647

将其传递给父构造函数：

```
public abstract class Parent {
    private final String birthmark;
    public Parent(String s) {
        birthmark = s;
    }
}

public class Child extends Parent {
    public Child(String s) {
        super(s);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T18:49:24.420

另一种 Java 风格的方法可能是让父类定义一个抽象的“getter”，并让子类实现它。在这种情况下，这不是一个好方法，但在某些情况下，它可能正是您想要的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T18:53:15.550

我会这样做：

```
public abstract class Parent 
{
    protected final String birthmark;

    protected Parent(final String mark)
    {
        // only if this makes sense.
        if(mark == null)
        {
            throw new IllegalArgumentException("mark cannot be null");
        }

        birthmark = mark;
    }
}

public class Child 
    extends Parent 
{
    public Child(final String s) 
    {
        super(s);
    }
} 
```

final 意味着变量可以在每个实例中初始化一次。编译器无法确保每个子类都会提供对胎记的赋值，因此它会强制赋值发生在父类的构造函数中。

我添加了对 null 的检查只是为了表明您还可以获得能够在一个地方而不是每个 cosntructor 中检查参数的好处。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T18:50:19.940

为什么不将初始化委托给方法。然后重写父类中的方法。

```
public class Parent {
   public final Object x = getValueOfX();
   public Object getValueOfX() {
      return y;
   }
}
public class Child {
  @Override
  public Object getValueOfX() {
     // whatever ...
  }
} 
```

这应该允许自定义初始化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T18:49:28.553

是的，最终成员将在声明它们的类中分配。您需要向 Parent 添加一个带有 String 参数的构造函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T18:49:56.930

在子类调用的超类中声明一个构造函数。您必须在超类中设置字段以确保它已初始化，否则编译器无法确定该字段已初始化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-19T18:50:01.377

您可能希望有一个 Parent(Stringbirthmark) 构造函数，以便您可以确保在您的 Parent 类中始终初始化 final。然后你可以从你的 Child() 构造函数中调用 super(birthmark) 。

# language-agnostic - 让您的用户更改他们的用户名是个好主意吗？

> ID：663520
> 
> 赞同：24
> 
> 时间：2009-03-19T18:48:06.483
> 
> 标签：language-agnostic, userinfo

我反复考虑让我网站上的用户更改他们的用户名，这将在整个网站上显示。一方面，我想给用户灵活性。但另一方面，我不希望他们使用此功能来隐藏他们是否在网站上做了一些不需要的事情。我知道 SO & Twitter 可以让您更改显示名称。是什么阻止某人在网站上表现不佳，然后更改他们的名字以便他们继续表现不佳？

我需要反馈赞成和反对的意见。谢谢！

**更新：** 把事情弄清楚一点。我没有使用用户名作为主要内部帐户 ID。每个用户都有一个唯一的号码。我的问题并不是关于我的系统跟踪用户，而是关于其他用户如何能够相互跟踪。

如果 userA 知道 userB 做错事，然后 userB 将他的名字更改为 userC。那么用户A将不再知道他是谁。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-19T18:51:27.583

“做坏事然后改名”是什么意思？如果您暗示用户可以发布内容，例如，附上他们的名字，然后更改他们的名字并且附在他们帖子上的名字也不会改变，那么我认为您需要重新考虑您的（数据库）架构并确保用户名是单一参考点，并且当有人更改其用户名时，该用户名的所有表示都会更改。

编辑：好的，很抱歉造成误解。但是，如果您只有一个参考点，那么更改您的用户名与问题无关。假设我的用户名是 Foo，我在某处拖钓了一些线程，然后将我的名字更改为 Bar。只要人们可以看到我发布的内容（例如帖子历史页面），那么我是否曾经被称为 Foo 并不重要，Bar 现在与之前发布的帖子相关联，这些帖子都是巨魔材料。因此，也许您只需要通过在用户个人资料上制作诸如发布历史概览之类的东西来创建透明度？:)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-19T18:50:47.833

如果冒充某人或“作弊”是一个因素，您可以随时使用 ALA eBay 并在过去 30 天内更改用户名的人旁边显示一个图标。

根据具体情况，您可以保留历史记录并在需要时显示它。

如果这样做，请确保不会为新用户回收以前的用户名。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-19T19:13:18.373

人们想要合法地更改他们的用户名通常有很好的理由。

例如，假设某人`pimpleOnGodsAss`在大学期间注册，然后，几年后，在工作中并希望通过该网站与其他专业人士建立联系……他们会想要改变！

此外，考虑人们在结婚时更改姓名的非常常见的情况 - 如果他们使用姓氏作为用户名的一部分，他们也会想要更改它。用户名 marthajones 的 Martha Jones 与 John Smith 结婚并想要用户名 marthasmith（如果有）。

另请注意，您无法避免人们实现这一点 - 他们总是可以使用新的电子邮件地址重新注册，丢弃他们的旧历史，并获得他们想要的新用户名。

*我建议该功能的好处大于成本 - 人们总会找到一种方法来玩这个系统，不要仅仅因为有些人会找到滥用它们的方法而通过锁定功能来惩罚好用户。*

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-19T18:52:21.450

我喜欢 Steam 的“查看别名”功能，它可以让您查看您看到该用户使用的所有名称。只要用户名本身不是用户表中的主键，那么当然，让他们更改名称。添加一个别名表，这样如果某人是个混蛋，您就可以看到他们曾经是谁。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-19T19:13:27.810

您可以暂时显示两个名称：

> Symbol Guy -> 原名Prince

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-19T18:50:54.447

我不会让用户更改他们的实际用户名。

但是，更改显示名称应该是安全的。您始终可以直接通过他们的帐户或用户名跟踪他们的行为。如果他们做坏事，您应该标记他们的帐户，而不一定要尝试通过他们的名字进行跟踪。

大多数网站都有这个概念（包括 SO）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-19T18:51:17.100

如果每个用户都有一个恒定的唯一 ID 号，他们可以更改用户名但仍然相同。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-19T19:10:25.167

Arstechnica.com 更改用户名收费 20 美元，订阅者可免费获得一次更改。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-19T18:52:54.553

这是我希望在更多网站上看到的功能。

正如您所说，它很方便，并且为用户提供了灵活性。如果仅更改用户名就足以隐藏，则可能还有另一个问题。

以另一种方式（用户 ID、日志、信誉系统等）跟踪这些用户，并考虑向您的管理员/版主显示原始用户名。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-19T18:58:49.390

我同意这里回答的大多数人的观点——让用户更改他们的名字，否则该网站就不那么友好了。正如 Rahul 所说，如果用户更改了他们的名称，请确保新名称与他们之前的所有活动相关联。

同样 - 如果您使用电子邮件地址作为您的用户名（就像许多网站一样），让用户更改他们的电子邮件地址。我可以从个人经验中看出，不允许这样做是一个真正的痛苦（对于任何网站不允许的用户和客户支持）。

您的数据库结构不应该依赖于相同的用户名（/电子邮件地址），那么为什么要对您的用户强制执行呢？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-08-25T19:00:46.273

如果您有该功能，请留下它。您只是在鼓励某人创建另一个帐户来拥有用户名 goodwitch 和 badwitch。

如果您没有它，请不要添加它，除非您没有更好的添加。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-19T18:54:09.887

就个人而言，我试图让用户名具有粘性，并且是网站体验的重要组成部分。

如果其他用户将看到用户名，则为 true；如果该网站涉及任何社交网络。

如果您的网站存在很长时间，您总是可以归档真正旧的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-19T18:54:26.297

作为用户，我必须说我绝对希望能够更改我帐户上的用户名。我不会要求多个别名，但总有可能有人改变了主意，或者在第一次设置帐户时并没有真正考虑太多。您不应使用用户名作为主要内部帐户 ID。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-19T19:00:44.800

是 - 仅当用户不与其他用户交互时。

否 - 如果用户可以互动：论坛和类似的东西。每天看到不同名字的用户有点令人困惑。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-19T19:08:43.813

我会允许更改，并且可能同时携带用户（登录）名称和显示名称，并且我会允许对两者进行更改。双方都有各种争论，但对我来说，这通常归结为这些元素（用户和显示器）中的一个/两个通常反映了他们所有者的名字，并且他们的所有者的名字可以改变。

如果您的登录名是电子邮件地址，并且您更改了电子邮件提供商，那么现在该怎么办？或者取你的名字“Donny V”。我假设你是男性，但如果你是女性*呢？如果你嫁给了迈克彼得森。你现在不想被称为“Donny P.”吗？也许，也许不是。但很多人会。

*是的，我知道男人也可以改姓。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-19T19:13:07.810

“以前称为”显示器怎么样。如果用户决定更改用户名，只需将旧名称存储在表格中并额外显示即可。也许在所有用户配置文件中提供选项以禁用此显示。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-19T19:34:12.003

我投赞成票，在合理范围内。不应该允许遇到麻烦的用户（负面总代表、审核、过去的警告，任何适用于您的网站的内容）。

应允许其他用户，但有限制（例如，一年 3 次）。至少对于管理员/版主来说，应该有一种方法可以跟踪用户过去的用户名。

编辑：但是我发现诸如 Steam/Wordpress 之类的系统，其中用户的显示名和登录名分开有点令人困惑，所以我不推荐这种方法，但这只是个人感觉。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-19T19:34:15.110

> 如果 userA 知道 userB 做错事，然后 userB 将他的名字更改为 userC。那么用户A将不再知道他是谁。

如果您主要担心与滥用有关，也许您应该提供一种报告滥用的方法，并维护用户名何时更改的日志。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-19T20:10:49.577

您始终可以控制允许用户更改用户名的频率，以避免在论坛中看到每天都更改名称的同一个人；因为如果允许的话，有人会每天都这样做。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-19T20:42:39.657

**首先是业务问题**

你为什么要提供这个功能而不是花时间在另一个功能上？另一个功能是否会提供更好的好处（例如状态行？）

这将实现什么？

用户是否要求这样做？

这个功能会增加粘性或更好的体验吗？

这是竞争优势吗？

您的网站是否变得更加混乱？

* * *

**技术问题**

滥用的可能性有多大？您是否有一个非规范化数据库，其中用户名被复制了很多地方，或者只有一个地方存储了用户名？

你有办法向其他用户发送通知“你的朋友'foo'现在是'bar'吗？”

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-21T01:34:27.917

就像生活中的大多数事情一样，它归结为你所说的背景。就个人而言，我发现任何可能或被滥用的服务都应该有持久的用户名。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-03-21T20:00:52.780

假设让用户更改他们的名字是可以的，但是这个改变也应该触及他以前的帖子——他们应该用新的用户名显示

...

我提醒了一些密码已经意识到我在互联网资源中找到的

密码哈希 = md5（密码 + 盐 + 用户名）

如果您有相同的型号，那么您应该拒绝更改用户名

问候， 帕维尔

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-06-23T14:48:57.713

结合这里的一些想法：

每个用户都有一个唯一的内部 ID，一个数字。因此，您可以随时自由地实施此功能。无需立即对其进行编码，因为您可以延迟此决定。

In case you want to implement it: Let them only change the username every 6 months and indicate every new username by some symbol for 30 days. Show the username history in the profile and be sure to inform the user about this, so he can decide against changing the username.

# apache - Apache 处理 SSL 请求并将它们传递给 HAproxy

> ID：663521
> 
> 赞同：0
> 
> 时间：2009-03-19T18:48:25.610
> 
> 标签：apache, haproxy

我正在尝试设置为前端反向代理，Haproxy 将请求转发到后端的 Apache Web 服务器。我的问题是我未能成功使用 Apache 处理 SSL 请求。

我知道 Haproxy 无法处理 SSL 请求，因此我尝试设置 Apache 以接受端口 443 上的客户端请求并将其转发到 Haproxy，然后 Haproxy 将接收请求并将其转发到正确的 Apache 后端 Web 服务器。有没有人成功做到这一点？如果是，您能否提供 Apache 和 Haproxy 配置的示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-06T12:17:02.150

是的，我有请在此处查看配置[链接文本](http://jango.wordpress.com/2009/06/06/haproxy-and-ssl/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-14T03:20:58.433

我使用 nginx，这里是一个示例 nginx.conf：

```
server {
    listen       443;
    server_name  localhost;

    ssl                  on;
    ssl_certificate      /etc/pki/tls/certs/localhost.crt;
    ssl_certificate_key  /etc/pki/tls/private/localhost.key;

    ssl_session_timeout  5m;

    ssl_protocols  SSLv2 SSLv3 TLSv1;
    ssl_ciphers  ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
    ssl_prefer_server_ciphers   on;

    location / {
        root   html;
        index  index.html index.htm;

            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header Host $http_host;
            proxy_redirect off;
            proxy_max_temp_file_size 0;

            proxy_pass http://127.0.0.1:8000;
            break;
    }
} 
```

在 haproxy.cfg 中，设置：

听 http_proxy 127.0.0.1:8000

# latex - 用于记录的轻量级标记 (wiki) 语言

> ID：663532
> 
> 赞同：11
> 
> 时间：2009-03-19T18:50:11.347
> 
> 标签：latex, wiki, openoffice.org, markup

当我写论文或文档时，它会让人觉得使用 LaTeX 或 OpenOffice 太过分了，因为我通常只需要一些标记元素（粗体、标题、列表等）。我想使用 wiki 样式标记来编写我的文档，因为这非常有效。

例如：

```
= Introduction =
'''HTML''' is a markup language... 
```

最后，我想简单地将其转换为 PDF。（跨平台也不错。）

```
compiler.exe -pdf input.wiki output.pdf 
```

是否有工具（或简单的工具链）来完成这项工作？

我个人不想*使用*LaTeX 作为转换步骤。有一些工具可以将轻量级语法转换为 TeX，然后转换为 PDF/PS。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T19:04:39.547

你可能会发现[MarkDown](http://daringfireball.net/projects/markdown/)非常接近你想要的。

MarkDown 是一种用于标记文本文件的简单技术，以便可以将它们后处理成其他形式。MarkDown 的优点之一是他们的目标是标记的文档应该可以作为纯文本文件简单地阅读：

> The overriding design goal for Markdown’s formatting syntax is to make it as readable as possible. The idea is that a Markdown-formatted document should be publishable as-is, as plain text, without looking like it’s been marked up with tags or formatting instructions.

[PanDoc](http://johnmacfarlane.net/pandoc/) looks like it might be good companian tool to convert the MarkDown straight into PDF files. There may well be other choices - PanDoc is just the best tool I found with a quick Google search.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-19T18:51:16.943

[重构文本](http://en.wikipedia.org/wiki/ReStructuredText)。

您可以使用[Sphinx](http://sphinx.pocoo.org/)生成 HTML 和 LaTeX（以及后来使用 pdflatex 生成的 PDF）。

还有[rst2pdf](http://code.google.com/p/rst2pdf/)，不知道成熟没。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-19T19:03:01.220

您可以使用[Markdown](http://daringfireball.net/projects/markdown/) ( [example](http://daringfireball.net/projects/markdown/basics) )，然后使用[Pandoc](http://johnmacfarlane.net/pandoc/) (它也适用于 reStructuredText 和其他几种类似 wiki 的语法) 转换为 PDF。

# c++ - 可以像在 erlang 中一样在 C 中制作并发可扩展的可靠程序吗？

> ID：663546
> 
> 赞同：6
> 
> 时间：2009-03-19T18:52:52.790
> 
> 标签：c++, concurrency, erlang, multicore

一个理论问题。在阅读了 Armstrongs 的“programming erlang”一书后，我想知道以下几点：学习 Erlang 需要一些时间。更别说掌握它了。它在很多方面确实有根本的不同。

所以我的问题是：是否可以编写'like erlang'或使用一些'erlang like framework'，考虑到你注意不要创建带有副作用的函数，你可以像在Erlang中一样创建可扩展的可靠应用程序？也许使用相同的消息发送，大量的“迷你流程”范式。

这样做的好处是不会将您积累的所有 C/C++ 知识抛在一边。

欢迎对此提出任何想法

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T19:59:05.750

*是*的，这是可能的，**但是**......

罗伯特·维丁的第一条规则可能给出了这个问题的最佳答案：

> “任何用另一种语言编写的足够复杂的并发程序都包含一个临时的、非正式指定的、漏洞百出的、缓慢的一半 Erlang 实现。”</p>

非常好的规则是**使用正确的工具来完成任务**。Erlang 在并发性和可靠性方面表现出色。C/C++ 在设计时并未考虑到这些属性。

如果您*不想丢掉您的 C/C++ 知识*和经验，并且**您的项目允许**这种划分，那么好的方法是创建一个**混合解决方案**。在 Erlang 中编写并发、通信和错误处理代码，然后添加 C/C++ 部分，这将执行 CPU 和 IO 绑定的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T00:07:08.027

您显然可以 - Erlang/OTP 系统主要是用 C（和 Erlang）编写的。问题是“你为什么要这样做？”

在'ye olde days'人们过去常常编写自己的操作系统 - 但你为什么要这样做？

如果您选择使用操作系统，您的***未编写***软件具有某些属性 - 它可以持久保存到硬盘、可以与网络通信、可以在屏幕上绘图、可以从命令行运行、可以在批处理模式下调用等等等等……

Erlang/OTP 系统是 150 万行代码，已被证明在大型系统（英国电话系统）中提供 99.9999999% 的正常运行时间 - 即每年 31 毫秒的停机时间。

使用 Erlang/OTP，您的***未编写***软件具有高可靠性，它可以自行热插拔，您的***未编写***应用程序可以在物理计算机死机时进行故障转移。

为什么要重写该功能？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T19:01:09.447

我会把它分成2个问题

**你能编写并发的、可扩展的 C++ 应用程序吗？**

是的。为了实现这一点，当然可以创建所需的低级构造。

**您想编写并发、可扩展的 C++ 应用程序吗？**

也许。但是，如果我要开发一个高度并发的应用程序，我会选择一种语言，要么旨在填补这一空白，要么很容易做到这一点（Erlang、F# 和可能的 C#）。

C++ 不是为构建高度并发的应用程序而设计的。但它当然可以调整为这样做。但是，一旦考虑到内存管理，成本可能会比您预期的要高。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T19:29:51.187

是的，但你会做一些额外的工作。

关于副作用，请考虑 .net/plinq 团队的处理方式。Plinq 将无法强制您提交没有副作用的东西，但它会假设您这样做并遵守其规则，因此我们可以使用更简单的 api。即使该语言没有对它的内置支持，它仍然会简化事情，因为您可以更轻松地破坏操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T19:46:26.360

我可以用一种图灵完备语言做的事情 我可以用任何其他图灵完备语言做。

因此，我将您的问题解读为：用 C++ 编写可靠且可扩展的应用程序是否像在 Erlang 中一样容易？

答案是非常主观的。对我来说，用 C++ 编写它更容易，原因如下：

*   我已经用 C++ 完成了（至少 3 次）。
*   我不知道二郎。
*   我读过很多关于 Stackless Python 的文章，我觉得它就像一个高度并发的基于消息的 Python 协作多任务系统，但当然 Python 是在 C 之上编写的。

话说回来。如果您已经了解这两种语言，并且已经明确定义了问题，那么您可以根据手头的所有信息做出最佳选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T19:37:37.473

使用 C（或 C++）编写可靠且易于扩展的程序的主要“问题”是在 C 中您可以做**任何事情**。所以，第一步是编写一个简单的框架，只限制一点。无论如何，大多数优秀的程序员都会这样做。

在这种情况下，这些限制主要是为了在您想要的任何隔离级别内轻松定义“进程”。 `fork()`以缓慢着称，而且线程也需要大量时间来生成，因此您可能希望使用协作式多任务处理，这可能会更有效率，您甚至可以使其成为抢先式（我认为这就是 Erlang 所做的）。要获得多核效率，请设置一个线程池并让它们全部完成以运行任务。

另一个重要部分是创建一个适当的不可变数据结构库，以便使用它们（而不是标准库）您的函数将（大部分）无副作用。

那么这只是为消息传递和期货设置一个好的 API 的问题......并不容易，但至少它看起来不像改变语言本身。

# .net - Flex：将图形导出到 .NET？

> ID：663555
> 
> 赞同：2
> 
> 时间：2009-03-19T18:54:42.053
> 
> 标签：.net, apache-flex, web-services

我在 Flex 中有一个图形组件，我的最终用户希望能够在 Flex 中操作这个控件，然后将结果导出到 Powerpoint。我将图像导出到 Powerpoint 没有问题，但我遇到的问题是将 Flex 组件导出到 .NET Web 服务。这是我想出的代码...

网络服务声明：

```
<mx:WebService id="ws" wsdl="http://localhost:59228/CreateImageService.asmx?wsdl">
<mx:operation name="CreateImage" resultFormat="xml"/>
</mx:WebService> 
```

弹性代码：

```
 private function btnCreateImage():void {
    var imageSnap:ImageSnapshot = ImageSnapshot.captureImage(TeamChart);
    var imageByteArray:ByteArray = imageSnap.data as ByteArray;

    ws.CreateImage(imageByteArray);

    //swfLoader.load(imageByteArray);

} 
```

以及 Web 服务代码：

```
 [WebMethod]
    public void CreateImage(byte byteArrayin)
    {
        CreateImage createImage = new CreateImage();
        createImage.byteArrayToImage(byteArrayin);
    } 
```

我知道组件已成功转换为 ByteArray，因为我可以使用 SWFLoader() 使其重新出现在 Flash 画布中。如果我尝试将字节数组发送到 .NET Web 服务，我会收到一个 SOAP 错误。如果我向 Web 服务提交 0，这至少会命中 Web 服务。

我不太确定问题出在哪里，但我担心这是我忽略的简单问题。

## 非常感激，

-马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:50:52.603

我想到了。我必须将图像编码为 base64 字符串并以这种方式将其发送到 .NET。这是我的代码：

柔性：

```
private function btnCreateImage():void {
    var imageSnap:ImageSnapshot = ImageSnapshot.captureImage(TeamChart);
    var image64BitText:String = ImageSnapshot.encodeImageAsBase64(imageSnap);

    ws.CreateImage(image64BitText);

    //swfLoader.load(imageByteArray);

} 
```

.NET 网络服务

```
public Image byteArrayToImage(string base64ImageString)
{
    // Convert Base64 String to byte[]
    byte[] imageBytes = Convert.FromBase64String(base64ImageString);
    MemoryStream ms = new MemoryStream(imageBytes, 0,
      imageBytes.Length);

    // Convert byte[] to Image
    ms.Write(imageBytes, 0, imageBytes.Length);
    Image image = Image.FromStream(ms, true);
    return image;
} 
```

# java - 在小程序中使用 main 方法查找类

> ID：663559
> 
> 赞同：0
> 
> 时间：2009-03-19T18:57:10.987
> 
> 标签：java, class, applet, main-method

我正在尝试使用此工具

[https://swingexplorer.dev.java.net/](https://swingexplorer.dev.java.net/)

查找有关小程序的摆动结构的一些信息。不幸的是，我没有开发小程序。我已经从缓存中拉出了applet的jar，但是jar中有几百个.class文件，不知道哪个有main方法。

有没有办法查明小程序的入口点？浏览器必须能够弄清楚它才能运行小程序，因此信息必须位于 jar 中的某个位置（或者可能与 jar 位于同一目录中的 .idx 文件）。

想法赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:06:40.197

入口类将位于 applet 标记中，或者位于新插件 JRE 6u10+ applet 的 JNLP 中。您应该能够通过对 Applet 或 JApplet 类或 init()V 方法的引用进行 grepping 来单独从 jar 中查看它是哪一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T20:28:12.950

[Applet](http://docs.oracle.com/javase/6/docs/api/java/applet/Applet.html)（或[JApplet](http://docs.oracle.com/javase/6/docs/api/javax/swing/JApplet.html) ）的生命周期比*启动和运行更复杂，直到程序完成*，因此没有单一的`main`方法。它将由浏览器管理（[生命周期教程](http://docs.oracle.com/javase/tutorial/deployment/applet/appletMethods.html)。）

applet 类由部署机制指定（例如 applet/object/embed 标记）。请参阅[部署教程](http://docs.oracle.com/javase/tutorial/deployment/deploymentInDepth/runAppletFunction.html)以确定如何指定此类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:37:27.187

我试图为该任务使用错误的工具。

# linux - 将代码和数据放入 Linux 内核模块的同一部分

> ID：663564
> 
> 赞同：1
> 
> 时间：2009-03-19T18:58:54.693
> 
> 标签：linux, gcc, module, kernel

我正在编写一个 Linux 内核模块，我想在同一部分中包含一些代码和相关数据。我用属性标签声明数据和函数，例如：

```
void * foo __attribute__ ((section ("SEC_A"))) = NULL;
void bar(void)  __attribute__ ((section("SEC_A"))); 
```

但是，当我这样做时，gcc 抱怨：

```
error: foo causes a section type conflict 
```

如果我没有用特定的部分名称声明函数，gcc 就可以了。但我希望函数和变量都在同一部分。

有没有办法用 gcc 做到这一点？我的 gcc 版本是`gcc (Ubuntu 4.3.2-1ubuntu12) 4.3.2`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T19:50:00.530

从 GCC 手册：

> 某些文件格式不支持任意节，因此节属性并非在所有平台上都可用。如果您需要将模块的全部内容映射到特定部分，请考虑改用链接器的工具。

IIRC，linux使用平面内存模型，所以你不会通过将东西“强制”到一个部分中来获得任何东西，对吧？

嗯。我想您可以创建一个 asm 函数来保留空间，然后执行指针 foo 来获取它的地址。可能想将丑陋的东西包装在宏中......

另一个想法是将问题分成两半；写一个你可以编译的最接近的例子，获取asm代码，然后修改它，看看你可以通过下游阶段得到什么。如果没有别的，你可以写一些东西来混合那个模块的 asm 代码，把它埋在你的 make 文件中，然后称之为好。

另一个想法：尝试将变量定义放在一个小的 asm 模块中（例如，作为 db 或具有正确部分声明的任何内容）并让链接器处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T20:30:28.420

我认为您不能将文本（函数）和数据（BSS）对象放入同一部分，因为（某些）操作系统假定 .TEXT 部分类型的不变性以供进程重用。

# jquery - 如何在 jQuery 中将背景颜色设置为透明？

> ID：663568
> 
> 赞同：40
> 
> 时间：2009-03-19T19:00:54.657
> 
> 标签：jquery, jquery-ui, transparent

我可以从透明动画到颜色，但是当我告诉 jquery 动画 backgroundColor: 'transparent' 它只是变成白色。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-19T19:03:31.890

透明不是真正的颜色。所以，你不能为它制作动画。您可以通过使用单独的背景元素并为不透明度设置动画来实现您正在寻找的效果。

### 例子：

HTML：

```
<body style="background-color:yellow">
  <!-- by default, "see through" to parent's background color -->
  <div id="container"> 
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
    Aenean nec magna. Nulla eu mi sit amet nibh pellentesque vehicula. 
    Vivamus congue purus non purus. Nam cursus mollis lorem.    
  </div>
</body> 
```

脚本：

```
// on load...
$(function()
{
  var container = $("#container");
  container
    .hover(
      // fade background div out when cursor enters, 
      function() 
      { 
        $(".background", this).stop().animate({opacity:0}); 
      }, 
      // fade back in when cursor leaves
      function() 
      { 
        $(".background", this).stop().animate({opacity:1}) 
      })
    // allow positioning child div relative to parent
    .css('position', 'relative')
    // create and append background div 
    // (initially visible, obscuring parent's background)
    .append( $("<div>")
      .attr('class', 'background')
      .css({
        backgroundColor:'blue',
        position: 'absolute',
        top:0,
        left:0,
        zIndex:-1,
        width:container.width(), 
        height:container.height()
      }) 
    );
}); 
```

* * *

Kingjeffrey 的评论指出这个答案有些过时 - 浏览器现在支持 RGBA 颜色值，因此您*可以*只为背景设置动画。然而，jQuery 的核心并不支持这个——你需要一个[插件](http://pioupioum.fr/sandbox/jquery-color/)。参见：[jQuery + RGBA 颜色动画](https://stackoverflow.com/questions/3242368/jquery-rgba-color-animations)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-03-17T00:12:11.050

我想这样做，但因为我找不到它，所以我一起破解了它。这仅适用于白色，适合您的需求：

```
function animate_bg(ele, from, to) {
    ele.css("background-color", "rgba(255, 255, 255, " + (from += from > to ? -1 : 1) / 10 + ")"); 
    if(from != to)  
        setTimeout(function() { animate_bg(ele, from, to) }, 20);
} 
```

用法：

```
`$("a").hover(
    function() {return animate_bg($(this), 0, 10)},
    function() {return animate_bg($(this), 10, 0)}
);` 
```

* * *

 `## 回答 #3

> 赞同：8
> 
> 时间：2009-11-16T06:03:58.413

```
$(selector)
    .css({backgroundColor:"#f00"})
    .animate({backgroundColor:"transparent"}, 2000, null, 
    function() { this.style.backgroundColor='transparent'; }); 
```

不那么干净，因为它在使背景透明之前将背景淡化为白色，但这是一种选择。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-01T18:17:49.857

您可以使用 rgba(61, 31, 17, 0.5) 颜色，其中 0.5 是不透明度。然后如果你想透明设置不透明度为 0.0

```
$('.myClass').animate({ "backgroundColor" : "rgba(61, 31, 17, 0.0)" }, 1000); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-06T15:15:33.857

我使用了Linus的答案，但遇到了IE。对其进行了一些更改以在 IE 中工作：

```
function animate_bg(ele, from, to) {
    from += from > to ? -1 : 1;
    if(!$.support.opacity){
        if(from != to){
            var opStr = (Math.round(from * 25.5)).toString(16);
            //alert(opStr)
            ele.css({background:'transparent',filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#" + opStr + "FFFF00, endColorstr=#" + opStr + "FFFF00)"});   
        }else{
            ele.css({background:'transparent',filter:"none"});   
        }
    }else{
        ele.css("backgroundColor", "rgba(255, 255, 0, " + (from) / 10 + ")"); 
    }

    if(from != to)  
        setTimeout(function() { animate_bg(ele, from, to) }, 50);
} 
```

用法是一样的：

```
$("a").hover(
    function() {return animate_bg($(this), 0, 10)},
    function() {return animate_bg($(this), 10, 0)}
); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-31T21:33:37.033

Use CSS transition:

```
$('smth').css('transition','background-color 1s').css('background-color','transparent') 
```

or

```
$('h1').css({'transition':'background-color 1s','background-color':'red'}) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-09T13:42:00.607

你必须把它锁起来。

例如，您不能这样做：

```
$('#panel').animate({'backgroundColor' : 'rgba(255,255,0,0.7', 'opacity': 1}, 3000); 
```

甚至

```
$('#panel').animate({'background-color' : 'yellow', 'opacity': 1}, 3000); 
```

但你可以这样做：

```
$('#panel').css('background-color', 'rgba(255,255,0,0.7)').animate({'opacity': 1}, 3000); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-11T13:19:34.223

使用 jQuery Color 插件：[https ://github.com/jquery/jquery-color](https://github.com/jquery/jquery-color)

它将使您的透明动画和 rgba 动画正常工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-28T08:54:28.933

我稍微更改了 Shog9 的代码以满足我的需要。它有点像 jQuery UI Highlight，只是它不会变成白色。它并不完美，但它适用于大多数元素

```
function highlight(element, color, speed) {
if (speed == null) speed = "fast";
var e;
var position;
element.each(function() {
    e = $(this);
    position = e.css('position');
    if (position != 'absolute')
        e.css('position', 'relative');
    log(position);
    e.append($("<div>")
        .css({
            backgroundColor: color,
            position: 'absolute',
            top: 0,
            left: 0,
            zIndex: -1,
            display: "none",
            width: e.width(),
            height: e.height()
        }).fadeIn(speed).fadeOut(speed, function() { $(this).remove(); e.css('position', position); })

      );
}); } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-06-29T18:54:11.847

动画完成后，我使用函数参数删除样式：

```
$('[orgID=' + orgID + 'bg]').animate({ backgroundColor: "white" }, 300, "linear", function()
 {
     $('[orgID=' + orgID + 'bg]').css('background-color', '');
}); 
```

效果很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-04T01:27:48.017

我的解决方案是动画到用户看到的颜色（即父元素的颜色），然后在动画完成后设置为原始颜色（可能是也可能不是“透明”）

```
var $t = $(some selector);

var seenColour = findColour($t, 'background-color');
var origColour = $t.css('background-color');
$t.css('background-color', '#ffff99');
$t.animate(
    {backgroundColor: seenColour}, 
    4000, 
    function(){ $t.css('background-color', origColour)}
);

function findColour($elem, colourAttr)
{
    var colour = $elem.css(colourAttr);
    if (colour === 'transparent')
    {
        var $parent = $elem.parent();
        if ($parent)
        {
            return findColour($parent, colourAttr);
        }
        // Default to white
        return '#FFFFFF'; 
    }
    return colour;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-20T17:29:32.320

使用背景而不是背景颜色：

```
$('#myDiv').animate({background: "transparent"}); 
```

# linq-to-sql - Linq to Sql，一次查询即可检索嵌套数据结构

> ID：663579
> 
> 赞同：2
> 
> 时间：2009-03-19T19:04:24.150
> 
> 标签：linq-to-sql

我不确定是否已经存在对此的答案，因为我无法弄清楚 Linq 中的哪种机制适用于这种情况，或者我是否只需要手动完成。

假设我有 2 张桌子：

```
------------Employees-------------
EmployeeID  Name  -other columns-

   ---------EmployeeSkills-----------
   EmployeeID  Skill  -other columns- 
```

所以每个员工可以拥有0个或更多的技能。

**我的目标是使用一个 sql 查询**将此信息绘制到内存中的数据结构中

 **```
 class StaticEmployee
    {
        int EmployeeID;       
        string Name;
        List<string> Skills;
    }
    List<StaticEmployee> employees = (???).ToList(); 
```

由于我的表关系已设置，我可以只获取员工表（*从 db.Employees 中的员工选择员工*），但是当我访问 EmployeeSkills 属性时，它将为每个员工记录执行单独的查询，因为该数据不是t 与第一个查询一起返回。

或者，就 Sql 而言，我想要做的是运行带有左连接的查询：

```
SELECT Employees.EmployeeID, Employees.Name, EmployeeSkills.Skill FROM Employees LEFT JOIN EmployeeSkills ON Employees.EmployeeID=EmployeeSkills.EmployeeID 
```

这将为我提供我的列表，但我需要手动将其整理到我的列表中，因为具有 2 项技能的员工将返回 2 行。**是否有执行此操作的 Linq 操作？** *下面的假设示例*

```
from employee in db.Employees
select new 
{
   EmployeeID = employee.EmployeeID, 
   Name = employee.Name,
   Skills = new List(
                     from employeeSkill in employee.EmployeeSkills 
                     select employeeSkill.skill
                    )
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T19:10:21.407

```
var options = new DataLoadOptions();
options.LoadWith< Employees>(e => e.EmployeeSkills);
context.LoadOptions = options;
//retrieve employees, they will come loaded with EmployeeSkills 
```

如果您要使用 linq 查询版本，这也将加载它们一次：

```
from employee in db.Employees
select new 
{
   EmployeeID = employee.EmployeeID, 
   Name = employee.Name,
   Skills = employee.EmployeeSkills
} 
```

# vim - 防止 :make 在 VIM 中出现警告

> ID：663585
> 
> 赞同：17
> 
> 时间：2009-03-19T19:06:44.177
> 
> 标签：vim, makefile, warnings

我有一个警告，我不能轻易地从我的构建中删除，每次我从 vim 内部运行 ":make" 时，quickfix 都会将我带到一些我不关心的头文件。我怎样才能防止 VIM 这样做并且只向我显示我关心的警告和错误？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-10-13T17:05:21.383

正如 Luc Hermite 所说，可以使用`'errorformat'`选项忽略警告。调整这个选项有点复杂；`$VIMRUNTIME/compiler`检查一些示例可能会有所帮助。

使用 avr-gcc 和 C++ 时会出现一些像这样的恼人警告

```
tests.cpp:492: warning: only initialized variables can be placed into program memory area 
```

出现，这很可能是[编译器错误](http://www.avrfreaks.net/index.php?name=PNphpBB2&file=printview&t=62004&start=0)的结果。

为避免在 quickfix 窗口上显示此警告，我将其添加到`~/.vimrc`：

```
compiler gcc
set errorformat^=%-G%f:%l:\ %tarning:\ only\ initialized\ varia
            \bles\ can\ be\ placed\ into\ program\ memory\ area 
```

可`%-G`用于指定要忽略的模式。`^=`in用于将`set errorformat^=...`忽略的警告模式添加到`'errorformat'`-- using `+=`( `set errorformat+=...`) 将附加到选项并且不起作用，就像`'errorformat'`格式列表一样，并且使用第一个匹配的格式，因此“正常”警告模式将改为申请。

也许您可以根据您的环境调整这些设置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-19T19:43:44.603

检查`:h 'errorformat'`（又名`&efm`），只要您可以使用模式识别警告，就有忽略警告的选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T19:19:10.183

一种快速而肮脏的方法是编写一个简单的 shell 脚本来运行你的 make 并找出你不想看到的警告。然后让 vim 使用这个脚本而不是 make（添加“set makeprg=yourscript.sh”到你的 .vimrc）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-14T09:30:44.943

为了建立在 mMontu 建议的基础上，将其添加到我的 .vimrc 对我有用（忽略来自我的 gcc 编译器的所有警告）

设置错误格式^=%-G%f:%l:\ 警告:%m

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T22:18:33.280

向布拉姆本人学习。

[我依稀记得他在这个视频](http://video.google.com/videoplay?docid=2538831956647446078)的某个地方谈到了这个。

他在编译 gvim 时添加了一个过滤器来忽略一些 gnome 警告。

不管怎样，这个视频很值得一看。

这是大约30分钟的标记。

# c# - 泛型、继承和新运算符

> ID：663586
> 
> 赞同：2
> 
> 时间：2009-03-19T19:07:18.370
> 
> 标签：c#, generics, inheritance, oop

这是我发现自己不时使用的东西，我只是想获得一些关于这种做法的优点的反馈。

假设我有一个基类：

```
abstract class RealBase {
    protected RealBase(object arg) {
        Arg = arg;
    }

    public object Arg { get; private set; }

    public abstract void DoThatThingYouDo();
} 
```

我经常创建第二个通用基类，它处理从基类中的“object”类型到“T”类型的转换，如下所示：

```
abstract class GenericBase<T> : RealBase {
    protected GenericBase(T arg)
        : base( arg ) {
    }

    new public T Arg { get { return (T) base.Arg; } }
} 
```

这允许我在没有强制转换操作的情况下访问“Arg”作为其显式类型：

```
class Concrete : GenericBase<string> {
    public Concrete( string arg )
        : base( arg ) {
    }

    public override void DoThatThingYouDo() {
        // NOTE: Arg is type string. No cast necessary.
        char[] chars = Arg.ToLowerInvariant().ToCharArray();  
        // Blah( blah, blah );
        // [...]
    }

} 
```

同时也可以通过“RealBase”使用它：

```
class Usage {
    public void UseIt() {
        RealBase rb = new Concrete( "The String Arg" );
        DoTheThing(rb);
    }

    private void DoTheThing(RealBase thingDoer) {
        rb.DoThatThingYouDo();
    }
} 
```

假设还有许多其他“具体”类型......不仅仅是一种。

以下是我的问题/疑虑：

1.  我是否因为使用这样的方法而“摇摆不定”？
2.  使用这种方法有什么明显的缺点/注意事项吗？
3.  GenericBase 中的“新公共 T...”怎么样？好/坏主意？尴尬的？

任何反馈或建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T19:18:12.543

只要您有足够的纪律性，仅将泛型基类用作帮助器并且从不沮丧，我对此没有任何明确的反对意见。如果你开始到处引用 RealBase 和 GenericBase 和 ConcreteClass，事情往往会很快变得真正紧密耦合。

事实上，我建议将其提升一个档次并引入一个界面

```
interface IReal {
  void DoThatThingYouDo();
} 
```

并将基类完全排除在外（基本上从不引用它，除非在声明派生类时）。只是一个帮助我提高代码灵活性的提示。

哦，如果你确实使用了接口，不要只在基类中声明它，而是在具体的类中声明它：

```
class MyConcrete: BaseClass<MyConcrete>, IReal {
  ...
} 
```

提醒一下，基类并不重要，重要的是它做了什么！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-19T19:19:57.700

好吧，我们现在有了一个三层深的继承树，但是您没有给出这样做的任何特别原因。

就我个人而言，我很少使用继承（或者更确切地说，除了实现接口和直接从对象派生之外，很少设计自己的继承层次结构）。继承是一种强大的工具，但很难有效地使用。

如果与其他方法相比，这为您提供了一些明显的优势，那很好 - 但我会考虑您为阅读代码的人增加的复杂性。他们真的要考虑三个层次结构，有两个同名的属性吗？（我会将 GenericBase.Arg 重命名为 GenericBase.GenericArg 或类似的名称。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T19:25:05.147

我认为你可以通过使用接口而不是双抽象基类来获得你想要的相同功能，考虑一下：

```
public interface IAmReal
{
    void DoThatThingYouDo();
    ...
}

abstract class GenericBase<T> : IAmReal
{
    protected GenericBase<T>(T arg)
    {
        Arg = arg;
    }
    public T Arg { get; set; }
    public abstract void DoThatThingYouDo();
}

class MyConcrete : GenericBase<string>
{
    public MyConcrete(string s) : base(s) {}
    public override void DoThatThingYouDo()
    {
        char[] chars = Arg.ToLowerInvariant().ToCharArray();
        ...
    }
}

class Usage
{
    public void UseIt()
    {
        IAmReal rb = new MyConcrete( "The String Arg" );
        DoTheThing(rb);
    }

    private void DoTheThing(IAmReal thingDoer)
    {
        rb.DoThatThingYouDo();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T19:38:22.883

我不认为你是摇摆不定的。有关更复杂的内容，请参阅[Curiously Recurring Template 。](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T19:25:03.057

我个人强烈建议不要使用 new 运算符，因为它可能会导致混淆。其实我自己最近也遇到过这样的问题，但是我选择了后缀为 AsObject 的基类抽象，即：

```
public BaseClass{
    public abstract object ValueAsObject {get;set;}
} 
```

和通用类：

```
public BaseClass<T> : BaseClass {
    public T Value {get;set;}
    public override object ValueAsObject {
       get{return (T)this.Value;} 
       set{this.Value = value;} // or conversion, e.g. string -> int
} 
```

Georg Mauer 提出的 DoThatThingYouDo 接口也不错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T19:43:59.860

我是唯一一个认为应该尽可能避免继承的人吗？当继承导致奇怪的问题时，我已经看到了不同的实现，而不仅仅是在尝试向下转换时。接口是救星！我并不是说应该始终避免继承，但是仅通过查看指定的代码，我看不到这种继承树相对于常规接口的优势。

# programming-languages - 我们可以使用哪些方法来互操作编程语言？

> ID：663587
> 
> 赞同：0
> 
> 时间：2009-03-19T19:07:52.847
> 
> 标签：programming-languages, interop

我们可以做些什么来集成用一种语言编写的代码和用任何其他语言编写的代码？哪些技术更广为人知？我知道一些/大多数语言可以编译为 Java 字节码，但是我们如何处理其余的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T19:12:59.870

您提到了“编译为 Java”的方法，还有“使用 .NET 语言”的方法，那么让我们看看其他情况。您可以通过多种方式进行互操作，这取决于您要完成的工作，具体情况视具体情况而定。想到的事情是

*   Web 服务（SOAP 或 REST）
*   文件系统中的文本（或其他）文件
*   使用数据库来传递状态或其他数据
*   MSMQ 或 MQSeries 等消息传递环境
*   TCP 套接字或 UDP 消息
*   邮槽和命名管道

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T19:12:07.033

这取决于您想要的集成级别。

*   您需要代码来共享数据吗？使用平台中立的数据格式，例如 JSON、XML、Protocol Buffers、Thrift 等。
*   您是否需要能够要求用一种语言编写的代码为另一种语言的代码执行某些任务？使用 Web 服务或类似的进程间通信层。
*   您是否需要能够在单个进程中调用代码？那时的答案将完全取决于您正在谈论的语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T19:16:17.943

直接调用：

*   直接调用（如果编译器了解彼此的调用堆栈）
*   远程过程调用（90 年代初）
*   CORBA（90 年代后期）
*   远程方法调用（Java，目标环境中带有 RMI 堆栈/库）
*   .Net 远程处理

不太紧密的集成：

*   网络服务/SOAP
*   休息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T19:12:55.410

我最常看到的两个是[SWIG](http://www.swig.org/)和[Thrift](http://incubator.apache.org/thrift/)。主要区别在于（IIRC）Thrift 打开一个端口并在那里放置一个服务器来编组不同语言之间的数据，而 SWIG 构建库接口文件并使用它们来调用指定的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-19T19:14:06.250

我认为不同语言的程序之间存在一些可能的**关系**......

**共享一个运行时**（例如 C# 和 Visual Basic）并编译到相同的应用程序/进程中......

有**一个调用另一个**（例如调用 C 程序的 perl 脚本）...

通过盒子上的**IPC 或通过网络**（例如管道和 Web 服务）相互交谈...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T17:33:47.407

不幸的是，您的问题相当模糊。

通常通过将 VM 或解释器嵌入到可执行文件中，可以在同一进程中使用不同的语言。如果您需要通过进程边界进行通信，那么还有几种可能性，其中许多已经在其他答案中提到过。

我建议您完善您的问题以获得更多有用的答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T17:37:52.140

在 Web 上，cookie 可以设置为在 ASP/PHP/JavaScript 之间传递变量。在我之前参与的一个项目中，我们使用它来创建一个 PHP 文件来下载 PDF，而不会从 ASP 应用程序中透露它们在文件系统上的位置。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T17:51:26.333

几乎每一种伪装成某种系统开发用途的语言都能够通过标准 OS 接口或 C 函数接口链接外部例程。这就是我倾向于使用的。

# c++ - Emacs C++ 模式缩进不正确？

> ID：663588
> 
> 赞同：41
> 
> 时间：2009-03-19T19:08:12.300
> 
> 标签：c++, emacs, indentation

我正在使用 c++ 模式运行 emacs 23 并遇到一些缩进问题。假设我有这个代码：

```
void foo()
{
   if (cond)
     { <---
        int i;
        ...
     } <---
} 
```

这似乎是自动缩进的默认行为。但是我想改变它，所以它会是这样的：

```
void foo()
{
   if (cond)
   {
      int i;
      ...
   }
} 
```

有没有办法通过配置 c++ 模式或我的 .emacs 文件轻松做到这一点？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-19T19:18:16.677

我的 .emacs 文件中有以下内容：

```
(defun my-c++-mode-hook ()
  (setq c-basic-offset 4)
  (c-set-offset 'substatement-open 0))
(add-hook 'c++-mode-hook 'my-c++-mode-hook) 
```

您可以通过在任意行上点击 [ctrl-c ctrl-s] 来确定要编辑的偏移量。在第一行后面的大括号`if`会说`substatement-open`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-19T23:54:25.733

这是我的……这与 Visual Studio 的默认设置相匹配。

```
(defun my-c-mode-common-hook ()
 ;; my customizations for all of c-mode, c++-mode, objc-mode, java-mode
 (c-set-offset 'substatement-open 0)
 ;; other customizations can go here

 (setq c++-tab-always-indent t)
 (setq c-basic-offset 4)                  ;; Default is 2
 (setq c-indent-level 4)                  ;; Default is 2

 (setq tab-stop-list '(4 8 12 16 20 24 28 32 36 40 44 48 52 56 60))
 (setq tab-width 4)
 (setq indent-tabs-mode t)  ; use spaces only if nil
 )

(add-hook 'c-mode-common-hook 'my-c-mode-common-hook) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-20T00:14:26.823

简短回答：将此行放入您的`.emacs`文件中：

```
(c-set-offset 'substatement-open 0) 
```

长答案：...

对于我们这些刚接触 emacs-lisp 的人来说，在[http://www.cs.cmu.edu/](http://www.cs.cmu.edu/cgi-bin/info2www?(efaq)Customizing%20C%20and%20C%2B%2B%20indentation)上有一个非常简单的方法：

*   转到要缩进的行

*   键入 CC CO（那是字母“O”，而不是零）

*   按*Enter*接受默认建议

*   键入“0”（即零）表示没有额外的缩进，按*Enter*

*   键入*Tab*以重新缩进该行。

*   在这种情况下，未来的“{”将具有正确的选项卡设置，直到您重新启动 emacs。

这种方法的好处是，您实际上可以*看到*要更改的 lisp 代码。您可以放入 .emacs 文件：

```
(c-set-offset 'SYNTACTIC-SYMBOL OFFSET) 
```

此外，您可能需要查看程序[AStyle](http://astyle.sourceforge.net/)以在 emacs 之外自动格式化 C++ 源代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-26T03:09:43.813

接受的答案实际上是错误的。Emacswiki 将无济于事。

将以下代码插入`~/.emacs`：

```
(defun fix-c-indent-offset-according-to-syntax-context (key val)
  ;; remove the old element
  (setq c-offsets-alist (delq (assoc key c-offsets-alist) c-offsets-alist))
  ;; new value
  (add-to-list 'c-offsets-alist (cons key val)))

(add-hook 'c-mode-common-hook
          (lambda ()
            (when (derived-mode-p 'c-mode 'c++-mode 'java-mode)
              ;; indent
              (fix-c-indent-offset-according-to-syntax-context 'substatement-open 0))
            )) 
```

有关技术细节，请参阅[http://blog.binchen.org/posts/ccjava-code-indentation-in-emacs.html](http://blog.binchen.org/posts/ccjava-code-indentation-in-emacs.html)。

关键问题是 c-set-offset**不再可靠**地检测语法上下文（Emacs24.3.1）。所以唯一可靠的方法是分析原始的emacs代码。我的文章中列出了破解代码的详细步骤，基本上你需要阅读/usr/share/emacs/24.3/lisp/progmodes/cc-cmds.el 中定义的函数**c-indent-line**

有些人抱怨我的设置不起作用。实际上，如果您不更改默认设置（缩进具有不同的配置文件，我的设置基于默认配置文件），它实际上适用于所有**稳定**版本的 Emacs（23.4、24.3、24.4）。

我的重点是，在这个特定问题上，您需要阅读代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-03T22:05:42.203

在调整单个偏移量之前，配置首选样式。我使用 stroustrup，您可以尝试其他一些，请参阅[http://www.emacswiki.org/emacs/IndentingC#toc1](http://www.emacswiki.org/emacs/IndentingC#toc1)的名称和[http://en.wikipedia.org/wiki/Indent_style#Variant:_Stroustrup](http://en.wikipedia.org/wiki/Indent_style#Variant:_Stroustrup)的例子

Mx customize-variable c-default-style （并为 C++_ 设置您的首选

# .net - .NET 中异步操作的线程静态变量

> ID：663593
> 
> 赞同：2
> 
> 时间：2009-03-19T19:10:10.703
> 
> 标签：.net, asynchronous, thread-static

有没有办法让 ThreadStatic 变量从一个线程转移到另一个线程？我有一堆 ThreadStatic 变量，现在我将我的操作转换为异步的，我希望能够将它们从第一个线程（设置它们的位置）“传输”到回调线程（读取它们的位置） ）。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:13:12.180

不可以。您需要通过异步调用保留操作的上下文。这就是大多数异步调用的“状态”参数。

`ThreadStatic`*变量在某些*情况下可能很有用，但我通常对它们保持警惕。除非您真的知道您不需要任何类型的线程敏捷性，否则最好以更明确的方式保持状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T19:13:07.500

最好的方法是向您的操作传递一些对象，它可以在回调之前设置您的 threadstatic 变量。无法从调用线程直接访问 threadstatic 变量。

话虽如此，我会重新考虑你的设计。如果您希望该变量可从多个线程使用，它可能不应该是 threadstatic 变量。它可能应该通过其他方式进行管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T19:13:12.617

如果您需要这样做，您可能不希望它们成为`ThreadStatic`. 您可以制作静态`Dictionary<int,VarType>`并将线程 ID 映射到变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T01:08:56.973

正如 Jon 所说，在我看来，最好的方法是使用*state参数。*但是，如有必要，您可以查看[System.Runtime.Remoting.Contexts.Context](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.contexts.context.aspx)。

# python - 在 python 中寻找与错误跟踪器集成的知识库

> ID：663603
> 
> 赞同：2
> 
> 时间：2009-03-19T19:12:19.547
> 
> 标签：python, knowledge-management

好的，我不确定我是否要使用 Request Tracker 和 RTFM，这是一种可能的解决方案。

我想拥有一个包含我的错误跟踪器/待办事项列表的知识库，这样当我解决问题时，我可以为自己或其他人记录它的解决方案。

有哪些基于 python 的解决方案可用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T19:13:48.527

尝试[追踪](http://trac.edgewall.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-22T22:50:50.913

我推荐的 Python 中高度灵活的问题跟踪器是“Roundup”： [http](http://roundup.sourceforge.net/) ://roundup.sourceforge.net/ 。

可以在[http://bugs.python.org/](http://bugs.python.org/)在线查看其使用示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-23T15:03:07.157

我确实有使用大约 20-30 个不同的错误跟踪器的经验，安装或托管，到目前为止，如果您要处理大量错误并且您想花更少的时间编写问题跟踪器来获得 Atlassian Jira ，对于开源项目是免费的。

是的，它不是 Python，它是 Java，启动缓慢并且需要大量资源。同时，RAM 比你自己的时间便宜得多，如果你想扩展系统，你可以在 Python 中使用[https://pypi.python.org/pypi/jira-python/](https://pypi.python.org/pypi/jira-python/)

您认为 Jira 是无缘无故使用最多的错误跟踪器吗？它不是市场上的第一个，实际上与其他人相比是相当新的。

部署后，您可以专注于改进工作流程，而不是修补错误跟踪器。

One of the best features that it has is the ability to link to external issues and be able to see their status, without having to click on them. As an warning, for someone coming from another tracekr you may discover that there are some design limitations, like the fact that a bug can have a single assignee. Don't be scared about it, if you look further you will find that there are way to assign tickets to groups of peoples.

# c - 程序在 make 启动时运行，但不是通过 shell，为什么？

> ID：663617
> 
> 赞同：1
> 
> 时间：2009-03-19T19:13:44.393
> 
> 标签：c, debugging, unix, makefile

我编写了一个 C 程序，在其中我做了一些非常繁重的堆栈分配，大约 2 MiB。由于我使用的是穷人的 IDE*，所以每次编译时，我都会通过 make 自动运行程序以对其进行测试。

我几乎把所有东西都包起来了，但出于某种原因，在最后的一些优化过程中，我直接从 shell 运行它。即时段错误！使用 make 运行它仍然有效，并且手动运行它总是会产生相同的段错误。

我最终将我正在执行的堆栈分配量减少到 256 KiB，从而解决了这个问题。我的理由是 make 可能正在执行该进程，因此它继承了一些奇怪的参数，允许它使用更多的堆栈空间。

虽然现在一切都很好，但我无法检验我的理论。任何人都可以确认或否认，或建议某种测试方式吗？

* zsh、vim、gcc、gdb 和一些疯狂的 makefile

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T19:17:21.017

您可以尝试使用[ulimit(1)](http://linux.die.net/man/1/ulimit)设置最大堆栈大小，看看它是否有效：

```
# Limit stack to 1024 KiB
ulimit -s 1024; ./myprogram
# Now no limit
ulimit -s unlimited; ./myprogram 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T19:26:48.467

就个人而言，我的第一步是尝试使用 gdb 或调试`printf`s 或其他任何方式来定位代码中发生段错误的位置。（这就是为什么您总是检查 malloc 的返回值的原因，它减少了可能的段错误来源；-p）一方面，找到问题的确切来源可以为您提供支持或反对您的堆栈分配理论的证据；此外，它还可以让您插入错误检查代码，以便程序可以优雅地退出并提供信息丰富的错误消息而不是段错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T19:18:27.643

需要更多信息来诊断。也就是说，很高兴看到您正在使用的 makefile 和 shell 脚本。

# gesture-recognition - 多点触控环境中的手势识别使用了哪些方法/算法？

> ID：663620
> 
> 赞同：18
> 
> 时间：2009-03-19T19:13:54.657
> 
> 标签：gesture-recognition, wiimote

在多点触控环境中，手势识别是如何工作的？使用哪些数学方法或算法来识别或拒绝可能手势的数据？

我制作了一些反光手套和一个红外 LED 阵列，以及一个 Wii 遥控器。Wii 遥控器进行内部斑点检测并跟踪 4 个红外光点，并通过蓝牙加密狗将此信息传输到我的计算机。

这是基于[Johnny Chung Lee 的 Wii 研究](http://johnnylee.net/projects/wii/)。[我的精确设置和这里](http://www.cs.rug.nl/~isenberg/VideosAndDemos/Vlaming2008PTI)展示的荷兰研究生完全一样。我可以轻松地在 2d 空间中跟踪 4 个点的位置，并且我已经编写了我的基本软件来接收和可视化这些点。

![替代文字](https://i.stack.imgur.com/7B3JO.png)![替代文字](https://i.stack.imgur.com/ZSGnQ.png)![替代文字](https://i.stack.imgur.com/XF5Lx.png)

荷兰学生从他们基本的捏点击识别中获得了很多功能。如果可以的话，我想更进一步，并实现一些其他手势。

手势识别通常是如何实现的？除了任何琐碎的事情之外，我如何编写软件来识别和识别各种手势：各种滑动、圆周运动、字母追踪等。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T19:20:15.453

正如我所见，手势识别通常是使用类似于图像识别软件的机器学习技术来实现的。 [这是关于在 c# 中进行鼠标手势识别的 codeproject 上的一个很酷的项目](http://www.codeproject.com/KB/recipes/cmgblade.aspx)。我确信这些概念非常相似，因为您可以将问题减少到 2D 空间。如果你得到一些与此相关的东西，我很乐意看到它。伟大的项目理念！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-19T19:45:42.023

一种看待它的方法是作为压缩/识别问题。基本上，您想要获取一大堆数据，丢弃大部分数据，然后对剩余部分进行分类。如果我这样做（从头开始），我可能会进行如下操作：

*   使用滚动历史窗口
*   取起始帧中四个点的重心，保存，然后从所有帧的所有位置中减去它。
*   将每一帧分解为两个部分：星座的形状和它的 CofG 相对于最后一帧的移动。
*   也保存最后一帧的绝对 CofG
*   一系列 CofG 更改为您提供滑动、波浪等。
*   星座变形系列给你带来压力，等等。

看到你的照片后（*每手*两点，而不是四点，多哈！）我将上面的修改如下：

*   对对进行 CofG 计算，需要注意的是：
    *   如果有四个点可见，则选择对以最小化对内距离的乘积
    *   如果有三个点可见，最近的两个是一对，另一个是另一个
    *   需要时使用前/后帧覆盖
*   不是星座，而是距离/方向对的嵌套结构（即，双手之间有一个 D/O，每只手有一个 D/O）。
*   将完整的简化数据传递给每个手势的识别器，让他们整理出他们关心的内容。
*   如果你想变得可爱，做一点 DSL 来识别模式，然后写如下内容：

    ```
    fire when
        in frame.final: rectangle(points) 
      and
        over frames.final(5): points.all (p => p.jerk) 
    ```

    或者

    ```
    fire when
        over frames.final(3): hands.all (h => h.click) 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T05:13:11.073

如果有人感兴趣，可以看一下这种技术所做的事情的视频吗？

[Pattie Maes 演示第六感 - TED 2009](http://www.ted.com/index.php/talks/pattie_maes_demos_the_sixth_sense.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T09:02:17.537

我看过的大多数简单的手势识别工具都使用基于矢量的模板来识别它们。例如，您可以将向右滑动定义为“0”，将复选标记定义为“-45, 45, 45”，将顺时针圆圈定义为“0, -45, -90, -135, 180, 135, 90, 45, 0”等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T05:03:02.143

Err.. 过去一年左右我一直在研究手势识别，但我不想说太多，因为我正在尝试为我的技术申请专利 :) 但是......我们有一些运气使用自适应提升，尽管你所做的看起来根本不同。你只有 4 个数据点要处理，所以我认为你真的不需要“减少”任何东西。

我要研究的是像 Flash 这样的程序如何将手绘的圆圈变成一个实际的圆圈。似乎您可以在大约一秒钟的时间内跟踪这些点，然后以某种方式“平滑”路径，然后您可能可以通过硬编码您的手势（如果您使它们足够简单）而逃脱。否则，是的，您将需要使用学习算法。神经网络可能会起作用……我不知道。只是抛出想法 :) 也许看看[OCR](http://en.wikipedia.org/wiki/Optical_character_recognition)是如何完成的......甚至是[霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)。在我看来，这是一个识别形状的问题，而不是识别手势的问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-21T04:11:22.893

我不太精通这类数学，但我在某处读到人们有时使用[马尔可夫链](http://en.wikipedia.org/wiki/Markov_chain)或[隐马尔可夫模型](http://en.wikipedia.org/wiki/Hidden_Markov_model)来进行手势识别。

也许在计算机科学这一方面有更多背景的人可以进一步阐明它并提供更多细节。

# c++ - C++ 中共享库主头文件的最佳实践是什么？

> ID：663624
> 
> 赞同：3
> 
> 时间：2009-03-19T19:14:43.860
> 
> 标签：c++, header, shared-libraries

当我创建共享库时，我在库源的根目录中有一个与库同名的头文件（但没有文件扩展名）。

例如，如果我的库名为 libirock.so，那么我将在项目根目录中有一个名为 irock 的文件。该文件将包含库中所有最重要的头文件，因此当要实现库时，您需要做的就是使用以下包含行：

```
#include <irock> // Instead of <irock.h> 
```

当我看到类似于以下内容的编译器警告时，我得到了这个想法：

```
#include <string.h> is obsolete, use #include <string> instead 
```

两个问题：

1.  是使用 irock 代替 irock.h 的最佳实践吗？
2.  使用单个头文件而不是多个头文件是否正确？

**行动方针**

感谢您的回答！根据答案，我决定：

1.  将使用`<irock.h>`而不是`<irock>`.
2.  我将继续使用“主要”头文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T19:21:06.980

一句话，没有。您需要明确使用 irock.h

有了扩展名，很明显这是一个头文件，任何使用基于文件扩展名的文件的应用程序都将正确地知道如何解释你的头文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T19:20:43.207

不， <header> 而不是 <header.h> 习语应该仅用于标准库（和标准模板库）标头。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T19:30:23.840

标准中没有关于文件名扩展的“允许”、“禁止”或“最佳实践”。

使用您喜欢的任何形式。在某些平台上，为注册类型提供文件扩展名是一个便利因素。

对于它的价值`<string.h>`和`<string>`完全不同的标题。C++ 命名空间等价物`<string.h>`实际上是`<cstring>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T19:24:04.913

#include 只是将给定文件名的内容放入实际文件中。因此，如果您在没有文件扩展名的情况下感觉更好，那就去做吧。

当然，文件扩展名具有有用的语义含义。此外，在大多数用户心目中，没有扩展名的包含文件与标准库相关联。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T19:37:40.187

Qt4中使用的是，您可以通过“类名”包含文件名，例如

```
#include <QString>
#include <QWidget>
#include <QPainter>
#include <QApplication>
#include <QCoreApplication> 
```

这些包含是虚拟包含，它将包含正确的标题。在现实生活中，您会看到在单个 include.h 中定义了多个类，并且您将该文件包含了两次。

再次使用不带“.h”的版本的一个原因是，您会很想使用包含 camelCase（或 PascalNotation）的内容，*如果*您将代码从 windows 移动到 unix（linux 或 mac），您通常会遇到问题。做起来并不难——但你确实需要注意正确地做。

# java - 在 Java 上将二维数组（数字）转换为维数组，反之亦然

> ID：663632
> 
> 赞同：1
> 
> 时间：2009-03-19T19:17:29.207
> 
> 标签：java, arrays

我现在需要帮助。我需要将二维数字数组转换为 Java 中的一维数组。谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:27:03.177

你的意思是这样的吗？

```
import java.util.*; 

public class Test {
    public static void main(String[] args) {
        String[][] data = new String[][] {
            { "Foo", "Bar" },
            { "A", "B" }
        };

        String[] flattened = flatten(data);

        for (String x : flattened) {
            System.out.println(x);
        }
    }

    public static <T> T[] flatten(T[][] source) {
        int size = 0;
        for (int i=0; i < source.length; i++) {
            size += source[i].length;
        }

        // Use the first subarray to create the new big one
        T[] ret = Arrays.copyOf(source[0], size);
        int index = source[0].length;
        for (int i=1; i < source.length; i++) {
            System.arraycopy(source[i], 0, ret, index, source[i].length);
            index += source[i].length;
        }
        return ret;
    }

} 
```

如果你想要它用于原始类型，你必须为每个原始类型编写一个重载，但你可以在那个时候使用`new int[size]`而不是。`Arrays.copyOf`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-28T08:56:35.317

Java 8 解决方案可能如下所示：

```
import java.util.stream.Stream;

public class ArrayConverter {

public static String[] flatten(String[][] array) {
    // Create a stream of the given array
    return Stream.of(array)
            // Map each of its elements to a stream (thus creating a
            // one-dim-array inside the stream, so to say)
            .flatMap(Stream::of)
            // Retrieve the stream as array, explicitly calling String to
            // keep the type
            .toArray(size -> new String[size]);
}

} 
```

在这个示例中，我有意识地省略了泛型类型，因为它使数组初始化有些混乱。让我知道你是否需要它。

尤其; 如果要将此转换用于原始类型的数组，则应使用 Stream 类的相应平面方法。例如，如果您使用的是 int-Arrays，请使用：

```
Stream.flatMapToInt(...) 
```

用实际的原始 int-Values检索一个`IntStream`，从而避免自动装箱到`Integer`对象中。

[Stream 的 JavaDoc 供参考](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#flatMap-java.util.function.Function-)

# c# - 在 .NET MVC 页面中设置的 IE（6 和 7）iFrame 查询字符串参数不起作用，似乎已被剥离，但在页面源中显示

> ID：663633
> 
> 赞同：0
> 
> 时间：2009-03-19T19:17:30.483
> 
> 标签：c#, asp.net-mvc, internet-explorer, iframe

我们正在使用 .NET MVC，并且我们正在尝试动态（通过控制器）设置 iFrame 的 URL。这在 FireFox 和 Chrome 上运行良好，但不适用于 Ie。在即只有第一个案例站点允许用户正确登录。v10 和 v9 站点没有。所有站点都使用查询字符串参数登录。它们的源看起来像这样（IE 中的源不成功） - 没有明显的区别。

*   此外，我们尝试了整个 IE7 安全设置已启用以导航到另一个域中的框架 - 这不是问题；它仍然不起作用。也不适用于IE6。结果与下面的屏幕截图相同。

*   Html Encoding 也没有工作（未显示，但尝试过）。

任何想法都会很棒！

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1"><title>

</title>
<style type="text/css">
        td  {
              font-family: Arial;
              font-size: small;
        }
  </style>
</head>
<body>
<form action="/Account/Navigate" method="post">
    <table style="align: right; width: 100%;">
        <tr>
            <td align="right">
                <input type="submit" name="butSubmit" value="WN" />&nbsp;

                    <input type="submit" name="butSubmit" value="MyDg" />

                    <input type="submit" name="butSubmit" value="V9" />

             </td>
        </tr>
    </table>

        <iframe id="displayFrame" src="http://my.totallyinsecuretopostthis.com/Login.aspx?&uname=sdavis&pword=04ab" style="width: 100%; height: 95%;"></iframe>
    </form>
</body>
</html> 
```

* * *

IE7成功源码：

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1"><title>

</title>
<style type="text/css">
            td  {
                    font-family: Arial;
                    font-size: small;
            }
    </style>
</head>
<body>
<form action="/Account/Navigate" method="post">
    <table style="align: right; width: 100%;">
        <tr>
            <td align="right">
                <input type="submit" name="butSubmit" value="WN" />

                    <input type="submit" name="butSubmit" value="MyDg" />

                    <input type="submit" name="butSubmit" value="V9" />

             </td>
        </tr>
    </table>

        <iframe id="displayFrame" src="http://www.totallyinsecuretopostthis.com/users/428/login/700bc1c8d837f30fdbc03cfc03b58c02" style="width: 100%; height: 95%;"></iframe>
    </form>
</body>
</html> 
```

* * *

代码片段（第一个视图，然后是控制器）：

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<SingleSignOnUser>" %>
<%@ Import Namespace="Wingnut.Data.Model"%>

<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1" runat="server">
<title></title>
<style type="text/css">
    td  {
        font-family: Arial;
        font-size: small;
    }
</style>
</head>
<body>
<% using (Html.BeginForm("Navigate", "Account", FormMethod.Post)) { %>
    <% TempData["username"] = Model.WingnutUserEmail; %>
    <% TempData["password"] = Model.PasswordHash; %>
    <table style="align: right; width: 100%;">
        <tr>
            <td align="right">
                <!-- always display this, but when click, make sure you are authenticated; else, prompt for correct 
                 wingnut password -->
                <input type="submit" name="butSubmit" value="WN" />&nbsp;
                <% if (Model.IsV10User()) { %>
                    <input type="submit" name="butSubmit" value="MyDg" />
                <% } %>
                <% if (Model.IsV9User()) { %>
                    <input type="submit" name="butSubmit" value="V9" />
                <% } %>
             </td>
        </tr>
    </table>
    <% string url = ViewData["iFrameURL"].ToString(); %>
    <% if (ViewData["iFrameURL"].ToString() != "popup") { %>
        <iframe id="displayFrame" src="<%=ViewData["iFrameURL"]%>" style="width: 100%; height: 95%;"></iframe>
    <% } %> 
```

（现在是控制器代码：）

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Navigate(string butSubmit) {
    _service = new SSOUserService();
    SingleSignOnUser wnUser = _service.GetValidUser(TempData["username"].ToString(), TempData["password"].ToString());

    ViewData["iFrameURL"] = "http://www.usatoday.com";

    try {
        //if you are supposed to bypass the intersect page...
        if (wnUser != null) {
            switch (butSubmit) {
                case "WN":
                    if (wnUser.IsWingnutUser())
                        ViewData["iFrameURL"] = string.Format("http://www.totallyinsecuretopostthis.com/users/{0}/login/{1}", wnUser.WingnutId, wnUser.WingnutToken);
                    else {
                        // do popup to capture this person's correct, but uncaptured, Wingnut password
                        // try to authenticate, if can, save, and proceed
                        // else, give error message / popup finally
                        ViewData["iFrameURL"] = "popup";
                        ViewData["popupText"] = "Oops. During the Totallyinsecuretopostthis's recent Single Sign On effort, we require that you enter your Totallyinsecuretopostthis" +
                            "password for us here one time only for authentication to SomePlace:";
                    }
                    break;

                case "MyDg":
                    if (wnUser.IsV10User()) {
                        ViewData["iFrameURL"] =
                            string.Format(@"http://my.totallyinsecuretopostthisv10.com/Login.aspx?&uname={0}&pword={1}",
                                          wnUser.V10UserCredentials.LoginName,
                                          wnUser.V10UserCredentials.Password);
                    }
                    break;

                case "V9":
                    if (wnUser.IsV9User()) {
                        ViewData["iFrameURL"] =
                            string.Format(
                                @"https://login.totallyinsecuretopostthisv9.com/clients/OtherPages/ExternalSignIn.aspx?UserName={0}&Password={1}",
                                wnUser.V9UserCredentials.LoginName, wnUser.V9UserCredentials.Password);
                    }
                    break;
            }
        }
    }

    catch (Exception ex) {
        ModelState.AddModelError("Errors", ex.Message);
    }

    return View("Navigation", wnUser);
} 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T14:15:54.037

最后我找到了一个 hack / 解决方案——我从来没有让 iFrame src="mystring" 工作，但我确实创建了一个 hack。B/c 我们试图导航到的站点，我们拥有；所以在那个网站上，我们创建了一个“镜像”页面。页面看起来相同

1 - 我的原始页面有 iFrame，但我没有 HREF，当你点击去我最初想要的地方时......

2 - 您点击了该登录页面，并已登录...但我在此登录页面中添加了查询字符串参数（我们也拥有此站点），如果 sso=true，并且您已通过身份验证，您将被重定向到...

3 - 站点 B 上的一个页面，其 iFrame 看起来与第 1 步中的页面相同。

这是一种技巧，还有很多工作要做，但它“有效”，并且是我们最终可以创造的最适合用户体验的方法。

***感谢提供答案的人以及任何寻找答案的人。我非常感谢您的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T19:21:46.823

用于`HttpUtility.HtmlAttributeEncode`对 URL 中的 & 符号进行编码：

```
ViewData["iFrameUrl"] = HttpUtility.HtmlAttributeEncode( string.Format( ... ) ); 
```

我建议`<a>`在视图中渲染标签时这样做，而不是在控制器中硬编码它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T17:59:05.430

这与查询字符串开头的“？&”无关？

试试看： http://my.totallyinsecuretopostthis.com/Login.aspx?uname=sdavis&pword= [04ab](http://my.totallyinsecuretopostthis.com/Login.aspx?uname=sdavis&pword=04ab)

# c# - 在 Web 服务 (WSE) 中公开自定义类型（类）

> ID：663634
> 
> 赞同：1
> 
> 时间：2009-03-19T19:17:48.877
> 
> 标签：c#, .net, web-services, wse

如果我的 Web 服务中有自定义类型（类），是否必须使用特殊属性进行标记才能正确序列化它们？

即 [SomeAttribute] ？

**更新** 我目前正在使用 WSE

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T01:04:17.967

过时的 WSE 使用 XmlSerializer。它应该序列化具有默认构造函数的类型的大多数公共读/写属性。有关更多详细信息，请查看 XmlSerializer。

并尽快从 WSE 转换为 WCF，因为 WSE 已过时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T19:20:38.760

如果您默认使用 Data Contract 序列化程序，则不会对任何内容进行序列化——这与旧的 XmlSerializer 正好相反——它是旧的 asmx Web 服务方法。

对于 WCF，请查看初学者的 DataContractAttribute：[链接文本](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.aspx)

# c# - 在 C# webservice 中使用 NameValueCollection 不会给出 XML 可序列化错误

> ID：663654
> 
> 赞同：7
> 
> 时间：2009-03-19T19:21:59.553
> 
> 标签：c#, dictionary, xml-serialization, asmx

当我尝试向我的 ASMX 代理项目“添加 Web 引用”时收到此错误消息：

```
**"To be XML serializable, types which inherit from ICollection must have an    implementation of Add(System.String) at all levels of their inheritance hierarchy. System.Collections.Specialized.NameValueCollection does not implement Add(System.String)"** 
```

我需要将名称-值对传递给我的 Web 服务，这就是我想出的：

```
public class FileService : System.Web.Services.WebService
{

    [WebMethod]
    public string UploadFile(byte[] incomingArray
        , string FileName
        , long FileLengthInBytes
        , NameValueCollection nvcMetaData) 
```

我现在意识到我需要帮助来改变这一点（我是 C# 和 .Net 框架的这一部分的新手）。如果我可以让它工作，我的 Web 服务将需要由 ColdFusion 调用（现在我正在使用 .aspx 页面来调用 Web 服务）。因此，无论我想出什么方法来传递可变数量的 NAME-VALUE 对，我都需要它可以被 CF 调用。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T19:53:29.493

作为替代方案，您可以只定义一个简单的 NameValue 类并接收一个数组。

```
public class NameValue
{
   public string Name{get;set;}
   public string Value{get;set;}
}

[WebMethod]
public string UploadFile(byte[] incomingArray
    , string FileName
    , long FileLengthInBytes
    , NameValue[] nvcMetaData) 
```

如果在客户端你有一个 NameValueCollection 你可以很容易地映射到你的类型。检查我在这个[问题中发布的示例](https://stackoverflow.com/questions/663416/populate-array-of-objects-from-namevaluecollection-in-c/663441#663441)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T19:26:06.877

不幸的是，所有 .NET 库字典结构都不可序列化。我听说过关于[这段代码](http://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx)的好消息——也许这会有所帮助。

基本上，您将对我链接的代码执行的操作是创建一个具有自定义序列化方法的新类型，该方法允许您将字典序列化为 XML。如果这是您选择的路线，最好在其自己的程序集中编译此类型，以便您可以与服务的客户端共享该程序集，这样它就可以用作服务方法的参数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-11-30T21:57:46.380

如果您使用 object 作为类型，ScriptService 将自动/秘密地将其序列化为字典，供您使用，如下所示：

```
[WebMethod, ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public object MyServiceMethod(int recordid, object data)
{
   Dictionary<String, Object> noway = (Dictionary<String, Object>)data;
   // ...
   return noway; 
```

}

# c# - TreeNode Image Overlay

> ID：663657
> 
> 赞同：3
> 
> 时间：2009-03-19T19:22:26.743
> 
> 标签：c#, treeview, treenode

I have an imagelist of about 30 images, and 3 images I'd like to be able to overlay on top of the 30 when a TreeNode is in a particular state. I know that a C++ TreeItem can do this with the TVIS_OVERLAYMASK as such:

```
SetItemState(hItem,INDEXTOOVERLAYMASK(nOverlayIndex), TVIS_OVERLAYMASK); 
```

Is there any mechanism to achieve similar results in .NET?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-30T17:08:10.643

I see this question is still getting views, so I'll post the implementation of what David suggested.

```
internal class MyTree : TreeView
{
    internal MyTree() :
        base()
    {
        // let the tree know that we're going to be doing some owner drawing
        this.DrawMode = TreeViewDrawMode.OwnerDrawText;
        this.DrawNode += new DrawTreeNodeEventHandler(MyTree_DrawNode);
    }

    void MyTree_DrawNode(object sender, DrawTreeNodeEventArgs e)
    {
        // Do your own logic to determine what overlay image you want to use
        Image overlayImage = GetOverlayImage();

        // you have to move the X value left a bit, 
        // otherwise it will draw over your node text
        // I'm also adjusting to move the overlay down a bit
        e.Graphics.DrawImage(overlayImage,
            e.Node.Bounds.X - 15, e.Node.Bounds.Y + 4);

        // We're done! Draw the rest of the node normally
        e.DefaultDraw = true
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-03T22:19:27.497

Why don't you just generate the image with the overlay on demand even, so you don't have to waste precious CPU cycles like this: [http://madprops.org/blog/highlighting-treenodes-with-an-overlay-image/](http://madprops.org/blog/highlighting-treenodes-with-an-overlay-image/) :

```
private void InitializeLinkedTreeImages() 
{ 
    foreach (string key in treeImages.Images.Keys) 
    { 
        Bitmap bmp = new Bitmap(treeImages.Images[key]); 
        Graphics g = Graphics.FromImage(bmp); 
        g.DrawImageUnscaled(Properties.Resources.Linked16, 0, 0); 
        treeImages.Images.Add(key + "Linked", bmp); 
    } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T19:29:24.137

I don't know of a way to do the overlay automatically, but you could do this with an owner drawn tree node.

# java - 基于 Linux OpenJDK Debian 的发行版的 JAVA_HOME 环境变量的正确目标是什么？

> ID：663658
> 
> 赞同：92
> 
> 时间：2009-03-19T19:23:06.897
> 
> 标签：java, grails, java-home, debian-based

在 Windows 中，`JAVA_HOME`必须指向 JDK 安装文件夹（以便`JAVA_HOME/bin`包含所有可执行文件并`JAVA_HOME/libs`包含所有默认`jar`库）。

如果我下载 Sun 的 JDK 包并将其安装在 Linux 中，则过程相同。

但是，我需要使用 Kubuntu 的默认 OpenJDK 包。问题是所有可执行文件都放在`/usr/bin`. 但是罐子放在`/usr/share/java`. 由于它们不在同一个`JAVA_HOME`文件夹下，我在使用 Grails 时遇到了问题，并且可能会遇到其他需要标准 Java 结构的应用程序的问题。

1.  如果我使用：

    ```
    JAVA_HOME=/usr 
    ```

    所有想要使用任何 Java 可执行文件的应用程序和脚本都可以使用标准过程`call $JAVA_HOME/bin/executable`。然而，由于罐子在不同的地方，它们并不总是被找到（例如：在 grails 我得到`ClassDefNotFound`了`native2ascii`）。

2.  另一方面，如果我使用：

    ```
    JAVA_HOME=/usr/share/java 
    ```

    找不到任何 Java 可执行文件（`java`、等）。`javac`

那么，`JAVA_HOME`在基于 Debian 的 Linux 中处理变量的正确方法是什么？

谢谢你的帮助，路易斯

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-03-19T19:39:42.990

最终对我有用的东西（Grails 现在运行顺利）几乎就像 Steve B. 指出的那样：

```
JAVA_HOME=/usr/lib/jvm/default-java 
```

这样，如果用户更改了系统的默认 JDK，`JAVA_HOME`仍然可以使用。

`default-java`是当前 JVM 的符号链接。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2012-07-18T13:50:50.523

如果您使用替代方法来管理多个 java 版本，您可以设置`JAVA_HOME`基于符号链接的 java（或 javac），如下所示：

```
export JAVA_HOME=$(readlink -f /usr/bin/java | sed "s:bin/java::") 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-19T19:32:36.017

标准的 Ubuntu 安装似乎将各种 Java 版本放入`/usr/lib/jvm`. 您在路径中找到的`javac`, java 将软链接到此。

只要您设置`JAVA_HOME`环境变量并确保`bin`在您的路径上有新的 Java，在您喜欢的任何地方安装您自己的 Java 版本都没有问题。

一个简单的方法是让 Java 主目录作为软链接存在，这样如果您想升级或切换版本，您只需更改 this 指向的目录 - 例如：

```
/usr/bin/java --> /opt/jdk/bin/java,

/opt/jdk --> /opt/jdk1.6.011 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-02T21:14:18.173

我修改了上面的解决方案之一，无论 java 安装在哪里，只要它在您的 PATH 中，这似乎都有效。

```
JAVA_HOME=$( j=$( readlink -f $(which java) ) ; echo ${j%%/bin/java} ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T19:28:10.613

我通常没有任何 JAVA_HOME 环境变量。Java 可以自行设置。内部 java java.home 系统属性应该可用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T20:01:05.310

尝试设置 JAVA_LIB 变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-14T15:53:02.463

如果您遇到找不到 JAR 文件的问题，我还会确保您的 CLASSPATH 设置为包含这些文件的位置。但是，我确实发现 CLASSPATH 通常需要为不同的程序设置不同的设置，并且通常最终会成为为单个程序唯一设置的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-12T06:50:41.347

可以在此处找到可以解决您的问题的更新答案以及在 Ubuntu 上安装 Oracle Java 7 的一般好方法：http: [//www.wikihow.com/Install-Oracle-Java-on-Ubuntu-Linux](http://www.wikihow.com/Install-Oracle-Java-on-Ubuntu-Linux)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-16T18:48:22.153

我发现 Ubuntu 中的 openjdk-6-jre 和 openjdk-6-jre-headless 软件包存在类似问题。

通过清除 openjdk-6-jre 和 openjdk-6-jre-headless 软件包并重新安装，我的问题得到了解决。替代方案仅在全新安装 openjdk-6-jre 和 openjdk-6-jre-headless 软件包时更新。

以下是清除后的安装示例：

```
aptitude purge openjdk-6-jre openjdk-6-jre-headless # to ensure no configuration exists
aptitude install --without-recommends openjdk-6-jre # Installing without some extras
Reading package lists... Done
Building dependency tree
Reading state information... Done
Reading extended state information
Initializing package states... Done
The following NEW packages will be installed:
  ca-certificates-java{a} java-common{a} libavahi-client3{a} libavahi-common-data{a} libavahi-common3{a} libcups2{a} libflac8{a} libgif4{a} libnspr4-0d{a} libnss3-1d{a} libogg0{a} libpulse0{a} libsndfile1{a} libvorbis0a{a} libvorbisenc2{a} libxi6{a} libxtst6{a}
  openjdk-6-jre openjdk-6-jre-headless{a} openjdk-6-jre-lib{a} tzdata-java{a}
The following packages are RECOMMENDED but will NOT be installed:
  icedtea-6-jre-cacao icedtea-netx ttf-dejavu-extra
0 packages upgraded, 21 newly installed, 0 to remove and 119 not upgraded.
Need to get 0B/34.5MB of archives. After unpacking 97.6MB will be used.
Do you want to continue? [Y/n/?]
Writing extended state information... Done
Selecting previously deselected package openjdk-6-jre-lib.
(Reading database ... 62267 files and directories currently installed.)
Unpacking openjdk-6-jre-lib (from .../openjdk-6-jre-lib_6b24-1.11.5-0ubuntu1~10.04.2_all.deb) ...
...
Processing triggers for man-db ...
Setting up tzdata-java (2012e-0ubuntu0.10.04) ...
...
Setting up openjdk-6-jre-headless (6b24-1.11.5-0ubuntu1~10.04.2) ...
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/java to provide /usr/bin/java (java) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/keytool to provide /usr/bin/keytool (keytool) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/pack200 to provide /usr/bin/pack200 (pack200) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/rmid to provide /usr/bin/rmid (rmid) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/rmiregistry to provide /usr/bin/rmiregistry (rmiregistry) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/unpack200 to provide /usr/bin/unpack200 (unpack200) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/orbd to provide /usr/bin/orbd (orbd) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/servertool to provide /usr/bin/servertool (servertool) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/tnameserv to provide /usr/bin/tnameserv (tnameserv) in auto mode.
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/lib/jexec to provide /usr/bin/jexec (jexec) in auto mode.
Setting up openjdk-6-jre (6b24-1.11.5-0ubuntu1~10.04.2) ...
update-alternatives: using /usr/lib/jvm/java-6-openjdk/jre/bin/policytool to provide /usr/bin/policytool (policytool) in auto mode.
... 
```

您可以在上面看到`update-alternatives`运行以设置各种 Java 二进制文件的链接。

在此安装之后，还有 中的链接、中的`/usr/bin`链接`/etc/alternatives`和中的每个二进制文件的文件`/var/lib/dpkg/alternatives`。

```
ls -l /usr/bin/java /etc/alternatives/java /var/lib/dpkg/alternatives/java
lrwxrwxrwx 1 root root  40 2013-01-16 14:44 /etc/alternatives/java -> /usr/lib/jvm/java-6-openjdk/jre/bin/java
lrwxrwxrwx 1 root root  22 2013-01-16 14:44 /usr/bin/java -> /etc/alternatives/java
-rw-r--r-- 1 root root 158 2013-01-16 14:44 /var/lib/dpkg/alternatives/java 
```

让我们将其与不清除的安装进行对比。

```
aptitude remove openjdk-6-jre
aptitude install --without-recommends openjdk-6-jre
Reading package lists... Done
Building dependency tree
Reading state information... Done
Reading extended state information
Initializing package states... Done
The following NEW packages will be installed:
  ca-certificates-java{a} java-common{a} libavahi-client3{a} libavahi-common-data{a} libavahi-common3{a} libcups2{a} libflac8{a} libgif4{a} libnspr4-0d{a} libnss3-1d{a} libogg0{a} libpulse0{a} libsndfile1{a} libvorbis0a{a} libvorbisenc2{a} libxi6{a} libxtst6{a}
  openjdk-6-jre openjdk-6-jre-headless{a} openjdk-6-jre-lib{a} tzdata-java{a}
The following packages are RECOMMENDED but will NOT be installed:
  icedtea-6-jre-cacao icedtea-netx ttf-dejavu-extra
0 packages upgraded, 21 newly installed, 0 to remove and 119 not upgraded.
Need to get 0B/34.5MB of archives. After unpacking 97.6MB will be used.
Do you want to continue? [Y/n/?]
Writing extended state information... Done
Selecting previously deselected package openjdk-6-jre-lib.
(Reading database ... 62293 files and directories currently installed.)
Unpacking openjdk-6-jre-lib (from .../openjdk-6-jre-lib_6b24-1.11.5-0ubuntu1~10.04.2_all.deb) ...
...
Processing triggers for man-db ...
...
Setting up openjdk-6-jre-headless (6b24-1.11.5-0ubuntu1~10.04.2) ...

Setting up openjdk-6-jre (6b24-1.11.5-0ubuntu1~10.04.2) ...
... 
```

如您所见，`update-alternatives`未触发。

安装后， 中没有 Java 二进制文件的文件， 中`/var/lib/dpkg/alternatives`没有链接`/etc/alternatives`， 中也没有链接`/usr/bin`。

中的文件的删除`/var/lib/dpkg/alternatives`也会中断`update-java-alternatives`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-06T23:51:56.180

Ubuntu 12.04 这工作...

JAVA_HOME=/usr/lib/jvm/java-6-openjdk-i386/jre

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-06T21:05:14.423

作为 fedora 用户的更新，替代方法将当前 java 目录设置为 /usr/java/default

所以你必须将你的 JAVA_HOME 设置为 /usr/java/default 以在你的类路径中总是有替代的当前选择

！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-11-21T10:23:11.340

我总是倾向于根据`/usr/bin/java`.

```
JAVA_HOME="$(dirname -- "$(dirname -- "$(readlink -f /usr/bin/java)")")" 
```

这样，两种选择都指向同一个位置

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-03-19T19:47:54.873

请查看 update-alternatives 命令的作用（它有一个好人......）。

很快 - 当你有 java-sun-1.4 和 java-opensouce-1.0 时会发生什么......哪个需要“java”？它 debian "/usr/bin/java" 是符号链接，而 "/usr/bin/java-sun-1.4" 是 "/usr/bin/java" 的替代品

编辑：正如理查德所说，`update-alternatives`这还不够。您实际上需要使用`update-java-alternatives`. 更多信息在：

[https://help.ubuntu.com/community/Java](https://help.ubuntu.com/community/Java)

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-03-20T10:51:49.177

据我记得，我使用的是 update-java-alternatives 脚本而不是 update-alternatives。它确实为我正确设置了 JAVA_HOME。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-03-19T19:26:36.813

我的正确目标一直是从 Sun 下载它并以这种方式安装。然后你就知道所有东西都在哪个目录下。

但是，如果您更喜欢 Debian 安装它的奇怪方式，我最好的猜测是 java 和 javac 二进制文件所在的父目录。

（因为当您在路径中指定它时，它是 $JAVA_HOME/bin）（所以在您的情况下，它将是 ... $JAVA_HOME/share 和 $JAVA_HOME 将是 /usr ？）

呃，好像不太对...

我也有兴趣听到这个问题的答案！

# javascript - 如何通过javascript拖放避免闪烁效果

> ID：663661
> 
> 赞同：1
> 
> 时间：2009-03-19T19:24:21.387
> 
> 标签：javascript, jquery, drag-and-drop

我使用以下 javascript（使用 jQuery）来处理我正在编写的脚本上的拖放：

```
jsc.ui.dragging = false;
jsc.ui.drag_element = {};
$(".drag-target").mousedown(function() {
    jsc.ui.drag_element =  $(this);
    jsc.ui.dragging = true;
});
$("html").mousemove(function(e) {
    if(jsc.ui.dragging) {
        jsc.ui.drag_element.css({"position": "absolute", "top": e.clientY - 1, "left": e.clientX - 1, "z-index": "100"}); // - 1s are due to IE not leaving go otherwise
        $("#overlay").show(); // Overlay stops text beneath being selected. TODO Stop current elements text being selected.
    }
});
$(".drag-target").mouseup(function() {
    if(jsc.ui.dragging) {
        jsc.ui.dragging = false;
        jsc.ui.drag_element.css("z-index", "98");
        $("#overlay").hide();
    }
}); 
```

然而，当对象被拖动时，它里面的文本有一个闪烁的选择，即当元素移动时它被选中和关闭。有什么办法可以防止这种情况发生，或者隐藏它的影响吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T19:42:35.667

有没有理由不使用[jQuery UI Draggable](http://docs.jquery.com/UI/Draggable)？您的代码将如下所示：

```
$(".drag-target").draggable(); 
```

您至少应该检查它的构建方式，它可以帮助您解决闪烁问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T19:32:28.887

我认为效果的程度取决于您的硬件和视频驱动程序。为了完全避免它，您可以只绘制一个矩形，然后在释放鼠标按钮时重新绘制窗口。

# .net - 如何使用 .Net 构建安全的 Web 服务？

> ID：663664
> 
> 赞同：8
> 
> 时间：2009-03-19T19:25:15.490
> 
> 标签：.net, web-services, security, vbscript, ws-security

我需要构建一个简单的 Web 服务来通过 Internet 将数据输入和输出 HR 系统（这是一个托管解决方案）。我将 IIS 和 ASP.Net 与 .Net 2.0 一起使用。

经过研究，有几种方法可以确保 Web 服务的安全 - 我正在就选择哪种方法提出一些建议，并对优缺点提出一些看法。

这些是我知道的方法：

## 基于 SSL 的 SoapHeaders

在 Soap 标头中发布 UID/PWD 并实现 SOAP 扩展（[链接](https://stackoverflow.com/questions/130427/call-a-certain-method-before-each-webservice-call)）。
实现起来非常简单，并且通过 SSL 应该非常安全。由于相对简单，这是迄今为止我的首选选择。此外，由于历史原因，我需要从 VBScript 中使用 Web 服务，因此能够处理简单的 SOAP 是一个额外的好处。 *但是，有什么注意事项吗？我会让客户抱怨这是一个安全风险吗？*

## 将 WCF 与 TransportWithMessageCredential 一起使用

我发现很多旧文章都提到了 WS，如果我没记错的话，这就是 WCF 现在提供的吗？[这个微软链接](http://msdn.microsoft.com/en-us/library/ms789011.aspx)有一个入门。
如果我理解正确，这将在客户端和服务器之间使用基于证书的安全性进行身份验证。这是正确的还是我完全错了？
我怀疑这将是一项更大的工作，至少在实施方面是这样。此外，我将无法直接从 VBScript 访问 Web 服务，因此必须编写一个调用调用的 dll，然后在本地部署它——对吗？
这甚至在.Net 2.0中可用吗？

## 其他方法

*   我可以禁止匿名访问 asmx 文件并使用依赖 IIS 通过质询/响应进行身份验证。这在我的场景中实际上很实用，但感觉非常不优雅（也不知道如何从 VBScript 中实现这一点）。
*   将 UID 传递给方法调用是 SoapHeader 的一个可怜的表亲，所以我不会使用它。

*对于解决此问题的最佳方法的任何建议，我将不胜感激。如果有人对为什么 Soap Headers 是安全的有一个很好的论据，那么我很想听听它，因为这似乎是最简单的使用，只要它“足够安全”*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T19:49:29.330

您应该强烈考虑使用 IIS 和 Windows 来提供身份验证。IIS 可以将传入请求映射到 AD 用户（NTLM、证书、Kerberos 等）。从那里，您将拥有一个[WindowsPrincipal](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsprincipal_members.aspx)，您可以使用它来要求用户在一个组中。如果您不介意将组名编译到代码中，您甚至可以在服务方法上使用[PrincipalPermissionAttribute ，这样它就完全是声明性的。](http://msdn.microsoft.com/en-us/library/system.security.permissions.principalpermissionattribute.aspx)

通过使用 Windows，您可以获得处理所有安全问题的平台。密码不会以纯文本形式传输，您也不需要创建和指定自己的质询/响应类型系统 (yuck)。不同的客户端可以以不同的方式进行身份验证（一些需要证书，另一些则允许 NTLM）。

最后，您将得到更少的代码，因为您可以使用 Windows 来管理用户并使用 .NET Framework 来强制执行安全检查。

**编辑：**

也许您认为保护 ASMX 的安全是 hacky，因为这是您正在查看的唯一步骤？我同意！仅依赖于您拒绝匿名的 Web 服务听起来确实很弱。*身份验证完成后*， Web 服务代码本身应要求组成员身份。这样，如果您错误地配置了服务器，就会使其无法访问，而不是不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:45:38.980

使用 WCF。它需要 .NET 3.0 或更高版本（也可以使用 3.5 SP1），但这只是带有几个服务包和一些新程序集的 .NET 2.0，所以它是安全的。

我建议不要再使用 ASMX Web 服务进行新开发，除非别无选择。

您可能已经阅读过“WSE”或“Web 服务扩展”。这些都是过时的，并且是对 ASMX Web 服务的一系列扩展，用于实现 WS-* 协议集。微软由此了解到ASMX平台的可扩展性不够，因此创建了WCF（Windows Communication Foundation）。像瘟疫一样避免 WSE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T19:35:13.047

上周我遇到了这个问题，我选择了带有 SSL 的 SOAP。我还将它与数据的 MD5 加密密钥结合起来。当然，这仅适用于您同时是服务器和客户端的“所有者”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T19:57:23.993

WCF 是要走的路。它提供了许多可能的安全解决方案，一些基于标准且可互操作，一些特定于 .NET 或 Windows。

快速[搜索“WCF 安全”](http://www.google.com/search?q=wcf+security)将为您提供大量资源，但我建议您从这篇文章开始： Michele Leroux Bustamante[的“WCF 安全基础”](http://www.code-magazine.com/Article.aspx?quickid=0611051)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T00:21:31.703

您还可以尝试使用 IIS 的 2 路 SSL，这将让您确保客户端是他们所说的身份，通过线路加密数据，并根据提供的证书以不同用户身份运行 Web 服务。

# e-commerce - 开源（Linux Hostable）电子商务/店面项目

> ID：663686
> 
> 赞同：0
> 
> 时间：2009-03-19T19:30:53.213
> 
> 标签：e-commerce, storefront

我的公司专注于 Microsoft/C#。我们希望提供电子商务网站作为我们服务的一部分。我们已经确定了一些我们可以使用的 .Net 开源/付费电子商务解决方案，这些解决方案的缺点是 Windows 服务器成本。

因此，我正在寻找可托管 Linux 的电子商务解决方案。任何人都可以推荐吗？

最重要的要求是，它是一个很好的工具包。即写得很好，易于换肤，可修改/可插入。我们真的不在乎它是用什么语言编写的。我想 Java 会稍微有益，因为它类似于 C#，但 php、ruby 等都是可以接受的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T19:38:40.543

[Ubercart](http://www.ubercart.org/)（[Drupal](http://drupal.org/) CMS 的一个模块）非常好并且可以修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T19:41:13.143

[Satchmo](http://www.satchmoproject.com/)是一个开源框架，用于使用 Django 构建在线商店。

# django - 在生产环境中执行激进的 Django 模型迁移的明智方法是什么？

> ID：663698
> 
> 赞同：2
> 
> 时间：2009-03-19T19:34:24.280
> 
> 标签：django, deployment, django-models

我有一个正在使用的现有 django web 应用程序。我必须从根本上将我设计中的一个关键模型迁移到一个全新的设计，但我想缓存该模型的所有现有数据，并在准备部署时将它们迁移到生产中的新记录。

我可以负担得起一晚将我的网站关闭几个小时，然后做我需要做的任何事情来迁移。我可以通过哪些合理的方式进行此迁移？

似乎任何迁移都需要：1）将所有现有数据转储为某种格式，例如 SQL、JSON、XML 2）将模型迁移到新格式 3）使用转换脚本将数据重新加载到新模型中

我还想过尝试将所有现有数据存储在称为“OldModel”的其他模型中（如果 Model 是现有模型的名称），然后实时迁移数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T19:45:37.797

我听说有一个帮助迁移的项目：[South](http://south.aeracode.org/)。

话虽如此，我承认我们没有使用它。我们仍然使用 SQL 语句文件来计划我们的迁移。疯狂，我知道，但它具有可测试性的优势。在“大部署”之前的开发和分段测试期间，您可以根据需要多次运行它。它可以是源代码控制、差异化等。因此，它也可以从更大的部署脚本中调用。当然，我们在运行之前备份生产 :-)

如果您的数据库进行日志记录，则使用老式方法还有一个额外的优势，即可以回滚事务历史记录。

我们使用 JSON、XML 和“OldModel”->“NewModel”样式转储运行的实验的扩展性很差。请注意，YMMV……我们有一个相当大的数据库。通过使用脚本，您可以在生产数据库上运行，而无需卸载或重新加载大量数据。这样，即使是复杂的迁移也可能需要几秒钟而不是几小时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:14:56.600

如果您对 Django ORM 比使用原始 SQL 更满意，您可以考虑使用 Model -> BackupModel -> TestModel -> Model，其中除了最后一步之外的所有步骤都可以在不删除数据的情况下执行。

```
def backup(InModel,OutModel):
    in_objs = InModel.objects.all()
    for obj in in_objs:
        out_obj = OutModel.convert_from(InModel,obj)
        out_obj.save() 
```

在这里，您只需确保所有模型都实现了 convert_from 方法。除了 BackupModel -> TestModel 之外，这些都应该是微不足道的转换。在其他情况下，除了类不会改变，所有数据都被相同地保留。

这样做的好处是，在你重写所有接口之前，你可以使用 TestModel 并确保你的转换是你认为的那样。如果一切都出错了，你从 BackupModel->Model 转换，一切都好。在最坏的情况下，您放弃 Django 的 ORM，运行回 SQL，并简单地将数据库中所有以 backupmodel__* 开头的表重命名为 model__*。

免责声明：我从来没有这样做过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T22:07:52.913

大约有 5 或 6 个工具可以帮助自动化部分迁移。[这个问题](https://stackoverflow.com/questions/426378/what-is-your-favorite-solution-for-managing-database-migrations-in-django)中列出了其中的几个，为了完整起见，我将添加其他的。

接下来，请参阅[S. Lott](https://stackoverflow.com/users/10661/s-lott) [对有关迁移工作流的问题的](https://stackoverflow.com/questions/497654/django-workflow-when-modifying-models-frequently)[回答](https://stackoverflow.com/questions/497654/django-workflow-when-modifying-models-frequently/498092#498092)，了解有关在模型名称中使用版本号以使迁移更容易的好主意，包括构建独立脚本以正确转换表。在我看来，这**大大优于**序列化数据以进行导出，然后尝试通过导入来构建新表。

 **最后，我一直想不出一种正确进行热迁移的方法，也没有从其他任何地方看到任何提示，因此维护停机是不可避免的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T13:43:28.110

逐步进行所有迁移！

如果您需要添加一个字段，请继续添加它，使用默认值或可选。这是安全的。如果您需要将现有的可选字段设为必填，请先将其设为默认值。如果您需要使具有默认值的现有字段没有默认值，请在修复所有创建实例的代码后删除默认值。如果您需要更改字段的类型，请先添加一个继承当前字段值的新字段。然后，运行脚本来更新现有实例以填充新字段。第三，删除所有使用旧字段的代码以使用新字段。最后，使用原始代码没有留下任何代码，您可以将其删除。

对于每种情况，您都可以迈出一小步。对于每一个更大的变化，你可以把它分解成小的变化。这是迭代开发带来回报的一个地方。保持良好的备份到位，不要害怕经常推送！快速进行小的更改，看看它们是否有效。

# asp.net - 如何阻止 CompositeControl TabIndex 属性在容器跨度上设置 tabindex

> ID：663702
> 
> 赞同：1
> 
> 时间：2009-03-19T19:35:32.517
> 
> 标签：asp.net, composite-controls

我编写了一个继承自 CompositeControl 的自定义服务器控件。当控件被实例化时，我动态地将一个 TextBox 添加到它的 Controls 集合中。我已经覆盖了 TabIndex 属性，以便在设置它时将值应用于子 TextBox 控件的 TabIndex 属性。问题是，当 CompositeControl 被渲染时，它包含一个 span 标签作为整个容器，并且它正在设置*span*上的 tabindex 属性以及输入（TextBox）控件。这使得光标实际上跳到跨度，这不是我想要的。关于如何让 CompositeControl 不在跨度上呈现 tabindex 属性的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:50:43.277

我回答了我自己的问题。事实证明，包装器 span 标记根本不是必需的，您可以通过在继承自 CompositeControl 的类中简单地包含以下覆盖来删除它：

```
public override void RenderBeginTag(HtmlTextWriter writer)
{
    // NOOP
}

public override void RenderEndTag(HtmlTextWriter writer)
{
    // NOOP
} 
```

# .net - 获取作为另一个对象属性的对象的类型

> ID：663709
> 
> 赞同：1
> 
> 时间：2009-03-19T19:37:13.697
> 
> 标签：.net, reflection

为了解释，假设我有一个 Company 对象，它具有 Address 类型的 Address 属性。所以它会是这样的：

```
公共类公司  
{  
    地址公司地址；
}  

公开课地址  
{
    整数；
    字符串街道名称；  
}

```

现在我有一个适用于任何类型对象类型的方法，并且我想从接收到的对象中获取特定属性，所以我正在尝试以下操作：

```
公共字符串我的方法（对象我的对象，字符串属性名称）
{
    类型 objectType = myObject.GetType();
    object internalObject = objectType.GetProperty("地址");

    类型 internalType = internalObject.GetType();
    PropertyInfo singleProperty = internalType.GetProperty("StreetName");

    返回 singleProperty.GetValue(internalObject, null).ToString();
}

```

问题是 internalType 从来不是 Address 而是 "System.Reflection.RuntimePropertyInfo" 所以 singleProperty 总是为空；

我怎样才能做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T19:45:11.370

您的代码的问题在于方法返回`internalObject`的对象。您需要获取该属性的实际值，因此需要调用方法。`PropertyInfo``GetProperty``GetValue`

```
public string MyMethod(object myObject, string propertyName) {
    Type objectType = myObject.GetType();
    object internalObject = objectType.GetProperty("Address").GetValue(myObject, null);

    Type internalType = internalObject.GetType();
    PropertyInfo singleProperty = internalType.GetProperty("StreetName");

    return singleProperty.GetValue(internalObject, null).ToString(); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T19:48:05.870

internalObject 只是一个 PropertyInfo 对象，就像 singleProperty 一样。

您应该使用相同的技术来提取实际对象：

```
 PropertyInfo addressProperty = objectType.GetProperty("Address");

    object interalObject = addressProperty.GetValue(myObject); 
```

其余的都是正确的。

# c# - C# 嵌套 Try Catch 语句或方法？

> ID：663710
> 
> 赞同：17
> 
> 时间：2009-03-19T19:37:19.733
> 
> 标签：c#, error-handling, methods

简单的最佳实践问题。

您应该嵌套 try catch 语句还是只使用方法。

例如，如果您有一个打开文件的方法确实有效并关闭文件，那么您将在 try catch 之外进行打开和关闭，或者在 finally 块中进行关闭。

现在，如果您的 open 方法失败，该方法会断言正确吗？那么你应该将它包装在一个 try catch 块中还是应该从另一个方法调用它，而这又是一个 try catch 块？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-19T19:43:06.443

在打开文件的方法的上下文中，我将使用 using 语句与 try catch。using 语句确保在发生异常时调用 Dispose。

```
using (FileStream fs = new FileStream(file, FileMode.Open))
{
    //do stuff
} 
```

做同样的事情：

```
FileStream fs;
try
{
     fs = new FileStream(file, FileMode.Open);
     //do Stuff
 }
 finally
 {
        if(fs!=null)
           fs.Dispose();
 } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-20T03:08:40.897

现在我们有了 lambdas 和类型推断以及其他一些东西，有一个在其他语言中很常见的习语现在在 C# 中很有意义。你的例子是关于打开一个文件，对它做一些事情，然后关闭它。好吧，现在，您可以创建一个打开文件的辅助方法，并确保关闭/处置/清理，但调用您为“do stuff”部分提供的 lambda。这将帮助您将复杂的 try/catch/finally dispose/cleanup 东西放在一个地方，然后一遍又一遍地使用它。

这是一个例子：

```
public static void ProcessFile(string filePath, Action<File> fileProcessor)
{
  File openFile = null;

  try
  {
    openFile = File.Open(filePath); // I'm making this up ... point is you are acquiring a resource that needs to be cleaned up after.

    fileProcessor(openFile); 
  }
  finally
  {
    openFile.Close(); // Or dispose, or whatever.
  }
} 
```

现在，此方法的调用者不必担心如何打开文件或关闭/处置它。他们可以这样做：

```
Helpers.ProcessFile("C://somefile.txt", f => 
 {
   while(var text = f.ReadLine())
   {
     Console.WriteLine(text);
   }
 }); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-19T19:41:55.153

这是一个风格问题，但对我来说，我尽量不要在一个方法中嵌套超过一个级别的 try/catch/finally。在您进行嵌套尝试时，您几乎可以肯定违反了 1 function = 1 操作原则，应该使用第二种方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-19T19:41:07.557

取决于你想要做什么，但在大多数情况下，嵌套的 try/catch 是一个过于复杂的函数的标志（或者一个不太了解异常如何工作的程序员！）。

在打开文件的情况下，我会使用 IDisposable 持有者和 using 子句，因此不需要任何显式的 try/catch。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-01T10:46:23.607

您在哪里拥有不一定属于它自己的单独功能的相关代码呢？那么这会是正确的吗？

```
try
{
  // Part 1 Code Here

  try
  {
    // Part 2 Code Here
  }
  catch (Exception ex)
  {
    // Error from Part 2
  }
}
catch (Exception ex) 
{
  // Error from Part 1
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T20:02:03.247

大多数时候，我会将嵌套的 try/catch 块分解为函数。但是我有时会编写代码来捕获和记录我的应用程序抛出的所有未捕获的异常。但是如果日志记录代码失败怎么办？所以我有另一个尝试/捕捉，只是为了防止用户看到默认的 .NET 未处理异常对话框。但即使是这段代码也可以很容易地重构为函数，而不是嵌套的 try/catch 块。

```
try
{
    try
    {
        DoEverything(); 
    }
    catch (Exception ex)
    {
        // Log the exception here
    }
}
catch (Exception ex)
{
    // Wow, even the log is broken ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-04T15:29:09.553

```
//create a switch here and set it to 0 
try
{
    DoChunk1(); 
    //looks good. set the switch to 1
}
catch (Exception ex)
{
    // Log the exception here
} 
```

// 检查开关，如果此时它仍然为零，那么你可以在这里暂停你的程序；否则将开关设置回零并执行下一个 try catch 语句。完全同意如上所述分解它们

尝试 { DoChunk2(); //看起来不错。将开关设置为 1 } catch (Exception ex) { // 在此处记录异常 }

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-05-27T08:21:29.077

```
try 
{
  ----
}
catch
{
   try
      {
           ---
      }
   catch
      {
        ---
      }
} 
```

# .net - 使用 SqlCommand 执行非查询，你能得到通常发布到“消息”的文本吗？

> ID：663716
> 
> 赞同：16
> 
> 时间：2009-03-19T19:38:24.193
> 
> 标签：.net, sql, sql-server

使用 SqlCommand 执行非查询（例如数据库还原）时，是否可以通过编程方式获取通常会在使用 Management Studio 时发布到“消息”选项卡的文本？如果是这样怎么办？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-19T19:43:28.473

是的，SqlCommand 对象上有一个名为 SqlInfoMessage 的事件挂钩，您可以将其挂钩：

```
SqlConnection _con = new SqlConnection("server=.;database=Northwindintegrated Security=SSPI;");

_con.InfoMessage += new SqlInfoMessageEventHandler(_con_InfoMessage); 
```

事件处理程序将如下所示：

```
static void _con_InfoMessage(object sender, SqlInfoMessageEventArgs e)
{
    string myMsg = e.Message;            
} 
```

“e.Message”是打印到 SQL Server Mgmt Studio 中的消息窗口的消息。

马克

# c++ - 调用函数时首选错误的参数转换

> ID：663724
> 
> 赞同：3
> 
> 时间：2009-03-19T19:39:30.353
> 
> 标签：c++, constructor, arguments, visual-c++-6

我正在 MS Visual C++ 6.0 下编写程序（是的，我知道它很古老，不，我无法升级）。我看到一些我认为非常奇怪的行为。我有一个类，其中定义了两个构造函数，如下所示：

```
class MyClass
{
public:
    explicit MyClass(bool bAbsolute = true, bool bLocation = false) : m_bAbsolute(bAbsolute), m_bLocation(bLocation) { ; }
    MyClass(const RWCString& strPath, bool bLocation = false);

private:
    bool m_bAbsolute;
    bool m_bLocation;
}; 
```

当我使用以下语法实例化此类的实例时：`MyClass("blah")`，它调用第一个构造函数。如您所见，我在其中添加了`explicit`关键字，希望它不会那样做……没有骰子。它似乎更喜欢从`const char *`to的转换而不是 to`bool`的转换`RWCString`，后者有一个带有`const char *`. 为什么这样做？我会假设给定这样的两种可能的选择，它会说它是模棱两可的。我能做些什么来防止它这样做？如果可能的话，我想避免将`strPath`参数显式转换为 a `RWCString`，因为它将大量与文字一起使用，并且需要大量额外的输入（加上一个非常容易犯的错误）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T19:50:38.207

显式在这里没有帮助，因为构造函数不是隐式转换的一部分，只是接收者。

无法控制转换的首选顺序，但您可以添加第二个构造函数，该构造函数采用 const char*。例如：

```
class MyClass
{
public:
    MyClass(bool bAbsolute = true, bool bLocation = false);
    MyClass(const RWCString& strPath, bool bLocation = false);
    MyClass(const char* strPath, bool bLocation = false);

private:
    bool m_bAbsolute;
    bool m_bLocation;
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T20:16:23.120

Andrew Grant 提供了解决方案。我想告诉你*为什么*它不能按照你尝试的方式工作。如果一个参数有两个可行的函数，则调用与参数最匹配的一个。第二种需要用户定义的转换，而第一种只需要标准的转换。这就是为什么编译器更喜欢第一个而不是第二个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T19:54:33.563

如果您不想继续投射它，那么在我看来，您可能必须制作另一个采用 const char* 的 ctor。

这就是我在这种情况下可能会做的事情。

（不知道为什么要使用在大多数情况下都没有传递的类型来制作 ctor。）

编辑：

我在打字时看到其他人已经发布了这个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T19:43:04.510

不知道为什么它应该混淆对字符串和布尔的引用？我已经看到了 bool 和 int 的问题。
你能失去第一个构造函数的默认值吗？可能是因为这使它成为 MyClass() 的默认构造函数，所以如果它不能匹配参数，它也是默认值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T20:08:35.713

您的选择是添加一个显式采用 const char * 的构造函数

```
MyClass(const char* strPath, bool bLocation = false); // Thanks Andrew Grant! 
```

或者做

```
MyClass( string("blah") ); 
```

编译器本质上知道如何将 const char * 变成 bool。它必须去看看，对于 MyClass 构造函数的任何第一个参数类型，是否有一个构造函数将采用您给它的源类型，或者它是否可以将其转换为接受的类型您的 MyClass 构造函数的任何第一个参数类型的任何构造函数，或者......好吧，您会看到它的去向并且仅适用于第一个参数。那就是疯狂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T20:14:21.363

`explicit`关键字告诉编译器它不能将参数类型的值隐式转换为类的对象，如

```
struct C { explicit C( int i ): m_i(i) {}; int m_i; };
C c = 10;//disallowed
C c( 2.5 ); // allowed 
```

C++ 有一组规则来确定在你的情况下要调用什么构造函数——我不知道从我的脑后，但你可以直观地看到默认参数会导致歧义。

您需要考虑这些默认设置。

您可以回退到一些静态的、命名的构造方法。或者您可以使用不同的类（从设计角度来看，这不是一个糟糕的选择）。无论哪种方式，您都让客户端代码决定使用哪个构造函数。

```
struct C {
  static C fromString( const char* s, const bool b = true );
  static C fromBools( const bool abs = true, const bool b = true );
}; 
```

或者

```
struct CBase {
    bool absolute; 
    bool location;
    CBase( bool abs=true, bool loc=true );
};

struct CBaseFromPath {
    // makes 'absolute' true if path is absolute
    CBaseFromPath( const char* s, const bool loc );
}; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-19T19:46:01.867

你**确定**它真的在调用第一个构造函数吗？您是用硬编码的字符串调用它，还是隐藏在 a 后面`#define`？您确定#define 是您认为的那样吗？（尝试使用 /Ef 选项进行编译以获取扩展的预处理器输出，并查看调用是否与您期望的一样。）

编辑：基于此和其他评论，我的建议是添加另一个构造函数`const char*.` 是否可行？

# data-binding - 当绑定内存集合获得新成员时更新 SilverLight 列表

> ID：663727
> 
> 赞同：0
> 
> 时间：2009-03-19T19:39:56.810
> 
> 标签：data-binding, listbox, silverlight-2.0

我正在尝试从（第四个）源列表框中填充三个列表框之一。来源有一个学校科目列表，这些科目分为小学、初中或高中科目。源列表框是一个复选框列表。用户单击复选框，其他三个中的一个用于从源列表中获取主题对象的副本。我已经把东西连接起来并成功地点击了 CheckBox_Changed 方法。我可以成功地从源列表中找到 Subject 实例并将其添加到目标列表的 Source 数组中。

我不能做的是在目标数组绑定到的 Silverlight 控件上显示更新。

有任何想法吗？

谢谢

```
private void CheckBox_Checked(object sender, RoutedEventArgs e)
{
  var cb = (CheckBox)sender;
  var children = ((Grid)cb.Parent).Children;
  // cb has a sibling TextBlock item that has the index of the item in 
  //   the list of subjects
  var ch2 = children[1] as TextBlock;
  var subjectIndexStr = ch2.Text;
  var myWorkingSubject = workingSubjectList[int.Parse(subjectIndexStr)];

  switch (myWorkingSubject.SubjectLevelId)
  {
// updates to the elementarySubjects, middleSubjects and highSubjects 
//    don't get reflected in the lists that use them as a resource.
    case (int)SubjectLevels.Elementary:
      elementarySubjects.Add(myWorkingSubject);
      break;
    case (int)SubjectLevels.Middle:
      middleSubjects.Add(myWorkingSubject);
      break;
    case (int)SubjectLevels.High:
      highSubjects.Add(myWorkingSubject);
      break;
    default: break;

  }
}   

// this is how the target classes are declared.
public class SubjectsElementary : ObservableCollection<WorkingSubject>
{
}
public class SubjectsMiddle : ObservableCollection<WorkingSubject>
{
}
public class SubjectsHigh : ObservableCollection<WorkingSubject>
{
} 
```

**以下是 .xaml 文件的片段**

```
<TutorRouterSvc:WorkingSubjectList x:Key="subjects" />
<TutorRouterSvc:SubjectsElementary x:Key="elementarySubjects" />
<TutorRouterSvc:SubjectsMiddle x:Key="middleSubjects" />
<TutorRouterSvc:SubjectsHigh x:Key="highSubjects" />

  <ListBox x:Name="subjectList" ItemsSource="{Binding Mode=OneWay, Source={StaticResource subjects}}">

  <ListBox.Resources>

  </ListBox.Resources>
        <ListBox.ItemTemplate>
            <StaticResource ResourceKey="DataSubjectsTemplate1"/>
        </ListBox.ItemTemplate>
    </ListBox>

<Grid Grid.Column="1">
  <Grid.RowDefinitions>
    <RowDefinition Height="*"/>
    <RowDefinition Height="*"/>
    <RowDefinition Height="*"/>
  </Grid.RowDefinitions>

  <ListBox Margin="0,0,8,0" x:Name="elementarySubjectList" 
            ItemsSource="{Binding Mode=OneWay, Source={StaticResource elementarySubjects}}"
            Background="#FFE75151" Grid.Row="0">
    <ListBox.ItemTemplate>
      <StaticResource ResourceKey="DataSubjectsTemplate1"/>
    </ListBox.ItemTemplate>
  </ListBox>
  <ListBox Margin="0,0,8,0" x:Name="middleSubjectList" 
            ItemsSource="{Binding Mode=OneWay, Source={StaticResource middleSubjects}}"
            Background="#FFE75151" Grid.Row="1">
    <ListBox.ItemTemplate>
      <StaticResource ResourceKey="DataSubjectsTemplate1"/>
    </ListBox.ItemTemplate>
  </ListBox>
  <ListBox Margin="0,0,8,0" x:Name="highSubjectList" 
            ItemsSource="{Binding Mode=OneWay, Source={StaticResource highSubjects}}"
            Background="#FFE75151" Grid.Row="1">
    <ListBox.ItemTemplate>
      <StaticResource ResourceKey="DataSubjectsTemplate1"/>
    </ListBox.ItemTemplate>
  </ListBox>
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T20:03:56.973

我不太确定，但这可以通过在 Dispatch.BeginInvoke() 中进行更改来解决。

您可以将 switch 语句重构为一个名为 的新方法`UpdateListBox`，然后调用它：

```
Dispatcher.BeginInvoke(() => UpdateListBox(myWorkingSubject.SubjectLevelId)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T21:43:07.667

可能发生这种情况是因为 XAML 正在新建一个对象的新实例，它是数据绑定的对象。

尝试将此添加到您的 Page.xaml.cs 上的 cosntructor（或控件所在的任何位置）；

```
_subjects = Resources["subjects"] as WorkingSubjectsList;
_elementarySubjects = Resources["elementarySubjects"] as SubjectsElementary; 
```

ETC...

也许这会有所帮助。我已经通过在几个场合将列表框绑定到 Observable 集合来实现相同的概念，并且没有经历过您遇到的情况。

我确实有一些建议：您是否在支票更改事件中尝试过这个？

```
workingsubject _item = workingSubjectList[subjectsList.selectedindex];
switch (_item.SubjectLevel) //I'm assuming this property as you have the ID and it looks to be an enumeration
        {
            case Elementary:
                elementarySubjects.Add(_item):
                break;
            case Middle:
                middleSubjects.Add(_item):
                break;
            case High:
                highSubjects.Add(_item):
                break;
                case default:
                        throw new Exception("Unrecognized Subject Level");
        } 
```

hth。

# debugging - 在 VS 设备模拟器中调试移动软件 - 应用切换到后台

> ID：663735
> 
> 赞同：0
> 
> 时间：2009-03-19T19:41:49.473
> 
> 标签：debugging, windows-mobile, emulation

在模拟器上调试移动应用程序时遇到此问题。当我按 F5 时，构建开始，然后是部署，然后应用程序会在模拟器中弹出。因为这需要一两分钟，所以我正在检查我的 SO 分数，可能会在我等待的时候问一个问题，模拟器在后台。当我最终切换回模拟器时，它显示的是起始页，而不是我的应用程序。

我发现通过按下后退按钮可以将调试的应用程序带到前台，但是，我仍然不知道是什么将它推到后台开始。有没有人注意到这一点，并找到了防止它的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T20:47:29.177

WinMo 中的默认行为是，如果设备在一段时间内没有活动（在 Settings->Today->Items->Today Timeout 中设置），则会出现 Today 屏幕。检查是否发生了这种情况（尽管我认为最小的间隔仍然大于几分钟）。

# asp.net - 使用 ASP.NET 按钮触发 JQuery 对话框？

> ID：663743
> 
> 赞同：1
> 
> 时间：2009-03-19T19:43:04.963
> 
> 标签：asp.net, jquery, jquery-ui

我有一个页面，上面有一个带有 2 个文本框（用户名和密码）和一个 asp:Button 的控件。如果用户的会员资格将在 30 天内到期并且单击按钮，我希望弹出 JQuery 对话框。在 JQuery 对话框中，我有一些文本和一个 asp:LinkBut​​ton。链接按钮附加了一个事件，但是当我在对话框中单击它时它不会被触发。这是 JQuery 的脚本标签：

```
<script type="text/javascript" src="jquery-1.3.2.js"></script>
<script type="text/javascript" src="ui.core.js"></script>
<script type="text/javascript" src="ui.draggable.js"></script>
<script type="text/javascript" src="ui.resizable.js"></script>
<script type="text/javascript" src="ui.dialog.js"></script> 
```

这是对话框的脚本：为了测试，我正在关闭 Renew Membership 单击对话框，但我实际上希望它触发我在 asp.net 中创建的方法，以将用户引导到另一个页面并传递会话变量。

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#dialog").dialog({
         // autoOpen: false,
            modal: true,
            buttons: { "Renew Membership": function() { $(this).dialog("close"); } }
        });
    });
</script>

<asp:Content ID="mainContent" runat="server" ContentPlaceHolderID="Content">
<div id="dialog" title="Membership Renewal">
    <p>Uh Oh! Your membership is going to expire.</p><br />
    <p>Hurry up and renew today!</p><br />
    <asp:LinkButton runat="server" Text="Click Here to Renew" 
        onclick="Unnamed2_Click"></asp:LinkButton>
</div> 
```

这是 LinkBut​​ton 的点击事件：

```
protected void Unnamed2_Click(object sender, EventArgs e)
{
    UserProfiles userProfile = (UserProfiles)Session["userProfile"];
    Response.Redirect("~/Renew.aspx");
} 
```

应该发生的是，当用户单击登录按钮时，只有当他们剩余的过期天数 <= 30 时才会弹出对话框，如果这样做，他们可以选择单击对话框中的链接并转到一个更新页面，我想向它传递一个带有配置文件的会话变量，但没有被调用，所以我想，我想知道如何将按钮的事件处理程序添加到对话框和有没有办法设置它，使它只出现一次，例如向用户浏览器添加一个 cookie，并且只有在他们没有设置 cookie 时才显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:00:16.030

我相信这更多的是 ASP.NET 问题，而不是 jQuery 对话框问题。

我不会在同一个 LinkBut​​ton 中使用 onClick 和 PostBackUrl。所以，去掉 PostBackUrl 属性，而是使用

```
protected void Unnamed2_Click(object sender, EventArgs e){
    UserProfiles userProfile = (UserProfiles)Session["userProfile"];
    Response.Redirect("~/Renew.aspx");
} 
```

如果您只需要在用户> 30天时显示控件。我会创建一个用户控件。

**jquery.renewDialog.js**

```
$(document).ready(function() {
    $("#dialog").dialog({
        modal: true
    });
}); 
```

**更新用户控件.ascx**

```
<asp:ScriptManager runat="server" id="ScriptManager1">
  <Scripts>
    <asp:ScriptReference Path="jquery.renewDialog.js" />
  </Scripts>
</asp:ScriptManager>
<div id="dialog" title="Membership Renewal">
    <p>Uh Oh! Your membership is going to expire.</p><br />
    <p>Hurry up and renew today!</p><br />
    <asp:LinkButton runat="server" Text="Click Here to Renew" 
        onclick="Unnamed2_Click" />
</div> 
```

**登录.aspx**

```
<uc1:RenewalUserControl runat="server" ID="RenewalUserControl1" Visible="false" /> 
```

**登录.aspx.cs**

```
if (user.IsExpired)
{
  RenewalUserControl1.Visible = true;
} 
```

# iphone - UIToolbar 和其他视图

> ID：663754
> 
> 赞同：2
> 
> 时间：2009-03-19T19:45:07.377
> 
> 标签：iphone, uitoolbar

我知道如何在 rootviewcontroller.m 中添加 UIToolbar：

```
[self.navigationController.view addSubview:toolbar]; 
```

但是，当我导航到其他视图时，工具栏保持不变，这没关系，但我如何访问它来隐藏/显示它？

在 rootviewcontroller 里面我会使用这个：

```
toolbar.hidden = NO; 
```

但我似乎找不到在 rootviewcontroller.m 之外执行此操作的方法

你能告诉我一个从另一个班级隐藏它的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T20:02:47.363

有两种选择；

1）向控制器添加一个属性，以便外部类可以访问工具栏对象。

2) 向您的根视图控制器添加一个可用于移动工具栏的功能。

我会推荐＃2，因为它限制了外部类可以做什么。

例如

```
-(void) hideToolbar:(BOOL)hidden
{
  toolbar.hidden = hidden;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T20:29:25.087

问题是您不应该将其添加到`self.navigationController.view`; 您应该将其添加到`self.view`. 更正应该为您解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-02T13:11:09.000

您可以尝试在您不希望栏出现的视图控制器的初始化过程中添加以下行。

```
[self.navigationController setToolbarHidden:YES animated:NO]; 
```

F。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-11-21T17:07:45.097

安德鲁格兰特的答案就是你要找的。但是，您应该将方法重命名为

```
-(void) isToolbarHidden:(BOOL)hidden {
    toolbar.hidden = hidden; 
```

}

在查看代码时，这种方式更有意义。

# voice - VXML 在录制超时时发出哔声

> ID：663765
> 
> 赞同：1
> 
> 时间：2009-03-19T19:47:32.567
> 
> 标签：voice, vxml, voicemail

[我在上一个问题](https://stackoverflow.com/questions/640255/vxml-getting-src-for-subdialog-from-variable)中提到的 VXML 应用程序现在正在测试中。在允许用户录制消息（最长 5 分钟）后，我们进入标准菜单（提交、播放、重新录制等）。

我们的一个测试人员，厌倦了任何事情并且厌倦了留下 5 分钟的消息，正在阅读我们发送的电子邮件，其中包括电话号码。菜单刚开始，她就说“两个”，只听到了菜单的一瞬间。

不用说，她很困惑。

对我来说，解决这个问题的正确方法似乎是在录音中添加一个明确的停止，就像开始它的哔哔声一样。

[记录项](http://www.vxml.org/frame.jsp?page=record.htm)有一个 beep 属性，它在记录开始时发出哔声，我们使用它。我找不到对用户达到最大时间时会发出哔哔声的任何属性的引用。

当达到最大时间时，如何在结束时添加不间断的哔声？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:36:18.033

好吧，多一点挖掘告诉我，对象上没有它的属性。

但我确实在结果变量“maxtime”上显示了一个属性，它告诉你它是否由于最大时间超出事件而结束。

通过在该部分中进行检查，但在将它们发送到菜单之前，我可以使用块来播放带有 bargein="false" 的音频文件

它的代码比我想要的多一点，但它似乎有效。

# c# - System.Security.Cryptography 和“坏数据” - 字符编码？

> ID：663768
> 
> 赞同：1
> 
> 时间：2009-03-19T19:48:06.107
> 
> 标签：c#, xml, encryption

产生“坏数据”错误的类：

```
 using System;
using System.Collections.Generic;
using System.Security.Cryptography;
using System.Text;
using System.Windows.Forms;

namespace MyNameSpace
{

  public class RSAcrypt
  {
    private string _encryptedData;
    private string _decryptedData;

    public string EncryptedData
    {
      get { return _encryptedData; }
      set { _encryptedData  = value; }
    }

    public string DecryptedData
    {
      get { return _decryptedData; }
      set { _decryptedData  = value; }
    }

    public RSAcrypt()
    {
    }
    /// <param name="CryptAction"> The action to perform on the string {Encrypt|Decrypt} </param >
    /// <param name="StringToCrypt"> A string to perform the Action on </param>
    public RSAcrypt(string CryptAction, string StringToCrypt)
    {
        UnicodeEncoding thisUnicodeEncoding = new UnicodeEncoding();
        RSACryptoServiceProvider thisRSACryptoServiceProvider = new RSACryptoServiceProvider();
        byte[] _stringToCrypt = thisUnicodeEncoding.GetBytes(StringToCrypt);

        switch (CryptAction)
        {
            case "Encrypt":
                byte[] encryptedData = Encrypt(_stringToCrypt, thisRSACryptoServiceProvider.ExportParameters(false));
                _encryptedData = thisUnicodeEncoding.GetString(encryptedData);
            break;

            case "Decrypt":
                byte[] decryptedData = Decrypt(_stringToCrypt, thisRSACryptoServiceProvider.ExportParameters(true));
                _decryptedData = thisUnicodeEncoding.GetString(decryptedData);
            break;

            default:

            break;
        }

    }

    static private byte[] Encrypt(byte[] DataToEncrypt, RSAParameters keyInfo)
    {
        RSACryptoServiceProvider RSA = new RSACryptoServiceProvider();
        RSA.ImportParameters(keyInfo);
        return RSA.Encrypt(DataToEncrypt, false);
    }

    static private byte[] Decrypt(byte[] DataToDecrypt, RSAParameters keyInfo)
    {
      #region Temporary Assignment - Remove before build

      byte[] tmpVal = null;

      #endregion

      RSACryptoServiceProvider RSA = new RSACryptoServiceProvider();

      try
      {
          RSA.ImportParameters(keyInfo);

          #region Temporary Assignment - Remove before build

          tmpVal = RSA.Decrypt(DataToDecrypt, false);

          #endregion
      }
      catch (Exception ex)
      {

          MessageBox.Show("Error: " + ex.Message, "Exception Thrown");

      }

      #region Temporary Assignment - Remove before build

      return tmpVal;

      #endregion
    }
  }
} 

```

**在将字节数组传递给加密/解密之前，我可以在此类中更改任何内容以允许我检查编码吗？**

似乎我在这里的某个地方有参考，但我变得沮丧，所以我认为如果我停下来做一些除了阅读和编译之外的事情至少会有所帮助......

顺便说一句，我正在调用此类以使用 Nini 初始化框架将密码写入 XML 文件。 [http://nini.sourceforge.net/manual.php#ASimpleExample](http://nini.sourceforge.net/manual.php#ASimpleExample)

此外，在写入 XML 文件之前，我使用[Notepad2更改了文件编码 (UTF-8)。](http://www.flos-freeware.ch/notepad2.html)

那是在我第一次编译后程序停止之后。使用调试器，我能够看到内存中的 XML 数据 (UTF-8) 和磁盘上的数据 (ANSI) 之间的编码不同。

现在看来情况并非如此，但程序仍然停止，引用从 RSAcrypt() 的解密部分返回的错误数据。

（另请注意，在我感到沮丧之前，Encrypt 和 Decrypt 是相同的方法，它们的功能相同，但我想尝试捕获与错误数据声明相关的其他异常信息。当然，您会注意到我允许我的沮丧妨碍我的代码;-))

任何建议、想法或参考都会很棒。

TIA,

乙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T19:56:29.797

在您的构造函数中，每次执行以下操作时都会生成一个新的 RSA 密钥对：

```
 RSACryptoServiceProvider thisRSACryptoServiceProvider = new RSACryptoServiceProvider(); 
```

由于您的构造函数是您加密和解密的地方，因此您使用 RSA 密钥进行加密，并使用完全不同的密钥进行解密。

要完成这项工作，您可以根据计划使用代码的方式提供多种选择。

一种选择是导出 RSA 密钥，并将其用于所有加密/解密操作。如果您计划在可执行文件的不同运行之间解密/加密数据，这是唯一的选择。

当然，这完全掩盖了您将如何存储您的公钥/私钥（我建议在 Windows 上使用 DPAPI）以供您的应用程序使用。

# eclipse - 在 Eclipse 3.4.2 中调试一个 tomcat 项目

> ID：663769
> 
> 赞同：6
> 
> 时间：2009-03-19T19:48:47.117
> 
> 标签：eclipse, tomcat, plugins, debugging, eclipse-wtp

我下载了eclipse 3.4.2并尝试从sysdeo（[http://www.eclipsetotale.com/tomcatPlugin.html](http://www.eclipsetotale.com/tomcatPlugin.html) ）为eclipse安装tomcat插件（3.2.1版）

我已按照安装说明进行操作，但是何时从 Eclipse 工具栏启动 tomcat 时出现以下错误

java.lang.NoClassDefFoundError: org/apache/tomcat/util/log/SystemLogHandler at java.lang.Class.getDeclaredConstructors0(Native Method) at java.lang.Class.privateGetDeclaredConstructors(Class.java:2357) at java.lang.Class .getConstructor0(Class.java:2671) 在 java.lang.Class.newInstance0(Class.java:321) 在 java.lang.Class.newInstance(Class.java:303) 在 org.apache.catalina.startup.Bootstrap。 org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:390) 处的 init(Bootstrap.java:205)

我确实按照故障排除说明进行操作，但没有成功。

我也尝试将插件放入 dropin 目录，但仍然出现相同的错误。

这在 eclipse 3.2 和 3.3 中运行良好

然后我尝试使用标准的内置 WTP 来设置我的 tomcat 服务器。我不确定它将如何在 tomcat 的 conf 目录中选择我的 server.xml，目前看来它还没有选择。如何将我的 Eclipse 项目与此设置相关联。我可以启动服务器，但是当我浏览 tomcat 启动页面时，它什么也没显示。

如果有人可以提供一些解决此问题的方法，我将不胜感激。

提前致谢。

-迪佩什

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-19T22:48:58.760

在尝试了几件事之后，我能够在 eclipse 3.4.2 中调试 tomcat 项目要使用 eclipse 3.4.2 调试 tomcat 应用程序/项目，请使用与它一起安装的 WTP 插件。

转到窗口 --> 显示视图 --> 其他 --> 服务器

在此视图中新建服务器，请选择tomcat安装目录和版本信息。

然后在本地主机双击Tomcat VX.X Server，打开配置设置页面

在“服务器位置”部分中，选择“使用 Tomcat 安装（控制 Tomcat 安装）并输入部署路径。

在发布部分选择从不自动发布并取消选中更新上下文路径复选框。

瞧！！全部设置为在 eclipse 3.4.2 中调试 tomcat 项目

无需下载和复制任何额外的插件。

谢谢朱里。希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T21:16:20.543

我正在使用带有 WTP 的 Eclipse Java EE 版本的 Tomcat，它运行良好。我有将我的网络应用程序部署到 tomcat webapp 文件夹的 Ant 脚本。为了调试，您必须在 Eclipse 中打开 Server 视图，添加新服务器并选择正确的 Tomcat 版本。完成后，通过双击刚刚创建的 Eclipse 服务器视图中的服务器条目，在 eclipse 中打开 Tomcat 的配置。在配置页面的左中侧，您应该会看到类似“让 Eclipse 控制本地 Tomcat 安装”之类的内容，我现在不记得确切的文字了。你必须选择那个。然后，您可以在源代码中设置断点，然后在 Eclipse 的服务器视图中以调试模式启动 Tomcat。希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T01:16:17.870

如果您使用的是 Sysdeo 插件，那么您*不想*同时使用标准的 Eclipse WTP 服务器。要使用 Sysdeo 插件，您需要已经下载并解压了一个标准的压缩 tomcat 目录。确保在您的路径中定义 CATALINA_HOME。然后，假设您已经正确安装了 sysdeo 插件，进入 Eclipse->Windows->Prefs->Tomcat（这是 Sysdeo 的 Tomcat 设置，而不是 WTP 设置）。您需要告诉插件您在哪里提取了 Tomcat 目录，并将其设置为使用上下文文件。

现在创建一个新的动态 web 项目。右键单击它，然后进入其属性->Tomcat。将其作为“Tomcat 项目”进行检查。给它一个上下文名称，并告诉它作为你的战争基础的目录（默认情况下，Eclipse 已经命名了这个 WebContent，我相信）。应用它并关闭窗口。再次右键单击您的项目，然后转到 Tomcat 部分。添加“Tomcat Libraries to Build Path”以便您可以使用 Servlet/JSP 类。最后，单击“更新上下文”。如果您进入 Conf 下的 Tomcat 目录，您会看到插件已经为您创建了一个指向 Eclipse 工作区的上下文。无需将应用程序部署到 Tomcat 目录。现在，您应该能够单击 Sysdeo Tomcat 的“开始”按钮，并且您的应用程序应该能够在 localhost 连接到您的应用程序：

HTH，比尔

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T20:26:53.267

使用出色的[Findjar](http://www.findjar.com/)网页：

org/apache/tomcat/util/log/SystemLogHandler

给出以下内容：

关于 org.apache.tomcat.util.log.SystemLogHandler 类的信息：

> 包含JAR文件：
> jbossweb.jar
> gwt-dev-windows.jar
> tomcat-util-3.3.2.jar
> tomcat-util-4.0.6.jar
> tomcat-util-4.1.31.jar
> tomcat-util-4.1.34.jar
> tomcat-util-4.1.36.jar
> tomcat-util-5.0.16.jar
> tomcat-util-5.0.18.jar
> tomcat-util-5.0.28.jar
> tomcat-util-5.5.12.jar
> tomcat-util-5.5 .15.jar
> tomcat-util-5.5.23.jar
> tomcat-util-5.5.4.jar
> tomcat-util-5.5.7.jar
> tomcat-util-5.5.9.jar
> tomcat-util-5.5.7-alpha。 jar
> tomcat-util-5.5.8-alpha.jar
> tomcat-util-5.5.9-alpha.jar

确保适当的 jar 文件位于您的 CLASSPATH 中。

# perl - 如何使基于 CGI::Fast 的应用程序 kill -HUP 感知？

> ID：663772
> 
> 赞同：2
> 
> 时间：2009-03-19T19:50:08.050
> 
> 标签：perl, fastcgi

我有使用 Perl 的[CGI::Fast](http://search.cpan.org/dist/CGI-Fast)的应用程序。

基本上代码的主循环是：

```
while (my $cgi = CGI::Fast->new() ) {
  do_whatever( $cgi );
} 
```

现在，我想添加杀死它的能力，但不会中断当前处理的请求。为此，我向 SIGHUP 添加了处理。或多或少是这样的：

```
my $sighupped = 0;
$SIG{ 'HUP' } = sub { $sighupped = 1; };
while (my $cgi = CGI::Fast->new() ) {
  do_whatever( $cgi );
  exit if $sighupped;
} 
```

当涉及到“在处理用户请求时不干扰过程”时，它的效果非常好。但是，如果进程正在等待新的请求，那么基于 sighup 的退出将不会被执行，直到它最终得到一些请求并处理它。

有什么解决方法吗？如果 HUP（或其他信号，可以更改）在等待请求时到达它，我想实现它以使脚本立即退出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:46:33.017

您可以根据处理程序的位置重新声明您的信号。

如果您在 fast-cgi while 循环之外或在 fast-cgi 轮询内部，因此不在事件循环中终止（基本上是默认值）。如果您在事件循环逻辑中，请等待逻辑结束并终止。

请原谅我目前缺少编辑。

```
$inlogic=0;
$hupreq=0;
SIG{SIGHUP}={ exit unless($inlogic); $hupreq=1;}

while()
{
   $inlogic=1;
   function();
   $inlogic=0;
   exit if($hupreq);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T00:13:10.897

您可以使用该函数的块版本[`eval`](http://perldoc.perl.org/functions/eval.html)和该[`alarm`](http://perldoc.perl.org/functions/alarm.html)函数将超时添加到`Fast::CGI`. 在下面的代码中，我设置了 5 秒超时。如果超时，它将返回到循环的开头，该循环将检查是否`$continue`已设置为零。如果还没有，那么我们开始一个新`CGI::Fast`对象。这意味着在您发送 a`HUP`之后，如果代码正在等待一个新`CGI::Fast`对象，最多会经过五秒钟，然后代码才会开始停止（超时对循环的其余部分没有影响）。

```
my $continue = 1;
$SIG{HUP} = sub { $continue = 0 };
while ($continue) {
    my $cgi;
    eval {
        local $SIG{ALRM} = sub { die "timeout\n" };
        alarm 5; #set an alarm for five seconds
        $cgi = CGI::Fast->new;
        alarm 0; #turn alarm off
    };
    if ($@) {
        next if $@ eq "timeout\n"; #we will see the HUP signal's change now
        #died for a reason other than a timeout, so raise the error
        die $@;
    }
    last unless defined $cgi; #CGI::Fast has asked us to exit
    do_stuff($cgi);
}

#clean up 
```

# system-monitoring - 任何类似于 Windows 操作系统的 Monit 等价物？

> ID：663780
> 
> 赞同：12
> 
> 时间：2009-03-19T19:52:53.737
> 
> 标签：system-monitoring

我看到过“你能在 Windows 上运行 Monit 吗？”这个问题，除非你想使用虚拟机，否则答案似乎是否定的。

那么......实际上是否有任何适用于 Windows 操作系统的小尺寸类似监视器的应用程序？我正在寻找的不仅仅是监控（其中有数百个应用程序），还有执行脚本或重新启动服务的能力。例如，监控一个网页，如果该页面无响应（不能只看服务，因为服务仍在运行但没有正确响应），则重新启动 Tomcat。

这是针对小型应用程序，而不是大型应用程序，因此不需要重量级/昂贵的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T02:37:13.183

我没有找到任何适合我需要的东西，所以我学习了一点 Powershell 脚本并推出了一个对其他人也应该有用的解决方案。假设是 Windows 平台（否则使用 monit！），Powershell 非常强大且简单。

**sample-monitor.ps1 脚本：**

```
$webClient = new-object System.Net.WebClient

###################################################
# BEGIN USER-EDITABLE VARIABLES

# the URL to ping
$HeartbeatUrl = "http://someplace.com/somepage/"

# the response string to look for that indicates things are working ok
$SuccessResponseString = "Some Text"

# the name of the windows service to restart (the service name, not the display name)
$ServiceName = "Tomcat6"

# the log file used for monitoring output
$LogFile = "c:\temp\heartbeat.log"

# used to indicate that the service has failed since the last time we checked.
$FailureLogFile = "c:\temp\failure.log"

# END USER-EDITABLE VARIABLES
###################################################

# create the log file if it doesn't already exist.
if (!(Test-Path $LogFile)) {
    New-Item $LogFile -type file
}

$startTime = get-date
$output = $webClient.DownloadString($HeartbeatUrl)
$endTime = get-date

if ($output -like "*" + $SuccessResponseString + "*") {
    # uncomment the below line if you want positive confirmation
    #"Success`t`t" + $startTime.DateTime + "`t`t" + ($endTime - $startTime).TotalSeconds + " seconds" >> $LogFile

    # remove the FailureLog if it exists to indicate we're in good shape.
    if (Test-Path $FailureLogFile) {
        Remove-Item $FailureLogFile
    }

} 
else {
    "Fail`t`t" + $startTime.DateTime + "`t`t" + ($endTime - $startTime).TotalSeconds + " seconds" >> $LogFile

    # restart the service if this is the first time it's failed since the last successful check.
    if (!(Test-Path $FailureLogFile)) {
        New-Item $FailureLogFile -type file
        "Initial failure:" + $startTime.DateTime >> $FailureLogFile
        Restart-Service $ServiceName
    }
} 
```

此脚本中唯一的逻辑是它只会在初始失败后尝试重新启动服务一次。这是为了防止出现服务需要一段时间才能重新启动的情况，并且在重新启动时，监视器会不断看到故障并再次重新启动（坏的无限循环）。否则，您几乎可以做任何事情，例如添加电子邮件通知，或者做的不仅仅是重新启动服务。

该脚本将执行一次，这意味着您需要在外部控制其重复。您可以在脚本中将其置于无限循环中，但这似乎有点不稳定。我使用 Windows 任务计划程序，执行它的方式如下： 程序：Powershell.exe 参数：-command "C:\projects\foo\scripts\monitor.ps1" -noprofile Start In: C:\projects\foo\scripts

您还可以使用更强大的调度程序，如 VisualCron，将其插入 Windows 服务，或通过 Quart.NET 等应用服务器调度程序。就我而言，任务调度程序工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-09T16:36:42.537

我正在使用 RGE Inc ( [http://www.ipsentry.com/](http://www.ipsentry.com/) ) 的 ipsentry。

已经用了好几年了，救了我很多次。

与他们无关，这不是广告，只是来自满意客户的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-14T21:20:16.297

当 Dan Tanner 无法连接、显示错误并且没有重新启动服务时，我稍微调整了他的脚本

```
$webClient = new-object System.Net.WebClient

###################################################
# BEGIN USER-EDITABLE VARIABLES

# the URL to ping
$HeartbeatUrl = "http://localhost:8080/"

# the response string to look for that indicates things are working ok
$SuccessResponseString = "Apache"

# the name of the windows service to restart (the service name, not the display name)
$ServiceName = "Tomcat6"

# the log file used for monitoring output
$LogFile = "c:\temp\log.log"

# used to indicate that the service has failed since the last time we checked.
$FailureLogFile = "c:\temp\log2.log"

# END USER-EDITABLE VARIABLES
###################################################

# create the log file if it doesn't already exist.
if (!(Test-Path $LogFile)) {
    New-Item $LogFile -type file
}

$startTime = get-date
try {
    $output = $webClient.DownloadString($HeartbeatUrl)
    $endTime = get-date

    if ($output -like "*" + $SuccessResponseString + "*") {
        # uncomment the below line if you want positive confirmation
        #"Success`t`t" + $startTime.DateTime + "`t`t" + ($endTime - $startTime).TotalSeconds + " seconds" >> $LogFile

        # remove the FailureLog if it exists to indicate we're in good shape.
        if (Test-Path $FailureLogFile) {
            Remove-Item $FailureLogFile
        }

    } 
    else {
        "Fail`t`t" + $startTime.DateTime + "`t`t" + ($endTime - $startTime).TotalSeconds + " seconds" >> $LogFile

        # restart the service if this is the first time it's failed since the last successful check.
        if (!(Test-Path $FailureLogFile)) {
            New-Item $FailureLogFile -type file
            "Initial failure:" + $startTime.DateTime >> $FailureLogFile
            Restart-Service $ServiceName
        }
    }
    }catch [Net.WebException] {
        New-Item $FailureLogFile -type file
        "Initial failure:" + $startTime.DateTime + $_.Exception.ToString() >> $FailureLogFile
        Restart-Service $ServiceName
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-02T17:12:09.947

这至少可以部分使用 Windows 附带的服务控制管理器来完成。它监视服务应用程序并可以在启动时自动启动它们，在崩溃时重新启动它们等。将应用程序编写为服务是一种选择，但如果您不能将应用程序编写为服务，那么您可以尝试包装进程`srvany.exe`在 Windows 资源工具包中 使用。

有关编写服务的更多信息：https: [//support.microsoft.com/en-us/kb/137890](https://support.microsoft.com/en-us/kb/137890)

至于实际的监控功能，我不完全确定什么是可用的，或者 SCM 功能的扩展。

# c# - C# Web 服务不会输出 JSON，只会输出 XML

> ID：663791
> 
> 赞同：9
> 
> 时间：2009-03-19T19:54:56.587
> 
> 标签：c#, jquery, web-services, json

我正在尝试将 jQuery 和 JSON 与我编写的 C# Web 服务一起使用。无论如何，以下代码只会以 XML 格式输出。

**网络服务代码**

```
[WebMethod]
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
public string HelloWorld() {
    return "Hello World!";
} 
```

我也有这些属性分配给类

```
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService] 
```

**jQuery 代码**

```
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: "ScheduleComputerDS.asmx/HelloWorld",
    data: "{}",
    dataType: "jsonp",
    success: function(data) {
        alert(data);
    }
}); 
```

ASMX 页面始终以内容类型“text/xml”的形式返回。有什么我想念的吗？

**编辑：**针对几个答案：

如果我的数据类型只是“json”，则内容仍然是 XML，jQuery 也不会调用我的回调函数。如果我添加“&callback=?” 到 url，IIS 会引发 HTTP 500 错误。

我的课程确实继承自“System.Web.Services.WebService”。

通过对你们的答案进行一些研究，看起来我确实需要弄乱 WCF。不幸的是，返回的 JSON 更多是为 MS Ajax 设计的，对我来说是很多无用的膨胀。我可能会研究像 Jayrock 或类似的开源库。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T20:06:01.553

我认为有一个错字：

```
dataType: "jsonp", 
```

应该：

```
dataType: "json", 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T20:13:08.243

Rich Strahl 有一个非常基本的帖子，应该可以帮助您解决这个问题。

[http://www.west-wind.com/weblog/posts/164419.aspx](http://www.west-wind.com/weblog/posts/164419.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T20:13:50.677

据我所知， ScriptService 属性仅允许服务自动创建 JavaScript 代理（通过将 /js 附加到端点地址 - 在您的情况下为 ScheduleComputerDS.asmx/js ）。它不允许您以您尝试的方式调用服务上的操作。

您可以改为使用 RESTful WCF 服务（需要 .NET 3.5），您可以通过 HTTP GET 发送正确形状的 URI 来访问该服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T20:05:31.943

您是否尝试过数据类型`json`？

另外，请查看 Encosia 的[Using jQuery to Consume ASP.NET JSON Web Services](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)文章。也有一些关于常见陷阱的好信息。

# asp.net - 如何在非 ASP.NET 应用程序中使用 ASP.NET Cache 对象？

> ID：663792
> 
> 赞同：4
> 
> 时间：2009-03-19T19:55:14.200
> 
> 标签：asp.net, caching

我想在我的应用程序中使用 System.Web.Caching.Cache 对象，但是此代码会引发 NullReferenceException。

```
Cache cache = new Cache();
cache["key"] = new object(); 
```

有任何想法吗 ？

***更新***

HttpRuntime.Cache 解决了我的问题，但有人有解决方案在我的应用程序中使用多个缓存实例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T19:56:08.380

使用[`HttpRuntime.Cache`](http://msdn.microsoft.com/en-us/library/system.web.httpruntime.cache.aspx)静态属性；它工作正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T19:58:34.253

[企业库缓存应用程序块](http://msdn.microsoft.com/en-us/library/cc309502.aspx)可能会对您有所帮助。它适用于 Windows 应用程序以及 ASP.NET 应用程序。

# visual-studio - Visual Studio Team System 的最佳功能是什么？

> ID：663795
> 
> 赞同：0
> 
> 时间：2009-03-19T19:55:30.907
> 
> 标签：visual-studio

Microsoft 里面有很多东西，但我想知道人们真正喜欢和真正使用 Visual Studio Team System 的哪些功能。

我特别考虑的是 Team System，而不是普通的旧 Visual Studio。

是什么让它物有所值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T19:57:15.037

我使用 VSTS2005 的开发版本并评估 2008。我的首选：

*   探查器
*   编码指南——规则执行部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T01:00:22.517

一些最佳功能来自添加 Team Foundation Server：

*   可以设置持续集成构建以在每个构建上运行单元测试
*   可以根据单元测试运行收集代码覆盖率数据
*   可以每天生成构建成功、单元测试成功、代码覆盖率等报告
*   代码签入可以将工作项（错误报告）标记为已修复，或者可以启动工作流来执行此操作

它不仅让开发人员更好地了解他们的代码发生了什么，以及如何修复它（单元测试、代码覆盖率、代码分析），它还为管理人员提供了相同的总体情况，而无需绕道而行单独对开发人员进行错误处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T01:08:52.200

我喜欢逐行归咎分析器（如前所述），但更重要的是，我喜欢它产生的报告，例如随着时间的推移的缺陷率。

然而，即使有很多我喜欢的功能，我当然不认为它物有所值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T20:13:25.250

我最喜欢的

1.  探查器
2.  集成测试环境：我知道很多人更喜欢其他测试框架，但是集成起来很甜蜜。
3.  FxCop

# c# - 如何在 VS2008 中制作特定于配置的 C# 构建事件

> ID：663810
> 
> 赞同：4
> 
> 时间：2009-03-19T19:59:55.873
> 
> 标签：c#, visual-studio, visual-studio-2008, build-process

在 vs2008 中，C# 构建事件是特定于配置的。

寻找有关如何使我的构建事件仅在进行发布构建时运行的想法。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T20:16:22.557

好的，按照布赖恩的说法，我正在这样做：

```
if "$(ConfigurationName)" == "Release" do_something 
```

它似乎工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:09:00.470

不幸的是，C# 项目不支持我发现的任何类似的东西。在某些情况下，我不得不求助于编写 makefile 来解决这个问题。您还可以编写一个批处理文件或一个接受参数的简单程序，然后从构建事件中调用它：

```
custom.exe $(ConfigurationName) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:08:31.267

VS2008 确实支持按配置构建事件。当您在项目的属性对话框中选择“所有配置”时，检查您是否正在设置构建事件。

# c++ - 为什么在 Eclipse 中出现“无法识别的仿真模式：32”错误？

> ID：663811
> 
> 赞同：3
> 
> 时间：2009-03-19T19:59:58.057
> 
> 标签：c++, eclipse, compiler-construction, g++

使用 -m32 参数编译时为什么会出现此错误？

> 无法识别的仿真模式：32

我在 x86_64 机器上使用 g++ 进行编译。它发生在一个项目中，但不会发生在另一个项目中……有什么提示吗？

**注意：**我使用的是 Eclipse CDT，所以也许这是一个特定于 IDE 的 gocha？

### 改写的问题

或许更好的问题是：在 x86_64 机器上运行时，在 Eclipse 中构建 x86 二进制文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T21:39:15.993

似乎在 Eclipse 中，如果在编译器选项中指定了 -m32，则必须在杂项链接器选项中指定它。

当您引用不存在的库路径时，会出现“无法识别的仿真模式：32”错误消息 - 这很奇怪！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T20:10:40.607

在一个项目中，您不`-m`小心将 传递给了链接器。GNU 链接器 (ld) 支持用于指定仿真模式的 -m 选项。仿真由链接描述文件、输出目标文件格式和它的参数组成——比如起始地址。注意不要放入`-m`LDFLAGS，而是放入 CXXFLAGS（C++ 编译器标志）或 CFLAGS（c 编译器标志）。

例如，my`ld`支持 elf_i386 和 i386linux 仿真模式，分别用于生成 ELF 二进制文件和 a.out 二进制文件。

# linq - ADO.NET 数据服务，LINQ

> ID：663816
> 
> 赞同：0
> 
> 时间：2009-03-19T20:01:07.603
> 
> 标签：linq, service, ado.net

我有 C# 代码来填充 Silverlight 中的下拉列表，除非有重复项，否则它工作正常。我认为因为`IEnumerable<Insurance.Claims>`是一个集合，它会过滤掉重复项。我将如何编码我的 LINQ 查询以接受重复项？

我的示例数据如下所示：

Code => CodeName
FGI Field General Initiative
SRI Static Resource Initiative
JFI Joint Field Initiative - 这在结果中被“覆盖”
JFI Joint Friend Initiative

```
IEnumerable<Insurance.Claims> results;

// ADO.NET Data Service
var claim = (from c in DataEntities.Claims.Expand("Claimants").Expand("Policies")
             where c.Claim_Number == claimNumber
             select c);

DataServiceQuery<Insurance.Claims> dataServiceQuery =
    claim as DataServiceQuery<Insurance.Claims>;

dataServiceQuery.BeginExecute((asyncResult) =>
{
    results = dataServiceQuery.EndExecute(asyncResult);

    if (results == null)
    {
        // Error
    }
    else
    {
        // Code to populate Silverlight form
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T13:37:06.063

（不确定你是否还在为此苦苦挣扎，但无论如何......）

我很确定这不是 IEnumerable 接口，而是导致这种行为的实际下拉菜单。该代码被用作密钥，因此显然每次遇到相同的代码时，该项目都会被覆盖。

我认为除非您更改代码或使用另一个标识符作为下拉菜单中的关键字段，否则您不能覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-24T21:39:40.223

您可能需要添加一个 try-catch 块`dataServiceQuery.EndExecute(asyncResult)`来正确处理错误。

# linq-to-sql - Linq to Sql 更新中的 ChangeConflictException

> ID：663822
> 
> 赞同：15
> 
> 时间：2009-03-19T20:03:29.703
> 
> 标签：linq-to-sql

我对此感到痛苦，如果有人可以提供帮助，我将非常感激。

我有一个 DataContext 附加到数据库上的单个测试表。测试表如下：

```
CREATE TABLE [dbo].[LinqTests](
    [ID] [bigint] IDENTITY(1,1) NOT NULL,
    [StringValue] [varchar](255) NOT NULL,
    [DateTimeValue] [datetime] NOT NULL,
    [BooleanValue] [bit] NOT NULL,
    CONSTRAINT [PK_LinqTests] PRIMARY KEY CLUSTERED ([ID] ASC))
ON [PRIMARY] 
```

使用 Linq，我可以在测试表中添加、检索和删除行，但我不能更新行——对于 UPDATE，我总是会得到一个带有空 ObjectChangeConflict.MemberConflicts 集合的 ChangeConflictException。这是使用的代码：

```
var dataContext = new UniversityDataContext();
dataContext.Log = Console.Out;

for (int i = 1; i <= 1; i++) {
    var linqTest = dataContext.LinqTests.Where(l => (l.ID == i)).FirstOrDefault();

    if (null != linqTest) {
        linqTest.StringValue += " I've been updated.";
    }
    else {
        linqTest = new LinqTest {
            BooleanValue = false,
            DateTimeValue = DateTime.UtcNow,
            StringValue = "I am in loop " + i + "."
        };
        dataContext.LinqTests.InsertOnSubmit(linqTest);
    }
}

try {
    dataContext.SubmitChanges(ConflictMode.ContinueOnConflict);
}
catch (ChangeConflictException exception) {
    Console.WriteLine("Optimistic concurrency error.");
    Console.WriteLine(exception.Message);
    Console.ReadLine();
}

Console.ReadLine(); 
```

这是通过 DataContext 执行的更新的日志输出。

```
UPDATE [dbo].[LinqTests]
SET [StringValue] = @p3
WHERE ([ID] = @p0) AND ([StringValue] = @p1) AND ([DateTimeValue] = @p2) AND (NOT ([BooleanValue] = 1))
-- @p0: Input BigInt (Size = 0; Prec = 0; Scale = 0) [1]
-- @p1: Input VarChar (Size = 15; Prec = 0; Scale = 0) [I am in loop 1.]
-- @p2: Input DateTime (Size = 0; Prec = 0; Scale = 0) [3/19/2009 7:54:26 PM]
-- @p3: Input VarChar (Size = 34; Prec = 0; Scale = 0) [I am in loop 1\. I've been updated.]
-- Context: SqlProvider(Sql2000) Model: AttributedMetaModel Build: 3.5.30729.1 
```

我在群集 SQL Server 2000 (8.0.2039) 上运行此查询。对于我的一生，我无法弄清楚这里发生了什么。对数据库运行类似的 UPDATE 查询似乎工作正常。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-16T17:46:49.937

我终于弄清楚这是怎么回事。显然，此服务器的“无计数”选项已打开。

在 Microsoft SQL Server Management Studio 2005 中：

1.  右键单击服务器，然后单击**属性**
2.  在“服务器属性”窗口的左侧，选择“**连接**”页面
3.  在默认连接选项下，确保未选择“无计数”。

显然，LINQ to SQL 在更新后使用@@ROWCOUNT 来发出自动乐观并发检查。当然，如果为整个服务器开启“无计数”，@@ROWCOUNT 总是返回零，并且 LINQ to SQL 在向数据库发出更新后抛出 ConcurrencyException。

这不是 LINQ to SQL 使用的唯一更新行为。如果表上有 TIMESTAMP 列，则 LINQ to SQL 不会使用 @@ROWCOUNT 执行自动乐观并发检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:14:31.830

是否有可能该行的任何数据在检索到更新和尝试更新之间发生了变化？因为 LINQ->SQL 具有自动并发检查，它将根据当前存储的值验证对象的内容（就像您在生成的查询中看到的那样）。如果数据库中的行与 LINQ 正在跟踪的对象相比，任何字段可能已更改，则更新将失败。如果发生这种情况并且有充分的理由并且您知道哪些字段，则可以在 DBML 设计器中更新对象；选择原因字段并将“更新检查”属性更改为“从不”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-02T15:52:52.503

我在使用 SQL Server 2008 时遇到了同样的问题，并且连接选项`no count` **已经关闭**。

`Update Check`我没有将属性更改为*Never*（正如 Quintin 建议的那样），而是将其设置为*WhenChanged*，问题就解决了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-28T21:29:40.697

首先记录有关问题的详细信息，哪些行和哪些字段存在冲突以及哪些值存在冲突。

要实现这样的详细日志，请在此处查看我的解决方案：

[如何解决 SQL Server Compact Edition 数据库上的 LINQ to SQL 中的“未找到或更改行”异常？](https://stackoverflow.com/questions/45045/what-can-i-do-to-resolve-a-row-not-found-or-changed-exception-in-linq-to-sql-o/32279975#32279975)

# windows - 安装文件名格式最佳实践

> ID：663823
> 
> 赞同：0
> 
> 时间：2009-03-19T20:03:42.697
> 
> 标签：windows, installation, filenames

当我想到安装文件名时，我正在阅读[Windows Vista 中的安装文件名。](https://stackoverflow.com/questions/469270/installation-file-names-in-windows-vista)我是一个上瘾的软件下载者，而且我经常有像“setup.exe”或“install.exe”这样的安装名称，这并没有说明要安装的程序。

我认为安装文件必须是这样的：

**Install[ProgramName][ProgramVersion][Platform].[exe|msi|etc]** 
或

**[ProgramName][ProgramVersion][Platform].Setup.[exe|msi|etc]** 

你的想法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T08:38:30.683

我更喜欢描述性安装文件名。有时，即使没有互联网连接，您也需要一个紧急“恢复”磁盘来启动和运行机器。当所有安装都命名为“setup.exe”时，您要么必须全部重命名，要么为每个安装创建一个具有描述性名称的目录。

一个这样的磁盘非常方便的例子是当我把我的全新笔记本电脑带到工作中，同时我将我的桌面升级到 Vista 64，然后是 Windows 7。我只有一个有线 LAN 点，所以我的笔记本电脑需要无线连接才能访问互联网，以下载我的安装。我必须将它们全部下载到我的桌​​面上，然后通过闪存驱动器传输到我的笔记本电脑上。很不方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T22:46:55.417

对于基于 CD-Rom 的安装，我建议坚持使用`SETUP.EXE`哪个有助于自动运行检测软件从磁盘安装。

对于可下载的文件，只需将适当的清单添加到 EXE 中，Vista 就不会出现问题。我建议一些半描述性的东西，但没有必要详细说明，除非它是一个人可以存档以供重用的硬件驱动程序，否则文件名会使非技术人员感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:15:51.997

不确定这是否完全与编程相关......但安装程序文件通常是暂时的。你下载它们，运行它们，然后删除它们。（或者至少，我认为大多数人都这样做）所以文件名是什么并不重要。

我认为没有任何理由*不*给安装程序起一个描述性的名称……但我当然不会说它“必须”有一个。

# sharepoint - 如何使用功能代码删除 WSS 3 中的“个性化此页面”选项？

> ID：663828
> 
> 赞同：3
> 
> 时间：2009-03-19T20:05:05.567
> 
> 标签：sharepoint, wss-3.0

如何删除 WSS 3.0 中的“个性化此页面”选项？如果可能的话，我想在具有 Web 应用程序级别的功能的代码中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T21:24:15.563

这是一个**权限**，可以在 WSS 的 Web UI 中访问：

站点设置 > 人员和组（在用户和权限下）> 站点权限（左侧快速启动栏）> 设置 > 权限级别

在每个权限级别下，都有一长串要包含的权限。在底部取消选中个人权限下的项目（主要是“管理个人视图”）。

我正在研究如何在代码中执行此操作，但我们的项目需要自定义用户组管理，因此我们不会为他们提供管理个人视图的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T01:50:20.307

或者，“个性化此页面”选项仅在包含允许个性化的 Web 部件区域的页面上可见。如果您使用的是自定义页面布局，则可以在 Web 部件区域上将“AllowPersonalization”属性设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T08:10:16.163

或者，您可以强制共享视图，从而禁用页面上的个性化。为此，请在任何 Web 部件中，在被覆盖的 OnLoad() 中执行以下操作：

```
if (WebPartManager.Personalization.Scope == PersonalizationScope.User)
{
    WebPartManager.Personalization.ToggleScope();
} 
```

但是，这通常不是最佳实践，因为它可能会影响页面中其他 Web 部件的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-03T22:01:05.870

它可以很容易地完成。打开 Welcome.ascx 在`c:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\CONTROLTEMPLATES`

并在下面 `<SharePoint:MenuItemTemplate runat="server" id="ID_PersonalizePage"` 添加`Visible="False"`

完美运行，但会为所有站点全局更改它。如果需要，将相同的代码添加到任何其他部分。

# iphone - iPhone SDK - UITextField 与联系人的 + 按钮

> ID：663830
> 
> 赞同：7
> 
> 时间：2009-03-19T20:05:20.557
> 
> 标签：iphone, button, uitextfield, contacts

在某些应用程序（如 Mail）中，当您拥有 UITextField 时，右侧会有一个小 + 按钮。当您点击它时，会出现一个模态视图控制器，您可以从中选择电话号码、地址等，它会出现在文本字段中。我想知道如何在我自己的应用程序中实现这一点。谢谢，
艾萨克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-05-27T06:05:21.547

你可以这样做

```
txtFldObj.rightView = [UIButton buttonWithType:UIButtonTypeContactAdd];

txtFldObj.rightViewMode=UITextFieldViewModeAlways; 
```

你也可以参考这个[技巧](http://www.iphonedevsdk.com/forum/iphone-sdk-development/42926-add-button-right-uitextfield.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-21T18:08:42.723

如果您想要文本字段内的加号按钮，请查看`rightView`UITextField 类的属性，它允许您将任何 UIView 放在文本字段的最右侧部分。您可以将 UIButton 放在那里，如创建

```
[UIButton buttonWithType:UIButtonTypeContactAdd]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T20:15:16.570

您可以通过使用包含 UITextField 和 UIButton 作为子视图的常规 UIView 来做到这一点。

例如

```
-------------------------------
| UITextField       | UIButton|
------------------------------- 
```

点击按钮时，您可以将地址簿选择器（或其他任何东西）作为模式视图调出，并在关闭时根据需要更新文本字段。

# java - 在Java中，类中的枚举类型是静态的吗？

> ID：663834
> 
> 赞同：128
> 
> 时间：2009-03-19T20:06:13.270
> 
> 标签：java, enums, scope

我似乎无法从枚举内部访问周围类的实例成员，就像我可以从内部类内部一样。这是否意味着枚举是静态的？是否可以访问周围类的实例的范围，或者我是否必须将实例传递给我需要的枚举方法？

```
public class Universe {
    public final int theAnswer;

    public enum Planet {
        // ...
        EARTH(...);
        // ...

        // ... constructor etc.

        public int deepThought() {
            // -> "No enclosing instance of type 'Universe' is accessible in this scope"
            return Universe.this.theAnswer;
        }
    }

    public Universe(int locallyUniversalAnswer) {
        this.theAnswer = locallyUniversalAnswer;
    }
} 
```

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-03-19T20:10:53.553

是的，嵌套枚举是隐式静态的。

从[语言规范第 8.9 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.9)：

> 嵌套枚举类型是隐式静态的。可以将嵌套枚举类型显式声明为静态。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-03-19T20:16:32.823

创建一个实例级（非静态）内部枚举类是没有意义的——如果枚举实例本身与外部类绑定，它们就会破坏枚举保证——

例如，如果你有

```
public class Foo {
   private enum Bar {
        A, B, C;
   } 
} 
```

为了使枚举值正确地充当常量，（伪代码，忽略访问限制）

```
Bar b1 = new Foo().A
Bar b2 = new Foo().A 
```

b1 和 b2 必须是相同的对象。

# c# - 从 c# setup 项目运行另一个程序

> ID：663835
> 
> 赞同：3
> 
> 时间：2009-03-19T20:06:41.053
> 
> 标签：c#, windows, deployment, installation

我已经在 C# 中创建了一个设置和部署项目，现在我有另一个 Windows 更新 exe，我想在它安装我的项目之前成功运行和安装它。我已将 exe 与我的项目打包在一起。我以前如何运行那个exe？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T20:11:38.763

您想要将自定义操作添加到运行可执行文件的安装项目。本演练将带您了解如何使 htat 正常工作。

[http://msdn.microsoft.com/en-us/library/d9k65z2d(VS.80).aspx](http://msdn.microsoft.com/en-us/library/d9k65z2d(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:12:01.587

在您自己的 MSI 文件之前应安装的任何其他软件包必须由 setup 引导程序（即 setup.exe 文件）安装。为此，您应该右键单击您的安装项目，选择属性，然后选择先决条件。该对话框将列出引导程序可以安装的组件。

现在，如果您要安装的组件在此列表中，那么您就完成了。否则，您必须更深入地研究引导程序的机制。列表中的每个项目都有一个关联的包描述存储在

```
C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages 
```

对于 VS 2005 或

```
C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages 
```

对于 VS 2008。这个包定义基本上包含了关于安装什么、如何获取组件（下载 url）以及如何检查是否需要安装的说明。

对于自定义组件，您可以创建[自己的包定义](http://msdn.microsoft.com/en-us/library/aa730839(VS.80).aspx)。如果您不想手动执行此操作，可以使用[Bootstrapper Manifest Generator](http://code.msdn.microsoft.com/bmg)。

编辑：如果您不想使用 boostrapper 采用相当复杂但功能强大的方式，您可能想看看 IExpress。这是一个包含在 MS Windows 中的免费工具，它允许您创建一个包含多个组件并执行自定义脚本的自解压安装包。IExpress 有一个图形用户界面，但也可以查看创建的 .sed 文件以获取更多选项。

# javascript - jquery解绑事件速度增加

> ID：663842
> 
> 赞同：1
> 
> 时间：2009-03-19T20:09:31.560
> 
> 标签：javascript, jquery

我正在制作一个大型内容幻灯片页面，该页面开始使用大量事件触发器。还有大约一半的人使用 livequery 插件。

通过在幻灯片之间卸载这些事件以便只有活动幻灯片具有绑定事件，我会看到速度增加吗？

原生 livequery 也比 livequery 插件快得多吗？（因为它的功能肯定不那么好）

也会是这样的： http: [//dev.jquery.com/attachment/ticket/2698/unload.js](http://dev.jquery.com/attachment/ticket/2698/unload.js)

也取消绑定实时查询事件？

我真的只需要知道卸载/加载事件侦听器需要多长时间，如果我让它们运行，它们真正消耗了多少周期。此外，任何有关现场活动的信息都会很棒。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T20:17:31.620

我需要更多详细信息来提供实际代码，但您可能需要查看[事件委托](http://developer.yahoo.com/yui/examples/event/event-delegation.html)：

> 事件委托是指在父对象上使用单个事件侦听器来侦听其子对象（或更深层的后代）上发生的事件。事件委托允许开发人员在他们的事件侦听器应用程序中保持稀疏，同时仍然在事件发生在高度特定的目标上时对其做出反应。这被证明是在事件丰富的 Web 项目中保持高性能的关键策略，其中创建数百个事件侦听器会迅速降低性能。

一个快速的基本示例：

假设您有一个带有图像的 DIV，如下所示：

```
<div id="container">
    <img src="happy.jpg">
    <img src="sad.jpg">
    <img src="laugh.jpg">
    <img src="boring.jpg">
</div> 
```

但不是 4 个图像，而是 100 个或 200 个。您希望将单击事件绑定到图像，以便在用户单击它时执行 X 操作。大多数人的第一个代码可能如下所示：

```
$('#container img').click(function() {
    performAction(this);
}); 
```

这将绑定大量的事件处理程序，这些事件处理程序会降低页面的性能。使用事件委托，您可以执行以下操作：

```
$('#container').click(function(e) {
    if($(e.target)[0].nodeName.toUpperCase() == 'IMG') {
        performAction(e.target);
    }
}); 
```

这只会将 1 个事件绑定到实际容器，然后您可以通过使用事件的`target`属性来确定单击了什么并相应地委托。不过，这仍然是一种痛苦，您实际上可以通过使用 jQuery 的[`live`](http://docs.jquery.com/Events/live)函数来获得显着的性能改进，而无需执行所有这些操作：

```
$('#container img').live('click', function() {
     performAction(this);
}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T22:10:23.597

如果`liveQuery`您的意思是“本机” [`live()`](http://docs.jquery.com/Events/live)，那么是的，`live()`明显快于`liveQuery()`. 后者用于`setInterval`定期查询整个文档树中的新元素，而前者使用[事件委托](http://www.sitepoint.com/blogs/2008/07/23/javascript-event-delegation-is-easier-than-you-think/)。

事件委托胜出。简而言之，无论您调用多少个选择器，`live()`都会在每个事件类型上注册*一个*处理程序（例如，） 。`document``click``live()`

至于您的另一个问题，听起来您正在绑定到每张幻灯片的元素，并且想知道解除绑定和再次绑定是否有效？我会说WRT内存，是的。WRT CPU 周期，没有。

需要明确的是，使用这种`liveQuery()`方法 CPU 将永远不会休眠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T20:58:17.727

物有所值。我们刚刚对这个问题进行了一些测试。我们创建了一个页面，其中 div 包含许多 div，每个 div 都需要有一个 onclick 处理程序显示一个带有显示其 id 的警报对话框。

在一种情况下，我们使用了 DOM Level 0 事件注册，并直接在 html 中为每个事件定义了事件处理程序：onclick="_do_click(this);"。在另一种情况下，我们使用 DOM 级别 2 事件传播并在包含的 div 上定义了单个事件处理程序。

我们发现，在 100,000 个包含的 div 中，FireFox 的加载时间差异可以忽略不计。花了很长时间。在 Safari 中，我们发现 DOM 级别 0 比 DOM 级别 2 花费的时间是 DOM 级别 2 的两倍，但仍然比任何一种 FireFox 情况都快四倍。

所以，是的，它确实会带来更好的性能，但看起来你真的必须尝试创造一个明显的惩罚。

# wpf - WPF - 如何将边框停靠在画布上？

> ID：663844
> 
> 赞同：2
> 
> 时间：2009-03-19T20:10:19.577
> 
> 标签：wpf, layout, canvas, dock

我在画布内有一个边框。边框的高度/宽度根据其内容而变化。我希望边框伸展以填满整个画布。我怎样才能做到这一点？

我在边境上试过这个没有成功：

```
Height="{Binding ElementName=MainCanvas, Path=Height}" 
Width="{Binding ElementName=MainCanvas, Path=Width}" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T20:13:43.033

画布是否有明确的高度/宽度？它可能是自动调整大小并且具有 double.NaN 的高度/宽度。

尝试将子高度/宽度绑定到画布的 ActualHeight 和 ActualWidth ，如下所示：

```
Height="{Binding ElementName=MainCanvas, Path=ActualHeight}"
Width="{Binding ElementName=MainCanvas, Path=ActualWidth}" 
```

画布面板从不告诉孩子相对于他们的尺寸大小，即使孩子被设置为 Horizo​​ntalAlignment.Stretch（或垂直）。所以绑定在这里是一个很好的解决方案。

# sharepoint - 将 MOSS 2007 Sharepoint 站点移动到新服务器

> ID：663845
> 
> 赞同：1
> 
> 时间：2009-03-19T20:10:24.290
> 
> 标签：sharepoint, moss

我有一个托管在服务器上的 MOSS 2007 站点。我想把它移到一个新的服务器、数据库和所有东西上。在寻求帮助时，人们通常会说，“只需运行备份，在新服务器上安装 MOSS 并执行还原即可。” 这够好吗？我似乎无法让它工作。安装新的 MOSS 2007 时需要选择哪些选项？我需要附加旧数据库吗？它是具有四个网站集的单个服务器，而不是场。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T20:12:21.320

好写在这里：

[http://www.sharepointblogs.com/adnan/archive/2007/01/26/move-moss-2007-web-application-to-another-server.aspx](http://www.sharepointblogs.com/adnan/archive/2007/01/26/move-moss-2007-web-application-to-another-server.aspx)

确保源服务器和目标服务器的版本相同（包括服务包和补丁）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T20:31:36.280

按照 Rob 发布的指南进行操作。不要使用 SharePoint 中的内置备份功能来移动网站。一开始它似乎可以工作，但迟早你会因为引用旧服务器而遇到问题。

# iphone - UITableView - 选择了哪一行？

> ID：663853
> 
> 赞同：45
> 
> 时间：2009-03-19T20:12:26.890
> 
> 标签：iphone, objective-c

我有一个问题 - 如何在表格中选择多行？我手动将它分配给一个变量。问题是如果取消选择一行，我的变量仍然保留旧值。

我能做些什么呢？UITableView 中是否有返回当前选定行数的方法？

提前谢谢你，伊利亚。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-03-19T20:34:31.640

如果您还没有实现委托（参见 nduplessis），UITableView 还提供：

```
- (NSIndexPath *)indexPathForSelectedRow 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-19T20:29:23.557

UITableViewDelegate 将调用

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

选择行时。从此，您可以使用 indexPath.section 和 indexPath.row 轻松确定行

# php - 数学相关的 PHP 问题 + 纬度

> ID：663868
> 
> 赞同：0
> 
> 时间：2009-03-19T20:14:54.277
> 
> 标签：php, google-maps, geolocation, distance

我在一个 PHP 页面中找到了一个计算 2 点之间的英里数的函数，但它有问题。它应该适用于谷歌地图，但距离差异在谷歌地图中的范围是 1.3 到 1.65 倍（更准确）。

这是功能：

```
$M =  69.09 * rad2deg(acos(sin(deg2rad($lat1)) * sin(deg2rad($lat2)) +  cos(deg2rad($lat1)) * cos(deg2rad($lat2)) * cos(deg2rad($lon1 - $lon2)))); 
```

我发现它有点复杂，而且我对几何学了解不多，不知道这是否正确。

有更多专业知识的人可以看看这个，看看有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T20:19:35.140

也许您正在将“乌鸦飞行的距离”（两点之间的直线）与行驶距离进行比较？

另外，[请参阅这篇文章](https://stackoverflow.com/questions/407989/calculating-distance-between-zip-codes-in-php)以计算 PHP 中两点之间的距离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T20:27:47.117

您正在寻找[Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)来计算具有经度和纬度的两点之间的距离。

[可以在这里找到](http://www.movable-type.co.uk/scripts/latlong.html)它在 Javascript 中的直接实现，它应该很容易转换为 PHP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T20:38:27.403

至少有三种不同的计算地球表面距离的方法，它们的准确性和所需的计算量各不相同。

1.  [球面余弦定律](http://en.wikipedia.org/wiki/Spherical_law_of_cosines)[不是很精确，计算很简单]
2.  [Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)[除了在较小的距离处准确，计算仍然相对简单]
3.  [文森特公式](http://www.movable-type.co.uk/scripts/latlong-vincenty.html)[精度高，可以使用地球表面的几种不同椭球模型，计算更复杂]

您提供的示例似乎是余弦计算定律，而谷歌地图更准确，因为它使用文森蒂公式。（我发现 Vincenty 链接比维基百科页面更详细地解释了公式）

编辑：我在上面看到一条评论，地球表面偏差引入的错误是微不足道的，不能构成您所看到的错误。恐怕这仅在很远的距离上才是正确的。在几百公里或更短的距离内，错误绝对是不小的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T05:04:04.070

这是一个更简单的版本，但对于非常遥远的位置并不准确：

```
 const ONE_DEGREE = 111120;

public function distance( $point ) {
    $coef = cos( $this->getLatitude() / 180 * M_PI );
    $x = $this->getLatitude() - $point->getLatitude();
    $y = ( $this->getLongitude() - $point->getLongitude() ) * $coef;
    $result = sqrt( $x * $x + $y * $y ) * self::ONE_DEGREE;
    return $result;
} 
```

$point 和 $this 是具有 getLatitude() 和 getLongitude() 方法的 Location 类的实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T20:19:59.150

我对几何也一无所知，但谷歌推荐[了这个页面](http://www.web-max.ca/PHP/misc_2.php)。也许你会发现它很有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T20:28:11.920

看起来您引用的计算使用球坐标系。这个公式几乎是正确的。可能导致您的计算失败的部分原因是您正在使用的半径。69.09 是球体的半径（在本例中为地球）。您可能知道，地球实际上并不是一个球体，更像是一个椭球体。我建议尝试以下公式：

```
3963 * acos(sin(deg2rad($lat1)) * sin(deg2rad($lat2)) +  cos(deg2rad($lat1)) * cos(deg2rad($lat2)) * cos(deg2rad($lon1 - $lon2))); 
```

要获得更准确的结果，您需要使用 Vincenty 或 Haversine 计算。

编辑：澄清一下，我并不是要暗示您报告的大部分错误是由于使用球坐标计算造成的。该错误比您看到的要小得多。我提供的公式调整旨在成为公式的更清晰版本，因为 69.09 是调整为度数系统的地球半径值，这比简单地使用弧度更不直观。此外，值得注意的是，对于计算非常小的距离，只要进行计算的系统使用足够的小数位，使用上面的公式就非常准确（低至大约 1m 的距离）。在现代计算中使用浮点数可为您提供这种准确性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-19T20:28:18.863

看起来该公式是准确的 - 例如，请参见[Wikipedia on "great circle distance"](http://en.wikipedia.org/wiki/Great-circle_distance)。我相信前面的 69.09 是沿大圆测量的 1 度的英里数（例如，赤道 1 度经度的英里），所以你的答案将以英里为单位。

jonstjohn 认为您可能错误地将直线距离与行驶距离进行了比较，这对我来说似乎是最有可能的解释。

*编辑*：或者它可能是维基百科提到的舍入错误，如果你正在处理小分离。但我会首先指出直接/行驶距离的差异。

# c++ - c++类为什么需要main？

> ID：663870
> 
> 赞同：1
> 
> 时间：2009-03-19T20:15:17.087
> 
> 标签：c++, class, main

您好，我正在用 C++ 编写一个小项目，我希望有一些可以完成某些工作的类，我编写了接口和类的实现。

令我惊讶的是，我不能有一个没有 main() 的简单类，我希望有一个一旦实例化的类，它的方法可以被调用，做事，但我不需要（也不想要）一个main() 在类实现中。这是我想拥有的一个例子：

文件动物.h：

```
class animal
{
 public: 
   animal();
  ~animal();

 public:
   int method1(int arg1);

 private:
   int var1;
}; 
```

文件动物.cpp：

```
#include "animal.h"

animal::animal(){...}
animal::~animal(){...}
int animal::method1(int arg1){return var1;}
} 
```

我想从另一个文件中调用动物类并让它工作，像这样：文件app.cpp：

```
#include <neededlib>
#include "animal.h"

int main()
{
 animal dog;
 cout << dog.method1(42);
 return 0;
} 
```

但是编译器给了我

```
/usr/lib/gcc/i686-pc-linux-gnu/4.3.3/../../../crt1.o: In function _start:

"(.text+0x18): undefined reference to `main`"

collect2: ld returned 1 exit status 
```

对于animal.cpp，但我不需要那里的main，还是我需要它？

我哪里错了？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-19T20:18:55.487

> 但我不需要（也不想要）类实现中的 main() 。

该函数`main`是您的入口点。这就是执行开始的地方。您需要拥有一个且只有一个这样的功能。

> 但是编译器给了我animal.cpp的“未定义的main引用”，但我不需要main，还是我需要它？

现在，您的问题看起来像您没有*链接*`app.cpp`和的编译形式`animal.cpp`。

> 我在 Makefiles 中不是那么强，我使用了 g++ animal.h -o animal 和 g++ animal.cpp 之类的东西，但它给了我上面的错误

你不编译标题。所以不要使用：`g++ animal.h`

当您单独编译animal.cpp 时，g++ 创建了一个目标文件。您还需要编译 ，因为`app.cpp`您*确实需要*`main`. 编译`app.cpp`文件后，您必须将其与`animal`之前创建的目标文件链接。但是，如果这些没有得到链接，特别是包含该`main`函数的文件，您将遇到您现在遇到的错误。

但是，`g++`请注意我上面描述的内容。尝试这样的事情：

```
g++ animal.cpp app.cpp -o test 
```

这将创建一个名为的可执行文件`test`，您可以使用以下命令运行您的应用程序：

```
./test 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-19T20:24:49.510

首先，这是错误的：`animal dog = new animal();`

你要么需要

```
animal * dog = new animal();
cout << dog->method1(42);
delete animal; 
```

或者最好只是

```
animal dog; 
```

其次，您需要将通过编译两个源 .cpp 文件生成的目标文件链接在一起。

```
gcc -o animal animal.cpp app.cpp 
```

如果您使用的是 gcc，应该可以解决问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-19T20:19:36.560

您应该将它们一起编译（在一个`g++`命令中）或将它们都编译为目标文件（`g++ -c`），然后使用`ld`将目标文件链接在一起。

示例生成文件：

```
all: app.exe

app.exe: app.o animal.o
    g++ -o app.exe app.o animal.o

app.o: app.cpp
    g++ -c -o app.o app.cpp

animal.o: animal.cpp animal.h
    g++ -c -o animal.o animal.cpp 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T20:31:11.180

```
class animal
{
 public: 
   animal();
  ~animal();

 public:
   method1(int arg1);

 private:
   int var1;
}; 
```

请注意，您没有在类声明的末尾放置分号。C++ 需要它，如果您忘记它，有时会给出令人困惑/误导性的错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T02:21:31.657

```
 public:
   method1(int arg1); 
```

您缺少 method1 的返回类型。你的意思是像

```
 int method1(int arg1); 
```

# wpf - WPF MVVM ComboBox SelectedItem 或 SelectedValue 不起作用

> ID：663881
> 
> 赞同：44
> 
> 时间：2009-03-19T20:16:50.187
> 
> 标签：wpf, mvvm, combobox

**更新**

经过一番调查。问题似乎是 SelectedValue/SelectedItem 在项目源完成加载之前发生。如果我坐在断点处等待几秒钟，它会按预期工作。不知道我将如何解决这个问题。

**结束更新**

我有一个在 WPF 中使用 MVVM 和 ComboBox 的应用程序。下面是 ViewModel 示例。我遇到的问题是，当我们离开页面并迁移回 ComboBox 时，没有选择当前选中的值。

**查看模型**

```
public class MyViewModel
{
     private MyObject _selectedObject;
     private Collection<Object2> _objects;
     private IModel _model;

     public MyViewModel(IModel model)
    {
         _model = model;
         _objects = _model.GetObjects();
    }

    public Collection<MyObject> Objects
    {
         get
         {
              return _objects;
         }
         private set
         {
              _objects = value;
         }
     }

     public MyObject SelectedObject
     {
          get
          {
              return _selectedObject;
          }
          set
          {
               _selectedObject = value;
          }
      }
 } 
```

为了这个例子，假设 MyObject 有两个属性（Text 和 Id）。我的 ComboBox 的 XAML 看起来像这样。

XAML

```
<ComboBox Name="MyComboBox" Height="23"  Width="auto" 
    SelectedItem="{Binding Path=SelectedObject,Mode=TwoWay}" 
    ItemsSource="{Binding Objects}"
    DisplayMemberPath="Text"
    SelectedValuePath="Id"> 
```

当我回到页面并重新组装对象时，无论我以哪种方式配置它，ComboBox 都不会选择该值。该对象通过属性中的 get 返回正确的对象。

我不确定这是否只是 ComboBox 和 MVVM 模式工作方式的问题。我们正在做的文本框绑定工作正常。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-26T06:58:57.873

设置`IsSynchronizedWithCurrentItem="True"`对我有用！

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-19T20:33:28.383

您是否尝试过在视图模型中实现`INotifyPropertyChanged`，然后在设置`PropertyChanged`时引发事件`SelectedItem`？

如果这本身不能解决问题，那么您将能够`PropertyChanged`在导航回页面时自己手动引发事件，这足以让 WPF 重新绘制自身并显示正确的选定项目。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-01-13T02:45:09.390

您需要将 ItemsSource 属性放在 SelectedItem 属性之前。几天前我看到一个博客提到了这个问题。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-19T21:50:55.733

我遇到过类似的问题，并通过确保我正确实施**IEquatable**来解决。当绑定发生时，它会尝试查看对象是否匹配，因此请确保您正确实施了相等检查。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-10-03T19:32:49.427

在这种情况下，selecteditem 绑定不起作用，因为对象的哈希 id 不同。

一种可能的解决方案是：

根据选中的项目 id，恢复 itemsource 集合上的对象并将选中的项目属性设置为它。

例子：

```
<ctrls:ComboBoxControlBase SelectedItem="{Binding Path=SelectedProfile, Mode=TwoWay}" ItemsSource="{Binding Path=Profiles, Mode=OneWay}" IsEditable="False" DisplayMemberPath="Name" /> 
```

绑定到 ItemSource 的属性是：

```
public ObservableCollection<Profile> Profiles
{
   get { return this.profiles; }
   private set { profiles = value; RaisePropertyChanged("Profiles"); }
} 
```

绑定到 SelectedItem 的属性是：

```
public Profile SelectedProfile 
{
    get { return selectedProfile; }
    set
    {
        if (this.SelectedUser != null)
        {
            this.SelectedUser.Profile = value; 
            RaisePropertyChanged("SelectedProfile");  
        } 
    } 
} 
```

恢复代码为：

```
 [Command("SelectionChanged")]
    public void SelectionChanged(User selectedUser)
    {
        if (selectedUser != null)
        {
            if (selectedUser is User)
            {
                if (selectedUser.Profile != null)
                {
                    this.SelectedUser = selectedUser;
                    this.selectedProfile = this.Profiles.Where(p => p.Id == this.SelectedUser.Profile.Id).FirstOrDefault();
                    MessageBroker.Instance.NotifyColleagues("ShowItemDetails"); 
                }
            }
        }            
    } 
```

我希望它对你有帮助。我花了很多时间寻找答案，但我找不到。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-02-17T20:01:11.963

离开当前页面时，`CollectionView`与 的`ItemsSource`属性相关联的内容将`ComboBox`被清除。并且因为该`ComboBox` `IsSyncronizedWithCurrent`属性默认为true，所以`SelectedItem`和`SelectedValue`属性被重置。
这似乎是绑定中的内部数据类型问题。正如上面其他人建议的那样，如果您`SelectedValue`通过绑定到视图模型上的 int 属性来代替，它将起作用。您的捷径是覆盖`Equals`MyObject 上的运算符，以便在比较两个 MyObject 时比较实际`Id`属性。

另一个提示：如果您确实重组了您的视图模型并使用`SelectedValue`，请仅在`SelectedValuePath=Id`where `Id`is时使用它`int`。如果使用字符串键，则绑定到的`Text`属性，`ComboBox`而不是`SelectedValue`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-20T21:30:28.347

我之前也注意到了这种行为。我注意到 SelectedIndex 属性不会导致相同的错误。如果您可以重组 ViewModel 以公开所选项目的索引并绑定到该索引，那么您应该很高兴。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-14T15:21:56.680

我有同样的问题。事情是。所选项目不知道它应该使用集合中的哪个对象。因此，您必须对所选项目说要使用集合中的项目。

```
public MyObject SelectedObject
 {
      get
      {
          Objects.find(x => x.id == _selectedObject.id)
          return _selectedObject;
      }
      set
      {
           _selectedObject = value;
      }
 } 
```

我希望这有帮助。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-08-04T17:57:09.587

对于这个问题，我有一个非常简单的答案。首先将以下代码添加到视图 IsSynchronizedWithCurrentItem="True"。

接下来，当您将 ViewModel 中的新对象分配给该属性时，应将 SelectedObject 保存到该属性而不是私有成员。

viewmodel 属性应该是这样的

```
 public Role SelectedObject 
    {
        get { return object; }
        set
        {
            if (value != null)
            {
                if (!object.Equals(value))
                {
                    object = value;
                    OnPropertyChanged(() => SelectedObject );
                }
            }
        }
    } 
```

这应该可以解决问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-08-16T20:48:07.533

我通过在 UserControl_Loaded 事件中添加调度程序解决了这个问题

```
 Dispatcher.BeginInvoke(DispatcherPriority.Loaded, new Action(() =>
 {
     combobox.SelectedIndex = 0;
 })); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-08T07:38:35.423

IsSyncronizedWithCurrent=False 将使其工作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-08T23:42:56.557

我与这个问题斗争了一段时间。在我的情况下，我使用复杂类型（列表）作为项目源，并使用 KeyType 作为选定值。在加载事件中，KeyType 被设置为 null。这导致一切都崩溃了。键更改时，不会更新任何子元素。事实证明，当我添加检查以确保 KeyType 的建议值不为空时，一切都按预期工作。

```
 #region Property: SelectedKey
    // s.Append(string.Format("SelectedKey : {0} " + Environment.NewLine, SelectedKey.ToString()));

    private KeyType _SelectedKey = new KeyType();
    public KeyType SelectedKey
    {
        get { return _SelectedKey; }
        set
        {
            if(value != null )
                if (!_SelectedKey.Equals(value))
                {
                    _SelectedKey = value;
                    OnPropertyChanged("SelectedKey");
                }
        }
    }
    #endregion SelectedKey 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-04-21T10:19:02.057

`SelectedValuePath`和的类型`SelectedValue`必须完全相同。

例如，如果`SelectedValuePath`is`Int16`的类型和绑定到`SelectedValue`is的属性的类型`int`将不起作用。

我花了几个小时来找到它，这就是为什么我在问了这么多时间之后在这里回答这个问题。也许像我这样有同样问题的可怜人可以看到它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-11T16:52:32.487

我在显示颜色列表（ List<Brush> ）的 ComboBox 时遇到了这个问题。
选择颜色是可能的，但在选择关闭时它没有显示（尽管属性已更改！）

**修复是覆盖**ComboBox (Brush) 中选择的类型的 Equals(object obj) 方法，这并不简单，因为 Brush 是密封的。所以我写了一个包含 Brush 并实现 Equals的类**EqualityBrush ：**

```
public class EqualityBrush
{
    public SolidColorBrush Brush { get; set; }

    public override bool Equals(object o)
    {
        if (o is EqualityBrush)
        {
            SolidColorBrush b = ((EqualityBrush)o).Brush;
            return b.Color.R == this.Brush.Color.R && b.Color.G == this.Brush.Color.G && b.Color.B == this.Brush.Color.B;
        }
        else
            return false;
    }
} 
```

使用我的新 EqualityBrush 类的列表而不是普通的 Brush 类解决了问题！

我的组合框**XAML**如下所示：

```
<ComboBox ItemsSource="{Binding BuerkertBrushes}" SelectedItem="{Binding Brush, Mode=TwoWay}" Width="40">
    <ComboBox.Resources>
        <DataTemplate DataType="{x:Type tree:EqualityBrush}">
            <Rectangle Width="20" Height="12" Fill="{Binding Brush}"/>
        </DataTemplate>
    </ComboBox.Resources>
</ComboBox> 
```

请记住，我在**ViewModel**中的“画笔”属性现在必须是 EqualityBrush 类型！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-21T14:42:54.513

这可能是您将 DataContext 应用于页面的方式。在 WPF 中，每次导航到页面时，所有内容都会重新初始化，调用构造函数，加载方法，一切。因此，如果您在 View 中设置 DataContext ，您无疑会吹走用户选择的 SelectedItem。为了避免这种情况，请使用页面的 KeepAlive 属性。

```
<Page KeepAlive="True" ...>
   ...
</Page> 
```

这将导致在导航回您已经访问过的页面时仅触发 Loaded 事件。因此，您需要确保在 Initialize（外部或构造函数内）而不是 Load 上设置 DataContext。

但是，这仅适用于页面的该实例。如果您导航到该页面的新实例，它将再次调用它的构造函数。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-06-28T10:32:28.237

组合框.SelectionBoxItem.ToString()

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-02-01T13:48:59.500

使用 Loaded 事件：

```
private void cmb_Loaded(object sender, RoutedEventArgs e) {
    if (cmb.Items.Count > 0) cmb.SelectedIndex = 0;          
} 
```

这个对我有用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-06-07T13:59:15.063

您还可以将 SelectedIndex 绑定到 ViewModel 中的属性并以这种方式操作 SelectedItem：

```
 public int SelectedIndex
        {
            get { return _selectedIndex; }
            set
            {
                _selectedIndex = value;
                OnPropertyChanged();
            }    
        } 
```

在您的 XAML 中：

```
<ComboBox SelectedIndex="{Binding SelectedIndex,Mode=TwoWay}" ... > 
```

# c# - 通过 Crystalreport 查看器打印问题

> ID：663882
> 
> 赞同：0
> 
> 时间：2009-03-19T20:17:09.327
> 
> 标签：c#, asp.net, crystal-reports

我正在尝试打印报告或将其导出为 pdf 文件。CrystalReportViewer 绑定没问题，但是，当我点击 NAV 的打印按钮时，什么也没有发生，你能帮帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-11T20:31:43.917

查看您在 CRV 中的打印机设置。它有打印机吗？听起来您在设置中没有打印机。

# nhibernate - 开始使用休眠

> ID：663884
> 
> 赞同：3
> 
> 时间：2009-03-19T20:17:21.510
> 
> 标签：nhibernate

你能建议我任何他们可以解释使用 nhibernate for dummy 的资源吗？

我什至不知道要下载哪个版本或Visual Studio 2008 以及在哪里下载？

下载后如何使用，dll文件和东西放在哪里？

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T20:22:57.223

我强烈推荐 Steven Bohlen 的优秀系列[Summer of NHibernate](http://www.summerofnhibernate.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T12:20:06.157

从 manning 出版物中查看 Nhibernate in Action ...

[NHibernate 在行动](http://www.manning.com/kuate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:32:39.310

Also have a look at [http://fluentnhibernate.org/](http://fluentnhibernate.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T21:25:34.187

[NHibernate 常见问题博客](https://web.archive.org/web/20110227204838/http://blogs.hibernatingrhinos.com/nhibernate/Default.aspx)是一个很好的初学者资源。一路回到 2008 年 3 月的帖子，了解初学者的介绍。

# internet-explorer - Internet Explorer 8 将如何影响 Web 应用程序的 QA 测试

> ID：663887
> 
> 赞同：4
> 
> 时间：2009-03-19T20:18:24.130
> 
> 标签：internet-explorer, browser, cross-browser

现在 IE 8 可用：

[http://www.microsoft.com/windows/internet-explorer/worldwide-sites.aspx](http://www.microsoft.com/windows/internet-explorer/worldwide-sites.aspx)

这是要管理的三种 IE 风格 - 6、7、8 和 QA 代码，如果您添加 Firefox、Safari、Chrome 等 - 6 个浏览器。

人们如何处理所有这些浏览器并通过他们的代码实现它们之间的最大多样性？

您如何看待具有基本操作系统的虚拟机，然后克隆它们并升级浏览器，以便我们拥有带有 IE 6、7 和现在 8 的 Windows 2000 Pro，然后是带有 IE 6、7 和 8 等的 WinXP Pro？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-19T20:20:03.657

Microsoft 正在发布的一个新程序称为 Microsoft Expression SuperPreview，它将允许您在 IE 6/7/8 中测试网站，完成后将允许您在 Firefox、Chrome、Opera 和 Safari 中进行测试。

编辑：这是有关它的 MSDN 博客文章：

[http://blogs.msdn.com/xweb/archive/2009/03/18/Microsoft-Expression-Web-SuperPreview-for-Windows-Internet-Explorer.aspx](http://blogs.msdn.com/xweb/archive/2009/03/18/Microsoft-Expression-Web-SuperPreview-for-Windows-Internet-Explorer.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:21:32.607

因此，我个人希望尽快放弃对 IE6 的支持。;-)

“很快”可能会比我喜欢的要长，但可以肯定的是，没有新的开发将支持 IE6。

我真的很想知道像 jQuery 这样的库在哪里。以前他们说他们支持最新的官方版本和以前的主流浏览器版本（例如，它是 IE7 和 IE6）......我想知道下一个版本的 jQuery 是否会转储 IE6。这将是一个大胆、勇敢的举措，但肯定会在未来打造一个更好、更紧凑的图书馆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:38:47.620

IE6 已经开始失去支持，我觉得 IE8 的发布可能是最后一根稻草。很少有产品同时具有三个单独的受支持产品。

到目前为止，我已经在大多数网站中放弃了对 IE6 的支持。我将 Dean Edward 的脚本扔到页面上，如果 IE6 仍然无法正常工作，那就结束了，除非 IE6 至关重要。

# java - 如何设置 Java 以使用 Eclipse 的用户特定证书？

> ID：663890
> 
> 赞同：9
> 
> 时间：2009-03-19T20:18:56.593
> 
> 标签：java, eclipse, security, trac, pkcs#12

我不敢相信我是唯一遇到这个问题的人。我已经在谷歌上搜索了几个小时，但没有任何运气。Java 安全文档似乎没有彻底解决 PKCS12 证书。

我正在尝试为用户特定的 PKCS12 证书设置 Java。除其他外，这将被使用，以便在 Eclipse 中，我可以访问通过证书进行身份验证的 Trac 服务器。我正在为 Eclipse 使用 Trac Mylyn 集成插件。

这是设置：

*   用户主目录位于 /home
*   多用户挂载在 /central
*   每个用户都有一个个人证书：~/user.p12
*   个人证书密码为：pass1234
*   用户密码存储在 ~/password.txt 的 0400 文件中
*   ca 的只读信任存储位于：/central/ca.jks
*   信任库没有密码
*   JDK 1.6 安装在 /central/jdk_1.6.0
*   Eclipse 3.4 安装在 /central/eclipse_3.4.0
*   JAVA_HOME=/central/jdk_1.6.0
*   JAVA_HOME 设置为 JDK 位置，因为 Eclipse 需要这个
*   ECLIPSE_HOME=/central/eclipse_3.4.0
*   JRE 位于 $JAVA_HOME/jre
*   每个用户都有一个 ~/.java.policy 文件
*   在[https://trac.internal/trac运行着一个 trac 服务器](https://trac.internal/trac)
*   trac 服务器使用证书进行身份验证

现在，我希望每个用户能够简单地修改他们拥有的一些文件（例如 ~/.java.policy 文件），并能够启动中央 Eclipse 应用程序并访问 Trac 存储库。看起来很简单。

现在，我可以让它工作的唯一方法是编辑 $ECLIPSE_HOME/eclipse.ini 文件并添加

```
-Djavax.net.ssl.keyStore="/home/user/user.p12"
-Djavax.net.ssl.keyStoreType="PKCS12"
-Djavax.net.ssl.keyStorePassword="pass1234"
-Djavax.net.ssl.trustStore="/central/ca.jks" 
```

好的，这行得通，但它有两个问题：

*   每个用户都必须安装自己的 ecipse。（或者eclipse可以从用户文件中读取吗？）
*   它是 Eclipse 特定的，我最终希望将其作为 Java 配置。

另外，我记得很久以前您可以编辑 $JAVA_HOME/jre/lib/security/java.security 文件并添加

```
keystore=/home/user/user.p12
keystore.type=PKCS12
keystore.password=pass1234
truststore=/central/ca.jks 
```

但 Eclipse 似乎并没有意识到这一点。可能是因为我的 JAVA_HOME 指向 JDK，而不是 JDK 的嵌套 JRE？

我看过[Java PKCS#11 Reference](http://download.java.net/jdk7/docs/technotes/guides/security/p11guide.html)，它引用了以下属性： keyStoreURL="NONE" keyStoreType="PKCS11" keyStorePasswordURL=some_pin_url

我看到另一个参考资料说您可以编辑 ~/.java.policy 文件以包括：

```
keyStore "file:///home/user/user.p12", "PKCS12", "SunJSSE";
keyStorePasswordUrl "file:///home/user/password.txt"; 
```

但这也没有得到采纳。也许它确实有效并且由于 java.security 文件不起作用的相同原因而没有被读取，或者它根本不起作用。

我见过的一些系统属性：

```
javax.net.ssl.keyStore="/home/user/user.p12"
javax.net.ssl.keyStoreType="PKCS12"
javax.net.ssl.keyStorePassword="password"
javax.net.ssl.keyStoreProvider="SunJSSE"
javax.net.ssl.trustStore="/home/user/ca.jks"
javax.net.ssl.trustStoreType="JKS"
javax.net.ssl.trustStorePassword=""
javax.net.ssl.trustStoreProvider="Sun" 
```

所以，现在，我想我坚持让每个用户都有自己的 Eclipse intall。我知道这听起来像是一个复杂的设置，但是就证书设置而言，这应该与 Eclipse 没有任何关系……它实际上是用于用户特定证书的 Java 设置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T20:38:46.403

使用[用户特定的配置](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/multi_user_installs.html)。

> 设置私有配置区位置
> 
> 私有配置区域的默认位置是：
> 
> user-home-dir/.eclipse/<product-id>_<product-version>/configuration
> 
> 用户主目录由 user.home Java 系统属性确定。产品 ID 和版本是从 Eclipse 安装下的产品标记文件 .eclipseproduct 获得的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-29T18:49:46.530

您可以将所有这些信息存储到一个文件中并从中读取并使用以下方法在代码中设置每个变量：

```
System.setProperty(...); 
```

让我知道什么时候可以解决您的问题。

# ruby-on-rails - 使用子域在 Rails 2.3.2 应用程序中丢失会话

> ID：663893
> 
> 赞同：5
> 
> 时间：2009-03-19T20:19:39.587
> 
> 标签：ruby-on-rails, session, restful-authentication

我有一个升级到 2.3.2 的 2.2.3 应用程序

它是一个多站点（使用子域），可为所有站点创建一个顶级会话。

这就是我在 production.rb 中更改域的方式：

```
ActionController::Base.session_options[:domain] = "example.com"

# in rails 2.2.2, this is what i used to do:
# ActionController::Base.session_options[:session_domain] = "example.com" 
```

升级后奇怪的事情开始发生我无法再使用restful身份验证登录；它确实对我进行了身份验证，但是一旦我被重定向，它就会要求我再次登录。

正如我所说，我使用restful_authentication，我也使用乘客2.1.2。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-11T00:06:10.823

Olly 的回答是正确的，在 rails 2.3 中应该是：

```
config.action_controller.session[:domain] = '.example.com' 
```

我只是想补充一点，如果你还没有创建一些会话选项，你可能会在使用它时收到这个：

```
undefined method `[]=' for nil:NilClass 
```

在这种情况下，您应该改用它（创建会话变量而不是更新它）：

```
config.action_controller.session ||= {}
config.action_controller.session[:domain] = '.example.com' 
```

编辑：显然 Rails 2.2.2 项目使用不同的东西。"domain" 应命名为 "session_domain" 并去掉域前面的句点字符。尝试这个：

```
config.action_controller.session ||= {}
config.action_controller.session[:session_domain] = 'example.com' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T13:03:36.210

在 Rails 2.3 中，您应该使用

```
config.action_controller.session[:domain] = '.example.com' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-25T19:01:57.163

A more bullet proof solution would be to check if the session already exists or not. If you are blindly replacing the whole session object it may trip you up in the future.

```
if ActionController::Base.session
  ActionController::Base.session[:domain] = '.example.com'
else
  ActionController::Base.session = { :domain => '.example.com' }
end 
```

I like to do this in an initializer file.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T21:07:10.747

您必须表明：

```
.example.com 
```

（注意前面的**点**）以便会话 cookie**应用于 example.com*及其子域***。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-14T17:33:49.287

只是想提一下，另一种为 cookie 处理整个子域的方法是动态的。适用于 2.3.4。

在环境中像这样的东西.rb

```
# solution to use the cookies in the api. domains
# this is relevant but in 2.3.4 the code is different
# http://szeryf.wordpress.com/2008/01/21/cookie-handling-in-multi-domain-applications-in-ruby-on-rails/
# Just making sure that api. shares the domain name
require 'dispatcher'
module ActionController
  class Dispatcher
    def set_session_domain
      host_name = @env['SERVER_NAME']
      new_host_name = whatever #some mod of the host_name, for instance
      ActionController::Base.session = {
        :domain => new_host_name
      }
    end

    before_dispatch :set_session_domain
  end
end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-13T01:08:53.883

我正在运行 Rails 2.3.5 并且有

```
config.action_controller.session = {:domain => '.localhost:3000'} 
```

在我的 development.rb 中，但我没有让它工作？

你还需要做什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-23T17:20:14.797

我也在运行 2.3.5 并遇到与@alfred-nerstu 类似的问题

来自@schickm 的补丁没有错误消息，但似乎也不需要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T20:32:15.620

我们遇到了同样的问题（丢失会话，没有子域），使用 nginx + Thin。迁移到 apache + 乘客（最新版本）解决了这个问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-11T07:34:58.977

它可以添加到您设置会话密钥和秘密的同一位置

```
config.action_controller.session = {
      :key => '_app_session',
      :domain => '.domain.com',
      :secret => 'secret'
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-08T12:05:13.847

我对基于 cookie 的会话也有同样的问题。升级到Passenger 2.1.3 似乎解决了这个问题。

# f# - f# 如何决定在启动时运行哪个文件？

> ID：663894
> 
> 赞同：8
> 
> 时间：2009-03-19T20:19:45.997
> 
> 标签：f#

很好，我是 F# 的新手。我已经创建了我的第一个控制台应用程序，但我无法弄清楚 F# 如何决定我的哪些 .fs 文件将在启动时运行。通常应用程序有一个入口点，而我见过的 F# 表单项目也有一个入口点。我的控制台项目没有。

它似乎总是从我添加的最后一个文件开始，这是一个巨大的痛苦。我不敢相信它应该以这种方式工作。我一定做错了什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T20:44:35.110

F# 使用 EntryPointAttribute 支持入口点。[有关详细信息，请参阅此博客](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!412.entry)的最后一个屏幕截图。'main' 函数接受一个字符串数组并返回一个 int，EntryPoint 必须在项目的最后一个代码文件中。另见[语言规范](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec2.aspx)的 12.1.4 。

请注意，如果您不提供显式入口点，则项目最后一个文件中的“顶级代码”实际上表现得像“主”。

（顺便说一下，有关在 VS 中管理项目中的排序文件的信息，另请参阅[此博客。）](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!347.entry)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-19T20:30:13.087

**编辑**阅读布赖恩的答案以获取最新信息

我的答案是链接到过时的信息。

此时 F# 不支持应用程序的显式入口点。它有一个隐式入口点，如您所见，它是项目中的最后一个文件。

该线程有更多详细信息：[http ://cs.hubfs.net/forums/thread/4151.aspx](http://cs.hubfs.net/forums/thread/4151.aspx)

# postgresql - 我可以使用哪个 SQL 语句重新执行触发器并更新表中的所有行？

> ID：663903
> 
> 赞同：4
> 
> 时间：2009-03-19T20:23:30.560
> 
> 标签：postgresql, triggers

我有一个包含很多行的表，并且我在插入或更新事件中更改了与触发器关联的函数。此函数根据两个或多个单元格中的值使用条件逻辑进行计算以更新列，因此单个更新语句将没有用。

那么，我可以使用哪个 SQL 语句重新执行触发器并更新所有行？

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-19T20:48:18.333

您必须更新具有完全相同值的列。当然，这取决于触发条件。例如：

```
UPDATE table
  SET columnX = columnX; 
```

无论如何，作为这种情况下的最佳实践，我通常拥有和相关的功能，我可以在其中运行类似的东西（不确定是否适用于 progresql）：

```
BEGIN
  for c in (select column_id from table)
  loop
    function_on_trigger(c.column_id);
  end loop;
END;
/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T19:18:07.637

为了回应 FerranB 的回答，在 Postgres 中运行该函数的正确方法如下：

```
SELECT function_on_trigger(column_id) FROM table; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:49:08.470

为了让触发器触发，您必须执行调用触发器的 DML，例如，我理解在您的情况下执行更新。要考虑的一种选择是执行实际上不会更改任何内容的更新。我必须承认我从未尝试过，但这将是我会尝试的第一件事（当然是在测试实例中）

```
   更新 [表格]
   设置 [column_1] = [column_1]

```

或者，您可以考虑在更新语句中直接调用该函数。在执行此操作时禁用触发器，或者接受实际需要完成的工作大约是两倍。

```
   更新 [表格]
   设置 [要更改的列] = [函数调用]

```

首先在测试实例中测试这两个选项，或者（不推荐的方法）通过复制表（结构和数据）并触发到新表并首先对新表执行操作。

# asp.net - 如何仅在特定页面上使用 CSS 控制适配器

> ID：663905
> 
> 赞同：0
> 
> 时间：2009-03-19T20:24:05.067
> 
> 标签：asp.net, asp.net-2.0

我找到了一个用于asp.net 向导控件的控件适配器。我想在我的网站上使用它。但是我已经有几个页面使用了向导控件。我不希望这些页面使用新的适配器。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T14:22:53.443

我没有直接使用适配器，但通过阅读文档，看起来您可以将向导控件子类化为您自己的版本 - 比如说“AdaptedWizard”。您不必对基本代码进行任何覆盖，除非它有助于解决您遇到的其他问题。

从那里，您似乎可以修改 .browser 文件以引用您的 AdaptedWizard 类而不是默认的 Wizard 类。然后，您站点上的所有新向导都将从 AdaptedWizard 而不是 Wizard 分类。

祝你好运！

内特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T23:26:16.530

如果您有权访问源代码，则可以编辑控件适配器以首先检查自定义属性是否存在并具有正确的值，然后再调整控件的输出。您应该在呈现之前删除自定义属性，否则它将呈现为 html。

我已经在许多控制适配器上使用了它，它工作正常，并为您提供内嵌的指示，哪些控件被调整。它还消除了创建扩展类的需要。

下面的代码是我如何确定是否应该调整控件。

```
public class TestAdapter : WebControlAdapter
{
    bool _adapt = false;

    protected override void OnInit(EventArgs e)
    {
        Check();
        base.OnInit(e);
    }

    void Check()
    {
        // search for custom attribute
        const string att = "adapt";
        string value = this.Control.Attributes[att];

        if (string.IsNullOrEmpty(value))
        {
            return;
        }

        if (!bool.TryParse(value, out _adapt))
        {
            throw new InvalidOperationException("adapt attribute has invalid value : " + value);
        }

        this.Control.Attributes.Remove(att);
    }
} 
```

# c# - 使用 XmlReader 时将 ReadEndElement 与 ReadStartElement 匹配

> ID：663908
> 
> 赞同：1
> 
> 时间：2009-03-19T20:24:57.170
> 
> 标签：c#, xml, xmlreader

我的问题很简单。我一直在使用`ReadStartElement`并且`ReadEndElement`在`XmlReader`我的代码中很好。问题是（这是在查看 MSDN 之后），您需要将两者匹配吗？

换句话说，我是否以`ReadEndElement`for each结尾，或者是否存在在读取 XML Envelop 时`ReadStartElement`不需要在代码中进行这么多调用的情况？`ReadEndElement`在某些情况下，我并不总是匹配`ReadEndElement`并且阅读 xml 工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T20:38:22.303

是的，我相信您确实需要最频繁地匹配它们。这是因为两者都`ReadStartElement`将`ReadEndElement`XmlReader 移动到下一个节点。但是，他们检查不同的东西。

代码中这种不必要的冗长只是我总是喜欢使用`XPathNavigator`. 它的便利性简直无与伦比（除非您将其与 LINQ 进行比较。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:34:50.283

我认为不将 then 放入代码中不是一个好主意。您可能会遇到某些 xml 元素层次结构的问题，具体取决于您错过了哪一个。也许只有最后的元素。

也就是说，我改用 linq 2 xml，所以我不必处理这个 :) 您可以在 XElement.Load 上加载阅读器，并以更简洁的方式使用它。

# php - 如何通过 PHP 中的 URL 最好地处理身份验证

> ID：663910
> 
> 赞同：1
> 
> 时间：2009-03-19T20:25:42.037
> 
> 标签：php, url, authentication

我需要能够向用户发送一个包含加密值的链接，该值用于在用户访问链接时对用户进行身份验证。

当前过程使用盐和大约 40 个字符的唯一哈希，然后对其进行加密和 base64 编码，以便可以通过电子邮件安全地传输它，并且理论上可以通过 URL 安全地返回。

然而，由于这是我第一次尝试做这样的事情，我没有考虑斜线对加密值的影响。当我从 URL 中提取它时，这会导致该值被截断，这在我尝试解密它时显然不起作用。

这一般是如何实现的？教程等的链接总是很受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:30:49.917

我认为您的方法总体上很好，实际上它可能已经被认为是矫枉过正了。对于 URL 中的斜杠（以及可能的其他问题字符）的问题，只需确保您在验证令牌上使用[`urlencode()`](http://php.net/urlencode)（然后[`urldecode()`](http://php.net/urldecode)在验证页面中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:31:23.193

尽管您不应该在不需要身份验证的页面中包含敏感数据，但有一个简单的解决方案可以解决您的问题。在发送散列之前，使用该函数使其 URI 安全[`urlenconde`](http://us2.php.net/manual/en/function.urlencode.php)。然后在处理之前通过`urldecode`它。

# cruisecontrol.net - 在 Cruisecontrol.net 中强制构建多个项目

> ID：663911
> 
> 赞同：0
> 
> 时间：2009-03-19T20:25:59.243
> 
> 标签：cruisecontrol.net

我在我的 Cruisecontrol.net 中运行多个项目。这些项目相互依赖。基本上，如果项目 A 成功构建，我希望它强制项目 B、C 构建。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T20:32:58.820

您必须在项目配置中使用 forcebuildpublisher 块。查看文档： [http ://confluence.public.thoughtworks.org/display/CCNET/ForceBuildPublisher](http://confluence.public.thoughtworks.org/display/CCNET/ForceBuildPublisher)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:31:32.990

有一个 projectTrigger，您可以将其添加到相关项目的触发器块中。[您可以在此处](http://confluence.public.thoughtworks.org/display/CCNET/Project+Trigger)找到项目触发器的文档

# scripting - 获取两个文件之间的相对路径的最佳/最简单/最快的方法？

> ID：663919
> 
> 赞同：3
> 
> 时间：2009-03-19T20:28:13.450
> 
> 标签：scripting, file, directory

我正在重构一些 C# 代码，其中一部分是重做一些引用，因为我们正在完全重做文件夹结构。我想做的只是进入 .csproj 或 .sln 文件并修改路径。

然而，一些参考文献的路径如下

```
"../../../../../../ThirdParty/SomeMicrosoftLibrary/bin/Debug/SomeMicrosoftLibrary.dll 
```

而且由于我们已经移动了所有东西，我需要找到新的相对路径。但我绝对讨厌尝试这样做（弄清楚我需要输入多少斜线和句号），因为它总是感觉像是一些成功或错过的科学。

有没有一些简单的方法（实用程序、脚本、代码片段）说“这是文件 A，这是文件 B，文件 B 相对于文件 A 的相对路径是什么？”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T20:35:06.990

使用红宝石：

```
$ ruby -e "require 'pathname'; puts Pathname.new('foo/bar').relative_path_from(Pathname.new('baz/x/y/z')).to_s"
../../../../foo/bar 
```

我很确定 Python 也有类似的方法，尽管我手边没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T20:35:12.653

[生成相对路径](http://www.devx.com/tips/Tip/13737)

它在 Java 中，但很容易翻译成 C#。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-17T14:23:48.033

我知道这很旧，但我一直在寻找这个问题的答案，所以这里有一个方法可以做到，以防将来它可能帮助其他人

```
/// <summary>
/// Finds the relative path of B with respect to A
/// </summary>
/// <param name="A">The path you're navigating from</param>
/// <param name="B">The path you're navigating to</param>
/// <returns></returns>
static string Get_PathB_wrt_PathA(string A, string B)
{
    string result = "";

    if (A == B)
        return result;

    var s = new char[] { '\\' };
    var subA = A.Split(s, StringSplitOptions.RemoveEmptyEntries).ToList();
    var subB = B.Split(s, StringSplitOptions.RemoveEmptyEntries).ToList();

    int L = subA.Count >= subB.Count ? subB.Count : subA.Count;
    int i = 0;

    for (i = 0; i < L; i++)
    {
        if (subA[0] == subB[0])
        {
            subA.RemoveAt(0);
            subB.RemoveAt(0);
        }
        else
            break;
    }

    for (i = 0; i <= subA.Count - 1; i++)
    {
        result += @"..\"; //this navigates to the preceding directory
    }

    for (i = 0; i < subB.Count; i++)
    {
        result += subB[i] + "\\";
    }

    result = result.Substring(0, result.Length - 1); //remove the extra backslash
    return result;
} 
```

# asp.net - 开发或部署 .NET 应用程序是否需要付费？

> ID：663923
> 
> 赞同：46
> 
> 时间：2009-03-19T20:29:24.727
> 
> 标签：asp.net, .net, payment

我听说 .NET 不是免费的，如果我开发 .NET 应用程序，我必须向 Microsoft 付费。这是真的？如果是这样的话：

1.  我需要支付什么费用？

2.  我是通过 Academic Alliance 订阅 MSDN（我们免费下载各种 Microsoft 软件产品，如 VS2008 和 Windows Server 2008）。我必须为使用这些工具制作的软件付费吗？

3.  使用 ASP.NET 的 Web 应用程序怎么样？当我托管我的应用程序时是否需要付款，或者我只是为技术付费？

*编辑：*

**所以你的意思是用ASP.NET或PHP开发一个web应用程序是一样的（忽略技术问题，只是支付方面），我所要支付的只是托管费用？**

*编辑2：*

**.NET 规则 :)**

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-03-19T20:31:33.363

.NET 没有任何东西需要您付费。

通常，您会听到它不是免费的，但这是指 GNU 的“免费”概念就像“自由”一样，而不是像价格那样免费（或者，用他们的话来说，.net 像啤酒一样免费，但不是像自由一样自由）。

您可以使用学生许可证来创建 .net 应用程序。您还可以下载 VS 2008 Express Edition，它具有完整的开发功能。

或者，您可以使用非 Microsoft 产品在 .NET 中进行开发。Mono 包含一个完全独立的免费运行时。甚至还有免费的 IDE，例如 SharpDevelop。

- - 编辑 - -

是的。您可以使用 .NET 开发和部署网站、应用程序或其他任何东西。技术本身没有任何东西需要付费。唯一需要付费的是某些工具（例如 Visual Studio 专业版或 Visual Studio 团队版）。有很多方法可以免费使用 .NET 进行开发。

对于免费的 ASP.NET 开发，您有两种选择。第一种是使用[Mono Project 的 ASP.NET 实现](http://www.mono-project.com/ASP.NET)来运行您的站点。这是完全免费的，并且可以处理 asp.net 网站。

但是，如果您为托管付费，则您的主机将为 Microsoft IIS 和 asp.net 站点的托管支付许可费。您的费用包含在托管费用中。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-19T20:33:04.093

你听错了。

您可以免费开发 .NET 应用程序。编译器/SDK 是免费的，可以从 Microsoft 下载。框架/运行时对您的用户是免费的。

Visual Studio 的高端版本不是免费的，但 Express 版本是免费的。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-19T20:31:10.900

[.net 框架](http://www.microsoft.com/net/)可免费[下载](http://www.microsoft.com/downloads/info.aspx?na=90&p=&SrcDisplayLang=en&SrcCategoryId=&SrcFamilyId=ab99342f-5d1a-413d-8319-81da479ab0d7&u=http%3a%2f%2fdownload.microsoft.com%2fdownload%2f0%2f6%2f1%2f061f001c-8752-4600-a198-53214c69b51f%2fdotnetfx35setup.exe)和开发。 [Visual Studio .net](http://www.microsoft.com/visualstudio/en-us/default.mspx)需要付费，但快速版除外，它是免费的，但包含 .net 框架。费用取决于口味。

ASP .net 也是类似的——您无需为框架付费，而是为带有 IIS 的 Windows 副本付费。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-19T21:20:47.863

就成本而言，使用 .NET 进行开发是免费的。框架和 SDK 无需任何费用。

您可能用来开发 .NET 应用程序的工具并不总是免费的。每个 .NET 框架安装都包含的命令行编译器是免费的。Visual Studio Express 版本是免费的（并且可以做很多事情）。Visual Studio Standard/Professional/Team Suite 不是免费的，它是你需要购买的应用程序，

但是，您的 Visual Studio 学术联盟版本（可能是专业版）有特定的限制。如果您使用 AA 许可版本的 Visual Studio 进行开发，您不能将其出售或用于商业目的，或将其用作任何实体（包括您的学校）的基础设施的一部分，直到您购买了常规许可证你使用的工具。

基本上，学术联盟许可表明您可以免费使用完整版的 Visual Studio，但仅限于学习或研究。如果您想将您的研究项目变成业务的一部分，您需要为您使用的产品付费。

如果您正试图将您的研究项目转变为创业公司，您还可以查看[BizSpark](http://www.microsoft.com/BizSpark/)。您仍然需要支付 Visual Studio 费用（除非您使用 Express），但 Microsoft 将支付您所有服务器许可证（Windows Server、Sql Server 等）的费用，希望您的创业公司能够成功（如果你在 3 年后成功了，你需要支付你免费获得的数万美元的许可证，如果你失败了，你只会损失 100 美元的注册费）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-19T22:43:23.517

当然，你必须付钱。生活中没有什么是免费的

:)

编辑：但是说真的，其他人都是正确的，.net 是完全免费的，只有专业工具需要花钱。对不起，如果我的讽刺让任何人感到不安。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-19T20:32:09.883

.NET 是免费的，因为您不必为此付费。框架和 SDK，包括编译器都可以从微软免费下载。.NET 不是免费的，因为您不能修改它，然后像开源框架一样重新分发它。如果你想使用像 Visual Studio 这样的商业 IDE，你也必须付费。虽然有免费的快递版本。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-19T20:55:45.710

是的，您必须至少为操作系统付费才能进行开发。在mono zealots 加入之前，它的形状或形式与Windows 对应物的成熟度完全不同。在操作系统成本之后，您需要什么级别的 IDE 支持。是的，有免费的（特快版和裸骨 sdk 安装程序），但我敢打赌，你至少需要 VS pro 哪个成本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-09T22:07:30.783

在这里我要强调一下，VS 或其他开发工具的费用不是 .net 框架的费用。sdk，图书馆所以.net框架都是免费的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-28T14:08:09.960

您可以使用学术 Visual Studio 构建商业应用程序。谁知道该应用程序是在 VS pro 还是 VS Academic 中构建的？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-23T06:36:19.703

要使用 Microsoft .NET 构建应用程序，您必须获得 Windows 许可，这不是免费的，尽管它通常包含在 PC 成本中，而且通常是您已经支付的成本！

同样，要使用 Microsoft .NET 运行应用程序，您必须拥有 Windows 许可证。

使用 .NET SDK 构建应用程序是免费的。部署使用 .NET 的应用程序是免费的。您可以使用免费工具来构建应用程序。VS Express、emacs、Reflector、SharpDevelop 等。还有收费的高级工具。Visual Studio 在 Pro 版本中可能会变得非常昂贵。

Mono 是在 Windows 和非 Windows 平台上运行的 .NET 版本。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-06T00:48:41.673

使用 c# 和 ASP.NET 开发是免费的，但是要在 IIS 上部署您的网站，您必须支付（作为托管费用的一部分），如前所述，我认为托管 ASP.NET 比托管 PHP 贵得多，等等

我错了吗？您应该为托管 ASP.NET 网站支付多少费用？

# c# - WPF只能打开一个窗口？

> ID：663942
> 
> 赞同：2
> 
> 时间：2009-03-19T20:33:50.613
> 
> 标签：c#, .net, wpf

假设两个项目，一个 WinForms 项目和一个 WPF 项目，在 WinForms 项目中，以下代码在 Main() 中并删除 Application.Run 没有问题：

```
 while (true)
        {
            Thread.Sleep(1000);
            Form1 window = new Form1();
            window.Show();
            Thread.Sleep(1000);
            window.Close();
        } 
```

但是，在 WPF 应用程序中，删除 StartupUri="Window1.xaml" 然后创建：

```
 public App()
    {
        while (true)
        {
            Thread.Sleep(1000);
            Window window = new Window();
            window.Show();
            Thread.Sleep(1000);
            window.Close();
        }
    } 
```

程序无限循环但窗口只打开一次？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-19T20:47:23.687

您需要像这样更改 ShutdownMode

```
public App()
{
    this.ShutdownMode = ShutdownMode.OnExplicitShutdown;
    while (true)
    {
        Thread.Sleep(1000);
        Window window = new Window();
        window.Show();
        Thread.Sleep(1000);
        window.Close();
    }
    //Will never get here with this sample code,
    //but this would be how you close the app.
    this.Shutdown();

} 
```

否则 WPF 将关闭第一个打开的窗口视为关闭应用程序。虽然循环中的代码会继续运行。

> 某些应用程序的生命周期可能不依赖于主窗口或最后一个窗口何时关闭，或者可能根本不依赖于窗口。对于这些场景，您需要将 ShutdownMode 属性设置为 OnExplicitShutdown，这需要显式调用 Shutdown 方法来停止应用程序。否则，应用程序将继续在后台运行。

[MSDN:ShutdownMode 属性](http://msdn.microsoft.com/en-us/library/system.windows.application.shutdownmode.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T20:44:05.567

传统上，如果您删除 StartupUri，您应该在 Application.Startup 事件中加载 MainWindow

```
public App() 
{
  Startup += App_Startup
}

public void App_Startup(object sender, StartupEventArgs e)
{
  while (true)
  {
    Thread.Sleep(1000);
    MainWindow = new Window();
    MainWindow.Show();
    Thread.Sleep(1000);
    MainWindow.Close();
  }
} 
```

虽然，我不确定这是否也有效。你到底想做什么？

# dependency-injection - 依赖注入框架能为您做什么？

> ID：663947
> 
> 赞同：4
> 
> 时间：2009-03-19T20:34:52.390
> 
> 标签：dependency-injection, frameworks

我了解[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)的基本概念。与其拥有大量全局状态，不如将所需的内容传递给各种对象的构造函数。

但我不明白这个概念如何应用于框架？依赖注入框架能为您做什么，什么时候应该使用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T20:36:59.810

该框架根据某种配置（无论是代码、XML 文件等）为您连接一切。

基本上是水管。

许多 DI 框架还包括面向方面的编程、对象生命周期管理等，但 DI 的基础是让您的应用程序启动并运行，对象相互通信。

另一种说法：DI 框架是一段代码，它调用构造函数并告诉整个事情在完成时运行:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:36:55.880

我使用它的主要目的是让我无需重新编译即可插入对象的新实现。我只需更改一个配置文件，我的对象就会正确连接在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T20:39:58.990

找出它们如何有用的最好方法是尝试一些。我一直想尝试一下[Spring.NET](http://www.springframework.net/overview.html)，它看起来是一个很好的实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T21:05:24.843

我真正喜欢 AOP 的一件事是它非常容易在开发版本和生产版本之间移动。您可以创建非常详细的日志记录，然后基本上翻转一个 xml 开关，它就消失了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T21:46:58.720

使用 DI/IOC 的主要优点之一是减少不同类之间的耦合。

当您使用该方法时，您必须配置对象的层次结构，这些层次结构表达了您从其代码中取出的依赖关系。这可以变成很多代码。即使您使用 DI 框架的代码部分，它也可以通过让您以更具表现力的方式进行配置来大大减少配置量：

*   每当需要 ILogger 时，请使用 FileLogger。
*   您可以更进一步地使用约定，每当
    请求 I[Name]Controller时
    将其替换为 [Name]Controller。
*   您可以让它为您管理单例对象。因此，您的代码与任何其他
    依赖项相同，但 DI 确保您始终获得相同的实例

我使用的几个结构图配置：

```
 ForRequestedType<ILogger>().TheDefaultIsConcreteType<NLogLogger>();
    //the following injects any property that has a type 
    //that implements IController. (overcomes a regular asp.net limitation with DI)
    SetAllProperties(
         p => p.TypeMatches(t => t.IsConcreteAndAssignableTo(typeof(IController)))
    ); 
```

# multicore - 如何控制进程在哪个核心上运行？

> ID：663958
> 
> 赞同：58
> 
> 时间：2009-03-19T20:37:40.027
> 
> 标签：multicore, intel, system-calls, instruction-set

我可以理解如何编写一个使用多个进程或线程的程序：fork() 一个新进程并使用 IPC，或者创建多个线程并使用这些类型的通信机制。

我也理解上下文切换。也就是说，只有一个 CPU，操作系统为每个进程安排时间（并且有大量的调度算法），从而我们实现了同时运行多个进程。

现在我们有了多核处理器（或多处理器计算机），我们可以让两个进程在两个独立的内核上同时运行。

我的问题是关于最后一个场景：内核如何控制进程在哪个内核上运行？哪些系统调用（在 Linux 甚至 Windows 中）在特定内核上调度进程？

我问的原因是：我正在为学校开展一个项目，我们将在其中探索最近的计算主题——我选择了多核架构。似乎有很多关于如何在这种环境中编程（如何观察死锁或竞争条件）的材料，但关于控制单个内核本身的材料却不多。我希望能够编写一些演示程序并提供一些汇编指令或 C 代码，以达到“看，我在第二个核心上运行一个无限循环，看看*那个特定核心*的 CPU 利用率峰值”的效果.

任何代码示例？还是教程？

编辑：为了澄清 - 许多人说这是操作系统的目的，应该让操作系统来处理这个问题。我完全同意！但是我要问（或试图感受）操作系统实际上做了什么来做到这一点。不是调度算法，而是更多“一旦选择了一个核心，必须执行哪些指令才能让该核心开始获取指令？”

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-07T17:52:42.490

正如其他人所提到的，处理器亲和性是**操作系统特定**的。如果您想在操作系统范围之外执行此操作，那么您将获得很多乐趣，而我的意思是痛苦。

也就是说，其他人已经提到[`SetProcessAffinityMask`](http://msdn.microsoft.com/en-us/library/ms686223%28VS.85%29.aspx)了 Win32。没有人提到 Linux 内核设置处理器亲和性的方法，所以我会。您需要使用[`sched_setaffinity(2)`](http://man7.org/linux/man-pages/man2/sched_setaffinity.2.html)系统调用。这是[一个很好的教程](http://www.ibm.com/developerworks/linux/library/l-affinity.html)。

此系统调用的命令行包装器是[`taskset(1)`](http://man7.org/linux/man-pages/man1/taskset.1.html). 例如
`taskset -c 2,3 perf stat awk 'BEGIN{for(i=0;i<100000000;i++){}}'`，将繁忙循环的 perf-stat 限制为在核心 2 或 3 上运行（仍然允许它在核心之间迁移，但只能在这两个核心之间迁移）。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-03-19T20:42:26.067

通常，关于应用程序将在哪个内核上运行的决定是由系统决定的。但是，您可以将应用程序的“亲和性”设置为特定内核，以告诉操作系统仅在该内核上运行应用程序。通常这不是一个好主意，但在极少数情况下它可能有意义。

要在 Windows 中执行此操作，请使用任务管理器，右键单击该进程，然后选择“设置关联”。您可以在 Windows 中使用 SetThreadAffinityMask、SetProcessAffinityMask 或 SetThreadIdealProcessor 等函数以编程方式执行此操作。

预计到达时间：

如果您对操作系统如何实际进行调度感兴趣，您可能需要查看以下链接：

[关于上下文切换的维基百科文章](http://en.wikipedia.org/wiki/Context_switch)

[维基百科关于调度的文章](http://en.wikipedia.org/wiki/Scheduling_(computing))

[linux内核中的调度](http://oreilly.com/catalog/linuxkernel/chapter/ch10.html)

对于大多数现代操作系统，操作系统会安排一个线程在内核上执行一小段时间。当时间片到期，或线程执行 IO 操作导致其自愿让出内核时，操作系统将调度另一个线程在内核上运行（如果有任何线程准备好运行）。具体调度哪个线程取决于操作系统的调度算法。

上下文切换的具体实现细节取决于 CPU 和操作系统。它通常会涉及切换到内核模式，操作系统保存前一个线程的状态，加载新线程的状态，然后切换回用户模式并恢复新加载的线程。我上面链接的上下文切换文章对此有更多详细信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-11T10:40:51.580

没有什么告诉核心“现在开始运行这个过程”。

内核*看不到*进程，它只知道可执行代码和各种运行级别以及对可执行指令的相关限制。

当计算机启动时，为简单起见，只有一个内核/处理器处于活动状态并实际运行任何代码。然后，如果操作系统支持多处理器，它会使用一些系统特定指令激活其他内核，其他内核很可能从与其他内核完全相同的位置拾取并从那里运行。

所以调度程序所做的是它查看操作系统内部结构（任务/进程/线程队列）并选择一个并将其标记为在其核心运行。然后在其他核心上运行的其他调度程序实例不会触及它，直到任务再次处于等待状态（并且未标记为固定到特定核心）。在任务被标记为正在运行后，调度程序执行切换到用户空间，任务在之前暂停的点恢复。

从技术上讲，没有什么可以阻止内核在完全相同的时间运行完全相同的代码（许多未锁定的函数会这样做），但除非编写代码是为了期望这一点，否则它可能会自找麻烦。

使用更奇特的内存模型（上面假设“通常”的线性单一工作内存空间）的场景变得更奇怪，其中核心不一定都看到相同的内存，并且可能需要从其他核心的离合器中获取代码，但它更容易通过简单地处理将任务固定在核心上（带有 SPU 的 AFAIK 索尼 PS3 架构就是这样）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-08-28T10:13:03.143

要找出处理器的数量，而不是使用 /proc/cpuinfo，只需运行：

```
nproc 
```

在一组特定处理器上运行进程：

```
taskset --cpu-list 1,2 my_command 
```

会说我的命令只能在 cpu 1 或 2 上运行。

要在 4 个处理器上运行程序，做 4 种不同的事情，请使用参数化。程序的参数告诉它做一些不同的事情：

```
for i in `seq 0 1 3`;
do 
  taskset --cpu-list $i my_command $i;
done 
```

一个很好的例子是处理数组中的 800 万次操作，因此 0 到 (2mil-1) 到处理器 1，2mil 到 (4mil-1) 到处理器 2，依此类推。

您可以通过使用 apt-get/yum 安装 htop 并在命令行运行来查看每个进程的负载：

```
 htop 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-09T21:59:10.017

OpenMPI项目有一个[库，可以](http://www.open-mpi.org/projects/plpa/)[在](http://www.open-mpi.org/)Linux*上*以可移植的方式设置处理器亲和性。

 *前段时间，我在一个项目中使用过它，它运行良好。

**警告：**我依稀记得在找出操作系统如何对内核进行编号时存在一些问题。我在一个 2 Xeon CPU 系统中使用了它，每个系统有 4 个内核。

看看`cat /proc/cpuinfo`可能会有所帮助。在我使用的盒子上，它很奇怪。归结输出是在最后。

显然，偶数核心在第一个 cpu 上，奇数核心在第二个 cpu 上。但是，如果我没记错的话，缓存有问题。在这些 Intel Xeon 处理器上，每个 CPU 上的两个内核共享它们的 L2 缓存（我不记得处理器是否有 L3 缓存）。我认为虚拟处理器0和2共享一个L2缓存，1和3共享一个，4和6共享一个，5和7共享一个。

由于这种怪异（1.5 年前我在 Linux 中找不到任何关于进程编号的文档），我会小心地进行这种低级别的调整。但是，显然有一些用途。如果您的代码在几种机器上运行，那么进行这种调整可能是值得的。另一个应用程序将使用某些特定领域的语言，例如[StreamIt](http://www.cag.csail.mit.edu/streamit/)，编译器可以在其中完成这项肮脏的工作并计算智能调度。

```
processor       : 0
physical id     : 0
siblings        : 4
core id         : 0
cpu cores       : 4

processor       : 1
physical id     : 1
siblings        : 4
core id         : 0
cpu cores       : 4

processor       : 2
physical id     : 0
siblings        : 4
core id         : 1
cpu cores       : 4

processor       : 3
physical id     : 1
siblings        : 4
core id         : 1
cpu cores       : 4

processor       : 4
physical id     : 0
siblings        : 4
core id         : 2
cpu cores       : 4

processor       : 5
physical id     : 1
siblings        : 4
core id         : 2
cpu cores       : 4

processor       : 6
physical id     : 0
siblings        : 4
core id         : 3
cpu cores       : 4

processor       : 7
physical id     : 1
siblings        : 4
core id         : 3
cpu cores       : 4 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-05-07T08:28:40.440

**Linux `sched_setaffinity`C 最小可运行示例**

在这个例子中，我们获取了affinity，修改它，并检查它是否已经生效[`sched_getcpu()`](https://stackoverflow.com/a/16574301/895245)。

主程序

```
#define _GNU_SOURCE
#include <assert.h>
#include <sched.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

void print_affinity() {
    cpu_set_t mask;
    long nproc, i;

    if (sched_getaffinity(0, sizeof(cpu_set_t), &mask) == -1) {
        perror("sched_getaffinity");
        assert(false);
    }
    nproc = sysconf(_SC_NPROCESSORS_ONLN);
    printf("sched_getaffinity = ");
    for (i = 0; i < nproc; i++) {
        printf("%d ", CPU_ISSET(i, &mask));
    }
    printf("\n");
}

int main(void) {
    cpu_set_t mask;

    print_affinity();
    printf("sched_getcpu = %d\n", sched_getcpu());
    CPU_ZERO(&mask);
    CPU_SET(0, &mask);
    if (sched_setaffinity(0, sizeof(cpu_set_t), &mask) == -1) {
        perror("sched_setaffinity");
        assert(false);
    }
    print_affinity();
    /* TODO is it guaranteed to have taken effect already? Always worked on my tests. */
    printf("sched_getcpu = %d\n", sched_getcpu());
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/linux-kernel-module-cheat/blob/4aff114c4c654014a97ef23b1513dda5409e79f3/userland/linux/sched_getaffinity.c).

编译并运行：

```
gcc -ggdb3 -O0 -std=c99 -Wall -Wextra -pedantic -o main.out main.c
./main.out 
```

样本输出：

```
sched_getaffinity = 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
sched_getcpu = 9
sched_getaffinity = 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
sched_getcpu = 0 
```

意思就是：

*   最初，我的所有 16 个内核都已启用，并且该进程在内核 9（第 10 个）上随机运行
*   在我们将亲和性设置为仅第一个核心后，进程必然移动到核心 0（第一个）

通过以下方式运行此程序也很有趣`taskset`：

```
taskset -c 1,3 ./a.out 
```

这给出了形式的输出：

```
sched_getaffinity = 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 
sched_getcpu = 2
sched_getaffinity = 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
sched_getcpu = 0 
```

所以我们看到它从一开始就限制了亲和力。

这是因为亲和性是由子进程继承的，即`taskset`分叉：[如何防止子分叉进程继承 CPU 亲和性？](https://stackoverflow.com/questions/8336191/how-to-prevent-inheriting-cpu-affinity-by-child-forked-process)

在 Ubuntu 16.04 中测试。

**x86 裸机**

如果你是那个铁杆：[多核汇编语言是什么样的？](https://stackoverflow.com/questions/980999/what-does-multicore-assembly-language-look-like/33651438#33651438)

**Linux如何实现它**

[sched_setaffinity() 是如何工作的？](https://stackoverflow.com/questions/766395/how-does-sched-setaffinity-work)

**蟒蛇：`os.sched_getaffinity`和`os.sched_setaffinity`**

请参阅：[如何使用 python 找出 CPU 的数量](https://stackoverflow.com/questions/1006289/how-to-find-out-the-number-of-cpus-using-python/55423170#55423170)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-19T21:14:00.347

正如其他人所提到的，它由操作系统控制。根据操作系统，它可能会或可能不会为您提供允许您影响给定进程执行的核心的系统调用。但是，您通常应该让操作系统执行默认行为。如果您有一个运行 37 个进程的 4 核系统，其中 34 个进程处于休眠状态，它将把剩余的 3 个活动进程调度到不同的核心上。

您可能只会看到在非常专业的多线程应用程序中使用核心亲和性会提高速度。例如，假设您有一个带有 2 个双核处理器的系统。假设您有一个具有 3 个线程的应用程序，其中两个线程对同一组数据进行大量操作，而第三个线程使用不同的一组数据。在这种情况下，让两个线程在同一个处理器上交互，第三个线程在另一个处理器上交互，你会受益最大，因为那时它们可以共享一个缓存。操作系统不知道每个线程需要访问什么内存，因此它可能无法适当地将线程分配给内核。

如果您对操作系统的方式感兴趣，请*阅读*[调度](http://en.wikipedia.org/wiki/Scheduling_(computing))。x86 上的多处理细节可以在[Intel 64 and IA-32 Architectures Software Developer's Manuals](http://www.intel.com/products/processor/manuals/)中找到。第 3A 卷第 7 章和第 8 章包含相关信息，但请记住，这些手册非常技术性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-19T20:39:45.700

操作系统知道如何执行此操作，您不必这样做。如果您指定要在哪个核心上运行，您可能会遇到各种问题，其中一些问题实际上可能会减慢进程。让操作系统弄清楚，您只需要启动新线程即可。

例如，如果您告诉一个进程在核心 x 上启动，但核心 x 已经处于繁重的负载之下，那么与让操作系统处理它相比，您的情况会更糟。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-19T21:00:45.260

我不知道组装说明。但是 Windows API 函数是[SetProcessAffinityMask](http://msdn.microsoft.com/en-us/library/ms686223(VS.85).aspx)。您可以看到我不久前拼凑起来仅在一个内核上运行 Picasa[的示例](http://groups.google.com/group/Picasa-Past-Discussions/browse_thread/thread/508e4e063c6d6154/2dd20a668edb05a9?hl=en&ie=UTF-8&q=picasa_launcher+at+willrickards+donotincludethis+net#2dd20a668edb05a9)

# c# - C# 中的通配符搜索

> ID：663962
> 
> 赞同：1
> 
> 时间：2009-03-19T20:38:41.380
> 
> 标签：c#, regex, search, wildcard

我在 XML 文件中有一个基于通配符的模式列表。如果输入字符串与 XML 文档中存在的模式匹配，则将执行特定操作。

我确实找到了这里提到的方法[http://www.codeproject.com/KB/recipes/wildcardtoregex.aspx](http://www.codeproject.com/KB/recipes/wildcardtoregex.aspx)但在这种情况下，我需要为我试图避免的 XML 中的每个条目创建一个 RegEx 对象。

让我知道有没有更好的方法在 .net 中进行通配符搜索

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T21:04:54.313

我的就寝时间已经过去了，所以我对这个答案可能听起来很古怪。

在我看来，您的设置方式错误：您正在将输入字符串与模式列表进行匹配。从逻辑上讲，您应该将列表中的每个模式与输入字符串进行匹配并确定匹配。通过解析 XML 文件来构造 Regex 模式数组应该非常简单。然后您可以遍历数组并将每个正则表达式与您的输入字符串匹配。

此外，为什么您需要通配符？通配符可以被认为是 Regex 的一个子集，因此您已经将通配符匹配的所有功能封装在 Regex 对象中。

也就是说，有关输入/通配符类型的更多数据可能有助于理解您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:22:38.560

如果您希望评估文档中的每个模式以匹配输入字符串，您必须为每个模式创建一个正则表达式，就像您提到的那样。没有捷径。

我猜你担心性能。你确定这是个问题？如果是这样，您应该尝试完全找到不同的方法。

你要匹配很多输入字符串吗？在这种情况下，您应该保留您的正则表达式（例如在一个列表中），而不是每次都创建它们。正则表达式可以重复使用。

否则，我认为您提出的方法没有什么大问题。

# c - 当管道就位并覆盖了 stdout 和 stderr 时，printf 去哪里了？

> ID：663971
> 
> 赞同：1
> 
> 时间：2009-03-19T20:41:42.047
> 
> 标签：c, pipe, printf, io-redirection

我已经设置管道来重定向标准错误和标准输出。当我使用 printf 时，它会将数据发送到标准输出还是流 1？

如果它将它发送到标准输出，我该如何配置它以将数据发送到流 1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T20:46:13.220

> 当我使用 printf 时，它会将数据发送到标准输出还是流 1？

该`printf`函数将数据发送到`stdout`. 由于您已重定向`stdout`它现在指向控制台以外的文件。`printf`不在乎它是什么，它只是尽可能长时间地写。

> 如果它将它发送到标准输出，我该如何配置它以将数据发送到流 1？

所以，不，你不需要做任何特别的事情——它会被自动处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T20:48:56.240

printf 总是将数据发送到标准输出。如果您使用管道重定向了标准输出，它将转到标准输出被管道传输到的进程。

并且流 1（假设您的意思是与文件描述符 1 关联的流）*是*标准输出，除非您正在做一些*非常*奇怪的事情（在这种情况下，停止）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-19T20:52:48.727

我认为您对所涉及的层的理解有点误导。

C 运行时的`printf`uses `FILE *stdout`，它（除非您使用`freopen`或类似）实际上等效于`fdopen(1, "w")`: ，即文件描述符 #1 上的缓冲输出。

通常，当您运行时`my_program`，文件描述符 #1 会附加到终端。当您运行时`my_program > file`，文件描述符 #1 会在您的程序开始运行`file` *之前附加到。*因此`printf`，写入`stdout`（除非您更改它）乱写文件描述符＃1，将打印到文件而不是终端。

程序之外的任何东西都不关心缓冲 I/O 或你自己的`stdout`.

# asp.net - 为什么我的 SMTP 服务器不发送我的 ASP.NET 邮件？

> ID：663974
> 
> 赞同：0
> 
> 时间：2009-03-19T20:42:07.253
> 
> 标签：asp.net, iis, email, smtp

我有一个 ASP.NET 程序，它使用以下代码发送确认电子邮件：

```
 String msgTxt = "My Message";               
 try
 {
      MailMessage message = new MailMessage();
      message.From  = new MailAddress("info@eatrightamerica.com");
      message.To.Add(new MailAddress(emailParam));
      message.Bcc.Add(new MailAddress("NPClients@eatrightamerica.com"));
      message.Subject   = "Your Nutrition Prescription";
      message.Body  = msgTxt;   

      SmtpClient client = new SmtpClient();
      client.Send(message);
 }
 catch (Exception ex)
 {              
 } 
```

该`web.config`文件有这个：

```
<system.net>  
    <mailSettings>  
       <smtp>  
          <network   
              host="localhost"   
              port="25" />
       </smtp>
    </mailSettings>
</system.net> 
```

而且我的 IIS 设置为在端口 25 上运行（我可以远程登录并对其进行测试，它可以通过远程登录很好地发送）。

有人可以指导我到其他地方寻找问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:48:09.813

您是否尝试过通过备用*SmtpClient*构造函数设置 SMTP 服务器和端口？至少这会告诉我们问题不在于配置文件。

```
int port = 1234;    
SmtpClient client = new SmtpClient("mail.mydomain.com", port);
client.Send(message); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T20:56:34.677

您运行代码的服务器是否在您的电子邮件环境中设置为 SMTP 中继？这可能是公司/企业环境中的一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T21:12:55.667

您是否尝试过指定`deliveryMethod`smtp 元素的属性？

```
<system.net>  
    <mailSettings>  
       <smtp deliveryMethod="network">  
          <network   
              host="localhost"   
              port="25" />
       </smtp>
    </mailSettings>
</system.net> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T15:22:43.287

你真的有例外吗？如果没有，您的邮件可能已被接受，但并未发送到最终目的地。

检查 mailroot\badmail 目录。它可能包含对问题的可能解释（通常是 DNS 解析）。

您还可以为 System.Net.Mail 启用日志记录。这是我写的包含更多信息的链接： [http ://www.systemnetmail.com/faq/4.10.aspx](http://www.systemnetmail.com/faq/4.10.aspx)

# performance - VBA中变量声明的性能优势？

> ID：663977
> 
> 赞同：2
> 
> 时间：2009-03-19T20:43:06.707
> 
> 标签：performance, ms-access, vba

在函数的开头设置变量的维度与在使用它们之前声明它们是否有性能优势？

我在 MS Access 2003 中使用 VBA。

例子，

```
 Function f(y As Long) As Long
      Dim x As Long
      If y <> 0 Then
           x = 1000000
      End If
 End Function 
```

诗句

```
 Function f(y As Long) As Long
      If y <> 0 Then
           Dim x As Long
           x = 1000000
      End If
 End Function 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T20:47:36.103

VBA 完全没有区别。声明变量只会影响设计时调试（IDE 将知道要显示什么自动完成（智能感知））。在这种情况下，它根本不会影响性能。我也做过很多 VBA 宏，这是我注意到的一件事。

作为演示，只需尝试在`Dim`语句上设置断点，您会发现它不允许您这样做。因为这条指令从不执行，只用来指导即时调试引擎。

希望能帮助到你

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T07:18:20.580

为了补充 Wadih M 的答案，所有声明的变量都在编译过程之前初始化，无论它们在过程中的位置如何。

要对此进行测试，请尝试使用变量而不声明它（您确实使用了 Option Explicit，对吗？）：

```
选项显式

私有子 notDeclared()
    暗淡 x 长

    调试.打印 x
    Debug.Print y
结束子
```

这将返回一个“变量未定义错误”，断点是过程声明，即在执行任何代码之前，未声明的变量*y*突出显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:14:34.463

不像 Wadih 回答的那样执行代码本身。

但是在维护代码方面的表现，当然。我想说大多数程序员都希望在函数顶部定义变量。像你提供的一个简单的例子，没关系。但是代码中散布着变量声明的复杂函数让人感觉很混乱。从而减慢了阅读和理解代码的时间。从而增加了维护所需的时间。

在循环中声明变量而不打算这样做也可能存在问题。因此，每次循环迭代都会重置变量。

在维护代码方面，代码本身的性能通常不如性能重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-02T09:03:37.147

当您说“VBA 绝对没有区别”时，我认为您错了。例如，如果您运行此代码

```
Private Sub test2()
    zz = Timer
        For i = 1 To 100000000
            x = x + 1
        Next
    Debug.Print "No décalartion : " & Timer - zz
    yy = Timer
    Dim y As Long
        For i = 1 To 100000000
            y = y + 1
        Next
    Debug.Print "No décalartion : " & Timer - yy
End Sub 
```

你会得到这个结果

无 décalartion : 3,746094 有 décalartion : 1,855469

因此变量声明提高了性能

问候

# asp.net - 更新面板中的 ASP.NET 3.5.1 GridView 重新查询行选择？

> ID：663981
> 
> 赞同：1
> 
> 时间：2009-03-19T20:44:43.677
> 
> 标签：asp.net, gridview, select, refresh

我有一个绑定到 ObjectDataSource 的 GridView，我正在使用标准解决方案处理全行选择，该解决方案将这条线放在 OnRowDataBound() 中：

```
e.Row.Attributes["onclick"] = this.Page.ClientScript.GetPostBackEventReference(this, "Select$" + e.Row.RowIndex); 
```

所有这一切都在顺利进行，除了我注意到每次行选择更改时我的 ObjectDataSource 都会被击中。我没有在后面的行选择代码中的任何地方执行 BindData()，并且由于选择的结果数据没有改变，我真的不明白为什么网格需要重新绑定。我让 gridview 处理分页和排序，但同样，选择不会改变内容，所以我认为这不会影响它。

我尝试打开网格的视图状态（非常少量的数据），但没有效果。我将 UpdatePanel 设置为条件更新，并将子项设置为 triggers=false，但这会导致数据仍被查询，但屏幕上没有发生更新（哈哈！）。

那里有任何 GridView 大师想尝试一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:50:42.053

您是否在 Page_Load() 中缺少以下内容：

```
If (!IsPostBack)
{

} 
```

这是开发人员非常想念的东西！关注您的事件，您可能会看到某处事件被触发 OnPostBack 并且您正在调用您的数据库代码。*****`**********