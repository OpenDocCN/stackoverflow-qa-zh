# StackOverflow 问答 10841000-10841999

# sqlite - 内存单元测试中的 SQLite 显示“没有这样的表错误”而不是真正的错误消息

> ID：10841003
> 
> 赞同：3
> 
> 时间：2012-05-31T20:44:15.370
> 
> 标签：sqlite, unit-testing, nhibernate

我有一个基于简单`NHibernate`的应用程序，我在内存中对其进行单元测试`SQLite`。每当测试失败时，例如由于重复的实体，单元测试会失败并出现错误“没有这样的表 TABLE_NAME”错误，而不是显示原始错误。

如果我切换到真实文件数据库，所有测试（通过或失败）都会正确评估。这怎么可能，我该如何纠正？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T09:03:54.090

这通常是由于未将 SchemaExport 与内存数据库一起使用而引起的。Sqlite 内存数据库依赖于连接，因此每个连接都有自己的数据库。

```
new SchemaExport(config).Create(false, true); // creates database, fill it and throws away 
```

代替

```
using (var session = sessionfactory.OpenSession())
{
    new SchemaExport(config).Execute(false, true, false, session.Connection, null);

    // use session in test
} 
```

# json - 通过 Ajax 和 JSON 保存/调用 Google 地图选项

> ID：10841011
> 
> 赞同：1
> 
> 时间：2012-05-31T20:44:43.657
> 
> 标签：json, google-maps, jquery, google-maps-api-3

我正在尝试使用 JSON 通过 Ajax 将谷歌地图选项对象保存到 MySQL 数据库，然后再次提取数据并将其解析回谷歌地图选项对象。我试图保存的基本选项似乎可以很好地保存和调用，除了 center 属性。我明白了

> 错误：属性值无效：[object Object]

这是原始选项对象的控制台转储的屏幕截图，后面是相同的数据，编码为 JSON，保存到数据库，再次从数据库中提取并解析回 JS 对象：

[http://mcserver.gold.ac.uk/temp/gmapoptssave.png](http://mcserver.gold.ac.uk/temp/gmapoptssave.png)

（对不起，我是新手，不能在这里发图片）

我正在使用 json-jquery 插件的 jQuery.toJSON 函数将选项对象转换为 JSON，然后再通过 ajax 发送。在将数据发送回我的 JS 脚本之前，我正在使用 PHPs encode_json() 函数。

谁能告诉我我还应该做什么，或者我应该做些什么来让保存的选项数据恢复正常工作？我已经设法解决了这个问题

```
if(savedopts != '') mapopts = jQuery.parseJSON(savedopts);
    // This is a hack- should be able to use the parsed JSON object for center directly
    mapopts['center'] = new google.maps.LatLng(mapopts.center.$a, mapopts.center.ab); 
```

但显然它并不优雅，我希望将来也能够保存其他类型的选项数据。

非常感谢任何提示，

干杯，

a|x

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:17:26.233

并非 MapOptions 类型的所有属性都可以直接序列化。特别是，已知 LatLng 对象具有此限制（这是“中心”属性的类型）。相反，您需要使用 LatLng.toString() 或 LatLng.toUrlValue() 方法手动序列化该值，然后在从数据库中检索该值时重新创建 LatLng 对象。

## 存储

```
var optsToSave = mapopts;
optsToSave.center = mapopts.center.toUrlValue();
// store optsToSave in database 
```

## 检索

```
var mapopts = jQuery.parseJSON(savedopts);
mapopts.center = new google.maps.LatLng(
    parseFloat(mapopts.center.substring(0, mapopts.center.indexOf(','))),
    parseFloat(mapopts.center.substring(mapopts.center.indexOf(',') + 1))); 
```

# perl - Perl - Spreadsheet::XLSX -> New () 在大文件上速度慢

> ID：10841019
> 
> 赞同：1
> 
> 时间：2012-05-31T20:45:12.427
> 
> 标签：perl

鉴于[此 PerlMonks 帖子](http://www.perlmonks.org/?node_id=912728)的答案，我认为我无能为力。但是，我想问一下，因为事实证明它非常有用。

有没有办法加快 Spreadsheet::XLSX 打开大文件所需的时间。

当我在一个小文件（我的测试文件是 9KB）上运行时，我的 Perl 代码运行得非常快，但是当我在 5MB 上运行它时，它会在运行完成之前在海滩上小睡一会！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-01T09:33:17.513

你可以使用 Devel-NYTProf 来分析你的代码，看看它为什么这么慢。

也许你可以在某个地方找到一个瓶颈。

# php - 分页问题

> ID：10841026
> 
> 赞同：0
> 
> 时间：2012-05-31T20:46:03.653
> 
> 标签：php, pagination

我目前正在将以下代码段用于即兴分页系统。不幸的是，我遇到了一些障碍。该变量`$result->info['pages']`由远程 API 返回，是可用的页面数。变量`$result->info['page']`是当前可见的页面。链接按预期显示在正确的位置，但它们的行为就像页面始终为 1（“1”链接始终显示为纯文本，其他所有内容始终显示为链接）。但是，如果我回显`$result->info['page']`，它会显示正确的页码，并且显示的信息是正确的。关于我可能做错了什么的想法？

```
<?php if ($result->info['pages'] > '1') {
    if ($result->info['page'] != '1') {
        echo '<a onClick="location.replace(\'?page=' . --$result->info['page'] . '\');">Prev</a> ';
    } else {
        echo 'Prev ';
    }
    for ($i = 1; $i <= $result->info['pages']; $i++) {
        if ($i == $result->info['page']) {
            echo $i . ' ';
        } else {
            echo '<a onClick="location.replace(\'?page=' . $i .'\');">' . $i . '</a> ';
        }
    }
    if ($result->info['page'] != $result->info['pages']) {
        echo '<a onClick="location.replace(\'?page=' . ++$result->info['page'] . '\');">Next</a>';
    } else {
        echo 'Next';
    }
} ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T20:55:45.873

您无需修改`--$result->info['page']`​​，只需将其替换为`($result->info['page'] - 1)`，一切都会顺利

[http://ideone.com/WiGh4](http://ideone.com/WiGh4)

```
<?php

$result = new stdClass();
$result->info = array(
    'pages' => 2,
    'page' => 2
);

if ($result->info['pages'] > '1') {
    if ($result->info['page'] != '1') {
        echo '<a onClick="location.replace(\'?page=' . ($result->info['page'] - 1) . '\');">Prev</a> ';
    } else {
        echo 'Prev ';
    }
    for ($i = 1; $i <= $result->info['pages']; $i++) {
        if ($i == $result->info['page']) {
            echo $i . ' ';
        } else {
            echo '<a onClick="location.replace(\'?page=' . $i .'\');">' . $i . '</a> ';
        }
    }
    if ($result->info['page'] != $result->info['pages']) {
        echo '<a onClick="location.replace(\'?page=' . ($result->info['page'] + 1) . '\');">Next</a>';
    } else {
        echo 'Next';
    }
}

?> 
```

# c# - Dynamics CRM 4.0 中的 AttributeMapMetadata

> ID：10841027
> 
> 赞同：0
> 
> 时间：2012-05-31T20:46:06.953
> 
> 标签：c#, dynamics-crm, dynamics-crm-4, microsoft-dynamics

如何获取[AttributeMapMetadata](http://msdn.microsoft.com/en-us/library/bb959809.aspx)类型的元数据？

我试过这段代码：

```
foreach (CrmMetadata metadata in CrmMetadata.CrmMetadata)
{
   if ((metadata as AttributeMapMetadata) != null)
   {
      var whatIneed = (AttributeMapMetadata)metadata;
   }
} 
```

...但不幸的是没有任何成功。CrmMetadata 的成员已经是“EntityMetadata”类型。我只想有一个带有属性映射的列表。如何正确达到这个目标？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T06:27:25.290

因此，看起来 CrmMetadata 的类型为 RetrieveAllEntitiesResponse。我是正确的？[这](http://msdn.microsoft.com/en-us/library/cc151212.aspx)是一个示例，如何使用类。

```
foreach (CrmMetadata metadata in CrmMetadata.CrmMetadata)
{
    for (int j = 0; j < metadata.Attributes.Length; j++)
    {
      // Get Current Attribute.
      currentAttribute = metadata.Attributes[j];

      Type attributeType = currentAttribute.GetType();

      if (attributeType == typeof(AttributeMapMetadata))
      {
        var whatIneed = (AttributeMapMetadata)currentAttribute;
      }
    }
} 
```

# paypal - 在贝宝交易期间何时减少库存

> ID：10841028
> 
> 赞同：2
> 
> 时间：2012-05-31T20:46:13.403
> 
> 标签：paypal, e-commerce, cart, inventory

这个问题比技术更概念化，我似乎找不到一个好的解决方案。我正在使用链式支付和自适应支付 API 开发一个高流量的电子商务网站。

在销售和随后的贝宝交易期间，我的网站应该在什么时候减少库存以防止过度订购？

我遇到的许多开源电子商务网站似乎只有在收到并确认 IPN 后才会减少库存。然而，在一个高流量的网站上，如果不同的买家在很短的时间内购买了相同的商品，这可能会导致产品订购过多。另一方面，如果在收到付款之前减少库存，那么应该等待多长时间才能取消未付款的订单并重新入库？最好的解决方案是什么？

提前感谢您对此主题的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-05T07:22:08.790

我们正在使用以下流程；

1.  每个项目在“库存”数据库表中都有一个条目。我们没有每个产品的单一“数量”字段，因为它不能确保 1:1 的一致性。（我们将其建模为类似于[http://kylebanker.com/blog/2010/04/30/mongodb-and-ecommerce/](http://kylebanker.com/blog/2010/04/30/mongodb-and-ecommerce/)，但在 MySQL 中实现）
2.  一旦物品被放入购物车，我们就会对物品设置 10 分钟的“暂停”（这意味着 10 分钟不活动，而不是从他们添加物品开始总共 10 分钟）
3.  当客户去结账时，我们最多需要 20 分钟（让他们有时间输入所有详细信息。你会惊讶于有些人需要多长时间）
4.  当客户使用贝宝时，我们将其延长至 3 小时。这绝对不是理想的，因为这意味着非常低的库存商品可能会在很长一段时间内出现“不可用”。然而，这是 Paypal 对 payKey 的时间限制，将保证付款已经完成，或者永远无法使用该密钥进行。
5.  然后，一旦您收到 IPN，您就将库存商品永久设置为“不可用”

正如我所提到的，3 小时会话超时并不理想，因此我们正在考虑使用[使用自适应支付的嵌入式支付流程](https://developer.paypal.com/webapps/developer/docs/classic/adaptive-payments/ht_ap-embeddedPayment-curl-etc/#lbox)，这将允许我们使用 javascript 来跟踪会话时间，如果它们花费的时间比说的长，则强制刷新页面30 分钟。

不过，我很想听听 Paypal 的某个人是否有更好的解决方案。理想情况下，如果我们可以在用户返回网站后实施“快速结帐”式付费电话，而不是依靠 IPN 来完成订单，那会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:49:41.650

只需浏览一下 API（说真的 Paypal 有多少 API），我认为 IPN 是您的最佳选择。为什么？因为这是知道你口袋里有钱的最可靠方法。

对于任何在线系统，您可能会遇到过度订购，但这只是业务的一部分。解决此问题的唯一方法是在向客户收费之前进行数量检查。

# nhibernate - 无法在 NHibernate 中删除一对多关系中的子实体

> ID：10841031
> 
> 赞同：2
> 
> 时间：2012-05-31T20:46:26.483
> 
> 标签：nhibernate, nhibernate-mapping

我有一个测试代码：

```
 using (var session = factory.OpenSession())
        {
            var animalsCategory = session.Query<Category>().Where(c => c.Name == "Animals").Single();
            Assert.AreEqual(3, animalsCategory.Products.Count());
            animalsCategory.Products.ForEach(x => session.Delete(x));
            session.Flush();
        } 
```

**类别**和**产品**类别的映射：

```
public class ProductMap : ClassMap<Product>
{
    public ProductMap()
    {
        Id(x => x.ID);
        Map(x => x.Name).Not.Nullable().Length(50);
        Map(x => x.Description).Length(4000);
        Map(x => x.UnitPrice).Not.Nullable();
        Map(x => x.ReorderLevel).Not.Nullable();
        Map(x => x.Discontinued);

        References(x => x.Category).Not.Nullable();
    }
}

public class CategoryMap : ClassMap<Category>
{
    public CategoryMap()
    {
        Id(x => x.ID);
        Map(x => x.Name);
        Map(x => x.Description);
        HasMany<Product>(x => x.Products).Inverse().Cascade.AllDeleteOrphan();
    }
} 
```

此外，还有以下课程：

```
public class Product : Entity<Product>
{
    public virtual string Name { get; set; }
    public virtual string Description { get; set; }
    public virtual Category Category { get; set; }
    public virtual decimal UnitPrice { get; set; }
    public virtual int ReorderLevel { get; set; }
    public virtual bool Discontinued { get; set; }
}

public class Category : Entity<Category>
{
    private List<Product> products = null;

    public virtual string Name { get; set; }
    public virtual string Description { get; set; }
    public virtual IEnumerable<Product> Products { get { return products; } }
} 
```

现在，当我运行测试代码时，我得到一个异常：

N* *Hibernate.ObjectDeletedException : 已删除的对象将被级联重新保存（从关联中删除已删除的对象）[Model.Product#1]* *

这很好，我想我明白了:)

所以我在**Category**类中创建了一个方法：

```
 public virtual void ClearProducts()
    {
        products.Clear();
    } 
```

我已将测试代码更改为以下内容：

```
 using (var session = factory.OpenSession())
        {
            var animalsCategory = session.Query<Category>().Where(c => c.Name == "Animals").Single();
            Assert.AreEqual(3, animalsCategory.Products.Count());
            //animalsCategory.Products.ForEach(x => session.Delete(x));
            animalsCategory.ClearProducts();
            session.Flush();
        } 
```

我已经用**ClearProducts**调用替换了**ForEach 。**现在我得到了例外：

 ***System.IndexOutOfRangeException : System.Collections.Generic.List`1.Clear() 处的 System.Array.Clear(Array array, Int32 index, Int32 length) 处的索引超出了数组的范围*

我还使用了**while(products.Count >0)**循环从集合中删除所有产品，但我也遇到了一个例外。如果我无法从集合中删除子对象，有人可以告诉我如何删除它们吗？

谢谢

**编辑1：**我惊呆了......我刚刚改变了集合类型（和字段定义）：

```
 private List<Product> products = null; 
```

到：

```
 private IList<Product> products = null; 
```

并且代码有效。有人可以告诉我为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T22:20:58.543

问题 #1 - 您不能直接从子集合中删除对象。为了删除它们，您将从 Products 中删除一个项目，然后保存父 Category 对象。[因此，在 DDD 术语中，您应该只对聚合根对象](https://stackoverflow.com/questions/1958621/whats-an-aggregate-root)执行删除，但您已经弄清楚了。

问题 #2 - 如果您使用延迟加载，您需要在公共实例成员上使用 virtual 关键字并使用**接口**进行收集，以便 NHibernate 可以用知道如何在首次访问时延迟加载的代理替换您的属性。这是一个类似的[问题，有一个很好的答案](https://stackoverflow.com/questions/494332/nhibernate-ilist-to-list)。

Are you sure your Category and CategoryMap classes now look like that? Not sure how would the mapping like you have there work, since you don't have a setter on your public property, nor you have defined different access strategy in mapping.**

# java - Eclipse 编译器从受保护的源代码中读取 Java 依赖项

> ID：10841032
> 
> 赞同：0
> 
> 时间：2012-05-31T20:46:32.337
> 
> 标签：java, eclipse, svn, gwt, maven

我们正在开发（使用 eclipse）一个大型企业应用程序，其中有多个开发人员，每个开发人员都在不同的模块上工作，但是每个模块都相互依赖；目前我们使用共享的 SVN，每个开发人员都在同步他们的所有代码。

现在，随着我们的团队和代码的增长，我们需要保护我们的知识来源，因此我们正在寻求一种解决方案，每个开发人员都可以拥有自己的私有 SVN，但是编译器应该能够读取（使用加密密码）从其他远程模块。有没有办法做到这一点？

我正在考虑使用 maven，但我有以下问题；

1.  我们可以建立自己的受密码保护的 Maven 存储库吗？

2.  我们如何保护本地构建文件夹，有没有办法让 maven 生成一个受密码保护的本地构建，然后在编译后清理和销毁？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:29:44.060

一个项目不是真正的项目，除非它的所有代码都位于同一个源代码存储库中。

满足您要求的最佳方式是将您的项目分成逻辑上独立的子项目，然后让每个开发人员编译他们的 jar 文件并将其部署到一个通用的 Maven 存储库中。通过这种方式，开发人员共享已编译的二进制文件而不是源代码。

可以配置一个中央 Jenkins 实例来构建所有项目（前提是允许单台机器访问所有 subversion 存储库）。

复杂的？你贝奇亚！您将面临的一些具有挑战性的问题：

*   依赖于模块之间的 SNAPSHOT 修订。这些会导致不稳定和难以重现的构建/问题（移动球门柱）
*   实际上，这不再是一个单一的项目。每个子项目最终都需要单独的发布管理，因为无法再集中跟踪和分配问题。
*   控制谁有权访问哪个 Subversion 存储库将成为一项挑战。提前计划并设置 LDAP 组，因为在某些阶段，当最终要求开发人员相互协作时，他们将需要访问其他模块。

我会怎么做？跟随所有成功的开源项目的架构领导并管理中心核心产品。设计一种扩展机制，使第 3 方能够通过插件扩展您的产品。

您可能没有对遗留项目进行重新设计的奢侈，但您已经面临采用这些新安全要求的挑战......我很同情，企业计算的乐趣......

# javascript - 我怎样才能使它转到上一个图像而不是下一个图像？

> ID：10841034
> 
> 赞同：0
> 
> 时间：2012-05-31T20:46:36.103
> 
> 标签：javascript, html5-video

这是在 head 标签里面

```
<script type="text/javascript">
    var image1=new Image()
    image1.src="https://dl.dropbox.com/u/70582811/hand-eye.jpg"

    var image2=new Image()
    image2.src="https://dl.dropbox.com/u/70582811/floating.JPG"

    var image3=new Image()
    image3.src="https://dl.dropbox.com/u/70582811/lovers%20ng.jpg"
</script> 
```

这是在body标签中

```
<script type="text/javascript">
    var step=1

    function slideit(){
        if (!document.images)
            return
        document.images.slide.src=eval("image"+step+".src")

        if (step<3)
            step++
        else
            step=1
        }
        slideit()
</script> 
```

所以我找到了这个用于创建幻灯片的代码，我只需单击即可放大图像。我从一个按钮调用它。但是我不知道如何更改此代码，以便在按下另一个按钮（前一个按钮）时可以后退而不是前进。我会很感激任何帮助，我根本不是最擅长 javascript 的。提前致谢。

这就是我所在的位置：[http ://slidetester.tumblr.com/](http://slidetester.tumblr.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T20:48:35.853

您将需要这样做，而不是通过`step++`减少图片编号来增加图片。查找如何执行此操作。此外，您还需要更改图片用完时返回的条件。我不想给你完整的代码，因为这应该是一种学习体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T20:51:48.370

我假设你知道如何制作一个按钮并为它分配一个单独的函数，所以我们可以调用另一个函数而不是 slideit() 我们可以调用 slideitbackwards()

```
function slideitbackwards() {
  if (!document.images)
    return
  document.images.slide.src=eval("image"+step+".src")
  if (step > 1) //Change this line to the minimum image number
    step-- //subtract instead of add
  else
    step = 3 //Set this to maximum value instead of minimum
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T20:53:29.907

创建一个新函数并通过按钮触发它： function slideitBack(){ if (!document.images) return document.images.slide.src=eval("image"+step+".src") if (step>1 ) 步骤--否则步骤=3 }

# ruby-on-rails - Ruby On Rails - Resque Scheduler - 在特定时间之间更频繁

> ID：10841041
> 
> 赞同：0
> 
> 时间：2012-05-31T20:47:23.570
> 
> 标签：ruby-on-rails, scheduled-tasks, yaml, resque

我是 Rails 调度程序的新手，但已经设法设置了一个任务。

我想知道是否可以将其设置为在工作时间之间比其他时间更频繁地执行某项任务？

喜欢。

在 07:30 - 21:00 之间，每 2 分钟重复一次任务。

在 21:00 - 07:30 之间，每 1 小时重复一次任务。

这是我到目前为止的代码 resque_schedule.yml

```
do_the_job:
  every: 2m
  class: foo
  args: bar
  description: baz 
```

但正如您所看到的，它每 2 分钟重复一次任务，根本不关心时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T07:51:07.127

我认为您需要将 cron 设置添加到文件中

```
 do_the_job: 
   cron: "* * * * *" # change this according to your need 
   every: 2m
   class: foo
   args: bar
   description: baz 
```

要向 cron 添加计时，请检查此[http://www.adminschoice.com/crontab-quick-reference](http://www.adminschoice.com/crontab-quick-reference)

希望这可以帮助

# c# - 无需打开即可打印办公文件

> ID：10841048
> 
> 赞同：0
> 
> 时间：2012-05-31T20:47:47.590
> 
> 标签：c#, excel, printing, openxml

大家好，我目前开发了一个 Windows 服务，它安装在服务器机器上并监视特定文件夹。当 .csv 文件添加到文件夹时，它会抓取该文件，读取它并为 .csv 文件中的每个记录创建 Excel 文件。由于这是 OpenXML 文档（Excel 文件），我可以轻松地创建它，而无需在服务器机器上安装办公室。我现在要做的是将这些生成的 excel 文件发送到连接到服务器机器的打印机而不打开它们。我知道这可能是不可能的，但有没有机会在不安装办公室的情况下打印这些文件，或者 OpenXML SDK 可以提供帮助？我真的对此很感兴趣，因为除了我开发的 Windows 服务之外，没有机会在服务器上安装任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T20:51:49.733

你正在寻找`Process.Start`，设置你传入的`Verb`。`ProcessStartInfo`

只要有一个应用程序注册为动词“打印”的处理程序，那么该项目*应该*打印。

请参阅：[.NET 中的 ShellExecute 等效项](https://stackoverflow.com/questions/258416/shellexecute-equivalent-in-net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T20:52:23.260

要在家演奏音乐，您不可避免地需要一种乐器。这是一个合乎逻辑的规则。不仅是办公室，而且任何其他特殊文档格式至少在您安装他们的分布式库之前都无法使用。因此，我认为如果不在您的服务器上安装额外的东西，就无法实现这一目标。

# sql - 为什么在 SQL Server 中使用 ROW_NUMBER 时出现错误？

> ID：10841050
> 
> 赞同：4
> 
> 时间：2012-05-31T20:47:54.747
> 
> 标签：sql, sql-server

我编写了以下 SQL 代码以在我的 SQL Server 上运行。

```
SELECT 
   atd.DeviceID, 
   ROW_NUMBER() over(order by atd.deviceid) as rownumber
FROM 
   dbo.Devices atd  
WHERE 
  (rownumber between 11 and 20); 
```

我得到以下输出：

> 消息 207，级别 16，状态 1，第 5 行
> 无效的列名称“行号”。
> 消息 207，级别 16，状态 1，第 5 行
> 无效的列名称“行号”。

如您所见，我想`ROW_NUMBER`只获取通常由查询返回的行的子集。我以前从未使用过该`ROW_NUMBER`功能。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-31T20:49:59.420

您不能直接使用列的别名，将其包装在派生表或 CTE 上：

```
SELECT *
FROM (  SELECT DeviceID, 
        ROW_NUMBER() over(order by deviceid) as rownumber
        FROM dbo.Devices) atd 
WHERE (rownumber between 11 and 20); 
```

或者

```
;WITH CTE AS
(
    SELECT DeviceID, 
    ROW_NUMBER() over(order by deviceid) as rownumber
    FROM dbo.Devices
)
SELECT *
FROM CTE 
WHERE (rownumber between 11 and 20); 
```

# asp.net-mvc-3 - 根据请求信息动态改变 log4net 级别

> ID：10841051
> 
> 赞同：0
> 
> 时间：2012-05-31T20:48:04.573
> 
> 标签：asp.net-mvc-3, log4net, ninject

我有一个 MVC3 网络应用程序。我使用 Ninject 2 进行依赖注入，使用带有 log4net 的 Ninject 日志扩展进行日志记录。
我的客户希望能够“跟踪”生产中的用户会话以解决可能出现的问题。我们想要实现它的方式是通过动态更改该用户的日志级别，例如通过存储一个 cookie，以便当 Ninject.logging 提供记录器实例时，它知道提供一个级别设置为调试的日志实例。
我没有找到任何方法来做到这一点，无论是使用 Ninject 日志还是普通的 log4net。
有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T13:28:49.837

[我认为您可以按照其他问题](https://stackoverflow.com/questions/738126/dynamically-reconfigure-log4net)中的描述以编程方式强制级别。它不完全是提供一个新的 logegr 实例，而是改变当前的，但我想它可以解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:24:51.663

我们最终以这种方式修改了 ninject.extension.logging：
- 在 LoggerFactoryBase 中，我们修改了`GetLogger(IContext context)`从 HttpContext 检索 cookie 的方法
- 如果设置了此值，我们将使用“Tracing”获取或创建记录器。+ 类型名称
- 在 log4net 配置中，我们有一个名为“Tracing”的记录器设置为调试

# javascript - GoogleMaps：地图不扩展范围以查看所有标记

> ID：10841053
> 
> 赞同：1
> 
> 时间：2012-05-31T20:48:25.197
> 
> 标签：javascript, google-maps-api-3

我有问题。我有一系列经销商的位置。它被称为`locations`。每组中的第一项是纬度，每组中的最后一项是经度。我正确地取回了一张包含所有位置的地图，但它放大了其中一个位置。它必须是有界限的东西，但我不确定是什么。有人可以帮忙吗？谢谢。

这是我的代码：

```
var map = new google.maps.Map(document.getElementById('map'), {
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

var marker, i;

if (locations.length > 1) { 
    var bounds = new google.maps.LatLngBounds();
    for (i = 0; i < locations.length; i++) {  
        marker = new google.maps.Marker({
        position: new google.maps.LatLng(locations[i][0], locations[i][1]),
                    map: map
                });
    }

    bounds.extend(marker.getPosition());              

    map.fitBounds(bounds); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:53:35.100

我认为你想要`bounds.extend`在 for 循环中。在我看来，它只占据一个标记的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T20:55:54.477

似乎使用您的代码，您可以获得最后一个标记的位置并告诉地图以适应该位置。你用

```
bounds.extend(marker.getPosition());              

    map.fitBounds(bounds); 
```

如果你想适合所有的标记，然后把

```
bounds.extend(m[i]); 
```

在标记后的for循环中。

类似的答案解释得更好：[Google Maps v3 API Extend Bounds。Javascript 操作方法？](https://stackoverflow.com/questions/3610135/google-maps-v3-api-extend-bounds-javascript-how-to)

# java - 计算许可证管理的唯一主机 ID？

> ID：10841055
> 
> 赞同：4
> 
> 时间：2012-05-31T20:48:32.537
> 
> 标签：java, licensing, host, uniqueidentifier

虽然必须实施许可证服务器，但我面临的问题是识别软件正在运行的服务器，该服务器具有一些主机 ID。服务器可以是任何 Windows 或 Linux。虚拟机也是可能的。寻找网卡的 MAC 地址将允许在不更改主机 ID 的情况下复制虚拟机。

任何想法如何计算主机ID？最好用Java可行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:01:51.690

我不得不这样做一次，最终在 SMBios 中使用了 UUID。

就我而言，我在 unix 环境中使用 C，而不是 Java，但您可能有兴趣阅读[SMBios](http://dmtf.org/standards/smbios)规范，并尝试阅读 UUID，这应该比阅读 MAC、硬盘序列号好一点，等等，因为用户可能比 BIOS 更频繁地更换这些。

**编辑**：更新以添加我们在评论中讨论的内容（只是为了将所有内容放在同一个地方）。

在虚拟机（即 VMWare）上，UUID 是从物理机的 UUID 和 vm “居住”的路径生成的（参见： http: [//www.vmware.com/support/ws55/doc/ ws_move_uuid_format.html](http://www.vmware.com/support/ws55/doc/ws_move_uuid_format.html) )

对于 Java，我知道有[javax.realtime.RawMemoryAccess](http://www.rtsj.org/specjavadoc/javax/realtime/RawMemoryAccess.html%20javax.realtime.RawMemoryAccess)，可以让你读写内存。我从来没有真正尝试过，但似乎是从 Java 中做到这一点的正确方法（如果有人对此有任何经验，请发表评论！）

否则，有一个不那么便携的解决方案：一个[JNI](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/%20JNI)，这意味着 C++。正如我之前所说，我唯一的经验是在 unix 系统上，在我的特殊情况下，我找到了[dmidecode](http://www.nongnu.org/dmidecode/%20dmidecode)的源代码，非常有帮助。对于 Windows，您可以尝试这个[SO question](https://stackoverflow.com/questions/9939725/get-bios-uuid-from-c-or-delphi-from-win32%20SO%20question)，这可能会有所帮助。

是的，我知道一开始可能需要研究很多东西) 在“现场”产生比从磁盘或网卡散列序列号更好的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T08:44:53.927

不幸的是，SMBIOS UUID 并非在所有系统上都是唯一的。应该是，但不是。

这不是因为 SMBIOS UUID 的规范失败，而是因为许多制造商在创建此 UUID 时没有遵循规范。

有关在实践中如何出错的更多信息，请参阅此英特尔博客[http://software.intel.com/en-us/blogs/2007/06/08/are-uuids-enterprise-worthy](http://software.intel.com/en-us/blogs/2007/06/08/are-uuids-enterprise-worthy)和以下指导性故事有一些来自现实世界的非常糟糕的例子：http: [//howtowriteaprogram.blogspot.nl/2012/06/smbios-uuid-fail.html](http://howtowriteaprogram.blogspot.nl/2012/06/smbios-uuid-fail.html)。

顺便说一句，关于在[生成唯一机器 ID处创建机器唯一 ID 的另一个关于 stackoverflow 的信息更丰富的主题](https://stackoverflow.com/questions/99880/generating-a-unique-machine-id)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T20:52:31.330

MAC 地址可能不是最好的方法，因为 MAC 地址相对容易被欺骗。从 Java 5 开始，就有了可用于创建唯一 ID 的 UUID 类。我不确定你在拍摄什么，所以我希望这就是你正在寻找的。

# c++ - 哪一个性能更好：使用函数还是精确代码？

> ID：10841056
> 
> 赞同：-1
> 
> 时间：2012-05-31T20:48:35.120
> 
> 标签：c++, performance, performance-testing

我为 3D 模拟编写代码，所以我的代码充满了这样的内容：

使用函数可能会导致开销吗？为什么？

“a”是一个 3D 指针。

**更新**

功能定义

```
double update_a(double a[][JE][KE],...)
{

for(i=1;i<IE;i++){
    for(j=1;j<JE;j++){
        for(k=1;k<KE;k++){
            curl_h=(hz[i][j][k]-hz[i][j-1][k]-hy[i][j][k]+hy[i][j][k-1]);
            idxl[i][j][k]=idxl[i][j][k]+curl_h;
            a[i][j][k]=gj3[j]*gk3[k]*dx[i][j][k]+gj2[j]*gk2[k]*.5*(curl_h+gi1[i]*idxl[i][j][k]);
        }}} 
```

IE=JE=KE=200

哪一个更好 ：

```
 int main()
{
 update_a(...)} 
```

或者

```
int main(){
 for (i=0; i<200; i++) {
    for (j=0; j<200; j++) {
        for (k=0; k<200; k++) {
             curl_h=(hx[i][j][k]-hx[i][j][k-1]-hz[i][j][k]+hz[i-1][j][k]);

                idyl[i][j][k]=idyl[i][j][k]+curl_h;
                a[i][j][k]=gi3[i]*gk3[k]*ey[i][j][k]+gi2[i]*gk2[k]*0.5*(curl_h+gj1[j]*idyl[i][j][k]);
        }
    }
}
 } 
```

**更新2：**

我的确切代码如下所示：

```
int main()
    {
for(n=1;n<100000;n++){
     update_a(...);
update_a2(...);
.
.
.
update_a30(...);}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:03:19.997

将代码存储在函数中*可能会*导致一些开销，如果每秒调用一千次，就会开始增加开销，但请注意有很多地方适合各种编译器优化，因为它很可能会执行，因为它位于循环（这是用于 3D 模拟的常用更新逻辑函数所在的位置，因为它是每帧数据）。我建议不要对此进行任何实际操作，只有在测试过程中发现问题时才可能进入“手动优化模式”。

但是，如果您确实使用“3D”指针（T***），则会出现大部分开销，因为它只会连续分配实际的匿名。指向指针的指针数组。这意味着每次间接都会使您付出沉重的代价，因为任何给定元素的地址都无法像使用线性布局在内存中的 T[m][n][q] 数组那样简单地计算（并且可以衰减为指针，也许这就是您所指的）。然后，由于内存和 CPU 性能之间的差异，您将产生开销。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T20:52:47.063

与您提供的代码的运行时间相比，函数调用的性能损失微不足道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T20:58:07.697

过早的优化很糟糕！

您应该使用一个函数，并且仅在发现存在问题时才手动内联代码！（使用分析工具和性能测试）

函数开销可以忽略不计，尤其是考虑到您的代码。

无论如何，许多编译器都会根据需要内联函数。这意味着您所做的任何内联都不会影响性能，并且会导致维护和代码可读性问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T20:50:45.830

**假设您正在谈论的函数在循环内被调用：**

在任何现代 C++ 编译器上，该函数几乎肯定会被内联。以 g++ 为例，你会发现用函数调用产生的机器码与没有用函数调用产生的机器码是一样的。

如果函数调用在循环之外，编译器是否决定内联函数取决于使用函数的上下文。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T20:56:28.173

函数调用会稍微消耗你创建堆栈和其他东西的性能。

但是在您的情况下，这并不重要，因为您只有几行代码（假设）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-31T23:56:02.793

它没有显着差异。该函数只被调用一次，在`main`. 所以函数调用开销，如果有的话，每次运行程序只支付一次。与运行程序所需的所有工作相比，一个额外的函数入口和返回算不了什么。

有一种方法可能很重要，即如果您未显示的参数之一`...`是按值传递的，并且复制起来确实很昂贵。但是，您显示的只是一个指针，因此复制起来并不昂贵。

# github - TeamCity 代理错误“未能对代理执行结帐”

> ID：10841059
> 
> 赞同：14
> 
> 时间：2012-05-31T20:48:54.480
> 
> 标签：github, teamcity, agent, teamcity-7.0

我在 MacOS 上运行我的 TeamCity 7 服务器和代理。我的仓库在 github 上。我使用 ssh 并且知道身份验证配置正确，因为测试成功。

当我使用 VCS Checkout 模式“在服务器上自动”时，构建工作正常，但是当我使用 VCS Checkout 模式“在代理上自动”时，我收到此错误。

```
[13:40:35][Updating sources] Failed to perform checkout on agent: '/usr/bin/git fetch --progress origin +refs/heads/master:refs/remotes/origin/master' command failed.
stderr: java.io.IOException: Authentication failed
    at org.jetbrains.git4idea.ssh.SSHMain.authenticate(SSHMain.java:275)
    at org.jetbrains.git4idea.ssh.SSHMain.start(SSHMain.java:159)
    at org.jetbrains.git4idea.ssh.SSHMain.main(SSHMain.java:139)
fatal: The remote end hung up unexpectedly 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-21T00:00:51.427

尝试将 teamcity.git.use.native.ssh=true 作为配置参数添加到您的构建配置中。

这就是帮助我解决类似问题的原因。我从[这里](http://youtrack.jetbrains.com/issue/TW-24955)学到了这个技巧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-22T09:38:37.547

对我来说根本不明显的是*服务器上*的默认私钥被复制到代理并在那里使用。我首先尝试将私钥添加到代理运行的用户（显然是在代理机器上），但徒劳无功。但随后我将私钥添加到在服务器机器上运行 TeamCity 的用户，然后代理端结账开始工作。

我也使用了该`teamcity.git.use.native.ssh=true`属性，但我认为它对解决这个特定问题没有帮助。

此信息的唯一痕迹是在[此评论](http://devnet.jetbrains.com/message/5305545?tstart=0)中。

# regex - 正则表达式替换在崇高替换中包含匹配部分的值？

> ID：10841060
> 
> 赞同：44
> 
> 时间：2012-05-31T20:49:00.107
> 
> 标签：regex, sublimetext, textmate, oniguruma

我想出了这个正则表达式，它可以找到所有以下划线开头`$`并包含`_`下划线的单词：

`\$(\w+)_(\w+)`

我基本上是在搜索变量等`$var_foo`。

如何使用正则表达式组替换东西？

例如，如何删除下划线并使下一个字母大写，例如`$varFoo`？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-05-31T20:54:31.917

替换表达式为：

```
\$\1\u\2 
```

*   `\1`,`\2`是捕获（或`$1`, `$2`）
*   `\u`up-cases（参见[替换字符串语法部分](http://manual.macromates.com/en/regular_expressions#replacement_string_syntax_format_strings)）。

有关更多信息，请参阅[正则表达式章节](http://manual.macromates.com/en/regular_expressions#regular_expressions) ^(（在 [TextMate 文档](http://manual.macromates.com/en/)中）)。

已经有一个包可以做到这一点，还有更多：

*   [关于 CaseConversion 的简短博客](http://thecrumb.com/2011/10/27/sublime-text-package-of-the-day-case-conversion/)
*   [案例转换包](https://bitbucket.org/scottbessler/sublimetextcaseconversion/src)

# ios - 通过蓝牙连接的扬声器播放

> ID：10841065
> 
> 赞同：3
> 
> 时间：2012-05-31T20:49:26.277
> 
> 标签：ios, core-audio

在我的应用程序中，我使用的是播放和记录类别，即：

```
UInt32 sessionCategory = kAudioSessionCategory_PlayAndRecord;
CheckError( AudioSessionSetProperty (kAudioSessionProperty_AudioCategory,
                                     sizeof (sessionCategory),
                                     &sessionCategory), "Couldn't set audio category"); 
```

在应用程序中，任何播放的音频最初都会通过接收器输出，直到我设置：

```
UInt32 doChangeDefaultRoute = 1;        
AudioSessionSetProperty (kAudioSessionProperty_OverrideCategoryDefaultToSpeaker, sizeof (doChangeDefaultRoute), &doChangeDefaultRoute); 
```

然而，我真正想要的是通过连接的蓝牙扬声器输出音频。例如，我有一个通过蓝牙连接的扬声器。我可以使用原生音乐应用程序通过它播放音乐。但是，在我的应用程序中，当使用 playandrecord 类别时，它只能在设备上播放。我努力了：

```
UInt32 allowBluetoothInput = 1;
OSStatus stat = AudioSessionSetProperty (
                                         kAudioSessionProperty_OverrideCategoryEnableBluetoothInput,
                                         sizeof (allowBluetoothInput),
                                         &allowBluetoothInput
                                         ); 
```

也：

```
CFStringRef audioRouteOverride = kAudioSessionOutputRoute_BluetoothHFP;

OSStatus s = AudioSessionSetProperty (kAudioSessionProperty_OutputDestination,
                                      sizeof(audioRouteOverride),&audioRouteOverride); 
```

没运气。似乎这应该是一个简单的属性集，但 Idk. 有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-14T09:59:56.893

这是可能的，但您的蓝牙设备必须是耳机或带有内置麦克风的蓝牙设备。当您处于播放和录制类别时，它会强制您使用蓝牙麦克风作为输入。如果您没有蓝牙麦克风，它也不会播放到蓝牙（如果您同时录制）。另外请记住，当您录制和流式传输到 BT 时，您只会获得 8 khz 单声道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-11T16:12:43.953

所以，首先你需要知道它是什么类型的蓝牙设备。无论是**BluetoothHFP**（输入和输出）、**BluetoothA2DP**（仅输出）还是**BluetoothLE**（仅输出）。如果设备仅输出，您将无法连接和路由**kAudioSessionCategory_PlayAndRecord**类别中的音频。您可以尝试将类别设置为**kAudioSessionCategory_PlayBack**并查看是否有效。

一周前我遇到了同样的问题。我的应用程序需要输入和输出，因此我必须将类别设置为**kAudioSessionCategory_PlayAndRecord**。所以我打算根据不同类型的蓝牙设备更改会话类别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-16T03:49:29.050

我觉得你想多了。只需将第一部分设置为允许蓝牙输出，然后确保您没有路由到任何工作。

```
UInt32 audioRouteOverride = kAudioSessionOverrideAudioRoute_None;
AudioSessionSetProperty (kAudioSessionProperty_OverrideAudioRoute,
                         sizeof (audioRouteOverride),
                         &audioRouteOverride); 
```

我只是在测试这个确切的东西。然后在你的路由改变监听器中，你应该只需要担心其他事情，比如插入耳机。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-04T15:22:00.163

如果有人也试图弄清楚这一点，那是不可能的。彻底查看所有可用的音频会话属性，您会发现确实如此

# javascript - 为什么Javascript函数不适用于元素？

> ID：10841067
> 
> 赞同：-2
> 
> 时间：2012-05-31T20:49:37.630
> 
> 标签：javascript, jquery, ajax, hover, tablerow

我的一个页面有这样的结构：

```
head  
    script  
   /script  
/head  
body  
    table1  
    table2  
/body 
```

这是javascript：

```
<script type="text/javascript">
    $( function() {
      $('tr').click( function() {
         $(this).parents('table').find('tr').each( function( index, element ) {
              $(element).removeClass('selected');
         } );
         $(this).addClass('selected');
         $(this).removeClass('normal');
      } );
    } );
    $( function() {
      $('tr').hover( function() {
         $(this).addClass('highlight');
         $(this).removeClass('normal');
      } );
    } );
    $( function() {
        if($('tr').hasClass('selected')) {
        }
        else {
          $('tr').mouseout( function() {
             $(this).removeClass('highlight');
          } );        
        }
    } );
</script> 
```

table1 是通过加载页面生成的，而 table2 是通过单击 table1 的任何行使用 Ajax 生成的。

单击或悬停时，脚本会向 tr （表格行）添加一些类，以便我可以设置它们的样式（更改背景颜色）

该脚本适用于 table1 行并添加类，但不适用于 table2 行！

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T20:56:59.160

这些事件仅适用于页面加载时存在的元素。您需要为它们使用“实时”事件来影响 AJAX 加载的表 (table2)。

为此，您可以使用 jQuery 的[`.on`](http://api.jquery.com/on/)：

```
$(function(){
    $(document).on('click', 'tr', function() {
         $(this).parents('table').find('tr').each( function( index, element ) {
              $(element).removeClass('selected');
         } );
         $(this).addClass('selected');
         $(this).removeClass('normal');
    });
    $(document).on('hover', 'tr', function() {
         $(this).addClass('highlight');
         $(this).removeClass('normal');
    });
    $(document).on('mouseover', 'tr', function(){
        if(!$(this).hasClass('selected')){
            $(this).removeClass('highlight');
        }
    });
}); 
```

注意：代替`document`，您可以使用两个表的最高父级（只要它保留在 DOM 中）。

**更新**：`if($('tr').hasClass('selected')) {`仅在 DOM 加载时运行。将该检查放入事件中。

PS您可以将所有这些`$( function() {`组合在一起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:09:28.540

使用 jQuery`.on()`应该可以解决问题：（删除多余的事件处理程序以准备好文档）

```
$(function() {
    $('table').on('click', 'tr', function() {
        $(this).siblings('tr').removeClass('selected');
        $(this).addClass('selected').removeClass('normal');
    });
    $('table').on('hover', 'tr', function() {
        $(this).addClass('highlight').removeClass('normal');
    });
    $('table').on('mouseout', 'tr', function() {
        $(this).not(".selected").removeClass('highlight');
    });

}); 
```

编辑：修复了鼠标悬停时的非选择器。

这是一个工作示例：http: [//jsfiddle.net/JCbfw/](http://jsfiddle.net/JCbfw/)

编辑：请注意，如果您希望它更紧一点，点击代码可能是这样的：

```
$('table').on('click', 'tr', function() {
    $(this).addClass('selected').removeClass('normal').siblings('tr').removeClass('selected');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:10:14.667

`hover`与您的问题无关，如果您将行为放入 CSS 代码中会更好：

```
whatever:hover {} 
```

# ack - 如何在“Gemfile”中进行 ack 搜索？

> ID：10841070
> 
> 赞同：2
> 
> 时间：2012-05-31T20:49:50.697
> 
> 标签：ack, gemfile

有谁知道如何让“ack”来搜索像“Gemfile”这样的文件？

仅仅添加`--type-add=ruby=Gemfile`到“~/.ackrc”是行不通的，因为“Gemfile”没有任何文件扩展名。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:00:56.790

这是正确的。Ack 1.x 不支持检测没有扩展名的文件的文件类型。这将在 ack 2.0 中改变。 [http://github.com/petdance/ack2](http://github.com/petdance/ack2)是我们正在研究的地方。

# ruby - 访问活动记录关系时出现奇怪的错误

> ID：10841075
> 
> 赞同：0
> 
> 时间：2012-05-31T20:50:18.177
> 
> 标签：ruby, ruby-on-rails-3, activerecord

我有这些模型：

```
class Segment < ActiveRecord::Base
  has_many :families, :foreign_key => :segment_code, :primary_key => :code
end

class Family < ActiveRecord::Base
  belongs_to :segment, :foreign_key => :segment_code, :primary_key => :code
  has_many :genus, :foreign_key => :family_code, :primary_key => :code
end

class Genus < ActiveRecord::Base
  belongs_to :family, :foreign_key => :family_code, :primary_key => :code
  has_many :commodities, :foreign_key => :genus_code, :primary_key => :code
end

class Commodity < ActiveRecord::Base
  belongs_to :genus, :foreign_key => :genus_code, :primary_key => :code
end 
```

在调用这一系列rails控制台irb命令时出现此错误，我迷路了，请帮忙。我也在想我可能需要使用很多：通过。也欢迎对我的数据模型提出批评。

这是错误：`NameError: uninitialized constant Family::Genu`

```
irb(main):003:0> @genus = Genus.first
  ←[1m←[35mGenus Load (15.6ms)←[0m  SELECT `genus`.* FROM `genus` LIMIT 1
=> #<Genus key: 100003, family_code: 10100000, code: 10101500, title: "Livestock", defintion: nil>
irb(main):004:0> @genus.family
  ←[1m←[36mFamily Load (0.0ms)←[0m  ←[1mSELECT `families`.* FROM `families` WHERE `families`.`code` = 10100000 LIMIT 1←[0m
=> #<Family key: 100002, segment_code: 10000000, code: 10100000, title: "Live animals", definition: nil>
irb(main):005:0> @family = @genus.family.first
NoMethodError: undefined method `first' for #<Family:0x2621a60>
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activemodel-3.1.0/lib/active_model/attribute_methods.rb:385:in `method_missing'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/attribute_methods.rb:60:in `method_missing'
        from (irb):5
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.0/lib/rails/commands/console.rb:45:in `start'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.0/lib/rails/commands/console.rb:8:in `start'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.0/lib/rails/commands.rb:40:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>'
irb(main):006:0> @family = @genus.family
=> #<Family key: 100002, segment_code: 10000000, code: 10100000, title: "Live animals", definition: nil>
irb(main):007:0> @family.genus
NameError: uninitialized constant Family::Genu
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/base.rb:1335:in `compute_type'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/reflection.rb:173:in `klass'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/associations/association.rb:118:in `klass'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/associations/association.rb:166:in `find_target?'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/associations/collection_association.rb:323:in `load_target'
        from C:in `load_target'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.1.0/lib/active_record/associations/collection_proxy.rb:89:in `method_missing'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.0/lib/rails/commands/console.rb:45:in `start'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.0/lib/rails/commands/console.rb:8:in `start'
        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.0/lib/rails/commands.rb:40:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>'
irb(main):008:0> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:56:19.220

它被 Genus/Genera（不是 Genu/Genus）的复数形式所混淆，并且正在删除“s”以进行单数化。在 config/initializers/inflections.rb 中修复此问题

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.irregular 'genus', 'genera'
end 
```

在这种情况下，您需要更改您的 has_many：

```
class Family < ActiveRecord::Base
  belongs_to :segment, :foreign_key => :segment_code, :primary_key => :code
  has_many :genera, :foreign_key => :family_code, :primary_key => :code
end 
```

或者你可以这样做，这不是正确的英语，但会使你现有的代码工作：

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.uncountable %w( genus )
end 
```

# perl - Perl 中的静态局部变量

> ID：10841076
> 
> 赞同：18
> 
> 时间：2012-05-31T20:50:19.077
> 
> 标签：perl, scope

我正在寻找有关 Perl 最佳实践的建议。我写了一个脚本，它有一个复杂的正则表达式：

```
my $regex = qr/complicated/;

# ...

sub foo {
  # ...

  if (/$regex/)
  # ...
} 
```

where`foo`是一个经常被调用的函数，并且`$regex`不在该函数之外使用。处理这种情况的最佳方法是什么？我只希望它被解释一次，因为它又长又复杂。但是将它放在全局范围内似乎有点问题，因为它只在那个子中使用。有没有一种合理的方式来声明它是静态的？

另一个可能不合理的全球也出现了类似的问题。它读入当前的日期和时间并对其进行适当的格式化。这也被多次使用，而且只在一个功能中使用。但在这种情况下，更重要的是不要重新初始化它，因为我希望日期时间的所有实例在给定的脚本调用中都是相同的，即使在执行期间分钟翻转。

目前我有类似的东西

```
my ($regex, $DT);

sub driver {
  $regex = qr/complicated/;
  $DT = dateTime();
  # ...
}

# ...

driver(); 
```

这至少稍微隔离了它。但也许有更好的方法。

再说一遍：我正在寻找正确的方法来做到这一点，就遵循最佳实践和 Perl 习惯用法而言。性能很好，但如果我不能拥有一切，可读性和其他需求优先。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-31T20:55:05.757

如果您使用的是 perl 5.10+，请使用`state`变量。

```
use feature 'state';
# use 5.010; also works

sub womble {
    state $foo = something_expensive();
    return $foo ** 2;
} 
```

只会调用`something_expensive`一次。

如果您需要使用较旧的 perls，请在外部范围内使用带有额外大括号的词法变量：

```
{
    my $foo = something_expensive();
    sub womble {
        return $foo ** 2;
    }
} 
```

这可以`$foo`防止泄漏给除`womble`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-31T21:14:04.703

模式中有插值吗？如果没有，无论 qr// 执行多少次，模式都只会编译一次。

```
$ perl -Mre=debug -e'qr/foo/ for 1..10' 2>&1 | grep Compiling | wc -l
1

$ perl -Mre=debug -e'qr/foo$_/ for 1..10' 2>&1 | grep Compiling | wc -l
10 
```

即使有插值，也只会在插值变量发生变化的情况下编译模式。

```
$ perl -Mre=debug -e'$x=123; qr/foo$x/ for 1..10;' 2>&1 | grep Compiling | wc -l
1

$ perl -Mre=debug -e'qr/foo$_/ for 1..10' 2>&1 | grep Compiling | wc -l
10 
```

否则，您可以使用

```
{
   my $re = qr/.../;
   sub foo {
      ...
      /$re/
      ...
   }
} 
```

或者

```
use feature qw( state );
sub foo {
   state $re = qr/.../;
   ...
   /$re/
   ...
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-02T16:25:27.130

正则表达式可以用“o”修饰符指定，它表示“只编译一次模式”——在第三个。骆驼版，见 p. 147

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-23T10:14:12.350

我想完成`ikegami`的好答案。我想在[perl](/questions/tagged/perl "显示标记为“perl”的问题") 5.10 之前的局部变量的定义上浪费更多的话。

让我们看一个简单的示例代码：

```
#!/bin/env perl 

use strict;
use warnings;

{ # local 
my $local = "After Crying";
sub show { print $local,"\n"; }
} # local

sub show2;

show;
show2;

exit;

{ # local 
my $local = "Solaris";
sub show2 { print $local,"\n"; }
} # local 
```

用户会期望两者`sub`都会打印局部变量，但事实并非如此！

输出：

```
After Crying
Use of uninitialized value $local in print at ./x.pl line 20. 
```

原因就是`show2`解析了，但是局部变量的初始化没有执行！（当然如果`exit`去掉，`show2`最后加上a，`Solaris`会打印在第三行）

这可以很容易地解决：

```
{ # local 
my $local;
BEGIN { $local = "Solaris"; }
sub show2 { print $local,"\n"; }
} # local 
```

现在的输出是预期的：

```
After Crying
Solaris 
```

但`state`在 5.10+ 中是更好的选择...

我希望这有帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T20:53:14.773

有一个[state](http://perldoc.perl.org/functions/state.html)关键字可能非常适合这种情况：

```
sub foo {
    state $regex = /.../;
    ...
} 
```

# javascript - Ajax 不发布到 div

> ID：10841078
> 
> 赞同：3
> 
> 时间：2012-05-31T20:50:43.483
> 
> 标签：javascript, jquery, ajax

我没有从 jshint 或控制台收到此代码的错误。然而，我的 ajax 内容并没有发布到预期的 div 中。但是，警报会触发：

```
 var recentVar;
    var highlightsVar;
    var test3;
    var test4;

function switcher(divToShow, thisVar, otherVar, url, div){
    $("#site-nav li a").parents().removeClass("nav-active");
        $(div).addClass("nav-active");
        if (otherVar){ $(otherVar).detach();}

        if(typeof thisVar === 'undefined') {
            thisVar = $(divToShow + " ul.top-level").load("assets/includes/" + url, function () {
                alert("I'm new");
            });
        } else {
            $(thisVar).appendTo("#content-listing");
            alert("I'm old");
        }
}

    //Recent
    $("#site-nav .nav1").on("click", function (event) {
    switcher("#recent", "recentVar", "highlightsVar", "recent.php", "#site-nav .nav1");
    event.preventDefault();
    });

    //Highlights
    $("#site-nav .nav2").on("click", function (event) {
    switcher("#highlights", "highlightsVar", "recentVar", "all-web.php", "#site-nav .nav2");
    event.preventDefault();
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T20:53:53.867

在执行切换器时，thisVar 将始终是一个字符串。它永远不会有未定义的类型。它看起来也像你想传入一个对象（由于声明的变量）但是......如前所述，你总是传入一个字符串。

[根据詹姆斯蒙塔涅的评论]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T21:08:28.050

它与 AJAX 无关，但我认为您的问题就在这里。

```
$(thisVar) 
```

`thisVar`只是文字。如果你检查，你会看到它`$(thisVar).length`是 0。这是因为你正在调用：`$("recentVar")`，它将搜索任何 type 的元素`<recentVar></recentVar>`，显然没有。如果您的意图是附加该文本，您可以使用`append`或创建一个元素并将文本设置为`recentVar`并附加该元素。

**编辑**：另一个问题：

```
$(divToShow + "ul.top-level") 
```

你需要一个空间：

```
$(divToShow + " ul.top-level") 
```

否则，您将尝试匹配`#recentul.top-level`这是胡说八道。

* * *

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T20:54:57.600

尝试这个：

```
if(typeof thisVar === 'undefined') {
        thisVar = $(divToShow + " ul.top-level").load("assets/includes/" + url, function () {
            alert("I'm new");
        });
    } else {
        $(thisVar).appendTo($("#content-listing"));
        alert("I'm old");
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T20:57:12.807

AMAIK，jQuery 的`load()`方法直接将结果插入到调用对象中。因此结果应该被加载到`$(divToShow + " ul.top-level")`元素中。你检查过吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T21:01:14.070

如果当前文档不包含具有 ID 的元素，则不执行`divToShow + " ul.top-level"`该方法。`.load()`

尝试使用 Firebug 或类似的东西来跟踪请求。也许你的回答有问题。

# c# - C# C++ 互操作回调

> ID：10841081
> 
> 赞同：11
> 
> 时间：2012-05-31T20:50:52.583
> 
> 标签：c#, c++, callback, interop

我最近一直在修补 C# 到 C++ 的互操作，特别是设置一个从 C++ DLL 调用的回调函数。

```
namespace TomCSharpDLLImport
{
    class Program
    {
        public delegate void TomDelegate(int a, int b);

        [DllImport("TomDllNative.dll", CallingConvention = CallingConvention.Cdecl)]
        public static extern void GetData();

        [DllImport("TomDllNative.dll", CallingConvention = CallingConvention.Cdecl)]
        public static extern void SetCallback(TomDelegate aCallback);

        static void Main(string[] args)
        {
            TomDelegate lTD = new TomDelegate(Program.TomCallback);

            SetCallback(lTD); //Sets up the callback

            int thread = Thread.CurrentThread.ManagedThreadId;

            GetData(); //This calls the callback in unmanaged code

            while (true) ;
        }

        //Callback function which is called from the unmanaged code
        public static void TomCallback(int a, int b)
        {
            Console.WriteLine("A: {0} B: {1}", a, b);
            int thread = Thread.CurrentThread.ManagedThreadId;
        }
    }
} 
```

我的问题是，当程序控制进入 TomCallback 函数时，我希望它会在 Main 中运行 while(true) 循环。然而，程序只是退出。我无法完全理解这种行为，我的一部分人认为这是预期的，但我的一部分人会期望它主要继续下去。

我所期待的……

1.  调用 GetData() 函数
2.  GetData 函数调用回调
3.  回调函数返回 GetData
4.  GetData 返回到 main()

然而这并不完全正确。

有人会好心解释发生了什么。

为了节省空间，我没有发布非托管代码，但是如果需要，我很乐意发布

**编辑：** 我打开了非托管调试（完全忘了这样做），现在我看到了崩溃..

> 运行时检查失败 #0 - ESP 的值未在函数调用中正确保存。这通常是调用使用一种调用约定声明的函数和使用另一种调用约定声明的函数指针的结果。

本机代码，因为这是崩溃的地方

```
#include "stdafx.h"
typedef void (*callback_function)(int, int);

extern "C" __declspec(dllexport) void SetCallback(callback_function aCallback);
extern "C" __declspec(dllexport) void GetData();

callback_function gCBF;

__declspec(dllexport) void SetCallback(callback_function aCallback)
{
    gCBF = aCallback;
}

__declspec(dllexport) void GetData()
{
    gCBF(1, 2);
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-31T21:19:20.940

您必须使用

```
IntPtr Marshal.GetFunctionPointerForDelegate(Delegate d) 
```

方法。

您使用 SetCallback() 和 System.Delegate 作为参数是错误的。

做了

```
SetCallback(Marshal.GetFunctionPointerForDelegate(lTD)); 
```

并将 SetCallback 重新声明为

```
/// StdCall is crucial here
[DllImport("TomDllNative.dll", CallingConvention = CallingConvention.StdCall)]
public static extern void SetCallback(IntPtr aCallback); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-03-12T17:04:41.340

我遇到了与 OP 完全相同的问题（相同的错误消息）。接受的答案根本没有帮助，甚至@TomP89 在评论中也承认了这一点。

这并不奇怪，因为错误消息表明**传递的回调**函数的调用约定是错误的，而假设的解决方案更改了传递回调**的函数的调用约定，**如果库导出的是 cdecl，则会导致堆栈不平衡-functions（Win32 API 之外的所有函数的默认情况）。

事实证明，.Net 默认假定任何委托的调用约定“stdcall”。通常，非托管代码将采用与其导出函数相同的调用约定（在本例中和我的：“cdecl”）。

所以真正的解决方案（最终对我有用）是将回调的调用约定更改为“cdecl”。简而言之，这个[问题](https://stackoverflow.com/questions/5155180/changing-a-c-sharp-delegates-calling-convention-to-cdecl)显示了这是如何完成的：

```
 [UnmanagedFunctionPointer(CallingConvention.Cdecl)]
    public delegate void TomDelegate(int a, int b); 
```

# java - 从热点向连接的客户端发送消息

> ID：10841088
> 
> 赞同：1
> 
> 时间：2012-05-31T20:51:38.317
> 
> 标签：java, android

> **可能重复：**
> [从基本服务器向特定客户端发送消息](https://stackoverflow.com/questions/10777678/send-message-from-a-basic-server-to-a-specific-client)

这是一个场景。我已经通过我的 android 手机上的 wifi 网络共享启用了一个热点。我还有两个连接到这个热点的 wifi 模块。现在，我只想向连接到我的热点的“一个客户端”（不是全部）发送消息。如果我不想使用服务器-客户端应用程序，这在 Java 中是否可行。由于热点本身充当服务器。

感谢您的任何帮助。

# ember.js - 我应该为 AppFog 上的 Emberjs 项目选择哪个服务器堆栈

> ID：10841092
> 
> 赞同：0
> 
> 时间：2012-05-31T20:51:54.673
> 
> 标签：ember.js

我想使用 AppFog beta 服务来测试它们，并使用 Emberjs 框架开发一个 Web 应用程序。所以，我想知道我应该在 AppFog 上为我的项目使用哪个服务器堆栈？谢谢你的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T03:58:30.743

您可以选择任何您熟悉的服务器堆栈，如果没关系，我会选择使用标准 Apache 堆栈的 PHP。如果你想尝试 Sinatra 或 Node，你也可以选择它们，它们都会支持 Emberjs

# java - 如何使用 ZK 在网格中显示查询结果？

> ID：10841093
> 
> 赞同：1
> 
> 时间：2012-05-31T20:52:04.297
> 
> 标签：java, sql, sql-server-2008, zk

我是 ZK 的新手，我想用查询语句结果的行创建一个 GRID。

这是我的代码：

```
 <window title="REPORTE IMPRESION" border="normal">
    <zscript><![CDATA[
    import java.sql.*;
    void submit() {
        //load driver and get a database connetion
        Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
        Connection conn = DriverManager.getConnection(
                "jdbc:sqlserver://127.0.0.1;databaseName=Reports", "sa", "sa");
        PreparedStatement stmt = null;
        try {
            stmt = conn
                    .prepareStatement("select s.ID, s.NOMBRE, c.FECHA, c.PAG, c.TOTAL, c.PAG * 3.3 as TOTAL_PAGAR, c.PAG * 2.67 as Impresion, (c.PAG * 2.67)+(c.PAG * 3.3) as R FROM C_Sucursal s, Corte c where s.CLAVE=c.CLAVE and c.FECHA=?");

            //insert what end user entered into database table
            stmt.setString(1, fecha.getContext());
            //execute the statement and Put the result in a ResultSet
            PreparedStatement consulta1 = stmt;
            ResultSet result1 = consulta1.executeQuery();
            int  i=0;
            while(result1.next()){
                            //Here i need to put the result in a row! 
                System.out.println(result1.getObject(i));
                i++;
            }

        } finally { //cleanup
            if (stmt != null) {
                try {
                    stmt.close();
                } catch (SQLException ex) {
                    log.error(ex); //log and ignore
                }
            }
            if (conn != null) {
                try {
                    conn.close();
                } catch (SQLException ex) {
                    log.error(ex); //log and ignore
                }
            }
        }
    }
]]>
     </zscript>
    <div apply="org.zkoss.bind.BindComposer">
        <borderlayout sclass="complex-layout" height="580px">
            <north size="120px" border="0">
                <div>
                    <image sclass="complex-layout-header-img"
                        src="/images/bb.png" />
                </div>
            </north>
            <!-- Content -->
            <center>
                <div>
                    <hlayout>
                        <label sclass="hightlight">
                            Fecha del Corte
                        </label>
                    </hlayout>
                    <datebox id="fecha" width="150px"
                        format="dd-MM-yyyy" />
                    <button label="submit" onClick="submit()" />
                    <grid>
                        <columns menupopup="auto">
                            <column label="ID" sort="auto" />
                            <column label="SUCURSAL" sort="auto" />
                            <column label="PAGINAS" sort="auto" />
                            <column label="EDO_CUENTA" sort="auto" />
                            <column label="TOTAL A PAGAR" sort="auto" />
                            <column label="IMPRESION" sort="auto" />
                            <column label="ENVIO" sort="auto" />
                        </columns>
                    </grid>
                </div>
            </center>
            <south size="40px" border="0"
                style="background: none repeat scroll 0 0 ;">
                <toolbar mold="panel" align="center">
                    DERECHOS RESERVADOS
                </toolbar>
            </south>
        </borderlayout>
    </div>
</window> 
```

如何将查询的结果放在网格的行中？帮助！

我做了一个陈述，结果是我需要放入行中，但我不知道如何放入结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:17:38.007

给您的网格一个 id，将其传递给您的方法，然后您可以在您的方法（您传入的）中使用 Grid 对象，并根据需要创建行来显示您的数据。

```
<grid id="myGrid">
  <columns menupopup="auto">
    <column label="ID" sort="auto" />
    <column label="SUCURSAL" sort="auto" />
    <column label="PAGINAS" sort="auto" />
    <column label="EDO_CUENTA" sort="auto" />
    <column label="TOTAL A PAGAR" sort="auto" />
    <column label="IMPRESION" sort="auto" />
    <column label="ENVIO" sort="auto" />
  </columns>
</grid> 
```

当你调用你的函数时，将“myGrid”传递给它

```
submit(myGrid); 
```

假设您有一个私有方法可以为您将结果添加到网格中，并假设您的结果包含在一个名为“Data”的对象中，以下将在网格中显示数据：

```
private void displayResult(Grid myGrid, List<Data> data)
{

    Rows rows = new Rows();
    rows.setParent(programGrid);    

    for(Data d : data)
    {
        Label idLabel = new Label(d.getID());
        Label sucursalLabel = new Label(d.getSucursal());
        Label paginasLabel = new Label(d.getPaginas());
        .... etc ...

        Row row = new Row();    

        idLabel.setParent(row);
        sucursalLabel.setParent(row);
        paginasLabel.setParent(row);
        .... etc ...

        row.setParent(rows);
    }
} 
```

# cocos2d-iphone - Cocos2d 2.0 - 创建可同时选择的按钮

> ID：10841095
> 
> 赞同：0
> 
> 时间：2012-05-31T20:52:09.220
> 
> 标签：cocos2d-iphone

我是 Cocos2d 的新手。

我需要创建一些可以同时选择的按钮。

想象一下钢琴键盘。如果您按下某个键，它会突出显示。如果在两个键之间按下，则两者都突出显示。如果您使用两根手指并且您的手指触摸 4 个键，则所有键都会高亮显示。你知道我需要什么。

我正在关注本教程 [http://www.raywenderlich.com/414/how-to-create-buttons-in-cocos2d-simple-radio-and-toggle](http://www.raywenderlich.com/414/how-to-create-buttons-in-cocos2d-simple-radio-and-toggle)

但据我所知，您必须始终创建一个 CCMenu 并将所有按钮放在那里。但据我阅读和测试，CCMenu 一次只允许选择一个按钮。创建可以同时点击任意数量的元素的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T05:07:09.130

确保在您的 App Delegate 中有以下行

```
[glView setMultipleTouchEnabled:YES]; 
```

使用单独的 CCMenu，您可以对它们进行多点触控，我刚刚在 git 的 Cocos2d 2.0 的最新版本中进行了测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:31:35.173

以我的经验，我已经求助于创建各种 CCMenus，每个都有一个按钮。

# ruby-on-rails - omn iauth-identity 不适用于heroku

> ID：10841098
> 
> 赞同：2
> 
> 时间：2012-05-31T20:52:17.923
> 
> 标签：ruby-on-rails, heroku, omniauth

我在heroku 上使用omniauth-identity 来管理登录。Omniauth 未在身份回调的环境中设置。

```
class SessionsController < ApplicationController

. . . 

private

  def omniauth
    fail "No omniauth in environment" unless request.env["omniauth.auth"] || session[:omniauth]
    request.env["omniauth.auth"] || session[:omniauth]
  end

end 
```

果然失败了：

```
2012-05-31T20:46:56+00:00 app[web.1]: Started POST "/auth/identity/callback" for 74.192.34.328 at 2012-05-31 20:46:56 +0000
2012-05-31T20:46:56+00:00 app[web.1]:   app/controllers/sessions_controller.rb:58:in `omniauth'
2012-05-31T20:46:56+00:00 app[web.1]:   app/controllers/sessions_controller.rb:6:in `create'
2012-05-31T20:46:56+00:00 app[web.1]: RuntimeError (No omniauth in environment): 
```

我需要以某种方式设置 Heroku 吗？它在开发中工作。

* * *

编辑：

```
# Gemfile
source 'http://rubygems.org'

gem 'anjlab-bootstrap-rails', '>= 2.0', :require => 'bootstrap-rails'
gem 'bcrypt-ruby', :require => 'bcrypt'
gem "cancan"
gem 'copies_omniauth'
gem "jquery-rails"
gem 'omniauth'
gem 'omniauth-browserid'
gem 'omniauth-facebook'
gem 'omniauth-identity'
gem 'omniauth-twitter'
gem 'quantity'
gem 'rails', '>=3.2.0'
gem "state_machine"

group :assets do
  gem 'sass-rails', "  >= 3.2.0"
end

group :development do
  gem 'faker'
  gem 'rspec-rails'
  gem "sqlite3"
end

group :test do
  gem 'rspec-rails'
  gem 'factory_girl_rails'
  gem 'guard'
  gem 'guard-bundler'
  gem 'guard-rails-assets'
  gem 'guard-rspec'
  gem 'spork'
  gem "sqlite3"
end

group :production do
  gem 'thin'
  gem 'pg'
end 
```

* * *

```
# config/initializers/omniauth.rb
Rails.application.config.middleware.use OmniAuth::Builder do
  # https://developers.facebook.com/apps/445087828841937
  provider :facebook, ENV['FACEBOOK_ID'], ENV['FACEBOOK_SECRET']

  # https://dev.twitter.com/apps/1568910/show
  provider :twitter, ENV['TWITTER_KEY'], ENV['TWITTER_SECRET']

  # https://github.com/intridea/omniauth-identity
  # http://railscasts.com/episodes/304-omniauth-identity?view=asciicast
  provider :identity, :fields => [:email], :model => AccountPassword,
           on_failed_registration: lambda { |env| AccountPasswordsController.action(:new).call(env) }

end 
```

# c# - 无论我是否指定身份，都会引发身份插入错误

> ID：10841101
> 
> 赞同：-3
> 
> 时间：2012-05-31T20:52:39.097
> 
> 标签：c#, sql-server

我越来越

> “只有在使用列列表并且 IDENTITY_INSERT 为 ON 时，才能为表中的标识列指定显式值。”

无论我是否指定身份，完全相同的错误。我不想指定身份，也不会将其插入到至少我能看到的任何地方。这是我的（编辑，jcolebrand）“相关”C# 代码：

```
SqlConnection con = new SqlConnection(strcon);
this.getControls(this.Controls);

con.Open();

/* jcolebrand moved the sql query text further down, it's long */

SqlCommand cmd = new SqlCommand(query, con);

cmd = getVals(cmd);

cmd.Parameters.AddWithValue("event_link", DBNull.Value);
cmd.Parameters.AddWithValue("event_approved", DBNull.Value);
cmd.Parameters.AddWithValue("event_in_csi", DBNull.Value);
cmd.Parameters.AddWithValue("event_in_website", DBNull.Value);
cmd.Parameters.AddWithValue("date_added", DateTime.Now.ToString());
cmd.Parameters.AddWithValue("event_start_time1", DBNull.Value);

cmd.Parameters.AddWithValue("event_end_time1", DBNull.Value);

cmd.Parameters.AddWithValue("program", DBNull.Value);
cmd.Parameters.AddWithValue("event_owner", DBNull.Value);

cmd.ExecuteNonQuery();

con.Close(); 

String query = @"INSERT INTO [rec_serv].[dbo].[recserv_event1] (
                      event_name
                    , event_category
                    , event_location
                    , event_instructor
                    , event_start_date
                    , event_end_date
                    , event_start_time
                    , event_end_time
                    , event_deadline
                    , member_fee
                    , non_member_fee
                    , email
                    , registration
                    , minimum_size
                    , maximum_size
                    , waiting_list
                    , event_detail
                    , monday
                    , tuesday
                    , wednesday
                    , thursday
                    , friday
                    , saturday
                    , sunday
                    , number_handout
                    , color_handout
                    , size_handout
                    , number_poster
                    , color_poster
                    , size_poster
                    , listserv
                    , news_release
                    , web_banner
                    , visix_ad
                    , desired_displayed_date
                    , other1
                    , other2
                    , comment
                    , event_link
                    , event_approved
                    , event_in_csi
                    , event_in_website
                    , date_added
                    , extracomment
                    , receiptinfo
                    , program
                    , event_owner
                    , event_start_time1
                    , event_end_time1
                ) VALUES (
                    @event_name, 
                    @event_category, 
                    @event_location, 
                    @event_instructor, 
                    @event_start_date, 
                    @event_end_date, 
                    @event_start_time, 
                    @event_end_time, 
                    @event_deadline, 
                    @member_fee, 
                    @non_member_fee, 
                    @email, 
                    @registration, 
                    @minimum_size, 
                    @maximum_size,
                    @waiting_list, 
                    @event_detail, 
                    @monday, 
                    @tuesday, 
                    @wednesday, 
                    @thursday, 
                    @friday, 
                    @saturday,
                    @sunday, 
                    @number_handout, 
                    @color_handout, 
                    @size_handout, 
                    @number_poster, 
                    @color_poster, 
                    @size_poster, 
                    @listserv, 
                    @news_release, 
                    @web_banner, 
                    @visix_ad, 
                    @desired_displayed_date, 
                    @other1, 
                    @other2, 
                    @comment, 
                    @event_link, 
                    @event_approved, 
                    @event_in_csi,
                    @event_in_website,
                    @date_added,
                    @extracomment,
                    @receiptinfo,
                    @program,
                    @event_owner,
                    @event_start_time1,
                    @event_end_time1
);" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:00:27.843

您应该尽可能在 SQL 中使用显式列。因此，对于这个查询，它会将查询的形式更改为：

```
INSERT INTO table (column1, column2, ...) VALUES (value1, value2...); 
```

这也很重要，因为它更清楚地定义了应用程序和 SQL 数据库之间的合同，允许将来进行更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:00:34.927

正如 Mithrandir 提到的，您没有指定列列表。既然您的身份列是您的第一列，那么您为什么要传入`@event_name`？这就是您收到错误的原因 - 您正在尝试将标识列的值设置为`@event_name`，这在多个级别上是不正确的。修复方法是确保您在`VALUES`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:02:02.023

插入设置的字段不是由值决定的，而是由您在查询中指定的字段决定的。由于您根本没有指定任何字段，因此默认为所有字段。

指定字段，这样就可以避免标识字段：

```
INSERT INTO table (
  event_name, event_category, event_in_website, date_added, extracomment,
  recipientinfo, program, event_owner, event_start_time1, event_end_time1
) VALUES (
  @event_name, @event_category, @event_in_website, @date_added, @extracomment,
  @receiptinfo, @program, @event_owner, @event_start_time1, @event_end_time1
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T22:03:05.310

在执行查询之前，执行“SET IDENTITY_INSERT [dbo].[recserv_event1] ON”

例如

```
con.Open(); 
var query =  "SET IDENTITY_INSERT [dbo].[recserv_event1] ON";
SqlCommand cmd = new SqlCommand(query, con); 
cmd.ExecuteNonQuery(); 

query = "Your insert statment.";
cmd.ExecuteNonQuery(); 

con.Close(); 
```

# json - 如何使用 Code Igniter REST_Controller 定义内容类型

> ID：10841102
> 
> 赞同：6
> 
> 时间：2012-05-31T20:52:43.620
> 
> 标签：json, codeigniter, rest, content-type

我正在使用 REST_Controller 扩展 CI_Controller 并且由于某种原因，我的请求都以 text/html 而不是 json 的内容类型返回。在我的配置中，我将 json 设置为默认格式：

```
$config['rest_default_format'] = 'json'; 
```

我的结果以 JSON 形式返回，但未设置内容类型。任何人都可以帮助我缺少什么吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T21:17:12.000

我不确定配置是否设置了格式。但是一个简单的解决方法可能只是使用输出类来设置标题内容类型，例如：

```
$this->output
    ->set_content_type('application/json')
    ->set_output(json_encode(array('foo' => 'bar'))); 
```

（取自手册：[这里](http://codeigniter.com/user_guide/libraries/output.html)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-31T08:59:05.370

虽然在每个函数中设置 contect_type 会有所帮助，但可以通过在构造函数中设置 this 在控制器级别使其通用。

```
public function __construct() {
    parent::__construct();
    ...
    $this->output->set_content_type('application/json');
} 
```

因此，您只需在每个功能级别设置输出

```
$this->output->set_output('{"message":"Failure"}'); 
```

这对我有用。

# javascript - 使用 JQuery 显示和隐藏具有多个选项的菜单的子菜单

> ID：10841105
> 
> 赞同：1
> 
> 时间：2012-05-31T20:53:09.150
> 
> 标签：javascript, jquery, animation, menu, submenu

我有一个菜单，我试图显示和隐藏每个选项的子菜单。HTML结构如下：

```
<a href="/page" class="menu-option" rev="1">Option 1</a>

<ul id="submenu-1" class="submenu" style="display:none">
    <li><a href="/page">Option A</a></li>
    <li><a href="/page">Option C</a></li>
</ul>

<a href="/page" class="menu-option" rev="2">Option 2</a>

<ul id="submenu-2" class="submenu" style="display:none">
    <li><a href="/page">Option C</a></li>
    <li><a href="/page">Option D</a></li>
</ul> 
```

在 JQuery 我有这个代码：

```
$(".menu-option").mouseover( function() {

    var id_option = $(this).attr("rev");

    $("#submenu-" + id_option).fadeIn("fast");

}).mouseout( function() { 

}); 
```

我不知道在“mouseout()”事件中该做什么，因为：

1）如果用户将鼠标放在选项菜单中，然后将鼠标放在该选项的子菜单上，则子菜单必须保持打开状态，当用户将鼠标移出子菜单时，如果用户没有，则必须关闭子菜单不要将鼠标放回打开它的选项菜单。

2) 如果用户将鼠标放在选项菜单中，然后将鼠标放在其他选项菜单上，则必须关闭该选项的子菜单。

任何人都可以帮我实现这个“mouseout（）”事件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:18:39.833

这应该可以解决问题：

**[在这里演示](http://jsfiddle.net/fJPXq/1/)**

**CSS**

```
.menu-container {
    float: left;
    display: block;
    width: 150px;
}

.submenu {
    display: none;
} 
```

​</p>

**HTML**

```
<ul id="submenu-1" class="menu-container">
    <li>
        <a href="/page" class="menu-option" rev="1">Option 1</a>
        <ul class="submenu">
            <li><a href="/page">Option A</a></li>
            <li><a href="/page">Option C</a></li>
        </ul>
    </li>
</ul>

<ul id="submenu-2" class="menu-container">
    <li>
        <a href="/page" class="menu-option" rev="2">Option 2</a>
        <ul class="submenu">
            <li><a href="/page">Option C</a></li>
            <li><a href="/page">Option D</a></li>
        </ul>
    </li>
</ul>​ 
```

**JS**

```
//Menu system
$('.menu-container li').hover(function() {
    //show its submenu
    $('ul', this).fadeIn(100);

}, function() {
    //hide its submenu
    $('ul', this).fadeOut(100);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T20:55:12.667

```
$(".menu-option").mouseover( function() {    
     $(this).next("ul").fadeIn("fast");
  }).mouseout( function() { $(this).next('ul').fadeout(); }); 
```

# iphone - Iphone sdk - 从特定的本地化.strings 文件中获取本地化文本

> ID：10841110
> 
> 赞同：10
> 
> 时间：2012-05-31T20:53:33.993
> 
> 标签：iphone, ios, localization, localized

是否可以从特定的本地化.strings 文件中获取本地化字符串，而不是从系统选择的本地化.strings 文件中获取，只有一次。我不需要更改所有本地化文本，只需更改其中的一些。

我想要做的是从语言偏好和本地化定义本地化字符串。因此，来自巴西的具有英语语言的用户将获得英语应用程序，但某些文本将特定于该地区，因此我希望它们使用葡萄牙语。

但是来自阿根廷的用户，也使用英语的 iPhone 将获得英语的应用程序，但一些文本将是西班牙语。

就像是

```
 NSLocalizedStringFromTable("string.key","pt_BR",nil) 
```

我认为将其发送到**table**参数会起作用，但它没有寻找文件名而不是语言。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-18T14:27:43.013

您可以使用不同的捆绑包来选择特定的语言：

```
NSString * path = [[NSBundle mainBundle] pathForResource:@"pt-PT" ofType:@"lproj"];
NSBundle * bundle = nil;
if(path == nil){
    bundle = [NSBundle mainBundle];
}else{
    bundle = [NSBundle bundleWithPath:path];
}
NSString * str = [bundle localizedStringForKey:@"a string" value:@"comment" table:nil]; 
```

**斯威夫特 3.0：**

```
extension Bundle {
    static let base: Bundle = {
        if let path = Bundle.main.path(forResource: "Base", ofType: "lproj") {
            if let baseBundle = Bundle(path: path) {
                return baseBundle
            }
        }
        return Bundle.main
    }()
}

let localizedStr = Bundle.base.localizedString(forKey: key, value: nil, table: table) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T21:36:39.667

也许您想使用 NSBundle`localizedStringForKey:value:table:`而不是`NSLocalizedString()`. 此方法将使您有机会指定不同的表。

```
[[NSBundle mainBundle] localizedStringForKey:@"stringKey" 
  value:defaultString table:tableName]; 
```

顺便说一句，不要忘记你`@`在 Objective-C 字符串前面 ;-)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:43:35.190

你的意思是`NSLocalizedStringFromTable`？

记录在这里：http: [//developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#jumpTo_112](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#jumpTo_112)

# c# - Epson TM-U220 打印垃圾字符

> ID：10841114
> 
> 赞同：1
> 
> 时间：2012-05-31T20:53:48.360
> 
> 标签：c#, .net, winforms, printing

我为一家餐馆编写了一个 Winforms .NET POS 应用程序。正在使用的收据打印机 (Epson TM-U220) 仅在我的应用程序打印到它时打印垃圾。

当我用记事本尝试它时，它也会将普通文本文档打印为垃圾。

餐馆老板有一个旧的 POS 应用程序用于打印账单；使用此应用程序，爱普生可以正确打印。

我的应用程序在其他喷墨和激光打印机上打印效果很好；我已经重新安装了打印机的驱动程序，但仍然处于相同的情况。

[链接到我的打印代码](http://www.codeproject.com/Questions/395588/Epson-TM-U220-printing-junk-characters)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T23:05:48.590

**ESC-POS-命令指南**

我对此知之甚少。但是，在这里找到了此打印机的命令列表文档 - [http://nicholas.piasecki.name/blog/wp-content/uploads/2009/12/ESC-POS-Command-Guide.pdf](http://nicholas.piasecki.name/blog/wp-content/uploads/2009/12/ESC-POS-Command-Guide.pdf)

它有字符代码表。也许你会得到一些线索。

另请参阅此处 -[如何向 Epson 打印机发送分页命令](https://stackoverflow.com/questions/7400854/how-to-send-page-cut-command-to-epson-printer)

# facebook - 从 JavaScript SDK 调用的 FB.ui 发送在 iPad 上不起作用

> ID：10841117
> 
> 赞同：1
> 
> 时间：2012-05-31T20:54:01.630
> 
> 标签：facebook, ipad, safari, dialog, facebook-javascript-sdk

我试图让以下内容在 iPad 上工作。在所有桌面浏览器中都可以正常工作，但在带有`API Error Code 3, Unknown method. This method isn't supported by this display type`.

```
FB.ui({
  method:'send',
  to:anyUserId,
  link: anyLink,
  name: anyName,
  display: 'popup',
  show_error: true
}); 
```

我已向[Facebook 问题跟踪器报告了一个错误](http://developers.facebook.com/bugs/137149103080662)。仍然因为我在现有的错误或谷歌中找不到任何东西，我怀疑这可能是我的错误。如果您有任何线索，很高兴得到您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:36:52.903

根据我对 android 的经验，移动世界似乎不支持发送对话框（fb 称之为触摸屏）。

[您应该能够使用文档](http://developers.facebook.com/docs/reference/dialogs/send/)中显示的 url 在某种 web 视图中打开对话框：

```
http://www.facebook.com/dialog/send?app_id=APP_ID&
  name=LINK_NAME&
  link=LINK_URL&
  redirect_uri=YOUR_REDIRECT_URL 
```

# r - 为什么 R 的热图函数颜色单元格不一致？

> ID：10841118
> 
> 赞同：5
> 
> 时间：2012-05-31T20:54:01.760
> 
> 标签：r, heatmap

R中的`heatmap`函数应该帮助人们解释矩阵元素的相对值。然而，在给定的图中，似乎没有一致地对单元格进行着色，这是正确解释相对值的严重障碍。

例如，让我们通过连接正常随机变量的列来生成一些数据：

```
foo <- cbind(replicate(10,rnorm(10))) 
```

现在，如果我们关联 foo 的列，我们可以验证我们在对角线条目中得到 1，因为任何列与其自身的相关性都是 1：

```
cor.matrix <- cor(foo) 
```

但是当我们绘制时：

```
heatmap(cor.matrix,Rowv=NA,Colv=NA) 
```

（我们在这里抑制了树状图的重新排序，尽管这似乎无关紧要）

如您所见，对角线单元格的颜色不均匀：![这里](../Images/d2492f0a27692156f0b6108952db7db3.png)

谁能解释这里发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T21:12:19.360

默认情况下，热图按“行”缩放。

```
heatmap(cor.matrix,Rowv=NA,Colv=NA, scale="none") 
```

# kohana - 在 Install.php 中使用 Kohana 类

> ID：10841121
> 
> 赞同：0
> 
> 时间：2012-05-31T20:54:12.843
> 
> 标签：kohana, kohana-3.2

我正在尝试在 install.php 文件中运行 kohana 类，但没有运气，我将它包含在 index.php 中的位置移动到 bootstrap.php 下方的加载位置，希望这会起作用，但失败的任何人有任何想法吗？

谢谢

这是我的 install.php 的相关部分

```
if (isset($_REQUEST['license'])) {
        $spbas = new spbas;

        //validate license key
        $spbas->license_key = $_REQUEST['license'];

        // Do work!
        $spbas->validate();

        // Check for errors
        if ($spbas->errors) {
            echo json_encode(array(
                'status' => 'error',
                'message' => $spbas->errors
            ));
            die();
        } else {
            echo json_encode(array('status' => 'success'));
        }

        // Cleanup
        unset($spbas);

} 
```

继承人 index.php

```
<?php
/**
 * The directory in which your application specific resources are located.
 * The application directory must contain the bootstrap.php file.
 *
 * @see  http://kohanaframework.org/guide/about.install#application
 */
$application = 'application';

/**
 * The directory in which your modules are located.
 *
 * @see  http://kohanaframework.org/guide/about.install#modules
 */
$modules = 'modules';

/**
 * The directory in which the Kohana resources are located. The system
 * directory must contain the classes/kohana.php file.
 *
 * @see  http://kohanaframework.org/guide/about.install#system
 */
$system = 'system';

/**
 * The default extension of resource files. If you change this, all resources
 * must be renamed to use the new extension.
 *
 * @see  http://kohanaframework.org/guide/about.install#ext
 */
define('EXT', '.php');

/**
 * Set the PHP error reporting level. If you set this in php.ini, you remove this.
 * @see  http://php.net/error_reporting
 *
 * When developing your application, it is highly recommended to enable notices
 * and strict warnings. Enable them by using: E_ALL | E_STRICT
 *
 * In a production environment, it is safe to ignore notices and strict warnings.
 * Disable them by using: E_ALL ^ E_NOTICE
 *
 * When using a legacy application with PHP >= 5.3, it is recommended to disable
 * deprecated notices. Disable with: E_ALL & ~E_DEPRECATED
 */
error_reporting(E_ALL | E_STRICT);

/**
 * End of standard configuration! Changing any of the code below should only be
 * attempted by those with a working knowledge of Kohana internals.
 *
 * @see  http://kohanaframework.org/guide/using.configuration
 */

// Set the full path to the docroot
define('DOCROOT', realpath(dirname(__FILE__)).DIRECTORY_SEPARATOR);

// Make the application relative to the docroot, for symlink'd index.php
if ( ! is_dir($application) AND is_dir(DOCROOT.$application))
    $application = DOCROOT.$application;

// Make the modules relative to the docroot, for symlink'd index.php
if ( ! is_dir($modules) AND is_dir(DOCROOT.$modules))
    $modules = DOCROOT.$modules;

// Make the system relative to the docroot, for symlink'd index.php
if ( ! is_dir($system) AND is_dir(DOCROOT.$system))
    $system = DOCROOT.$system;

// Define the absolute paths for configured directories
define('APPPATH', realpath($application).DIRECTORY_SEPARATOR);
define('MODPATH', realpath($modules).DIRECTORY_SEPARATOR);
define('SYSPATH', realpath($system).DIRECTORY_SEPARATOR);

// Clean up the configuration vars
unset($application, $modules, $system);

/**
 * Define the start time of the application, used for profiling.
 */
if ( ! defined('KOHANA_START_TIME'))
{
    define('KOHANA_START_TIME', microtime(TRUE));
}

/**
 * Define the memory usage at the start of the application, used for profiling.
 */
if ( ! defined('KOHANA_START_MEMORY'))
{
    define('KOHANA_START_MEMORY', memory_get_usage());
}

// Bootstrap the application
require APPPATH.'bootstrap'.EXT;
//require core assets
require_once SYSPATH . 'classes/kohana/spbas' . EXT;

if (file_exists('install'.EXT))
{
    // Load the installation check
    return include 'install'.EXT;
}
/**
 * Execute the main request. A source of the URI can be passed, eg: $_SERVER['PATH_INFO'].
 * If no source is specified, the URI will be automatically detected.
 */
echo Request::factory()
    ->execute()
    ->send_headers()
    ->body(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:12:33.250

我最终从通过安装程序转换为制作控制器并以（正确的）方式处理它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T18:50:52.537

确认可以运行 Kohana 后，您应该删除 install.php。Kohana 将通过自动加载和您的 boostrap.php 文件为您加载类。

# php - PHP在添加和连接时感到困惑

> ID：10841124
> 
> 赞同：13
> 
> 时间：2012-05-31T20:54:18.947
> 
> 标签：php, sum, concatenation, parentheses

我有以下代码：

```
<?php

    $a = 1;
    $b = 2;

    echo "sum: " .  $a + $b;
    echo "sum: " . ($a + $b);

?> 
```

当我执行我的代码时，我得到：

```
2
sum: 3 
```

为什么`"sum:"`在第一个回显中打印字符串失败？当加法用括号括起来时，它似乎很好。

这种奇怪的行为在任何地方都有记录吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-31T21:02:12.600

两个运算符加法`+`运算符和连接`.`运算符具有相同的[运算符优先级](http://php.net/manual/en/language.operators.precedence.php)，但由于它们是左关联的，因此它们的评估如下：

```
echo (("sum:" . $a) + $b);
echo ("sum:" . ($a + $b)); 
```

所以你的第一行首先进行连接并最终得到：

```
"sum: 1" + 2 
```

（现在因为这是一个数字上下文，你的[字符串被转换为一个整数](http://www.php.net/manual/en/language.types.string.php#language.types.string.conversion)，因此你最终得到`0 + 2`，然后给你结果`2`。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-31T21:04:08.630

如果您查看列出[PHP 运算符优先级](http://php.net/manual/en/language.operators.precedence.php)的页面，您会看到连接运算符`.`和加法运算符`+`具有相同的优先级，具有左关联性。这意味着操作是从左到右完成的，正如代码所示。让我们看一下：

```
$output = "sum: " . $a;
echo $output, "\n";
$output = $output + $b;
echo $output, "\n"; 
```

这给出了以下输出：

```
sum: 1
2 
```

连接有效，但您随后尝试将字符串添加`sum: 1`到 number `2`。[不以数字开头的字符串的计算结果为`0`](http://www.php.net/manual/en/language.types.string.php#language.types.string.conversion)，因此这等效于`0 + 2`，结果为`2`。

正如您在问题中所建议的那样，解决方案是将加法操作括在括号中，以便它们一起执行，然后将这些操作的结果连接起来。

```
echo "sum: " . ($a + $b); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:04:18.247

由于您使用语言结构[`echo`](http://php.net/manual/en/function.echo.php)，您可以使用逗号将加法与串联分开：

```
echo "sum: " , $a + $b; 
```

按预期工作。

# c# - 为不同的模型类型调用 HtmlHelper.Display

> ID：10841125
> 
> 赞同：1
> 
> 时间：2012-05-31T20:54:29.440
> 
> 标签：c#, asp.net-mvc-3

我想从不同于我当前的类型`MvcHtmlString`的方法中获得结果。下面的代码编译但总是返回一个空字符串。`HtmlHelper.Display``HtmlHelper`

```
public static MvcHtmlString GetPropertyValue(this HtmlHelper html, string property, object value)
{
    var dictionary = new ViewDataDictionary();
    dictionary.Add(property, value);
    var fooHelper = new HtmlHelper<FooModel>(
        new ViewContext(
            html.ViewContext, 
            new WebFormView(html.ViewContext, "dummy"), 
            dictionary, 
            new TempDataDictionary(),
            TextWriter.Null),
        new ViewPage());
    return fooHelper.Display(property);
} 
```

所有的辅助对象（`ViewContexts`、`ControllerContexts`、`ViewDataDictionaries`等）对我来说都是一个黑盒子；我确定我遗漏了一些明显的东西。

**我怎样才能让它工作？**

*对于好奇：这将在我的应用程序的审核页面上使用。我有`string`数据库中的属性名称（作为 a ）、旧值和新值。我也知道用于显示由记录表示的模型的实际实例的类型。我想重用模型类中的所有数据注释来显示 HTML。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:43:09.413

我有同样的问题。我想要什么：

我想创建自己的 html 扩展方法，它可以做一些事情，而不是调用 DisplayFor。在该方法的显示中，我将传递我的不同模型对象。

我的解决方案

```
public static MvcHtmlString ShowProperty<T>(this HtmlHelper<T> helper, NewModel mynewModel){
        return helper.DisplayFor(m => myNewModel, "TemplateName");
    } 
```

也许这对某些人有用

# string - 一行数据的R正则表达式

> ID：10841127
> 
> 赞同：0
> 
> 时间：2012-05-31T20:54:48.043
> 
> 标签：string, r

我正在逐行解析 R 中的文本文件。

通常，一行如下所示：

```
2 1 3GFT B 19 ? 187 ? P01116 1 169 1 169 
```

所以我像这样解析它：

```
items<- unlist(strsplit(filedata[i]," +")) 
```

但是，对于一个非常具体的行，它看起来像这样：

```
1 3GFT HIS A 79 ? UNP P01116 GLN 61 'SEE REMARK 999' 61  19 
```

请注意，在上面的行中，“请参阅备注 999”应该是 1 字段但使用我的解析，它将是 3。有人可以帮助我使用 strsplit 以便正确解析吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:02:32.880

也许你可以使用`scan`：

```
scan(text="1 3GFT HIS A 79 ? UNP P01116 GLN 61 'SEE REMARK 999' 61  19", 
     quote="'", what="character") 
```

这使 ：

```
 [1] "1"              "3GFT"           "HIS"            "A"             
 [5] "79"             "?"              "UNP"            "P01116"        
 [9] "GLN"            "61"             "SEE REMARK 999" "61"            
[13] "19" 
```

# java - 在 Azure 门户上部署应用程序

> ID：10841130
> 
> 赞同：1
> 
> 时间：2012-05-31T20:55:02.333
> 
> 标签：java, azure, portal, azure-deployment

现在我想将我的 java 应用程序部署到使用 Azure 门户的 azure 云中。

1.  首先，我创建新的托管服务
2.  然后我在表格中填写了一些信息并尝试从本地计算机上传 Windows Azure 包和服务配置文件。

但是当我单击确定按钮时，我收到如下错误消息：

> 警告：此部署至少有一个角色和一个实例。我们建议您为每个角色至少部署两个实例，以确保高可用性，以防其中一个实例不可用。这样做还可以覆盖 Windows Azure 计算 SLA，从而保证 99.95% 的正常运行时间。如需更多信息，请访问此处。在 Windows Azure 支持论坛中查找更多解决方案。
> 
> 错误：部署需要新托管服务不存在的证书。要解决此问题，请在没有部署的情况下创建新的托管服务，添加所需的证书，然后创建部署。在 Windows Azure 支持论坛中查找更多解决方案。

这是什么错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:26:11.753

Did you enable remote desktop, or create an SSL endpoint? If so, you need to upload those certificates. To do that, create the hosted service without deploying. Then upload your cert to the Certificates folder under the hosted service name. Detailed instructions [here](http://msdn.microsoft.com/en-us/library/windowsazure/gg465712.aspx).

You can ignore the warning, as you're just learning and not deploying in a production enrivornment, but it's telling you that Windows Azure's Compute SLA only kicks in when having two or more instances.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T04:54:38.680

感谢您的回答。我已经使用 Azure 存储资源管理器上传了我的 cscfg 和 cspkg 文件，这非常有帮助。我不会再次超时 :)

现在我的简单 jsp 应用程序已经在[http://0c14bf7fe3cc439daaba409d4520372a.cloudapp.net/Achilles/上运行](http://0c14bf7fe3cc439daaba409d4520372a.cloudapp.net/Achilles/)

谢谢大家

# ms-word - 在 Office Word 2010 中将现有组添加到自定义功能区

> ID：10841134
> 
> 赞同：2
> 
> 时间：2012-05-31T20:55:17.683
> 
> 标签：ms-word, ms-office, add-in, ribbon

我正在为 MS Word 2010 创建一个自定义加载项功能区。我想知道，如果可能的话，如何将按钮组从其他本机功能区选项卡添加到我的自定义选项卡，而无需重新编程/复制这些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T10:33:35.957

您必须为您的 customUI xml 中的每个控件使用正确的 idMso 标记来引用所需的控件。

有关如何为内置控件找到正确 idMso 的说明，请访问[http://msdn.microsoft.com/en-us/library/aa722523%28v=office.12%29](http://msdn.microsoft.com/en-us/library/aa722523%28v=office.12%29)（在“查找 idMso应用程序的价值”）

如果您喜欢一堆 ID 列表，这里有一个供 Office 2010 下载：[http ://www.microsoft.com/en-us/download/details.aspx?id=6627](http://www.microsoft.com/en-us/download/details.aspx?id=6627)

# newline - 点（graphviz）语言中节点标签中的换行符

> ID：10841135
> 
> 赞同：54
> 
> 时间：2012-05-31T20:55:37.197
> 
> 标签：newline, graphviz, dot

有谁知道如何在节点的标签中添加换行符？\n 不工作 - 而是出现了一些新节点。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-05-31T22:08:13.857

这对我有用，[如记录](https://graphviz.gitlab.io/_pages/doc/info/attrs.html#k:escString)：

```
digraph {
    n[label="two\nlines"]
    "on\nthree\nlines"
} 
```

要么放入标签属性（我的偏好），要么将其用作节点的名称，但始终用双引号括起来。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-02T14:15:37.233

尝试“ `\\n`”有效：`dot.node('test', label="line1\\nline2")`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-11-20T18:51:11.937

你可以使用`\n`字符

有了[`graphviz`](https://pypi.python.org/pypi/graphviz)包，这会给

```
from graphviz import Digraph
d=Digraph()
d.node('test',label='line 1\\nline 2')
print(d.source) 
```

这会给

```
digraph {
    test [label="line 1\nline 2"]
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-09T19:25:03.573

这个问题对我来说也很重要，因为我使用 graphviz 生成详细的 UML 图并且需要在标签中使用转义字符。但是，使用 Python 包时，我遇到了如何处理转义字符的错误，因此一些推荐的解决方案不起作用。

例如：

```
from graphviz import Digraph
d=Digraph()
d.node('test',label='line 1\\nline 2')
print(d.source) 
```

生成以下内容（注意转义不起作用）：

```
digraph {
    test [label="line 1\\nline 2"]
} 
```

诸如使用单个反斜杠、原始字符串之类的解决方法非常无效。但是，最终起作用的解决方法如下：

```
 s = graphviz.Source(d.source.replace('\\\\', '\\'))
    s.render('my_uml') 
```

我不知道这个处理转义字符的错误是在 Python 绑定（v0.12）还是在 graphviz 本身（v2.44）中，但由于其他人可能会遇到它，我想提供这个解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-13T14:59:17.570

`<BR/>`[类似 HTML 的](https://graphviz.org/doc/info/shapes.html#html)标签中的标签会创建换行符。

```
digraph {
    n[label=<two<BR/>lines>]
} 
```

`\n`当无法使用语法时，这可以派上用场。最值得注意的是，[`graphviz`](https://ctan.org/pkg/graphviz)LaTeX 的包在解析`\`内部`.tex`文件时可能会出现问题，使用类似 HTML 的语法是一种解决方法。

# php - CakePHP '缺少视图'

> ID：10841136
> 
> 赞同：0
> 
> 时间：2012-05-31T20:55:39.780
> 
> 标签：php, cakephp

如果所有文件路径和命名约定都是正确的，他们是否有任何常见的原因来解释为什么 CAKE 会向我抛出特定的错误？

我的错误如下：

**错误：未找到 UsersController::login() 的视图。错误：确认您已创建文件：/Users/bellis/workspace/cake/app/View/Users/login.ctp**

该文件已创建，并且通过我的终端是我的“密码”，我得到：

**ss-mac-301:用户 bellis$ pwd /Users/bellis/workspace/cake/app/View/Users**

他们有什么理由让我收到这个错误吗？我尝试了权限，但似乎并非如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:25:05.173

这绝对是权限或丢失的文件。

缺少文件？

```
echo "Hi" > /Users/bellis/workspace/cake/app/View/Users/login.ctp 
```

权限不好？

您可能希望确保您的 Web 服务器至少能够读取 和 之间的每个`/`目录`/Users/bellis/workspace/cake/app/View/Users/`。这可以通过非常随意的“所有者、组和每个人都可以读取”（加上列出目录内容）或更细粒度的“所有者和组可以读取、写入（和列出目录内容）；其他人都被排除在外”来实现。

您的主文件夹`/Users/bellis/`通常不应该启用“每个人都可以阅读”（出于明​​显的安全原因）。

我建议将您的项目移出`/var/www/my_project/`并为这 3 个级别的“服务文件夹”设置权限，而不是任何数量的“用户私人文件夹”。如果您喜欢方便，则可以在主文件夹中的某处创建符号链接：`ln -s /var/www/my_project /Users/bellis/my_project`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T17:07:28.810

如果任何其他人对此有疑问（可能像我一样是 CakePHP 的初学者），就在这里发布。

原来我把我的视图文件放在里面`app/View/layouts/`而不是直接放在里面`app/View/`，愚蠢的错误，有时很难注意到，但很容易修复。

# php - “重新注册”基于表单 POST 的 PHP 会话

> ID：10841140
> 
> 赞同：0
> 
> 时间：2012-05-31T20:55:57.703
> 
> 标签：php, session, post

当用户登录到我的网站时，我创建了一个名为的会话，该会话`$_SESSION['session_city_id']`从 MySQL 收集 ID

我想知道是否可以从表单中更改它包含的数据。我创建了如下`select_city`所示的表单：

```
<form name='select_city' action='sessions.php' method='post' style='display:inline;'>
  <select onchange='this.form.submit()'>
  <option value='1'>The first value</option>
  <option value='2'>The second value</option>
  <option value='3'>The third value</option>
  </select>
 <noscript><input type="submit" value="Submit"></noscript>
</form> 
```

我的`sessions.php`样子是这样的（我刚开始用 PHP 编程，所以不要因为我是一个完整的菜鸟而抨击我！）

```
<?php
session_start();
$url = htmlspecialchars($_SERVER['HTTP_REFERER']); //Find out where the user came from

if (isset($_POST['select_city'])){

    $_POST['select_city'] = $city_id;

    if (isset($_SESSION['session_city_id'])){
    unset($_SESSION['session_city_id']);
    }
    $_SESSION['session_city_id'] = $city_id;                
}
header ("Location: $url"); //Redirect back to the page the user came from
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:58:57.720

```
if (isset($_POST['select_city'])){
    $city_id = $_POST['select_city'];
    $_SESSION['session_city_id'] = $city_id;                
} 
```

不需要unset，你替换了赋值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:02:04.243

您可以使用新值覆盖会话变量（无需取消设置）

```
if (isset($_POST['select_city'])){
    $_SESSION['session_city_id']=(int)$_POST['select_city']; // add a better check!
} 
```

并且不要忘记您所在领域的名称

```
<select name="select_city" onchange='this.form.submit()'> 
```

# html - 打破 html 表格使其在没有水平滚动条的情况下可见

> ID：10841142
> 
> 赞同：2
> 
> 时间：2012-05-31T20:56:19.093
> 
> 标签：html, html-table, line-breaks

是否可以在屏幕宽度处水平打断表格并在下一行显示左标题+数据，以便整个表格在没有水平滚动条的情况下可见？（或者可以用这种格式打印表格吗？）

例子：

从

```
col1 col2 col3 col4 col5
------------------------
dat0 dat1 dat2 dat3 dat4
dat5 dat6 dat7 dat8 dat9 
```

至

```
col1 col2 col3
--------------
dat0 dat1 dat2 
dat5 dat6 dat7

col4 col5
---------
dat3 dat4
dat8 dat9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:09:08.213

简短的回答：不。

您可以使用 div 模拟表格，请参阅[CSS Hell simulating TABLE with DIV](https://stackoverflow.com/questions/6299033/css-hell-simulating-table-with-div)以帮助您入门。

一旦你有了 div，你就可以做你描述的时髦的东西，也许在你的 html/css 混合物中混入一些 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:20:53.013

最好的方法是无表设计。只需使用 DIV

```
<div id="outercontainer" style="overflow:hidden">

<div id="inner1" style="float:left;">
dat0
dat5
</div>

<div id="inner2" style="float:left;">
dat1
dat6
</div>

....

<div id="innern" style="float:left;">
...
</div>

</div><!--outercontainer--> 
```

现在内部 DIV 的行为类似于 . 但是一旦一个特定的到达右边的角落，它就会将自己打破到新的线。

# xml - 如何将 XML 数据存储到 Oracle 表中

> ID：10841143
> 
> 赞同：6
> 
> 时间：2012-05-31T20:56:19.287
> 
> 标签：xml, oracle, xsd, xmltype, oracle-xml-db

在我们的业务中，我们每天接收并需要处理数千个 XML 文件，并且所有这些文件都采用相同的格式。我们想把这些数据存到oracle表中，保留这些数据的层次关系，然后我们可以用传统的SQL查询，做进一步的分析。最好的方法是什么？XML DB 是正确的选择吗？

## 更新：

目前，我正在考虑将 XML DB 与存储在结构化存储中的数据一起使用。所以我知道我可以定义一个带有注释的 XML 模式，并且我知道所涉及的步骤，但我想得到以下问题的确认答案：

1.  我可以注释一个 XML Schema 来为父子关系创建多个表吗？我希望数据存储在关系表中，而不是对象中。
2.  我可以为所有这些表定义主键、外键吗？我不太清楚Oracle如何维护这些表中的父子关系。
3.  谁能给我一个很好的例子？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T22:23:29.593

您肯定想从 XMLDB 开始。

XMLDB 本身就是一个拥有众多特性和功能的世界。

简而言之，您拥有三个带有 XMLDB 和 XMLTYPE 数据的存储选项。

您可以存储：

1.) 转换为 CLOB 数据类型。如果您这样做，XML 只是位于数据库中，它是一个 LOB。你不能索引它，搜索它，等等。数据库有点桶，你存储 XML。

2.) BINARY XML：这是 11gR2 中引入的最新选项。这将对 XML 进行标记和压缩，并以编码的二进制格式存储。这里的优点是您可以使用 Oracle Text 和 XMLINDEX 域索引来索引和搜索内容。这是我最有经验的选择。我们有十亿个文档，平均大小约为 12k，存储在 11gR2 数据库中。它对我们来说非常有效。

3.) XML 到关系映射：您定义一个关系模式以将数据存储在您的 XML 模式中，并定义 XML 元素如何映射到哪些关系表和字段。在摄取时，XML 被分解并存储到传统的关系模型中。然后，您可以像搜索任何传统数据库一样搜索、排序、索引。

这实际上取决于您想要做什么，以及您选择使用哪种 XML 存储模型。

您可以尝试在 Oracle XMLDB 论坛上提问。它非常活跃，并且有一些人比我更了解这个主题。 [https://forums.oracle.com/forums/forum.jspa?forumID=34](https://forums.oracle.com/forums/forum.jspa?forumID=34)

希望有帮助。

回复更新1：

我真的只有二进制 XML 存储选项的经验，抱歉。我认为检查 OTN 上的 XMLDB 示例代码会很有用。

请参见：

[http://www.oracle.com/technetwork/indexes/samplecode/xmldb-sample-523617.html](http://www.oracle.com/technetwork/indexes/samplecode/xmldb-sample-523617.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-30T13:45:31.750

有一本好书，我用过它，它帮助我解决了所有基本问题。它是关于 Oracle 11g 的，但它也可用于 12c。

它被称为“构建 Oracle XML DB 应用程序”，我建议，购买它并预留两天时间阅读和尝试。

# c# - UNC 共享目录不存在

> ID：10841149
> 
> 赞同：4
> 
> 时间：2012-05-31T20:56:54.843
> 
> 标签：c#, permissions, unc, network-share

我有一个 C# 进程需要读取远程服务器上共享目录中存在的文件。

以下代码导致“共享不存在”。被写入控制台。

```
string fileName = "someFile.ars";
string fileLocation = @"\\computerName\share\";
if (Directory.Exists(fileLocation))
{
    Console.WriteLine("Share exists.");
}
else
{
    Console.WriteLine("Share does not exist.");
} 
```

该过程在 AD 用户帐户下运行，并且同一帐户被授予对共享目录的完全控制权限。我可以成功地将共享映射为进程所在机器上的网络驱动器，并且可以将文件复制到目录/从目录复制。关于我所缺少的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:59:43.163

使用`File.Exists`而不是`Directory.Exists`.

另外，您可能希望与平台无关，并`Path.Combine`像这样使用规范：

```
string fileName = "someFile.ars";
string fileServer = @"\\computerName";
string fileLocation = @"share";
if (File.Exists(Path.Combine(fileServer, fileLocation, fileName)))
{
    Console.WriteLine("Share exists.");
}
else
{
    Console.WriteLine("Share does not exist.");
} 
```

# jquery - 使用选择更改内容，但能够使用 jQuery 显示所有内容

> ID：10841150
> 
> 赞同：0
> 
> 时间：2012-05-31T20:56:56.520
> 
> 标签：jquery, html

基本上我对此感到困惑，因为我对 jQuery 的了解有限。我有一个选择菜单列表，根据您选择的制造商，这些模型将使用 jQuery 显示。问题是如果有人选择“全部”，我无法弄清楚如何显示所有模型。如果有人可以帮助我，我将不胜感激，如果您现在选择“全部”，则没有任何显示。另外，这是解决这个问题的好方法吗？谢谢你。

[http://jsfiddle.net/KAjb7/1/](http://jsfiddle.net/KAjb7/1/)

或以下代码：

```
<select class="manufacturers">
<option class="selected" value="all">All</option>
<option value="motorola">Motorola</option>
<option value="htc">HTC</option>
<option value="lg">LG</option>
<option value="samsung">Samsung</option>
<option value="kyocera">Kyocera</option>
</select>

<div class="scroll-content">
  <ul class="manulist motorola">
    <li><a href="#">Motorola Triumph</a></li>
  </ul>
 <ul class="manulist htc">
   <li><a href="#">HTC WILDFIRE S</a></li>
  </ul>
  <ul class="manulist lg">
<li><a href="#">LG Optimus Slider</a></li>
<li><a href="#">LG Optimus V</a></li>
<li><a href="#">LG Rumor Touch</a></li>
<li><a href="#">LG Rumor 2</a></li>
<li><a href="#">LG 101</a></li>
  </ul>
</div> 
```

和 jQuery：

```
$(document).ready(function(){

$('.manufacturers').change(function(){
var selected = $(this).find(':selected');
$('ul.manulist').hide();

$('.'+selected.val()).show();
$('.optionvalue').html(selected.html()).
   attr('class', 'optionvalue '+selected.val());
});

});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:04:18.440

您只需要检查所选项目的值，如果它是 == 'all'，则显示所有这些值。

[http://jsfiddle.net/lucuma/WnapS/](http://jsfiddle.net/lucuma/WnapS/)

```
$(document).ready(function(){

    $('.manufacturers').change(function(){
    var selected = $(this).find(':selected');
    $('ul.manulist').hide();
        if ($(this).val() == 'all') {
            $('.scroll-content ul').show();
        } else {
    $('.'+selected.val()).show();
    $('.optionvalue').html(selected.html()).
       attr('class', 'optionvalue '+selected.val());
            }
    });

});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:04:46.797

尝试这个：

```
 if ($(this).val() == 'all') {
       $('.manulist').show()
    } 
```

[http://jsfiddle.net/KAjb7/2/](http://jsfiddle.net/KAjb7/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:05:28.347

3个选项：

1.  将类“all”添加到所有 ul 的
2.  改变

    ```
    <option class="selected" value="all">All</option> 
    ```

    至

    ```
    <option class="selected" value="manulist">All</option> 
    ```

3.  添加如果

    ```
    if (selected.val() == 'all') {
        $('.manulist').show();
    } else {
        $('.'+selected.val()).show();
    } 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T21:06:37.187

$(文档).ready(函数(){

```
$('.manufacturers').change(function(){
    var selected = $(this).find(':selected');

    if ( selected.val() == "all") {
        // console.log("all");
        $('ul.manulist').show();
        } else {
            $('ul.manulist').hide();

    $('.'+selected.val()).show();
    $('.optionvalue').html(selected.html()).
    attr('class', 'optionvalue '+selected.val());
            }

}); 
```

});

# html - 链接后面的文本预览

> ID：10841153
> 
> 赞同：0
> 
> 时间：2012-05-31T20:57:04.700
> 
> 标签：html, css

是否可以使用 css 和 html 显示链接背后的内容的“预览”？

例如：我在链接后面有一些文本信息，但我想在链接旁边显示这段文本的一部分……是否可以在不手动写下的情况下这样做？

这是代码示例

```
<dl>
<dt>News</dt>
<dd></dd>
<a href=".html"><img src=".jpg" height=100 width=120/>Some text</a>
    <p>This is the text i want to use as a preview of whats behind the active href link</p>
</dl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T20:59:46.907

可以通过 CSS 属性`z-index`和`opacity`. 但是，您必须使用**绝对定位**来将元素相互堆叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:02:16.470

每个链接都可以有一个工具提示，很容易添加到链接中

```
<a href="/users/811785/saeed" title="5623 reputation" class="comment-user">Saeed</a> 
```

使用该`title`属性添加您的“预览”，以便当有人将鼠标悬停在链接上并悬停片刻时，他们可以看到工具提示:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T06:15:58.320

在 CSS 中，将包含链接的元素设置为相对定位（`dd`在您的情况下，标记`<dd></dd>`必须是拼写错误，结束标记应出现在内容之后，`a`and`p`元素）。`display: none`为元素设置，`p`但当悬停时，使其绝对定位（这实际上意味着它将相对于封闭元素定位）并将其变为可见。添加合适的背景、边框和其他东西。细节取决于上下文。`img`如果元素都使用 100 像素高的图像（因此 108 像素或适合`p`元素的位移） ，则以下是一种可能性。

```
<style>
dd p {
  display: none; }
dd {
  position: relative; }
dd:hover p {
  display: block;
  margin: 0;
  position: absolute;
  top: 108px;
  background: #ffd;
  color: black;
  border: solid gray 0.08em;
  padding: 0 0.2em;
  z-index: 1000;
  max-width: 20em;
}
</style> 
```

# php - PHP中的MySQL查询和输出

> ID：10841156
> 
> 赞同：-1
> 
> 时间：2012-05-31T20:57:19.327
> 
> 标签：php, mysql

我有 2 个表，我想找出 groupid=1 中有多少用户，并将该组中的所有成员打印到一个数组中。

```
 groups table
    userid   groupid
      1         1
      2         1
      3         1
      4         2
      5         2

      users table
      userid    name
      1         tom
      2         tracy
      3         dave
      4         connie
      5         tim

   $query "SELECT COUNT(userid) FROM `groups` WHERE `grouped`=`1`";
   $result=mysql_query($query);
   $row = mysql_fetch_array($result);

   $num_users;
   $num_users=$row['COUNT(userid)'];

   while($row = mysql_fetch_array($result)){

     }

     $member_list;
      $member_list={
    //key(userid)  value(name)
     '1'=>'tom',
     '2'=>'tracy',
      '3'=>'dave'
        } 
```

我不知道如何使用如上所示的数据获取 $member_list 数组？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:09:52.783

你有代码：

```
 while($row = mysql_fetch_array($result)){
 } 
```

这会将 $row 设置为查询中某一行的值，然后将其丢弃并用下一个值替换它。在移动到下一行之前，您需要保存该信息。尝试这个：

```
$member_list = array();
while($row = mysql_fetch_array($result)){
    $member_list[$row['userid']] = $row['name'];
} 
```

之后，您拥有所有成员，`$member_list`您可以对其进行迭代，使用 print_r()，获取特定成员的数据，或者您想要的任何其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:10:21.957

做这样的事情：

```
$sql = "select groups.id, user.id, user.name from groups INNER JOIN users ON groups.userid = users.userid where groupid = 1";

    $query = mysql_query($sql);

    if(mysql_num_rows($query) > 0 ) {
           $users = array();
       while($fields = mysql_fetch_assoc($query)) {
           $users[$fields['user_id']] = $fields['name'];
       }
    } 

print_r($users); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:10:47.353

尝试这个。我还没有测试过，但我认为它会起作用。

```
$query = "SELECT userid FROM groups WHERE groupid='1'";
$result = mysql_query($query);

while($row = mysql_fetch_array($result)) {
    $userids[] = $row["userid"];
}

$query = "SELECT * FROM users";
$result = mysql_query($query);

while ($row = mysql_fetch_array($result)) {
    if (in_array($row["userid"], $userids) {
        $users[$row["userid"]] = $row["name"];
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T21:03:41.467

你可以这样做：

```
 while($row = mysql_fetch_array($result)){
        printf ("ID: %s  Name: %s", $row[0], $row["name"]);
    } 
```

或者

```
 /*everytime it fetches the row, adds it to array...*/
    while($r[]=mysql_fetch_array($sql));

    echo "<pre>";
    //= Prints $r as array =================//
    print_r ($r);
    //=============================//
    echo "</pre>"; 
```

# jquery - 使用 JQuery 和 ASP 加载动态内容

> ID：10841159
> 
> 赞同：0
> 
> 时间：2012-05-31T20:57:30.893
> 
> 标签：jquery, asp.net, dynamic, get, load

所以我有以下代码：

```
 $(document).on('click', 'a[data-link]', function () {
        var $this = $(this);
        url = $this.data('link');
        $("#imagePreview").load("imageProcess.aspx?" + url);
    }); 
```

这应该将 GET 数据发送到 imageProcess.aspx，然后将输出附加到 div id“imagePreview”。url 从这里存储数据：

```
<a class='modelsBlue' href = '#' data-link='model="+$(this).find('model').text()+"&type="+category+"'>" + $(this).find("model").text() + "</a> 
```

我遇到的问题是运行此代码时没有显示任何内容。目前我的 .aspx 文件只包含以下内容：

```
<%
   Response.Write(Request.QueryString("model"))
   Response.Write(Request.QueryString("type"))
%> 
```

我对来自 php 背景的 asp.net 很陌生，所以我确定问题出在 asp 文件中，但我一直在网上寻找解决方案，但找不到任何东西。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:03:37.887

图像是 HTTP 上的流，或者可以使用 base64 编码嵌入到 HTML 文档中。`imageProcess.aspx`你从文件中返回什么？您是否`Content-Type`在 HTTP 响应中设置了正确的标头（例如`image/png`或`image/jpg`）？

更新：我建议您首先确定问题出在哪里。安装[Fiddler](http://www.fiddler2.com/fiddler2/)并运行您的代码。通过 Fiddler 查看 HTTP 流量。这样，您可以看到服务器返回的内容（您可以看到 HTTP 响应正文）。如果什么都没有发回，那么问题出在服务器上。如果有东西被退回，但没有显示出来，那么当然你必须检查客户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:17:25.930

我建议使用一个程序，它可以准确地向您显示在您的 ajax 调用中发送和接收的内容。我个人使用[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)。

如果您不想使用新程序，我会在 asp 文件中添加一些额外的代码，以验证您是否获得了预期的查询字符串。即把它们改成

`Response.Write("model:" & Request.QueryString("model"))`

然后将回调函数添加到 $("#imagePreview").load 以准确查看您得到的响应。

# c# - 如何使用 C# 代码定义控件之间的空格？

> ID：10841168
> 
> 赞同：0
> 
> 时间：2012-05-31T20:58:10.600
> 
> 标签：c#, location, label, picturebox

我有一个`PictureBox`和两个`label`我在循环中动态制作的。如何从 picbox1 位置、label1 和 label2 位置进行计算，以便按照以下示例对齐：

picbox1 标签1

标签2

看似算盘有些简单，但我真的没想到现在怎么办。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:03:08.380

像这样的东西，虽然为了简单起见，我省略了标签。

它从 p 点开始，堆叠控件（右侧的文本框和图片框），然后循环。

```
Point p = new Point(15,35);
foreach (var field in fields)
{
   Label lbl = new Label {Text = field.Key, Location = p, AutoSize =  true};
   Point ppic = lbl.Location;
   ppic.Offset(lbl.Width + 20, 0);
   Control pic;
   pic = new PictureBox {Width = 400 - ptxt.X, Location = ppic};
   p.Offset(0, pic.Height + 3);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:04:38.403

这可能会有所帮助：

```
label1.Position=new Point(picbox1.Right, picbox1.Top);
label2.Position=new Point(picbox1.Left, picbox1.Bottom); 
```

# java - 从单独的 xml 绑定文件之间的 xml-element-ref 引用 xml-element

> ID：10841169
> 
> 赞同：1
> 
> 时间：2012-05-31T20:58:14.687
> 
> 标签：java, jaxb, moxy

我有两个 eclipselink moxy 绑定文件，因为我想为来自两个不同包的类添加绑定元数据。问题是，我想从一个在绑定 xml 文件中定义的文件中引用一个`xml-element`在绑定 xml 文件中定义的文件。`B.xml``xml-element-ref``A.xml`

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T09:38:43.810

没有什么特别需要做的。只需确保在引导 MOXy`JAXBContext`时将两个外部映射文档都带入。请参阅下面的示例：

```
package forum10874711;

import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextFactory;

import forum10874711.b.B;

public class Demo2 {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        List<String> metadata = new ArrayList<String>(2);
        metadata.add("forum10874711/a/binding2.xml");
        metadata.add("forum10874711/b/binding2.xml");
        properties.put(JAXBContextFactory.ECLIPSELINK_OXM_XML_KEY, metadata);
        JAXBContext jc = JAXBContext.newInstance(new Class[] {B.class}, properties);

    }

} 
```

**笔记：**

上面的代码取自我对您的其他问题之一的回答（包括一个完整的示例）：

*   [https://stackoverflow.com/a/10879080/383861](https://stackoverflow.com/a/10879080/383861)

# grails - 如何将if语句添加到groovy

> ID：10841170
> 
> 赞同：0
> 
> 时间：2012-05-31T20:58:15.527
> 
> 标签：grails, gsp

好的，我对 grails 和 groovy 完全陌生，我有一个按钮，我想添加一些语句。我在coldfusion中有一个类似的设置，我想在下面的groovy代码中移植到相同的设置。我将首先向您展示 CF 代码，然后是它需要使用的 groovy 代码。

```
<li id="menuBtn"><CFIF application.sf.secure.auth_feature('DTD')><a id="dtdItem" class="dtd <CFIF url.activity EQ "DTD">selected</CFIF>" href=<CFOUTPUT>"#application.http_path#services.cfm?activity=DTD"</CFOUTPUT>><b>DTD</b></a><CFELSE><a id="dtdItem" class="dtd" href="javascript:;" onclick="ERRORS.show('bla bla bla');return false;"><b>DTD</b></a></CFIF></li> 
```

所以我想简而言之，我正在尝试将上面的 if 和 else 部分写入我的 li 标签，但使用常规语法。

我在 grails 应用程序中被告知，我正在处理 auth_feature 的路径，就像在冷融合中一样，可以这样获得。

```
${auth_feature(name:'DTD')} 
```

所以这是我现在需要添加带有 javascript 错误的 if 和 else 语句的代码。

```
<li><a class="<g:if test="${controllerName == 'DTD'}">selected</g:if>" href="<%= grailsApplication.config.http_path %>DTD"><strong>DTD</strong></a></li> 
```

我再次确信这对于 grails 或 groovy 开发人员来说非常容易，但我对语言完全陌生，希望能从中学习。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T12:52:48.697

这个怎么样：

```
<li><a class="${controllerName == 'DTD' ? 'selected' : ''}" href="${grailsApplication.config.http_path}DTD"><strong>DTD</strong></a></li> 
```

# c# - 以编程方式设置枚举绑定组合框的值

> ID：10841171
> 
> 赞同：1
> 
> 时间：2012-05-31T20:58:39.220
> 
> 标签：c#, wpf, combobox, enums, databound

我正在使用这个：[Databinding an enum property to a ComboBox in WPF](https://stackoverflow.com/questions/58743/databinding-an-enum-property-to-a-combobox-in-wpf) databinding for my comboboxes。我无法以编程方式设置组合框的值。绑定后，我无法设置 SelectedItem、SelectedValue 或 Text。

必须有办法做到这一点？任何帮助表示赞赏。

澄清一下，我有一个绑定到具有所有 50 个状态的枚举的组合框。我有一个与组合框绑定到的枚举类型相同的状态值。我想将组合框值设置为我的状态值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:33:09.930

如果将 ComboBox 的 SelectedItem 绑定到基础类，则应该能够通过更改该类来更改绑定。

例如，假设您的枚举名为“Country”，并且您有一个名为“Person”的类，而该人有一个名为“CountryOfOrigin”的属性，您希望将其绑定到 ComboBox。你可以这样做：

XAML 文件：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestingWPF"
    x:Class="TestingWPF.TestWindow">

    <Window.Resources>
        <ObjectDataProvider MethodName="GetValues"
        ObjectType="{x:Type local:Country}"
        x:Key="Countries">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="local:Country" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>

    <StackPanel>
        <ComboBox x:Name="comboBox"
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Width="100" Margin="10"
              ItemsSource="{Binding Source={StaticResource Countries}}"
              SelectedItem="{Binding Path=CountryOfOrigin, Mode=TwoWay}"/>
        <Button HorizontalAlignment="Center" Content="Change Country to Mexico" Margin="10" Click="Button_Click"/>
    </StackPanel>
</Window> 
```

代码隐藏：

```
public partial class TestWindow : Window
{
    Person p;

    public TestWindow()
    {
        InitializeComponent();

        p = new Person();
        p.CountryOfOrigin = Country.Canada;

        DataContext = p;
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        p.CountryOfOrigin = Country.Mexico;
    }
}

public enum Country
{
    Canada,
    UnitedStates,
    Mexico,
    Brazil,
}

public class Person : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private Country _countryOfOrigin;

    public Country CountryOfOrigin
    {
        get
        {
            return _countryOfOrigin;
        }
        set
        {
            if (_countryOfOrigin != value)
            {
                _countryOfOrigin = value;

                PropertyChanged(this, new PropertyChangedEventArgs("CountryOfOrigin"));
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T20:35:42.507

我发现[这篇文章](http://blog.spencen.com/2009/04/19/binding-an-enum-property-to-a-combobox-using-customized-text.aspx)在处理绑定到 ComboBoxes 的枚举时非常有用，还有一些示例说明了如何组织转换以使用其属性值显示枚举。
因此用户可以看到 fe ">" 符号而不是名为 Greater

# debugging - 自定义 Sharepoint Web 部件 - 将属性重置为初始设置值

> ID：10841174
> 
> 赞同：0
> 
> 时间：2012-05-31T20:58:57.547
> 
> 标签：debugging, sharepoint, search, web-parts

我一直在编写一个非常基本的搜索 Web 部件来返回特定列表中的项目。

在我更改一些自定义属性字段之前，我的 Web 部件工作正常。在调试时，我发现我的 Web 部件似乎运行了两次，尽管我知道它们在页面上只有一次实例（已使用 [http://mysite?Content=1] 检查）

Web 部件的一次运行正在使用更改的属性，另一次使用导致其崩溃的初始属性。任何人都可以提出为什么会发生这种情况以及如何避免这种情况的原因。

非常感谢任何帮助 - 干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T11:11:47.077

正如您所说，您的代码被击中两次，所以这绝对意味着页面中存在两个 webpart，我建议的选项很少

1.  创建一个新页面并测试它
2.  检查关闭的 webpart，关闭的 webpart 不显示在 UI 中，但执行和事件发生
3.  [请参阅此链接](http://www.raregrooverider.com/post/2008/02/25/Closed-versus-Deleted-Web-Parts-in-SharePoint.aspx)以了解区别。
4.  您需要使用 content=1 而不仅仅是 content=1 正如您提到的那样

# geolocation - 如何使用 Google API 根据 WiFi MAC 地址获取位置

> ID：10841181
> 
> 赞同：2
> 
> 时间：2012-05-31T20:59:33.900
> 
> 标签：geolocation, google-api, google-api-java-client, google-api-client

我正在为此寻找文档和示例 java 客户端程序，以获取用户的位置（基于 wifi 接入点 MAC 地址/SSID 的经度和纬度）。然而，经过一段时间的搜索，我没有找到确切的文档和 java 示例客户端程序。

如果有人能在这里指出我正确的轨道，将不胜感激。这是用于笔记本电脑而不是智能手机。

我也在寻找类似的 API 来使用 IP 地址获取用户位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T20:39:35.170

**已过时**（仅供历史参考！）：

* * *

Gears 使用地理定位网络协议并将信息发送到[http://www.google.com/loc/json](http://www.google.com/loc/json)端点。[请求格式已记录在案](http://code.google.com/p/gears/wiki/GeolocationAPI#Request_Format)，但据我所知，TOS 不允许您这样做。它本质上是一个非公共 API。

# ios - 在我的 IOS 应用程序启动之前截取屏幕截图

> ID：10841185
> 
> 赞同：1
> 
> 时间：2012-05-31T20:59:47.007
> 
> 标签：ios, screenshot

是否可以在我的 IOS 应用程序启动之前截屏。

我可以通过以下方式简单地截取我的应用程序的主视图：

```
 UIGraphicsBeginImageContext(self.view.frame.size);
    [self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil); 
```

我也试过这种方法 UIKit 方式：

```
 // Create a graphics context with the target size
    // On iOS 4 and later, use UIGraphicsBeginImageContextWithOptions to take the scale into consideration
    // On iOS prior to 4, fall back to use UIGraphicsBeginImageContext
    CGSize imageSize = [[UIScreen mainScreen] bounds].size;
    if (NULL != UIGraphicsBeginImageContextWithOptions) UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
    else UIGraphicsBeginImageContext(imageSize);
    CGContextRef context = UIGraphicsGetCurrentContext();

    //
    // Iterate over every window from back to front.
    //
    for (UIWindow *window in [[UIApplication sharedApplication] windows]) 
    {
        if (![window respondsToSelector:@selector(screen)] || [window screen] == [UIScreen mainScreen])
        {
            //
            // -renderInContext: renders in the coordinate space of the layer,
            // so we must first apply the layer's geometry to the graphics context.
            //
            CGContextSaveGState(context);

            //
            // Center the context around the window's anchor point.
            //
            CGContextTranslateCTM(context, [window center].x, [window center].y);

            //
            // Apply the window's transform about the anchor point.
            //
            CGContextConcatCTM(context, [window transform]);

            //
            // Offset by the portion of the bounds left of and above the anchor point.
            //
            CGContextTranslateCTM(context, -[window bounds].size.width * [[window layer] anchorPoint].x, -[window bounds].size.height * [[window layer] anchorPoint].y);

            //
            // Render the layer hierarchy to the current context.
            //
            [[window layer] renderInContext:context];

            //
            // Restore the context.
            //
            CGContextRestoreGState(context);
        }
    }

    //
    // Retrieve the screenshot image.
    //
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIImageWriteToSavedPhotosAlbum(image, nil, nil, nil);

    UIGraphicsEndImageContext(); 
```

他们都致力于捕获我的应用程序的屏幕截图。

在我的应用程序启动之前，我如何捕获（当前的）屏幕截图。

我什至将第二个示例代码添加到 main.m 的开头，它不起作用。（已保存全屏空白图像）

我想使用屏幕截图作为我的应用程序的背景图片 :) ![我的应用程序正在运行...](../Images/a2eb08cb5c0e5aafa4df05497ef7574a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:09:03.207

在应用程序启动之前，您的应用程序代码不会被执行。我不知道您如何/为什么要实现这一目标。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-31T21:10:38.353

[http://graphicssoft.about.com/od/screencapture/qt/screen-shot-ipod-iphone.htm](http://graphicssoft.about.com/od/screencapture/qt/screen-shot-ipod-iphone.htm)

这是保存设备上显示内容的一种快速简便的方法。

# c# - 是否可以向 Windows 窗体发送自定义文本消息并接收自定义文本响应？

> ID：10841186
> 
> 赞同：-3
> 
> 时间：2012-05-31T20:59:57.733
> 
> 标签：c#, .net, winforms, ipc

我想知道是否可以这样做，或者您可以传递给窗口的唯一消息是否包含命令窗口执行某些操作的预定义消息。

如果可以传递文本并接收更多文本作为响应，有人可以写一小段代码告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T05:41:19.333

您可以在 Windows 中定义您的自定义消息代码并发送它们。请注意，当您跨进程边界发送消息时，只有 WM_COPYDATA 消息可以携带除两个 DWORD（wParam 和 lParam）之外的其他数据：仅对 WM_COPYDATA 窗口进行数据编组。

编写代码不是 StackOverflow 上的选项 - 使用 Google 搜索。

# system-verilog - 转换为 System Verilog 结构和引用成员

> ID：10841190
> 
> 赞同：1
> 
> 时间：2012-05-31T21:00:09.640
> 
> 标签：system-verilog

我想将向量转换为结构并在同一语句中提取成员。这可能吗？否则，我将不得不分配一个临时变量，这很难看。

例如：

```
typedef struct packed { logic a; logic b } struct_t;
struct_t my_struct;

logic [1:0] foo;
assign bar = struct_t'(foo).a; 
```

^^^^^ 这显然是不允许的！为什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T03:00:53.953

我同意能够这样做会很好，但在语言中是不允许的。SystemVerilog LRM (IEEE 1800-2009) 在第 23.7 节对此进行了解释。

> 分层名称和成员选择到结构、联合、类或覆盖组对象共享由句点分隔的名称组件序列的相同语法形式。在确定名称是分层名称还是成员选择之前，此类名称称为点名称。分层名称的区别在于名称的第一个组成部分必须与范围名称匹配，而成员 select 的第一个名称组成部分必须与变量名称匹配。使用的一般方法是尝试立即解析第一个名称组件，并使用该解析尝试的结果来确定如何处理整个名称。

由于您有`struct_t'(foo)`并且没有变量名，因此它不会将其`.a`视为成员选择。

同样，您不能像在 C++ 中那样访问从函数调用返回的类或结构的成员。

```
function struct_t getStruct();
  // do something
endfunction

logic a;
a = getStruct().a;   // <= Not allowed 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T22:45:33.740

根据规范，这看起来不像是有效的语法。我很确定只允许对标识符进行成员访问，而不是任何任意表达式。

# ipad - 设置 -webkit-perspective 模糊 ipad3 屏幕

> ID：10841198
> 
> 赞同：5
> 
> 时间：2012-05-31T21:00:55.893
> 
> 标签：ipad, css, webkit, mobile-safari, mobile-webkit

在 iPad3 上设置 webkit 透视 CSS 属性会使子元素呈现非常模糊，就像图像在非视网膜显示器上呈现一样。需要明确的是，我不是在谈论渲染模糊的图像，DOM 子元素正在渲染模糊。

对此可以做些什么？

简单地删除该属性不是一种选择，因为我使用需要在 Z 轴上移动的动画。

属性在 CSS 中是这样设置的：

```
-webkit-perpective: 500; 
```

感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:45:43.700

不确定这是否会有所帮助，但是前端大神 David DeSandro 在这篇文章中提到了这种事情，在“返回 Z 轴原点”部分下：

[http://24ways.org/2010/intro-to-css-3d-transforms](http://24ways.org/2010/intro-to-css-3d-transforms)

> 为了使 3-D 变换保持快速，Safari 会合成元素，然后应用变换。因此，文本的抗锯齿将保持在应用转换之前的状态。在 3-D 空间中向前变换时，可能会出现明显的像素化...
> 
> ...为了解决我们的#cube 的失真并恢复像素完美，我们可以将 3-D 对象推回，以便将正面定位回 Z 轴原点。
> 
> `#cube { -webkit-transform: translateZ(-100px); }`

# javascript - ~~ vs parseInt？

> ID：10841204
> 
> 赞同：16
> 
> 时间：2012-05-31T21:01:37.677
> 
> 标签：javascript

> **可能重复：**
> [JavaScript 中的“双波浪号”(~~) 运算符是什么？](https://stackoverflow.com/questions/5971645/what-is-the-double-tilde-operator-in-javascript)

D3 教程给出了一个产生随机序列的函数：

```
var t = 1297110663, // start time (seconds since epoch)
    v = 70, // start value (subscribers)
    data = d3.range(33).map(next); // starting dataset

function next() {
  return {
    time: ++t,
    value: v = ~~Math.max(10, Math.min(90, v + 10 * (Math.random() - .5)))
  };
} 
```

注意 ~~ (tilda tilda) 在：

```
 value: v = ~~Math.max(10, Math.min(90, v + 10 * (Math.random() - .5))) 
```

通过在 javascript 终端中玩耍，我看到：

```
~~1
1
~~-1
-1
~~-1.3
-1
parseInt(5)
5
parseInt(-5)
-5
parseInt(-5.3)
-5
parseInt(5.3)
5 
```

既然 ~~ 和 parseInt 似乎是等价的，那么使用 parseInt 的基本原理是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-31T21:04:47.703

它们不是等价的。

*   `parseInt()`将字符串转换为数字，读取并忽略第一个非整数字符，还可能执行基本转换（例如，将字符串解释为八进制或十六进制）。

```
console.log(

  parseInt(011)           +'\n'+ // 9
  parseInt('011')         +'\n'+ // 11
  parseInt('42 cats')     +'\n'+ // 42
  parseInt('0xcafebabe')  +'\n'+ // 3405691582
  parseInt('deadbeef',16) +'\n'+ // 3735928559
  parseInt('deadbeef',36) +'\n'  // 1049836114599

);
```

*   `var x = ~~y;`是一个“技巧”——类似于`var x = y << 0;`——(ab) 使用[一元按位非运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Bitwise_Operators)强制结果在有符号 32 位整数的范围内，丢弃任何非整数部分。

```
console.log(

  parseInt(011)                +'\n'+// 9
  parseInt('011')              +'\n'+// 11
  parseInt('42 cats')          +'\n'+// 42
  parseInt('0xcafebabe')       +'\n'+// 3405691582
  parseInt('deadbeef',16)      +'\n'+// 3735928559
  parseInt('deadbeef',36)      +'\n' // 1049836114599

);
```

经常使用`~~x`是因为：

1.  它通常比调用方法更快。
2.  打字比其他任何东西都快。
3.  它让高级用户感到很酷，因为它有点不可思议，也有点合理。:)

*从`cafebabe`测试中可以看出，由于有符号 32 位整数的限制，高于 2 ^(31)  ^- 1 ( 2,147,483,647 ) 或低于  ^- 2 ^(31)
( -2,147,483,648 ) 的数字将“环绕”。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-31T21:05:23.487

`parseInt`不限于有符号的 32 位数字。

```
 // Top range for a bitwise operator provides a valid result
~~((Math.pow(2,32)/2)-1); // 2147483647

   // Beyond the top range provides undesired result
~~(Math.pow(2,32)/2); // -2147483648 
```

此外，`parseInt`您可以指定基数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T21:05:10.383

```
~~"red" === 0

isNaN(parseInt("red")) 
```

parseInt 也可以处理超过 32 位的数字

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T21:10:33.737

简单：它是更易读、更方便的变体。

按位 NOT 运算符设计用于其他用途，但可能被误用于截断浮点值。在你的例子中，`Math.floor`也是可能的。

此外，在许多情况下，它们的行为并不相似。`parseInt`不限于 32 位，它可以解析以不同位置符号表示的数字，它还可以处理非数字值`NaN`。

# html - 如何将样式应用于页面中的单个特殊 HTML 字符

> ID：10841205
> 
> 赞同：2
> 
> 时间：2012-05-31T21:01:44.723
> 
> 标签：html, css, special-characters, silverstripe

我们有一位客户希望在其网站上为“注册商标”(®) 字符添加上标。

该网站是基于 CMS 的，他们不仅无法始终如一地使用上标字符，而且上标样式也不会传递到任何 CMS 生成的页面标题等。

我想知道实现这一目标的可能/最佳方法是什么：

*   可以使用 CSS 将样式应用于特定的特殊字符吗？
*   使用 jQuery 应用样式发布页面加载。
*   扩展模板解析引擎（Silverstripe）

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:09:45.723

我不相信它可以单独使用 CSS 来完成。

我会使用 jQuery 来查找和替换`&reg;`内容`<sup>&reg;</sup>`

下面有一个类似的问题，并提供了有关如何执行此操作的正确答案（省去了我的麻烦）：

[更改注册符号 (R)](https://stackoverflow.com/questions/3063242/altering-registered-symbols-r)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:22:17.220

不幸的是，我认为您不能仅使用 CSS 选择某些*字符*。

*然而...*

1.  上标有一个 CSS 规则，它是：

    ```
    vertical-align: super; 
    ```

2.  这个 jQuery 工作：

    ```
    $(document).ready(function() {
       $('*').each(function() {
        var n = $(this).html().replace(
            new RegExp('®','g'),
            '<sup>®</sup>'
            ).replace(
            new RegExp('&reg;','g'),
            '<sup>&reg;</sup>'
            );
        $(this).html(n);
      });
    });​ 
    ```

    *   jsFiddle 示例：http: [//jsfiddle.net/Fwjd4/](http://jsfiddle.net/Fwjd4/)

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:05:21.117

*   我不认为你可以单独做到这一点
*   使用 jquery/javascript/css，您可以创建一个包含字符样式信息的类，然后让 jquery 解析文件部分并将字符包装在`<span></span>`标签内，并应用该 css 类
*   我对银条一无所知，所以我不能评论它的用法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T21:24:19.970

严格来说，您不能使用任何单个 CSS 属性创建“超级脚本”（有 veritcal-align “超级”，但它不会改变字符的大小或样式，只是它相对于文本基线的位置）。但是，有一些方法可以成功地实现这一点，我之前已经尝试过。

首先，正如另外两张海报所提到的，您需要以某种方式定位该符号。如果您可以`&reg;`用标记包装所有字符，那么其余的可以用 CSS 轻松完成。例如：

当您拥有这些样式时`<sup>&reg;</sup>`，您可以简单地将这些样式添加到您的样式表中以获得所需的效果：

```
<div>
<p>This is some crazy text brought to you by my Company<sup>&reg;</sup><p>
<div>​

div{
 background:#000;
 width:80%;
 height:80%;
 padding:10% 10%;    
}
p{
 background:#4d4d4d;
 padding:10% 20%;    
 color:#fff;
 font-family:Arial-black,Arial,sans-serif;
 font-size:2em;
}
sup{
 position:relative;
 font-size:.75em;
} 
```

​ 这里是一个例子：http: [//jsfiddle.net/jglovier/vqHuu/](http://jsfiddle.net/jglovier/vqHuu/)

当然，如果您不能像这样访问标记，则需要使用 jQuery 来查找字符并将它们包装在`<sup>`其他人建议的标签中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-07T04:50:48.037

在 PHP 代码中，您可以将其放入您的 Page 类中，以便在服务器端执行您想要的操作：

```
function Content() {
  return str_replace('®', '<sup class="copyright">®</sup>', $this->Content);
} 
```

`$Content`在模板引擎中将首先查找`$page->Content()`（方法），如果不存在将查找`$page->Content`. 相比之下，CMS 编辑器只查找`$page->Content`. 这意味着通过定义`Content()`处理输出的方法，您可以包含仅在模板显示上执行且不会与 CMS 混在一起的代码。

# php - 防止在 Magento 中触发观察者

> ID：10841208
> 
> 赞同：1
> 
> 时间：2012-05-31T21:01:59.657
> 
> 标签：php, magento, observers

我认为这是一个非常简单的问题，但考虑到我的编程水平，这对我来说并不容易。

我想知道在某些事件发生后是否有停止或不触发观察者的方法，这是因为我正在做的观察者处于无限循环中，我想阻止它执行该循环。

我希望我的问题足够清楚。

谢谢

**更新：** 一个例子可能是：观察者在事件中触发：core_config_data_save_after，当这个观察者启动时，你想更新 core_config_data 表中的值，但是当你保存它时，观察者再次启动并且有循环

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-03T22:21:42.377

一种可能的解决方案是使用注册表并设置一个标志 - 如果在任何未来命中设置了注册表标志，您只需从观察者返回。

IE

```
public function myObserver(Varien_Event_Observer $observer)
{
    if (Mage::registry('my_observer_has_run')) {
        return $this;
    }

    .... Your Code Here ....

    Mage::register('my_observer_has_run', true);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T22:38:21.857

您应该能够找到您想要并设置的观察者`<type>disabled</type>`

```
<frontend>
<events>
        <controller_action_predispatch>
            <observers>
                <log>
                    <class>log/visitor</class>
                    <method>initByRequest</method>
                </log>
            </observers>
        </controller_action_predispatch>
        .... other events
    </events> 
```

本地修改 XML 以禁用上面找到的观察者：

```
<frontend>
    <events>
        <controller_action_predispatch>
            <observers><log><type>disabled</type></log></observers>
        </controller_action_predispatch>
    </events>
</frontend> 
```

代码和更多细节：

*   [http://inhoo.net/ecommerce/magento/how-to-disable-magento-event/](http://inchoo.net/ecommerce/magento/how-to-disable-magento-event/)

# mercurial - 在重大重组后告诉 Mercurial 移动的文件

> ID：10841212
> 
> 赞同：35
> 
> 时间：2012-05-31T21:02:08.880
> 
> 标签：mercurial

我们最近在我们的服务器上重新组织了一个非常杂乱无章的网站。本网站使用 Mercurial 进行版本控制。我们重新组织了一切。数以千计的文件。现在，当我执行 a 时`hg status`，它会显示由 a 表示的大量新的未跟踪文件`?`和大量丢失的文件，这些文件与未跟踪的文件相同，由 a 表示`!`。

我如何告诉 Mercurial 我们移动了这些文件？我知道我可以一个一个地做，但考虑到有成千上万的人，这不是一个选择。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-05-31T21:22:59.970

您可以使用`hg mv --after`来表示您已经移动了文件。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-01T04:54:38.973

`hg addremove`如果默认情况下文件 100% 相似，将在事后检测重命名，并且可以用`-s`.

此外，如果使用 TortoiseHg，`thg guess`将弹出一个对话框，您可以在其中使用滑块设置相似性并查看添加和删除文件之间的匹配结果，然后选择要记录为重命名的对。

例子：

```
C:\>hg init test
C:\>cd test
C:\test>echo >file1
C:\test>echo ONE>file1
C:\test>echo TWO>file2
C:\test>hg ci -Am init
adding file1
adding file2

C:\test>ren file1 file3
C:\test>ren file2 file4
C:\test>hg st
! file1
! file2
? file3
? file4

C:\test>hg addrem
removing file1
removing file2
adding file3
adding file4
recording removal of file1 as rename to file3 (100% similar)
recording removal of file2 as rename to file4 (100% similar)

C:\test>hg status -C   # -C shows file copies.
A file3
  file1                # file3 copied from file1...
A file4
  file2                # file 4 copied from file2...
R file1
R file2 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-31T21:06:58.740

使用`hg addremove`. 您不能只是移动文件并期望 Mercurial 知道这一点 - 如果您正在移动跟踪的文件，请使用`hg mv`.

# iphone - iPhone 核心数据 NSFetchRequest

> ID：10841217
> 
> 赞同：0
> 
> 时间：2012-05-31T21:02:22.963
> 
> 标签：iphone, core-data, nsfetchrequest

我对这项技术并不陌生，但有一件事让我很烦。这是关于核心数据的。假设我有这样的数据库模型：

人 <-> 房子 <-> 房子详细信息

<-> 表示双向关系，Person 有很多房子，每个房子都有它的详细信息（无论如何，例如）。

现在在核心数据中，当我接触到特定的人时，我会得到这个人以及所有关系（在客观方法参考中）到“房屋细节”。

现在想象一下 db 模型更复杂，XCode 强制双向关系（仅通过警告，但仍然如此）。

我的问题是假设我是否根据 XCode 正确（双向）拥有所有关系，是否有任何方法可以获取查询（来自上面的示例），我想在其中获取特定的 Person，但没有对房屋和房屋详细信息的引用。

我问这个问题的原因是因为据我所知这是不可能的，或者不是？另一个原因，主要原因是，当我们拥有具有双向关系的复杂数据库模型时，当我们只想接收没有任何人的数据时，需要一些时间来获取所有这些数据（我们想要的但有所有引用）与数据库模型的其他关系（参考）如此。基本上，这个想法是在我们仅要求 Person 数据时从结果中修剪所有关系（根据示例）。

注意：这是我关于堆栈溢出的第一篇文章，所以不要活吃我:)。但是，如果这不可能实现我的要求，老实说，这是一个很大的痛苦，不能从开发人员的角度按照您想要的方式管理数据。

如果我对这篇文章不清楚，请告诉我，我会解释这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:11:01.813

当您获得实体的特定实例时，您不必担心 Core Data 将获取的确切内容。Core Data 将为您管理内存问题。即使是获取实体的单个属性也可能是，`"faults"`即核心数据会在需要时自动检索这些详细信息。`NSLog`您可以使用语句检查这一点。除非需要，否则您的托管对象的许多详细信息将不可用。

因此，如果您有一个实体`Person`并获取一个`person`包含 100 个房屋的实例，每个实例包含 50 个房屋详细信息，您将不会被所有这些数据堵塞您的记忆。

实际上，这就是 Core Data 的美妙之处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:13:29.817

默认情况下，核心数据会延迟加载关系，因此当您获取人员对象时，只有在您开始引用它们时才会获取您的关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:16:45.277

坏消息是，当您有双向关系时，这种关系是从两端维持的，因此在您的情况下，您可以将一个人添加到一个房子或一个房子到一个人，并且任何一方都会在他们的关系集中（假设多对多关系）。这就是 Core Data 的工作方式。

好消息是，由于 CoreData 懒惰地获取信息的方式，这真的无关紧要。因此，如果您希望在不获取所有相关房屋的情况下找到一个人，这就是 CoreData 所做的。直到您真正希望在关系结束时加载对象，它们作为故障存在，也就是说最小的骨架引用。

NSLog 您获取的 Person 对象之一，如果它的相关房屋以前没有被获取，它们将作为最小引用打印出来。

# linux - 来自 linux 核心转储的线程特定数据

> ID：10841219
> 
> 赞同：10
> 
> 时间：2012-05-31T21:02:27.440
> 
> 标签：linux, gdb, coredump

在分析**Linux**的核心转储时，如何获取指向线程本地存储或**线程特定数据**的指针？

 **我用来在的本地存储`pthread_setspecific`中存储一些数据。`pthread`

我在 Linux 上的多线程程序崩溃了，我想看看当前运行线程的本地存储中存储了什么。

如果我得到指向线程本地存储的指针，我可以使用 key 来获取存储的数据。

**gdb**中是否有获取***指向线程本地存储***的指针的命令？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T04:40:14.810

如果您正在调试实时程序，您可以：

```
print pthread_getspecific(i) 
```

如果您有权访问线程的 pthread_t，则可以：

```
print ((struct pthread*)pth)->specific[i/32][i%32] 
```

i 在你想要的索引中，pth 是 pthread_t。请参阅 glibc 源代码中的 nptl/pthread_getspecific.c。

要在不调用函数的情况下执行此操作，您需要找到 struct pthread。在 x86-64 上，它存储在 fs 基础中，使用 arch_prctl(ARCH_SET_FS_BASE, ...) 设置。我不知道如何从 gdb 访问它，但是您可以使用 eu-readelf 获取它。运行`eu-readelf --notes core_file`并查看记录`fs.base`。该数字是 pthread_t 值。（要弄清楚它是哪一个，您可以`pid`将同一记录中的字段与 gdb`info threads`命令中显示的 LWP 进行匹配。）

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-02T20:55:43.400

据我所知，gdb 中没有命令可以获取指向通过`pthread_setspecific()`. 但是，有几个选项可以获取内存地址：

*   检查每个线程的回溯，检查每一帧以查看结果`pthread_getspecific()`是否仍在堆栈中。
*   修改现有代码以记录线程 ID 和`pthread_getspecific()`.
*   在线程内部数据中找到线程特定的数据列表，然后使用键找到将包含地址的记录。这种方法依赖于 pthread 库的实现；因此，它需要了解正在使用的 pthread 实现，或者需要一点耐心进行逆向工程。

下面是一个在 32 位机器上使用简单程序的演示：

*   g++ (GCC) 4.1.2 20080704 (红帽 4.1.2-48)
*   libpthread-2.5.so
*   GNU gdb 红帽 Linux (6.5-25.el5rh)

* * *

```
$cat example.cpp
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

void* the_thread( void* ); 
void get_position();

struct position_t
{
  int x;
  int y;
};

namespace {
  pthread_key_t position_key;

  enum {
    NUMBER_OF_THREADS = 2
  };
} // unnamed

int main(int argc, char **argv)
{
  int result = pthread_key_create( &position_key, NULL );
  printf( "pthread_key_create -- key: %u, result: %i\n",
          position_key, result );

  pthread_t threads[NUMBER_OF_THREADS];
  for (unsigned int i = 0; i < NUMBER_OF_THREADS; ++i )
  {
     // Allocate a position per threads.
     position_t* position = new position_t();

     // Set position values.
     position->x = ( 1 + i ) * 11;
     position->y = ( 1 + i ) * 13;

     // Create the thread.
     result = pthread_create( &threads[i], NULL, the_thread, position );
  }

  // Give time for threads to enter their forever loop.
  sleep( 5 );

  // Abort.
  abort();
  return 0; 
}

void* the_thread( void* position )
{
   int result = pthread_setspecific( position_key, position );

   printf( "Thread: 0x%.8x, key: %u, value: 0x%.8x, result: %i\n",
           pthread_self(), position_key, position, result );

   get_position();
   return 0;
}

void get_position()
{
   position_t* position =
        reinterpret_cast< position_t* >( pthread_getspecific( position_key ) );

   printf( "Thread: 0x%.8x, key: %u, position: 0x%.8x, x: %i, y: %i\n",
           pthread_self(), position_key, position, position->x, position->y );

   // Wait forever.
   while( true ) {};
}

$ g++ -g -lpthread example.cpp && gdb -q ./a.out 
Using host libthread_db library "/lib/libthread_db.so.1".
(gdb) r
Starting program: /tmp/a.out 
[Thread debugging using libthread_db enabled]
[New Thread -1209043248 (LWP 17390)]
pthread_key_create -- key: 0, result: 0
[New Thread -1209046128 (LWP 17393)]
Thread: 0xb7ef6b90, key: 0, value: 0x09a35008, result: 0
Thread: 0xb7ef6b90, key: 0, position: 0x09a35008, x: 11, y: 13
[New Thread -1219535984 (LWP 17394)]
Thread: 0xb74f5b90, key: 0, value: 0x09a350b0, result: 0
Thread: 0xb74f5b90, key: 0, position: 0x09a350b0, x: 22, y: 26

Program received signal SIGABRT, Aborted.
[Switching to Thread -1209043248 (LWP 17390)]
0x00377402 in __kernel_vsyscall () 
```

* * *

### 使用仍在堆栈上的地址：

```
(gdb) info threads
  3 Thread -1219535984 (LWP 17394)  get_position () at example.cpp:71
  2 Thread -1209046128 (LWP 17393)  get_position () at example.cpp:71
* 1 Thread -1209043248 (LWP 17390)  0x00377402 in __kernel_vsyscall ()
(gdb) thread 3
[Switching to thread 3 (Thread -1219535984 (LWP 17394))]#0  get_position () 
 at example.cpp:71
71         while( true ) {};
(gdb) list get_position
57
58         get_position();
59         return 0;
60      }
61       
62      void get_position()
63      {
64         position_t* position =
65              reinterpret_cast< position_t* >( pthread_getspecific( 
 position_key ) );
66
(gdb) info locals
position = (position_t *) 0x9a350b0
(gdb) p position->x
$1 = 22
(gdb) p position->y
$2 = 26 
```

* * *

### 使用从标准输出打印的地址：

```
(gdb) p ((position_t*)(0x09a350b0))->x 
$3 = 22
(gdb) p ((position_t*)(0x09a350b0))->y
$4 = 26 
```

* * *

### 在线程内部数据中找到线程特定的数据列表：

`key`如果你有 和 的值，这种方法会容易得多`pthread_t`。

我将根据需要介绍有关我正在使用的 pthread 实现的详细信息：

*   `pthread`struct 是 pthread 内部使用的线程描述符结构。
*   `pthread_create()`返回`pthread_t`, 一个`unsigned int`, 包含相关`pthread`结构的地址。

首先，找到`pthread`线程的结构。

```
(gdb) info threads
* 3 Thread -1219535984 (LWP 17394)  get_position () at example.cpp:71
  2 Thread -1209046128 (LWP 17393)  get_position () at example.cpp:71
  1 Thread -1209043248 (LWP 17390)  0x00377402 in __kernel_vsyscall ()
(gdb) thread 1
[Switching to thread 1 (Thread -1209043248 (LWP 17390))]#0  0x00377402 in
 __kernel_vsyscall ()
(gdb) bt
#0  0x00377402 in __kernel_vsyscall ()
#1  0x0080ec10 in raise () from /lib/libc.so.6
#2  0x00810521 in abort () from /lib/libc.so.6
#3  0x0804880f in main () at example.cpp:47
(gdb) frame 3
#3  0x0804880f in main () at example.cpp:47
47        abort();
(gdb) info locals
result = 0
threads = {3085921168, 3075431312}
(gdb) p/x threads[1]
$5 = 0xb74f5b90 
```

忽略许多字段，`pthread`结构定义如下所示：

```
struct pthread
{
  ...
  pid_t tid; // Thread ID (i.e. this thread descriptor).
  pid_t pid; // Process ID.
  ...
  struct pthread_key_data
  {
    uintptr_t seq;
    void *data;
  } specific_1stblock[PTHREAD_KEY_2NDLEVEL_SIZE];
  struct pthread_key_data *specific[PTHREAD_KEY_1STLEVEL_SIZE];
  ...
}; 
```

*   `pthread_key_data.seq`: 包含应该相当低并且匹配的序列号`__pthread_keys[key].seq`。
*   `pthread_key_data.data`: 包含提供给的值`pthread_setspecific()`
*   `pthread.specific_1stblock`是一个块，用于在尝试动态分配更多块之前存储线程特定的数据。
*   `pthread`是线程特定数据的两级数组。索引`0`将包含 的内存地址`pthread.specific_1stblock`。
*   `PTHREAD_KEY_2NDLEVEL_SIZE`大小为 32。

该定义给出了一个相当好的想法，即在内存中寻找什么：

*   一个具有`pthread`内存地址值的整数 ( `tid`)，后跟一个具有进程 ID ( `pid`) 的整数。这有助于指示正在检查的内存是否是`pthread`结构。
*   `cancelhandling`并且`flags`是标志。具体值并不重要。这些字段可能很有帮助，因为它们的值可能与其他字段明显区分开来，例如包含内存地址或计数器的字段。
*   `specific_1stblock`是一个大小为 32 的数组。如果`pthread`结构已被零初始化，则应该重复`0`s 62~ 个字，因为示例代码只有一个线程特定的数据`position_key`，其大小为两个字。
*   `specific`是一个包含内存地址的数组。如果`pthread`结构已经被零初始化，那么应该有重复`0`的 s，但第一个值应该是 的内存地址`specific_1stblock`。

打印一块`pthread`的内存：

```
(gdb) p/x *((int*)threads[1])@150
$6 = {0xb74f5b90, 0x9a350c8, 0xb74f5b90, 0x1, 0x377400, 0x7fb99100,
  0xcb40329e, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xb7ef6bd0,
  0x96b118, 0x43f2, 0x43ee, 0xb74f5be0, 0xffffffec, 0x0, 0x0, 0xb74f5470,
  0x0, 0x1, 0x9a350b0, 0x0 <repeats 62 times>, 0xb74f5bf8,
  0x0 <repeats 31 times>, 0x1000101, 0x0, 0x0, 0x0, 0xc2342345, 0xe0286,
  0x0, 0x0, 0x0, 0x0, 0x0, 0x80486ca, 0x9a350b0, 0x0 <repeats 13 times>, 
  0xb6af5000, 0xa01000} 
```

通过分析内存中的模式，一些词成为特定 pthread 字段的良好候选者：

```
0xb74f5b90, 0x9a350c8, 0xb74f5b90 (pthread.tid), 0x1, 0x377400 (pthread.pid) ...
0x1, 0x9a350b0, 0x0 <repeats 62 times> (pthread.specific_1stblock) ...
0xb74f5bf8, 0x0 <repeats 31 times>  (pthread.specific) 
```

可以进行一些轻量级的完整性检查，例如检查是否`pthread.specific[0]`包含以下地址`pthread.specific_1stblock`：

```
(gdb) p/x *((int*)0xb74f5bf8)@64
$7 = {0x1, 0x9a350b0, 0x0 <repeats 62 times>} ## matches specific_1stblock 
```

现在`pthread.specific`已经确定了，通过计算字偏移量来获得它的内存地址`&pthread`。在这种情况下，它是 90：

```
(gdb) set $specific=(int*)threads[1] + 90 
```

通过 计算第一个和第二个索引`position_key`：

*   第一个数组的索引是`key / PTHREAD_KEY_2NDLEVEL_SIZE`。
*   第二个数组的索引是`key % PTHREAD_KEY_2NDLEVEL_SIZE`。

    ```
    (gdb) set $index1=position_key/32
    (gdb) set $index2=position_key%32 
    ```

找到`pthread_key_data`for `position_key`：

```
(gdb) set $level2=(int*)*($specific + $index1)
(gdb) p/x *($level2 + (2*$index2))@2
$8 = {0x1, 0x9a350b0} 
```

因此：

`pthread_key_data.seq = 1`
`pthread_key_data.data = 0x9a350b0`

第一个词是`seq`which should match `pthread_key_struct[position_key].seq`。由于处理原始内存，`__pthread_keys`将被强制转换为`int*`并且必须进行指针算术以考虑 sizeof `pthread_key_struct`：

```
(gdb) p *(&((int*)&__pthread_keys)[2*position_key])@2
$9 = {1, 0} 
```

因此：

`pthread_key_struct[position_key].seq = 1`
`pthread_key_struct[position_key].destr = NULL`

数字匹配，`seq`所以一切看起来都很好。`pthread_key_data.data`包含将从 . 返回的值`pthread_getspecific( position_key )`。

```
(gdb) set $position=(position_t*)0x9a350b0
(gdb) p $position->x
$10 = 22
(gdb) p $position->y
$11 = 26 
```

* * *

`key`在技​​术上仍然可以在不知道和值的情况下定位特定于线程的数据`pthread_t`：

*   如果向 提供了析构函数`pthread_key_create()`，则其内存地址可能会驻留在`__pthread_keys`数组中。检查内存，计算偏移量并除以 sizeof `pthread_key_struct`。这应该会产生索引，这也恰好是关键：

    ```
    void* destr_fn( void* );
    pthread_key_create( key, destr_fn )
    __pthread_keys[key].destr == destr_fn 
    ```

*   如果`pthread_t`未知，它可能存在于线程堆栈上的寄存器中。这可能需要检查各种不同的内存地址，试图在内存中找到包含该`pthread`结构的部分。

    ```
    (gdb) info thread
      3 Thread -1219535984 (LWP 17394)  get_position () at example.cpp:71
      2 Thread -1209046128 (LWP 17393)  get_position () at example.cpp:71
    * 1 Thread -1209043248 (LWP 17390)  0x00377402 in __kernel_vsyscall ()
    (gdb) thread 3
    [Switching to thread 3 (Thread -1219535984 (LWP 17394))]#0 g
     get_position () at example.cpp:71
    71         while( true ) {};
    (gdb) bt
    #0  get_position () at example.cpp:71
    #1  0x0804871d in the_thread (position=0x9a350b0) at example.cpp:58
    #2  0x0095c43b in start_thread () from /lib/libpthread.so.0
    #3  0x008b3fde in clone () from /lib/libc.so.6
    (gdb) frame 2
    #2  0x0095c43b in start_thread () from /lib/libpthread.so.0
    (gdb) info register
    eax            0x3f     63
    ecx            0xb74f52ac       -1219538260
    edx            0x0      0
    ebx            0x96aff4 9875444
    esp            0xb74f53c0       0xb74f53c0
    ebp            0xb74f54a8       0xb74f54a8
    esi            0x0      0
    edi            0xb74f5b90       -1219535984
    eip            0x95c43b 0x95c43b <start_thread+203>
    eflags         0x200286 [ PF SF IF ID ]
    cs             0x73     115
    ss             0x7b     123
    ds             0x7b     123
    es             0x7b     123
    fs             0x0      0
    gs             0x33     51 
    ```

    在这种情况下，`edi`寄存器包含`pthread`结构的地址。

参考：[descr.h](http://glibc.sourcearchive.com/documentation/2.5/glibc-2_85_2nptl_2descr_8h-source.html "描述文件")、[pthread_key_create.c](http://glibc.sourcearchive.com/documentation/2.5/pthread__key__create_8c-source.html "pthread_key_create.c")、[pthread_setspecific.c](http://glibc.sourcearchive.com/documentation/2.5/pthread__setspecific_8c-source.html "pthread_setspecific.c")、[pthreadP.h](http://glibc.sourcearchive.com/documentation/2.5/pthreadP_8h-source.html "pthreadP.h")、 [internaltypes.h](http://glibc.sourcearchive.com/documentation/2.5/glibc-2_85_2nptl_2sysdeps_2unix_2sysv_2linux_2internaltypes_8h-source.html "内部类型.h")**

# android - 将带有附件的电子邮件作为 csv 文件发送

> ID：10841223
> 
> 赞同：1
> 
> 时间：2012-05-31T21:02:34.020
> 
> 标签：android

我正在尝试将电子邮件中的附件作为 csv 文件从模拟器发送。电子邮件已发送，但没有附件。它还给了我一条祝酒消息“文件要大到要附加”

公共类 MainActivityActivity 扩展 Activity {

```
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    String dir = "/Android/data/com.pucit/csv/";
    String fullDir = Environment.getExternalStorageDirectory().toString() + dir;
    generateCsvFile(fullDir, "data.csv");

    Uri uri = Uri.fromFile(new File(Environment.getExternalStorageDirectory(),"data.csv"));
    Log.d("321", "a"+uri.toString());

    final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
    emailIntent.setType("plain/text");
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{"ninja9196@gmail.com"});
    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Attachment");
    emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:///mnt/sdcard/data.csv"));
    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, "gmail.com");

    MainActivityActivity.this.startActivity(Intent.createChooser(emailIntent, "Send mail..."));

}

private static void generateCsvFile(String dir, String fileName) {
    try {

        File theDir = new File(dir);
        theDir.mkdirs();

        FileWriter writer = new FileWriter(dir + fileName);

        writer.append("DisplayName");

        //generate whatever data you want

        writer.flush();
        writer.close();
    } catch (IOException e) {
        Log.i("file", e.getMessage());
    }     
} 
```

}

# image - 对我来说，构建可进行大量图像处理的可扩展应用程序的好方法是什么？

> ID：10841224
> 
> 赞同：0
> 
> 时间：2012-05-31T21:02:38.173
> 
> 标签：image, image-processing, imagemagick, image-manipulation

我正在构建一个处理大量图像的应用程序，我们需要处理每个图像以应用各种转换，例如缩放/调整大小、过滤器等。我应该如何构建它以使其可以随着我们的成长而扩展我不需要像 Instagram 和其他人那样经历成长的痛苦吗？

顺便说一句，我们现在正在使用 ImageMagick 处理图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:37:34.910

我也在另一个线程中回答了这个问题，但这是一种无需担心缩放的方法：

您可以使用[IronWorker 之](http://www.iron.io/products/worker)类的服务在后台进行图像处理并减轻服务器的负载。由于它是一项服务，因此您无需管理任何内容或设置任何其他内容，它会随着您的成长而扩展，因此如果您可以使用它制作一张图像，您可以零努力地扩展到数百万张图像。

这是一篇关于如何进行一堆图像处理转换的文章：

[http://dev.iron.io/solutions/image-processing/](http://dev.iron.io/solutions/image-processing/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:10:28.073

当他们像 Instagram 一样快速增长时，每个人都难以扩展。

我的一般建议是使用工作队列系统将图像处理分配给 n 个工作人员，以便您可以轻松添加更多工作人员以更快地将工作从队列中拉出。

如果您将它与亚马逊 s3 之类的图像存储一起使用，并且可以在 ec2 上为更多工作​​人员添加更多服务器（例如使用 puppet、chef、scalr 等来启动更多工作人员框），您应该能够很好地扩展.

# odbc - SQL ODBC 驱动程序在 Windows 7 中无法访问

> ID：10841227
> 
> 赞同：0
> 
> 时间：2012-05-31T21:02:59.170
> 
> 标签：odbc

使用：c:\windows\sysWOW64\odbcad32.exe

PC 运行 Windows 7 64 位

我正在尝试使用 ODBC 驱动程序将数据连接到 MS Access（前端 GUI）的 SQL Server（后端数据），使用 ODBC 向导，但它一直失败。我刚刚安装了Window 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:23:35.470

[http://www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

这将安装 OLEDB 和 ODBC 的驱动程序。它只需要设置新的连接字符串到 .mdb 文件的路径。

# hibernate - JPA/Hibernate @ManyToMany 不在连接表上创建索引

> ID：10841228
> 
> 赞同：3
> 
> 时间：2012-05-31T21:03:01.000
> 
> 标签：hibernate, indexing, many-to-many, jpa-2.0, jointable

请考虑以下两个实体：

```
@Entity
@Table(name = "PROFILE")
public class Profile extends BaseEntity {

private Long id;
private Set<Tag> tags = new HashSet<Tag>();

    @ManyToMany(mappedBy = "taggedProfiles")
public Set<Tag> getTags() {
    return tags;
}

public void setTags(Set<Tag> tags) {
    this.tags = tags;
}
}

////////////////////////////////////////////////////////////////////////
@Entity
@Table(name = "TAG", uniqueConstraints = @UniqueConstraint(columnNames = {
    "TAG_ID", "USERS_ID" }))
public class Tag extends BaseEntity {
private Long id;

private List<Profile> taggedProfiles = new ArrayList<Profile>();

@ManyToMany
@JoinTable(
        name = "PROFILE_TAG", 
        joinColumns = @JoinColumn(name = "TAG_ID"), 
        inverseJoinColumns = @JoinColumn(name = "PROFILE_ID"), 
        uniqueConstraints = @UniqueConstraint(
                columnNames = {"PROFILE_ID", "TAG_ID" }))
// @ForeignKey(name = "FK__TAG__PROFILE", inverseName = "FK__PROFILE__TAG")
// @Index(name = "IDX__PROFILE__PROFILE_ID")
public List<Profile> getTaggedProfiles() {
    return taggedProfiles;
}

/**
 * @param taggedProfiles
 *            the taggedProfiles to set
 */
public void setTaggedProfiles(List<Profile> taggedProfiles) {
    this.taggedProfiles = taggedProfiles;
}
} 
```

连接表`PROFILE_TAG`创建得很好，但是没有创建索引，我希望 hibernate 会在连接表上创建一个复合索引。是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T09:12:01.073

将类型从 更改`List`为`Set`成功了：

改变：

```
private List<Profile> taggedProfiles = new ArrayList<Profile>(); 
```

至：

```
private Set<Profile> taggedProfiles = new HashSet<Profile>(); 
```

# cygwin - 让 lcov 在 Cygwin 上工作

> ID：10841230
> 
> 赞同：6
> 
> 时间：2012-05-31T21:03:16.127
> 
> 标签：cygwin, lcov

我需要安装哪些 Cygwin 软件包才能让 lcov 在 Cygwin 上运行？

我尝试运行 lcov 并收到以下信息：找不到命令

感谢您的任何帮助。

PS我应该指出gcov确实有效。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-17T16:08:56.133

Cygwin 不需要 lcov 的端口，因为它可以从源代码轻松构建。

lcov 是一组 perl 脚本，所以一旦你安装了 perl，你就可以下载源代码并直接构建 lcov。

下载[tarball](http://ltp.sourceforge.net/coverage/lcov.php)，解压到一个文件夹，然后：

```
make install 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T10:36:27.370

遗憾的是，Cygwin 没有 lcov 端口。要获得一个，您需要自己从源代码重建它。

如果你真的让它工作了，我敢肯定 Cygwin 社区的其他人会喜欢它。[在Package Contributor's Guide](http://cygwin.com/setup.html)上有关于提交 Cygwin 端口的说明。

# asp.net - 显示确认消息框和触发点击事件

> ID：10841232
> 
> 赞同：1
> 
> 时间：2012-05-31T21:03:33.780
> 
> 标签：asp.net

在 ASP.NET 中，当用户单击按钮时，我想显示一个确认消息框，下面的代码就是这样做的：

button.Attributes.Add("onclick", "return confirm('这将执行任务。你确定吗？');");

当用户在确认消息框上单击“确定”时，我想触发一个单击事件。我怎么做？click 事件方法附加到按钮的 Click 事件，但该方法不会触发。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:07:38.083

尝试像这样定义您的按钮：

```
<asp:Button id="btn_Submit" runat="Server" 
            OnClientClick="return confirm('This will perform the task. Are you sure?')"
            OnClick="btn_Submit_Click" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:08:29.213

也许你应该使用`jQuery`，做你想做的很简单。

```
 $('#buttonId').click(function (e){
    //do whatever you want
 }) 
```

# android - 将 Surface View 用于相机和其他用于叠加图像

> ID：10841235
> 
> 赞同：0
> 
> 时间：2012-05-31T21:03:48.970
> 
> 标签：android, android-layout

我是 android 编程新手.. 我这里有个问题。

我想做一个应用程序，在相机的顶部真实视图上绘制叠加层。我使用表面视图来保存来自相机的图像。

这是我的主要活动的 XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
        <SurfaceView
            android:id="@+id/preview"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
        />
        <com.openit.razer.overlayPreview
            android:id="@+id/overlayprev"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />
        <com.openit.razer.overlayImage
            android:id="@+id/overlayimg"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />
</RelativeLayout> 
```

这是我的主要活动课程：p

```
ublic void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.ar);

        overPrev = (overlayPreview)findViewById(R.id.overlayprev);
        overImg = (overlayImage)findViewById(R.id.overlayimg);

        overImg.setZOrderOnTop(true);
        overImg.getHolder().setFormat(PixelFormat.TRANSPARENT);

        preview=(SurfaceView)findViewById(R.id.preview);
        previewHolder=preview.getHolder();
        previewHolder.addCallback(surfaceCallback);
        previewHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
}
SurfaceHolder.Callback surfaceCallback=new SurfaceHolder.Callback() {
        public void surfaceCreated(SurfaceHolder holder) {
          try {
            camera.setPreviewDisplay(previewHolder);
          }
          catch (Throwable t) {
            Log.e("PreviewDemo-surfaceCallback",
                  "Exception in setPreviewDisplay()", t);
            Toast
              .makeText(ARrazerNav.this, t.getMessage(), Toast.LENGTH_LONG)
              .show();
          }
        }

        public void surfaceChanged(SurfaceHolder holder,
                                   int format, int width,
                                   int height) {

          Camera.Parameters parameters=camera.getParameters();
          //Camera.Size size=getBestPreviewSize(width, height,
                                             // parameters);
          List<Camera.Size> sizes = parameters.getSupportedPreviewSizes();
          Camera.Size selected = sizes.get(0);
          parameters.setPreviewSize(selected.width, selected.height);
          camera.setParameters(parameters);
          if(getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT){
              camera.setDisplayOrientation(90);
          }
          else{
              camera.setDisplayOrientation(0);
          }
          //camera.setDisplayOrientation(90);
          //camera.setDisplayOrientation(0);
          camera.startPreview();
        }

        public void surfaceDestroyed(SurfaceHolder holder) {
          // no-op
        }
      }; 
```

但我出错了

```
FATAL EXCEPTION:main
...
...
...
caused by: android.view.InflateException: Binary XML file line #10: Error inflating class blablabla 
```

你能帮我解决我的问题吗？这是我陷入这个问题的 3 天。

以及在其上使用 SurfaceView 和叠加图像实现相机的最佳方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:10:30.880

您应该使用 FrameLayout 将视图放置在其他视图之上。首先是 SurfaceView，然后是您想要的视图。

我实际上是自己做的，将图像放在相机预览上。我使用了一个 FrameLayout，上面有一个 SurfaceView 和一个 ImageView。工作得很好。

# image - 如何处理magento中的图像质量？

> ID：10841236
> 
> 赞同：1
> 
> 时间：2012-05-31T21:03:51.320
> 
> 标签：image, magento, image-processing, magento-1.6

我注意到在我的网站上，许多图像都被过度优化并且有伪影（边缘模糊）。他们看起来真的很糟糕。

所以我一直在研究 magento (1.6) 如何处理这些转换，但我不知道它是如何处理的。

所以你可以在这里看看以获得一个想法：[这里](http://dev.quantum-wireless.com/landairsea-2507-c-gps-charger.html)

这取决于您的显示器。我的好（坏），因为这些东西很明显。其他显示器更宽容。所以我想弄清楚如何在不牺牲大文件带宽的情况下获得更高质量的压缩比。

那可能吗 ？它托管在亚马逊网络服务上。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T22:34:31.840

一个被调用的方法`setQuality`已经实现，可以直接在模板中使用。

例如：

`echo $this->helper('catalog/image')->init($this->getProduct(), 'image', $_image->getFile())->resize(42, 50)->setQuality(95);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-15T13:50:28.977

我在 Google 周围[找到了这个教程。](http://tutorialmagento.com/set-quality-magento-product-images)从 Magento CE 1.4 开始实施名为 setQuality 的新方法，可以直接在模板文件中使用。比如你想提高分类视图中商品图片的质量，`app/design/frontend/yourpackage/yourtheme/template/catalog/product/list.phtml and add ->setQuality(100)`在img src末尾打开如下：

```
<img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(122,180)->setQuality(100); ?>" alt="" /> 
```

现在我们在产品列表中有高质量的图像。希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-29T11:28:00.957

magento 1.7 [http://www.magentopowered.com/increase-product-images-quality-on-magento/](http://www.magentopowered.com/increase-product-images-quality-on-magento/)检查这个。上传产品图片时，magento 会压缩图片。寻找：

```
$functionParameters = array();
$functionParameters[] = $this->_imageHandler;
$functionParameters[] = $fileName; 
```

添加以下行：

```
$functionParameters[] = 100; 
```

寻找：

```
if (!is_null($this->quality()) && $this->_fileType == IMAGETYPE_JPEG) 
```

评论：

```
// $functionParameters[] = $this->quality(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-29T12:25:32.360

您可以安装免费的 magento 扩展[Mediarocks_RetinaImages](http://www.magentocommerce.com/magento-connect/retina-product-images.html)并通过配置设置质量。如果不需要，则无需启用视网膜图像。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-06-11T17:12:31.690

后端有一个设置，在 System->Catalog->Image CDN 中，您可以在其中选择图像压缩率：从 1 到 9 ... 很简单，但必须找到！

# javascript - 仅对特定的 html 元素启用刷新

> ID：10841239
> 
> 赞同：20
> 
> 时间：2012-05-31T21:04:09.920
> 
> 标签：javascript, html, ajax

我想知道如何只刷新我网站中的特定元素，而不是整个网页？我正在谈论的元素是一个加载速度很慢并且可能会遇到连接超时的 Flash 应用程序。我想让用户只刷新那个元素/falsh 应用程序。我怎么做？下面我有一个更新 HTML 元素的 Ajax 函数，但不知道如何将它应用到我的情况。

```
<head>
    <script type="text/javascript">
        function loadXMLDoc() {
            var xmlhttp;
            if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else { // code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    document.getElementById("myDiv").innerHTML = xmlhttp.responseText;
                }
            }
            xmlhttp.open("GET", "ajax_info.txt", true);
            xmlhttp.send();
        }
    </script>
</head>
<body>
    <div id="myDiv">
        <h2>Let AJAX change this text</h2>
    </div>
    <button type="button" onclick="loadXMLDoc()">Change Content</button>
</body> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-06T12:37:58.760

尝试这个：

```
function reload(){
    var container = document.getElementById("yourDiv");
    var content = container.innerHTML;
    container.innerHTML= content; 

   //this line is to watch the result in console , you can remove it later	
    console.log("Refreshed"); 
}
```

```
<a href="javascript: reload()">Click to Reload</a>
    <div id="yourDiv">The content that you want to refresh/reload</div>
```

希望它有效。让我知道

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T01:02:42.433

尝试创建一个运行这个的 javascript 函数：

```
document.getElementById("youriframeid").contentWindow.location.reload(true); 
```

或者也许使用 HTML 解决方法：

```
<html>
<body>
<center>
      <a href="pagename.htm" target="middle">Refresh iframe</a>
      <p>
        <iframe src="pagename.htm" name="middle">
      </p>
</center>
</body>
</html> 
```

两者都可能是您正在寻找的...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-02T12:38:19.123

在你的脚本中试试这个：

```
$("#YourElement").html(htmlData); 
```

我在我的餐桌茶点中这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-15T12:55:27.930

尝试每次清空您的 innerHtml。像这样：

```
Element.innerHtml="";
```

# c++ - Boost - ASIO 与 IOStreams TCP

> ID：10841244
> 
> 赞同：2
> 
> 时间：2012-05-31T21:04:36.630
> 
> 标签：c++, boost, tcp, boost-asio, iostream

我是 Boost 的新手。我一直在为 sokcets/networking/TCP 东西寻找一个简单的跨平台解决方案，然后找到了 Boost。快速浏览一下，似乎有*两个*与 TCP 相关的类：一个在**Iostreams**中，一个在**Asio**中。
我（非常）确定如果我深入研究两个库的各自文档，我将能够弄清楚每个库的用途，但是有人可以简要解释一下区别是什么，或者每个库的用途是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T22:15:22.670

Boost.Iostreams 中有 TCP 流吗？

ASIO 是一个完整的全功能网络库，使用通用回调 API 支持异步 I/O。该类`ip::tcp::iostream`（作为 ASIO 的一部分）构建在 ASIO 之上，隐藏了手动创建和管理套接字并提供标准 iostream 接口的大部分复杂性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T22:42:45.730

我使用 Boost IOStreams 轻松创建与 std::stream 兼容的流对象。您可以使用它们来创建 TCP 流类，但您将完成所有工作以支持 TCP。IOStreams 只是提供了一个框架来创建流类。

我还使用 Boost Asio 创建了一个独立的 TCP 服务器。过去使用 Windows 套接字来做同样的事情，我可以告诉你，Asio 使编写 TCP 服务器（和客户端）变得非常容易。我认为 Asio 是你想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-03T05:29:21.850

正如其他人所说，[Boost.Asio](http://www.boost.org/libs/asio)可能是您想要的。它是系统特定网络内容的优雅且跨平台的包装器。它提供了诸如套接字、IP 地址、计时器等构建块。

但它也为简单的网络交互提供了高级[iostream 接口](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/reference/ip__tcp/iostream.html)。这是一个[简单的例子](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/example/iostreams/daytime_client.cpp)：

```
#include <iostream>
#include <string>
#include <boost/asio.hpp>

using boost::asio::ip::tcp;

int main(int argc, char* argv[])
{
  try
  {
    if (argc != 2)
    {
      std::cerr << "Usage: daytime_client <host>" << std::endl;
      return 1;
    }

    tcp::iostream s(argv[1], "daytime");
    if (!s)
    {
      std::cout << "Unable to connect: " << s.error().message() << std::endl;
      return 1;
    }

    std::string line;
    std::getline(s, line);
    std::cout << line << std::endl;
  }
  catch (std::exception& e)
  {
    std::cout << "Exception: " << e.what() << std::endl;
  }

  return 0;
} 
```

# knockout-2.0 - Knockout.js 从 json 对象中获取元素并提取到数组中

> ID：10841263
> 
> 赞同：0
> 
> 时间：2012-05-31T21:05:59.503
> 
> 标签：knockout-2.0

我有以下行：

```
 $.getJSON('@Url.Action("RegistrationShareClassReport", new { id = ViewBag.Id })', function (data) {
        viewModel.RegistrationShareClassReport(data);
    }); 
```

这基本上以 json 格式返回具有不同元素的数据。例如

```
id = "2",
name = "tj",
country = "GB"

id = "3",
name = "pj",
country = "IT" 
```

我想要的是从该视图模型中为每个项目填充所有国家/地区的数组。所以我需要遍历viewmodel数据并从每个国家中提取国家。

我想知道我可以在 knockout.js 中实现这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:13:30.867

您可以使用 Knockout 映射插件 (http://knockoutjs.com/documentation/plugins-mapping.html) 将您的 json 映射到您的视图模型。

这里有一些代码可以帮助您入门。根据自己的需要进行调整：

```
<script type="text/javascript">
    $.getJSON("/data.json", function (data) {

        var viewModel = {};

        var mapping = {
            "countries": {
                key: function (data) {
                    return ko.utils.unwrapObservable(data.name);
                }
            }
        };

        viewModel = ko.mapping.fromJS(data, mapping);

        ko.applyBindings(viewModel);
    });
</script> 
```

然后在 HTML 中：

```
<ul data-bind="foreach: $root">
    <li data-bind="text: name"></li>
</ul> 
```

# php - Zend Framework 数据层架构

> ID：10841265
> 
> 赞同：2
> 
> 时间：2012-05-31T21:06:02.583
> 
> 标签：php, zend-framework, datamapper

我正在遵循 Zend QuickStart 指南，并且对连接到数据库的体系结构感到有些困惑。我看到 4 层：

```
ModelClass
ModelClass_Mapper
ModelClass_DbTable
Actual MySQL Database 
```

我之前使用过一种架构，其中有一个文件具有直接映射到数据库的属性，以及一个扩展类，其中包含挂钩和数据库操作事件的所有自定义代码。

我在哪里可以找到一个很好的解释，说明为什么需要这样的三个文件，而不是仅仅让 ModelClass 继承 DbTable？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T10:39:16.413

ZF 快速入门提供了一个似乎与 ZF 1.x 配合得很好的数据映射器模式示例。使用 Zend_Db 不需要您实现 Data Mapper。只需使用 DbTable 模型和 Zend_Db_Table_Abstract 提供的方法，您就可以获得相当好的功能。

稍微解释一下：

Application_Model_Guestbook：将是一个简单的域模型（您与之交互的对象）。

Application_Model_GuestbookMapper：将是数据映射器，用于将数据库列映射到域模型的属性。

Application_Model_DbTable_Guestbook：是提供数据库和数据库适配器之间连接的网关模型。您可以在此处指定数据库表的选项以及与其他表的关系。

在弄清楚数据映射器如何应用于我的应用程序之前，我对 ZF 和 Models 有了一点经验。当我开始构建依赖于一个以上数据库表的对象时，我才真正开始了解这些部分是如何组合在一起的。
'

您会注意到，许多经验丰富的 ZF 开发人员立即推荐 Doctrine 或其他一些 ORM，对他们来说这可能是正确的选择（对于某些人来说似乎是反射性的）。我只是觉得在我至少了解 ORM 的基本功能之前，我不应该开始使用 ORM。

**[编辑]**

基映射器类中的 fetchAll() 等效方法，将 Zend_Db_Table_Abstract 的实例传递给 __constructor

```
public function findAll($order = NULL) {
        $select = $this->_getGateway()->select();
        if (!is_null($order)) {
            $select->order($order);
        }
        $rowset = $this->_getGateway()->fetchAll($select);
        $entities = array();
        foreach ($rowset as $row) {
            //abstract method required in each table mapper, this instantiates the domain model
            $entity = $this->createEntity($row);
            //identiy map allows lazy loading of certain members
            $this->_setMap($row->id, $entity);
            $entities[] = $entity;
        }
        //returns an array of domain models instead
        return $entities;
    } 
```

我的表特定映射器的 createEntity() 方法

```
public function createEntity($row) {

        $data = array(
            'id'     => $row->id,
            'name'   => $row->name,
            'art'    => $row->art,
            'year'   => $row->year,                
        );

        $entity = new Music_Model_Album($data);
        //set artist id to reference map for lazy loading
        $entity->setReferenceId('artist', $row->artist_id);
        return $entity;
    } 
```

祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T08:09:40.160

这里给出了一个**很好的解释：** [http ://martinfowler.com/eaaCatalog/dataMapper.html](http://martinfowler.com/eaaCatalog/dataMapper.html)

一个简短的报价：

> 数据映射器是将内存中的对象与数据库分开的软件层。它的职责是在两者之间传输数据，并将它们彼此隔离。使用 Data Mapper，内存中的对象甚至不需要知道是否存在数据库；他们不需要 SQL 接口代码，当然也不需要数据库模式的知识。（数据库模式总是不知道使用它的对象。）由于它是 Mapper (473) 的一种形式，因此 Data Mapper 本身对于领域层来说甚至是未知的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:17:33.110

就个人而言，虽然我喜欢 Zend 框架，但我发现数据层库相当糟糕。我现在使用的是[Doctrine](http://www.doctrine-project.org/)结合[Bisna](https://github.com/guilhermeblanco/ZendFramework1-Doctrine2)来整合两者。也许你也应该看看那些？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T22:28:10.077

Zend_Db_Table 解决方案是 » 表数据网关模式的实现。该解决方案还包括一个实现 » 行数据网关模式的类。

您可以在[Table Data Gateway](http://www.martinfowler.com/eaaCatalog/tableDataGateway.html)和[Row Data Gateway中查看谁的模式](http://www.martinfowler.com/eaaCatalog/rowDataGateway.html)

# ruby-on-rails-3 - 使用 rails+nokogiri 为引导程序格式化表单字段

> ID：10841267
> 
> 赞同：1
> 
> 时间：2012-05-31T21:06:26.863
> 
> 标签：ruby-on-rails-3, validation, xpath, twitter-bootstrap, nokogiri

我在使用 Twitter 引导程序的 rails 应用程序中的初始化程序中有以下内容，以便它删除`div.field_with_errors`当字段验证失败时应用的 rails 并且初始化程序在错误的输入字段后添加帮助/验证文本：

```
require 'nokogiri'
ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
  html = %(<div class="field_with_errors">#{html_tag}</div>).html_safe

  form_fields = [
    'textarea',
    'input',
    'select'
  ]

  elements = Nokogiri::HTML::DocumentFragment.parse(html_tag).css("label, " + form_fields.join(', '))

  elements.each do |e|
    if e.node_name.eql? 'label'
      html = %(#{e}).html_safe
    elsif form_fields.include? e.node_name
      if instance.error_message.kind_of?(Array)
        html = %(#{e}<span class="help-inline">&nbsp;#{instance.error_message.join(',')}</span>).html_safe
      else
        html = %(#{e}<span class="help-inline">&nbsp;#{instance.error_message}</span>).html_safe
      end
    end
  end
  html
end 
```

这工作正常，但我还需要将`.error`类应用于每个错误的周围`div.control-group`。

我的初始化程序当前提供以下输出：

```
<div class="control-group">
    <label class="control-label" for="post_message">Message</label>
    <div class="controls">
        <input id="post_message" name="post[message]" required="required" size="30" type="text" value="" /><span class="help-inline">&nbsp;can't be blank</span>
    </div>
</div> 
```

但我需要在我的初始化程序中添加一些东西，以便它将`.error`类添加到这样的类中`div.control-group`：

```
<div class="control-group error">
    <label class="control-label" for="post_message">Message</label>
    <div class="controls">
        <input id="post_message" name="post[message]" required="required" size="30" type="text" value="" /><span class="help-inline">&nbsp;can't be blank</span>
    </div>
</div> 
```

解决方案可能需要考虑这样一个事实，即每个验证错误可能有多个标签和输入，它们都在同一个范围内`div.control-group`（例如，单选按钮/复选框/2 个并排的文本字段）。

我认为它需要某种方式`e.at_xpath()`来找到`div.control-group`父级并将`.error`类添加到其中，但我不确定如何执行此操作。

任何人都可以帮忙吗？

PS这可能都可以使用formtastic或simple_form gems，但如果可能的话，我宁愿只使用我自己的html。

* * *

编辑

如果我放入`e['class'] = 'foo'`该`if e.node_name.eql? 'label'`部分，那么它将类应用于标签，所以我想我只需要找到它的父标签，`e`然后将一个`.error`类应用到它，但我无法弄清楚 xpath 从标签到它的`div.control-group`父母；没有点、斜线或任何似乎有效的组合，但 xpath 不是我的强项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T10:37:23.767

If you don't need to display the error messages next to the erroneous field then you can simply add the following to `assets/stylesheets/application.css.scss`:

```
.field_with_errors {
  @extend .control-group.error;
  display: inline;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T12:54:25.373

不是最好的解决方案，而是一个有效的解决方法，因为我比 rails 更像 html/js 人

-> 使用 jQuery 选择器和 addClass [http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/) http://api.jquery.com/addClass/

```
$("div.control-group:contains('can\\'t be blank')").addClass("error"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T10:03:22.793

我现在已经做到了。

根据这个 SO 答案，这是不可能的：[Rails - ActionView::Base.field_error_proc move up the DOM tree?](https://stackoverflow.com/questions/7341545/rails-actionviewbase-field-error-proc-moving-up-the-dom-tree)

所以，这就是我所做的：

1.  从标签和输入中删除默认的 rails 错误处理
2.  用 span.field_with_errors 包裹每个错误的标签和表单字段
3.  .field_with_errors 然后使用 SASS 扩展 .control-group.error css

`config/initializers/bootstrap.rb`

```
require 'nokogiri'

ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
  html = %(<div class="field_with_errors">#{html_tag}</div>).html_safe

  form_fields = [
    'textarea',
    'input',
    'select'
  ]

  elements = Nokogiri::HTML::DocumentFragment.parse(html_tag).css("label, " + form_fields.join(', '))

  elements.each do |e|
    if e.node_name.eql? 'label'
      # wrap erroneous label
      html = %(<span class='field_with_errors'>#{e}</span>).html_safe
    elsif form_fields.include? e.node_name
      # wrap erroneous field
      if instance.error_message.kind_of?(Array)
        html = %(<span class='field_with_errors'>#{e}<span class="help-inline">&nbsp;#{instance.error_message.join(',')}</span></span>).html_safe
      else
        html = %(<span class='field_with_errors'>#{e}<span class="help-inline">&nbsp;#{instance.error_message}</span></span>).html_safe
      end
    end
  end
  html
end 
```

`assets/stylesheets/application.css.scss`

```
.field_with_errors {
  @extend .control-group.error;
} 
```

希望对其他人有所帮助。

# javascript - 是否可以在 Backbone.js 中的 Collection 中懒惰地获取模型，同时有时会获取（并释放）整个集合？

> ID：10841268
> 
> 赞同：1
> 
> 时间：2012-05-31T21:06:33.620
> 
> 标签：javascript, ajax, collections, backbone.js

这是我的场景：

我正在使用 Backbone.js。

我有几个大型数据集合，我不想一直保存在内存中。因此，涉及始终将我所有集合中的所有模型保存在内存中的解决方案并不好。

我需要能够显示和/或编辑从这些集合中选择的任意记录，并且我需要同一模型的多个视图来指向同一记录（因此它们将保持同步）。因此，最好从主集合中提取这些模型，而不是 Model.fetches。

**现在，通过将 ajax数据**设置与**{add: true}**选项结合使用，我似乎可以根据需要使用 Collection.fetch 来提取这些记录。如果它能完成工作，那将使我达到我想要的一半。

麻烦的是，在任何给定的时间点，我可能需要为这些集合之一拉出一个选择器列表视图，并临时显示该特定集合的*所有*记录（或者，如果它*真的*是一个分页列表，大的）。当我需要全部展示它们时，我可以获取整个集合（或集合的一页）——太好了。但是，当我完成了选择器视图时，我需要清除那些额外的记录。我如何擦洗它们，而不会丢失我之前获取的个人记录模型？

到目前为止，我梦想的最佳解决方案是保留一组我的临时记录，并将其传递给集合，当我调用 reset 来清理它时。这还需要我在这些模型上保留某种引用计数，所以我知道何时将它们从集合中删除。对我来说，这似乎是很多簿记工作。有没有更清洁的方法来处理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T08:29:42.140

看完你的最后一条评论，我想我理解你了。所以，试图重写你的问题，你所拥有的是：

*   模型实例化并分配给*局部变量*
*   一个*集合*，其中包含您已经分配给局部变量的模型以及其他模型

但是*局部变量*和*集合中的相同模型* **是不同的实例**，因此一个引用的更改不会影响另一个引用。这就是您要解决的问题。

所以，我们要尝试的是，局部变量中的*引用和Collection中的引用必须是同一个引用。*

一种方法可以是集合中的`initialize()`可以检查其所有模型并将最近获取的模型替换为已经实例化的模型，如果`id`匹配，并且如果不存在。

为此，我们有一些方法需要*已经缓存的模型*列表。但是这个*已经缓存的模型*都是一个局部变量到不同的视图或其他任何东西中，所以我们需要一个独特的地方，我们可以在一个镜头中获得完整的列表。这个独特的地方可以是一个名为的集合`CachedModels`。

在 中，`Model.initialize()`我们可以添加一行，将当前模型添加到 this`CachedModels`中。我们还必须注意保持这个`CachedModels`集合清理或删除模型。

这不是一个非常优化，也不是很容易的方法，但我希望它能以任何方式激励你。

# iphone - 使用 CGPoints 在 UIImageView 中画线

> ID：10841269
> 
> 赞同：2
> 
> 时间：2012-05-31T21:06:34.270
> 
> 标签：iphone, objective-c, ios, cocoa, cgcontext

我有一个 imageView，我想使用 CGPoints 在该 imageView 中的图像上画线，但我遇到错误，例如：无效的上下文等。任何没有 CGContext 方法的画线的解决方案。

```
CGContextRef cntxt = UIGraphicsGetCurrentContext();
CGContextMoveToPoint(cntxt, p1.x, p1.y);
CGContextAddLineToPoint(cntxt, p2.x, p2.y);
CGContextStrokePath(cntxt); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:09:54.500

您可能正试图在`drawRect:`. 如果检查的值`cntxt`，很有可能`NULL`。绘制上下文在调用之前创建，`drawRect:`之后被销毁。此函数之外通常没有“当前上下文”。

您需要在数据结构中跟踪您的点。`drawRect:`然后，您将根据该数据进行所需的任何绘图。

# http-headers - 使用 Jetty 和 Apache CXF 时如何消除重复的 Date 标头？

> ID：10841271
> 
> 赞同：2
> 
> 时间：2012-05-31T21:06:37.530
> 
> 标签：http-headers, jetty, cxf, embedded-jetty

我正在开发一个作为嵌入式 Jetty 服务器运行的遗留应用程序。调用的第一个代码是：

```
Server server = new Server();
server.setSendDateHeader(true); 
```

接下来创建一些上下文以在 /、/app 和 /api 处绑定特定的 servlet。

绑定到 /api 的 Servlet 扩展了 AbstractCXFServlet 并用于返回对 RESTful API 的响应。但是，我发现对 /api 的调用在响应中有重复的 Date: 标头。其他端点的 servlet 不基于 CXF。[Date: 标头是必需](http://pretty-rfc.herokuapp.com/RFC2616#header.date)的 ，因此删除`server.setSendDateHeader(true)`或将其设置为 false 将不起作用，因为对 / 和 /app 的所有请求都会丢失它。

有没有办法将 Jetty 配置为仅在处理结束时不存在 Date 标头时添加它，或者有没有办法禁用 CXF 插入 Date: 标头？

我正在使用 Jetty v6.1.19 和 CXF v2.3.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:53:59.487

似乎 CXF 必须使用 addHeader 而不是 setHeader 来替换 Jetty 已经插入的值。

最后，我不得不编写一个 ServletFilter 和 ResponseWrapper，它们只在 /api 上下文中使用。[该线程](http://www.apacheserver.net/Duplicate-Headers-at1321236.htm)最终使我沿着这条路线前进。

**DateHeaderStrippingFilter.java**

```
public class DateHeaderStrippingFilter
    implements Filter
{
    private HashSet<String> headers;

    @Override
    public void destroy()
    {
        headers = null;
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
        throws IOException, ServletException
    {
        HeaderStripperWrapper wrappedResponse = new HeaderStripperWrapper((HttpServletResponse)response, headers);   
        chain.doFilter(request, wrappedResponse);
    }

    @Override
    public void init(FilterConfig config)
        throws ServletException
    {
        headers = new HashSet<String>();
        headers.add("Date");
    }
} 
```

**HeaderStripperWrapper.java**

```
public class HeaderStripperWrapper
    extends HttpServletResponseWrapper
{
    private HashSet<String> headersToStrip;

    public HeaderStripperWrapper(HttpServletResponse response, HashSet<String> headersToStrip)
    {
        super(response);
        this.headersToStrip = headersToStrip;
    }

    @Override  
    public void addHeader(String name, String value)  
    {  
        if (!headersToStrip.contains(name))
        {
            super.addHeader(name, value);
        }
    }  

    @Override  
    public void setHeader(String name, String value)  
    {  
        if (!headersToStrip.contains(name))
        {
            super.setHeader(name, value);
        }
    }
} 
```

然后在配置嵌入式码头服务器时

```
Context api = new Context(contexts, "/api", false, false);
BooksApiServlet apiServlet = env.getInjector().getInstance(ApiServlet.class);   
ServletHolder holder = new ServletHolder(apiServlet);
api.addServlet(holder, "/*");
api.addFilter(DateHeaderStrippingFilter.class, "/*", 0); 
```

# loops - 如何将此递归函数展开为循环？

> ID：10841275
> 
> 赞同：0
> 
> 时间：2012-05-31T21:06:41.717
> 
> 标签：loops, recursion, directcompute

我正在 DirectCompute 中为教育编写一个简单的扩散路径跟踪器。DirectCompute不允许递归函数，所以我需要弄清楚如何将这个递归语句变成一个循环：

```
intersectCode() {

    // ... intersection code 

    if(hit an object)
        return objectHit.diffuse * (intersectCode() + objectHit.emittance);
} 
```

通用伪代码或 C 示例将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:17:36.883

```
object = initialObject;
objectStack = new ObjectStack();
do {
    objectStack.push(object);
    // get new intersected object as object

} while (object);

result = 0;
while (object = objectStack.pop()) {
    result = object.diffuse * (result + object.emittance);
}

return result; 
```

您可能想要调整它，因为所有细节都不知道 - 例如，也许 initObject 不必在堆栈中？

# jquery - JQuery 通过背景颜色查找元素

> ID：10841277
> 
> 赞同：5
> 
> 时间：2012-05-31T21:06:47.683
> 
> 标签：jquery

尝试使用 JQuery 访问 GridView 的 Selected 行，以查找背景颜色属性设置为 SelectedRowStyle 背景颜色的行。那个颜色是#FF6600。我试过了

```
var row = $("tr").find().css("background-color", "#FF6600"); 
```

但这只是将所有行设置为橙色。

```
var row = $("tr[background-color=#FF6600"); 
```

返回空

```
var row = $("tr").find().attr("background-color"); 
```

返回未定义

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T21:09:49.493

试试[`.filter`](http://api.jquery.com/filter/)方法。

```
var rows = $('tr').filter(function(){
    var color = $(this).css("background-color");
    return color === "#FF6600" || color === "rgb(255, 102, 0)" ;
}); 
```

我还没有测试过，可能需要调整 rgb 部分以考虑间距。

编辑：

或者更好的是，这考虑到了大写与小写

```
var rows = $('tr').filter(function(){
    var color = $(this).css("background-color").toLowerCase();
    return color === "#ff6600" || color === "rgb(255, 102, 0)" ;
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T21:09:41.663

`background-color`不是属性，它是 CSS 属性。您可以尝试使用`.filter`来执行此操作：

```
var row = $("tr").filter(function(){
    // Chrome returns "rgb(255, 102, 0)" instead of "#FF6600"
    return $(this).css('background-color') === "rgb(255, 102, 0)";
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:10:14.470

```
$('tr').each(function(){
    if($(this).css('background-color') == '#ff6600'){
         //do your stuff
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-01T17:07:29.033

我在我的代码中使用这个伪 jQuery 选择器，在实用程序文件中定义：

```
(function() {
  function rgb2hex(rgb) {
    return '#' + rgb.match(/^rgb\(([^\)]+)\)$/)[1].split(/\s*,\s*/)
      .filter(Boolean).map(function(n) {
         return ('00' + parseInt(n, 10).toString(16)).slice(-2);
      }).join('');
  }
  $.extend($.expr[':'], {
  // pesudo selector that allow to use :css(color: red)
    css: function(element, index, meta) {
      element = $(element);
      var rules = meta[3].split(';').filter(Boolean);
      return rules.filter(function(pair) {
        pair = pair.split(/\s*:\s*/);
        var css = element.css(pair[0]);
        if (css.match(/rgb\(/)) {
          css = rgb2hex(css);
        }
        return css === pair[1];
      }).length === rules.length;
    }
  });
})();
$(function() {
  $('li:css(color: #ff0000)').css('background', 'black');
});
```

```
.red { color: red; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<ul>
<li class="red">1</li>
<li style="color: red">2</li>
<li style="color: blue">3</li>
<li>4</li>
</ul>
```

如果您需要选择元素`li:css(color: red)`来选择红色节点，在 Chrome 中，值 red 被转换为`rgb(255, 0, 0)`，因此您需要将 red 转换为相同的值，为此您可以创建插入到 body 的虚拟元素（它可以有`visibility: hidden`）

```
var tmp = $('<span/>').css('visibility', 'hidden').appendTo('body'); 
```

元素可以插入一次，并使用：

```
tmp.css(pair[0], pair[1]);
//or
tmp.css.apply(tmp, pair);
// and
return tmp.css(pair[0]) == element.css(pair[0]); 
```

```
(function() {
  var tmp = $('<span/>').css('visibility', 'hidden').appendTo('body');
  $.extend($.expr[':'], {
  // pesudo selector that allow to use :css(color: red)
    css: function(element, index, meta) {
      element = $(element);
      var rules = meta[3].split(';').filter(Boolean);
      return rules.filter(function(pair) {
        pair = pair.split(/\s*:\s*/);
        tmp.css.apply(tmp, pair);
        return tmp.css(pair[0]) == element.css(pair[0]);
      }).length === rules.length;
    }
  });
})();
$(function() {
  $('li:css(color: red)').css('background', 'black');
});
```

```
.red { color: red; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<ul>
<li class="red">1</li>
<li style="color: red">2</li>
<li style="color: blue">3</li>
<li>4</li>
</ul>
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-09T15:45:51.197

试试这个

```
$('tr').toArray().filter(f => f.style.backgroundColor == '#FF6600') 
```

# matlab - 在 MatLab 中制作电影

> ID：10841286
> 
> 赞同：2
> 
> 时间：2012-05-31T21:07:43.363
> 
> 标签：matlab, animation, geometry

我正在尝试使用该`movie`命令在 MatLab 中创建一个简短的动画。动画应该画一个圆圈。但是，当我运行以下脚本时，“o”符号只是在图形窗口周围随机跳跃，而不会留下任何痕迹。

```
z = linspace(0,2*pi,100);
nframes = length(z);
Frames = moviein(nframes);
for i = 1:nframes
    x = cos(i);
    y = sin(i);
    plot(x,y,'o','erase','none');
    Frames(:,i) = getframe;
    pause(0.25);
end
movie(Frames,1) 
```

如果有人可以向我解释为什么脚本无法正常工作，我将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T21:43:53.673

这画了一个圆圈。希望能帮助到你。

```
z = linspace(0,2*pi,100);
nframes = length(z);
Frames = moviein(nframes);
for i = 1:nframes
    x = cos(2*pi*i/nframes);
    y = sin(2*pi*i/nframes);
    plot(x,y,'o');
    hold on
    Frames(:,i) = getframe;
    pause(0.01);
end
movie(Frames,1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:12:09.970

您可能想要遍历`z`向量。尝试更改`x = cos(i)`为`x = cos(z(i))`和相同`y = sin(i)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T07:43:22.347

很晚了，但我希望它可能对那里的人有所帮助......我正在研究如何为圆圈上的点设置动画，虽然我还没有弄清楚，但我注意到了一些东西上面建议的代码可能会使您的圈子看起来更“圆形”。设置后

```
hold on 
```

如果您添加另一行只是说

```
axis('equal'); 
```

您将获得与绘图一起缩放的轴，因此您的圆圈不会因图形窗口尺寸而损坏。

# ruby-on-rails-3 - 设计 > CanCan > Rolify 错误分配的角色

> ID：10841288
> 
> 赞同：1
> 
> 时间：2012-05-31T21:07:46.670
> 
> 标签：ruby-on-rails-3, devise, cancan

好的，我已经按照 github 上的 railsapps 模板说明，在 CanCan 上盲目地复制了 ryanb 的 railscast（为我的 Event 模型替换了 Comment 变量）。我已经建立了一个新用户，并为其分配了“发起人”角色，并赋予了管理员角色的一部分能力。当我在 Rails 中加载它时，我得到

> 未定义的方法“角色？” 对于用户：0x08 ...

好的，我正在控制台中向后工作，以重新分配新用户到“赞助商”角色并查看是否有问题。如果你在最后往下看，我看到一些东西似乎坏了，但不确定如何修复它。这是我的能力.rb

```
class Ability
 include CanCan::Ability

 def initialize(user)
   user ||= Us  # guest user (not logged in)
   if user.has_role? :admin
     can :manage, :all
   else
     can :read, :all
   end

   if user.role? :sponsor
     can :create, Event
     can :read, Event
     can :update, Event do |event|
       event.try(:user) == user
     end
   else
     can :read, :all
   end

 end
end 
```

我的事件.rb：

```
resourcify
  belongs_to :school 
```

一所学校`has_many events`，`has_and_belongs_to_many_users`和`belongs_to :event`。在控制台中，我使用正确的名称、school_id、电子邮件等创建了一个 new_user。这按预期工作。我然后：

```
user.add_role "sponsor" 
```

这很有效，因为我可以看到用户 ID 与赞助商的角色 ID 对齐。下一步是我认为我的问题开始的地方。

```
ability = Ability.new(new_user) 
```

这会产生以下结果：

> SELECT COUNT(*) FROM "roles" INNER JOIN "users_roles" ON "roles"."id" = "users_roles"."role_id" WHERE "users_roles"."user_id" = 5 AND (((name = 'admin') AND（资源类型为空）

user_id 是正确的，但“名称”不是“管理员”。我认为它应该拉“赞助商”的名字？

这可能是一个简单的问题，但我猜这个错误分配可能是我问题的根源，为什么上面指出了 events#index 错误。似乎假设 Ability.new 被困在“管理员”上。我在看什么，thanx，山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T07:53:38.403

您正在使用错误的代码查询用户的角色。

```
user.role? :sponsor # wrong 
```

使用 rolify 你需要这样的东西

```
user.has_role? :sponsor
user.has_role? :sponsor, School
user.has_role? :sponsor, School.first 
```

尝试在没有cancan的控制台中使用简单的 rolify 命令

```
user.add_role :sponsor
user.has_role? :sponsor 
```

这是很正常的，Ability.new 会产生一个具有管理员角色的选择查询，就像您拥有的一样

```
if user.has_role? :admin 
```

在您的能力初始化程序中

# c++ - Qt Creator 中的 Boost::Regex

> ID：10841292
> 
> 赞同：0
> 
> 时间：2012-05-31T21:07:55.447
> 
> 标签：c++, boost, qt4, qt-creator, boost-regex

我对库有点陌生，并且使用 Visual Studios 以外的任何东西来编写 C++。我希望在安装 Boost 1_49_0 以在我的 Windows 7 计算机上与 Qt Creator 4.8.1 一起使用时获得帮助。

编辑：我需要关于如何在 Qt Creator 中添加库的具体说明。当我尝试添加库并转到永恒库时，为什么只显示带有 .lib 扩展名的库而不显示带有 .a 扩展名的库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:47:57.867

看不出有什么问题。只需下载 boost 开发库，将包含路径添加到您的 Qt 项目，告诉链接器使用哪些库，您就完成了。

查看从 Qt 文档[向项目添加库。](http://doc.qt.nokia.com/qtcreator-2.3/creator-project-qmake-libraries.html)

# c++ - Netbeans c/c++ 编译器数组从 1 而不是 0 开始

> ID：10841295
> 
> 赞同：0
> 
> 时间：2012-05-31T21:08:18.287
> 
> 标签：c++, arrays, netbeans

这是解释问题的简化代码：

```
int *nums[10];

*nums[0] = 5;

cout << *nums[0] << endl; 
```

代码已编译，但执行时失败。所以我尝试了这个：

```
int *nums[10];

*nums[1] = 5;

cout << *nums[1] << endl; 
```

它打印得很好。我发现数组是从 *nums[1] 到 *nums[10] 而不是通常的 *nums[0] 到 *nums[10]。我已经检查过使用 Netbeans C/C++ 编译器的其他人，他们的工作正常。我认为这是特定编译器中的某些偏好更改。如何更改它以使其按应有的方式工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:13:01.970

数组**是从**0 开始的。您遇到了未定义的行为。

```
int *nums[10]; 
```

创建一个包含 10 个未初始化指针的数组`int`。

```
*nums[0] = 5; 
```

取消引用未初始化的指针。任何事情都有可能发生。要使其按预期运行，请在访问指针之前分配内存：

```
for ( int i = 0 ; i < 10 ; i++ )
   nums[i] = new int; 
```

并在最后删除：

```
for ( int i = 0 ; i < 10 ; i++ )
   delete nums[i]; 
```

例如，我在 MSVS 中收到警告：

> 警告 C4700：使用了未初始化的局部变量“nums”

还有一个崩溃:)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-31T21:13:58.377

在 C/C++ 中，数组总是从 0 开始索引的。

我假设您要创建一个整数数组。如果要创建指向整数的指针数组，请查看 Luchian 的答案。

您声明了一个包含 10 个指向整数值的指针的数组。您没有为实际值分配内存。这就是为什么你得到一个错误。

您需要为整数分配内存。为此，您有两种方法：

```
int nums[10];
nums[0] = 5;
cout << nums[0] << endl; 
```

或者

```
int* nums = new int[10];
nums[0] = 5;
cout << nums[0] << endl;
delete[] nums; // don't forget to delete 
```

# ruby - 为什么 assert last_response.body.include?('[String]') 会误报？

> ID：10841302
> 
> 赞同：1
> 
> 时间：2012-05-31T21:08:38.417
> 
> 标签：ruby, unit-testing, rack

在 Sinatra 中使用`Rack`and进行单元测试时`Test::Unit`，`last_response.body.include?`使用不存在的测试字符串给了我一个误报。

为什么不在响应正文中`assert last_response.body.include?('string')`时会给出误报？`'string'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:08:38.557

您需要使用以下方法检查页面是否正确加载：

```
assert last_response.ok? 
```

# ruby-on-rails - REXML::ParseException 没有有效的根

> ID：10841305
> 
> 赞同：2
> 
> 时间：2012-05-31T21:08:51.257
> 
> 标签：ruby-on-rails, ajax, json, post, rexml

尝试发出 json 发布请求时出现以下错误：

```
REXML::ParseException (The document "{\"user\":1,\"email\":\"some@email.com\"}:" does not have a valid root): 
```

不知道从哪里开始。

我的标题如下所示：

```
Accept:application/json, text/javascript, */*; q=0.01
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Content-Length:38
Content-Type:application/x-www-form-urlencoded
Cookie:_washapp_session=SOME_COOKIE_STRING
Host:myapp.herokuapp.com
Origin:http://myapp.herokuapp.com
Referer:http://myapp.herokuapp.com/user/1/add_friends
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.52 Safari/536.5
X-CSRF-Token:k5bxjBJ3SCMhe1ILfChoiy6qwkYfVsg0JYZV9KDnwIg=
X-Requested-With:XMLHttpRequest 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T21:08:12.870

**内容类型**应该是`application/json`. **Accept**仅指定您希望如何返回信息， **Content-Type**描述您发送的内容。

[您可以使用$.post](http://api.jquery.com/jQuery.post/)指定数据类型：

```
$.post("http://myapp.herokuapp.com/user/1/add_friends", 
    {user:1, email:"some@email.com"},
    function(data){
        processResponse(data);
    }, 
    "json"); 
```

# mingw - 使用大型预编译头文件时 cc1plus.exe 崩溃

> ID：10841306
> 
> 赞同：13
> 
> 时间：2012-05-31T21:08:58.370
> 
> 标签：mingw, precompiled-headers, stack-size

我在使用 MinGW 的预编译头文件时遇到问题。编译器似乎找到了预编译的头文件，但 cc1plus.exe 在之后立即崩溃（cc1plus.exe 已停止工作）。

我知道这可能与 cc1plus.exe 的低堆栈大小有关，所以我做了以下操作来增加它：

```
editbin cc1plus.exe /STACK 33554432 
```

我也试过无济于事：

```
editbin cc1plus.exe /STACK 32768k 
```

然而，这并没有解决它，因为每当我尝试编译我的应用程序时它仍然会崩溃。

顺便说一句，如果重要的话，我正在使用最新的 MinGw (gcc v 4.6.2) 和最新的 Eclipse CDT。

我是否正确增加了 cc1plus.exe 的堆栈大小？有没有人知道如何继续，因为我阅读了无数的文章和主题，但我目前有点没有想法。

g++ 似乎找到并接受了我的预编译头文件：

```
Building file: ../src/AdvancedOgreFramework.cpp
Invoking: GCC C++ Compiler
g++ -DHAVE_W32API_H -DNO_GCC_PRAGMA -I"C:\DevelopmentTools\workspaces\workspace_cpp
\MyGame\inc" -I"C:\docs\ogre3d\CEGUI\CEGUI-0.7.6\cegui\include\falagard" -I"C:\docs 
\ogre3d\CEGUI\CEGUI-0.7.6\cegui\include\RendererModules\Ogre" -I"C:\docs\ogre3d\CEGUI
\CEGUI-0.7.6\cegui\include" -I"C:\docs\ogre3d\ogre1.8.0_mingw_sdk\OgreSDK_MinGW_v1-8-0
\include" -O0 -g3 -H -Wall -c -Winvalid-pch -MMD -MP -MF"src/AdvancedOgreFramework.d" 
-MT"src/AdvancedOgreFramework.d" -o "src/AdvancedOgreFramework.o" "../src 
/AdvancedOgreFramework.cpp"
! C:\DevelopmentTools\workspaces\workspace_cpp\MyGame\inc/Precompiled.h.gch 
```

这是我作为预构建 make 运行以生成我的 .gch 的 makefile：

```
C_FLAGS = -O0 -g3 -Wall -c -MMD -MP
INC_PATH = -IC:/docs/ogre3d/ogre1.8.0_mingw_sdk/OgreSDK_MinGW_v1-8-0/include -IC:/docs
/ogre3d/CEGUI/CEGUI-0.7.6-mingw/cegui/include -IC:/docs/ogre3d/CEGUI/CEGUI-0.7.6-
mingw/cegui/include/RendererModules/Ogre -IC:/docs/ogre3d/CEGUI/CEGUI-0.7.6-mingw/cegui
/include/falagard

all: Precompiled.h.gch

@echo 'Finished precompiling headers....'

Precompiled.h.gch: Precompiled.h    
    @echo 'Building target: $@'
g++.exe Precompiled.h $(INC_PATH) $(C_FLAGS)     

clean:
rm Precompiled.h.gch 
```

.gch 的大小超过 169 MB，因为我正在尝试预编译大多数 Ogre3D 和 CEGUI 头文件。

谢谢你，亚当。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-15T01:42:51.813

GCC 有一个关于您的问题的错误报告，请参阅：[http](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56926) ://gcc.gnu.org/bugzilla/show_bug.cgi?id= 56926，看起来大 pch 文件（通常大于 150M）可能会导致此问题。

编辑：2015-05-31。我最近在 GCC 源代码中为 mingw 或 mingw-w64 工具链找到了 pch 文件的硬限制值，即 128M。我想建议有人构建一个最近的 GCC，看看它是否解决了这个崩溃问题。请参阅我在 mingw-w64 论坛中的帖子：[[Mingw-w64-public] 设置更大的 pch 文件大小限制？是：任何人都可以提供 cc1plus.exe 的调试版本吗？](https://sourceforge.net/p/mingw-w64/mailman/message/34159267/)

编辑：2015-06-02。我可以通过扩大 pch 文件的硬限制值来完全解决这个问题，请参阅我在 gcc bugzilla 中的[评论 17 。](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56926#c17)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-05T19:13:59.513

我有一个类似的问题并通过更新mingw解决了它：

1.  运行 shell（cmd 或 sh）
2.  更新包列表：

    `mingw-get update`

3.  在此运行升级之后

    `mingw-get upgrade`

在此之后，您的 mingw 软件包应该升级到最新版本，并且您应该能够通过错误。

# php - 坚持在一些 PHP 代码中放置 Html 代码

> ID：10841308
> 
> 赞同：0
> 
> 时间：2012-05-31T21:09:04.690
> 
> 标签：php, html

你好堆栈成员，

我目前有一个我希望显示的错误报告 - 我希望有一段静态的 html 可用于我的 GET 错误。

目前我的方式

apicheck.php?key=dfdf - 显示一个漂亮的页脚

apicheck.php?url=dfdf - 不显示 $_GET['url'] 部分中当前引用的页脚。

我的最终目标是让 html 代码在 die 函数所在的某个地方，就像 id 一样让所有 3 个 get 错误消息能够显示 HTML 页脚

我已经添加了 die 函数，以便我可以将代码与下面的代码分开

我还是个新手，这是我第一次尝试这样的冒险

我不太确定如何在其他任何地方添加 html，因为它不会在 IF 部分之一内 - 如果有人能解释如何在其他区域添加它，我将不胜感激

```
<?php
echo "<html><head><title>Error Report</title><style>
<!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}.style1 {font-size: 9px}
-->
</style> </head><body>
<h1>API Authentication System 1.0.1 GPX</h1>
<HR size='1' noshade='noshade'>";
if(empty($_GET)){
    echo "<p><b>Error Name:</b> <u>VAR_M</u><br>";
    echo "<p><b>Description:</b> <u>No Variables Sent</u><br><br>";
}
if(empty($_GET['key'])){
echo "<p><b>Error Name:</b> <u>API_KEY</u><br>";
echo "<p><b>Description:</b>  <u>Missing API-Key</u><br><br>";
}
if(empty($_GET['url'])){
echo "<p><b>Error Name:</b> <u>URL_M</u><br>";
echo "<p><b>Description:</b>  <u>Missing URL</u><br>";
echo "</u></p><HR size='1' noshade='noshade'>
<h3 align='center' class='style1'>X Auth /1.0.1.GPX</h3>
</body>
</html>";              
die();
}
else
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:16:44.357

你指的是这个文本的页脚吗？

```
echo "</u></p><HR size='1' noshade='noshade'>
<h3 align='center' class='style1'>X Auth /1.0.1.GPX</h3>
</body>
</html>"; 
```

如果是这样，只需将其放在单独的 if 语句中，如果*任何*错误条件适用，则该语句的计算结果为 true：

```
if(empty($_GET) or empty($_GET['key']) or empty($_GET['url']) {
    echo "</u></p><HR size='1' noshade='noshade'>
    <h3 align='center' class='style1'>X Auth /1.0.1.GPX</h3>
    </body>
    </html>"
    die();
} 
```

更好的是，您可以`$error_found = 1;`在每个其他错误消息条件块中包含一行，然后`$error_found`在打印页脚和 die() 语句时进行测试。这样，如果您添加额外的错误检查，您就不必记住将该条件添加到最终的 if 语句中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:22:39.377

如果你想让重复使用相同的 html 结构变得容易，你可以使用一个函数来回显它。

```
function echoError($name, $description) {
    echo "<p><b>Error Name:</b> <u>$name</u><br>";
    echo "<p><b>Description:</b> <u>$description</u><br><br>";
} 
```

让你的整个代码看起来像这样：

```
<html>
<head>
  <title>Error Report</title>
  <style>
<!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}.style1 {font-size: 9px}
-->
  </style>
</head>
<body>
  <h1>API Authentication System 1.0.1 GPX</h1>
  <HR size='1' noshade='noshade'>";
  <?php
    $error_found = false;
    if(empty($_GET)){
        echoError("VAR_M", "No Variables Sent");
        $error_found = true;
    }
    if(empty($_GET['key'])){
        echoError("API_KEY", "Missing API-Key");
        $error_found = true;
    }
    if(empty($_GET['url'])){
        echoError("URL_M", "Missing URL");
        $error_found = true;
    }
    if ($error_found) {
        echo "<HR size='1' noshade='noshade'><h3 align='center' class='style1'>X Auth /1.0.1.GPX</h3>";
    }
  ?>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:12:21.957

您可以构建一个字符串（从一个空字符串开始，并在获得错误消息时将它们连接到它），然后在您想要的任何地方打印该字符串。

```
$errorString = "";
if(empty($_GET)) {
    $errorString .= "<p><b>Error Name:</b> <u>VAR_M</u><br>";
... 
```

最后，或者你想要的任何地方，

```
echo $errorString; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T21:12:55.497

您可以通过将 html 部分放在它们自己的文件中然后将它们包含在内来清理它您可以通过使用[Heredoc](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)`include "file.html";`来简化这些 echo 语句

# javascript - 带有 JQuery Vaildate 的附加域的电子邮件地址的正则表达式

> ID：10841309
> 
> 赞同：0
> 
> 时间：2012-05-31T21:09:05.300
> 
> 标签：javascript, regex, jquery-validate

我需要验证带有额外域的电子邮件地址。我目前验证了一封普通的电子邮件`@email.com`，但我需要验证一封电子邮件`@email.email.com`。我对 RegEx 不够熟悉。

```
$.validator.addMethod('matches', function (value, element, param) {
    return this.optional(element) || value.match(param);
},
'Please enter a valid value.');

$(function() {

 $("form").validate({

            rules: {
                email: {
                    required: true,
                    email: true,
                    matches: '.+@email.com'
                }
            }, messages: {
                email: {
                    matches: 'Must be a email.com e-mail address.'
                }
            }
        });
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:28:30.110

要将任何（通常）电子邮件与两部分顶级域匹配，就像`*@google.co.uk`您可以使用 RegExp 一样，它匹配域部分中的 2-3 个单词部分：

```
var emailRegExp = /[a-zA-Z0-9._-]@[a-zA-Z0-9-]+\.\w+(\.\w+)?/
...
// in your code
matches: emailRegExp 
```

RegExp 解释说：

*   名称部分`[a-zA-Z0-9._-]`将匹配任何常用字符，以及`.`,`_`和`-`

*   域名部分`[a-zA-Z0-9-]`与名称大致相同，但没有`.`或`_`

*   顶级域部分`\.\w+(\.\w+)?`将匹配任何单个 tld，如`.com`,`.net`等，以及双倍的`.co.uk`, `.co.jp`,`.foo.bar`

RegExp 很短。如果您真的对正确的电子邮件验证感兴趣，您应该查看[RFC822-Spec](http://www.ex-parrot.com/pdw/Mail-RFC822-Address.html) (SCNR :D)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:56:37.213

这适用于 jquery validate 以验证电子邮件属于组织。我真的很接近，但我认为它不需要一些东西。

```
(.+@+[A-Za-z0-9._-]+\\.email.com$)|(.+@email.com$) 
```

# python - 由于缩进，Python IDLE (Mac OS X) 中的语法错误

> ID：10841312
> 
> 赞同：2
> 
> 时间：2012-05-31T21:09:09.767
> 
> 标签：python, python-idle

我假设这将很容易回答，但我已经搜索了所有内容，但找不到答案。我正在学习 Python 并尝试运行一些非常简单的代码，但是每当我尝试在缩进块之后执行某些操作时，我都会不断收到语法错误。例如：

```
x = [1,2,3];
for i in x:
    print(i);
print('finished'); 
```

当我运行此代码时，我在 print('finished') 部分收到语法错误。每当我尝试通过在循环或 if 语句之类的块之后取消缩进来运行任何内容时，都会出现此错误。我在 Mac OS X Lion 上的 IDLE 中运行 Python 3.2.3。

更新：似乎这并不像我想象的那么容易，也许我正在尝试做一些毫无意义的工作。我猜shell只在你运行一个缩进的块时运行多行语句，但是当你回到顶层时它会执行语句。因为我通常会处理文件，很可能是在 Django 中，所以最终不会有问题。感谢所有令人惊讶的快速响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:14:02.260

至少`python`我的 Ubuntu 系统上的交互式解释器需要换行符来结束块：

```
>>> x = [1,2,3];
>>> for i in x:
...     print(i);
... print('finished');
  File "<stdin>", line 3
    print('finished');
        ^
SyntaxError: invalid syntax
>>> x = [1,2,3];
>>> for i in x:
...     print(i);
... 
1
2
3
>>> print('finished');
finished 
```

有趣的是，`python`解释器在脚本上运行时不需要空行：

```
$ cat broken.py 
#!/usr/bin/python

x = [1,2,3];
for i in x:
    print(i);
print('finished');

$ ./broken.py 
1
2
3
finished
$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:04:55.193

您是否尝试在 IDLE 的默认`Python Shell`窗口中输入此代码？您最好打开一个 IDLE 编辑器窗口（菜单项`File`-> `New Window`）并从那里运行代码（菜单项`Run`-> `Run Module`）。在 shell 窗口中缩进会让人感到困惑，而且很难纠正错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:12:27.853

取出所有分号。

```
x = [1,2,3]
for i in x:
    print(i)
print('finished') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T21:14:27.930

在之后插入换行符`print(i)`（也在**windows**上）

```
x = [1, 2, 3]
for i in x:
    print(i)

print('finished') 
```

# c# - C# 和 .NET Framework 3.5 中的后期绑定

> ID：10841313
> 
> 赞同：3
> 
> 时间：2012-05-31T21:09:24.027
> 
> 标签：c#, .net-3.5, late-binding

我正在尝试将此代码转换为 C# .NET Framework 3.5，但该版本对后期绑定不友好。如果我使用的是 4.0，我会使用动态类型，但现在这不是一个选项。

使事情复杂化的是我真正想要创建的对象（`atl3270Tool`）是在一个参数中创建的。帮助将不胜感激。

```
Dim atl3270Tool
Dim ErrMsg As String
Dim S_OK As UInt16 = 0
Dim atlDirectorObject = CreateObject("atlDirectorObject.atlDirector")
If atlDirectorObject.CreateTool("3270", 1, True, True, 0, atl3270Tool, ErrMsg) <> S_OK Then
    'Terminate
End If 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T23:25:02.877

后期绑定在 vb.net 中很容易做到。所以利用 .NET 对用不同语言编写代码的支持，添加一个 vb.net 类库项目来包装 COM 组件。

标识符名称上的“atl”前缀很奇怪。ATL 是 ActiveX Template Library 的首字母缩写，是一个非常流行的用于编写 COM 组件的 C++ 库。默认情况下，它会创建支持双重绑定的服务器，包括晚期和早期。对于早期绑定，您需要一个类型库，它在 ATL 项目中默认嵌入到可执行文件中。因此，请确保您没有在这里浪费机会编写早期绑定的 C# 代码。项目+添加引用，浏览选项卡，选择DLL。如果您没有收到任何投诉，那么您就是黄金，使用对象浏览器查看生成的互操作库。

# java-me - 创建本机位图库

> ID：10841319
> 
> 赞同：3
> 
> 时间：2012-05-31T21:09:43.147
> 
> 标签：java-me, fonts, bitmap

我是波斯人，j2me 对波斯字体没有很好的支持。

我将创建一个本地字体库，获取位图字体并在 desplay 中绘制我的波斯文本。但我有一个问题。

在英语中，每个字母都是一组由 shap 和 uncode 组成。喜欢`(a , U+0061)`

但是在波斯语中，一个字符可能有几种形状。例如波斯字母中的字母“ب”可以是：

آب --当它是单词中的单独字母时
به --当它是单词中的开始字母时
...

如何从字体文件中获取其他形式的字母？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T04:05:54.617

我是一名波斯开发人员，大约 4 年前我遇到了同样的问题。你有办法解决这个问题：
1-使用**自定义字体**。
2-在显示之前**重塑您的文本。**
about first 中的一篇好文章是“ [***MIDP 终端仿真，第 3 部分：MIDP 的自定义字体***](http://developers.sun.com/mobility/midp/articles/termemulator3/)”。但是对于阿拉伯字母，我认为这并不简单。在大约第二种方式中，假设您将用正确的字符替换文本中的任何字符。这意味着当您有：

```
String str = "به"; 
```

如果获取 str 字符，它们将如下所示：
{1576,1607} 类似于“به”而不是“به”。因此，您可以用正确的 Unicode 代码替换不正确的 Unicode（在这种情况下，正确的字符是：{65169, 65258}）。您可以使用“阿拉伯语整形器”甚至是专为 android 设计的整形器！我看到了这个整形器的 2 个链接：1- [***github***](https://github.com/agawish/Better-Arabic-Reshaper) 2-[***阿拉伯语 Android***](https://sites.google.com/a/ut.utm.edu/arabic-android/)（我是波斯开发人员，所以我不尝试它们，而是我创建与他们有相同想法的课程）。
**使用良好的整形器，您也可能会遇到**从左到右而不是从右到左排列字符的问题。（有些手机从左到右绘制字符，其他从右到左绘制字符）。我使用下面的类来检测排序是否正确（从右到左）与否：

```
public class DetectOrdering{   
    public static boolean hasTrueOrdering()
    {
        boolean b = false;
        try {
        char[] chArr = {65169, 65258};
        String str = new String(chArr);
        System.out.println(str);
        int width = f1.charWidth(chArr[1]) / 2;
        int height = f1.getHeight();
        image1 = Image.createImage(width, height);
        image2 = Image.createImage(width, height);
        Graphics g1 = image1.getGraphics();
        Graphics g2 = image2.getGraphics();
        g1.drawString(str, 0, 0, 0);
        g2.drawChar(chArr[1], 0, 0, 0);
        int[] im1 = new int[width * height];
        int[] im2 = new int[width * height];

        image1.getRGB(im1, 0, width, 0, 0, width, height);
        image2.getRGB(im2, 0, width, 0, 0, width, height);
        if (areEqualIntArrrays(im1, im2)) {
            b = true;
        } else {
            b = false;
        }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return b;
    }

private static boolean areEqualIntArrrays(int[] i1, int[] i2) {
    if (i1.length != i2.length) {
        return false;
    } else {
        for (int i = 0; i < i1.length; i++) {
            if (i1[i] != i2[i]) {
                return false;
            }
        }
    }
    return true;
    }
} 
```

如果 DetectOrdering.hasTrueOrdering() 返回 true，请确保手机从右到左绘制阿拉伯字符并显示您的字符串。如果返回 false，它会从左到右绘制。如果手机从左到右绘制阿拉伯字符，您将在重塑后反转字符串它，然后你可以显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T11:36:05.630

您可以将一个 alphabet.png 用于直接 unicode 映射（波斯字符不会因为相邻字符而改变的映射）。如果你的字符是等宽的，你可以从下面的类开始，如[http://smallandadaptive.blogspot.com.br/2008/12/custom-monospaced-font.html](http://smallandadaptive.blogspot.com.br/2008/12/custom-monospaced-font.html)所示：

```
    公共类 MonospacedFont {

    私有图像图像；
    私有字符 firstChar；
    私人 int numChars;
    私人 int charWidth;

    公共等宽字体（图像图像，char firstChar，int numChars）{

        如果（图像==空）{
            throw new IllegalArgumentException("image == null");
        }

        // 第一个可见的 Unicode 字符是 '!' （价值 33）
        如果（firstChar <= 33）{
            throw new IllegalArgumentException("firstChar <= 33");
        }

        // 图像上必须至少有一个字符
        如果（numChars <= 0）{
            throw new IllegalArgumentException("numChars <= 0");
        }

        this.image = 图像；
        this.firstChar = firstChar;
        this.numChars = numChars;
        this.charWidth = image.getWidth() / this.numChars;
    }

    公共无效drawString（图形g，字符串文本，int x，int y）{

        // 存储当前图形剪辑区域以便以后恢复
        int clipX = g.getClipX();
        int clipY = g.getClipY();
        int clipWidth = g.getClipWidth();
        int clipHeight = g.getClipHeight();
        char[] 字符 = text.toCharArray();

        for (int i = 0; i < chars.length; i++) {

            int charIndex = chars[i] - this.firstChar;

            // 当前字符存在于图像上
            if (charIndex >= 0 && charIndex <= this.numChars) {
                g.setClip(x, y, this.charWidth, this.image.getHeight());
                g.drawImage(image, x - (charIndex * this.charWidth), y,
                图形.TOP | 图形.左）；
                x += this.charWidth;
            }
        }

        // 恢复初始剪辑区域
        g.setClip（clipX，clipY，clipWidth，clipHeight）；
    }

}

```

并将其更改为对每个因相邻字符而更改的波斯字符使用不同的 char_uxxxx.png 文件。

解析字符串时，在绘画之前，您必须检查哪个 png 文件适合使用。希望这是一个很好的起点。

# php - MySQL到PHP双引号问题

> ID：10841322
> 
> 赞同：0
> 
> 时间：2012-05-31T21:09:48.823
> 
> 标签：php, mysql, special-characters, data-cleaning

我有一个包含多个电影概要的数据库 - 这些是通过电子邮件发送给我的文本块，我将其复制粘贴到我的数据库中。我现在正试图用一个简单的 PHP 脚本将它们解析出来——而且我不断收到错误消息。我怀疑它是由于文本块中的双引号、& 和其他特殊字符造成的——那么我该如何清理呢？

这是我的代码：

```
 $query = "select * from Films";
    $result = mysql_query($query);

    while($row = mysql_fetch_assoc($result))
    {
        echo "<film>";

            echo "<ID>";
              echo $row['ID'];
            echo "</ID>";

            echo "<FilmName>";
              echo $row['FilmTitle'];
            echo "</FilmName>";

            echo "<FilmGenre>";
              echo $row['FilmGenre'];
            echo "</FilmGenre>";   

            echo "<FilmSynopsis>";
              echo $row['FilmSynopsis'];
            echo "</FilmSynopsis>"; 

        echo "</film>";
    } 
```

我几乎总是在 SYNOPSIS 部分崩溃——因为那是文本最多的部分，因此“有问题的”字符出现次数最多。

有什么方法可以即时清理它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:33:12.517

[`htmlentities($str, ENT_DISALLOWED)`](http://php.net/manual/en/function.htmlentities.php)在将内容回显到 XML 之前，您需要使用它来转义内容：

```
$query = "select * from Films";
$result = mysql_query($query);

while($row = mysql_fetch_assoc($result))
{
    echo "<film>";

        echo "<ID>";
          echo htmlentities($row['ID'], ENT_DISALLOWED);
        echo "</ID>";

        echo "<FilmName>";
          echo htmlentities($row['FilmTitle'], ENT_DISALLOWED);
        echo "</FilmName>";

        echo "<FilmGenre>";
          echo htmlentities($row['FilmGenre'], ENT_DISALLOWED);
        echo "</FilmGenre>";   

        echo "<FilmSynopsis>";
          echo htmlentities($row['FilmSynopsis'], ENT_DISALLOWED);
        echo "</FilmSynopsis>"; 

    echo "</film>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-16T09:17:45.310

尝试这个：

`htmlentities($string, ENT_QUOTES,'UTF-8')`

# .net - 对数据源组合框进行排序？

> ID：10841328
> 
> 赞同：3
> 
> 时间：2012-05-31T21:10:08.300
> 
> 标签：.net, vb.net

我在组合框中列出了文件夹，但我尝试按字母顺序对文件夹进行排序，然后按数字排序，反之亦然。

我填充组合框的编码是

```
With Combobox1.DataSource = 
    (From folder In New IO.DirectoryInfo("Path").GetDirectories
     Select (folder.Name)
    ).ToArray
End With 
```

是否可以对组合框进行排序？谢谢

嗨，感谢你们的帮助，但它并没有真正解决我的问题，因为我有编号为 1、50、115、189 等的文件夹。

这些应显示为

```
1
50
115
189 
```

但是它们显示为

```
1
115
189
50 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:45:42.470

你离正确的语法只有一英寸

```
Combobox1.DataSource =  
    ( From folder In New DirectoryInfo("Path").GetDirectories()
      Order By folder.Name 
      Select folder.Name 
    ).ToArray() 
```

或者，如果您更喜欢使用完全限定的路径`Name`更改`FullName`

编辑：快速修复您的请求。

```
 Combobox1.DataSource =  
     ( From folder In New DirectoryInfo("path").GetDirectories()       
      Order By ("00000000" + folder.Name).SubString(folder.Name.Length, 8)        
      Select folder.Name
     ).ToArray() 
```

在`order by`I 在文件夹名称前面加上八个`0`字符，然后将最后八个字符传递给排序。这对于“99999999”以下的文件夹应该足够了，如果您的“路径”中有混合名称，则未经测试

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:13:55.957

当然

```
Combobox1.DataSource = 
    ( From folder In IO.Directory.GetDirectories("Path")
      Order By folder
      Select folder
    ).ToArray() 
```

也使用`IO.Directory`which 提供静态方法。它以字符串而不是类的形式返回目录名称`DirectoryInfo`。`DirectoryInfo`当您必须在同一目录上执行多个操作时会更好。

另外，我看不到`With`-statement 在这里做了什么。

# ruby-on-rails - 如何为同一页面中的两个表单设置 routes.rb？

> ID：10841335
> 
> 赞同：0
> 
> 时间：2012-05-31T21:10:32.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我在这个 [question] 中部分解决了相同的情况：[Problems with routes.rb](https://stackoverflow.com/questions/10824412/problems-with-routes-rb)

现在我的“/users/index”中有两个表单，例如登录表单和注册表单。我在 users_controller、post_login 和 post_registration 中创建了两个不同的操作，并通过简单的重定向到另一个页面，但是如果我单击按钮，它会给我同样的错误：没有路由匹配 [POST] "/users"

这是我的 routes.rb 代码

```
Mysite::Application.routes.draw do

  controller :home do
    get     'login'   => :index
    post    'login'   => :create
  end

  resources :users, :only => [:index] do
      get     'login'         => :index
      post    'login'         => :post_login
      get     'registration'  => :index
      post    'registration'  => :post_registration
    collection do
      post 'post_login'
      post 'post_registration'
    end
  end

#  get "/users" => 'users#index'
#  post "/users" => 'users#post_login'

  get "home/index"

  get "home/create"

  get "home/show"

  get "private/index"

  get "users/index"

  get "users/post_login"

  get "users/post_registration"

end 
```

虽然在这里我的form_registration ...

```
<%= form_tag do %>

    <table>
        <tr>
            <td>
                <%= text_field_tag :name, params[:name] %>
            </td>
        </tr>
        <tr>            
            <td>
                <%= password_field_tag :password, params[:password] %>
            </td>
        </tr>       
        <tr>
            <td>
                <%= submit_tag "Registration" %>            
            </td>
        </tr>
<% end %>

    </table> 
```

...和form_login

```
<%= form_tag do %>

    <table>
        <tr>
            <td>
                <%= text_field_tag :name, params[:name] %>
            </td>
        </tr>
        <tr>            
            <td>
                <%= password_field_tag :password, params[:password] %>
            </td>
        </tr>
        <tr>
            <td>
                <%= submit_tag "Login" %>           
            </td>
        </tr>
<% end %>
        <tr>            
            <td>
                <%= link_to 'Registrazione', '/users/index' %>              
            </td>
        </tr>

    </table> 
```

问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:26:55.523

Try modifying your form tags to be like below:

```
<%= form_tag('/users/post_registration', :method => :post) %> 
```

for registration, and:

```
<%= form_tag('/users/post_login', :method => :post) %> 
```

for login. The ':method => :post' option isn't strictly necessary but it doesn't hurt to be explicit.

# android - 应用程序小部件未显示在 ICS 应用程序抽屉中

> ID：10841337
> 
> 赞同：4
> 
> 时间：2012-05-31T21:10:33.737
> 
> 标签：android, android-4.0-ice-cream-sandwich, android-appwidget

有没有人遇到过他们的应用小部件未在 ICS 应用抽屉中列出？

最初我为 FroYo 及以下版本启动了这个应用程序，它很好地支持了应用程序小部件。Gingerbread 和 Honeycomb 也随之而来。

如果我打开“小部件预览”应用程序，小部件会出现在模拟器的列表中，但是当您打开抽屉时，它不会与其他小部件一起列出。它确实出现在蜂巢上。我也没有（其他人也没有）在我的 Galaxy Nexus 上看到它。

我已经尝试重新启动，因为我已经看到在初始安装后为某些人解决了问题。此外，由于我有应用程序活动，因此我确实有一个带有 action.MAIN/category.LAUNCHER 意图过滤器的主要活动，这不仅仅是一个小部件类型的项目。

我将在下面发布一些片段，如果需要更多，请告诉我。我的 minSdkVersion 为 7，targetSdkVersion 为 15，项目属性的目标也检查为 4.0.3。installLocation 属性设置为自动。

AndroidManifest.xml：

```
<receiver android:name=".AppWidget" android:label="@string/one_cell_widget_label">
    <intent-filter>
        <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
    </intent-filter>
    <intent-filter>
        <action android:name="com.frankcalise.h2droid.FORCE_WIDGET_UPDATE" />
    </intent-filter>
    <meta-data
        android:name="android.appwidget.provider"
        android:resource="@xml/one_cell_widget_settings" />
</receiver> 
```

one_cell_widget_settings.xml：

```
<appwidget-provider
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:initialLayout="@layout/one_cell_widget"
    android:minWidth="@dimen/one_cell_widget"
    android:maxHeight="@dimen/one_cell_widget"
    android:updatePeriodMillis="0" >
</appwidget-provider> 
```

one_cell_widget.xml：

```
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/widget_background"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="@dimen/widget_margin"
    android:background="@drawable/widget_background">
    <TextView
        android:id="@+id/widget_title_text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/app_name"
        android:textColor="@android:color/black" />
    <TextView
        android:id="@+id/widget_amount_text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/default_widget_amount"
        android:textSize="12sp"
        android:textColor="@color/amount_color" />
    <TextView
        android:id="@+id/widget_percent_text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/default_widget_percent" />
</LinearLayout> 
```

然后显然我在 AppWidget.java 中实现了这个类

```
public class AppWidget extends AppWidgetProvider 
```

更新：

我今天早些时候发现的一条重要的 logcat 消息帮助我解决了这个问题：

```
06-01 14:41:31.606: E/AppsCustomizePagedView(199): Widget ComponentInfo{com.frankcalise.h2droid/com.frankcalise.h2droid.AppWidget} has invalid dimensions (108, 0) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T15:16:27.893

我发现了这个问题。我的 appwidget-provider 元素在其中一个属性中有错字，它应该是“minHeight”，而不是“maxHeight”。

导致我发现这一点的原因是在启动器的 logcat 中发现了错误输出。它提到我的小部件的尺寸无效（因此它没有将其添加到小部件列表中）。然后我开始检查与我的小部件相关的所有维度属性。

# python - 为什么此代码在并行 python 中不起作用

> ID：10841341
> 
> 赞同：1
> 
> 时间：2012-05-31T21:10:43.357
> 
> 标签：python, parallel-processing, subprocess

我尝试像这样使用 pp(Parallel Python)：

```
import glob
import subprocess
import pp

def run(cmd): 
    print cmd
    subprocess.call(cmd, shell=True) 

job_server = pp.Server()
job_server.set_ncpus(8)
jobs = []
for a_file in glob.glob("./*"): 
    cmd = "ls" 
    jobs.append(job_server.submit(run, (cmd,))) 
for j in jobs: 
    j() 
```

但是遇到了subprocess.call不是全局名这样的错误。

```
An error has occured during the function execution
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/pp-1.6.1-py2.7.egg/ppworker.py", line 90, in run
    __result = __f(*__args)
  File "<string>", line 3, in run
NameError: global name 'subprocess' is not defined 
```

我已经导入了子流程，为什么不能在这里使用？

根据 abarnert 的建议，我将代码更改为：

```
import glob
import pp
def run(cmd): 
    print cmd
    subprocess.call(cmd, shell=True) 
job_server = pp.Server()
job_server.set_ncpus(8)
jobs = []
for a_file in glob.glob("./*"): 
    cmd = "ls" 
    jobs.append(job_server.submit(run, (cmd,),modules=("subprocess",))) 
for j in jobs: 
    j() 
```

但它仍然不起作用，它抱怨这样：

```
Traceback (most recent call last):
  File "/usr/lib/python2.6/threading.py", line 532, in __bootstrap_inner
   self.run()
  File "/usr/lib/python2.6/threading.py", line 484, in run
    self.__target(*self.__args, **self.__kwargs)
  File "/usr/local/lib/python2.6/dist-packages/pp-1.6.1-py2.6.egg/pp.py", line 721, in _run_local
    job.finalize(sresult)
UnboundLocalError: local variable 'sresult' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:22:02.653

文档很好地解释了这一点，每个示例都向您展示了如何处理它。

submit 方法的参数之一是“模块 - 带有要导入的模块名称的元组”。您希望在提交的作业中可用的任何模块都必须在此处列出。

所以，你可以这样做：

```
jobs.append(job_server.submit(run, (cmd,), (), ('subprocess',))) 
```

或这个：

```
jobs.append(job_server.submit(run, (cmd,), modules=('subprocess',))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:18:14.637

抱歉，未经测试，但您是否尝试过：

```
from subprocess import call 
```

在“运行”功能内？

然后使用“call”而不是“subprocess.call”？这将使函数的“调用”本地化但可访问。

# iphone - 重复使用表格单元格问题

> ID：10841345
> 
> 赞同：0
> 
> 时间：2012-05-31T21:10:47.887
> 
> 标签：iphone, objective-c, ios, uitableview

我相信我执行不正确`cellForRowAtIndexPath`。我有一个`UISlider`默认隐藏的，当在表格单元格中按下按钮时出现。当我按下第一个单元格中的按钮时，滑块不仅出现在第一个单元格中，而且在我向下滚动时每隔三个单元格出现一次。我目前通过将滑块的 hidden 属性重置为`YES`in来避免这种情况`cellForRowAtIndexPath`。我也对默认隐藏的单元格中的其他视图执行此操作。当我向上滚动到第一个单元格时，这会产生一个新问题，滑块被隐藏，因为属性在`cellForRowAtIndexPath`. 这让我相信我做错了什么。

这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

static NSString *CellIdentifier = @"Cell";

SongsCustomCell *songCell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (songCell == nil) {
    songCell = [[SongsCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    NSLog(@"new cell created");
}

NSDictionary *dictionary = [parseTrackArray objectAtIndex: indexPath.row];
NSString *trackTitle = [dictionary objectForKey:@"trackTitle"];
NSString *trackLink = [dictionary objectForKey:@"trackStreamLink"];
songCell.trackLinkString = trackLink;
songCell.trackTitleString = trackTitle;
[songCell.trackTitleLabel setFont:[UIFont fontWithName:@"Calibri" size:22]];
songCell.trackTitleLabel.text = [NSString stringWithFormat:@"%@", trackTitle];

songCell.playButton.hidden = NO;
songCell.playbackSlider.hidden = YES;
songCell.playerHasLoaded = NO;
songCell.moviePlayer.view.hidden = YES;

return songCell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:17:34.330

您需要将滑块的隐藏/未隐藏状态存储在数据模型中的某个位置，然后根据 cellForRowAtIndexPath 中的设置适当地设置滑块的可见性。如果一次只有一个滑块可见，则可以将索引路径作为 ivar 存储在视图控制器中，如果没有，则需要在字典中保存另一个键，其中包含 NSNumber 布尔值或其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:17:30.253

您的问题是，当您向下滚动时，您的单元格正在被重复使用。因此，当您的滑块对于滚动出视图的单元格可见时，该单元格将被重用，因此滑块仍然可见。

为了避免`prepareForReuse`在您的自定义单元格中执行此操作，以便在您的单元格被重用时立即重置您的滑块。

除此之外，您仍然需要将滑块的状态存储在模型中，以便在该对象返回视图后恢复该状态。

Nevertjeless 将自定义单元格的默认状态设置为`prepareForReuse`

# jquery-mobile - jQuery Mobile - 日期框，隐藏标题

> ID：10841351
> 
> 赞同：1
> 
> 时间：2012-05-31T21:11:32.093
> 
> 标签：jquery-mobile, datebox

我正在玩 jQuery Mobile - Datebox。

有没有办法用 Android 模式隐藏标题？

我试...

```
<input name="day" id="day" type="date" data-role="datebox"
data-options='{"mode": "datebox", "calShowDays": "false"}'> 
```

和

```
<input name="day" id="day" type="date" data-role="datebox"
data-options='{"mode": "datebox", "headerFormat": "false"}'>
//format for header if used %A, %B %-d, %Y 
```

但是什么也没发生。

谢谢。

文森特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T16:46:55.710

我解决了这个问题。

对于[http://dev.jtsage.com/jQM-DateBox2/](http://dev.jtsage.com/jQM-DateBox2/)，

```
<script>
jQuery.extend(jQuery.mobile.datebox.prototype.options, {
    'overrideHeaderFormat': '',
});
</script> 
```

我希望我的片段对其他人有用。:)

干杯，

文森特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:25:56.807

试试这个。这个对我有用

```
<input name="day" id="day" type="date" data-role="datebox"
data-options='{"mode": "datebox", "headerFormat": ""}'> 
```

# facebook - 面向公众的 Facebook 应用程序访问

> ID：10841352
> 
> 赞同：0
> 
> 时间：2012-05-31T21:11:36.797
> 
> 标签：facebook, facebook-like

我创建了我的第一个 Facebook 应用程序。基本上是画布/iframe 版本。一切似乎都很好..除了：

1.  当我以应用程序的管理员用户身份登录时，我只能访问应用程序页面：(http://apps.facebook.com/hoo_promo/)。每个人都应该可以看到它。我已经将它提交到应用商店...这有关系吗？这是问题吗？

2.  尽管我遵循了几个示例，但我的类似门似乎不起作用。我登录的管理员用户喜欢该页面，但代码

    **$signed_request = $facebook->getSignedRequest(); $like_status = $signed_request["page"]["liked"];**

    从未在signed_request obj 中设置for page-like。

非常感谢任何帮助......我添加了我当前的代码......也许这也可以帮助其他人......

```
$app_id = "secretblahblahhiddenthis";
$secret = 'secretblahblahhiddenthis';
$canvas_page = "http://www.houseofoak.co.uk/facebook_app/";
$auth_url = "http://www.facebook.com/dialog/oauth?client_id=" . $app_id . "&redirect_uri=" . urlencode($canvas_page);

$facebook = new Facebook(array(
'appId' => $app_id,
'secret' => $secret,
'cookie' => true,
));

$signed_request = $facebook->getSignedRequest();
$like_status = $signed_request["page"]["liked"];
$user = $facebook->getUser();

$page = 'unliked';
$loginUrl = $facebook->getLoginUrl(array('scope' => 'user_likes'));
$logoutUrl = $facebook->getLogoutUrl();

if (($user) && ($like_status)){
    $page = 'liked'; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:38:31.203

对于您的问题：

1.  检查以确保您未处于沙盒模式。访问[https://developers.facebook.com/apps/YOUR_APP_ID/advanced](https://developers.facebook.com/apps/YOUR_APP_ID/advanced)进行检查。

2.  不再允许您尝试做的事情。Facebook 已经弃用了大多数使类似门成为可能的方法。请参阅[Facebook 平台政策第 IV 部分。第 1 点](https://developers.facebook.com/policy/#integration)说：“您不得……将内容置于……Facebook 社交渠道之后……”

# maven - 我可以将 Maven 属性中的列表传递到插件配置中吗

> ID：10841363
> 
> 赞同：4
> 
> 时间：2012-05-31T21:12:49.580
> 
> 标签：maven

我有一个插件，它在其配置中包含一个列表：

```
<build>
  <plugins>
    <plugin>
      <groupId>com.example</grouId>
      <artifactId>fictional-plugin</artifactId>
      <configuration>
        <fictionalSet>
          <setItem>First</setItem>
          <setItem>Second</setItem>
          <setItem>Third</setItem>
        </fictionalSet>
  ...
</build> 
```

的内容`<fictionalSet>`将根据当前配置文件而变化。现在我在配置文件中复制插件定义，感觉有点浪费。我真正想要的是将一组项目定义为属性：

```
<properties>
  <fictional.set.items>
    <setItem>First</setItem>
    <setItem>Second</setItem> 
 ...
</properties> 
```

但是，如果我尝试上述操作，则会从 Maven 收到错误消息：

```
[ERROR]     Non-parseable POM <path>/pom.xml: TEXT must be immediately followed 
by END_TAG and not START_TAG (position: START_TAG seen ...
<fictional.set.items>\r\n\t\t\t<setItem>... @37:13)  @ line 37, column 13 
```

有没有办法将 Maven 属性中的列表传递到插件配置中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:17:33.137

Maven 不支持将多个属性/标签存储在一个标签内的任何类型的列表或方式。但是，您不需要复制插件配置，您可以将其完全移动到配置文件中，而根本不在主 pom 中定义它（替代：仍然从主 pom 中删除它，但创建一个 activeByDefault 配置文件，它有默认插件配置）。由于 maven 不会打扰解析非活动配置文件，因此重复代码不应导致任何性能问题。

# jquery - 如何使用 JavaScript 向图像客户端添加水印？

> ID：10841367
> 
> 赞同：3
> 
> 时间：2012-05-31T21:13:07.883
> 
> 标签：jquery

是否可以使用 jquery 在客户端向动画 gif 添加水印（文本或图像）。

在这种情况下，所有处理都是客户端。

我不能让它在 jsfiddle 上工作。但它非常简单，水印被添加到主图像中。

我遇到的问题是我需要这个来处理动画 gif。所以水印显示在右下角。

主js代码为： http: [//www.patrick-wied.at/static/watermarkjs/jq/](http://www.patrick-wied.at/static/watermarkjs/jq/)

页面上的脚本：

```
var config = {
    "path": "watermark.png"
};
$(document).ready(function() {
    $(document).watermark(config);
}); 
```

我唯一的问题是，通常我们可以使用 imagemagik gd 和 php 等来处理它。但这必须在客户端工作。所以请有任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:33:30.293

没有可用于物理更改原始图像文件本身的客户端 JavaScript。但是，使用 canvas 元素，您可以使用图像数据。

您链接到的 watermark.js 脚本通过将图像绘制到画布元素然后在顶部写入水印图像来工作。我相信它会使用类似`img.src = canvas.toDataURL();`.

要使用动画 gif 执行此类操作，您将需要做更多的工作。特别是，您需要将 gif 作为原始二进制文件获取并解析出每一帧并执行上述操作。您还需要自己制作 gif 动画，因为浏览器不再渲染它，您是。

发布[到这个问题](https://stackoverflow.com/q/327685/416627)的答案将是一个很好的起点。您还需要查看 gif 格式本身。

综上所述，如果你想用水印保护你的图像，你需要在服务器端进行。只需禁用 JavaScript 和/或查看源代码以获取原始图像 url，就可以击败在客户端完成的任何操作。watermark.js 脚本也容易受到同样的攻击。我认为这是一个有趣的练习，可能会阻止临时访问者盗取图像。但是，任何有足够决心的人都可以轻松击败这一点。

# php - 如何使用zend框架转换json数据中的对象？

> ID：10841368
> 
> 赞同：2
> 
> 时间：2012-05-31T21:13:19.287
> 
> 标签：php, arrays, json, zend-framework, object

这个问题似乎在谷歌出现了很多，我似乎仍然不知道如何做到这一点。

我正在做一个`fetchAll`，我得到一个对象或一个对象数组：

如果我 var_dump 它我得到：

```
array(3) {
  [0] object(Model_Model)#163 (55) {
    ['_name':protected] = NULL
    ['_info1':protected] = NULL
  }
  [1]  object(Talents_Model)#172 (55) {
    ['_name':protected] = NULL
    ['_info1':protected] = NULL
  }
  [2]object(Talents_Model)#143 (55) {

    ['_name':protected] = NULL
    ['_info1':protected] = NULL

  }

} 
```

如果我这样做 $this->_helper->json( $the_object ); `or`json_encode` 我得到空的 json 对象 [{},{},{},{}]

有没有办法将这些对象直接转换为 json，无论是一个对象还是它们的数组？

谢谢

我写了一些解决这个问题的东西：

```
public static function getProperties($object)
    {   
        $array = array();

        $reflection = new ReflectionObject($object);

        foreach($reflection->getProperties(ReflectionProperty::IS_PROTECTED) as $property)
        {  
            $property->setAccessible(TRUE);
            if(!$property->isStatic())
            { 
                $array[preg_replace('/_/', '', $property->getName(), 1)] = $property->getValue($object);
            }
        }

        if(empty($array)) return;

        return $array;
    } 
```

这种方法可以更改为更通用，我也使用`reflections`new in`PHP 5.4`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:20:17.807

```
$result=$this->fetchAll($select);
$result=$result->toArray(); 
```

我想，那么你应该使用 json_encode

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:17:18.360

您真正的问题不是 JSON 转换，而是对象成员不公开！

如果您知道属性名称，您应该能够轻松解决这个问题，或者如果您不知道（例如使用反射），则可以做更多的工作。

# javascript - CSS 相当于 JavaScript 的 document.write？

> ID：10841374
> 
> 赞同：0
> 
> 时间：2012-05-31T21:13:44.350
> 
> 标签：javascript, html, css

CSS 可以编写 HTML 代码，类似于 JavaScript 的 document.write 可以吗？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-31T21:14:35.003

并不真地。

它有[属性`content`，](http://www.w3.org/TR/CSS21/generate.html#content)但它已经很接近了。

内容是 HTML 的工作。将 CSS 用于表示，将 JavaScript 用于逻辑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T22:50:12.200

您不能编写作为 HTML 处理的 HTML 代码，但可以完成内容生成，并且在有限范围内对可选内容很有用。

示例：您有链接元素，其中一些指向 pdf 文件。您希望 CSS 在其目的地以 .pdf 扩展名结尾的每个链接的末尾写出字符串“(pdf)”。您编写一个规则，根据子字符串匹配属性选择器将您的字符串附加到 ::after 伪元素。

```
a[href$=".pdf"]::after {content:"(pdf)";} 
```

这不太可能对强制性内容有用，因为浏览器支持不完整。

# clojure - 逆时针查找符号文档

> ID：10841375
> 
> 赞同：4
> 
> 时间：2012-05-31T21:13:47.180
> 
> 标签：clojure, counterclockwise

在逆时针方向，如果我使用 CTRL-Space 来完成符号名称，并且有多种可能性，它会给我一个列表，并且在列表的右侧和侧面是一个框，其中包含我滚动时每个符号的文档通过名字。

有没有办法在不使用完成的情况下获得这个文档窗口，或者如果只有一个选项可以完成？现在我正在查找文档，方法是删除足够多的字母以使符号不明确，然后重新选择我想要的符号，但这非常低效。通常我只想知道参数的顺序。我不是 emacs 的忠实粉丝，但我喜欢 slime 的一件事是我似乎记得当我使用它时，状态栏有一个小列表，其中包含我调用的任何函数的参数。

我用谷歌搜索了这个问题，也查看了逆时针的网页，但我一定是使用了错误的搜索词，因为我没有想出任何东西。

-哈利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-08-27T09:28:18.217

您应该能够将鼠标悬停在符号上，并且将弹出文档。或者在光标位于符号上方时按 F2。

# android - 使用键盘进行屏幕输入

> ID：10841380
> 
> 赞同：2
> 
> 时间：2012-05-31T21:13:58.897
> 
> 标签：android, android-edittext

我想如果我把它呈现在图像中，我的问题会很清楚：

[http://i41.servimg.com/u/f41/15/91/45/84/keyboa10.png](http://i41.servimg.com/u/f41/15/91/45/84/keyboa10.png)

图 2 和图 3 是我单击其中一个 edittext 字段时发生的情况，而图 4 是我想要的（在所有字段下都有键盘......）。

这些图片只是一个例子，这不是我的应用程序：p ...我已经尝试过类似的东西

```
 <activity name="EditContactActivity"
    android:windowSoftInputMode="stateVisible|adjustResize">
    ...
    </activity> 
```

但结果永远不是 IMG4 :S

有人知道如何到达 IMG4 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T11:36:54.903

为您的 xml 文件使用滚动视图。它可以解决你的问题。

# jquery - jQuery + CoffeeScript，slideToggle 只隐藏然后再次显示

> ID：10841382
> 
> 赞同：0
> 
> 时间：2012-05-31T21:14:02.620
> 
> 标签：jquery, coffeescript

我正在尝试创建一个常见问题解答页面，其中一个问题在单击时变为红色，并且它的答案向下滑动，而所有其他答案向上滑动。所以在任何时候只有一个答案是开放的，只有当它打开时，它的问题才会以红色突出显示。

这可能很容易实现，但我对javascript没有太多经验......到目前为止，如果我点击不同的问题，一切都很好，但是在打开时点击同一个问题将关闭它然后重新打开它：

```
window.toggle_info = $ ->
  $('.toggle-button').click ->
    $('.toggle-button').removeClass("red-reply") unless $(this).hasClass('red')
    $('.toggle-info').slideUp("slow")
    $(this).next('.toggle-info').slideToggle("slow")
    $(this).toggleClass("red") 
```

我试过用`.not('red')` `.not('.red')` `:not('red')`各种方式`$('.toggle-info').slideUp("slow")`在线上使用，但它不起作用。

颜色切换在所有情况下都可以正常工作。

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:53:07.240

这部分：

```
$('.toggle-info').slideUp("slow")
$(this).next('.toggle-info').slideToggle("slow") 
```

适用[`slideUp`](http://api.jquery.com/slideUp/)于**所有**`.toggle-info`元素，包括`$(this).next('.toggle-info')`. 因此，您将它们全部关闭，然后单击您刚刚单击`slideToggle`的`.toggle-info`以下内容。`.toggle-button`将`slideUp`让所有这些都关闭，然后`slideToggle`将打开`.toggle-info`您刚刚关闭的。

如果您希望能够通过单击`.toggle-button`打开的面板来关闭面板，那么您可以这样做：

```
$next = $(this).next('.toggle-info');
$('.toggle-info').not($next).slideUp("slow")
$next.slideToggle("slow") 
```

该[`not`](http://api.jquery.com/not/)调用只是从将应用到`$next`的元素中删除。`slideUp`如果您想要`red`唯一的 on open `.toggle-button`s，那么您可以执行以下操作：

```
$next = $(this).next('.toggle-info');
$('.toggle-info')
  .not($next)
  .slideUp("slow")
  .prev('.toggle-button')
  .removeClass('red');
$next.slideToggle("slow")
$(this).toggleClass("red") 
```

演示：http: [//jsfiddle.net/ambiguous/TEb2A/1/](http://jsfiddle.net/ambiguous/TEb2A/1/)

我没有看到任何增加`.red-reply`的内容，所以我没有参加演示；大概你在其他地方有一些代码正在处理那个类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:26:39.900

我把这个脚本弄乱了很长时间，但当然我在这里发布 5 分钟后得到了答案：/

我将其更改为`$(this).next('.toggle-info').slideToggle("slow") unless $(this).hasClass('red-reply')`并且可以正常工作。

仍然不确定为什么它以前不起作用...

# c++ - g ++在“：”处解析错误

> ID：10841385
> 
> 赞同：8
> 
> 时间：2012-05-31T21:14:23.577
> 
> 标签：c++, qt, g++, signals-slots

`g++`使用以下代码报告解析错误：

```
class Sy_timeLineDelegateScene : public QGraphicsScene
{
    Q_OBJECT
public:
    Sy_timeLineDelegateScene( Sy_animPropertyTimeLine* timeline,
                              Sy_animClock* clock,
                              QObject* parent = nullptr );
    virtual ~Sy_timeLineDelegateScene() {}

protected slots:   // Parse error at ":"
    typedef QMap< Sy::Frame, Sy_timeLineDelegateKey* > DelegateTimeLine;
... 
```

我的类派生自`QObject`并且我`Q_OBJECT`在错误之前声明了宏，但是如果我注释掉该`slots`部分，它编译得很好。我已经使用`Qt`了多年，以前从未见过这个，它一定是愚蠢的，但我看不出是什么导致了问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T21:42:41.083

类定义中的“槽”和“信号”部分应该只包含函数；既不是类型也不是成员变量。

您应该将其移动到`typedef`公共、受保护或私有部分：

```
class Sy_timeLineDelegateScene : public QGraphicsScene
{
    Q_OBJECT
public:
    Sy_timeLineDelegateScene( Sy_animPropertyTimeLine* timeline,
                              Sy_animClock* clock,
                              QObject* parent = nullptr );
    virtual ~Sy_timeLineDelegateScene() {}

    typedef QMap< Sy::Frame, Sy_timeLineDelegateKey* > DelegateTimeLine;

protected slots:
... 
```

# jwplayer - JW 播放器“setFullscreen”

> ID：10841386
> 
> 赞同：3
> 
> 时间：2012-05-31T21:14:26.450
> 
> 标签：jwplayer

我知道这个功能（setFullscreen）只适用于 HTML5，但它不适用于我。这是我的使用方式：

```
setFullscreen: true 
```

我希望 JW Player 在页面加载后立即全屏启动。我在 android (HTML5) 上使用 chrome beta 测试它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T15:34:12.550

您可以使用 getgetFullscreen 但为了安全起见，没有 API 调用来设置全屏

这会有所帮助：

[http://www.longtailvideo.com/support/jw-player/28851/javascript-api-reference#resize](http://www.longtailvideo.com/support/jw-player/28851/javascript-api-reference#resize)

祝你好运 ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-04T06:44:46.123

也许你应该试试这个代码： [http ://www.jwplayer.com/blog/using-the-browsers-new-html5-fullscreen-capabilities/](http://www.jwplayer.com/blog/using-the-browsers-new-html5-fullscreen-capabilities/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-03T19:57:49.520

你可以使用 iframe

```
<iframe id="IVideo" runat="server" allowFullScreen="true" height="400px" width="480px"></iframe> 
```

在服务器端...调用另一个使用 Jwplayer 的页面

```
IVideo.Attributes["src"] = "Video.aspx?w=Video.mp4"; 
```

# ruby - 使用 ruby pg gem 准备好的 INSERT 语句示例

> ID：10841390
> 
> 赞同：14
> 
> 时间：2012-05-31T21:14:40.327
> 
> 标签：ruby, postgresql, pg

谷歌搜索了大约半天，我找不到任何使用 pg gem（postgresql ruby​​ gem）准备好的 INSERT 语句的样本。

我试过这个（在查看 gem 文档之后）：

```
def test2
    conn = PG.connect( dbname: 'db1' )
    conn.prepare("statement1", 'INSERT INTO table1 (id, name, profile) VALUES (?, ?, ?)')
end 
```

但我收到以下错误：

```
pgtest.rb:19:in `prepare': ERROR:  syntax error at or near "," (PG::Error)
LINE 1: INSERT INTO table1 (id, name, profile) VALUES (?, ?, ?)
                                                        ^
from pgtest.rb:19:in `test2'
from pgtest.rb:25:in `<main>' 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-31T21:24:26.173

`pg`gem 希望您使用编号占位符 ( , `$1`, `$2`...) 而不是位置占位符 ( `?`)：

```
conn = PG.connect(:dbname => 'db1')
conn.prepare('statement1', 'insert into table1 (id, name, profile) values ($1, $2, $3)')
conn.exec_prepared('statement1', [ 11, 'J.R. "Bob" Dobbs', 'Too much is always better than not enough.' ]) 
```

[精美](http://rubydoc.info/gems/pg/PG/Connection#prepare-instance_method)的手册是这样说的：

> `- (PGresult) prepare(stmt_name, sql[, param_types ])`
> [...]
> PostgreSQL 绑定参数在 SQL 查询中表示为 $1、$1、$2 等。

再次为[`exec_prepared`](http://rubydoc.info/gems/pg/PG/Connection#exec_prepared-instance_method)：

> PostgreSQL 绑定参数在 SQL 查询中表示为 $1、$1、$2 等。params 数组的第 0 个元素绑定到 $1，第一个元素绑定到 $2，以此类推。

# matlab - 在 Matlab 中扩展向量......有一些困难

> ID：10841391
> 
> 赞同：2
> 
> 时间：2012-05-31T21:14:44.377
> 
> 标签：matlab

我该如何执行以下操作：

假设我从一个包含元素 [5 3 4 9 10] 的向量开始 - 将这些数字想象成每日股票价格。我想将此向量转换为（大约）盘中股票价格 - 一天的 1/10。

因此，我的矢量应该看起来像[ **5** 4.8 4.6 4.6 4.4 .4.2 4 3.8 3.6 3.4 3.2 **3** 3.2 3.2 3.2 3.3 3.3 3.4 3.4 3.5 3.6 3.7 3.7 3.7 3.8 3.9 **4** 4.5 5 5.5 5 5.5 6 6.5 7 7.5 8 8.5 **9.1** 9.1 9.2 9.2 9.3 9.3 9.4 9.5 9.5 9.6 9.6 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9.7 9 n.9 **10** ]

谢谢你！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T21:19:58.377

帮助 interp1

您将使用“线性”插值方法。

因此，最初，您将拥有

```
x = 0:4;
y = [5 3 4 9 10]; 
```

现在，插值。

```
xnew = 0:.1:4;
ynew = interp1(x,y,xnew,'linear'); 
```

# c# - 引用外部 dll 时出现一些元组错误，无法编译 c# 项目

> ID：10841393
> 
> 赞同：1
> 
> 时间：2012-05-31T21:15:04.963
> 
> 标签：c#, .net, visual-studio-2010, tuples, sharp-snmp

当我尝试构建我的 .net 4、c# 项目时出现错误。一切都很好，但是当我添加对给定 DLL 的外部引用时，它停止工作，无法构建，抛出这种类型的一些错误：

> 错误 36 类型“System.Tuple”存在于“C:\Program Files\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0\mscorlib.dll”和“C:\Projects\Project1\ExternalRefernces\SharpSNMP\SharpSnmpLib”中.dll' C:\Projects\Project1\CheckerStore.cs 17 21

注意，我没有对新库做任何事情，只是作为参考添加。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T21:39:22.343

您可以通过指定外部别名来解决此问题。在您的项目中选择 SharpSNMP 参考。在属性窗口中更改`Aliases`为。在你的代码中输入这个`global``SharpSNMP`

```
extern alias SharpSNMP;

...

System.Tuple<T1,T2> sysTulpe;
SharpSNMP::System.Tuple<T1,T2> sharpTulpe; 
```

或者

```
extern alias SharpSNMP;

using SharpSystem = SharpSNMP::System;

...

System.Tuple<T1,T2> sysTulpe;
SharpSystem.Tuple<T1,T2> sharpTulpe; 
```

请参阅[别名：克服名称冲突第 2 部分：外部别名](http://www.davidarno.org/c-howtos/aliases-overcoming-name-conflicts-part-2-extern-alias/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T21:33:28.257

您可以做的是将目标版本更改为 3.5 或在 SharpSNMPLib 中进行一些更改。可以从[这里](https://github.com/lextm/sharpsnmplib)或[这里](http://sharpsnmplib.codeplex.com/releases)获取源代码。

您需要进行的更改是专门将 System.Tuple 类型移动到其他地方。

**编辑：**
我相信您已经添加了对预编译 DLL 的引用。一个未针对框架版本 4 编译的 DLL。您需要做的是下载源代码（参见上面的链接）并使用目标版本 4 编译项目。

为什么需要这样做是因为有条件构建参数取决于框架目标版本。SharpSNMPLib System.Tuple 用于版本 <= 3.5，框架 System.Tuple 用于版本 >= 4。

**编辑：**

*   使用框架 System.Tuple 和 SharpSNMPLib.dll 重现了您的问题。

*   成功构建针对版本 4 的 SharpSNMPLib。

*   使用框架 System.Tuple 和新的 SharpSNMPLib.dll 成功构建应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:17:39.753

只需转到您的`CheckerStore.cs`文件，第 1721 行（如果我是对的）。找到`Tuple`类，并使用它的**完全限定名称**来引用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T21:34:11.977

出于某种原因，该库重新实现了某些系统类型。可能的原因是在使用旧版本的框架时使代码在源代码级别兼容。

很可能有这个 SharpSNMP 库的一个版本可以与 4.0 框架一起使用。检查您的源代码树中是否已正确打开。与库的创建者一起检查您需要使用给定框架版本的程序集版本以及推荐的执行方式。

# map - 设置煎茶触摸地图位置

> ID：10841399
> 
> 赞同：0
> 
> 时间：2012-05-31T21:15:53.640
> 
> 标签：map, touch, extjs

## 设置煎茶触摸地图位置

大家好，我想简单地将 Sencha Touch 2 地图对象设置为特定的邮政编码。我将配置设置为 {useCurrentLoction: true} 工作正常，但经过数小时的研究，我似乎无法找到一种方法来告诉地图对象重新定位到另一个城市，或地址或特别是邮政编码的其他地方我们。

看起来 Google API 具有这些功能，但其中包括：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script> 
```

无法识别 Google 在其文档中使用的 api 调用。谷歌说要获取 API 访问密钥，但这需要从多个位置运行，所以我希望在不需要获取密钥的情况下实现这一点。

有没有人能够使用上面访问的 API (maps.google.com/maps/api/js?sensor=true) 重新定位 Sencha Touch 2 地图对象？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T07:28:26.630

只需包含`<script src="http://maps.google.com/maps/api/js?sensor=true"></script>`在您的 HTML 文件中

然后在您的视图中创建一个 xtype 映射，然后在侦听器中添加一个像这样绘制的事件：

```
listeners: 
{
    painted: function( component, eOpts ) {
        console.log("Entered paint");
        gotoAddress();
        var map = Ext.getCmp('mymap');
        map.setMapCenter(addr);
    }
}  

// Location function add the parameter as desired address to navigate.
// This also includes showing mapper and info window

function gotoAddress() {

    var address = "enter the address required";
    var map = Ext.getCmp('mymap');

    var geocoder = new google.maps.Geocoder();    
    geocoder.geocode( { 'address': address}, function(results, status) {      
        if (status == google.maps.GeocoderStatus.OK) {

            addr= results[0].geometry.location;
            map.setMapCenter(results[0].geometry.location);

            marker.setMap(map.getMap());
            marker.setPosition(results[0].geometry.location);

            infowindow.setContent(address);

            infowindow.open(map.getMap(),marker);

        } else {
          alert('Sorry Address could not be traced: ' + status);
        }
    });
} 
```

注意：Paint 是每次您导航到使用地图的页面时都会调用的事件。当你创建这个页面时，初始化事件只会被创建一次。

# jquery - 带有未确定表的jquery treeTable

> ID：10841406
> 
> 赞同：0
> 
> 时间：2012-05-31T21:16:26.307
> 
> 标签：jquery, treetable

我非常密切地关注[http://ludo.cubicphuse.nl/jquery-plugins/treeTable/doc/](http://ludo.cubicphuse.nl/jquery-plugins/treeTable/doc/)，效果很好，但似乎我必须已经在 HTML 中有一个表格。我想稍后在程序中构建一个表，然后通过 treeTable 运行它以获得可扩展视图。当我摆脱“$（document）.ready（function（）”并将其替换为常规函数，然后在构建表后调用该函数时，视图无法正常工作。

```
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="jquery/jquery.js"> </script>

    <link href="./jquery/jquery.treeTable.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="./jquery/jquery.treeTable.js"></script>
    <script type="text/javascript">
    function init() {
        createTable();

        $("#pathTable").treeTable();
      }
    </script>

    <script type="text/javascript">
        function createTable() {
            document.write('<table id="pathTable"><tbody>');
            document.write('<tr id="node-0"><td>node0</td></tr>');
            document.write('<tr id="node-1" class="child-of-node-0">');
            document.write('<td>node1</td></tr>');
            document.write('<tr id="node-2" class="child-of-node-1">');
            document.write('<td>node2</td></tr>');  
            document.write('</tbody></table>');             
        }
    </script>
</head>
<body onload="init()">
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:19:46.697

回答我自己的问题：

事实证明 document.write() 没有写入 DOM，所以我无法对表格做任何进一步的事情。

我发现[这里](http://www.sitepoint.com/insert-in-place-without-documentwrite/)有一个有用的网站可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-16T22:35:11.800

我使用此代码

```
//Add format to the table 
$("#FormsAffected-Expandable").treetable({ expandable: true , force :true }); 
```

只创建你的表并添加这句话，#name 控件是你的 Div 的名称。

# javascript - 自 4 月 13 日以来的破损跳出率统计数据

> ID：10841407
> 
> 赞同：2
> 
> 时间：2012-05-31T21:16:31.247
> 
> 标签：javascript, google-analytics, event-tracking

我们正在为流量巨大的网站使用 Google Analytics。自过去 50 天（从 4 月 13 日开始）以来，我们遇到了一些有趣的——而且肯定不是好的——统计数据变化。跳出率翻了一番，我们的“网站停留时间”价值减少了大约 5 分钟，并且唯一访问者数量出乎意料地增加了非常高。此外，我们的浏览量统计数据没有变化。我们正在调查此问题的原因几天。我们知道，这些症状表明我们存在关于用户会话的问题。我们在我们网站的某个地方丢失了用户的分析会话。我们得到一个提示：

我们注意到，自 50 天以来，我们的搜索页面的“着陆页”价值增加了​​ 2.5 倍。我们正在使用 _trackEvent 方法来跟踪搜索页面上的一些用户交互。当我们跟踪谷歌分析的 utmb cookie（我们知道，它存储用于分析的用户会话）时，我们注意到，当我们跟踪事件时，utmb cookie 的值会发生变化。

那么，问题是，跟踪 utmb cookie 的事件更改是否正常？这个问题可能是我们生活的原因吗？

### 更新

我们在我们的服务器上使用 ga.js 作为自托管。我们的跟踪代码非常简单：

```
_gaq.push(['_setAccount', 'UA-235XXX-1']);
_gaq.push(['_setDomainName', '.ourdomain.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_trackPageview']); 
```

### 更新 2

我们删除了 setAllowHash 参数并开始在 google 上托管 ga.js 作为默认使用。问题仍在继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T15:17:29.337

我有完全相同的问题。它也开始于 2012 年 4 月 14 日，跳出率上升，新访问量也增加，缩短网站停留时间并降低每次访问的页面数......页面浏览量保持不变，这意味着由于某种原因，用户正在“丢失”__utma cookie，这是负责任的用于跟踪用户是唯一的。

我通过 GA 发现了一件有趣的事情——在我的情况下，Opera 11.64 没有出现这个问题。它保持其先前约 14% 的跳出率值。其他浏览器（主要是 Firefox 和 Chrome 的新版本）一飞冲天（跳出率为 65-90%）。

我说的是一个拥有数十万访问量的网站......明天我会尝试改变一些东西，如果我发现任何有用的东西就回帖。

更新

我已将代码更新为新代码

```
<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'XX-XXXXXXXX-X']);
    _gaq.push(['_setDomainName', 'example.com']);
    _gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script> 
```

而不是旧的

```
<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
    var pageTracker = _gat._getTracker("XX-XXXXXXXX-X");
    pageTracker._setDomainName(".example.com");
        pageTracker._trackPageview();
} catch(err) {}</script> 
```

不同之处`_setDomainName`在于，在新代码中，域名中没有前导点（。），旧代码似乎存在问题。我必须补充一点，我对没有部分的其他网站没有任何问题`_setDomainName`，并且仍在运行旧代码。我还发现了一篇关于同样问题的博客文章：http: [//diegoscataglini.com/2010/08/17/118/google-analytics-setdomain-beware/](http://diegoscataglini.com/2010/08/17/118/google-analytics-setdomain-beware/)

不管怎样，现在一切都恢复正常了。跳出率回到 11%，网站停留时间和页面/访问次数增加。当您更改代码时，将为所有用户重新创建 cookie，使他们成为直接访问您网站的新访问者。在一两天内（取决于访问次数），当人们像往常一样使用您的网站时，统计数据就会恢复正常。

我不得不等待几天才能报告回来，我希望这也能解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T07:00:27.290

想一想，这可能是由于流行的浏览器突然支持“不跟踪”或 GA 突然尊重该设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T22:04:51.730

更新 utmb cookie 是 _trackEvent 的预期行为——来自[Event Tracking API 文档](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEventTracking#_gat.GA_EventTracker_._trackEvent)：

> 默认情况下，_trackEvent() 发送的事件命中会影响访问者的跳出率。

丢失会话数据的一个地方是子域——例如，如果您的站点上混合有 www.domain.com 和 domain.com 链接。如果您还没有使用它，您可以尝试在 _trackPageview 调用之前添加 _setDomainName：

```
_gaq.push(['_setDomainName', '.yourDomain.com']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T02:06:56.147

这很正常。utmb cookie 存储会话的点击计数，当您跟踪事件或网页浏览时，点击计数增加一。

这在 GA 内部用于控制一些限制。

一旦此计数器达到 500，它将不再为该会话发送任何命中。分析中的每个会话只能有 500 次点击。

**更新：2012-06-12**

根据您发布的代码，我有一些担忧：

*   你*永远不*应该自托管 ga.js。随着新功能添加到 GA，此文件会发生更改。这可能会解释跳出率的变化，也可能不会。您可能发送的数据不再是 ga 所期望的，因为他们可能稍微更改了协议。
*   `_setAllowHash`现在已弃用。如果您现在正在使用，则应该继续使用它，但如果您有任何页面没有该调用，则可能会导致 cookie 被重置。因此，如果您的所有页面都使用它，请保持这种状态，如果某些页面使用而某些页面不使用，则删除并确保不再有单个页面具有它。您需要与 GA 设置保持一致。

# c - 如何模拟内存 I/O 设备以在 linux 上进行单元测试？

> ID：10841410
> 
> 赞同：3
> 
> 时间：2012-05-31T21:16:40.567
> 
> 标签：c, linux, memory-mapping

如何在 Linux 上模拟内存 I/O 设备以进行单元测试？

我正在为嵌入式部署的一些源代码编写单元测试。

该代码正在访问特定的地址空间以与芯片进行通信。

*   我想在 Linux 上对这段代码进行单元测试（UT）。
*   单元测试必须能够在没有人为干预的情况下运行。
*   我需要以普通用户身份运行 UT。
*   必须被测试的代码必须完全是在目标系统上运行的源代码。

关于如何解决这个问题的任何想法？

普通用户能否以某种方式告诉 MMU 必须在特定地址进行特定的内存分配。或者说一个数据块必须在一个特定的内存区域？

据我了解：

*   无法使用 sigsegv；因为从处理程序返回后，将再次调用相同的内存访问代码并再次失败。（或者偶然内存区域实际上可能有有效数据，只是不是我想要的）

    谢谢

    亨利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:22:37.760

首先，使要读取的地址成为代码的注入依赖项，而不是硬编码的依赖项。现在您不必担心测试条件下的位置，它可以是您喜欢的任何位置。

然后，您可能还需要注入一个函数来读取/写入魔术地址作为依赖项，具体取决于您正在测试的内容。现在您不必担心它会如何欺骗正在测试的代码，使其认为它正在执行 I/O。您可以存根/模拟/任何硬件 I/O 行为。

在您描述的条件下测试低级代码非常困难，同时在非测试模式下也保持超高效，因为您不想引入太多间接级别。

不过，“正是源代码”可以隐藏许多罪恶，这取决于您如何解释它。例如，您的“依赖注入”可能是通过宏，因此单元源是“相同的”，但您已经完全改变了它使用偷偷摸摸的`-D`编译器选项所做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:46:17.573

AFAIK 你需要创建一个块设备（我不确定字符设备是否可以工作）。创建一个将该内存范围映射到自身的内核模块。创建读/写函数，因此每当触及该内存范围时，就会调用这些读/写函数。

向内核注册这些读/写功能，以便每当对这些地址进行读/写时，都会调用内核并由内核代表用户执行读/写功能。

# java - 通知一个从其中一个线程生成一些线程的类 - Java

> ID：10841416
> 
> 赞同：0
> 
> 时间：2012-05-31T21:17:00.707
> 
> 标签：java, multithreading

我有一个关于 java 中的多线程的问题。我正在模拟一个链接，其中我有一个生成器、一个缓冲区和一个接收器。所有这些都是使用套接字在它们之间进行通信的独立程序。这工作得很好，但我的缓冲区有点问题。我想通过以下方式模拟一个严格优先级队列，我有两个队列，一个具有高优先级，一个具有低优先级，因此，我有两个缓冲区。我在 BufferContainer 中有这两个，并且 bot 是独立的线程，因为它们每个都从不同的生成器接收数据。问题是我只有一个调度程序，它根据优先级决定将哪些数据包传输到接收器。它似乎正在工作，但我在停止程序时遇到了问题。buffer容器生成两个不同的Buffers和Scheduler。这是三个不同的线程，我需要知道调度程序什么时候完成他的任务。但我不知道该怎么做。这就是我尝试过的：

```
 import java.io.BufferedWriter;
    import java.io.FileWriter;
    import java.io.IOException;

    public class BufferContainer {

    private Buffer buffer0;
    private Buffer buffer1;
    private Scheduler scheduler;
    private Queue[] queue;
    private Queue q1;

    public BufferContainer (int inPort0, int outPort, long queueSize0, double serviceRate0, 
            int inPort1, long queueSize1, double serviceRate1){
        try {
            /*Some code here*/

            //Scheduler separated thread
            this.scheduler = new Scheduler(this.queue, serviceRate0, 
                   serviceRate1, outPort, outLog0, outLog1);
            //start the scheduler
            this.scheduler.start();

            //Buffers separated threads
            this.buffer0 = new Buffer(inPort0, queueSize0, this.queue[0], outLog0); 
            this.buffer1 = new Buffer(inPort1, queueSize1, this.queue[1], outLog1); 
            //start the buffers
            this.buffer0.start();
            this.buffer1.start();

            /*Some code here*/

            while (true){
                if(this.scheduler.schedulerTerminated()){
                        //Some code here
                        this.scheduler.stop();
                        break;
                    }
                    /*Some code here*/
                }
            }
            //stop Buffers
            this.buffer0.stop();
            this.buffer1.stop();

            /*Some code here*/
        } catch (IOException ex) {
        }
    }

    public static void main(String[] args){
           BufferContainer buf = new BufferContainer(Integer.parseInt(args[0]), Integer.parseInt(args[1]),
                Long.parseLong(args[2]), Double.parseDouble(args[3]), Integer.parseInt(args[4]), 
                Long.parseLong(args[5]), Double.parseDouble(args[6]));
    }
} 
```

我只需要知道调度程序何时结束，并且调度程序内部有一个布尔值，当它发生时设置为 true，我尝试在外部使用 while(true) 来持续检查此变量并在需要时停止调度程序，但是它不工作。关于如何从调度程序通知缓冲区容器的任何想法？

**更新**

我已经测试了挥发性溶液，但它不起作用。我认为也许我无法在调度程序运行时检查变量。这是我的调度程序的样子：

```
import java.io.BufferedWriter;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.InetAddress;
import java.net.Socket;
import java.util.Random;

public class Scheduler implements Runnable{

    Thread th;
    private double serviceRateHigh, serviceRateLow;
    private DataOutputStream wr;
    private BufferedWriter log0, log1;
    private Socket socket;
    private String packet;
    private Queue highPrioQueue, lowPrioQueue;
    //Es possible que es mdifiqui per diferents threads
    private volatile boolean shouldStop, schedulerTerminated, buffer0Terminated, buffer1Terminated;

    public Scheduler(Queue[] queue, double serviceRateHigh, double serviceRateLow, 
            int port, BufferedWriter log0, BufferedWriter log1){

        //Creem el thread
        this.th = new Thread(this);
        //Guardem les dues cues
        this.setQueues(queue);
        this.log0 = log0;
        this.log1 = log1;
        //Guardem els dos service rate
        this.serviceRateHigh = serviceRateHigh; 
        this.serviceRateLow = serviceRateLow;
        this.shouldStop = false;
        this.schedulerTerminated = false;
        this.buffer0Terminated = false;
        this.buffer1Terminated = false;
        //Socket y buffer de escriptura
        try {
            this.socket = new Socket(InetAddress.getByName("127.0.0.1"), port);
            this.wr = new DataOutputStream(this.socket.getOutputStream());
        } catch (IOException e) {
        }
    }

    //Iniciar el thread
    public void start(){
        this.th.start();
    }

    //Parar el thread
    public void stop(){
        this.shouldStop = true;
    }
    //When both buffer have notified we can terminate the scheduler
    public synchronized boolean schedulerTerminated(){
        if (this.buffer0Terminated && this.buffer1Terminated)
            this.schedulerTerminated = true;

        return this.schedulerTerminated;
    }

    public synchronized void setBufferTerminated(int n){
        if(n == 0) this.buffer0Terminated = true;
        if(n == 1) this.buffer1Terminated = true;
    }

    //Assigna les cues de alta i baixa prioritat
    private void setQueues(Queue[] queue){
        char prio;
        for (int i = 0; i < queue.length; i++){
            prio = queue[i].getPrio();
            if (prio == 'H')
                this.highPrioQueue = queue[i];
            else{ 
                if (prio == 'L')
                    this.lowPrioQueue = queue[i];
            }      
        }
    }

    //Notifica al thread per a que es desperti
    synchronized public void resume(){
        notify();
    }

    protected void sendLastPacketNumberToSink(int pl0, int pl1) {           
        String datagram = "BYE" + " " + pl0 + " " + pl1;
            try {
                wr.writeBytes(datagram + '\n');
            }catch (IOException e) {}
    }

    //Proces principal del thread
    @Override
    public void run(){
        while(!shouldStop){
            //Creem un generador de nombres aleatoris
            Random ran = new Random();
            //generem un nombre aleatori entre 0 i 1
            double uniform = ran.nextDouble();

            if(!this.highPrioQueue.isEmpty()){ //Cua de alta prioritat NO buida   
                //convertim a exponencial
                double sleeptime = Math.log(1-uniform)/(-this.serviceRateHigh);
                try{
                    this.th.sleep(Math.round(sleeptime*1000));
                }catch(InterruptedException e){
                }
                    //Enviem el paquet de la cua de alta prioritat
                try {
                    if ((this.packet = this.highPrioQueue.nextPacket()) != null){
                            this.wr.writeBytes(this.packet + '\n');
                            log0.write("\nScheduler: Paquet [" + packet + "] enviat desde la cua high\n");
                            log1.write("\nScheduler: Paquet [" + packet + "] enviat desde la cua high\n");
                        } 
                }catch (IOException e) {
                }
            }
            else { 
                if (!this.lowPrioQueue.isEmpty()){//Cua de alta prioritat buida
                    //convertim a exponencial
                    double sleeptime = Math.log(1-uniform)/(-this.serviceRateLow);
                    try{
                        this.th.sleep(Math.round(sleeptime*1000));
                    }catch(InterruptedException e){
                    }
                    //Enviem el paquet de la cua de baixa prioritat
                    try {
                        if ((this.packet = this.lowPrioQueue.nextPacket()) != null){
                                this.wr.writeBytes(this.packet + '\n');
                                log0.write("\nScheduler: Paquet [" + packet + "] enviat desde la cua Low\n");
                                log1.write("\nScheduler: Paquet [" + packet + "] enviat desde la cua Low\n");
                        }
                    }catch (IOException e) {
                    }
                }
            }
        }   
    }
} 
```

我不确定是否可以在 run 方法当前正在运行时调用调度程序中的方法。如果发生这种情况，就会出现错误。

谢谢！

# couchdb - 测试套件中的 CouchDB 性能缓慢

> ID：10841419
> 
> 赞同：1
> 
> 时间：2012-05-31T21:17:18.777
> 
> 标签：couchdb

我有一个运行 Centos 6 的新服务器，它有 6 个内核和 16 GB RAM 等。

在此服务器中，我只安装 CouchDB，按照以下安装说明进行操作：

[http://wiki.apache.org/couchdb/Installing_on_RHEL5](http://wiki.apache.org/couchdb/Installing_on_RHEL5)

我运行测试套件并且速度极慢，例如“基础”在 30,000 毫秒内

我在“CouchDB：权威指南”一书中看到，（第 24 页）在 652 毫秒内进行了相同的测试！

我做错了什么？？

# php - AJAX 登录表单：未定义的 PHP 变量

> ID：10841424
> 
> 赞同：2
> 
> 时间：2012-05-31T21:17:35.157
> 
> 标签：php, jquery, mysql, ajax, login

我在使用 ajax 登录表单时遇到问题。我从 ajax 收到一个错误，说我的 login_check.php 文件中的用户名和密码变量未定义。然而，当我将变量初始化为空白时，错误就消失了。问题是，当我将变量初始化为空白时，即使我在登录框中输入了正确的信息，它也不会让我登录。我确定问题很小，但我就是看不到。我只需要 PHP 和 AJAX 一起工作，然后我就完成了。提前致谢。

login_check.php

```
<?php
require_once 'config.php';
require_once 'login.class.php';
$error = NULL;
$success = FALSE;

$username = $_POST['username'];
$password = $_POST['pass'];

$login = new Login();
//Connect to MYSQL Database server
$connect = mysql_connect(DB_HOST, DB_USER, DB_PASS) or die("Could not connect to MYSQL Database.");
$result = mysql_select_db(DB_NAME, $connect) or die("Could not connect to MYSQL table.");

//Clean Data to prevent malicous injections
$username = mysql_real_escape_string(strip_tags(stripcslashes(trim($_POST['username']))));
$password = $login -> encrypt(mysql_real_escape_string(strip_tags(stripcslashes(trim($_POST['pass'])))));

$sql = mysql_query("SELECT * FROM admin WHERE username = '$username' AND password = '$password'") or die("Query to database failed.");
$numrows = mysql_num_rows($sql);

$row = mysql_fetch_array($sql);
if ($numrows > 0) {
    session_start();
    $_SESSION['username'] = $row['username'];
    $success = TRUE;
    echo json_encode(array("success" => "Login successful."));

} else {

    $success = FALSE;
    echo $error = 'Invalid username or password!';
    echo json_encode(array("error" => "Invalid username or password! (PHP response)"));

}
?> 
```

查询文件

```
$('#login_form').submit(function(e) {

        e.preventDefault();

        var username = $('.username').val();
        var password = $('.password').val();

        $.ajax({
            type : "POST",
            url : "includes/login_check.php",
            data : "Username=" + username + "&Password=" + password,
            dataType : 'json',
            cache : false,
            success : function(data) {
                if(data.error) {
                    $('.login div.error').show().html(data.error);

                } else {
                    $('.login div.success').show().html(data.success);
                }

                //return false;

            },
            error : function(jqXHR, textStatus, errorThrown) {
                alert("error " + textStatus + ": " + errorThrown);
            },
            beforeSend : function() {
                $(".load").html("Loading...");
            }
        });

    }); 
```

顺便说一句，来自 AJAX 的错误是：

**错误解析器错误：SyntaxError：JSON.parse：意外字符**

再次感谢各位朋友。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:20:37.990

几个问题：

这：

```
$username = $_POST['username'];
$password = $_POST['pass']; 
```

应该是这样的：

```
$username = $_POST['Username'];
$password = $_POST['Password']; 
```

这些键必须与您在此处指定的参数匹配：

```
data : "Username=" + username + "&Password=" + password, 
```

...甚至应该更改为：

```
data : {"Username":username,"Password":password}, 
```

此行正在生成无效的 JSON：

```
echo $error = 'Invalid username or password!'; 
```

我想你的意思是写这个？

```
$error = 'Invalid username or password!'; 
```

**编辑＃1：**

此外，这一行必须是 PHP 代码中的第一件事：

```
session_start(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:27:43.263

首先，这样做的目的是什么：

```
$username = $_POST['username'];
$password = $_POST['pass']; 
```

稍后在您的脚本中，您会这样做吗？

```
$username = mysql_real_escape_string(strip_tags(stripcslashes(trim($_POST['username']))));
$password = $login -> encrypt(mysql_real_escape_string(strip_tags(stripcslashes(trim($_POST['pass']))))); 
```

您正在*获取 POST 数据两次*。相反，使用`$username`and `$password`。不要忘记检查它们是否存在于 POST 数组中。使用不存在的数据可能会产生意想不到的结果。

* * *

然后，这部分代码也会出现错误。您正在回显无效的 JSON。

```
echo $error = 'Invalid username or password!';
echo json_encode(array("error" => "Invalid username or password! (PHP response)")); 
```

在返回的数据中看起来像这样：

```
Invalid username or password!{"error":"Invalid username or password! (PHP response)"} 
```

删除第一个回声

* * *

POST 数组对应于您在 AJAX 调用中传递的查询字符串/数据。所以：

```
data : "Username=" + username + "&Password=" + password, 
```

是：

```
$username = $_POST['Username'];
$password = $_POST['Password']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:27:15.780

删除或注释掉这一行：

```
 echo $error = 'Invalid username or password!'; 
```

并添加`header('Content-Type: application/json');`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T21:23:49.820

用户名！= 用户名和密码！= 通过 :-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T21:29:06.957

如果您可以获得返回内容的副本（应该能够调试错误），然后将其粘贴到[http://jsonlint.com/](http://jsonlint.com/)，它应该有助于追踪 JSON 语法错误。

# sql - Oracle：在函数中返回多个值

> ID：10841430
> 
> 赞同：5
> 
> 时间：2012-05-31T21:17:50.770
> 
> 标签：sql, oracle, function, plsql, views

我正在尝试从使用两个表（员工和部门）的函数中返回 %rowtype 中的多个值，但它对我不起作用。

```
create or replace function get_employee
 (loc in number)
return mv_emp%rowtype
as  
   emp_record mv_emp%rowtype;
begin
   select a.first_name, a.last_name, b.department_name into emp_record 
   from employees a, departments b 
   where a.department_id=b.department_id and location_id=loc;

   return(emp_record);  
end; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-31T21:43:58.797

上面的函数编译没有任何错误？是什么类型的`MV_EMP`？理想情况下，它应该如下所示。

```
create or replace type emp_type
(
first_name varchar2(20)
, last_name varchar2(20)
, depart_name varchar2(20)
)
/
create or replace function get_employee
 (loc in number)
return emp_type
as  
   emp_record emp_type;
begin
   select a.first_name, a.last_name, b.department_name into emp_record 
   from employees a, departments b 
   where a.department_id=b.department_id and location_id=loc;

   return(emp_record);  
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T17:06:20.107

```
create type t_row as object (a varchar2(10));

create type t_row_tab as table of t_row; 
```

我们现在将创建一个拆分输入字符串的函数。

```
create or replace function get_number(pv_no_list in varchar2) return t_row_tab is
lv_no_list t_row_tab := t_row_tab();
begin

  for i in (SELECT distinct REGEXP_SUBSTR(pv_no_list, '[^,]+', 1, LEVEL) no_list FROM dual
  CONNECT BY REGEXP_SUBSTR(pv_no_list, '[^,]+', 1, LEVEL) IS NOT NULL)
  loop
  lv_no_list.extend;
  lv_no_list(lv_no_list.last) := t_row(i.no_list);
  end loop;

  return lv_no_list;

end get_number; 
```

一旦函数到位，我们就可以使用 sql 语句的 table 子句来获得所需的结果。根据需要，我们从函数返回了多个值。

```
SQL> select * from table(get_number('1,2,3,4'));

A
----------
1
3
2
4 
```

所以现在我们的函数只是表现得像一张桌子。在某些情况下，您希望这些逗号分隔值成为“IN”子句的一部分。

例如 ：

```
select * from dummy_table where dummy_column in ('1,2,3,4'); 
```

但上述查询将不起作用，因为 '1,2,3,4' 是一个字符串而不是单个数字。要解决此问题，您可以简单地使用以下查询。

```
select * from dummy_table where dummy_column in ( select * from table(get_number('1,2,3,4')) ); 
```

参考：[http ://www.oraclebin.com/2012/12/returning-multiple-values-from-function.html](http://www.oraclebin.com/2012/12/returning-multiple-values-from-function.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-26T15:40:36.657

```
CREATE OR replace FUNCTION Funmultiple(deptno_in IN NUMBER)
  RETURN NUMBER AS v_refcursur SYS_REFCURSOR;
  BEGIN
    OPEN v_refcursor FOR
    SELECT *
    FROM   emp
    WHERE  deptno = deptno_in;

    retun v_refcursor;
  END; 
```

要调用它，请使用：

```
variable x number
exec :x := FunMultiple(10);
print x 
```

# iphone - 调用 UIViewController 的另一个视图不起作用

> ID：10841431
> 
> 赞同：2
> 
> 时间：2012-05-31T21:17:53.507
> 
> 标签：iphone, ios, uiviewcontroller

我试图在预期时间后加载 UIViewController 的另一个笔尖。一切正常，但是当我加载 UIViewController 时，它被调用时出现异常。我是这样做的：

```
UIViewController *overView = [[UIViewController alloc] initWithNibName:@"overView2" bundle:nil];

[super presentViewController:overView animated:YES completion:nil]; 
```

我还尝试插入 [NSBundle mainBundle] 而不是“nil”，但仍然发生异常。当我在下面推送 UIViewController 时，没有发生异常，但是在删除第一个视图后没有任何事情发生：

```
[self.parentViewController addChildViewController:overView]; 
```

我搜索了很长时间，但找不到解决方案...

* * *

解决方案

我刚刚发现了错误。

我在要加载新视图的 M 文件中导入了 UIViewController 的 H 文件。然后我创建了一个新对象并将其传递。

```
overView2 *overView = [[overView2 alloc] init];
[self presentViewController:overView animated:YES completion:nil]; 
```

对不起，我是objectiv-c的新手......也许也会帮助其他一些初学者：P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:20:44.000

呈现视图控制器的标准实现是：

```
[self presentViewController:overView animated:YES completion:nil]; 
```

除非我错过了什么。你有更多的信息可以提供吗？

# svn - *.edited 文件在合并期间创建

> ID：10841432
> 
> 赞同：3
> 
> 时间：2012-05-31T21:17:55.387
> 
> 标签：svn, ubuntu, meld

我在 Ubuntu 上添加了外部合并工具 (meld) 来颠覆。一切正常，但是当我解决冲突并接受更改时，我看到正在创建的文件已合并，并附加了“.edited”。因此，如果我合并了文件 test.txt，我会在 test.txt 中获得合并更改，并且文件创建的 test.txt.edited 会出现合并冲突。

有谁知道谁创建了这个文件并且它的创建可以被禁用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-27T23:36:53.087

该文件是由颠覆创建的。看到[这个答案](https://stackoverflow.com/a/13256469/496321)。

我的猜测是，当您编辑最终文件时会发生这种情况，但您最终选择了 mine-conflict、 theirs-conflict、 mine-full 或 theirs-full。

你也可以检查[这个线程](http://subversion.1072662.n5.nabble.com/When-does-update-merge-conflict-produce-edited-file-td175590.html)。

# templates - TYPO3：未找到子部分？

> ID：10841436
> 
> 赞同：0
> 
> 时间：2012-05-31T21:18:27.650
> 
> 标签：templates, typo3, typoscript

我正在尝试修改 TYPO3 中的模板，我可以修改页面的某些部分，但不能修改更深 1 级的其他部分。例如 ：

**HTML**

```
<body>
...
<div class="wrapper">
   ...
   <div id="content-right">
      <div id="colRight">
         <div id="metaNav"></div>
      </div>
   </div>
   ...
</div>
...
</body> 
```

**排版**

```
page.10.subparts {
  colRight = HMENU
  colRight.wrap = <ul>|</ul>
  colRight.special.value = 6, 7, 8, 9
  colRight.1 = TMENU
  colRight.1 {
    noBlur = 1
    NO = 1
    NO {
      allWrap = <li>|</li>
    }
  }
} 
```

但是，如果我更改`colRight`为`metaNav`（因为这是我们想要链接的位置，因此我们可以在其中放置其他内容`colRight`），什么也不会发生；不显示任何内容。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T23:06:55.207

当您将其映射到`#colRight`并且在将其映射到其子级时遇到问题时，`div`您只需将 HTML 标记添加到元素的`wrap`：

```
page.10.subparts {
  colRight = HMENU
  colRight.wrap = <div id="metaNav"><ul>|</ul></div>
  // etc...      
} 
```

使用规则 #1：*在 TS 中，每一种方式都是获得立竿见影的**最佳解决方案 :)***

**编辑**

如果你需要在一个 HTML 标签下渲染许多不同的元素，你也可以使用`COA`element 来跨越它们：

```
page.10.subparts {
  colRight = COA
  colRight {
      10 = HMENU
      10 {
          wrap = <div id="metaNav"><ul>|</ul></div>
          // etc...
      }

      20 = TEXT
      20 {
          value = my text in #colRight right after #metaNav
          wrap = <div class="containerAfterMetsNav">|</div>
      }

  }

} 
```

# objective-c - NSOutlineView 选择不起作用

> ID：10841441
> 
> 赞同：1
> 
> 时间：2012-05-31T21:18:46.010
> 
> 标签：objective-c, cocoa, nsoutlineview

我有一个带有自定义数据源的 NSOutlineView（我不知道这是否相关）。

我只有一列（同样，我不知道这是否相关）并且我想在单元格选择时执行特定操作，所以我认为我应该覆盖 outlineViewSelectionDidChange。这就是我所做的：

```
-(void)outlineViewSelectionDidChange:(NSNotification *)notification
{
    NSLog(@"selection changed");
} 
```

但这不起作用。我一直在 IB 中使用大纲视图、表格列和文本字段单元格属性，但到目前为止我还没有运气。我不知道我是否更改了导致这种情况的任何属性，或者这是否特定于我的特定实现。

那么，有人知道我可能会错过什么吗？

编辑：以防我误解了 OutlineView 中的选择概念，如果我只是单击展开箭头区域之外的文本，我希望单元格被选中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:40:59.310

经过长时间的斗争，就像往常一样，在我发布我的问题之后，我找到了答案。问题是我在 NSPanel 中使用 NSOutlineView 并且不知何故 NSPanel 不允许选择单元格。如果我只是将 NSOutlineView 移动到 NSWindow 它会按预期工作。

# javascript - 如何在树状图示例中将标签放在边缘？

> ID：10841442
> 
> 赞同：10
> 
> 时间：2012-05-31T21:18:48.890
> 
> 标签：javascript, d3.js, label, dendrogram, edges

给定一个像[Dendrogram](http://mbostock.github.com/d3/ex/cluster.html)示例（[来源](http://mbostock.github.com/d3/ex/cluster.js)）这样的树形图，如何将标签放在边缘上？绘制边缘的 JavaScript 代码如下所示：

```
var link = vis.selectAll("path.link")
    .data(cluster.links(nodes))
  .enter().append("path")
    .attr("class", "link")
    .attr("d", diagonal); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-31T21:33:08.507

D3 的作者 Mike Bostock 非常慷慨地帮助了以下解决方案。为 g.link 定义一个样式；我刚刚复制了 g.node 的样式。然后我用以下代码替换了“var link =....”代码。x 和 y 函数将标签放置在路径的中心。

```
var linkg = vis.selectAll("g.link")
    .data(cluster.links(nodes))
    .enter().append("g")
    .attr("class", "link");

linkg.append("path")
    .attr("class", "link")
    .attr("d", diagonal);

linkg.append("text")
    .attr("x", function(d) { return (d.source.y + d.target.y) / 2; })
    .attr("y", function(d) { return (d.source.x + d.target.x) / 2; })
    .attr("text-anchor", "middle")
    .text(function(d) {
        return "edgeLabel";
    }); 
```

理想情况下，文本函数应该为每条边提供一个专门的标签。在准备数据时，我用边缘的名称填充了一个对象，所以我的文本函数如下所示：

```
 .text(function(d) {
        var key = d.source.name + ":" + d.target.name;
        return edgeNames[key];
    }); 
```

# android - 扩展一个实现 Parcelable 的类

> ID：10841449
> 
> 赞同：14
> 
> 时间：2012-05-31T21:19:27.663
> 
> 标签：android, parcelable

我有一个类，我们称之为 A 类，它实现了 Parcelable。

我有第二个类，我们称之为 B 类，它扩展了 A 类。

我的问题是：

如何将 B 类的成员变量写入 Parcel，然后将其父类（即：A 类）的成员变量写入 Parcel（并随后将它们读入）？

不需要重写 A 类的包裹代码有什么妙招吗？还是我只需要重写 A 类中的 Parcel 代码并为 B 类的成员变量添加额外的代码？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-31T21:24:33.097

> 如何将 B 类的成员变量写入 Parcel，然后将其父类（即：A 类）的成员变量写入 Parcel

B`writeToParcel()`类从 A 类覆盖，链接到超类，并将其自己的对象添加到`Parcel`.

> （并随后读入）？

B 类`public static final Parcelable.Creator<MyParcelable> CREATOR`以这样一种方式实现，它可以让两个类都读取它们的内容。如果您采用在 B 类上创建一个以 a`Parcel`作为构造函数参数的构造函数的方法，只需链接到超类构造函数（让 A 类执行它的工作），然后读取 B 类的数据。

关键是要以相同的顺序执行它们。如果您打算让 A 类先读取其数据，则 A 类必须先写入其数据。

> 不需要重写 A 类的包裹代码有什么妙招吗？

继承和链接到超类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-02-22T17:55:09.330

添加一个例子，标记的答案确实是正确的，但是更直观的东西似乎更适合这种情况：

这将是晚餐课程：

```
public class BasePojo implements Parcelable {

    private String something;

    //what ever other constructor

    //getters and setters

    protected BasePojo(Parcel in) {
        something = in.readString();
    }

    public static final Creator<BasePojo> CREATOR = new Creator<BasePojo>() {
        @Override
        public BasePojo createFromParcel(Parcel in) {
            return new BasePojo(in);
        }

        @Override
        public BasePojo[] newArray(int size) {
            return new BasePojo[size];
        }
    };

    @Override
    public int describeContents() {
        return 0;
    }

    @Override
    public void writeToParcel(Parcel parcel, int i) {
        parcel.writeString(something);
    }

} 
```

然后这将是子类：

```
public class ChildPojo extends BasePojo implements Parcelable {

    private int somethingElse;

    //what ever other constructor

    //getters and setters

    protected ChildPojo(Parcel in) {
        super(in);
        somethingElse = in.readInt();
    }

    public static final Creator<ChildPojo> CREATOR = new Creator<ChildPojo>() {
        @Override
        public ChildPojo createFromParcel(Parcel in) {
            return new ChildPojo(in);
        }

        @Override
        public ChildPojo[] newArray(int size) {
            return new ChildPojo[size];
        }
    };

    @Override
    public int describeContents() {
        return 0;
    }

    @Override
    public void writeToParcel(Parcel parcel, int i) {
        super.writeToParcel(parcel, i);
        parcel.writeInt(somethingElse);
    }

} 
```

标记的答案提供了一个很好的解释，调用 super 是关键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-27T20:50:50.920

这有点复杂，但诀窍是使用[反射](https://stackoverflow.com/questions/37628/what-is-reflection-and-why-is-it-useful)来获取子类成员的类型并对成员进行排序，以便您可以使用正确的类型以相同的确切顺序读取和写入数据。

我在这里实现了 A 类的解决方案：[https ://github.com/awadalaa/Android-Global-Parcelable](https://github.com/awadalaa/Android-Global-Parcelable)

所以现在你可以通过简单地扩展这个类来使任何类可打包。

# jsf - 如何设置异常消息 ?

> ID：10841453
> 
> 赞同：0
> 
> 时间：2012-05-31T21:19:55.243
> 
> 标签：jsf, exception-handling, message

我正在尝试在`<h:message>`.

这是相关的视图代码：

```
<h:inputText id="titleId" value="#{bookController.book.title}"/>                        
<h:message for="titleId"/>
<h:commandButton value="Create a book" actionListener="#{bookController.doCreateBook}" action="listBooks"/> 
```

`titleId`当为空时，我需要显示一条消息。当标题为空时，我的`@Stateless`EJB 方法会引发异常：

```
public Book createBook(Book book) throws CustomException {
    if(book.getTitle().isEmpty()) {
        throw new CustomException("Please, type a Title !");
    }   
    else {
        em.persist(book);
        return book;
    }       
} 
```

我的支持 bean 捕获它并设置一条消息：

```
public void doCreateBook() {
    FacesContext ctx = FacesContext.getCurrentInstance();
    try {
        book = bookEJB.createBook(book);
        bookList = bookEJB.findBooks();
    } catch (CustomException e) {
        ctx.addMessage("titleId", new FacesMessage(FacesMessage.SEVERITY_ERROR, "Error", e.getMessage()));
    }                               
} 
```

我例外的是，当异常发生时，必须在输入文本标签附近显示错误消息，但事实并非如此，执行显示带有书籍列表的页面和列表下方显示的“错误”消息，如下所示：

![书籍清单](../Images/fdbaa56f61c2acd07883cc345061c2eb.png)

如何让完整的异常消息显示在输入字段旁边？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:29:24.443

```
 ctx.addMessage("titleId", new FacesMessage(FacesMessage.SEVERITY_ERROR, "Error", e.getMessage())); 
```

您的消息文本是错误，您得到的也是一样。将此处的“错误”更改为您想要的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T03:41:13.003

除了 Thinksteep 已经回答的错误消息处理之外，您的另一个错误是您正在操作方法中进行验证。这个不对。您应该改用 JSF 内置验证工具。每当 JSF 内置验证失败时，将**不会**调用 action 方法并且页面也**不会**导航。最终用户坚持当前表单，消息将出现在为此指定的`<h:message>`标签中。

在您的特定情况下，您只需要设置`required`属性。

```
<h:inputText id="titleId" value="#{bookController.book.title}" required="true" />
<h:message for="titleId" /> 
```

如果要自定义默认的必需消息，请使用`requiredMessage`属性。

```
<h:inputText id="titleId" value="#{bookController.book.title}" 
    required="true" requiredMessage="Please, type a Title !" />
<h:message for="titleId" /> 
```

从 EJB 方法中删除该输入验证。它不属于那里。EJB 不对此负责，调用者（在您的情况下是您的 JSF 代码）对此负责。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-21T20:42:37.173

放`<h:messages showDetail="true" />`

# listview - 触发 onItemDisclosure 事件会导致 itemtap 事件触发

> ID：10841457
> 
> 赞同：5
> 
> 时间：2012-05-31T21:20:01.803
> 
> 标签：listview, sencha-touch, extjs, mobile-website

我正在尝试处理同一列表上的事件，第一个是 itemtap 事件，另一个是 onItemDisclosure 事件。

当我点击箭头时，会触发 onItemDisclosure 事件并执行处理程序，但是，也会触发 itemtap，并且在执行 onItemDisclosure 处理程序之后，依次执行 itemtap 处理程序。

我该如何解决这个问题？

看法 ：

```
Ext.define('myapp.view.listview', {   
    requires: [ 'myapp.model.listmodel'],
    extend: 'Ext.List',
    alias:'widget.listview',  
    id : 'listview',
    fullscreen: true,  
config: {

    iconCls: 'list',

    title : 'List',
    onItemDisclosure: function () {
    alert('ok')

    },               

    store:'ListView',  
    itemTpl:'{title}'   

  }
 }); 
```

控制器代码：

```
 Ext.define('myapp.controller.Main', {  
     extend: 'Ext.app.Controller',
    views : ['listview'],
    config : {

    refs:{

        list:'#listview'

    },
    control :{

        listview:{
            itemtap:'display',
            onItemDisclosure : 'disclosure'
        }

    }
},

display:function(){
   alert('tap')
},

disclosure:function (){
    alert('disclosure');
}, 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T10:58:15.443

您需要阻止`itemtap`事件继续冒泡。首先你需要函数调用的参数，然后是你调用的事件参数`stopEvent()`。

```
disclosure: function(list, record, node, index, event, eOpts) {
    console.log('disclose');        

    event.stopEvent();
}, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T08:25:34.130

`onItemDisclosure`是 Ext.List 的属性 - 不是事件。在控制器中`control`，我们使用事件。因此，在这里您将需要**披露**类似于“itemtap”事件的事件。检查此[链接](http://docs.sencha.com/touch/2-0/#!/api/Ext.dataview.List-event-disclose)。

# php - 记录用户安全在页面上的时间

> ID：10841458
> 
> 赞同：0
> 
> 时间：2012-05-31T21:20:06.760
> 
> 标签：php, javascript, jquery

[如何衡量在页面上花费的时间？](https://stackoverflow.com/questions/4667068/how-to-measure-a-time-spent-on-a-page)

我遇到了上面的线程，它有一个解决方案，但是用户可以轻松地修改初始日期值，使他们可以随时在页面上花费的时间。

我需要以某种方式粗略估计用户在用户无法修改的页面上停留了多长时间。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:18:33.877

首先，您需要确定秒或分钟的重要性。

使用 javascript 衡量在页面上花费的时间。

为每个加载的页面实现一个具有唯一 ID 的心跳，它每 n 秒或 n 分钟运行一次，以更新用户在您的页面上停留的时间。

也使用 onbeforeunload 调用相同的心跳函数（失败很多次，但当它工作时，它会提高你的准确性）。

# java - Android 对象缓存

> ID：10841470
> 
> 赞同：10
> 
> 时间：2012-05-31T21:21:26.090
> 
> 标签：java, android, caching

为 Android (SDK 7+) 类寻找一个简单的开源非 copyleft 缓存。

主要目的是存储`Bitmap`异步获取的 s（因此我不需要将此功能包含在缓存类中）。

我为此目的使用了一个弱列表，这自然是一个糟糕的解决方案，番石榴缓存稍微好一点，但仍然不好。

最好缓存能够存储任何可序列化`Object`的 ，而不仅仅是 a `Bitmap`，并且我可以在将对象添加到缓存时轻松清除使用的某些标记的对象。

最好的选择是像包装 sqlite 数据库一样获取文件系统缓存。如果缓存能被清除就好了`Settings >Manage Application > Clear Cache`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T17:01:55.477

上面建议的普通 LruCache 是内存缓存。从您的问题看来，您正在寻找磁盘缓存解决方案。

阅读 Caching Bitmaps android 培训文档的[磁盘缓存](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html#disk-cache)。

然后看看以下线程上讨论的 DiskLruCache 实现： [Using DiskLruCache in android 4.0 does not provide for openCache method](https://stackoverflow.com/questions/10185898/using-disklrucache-in-android-4-0-does-not-provide-for-opencache-method)

您可以在 GitHub 上获取[DiskLruCache](https://github.com/JakeWharton/DiskLruCache/)源代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T02:09:36.043

怎么样`android.util.LruCache`？如果您需要支持旧平台，只需将其复制到您的项目中即可。编辑：它实际上在兼容/支持库中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-22T08:25:58.463

ICSDiskLruCache.java。这是 ICS 和更高版本的 Android 中可用的 DiskLruCache 的一个端口，由 Google 作为 IO 2012 Android 应用程序的一部分开源，因此它适用于（至少）API 级别 7 的版本。

[在http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/util/ICSDiskLruCache.java](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/util/ICSDiskLruCache.java)找到源代码

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T23:27:23.373

[http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/cache/package-summary.html](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/cache/package-summary.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-23T08:05:09.563

点火是你要找的东西：[https](https://github.com/kaeppler/ignition) ://github.com/kaeppler/ignition 。它允许您缓存图像、序列化对象。对于收银部分，使用[点火支持](https://github.com/kaeppler/ignition/tree/master/ignition-support)

这是点火支持的 API：http: [//kaeppler.github.com/ignition-docs/ignition-support/apidocs/](http://kaeppler.github.com/ignition-docs/ignition-support/apidocs/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-17T15:45:23.353

我建议您使用被广泛使用且以前称为 droid-fu 的重构且非常强大的库，称为点火。点火库主要由 Qype 的首席移动开发人员 Matthias Käppler 维护。该库有一个缓存框架和 RemoteImage Widget（以及更多有用的类）。而且 Maven 已经准备好了，所以很容易添加依赖。看一下缓存 javadoc： http: [//kaeppler.github.com/ignition-docs/ignition-support/apidocs/](http://kaeppler.github.com/ignition-docs/ignition-support/apidocs/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-23T15:40:10.690

您可以按照这个官方 android 文档创建自己的图像缓存，该文档不仅为您提供代码，还解释了它是如何工作的：

[http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

他们还解释了整个过程，从加载位图，在后台线程中处理它们，缓存它们并显示它们

[http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

# django - 表单集字段中的 django 时区问题

> ID：10841471
> 
> 赞同：0
> 
> 时间：2012-05-31T21:21:26.853
> 
> 标签：django, timezone, pytz, tzinfo

我在模型表单中使用的外键对象在模板中显示如下：

![在此处输入图像描述](../Images/2ddc2d11a3a0f2947e75cafb11f2e54b.png)

它以 UTC 显示支腿的日期时间，这是默认时区。它需要显示本地化到用户时区的日期信息。我假设它使用模型中的以下信息来呈现 Leg 日期时间信息：

```
 def __unicode__(self):
    return  str(self.carpool.name) + " | " + str(self.drive_date_time)  + ' | to: ' + self.endpoint 
```

我有一个自定义中间件，用于检查用户是否经过身份验证，如果是，则将时区设置为用户的时区。它在模板上运行良好，但似乎不适用于此模型形式。

如何让这个模型表单中的日期时间信息与当前用户的时区一起显示，该时区存储在我的数据库中并可以在模板中访问？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T15:12:40.193

我这样修复它：

```
 def __unicode__(self):
    return  str(self.carpool.name) + " | " + str(self.drive_date_time.astimezone(pytz.timezone(self.carpool.drivers.all()[0].timezone)).strftime('%m/%d/%y: %I:%M %p'))  + ' | to: ' + self.endpoint 
```

# xcode - 需要在 OSX 10.7.2 上安装 Xcode

> ID：10841475
> 
> 赞同：1
> 
> 时间：2012-05-31T21:22:01.983
> 
> 标签：xcode, installation

我应该使用什么版本的 Xcode？我尝试安装 4.2 但收到这个神秘的错误消息 ![在此处输入图像描述](../Images/d6a11d93ceaf07a2af48c4395f94d0ea.png)

如果我不那么生气，我会觉得这很有趣

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:24:40.530

Is there any reason you're still on OS X 10.7.2? If you can, update your Mac to 10.7.4\. As for Xcode, the current version is 4.3.2\. You can download it from the Mac App Store.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:29:29.000

The latest stable Xcode release is 4.3.2 as of May 31st, 2012\. I believe there was a version for Snow Leopard (10.6) that would not work with Lion (10.7). You'll need to be a member of the developer program (free, I believe) to [get the free download here](https://developer.apple.com/xcode/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-06T10:10:57.320

我有 osx 10.7.X 并且需要安装 Xcode。应用商店中提供的最新 xcode 5.X 版本与 10.7 不兼容。Xcode4.5.1 cltools 是兼容的。

旧版本很难找到，在 developer.apple.com 中进行了大量搜索后，在 [此处找到了旧版本的 Xcode](https://developer.apple.com/downloads/index.action?q=xcode)

# sql-server - 我可以使用 SQL Server 2012 express 使用 SSDT/BIDS/SSIS 吗？

> ID：10841478
> 
> 赞同：4
> 
> 时间：2012-05-31T21:22:13.213
> 
> 标签：sql-server, visual-studio-2010, ssis, sql-server-express, sql-server-data-tools

理想情况下，我想在我的台式电脑上制作 SSDT/SSIS 包，我可以测试并部署到生产服务器环境。在我的 PC 上，我有：Windows 7 Visual Studio 2008 Visual Studio 2010 (shell) SQL Server Express 2012 (prod 的本地开发副本) [supposedly] BIDS (Business Intelligence Development Studio) 和 SSDT (SQL SErver Data Tools) 等。

在我的生产服务器上，我有： Windows Server 2008 SQL Server 2012 Visual Studio 2010 (shell)

正如这些文章所建议的，我无法在我的机器上加载/运行 SSIS（SQL Server 集成服务），因为 SQL Server express 不允许这样做：

[http://support.microsoft.com/Default.aspx?id=963070](http://support.microsoft.com/Default.aspx?id=963070)

[http://msdn.microsoft.com/en-us/library/cc645993.aspx#SSIS](http://msdn.microsoft.com/en-us/library/cc645993.aspx#SSIS)

尝试查看 VS 中的“package.dtsx”文件时出现此错误：

> Microsoft Visual Studio 无法加载此文档：在 SQL Server Data Tools (SSDT) 中设计集成服务包。SSDT 必须由以下 SQL Server 2012 版本之一安装：标准。企业。开发人员或评估。要安装 SSDT，请运行 SQL Server 安装程序并选择 SQL Server Data Tools。

当我运行 SQL2012Express 安装程序时，它说 SSDT 已经安装。

问题 #1：但是为什么我不能在我的生产 SQL2012 环境中指向本地 VS2010/SSDT/SQL2012Express？（微软正在合法地获得他们的钱！）

问题#2：我可以让它在生产服务器上工作，但是在生产服务器上开发不是很糟糕吗？（并且它使源代码控制等复杂化）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:27:50.180

您必须安装其中一个版本。带有高级工具的 SQL Server Express Edition 仅包含报告。不是姐姐。Sql serverv 开发版其实很便宜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T19:25:45.797

为了能够创建 SSIS 包，您需要以下内容：

1) 对于 SQLServer 2008 SSIS 包 - BIDS，可以集成到 VS2010 中或作为独立的。如果您还想要 SQL Server，那么我会使用 SQLServer 的开发版，它是 VS2010 的可选安装。

2) 对于 SQLServer 2012 SSIS 包 -[下载并安装 SSDT](http://msdn.microsoft.com/en-us/data/hh297027)，或者作为独立的集成到 VS2012 中。如果您还想要 SQL 服务器，那么我会使用 localDB（[此处](http://msdn.microsoft.com/en-us/evalcenter/hh230763.aspx)）。

[此外，SSDT 是两件事——“ Data Dude](http://www.dotnetrocks.com/default.aspx?ShowNum=494) ”的改进替代品和新的 BIDS——这里有一个解释的博客。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-02T16:33:34.663

“Microsoft Visual Studio 2010 不支持适用于 SQL Server 2008 和 SQL Server 2008 R2 的 Business Intelligence Development Studio Integration Services、Report Services 和 Analysis Services 项目。要解决此问题，您可以同时安装 Visual Studio 2008 和 Visual Studio 2010机器，然后在 Visual Studio 2008 中打开 Business Intelligence Development Studio 项目。”

[http://msdn.microsoft.com/en-us/library/ms173767%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms173767%28v=sql.105%29.aspx)

猜猜这意味着：在 VS 2010 下不可能有任何 BIDS 项目。

# javascript - 扩展主干模型保存

> ID：10841486
> 
> 赞同：3
> 
> 时间：2012-05-31T21:23:05.040
> 
> 标签：javascript, backbone.js

**扩展**该**`model.save`方法**的最佳方法是什么？

我需要添加新方法将相同的数据发布到后端。即：`played`方法应该请求（通过POST）`apiurl/model/:id/played`

例如：

```
var Game = Backbone.Model.Extend({
   baseUrl: '/games/',
   played: function(){
      this.url = this.baseUrl + this.id + '/played' 
      this.save();
   }
}); 

var game = new Game({id:3234});  //is only an example, instances are created before previuosly
game.played(); 
```

这种方式有效，但请求是 GET。此外，如果这`save()`没有发送请求中的所有属性，那将是完美的。

**添加信息：** 由于我必须与跨域 api 交互，因此我扩展了同步方法以使用 JSONP。此外，我还添加了一些安全说明。

```
//backbone sync
Backbone._sync = Backbone.sync;
Backbone.sync = function(method, model, options) {
    //network
    options.timeout = 10000;
    options.dataType = "jsonp";  
    //security
    if(_conf.general.accessToken){
        var ak = _conf.general.accessToken, 
        url = model.url,
        linker = url.indexOf('?') === -1 ? '?':'&';
        model.url = url + linker + 'accessToken=' + ak+'&callback=';    
    }
    //error manager
    var originalError = options.error || function(){};
    options.error = function(res){
        originalError(res.status, $.parseJSON(res.responseText));
    };
    //call original Method 
    Backbone._sync(method, model, options);  
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T21:45:20.290

Backbone 的 save 和 fetch 方法只是调用 Backbone.sync 方法，而后者又只是 ajax 调用的包装器。您可以使用 save 函数传入 ajax 参数，而无需实际扩展它。基本上最终是这样的：

```
game.save({attributes you want to save}, {type:'POST', url: 'apiurl/model/:id/played'}); 
```

不过，您每次都必须这样做，因此为您的模型扩展 Backbone.sync 可能是更好的做法。

Backbone 网站有一些关于我所说的关于 Backbone 同步和保存 ajax 选项的信息。我还看到了一些关于扩展同步的示例，但目前我似乎无法找到它们。

# ruby - 如何在 Rails 中计算和显示变量的值

> ID：10841488
> 
> 赞同：0
> 
> 时间：2012-05-31T21:23:13.760
> 
> 标签：ruby, ruby-on-rails-3, html, jquery-mobile, sqlite

我正在使用 Ruby on Rails/Jquery Mobile 开发一个 Web 应用程序。

SQLite 'Inventory' 模式由existingfixture:string、replacementfixture:string 和quantity:integer 组成。还有另外两个表，称为 oldlights 和 newlights。这些仅包含分别用于现有夹具和替换夹具的选项。Oldlights 和 newlights 都有 lightname:string 和 value:integer，其中 value 是给定灯光名称使用的瓦数。

![这是它的外观截图](../Images/8019278337ebe2249f17d7d0fb728a50.png)

**我还希望我的程序能够显示现有灯具与替换灯具的瓦数差异。**我希望能够有另一个专栏说明每年节省多少瓦特，**但我不知道如何去做**。这些值在 oldlights/newlights 中关联。但是，我不知道如何访问它们并在单独的列中使用它们执行数学方程。

显示数据库值的代码：

```
<fieldset class="ui-grid-c"><center>
         <div class="ui-block-a"><%= inventory.existing %></div>
         <div class="ui-block-b"><%= inventory.replacement %></div>
         <div class="ui-block-c"><%= inventory.quantity %></div>
         <div class="ui-block-d"><%= link_to 'Remove', [inventory.client, inventory], 
               :confirm => 'Are you sure?',
               :method => :delete %></div></center>
</fieldset> 
```

添加库存的代码

```
 <%= form_for([@client, @client.inventories.build]) do |f| %>
       <fieldset class="ui-grid-c">
         <div class="ui-block-a"><%= f.select :existing, Olight.all.collect{|p| [p.name]}, { :include_blank => true } %></div>
         <div class="ui-block-b"><%= f.select :replacement, Nlight.all.collect{|p| [p.name]}, { :include_blank => true } %></div>
         <div class="ui-block-c"><%= f.number_field :quantity, "data-mini" => "true" %></div>
         <div class="ui-block-d"></div>
       </fieldset>
       <%= f.submit 'Add Inventory'%>
     <% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T09:47:06.267

我感谢你必须做很多事情：

*   首先，您必须从新的和以前的中获得瓦特。为此，有两种解决方案：

    您制作一个正则表达式以从名称中提取瓦特，或者您在灯光上添加一个字段，用户可以在其中指定瓦特。

*   其次，在“添加库存”单击时，您向服务器发送一个带有额外参数的 ajax 调用，如“newWatts”和“oldWatts”。在服务器端创建操作时，您计算节省的能量并将其保存在数据库中。

你明白吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T12:16:26.203

塞巴斯蒂安部分正确。（解析灯具名称将不起作用，因为在“1-4' 40W-T12-ESMB”命名中，40 不是灯具的瓦数，而是单个 4 英尺 T-12 灯的瓦数，而工程并不像“3-4' 40W-T12-ESMB”灯具的瓦数那么简单 == 3 倍于“1-4' 40W-T12-ESMB”灯具的瓦数。总的灯具瓦数取决于除灯泡功率外，还有许多其他因素。）

你应该阅读[这个页面](http://guides.rubyonrails.org/form_helpers.html "guides.rubyonrails.org/form_helpers.html")！“第 3 节 - 轻松制作选择框”以获取有关如何设置下拉列表的更多信息——我喜欢使用 options_for_Select 进行构建。我相信您想要显示名称的表单，但新旧灯具的 id 是存储在您的数据库中的。

在您的 Rails 控制器中，当您保存库存组合（现有、替换和计数）时，您使用新旧灯具 ID 来查找它们的功率，进行数学运算，然后存储节省的值。显示页面时，所有数据都应该存在。

在样式说明中，我将 Olight/Nlight.all.collect 代码从页面模板移出并进入控制器，设置视图使用的实例变量......

```
@existing = Olight.all.collect{|old| [old.name, old.id]}
@replacement = Nlight.all.collect(|new| [new.name, new.id]} 
```

# php - 下拉选择：显示带有项目的类别名称

> ID：10841489
> 
> 赞同：0
> 
> 时间：2012-05-31T21:23:13.720
> 
> 标签：php, codeigniter, codeigniter-2

我正在从我的数据库中填充一个下拉选择。到目前为止，我设法创建的下拉选择仅包含一些产品名称。我想将类别名称与产品一起显示，但类别名称不应该是可选的。

我有以下两张表。

表名：product_category

```
category_id     category_name
    1              Beverage
    2              Food 
```

表名称：产品

```
product_id   category_id    product_name
    1           1              Pepsi
    2           2              Burger 
```

我的模特

```
 function products() {

     $this->db->select('product_name, product_id');
      $records=$this->db->get('products');

        $data=array();
        $data[''] = 'Select'; 
            foreach ($records->result() as $row)
                {
                    $data[$row->product_id] = $row->product_name;
                }

            return ($data);
        } 
```

目前，当我运行我的视图文件并单击下拉选择时，我得到如下值：

```
 Pepsi
    Burger 
```

但是我应该在上面的模型中多写什么来使我的视图文件中的下拉菜单看起来像下面这样？

**饮料**

```
 Pepsi 
```

**食物**

```
 Burger 
```

谢谢 :) 仅供参考，我正在使用 Codeigniter :0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:30:06.410

There is something for that called [optgroup](http://www.w3schools.com/tags/tag_optgroup.asp)

```
<select>
  <optgroup label='category 1'>
    <option value='1'>Item 1</option>
    <option value='2'>Item 2</option>
  </optgroup>
  <optgroup label='category 2'>
    <option value='3'>Item 3</option>
    <option value='4'>Item 4</option>
  </optgroup>
</select> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T06:28:31.170

CodeIgniter 太棒了，所以在你的例子中，你可以做一个：

```
$arr = array( 'Beverage' => array( '1' => 'Pepsi' ),
              'Food' => array( '2' => 'Bruger' ));

echo dropdown('food_id', $arr); 
```

因此，您将为每个值增加一个深度，其中第一个键是 optgroup 的名称，第二个是 id。它将具有`select > optgroup > option`@Pitchinnate 的回复中给出的结构

在你的 foreach 中，它看起来像这样：

```
$data[$row->category_name][$row->product_id] = $row->product_name; 
```

# c++ - 在 C++ 中使用 DEBUG 宏的原因是什么？

> ID：10841492
> 
> 赞同：9
> 
> 时间：2012-05-31T21:23:18.030
> 
> 标签：c++, debugging, macros

我正在研究其他人构建的 C++ 程序，并且看到了很多这样的 DEBUG 用法

```
#ifdef DEBUG
    cout << "Value is "<< value << endl;
#endif 
```

我自己仍在学习成为一名富裕的 C++ 程序员，我主要使用 Visual Studio 和断点进行调试。所以我想知道，如果我能够通过代码来调试值，还有其他理由使用这些宏吗？

尝试谷歌但没有找到太多有用的页面。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-31T21:25:51.930

有时您不想单步执行整个代码，而只是检查终端中的输出。

如果代码是使用定义编译的`DEBUG`，可能在调试版本中，您会看到输出。对于发布版本，您不需要。如果你去**project settings -> Configuration Properties -> C/C++ -> Preprocessor -> Preprocessor Definitions**，你会看到它`DEBUG`是为调试构建定义的，但它不是为发布而定义的。（我其实有`_DEBUG`）

想象一下，你有一个巨大的函数，而你感兴趣的是第 1000 行（这是旧代码，无法更改）。您宁愿单步执行所有那些凌乱的遗留代码，还是在关键点使用有用的调试语句？您是希望控制台告诉您哪里出了问题，还是`return`在失败位置的 237 个语句中的每一个处设置断点？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T21:26:57.527

在调试时，通常的做法是在屏幕上转储一些中间值。可视化调试器并不总是有帮助，因为您浪费了大量时间来使用鼠标进行操作。

对“文本模式调试”和日志记录的需求也经常来自嵌入式系统体验，您没有太多视觉帮助，您所能做的就是将一两个字节转储到串行端口或类似的东西。当您习惯于快速找到关键调试点时，您只需在其中插入一些打印代码，其值会检查程序的正确性。

“DEBUG”宏由 MSVC++ 编译器定义，而您的项目在调试模式下编译。当您制作发布版本时，所有对最终用户实际上无用的代码都会被预处理器“剥离”。

典型片段

```
#ifdef DEBUG
Some code
#endif 
```

如果未定义 DEBUG，则由预处理器删除。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T21:30:39.293

使用控制台输出而不是调试器来识别多线程错误会很方便。通过断点中断程序流通常会阻止错误的发生，因为它会阻止线程互相踩踏。其他基于时间的错误也是如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T21:28:36.073

***“我主要使用 Visual Studio 和断点进行调试”***
通过逐步观察代码的行为来调试代码是非常困难的，在某些情况下甚至是不可能的。有时创建这种“调试输出”会更容易，这样您就可以从这些日志中看到正在发生的事情，而不是尝试实时单步执行。

检查是否`DEBUG`定义了符号是为了确保您的发布版本不会产生这种输出。请注意，Visual Studio 定义**[`_DEBUG`](http://msdn.microsoft.com/en-us/library/0b98s6w8(v=vs.80).aspx)**了调试配置。更具体地说：*“编译器定义`_DEBUG`您何时指定 /MTd 或 /MDd 选项。这些选项指定 C 运行时库的调试版本。”* 还有一个`NDEBUG`在定义时禁用 C 风格的断言。有关更多信息，请查看[_DEBUG 与 NDEBUG](https://stackoverflow.com/q/2290509/1168156)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T21:26:00.393

它用于调试，通过将代码包装在预处理器命令中，您可以打开或关闭该代码。

看看这里：[C++ 注释：预处理器](http://www.fredosaurus.com/notes-cpp/preprocessor/ifdef.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-31T21:28:35.950

很容易，当您想获得一些可能帮助您进行“软”调试的消息时，您只需定义 DEBUG 和之间的句子，`#ifdef DEBUG`并且`#endif`将生效，并在您的情况下获得一些有用的消息。

这样，当您完成开发并想要发布时，您只需取消定义调试，消息将不再出现。

您可能认为是的，这是一个好主意，但是应用程序的代码更多，但好处是这些是宏并且在编译时进行评估，因此，如果您删除所有这些，应用程序将是相同的： )

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-07T11:31:28.867

我建议不要使用`DEBUG`宏。相反，使用标准`NDEBUG`宏，它是在不需要调试代码时定义的，而不是在需要调试代码时定义的。也就是说，默认情况下启用调试代码。您会发现只有一小部分性能关键代码需要关闭调试检查才能获得足够的性能。

# objective-c - 调整“for”循环持续时间

> ID：10841493
> 
> 赞同：-1
> 
> 时间：2012-05-31T21:23:30.833
> 
> 标签：objective-c, ios, cocoa-touch, loops, for-loop

我目前正在开发一个应用程序，该应用程序将显示一个从零开始的标签，并计数到我指定的数字。我想用一个像这样的简单循环来做到这一点。

```
 for (counterInt = 0; counterInt < 10; counterInt++) 
    {
        NSLog(@"%i",counterInt); 
    } 
```

问题是，这个循环的执行时间比视图出现在屏幕上的时间要短。在视图最终加载显示 9 的标签之前，我的控制台记录了 1-9。我已经研究了几个小时，试图找到一种方法来指定循环的持续时间，但我似乎找不到任何东西.

所以我的总体问题是，是否可以指定循环执行需要多长时间？如果是这样，如果有人能在这里指出我正确的方向，将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T21:27:10.473

即使你放慢了循环，它仍然无法工作。UI 元素仅在运行循环结束时更新。您需要设置一个[计时器](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html)并在计时器触发的方法中更新标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T21:30:09.897

你使用了错误的方法。试试 NSTimer。

```
[NSTimer scheduledTimerWithTimeInterval:5.0
    target:self
    selector:@selector(incrementLabel:)
    userInfo:nil
    repeats:YES]; 
```

然后创建一个名为 incrementLabel 的方法，让它增加一个实例变量并相应地更新标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:38:52.660

你可以休眠一个线程：

```
[NSThread sleepForTimeInterval:1]; 
```

但是，jrturton 和 james 提供了正确的方法。我会将 James 的代码放在 viewDidAppear 方法中，以便您的标签从您想要的位置开始，并且在视图出现时开始计数器。

# php - 使用 CakePHP 和 Android 构建服务器-客户端应用程序

> ID：10841497
> 
> 赞同：0
> 
> 时间：2012-05-31T21:24:05.243
> 
> 标签：php, android, cakephp, authentication, plugins

我目前正在 Android 上构建一个允许用户注册基于位置的服务的应用程序。我在服务器端编程和 Android 方面都是新手。因此，我需要一些建议来为我指明正确的方向。

具体来说，我的 Android 应用程序将允许用户在服务器端注册、登录和更新他们的个人资料和设置，我使用 Apache 作为我的服务器。

我现在的想法是在服务器端使用 CakePHP，并使用 JSON/XML 格式通过 HTTP POST 和响应与 Android App 进行通信。我不想从头开始重新构建身份验证等所有内容，但是我找不到任何适合我的 CakePHP 插件。我试过 CakeDC 和 Authake。CakeDC 似乎与当前的 CakePHP 版本不兼容。对于 Authake，我已经按照 Authake 教程中的步骤进行操作，但是，注册和登录页面不起作用。（我也不能使用管理员登录。）

**总结**
1\. 这种服务器-客户端架构可行吗？
2\. 谁能给我一个与当前CakePHP 兼容的CakePHP 认证/注册插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:17:30.623

1.  对我来说似乎可行。尽管如果您让用户通过 Web 界面远程登录，您可能必须构建一个 REST 或类似的界面。
2.  我为基于身份验证的 CakePHP 程序使用了[用户管理插件](https://github.com/chetanvarshney/User-Management-Plugin-for-Cakephp-2.x)，我非常喜欢它。

# eclipse - How do I have Maven install and/or configure eclipse plugins automatically

> ID：10841506
> 
> 赞同：0
> 
> 时间：2012-05-31T21:25:11.443
> 
> 标签：eclipse, maven, plugins, configuration

I am new to eclipse and the interaction between eclipse and maven.

Is it possible to have Maven automatically install Eclipse plugins if the eclipse path is known?

Is it possible to configure specific project settings for each installed plugin when the eclipse project is created? Is it easy to update these configuration settings once the eclipse project is created?

How may I go about this using Maven? Or is it not possible/ideal?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:36:44.230

要安装插件，您必须将插件文件复制到*eclipse/plugins*文件夹中，如[Eclipse wiki中所述](http://wiki.eclipse.org/FAQ_How_do_I_install_new_plug-ins?)

您可以使用 maven 将插件文件/文件夹复制到 eclipse 插件目录。这个问题将展示如何：[使用 Maven 复制文件的最佳实践](https://stackoverflow.com/questions/586202/best-practices-for-copying-files-with-maven)

但是，我不建议使用 maven 来配置 IDE 及其插件，您应该管理您的项目，而不是使用 maven 管理您的 IDE。

# r - 从R中的另一个向量中删除一个向量中的元素

> ID：10841511
> 
> 赞同：5
> 
> 时间：2012-05-31T21:26:08.790
> 
> 标签：r

我是 R 新手，无法找到一种方法从另一个向量中删除一个向量的所有元素。我有一个称为“日期”的日期向量，并且想要删除周末的日期（在向量“周末”中。

下面的代码有效，但我知道必须有一种更有效的方法来做到这一点，而不是一次一个......让我知道！

```
 for (index in 1:length(weekends)) {
    datesReformatted <- datesReformatted[datesReformatted != weekends[index]]
  } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-31T21:29:58.917

这应该可以解决问题

```
 setdiff(dates, weekends) 
```

# android - 如何将列表项保存在内存中？

> ID：10841519
> 
> 赞同：0
> 
> 时间：2012-05-31T21:26:55.677
> 
> 标签：android

我有自定义列表视图。当我滚动我的列表视图时，android会保留在内存中（据我所知）显示在屏幕上的项目并且不会保留隐藏的项目（未滚动到）。

在我的情况下（我认为）保留所有列表项会比生成隐藏项更好。

那么，如何“告诉”android 将所有项目保存在内存中？（15-20 项）。PS：如果是浪费资源，我想试试。

我的适配器（一些功能）：

```
private View newView(Context context, ViewGroup parent) {
  LayoutInflater layoutInflater = LayoutInflater.from(context);
  return layoutInflater.inflate(R.layout.myl,parent,false);
}
public View getView(int position,View convertView,ViewGroup parent) {
  View view=null;
  if(convertView!=null) view=convertView; else view=newView(context,parent);
  HashMap<String,String> d=new HashMap<String,String>();
  d=data.get(position); 
  String qweqwe=d.get("qweqwe"); //9 more lines like this.
  TextView txt=(TextView)view.findViewById(R.id.mfmf); //
  txt.setText(qweqwe); //
  txt.setTypeface(mlf); //5 more blocks of 3 lines like this.
  if (smth.equals("0")){
    view.setBackgroundDrawable(context.getResources().getDrawable(R.drawable.mvmv));
  } else {
    view.setBackgroundDrawable(context.getResources().getDrawable(R.drawable.mvmv2));
  }
  return view;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T23:27:56.993

好的..这里有一些可以优化的东西，而不是试图用变通方法来修复滞后:)

您应该实现一个静态类，您可以在其中存储对 myl.xml 中的视图的引用。对于您要在 myl.xml 中操作的每个视图，您可以在此静态类中创建一个视图。因此，如果您有 10 个 TextView，则使用 10 个 TextView 填充这个类。

```
static class AdapterViewsHolder {
    TextView txt1;
    TextView txt2;
    TextView txt3;
    ...
    ImageView img1;
    ... etc etc.
} 
```

在适配器中，您现在仅在 convertView 为空时才执行 findViewById() 调用。findViewById() 并不便宜，因此限制调用量可以提高性能。

```
private HashMap<String, String> mData;
private LayoutInflater mInflater;
private TypeFace mCustomTypeFace;

// Some contructor for passing data into the Adapter.
public BaseAdapter(HashMap<String, String> data, Context ctx) {
    mData = data;
    mInflater = LayoutInflater.from(ctx);
    mCustomTypeFace = Typeface.createFromAsset(ctx.getAssets(), "yourTypeFace.ttf");
}

public View getView(int position, View convertView, ViewGroup parent) {
    // This AdapterViewsHolder will hold references to your views, so you don't have to 
    // call findViewById() all the time :)
    AdapterViewsHolder holder;

    // Check if convertView is null
    if(convertView == null) {
        // If it is, we have to inflate a new view. You can probably use the newView() call here if you want.
        convertView = mInflater.inflate(R.layout.myl, null);

        // Initialize the holder
        holder = new AdapterViewsHolder();

        // Now we do the smart thing: We store references to the views we need, in the  holder. Just find all the views you need, by id.
        holder.txt1 = (TextView) convertView.findViewById(R.id.textview1);
        holder.txt2 = (TextView) convertView.findViewById(R.id.textview2);
        ...
        holder.img1 = (ImageView) convertView.findViewById(R.id.imageview1);

        // Store the holder in the convertViews tag
        convertView.setTag(holder);
    }
    else {
        // If convertView is not null, we can get get the holder we stored in the tag.
        // This holder now contains references to all the views we need :)
        holder = (AdapterViewsHolder) convertView.getTag();
    }

    // Now we can start assigning values to the textviews and the imageviews etc etc
    holder.txt1.setText(mData.get(position));
    ...
    holder.txt1.setTypeface(mCustomTypeFace);
    ...
    holder.img1.setImageResource("IMAGE RESOURCE HERE");  

    if(someThing.equals("sometext") {
         convertView.setBackgroundDrawable(somedrawable);
    }
    else {
         convertView.setBackgroundDrawable(someotherdrawable);
    }

    // Finally, we return the convertView
    return convertView;
} 
```

我不知道您的数据是如何组织的，因此您必须稍微更改此代码。

One more thing that can cause lag is the `android:cacheColorHint` xml attribute. Usually you set this to either the same color as you application background, or transparent. Setting it transparent have been known to cause rapid Garbage collections on some occasions.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:43:14.707

您可以覆盖适配器并让它膨胀构造函数中的所有视图，然后使用 getView() 返回正确的视图。如果您将视图存储在某个数据对象（数组、列表等）中，可能会变得容易

但实际上你应该让系统像设计的那样使用 convertView。总的来说，我认为这样做会获得更好的性能。

# javascript - RequireJS 插件( order.js )

> ID：10841522
> 
> 赞同：8
> 
> 时间：2012-05-31T21:26:59.267
> 
> 标签：javascript, requirejs

[http://requirejs.org/](http://requirejs.org/)

我最近下载了 require.js 2.0，但在控制台中出现错误：

```
Uncaught TypeError: Object function (){var g=ga.call(arguments,0),e;if(f&&v(e=g[g.length-1]))e.__requireJsBuild=!0;g.push(d);return b.apply(null,g)} has no method 'nameToUrl' 
```

requirejs 是否仍然支持 order.js 插件？我在网站上没有看到它的文档。

当我尝试删除文件时，脚本会中断。

在我的索引文件中，我在 head 部分包含了 requirejs 脚本：

```
<!DOCTYPE html>
<html>
    <head>
        <title>
            My Mobile Application
        </title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
        <link rel="stylesheet" href="public/css/style.css" />
        <script data-main="scripts/main.js" src="scripts/require.js"></script>
    </head>
    <body></body>
</html> 
```

然后在我的 main.js 文件中：

```
requirejs.config({
    //By default load any module IDs from js/lib
    baseUrl: 'js/lib',
    //except, if the module ID starts with "app",
    //load it from the js/app directory. paths
    //config is relative to the baseUrl, and
    //never includes a ".js" extension since
    //the paths config could be for a directory.
    paths: {
        app: '../app',
        assets: '../assets',
        views: '../app/views',
        templates: '../app/templates',
        collections: '../app/collections',
        models: '../app/models'
    }
});

// Start the main app logic.
requirejs([
    'jquery/jquery',
    'assets/jqm.config',
    'jquery/mobile',
    'text'
]);

require([
    'app'
    ],
    function( App ){
        $(document).ready( function(){
            App.initialize();
        });
    }
); 
```

我认为 App.initialize 没有任何错误，而 App.initialize 所做的只是简单的地理位置。requirejs 只是要求 order.js，当我输入代码时，它会出现与上面提到的相同的错误。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-31T23:11:58.120

`order`您不再支持的假设是正确的。它被删除以支持`shim`配置选项：

> 因此，order 插件已被删除，并且在 Tim Branyen 和 Dave Geddes 的领导下，分别使用和 wrap，requirejs 2.0 直接在 requirejs 中集成了这种依赖树规范。

Require 2.0 升级说明 - [https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0](https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0)

此外，请查看`shim`RequireJS 站点上的文档 - [http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T00:01:25.533

哦，想通了。

```
//This is our main applicatoon boot loader or bootstrap
//here we are loading necessary scripts dependencies like
//jquery, jqm.config, mobile, text

requirejs.config({
    baseUrl: 'js/libs',
    //except, if the module ID starts with "app",
    //load it from the js/app directory. paths
    //config is relative to the baseUrl, and
    //never includes a ".js" extension since
    //the paths config could be for a directory.
    paths: {
        app: '../app',
        assets: '../assets',
        views: '../app/views',
        templates: '../app/templates',
        collections: '../app/collections',
        models: '../app/models'
    }
});

// Start the main app logic.

require(["jquery","assets/jqm.config","jquery/mobile","text","app"], 
    function(
    $,
    config,
    mobile,
    text,
    App
    ) {
    //the jquery.alpha.js and jquery.beta.js plugins have been loaded.
    $(function() {
        App.initialize();
    });
}); 
```

# ruby - Sinatra 全局应用程序变量

> ID：10841528
> 
> 赞同：4
> 
> 时间：2012-05-31T21:27:11.597
> 
> 标签：ruby, sinatra

我有一个简单的 Sinatra 应用程序，我想在所有会话和请求中共享一个变量。

```
configure do
  @@click_count = 0
end

def send_message(text)
  # ignore, this part works
end

post '/click' do
  @@click_count = @@click_count + 1
  send_message "clicks: #{@@click_count}"
end 
```

**发送的消息总是`clicks: 1`而不是递增。**我也尝试过`set :click_count, 0`，`settings.click_count = settings.click_count + 1`但我仍然得到同样的东西。

我正在使用 shotgun 在本地运行服务器，`shotgun web.rb -p 4567 -E production`因为在非生产环境中提到的另一个问题是，服务器会在每个丢失状态的请求上重新启动。

任何想法如何让它发挥作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T22:42:20.607

Sinatra 本身不会在开发模式下的每个请求上重新启动（[它曾经](http://www.sinatrarb.com/faq.html#reloading)），但[霰弹枪](https://github.com/rtomayko/shotgun)具有这种效果：

> 每次收到请求时，它会分叉，在子进程中加载​​应用程序，处理请求，然后退出子进程。

只需使用`ruby web.rb`，一切都应该正常工作（从您的评论来看，您似乎知道模线程问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:36:25.127

我不确定该`configure`块多久运行一次。尝试使用全局变量（例如`$click_count`）而不是类实例变量，并在程序的最顶部、任何块之外对其进行初始化。

# javascript - Javascript multiply input field by a number value

> ID：10841530
> 
> 赞同：0
> 
> 时间：2012-05-31T21:27:17.040
> 
> 标签：javascript

I am trying to multiply the user input on input field "full_day" by the "var fullprice", and display the result in readonly input field "total_full" what am i doing wrong that is causing it not to work?

```
<div id="wrapper">
<div id="header"></div>

<table width="899" border="1" align="left" cellpadding="1">
  <form action="" method="get" name="myform">

  <tr>
    <td width="275"><label>Company Name</label></td>
    <td width="180"><input type="text" name="companyname" id="companyname" /></td>
    <td width="27">&nbsp;</td>
    <td width="223">Enquiry Date</td>
    <td width="160"><input type="text" name="enquiry_date" id="enquiry_date" class="datepicker" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Conference Date In</td>
    <td><input type="text" name="conference_date_in" id="conference_date_in" class="datepicker" /></td>
    <td>&nbsp;</td>
    <td>Conference Date Out</td>
    <td><input type="text" name="conference_date_out" id="conference_date_out" class="datepicker" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Number of Delegates</td>
    <td><input type="text" name="no_of_delegates" id="no_of_delegates" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Accommodation:</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>Check in Date</p></td>
    <td><input type="text" name="check_in_date" id="check_in_date" class="datepicker" /></td>
    <td><p>&nbsp;</p></td>
    <td><p>Check out Date</p></td>
    <td><p>
      <input type="text" name="check_out_date" id="check_out_date" class="datepicker" />
        </p></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>Total Days Accommodation</td>
    <td><input type="text" name="total_days_acc" id="total_days_acc" /></td>
  </tr>
  <tr>
    <td>Number of Rooms:</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Single</td>
    <td><input type="text" name="no_of_rooms_single" id="no_of_rooms_single" /></td>
    <td>&nbsp;</td>
    <td>Double / Twin</td>
    <td><input type="text" name="no_of_rooms_double" id="no_of_rooms_double" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Contact Person</td>
    <td><input type="text" name="contact_person" id="contact_person" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Telephone Number</td>
    <td><input type="text" name="tel_no" id="tel_no" /></td>
    <td>&nbsp;</td>
    <td>Fax Number</td>
    <td><input type="text" name="fax_no" id="fax_no" /></td>
  </tr>
  <tr>
    <td>Cell Number</td>
    <td><input type="text" name="cell_no" id="cell_no" /></td>
    <td>&nbsp;</td>
    <td>Email</td>
    <td><input type="text" name="email" id="email" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Full Day Conference @ R260.00 p/p</td>
    <td><input type="text" name="full_day" id="full_day" /></td>
    <td>&nbsp;</td>
    <td>Total Full Day</td>
    <td><input type="text" name="total_full" id="total_full" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Half Day Conference @ R240.00 p/p</td>
    <td><input type="text" name="half_day" id="half_day" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Single Rooms @ R480.00 p/p</td>
    <td><input type="text" name="single_rooms" id="single_rooms" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Double / Twin Rooms @ R720.00 p/p</td>
    <td><input type="text" name="double_rooms" id="double_rooms" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Data Projector @ R400.00 rental p/day</td>
    <td><input type="text" name="data_proj" id="data_proj" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Sub Total</td>
    <td><input type="text" name="sub_total" id="sub_total" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  </form>
</table>
</div>
</body>
</html>

<script type="text/javascript">

$(function() {
    $(".datepicker").datepicker({ minDate: -0, maxDate: "+100M +10D",dateFormat: 'dd-mm-yy'})
    ({
        changeMonth: true,
        changeYear: true,
    });
        });

var enquiry_date = $.datepicker.formatDate('dd-mm-yy', new Date());
document.getElementById('enquiry_date').value = enquiry_date;

var calcDate = function() {
    var start = $('#conference_date_in').datepicker('getDate');
    var end = $('#conference_date_out').datepicker('getDate');
    var days = (end - start) / 1000 / 60 / 60 / 24;

    if(days==0) days=1
    if( days >= 0 ) {
    document.getElementById('total_days').value = days;
    } 
        }

$('#conference_date_out').change(calcDate);
$('#conference_date_in').change(calcDate);

var calcDateAcc = function() {
    var startacc = $('#check_in_date').datepicker('getDate');
    var endacc = $('#check_out_date').datepicker('getDate');
    var daysacc = (endacc - startacc) / 1000 / 60 / 60 / 24;

    if(daysacc==0) daysacc=1
    if( daysacc >= 0 ) {
    document.getElementById('total_days_acc').value = daysacc;
    } 
        }

$('#check_in_date').change(calcDateAcc);
$('#check_out_date').change(calcDateAcc);

function calculateFull()
{
    var fulldays = document.getElementById("full_day").value;

    var fullprice = 260;

    var result =  fulldays * fullprice;

    document.getElementById("total_full").innerHTML = result;   
    }
    $('#full_day').change(calculateFull);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:30:41.963

`document.getElementByid("full_day").value` returns a string. You have to convert this string into a number before multiplying it with `fullprice`

```
var fulldays = parseInt(document.getElementById("full_day").value, 10); 
```

And change `document.getElementById("total_full").innerHTML = result;` to `document.getElementById("total_full").value = result;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:32:20.943

total_full 是输入框，所以你应该设置 value 而不是 innetHTML

```
document.getElementById("total_full").innerHTML = result;

document.getElementById("total_full").value = result; 
```

# javascript - 画布绘制图像缩放

> ID：10841532
> 
> 赞同：66
> 
> 时间：2012-05-31T21:27:27.923
> 
> 标签：javascript, canvas, html5-canvas, resize, drawimage

我正在尝试将图像按比例缩放到画布上。我可以用固定的宽度和高度来缩放它，如下所示：

```
context.drawImage(imageObj, 0, 0, 100, 100) 
```

但我只想调整宽度并按比例调整高度。类似于以下内容：

```
context.drawImage(imageObj, 0, 0, 100, auto) 
```

我到处寻找我能想到的地方，但还没有看到这是否可能。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-05-31T22:54:55.563

```
context.drawImage(imageObj, 0, 0, 100, 100 * imageObj.height / imageObj.width) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-08-04T16:41:54.987

@TechMaze 的解决方案非常好。

这是经过一些更正后的代码和`image.onload`事件的介绍。`image.onload`是必不可少的，以避免任何形式的失真。

```
function draw_canvas_image() {

  var canvas = document.getElementById("image-holder-canvas");
  var context = canvas.getContext("2d");
  var imageObj = document.getElementById("myImageToDisplayOnCanvas");

  imageObj.onload = function() {
    var imgWidth = imageObj.naturalWidth;
    var screenWidth  = canvas.width;
    var scaleX = 1;
    if (imgWidth > screenWidth)
        scaleX = screenWidth/imgWidth;
    var imgHeight = imageObj.naturalHeight;
    var screenHeight = canvas.height;
    var scaleY = 1;
    if (imgHeight > screenHeight)
        scaleY = screenHeight/imgHeight;
    var scale = scaleY;
    if(scaleX < scaleY)
        scale = scaleX;
    if(scale < 1){
        imgHeight = imgHeight*scale;
        imgWidth = imgWidth*scale;          
    }

    canvas.height = imgHeight;
    canvas.width = imgWidth;

    context.drawImage(imageObj, 0, 0, imageObj.naturalWidth, imageObj.naturalHeight, 0,0, imgWidth, imgHeight);
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-04T18:11:49.797

如果您想根据屏幕尺寸正确缩放图片，可以使用以下代码：

```
var imgWidth = imageObj.naturalWidth;
var screenWidth  = $(window).width() - 20; 
var scaleX = 1;
if (imageWdith > screenWdith)
  scaleX = screenWidth/imgWidth;
var imgHeight = imageObj.naturalHeight;
var screenHeight = $(window).height() - canvas.offsetTop-10;
var scaleY = 1;
if (imgHeight > screenHeight)
  scaleY = screenHeight/imgHeight;
var scale = scaleY;
if(scaleX < scaleY)
  scale = scaleX;
if(scale < 1){
  imgHeight = imgHeight*scale;
  imgWidth = imgWidth*scale;      
}
canvas.height = imgHeight;
canvas.width = imgWidth;
ctx.drawImage(imageObj, 0, 0, imageObj.naturalWidth, imageObj.naturalHeight, 0,0, imgWidth, imgHeight); 
```

如果您不使用 jQuery，请替换`$(window).width`为适当的等效选项。

# php - 连接php与Android，安全方法

> ID：10841533
> 
> 赞同：0
> 
> 时间：2012-05-31T21:27:41.240
> 
> 标签：php, android, api

我正在将数据从 Android 应用程序发送到接收信息并对其进行处理的 php 脚本，我发现了一个安全问题：如果有人发现了 url（例如：mydomain.com/recievedata.php），任何人都会能够将数据发送到我的系统。

确保发送数据的客户端是应用程序的理想方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T21:44:35.873

我见过一些公司做的一种简单的方法是包含一个密钥。例如，您`secret=3CH6knCsYmvA2va8GrHk4mf3JqmUctCM`的 POST 数据可能有一个参数。那么你需要的`receivedata.php`只是

```
if($_POST['secret'] != '3CH6knCsYmvA2va8GrHk4mf3JqmUctCM') {
    header('HTTP/1.1 403 Forbidden');
    error_log("ERROR: wrong secret: " . $_POST['secret']);
    exit("Access denied");
} 
```

[您可以轻松地从random.org](https://www.random.org/strings/)生成随机字符串。

当然，这不是最安全的方法，而且该字符串很可能以明文形式存储在 APK 中（不要使用它来发送启动代码！），但它很容易且足以让大多数人远离。例如，这可能足以发送游戏的玩家分数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T21:48:12.020

这更像是一个 PHP 问题。以下是您应该为安全做的事情；

*   在您的应用和您的 PHP 之间添加一个哈希以同步（AKA 密钥）
*   确保您的脚本控制每个输入数据
*   不要在不转义的情况下将数据发送到查询（SQL 注入）
*   尝试使用 POST 而不是 GET 或 REQUEST
*   尽可能保持函数的私密性
*   始终解析您收到的数据（检查它是数字、字符串还是数组等）

有了这些，没有人可以在没有您的应用程序的情况下使用您的任何 PHP 文件。未经您的许可，他们将无法接收任何数据

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:36:18.640

唯一正确的方法是不信任您收到的数据。始终以适合来自坏人的精心制作的数据的方式处理它。

# objective-c - textFieldShouldReturn 不在 iPad 应用程序中触发

> ID：10841535
> 
> 赞同：0
> 
> 时间：2012-05-31T21:27:44.947
> 
> 标签：objective-c, xcode4, storyboard

我有一个使用带有 Storyboard 的 XCode 4 创建的 iPad 应用程序。我有一个 UITableViewController，其接口定义如下：

```
@interface CustomerViewController : UITableViewController <UITextFieldDelegate> 
```

在 .m 文件中，我有一个代码片段：

```
- (BOOL) textFieldShouldReturn:(UITextField *)textField  {

if(textField == businessName)  {
    [email becomeFirstResponder];
    return true;
} 
```

'textFieldShouldReturn' 方法不会被执行。还需要做什么？（顺便说一句......我从来没有能够让它在 iPad 应用程序中工作，但在 iPhone 应用程序中总是成功的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:48:43.093

在 textFieldShouldReturn 方法中，您正在测试 textField 是否等于 businessName。我假设这是一个 UITextField 对象，但您必须设置委托以接收回调。只是一个简单的 self.businessName.delegate = self; 当您创建 TextField 时。

另一个提示，我建议称它为 businessNameTextField 之类的名称。整个代码更容易阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:31:11.843

您必须将视图控制器设置为文本字段的委托，仅声明您符合协议是不够的。如果它适用于 iPhone 但不适用于 iPad，那么您可能没有在 iPad 故事板中链接代理插座，但您在 iPhone 中有。

# jquery - jQuery遍历contiguos peers

> ID：10841537
> 
> 赞同：0
> 
> 时间：2012-05-31T21:27:59.837
> 
> 标签：jquery, traversal

我有一系列不同类别的行。

```
<tr class="head">...
<tr class="group">...
<tr class="item">...
<tr class="item">...
<tr class="item">...
<tr class="group">...
<tr class="item">...
<tr class="item">...
<tr class="item">...
<tr class="group">...
<tr class="item">...
<tr class="item">...
<tr class="item">... 
```

假设我的上下文在其中一个项目中，我如何选择之前、之后和包括它的所有行，即项目，而不跨越组？

在此示例中，无论我在哪个项目行，我都应该始终生成三个项目行的集合。

目前我有这个，虽然它有效，但我希望有一种更清洁的方法。

```
var $itemRows = $targetRow.prevUntil('tr.group').add($targetRow.nextUntil('tr.group')).add($targetRow); 
```

类似的东西`.siblings('tr.item')`会得到所有九个项目，而不是三个连续的项目。而且我不能把它们放在 tbody 中，因为这已经在 tbody 中并且嵌套它们是无效的 html。

我已将其改进为

```
var $itemRows = $targetRow.prevAll('tr.group:first').nextUntil('tr.group'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:38:42.420

假设`this`是其中一行（而不是组），您可以这样做：

在测试了许多场景之后，我发现这是有效的：

```
$(this).prevUntil('tr.group').andSelf().nextUntil('tr.group').andSelf() 
```

问题是当您单击组中的第一个项目时，其他组合（如 gdoron）对我不起作用。

您可以在这里看到这项工作：http: [//jsfiddle.net/jfriend00/mks74/](http://jsfiddle.net/jfriend00/mks74/)

* * *

我认为必须有一种更清洁的方法，所以我一直在努力，这就是我发现的：

```
$(this).prevAll('tr.group:first').nextUntil('tr.group') 
```

您可以在这里看到这项工作：http: [//jsfiddle.net/jfriend00/HZVnX/](http://jsfiddle.net/jfriend00/HZVnX/)

* * *

这里有用的（jQuery 似乎没有提供）是一个 jQuery 方法，它获取满足某些选择器标准的先前兄弟。我们可以自己制作这样的：

```
jQuery.fn.prior = function(selector) {
    return (this.pushStack(this.prevAll(selector).first()));
}; 
```

然后，解决这个问题的代码变得更符合逻辑：

```
$(this).prior('tr.group').nextUntil('tr.group') 
```

# python - Pandas：数据透视表中的列名列表

> ID：10841538
> 
> 赞同：4
> 
> 时间：2012-05-31T21:28:05.187
> 
> 标签：python, pivot, pandas

我在试图获取 a 的结果名称时遇到了困难`pivot table`。`to_string()`使用如下所示打印的表格。

我想创建一个列表，其中包含`('a_Zero', 'b_Inst')`我几天来一直在寻找的列的名称，但我仍然坚持尝试这样做。

我正在使用熊猫 0.7

```
 sales             
        finprod              a_Zero       b_Inst
        year month                              
        2012 a_January   3146232.37  13441659.22
              b_February  3335326.18  13493656.53
              c_March     3474579.38  14436167.32
              d_April     3033910.51  14244641.16
              e_May       1403770.07   6757142.50 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T17:02:25.897

您可以使用：

`pivot.columns.tolist()`

# clojure - Clojure、core.logic、mini-kanren、Reasoned Schemer

> ID：10841540
> 
> 赞同：1
> 
> 时间：2012-05-31T21:28:31.497
> 
> 标签：clojure, logic, clojure-core.logic

## 代码

```
(defn ex20 []
  (run*
    [x]
    (resto '(c o r n) (list x 'r 'n))))

(defn ex20a []
  (run*
    [x]
    (resto '(c o r n) `(~x r n)))) 
```

## 结果

```
(ex20) -> (o)
(ex20a) -> () 
```

## 问题：

为什么？这是怎么回事？run* 和宏之间是否有一些奇怪的交互？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:43:58.967

语法引用命名空间符号：

```
(defn ex20a []
  (run* [x]
    (resto `(c o r n) `(~x r n)))) 
```

或者

```
(defn ex20a []
  (run* [x]
    (resto '(c o r n) (list x 'r 'n)))) 
```

# html - 悬停时超链接的下划线部分

> ID：10841545
> 
> 赞同：0
> 
> 时间：2012-05-31T21:28:42.660
> 
> 标签：html, css

我有一个包含两个跨度元素的复合超链接，其中一个我想在悬停时加下划线，另一个不加下划线。[一个很好的例子是Twitter](http://twitter.com)推文顶部的名称/用户名链接对。我只是想不通他们是怎么做到的。

我的尝试：

**HTML：**

```
<a href="http://www.google.com">
<span class="main">My link</span>
<span class="caption"> and caption</span>
</a>​ 
```

**CSS：**

```
a {
    text-decoration:none;
    font-weight:bold;
}
a:hover {
    text-decoration:underline;            
}
a span.caption {
    color:gray;
    font-weight:normal;
}
a span.caption:hover {
    text-decoration:none; /* I want this to portion to not be underlined, but it still is */
} 
```

小提琴：http: [//jsfiddle.net/vgKSh/1/](http://jsfiddle.net/vgKSh/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:31:28.433

```
一种 {
    文字装饰：无；
    字体粗细：粗体；
}
一：悬停跨度{
    文字装饰：下划线；            
}
一个 span.caption {
    颜色：灰色；
    字体粗细：正常；
}
一：悬停跨度。标题{
    文字装饰：无；
}
​</pre>

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:32:23.007

你几乎明白了。只放在课堂上`text-decoration:underline;`。`main`

```
a {
    text-decoration:none;
    font-weight:bold;
}
a span.caption {
    color:gray;
    font-weight:normal;
}
a span.main:hover {
    text-decoration:underline;
} 
```

[http://jsfiddle.net/vgKSh/9/](http://jsfiddle.net/vgKSh/9/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T21:32:43.747

在此处分叉并修复：http: [//jsfiddle.net/CtD8M/](http://jsfiddle.net/CtD8M/)

只需将特定跨度设置为文本装饰下划线，而不是全局设置

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T21:33:03.157

小提琴：http: [//jsfiddle.net/vgKSh/4/](http://jsfiddle.net/vgKSh/4/)

```
a {
    text-decoration:none;
    font-weight:bold;
}
a:hover span.main {
    text-decoration:underline;            
}
a span.caption {
    color:gray;
    font-weight:normal;
}
a:hover span.caption {
    text-decoration:none;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-31T21:33:27.000

```
a:hover span {
    text-decoration:none;            
}

a:hover .main{
    text-decoration: underline;            
} 
```

作为一种风格，我从不使用 text-decoration 而是使用 border-bottom 来代替一些填充。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-31T21:34:41.197

```
a {
    text-decoration:none;
    font-weight:bold;
}
a:hover {
    text-decoration:none;            
}
a span.caption {
    color:gray;
    font-weight:normal;
}
a span.main:hover {
    text-decoration:underline;
} 
```

# python - Python代数分数

> ID：10841548
> 
> 赞同：1
> 
> 时间：2012-05-31T21:29:17.897
> 
> 标签：python, algebra, fractions

我不想承认，但是这一行代码给我带来了一些麻烦。

```
print 15 + (-1*(((yearnum + yearnum / 4 - yearnum / 100 + yearnum / 400) + 11) % 7)) % 7 
```

为什么这不等于？

```
print 15 + (-1*(((497 * yearnum / 400) + 11) % 7)) % 7 
```

也许我已经完全忘记了分数是如何工作的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:35:10.480

`(yearnum + yearnum / 4 - yearnum / 100 + yearnum / 400)`不等于`(497 * yearnum / 400) + 11) % 7)`整数除法的结果（Python 限制整数除法的结果）。

# sql - Create a unique float id?

> ID：10841554
> 
> 赞同：0
> 
> 时间：2012-05-31T21:29:40.380
> 
> 标签：sql, sql-server-2008

I don't know how to phrase this question, but I'm trying to do this:

```
alter table [TEMP]
add SEQID int identity(1,1) 
```

This works; however, what I really need is a float column instead of an int:

```
alter table [TEMP]
add SEQID **FLOAT** identity(1,1) 
```

I think this is illegal. Please let me know if it is not. Is there a work around to getting a float ID column?

Edit: Is there a way to create the identity column as int, then remove the identity attribute, and then convert the column to a float?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:41:57.623

你可以做你想做的事：

```
create table temp (
    id int identity(1,1),
    fid as cast(id as float)
) 
```

这会将 id 添加为整数，但随后会有另一列通过将其转换为浮点数来计算。

为什么要为遗留系统创建新的 ID？

或者，您可以将计算列添加到现有表中：

```
alter table temp add fid as cast(id as float) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-31T21:43:59.717

我不知道我是否理解你为什么想要一个浮点 ID。该列通常仅存储为 int（bigint、smallint，取决于表...），但 int 将充分唯一地标识表的每一行，以允许您在不污染数据的情况下查询每一行。您只需要确保正确加入表格即可。

如果您真的确定要使用浮点数，那么我认为这就足够了，除非我遗漏了一些东西：

```
alter table [TEMP]
add SEQID float identity(1,1) 
```

# php - CakePHP 2.0+ custom error views using exceptions

> ID：10841555
> 
> 赞同：2
> 
> 时间：2012-05-31T21:29:40.253
> 
> 标签：php, cakephp

I have been reading the following question here: [CakePHP 2.0 - How to make custom error pages?](https://stackoverflow.com/questions/9620363/cakephp-2-0-how-to-make-custom-error-pages)

About creating custom views for exception handling in CakePHP 2.0+ and have been using it as a base to start doing the same in my own application hence starting my own question.

However I'm not following the logic. For example how does the Throw NotFoundException know to call the notFound method in the Errors Controller as I don't see any direct relationship in terms of the naming... Unless I'm missing the point?

In any case I'm looking to add 404, 403, and 401 errors and then be able to create custom views and call them using the exception handler throughout my app.

Can anyone shed more light on this? I'm using the latest version of Cake 2.1

So I have the following code:

```
 App::uses('ExceptionRenderer', 'Error');

    class AppExceptionRenderer extends ExceptionRenderer {

        public function notFound($error) {
            $this->controller->redirect(array('controller' => 'errors', 'action' => 'error404'));
        }
} 
```

And I want to replace that redirect with rendering a custom error view:

I've tried:

```
$this->controller->layout = null;
$this->controller->render('/Errors/error404'); 
```

But that just shows a blank page... Can anyone help me out as I don't want to do the redirect and would much rather follow conventions and render actual views with the same url when getting errors.

**Update:** Also noticed that the custom views ONLY get called when exceptions are manually called in the controller, and not for actual errors such as `domain.com/garbageurl` or something else... So it doesn't seem to be doing what I thought!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:44:12.130

看看 core Cake 中的这些文件：

*   [Cake/Error/ErrorHandler.php](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Error/ErrorHandler.php)
*   [Cake/Error/ExceptionRenderer.php](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Error/ExceptionRenderer.php)

这是正在发生的事情：

*   `ErrorHandler::handleException()`是您的[异常处理程序](http://php.net/manual/en/function.set-exception-handler.php)。它在抛出异常时被调用。
*   `ErrorHandler::handleException()`调用`ExceptionRenderer::__construct()`（您的自定义异常渲染器必须扩展`ExceptionRenderer`），它解析抛出的异常的名称，并从中设置`$this->method`。
*   `ErrorHandler::handleException()`然后调用`ExceptionRenderer::render()`which 使用[call_user_func_array()](http://php.net/manual/en/function.call-user-func-array.php)来调用名称为 的方法`$this->method`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T02:47:12.840

我只是在寻找同样的东西，但***找不到***使用`AppExceptionRenderer`. 它只是不允许您拥有单独的 error403 和 error404 模板文件。

所以我只是在我的`/app/View/Errors/error400.ctp` 文件中做了这个......

```
<? if ($error instanceof ForbiddenException) { ?>

    <h4>Whoops! The page you attempted to access 
        requires permissions that you don't have.</h4>  

<? } else { ?>

    <h4>Whoops! We couldn't find the page you were looking for, sorry!</h4> 

<? } ?> 
```

# c++ - MDI 子窗口大小

> ID：10841559
> 
> 赞同：0
> 
> 时间：2012-05-31T21:29:47.960
> 
> 标签：c++, winapi, mdi, mdichild

我正在尝试在 MDI MainWindow 中创建一个子窗口...主窗口大小为 1024 x 768...当我尝试使用 CreateWindowEx() 创建子窗口时，大小似乎以某种方式偏移...换句话说，一个 1024 x 768 的子窗口比它的父窗口小……我该如何解释这种差异？当我将 GetCLientRect() 与主窗口的句柄一起使用时……大小仍然更小……我不在乎使子窗口的大小相同。我希望子窗口包含 750x563 图像的确切大小。当我在 CreateWindowEx() 的参数中设置该大小时，子窗口太小了......

这是我在 MainWndProc 中用于创建子窗口的代码：

```
LRESULT CALLBACK MainWndProc(HWND hWnd, UINT Msg,
                             WPARAM wParam, LPARAM lParam)
{
    HDC          hdc;
    PAINTSTRUCT  ps;

    switch(Msg)
    {
        case WM_CREATE:
            {
                //OnCreate(hWnd, NULL);
                CLIENTCREATESTRUCT ccs;

                ccs.hWindowMenu  = GetSubMenu(GetMenu(hWnd), 2);
                ccs.idFirstChild = StartChildrenNo;

                hWndChildFrame = CreateWindowEx(WS_EX_CLIENTEDGE,
                    L"MDICLIENT",
                    NULL,
                    WS_CHILD | WS_CLIPCHILDREN | WS_VSCROLL
                    | WS_HSCROLL | WS_VISIBLE,
                    0,
                    0,
                    1024,
                    768,
                    hWnd,
                    (HMENU)IDM_FILE_NEW,
                    GetModuleHandle(NULL),
                    (LPVOID)&ccs);

                if(hWndChildFrame == NULL)
                    MessageBox(hWnd, L"Could not create MDI client.", L"Error", MB_OK | MB_ICONERROR);

                CreateNewMDIChild(hWndChildFrame);              
                                return 0;
            } 
```

... }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:43:58.280

1.  要确定 MDI 子窗口的大小如何变大，请使用`GetClientRect()`MDI 客户端窗口。

2.  要计算 MDI 子窗口所需的窗口大小，请使用`AdjustWindowRect()`或`AdjustWindowRectEx()`. 那些可以在窗口和客户端大小之间转换。

# facebook - 如何正确处理用户注册和重定向？

> ID：10841564
> 
> 赞同：0
> 
> 时间：2012-05-31T21:30:16.247
> 
> 标签：facebook, facebook-javascript-sdk, registration

我有一个使用旧版本 FB API 的注册表单。

我正在尝试将其更新到当前版本，并且在处理来自 FB 的响应时遇到问题。

单击 FB 登录按钮并授予权限（电子邮件、publish_stream）后，我找不到知道用户已授予访问权限（而不仅仅是作为已注册用户登录）并需要继续进行注册的下一页的方法形式。

权限请求成功后的响应与登录成功相同：

```
{
    authResponse:
    {
        accessToken:    AAAFEIew...URYo,
        userID:         100003908595992,
        expiresIn:      6014,
        signedRequest:  uhTqZodDn0QUoWAUBuYEKmlaM8zViO0r_fnKONaC4v8.eyJhbGdvcml...k5MiJ9,
    },
    status: connected
} 
```

如何判断登录是已注册用户的结果还是新注册的结果？

我正在使用 JavaScript SDK。

代码：

```
<script src="http://connect.facebook.net/en_US/all.js" type="text/javascript"></script>

                <div id="fb-root" style="padding: 0px;"></div>
                <script>
                    window.fbAsyncInit = function() {
                        FB.init({
                            appId      : 'API_KEY',
                            status     : true,
                            channelUrl : '//'+window.location.hostname+'/channel.php',
                            cookie     : true,
                            xfbml      : true,
                            oauth      : true
                        });

                        // listen for and handle auth.statusChange events
                        FB.Event.subscribe('auth.statusChange', function(response) {
                            if (response.authResponse) {
                                // user has auth'd your app and is logged into Facebook
                                alert('logged in!');
                            }
                            else
                            {
                                // user has not auth'd your app, or is not logged into Facebook
                                alert('not logged in!');
                            }
                        });

                    };
                    (function(d){
                        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
                        js = d.createElement('script'); js.id = id; js.async = true;
                        js.src = "//connect.facebook.net/en_US/all.js";
                        d.getElementsByTagName('head')[0].appendChild(js);
                    }(document)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:50:11.003

这是我在尝试做你正在做的事情时使用的资源。它工作得非常好。

```
window.fbAsyncInit = function() {
    FB.init({ appId: 'Your_APP_ID',
        status: true,
        cookie: true,
        xfbml: true,
        oauth: true});

    showLoader(true);

    function updateButton(response) {
        button       =   document.getElementById('fb-auth');
        userInfo     =   document.getElementById('user-info');

        if (response.authResponse) {
            //user is already logged in and connected
            FB.api('/me', function(info) {
                login(response, info);
            });

            button.onclick = function() {
                FB.logout(function(response) {
                    logout(response);
                });
            };
        } else {
            //user is not connected to your app or logged out
            button.innerHTML = 'Login';
            button.onclick = function() {
                showLoader(true);
                FB.login(function(response) {
                    if (response.authResponse) {
                        FB.api('/me', function(info) {
                            login(response, info);
                        });
                    } else {
                        //user cancelled login or did not grant authorization
                        showLoader(false);
                    }
                }, {scope:'email,user_birthday,status_update,publish_stream,user_about_me'});
            }
        }
    }

    // run once with current status and whenever the status changes
    FB.getLoginStatus(updateButton);
    FB.Event.subscribe('auth.statusChange', updateButton);
};
(function() {
    var e = document.createElement('script'); e.async = true;
    e.src = document.location.protocol
        + '//connect.facebook.net/en_US/all.js';
    document.getElementById('fb-root').appendChild(e);
}()); 
```

参考：[http ://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/](http://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/)

信仰斯隆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:15:57.813

我意识到我需要使用 FB SDK 中的 getLoginStatus 函数。

我的功能代码是：

```
<script>
    window.fbAsyncInit = function() {
        FB.init({
            appId       : '<?php echo HSWI_FB_KEY; ?>',
            status      : true,
            logging     : true,
            channelUrl  : '//'+window.location.hostname+'/channel.php',
            cookie      : true,
            xfbml       : true,
            oauth       : true
        });

        FB.Event.subscribe('auth.login', function(response)
        {
            window.location.href    = '/login_script.php';
        });

        FB.Event.subscribe('auth.logout', function(response) {
            window.location.reload();
        });

        checkLoggedInFB();

    };
    (function(d){
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
    }(document));

    function fbLogin()
    {
        FB.login(
            function(response)
            {
                if(response.authResponse)
                {
                    window.location.href    = '/login_script.php';
                }
            }
        );
    }

    function checkLoggedInFB()
    {
        try
        {
            FB.getLoginStatus(
                function(response)
                {
                    if(response.status == 'connected')
                    {
                        window.location.href    = '/login_script.php';
                    }
                }
            );
        }
        catch(e)
        {
            alert('Error checking if logged into FB: '+ e.message);
            return false;
        }
        return true;
    }

</script>
<style type="text/css">
    .fb-login-button
    {
        margin-top: -15px;
    }

    .fb-login-button.fb_iframe_widget.fb_hide_iframes
    {
        display: none;
    }
</style>
<div class="fb-login-button" scope="email,publish_stream,user_birthday,user_location,user_about_me">Login</div> 
```

# asp.net - ASP.net: Scrape Part of webage

> ID：10841569
> 
> 赞同：0
> 
> 时间：2012-05-31T21:31:01.707
> 
> 标签：asp.net, scrape

```
 Dim url As New Uri("http://www.testpage.com")
    If url.Scheme = Uri.UriSchemeHttp Then
        'Create Request Object
        Dim objRequest As HttpWebRequest = DirectCast(HttpWebRequest.Create(url), HttpWebRequest)
        'Set Request Method
        objRequest.Method = WebRequestMethods.Http.[Get]
        'Get response from requested url
        Dim objResponse As HttpWebResponse = DirectCast(objRequest.GetResponse(), HttpWebResponse)
        'Read response in stream reader
        Dim reader As New StreamReader(objResponse.GetResponseStream())
        Dim tmp As String = reader.ReadToEnd()
        objResponse.Close()
        'Set response data to container
        Label1.Text = tmp
    End If 
```

How Would I only scrape part of a webpage..The code succesfulyl get the full html content.

For Example..I want to scrape eveyrthing between `<div id="content"> </div>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:38:41.497

在字符串变量中拥有页面的完整 html 内容后，您可以在此字符串上使用正则表达式来返回要提取的部分。

由于您尚未提供有关要提取的内容的详细信息，因此我将为您提供有关如何使用正则表达式的链接。

可以在[此处找到有关正则表达式的简短教程](http://www.codeproject.com/Articles/9099/The-30-Minute-Regex-Tutorial "这里")

# r - 在 R 中使用列表

> ID：10841573
> 
> 赞同：0
> 
> 时间：2012-05-31T21:31:28.127
> 
> 标签：r

对不起，可能是一个完整的菜鸟问题，但我今天才开始用 R 编程，我已经被困住了。

我正在从格式的文件中读取一些数据。

```
3.482373 8.0093238198371388 47.393873
0.32 20.3131 31.313 
```

我想要做的是拆分每一行，然后处理每个单独的数字。

我已经导入了 stringr 包并使用

```
x = str_split(line, " ") 
```

这会产生一个我想索引但不知道如何索引的列表。

我了解到 x[[1:2]] 获得了第二个元素，但仅此而已。理想情况下，我想要类似的东西

```
x1 = x[1]
x2 = x[2]
x3 = x[3] 
```

但无论如何都找不到这样做。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:50:32.530

通过使用`unlist`，您将获得一个向量而不是向量列表，然后您将能够直接对其进行索引：

```
R> unlist(str_split("foo bar baz", " "))
[1] "foo" "bar" "baz" 
```

但也许您应该直接从 read.table 或其变体之一读取您的文件？

如果你从 R 开始，如果你想了解子集、索引等，你真的应该阅读可用的介绍之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:46:33.977

您可以将调用包装为`str_split`with`unlist`以获得您正在寻找的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:49:24.180

获取它的通常方法是将其导入数据框（一种特殊的列表）。如果文件名为“fil.dat”并且位于“C:/dir/”中

```
 dfrm <- read.table("C:/dir/fil.dat")  # resist the temptation to use backslashes
 dfrm[2,2]   # would give you the second item on the second row. 
```

默认情况下，R 中的字段分隔符是“空白”，这似乎是您所拥有的，因此您不需要提供`sep=`参数并且 read.table 函数将尝试导入为数字。为了安全起见，您可能会考虑强制使用该选项，`colClasses=rep("numeric", 3)`因为如果遇到奇怪的项目（例如经常由 Excel 转储生成的项目），您将获得一个因子变量，并且可能无法理解如何优雅地恢复。

# asp.net-mvc-3 - 视图异常未显示 MVC 3 自定义/Http 错误页面

> ID：10841580
> 
> 赞同：6
> 
> 时间：2012-05-31T21:32:18.713
> 
> 标签：asp.net-mvc-3

我在 ASP.NET MVC 3 应用程序中设置了自定义/http 错误，这些错误将显示在错误中。我`Web.Config`的`httpErrors`部分如下所示：

```
 <httpErrors errorMode="Custom" existingResponse="Replace">
        <remove statusCode="400" />
        <remove statusCode="403" />
        <remove statusCode="404" />
        <remove statusCode="408" />
        <remove statusCode="500" />
        <remove statusCode="503" />
        <error statusCode="400" responseMode="ExecuteURL" path="/Error/BadRequest" />
        <error statusCode="403" responseMode="ExecuteURL" path="/Error/Forbidden" />
        <error statusCode="404" responseMode="ExecuteURL" path="/Error/NotFound" />
        <error statusCode="408" responseMode="ExecuteURL" path="/Error/Timeout" />
        <error statusCode="500" responseMode="ExecuteURL" path="/Error/InternalServerError" />
        <error statusCode="503" responseMode="ExecuteURL" path="/Error/ServiceUnavailable" />
    </httpErrors> 
```

我没有设置`customerErrors`设置，因为这不适用于 MVC 和 IIS 7.5。

当代码中发生异常时，一切正常。

但是，当视图中引发异常时 - 它会尝试显示`~/Views/Shared/Error.cshtml`我没有的默认值。

可能引发错误的视图可能是这样的：

```
@Html.Partial("TemplateSection", Model.PreContent) 
```

并且想象`PreContent`为空，并且`TemplateSection`通过执行以下操作显示值时视图将失败：`@Model.Name`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T02:16:46.577

I read [this article](http://www.digitallycreated.net/Blog/57/getting-the-correct-http-status-codes-out-of-asp.net-custom-error-pages) and have had no problems since dropping my resulting code into production 48 hours ago. Give it a whirl.

# ruby-on-rails - 太阳黑子范围内的查询不起作用

> ID：10841590
> 
> 赞同：0
> 
> 时间：2012-05-31T21:33:08.507
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sunspot, sunspot-rails

我正在使用带有范围查询的[Sunspot](https://github.com/sunspot/sunspot)实现全文搜索，但它不起作用。当我删除“with”查询和搜索时，它可以工作，但是当我在其中添加查询时，它不会。我查看了文档，它的结构应该正确，有什么想法吗？

名称和类别都是 Items 表中的字符串。作为一个简单的尝试，我一直在尝试只使用空搜索来获取“电子产品”项目，这通常会导致所有项目都显示为没有查询。

模型

```
searchable do
  text :name, :category
  string :category
end 
```

控制器

```
def search
  @search = Item.search do
    fulltext (params[:search])
    with(:category, 'electronics')
  end

  @items = @search.results

  respond_to do |format|
    format.html
    format.js
  end
end 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-08T12:55:08.560

我遇到了这个问题，我的`with`过滤器没有导致任何结果。

重新启动 Rails/Solr 然后运行`rake sunspot:reindex`为我修复了它。

我尝试`rake sunspot:reindex`了几次运行（沮丧地），但直到我重新启动 Solr 然后重新建立索引，它才起作用。

我猜这是因为我通过 Foreman 启动 Sunspot `Procfile`，并且绑定到 Solr 的 Rails 实例在您更改它们时不会重新加载模型类。（类似于它处理`worker`进程的方式......您必须重新启动 Rails 才能让 Foreman 获取对作业代码的更改。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T07:37:42.933

您已将字段 :category 定义为文本和字符串。从您的控制器代码中可以看出，您希望将其用作字符串。修改您的 :category 声明后问题会消失吗？

顺便说一句，name 在这里做什么 - 当然 name 必须是一个字符串。您的模型中有文本字段吗？text 这里的意思是一大块文本，可能有数百个字符，如果不是数千个的话。

# excel - 使用excel VBA将公式结果转换为字符串

> ID：10841598
> 
> 赞同：0
> 
> 时间：2012-05-31T21:34:04.223
> 
> 标签：excel, vba

我正在做一个项目，该项目需要我将访问中的数据吐出到 excel 上，然后在 excel 中进行一些计算后最终导出到 SQL 中。当我从 Access 获取数据到 excel 中时，我使用的是 excel 公式，例如

```
=RIGHT(F87616,4) 
```

和

```
=IFERROR(MID(F87616,1,FIND("-",F87616,1)-1),"") 
```

现在，我想做的是，用这些单元格的结果替换这个公式，这样当我从 Excel 导出到 SQL 时，我可以将这些数据作为字符串提取。

我知道这听起来可能很令人困惑，但基本上我试图用使用公式计算值后得到的结果替换公式。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T20:06:49.050

如果你特别对一个单元格做某事，你可以做*range* .Value （而不是*range* .Formula 或*range* .FormulaR1C1 两者都返回公式而不是结果）。

# tfs - TFS 2012 中的“积压优先级”值代表什么？

> ID：10841600
> 
> 赞同：4
> 
> 时间：2012-05-31T21:34:14.853
> 
> 标签：tfs

在 TFS 2012 Web Access 中，您可以拖放待办事项中的项目以调整优先级。我在调整积压后查看了一个工作项的历史记录，并注意到一个特殊的值作为我的新“积压优先级”。有谁知道这个数字代表什么？我很好奇，因为我在调整团队积压中的积压优先级时遇到了一个更大的问题，也会对父（项目）积压做奇怪的事情。所以如果我能弄清楚这个值代表什么，我就能弄清楚我的其他东西。

![在此处输入图像描述](../Images/aa05f40bf9749a6557c377a866b693ef.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T04:27:09.403

现在是用于排序的堆栈等级字段。当您使用 Team Web Access 的 Product Backlog 视图堆叠排名项目时如何更新它的算法是您获得有趣数字的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T21:53:55.663

在 TFS 2010 中，它用于订购您的 Product Backlog，默认值为 1000。我相信在 TFS 11 中，他们现在已经接管了这个值，只需调整它以反映您在 backlog 中指定的顺序。换句话说，它们在积压优先级编号之间留有足够的空间，以允许新的 PBI 和更改任何 PBI 的顺序。

# iphone - 处理动态 UITableViewCell 高度的更好方法？

> ID：10841601
> 
> 赞同：1
> 
> 时间：2012-05-31T21:34:26.627
> 
> 标签：iphone, cocoa-touch, dynamic, uitableview

我正在实现一个 UITableView，其中表格单元格包含多个控件，例如标签和按钮。单元格顶部的标签之一可以包含不同数量的文本，因此每个单元格的整体大小也必须有所不同。所以基本上，这是您在各处看到的动态表格单元格问题。

我似乎找到的事实上的解决方案是我正在使用的[这个](http://www.cimgf.com/2009/09/23/uitableviewcell-dynamic-height) ，但我不太关心它，因为它带有维护问题。由于单元格中有很多其他东西，我必须有很多硬编码的高度来表示在确定单元格的整体大小和根据单元格的大小布置所有内容时必须考虑的所有其他控件动态内容。

这是一些代码：

```
- (CGFloat) tableView:(UITableView*)tableView
            heightForRowAtIndexPath:(NSIndexPath*)indexPath
{
    SomeDataItem* item = [self.myData objectAtIndex:indexPath.row];
    CGSize constraintSize = CGSizeMake(275, MAXFLOAT);
    CGSize labelSize = [item.message sizeWithFont:[UIFont systemFontOfSize:13]
                                constrainedToSize:constraintSize 
                                    lineBreakMode:UILineBreakModeWordWrap];

    return HEADER_HEIGHT + OUTER_MARGIN + labelSize.height +
           INNER_MARGIN + INNER_MARGIN + OUTER_MARGIN +
           BUTTON_HEIGHT + OUTER_MARGIN;
}

- (UITableViewCell*)tableView:(UITableView*)tableView
                    cellForRowAtIndexPath:(NSIndexPath*)indexPath
{
    ...
    NSString* message = //some dynamic text
    CGSize constraintSize = CGSizeMake(275, MAXFLOAT);
    CGSize labelSize = [message sizeWithFont:[UIFont systemFontOfSize:13]
                           constrainedToSize:constraintSize
                               lineBreakMode:UILineBreakModeWordWrap];

    //resize label according to amount of text
    cell.messageLabel.frame = CGRectMake(cell.messageLabel.frame.origin.x,
                                         cell.messageLabel.frame.origin.y,
                                         cell.messageLabel.frame.size.width, 
                                         labelSize.height);

    //now move controls below the dynamic label down
    y = HEADER_HEIGHT + OUTER_MARGIN;
    [self setView:cell.messageTextBackground yCoord:y];

    y += INNER_MARGIN;
    [self setView:cell.messageLabel yCoord:y];

    y += labelSize.height;
    [self setView:cell.anotherLabel yCoord:y];

    y += OUTER_MARGIN;
    [self setView:cell.someButton yCoord:y];
}

- (void) setView:(UIView*)view yCoord:(NSInteger)y
{
    int x = view.frame.origin.x;
    int w = view.frame.size.width;
    int h = view.frame.size.height;
    view.frame = CGRectMake(x, y, w, h);
} 
```

这只是代码的一种近似，让您了解我在做什么。如您所见，这有点混乱。如果我必须为动态标签旁边的所有其他控件保留#define 值。如果我想更改任何这些控件的大小，我必须在 XIB 文件中进行，然后还要记住更新#define 值。更糟糕的是，如果我想引入一些新的控件，我必须同时修改这两种方法，并确保一切仍然得到正确计算和偏移。

这对我来说似乎很荒谬，但我还没有找到任何其他方法来做到这一点。如果您可以访问 tableView:heightForRowAtIndexPath 中的表格单元格，那么您可以根据实际控件计算所有内容，而不必对所有内容进行硬编码。但是，根据我阅读和体验的内容， tableView:heightForRowAtIndexPath 在单元格存在之前就被调用了，所以你不能这样做。

我不知道我是如何处理这个问题的，还是这是唯一的出路？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:41:27.047

更干净地处理此问题的一种可能方法是将所有不变的视图/控件放入具有固定大小的父视图中，然后您可以只询问该视图的框架并使用高度。这样，如果您编辑视图的静态部分，则无需更改大小调整代码。由于您只需移动封闭视图，因此还可以更轻松地向下移动静态项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:42:49.123

我认为你在做正确的事。至少我是这样做了一段时间的。维护应该没问题，你只需要做你提到的事情。

您也许可以`#define`通过使用单元格的 XIB 文件、加载 xib 文件`viewDidLoad`并提取那里的各种元素的大小来减少您的语句。然后，您以后只需在 XIB 文件中更改它们。

当然，包含不变元素的包装视图可能是一个额外的帮助。

# ios - 如何给应用程序图标一个没有数字的通知徽章？

> ID：10841605
> 
> 赞同：9
> 
> 时间：2012-05-31T21:34:48.030
> 
> 标签：ios, apple-push-notifications

在 Apple 的本地和推送通知编程指南的第 7 页上，有一个 iPhone 桌面的屏幕截图，其中一个应用程序图标有一个不包含数字的徽章 - 它只是纯红色。

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-24T02:15:27.017

我认为当前的通知 API 无法实现您想要做的事情。如果要在应用程序图标上显示徽章，则必须在 APNS 有效负载中使用“徽章”键，并且该键的值必须是整数。

即使本地通知 API 也有相同的限制，您可以使用 applicationIconBadgeNumber 属性更改徽章值，但不幸的是，此属性仅接受整数。

似乎只有内置应用程序（例如手机应用程序）可以显示没有数字的徽章。

# java - 如何编译我的 Java 源文件

> ID：10841608
> 
> 赞同：0
> 
> 时间：2012-05-31T21:35:09.860
> 
> 标签：java

我对这个 JAVA RMI 项目真的很陌生。我只是想知道我可以使用什么编译器来编译我的 JAVA 源代码？怎么做？

*   我正在尝试从[http://www.eg.bucknell.edu/~cs379/DistributedSystems/rmi_tut.html编译示例源代码](http://www.eg.bucknell.edu/~cs379/DistributedSystems/rmi_tut.html)

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:37:57.590

你只需要做javac，没有特殊要求。参考这个[链接。](http://docs.oracle.com/javase/tutorial/rmi/example.html)

# .net - SharpSnmp 与 SnmpSharpNet

> ID：10841613
> 
> 赞同：5
> 
> 时间：2012-05-31T21:35:48.450
> 
> 标签：.net, api, snmp, sharp-snmp

我即将开始一个需要通过 C# 创建 SNMP 代理的项目。我从未使用过 SNMP，因此我计划使用现有的库/api，例如[SharpSnmp](http://sharpsnmplib.codeplex.com/)或[SnmpSharpNet](http://www.snmpsharpnet.com/)。

我正在寻找任何对这两个 api 都有个人经验并且对哪个更好以及为什么有意见的人的回应。- 或者你的意见是它们是相同的差异（即你没有偏好） - 如果是这样，我也对那种回应感兴趣。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T06:07:01.600

作为#SNMP的开发者，我只能提供以下反馈，

# 两者的设计不同（历史回顾）

#SNMP 来自 Malcolm Crowe 的 SNMP 研究项目。当我尝试改进它时，我从头开始重新设计了整个 API，并希望使其自然并适合 C#/.NET 开发人员，类似于 PowerSNMP for .NET ( [http://www.dart.com/psnet.aspx](http://www.dart.com/psnet.aspx) )，但不是克隆。

SNMP#NET 源自其他库，例如 snmp4j，如果您阅读它的主页，[http](http://snmpsharpnet.com/node/1) ://snmpsharpnet.com/node/1 。所以它的 API 看起来也和他们很相似，我个人不喜欢。

# 两者的开发方式不同（软件流程）

#SNMP 从一开始就遵循测试驱动开发。所有关键部分都包含在其单元测试套件中。因此，尽管它在七个主要版本中进行了多次重大重构，但它仍然是一个稳定的代码库。

从 SNMP#NET 我看不到任何单元测试套件。我不知道它是如何测试的。但它也被证明是稳定的。

# 代码库管理方法不同（SCM）

#SNMP 的所有修订版都可以在 CodePlex 上很容易地观察到，后来在 Google Code 上，最后在 GitHub 上。[https://github.com/lextm/sharpsnmplib/commits/master](https://github.com/lextm/sharpsnmplib/commits/master)您可以跟踪几乎所有更改，因为我经常签到。如果您想检查代码库的演变，#SNMP 可以轻松完成。

SNMP#NET 仅发布带有二进制文件的源代码快照。它没有公共存储库。

# 功能集差异

#SNMP 提供了一组命令行实用程序（类似于一些 Net-SNMP 实用程序）来演示如何使用该库。它还提供演示级 MIB 编译器、浏览器和代理。这些示例可作为首次用户了解 API 的起点。

SNMP#NET 有很多关于如何使用 API 的好文章，[http://snmpsharpnet.com/node/6](http://snmpsharpnet.com/node/6)。但它没有很多大规模的样本。特别是 SNMP#NET 还没有 MIB 编译支持，也没有代理开发支持。

# 平台支持差异

#SNMP 几年前已经在 Mono 上进行了测试，后来在非 Windows 操作系统上正式支持 Mono。我不知道 SNMP#NET 是否支持这个。

**更新**从 8.0 版本开始，#SNMP 开始针对移动平台（Android 首先是 Mono，然后是 MonoTouch）。代码库也在 MIT/X11 下重新授权以避免部署问题。

**从 10.0 版本开始**更新，#SNMP 开始以 .NET Standard 为目标。****

 **# 两人的关系

值得注意的是，#SNMP 的 v3 支持的一部分来自 SNMP#NET，[https://blog.lextudio.com/trident-sign-another-open-source-snmp-library-via-c-4f2b904252](https://blog.lextudio.com/trident-sign-another-open-source-snmp-library-via-c-4f2b904252)。这两个项目都是在 LGPL 下发布的，所以我没有尝试重新发明轮子。显然 SNMP#NET 具有更好的隐私方法支持，但是将这些部分移植到 #SNMP 也很容易实现（我确实通过移植 MD5、SHA-1、DES、TripleDES 和 AES128/192/256 支持来证明这一点）。

**从 8.0 版本开始**更新，#SNMP 代码库在 MIT/X11 + BSD 3 条款下重新授权。****

 ****更新**的#SNMP 有一个专业版，其中包括 MIB 文档支持。****

# c# - C# 等价于 Java SSL-socket-connection

> ID：10841625
> 
> 赞同：1
> 
> 时间：2012-05-31T21:36:49.870
> 
> 标签：c#, java, ssl, cisco

大家好，我正在尝试为 Cisco Unified Communications Manager 编写 AXL 客户端 (SOAP)。为此，我需要建立到 AXL 服务的 ssl 连接。不幸的是，我对所有那些 ssl 的东西知之甚少。

但是，我能够找到一个有效的 Java 示例，这正是我想要的。问题是，我需要在 C#.NET 中。所以我希望有人可以在 C# 版本中“翻译”以下 Java 代码。但它必须完全相同，尤其是身份验证和证书。

这是代码：

```
 String sAXLSOAPRequest = "...";
    byte[] bArray = null; // buffer for reading response from
    Socket socket = null; // socket to AXL server
    OutputStream out = null; // output stream to server
    InputStream in = null; // input stream from server

    X509TrustManager xtm = new MyTrustManager();
    TrustManager[] mytm = { xtm };
    SSLContext ctx = SSLContext.getInstance("SSL");
    ctx.init(null, mytm, null);
    SSLSocketFactory sslFact = (SSLSocketFactory) ctx.getSocketFactory();

    socket = (SSLSocket) sslFact.createSocket("192.168.1.100", Integer.parseInt("8443"));
    in = socket.getInputStream();
    // send the request to the server
    // read the response from the server
    StringBuffer sb = new StringBuffer(2048);
    bArray = new byte[2048];
    int ch = 0;
    int sum = 0;
    out = socket.getOutputStream();
    out.write(sAXLSOAPRequest.getBytes());

    while ((ch = in.read(bArray)) != -1) {
        sum += ch;
        sb.append(new String(bArray, 0, ch));
    }
    socket.close();
    // output the response to the standard output
    System.out.println(sb.toString()); 
```

这是 MyTrustManager 类：

```
public class MyTrustManager implements X509TrustManager {
MyTrustManager() {
    // create/load keystore
}

public void checkClientTrusted(X509Certificate chain[], String authType)
        throws CertificateException {
}

public void checkServerTrusted(X509Certificate chain[], String authType)
        throws CertificateException {
}

public X509Certificate[] getAcceptedIssuers() {
    return null;
} 
```

}

任何帮助，将不胜感激。

谢谢

编辑：对不起，我应该提到：你说得对，我可以生成一个代理类，但遗憾的是它不能正常工作。cisco 在这方面做得非常糟糕（更不用说非常糟糕的文档了）。解析某些响应时，代理类会引发一些 xml 错误。所以我必须手动完成这种情况......

我稍后会担心证书的安全性

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:40:04.787

您是否尝试过以“正确”的方式使用 Web 服务？在 Visual Studio 中向 C# 项目添加 SOAP Web 服务引用，获取存根等？这是从 C# 执行此操作的最简单方法。添加引用时，您可以在 URL 中指定 https 协议。

# c# - 访问模拟用户密钥库

> ID：10841627
> 
> 赞同：0
> 
> 时间：2012-05-31T21:37:00.650
> 
> 标签：c#, impersonation, x509certificate2

我正在模拟一个服务用户帐户，以便连接到需要证书才能连接的 Web 服务。我已经在运行代码的机器上的服务帐户上安装了客户端证书，但是我收到错误 System.Security.Cryptography.CryptographicException：系统找不到指定的文件。

```
 using (var ctx = new ImpersonationContext("svcAcctUserName", "domain", "password"))
 {
    var clientCert = new X509Certificate2("filePath", "certPassword");
 } 
```

模拟代码有效，为简洁起见，我将其省略，但我通过记录 Environment.UserName 检查以确保我的上下文切换到 svcAcctUserName 用户，这表明我正在以 svcAcctUserName 身份运行。filePath 是正确的，我再次忽略了它，但是我在创建 X509Certificate2 对象之前打开并关闭了文件，以确保我可以访问该文件并且我的路径是正确的。

该错误令人困惑，因为我将路径作为参数提供，并且我确定运行代码的用户可以访问。

**编辑：**

还尝试这样做：[如何在 ASP.NET Web 应用程序中使用客户端证书进行身份验证来调用 Web 服务](http://support.microsoft.com/default.aspx?scid=kb;en-us;901183)

虽然我没有使用 asp.net 应用程序，但我还是试了一下。我将证书插件添加到 mmc，添加了“本地计算机”证书插件，然后将证书导入到本地计算机的个人存储中。

然后我跑了：

```
WinHttpCertCfg.exe -g -c LOCAL_MACHINE\My -s issuedToName -a domain\svcAcctUserName 
```

再次尝试运行该操作，仍然是同样的问题。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T23:31:19.150

所以，正如 Alex 所指出的，我不了解 Windows 中证书系统的底层架构。但是，在执行上述步骤并修改我的代码以使用 X509Store 之后，我让它工作了。希望这会帮助某人：

```
using (var ctx = new ImpersonationContext("svcAcctUserName", "domain", "password"))
{
   var store = new X509Store(StoreLocation.LocalMachine);
   store.Open(OpenFlags.ReadOnly | OpenFlags.OpenExistingOnly);
   var clientCert = store.Certificates.Find(X509FindType.FindByIssuerName, "IssuerNameHere", false);
   var clientCert2 = new X509Certificate2(clientCert[0]);
} 
```

# sql-server-2008 - SSRS 中的自定义代码和参数

> ID：10841630
> 
> 赞同：1
> 
> 时间：2012-05-31T21:37:31.563
> 
> 标签：sql-server-2008, ssrs-2008, reporting-services

我正在尝试使用自定义代码选项来下拉查询字符串并在自定义代码中设置报表的参数。所以我可能有一个网址，例如：

```
http://mywebsite.com/index.aspx?ProjectID=1 
```

我希望 SSRS 自定义代码中的代码将其拉下`1`并将其放入报告的参数中。因此，当我运行报告时，它会显示 ProjectID 为 1 的数据。

这可以在报告服务中执行吗？如果是这样，人们将如何去做这件事。感谢您提供的任何帮助，我已经认真地尝试了数周来解决这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T17:36:16.827

SSRS 可以从 URL 中解析参数值，只要它的格式为*parameter=value*。请参阅[此 msdn 文章](http://msdn.microsoft.com/en-us/library/ms155391%28v=sql.105%29.aspx)

您问题中的示例 URL 看起来不像报表服务器 URL，因此（如 bhupendra 所示）很难确切知道您在做什么。

# php - PHP 在类中使用函数

> ID：10841632
> 
> 赞同：-1
> 
> 时间：2012-05-31T21:37:43.403
> 
> 标签：php, class, function

类为我的博客显示不同的视图。

```
class SB_Display {

    public function __contruct() {
        include_once('settings/db.settings.php');

        $mysqli = new mysqli($SB_dbsettings['host'],$SB_dbsettings['user'],$SB_dbsettings['pass'],$SB_dbsettings['dbname']);
    }

    private function List_Display() {

        $VIEW = '';

        include_once('views/list.html.view.php');

        $sql = "SELECT * FROM sb_posts ORDER BY ID DESC LIMIT '$SETTINGS->maxposts'";
        $sql = $mysqli->real_escape_string($sql);
        $res = $mysqli->mysqli_query($sql);

        if($res->numrows > 0) {
        $res->data_seek(0);

            while ($row = $res->fetch_assoc()) {
                foreach($row as $key => $value) {
                $BLOG->$key = $value;
                $VIEW .= $HTML;
                }
            }
        } else {
            $VIEW .= 'No Posts To Display';
        } 

        return $VIEW;
    }

    private function Single_Display($id) {
        $VIEW = '';

        include_once('views/single.html.view.php');

        $sql = "SELECT * FROM sb_posts WHERE BID = '$id'";
        $sql = $mysqli->real_escape_string($sql);
        $res = $mysqli->mysqli_query($sql);
        $row = $res->fetch_assoc();

        foreach($row as $key => $value) {
            $BLOG->$key = $value;
        }

        $VIEW .= $HTML;

        return $VIEW;
    }

    private function Create_Display() {        
        include_once('views/create.html.view.php');
        return $HTML;
    }

    private function Edit_Display($id) {
        $VIEW = '';  

        $sql = "SELECT * FROM sb_posts WHERE BID = '$id'";
        $sql = $mysqli->real_escape_string($sql);
        $res = $mysqli->mysqli_query($sql);
        $row = $res->fetch_assoc();

        foreach($row as $key => $value) {
            $BLOG->$key = $value;
        }
        $BLOG->id = $id;
        $VIEW .= $HTML;

        return $VIEW;

    }

    public function SB_Get_Display($type,$id) {
        switch($type) {
         case 'list':
             $this->content = List_Display();
             return $this;
             break;
         case 'single':
             $this->content = Single_Display($id);
             return $this;
             break;
         case 'create':
             $this->content = Create_Display();
             return $this;
             break;
         case 'edit':
             $this->content = Edit_display($id);
             return $this;
             break;
        }
    }
} 
```

以下列方式使用此类时..

```
$BODY = new SB_Display();
$BODY->SB_Get_Display('list',''); 
```

我收到此错误：

> 致命错误：调用未定义的函数 List_Display()

我不知道为什么。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:38:49.090

您需要使用`$this->function()`而不是`function()`调用方法。

在旁注中，您的构造函数名称不正确。它是`__contruct()`但需要`__construct()`用作构造函数。除此之外，您的缩进很糟糕，使代码难以阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:00:20.437

我同意@Corbin，这是一个非常糟糕的主意。另外，就个人而言，我喜欢自动加载类方法。

有人可能会说这是草率且简单的方法，但它迫使您真正考虑您的类名和目录，并且在重命名文件/类时避免出现问题。在您的情况下，您必须搜索所有试图包含它的文件并手动重命名所有内容。

“我的”方法：在站点的根目录中创建一个 inc.php 或其他内容，并将其放入其中：

**PHP**

```
//autoload classes
function __autoload($class_name){
    set_include_path(get_include_path().PATH_SEPARATOR.'/usr/share/file/'); //also     
    //include magic file location
    // put the path to your class files here
    $path = $_SERVER['DOCUMENT_ROOT'].'/lib/classes/'; 
    // tell PHP to scan the default include path AND your include path
    set_include_path(get_include_path() . PATH_SEPARATOR . $path);
    // name your classes and filenames with underscores, i.e., Net_Whois stored in 
    //Net_Whois.php
    $classfile = str_replace("_", DIRECTORY_SEPARATOR, $class_name) . ".php";
    require_once($classfile);
} 
```

只需在 inc.php 文件中初始化您的数据库连接，您几乎可以在任何地方访问它们。

现在只需在您创建的每个新类中包含 inc.php 文件，您就不必再回头看（当然取决于项目）

# javascript - 需要帮助在音效播放之间插入延迟

> ID：10841633
> 
> 赞同：0
> 
> 时间：2012-05-31T21:37:46.757
> 
> 标签：javascript, android

我对 Android 开发人员仍然很陌生并且被卡住了。我有一个 onTouchEvent，它为旋转图形提供动力并增加了一个背景 int [计数器]，它触发了一个短的声音效果（哔声）来播放。目前，如果 [counter] > 10 a 播放声音（使用 soundpool）并且只要 onTouchEvent 保持 counter > 10 就会立即循环播放。是否可以在哔声效果的播放之间插入延迟，以便延迟[counter] 的值越大越减小？

示例： if (counter == 10) { delay = 80 // 在 MS } if (counter == 90) { delay = 10 // 在 MS }

我的代码：

```
sm = new SoundManager();
    sm.initSounds(getBaseContext());
    sm.addSound(1, R.raw.beep);

...

@Override
public boolean onTouchEvent(MotionEvent event) {

    if (buttonClicked) {
        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            counter++;
            startRotating();
            break;
        case MotionEvent.ACTION_UP:
            counter--;
            stopRotating();
            break;
        }
    }

    return super.onTouchEvent(event);
}

public void startRotating() {
    returnRotating = false;

    if (!keepRotating) {
        keepRotating = true;

        final Handler handler = new Handler();
        handler.postDelayed(new Runnable() {
            @Override
            public void run() {
                if (keepRotating) {
                    degrees = (degrees + 10) % 360;
                    make(degrees);
                    counter = counter + 1;

                    if (counter > 10)
                        sm.playSound(1);  // plays beep

                    handler.postDelayed(this, INTERVAL);
                }
            }
        }, INTERVAL);
    }
} 
```

编辑：添加代码

```
public void stopRotating() {
    keepRotating = false;

    if (!returnRotating) {
        returnRotating = true;

        final Handler handler = new Handler();

        handler.postDelayed(new Runnable() {

            @Override
            public void run() {

                if (returnRotating) {
                    degrees = (degrees - 10) % 360;
                    make(degrees);
                    counter = counter - 1;

                    if (counter > 10) {
                    sm.playSound(1); // plays beep

                    handler.postDelayed(this, INTERVAL);
                }
            }
        }, INTERVAL);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:42:27.327

这样的事情怎么样？

```
 if (counter > 10) {
      sm.playSound(1);  // plays beep 
      INTERVAL = 100 - counter;
      handler.postDelayed(this, INTERVAL); 
```

# c# - 在 WCF 启动时运行函数

> ID：10841635
> 
> 赞同：36
> 
> 时间：2012-05-31T21:37:49.993
> 
> 标签：c#, .net, wcf, rest

我不确定它是否可能，但我希望在 WCF 服务启动后立即运行一个函数以生成初始缓存数据。我现在不担心如何实现缓存，我的问题严格来说是在服务启动时运行该功能。该服务将是 RESTful 的。

该服务最终将托管在 IIS 中并使用 .Net Framework 4.5

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-31T21:40:23.377

最简单的方法是`App_Code`在 WCF 项目根目录下创建一个文件夹，创建一个类（我会调用它，`Initializer`但没关系。重要的部分是方法名称），如下所示：

```
public class Initializer
{
    public static void AppInitialize()
    {
        // This will get called on startup
    } 
} 
```

更多信息`AppInitialize`可以在[这里](https://stackoverflow.com/questions/329936/when-appinitialize-method-get-invoked-in-asp-net)找到。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-05-31T21:55:47.403

@KirkWoll 建议的方法有效，但前提是您在 IIS 中并且这是 App_Code 下唯一的 AppInitialize 静态方法。如果您想在每个服务的基础上进行初始化，如果您有不同的 AppInitialize 方法或者如果您不在 IIS 下，您还有以下其他选项：

*   如果使用 .NET Framework 4.5，并且在 IIS 下：您可以使用服务运行时将调用的服务配置方法。更多信息请访问[http://msdn.microsoft.com/en-us/library/hh205277(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/hh205277(v=vs.110).aspx)。
*   如果您是自托管服务，您可以控制服务何时启动（调用`ServiceHost.Open()`，因此您可以在那里对其进行初始化
*   如果您在 IIS 下，而不是在 4.5 上，则可以使用服务主机工厂和自定义服务主机，以便在打开服务主机时调用。此时，您可以进行初始化。[您可以在http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/14/wcf-extensibility-servicehostfactory.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/14/wcf-extensibility-servicehostfactory.aspx)找到有关服务主机工厂的更多信息。

自定义工厂的示例如下所示：

```
public class MyFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        ServiceHost host = base.CreateServiceHost(serviceType, baseAddresses);
        host.Opening += new EventHandler(host_Opening);
        return host;
    }

    void host_Opening(object sender, EventArgs e)
    {
        // do initialization here
    }
} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-29T21:40:54.230

就我而言，我确实喜欢下面。我有托管 WCF Rest 服务的 Windows 服务项目。我在我的 Windows 服务项目 MyService.cs 中编写了以下代码

```
protected override void OnStart(string[] args)
{
    try
      {
        ServiceHost myServiceHost = new ServiceHost(typeof(myservice));
        myServiceHost.Opening += OnServiceHostOpening;
        myServiceHost.Open();
      }
      catch (Exception ex)
      {
         //handle exception
      }
}

private void OnServiceHostOpening(object sender, EventArgs e)
{
   //do something
} 
```

# asp.net - Visual Studio 解决方案中的多个 Web 应用程序项目

> ID：10841636
> 
> 赞同：2
> 
> 时间：2012-05-31T21:37:56.187
> 
> 标签：asp.net, visual-studio-2010, webforms

我目前正在开始使用 ASP.Net Webforms 开发一个新网站。为了让这个项目有一个正确的开始，我正在研究应用程序的 Visual Studio 解决方案设置，我希望我的应用程序由大小相等（代码行）的易于识别的组件组成。

由于该项目还没有真正开始，我已经在标准的三层设置（数据、业务逻辑和表示）中构建了解决方案。这种设置在项目开始时很好，但随着项目的增长，三层很快就会开始变大，导航和查找代码将变得更加困难，这将损害可维护性和整体质量感。

因此，在项目期间，我想转换为新设置，在其中形成功能组件，每个组件都有自己的三层设置。例如：网站有一个购物车和创建和管理用户帐户的选项。还应该有跨多个组件使用的 stull 组件，我将在此示例中将其称为 common。这将导致以下设置：

常用文件：

*   Project.Common.Data
*   Project.Common.Business
*   Project.Common.Presentations

购物车：

*   项目.购物车.数据
*   项目.购物车.业务
*   项目.Shoppingcart.Presentations

账户管理：

*   项目.账户.数据
*   项目.账户.业务
*   项目.帐户.演示文稿

网站：

*   项目.网站.数据
*   项目.网站.业务
*   项目.网站.演示文稿

上面的示例包含三个组件，每个组件包含三个项目。每个组件都有一个包含 Web 文件（页面、控件、前端代码）的 Web 应用程序项目。我以前所有的 .Net 项目都有一个简单的 Web 应用程序项目，所以这个设置对我来说是一种全新的体验。

我仍然希望该解决方案感觉像是一个应用程序，能够轻松调试网站和组件。为了实现这一点，我假设“Project.Web.Presentation”Web 应用程序项目应该是主要的 Web 应用程序项目。我目前正在研究是否可以通过这种方式设置解决方案，我尝试了几种方法，但到目前为止没有一个效果很好：

*   单独运行所有 Web 应用程序项目，这工作正常，但我必须单独运行所有应用程序，我不能在同一个端口下运行它们，这在调试时很糟糕。

*   添加来自其他演示项目的文件作为“Project.Web.Presentation”项目的链接，并将该项目设置为启动项目。这不起作用，因为在调试时文件不存在，在构建部署包时似乎工作正常。我不想复制这些文件，因为我必须以某种方式防止这些重复文件最终进入版本控制。

到目前为止，我还没有找到一种很好的方法来使用我想到的设置。我愿意接受建议，在此先感谢您的提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:46:00.957

我正在做类似的事情，并决定使用 NuGet 推出所有常见的部分：

[多项目 Nuget 问题](https://stackoverflow.com/questions/7165279/multi-project-nuget-issues)

[更新现有 Nuget 包中的文件](https://stackoverflow.com/questions/6295743/updating-files-in-existing-nuget-package)

[Visual Studio 多项目解决方案选项](https://stackoverflow.com/questions/5667412/visual-studio-multi-project-solution-options)

执行此操作的唯一其他方法涉及嵌套母版页和后期构建脚本 - 混乱。

# cocoa - NSTableView 标题样式

> ID：10841638
> 
> 赞同：1
> 
> 时间：2012-05-31T21:38:01.140
> 
> 标签：cocoa, nstableview

当 NSTableView 具有 NSTableViewSelectionHighlightStyleRegular 样式时，组行具有非常好的背景和整体设计。我想要一个 NSTableViewSelectionHighlightStyleSourceList 表视图，但具有相同的标题样式。

有没有人知道如何做到这一点，而不必对其进行子类化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:44:44.660

我想除了继承它没有其他方法，但这很容易：只需创建一个 NSTableRowView 的子类，覆盖 DrawRect 方法。检查属性 self.isGroupRowStyle。如果是，则编写代码来绘制它。否则只需调用 [super drawRect:dirtyRect];

在 TableView Delegate 中，在 tableView:rowViewForRow: 方法中返回一个实例。

不管怎么说，还是要谢谢你

# redis - Redis 中的定时发布实现

> ID：10841639
> 
> 赞同：-1
> 
> 时间：2012-05-31T21:38:23.077
> 
> 标签：redis, scheduling

- 用户可以准备发布以供将来发布。

所以

Post.PostState 是 PostState.Scheduled。Post.PublishDate 是 FutureDate

当 futuredate 到来时，PostState 将是 PostState.Published。

如何在 Redis 中实现这一点。

抱歉重复：我发现 Redis 延迟执行/调度？

[使用 Redis 延迟执行/调度？](https://stackoverflow.com/questions/4138951/delayed-execution-scheduling-with-redis)

似乎答案与代码的相关性比与 db 的相关性更高，所以

[c#可靠的延迟/计划执行最佳实践](https://stackoverflow.com/questions/684406/c-sharp-reliable-delayed-scheduled-execution-best-practice)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:26:51.733

没有这样的计划，但您可以设置两个键的值并在计划日期到期。始终查找两个键并首选第一个。当计划到期时，您将获得第一个（也是唯一一个）结果的实际结果。

您还可以将所有内容隐藏在 lua 脚本后面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T14:30:36.317

抱歉，使用 REDIS 密钥过期进行调度是行不通的。过期可能发生在之前或很远的将来（例如，取决于可用内存）。

我认为您可能希望根据您的开发平台使用其他工具来延迟执行。（例如，轮询 REDIS 队列、linux cron、计时器等）

# ios - NSURLConnection 超时

> ID：10841641
> 
> 赞同：5
> 
> 时间：2012-05-31T21:38:33.837
> 
> 标签：ios, nsurlconnection

在我们的 iPhone 应用程序中，我一直遇到 NSURLConnection 请求超时的间歇性问题。它似乎发生得越来越晚。一旦它进入这个状态，它就停留在那个状态。唯一的解决方案似乎是杀死应用程序并重新启动它。

观察：

*   执行 NSURLConnection 的核心代码没有改变（除了最近添加的一些自定义用户代理代码）。
*   尚未找到可重现的案例，但应用程序在后台运行一段时间后似乎会发生超时，特别是在 3G（无 WiFi）上运行时。
*   服务器上的 Apache 在遇到这些超时时没有记录来自客户端的请求。
*   一些迹象表明其他应用程序，如 Mail 和 Safari 受到影响（即，遇到超时），但并非始终如一。
*   3G 覆盖在我所在的地方是可靠的，不排除触发问题的暂时性问题（假设不太可能）。
*   所有请求都发送到我们自己的 API 服务器，并且是 POST 请求。
*   由于 timeoutInterval 和 POST 请求的问题，我们使用自己的基于 NSTimer 的超时。我试过增加超时值——问题仍然存在。

其他杂项：

*   应用程序最近转换为 ARC。
*   在 iOS 5.1.1 下运行应用程序。
*   应用程序使用最新版本的 UrbanAirship、TestFlight 和 Flurry SDK。
*   还使用 TouchXML 的 ARC 分支来解析响应。

如下所示，代码在主线程上运行。我假设该线程上有东西阻塞，但我在挂起应用程序时看到的堆栈跟踪表明主线程很好。我认为 NSURLConnection 正在使用它自己的线程并且必须被阻止。

```
#define relnil(v) (v = nil)

- (id) initWebRequestController
{
    self = [super init];
    if (self)
    {
        //setup a queue to execute all web requests on synchronously
        dispatch_queue_t aQueue = dispatch_queue_create("com.myapp.webqueue", NULL);
        [self setWebQueue:aQueue];
    }
    return self;
}

- (void) getStuffFromServer
{
    dispatch_queue_t aQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_async(aQueue, ^{
        dispatch_sync([self webQueue], ^{            
            error_block_t errorBlock = ^(MyAppAPIStatusCode code, NSError * error){
                dispatch_async(dispatch_get_main_queue(), ^{
                    [[self delegate] webRequestController:self didEncounterErrorGettingPointsWithCode:code andOptionalError:error];
                });
            };

            parsing_block_t parsingBlock = ^(CXMLDocument * doc, error_block_t errorHandler){
                NSError * error = nil;

                CXMLNode * node = [doc nodeForXPath:@"apiResult/data/stuff" error:&error];
                if (error || !node) {
                    errorHandler(MyAppAPIStatusCodeFailedToParse, error);
                }
                else {
                    stuffString = [node stringValue];
                }

                if (stuffString) {
                    dispatch_async(dispatch_get_main_queue(), ^{
                        [[self delegate] webRequestController:self didFinishGettingStuff:stuffString];
                    });
                }
                else {
                    errorHandler(MyAppAPIStatusCodeFailedToParse, error);
                }
            };

            NSURL * url = [[NSURL alloc] initWithString:[NSString stringWithFormat:MyAppURLFormat_MyAppAPI, @"stuff/getStuff"]];

            NSMutableURLRequest * urlRequest = [[NSMutableURLRequest alloc] initWithURL:url];
            NSMutableDictionary * postDictionary = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                                    [[NSUserDefaults standardUserDefaults] objectForKey:MyAppKey_Token], @"token",
                                                    origin, @"from",
                                                    destination, @"to",
                                                    transitTypeString, @"mode",
                                                    time, @"time",
                                                    nil];

            NSString * postString = [WebRequestController httpBodyFromDictionary:postDictionary];
            [urlRequest setHTTPBody:[postString dataUsingEncoding:NSUTF8StringEncoding]];
            [urlRequest setHTTPMethod:@"POST"];

            if (urlRequest)
            {
                [self performAPIRequest:urlRequest withRequestParameters:postDictionary parsing:parsingBlock errorHandling:errorBlock timeout:kTimeout_Standard];
            }
            else
            {
                errorBlock(MyAppAPIStatusCodeInvalidRequest, nil);
            }

            relnil(url);
            relnil(urlRequest);
        });
    });
}

- (void) performAPIRequest: (NSMutableURLRequest *) request
     withRequestParameters: (NSMutableDictionary *) requestParameters
                   parsing: (parsing_block_t) parsingBlock 
             errorHandling: (error_block_t) errorBlock
                   timeout: (NSTimeInterval) timeout
{
    NSAssert([self apiConnection] == nil, @"Requesting before previous request has completed");

    NSString * postString = [WebRequestController httpBodyFromDictionary:requestParameters];
    [request setHTTPBody:[postString dataUsingEncoding:NSUTF8StringEncoding]];

    NSString * erVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleShortVersionString"];
    NSString * erBuildVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"];
    if ([erBuildVersion isEqualToString:erVersion] || [erBuildVersion isEqualToString:@""]) {
        erBuildVersion = @"";
    } else {
        erBuildVersion = [NSString stringWithFormat:@"(%@)", erBuildVersion];
    }
    NSString * iosVersion = [[UIDevice currentDevice] systemVersion];
    NSString * userAgent = [NSString stringWithFormat:@"MyApp/%@%@ iOS/%@", erVersion, erBuildVersion, iosVersion];
    [request setValue:userAgent forHTTPHeaderField:@"User-Agent"];

    [request setTimeoutInterval:(timeout-3.0f)];

    dispatch_sync(dispatch_get_main_queue(), ^{
        NSURLConnection * urlConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:NO];

        if (urlConnection)
        {
            [self setApiConnection:urlConnection];

            requestParseBlock = [parsingBlock copy];
            requestErrorBlock = [errorBlock copy];

            NSMutableData * aMutableData = [[NSMutableData alloc] init];
            [self setReceivedData:aMutableData];
            relnil(aMutableData);

            [urlConnection scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];

            [urlConnection start];
            relnil(urlConnection);

            NSTimer * aTimer = [NSTimer scheduledTimerWithTimeInterval:timeout target:self selector:@selector(timeoutTimerFired:) userInfo:nil repeats:NO];
            [self setTimeoutTimer:aTimer];
        }
        else
        {
            errorBlock(MyAppAPIStatusCodeInvalidRequest, nil);
        }
    });

    //we want the web requests to appear synchronous from outside of this interface
    while ([self apiConnection] != nil)
    {
        [NSThread sleepForTimeInterval:.25];
    }
}

- (void) timeoutTimerFired: (NSTimer *) timer
{
    [[self apiConnection] cancel];

    relnil(apiConnection);
    relnil(receivedData);

    [self requestErrorBlock](MyAppAPIStatusCodeTimeout, nil);

    requestErrorBlock = nil;
    requestParseBlock = nil;
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{    
    [self requestErrorBlock](MyAppAPIStatusCodeFailedToConnect, error);

    relnil(apiConnection);
    relnil(receivedData);
    [[self timeoutTimer] invalidate];
    relnil(timeoutTimer);
    requestErrorBlock = nil;
    requestParseBlock = nil;
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [receivedData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{    
    MyAppAPIStatusCode status = MyAppAPIStatusCodeFailedToParse;

    CXMLDocument *doc = [[self receivedData] length] ? [[CXMLDocument alloc] initWithData:[self receivedData] options:0 error:nil] : nil;

    DLog(@"response:\n%@", doc);

    if (doc)
    {
        NSError * error = nil;
        CXMLNode * node = [doc nodeForXPath:@"apiResult/result" error:&error];
        if (!error && node)
        {
            status = [[node stringValue] intValue];

            if (status == MyAppAPIStatusCodeOK)
            {
                [self requestParseBlock](doc, [self requestErrorBlock]);
            }
            else if (status == MyAppAPIStatusCodeTokenMissingInvalidOrExpired)
            {
                [Definitions setToken:nil];

                [self requestMyAppTokenIfNotPresent];

                [Definitions logout];

                dispatch_async(dispatch_get_main_queue(), ^{
                    [[self delegate] webRequestControllerDidRecivedExpiredTokenError:self];
                });
            }
            else
            {
                [self requestErrorBlock](status, nil);                
            }
        }
        else
        {
            [self requestErrorBlock](status, nil);
        }
    }
    else
    {
        status = MyAppAPIStatusCodeUnexpectedResponse;
        [self requestErrorBlock](status, nil);
    }
    relnil(doc);

    relnil(apiConnection);
    relnil(receivedData);
    [[self timeoutTimer] invalidate];
    relnil(timeoutTimer);
    requestErrorBlock = nil;
    requestParseBlock = nil;
} 
```

下面的 URL 是应用程序处于问题状态时的队列/线程的一些屏幕截图。请注意，我相信线程 10 与前一次超时执行的取消有关，尽管互斥等待很奇怪。此外，线程 22 中有关 Flurry 的位在其他情况下遇到问题时不会始终出现。

堆栈跟踪截图：

[http://img27.imageshack.us/img27/5614/screenshot20120529at236.png](http://img27.imageshack.us/img27/5614/screenshot20120529at236.png) [http://img198.imageshack.us/img198/5614/screenshot20120529at236.png](http://img198.imageshack.us/img198/5614/screenshot20120529at236.png)

也许我忽略了这些痕迹中明显错误的东西，因为我对 iOS/Apple 开发相对较新。

如果我有 NSURLConnection 和相关代码的源代码，那么解决所有这些问题会简单得多，但就目前而言，我是在黑暗中摸索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T20:08:28.160

删除 TestFlight 1.0 SDK 似乎可以解决问题。TestFlight 还证实他们正在努力修复。鉴于该错误最初被其他人确认已经一个多月了，我想知道我们离修复还有多远。

# windows-phone-7 - 在 ItemsControl Tap 事件上绑定 CommandParameter

> ID：10841642
> 
> 赞同：4
> 
> 时间：2012-05-31T21:38:34.550
> 
> 标签：windows-phone-7, mvvm-light, relaycommand, eventtocommand

我正在使用 ItemsControl，并且我想确定在 Tap 命令上选择了哪个项目。我的 xaml 在这里定义：

```
<ItemsControl ItemsSource="{Binding AllMyItems}">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Tap">
              <cmd:EventToCommand Command="{Binding ItemSelectedCommand}" CommandParameter="{Binding}"/>
         </i:EventTrigger>
    </i:Interaction.Triggers>
    .... item template .... 
```

这是我的视图模型：

```
public RelayCommand<MyItem> ItemSelectedCommand { get; private set; }
public MainViewModel()
    {
        ItemSelectedCommand = new RelayCommand<MyItem>(ItemSelected);
    }

private void ItemSelected(MyItem myItem)
    {
        throw new NotImplementedException();
    } 
```

命令的事件有效，但是当我到达 ItemSelected 方法时，myItem 要么为 Null，要么我得到一个异常转换它（取决于我在 xaml 中定义 CommandParameter 的方式）。

如果我使用 ListBox 并设置，我可以做到这一点`CommandParameter="{Binding SelectedItem, ElementName=MyItemsList"}`

关于如何使用 ItemsControl 执行此操作的任何想法？还是性能差异在 Mango 中两者之间没有太大区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T05:53:14.907

您的 Tap 事件发生在 ItemsControl 上，您应该将 EventToCommand 放在 ItemTemplate 中，一些 XAML 可以为您清除这些东西

```
<ItemsControl ItemsSource="{Binding AllMyItems}">
<ItemsControl.ItemTemplate>
<...>
<i:Interaction.Triggers>
    <i:EventTrigger EventName="Tap">
          <cmd:EventToCommand Command="{Binding ItemSelectedCommand}" CommandParameter="{Binding}"/>
     </i:EventTrigger>
</i:Interaction.Triggers>
</...>                                    
</ItemsControl.ItemTemplate>
... 
```

# wpf - 在 TextBlock 上设置叠加颜色的动画

> ID：10841649
> 
> 赞同：0
> 
> 时间：2012-05-31T21:38:59.167
> 
> 标签：wpf, xaml, animation, text

我试图想出一个创造性的解决方案来产生这种特殊的效果：

![](../Images/d984fa5753627915756cdd16673bb416.png)

我最初的想法：一个具有色度键着色器效果的动态大小的矩形将在文本上滑动到位。但是，我不想破坏着色器往往会发生的文本边缘的保真度。

我也考虑过使用 FormattedText 类，但我不确定它是否支持我正在尝试做的事情。

有什么建议么？

*编辑* 为了澄清，文本本质上是一个“TabItem”。我希望突出显示的块在所有选项卡项中浮动到选定项。它们目前被放置在一个 Canvas 中，逻辑处理它们的位置。一个简单的动画似乎是不够的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:59:44.917

这应该会给你你想要的效果。这对颜色使用了渐变画笔，但它使用了 3 个渐变色标来确保颜色立即从一种颜色变为下一种颜色，中间没有渐变。

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:TestingWPF"
    mc:Ignorable="d"
    x:Class="TestingWPF.TestWindow"
    d:DesignWidth="477" d:DesignHeight="214"
    Background="Black">

    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="74" FontWeight="Bold">
        <TextBlock.Foreground>
            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                <GradientStop Color="White" Offset="0"/>
                <GradientStop x:Name="WhiteOffset" Color="White" Offset="1"/>
                <GradientStop x:Name="GrayOffset" Color="Gray" Offset="1"/>
            </LinearGradientBrush>
        </TextBlock.Foreground>
        <TextBlock.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                    <Storyboard Storyboard.TargetProperty="Offset" Duration="0:0:1" RepeatBehavior="Forever">
                        <DoubleAnimation Storyboard.TargetName="WhiteOffset" From="0" To="1" />
                        <DoubleAnimation Storyboard.TargetName="GrayOffset" From="0" To="1" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </TextBlock.Triggers>
        Some Text
    </TextBlock>
</Window> 
```

# asp.net - Visual Studio 调试属性

> ID：10841651
> 
> 赞同：0
> 
> 时间：2012-05-31T21:39:14.993
> 
> 标签：asp.net, visual-studio, debugging

我在 asp.net 中有一个标签。我正在使用 Visual Studio。我如何去跟踪价值：

```
 lblInvalid.Visible 
```

在我调试的时候。我需要在整个程序中跟踪价值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:43:32.940

将它添加到监视变量下 (debug->window->watch) 或在即时窗口中检查它的值 (debug->window->immediate)。

# iphone - 使用导航栏和后退按钮创建模态视图

> ID：10841653
> 
> 赞同：5
> 
> 时间：2012-05-31T21:39:24.893
> 
> 标签：iphone, objective-c, ios, xcode, uitabbarcontroller

我想用导航项创建一个模态视图（我的屏幕截图上的右视图），我希望它有一个“后退按钮”。我的应用程序是 TabBar 应用程序，我不希望此视图有标签栏，但我想加载前一个视图（我的屏幕截图上的左视图），其 segue 类似于“push”类型。我只能创建 push segue 以提供返回到左侧视图的右侧导航，如果它作为模态视图加载，则 NavigationBar 和 TabBar 消失了。有什么解决方法吗？提前致谢！

![这是我的截图](../Images/4b23dbd2a2b148b65bbe45bed013f976.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T22:00:17.130

只需在带有条形按钮项的新视图上放置一个导航栏。通过控制从条形按钮项拖动到视图控制器的 .h 来为条形按钮项创建一个操作。然后，您可以使用委托和协议方法来告诉第一个控制器何时按下按钮并让它使用`[self dismissModalViewControllerAnimated:YES];`

因此，在您的第二个视图中，使用 done 方法创建一个协议，如下所示：

```
@protocol SecondViewControllerDelegate <NSObject>

-(void) done;

@end

@interface SecondViewController : UIViewController {
    ...
    id delegate;
}

...

@property (nonatomic, assign) id<SecondViewControllerDelegate> delegate;

-(IBAction)done:(id)sender;  //this will be linked to your nav bar button.
@end 
```

然后在您的按钮操作中调用：

```
-(IBAction)done:(id)sender{
   [self.delegate done];
} 
```

你的第一个视图控制器需要实现协议`<SecondViewControllerDelegate>`

然后在您的第一个视图控制器中，将其设置为您的第二个视图控制器的委托，然后再进行 segue。

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([[segue identifier] isEqualToString:@"Second View Modal Segue Identifier"])
    {
        SecondViewController *viewController = segue.destinationViewController;
        viewController.delegate = self;
    }
} 
```

最后，在您的第一个视图控制器中捕获来自委托的 done 调用：

```
-(void) done
{
    [self dismissModalViewControllerAnimated:YES];
} 
```

我就是这样做的。如果您对协议和委托没有太多经验，一开始可能会感到困惑，但它对我来说效果很好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T21:47:36.487

您需要将右侧视图控制器包装在新的导航控制器中。在 IB 中，选择它并选择菜单项`Editor -> Embed In -> Navigation Controller`，IB 将显示一个导航栏，您可以根据自己的喜好对其进行自定义。

# gwt - GWT 编译器生成的基于 Phonegap 的 Web 应用程序无法在 xcode 模拟器上运行

> ID：10841654
> 
> 赞同：0
> 
> 时间：2012-05-31T21:39:36.493
> 
> 标签：gwt, cordova, ios-simulator, mgwt

我正在使用 GWT 为我的移动应用程序创建 UI，并将编译后的代码移动到 phonegap 应用程序。在 Android 模拟器（和 Galaxy S2）中一切正常。但是在尝试创建 iphone 应用程序时，我得到了一个没有任何磨损或错误的空白页面。

即使我遵循了入门教程[http://docs.phonegap.com/en/1.7.0/guide_getting-started_ios_index.md.html#Getting%20Started%20with%20iOS](http://docs.phonegap.com/en/1.7.0/guide_getting-started_ios_index.md.html#Getting%20Started%20with%20iOS)中的所有说明，我仍然遇到了这个问题. 请问您有什么想法吗？

GWT 版本：2.4，JDK：1.6，Phonegap 科尔多瓦：1.7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:56:14.620

看看[http://www.m-gwt.com](http://www.m-gwt.com)

它有一个用于为 phonegap 构建 gwt 应用程序的库。启动情况（可能非常棘手）在 gwt-phonegap 内部处理

# asp.net - 在 runat="server" 之后仍然无法访问 Asp.net div

> ID：10841656
> 
> 赞同：4
> 
> 时间：2012-05-31T21:39:59.187
> 
> 标签：asp.net

我的 HTML 中有一个`div`元素。我为元素添加了一个`id`和`runat`属性：

```
<div id="footer" runat="server"> 
```

渲染后，查看 HTML 显示：

```
<div id="ctl00_footer"> 
```

但是，我无法从页面的 .aspx.cs 代码访问它：

```
footer.InnerHtml += "test"; 
```

如何从 C# 代码访问该元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T21:46:27.917

您可以使用 FindControl("footer")，并将其转换为 HtmlGenericControl。

```
HtmlGenericControl footer = (HtmlGenericControl)FindControl("footer") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-27T10:01:56.680

原因之一可能是您没有该页面的设计器文件。所以你不能通过它访问元素`ID`。

只需添加名称为***[您的页面名称].aspx.designer.cs 的类***，打开它，删除所有代码，保存它，转到您的视图并单击保存 - 设计器必须从您的视图中生成所有元素的代码。在此之后，您可以通过 访问元素`ID`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:58:38.923

`<div id="footer" runat="server"></div>`访问您正在做的方式应该没有问题。奇怪的是，我生成的标记保持 div id 不变为`footer`.
确保您没有任何编译错误，并且您可以访问在您尝试访问此 div 的同一范围内运行服务器端的其他元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T22:15:50.377

您需要将页面或控件的 ClientIDMode 属性设置为静态：

[http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)

这将防止“ctl00_”被附加到导致您出现问题的 ID 上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-16T15:15:44.987

I have encountered this problem before. You may have the target div inside another div that does not have the `runat="server"` attribute. All nested divs should have the `runat` attribute in order to be able to access the inner elements.

```
<div id="divContainer" runat="Server">
    <div id="yourDiv" runat="Server">
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-31T21:42:50.153

如果您要编写 ASP.NET 代码并且想要从服务器端访问控件，那么您也可以使用提供的控件。

使用[Panel](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.aspx)而不是 Div。无论如何，ASP:Panel 控件在生成的 html 中呈现为 div。Panel 没有 .Text 属性，但您可以从代码隐藏中添加控件（例如[Label](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.label.aspx)或[LiteralControl](http://msdn.microsoft.com/en-us/library/system.web.ui.literalcontrol.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T12:24:33.820

我遇到了同样的问题，发现由于“复制”和“粘贴”，我的函数有一个“静态”声明。将其删除，因为静态函数无法访问非静态标识符并且已修复。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-13T02:32:30.790

页面创建时是否有可能被复制/粘贴？如果是这样，请绝对确保所有对旧页面的引用都更改为新页面的名称。我之前在 ASPX 页面顶部的代码以及设计器页面的名称空间中完成了此操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-01T18:01:58.000

我有同样的问题。我的解决方案是为 div 元素设置“ID”而不是“id”（即原因是外壳）。

# jquery - 将 jQuery 从随机更改为一张一张的幻灯片

> ID：10841659
> 
> 赞同：0
> 
> 时间：2012-05-31T21:40:10.950
> 
> 标签：jquery, random

我试图摆脱我正在使用的幻灯片中的随机函数。iRnd 变量将值传递给加载器；我试过使用`for (i=0; i<= aImages.lenght, i++) {iRnd=i}`，但这并没有完成工作。我只想摆脱随机性，并按照它们在数组中的顺序一张一张地获取图像。

这是我的代码：

```
function LoadImages()
{

    /* Select a random image number and make sure this is not equal to the previous image */
    while(iPrev == iRnd)
    {
        iRnd = Math.floor(Math.random()*aImages.length);
    }

    /* Show the selected image */
    LoadImage(iRnd);

    iPrev = iRnd;

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:43:58.623

您可能正在寻找[模数运算符 (%)](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Arithmetic_Operators#.25_%28Modulus%29)来帮助您在到达末尾时回绕。这应该适合你：

```
function LoadImages(){

    iRnd = (iRnd + 1) % aImages.length;

    /* Show the selected image */
    LoadImage(iRnd);

}; 
```

`aImages`但是，您应该避免在代码中使用太多全局变量（我假设`iRnd`它们都是全局变量）。

# android - 用 libgdx 绘画会使物体闪烁

> ID：10841662
> 
> 赞同：6
> 
> 时间：2012-05-31T21:40:28.517
> 
> 标签：android, graphics, opengl-es, libgdx

我正在尝试使用 Libgdx 制作一个非常简单的绘画应用程序。我已经在 intertubes 上搜索了几天，试图解决这个问题，这可能是由于我的 openGL noobness。

当我在屏幕上绘制一个对象时，只要 render() 方法正在运行，我所绘制的东西就会快速闪烁（我假设是每次调用 render() 方法时）。如果我禁用连续渲染，闪烁会停止，直到我绘制其他内容（同样，不会调用 render()）。

假设我正在适当地将新纹理加载到 Sprite 中 - 它确实绘制，毕竟 - 而我在我的 render() 方法中所做的就是这样：

```
batch.begin();
myShape.setPosition(Gdx.input.getX(), Gdx.input.getY());
batch.setColor(Color.BLUE);
myShape.draw(batch);
batch.end(); 
```

我没有调用 glClear 是因为我（想我）不想在每次渲染时都清除屏幕。我盲目地尝试了各种 glEnable 和 glDisable 用于剔除、混合、抖动等，但没有任何解决问题的方法。

我到底做错了什么，或者只是不理解这里？我没有设置正确的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T22:23:02.890

那是因为[双缓冲](http://en.wikipedia.org/wiki/Multiple_buffering)。

启用双缓冲后，您不是在前一帧上绘制，而是在前一帧上绘制。这意味着，偶数帧和奇数帧被绘制到两个不同的缓冲区。更改这些缓冲区会产生闪烁。

我看到三个解决方案：

*   您可以禁用双缓冲。我不确定这在 libgdx 中是否可行。

*   您可以清除屏幕并在每一帧中绘制所有内容。当你画画时，这会变慢。

*   您可以将图像保存到纹理并在每一帧开始时将其绘制回屏幕。这是首选的解决方案，尽管它可能需要一些工作。这种技术称为“渲染到纹理”。

# android - Android 地图视图气球

> ID：10841663
> 
> 赞同：0
> 
> 时间：2012-05-31T21:40:40.620
> 
> 标签：android, android-mapview

我在我的 android 应用程序中使用这个库[https://github.com/jgilfelt/android-mapviewballoons](https://github.com/jgilfelt/android-mapviewballoons)，它非常有用。现在，当您点击打开的气球时，我正在尝试捕捉事件。我想在点击气球打开的文本后启动一个新活动。我该怎么做？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T12:47:40.483

您在 startActivity() 方法前面缺少上下文

```
c.startActivity(to_taghelp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:56:14.337

查看该库的演示应用程序。在[简单](http://github.com/jgilfelt/android-mapviewballoons/blob/master/android-mapviewballoons-example/src/mapviewballoons/example/simple/SimpleItemizedOverlay.java)示例中，替换

```
@Override
protected boolean onBalloonTap(int index, OverlayItem item) {
    Toast.makeText(c, "onBalloonTap for overlay index " + index,
    Toast.LENGTH_LONG).show();
    return true;
} 
```

和

```
@Override
protected boolean onBalloonTap(int index, OverlayItem item) {
    // start your Activity here
    return true;
} 
```

# php - 我们可以别名（保存到变量）php中的类方法吗

> ID：10841668
> 
> 赞同：1
> 
> 时间：2012-05-31T21:41:09.650
> 
> 标签：php, class, function, methods, alias

这是一个示例类：

```
public class example
 {
     private $foof;         

     public function __construct()
     {
          $this->foof = $this->foo;
     }

     public function foo($val=0)
     {
             // do something...
     }
 } 
```

所以基本上，在示例代码的构造函数中，是否可以将类方法分配给变量？

最终我想要的是有一个关联数组，其中所有的类方法都带有别名……这在 php 中可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T21:41:43.330

在 PHP5.3+ 中（无论如何你都应该使用它！）你可以简单地创建一个匿名函数来调用你的方法：

```
$this->foof = function() {
    $this->foo(1);
}; 
```

但是，您不能使用它来调用它`$this->foof()`- 您必须先将它分配给一个变量：`$foof = $this->foof; $foof();`

* * *

在较旧的 PHP 版本中，您不能轻易做到这一点 -`create_function()`不会创建闭包，因此`$this`在那里不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:04:37.017

您不需要使用匿名函数。只需使用[Callable 伪类型](http://us2.php.net/manual/en/language.types.callable.php)。

```
$this->foof = array($this, 'foo');
...
call_user_func($this->foof); 
```

# sql - 为什么访问我的数据库需要 Postgres 超级用户？

> ID：10841673
> 
> 赞同：1
> 
> 时间：2012-05-31T21:41:45.670
> 
> 标签：sql, postgresql

我`mygs_user`在三个数据库 中有一个共同的用户`mydatamodel`，`mygs`，和`Newdatabase`（更改名称以保护无辜者）。

我“继承”了前两个数据库，并创建了第三个`Newdatabase`（

问题是虽然两个原始数据库没有明确的权限，但普通用户 ,`mygs_user`可以正常访问它们。第三个 ( `Newdatabase`) 不允许访问，除非我将普通用户修改为超级用户，这显然不是最佳实践。

当然，我已经尝试将我的 NewDB 的安全设置设置为没有骰子的原始设置。

这是两个原始数据库：

`mydatamodel`

```
CREATE DATABASE mydatamodel
  WITH OWNER = postgres
       ENCODING = 'UTF8'
       TABLESPACE = datamodel_tablespace
       LC_COLLATE = 'English, United States'
       LC_CTYPE = 'English, United States'
       CONNECTION LIMIT = -1; 
```

`mygs`

```
CREATE DATABASE mygs
  WITH OWNER = postgres
       ENCODING = 'UTF8'
       TABLESPACE = mygs_tablespace
       LC_COLLATE = 'English, United States'
       LC_CTYPE = 'English, United States'
       CONNECTION LIMIT = -1; 
```

...这是新的数据库：

```
CREATE DATABASE "NewDatabase"
  WITH OWNER = postgres
       ENCODING = 'UTF8'
       TABLESPACE = pg_default
       LC_COLLATE = 'English, United States'
       LC_CTYPE = 'English, United States'
       CONNECTION LIMIT = -1;
GRANT CONNECT, TEMPORARY ON DATABASE "NewDatabase" TO public;
GRANT ALL ON DATABASE "NewDatabase" TO postgres;
GRANT ALL ON DATABASE "NewDatabase" TO mygs_user; 
```

两个原始占用单独的表空间，而新的不占用：

```
CREATE TABLESPACE mygs_tablespace
  OWNER postgres
  LOCATION 'c:/MYGS_Database/PostgreSQL';

CREATE TABLESPACE datamodel_tablespace
  OWNER postgres
  LOCATION 'c:/MYGS_Database/MyDataModel'; 
```

这是普通用户：

```
CREATE ROLE mygs_user LOGIN
  SUPERUSER NOINHERIT NOCREATEDB NOCREATEROLE;
GRANT "MYGS" TO mygs_user; 
```

...以及共同的角色：

```
CREATE ROLE "MYGS"
  NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE; 
```

以下是 pg_hba.conf 文件内容：

```
# TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD
# IPv4 local connections:
host    all         all         127.0.0.1/32            md5 
```

如何在不授予超级用户权限的情况下授予对第三个数据库的普通用户的访问权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:49:55.863

I think you forgot to allow connecting to this database in `pg_hba.conf` configuration file.

You should probably add there something like:

```
# TYPE  DATABASE        USER            ADDRESS                 METHOD
local   Newdatabase     MYGS                                    md5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:00:37.867

经过进一步检查，权限被设置为在对象级别授权“MYGS”角色，而在数据库级别没有明确的权限。对于每个对象类型，以下代码解决了该问题：

**表：**

```
ALTER TABLE tableNameHere OWNER TO postgres;
GRANT ALL ON TABLE dtm_tableNameHereTO postgres;
GRANT SELECT, UPDATE, INSERT, DELETE ON TABLE tableNameHere TO "MYGS"; 
```

**...功能：**

```
ALTER FUNCTION functionNameHere(..) OWNER TO postgres;
GRANT EXECUTE ON FUNCTION functionNameHere(..) TO postgres;
GRANT EXECUTE ON FUNCTION functionNameHere(..) TO "MYGS"; 
```

**...和序列：**

```
ALTER TABLE sequenceNameHere OWNER TO postgres;
GRANT ALL ON TABLE sequenceNameHere TO postgres;
GRANT SELECT, UPDATE ON TABLE sequenceNameHere TO "MYGS"; 
```

虽然，解决方案工作不需要 postgres 用户。

# java - 匿名类中使用最终变量时的垃圾收集

> ID：10841674
> 
> 赞同：8
> 
> 时间：2012-05-31T21:41:53.163
> 
> 标签：java, garbage-collection, final

如果我有类似于以下的代码：

```
public Constructor(final Object o) {
    taskSystem.add(new CycleTask(15, 15, -1) {

        @Override
        public void execute() throws Throwable {
            //access o here every 15 cycles forever
        }
    });
} 
```

如果有的话，什么时候会收集垃圾？只有当任务被收集后，还是因为它是最终的，所以它会永远留在内存中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T21:45:32.240

`o` *一旦不再可访问，*可能会收集垃圾，无论它是否是最终的。*显然，只要在`execute`运行，如果需要访问`o`，就会阻止GC。*

 *运行完成`execute`后，假设您没有存储任何对`o`（例如在集合中）的引用，它将被标记为准备好进行垃圾回收。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T21:45:54.707

当匿名类实例有资格进行垃圾收集时，如果没有其他内容引用`o`调用该方法时引用的对象，则该对象将有资格进行垃圾收集。

阻止垃圾收集的最终变量没有什么特别之处。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T21:47:00.653

'final' 对 GC 没有影响。当对象变得不可访问时，它就会有资格被收集。在这种情况下，至少有三个引用，其中任何一个都可以阻止它： 'final' 参数，当方法返回时消失；来电者的参考；以及匿名类实例中最终变量的副本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T21:45:16.583

`final`关键字和变量的生命周期之间没有关系。

当不再需要它时，它将被垃圾收集，并且由于它是一个参数，这可能发生在方法之外（如果外部没有引用）。

`final`关键字只是给编译器的一个约束，以禁止在调用函数后对引用进行任何进一步的修改`o`。*

# networking - netstat -na : udp 和 state 建立了吗？

> ID：10841678
> 
> 赞同：15
> 
> 时间：2012-05-31T21:42:07.467
> 
> 标签：networking, udp, netstat

在应用程序（voip rtp 媒体服务器）中，`netstat -na`在服务器（绑定到 udp 端口​​ 1286 的 172.16.226.3）上给出以下行：

```
udp 0 0 172.16.226.3:1286 172.25.14.11:10000 ESTABLISHED 
```

由于无法真正“建立” udp 连接，因此看到这样的线令我震惊。`netstat`文档说该字段用于 tcp 连接状态，但我确信这确实是一个 udp 网络流。那么：这意味着什么？我知道（wireshark 转储）我的服务器从`173.16.226.3:1286`to发回 udp 数据包`172.25.14.11:10000`，但我不明白它为什么重要......

操作系统是Debian 6。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-31T21:51:41.667

UDP 套接字*可以*通过`connect(2)`系统调用连接，因此套接字将只接受来自指定对等方的数据包。

我希望这是`ESTABLISHED`专栏的来源。

# xcode - 当附件是 UITableViewCellAccessoryCheckmark 时如何在 UITableViewCell 中居中文本

> ID：10841693
> 
> 赞同：6
> 
> 时间：2012-05-31T21:43:21.833
> 
> 标签：xcode, ios5, uitableview

当我将附件视图设置为 UITableViewCellAccessoryCheckmark 时，我试图将文本保持在 UITableViewCell 中。我也在这个课程中使用故事板。

这是我不想要的屏幕截图。

如何阻止文本向左缩进？

![在此处输入图像描述](../Images/b83aab15b8be036b00f0b0ce50261008.png)

我的 willDisplayCell 方法..

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
    if (indexPath.row == [self cellToCheckmark]) {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    }
    else {
        NSLog(@"Not Being Checked");
        cell.accessoryType = UITableViewCellAccessoryNone;
    }

cell.textLabel.textAlignment = UITextAlignmentCenter;

    if (cell.shouldIndentWhileEditing == YES) {
        cell.shouldIndentWhileEditing = NO;
    }
} 
```

CellForRowAtIndexPath：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell = nil;

    static NSString *CellIdentifier = @"Cell";
    cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.textAlignment = UITextAlignmentCenter;

    if (indexPath.section == 0) {
        switch (indexPath.row) {
            case 0:
                cell.textLabel.text = @"Google";
                break;

            case 1:
                cell.textLabel.text = @"Bing";
                break;

            case 2:
                cell.textLabel.text = @"Yahoo!";
                break;

            default:
                break;
        }
    }

    if (indexPath.row == [self cellToCheckmark]) {
        NSLog(@"Being Checked");
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    }
    else {
        NSLog(@"Not Being Checked");
        cell.accessoryType = UITableViewCellAccessoryNone;
    }

    if (cell.shouldIndentWhileEditing == YES) {
        cell.shouldIndentWhileEditing = NO;
    }   
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T21:47:26.433

你需要做两件事：

首先，您需要确保将表格样式设置为 Default: `UITableViewCellStyleDefault`。所有其他样式都`detailTextLabel`以一种或另一种方式使用 a，您将无法设置 textLabel 的对齐属性。

```
[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault  reuseIdentifier:CellIdentifier] 
```

然后您可以设置单元格的 textLabel 的对齐方式：

```
cell.textLabel.textAlignment = NSTextAlignmentCenter; 
```

然后根据您的数据要求将附件设置为复选标记。

```
cell.accessoryType = ( myDataMatches ? UITableViewCellAccessoryCheckmark : UITableViewCellAccessoryNone ); 
```

## 截屏

![在此处输入图像描述](../Images/578fc28be8e11ba0fcc0c3fa768fd46e.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-12-10T21:42:54.217

iOS 8+ 解决方案：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cell"];
    cell.textLabel.text = ...;
    if (/* your condition */) {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
        cell.layoutMargins = UIEdgeInsetsMake(0, 40, 0, 10);
    } else {
        cell.accessoryType = UITableViewCellAccessoryNone;
        cell.layoutMargins = UIEdgeInsetsMake(0, 10, 0, 10);
    }
    return cell;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-13T08:47:48.130

似乎有一个更简单的答案（参见[这个答案](https://stackoverflow.com/a/34136898/386738)）。简而言之，您将标签在单元格的内容视图中居中。相反，将它放在单元格本身的中心，然后它就不会移动。

试用了一下，它适用于 iOS 11.2。

[![在此处输入图像描述](../Images/8fa1905d211628ede8ca813bed012eae.png)](https://i.stack.imgur.com/elVNz.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-01T10:31:52.963

这些解决方案适用于默认单元格。如果您有自己的自定义单元格，最简单的方法是让标签对左边距和右边距都有约束，然后为左边距约束创建一个出口，并在`cellForRowAtIndexPath`方法中设置其常量：

```
 cell.accessoryType = isChosen ? .checkmark : .none
    cell.leftMarginConstraint.constant = isChosen ? 40 : 0 
```

这样，为您的附件类型添加的右边距也会被添加到左边。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-11T09:54:20.457

不知道问题是否解决

```
if (/* your condition */) {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
        cell.indentationLevel = 4;
    }else{
        cell.accessoryType = UITableViewCellAccessoryNone;
        cell.indentationLevel = 0;
    } 
```

# javascript - CLeditor 使用 HTML 'align' 属性。如何将其更改为 CSS 'text-align'？

> ID：10841710
> 
> 赞同：0
> 
> 时间：2012-05-31T21:44:45.750
> 
> 标签：javascript, jquery, alignment, wysiwyg, cleditor

我已经在我正在处理的网站上设置了 CLeditor。目前我正在设置它，以便当您在编辑器中键入和编辑时，您可以在其上方看到结果的实时预览，这很像您在输入 StackOverflow 问题时得到的结果，尽管更基本。

它通过简单地将 iframe 内容的内部 HTML 复制到页面上的另一个位置来工作。但是我遇到了一个烦人的问题。当我使用对齐按钮（左、中、右）时，它会将属性添加`align="right"`到所选文本中。虽然它可以在编辑器中工作，但它不能在页面本身上工作，可能是因为该属性已经过时了。

...

我实际上在输入这个问题时想出了如何解决这个问题。不过，我会用我的解决方案发布这个问题。另外，我还有一个相关问题要补充。

最初我尝试将以下 CSS 应用于页面：

```
div[align="right"] {
    text-align:right!important;
    } 
```

这适用于最初将数据加载到页面上，但在编辑器中动态更改对齐时，实时预览并未反映更改。起初我认为这是因为样式仅在加载时应用。

好吧，那是一个脑放屁，因为我比那更清楚。真正的问题是我选择了一个 DIV 元素，而 align 属性不一定适用于 DIV。更改`div[align="right"]`为`*[align="right"]`完美运行。

然而，即使我找到了解决这个特定问题的方法，我仍然无法弄清楚 cleditor 如何为 iframe 构建 HTML 输出。`align`代码中的属性来自哪里，它如何知道将其（以及所有其他元素/属性）放入 HTML 中？如果我有办法处理它，我可以简单地告诉它使用内联 CSS 进行对齐，而不是使用已弃用的`align`HTML 属性。请注意，我不希望启用 cleditor 的内置“useCSS”功能。

感谢您分享的任何信息，请不要仅仅因为我已经解决了最初的问题就对这个问题投反对票。如果他们遇到同样的问题，我希望这能够帮助其他人。（我也会发布我的答案作为答案）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:44:45.923

将以下 CSS 应用于页面的实时预览效果很好：

```
*[align="right"] {
  text-align:right!important;
} 
```

不要忘记对左和中做同样的事情。

# objective-c - 对视图属性的引用正在保留视图控制器

> ID：10841716
> 
> 赞同：0
> 
> 时间：2012-05-31T21:45:19.310
> 
> 标签：objective-c, ios, uiview, uiviewcontroller, dealloc

当我使用视图控制器的视图时出现内存泄漏我的代码序列是这样的

```
 viewController1 = [[ViewController alloc] init];
   destinationViewController = [[DestinationViewController alloc] init];
   [destinationViewCOntroller useView:viewController1.view];
   [viewController1 release];
   [destinationViewController release]; 
```

出于测试目的，我在 useView 方法中有空实现。所以我的问题是 viewController1 永远不会被释放。我确保没有其他地方对 viewController1 有任何引用。当我删除传递 viewcontroller1.view 的方法调用（useView）时， viewcontroller1 正在正确释放。任何想法为什么行为是这样的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:49:30.980

This seems to be a rather academic problem. Just enable ARC and forget about it.

# javascript - insertTextAtCursor() 函数使 contenteditable 失去焦点

> ID：10841720
> 
> 赞同：1
> 
> 时间：2012-05-31T21:45:45.983
> 
> 标签：javascript, jquery

我需要解决这个问题......因为这很烦人，因为每 1000 毫秒就会发生一次！！！

这是完整的代码：

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>
function insertTextAtCursor() {
    var sel, range, html;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            range.insertNode( document.createTextNode('567') );
        }
    } else if (document.selection && document.selection.createRange) {
        document.selection.createRange().text = text;
    }
}
</script>

<div contenteditable onclick="insertTextAtCursor()">hi</div>

<script>
  setInterval(function() {
$("body").html($("body").html().replace(/567/g,'<b>abcde-fghi</b>'));
  },1000);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T23:06:16.657

您可以在 div 具有焦点时停止间隔，然后在模糊时再次启动它。我还将通过添加一个 id 并仅替换那些内容来更改间隔函数。另外，我认为更简洁的方法可能是在隐藏元素中进行间隔和替换数据。

[http://jsfiddle.net/lucuma/AKtvt/](http://jsfiddle.net/lucuma/AKtvt/)

```
function insertTextAtCursor() {
    var sel, range, html;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            range.insertNode( document.createTextNode('567') );
        }
    } else if (document.selection && document.selection.createRange) {
        document.selection.createRange().text = text;
    }
} 

function ReplaceData() {

    $("#contentdata").val($("#content").html().replace(/567/g,'<b>abcde-fghi</b>'));

    }

$(document).ready(function() {
    var ph=setInterval(ReplaceData,1000);

    $('#content').on("blur", function() {
       $('#content').html($('#contentdata').val());
        ph=setInterval(ReplaceData,1000);
    });

}); 
```

​ ​</p>

# ruby-on-rails - 在特定控制器导轨中加载导航栏

> ID：10841728
> 
> 赞同：1
> 
> 时间：2012-05-31T21:46:34.967
> 
> 标签：ruby-on-rails, rendering, renderpartial

我在铁轨上遇到了一些麻烦。

我想要做的是在使用特定控制器时在应用程序布局中显示一些额外的链接。我该怎么做呢？

我正在使用 jquery 动态加载页面，我尝试使用 <%if controller_name == "foo"%> 然后做一些魔术，但没有任何成功。

如果有人能指出我正确的方向，或者甚至是 jquery-rails 渲染教程，那就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T21:55:47.007

查看 Rails 提供的 content_for 魔法。它允许您在应用程序布局中指定如下内容：

```
<%= yield :header %> 
```

然后在您的个人模板中执行以下操作：

```
<% content_for :header do %>
  Content I want put in the header
<% end %> 
```

这基本上导致 content_for 块内的内容在 yield 语句处被捕获和呈现。因此，您可以在控制器的模板中指定它。

# java - 初始化大量常量时如何规避Java中静态初始化器的大小限制

> ID：10841732
> 
> 赞同：6
> 
> 时间：2012-05-31T21:47:20.133
> 
> 标签：java, compiler-construction, compiler-errors, static-initialization

我有一个类包含大量生成的常量，例如：

```
public class Constants extends SomeBaseClass {

  // init() is defined in some base class...
  public static final XXX KEY1 = init(...);
  public static final XXX KEY2 = init(...);
  public static final XXX KEY3 = init(...);

  // ...
  public static final XXX KEY2000 = init(...);
} 
```

当生成的常量数量非常多时，这会导致静态初始化器大于 Java 方法大小的上限（即 > 64kb），从而导致编译器错误。一种解决方案是为可以保证生成少于 64kb 字节码的块创建几个“块初始化方法”，以便它们适合一种方法：

```
public class Constants extends SomeBaseClass {

  public static XXX KEY1;
  public static XXX KEY2;
  public static XXX KEY3;

  // ...
  public static XXX KEY2000;

  static {
    initialise0001To1000();
    initialise1001To2000();
  }

  private static void initialise0001To1000() {
    KEY1 = init(...);
    KEY2 = init(...);
    KEY3 = init(...);
    // ...
  }

  private static void initialise1001To2000() {
    // ...
    KEY2000 = init(...);
  }
} 
```

这样做的缺点是我不能再将常量声明为`final`，因为它们现在不再直接在静态初始化程序中初始化。

我的问题是，如何以仍然可以生成`static final`常量的方式规避编译器/JVM 限制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T21:49:18.647

一种选择是使用继承 - 有一系列类`Constants1`, `Constants2`, ...,`ConstantsN`它们都定义了常量，然后让每个类都从前一个继承。然后最终类`Constants`可以直接从它们中的最后一个继承。这也可以让您标记所有内容`final`。

出于好奇，您是如何最终得到一个如此大的文件，以至于无法将初始化代码放入 64KB 的限制中？

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T11:24:36.490

我终于找到了一个涉及嵌套类的解决方案。这是用户[Loadmaster在对](https://stackoverflow.com/users/170383/loadmaster)[这个答案](https://stackoverflow.com/a/10841755/521799)的评论中提出的。嵌套类有两个优点：

*   `private`它们允许通过嵌套类向外界隐藏这些变通方法的实现细节
*   它们允许保持常数`final`

[但与templatetypedef 的](https://stackoverflow.com/a/10841755/521799)解决方案相比，它们也有一个缺点：

*   我将再次遇到同样的问题，常量数量要多得多

然而，现在这似乎是最合适的解决方案：

```
public class Constants {

  public static XXX KEY1    = Constants1.KEY1;
  public static XXX KEY2    = Constants1.KEY2;
  public static XXX KEY3    = Constants1.KEY3;

  // ...
  public static XXX KEY2000 = Constants2.KEY2000;

  // Nested class holding 1000 constants
  private static class Constants1 extends SomeBaseClass {
    KEY1 = init(...);
    KEY2 = init(...);
    KEY3 = init(...);
    // ...
  }

  // Nested class holding the next 1000 constants
  private static class Constants2 extends SomeBaseClass {
    // ...
    KEY2000 = init(...);
  }

  // Keep generating nested classes for more constants...
  private static class Constants3 ... {}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T23:53:04.450

这不行吗？ *不。请参阅评论，了解为什么这种答案不能解决问题。*

它将允许您将静态变量保持为最终变量，并且更容易自动生成。 *然而java将所有的静态init块折叠成一个巨大的静态init块，因此问题没有解决。*

```
public class Constants extends SomeBaseClass {

  // init() is defined in some base class...
  public static final XXX KEY1 ;
  static
  {
       KEY1 = init(...);
  }
  public static final XXX KEY2 ;
  static
  {
       KEY2 = init(...);
  }
  public static final XXX KEY3 ;
  static
  {
       KEY3 = init(...);
  }

  // ...

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T00:28:08.737

您可以拥有任意数量的静态初始化块。

# php - 使用 PDO 的策略？（将结果推入数组）

> ID：10841733
> 
> 赞同：0
> 
> 时间：2012-05-31T21:47:24.583
> 
> 标签：php, pdo

这是我有点失败的策略

*   如果它是一个没有输入的查询（总是相同的），只需使用 query();

    ```
    $results = $this->database_top->query( $query ); 
    ```

*   如果返回单行并且有输入，请进行准备（此处未显示）并使用

    ```
    $results = $pdoStatement->fetch(PDO::FETCH_ASSOC); 
    ```

*   如果返回多行并且有输入，请进行准备（此处未显示）并使用：

    ```
    $results = $pdoStatement->fetchAll(); 
    ```

我面临的问题是我需要第一种方法来返回一个数组或数组数组，如第二个和第三个。

准备看起来像这样仅供参考

```
$this->database_top->quote($query);  // quote it
$pdoStatement = $this->database_top->prepare($query);  // prepare it
$results = $pdoStatement->execute($parameterArray); // execute it 
```

如何修改我的代码，以便所有 3 种方法都返回数组或数组数组？

**遍历查询（）**

```
$result_array = $this->DatabaseObject->_pdoQuery( 'multiple', 'tweet_model' );
foreach( $result_array as $array_1d )
{
    $array_2d[]=$array_1d; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:49:47.150

`query`不返回结果，所以我不确定你在第一个例子中的意思。 `query`返回一个 PDOStatement。它与以下内容基本相同：

```
$qry = $db->query("...");
//equiv:
$qry = $db->prepare("...");
$qry->execute(); 
```

正如 vicTROLLA 所指出的，最简单的解决方案是使用：

```
$results = $stmt->fetch(PDO::FETCH_ASSOC); 
```

但是，如果您出于某种原因需要随时处理结果，则始终可以手动循环它们。

```
$stmt = ...;
$results = array();
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { 
    $results[] = $row;
}
//use or return $results 
```

`$results`因此将始终是一个包含 0 个或多个数组的数组。

我发现构建数组键是记录的主键的数组很有用：

```
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { 
    $results[$row['id']] = $row;
} 
```

另外，我怀疑您误解了[quote](http://www.php.net/manual/en/pdo.quote.php)的目的和功能。它用于转义要插入查询的字符串，而不是用于神奇地转义查询中的所有值（因此`$db->quote($query)`没有意义）。

更糟糕的是，司机不需要支持报价。（尽管如果没有支持，它至少会返回 false。）

`prepare`比. *_* _`quote`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:58:57.193

在*所有*这些情况下，你可以做

```
$arrayOfAssocArrays = $pdoStatement->fetchAll(PDO::FETCH_ASSOC); 
```

# html - 如何更改 Joomla 文章的位置？

> ID：10841735
> 
> 赞同：1
> 
> 时间：2012-05-31T21:47:26.730
> 
> 标签：html, css, joomla, joomla-article

我怎样才能改变我想要一篇文章的位置？默认为中心，就像博客一样。

我尝试使用这些模块：

- 文章作为模块

- 文章无处不在

但我没有任何成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:39:04.457

您的问题听起来好像您不太了解 Joomla，或者您需要再解释一下。

因为你的问题给我们留下了一千个答案。

要使用 html 将文本向右移动，您可以使用内联样式标签来浮动文本，如下所示：

```
<p style="float:right;">your text</p> 
```

或者你可以使用这样的 CSS 样式

```
<style type="text/css">
.classname {
 float:left;
}
</style>
<p class="classname">your text</p> 
```

要在 Joomla 中移动模块，请查看此[YouTube 视频](http://www.youtube.com/watch?v=yn-_Hyf-zj0&noredirect=1)

但我不确定这是否是你要问的。

# javascript - 布尔参数未正确传递

> ID：10841737
> 
> 赞同：21
> 
> 时间：2012-05-31T21:47:36.387
> 
> 标签：javascript

我是 jQuery 新手，我只是想将布尔值传递给函数。我尝试了各种修改，但仍然无法正常工作？

我期待警报被触发

```
isTrue(true);

function isTrue(boolean isNot){
    if(isNot){
      alert('true');
    }
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-31T21:48:24.753

JavaScript（不是 Java）没有类型指示符，只有变量名。消除`boolean`

```
function isTrue(isNot){
    if(isNot){
      alert('true');
    }
} 
```

# c# - 带有linq的c#扩展方法

> ID：10841742
> 
> 赞同：1
> 
> 时间：2012-05-31T21:48:06.083
> 
> 标签：c#, linq, lambda

我想编写一个扩展方法来过滤所有在人员对象中具有城镇的人以及商店对象中的城镇

```
class people
    string name
    string town

class shops
    string category
    string town 
```

我知道我会写

```
var x = from p in people
        from s in shops
        where p.town == s.town 
```

但我想知道怎么写

```
var x = from p in people.FilterByTown(p) or FilterByTown(p => p.town) or however it is!! 
```

其中 FilterByTown 是扩展方法，所有的魔法都在那里工作，我传入的对象与商店对象进行比较。

它需要处理被提供给方法的不同对象

希望一切都说得通，上面的代码显然是伪代码！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:59:15.697

使用反射，您可以根据任何类型的任何属性进行过滤：

```
public static IEnumerable<T> FilterByProperty<T>(this IEnumerable<T> source,
                                                 string property,
                                                 object value)
{
    var propertyInfo = typeof(T).GetProperty(property);

    return source.Where(p => propertyInfo.GetValue(p, null) == value);
} 
```

用法：

```
IEnumerable<People> cityPeople = myPeople.FilterByTown("Town", "MyCity"); 
```

如果你想要一个列表：

```
List<People> cityPeopleList = myPeople.FilterByTown("MyCity").ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:56:10.030

假设您有 2 个收藏人和商店，您可以这样写：

```
List<People> people = ...
List<Shops> shops = ...

IEnumerable<People> Filter(this IEnumerable<People> people, IEnumerable<Shops> shops){
var result = people.Where(p=>shops.Any(s=>s.town == p.town));
return result;
} 
```

如果你想通过一些任意属性对所有类进行排序，你可以试试这个版本：

```
public static IEnumerable<T1> Filter<T1, T2>(
    this IEnumerable<T1> one, 
    IEnumerable<T2> two, string property)
        {
           var result = one.Where(o => two.Any(t =>
               o.GetType().GetProperty(property).
               GetValue(o, null).Equals(t.GetType().
               GetProperty(property).GetValue(t, null))));
           return result;
        } 
```

当然，您需要确保该属性有效并且两个对象都具有它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T22:10:41.750

如果我正确理解你的问题，你想要这样的东西：

```
public static IEnumerable<People> FilterByTown(this IEnumerable<People> people, IList<Shop> shops)
{
    return people.Where(p => shops.Any(s => s.Town == p.Town));
} 
```

用法：

```
peoples.FilterByTown(shops); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T22:22:23.150

如果您创建一个独特城镇的列表，您可以加快查询速度

```
public static class PeopleExtensions
{                             
    private static List<string> _distinctShopTowns;

    private static List<Shop> _shops;
    public static List<Shop> Shops
    {
        get { return _shops; }
        set {
            _shops = value;
            _distinctShopTowns = _shops
                .Select(shop => shop.town)
                .Distinct()
                .ToList();
        } 
    }

    public static IEnumerable<Person> PeopleInTownsWithShops(this IEnumerable<Person> people)
    {
        return people.Where(p => _distinctShopTowns.Contains(p.town));
    }
} 
```

你可以这样称呼它

```
List<Shop> shops = ...;
List<Person> people = ...;

PeopleExtensions.Shops = shops; // Do every time the shop list changes.

var x = from p in people.PeopleInTownsWithShops(); 
```

# c++ - ostream 重载可以是函数成员吗？

> ID：10841747
> 
> 赞同：3
> 
> 时间：2012-05-31T21:48:27.877
> 
> 标签：c++

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:57:19.953

它不必是朋友，但它不能是会员。成员运算符仅在它们位于对应于左侧操作数的类中时才起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:52:25.917

如果您将 ostream 运算符放在类本身中，那么它将无法按您期望的方式工作。这将是一个成员函数，意味着调用它必须这样做：`c.operator<<("output")`这显然不是你的意思。要使其按您期望的 ostream 运算符工作，它必须在类之外。您可以通过使其成为朋友来做到这一点，或者只是将其放在类之外并使用 getter（访问器）来输出数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T21:52:26.360

添加一个`public`返回值的查询方法`count_`，那么它不必是`friend`：

```
Counter{
public:
    int count() const { return count_; }
private:
    int count_;
};

std::ostream& operator<<(std::ostream& outStream, const Counter& c){
    outStream << c.count();
    return outStream;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T21:58:57.067

不幸的是，流输出运算符 ( << ) 的有用重载不能是类成员，因为 ostream& 必须在使用和声明的左侧。他们不需要成为您希望流式传输的班级的朋友，除非他们需要访问受保护或私人成员。这意味着如果您可以仅使用诸如观察者/访问者之类的公共函数来实现流式操作符，而无需将其声明为朋友。

在您的第一个 Counter 类中，您声明了一个似乎无效的类的成员函数。在 Counter 类的第二个示例中，您声明 << 的运算符重载似乎有效，可以访问私有成员。在第二个示例中，该函数仍必须在类之外声明。

[C 和 C++](http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B)中的Wikipedia运算符有一个很好的可能的运算符重载列表，包括类中的 << 重载，尽管它们不是很有用。类中的重载必须向后调用`CounterInstance << cout;`，这是违反直觉的。

# javascript - 如何从推文事件中获取推文 ID

> ID：10841752
> 
> 赞同：11
> 
> 时间：2012-05-31T21:48:47.773
> 
> 标签：javascript, twitter, dom-events

我正在使用[Twitter web-intents / javascript API](https://dev.twitter.com/docs/intents/events)，我有点惊讶。我想做的是在推文发生后监听一个事件。按照他们的例子：

```
twttr.events.bind('tweet', function(event) {
    // Do something there
}); 
```

但是，我想做的是存储推文 ID 或其他一些相关信息。如果我查看该`event`对象，则该属性中似乎没有任何相关信息`data`。

**是否可以通过收听推文事件来获取推文 ID（或有关推文的任何其他详细信息）？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-04-13T22:33:22.003

[Web Intent 事件作为触发页面功能的机制存在，而不是数据 API。](https://twittercommunity.com/t/examples-of-capturing-web-intent-events/21448)

> 触发推文事件以指示发生了推文，但我们不通过事件有效负载提供识别信息：意图在您的网站上运行，无需用户授权您访问他们的帐户，并为匿名用户的推文提供推文 ID行动会隐含地为您提供他们的身份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T10:00:41.897

如果你想要推文 ID，你可以使用推特的流 API，它们提供了关于推文的几乎所有细节。

但这有一个问题，因为您需要知道标签或至少部分推文内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-16T19:54:02.047

正如引用的 Xeno，您无法从 Twitter 的 Browser JS Widget 获取此类信息。事件绑定仅用于以下目的：

> 通过将侦听器添加到用户在 Web Intents 中执行的操作，您可以触发应用程序中的功能，或将有关这些事件的（匿名）数据发送到您的 Web 分析系统（如 Google Analytics、Omniture 或您自己的分析引擎）。

所以基本上，在用户发布推文后，您可以在您的应用程序中执行某些操作。

在这个 JSBin ( [http://jsbin.com/nalexuwuhi/1/](http://jsbin.com/nalexuwuhi/1/) )，我刚刚创建了一个基本测试，您可以在其中看到整个事件对象。“tweet_id”值仅用于“说出”您正在响应的推文，例如父推文，而不是创建推文的 tweet_id 是什么。我认为为此目的，您必须使用 twitter api，因此必须使用一些服务器端编码。

# javascript - How to add a specific class to appended LI which is loaded via ajax?

> ID：10841753
> 
> 赞同：2
> 
> 时间：2012-05-31T21:48:48.313
> 
> 标签：javascript, jquery

This is my code. What I am trying to do is add a class "featured" to the first li item which gets added to this UL however, when I try this code, it does not work, it always add the class to every li inserted, while I want the class to be added only if there are no li in the ul and to the first li element added to this UL.

My code:

```
$(".img_add").click(function(event){
    event.preventDefault();
    $('input:submit, p.upload-result').hide(); // hide submit button + results while working
    $(this).parent().after('<p class="loading"><img src="<?php bloginfo('template_directory'); ?>/img/loading_2.gif" alt="" /></p>');
    var path_img = $("#img_url").val();
    var count_images_lib = $(".upload-images-lib").length;
    $.ajax({
        url: '<?php bloginfo('template_directory'); ?>/ajax/add_image_url.php',
        type: 'POST',
        data: { path : path_img },
        dataType: 'json',
        success: function(data){
            $('.loading').remove();
            $('input:submit').show();
            if (data.status) {
                $('.upload-images-lib').prepend(data.message);
                if (count_images_lib == 1) {
                    $('.upload-images-lib li:first-child').addClass('featured');
                }
                alert(count_images_lib);
                $('p.upload-result').fadeIn(500).html('<span class="success"><?php _e('Your image has been added successfully.','sofa'); ?></span>');
            } else {
                $('p.upload-result').fadeIn(500).html('<span class="error">' + data.message + '</span>');
            }
        }
    });
}); 
```

What I want is to add the class to the first loaded li only. **Please note: data.message is actually a list item in html format.**

The problem is with count_images_lib always returning 1 and thus my class is added everytime. It is not with first/last selector.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T21:51:34.197

你试过这个吗。。

```
$('.upload-images-lib li:first').addClass('featured'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:52:02.657

您可能正在寻找 .first() 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:53:31.147

由于您正在执行前置操作，因此我假设加载的第一个项目将位于列表的底部。因此，使用`:last`选择器获取最后一项（第一次加载）并给它类。

```
$('.upload-images-lib li:last').addClass('featured') 
```

# qt - QProcess exits before complete

> ID：10841754
> 
> 赞同：1
> 
> 时间：2012-05-31T21:48:52.267
> 
> 标签：qt, qprocess

I've got some code that starts mencoder in a QProcess, converts a video while displaying a progress bar, then exits. The problem is, mencoder always exits before it's actually finished. The loop runs through a few times, and then closes. If I comment out the line that updates the progress bar (progress.setValue()), mencoder runs to completion and exits happily.

Been at this for a day, and can't figure it out! Also, I should mention I'm on a Mac.

Any ideas?

Thanks

Marlon

```
void MainWindow::convertVideo()
{
    QString input_filename = "/var/input.avi";
    QString output_filename = "/var/output.264";

    QStringList arguments;
    arguments << input_filename << "-nosound" << "-of" << "rawvideo" << "-ofps" << "30" << "-vf" << "harddup" << "-ovc" << "x264" << "-x264encopts" << "bframes=0" << "-o" << output_filename;

    QProcess* myProcess = new QProcess(this);
    myProcess->setReadChannel(QProcess::StandardOutput);

    myProcess->start("/opt/local/bin/mencoder", arguments);

    QString output_string;
    QStringList output_pieces;

    QProgressDialog progress("Converting video...", "Abort", 0, 100, this);
    progress.setWindowModality(Qt::WindowModal);
    progress.setValue(0);
    progress.show();

    while(myProcess->state() != QProcess::NotRunning)
    {
        output_string = myProcess->readAllStandardOutput();

        output_pieces = output_string.split(" ");
        QStringList width_string_list = output_pieces.filter("%)");
        if(width_string_list.length() > 0)
        {
            width_string_list = width_string_list[width_string_list.length() - 1].split("(");
            if(width_string_list.length() > 1)
            {
                width_string_list = width_string_list[1].split("%");
            }
            else
            {
                width_string_list = width_string_list[0].split("%");
            }

            progress.setValue(width_string_list[0].toInt());

            qDebug() << width_string_list[0].toInt();

        }

        myProcess->waitForReadyRead();
    }

    return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T06:10:37.647

我认为 QProcess 在完成工作之前会超时。添加一个`myProcess->waitForFinished(-1)`可能会有所帮助。然后你的过程不会超时。

# .htaccess - what is wrong with my nginx.conf file. rewrite issues

> ID：10841756
> 
> 赞同：-1
> 
> 时间：2012-05-31T21:49:23.343
> 
> 标签：.htaccess, nginx

I am new to nginx and I have been hacking up my nginx.conf file to get a site working but still having issues with a few different things. Here is the scope and some problems. #2 below is most important. My nginx.conf file is located at the bottom via pastebin link.

1) my site has vanity urls... domain.com/username (this works)

2) my site also has directories in root. domain.com/red/ but the cannot be viewed because the following comes up... (This is a 404 error, page cannot be found.) I would like domain.com/red/ to just show up

3) I also have a wp blog and it is located here: domain.com/blog/ redirects to www.domain.com/blog/ (It shows up and works but I prefer to not have 'www.' Also can't use seo friendly permalink urls)

Here is my [nginx.conf file](http://pastebin.com/HDcH2PZ8)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T23:12:47.327

您需要一个`try_files`目录声明。

[在这里](http://wiki.nginx.org/HttpCoreModule#try_files)查看更多信息。

我们还需要站点特定的配置文件，除了您的`nginx.conf`

# mysql - How do I to add multiple directories to an SQL database while sharing the same schema?

> ID：10841758
> 
> 赞同：0
> 
> 时间：2012-05-31T21:49:30.020
> 
> 标签：mysql, phpmyadmin

A buddy of mine needed help adding multiple directories to an SQL database while sharing the same schema yet have different listings. I've scoured my "MySQL" books and Google, I can't find any definitive information. I was just hoping someone here knew how to do this.

To clarify, there are a total of 12 directories. 11 are to be searched independently of one another and the 12th (which already exists) will be a directory comprised of all 11 directories, all of which will have the same schema. The goals are to create these unique directories using the existing schema model, and to upload multiple directory entries at a time to the directories. Does this mean the names of the directory entries have to be unique (ie. Name_1, Name_2, Name_3, etc...?) Or, will it be a matter of duplicating the schema under a different name? Any advise will help.

A directory, in this context, is like a roledex. I mean to have 12 roledexes with each rolodex having unique entries frem eachother. How do you approach this database-wise?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:23:07.167

登录到您的 PHPMyadmin 后，选择或进入您要复制和重命名的表，然后单击“操作”。在那里您会看到一系列框，其中一个称为“将表复制到（database.table）”您可以选择复制结构和数据，或仅复制结构。输入您想要的名称，然后单击开始。您的带有列表的新表格将可以编辑和搜索！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:54:15.960

如果我理解您的要求...我*认为*您想为每个“目录”创建一个新数据库，正如您所说，其中包含相同的表定义。

mySQL 用语中的“数据库”一词与其他一些 RDBMS 系统用语中的“模式”含义相同。在同一个数据库（a/k/a 模式）中不能有两组具有相同表名的数据。为此，您需要不同的架构。

在单个服务器中拥有大量数据库并具有完全相同的表/列/键等是很常见的。是的，phpmyadmin 可以处理这个问题。

但是，“目录”这个词令人困惑。它通常指的是 mySQL (RDBMS) 服务器程序使用的磁盘数据存储。但我不认为这就是你的意思。如果您是认真的，请确保您在系统管理方面非常熟练，然后再尝试使用 mySQL 服务器上的文件系统。东西很容易坏。（问我怎么知道破坏东西是多么容易:-) :-)

# java - LinkedBlockingQueue with fast contains(Object o) method?

> ID：10841760
> 
> 赞同：11
> 
> 时间：2012-05-31T21:49:36.387
> 
> 标签：java, concurrency

In a nutshell, I'm writing an application that needs a `BlockingQueue` implementation that provides both FIFO adds/removes, but also a fast `contains` method, as I'll be calling it a TON.

`LinkedBlockingQueue` gets me most of the way there, but it appears that its `contains` method runs in linear time, as it is based on `AbstractQueue`'s `contains` method. I didn't see anything in the Java API that seemed to advertise an LBQ with fast `contains` out-of-the-box.

What makes things tougher is, my project is on a really severe time crunch (no, this isn't homework). I could do a quick-and-dirty LBQ extension with a `HashSet` underneath for fast `contains`, but I'm still going to have to test it, which could eat up a significant amount of man-hours. I'm wondering if there are any trusted/well-tested libraries out there that provide a `LinkedBlockingQueue` extension with a `contains` method that runs in O(1) time...? If not, any other suggestions are welcome.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T19:25:45.597

Thanks again to all who provided input. I ended up coding my own `HashedLinkedBlockingQueue` implementation. Getting the synchronization correct by using the decorator pattern proved much more difficult than anticipated. Adding synchronization to the decorator caused deadlocks to occur under heavy load (particularly, `put(E element)` and `take()` introduced hold-and-wait conditions that previously didn't exist). When coupled with decreased performance because of unnecessary synchronization, it became apparent that I'd need to spend the time to get it right from scratch.

Performance in `add`/`remove`/`contains` is O(1) but comes with roughly double the synchronization cost of the original `LinkedBlockingQueue` - I say "roughly double" because the LBQ uses two locks - one for inserts and one for removes when the queue size is sufficiently large to allow concurrent modification of head and tail. My implementation uses a single lock, so removes must wait for adds to complete and vice versa. Here's the source code for the class - I have tested each method in both multi-threaded and single-threaded modes, but outside of using this class in my own application, I have not come up with a super-complicated, generalized test. Use at your own risk! Just because it works in my app doesn't mean there aren't still bugs:

```
import java.util.Arrays;
import java.util.Collection;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.NoSuchElementException;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.LinkedBlockingQueue;
import java.util.concurrent.TimeUnit;

/**
 * Provides a single-lock queuing algorithm with fast contains(Object o) and
 * remove(Object o), at the expense of higher synchronization cost when
 * compared to {@link LinkedBlockingQueue}.  This queue implementation does not
 * allow for duplicate entries.
 * 
 * <p>Use of this particular {@link BlockingQueue} implementation is encouraged
 * when the cost of calling 
 * <code>{@link BlockingQueue#contains(Object o)}</code> or 
 * <code>{@link BlockingQueue#remove(Object o)}</code> outweighs the throughput
 * benefit if using a {@link LinkedBlockingQueue}.  This queue performs best
 * when few threads require simultaneous access to it.
 * 
 * <p>The basic operations this queue provides and their associated run times
 * are as follows, where <i>n</i> is the number of elements in this queue and
 * <i>m</i> is the number of elements in the specified collection, if any such
 * collection is specified:
 * 
 * <ul>
 * <li><b>add(E element)</b> - <i>O(1)</i></li>
 * <li><b>addAll(Collection<? extends E> c)</b> - <i>O(m)</i></li>
 * <li><b>drainTo(Collection<? extends E> c, int maxElements)</b>
 *  - <i>O(maxElements*O(</i><code>c.add(Object o)</code><i>))</i></li>
 * <li><b>contains(E element)</b> - <i>O(1)</i></li>
 * <li><b>offer(E element)</b> - <i>O(1)</i></li>
 * <li><b>poll()</b> - <i>O(1)</i></li>
 * <li><b>remove(E element)</b> - <i>O(1)</i></li>
 * <li><b>removeAll(Collection<? extends E> c)</b> - <i>O(m)</i></li>
 * <li><b>retainAll(Collection<? extends E> c)</b> - <i>O(n*O(
 *  </i><code>c.contains(Object o)</code><i>))</i></li>
 * </ul>
 * 
 * @param <E> type of element this queue will handle.  It is strongly
 * recommended that the underlying element overrides <code>hashCode()</code> 
 * and <code>equals(Object o)</code> in an efficient manner.
 * 
 * @author CodeBlind
 */
@SuppressWarnings("unused")
public class HashedLinkedBlockingQueue<E> implements BlockingQueue<E>{
    /** Polling removes the head, offering adds to the tail. */
    private Node head, tail;
    /** Required for constant-time lookups and removals. */
    private HashMap<E,Node> contents;
    /** Allows the user to artificially limit the capacity of this queue. */
    private final int maxCapacity;

    //Constructors: -----------------------------------------------------------

    /**
     * Creates an empty queue with max capacity equal to
     * {@link Integer#MAX_VALUE}.
     */
    public HashedLinkedBlockingQueue(){ this(null,Integer.MAX_VALUE); }

    /**
     * Creates an empty queue with max capacity equals to the specified value.
     * @param capacity (1 to {@link Integer#MAX_VALUE})
     */
    public HashedLinkedBlockingQueue(int capacity){
        this(null,Math.max(1,capacity)); 
    }

    /**
     * Creates a new queue and initializes it to the contents of the specified
     * collection, queued in the order returned by its iterator, with a max
     * capacity of {@link Integer#MAX_VALUE}.
     * @param c collection of elements to add
     */
    public HashedLinkedBlockingQueue(Collection<? extends E> c){
        this(c,Integer.MAX_VALUE);
    }

    /**
     * Creates a new queue and initializes it to the contents of the specified
     * collection, queued in the order returned by its iterator, with a max
     * capacity equal to the specified value.
     * @param c collection of elements to add
     * @param capacity (1 to {@link Integer#MAX_VALUE})
     */
    public HashedLinkedBlockingQueue(Collection<? extends E> c, int capacity){
        maxCapacity = capacity;
        contents = new HashMap<E,Node>();

        if(c == null || c.isEmpty()){
            head = null;
            tail = null;
        }
        else for(E e : c) enqueue(e);
    }

    //Private helper methods: -------------------------------------------------

    private E dequeue(){
        if(contents.isEmpty()) return null;

        Node n = head;
        contents.remove(n.element);

        if(contents.isEmpty()){
            head = null;
            tail = null;
        }
        else{
            head.next.prev = null;
            head = head.next;
            n.next = null;
        }

        return n.element;
    }

    private void enqueue(E e){
        if(contents.containsKey(e)) return;

        Node n = new Node(e);
        if(contents.isEmpty()){
            head = n;
            tail = n;
        }
        else{
            tail.next = n;
            n.prev = tail;
            tail = n;
        }

        contents.put(e,n);
    }

    private void removeNode(Node n, boolean notify){
        if(n == null) return;
        if(n == head) dequeue();
        else if(n == tail){
            tail.prev.next = null;
            tail = tail.prev;
            n.prev = null;
        }
        else{
            n.prev.next = n.next;
            n.next.prev = n.prev;
            n.prev = null;
            n.next = null;
        }

        contents.remove(n.element);
        if(notify) synchronized(this){ contents.notifyAll(); }
    }

    //Public instance methods: ------------------------------------------------

    public void print(){
        Node n = head;
        int i = 1;
        while(n != null){
            System.out.println(i+": "+n);
            n = n.next;
            i++;
        }
    }

    //Overridden methods: -----------------------------------------------------

    @Override
    public boolean add(E e){
        synchronized(this){
            if(remainingCapacity() < 1) throw new IllegalStateException();
            enqueue(e);
            contents.notifyAll();
        }

        return true;
    }

    @Override
    public boolean addAll(Collection<? extends E> c){
        boolean changed = true;
        synchronized(this){
            for(E e : c){
                if(remainingCapacity() < 1) throw new IllegalStateException();
                enqueue(e);
            }

            contents.notifyAll();
        }
        return changed;
    }

    @Override
    public void clear(){
        synchronized(this){
            if(isEmpty()) return;
            head = null;
            tail = null;
            contents.clear();
            contents.notifyAll();
        }
    }

    @Override
    public boolean contains(Object o){
        synchronized(this){ return contents.containsKey(o); }
    }

    @Override
    public boolean containsAll(Collection<?> c) {
        synchronized(this){
            for(Object o : c) if(!contents.containsKey(o)) return false;
        }

        return true;
    }

    @Override
    public int drainTo(Collection<? super E> c) {
        return drainTo(c,maxCapacity);
    }

    @Override
    public int drainTo(Collection<? super E> c, int maxElements) {
        if(this == c) throw new IllegalArgumentException();
        int transferred = 0;

        synchronized(this){
            while(!isEmpty() && transferred < maxElements)
                if(c.add(dequeue())) transferred++;
            if(transferred > 0) contents.notifyAll();
        }

        return transferred;
    }

    @Override
    public E element(){
        E e = peek();
        if(e == null) throw new IllegalStateException();
        return e;
    }

    @Override
    public boolean isEmpty() {
        synchronized(this){ return contents.isEmpty(); }
    }

    @Override
    public Iterator<E> iterator(){ return new Itr(); }

    @Override
    public boolean offer(E e){
        synchronized(this){
            if(contents.containsKey(e)) return false;
            enqueue(e);
            contents.notifyAll();
        }

        return true;
    }

    @Override
    public boolean offer(E e, long timeout, TimeUnit unit)
            throws InterruptedException{
        long remainingSleep = -1;
        long millis = unit.toMillis(timeout);
        long methodCalled = System.currentTimeMillis();

        synchronized(this){
            while((remainingSleep = 
                    (methodCalled+millis)-System.currentTimeMillis()) > 0 &&
                    (remainingCapacity() < 1 || contents.containsKey(e))){
                contents.wait(remainingSleep);
            }

            if(remainingSleep < 1) return false;
            enqueue(e);
            contents.notifyAll();
        }

        return true;
    }

    @Override
    public E peek(){
        synchronized(this){ return (head != null) ? head.element : null; }
    }

    @Override
    public E poll(){
        synchronized(this){
            E e = dequeue();
            if(e != null) contents.notifyAll();
            return e;
        }
    }

    @Override
    public E poll(long timeout, TimeUnit unit) throws InterruptedException{
        E e = null;
        long remainingSleep = -1;
        long millis = unit.toMillis(timeout);
        long methodCalled = System.currentTimeMillis();

        synchronized(this){
            e = dequeue();

            while(e == null && (remainingSleep = (methodCalled+millis)-
                    System.currentTimeMillis()) > 0){
                contents.wait(remainingSleep);
                e = dequeue();
            }

            if(e == null) e = dequeue();
            if(e != null) contents.notifyAll();
        }

        return e;
    }

    @Override
    public void put(E e) throws InterruptedException{
        synchronized(this){
            while(remainingCapacity() < 1) contents.wait();
            enqueue(e);
            contents.notifyAll();
        }
    }

    @Override
    public int remainingCapacity(){ return maxCapacity-size(); }

    @Override
    public E remove(){
        E e = poll();
        if(e == null) throw new IllegalStateException();
        return e;
    }

    @Override
    public boolean remove(Object o){
        synchronized(this){
            Node n = contents.get(o);
            if(n == null) return false;
            removeNode(n,true);
        }

        return true;
    }

    @Override
    public boolean removeAll(Collection<?> c){
        if(this == c){
            synchronized(this){
                if(isEmpty()){
                    clear();
                    return true;
                }
            }

            return false;
        }

        boolean changed = false;

        synchronized(this){
            for(Object o : c){
                Node n = contents.get(o);
                if(n == null) continue;
                removeNode(n,false);
                changed = true;
            }

            if(changed) contents.notifyAll();
        }

        return changed;
    }

    @Override
    public boolean retainAll(Collection<?> c){
        boolean changed = false;
        if(this == c) return changed;

        synchronized(this){
            for(E e : new LinkedList<E>(contents.keySet())){
                if(!c.contains(e)){
                    Node n = contents.get(e);
                    if(n != null){
                        removeNode(n,false);
                        changed = true;
                    }
                }
            }

            if(changed) contents.notifyAll();
        }

        return changed;
    }

    @Override
    public int size(){ synchronized(this){ return contents.size(); }}

    @Override
    public E take() throws InterruptedException{
        synchronized(this){
            while(contents.isEmpty()) contents.wait();
            return dequeue();
        }
    }

    @Override
    public Object[] toArray(){
        synchronized(this){ return toArray(new Object[size()]); }
    }

    @SuppressWarnings("unchecked")
    @Override
    public <T> T[] toArray(T[] a) {
        synchronized(this){
            //Estimate size of array; be prepared to see more or fewer elements
            int size = size();
            T[] r = a.length >= size ? a :
                (T[])java.lang.reflect.Array
                .newInstance(a.getClass().getComponentType(), size);
            Iterator<E> it = iterator();

            for (int i = 0; i < r.length; i++) {
                if (! it.hasNext()) { // fewer elements than expected
                    if (a != r)
                        return Arrays.copyOf(r, i);
                    r[i] = null; // null-terminate
                    return r;
                }
                r[i] = (T)it.next();
            }
            return it.hasNext() ? finishToArray(r, it) : r;
        }
    }

    //Static helper methods: --------------------------------------------------

    @SuppressWarnings("unchecked")
    private static <T> T[] finishToArray(T[] r, Iterator<?> it) {
        int i = r.length;

        while (it.hasNext()) {
            int cap = r.length;
            if (i == cap) {
                int newCap = ((cap / 2) + 1) * 3;
                if (newCap <= cap) { // integer overflow
                    if (cap == Integer.MAX_VALUE)
                        throw new OutOfMemoryError
                        ("Required array size too large");
                    newCap = Integer.MAX_VALUE;
                }
                r = Arrays.copyOf(r, newCap);
            }
            r[i++] = (T)it.next();
        }
        // trim if overallocated
        return (i == r.length) ? r : Arrays.copyOf(r, i);
    }

    //Private inner classes: --------------------------------------------------

    /**
     * Provides a weak iterator that doesn't check for concurrent modification
     * but also fails elegantly.  A race condition exists when simultaneously
     * iterating over the queue while the queue is being modified, but this is
     * allowable per the Java specification for Iterators.
     * @author CodeBlind
     */
    private class Itr implements Iterator<E>{
        private Node current;
        private E currentElement;

        private Itr(){
            synchronized(HashedLinkedBlockingQueue.this){
                current = head;
                if(current != null) currentElement = current.element;
                else currentElement = null;
            }
        }

        @Override
        public boolean hasNext(){
            return currentElement != null;
        }

        @Override
        public E next(){
            if(currentElement == null) throw new NoSuchElementException();

            synchronized(HashedLinkedBlockingQueue.this){
                E e = currentElement;

                current = current.next;
                if(current == null || !contents.containsKey(current.element)){
                    current = null;
                    currentElement = null;
                }
                else currentElement = current.element;

                return e;
            }
        }

        @Override
        public void remove(){
            synchronized(HashedLinkedBlockingQueue.this){
                if(current == null || !contents.containsKey(current.element))
                    throw new NoSuchElementException();

                Node n = current;
                current = current.next;
                if(current != null && contents.containsKey(current.element))
                    currentElement = current.element;
                else currentElement = null;

                removeNode(n,true);
            }
        }
    }

    /**
     * This class provides a simple implementation for a node in a double-
     * linked list.  It supports constant-time, in-place removals.
     * @author CodeBlind
     */
    private class Node{
        private Node(E e){
            element = e;
            prev = null;
            next = null;
        }

        private E element;
        private Node prev, next;

        @Override
        public String toString(){
            StringBuilder sb = new StringBuilder("Node[prev.element=");
            if(prev == null) sb.append("null,element=");
            else sb.append(prev.element+",element=");
            sb.append(element+",next.element=");
            if(next == null) sb.append("null]");
            else sb.append(next.element+"]");
            return sb.toString();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T00:05:38.507

正如其他人已经说过的，使用基于哈希的结构是解决方案。我没有在 Java Collection API 上看到任何实现。

但是您可以使用 Guava 类 ForwardingBlockingQueue 轻松创建 HashBlockingQueue 装饰器

# javascript - How to display a side panel on the left and Google maps api canvas on the right, filling remainder of page?

> ID：10841762
> 
> 赞同：1
> 
> 时间：2012-05-31T21:49:43.677
> 
> 标签：javascript, css, google-maps-api-3, position, positioning

I need to be able to have a side panel that fills the height of the page on the left and a map filling the rest of the page on the right. I would like the side panel to have a width of 300px, regardless of the size of the browser with the map to the right of it. Also, I am not able to move any of the divs within #panel, they are all just aligned one after the other. Here's my css:

```
body {margin:0;}
        #panel {height:100%; width:300px; position:absolute; padding:0;background-color:#8C95A0;}
            #div1 {padding:2px; text-align:center}
            #div2 {padding:2px; text-align:center}
            #div3 {padding:2px; text-align:center}
            #div4 {padding:2px; text-align:center}
            #div5 {padding:2px; text-align:center}
                #div5a {padding:2px; text-align:center}
                #div5b {padding:2px; text-align:center}
                #div5c {padding:2px; text-align:center}
            #div6 {padding:2px; bottom:0px; text-align:center}
        #map_canvas {height:100%; width:1200px; left:300px; position:absolute; padding:0;} 
```

How can I make #map_canvas fill the rest of the page and how can I move my divs?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:35:15.633

```
<html>
    <head>
    <style>
        html,body { padding:0; margin:0; height:100%; }
        #panel { background-color: #DDD; position:absolute; top:0; left:0; bottom:0; width:300px; }
        #map_canvas { background:red; position:absolute; top:0; left:300px; right:0; bottom:0; }
    </style>
    </head>
    <body>
        <div id="panel"></div>
        <div id="map_canvas"></div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T18:18:44.947

我能够解决我在问题中询问的两个问题。首先，我能够使用相对定位在侧面板中移动我的 div，而不是绝对。其次，我使用以下 css 使地图填充屏幕的其余部分，位于侧面板的右侧：

#map_canvas {高度：100%; 左：300px；右：0px；位置：绝对；填充：0；边距：0；}

# javascript - JavaScript 格式数字，始终为 3 位数字

> ID：10841773
> 
> 赞同：15
> 
> 时间：2012-05-31T21:50:23.280
> 
> 标签：javascript, numbers, format, digits, days

> **可能重复：**
> [如何使用 JavaScript 创建 Zerofilled 值？](https://stackoverflow.com/questions/1267283/how-can-i-create-a-zerofilled-value-using-javascript)

我必须输出一个必须始终有 3 位数字的天数。而不是**3**它必须写**003**，而不是**12**它必须写**012**。如果大于**100**则不格式化输出。我想知道是否有我可以使用的正则表达式或一些快速的内联脚本，或者我必须创建一个应该这样做并返回结果的函数。谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-31T21:54:14.290

怎么样：

```
 zeroFilled = ('000' + x).substr(-3) 
```

对于任意宽度：

```
 zeroFilled = (new Array(width).join('0') + x).substr(-width) 
```

根据评论，这似乎更准确：

```
lpad = function(s, width, char) {
    return (s.length >= width) ? s : (new Array(width).join(char) + s).slice(-width);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T21:57:16.990

我在 Samuel Mullen[的博客](http://samuelmullen.com/2012/03/left-pad-zeroes-in-javascript/)上找到了一个优雅的解决方案。我只是优化了`zeroes`创作。

```
function lpad(value, padding) {
    var zeroes = new Array(padding+1).join("0");
    return (zeroes + value).slice(-padding);
} 
```

用法：`lpad(12, 3)`导致`"012"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:52:25.307

这是一个简单的函数，它用零填充一个数字到一定的宽度：

```
function zeroFill(number, width) {
    width -= number.toString().length;
    if(width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }
    return number + ""; // always return a string
} 
```

（来自[如何用前导零填充值？](https://stackoverflow.com/questions/1267283/how-can-i-create-a-zerofilled-value-using-javascript)）

由于原始答案没有解释该功能的工作原理，我将在这里进行。

`width`最初包含您想要的总长度，因此`width - number_of_digits`是必要的填充字符数。
`new Array(len + 1).join(str)`重复`str` `len`几次。
正则表达式用于在数字包含小数点的情况下添加额外的填充零，因为该点也包含在`number_of_digits`确定的使用中`number.toString().length`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T21:53:52.827

一种可能的解决方案：

```
​while ((val+"").length < 3​) {
    val = "0" + val;
} 
```

**演示：http:** [//jsfiddle.net/WfXVn/](http://jsfiddle.net/WfXVn/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T21:54:39.703

你可以这样做...

```
("00" + day).slice(-3) 
```

它会在前面加上零，然后`.slice()`总是给你字符串的最后 3 个值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-31T21:55:28.243

我会编写以下函数：

```
var pad = function(n, length) {
    var str = "" + n;
    if(str.length < length) str = new Array(length - str.length).join("0") + str;
    return str;
}; 
```

# image - 将图像拖到地图上

> ID：10841774
> 
> 赞同：0
> 
> 时间：2012-05-31T21:50:25.183
> 
> 标签：image, maps

我需要实现一个可以对图像进行地理标记的功能。我想将图像（可以从列表中选择一个或多个图像）拖放到地图上。然后，应将所选图像自动标记到它们被丢弃的位置。

有人可以给我一个关于如何解决这个问题的想法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T21:11:10.820

是的，您可以使用 HTML 和 Javascript 做到这一点。我建议你使用 jquery 库。

你所做的是渲染你想要放置图像的地图（对于这个例子纽约市）

您所做的是使用 jquery 使您想要将自己放在自由女神像上的图像具有 50% 的不透明度和可拖动性。在图像下你有一个

*   在图像中间作为不透明的“指针”。人们将图像下方的“点”拖到所需的位置。当它发布时，您获取偏移量 x 和 y，计算相对时间 x 和 y 以找到地理位置，然后通过 ajax 存储所有内容。

    这是你必须努力实现这一目标的基础。

    这是一个有趣的项目，但有点耗时。

# git - git 列出忽略的案例

> ID：10841777
> 
> 赞同：1
> 
> 时间：2012-05-31T21:50:38.500
> 
> 标签：git, github

我的 git 存储库有一些问题，所以我不明白为什么 .gitignore 会失败......

是否可以读取 .gitignore 文件和 git 忽略的路径/文件的列表？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:59:02.310

如果您想查看当前被您忽略的实际文件，`.gitignore`您可以使用`git-ls-files`：

```
git ls-files -i --exclude-from=.gitignore 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:55:35.727

是的，可以有一个 git 忽略的文件/文件夹列表，获取它很简单：

```
cat .gitignore 
```

# php - preg_match 模式下一行两个第一个单词

> ID：10841779
> 
> 赞同：0
> 
> 时间：2012-05-31T21:50:56.463
> 
> 标签：php, preg-match, preg-match-all

我有这个``/admin[^:]*:\s*(.* )/i`主题的 preg_match 模式（作为示例）

```
txt stuff
Administrative Contact:
Brown, John support@xxxxxxx.com
txt stuff 
```

拉出“Brown，John support@xxxxxxx.com”，但我需要一些东西来搜索和打印“Brown，John”（姓名），而不是整行（一切都是姓名，而不是电子邮件）。这是一段大文本，唯一的静态字符串是“Administrative Contact:”。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:58:12.660

[http://ideone.com/u0UgL](http://ideone.com/u0UgL)

```
$str = 'txt stuff
Administrative Contact:
Brown, John support@xxxxxxx.com
txt stuff';

preg_match('~admin[^:]*:\s*(.*)\s+\S+@~i', $str, $matches);
var_dump($matches[1]); // string(11) "Brown, John" 
```

# regex - 文件重命名正则表达式添加不需要的后缀

> ID：10841781
> 
> 赞同：0
> 
> 时间：2012-05-31T21:51:07.367
> 
> 标签：regex, linux, rename

我有问题`rename -v 's/\.jpg$/\_120x120.jpg/' *.jpg`

`zzr31_120x120.jpg`改名为`zzr31_120x120_120x120.jpg`

我怎样才能更清楚地表明它只会重命名那些没有 120х120 的？最重要的是，如果可能的话，不仅要做到这一点，而且`jpg`还要在一个命令中做到这一点？`gif``png`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:21:35.200

您需要使用[负前瞻](http://www.perlmonks.org/?node_id=518444)并使用正则表达式来匹配您选择的扩展名，从而使重命名仅考虑每个文件 *

所以无论如何，这是我的建议

```
rename -n 's/^((?:(?!_120x120).)*)\.(jpg|png|gif)$/$1_120x120.$2/' * 
```

删除 -n 以使其正常工作，否则它只会显示它将重命名的内容而不会实际重命名

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:19:34.650

你需要使用一个叫做`negative look-behind assertions`; 检查`perlre(1)`文档以获取完整的详细信息。我无法想出要使用的确切语法，这是我最后的努力：

```
/(.*)\K120x120\.(jpg|gif|png)/$1_120x120.$2/ 
```

一个更简单的答案是首先移走“好”文件：

```
mkdir foo
mv *_120x120.* foo
rename -v 's/\.jpg$/\_120x120.jpg/' *.jpg
mv foo/* .
rmdir foo 
```

# django - 为什么我无法在我的 clean 函数中访问 self.cleaned_data 的值？

> ID：10841786
> 
> 赞同：0
> 
> 时间：2012-05-31T21:51:35.320
> 
> 标签：django, django-forms

我为我的 Django 表单编写了一个干净的函数。我将`OPTIONAL_PASSWORD_INPUT`及`OPTIONAL_REPEAT_PASSWORD_INPUT`以上定义为密码输入字段：

```
class addNewMemberForm(SignUpForm):
    username = forms.SlugField(required=False, 
                   min_length=MIN_USER_NAME, 
                   max_length=MAX_USER_NAME, 
                   label="Username (optional)", 
                   help_text="If left empty, we will generate a username for you."
    )
    password = OPTIONAL_PASSWORD_INPUT
    password2 = OPTIONAL_REPEAT_PASSWORD_INPUT

    def clean(self):

        # if user name is filled out, so must be the password field.
        if self.data["username"] and not self.data["password"]:
            raise forms.ValidationError("If you specify a username, you must specify a password.")

        return self.cleaned_data

    def __init__(self, *args, **kwargs):
        super(SignUpForm, self).__init__(*args, **kwargs)
        self.fields.keyOrder = uniqueify(['username', 'email'] + self.fields.keyOrder) 
```

如果我更改`if self.data["username"] and not self.data["password"]:`为`if self.cleaned_data["username"] and not self.cleaned_data["password"]:`，Django 会为“用户名”生成一个关键错误。

为什么我可以访问`self.data`数组的值，但不能`self.cleaned_data`在我的 clean 函数中访问数组的值？

另一方面，这个问题甚至重要吗？我可以用`self.data`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:28:06.643

在调用`form.clean`. `username`仅当输入的数据有效时才添加到cleaned_data。这意味着您应该在清理的早期使用`self.cleaned_data.get`或检查是否有任何错误，`self.errors`并放弃额外的验证，如果个别字段无效，这可能是不必要的。

# mysql - 如果 MySQL 数据库连接失败，则将 SQL 查询记录到文件

> ID：10841789
> 
> 赞同：0
> 
> 时间：2012-05-31T21:51:42.030
> 
> 标签：mysql, perl, dbi

我有一个用于将数据写入 MySQL 数据库的 Perl 脚本，运行良好。我的问题是，如果与 MySQL 数据库的连接超时或失败，是否有适当的方法将准备好的查询记录到本地文件？如果连接失败或超时，Perl-DBI obj 是否甚至允许准备 MySQL 语句？

谢谢！

布拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T00:23:16.367

DBI 或 MySQL 客户端中没有类似的东西。也很难使其以通用方式正常工作，因为许多边缘/异常情况确实是特定于应用程序的。

这种事情也容易出错，因为只有在事情已经很糟糕的情况下，你才在做相对复杂的事情。如果 MySQL 不可用是一种常见情况，或者在发生错误时停止/超时/重试太重要，请查看是否可以将数据写入另一个更擅长处理错误的流（总是）。例如，您可以将其推送到本地服务器上的 scribe 中，并让另一个程序从 scribe 读取数据并插入/更新 MySQL。Scribe 负责本地缓冲到磁盘等。

当然，这只是在不同的错误情况下有不同的权衡。

# objective-c - Objective-C 文件创建错误

> ID：10841790
> 
> 赞同：0
> 
> 时间：2012-05-31T21:51:47.990
> 
> 标签：objective-c, xcode, file-io, nsstring, nsdata

我正在制作一个简单的命令行工具，用户在其中输入用户名和密码（我不关心加密，因为这只是一个练习）以及他们的年龄和这些数据被写入文件。这是我的代码：

```
 char username[40];
    char password[40];
    int age = 0;
    NSString *path = [NSString stringWithFormat:@"%@/Documents/config.txt", NSHomeDirectory()];
    NSFileManager *fileManager = [[NSFileManager alloc]init];

    //Username Input
    NSLog(@"Pick a username (less then 40 letters):");
    scanf("%s", username);
    NSString *usernameString = [[NSString alloc] initWithBytes:username
                                                            length:39 
                                                          encoding:NSUTF8StringEncoding];

    //Password Input
    NSLog(@"Pick a password (less then 40 letters):");
    scanf("%s", password);
    NSString *passwordString = [[NSString alloc] initWithBytes:password
                                                        length:39 
                                                      encoding:NSUTF8StringEncoding];
    //Age Input
    NSLog(@"What's your age?");
    scanf("%i", &age);

    NSString *finalContents = [NSString stringWithFormat:@"%@\n%@\n%i", usernameString, passwordString, age];
    NSData *dataContent = [finalContents dataUsingEncoding:NSUTF8StringEncoding];
    [fileManager createFileAtPath:path contents:dataContent attributes: nil]; 
```

当我打开生成的文件时，它具有以下内容：

```
(null)
(null)
18 
```

我为用户名和密码以及年龄的数字 18 输入了一个少于 40 个字符的字符串，因此看来只有年龄有效。先谢谢了。

编辑：该文件的内容为“（null）（null）18”，中间有换行符，但它们没有出现在我的帖子中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:57:58.710

尝试使用`stringWithCString:encoding:`.

# c++ - 有没有办法以给定的优先级执行系统命令？

> ID：10841796
> 
> 赞同：1
> 
> 时间：2012-05-31T21:52:17.897
> 
> 标签：c++, windows, winapi, thread-priority

我的意思是这个命令：

```
system("myprogram.exe"); 
```

有没有办法让它在低于正常优先级模式下运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:58:14.830

WINAPI 有一个函数调用[`CreateProcess()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425%28v=vs.85%29.aspx)，允许指定优先级：

```
dwCreationFlags [输入]

    控制优先级和进程创建的标志。
有关值的列表，请参阅进程创建标志。

    此参数还控制新进程的优先级，即
用于确定进程线程的调度优先级。
有关值的列表，请参阅 GetPriorityClass。如果没有优先级
flags 指定，优先级类默认为 NORMAL_PRIORITY_CLASS
除非创建进程的优先级是 IDLE_PRIORITY_CLASS
或 BELOW_NORMAL_PRIORITY_CLASS。在这种情况下，子进程接收
调用进程的默认优先级。

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:59:47.940

您可以在应用程序的主线程上使用**SetThreadPriority()**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-04T15:33:22.810

我认为这是一个更完整的答案：

三个不同的选项（这些不是步骤）：

*   在**CreateProcess**期间，指定进程优先级 CLASS（各个线程优先级派生自进程优先级类）。
*   启动应用程序后，使用**SetPriorityClass**。这使您可以随意更改优先级 CLASS。
*   **通过SetThreadPriority**更改单个线程的优先级。这些按照“基础”优先级 CLASS 上下移动。

有关详细信息，请参阅 MSDN。

# php - 通过参数引用名称获取受保护的属性？

> ID：10841798
> 
> 赞同：0
> 
> 时间：2012-05-31T21:52:25.603
> 
> 标签：php, object, protected

让我们说：

```
class myclass{
     protected $info;
     protected $owner;
     __construct(){
        $this->info = 'nothing';
        $this->owner = 'nobody';
    }
    function getProp($string){
        return $this->$string;
    }
} 
```

但它不起作用，这不可能吗？它没有返回任何内容或显示错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:57:08.580

我`function`在你的 __construct 之前添加了，但除此之外它似乎工作正常

```
class myclass{
     protected $info;
     protected $owner;
     function __construct(){
        $this->info = 'nothing';
        $this->owner = 'nobody';
     }
     function getProp($string){
        return $this->$string;
     }
}

$m = new myclass();
echo $m->getProp('info');

// echos 'nothing' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:57:21.903

它工作正常，但是您缺少 . 前面的 function 关键字`__construct`。这输出“无”：

```
<?php

class myclass{
     protected $info;
     protected $owner;

    function __construct(){
        $this->info = 'nothing';
        $this->owner = 'nobody';
    }
    function getProp($string){
        return $this->$string;
    }
}

$test = new myclass();
echo $test->getProp('info'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:56:21.297

我认为你应该阅读 PHP 的魔法方法。你正在做的事情很有可能，但你做的方式可能不是最好的。

[http://php.net/manual/en/language.oop5.magic.php](http://php.net/manual/en/language.oop5.magic.php)

我认为您应该查看 __get() 和 __set() 方法。

# java - 将 Java 应用程序移植到 C++ (qt)

> ID：10841803
> 
> 赞同：3
> 
> 时间：2012-05-31T21:52:39.863
> 
> 标签：java, c++, model-view-controller, qt, blockingqueue

我已经使用 Swing 用 Ja​​va 编写了应用程序，现在我正在尝试用 C++ 重写它。Java 中的程序有控制器，它有对事件的模型、视图和 BlockingQueue 的引用。当 View 发生某些事情时，新事件被放入 BlockingQueue 并由 Controller 和 Model 处理。然后 SwingUtilities.invokeLater() 在 Swing 中调用了一些动作。

如何使用 Qt 在 C++ 中做这样的事情？我已经编写了模型，但我不知道如何通过 Java 中的 BlockingQueue 之类的东西将它与用 Qt 编写的 UI 连接起来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T15:48:51.967

如果可能的话，我会避免使用线程。如果您没有更多的说明，我建议您查看[Qt 文档中的信号和插槽](http://qt-project.org/doc/qt-4.8/signalsandslots.html)。简而言之，信号和槽是 Qt 中事件处理的默认方式。与小部件交互会导致触发信号。您的类可以*将*自己连接到这样的信号并对其做出反应。

我意识到这个答案很模糊。如果你添加更多关于*你*想要完成的细节，我会很乐意更新它:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:45:03.353

BlockingQueue 的等价物是每个`QObject`. 它没有在 QObject 的 Qt 文档中明确说明（应该是这样！），但是对于每个 QObject 都有一个有效的事件队列。您可以使用静态`QCoreApplication::postEvent`方法从任何线程向任何 QObject 发布事件——只要您有一个指向 QObject 的指针，您就可以向它发布事件。

该类型的信号槽连接`Qt::QueuedConnection`使用相同的事件队列来发布内部`QMetaCallEvent`事件。这些事件被拾取`QObject::event()`并导致对相关插槽的调用。当控制返回到线程的事件循环时，后者查看事件队列并将事件传递给`QObject::event()`方法。

那些内置的事件队列非常有用，因为它们本质上允许您序列化对 QObject 的访问，因此您不必添加额外的同步原语，并且您可以避免陷入死锁。使用 ad-hoc 同步会带来麻烦，不幸的是，即使是 Java 在设计上也出错了。请参阅 Herb Sutter 关于此主题的出色公开：[死锁的许多方面](http://www.drdobbs.com/cpp/209900973)和[避免在关键部分中调用未知代码](http://www.drdobbs.com/architecture-and-design/202802983)。他有很多[关于这个和相关主题的其他出版物](http://www.gotw.ca/publications/index.htm)，这是一个真正的知识宝库。他还解释了如何设计从运行到完成的、简短的异步应用程序以获得良好的性能。

如果您的设计基于 QObjects 以及它们之间使用信号槽和事件发布的连接，那么如果您的分析/基准测试表明需要这样做，您就可以将这些 QObjects 中的任何一个移动到专用的 QThread。但是，任何从 QWidget 派生的东西都不能离开 GUI 线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T15:36:55.360

听起来您想使用 QThread 创建一个工人类。看一下 Qt' Mandelbrot 在响应 GUI 事件的线程中完成的工作示例：http: [//doc.qt.io/qt-4.8/qt-threads-mandelbrot-example.html](http://doc.qt.io/qt-4.8/qt-threads-mandelbrot-example.html)

# c# - 在列表中的每个项目上搜索匹配项的最佳方法是什么？

> ID：10841804
> 
> 赞同：0
> 
> 时间：2012-05-31T21:52:41.173
> 
> 标签：c#, asp.net, match

`using Visual.Web.Developer.2010.Express;`

N00b，
我知道有很多方法可以做到这一点，但哪种方法最有效？我有 2 个文本区域，其中包含彼此相关的项目（`aT1`& `aT2`）。对于“aT1”中的每个项目，比较“aT2”中的所有内容最有效的方法是什么。我将如何分隔“aT1”中的每个项目？如果要查找匹配，它将选择匹配发生在“aT2”中的整行。我做了一个可靠的 'ol Google 搜索，然后我遇到了`Regex`、`string.match`和`List<string>`.. 是否有一些明显的我已经跑过去并且没有停下来检查？任何关于优秀教程的帮助/指针将不胜感激！不是真的在寻找代码，但如果你必须，你可以发布一些代码。

这里有一些`aT1`：

```
ABC9910A
ABC42554
LOW3381
BD6210HFP
NWP448A1S
OTT123A04NS 
```

这里有一些`aT2`：

```
APPLEMACHINE    Y   ABC9910AIMAP
APPLEMACHINE    Y   ABC42554AIRAJZ
BANANABOI   Y   LOW33811CBZ
LLBLEAD TECHN   Y   NWP448A1S3LWXFTMA1
LLBLEAD TECHN   Y   OTT123A04NS4NSGATMA1 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:05:16.627

我会将 aT1 存储为字符串列表（通过在换行符上吐痰）。

遍历该列表并使用正则表达式来查看它是否与 aT2 中的任何内容匹配，您还可以使用该正则表达式来选择它匹配的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:11:39.113

试试这个：

```
//guessing on .Text
var matches =
    from a in at2.Text.Split(new [] {Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries) 
    from b in at1.Text.Split(new [] {Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries) 
    where a.Contains(b)
    select a; 
```

# jquery - ajax jquery struts2 list of objects (which contains list of objects internally)

> ID：10841805
> 
> 赞同：0
> 
> 时间：2012-05-31T21:52:45.750
> 
> 标签：jquery, ajax, struts2

Using jQuery ajax when click on "Next" I will get list of objects (which contains list of objects internally) without converting that to json and not using any other plugin, how I can render this list to display the table similar to in struts.

Currently I am using a include jsp with only the table to be refreshed with next set of results and replacing the existing table div with new jsp. Can someone suggest any other method to do this.

List of Orders and each order has multiple items. One row represents

```
Order#  --  Order Date -- Item# -- Item Description

                            1   --  Shirt
1       --  05/21/2012 --   2   --  Pant
                            3   --  Brief 
```

If I have 100 orders per page if I display 25 Orders when I click on "NEXT" button as explained above I will get list of next 25 orders then it should display the next 25.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T00:20:46.967

I have used the [.load](http://api.jquery.com/load/) function to refresh the list. Same as given example, No conversion to Json is required.

Action Class

```
public String 25Orders(){
// get from DB 25 orders
// on Click of next by passing page 2 get next 25 orders
}

public Map<abc, Lis<xyz>> getOrders(){
return objects;
} 
```

.js class

```
$("a[id=pagination]").click(function(event) {
     $("div").load("fulord",{pageStr:this.name});
}); 
```

jsp class

```
<div id=OrdersTable>
<s:iterator value="Orders">
   <tr>
     <td><s:property value=key.orderNumber/></td>
     <td><s:property value=key.orderDate/></td>
      <td>
        <table> 
           <s:iterator value=items>
            <tr>
             <td><s:property value=itemNumber/></td>
             <td><s:property value=itemDesc/></td>
            </tr>
           </s:iterator>
         </table>
      </td>
   </tr>
</s:iterator>
</div> 
```

**NOTE:** But I see one problem here if a page has more than one div or if I try to give div ID in js it won't work properly. I am trying to resolve that but as of this is solution I found.

# wcf - WCF protobuf-net 未显示帮助页面

> ID：10841807
> 
> 赞同：1
> 
> 时间：2012-05-31T21:53:04.073
> 
> 标签：wcf, protobuf-net

基本的 WCF 服务项目，包括 protobuf-net .dll 库。

打开网络浏览器并转到 localhost/wcf/service1.svc，一切正常。

现在转到 localhost/wcf/service1.svc/help，在浏览器控制台上显示 400 Bad Request（如 firebug）。

这是**web.config**

```
<bindings>
  <basicHttpBinding>
    <binding name="BasicHttpBinding1" messageEncoding="Mtom">
      <security mode="None"></security>
    </binding>
  </basicHttpBinding>
</bindings>

<behaviors>
  <serviceBehaviors>
    <behavior name="Service1Behavior">
      <serviceMetadata httpGetEnabled="true"/>
      <serviceDebug includeExceptionDetailInFaults="true"/>
    </behavior>
  </serviceBehaviors>

  <endpointBehaviors>
    <behavior name="protoEndpointBehavior">
      <protobuf />
    </behavior>
  </endpointBehaviors>
</behaviors>

<extensions>
  <behaviorExtensions>
    <add name="protobuf" type="ProtoBuf.ServiceModel.ProtoBehaviorExtension, protobuf-net"/>
  </behaviorExtensions>
</extensions>

<serviceHostingEnvironment multipleSiteBindingsEnabled="true" aspNetCompatibilityEnabled="true" />

<services>
  <service name="WcfService1.Service1" behaviorConfiguration="Service1Behavior">
    <endpoint address="" contract="WcfService1.IService1" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding1" behaviorConfiguration="protoEndpointBehavior" />
  </service>
</services> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T11:21:49.770

只需要这个来查看帮助页面：

```
<bindings>
  <webHttpBinding>
    <binding name="WebHttpBinding1" >
      <security mode="None"></security>
    </binding>
  </webHttpBinding>
<bindings>

<behaviors>
  <endpointBehaviors>
    <behavior name="protoEndpointBehavior">
      <webHttp helpEnabled="true"/>
      <protobuf />
    </behavior>
  </endpointBehaviors>
</behaviors>

<services>
  <service name="WcfService1.Service1" behaviorConfiguration="Service1Behavior">
    <endpoint address="" contract="WcfService1.IService1" binding="webHttpBinding" bindingConfiguration="WebHttpBinding1" behaviorConfiguration="protoEndpointBehavior" />
  </service>
</services> 
```

同样如 Mark 所说，basicHttpBinding 允许消息编码 Mtom，从而提高效率。但是 webHttpBinding 不允许。

# android - 为什么我的图像没有调整大小？

> ID：10841809
> 
> 赞同：0
> 
> 时间：2012-05-31T21:53:19.153
> 
> 标签：android, image, resize

我有一个图像路径，我将其解码为位图。我发现 Bitmap 太大并试图调整它的大小。它不起作用（图像太大），我的代码可以吗？

```
ImageButton myImage = (ImageButton) findViewById(R.id.image);

Bitmap myBitmap = BitmapFactory.decodeFile(selectedImagePath);
Bitmap.createScaledBitmap(myBitmap, NEW_WIDTH, NEW_HEIGHT, true);

myImage.setImageBitmap(myBitmap); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:57:34.850

```
Bitmap myBitmap = BitmapFactory.decodeFile(selectedImagePath);
Bitmap scaledBitmap = Bitmap.createScaledBitmap(myBitmap, NEW_WIDTH, NEW_HEIGHT, true);
myBitmap.recycle();
myBitmap = null; 
```

它旨在不更改原始位图。您没有捕获参考，因此它只是被丢弃了。

请记住，以这种格式创建位图会占用更多内存，因为您在创建新位图的同时仍保留旧位图。如果您经常这样做并且不丢弃旧的引用，那么您的堆将迅速增长。

# html - 只有 IE 无法查看本站

> ID：10841811
> 
> 赞同：0
> 
> 时间：2012-05-31T21:53:24.990
> 
> 标签：html, css, internet-explorer

我开始建网站了，但是好像除了IE以外的所有浏览器都可以查看。我对为什么会发生这种情况感到困惑，对我的问题的任何见解将不胜感激。

[链接到网站](http://www.sfu.ca/~jca41/stuph/fas/template02.html)

HTML：

```
<html>
<head>

    <link rel="stylesheet" type="text/css" media="screen" href="css/stickyFooter.css" />

</head>
<body>

<div id="wrap">

    <header>
        <div id="header"></div>
        <div id="banner"></div>
        <div id="nameplate"></div>
        <div id="whiteLine"></div>

    </header>

    <div id="body">body</div>

    <div class="push"></div>

</div>

<footer>footer</footer>

</body>
</html> 
```

CSS：

```
* {
    margin: 0;
}
html, body {
    height: 100%;
    background: url(../image/core/background.jpg) repeat-x center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
}

header div#header {
    background: url(../image/core/header.png) repeat-x;
    height: 61px;
}

header div#banner {
    background: url(../image/banner/01.jpg) no-repeat center;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    height: 300px;
}

header div#nameplate {
    background: url(../image/core/nameplate.png) no-repeat;
    height: 140px;
    width: 1000px;
    margin: -340px auto 0 auto;
}

header div#whiteLine {
    background: url(../image/core/stripe.png) repeat-x;
    height: 1px;
    margin: 200px 0 0 0;
}

#wrap {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -61px; /* the bottom margin is the negative value of the footer's height */
}
footer, .push {
    height: 61px; /* .push must be the same height as .footer */
}

footer {
    background-color: red;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:54:34.390

您需要添加一个文档类型

请参阅 F12 开发人员工具中的此警告

`HTML1113: Document mode restart from IE9 Standards to Quirks`

查看更多信息 - [http://www.javascriptkit.com/howto/doctype.shtml](http://www.javascriptkit.com/howto/doctype.shtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T03:13:20.427

`My 2 cents.`由于我为其构建页面的一些人仍然使用（抱怨）IE7，因此我必须首先编写代码以使“客户”满意。所以我马上让我的代码为 IE7 工作，然后如果它在 FF 等中工作，它就是肉汁。`<footer></footer>`据我所知，旧版 IE 不支持。一条建议，如果您要使用“页脚”标签，请在`.php`或`.shtml`格式中使用“包含”语句，以后更容易更改；从经验。用于更坏情况的代码。干杯~

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T21:56:56.507

这很正常，网页在 IE 上不起作用。

说真的……如果您使用的是 IE9 之前的版本，请查看[http://code.google.com/p/html5shim/ 。](http://code.google.com/p/html5shim/)

# javascript - 如何将元素传递给spine.js中的嵌套堆栈

> ID：10841812
> 
> 赞同：1
> 
> 时间：2012-05-31T21:53:28.303
> 
> 标签：javascript, spine.js

我有一个控制器，它包含一个`Spine.Model`实例并有一个嵌套`Spine.Stack`，
我如何将模型实例传递给嵌套堆栈控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T15:22:18.587

弄清楚了。堆栈中的每个控制器都有堆栈，`@stack`因此将对象传递给堆栈使这些对象在控制器上也可用

# c++ - Qt：创建半透明的禁用图标状态

> ID：10841814
> 
> 赞同：2
> 
> 时间：2012-05-31T21:53:36.010
> 
> 标签：c++, qt, user-interface, icons, qpainter

我想从原始图标图像（不为禁用状态使用额外图像）为我的图标禁用状态动态创建一个半透明图标像素图。

我认为这需要五分钟，只需创建一个 QPainter，将其不透明度设置为 0.5 或其他值，然后在其中绘制正常的 Pixmap。

问题是 QPainter 似乎从设置为 (205, 205, 205) 的背景开始，我没有什么可以让它完全透明的。

这是我用于标准图标的代码：

```
icon.addPixmap(QPixmap(filename)); 
```

这是我迄今为止尝试为禁用状态制作透明版本的方法：

```
QPixmap normalPixmap(filename);
QPixmap disabledPixmap(normalPixmap.size());
QPainter p(&disabledPixmap);

p.setBackgroundMode(Qt::TransparentMode);
p.setBackground(QBrush(Qt::transparent));
p.eraseRect(normalPixmap.rect());
// (...) I've tried Composition modes and a lot of other stuff here, with no success

p.setOpacity(0.5);
p.drawPixmap(0, 0, normalPixmap);

p.end();
icon.addPixmap(disabledPixmap, QIcon::Disabled, QIcon::On); 
```

这些是我从上述代码中得到的结果：

![在此处输入图像描述](../Images/daa2030b08a9473f13c4ecd811a2df9f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T17:46:22.560

尝试：

`disabledPixmap.fill(Qt::transparent);`

在创建 QPainter 之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T00:06:34.947

将图像绘制到 disabledPixmap 后，请尝试以下代码：

```
// Make the bitmap partially transparent by setting the alpha channel of all pixels
painter.setCompositionMode(QPainter::CompositionMode_DestinationIn);
painter.fillRect(thePixmap.rect(), QColor(255,255,255,150)); 
```

# sql - 如何在 MVC 中使用 GeomFrom GML() 将 gml 导入几何列

> ID：10841819
> 
> 赞同：0
> 
> 时间：2012-05-31T21:54:11.813
> 
> 标签：sql, gml

我有一个功能，用户上传 KML 文件，我使用 XSLT 将其转换为 GML，然后将其保存到另一个文件。我的问题是如何在 MVC 中使用 GeomFromGML() 将此 GML 数据导入几何列？

完全被难住了，找不到任何好的例子。以下是我的上传和转换代码：

```
var fileName = Path.GetFileName(Polygon.FileName);
                var path = Path.Combine(Server.MapPath("~/App_Data/uploads"),fileName);
                Polygon.SaveAs(path);
                XPathDocument myXPathDoc = new XPathDocument(path);
                XslCompiledTransform myXslTrans = new XslCompiledTransform();
                myXslTrans.Load(Server.MapPath("~/App_Data/XSL/kml2gml2.xsl"));
                var gml = Path.Combine(Server.MapPath("~/App_Data/GML/gml.xml"));
                XmlTextWriter myWriter = new XmlTextWriter(gml, null);
                myXslTrans.Transform(myXPathDoc, null, myWriter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T14:39:47.533

我对 GeomFromGML() 从来没有任何运气，所以我使用了 NetTopologySuite。它包含两个类：GMLReader 和 WKTWriter，您可以使用它们首先读取 GML，然后将其写入 WKT。可以使用 STGeomFromtext 将 WKT 插入数据库以将其保存在 SQL 数据库中：

```
GMLReader gmlr = new GMLReader();
WKTWriter wktw = new WKTWriter();
IGeometry g = gmlr.Read(gmlxml);
string wkt = wktw.Write(g);
string sql = "INSERT INTO mytable (GeomCol) VALUES (geometry::STGeomFromText('"+wkt+"', 0));"; 
```

或者也许您的 XSLT 可用于将 KML 直接转换为 WKT？

# segmentation-fault - QWebpage createPlugin 方法

> ID：10841825
> 
> 赞同：0
> 
> 时间：2012-05-31T21:54:41.890
> 
> 标签：segmentation-fault, qwebpage

可以给我一个如何解决它的想法。

第一页包含三个 <object> 标签：

```
<object type="application/x-qt-plugin"
     classid="TabWidget" name="TabWidget"  id="TabWidget"></object>
<object type="application/x-qt-plugin"
     classid="ColorPicker" name="colorPicker" id="ColorPicker"></object>
<object type="application/x-qt-plugin"
     classid="BaseColorsCircles" name="baseColorsCircles" id="BaseColorsCircles"></object> 
```

这会导致以下函数被调用三次：

```
QObject* customWebPage::createPlugin(
   const QString &classid,
   const QUrl &url,
   const QStringList &paramNames,
   const QStringList &paramValues)
{
    if (classid=="ColorPicker"){
        return colorPicker;
    } else if(classid=="BaseColorsCircles"){
        return baseColorsCircles;
    } else if(classid=="TabWidget") {
        return tabs;
    } else if(classid=="ColorBlender") {
        return blender;
    } else
        return 0;
} 
```

一切正常，我什至有几个插槽和信号连接在它们之间并且它工作正常。问题是当我以任何方式重新加载页面时（刷新或转到另一个页面并返回）。再次调用该函数，当尝试返回任何已嵌入的元素时，它崩溃并出现错误 0xC0000005 并且调试器给我一个警告，上面写着“劣质停止，因为它收到了来自操作系统的信号。信号名称: SIGSEGV 信号含义：分段错误。”

有任何想法吗？我什至尝试删除指针并在再次返回它们之前重新初始化它们，但是，“删除”指令会导致错误。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T13:43:06.567

没关系。每次重定向浏览器时，对象都会被删除，因此每次都必须创建新对象。

# windows - Windows 7 上类似“颠覆”的设置

> ID：10841828
> 
> 赞同：-1
> 
> 时间：2012-05-31T21:55:16.023
> 
> 标签：windows, svn, backup

我需要一个软件，它可以保存文件的所有以前版本，并带有某种“自动提交”。我不想使用 github 等远程服务器。

我是那些尝试通过反复试验来做所有事情的菜鸟程序员之一。但是，有时，源代码的更改会更糟，我需要回到旧版本的源代码。今天更糟。断电后，我辛勤工作的代码完全被空字节填满。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:57:17.690

答案就在问题中。安装 SVN（或其他 SCM）。

至少 eclipse 有一个本地历史，以防你需要回到你没有承诺的事情。不知道其他IDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T21:58:41.557

有许多在本地工作的版本控制系统。例如，Git 是完全独立的。您可以将历史记录推送到远程服务器，但没有必要这样做。Mercurial 也是如此。甚至 Subversion 和 CVS 也允许您使用本地的、基于文件的存储库，尽管使用它们您有一个额外的步骤，即在与工作目录不同的位置创建该存储库。

踢它真的很老派，RCS 和 SCCS 根本没有服务器的概念。:)

我不确定 OP 反对基于服务器的 SCM 系统是什么。远程备份是一件好事，您可以免费获得它们。但大多数 SCM 系统完全包含在一个盒子中工作正常。

就“自动”提交而言，您可能可以将 IDE 配置为每次保存时提交。这似乎比IDE之外的东西每N分钟自动保存文件更有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T22:07:43.920

您不需要远程服务器。只需使用像样的单片机。Subversion 可能不是您最好的选择，因为它要求您在工作副本之外设置存储库，这可能很不方便。最重要的是，在其开发过程中做出了一些糟糕的设计决策，这可能会导致令人沮丧和困惑的情况。

假设您在 Windows 上，我会推荐**mercurial** - 它简单、独立、易于学习、跨平台且免费（在两种意义上）。基本上，它所做的是`.hg`在项目的根目录中创建一个名为的隐藏目录，其中保存了项目的完整历史记录。您确实必须主动告诉它何时制作快照，但这确实简单明了。查看[http://hginit.com/](http://hginit.com/)以获取严肃的介绍。

另一种选择是**git**；它比 mercurial 更通用，速度稍快，但 windows 端口有点孤儿，而且它的社区对菜鸟不太友好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T21:57:27.130

好吧，我当然会推荐使用“普通”的 SCM，但既然你反对，那么简单的旧 Windows 备份怎么样？如果你使用 BitBucket，你可以选择 mercurial，它是一个分布式系统，在你推送之前只保留本地的 repo 副本。

另一种选择是使用命令行脚本每 X 分钟提交到 SCM，例如 SVN 或 Mercurial。

Mercurial/BitBucket 命令：

```
hg commit -m "Auto Committed" 
```

将其粘贴在批处理文件中并使用调度程序按时间间隔运行它。

不要与工具作斗争...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T22:07:34.163

当我开始编程并想要一个类似的东西时，我只是在我的电脑上使用了 Dropbox，并将我的项目文件夹放在我的 Dropbox 中。每次您在保管箱中保存文件时，它都会自动发送到服务器，您可以在网站上查看每个保存并下载/恢复到以前的版本。简单，容易，您无需担心源代码控制系统的所有额外功能，如果您是学生，那么在他们的计算机上没有 SVN 的学校里，可以轻松地处理您的东西。

# java - 模态 JDialog 的 1x1 尺寸

> ID：10841829
> 
> 赞同：4
> 
> 时间：2012-05-31T21:55:22.870
> 
> 标签：java, swing

**问题**

我们的独立 Swing 应用程序在某些特定事件（按钮单击等）处显示**模态 JDialog**。该对话框包含一些其他 Swing 组件（JLabels、JButtons、...）。而不是通过`JDialog.setBounds(...)`我们调用的方法显式设置它的维度`JDialog.pack()`（或者`JOptionPane`'s 的`showDialog(...)`方法隐式调用它）。通过`pack()`方法计算的尺寸始终是恒定的（例如 300x100 像素）。不幸的是，有时**可见对话框的实际尺寸是 1x1 像素**（`JDialog.getSize().equals(new Dimension(1, 1))`）。

**JDialog初始化**

`JDialog`我们在应用程序中初始化 s有两种方式。我们检查了这两个初始化方法总是从 EventDispatchThread 调用。

*第一种方法*

我们只是创建一个实例，`ADialog`它是 的子类`JDialog`。这是我们初始化过程的片段：

```
ADialog dialog = new ADialog();
dialog.setContentPane(content);
dialog.setVisible(true); 
```

这是我们的`ADialog`实现：

```
public class ADialog extends JDialog implements ComponentListener {

    public JfosDialog(Frame owner) {
        super(owner);
        init();
    }

    private void init() {
        super.addComponentListener(this);
    }

    @Override
    public void componentShown(ComponentEvent e) {
        // Calling pack() at this place is really weird, but we
        // have to do it since some subclasses put their
        // content to dialog in overriden componentShown().
        pack();
    }

    @Override
    public void componentMoved(ComponentEvent e) { /** not interested */ }

    @Override
    public void componentResized(ComponentEvent e) { /** not interested */ }
} 
```

*第二种方法*

```
public JOptionPane showDialog(...) {
    JOptionPane jop = new JOptionPane(message, msgType, option, null, textMessages);
    JDialog dialog = jop.createDialog(owner, titleMsg);
    setDialogTraversal(dialog);
    dialog.setVisible(true);
    dialog.dispose();
    return jop;
} 
```

**再现性**

*环境*

*   Ubuntu 12.04., JRE 1.6 / JRE 1.7 / OpenJDK 1.6
*   Windows XP、JRE 1.6.u16

*用第一种初始化方法重现问题*

我们只显示然后隐藏对话框 N 次 (0 < N < 1000)，并且一旦时间对话框的尺寸是 1x1（线程问题的标志，竞争条件）。由于这个问题的性质是非常随机的，我们编写了简单的[java.awt.Robot](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Robot.html)脚本来显示和隐藏循环中的对话框。这比手动操作更舒服。

*用第二种初始化方法重现问题*

步骤与第一种方法相同：只需显示然后隐藏对话框 N 次。不幸的是，我们无法在我们的开发环境中重现它，但它可以很容易地在生产 PC 中重现（CPU 与我们的开发环境不同，安装了一些防病毒软件会永久造成系统负载等）

到目前为止，我们无法在某种测试/示例项目中重现该问题。这可能表明我们的应用程序有问题。但是，似乎问题可能出在 Swing 的本机代码中（请参阅跟踪部分）。

**追踪**

我们在 64 位 OpenJDK 1.6.0_24 中追踪了问题的原因。我们发现 的维度`JDialog`是由`XConfigureEvent`触发的`XToolkit`。`XToolkit.run(boolean)`从本地方法调用返回后，在方法的事件循环中构造事件。

为了简化事情，我在这里只发布了一个代码片段，说明`XToolkit`了我们的跟踪结果的事件循环机制。您还可以在[此处查看完整的源代码](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/sun/awt/X11/XToolkit.java#XToolkit.run%28boolean%29)。

```
public class XToolkit ... {
    ...
    public void run(boolean loop) {
        XEvent ev = new XEvent();
        while(true) {
            awtLock();
            try {
                if (loop == SECONDARY_LOOP) {
                    ...
                } else {
                    ...

                    // ===========================================
                    // The following invocation of native method sometimes
                    // updates ev object in a way that ev.get_type() method returns value 22
                    // indicating that the event's type is XConfigureEvent.
                    // In such case, as I mentioned in text above, the value of
                    // ev.get_xconfigure().get_width() / .get_height()
                    // is sometimes 1.

                    XlibWrapper.XNextEvent(getDisplay(),ev.pData); // <-----

                    // ===========================================
                }
                ...
                // The XConfigureEvent with get_width() == 1 and
                // get_heigth() == 1 is dispatcher here:
                dispatchEvent(ev); // <-----
                ...
            } catch (...) {
                ...
            }
        }
    }
    ...
} 
```

你有什么想法如何修复这个错误/更深入地跟踪它/更健壮地重现它......？

我很欣赏任何想法，因为这个错误是一个真正的痛苦。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T22:10:21.257

pack() 应该尊重组件的首选（或最小大小，取决于布局管理器）。

尝试为对话框中的组件明确设置最小和首选大小，看看是否能解决问题。

就竞争条件而言，它也可能是代码中的不正确初始化。当布局管理器查询它们的首选（或最小尺寸）时，大多数组件都会优化它们的内容（例如 JLabel 的文本）。因此，填充组件的代码可能并不总是以相同的顺序运行。您是否确保在 AWT 线程上创建对话框和所有包含的组件？

# javascript - 在 JavaScript 中隐藏/显示 div

> ID：10841832
> 
> 赞同：0
> 
> 时间：2012-05-31T21:55:30.017
> 
> 标签：javascript, html

大家好，我试图隐藏/显示加载 div，但存在问题：页面加载后，div 再次出现......这是我正在使用的代码

```
 <div id="LoadContent" style="visibility: visible">
            Please wait while we check our databases....
            <br/>
            <img src="images/ajax-loader.gif" id="LoadImg">
        </div>

document.getElementById('LoadContent').style.visibility = 'hidden'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:59:48.387

将您的 javascript 添加到`<body onload="">`，这样当页面完成渲染时它将隐藏您的 div。

css 在渲染时间或重新渲染时间优先于 javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:09:23.837

div 没有 onload 事件，[只有某些 tags](https://stackoverflow.com/questions/679704/can-you-put-the-javascript-onload-event-anywhere-besides-in-the-body-tag)。

然而，这并不意味着你不走运。为什么这个特定的 div 加载时间比你的 html 的其余部分要长？

例如，如果您在其中有大图像，那么您可以为这些设置 onload 事件，并在它们全部完成加载时显示 div。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T00:00:57.590

您应该恢复可见性以显示和使用块/无。

如果您按照我的步骤（稍后...），那么您将需要获取 jquery 库（将它们添加到您的标题中），例如：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.min.js" type="text/javascript"></script> 
```

另一方面，使用 jquery 的编码会少很多：

```
<script type="text/javascript">
function hidebox(){
    $("#LoadContent").toggle();
}
</script> 
```

你的身体标签应该是这样的：

```
<body onload="hidebox()"> 
```

# ruby-on-rails - Heroku、Postgresql、composite_primary_keys

> ID：10841834
> 
> 赞同：2
> 
> 时间：2012-05-31T21:55:35.307
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord, heroku

我有一个正在开发的 Rails 3 应用程序。我在几个表中使用了composite_primary_keys gem，但是Rails 仍在创建一个没有被使用的id 字段（即每个条目都为nil）。虽然它在 SQLite3 中的本地计算机上运行，​​但我无法在 Heroku 上运行该应用程序。Postgresql 对我产生了影响，并给了我这个错误：

```
2012-05-31T21:12:36+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  null value in column "id" violates not-null constraint
2012-05-31T21:12:36+00:00 app[web.1]:   app/controllers/items_controller.rb:57:in `block (2 levels) in create'
2012-05-31T21:12:36+00:00 app[web.1]: : INSERT INTO "item_attr_quants" ("attribute_id", "created_at", "id", "item_id", "updated_at", "value") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "item_id","attribute_id"): 
```

由于“id”字段为零，Postgresql 对我大喊大叫。

有没有一种方法可以防止首先创建“id”字段，使用原始 SQL 语句删除列，强制 Heroku 上的 Postgresql 允许“id”字段为空，或者解决这个问题方法？我对使用复合主键很执着，所以我不想删除 gem 并重写代码。

**模型**

```
class ItemAttrQuant < ActiveRecord::Base
  belongs_to :item
  belongs_to :attribute
  self.primary_keys = :item_id, :attribute_id
end 
```

**移民**

```
class CreateItemAttrQuants < ActiveRecord::Migration
  def change
    create_table :item_attr_quants do |t|
      t.belongs_to :item
      t.belongs_to :attribute
      t.integer :value

      t.timestamps
    end
    add_index :item_attr_quants, :item_id
    add_index :item_attr_quants, :attribute_id
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:50:49.410

您可以在迁移中使用`:id => false`和`:primary_key`选项：[`create_table`](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-create_table)

```
class CreateItemAttrQuants < ActiveRecord::Migration
  def change
    create_table :item_attr_quants, :id => false do |t|
      ...
    end
    ...
  end
end 
```

这将`item_attr_quants`在没有`id`列的情况下创建，但您的表将没有真正的主键。您可以通过指定`not null`for`item_id`并`attribute_id`在这两列上添加唯一索引来添加假的：

```
class CreateItemAttrQuants < ActiveRecord::Migration
  def change
    create_table :item_attr_quants, :id => false do |t|
      t.integer :item_id, :null => false
      t.integer :attribute_id, :null => false
      t.integer :value
      t.timestamps
    end
    add_index :item_attr_quants, [:item_id, :attribute_id], :unique => true
    add_index :item_attr_quants, :item_id
    add_index :item_attr_quants, :attribute_id
  end
end 
```

我不认为 ActiveRecord 完全理解数据库中真正的复合主键的概念，因此唯一索引是 AFAIK 最好的，除非您想手动将 ALTER TABLE 发送到数据库中。

# ubuntu - Ubuntu中export命令的含义

> ID：10841837
> 
> 赞同：32
> 
> 时间：2012-05-31T21:55:44.183
> 
> 标签：ubuntu

`export`在 Ubuntu中是什么意思？例如：

```
export PATH=$PATH:/usr/src/hive/build/dist/bin/ 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-31T22:04:11.817

[export](http://ss64.com/bash/export.html)是 Bash shell 语言中的一个命令。当用于设置变量时，如您的示例中，变量（PATH）将从该 Bash 实例启动的任何子进程可见（“导出到”）。如果没有导出命令，该变量将不会存在于子进程中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-31T22:00:16.757

这意味着，您的路径扩展为`/usr/src/hive/build/dist/bin/`. 通常 /usr/bin、/bin、/usr/sbin 等都在“你的路径中”。如果你有一个程序 /bin/sh，你可以输入 sh 来运行它。如果你有一个程序，`/usr/src/hive/build/dist/bin/appname`你可以运行 appname 来执行它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T21:58:21.340

它将环境变量设置`PATH`为当前的值`PATH`加上附加到它的新路径。

# c - Win32，即使在孩子终止后也从管道块中读取文件

> ID：10841840
> 
> 赞同：12
> 
> 时间：2012-05-31T21:55:57.270
> 
> 标签：c, pipe, win32-process

我有一个简单的程序（在 C 中），它创建两个子进程，每个子进程等待一个继承的管道，并将输出放在一个文件中。

一切正常，除了在两个管道上的一些写/读循环之后，当孩子结束时，对 ReadFile 的调用阻塞，等待管道上的数据。我使用以下模式：

```
...
//create pipe1
CreatePipe(&hReadDup,&hWrite,&saAttr,0);
DuplicateHandle(GetCurrentProcess(),hReadDup,GetCurrentProcess(),&hRead,0,FALSE,DUPLICATE_SAME_ACCESS);
CloseHandle(hReadDup);

si.cb = sizeof(si);
si.dwFlags = STARTF_USESTDHANDLES;
si.hStdOutput = hWrite;   

CreateProcess(  NULL,
        const_cast<LPWSTR>(cmd2.c_str()), //the command to execute
        NULL,
        NULL,
        TRUE,
        0,
        NULL,
        NULL,
        &si, //si.
        &pi
    );

...
CloseHandle(hWrite); // EDIT: this was the operation not properly done!

while(cont){
    ...
    cont = ReadFile(hRead,buf,50, &actual,NULL);
    ...
}
... 
```

最后一次调用（子进程退出后）阻塞。为什么的想法（如果没有，如何调试）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-02T13:53:55.547

我自己找到了解决方案（实际上是一个编码错误）。我没有正确关闭管道的父级写句柄（`hWrite`），因此，同步 ReadFile 无法向我报告子进程终止。

如果有人遇到同样的问题，请确保在对该管道启动 I/O 操作之前关闭该管道的可继承句柄（正如 MSDN 报告的那样，无法再次找到）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-01T21:06:25.677

您正在`ReadFile()`以同步模式调用。只要管道打开，`ReadFile()`就会阻塞等待更多数据。如果您打开`CreateProcess()`返回给您的进程和线程句柄，这将阻止子进程完全退出，因此管道可能不会在子端关闭。在进入你的阅读循环之前，关闭`CreateProcess()`返回的句柄，让管道在子进程完全终止时正确关闭，然后`ReadFile()`当它不能再从管道中读取时可以向你报告错误。或者，切换到管道上的重叠 I/O，这样您就可以在循环运行时`WaitForSingleObject()`或`GetExitCodeProcess()`在循环运行时监视子进程，以便无论管道状态如何，您都可以检测子进程何时终止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-23T14:38:31.050

就您而言，一切都很好，您可以访问管道上的两个进程。但是，如果您没有，或者只是想中断`ReadFile`通话，那么`CancelSynchronousIo`您的朋友就是：[https ://msdn.microsoft.com/en-us/library/windows/desktop/aa363789(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa363789(v=vs.85).aspx)

# drupal - 从 Drupal 7 中的 Content Type 字段中检索列表

> ID：10841842
> 
> 赞同：2
> 
> 时间：2012-05-31T21:56:01.990
> 
> 标签：drupal, drupal-7

我对 Drupal 7 有点陌生。

我正在使用 Drupal Form API，我需要使用一个下拉菜单，通过`mymodule_forms`钩子显示状态列表。

```
$form['work_state'] = array(
  '#title' => t('Work State'),
  '#type' => 'select',
  ...
); 
```

我已经在内容类型字段中定义了一个状态列表。

如何加载内容类型（即：forms_stipend）并检索字段（即：field_states）。检索到之后，我可以开始将可用的状态列表填充到上面显示的代码中。

提前感谢您的帮助，因为他们*总是*很感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T23:14:28.233

假设您的字段是列表类型，您可以使用以下[`field_info_field()`](http://api.drupal.org/api/drupal/modules!field!field.info.inc/function/field_info_field/7)函数从字段中获取允许的值：

```
$info = field_info_field('field_states');
$options = $info['settings']['allowed_values'];

$form['work_state'] = array(
  '#title' => t('Work State'),
  '#type' => 'select',
  '#options' => $options
); 
```

# php - 使用 MySQL 数据填充 HTML 表（多个查询）

> ID：10841847
> 
> 赞同：1
> 
> 时间：2012-05-31T21:56:33.120
> 
> 标签：php, mysql, database, html-table

经过广泛的研究，我得出的结论是我的案例是独一无二的，我需要问一下。我的 PHP 知识非常有限，我正试图完全根据谷歌结果来完成这项工作。

目标：创建一个显示包含 5 列（端口、L1 状态、L2 状态、帧错误、活动调用）的 HTML 表的网页 这些列中的每一列的日期都存储在单个数据库表中，这就是诀窍，大多数这些数据来自同一个字段...这意味着我需要创建 5 个不同的查询。我试图创建一个查询（如果可以的话，我相信它会起作用），但我做不到。

到目前为止的结果：只有第 5 个查询结果的表和表的其余部分重复填充只有第一个查询。

这是我的代码：

```
<!-- Simple HTML to Create the table layout -->
<table border=1 style="background-color:#F0F8FF;" >
<caption><EM>HEADER</EM></caption>
<tr>
<th>Port</th>
<th>L1 Status</th>
<th>L2 Status</th>
<th>Framing Errors</th>
<th>Active calls</th>
</tr>
<!-- END Simple HTML to Create the table layout -->
<?php
$server = "localhost";
$dbname = "database";
$user = "user";
$password = "password";
$con = mysql_connect($server,$user,$password) or die (mysql_error());
mysql_select_db($dbname) or die (mysql_error());

$query1="select right(name, 10) as 'Port' from items where hostid = (select hostid from hosts where name = 'MIAGATE01') and key_ like '%activeChannels[%' and key_ not like '%SNMPINDEX%' order by name";
$query2="select lastvalue as 'Layer1' from items where hostid = (select hostid from hosts where name = 'MIAGATE01') and key_ like '%statusLayer1[%' and key_ not like '%SNMPINDEX%' order by name";
$query3="select lastvalue as 'Layer2' from items where hostid = (select hostid from hosts where name = 'MIAGATE01') and key_ like '%statusLayer1[%' and key_ not like '%SNMPINDEX%' order by name";
$query4="select lastvalue as 'Framing_Errors'from items where hostid = (select hostid from hosts where name = 'MIAGATE01') and key_ like '%frameErrors[%' and key_ not like '%SNMPINDEX%' order by name";
$query5="select lastvalue as 'Active_Calls' from items where hostid = (select hostid from hosts where name = 'MIAGATE01') and key_ like '%activeChannels[%' and key_ not like '%SNMPINDEX%' order by name";
$result1=mysql_query($query1) or die(mysql_error());
$result2=mysql_query($query2) or die(mysql_error());
$result3=mysql_query($query3) or die(mysql_error());
$result4=mysql_query($query4) or die(mysql_error());
$result5=mysql_query($query5) or die(mysql_error());

while($row1 = mysql_fetch_array($result1)){
while($row2 = mysql_fetch_array($result2)){
while($row3 = mysql_fetch_array($result3)){
while($row4 = mysql_fetch_array($result4)){
while($row5 = mysql_fetch_array($result5)){
echo "<tr>";
echo "<td>" . $row1['Port'] . "</td>";
echo "<td>" . $row2['Layer1'] . "</td>";
echo "<td>" . $row3['Layer2'] . "</td>";
echo "<td>" . $row4['Framing_Errors'] . "</td>";
echo "<td>" . $row5['Active_Calls'] . "</td>";
echo "</tr>";
}
}
}
}
}
mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:12:24.357

先试试这个查询，看看它是否一次得到了所有需要的结果。

```
SELECT h.hostid, 
  RIGHT(port.name,10) AS 'Port', 
  l1.lastvalue AS 'Layer1', 
  l2.lastvalue AS 'Layer2', 
  fe.lastvalue AS 'Framing_Errors', 
  ac.lastvalue AS 'Active_Calls' 
FROM hosts h 
INNER JOIN items port 
  ON port.hostid = h.hostid 
    AND port.key_ LIKE '%activeChannels[%' 
    AND port.key_ not LIKE '%SNMPINDEX%' 
INNER JOIN items l1 
  ON l1.hostid = h.hostid 
    AND l1.key_ LIKE '%statusLayer1[%' 
    AND l1.key_ not LIKE '%SNMPINDEX%'
INNER JOIN items l2 
  ON l2.hostid = h.hostid 
    AND l2.key_ LIKE '%statusLayer2[%' 
    AND l2.key_ not LIKE '%SNMPINDEX%'
INNER JOIN items fe 
  ON fe.hostid = h.hostid 
    AND fe.key_ LIKE '%frameErrors[%' 
    AND fe.key_ not LIKE '%SNMPINDEX%'
INNER JOIN items ac 
  ON ac.hostid = h.hostid 
    AND ac.key_ LIKE '%activeChannels[%' 
    AND ac.key_ not LIKE '%SNMPINDEX%'
WHERE h.name = 'MIAGATE01'
ORDER BY h.name; 
```

如果这可行，您只需要一个`while`循环来填充您的表格。

```
while ( $row = mysql_fetch_array($result)) {
  echo "<tr>";
  echo "<td>" . $row['Port'] . "</td>";
  echo "<td>" . $row['Layer1'] . "</td>";
  echo "<td>" . $row['Layer2'] . "</td>";
  echo "<td>" . $row['Framing_Errors'] . "</td>";
  echo "<td>" . $row['Active_Calls'] . "</td>";
  echo "</tr>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:20:38.523

首先：

您预期的 HTML 表格的每一行是否都包含所有五个数据项？换一种方式问，每个端口是否有一行？从你的问题中看不出来。从您的逻辑来看，不同参数的出现次数当然可能不同。

无论如何...您需要将一堆包含 hostid,parameter 的虚拟表连接在一起，以组合您的显示。像这样，我想。（您的数据非常复杂）。

```
select hostid.hostid, port.Port, layer1.Layer1, layer2.Layer2
  from
            (select hostid, name
             from hosts
            where name = 'MIAGATE01'
            ) hostid
  left join
            (select hostid, right(name,10) as 'Port'
               from items
              where key_ like '%activeChannels[%' and key_ not like '%SNMPINDEX%'  
            ) port 
        on hostid.hostid = port.hostid
  left join
           (select hostid, lastvalue as 'Layer1'
              from items
             where key_ like '%statusLayer1[%' and key_ not like '%SNMPINDEX%'  
           ) layer1 
        on hostid.hostid = layer1.hostid
  left join
           (select hostid, lastvalue as 'Layer2'
              from items
             where key_ like '%statusLayer2[%' and key_ not like '%SNMPINDEX%'  
           ) layer2 
        on hostid.hostid = layer2.hostid
order by hostid.name, port.Port 
```

看看情况如何？您有很多小选择会生成 hostid 列表，其中值项与您的 key_ 选择标准匹配。然后，您将它们的 hostid 值结合在一起。第一个小选择只是为您想要的特定主机提供了正确的 hostid。

我没有做你所有的参数，但你应该不难完成这个查询。至于调试它....如果没有看到您的`items`表的所有荣耀，就很难知道。这可能是一个大毛球。但你已经知道了。

网络设备日志不就是一个充满乐趣的大桶吗？

# ios - 在 iOS 上，我们如何获取 GPU 上缓存的图形上下文？

> ID：10841850
> 
> 赞同：1
> 
> 时间：2012-05-31T21:56:59.293
> 
> 标签：ios, ipad, calayer, cglayer, graphicscontext

也许第一个问题是：在 GPU 上缓存图形上下文是否有用或可能：在 iPad 1、2 和新 iPad 上，[PowerVR](http://en.wikipedia.org/wiki/Powervr)用作 GPU，它是否将 RAM 用作图形内存？如果是这样，如果我们将图形上下文缓存在 GPU 上，它会有所帮助吗？

如果事实上可以，那么我们如何获得这样的图形上下文？有提到`CGLayer`and `CALayer`:`CGLayer`可以缓存在 GPU 上，并且`CALayer`经常缓存在 GPU 上，但是`CGLayer`是从另一个上下文中获取的，使用`CGLayerCreateWithContext`，并且该上下文应该是一个窗口图形上下文，它只提到了[如何获取一个窗口Mac OS X 上的图形上下文](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-CJBDCHAC)，而不是 iOS。提到如何获取“View Graphics Context”的部分实际上与在CALayer中获取的上下文相同：CALayer开始`display`使用`drawInContext`Bitmap Graphics Context，看起来，最后`drawRect`调用`UIView`使用这个位图上下文，我不确定 CALayer 缓存在 GPU 上的想法实际上是指这个位图图形上下文还是它`layer.contents`是一个 CGImage，所以缓存实际上是在这个图像上，而不是图形上下文。

# python - POST 处理程序返回的页面被忽略 - 得到空白响应 (web.py)

> ID：10841854
> 
> 赞同：1
> 
> 时间：2012-05-31T21:57:12.637
> 
> 标签：python, web.py, uwsgi

这是将 web.py 与 uwsgi 一起使用。

当我从 POST 处理程序返回页面数据时，浏览器会收到一个空白页面。GET 处理程序对我来说工作正常。处理程序被正确调用，并且重定向（web.seeother）将起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:25:48.277

要回答我自己的问题，您需要调用`web.input()`否则返回的数据将被忽略（谁知道为什么？这是一个错误吗？）

# r - 将数据集拆分为具有 r 中随机列的多个数据集

> ID：10841859
> 
> 赞同：2
> 
> 时间：2012-05-31T21:57:22.840
> 
> 标签：r, dataset, split, sample

我有一个大数据集。我想分成“n”个子数据集，每个子​​数据集大小相等“s”。但是，如果最后一个数据集不能被数字整除，则它可能小于其他大小。并将它们作为 csv 文件输出到工作目录。

让我们说以下小例子：

```
set.seed(1234)
mydf <- data.frame (matrix(sample(1:10, 130, replace = TRUE), ncol = 13))
mydf

   X1 X2 X3 X4 X5 X6 X7 X8 X9 X10 X11 X12 X13
1   3  7  1  9  6  4  7  5  8   2   2   2   8
2   5  3  4  6  9  5  3 10  5   8  10   2  10
3   4  6 10  4  4  6  3  4  2   9   9   2   9
4  10 10  9  4  3  7  7  7 10   6   7  10   2
5  10  3  9  3  2 10  9  6  4   4   4   6   3
6   7  2  8  7  5  5 10 10  9   3   7   8   4
7   3  2  2  7 10  9  2  2 10   1   1  10   4
8   3  9  9  7  3  1  7  6 10   3  10   3   2
9   9  3  6  9  3  2  2  3  4   2   9  10  10
10  6  4  3  3  5  9  3  9 10   7   4   6  10 
```

我想创建一个函数，将数据集随机分成 n 个子集（在这种情况下说大小为 3，因为有 13 列 - 最后一个数据集将有 1 列，其余 4 列各有 3）并作为单独的文本文件输出数据集。

这是我所做的：

```
set.seed(123)
reshuffled <- sample(1:length(mydf),length(mydf), replace = FALSE)
# just crazy manual divide 
group1 <- reshuffled[1:3]; group2 <- reshuffled[4:6]; group3 <- reshuffled[7:9]
group4 <- reshuffled[10:12]; group5 <-  reshuffled[13]

# just manual 
data1 <- mydf[,group1]; data2 <- mydf[,group2]; ....so on;
# I want to write dimension of dataset at fist row of each dataset 
cat (dim(data1))
write.csv(data1, "data1.csv");  write.csv(data2, "data2.csv"); .....so on 
```

是否可以循环该过程，因为我必须生成 100 个子数据集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:20:01.180

也许有一个更清洁和更简单的解决方案，但您可以尝试以下方法：

```
mydf <- data.frame (matrix(sample(1:10, 130, replace = TRUE), ncol = 13))

## Number of columns for each sub-dataset
size <- 3

nb.cols <- ncol(mydf)
nb.groups <- nb.cols %/% size
reshuffled <- sample.int(nb.cols, replace=FALSE)
groups <- c(rep(1:nb.groups, each=size), rep(nb.groups+1, nb.cols %% size))
dfs <- lapply(split(reshuffled, groups), function(v) mydf[,v,drop=FALSE])

for (i in 1:length(dfs)) write.csv(dfs[[i]], file=paste("data",i,".csv",sep="")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T23:12:54.947

只是为了好玩，可能比juba慢

```
mydf <- data.frame (matrix(sample(1:10, 130, replace = TRUE), ncol = 13))
size <- 3
by(t(mydf), 
   INDICES=sample(as.numeric(gl((ncol(mydf) %/% size) + 1, size, ncol(mydf))), 
                  ncol(mydf), 
                  replace=FALSE), 
   FUN=function(x) write.csv(t(x), paste(rownames(x), collapse='-'), row.names=F)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-27T12:52:57.927

为了将“mydf”划分为 n 个几乎相等的部分，我从这个问题和相应的答案中获得了灵感： [链接](http://math.stackexchange.com/questions/1081079/how-to-divide-natural-number-n-into-m-nearly-equal-summands)。

它创建最小和最大分区之间的差异尽可能小的分区大小。在本例中，此差值等于 1。示例：

分区方法 1 - 使用“地板”功能（此处未显示可重现的代码）。将 100 行分成 7 个几乎相等的部分/总和，随后在前 6 次迭代中采样 floor(100/7) = 14 个索引。第 7 个元素是余数。这产生：

14、14、14、14、14、14、16。总和 = 100，最大差值 = 2

分区方法 2 - 使用“天花板”功能（此处未显示可重现的代码）。使用“天花板”功能而不是“地板”功能会产生类似的结果：

15、15、15、15、15、15、10。总和 = 100，最大差值 = 5

分区方法 3 - 使用上面参考中的公式。使用以下过程时，分区大小的向量 ('sequence_diff') 为：

14、14、14、15、14、14、15。总和 = 100，最大差值 = 1

R代码：

```
set.seed(1234)
#I increased the number of rows in the data frame to 100
mydf <- data.frame (matrix(sample(x = 1:100, size = 1300, replace = TRUE), 
                    ncol = 13))

index_list      <- list()       #Will store the indices for all partitions
indices         <- 1:nrow(mydf) #Initially contains all indices for the dataset 'mydf'
numb_partitions <- 7            #Specifies the number of partitions

sequence <- floor(((nrow(mydf)*1:numb_partitions)/numb_partitions))
sequence <- c(0, sequence)

#'sequence_diff' will contain the number of instances for each partition.
sequence_diff <- vector()
for(j in 1:numb_partitions){
    sequence_diff[j] <- sequence[j+1] - sequence[j]   
}  

#Inspect 'sequence_diff' and verify it's elements sum up to the total 
#number of rows in 'mydf' (100).
> sequence_diff
[1] 14 14 14 15 14 14 15
> sum(sequence_diff)
[1] 100 #Correct!

for(i in 1:numb_partitions){

  #Use a different seed for each sampling iteration.
  set.seed(seed = i)

  #Sample from object 'indices' of size 1/'numb_partitions'
  indices_partition <- sample(x = indices, 
                              size = sequence_diff[i], 
                              replace = FALSE)

  #Remove the selected indices from 'indices' so these indices will not be 
  #selected in successive iterations.
  indices           <- setdiff(x = indices, y = indices_partition)

  #Store the indices for the i-th iteration in the list 'index_list'. This 
  #is just to verify later that 
  #the procedure has divided all indices in 'numb_partitions' disjunct sets.
  index_list[[i]]   <- indices_partition

  #Dynamically create a new object that is named 'mydfx' in which x is the 
  #i-th partition. 
  assign(x = paste0("mydf", i), value = mydf[indices_partition,])

  write.csv(x = get(x = paste0("mydf", i)),  #Dynamically get the object from environment.
            file = paste0("mydf", i,".csv"), #Dynamically assgin a name to the csv-file.
            sep = ",", 
            col.names = T, 
            row.names = FALSE    
}

#Check whether all index subsets are mutually exclusive: union should have 100 
#unique elements. 
length(unique(unlist(index_list)))
[1] 100 #Correct! 
```

# javascript - 将字符串前面的 n 个字符移动到末尾

> ID：10841868
> 
> 赞同：13
> 
> 时间：2012-05-31T21:58:04.650
> 
> 标签：javascript, jquery, string

这似乎是一个简单的问题，但我找不到解决方案。我想先从字符串中提取 2 个字母，然后将它们移到该字符串的末尾。例如，OK12 将变为 12OK。

编辑：到目前为止，我已经尝试切断字符串，然后将其添加到字符串的其余部分，但我认为有一个单行解决方案，比如预定义的函数或其他东西。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-31T22:01:27.383

```
"OK12".substr(2) + "OK12".substr(0,2) 
```

**通用解决方案：**

```
var result = str.substr(num) + str.substr(0, num); 
```

[**现场演示**](http://jsfiddle.net/VsYv5/1)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-31T22:00:47.733

各种技巧：

```
str.slice(2) + str.slice(0,2);

str = str.replace(/^(.{2})(.+)/, '$2$1');

for (var a=str.split(""),i=2;i--;) a.push(a.shift());
str = a.join(''); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T22:00:55.320

```
text.slice(2) + text.slice(0, 2); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T22:01:09.767

```
var a='ok12';
a=a.substr(2,a.length-2)+a.substr(0,2); 
```

# c++ - 调试信息影响分析结果 C++

> ID：10841874
> 
> 赞同：0
> 
> 时间：2012-05-31T21:58:27.607
> 
> 标签：c++, visual-studio, compiler-construction, profiling

我正在使用 IBM Quantify 来尝试比较程序中不同函数调用的运行时间，但令人头疼的是许多函数调用都有 DEBUG 宏输出这样的东西，

```
#ifdef DEBUG
cout << "Value is "<< value << endl;
#endif 
```

当我进行分析时，我发现这些 IO 操作花费了大部分时间，当然我关心的是发布版本的实际运行时间。我可以做些什么来获得发布版本的更准确结果，而不是手动删除这些 DEBUG 宏？

我在调试模式下使用 Visual Studio 编译器构建代码，当我使用 -o 选项构建它时，它无法运行以进行分析，说没有可用的调试信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T22:07:28.197

您肯定希望使用发布版本进行分析。您可以修改项目设置，以便为发布构建发出 PDB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T00:21:53.107

我将问题分为两部分，时间的整体测量，然后得到百分比。整体测量很简单——给它足够的工作至少需要几秒钟，然后就可以计时了。如有必要，只需循环 10 或 1000 次。

然后为了获得百分比，在它运行时，捕获一些堆栈快照。您可以使用堆栈抓取器，或者只是使用暂停按钮（重复）点击它并复制粘贴调用堆栈。函数处于活动状态的时间百分比是它在堆栈上的时间百分比，大致是包含它的堆栈跟踪的百分比。这并没有告诉您仅占一小部分的功能，但是更改这些功能不会为您节省太多。

# android - 无法使用 Eclipse 模拟器将文件推送到 SD 卡

> ID：10841876
> 
> 赞同：3
> 
> 时间：2012-05-31T21:58:32.667
> 
> 标签：android

我正在尝试将 3GP 文件推送到 Eclipse 模拟器。我打开模拟器并在 Eclipse 中转到 DDMS 透视图。在文件资源管理器中，我打开 /mnt 并突出显示 sdcard。我单击“将文件推送到设备上”按钮并选择我的 3GP 文件。什么都没发生。我没有收到错误消息，但我也没有在 sdcard 下看到我的文件。任何想法为什么会发生这种情况？sdcard上的权限是d---rwxr-x。

3GP文件也在我的原始文件夹下的项目中是否重要？只是在黑暗中拍摄...

任何想法/建议都是最受欢迎的。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:17:05.503

你试过这个吗？

去`platform-tools`目录

跑`cmd`

```
adb push yourfile.3gp \sdcard\target_folder 
```

# vbulletin - 我的 vBulletin 用户如何知道他们有付费订阅

> ID：10841884
> 
> 赞同：0
> 
> 时间：2012-05-31T21:59:02.013
> 
> 标签：vbulletin

好的，所以在尝试了 vBulletin 的付费订阅后，我对一件事感到困惑。用户如何知道他们已经购买了订阅？我收到了确认邮件、成功页面等。但是在所有这些都完成之后，我在用户 CP 中没有看到任何不同。更糟糕的是，我仍然可以再次购买相同的订阅。这是预期的行为还是我的安装中的错误？

仅供参考，当我在管理控制面板中查看用户时，我看到用户实际上已经支付了订阅费用。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T02:30:31.873

这将通过为付费用户（捐赠者或高级会员）创建一个新的用户组来解决。然后，当您设置付费订阅时，您可以告诉它为刚刚购买订阅的用户更改成员组。这样你就可以说，会员可以说，你论坛上的其他人也可以说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T02:29:43.027

当此人进入新用户组时，您可以分配自定义标题和图像。这样他们在论坛上的帖子就会看起来不一样。

您还可以根据该新用户组授予对 CMS 和论坛中不同内容的访问权限。

# algorithm - 队列减少算法？

> ID：10841895
> 
> 赞同：5
> 
> 时间：2012-05-31T21:59:59.100
> 
> 标签：algorithm, optimization, queue

我有一个在客户端之间共享的活动队列，捕获用户活动并由另一个站点上的机器人执行。活动的一个例子可能是：

```
CREATE FOLDER  /docs
CREATE FILE    /docs/journal.txt
DELETE FILE    /docs/blog.txt
MOVE   FOLDER  /docs/images /docs/photos
... 
```

通常有一些活动可以简化为一个，或者没有。例如：

```
CREATE FOLDER /docs
RENAME FOLDER /docs /documents 
```

可以简单地改为：

```
CREATE FOLDER /documents 
```

和类似的东西：

```
CREATE FOLDER /docs
RENAME FOLDER /documents
DELETE FOLDER /documents 
```

可以完全从队列中移除。

这种减少/优化似乎是一个非常普遍的问题，在攻击它之前，我想尝试一些通用的解决方案。它看起来像一个寻路优化问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T22:04:45.020

我不知道有任何库或框架可以为您做到这一点。另一方面，您必须自己指定其背后的逻辑，而在我看来，这将是大部分工作。

这是我将采取的方法：

1.  对操作进行拓扑排序（重命名文件夹“取决于”创建文件夹等等......）

2.  每个没有依赖关系的命令都代表依赖关系树中的一个“根”。

3.  从每个根开始递归地折叠这些树。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:24:18.507

一种选择（尽管有点重量级）是遍历队列记录并在您在程序中创建的树表示上模拟在文件系统上执行的操作。对于引用的每个目录，您可以跟踪最终在其上执行的网络操作。完成后，您可以遍历修改后的树结构并输出一系列命令，这些命令表示应用于每个目录和子目录的网络转换。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T22:44:56.857

1.  定义所有操作（创建、重命名、移动）

2.  定义一个包含您的操作 + 操作参数的 Command 类。

3.  实现一些东西，它会告诉你两个命令是否可以组合，以及组合的结果是什么。

我必须假设您只能组合紧随其后的命令，否则您可能会引入不需要的副作用。因此，当您从 yoru 队列中执行命令时，请开始查看/弹出/构建命令，直到遇到无法组合到其中的命令。

# javascript - ipad 上的 Javascript 加载缓慢

> ID：10841898
> 
> 赞同：5
> 
> 时间：2012-05-31T22:00:18.267
> 
> 标签：javascript, ipad, html, latency

我有一个在 iPpad2 上运行的基本 html 站点（html5、JavaScript、jQuery）。我使用谷歌浏览器进行基本测试，只是为了测试布局图像和复制等。然而，我真正的测试需要在实际的 iPad 上进行。

在 iPad 上，与立即加载的 Chrome 相比，我的代码似乎有 2-4 秒的延迟。我一直找不到瓶颈。我在代码的各个点添加了警报，但是所有警报都立即出现，一个接一个，并且似乎延迟发生在最后一行代码的最后一个警报之后。

警报可能会产生误导，因为代码可能在执行之前被缓存？为了加快 iPad 上的速度，我应该在代码中寻找或避免什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T22:06:31.000

如果您不缓存选择器结果 - 移动设备容易受到性能不佳的影响

我的意思是，如果你这样做：

```
$("#someId").css(some, stuff);
$("#someId").css(other, stuffs);
$("#someId").attr(even, more); 
```

相比

```
var ourElement = $("#someId");
ourElement.css(some, stuff);
ourElement.css(other, stuffs);
ourElement.attr(even, more); 
```

现在，如果您在“现实世界”中进行先前的操作-循环等-它可能会对移动设备造成巨大的性能损害

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:05:19.403

iPad 比运行 Google Chrome 的台式机要慢得多。预计做事需要更长的时间。

如果是 10-20 秒，我会说检查您的代码，但 2-4 秒对于页面加载来说并非不合理。

# iphone - 对多个 NSURLConnection 响应进行故障排除

> ID：10841903
> 
> 赞同：1
> 
> 时间：2012-05-31T22:00:43.677
> 
> 标签：iphone, nsurlconnection, nsoperation, nsoperationqueue, ios5.1

我有一个应用程序向数据服务器发出多个 URL 请求以下载用户数据。我试图通过并行发出 10 个请求来加快下载时间。我尝试了几种不同的方法来做到这一点，但我一直得到的结果是，虽然我（几乎）同时发送了 10 个请求，但我一次只收到一个返回的数据。这意味着总下载时间与我连续发出所有请求一样。这是我尝试过的不同方法。

1.  创建了一个 NSOperation 的子类，它具有一个 NSURLConnection 对象并充当该 NSURLConnection 的委托。将此 NSOperation 子类的 10 个实例添加到 NSOperationQueue。
2.  创建了 10 个 NSURLConnection 对象并一个接一个地启动它们。（使用单独的委托对象，以便我可以保持响应直截了当。）

这两种情况都可以正确下载数据，但它们都不会像我预期的那样快速接收数据。服务器响应请求所需的时间约为 0.5 - 1.0 秒。因此，如果请求真正并行发出，我希望最多在 1 秒内收到所有 10 个响应。在这两种方法中，我观察到 NSURLConnections 都在大约 5 毫秒内启动，但是请求的 connect:didReceiveResponse 方法以大约 0.7 秒的间隔一个接一个地被调用，就好像请求是连续发出的一样.

我是否误解了 NSURLConnections 或 NSOperationQueues 的工作方式？任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T18:59:55.183

如果您使用多个 NSURLConnection 向同一服务器发出请求，那么您实现的两种方式几乎没有任何区别。但是，如果您要与 10 个不同的服务器建立 10 个连接，其中一个或两个可能非常慢并且需要时间来响应请求，那么第二种方法将比第一种方法花费更多时间。在第二种方法中，仅在您从当前请求获得响应后才会发送下一个请求，但在第一种方法中，因为请求正在并行运行，因此请求将在获得响应后立即完成，下一个请求将排队。在这种情况下，如果 maximumConcurrentOperation = 1，两种方法都会给出相同的结果。

```
 Approach 2:
<--t1--><--t2--><--t3--><------t4------><--t5--><--------t6--------><--t7--><--t8-->
<----------------------------------Total Time-------------------------------------->

Approach 1: maximumConcurrentOperation = 2

<--t1-->
<--t2-->
        <--t3-->
        <------t4------>
                <--t5-->
                        <--------t6-------->
                        <--t7-->
                                <--t8-->
<--------------Total Time------------------> 
```

希望这能消除您的疑问。

# c# - 保存加密配置部分时防止 IIS 应用程序重新启动？

> ID：10841905
> 
> 赞同：3
> 
> 时间：2012-05-31T22:00:49.697
> 
> 标签：c#, asp.net, iis, encryption, configuration-files

我正在帮助构建一个带有多个自定义配置文件的 ASP.NET C# 应用程序。我们`web.config`使用`<configSections><section /></configSections>`元素将这些存储在文件之外，确保设置为`restartOnExternalChanges="false"`文件保存不会重新启动应用程序。

为了管理这些设置，我们构建了 ASPX 页面来读取、更新和保存各个部分和值。对于纯文本部分，这非常有效。管理员登录应用程序的配置部分，进行更改，保存并立即生效。

但是我们有一个部分，在它自己的外部文件中，就像所有其他部分一样，也是加密的。每当保存该部分时，IIS 应用程序都会重新启动而丢失会话。这意味着登录的管理员进行配置更改，并且所有最终用户登录到应用程序的用户端，都必须再次登录，这令人沮丧。

保存加密的配置部分时，有什么方法可以避免 IIS 应用程序重新启动？

我们当前的加密配置部分处理代码如下所示：

```
public class CredentialsConfig : ConfigurationSection
{
    Configuration Config = null;
    CredentialsConfig Section = null;

    public static CredentialsConfig GetConfig()
    {
        Configuration config = WebConfigurationManager.OpenWebConfiguration("~");
        CredentialsConfig section = config.GetSection("credentials") as CredentialsConfig;

        // Ensure the current file is encrypted
        if (!section.SectionInformation.IsProtected)
        {
            section.SectionInformation.ProtectSection("DataProtectionConfigurationProvider");
            section.SectionInformation.ForceSave = true;
            config.Save();
        }

        return section;
    }

    public CredentialsConfig GetConfigForUpdate()
    {
        Config = WebConfigurationManager.OpenWebConfiguration("~");
        Section = Config.GetSection("credentials") as CredentialsConfig;
        return Section;
    }

    public void SaveConfig()
    {
        Section.SectionInformation.ProtectSection("DataProtectionConfigurationProvider");
        Section.SectionInformation.ForceSave = true;
        Config.Save(ConfigurationSaveMode.Modified);
        ConfigurationManager.RefreshSection("credentials");
    }

    [ConfigurationProperty("administrator")]
    public AdministratorConfigurationElement Administrator
    {
        get
        {
            return this["administrator"] as AdministratorConfigurationElement;
        }
    }
} 
```

我们像这样使用它：

```
CredentialsConfig credentialsConfig = new CredentialsConfig();
AdministratorConfigurationElement newConfig = credentialsConfig.GetConfigForUpdate().Administrator;
// setting attributes in the section's <administrator /> element
credentialsConfig.SaveConfig();
// frustrating app restart happens 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T22:04:53.560

不会。对 .config 文件的修改是始终会重新启动应用程序的自动触发器之一。

就个人而言，我建议将经常修改的项目从 .config 文件中移到数据库、注册表或其他可以加密和保护的地方，而这不是问题。

# mysql - 修改表列外键？

> ID：10841910
> 
> 赞同：0
> 
> 时间：2012-05-31T22:01:50.963
> 
> 标签：mysql, sql, foreign-keys

以[https://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html#.T8foMxTft0x](https://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html#.T8foMxTft0x)为例：

```
CREATE TABLE product (category INT NOT NULL, id INT NOT NULL,
                      price DECIMAL,
                      PRIMARY KEY(category, id)) ENGINE=INNODB;
CREATE TABLE customer (id INT NOT NULL,
                       PRIMARY KEY (id)) ENGINE=INNODB;
CREATE TABLE product_order (no INT NOT NULL AUTO_INCREMENT,
                            product_category INT NOT NULL,
                            product_id INT NOT NULL,
                            customer_id INT NOT NULL,
                            PRIMARY KEY(no),
                            INDEX (product_category, product_id),
                            FOREIGN KEY (product_category, product_id)
                              REFERENCES product(category, id)
                              ON UPDATE CASCADE ON DELETE RESTRICT,
                            INDEX (customer_id),
                            FOREIGN KEY (customer_id)
                              REFERENCES customer(id)) ENGINE=INNODB; 
```

I have a similar problem, but I noticed you can't change Foreign key (customer ID in this example) to unsigned, set default, or length, etc. I can't change either table with alter table, apparently because they're dependent and have to be the same type. Is there any other way this may be done?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:13:00.693

您可以删除外键，更改列，然后再次添加外键。

# unix - 为什么我的脚本需要永远运行？

> ID：10841913
> 
> 赞同：0
> 
> 时间：2012-05-31T22:02:10.243
> 
> 标签：unix, grep

```
#! /bin/sh

if [ $# -ne 2 ]
then
    echo "Invalid argument count."
    echo "Usage: $0 <dir1> <dir2>"
    exit
fi

ls $1 >> dir1

for file in $2/*
do
        grep $file $dir1
done

rm $dir1 
```

我编写上面的脚本的目的是打印两个目录中的所有文件，这些文件的名称作为参数传递给脚本。

但是当我运行脚本时，它花了很长时间。（实际上从未完成！）

有谁碰巧知道我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:18:39.610

$dir1 未定义，因此 grep 只有一个参数，并在标准输入中搜索 $file。所以 grep 正在等待输入，它将永远等待。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:08:59.853

我必须设置一个测试来确定，但你从来没有为 设置一个值`$dir1`，你只重定向 `ls`到一个名为`dir1`.

那么怎么样

```
#! /bin/sh

if [ $# -ne 2 ]
then
    echo "Invalid argument count."
    echo "Usage: $0 <dir1> <dir2>"
    exit
fi

ls $1 >> dir1

for file in $2/*
do
        grep $file dir1
done

rm dir1 
```

当我得到一个没有明显预期输出的脚本时。我将其杀死，然后将 shell 调试功能添加到脚本中。

要么在顶部，比如

```
#!/bin/sh -vx 
```

或者在脚本中我怀疑有问题的任何任意位置或在第二行，即

```
set -vx 
```

或者，如果我很确定问题出在哪里，并且上面会产生很多需要滚动的东西，那么我会隔离可疑行，打开和关闭调试，即

```
set -vx
suspect_code
set +vx 
```

最后，我认为您的问题可以简化为

```
ls $1 >> dir1
ls $2/* | fgrep -f dir1 
```

如果您的文件/目录嵌入了空格、CR 或其他令人讨厌的东西，这将受到限制。如果你有漂亮干净的文件名，它应该可以工作。

我希望这有帮助。

# c++ - 将 boost lambda 与复合表达式一起使用

> ID：10841916
> 
> 赞同：0
> 
> 时间：2012-05-31T22:02:28.093
> 
> 标签：c++, boost, boost-lambda

我有一个 Visual Studio 2008 C++03 应用程序，我想在其中使用 boost::lambda 来执行此操作：

```
enum { fooflag = 0x00000001; }

bool IsFooFlagActive( DWORD flags )
{
    return ( flags & fooflag ) != 0;
} 
```

不幸的是，这不起作用：

```
namespace bl = boost::lambda;
bool is_foo_flag_active = ( ( bl::_1 & fooflag ) != 0 )( 0x00000001 ); 
```

什么是让 boost::lambda 执行复合表达式的正确方法？我需要绑定 != 运算符吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T22:15:45.843

我不知道根本问题是什么，但是添加演员表可以使它起作用：

```
namespace bl = boost::lambda;
bool is_foo_flag_active =
    ((bl::_1 & static_cast<DWORD>(fooflag)) != 0)(0x00000001); 
```

话虽如此，请停止在新代码中使用 Boost.Lambda——它已被正式弃用（除了文档之外的所有文件），近一年来有利于[Boost.Phoenix ，而且有充分的理由。](http://www.boost.org/libs/phoenix/)（当使用 Phoenix 而不是 Lambda 时，您的代码可以按原样干净地编译。）

# json - Web 服务不返回 json 数据

> ID：10841921
> 
> 赞同：0
> 
> 时间：2012-05-31T22:03:44.980
> 
> 标签：json, web-services

我正在尝试在启动 Metro UI 应用程序之前返回 json 数据以使用它。我的网络服务不返回 json 数据，但它总是返回 xml 数据。有人可以帮助我吗？

```
[WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)] 
    public string HelloWorld() {
        return "Hello World";
    } 
```

网页

```
<html xmlns="http://www.w3.org/1999/xhtml" > 
<head> 
    <title>Untitled Page</title> 
    <script language="javascript" type="text/javascript">

        var req = new XMLHttpRequest();
        xmlhttp.setRequestHeader("Content-Type", "application/json"); 

        function Roll() {
            if (req.readyState == 4) {
                alert(req.responseText);
                alert("exiting");
            }
        }

        function Test() {
            alert("starting");
            req.open("POST", "http://localhost:58718/testService/Service.asmx/HelloWorld", true);
            req.onreadystatechange = Roll;
            req.send(null);
        } 

    </script> 
</head> 
<body> 

    <button onclick="javascript:Test()">TEST</button> 
</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:12:59.330

将此添加到您的 Web 配置文件中。

```
<httpHandlers>
<remove verb="*" path="*.asmx"/>
<add verb="*" path="*.asmx" type="System.Web.Script.Services.ScriptHandlerFactory" validate="false"/>
</httpHandlers> 
```

信仰斯隆

# c - 两个功能起作用，但当我把它们放在一起时不起作用

> ID：10841923
> 
> 赞同：1
> 
> 时间：2012-05-31T22:04:01.987
> 
> 标签：c

我对 C 真的很陌生（我一直在学习 Cuda 并想学习 C，所以我可以一起运行所有东西，而不是在 Java/Python 中生成数据并将其手动复制/粘贴到我的 Cuda 程序中来玩）。我正在尝试打开一个大文件（20+gb）并解析一些数据，但因为我遇到问题，我决定先尝试解决我的问题，以验证我可以逐行打开和读取一个文件，然后在另一个文件中取一行输出的样本并尝试解析它，然后如果一切顺利，我可以简单地将它们放在一起。我设法（经过一番挣扎）让每个部分都能正常工作，但是当我将它们组合在一起时它不起作用（我在 eclipse 和 QT creator 中都试过了。QT creator 说它意外退出并且 eclipse 只是停止了......）。

这是解析部分（它完全按照我的意愿工作）：

```
#include <string.h>
#include <stdio.h>

int main()
{
    char line[1024] = "[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 4],";
    size_t len = strlen(line);
    memmove(line, line+1, len-3);
    line[len-3] = 0;
    printf("%s \n",line);

    char str[100], *s = str, *t = NULL;

    strcpy(str, line);
    while ((t = strtok(s, " ,")) != NULL) {
        s = NULL;
        printf(":%s:\n", t);
    }
    return 0;
} 
```

如果我打印文件的每一行，变量行中的数据与我得到的数据完全相同。但是当我将它复制/粘贴到我的主程序中时，它就不起作用了（QT 什么都不显示，而 Eclipse 只显示第一行）。这段代码只是围绕上述命令的一些文件 IO 命令（while 循环中的所有内容都与上述完全相同）

```
#include <stdio.h>
#include <stdlib.h>

int main() {

    char line[1024];
    FILE *fp = fopen("/Users/me/Desktop/output.txt","r");

    printf("Starting.. \n");

    int count = 0;
    int list[30]; //items will be stored here

    while(fgets(line, 1024, fp) != NULL){
        count++;
        //char line[1024] = "[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 4],";
        size_t len = strlen(line);
        memmove(line, line+1, len-4);
        line[len-4] = 0;
        printf("%s \n",line);

        char *s = str, *t = NULL;

        strcpy(str, line);
        while ((t = strtok(s, " ,")) != NULL) {
            s = NULL;
            printf(":%s:\n", t);
        }
    }
    printf(" num of lines is %i \n", count);
    return 0;
} 
```

日食输出：

```
Starting.. 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 4 
```

我无法弄清楚我做错了什么。如果有帮助，我正在使用带有 gcc 4.2 的 mac。我唯一能想到的可能是我在解析列表变量的方式上做错了，因此以后无法访问它（我不确定这是一个疯狂的猜测）。有什么我想念的吗？

编辑：如果我注释掉这段代码，它会通过文件（但不解析）：

```
while ((t = strtok(s, " ,")) != NULL) {
    s = NULL;
    printf(":%s:\n", t);
} 
```

该文件的内容基本上是：

```
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 4],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 4],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 2, 2, 2, 2, 4], 
```

依此类推（其中 20+gb）。

EDIT2：我只是想测试它是否与我的mac一起使用，我在centos 5上尝试了它（安装它只是为了测试），从命令行运行时我得到了同样的错误，除了它最后说的`Segmentation fault`。我所做的只是将上面的示例输出复制到一个文件中，然后更改上面代码中的路径并运行它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T22:10:09.410

这里有两个声明`line`- 一个紧随其后`main()`，一个紧随其后`while`。 `fgets`读入第一个`line`变量。在 while 块中，第二个`line`声明掩盖了第一个（因为第二个更本地化）。外部`line`变量——`fgets`读入的变量——在程序的其他任何地方都不能访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T22:37:55.417

我知道了！尝试插入`#include <string.h>`其他包含。我不知道你为什么在`<string.h>`不包含它的情况下使用它，但它导致了不正确的链接。编译器发出以下警告：

```
test2.c:17: warning: incompatible implicit declaration of built-in function ‘strlen’
test2.c:18: warning: incompatible implicit declaration of built-in function ‘memmove’
test2.c:24: warning: incompatible implicit declaration of built-in function ‘strcpy’
test2.c:25: warning: assignment makes pointer from integer without a cast 
```

前三个警告表明您没有包含头文件。最后一个只是表明，如果没有声明，则假定函数接受和返回整数（这是为了向后兼容古老的 C 代码）。

不要忘记`fgets`在行尾包含换行符。您需要通过更改`len-3`为来解决此问题`len-4`。

另外，完成后不要忘记`fclose`文件。

此外，您的 memmove 是不必要的，因为您只需指向第二个字符：

```
char *moved_line = line + 1; 
```

# python - 以复杂的方式拆分字符串？

> ID：10841925
> 
> 赞同：0
> 
> 时间：2012-05-31T22:04:10.123
> 
> 标签：python, string, split

我正在制作一种基本语言。嗯，不完全是，但你会看到的。现在，我执行了 echo 和 exit 命令，但我需要帮助。

如果我给它一个字符串'echo "hello bob"'，我希望它把它分开，然后给我一个像这样的数组 [echo, Hello Bob]。现在，我有回声工作，但只有一个字。所以我可以做-->'echo bob'，它会输出'bob'。但是，如果我执行“echo hi bob”，它将输出“hi”。我一直希望它这样做。如果我有一个命令 foo，我想做 'foo "bar face" boo' 并得到 [foo, bar face, boo]。所以基本上我想做 myArr.split(' ') 除了引号之间的任何内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T22:12:58.500

这是一个简单的答案：

```
>>> import shlex
>>> shlex.split('echo "hello bob"')
['echo', 'hello bob'] 
```

`shlex`是一个帮助解析类 shell 语言的模块。

可以在此处找到文档（谢谢，JIStone）：[http ://docs.python.org/library/shlex.html](http://docs.python.org/library/shlex.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:07:14.297

这是一个简单的标记器

```
import re

def s_ident(scanner, token): return token
def s_operator(scanner, token): return "op%s" % token
def s_float(scanner, token): return float(token)
def s_int(scanner, token): return int(token)

scanner = re.Scanner([
    (r"[a-zA-Z_]\w*", s_ident),
    (r"\d+\.\d*", s_float),
    (r"\d+", s_int),
    (r"=|\+|-|\*|/", s_operator),
    (r"\s+", None),
    ])

print scanner.scan("sum = 3*foo + 312.50 + bar") 
```

您将需要一个解析器来实际使用这个 lex 的内容

# java - ListView 在 setOnItemClickListener 上产生 nullpointerexception

> ID：10841929
> 
> 赞同：1
> 
> 时间：2012-05-31T22:04:29.783
> 
> 标签：java, android, eclipse, android-listview

我正在尝试使用一些教程代码并添加一个 OnItemClick 侦听器，但是当它遇到侦听器并使我的应用程序崩溃时会继续抛出异常。这是我第一次尝试在 Android 环境中工作，所以我试图了解所有这些东西是如何相互关联的。

这是我尝试过的：

```
import java.util.ArrayList;
import java.util.List;

import org.json.JSONObject;

import android.app.AlertDialog;
import android.app.ListActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListView;

public class RssActivity extends ListActivity{

private RssListAdapter adapter;

private OnItemClickListener newsSelectListener = new OnItemClickListener()
    {
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            AlertDialog.Builder alert=new AlertDialog.Builder(RssActivity.this);
            alert.setTitle("Clicked").setMessage("Item clicked").setNeutralButton("OK", null).show();

        }
    };

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    List<JSONObject> jobs = new ArrayList<JSONObject>();
    try {
        jobs = RssReader.getLatestRssFeed();
    } catch (Exception e) {
        Log.e("RSS ERROR", "Error loading RSS Feed Stream >> " + e.getMessage() + " //" + e.toString());
    }   

    adapter = new RssListAdapter(this,jobs);
    setListAdapter(adapter);

    ListView lv = (ListView)findViewById(R.id.list);
    lv.setOnItemClickListener(newsSelectListener);

    }
} 
```

我还尝试将 setListAdapter 更改为 lv.setListAdapter，但这似乎不是一个有效的声明。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:43:01.383

ListActivity 不需要您分配布局`setContentView()`，如果您只想显示**一个**列表，但如果您添加另一个视图，您的 ListView 应该包含设置为喜欢下面这个 xml的`android:id`属性`@android:id/list`

```
<ListView
  android:id="@android:id/list"
  android:layout_width="match_parent"
  android:layout_height="wrap_content" >
</ListView> 
```

尝试更改您的代码

`ListView lv = (ListView)findViewById(R.id.list);`

对此

```
ListView lv = getListView();
lv.setOnItemClickListener(newsSelectListener); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:12:50.430

我不确定您的代码是否有效

```
private OnItemClickListener newsSelectListener = new OnItemClickListener()
{
    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        AlertDialog.Builder alert=new AlertDialog.Builder(RssActivity.this);
        alert.setTitle("Clicked").setMessage("Item clicked").setNeutralButton("OK", null).show();

    }
}; 
```

但在我看来，我经常在类中的方法中添加`setOnClickListener()`convertView`getView``Adapter`

```
public View getView(final int position, View convertView, ViewGroup parent) {
......................
convertView.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                //Do Somethings in here
                }
            }
        }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T02:21:16.213

我看不到您在哪里初始化了布局...所以：

> `Activity`类负责为您创建一个窗口，您可以在其中放置您的 UI `setContentView(View)`。

该`onCreate(Bundle)`方法初始化您的`Activity`. 这是您通常`setContentView(int)`使用 xml 布局（`main.xml`或定义 UI 的 xml）调用的地方。放在后面`super.onCreate(..)`

* * *

关于这个例外：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{}: 
```

检查你`AndroidManifest.xml`的是否`Activity`已经在那里：

```
<activity android:name=".<ActivityName>" 
          android:label="@string/app_name">
</activity> 
```

* * *

如果您的问题尚未解决，请使用您的方法`Logcat`并使用`Log.d`您的方法来查看它在哪里崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T22:11:03.970

**编辑**

好的 - 你在哪里设置`setContentView(...)`？这`lv`

```
ListView lv = (ListView) findViewById(R.id.list); 
```

为空，因为您没有设置 contentView。

* * *

可能的原因是：您正在`OnClickListener`设置`null`in `AlertDialog.Builder`。`setNeutralButton("OK", null)`

因此，当您单击“确定”时，Android 会（在内部）调用如下内容：

```
neutralButtonListener.onClick(...); 
```

而且`neutralButtonListener`是`null`。所以你至少应该提供空的监听器。

# asp.net-mvc - 在 TagBuilder.GenerateID 中使用 GUID 字符串

> ID：10841942
> 
> 赞同：1
> 
> 时间：2012-05-31T22:05:26.477
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2

我用这篇文章创建了一个图像助手： [http](http://www.asp.net/mvc/tutorials/older-versions/views/using-the-tagbuilder-class-to-build-html-helpers-cs) ://www.asp.net/mvc/tutorials/older-versions/views/using-the-tagbuilder-class-to-build-html-helpers-cs 。它说它取代了句号，但没有提到其他限制。

除非我尝试使用 GUID 字符串作为 id，否则一切正常。

剃刀代码：

```
@Html.Image(id, ....) //passes a GUID string to helper fine 
```

ImageHelper 与网页描述的完全一样：

```
builder.GenerateId(id);
//breakpoint after this shows the builder object 
//does not create an id attribute when id is a GUID string.
//using id.ToString() doesn't work for GUIDs either 
```

在 MergeAttributes 中使用 GUID 字符串可以正常工作：

```
builder.MergeAttribute("title", id); //the GUID string is img title no problem
builder.MergeAttribute("class", id); //the GUID string is class as expected 
```

使用 GUID 字符串作为 ID 时是否有一些限制或解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T22:12:34.407

ID 必须以字母开头，而不是数字。通常，GUID 会以数字开头，因此会出现问题。 `TagBuilder.GenerateId`调用`CreateSanitizedId`，它执行此检查：

```
if (!TagBuilder.Html401IdUtil.IsLetter(c1))
    return (string) null; 
```

最好的办法是在 ID 的开头添加一个前缀，例如“guid”或其他内容。

# r - 三折线图

> ID：10841945
> 
> 赞同：2
> 
> 时间：2012-05-31T22:05:40.127
> 
> 标签：r, forex

我想在 R 中构建一个[三行换行图表](http://stockcharts.com/school/doku.php?id=chart_school%3achart_analysis%3athree_line_break)，并且想知道是否已经有一个包可以用来执行绘制图表所需的计算，或者更好地同时执行两者，即绘图和计算。

我曾尝试在 rseek.org 上进行搜索，并且还查看了一些财务方案。到目前为止没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T05:44:16.100

不是最干净的代码，但它可能有助于作为进一步开发的基础。`closeval`代表一些虚拟收盘价。

```
closeval <- c(50,48,47,47,59,60,57,48,42,50)
cvlag <- c(NA,head(closeval,-1))
dset <- data.frame(closeval,cvlag)
dset <- subset(dset,closeval!=cvlag | is.na(cvlag))
dset$cvlag2 <- c(NA,NA,head(dset$closeval,-2))

plot(dset$closeval)

dset <- dset[2:nrow(dset),]
dset$maxlag <- apply(dset[c("cvlag","cvlag2")],1,max,na.rm=TRUE)
dset$minlag <- apply(dset[c("cvlag","cvlag2")],1,min,na.rm=TRUE)

dset$change <- (dset$closeval-dset$cvlag) > 0

dset$keyval[dset$change==FALSE] <- dset$minlag[dset$change==FALSE]
dset$keyval[dset$change==TRUE] <- dset$maxlag[dset$change==TRUE]

segments(
2:(nrow(dset)+1),
dset$closeval,
2:(nrow(dset)+1),
dset$keyval,
col=ifelse(dset$change==TRUE,"red","blue")
) 
```

![在此处输入图像描述](../Images/6e712db00d9d334a0b1b57a2ed4f9029.png)

# c - C、从bin文件fread二进制

> ID：10841946
> 
> 赞同：1
> 
> 时间：2012-05-31T22:05:50.527
> 
> 标签：c, binary, fread

我对 C 很陌生，但我遇到了 fread 的问题......

我的最终目标是从 .bin 文件中读取（然后 printf 到控制台）二进制文件，但现在我一步一步地尝试读取第一位......

我的代码：

```
...
FILE *file = fopen("test1.bin", rb);
int i = 0;
fread(&i, 1, 1, file);
printf("%i\n", i);
... 
```

现在我已经在三个不同的 .bin 文件上进行了尝试，一个输出 0，另一个输出 2，另一个输出 12！

为什么当我从文件中读取一个 1 位时它输出 2/12？不应该是0还是1？我究竟做错了什么？非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T22:09:32.470

将调用更改[`fread()`](http://www.cplusplus.com/reference/clibrary/cstdio/fread/)为：

```
fread(&i, sizeof(int), 1, file); 
```

第二个参数是要读取的元素的大小，第三个参数是要读取的元素数。发布的代码正在将单个字节读入`int`.

您还应该检查来自`fopen()`和`fread()`调用的返回值，以确保它们成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:28:31.583

就像@hmjd 所说，您应该读取填充`int`值所需的字节数。所以无论是这种方式：

```
len = fread(&i, sizeof(int), 1, file); 
```

或者这样：

```
len = fread(&i, 1, sizeof(int), file); 
```

第一种情况读取一个`int`值（通常为 4 个字节）。调用后，`len`如果读取成功，则应该等于 1。

第二种情况将多个字节读入一个`int`值。不同的是，在这个调用之后，`len`应该等于`sizeof(int)`。

无论哪种方式都可以，唯一的区别是第一种方式指定读取多字节单个对象（an `int`），而第二种方式指定要读入对象的字节数。这是一个微妙的区别，当然，人们会不同意哪个是最好的。

第二种方法的优点是`len`可以准确地告诉您实际读取了多少字节（这可能对调试 I/O 错误很有用）。第一种方法的优点是它是一个概念上更简单的成功测试（是否`int`读过？）。

但无论你怎么做，你都应该经常检查`fread()`.

# javascript - 如何用 JSON 填充 TreeStore

> ID：10841948
> 
> 赞同：1
> 
> 时间：2012-05-31T22:06:14.270
> 
> 标签：javascript, json, sencha-touch-2

正如我们所知，我们无法将 TreeStore 中的数据保存在 LocalStorage 代理中。我开发了一个函数，可以保存将 JSON 对象转换为字符串的数据。

我的问题是当我从 LocalStorage 加载此字符串并尝试使用此数据加载 TreeStore 时。如果我使用`Ext.getStore('MyTreeStore').setData(MyJsonObject)`，我会收到一条带有下一条消息的警告：

> [WARN][Ext.data.TreeStore#removeAll] getRootNode 已被弃用。请改用 getRoot。

那么，有人知道该怎么做吗？这非常令人沮丧，我不知道如何得到这个。

谢谢您的帮助。

# sql - 准确计算 LTV

> ID：10841949
> 
> 赞同：0
> 
> 时间：2012-05-31T22:06:29.020
> 
> 标签：sql, ms-access, count

我正在尝试计算客户的“平均终身价值”。这意味着所有客户在我们这里的时间以及过去 30 天的平均总支出是多少。

表中数据（客户）：

```
|-----------------------|
|   ID   |   FirstName  |
|-----------------------|
    35       John
    84       Mike
    90       Cassie 
```

表中的数据（tblservice）：

```
|---------------------------------------------------|
|   serviceID   |   Timing  |  Total  |  customerID |
|---------------------------------------------------|
        1         3/10/2012   5.00          35
        2         3/19/2012   5.00          35
        3         3/20/2012   10.00         35
        4         3/25/2012   10.00         84
        5         4/15/2012   10.00         84 
```

注意：表“customer”和“tblservice”是一对多的关系。

这是我到目前为止得到的，它计算了客户每次购买的平均支出。但我不需要它来计算它现在所做的平均购买成本

我正在尝试计算每位客户的平均**总**支出。所以它必须先合计每个客户的所有购买，然后除以客户总数。

**使用上面的表格布局，它将计算客户 35 的平均生命周期价值为 ((5+5+10)/3) = 6.66 和客户 84 为 ((10+10)/2) = 10.00。**

**那么为了找到整个客户群的平均生命周期价值，它应该将每个客户的结果平均为：((6.66+10)/2) = 8.33**

请帮忙，这是迄今为止的两个查询（一个是所有时间，另一个是过去 30 天）：

```
SELECT AVG(tblservice.Total) AS LifetimeValue FROM tblservice;

SELECT AVG(tblservice.Total) AS LifetimeValue FROM tblservice
WHERE ((tblservice.Timing)>=DateAdd("d",-30,Date())); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T07:02:45.003

您需要先计算每个客户的平均值，然后再取平均值：

```
select avg(custavg) from (SELECT tblservice.customerid, Avg(tblservice.total) AS custavg FROM tblservice GROUP BY tblservice.customerid); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T07:17:12.537

执行子查询以获取每个客户的平均值：

```
SELECT
    AVG(customer_ltv)
FROM
    (SELECT
        customerID,
        AVG(Total) AS customer_ltv
    FROM
        tblservice
    GROUP BY
        customerID) avgs 
```

如果您需要按时过滤，则`WHERE`在内部查询中添加一个子句。

# java - ORA-00903: PreparedStatement 上的表名无效

> ID：10841952
> 
> 赞同：3
> 
> 时间：2012-05-31T22:06:40.883
> 
> 标签：java, sql, oracle, jdbc

我有一个方法，它将使用准备好的语句的 QueryParameters 列表执行查询。`HelperConnection`and只是小型 java bean，根据您在此处看到`QueryParameter`的 s 应该是不言自明的。`get`我正在尝试`select * from dual`使用，而不是使用`select * from ?`STRING`QueryParameter`类型且值为`dual`. 但是，我遇到了一个`java.sql.SQLSyntaxErrorException: ORA-00903: invalid table name`错误。我的代码和输出如下。这是怎么回事？

```
public static ResultSet executeQuery(HelperConnection helperConnection, String query, QueryParameter... params) throws SQLException {
  System.out.println("The connection is: " + helperConnection.getJdbcURL());
  System.out.println("The query is: " + query);
  if (params.length > 0) {
    System.out.println("The QueryParameters are:");
    System.out.println("\t" + StringHelper.splitBy(StringHelper.newline + "\t", params));
  }
  Connection conn = helperConnection.createOracleConnection();
  PreparedStatement pstmt = conn.prepareStatement(query);
  for (int i = 1; i <= params.length; i++) {
    QueryParameter param = params[i - 1];
    switch (param.getType()) {
      //Other cases here
      case QueryParameter.STRING:
        pstmt.setString(i, param.getValue());
        break;
    }
  }

  ResultSet rs = pstmt.executeQuery();
  conn.commit();
  return rs;
} 
```

输出：

```
The connection is: //.....My connection
The query is: select * from ?
The QueryParameters are:
    String - dual 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T22:08:59.703

我相信`PreparedStatement`参数仅用于*值*- 不适用于 SQL 查询的一部分，例如表。可能有一些数据库支持您想要实现的目标，但我不相信 Oracle 是其中之一。您需要直接包含表名 - 当然要谨慎。

# php - 未找到 PHP 类 DateTime

> ID：10841960
> 
> 赞同：30
> 
> 时间：2012-05-31T22:07:16.127
> 
> 标签：php, eclipse, datetime

**在PHP 5.3.8**中声明 DateTime 对象时遗漏了一些东西

 **我得到一个带有确定日期时间的 JSON 字符串，该字符串传递给我的 php 控制器。

出于某种原因，我没有将它映射为 php 中的 DateTime 对象。但是有点奇怪。请参阅以下图片：

1.  正如您在表达式窗口（右上角）中看到的那样，在这一步之前，我正在检查 new DateTime(myVariable) 是否正确地带来和转换了我需要的东西。在第一个手表中，要传递给 DateTime 构造函数的变量。在第二个手表中，表达式 newDateTime(myVariable) 已经映射为 DateTimeObject。到这里显然还好。

    ![在此处输入图像描述](../Images/5bf8b900fb6ebc1e9d67193ed8e5d20c.png)

2.  但是，可悲的是，当我继续按 F6 时，会抛出以下豁免（另见下图）：

    ```
    Fatal error: Class 'Acme\StoreBundle\Repository\DateTime' not found in /Users/pgbonino/Sites/Symfony/src/Acme/StoreBundle/Repository/HistoryRepository.php on line 19

    Call Stack:
        0.0201     693568   1\. {main}() /Users/pgbonino/Sites/Symfony/web/app_dev.php:0
        0.0267    2106576   2\. Symfony\Component\HttpKernel\Kernel->handle(???, ???, ???) /Users/pgbonino/Sites/Symfony/web/app_dev.php:24
        0.0377    2649176   3\. Symfony\Bundle\FrameworkBundle\HttpKernel->handle(???, ???, ???) /Users/pgbonino/Sites/Symfony/app/bootstrap.php.cache:547
        0.0378    2650832   4\. Symfony\Component\HttpKernel\HttpKernel->handle(???, ???, ???) /Users/pgbonino/Sites/Symfony/app/cache/dev/classes.php:4879
        0.0378    2650832   5\. Symfony\Component\HttpKernel\HttpKernel->handleRaw(???, ???) /Users/pgbonino/Sites/Symfony/app/cache/dev/classes.php:3875
        0.1574    5562232   6\. call_user_func_array(???, ???) /Users/pgbonino/Sites/Symfony/app/cache/dev/classes.php:3905
        0.1574    5562600   7\. Acme\StoreBundle\Controller\HistoryController->saveTestAction() /Users/pgbonino/Sites/Symfony/app/cache/dev/classes.php:3905
        0.1694    5739032   8\. Acme\StoreBundle\Repository\HistoryRepository->saveTestInHistory(???, ???) /Users/pgbonino/Sites/Symfony/src/Acme/StoreBundle/Controller/HistoryController.php:33 
    ```

    ![在此处输入图像描述](../Images/6b9b71b59df5005b42fda047ea9ea2dd.png)

因此，奇怪的是，Eclipse 中的 Watch Expressions 窗口不像执行引擎那样工作，反之亦然。

当然，我更希望它是相反的（它在执行而不是在监视窗口中起作用:)）。

那么，有什么想法吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-05-31T22:10:06.913

你目前在`Acme\StoreBundle\Repository\DateTime`napespace。在这种情况下，要寻址到默认命名空间，您需要`\`在类名之前放置前导，例如

```
$dt = new \DateTime(...); 
```

所以

```
namespace foo;
$obj = new class(); 
```

将尝试`class`在命名空间中查找定义`foo`。

和

```
namespace foo;
$obj = new \class(); 
```

将尝试`class`在全局命名空间中查找定义。

作为替代方案，您可以使用

```
use \DateTime; 
```

或创建别名（如果您在当前 NS 中已经拥有同名的类）：

```
use \DateTime as NewDT; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T22:10:54.887

我猜您正在使用命名空间并尝试使用 DateTime （相对于当前命名空间）而不是 \DateTime （完整的限定类名）**

# database - DBIx::Class::Schema::Loader: make_schema_at 没有找到任何关系

> ID：10841963
> 
> 赞同：1
> 
> 时间：2012-05-31T22:07:22.100
> 
> 标签：database, perl, orm, relational-database, dbix-class

我正在做一个小项目以学习使用 DBIx::Class 并且我正在尝试使用 DBIx::Class::Schema::Loader 从数据库中获取模式代码。make_schema_at 工具创建模式，但不插入类之间的任何关系。我正在处理：创建表：

```
CREATE TABLE recipe (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
    name varchar(255) NOT NULL,
    description TEXT NOT NULL
)
ENGINE InnoDB, CHARACTER SET utf8;

CREATE TABLE ingredient(
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
    recipe_id INT NOT NULL REFERENCES recipe(id),
    name TEXT NOT NULL,
    quantity INT NOT NULL
)
ENGINE InnoDB, CHARACTER SET utf8; 
```

进而：

```
perl -MDBIx::Class::Schema::Loader=make_schema_at,dump_to_dir:./lib -e 'make_schema_at("Recipes::Schema", { debug => 1 }, [ "dbi:mysql:dbname=recipes","user", "pass" ])' 
```

我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T23:38:42.250

DBICSL 不放弃您的关系的最常见原因是您实际上*没有*关系。如果你`SHOW CREATE TABLE ingredient`在你的数据库中，你会看到实际上没有外键存在。根据[MySQL CREATE TABLE 文档](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)，这是因为：

> 此外，InnoDB 不识别或支持“内联 REFERENCES 规范”（如 SQL 标准中所定义），其中引用被定义为列规范的一部分。InnoDB 仅在指定为单独的 FOREIGN KEY 规范的一部分时才接受 REFERENCES 子句。

如果`REFERENCES`从列定义中删除 并添加`FOREIGN KEY (recipe_id) REFERENCES recipe(id)`到表定义中，FK 将实际在 MySQL 中创建，DBICSL 将创建`belongs_to`关系 from `Ingredient`to`Recipe`和`has_many`关系 from `Recipe`to `Ingredient`。

# javascript - 如何使用 javascript 或 css 使 div 突出显示而其余内容为灰色或阴影？

> ID：10841966
> 
> 赞同：-3
> 
> 时间：2012-05-31T22:07:29.590
> 
> 标签：javascript, css, dom, html

我看到 div 就像活动框一样，我认为必须有一种方法，而不是调整页面颜色或创建图层并使用 z 索引将焦点 div 放在前面。

我想隐藏页面上的所有内容，除了我想向用户显示的 div。就像 facebooks 显示前面的图片，但您仍然可以在背景中看到大约 50% 不透明度的页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T22:11:24.753

创建一个覆盖整个页面的元素：

```
<div id="modal"></div> 
```

样式它：

```
#modal {
    background: rgba(0,0,0,.8);
    position: fixed;
    top: 0; 
    left: 0;
    width: 100%; 
    height: 100%;
    z-index: 100;
} 
```

仅在需要时显示。接下来为我们想要的元素创建一个类：

```
.overModal {
    position: relative;
    z-index: 200;
} 
```

演示：http: [//jsfiddle.net/jonathansampson/pVUHP/](http://jsfiddle.net/jonathansampson/pVUHP/)

# audio - CUE 表 - 最后一首歌曲的持续时间

> ID：10841968
> 
> 赞同：2
> 
> 时间：2012-05-31T22:07:39.817
> 
> 标签：audio, flac, cue-sheet

问题很简单 - CUE 文件阅读器，如 Foobar，如何计算最后一首歌的时长？
那是样本：

```
REM GENRE "Atmospheric Black Metal"
REM DATE 2011
REM DISCID 4711E907
REM COMMENT "ExactAudioCopy v1.0b3"
PERFORMER "TOBC"
TITLE "Heart Of Darkness"
FILE "TOBC - Heart Of Darkness.flac" WAVE
  TRACK 01 AUDIO
    TITLE "Through The Frozen Realm"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 01 00:00:00
  TRACK 02 AUDIO
    TITLE "Visions"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 00 10:00:08
    INDEX 01 10:02:08
  TRACK 03 AUDIO
    TITLE "Heart Of Darkness"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 00 17:28:38
    INDEX 01 17:30:38
  TRACK 04 AUDIO
    TITLE "Nightfall"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 00 30:24:03
    INDEX 01 30:26:03
  TRACK 05 AUDIO
    TITLE "Chains To Eternity"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 00 35:48:47
    INDEX 01 35:50:47
  TRACK 06 AUDIO
    TITLE "Eternal Darkness"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 00 43:26:38
    INDEX 01 43:28:38
  TRACK 07 AUDIO
    TITLE "Fade"
    PERFORMER "TOBC"
    FLAGS DCP
    INDEX 00 68:42:07
    INDEX 01 68:44:07 
```

我有几个 .cue ，Foobar 读得很好，但问题是最后一首歌显示“？” 在持续时间字段内。我也不能四处走动歌曲。
我该如何解决？
谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T05:23:02.367

我用 EAC 翻录了几张 CD，发现“？” 作为 foobar2000 中最后一首曲目的持续时间。我认为原因是我在 .flac 和 .cue 文件的名称前放了一个数字以保持顺序。删除数字后，最后一首曲目的持续时间又回来了。希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-10-24T04:15:26.750

我对 foobar2000 完全陌生，不明白程序何时以及为什么会出现最后一首曲目的持续时间问题。但是，到目前为止 -> 最后一首曲目的属性 -> 工具和“重新加载信息”始终导致正确显示持续时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-07T07:59:09.550

我发现只需打开然后保存 .cue 文件即可使其在 Foobar 中正常工作。奇怪的东西。为了更好地衡量，我在文件末尾添加了一个额外的空白行。

# java - Java 中的事件处理程序中的 NullPointerException

> ID：10841972
> 
> 赞同：1
> 
> 时间：2012-05-31T22:08:13.443
> 
> 标签：java, android, events, nullpointerexception

在我的 Android 应用程序中，我有一个从另一个线程调用的事件处理程序。当调用处理程序时，我的一些私有字段为空，所以我得到一个 NullPointerException，因为我试图从一个空对象访问一个方法。我不明白为什么它们会为空，因为我之前实例化了这些字段并且我没有在其他任何地方设置这些字段。

这可能与跨线程有关吗？这些字段设置在一个线程中，但由另一个线程访问..？没有权利？它们不应该为空。我在这里发疯了，但这可能是一个我现在无法发现的小错误。

我想当你没有代码时很难回答，但我不能在这里发布我的整个解决方案。也许有人可以指出我寻找什么的正确方向..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:39:52.503

我终于找到了解决方案。我发现 Android 正在启动我的活动两次。因此，显然在一项活动中，对象的状态很好，但在另一项活动中，我的字段为空。

当设备的方向发生变化时，Android 显然会停止活动并启动另一个活动。我在[这里](http://www.andengine.org/forums/bugs/music-starts-twice-in-android-2-2-t1792.html)和[这里找到了解决方案](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)

感谢你们的帮助，即使你们没有太多可以去的地方。

# iphone - 在 UITableView 中创建一个部分，就像在“音乐”应用程序中一样

> ID：10841981
> 
> 赞同：0
> 
> 时间：2012-05-31T22:09:03.157
> 
> 标签：iphone, objective-c, ios, xcode, uitableview

您如何为 iOS 中的“音乐”应用程序中的每个轨道创建一个带有数字的 UITableView 部分，例如数字 1、2、3？提前致谢！

![在此处输入图像描述](../Images/218c9828c2db94b9707abd578275525b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T23:16:13.047

您可以子类`UITableViewCell`化并创建一个子视图 UIlabel 属性，例如......`trackNumber`并在您的`cellForRowAtIndex..`方法中初始化您的自定义单元格。

编辑：添加示例

```
 //CustomCell.h
@interface CustomCell : UITableViewCell

@property(nonatomic,retain) UILabel *trackNumber;

@end

//CustomCell.m
@implementation CustomCell
@synthesize trackNumber;

    - (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
    {
        self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
        if (self) {
            // Initialization code
            self.trackNumber = [[[UILabel alloc] initWithFrame:CGRectMake(5,5,40,40)] autorelease];
            [self addSubview:self.trackNumber];
        }
        return self;
    }

    @end 
```

`#import "CustomCell.h"`在您的实现中使用它。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

CustomCell *cell = (CustomCell*)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {

    cell = [[[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];

}

cell.trackNumber.text = [NSString stringWithFormat:@"%i",[indexPath row]];

// Configure the cell.
return cell;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:17:10.873

创建一个自定义`UITableViewCell`并用它做任何你想做的事情。在检查器中将单元格样式更改为自定义。然后画出你想要的任何东西。确保在单元格中创建的新标签和其他元素的视图部分使用 tag 属性，因为您将需要这些标签来访问任何自定义标签、按钮、文本字段，以及您在单元格中创建的任何内容。基本上在你的`cellForRowAtIndexPath:`函数中，你可以使用类似的东西来拆开你的自定义单元格

```
UILabel *numberLabel = (UILabel *)[customCell viewWithTag:1]; 
```

# html - 在最大宽度上切换到手风琴

> ID：10841982
> 
> 赞同：0
> 
> 时间：2012-05-31T22:09:14.013
> 
> 标签：html, accordion

我有一个小脚本，可以将 div 列表更改为特定（浏览器）宽度的手风琴。

```
if ($(window).width() < 768) {
    $( "#footerWidgets" ).accordion();
   } else {
  } 
```

一切正常，但问题是当用户在小屏幕上查看网站并增加浏览器宽度（或将手机更改为横向）时，它不会变回默认的非手风琴位置。希望结果弄乱了内部布局。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T22:11:37.903

你可以把它放在 resize 函数中：

```
$(window).resize(function() {
    var win_width = $(window).width();
    if ( win_width < 768 ){
        $( "#footerWidgets" ).accordion();
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T22:12:25.317

设置一个`onresize`事件处理程序，在调整大小和“de-accordianizes”时重新检查窗口的大小`#footerWidgets`。

```
$(window).resize(function() {
    if ($(window).width() > 768) {
        $("#footerWidgets").accordion("destroy");
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T22:13:05.780

你会想在你的调整大小函数中调用它

```
$( "#footerWidgets" ).accordion( "destroy" ) 
```

# excel - Excel重新计算顺序 - 为什么依赖单元格在前一个单元格之前计算？

> ID：10841987
> 
> 赞同：5
> 
> 时间：2012-05-31T22:09:49.547
> 
> 标签：excel, excel-2010, vba

我对 Excel 计算顺序有一个奇怪的问题 - 设置范围脏时，在具有空参数值的前一个单元格之前计算依赖单元格。有没有办法检测那些“假”电话？这对我来说至关重要，因为我在现实世界的应用程序中运行了一些巧妙的业务逻辑，而那些“假”调用会破坏所有逻辑。此外，如果在 RTD 中注册，那些“假”调用不会将其正确绑定到主题，因此不会通知主题断开连接。

Excel 2010/32bit 最新全部。

为了说明问题，我创建了简单的函数：

```
Function Fnc(param2 As String) As String
    Fnc = Application.ThisCell.Address
    Debug.Print (Application.ThisCell.Address & " - " & param2)
End Function 
```

和程序：

```
Sub SetDirty()
    Range("B1:C1").Dirty
End Sub 
```

和简单的表：

$A$1 =fnc(A1) =fnc(B1)

进入单元格 A1、B1、C1。

结果很明显：

$A$1 $B$1 $C$1

如果我重新计算（`CTRL`+ `Alt`+ `Shift`+ `F9`），我会得到，如预期的那样：

$B$1 - $A$1

$C$1 - $B$1

但是，有趣的部分来了。如果我运行 SetDirty：

$C$1 - <---- 这是哪里来的？

$B$1 - $A$1

$C$1 - $B$1

感谢您的任何意见。我更喜欢解决此问题的解决方案，而不是解决方法，因为它已经是一堆解决方法的一部分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T08:03:51.270

单元格通常会多次重新计算：Excel 以重新计算序列开始，该序列是先前的计算序列加上所有修改单元格的 LIFO（后进先出）。这会导致调用函数并给出未计算的单元格 - 稍后再次调用函数。
您可以使用 IsEmpty检测 UDF 中未计算的单元格 有关 UDF 和检测未计算单元格的详细信息，请
参见[http://www.decisionmodels.com/calcsecretsj.htm](http://www.decisionmodels.com/calcsecretsj.htm) ，有关 Excel 的详细信息，请参见[http://www.decisionmodels.com/calcsecretsc.htm](http://www.decisionmodels.com/calcsecretsc.htm)计算顺序。顺便说一句，Range.Dirty 要小心-它有点马车

# mysql - 使用 MAMP 对 MySQL 的命令行访问不起作用

> ID：10841993
> 
> 赞同：0
> 
> 时间：2012-05-31T22:10:45.260
> 
> 标签：mysql, shell, command-line, terminal, mamp

打开 MAMP 时出现以下错误：http: [//i.imgur.com/8hqbi.png](http://i.imgur.com/8hqbi.png)

我通过终端更改了密码，一切似乎都很好。然后我在其他三个相关文件中对其进行了更改。然后我将 MAMP 添加到 PATH 以便识别 MySQL 命令。它仍然无法识别，所以我重新启动，现在它“工作”，是的。

但是当我输入`mysql -p`并输入我的密码时，它显示访问被拒绝。

为什么？错误是什么意思？

我应该补充一点，起始页加载正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:42:12.267

想通了，原来你还需要编辑这个文件并将 -p 更改`root`为 -p `newpassword`。

# .htaccess - 没有为所有网址设置 https

> ID：10841997
> 
> 赞同：1
> 
> 时间：2012-05-31T22:11:15.567
> 
> 标签：.htaccess, https

我需要在某些页面上设置 https。为此，在我的 .htaccess 中，我有：

```
RewriteCond %{HTTPS} off
RewriteRule ^(login|message|enter|view|edit|submit)(.*)/?$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,NC,L] 
```

但是，这只适用于 url 类似于**mysite.com/login**而不是**mysite.com/de/login**的情况。无论前面有什么，我怎样才能让所有这些 url 成为 https？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:14:41.473

将您的代码替换为：

```
RewriteCond %{HTTPS} off
RewriteRule ^(.*/|)(login|message|enter|view|edit|submit)(/.*|)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,NC,L] 
```

# reverse-geocoding - 读取 Shapefile 以进行反向地理编码的开源库

> ID：10841999
> 
> 赞同：1
> 
> 时间：2012-05-31T22:11:35.143
> 
> 标签：reverse-geocoding, shapefile

我正在寻找一个开源库，使我们能够读取/查询 shapefile（ESRI shapefile）。基本上我有一个执行反向地理编码类似任务的应用程序。应用程序将输入作为纬度/经度，并且它必须返回相应的邮政编码。

因此，我正在寻找一个库，它基本上可以读取给定的 shapefile 并回答（lat/long -> zipcode）之类的查询。我有美国人口普查数据提供的邮政编码制表区 TIGER shapefile。有人知道这样的图书馆吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T22:40:42.110

看看 GeoTools：[http ://docs.geotools.org/latest/userguide/tutorial/quickstart/index.html](http://docs.geotools.org/latest/userguide/tutorial/quickstart/index.html)