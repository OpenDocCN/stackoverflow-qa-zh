# StackOverflow 问答 10359000-10359999

# batch-file - 如何将 REG 值读入环境变量

> ID：10359001
> 
> 赞同：4
> 
> 时间：2012-04-27T23:05:17.577
> 
> 标签：batch-file, cmd, environment-variables

我正在尝试将 REG 值读入 BAT 文件中的环境变量。例如，

REG HKLM\SYSTEM\CurrentControlSet\Services\Eventlog /v ImagePath

我可以将 REG 命令的整个输出字符串放入一个环境变量中，如下所示：

```
FOR /F "usebackq delims==" %%a in (`REG QUERY "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog" /v ImagePath`) DO set ImagePath=%%a 
```

但是，这会将环境变量设置为整行，即

```
ImagePath   REG_EXPAND_SZ   C:\Windows\system32\services.exe 
```

我希望环境变量仅包含路径部分，即

```
C:\Windows\system32\services.exe 
```

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T23:46:40.647

```
for /f "tokens=2*" %%A in ('REG QUERY "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog" /v ImagePath') DO set ImagePath=%%B 
```

默认分隔符是空格和制表符；无需更改它。TOKENS=2* 将第二个令牌存储在 %%A 中，将行的其余部分存储在 %%B 中。

关于您的原始代码 - 在您的情况下使用 USBACKQ 没有任何好处。此外，如果包含，您的代码将不会保留整行，`=`因为您将其用作分隔符。

***回复评论***
如果您可以依赖路径不包含任何空格的事实，那么您可以简单地使用“TOKENS=3”并保存 %%A。但我不会相信这一点。相反，我会使用

```
for /f "tokens=2*" %%A in ('REG QUERY "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog" /v ImagePath') DO (
  for %%F in (%%B) do (
    set ImagePath=%%F
    goto :break
  )
)
:break 
```

# javascript - 获取文档的宽度和高度

> ID：10359003
> 
> 赞同：0
> 
> 时间：2012-04-27T23:05:21.977
> 
> 标签：javascript

我很好奇如何获得文档的宽度，看起来我可以使用窗口的宽度，`document.body.offsetWidth`但我尝试的其他一切都像几个像素不同`document.body.offsetWidth`，我需要更大的文档宽度，并且不'在调整窗口大小时不改变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T23:25:17.723

```
function getSize()
{
    var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName('body')[0];
    var x=w.innerWidth||e.clientWidth||g.clientWidth;
    var y=w.innerHeight||e.clientHeight||g.clientHeight;
    return {width:x, height:y}
}
var size=getSize();
console.log(size.width+" "+size.height); 
```

[**演示。**](http://jsfiddle.net/7vy3J/1/)

# java - JUnit 错误：无法找到或加载主类 (RemoteTestRunner)

> ID：10359006
> 
> 赞同：3
> 
> 时间：2012-04-27T23:05:42.133
> 
> 标签：java, eclipse, junit

我已经下载了 Junit 4.10 版并通过构建路径加载了 jar，但是在 Eclipse 中运行 Junit 测试时似乎收到了以下错误消息：

```
Error: Could not find or load main class org.eclipse.jdt.internal.junit.runner.RemoteTestRunner 
```

我的测试类如下：

```
import org.junit.*;
import static org.junit.Assert.assertEquals;

public class InternetConnectTest {

@Test
public void testConnectMethod(){

    InternetConnect net = new InternetConnect("www.google.com");
    assertEquals("Result", "www.google.com", net.url);

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T21:30:59.163

我在更新 java 版本后遇到了这个问题：“junit：无法加载主类 1.1”。进入 eclipse 外部工具配置，打开您正在运行的 ant 文件的条目，然后转到 JRE 选项卡，然后选择“Separate JRE”，同时确保您的新 jre 在 Installed JREs 中正确列出...我，这照顾它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-08T18:24:20.907

在尝试全新安装之前，我刚刚重新启动了 eclipse，它成功了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T10:14:12.437

这是一条 Eclipse 错误消息。您的安装似乎已损坏。尝试使用全新安装的 Eclipse。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-04T08:23:16.467

我只是有同样的问题。我使用“-clean”选项重新启动 Eclipse，它也成功了。

编辑： [如何在干净模式下运行 eclipse？如果我们这样做会发生什么？](https://stackoverflow.com/questions/2030064/how-to-run-eclipse-in-clean-mode-and-what-happens-if-we-do-so)

# java - 关于 onPause 和 onResume 的建议

> ID：10359016
> 
> 赞同：0
> 
> 时间：2012-04-27T23:07:31.180
> 
> 标签：java, android

如果我使用下面的代码，这是否会恢复已输入到 EditTextfields 和选定微调器项目中的文本？

```
 @Override
    protected void onPause(){ 
        super.onPause();

    }

    @Override 
    protected void onResume(){ 
        super.onResume(); 

    } 
```

还是我必须告诉它保存当前值，然后在恢复活动时恢复？当我使用模拟器时，如果我没有这些方法，我会说回家然后再次运行我的应用程序，它总是会加载回以前的状态，所以我的问题是这真的有什么作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:16:22.060

不，此代码不执行任何操作。您正在覆盖这些方法，但为它们提供了仅调用父实现的实现。这与一开始就没有覆盖它们是一样的。

暂停/恢复时保存/恢复状态并不是绝对必要的。您需要手动保存状态的唯一原因是，即使您的应用程序被终止，您也想恢复状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T23:18:34.223

不，这实际上只调用了超类 onPause() 和 onResume() 而没有做任何其他事情。编辑框中的值保留在那里，因为即使应用程序暂停，仍然在活动堆栈中等待。但是，Android 可以终止您暂停的活动，并且您的数据将会丢失。因此，您必须在 onPause 上保存它们并在 onResume 上恢复它们​​以避免这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T23:20:13.467

您在微调器中的值仍然相同，因为该应用程序尚未被杀死。它只是在内存中放置了一个暂停状态。如果应用程序被销毁，您的微调器的值将返回到 onCreate 方法以及它们在开始时具有的任何值。

在此处查看每种方法的作用-> [https://developer.android.com/reference/android/app/Activity.html](https://developer.android.com/reference/android/app/Activity.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T23:21:11.923

您只需要在`onDestroy()`调用时保存状态。这只发生在您使用后退按钮或操作系统`Activity`在它处于停止状态时杀死它时。

如果您`Activity`被部分遮挡，它将被暂停，但如果它完全被遮挡，它将被停止。

当它再次位于堆栈顶部时，它将恢复或启动。

实验用于在每个事件发生时`Log`写入消息`LogCat`，然后您将能够看到它们何时以及为何被调用。

# javascript - jquery unbind 切换事件不起作用

> ID：10359017
> 
> 赞同：1
> 
> 时间：2012-04-27T23:07:34.377
> 
> 标签：javascript, jquery

我有一个 div 元素在运行模式下由 javascript 生成我想首先单击显示确认消息，然后单击删除单击事件但死或取消绑定不起作用！

```
$('div').live('click',function(e) {

    $(this).toggle(function () {
            $(this).html("I'm sure!");
            return false;
        },
        function (e) {

            $(this).html("Deleting...");
            $(this).die('click').die('click');

        }).trigger('click');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:17:58.563

那个怎么样？

```
$('div').on('click',function(e) {
    e.preventDefault();
    var el = $(this);

    if (el.data("confirm")) {
        el.html("Deleting").off("click");
    } else {
        el.html("I'm sure!").data("confirm", true);
    }
});​ 
```

编辑 **。**示例在这里：http: [//jsfiddle.net/93nPA/](http://jsfiddle.net/93nPA/)

**编辑 2.** 如果您希望脚本自动将点击事件添加到生成的元素，只需将类添加到生成的元素（例如），并在 JavaScript 的最顶部`mybutton`使用此代码*一次*`$("body").on("click", "div.mybutton", function(e) { ... });`： .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:20:10.160

考虑在这样的单独函数中创建处理程序回调

```
var Div_Click = function(e) {
    // code for this handler
}; 
```

所以很容易绑定和解绑

```
$("div").bind("click", Div_Click); // or "live" or "on"
$("div").unbind("click", Div_Click); 
```

# ruby-on-rails - Rails YAML.load_file 从开发到生产的行为不同

> ID：10359019
> 
> 赞同：0
> 
> 时间：2012-04-27T23:07:36.937
> 
> 标签：ruby-on-rails, heroku

当我做

```
excel_mapping = YAML.load_file("#{Rails.root}/config/FdfToExcelMapping.yml") 
```

在开发环境中，结果是字符串的哈希

在生产中部署到 heroku 时`excel_mapping`评估为字符串。

我错过了什么？

```
$heroku run console

config = YAML.load_file("#{Rails.root}/config/FdfToExcelMapping.yml")
=> "LastName:\t\tA FirstName:\t\tB County:\t\t\tC Company:\t\tD MainPhone:\t\tE Code:\t\t\tF Source:\t\t\tG Plan:\t\t\tH Type:\t\t\tI CurrentInsurance:\tJ TypeOfCoverage:\t\tK DateAdded:\t\tM Address1:\t\tO Address2:\t\tP City:\t\t\tQ State:\t\t\tR Zip:\t\t\tS County1:\t\tT Email:\t\t\tU DOB:\t\t\tV SSN:\t\t\tW Eff2Exp:\t\tX Y:\t\t\tY Business:\t\tZ HireDate:\t\tAA Effective:\t\tAB PP:\t\t\tAC CName1:\t\t\tAD CDOB1:\t\t\tAE CSSN1:\t\t\tAF CPP1:\t\t\tAG CName2:\t\t\tAH CDOB2:\t\t\tAI CSSN2:\t\t\tAJ CPP2:\t\t\tAK Spouse:\t\t\tAL SpouseDOB:\t\tAM SpouseSSN:\t\tAN SpousePP:\t\tAO CName3:\t\t\tAP CDOB3:\t\t\tAQ CSSN3:\t\t\tAR CPP3:\t\t\tAS CName4:\t\t\tAT CDOB4:\t\t\tAU CSSN4:\t\t\tAV CPP4:\t\t\tAW"

$rails console

config = YAML.load_file("#{Rails.root}/config/FdfToExcelMapping.yml")
 => {"LastName"=>"A", "FirstName"=>"B", "County"=>"C", "Company"=>"D", "MainPhone"=>"E", "Code"=>"F", "Source"=>"G", "Plan"=>"H", "Type"=>"I", "CurrentInsurance"=>"J", "TypeOfCoverage"=>"K", "DateAdded"=>"M", "Address1"=>"O", "Address2"=>"P", "City"=>"Q", "State"=>"R", "Zip"=>"S", "County1"=>"T", "Email"=>"U", "DOB"=>"V", "SSN"=>"W", "Eff2Exp"=>"X", "Y"=>"Y", "Business"=>"Z", "HireDate"=>"AA", "Effective"=>"AB", "PP"=>"AC", "CName1"=>"AD", "CDOB1"=>"AE", "CSSN1"=>"AF", "CPP1"=>"AG", "CName2"=>"AH", "CDOB2"=>"AI", "CSSN2"=>"AJ", "CPP2"=>"AK", "Spouse"=>"AL", "SpouseDOB"=>"AM", "SpouseSSN"=>"AN", "SpousePP"=>"AO", "CName3"=>"AP", "CDOB3"=>"AQ", "CSSN3"=>"AR", "CPP3"=>"AS", "CName4"=>"AT", "CDOB4"=>"AU", "CSSN4"=>"AV", "CPP4"=>"AW"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T04:05:20.440

看起来您的 YAML 文件包含制表符“\t”而不是空格。YAML 规范似乎表明键/值对分离需要空格。[http://www.yaml.org/spec/1.2/spec.html#id2775170](http://www.yaml.org/spec/1.2/spec.html#id2775170)

# ios - UILocalNotification - repeatInterval 重置（不重复）

> ID：10359024
> 
> 赞同：2
> 
> 时间：2012-04-27T23:08:24.707
> 
> 标签：ios, uilocalnotification

**概述**

*   我正在创建一个基于现有实例的通知`UILocalNotification`
*   现有实例已`repeatInterval`设置为`NSWeekdayCalendarUnit`

**我想做的事**

*   我想设置`repeatInterval`为不重复，

**问题**

*   `repeatInterval`为了不重复，我应该设置什么常数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T03:49:15.127

取自 Apple 文档：

> 如果您分配日历单位，例如每周 (NSWeekCalendarUnit) 或每年 (NSYearCalendarUnit)，系统会重新安排通知以指定时间间隔发送。**默认值为 0，表示不重复。**

我假设您想取消具有重复间隔的通知，您可以通过两种方式做到这一点：

1.  取消**所有**通知。
2.  仅取消**该通知。**

第一个选项很简单，使用：

```
cancelAllLocalNotifications 
```

在您的应用委托中。

第二个需要更多的工作。您需要检查待处理的通知（使用`scheduledLocalNotifications`）并取消通知。

为了知道哪些通知将被取消，您可以`userInfo`在设置通知时使用该属性。例如，为每个通知设置一个唯一 ID，这样当您取消该通知时，您只需将该 ID 与`scheduledLocalNotifications`数组中的所有 ID 进行比较。

# c# - 在 C# 表单中保存和恢复应用程序设置

> ID：10359029
> 
> 赞同：2
> 
> 时间：2012-04-27T23:09:16.687
> 
> 标签：c#

我有一个基于 C# 对话框的应用程序。我想保存用户选择的首选项/设置，以便在下次运行时重新加载它们。

我是 C# 新手，可能这是非常基本的东西，但我不知道。我是否必须将它们明确写入 ini 之类的文件中？还是有内置的方法可以做到这一点。

配置数据的类型就像选择的复选框、numericUpDOwn、checkedListbox - 选中的项目等

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T08:46:23.093

在设计器中选择控件。在“属性”窗口中一直向上滚动并展开 (ApplicationSettings)。单击指示的按钮打开一个对话框。选择应保留其值的属性（例如 Checked for a check 复选框），然后单击下拉列表中的 New。

![在此处输入图像描述](../Images/6fe8bf04d5f780bdd7b6184836f57483.png)

请注意，并非所有属性都适合这样持久化。一个例子是表单的大小。您不想在表单最小化或最大化时存储大小，该大小将无法很好地恢复。您需要通过在设置设计器中添加设置来执行此操作，并且仅在控件处于正确状态时才编写它。在 Size 的情况下，当 Resize 事件运行并且 WindowState 为 Normal 时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T10:48:57.430

按照其他答案的建议创建应用程序设置后，请确保不要忘记调用`Properties.Settings.Default.Save()`，例如：

```
private void Form1_Closing(object sender, System.ComponentModel.CancelEventArgs e)
{
    Properties.Settings.Default.Save()
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T23:14:25.710

在设计时创建新设置

**在解决方案资源管理器中，展开项目的属性节点。**

**在解决方案资源管理器中，双击要在其中添加新设置的 .settings 文件。此文件的默认名称是 Settings.settings。**

**在设置设计器中，为您的设置设置名称、类型、范围和值。每行代表一个设置**

有关更多信息，您可以参考[这里](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-27T23:14:05.700

您应该使用[应用程序设置](http://msdn.microsoft.com/en-us/library/0zszyc6e.aspx)。这些将在您关闭应用程序后保留它们的值，并且当程序重新启动时您将能够从它们中读取。

# php - Magento 产品列表 - 按产品类型排序（可配置然后简单）

> ID：10359030
> 
> 赞同：2
> 
> 时间：2012-04-27T23:09:31.120
> 
> 标签：php, magento

在 /app/design/frontend/default/[theme]/template/catalog/product/list.phtml 中，您有以下代码片段循环并显示**$_productCollection**内容。

```
<?php $_collectionSize = $_productCollection->count() ?>
<?php $_columnCount = $this->getColumnCount(); ?>
<?php $i=0; foreach ($_productCollection as $_product): ?>
...
<?php endif; ?> 
```

我想知道的是如何按产品类型对 $_productCollection 进行排序。最终我想要的是首先展示可配置的产品，然后是简单的产品。

帮助将不胜感激。

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:06:11.190

使类别视图中的产品集合难以定制的原因之一是工具栏、分层导航、实际列表显示甚至与`Mage_Review`模块之间的耦合，该模块*在事件观察器中显式加载集合！*

起初，您似乎可以使用典型的收集实用程序（例如`addAttributeToSort()`）来添加您的条件，但您会发现这在模板级别不起作用，因为*已经加载了收集数据*。我推测被命名的集合 getter 方法是`getLoadedProductCollection()`来自核心团队的提示。

Magento 集合的延迟加载实现是这样的，一旦它们被`load()`编辑（直接或间接），它们不会重新加载（即与数据库进行事务处理），除非明确强制这样做。

因此，您需要在集合加载之前设置您的排序参数。跟踪该`getLoadedProductCollection()`方法可以快速找到该`Mage_Catalog_Block_Product_List::_getProductCollection()`方法，这是该块确定它是否在产品页面上的地方（通过检查注册表，哎呀）。通过调用栈跟踪collection的状态，可以确定直到block的`_beforeToHtml()`method才被加载。如果您要从输出中追溯，您可以看到该集合是由 Mage_Review 观察者显式加载的，该观察者使用该`catalog_block_product_list_collection`事件（请参阅参考资料`Mage_Review_Model_Observer::catalogBlockProductCollectionBeforeToHtml()`）。这给出了起点和终点。

我希望以后有一个解决方案。

# visual-studio - 如何在启动时中断进程

> ID：10359038
> 
> 赞同：0
> 
> 时间：2012-04-27T23:10:49.290
> 
> 标签：visual-studio

使用 Visual Studio，您可以附加到正在运行的进程，点击“暂停”（或称为中断），即使没有符号文件或源代码，您也可以暂停该进程并看到反汇编视图。

我想实现这一点，但在过程的一开始。尽快连接和暂停不是我正在寻找的解决方案:)

例如，如果应用程序是基于控制台的 c++ 应用程序，gdb 可以在 main() [或它可以找到的任何命名函数] 上设置断点。可以用visual studio做类似的事情吗？

但是这个问题是针对更一般的情况的——我希望能够启动一个进程并让它在进入时立即暂停（在内核启动进程之后立即）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:39:14.517

[http://blogs.msdn.com/b/greggm/archive/2008/09/12/attaching-a-debugger-at-startup.aspx](http://blogs.msdn.com/b/greggm/archive/2008/09/12/attaching-a-debugger-at-startup.aspx)

有一定程度的支持。但如果我是你，我会直接使用 WinDbg。

# css - 为什么 IE 不显示 position:absolute 就像它应该显示的那样？

> ID：10359040
> 
> 赞同：0
> 
> 时间：2012-04-27T23:11:04.890
> 
> 标签：css, internet-explorer

Internet Explorer 9 未正确显示绝对定位的元素。父级是相对的，因此绝对元素应该相对于父级 div 是“绝对的”。但是，它的行为更接近“固定”行为。当我尝试在所涉及的元素上触发 hasLayout 时，它会显示内联的所有内容。

有问题的元素是 .programs-list div，当您单击一个地区，然后单击一个国家/地区时，它会出现。

这发生在所有版本的 IE 中。

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:24:28.703

分析完您的 HTML 结构后，您需要使用 a 设置您`div#main-wrapper`的`position:relative`，以便将弹出窗口保留在地图区域上。

**CSS**

```
#main-wrapper {
  position: relative;
} 
```

# amazon-s3 - 无法使用refinerycms 建立本地S3 上传

> ID：10359053
> 
> 赞同：2
> 
> 时间：2012-04-27T23:14:14.750
> 
> 标签：amazon-s3, refinerycms, fog

我在 application.rb 中设置了 ENV 变量

```
ENV['S3_KEY']='key'
ENV['S3_SECRET']='secret'
ENV['S3_BUCKET']='myapp-development' 
```

我已将“雾”宝石添加到我的 Gemfile

```
gem 'fog' 
```

我已将此添加到 development.rb 的最后

```
Refinery::Core.config.s3_backend = true 
```

而且，通过实验，我还将我的 S3 密钥和秘密添加到我的 bash_profile 中：

```
export S3_KEY=key
export S3_SECRET=secret 
```

无论如何，当我上传文件时，它们不会进入我的 S3 存储桶，而是（我假设）存储在本地。这是上传文件的日志操作：

```
Started POST "/refinery/images?dialog=true" for 127.0.0.1 at 2012-04-27 19:07:46 -0400
Processing by Refinery::Admin::ImagesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"bofz2fukPA6e/olwZ2zXlkdj/apaxZ69aZnh6xSGkT4=", "image"=>{"image"=>[#<ActionDispatch::Http::UploadedFile:0x007f9d54045c60 @original_filename="4.jpeg", @content_type="image/jpeg", @headers="Content-Disposition: form-data; name=\"image[image][]\"; filename=\"4.jpeg\"\r\nContent-Type: image/jpeg\r\n", @tempfile=#<File:/var/folders/zv/h2w4bghn3gj_5t9ws6x7s6r40000gn/T/RackMultipart20120427-36682-ptku7o>>]}, "wymeditor"=>"", "modal"=>"true", "dialog"=>"true", "app_dialog"=>"true", "field"=>"", "update_image"=>"", "thumbnail"=>"", "callback"=>"", "conditions"=>"", "locale"=>:en}
  Refinery::Role Load (0.6ms)  SELECT "refinery_roles".* FROM "refinery_roles" WHERE "refinery_roles"."title" = 'Refinery' LIMIT 1
  Refinery::User Load (0.7ms)  SELECT "refinery_users".* FROM "refinery_users" INNER JOIN "refinery_roles_users" ON "refinery_users"."id" = "refinery_roles_users"."user_id" WHERE "refinery_roles_users"."role_id" = 1
  Refinery::User Load (0.4ms)  SELECT "refinery_users".* FROM "refinery_users" WHERE "refinery_users"."id" = 1 LIMIT 1
  Refinery::UserPlugin Load (0.3ms)  SELECT "refinery_user_plugins".* FROM "refinery_user_plugins" WHERE "refinery_user_plugins"."user_id" = 1 ORDER BY position ASC
  Refinery::Role Load (0.8ms)  SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users"."user_id" = 1
   (0.2ms)  BEGIN
  SQL (3.1ms)  INSERT INTO "refinery_images" ("created_at", "image_ext", "image_height", "image_mime_type", "image_name", "image_size", "image_uid", "image_width", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["created_at", Fri, 27 Apr 2012 23:07:47 UTC +00:00], ["image_ext", nil], ["image_height", 320], ["image_mime_type", "image/jpeg"], ["image_name", "4.jpeg"], ["image_size", 46220], ["image_uid", "2012/04/27/19/07/47/673/4.jpeg"], ["image_width", 480], ["updated_at", Fri, 27 Apr 2012 23:07:47 UTC +00:00]]
   (0.6ms)  COMMIT
  Rendered text template within layouts/refinery/admin_dialog (0.0ms)
  Rendered refinery/_html_tag.html.erb (0.3ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-core-2.0.3/app/views/refinery/admin/_dialog_success.html.erb (0.6ms)
Completed 200 OK in 1127ms (Views: 99.4ms | ActiveRecord: 6.7ms)
cache: [GET /refinery/images/new?app_dialog=true&dialog=true] miss
cache: [GET /refinery/images/new?app_dialog=true&dialog=true] miss

Started GET "/refinery/images/new?app_dialog=true&dialog=true" for 127.0.0.1 at 2012-04-27 19:07:47 -0400
Processing by Refinery::Admin::ImagesController#new as HTML
  Parameters: {"app_dialog"=>"true", "dialog"=>"true", "locale"=>:en}
  Refinery::Role Load (0.5ms)  SELECT "refinery_roles".* FROM "refinery_roles" WHERE "refinery_roles"."title" = 'Refinery' LIMIT 1
  Refinery::User Load (0.7ms)  SELECT "refinery_users".* FROM "refinery_users" INNER JOIN "refinery_roles_users" ON "refinery_users"."id" = "refinery_roles_users"."user_id" WHERE "refinery_roles_users"."role_id" = 1
  Refinery::User Load (0.6ms)  SELECT "refinery_users".* FROM "refinery_users" WHERE "refinery_users"."id" = 1 LIMIT 1
  Refinery::UserPlugin Load (0.5ms)  SELECT "refinery_user_plugins".* FROM "refinery_user_plugins" WHERE "refinery_user_plugins"."user_id" = 1 ORDER BY position ASC
  Refinery::Role Load (0.6ms)  SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users"."user_id" = 1
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-core-2.0.3/app/views/refinery/admin/_error_messages.html.erb (0.1ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-core-2.0.3/app/views/refinery/admin/_form_actions.html.erb (1.0ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-images-2.0.3/app/views/refinery/admin/images/_form.html.erb (13.9ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-images-2.0.3/app/views/refinery/admin/images/new.html.erb within layouts/refinery/admin_dialog (16.9ms)
  Rendered refinery/_html_tag.html.erb (0.2ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-core-2.0.3/app/views/refinery/admin/_javascripts.html.erb (3.0ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-core-2.0.3/app/views/refinery/admin/_head.html.erb (9.9ms)
  Rendered refinery/_message.html.erb (0.6ms)
Completed 200 OK in 64ms (Views: 49.0ms | ActiveRecord: 2.9ms)
[2012-04-27 19:07:47] ERROR Errno::ECONNRESET: Connection reset by peer
  /Users/anonymouscoward/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:80:in `eof?'
  /Users/anonymouscoward/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:80:in `run'
  /Users/anonymouscoward/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'
cache: [GET /refinery/images?_=1335568067618] miss
cache: [GET /refinery/images?_=1335568067618] miss

Started GET "/refinery/images?_=1335568067618" for 127.0.0.1 at 2012-04-27 19:07:47 -0400
Processing by Refinery::Admin::ImagesController#index as */*
  Parameters: {"_"=>"1335568067618", "locale"=>:en}
  Refinery::Role Load (1.4ms)  SELECT "refinery_roles".* FROM "refinery_roles" WHERE "refinery_roles"."title" = 'Refinery' LIMIT 1
  Refinery::User Load (3.0ms)  SELECT "refinery_users".* FROM "refinery_users" INNER JOIN "refinery_roles_users" ON "refinery_users"."id" = "refinery_roles_users"."user_id" WHERE "refinery_roles_users"."role_id" = 1
  Refinery::User Load (0.9ms)  SELECT "refinery_users".* FROM "refinery_users" WHERE "refinery_users"."id" = 1 LIMIT 1
  Refinery::UserPlugin Load (0.5ms)  SELECT "refinery_user_plugins".* FROM "refinery_user_plugins" WHERE "refinery_user_plugins"."user_id" = 1 ORDER BY position ASC
  Refinery::Role Load (0.6ms)  SELECT "refinery_roles".* FROM "refinery_roles" INNER JOIN "refinery_roles_users" ON "refinery_roles"."id" = "refinery_roles_users"."role_id" WHERE "refinery_roles_users"."user_id" = 1
   (0.5ms)  SELECT COUNT(*) FROM "refinery_images" 
  Refinery::Image Load (0.5ms)  SELECT "refinery_images".* FROM "refinery_images" ORDER BY created_at DESC LIMIT 20 OFFSET 0
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-images-2.0.3/app/views/refinery/admin/images/_grid_view.html.erb (11.3ms)
  Rendered /Users/anonymouscoward/.rvm/gems/ruby-1.9.3-p125@refinerycms/gems/refinerycms-images-2.0.3/app/views/refinery/admin/images/_images.html.erb (40.6ms)
  Rendered text template within layouts/refinery/flash (0.0ms)
  Rendered refinery/_message.html.erb (1.6ms)
Completed 200 OK in 96ms (Views: 11.3ms | ActiveRecord: 7.6ms)
cache: [GET /system/images/BAhbB1sHOgZmSSIjMjAxMi8wNC8yNy8xOS8wNy80Ny82NzMvNC5qcGVnBjoGRVRbCDoGcDoKdGh1bWJJIg4xMzV4MTM1I2MGOwZU/4.jpeg] miss, store
cache: [GET /system/images/BAhbB1sHOgZmSSIjMjAxMi8wNC8yNy8xOS8wNy80Ny82NzMvNC5qcGVnBjoGRVRbCDoGcDoKdGh1bWJJIg4xMzV4MTM1I2MGOwZU/4.jpeg] miss, store

Started GET "/system/images/BAhbB1sHOgZmSSIjMjAxMi8wNC8yNy8xOS8wNy80Ny82NzMvNC5qcGVnBjoGRVRbCDoGcDoKdGh1bWJJIg4xMzV4MTM1I2MGOwZU/4.jpeg" for 127.0.0.1 at 2012-04-27 19:07:47 -0400
cache: [GET /assets/refinery/icons/application_edit.png] stale, valid, store
cache: [GET /assets/refinery/icons/application_edit.png] stale, valid, store

Started GET "/assets/refinery/icons/application_edit.png" for 127.0.0.1 at 2012-04-27 19:07:48 -0400
Served asset /refinery/icons/application_edit.png - 304 Not Modified (10ms)
[2012-04-27 19:07:48] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
cache: [GET /assets/refinery/icons/accept.png] stale, valid, store
cache: [GET /assets/refinery/icons/accept.png] stale, valid, store

Started GET "/assets/refinery/icons/accept.png" for 127.0.0.1 at 2012-04-27 19:07:48 -0400
Served asset /refinery/icons/accept.png - 304 Not Modified (8ms)
[2012-04-27 19:07:48] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
cache: [GET /assets/refinery/icons/eye.png] stale, valid, store
cache: [GET /assets/refinery/icons/eye.png] stale, valid, store

Started GET "/assets/refinery/icons/eye.png" for 127.0.0.1 at 2012-04-27 19:07:48 -0400
Served asset /refinery/icons/eye.png - 304 Not Modified (8ms)
[2012-04-27 19:07:48] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true
cache: [GET /assets/refinery/icons/delete.png] stale, valid, store
cache: [GET /assets/refinery/icons/delete.png] stale, valid, store

Started GET "/assets/refinery/icons/delete.png" for 127.0.0.1 at 2012-04-27 19:07:48 -0400
Served asset /refinery/icons/delete.png - 304 Not Modified (5ms)
[2012-04-27 19:07:48] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:16:10.597

这可能是几件事。首先是启动控制台并确保在 Rails 加载后所有的 ENV 变量都设置正确。我认为这不是问题，但首先检查它是一个很好的诊断方法。

其次，当您在控制台中时，检查`Refinery::Core.s3_backend`. 它返回真实吗？可能是将此语句放在您的`development.rb`文件中会导致它在`config/initializers/refinery/core.rb`运行时被覆盖。无论如何，这可能是您应该设置 s3_backend 值的地方。

# django - Django 模型 - 为数据库准备数据

> ID：10359056
> 
> 赞同：1
> 
> 时间：2012-04-27T23:14:26.403
> 
> 标签：django, django-models

我有一个要求提供电话号码的表格。我需要确保只有数字 [0-9] 保存在数据库中。

在 Django[文档](https://docs.djangoproject.com/en/dev/ref/models/instances/)中它说：

保存时会发生什么？

3) 为数据库准备数据。要求每个字段以可以写入数据库的数据类型提供其当前值。

这是怎么发生的？或者更具体地说，我如何确保已清洁？我知道我可以重写模型保存方法，但似乎有更好的方法，我只是不知道该怎么做。

我想我可以为它写一个自定义字段，但这似乎有点过分了。

另外，我意识到我可以将验证放在表单上，​​但感觉就像剥离了模型上的字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:44:02.370

您关于第 3 点的具体问题与 django 使用该术语的方式中的“清洁”略有不同。

> 3) 为数据库准备数据。要求每个字段以可以写入数据库的数据类型提供其当前值。

第 3 点是关于将 python 对象值转换为适合数据库的值。具体来说，这是在`Field.get_prep_value`和`Field.get_db_prep_value`

[https://docs.djangoproject.com/en/dev/howto/custom-model-fields/#django.db.models.Field.get_prep_value](https://docs.djangoproject.com/en/dev/howto/custom-model-fields/#django.db.models.Field.get_prep_value)

相反，`to_python`它采用 DB 值并将其转换为 python 对象。

至于确保只存储数字 0-9，这将在`Field`s`clean`方法（子类 IntegerField）、form`clean`方法、form`clean_FIELDNAME`方法或 model中完成`clean`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T23:29:31.140

您可以将自定义表单清理方法添加到您的对象模型 - 看看这篇文章[https://docs.djangoproject.com/en/dev/ref/forms/validation/#form-field-default-cleaning](https://docs.djangoproject.com/en/dev/ref/forms/validation/#form-field-default-cleaning)

查看“清理特定字段属性”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T23:34:17.747

使用[django模型表单](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/)+[自定义表单字段清理](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)

下面是您可能正在寻找的一个快速示例，`MyModel`包含电话号码字段的模型在哪里，我`tel`在这里命名它。

```
import re

class MyForm(ModelForm):
    class Meta:
        model = MyModel

    def clean_tel(self):
        tel = self.cleaned_data.get('tel', '')  # this is from user input

        # use regular expression to check if tel contains only digits; you might wanna enhance the regular expression to restrict the tel number to have certain number of digits.
        result = re.match(r'\d+', tel)  
        if result:
            return tel  # tel is clean so return it
        else:
            raise ValidationError("Phone number contains invalid character.") 
```

# php - mkdir 创建多个子目录 php/apache

> ID：10359058
> 
> 赞同：2
> 
> 时间：2012-04-27T23:14:46.700
> 
> 标签：php, linux, apache, mkdir

```
mkdir ("dir1/{dir1-1,dir1-2}",0755,TRUE); 
```

此命令使用名为“{dir1-1,dir1-2}”的单个子文件夹创建文件夹 dir1，而不是将 dir1-1 和 dir1-2 创建为 dir1 的两个子文件夹。

知道如何通过上面的单个 mkdir 命令使其工作吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T23:33:53.447

PHP 不像 shell 那样支持大括号扩展。如果你想创建多个目录，你将不得不`mkdir()`多次调用，你可以通过循环轻松地做到这一点。

您可以将`TRUE`第三个参数传递给`mkdir()`- 这意味着如果备份树的所有目录不存在并且父级可写，则它们也将被创建。在循环中操作时，您可以安全地传递`TRUE`给所有调用，给定目录的第一次迭代将创建它，后续调用不会产生不利影响。

例如：

```
$toCreate = array(
  'dir1/dir1-1',
  'dir1/dir1-2'
);

$permissions = 0755;

foreach ($toCreate as $dir) {
  mkdir($dir, $permissions, TRUE);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T23:30:39.307

shell mkdir 可以做：

```
mkdir -p /foo/bar/peng 
```

所以现在你可以从 php.ini 中调用外部 shell 命令。但要注意安全。

# mysql - 如果可能，我们如何避免在纯 SQL 中重新准备语句？

> ID：10359062
> 
> 赞同：0
> 
> 时间：2012-04-27T23:16:00.090
> 
> 标签：mysql, prepared-statement

在思考关于 SO 的另一个问题的潜在解决方案时，我开始考虑在过程中使用准备好的语句（函数中没有动态 SQL 让我感到难过）。在过程中执行 a 的幼稚方法`PREPARE`似乎效率低下，因为只需要在会话期间第一次调用过程时准备语句。MySQL 是否可以仅在它不存在的情况下准备语句？有没有办法检查准备好的语句是否存在？

这是供人们玩耍的示例程序。它创建一个语句，该语句包含`SELECT`给定表中给定类型的所有列。

```
DROP PROCEDURE IF EXISTS select_columns_of_type_statement;
delimiter //
CREATE PROCEDURE select_columns_of_type_statement(IN db VARCHAR(255), IN tbl VARCHAR(255), IN type VARCHAR(255), OUT result VARCHAR(4095))
  READS SQL DATA
  NOT DETERMINISTIC -- as tables can be ALTERed
BEGIN
    SET @scots_db=db, @scots_tbl=tbl, @scots_type=type;
    PREPARE generate_scots FROM "SELECT CONCAT(
          'SELECT ',
          GROUP_CONCAT(COLUMN_NAME SEPARATOR ', '),
          ' FROM `', ?, '`.`', ?, '` '
          )
      FROM INFORMATION_SCHEMA.COLUMNS
      WHERE TABLE_SCHEMA=? AND TABLE_NAME=? AND data_type=?
      INTO @scots_stmt";
    EXECUTE generate_scots USING @scots_db, @scots_tbl, @scots_db, @scots_tbl, @scots_type;
    SET result = @scots_stmt;
END //
delimiter ; 
```

示例用法：

```
CALL select_columns_of_type_statement('mysql', 'user', 'int', @stmt);
SELECT @stmt;
-- or even:
SET @stmt=CONCAT(@stmt, 'LIMIT 3');
PREPARE user_int_cols FROM @stmt;
EXECUTE user_int_cols; 
```

必须使用这么多用户变量也让我感到难过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T04:47:40.307

检查存在可能是不可能的，但尝试和处理失败模式将起作用。[`DECLARE`](http://dev.mysql.com/doc/refman/5.1/en/declare-handler.html)一个错误处理程序，它定义 & 执行准备好的语句，并在处理程序之外执行准备好的语句。如果该语句不存在，则错误处理程序将运行。它不漂亮，但它有效。

```
DROP PROCEDURE IF EXISTS select_columns_of_type_statement;
delimiter //
CREATE PROCEDURE select_columns_of_type_statement(IN db VARCHAR(255), IN tbl VARCHAR(255), IN type VARCHAR(255), OUT result VARCHAR(4095))
  READS SQL DATA
  NOT DETERMINISTIC -- as tables can be ALTERed
BEGIN
    DECLARE CONTINUE HANDLER
      FOR 1243
      BEGIN
        PREPARE generate_scots FROM "SELECT CONCAT(
              'SELECT ',
              GROUP_CONCAT(COLUMN_NAME SEPARATOR ', '),
              ' FROM `', ?, '`.`', ?, '` '
              )
          FROM INFORMATION_SCHEMA.COLUMNS
          WHERE TABLE_SCHEMA=? AND TABLE_NAME=? AND data_type=?
          INTO @scots_stmt";
        EXECUTE generate_scots USING @scots_db, @scots_tbl, @scots_db, @scots_tbl, @scots_type;
      END;
    SET @scots_db=db, @scots_tbl=tbl, @scots_type=type;
    EXECUTE generate_scots USING @scots_db, @scots_tbl, @scots_db, @scots_tbl, @scots_type;
    SET result = @scots_stmt;
END //
delimiter ; 
```

# macos - dyld：库未加载：/opt/local/lib/libglib-2.0.0.dylib

> ID：10359063
> 
> 赞同：0
> 
> 时间：2012-04-27T23:16:10.223
> 
> 标签：macos, linker, static-linking

我已经为 OSX 编译了 MDB-Tools，但是当我尝试在另一台计算机上运行示例命令行程序时，我得到了这个错误：

dyld：库未加载：/opt/local/lib/libglib-2.0.0.dylib 引用自：/Users/dev/mdb/mdb-test 原因：找不到图像 Trace/BPT 陷阱：5

我相信这意味着目标系统缺少一个库，我认为它与链接有关，但我并不完全肯定如何解决这个问题。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:46:42.193

/opt/local 目录通常由 MacPorts 使用。您编译的程序依赖于来自 MacPorts 的 glib。您要么需要在要运行程序的机器上安装它，要么需要将您的程序和它所依赖的所有库捆绑在一起。

检查 Apple 的[动态库编程主题](https://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/DynamicLibraries/000-Introduction/Introduction.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-26T12:45:29.850

是的，我在 Mac 上升级 vim 时遇到了类似的问题。

```
$ vi linkedlist.cc
dyld: Library not loaded: /usr/local/opt/python/Frameworks/Python.framework/Versions/3.6/Python
  Referenced from: /usr/local/bin/vim
  Reason: image not found
Abort trap: 6 
```

为了解决这个问题，我尝试升级软件包。

```
$ brew update
Already up-to-date.

$ brew upgrade 
```

它在进行升级后开始工作。

# c - linux上的unix域套接字？

> ID：10359067
> 
> 赞同：5
> 
> 时间：2012-04-27T23:16:31.503
> 
> 标签：c, sockets, network-programming

以下来自[http://www.thomasstover.com/uds.html](http://www.thomasstover.com/uds.html)的 unix 域套接字客户端和服务器示例在我的 slackware linux 机器上无法正常工作。我得到这个输出：

```
$ ./server1 
$

$ ./client1 
MESSAGE FROM SERVER: hello from a client 
```

我希望服务器从客户端打印消息 hello，而客户端从服务器打印 hello。

我的操作系统和编译器如下：

```
$ uname -a                                                                                                    
Linux temeraire 2.6.37.6-smp #2 SMP Sat Apr 9 23:39:07 CDT 2011 i686 Intel(R) Xeon(R) CPU           E3110  @ 3.00GHz Ge
nuineIntel GNU/Linux
$ gcc -v
Reading specs from /usr/lib/gcc/i486-slackware-linux/4.5.2/specs
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/i486-slackware-linux/4.5.2/lto-wrapper
Target: i486-slackware-linux
Configured with: ../gcc-4.5.2/configure --prefix=/usr --libdir=/usr/lib --mandir=/usr/man --infodir=/usr/info --enable-
shared --enable-bootstrap --enable-languages=ada,c,c++,fortran,java,objc,lto --enable-threads=posix --enable-checking=r
elease --with-system-zlib --with-python-dir=/lib/python2.6/site-packages --disable-libunwind-exceptions --enable-__cxa_
atexit --enable-libssp --enable-lto --with-gnu-ld --verbose --with-arch=i486 --target=i486-slackware-linux --build=i486
-slackware-linux --host=i486-slackware-linux
Thread model: posix
gcc version 4.5.2 (GCC) 
```

服务器.c：

```
#include <stdio.h>
#include <sys/socket.h>
#include <sys/un.h>
#include <sys/types.h>
#include <unistd.h>
#include <string.h>

int connection_handler(int connection_fd)
{
 int nbytes;
 char buffer[256];

 nbytes = read(connection_fd, buffer, 256);
 buffer[nbytes] = 0;

 printf("MESSAGE FROM CLIENT: %s\n", buffer);
 nbytes = snprintf(buffer, 256, "hello from the server");
 write(connection_fd, buffer, nbytes);

 close(connection_fd);
 return 0;
}

int main(void)
{
 struct sockaddr_un address;
 int socket_fd, connection_fd;
 socklen_t address_length;
 pid_t child;

 socket_fd = socket(PF_UNIX, SOCK_STREAM, 0);
 if(socket_fd < 0)
 {
  printf("socket() failed\n");
  return 1;
 } 

 unlink("./demo_socket");

 /* start with a clean address structure */
 memset(&address, 0, sizeof(struct sockaddr_un));

 address.sun_family = AF_UNIX;
 snprintf(address.sun_path, UNIX_PATH_MAX, "./demo_socket");

 if(bind(socket_fd, 
         (struct sockaddr *) &address, 
         sizeof(struct sockaddr_un)) != 0)
 {
  printf("bind() failed\n");
  return 1;
 }

 if(listen(socket_fd, 5) != 0)
 {
  printf("listen() failed\n");
  return 1;
 }

 while((connection_fd = accept(socket_fd, 
                               (struct sockaddr *) &address,
                               &address_length)) > -1)
 {
  child = fork();
  if(child == 0)
  {
   /* now inside newly created connection handling process */
   return connection_handler(connection_fd);
  }

  /* still inside server process */
  close(connection_fd);
 }

 close(socket_fd);
 unlink("./demo_socket");
 return 0;
} 
```

客户端.c：

```
#include <stdio.h>
#include <sys/socket.h>
#include <sys/un.h>
#include <unistd.h>
#include <string.h>

int main(void)
{
 struct sockaddr_un address;
 int  socket_fd, nbytes;
 char buffer[256];

 socket_fd = socket(PF_UNIX, SOCK_STREAM, 0);
 if(socket_fd < 0)
 {
  printf("socket() failed\n");
  return 1;
 }

 /* start with a clean address structure */
 memset(&address, 0, sizeof(struct sockaddr_un));

 address.sun_family = AF_UNIX;
 snprintf(address.sun_path, UNIX_PATH_MAX, "./demo_socket");

 if(connect(socket_fd, 
            (struct sockaddr *) &address, 
            sizeof(struct sockaddr_un)) != 0)
 {
  printf("connect() failed\n");
  return 1;
 }

 nbytes = snprintf(buffer, 256, "hello from a client");
 write(socket_fd, buffer, nbytes);

 nbytes = read(socket_fd, buffer, 256);
 buffer[nbytes] = 0;

 printf("MESSAGE FROM SERVER: %s\n", buffer);

 close(socket_fd);

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T05:31:19.200

正如[Dietrich Epp 提到](https://stackoverflow.com/questions/10359067/unix-domain-sockets-on-linux#comment-13348678)的，您未能初始化在服务器代码中`address_length`传递给的参数。`accept`根据[手册页](http://linux.die.net/man/2/accept)，该参数既是输入参数又是输出参数：在输入时，您告诉它您的地址结构有多大（这样它就知道在告诉您连接客户端的地址时不会将内存写入越界） ，并在输出时告诉您地址实际有多大。

要解决此问题，`address_length`请`sizeof(address)`在调用`accept`. 您还应该对每次调用都执行此操作`accept`，因为可以修改变量。例如：

```
while(1)
{
  address_length = sizeof(address);
  if((connection_fd = accept(..., &address_length)) == -1)
  {
    printf("accept error: %s\n", strerror(errno));
    break;
  }
  ...
} 
```

我能够重现您的问题，即显式初始化`address_length`为 ( 的无效值`sockaddr_t)-1`，这导致错误（无效参数）`accept`失败`EINVAL`，但奇怪的是它直到客户端尝试连接后才失败。当客户端尝试连接时，它实际上成功了，但是当它尝试写入套接字时，失败了`ECONNRESET`（“对等连接重置”）。

另一个关键点是您应该始终检查您的返回值。在处理socket代码的时候，故障点很多，学究气是要付出代价的。如果系统调用失败，它将返回 -1 并设置`errno`为适当的值。您可以使用该[`strerror`函数](http://linux.die.net/man/3/strerror)将错误代码转换为人类可读的消息，就像我在上面的示例中所做的那样。

# c# - 使用 LINQ 获取最后 x 个连续项目

> ID：10359069
> 
> 赞同：1
> 
> 时间：2012-04-27T23:17:11.623
> 
> 标签：c#, .net, linq

我的问题与此类似：[Find Consecutive Items in List using Linq](https://stackoverflow.com/questions/7112435/finding-consecutive-items-in-list-using-linq)。除了，我想获得最后一个没有间隙的连续项目。例如：

```
2, 4, 7, 8 
```

输出

```
7,8 
```

另一个例子：

```
4,5,8,10,11,12 
```

输出

```
10,11,12 
```

怎么可能呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-27T23:52:38.077

我假设您想要最后一个具有多个成员的连续序列......所以从序列

```
{4, 5, 8, 10, 11, 12, 15} 
```

你期待的顺序：

```
{10, 11, 12} 
```

如果最后一个序列只允许有一个成员，我已经指出要删除的行，给出一个序列

```
{15} 
```

这是linq：

```
new[] {4, 5, 8, 10, 11, 12, 15}
    .Select((n,i) => new {n, i})
    .GroupBy(x => x.n - x.i) //this line will group consecutive nums in the seq
    .Where(g => g.Count() > 1) //remove this line if the seq {15} is expected
    .Select(x => x.Select(xx => xx.n))
    .LastOrDefault() 
```

这里有一个隐藏的假设，即序列的数字是按升序排列的。如果不是这种情况，则有必要注册 microsoft 扩展方法的权限，以[查找序列中的连续项目](http://msdn.microsoft.com/en-us/library/cc138361.aspx)。让我知道是否是这种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T00:05:12.240

在这种情况下，这很有效，并且可能比 LINQ 更容易和更有效：

```
var list = new[] { 2, 4, 7, 8 };
List<int> lastConsecutive = new List<int>();
for (int i = list.Length - 1; i > 0; i--)
{
    lastConsecutive.Add(list[i]);
    if (list[i] - 1 != list[i - 1])
        break;
    if(i==1 && list[i] - 1 == list[i - 1]) // needed since we're iterating just until 1
        lastConsecutive.Add(list[0]);
}
lastConsecutive.Reverse(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T03:47:12.013

我意识到这既晚又罗嗦，但这可能是这里仍然使用 LINQ 的最快方法。

测试清单：

```
var list1 = new List<int> {2,4,7,8};
var list2 = new List<int> {4,5,8,10,11,12,15}; 
```

方法：

```
public List<int> LastConsecutive(List<int> list)
{
    var rev = list.AsEnumerable().Reverse();

    var res = rev.Zip(rev.Skip(1), (l, r) => new { left = l, right = r, diff = (l - r) })
                 .SkipWhile(x => x.diff != 1)
                 .TakeWhile(x => x.diff == 1);

    return res.Take(1).Select(x => x.left)
              .Concat(res.Select(x => x.right))
              .Reverse().ToList();
} 
```

这个从后到前并成对检查元素，仅从它们开始连续（the `SkipWhile`）直到它们结束连续（the `TakeWhile`）获取元素。

然后它会做一些工作来提取相关的成对数字（“原始”列表中的左侧数字，然后是所有正确的数字），并将其反转回来。与命令式版本的效率相似，但在我看来，由于 LINQ 更易于阅读。

# ruby-on-rails - form_for [@parent, @child] 在 Child#new 中导致未定义的方法 `parent_child_path'

> ID：10359071
> 
> 赞同：-2
> 
> 时间：2012-04-27T23:17:22.713
> 
> 标签：ruby-on-rails, ruby-on-rails-3

所以一个用户有很多大学（他们就读过），一个大学属于一个用户。我将这些学院称为college_profile，因为它们是用户个人资料的学院属性。

我在尝试创建一所新学院时遇到了问题。我现在的大学控制器非常简单：

```
def new
  @user = User.find(params[:id])
  @college = current_user.college_profile.build if signed_in?
end 
```

视图同样简单：(views/college_profiles/new.html.erb)

```
<%= form_for [@user, @college] do |f| %>
   <%= render 'shared/error_messages', object: f.object %>
   <%= f.label :name %>
 <% end %> 
```

然而，由于某种原因，我收到以下错误：

```
NoMethodError in College_profiles#new

Showing .../app/views/college_profiles/new.html.erb where line #4 raised:

undefined method `user_college_profiles_path' for #<#<Class:0x5bf1b68>:0x673aef8> 
```

由于我还在学习 Rails，我什至不明白这个错误到底指的是什么。相当多的谷歌搜索让我没有运气，或者如果答案*就*在那里，我根本就没有意识到我在看它。任何帮助将不胜感激！

如果它是相关的，当我们谈论路径时，这是我的路线文件的摘录：

```
resources :users, :only => [:index, :new, :create, :destroy, :update, :edit] do
  resources :college_profiles, :only => [:new, :create]
end 
```

如果需要更多信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:38:25.660

问题`form_for`是它的 URL 基于您传入的模型。在您的情况下，它是：

```
<%= form_for [@user, @college] do |f| %> 
```

Rails 会自动查找，因为`user_college_profiles_path`您指定`User`了`@user`和`current_user.college_profile`。`@college`

幸运的是，Rails 提供了一种方法来覆盖表单在提交时将转到的默认 URL：

```
<%= form_for([@user, @college], :url => your_custom_route_path) do |f| %> 
```

您需要做的就是`your_custom_route`在您的`routes.rb`

来源：[Ruby on Rails 指南：Rails 表单助手](http://guides.rubyonrails.org/form_helpers.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:23:17.340

Rails 正在尝试创建一个用于将数据从表单发布到控制器的路径。它正在寻找的操作是创建，但您的路线中只有新定义的。如果您的控制器名为 CollegeProfiles，那么您需要将嵌套路由更改为：

```
resources :college_profiles, :only => [:new, :create] 
```

# networking - 如何测量局域网中两台机器之间的延迟

> ID：10359074
> 
> 赞同：1
> 
> 时间：2012-04-27T23:17:39.733
> 
> 标签：networking, latency

我有一个服务器和一个客户端在 2 台 Unix 机器上运行。它们可以是局域网中的两台机器，也可以是相距很远的两台机器，并在 VLAN 中连接。客户端只接收数据包，服务器只发送。（UDP或TCP）

如何以编程方式测量它们之间的延迟？

一种方法是在发送前在数据包上添加时间戳，但不能保证时钟同步。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:19:40.170

如果您的通信是严格单向的并且时钟不同步，您就无法做到这一点。

您可以引入一个从客户端发送到服务器的新数据包，询问“现在几点？” 服务器将响应其时间，客户端将响应时间除以 2 以获得单向延迟。作为附带的好处，客户端可以找出服务器认为的时间。

# asp.net-mvc-3 - 通过以下方式对 ASP.NET MVC 代码进行单元测试可能会出现哪些问题？

> ID：10359080
> 
> 赞同：4
> 
> 时间：2012-04-27T23:18:24.227
> 
> 标签：asp.net-mvc-3, unit-testing

我一直在研究[NuGetGallery](https://github.com/NuGet/NuGetGallery/blob/master/Facts/Services/MessageServiceFacts.cs)中单元测试的完成方式。我观察到当控制器被测试时，服务类被模拟了。这对我来说很有意义，因为在测试控制器逻辑时，我不想担心下面的架构层。在使用这种方法一段时间后，我注意到当我的服务类发生变化时，我经常在我的控制器测试中修复我的模拟。为了解决这个问题，在没有咨询比我聪明的人的情况下，我开始编写这样的测试（别担心，我还没有做到这一点）：

```
public class PersonController : Controller
{
    private readonly LESRepository _repository;

    public PersonController(LESRepository repository)
    {
        _repository = repository;
    }

    public ActionResult Index(int id)
    {
        var model = _repository.GetAll<Person>()
            .FirstOrDefault(x => x.Id == id);

        var viewModel = new VMPerson(model);
        return View(viewModel);
    }
}

public class PersonControllerTests
{
    public void can_get_person()
    {
        var person = _helper.CreatePerson(username: "John");
        var controller = new PersonController(_repository);
        controller.FakeOutContext();

        var result = (ViewResult)controller.Index(person.Id);
        var model = (VMPerson)result.Model;
        Assert.IsTrue(model.Person.Username == "John");
    }
} 
```

我想这将是集成测试，因为我使用的是真实数据库（我更喜欢内存数据库）。我通过将数据放入我的数据库来开始我的测试（每个测试都在一个事务中运行，并在测试完成时回滚）。然后我打电话给我的控制器，我真的不在乎它如何从数据库中检索数据（通过存储库或服务类），只是要发送到视图的模型必须具有我放入数据库的记录，也就是我的断言. 这种方法很酷的一点是，很多时候我可以继续添加更多的复杂层，而无需更改我的控制器测试：

```
public class PersonController : Controller
{
    private readonly LESRepository _repository;
    private readonly PersonService _personService;

    public PersonController(LESRepository repository)
    {
        _repository = repository;
        _personService = new PersonService(_repository);
    }

    public ActionResult Index(int id)
    {
        var model = _personService.GetActivePerson(id);
        if(model  == null)
          return PersonNotFoundResult();

        var viewModel = new VMPerson(model);
        return View(viewModel);
    }
} 
```

现在我意识到我没有为我的 PersonService 创建一个接口并将它传递给我的控制器的构造函数。原因是 1）我不打算模拟我的 PersonService 和 2）我觉得我不需要注入我的依赖项，因为我的 PersonController 现在只需要依赖一种类型的 PersonService。

我是单元测试的新手，我总是很高兴被证明我错了。请指出为什么我测试控制器的方式可能是一个非常糟糕的主意（除了我的测试运行时间明显增加）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T02:52:49.467

唔。伙计，这里有几件事。

首先，看起来您正在尝试测试控制器方法。伟大的 ：）

所以这意味着，控制器需要的任何东西都应该被模拟。这是因为

1.  您不想担心在该依赖项中会发生什么。
2.  您可以验证依赖项是否被调用/执行。

好的，让我们看看你做了什么，我会看看我是否可以重构它以使其更具可测试性。

-记住-我正在测试*CONTROLLER METHOD*，而不是控制器方法调用/依赖的东西。

所以这意味着我不关心服务实例或存储库实例（无论您决定遵循哪种架构方式）。

注意：我把事情简单化了，所以我去掉了很多废话等等。

### 界面

首先，我们需要一个存储库的接口。这可以实现为内存中的存储库、实体框架存储库等。您很快就会明白为什么。

```
public interface ILESRepository
{
    IQueryable<Person> GetAll();
} 
```

### 控制器

在这里，我们使用接口。`IRepository`这意味着使用模拟或真实实例非常容易且很棒。

```
public class PersonController : Controller
{
    private readonly ILESRepository _repository;

    public PersonController(ILESRepository repository)
    {
       if (repository == null)
       {
           throw new ArgumentNullException("repository");
       }
        _repository = repository;
    }

    public ActionResult Index(int id)
    {
        var model = _repository.GetAll<Person>()
            .FirstOrDefault(x => x.Id == id);

        var viewModel = new VMPerson(model);
        return View(viewModel);
    }
} 
```

### 单元测试

好的 - 这是神奇的金钱射击的东西。首先，我们创建了一些 Fake People。在这里和我一起工作......我会告诉你我们在哪里使用它。这只是一个无聊、简单的`POCO`'s 列表。

```
public static class FakePeople()
{
    public static IList<Person> GetSomeFakePeople()
    {
        return new List<Person>
        {
            new Person { Id = 1, Name = "John" },
            new Person { Id = 2, Name = "Fred" },
            new Person { Id = 3, Name = "Sally" },
        }
    }
} 
```

现在我们有了测试本身。我正在使用`xUnit`我的测试框架和`moq`我的模拟。任何框架都可以，在这里。

```
public class PersonControllerTests
{
    [Fact]
    public void GivenAListOfPeople_Index_Returns1Person()
    {
        // Arrange.
        var mockRepository = new Mock<ILESRepository>();
        mockRepository.Setup(x => x.GetAll<Person>())
                                   .Returns(
                                FakePeople.GetSomeFakePeople()
                                          .AsQueryable);
        var controller = new PersonController(mockRepository);
        controller.FakeOutContext();

        // Act.
        var result = controller.Index(person.Id) as ViewResult;

        // Assert.
        Assert.NotNull(result);
        var model = result.Model as VMPerson;
        Assert.NotNull(model);
        Assert.Equal(1, model.Person.Id);
        Assert.Equal("John", model.Person.Username);

        // Make sure we actually called the GetAll<Person>() method on our mock.
        mockRepository.Verify(x => x.GetAll<Person>(), Times.Once());
    }
} 
```

好的，让我们看看我做了什么。

首先，我整理我的废话。我首先创建了一个`ILESRepository`. 然后我说：如果有人调用该`GetAll<Person>()`方法，那么......不要 - 真的 - 访问数据库或文件或其他任何东西......只需返回一个人员列表，该列表创建于`FakePeople.GetSomeFakePeople()`.

所以这就是控制器中会发生的事情......

```
var model = _repository.GetAll<Person>()
                       .FirstOrDefault(x => x.Id == id); 
```

首先，我们要求我们的模拟点击该`GetAll<Person>()`方法。我只是“设置”以返回人员列表......所以我们有一个包含 3 个`Person`对象的列表。接下来，我们`FirstOrDefault(...)`在这个 3 个对象的列表上调用 a `Person`.. 它返回单个对象或 null，具体取决于 的值`id`是什么。

多田！这就是金钱射击:)

现在回到单元测试的其余部分。

我们`Act`，然后我们`Assert`。那里没什么难的。对于奖励积分，我`verify`实际上`GetAll<Person>()`在控制器方法内的模拟中调用了该`Index`方法。这是一个安全调用，以确保我们的控制器逻辑（我们正在测试）正确完成。

有时，您可能想要检查不良情况，例如有人传入了不良数据。这意味着您可能永远不会使用模拟方法（这是正确的），因此您`verify`永远不会调用它们。

好的 - 问题，上课？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T23:55:29.933

即使你不打算模拟一个接口，我强烈建议你不要通过在构造函数中创建对象来隐藏对象的真正依赖关系，你正在破坏单一责任原则并且你正在编写不可测试的代码。

编写测试时要考虑的最重要的事情是：“编写测试没有万能钥匙”。有很多工具可以帮助你编写测试，但真正的努力应该放在**编写可测试的代码**上，而不是试图*破解*我们现有的代码来编写一个通常最终成为集成测试而不是单元测试的测试.

在构造函数中创建新对象是您的代码不可测试的第一个重要信号。

当我过渡到开始编写测试时，这些链接帮助了我很多，让我告诉你，在你开始之后，这将成为你日常工作的自然部分，你会喜欢编写测试的好处不再编写没有测试的代码

清洁代码指南（在 Google 中使用）： http: [//misko.hevery.com/code-reviewers-guide/](http://misko.hevery.com/code-reviewers-guide/)

要获取更多信息，请阅读以下内容：

[http://misko.hevery.com/2008/09/30/to-new-or-not-to-new/](http://misko.hevery.com/2008/09/30/to-new-or-not-to-new/)

并观看来自 Misko Hevery 的视频

[http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded](http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded)

编辑：

Martin Fowler 的这篇文章解释了 Classical 和 Mockist TDD 方法之间的区别

[http://martinfowler.com/articles/mocksArentStubs.html](http://martinfowler.com/articles/mocksArentStubs.html)

作为总结：

*   经典的 TDD 方法：这意味着在不创建替代项或替身（模拟、存根、假人）的情况下尽可能测试所有内容，但 Web 服务或数据库等外部服务除外。经典测试人员仅对外部服务使用双打

    *   好处：当您测试时，您实际上是在测试应用程序的接线逻辑和逻辑本身（不是孤立的）
    *   缺点：如果发生错误，您可能会看到数百个测试失败，并且很难找到负责的代码
*   Mockist TDD 方法：遵循 Mockist 方法的人将隔离测试所有代码，因为他们将为每个依赖项创建双精度

    *   好处：您正在隔离测试应用程序的每个部分。如果发生错误，您可以确切地知道它发生在哪里，因为只有少数测试会失败，理想情况下只有一个
    *   缺点：您必须将所有依赖项加倍，这会使测试变得更加困难，但您可以使用 AutoFixture 等工具自动为依赖项创建双打

这是另一篇关于编写可测试代码的好文章

[http://www.loosecouplings.com/2011/01/how-to-write-testable-code-overview.html](http://www.loosecouplings.com/2011/01/how-to-write-testable-code-overview.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T23:58:01.803

有一些缺点。

首先，当您有一个依赖于外部组件（如实时数据库）的测试时，该测试不再是真正可预测的。它可能由于多种原因而失败 - 网络中断、数据库帐户密码更改、缺少一些 DLL 等。因此，当您的测试突然失败时，您无法立即确定缺陷在*哪里*。是数据库问题吗？你班上的一些棘手的错误？

当您只需知道哪个测试失败就可以立即回答该问题时，您就拥有了令人羡慕的[缺陷定位](http://xunitpatterns.com/Goals%20of%20Test%20Automation.html#Defect%20Localization)质量。

其次，如果存在*数据库*问题，所有依赖它的测试都会立即失败。这可能不是那么严重，因为您可能会意识到原因是什么，但我保证它会减慢您检查每个原因的速度。广泛的失败可以掩盖真正的问题，因为您不想查看 50 个测试中的每一个的异常。

而且我知道您想了解除执行时间之外的其他因素，但这确实很重要。您希望尽可能频繁地运行您的测试，而较长的运行时间不鼓励这样做。

我有两个项目：一个在 10 秒内运行 600 多个测试，一个在 50 秒内运行 40 多个测试（这个项目实际上是故意与数据库对话）。*我在开发时更*频繁地运行更快的测试套件。猜猜我觉得哪一个更容易使用？

综上所述，测试外部组件是有价值的。只是不是在您进行单元测试时。集成测试更脆弱，更慢。这使它们更加昂贵。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-27T23:59:48.450

在单元测试中访问数据库会产生以下后果：

1.  **性能**。填充数据库并访问它很慢。您进行的测试越多，等待的时间就越长。如果您使用模拟，您的控制器测试可能会在几毫秒内运行，而如果它直接使用数据库则需要几秒钟。
2.  **复杂性**。对于共享数据库，您必须处理多个代理针对同一数据库运行测试的并发问题。需要配置数据库，需要创建结构，填充数据等。它变得相当复杂。
3.  **覆盖范围**。您会发现，如果不进行模拟，几乎不可能测试某些条件。示例可能包括验证数据库超时时要执行的操作。或者如果发送电子邮件失败怎么办。
4.  **维护**。对数据库模式的更改，尤其是频繁更改，将影响几乎所有使用数据库的测试。刚开始有 10 个测试时，它可能看起来不多，但请考虑当您有 2000 个测试时。您可能还会发现更改业务规则和调整测试更加复杂，因为您必须修改数据库中填充的数据以验证业务规则。

您必须询问测试业务规则是否值得。在大多数情况下，答案可能是“否”。

我遵循的方法是：

1.  通过模拟依赖关系和模拟可能发生的条件（如数据库错误等）来实现单元类（控制器、服务层等）。这些测试验证了业务逻辑，旨在尽可能多地覆盖决策路径。使用[PEX](http://research.microsoft.com/en-us/projects/pex/)之类的工具来突出显示您从未想过的任何问题。在修复 PEX 突出显示的一些问题后，您会惊讶于您的应用程序会变得多么健壮（和弹性）。
2.  编写数据库测试以验证我使用的 ORM 是否适用于底层数据库。您会对 EF 和其他 ORM 与某些数据库引擎（和版本）的问题感到惊讶。这些测试对于调优性能和减少发送到数据库的查询和数据量也很有用。
3.  编写编码的 UI 测试，使浏览器自动化并验证系统是否实际工作。在这种情况下，我会事先用一些数据填充数据库。这些测试只是自动化了我手动完成的测试。目的是验证关键部分是否仍然有效。

# php - 如何设置 zend 模块化应用程序

> ID：10359082
> 
> 赞同：0
> 
> 时间：2012-04-27T23:18:31.340
> 
> 标签：php, zend-framework, module

我试图建立一个zend模块化应用程序我的实际目录结构是这样的：

```
\Application
\Application\modules
\Application\modules\admin
\Application\modules\admin\...
\Application\modules\admin\Bootstrap.php
\Application\modules\front
\Application\modules\front\...
\Application\modules\front\Bootstrap.php
\... 
```

我的 application.ini 文件包含：

```
[production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
includePaths.library = APPLICATION_PATH "/../library"
bootstrap.path = APPLICATION_PATH "/modules/front/Bootstrap.php"
bootstrap.class = "Front_Bootstrap"
appnamespace = "Application"

resources.modules[] =
resources.view[] =

;FrontController Resource Settings
;resources.frontcontroller.controllerDirectory = APPLICATION_PATH "/modules/front/controllers"
resources.frontController.defaultController = "index"
resources.frontController.defaultAction = "index"
resources.frontController.defaultModule = "front"
resources.frontController.prefixDefaultModule = true
resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.frontController.params.displayExceptions = 1

resources.db.adapter = "pdo_mysql"
resources.db.params.host = "localhost"
resources.db.params.username = "root"
resources.db.params.password = "test"
resources.db.params.dbname = "dbname"

;resources.layout.layoutPath = APPLICATION_PATH "/layouts/front/scripts"
resources.layout.layout = "layout"

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
resources.frontController.params.displayExceptions = 1 
```

当我试图访问[http://mywebserver/appname/public/](http://mywebserver/appname/public/)我得到这个错误：

```
Fatal error: Uncaught exception 'Zend_Application_Bootstrap_Exception' with message 'No default controller directory registered with front controller' in C:\wamp\www\go\library\Zend\Application\Bootstrap\Bootstrap.php on line 91 
```

任何人都可以帮助PLZ！提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T06:40:29.700

也许**取消注释**您的`resources.frontcontroller.controllerDirectory = APPLICATION_PATH`“/modules/front/controllers”并尝试更改：

```
resources.frontController.defaultController = "index" 
```

至：

```
resources.frontController.defaultControllerName = "index" 
```

因为记录的参数是[defaultControllerName](http://framework.zend.com/manual/en/zend.application.available-resources.html#zend.application.available-resources.frontcontroller)。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T11:05:39.470

似乎问题在于它自己的引导程序：我为每个模块放置了 1 个引导程序文件……当我删除它们并只留下主引导程序文件时，它工作正常。谢谢你的回答。

# css - 将鼠标悬停在父元素上时是否可以设置子元素的样式？

> ID：10359085
> 
> 赞同：0
> 
> 时间：2012-04-27T23:19:09.367
> 
> 标签：css, css-selectors

我想修改`.childElement`何时`.parentElement:hover`被触发的样式。

像这样的东西：

```
<style type="text/css">
.parentElement:hover {
  .childElement {
   display:block;
  }
}
</style>
<div class="parentElement">
  <div class="childElement"></div>
</div> 
```

是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T23:21:31.323

我认为您正在寻找：

```
.parentElement:hover .childElement {
  display:block;
} 
```

***注意：** CSS 目前不支持嵌套，但是，[它是计划](http://dev.w3.org/csswg/css3-hierarchies/)中的。目前，建议的语法如下：*

```
.parentElement:hover {
  /* Note the ampersand (&) */
  & .childElement {
   display:block;
  }
} 
```

# c# - WP7中使用IsolatedStorageFileStream时保存的文件在哪里

> ID：10359090
> 
> 赞同：0
> 
> 时间：2012-04-27T23:19:43.947
> 
> 标签：c#, file, windows-phone-7, save, isolatedstorage

我正在尝试通过 silverlight 代码将一些文本文件写入 WP7 中的隔离存储。我想稍后以某种方式检索文件并保存到 PC 上。我如何查看和获取它？有某种文件浏览器吗？它真正保存到了哪里？

```
 using (var store = IsolatedStorageFile.GetUserStoreForApplication())
        {
            store.CreateDirectory("MyOutput");

            using (var stream = new IsolatedStorageFileStream("MyOutput\\data.txt",
                                                  FileMode.OpenOrCreate,
                                                  FileAccess.Write,
                                                  store)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T02:28:13.557

另一种选择是使用`ISETool.exe`7.1 SDK 附带的独立存储资源管理器工具 ( )。它是一个命令行驱动的工具`C:\Program Files\Microsoft SDKs\Windows Phone\v7.1\Tools\IsolatedStorageExplorerTool\`（`C:\Program Files (x86)\Microsoft SDKs\Windows Phone\v7.1\Tools\IsolatedStorageExplorerTool`在 64 位机器上）。要与应用程序的独立存储进行交互，您需要指定它是否应该连接到物理设备或模拟器以及产品 ID（在 WMAppManifest.xml 文件中指定的 GUID）。例如。从你的模拟器下载所有文件给`C:\Foo\`你使用；

```
ISETool.exe ts xd {ProductID Here} C:\Foo 
```

不带参数运行`ISETool`以获得有关其确切用法的帮助。`ts`这里代表“Take Snapshot”，其他选项是`rs`（Restore Snapshot）和`dir`（list contents）。`xd`是“模拟器”并且`de`是“设备”。

运行此程序后，您可以导航到`C:\Foo`并查看应用程序的独立存储的确切内容。

它比 wp7explorer 工具需要更多的麻烦，但不需要您链接到程序集或进行任何代码修改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T23:23:01.513

您可以使用此[工具](http://wp7explorer.codeplex.com/)并在安装后`launch`运行您的文件`application`以查找他的`saved`文件。

如果你想如何安装和使用可以参考[这里](http://www.windowsphonegeek.com/tips/Using-the-Windows-Phone-Isolated-Storage-Explorer-tool)

# windows - 像这样工作的 Windows 函数：Linux queue_delayed_work(workq, dwork, delay)

> ID：10359093
> 
> 赞同：0
> 
> 时间：2012-04-27T23:20:07.837
> 
> 标签：windows, queue, delayed-job, nonblocking

```
Queue_delayed_work is a non blocking "timer" function which will queue `dwork` after `delay` jiffies. 
```

我找不到任何相同的非阻塞函数 WIN API。

知道是否有某些功能，我不知道。或者如何实现这样的事情（一个非阻塞的“计时器”，它*至少*`dwork`会在几秒钟`workq`后排队。 *`delay`*

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T17:36:19.053

对于 Linux 用户空间，只有 teo 系统调用允许设置计时器，而不会同时阻塞事件的调用进程：

```
-timer_set_time
-Alarm 
```

对于 Win 内核，

可以用 KTIMER 实现

```
KTIMER (Wdm.h)
KeInitializeTimer(PKTIMER Timer):
Timer: Pointer to a timer object, for which the caller provides the storage.
KeSetTimer (PKTIMER Timer, LARGE_INTEGER DueTimer, **PKDPC Dpc**) 
```

对于 Win 用户空间，

可以用等待定时器对象实现：

```
BOOL SetWaitableTimer(
HANDLE hTimer, // handle to a timer object
const LARGE_INTEGER *pDueTime, // when timer will become signaled
LONG lPeriod, // periodic timer interval
PTIMERAPCROUTINE pfnCompletionRoutine, // pointer to the completion routine
LPVOID lpArgToCompletionRoutine, // data passed to the completion routine
BOOL fResume // flag for resume state    
); 
```*

# objective-c - 使用 NSData 和 base64 编码的 Soap 请求

> ID：10359097
> 
> 赞同：0
> 
> 时间：2012-04-27T23:20:35.583
> 
> 标签：objective-c, ios, soap, base64, sudzc

我正在使用 sudzc 肥皂类与远程 Web 服务进行通信。大多数请求都有效，但我在传输数据时遇到问题：

我必须发送一些以 base64 编码的数据，我以这种方式分配一个 NsData 对象：

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"little_amount_of_data" ofType:@"dat"];  
NSData* dummy = [NSData dataWithContentsOfFile:filePath];
[service sendAudioFile:self action:@selector(sendAudioFileHandler:) username: self.username password: self.password fileBytes: dummy numBytes: [dummy base64Encoding].length audioTimestamp: [NSString stringWithFormat:@"%0.f",[[NSDate date]timeIntervalSince1970]]]; 
```

SOAP 请求看起来正确（数据正确编码，长度正确），但我从服务器接收到此响应（我认为是 iis7，我无权访问它）：

> 不可能的 elaborare la richiesta。---> Offset e lunghezza eccedono i limiti della matrice o il conteggio è maggiore del numero di elementi presenti dall'indice alla fine dell'insieme di origine。

翻译：

> 无法处理请求。---> 偏移量和长度超出数组的限制或计数大于源末尾索引的项目数。

如果客户端发送一个 void base64 字符串 (lenght=0)，服务器会回复一条成功语句。

WSDL 将该字段描述为**base64Binary** 我正在使用 NSData+Base64.h/NSData+Base64.m

有什么提示吗？是客户端故障还是服务器故障？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:33:53.683

解决了，问题很长。我正在发送编码文件的长度，网络服务想要原始文件的长度。

# php - 将 Web 表单推送到 vTiger

> ID：10359098
> 
> 赞同：1
> 
> 时间：2012-04-27T23:20:41.297
> 
> 标签：php, mysql, vtiger

我创建了一个在 vTiger 之外的网络表单，我想将其推送到 vTiger 使用的数据库中。

这是将数据推送到数据库的 SQL 代码：

```
$sql="INSERT INTO vtiger_potential(potentialname)VALUES('$company_name', '$potential_no')"; 
```

这是我似乎得到的错误：

```
Cannot add or update a child row: a foreign key constraint fails (`vtigercrm530/vtiger_potential`, CONSTRAINT `fk_1_vtiger_potential` FOREIGN KEY (`potentialid`) REFERENCES `vtiger_crmentity` (`crmid`) ON DELETE CASCADE) 
```

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T09:50:06.483

1.  为什么不使用 webforms 模块。您只需使用一些规则创建您的网络表单，然后将表单发送到“您的站点链接”/modules/Webforms/post.php。优点是所有工作都由 crm 基本功能完成，并确保所有安全措施（小心用户输入数据！！！）Webforms 的示例形式如下：

![在此处输入图像描述](../Images/750c40be8dea617a12490c9799734f16.png)

您也可以在潜在客户模块中添加具有相应名称的其他输入。对于自定义字段，您可以通过 firebug (cf_*) 检查名称。2\. 如果您想在数据库中执行此操作，请考虑所有 vtiger 实体（联系人、潜在客户等）在 crm_entity 中具有特定 id，因此 crm_entity 包含不同实体的所有 id。在创建潜在客户实体之前，您必须创建其 crm_entity 行，然后将 new_insert_id 传递给潜在客户相关表。但是要小心，以防将来在 crm 中出现任何问题，您可能不确定是否是您的错（直接操作数据库）！

# c# - 在 LINQ 查询中使用 Contains() 时出现异常

> ID：10359106
> 
> 赞同：1
> 
> 时间：2012-04-27T23:22:10.940
> 
> 标签：c#, linq, entity-framework

我在尝试使以下工作时遇到问题。我尝试了 2 种不同的方式，都可以编译，但都在运行时抛出异常。

解决方案 A 抛出

> NotSupportedException “LINQ to Entities 无法识别方法 'MyDB.MemberClass GetMemberClass(MyDB.Member, System.DateTime)' 方法，并且此方法无法转换为存储表达式。”

解决方案 B 抛出

> NotSupportedException “LINQ to Entities 不支持 LINQ 表达式节点类型 'Invoke'。”

这是我的代码：

```
 public delegate string GetClassShortName(Member m, DateTime d);

    private void UserControl_Initialized(object sender, EventArgs e)
    {
        //Solution A
        var members = from m in dbContext.Members
                      where new[] { "A", "P", "S", "J" }.Contains(MemberHelper.GetMemberClass(m, DateTime.Now).ShortName)
                      orderby m.Line
                      select m;

        //Solution B
        GetClassShortName gcsn = (n,d) => (MemberHelper.GetMemberClass(n, d).ShortName);
        var members = dbContext.Members.Where(m => new[] { "A", "P", "S", "J" }.Contains(gcsn(m, DateTime.Now)));

        foreach (Member m in members)
        {
            ... 
```

我正在尝试获取具有一组值内的“类”的成员。（A、P、S、J）。成员的班级取决于您想要的日期，因为它会随着时间的推移而变化。因此，该类存储在不同的表中，我使用 MemberHelper.GetMemberClass 函数来获取指定日期的类。（在这种情况下，现在）

* * *

**新解决方案**

我放弃了尝试使用 LINQ 完成所有工作，并按如下方式更改了我的代码。可能有一种更优雅的方法可以做到这一点，但它确实有效。

```
 var data = from mj in this.dbContext.MemberJournals
                      where mj.Effective <= date
                      orderby mj.Member.Line, mj.Effective
                      select mj;

        foreach (MemberJournal mj in data)
        {
            if (mj.ClassID == MemberHelper.GetMemberClass(mj.Member, date).ID)
            {
                if (new[] { "A", "P", "J", "S" }.Contains(mj.MemberClass.ShortName.Trim()))
                {
                    //Perform my Task
                    ...
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T23:27:24.083

您不能在旨在转换为 SQL 的代码中调用任意 C# 方法。可以翻译成 SQL 的代码是其他有效 C# 的一个*非常*有限的子集。

# assembly - gdb中具有奇怪值的变量

> ID：10359107
> 
> 赞同：0
> 
> 时间：2012-04-27T23:22:14.730
> 
> 标签：assembly, gdb, x86, nasm

我有点“菜鸟”，但我不明白为什么“print WeirdValue”会使用以下代码返回“16777216”（1000000000000000000000000）：

```
section .data

    Var db 0

    WeirdValue db 0 
```

当在

```
section .data

    Var  dd 0

    WeirdValue db 0 
```

它返回正确的“0”。

我在 64 位系统上，我正在使用命令

```
nasm -f elf32 
```

用于组装代码。

有人有线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T23:35:35.850

“db”声明一个字节。16777216 不适合一个字节，因此您的打印函数正在打印一个 dword（可以用您在第二个示例中使用的“dd”声明）。它正在打印正确的值（即低位字节为 0），它打印奇数的原因是因为在地址 [WeirdValue + 3] 处有一个字节当时包含 0x01。

编辑-我注意到您两次都使用“db”-我的猜测是后一个代码使 WeirdValue 更接近 8 字节对齐值的边界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T12:33:36.463

问题解决了。正如 Score_Under 所指出的，“print WeirdValue”将变量打印为双字，而它是一个字节；不知道为什么。我只是用“x /b &WeirdValue”（/b = byte）检查变量的值。

谢谢你的帮助 ;-）。

# asp.net-mvc - asp.net MVC 3 错误：“对象引用未设置为对象的实例”

> ID：10359108
> 
> 赞同：0
> 
> 时间：2012-04-27T23:22:17.140
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有一个这样的 AccountController

```
public class AccountController : Controller
{
    [Authorize]
    public ActionResult MyProfile(string userEmail)
    {
        UserManager um = new UserManager();
        UserProfile user = new UserProfile();
        user = um.GetUserDetail(userEmail);
        return View(user);
    } 
 } 
```

我有 UserManager.cs 像这样

```
public class UserManager
{
    private ToLetDBEntities TLE = new ToLetDBEntities();
     public UserProfile GetUserDetail(string uemail)
    {
        var userDetails = TLE.users.FirstOrDefault(x => x.email_add == uemail);

        UserProfile up = new UserProfile();
        up.cellno = userDetails.cellno.Trim();
        up.email_add = userDetails.email_add.Trim();
        up.name = userDetails.name.Trim();
        up.password = userDetails.password.Trim();

        return up;
    }
} 
```

当我调试时，它会给出错误

> 对象引用未设置为对象的实例
> Null Reference Exception was Unhandled by User

在线上

```
up.cellno=userDetails.cellno.Trim(); 
```

的`GetUserDetails`功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:28:06.937

该错误表明您没有`userDetails`实例，因此您无法获取该`cellno`属性。

你确定那`TLE.users.FirstOrDefault(x => x.email_add == uemail)`是返回的东西吗？如果你在给出错误的行上放置一个断点，那么你可以检查它的值`userDetails`是什么——它可能是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:29:14.647

这个查询很可能没有返回任何内容：

```
TLE.users.FirstOrDefault(x => x.email_add == uemail); 
```

如果没有返回记录，该`FirstOrDefault`方法不会给出任何指示。该`OrDefault`部分指定了这种行为。对于任何给定的返回类型，如果没有找到记录，它将返回该类型的“默认值”。

对于引用类型（您的引用类型），默认值为`null`. 所以这个调用会导致这个异常：

```
userDetails.cellno.Trim(); 
```

既然如此`userDetails`，它就`null`无法访问`cellno`属性，因此出现异常。

在您的情况下，也*有可能*`userDetails` *不是* `null`，但它的`cellno`属性*是*. 这不太可能，但可能。在调试时查看运行时值会告诉您是否是这种情况。

如果`userDetails`是`null`，请检查您的查询条件。也许`users`收藏中什么都没有？也许没有符合您`x.email_add == uemail`条件的记录？（这很可能。）

如果`cellno`是，`null`那么您将要检查该对象的构建方式、数据库中的数据是什么样的等等。无论哪种方式，您都无法取回您期望的数据。问题在于您正在访问的数据。

# c# - 警告码 cs0618 和 cs0612 有什么区别

> ID：10359117
> 
> 赞同：18
> 
> 时间：2012-04-27T23:23:58.773
> 
> 标签：c#, compiler-errors, error-code

我已经看到以下两个警告代码都被抛出以使用标记为过时的代码。

[cs0618](http://msdn.microsoft.com/en-us/library/x5ye6x1e.aspx)和[cs0612](http://technet.microsoft.com/en-us/library/h0h063ka%28v=VS.90%29.aspx)。

根据文档，0618 是 2 级，0612 是 1 级。有谁知道这些代码之间的区别是什么以及是什么导致一个被抛出而不是另一个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-27T23:28:54.633

我认为不同之处在于一个包含消息而另一个不包含消息。

```
[Obsolete]                                  // CS0612
[Obsolete("Use newMethod instead", false)]  // CS0618
[Obsolete("Use newMethod instead", true)]   // CS0619 
```

# ruby - 为什么我会收到 NoMethodError？

> ID：10359121
> 
> 赞同：0
> 
> 时间：2012-04-27T23:24:29.887
> 
> 标签：ruby, function, methods

```
class UnitCircle
    def prompt
        puts "Enter a number: "
        @number = gets
        @number = @number.to_i
        puts "Enter a trigonometric equation to perform on that number: "
        @eqn = gets
    end
end
uc = UnitCircle.new
uc.prompt
num = Math.send(uc.instance_eval {@eqn}, uc.instance_eval {@number}) 
```

当我尝试运行它时，

```
@number = 30
@eqn = sin 
```

我得到一个无方法错误，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:29:19.383

```
class UnitCircle
    def prompt
        puts "Enter a number: "
        @number = gets.chomp
        @number = @number.to_i
        puts "Enter a trigonometric equation to perform on that number: "
        @eqn = gets.chomp
    end
end 
```

`gets`方法将包括新行符号“\n”。所以你必须这样`chomp`做。如果你不咀嚼，你最终会调用方法“sin\n”而不是“sin”

# objective-c - UIImages 的 NSMutableArray - 视图停留在最后一张图片上

> ID：10359122
> 
> 赞同：0
> 
> 时间：2012-04-27T23:24:58.000
> 
> 标签：objective-c, uiimageview, uiimage, nsmutablearray

我确定我在这里遗漏了一些非常简单的东西......

我第一次很好地遍历图像，索引重置并正确递增，但 UIView 不会刷新并保持数组中的最后一个图像显示。transitionFromView：自动交换子视图，对吧？我需要实现 completion: 选项吗？

我错过了什么？这是相关的代码：

```
 - (id)initWithFrame:(CGRect)frame
    {
        NSInteger maxSlides = 12;
        self = [super initWithFrame: frame];
        if (self) {
            //set up an array of images to be used for a flipbook    
            slides = [[NSMutableArray alloc] initWithCapacity: maxSlides]; 

            for(NSInteger i=0; i<maxSlides; ++i) {
               imageView = [[UIImageView alloc] initWithImage:                
               [UIImage imageNamed:[NSString stringWithFormat: @"muybridge%d.png", i]]];

               [slides addObject: imageView];
            } 

            index = 0; //default to first photo.

            [self addSubview: [slides objectAtIndex: index]];
         }
         return self;
     }

    - (void) touchesEnded: (NSSet *) touches withEvent: (UIEvent *) event 
    {    
         //output indices for debugging. (yes, they increment properly)
         NSLog(@"index = %d", index);
         NSLog(@"currentIndex = %d", currentIndex);
         NSLog(@"nextIndex = %d", nextIndex);

         if (nextIndex <= 10) {
           currentIndex = nextIndex;
         } else {
            currentIndex = 0;
         }    
         nextIndex = currentIndex + 1;

         //flipbook - tapping the image transitions to the next image in the array  
         [UIView transitionFromView: [slides objectAtIndex: currentIndex]
                    toView: [slides objectAtIndex: nextIndex]
                    duration: 0
                    options: UIViewAnimationOptionTransitionCurlUp
                    completion: NULL
          ];
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T05:17:10.747

你所缺少的是这个，来自 transitionFromView: toView:... 上的文档：

fromView 转换的起始视图。默认情况下，此视图作为过渡的一部分从其父视图中删除。

所以它在第一次通过时有效，但在您查看完所有子视图后，只有一个子视图，即最后一个子视图。查看 UIViewAnimationOptionShowHideTransitionViews 选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:11:33.003

根据Apple参考`UIView: transitionFromView: toView:...`：

> 此方法仅修改视图层次结构中的视图。它不会以任何方式修改应用程序的视图控制器。例如，如果您使用此方法更改视图控制器显示的根视图，则您有责任适当地更新视图控制器以处理更改。

也许尝试在之后立即调用该`[yourView setNeedsDisplay]`方法。

# gnome - GNOME API 是否存储在 *.so 文件中？

> ID：10359126
> 
> 赞同：0
> 
> 时间：2012-04-27T23:25:21.837
> 
> 标签：gnome

就像 Windows 的 API 在 kernel.dll、user32.dll 等中一样，GNOME API 是否存储在 *.so 文件中？

如果有，他们在哪里？我可以在我的程序中将它们用作共享库吗？

如果不是，它们是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:31:45.293

.so 是称为动态库的“共享对象”，不同于静态库的“.a”。我认为在 Windows 系统中只有 .dll （动态链接库）。

Gnome API，因为 gnome 只是一个桌面环境，它利用其他软件元素，如 Nautilus（它的窗口管理器）等。有可执行文件和库（我想混合在静态和动态之间。此外，它将使用其他库，如 libpng 或 libjpeg用于图像、用于声音等的 libalsa 以及用于 GUI 的 GTK（gnome 工具包）

最后，它们中的更多可能位于 /usr/lib /usr/share/lib /usr/X11/lib ... 和类似路径中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:50:49.233

GNOME 只是一个桌面环境——它为您提供了管理桌面、在窗口管理器之上、在 X.org 之上管理窗口等的高级功能。

没有一组（单一且定义明确的）GNOME API：您使用来自各种项目的各种库。一般来说，GNOME 的东西使用 GTK+ 作为他们的图形库，加上许多其他的库，有些是 GNOME\GTK 特定的，而另一些则更通用。您可以在这里查看信息 [1]

在您的系统上，您会在某个位置的 .so 对象中找到它们的二进制文件（例如，在 /usr/lib、/usr/share/lib 等中）。

要在您的程序中**使用**它们，您必须`#include`使用相应的头文件，例如`#include <gtk/gtk.h>`使用 GTK 库（在许多发行版中默认情况下不安装头文件，例如在 Debian 和 Ubuntu 中，您必须`lib{libraryname}-dev`使用 apt-get 下载软件包）。

要**编译**，您必须告诉链接器和编译器您要编译的库在哪里。为此，您可以使用`pkg-config`[2] 为大多数库找到正确的 gcc`-L`和`-I`开关（或者您可以设置您的 IDE - 或指示您的 Makefile - 这样做）

[1] [http://developer.gnome.org/](http://developer.gnome.org/)

[2] [https://en.wikipedia.org/wiki/Pkg-config](https://en.wikipedia.org/wiki/Pkg-config)

# c++ - 电路交换的数据结构？

> ID：10359134
> 
> 赞同：0
> 
> 时间：2012-04-27T23:27:15.610
> 
> 标签：c++, data-structures, maps

我想创建这样的东西：

我有一个模块可以为消息流执行类似“电路切换”的操作。也就是说，它有一个入口和多个出口。一旦消息到达输入端口，就会根据某种逻辑选择输出端口（逻辑在问题的上下文中并不重要）。检查输出端口上是否有任何正在进行的消息传输（对于第一条消息，不会有任何消息）。如果没有传输，则将消息发送到该输出端口，否则，它将保留在该特定输出端口的队列中。我需要决定这种通信的数据结构。请指教

我的想法是有一个出口和相应队列的地图。

```
queue<message> m_incoming_queue;
typedef map<outport*,m_incoming_queue> transaction_map 
```

如果这是一个好的解决方案，我想知道如何在运行时创建队列？如，我事先不知道会有多少个出口，我根据需要创建出口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:53:00.987

也许是这样的：

```
// At beginning
typedef queue<message> MessageQueue
typedef map<outport*, MessageQueue> transaction_map
transaction_map tm()  // Create the transaction map

// On receipt of each message
// (Some logic that determines outport* op and message m)
if(tm.count(*op) == 0)
{
    // There are no queues yet, create one and insert it
    tm.insert(transaction_map::value_type(*op, MessageQueue()))
}
// There is already a queue created, so add to it
tm[*op].push(m) 
```

# spring - Spring MVC可以使用@RequestMapping注解根据httpsession参数匹配url

> ID：10359136
> 
> 赞同：1
> 
> 时间：2012-04-27T23:27:26.870
> 
> 标签：spring, attributes, mapping, overriding

我需要根据 http 会话属性将 @RequestMapping 映射到两个不同的控制器方法。

我看到 @RequestMapping 基于值、方法、参数和标题进行匹配。有没有办法根据会话属性进行映射？

如果我使用参数，我需要强制客户端发送请求参数，例如：aVersion=1 或 aVersion=2。

如果有任何示例可以覆盖@RequestMapping？你能指点我吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:41:51.497

是和不是。您可以将`HttpSession`参数添加到控制器中的方法。来自[Spring MVC 文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-methods)：

> 会话对象（Servlet API）：HttpSession 类型。这种类型的参数强制存在相应的会话。因此，这样的论点永远不会为空。

但是，您必须手动进行会话属性检查 afaik：

```
@RequestMapping("/some_url")
void someMethod(HttpSession session) {

    Object firstAttr = session.getAttribute("firstAttribute");
    if (firstAttr != null) {
        doSomethingWithFirstAttribute(firstAttr);
    }

    Object secondAttr = session.getAttribute("secondAttribute");
    if (secondAttr != null) {
        doSomethingWithSecondAttribute(secondAttr);
    }
} 
```

# visual-studio - 将带有代码片段的环绕应用于项目数量？

> ID：10359139
> 
> 赞同：1
> 
> 时间：2012-04-27T23:27:50.010
> 
> 标签：visual-studio, code-snippets

有没有办法将带有代码片段的环绕应用于项目数量？例如，假设我有多个超链接项目，并且我希望每个项目都包含在`<li> </li>.` 我可以选择它们并将每个项目包围在`li`标签中吗？

例如：给定

```
<a href="" >a</a><a href="" >a</a><a href="" >a</a><a href="" >a</a> 
```

在调用为“ `<a>`”标签项的数量截取的代码后，结果应该是：

```
<li><a href="" >a</a></li><li><a href="" >a</a></li><li><a href="" >a</a></li> 
```

# android - Android：忽略自签名证书错误；实际执行？

> ID：10359140
> 
> 赞同：2
> 
> 时间：2012-04-27T23:27:50.227
> 
> 标签：android, ssl, ssl-certificate

像这里的许多人一样，我正在尝试与具有自签名证书的站点进行通信。有许多类和代码片段展示了如何做到这一点，例如[HTTPS GET (SSL) with Android and self-signed server certificate](https://stackoverflow.com/questions/3761737/https-get-ssl-with-android-and-self-signed-server-certificate)，但我找不到任何展示如何实际使用这些类的东西。我已经做了很多实验，但我确定我只是错过了一些简单的东西。

具体来说，我正在尝试使用“Moss”提供的类；得票最多的答案。我仍然总是收到“不受信任的证书”消息。该主题的其他人也要求提供实施提示，但尚未得到答复。谢谢你的帮助。

如果我可以将此问题附加到该主题，我会更高兴，但我想像我这样的新手只能发布新问题（尽管我已经成为 SO 的粉丝一年多了）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:45:45.267

我们在一些项目中使用了类似`SocketFactory`的实现。`X509TrustManager`为了将这些类绑定到您的实现，您基本上需要做的就是将它们连接到`HttpClient`用于客户端-服务器通信的（假设这是您正在使用的）。

我们通常有一种方法来`HttpClient`使用提到的工厂和信任管理器创建一个。它看起来有点像这样，并且大致基于内联注释中显示的链接。

```
protected HttpClient constructClient() {
    HttpParams params = new BasicHttpParams();
    params.setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);

    // use the debug proxy to view internet traffic on the host computer
    if (ABCApplication.isDebuggingProxy()) params.setParameter(ConnRoutePNames.DEFAULT_PROXY, new HttpHost(ABCConstants.DEBUG_PROXY_HOST, ABCConstants.DEBUG_PROXY_PORT, "http"));

    // ignore ssl certification (due to signed authority not appearing on android list of permitted authorities)
    // see: http://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/
    SchemeRegistry registry = new SchemeRegistry();
    registry.register(new Scheme("http", new PlainSocketFactory(), 80));
    registry.register(new Scheme("https", new FakeSocketFactory(), 443)); 
    ClientConnectionManager cm = new SingleClientConnManager(params, registry);

    return new DefaultHttpClient(cm, params);
} 
```

希望对您的实施有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-21T08:13:00.750

**我们也可以使用**

```
HttpURLConnection http = null;
            URL url;
            try {
                url = new URL("https:your domian");

                if (url.getProtocol().toLowerCase().equals("https")) {
                    trustAllHosts();
                    HttpsURLConnection https = (HttpsURLConnection) url.openConnection();
                    https.setHostnameVerifier(DO_NOT_VERIFY);
                    http = https;
                    System.out.println("TEST:::"+convertStreamToString(http.getInputStream())); 
                } else {
                    http = (HttpURLConnection) url.openConnection();
                    System.out.println("TEST:::"+convertStreamToString(http.getInputStream())); 
                }
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

/*******
 * Trust every server - don't check for any certificate
 */
private static void trustAllHosts() {
    // Create a trust manager that does not validate certificate chains
    TrustManager[] trustAllCerts = new TrustManager[] { new X509TrustManager() {
        public java.security.cert.X509Certificate[] getAcceptedIssuers() {
            return new java.security.cert.X509Certificate[] {};
        }

        public void checkClientTrusted(X509Certificate[] chain,
                String authType) throws CertificateException {
        }

        public void checkServerTrusted(X509Certificate[] chain,
                String authType) throws CertificateException {
        }
    } };

    // Install the all-trusting trust manager
    try {
        SSLContext sc = SSLContext.getInstance("TLS");
        sc.init(null, trustAllCerts, new java.security.SecureRandom());
        HttpsURLConnection
                .setDefaultSSLSocketFactory(sc.getSocketFactory());
    } catch (Exception e) {
        e.printStackTrace();
    }
}

final static HostnameVerifier DO_NOT_VERIFY = new HostnameVerifier() {
    public boolean verify(String hostname, SSLSession session) {
        return true;
    }
}; 
```

# php - 按页切片数组

> ID：10359141
> 
> 赞同：2
> 
> 时间：2012-04-27T23:28:01.447
> 
> 标签：php

```
function date_compare($a, $b)
    {
        $t1 = strtotime($a['lastEdit']);
        $t2 = strtotime($b['lastEdit']);
        return $t1 - $t2;
    }    
    usort($container, 'date_compare');

    $totalPages = floor($count/12);

    $start = $page * 12 - 11;
    $end = $page * 12;

    $container = array_reverse($container);
    $container = array_slice($container, $start, $end);

    return $container; 
```

我的`start`似乎不影响该`slice`方法。例如，当我在第 2 页时（开始：13 和结束：24），我仍然得到`array(24)`返回。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:30:24.660

第三个参数`array_slice`实际上不是“end”，而是“length”——参见[文档](http://php.net/manual/en/function.array-slice.php)。

所以改变

```
$end = $page * 12; 
```

至

```
$len = $page * 12 - $start 
```

和

```
$container = array_slice($container, $start, $end); 
```

至

```
$container = array_slice($container, $start, $len); 
```

如果您希望不包含在内，注释`$len`可能会减一。`$end`

**编辑：** 实际上，看起来您可以将长度参数指定为 11，因为它看起来是固定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:32:07.370

从[array_slice](http://php.net/manual/en/function.array-slice.php)：

> **长度**
> 
> 如果给定长度并且为正数，则序列中将最多包含那么多元素。如果数组短于长度，则仅存在可用的数组元素。如果给定长度并且为负数，则序列将从数组末尾停止那么多元素。如果省略，则序列将包含从偏移量到数组末尾的所有内容。

所以也许你应该给`$end - $start`而不是平原`$end`？

# java - Minecraft 改装给出了 Missingtexture 错误

> ID：10359142
> 
> 赞同：1
> 
> 时间：2012-04-27T23:28:06.063
> 
> 标签：java, eclipse, module, textures, minecraft

我正在尝试使用 MCP 6.2 和 Eclipse 为 Minecraft 制作一个 GUI 模块。GUI（到目前为止）由`drawDefaultBackground`和一个带纹理的矩形组成。问题是，每当我试用这个模组时，纹理矩形都是白色的，并且显示`MISSINGTEXTURE`. 我尝试重定向到像 /gui/furnace.png 这样的默认纹理，它可以正常工作。任何新添加的纹理都会出现此问题，即使我使用新名称复制现有纹理也是如此。

**我要显示的纹理在 MCP 文件的以下目录中：**

mcp\jars\minecraft.jar\bliskcraft\BCGUI.png

这是纹理：

[http://i.stack.imgur.com/Vktv5.png](http://i.stack.imgur.com/Vktv5.png)

最后是我的代码：

**mod_BliskCraftGui.java：**

*代码已删除*

**BliskCraftGui.java：**

*代码已删除*

如果有人知道如何检查玩家是在线玩还是单人游戏，如果在线，哪个服务器，请将其添加到您的答案中。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:54:25.023

没关系，我发现我应该把资源放在`/mcp/eclipse/bin/client/`和`/mcp/bin/minecraft/`文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-20T03:37:04.467

将[Minecraft Coder Pack (MCP)](http://mcp.ocean-labs.de)与它在目录中提供的工作区一起使用时，当 Minecraft 从默认的“客户端”运行配置运行时`eclipse`，该目录将添加到类路径中。`eclipse\Client\bin`这意味着资产可以放置在其`assets\minecraft`下方的目录中。例如为块添加纹理，纹理PNG可以放置在：

```
MCP\eclipse\Client\bin\assets\minecraft\textures\blocks 
```

# php - 服务层中的数据访问和安全性（Doctrine & ZF）

> ID：10359144
> 
> 赞同：6
> 
> 时间：2012-04-27T23:28:15.790
> 
> 标签：php, model-view-controller, doctrine-orm, zend-framework2, service-layer

我们最近开始使用 Doctrine 2.2 和 Zend Framework 2 的部分内容，以改善组织、减少重复等。今天，我开始提出实现服务层以充当我们的控制器和 Doctrine 实体之间的中介的想法。

现在，我们的大部分逻辑都驻留在控制器中。此外，我们使用操作助手来测试某些权限；然而，在实现 Zend\Di 之后，我想出了一个新方法。我开始创建实体特定的服务模型，它使用 Zend\Di 来注入一个 EntityManager 实例，以及当前用户的权限。

控制器代码如下：

```
class Project_DeleteController extends Webjawns_Controller_Action
{
    public function init()
    {
        $this->_initJsonContext();
    }

    public function indexAction()
    {
        $response = $this->_getAjaxResponse();

        $auditId = (int) $this->_getParam('audit_id');
        if (!$auditId) {
            throw new DomainException('Audit ID required');
        }

        /* @var $auditService Service\Audit */
        $auditService = $this->getDependencyInjector()->get('Service\Audit');

        try {
            $auditService->delete($auditId);
            $response->setStatusSuccess();
        } catch (Webjawns\Exception\SecurityException $e) {
            $this->_noAuth();
        } catch (Webjawns\Exception\Exception $e) {
            $response->setStatusFailure($e->getMessage());
        }

        $response->sendResponse();
    }
} 
```

以及我们的服务层之一的示例。构造函数接受两个参数——一个接受 EntityManager，另一个接受一个 Entity\UserAccess 对象——由 Zend\Di 注入。

```
namespace Service;

use Webjawns\Service\Doctrine,
    Webjawns\Exception;

class Audit extends AbstractService
{
    public function delete($auditId)
    {
        // Only account admins can delete audits
        if (\Webjawns_Acl::ROLE_ACCT_ADMIN != $this->getUserAccess()->getAccessRole()) {
            throw new Exception\SecurityException('Only account administrators can delete audits');
        }

        $audit = $this->get($auditId);

        if ($audit->getAuditStatus() !== \Entity\Audit::STATUS_IN_PROGRESS) {
            throw new Exception\DomainException('Audits cannot be deleted once submitted for review');
        }

        $em = $this->getEntityManager();
        $em->remove($audit);
        $em->flush();
    }

    /**
     * @param integer $auditId
     * @return \Entity\Audit
     */
    public function get($auditId)
    {
        /* @var $audit \Entity\Audit */
        $audit = $this->getEntityManager()->find('Entity\Audit', $auditId);
        if (null === $audit) {
            throw new Exception\DomainException('Audit not found');
        }

        if ($audit->getAccount()->getAccountId() != $this->getUserAccess()->getAccount()->getAccountId()) {
            throw new Exception\SecurityException('User and audit accounts do not match');
        }

        return $audit;
    }
} 
```

1.  对于我们想要完成的事情，这是一个合适的模式吗？
2.  在发布的服务层中进行权限验证是一种好习惯吗？
3.  据我了解，视图逻辑仍然驻留在控制器中，使模型可以灵活地用于各种上下文（JSON、XML、HTML 等）。想法？

到目前为止，我对这种工作方式感到满意，但如果有人看到我们这样做的任何不利之处，请发表您的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T20:07:44.473

我喜欢你在这里所做的，我认为你的关注点分离很好。我们正在尝试使用自定义存储库更进一步。因此，例如，标准模型/服务方法可能如下所示：

```
public function findAll($sort = null)
{
    if (!$sort) $sort = array('name' => 'asc');
    return $this->getEm()->getRepository('Application\Entity\PartType')
                ->findAll($sort);

} 
```

...我们正在将需要 DQL 的东西添加到存储库中，以将所有 DQL 排除在模型之外，例如：

```
public function findAllProducts($sort = null)
{
    if (!$sort) $sort = array('name' => 'asc');
    return $this->getEm()->getRepository('Application\Entity\PartType')
                ->findAllProducts($sort);

} 
```

对于上述模型，存储库类如下所示：

```
<?php
namespace Application\Repository;

use Application\Entity\PartType;
use Doctrine\ORM\EntityRepository;

class PartTypeRepository extends EntityRepository
{

    public function findAllProducts($order=NULL)
    {
        return $this->_em->createQuery(
                    "SELECT p FROM Application\Entity\PartType p 
                        WHERE p.productGroup IS NOT NULL 
                        ORDER BY p.name"
               )->getResult();
    }

} 
```

请注意，我们只是扩展了 Doctrine\ORM\EntityRepository，这意味着我们不必重新定义所有标准的 Doctrine 存储库方法，但如果需要，我们可以覆盖它们，并且可以添加我们自己的自定义方法。

因此，关于访问控制，它使我们能够通过从存储库访问服务中的业务逻辑，在非常低的级别添加基于身份的约束或其他记录级别的条件。通过这种方式，服务不知道实现。只要我们严格不将 DQL 放在应用程序的其他部分，我们就可以为任何通过存储库访问数据库的类实现记录级的业务约束。（注意应用程序更高级别的自定义 DQL）。

例子：

```
 public function findAll($order=NULL)
    {
        // assumes PHP 5.4 for trait to reduce boilerplate locator code
        use authService;

        if($this->hasIdentity()) {
            return $this->_em->createQuery(
                        "SELECT p FROM Application\Entity\PartType p 
                            JOIN p.assignments a 
                            WHERE a.id = " . $this->getIdentity()->getId()
                   )->getResult();
        } else {
            return NULL;
        }
    } 
```

# asp.net - ASP.Net html 文件中的 AppSettings

> ID：10359156
> 
> 赞同：0
> 
> 时间：2012-04-27T23:30:00.103
> 
> 标签：asp.net, html, appsettings

我正在尝试使用以下内容，但我不断收到错误消息或 href URL 格式不正确。如果我添加属性：runat = 'server'，则页面不会显示错误，但 href 将与下面的代码完全相同，而不是从 web.config 获取 href 的第一部分。关于如何使这项工作的任何想法？

```
 <a href='<%$ AppSettings : MyAttribute%>/xyz/documents/ation_help.htm' 
       target="_blank">Help</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:37:17.827

试试这个方法：

```
<asp:Label id="label1" runat="server" text="<%$ Resources: Messages, ThankYouLabel %>" /> 
```

[您可以从此处](http://msdn.microsoft.com/en-us/library/d5bd1tad.aspx)找到有关表达式构建器的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T01:06:01.210

我发现对我的情况有用的是我在使用经典 ASP 和 JSP 开发时所做的非常基本的事情。我在有和没有母版页的情况下测试了代码，它在这两种情况下都有效。只需使用**Response.Write**方法。代码如下所示，它被放置在子页面中。***这种方法将始终有效，并且不需要开发人员记住专门的 ASP.Net 表达式。***我在这里听起来正确还是我错过了什么？

```
<%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="Default3.aspx.cs" Inherits="Default3" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
<div id="x" runat="server">
    <% Response.Write("<a href='" + ConfigurationManager.AppSettings["MyAttribute"] + 
    "/xyz/documents/ation_help.htm' target='_blank'  >Help</a>"); %>
</div>
</asp:Content> 
```

# perl - 我可以在递减值的同时推送到数组吗？

> ID：10359161
> 
> 赞同：2
> 
> 时间：2012-04-27T23:31:43.273
> 
> 标签：perl

我知道如何轻松拆分字符串并将条目推送到数组中，但在这种情况下，我也需要将它们全部递减。我可以做：

```
my @valueArray = ();
my $values = "1,7,30";

push @valueArray, split(/,/, $values);

for (my $i = 0; $i < scalar(@valueArray); $i++) {
  $valueArray[$i]--;
} 
```

但是这个beeing perl似乎应该在拆分和推送之间有一种更短的方法来做到这一点。有吗，还是我应该停止打高尔夫球而只使用 for 循环？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T23:47:33.053

这个怎么样？

```
my $valuesSource = "1,17,30";
my @decrementedValues = map { $_ - 1 } split /,/, $valuesSource; 
```

你不需要在这里递减；事实上，`map`当它的内部块更新原始数组元素的值时，很少应该使用它——反之亦然。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T23:42:19.087

如果我正确理解您的代码，您正试图递减数组的每个数值。这可以很容易地通过使用来实现[`map`](http://perldoc.perl.org/functions/map.html)。

如果你的数组真的只包含数字，我会这样做：

```
my @num = qw/1 7 30/;
@num = map { --$_ } @num; 
```

**编辑：**

也许您还应该检查您是否真的在处理整数值。例如：

```
my $source = "1,17,30,,a";
say for grep{defined $_} map { /^\d+$/ ? --$_ : undef } split /,/, $source; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T23:50:14.203

如果您想就地执行此操作，则`for`可以使循环更加简洁：

```
--$_ for @valueArray; 
```

这相当于说：

```
for my $x (@valueArray) {
    --$x;
} 
```

一般来说，您应该避免`for`在 Perl 中使用 C 风格的循环，因为它们的可读性不如基于范围的等价物。如果您想要一个非变异等效项，它返回数组的修改副本而不是就地修改它，还有`map`：

```
@valueArray = map { $_ - 1 } split /,/, $values; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T23:55:07.157

您正在寻找的是[地图功能](http://perldoc.perl.org/functions/map.html)：

```
my @valueArray = ();
my $values = "1,7,30";
push @valueArray, map { --$_ } split(/,/, $values); 
```

请注意，当使用 split 或 map 等函数时，您不需要使用 push... 因为 split 和 map 可以在数组上下文中给出结果，只需直接分配给数组变量：

```
my $values = "1,7,30";
my @valueArray = map { --$_ } split( /,/, $values); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T02:42:56.157

```
#!/usr/bin/env perl

use strict; use warnings;

my $values = "1,7,30";
my @values = map --$_, $values =~ /([0-9]+)/g;

use YAML;
print Dump \@values; 
```

输出：

```
C:\temp> jj
---
- 0
- 6
- 29
```

# javascript - 通过 Javascript 停止 CGI 电子邮件脚本？

> ID：10359167
> 
> 赞同：0
> 
> 时间：2012-04-27T23:34:03.037
> 
> 标签：javascript, html, forms, validation

```
 <form name="post" ACTION="http://epansoftware.com/cgi-sys/cgiemail/cgi-bin/cgimailx.txt" accept-charset="UTF-8" METHOD="post">
    <fieldset>
    <legend>OR LEAVE US A MESSAGE HERE</legend>
    <label for="name" class="fixedwidth">Name</label>
    <input type="text" Name="name" id="name" value="" size="50"/><br />
    <label for="company" class="fixedwidth">Company</label>
    <input type="text" Name="company" id="company" value="" size="50"/><br />
    <label for="email" class="fixedwidth">Email</label>
    <input type="text" Name="email" id="email" size="50"/><br />
    <label for="subject" class="fixedwidth">Subject</label>
    <select name="subject" id="subject">
    <option>Support</option>
    <option>Sales Inquiry</option>
    <option>Custom Database</option>
    </select><br />
    <label for="message" class="fixedwidth">Message</label>
    <textarea type="text" Name="message" id="message" cols="40" rows="20"></textarea>
    <div class="buttonarea">
    <input type="submit" name="submit" value="Submit" onClick="testResults()">
    <INPUT TYPE="hidden" NAME="success" VALUE="http://www.epansoftware.com">
    </div>
    </fieldset>
    </form> 
```

我在 HTML 中有这个表单，以及在标题中定义的这个 javascript 函数：

```
 <script language="javascript">
    function testResults()
    {
    var name = document.getElementById("name").value;
    var email = document.getElementById("email").value;
    var message = document.getElementById("message").value;
    var fields = new Array();
    fields[0] = name;
    fields[1] = email;
    fields[2] = message;
    var tester = /[A-z]|[0-9]/;
    if(! tester.test(fields[0]))
    {
      alert("Please type information in all the required fields!");
      return false;
    }
    else if(! tester.test(fields[1]))
    {
      alert("Please type information in all the required fields!");
    }
    else if(! tester.test(fields[2]))
    {
      alert("Please type information in all the required fields!");
    }
    else if(tester.test(fields[0]) && tester.test(fields[1]) && tester.test(fields[2]))
    {
      alert("Your message has been sent!");
    }
    else
    {
      alert("ERROR 5: Regex Error");
    }
  }
</script> 
```

我的问题是，当我调用该函数时，如果没有填写所有字段，我不希望发送电子邮件。但是，按照现在的方式，无论如何都会发送一封电子邮件。有什么方法可以阻止 CGI 脚本（这就是表单方法中的操作）从 javascript 运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:36:14.750

添加`return false`到函数的末尾。在您的`<form>`标签中添加`onSubmit="return testResults()"`（删除您现在的调用方式）。标签的`return false`in`onSubmit`属性`<form>`会阻止表单提交。

# php - 在自定义 viewhelper 中加载 phtml 内容？

> ID：10359174
> 
> 赞同：1
> 
> 时间：2012-04-27T23:34:50.957
> 
> 标签：php, zend-framework, zend-view

在我的主要 layout.phtml 中，我包含了一个自定义 viewhelper。viewhelper 有很多静态 html 内容并将其返回给布局。

有没有办法让 viewhelper 从外部 phtml 文件加载这个 html 内容？

抽象示例：

```
Layout:
<?php echo $this->viewHelperGiveMeHtml();  ?> //<div>Foobar</div>

ViewHelper:
class Zend_View_Helper_ViewHelperGiveMeHtml extends Zend_View_Helper_Abstract{

    public function viewHelperGiveMeHtml(){
        return retrieveHtmlFromPhtml('foobar.phtml');  //how can i load an phtml? file
    }   
}

foobar.phtml:
<div>Foobar</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:18:47.020

```
public function viewHelperGiveMeHtml(){
    $this->view->render('foobar.phtml');
} 
```

简要说明：

当您在视图中调用视图助手时`$this->viewHelperGiveMeHtml();`，初始化给定的助手类并使用方法`Zend_View`传递自己。`Zend_View_Helper_Abstract::setView`

# c++ - C++ 在设置新对象时我应该销毁对象中的旧对象吗？

> ID：10359181
> 
> 赞同：1
> 
> 时间：2012-04-27T23:35:46.693
> 
> 标签：c++

考虑以下类声明：

```
#include "classB.h"
class A {
private:
    B *prop;

public:
    A() { /* does stuff to set up B as a pointer to a new B */
    setB(const B& bar) { /* store a copy of B */
        // how do I manage the old *prop?
        *prop = new B(bar);
    }
}; 
```

应该`setB()`如何管理内存分配？我应该删除旧的`*prop`吗？如果是这样，我是否取消引用然后`delete`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T23:37:15.840

首先，您必须在构造函数中设置`prop`为`NULL`，否则如果您尝试这样做，您会得到未定义的行为`delete`。

其次，您不取消引用，您只需分配指针。

第三，您应该删除析构函数中的内存，以免泄漏。

最后，如果你实现了析构函数，你还应该有一个复制构造函数和一个赋值运算符。

```
class A {
private:
    B *prop;

public:
    //set prop to NULL so you don't run into undefined behavior
    //otherwise, it's a dangling pointer
    A() { prop = NULL; }

    //when you set a new B, delete the old one
    setB(const B& bar) { 
        delete prop;
        prop = new B(bar);
    }

    //delete prop in destructor
    ~A() { delete prop; }

    //because you now have a destructor
    //implement the following to obey the rule of three
    A& operator = (const A& other);  //assignment operator
    A(const A& other);               //copy constructor
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T23:54:53.317

为了在分配抛出的情况下保持对象的状态，就像它在操作之前一样，你可能最好像这样实现它：

```
void setB(const B& bar)
{
    // Do this first, since it could throw.
    B *newProp = new B(bar);

    // Now delete the old one and replace it with the new one.
    delete prop;
    prop = newProp;
} 
```

请参见此处（特别是关于强异常保证的部分）：

[http://en.wikipedia.org/wiki/Exception_guarantees](http://en.wikipedia.org/wiki/Exception_guarantees)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T23:44:52.370

如果构造函数*总是*分配一个 new `B`，您可以将该空间重新用于其他`B`对象的副本。

```
A() { /* does stuff to set up prop as a pointer to a new B */
}

setB(const B& bar) { /* store a copy of B */
    *prop = bar;
} 
```

并且不要忘记`prop`在析构函数中删除。

# ios - 调用 applicationDidBecomeActive 时如何告诉活动视图控制器？

> ID：10359186
> 
> 赞同：21
> 
> 时间：2012-04-27T23:36:44.780
> 
> 标签：ios, iphone, swift, xcode-storyboard

我觉得我在这里错过了一个技巧......

我只想在调用 applicationDidBecomeActive 时在当前活动视图控制器上调用 viewDidLoad 或 viewDidAppear，这样当应用程序从后台再次启动时，我可以重置一些动画或其他内容。我的一些观点不在乎，但其他人确实需要知道。

我正在使用 Storyboards，我的应用程序委托文件具有标准功能 - 但都带有 EMPTY 主体。例如，didFinishLaunchingWithOptions 只返回 YES，不执行任何其他操作。Storyboard 会自动完成我猜想的一切。

那么如何从我相当空白、无信息的应用程序委托中与当前视图控制器对话呢？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-12T01:53:45.857

操作系统不会从您的应用委托发送通知，而是自动发送通知，您可以观察到：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                      selector:@selector(initSongInfo)
                                      name:UIApplicationDidBecomeActiveNotification
                                      object:nil]; 
```

当然，请确保在您的 dealloc 方法之前或内部的某个时间停止观察，方法是调用：

```
[[NSNotificationCenter defaultCenter] removeObserver:self 
                                      name:UIApplicationDidBecomeActiveNotification 
                                      object:nil]; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-27T23:53:22.060

我建议使用通知。

在您的应用程序委托的 applicationdidBecomeActive 方法中输入以下代码：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"appDidBecomeActive" object:nil]; 
```

在您当前的活动视图控制器的 init 方法中订阅通知。

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(updateStuff)        
                                             name:@"appDidBecomeActive" 
                                           object:nil]; 
```

在你的控制器中实现“updateStuff”方法，当应用程序激活时，你应该能够做任何你想做的事情。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-07-08T13:19:46.787

斯威夫特版本：

**您可以在 viewDidLoad 中添加此行**

```
NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(viewDidBecomeActive), name: UIApplicationDidBecomeActiveNotification, object: nil)

func viewDidBecomeActive(){
    print("viewDidBecomeActive")
} 
```

## 斯威夫特 5.x 版本

```
NotificationCenter.default.addObserver(self, selector: #selector(viewDidBecomeActive), name: UIApplication.didBecomeActiveNotification, object: nil)

@objc func viewDidBecomeActive() {
    print("viewDidBecomeActive")
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-30T00:11:24.503

好吧，这是相当灾难性的。

你们必须注意事件注册/注销，因为您可能会导致内存泄漏。

为了使一切正常，您需要设置一个知道注册状态的标志：您是否已登录后台事件。请注意，当用户看到视图控制器（如果他来自其他用户）或者如果他从主屏幕来到您的视图控制器时，您需要注册事件。

当您将视图控制器留给另一个视图控制器时，您还需要取消注册。

简而言之：

**斯威夫特 4：**

```
private var registeredToBackgroundEvents = false

override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)
    registerToBackFromBackground()
}

/// register to back from backround event
private func registerToBackFromBackground() {
    if(!registeredToBackgroundEvents) {
        NotificationCenter.default.addObserver(self, 
        selector: #selector(viewDidBecomeActive), 
        name: UIApplication.didBecomeActiveNotification, object: nil)
        registeredToBackgroundEvents = true
    }
}

/// unregister from back from backround event
private func unregisterFromBackFromBackground() {
    if(registeredToBackgroundEvents) {
        NotificationCenter.default.removeObserver(self, 
        name: UIApplication.didBecomeActiveNotification, object: nil)
        registeredToBackgroundEvents = false
    }

}

@objc func viewDidBecomeActive(){
    logicManager.onBackFromStandby()
}

override func viewWillDisappear(_ animated: Bool) {
    unregisterFromBackFromBackground()
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-27T23:50:23.647

您可以从 AppDelegate 发送一个 NSNotification 并在您的 ViewController 中订阅它，而不是尝试跟踪哪个 ViewController 是当前的。这样视图控制器就可以跟踪它是否需要调用 viewDidAppear。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-28T00:04:03.333

您的 AppDelegate 将有一个 window 属性，该窗口将有一个 rootViewController 属性。你可以在这里找到你的 viewController。

如果你使用的是 TabBarController，rootviewcontroller 将是 tabbarcontroller，你可以调用 tabbarcontroller 的 selectedViewController 来获取当前的 viewController。

```
UIViewController *rootViewController = [[[[UIApplication sharedApplication] delegate] window] rootViewController];
if ([rootViewController isKindOfClass:[UITabBarController Class]])
    rootViewController = ((UITabBarController *)rootViewController).selectedViewController;
else if ([rootViewController isKindOfClass:[UINavigationController Class]])
    rootViewController = ((UINavigationController *)rootViewController).topViewController;

[rootViewController viewDidAppear]; 
```

如果你有一个更复杂的带有导航控制器的视图层次结构，或者模式视图，你可以调用presentedViewController，或者topViewController。

# css - 如何防止隐藏的 div 创建换行符？

> ID：10359189
> 
> 赞同：4
> 
> 时间：2012-04-27T23:37:20.447
> 
> 标签：css, html

这个问题似乎被问了很多，但我找不到适合我的答案。

这是一个示例的链接（另见下面的 HTML）：[http ://biskup.biowiki.org/blah.html](http://biskup.biowiki.org/blah.html)

我希望文本在链接之后流动，但事实并非如此。（我在 Mac 上的 Firefox 和 Chrome 中查看此内容。）

我想抢占一些我见过的常见回复，例如在[</div> 之后防止换行符](https://stackoverflow.com/questions/3576605/prevent-linebreak-after-div)

关于这些答案：

*   我不能将 div 的显示属性设置为“inline”或“inline-block”，因为我真的希望它被隐藏。无论如何，这对我来说似乎不起作用：参见例如[http://biskup.biowiki.org/blah2.html](http://biskup.biowiki.org/blah2.html)
*   "float:left" 也不起作用
*   我不能使用 span 元素，因为我真的希望这是一个 div，所以我可以将它用作弹出元素
*   由于它是一个弹出元素，最终会被弹出它的 JavaScript 代码分离/重新定位/重新附加（这将通过单击 div 旁边的链接触发），我可以从技术上将 div 放在文档中的其他位置（例如在最后）；这样就不会中断流程；但由于此 HTML 是动态生成的，因此在显示它的链接旁边创建 div 非常方便，如本例所示

顺便说一句，我*可以*通过在前面的标签中添加“display:inline”来防止这种情况（参见示例），但这是一个非常尴尬的解决方法

这是我的示例的 HTML：

```
<!DOCTYPE html>
<html>
<head>
  <title>Dumb bug</title>
</head>
<body>

<p/>
<!-- the following (commented-out) line prevents the div from starting a newline; still seeking a better solution that is local to the div or adjacent anchor element -->
<!-- p style="display:inline;"/ -->
Here is some text.
Here is a
<a href="#">  link</a>.
<div style="display:none;">
  This text is inside the hidden div, and should not be shown.
  (A separate piece of code will detach/reattach/position/show this div as a popup, but it's convenient to generate it in the same place as the link.)
</div>
And here is some more text, that I want to flow on the same line after the link.

And some more.

<p/>
<p style="display:inline;"/>
Here is another paragraph.

</body>
</html> 
```

编辑添加：单例 p/ 标签是大多数浏览器都原谅的草率语法（解释为 p ... p/ 包含 div 元素），这隐藏了我对 div 如何继承布局样式的基本误解它的父 p。

如果我按照 samiz 和 IsisCode 在回复中的建议将单例 p/ 标记更改为此...

```
<p style="display:inline">
...
<p/> 
```

...然后我得到所需的行为（文本流动）。

对于具有更多动态行为上下文的相同示例（即单击链接时会发生什么）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:44:28.507

> 顺便说一句，我可以通过在前面的标签中添加“display:inline”来防止这种情况（参见示例），但这是一个非常尴尬的解决方法

这就是 HTML 的工作原理。`<p>`是一个块行元素，也就是说，它占据了它的整行。您隐藏的 div 不会导致换行符，前面的`<p>`元素是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:15:13.730

从技术上讲，你不应该有一个标签的`div`内部。`p`两者都是块元素，它会导致你看到的奇怪行为。有没有理由不能使用 a`span`而不是 a `div`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T23:40:39.197

jsFiddle：http: [//jsfiddle.net/5ArsK/3/](http://jsfiddle.net/5ArsK/3/)

添加`float:left`到包含顶部文本的 div。

```
<p/>
<!-- the following (commented-out) line prevents the div from starting a newline; still seeking a better solution that is local to the div or adjacent anchor element -->
<!-- p style="display:inline;"/ -->

<div style="float:left;">
     Here is some text.
     Here is a
     <a href="#">  link</a>.
</div>

<div style="display:none;">
  This text is inside the hidden div, and should not be shown.
  (A separate piece of code will detach/reattach/position/show this div as a popup, but it's convenient to generate it in the same place as the link.)
</div>
And here is some more text, that I want to flow on the same line after the link.

And some more.

<p/>
<p style="display:inline;"/>
Here is another paragraph.​ 
```

# javascript - 在 iframe 之间传递 JavaScript 文件对象

> ID：10359191
> 
> 赞同：0
> 
> 时间：2012-04-27T23:37:47.673
> 
> 标签：javascript, xmlhttprequest

我需要将 File 对象传递给跨域 iframe，以便可以使用 XHR 上传。我使用easyXDM进行跨域通信，但相关的一点是浏览器如何处理传递这个对象。

```
fileUpload: function (data, success, error) {
    var file = data.file,
        name = data.name,
        size = data.size,
        params = data.params;

    var xhr = new XMLHttpRequest();
    xhr.upload.onprogress = function (e) {
        if (e.lengthComputable) 
            console.log(e.loaded);
    }
    xhr.onreadystatechange = function (e) {
        if (xhr.readyState == 4)
            success();
    }

    params = params || {};
    params['qqfile'] = name;
    var queryString = qq.obj2url(params, '/api/2/photo/upload');

    xhr.open("POST", queryString, true);
    xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
    xhr.setRequestHeader("X-File-Name", encodeURIComponent(name));
    xhr.setRequestHeader("Content-Type", "application/octet-stream");
    xhr.send(file);
} 
```

通过 postMessage api 传递数据后调用上述方法；当它到达这里时，文件对象，它曾经看起来像这样（从 Web Inspector 打印）：

```
File
lastModifiedDate: Mon Jul 13 2009 23:32:31 GMT-0600 (Mountain Daylight Time)
name: "Chrysanthemum.jpg"
size: 879394
type: "image/jpeg"
webkitRelativePath: ""
__proto__: File 
```

现在只是一个普通对象，没有文件：

```
Object
lastModifiedDate: "2009-07-14T05:32:31.000Z"
name: "Chrysanthemum.jpg"
size: 879394
type: "image/jpeg"
webkitRelativePath: ""
__proto__: Object 
```

因此，在文件引用丢失的情况下，Xhr 在上传时不会传递任何二进制数据。**如何成功地将 File 对象传递给 iframe？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:43:10.537

由于浏览器的安全性，您不能在窗口或不同来源之间传递 File 对象，因为它的生命周期绑定到其原始窗口。

相反，如果需要，您可以传递文件数据有效负载。

# android - 如何选择在 Robotium 上单击哪个按钮以显示警报对话框？

> ID：10359192
> 
> 赞同：10
> 
> 时间：2012-04-27T23:37:51.420
> 
> 标签：android, robotium, android-alertdialog

我是 Robotium 的新手。我使用对话框生成器创建了一个警报对话框，并使用 show 命令调用它。默认情况下，我能够使用 Robotium 触发“确定”按钮，但我无法对“取消”按钮执行相同操作。由于对话框没有与 id 关联，我不确定如何获取按钮的 id。这是我的对话框代码

```
alertDialogBuilder
.setMessage("Please enter only numbers without any spaces")
.setCancelable(true)
.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
 public void onClick(DialogInterface dialog, int id) {
 dialog.cancel();
 }
 })
 .setPositiveButton("Ok", new DialogInterface.OnClickListener() {
 public void onClick(DialogInterface dialog, int id) {
 dialog.cancel();
 }
 }); 
```

我用来触发测试类中的“确定”按钮的代码是

```
 solo.getCurrentActivity().runOnUiThread(new Runnable() {
 public void run() {
 solo.getCurrentActivity().getCurrentFocus().requestFocus();
 }
 });
 this.sendKeys(KeyEvent.KEYCODE_DPAD_CENTER); 
```

如何为“取消”按钮做同样的事情？提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-01T22:32:07.703

实际上，我建议您`solo.clickOnView(solo.getView(buttonId))`在“正面”按钮所在的位置`android.R.id.button1`，“负面”按钮所在的位置`android.R.id.button2`和“中性”按钮所在的位置`android.R.id.button3`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-14T15:49:27.660

只需使用 solo.clickOnButton("Cancel");

# c# - Eazfuscator.NET 中断 Enum.IsDefined

> ID：10359194
> 
> 赞同：3
> 
> 时间：2012-04-27T23:37:54.413
> 
> 标签：c#, .net, reflection, obfuscation, eazfuscator

在我的代码中，我使用了许多小的枚举：

```
enum UserRequest : byte { Burp=1, Sneeze=2, Fart=3 } 
```

在将整数输入转换为此枚举之前，我经常需要对其进行验证。

```
bool valid_input = Enum.IsDefined(typeof(UserRequest), user_byte_value); 
```

当枚举使用 FlagsAttribute 时，这种方法不起作用；[Enum.IsDefined](http://msdn.microsoft.com/en-us/library/system.enum.isdefined%28v=vs.80%29.aspx)无法自动组合标志以生成指定值。但是，我已经能够解决不需要 FlagsAttribute 的问题。

但是，TIL 认为[Eazfuscator.NET](http://www.gapotchenko.com/eazfuscator.net)的混淆会破坏 Enum.IsDefined。我知道这是一种可能性，但我希望它不会，因为它不在 System.Reflection 命名空间中（据报道，它大量使用了 System.Reflection）。

所以我想知道是否有人知道任何好的选择。我特别关注以下内容：

1.  允许检查整数是否在指定的枚举中。
2.  与 .NET Framework 2.0 和 Mono 框架兼容。
3.  无需显式禁用混淆（使用属性或某些 GUI 工具）即可幸免于难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T22:20:38.357

如果其他人遇到同样的问题并找到这篇文章，我采用的解决方案是为我的每个枚举添加一个额外的枚举成员。

```
enum UserRequests : byte
{
    Burp = 0,
    Sneeze = 1,
    Fart = 2,
    /* Maximum Valid Value */
    MAXVAL = Fart
} 
```

这是我记得在 C ((non-ANSI) with #defines) 中使用来迭代枚举值的一种做法，它唯一的缺点是它很难维护。

我写了一个通用函数来减轻负担（如下所示的标题）；我仍然必须明确传递 MAXVAL 成员，但它的工作量比我想象的要少。当然，它可以经受住混淆并且是可移植的。

```
public static bool TryParseByteToEnum<T>(byte input_byte, 
    out T enum_member, T max_value) where 
        T : struct, IConvertible 
```

# c# - Windows 8 GridView - 禁用项目点击可视化

> ID：10359197
> 
> 赞同：7
> 
> 时间：2012-04-27T23:38:18.060
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

是否可以删除网格视图内项目的点击效果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T13:53:07.050

是的，您需要在 ItemContainerStyle 属性中修改 GridViewItem 样式。

```
<GridView>
    <GridView.ItemContainerStyle>
        <Style TargetType="GridViewItem">
            <Setter
                Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GridViewItem">
                        <Border x:Name="OuterContainer">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal" />
                                    <VisualState x:Name="PointerOver">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PointerOverBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SelectionBackground" Storyboard.TargetProperty="Fill">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource ListViewItemSelectedPointerOverBorderBrush}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="Stroke">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource ListViewItemSelectedPointerOverBorderBrush}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SelectedEarmark" Storyboard.TargetProperty="Fill">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource ListViewItemSelectedPointerOverBorderBrush}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <Storyboard>
                                            <TapDownThemeAnimation TargetName="ContentContainer" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Opacity" Duration="0" To="{StaticResource ListViewItemDisabledOpacity}" />
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="FocusStates">
                                    <VisualState x:Name="Focused">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="FocusVisual" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unfocused" />
                                    <VisualState x:Name="PointerFocused" />
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="SelectionHintStates">
                                    <VisualStateGroup.Transitions>
                                        <VisualTransition To="NoSelectionHint" GeneratedDuration="0:0:0.65" />
                                    </VisualStateGroup.Transitions>
                                    <VisualState x:Name="VerticalSelectionHint">
                                        <Storyboard>
                                            <SwipeHintThemeAnimation TargetName="SelectionBackground" ToVerticalOffset="25" ToHorizontalOffset="0" />
                                            <SwipeHintThemeAnimation TargetName="ContentBorder" ToVerticalOffset="25" ToHorizontalOffset="0" />
                                            <SwipeHintThemeAnimation TargetName="SelectedCheckMark" ToVerticalOffset="25" ToHorizontalOffset="0" />
                                            <DoubleAnimation Storyboard.TargetName="HintGlyph" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="HorizontalSelectionHint">
                                        <Storyboard>
                                            <SwipeHintThemeAnimation TargetName="SelectionBackground" ToHorizontalOffset="-25" ToVerticalOffset="0" />
                                            <SwipeHintThemeAnimation TargetName="ContentBorder" ToHorizontalOffset="-25" ToVerticalOffset="0" />
                                            <SwipeHintThemeAnimation TargetName="SelectedCheckMark" ToHorizontalOffset="-25" ToVerticalOffset="0" />
                                            <DoubleAnimation Storyboard.TargetName="HintGlyph" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="NoSelectionHint" />
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Selecting">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="SelectionBackground" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="SelectingGlyph" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="HintGlyphBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="SelectionBackground" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="SelectedCheckMark" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unselecting">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="HintGlyphBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unselected">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="HintGlyphBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="SelectedUnfocused">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="SelectionBackground" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="SelectedBorder" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="SelectedCheckMark" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="DragStates">
                                    <VisualStateGroup.Transitions>
                                        <VisualTransition To="NotDragging" GeneratedDuration="0:0:0.650" />
                                    </VisualStateGroup.Transitions>
                                    <VisualState x:Name="NotDragging" />
                                    <VisualState x:Name="Dragging">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="InnerDragContent" Storyboard.TargetProperty="Opacity" Duration="0" To="{StaticResource ListViewItemDragOpacity}" />
                                            <DragItemThemeAnimation TargetName="InnerDragContent" />
                                            <FadeOutThemeAnimation TargetName="SelectedCheckMarkOuter" />
                                            <FadeOutThemeAnimation TargetName="SelectedBorder" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="DraggingTarget">
                                        <Storyboard>
                                            <DropTargetItemThemeAnimation TargetName="OuterContainer" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MultipleDraggingPrimary">
                                        <Storyboard>
                                            <!-- These two Opacity animations are required - the FadeInThemeAnimations
                                        on the same elements animate an internal Opacity. -->
                                            <DoubleAnimation Storyboard.TargetName="MultiArrangeOverlayBackground" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="MultiArrangeOverlayText" Storyboard.TargetProperty="Opacity" Duration="0" To="1" />
                                            <DoubleAnimation Storyboard.TargetName="InnerDragContent" Storyboard.TargetProperty="Opacity" Duration="0" To="{StaticResource ListViewItemDragOpacity}" />
                                            <FadeInThemeAnimation TargetName="MultiArrangeOverlayBackground" />
                                            <FadeInThemeAnimation TargetName="MultiArrangeOverlayText" />
                                            <DragItemThemeAnimation TargetName="InnerDragContent" />
                                            <FadeOutThemeAnimation TargetName="SelectedCheckMarkOuter" />
                                            <FadeOutThemeAnimation TargetName="SelectedBorder" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MultipleDraggingSecondary">
                                        <Storyboard>
                                            <FadeOutThemeAnimation TargetName="ContentContainer" />
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="ReorderHintStates">
                                    <VisualStateGroup.Transitions>
                                        <VisualTransition To="NoReorderHint" GeneratedDuration="0:0:0.65" />
                                    </VisualStateGroup.Transitions>
                                    <VisualState x:Name="NoReorderHint" />
                                    <VisualState x:Name="BottomReorderHint">
                                        <Storyboard>
                                            <DragOverThemeAnimation TargetName="ReorderHintContent" ToOffset="{StaticResource ListViewItemReorderHintOffset}" Direction="Bottom" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="TopReorderHint">
                                        <Storyboard>
                                            <DragOverThemeAnimation TargetName="ReorderHintContent" ToOffset="{StaticResource ListViewItemReorderHintOffset}" Direction="Top" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="RightReorderHint">
                                        <Storyboard>
                                            <DragOverThemeAnimation TargetName="ReorderHintContent" ToOffset="{StaticResource ListViewItemReorderHintOffset}" Direction="Right" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="LeftReorderHint">
                                        <Storyboard>
                                            <DragOverThemeAnimation TargetName="ReorderHintContent" ToOffset="{StaticResource ListViewItemReorderHintOffset}" Direction="Left" />
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="DataVirtualizationStates">
                                    <VisualState x:Name="DataAvailable" />
                                    <VisualState x:Name="DataPlaceholder">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PlaceholderTextBlock" Storyboard.TargetProperty="Visibility" Duration="0">
                                                <DiscreteObjectKeyFrame KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <Visibility>Visible</Visibility>
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PlaceholderRect" Storyboard.TargetProperty="Visibility" Duration="0">
                                                <DiscreteObjectKeyFrame KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <Visibility>Visible</Visibility>
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Grid x:Name="ReorderHintContent" Background="Transparent">
                                <Path x:Name="SelectingGlyph" Opacity="0" Data="F1 M133.1,17.9 L137.2,13.2 L144.6,19.6 L156.4,5.8 L161.2,9.9 L145.6,28.4 z" Fill="{StaticResource ListViewItemHighlightBrush}" Height="13" Stretch="Fill" Width="15" HorizontalAlignment="Right" Margin="0,5.5,5.5,0" VerticalAlignment="Top" />
                                <Border x:Name="ContentContainer">
                                    <!-- This extra wrapper grid is necessary because rendertransforms set by the reorder hint animations
                                will be lost when ContentContainer becomes a LTE -->
                                    <Grid x:Name="InnerDragContent">
                                        <Border x:Name="HintGlyphBorder" Height="40" Width="40" HorizontalAlignment="Right" VerticalAlignment="Top" Opacity="0" Margin="4">
                                            <Path x:Name="HintGlyph" Opacity="0" Data="F1 M133.1,17.9 L137.2,13.2 L144.6,19.6 L156.4,5.8 L161.2,9.9 L145.6,28.4 z" Fill="{StaticResource ListViewItemCheckHintGlyphBrush}" Height="13" Stretch="Fill" Width="15" HorizontalAlignment="Right" Margin="0,5.5,5.5,0" VerticalAlignment="Top" />
                                        </Border>
                                        <Rectangle x:Name="PointerOverBorder" IsHitTestVisible="False" Opacity="0" Fill="{StaticResource ListViewItemPointerOverBrush}" Margin="1" />
                                        <Rectangle x:Name="FocusVisual" IsHitTestVisible="False" Opacity="0" StrokeThickness="2" Stroke="{StaticResource ListViewItemKeyboardFocusBrush}" />
                                        <Rectangle x:Name="SelectionBackground" Margin="4" Fill="{StaticResource ListViewItemHighlightBrush}" Opacity="0" />
                                        <Border x:Name="ContentBorder" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Margin="4">
                                            <Grid>
                                                <ContentPresenter x:Name="contentPresenter" ContentTransitions="{TemplateBinding ContentTransitions}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="{TemplateBinding Padding}" />
                                                <!-- The 'Xg' text simulates the amount of space one line of text will occupy.
                                            In the DataPlaceholder state, the Content is not loaded yet so we
                                            approximate the size of the item using placeholder text. -->
                                                <TextBlock x:Name="PlaceholderTextBlock" Visibility="Collapsed" Text="Xg" Foreground="{x:Null}" Margin="{TemplateBinding Padding}" IsHitTestVisible="False" />
                                                <Rectangle x:Name="PlaceholderRect" Visibility="Collapsed" Fill="{StaticResource ListViewItemPlaceholderRectBrush}" IsHitTestVisible="False" />
                                                <Rectangle x:Name="SelectedBorder" IsHitTestVisible="False" Opacity="0" Stroke="{StaticResource ListViewItemHighlightBrush}" StrokeThickness="{StaticResource GridViewItemSelectedBorderThickness}" />
                                            </Grid>
                                        </Border>
                                        <Border x:Name="SelectedCheckMarkOuter" IsHitTestVisible="False" HorizontalAlignment="Right" VerticalAlignment="Top" Padding="{TemplateBinding BorderThickness}" Margin="4">
                                            <Grid x:Name="SelectedCheckMark" Opacity="0" Height="40" Width="40">
                                                <Path x:Name="SelectedEarmark" Data="M0,0 L40,0 L40,40 z" Fill="{StaticResource ListViewItemHighlightBrush}" Stretch="Fill" />
                                                <Path Data="F1 M133.1,17.9 L137.2,13.2 L144.6,19.6 L156.4,5.8 L161.2,9.9 L145.6,28.4 z" Fill="{StaticResource ListViewItemCheckGlyphBrush}" Height="13" Stretch="Fill" Width="15" HorizontalAlignment="Right" Margin="0,5.5,5.5,0" VerticalAlignment="Top" FlowDirection="LeftToRight" />
                                            </Grid>
                                        </Border>
                                        <Rectangle x:Name="MultiArrangeOverlayBackground" IsHitTestVisible="False" Opacity="0" Fill="{StaticResource ListViewItemDragBackgroundBrush}" Margin="4" />
                                        <TextBlock x:Name="MultiArrangeOverlayText" IsHitTestVisible="False" Opacity="0" Text="{Binding TemplateSettings.DragItemsCount, RelativeSource={RelativeSource Mode=TemplatedParent}}" TextWrapping="Wrap" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="4">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="White" />
                                <Setter Property="FontSize" Value="56" />
                                <Setter Property="FontFamily" Value="{StaticResource ContentFontFamily}" />
                                <Setter Property="FontWeight" Value="Light" />
                                <Setter Property="HorizontalAlignment" Value="Left" />
                                <Setter Property="VerticalAlignment" Value="Bottom" />
                                <Setter Property="Margin" Value="12,0,0,0" />
                                <Setter Property="TextWrapping" Value="Wrap" />
                                <Setter Property="TextTrimming" Value="WordEllipsis" />
                            </Style>
                        </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </GridView.ItemContainerStyle>
</GridView> 
```

请注意，系统控件的默认样式在操作系统版本之间会发生变化。Windows 10 扩展（请注意，平台默认使用简化的可视化树呈现项目以提高性能）样式`GridViewItem`可以在`"c:\Program Files (x86)\Windows Kits\10\DesignTime\CommonConfiguration\Neutral\UAP\10.0.10240.0\Generic\themeresources.xaml"`（或在themeresources.xaml 文件中的某个此类位置）中找到，方法是搜索`TargetType="GridViewItem"`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-11T10:39:31.780

当只需要只读网格视图时，IsHitTestVisible="False" 将是最快的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-14T06:13:03.140

这是 W8.1 上的完美解决方案

```
 <Style x:Key="GridViewItemStyle" TargetType="GridViewItem">
<Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}"/>
<Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}"/>
<Setter Property="Background" Value="Transparent"/>
<Setter Property="TabNavigation" Value="Local"/>
<Setter Property="IsHoldingEnabled" Value="True"/>
<Setter Property="Margin" Value="0,0,2,2"/>
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="GridViewItem">
            <ContentPresenter />
        </ControlTemplate>
    </Setter.Value>
</Setter> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T12:04:47.767

删除“GridViewItemStyle”中视觉状态“PointerOver”和“PointerOverPressed”的情节提要将禁用指针悬停和按下动画。

示例源代码： http: [//files.cnblogs.com/Tealcwu/ItemContainerStyleSelectorDemo.zip](http://files.cnblogs.com/Tealcwu/ItemContainerStyleSelectorDemo.zip)

请参考[http://www.cnblogs.com/Tealcwu/archive/2012/11/07/2759132.html](http://www.cnblogs.com/Tealcwu/archive/2012/11/07/2759132.html)，最后一节。

# sql-server-2008 - SQL Server 2000、2005、2008 兼容性

> ID：10359199
> 
> 赞同：1
> 
> 时间：2012-04-27T23:38:25.237
> 
> 标签：sql-server-2008, sql-server-2005, sql-server-2000

我应该如何编写代码以便可以在每个版本上运行它？

如果我在 SQL Server 2008 上开发代码，我可以在 2000 年和 2005 年不做任何更改的情况下运行相同的代码吗？

假设在 2008 年可以在单个插入语句中进行多次插入，但在 2005 年和 2000 年则不行。

我可以在 2005 和 2000 中运行相同的代码吗？

这是代码：

```
create table MergeMe (
id int identity(1,1),
Sname varchar(100),
dtDate datetime default getdate(),
)
insert into MergeMe values('Vikrant More',null),('Shrikant Gavli',null),('Saurabh Yete',null) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T04:32:24.387

您必须测试所有版本的代码是您希望代码在其上运行的 SQL Server。否则你永远无法确定它会起作用。

要使您的示例在 2005 和 2000 上工作，您可以使用一系列的`union all`代替。

```
insert into MergeMe
select 'first' union all
select 'second' union all
select 'third' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T23:44:05.857

用 ANSI SQL 编写所有内容，它应该在所有 SQL Server 版本中都能正常执行。无论如何，这通常是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T06:46:17.253

使用 SQL 92 标准进行编程实际上可以在任何（支持 SQL）数据库、SQL Server 或 Oracle 等上执行。

# php - 循环遍历文本并将每一行放入数组 PHP

> ID：10359201
> 
> 赞同：1
> 
> 时间：2012-04-27T23:38:41.427
> 
> 标签：php, arrays, for-loop

所以我创建了一个使用 PHP 执行的 Shell 命令，它返回如下内容：

```
deathletsgo
lordhaigh
pampos
cheese510
TheLoneRanger6 
```

而且我一直在尝试找到一种方法来循环遍历并将每个名称放在一个数组中的不同值中，所以喜欢`Servers[0]`包含 deadletsgo 并`Servers[1]`包含 lordhaigh 等，有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T23:40:25.953

```
$string = "deathletsgo
lordhaigh
pampos
cheese510
TheLoneRanger6";
$servers = explode("\n", $string); 
```

# c# - Process.Start()：系统找不到指定的文件，但我的文件路径似乎是合法的

> ID：10359204
> 
> 赞同：3
> 
> 时间：2012-04-27T23:39:09.493
> 
> 标签：c#, process, diagnostics, du

这让我难以置信。使用以下代码：

```
Process du = new Process();          

string cmdPath = System.IO.Path.Combine(Environment.SystemDirectory, "du.exe");
Debug.WriteLine(cmdPath);

ProcessStartInfo info = new ProcessStartInfo(cmdPath);
info.CreateNoWindow = true;

info.Arguments = arguments;            
info.UseShellExecute = false;

info.RedirectStandardOutput = true;
du.StartInfo = info;
du.EnableRaisingEvents = true;
du.OutputDataReceived += responseParser;

du.Start();
du.BeginOutputReadLine();
du.WaitForExit(); 
```

我运行它，我得到：

> 未处理的异常：System.ComponentModel.Win32Exception：系统找不到指定的文件

虽然 cmdPath 的输出值为`C:\Windows\system32\du.exe`!

当然，如果我只是在`cmdPath`命令提示符中输入 的内容，它会运行 du.exe 并为我提供使用信息。

另外，如果我只用“du.exe”替换命令路径，并将 du.exe 放在工作目录中，一切正常。但我想引用系统位置中的那个。

那么发生了什么？据我所知，我有一个合法的文件说明符，但为什么不`Process.Start()`执行呢？该基本代码还执行其他几个程序并获取它们的输出。其他都可以正常工作，尽管 du.exe 与它们不同，因为它位于 system32 目录中。这有关系吗？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-27T23:44:39.797

这取决于[文件系统重定向器](http://msdn.microsoft.com/en-us/library/aa384187%28v=vs.85%29.aspx)。您将在 64 位机器上运行 32 位进程。这意味着它`C:\Windows\system32`被透明地重定向到`C:\Windows\SysWOW64`，我希望`du.exe`在那里找不到。如果您`C:\Windows\Sysnative`改用，那么您将能够找到该文件。

但是，我怀疑您已添加`du.exe`到系统目录，因为这不是标准的 Windows 组件。你不应该那样做。我建议您将文件放在其他位置，因为您根本不应该在系统目录中写入。

# ruby-on-rails-3 - 日期选择器输入未通过验证

> ID：10359206
> 
> 赞同：0
> 
> 时间：2012-04-27T23:39:30.253
> 
> 标签：ruby-on-rails-3, simple-form

我正在使用引导程序和 simple_form。我已经在我的 application.js 文件中进行了调整，以使用 datepicker 而不是 simple_form 日期类型的默认下拉菜单，但是当我提交时，即使在填充字段后，我仍然会收到空字符串错误。

![截屏](../Images/6de5fa7a448eef32ce43bb6d7a97fee5.png)

有没有人遇到过这样的事情？

我很感激建议，坦率地说我在这里不知所措！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:21:22.230

事实证明，添加选项

```
 dateFormat: "yy-mm-dd", 
```

日期选择器成功了！

# objective-c - 在另一个 xib 中从 xib 加载自定义视图时遇到问题

> ID：10359211
> 
> 赞同：6
> 
> 时间：2012-04-27T23:40:26.370
> 
> 标签：objective-c, ios, interface-builder, xib, loadnibnamed

很抱歉，因为我看到有人问过这样的问题。但是，按照说明，我没有太多运气。我有兴趣使用 xib 文件创建自定义视图并在另一个视图控制器的 xib 文件中重用它。

现有职位：

[在另一个 xib 中使用 xib 对象](https://stackoverflow.com/questions/5095359/using-xib-object-inside-another-xib)

[如何一起使用 xib 和 UIView 子类？](https://stackoverflow.com/questions/4071738/how-to-use-a-xib-and-a-uiview-subclass-together)

我已经：

*   创建了一个自定义 xib 文件（我们称之为 CustomView.xib），以及对应的 .h 和 .m 类文件
*   将 xib 文件的 File's Owner 设置为 CustomView
*   创建了一个顶级 UIView，其他视图为子视图（UILabel 等）
    *   注意这有一个子 UIView 也是用代码编写的自定义视图
*   连接 IBOutlets
*   创建了一个 ViewController.xib 文件
*   添加了一个 UIView，将类设置为 CustomView 并将其连接起来

这导致在我构建应用程序时显示一个空白视图。

然后，我尝试了上述帖子之一所说的，即覆盖 CustomView 的 initWithDecoder 方法并添加以下内容：

```
NSArray *subviewArray = [[NSBundle mainBundle] loadNibNamed:NSStringFromClass([self class]) owner:self options:nil];
UIView *mainView = [subviewArray objectAtIndex:0];
[self addSubview:mainView]; 
```

不幸的是，这导致了以下错误：

```
Terminating app due to uncaught exception 'NSUnknownKeyException', reason: 
'[<UIView 0x548ff00> setValue:forUndefinedKey:]: 
```

我认为这可能是因为我没有将 CustomView.xib 中的顶级视图设置为 CustomView 类。于是我把它改成了CustomView，然后事情就进入了无限递归。这是有道理的，因为它只是一遍又一遍地重新加载自己。

不知道我从以前的帖子中错过了什么，但我会很感激任何指导！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T09:24:00.200

```
Terminating app due to uncaught exception 'NSUnknownKeyException', reason: 
'[<UIView 0x548ff00> setValue:forUndefinedKey:]: 
```

上述原因`error`通常是由于 中的连接失败`Interface Builder`，即`UIViewController`实现类中具有相应对象的对象。请检查您的所有连接`Interface Builder`。还要验证文件中的文件所有者`xib`。

我希望这能解决你的问题。

# node.js - 节点的Graphicsmagick不写整个jpg

> ID：10359214
> 
> 赞同：3
> 
> 时间：2012-04-27T23:41:02.710
> 
> 标签：node.js, graphicsmagick

我正在使用[https://github.com/aheckmann/gm](https://github.com/aheckmann/gm)来调整图像大小。

```
var fs = require('fs');
var gm = require('gm');

var input = __dirname   + '/input.jpg';
var output = __dirname + '/output.jpg';

gm(input)
  .resize(350)
  .stream( function(err, stdout, stderr) {

    var writeStream = fs.createWriteStream( output, { encoding: 'base64' } );

    var i = '';

    stdout.on( 'data', function(data){

      i += data.toString('base64');

    });

    stdout.on('end', function(){

      writeStream.write( new Buffer(i, 'base64') );
      writeStream.end();

    });

  } ); 
```

问题是它没有写入整个图像。

![半骆驼](../Images/1797aabbc39570c93c1126407f364e96.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T12:22:30.553

我已经通过使用[https://github.com/coolaj86/node-bufferjs](https://github.com/coolaj86/node-bufferjs) concat 方法解决了它。

```
var fs = require('fs');
var gm = require('gm');

var input = __dirname   + '/input.jpg';
var output = __dirname + '/output.jpg';

require('bufferjs');

gm(input)
  .resize(800)
  .stream( function(err, stdout, stderr) {

    ws = fs.createWriteStream( output );

    i = [];

    stdout.on( 'data', function(data){

      console.log('data');

      i.push( data );

    });

    stdout.on( 'close', function(){

      console.log( 'close' );

      var image = Buffer.concat( i );
      ws.write( image.toString('base64'), 'base64' );
      ws.end();

    });

  } ); 
```

显然，当您连接缓冲区时，您需要跟踪缓冲区的长度/索引。您可以通过查看 bufferjs 的 concat 方法的源代码找到更多信息：[https ://github.com/coolaj86/node-bufferjs/blob/master/bufferjs/concat.js](https://github.com/coolaj86/node-bufferjs/blob/master/bufferjs/concat.js)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T01:07:43.300

为什么不直接在获取数据时写入输出流？

```
var fs = require('fs');
var gm = require('gm');

var input = __dirname + '/input.jpg';
var output = __dirname + '/output.jpg';

gm(input).resize(350).stream(function(err, stdout, stderr) {

  var writeStream = fs.createWriteStream(output, {
    encoding: 'base64'
  });

  stdout.pipe(writeStream);

}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-22T13:31:22.027

只需这样做：

```
var gm = require('gm').subClass({imageMagick: true});

gm( 'kittens.jpg' )
.resize(50,50)
.write( "kittens-small.jpg", function (err) {
    if( err ) throw err;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-16T07:31:29.010

我发现`imagemagick`非常有用和简单。我也试过`graphicsmagick`但没有运气。

您可以`imagemagick`使用以下命令进行安装。

```
npm install imagemagick 
```

以下是 https://github.com/rsms/node-imagemagick 的示例代码`imagemagick`和[文档](https://github.com/rsms/node-imagemagick)：

```
var im = require('imagemagick');

im.resize({
  srcPath: 'kittens.jpg',
  dstPath: 'kittens-small.jpg',
  width: 50,
  height: 50
}, function(err, stdout, stderr){
  if (err) throw err;
  console.log('resized kittens.jpg to fit within 256x256px');
}); 
```

# svn - 巡航控制。NET 检测到用户名的未使用节点

> ID：10359215
> 
> 赞同：0
> 
> 时间：2012-04-27T23:41:16.113
> 
> 标签：svn, cruisecontrol.net

我在这里有一个难题。

我正在使用：CruiseControl.NET 服务器 1.6.7981.1

我们搬迁了办公室，同时我们的 SVN 存储库从通用堆栈转移到使用 LDAP 的客户端系统。

自从更改以来，我一直无法让 CruiseControl 与 SVN 一起工作。

这是我的配置中的内容：

```
<project ...
    <webURL>...
    <workingDirectory>...
    ...
    <sourcecontrol type="svn-change-detection">
      <svn-exe>C:\Program Files\Subversion\bin\svn.exe</svn-exe>
      <code-root-url>http://blah.blah.blah/svn/project/branches/product-lines/4.3.0</code-root-url>
      <tag-root-url>http://blah.blah.blah/svn/project/tag/4.3.0</tag-root-url>
      <build-interval>86400</build-interval>
      <username>LDAP_DOMAIN\USER</username>
      <password>AwesomePassword</password>
    </sourcecontrol> 
```

我得到的错误是：

```
[CCNet Server:ERROR] Exception: Unused node detected: <username>LDAP_DOMAIN\USER</username> 
```

从我看到的例子中，这应该是完全合法的......或者我错过了什么？

任何帮助都会动摇。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:29:38.397

你的配置全错了。您应该查看 SVN 块的文档。尝试这个。

```
<sourcecontrol type="svn">
  <executable>C:\Program Files\Subversion\bin\svn.exe</executable>
  <trunkUrl>http://blah.blah.blah/svn/project/branches/product-lines/4.3.0</trunkUrl>          
  <username>LDAP_DOMAIN\USER</username>
  <password>AwesomePassword</password>
</sourcecontrol> 
```

build-interval：这是您的项目配置的一部分，而不是源代码控制。

# modal-dialog - 在 IE 中向下滚动和刷新后出现 jquery 模式对话框的缺陷

> ID：10359216
> 
> 赞同：1
> 
> 时间：2012-04-27T23:41:27.817
> 
> 标签：modal-dialog, jquery-ui-dialog

我在 IE 中发现了一个关于 jquery 模式对话框行为的错误（或功能）（Firefox 可以正常工作）。

在 IE9（不确定其他 IE 版本）中，如果从页面底部调用，它会将对话框定位**在用户视口之外的可滚动页面的顶部。**这很容易在 IE 中从[jqueryui 对话框演示页面](http://jqueryui.com/demos/dialog/#modal)重现。

1.  导航到那里，
2.  关闭页面加载时出现的对话框，
3.  一直向下滚动到页面底部，
4.  然后点击刷新。

用户不会看到模态对话框，只会看到灰色的叠加层作为顶部有一个对话框并向上滚动并关闭/解决它的提示。加载时 IE 页面将闪烁片刻，显示对话框，然后快速回到底部对话框不可见的先前位置。

如果从那里调用，我确实看到了与此相关的其他关于`onclick="return false;"`在锚标记中使用的帖子，但是这个示例不是来自锚，所以我不确定它在这里如何工作，或者它是否适用。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T11:34:54.583

我发现了一个样式问题，它会导致 IE 导致 jqueryui 对话框出现此问题。如果您的正文或 html 的样式设置为 100% 的高度，则对话框始终以从顶部开始的固定位置显示。

# for-loop - symfony2 和 twig 用于子阵列

> ID：10359220
> 
> 赞同：4
> 
> 时间：2012-04-27T23:42:30.350
> 
> 标签：for-loop, symfony, twig

好吧，我有一个看起来像的数组。

```
[0] => Array (
  first_name => j,
  last_name => b,
  times => Array(
    [0] => Array(
        [in1] => a date here
        [out1] => a date here
        [in2] => a date here
        [out2] => a date here
    )
    [1] => Array(
        [in1] => another date here
        [out1] => another date here
        [in2] => another date here
        [out2] => another date here
    ))) 
```

为了 SO 布局，我简化了数组的外观......

这个列表通常会在开始数组中有超过 100 个不同的人，这些人都需要输出到浏览器......这很好，我可以做到......

```
{% for entity in entity %}
<h3>{{ entity.first_name }} {{ entity.last_name }} ( {{ start|date("m/d/Y") }} - {{ end|date("m/d/Y")}} )</h3>

<table = border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Date</th>
                <th>In</th>
                <th>Lunch Out</th>
                <th>Lunch In</th>
                <th>Out</th>
                <th>Extra In</th>
                <th>Extra Out</th>
                <th>Total Time</th>
            </tr>
        </thead>
        <tbody>
            {% for times in entity.times %}
            <tr>
                <td>{{ entity.times.daydate|date("M jS Y") }} </td>
                <td>{{ entity.times.in1 is empty ? "" : entity.times.in1|date("h:i A") }}</td>
                <td>{{ entity.times.out1 is empty ? "" : entity.times.out1|date("h:i A") }}</td>
                <td>{{ entity.times.in2 is empty ? "" : entity.times.in2|date("h:i A") }}</td>
                <td>{{ entity.times.out2 is empty ? "" : entity.times.out2|date("h:i A") }}</td>
                <td>{{ entity.times.in3 is empty ? "" : entity.times.in3|date("h:i A") }}</td>
                <td>{{ entity.times.out3 is empty ? "" : entity.times.out3|date("h:i A") }}</td>
                <td>{{ entity.times.totaltime }} Hours</td>
            </tr>
            {% endfor%}
        </tbody>
</table>
{% endfor %} 
```

那是我当前的树枝代码......我需要帮助的是，因为每个“实体”都有一个 .times 子数组，也需要循环通过......这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T03:38:05.257

```
{% for entity in entities %}
    <h3>{{ entity.foo }}</h3>

    {% for time in entity.times %}
        <p>{{ time.bar }}</p>
    {% endfor %}
{% endfor %} 
```

我已经简化了代码，以便更容易看到您正在寻找的概念。

# jquery - jquery淡出使它后面的图层变暗

> ID：10359221
> 
> 赞同：0
> 
> 时间：2012-04-27T23:43:01.217
> 
> 标签：jquery, css

很简单的前提。我有一个浮动图像，我想揭示它背后的图像。在 chrome 中工作正常，但在 FF 11 中不行。

```
$("#floater").fadeOut("slow");  

<div id="bg-image">
 <img id="bg-photo" class="photo" src="../images/blackberry.jpg" alt=""/>        
 <img id="floater" class="floater" src="../images/blackberry_flash.jpg"  alt="" />
</div>

#bg-image .photo 
{
    width: 100%;
    min-width: 1284px;
}

#container {
     width:100%;
     min-width:950px;
     margin-top:-13px;
}

#floater {
    position:fixed; 
    z-index:4;
    top:200px;
    left:200px;
} 
```

不是只是淡出以显示 z-index 0 处的图像，而是将该区域淡化为黑色。我的背景是白色的，没有其他 CSS 可以真正干扰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:33:26.827

这是一个火狐的错误。自 10 版以来，它就具有硬件加速功能。想知道为什么他们没有将修复程序纳入 11。

修复：将白色添加到实际 div（不是父级）的背景 [http://weblog.scanyours.com/2011/01/05/howto-solving-the-firefox-opacity-bug/](http://weblog.scanyours.com/2011/01/05/howto-solving-the-firefox-opacity-bug/)

原bug： [https ://bugzilla.mozilla.org/show_bug.cgi?id=723524](https://bugzilla.mozilla.org/show_bug.cgi?id=723524)

# android - 无法使用日历类和 AlarmManager 设置闹钟

> ID：10359224
> 
> 赞同：0
> 
> 时间：2012-04-27T23:43:58.860
> 
> 标签：android

我正在使用 Calendar 类来获取当前日期和时间。然后我设置警报的日期和时间，并将信息传递给 AlarmManager 对象。我有一个“设置警报”按钮单击它应该设置警报，不知何故单击该按钮没有反馈。

```
 Button btnOpen = (Button) findViewById(R.id.btnSetAlarm);
          btnOpen.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {                
            timePicker = (TimePicker) findViewById(R.id.timePicker);
            datePicker = (DatePicker) findViewById(R.id.datePicker);                   

            AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);                 

            Calendar calendar = Calendar.getInstance();       

            calendar.set(Calendar.YEAR, datePicker.getYear());
            calendar.set(Calendar.MONTH, datePicker.getMonth());
            calendar.set(Calendar.DAY_OF_MONTH, datePicker.getDayOfMonth());                 
            calendar.set(Calendar.HOUR_OF_DAY, timePicker.getCurrentHour());
            calendar.set(Calendar.MINUTE, timePicker.getCurrentMinute());
            calendar.set(Calendar.SECOND, 0);

        PendingIntent displayIntent = PendingIntent.getActivity(
            getBaseContext(), 0, 
            new Intent("my.todo.list.ShowNotification"), 0);               

         alarmManager.set(AlarmManager.RTC_WAKEUP, 
            calendar.getTimeInMillis(), displayIntent);
      }
      }); 
      } 
```

我使用的是安卓版本 4.0.1

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:09:50.887

首先，单击按钮不应该给您任何反馈。您没有包含任何代码来给您任何反馈。您所做的只是在某个特定时间设置警报。

其次，除非您有特定的理由，否则不要使用`getBaseContext()`，而您在这里没有这样的理由。使用`this`.

第三，除非您有一个带有 of 的活动，否则`<intent-filter>`当`<action>`警报`my.todo.list.ShowNotification`时间到来时，除了将警告或错误转储到 LogCat 之外，什么都不会发生。

# c# - 有没有更好的方法来做到这一点，也许用 LINQ ish 替换 for/foreach 循环？

> ID：10359231
> 
> 赞同：3
> 
> 时间：2012-04-27T23:45:36.243
> 
> 标签：c#, linq, for-loop

我有一份现有控股清单，我想合并到另一个控股清单中。我知道使用 foreach 和 for 循环是一个不好的方法，但我想不出使用 LINQ 来减少它的好方法。

```
private void CombineHoldings(List<Holding> holdingsToAdd, ref List<Holding> existingHoldings)
{
    foreach (Holding holdingToAdd in holdingsToAdd)
    {
        Boolean found = false;
        for (int i = 0; i < existingHoldings.Count; i++)
        {
            if (existingHoldings[i].Sector == holdingToAdd.Sector)
            {
                found = true;
                existingHoldings[i].Percentage += holdingToAdd.Percentage;
            }
        }
        if (!found)
            existingHoldings.Add(holdingToAdd);
    }
    foreach (Holding holding in existingHoldings)
        holding.Fund = "Combined Funds";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:51:58.513

让函数改变原始列表使其非常*非 Linq*，所以这里有一个版本将两个列表视为不可变：

```
private List<Holding> CombineHoldings(
    List<Holding> holdingsToAdd, 
    List<Holding> existingHoldings) 
{
    var holdings = existingHoldings.Concat(holdingsToAdd)
        .GroupBy(h => h.Sector)
        .Select(g => 
        { 
            var result = g.First(); 
            result.Percentage = g.Select(h => h.Percentage).Sum();
            return result; 
        });
    return holdings.ToList();
} 
```

绝对不会赢得表演比赛，但我喜欢它的简单性。以下可能会更快，但更复杂，并且需要您覆盖 Holdings 上的相等性以比较 Sectors 或创建`IEqualityComparer<Holding>`：

```
private List<Holding> CombineHoldings(
    List<Holding> holdingsToAdd, 
    List<Holding> existingHoldings) 
{
    var holdings = existingHoldings.GroupJoin(holdingsToAdd, h => h, h => h, 
        (h, toAdd) =>
        new Holding(
            h.Sector, 
            /*Other parameters to clone*/, 
            h.Percentage + toAdd.Select(i => i.Percentage).Sum())
        ).ToList();
    holdings.AddRange(holdingsToAdd.Except(holdings));
    return holdings;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T05:45:21.733

也许这可能有用。来自 MSDN 的链接。

[如何：从多个源填充对象集合 (LINQ)](http://msdn.microsoft.com/en-us/library/bb513866.aspx)

从另一个问题中找到此链接[https://stackoverflow.com/a/9746336/1278872](https://stackoverflow.com/a/9746336/1278872)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:43:06.170

你的问题有点模棱两可，你想摆脱 foreach 循环是因为[for 循环更快](http://codebetter.com/patricksmacchia/2008/11/19/an-easy-and-efficient-way-to-improve-net-code-performances/)，还是因为你觉得你有太多循环，还是因为你想要更好的性能？

假设这是一个关于提高性能的问题，我建议将现有的Holdings 从List 更改为一个[SortedList](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)，其中T 是Holding.Sector 的类型。为了获得最佳性能，Sector 应该是[整数变量类型](http://www.techotopia.com/index.php/C_Sharp_Variables_and_Constants#C.23_Integer_Variable_Types)，如 int。

```
private void CombineHoldings(List<Holding> holdingsToAdd, SortedList<int,Holding> existingHoldings) //Remove ref since List and SortedList are reference types and we are not changing the pointer.
{

    for (int i = 0; i < holdingsToAdd.Count; i++)
    {
        if (existingHoldings.ContainsKey(holdingsToAdd[i].Sector))
        {
            existingHoldings[holdingsToAdd[i].Sector].Percentage += holdingsToAdd[i].Percentage;
        }
        else
        {
            existingHoldings.Add(holdingsToAdd[i].Sector, holdingsToAdd[i]);
        }
    }
    for (int i = 0; i < existingHoldings.Count; i++)
    {
        existingHoldings.Values[i].Fund = "Combined Funds";
    }
} 
```

此方法将导致 O(m*log n + n)，其中 n 是 existingHoldings 中的元素数，m 是 holdingsToAdd 中的元素数。不幸的是，所有现有的Holdings 元素都必须更新它们的 Fund 值，因为它增加了通过该集合的额外通道。

注意：如果您不断地从现有馆藏中添加/删除项目，那么您可以使用应该更快的[SortedDictionary （SortedList 访问元素更快，但添加/删除需要更长的时间）](http://msdn.microsoft.com/en-us/library/ms132336.aspx)

编辑：重要的是要注意 LINQ 是用于搜索集合，而不是更新它们。因此，您可以使用 LINQ 查找在 existingHoldings 中存在和不存在的 holdingsToAdd，然后循环设置 Fund 和如果需要设置 Percentage 的现有Holdings，但随后将需要对 holdingsToAdd 和 existingHoldings 进行排序，并且您仍将循环每个收藏一次。这将是 O(2*m*log n + n) 的量级。编译器可能能够将这两个查询组合到一个调用中，但即便如此，您也会看到相似的性能，但可读性较差。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T01:10:30.480

我可能会选择这样的东西：

```
private void CombineHoldings(List<Holding> holdingsToAdd, ref List<Holding> existingHoldings)
{
    // group the new holdings by sector
    var groupedHoldings = holdingsToAdd.GroupBy(h => h.Sector);

    // now iterate over the groupings
    foreach(var group in groupedHoldings) {
         // calculate the sum of the percentages in the group
         // we'll need this later
         var sum = group.Sum(h => h.Percentage);

         // get the index of a matching object in existing holdings
         var existingHoldingIndex = existingHoldings.FindIndex(h => h.Sector == group.Key);

         // yay! found one. add the sum of the group and our job's done.
         if(existingHoldingIndex >= 0) {
             existingHoldings[existingHoldingIndex].Percentage += sum;
             continue;
         }

         // didn't find one, so take the first holding in the group, set its percentage to the sum
         // and append that to the existing holdings table
         var newHolding = group[0];
         newHolding.Percentage = sum;

         existingHoldings.Add(newHolding);
    }
} 
```

在性能方面，我不确定这如何成立。但它似乎更优雅一些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T00:36:47.663

如果您在列表中频繁调用此方法，那么我建议将其放入列表类型的扩展方法中，即

```
private static void CombineHoldings(this List<Holding> holdingsToAdd, ref List<Holding> existingHoldings)
{
    foreach (Holding holdingToAdd in holdingsToAdd)
    {
        Boolean found = false;
        for (int i = 0; i < existingHoldings.Count; i++)
        {
            if (existingHoldings[i].Sector == holdingToAdd.Sector)
            {
                found = true;
                existingHoldings[i].Percentage += holdingToAdd.Percentage;
            }
        }
        if (!found)
            existingHoldings.Add(holdingToAdd);
    }
    foreach (Holding holding in existingHoldings)
        holding.Fund = "Combined Funds";
} 
```

这将允许你在任何你创建了一个列表的地方去

```
List<Holding> temp1 = new List<Holding>();
List<Holding> temp2 = new List<Holding>();
//add here to temp1 and temp2
//then...
temp1.CombineHoldings(temp2); 
```

将第一个方法设为静态并将“this”关键字放在第一个参数前面意味着它将扩展该类型

查看参数虽然切换两者可能更有意义，因此它将添加到调用该方法的列表中，如下所示 -

```
private static void CombineHoldings(this List<Holding> existingHoldings, List<Holding> holdingsToAdd) 
```

# hash - 确定 16 位校验和计算的最有效方法是什么？[CRC地狱:-(]

> ID：10359235
> 
> 赞同：3
> 
> 时间：2012-04-27T23:46:12.410
> 
> 标签：hash, radio, checksum, crc, transmission

我目前正在从事一个涉及嗅探和修改无线电数据包的研究项目，不幸的是我遇到了一些数学难题。：-/

有问题的数据包有一个全为 1 的 16 位前导码，后跟一个二进制 0，然后是 32 位各种数据，然后是某种 16 位校验和，每个无线电数据包总共有 65 个位。

我使用逻辑分析仪收集了数百个数据样本，主要是通过强制发送设备报告不同的状态，并且我在[Excel](http://brokenpixel.net/samples/datasamples.xls "Excel")中收集了数据。

现在，进行传输的硬件已经很老了，大约是 90 年代初，所以我并不期待有什么花哨的东西。起初我只是想我会尝试手动解决，但运气不佳。在认为我已经使用几个 XOR、OR 和 XAND 解决了所有问题后，我意识到我的“公式”在具有不同序列号（前 16 位数据）的其他发射器上惨遭失败。

因为它只有 16 位，而且我认为它太旧了，所以我认为它可能是一个简单的 CRC，但我还没有找到能够提供远程正确结果的公式。

几年前，我什至从有类似问题的人那里找到了另一篇关于 StackOverflow 的帖子，但我梳理的解决方案似乎都没有帮助。

最终目标是能够为任意序列号创建传输，而无需访问实际的物理发射器。

想法？注释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:03:46.903

你有进步吗？

一些有用的链接：

1.  [bbcmicro.net 上的CRC 目录](http://regregex.bbcmicro.net/crc-catalogue.htm)。
2.  [Pycrc](http://www.tty1.net/pycrc/index_en.html)已经实现了许多 CRC 计算。
3.  [pycrc 的CRC 模型](http://www.tty1.net/pycrc/crc-models_en.html)。
4.  维基百科的“[常用和标准化_CRCs](http://en.wikipedia.org/wiki/Cyclic_redundancy_check#Commonly_used_and_standardized_CRCs) ”
5.  [蛮力多项式查找器](http://whats.all.this.brouhaha.com/2004/07/08/brute-force-crc-polynomial-finder/)
6.  [蛮力 CRC 参数](http://sitsec.net/blog/2012/02/10/brute-forcing-crc-parameters/)

# java-me - j2me 中是否有任何 API 可以在没有连接选择提示的情况下发出静默 http 请求？

> ID：10359245
> 
> 赞同：2
> 
> 时间：2012-04-27T23:48:27.527
> 
> 标签：java-me, midp, series-40

在我的 j2me 应用程序中，我试图通过网络获取一些数据，但如果连接可用，我想静默进行。我知道用户设置可用于提示/不提示 IAP 选择对话框，但我希望即使用户选择了“先询问”，也可以在我的应用程序中静默发出请求。

s40平台中是否有一些API可以实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T05:28:40.147

这是关于 MIDP 安全性而不是 API。当前的[安全策略](http://library.developer.nokia.com/topic/Java_Developers_Library/GUID-F5EAF83A-0553-4504-BCB8-752EBE86A60D.html)默认要求提示网络访问。如果您的应用程序是制造商或运营商签名的，则可以绕过它们。

# python - soundcloud-python 上传曲目非常慢

> ID：10359249
> 
> 赞同：1
> 
> 时间：2012-04-27T23:49:04.110
> 
> 标签：python, django, heroku, soundcloud

我正在使用 soundcloud-python api 包装器（https://github.com/soundcloud/soundcloud-python）将曲目上传到 SoundCloud。

一切正常，但将曲目上传到 SoundCloud 每兆字节大约需要 1 分钟（例如，使用 45 MB mp3 文件调用 client.post('/tracks', track=data) 大约需要 45 分钟才能上传）。

我已经验证我可以以 Gbps 的速度从这台服务器（它是 Heroku 上的工作人员测功机）通过互联网将数据推送到其他服务器。SoundCloud 是否会限制用于上传数据的 API，或者我可以调整哪些设置来帮助提高速度？

这是示例代码：

```
import soundcloud
client = soundcloud.Client(access_token='OAUTH2_ACCESS_TOKEN')
res = client.post('/tracks',
                  track={'title': 'my title',
                         'asset_data':open('file.mp3', 'rb') 
                        }
                 ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T06:11:45.377

您的代码是否有可能发送被路由器选择性过滤的数据包？正如上面提到的 Niklas B.，远程主机可能会限制速率。您联系过 Soundcloud 吗？尝试通过标准 Soundcloud 接口从您的服务器上传文件并计算传输速率。

还发现了这个[问题](https://stackoverflow.com/questions/9668311/soundcloud-api-throttling)，由 user1264242 于 3 月 12 日 13:52 提出

# ruby-on-rails - 在 HAML 上重复打印实例变量

> ID：10359254
> 
> 赞同：0
> 
> 时间：2012-04-27T23:50:21.610
> 
> 标签：ruby-on-rails, ruby, haml

我正在关注本教程（http://ruby.railstutorial.org/chapters/sign-up#sec:signup_form）。然而，当**清单 7.23**中的代码（转换为 haml）

```
=if @user.errors.any?
%div{:id => "error_explanation"}
  %div{:class=>"alert alert-error"}
    il modulo contiene errori
    %ul
      = @user.errors.full_messages.each do |msg|
        %li
          = msg 
```

我最终得到了双重打印输出：预期的打印输出，然后是变量的一种打印输出

```
Name can't be blank
Password is too long (maximum is 15 characters)
["Name can't be blank", "Password is too long (maximum is 15 characters)"]
<h1>Registrazione nuovo utente</h1> <div id='error_explanation'> <div class='alert alert-error'> il modulo contiene errori <ul> <li> Name can't be blank </li> <li> Password is too long (maximum is 15 characters) </li> [&quot;Name can't be blank&quot;, &quot;Password is too long (maximum is 15 characters)&quot;]</ul> </div> </div> 
```

我对 Rails 编程真的很陌生，但我真的不能。

谢谢， 马塞洛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:52:14.460

您的`if`陈述应以 a 开头`-`，而不是 a `=`：

```
- if @user.errors.any? 
```

你的循环也应该：

```
- @user.errors.full_messages.each do |msg| 
```

一般来说，如果你试图从 erb 转换为 haml ，`<% ... %>`就会变成`- ...``<%= ... %>``= ...`

# php - jquery会干扰php吗？

> ID：10359260
> 
> 赞同：2
> 
> 时间：2012-04-27T23:50:46.247
> 
> 标签：php, jquery, echo

我正在尝试限制评论和对评论的回复，并在达到限制后显示错误消息。我已成功限制评论和评论回复，并在仅提示评论而不是评论回复时成功提供了错误消息。

评论回复有一点 jquery 与他们一起工作，所以这是我能看到的唯一会导致消息不显示的事情。我尝试了其他方法，然后是当前使用的方法。

```
$valid = true;
$max_post_per_day = 5;
$max_reply_per_day = 5;

//THE REGULAR COMMENTS STRUCTURE THAT IS SHOWING THE ERROR MESSAGE PROPERLY

$query = "SELECT COUNT(*) FROM `cysticBlogComments`
              WHERE `userID` = $auth->id
                AND `date` = CURDATE()";
    $result = mysql_query($query, $connection);
    $post_count = mysql_result($result, 0);
    $error_msgs_max_comment[] = "Whoops! You have reached the maximum amount of comments allowed for the day.";

    if($post_count >= $max_post_per_day)
    {
        $valid = false;
    }
    else
    {

    $query = "INSERT INTO `cysticBlogComments` 
                                    ( `blogID`,
                                      `userID`,
                                      `commentBody`,
                                      `status`,
                                      `date`,
                                      `time`
                                      ) VALUES (

                                      '" . $blogID ."',
                                      '" . $auth->id ."',
                                      '" . mysql_real_escape_string($_POST['BlogComment']) ."',
                                      'active',
                                      '" . date("Y-m-d") . "',
                                      '" . date("G:i:s") . "')";

    mysql_query($query, $connection);

}

<?php if(isset($_POST['commentBlogSubmit']) && $post_count >= $max_post_per_day ) {
                foreach($error_msgs_max_comment as $msg) { ?>
                <div id="error_x">
                <?php echo $msg; ?>
                </div>
                <?php }
                }?>

//THE REPLY COMMENT STRUCTURE THAT IS LIMITING BUY NOT DISPLAYING ERROR AND HAS JQUERY WITH IT

$query = "SELECT COUNT(*) FROM `CysticBlogComments_replies`
                      WHERE `FromUserID` = $auth->id
                        AND `date` = CURDATE()";
            $result = mysql_query($query, $connection);
            $post_count = mysql_result($result, 0);
            $error_msgs_max_reply[] = "Whoops! You have reached the maximum amount of replies allowed for the day.";

            if($post_count >= $max_reply_per_day)
            {
                $valid = false;
                echo $error_msgs_max_reply;
            }
            else
            {

    $query = "INSERT INTO `CysticBlogComments_replies`
                                        ( `BlogCommentID`,
                                          `FromUserID`,
                                          `comment`,
                                          `status`,
                                          `date`,
                                          `time`
                                        ) VALUES (

                                        '" . mysql_real_escape_string($_POST['comment']) ."',
                                        '" . $auth->id ."',
                                        '" . mysql_real_escape_string($_POST['reply'])."',
                                        'active',
                                        '" . date("Y-m-d") . "',
                                        '" . date("G:i:s") . "')";

    mysql_query($query, $connection);
}

<?php if(isset($_POST['sub_comment_reply']) && $post_count >= $max_reply_per_day ) {
                foreach($error_msgs_max_reply as $msg) { ?>
                <div id="error_x">
                <?php echo $msg; ?>
                </div>
                <?php }
                }?>

//THE JS FOR THE REPLIES

<script type="text/javascript">
        $(document).ready( function() {

            $.localScroll({ offset:{top:-40,left:0} });

            $("a.reply_link").click( function() {
                $("#"+$(this).attr('name')).fadeIn('slow');
            });

            $(".respond_nevermind a").click( function(event) {
                event.preventDefault();
                var reply_box = document.getElementById($(this).attr('href'));
                $(reply_box).css('display','none');

                var reply_textarea = document.getElementById($(this).attr('href')+"_textarea");
                $(reply_textarea).val('');
            });
        });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T23:59:10.077

PHP 在执行 JavaScript 之前在服务器上运行，因此两者无法交互。JavaScript*可能*与 PHP 生成的 HTML 存在问题（换句话说，只有一个 JavaScript 错误），或者 HTML 本身可能包含错误，例如缺少结束符`>`或引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:16:19.693

看起来您在第二次通话`<?php`后没有正确关闭标签。`mysql_query()`您正在打开一个新`<?php`标签，但我没有看到前一个`<?php`标签被关闭。

# html - 父 div 不会自动继承其子元素的高度

> ID：10359263
> 
> 赞同：2
> 
> 时间：2012-04-27T23:51:00.080
> 
> 标签：html, css

我正在设计一个三栏网站，我想在左栏中显示一些特定人员的信息以及他们的个人资料照片。同时，我在 HTML 中使用它，并且我已经成功地设计了左列的代码。现在我试图在左栏中做一个细分，每个分区都反映了带有姓名和帐户信息的人的照片。

```
#column_left{
   display: inline;
  float: left;
  margin-left: 5px;
}
 #col1 #sub-div{
  width:100%;
  margin:auto;
  border-top:1px #333 solid;
  border-bottom:1px #333 solid;
}
 #col1 #sub-div #div-img { float:left; display:inline; width: 40px; height: 40px;
   } 
 #col1 #sub-div #div-info { float:left; display:inline; width:auto; height:auto; padding: 2px; } 
```

现在的问题是，即使两个 div（div-img 和 div-info）都在 sub-div 下，所以 sub-div 的高度必须根据其子 div 的高度而变化。但不幸的是，子 div 以正确的顺序对齐，但父 div 没有任何高度，除非在#sub-div 的 css 代码中提到它。

谁能告诉我为什么父元素没有继承子元素的高度？我在某个地方错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:03:46.550

你需要清除你的浮动。将此行添加到左侧 div 的底部以了解我的意思：

```
<div style="clear: both"></div> 
```

要了解更多关于为什么浮动需要清除的信息，请参阅[这篇文章](http://css-tricks.com/all-about-floats/)。[这个问题的答案](https://stackoverflow.com/questions/4111564/what-is-the-current-best-solution-to-clear-floats-such-as-div-style-clear-b)提供了更多清晰的解决方案。

# google-maps - 用户如何与事件/地点签到相关联？

> ID：10359269
> 
> 赞同：0
> 
> 时间：2012-04-27T23:52:10.310
> 
> 标签：google-maps, google-places-api

我无法弄清楚用户如何与特定地点或事件的签到相关联。

看起来没有用户信息被传递到签入端点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T03:31:33.623

没错，没有用户信息与签入相关联。签入增加了下次搜索您的应用程序时出现相同地点或事件的可能性。

# .htaccess - .htaccess 重写规则以在重定向到新域时保留子域

> ID：10359271
> 
> 赞同：3
> 
> 时间：2012-04-27T23:52:20.213
> 
> 标签：.htaccess, mod-rewrite

我正在将一个站点从具有多个子域的旧域移动到一个新域。我想创建一个重写规则，将旧域换成新域，但我对正则表达式和 .htaccess 的了解不够：P

我可以让 301 重定向为域上的页面工作：

```
RewriteCond %{HTTP_HOST} ^(.*)oldomain.org [NC]
RewriteRule ^(.*)$ http://newdomain.com/$1 [R=301,L] 
```

关于如何修改它以包含子域的任何线索？或者我是否坚持在单独的重写中列出所有子域？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T09:41:58.267

你只需要添加一个`%1`

```
RewriteCond %{HTTP_HOST} ^(.*)oldomain.org [NC]
RewriteRule ^(.*)$ http://%1newdomain.com/$1 [R=301,L] 
```

# c# - 具有第三方用户配置文件管理的 ASP.NET MVC 3 应用程序？

> ID：10359272
> 
> 赞同：2
> 
> 时间：2012-04-27T23:52:30.003
> 
> 标签：c#, .net, asp.net-mvc-3, user-profile

我正在建立一个涉及用户交互的网站。有些人将创建新主题，而其他人将投票并撰写反馈。我正在尝试找出处理用户帐户管理的最佳方法，但我在这里苦苦挣扎。

我不想让用户通过我的网站注册帐户。但是，请使用许多流行的网络之一登录，例如 Facebook、Twitter、Google 等。重要的是我从登录过程中获取一些用户信息，例如姓名、个人资料图片、某种 guid，也许是电子邮件地址。

环顾四周，我发现了很多听起来像是可行的东西，但更深入的调查却无法满足我的需求。

到目前为止，Disqus 和 OpenId 看起来最有前途，但我只是不确定它们是否满足我的要求。

OpenId 示例似乎在身份验证后返回一个 url，该应用程序似乎与创建新的本地用户帐户一起使用：

![在此处输入图像描述](../Images/4870d041ba6e68470882461cc2e09b10.png)

然后您注册一个新帐户：

![在此处输入图像描述](../Images/aaa3c16c5997d5d7285aa806a36036d0.png)

似乎 OpenId 示例从 2008 年开始有点过时，所以我想知道这是否已经消失了。

Disqus 位看起来非常广泛，并且没有提供任何示例来知道我是否走在正确的轨道上。

2012 年人们使用什么来创建 100% 依赖第三方用户配置文件管理的新网站？

# jquery - 是否可以制作一个功能，当单击时会多次更改图像？

> ID：10359276
> 
> 赞同：1
> 
> 时间：2012-04-27T23:53:18.763
> 
> 标签：jquery, html, function, css, slider

基本上，我需要的是一个可以点击的元素，从海报图像变为过渡图像，然后变为主要图像。这是一个视频滑块，我试图用和图像掩盖视频的加载。因此，当单击该元素时，海报图像会切换为灰色图像，然后淡出到实际视频本身。

我正在使用 jquery 和 html5，但我似乎做不到。我希望有人能指出我在哪里可以找到方法，或者自己帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:37:31.097

您可以使用[window.setTimeout()](https://developer.mozilla.org/en/DOM/window.setTimeout)方法。你传入两个参数，第一个参数是你想要延迟的函数，第二个参数是延迟的时间，以毫秒为单位。

```
changePosterImageToATransitionImage();

window.setTimeout(  
    function() {  
        andThenToTheMainOne();  
    },  
    1000  
); 
```

# php - 当 AJAX 调用不同的编码页面时，实际会发生什么？

> ID：10359281
> 
> 赞同：3
> 
> 时间：2012-04-27T23:53:48.360
> 
> 标签：php, ajax, character-encoding

假设我的页面是 UTF-8 编码的，并且我的代码调用`a.php`where`a.php`是通过 ajax (jQuery) 获取的，并且调用`$.get`的文件具有不同的编码，如`windows-1255`标题中指定的？幕后发生了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T23:58:32.870

好吧，一切都只是字节，直到网络浏览器解释它们并将它们翻译成字符呈现给用户。所以在 AJAX 中发生什么并不重要，因为无论如何都会存在编码冲突。

例如，如果 AJAX 返回编码为 UTF-8 的斯堪的纳维亚字符“å”，则它使用两个字节 0xc3a5 进行编码。现在，如果 Web 浏览器期望编码为 UTF-8，那么它们将作为 'å' 呈现给用户，没问题。但是，如果 Web 浏览器需要拉丁语 1，它们本质上将被解释为两个字符，即 0xc3 和 0xa5，它们恰好代表字符 Ã¥。

# c++ - 为什么我不能在 c++ 中初始化一个将自身合并到其初始值中的对象？

> ID：10359289
> 
> 赞同：3
> 
> 时间：2012-04-27T23:55:31.053
> 
> 标签：c++, string, undefined-behavior

当我遇到以下代码时，我正在调试一个程序，我错误地键入了类似于以下内容：

```
//Original (wrong)
std::string first("Hello");
std::string second = first + second;

//Instead of this (correct)
std::string first("Hello");
std::string second = first + something_else; 
```

显然我并没有尝试这样做（我想不出为什么有人会想要这样做），但这让我思考。它看起来不像原来的应该工作，我认为它是未定义的。确实，这是我问题的根源。

为了使问题更普遍，请考虑以下几点：

```
SomeType a;
SomeType b = a + b; 
```

行为未定义仅仅是因为`b`尚未初始化（请参阅[此答案](https://stackoverflow.com/a/367662/1272627 "回答")）？

如果行为未定义，那么我真正的问题是，为什么？

这是否仅针对某些标准容器未定义，例如`std::string`，还是在更一般的意义上未定义（STL 类、用户定义的类、POD、基本类型）？

标准的哪一部分适用于此？

如有必要，假设这是 c++11。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T00:03:57.610

C++11 标准对新声明名称的范围有这样的说法：

> 3.3.2 声明点[basic.scope.pdecl]
> 
> 名称的声明点紧跟在它的完整声明符（第 8 条）之后和它的初始化器（如果有的话）之前，除非下面提到。[ 例子：
> 
> ```
> int x = 12;
> { int x = x; } 
> ```
> 
> 这里第二个 x 用它自己的（不确定的）值初始化。—结束示例]

以前的 C++ 标准中有类似的措辞。

在我的脑海中，我能想到的一个基本原理是，该名称可以用于获取对象地址的初始化表达式中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:02:33.730

读取未初始化的变量可能会导致未定义的行为。

标准是这样说的：

> **初始化程序 [dcl.init]**
> 
> …………
> 
> 如果没有为对象指定初始化器，则该对象是默认初始化的；如果不执行初始化，则具有自动或动态存储持续时间的对象具有不确定的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-30T20:07:15.457

原因很简单：因为语法是糖。看似简单的赋值，实际上是复制构造；表达式的右手被评估并传递给左手的复制构造函数。

```
SomeType b = a + b; 
```

实际上是

```
SomeType b(a + b /*wat?*/); 
```

这背后的部分动机是 RVO。改为考虑以下情况

```
SomeType a, b;
SomeType c = a + b; 
```

`c`实际上可以作为用于构造返回值的`temp`对象转发。`a.operator+(b)`

```
SomeType SomeType::operator+(const SomeType& rhs) const
{
    SomeType temp(*this); // RVO will employ `c` here instead of a 4th object.
    ...
    return temp; // yeah, let's not and say we did.
} 
```

请注意，您*可以*使用自己的地址：

```
inptr_t i = (intptr_t)&i;
void* ptr = &ptr; 
```

[http://ideone.com/GUJyio](http://ideone.com/GUJyio)

# c++ - 我想返回一个向量的函数 但被告知竞争未声明，我正在使用未定义的类'std::vector'

> ID：10359291
> 
> 赞同：1
> 
> 时间：2012-04-27T23:55:49.450
> 
> 标签：c++, error-handling, compiler-errors

我正在尝试使用我正在调用的函数来构建向量`vector<Competition> CompPop()`。我想返回一个类型的向量信息`vector<Competition>`。下面是我为我的`Competition`类返回向量和标题的函数的代码。

我收到以下错误（我正在使用 Visual Studio 并且错误消息非常基本，让我猜测我实际上做错了什么）：

> -error C2065：“竞争”：未声明的标识符
> 
> 'CompPop' 使用未定义的类 'std::vector'
> 
> “竞争”：未声明的标识符
> 
> 错误 C2133：“信息”：未知大小
> 
> 错误 C2512：“std::vector”：没有合适的默认构造函数可用
> 
> 错误 C2065：“竞争”：未声明的标识符
> 
> 错误 C2146：语法错误：缺少“；” 在标识符“temp”之前
> 
> 错误 C3861：“临时”：找不到标识符
> 
> 错误 C2678：二进制“[”：未找到采用“std::vector”类型的左操作数的运算符（或没有可接受的转换）

* * *

```
 #pragma once

    #include <fstream>
    #include <sstream>
    #include <iostream>
    #include <string>
    #include <vector>
    #include "LogIn.h"
    #include "Registration.h"
    #include "Tree.h"
    #include "PriorityQueue.h"
    #include "Events.h"
    #include "Competition.h"
    using namespace std;

    vector<Competition> CompPop()
    {
        ifstream myfile("Results.txt");

        string line, tcomp, tleader, tfollower, tevents, tplacement;
        vector<Competition> info;
        istringstream instream;
        if(myfile.is_open())
        {
         int i = 0; // finds first line
         int n = 0; // current vector index
         int space;
         while(!myfile.eof())
         {
        getline(myfile,line);

        if(line[i] == '*')
        {
            space = line.find_first_of(" ");

            tleader = line.substr(0+1, space);
            tfollower = line.substr(space + 1, line.size());

        }
        else
        {
            if(line[i] == '-')
            {
                tcomp = line.substr(1, line.size());
                Competition temp(tcomp, tleader, tfollower);
                info[n] = temp;
            }
            else
            {
                if(!line.empty())
                {
                    line = line;

                    space = line.find_first_of(",");
                    tevents = line.substr(0, space);
                    tplacement = line.substr(space + 2,     line.size());
                    info[n].pushEvents(tevents,tplacement);
                }
                if(line.empty())
                {
                    n++;
                }
            }
           }
            }
        }
       else
       {
        cout << "Unable to open file";
       }

       myfile.close();

      return info;
    } 
```

我的比赛标题：

```
 #pragma once

    #include <fstream>
    #include <sstream>
    #include <iostream>
    #include <string>
    #include <vector>
    #include "LogIn.h"
    #include "Registration.h"
    #include "Tree.h"
    #include "PriorityQueue.h"
    #include "Events.h"
    #include "CompPop.h"
    using namespace std;

    struct Competition
    {
         public:

     Competition(string compName, string lead, string follow)
     {
    Name = compName;
    Leader = lead;
    Follower = follow;
     }

     void pushEvents(string name, string place)
     {
    Events one(name, place);
    Eventrandom.push_back(one);
     }

     string GetName()
     {
    return Name;
     }

     string GetLeader()
     {
    return Leader;
     }

     string GetFollow()
     {
    return Follower;
     }

     string GetEvent()
     {
    return Event;
     }

     string GetScore()
     {
    return Score;
     }

      ~Competition();

     private:
   string Name, Leader, Follower, Event, Score;

   vector<Events> Eventrandom;
     }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:05:59.033

看起来您没有在源文件中`#include`添加标头。`Competition`

顺便说一句，它看起来也像你`using namespace std;`在你的标题中做的那样。 [这不是一个好的做法](https://stackoverflow.com/questions/1265039)。

**根据更新信息进行编辑：**

这是一个循环依赖问题。

如果您只是在 CompPop.h 中转发声明`Competition`和声明`CompPop`，并将实现添加`CompPop`到 CompPop.cpp，您将打破循环。

所以将 CompPop.h 更改为：

```
#pragma once
#include <vector>
struct Competition;
std::vector<Competition> CompPop(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:12:21.867

看起来您缺少包含或使用语句。

即要么缺少 Component 的标头，要么缺少 std::vector 的标头，或者两者兼而有之。

还要确保您拥有`using namespace std;`或`using std::vector;`

如果不是这种情况，请提供更多代码，以便我们对其进行全面检查。

[编辑]**根据您的评论更新您** 是否使用包含防护？

# c# - 参考 System.Data.Services.Client

> ID：10359294
> 
> 赞同：0
> 
> 时间：2012-04-27T23:56:27.173
> 
> 标签：c#, wolframalpha

我正在使用 VS C# 2010 Express，我正在尝试使用[这篇文章](https://stackoverflow.com/questions/4834913/wolfram-alpha-api-wrapper-for-vb-not-working-for-c-sharp)中的代码，但在导入时出现错误：

```
using System.Data.Services.Client; 
```

我试图添加对它的引用，但在任何地方都找不到该项目，假设这确实是问题所在。关于如何编译此代码的任何方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:13:51.030

您确定您的目标是框架版本 3.5 或更高版本吗？尝试通过 VS 将其添加为参考时，完整框架和客户端配置文件 >= 3.5 都应将此作为选项显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T11:03:40.980

我发现有时 Visual Studio 会在这方面发挥作用。值得转到项目页面并将 .Net Framework 设置为任何版本，然后返回 4.0。

基本上是关机再开机！

# c - postgreSQL 客户端（libpq）中的分段错误

> ID：10359298
> 
> 赞同：2
> 
> 时间：2012-04-27T23:57:12.800
> 
> 标签：c, debugging, postgresql, segmentation-fault, libpq

我正在使用 libpq 开发一个 postgreSQL 客户端应用程序。gcc 编译它没有错误。但是，当我运行程序时，此功能：

```
void print_column(PGconn *connection) {

    PGresult *id_list;
    int row;

    // process_query() calls PQexec(), checks for errors, then returns the result
    id_list = process_query(connection, "SELECT id FROM customers WHERE state='CA'");

    for(row = 0; row < PQntuples(id_list); row++) {
        printf("%s\n", PQgetvalue(id_list, row, 0));

        // to pause the loop on each rep for debugging
        getchar();
    }
} 
```

产生错误：

```
row number 1701734765 is out of range 0..8
Segmentation fault 
```

奇怪的是 for 循环执行前五次重复没有问题。然后它导致第六个分段错误。

我没有发布整个程序，因为它有 1000 多行。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:10:18.043

这不会导致分段错误，但您发布的代码中有错误。

```
printf("%i\n", PQgetvalue(id_list, row, 0)); 
```

该`PQgetvalue`函数返回 a `char *`，但您将其打印为`int`. GCC 和 Clang 都有警告，会抱怨类型不匹配，我建议`-Wall -Wextra`或至少`-Wall`。您可以使用*仅*打开格式不匹配警告`-Wformat`。（这个错误几乎肯定不会导致分段错误，但会导致输出不正确。）

But `PQgetvalue` should not cause a segmentation fault (you haven't called `PQclear`, right?). It is possible there is an error somewhere else in your program that is corrupting memory. You can use a tool such as Valgrind to try and detect such errors. 1000 lines isn't so long that such a problem is intractable, you can also comment out various sections with `#ifdef 0`...`#endif` until the error stops, if you're desperate.

# php - 值不进入switch语句

> ID：10359302
> 
> 赞同：-5
> 
> 时间：2012-04-27T23:58:22.980
> 
> 标签：php, switch-statement

我有一个电子商务网站项目，这是细节，这只是我无法解决的小问题。我有两张桌子，第一张桌子叫做物品，第二张桌子是购物车。我在一个页面中链接了名为“添加到购物车”的链接，将我转换为 cart.php

`a href="cart.php? action=add & id=<?php echo $itemId; ?>"> Add to Cart </a><br/>`

```
'<a href="cart.php? action=show & id=<?php echo $itemId; ?> ">View Shopping Cart </a>` 
```

之后我有 cart.php 页面：

```
 <?php 
// Script Error Reporting
error_reporting(E_ALL);
ini_set('display_errors', '1');
?>
<html>
<head>
<title> Cart Page </title>
</head>
<body>
<?php
include "function.php";
ConnectToDb( );
$id= $_GET['id'];
$action = $_REQUEST['action'];
$action=(isset($_GET['action']) && $_GET['action'] != '') ? $_GET['action'] : 'view';

switch($action){
case "add":
{$sql=mysql_query("SELECT * FROM items WHERE itemId='$id'");
 $row=mysql_fetch_array($sql);
 $itemPrice= $row["itemPrice"];
 $itemName= $row["itemName"];
 $quanty=$row["qty"];

$query="insert into cart values('1',".$_GET[id].",1,".$itemPrice.",".$itemName.")";
$result=mysql_query($query);
header("location:cart.php? action=show ");
echo "Item Was Added";
break;
}
case "remove":
{
$query="delete from cart where itemId=".$_GET['id'];
$result = mysql_query($query);
header("location:cart.php?action=show");
}

case "update":
{
$query="update cart set". $quanty = $_POST['quantity']."where itemId=".$_GET['id'];
$result = mysql_query($query);
header("location:cart.php?action=show");
break;
}
case "show_update":
{
$result = mysql_query("select * from cart");
$uid=$row["uid"];
$itemId= $row["itemId"];
$qty=$row["qty"];
$itemPrice=  $row["itemPrice"];
$itemName=  $row["itemName"];
while($row = mysql_fetch_array($result))
{   if ($itemId == $id )
    {  
            $totalCost =0;
            $query = "select * from cart inner join items on cart.itemId= items.itemId";    
            $result = mysql_query($query); 
            echo "<table width ='100%' border ='1'>"; 
            while($row = mysql_fetch_array($result)) 
            {$totalCost += ($qty * $itemPrice);
            echo "<tr>";
            echo "<td>";    echo $itemName;     echo "</td>";
            echo "<td> SR"; echo $itemPrice;    echo "</td>";
            echo "<td> <input type ='text' name='quantity' value=".$qty."</td>";
            echo'<td width="23%"><a href="cart.php?action=update&id='.$itemId.'">save</a></td>';
            echo'<td width="23%"><a href="cart.php?action=remove&id='.$itemId.'">Remove</a></td>';
            echo"</tr>";}
            // Increment the total cost of all items
            $totalCost += ($row["qty"] * $row["itemPrice"]);
            echo "<tr> <td colspan='2'> <a href='products.php'>Keep Shopping</a></td>";
            echo "<td colspan='2'> <b>Total: SR".$totalCost."</b></td></tr>";
            echo "</table>";
            }
        else{   
            $totalCost =0;
            $query2 = "select * from cart inner join items on cart.itemId= items.itemId";   
            $result2 = mysql_query($query2); 
            echo "<table width ='100%' border ='1'>"; 
            while($row2 = mysql_fetch_array($result2)) 
            {$totalCost += ($row2["qty"] * $row2["itemPrice"]);
            echo "<tr>";
            echo "<td>";    echo $row2['itemName'];     echo "</td>";
            echo "<td> SR"; echo $row2["itemPrice"];    echo "</td>";
            echo "<td>";     echo $row2["qty"];         echo "</td>";
            echo'<td width="23%"><a href="cart.php?action=show_update&id='.$row2["itemId"].">edit</a></td>";
            echo'<td width="23%"><a href="cart.php?action=remove&id='.$row2["itemId"].">Remove</a></td>";
            echo"</tr>";
            }
            // Increment the total cost of all items
            $totalCost += ($row2["qty"] * $row2["itemPrice"]);
            echo "<tr> <td colspan='2'> <a href='homestore.php'>Keep Shopping</a></td>";
            echo "<td colspan='2'> <b>Total: SR".$totalCost."</b></td></tr>";
            echo "</table>";}
            break;
}}
case "show":
{
$totalCost =0;
$query = "select * from cart inner join items on cart.itemId = items.itemId";
$result = mysql_query($query);
?>
<table width="100%" border="1"> 
    <?php while($row = mysql_fetch_array($result))
    {   
    $totalCost += ($row["qty"] * $row["itemPrice"]);
    ?>
    <tr>
    <td><?php echo $row["itemName"]; ?></td>
    <td>SR<?php echo $row["itemPrice"]; ?></td>
    <td><a href="cart.php?action=show_update&id=<?php echo $row["itemId"]; ?>">edit</a></td>
    <td><a href="cart.php?action=remove&id=<?php echo $row["itemId"]; ?>">Remove</a></td>
    </tr>
<?php } 

// Increment the total cost of all items
$totalCost += ($row["qty"] * $row["itemPrice"]);
$totalCost = $totalCost + ($row["qty"] * $row["itemPrice"]); ?>
<tr> <td colspan="2"> <a href="products.php">Keep Shopping</a></td>
<td colspan="2"> <b>Total: SR<?php echo $totalCost; ?></b></td></tr>
</table>

<?php break; }
}

?>
</body>
</html> 
```

如果用户单击链接，则操作 =“添加”和产品 ID 将转换为 cart.php，问题是 $action 无法插入到 Switch 语句中，即使我已经回显了 $action 并且它打印添加 I不知道为什么它没有进入 switch statment 我也尝试回显 $id 并打印 2 这是正确的2 我想发疯，因为我整天在笔记本电脑上设置 2 并且它不工作。

在这里，我不与购物车的会话或用户发生冲突，这就是为什么在添加情况下我刚刚插入 1 作为 uid 的第一个值，如果它成功，我将添加会话。按下添加到卡后，它将直接转移到我们找到编辑和删除的展示案例，当然在展示案例中按删除它会将他转移到移除案例

如果他在展示案例中按下编辑链接，它将转移他到展示更新案例，他可以在其中编辑数量，如果 id 匹配 id 文本框将生成其他产品将没有文本框，默认数量将为 1 如果文本框生成保存链接它将出现改变他更新情况的情况，我们更新购物车表中的数量。

我只是想知道为什么`$action`不能进入 switch 语句？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T22:49:34.677

我找到了解决方案；如果你知道答案，你会笑的。这是：

它不应该开始， `$id= $_GET['id'];` 因为在“添加”到购物车“链接中，动作首先出现`id`。
我 `$id= $_GET['id'];` 从一开始就删除了，我把它放在每个箱子里，它正在工作。谢谢你的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:04:50.217

在此行之后回显 $action

```
$action=(isset($_GET['action']) && $_GET['action'] != '') ? $_GET['action'] : 'view'; 
```

并检查它的值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T00:10:45.563

你知道这些行是做什么的吗：

```
'<a href="cart.php? action=show & id=<?php echo $itemId; ?> ">View Shopping Cart </a>` 
```

和

```
$action=(isset($_GET['action']) && $_GET['action'] != '') ? $_GET['action'] : 'view'; 
```

如果没有，我谦虚地建议您考虑购买电子商务解决方案或使用开源选项。

如果你这样做了，那么你应该看到这实际上是你的错误源于你的查询字符串中的空格。

此外，由于您没有`view`分支或`default`分支，因此您将跳过整个`switch`语句。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-28T00:00:32.703

更改`$_GET[id]`为，`$id`因为您已经在 $id 中收到了这个

# vb.net - GetBestInterface 的托管替代方案？

> ID：10359303
> 
> 赞同：2
> 
> 时间：2012-04-27T23:58:30.243
> 
> 标签：vb.net, native-code, iphelper

我完全没有使用 C（或任何其他非托管语言）编程的背景，但我想在我的 .NET 应用程序中使用 IP Helper API 中的[GetBestInterface](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365920%28v=vs.85%29.aspx)函数。我试图了解如何使用 P/invoke 调用来调用本机方法，但有很多事情对我来说没有意义（例如托管代码中的类型如何映射到非托管类型）。

System.Net 命名空间中是否有隐藏在某个地方的替代函数可以做大致相同的事情？或者我可以使用现有的基类结合一些魔法来编写自己的替代方案吗？因为在我看来，这基本上就是：魔法。据我所知，该方法如何完成它的工作并没有真正的解释......

**编辑**

我刚刚在类上发现了 LocalEndPoint 属性`System.Net.Sockets.Socket`，我认为这在这方面可能非常有用。据我了解，它将代表我进行最佳接口选择，我只需要获取与本地端点对应的 NIC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-06-06T20:32:35.083

我还需要[`GetBestInterface`](https://docs.microsoft.com/en-us/windows/desktop/api/iphlpapi/nf-iphlpapi-getbestinterface)，因为我需要一个解决方案，该解决方案可以在无法访问要探测的远程地址时工作（Steven 的解决方案会遇到问题），并且与我移植到 C# 的本机应用程序 100% 兼容。

幸运的是，您不必移植[`GetAdaptersInfo`](https://docs.microsoft.com/en-us/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersinfo)和所有相应的[`IP_ADAPTER_INFO`](https://docs.microsoft.com/en-us/windows/desktop/api/iptypes/ns-iptypes-_ip_adapter_info)子结构混乱来查找哪个网络接口具有由 .NET 返回的索引`GetBestInterface`，因为[.NET 也可以从接口检索该索引](https://stackoverflow.com/questions/11059632/finding-the-interface-index-in-c-sharp)。

所以，首先移植`GetBestInterface`方法如下：

```
[DllImport("iphlpapi")]
private static extern int GetBestInterface(uint dwDestAddr, ref uint pdwBestIfIndex); 
```

然后，编写一个包装函数，如下所示：

```
private static NetworkInterface GetBestNetworkInterface(IPAddress remoteAddress)
{
    // Get the index of the interface with the best route to the remote address.
    uint dwDestAddr = BitConverter.ToUInt32(remoteAddress.GetAddressBytes());
    uint dwBestIfIndex = 0;
    uint result = GetBestInterface(dwDestAddr, ref dwBestIfIndex);
    if (result != 0)
        throw new NetworkInformationException((int)result);

    // Find a matching .NET interface object with the given index.
    foreach (NetworkInterface networkInterface in NetworkInterface.GetAllNetworkInterfaces())
        if (networkInterface.GetIPProperties().GetIPv4Properties().Index == dwBestIfIndex)
            return networkInterface;

    throw new InvalidOperationException($"Could not find best interface for {remoteAddress}.");
} 
```

然后，您可以像这样简单地调用该方法 - 不要忘记无法访问的主机现在也可以工作：

```
NetworkInterface bestNetworkInterface = GetBestNetworkInterface(IPAddress.Parse("8.8.8.8")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T10:57:16.813

好吧，我自己整理了一些东西，这些东西通过捎带框架自己进行界面选择的能力来工作。本质上它只是连接一个套接字，然后使用套接字上的 LocalEndPoint 属性来获取它正在使用的 NIC。可能不是最好的方法，但它对我有用。

使用以下导入语句：

```
Imports System.Net
Imports System.Net.NetworkInformation
Imports System.Net.Sockets 
```

还有我超级棒的方法：

```
Private Function GetBestInterfaceManaged(ByVal address As IPAddress, ByVal port As Integer) As NetworkInterface

    Dim socket As Socket = New Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.IP)
    Dim outgoingInterface As NetworkInterface = Nothing

    Try
        socket.Connect(New IPEndPoint(address, port))

        If socket.Connected Then ' find the outgoing NIC

            Dim interfaces As List(Of NetworkInterface) = NetworkInterface.GetAllNetworkInterfaces.ToList()

            For Each nic As NetworkInterface In interfaces
                Dim properties As IPInterfaceProperties = nic.GetIPProperties

                For Each unicastAddress In properties.UnicastAddresses
                    If unicastAddress.Address.Equals(DirectCast(socket.LocalEndPoint, IPEndPoint).Address) Then
                        outgoingInterface = nic
                    End If
                Next
            Next

            If outgoingInterface Is Nothing Then
                Console.WriteLine("Darn... it didn't work!")
            Else
                Console.WriteLine("Outgoing interface: {0}", outgoingInterface.Name)
            End If

            Return outgoingInterface
        End If
    Catch ex As SocketException
        Console.WriteLine(ex.Message)
    End Try
    Return Nothing
End Function 
```

这可以解决问题：

```
Sub Main()
    Dim hostEntry As IPHostEntry = Dns.GetHostEntry("www.stackoverflow.com")
    Dim NIC As NetworkInterface = GetBestInterfaceManaged(hostEntry.AddressList.First, 80)
    ' Other code goes down here
End Sub 
```

# python - 快速基本循环

> ID：10359309
> 
> 赞同：2
> 
> 时间：2012-04-27T23:59:25.507
> 
> 标签：python, loops, for-loop

我在文件中有以下几行。这是一行的示例：

> 近乎_？？？chr12 - 10 110 10 110 3 10,50,100, 20,60,110,

我有以下代码来获取信息：

```
fp = open(infile, 'r')
for line in fp:
     tokens = line.split()
     exonstarts = tokens[8][:-1].split(',')
     exonends = tokens[9][:-1].split(',') 
```

这会给我一个像这样的列表：

```
exonstarts = [10,50,100]
exonends = [20,60,110] 
```

这有 3 个外显子（尽管文件中的其他行可能多于或少于 3 个，所以这必须适用于任意数量的外显子），它们来自：

```
 10-20
 50-60
 100-110 
```

因此，对于开始列表中的每个数字，完成列表中都有一个。这意味着第一个密码子从 exonstarts[0] 开始，在 exonends[0] 结束。第二个从 exonstarts[1] 开始，在 exonends[1] 结束。等等。

如何编写此代码的其余部分，以便将元素配对？

* * *

更新：

**由此：**

```
tokens = line.split()
exonstarts = tokens[8][:-1].split(',')
exonends = tokens[9][:-1].split(',')
zipped = list(zip(exonstarts, exonends)) 
```

我还有一个问题，我想要这些东西。因此，例如，我想要`chr_string[10:20]+chr_string[50:60]+chr_string[100:110]`有一种方法可以轻松地说出这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:04:11.637

内置的[zip正是您所寻找的：](http://docs.python.org/library/functions.html#zip)

```
>>> exonstarts = [10,50,100]
>>> exonends = [20,60,110]
>>> zip(exonstarts,exonends)
[(10, 20), (50, 60), (100, 110)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:03:45.633

我相信你想要[zip](http://docs.python.org/library/functions.html#zip)功能。

```
In [1]: exonstarts = [10,50,100]

In [2]: exonends = [20,60,110]

In [3]: zip(exonstarts, exonends)
Out[3]: [(10, 20), (50, 60), (100, 110)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T00:17:31.880

您可以使用以下方法获得这些对[**`zip()`**](http://docs.python.org/release/3.2.2/library/functions.html#zip)：

```
>>> for t in zip(exonstarts, exonends):
...     print('%d-%d' % t)
... 
10-20
50-60
100-110 
```

* * *

使用这些对`list`通过切片（我已经制作）获得：`chr_string`

```
>>> [chr_string[start:end] for start,end in zip(exonstarts, exonends)]
['0506070809', '2526272829', '5051525354'] 
```

将这些结合在一起：

```
>>> ''.join(chr_string[start:end] for start,end in zip(exonstarts, exonends))
'050607080925262728295051525354' 
```

# jquery - 这条线如何用普通的 javascript 重写？

> ID：10359312
> 
> 赞同：0
> 
> 时间：2012-04-28T00:00:21.757
> 
> 标签：jquery, coffeescript

我有以下代码，我想稍微操纵它，但在普通的 javascript 中这样做感觉更熟悉：

```
jQuery ->
  states = $('#person_state_id').html()
  console.log(states)
  $('#person_country_id').change ->
    country = $('#person_country_id :selected').text()
    options = $(states).filter("optgroup[label=#{country}]").html()
    console.log(options)
    if options
      $('#person_state_id').html(options)
    else
      $('#person_state_id').empty() 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:18:00.530

好吧，对我来说，用“in plain javascript”描述的代码应该是这样的：

```
var states = document.getElementById('person_state_id').cloneNode(true);
document.getElementById('person_country_id').onchange = function() {
    var country = this.value;
    var childs = states.childNodes;
    for (var i in childs) {
        if (childs[i].label == country) {
            var options = childs[i].innerHTML;
            document.getElementById('person_state_id').innerHTML = options ? options : "";
        }
    }
};​ 
```

在此处查看示例：http: [//jsfiddle.net/LmWqA/](http://jsfiddle.net/LmWqA/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:06:39.197

```
jQuery(function() {
  var states;
  states = $('#person_state_id').html();
  console.log(states);
  return $('#person_country_id').change(function() {
    var country, options;
    country = $('#person_country_id :selected').text();
    options = $(states).filter("optgroup[label=" + country + "]").html();
    console.log(options);
    if (options) {
      return $('#person_state_id').html(options);
    } else {
      return $('#person_state_id').empty();
    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T21:04:15.153

这是我经常使用的一个方便的 JS to Coffee 转换器，它工作得很好。

[http://js2coffee.org/](http://js2coffee.org/)

# ruby - 用 ruby 编写一个快速的 24 位位图导出器

> ID：10359314
> 
> 赞同：0
> 
> 时间：2012-04-28T00:00:42.067
> 
> 标签：ruby, image-processing

我得到了一个自定义 Image 对象，它为我提供了一个 get_pixel(x, y) 方法，该方法将指定像素的 RGBA 值作为 4 元组返回。

我的目标是编写一个函数，将这个 Image 对象写成标准的 windows 24 位 bmp 图像。我已经编写了一个用于导出标题的函数，现在我遇到的真正问题是尽可能快地写出像素。

生成的 bmp 格式是未压缩的，所以我只能说

```
像素 = []
对于 0 中的 .. 高度 - 1
  对于 x in 0 .. 宽度 - 1
    #获取颜色，推送到数组
  结尾
结尾
像素.pack(...)

```

哪个应该工作（有点，只需要得到正确的像素顺序并有填充），但是有没有更快的方法呢？（我可以在 ruby​​ 中使用可能有帮助的高阶函数吗？）

编辑：我只记得我应该一次写出所有内容，而不是每次迭代。这大大加快了速度。

# ruby-on-rails - Rails 3\. 如何从 grouped_collection_select 中排除记录？

> ID：10359315
> 
> 赞同：1
> 
> 时间：2012-04-28T00:00:44.607
> 
> 标签：ruby-on-rails, ruby

我有一个表格来记录教师的付款。付款记录在费用表中。我有以下工作正常：

```
<%= f.grouped_collection_select :scheduled_session_id, User.where(:role => 'instructor'), :scheduled_sessions, :full_name, :id, :identifier_with_cost, :include_blank => true %> 
```

它显示一个选择菜单，其中包含讲师姓名及其分配的课程。例如...

```
Peter Parker
  Biology    $350 April 27
  Chemistry  $400 April 28
Professor X
  Genetics   $400 April 27
  History    $350 April 28
  Literature $350 April 29 
```

但我想排除已经支付的会话。schedule_sessions 表有一个名为“paid”的布尔列。

我可以使用该查询进行查询，`ScheduledSession.where(paid: [false, nil])`但如何在 grouped_collection_select 上实现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T16:47:21.453

在仔细查看文档之后，（你知道在编码一段时间后大脑无法处理太多信息，这就是我本周实施番茄技术的原因）`grouped_collection_select(object, method, collection, group_method, group_label_method, option_key_method, option_value_method, options = {}, html_options = {}) public`：，它是一个提供子记录列表的 group_method .

因此，为了提出这个解决方案，我暂时忽略了 Expense 模型。我现在只关心 User 和 ScheduledSession 模型，因为这将生成我的选择菜单。我在父模型中创建了一个方法：

```
class User < ActiveRecord::Base
has_many :scheduled_sessions, :foreign_key => 'instructor_id'

def not_paid_scheduled_sessions
   ScheduledSession.where(:instructor_id => self.id).where(paid: [false, nil])
 end 
```

所以，而不是...

```
f.grouped_collection_select :scheduled_session_id, User.where(:role => 'instructor'), :scheduled_sessions, :full_name, :id, :identifier_with_cost, :include_blank => true 
```

我用...

```
f.grouped_collection_select :scheduled_session_id, User.where(:role => 'instructor'), :not_paid_scheduled_sessions, :full_name, :id, :identifier_with_cost 
```

希望它也对其他人有所帮助。

# iphone - iOS Facebook SDK--横向上传照片

> ID：10359317
> 
> 赞同：0
> 
> 时间：2012-04-28T00:01:12.623
> 
> 标签：iphone, ios, facebook, facebook-graph-api

每当我`me/photos`在我的 iOS 应用程序中调用 Facebook 服务器时，图像都会上传，但始终处于错误的方向。我正在使用 AVCapture 在应用程序中拍照，并且所有保存的照片都处于正确的方向。

如何使上传的图像处于正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T09:24:28.927

您将需要根据其 EXIF 代码翻译图像。请参阅此处的答案以获取翻译图像的工作代码：[iOS UIImagePickerController 上传后的结果图像方向](https://stackoverflow.com/questions/5427656/ios-uiimagepickercontroller-result-image-orientation-after-upload)

# asp.net-mvc - 当我的模型为空时，如何避免视图中的 foreach 循环中的 NullReferenceException？

> ID：10359319
> 
> 赞同：5
> 
> 时间：2012-04-28T00:01:33.470
> 
> 标签：asp.net-mvc, foreach

当我通过控制器传入空值时，我的视图中出现“用户代码未处理 NullReferenceException”错误，其中包含以下代码。在某些情况下，我想传入一个空值，但我不想在发生这种情况时抛出错误。我应该将代码更改为什么？

最初我的代码是：

```
@foreach (var item in Model.MyModelStuff)
{
    <tr>
        <td>
                @Html.DisplayFor(modelItem => item.Bla.Title)
        </td>
    <tr>
} 
```

我尝试了以下但没有成功：

```
@foreach (var item in Model.MyModelStuff.Where( item => item.MyModelStuff != null))
etc. . . 
```

如何更改代码以使其处理 null 而不会引发错误？我读过我可能需要返回我的模型的一个空集合（？），我将如何去做 - 如果这确实是必要的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T00:04:02.310

老实说，我认为`null`模型是一个糟糕的选择。但如果你坚持，只需添加一个`if`检查：

```
@if (Model != null) {
    foreach (var item in Model.MyModelStuff)
    {
        <tr>
            <td>
                    @Html.DisplayFor(modelItem => item.Bla.Title)
            </td>
        <tr>
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-28T00:11:49.800

If my understanding is correct your collection is null.

A collection should never be null, like you said you should return an empty collection instead and prevent your collection to be corrupted not exposing the real collection:

```
public IList<Employee> Employees
{
    get; 
    private set;
} 
```

And initialize your collection inside the constructor

```
this.Employees = new List<Employee>(); 
```

# iphone - 以 NSNumbers 作为键的 NSDictionary - 奇怪的行为

> ID：10359325
> 
> 赞同：0
> 
> 时间：2012-04-28T00:02:16.447
> 
> 标签：iphone, xcode, nsdictionary

我有一个 NSDictionary，其中包含我保存到 plist 的其他 NSDictionaries。它的索引是 NSNumbers，由（相当大的）整数组成。

当我从 plist 重新加载字典并尝试对其进行迭代时

```
for(NSDictionary *dict in loadedDict){
    nslog(@"dict %@", dict);
} 
```

这导致输出仅包含字典的键，但不是 - 正如预期的那样 - 字典本身的转储。

我必须执行以下操作才能获取包含的字典：

```
NSArray *allKeys = [loadedDict allKeys];
for(NSString *key in allKeys){
    nslog(@"dict %@", [loadedDict objectForKey:key]);
} 
```

而且，是的，键实际上是转换为 NSNumbers 的整数......

有什么问题？

在此先感谢您的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:09:24.763

字典的快速枚举返回键：

[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocFastEnumeration.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocFastEnumeration.html)

您所看到的是预期的行为。

考虑使用块来显式访问键和值：

```
[loadedDict enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) {
    // use key and obj...
}]; 
```

# c# - 在 C# 中强制转换与指定类型

> ID：10359330
> 
> 赞同：1
> 
> 时间：2012-04-28T00:03:39.933
> 
> 标签：c#, json

我一直在寻找解析 JSON 字符串的方法，并且遇到了这两种方法。

```
class Test {

      String test; 

      String getTest() { return test; }
      String setTest(String test) { test = test; }

  }

var ser = new JavaScriptSerializer();
Test abc = (Test)ser.DeserializeObject("{ \"test\":\"some data\" }"); 
```

和

```
var ser = new JavaScriptSerializer();
Test abc = ser.Deserialize<Test>("{ \"test\":\"some data\" }"); 
```

第一个是将对象转换为类型，第二个是指定类型？它们之间有什么真正的区别吗？一种方法更可取吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:06:29.907

不，第一个的唯一目的是允许您执行反序列化，即使您不确定结果类型。（第二个自动为您执行演员表）但没有实质性区别。（从字面上看，唯一的区别是后者自动转换前者的结果）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T00:20:24.937

第二个选项（使用通用`Deserialize<T>`方法）对于您的特定示例更可取，因为您期望特定类型。

当输入不代表您期望的类型的对象时，两者都会产生略微不同的结果。在第一种情况下，您的演员表中会出现 InvalidCastException，而在第二种情况下，Deserialize 方法会引发 InvalidOperationException。但除此之外，在性能等方面没有区别。事实上[，文档`Deserialize<T>`](http://msdn.microsoft.com/en-us/library/bb355316.aspx)说明了这一点：

> Deserialize 方法相当于先使用 DeserializeObject 方法获取对象图，然后尝试将结果强制转换为类型 T。

# c - 如何设置套接字以执行“发送/接收”或“接收/发送”

> ID：10359332
> 
> 赞同：0
> 
> 时间：2012-04-28T00:03:43.050
> 
> 标签：c, sockets

如果数据是从另一台计算机（首先）“发送”的，我如何将我的套接字例程设置为“发送”（首先）或（切换）“接收”？

谢谢

通用代码：

```
-(void) TcpClient{
    char buffer[128];
    struct sockaddr_in sin;
    struct hostent *host;
    int s;

    host = gethostbyname("10.0.0.3");

    memcpy(&(sin.sin_addr), host->h_addr,host->h_length);
    sin.sin_family = host->h_addrtype;
    sin.sin_port = htons(4000);

    s = socket(AF_INET, SOCK_STREAM, 0);
    connect(s, (struct sockaddr*)&sin, sizeof(sin));

    while(1){//this is the Client sequence:
        send(s, buffer, strlen(buffer), 0);//but what if the Server sends first ?? Client needs to receive here first
        recv(s, buffer, sizeof(buffer), 0);
    }
    close(s);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:14:44.827

套接字是双向的。它可以随时读取和写入。如果要编写一个决定何时读取和何时写入的例程，则需要使用该`select()`函数。它会告诉您套接字何时有数据可供读取，以及套接字何时可以接受数据进行发送。如果套接字在您发送数据之前接收到数据，您的例程可以检测到并执行“接收/发送”操作。如果您在套接字接收数据之前有数据要发送，您的例程可以检测到并执行“发送/接收”操作。例如：

```
while (1)
{
    fd_set fd;
    FD_ZERO(&fd);
    FD_SET(s, &fd);

    timeval tv;
    tv.tv_sec = 0;
    tv.tv_usec = 0;

    int ret;

    if (select(s+1, &fd, NULL, NULL, &tv) > 0)
    {
        ret = recv(s, buffer, sizeof(buffer), 0); 
        if (ret > 0)
            send(s, buffer, ret, 0);
    } 
    else
    {
        ret = send(s, buffer, strlen(buffer), 0);
        if (ret > 0)
            recv(s, buffer, ret, 0); 
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:12:42.880

您可以使用`select()`系统调用来处理多个套接字并在数据可用于读取或写入时触发操作。互联网上充斥着关于套接字编程的一般信息，也许从[这里](http://www.lowtek.com/sockets/select.html)开始，其中包括一些指向其他好的信息的链接。

还有[这个](http://beej.us/guide/bgnet/output/html/multipage/advanced.html#select)。

几乎任何关于网络编程的书都应该有一些很好的例子。

# javascript - 无法从带有 Socket.IO 的 cookie 中获取 Express 会话 ID

> ID：10359333
> 
> 赞同：14
> 
> 时间：2012-04-28T00:03:44.503
> 
> 标签：javascript, node.js, express, socket.io, session-cookies

我在 Node 中有一个典型的 Web 应用程序，它使用 Express 框架和会话中间件。我还将 Socket.io 用于我的应用程序的某些动态部分（目前，这是一种聊天机制，但这是切线的）。我已经能够成功地自行设置会话和 socket.io，但想将它们结合起来（例如：将套接字聊天消息与用户帐户相关联而无需访问数据库）。

应该注意（我可以看到这是一个可能的问题点），我在不同的端口上运行两台快速服务器：一台用于常规 HTTP 流量，一台用于 HTTPS 流量。但是，我让两台服务器都进行了相同的配置并共享相同的会话存储。会话确实在 http 和 https 页面之间持续存在。会话最初是通过从 HTTPS 提供的页面设置的，而 socket.io 页面是普通 HTTP。

我正在按照[此处](http://www.danielbaulig.de/socket-ioexpress/)的指南来实现我正在寻找的关于集成 socket.io 和会话的内容。但是，在授权函数中，从未设置 data.headers.cookie，尽管我的应用程序的基于会话的部分按预期工作。更奇怪的是，在设置会话后，如果我`console.log(document.cookie)`在浏览器中执行操作，我会得到一个空字符串，但是当我使用 Firefox 开发人员工具栏查看我的 cookie 时，有一个用于 express 和 connect 的 SID cookie。

这是服务器代码的相关部分：

```
var config = {
    ip          : "127.0.0.1",
    httpPort    : 2031,
    httpsPort   : 2032
};

var utils       = require("./utils"),
    express     = require('express'),
    fs          = require('fs'),
    parseCookie = require('./node_modules/express/node_modules/connect').utils.parseCookie,
    routes      = require('./routes')(config); 

var httpsOpts = {
    key : fs.readFileSync("cert/server-key.pem").toString(),
    cert: fs.readFileSync("cert/server-cert.pem").toString()
 };

var app             = express.createServer(),
    https           = express.createServer(httpsOpts),
    io              = require("socket.io").listen(app, { log: false}),
    helpers         = require("./helpers.js"),
    session         = new express.session.MemoryStore(),
    sessionConfig   = express.session({
        store   : session,
        secret  : 'secret',
        key     : 'express.sid',
        cookie  : {maxAge : 60 * 60 * 1000}
    }); //share this across http and https

configServer(app);
configServer(https);

//get SID for using sessions with sockets
io.set('authorization', function(data, accept){
    if(data.headers.cookie){
        data.cookie = parseCookie(data.headers.cookie);
        data.sessionID = data.cookie['express.sid'];
    } else {
        return accept("No cookie transmitted", false);
    }

    accept(null, true);
});

io.sockets.on('connection', function(socket){
    //pull out session information in here
});

function configServer(server) {
    server.configure(function(){
        server.dynamicHelpers(helpers.dynamicHelpers);
        server.helpers(helpers.staticHelpers);
        server.set('view options', { layout: false });
        server.set('view engine', 'mustache');
        server.set('views', __dirname + '/views');
        server.register(".mustache", require('stache'));
        server.use(express.static(__dirname + '/public'));
        server.use(express.bodyParser());
        server.use(express.cookieParser());
        server.use(sessionConfig);
    });
} 
```

这是客户端上的相关代码：

```
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        var socket = io.connect('http://127.0.0.1'); //make sure this isn't localhost!
        socket.on('server', function(data){
            //socket logic is here
        });
    }
</script> 
```

**更新**

即使在使用 SocketIO 的页面的路由中手动设置了 cookie（而不仅仅是会话变量），请求的 cookie 部分仍然不存在。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-28T16:42:11.970

在被告知查看客户端的初始化之前，我永远不会想到这一点。我将地址从 localhost 更改为显式 IP (127.0.0.1)，cookie 现在与 Socket.IO 中的标头一起发送。我不确定这是否明显，因为我假设 localhost 无论如何都被映射到 127.0.0.1 。

# emacs - Emacs 23 是否支持 prog-mode-hook？

> ID：10359336
> 
> 赞同：2
> 
> 时间：2012-04-28T00:03:52.117
> 
> 标签：emacs

我想为编程模式添加一些常用设置。例如：打开口号，突出显示括号等。所以我添加代码如下：

`(add-hook 'prog-mode-hook 'turn-on-watchwords)`

这在 Emacs 24 中有效，但 Emacs 23 不起作用，我不知道是否缺少其他东西或 Emacs 23 本身使其不起作用。

如果 Emacs 23 不支持 prog-mode-hook，如何添加编程模式的常用设置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T01:17:03.233

`prog-mode`（以及与之相关的所有钩子）是在 Emacs 24 中添加的。

您可以（稍微）通过将您的钩子添加到您通常使用的所有编程钩子来模拟它（诚然，这有点 hacky）：

```
(mapc (lambda (mode-hook) (add-hook mode-hook 'turn-on-watchwords))
        '(c-mode-common-hook tcl-mode-hook emacs-lisp-mode-hook
          ruby-mode-hook java-mode-hook haskell-mode-hook
          ess-mode-hook python-mode-hook sh-mode-hook)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T04:33:54.497

到目前为止，没有 Emacs，23 或 24`prog-mode`始终使用。Emacs 24 在 lisp/progmodes/*.el 中有 51/85 个包含“prog-mode”的文件，让您了解覆盖范围。也许在未来的版本中，您将能够`prog-mode-hook`随心所欲地使用。

无法为所有“编程”模式添加挂钩。@dbaupp 保留您使用的钩子列表的解决方案是可用的最佳解决方案。

# asp.net-mvc-3 - asp.net mvc 3上的Jquery UI按钮在Firefox 11上没有任何反应

> ID：10359343
> 
> 赞同：0
> 
> 时间：2012-04-28T00:04:19.820
> 
> 标签：asp.net-mvc-3, jquery-ui, uibutton

我有一个指向我用jqueryui按钮呈现的actionlink的按钮，我想要的是按钮的呈现视觉效果，并保持其正常行为，在Chrome上正常，按钮指向actionlink，但在Firefox 11上，当我单击按钮时，什么也没有发生。

这是视图上的代码：

```
<button id="btnNewOffer" style="float: left; margin-left: 30px"> @Html.ActionLink("Offre", "Index", "Service")  </button> 
```

这是脚本：

```
<script type="text/javascript">

    $(function () {
        $("#btnNewOffer").button();
    }) 

</script> 
```

这适用于 Chrome 但非 Firefox 11

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:24:57.150

我认为您不需要使用该`<button />`元素。您可以简单地单独使用`ActionLink`。

尝试这个：

```
@Html.ActionLink("Offre", "Index", "Service", htmlAttributes: new { id = "btnNewOffer", style = "float: left; margin-left: 30px" }) 
```

# php - PHP Parse URL - 当协议前缀不存在时域返回为路径

> ID：10359347
> 
> 赞同：3
> 
> 时间：2012-04-28T00:05:07.527
> 
> 标签：php, parse-url

我正在尝试在 PHP 中解析 URL，其中输入可能是以下任何一种：

**代码：**

```
$info = parse_url('http://www.domainname.com/');
print_r($info);

$info = parse_url('www.domain.com');
print_r($info);

$info = parse_url('/test/');
print_r($info);

$info = parse_url('test.php');
print_r($info); 
```

**回报：**

```
Array
(
    [scheme] => http
    [host] => www.domainname.com
    [path] => /
)
Array
(
    [path] => www.domain.com
)
Array
(
    [path] => /test/
)
Array
(
    [path] => test.php
) 
```

您可以看到的问题是域作为路径返回的第二个示例。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T00:18:48.320

这给出了正确的结果，但文件需要以斜杠开头：

```
parse('http://www.domainname.com/');
parse('www.domain.com');
parse('/test/');
parse("/file.php");

function parse($url){
    if(strpos($url,"://")===false && substr($url,0,1)!="/") $url = "http://".$url;
    $info = parse_url($url);
    if($info)
    print_r($info);
} 
```

结果是：

```
Array
(
    [scheme] => http
    [host] => www.domainname.com
    [path] => /
)
Array
(
    [scheme] => http
    [host] => www.domain.com
)
Array
(
    [path] => /test/
)
Array
(
    [path] => /file.php
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-13T06:15:54.857

要以保留它是无模式 URL 的方式处理 URL，同时还允许识别域，请使用以下代码。

```
if (!preg_match('/^([a-z][a-z0-9\-\.\+]*:)|(\/)/', $url)) {
    $url = '//' . $url;
} 
```

因此，仅当 URL 没有有效的方案且不以“/”开头时，才会将“//”应用于 URL 的开头。

**关于此的一些快速背景：**

解析器假定“：”之前的（有效）字符是模式，而“//”之后的字符是域。要表示 URL 同时具有方案和域，这两个标记必须连续使用，“://”。例如

*   `[scheme]:[path//path]`
*   `//[domain][/path]`
*   `[scheme]://[domain][/path]`
*   `[/path]`
*   `[path]`

这就是 PHP 解析 URL 的方式，`parse_url()`但我不能说它是否符合标准。

有效方案名称的规则是：`alpha *( alpha | digit | "+" | "-" | "." )`

# php - 如何在php中检查链接是否被点击

> ID：10359349
> 
> 赞同：1
> 
> 时间：2012-04-28T00:05:40.973
> 
> 标签：php

好吧，我是新手，所以我想记录用户单击 php 打印的链接并查询 mysql 数据库的时间。我已经知道如何使用 php 查询数据库，但我不确定是否可以知道用户是否点击了链接。

我像这样打印了一个链接。

`print ('<a id="myLink" href="http://www.google.com" target="_blank">google</a>');`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T00:16:16.183

要跟踪链接，您需要在服务器上创建链接跟踪脚本。即linktracker.php

然后，更改您的代码以指向该脚本的链接，传递转发网址，即

```
<a id="myLink" href="http://mysite.com/linktracker.php?url=http://www.google.com" target="_blank">google</a> 
```

在 linktracker.php 中，您需要以下内容：

```
<?php 
    $url = $_GET['url'];
    // update your database click count for the url
    //  i.e UPDATE linkclicks SET clickcount = clickcount + 1 WHERE url = '$url'

    // forward the user to the end location
    header("Location: $url"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T00:13:27.867

你需要建立一个 URL 重定向机制。

```
$link = 'http://www.google.com';
echo '<a href="/redir.php?target="'.encodeUriComponent($link).'>google</a>'; 
```

然后制作一个redir.php：

```
<?php
$targetUrl = $_REQUEST['target'];
// log this targetUrl to your MySQL database.

header( 'Location:'.$targetUrl); 
```

如果您想尝试跟踪链接共享或类似性质的东西，我绝对不会在 JavaScript 中这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T00:10:20.650

添加`onclick="handleClick()"`并编写名为的 javascript 函数以`handleClick`将点击报告给服务器 uaing ajax

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T00:09:32.547

除非链接指向您自己的站点，否则您需要使用客户端脚本语言，例如 JavaScript（也可以使用 jQuery）将用户的点击事件发送回服务器。

# objective-c - 在 Cocoa 中画线？

> ID：10359350
> 
> 赞同：3
> 
> 时间：2012-04-28T00:05:41.447
> 
> 标签：objective-c, macos, drawing, nsbezierpath

单击按钮后如何在特定窗口中画一条线？

我正在使用这个：

```
NSBezierPath * path = [NSBezierPath bezierPath];
        [path setLineWidth: 4];

        NSPoint startPoint = {  21, 21 };
        NSPoint endPoint   = { 128,128 };
        [path  moveToPoint: startPoint];    
        [path lineToPoint:endPoint];

        [[NSColor redColor] set]; 
        [path stroke]; 
```

但只有当我把它放在：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification 
```

我怎么能解决这个问题？我的目标是根据收到的详细信息（坐标）创建一个可以画线的应用程序

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:52:41.537

您不应该在视图或图层的绘制方法之外进行绘制（例如`drawRect:`）。概括地说，您想要做的是有一个视图，在设置标志时绘制线，当您单击按钮时，设置标志并告诉视图重绘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-15T09:22:01.400

当您单击鼠标事件时。此代码将创建直线、曲线和绘图。

```
 #import <Cocoa/Cocoa.h>

    @interface BezierView : NSView {
        NSPoint points[4];
        NSUInteger pointCount;
    }

    @end

    #import "BezierView.h"

    @implementation BezierView
    - (id)initWithFrame:(NSRect)frame {
        self = [super initWithFrame:frame];
        if (self) {
            // Initialization code here.
        }
        return self;
    }

    - (void)drawRect:(NSRect)rect 
    {
        NSBezierPath *control1 = [NSBezierPath bezierPath];
        [control1 moveToPoint: points[0]];
        [control1 lineToPoint: points[1]];
        [[NSColor redColor] setStroke];
        [control1 setLineWidth: 2];
        [control1 stroke];

        NSBezierPath *control2 = [NSBezierPath bezierPath];
        [control2 moveToPoint: points[2]];
        [control2 lineToPoint: points[3]];
        [[NSColor greenColor] setStroke];
        [control2 setLineWidth: 2];
        [control2 stroke];

        NSBezierPath *curve = [NSBezierPath bezierPath];
        [curve moveToPoint: points[0]];
        [curve curveToPoint: points[3]
              controlPoint1: points[1]
              controlPoint2: points[2]];

        [[NSColor blackColor] setStroke];
        CGFloat pattern[] = {4, 2, 1, 2};
        [curve setLineDash: pattern
                     count: 4
                     phase: 1];
        [[NSColor grayColor] setFill];
        [curve fill];
        [curve stroke];
    }

    - (void)mouseDown: (NSEvent*)theEvent
    {
        NSPoint click = [self convertPoint: [theEvent locationInWindow]
                                  fromView: nil];
        points[pointCount++ % 4] = click;
        if (pointCount % 4 == 0)
        {
            [self setNeedsDisplay: YES];
        }
    }
    @end 
```

# actionscript-3 - 使用curveTo绘制完美圆的一部分

> ID：10359351
> 
> 赞同：3
> 
> 时间：2012-04-28T00:05:50.450
> 
> 标签：actionscript-3, graphics, drawing

我需要使用（我有要绘制的半径和角度）绘制一个完美圆的一部分，`graphics.curveTo`但我无法理解 cotorol x&y 的确切公式，以使曲线完美

我知道如何用一个循环和很多来做到这一点，`lineTo`但这还不足以满足我的需求......

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T09:54:53.203

我使用这个函数来绘制圆段（我想我是从很久以前如何绘制完整圆的在线 AS2 示例中移植过来的）：

```
 /**
     * Draw a segment of a circle
     * @param graphics      the graphics object to draw into
     * @param center        the center of the circle
     * @param start         start angle (radians)
     * @param end           end angle (radians)
     * @param r             radius of the circle
     * @param h_ratio       horizontal scaling factor
     * @param v_ratio       vertical scaling factor
     * @param new_drawing   if true, uses a moveTo call to start drawing at the start point of the circle; else continues drawing using only lineTo and curveTo
     * 
     */
    public static function drawCircleSegment(graphics:Graphics, center:Point, start:Number, end:Number, r:Number, h_ratio:Number=1, v_ratio:Number=1, new_drawing:Boolean=true):void
    {
        var x:Number = center.x;
        var y:Number = center.y;
        // first point of the circle segment
        if(new_drawing)
        {
            graphics.moveTo(x+Math.cos(start)*r*h_ratio, y+Math.sin(start)*r*v_ratio);
        }

        // draw the circle in segments
        var segments:uint = 8;

        var theta:Number = (end-start)/segments; 
        var angle:Number = start; // start drawing at angle ...

        var ctrlRadius:Number = r/Math.cos(theta/2); // this gets the radius of the control point
        for (var i:int = 0; i<segments; i++) {
             // increment the angle
             angle += theta;
             var angleMid:Number = angle-(theta/2);
             // calculate our control point
             var cx:Number = x+Math.cos(angleMid)*(ctrlRadius*h_ratio);
             var cy:Number = y+Math.sin(angleMid)*(ctrlRadius*v_ratio);
             // calculate our end point
             var px:Number = x+Math.cos(angle)*r*h_ratio;
             var py:Number = y+Math.sin(angle)*r*v_ratio;
             // draw the circle segment
             graphics.curveTo(cx, cy, px, py);
        }

    } 
```

我认为它足够接近完美的圆圈。我不是很了解里面的数学，但我希望参数对你来说足够清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T00:50:18.633

使用二次贝塞尔曲线创建一个完美的圆（甚至是一个圆的一部分）是非常困难的，所以不要难过。

期待已久的图形 API 新增功能出现在 Flash Player 11 / AIR 3 中，它是绘制三次贝塞尔曲线的[cubicCurveTo()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Graphics.html#cubicCurveTo%28%29)函数，这使得绘制半圆之类的东西特别简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T19:38:39.670

你不能用贝塞尔曲线画一个完美的圆。你只是近似它。请参阅[http://cgafaq.info/wiki/Bézier_circle_approximation](http://cgafaq.info/wiki)。

# java - clojure REPL - 从另一个进程连接

> ID：10359353
> 
> 赞同：4
> 
> 时间：2012-04-28T00:06:13.907
> 
> 标签：java, clojure

如何从 ClojureScript 或 Java 连接到现有的 clojure REPL？

标题中的问题。有帮助类/库吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-28T21:39:05.407

您可能正在使用 Leiningen，因此：

```
lein repl :connect 51000 
```

（最后一个数字是`.nrepl-port`文件中的现有端口号）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T00:18:08.743

查看网络 repl [nrepl](https://github.com/clojure/tools.nrepl)

它允许您通过网络从您想要的任何代码连接到您的 repl

# java - Java函数的执行时间限制

> ID：10359357
> 
> 赞同：4
> 
> 时间：2012-04-28T00:06:36.143
> 
> 标签：java, multithreading

我正在尝试构造两个线程，线程A是主线程，线程B是第二个线程，线程B正在通过一个耗时的函数更新一个变量（这个变量应该在两个线程之间共享，因为最终线程A需要使用该变量也是如此），但是如果线程 B 完成时间过长（使用异常），我希望线程 A 终止线程 B。

我尝试的是以下内容：

```
Thread thread = new Thread() {
     public void run() {
         /// run something that could take a long time
     }
};

synchronized (thread) {
    thread.start();
}

System.err.println("Waiting for thread and terminating it if it did not stop.");
try {
   thread.wait(10000);
} catch (InterruptedException e) {
   System.err.println("interrupted.");
} 
```

如果行为运行超过 10 秒，是否应该给出终止行为的预期行为？线程对象在等待后被删除，因为运行线程的方法返回。

现在，这段代码发生的事情是我总是在 wait(10000) 命令上得到 java.lang.IllegalMonitorStateException。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:12:41.173

`IllegalMonitorStateException`如果你调用`wait()`一个你不在的对象，你总是会得到一个`synchronized`。

```
try {
    // you need this to do the wait
    synchronized (thread) {
       thread.wait(10000);
    }
} catch (InterruptedException e) {
    System.err.println("interrupted.");
} 
```

如果您正在等待`thread`完成，那么您可能正在尝试执行以下操作：

```
try {
    thread.join(10000);
} catch (InterruptedException e) {
    Thread.currentThread().interrupt();
    System.err.println("interrupted.");
} 
```

不幸的是，此时您不知道线程是否正在运行，因为`join`无论它是否超时（抱怨）都不会返回。因此，您需要`thread.isAlive()`在加入后测试是否。

如果您问如何取消`thread`如果它运行的时间超过`10000`毫秒，那么正确的做法是使用`thread.interrupt()`. 这将导致任何`sleep()`或`wait()`方法抛出一个`InterruptedException`，并将在线程上设置中断标志。

要使用中断标志，您的线程应该执行以下操作：

```
 while (!Thread.currentThread.isInterrupted()) {
       // do it's thread stuff
   } 
```

此外，执行以下操作始终是一个很好的模式，因为一旦`InterruptedException`抛出 ，中断标志就被清除了：

```
} catch (InterruptedException e) {
    // set the interrupt flag again because InterruptedException clears it
    Thread.currentThread.interrupt();
    System.err.println("interrupted.");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:14:21.063

该代码不正确。方法`wait`在`Object`类中声明，旨在暂停当前线程，并将其用作调用它的对象的监视器实例。您只能在`synchronized`部分中调用此方法，这就是您得到异常的原因。

关于你的问题：一般来说，如果它不想停止，你不能停止另一个线程。因此，您应该调用`Thread.interrupt`以通知线程它应该停止工作，并且由该线程决定是否考虑该通知。要检查线程是否被中断，您可以使用`interrupted()`or`isInterrupted()`方法。

# c# - C# 中有 BigFloat 类吗？

> ID：10359372
> 
> 赞同：10
> 
> 时间：2012-04-28T00:09:49.090
> 
> 标签：c#, numeric, bigfloat

`System.Numerics.BigInteger`可以让你将大整数相乘，但是浮点数有什么相同类型的吗？如果没有，是否有我可以使用的免费图书馆？

```
//this but with floats
System.Numerics.BigInteger maxint = new BigInteger(int.MaxValue);

System.Numerics.BigInteger big = maxint * maxint * maxint;
System.Console.WriteLine(big); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-28T00:16:42.823

也许您正在寻找[BigRational](http://bcl.codeplex.com/wikipage?title=BigRational&referringTitle=Home)？微软在 CodePlex 上的 BCL 项目下发布了它。实际上不确定它如何或是否适合您的需求。

它将它保持为一个有理数。您可以通过强制转换或乘法来获得具有十进制值的字符串。

```
var r = new BigRational(5000, 3768);
Console.WriteLine((decimal)r);
Console.WriteLine((double)r); 
```

或者使用这样的简单（ish）扩展方法：

```
public static class BigRationalExtensions
{
    public static string ToDecimalString(this BigRational r, int precision)
    {
        var fraction = r.GetFractionPart();

        // Case where the rational number is a whole number
        if(fraction.Numerator == 0 && fraction.Denominator == 1)
        {
            return r.GetWholePart() + ".0";
        }

        var adjustedNumerator = (fraction.Numerator
                                           * BigInteger.Pow(10, precision));
        var decimalPlaces = adjustedNumerator / fraction.Denominator;

        // Case where precision wasn't large enough.
        if(decimalPlaces == 0)
        {
            return "0.0";
        }

        // Give it the capacity for around what we should need for 
        // the whole part and total precision
        // (this is kinda sloppy, but does the trick)
        var sb = new StringBuilder(precision + r.ToString().Length);

        bool noMoreTrailingZeros = false;
        for (int i = precision; i > 0; i--)
        {
            if(!noMoreTrailingZeros)
            {
                if ((decimalPlaces%10) == 0)
                {
                    decimalPlaces = decimalPlaces/10;
                    continue;
                }

                noMoreTrailingZeros = true;
            }

            // Add the right most decimal to the string
            sb.Insert(0, decimalPlaces%10);
            decimalPlaces = decimalPlaces/10;
        }

        // Insert the whole part and decimal
        sb.Insert(0, ".");
        sb.Insert(0, r.GetWholePart());

        return sb.ToString();
    }
} 
```

如果超出小数或双精度的精度范围，它们将被转换为各自的类型，值为 0.0。此外，当结果超出其范围时，转换为十进制将导致`OverflowException`抛出 an 。

我编写的扩展方法（这可能不是计算分数十进制表示的*最佳*方法）将准确地将其转换为字符串，精度不受限制。但是，如果数字小于请求的精度，它将返回 0.0，就像十进制或双精度一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-27T06:47:42.777

应该考虑如果有`BigFloat`类型会产生什么影响。

```
BigFloat x = 1.0;
BigFloat y = 3.0;
BigFloat z = x / y; 
```

答案将`0.333333333333333333333333333333333333333333333333333333`反复出现。永远。无穷。内存不足错误。

构造一个无穷大很容易`BigFloat`。

但是，如果您乐于坚持使用有理数，则可以通过将一个整数除以另一个整数来表示，您可以使用它`BigInteger`来构建一种`BigRational`可以提供任意精度来表示任何实数的类型。

```
BigRational x = 1;
BigRational y = 3;
BigRational z = x / y; 
```

这有效并为我们提供了这种类型：

[![三分之一](../Images/aa1c4a8db2742d90f6755d23dbd8bd8a.png)](https://i.stack.imgur.com/rtrDO.png)

您可以只使用 NuGet `BigRational`，您会发现许多实现，包括一次来自 Microsoft。

# javascript - 在主页准备时显示加载页面

> ID：10359374
> 
> 赞同：0
> 
> 时间：2012-04-28T00:09:53.800
> 
> 标签：javascript, jquery, ajax, webserver

我想在主页准备然后加载时显示预加载图像。我想我不能使用 Ajax，因为我需要重新加载整个主页。我接下来要实现：首先，我请求预加载页面，然后服务器将其发送给我。其次，服务器开始形成主页（大约需要15-20秒）。第三，当服务器结束他的工作时，它会向我发送主页。但是我怎样才能实现第三部分呢？

第二个想法是将主页分成两部分。其中之一是预加载页面，其中包含整个主页的内容而没有`'busy time'`内容。然后使用 Ajax 加载`'busy time'`内容。

各位同事，你们怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:52:08.010

尝试这个。您需要一个加载微调器元素。此外， $(function(){}); 在加载 DOM（html 结构）时激活。当访问者第一次到达页面时，这是您最接近的地方。body 元素被隐藏，然后等到所有图像和所有内容都完全渲染并且 CSS 和 Javascript 文件加载并工作，然后它从微调器交叉淡入淡出到内容并移除微调器。

```
$(function(){
    $('body').hide();
    $('html').append('<div id="loading-spinner"></div>');
    $('body').load(function(){
        $('#loading-spinner').fadeOut('fast').remove();
        $(this).fadeIn('fast');
    });
}); 
```

您需要一些 CSS 来将 GIF 应用于加载微调器元素的背景并将其居中：

```
#loading-spinner {
    width:100px;
    height:100px;
    background:url(loading.gif);
    left:50%;
    margin-left:-50px;
    top:50%;
    margin-top:-50px;
} 
```

# php - 检查 PHP 或 JavaScript 中是否存在输入文件夹

> ID：10359376
> 
> 赞同：0
> 
> 时间：2012-04-28T00:10:16.743
> 
> 标签：php, javascript

我有一个表单，它需要几个文本字段输入，然后是一个文件夹路径。现在，在我提交表单之前，我想确保用户指定的文件夹路径是正确的，如果不打印错误消息。

在提交表单之前，有没有办法可以在同一页面中验证这一点？

我使用了 javascript，但它似乎没有像我预期的那样工作。想法/建议？

```
<script>
 function checkfolder()
 {
   var myObject;
   myObject = new ActiveXObject("Scripting.FileSystemObject");
   if(!myObject.FolderExists()){
     alert("Folder does not exist");
    }
  }
</script>
<form method=post action="some_file.php">
.
.
.

<input type="submit" name="submit" value="submit" onClick='checkFolder()'>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:14:46.247

你不会有太多的运气。PHP 无法做到这一点，因为它在服务器上运行，并且无法访问用户的计算机。JavaScript 将失败，因为浏览器出于安全原因阻止使用 JavaScript 访问文件系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:17:45.557

您没有任何方法可以访问本地数据来验证其存在。即使你这样做，它也被认为是非常糟糕的。

无需编写文件路径（我假设您正在这样做），只需制作一个 javascript`Browse`文件对话框，就像您将图像或文件上传到 Gmail 时一样。那样。这确保它至少在您尝试上传文件时存在。

在您选择文件之后和提交之前，该文件是否实际被删除。没关系。如果不存在，则上传失败。

# php - 从 $_SESSION 附加文件名时，它会一直搞砸

> ID：10359379
> 
> 赞同：0
> 
> 时间：2012-04-28T00:10:23.163
> 
> 标签：php, javascript, json

我在附加 imageNameArray 时遇到问题，它应该显示已上传的文件名。

问题是，假设我之前上传了 3 个文件（cat.png、dog.png 和 pig.png），当我刷新页面并上传另一个文件（panda.png）时，当我上传文件时，它应该显示'熊猫.png'。但它只是附加了之前上传的文件（cat.png、dog.png 和 pig.png）的名称，而不附加 panda.png。

如果我再次刷新页面并上传另一个文件（tiger.png），那么当我上传文件时，它应该显示“tiger.png”。但它只是附加了之前上传的文件的名称（cat.png、dog.png 和 pig.png 和 panda.png），它不附加tiger.png。

如果我上传另一个文件（不是刷新页面），例如 monkey.png，那么它会再次附加 cat.png、dog.png 和 pig.png 和 panda.png。没有猴子.png。

为什么会这样？我想要的是，当一个文件被上传时，它的名字被附加，但它不想这样做:(

更新：

下面是发生附加的 javascript 代码：

```
<?php
session_start();

$idx = count($_SESSION ['fileImage'] - 1);
$output = isset($_SESSION ['fileImage'][$idx]) ? $_SESSION ['fileImage'][$idx]['name'] : "";

?>

          function stopImageUpload(success){

          var imageNameArray = new Array();
          imageNameArray = <?php echo $output ?>;
          var result = '';

          if (success == 1){
             result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';

                for(var i=0;i<imageNameArray.length;i++)
        {
             $('.listImage').append(imageNameArray[i]+ '<br/>');

         }

          }
          else {
             result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
          }

    return true;

    } 
```

下面是 php 脚本，它从上面的 javascript 函数上传另一个页面上的文件：

```
 <?php

        session_start();

        $result = 0;
        $errors = array ();
        $dirImage = "ImageFiles/";

    if (isset ( $_FILES ['fileImage'] ) && $_FILES ["fileImage"] ["error"] == UPLOAD_ERR_OK) {

    $fileName = $_FILES ['fileImage'] ['name'];

    $fileExt = pathinfo ( $fileName, PATHINFO_EXTENSION );
    $fileExt = strtolower ( $fileExt );

    $fileDst = $dirImage . DIRECTORY_SEPARATOR . $fileName;

            if (count ( $errors ) == 0) {
                if (move_uploaded_file ( $fileTemp, $fileDst )) {
                    $result = 1;

                }
            }

        }

$_SESSION ['fileImage'][] = array('name' => $_FILES ['fileImage']['name']);

        ?>

    <script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result;?>);</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:29:22.930

您应该阅读有关 $_SESSION 的信息。它需要在需要访问 $_SESSION 数组的每个页面上“启动”。你需要添加

```
session_start() 
```

到也为 javascript 回显的页面

好的，那么我们需要更改您的附加实现。

```
$_SESSION ['files'][] = array('name' => $_FILES ['fileImage']['name']); 
```

然后检索最后一个，

（我会把它放在 session_start() 之后的某个地方）

```
$idx = count($_SESSION ['files'] - 1);
$output = isset($_SESSION ['files'][$idx]) ? $_SESSION ['files'][$idx]['name'] : "";

...

imageNameArray = <?php echo $output ?>; 
```

# google-chrome - 启用 CSS3 的元素可以进行位置转换吗？

> ID：10359380
> 
> 赞同：0
> 
> 时间：2012-04-28T00:10:30.917
> 
> 标签：google-chrome, css, css-transitions

我只是在玩我的投资组合网站，并注意到当我的（谷歌浏览器）屏幕放大到 400% 并专注于页脚时，我的一些元素与流体网格不匹配。我知道我需要解决这个问题（如果您对如何定位元素以实现非常流畅的布局有任何想法/建议，请发布它们），但是当我使用“查看为实际大小”的热键时，我注意到我有两个单独的启用 CSS3 过渡的参数（不透明度和宽度，代码位于下面）应用到它的元素会从原始位置平滑、缓慢地过渡到它在“实际大小”视图中的位置。

[http://jsfiddle.net/Asustaba/VLw7k/](http://jsfiddle.net/Asustaba/VLw7k/)

如果这令人困惑，请道歉。如果有人需要更好地了解正在发生的事情，我可以附上过渡视频的链接。

```
.grower{
  -moz-transform: scale(.85);
  -webkit-transform: scale(.85);
  -moz-transition: all 0.4s ease-in-out;
  -webkit-transition: all 0.4s ease-in-out;
}

.grower:hover{
  -moz-transform: scale(1);
  -webkit-transform: scale(1); 
}

.grower_big{
  -moz-transform: scale(1);
  -webkit-transform: scale(1);
  -moz-transition: all 0.4s ease-in-out;
  -webkit-transition: all 0.4s ease-in-out;
}

.grower_big:hover{
  -moz-transform: scale(1.1);
  -webkit-transform: scale(1.1); 
} 
```

有人遇到过这个吗？是否可以在元素的绝对、相对或正常流定位之间设置基于过渡的移动（缓入缓出）？在基于视差的 Web 布局中查看时会怎样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T07:02:47.650

我想你是在问你是否可以转换财产位置。如果是这种情况，那么你不能。大多数可以转换的元素都是使用数值的元素。以下是可以转换的 CSS 属性列表：http: [//www.w3.org/TR/css3-transitions/#properties-from-css-](http://www.w3.org/TR/css3-transitions/#properties-from-css-)

# asp.net - IIS Express 引用 machine.config 与项目 web.config

> ID：10359383
> 
> 赞同：2
> 
> 时间：2012-04-28T00:11:24.487
> 
> 标签：asp.net, web-config

我正在编写一个 WsCF 服务来检索多个客户端的数据。我有一个引用业务管理器对象的服务层。本质上，在服务调用中，我想从 web.config 中检索提供者类型（我的代码中的自定义枚举）和连接字符串。

由于某种原因，代码无法在我的项目 web.config 中找到设置。我正在收集 IIS Express 并且 VS 开发 Web 服务器正在引用 machine.config。我如何覆盖它。这是非常令人沮丧的。正如您从代码片段中看到的那样，设置和连接字符串名称存在，但代码永远不会选择它。

我的代码：

```
Private Sub GetDBInformation()
    Dim config As System.Configuration.Configuration
    config = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(Nothing)
    If (config.AppSettings.Settings.Count > 0) Then
        Dim Setting As System.Configuration.KeyValueConfigurationElement
        Setting = config.AppSettings.Settings("DB TYPE")
        If Not (Setting.Value = Nothing) Then
            Select Case Setting.Value
                Case "SQL SERVER"
                    provider = ProviderType.SqlServer
                Case Else
                    provider = ProviderType.OleDb
            End Select
        End If
    End If

    If (config.ConnectionStrings.ConnectionStrings.Count > 0) Then
        connection = config.ConnectionStrings.ConnectionStrings("UMADB").ConnectionString
    End If
End Sub 
```

web.config：

```
<connectionStrings>
    <add name="UMADB" 
         connectionString="Data Source=***********;Initial Catalog=UMA;UserID=********;Password=***********"
         providerName="System.Data.SqlClient" />
</connectionStrings>

<appSettings>
    <add key="DB TYPE" value="SQL SERVER" />
</appSettings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:18:03.900

这是访问配置设置的一种非常迂回的方式。我不知道您为什么或如何到达`machine.config`，但有一种更简单的方法。

不要忘记导入`System.Configuration`命名空间。

```
Dim Setting As String = ConfigurationSettings.AppSettings.Get("DB_TYPE")
If Not String.IsNullOrEmpty(DatabaseSetting) Then
    Select Case Setting 
        Case "SQL SERVER"
            provider = ProviderType.SqlServer
        Case Else
            provider = ProviderType.OleDb
    End Select
End If 
```

我不知道你是如何或为什么到达的`machine.config`，但那不应该发生。使用您当前的方法，尝试在获取配置文件时指定应用程序根目录：

```
System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration("~/") 
```

# actionscript-3 - Mock4as 与 Mockito-flex

> ID：10359386
> 
> 赞同：0
> 
> 时间：2012-04-28T00:12:01.247
> 
> 标签：actionscript-3, unit-testing, mocking, flexunit4

我对 actionscript 有点陌生，但我发现自己正在研究从其他 OO 语言 (java/C#) 到 actionscript 环境的良好编程实践。我已经给了 Mock4as 和 mockito-flex 一个 purusal 并且有兴趣使用两者。

有没有人在使用这两种方法时有过好/坏的经历？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:18:39.623

我开始使用 mock4as 模拟 FlexUnit，它完成了它的工作。但这让我花了太多时间为我的口味编写样板代码。我没有尝试过 mockito-flex，但我会检查一下 - 我非常喜欢的 Java 版本。

最近，我对[mockolate](http://mockolate.org/)非常满意。Drew Bourne 在这方面做得非常好——试一试！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-21T22:46:02.983

在过去的几年里，我在 Mockito-flex 方面拥有出色的经验。我喜欢 Mockito-flex 而不是 Mocholate 的主要原因是 Mockito 允许您使用实际的类签名测试您的代码，因此重构工具将更新您的测试。

另一方面，Mocholate 要求您使用字符串对方法名称进行硬编码，这意味着在创建测试时没有自动完成帮助，并且如果您重命名和 API，重构支持会更差。

虽然不太重要，但 Mockito 可用于多种语言。这意味着您可以在整个技术堆栈中使用相同的模拟语法。或者，您可以更轻松地将嘲弄技能转换为另一种语言。

# jquery - 每个前一个元素的jQuery margin-left

> ID：10359387
> 
> 赞同：2
> 
> 时间：2012-04-28T00:12:03.053
> 
> 标签：jquery, jquery-animate, each, children

我有 5 张图片，点击时我试图让它们彼此相邻，相隔 50 像素。

目前，我正在为第一个孩子和所有其他孩子设置 50px 的动画，但都在彼此之上。

这是我的脚本：

```
var fadedur = 200,
    fadeop = 0.5,
    imgwidth = 220,
    imgleft = 40,
    imgfirst = -200,
    imgfh = -100;

$('img').on('click', function(){
    $('img').css('position','absolute').css('display','block');

    $('.cs').find(':first-child').stop().animate({
            "marginLeft": imgfirst,
            "margin-top": imgfh,
        }, 300);

    $('.cs').find(':first-child').next('img').each(function() {         
        $(this).stop().animate({
            "marginLeft": imgfirst + imgwidth + imgleft,  // imgfirst should
            "margin-top": imgfh,                          // be something that
        }, 300);                                          // states prev()
    });

});​ 
```

这是我的小提琴：http: [//jsfiddle.net/STgQC/](http://jsfiddle.net/STgQC/)

我试图让它们看起来像这样：

![在此处输入图像描述](../Images/c2da70fb22d6f2dca38026a41278d7bd.png)

所以基本上我需要一些可以说的东西：

**动画到前一个元素的位置 + 图像宽度 + 50px 左边。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:33:57.143

`$('.cs').find(':first-child').next('img')`最多将匹配一个元素，因此在其上调用每个元素毫无意义。
看看这个更新的小提琴[http://jsfiddle.net/STgQC/1/](http://jsfiddle.net/STgQC/1/)，这是你正在寻找的行为吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:34:02.363

`.each()`遍历`next()`. 在您的情况下，`next()`仅返回第一张图像。因此，您的代码仅迭代 1 个图像。

我会将 2 次迭代合并为 1 次逻辑迭代。

尝试以下（为我工作）：
也在这里提琴：http: [//jsfiddle.net/FranWahl/mYRdU/1/](http://jsfiddle.net/FranWahl/mYRdU/1/)

```
var fadedur = 200,
    fadeop = 0.5,
    imgwidth = 220,
    imgleft = 40,
    imgfirst = -200,
    imgfh = -100;

$('img').on('click', function(){    
    $('img').css('position','absolute').css('display','block');

    var newLeft = imgfirst;

    $('.cs').find('img').each(function(){
        $(this).stop().animate({
            "marginLeft": newLeft,//imgfirst + imgwidth + imgleft,
            "margin-top": imgfh,
        }, 300);

        newLeft += imgwidth + imgleft;
    });                 
});​ 
```

# javascript - JSON 数据字符串替换和日期格式

> ID：10359403
> 
> 赞同：1
> 
> 时间：2012-04-28T00:15:38.173
> 
> 标签：javascript, json, jsonp

我对 JSON 和 JavaScript 还很陌生，所以如果我似乎没有做足够的研究，我很抱歉。参考以下链接：

[http://jsbin.com/imekip/edit#javascript,live](http://jsbin.com/imekip/edit#javascript,live)

我想知道如何修改代码：

> 我们的下一场演出将于 2012 年 4 月 18 日在美国加利福尼亚州旧金山的菲尔莫尔举行

至：

> 我们的下一场演出将于 5 月 4 日在旧金山的菲尔莫尔举行

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:23:49.990

**HTML**

```
<ul id="ulId">
    <li>Our next gig is at 
        <a href='#'>
            The Fillmore, San Francisco, CA, US on 2012-05-18
        </a>
    </li>
    <li>Our next gig is at 
        <a href='#'>
            The Fillmore, San Francisco, CA, US on 2012-10-15
        </a>
    </li>
</ul> 
```

​</p>

**JS**

```
var months=['January','February','March','April','May', 'June', 'July', 'August','September','October','November','December'];
var rgx = /(\d{4})-(\d{2})-(\d{2})/;
function changeDate(ul)
{
    for(i=0;i<ul.childNodes.length;i++)
    {
        if(ul.childNodes[i].tagName=="LI")
        {
            var link=ul.childNodes[i].getElementsByTagName('a')[0];
            var txt=link.innerHTML;
            var r = txt.match(rgx);
            var dateArr=r[0].split('-');
            var m= parseInt(dateArr[1])-1;
            var d=dateArr[2];
            var dt= d+'th '+months[m];
            var final=txt.replace(r[0] ,dt);  
            link.innerHTML=final;
        }
    }
}
changeDate('ulId'); // call the function and pass the ul id as paremeter. 
```

[**演示。**](http://jsfiddle.net/heera/ngRXZ/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:03:51.933

需要一些代码来做 1）在每个循环中，您必须存储日期变量并使用日期对象将每个月的名称分配给月份的编号 2）还要检查使用日期将日期转换为字符串一些字符串函数 3) 至少但不是最后，必须剪切位置直到第一个逗号出现，我使用了 split 函数，因为您可以在进一步的情况下使用字符串的其余部分完整的工作演示 [http://jsfiddle.net /西奥多/WrCLW/2/](http://jsfiddle.net/theodore/WrCLW/2/)

# php - 追随者/被追随者的php逻辑

> ID：10359406
> 
> 赞同：0
> 
> 时间：2012-04-28T00:16:01.203
> 
> 标签：php, codeigniter

**更新：我想通了。请看下面我的回答。**

我正在尝试在应用程序级别编写一些逻辑来识别下表中的朋友（共同关注者）。我的查询以类似于下表的格式返回了数据（借用了[这个](https://stackoverflow.com/questions/5113195/get-followers-twitter-like-using-mysql)问题，但我不需要查询，那部分已经完成）：

```
A B
1 2 // mutual followers, so "friends"
2 1 // mutual followers, so "friends"
1 3 // user 1 is following 3
1 4 // user 1 is following 4 
```

那么如何编写一些逻辑来显示 A = B 和 B = A 的用户，但在不同的行中？使用 PHP/codeigniter。

作为对请求的响应，以下是 SQL 表和查询：

```
Users table - uid, fname, lname
Followers table - user_id, follow_id

Select users.uid, users.fname, users.lname, u.uid, u.fname, u.lname
FROM users
INNER JOIN follows f on (f.user_id=users.uid)
INNER JOIN users u on (u.uid=f.follow_id) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:44:49.353

我想你想要这样的东西：

```
$results = array(array(1,2),array(2,1),array(1,3),array(1,4));
$mutual_users = array_filter($results,function($elem)use($results){
    if(in_array(array_reverse($elem),$results)){
        return true;
    }
});
print_r($mutual_users); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:34:41.303

好吧，我想通了。我需要为关注者表添加第二个 INNER JOIN。我将下面的代码添加到我的 SQL 查询中，并且它有效。

```
INNER JOIN followers f2 ON u.id = f2.user_id AND users.id = f2.follow_id 
```

# python - 如何在 PyOpenGL 程序中使用 FreeGLUT glutMouseWheelFunc？

> ID：10359407
> 
> 赞同：0
> 
> 时间：2012-04-28T00:16:01.403
> 
> 标签：python, pyopengl, freeglut

我已经从[这里为 64 位 Python 3.x 和 Windows 7 安装了](http://www.lfd.uci.edu/~gohlke/pythonlibs/)**PyOpenGL**。我能够编写和执行一个使用 glutMouseFunc**来**监听鼠标按钮点击的 PyOpenGL 程序：

 **```
from OpenGL.GLUT import *
from OpenGL.GL import *

# Imagine the typical glut init functions here ...
glutMouseFunc( mouse ) 
```

现在，我也想阅读鼠标的**滚轮**。我之前在 C++ 中使用 FreeGLUT 完成了此操作，它公开了**glutMouseWheelFunc**。我查了一下，我可以看到**freeglut32.vc9.dll**和**freeglut64.vc9.dll**在`C:\Program Files\Python32\Lib\site-packages\OpenGL\DLLS`.

我将上面的代码更改为：

```
from OpenGL.GLUT import *
from OpenGL.GLUT.freeglut import *
from OpenGL.GL import *

# Imagine the typical glut init functions here ...
glutMouseFunc( mouse )
glutMouseWheelFunc( mouseWheel ) 
```

这失败并出现此错误：

```
 File "c:\Program Files\Python32\lib\site-packages\OpenGL\GLUT\special.py", line 139, in __call__
    self.wrappedOperation( cCallback, *args )
  File "c:\Program Files\Python32\lib\site-packages\OpenGL\GLUT\special.py", line 107, in failFunction
    typeName, 'glut%sFunc'%(typeName),
OpenGL.error.NullFunctionError: Undefined GLUT callback function MouseWheel, check for bool(glutMouseWheelFunc) before calling 
```

那么，**如何在 PyOpenGL 中使用 FreeGLUT 调用**？我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T07:07:08.407

PyOpenGL 默认加载 GLUT dll。要改用 freeglut，请重命名或删除 OpenGL/DLLs 目录中的 glut64.vc9.dll 文件，并确保 Windows DLL 搜索路径中的其他位置不存在此类文件。为我工作。**

# php - 如何在保留数组的同时将数组中的元素移动到不同的位置

> ID：10359415
> 
> 赞同：0
> 
> 时间：2012-04-28T00:17:48.177
> 
> 标签：php, arrays

我有一个看起来像这样的数组：

```
Array
(
    [0] => Item 0
    [1] => Item 1   
    [2] =>  Item 2
) 
```

假设我想将第 1 项移动到数组的末尾，将第 2 项移动到数组的顶部（这会将第 0 项推到数组的中间。

我该怎么做？

我尝试使用 unset 和 splice 函数，它有时可以工作，但是像我在上面谈到的数组部分的高级动作被删除了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:23:12.873

尝试：

```
$end_element = array_pop($arr);
array_unshift($arr, $end_element); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:22:37.850

对于移动`Item 2`到开头，这将隐式移动`Item 1`到结尾，您可以在一个非常简单的行中做到这一点：

```
array_unshift($array, array_pop($array)); 
```

这将取出最后一个元素，然后将其放回开头。

# c# - 在 c# 中如何将 var 转换为 char 数组。字符数组[8]

> ID：10359421
> 
> 赞同：2
> 
> 时间：2012-04-28T00:18:25.683
> 
> 标签：c#, types, casting

在 c# 中如何将 var 转换为 char 数组。char[8] 数组我可以保证这个 var 不会太大。

比如，我有

```
var a = 634711440648369988; 
```

我想`char[8] c`存储它。

如何正确进行此转换？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:23:57.707

使用[`BitConverter.GetBytes(long)`](http://msdn.microsoft.com/en-us/library/93ae9768.aspx)或[`BitConverter.GetBytes(ulong)`](http://msdn.microsoft.com/en-us/library/d8z32tce.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:21:27.473

您可以将其转换为字符串并使用该`ToCharArray`方法。

```
char [ ] c = a.ToString().ToCharArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T00:21:45.213

在 C# 中没有`char[8]`. 一个数组`char`将是`char[]`。

我猜你是从 C++ 的角度来看的，实际上想要一个长度为 8 的字节数组。在这种情况下，你需要的类型是`byte[]`. 请注意，您想要`byte[]`而不是`char[]`因为`char`在 C# 中是 16 位数据类型。

您可以通过调用获得所需的内容`BitConverter.GetBytes()`。当您调用此函数并传递一个 8 字节整数时，返回的数组将是一个`byte[]`长度等于 8 的数组，如[文档](http://msdn.microsoft.com/en-us/library/d8z32tce.aspx)中所述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T00:22:13.180

```
int a = 123412;

char[] d = a.ToString().ToCharArray();

foreach (char c in d)
{
    Console.WriteLine(c);
} 
```

# python - 比较两个元组的所有元素（具有 all() 功能）

> ID：10359435
> 
> 赞同：5
> 
> 时间：2012-04-28T00:21:05.977
> 
> 标签：python, comparison, tuples, language-design

所以我知道[元组的比较按](http://docs.python.org/reference/expressions.html#not-in)字典顺序工作：

> > 元组和列表使用对应元素的比较按字典顺序进行比较。这意味着要比较相等，每个元素必须比较相等，并且两个序列必须是相同的类型并且具有相同的长度。
> > 
> > 如果不相等，则序列的排序与其第一个不同的元素相同。例如， cmp([1,2,x], [1,2,y]) 返回与 cmp(x,y) 相同的结果。如果对应的元素不存在，则先排序较短的序列（例如，[1,2] < [1,2,3]）。

所以从这里：

```
>>> a = (100, 0)
>>> b = (50, 50)
>>> a > b
True 
```

但我想按顺序比较 2 个元组的所有元素，所以在功能上我想要类似的东西（使用上面的值）：

```
>>> a > b
(True, False) #returned tuple containing each comparison
>>> all(a > b)
False 
```

作为实践中的一个例子，对于像屏幕坐标这样的东西，如果你想检查某个东西是否在 (0,0) 处的屏幕“内部”，但是如果 x 坐标是像 coord > (0,0) 这样的比较大于 0，但 y 坐标更小它仍然会返回 true，这不是这种情况下需要的。

作为一个子问题/讨论：
我不确定为什么以这种方式返回比较 2 个不同值的元组。你没有得到任何类型的索引，所以你从比较一个元组（不是测试相等性）中得到的唯一一件事是，在元组中的某个点，其中一个比较会在它们是时抛出一个真值或假值不相等。你怎么能利用它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T00:25:32.903

您可以通过列表理解和内置 zip 来实现这一点：

```
>>> a = (100, 0)
>>> b = (50, 50)
>>> [(a > b) for a, b in zip(a,b)]
[True, False] 
```

您可以在返回的列表中使用 all() 或 any()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:28:55.267

在您的第二个代码示例中替换`a > b`为。`tuple(i > j for i, j in zip(a,b))`

```
>>> a = (100, 0)
>>> b = (50, 50)
>>> tuple(i > j for i, j in zip(a,b))
(True, False)
>>> all(i > j for i, j in zip(a,b))
False 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-01T19:33:00.760

您可以考虑使用以下**向量化方法**，它通常性能更高，并且在语法/语义上非常清晰：

```
>>> import numpy
>>>
>>> a = (100, 0)
>>> b = (50, 50)
>>> numpy.array(a) > b
array([ True, False], dtype=bool)
>>> 
>>> (numpy.array(a) > b).any()
True
>>> (numpy.array(a) > b).all()
False 
```

*   numpy 的性能非常好，上面生成的对象还嵌入了您想要的 any()/all() 查询方法。如果您将执行类似矢量的操作（如**屏幕坐标**示例所示），您可以考虑使用 'a' 和 'b' 作为 numpy 数组，而不是元组。这会导致您所寻求的最有效的实现：不需要预转换，并且基于 Python 的循环被高效的基于 numpy 的循环所取代。这是值得强调的，因为涉及两个甚至三个可能的循环：（1）转换期间的预处理循环（您可以消除）；(2) 逐项比较循环；(3) 一个查询循环来回答任何/所有问题。

*   请注意，我也可以从“b”创建一个 numpy 数组，但不这样做会消除一个转换步骤和**预处理时间**。由于该方法导致一个操作数是**numpy 数组**而另一个是**tuple**，随着序列的增长，这可能/可能不会导致逐项比较速度降低（严格的 numpy-to-numpy 擅长） . 尝试一下。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-17T00:49:47.797

我觉得答案中缺少使用 map 和 lambda 函数

```
>>> a = (100, 0)
>>> b = (50, 50)
>>> all(map(lambda x,y: x > y, a, b))
False 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T00:35:05.683

要获得所描述的行为，请尝试：

```
[ai > bi for ai,bi in zip(a,b)] 
```

以这种方式返回元组比较的原因是您可能想要编写如下内容：

```
if a >= (0.,0.):
    print "a has only positive values"
else:
    print "a has at least one negative value" 
```

如果 Python 要返回您描述的元组，那么 else 将永远不会发生。尝试

```
if (False,False):
    print "True!" # This is what is printed.
else:
    print "False!" 
```

我希望这有帮助。

# ubuntu - sendmail：如何在 ubuntu 上配置 sendmail？

> ID：10359437
> 
> 赞同：191
> 
> 时间：2012-04-28T00:21:39.953
> 
> 标签：ubuntu, configuration, sendmail

当我在 ubuntu 上搜索配置 sendmail 时，我没有得到任何明确的答案，他们每个人都假设我知道他们在说什么，

我只想要基本配置来启用电子邮件发送，基本上我将使用它与谷歌应用引擎来启用从开发服务器发送邮件。

我已经这样做了：

```
sudo apt-get install sendmail 
```

然后

```
sudo sendmailconfig 
```

但我不知道最后一个实际上做了什么。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2012-04-28T00:35:45.733

当您输入 时`sudo sendmailconfig`，应该会提示您配置 sendmail。

作为参考，配置期间更新的文件位于以下位置（如果您想手动更新它们）：

```
/etc/mail/sendmail.conf
/etc/cron.d/sendmail
/etc/mail/sendmail.mc 
```

您可以通过在命令行中键入以下内容来测试 sendmail 以查看它是否已正确配置和设置：

```
$ echo "My test email being sent from sendmail" | /usr/sbin/sendmail myemail@domain.com 
```

以下将允许您将 smtp 中继添加到 sendmail：

```
#Change to your mail config directory:
cd /etc/mail

#Make a auth subdirectory
mkdir auth
chmod 700 auth

#Create a file with your auth information to the smtp server
cd auth
touch client-info

#In the file, put the following, matching up to your smtp server:
AuthInfo:your.isp.net "U:root" "I:user" "P:password"

#Generate the Authentication database, make both files readable only by root
makemap hash client-info < client-info
chmod 600 client-info
cd .. 
```

将以下行添加到sendmail.mc，但*在*`MAILERDEFINITIONS`. 确保更新您的 smtp 服务器。

```
define(`SMART_HOST',`your.isp.net')dnl
define(`confAUTH_MECHANISMS', `EXTERNAL GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN PLAIN')dnl
FEATURE(`authinfo',`hash -o /etc/mail/auth/client-info.db')dnl 
```

调用创建 sendmail.cf（或者运行`make -C /etc/mail`）：

```
m4 sendmail.mc > sendmail.cf 
```

重新启动 sendmail 守护进程：

```
service sendmail restart 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-10-09T20:46:33.637

经过一次小的编辑后，我得到了最佳答案（尚无法回复）

这对我不起作用：

```
FEATURE('authinfo','hash /etc/mail/auth/client-info')dnl 
```

每个字符串的第一个单引号应更改为反引号 (`)，如下所示：

```
FEATURE(`authinfo',`hash /etc/mail/auth/client-info')dnl 
```

更改后我运行：

```
sudo sendmailconfig 
```

我在做生意:)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-01-08T17:41:25.363

结合上面的两个答案，我终于让它工作了。请注意，**每个字符串的第一个单引号是**文件 sendmail.mc 中的反引号 (`)。

```
#Change to your mail config directory:
cd /etc/mail

#Make a auth subdirectory
mkdir auth
chmod 700 auth  #maybe not, because I cannot apply cmd "cd auth" if I do so.

#Create a file with your auth information to the smtp server
cd auth
touch client-info

#In the file, put the following, matching up to your smtp server:
AuthInfo:your.isp.net "U:root" "I:user" "P:password"

#Generate the Authentication database, make both files readable only by root
makemap hash client-info < client-info
chmod 600 client-info
cd ..

#Add the following lines to sendmail.mc. Make sure you update your smtp server
#The first single quote for each string should be changed to a backtick (`) like this:
define(`SMART_HOST',`your.isp.net')dnl
define(`confAUTH_MECHANISMS', `EXTERNAL GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN PLAIN')dnl
FEATURE(`authinfo',`hash /etc/mail/auth/client-info')dnl

#run 
sudo sendmailconfig 
```

# python - 是否可以在 sqlalchemy 中使用 ResultProxy 对象读取多个结果集？

> ID：10359438
> 
> 赞同：6
> 
> 时间：2012-04-28T00:21:44.883
> 
> 标签：python, sqlalchemy, pyodbc

我正在尝试调用一个使用 SQLAlchemy 返回多个结果集的存储过程。如果重要的话，我在下面使用 PyODBC 和 FreeTDS。我使用原始查询调用 execute() 方法，其中“exec”在会话对象上调用我的存储过程并返回 ResultProxy 对象。

使用原始 pyodbc 游标，我可以调用 nextset() 函数前进到下一个结果集。我认为没有办法使用从 SQLAlchemy 返回的 ResultProxy 来做同样的事情。确实，[文档](http://docs.sqlalchemy.org/en/latest/core/connections.html)说：

> DBAPI 游标将在其所有结果行（如果有）用尽时由 ResultProxy 关闭。

有没有办法使用 SQLAlchemy 读取多个结果集，或者我必须使用原始 DBAPI 执行此查询？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T04:55:29.430

对 nextset() 的支持是[票 1635](http://www.sqlalchemy.org/trac/ticket/1635)。它已经两岁了。它包含一个需要更新的部分补丁，特别是与一个执行选项一起工作，该选项传递一个提示，该语句将返回多个结果集，以便结果代理的现有自动关闭行为可以保持默认值。该功能还需要大量测试。

此功能没有重大的技术障碍，但通常对此用例几乎没有兴趣。因此，目前您需要坚持使用原始光标，直到人们对该功能表达足够的兴趣以再次为其提供动力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T02:17:05.433

你读过[http://docs.sqlalchemy.org/en/rel_0_7/core/connections.html?highlight=resultproxy#basic-usage](http://docs.sqlalchemy.org/en/rel_0_7/core/connections.html?highlight=resultproxy#basic-usage)吗？您可以遍历`ResultProxy`对象、关闭它们等。

# java - 将现有网络应用程序迁移到谷歌网络工具包

> ID：10359444
> 
> 赞同：0
> 
> 时间：2012-04-28T00:23:37.977
> 
> 标签：java, javascript, gwt

我有一个基于 django 的 Web 应用程序，它混合了 jQuery 和其他几个 JavaScript 库。有人建议将所有内容整合到 Google Web Toolkit 下会使事情向前发展更容易一些。所以我对此有几个问题：

*   我们可以保留我们的 HTML/CSS 还是必须重写？
*   GWT 会与我们已经使用的 JavaScript 库轻松集成吗？（datejs、jQuery.scrollTo 等）
*   由于 GWT 的工作流程不同，您会建议重写*所有内容吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:33:40.807

首先，需要注意的是：您可以在不同程度上“将所有内容整合到 Google Web Toolkit 下”。您可以在 GWT 中编写一个客户端 JavaScript 库，或者在 GWT 中编写整个客户端实现，或者使用 GWT 在 Java 中编写客户端和服务器。我将尝试为每个用例回答您的每个问题。

> 我们可以保留我们的 HTML/CSS 还是必须重写？

如果您只是在 GWT 中编写客户端库，则可以保持 HTML/CSS 基本完整。如果您正在编写整个前端，或者如果您正在使用 GWT 编写客户端和服务器，您可能可以移植大部分 HTML 和 CSS，但您必须进行很多小改动。

> GWT 会与我们已经使用的 JavaScript 库轻松集成吗？（datejs、jQuery.scrollTo 等）

多半是对的。

如果您只是在编写客户端库，那么绝对可以（因为 GWT 代码只是另一个库）。如果您在 GWT 中编写整个前端或客户端和服务器，生活会更加艰难，因为您可能必须编写[JSNI](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsJSNI)包装器，这需要一些工作，但并不可怕。

> 由于 GWT 的工作流程不同，您会建议重写所有内容吗？

不，我不会。这并不是因为对 GWT 与 JavaScript 的看法，而是因为完全重写通常是一个坏主意。随着时间的推移进行大量重构是一个好主意，但大量丢弃代码通常是个坏主意，因为该代码已经过测试。如果你扔掉一堆代码而不是随着时间的推移进行重构，你会丢失你随着时间的推移所做的错误修复，并且你会犯同样的错误，测试它们，找到它们，然后重新修复它们。

# asterisk - Asterisk 将声音文件播放到 ConfBridge 中？

> ID：10359445
> 
> 赞同：4
> 
> 时间：2012-04-28T00:23:40.187
> 
> 标签：asterisk

我正在尝试召开会议并在会议背景中播放声音文件。我怎样才能做到这一点？

这显然是行不通的，因为声音文件会在进入会议之前播放。

```
exten => s,1,playback(some/soundfile)
same => n,confbridge(1) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-01-30T03:04:38.147

想在这里添加我的解决方案，以防有人需要它。

首先在 extensions.conf 中为 conf 桥创建一个上下文：

```
[conf-msg]
exten => s,1,ConfBridge(01) 
```

其中 01 是网桥编号

然后通过命令行您可以执行以下操作：

```
asterisk -x 'channel originate local/s@conf-msg application Playback file' 
```

它真的就这么简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T18:43:25.230

您已经创建了新的呼叫，使用呼叫文件的简单方法。

[http://www.voip-info.org/wiki/view/Asterisk+auto-dial+out](http://www.voip-info.org/wiki/view/Asterisk+auto-dial+out)

之后，您可以像这样将呼叫腿之一放到您的会议中

```
Channel: Local/1111@conference
Application: Playback
Data: some/soundfile 
```

会议是到达您的会议室的上下文。不需要做间谍或类似的事情，那是浪费时间/cpu

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:05:54.717

看到这里有一个类似的问题： [Asterisk-How to 'whisper' music using ChanSpy(), or any alternative?](https://stackoverflow.com/questions/8099018/asterisk-how-to-whisper-music-using-chanspy-or-any-alternative/8604223#8604223)

基本上，您想添加一个指向本地频道的参与者（如上，只进入频道而不是间谍），播放您的声音，然后挂断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-12T07:39:43.840

相同的答案，但对于*许多*confBridge：

在`extension.conf`：

```
[autobridge]
exten => _X.,1,ConfBridge(${EXTEN}) 
```

*   然后，就像[tgwaste 的回答](https://stackoverflow.com/a/35097498/1765658)一样，您可以使用以下命令向*会议室 1234*发起消息`originate`：

    ```
    originate local/1234@autobridge application Playback en_US/tt-monkeys 
    ```

    从控制台或*管理器*连接，

*   或者正如[arheops 的回答](https://stackoverflow.com/a/10454434/1765658)所建议的那样，通过在以下位置添加一个文件*`outgoing spool dir`*：

    ```
    printf "Channel: Local/%d@autobridge\nApplication: %s\nData: %s\n" \
        1234 Playback sound/file >/var/spool/asterisk/outgoing/f-$RANDOM 
    ```

    从文件系统级别的任何内容（具有正确的权限，可以共享！:-)。

# optimization - 机器指令 fxtod 是否应该慢得离谱

> ID：10359447
> 
> 赞同：2
> 
> 时间：2012-04-28T00:24:01.843
> 
> 标签：optimization, gcc, sparc

我有一个程序，我试图对其执行一些循环优化它是用 C++ 编写并使用 gcc 编译的

最终使用探查器，我跟踪了循环执行时间的一半以上到该行

```
double x_component = in.input_vector[in.dimension_to_process] - \
       (center_of_bin_0 + (double) nn * grid_distance); 
```

这一行的所有内容都是 double 类型，但循环索引 nn 的类型是 long unsigned int

从 long unsigned int 到 double 的转换生成分析器标记的汇编指令 fxtod

作为测试，我从行中删除了对 nn 的引用，从而将强制转换从 unsigned int 删除为 double 并且循环的执行时间减少了近一半，在一个对 Ultrasparc IV 执行大约十几个浮点操作的循环中处理器。我确认 Ultrasparc II 也是如此，

从 int 到 double 的转换比缓存未命中要贵得多，更不用说浮点乘法是否正常？如果是这样，其他人通常会怎么做呢？

nn 的所有可能值（在这种情况下具有已知的有限范围）的查找表将比这更快

# c# - 将 PNG 图像保存到 WP7 的独立存储

> ID：10359448
> 
> 赞同：2
> 
> 时间：2012-04-28T00:24:07.147
> 
> 标签：c#, windows-phone-7, stream, bitmapimage, isolatedstorage

这里有很多图像到隔离存储的问题，但我找不到适合我的情况的好答案 - 所以我们开始吧。

我正在`.png`从网络上获取图像，并将其保存为`BitmapImage`-object。完成加载后（在`BitmapImage.ImageOpened`事件中），我想将其保存到独立存储中。

那么，我怎样才能从这个 BitmapImage （或直接从网络 - 没关系）获取字节或文件流，以便我可以将它写入我的`IsolatedStorageFileStream`？我在互联网上找不到一篇关于它的帖子，它适用于`BitmapImage.StreamSource`带有 .png 图像的 WP7（因此不可用）。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:50:39.337

我不认为你可以开箱即用，但是有一个 codeplex/nuget 项目可以让你以 png 格式保存。

假设您安装了来自 codeplex 的[图像工具](http://imagetools.codeplex.com)（通过 nuget！）。

```
_bi = new BitmapImage(new Uri("http://blog.webnames.ca/images/Godzilla.png", UriKind.Absolute));
_bi.ImageOpened += ImageOpened;
...

private void ImageOpened(object sender, RoutedEventArgs e)
{
    var isf = IsolatedStorageFile.GetUserStoreForApplication();

    using (var writer = new StreamWriter(new IsolatedStorageFileStream("godzilla.png", FileMode.Create, FileAccess.Write, isf)))
    {
        var encoder = new PngEncoder();
        var wb = new WriteableBitmap(_bi);
        encoder.Encode(wb.ToImage(), writer.BaseStream);
    }
} 
```

John Pappa 有一篇关于这项技术的优秀博客文章。[将快照保存为 PNG](http://johnpapa.net/saving-snapshots-to-png-in-silverlight-4-and-the-webcam)

# preview - 使用媒体记录器录制时是否可以更改预览表面

> ID：10359449
> 
> 赞同：2
> 
> 时间：2012-04-28T00:24:18.457
> 
> 标签：preview, surface, android-mediarecorder

任何人都可以帮助我解决方案或领导吗？我正在使用 MediaRecorder 录制视频。我已将表面视图附加到记录器以进行预览。我有不同的纵向和横向布局。现在问题是当我更改方向时，表面会再次创建（当然，横向n纵向不同）..在这种情况下，为了获得预览，我必须停下来，然后用新的表面准备刻录机并重新开始刻录机。是否可以更改预览表面同时记录？

surfaceCreated(SurfaceHolder holder) 我正在做以下事情

```
If(recording)
   recorder.Stop();
recorder.reset();
recoder.intialiseFileFormats() ;  //Init AV formats and codecs
recorder.setPreviewDisplay(holder.getSurface());
recorder.prepare();
recorder.start(); 
```

任何帮助都是非常可观的。谢谢

# php - PhP 正则表达式或 Basename()

> ID：10359452
> 
> 赞同：0
> 
> 时间：2012-04-28T00:24:55.273
> 
> 标签：php, regex

我正在尝试从具有以下路径的文件列表中提取文件名：

```
/a/b/c/d/file1.jpg
/e/f/g/h/file2.png
/i/j/k/l/file3.txt 
```

我想得到一个字符串，它是一个有效的文件名（对于linux），它在“/”之间是一个jpeg文件（以“.jpg”结尾）。在此示例中，“file1”将是唯一有效的匹配项。

目前我有这个 RegEx ：

```
/(?<=\/)(.*?)(?=\.(js))/gim 
```

我真的不知道使用 RegEx 是否更好，或者使用 basename() 是否更好/可能。

我想要实现的目标是将所有匹配的字符串放入一个数组中。不知道我这样做是否正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:36:34.110

这里不需要正则表达式。我假设您可以将路径放入数组中。

```
<?php
    $text = file_get_contents("list.txt");

    $foo = explode(PHP_EOL, $text);

    $bar = array(); 

        foreach($foo as $key => $value){
            if(pathinfo($value, PATHINFO_EXTENSION) == "jpg"){
                $bar[] = basename($foo[$key],".".pathinfo($value, PATHINFO_EXTENSION));
            }
        }

    print_r($bar);
?> 
```

输出：

```
Array ( [0] => file1 ) 
```

现场示例：[http ://codepad.viper-7.com/ewkUHs](http://codepad.viper-7.com/ewkUHs)

# ios - 自定义标题与组中的单元格重叠

> ID：10359453
> 
> 赞同：6
> 
> 时间：2012-04-28T00:24:57.020
> 
> 标签：ios, objective-c, uitableview, ios5

我在尝试创建自定义 ios 表头时有点卡住了。我的标题是 30px 高，我正在使用以下代码来创建它们：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
    NSString *sectionTitle = [self tableView:tableView titleForHeaderInSection:section];
    if (sectionTitle == nil) {
        return nil;
    }

    // Create label with section title
    UILabel *label = [[UILabel alloc] init] ;
    label.frame = CGRectMake(0, 0, 140, 30);
    label.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"header_gradient.png"]];
    label.textColor = [UIColor whiteColor];
    label.shadowColor = [UIColor whiteColor];
    label.shadowOffset = CGSizeMake(0.0, 1.0);
    label.font = [UIFont boldSystemFontOfSize:12];
    label.text = sectionTitle;

    // Create header view and add label as a subview
    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 140, 30)];
    [view addSubview:label];

    return view;
}

- (CGFloat)tableView:(UITableView *)tableViewheightForHeaderInSection:(NSInteger)section {
    return 30;
} 
```

它几乎可以工作，但我的标题似乎与它们下面的单元格/标题发生冲突：

![自定义标题](../Images/a1dcfc6c06a8f236890ec96a5a926034.png)

谁能指出我在这里清理标题的正确方向？

提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-28T05:26:03.383

你缺少一个[空格]：

你有：

```
- (CGFloat)tableView:(UITableView *)tableViewheightForHeaderInSection:(NSInteger)section { 
```

它应该是：

```
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section { 
```

# c# - 比较两个日期值时如何忽略时间部分？

> ID：10359454
> 
> 赞同：2
> 
> 时间：2012-04-28T00:25:06.460
> 
> 标签：c#, winforms, date, comparison, datetimepicker

当显示的日期是今天的日期时，我希望这等同于 false：

`if (dateTimePickerScheduleDate.Value < DateTime.Now)`

...但事实并非如此，因为 DTP 的值包含“午夜”，而“现在”是在午夜之后。

如何“截断”这些值以使其忽略时间部分？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T02:04:30.840

```
if(dateTimePickerScheduleDate.Value.Date < DateTime.Now.Date)
{
} 
```

Date 属性返回一个`DateTime`仅反映`DateTime`对象的 Date 组件，其时间组件已清零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:27:26.390

```
DateTime.Now.ToShortDateString(); 
```

# regex - 正则表达式匹配长度和字母

> ID：10359455
> 
> 赞同：0
> 
> 时间：2012-04-28T00:25:09.940
> 
> 标签：regex

我需要一个正则表达式来匹配几个标准。

字符串长度必须为 8 个字符，并且只能包含以下字母：`urdl`.

我认为这将类似于`/(.{8}('u')('r')('d')('l'))/`

你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:36:05.020

正则表达式有一些不同的风格，但在 python 中你可以使用:`'[ulrd]{8}'`作为你的表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:42:56.370

在 C# 中，您可以使用“^[urdl]{8}$”，它确保长度正好是 8 个字符（不多也不少）。“^”表示开始，“$”表示结束，共有 8 个字符 - “{8}”，每个字符与集合“[urdl]”中的一个字母匹配。

# java - 在 Java 和 C++ 中可视化二叉树

> ID：10359457
> 
> 赞同：1
> 
> 时间：2012-04-28T00:25:23.327
> 
> 标签：java, c++, visualization

有什么方法可以在 java 和 C++ 中可视化二叉树？它可能是 Eclipse 或 VC++ 的插件（尽管我认为插件没有能力），或者它可能是一个库，可以让您绘制它们。我想用尽可能少的工作量来做到这一点。我现在可以使用 C++ 和 Win32 来完成，但这不是一个选择，因为它需要太多时间来编写该死的东西。我也知道对此可能没有一个非常简单的解决方案，但我正在为两种语言寻找最好的解决方案。我在这里谈论的 BST 结构将是自定义的，而不是库结构。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:28:43.863

我认为 AT&T graphviz 及其 dot.exe 使用起来非常简单。如果必须，您可以从 Java 内部进行所有操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:28:55.783

如果您可以以格式输出二叉树`DOT`，则很容易将其可视化。`DOT`是一种超级简单的语言，您应该能够在几行代码中发出它。一个示例如下所示：

```
 digraph graphname {
     a -> b -> c;
     b -> d;
 } 
```

生成[http://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/DotLanguageDirected.svg/168px-DotLanguageDirected.svg.png](http://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/DotLanguageDirected.svg/168px-DotLanguageDirected.svg.png)

维基百科有更多：[http ://en.wikipedia.org/wiki/DOT_language](http://en.wikipedia.org/wiki/DOT_language)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T00:31:01.803

如果您只想将其可视化以进行调试并使用类 Unix 操作系统，则可以尝试[ddd](http://www.gnu.org/software/ddd/)。

# ios - iOS不旋转

> ID：10359461
> 
> 赞同：0
> 
> 时间：2012-04-28T00:26:33.070
> 
> 标签：ios, rotation

我有一个带有导航项的视图控制器。导航项内的视图会旋转，但顶部的导航栏不会。我不明白为什么只有部分应用程序在旋转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:49:36.700

谷歌似乎有很多关于此的内容。

这个看起来很有希望

[UINavigationBar 自动调整大小](https://stackoverflow.com/questions/3538111/uinavigationbar-autoresizing)

# css - 在 jQuery Mobile 中定位表单元素

> ID：10359466
> 
> 赞同：0
> 
> 时间：2012-04-28T00:28:18.317
> 
> 标签：css, forms, layout, jquery-mobile

我是使用 jQuery 移动表单和 CSS 的新手。我已经构建了一个包含在 div 中的 jQuery Mobile 表单，我希望能够调整表单元素的位置，但到目前为止还没有任何运气。下面我尝试使用 CSS 将“提交”按钮与容器底部对齐，但未成功。任何人都可以提出一个好的方法来做到这一点吗？

```
<head>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css"
    />
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.5.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.5.1.min.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"
    />
    <style type="text/css">
        #submitButton {
            position: absolute;
            bottom: 0%;
            width: 50px;
        }
    </style>
</head>

<body>
    <div data-role="page">
        <div data-role="header"></div>
        <div data-role="content">
            <div id="lr" style="height: 500px;">
                <form action="forms-sample-response.php" method="get" style="background-color:green; height: 100%;">
                    <label for="select-choice-0" class="select">Select Label:</label>
                    <select name="select-choice-0" id="select-choice-0">
                        <option value="item1">Item 1</option>
                        <option value="item2">Item 2</option>
                        <option value="item3">Item 3</option>
                        <option value="item4">Item 4</option>
                    </select>
                    <div id="preview"></div>
                    <button type="button" data-theme="a"
                    name="Choose" value="submit-value">Choose</button>
                    <label for="textarea">Text Area Label:</label>
                    <textarea name="textarea" id="textarea-a"></textarea>
                    <button id="submitButton" class="ui-btn-top" type="button"
                    data-theme="a" name="Publish" value="Upload">Submit</button>
            </div>
            </form>
        </div>
    </div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:00:13.833

JQM 更改了 html 并将许多类应用于您的原始按钮。如果您检查该元素，您会发现它看起来完全不同。不用玩太多 JQM 创建的东西，您只需用另一个 div 包装按钮并定位该 div。IE

```
<div id="submitBtnWrap">
    <button id="submitButton" class="ui-btn-top" type="button" data-theme="a" name="Publish" value="Upload">Submit</button>
</div> 
```

然后将您的 css 应用到包装器 div。

```
#submitBtnWrap {
    position: absolute;
    bottom: 0%;
    width: 50px;
} 
```

# python - 在没有from minidom的情况下获取 XML

> ID：10359469
> 
> 赞同：1
> 
> 时间：2012-04-28T00:28:52.903
> 
> 标签：python, xml, minidom

我使用 minidom 创建了一个 XML，它正确显示，但我需要在没有`<?xml version="1.0" encoding="utf-8"?>`开头的情况下返回它。`<?xml?>`有没有办法在没有标签的情况下获取 XML ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:32:25.853

您可以尝试在第一个实例处对字符串进行切片`?>`：

```
xml = xml[xml.index('?>') + 2:] 
```

* * *

我查看了`xml.dom.minidom`包的源代码，我认为这也可以完成这项工作：

```
import xml.dom.minidom

def writexml(self, writer, indent="", addindent="", newl="", encoding = None):
  for node in self.childNodes:
    node.writexml(writer, indent, addindent, newl)

xml.dom.minidom.Document.writexml = writexml

del writexml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T13:52:27.393

就我个人而言，我只是切掉了前 22 个字符

```
xml_out = doc.toxml()
return xml_out[22:] 
```

# javascript - RaphaelJS 缩放在 Chrome 中损坏

> ID：10359470
> 
> 赞同：4
> 
> 时间：2012-04-28T00:28:54.863
> 
> 标签：javascript, google-chrome, raphael, scale

我在`resize`Raphael 画布上为圆形创建了一个处理程序，该处理程序过去可以在浏览器中正常工作，但现在仅在 Chrome 上失败并产生奇怪的行为：

当改变窗口的宽度时，在某些时候圆圈会被“压扁”并失去它的比例。

您可以[在 jsFiddle 上使用此演示](http://jsfiddle.net/WgTuF/1/)复制它，方法是拖动结果面板的调整大小手柄以更改其宽度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T07:18:45.383

它工作正常。也许这是一个特定版本的 chrome 中的错误。我认为你现在可以超越这一点。

（在 OS X 10.8.2 上使用 Chrome 24）

# spring-mvc - 在 jboss 5.0.1 GA 上运行 spring 任务调度程序的多个任务调用

> ID：10359473
> 
> 赞同：1
> 
> 时间：2012-04-28T00:29:05.477
> 
> 标签：spring-mvc, scheduled-tasks, jboss5.x

我在 JBoss 5.0.1 GA 上运行 Spring 3.1 MVC Web 应用程序。我没有使用注释。

我有一个 singeton，它有一个方法，我想安排在一天中的某个时间运行。

我的任务计划程序配置如下：

```
<task:scheduler id="taskScheduler"/>
<task:scheduled-tasks scheduler="taskScheduler">
    <task:scheduled ref="service" method="DoSomething" cron="* */10 * * * *"/>
</task:scheduled-tasks>
<task:executor id="taskExecutor" pool-size="1"/> 
```

然而，当我观察跟踪日志时，该方法被执行了多次（在我们的 qa 服务器和 prod 服务器上执行了 8 次），而不仅仅是一次。

QuartzScheduler 是否需要以某种方式进行配置？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:23:03.183

我怀疑**cron**`"* */10 * * * *"`元素的值不正确。

 **`*/10`我在[http://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger](http://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger)上找不到文档

`/`引入了一个值的增量，其中 as表示`*`所有值，因此`*/10`在分钟内没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:16:23.070

在我看来，cron 中的第一个 * 应该是 0，`0 */10 * * * *`表示在 0 秒时每 10 分钟运行一次，而不是每秒每 10 分钟运行一次*（*它将运行多次，具体取决于完成每次调用所需的时间. 要获得 8 次调用，单次运行只需一分钟多一点）。请注意[spring javadoc](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/scheduling/support/CronSequenceGenerator.html)示例如何以零开头。**

# javascript - Javascript xml 噩梦

> ID：10359474
> 
> 赞同：1
> 
> 时间：2012-04-28T00:29:16.483
> 
> 标签：javascript, xml

我正在学习 javascript，但速度不是很快，我正在尝试使用代码创建一个谷歌地图 v3 api，其中包含从 xml 文件加载的可搜索位置。

遇到了一个问题，事实上很多，但这是一个：我无法访问 xml 文件中的数据，我使用了一个示例并尝试通过阅读和尝试不同的代码来调整它，但没有成功。

它没有使用我的 xml 文件访问数据，这是我的 xml 格式，带有以下 js 代码：

```
 <markers style="MEDIUM">
       <marker>
         <title>McDonalds</title>
         <lat>55.5452</lat>
         <lng>34.3755</lng>
         <markerId>0</markerId>
         <countryCode>GB</countryCode>
         <address>Somewhere in London</address>
         <description>Get a free toy with every happy meal!</description>
       </marker>
    </markers> 
```

这是我的 html 文件中的 JS。

```
downloadUrl("london.xml", function(doc) {
            var xmlDoc = xmlParse(doc);
            var markers = xmlDoc.documentElement.getElementsByTagName("marker");

            for (var i = 0; i < markers.length; i++) {
             // obtain the attribues of each marker
              var lat = parseFloat(markers[i].getElementsByTagName("lat"));
              var lng = parseFloat(markers[i].getElementsByTagName("lng"));
              var point = new google.maps.LatLng(lat,lng);

              var description = markers[i].getElementsByTagName("description");
              var title = markers[i].getElementsByTagName("title");
          alert(title);
              // create the marker
              var marker = createMarker(point,title,description);
            }
        alert(i); 
```

我想这是非常简单的事情，例如链接节点，但我无法弄清楚，并认为一些帮助或建议可以帮助我节省一些理智，谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:42:22.377

好吧，很难确定所有问题出在哪里......但是，我可以看到的第一个问题是您正在尝试从中`getElementsByTagName`获取，`documentElement`但您需要从中获取`xmlDoc`：

```
var markers = xmlDoc.getElementsByTagName("marker"); 
```

然后，您尝试将`NodeList`object 转换为`float`. 它应该重做：

```
var lat = parseFloat(markers[i].getElementsByTagName("lat")[0].textContent);
var lng = parseFloat(markers[i].getElementsByTagName("lng")[0].textContent); 
```

接下来，我相信`description`并`title`存储在`textContent`具有相应名称的第一个节点中。所以，

```
var description = markers[i].getElementsByTagName("description")[0].textContent;
var title = markers[i].getElementsByTagName("title")[0].textContent; 
```

并且不要忘记检查您的 XML 文件的正确格式（包括`<?xml ...?>`标题等）

# mercurial - Lotus Domino Designer 8.5.3 的 Mercurial 设置

> ID：10359476
> 
> 赞同：6
> 
> 时间：2012-04-28T00:29:36.617
> 
> 标签：mercurial, lotus, lotus-domino

致力于安装 Mercurial Source Control 并使用 Lotus Domino Designer 8.5.3。

一直使用来自 Lotusphere 2012 “AD102：IBM Lotus Domino 开发人员的源代码控制”的 Declan 的 powerpoint 作为指南。

到目前为止我所做的是：

1.  通过 CI1LPEN.exe 安装文件安装 8.5.3 Client 和 Designer
2.  从设计器首选项启用 Eclipse 插件安装
3.  [从http://cbes.javaforge.com/update](http://cbes.javaforge.com/update)执行了 1.6.0 MercurialEclipse 和 1.4.3 Mercurial Binaries 的文件、应用程序和安装
4.  通过转到文件、应用程序、应用程序管理并查看它们已列出来验证它们已安装
5.  封闭的 Domino 设计师和客户。重新启动。
6.  当我在 Designer 中打开应用程序并交替单击其标题时，未列出“团队开发”选项。所以无法“为此应用程序设置源代码控制..”

是否需要安装任何其他先决条件才能使其工作，或者我应该选择不同的安装包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T13:41:13.057

如果您使用的是 8.5.3，则无需安装任何内容。但是，只有在 XPages 透视图中才会出现 Team Development 菜单选项。它不会出现在 Domino Development 透视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:03:43.773

找到了问题，它对我有用。

我需要做的第一件事是从以下位置安装“源代码启用”： [http](http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=Source%20Control%20Enablement%20for%20Designer) ://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=Source%20Control%20Enablement%20for%20Designer .

接下来是我在应用程序窗格中右键单击应用程序名称，而我应该在导航窗格中右键单击应用程序名称。

现在看到“团队发展”选项。

已经能够通过它的步伐运行 Mercurial - 提交、分支、合并等。

# javascript - 如何在 NodeJs 中下载和解压缩内存中的 zip 文件？

> ID：10359485
> 
> 赞同：50
> 
> 时间：2012-04-28T00:31:22.293
> 
> 标签：javascript, node.js, zip, zlib, unzip

我想从 Internet 下载一个 zip 文件并将其解压缩到内存中，而不保存到临时文件中。我怎样才能做到这一点？

这是我尝试过的：

```
var url = 'http://bdn-ak.bloomberg.com/precanned/Comdty_Calendar_Spread_Option_20120428.txt.zip';

var request = require('request'), fs = require('fs'), zlib = require('zlib');

  request.get(url, function(err, res, file) {
     if(err) throw err;
     zlib.unzip(file, function(err, txt) {
        if(err) throw err;
        console.log(txt.toString()); //outputs nothing
     });
  }); 
```

[编辑] 正如建议的那样，我尝试使用 adm-zip 库，但我仍然无法完成这项工作：

```
var ZipEntry = require('adm-zip/zipEntry');
request.get(url, function(err, res, zipFile) {
        if(err) throw err;
        var zip = new ZipEntry();
        zip.setCompressedData(new Buffer(zipFile.toString('utf-8')));
        var text = zip.getData();
        console.log(text.toString()); // fails
    }); 
```

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-04-30T22:59:57.220

您需要一个可以处理缓冲区的库。最新版本的`adm-zip`会做：

```
npm install adm-zip 
```

我的解决方案使用该`http.get`方法，因为它返回 Buffer 块。

代码：

```
var file_url = 'http://notepad-plus-plus.org/repository/7.x/7.6/npp.7.6.bin.x64.zip';

var AdmZip = require('adm-zip');
var http = require('http');

http.get(file_url, function(res) {
  var data = [], dataLen = 0; 

  res.on('data', function(chunk) {
    data.push(chunk);
    dataLen += chunk.length;

  }).on('end', function() {
    var buf = Buffer.alloc(dataLen);

    for (var i = 0, len = data.length, pos = 0; i < len; i++) { 
      data[i].copy(buf, pos); 
      pos += data[i].length; 
    } 

    var zip = new AdmZip(buf);
    var zipEntries = zip.getEntries();
    console.log(zipEntries.length)

    for (var i = 0; i < zipEntries.length; i++) {
      if (zipEntries[i].entryName.match(/readme/))
        console.log(zip.readAsText(zipEntries[i]));
    }
  });
}); 
```

这个想法是创建一个缓冲区数组，并在最后将它们连接成一个新的缓冲区。这是因为缓冲区无法调整大小。

**更新**

这是一个更简单的解决方案，它使用模块通过设置选项`request`来获取缓冲区中的响应。`encoding: null`它还遵循重定向并自动解析 http/https。

```
var file_url = 'https://github.com/mihaifm/linq/releases/download/3.1.1/linq.js-3.1.1.zip';

var AdmZip = require('adm-zip');
var request = require('request');

request.get({url: file_url, encoding: null}, (err, res, body) => {
  var zip = new AdmZip(body);
  var zipEntries = zip.getEntries();
  console.log(zipEntries.length);

  zipEntries.forEach((entry) => {
    if (entry.entryName.match(/readme/i))
      console.log(zip.readAsText(entry));
  });
}); 
```

响应的`body`是一个缓冲区，可以直接传递给`AdmZip`，简化了整个过程。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T22:11:20.490

遗憾的是，您无法将响应流通过**管道**传输到解压缩作业中，因为节点`zlib`库允许您这样做，您必须缓存并等待响应结束。我建议你在大文件的情况下将响应传递给`fs`流，否则你会瞬间填满你的记忆！

我不完全理解您要做什么，但恕我直言，这是**最好的方法**。您应该**只在真正需要时才将数据保存在内存中**，然后**流式传输到[csv 解析器](https://github.com/wdavidw/node-csv-parser)**。

*如果要将所有数据保存在内存中，可以将 csv 解析器方法替换为`fromPath`采用`from`缓冲区的方法，并在 getData 中直接返回`unzipped`*

您可以使用`AMDZip`(如@mihai 所说) 而不是`node-zip`，请注意，因为`AMDZip`尚未在 npm 中发布，因此您需要：

```
$ npm install git://github.com/cthackers/adm-zip.git 
```

**NB 假设：zip 文件只包含一个文件**

```
var request = require('request'),
    fs = require('fs'),
    csv = require('csv')
    NodeZip = require('node-zip')

function getData(tmpFolder, url, callback) {
  var tempZipFilePath = tmpFolder + new Date().getTime() + Math.random()
  var tempZipFileStream = fs.createWriteStream(tempZipFilePath)
  request.get({
    url: url,
    encoding: null
  }).on('end', function() {
    fs.readFile(tempZipFilePath, 'base64', function (err, zipContent) {
      var zip = new NodeZip(zipContent, { base64: true })
      Object.keys(zip.files).forEach(function (filename) {
        var tempFilePath = tmpFolder + new Date().getTime() + Math.random()
        var unzipped = zip.files[filename].data
        fs.writeFile(tempFilePath, unzipped, function (err) {
          callback(err, tempFilePath)
        })
      })
    })
  }).pipe(tempZipFileStream)
}

getData('/tmp/', 'http://bdn-ak.bloomberg.com/precanned/Comdty_Calendar_Spread_Option_20120428.txt.zip', function (err, path) {
  if (err) {
    return console.error('error: %s' + err.message)
  }
  var metadata = []
  csv().fromPath(path, {
    delimiter: '|',
    columns: true
  }).transform(function (data){
    // do things with your data
    if (data.NAME[0] === '#') {
      metadata.push(data.NAME)
    } else {
      return data
    }
  }).on('data', function (data, index) {
    console.log('#%d %s', index, JSON.stringify(data, null, '  '))
  }).on('end',function (count) {
    console.log('Metadata: %s', JSON.stringify(metadata, null, '  '))
    console.log('Number of lines: %d', count)
  }).on('error', function (error) {
    console.error('csv parsing error: %s', error.message)
  })
}) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T21:49:47.283

如果您在 MacOS 或 Linux 下，您可以使用`unzip`命令从`stdin`.

在此示例中，我将 zip 文件从文件系统读取到一个`Buffer`对象中，但它也适用于下载的文件：

```
// Get a Buffer with the zip content
var fs = require("fs")
  , zip = fs.readFileSync(__dirname + "/test.zip");

// Now the actual unzipping:
var spawn = require('child_process').spawn
  , fileToExtract = "test.js"
    // -p tells unzip to extract to stdout
  , unzip = spawn("unzip", ["-p", "/dev/stdin", fileToExtract ])
  ;

// Write the Buffer to stdin
unzip.stdin.write(zip);

// Handle errors
unzip.stderr.on('data', function (data) {
  console.log("There has been an error: ", data.toString("utf-8"));
});

// Handle the unzipped stdout
unzip.stdout.on('data', function (data) {
  console.log("Unzipped file: ", data.toString("utf-8"));
});

unzip.stdin.end(); 
```

这实际上只是以下的节点版本：

```
cat test.zip | unzip -p /dev/stdin test.js 
```

**编辑**：值得注意的是，如果输入 zip 太大而无法从标准输入中读取一大块，这将不起作用。如果您需要读取更大的文件，并且您的 zip 文件只包含一个文件，您可以使用[funzip](http://www.info-zip.org/mans/funzip.html)代替`unzip`：

```
var unzip = spawn("funzip"); 
```

如果您的 zip 文件包含多个文件（并且您想要的文件不是第一个文件），我恐怕会说您不走运。unzip需要在`.zip`文件中查找，因为 zip 文件只是一个容器，而 unzip 可能只是解压缩其中的最后一个文件。在这种情况下，您必须临时保存文件（[node-temp](https://github.com/bruce/node-temp)派上用场）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T23:20:11.757

两天前，该模块`node-zip`已发布，它是仅 JavaScript 版本的 Zip 的包装器：[JSZip](http://stuartk.com/jszip/)。

```
var NodeZip = require('node-zip')
  , zip = new NodeZip(zipBuffer.toString("base64"), { base64: true })
  , unzipped = zip.files["your-text-file.txt"].data; 
```

# python - 用于静态类型类属性的 Python 模块

> ID：10359488
> 
> 赞同：1
> 
> 时间：2012-04-28T00:31:53.317
> 
> 标签：python, static-typing

我希望我的 Python 类在将值分配给属性时自动检查值的类型。

有 enthought 的[traits](http://code.enthought.com/projects/traits/)模块，IPython 有一个纯 python 版本作为其子模块[IPython.utils.traitlets](http://ipython.org/ipython-doc/dev/api/generated/IPython.utils.traitlets.html)。有没有类似的模块？如果该模块具有自动命令行参数解析器来设置这些属性，那就更好了。

**编辑**：感谢您的片段。但我想要 Python**库**。如果有库可以做到这一点，我不想自己重新实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:56:05.490

我不知道`traits`...但是如果您想在分配对象时检查它的类型，您可以覆盖`__setattr__`以检查...

```
class MyClass(object):
   def __setattr__(self, attr, val):
       if attr == 'my_attr':
           if not isinstance(val, str):
              raise ValueError('my_attr must be a string!')
           else:
              object.__setattr__(self, attr, val)
       else:
           object.__setattr__(self, attr, val)

a = MyClass()
a.my_attr = "Hello World!"  # This is OK
a.my_attr = 1               # This is not: ValueError 
```

但如果没有充分的理由，我真的不建议这样做......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:12:49.303

几乎任何方式的“自动”行为都可以使用 python 描述符在对象属性上确定。最简单的描述符是`property`：

```
class Foo(object):
    @property
    def bar(self):
        try:
            return self._bar
        except AttributeError:
            return "default value"

    @bar.setter
    def bar(self, value):
        if isinstance(value, Baz): # for some other type "Baz"
            self._bar = value
        else:
            raise ValueError("wrong type for attribute bar,"
                             " expected %r, got %r" % (Baz, type(value)) 
```

# c# - 遍历两个字符串并在 c# 中对它们使用“与”门

> ID：10359490
> 
> 赞同：0
> 
> 时间：2012-04-28T00:32:17.137
> 
> 标签：c#, string

当我只使用 1 位字符串时，我的 andgate 工作，但其他任何东西，它根本不起作用，并告诉我“特定参数超出了有效值的范围。参数名称：startIndex。”

有人知道我在这里做错了什么吗？有没有更好的方法添加到字符串的末尾？谢谢！

```
private string parsestrings(string s1, string s2)
{
    int n = s1.Length;
    int m = s2.Length;
    int l;
    string s = "";
    if (n > m)
    {
        for(int i = 0; i <= n; i++)
        {
            l = AndGate(s1[i], s2[i]);
            s.Insert(i, IntToBinary(l));
        }
    }
    else
    {
        for (int i = 0; i <= n; i++)
        {
            l = AndGate(s1[i], s2[i]);
            s.Insert(i, IntToBinary(l));
        }
    }
    return s;
}

private int AndGate(int m, int n)
{
    if (m == 1 && n == 1)
        return 1;
    if (m == 1 && n == 0)
        return 0;
    if (m == 0 && n == 1)
        return 0;
    else
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T00:39:36.400

您的循环终止条件错误。'i <= n' 在字符串末尾运行字符串索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:40:26.377

你的逻辑似乎有点不对劲。如果`n > m`，那么循环可能应该停止在`m`而不是`n`：

```
for(int i = 0; i <= m; i++)
{
    l = AndGate(s1[i], s2[i]);
    s.Insert(i, IntToBinary(l));
} 
```

不过，第二个循环似乎是正确的。

第二个想法是条件`i <= m`可能应该是`i < m`，因为`s1[m]`是字符串后面的一个字符。

最后，您可以听从 spender 的建议，也可以使用 a[`StringBuilder`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)代替。构造字符串通常比不断添加和更新字符串更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T00:34:59.010

`s.Insert`创建一个新字符串。它不会修改原始字符串。

你的意思是：

```
s = s.Insert .... 
```

，同样在你的情况下`n > m`，你一直迭代到`n`，即使字符串`s2`不是`n`字符长，所以你会越界。

另一方面，Linq`Zip`扩展方法允许您在一行中执行此操作：

```
string.Concat(
    s1
       .Zip(s2, (c1,c2) => new {c1, c2})
       .Select(x => x.c1 == '1' && x.c2 == '1' ? '1' : '0')) 
```

# java - Java中的XORing最低有效位

> ID：10359495
> 
> 赞同：2
> 
> 时间：2012-04-28T00:33:49.530
> 
> 标签：java

我已经阅读了大量有关 Java 中的按位算术的内容，但我似乎总是以某种方式弄错了。我试图弄清楚如何对 java 的两个字节中的两个最低有效位进行异或。

例子：

byteOne = 01010101 byteTwo = 11111111 byteOne 变为 01010100 由于 byteTwo 中的最低有效位

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:37:34.397

尝试以下操作：

```
byteOne ^= byteTwo & 1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T10:48:28.713

[我曾经写过一个用于位操作的小程序](http://home.arcor.de/hirnstrom/minis/index.html#bitorgel)，你可能会觉得玩起来很有趣。

# objective-c - xcode 3.1.4：nib 控制器似乎没有找到 nib 文件？

> ID：10359499
> 
> 赞同：0
> 
> 时间：2012-04-28T00:34:19.480
> 
> 标签：objective-c, xcode, nib

所以我有一个 MyNibController 类和一个 nib 文件，我尝试调用 MyNib.xib 和 MyNibController.xib 都没有运气。我想我已经让它们在 IB 端正确连接（尽管我正在关注 xcode 5 的教程），并且我的 nib 的所有者被指定为 MyNibController 类。

问题是，即使在我的 AppDelegate 类中运行我的 applicationDidFinishLaunching 方法后，视图显然也没有加载，其中包括：

```
[window addSubview:myNibController.view]; 
```

模拟器显示空白屏幕，文档说如果 UIController 的子类找不到具有正确名称的笔尖，它只会构成一个空白视图，所以这就是为什么我认为它找不到它。但这并不意味着：

```
[myNibController isViewLoaded] 
```

应该在第一个代码运行后返回 true 吗？

感谢您的帮助！

# php - 简单的 PHP dom 解析器 - 获取没有标签的文本

> ID：10359500
> 
> 赞同：1
> 
> 时间：2012-04-28T00:34:29.180
> 
> 标签：php, parsing, dom, foreach, find

我正在尝试检索服务器的游戏模式。这是代码：

```
<p>
<strong>Grand Bazaar</strong>
<span class="bullet">•&lt;/span>
Rush •
<img src="src.png">
</p> 
```

我正在寻找拉什。我试过这个脚本：

```
 foreach($html->find('p .bullet') as $e)
{
    $mode = $e->nextSibling ();
} 
```

但脚本只是跳过“Rush”并继续到下一个标签。我相信你们比我更清楚自己在做什么。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:47:57.117

您需要使您的问题更清楚，伙计...“我正在尝试检索服务器的游戏模式” <-例如，这与您的问题无关。

您遇到的问题是“Rush”只不过是文本，它不是 .bullet 的兄弟，因为这意味着 Rush 是 .bullet 的兄弟标签的内容，比如说

```
<span class="bullet">•&lt;/span>
<span>Rush •&lt;/span>
<img src="src.png"> 
```

如果您呈现的结构一直都是相同的，并且您使用的是简单的 HTML DOM，那么您可以先清除标签的内容：

```
$strong = $html->find('strong'); // I think you can use prevSibling in your example
$strong->innerText = null; 
```

然后只在整个段落上使用 strip_tags() 并获取文本？

# asp.net - 页面上的 Facebook 帖子

> ID：10359503
> 
> 赞同：2
> 
> 时间：2012-04-28T00:34:38.417
> 
> 标签：asp.net, facebook, facebook-graph-api, facebook-page

我正在使用[Facebook SDK 6](http://csharpsdk.org/docs/making-synchronous-requests.html)和 Graph API 将数据从 app (ASP.NET) 发布到[页面](http://www.facebook.com/TfdTest)。

[首先，我的应用程序（网站）使用此处](https://developers.facebook.com/docs/authentication/server-side/)描述的服务器流获取访问令牌。接下来，它使用此令牌在我的页面中发布一些文本：

```
 Dim fb = New FacebookClient(accessToken)
    Dim o As Dictionary(Of String, Object) = New Dictionary(Of String, Object)
    o.Add("message", "some text...")
    Dim result = fb.Post("/TfdTest/feed", o) 
```

为了测试它，我浏览了我的网站。我允许我的网站更改我的 Facebook 页面并授予权限（publish_stream、manage_pages）。问题是最终提要出现在“其他人最近的帖子”部分中：

![在此处输入图像描述](../Images/5b87e9d1a6eef5ea2496a17779b387d6.png)

**我如何从页面名称而不是我自己发布提要？？？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T11:48:49.763

为了代表页面使用 Graph API，您需要获取页面访问令牌 - 请参阅此处了解更多详细信息：[https ://developers.facebook.com/docs/authentication/pages/](https://developers.facebook.com/docs/authentication/pages/)

1.  验证用户并请求**manage_pages**权限
2.  获取用户使用 (1) 中的令牌管理的页面列表 - [https://graph.facebook.com/me/accounts?access_token=USER_ACCESS_TOKEN](https://graph.facebook.com/me/accounts?access_token=USER_ACCESS_TOKEN)
3.  解析列表并获取 PAGE 令牌 - 并使用它发布到提要。

# python - 函数没有被调用

> ID：10359507
> 
> 赞同：0
> 
> 时间：2012-04-28T00:35:01.523
> 
> 标签：python, pygame

我有检查分数的功能，如果分数达到给定的分数，我的功能会（我还没有完成）提高水平，我的功能：

```
def levels(Score):
 if score >= 100:
   enemies = 6
   velocity = 2 
```

我在游戏循环中调用它：

```
levels(score) 
```

该函数永远不会被执行，我的源代码[http://pastebin.com/JPZSTA6a](http://pastebin.com/JPZSTA6a) 行：35-38 和 150

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:40:33.370

你有`if score >= 100`当你可能的意思`if Score >= 100`。该函数被执行，只是 if 语句总是计算为假。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T03:21:17.470

正在调用该函数，但您正在分配给函数`enemies`并`velocity`在函数中分配，因此它们是函数的局部变量，然后在函数返回时被丢弃。所以你的函数被调用，但没有持久的效果。

你需要阅读 Python 中的局部变量和全局变量。正如其他人指出的那样，您也有两者`Score`和`score`这里。Python 区分大小写，它们是不同的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T00:47:21.163

这是一个范围问题，您所指的变量（敌人和速度）是在 while 循环内进一步创建的，因此它们不在您尝试修改它们的函数的范围内。您需要阅读[执行模型](http://docs.python.org/reference/executionmodel.html)，它应该能够阐明范围规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T00:51:29.507

你的代码，解释：

```
def game():

    def levels(Score):
        print 'levels!'

    while start == True:
        print 'start is indeed True!'
        while not finish or falling: 
            'I am not Finnish'     
            for i in range(enemies):
                'alas for I am beset by enemies!'
                levels(score) 
```

那么，为什么不调用levels() 呢？我想这些控制流项目之一并没有按照你想要的方式进行。例如，我不能说你的敌人变量是否为空，但我可以告诉你 print 是你的朋友。

# java - 如何在java中绘制自动机

> ID：10359509
> 
> 赞同：5
> 
> 时间：2012-04-28T00:35:17.320
> 
> 标签：java, swing, expression-trees, finite-automata, automata

我想画一个带有边缘和循环状态的自动机，像这样 [http://pop-art.inrialpes.fr/~girault/Cours/Automates/td5.html](http://pop-art.inrialpes.fr/~girault/Cours/Automates/td5.html)，你有一个例子

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T02:01:01.860

[JGraph](http://www.jgraph.com/)是一个您可以使用的库，它是 Java 原生的并且相当容易使用，或者您可以生成一个`.dot`文件并让 GraphViz 为您处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T09:38:36.173

如果您不想以正确的方式表示图形，例如尝试不越线，或者在同一位置没有两个或多个节点，那么我建议您使用 grail 图形库，这样您就可以看到使用 yed 的图形可以工作（我可以为您提供一个示例，只需在评论中编写正则表达式即可），或者如果您想自己绘制图形，那么您可能很适合学习分层图形绘制： [http:// en.wikipedia.org/wiki/Layered_graph_drawing](http://en.wikipedia.org/wiki/Layered_graph_drawing) 和 Coffman Graham 算法 [http://en.wikipedia.org/wiki/Coffman%E2%80%93Graham_algorithm](http://en.wikipedia.org/wiki/Coffman%E2%80%93Graham_algorithm)

# python - 从字符串中提取部分（python）

> ID：10359511
> 
> 赞同：1
> 
> 时间：2012-04-28T00:35:59.937
> 
> 标签：python, string

我有一个包含如下字符串的文件：

```
NM_???? chr12 - 10 110 10 110 3 10,50,100, 20,60,110, 
```

我对最后两列感兴趣，第一列是逗号分隔的外显子列表，最后一个是逗号分隔的外显子列表。

也就是说，我做了以下事情：

```
fp = open(infile, 'r')
for line in fp:
   tokens = line.split()
   exonstarts = tokens[8][:-1].split(',')
   exonends = tokens[9][:-1].split(',')
   zipped = list(zip(exonstarts, exonends)) 
```

现在我有一个看起来像这样的列表：

```
[(10, 20), (50, 60), (100, 110)] 
```

我还有一个问题，我想要这些东西。因此，例如，我想要`chr_string[10:20]+chr_string[50:60]+chr_string[100:110]`有一种方法可以轻松地说出这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:42:07.900

我认为最 Pythonic 的说法是：

```
''.join(chr_string[a[0]:a[1]] for a in myList) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T00:47:44.843

```
"".join(chr_string[slice(*exon_interval)] for exon_interval in zipped) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T01:00:15.727

使用这些对`list`通过切片（我已经制作）获得：`chr_string`

```
>>> [chr_string[start:end + 1] for start,end in zip(exonstarts, exonends)]
['05060708091', '25262728293', '50515253545'] 
```

将这些结合在一起：

```
>>> ''.join(chr_string[start:end + 1] for start,end in zip(exonstarts, exonends))
'050607080912526272829350515253545' 
```

# string - Wolfram Mathematica 从多个文件导入数据

> ID：10359514
> 
> 赞同：3
> 
> 时间：2012-04-28T00:36:29.450
> 
> 标签：string, import, wolfram-mathematica

我有很多文件。每一个都包含数据。我可以很高兴地将一个文件导入 Mathematica。但是有超过500数百个文件。我这样做：

```
 Import["~/math/third_ks/mixed_matrices/1.dat", "Table"];
 aaaa = %
  (*OUTPUT  - some data, I can access them!*) 
```

我想要的只是制作圆圈（我可以做到），但我无法更改文件名 - 1.dat。我想改变它。

我试图做出这样的解决方案。我生成了部分可能的名称，并将它们写入单独的文件。

```
Import["~/math/third_ks/mixed_matrices/generate_name_of_files.dat", "Table"];
aaaa = % 
```

输出： `{{"~/math/third_ks/mixed_matrices/0.dat"}, \`
`{"~/math/third_ks/mixed_matrices/1.dat"}, ......`

我想做的就是`Table[a=Import[aaaa[[i]] ,{i,1,500}]`

但该函数`Import`只接受 `String`“”对象作为文件名/路径。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T09:37:22.583

您可以使用`FileNames`通常的通配符来收集要导入的数据文件的名称。

然后将`Import`语句映射到文件名列表上。

`data`然后将包含一个列表，该列表包含来自每个文件的数据作为单独的元素。

```
data = Import[#,"Table"]& /@ FileNames["~/math/third_ks/mixed_matrices/*.dat"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T09:15:33.547

如果没有文件名文件，很难弄清楚发生了什么。但是，我认为您可以通过使用`Flatten`文件名列表使其成为`String`可以传递给的对象向量来解决您的问题`Import`。目前，您的列表是一个 n*1 矩阵，其中每一行是`List`包含 a 的 a `String`，而不是`String`s 的向量。

顺便说一句，在这种情况下，您可以使用`Map`( `/@`) 代替。`Table`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T20:47:36.817

谢谢您的答复。
它发生了，所以我同时得到了两个解决方案。
我认为忘记第二种方式是不公平的。

```
 aaaa = "~/math/third_ks/mixed_matrices/" <> ToString[#] <> ".dat" & /@  Range[0, 116];
   (*This thing generates list of lines  
     Output:
       {"~/math/third_ks/mixed_matrices/0.dat", \
        "~/math/third_ks/mixed_matrices/1.dat", \
        "~/math/third_ks/mixed_matrices/2.dat",    .....etc, until 116

    Table[Import[aaaa[[i]], "Table"], {i, 1, 117}];
    (*and it just imports data from file*)

    bbbb = %;  (*here we have all data, voila!*) 
```

顺便说一句，这不是我的解决方案。这是我的一个朋友所设想的： [https ://stackoverflow.com/users/1243244/light-keeper](https://stackoverflow.com/users/1243244/light-keeper)

# php - 使用PHP中的IP地址将文件写入本地PC

> ID：10359523
> 
> 赞同：2
> 
> 时间：2012-04-28T00:38:26.773
> 
> 标签：php, ip-address

如何创建一个 PHP 脚本，该脚本将通过 IP 地址在本地 pc 上创建一个 file.txt，有一个给定的 IP 地址和一个我可以通过的端口。

我怎么能做到这一点？

任何帮助将不胜感激，非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:51:01.403

您可以将其通过 FTP 传输到本地计算机，或者只是让他人将其作为文件下载。第二种解决方案是最简单的，但需要本地计算机上的某个人来启动下载。第一个解决方案可以自动化，但需要您在本地计算机上设置 FTP 服务器。

标头将帮助您输出为客户端的下载。

[http://php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

FTP将帮助您通过FTP上传。

[http://php.net/manual/en/book.ftp.php](http://php.net/manual/en/book.ftp.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:17:22.073

在 Linux 上：

```
cat >dooda.php <<EOF
#!/usr/bin/env php
<?php 
  file_put_contents('file.txt',file_get_contents("http://example.com/of_some_url.txt"));
EOF

php dooda.php 
```

# javascript - javascript中的getter和setter

> ID：10359529
> 
> 赞同：5
> 
> 时间：2012-04-28T00:40:23.827
> 
> 标签：javascript, oop, getter-setter

我从 javascript 开始，特别是 OOP 模式。

我的问题很简单。在 setter 中，有没有办法让参数和私有类变量保持相同的名称？我到处寻找，但找不到任何人提到它，只是具有不同 var 名称的示例。我对我的代码非常挑剔，我不得不给它两个不同的名字。

以[http://ejohn.org/blog/javascript-getters-and-setters/为例](http://ejohn.org/blog/javascript-getters-and-setters/)

```
function Field(val){
    this.value = val;
}
Field.prototype = {
    get value(){
        return this._value;
    },
    set value(val){
        this._value = val;
    }
}; 
```

您可以在 setter 中看到参数是 val 但属性实际上是值。由于它是 javascript，我不能简单地执行 this.value=value，因为“this”会将其公开。value=value 将同时引用参数（并且会很奇怪）。真的没有办法做到这一点吗？如果没有，这种情况是否有任何“最佳实践”？我想下划线可能是有效的，但我只是很挑剔，所以只想确保没有其他方法。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T00:56:37.197

您可以使用闭包来隐藏变量。

```
function MyClass {
  var value;

  this.getValue = function() {
    return value;
  }

  this.setValue = function(val) {
    value = val;
  }

} 
```

构造函数`MyClass`完成后，该`value`字段将无法访问，因为它的范围仅适用于此构造函数（函数）。所以我们可以说这`value`是一个私有领域。但是，方法`getValue()`和`setValue()`可以从构造对象公开访问，并且它们保持对 的变量范围的引用`MyClass`，因此它们仍然可以操作`value`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T00:52:39.880

使用闭包：

```
(function(exports){

    exports.field = {};
    var _value = '123';

    exports.field.get = function(){
        return _value;
    }

    exports.field.set = function(val){
        _value = val;
    }

})(window);

console.log(field.get()); 
```

[这是一个关于JS 闭包](http://net.tutsplus.com/tutorials/javascript-ajax/closures-front-to-back/)的好教程。

# php - PHP Crypt_RSA 加密在 bin2int() 中产生错误

> ID：10359533
> 
> 赞同：0
> 
> 时间：2012-04-28T00:41:09.730
> 
> 标签：php, encryption, rsa

我使用的代码：

```
$privkey=<<<PK
-----BEGIN RSA PRIVATE KEY-----
MIICWgIBAAKBgQDI12iJMtuVD2W6y9EtwlZe335CKdQTjq9kDxmfo0deTXcBvSK7
ZgUq1bCmKaSeYP7VFQHUN0x79g+CvxHY0shWtCUElc2zE07hZlLiJyY4STUcBzA4
oAR7J19hZFdfLpb9inW5lrQ7r3wBpX1QqKpHHvAKONM6WyLTsNRo4CaT0wIBIwKB
gGdKNcLm9JXNZ4SjVaKBM7vDZYEc03fFuUlm2fpT+NFpqurzjjR9nEHqPZdInc3L
e74Kzb2YyD/AX7+VduSJqNs4orVM48P8ElpSyr56RvngJ6rtrt0m4r7Mcgcsus9G
NIZgTetviRWReJKIiGEbIT7ryoCNw8F8w7dgM6SJ+MYLAkEA7eCao3RMQJbpXCuR
p/V6XtuWTy1RjArwET3mUCz0tZUOJvt1D9Dx2NstR37SMwlEk3EEnQmswL/Zp9LZ
PSlw4QJBANgkezIsvxM+8xPV+pFt2AvTgHgScfMHwsF8pgRNZali6hn/M5/Kg3So
KTgRwaRulmuuKBZbI5mRFXidJQh89zMCQQCcUcS0jkC8uvEfT9S+1IOda7qLzVLY
XvWHrFWFJNtSwQlM0SEKZLwva3WGwQ3JxEMBze0WvTcCUi/x8PUoMSzrAkB1VaH2
qpOcu8XI8IC1WOL/Gws53iCZ36Q9JmjAgcl5NbJIoHscOrxj5kJDAlMtYJrMvaC7
rdF/QCGZP10/H0RdAkB8q1PPumOoL7vprMDVGhRdAQ7xG25yj8EmJd9hsWGGqXYk
YrJJGQ5oam6K0o9OPNgIITW9kOunxqmkW7KodKhL
-----END RSA PRIVATE KEY-----
PK;

require_once('Crypt/RSA.php');
$rsa=new Crypt_RSA();

$key=Crypt_RSA_Key::fromString($privKey);
echo "key: ".$key->toString()."\n";
$str=$rsa->encrypt("hello world",$key);
echo "$str\n"; 
```

当我运行它时，我得到这个错误：

```
[27-Apr-2012 17:38:17] PHP Fatal error:  Call to undefined method PEAR_Error::bin2int() in /usr/share/pear/Crypt/RSA.php on line 364 
```

任何想法为什么这不起作用？我验证了这些文件存在：

```
RSA/Math/GMP.php
RSA/Math/BCMath.php
RSA/Math/BigInt.php 
```

这应该是 RSA 类使用的数学包装器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T23:35:57.293

PEAR 的 Crypt_RSA 被[phpseclib 的 Crypt_RSA](http://phpseclib.sourceforge.net/)取代，根据这个：

[http://pear.php.net/package/Crypt_RSA](http://pear.php.net/package/Crypt_RSA)

原因是 phpseclib 的实现不受 PEAR 实现遭受的漏洞的影响：

[http://www.securityfocus.com/archive/1/520683](http://www.securityfocus.com/archive/1/520683)

因此，我的建议是只使用 phpseclib 的 Crypt_RSA。

# mysql - MySQL UPDATE 与同一张表的 SUBQUERY

> ID：10359534
> 
> 赞同：26
> 
> 时间：2012-04-28T00:41:19.337
> 
> 标签：mysql, sql, phpmyadmin

我正在使用一个复杂的 MySQL 数据库表来收集表单数据。**我在下面名为test**的示例表中简化了布局：

```
|FormID|FieldName|  FieldValue |
|   1  |   city  |   Houston   |
|   1  | country |     USA     |
|   2  |   city  |   New York  |
|   2  | country |United States|
|   3  | property|   Bellagio  |
|   3  |  price  |     120     |
|   4  |   city  |   New York  |
|   4  |zip code |    12345    |
|   5  |   city  |   Houston   |
|   5  | country |     US      | 
```

通过 phpMyAdmin，我需要对某些表进行全局更新，特别是我想将所有**FieldValue条目***更新*为“美国”，其**FieldName** “国家”与**FieldName** “城市”和**FieldValue** “休斯顿”具有相同的**FormID** .

 ******通过使用 SUBQUERY 或使用 INNER JOIN，我可以使用 SELECT 语句轻松*显示这些条目：*

```
SELECT FieldValue
FROM test
WHERE FormID
IN (
   SELECT FormID
   FROM test
   WHERE FieldName =  "city"
   AND FieldValue =  "Houston"
   )
AND FieldName =  "country" 
```

或者：

```
SELECT a.FieldValue
FROM test a
INNER JOIN test b ON a.FormID = b.FormID
WHERE a.FieldName = "country"
AND b.FieldName = "city"
AND b.FieldValue = "Houston" 
```

但是，我尝试编写我的**UPDATE**语句，我得到某种形式的 MySQL 错误，表明我无法在**子查询**或**内部联接**或**联合**方案中引用同一个表。我什至创建了一个**视图**并尝试在更新语句中引用它，但没有解决。有谁知道如何帮助我？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2015-11-09T10:45:27.387

您必须使用临时表，因为您无法更新用于选择的内容。一个简单的例子：

这不起作用：

```
UPDATE mytable p1 SET p1.type= 'OFFER' WHERE p1.parent IN 
    (SELECT p2.id from mytable p2 WHERE p2.actu_id IS NOT NULL); 
```

这将完成这项工作：

```
UPDATE mytable p1 SET p1.type= 'OFFER' WHERE p1.parent IN 
    (SELECT p2.id from (SELECT * FROM mytable) p2 WHERE p2.actu_id IS NOT NULL); 
```

"from (SELECT * FROM mytable) p2" 将创建您的表的临时副本，它不会受到您的更新的影响

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-28T01:55:30.000

如果我理解正确，别名应该可以解决问题：

```
UPDATE test AS a
JOIN test AS b ON a.id = b.id
    SET a.name = 'New Name'
WHERE a.id = 104; 
```

这不适合你吗？ **更新**：这已经过测试并适用于 MySQL v5.6。******

# c# - GridView Column 点击导出数据到 Excel

> ID：10359540
> 
> 赞同：1
> 
> 时间：2012-04-28T00:42:23.653
> 
> 标签：c#, asp.net, gridview

我是 ASP.NET 世界的新手，需要一些帮助。

我需要创建一个显示员工姓名的 GridView。当用户单击员工姓名时，它将调用存储过程从数据库中获取特定详细信息并将数据导出到 Excel 表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:00:41.463

有商业和开源库可以帮助完成这项任务，但我是[DoddleReport](http://doddlereport.codeplex.com/)的粉丝，因为它易于配置和使用。

我写了[一篇博](http://www.woodcp.com/2012/02/petapoco-doddlereport-dynamic-pivot-query/)文，演示如何使用 DoddleReport 和 PetaPoco 将 SQL Server PIVOT 查询从 ASP.NET MVC3 应用程序导出到 Excel。任务的 Excel 部分只有几行代码。

示例项目在[github上可用](https://github.com/tawman/PetaPocoPivot)

# mysql - 如果先例查询至少有 1 个结果，则不返回任何结果？

> ID：10359546
> 
> 赞同：1
> 
> 时间：2012-04-28T00:43:23.110
> 
> 标签：mysql, sql

基本上我有这个查询：

```
( SELECT * FROM tbl WHERE type = 'word1' )
  UNION
( SELECT * FROM tbl WHERE type = 'word2' ) // Run this query if there are no results with type = 1 
```

基本上我只想在第一个没有任何结果的情况下运行第二个查询。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:22:22.410

第一个“PreCheck”查询计算有多少条记录是类型 = 1。之后，如果计数大于 1，则返回 1，否则返回 2。

现在，该答案可用于连接（始终是通过 COUNT(*) 的单行），其值可能为 1 或 2。该值将是第二个值是 EQUALITY 条件。所以，如果有一个 1 的条目，结果就像

其中 t1.Type = 1

因此决不允许在测试中出现任何 2。但是，如果没有找到任何条目，它的值为 2，因此会创建一个 WHERE 子句

其中 t1.type = 2

```
select t1.* 
   from 
      ( select if( count(*) > 0, 1, 2 ) IncludeType
           from tbl t2
           where t2.type = 1 ) preCheck,
      tbl t1
   where 
      t1.type = preCheck.IncludeType 
```

如果“类型”列上有索引，则第一个查询应该几乎是瞬时的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:02:54.893

你可以写

```
select * from tbl 
where type = 1 
union 
select * from tbl 
where type = 2 
and not exists( select * from tble where type = 1 ) 
```

但这可能不会像在您的程序中那样执行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:03:45.863

它可以解决问题：

```
SELECT tbl.* FROM tbl JOIN (SELECT min(type) min_type FROM tbl WHERE type between 1 and 2 ) on min_type = type 
```

首先，它选择这两种类型中较小的一个（如果存在），然后将这个数字表添加到您的表中。它实际上是一个简单的过滤器。如果需要，您可以使用 WHERE 而不是 JOIN。

```
SELECT tbl.* FROM tbl WHERE (SELECT min(type) FROM tbl WHERE type between 1 and 2 ) = type 
```

# python - 路线在生产中中断，但不在 Pyramid 开发中

> ID：10359548
> 
> 赞同：1
> 
> 时间：2012-04-28T00:44:10.543
> 
> 标签：python, debugging, routing, pyramid

我有一条在生产中（在 Apache 2 和 mod_wsgi 下）不起作用的特定路由（'service' 和 '/service'）（它们触发 NotFound 视图）。

但是，在开发中它们工作正常。

我可以做些什么来调试这个问题？我尝试添加另一条类似的路线（引发配置错误）。我试过在 development.ini 文件下运行它（除了日志记录没有变化）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T21:19:23.470

您可以尝试使用 Pyramid 的 notfound 调试输出来收集生产配置和开发配置之间的差异：

[http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/narr/environment.html#debugging-not-found-errors](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/narr/environment.html#debugging-not-found-errors)

# java - 字符串索引错误

> ID：10359549
> 
> 赞同：0
> 
> 时间：2012-04-28T00:44:15.297
> 
> 标签：java, error-handling, stringbuilder

我不断收到一条错误消息，指出我的字符串索引超出了 String.charAt、PasswordGenerator.matchCharAt 和 Driver.main 的范围。我不知道这到底是什么意思。此外，我的字符不会附加到我已经实例化的 stringbuilder 类的一行。我想知道这是否可能是由字符串索引错误引起的，或者是我的错。

```
public class Driver {

    public static void main(String[] args) {
        int length=0;
        int MaxNumber=100;
        StringBuilder password = new StringBuilder();

        do {
            if (PasswordGenerator.matchLength (length))
                System.out.println("The length of the character is " + length);
            length++;                                     // length is randomly picked
        } while (length < MaxNumber );   // or <100

        int index = 0;
        char f = 0;

        for (int d = 0; d < 127 || ; d++) {
            if  (PasswordGenerator.matchCharAt(f, index))
                d = (char) index;
            char aChar = (char)d;
            password.append(aChar);
            System.out.println("Password is: " + aChar);
            index++;

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:58:24.540

您会收到错误，因为`idx`它将在 0 和 127 之间变化。来自 的密码`PasswordGenerator`可能不会那么长。例如，在您询问索引 57 是否匹配之前，您必须询问 57 是否小于密码的长度。

所以你的任务是猜测生成器保存的密码？那么你应该这样做：

```
Get to know the length of the password.
For each index from 0 upto but excluding the length:
    Guess the character at that index. 
```

# ruby-on-rails - oink logs 命令在heroku上不起作用

> ID：10359552
> 
> 赞同：6
> 
> 时间：2012-04-28T00:44:51.917
> 
> 标签：ruby-on-rails, memory-leaks

我最近开始在我的 heroku 应用程序上使用[oink gem](https://github.com/noahd1/oink)，因为我注意到一些控制器操作存在小内存泄漏。oink logs 命令在本地运行良好，但我不知道如何让它在我的生产站点上运行。

这是我正在尝试的命令：

```
heroku run oink /log/* 
```

这是我`production.rb`文件中的一行：

```
config.middleware.use( Oink::Middleware, :logger => Rails.logger ) 
```

在我的本地安装中，oink 将日志存储在`/log/oink.log`文件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T16:40:11.060

这是答案：[https ://stackoverflow.com/a/14145299/1684322](https://stackoverflow.com/a/14145299/1684322)

使用 Hodel3000CompliantLogger 而不是 Rails.logger 很重要，否则 oink 将无法解析日志文件。它也可以不在 config/environments/production.rb 中配置，而是在 config/initializers/oink.rb 中配置

```
YourApplication::Application.middleware.use( Oink::Middleware, :logger => Hodel3000CompliantLogger.new(STDOUT), :instruments => :memory) 
```

这将使 Oink 写入默认日志文件，稍后可能会被

```
heroku logs -n500 --app app_name > logfile_for_oink 
```

或者使用其他日志管理工具，比如 PaperTrail ，或者设置 syslog drain（另一个 *nix box 上的 rsyslog）。

使用带有 --threshold=0 的 oink 来显示所有条目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T06:26:56.937

以下是 Heroku 支持的回复：

“在大多数情况下，在本地使用 Oink 足以了解内存使用问题。Heroku 的文件系统是短暂的，每个 dyno 都有自己独立的文件系统，因此写入和获取文件不是很实用。如果您可以将 Oink 配置为写入标准输出或你的 Rails 记录器它的消息应该显示在你的 Heroku 日志中，你可以使用[log drain](https://devcenter.heroku.com/articles/logging#syslog-drains)或像[Papertrail](https://addons.heroku.com/papertrail)这样的日志归档插件来获取它们的本地副本。"

所以听起来他们建议在开发中使用它。或者，如果您可以写入标准输出，然后将它们自己记录为正确的格式。

我无法在短时间内弄清楚，所以我最终使用`heroku-api`gem 从 cron 作业每隔几个小时自动重新启动应用程序服务器。这是一个临时修复。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-12T11:21:18.290

要分析您的生产日志，您需要运行

```
heroku run bundle exec oink log/production.log 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-18T22:05:10.673

尝试

```
heroku run bundle exec oink log/* 
```

# python - 检查可能为无的列表中的成员资格的pythonic方法是什么？

> ID：10359555
> 
> 赞同：2
> 
> 时间：2012-04-28T00:45:52.443
> 
> 标签：python

我需要获取字典中的所有键，其对应值高于最小值并且在给定列表中。就像是：

```
result = [k for k in my_dict if my_dict[k] > min_value and k in allowed_keys] 
```

但是，可能是我对允许的键没有限制。我发现最pythonic的做法是将allowed_keys设置为None。但这会给我留下一段丑陋的代码：

```
if allowed_keys is None:
    result = [k for k in my_dict if my_dict[k] > min_value]
else:
    result = [k for k in my_dict if my_dict[k] > min_value and k in allowed_keys] 
```

我觉得必须有一个更明智和 pythonic 的解决方案。我想过使用 lambda 函数，但我不确定。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:48:35.763

您可以`allowed_keys is None`在列表理解中检查：

```
result = [k for k in my_dict if my_dict[k] > min_value and (allowed_keys is None or k in allowed_keys)] 
```

这看起来像一个非常奇怪的英语句子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T00:52:37.103

`iteritems()`当您需要同时访问键和值时使用

```
result = [k for k, v in my_dict.iteritems()
          if v > min_value
          and (k in allowed_keys if allowed_keys is not None else True)]

# shorter but seems harder to read
result = [k for k, v in my_dict.iteritems()
          if v > min_value
          and (True if allowed_keys is None else k in allowed_keys)]

# shorter but a bit weird and slower
result = [k for k, v in my_dict.iteritems()
          if v > min_value
          and (k in (allowed_keys or my_dict))]

# senderie's comment, very clear in logic, no more no less. I'd like to pick it.
result = [k for k, v in my_dict.iteritems()
          if v > min_value
          and (allowed_keys is None or k in allowed_keys) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T01:11:45.607

除了为解决方案寻求“最 Pythonic”的语法之外，您还应该遵循良好的设计原则（例如[Python 之禅）。](http://www.python.org/dev/peps/pep-0020/)

引入`allow_all_keys`布尔属性而不是重载`allowed_keys`. 这样做，代码就变成了：

```
result = [k for k in my_dict if my_dict[k] > min_value and 
                                (allow_all_keys or k in allowed_keys)] 
```

来自[Python 之禅](http://www.python.org/dev/peps/pep-0020/)：

> 显式优于隐式。
> 简单胜于复杂。
> 可读性很重要

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T01:00:35.413

我认为您当前的解决方案效果很好。它可读、明确且高效（`allowed_keys`在没有限制的情况下只测试一次）。

如果你真的要使用单线，你应该`allowed_keys`在没有限制的情况下设置成全套键。设置`allowed_keys`为`None`kind of 意味着不允许使用任何键，这在语义上是违反直觉的..

# objective-c - OSX Lion -- 进入 Launchpad 时的 NSEvent

> ID：10359558
> 
> 赞同：1
> 
> 时间：2012-04-28T00:46:18.443
> 
> 标签：objective-c, macos, cocoa, osx-lion

我正在编写一个使用粘在屏幕前景的窗口的 Mac 应用程序。我正在监听`NSWindowDidResignKeyNotification`以检测何时适合隐藏窗口。

对于几乎所有目的——包括当不同的应用程序进入焦点时——这都非常有效。

在 OSX Lion 上有一个特质。当我的窗口打开并粘在前景上，然后用户`Launchpad`从 Dock 中选择图标以展开 时`Launchpad`，我的窗口将停留在前景中，甚至在`Launchpad`. 它似乎`Launchpad`是作为某种屏幕覆盖实现的，而不是作为焦点的窗口。

有没有人有任何解决方案来检测何时`Launchpad`进入焦点以便我可以关闭我的窗口？

# php - 页脚中不可移除的版权文本

> ID：10359560
> 
> 赞同：0
> 
> 时间：2012-04-28T00:47:19.980
> 
> 标签：php, html, footer, copyright-display

我正在为一家小公司开发一个网站，并为他们的公司添加了版权，并在旁边说它是由我的公司设计的。

HTML 代码：

```
<p>Copyright © 2012 Teguise Broker | Designed by <?php include 'copyright.php'; ?></p> 
```

PHP代码：

```
<?php echo "<a href='http://www.my-company.org'>My Company</a>"; ?> 
```

我想要做的是尝试使 HTML 代码不可删除，或者如果他们确实尝试删除它，则页面不会显示。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:50:44.983

如果他们可以访问源代码，就没有办法绝对阻止他们。您能做的最好的事情就是让他们难以删除它。[PHP 混淆](https://www.google.com/search?aq=0&oq=php%20obfu&sourceid=chrome&ie=UTF-8&q=php%20obfuscator)器将是让他们复杂化的最佳方式。但是请参阅[此答案](https://stackoverflow.com/a/232767/250259)以了解为什么您不应该打扰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T13:28:48.653

这是一个奇怪的问题，但是如果客户端拥有所有源文件，则无法确保版权声明。如果你想偷偷摸摸，滚动你自己的 jQuery 副本并添加一个检查版权元素是否存在的方法，以便在页面加载时像这样工作 -

```
function validate() {
    var copy = document.getElementById("copyright");
    if (!copy) {
        var html = document.getElementsByTagName("html")[0];
        var body = document.getElementsByTagName("body")[0];
        html.removeChild(body);
    }
} 
```

但是，当然，正如其他人提到的那样，这是一种将您的声誉拖入泥潭的方法。我认为积极的口碑比页脚链接更有效。如果您想出于 SEO 或广告目的保留链接，请为客户提供折扣以保持链接到位。这样，每个人都保持快乐。

# onclick - W3C验证css sprite后退按钮？

> ID：10359564
> 
> 赞同：0
> 
> 时间：2012-04-28T00:47:27.620
> 
> 标签：onclick, css-sprites, w3c-validation

如何让我的 css sprite 返回按钮通过 W3C 验证？这是我调用按钮的代码。

```
<a href="#" onclick="history.go(-1)"><div class="icon-backbtn"></div></a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T16:24:51.617

我最终使用下面的代码来通过 W3C 验证并仍然使用 CSS Sprites。

```
<a id="icon-backbtn" title="Back" href="#" onclick="history.go(-1)"></a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T00:50:48.817

您不应该将 a`<div>`作为 a 的孩子，而应`<a>`使用 an `<img src="..."/>`。

**编辑：**

如果你有一个精灵表，那么只需添加`display:block;`锚点，它的行为就像一个 div。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:28:49.407

由于您使用的是 CSS Sprite，我建议将其放置`<a>`在`<div>`（*正确的方法*）并添加一些 css：

**HTML**

```
<div class="icon-backbtn">
  <a href="javascript:history.go(-1)" title="Go Back"></a>
</div> 
```

**CSS**

```
.icon-backbtn a {
  display:block;
  cursor:pointer;
  text-decoration:none;
  text-indent:-9999px;
} 
```

CSS 将链接设置为块元素，从而占据 div 的宽度和高度。其余样式用于防止文本的常规链接行为，因为您使用的是图像。

# c - ?? 在 OpenMP 回溯中

> ID：10359571
> 
> 赞同：0
> 
> 时间：2012-04-28T00:48:34.523
> 
> 标签：c, debugging, pthreads

我有来自openmp（pthreads）区域的段错误，我非常无益：

```
/usr/src/packages/BUILD/glibc-2.11.1/string/wordcopy.c:85
/usr/src/packages/BUILD/glibc-2.11.1/string/./memmove.c:73
??:0
??:0
??:0
/usr/src/packages/BUILD/glibc-2.11.1/nptl/pthread_create.c:301 
```

有什么方法可以在 pthread 上下文中获取实际的回溯？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:13:55.563

OP 没有提到，但假设它使用 gcc/g++ 来构建代码。

如果代码是使用 -g 编译的，则在调试内核时尝试在 gdb 提示符下使用此命令：

```
thread apply all bt full 
```

它将显示代码中每个用户创建的线程的所有堆栈跟踪。

# java - 我不断收到 .class 预期错误

> ID：10359574
> 
> 赞同：0
> 
> 时间：2012-04-28T00:49:15.553
> 
> 标签：java, arrays, methods, swap

这是我应该做的：

> 编写一个程序来读取一个 4x4 的二维数组。然后读取数组的第一个元素并将其与每列的第三个元素进行比较。用两者中较大的值替换较小的值。创建一个名为 swap 的方法来交换值。

我不确定我做错了什么，我刚刚开始学习数组。我的老师非常概念化，对他的定义不是很具体，所以我遇到了麻烦。我不断收到 .class 预期错误。

```
public class Array {

    public static void main(String[] args) {       
        int num [][] = {{4, 6, 7, 2},
                        {5, 12, 9, 8},
                        {1, 0, 3, 10},
                        {5, 3, 14, 11}};

        System.out.println("the array elements are:");
        for(int i = 0; i < num.length; i++){
            System.out.println();
            for(int j = 0; j < num[i].length; j++)
                System.out.print(num[i][j] + " ");
        }

        System.out.println("swaped elements are:");
        for(int i = 0; i < num.length; i++){
            System.out.println();
            for(int j = 0; j < num[i].length; j++)
                System.out.print(swap(num[][]) + " ");
        }
    }

    public static void swap (int x[][]){
        for(int i = 0; i < x.length; i++){
            int temp = x[0][i];
            if (x[0][i] > x[2][i] ){
                x[2][i] = temp;
                x[0][i] = x[2][i];
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:58:51.633

`swap()`不返回任何东西。即使您确实解决了其他问题（`num[][]`是语法错误），您也需要指定从交换返回的内容。提示：可能是您修改的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:12:56.533

*   编写一个程序来读取一个 4x4 的二维数组。

我没看到你在读什么。只是初始化它。也许您应该从标准输入或文件中读取？

*   然后读取数组的第一个元素并将其与每列的第三个元素进行比较。
*   用两者中较大的值替换较小的值。
*   创建一个名为 swap 的方法来交换值

作为一种交换方法，我希望使用 2D-Array 中的 2 个位置的 4 个索引的方法，交换值所在的位置。

```
public static void swap (int x[][], int i1, int i2, int j1, int j2) {
    int temp  = x[i1][j1];
    x[i1][j1] = x[i2][j2];
    x[i2][j2] = temp;
} 
```

你听说过简化的 for 循环吗？

```
public static void show (int x[][]) {
    for (int [] inner : x)
        for (int i : inner)
            System.out.print (i + " ");
} 
```

# java - 异步操作的结果列表

> ID：10359578
> 
> 赞同：2
> 
> 时间：2012-04-28T00:50:07.480
> 
> 标签：java, asynchronous, concurrency, guava

我的目标是从 10 个（或其他任意数量的）异步操作中获取结果列表。

我正在`com.google.guava`同时使用公用事业，如果有人能慷慨地指出我正确的方向，我将不胜感激。

在示例中，我试图获取一个列表`successfulBombs`（`Bomb`几乎是一个空对象，但在创建以模拟服务调用执行问题时抛出问题的随机概率）

```
ListeningExecutorService service = MoreExecutors.listeningDecorator(Executors.newFixedThreadPool(10));
List<ListenableFuture<Bomb>> bombs;
ListenableFuture<List<Bomb>> successfulBombs; 
```

编辑：

这是我到目前为止提出的，但列表是空的，即使它应该有一些成功的元素......我不太明白为什么

```
ListeningExecutorService service = MoreExecutors.listeningDecorator(Executors.newFixedThreadPool(10));
List<ListenableFuture<Bomb>> bombs = new ArrayList<ListenableFuture<Bomb>>();
for(int i=0;i<10;i++)
{
    ListenableFuture<Bomb> bomb = service.submit(new Callable<Bomb>(){
        public Bomb call() throws Problem
        {
            return craftBomb();
        }
    });
}
ListenableFuture<List<Bomb>> successfulBombs = Futures.successfulAsList(bombs);
Futures.addCallback(successfulBombs, new FutureCallback<List<Bomb>>(){
    public void onSuccess(List<Bomb> bombs)
    {
        System.out.println("My successful bombs");
        for(Bomb b : bombs)
        {
            System.out.println(b);
        }
    }
    public void onFailure(Throwable thrown)
    {
        System.err.println("There was a problem making this bomb.");
    }
}); 
```

在结束我正在寻找的内容时：

*   启动异步操作的正确模式
*   为结果操作收集列表
*   使用 guava 框架收集成功操作的列表

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T02:08:15.800

该列表是空的，因为您从不向`bombs`. 您将一个空列表传递给`Futures.successfulAsList`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T01:01:09.847

你在找[`ListeningExecutorService.invokeAll(List<Callable<T>>)`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/util/concurrent/ListeningExecutorService.html#invokeAll%28java.util.Collection%29)吗？也许结合[`Futures.allAsList(List<ListenableFuture<T>>)`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/util/concurrent/Futures.html#allAsList%28java.lang.Iterable%29)?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T02:10:06.273

工作解决方案如下

```
 ListeningExecutorService service = MoreExecutors.listeningDecorator(Executors.newFixedThreadPool(10));
    List<ListenableFuture<Bomb>> bombs = new ArrayList<ListenableFuture<Bomb>>();
    for(int i=0;i<10;i++)
    {
        ListenableFuture<Bomb> bomb = service.submit(new Callable<Bomb>(){
            public Bomb call() throws Problem
            {
                return craftBomb();
            }
        });
        bombs.add(bomb);
    }
    ListenableFuture<List<Bomb>> successfulBombs = Futures.successfulAsList(bombs);
    Futures.addCallback(successfulBombs, new FutureCallback<List<Bomb>>(){
        public void onSuccess(List<Bomb> bombs)
        {
            System.out.println("My successful bombs");
            for(Bomb b : bombs)
            {
                System.out.println(b);
            }
        }
        public void onFailure(Throwable thrown)
        {
            System.err.println("There was a problem making this bomb.");
        }
    }); 
```

# javascript - 在 Raphael JS 中的两个百分点之间画一条线

> ID：10359585
> 
> 赞同：4
> 
> 时间：2012-04-28T00:50:49.057
> 
> 标签：javascript, raphael

我正在尝试在基于百分比定位的两个圆圈之间绘制一条路径。他们这样定位的原因是我缩放纸张并希望保持他们的位置。

这适用于圆圈，但是当我尝试绘制这样的路径时：

```
paper.path("M55% 70%L25% 20%") 
```

我得到的是：

```
Error: Problem parsing d="M,0,0" 
```

我怎么知道这件事？

另外，有没有办法在不手动计算的情况下获取元素的百分比位置？

谢谢！

**更新：**

我最终解决了我的问题，但是以一种非常手动的解决方法：

```
var canvasX = $('#worldmap svg').width() / 100;
var canvasY = $('#worldmap svg').height() / 100;
mapCanvas.path("M" + Math.floor(parseFloat(from.attr("cx")) * canvasX) + " "
        + Math.floor(parseFloat(from.attr("cy")) * canvasY) + "L"
        + Math.floor(parseFloat(to.attr("cx")) * canvasX) + " "
        + Math.floor(parseFloat(to.attr("cy")) * canvasY)); 
```

不用说，这不是很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T18:21:20.940

[SVG PathData 规范](http://www.w3.org/TR/SVG/paths.html#PathData)中没有表明允许这种语法。实际上，我有点惊讶它允许像圆心这样的东西......但我想你是对的。
但是，如果您执行缩放，则位置将不会保持固定，如您在此 jsfiddle 中所见：http: [//jsfiddle.net/PUg8r/](http://jsfiddle.net/PUg8r/)

# selenium - 通过 Selenium Grid 运行 Selenium IDE 测试

> ID：10359586
> 
> 赞同：3
> 
> 时间：2012-04-28T00:50:59.563
> 
> 标签：selenium, selenium-rc, selenium-ide, selenium-grid

我应该首先说我是一个令人遗憾和痛苦的**菜鸟**。但我正在努力改变这一点！！我不懂任何编程语言，但通过进行足够的研究以完成我曾经需要完成的任何工作，我设法“让事情发生”。

无论如何，我一直在使用 Selenium IDE 创建 Selenium 测试，但在通过 Selenium Grid 运行这些测试时遇到了一些麻烦。

我一直将测试导出为 JUnit 4 (Webdriver) 文件。我在 Ubuntu 无头服务器上运行网格，在一台运行 IE9 和 Firefox 的 Windows 7 机器和运行 IE8 和 Chrome 的 Windows Vista 机器上运行我的遥控器。

我的目标是将我从 Selenium IDE 导出的测试作为 JUnit 4 (Webdriver) 文件，并在我的两台 Windows 机器上从网格中并行运行它们。我已经在我的 Windows 机器上编辑了我的主机文件，以通过名称“seleniumgrid”识别 Ubuntu 服务器。例如：

**在Ubuntu服务器终端1：** ant launch-hub

**Win7终端1：** ant -Dport=5555 -Denvironment="IE9 on Windows" -Dhost=Win7 -DhubURL=http://seleniumgrid:4444 launch-remote-control

**Win7 终端 2：** ant -Dport=5555 -Denvironment="Firefox on Windows" -Dhost=Win7 -DhubURL=http://seleniumgrid:4444 launch-remote-control

**Vista termina1:** ant -Dport=5555 -Denvironment="IE8 on Windows" -Dhost=WinVista -DhubURL=http://seleniumgrid:4444 launch-remote-control

**Vista终端2：** ant -Dport=5555 -Denvironment="Chrome on Windows" -Dhost=WinVista -DhubURL=http://seleniumgrid:4444 launch-remote-control

现在，从这里开始，我尝试启动从 Selenium IDE 导出的 JUnit4 (webdriver) 文件以运行此配置。该文件的名称为：Registration.java。

我现在必须做什么才能运行 Registration.jar 文件？我似乎找不到任何可以回答这个问题的文档，这让我相信我对这一切是如何运作的有一个根本的误解......

如果这个问题之前已经回答过，请原谅。当谈到这些东西时，我的术语很糟糕。

非常感谢您花时间阅读本文，如果有答案，甚至更感谢您。

-布兰登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:41:27.013

无需通过 ant 启动 hub 和节点。您可以从 cmd 运行它们：

`java -jar selenium-server-standalone-2.21.0.jar -role hub`-- 将运行集线器
`java -jar selenium-server-standalone-2.21.0.jar -role node -hub http://seleniumgrid:4444/grid/register`-- 将运行节点

节点的默认端口是 5555，因此对于第二个终端，您应该指定与默认端口不同的端口，例如 5556：

`java -jar selenium-server-standalone-2.21.0.jar -role node -port 5556 -hub http://seleniumgrid:4444/grid/register`

您还应该为每个节点指定浏览器参数，例如：

`-browser browserName=firefox,maxInstances=5,platform=WINDOWS`

在您的 JUnit 测试中，您应该使用`RemoteWebDriver`with `DesiredCapabilities`：

```
DesiredCapabilities capability = DesiredCapabilities.firefox();
WebDriver driver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), capability); 
```

对于并行执行，您应该另外编辑您的测试（抱歉，不要使用 jUnit，所以除了您可以在下面找到的链接之外，这里无能为力。）

在 Linux 机器上的类路径中包含 JUnit 类文件、您的类文件，包括您的 JUnit 测试类、类文件所依赖的库：

```
export CLASSPATH=$JUNIT_HOME/junit.jar:/myproject/classes:/myproject/lib/something.jar 
```

在 Linux 机器上调用 Junit 命令：

```
 java org.junit.runner.JUnitCore [test class name] 
```

或者，您可以`ant`改用。

我将建议在 Linux 上使用 hub 开始，在 Windows 上使用一个浏览器的一个节点开始，无需任何并行化，因此您将确保这部分工作正常。作为下一步，依次运行两个节点的测试，然后尝试并行运行它们。

如需完整教程，请阅读以下材料：[如何使用 Ant 运行 JUnit](http://junit.sourceforge.net/doc/faq/faq.htm#running_5)、[从命令行激活 Junit 测试](http://www.jsystemtest.org/?q=node/44)、[Grid2 教程](http://code.google.com/p/selenium/wiki/Grid2)、[并行 JUnit 4 和 Selenium](http://saucelabs.com/blog/index.php/2010/10/parallel-junit-4-and-selenium-part-one-parameters/)（三部分）

# c++ - 条件表达式中的右值引用

> ID：10359590
> 
> 赞同：3
> 
> 时间：2012-04-28T00:51:23.160
> 
> 标签：c++, gcc, c++11, clang, decltype

```
typedef decltype(true ? (long&&)0 : (long&&)0) T; 
```

T 应该是什么？

根据 gcc (4.7)，它是`long`. 根据 clang（主干），它是`long&&`. 这种差异导致 clang 无法编译使用 gcc 4.7 的 libstdc++ 的代码。谁是对的？

**更新**：正如**ildjarn**指出的那样，Clang 是正确的，正如**Richard Smith**指出的那样，错误 libstdc++ 是由于标准中的错误造成的。这是[相关的 GCC 错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=53000)和[相关的缺陷报告](http://cplusplus.github.com/LWG/lwg-active.html#2141)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T01:29:37.460

叮当是对的。N3337 §7.1.6.2/4：

> 表示的类型`decltype(e)`定义如下：
> 
> *   if`e`是无括号的*id 表达式*或无括号的类成员访问，`decltype(e)`是由 命名的实体的类型`e`。如果没有这样的实体，或者如果`e`命名了一组重载函数，则程序是非良构的；
> *   **否则，如果`e`是一个 xvalue，`decltype(e)`是`T&&`，其中`T`的类型是`e`**;
> *   否则，如果`e`是左值，`decltype(e)`是`T&`，其中`T`的类型是`e`；
> *   否则，`decltype(e)`是 的类型`e`。
> 
> 说明符的操作数`decltype`是未计算的操作数。

§5/6：

> [*注意：*表达式是一个 xvalue，如果它是：
> 
> *   调用函数的结果，无论是隐式还是显式，其返回类型是对对象类型的右值引用，
> *   **转换为对对象类型的右值引用**，
> *   一个类成员访问表达式，指定一个非引用类型的非静态数据成员，其中对象表达式是一个 xvalue，或
> *   一个`.*`指向成员的表达式，其中第一个操作数是一个 xvalue，第二个操作数是一个指向数据成员的指针。
> 
> 一般来说，这条规则的效果是命名的右值引用被视为左值，而对对象的未命名的右值引用被视为xvalue；对函数的右值引用被视为左值，无论是否命名。——<em>尾注]

我之前很谨慎，文字`0`可能会以某种方式阻止它在这种情况下成为对象类型，但 §3.9/8 澄清了一些事情：

> *对象类型*是（可能是 cv 限定的）类型，它不是函数类型，不是引用类型，也不是 void 类型。

条件运算符不会影响此处的任何内容 – §5.16/4：

> 如果第二个和第三个操作数是相同值类别的glvalues并且具有相同类型，则结果是该类型和值类别，并且如果第二个或第三个操作数是位域，则它是位域，或者如果两者都是位域。

在这种情况下，两者都属于相同的值类别（xvalue），xvalues 是 glvalues。

# java - Cassandra 断言错误

> ID：10359592
> 
> 赞同：5
> 
> 时间：2012-04-28T00:51:58.323
> 
> 标签：java, cassandra, hector

我曾经在 Cassandra 中收到过 OOM 异常。我的是一个运行在功率适中的服务器上的单个实例，我正在做一些负载测试，所以这并不奇怪。

但是，我随后无法使用该实例。当我列出键空间时，只显示“系统”。但是当我尝试重新创建我正在测试的密钥空间时，Hector 以可怕的“所有主机池标记为已关闭。重试负担推给客户端”作为响应。消息，并且 Cassandra 日志具有以下堆栈跟踪：

```
ERROR [MigrationStage:1] 2012-04-27 20:47:00,863 AbstractCassandraDaemon.java (line 134) Exception in thread Thread[MigrationStage:1,5,main]
java.lang.AssertionError
    at org.apache.cassandra.db.DefsTable.updateKeyspace(DefsTable.java:441)
    at org.apache.cassandra.db.DefsTable.mergeKeyspaces(DefsTable.java:339)
    at org.apache.cassandra.db.DefsTable.mergeSchema(DefsTable.java:269)
    at org.apache.cassandra.service.MigrationManager$1.call(MigrationManager.java:214)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
ERROR [Thrift:9] 2012-04-27 20:47:00,864 CustomTThreadPoolServer.java (line 204) Error occurred during processing of message.
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.AssertionError
    at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:372)
    at org.apache.cassandra.service.MigrationManager.announce(MigrationManager.java:191)
    at org.apache.cassandra.service.MigrationManager.announceNewKeyspace(MigrationManager.java:129)
    at org.apache.cassandra.thrift.CassandraServer.system_add_keyspace(CassandraServer.java:987)
    at org.apache.cassandra.thrift.Cassandra$Processor$system_add_keyspace.getResult(Cassandra.java:3370)
    at org.apache.cassandra.thrift.Cassandra$Processor$system_add_keyspace.getResult(Cassandra.java:3358)
    at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
    at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
    at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:186)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.util.concurrent.ExecutionException: java.lang.AssertionError
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)
    at java.util.concurrent.FutureTask.get(FutureTask.java:83)
    at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:368)
    ... 11 more
Caused by: java.lang.AssertionError
    at org.apache.cassandra.db.DefsTable.updateKeyspace(DefsTable.java:441)
    at org.apache.cassandra.db.DefsTable.mergeKeyspaces(DefsTable.java:339)
    at org.apache.cassandra.db.DefsTable.mergeSchema(DefsTable.java:269)
    at org.apache.cassandra.service.MigrationManager$1.call(MigrationManager.java:214)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    ... 3 more 
```

旧的键空间仍在数据目录中，所以我移动了它，但这没有帮助。似乎系统数据在某处仍有无效引用。有谁知道如何解决这一问题？

编辑：来自 CLI，“描述集群”；仅描述“系统”键空间。但是当我“使用系统”时；然后“列出 schema_keyspaces；” 显示以下内容：

```
Using default limit of 100
-------------------
RowKey: mango
=> (column=durable_writes, value=true, timestamp=29127788177516974)
=> (column=name, value=mango, timestamp=29127788177516974)
=> (column=strategy_class, value=org.apache.cassandra.locator.SimpleStrategy, timestamp=29127788177516974)
=> (column=strategy_options, value={"replication_factor":"1"}, timestamp=29127788177516974)

1 Row Returned.
Elapsed time: 1107 msec(s). 
```

“芒果”是我无法再访问的键空间，但它在某种程度上仍然存在。有什么办法可以解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T14:48:01.390

问题几乎可以肯定是重新创建的密钥空间与提交日志或使用原始定义存储的数据不一致。关闭 Cassandra 服务器，清除 keyspace 对应的 commitlog、saved_caches 和 data 目录。这些目录的位置在 cassandra.yaml - 查找 data_file_directories、saved_caches_directory 和 commitlog_directory。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T15:14:53.723

此问题是由于不一致造成的，您可以执行以下步骤。

1）在您的情况下，可以清除“data”、“saved_caches”和“commitlog”目录，因为您没有任何关键数据和其他键空间。

2）在您有一些关键数据并且无法删除上述目录的情况下，请执行以下操作。

*   使用**nodetool drain**清空集群所有节点上的 commitlog。

*   然后从“/data/system”目录中删除所有**“LocationInfo*”**文件并重新启动集群。

# javascript - 压缩 Javascript/jQuery 代码

> ID：10359594
> 
> 赞同：0
> 
> 时间：2012-04-28T00:52:08.023
> 
> 标签：javascript, jquery

我想首先感谢任何可以帮助我压缩这段 Javascript/jQuery 代码的人。

```
 jQuery(function() {

            jQuery('#pitem-1').click(function(e) {
                jQuery("#image-1").lightbox_me({centered: true, onLoad: function() {
                    jQuery("#image-1").find("input:first").focus();
                }});

                e.preventDefault();
            });        

            jQuery('#pitem-2').click(function(e) {
                jQuery("#image-2").lightbox_me({centered: true, onLoad: function() {
                    jQuery("#image-2").find("input:first").focus();
                }});

                e.preventDefault();
            });

            jQuery('#pitem-3').click(function(e) {
                jQuery("#image-3").lightbox_me({centered: true, onLoad: function() {
                    jQuery("#image-3").find("input:first").focus();
                }});

                e.preventDefault();
            });

            jQuery('table tr:nth-child(even)').addClass('stripe');
        }); 
```

基本上每个#pitem-ID 在弹出窗口中打开相同的#image-ID。

再次感谢任何可以提供帮助的人。

杰克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:58:50.200

你的函数看起来都差不多，这是一个线索，你应该把这个功能移到可以调用的东西中：

```
function createHandler(id) {
    return function (e) {
        $(id).lightbox_me({centered: true, onLoad: function() {
            $(id).find("input:first").focus();
        }});

        e.preventDefault();
    }
}; 
```

然后你可以使用：

```
 $('#pitem-2').bind('click', createHandler("#image-2")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T01:22:02.453

你可以：

1.  使用公共事件处理程序将多个对象组合到选择器中
2.  用于`this`引用触发事件的对象
3.  从生成事件的对象的 id 派生图像 ID。

这使您可以使用一段代码来处理所有三个对象的操作：

```
jQuery(function() {
    jQuery("#pitem-1, #pitem-2, #pitem-3").click(function() {
        var image$ = $("#" + this.id.replace("pitem", "image"));
        image$.lighbox_me({centered: true, onLoad: function() {
                    image$.find("input:first").focus();
        }});
        e.preventDefault();
    });
    jQuery('table tr:nth-child(even)').addClass('stripe');
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T01:06:15.583

```
$('[id^="pitem-"]').click(function(e) {
    var numb = this.id.split('-')[1];
    $("#image-"+numb).lightbox_me({centered: true, onLoad: function() {
         $(this).find("input:first").focus();
    }
    });
    e.preventDefault();
});        

$('table tr:nth-child(even)').addClass('stripe'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T01:01:25.820

没有上下文就很难说，但是否有必要为每个 ID 设置一个唯一的 ID `pitem`？为什么不使用 CSS 类而不是像这样的 ID：

```
<div class="pitem">
<div id="image1"><img ... /></img>
</div>
...
<div class="pitem">
<div id="image3"><img ... /></img>
</div> 
```

然后使用 jQuery 中的类选择器一次性添加所有的点击功能：

```
$(".pitem").click(function(e) {
  var currentItem = e.target;
  ...
  e.preventDefault();
}); 
```

# javascript - Linkify 正在链接无效链接。为什么？有没有办法防止这种情况发生？

> ID：10359596
> 
> 赞同：0
> 
> 时间：2012-04-28T00:52:12.113
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用 Linkify：[https ://github.com/cowboy/javascript-linkify](https://github.com/cowboy/javascript-linkify)

问题是 Linkify 正在链接无效链接，例如：

**有效的**

```
http://techcrunch.com/ 
```

**无效的**

```
checkthisouthttp://techcrunch.com/ 
```

关于如何防止链接非链接的任何想法？鉴于 Linkify 已经过时了，还有什么更好的选择吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T06:25:05.850

Linkify [https://github.com/cowboy/javascript-linkify](https://github.com/cowboy/javascript-linkify)仅测试 URL 方案是否匹配`[a-z\\d.-]+://`。

哪个与您的两个示例匹配：`checkthisouthttp://techcrunch.com/`和`http://techcrunch.com/`.

通过将第 73行替换为仅匹配这些方案的正则表达式，将其更改为将 URL 方案限制为仅设置列表（例如，等）很`http`简单`https`。`SCHEME = "[a-z\\d.-]+://",``ba-linkify.js`

# image - 带有 Grails 资源插件的图像 URL

> ID：10359597
> 
> 赞同：2
> 
> 时间：2012-04-28T00:52:13.177
> 
> 标签：image, grails, grails-plugin, grails-2.0

我正在尝试在我的 Grails 2.0.3 应用程序中使用[elRTE小部件。](http://elrte.org/)

我已经把图片放在`web-app/images`

问题是有些图像显示，有些没有，我不知道为什么

例如：

```
<r:img uri="/images/smileys/evilgrin.png"/>
<r:img uri="/images/smileys/unhappy.png"/>
<img src="/block/static/images/smileys/evilgrin.png" />
<img src="/block/static/images/smileys/unhappy.png" /> 
```

`evilgrin.png``<r:img />`与标签或标签一起显示得很好`<img />`，但在同一目录中的 unhappy.png 却没有。

那个，`evilgrin.png`并没有出现，但在试图找出原因时，它突然出现了。再说一次，我不知道为什么。

elRTE 工具栏显示得很好，但带有要插入的笑脸的下拉菜单却没有，除了 evilgrin。

任何人都可以解释一下吗？

我在 Windows 7 上使用 SpringSource Tool Suite 2.9.1 (eclipse) 中的 Grails 2.0.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:29:15.313

这种行为可能是由于资源插件中当前使用的临时、遗留和未声明资源的一些混淆。1.2 版本（即将发布）将包含这些行为的进一步文档。

最安全的选择是在 ad-hoc 过滤器设置中声明 images 文件夹，例如：

```
grails.resources.adhoc.patterns = ["/images/*", "*.css", "*.js"] 
```

（这是默认设置）。

然后使用`<r:img>`标签访问图像。不要将`<img>`标签与上面给出的 src 一起使用。

您可以使用 curl 命令测试应用程序正在提供哪些实际 URI。第一次尝试访问像 /images/smiles/evilgrin.png 这样的 URI 应该会重定向到 /static/images/smilies/evilgrin.png。应该从后一个 URI 提供图像。

# python - Excel DisplayAlerts 的奇怪行为：“一个或多个无效引用”错误消息

> ID：10359604
> 
> 赞同：1
> 
> 时间：2012-04-28T00:53:52.090
> 
> 标签：python, excel, com, alerts

我有一个 Python 脚本，它使用 Excel 的 COM 接口使用来自各种来源的数据填充 Excel 文件。这是一个片段：

```
file=win32com.client.Dispatch("Excel.Application")
#various manipulation goes here
file.DisplayAlerts=False
sheet.Delete()
file.DisplayAlerts=True 
```

填充完所有内容后，我需要删除其中一张，因此我关闭了 DisplayAlerts，因此它不会要求我确认删除。之后我想再次打开它，这样用户就不会丢失数据。但是，在 DisplayAlerts 重新打开后，切换工作表会给我以下消息：“此工作表中的公式包含一个或多个无效引用。验证您的公式是否包含有效的路径、工作簿、范围名称和单元格引用”。我通常不会收到此消息，并且我的所有公式都按预期工作。我怎样才能避免该消息？

我很确定该消息与以下事实有关，即我的图表在其数据范围内有很多 #N/A 值（因此不会绘制点）。但是我能做些什么来摆脱这些消息，为什么它们会出现在这三行代码之后？此外，仅关闭并再次打开 DisplayAlerts 不会显示消息：删除在其中起作用。

另外，为什么该消息不只是告诉您它在哪里发现问题，是否有充分的理由？

该消息仅在第一次切换到工作表时出现，并在每次对图表范围进行编辑时返回。此外，如果我只是删除工作表而不关闭 DisplayAlerts，它也不会出现。

# java - 不支持 Android wifi p2p (wifidirect)

> ID：10359606
> 
> 赞同：0
> 
> 时间：2012-04-28T00:54:05.937
> 
> 标签：java, android, eclipse, p2p, wifi-direct

我正在使用在android中使用wifi进行p2p连接的协议（http://developer.android.com/reference/android/net/wifi/p2p/package-summary.html）

我在调用**discoverPeers()**函数时遇到问题：

ActionListener.onFailure(int reason) 被调用（它是触发某些事件的接口）并且我收到 reason=1，这意味着“P2P_UNSUPPORTED”。我添加了所需的所有权限和（使用... wifidirect）标签。

我正在使用虚拟设备和最新的 android sdk(4.0.3)，我在此设备上有互联网连接。

```
<uses-sdk android:minSdkVersion="15" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
<uses permission android:name="android.permission.INTERNET"/>
<uses-feature android:name="android.hardware.wifi.direct" android:required="true"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:11:46.663

据我所知，您无法在模拟器中运行演示，因为它不支持真正的 Wifi。您应该在支持 ICS 和 Wifi-Direct 的 Galaxy Nexus 等真实设备上启动演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-29T14:52:49.713

*facepalm*是的...我在模拟器上运行，而不是真正的交易...如果您使用实际上有 Wifi 的设备，效果很好...哈！

# linux - 如何在工作期间最小化目录更改的同时分离源代码和数据？

> ID：10359607
> 
> 赞同：0
> 
> 时间：2012-04-28T00:54:10.657
> 
> 标签：linux, shell, unix

这是关于在 Linux 上工作的一般软件工程问题。假设我有源代码，主要是脚本。他们操作文本数据，将文本文件作为输入和输出。我正在考虑如何适当地分离 src 代码和数据，同时最大限度地减少工作期间的目录更改。我看到两种可能性：

1.  将代码和数据混合在一起。通过这种方式，它最大限度地减少了目录转换并消除了在工作期间键入文件路径的需要。大多数时候我只是打电话：

    ```
    script1 data-in data-out # call script
    vi data-out # view result 
    ```

    问题是随着代码和数据文件数量的增长，面对一长串代码和数据文件看起来很混乱。

2.  将代码和数据分别放在两个文件夹中，比如“src”和“data”。当我在“src”文件夹中时，执行上述操作需要：

    ```
    script1 ../data/data-in ../data/data-out # call script
    vi ../data/data-out or cd data; vi data-out # view result 
    ```

    父目录“../data”的额外输入会造成麻烦，尤其是在对脚本进行大量快速测试时。

您可能会建议我在数据文件夹中以相反的方式执行此操作。但是同样我需要调用../src/script1，再次输入前缀“../src”的麻烦。是的，我们可以将“src”添加到 PATH。但是，如果跨父子目录的脚本之间存在依赖关系怎么办？例如，假设“src”下有“subsrc/script2”，而在script1中，它调用“./subsrc/script2 ...”？然后在“data”文件夹中调用script1会抛出错误，因为“data”文件夹下没有“subsrc”文件夹。

代码和数据的良好分离以及最小化目录更改似乎是相互矛盾的要求。你有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T03:17:11.823

我会使用`cd -`shell 的功能加上设置 PATH 来解决这个问题——可能需要一些脚本来提供帮助。

我会确保构建程序的源目录位于我的 PATH 前面。我会`cd`进入数据目录或源目录（可能会使用数据目录或源目录捕获`d=$PWD`目录`s=$PWD`），然后切换到另一个（并再次捕获目录名称）。现在我可以使用 to switch 在两个目录之间来回`cd -`切换。

根据我是处于“代码工作”还是“数据工作”模式，我主要在适当的目录中工作。我可能有一个简单的脚本，`(cd $source_directory; make "$@")`这样如果我需要构建一些东西，我可以通过运行脚本来实现。我可以使用 swift `cd -`plus`vim`或`vim $other_dir/whichever.ext`. 因为源目录在 PATH 上，所以我不必指定其中命令的完整路径。

我使用别名`alias r="fc -e -"`来重复命令。例如，要重复上一个`vim`命令，`r v`; 最后一个`make`命令，`r m`; 等等。

我一直在做这种事情。我使用的软件有大约 50 个目录用于完整构建，但我通常一次只在几个目录中工作。我有一组脚本可以根据我的工作位置重建系统（`chk.xyzlib`并`chk.pqrlib`在相应的目录集中构建，例如；每个库的两个目录）。我更喜欢脚本而不是别名；您可以使用脚本更轻松地插入参数，而使用别名，您只能附加参数。该`(cd $somewhere; make "$@")`表示法不适用于别名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T03:42:06.033

编码有点多，但是你可以从命令行设置环境变量来指定数据目录吗？

```
export DATA_INPUT_DIR=/path/to/data
export DATA_OUTPUT_DIR=/path/to/outfiles 
```

然后您的脚本可以处理与这些目录相关的文件：

```
# Set variables at the top of your scripts:
in_dir="${DATA_INPUT_DIR:-.}"   # Default to current directory
out_dir="${DATA_OUTPUT_DIR:-.}" # Defailt to current directory

# 1st arg is input file.  Prepend $DATA_INPUT_DIR unless path is absolute.
infile = "$1"
[ "${1::1}" == "/" ] || infile="$DATA_INPUT_DIR/$infile"

# 2nd arg is output file.  Prepend $DATA_OUTPUT_DIR unless path is absolute.
outfile = "$2"
[ "${2::1}" == "/" ] || outfile="$DATA_OUTPUT_DIR/$outfile"

# Remainder of the script uses $infile and $outfile. 
```

当然，您也可以打开几个终端窗口：一些用于处理代码，另一些用于执行代码。:-)

# c++ - 是否有预处理器或其他东西来控制视觉工作室包含的标题？

> ID：10359608
> 
> 赞同：0
> 
> 时间：2012-04-28T00:54:22.463
> 
> 标签：c++, visual-studio

例如 `<utility>`，即使您没有明确键入， Visual Studio 也包含**`#include <utility>`**

是否有预处理器指令或某些选项仅包含程序员**明确**告知的内容？

只是一个假设的例子：

```
#include <vector>

int main()
{
    std::vector<int> x;
    std::move(x); // Did I ask for <utility> ? No I didn't
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:16:08.723

`<utility>`除非其他包含的 std 标头需要，否则Visual Studio 不包含。

在 VS10 中，包括仅`<vector>`直接和间接地拉入另外 74 个标头。前往的路线`<utility>`是：

`<vector>`包括`<memory>`包括 包括`<xmemory>`包括 包括`<xutility>`包括`<utility>`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T01:12:22.907

显然，对于您的编译器，当您包含时`vector`，该标头还包含包含的内容`utility`。

Visual Studio 不会自动包含任何内容，因此这是您所描述内容的唯一解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T01:15:49.037

当您包含`<map>`时，它在内部使用`std::pair`，因此包含`<utility>`。我猜如果那是你唯一的东西，我`<vector>`也会使用一些东西。`<utility>``#include`

# c++ - 这些二维数组 (C++) 是否内存不足？

> ID：10359609
> 
> 赞同：0
> 
> 时间：2012-04-28T00:54:25.310
> 
> 标签：c++, memory, multidimensional-array, crash, stack-overflow

我尝试将此 C++ 代码作为 Windows 控制台应用程序运行，但是当它启动时，它会立即关闭，只给我一个标准的“该程序已停止工作”错误，这是 Windows 通常给我的。

该程序的主要功能是（后面省略了一些额外的代码）：

```
int main() {
    cout << "FIRST LINE";
    int fract[501][501];
    int rfract[501][501];
    int nufract[501][501];
    int nurfract[501][501];
    int snufract[501][501];
    int snurfract[501][501];
    system("PAUSE");
    return 0;
} 
```

有趣的是，如果我只有前 2 个数组，程序运行良好，但如果我有其他 4 个数组中的任何一个（甚至只是其中一个），程序在启动时就会崩溃。我正在使用一台具有 4 GB RAM 的计算机，但我没有收到任何有用的错误消息，尽管这似乎是问题所在。如果我将它们的大小全部更改为`[101][101]`（从 ~1.2 MB 到 ~50kB），问题就解决了，但我没有空间来输入函数。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T00:56:14.653

堆栈的大小远小于堆的大小。任何分配`new`或`malloc`进入堆的东西，但如果你不小心，你可以很快填满堆栈。

给定网站，你可能会得到一个包含这么多大数组的 Stack Overflow。

为此，请尝试以下代码：

```
#include <iostream>

int main(int argc, char* argv[])
{
int sarr2d[5][10];
typedef int dimension[10];
dimension* arr2d = new dimension[5];

for(int i = 0; i < 5; i++)
{
    for(int j = 0; j < 10; j++)
    {
        sarr2d[i][j] = i*j;
    }
}

for(int i = 0; i < 5; i++)
{
    for(int j = 0; j < 10; j++)
    {
        arr2d[i][j] = i*j;
    }
}

// print it out
for(int i = 0; i < 5; i++)
{
    for(int j = 0; j < 10; j++)
    {
        std::cout << arr2d[i][j] << " ";
    }
    std::cout << "\n";
}

delete [] arr2d;
return 0;
} 
```

[这是由问题C++ Multi-dimensional Arrays on the Heap](https://stackoverflow.com/questions/340943/c-multi-dimensional-arrays-on-the-heap)启发的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T11:52:56.720

堆栈大小通常限制在一个相当小的默认大小。如果您需要更大的堆栈，通常可以将其告知链接器（以系统特定的方式）。

在这种特殊情况下，您还可以选择在函数*外部*的静态内存空间中分配变量`main`。该空间通常比堆栈空间大得多。

```
int fract[501][501];
int rfract[501][501];
int nufract[501][501];
int nurfract[501][501];
int snufract[501][501];
int snurfract[501][501];

int main() {
    cout << "FIRST LINE";

    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T03:21:34.083

如果您真的想要堆栈中的项目，则可以使用 /F 开关（如果您使用的是 Microsoft 编译器），或者您可以在链接程序时指定堆栈的大小。我可能会选择 /F 开关。但是，这可能会占用堆空间（同时限制堆栈和堆）。

这是 MSDN 上有关增加堆栈大小的链接：

[http://social.msdn.microsoft.com/Forums/da-DK/Vsexpressvc/thread/2a5b32b6-683b-4729-92d3-45ed7a89ef3f](http://social.msdn.microsoft.com/Forums/da-DK/Vsexpressvc/thread/2a5b32b6-683b-4729-92d3-45ed7a89ef3f)

# python - 使用 SqlSoup 在 Postgres 中进行数据转换

> ID：10359617
> 
> 赞同：0
> 
> 时间：2012-04-28T00:57:29.113
> 
> 标签：python, postgresql, sqlsoup

我在 Postgres 数据库中有大量事件数据集，太大而无法在内存中分析。因此，我想将日期时间量化为定期间隔，并在返回结果之前在数据库中执行分组操作。我想我会使用 SqlSoup 来遍历相应表中的记录并进行必要的转换。不幸的是，我无法弄清楚如何以一种不会将每条记录的引用一次加载到内存中的方式执行迭代。是否有某种方法可以一次获取一个记录引用，以便访问数据并根据需要更新每条记录？

任何建议将不胜感激！

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:31:38.267

在与一些人交谈之后，很明显更好的答案是使用 Pig 在本地处理和聚合我的数据。在规模上，我正在操作它并不清楚 Hadoop 是否是合适的工具。一位与我交谈过的人表示，在我的操作规模约为 10^7 条记录时，Pig 将比数据库内操作快几个数量级。

# c# - 自动将类名推断为泛型的 T

> ID：10359619
> 
> 赞同：0
> 
> 时间：2012-04-28T00:57:40.840
> 
> 标签：c#, asp.net

```
public class TestClass1
{
    public void TestMethod1()
    {
        new Logger<TestClass1>().Log(LogType.Info, "FROM TESTCLASS1.TESTMETHOD1");
    }
} 
```

当实例化**Logger**并将**TestClass1**作为**泛型 T**传入时，如果开发人员键入了与 TestClass1 相对的其他内容，则可能会出现问题。例如，以下代码行可能是一个**问题**。

```
new Logger<Test123>().Log(LogType.Info, "FROM TESTCLASS1.TESTMETHOD1"); 
```

如何编写以下代码行，它会自动推断**TestClass1**并通过它？

```
new Logger<TestClass1>().Log(LogType.Info, "FROM TESTCLASS1.TESTMETHOD1"); 
```

我尝试了以下两行代码，但没有运气。

```
new Logger<this>().Log(LogType.Info, "FROM TESTCLASS1.TESTMETHOD1");
new Logger<this.GetType>().Log(LogType.Info, "FROM TESTCLASS1.TESTMETHOD1"); 
```

**更新** 在我的应用程序中，我可以传入任何类，例如 TestClass1、MyClass123 等，所以我可能无法设置任何通用约束。

请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T01:01:44.237

扩展方法怎么样：

```
public static Logger<T> GetLogger<T>(this T obj)
{
    return new Logger<T>();
} 
```

这样你就可以

```
this.GetLogger() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:02:16.740

泛型类型约束呢？ [http://msdn.microsoft.com/en-us/library/bb384067.aspx](http://msdn.microsoft.com/en-us/library/bb384067.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:05:07.513

这是建立私有财产的时候了。然后，你可以让你的开发人员做`this.Logger.Log(blah)`

```
private Logger Logger {
   get {
      return new Logger<TestClass1>();
   }
} 
```

# objective-c - NSButton：自定义视图中元素的操作

> ID：10359620
> 
> 赞同：0
> 
> 时间：2012-04-28T00:57:52.867
> 
> 标签：objective-c, xcode, cocoa, webview

抱歉标题复杂，但很难解释。

这是我的层次结构：

```
Custom View
    Custom View
        Push Button
    Box
WebView
WebView 
```

我的代码的工作方式是，“Box”对上面显示的 2 个 WebView 之一有一个“setContentView”。所以基本上 Box 可以随时拥有不同的 WebView。

我有一个按钮，我想将其分配给 WebView 上的“返回”。但我需要这个按钮来“返回”框内的 WebView。

因此，无论何时切换 WebView，Push Button 都应将自身链接到 Box 中的任何 WebView，并且反之亦然。

这甚至可能吗？

提前谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T03:19:26.153

如果您在按钮的操作方法所在的任何自定义视图中定义了框的 IBOutlet（称为 theBox），则可以在该操作方法中使用它：

[(WebView *)self.theBox.contentView goBack];

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T03:58:07.883

> 因此，无论何时切换 WebView，Push Button 都应将自身链接到 Box 中的任何 WebView，反之亦然。

为什么不使用更传统的安排？使视图控制器成为按钮的目标，并让视图控制器中的操作采取任何适当的操作。在这种情况下，那就是将适当的 Web 视图添加到框中。

视图通常对应用程序的工作方式一无所知。他们只是做控制器告诉他们做的事情。

# linux - 为什么 clang++ 的行为与 clang 不同，因为前者是后者的符号链接？

> ID：10359624
> 
> 赞同：10
> 
> 时间：2012-04-28T00:58:16.470
> 
> 标签：linux, macos, clang, symlink, clang++

我有一个尝试修改 const 字符串文字的 C 程序。现在我了解到这是不允许的。

当我用`clang test.c`编译器编译代码时没有警告。但是当我用`clang++ test.c`它编译它时会发出警告：

> test.c:6:15：警告：从字符串文字转换为 'char *' 已弃用 [-Wdeprecated-writable-strings] char *s = "hello world"; ^

问题是它`clang++`只是一个符号链接`clang`：

```
ll `which clang++`
lrwxr-xr-x  1 root  admin  5 Jan  1 12:34 /usr/bin/clang++@ -> clang 
```

所以我的问题是，鉴于它是 的符号链接，其`clang++`行为有何不同？`clang``clang`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-28T01:01:57.190

Clang 正在查看它`argv[0]`并根据它看到的内容改变它的行为。这是一个不常见且不鼓励但并不罕见的技巧，至少可以追溯到 4.2BSD`ex`和`vi`，它们是相同的可执行文件，并且可能更远。

在这种情况下，`clang`将您的`.c`文件编译为 C，并将`clang++`其编译为 C++。这是一个你不应该依赖的历史缺陷；使用适当的编译器命令*并*确保您的文件扩展名反映文件的真实内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T01:01:36.287

按照惯例，调用命令的名称被传递为`argv[0]`; 程序基于此改变其行为并不罕见。（从历史上看，`ln`,`cp`和`mv`是 Research Unix 上同一个可执行文件的硬链接，用于`argv[0]`决定执行哪个操作。此外，大多数 shell 会寻找一个引导`-`来`argv[0]`决定它们是否应该是登录 shell。）通常还有一些其他的获得相同效果的方法（选项、环境变量等）；您通常应该使用它而不是玩`argv[0]`游戏。

这样做是有原因的，但在大多数情况下，依赖它或围绕它设计程序并不是一个好主意。

# jquery - 在哪里放置事件选项以在初始化中编辑/删除/添加 form_editing

> ID：10359626
> 
> 赞同：0
> 
> 时间：2012-04-28T00:58:21.190
> 
> 标签：jquery, jqgrid

像标题.. 我应该在哪里放置事件选项以在初始化中编辑/删除/添加 form_editing？在哪个数组中？

我曾经像一些演示一样创建一些按钮，在初始化后分配/绑定它们。但现在我想使用他们的默认按钮。但是我在绑定对话框的事件时遇到了困难，例如“beforeSubmit/afterSubmit”等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T07:57:16.443

通常不直接调用[editGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#editgridrow)和[delGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#delgridrow)。而不是使用[navGrid](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3anavigator)在导航栏中添加按钮。该`navGrid`方法具有`click`事件处理程序，调用[editGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#editgridrow)或[delGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#delgridrow)（或其他）取决于用户单击的按钮。

因此，如果您`navGrid`也使用，则应使用`prmEdit`,`prmAdd`和`prmDel`参数来指定您的自定义回调函数，例如`beforeSubmit`/ `afterSubmit`：

```
$("#grid_id").jqGrid('navGrid', '#gridpager',
    {/*navGrid options*/},
    {/*edit options and callbacks*/},
    {/*add options and callbacks*/},
    {/*add options and callbacks*/}); 
```

# xpath - Web.Config 转换 xml 注释

> ID：10359632
> 
> 赞同：4
> 
> 时间：2012-04-28T00:58:56.937
> 
> 标签：xpath, web-config, transform, xdt-transform

如何使用 Web.config 转换选择评论或插入评论？

我在任何地方都找不到这方面的任何信息。

我正在尝试执行以下任一操作： 1)`<serviceAuthorization impersonateCallerForAllOperations="true"/>`在 Web.config 中的现有注释之前插入一段 xml ( )

或者

2）在一组兄弟的末尾插入注释和xml：

据我所知，Web.config 转换不支持 xPath 轴，我尝试了其中的一些来尝试在第一条评论之前插入一个节点：

```
<serviceAuthorization impersonateCallerForAllOperations="true" xdt:Transform="InsertBefore(/configuration/system.serviceModel/behaviors/serviceBehaviors/behavior[@name='behaviorOne']/serviceMetadata/preceding::comment()[1])"/>

<serviceAuthorization impersonateCallerForAllOperations="true" xdt:Transform="InsertBefore(/configuration/system.serviceModel/behaviors/serviceBehaviors/behavior[@name='behaviorOne']/child::node()[1]"/> 
```

我已经尝试了其他几个，但你明白了。预览转换时出现错误。

我似乎也找不到有关如何插入评论的任何信息。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T21:54:29.940

我相信转换仅限于对元素或属性进行操作。至少，关于 xdt:Transform 的[文档](http://msdn.microsoft.com/en-us/library/dd465326.aspx)都没有提到任何可用于添加评论的内容。

至于定位器，似乎对轴有*一些*支持，因为我能够使用以下内容：

```
<spring >
<objects xmlns="http://www.springframework.net">
  <object >
    <constructor-arg index="0" type="System.Uri" value="https://example.com/test" xdt:Locator="Condition(../@name='requestConfig' and @index='0')" xdt:Transform="SetAttributes(value)"/>
  </object>
</objects> 
```

在以下操作时：

```
<spring >
<objects xmlns="http://www.springframework.net">
    <object name="requestConfig" type="Example.Namespace.RequestConfig, Example" singleton ="true">
        <constructor-arg index="0" type="System.Uri" value="https://example.com/production"/>
        <constructor-arg index="1" value="45000"/>
    </object>
</objects> 
```

如您所见，上面使用父轴来匹配要转换的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-24T09:30:58.293

聚会晚了，但对于那些谷歌搜索，我发现了一些解决方法 - 如果您插入一个节点，它会在节点内插入任何评论，显然您需要先将其删除。IE：

> ```
>  <customErrors xdt:Transform="Remove" />
>   <customErrors mode="On" defaultRedirect="Hub/Error" xdt:Transform="Insert">
>       <!-- comment -->          
>   </customErrors> 
> ```

缺点是它会破坏子节点，但我尝试将评论尽可能低以减轻损害。

# image - 将图像导入 IntelliJ Java 项目

> ID：10359635
> 
> 赞同：6
> 
> 时间：2012-04-28T00:59:49.153
> 
> 标签：image, intellij-idea

我正在开发一个需要使用多个图像的 Java 项目。我在 ubuntu linux 上所以我的 src 目录中有一个 images 文件夹。到目前为止一切顺利，但尽我所能，我似乎找不到将图像文件加载或导入该图像文件夹的方法。（我希望能够简单地使用 loadImage("images/imageToLoad.png"); 之类的东西）

我试图只是拖放。我知道我当然可以离开程序并使用 linux 文件系统来传输图像，但这很痛苦并且违背了 IDE 的目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:03:36.250

您必须在 IntelliJ IDEA 之外的文件管理器中执行此操作。确保图像在应用程序类路径中可用检查`Settings`| `Compiler`| `Resource Patterns`,`.png`扩展名需要在那里列出。

# mysql - 为什么这个 MySQL 双变音功能不能正常工作？

> ID：10359637
> 
> 赞同：3
> 
> 时间：2012-04-28T01:00:06.940
> 
> 标签：mysql, database, algorithm, metaphone

我只是在学习 Metaphone 和 Double Metaphone 搜索算法，我有几个问题。根据 Metaphone Wiki 页面，我找到了几个实现的来源，特别是 MySQL 实现。我想用我的测试数据库对其进行测试，所以我首先导入了在[这里找到的 metaphone.sql 文件（包含双 metaphone 函数）](http://www.atomodo.com/code/double-metaphone/metaphone.sql/view)

现在，我有一个国家表，在“名称”列中有所有国家/地区的列表，例如“阿富汗”、“阿尔巴尼亚”、“阿尔及利亚”等。所以，首先，我想实际创建一个新的表中的列来存储每个国家的双变音字串。我运行了以下代码：

```
UPDATE country SET NameDM = dm(name) 
```

一切正常。阿富汗的变音位字符串是 'AFKNSTN'，阿尔巴尼亚的是 'ALPN'，阿尔及利亚的是 'ALKR;ALJR' 等等。“真棒，”我想。

但是，当我尝试查询该表时，我没有得到任何结果。根据 metaphone.sql 的作者，我遵循以下 SQL 语句的语法：

```
SELECT Name FROM tblPeople WHERE dm(Name) = dm(@search) 
```

因此，我将此代码更改为以下内容：

```
SELECT * FROM country WHERE dm(name) = dm(@search) 
```

当然，我将“@search”更改为我正在寻找的任何搜索词，但在每个 SQL 查询之后我得到 0 个结果。

谁能解释这个问题？我错过了一些重要的东西，还是我只是误解了 Metaphone 算法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-01T19:20:09.873

在比较`dm()`输出时，我使用以下函数来允许进一步的模糊性。`dm('smith') != dm('schmitt')`大量名称的直接检查失败，包括我自己的常见拼写错误。

该函数创建了一个介于 0.0 和 1.0 之间的匹配权重（我希望如此），这允许我对返回的每个行进行排名，并选择那些有好处的行，0.3 对于捕获奇怪的发音来说是一个很好的值，0.5 更常见。

IE `dmcompare(dm("boothroyd"), dm("boofreed")) = 0.3`
`dmcompare(dm("smith"), dm("scmitt")) = 0.5`

请注意，这是对**双变音位**字符串而**不是**原始**字符串**的比较，这是出于性能问题，我的数据库包含变位音位和原始字符串的列。

```
    创建函数`dmcompare`(leftValue VARCHAR(55), rightValue VARCHAR(55))
        返回小数（2,1）
    没有 SQL
    开始
    -------------------------------------------------- -------------------------------------
    -- 比较两个（双）变音位串的潜在相似性，即
    -- dm("smith") != dm("schmitt") :: "SM0;XMT" != "XMT;SMT"
    -- dmcompare(dm('smith'), dm('schmitt') 返回 0,5
    --@作者：P.Boothroyd
    --@版本：0.9，2013 年 8 月 1 日
    -- 这里的值还是可以玩的
    -- (c) GNU PL - 随意分享和改编，但请承认原始代码
    -------------------------------------------------- -------------------------------------
        DECLARE leftPri, leftSec, rightPri, rightSec VARCHAR(55) DEFAULT '';
        声明 sepPos INT；
        声明 retValue DECIMAL(2,1);
        声明 partMatch 布尔值；

        -- 提取变音位标签
        SET sepPos = LOCATE(";", leftValue);
        如果 sepPos = 0 那么
            SET sepPos = LENGTH(leftValue) + 1;
        万一;
        SET leftPri = LEFT(leftValue, sepPos - 1);
        SET leftSec = MID(leftValue, sepPos + 1, LENGTH(leftValue) - sepPos);

        SET sepPos = LOCATE(";", rightValue);
        如果 sepPos = 0 那么
            SET sepPos = LENGTH(rightValue) + 1;
        万一;
        SET rightPri = LEFT(rightValue, sepPos - 1);
        SET rightSec = MID(rightValue, sepPos + 1, LENGTH( rightValue ) - sepPos);

        -- 计算相似因子
        设置 retValue = 0;
        设置部分匹配 = 假；
        -- 初选等于 50% 匹配
        IF leftPri = rightPri THEN
            SET retValue = retValue + 0.5;
            设置部分匹配=真；
        别的
            IF SOUNDEX(leftPri) = SOUNDEX(rightPri) THEN
                SET retValue = retValue + 0.3;
                设置部分匹配=真；
            万一;
        万一;
        -- 测试备用主次，价值 30% 匹配
        IF leftSec = rightPri THEN
            SET retValue = retValue + 0.3;
            设置部分匹配=真；
            IF SOUNDEX(leftSec) = SOUNDEX(rightPri) THEN
                SET retValue = retValue + 0.2;
                设置部分匹配=真；
            万一;
        万一;
        -- 测试备用主次，价值 30% 匹配
        IF leftPri = rightSec THEN
            SET retValue = retValue + 0.3;
            设置部分匹配=真；
            IF SOUNDEX(leftPri) = SOUNDEX(rightSec) THEN
                SET retValue = retValue + 0.2;
                设置部分匹配=真；
            万一;
        万一;
        -- 次要值是否相同或都 NULL
        IF leftSec = rightSec THEN
            -- 没有二级...
            IF leftSec = '' 那么
                -- 如果有之前的匹配，那么没有二级是 40%
                如果 partMatch = TRUE 那么
                    SET retValue = retValue + 0.4;
                万一;
            别的
                -- 如果二级匹配，那么 50% 匹配
                SET retValue = retValue + 0.5;
            万一;
        别的
            IF SOUNDEX(leftSec) = SOUNDEX(rightSec) THEN
                IF leftSec = '' 那么
                    如果 partMatch = TRUE 那么
                        SET retValue = retValue + 0.3;
                    万一;
                万一;
            万一;
        万一;
        返回 (retValue);
    结尾

```

请随意使用该代码，但也*请提及此代码**P.Boothroyd**的任何用法的来源 - 即更改值等。*

干杯，保罗

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T04:38:07.480

仔细查看排序规则/字符集/编码（可以定义到列级别）。排序规则定义了如何比较字符串，但字符集可以暗示使用某种排序规则。也许您的文字字符串具有不同的字符集，导致字符串比较失败。

即使这也可能会揭示

```
select name, length(name), char_length(name), @search, length(@search), char_length(@search) from tbl 
```

.

```
show variables like 'character%' 
```

.

```
show create table tbl 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T01:40:18.383

```
SELECT * FROM country WHERE NameDM = dm(@search) 
```

最终可能是您想要的，因此您每次进行搜索时都不会为每个国家/地区计算 DM。你所拥有的东西看起来应该可以工作。您可以通过以下方式排除故障：

```
SELECT dm('Albania') 
```

...应该让您获得 ALPN。现在你得到什么...

```
SELECT * FROM country WHERE NameDM = 'ALPN' 
```

?

# qt - Qt 模型/视图编程设计模式是否受限？

> ID：10359638
> 
> 赞同：2
> 
> 时间：2012-04-28T01:00:13.227
> 
> 标签：qt, design-patterns, view, model

我正在阅读有关[模型/视图编程](http://qt-project.org/doc/qt-4.8/model-view-programming.html)设计模式的信息，但我不明白如何定义模型。我的模型应该继承自 QAbstractItemModel？如果是，我认为这是非常有限的，因为我的模型类不能从另一个模型类继承。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T06:37:43.913

C++ 具有多重继承，因此从技术上讲，您的模型*可以*从 Qt 模型基类和其他东西派生。
话虽如此，多重继承相当棘手（无论如何对我来说），组合更容易正确。

将 ORM 模型类与 Qt“合并”的一种方法是创建一个 Qt 模型类，其中包含一个（或多个）ORM 模型作为成员。Qt 模型本质上会将所有请求代理到您的 ORM 模型。Qt 模型只是一个“适配器”。这使您的 ORM 代码独立于 GUI 工具包，这通常很好。

确保您查看了Qt 方面的[模型子类化参考。](http://qt-project.org/doc/qt-4.8/model-view-programming.html#model-subclassing-reference)

# java - 我对这个 JUnit 测试用例感到困惑

> ID：10359648
> 
> 赞同：0
> 
> 时间：2012-04-28T01:01:17.753
> 
> 标签：java, junit

Java 编程新手，我只是想了解如何测试这个类。我做了一个队列类：

```
public class Queue<E> {

private ArrayList<E> items;

public Queue(){
    items = new ArrayList<E>();
}

public void join(E e) {
    items.add(e);
}

public E leave() throws EmptyQueueError {
    if (items.isEmpty()) {
        throw new EmptyQueueError();
    }
    return items.remove(0);

}

} 
```

我想创建一个名为 QueueTest 的 JUnit，在每个测试开始之前自动重置为空？然后我希望它检查从空队列中删除项目是否会引发 EmptyQueueError？最后，我希望它检查当几个项目加入（最初）空队列时，它是第一个加入的项目，哪个是第一个离开的？

这是我正在关注的教程，但它无法让我理解。我已经完成了上面的课程，并尝试了 JTest 课程：

```
package queue;

public class QueueTest<e> {

private Queue q;

@Before
public void setUp() throws Exception {
}

@After
public void tearDown() throws Exception {
}

@Test
public void test() {
    q = new Queue<e>();
    assertEquals("Empty Queue", 0, q);

}

} 
```

我接近我想要达到的目标吗？我正在尝试做第一个。

感谢您的帮助和充足的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:29:07.977

你做得很好。

```
@Test
public void test() {
    q = new Queue<e>();
    assertEquals("Empty Queue", 0, q);

} 
```

这样做的问题是您创建了一个新的 Queue 实例，但您没有对它做任何事情。

那么你的测试内容可能是

```
@Test
public void test() {
    Queue<Integer> q = new Queue<Integer>();      // A
    try {
        Integer ignore = q.leave();     // B
        fail("exception expected");               // C
    } catch (EmptyQueueError ex) {
        // implicit success                       // D
    }
} 
```

这意味着您将创建一个队列（'A'），然后立即尝试获取一个项目（'B'）。这应该会导致异常。如果没有，您的测试将因“预期异常”（'C'）而失败。如果抛出预期的异常，您的代码可以工作（'D'）

一旦你得到这个工作，我会发布更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:27:27.230

试试这个：他们为我跑。你不远了。

```
 package cruft;

    import java.util.ArrayList;

    public class Queue<E> {

        private ArrayList<E> items;

        public Queue(){
            items = new ArrayList<E>();
        }

        public void join(E e) {
            items.add(e);
        }

        public E leave() throws EmptyQueueError {
            if (items.isEmpty()) {
                throw new EmptyQueueError();
            }
            return items.remove(0);

        }

        // Note: I added this.
        public int size() { return this.items.size(); }
    }
} 
```

这是测试：

```
package cruft;

import org.junit.Assert;
import org.junit.Test;

public class QueueTest {
    @Test
    public void test() {
        Queue<String> q = new Queue<String>();
        Assert.assertEquals("queue should be empty", 0, q.size());

    }
} 
```

注意：您应该只在测试中创建一个实例。确保您的队列有一个具体类型的东西要保存（在这种情况下为字符串）。

记住泛型为你做了什么：它们让你创建一个集合或容器，其行为不依赖于它所持有的对象的类型。因此，您可能有一个包含字符串或人员或企鹅的队列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:56:58.550

那么你想在这里测试什么？当你做`assertEquals("Empty Queue", 0, q)`你试图在这里测试什么？队列是空的？

对于`asserts`他们通常采取的是测试的东西，IE Q == 0，他们采取一个可选的消息，如果测试失败将打印出来。

`assertEquals`通过调查价值是什么，您可以看到失败的原因`q`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T22:54:39.923

下面是使用[TestNG](http://testng.org)的方法，展示了如何测试异常以及如何在每个测试方法之前重置队列：

```
public class QueueTest {

  private Queue q = new Queue();

  @BeforeMethod
  public void setUp() throws Exception {
      q.reset();
  }

  @Test(expectedExceptions = EmptyQueueError.class)
  public void shouldThrowIfRemovingFromEmpty() {
    assertTrue(q.isEmpty());
    q.remove(0);
  }

} 
```

如果您想非常严格，您可能应该在两个单独的测试方法中测试每个队列最初是空的以及异常。

# php - 奇怪的 $_POST PHP 问题

> ID：10359652
> 
> 赞同：0
> 
> 时间：2012-04-28T01:01:39.483
> 
> 标签：php

恭喜我。我已经正式从 asp.net 切换到 PHP。

现在，我被困住了。:-)

我在一些代码片段网站上找到了一些代码，并且对以下部分有疑问。

```
if (isset($_POST['doRegCheck']))
    : if (intval($_POST['doRegCheck']) == 0 || empty($_POST['doRegCheck']))
    : redirect_to("index.php?do=users");
 endif;

endif; 
```

谁能告诉我这里到底发生了什么？此代码是否检查 doRegCheck POST 变量的值以确保它不为空？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:05:01.240

仅当 HTTP 标头包含一个名为的变量`doRegCheck`并且该变量设置为 0 ( `?doRegCheck=0`) 或无 ( `?doRegCheck=`) 时，代码才会重定向。这对我来说似乎倒退了。如果变量存在并且未设置为虚假值，我认为您会重定向`0,false,F`

该语法（冒号）通常在模板中使用（当您进入和退出 PHP 模式时），使其更难阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:07:10.437

首先，让我们正确地重新格式化它：

```
if (isset($_POST['doRegCheck'])) :
    if (intval($_POST['doRegCheck']) == 0 || empty($_POST['doRegCheck'])) :
        redirect_to("index.php?do=users");
    endif;
endif; 
```

然后，让我们去掉冗余。`empty`基本上包括检查`isset`. `empty`也将识别`"0"`为“空”。`empty`将任何*错误*值或不存在的值识别为“空”。此代码*可能会*尝试通过使用来检查该值是否为数字`intval`。总而言之，这应该更容易理解：

```
if (empty($_POST['doRegCheck']) || !is_numeric($_POST['doRegCheck'])) {
    redirect_to("index.php?do=users");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:08:31.617

是的，您的想法是正确的，如果设置了“doRegCheck”，但等于“0”或没有值“”，那么它会将您重定向到“index.php?do=users”。据我所知，它基本上是确保如果您在没有确认的情况下点击注册页面，它将无法完成注册过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T01:13:16.980

当前的形式使可读性更难，它应该是：

```
if (isset($_POST['doRegCheck'])):
     if (intval($_POST['doRegCheck']) == 0 || empty($_POST['doRegCheck'])):
     redirect_to("index.php?do=users");
     endif;
endif; 
```

翻译为：

```
if (isset($_POST['doRegCheck'])){
     if (intval($_POST['doRegCheck']) == 0 || empty($_POST['doRegCheck'])){
     redirect_to("index.php?do=users");
     }
} 
```

意义：

```
//is $_POST['doRegCheck'] set
if (isset($_POST['doRegCheck'])){
     //intval will return (int)0 even if its abc,
     // perhaps it should be is_numeric() as it will
     // pass if the value is 0 or the value is abc or empty
     if (intval($_POST['doRegCheck']) == 0 || empty($_POST['doRegCheck'])){
     //some user function to redirect
     redirect_to("index.php?do=users");
     }
} 
```

# google-app-engine - 在本地机器上开发 Google App Engine OAuth2 Java API 应用程序的最佳实践

> ID：10359653
> 
> 赞同：2
> 
> 时间：2012-04-28T01:01:43.120
> 
> 标签：google-app-engine, google-api, google-api-java-client, google-drive-api

我正在尝试在本地调试 Google App Engine 项目，并且该应用程序使用 Google 的 OAuth2 API 访问（Google Drive 访问）。我在我的 hosts 文件中将一个子域映射到 127.0.0.1 并确保该子域没有公开返回 404（Google 进行了基本测试以查看重定向位置是否有任何内容）并且重定向正确执行我本地机器上的 servlet。

问题是我现在似乎有一个匿名配额，并且很快超过了我当天的限制。有没有办法通过此设置将我链接到我的帐户以获得非匿名配额？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T23:44:35.307

需要在 Google APIs Console 中启用 Drive API 和 Drive SDK

# javascript - 我将如何移动带有元素的 SVG 模式

> ID：10359659
> 
> 赞同：6
> 
> 时间：2012-04-28T01:02:45.190
> 
> 标签：javascript, svg

我创建了这里看到的 svg 模式：

```
<pattern id="t" height="20" width="20" patternUnits="userSpaceOnUse" overflow="visible">
    <ellipse cx="0" cy="0" rx="20" ry="20" fill="white"/>
    <ellipse cx="5" cy="5" rx="15" ry="15" fill="yellow"/>
    <ellipse cx="10" cy="10" rx="10" ry="10" fill="blue"/>
    <ellipse cx="15" cy="15" rx="5" ry="5" fill="red"/>
</pattern> 
```

然后在我的脚本中，我创建了一个使用该模式的椭圆。问题是，当我移动椭圆时，图案仍然在它后面，而不是随着椭圆移动。

如何配置模式以与元素保持一致？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T08:26:35.050

您需要使用 patternContentUnits="objectBoundingBox" 点击本例中的矩形查看：http: [//jsfiddle.net/longsonr/x8nkz/](http://jsfiddle.net/longsonr/x8nkz/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T01:06:37.900

将 patternContentUnits 更改为“objectBoundingBox”（与 userSpaceOnUse 相比）。

更多：patternUnits 应该对模式的布局没有影响，只有它的尺寸（用户空间单元与边界框单元）。patternContentUnits 是您要设置为“objectBoundingBox”的属性 - 请注意，如果您更改边界框的大小，这将缩放您的模式。如果您不希望这种情况发生，那么您需要在您的模式上使用 viewbox 属性 - 这可能是获得您可能正在寻找的结果的正确方法（固定大小的模式，相对于其边界框定位）

（另请注意，根据规范将溢出设置为可见会导致“未定义”渲染 - 这不是您想要做的事情）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-11-28T15:52:44.227

[如何使 SVG 图像图案填充随对象移动](https://stackoverflow.com/questions/14407240/how-to-make-svg-image-pattern-fill-move-with-object)？

通过使用[嵌套的 SVG 文档解决](http://jsfiddle.net/59qtm1cn/4/)

```
// svg.js + svg.draggable.js

// create canvas
var draw = SVG().size(200, 200).addTo('#canvas')

// pattern of checkerboard
var patt = draw.pattern(20, 20)
patt.rect(20, 20).fill({color: '#fff'})
patt.rect(10, 10)
patt.rect(10, 10).move(10, 10)

// nested svg document
var nested = draw.nested()

// rect + pattern
nested.rect(80, 80).attr({
    fill: patt
})

// drag on
nested.draggable() 
```

# algorithm - 外部合并排序的时间复杂度/成本

> ID：10359661
> 
> 赞同：8
> 
> 时间：2012-04-28T01:03:03.257
> 
> 标签：algorithm, mergesort

我从一个讨论外部合并排序的[链接中得到这个。](http://www-inst.eecs.berkeley.edu/~cs186/sp03/section/mreview2.pdf)

从幻灯片 6 示例：使用 5 个缓冲页面，对 108 个页面文件进行排序

*   Pass0：[108/5] = 22 次排序运行，每次运行 5 页（最后一次运行只有 3 页）

*   Pass1 [22/4] = 6 次排序运行，每次运行 20 页（最后运行只有 8 页）

*   Pass2：[6/3] = 2 次排序运行，80 页和 28 页

*   Pass 3：[2/2] = 1 个 108 页的已排序文件

问题：我的理解是外部合并排序，在 pass 0 中创建块，然后对每个块进行排序。在剩余的通行证中，您不断合并它们。因此，将其应用于上面的示例，因为我们只有 5 个缓冲页面，在 Pass 0 中，我们需要 22 个排序运行，每个运行 5 个页面。

1.  现在，为什么我们要对剩余的通行证进行排序运行或合并？

2.  当我们只有 5 个缓冲页时，它为什么会告诉第 1、6 次排序运行，每次运行 20 页？

3.  合并到底发生在哪里？以及如何在每次通过时 N 减少，即从 108 到 22 到 6 到 2 ？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-28T01:38:12.740

当您无法将所有数据存储到内存中时，外部合并排序是必要的。您可以做的最好的事情是将数据分解为排序的运行，然后在后续传递中合并运行。运行的长度与可用的缓冲区大小相关。

**Pass0**：您正在原地执行操作。因此，您将 5 页数据加载到缓冲区中，然后使用就地排序算法对其进行就地排序。这 5 个页面将作为一个运行存储在一起。

**以下通行证**：由于您正在合并许多页面的运行，因此您无法再执行操作。4 个页面被加载到缓冲区中，第 5 个是写缓冲区。合并与合并排序算法相同，但您将分治系数 B-1 而不是 2。当写缓冲区被填满时，它被写入磁盘并开始下一页。

**复杂性**：在分析外部归并排序的复杂性时，要考虑 I/O 的数量。在每次传递中，您必须读取一页并写入该页。设 N 为页数。每次运行将花费 2N。读一页，写一页。
让 B 是您可以保存缓冲区空间的页数， N 是页数。
将有 ceil(log_B-1(ceil(N/B))) 通行证。每个通道将有 2N 个 I/O。所以 O(nlogn)。

在每遍中，运行的页面长度增加 B-1 倍，排序运行的数量减少 B-1 倍。
Pass0：ceil(108 / 5) = 22，每次运行 5 页
Pass1：ceil(22 / 4) = 6，每次运行 20 页
Pass2：ceil(6 / 4 ) = 2，每次运行 80 页
Pass3：ceil(2 / 4 ) = 1 - 完成，108 页的 1 次运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:19:25.133

A. 由于它从未提到合并，我假设（希望）后来的“排序”通道正在合并。

B. 同样，假设这是合并，您需要一个缓冲区来保存合并的记录，并为每个要合并的文件使用剩余的缓冲区之一：因此，4 个输入文件，每个 5 页：20 页。

C. 认为我已经回答了现在合并两次的地方:)

# zend-framework - zend 表单调度验证器 onblur 元素

> ID：10359662
> 
> 赞同：0
> 
> 时间：2012-04-28T01:03:03.817
> 
> 标签：zend-framework, zend-form, zend-validate

那可能吗？

我已经编写了一个简单的验证器，它在提交表单时触发。我可以使用相同的验证器，但它必须在输入字段离开后立即触发。

可能吗？巴勃罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T03:14:21.000

这是可能的，这是一种解决方法。

*   `onblur`向表单元素添加 Javascript事件
*   onblur 调用将包含该字段及其值的 ajax 请求发送到 ZF 操作
*   该操作调用该元素上的验证器，或用于`Zend_Form::isValidPartial`检查填充的元素
*   返回指示有效/无效和可选错误消息的 JSON 响应
*   在 ajax 完成时，读取 JSON 响应并更新 HTML 以反映验证结果

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T11:40:52.443

这是工作示例的一部分：

后端：

```
class UserController extends Zend_Controller_Action
{
    /* ... */
    public function validateAction()
    {
        if ($this->_request->isXmlHttpRequest()) {
            $values = $this->_request->getParam('values');
            $form = new Form_User();
            $isValid = true;

            if (!$form->isValidPartial($values)) {
                $isValid = $form->getMessages();
            }

            $this->_helper->json(array('errors' => $isValid));
        }
    }

    /* ... */
} 
```

前端，（只是 ajax 调用部分）应该附加在事件上：

```
$.ajax({
          type: "POST",
          url: "/user/validate/",
          data: {
            'values': $('#my-form-id').serialize()
          },
          dataType: "json",
          beforeSend:function(){

          },
          success: function(response){
            var result = response.errors;

            if (result == true) {
              // given fields are valid
              // do some extra stuff here
            } else {
              // invalid
              // do some extra stuff here
              }
            }
          }
        }); 
```

# objective-c - 将对象添加到 NsMutableArray 取决于选中的复选框数量

> ID：10359663
> 
> 赞同：0
> 
> 时间：2012-04-28T01:03:25.533
> 
> 标签：objective-c, ios, xcode, uibutton, nsmutablearray

我有一个联系人列表，他们的名字旁边有一个复选框。

[1 http://i.minus.com/jyLvkUt7wnxYs.png](http://i.minus.com/jyLvkUt7wnxYs.png)

我想在选中单元格文本时将其存储到数组中，当未选中时将其从数组中删除。我的代码只有在选择 1 时才能正常工作，但是当我选择多个复选框时，当我记录它时，它只给我 1 个值。下面是我的代码。

```
#import <UIKit/UIKit.h>
#import "AddressBookViewController.h"

@class AddressBookViewController;

@interface AddressBookCell : UITableViewCell {
IBOutlet UIButton *checkbox;
NSMutableArray *array;

}

@property (nonatomic, retain) IBOutlet UIButton *checkbox;
@end 
```

.m 文件

```
#import "AddressBookCell.h"

@implementation AddressBookCell
@synthesize checkbox;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
if (self) {
    self.checkbox = [UIButton buttonWithType:UIButtonTypeCustom];
    CGRect checkboxRect = CGRectMake(135, 150, 36, 36);
    [self.checkbox setFrame:checkboxRect];  
    [self.checkbox setImage:[UIImage imageNamed:@"unselected@2x.png"]forState:UIControlStateNormal];
    [self.checkbox setImage:[UIImage imageNamed:@"selected@2x.png"] forState:UIControlStateSelected];
    [self.checkbox addTarget:self action:@selector(checkboxClicked:) forControlEvents:UIControlEventTouchUpInside];
    self.accessoryView = self.checkbox;
    array = [[NSMutableArray alloc]init];

}
return self; 
```

}

```
-(void)checkboxClicked:(UIButton *)sender{
sender.selected = !sender.selected;
UITableViewCell *cell = (UITableViewCell *)sender.superview;
if(sender.selected){
    [array addObject:cell.textLabel.text];
}else{
    if([array containsObject:cell.textLabel.text]){
        [array removeObject:cell.textLabel.text];
        NSLog(@"it got removed");
    }
}
NSLog(@"%@",array);
}

-(void)dealloc{
[super dealloc];
} 
```

## 编辑

```
-(void)checkboxClicked:(UIButton *)sender{
sender.selected = !sender.selected;
UITableViewCell *cell = (AddressBookCell *)sender.superview;
if(sender.selected){
    [abController.savedPeople addObject:cell.textLabel.text];
}else{
    if([abController.savedPeople containsObject:cell]){
        [abController.savedPeople removeObject:cell];
    }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:13:00.913

您`NSMutableArray`被定义为表格单元格的一部分，这意味着每个单元格都有自己的数组，这就是为什么您在这个数组中永远不会有多个项目的原因。您需要将此数组声明为您的成员`UITableView`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:49:11.710

似乎您的应用程序每次都显示整个列表，然后使用选择执行任务。那正确吗？您选择/取消选择人员，然后将其存储并发送文本？那么你想保存之前的选择以供下次用户拉起联系人选择时使用吗？

在我看来，您应该使用 an`NSMutableSet`而不是数组来完成此任务。似乎顺序并不重要，而 Set 会更合适。我会为集合声明一个属性`@property (nonatomic, retain) NSMutableSet *contactList;`，然后`@synthesize contactList;`

然后，当您的用户点击“完成”或他们做出选择时点击的任何内容时，您将选定的选项存储在 NSSet 中。这个 NSSet 被复制到你的 NSMutableSet 中`[self.contactList setSet:myNonMutableSet];`。然后每次拉出列表时，您只需通过调用`self.contactList`最后一个状态来检查上次选择的内容。

# php - 如何正确地将数据库行加载到 php 中的类中

> ID：10359664
> 
> 赞同：0
> 
> 时间：2012-04-28T01:03:35.580
> 
> 标签：php, oop, kohana

我正在使用 Kohana 3.2，这并不重要，但我正在编写一个应用程序，其中我将所有返回的数据库记录包装在一个特定的类中。我不知道我是否了解将数据库行加载到类中的最佳方法，因为有时它是 ORM 模型，有时它可能只是一个行 ID。

因此，如果我想要一个所有用户的列表，它看起来像一个控制器：

控制器：

```
$users = User::find_all(); 
```

用户类

```
public static function find_all()
{
    $users_model = ORM::factory('user')->find_all();
    $users = array();
    foreach ($users_model as $user_model)
    {
        $users[] = User::instance($user_model);
    }
    return $users;
} 
```

这很好用，但有时我需要加载一个只有一个 id 的用户对象，比如在一些操作之后，再举一个例子：

控制器

```
$user_id = $_POST['user_id'];
$user = User::instance($user_id); 
```

负责尝试识别是否传递了 ID 或 ORM 对象的 User 类也是如此。这似乎不适合良好的 OOP 实践，但我真的不确定最好的方法是什么。我目前所做的是在构造中：

```
public function __construct($user, $load = 'model')
{
    if ($load == 'model')
    {
        $this->user_model = $user;
    }
    if ($load == 'id')
    {
        $this->user_model = ORM::factory('user', $user);
    }

} 
```

但这真的感觉不对。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T13:37:55.510

如果您已经有一个扩展 ORM 的用户模型，那么您可能不需要类中的静态方法来获取所有用户或获取特定用户。

在您的控制器中，您只需获取所有用户即可

```
$users = ORM::factory('user')->find_all(); 
```

获取单个用户

```
$user = ORM::factory('user', $user_id); 
```

如果你仍然想沿着包装路线走，你可以使用这样的功能

```
public static function all() {
    $users = ORM::factory('user')->find_all();
    if (count($users)) {
        return $users;
    }
    return false;
}

public static function get($user_id) {
    $user = ORM::factory('user', $user_id);
    if ($user->id) {
        return $user;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:23:37.760

在您的控制器中，使用 ORM 根据 ID 获取用户。

```
$user_id = $_POST['user_id'];
$user = ORM::factory('user', $user_id); 
```

或者假设您的用户类中已经有一个 find all，添加一个 find_one() 方法：

用户类

```
public static function find_one($user_id)
{
    $user = ORM::factory('user', $user_id);
    return $user;
} 
```

控制器

```
$user_id = $_POST['user_id'];
$user = User::find_one($user_id); 
```

请参阅 Kohana 文档。
[http://kohanaframework.org/3.1/guide/orm/using#finding-an-object](http://kohanaframework.org/3.1/guide/orm/using#finding-an-object)
[http://kohanaframework.org/3.1/guide/orm/examples/simple](http://kohanaframework.org/3.1/guide/orm/examples/simple)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T06:12:52.953

也许是这样的：

```
public function __construct($user)
{
    $this->user_model = is_object($user) ? $user : ORM::factory('user', (int)$user);
} 
```

# iphone - Xcode中的自定义运行脚本错误

> ID：10359668
> 
> 赞同：0
> 
> 时间：2012-04-28T01:04:27.440
> 
> 标签：iphone, xcode, bash, xcodebuild, xcode4.3

我正在尝试编写自定义脚本作为 Xcode 中的单独构建步骤。为此，我创建了运行脚本构建阶段。但是我在这个简单的行上收到一个错误（这就是我的脚本中的全部内容）：

```
INCLUDE_PATH = $CONFIGURATION_BUILD_DIR/include 
```

错误是

> ...Script-50117A74154B5E6100C6297E.sh：第 6 行：INCLUDE_PATH：找不到命令 命令 /bin/sh 失败，退出代码为 127

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:53:13.563

发现了！变量声明中不应有任何空格。

```
INCLUDE_PATH=$CONFIGURATION_BUILD_DIR/include 
```

# mysql - 如何抑制 DDL 日志

> ID：10359675
> 
> 赞同：0
> 
> 时间：2012-04-28T01:06:23.447
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord, rspec

我正在编写一个以“非标准”方式使用 MySQL 的应用程序，可以这么说。它严重依赖于动态创建/删除的表。

到目前为止，它运行正常。不过，这些规格并不让我高兴。每当我运行它们时，我都会收到大量 activerecord 的 ddl 日志消息。你自己看：

```
SqlDailyEvents
-- create_table("11_daily_events_20120428")
   -> 0.0032s
  should create and drop a table
-- create_table("11_daily_events_20120428")
   -> 0.0030s
  should not create the same table twice
  should not drop the same table twice 
```

那就是`--format d`。有了`--format p`它看起来更糟！

我该如何关闭它？该日志似乎不受`ActiveRecord::Base.logger`（我尝试设置为`nil`）的影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:36:09.393

（*用操作的内核方法删除了代码`$stdout`*）

毕竟是 ActiveRecord。似乎如果您以“新”方式定义迁移（使用`change`方法而不是`up`/`down`对），它不会向您发送太多垃圾邮件。无论如何，它有一个类似的方法，但它操纵了 Migration 的冗长，而不是`$stdout`.

现在我的代码如下所示：

```
 def up
    # built-in method. sets verbose flag to false
    suppress_messages do
      create_table table_name do |t|
        t.column :username, :string
      end
    end
  end 
```

# windows - 无法在 XP SP3 上安装 Powershell 2.0

> ID：10359679
> 
> 赞同：0
> 
> 时间：2012-04-28T01:06:59.430
> 
> 标签：windows, powershell, scripting, wmi

我正在尝试在我的机器上安装了 .Net Framework 4.0 的 winxp SP3 上安装 powershell 2.0，但我无法安装它。它要求.Net 2.0。这对我来说毫无意义，因为我有这样的框架的升级版本。这是完整的消息：

“无法安装 windows powershell v2，因为它需要 .Net 框架的更新版本。请安装 .Net 框架 2.0。”

任何人都可以在这里伸出援手吗？肿瘤坏死因子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T05:11:29.913

您需要安装 2.0。4.0 是 .NET CLR 的并行版本。这不是就地升级，所以特别需要 2.0 的东西不会接受 4.0。令人困惑的是，.NET 3.5 SP1 是 2.0 的最新版本，是您想要的。

3.0、3.5 和 4.5** 不是 CLR（.NET 的 JRE）的新版本，更像是 CLR2 和 CLR4 的库/服务包。

** 好吧，实际上 4.5 比那有点混乱，但比较就足够了。

# java - Java swing 中的 KeyListener 没有响应

> ID：10359683
> 
> 赞同：3
> 
> 时间：2012-04-28T01:08:22.557
> 
> 标签：java, swing, keylistener

我正在制作游戏，并且我有一个完美运行的主菜单。当我选择其中一个选项时，它会在新窗口中显示另一个菜单。但是在这个新窗口中，KeyListener 没有响应。如果我单击返回主菜单窗口，KeyListener 仍在那里工作。这是代码：

主菜单：

```
import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import javax.swing.*;
import java.io.*;
import javax.imageio.*;

public class DisplayMainMenu extends JFrame implements KeyListener{

  static int width = 799, height = 463;
  int arrowPos = 310;
  boolean clear = true;
  BufferedImage menu = null;
  BufferedImage arrow = null;
  LevelSkip test = new LevelSkip();
  boolean done = false;
  static DisplayMainMenu main;

  public static void main(String[] args){
    main = new DisplayMainMenu();
    main.setResizable(false);
    main.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    main.setVisible(true);
    main.init();
  }

  public void init() {
    try{
      menu = ImageIO.read(new File("Main Menu.png"));
      arrow = ImageIO.read(new File("arrow.png"));
    }catch(IOException ie) {
      System.out.println(ie.getMessage());
    }
    this.setSize(width, height);
    this.addKeyListener(this);
    clear = true;
    paint(getGraphics());
  }

  public void paint (Graphics g){
    if(clear==true){
      g.drawImage(menu,0,0,null);
      clear = false;
    }
    g.drawImage(arrow,275,arrowPos,null);
  }
  public void keyPressed(KeyEvent e){
    String key = e.getKeyText(e.getKeyCode());
    if(key == "Up"){
      clear = true;
      if (arrowPos > 310)
        arrowPos -= 30;
      else
        arrowPos = 370;
      paint(getGraphics());
    }
    if(key == "Down"){
      clear = true;
      if (arrowPos < 370)
        arrowPos += 30;
      else
        arrowPos = 310;
      paint(getGraphics());
    }
    if(key == "Space"){
      done = true;
      switch(arrowPos){
        case 310:  System.out.println("RUN NEW GAME"); test.init();
          break;
        case 340:  System.out.println("RUN HIGH SCORES");
          break;
        case 370:  System.exit(0);
      }
    }
  }
  public void keyReleased(KeyEvent e) {}
  public void keyTyped(KeyEvent e) {}
} 
```

级别跳过：

```
import java.awt.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import javax.swing.*;
import java.io.*;
import javax.imageio.*;

public class LevelSkip extends JFrame implements KeyListener {

  static int width = 799, height = 463;
  int arrowPos = 109;
  boolean clear = true;
  BufferedImage menu = null;
  BufferedImage arrow = null;

  public void init() {
    LevelSkip main = new LevelSkip();
    main.setSize(width, height);
    main.requestFocusInWindow();
    main.addKeyListener(main);
    main.setResizable(false);
    main.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    main.setVisible(true);
    try{
      menu = ImageIO.read(new File("level skip.png"));
      arrow = ImageIO.read(new File("arrow2.png"));
    }catch(IOException ie) {
      System.out.println(ie.getMessage());
    }
    clear = true;
    paint(main.getGraphics());
  }

  public void paint (Graphics g){
    if(clear==true){
      g.drawImage(menu,0,0,null);
      clear = false;
    }
    g.drawImage(arrow,arrowPos,355,null);
  }
  public void keyPressed(KeyEvent e){
    String key = e.getKeyText(e.getKeyCode());
    if(key == "Left"){
      clear = true;
      if (arrowPos > 109)
        arrowPos -= 260;
      else
        arrowPos = 629;
      paint(getGraphics());
    }
    if(key == "Right"){
      clear = true;
      if (arrowPos < 629)
        arrowPos += 260;
      else
        arrowPos = 109;
      paint(getGraphics());
    }
    if(key == "Space"){
      switch(arrowPos){
        case 109:  System.out.println("ADD 1 TO LEVEL AND RUN BATTLE");
        break;
        case 369:  System.out.println("ADD 5 TO LEVEL AND RUN BATTLE");
        break;
        case 629:  System.out.println("ADD 10 TO LEVEL AND RUN BATTLE");
      }
    }
  }
  public void keyReleased(KeyEvent e) {}
  public void keyTyped(KeyEvent e) {}

} 
```

我不确定问题出在哪里，Level Skip 窗口显示正常，只是没有注册任何按键。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T01:13:44.633

如果你完全搜索过这个问题，你会发现它几乎总是意味着被监听的组件没有焦点。90% 的解决方案是使用[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。

您的另一个问题是您正在比较 Strings `==`。你不想这样做。请改用 equals 或 equalsIgnoreCase(...) 方法。了解 == 检查两个*对象*是否相同，这不是您感兴趣的。另一方面，这些方法检查两个字符串是否具有相同顺序的相同字符，这在这里很重要。所以而不是

```
if (fu == "bar") {
  // do something
} 
```

做，

```
if (fu.equals("bar")) {
  // do something
} 
```

或者，

```
if (fu.equalsIgnoreCase("bar")) {
  // do something
} 
```

你也是

*   直接打电话`paint(...)`，这是你几乎不应该做的事情。
*   使用顶级窗口的`paint(...)`方法进行绘制，您也应该避免使用 JPanel（或其他 JComponent）`paintComponent(...)`方法进行绘制。
*   在方法开始时不调用paint或paintComponent的超级方法
*   将程序逻辑放在paint 或paintComponent 方法中。
*   ETC...

在进一步向专业人士学习之前，您需要先阅读 Swing 教程。

# javascript - 使用 jquery 将 div 设置为页面顶部的动画，但它在 Chrome 中闪烁

> ID：10359685
> 
> 赞同：0
> 
> 时间：2012-04-28T01:08:29.233
> 
> 标签：javascript, jquery, html, css, google-chrome

我正在使用 jquery 将 div 设置为页面顶部的动画，但由于某种原因，在 chrome 中查看它时它会闪烁非常糟糕。这是我的意思的一个过于简化的版本。有什么办法可以避免这种闪烁？

[http://jsfiddle.net/WzhY9/](http://jsfiddle.net/WzhY9/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-17T18:59:29.577

我运行了您提供的示例，它对我来说没有闪烁，但是作为建议，您可以在 load_bar 元素上强制硬件加速。

```
#load_bar { 
    height:10px; 
    position:absolute;
    background:black; 
    right: 0; 
    top: 400px; 
    width: 300px;

    /* Force hardware acceleration */
    -webkit-transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;
    -webkit-perspective: 1000;

} 
```

请注意，这仅适用于 webkit 浏览器（因为 -webkit- 前缀），您可以添加其他浏览器以支持其他浏览器。

我希望这有帮助。

# domain-driven-design - 只是我，还是领域驱动设计在大型企业架构中分崩离析？

> ID：10359689
> 
> 赞同：1
> 
> 时间：2012-04-28T01:09:23.600
> 
> 标签：domain-driven-design

我很确定我了解领域驱动设计，如果您有一只狗并且它需要吠叫，请在狗身上使用吠叫方法。如果狗的状态需要持久化，那就是存储库的工作。我知道还有更多，但我们现在就继续吧。

我看到企业系统中的事情从业务流程到允许流程完成的功能。我见过需要一个完整日历年才能完成的业务流程，并且该流程的状态在业务流程管理系统 (BPMS) 中进行维护。

因此，BPMS 根据预定时间全年执行功能。其中一些功能在其他业务流程中被重用。参与 DDD 的候选对象（我们不起眼的狗）不知道该过程是什么，它们只需要在给定来自该过程的输入时吠叫。当我们要求狗只需要吠叫时，DDD 如何帮助解决这个问题，给定过程的某些输入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T08:30:24.833

不是真正的答案，只是一些注释：

> 如果您有一只狗并且它需要吠叫，请在狗身上使用吠叫方法

这是过于简单化了。代码中的对象不应该试图模仿现实世界，就好像我们的二进制狗真的可以跳出监视器并开始吠叫一样。在软件世界中，[正方形不是矩形](http://cafe.elharo.com/programming/a-square-is-not-a-rectangle/)。您更有可能对狗吠的事实感兴趣，关于狗吠率随时间的变化。

突然之间，我们谈论的是吠叫的历史记录，关于医疗状态的描述——关于信息，而不是人造的想要成为现实生活的对象。

# linux - 在 Linux 中使用 Qt 应用程序抓取键盘

> ID：10359690
> 
> 赞同：6
> 
> 时间：2012-04-28T01:09:32.800
> 
> 标签：linux, qt, xorg

我正在尝试获取远程桌面类型客户端的所有键盘事件。我不希望 ALT-Tab 之类的东西被 Gnome3/KDE/Openbox/etc... 桌面捕获，我希望我的应用程序获取所有这些事件，而其他应用程序不获取事件。

我目前正在做这样的事情：

```
grabKeyboard() // qt function
Display *display = XOpenDisplay(NULL);
XGrabKeyboard(display, winId(), True, GrabModeAsync, GrabModeAsync, CurrentTime); 
```

这实际上似乎与 ALT-Tab 一起工作正常，但在 Openbox 中有一堆键盘快捷键定义为“显示桌面”（ALT-CTRL-END）和“重置 X”（CTRL-ALT-R）被抓住了由开箱。我注意到 FreeRDP 做了这样的事情：

```
int input_mask =
            KeyPressMask | KeyReleaseMask | ButtonPressMask | ButtonReleaseMask |
            VisibilityChangeMask | FocusChangeMask | StructureNotifyMask |
            PointerMotionMask | ExposureMask | PropertyChangeMask;
XSelectInput(display, winId(), input_mask); 
```

除了上面的代码之外，我已经尝试过了，但它不起作用。

我还注意到 Remmina 使用 gdk_device_grab 但由于我的应用程序不是 GTK 应用程序，因此我不能调用它。任何人都可以帮忙吗？

# python - 在子图中使用 view_init 设置 3d 视角

> ID：10359691
> 
> 赞同：6
> 
> 时间：2012-04-28T01:10:08.610
> 
> 标签：python, matplotlib

我正在尝试更改我的图形的一个子图中的角度，这是一个 3d 图。我愿意：

```
import matplotlib.pyplot as plt
f1 = plt.figure()
ax1 = f1.add_subplot(2, 1, 1, projection='3d')
ax1.view_init(20, -120) 
```

但这并没有改变看法。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-02-22T11:56:56.693

添加后

```
from mpl_toolkits.mplot3d import Axes3D 
```

对于您的导入，您的代码应该可以正常工作。这是我使用的完整代码：

```
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
f1 = plt.figure()
ax1 = f1.add_subplot(2, 1, 1, projection=Axes3D.name)
ax1.view_init(20, -120)
plt.show() 
```

由此可见：

[![图1](../Images/cf80d79be9e0851ed844103bf931163e.png)](https://i.stack.imgur.com/HMBWr.png)

并将其与另一个视图进行比较，`ax1.view_init(-120, 20)`例如，它显示：

[![图 2](../Images/f5f4c6b80c8a03f70e0bae6f8703195c.png)](https://i.stack.imgur.com/kkJKP.png)

顺便说一句，linter 可能会抱怨 "unused import" `Axes3D`，所以`projection='3d'`我没有`projection=Axes3D.name`在上面的代码中编写。请参阅[如何在标准绘图中直接使用 matplotlib 中的 Axes3D 以避免 flake8 错误](https://stackoverflow.com/questions/42962613/how-to-directly-use-axes3d-from-matplotlib-in-standard-plot-to-avoid-flake8-erro)以供进一步阅读。

# c# - C# 程序中数据库的良好替代品

> ID：10359694
> 
> 赞同：3
> 
> 时间：2012-04-28T01:10:36.707
> 
> 标签：c#, sql, xml, database

我必须为我的工作制作一个小程序，我的职位实际上与 IT 无关，我正在为我们的个人专业用途制作这个。我已经在 Access 中成功了，它工作正常，但我个人不喜欢它。

这真的很简单，有一个包含大约 10 列的不同地点的列表（大约 300 个）。

这是在一个DataGridView中，当我们选择某个地方时，我们可以打印到那个地方的访问报告。

问题：我想用 C# 来做，所以我想使用一个简单的 Access 数据库，但我得到一个“OLEDB 数据库驱动程序不在系统中”或类似的东西。

我们在受限的 WIZE 客户端上工作，在 Windows 配置中无法更改任何内容。所以我一直在为我的数据库寻找替代方案。我可以使用简单的 XML 文件并将其存储在那里，还是有任何更简单的替代方法可以让我发出类似 SQL 的请求并在数据库中插入/删除/更新？

对不起我的英语，它不是我的主要语言:)

编辑：谢谢大家的帮助，非常感谢。我将研究 SQLite。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:19:40.847

您有几个轻量级 SQL/NOSQL 选项，可以在安装权限有限的机器上与 C# 一起使用：

*   [SQLlite](http://www.sqlite.org/index.html)
*   [乌鸦数据库](http://ravendb.net/)
*   [SQL Server 精简版](http://msdn.microsoft.com/en-us/data/ff687142)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T01:20:38.230

如果你真的需要一个带有 SQL 风格查询的数据库，那么我建议你看看 SQLite。

> “SQLite 是一个实现自包含、无服务器、零配置、事务性 SQL 数据库引擎的软件库。”

设置和开始工作应该非常简单，您可能不需要安装任何东西。您可以从这里获得一个 ADO.NET 适配器：

[http://system.data.sqlite.org](http://system.data.sqlite.org)

或者，您可以将信息存储在某种文件中，例如 XML 文件或 CSV 文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-28T01:21:10.657

查看 SQL Server Compact。对于解决方案部署，您不需要任何系统更改或配置。所有这些都与您的解决方案 DLL 一起提供。数据转换示例、可能出现的问题及解决方案：[SQL Server Compact 4.0 和 Entity Framework](http://kitsula.com/Article/ASP-.NET-SQL-Server-Compact-4.0-and-Entity-Framework)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-28T01:18:09.520

我不知道这些对于您的情况是否足够简单，或者您是否具有安装它们的必要访问权限，但这里有一些免费数据库。再说一次，你说你不在 IT 部门，所以设置这些可能比你想要的更进一步......

*   [Oracle 数据库快捷版 11g](http://www.oracle.com/technetwork/products/express-edition/downloads/index.html)
*   [MySQL](http://dev.mysql.com/downloads/)
*   [SQL Server 2012 速成版](http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-28T01:28:21.703

如果您的应用程序非常简单，您可以使用 sqlite-net 作为简单的对象关系映射层来管理您的对象/表，

[https://github.com/praeclarum/sqlite-net](https://github.com/praeclarum/sqlite-net)

然后连接到 C#-SQLite，

[http://code.google.com/p/csharp-sqlite/](http://code.google.com/p/csharp-sqlite/)

使用它们，您的应用程序可以“便携”（无需安装到 Windows 系统）。只需将二进制文件复制到安装了 .NET 的机器上，它就可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-28T04:57:08.787

我不想这么说，但其中一种免费的 CMS 解决方案最适合您。为您处理的 UI 和数据库。将 wordpress 视为 Intranet，我确信您的业务需要是什么。可能有一个完美的插件。这似乎是一个简单的项目，无需重新发明轮子，记住您最终可能不得不支持您的应用程序。

# c++ - 如何使用 program.exe < text.txt 使用 c++ 读取输入

> ID：10359695
> 
> 赞同：0
> 
> 时间：2012-04-28T01:10:52.913
> 
> 标签：c++, file, iostream, cin

我必须根据这些规则读取输入：

> “输入由多行文本组成。有些行可能是空的。输入可以从文件中提供，使用一行，例如`prog.exe < input.txt`在这种情况下，操作系统会适当地指示输入的结尾。如果您输入输入使用键盘，通常有一种方法可以用一些控制键来表示输入结束，这取决于操作系统（例如，`Ctrl+d`在 Unix/Linux 风格的系统中，以及`Ctrl+z`在 Microsoft 系统中）。”

以前我一直这样做

```
while(getline(cin, data)) {
     if(data == "0") break;
     / * do stuff */
} 
```

所以我可以读取任意多的行并进行计算，然后当我完成后只需键入 0 并结束我的程序。我尝试在 .txt 文件中每行输入一个内容列表，然后调用`program.exe < myfile.txt`但没有任何反应。

这是`< file.txt`在做什么？

像这样调用我的程序时，如何正确处理其中的内容？

`ctrl`当你点击+时，我怎样才能让它计算东西`z`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:24:12.923

解释你的练习文本：

使用`command1 < file1`executes `command1`, with`file1`作为*输入源*（与键盘相反）。

这称为*重定向标准输入。*

`std::cin`将从键盘而不是键盘获取输入`file1`。

输入文件的结尾类似于`CTRL`+ `Z`（在 Microsoft 系统上，在大多数其他系统上是 +）`CTRL`。`D`一旦[**`std::getline()`**](http://en.cppreference.com/w/cpp/string/basic_string/getline)到达文件末尾（或者你读到一行只有“0”），你将退出你的`while`-loop，然后你可以对`data`你收集的（并且可能存储在某个容器中）进行计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:20:51.400

因为这听起来像家庭作业...

提示 1：`>`, `<`, `<<`,`>>`是 shell 的“输入/输出重定向”（Windows 上的 CMD）。

提示 2：getline 返回结果（RTFM 即[http://linux.die.net/man/3/getline](http://linux.die.net/man/3/getline)，如果您使用 C 版本或 C++ [http://www.cplusplus.com/reference/string/getline/](http://www.cplusplus.com/reference/string/getline/)和对应的 istream 方法）

# css - 将标签和输入移动到与前一个相同的行

> ID：10359701
> 
> 赞同：0
> 
> 时间：2012-04-28T01:12:01.143
> 
> 标签：css

如何让第二个标签和输入与第一个标签在同一行，同时保留第一个标签的宽度和顶部填充？

下面或这里的代码是 jsfiddle 版本[http://jsfiddle.net/kpBNB/2](http://jsfiddle.net/kpBNB/2)

```
<div>
  <li id="input1">
    <label>From</label>
    <select>
      <option value="1">1 am</option>
    </select>
  </li>

  <li id="input2">
    <label> until</label>
    <select>
      <option value="1">1 am</option>
    </select>
  </li>
</div> 
```

* * *

```
div {
  width: 100%;
   background-color: #ccc;
}

li {
  padding-top: 6px;
}

label {
  width: 15%;
  float: left;
  display: block;
  text-align: right;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:17:13.910

首先，你`<div>`应该是一个`<ul>`（你不能在or`<li>`之外有松散的元素）。`<ul>``<ol>`

然后，给予`display: inline-block;`你`li`的 CSS 应该可以解决问题。

**编辑**：嘿，你的 jsfiddle 已经做到了，而且它有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:55:50.817

要获得宽度，`label`您必须向其中添加宽​​度`li`（因为宽度由父元素确定）。所以像这样（[见小提琴](http://jsfiddle.net/kpBNB/9/)）：

```
ul {
  width: 100%;
  background-color: #ccc;
}

li {
  width: 30%;   /*this needs width*/
  padding-top: 6px;
  display: inline-block;
}

label {
  width: 50%; /* since my li was 30% width of ul, 
                 50% of that is back to your original 15% width */
  float: left;
  display: block;
  text-align: right;
} 
```

# c++ - C++ 文件处理：ios::app 和 ios::ate 之间的区别？

> ID：10359702
> 
> 赞同：78
> 
> 时间：2012-04-28T01:12:05.987
> 
> 标签：c++, file, fstream, c++-standard-library

`ios::ate`写入文件和`ios:app`写入文件有什么区别。
在我看来，`ios::app`它使您能够在文件中移动，而`ios::ate`它只能在文件末尾读/写。它是否正确？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-04-28T01:17:05.710

这是相反的方式。设置时`ios::ate`，初始位置将是文件的末尾，但之后您可以自由寻找。`ios::app`设置时，*所有*输出操作都在文件末尾执行。由于所有写入都隐含在搜索之前，因此无法在其他地方写入。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-04-28T01:16:30.367

它们指定如下（在 C++11 的 27.5.3.1.4 中）：

> `app`在每次写入之前寻求结束
> 
> `ate`打开并在打开后立即结束

文件中的写入位置是“粘性的”——所有写入都在`ios::app`最后，无论您在哪里寻找。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-04-28T01:21:08.503

[这里](http://www.cplusplus.com/reference/iostream/fstream/open/)有很好的记录。

`ios::ate`“将流的位置指示器设置为打开时流的末尾。”

`ios::app`“在每次输出操作之前将流的位置指示器设置为流的末尾。”

这意味着不同之处在于，`ios::ate`当您打开文件时，会将您的位置放在文件的末尾。`ios::app`而是在每次刷新流时将其放在文件末尾。例如，如果您有两个程序写入同一个日志文件，`ios::ate`则将覆盖自您的程序打开以来由另一个程序添加到文件中的任何内容。`ios:app`每次您的程序添加日志条目时，都会跳转到文件末尾。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-09-23T10:14:17.610

`ios::app`--> “我们不能移动指针。它只会在末尾。”

`ios::ate`--> "我们可以将记录指针移动到任何其他地方。"

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-17T02:03:31.643

该`ios::ate`选项用于输入和输出操作，并 `ios::app`允许我们将数据添加到文件末尾。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-04T17:36:46.580

我在这里添加了一个答案，因为我最近遇到了 ios::ate 应该可以工作的情况，但是关于这个主题的大多数在线文档，比如cplusplus.com 上的[这个](https://www.cplusplus.com/reference/fstream/fstream/open/)页面，以及这篇文章中的类似答案只是部分正确或至少具有误导性。

每个人都正确的是 ios::app 将打开一个文件而不删除其内容，并在每次写入文件之前将光标移动到文件的末尾。因此，当使用 ios::app 打开文件时，使用像 seekp 这样的函数或多或少没用，因为在写入发生之前，每次写入时光标都会自动移动到文件的末尾。

每个人都正确的是 ios::ate 在每次写入之前不会将光标移动到文件的末尾。所以像 seekp 这样的函数可以与 ios::ate 一起使用。在技​​术上也是正确的，当您打开文件时， ios::ate 会将光标移动到文件的末尾，但这是一个技术问题——请参阅下一段。

与大多数文档和论坛答案不相符的是，实际上（如果他们对我的经验有合理的解释，请发表评论）使用 ios::ate 打开文件将删除其内容，就像 ios::trunc。如果您想打开一个非空文件进行写入，而不是删除其内容，并保留有效移动流位置的能力，就像 seekp 一样，这给您留下的选择不多。

我发现解决我的问题的唯一方法是使用我在[这篇](https://stackoverflow.com/questions/47014463/ofstream-open-modes-ate-vs-app)Stack Overflow 帖子中找到的解决方案，即使用标志 (ios::in | ios::ate) 打开文件，即使我正在为写作。这让我有点不舒服，但这是我现在正在做的事情。

# macos - 与 libc++ 编译的 boost 链接

> ID：10359704
> 
> 赞同：2
> 
> 时间：2012-04-28T01:12:39.817
> 
> 标签：macos, clang, libc++

我仍在为 libc++ 和 boost 苦苦挣扎。

我在这里用 libc++ 编译了 boost： [如何用 clang++/libc++ 编译/链接 Boost？](https://stackoverflow.com/questions/8486077/how-to-compile-link-boost-with-clang-libc)

现在我在我的一台机器上看到了这个编译错误，而另一台机器用确切的代码编译得很好。它们都具有相同的编译器版本，环境变量也相同。

这是错误：

```
Linking CXX executable main
/opt/local/bin/cmake -E cmake_link_script CMakeFiles/main.dir/link.txt --verbose=1
/usr/bin/clang++    -arch x86_64 -Wl,-search_paths_first -Wl,-headerpad_max_install_names -stdlib=libc++ CMakeFiles/main.dir/main.cpp.o  -o main  /usr/lib/libpython2.7.dylib /opt/local/lib/libboost_program_options-mt-d.a /opt/local/lib/libboost_filesystem-mt-d.a /opt/local/lib/libboost_system-mt.a /opt/local/lib/libboost_date_time-mt.a /opt/local/lib/libboost_python-mt.a /opt/local/lib/libboost_log-mt.a /opt/local/lib/libboost_thread-mt.a 
Undefined symbols for architecture x86_64:
  "__ZNSt3__112basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE6appendIPwEENS_9enable_ifIXsr21__is_forward_iteratorIT_EE5valueERS5_E4typeES9_S9_", referenced from:
      std::__1::basic_string<wchar_t, std::__1::char_traits<wchar_t>, std::__1::allocator<wchar_t> > boost::detail::convert<wchar_t, char, boost::_bi::bind_t<std::__1::codecvt_base::result, boost::_mfi::cmf7<std::__1::codecvt_base::result, std::__1::codecvt<wchar_t, char, __mbstate_t>, __mbstate_t&, char const*, char const*, char const*&, wchar_t*, wchar_t*, wchar_t*&>, boost::_bi::list8<boost::_bi::value<std::__1::codecvt<wchar_t, char, __mbstate_t> const*>, boost::arg<1>, boost::arg<2>, boost::arg<3>, boost::arg<4>, boost::arg<5>, boost::arg<6>, boost::arg<7> > > >(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, boost::_bi::bind_t<std::__1::codecvt_base::result, boost::_mfi::cmf7<std::__1::codecvt_base::result, std::__1::codecvt<wchar_t, char, __mbstate_t>, __mbstate_t&, char const*, char const*, char const*&, wchar_t*, wchar_t*, wchar_t*&>, boost::_bi::list8<boost::_bi::value<std::__1::codecvt<wchar_t, char, __mbstate_t> const*>, boost::arg<1>, boost::arg<2>, boost::arg<3>, boost::arg<4>, boost::arg<5>, boost::arg<6>, boost::arg<7> > >) in libboost_program_options-mt-d.a(convert.o)
  "__ZNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE6appendIPcEENS_9enable_ifIXsr21__is_forward_iteratorIT_EE5valueERS5_E4typeES9_S9_", referenced from:
      std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > boost::detail::convert<char, wchar_t, boost::_bi::bind_t<std::__1::codecvt_base::result, boost::_mfi::cmf7<std::__1::codecvt_base::result, std::__1::codecvt<wchar_t, char, __mbstate_t>, __mbstate_t&, wchar_t const*, wchar_t const*, wchar_t const*&, char*, char*, char*&>, boost::_bi::list8<boost::_bi::value<std::__1::codecvt<wchar_t, char, __mbstate_t> const*>, boost::arg<1>, boost::arg<2>, boost::arg<3>, boost::arg<4>, boost::arg<5>, boost::arg<6>, boost::arg<7> > > >(std::__1::basic_string<wchar_t, std::__1::char_traits<wchar_t>, std::__1::allocator<wchar_t> > const&, boost::_bi::bind_t<std::__1::codecvt_base::result, boost::_mfi::cmf7<std::__1::codecvt_base::result, std::__1::codecvt<wchar_t, char, __mbstate_t>, __mbstate_t&, wchar_t const*, wchar_t const*, wchar_t const*&, char*, char*, char*&>, boost::_bi::list8<boost::_bi::value<std::__1::codecvt<wchar_t, char, __mbstate_t> const*>, boost::arg<1>, boost::arg<2>, boost::arg<3>, boost::arg<4>, boost::arg<5>, boost::arg<6>, boost::arg<7> > >) in libboost_program_options-mt-d.a(convert.o)
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [main] Error 1
make[1]: *** [CMakeFiles/main.dir/all] Error 2
make: *** [all] Error 2 
```

我仍然遇到 ABI 不兼容问题？

这是代码：

```
#include <iostream>
#include <string>
#include <tuple>
#include <mutex>
#include <boost/filesystem.hpp>
#include <boost/system/system_error.hpp>
#include <boost/system/error_code.hpp>
#include <boost/program_options.hpp>
#include <CoreFoundation/CoreFoundation.h>
namespace po = boost::program_options;
int main(int ac, char* av[])
{
    using namespace std;
    std::mutex mymutex;
    std::tuple<int, int ,char> mytuple;

    boost::filesystem::path mypath("/usr/local/bin");
    boost::filesystem::path agaain("/usr");

    try {

        po::options_description desc("Allowed options");
        desc.add_options()
            ("help", "produce help message")
            ("compression", po::value<double>(), "set compression level")
        ;

        po::variables_map vm;        
        po::store(po::parse_command_line(ac, av, desc), vm);
        po::notify(vm);    

        if (vm.count("help")) {
            cout << desc << "\n";
            return 0;
        }

        if (vm.count("compression")) {
            cout << "Compression level was set to " 
                 << vm["compression"].as<double>() << ".\n";
        } else {
            cout << "Compression level was not set.\n";
        }
    }
    catch(exception& e) {
        cerr << "error: " << e.what() << "\n";
        return 1;
    }
    catch(...) {
        cerr << "Exception of unknown type!\n";
    }

    return 0;
} 
```

代码编译得很好，但只有在链接时出错。这是编译的额外信息：

```
chen@work:build$ make VERBOSE=1
/opt/local/bin/cmake -H/Users/chen/Code/clang -B/Users/chen/Code/clang/build --check-build-system CMakeFiles/Makefile.cmake 0
/opt/local/bin/cmake -E cmake_progress_start /Users/chen/Code/clang/build/CMakeFiles /Users/chen/Code/clang/build/CMakeFiles/progress.marks
make -f CMakeFiles/Makefile2 all
make -f CMakeFiles/main.dir/build.make CMakeFiles/main.dir/depend
cd /Users/chen/Code/clang/build && /opt/local/bin/cmake -E cmake_depends "Unix Makefiles" /Users/chen/Code/clang /Users/chen/Code/clang /Users/chen/Code/clang/build /Users/chen/Code/clang/build /Users/chen/Code/clang/build/CMakeFiles/main.dir/DependInfo.cmake --color=
Dependee "/Users/chen/Code/clang/build/CMakeFiles/main.dir/DependInfo.cmake" is newer than depender "/Users/chen/Code/clang/build/CMakeFiles/main.dir/depend.internal".
Dependee "/Users/chen/Code/clang/build/CMakeFiles/CMakeDirectoryInformation.cmake" is newer than depender "/Users/chen/Code/clang/build/CMakeFiles/main.dir/depend.internal".
Scanning dependencies of target main
make -f CMakeFiles/main.dir/build.make CMakeFiles/main.dir/build
/opt/local/bin/cmake -E cmake_progress_report /Users/chen/Code/clang/build/CMakeFiles 1
[100%] Building CXX object CMakeFiles/main.dir/main.cpp.o
/usr/bin/clang++    -arch x86_64 -I/Users/chen/Code/clang -I/opt/local/include -I/System/Library/Frameworks/Python.framework/Headers -I/Users/chen/Code/clang/Utilities/includes    -std=c++11 -stdlib=libc++ -o CMakeFiles/main.dir/main.cpp.o -c /Users/chen/Code/clang/main.cpp 
```

另一方面，在编译良好的机器上，我可以从字面上“看到”libc++ 的速度。在 Xcode 中使用时，它非常快，并且使用 libc++ 完成代码非常棒。

但在我进一步享受之前，我真的很想深入了解这个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T21:10:54.317

我才发现我的问题。这是由于 Boost 没有正确编译，因为我的另一台机器上的 bjam 无法识别 libiconv。我猜它未被识别的原因可能是因为我安装了macport。在我卸载所有 macport 东西后，bjam 可以立即识别 libiconv 并在 libc++ 下正确构建 boost，但信号除外，但这没关系。

# javascript - 获取选中的listValue在javascript中

> ID：10359714
> 
> 赞同：1
> 
> 时间：2012-04-28T01:14:09.647
> 
> 标签：javascript, struts2

我正在使用 struts 的标签来显示项目列表。

```
<s:select name="example" id="example" list="exampleList" listKey="exampleKey" 
listValue="exampleValue" onchange="fun()"/> 
```

现在我有一个javascript函数：

```
function fun()
{
  var ex=document.getElementById("example");
  alert(ex.value);
} 
```

在这个函数中，我需要获取所选项目的 listValue，但是当我使用上面的代码时，它只会提醒我我选择的 listKey。如何在 javascript 函数中获取 listValue 而不是 listKey？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T08:44:47.067

```
 $(document).ready(function() {
        $('#reminderTypeID').change(function() 
       {
             var ex = document.getElementById("reminderTypeID");    
        var selTex = ex[$('#reminderTypeID').val()].text;
        var selVal = ex[$('#reminderTypeID').val()].value;
        alert(ex[$('#reminderTypeID').val()].text);  
      });
   }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:24:03.503

试试这个（为我工作）：

```
function fun()
{
    var ex = document.getElementById("example");
    alert(ex.getAttribute('listValue'));
} 
```

**编辑**
添加小提琴： http: [//jsfiddle.net/FranWahl/Ur6jT/2/](http://jsfiddle.net/FranWahl/Ur6jT/2/)
（不知道为什么它不适合你。在小提琴中它可以工作。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-19T15:54:48.230

我遇到了同样的问题，其他答案都不适合我。这是我发现有效的解决方案：

```
 $(document).ready(function(){
        $("#example").change(function(){
            var options = document.getElementById("example").options; 
            var selectedIndex = document.getElementById("example").selectedIndex; 
            var selectedOptionText = options[selectedIndex].text;
            var selectedOptionValue = options[selectedIndex].value;
            console.log("Id of selected option is: " + selectedOptionValue);
            console.log("Text of selected option is: " + selectedOptionText);   
        });
    }); 
```

为了进一步理解这个问题，考虑一下在处理 JSP 时会创建什么 HTML 是有帮助的。将`<s:select>`生成以下 HTML：

```
<select id="example" name="example">
    <option value="456">TextA</option>
    ...
</select> 
```

按照 OP 的示例代码，“456”将`exampleKey`来自`exampleValue`. `<option>`中的每个项目都会有这样的 HTML `exampleList`。

请注意，在我的解决方案中，我使用了 jQuery`.change()`函数。但是，我也尝试了解决方案`onchange="fun()"`，就像 OP 所做的那样，这也有效。

当我尝试用 替换`document.getElementById("example")`时`$("#example")`，解决方案**不起作用**。

阅读有关选项 selectedValue 的[参考资料](http://www.w3schools.com/jsref/prop_select_selectedindex.asp)也很有帮助。`<select>`

# c++ - 在 C++ 中通过引用将数组作为函数参数传递

> ID：10359720
> 
> 赞同：1
> 
> 时间：2012-04-28T01:15:52.483
> 
> 标签：c++

如何通过引用将在 main 方法中声明的数组作为参数传递给函数？编译器也需要尺寸，但是当我给它们变量时，编译器会给出数组无效整数尺寸的错误，这是代码：

```
#include <iostream>
#include <algorithm>
#include <vector>
using namespace std;

int scanV(int Row, int value, int M, int (&tableValues)[])
{
for (int i = 0; i <= M; ++i)
{
    if (tableValues[Row - 1][i] == 1)
    {
        if (i + value <= M)
        {
            tableValues[Row][i+value] == 1;
        }
        if (i - value >= 0)
        {
            tableValues[Row][i-value] = 1;
        }
    }
}
}

int main()
{
int C, B, M;
cin>>C;
int integers[C];

for (int i = 1; i < C; ++i)
{
    cin>>integers[i];
}
cin>>B;
cin>>M;
integers[0] = B;
int tableValues[C][M + 1];
tableValues[0][B] = 1;
for (int i = 1; i < C; ++i)
{
    scanV(i, integers[i], M, tableValues);
}

return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T01:33:51.997

一种简单的解决方案是使用向量。考虑这个简单的例子：

```
#include <iostream>
#include <vector>

void f (std::vector<std::vector<int> > &v)
{
    for (int i = 0; i < 3; ++i)
        for (int j = 0; j < 3; ++j)
            v[i][j] = i * 3 + j;
}

int main()
{
    std::vector<std::vector<int> > v (3, std::vector<int> (3, 0));
    f (v);

    for (int i = 0; i < 3; ++i)
        for (int j = 0; j < 3; ++j)
            std::cout << v[i][j] << ' ';
} 
```

主要是创建整数 (3x3) 的 2D 向量。构造函数显示了 3 个元素，所有元素都使用 int 向量进行初始化，而这些元素又使用初始化为 0 的 3 个元素创建。

然后，该向量通过引用传递给函数 f，该函数分配递增的值。当向量在 main 中打印时，它显示：

```
0 1 2 3 4 5 6 7 8 
```

如您所见，它们的使用与普通数组非常相似，但它们实际上是包含在内的，并且使用 STL 可以轻松访问新级别的编程。

在 C++11 中，它们的使用变得更加熟悉。您可以按如下方式分配向量：

```
std::vector<int> v0 = {2, 5};
std::vector<std::vector<int> > v1 { {1,2,3} , {4,5,6} , {7,8,9} }; 
```

请注意，对于多维向量，最好将其封装在某种矩阵类中，并使用底层的一维向量类型。

编辑：

这是将一维和二维向量初始化为指定元素的示例。如上所示，这在 C++11 中很容易，但如果你已经有一个数组，它仍然很快。

```
int a [5] = {1,2,3,4,5}; //normal
std::vector<int> v1 (a, a +5); //create using beginning and ending addresses of a

int b[3][3] = { {1,2,3} , {4,5,6} , {7,8,9} }; //normal
std::vector<std::vector<int> > v2; //empty vector

for (int i = 0; i < 3; ++i) //3 in first dimension
    v2.push_back (std::vector<int> (b [i], b [i] + 3)); //push a vector with the appropriate 3 elements of b onto the back of v2 
```

要一次通过一个元素，您可以这样做：

```
std::vector<std::vector<int> > v (3, std::vector<int> (3));

for (int i = 0; i < v.size(); ++i) //v.size() == 3
    for (int j = 0; j < v [i].size(); ++j)
        adjustElement (v [i][j]); //replace with what you need 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T02:36:27.960

[**`std::vector`**](http://en.cppreference.com/w/cpp/container/vector)`int integers[C];`s 是 C++ 中的方式，因为禁止使用可变长度数组（例如）。

我建议使用`typedef`这些以使您的代码更易于阅读：

```
#include <vector>

typedef std::vector<int> row_t;
typedef std::vector<row_t> table_t; 
```

然后你可以声明：

```
void scanV(int Row, int value, int M, table_t& tableValues) 
```

我做了这个`void`，因为它没有返回任何东西。

然后你的变量`int main()`变成：

```
row_t integers;
table_t tableValues; 
```

注意这一行：

```
 tableValues[Row][i+value] == 1; 
```

您可能打算分配，而不是检查等价性！

请尝试选择一些比`B`, `M`, `C`...更有意义的变量名

# python - 有没有办法获取函数的返回值并同时测试它的“非零”？

> ID：10359724
> 
> 赞同：2
> 
> 时间：2012-04-28T01:16:32.827
> 
> 标签：python

我的代码如下所示：

```
if(func_cliche_start(line)):
   a=func_cliche_start(line)
   #... do stuff with 'a' and line here
elif(func_test_start(line)):
   a=func_test_start(line)
   #... do stuff with a and line here
elif(func_macro_start(line)):
   a=func_macro_start(line)
   #... do stuff with a and line here
... 
```

每个 func_blah_start 函数要么返回 None 要么返回一个字符串（基于输入行）。我不喜欢对 func_blah_start 的冗余调用，因为它看起来像是一种浪费（func_blah_start 是“纯的”，所以我们可以假设没有副作用）。这种事情有更好的成语吗，或者有更好的方法吗？

也许我错了，（我的 C 生锈了），但我认为你可以在 C 中执行以下操作：

```
int a;
if(a=myfunc(input)){ /*do something with a and input here*/ } 
```

有python等价物吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:20:15.500

为什么不在 if 语句之前将函数 func_cliche_start 分配给变量 a 呢？

```
a = func_cliche_start(line)
if a: 
   pass  # do stuff with 'a' and line here 
```

如果 func_cliche_start(line) 返回 None，if 语句将失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T01:27:14.513

您可以创建一个包装函数来完成这项工作。

```
def assign(value, lst):
    lst[0] = value
    return value

a = [None]
if assign(func_cliche_start(line), a):
   #... do stuff with 'a[0]' and line here
elif assign(func_test_start(line), a):
   #... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T01:29:11.353

您可以循环遍历您的处理函数，这将更容易且行数更少:)，如果您想在每种情况下做一些不同的事情，请将其包装在一个函数中并调用它，例如

```
for func, proc in [(func_cliche_start, cliche_proc), (func_test_start, test_proc), (func_macro_start, macro_proc)]:
    a = func(line)
    if a:
        proc(a, line)
        break; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T02:11:53.183

我认为您应该将这些代码块放入函数中。这样你就可以使用`dispatcher`-style 方法。如果你需要修改很多本地状态，使用一个类和方法。（如果没有，只需使用函数；但我会在这里假设类案例。）所以像这样：

```
from itertools import dropwhile

class LineHandler(object):
    def __init__(self, state):
        self.state = state
    def handle_cliche_start(self, line):
        # modify state
    def handle_test_start(self, line):
        # modify state
    def handle_macro_start(self, line):
        # modify state

line_handler = LineHandler(initial_state)
handlers = [line_handler.handle_cliche_start,
            line_handler.handle_test_start,
            line_handler.handle_macro_start]
tests = [func_cliche_start, 
         func_test_start, 
         func_macro_start]
handlers_tests = zip(handlers, tests)

for line in lines:
    handler_iter = ((h, t(line)) for h, t in handlers_tests)
    handler_filter = ((h, l) for h, l in handler_iter if l is not None)
    handler, line = next(handler_filter, (None, None))
    if handler:
        handler(line) 
```

这比您的原始代码复杂一点，但我认为它以一种更具可扩展性的方式划分事物。它确实需要您维护单独的函数并行列表，但回报是您可以添加任意数量的函数，而无需编写长`if`语句 - 或调用您的函数两次！可能还有更复杂的方法来组织上述内容 - 这实际上只是您可以做的一个粗略示例。例如，您可能能够创建一个充满`(priority, test_func, handler_func)`元组的排序容器并对其进行迭代。

无论如何，我认为你应该考虑重构这个长长的`if`/`elif`子句列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-06T14:25:02.003

您可以获取函数列表，使其成为生成器并返回第一个 Truey 函数：

```
functions = [func_cliche_start, func_test_start, func_macro_start]
functions_gen = (f(line) for f in functions)
a = next((x for x in functions_gen if x), None) 
```

*仍然看起来有点奇怪，但重复性要少得多。*

# salesforce - VisualForce - 条件 html 标签

> ID：10359725
> 
> 赞同：2
> 
> 时间：2012-04-28T01:16:37.883
> 
> 标签：salesforce, visualforce

我正在尝试对列表中的第一个元素应用不同的样式。

我目前正在尝试使用计数器来应用`li`with a `class`，`cnt==0`但我不能在标签中包含`<` `>`括号。`OutputText`有什么方法可以转义括号或使用条件将其`class`插入标签中？`<li>`

我知道这可以在使用 JavaScript 之后完成，但我宁愿避免它。

```
<apex:variable var="cnt" value="{!0}" /> 
<apex:repeat value="{!items}" var="item" >
    <!-- only render the class if it is the first element -->
    <apex:OutputText value="<li class="activeLI">" rendered="{!cnt==0}" />
    <apex:OutputText value="<li>" rendered="{!cnt!=0}" />        

        <img src="{!$Resource[item.Image__c]}" width="85" height="90"/>
    </li>
    <apex:variable var="cnt" value="{!cnt+1}"/>
</apex:repeat> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T16:16:59.020

Visualforce 是严格的，每个元素都必须有一个开始和结束标记，或者必须是自闭合的。编译后，Visualforce 会报错，因为它只会看到结束的“li”标签，而不是有条件的开始的“li”标签，一种解决方案是让类名成为变量，如下所示：

```
<apex:variable var="cnt" value="{!0}" />
<apex:variable var="class" value=""/>
<apex:repeat value="{!items}" var="item" >
  <apex:variable var="class" value="activeLI" rendered="{!cnt==0}"/>
  <apex:variable var="class" value="" rendered="{!cnt!=0}"/>
    <li class="{!class}">
      ...
    </li>
  <apex:variable var="cnt" value="{!cnt+1}"/> 
</apex:repeat> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T16:36:47.927

您是否考虑过使用 CSS 选择器？这是一个关于如何为列表的第一个元素设置样式的示例。

```
<style>
ul.myList > li:first-child {color : red}
</style>

<ul class="myList">
  <li>this is red</li>
  <li>this has default formatting</li>
</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T15:42:06.297

你考虑过使用`<apex:dataList>`吗？我认为它可能会完成您想要做的事情。

# ruby-on-rails - 没有这样的列 - 当列存在时

> ID：10359728
> 
> 赞同：4
> 
> 时间：2012-04-28T01:17:06.977
> 
> 标签：ruby-on-rails, activerecord

不知道这是怎么发生的，但它说该列不存在：

> SQLite3::SQLException：没有这样的列：element.kind：SELECT COUNT(*) FROM "answers" INNER JOIN "elements" ON "elements"."id" = "answers"."element_id" WHERE "answers"."form_id " = 55 AND "元素"."kind" = 6

```
# element.rb
class Element < ActiveRecord::Base
  has_many :answers
end

# answer.rb
class Answer < ActiveRecord::Base
  belongs_to :element
  belongs_to :form
end

class Form < ActiveRecord::Base
  has_many :answers
end 
```

但是当我运行时：

```
@form.answers.joins(:element).where(:element => {:kind => 6}) 
```

我得到上面的sql错误。不知道发生了什么。对我所缺少的有什么想法吗？

谢谢！

仅供参考，我正在使用 ruby​​ 1.9.3 运行 rails 3.2.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T02:22:31.593

该表`elements`不是`element`由查询 ( `"element"."kind" = 6`) 生成的。

```
@form.answers.joins(:elements).where(:elements => {:kind => 6}) 
```

我原以为查询的其余部分也将使用不存在的`element`表生成，因为您使用`.joins(:element)`了而不是，`.joins(:elements)`但 Rails 可能在内部使用复数形式`.joins()`进行`belongs_to`关联。

```
@form.answers.joins(:element).where(:elements => {:kind => 6}) 
```

# forms - Twitter 搜索 API - PHP 多词搜索不起作用

> ID：10359729
> 
> 赞同：0
> 
> 时间：2012-04-28T01:17:07.210
> 
> 标签：forms, search, twitter

我有一个简单的搜索栏，用户输入搜索词，并且应该显示与搜索词匹配的推文。但是，它仅适用于单个单词搜索。

```
<div id="search">
<form action="" method="get">
  <label>
  Search:
  <input type="text" name="search_box" id="search_box" />
  <input type="submit" name="submit" id="submit" value="Search" />
  </label>
</form>
</div>

<?php 

$q=$_GET['search_box'];

$search = "http://search.twitter.com/search.atom?q=".$q."";

$tw = curl_init();

curl_setopt($tw, CURLOPT_URL, $search);
curl_setopt($tw, CURLOPT_RETURNTRANSFER, TRUE);
$twi = curl_exec($tw);
$search_res = new SimpleXMLElement($twi);

echo "<h3>Twitter search results for '".$q."'</h3>";

foreach ($search_res->entry as $twit1) {

$description = $twit1->content;

$message = $row['content'];

echo "<div class='text'>".$description."</div><br><br>";

}

curl_close($tw);

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:41:41.483

如果您使用引号搜索完全匹配的短语，那么您需要在构造查询字符串之前转义这些引号。使用当前代码：

```
$q = $_GET['q']
$search = "http://search.twitter.com/search.atom?q=".$q.""; 
```

输入的“测试短语”将产生这个表达式（这可能会导致解析错误）：

`"http://search.twitter.com/search.atom?q="test phrase"";`

相反，在将其包含在搜索字符串中之前，尝试对用户输入进行 urlencoding：

```
$q = urlencode($_GET['q']);
$search = "http://search.twitter.com/search.atom?q={$q}"; 
```

这应该导致值：

`http://search.twitter.com/search.atom?q=%22test%20phrase%22`

您可以通过在浏览器中输入 URL 来检查这是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:31:22.997

编辑：

这是 Twitter 搜索 API 的最佳资源：[https ://dev.twitter.com/docs/using-search](https://dev.twitter.com/docs/using-search)

为了匹配精确的短语，只需将查询字符串包装在 qoutes 中。

--

在 Twitter API 中，任何短语都是逻辑 AND，而逗号分隔的值是逻辑 OR。

> “逗号分隔的关键字和短语是逻辑 OR，短语是逻辑 AND。短语中的单词由空格分隔。如果任何短语匹配，则推文匹配。如果推文中存在所有单词，则短语匹配。（例如，推特是AND twitter，而,twitter 是 OR twitter。）。术语完全匹配，也完全匹配忽略标点符号。

这实际上来自 Streaming API，但我相信它也适用于搜索 API（如果我错了，请有人纠正我！）。

让我们考虑一下这对于一个简单的例子意味着什么：

```
Tweet: "This is a tweet about grapefruit" 
```

将与查询匹配：

*   鸣叫
*   柚子
*   推特葡萄柚

但不是：

*   菠萝
*   柚子菠萝

如果您正在搜索“菠萝”或“葡萄柚”的推文，那么您的查询参数需要是：

“葡萄柚，菠萝”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T19:26:29.337

```
$q = $_GET['search_box']." is";
$search = "http://search.twitter.com/search.atom?q=%22".urlencode( $q )."%22"; 
```

# java - TreeMap java中的天花板和地板

> ID：10359731
> 
> 赞同：4
> 
> 时间：2012-04-28T01:17:16.703
> 
> 标签：java, treemap, sortedlist, ceil

我发现自己使用 TreeMap 只是因为我需要使用 floorEntry()（和 ceilingEntry()）方法查找某些内容的能力。这显然使代码有点笨拙。那么有没有人碰巧知道是否有任何内置的排序列表可以提供与 floorEntry() 相同的功能？

例如，我有一个`List<Integer> list`. 我有一个价值`int num`。我想得到`list`不大于的最大元素`num`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T01:18:37.903

只需使用 a`TreeSet`及其`floor`和`ceiling`方法，不是吗？为什么使用`Map`?

# emscripten - EMScripten 无法构建示例项目

> ID：10359735
> 
> 赞同：0
> 
> 时间：2012-04-28T01:17:57.553
> 
> 标签：emscripten

我正在尝试让 EMScripten 工作。我非常有信心我已经按照教程进行操作，并确保安装了提到的依赖项。

在尝试构建示例项目时，它会像这样失败；

```
tv@apu:~/git/emscripten$ EMCC_DEBUG=1 ./emcc tests/hello_world.c 

emcc invocation:  ./emcc tests/hello_world.c 
emcc: compiling to bitcode
emcc: compiling source file:  tests/hello_world.c
emcc running: /usr/bin/clang -m32 -U__i386__ -U__x86_64__ -U__i386 -U__x86_64 -U__SSE__ -U__SSE2__ -U__MMX__ -UX87_DOUBLE_ROUNDING -UHAVE_GCC_ASM_FOR_X87 -DEMSCRIPTEN -U__STRICT_ANSI__ -U__CYGWIN__ -D__STDC__ -Xclang -triple=i386-pc-linux-gnu -nostdinc -nostdinc++ -Xclang -nobuiltininc -Xclang -nostdinc++ -Xclang -nostdsysteminc -Xclang -isystem/home/tv/git/emscripten/system/include -Xclang -isystem/home/tv/git/emscripten/system/include/bsd -Xclang -isystem/home/tv/git/emscripten/system/include/libc -Xclang -isystem/home/tv/git/emscripten/system/include/libcxx -Xclang -isystem/home/tv/git/emscripten/system/include/gfx -Xclang -isystem/home/tv/git/emscripten/system/include/net -Xclang -isystem/home/tv/git/emscripten/system/include/SDL -U__APPLE__ -emit-llvm -c tests/hello_world.c -o /tmp/tmpMvgQiE/hello_world_0.o
clang: warning: argument unused during compilation: '-nostdinc++'
emcc: will generate JavaScript
emcc: considering including libcxx: we need |[]| and have |[]|
emcc: considering including libcxxabi: we need |[]| and have |[]|
emcc: considering including dlmalloc: we need |[]| and have |[]|
emcc: saving intermediate processing steps to /tmp/emscripten_temp
emcc: LLVM dead globals elimination
Traceback (most recent call last):
  File "./emcc", line 837, in <module>
    shared.Building.llvm_opt(in_temp(target_basename + '.bc'), ['-internalize', '-globaldce'])
  File "/home/tv/git/emscripten/tools/shared.py", line 545, in llvm_opt
    output = Popen([LLVM_OPT, filename] + opts + ['-o=' + filename + '.opt.bc'], stdout=PIPE).communicate()[0]
  File "/usr/lib/python2.7/subprocess.py", line 679, in __init__
    errread, errwrite)
  File "/usr/lib/python2.7/subprocess.py", line 1249, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory 
```

的内容`~/.emscripten`：

```
tv@apu:~/git/emscripten$ cat ~/.emscripten | egrep -v '^#|^$'
EMSCRIPTEN_ROOT = os.path.expanduser('~/git/emscripten') # this helps projects using emscripten find it
LLVM_ROOT = os.path.expanduser('/usr/bin')
NODE_JS = 'node'
TEMP_DIR = '/tmp' # You will need to modify this on Windows
COMPILER_ENGINE = NODE_JS
JS_ENGINES = [NODE_JS] 
```

我不知道问题是什么 - 需要帮助进行故障排除。有没有人对这里可能出现的问题有任何想法？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T21:18:54.767

确保您的 clang 位于符号链接的 llvm 目录中，如下所示： sudo ln -s /usr/bin/clang++ /usr/lib/llvm-3.2/bin/clang++

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T23:37:38.087

你试过最新的*Emscripten*吗？

好像你`LLVM_OPT`的不在场。如果问题仍然存在，请进入`/home/tv/git/emscripten/tools/shared.py`第 545 行（`Popen([LLVM_OPT...`）之前添加一行

```
print 'LLVM_OPT IS: <' + LLVM_OPT + '>' 
```

在下一次编译时，这应该打印`LLVM_OPT`到您的标准输出的路径。而且这条路径可能不存在，所以你可能只需要一个符号链接，因为 opt 二进制文件有一个版本附录或类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-03T20:33:06.557

看看你的路径。我正在使用 Emscripten，在经历了一系列令人困惑的失败之后，结果发现我的路径信息不正确。特别是我的 LLVM_ROOT。这对我来说是正确的：

```
LLVM_ROOT = os.path.expanduser(os.getenv('LLVM') or '/usr/lib/llvm-3.2/bin') # directory 
```

请注意 llvm 的位置，它与我最初的默认 /usr/bin 非常不同。请注意，即使路径错误，我收到的建议 emscripten 的错误也几乎可以正常工作。

注意：我使用的是 Linux Mint 14 (Ubuntu Quantal)。

# ios - 窗口的iOS子视图不旋转

> ID：10359736
> 
> 赞同：1
> 
> 时间：2012-04-28T01:18:03.217
> 
> 标签：ios, rotation, uiwindow

我在主窗口上有许多子视图。这些子视图不旋转。有没有简单的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:19:56.683

使用`UIViewController`，它会自动处理旋转。很少需要将子视图直接添加到窗口中。

# python - 添加行的一部分以制作序列行（python）

> ID：10359740
> 
> 赞同：-3
> 
> 时间：2012-04-28T01:18:49.680
> 
> 标签：python

我有一个像这样行的文件：

NM_198212 chr7 + 115926679 115935830 115927071 11593344 2 115926679,115933260，（对此列感兴趣，这些数字被称为外显子开始） 115927221,115935830，（而这个，这些被称为外显子结束）

最后两列（逗号分隔的列）可以包含可变数量的整数。这意味着它可以有五个用逗号分隔的数字，甚至是 15。

如果我有文件的第一行，我会想要这样一行：

> > NM_198212|chr7(+):115926679-115935830|115926679-115927221,115933260-115935830（但这可以根据给定的开始和结束的数量继续）

在更简单的范围内：

近乎_？？？chr12 - 10 110 10 110 3 10,50,100, 20,60,110,

我希望该信息行的结尾是 10-20,50-60,100-110

如何编写代码以使我要输出的行的末尾包括其中的每一个，而不管数字的数量如何。

我有这段代码，如果有帮助的话，它将配对所有的开始和结束。

```
fp = (infile, 'r')
for line in fp:
   tokens = line.split()
   exonstarts = tokens[8][:-1].split(',')
   exonends = tokens[9][:-1].split(',')
   zipped = list(zip(exonstarts, exonends)) 
```

对于上面的示例，zipped 将是 [(10, 20), (50, 60), (100, 110)]。我的问题是如何将其合并到我想要的信息行中（我已经写了整个表达式，除了包含开始和结束的部分。

因此，我不知道如何将这些从列表中取出并转换为我想要的格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:52:26.557

不确定这是您所追求的，但是：

```
range_str = ",".join(["%s-%s" % item for item in zipped]) 
```

如果压缩 == [(10, 20), (50, 60), (100, 110)]

```
10-20,50-60,100-110 
```

# java - 使用 java 在全屏应用程序中截屏？

> ID：10359754
> 
> 赞同：0
> 
> 时间：2012-04-28T01:21:51.733
> 
> 标签：java, screenshot

我正在使用使用 Java Robot 类截取屏幕截图的标准方法，即：

```
BufferedImage screencapture = robot.createScreenCapture(new Rectangle(tool.getScreenSize())); 
```

这在大多数情况下都可以正常工作，但它只是在全屏应用程序中拍摄空白屏幕的照片（我使用的是 Windows 7，所以其中大多数都使用 Direct X 进行全屏显示）。这是机器人类的已知问题还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:48:33.100

Robot 类无法捕获全屏 DirectX 或 OpenGL 应用程序。

我只是做了一些快速的谷歌搜索并找到[了 JavaCV](http://code.google.com/p/javacv/)。这将比仅使用 Robot 涉及*更多*，但 JavaCV（主要是 OpenCV 包装器）应该允许您这样做。（尽管不要引用我的话）...

# python-3.x - 为什么 python 给我一个语法错误？

> ID：10359755
> 
> 赞同：0
> 
> 时间：2012-04-28T01:21:57.833
> 
> 标签：python-3.x

我有一个教程中的这段代码：

```
#File called test
1 def sanitize(time_string):
2         if '-' in time_string:
3                 splitter = '-'
4         elif ':' in time_string:
5                 splitter = ':'
6         else:
7                 return(time_string)
8         (mins, secs) = time_string.split(splitter)
9         return(mins + '.' + secs)
10 
11 
12         
13 def get_coach_data(filename):
14         with open(filename) as f:
15                 data = f.readline()
16         temp1 = data.strip().split(',')
17         return(Athlete(temp1.pop(0), temp1.pop(0), temp1)
18 
19 
20 james = get_coach_data('james2.txt')
21 julie = get_coach_data('julie2.txt')
22 mikey = get_coach_data('mikey2.txt')
23 sarah = get_coach_data('sarah2.txt')
24 
25 print(james.name+"'s fastest times are: " + str(james.top3()))
26 print(juliename+"'s fastest times are: " + str(julie.top3())) 
27 print(mikey.name+"'s fastest times are: " + str(mikey.top3()))
28 print(sarah.name+"'s fastest times are: " + str(sarah.top3())) 
```

我把这个类分开，因为我认为它可能导致了错误：

```
 1 class Athlete:
 2         def __init__(self, a_name, a_dob=None, a_times=[]):
 3                 self.name = a_name
 4                 self.dob = a_dob
 5                 self.times = a_times
 6 
 7         def top3(self):
 8                 return(sorted(set([sanitize(t) for t in self.times]))[0:3]) 
```

错误是：

```
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "test.py", line 20
james = get_coach_data('james2.txt') 
```

但是这个错误没有任何意义。我是 python 新手。我感谢任何人的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:28:17.387

我可以看到的错误是：

1.  ```
    return(Athlete(temp1.pop(0), temp1.pop(0), temp1) 
    ```

    在`get_coach_data`应该只是

    ```
    return Athlete(temp1.pop(0), temp1.pop(0), temp1) 
    ```

    在第 17 行

2.  `juliename`应该`julie.name`在第 26 行

# php - 通过 PHP 回显动态的 HTML 图像路径

> ID：10359757
> 
> 赞同：0
> 
> 时间：2012-04-28T01:22:02.763
> 
> 标签：php, html

我正在尝试在 PHP 中回显动态图像路径。我有这个有效的代码

```
 <?php
 //this code works
 $image = '<img src="img/newlogo.jpg">';
 echo($image);
?>
//gives me an image 
```

而这段代码没有

```
 <?php
 //this code doesn't
 $lineofstring='newlogo.jpg';

 $image = '<img src="img/$lineofstring">';
 echo($image);
?> 
```

$lineofsting 实际上是一个存储在 mysql 数据库中的图像路径，其中一行填充，例如：pictureabc.jpg，第二行是 picturexyz.jpg 等。

我试图将搜索到的图像路径名称传递到 $lineofstring，然后回显但没有图片出来。我哪里错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:24:11.147

要在 PHP 中插入变量，您需要使用双引号`"`，例如

```
$image = "<img src=\"img/$lineofstring\">"; 
```

在这种情况下，您需要转义内部`"`.

您还可以使用以下方式连接字符串`.`：

```
$image = '<img src="img/' . $lineofstring . '">'; 
```

如果它更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T01:24:22.190

您的`$lineofstring`变量位于使用单引号的字符串中。单引号告诉 PHP 按字面意思使用字符串，因此您的变量不会被识别为变量。将其更改为双引号或使用连接来实现您的目标。

```
$image = "<img src=\"img/$lineofstring\">"; 
```

或者：

```
$image = '"<img src="img'.$lineofstring.'">'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-21T06:50:39.563

```
$profilepicture="images/profiles/".$myid.".gif";
$noprofilepicture="images/profiles/no_avatar.gif";

echo "<IMG SRC='";
if (file_exists($profilepicture)) {
echo "".$profilepicture."";
} else {
echo "".$noprofilepicture."";
}
echo "'>"; 
```

# jquery - jQuery - 当一个已经突出显示（“点击”）时，如何防止第二个段落被突出显示

> ID：10359763
> 
> 赞同：3
> 
> 时间：2012-04-28T01:22:51.577
> 
> 标签：jquery, paragraph

我有两个函数，一个动态创建段落，另一个函数选择（“更改背景颜色”）和取消选择（“更改为默认背景颜色”）。我遇到的问题是我可以同时选择所有段落，并且我希望能够一次选择一个段落，当然，在取消选择已经选择的段落之后。

当已经选择/突出显示一个段落时，如何防止另一个段落被选择/突出显示？

你可以在这里查看完整的源代码：http: [//jsfiddle.net/2QqmN/1/](http://jsfiddle.net/2QqmN/1/)

jQuery代码：

```
$(document).ready(function(){
var count = 1;
$("#add").on(
    "click", function(){
        $("#a").append('<p>Paragraph ' + count + '</p>');
    count++;

    });
$("#a").on("click", "p", function(){ 
var bg = $(this).css("background-color");

    if(bg=="rgb(255, 255, 255)") {  
        $(this).css({"background-color":"green", "color":"white"});

    } 

 else { 

  $(this).css({"background-color":"white","color":""});

 }
    });

}); 
```

如果我足够清楚，请帮助！您将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:35:06.007

您应该使用 css 来设置所选项目的样式。每个选定的项目都可以被赋予一个“选定”的 CSS 类。单击时，您可以从所有元素中删除该类，然后将该类添加到单击的元素中。

```
.selected { background-color: green; color: white; } 
```

对于 JavaScript：

```
var count = 1;
$("#add").on("click", function() {
    $("#a").append('<p>Paragraph ' + count + '</p>');
    count++;
});

$("#a").on("click", "p", function() {
    $(".selected").removeClass("selected");
    $(this).addClass("selected");
}); 
```

[http://jsfiddle.net/2QqmN/6/](http://jsfiddle.net/2QqmN/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:27:21.503

只需添加一个标志，如下所示：

```
$(document).ready(function(){
var count = 1, flag = false;
    $("#add").on("click", function(){
         $("#a").append('<p>Paragraph ' + count + '</p>');
         count++;
   });
   $("#a").on("click", "p", function(){ 
        var bg = $(this).css("background-color");
        if(bg=="rgb(255, 255, 255)") {  
            if (flag==false) {
               $(this).css({"background-color":"green", "color":"white"});
               flag=true;
            }
        } else { 
             $(this).css({"background-color":"white","color":""});
             flag=false;
       }
  });
}); 
```

[小提琴](http://jsfiddle.net/adeneo/2QqmN/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:44:16.673

我试图理解这个问题。据我所知，您希望在任何给定时间只选择一个段落，但能够添加*n 个*段落。如果是这种情况，我相信以下内容可以做到这一点：

```
$( "#a" ).on( "click", "p", activateParagraph );
$( "#add" ).on( "click", addParagraph );

function addParagraph () {
  $( "<p>", { text: 'Paragraph ' + $( "#a p" ).length++ } )
    .appendTo( "#a" ); 
}

function activateParagraph () {
  $( this )
    .addClass( "on" )
    .siblings( ".on" )
      .removeClass( "on" );
} 
```

演示：http: [//jsbin.com/uziheg/2/edit](http://jsbin.com/uziheg/2/edit)

# javascript - Javascript - 将鼠标点击映射到网格上

> ID：10359764
> 
> 赞同：1
> 
> 时间：2012-04-28T01:22:57.600
> 
> 标签：javascript, arrays, grid, mapping

我有一个由 javascript 中的数组组成的立方体网格。网格尺寸存储在变量中。`dim`单个立方体的尺寸也是如此，`spacing`是每个立方体之间的距离（`dim`并`spacing`以像素表示）。

现在，考虑到我总是可以在变量中拥有用户鼠标位置，`g.mouseX`为什么`g.mouseY`这段代码并不总是那么精确？

```
var j = Math.round(g.mouseX / (dim+spacing));
var i = Math.round(g.mouseY / (dim+spacing));

// user clicked on the cell grid[j][i] 
```

有时我点击一个立方体，但看起来他正在考虑附近的那个。看起来用户点击的整个映射移动了一半`dim`。可能使用 Math.round 会使一切几乎出错，但是当用户单击我的网格中的精确坐标时，我看不到任何其他方法可以将这种混乱和不可预测的值转换。

希望任何人都可以在这方面提供帮助！

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:28:23.717

你想要截断，而不是圆形。您可以使用`Math.floor`, 将（例如）映射`3.7`到`3`：

```
var j = Math.floor(g.mouseX / (dim+spacing)); 
```

但实际上，为什么不直接绑定`onclick`每个网格单元的事件呢？

# php - PHP 代理仅在某些 URL 上运行

> ID：10359765
> 
> 赞同：1
> 
> 时间：2012-04-28T01:22:58.290
> 
> 标签：php, tomcat, proxy, amazon-ec2, openlayers

我试图解决在一个域上托管 Geoserver 地图图层以及通过 OpenLayers WMSGetFeatureInfo 在[另一个域](http://greengeography.org/projects/oregonwild/or_wild_webmap18.html)上访问它们的 html 文件所涉及的跨域问题。[当然，当html 文件在同一个域上](http://50.112.123.161:8080/geoserver/www/or_wild_webmap5.html)时，这很好用（单击多边形，您应该会得到一个包含该功能信息的弹出窗口）。我在这个网站和其他网站上看到过一些类似的帖子，但没有一个能解决这个问题：

当我提交包含我的 php 代理的 URL 时，例如[http://greengeography.org/projects/oregonwild/curlproxy3.php?url=http://www.google.com](http://greengeography.org/projects/oregonwild/curlproxy3.php?url=http://www.google.com)，它工作正常。但是当我尝试来自我的 Amazon EC2 站点（运行 Linux 和 Tomcat 6 btw）的任何 URL 时，例如[http://greengeography.org/projects/oregonwild/curlproxy3.php?url=http://50.112.123.161:8080](http://greengeography.org/projects/oregonwild/curlproxy3.php?url=http://50.112.123.161:8080)，结果我得到一个0。并且该 IP 地址可以[自行](http://50.112.123.161:8080)访问。

这是我的 php（我也尝试过**get_file_contents**方法）：

```
<?php

    $url = $_REQUEST["url"];

    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_URL, $url);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, TRUE);
    curl_setopt($curl, CURLOPT_HTTPHEADER, array(
            'POST HTTP/1.0',
            'Content-type: text/xml;charset="UTF-8"',
            'Accept: text/xml',
            'Cache-Control: no-cache',
            'Pragma: no-cache'
        ));
    $theData = curl_exec($curl);
    curl_close($curl);

    echo $theData;

?> 
```

还有我的 OpenLayers/GeoExt：

```
OpenLayers.ProxyHost = "curlproxy3.php?url=";

var featureInfo = new OpenLayers.Control.WMSGetFeatureInfo({
         url: 'http://50.112.123.161:8080/geoserver/OR_wild_wkspc/wms',
         queryVisible: true,  
         FEATURE_COUNT: 1,
         exceptions: "application/vnd.ogc.se_xml",       
         layerUrls: ["http://50.112.123.161:8080/geoserver/gwc/service/wms"],
            eventListeners: {
                getfeatureinfo: function(e) {
                     new GeoExt.Popup({
                     title: "Feature Info",
                     width: 400,
                     autoHeight: true,
                     autoScroll: true,
                     queryVisible: true,
                     map: map,
                     lonlat: mapPanel.map.getLonLatFromPixel(e.xy),
                     html: e.text
                    }).show();
                }
            }
    });

mapPanel.map.addControl(featureInfo);
featureInfo.activate(); 
```

另外，很抱歉，这是一个小问题，在我让代理工作之前我什至无法解决，但是当我点击主站点上的一个功能时，我收到以下信息：**未捕获的类型错误：无法读取属性'x' 的 null**。也无法弄清楚那个。

有什么想法吗？我认为这是 Tomcat 或我的 Linux/Amazon 环境中的某些设置的问题，而不是 php，因为我对指向其他站点的代理没有问题。哦，我的 php 经验很少，所以如果可能的话，请把它放低。谢谢！

# ruby-on-rails - 竞赛的模范协会

> ID：10359767
> 
> 赞同：0
> 
> 时间：2012-04-28T01:23:21.367
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我是 Rails 新手，正在开发具有以下情况的应用程序：

用户有技能（例如漂流、跳舞） 用户参加比赛 比赛测量多种技能 在每次比赛结束时，每个用户都会得到一个分数（例如跳舞：5，漂流：4）

对此进行建模的最佳方法是什么？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:55:53.797

这很讨厌：s 最后我实际上不确定这是否是正确的方法

```
class Skill < ActiveRecord::Base
  has_many :skill_scores
  has_many :user_skills
end

class UserSkill < ActiveRecord::Base
  belongs_to :user
  belongs_to :skill
end

class SkillScore < ActiveRecord::Base
  belongs_to :user
  belongs_to :contest
  belongs_to :skill
end

class User < ActiveRecord::Base
  has_many :skills
  has_many :contests, :through => :contest_participations
  has_many :skill_scores
end

class Contest < ActiveRecord::Base
  has_many :users, :through => :contest_participations
  has_many :skill_scores
end

class ContestParticipation < ActiveRecord::Base
  belongs_to :user
  belongs_to :contest
end 
```

# java - 比较java中的扑克手

> ID：10359781
> 
> 赞同：1
> 
> 时间：2012-04-28T01:25:29.347
> 
> 标签：java, arrays, poker

我正在做一个扑克游戏。到目前为止，我一直在比较扑克牌。我对如何做到这一点有一个想法，但我不确定我的代码有什么问题。有人可以指出什么问题吗？

所以让我简要描述一下我的代码在做什么。

我程序的另一部分将遍历我手中的牌，并在一个数组中列出一张牌值的频率。

```
h = Hearts
c = Clubs
d = Diamonds
s = Spades
d4 = 4 of Diamond 
```

因此，假设我手中有 c3、h4、d4、s4、2d，我将调用程序的另一部分来读取我手中的牌并返回一个计数数组。上面我手的计数数组将是 [0,0,1,1,3,0,0,0,0,0,0,0,0,0] 所以这个数组的意思是我的手有一个 2、一个 3 和三个 4。

现在这是我试图找到三种类型的方法，它应该为满屋返回 false（即三种类型加一对）

```
public boolean hasThreeOfAKind() {
    int [] temp;
    temp = this.getCounts();
    for (int i = 0; i< temp.length; i++){
        if (temp [i] == 3 ){
            for (int j = 0; j < temp.length ; j++)
                if ( temp [j] != 2){
                    return true;
                }
        }
    }return false; 
```

所以我上面要做的是首先，我遍历数组，如果有任何 3。如果有 3，我再次遍历数组，看看是否有 2。如果没有一个2，然后我知道它是三个的一种。如果有一个 2，那么它是满屋，我应该返回 false。我认为我的逻辑是正确的，但是我的代码有问题。

我遇到的第二只手是如何确定我的手是否正好有一对。如果只有一对，它只返回 true。如果有两对等，则返回 false。

```
public boolean hasOnePair() {
    int [] temp;
    temp = this.getCounts();

    for (int i = 0; i< temp.length; i++){
        if (temp [i] == 2 ){
            return true;
        }
    }return false; 
```

对于这个，我正在考虑按降序或升序对数组中的值进行排序。如果我选择降序，我先读取数组，看看有没有2，然后我可以扫描下一个，看看第一个2之后的下一个值是否也是2。如果还有2，那么它将返回错误。

有人可以看看我的代码并指出问题所在吗？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:44:00.290

你为什么要使用如此低级的原语？您没有使用完整的 Card 课程是否有原因？你的代码会简单得多。

```
class Card
  enum Value {
    TWO,
    ...
    ACE
  };

  enum Suit {
    SPADES,
    ...
    CLUBS

  };
  private Suit suit;
  private Value value;

  public Card(Suit suit, Value value) {
    this.suit = suit;
    this.value = value;
  }
}

public class Hand {
  private final List<Card> cards;
  public Hand(Card first, Card second, Card third, Card fourth, Card fifth) {
     // add to cards list.

     // sort ascending by value

  }

  public boolean hasThreeOfAKind() {
    for (int i = 0; i < 3; i++) {
      Value firstValue = cards.get(i).getValue();
      Value secondValue = cards.get(i+1).getValue();
      Value thirdValue = cards.get(i+2).getValue();
      if (firstValue == secondValue && secondValue == thirdValue) {
        return true;
      }
    }
    return false;
  }
} 
```

这并不能直接回答您的问题，但在我看来，这种代码更具可读性和可维护性，并且比仅涉及整数的代码更容易调试。Java 不是 C，如果把它当作 C 来对待，你并没有真正获得太多收益。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T01:33:26.893

在您`hasThreeOfAKind()`中，您有以下错误：

```
for (int j = 0; j < temp.length ; j++) 
  if ( temp [j] != 2){ 
    return true; 
  } 
} 
```

这将在第一次找到非 2 j 时返回 true （这将与您刚刚在其上方检查的 3 一起统计 - 因此返回满堂彩`true`。您需要：

```
boolean foundTwo = false;
for (int j = 0; j < temp.length ; j++) 
  if ( temp [j] == 2){ 
    foundTwo = true; 
  }
} 
if (!foundTwo) {
  return false;
} 
```

另一个类似：您需要检查是否找到另一个与您已经找到的不同的 2：

```
for (int i = 0; i< temp.length; i++) {  
  if (temp [i] == 2 ){
    boolean foundAnother = false;
    for (int j = 0; j< temp.length; j++) { 
      if (i != j && temp [j] == 2 ){
        foundAnother = true;  
      }  
    }
    if (!foundAnother) {
      return true;
    }
  }  
}
return false; 
```

您可以做的另一件事是为每只已识别的手设置过滤器：一对过滤器、一个三过滤器、一个全屋过滤器等，并通过手部运行所有这些过滤器。不要担心是否有更好（更高的值）匹配，只需查看哪些过滤器返回 true（找到他们正在寻找的模式）并在通过的过滤器中选择最高点值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T01:37:54.173

在您的 threeOfAKind 方法中，第二个 for 循环只会执行一次，除非您的数组中存储的第一个数字是 2，它应该看起来更像这样：

```
public boolean hasThreeOfAKind() {
    int [] temp;
    temp = this.getCounts();
    for (int i = 0; i< temp.length; i++){
        if (temp [i] == 3 ){
            for (int j = 0; j < temp.length ; j++)
                if ( temp [j] == 2){
                    return false;
                }
        }
    }
    return true;
} 
```

在上面的代码中，当它第一次击中一对时，它意识到这手牌是满屋，而不是同类型的三，并返回 false。

至于你的其他方法 hasOnePair() 它应该看起来更像：

```
public boolean hasOnePair() {
    int [] temp;
    temp = this.getCounts();
    int count = 0;

    for (int i = 0; i< temp.length; i++){
        if (temp [i] == 2  ){
            count++;
        }
    }
    return count == 1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-29T00:54:56.177

查找每张相似卡片的数量并制作数组。SO 牌{1,1,2,2,2,5,7}（让我们暂时忽略花色）将映射到 (3,2,1,1) 即满屋，您可以轻松检查第二个数组

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-03T01:13:03.817

我正在帮助我儿子解决大学 Java 课程（我曾经教过的课程）的类似问题，这就是我的建议。

首先将您的牌从最低到最高 2 排序为 Ace，无论花色如何。然后进行比较。如果 card[0]==card[3] 或 card[1]==card[4]，你有 4 个，忽略接下来的 2 行。如果 card[0]==card[2] or card[1]==card[3] or card[2]==card[4]，你有 3 个，忽略下一行。如果 card[0]==card[1] or card[1]==card[2] or card[2]==card[3] or card[3]==card[4]，你有一对。

# php - 如何清除字符串php中某个字符后的所有内容？

> ID：10359783
> 
> 赞同：2
> 
> 时间：2012-04-28T01:26:01.457
> 
> 标签：php, preg-replace, preg-match

我几乎没有什么功能可以清理 get 和 post 中的所有内容，但是这个必须更具体一些，我有一个生成链接的数组，例如

```
array(
  1 => http://site/something/another/?get_something=1
  2 => http://site/something/another2/?get_something=1
) 
```

还有一个清理 get 和 post 的函数，但该函数会清除这个数组值中的所有内容，所以我只剩下

httpssitesomethinganotherget_something1

有人可以帮忙匹配之后`get_something=` 的所有内容并清除它或用 get_something=1 替换它，比如

```
$clear = preg_match('/^[A-Za-z0-9]+$/', $array[1]);
preg_replace("/get_something=".$clear."/i","",$array[1]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:29:01.777

你应该使用`parse_url`，但这里是一个正则表达式实现，以防你好奇：

```
$urls = array
(
    'http://site/something/another/?get_something=1',
    'http://site/something/another2/?get_something=1',
    'http://site/something/another/?get_something=1&foo=bar',
    'http://site/something/another/?foo=bar&get_something=1',
);

$urls = preg_replace('~[?&]get_something=.*$~i', '', $urls);

print_r($urls); 
```

应该输出（[演示](http://codepad.org/Fa5aKJwT)[[更新](http://codepad.org/a9fU4yhv)]）：

```
Array
(
    [0] => http://site/something/another/
    [1] => http://site/something/another2/
    [2] => http://site/something/another/
    [3] => http://site/something/another/?foo=bar
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:37:53.167

如果您尝试解析 URL，最好的办法是使用`parse_url`，删除不需要的查询元素，然后使用`http_build_url`. 这是我的做法：

```
for($i = 0; $i < count($linkArray); $i++) {
    // get original link and parse it
    $link = parse_url($linkArray[$i]);

    // replace the query portion
    $link["query"] = "get_something=1";

    // build the new URL
    $linkArray[$i] = $link["scheme"] . "://" . $link["hostname"] . $link["path"] . "?" . $link["query"] . "#" . $link["fragment"]

    // done
} 
```

# php - 我意想不到的 T_STRING 在哪里？

> ID：10359787
> 
> 赞同：0
> 
> 时间：2012-04-28T01:26:44.213
> 
> 标签：php, eval

通常，人们会认为意外的 T_STRING 意味着缺少分号。但是，在这种情况下，分号从哪里丢失？

```
 global $lay;
        $yal = eval("return '$lay';");
        echo $yal . "\n"; 
```

错误在 eval 中抛出，即

```
Parse error: syntax error, unexpected T_STRING in ... BOGARIP.php(140) : eval()'d code on line 1 
```

$lay 包含

```
$reportDate\t$heads['Account']\t$id\t$heads['Time zone']\t$heads['Campaign']\t$heads['Ad group']\t$heads['Network']\t$heads['Network (with search partners)']\t\t$heads['Ad group state']\t$heads['Campaign state']\t$heads['Impressions']\t$heads['Clicks']\t$heads['CTR']\t$heads['Avg. CPC']\t$heads['Avg. CPM']\t$heads['Cost']\t$heads['Avg. position'] 
```

这是否意味着该错误实际上是在 $lay 中还是我错过了其他东西？这种级别的字符串替换甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:50:09.043

`eval`一般来说，你真的不应该对 做任何事情。但是，为了这里的技术问题，请考虑以下几点：

```
eval("return '$lay';"); 
```

您`$lay`用单引号将变量括起来。现在让我们看看这个变量的内容：

```
$reportDate\t$heads['Account... 
```

看到问题了吗？您也在值中使用单引号。交换 eval 语句中的引号，这样就不再有冲突：

```
eval('return "$lay";'); 
```

再一次，请不要使用此代码。总的来说，专业人士会引导你远离每一次使用`eval`，因为它会让你的应用程序面临很多潜在的问题。请找到另一种方法来做你正在尝试的任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T01:52:08.070

接受@Evert 的建议并进行了重构。现在格式包含

```
%DATE%\t%Account%\t%ID%\t%Time zone%\t%Campaign%\t%Ad group%\t%Network%\t%Network (with search partners)%\t\t%Ad group state%\t%Campaign state%\t%Impressions%\t%Clicks%\t%CTR%\t%Avg. CPC%\t%Avg. CPM%\t%Cost%\t%Avg. position% 
```

和代码

```
 $heads["ID"] = $id;
    $heads["DATE"] = $reportDate; 
```

...

```
 global $lay;
    $layout = $lay;
    foreach ($heads as $key => $value) {
        $layout = str_replace("%" . $key . "%", $value, $layout);
    }
    $layout = str_replace("\\n", "\n", $layout);
    $layout = str_replace("\\t", "\t", $layout); 
```

# java - 一个包含最多 N 个项目的 LIFO 数据结构

> ID：10359802
> 
> 赞同：2
> 
> 时间：2012-04-28T01:29:07.477
> 
> 标签：java

在 java 中，哪个 LIFO 数据结构类允许我指定一个 MAX 项目大小，只要添加一个项目会导致它超过 MAX 大小，它就会自动丢弃旧项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T01:36:56.367

您可以子类`Stack`化以获得所需的行为。您只需要覆盖`push()`以检查大小是否大于 N，并丢弃旧项目：

```
@Override
public void push(E elt) {
    super.push(elt);
    while (this.size() > this.maxSize) {
        this.removeElementAt(this.size() - 1);
    }
} 
```

可能会接近你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T03:08:32.920

Java中没有这样的结构。我希望这个自定义实现满足您的需求：

```
 BlockingDeque<Object> deque = new LinkedBlockingDeque<Object>(32) {
        public void push(Object e) {
            final java.util.concurrent.locks.ReentrantLock lock;
            try {
                Field lockField = LinkedBlockingDeque.class.getDeclaredField("lock");
                lockField.setAccessible(true);
                lock = (ReentrantLock) lockField.get(this);
            } catch (NoSuchFieldException e1) {
                throw new RuntimeException(e1);
            } catch (SecurityException e1) {
                throw new RuntimeException(e1);
            } catch (IllegalArgumentException e1) {
                throw new RuntimeException(e1);
            } catch (IllegalAccessException e1) {
                throw new RuntimeException(e1);
            }
            lock.lock();
            try {
                if (!offerFirst(e)) {
                    pollLast();
                    offerFirst(e);
                }
            } finally {
                lock.unlock();
            }
        }
    }; 
```

然后你像 Stack 一样使用它（Deque 替换了旧的 Stack 类）：

```
 deque.push(new Object());
    Object o = deque.pop(); 
```

对不起所有的锁东西，但需要避免不一致。

# linux - 玩弄 LD_LIBRARY_PATH

> ID：10359807
> 
> 赞同：0
> 
> 时间：2012-04-28T01:29:34.210
> 
> 标签：linux, gcc, ld, ld-preload

[我最近](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)阅读了这篇文章，并尝试通过执行以下操作来覆盖 libc printf 函数：-

*   创建一个使用 printf 打印的可执行文件`this is a test`(printer.c)
*   创建一个带有自定义放置打印的 c 文件`muhahaha, this is a test`(custom.c)
*   创建目标文件`gcc -fPIC -g -c -Wall custom.c`
*   创建so文件`gcc -shared -Wl,-soname,libmystuff.so.1 -o libmystuff.so.1.0.1 custom.o`
*   我将包含 so 文件的目录添加到 LD_PRELOAD 环境变量中。`export LD_PRELOAD=$(pwd)`
*   尝试运行打印机

我想那`muhahaha, this is a test`会被打印出来，但似乎我做错了什么。我有什么概念错了吗？还是我只是做错了什么？

[编辑]

涉及的代码片段是： -

```
// printer.c
int main() {
printf("this is a test");
return 0;
}

// custom.c
void printf(char *t) {
puts("muhahaha, this is a test");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:32:58.293

您应该在 LD_PRELOAD 环境变量中命名库，而不是目录。

```
export LD_PRELOAD=/path/to/libmystuff.so.1.0.1 
```

# opencv - OpenCV：cvContourBoundingRect 给出“未找到符号”，而其他轮廓函数工作正常

> ID：10359810
> 
> 赞同：0
> 
> 时间：2012-04-28T01:29:39.333
> 
> 标签：opencv, detection, region, contour

注意：StackOverflow 不会让我回答我自己的问题，所以我在这里回答。请滚动到底部以查看我的答案。

问题给定一个二值图像，我希望能够确定哪个区域具有最大的 y 坐标，即哪个区域最接近底部。在下面的函数中，我尝试使用轮廓和边界矩形来获得我需要的答案。但是，我使用函数 cvContourBOundingRect 在编译过程中会出现以下错误消息：

```
"_cvContourBoundingRectemphasized", referenced from: 
GetLowestContourBoundingRectangle(_IplImage * img, bool) 
in main.o. Symbol(s) not found. Collect2: Id returned 1 exit status. 
Build Failed. 
```

这很奇怪，因为我已经成功地使用了其他轮廓函数，如 cvFindContours 和 cvContourArea 没有任何麻烦。我尝试在 Google 上进行一些搜索，但没有任何结果。如果有人能指出我正确的方向，我将不胜感激。

提前致谢。

```
CvRect GetLowestContourBoundingRectangle(IplImage *img, bool invertFlag) {
    // NOTE: CONTOURS ARE DRAWN AROUND WHITE AREAS
    IplImage *output = invertFlag ? cvCloneImage(InvertImage(img)) : cvCloneImage(img); // this goes into find contours and is consequently modified

    // find contours
    CvMemStorage *contourstorage = cvCreateMemStorage(0);
    CvSeq* contours = NULL;
    cvFindContours(output, contourstorage, &contours, sizeof(CvContour), CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE);

    // analyze each contour
    int lowestRectangleCoordinate = 0;
    CvRect currentBoundingRectangle;
    CvRect lowestBoundingRectangle;

    while (contours) {
        currentBoundingRectangle = cvContourBoundingRect(contours);
        if (currentBoundingRectangle.y + currentBoundingRectangle.height > lowestRectangleCoordinate) {
            lowestRectangleCoordinate = currentBoundingRectangle.y + currentBoundingRectangle.height;
            lowestBoundingRectangle = currentBoundingRectangle;
        }

        contours = contours->h_next;
    }

    cvReleaseMemStorage(&contourstorage);
    return lowestBoundingRectangle;
} 
```

回答： 好的，具有讽刺意味的是，我在起草我的原始问题后不久就发现了它为什么会中断（尽管公平地说，此时我已经为此苦苦挣扎了几个小时）。

我查找了定义以下三个函数的头文件：

1.  cvFindContours——imgproc_c.h
2.  cvContourArea -- imgproc_c.h
3.  cvContourBoundingRect——compat.hpp

compat.hpp 显然是为了向后兼容而保留的已弃用功能。这是标题中写的内容：

```
/*
   A few macros and definitions for backward compatibility
   with the previous versions of OpenCV. They are obsolete and
   are likely to be removed in future. To check whether your code
   uses any of these, define CV_NO_BACKWARD_COMPATIBILITY before
   including cv.h.
*/ 
```

话虽如此，有谁知道我如何才能真正用非过时的定义编写这个函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:08:12.513

关于您最初的问题“OpenCV：cvContourBoundingRect 给出“未找到符号””。

用于链接该（已弃用）方法的库是这个：

libopencv_legacy.so

# python - 随着应用程序的进展逐步建立一组记录

> ID：10359815
> 
> 赞同：2
> 
> 时间：2012-04-28T01:31:10.813
> 
> 标签：python, data-structures

我有一个系统管理员类型的 CLI 应用程序，它从配置文件中读取信息。我无法更改以下配置文件的格式。

```
TYPE_A = "value1,value2,value2"
TYPE_A = "value3,value4,value5"
TYPE_B = "valuex,valuey,valuez" 
```

基于`TYPE`，我需要对每一个进行一些初始处理。在我完成所有步骤之后，我需要做一些额外的处理，并根据选择的选项打印状态和预期的操作或执行这些操作。

我想将配置初始解析为字典列表的字典，并使用所有相关信息更新 , , 等的`TYPE_A`每个`TYPE_B`实例。`TYPE_C`然后打印完整状态或执行操作（如果某些状态不正确，则失败）

我的想法是它看起来像：

```
dict
    TYPE_A_list
        dict_A[0] key:value,key:value,key:value
        dict_A[1] key:value,key:value,key:value
    TYPE_B_list
        dict_A[0] key:value,key:value,key:value
        dict_A[1] key:value,key:value,key:value 
```

我想我想将配置读入其中，然后随着应用程序的进展添加键和值或更新值并重新处理每个类型。

最后我的问题。

1.  我不确定如何迭代每个字典列表或添加列表元素并添加或更新键：值对。
2.  我上面描述的是否是解决此问题的最佳方法？

我对 Python 还很陌生，所以我愿意接受任何建议。FWIW，这将是 python 2.6。

关于配置文件行的一点说明

```
    CAR_TYPE = "福特,野马,蓝色,2005"
    CAR_TYPE = "本田,雅阁,绿色,2009"
    BIKE_TYPE = "本田,VTX,黑色,2006"
    BIKE_TYPE = "Harley,Sportster,Red,2010"
    TIRE_TYPE = "170R15，白墙"

```

每种类型将具有相同的顺序和数量的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:58:01.447

无需“记住”有两个不同的`TYPE_A`任务 - 您可以将它们组合起来。

```
TYPE_A = "value1,value2,value2"
TYPE_A = "value3,value4,value5" 
```

将被解析为其中之一或两者都取决于您的系统管理员 CLI 应用程序的实现。

那么数据模型应该是：

```
dict
    TYPE_A: list(value1, value2, value3)
    TYPE_B: list(valuex, valuey, valuez) 
```

这样，您可以`dict.items()`很容易地迭代：

```
for _type, values in dict.items():
    for value in values:
        print "%s: %s" % (_type, value)
        # or whatever you wish to do 
```

# javascript - 有没有办法知道覆盖层的图块是否无法在谷歌地图中加载？

> ID：10359819
> 
> 赞同：1
> 
> 时间：2012-04-28T01:32:06.547
> 
> 标签：javascript, google-maps, google-maps-api-3

我找到[了这个](https://stackoverflow.com/a/7262773/981427)答案，但是即使某些图块无法加载，“空闲”事件也会被触发，有没有办法知道覆盖层的图块是否无法在谷歌地图中加载？

# javascript - nodejs hello world 示例 - 符号查找错误

> ID：10359820
> 
> 赞同：3
> 
> 时间：2012-04-28T01:32:39.983
> 
> 标签：javascript, linux, node.js

**更新——Linux FEDORA 15**

遵循以下示例：

[http://simonwillison.net/2009/Nov/23/node/](http://simonwillison.net/2009/Nov/23/node/)

**我的代码：**

```
var util = require('util'),
    http = require('http');

http.createServer(function(req, res) {
  res.sendHeader(200, {'Content-Type': 'text/html' });
  res.sendBody('<h1>Hello World</h1>');
  res.finish();
}).listen(8080);

util.puts('Server running at http://127.0.0.1:8080'); 
```

**产生以下错误：**

```
[abu@Beelzebub node_projects]$ nodejs helloworld.js
Server running at http://127.0.0.1:8080
nodejs: symbol lookup error: nodejs: undefined symbol: _ZN2v82V816IdleNotificationEv 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:37:44.867

要执行 node.js 应用程序，请使用 node 调用它，而不是 nodejs。

```
node helloworld.js 
```

该特定错误似乎类似于 Node 0.6.15 中的 V8 构建不匹配问题。您是否尝试过使用较新（或回滚到较旧）版本的 Node？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T20:44:25.667

要**在 Fedora Linux 上执行 node.js 安装，**请下载并安装独立 rpm (http://nodejs.tchol.org/stable/f16/SRPMS/repoview/nodejs.html) 并执行如下安装：

1.  使用包管理器删除任何现有的 node 和 nodejs 应用程序

2.  从独立 rpm 安装 node.js

    rpm –ivh ./configure make make install

尝试使用包管理器可能会导致依赖关系问题，如以下站点所述：

[http://nodejs.tchol.org/](http://nodejs.tchol.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T20:50:38.397

这是 2009 年的教程和旧的 api。你应该这样做

```
var http = require('http');
var server = http.createServer(function (request, response) {
  response.writeHead(200, {"Content-Type": "text/plain"});
  response.end("Hello World\n");
});
server.listen(8000);
console.log("Server running at http://127.0.0.1:8000/"); 
```

你的教程很旧:) 切换到这个 ->

[http://howtonode.org/hello-node](http://howtonode.org/hello-node)

# javascript - 让基本的 javascript 工作的问题 [noob here]

> ID：10359824
> 
> 赞同：2
> 
> 时间：2012-04-28T01:32:59.683
> 
> 标签：javascript

所以我正在尝试学习javascript。我浏览了一些教程和指南，但它们通常不会教你如何编写 javascript 来处理网页。

我想学习如何做的是与我最近制作的网站提供一些基本的交互性。虽然它们包含动态内容，但我仍然想要一些 javascript 的交互性。然而，我所有的尝试都是徒劳的，因为没有任何效果。我的最终目标是让我的网站感觉更专业，也许还可以让 node.js 服务器启动并运行一些 ajax 或 websockets 可能会用画布构建一个 2d 游戏，但这要晚得多。

以下代码是我根据阅读的一些 HTML DOM 教程编写的一些基本内容。问题是它根本不起作用。所以谁能告诉我这里发生了什么，为什么它根本不起作用。是的，我的浏览器中确实打开了 javascript。

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<body>
    <p>SomeText</p>
    <script type="text/javascript">
        var ptag = document.getElementById('p');

        function alertclick() {
            alert(this);
        }

        for (i = 0; i < ptag.length; i++){
            var attach = ptag[i];
            attach.addEventListener("click", alertclick, false);
        }

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T01:38:42.247

那是因为您正在使用`getElementById`并且 is 没有带有 id 的元素`p`。而是用于`getElementsByTagName`获取所有`p`元素。

```
var ptags = document.getElementsByTagName('p');

for (var i = 0; i < ptags.length; i++){
     var element = ptags[i];
     element.addEventListener("click", alertclick, false);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T01:40:13.050

作为初学者，有几件事会让你脱颖而出。

1.  JavaScript 在页面加载之前运行时。

2.  在页面中包含 JavaScript 文件的顺序很重要。

3.  您可以做某事的方式的数量。

# 纯 JavaScript：

在您的代码中，我假设您正在尝试访问所有`<p>`标签，您可以使用`getElemenysByTagName('p')`.

如果您想访问单个元素，我建议为它分配一个 ID `<p id="me">SomeText</p>`，然后使用`getElementsById('me')`.

如果你不想访问一组元素，但不是某个类型的所有元素，你应该应用一个类`<p class="group">SomeText</p>`……你可以使用`getElementsByClassName('group')`，但它只在更现代的浏览器中受支持。

对于元素的选择，我强烈推荐使用 jQuery，它使过程更容易和更灵活。[http://jquery.com/](http://jquery.com/)

# jQuery：

使用 jQuery 后，您可以像这样访问元素：

```
$('#me'); //Individual Element by ID
$('.group'); //Group of elements by Class
$('<p>'); //All P elements 
```

jQuery 在创建事件处理程序时也非常出色，因为它简单且跨浏览器兼容性。对于您的 onClick：

[http://api.jquery.com/click/](http://api.jquery.com/click/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-28T01:42:28.140

有一点信心！你快到了。这是我理解您想要的行为：单击段落以提醒其内容。

我们喜欢在问题和答案中展示一个工作演示：http: [//jsfiddle.net/bxvny/](http://jsfiddle.net/bxvny/)

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>
<body>
    <p>SomeText</p>
    <p>SomeText2</p>
    <p>SomeText3</p>
    <script type="text/javascript">
        var ptag = document.getElementsByTagName('p');

        function alertclick() {
            alert(this.innerHTML);
        }

        for (i = 0; i < ptag.length; i++){
            var attach = ptag[i];
            attach.addEventListener("click", alertclick, false);
        }

    </script>
</body>
</html> 
```

# android - 将侦听器添加到 ListView

> ID：10359825
> 
> 赞同：1
> 
> 时间：2012-04-28T01:33:01.920
> 
> 标签：android, sqlite, listview, listener

我已经从 SQLite 数据库创建了一个 ListView，但我一直坚持如何为每个 ListView 项目添加一个侦听器，以便在单击一个项目时我可以显示另一个页面，其中包含有关该项目的更多信息。该数据库只是一个示例。任何帮助，将不胜感激。

```
public class Database extends ListActivity {

private final String SAMPLE_DB_NAME = "myFriendsDb";
//private final String SAMPLE_TABLE_NAME = "friends";

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ArrayList<String> results = new ArrayList<String>();
    SQLiteDatabase db = null;

    try {
        db =  this.openOrCreateDatabase(SAMPLE_DB_NAME, MODE_PRIVATE, null);

        db.execSQL("CREATE TABLE IF NOT EXISTS people" +
                " (LastName VARCHAR, FirstName VARCHAR," +
                " Country VARCHAR, Age INT(3));");

        db.execSQL("INSERT INTO people" +
                " Values ('Jones','Bob','UK',30);");
        db.execSQL("INSERT INTO people" +
                " Values ('Smith','John','UK',40);");
        db.execSQL("INSERT INTO people" +
                " Values ('Thompson','James','UK',50);");

        Cursor c = db.rawQuery("SELECT FirstName, LastName FROM people", null);

        if (c != null ) {
            if  (c.moveToFirst()) {
                do {
                    String firstName = c.getString(c.getColumnIndex("FirstName"));
                    String lastName = c.getString(c.getColumnIndex("LastName"));
                    results.add("" + firstName + " " + lastName);
                }while (c.moveToNext());
            } 
        }

        this.setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,results));

    } catch (SQLiteException se ) {
        Log.e(getClass().getSimpleName(), "Could not create or Open the database");
    } finally {
        if (db != null) 
            db.execSQL("DELETE FROM people");
            db.close();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:02:27.300

有很多方法可以解决您的问题。一种可能的解决方案是：您只需在 ListActivity 中实现受保护的方法 onListItemClick(ListView l, View v, int position, long id)。

```
public class Database extends ListActivity {

    //YOUR CODE ABOVE HERE...

    public static final String SHOWITEMINTENT_EXTRA_FETCHROWID = "fetchRow";
    public static final int ACTIVITY_SHOWITEM = 0; /*Intent request user index*/

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id){
        /*
        position variable holds the position of item you clicked...
        do your stuff here. If you want to send to another page, say another activity
        that shows your stuff, you can always use an intent
        example:
        */
        Intent tmpIntent = new Intent(this, YourActivityForShowingItem.class);
        tmpIntent.putExtra(SHOWITEMINTENT_EXTRA_FETCHROWID, position);
        startActivityForResult(tmpIntent, ACTIVITY_SHOWITEM);

    }
} 
```

或者，您可以使用 getListView() 访问 listActivity 的 ListView，并像使用常规 ListView 对象一样调用侦听器或上下文菜单的设置器。例如，这个使用这种方法设置监听器的函数：

```
private void setMyListListener(){
    getListView().setOnItemClickListener(new OnItemClickListener(){
        @Override
        public void onItemClick(AdapterView<?> a, View v, int position, long id){
            /*same fake code as above for calling another activity using an intent:*/
            Intent tmpIntent = new Intent(this, YourActivityForShowingItem.class);
            tmpIntent.putExtra(SHOWITEMINTENT_EXTRA_FETCHROWID, position);
            startActivityForResult(tmpIntent, ACTIVITY_SHOWITEM);
        }
    });
} 
```

This function can be called by your onCreate(...) function afterwards if you want your click listener to be configured the same way for the whole duration of your activity.

# java - 如何分配对象而不将它们保存在变量中？

> ID：10359830
> 
> 赞同：2
> 
> 时间：2012-04-28T01:33:43.270
> 
> 标签：java

在我的 Java 书中有一个练习要求您：“分配 10000 个 Rational 对象而不将它们保存在变量中，以免它们变成垃圾。”

下面是分配对象而不将它们分配给变量的正确方法吗？

```
 for (int i = 0; i < 10000; i++) {
        new Rational();
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:42:42.770

没错，每个`Rational`都是在没有引用的情况下实例化的，因此随后在某个时候被垃圾收集。Java 没有强制垃圾收集的方法，但您可以调用`Runtime.gc()`来请求垃圾收集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T07:54:13.470

没错，只要构造函数没有保留引用等副作用。

```
class Rational {
    static final List<Rational> IRRATIONAL = new ArrayList<Rational>();

    Rational() {
        IRRATIONAL.add(this);
    }

    static Iterable<Rational> allRationals() {
        return IRRATIONAL;
    }
}

for (int i = 0; i < 10000; i++) {
    new Rational();
}

for(Rational r: Rational.allRationals()) {
    // all still here
} 
```

# login - 无法使用 sp_session_relogin (libspotify)

> ID：10359832
> 
> 赞同：2
> 
> 时间：2012-04-28T01:33:52.237
> 
> 标签：login, spotify

我的问题很简单： sp_session_relogin 是如何工作的？

这是我尝试使用它的方法。

```
bool login(const char* login, const char* password, bool remember)
{
    if (remember) {
        sp_error err = sp_session_relogin(_session);
        if (err==SP_ERROR_OK) {
            return true;
        }
        if (!login||!password) {
            return false;
        }
    }

    sp_session_login(_session, login, password, remember, NULL);
    return true;
} 
```

我第一次调用我的应用程序

```
login(0,0,true); 
```

如果它返回false，我会这样回忆

```
login(username,password,true); 
```

（从 UI 检索用户名和密码）。然后，如果我关闭应用程序并重新启动它，第一次登录调用继续返回 false。

**在 iKendac 回答后编辑**

我正在调用 sp_session_logout() 但我没有等待调用注销回调。我有它，但它不是更好。这是我的应用程序的结束方式

```
if (_session) {
    if (_loggedin) {
        char buffer[1024];
        int ret = sp_session_remembered_user(_session,buffer,sizeof(buffer)); 
        if (ret>0) {
            printf("remembered user: %s\n",buffer);
        }
        sp_session_logout(_session);
        int msTilNext = 0;
        while(_loggedin) {
            sp_session_process_events(_session, &msTilNext);
        }
    }

    sp_session_release(_session);
    _session = 0;
} 
```

sp_session_remembered_user 正确返回我的用户名。注销后，我正在等待使用 sp_session_process_events 调用注销回调处理事件。调用注销回调时，_loggedin 变为 false，因此循环结束。我释放会话。和相当的应用程序。

你看到另一个错误或丢失的东西吗？任何想法 ？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T14:07:13.140

当您退出应用程序时，请确保您调用`sp_session_logout()`并等到注销完成回调被触发，然后才允许应用程序终止。否则你可能会得到一个不完整的缓存，这将导致`sp_session_relogin()`失败。

# sql - 如果参考表中包含特定字段，则将表与参考表进行比较并更新值

> ID：10359838
> 
> 赞同：0
> 
> 时间：2012-04-28T01:35:43.037
> 
> 标签：sql, ms-access

如果关键字出现在另一个参考表中，我有两个表需要比较和更新一个表中的值。

**A**是一个数据表，其中包含个人列表，其中姓氏和名字具有单独的字段。

**B**是另一个参考表，其中包含已定义的具有姓氏和名字的个人列表。

我正在 Access 中编写一个更新查询来检查表 A 中的个人以查看他们是否列在表 B 中并更新 A 中的一个字段以指示他们是否列在表 B 中。我使用的条件是如果两个表中的姓和名相同，则匹配就足够了。问题是名称字段表 A 可能包含不在参考表 B 中的附加信息（例如标题或凭据），该表仅列出了名字和姓氏。我无法控制表 A 中的数据，但需要尽可能根据类似标准进行连接。

我不确定如何在 SQL 中表达以下内容。我希望下面的伪代码能解释我想要完成的事情：

```
UPDATE A
    SET A.[isinB]=true
WHERE

A.[lastname] contains B.[lastname]
and
A.[firstname] contains B.[firstname] 
```

例子：

```
A.[lastname] = SMITH MD PHD
A.[firstname] = JOHN M

B.[lastname] = SMITH
B.[firstname] = JOHN 
```

在此示例中，我希望将其视为匹配项，并将 A.[isinB] 设置为 true。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T02:02:02.920

在 Access 中，您可以进行通配符比较：

```
UPDATE A SET A.[isinB]=true
WHERE
B.[Firstname] Like "*" & A.[Firstname] & "*" AND B.[Lastname] Like "*" & B.[Lastname] 
```

书挡“ *”的通配符指示 Access 在“喜欢”引用的字段中的任何位置查找字符串，例如。“JOHN”在“JOHN M”之内将返回真。您可能需要考虑仅指定第一个“* ”，具体取决于您的数据。

# objective-c - OS X 10.7 动画确实停止了选择器

> ID：10359842
> 
> 赞同：1
> 
> 时间：2012-04-28T01:36:41.133
> 
> 标签：objective-c, macos, nsview

我试图弄清楚如何在我的 nsview 动画师停止时设置回调。有人知道怎么做吗。

```
NSRect frame = blob.frame;
frame.origin.x = animationStopX;
[NSAnimationContext beginGrouping];
[[NSAnimationContext currentContext] setDuration:timeToDisappear];
[[blob animator] setFrame:frame];
[NSAnimationContext endGrouping]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T19:21:40.310

在 10.8 上，`NSAnimationContext`具有[`completionHandler`](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSAnimationContext_class/Introduction/Introduction.html)可与块一起使用的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T20:19:40.950

您可以为 frameOrigin 动画设置委托。

```
CAAnimation *moveAnimation = [[blob animationForKey:@"frameOrigin"] copy];
moveAnimation.delegate = self;
[blob setAnimations:[NSDictionary dictionaryWithObject:moveAnimation forKey:@"frameOrigin"]];
[moveAnimation release]; 
```

并覆盖结束动画委托​​方法

```
- (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag 
```

# php - 当失败发生时，试图在 PHP 脚本中停止电子邮件警报。

> ID：10359843
> 
> 赞同：0
> 
> 时间：2012-04-28T01:36:46.753
> 
> 标签：php, mysql, email, if-statement, exit

我刚刚发现即使出现错误（reg_add_fail.php），我仍然会收到一封电子邮件。如果客户端被定向到 reg_add_fail.php，是否可以阻止脚本向我发送电子邮件？使困惑...

我简化了脚本以浓缩。

非常感谢。

埃里克

```
<?

$to = 'newreg@41q.org';
$subject = 'New Homeless Connection';
$msg = "<html>
<head>
<title>New Homeless Connection</title>
</head>

<body>
<table cellspacing=\"0\" cellpadding=\"10\" border=\"1\" align=\"left\">
<tr>
<td align=\"left\" width=\"150px\">Registery No.:</td>
<td align=\"left\"> $reg</td>
</tr>
<tr>
<td align=\"left\">First Name:</td>
<td align=\"left\">$first_name </td>
</tr>
<tr>
<td align=\"left\">Connection Date:</td>
<td align=\"left\"$>$connect_date</td>
</tr>
 <tr>
<td align=\"left\" colspan=\"2\">http://www.41q.org/admin/</td>
</tr>
</table>
<br>
<br>
</body>
</html>
";

// Make sure to escape quotes

$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'From: Homeless' . "\r\n";

mail($to, $subject, $msg, $headers);

date_default_timezone_set('America/Los_Angeles');
$submit_date = date("m/d/y g:i A") ; 

$order = "INSERT INTO reg_add (submit_date, 
connect_date, 
reg, 
first_name, 
)

VALUES

('$submit_date',
'$_POST[connect_date]', 
'{$_POST[reg]}nv', 
'$_POST[first_name]')";

$result = mysql_query($order);

if ($result) { 
mail($to, $subject, $msg, $headers);  
$reg =          $_REQUEST['reg'] ; 
$first_name =   $_REQUEST['first_name']; 
header("location: reg_add_success.php?reg=" . urlencode($reg) . "&first_name=" . urlencode($first_name)); 
} 
else { 
header("location: reg_add_fail.php"); 
exit(); // as sugested by John Conde
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:37:56.443

放在`exit()`重定向之后

```
header("location: reg_add_fail.php");
exit(); 
```

仅仅因为您调用`header()`并不意味着脚本立即停止执行。呼唤`exit()`意志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T01:46:57.183

在您的代码中，PHP mail() 函数在 IF 语句之外被调用，因此您总是会收到电子邮件。

要仅在查询运行没有错误时发送电子邮件，请将 mail() 放在 if 语句中！

**PHP**

```
if ($result) { 
  mail($to, $subject, $msg, $headers);  
  $reg =          $_REQUEST['reg'] ; 
  $first_name =   $_REQUEST['first_name']; 
  header("location: reg_add_success.php?reg=" . urlencode($reg) . "&first_name=" . urlencode($first_name)); 
} 
else { 
  header("location: reg_add_fail.php"); 
  exit(); // as sugested by John Conde
} 
```

**编辑显示整个代码：**

```
<?php

// Email Recipient
$to = 'newreg@41q.org';

// Email Subject
$subject = 'New Homeless Connection';

// Email Message
$msg = '
<html>
  <head>
    <title>New Homeless Connection</title>
  </head>
  <body>
    <table cellspacing="0" cellpadding="10" border="1" align="left">
      <tr>
        <td align="left" width="150px">Registery No.:</td>
        <td align="left">'.$reg.'</td>
      </tr>
      <tr>
        <td align="left">First Name:</td>
        <td align="left">'.$first_name.'</td>
      </tr>
      <tr>
        <td align="left">Connection Date:</td>
        <td align="left">'.$connect_date.'</td>
      </tr>
      <tr>
        <td align="left" colspan="2"><a href="http://www.41q.org/admin/" title="">http://www.41q.org/admin/</a></td>
      </tr>
    </table>
    <br>
    <br>
  </body>
</html>';

// Email Headers
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'From: Homeless' . "\r\n";

date_default_timezone_set('America/Los_Angeles');
$submit_date = date("m/d/y g:i A") ; 

// Prepare Database Query
$order = "
  INSERT INTO reg_add (
    submit_date,
    connect_date,
    reg,
    first_name
  )
  VALUES (
    '".$submit_date."',
    '".$_POST['connect_date']."', 
    '".$_POST['reg']."nv', 
    '".$_POST['first_name']."'
  )";

// Query Database
$result = mysql_query($order);

// Check If the result is valid
if ($result) { 

  // send email
  mail($to, $subject, $msg, $headers);  

  // prepare and direct the user to the reg_add_success Page
  $reg =          $_REQUEST['reg'] ; 
  $first_name =   $_REQUEST['first_name']; 
  header("location: reg_add_success.php?reg=" . urlencode($reg) . "&first_name=" . urlencode($first_name)); 

} 
else {

  // send the user to the reg_add_fail Page
  header("location: reg_add_fail.php"); 

  // exit from the script
  exit();

}

?> 
```

# vim - 匹配 vimscript 中的部分文件类型

> ID：10359844
> 
> 赞同：1
> 
> 时间：2012-04-28T01:36:51.307
> 
> 标签：vim, viml

我有一个文件`jasmine.coffee`在 VIM 中被识别，但`&filetype=='coffee'`评估为假。

有没有办法在 Vimscript 中进行部分文件类型匹配

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T02:32:27.783

请改用`=~`模式匹配运算符，它将右侧视为要测试的正则表达式。

```
&filetype =~ 'coffee' 
```

Vimscript 文档[的条件部分](http://vimdoc.sourceforge.net/htmldoc/usr_41.html#41.4)中提到了这一点。

# arrays - AS3：对数组进行降序排序，同时保持字符串的正确顺序

> ID：10359846
> 
> 赞同：0
> 
> 时间：2012-04-28T01:37:34.297
> 
> 标签：arrays, actionscript-3

我不确定是否有一个简单的答案，但我假设没有，因此我在这里。

基本上，我想运行一个非常简单的高分表，它记录游戏的高分，但也在每个分数旁边显示正确的名称。

这一切都很容易，但我希望能够只用一个数组来做到这一点。

例如，我有这个代码：

```
var d:Array;
var e:Array;
d = "827-Harry".split("-");
d.push("918-John".split("-"));
trace(d) 
```

正确地导致了这个跟踪：

827，哈利，918，约翰

我的问题是，我怎样才能使用 Array.sort() （或类似的）以产生以下内容：

d = 918，约翰，827，哈利

它不能特定于这个例子。也就是说，它需要使用自定义名称和动态分数。

提前干杯！哈利。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T02:05:52.530

创建一个关联数组并使用[sortOn()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html#sortOn%28%29)：

```
var highscores:Array = new Array();
highscores.push({score: 827, player: "John"});
highscores.push({score: 918, player: "Harry"});
highscores.sortOn("score", Array.DESCENDING | Array.NUMERIC);

for (var i:int = 0; i < highscores.length; i++)
{
    trace(highscores[i].score, highscores[i].player);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T02:28:00.240

不建议您像那样存储您的高分，但我不知道您的原因，所以这正是您想要做的事情。

```
public function sortArray(arrUnsorted:Array):Array
{
    var arrLocal:Array = new Array();
    var arrSorted:Array = new Array();

    for (var i:int = 0; i < arrUnsorted.length; i += 2)
    {
        arrLocal.push( { score:int(arrUnsorted[i]), name:arrUnsorted[i + 1] } );
    }

    arrLocal.sortOn("score", Array.DESCENDING | Array.NUMERIC)

    for each(var obj:Object in arrLocal)
    {
        arrSorted.push(String(obj.score), obj.name);
    }

    return arrSorted;
} 
```

然后它很简单：

```
var arrUnsorted:Array = ["827", "Harry", "918", "John"];
var arrSorted:Array = sortArray(arrUnsorted);

trace(arrSorted); // 918,John,827,Harry 
```

希望这就是你所追求的。

# lua - 如何在不使用id的情况下在lua中获取数组值

> ID：10359847
> 
> 赞同：0
> 
> 时间：2012-04-28T01:37:37.900
> 
> 标签：lua, coronasdk

我的lua中有这个数组...

```
local data = {}

data[1] = {}
data[1].title = "Crazy Song"
data[1].subtitle = "by Bruno Earth"
data[1].image = "note.png"

data[2] = {}
data[2].title = "Enter Sunman"
data[2].subtitle = "by Mentalica"
data[2].image = "note.png"

data[3] = {}
data[3].title = "Bitter Child of Mine"
data[3].subtitle = "by Gunz n bullets"
data[3].image = "note.png"

data[4] = {}
data[4].title = "Missed A thing"
data[4].subtitle = "by Ero-Smith"
data[4].image = "note.png"

data[5] = {}
data[5].title = "Pornstar"
data[5].subtitle = "by Nicklefront"
data[5].image = "note.png"

data[6] = {}
data[6].title = "Burner"
data[6].subtitle = "by Asher"
data[6].image = "note.png" 
```

我怎样才能不使用`id`它来获取数组值。我只想得到`title`我的条件语句？

我在我的代码中尝试这个：

```
local getTitle = function(event)
    print (".................")
    print (event.target.id)
    print (event.target.title)
end 
```

但我只有这个...

```
touch: began
touch: ended
.................
2
nil 
```

如何获取和打印`title`我的数组？

这是我的代码：

```
module(..., package.seeall)
display.setStatusBar( display.HiddenStatusBar ) 
function new()
    local localGroup = display.newGroup()
    local tableView = require("tableView")
    local ui = require("ui")

    --------------------------------------------------------------------------
    local screenOffsetW, screenOffsetH = display.contentWidth -  display.viewableContentWidth, display.contentHeight - display.viewableContentHeight

    local songList
    local backBtn
    local detailScreenText

    local background = display.newRect(0, 0, display.contentWidth, display.contentHeight)
    background:setFillColor(0, 0, 0)
    localGroup:insert(background)

    local data = {}
    --iPad: setup a color fill for selected items
    local selected = display.newRect(0, 0, 50, 50)  --add acolor fill to show the selected item
    selected:setFillColor(67,141,241,180)  --set the color fill to light blue
    selected.isVisible = false  --hide color fill until neede

    -----------------------------------------------
    data[1] = {}
    data[1].title = "Crazy Song"
    data[1].subtitle = "by Bruno Earth"
    data[1].image = "note.png"

    data[2] = {}
    data[2].title = "Enter Sunman"
    data[2].subtitle = "by Mentalica"
    data[2].image = "note.png"

    data[3] = {}
    data[3].title = "Bitter Child of Mine"
    data[3].subtitle = "by Gunz n bullets"
    data[3].image = "note.png"

    data[4] = {}
    data[4].title = "Missed A thing"
    data[4].subtitle = "by Ero-Smith"
    data[4].image = "note.png"

    data[5] = {}
    data[5].title = "Pornstar"
    data[5].subtitle = "by Nicklefront"
    data[5].image = "note.png"

    data[6] = {}
    data[6].title = "Burner"
    data[6].subtitle = "by Asher"
    data[6].image = "note.png"

    local topBoundary = display.screenOriginY + 40
    local bottomBoundary = display.screenOriginY + 0

    local getTitle = function(event)
        print (".................")
        print (event.target.id)
        print (event.target.title)
    end

    songList = tableView.newList{
        data=data,
        default="listItemBg.png",
        over="listItemBg_over.png",
        onRelease=getTitle,
        top=topBoundary,
        bottom=bottomBoundary,
        callback = function( row )
            local g = display.newGroup()

            local img = display.newImage(row.image)
            g:insert(img)
            img.x = math.floor(img.width*0.5 + 6)
            img.y = math.floor(img.height*0.5)

            local title =  display.newText( row.title, 0, 0, native.systemFontBold, 16 )
            title:setTextColor(0,0,0)
            g:insert(title)
            title.x = title.width*0.5 + img.width + 6
            title.y = 30

            local subtitle =  display.newText( row.subtitle, 0, 0, native.systemFont, 14 )
            subtitle:setTextColor(80,80,90)
            g:insert(subtitle)
            subtitle.x = subtitle.width*0.5 + img.width + 6
            subtitle.y = title.y + title.height + 6

            return g
        end
     }
    localGroup:insert(songList)
    local function scrollToTop()
        songList:scrollTo(topBoundary-1)
    end

    local navBar = display.newImage("navBar.png")

    navBar.x = display.contentWidth*.5
    navBar.y = math.floor(display.screenOriginY + navBar.height*0.5)
    localGroup:insert(navBar)

    local navHeader = display.newText("Song Lists", 0, 0, native.systemFontBold, 16)
    navHeader:setTextColor(255, 255, 255)
    navHeader.x = display.contentWidth*.5
    navHeader.y = navBar.y
    localGroup:insert(navHeader)

    --backBtn.alpha = 0

    local listBackground = display.newRect( 0, 0, songList.width, songList.height )
    listBackground:setFillColor(255,255,255)
    songList:insert(1,listBackground)

    --Setup the back button
    function changeScene(e)
        if e.phase == 'ended' then
            print ("ok")
            director:changeScene(e.target.scene, "fade")
            print ("back!")

        end
    end

    backBtn = display.newImage("backButton.png")
    backBtn.x = math.floor(backBtn.width/2) + backBtn.width + screenOffsetW
    backBtn.y = navBar.y 
    backBtn.scene = "menu"
    backBtn:addEventListener("touch", changeScene)

    return localGroup
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:12:36.507

i got it... i do this

```
local getTitle = function(event)
    print (".................")
    local id = event.target.id
    print (id)
    print (data[id].title)
end 
```

# android - 如何使 ImageView 和 TextView 居中？

> ID：10359848
> 
> 赞同：0
> 
> 时间：2012-04-28T01:37:42.350
> 
> 标签：android, android-layout

这是我的 layout.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:id="@+id/image1"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:contentDescription="@string/desc"
        android:padding="10dp"
        android:layout_alignParentLeft="true"/>

    <TextView
        android:id="@+id/text1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textColor="#FFF"
        android:layout_toRightOf="@+id/image1"/>

     <ScrollView 
        android:id="@+id/scroll"
        android:layout_width="wrap_content" 
        android:layout_below="@+id/text1"
        android:layout_height="40dp"/>

    <ImageView
        android:id="@+id/image2"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:contentDescription="@string/desc"
        android:padding="10dp"
        android:layout_below="@+id/image1"/>

    <TextView
        android:id="@+id/text2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textColor="#FFF"
        android:layout_below="@+id/image1"
        android:layout_toRightOf="@+id/image2"/>

</RelativeLayout> 
```

我想将 TextView 与上方的 ImageView 居中。我该怎么做呢？

我希望它看起来像这样：

```
<Player_Image> <Player_Name_Points>
<Player_Image> <Player_Name_Points> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T03:11:05.307

![在此处输入图像描述](../Images/dfd9e173acc02bfcd29cdd0061360a5a.png)

```
 <RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <ImageButton
        android:id="@+id/imageButton1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="24dp"
        android:text="TextView" />

</RelativeLayout> 
```

尝试这样做......我想你会得到你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T02:55:54.727

而不是将`ScrollView`a`ListView`与包含图像和文本的自定义项目一起使用`LinearLayout`（其他布局也可以）。用于`wrap_content`宽度和`center`重力。

例如，将适配器绑定`ArrayAdapter`到`ListView`以控制显示的数据。

# objective-c - UIView 子类中的 drawRect 不更新图像

> ID：10359856
> 
> 赞同：0
> 
> 时间：2012-04-28T01:39:04.767
> 
> 标签：objective-c, ios, uiimage, drawrect

我有一个 UIView 子类，我想用它来绘制具有不同混合模式的图像。

代码：

```
@implementation CompositeImageView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

-(void)setBlendMode:(CGBlendMode) composite
{
    blender = composite;
}

-(void)setImage:(UIImage*) img
{
    image = img;
}

- (void)drawRect:(CGRect)rect
{
    NSLog(@"it draws");
    CGContextRef c = UIGraphicsGetCurrentContext();
    CGContextSetBlendMode(c, blender);
    CGContextDrawImage(c, rect, image.CGImage);
}

@end 
```

我用来设置它的代码是：

```
[testImage setImage:[UIImage imageNamed:@"Prayer_Background_Paid"]];
[testImage setBlendMode:kCGBlendModeColor];
[testImage setNeedsDisplay]; 
```

我正在使用界面生成器放置一个大矩形UIView，然后将其类设置为CompositeImageView。但是，它仍然绘制为一个大的白色正方形。即使我注释掉drawRect中的所有内容，它仍然会绘制白色方块。但是，它正在调用 drawRect，因为正在记录“它绘制”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:54:13.583

你确定 kCGBlendModeColor 是你想要的吗？来自苹果文档：

> 将背景的亮度值与源图像的色调和饱和度值结合使用。

似乎如果它是白色背景，混合图像也会显示为白色。

# iphone - 从 XIB 文件中为 ViewController 视图加载自定义 UIView

> ID：10359858
> 
> 赞同：0
> 
> 时间：2012-04-28T01:39:35.473
> 
> 标签：iphone, ios, uiview, interface-builder, xib

我有`WizardSequenceViewController`一个`IBOutlet WizardView *_wizardView`. 在许多`WizardSequenceViewController.xib`文件中，我将`view`插座连接到文件的所有者 - `WizardSequenceViewController`. 我有一个该视图的子视图，该视图的类属性设置为`WizardView`. 我已将其连接`WizardView`到文件所有者中的插座。最后，在我的文件中，`WizardView.xib`我有一个`UILabel`用于测试视图是否正在呈现的文件。当我`WizardSequenceViewController`从标签栏中选择时，我看到 superview`view`而不是 subview `_wizardView`。当我在文件中的`-(id)initWithCoder`方法中设置断点时，`WizardView.m`我看到它停在那里，所以我知道它正在调用该初始化程序（因此它*应该*正在使用 xib 加载该文件）。我已经尝试了许多迭代和变化来让这个东西工作，但我做不到，我快疯了。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T12:08:27.470

来自 Apple 文档“视图控制器基础知识，关于自定义视图控制器”：

> 视图控制器与其视图层次结构中的视图之间的一一对应是关键的设计考虑因素。您不应使用多个自定义视图控制器来管理同一视图层次结构的不同部分。同样，您不应该使用单个自定义视图控制器对象来管理多个屏幕的内容。
> 
> 注意：如果要将视图层次结构划分为多个子区域并分别管理每个子区域，请使用通用控制器对象（从 NSObject 降级的自定义对象）而不是视图控制器对象来管理每个子区域。然后使用单个视图控制器对象来管理通用控制器对象。

也许您不能在视图控制器中进行视图和子视图插座设置。而且我不确定将子视图出口分配给单独的 NSObject 子类是否会起作用，因为您将如何呈现它？您可以使用 initWithFrame 和 addSubview 以编程方式编写子视图，而不是使其成为插座吗？或者，如果您真的想以图形方式设置它，您可以将它分配给单独的视图控制器作为所有者吗？然后顶视图控制器将调用`presentModal`子视图控制器。或者，如果您只需要一个 UILabel 作为子视图，只需将标签添加到主视图？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T09:09:08.537

即使我遇到了类似的问题。但是通过以下链接中给出的步骤解决了它。希望能帮助到你。 [http://blog.yangmeyer.de/blog/2012/07/09/an-update-on-nested-nib-loading](http://blog.yangmeyer.de/blog/2012/07/09/an-update-on-nested-nib-loading)

# windows-xp - 我在 XP 上创建的应用程序无法在 Windows 7 上运行

> ID：10359859
> 
> 赞同：2
> 
> 时间：2012-04-28T01:40:05.203
> 
> 标签：windows-xp, compatibility, windows-7-x64

我正在尝试运行我在工作中创建的应用程序（我向自己发送了 .exe 文件），以便查看它在 Windows 7 上的外观。

不过，我的笔记本电脑（运行 64 位 Windows 7）甚至都无法打开它。它会打开一些兼容性向导来尝试纠正问题所在，但这也不起作用。

除了 .exe 本身之外，我还需要什么我应该复制过来的东西吗？

使用 Windows 7 的团队成员可以运行它（无论如何，通过从 Subversion 中检查它并在 VS IDE 中运行它），但如果“关闭”则显示（FlowLayoutPanel 的控件正在经历一种“衣柜故障”）。但是，如上所述，我什至无法运行它。

可能是什么问题/解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T10:32:10.270

如果您运行的是 Windows 7 或更高版本的专业版，那么它将包含安装“Windows XP 虚拟机”的选项。然后，您可以在虚拟机下正常运行您的应用程序，这是解决 Windows 7 中此类问题的最快和最简单的方法。

# python - from nltk import WhitespaceTokenizer 给出 ImportError: No module named nltk

> ID：10359862
> 
> 赞同：0
> 
> 时间：2012-04-28T01:40:14.820
> 
> 标签：python, nltk

我正在尝试使用 Python nltk 对字符串中的单词进行标记，我需要导入以下模块：

```
from nltk import WhitespaceTokenizer
from nltk import WordPunctTokenizer 
```

但它无法导入这些模块：

```
>>ImportError: No module named nltk 
```

我可以`import nltk`并且还`dir(nltk)`向我展示了两个模块：WhitespaceTokenizer、WordPunctTokenizer

有没有人遇到过这个问题？我正在使用 Python 2.6.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-19T21:42:25.807

*安装 nltk：*

```
pip install nltk 
```

**或者您可以从这里下载预编译版本：** [http ://www.lfd.uci.edu/~gohlke/pythonlibs/#nltk](http://www.lfd.uci.edu/~gohlke/pythonlibs/#nltk)

*使用 .whl 文件安装*

```
pip install nltk-3.2.2-py2.py3-none-any.whl 
```

**您的导入声明应为：**

```
from nltk.tokenize import WhitespaceTokenizer, WordPunctTokenizer 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-28T02:11:49.197

以下代码对您有用吗？

```
import nltk
WhitespaceTokenizer = nltk.WhitespaceTokenizer
WordPunctTokenizer = nltk.WordPunctTokenizer 
```

你用的是哪个版本的`nltk`？尝试更新到最新版本。您的代码适用于我的配置（带有 nltk 2.0.1rc4 的 Python 2.7）。

# windows-phone-7 - 在 WP7 中将 azure blob 的内容类型设置为图像

> ID：10359864
> 
> 赞同：1
> 
> 时间：2012-04-28T01:40:23.103
> 
> 标签：windows-phone-7, azure, azure-storage, azure-blob-storage

我正在将手机相机中的照片流上传到 azure。我正在上传`e.ChosenPhoto`这是拍摄照片的流，我正在使用`blob.Metadata["ImageType"] = "image/jpeg";`，但仍然，当照片上传时，内容被标记为`application/octet-stream`，当我转到 url 时，浏览器下载照片而不是显示它。

我需要做哪些步骤才能使它成为jpg？

编辑：似乎[WAT for WP](http://watwp.codeplex.com/)附带的库-`WindowsPhoneCloud.StorageClient.dll` 根本不支持`blob.Propeties`。（也许是因为 WP 只支持异步调用？）设置内容类型有什么解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T01:46:09.607

尝试设置`blob.Properties.ContentType = "image/jpeg"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T06:24:16.013

除非使用 SAS，否则强烈建议我们使用云服务来上传 Blob。如果我们直接从没有 SAS 的 Windows Phone 上传 blob，我们必须将我们的存储帐户密钥嵌入到 Windows Phone 应用程序中。如果黑客获得了密钥，他将获得对我们 Windows Azure 存储帐户的完全控制权。例如，他可以上传几TB的数据到存储中，并要求我们为数据付费。因此，请尝试在 Windows Azure 中托管服务，而不是尝试从 Windows Phone 上传 blob。我们将图像上传到我们的服务，我们的服务将文件保存在 blob 中。只要我们不在任何响应中返回存储密钥，它就是安全的。

如果我们必须直接从没有 SAS 的 Windows Phone 上传，我们可能需要手动使用 REST API 才能使场景工作。根据[http://watwp.codeplex.com/discussions/352111](http://watwp.codeplex.com/discussions/352111)，WAT 库不允许我们指定内容类型。另外，我想指出，WAT 只是一个工具包。它不是内置的 Windows Azure 组件。

最好的祝福，

明旭。

# matlab - 高斯混合模型组件

> ID：10359866
> 
> 赞同：1
> 
> 时间：2012-04-28T01:40:40.150
> 
> 标签：matlab, cluster-analysis, gaussian, pattern-recognition, mixture-model

我正在尝试使用 matlab 将我的数据拟合到高斯混合模型，但问题是我无法确定执行此操作的最佳组件数量，任何人都可以帮忙！此外，如果已经有构建函数来获得最佳数量，请提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T10:23:57.450

对找到高斯模型混合的最佳分量数量的不同方法的良好评论是：

*   评估混合模型中的组件数量：A Oliveira-Brochado 和 FV Martins 的评论（2005 年）：[可在此处获取](http://www.fep.up.pt/investigacao/workingpapers/05.11.03_wp194_brochadovitorino.pdf)
*   McLachlan 和 Peel (2000) 的有限混合模型第 6 章

PS：我在 Matlab 中没有解决您的问题的方法，但 BIC 标准在 R 包[mclust中实现](http://cran.r-project.org/web/packages/mclust/vignettes/mclust.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-30T10:31:57.897

在 Matlab 中，我们已经有 2 个标准：实现了 AIC 和 BIC。适合 GMM

请参阅代码片段：SRC： http: [//www.mathworks.in/help/stats/gmdistribution.fit.html](http://www.mathworks.in/help/stats/gmdistribution.fit.html)

`AIC = zeros(1,4);`

`obj = cell(1,4);`

```
 `for k = 1:4`

      `obj{k} = gmdistribution.fit(X,k);`

      `AIC(k)= obj{k}.AIC;`

  `end` 
```

`[minAIC,numComponents] = min(AIC);`

`numComponents`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T19:51:08.880

无限高斯混合模型（www.gatsby.ucl.ac.uk/~edward/pub/inf.mix.nips.99.pdf）可以自动学习聚类的数量。

这个页面（http://www.cs.brown.edu/~fwood/code.html）有一些实现它的matlab代码（我没有尝试过代码）。

# debugging - jsdom和Contextify错误

> ID：10359867
> 
> 赞同：1
> 
> 时间：2012-04-28T01:41:55.880
> 
> 标签：debugging, node.js, sysadmin, jsdom

我的节点应用程序在我的 macbook 上运行良好，但是当我在 Rackspace 上发布到我们的服务器时，我收到以下我从未见过的错误（敏感路径替换为 [...]）：

```
[...]/node_modules/jsdom/node_modules/contextify/lib/contextify.js:7
    var ctx = new ContextifyContext(sandbox);
              ^
TypeError: undefined is not a function
    at Contextify ([...]/node_modules/jsdom/node_modules/contextify/lib/contextify.js:7:15)
    at Object.createWindow ([...]/node_modules/jsdom/lib/jsdom/browser/index.js:303:3)
    at Object.windowAugmentation ([...]/node_modules/jsdom/lib/jsdom/browser/index.js:63:24)
    at Object.parentWindow ([...]/node_modules/jsdom/lib/jsdom/browser/index.js:605:28)
    at Object.<anonymous> ([...]/node_modules/jsdom/lib/jsdom.js:81:15)
    at [...]/node_modules/jsdom/lib/jsdom.js:170:52
    at Request._callback ([...]/node_modules/jsdom/lib/jsdom.js:275:9)
    at Request.callback ([...]/node_modules/request/node_modules/request/main.js:119:22)
    at Request.<anonymous> ([...]/node_modules/request/node_modules/request/main.js:525:16)
    at Request.emit (events.js:67:17) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T00:02:15.780

需要编译 Contextify 以创建 .node 二进制文件。这些是用 jsdom 预先构建的。它在我的 mac 上运行良好，但在我发布到的 ubuntu 服务器上却不行。根据 github 页面上的说明在服务器上重建 contextify 为我解决了这个问题。

# c# - 如何使用 C# 编写 cookie

> ID：10359868
> 
> 赞同：1
> 
> 时间：2012-04-28T01:42:18.353
> 
> 标签：c#, nullreferenceexception, setcookie, httpcookie

我在文本文件中有字符串，我想将其保存为 cookie。但是，我的代码抛出了一个`System.NullReferenceException`. 我该如何解决？

这是我的代码：

```
public static bool SetCookie(string cookiename, string cookievalue, int iDaysToExpire)
{
    try
    {
         HttpCookie objCookie = new HttpCookie(cookiename);
         HttpContext.Current.Response.Cookies.Clear();
         HttpContext.Current.Response.Cookies.Set(objCookie);
         objCookie.Values.Add(cookiename, cookievalue);
         DateTime dtExpiry = DateTime.Now.AddDays(iDaysToExpire);
         HttpContext.Current.Response.Cookies[cookiename].Expires = dtExpiry;

    }
    catch (Exception e)
    {
        System.Console.WriteLine(e);
        return false;
    }
    return true;
} 
```

# c++ - 删除节点的 C++ 二叉搜索树错误

> ID：10359873
> 
> 赞同：0
> 
> 时间：2012-04-28T01:42:59.123
> 
> 标签：c++, binary-search-tree

我正在从二叉搜索树中删除节点，并且在此函数的 while 循环之后不断收到段错误错误。如果可以的话，请帮助我发现任何错误。

这是功能：

```
void deleteNode()
   {
      int key;
      nodePtr location = NULL, parent = NULL;

      cout << "Enter account number to delete: ";
      cin >> key;
      cout << endl << endl;

      bool found = searchTree(key, &location, &parent);

      if (!found)
      {
         cout << "Error! Account number: " << key << " was not found."
         << endl << endl;
      }
      else if (location->left != NULL && location->right != NULL)
      {  //delete node with left and right subtrees
         nodePtr leftmost = location->right, leftmostParent = NULL;

         while (leftmost->left != NULL)
         {
            leftmostParent = leftmost;
            leftmost = leftmost->left;
         }

         leftmost->left = location->left;

         if (location->right != leftmost)
            leftmost->right = location->right; cout << "1" << endl;

         if (parent != NULL)
         {
            if (parent->acctNum > location->acctNum)
               parent->left = leftmost;
            else
               parent->right = leftmost;
         }

         leftmostParent->left = NULL;

         delete location;
         location = NULL;
      }
      else if (location->left != NULL && location->right == NULL)
      {  //delete node with only a left subtree
         if (parent->acctNum > location->acctNum)
            parent->left = location->left;
         else
            parent->right = location->left;

         delete location;
         location = NULL;
      }
      else if (location->left == NULL && location->right != NULL)
      {  //delete node with only a right subtree
         nodePtr leftmost = location->right, leftmostParent = NULL;

         while (leftmost->left != NULL)
         {
            leftmostParent = leftmost;
            leftmost = leftmost->left;
         }

         leftmost->right = location->right;
         leftmostParent->left = NULL;

         if (parent->acctNum > location->acctNum)
            parent->left = leftmost;
         else
            parent->right = leftmost;

         delete location;
         location = NULL;
      }
      else
      {  //delete a leaf node
         if (location->acctNum > parent->acctNum)
            parent->right = NULL;
         else
            parent->left = NULL;

         delete location;
         location = NULL;
      }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:13:25.687

我在这里看到一个问题

```
nodePtr leftmost = location->right, leftmostParent = NULL;

while (leftmost->left != NULL)
{
    leftmostParent = leftmost;
    leftmost = leftmost->left;
} 
...

leftmostParent->left = NULL; 
```

如果 location->right 是一个叶子，那么 leftmostParent 永远不会被设置并且仍然指向 NULL；段错误也会如此。

# python - 非常基本的格式问题

> ID：10359875
> 
> 赞同：1
> 
> 时间：2012-04-28T01:43:24.693
> 
> 标签：python, formatting

如果我有如下列表：

```
[(10, 20), (50, 60), (100, 110)] 
```

我怎么能让这个看起来像这样：

```
'10-20,50-60,100-110' 
```

如果我列表中的对数是可变的？

我很抱歉这么简单的问题。但是我尝试过的每一件事，比如用“-”替换“，”都失败了。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T01:47:19.397

```
>>> x = [(10, 20), (50, 60), (100, 110)]
>>> ','.join('-'.join(map(str, t)) for t in x)
'10-20,50-60,100-110' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T02:00:02.983

进行这种格式化的另一种（更具可读性）方法是使用

A) % 样式字符串格式：

```
data = [(10, 20), (50, 60), (100, 110)]

fmt = "%d-%d, %d-%d, %d-%d" % (data[0][0], data[0][1], data[1][0], data[1][1],...) 
```

或者，使用列表理解：

```
fmt = ",".join("%d-%d" % i for i in data) 
```

B）python`string.format`方法：

```
fmt = ",".join("{0}-{1}".format(*i) for i in data) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T01:45:19.243

这是你要找的吗？

```
data = [(10, 20), (50, 60), (100, 110)]
for x in data:
    print x[0], "-", x[1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T02:25:47.457

您可以在理解内迭代列表时解压列表的值：

```
>>> x = [(10, 20), (50, 60), (100, 110)]
>>> ','.join('%d-%d' % (y,z) for (y,z) in x)
'10-20,50-60,100-110' 
```

# javascript - getElementById('___').innerHTML 销毁元素的 ID？

> ID：10359876
> 
> 赞同：0
> 
> 时间：2012-04-28T01:43:37.370
> 
> 标签：javascript, innerhtml

我正在努力做到这一点，以便当用户单击导航菜单时，标题会更改为该标题，并且主要内容也会更改。我宁愿尝试避免为此使用框架。

```
$('op').click(function(){
    document.getElementById('title').innerHTML=this.innerHTML + ((this.innerHTML.indexOf("'s")==this.innerHTML.length-2) ? " " : "'s ") + this.parentNode.id + " | Le Lepids";
    document.getElementById('content').innerHTML=document.getElementById(this.innerHTML + '_' + this.parentNode.id).innerHTML;
});
// If the code looks ugly and you can't read it, just tell me. 
```

但是，发生的情况是标题每次都会完美更改，但内容只会更改一次。

例如，它第一次可以正常工作，然后在以后的任何其他时间都不能正常工作。

为什么会这样？它会破坏 id 的“内容”吗？我没有使用outterHTML。如果是剂量，为什么标题会变好？

* * *

编辑：好的，所以我想我用几行 PHP 修复了它。但我仍然想知道为什么它不能在我的网站上工作，而 Mia DiLorenzo 所做的工作非常好......除了变量名之外，代码完全相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:54:44.403

这还不是一个完整的答案（我们需要你的 HTML），但我认为这个信息是在回答的步骤上，它不能在评论中传达。

在伪代码中（使其更易于理解），这就是您的代码正在执行的操作：

对于`#content`项目：

1.  获取被点击`op`元素的 innerHTML。
2.  添加`'_'`到该innerHTML。
3.  `op`添加被点击元素的 parentNode.id 。
4.  使用该制造的 id，`document.getElementById()`对其进行查找以查找对象。
5.  获取该对象的 innerHTML 并将该 innerHTML 放入`#content`项目中。

对于`#title`项目：

1.  获取被点击`op`元素的 innerHTML。
2.  如果该 HTML 以 结尾`"'s"`，则添加`" "`到 innerHTML，否则添加`"'s"`.
3.  将 parentNode.id 添加到上面。
4.  再加`" | Le Lepids"`上。
5.  将`#title`项目的 innerHTML 设置为该结果。

我可以想到为什么该`#content`项目可能总是被设置为同一个项目或为什么它有时只能工作的几个原因，但我们必须查看您的实际 HTML 才能确定何时或为什么会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T02:03:22.467

我不确定你到底想要什么，但我还是写了一些东西[http://jsfiddle.net/69FDT/1/](http://jsfiddle.net/69FDT/1/)

我更改`$('op')`为`$('p')`并添加了一些 div 以匹配您更改的 Javascript 行`content`。你的意思是别的吗？

```
<div id="container">
    <div>Click on these words</div>
      <p>change</p>
      <p>modify</p>
      <p>alter</p>
    <br>
      <div id='title'>Title</div>
      <div id='content'>content</div>
<br>
      <div id="change_container">change placeholder div</div>
      <div id="modify_container">modify placeholder div</div>
      <div id="alter_container">alter placeholder div</div>
    </div>​ 
```

# asp.net-mvc-3 - 如何使用从 Linq 请求收集的实体以表格方式对数据进行排序和显示？

> ID：10359877
> 
> 赞同：0
> 
> 时间：2012-04-28T01:43:45.560
> 
> 标签：asp.net-mvc-3, viewmodel, tabular

如何以类似于表格的格式显示来自以下数据库实体的数据：

```
public class Attendance
{
    public int AttendanceID { get; set; }
    public int CourseID { get; set; }
    public int StudentID { get; set; }
    public int AttendanceDay { get; set; }
    public bool Present { get; set; }
    public virtual Course Course { get; set; }
    public virtual Student Student { get; set; }
} 
```

我想在出勤数据库条目中找到 CourseID == x; 的所有行 所以我会使用类似的东西：

```
AttendanceData = Attendance.Where(s => s.CourseID == x); // I think 
```

然后我需要能够在我的视图中对这些信息进行排序，以便以一种有意义的方式显示它。我希望在屏幕上显示所有当前/不存在值的数据，这些数据在表格中排序，左侧列出了 StudentID，顶部列出了出勤日。

我将如何排序和显示这些信息？

更新：

使用以下代码（连同 Mvc WebGrid）——我可以让某种网格出现在我的视图中。

控制器：

```
IEnumerable<Attendance> model = db.Attendance.Where(s => s.CourseID == 4);
return View(model); 
```

看法：

```
@model IEnumerable<MyProject.Models.Attendance>

<div>
@{
    var grid = new WebGrid(Model, defaultSort: "Name");
}

    @grid.GetHtml()

</div> 
```

但是，网格的组织方式不适合我的需要。

我希望显示的表格顶部显示：

第一天 | 第 2 天 | 第 3 天 | 等等，直到“出勤日”的最大值（在创建学生注册的课程时决定）。

我希望显示表格的左侧显示： Student ID 1 Student ID 5 Student ID 6 Student ID etc 。. 直到数据集中的所有学生都被显示出来。

我想我需要在我的控制器中使用类似的东西：

```
var model = from s in db.Attendance
                        where s.CourseID == 4
                        group s.AttendanceDay by s.StudentID into t
                        select new
                        {
                            StudentID = t.Key,
                            Days = t.OrderBy(x => x)
                        };
return View(model); 
```

但是我需要一个 IEnumerable<> 使用 Mvc WebGrid 返回到我的视图中——我正在到达某个地方，只是在此过程中仍然有点迷失。我可以向正确的方向轻推吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T01:54:23.570

对于一组相当典型的要求，听起来这将是 ASP.NET WebGrid 的一个很好的候选者。它很灵活，允许分页、排序、格式化等。我在一些项目中使用过它，它的工作方式与您可能在 ASP.NET MVC 中使用的任何其他 HTML 帮助程序一样。

[这是一个很好的起点。](http://msdn.microsoft.com/en-us/magazine/hh288075.aspx)

# c# - 在 C# 中实现 TCP/IP JSONRPC 连接 - 需要设计建议

> ID：10359878
> 
> 赞同：2
> 
> 时间：2012-04-28T01:43:53.393
> 
> 标签：c#, tcp, json-rpc

我正在通过 TCP/IP 实现 JSON RPC 连接，但我遇到了一个基本问题。目前我正在使用同步方法，效果很好。

我能发送

```
{"id":1,"jsonrpc":"2.0","method":"Input.Home"} 
```

并收到

```
{"id":1,"jsonrpc":"2.0","result":true} 
```

这没有问题。当我收到通知时会出现问题。这些可能会在任何时候出人意料地到达。我正在与 XBMC JSON RPC API 交互。如果 XBMC 已发送通知，我会同时收到多个 JSON 请求。例如

```
{"jsonrpc":"2.0","method":"GUI.OnScreensaverActivated","params":{"data":null,"sender":"xbmc"}}{"jsonrpc":"2.0","method":"GUI.OnScreensaverDeactivated","params":{"data":null,"sender":"xbmc"}} 
```

这会导致 JSON.NET 崩溃，这是可以理解的。我的第一直觉是我需要异步接收这些通知，这样我就不必等到调用下一个方法来接收它们。然而，这使我上面展示的简单示例变得复杂，因为我不能再使用同步调用。IE

```
SendJson(json);
result = ReceiveJson(); 
```

有没有一种干净的方法来实现它而不会使它过于复杂？任何/所有建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T23:37:18.890

这里是所有阅读的地方。如果你想进入它，这一切都是值得的。 [http://msdn.microsoft.com/en-us/library/ms228969.aspx](http://msdn.microsoft.com/en-us/library/ms228969.aspx)

不过总结一下..

基本上需要发生的是您需要创建一个实现 IAsyncResult 的对象。这将存储有关您的异步操作的状态，以及完成时的回调。

创建一个可以将您的 IAsyncResult 对象作为输入的方法，并且在该方法返回之前，它应该在您的 IAsyncResult 对象上调用 .SetCompleted()。在这种方法中，您可以完成通常所做的工作。

然后，您将创建 IAsyncResult 对象的实例（设置其数据和回调），然后调用 Task.Factory.StartNew([YourNewMethod],[YourInstanceOf IAsyncResult])。

这是需要发生的事情的核心。只要确保设置你的回调并处理异常。

如果您想要一个关于我如何使用异步 http 处理程序来执行 json-rpc 的工作示例，请查看[http://jsonrpc2.codeplex.com/SourceControl/changeset/view/13061#74311](http://jsonrpc2.codeplex.com/SourceControl/changeset/view/13061#74311)以及调用 Process 的位置并且正在设置异步对象[http://jsonrpc2.codeplex.com/SourceControl/changeset/view/13061#61720](http://jsonrpc2.codeplex.com/SourceControl/changeset/view/13061#61720)

希望有帮助。

# java - 如何使用从 JFrame 图标继承的图标创建自己的文件，我设置它，在 java 和我自己的文件中使用 FileOutputStream 和 ObjectOutputStream

> ID：10359883
> 
> 赞同：2
> 
> 时间：2012-04-28T01:44:43.597
> 
> 标签：java, swing, icons, jframe

我想用从 JFrame 图标继承的图标创建我自己的文件，我在 java 中设置它，我自己的文件使用 FileOutputStream 和 ObjectOutputStream

```
try {
    ObjectOutputStream oos;
    //I create own file with own extension in drive D:
    FileOutputStream fos = new FileOutputStream("D:/myFile.ckl");
    oos = new ObjectOutputStream(fos);
    //Write Document in JTextPane to File
    oos.writeObject(jTextPane.getStyledDocument());
    oos.close();
    fos.close();
} catch (Exception exp) {
    JOptionPane.showMessageDialog(null, "" + exp.getStackTrace());
} 
```

先感谢您

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T03:40:26.440

@David 是正确的，主机平台拥有`JFrame`装饰，但您可以利用`JInternalFrame`图标，这些图标通常概括了平台的图标。例如，

```
private static final Icon ICON = (Icon) UIManager.get("InternalFrame.closeIcon"); 
```

[此处](http://www.java2s.com/Tutorial/Java/0240__Swing/CustomizingaJInternalFrameLookandFeel.htm)列举了其他装饰性默认设置。

[SSCCE](http://sscce.org/)：

![在此处输入图像描述](../Images/8164edf28cbfd8b6f1c7579174997d8d.png)

```
import java.awt.EventQueue;
import java.awt.GridLayout;
import javax.swing.BorderFactory;
import javax.swing.Icon;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.UIManager;

/** @see http://stackoverflow.com/a/10360374/230513 */
public class InternalFrameIcons extends JPanel {

    public InternalFrameIcons() {
        this.setLayout(new GridLayout(0, 1, 5, 5));
        this.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        this.add(createLabel("InternalFrame.closeIcon"));
        this.add(createLabel("InternalFrame.maximizeIcon"));
        this.add(createLabel("InternalFrame.minimizeIcon"));
    }

    private JLabel createLabel(String name) {
        Icon icon = (Icon) UIManager.get(name);
        JLabel label = new JLabel(name, icon, JLabel.CENTER);
        label.setHorizontalTextPosition(JLabel.CENTER);
        label.setVerticalTextPosition(JLabel.BOTTOM);
        return label;
    }

    private void display() {
        JFrame f = new JFrame("InternalFrameIcons");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(this);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new InternalFrameIcons().display();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T01:51:19.380

操作系统选择显示文件的图标。将数据写入文件并为其提供文件扩展名（在本例中为“ckl”）是您的工作，但文件最终位于的操作系统取决于给出的图标。

可以在某些文件中嵌入图标（许多可执行文件通常有自己的图标），但最终仍取决于操作系统。

# iphone - 应用程序可执行文件缺少所需的体系结构

> ID：10359884
> 
> 赞同：1
> 
> 时间：2012-04-28T01:44:53.530
> 
> 标签：iphone, xcode, distribution

我正在尝试使用 xcode 4.3 将我的第一个应用程序上传到应用程序商店，但无法克服此错误...“应用程序可执行文件缺少所需的架构。必须至少存在以下架构之一：armv7”我查了一下问题。他们有几篇关于 stackoverflow 的帖子解决了这个问题，但列出的建议都没有奏效。我尝试将 armv6 和 armv7 添加到构建设置中，但错误仍然存​​在。任何建议都会受到欢迎。谢谢。

屏幕截图在这里.. [http://dl.dropbox.com/u/2813968/Build%20Settings.png](http://dl.dropbox.com/u/2813968/Build%20Settings.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T23:46:26.817

至少对于 Xcode 4.5，将部署目标设置为至少 iOS 4.3，这将解决它。早期版本的 iOS 和 armv6 几乎绝迹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T11:44:47.103

1）左键单击项目图标（蓝色图标，在“运行”按钮下）。

2) 在项目图标旁边（在它的右侧），左键单击“项目”下的项目名称（白色背景）。

3）选择选项卡“构建设置”并查找选项卡“仅构建活动架构” -----更改为 -----否

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:47:43.710

确保这些设置与您的**目标**匹配，而不仅仅是您的**项目**设置。

![在此处输入图像描述](../Images/de69a422b2166bb876299b9317e21234.png)

# silverlight - 将网站添加到 Silverlight 权限选项卡

> ID：10359890
> 
> 赞同：1
> 
> 时间：2012-04-28T01:45:52.150
> 
> 标签：silverlight, silverlight-4.0, configuration, permissions, video-streaming

我有一个使用 Silverlight 应用程序通过计算机的网络摄像头拍照的 Intranet 站点。

在开发环境中测试站点可以正常工作，但在 QA 环境中测试站点不会显示任何图像。

在这两个站点上进行更深入的研究后，我发现 Silverlight 权限选项卡已将“允许”定义为开发 URL，但 QA url 根本没有出现在权限选项卡上。

**如何将 QA 站点的 URL 添加到 Silverlight 权限选项卡上的权限选项卡？**

我正在使用 Silverlight 4.0。

感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T09:16:50.097

*   `WIN`+`R`
*   注册表编辑器
*   `HKEY_CURRENT_USER\Software\AppDataLow\Software\Microsoft\Silverlight\Permissions`
*   创建新项目
*   创建新的 Dword
*   名称：`Allow3DOnInsecureDisplayDrivers`，值：`11`

你会得到你想要的。

# php - 确定专辑的 SQL 查询和总视频

> ID：10359892
> 
> 赞同：0
> 
> 时间：2012-04-28T01:46:20.073
> 
> 标签：php, mysql, union

对于我需要做的查询，用户将视频上传到相册，在他们的视频页面上，它有相册列表，以及它下面的视频总数。

目前，我想做的是联合，但这不起作用，这是我的代码：

```
$query="SELECT albname, albcover, lid, NULL as vidcount FROM albums WHERE USERID='".mysql_real_escape_string($USERID)."' and verified='1'

UNION

SELECT NULL as albname, NULL as albcover, NULL as lid, count(*) as vidcount FROM albs_vids A LEFT JOIN albums B USING(ALBID) WHERE B.USERID='".mysql_real_escape_string($UID)."'"; 
```

所以，发生的事情是SQL查询需要从表中找到专辑的数据，即albname、albcover和lid `albums`。然后在表格`albs_vids`中找到与专辑对应的视频数量。专辑`ALBID`在两个表中都由 指定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:09:50.907

很难完全理解您在问什么，但这将为您提供每个具有您的用户 ID 的专辑的视频数量：

```
$sql = "SELECT a.albname, a.albcover, a.lid, COUNT(*) AS vidcount
FROM albums AS a
LEFT JOIN albs_vids AS b ON b.albid = a.albid
WHERE b.userid='".mysql_real_escape_string($UID)."'
GROUP BY a.albname"; 
```

# recursion - 手动计算递归调用

> ID：10359897
> 
> 赞同：1
> 
> 时间：2012-04-28T01:47:11.197
> 
> 标签：recursion

新的 CS 学生，正在准备期末考试。我试图弄清楚一个递归方法一般会被调用多少次。添加代码作为示例。如果我输入 abcd 和 efgh，根据字符串的大小有多少次调用？如果 n 是任何数据大小，那么在任何递归方法中，调用次数都是 n(?)。

```
public static String interweave(String s1, String s2)
{ 
   if (s1.equals("") ) return s2;
   else if (s2.equals("")) return s1;
   else return "" + interweave(s1.substring(0,s1.length()-1), s2.substring(0,s2.length()-1))
       +s1.charAt(s1.length()-1)+s2.charAt(s2.length()-1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T02:06:57.317

字符并不意味着任何东西只是长度。您可以将其转换为数字问题，如下所示：

```
public static String interweave(int s1, int s2)
{ 
   if (s1 == 0) return s2;
   else if (s2 == 0) return s1;
   else return interweave(s1-1, s2-1)+2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T13:12:45.667

请注意，在您的问题中，在每个递归步骤中，您将两个字符串的大小减少一个，直到其中一个字符串的长度为零（递归的基本情况）。不难看出，递归调用的次数是`min(m, n) + 1`，其中`m`是 的初始长度，`s1`是`n`的初始长度`s2`。

例如， if`s1 = "abc"`和`s2 = "de"`它将需要 2 次递归调用来遍历`s2`（具有最小长度的字符串）加上 1 次额外调用以退出基本情况，因此`min(s1.length(), s2.length()) + 1 == 3`. 您可以像这样以编程方式对其进行测试：

```
static int counter;

public static String interweave(String s1, String s2) {
    counter++;
    if (s1.equals(""))
        return s2;
    else if (s2.equals(""))
        return s1;
    else
        return interweave(s1.substring(0, s1.length()-1), s2.substring(0, s2.length()-1))
        + s1.charAt(s1.length()-1)+s2.charAt(s2.length()-1);
}

public static int count(String s1, String s2) {
    counter = 0;
    interweave(s1, s2);
    return counter;
} 
```

现在，当您运行以下语句时，公式按预期工作：

```
// s1.length() == s2.length()
System.out.println(count("abcde", "fghij"));
> 6

// s1.length() > s2.length()
System.out.println(count("abcde", "fg"));
> 3

// s1.length() < s2.length()
System.out.println(count("ab", "cdefg"));
> 3 
```

# c# - 在 datagrid 和 SQL Compact 表之间同步数据

> ID：10359900
> 
> 赞同：0
> 
> 时间：2012-04-28T01:47:37.853
> 
> 标签：c#, sql, data-binding, datagridview

您好，我有一个链接到 SQL Compact 数据库（xxx.sdf 文件）的项目，需要从我`datagridview`的表和其中的表中正确传输数据。这可能不是我应该做的，但我花了几个小时试图参数化一大堆查询来单独对表执行此操作（没有成功）。我一直在阅读一篇又一篇文章，也许我正在寻找错误的东西。

我的网格绑定到`tableNameBindingSource`. 我无法以编程方式将行添加到网格中，因为它已绑定。我正在寻找一次向我的 SQL 表中添加数百行的最简单方法，并想尝试使用`datagridview`来完成此操作。

我可以（取消绑定 SQL 表并）根据需要将行添加到`datagridview`表中，然后强制其内容成为数据库表的内容吗？是否有某种翻译器（我使用 SQLDataAdaptor 从 SQL 表转到`datagridview`）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T02:18:33.677

只要您的网格视图表（源数据）与您的 SQL 表具有相同的结构（列、数据类型），您就应该能够使用 SQLBulkCopy 快速复制数据。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

我用它在相对较短的时间内复制了 100,000 行。

查看此 CodeProject 和上面的链接：

[http://www.codeproject.com/Articles/18418/Transferring-Data-Using-SqlBulkCopy](http://www.codeproject.com/Articles/18418/Transferring-Data-Using-SqlBulkCopy)

（编辑）我刚刚注意到你说 SQLCompact。我不确定 SqlBulkCopy 是否适用于精简版。有一个名为 SQLCEBulkCopy 的 CodePlex 项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T08:53:53.710

如果有帮助，您可以只使用循环，然后使用插入查询...

```
SqlConnection cn = new SqlConnection(your connection parameters)
foreach (GridViewRow gvr in GridView1.Rows)
{
        Label lblname = (Label)gvr.FindControl("lblname");
        Label lbllogin = (Label)gvr.FindControl("lbllogin");
        Label lblemail = (Label)gvr.FindControl("lblemail");
        cn.open();

                SqlCommand command = new SqlCommand("INSERT INTO Employee(Name,Login_Id,Email_Id) VALUES(@lblname,@lbllogin,@lblemail)", cn);
                command.Parameters.AddWithValue("@lblname", lblname.Text.ToString());
                command.Parameters.AddWithValue("@lbllogin", lbllogin.Text.ToString());
                command.Parameters.AddWithValue("@lblemail", lblemail.Text.ToString());
                command.ExecuteNonQuery();

                cn.Close()
} 
```

并将此代码放入按钮单击事件中（保存按钮或其他内容）

# sql - oracle sql - 查找两个用户之间购买的常见物品

> ID：10359903
> 
> 赞同：1
> 
> 时间：2012-04-28T01:48:32.430
> 
> 标签：sql, oracle

项目 - Id、名称、
PurchaseLog - Id、ItemId、CustomerId、PurchaseDate 用户 - Id、用户名

对于给定的两个客户的用户名，找到他们去年购买的常见物品的名称。

这是幼稚的（甚至是正确的）吗？：

```
select distinct item.id, item.name
from item i, PurchaseLog log_username1, PurchaseLog log_username2,  user user1, user user2
where lower(user1.username) = lower('UserName1') AND
      lower(user2.username) = lower('UserName2') AND
      log_username1.itemid = log_username2.itemid AND
      log_username2.itemid = i.itemid AND
      log_username1 >-- satisfy date contraint AND
      log_username2 >-- satisfy date contraint 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T01:59:46.427

您描述了交集查询的基本要求。

```
select item.id, item.name
from item, PurchaseLog p, user u
where lower(u.username) = lower('Username1')
AND p.user_id = u.user_id
and item.id = p.itemid
and p.purchasedate between SYSDATE and SYSDATE-365
INTERSECT
select item.id, item.name
from item, PurchaseLog p, user u
where lower(u.username) = lower('Username2')
AND p.user_id = u.user_id
and item.id = p.itemid
and p.purchasedate between SYSDATE and SYSDATE-365 
```

这将返回为两个用户显示的 item.id 和 item.name 列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:45:48.403

该解决方案使用半连接，在您的情况下应该是最佳的，因为它不需要对结果进行区分。/ *+inline* / 提示告诉优化器不要在 user_items 子查询上使用临时表。为了提高性能，您应该使用 user.userid 限制为小写的列（虚拟列应该是最佳的）并在其上使用索引，因此以后您不需要在其上调用 lower 查询。

我还假设您错过了在查询中指定 PurchaseLog 和用户表之间的连接条件。

```
with user_items as (
        select /*+inline*/ lower(username),itemid
        from PurchaseLog
            join user using (userid) /*you were missing this join in your query*/
        where  log_username >-- satisfy date contraint
    )
select item.id, item.name
from item i
where itemid in (
        select itemid
        from user_items
        where username = lower('UserName1')
    ) and itemid in (
        select itemid
        from user_items
        where username = lower('UserName2')
    )
/ 
```

# javascript - 如何计算数组中元素的总和和平均值？

> ID：10359907
> 
> 赞同：247
> 
> 时间：2012-04-28T01:48:55.887
> 
> 标签：javascript, arrays, average

我在添加数组的所有元素以及平均它们时遇到问题。我将如何做到这一点并使用我目前拥有的代码来实现它？这些元素应该按照我在下面的定义进行定义。

```
<script type="text/javascript">
//<![CDATA[

var i;
var elmt = new Array();

elmt[0] = "0";
elmt[1] = "1";
elmt[2] = "2";
elmt[3] = "3";
elmt[4] = "4";
elmt[5] = "7";
elmt[6] = "8";
elmt[7] = "9";
elmt[8] = "10";
elmt[9] = "11";

// Problem here
for (i = 9; i < 10; i++){
  document.write("The sum of all the elements is: " + /* Problem here */ + " The average of all the elements is: " + /* Problem here */ + "<br/>");
}   

//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：607
> 
> 时间：2012-05-16T18:12:13.360

我认为更优雅的解决方案：

```
const sum = times.reduce((a, b) => a + b, 0);
const avg = (sum / times.length) || 0;

console.log(`The sum is: ${sum}. The average is: ${avg}.`); 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2012-04-28T01:54:57.917

```
var sum = 0;
for( var i = 0; i < elmt.length; i++ ){
    sum += parseInt( elmt[i], 10 ); //don't forget to add the base
}

var avg = sum/elmt.length;

document.write( "The sum of all the elements is: " + sum + " The average is: " + avg ); 
```

只需遍历数组，因为您的值是字符串，所以必须先将它们转换为整数。平均值只是值的总和除以值的数量。

* * *

## 回答 #3

> 赞同：146
> 
> 时间：2013-08-14T14:32:04.373

# ES6

```
const average = arr => arr.reduce( ( p, c ) => p + c, 0 ) / arr.length;

const result = average( [ 4, 4, 5, 6, 6 ] ); // 5

console.log(result);
```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2018-08-08T15:55:25.020

[使用reduce](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)和 ES6计算平均值（mean） ：

```
const average = list => list.reduce((prev, curr) => prev + curr) / list.length;

const list = [0, 10, 20, 30]
average(list) // 15 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2020-06-14T11:42:05.643

**平均最短的一班轮**

```
const avg = arr => arr.reduce((acc,v,i,a)=>(acc+v/a.length),0); 
```

**Sum 最短的一班轮**

```
const sum = arr => arr.reduce((a,b)=>a+b); 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2014-05-23T07:46:55.310

一般平均使用单线减少是这样的

```
elements.reduce(function(sum, a,i,ar) { sum += a;  return i==ar.length-1?(ar.length==0?0:sum/ar.length):sum},0); 
```

专门问的问题

```
elements.reduce(function(sum, a,i,ar) { sum += parseFloat(a);  return i==ar.length-1?(ar.length==0?0:sum/ar.length):sum},0); 
```

一个高效的版本就像

```
elements.reduce(function(sum, a) { return sum + a },0)/(elements.length||1); 
```

1 分钟了解 Javascript Array Reduce [http://www.airpair.com/javascript/javascript-array-reduce](http://www.airpair.com/javascript/javascript-array-reduce)

正如gotofritz 指出的那样， Array.reduce 似乎跳过了未定义的值。所以这是一个修复：

```
(function average(arr){var finalstate=arr.reduce(function(state,a) { state.sum+=a;state.count+=1; return state },{sum:0,count:0}); return finalstate.sum/finalstate.count})([2,,,6]) 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2016-03-15T10:22:17.700

假设我们有一个这样的整数数组：

```
var values = [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]; 
```

平均值通过以下公式获得

**A= (1/n)Σxi** *( i = 1 到 n )* ... 所以：x1/n + x2/n + ... + xn/n

我们将当前值除以值的数量，并将先前的结果添加到返回值中。

reduce 方法签名是

```
reduce(callback[,default_previous_value]) 
```

**reduce 回调函数采用以下参数：**

*   **p** : 上一次计算的结果
*   **c**：当前值（来自当前索引）
*   **i** : 当前数组元素的索引值
*   **a** : 当前缩减的 Array

第二个reduce的参数是**默认值**...（在数组为**空**的情况下使用）。

所以平均减少方法将是：

```
var avg = values.reduce(function(p,c,i,a){return p + (c/a.length)},0); 
```

如果您愿意，可以创建一个单独的函数

```
function average(p,c,i,a){return p + (c/a.length)};
function sum(p,c){return p + c)}; 
```

然后简单的参考回调方法签名

```
var avg = values.reduce(average,0);
var sum= values.reduce(sum,0); 
```

或者直接扩充阵列原型..

```
Array.prototype.sum = Array.prototype.sum || function (){
  return this.reduce(function(p,c){return p+c},0);
}; 
```

每次调用reduce方法时都可以将值除以..

```
Array.prototype.avg = Array.prototype.avg || function () {
  return this.reduce(function(p,c,i,a){return p+(c/a.length)},0);
}; 
```

甚至**更好**，使用**之前定义的** *Array.protoype.sum()*

方法，优化我只调用一次部门的过程:)

```
Array.prototype.avg = Array.prototype.avg || function () {
  return this.sum()/this.length; 
}; 
```

然后在范围的任何 Array 对象上：

```
[2, 6].avg();// -> 4
[2, 6].sum();// -> 8 
```

*注意：在我看来，返回 NaN 愿望的空数组比 0 更正确，并且在特定用例中很有用。*

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2017-10-07T12:08:35.917

您还可以在数学部分使用[lodash](https://lodash.com)、 _.sum(array) 和 _.mean(array) （还有其他方便的东西）。

```
_.sum([4, 2, 8, 6]);
// => 20
_.mean([4, 2, 8, 6]);
// => 5 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-04-12T17:01:17.223

不是最快的，但最短的一行是使用 map() 和 reduce()：

```
var average = [7,14,21].map(function(x,i,arr){return x/arr.length}).reduce(function(a,b){return a + b}) 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-02-23T02:54:12.873

我在我的个人库中使用这些方法：

```
Array.prototype.sum = Array.prototype.sum || function() {
  return this.reduce(function(sum, a) { return sum + Number(a) }, 0);
}

Array.prototype.average = Array.prototype.average || function() {
  return this.sum() / (this.length || 1);
} 
```

编辑：要使用它们，只需询问数组的总和或平均值，例如：

```
[1,2,3].sum() // = 6
[1,2,3].average() // = 2 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-11-18T15:56:07.243

在**支持 ES6 的**浏览器中，这个 polyfill 可能会有所帮助。

```
Math.sum = (...a) => Array.prototype.reduce.call(a,(a,b) => a+b)

Math.avg = (...a) => this.sum(...a)/a.length; 
```

`Math.sum`您可以在,`Math.avg` 和之间共享相同的调用方法`Math.max`，例如

```
var maxOne = Math.max(1,2,3,4) // 4; 
```

你可以使用 Math.sum 作为

```
var sumNum = Math.sum(1,2,3,4) // 10 
```

或者如果你有一个数组要总结，你可以使用

```
var sumNum = Math.sum.apply(null,[1,2,3,4]) // 10 
```

就像

```
var maxOne = Math.max.apply(null,[1,2,3,4]) // 4 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-01-03T16:06:12.247

尽管确实需要使用（非常讨厌的）eval（），但您可以使用一种偷偷摸摸的方式来做到这一点。

```
var sum = eval(elmt.join('+')), avg = sum / elmt.length;
document.write("The sum of all the elements is: " + sum + " The average of all the elements is: " + avg + "<br/>"); 
```

只是以为我会将其发布为“框外”选项之一。你永远不知道，狡猾可能会给你（或拿走）一分。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-04-16T20:27:33.033

这是在 javascript 中快速添加“数学”对象以添加“平均”命令！

```
Math.average = function(input) {
  this.output = 0;
  for (this.i = 0; this.i < input.length; this.i++) {
    this.output+=Number(input[this.i]);
  }
  return this.output/input.length;
} 
```

然后我将这个添加到“数学”对象中以​​获得总和！

```
Math.sum = function(input) {
  this.output = 0;
  for (this.i = 0; this.i < input.length; this.i++) {
    this.output+=Number(input[this.i]);
  }
  return this.output;
} 
```

那么你要做的就是

```
alert(Math.sum([5,5,5])); //alerts “15”
alert(Math.average([10,0,5])); //alerts “5” 
```

我把占位符数组放在哪里只是传入你的变量（如果它们是数字，输入可以是一个字符串，因为它解析为一个数字！）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-04-28T01:53:35.223

将你的 for 循环计数器设置为 0 .... 你得到元素 9，然后你就完成了，就像现在一样。其他答案是基本数学。使用变量来存储总和（需要将字符串转换为整数），然后除以数组长度。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-04-28T01:55:43.080

首先定义我们计划使用的所有变量。您会注意到，对于`numbers`数组，我使用的是`[]`与构造函数方法相反的文字表示法`array()`。此外，我使用更短的方法将多个变量设置为 0。

```
var numbers = [], count = sum = avg = 0; 
```

接下来，我将使用 0 到 11 的值填充我的空数字数组。这是为了让我到达你原来的起点。请注意我是如何推入数组的`count++`。这会推动 count 的当前值，然后在下一次将其递增。

```
while ( count < 12 )
    numbers.push( count++ ); 
```

最后，我正在为 numbers 数组中的每个数字执行一个函数。此函数将一次处理一个数字，我在函数体内将其标识为“n”。

```
numbers.forEach(function(n){
  sum += n; 
  avg = sum / numbers.length;
}); 
```

最后，我们可以将`sum`值和`avg`值输出到控制台以查看结果：

```
// Sum: 66, Avg: 5.5
console.log( 'Sum: ' + sum + ', Avg: ' + avg ); 
```

在[http://jsbin.com/unukoj/3/edit上在线查看它](http://jsbin.com/unukoj/3/edit)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-01-15T05:46:05.990

我只是建立在 Abdennour TOUMI 的回答之上。以下是原因：

1.) 我同意布拉德的观点，我认为扩展我们没有创建的对象不是一个好主意。

2.)`array.length`在 javascript 中完全可靠，我更喜欢`Array.reduce`因为`a=[1,3];a[1000]=5;`，现在`a.length`会返回`1001`.

```
function getAverage(arry){
    // check if array
    if(!(Object.prototype.toString.call(arry) === '[object Array]')){
        return 0;
    }
    var sum = 0, count = 0; 
    sum = arry.reduce(function(previousValue, currentValue, index, array) {
        if(isFinite(currentValue)){
            count++;
            return previousValue+ parseFloat(currentValue);
        }
        return previousValue;
    }, sum);
    return count ? sum / count : 0; 
}; 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-10-04T14:54:41.507

如果有人需要它 - 这是一个递归平均值。

在原始问题的上下文中，如果您允许用户插入附加值并且不产生再次访问每个元素的成本，您可能希望使用递归平均值，并且想要“更新”现有平均值。

```
/**
 * Computes the recursive average of an indefinite set
 * @param {Iterable<number>} set iterable sequence to average
 * @param {number} initAvg initial average value
 * @param {number} initCount initial average count
 */
function average(set, initAvg, initCount) {
  if (!set || !set[Symbol.iterator])
    throw Error("must pass an iterable sequence");

  let avg = initAvg || 0;
  let avgCnt = initCount || 0;
  for (let x of set) {
    avgCnt += 1;
    avg = avg * ((avgCnt - 1) / avgCnt) + x / avgCnt;
  }
  return avg; // or {avg: avg, count: avgCnt};
}

average([2, 4, 6]);    //returns 4
average([4, 6], 2, 1); //returns 4
average([6], 3, 2);    //returns 4
average({
  *[Symbol.iterator]() {
    yield 2; yield 4; yield 6;
  }
});                    //returns 4 
```

如何：

这通过保持当前的平均值和元素计数来工作。当要包含一个新值时，您将 count 增加 1，将现有平均值缩放`(count-1) / count`，然后添加`newValue / count`到平均值中。

好处：

*   您没有对所有元素求和，这可能会导致无法存储在 64 位浮点数中的大量数字。
*   如果有其他值可用，您可以“更新”现有平均值。
*   您可以在不知道序列长度的情况下执行滚动平均。

缺点：

*   招致更多的部门
*   不是无限的 - 仅限于 Number.MAX_SAFE_INTEGER 项目，除非您雇用`BigNumber`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-09-29T17:13:29.057

在常青浏览器上，您可以使用箭头功能 `avg = [1,2,3].reduce((a,b) => (a+b);`

运行它 100,000 次，for 循环方法和 reduce 之间的时间差可以忽略不计。

```
s=Date.now();for(i=0;i<100000;i++){ n=[1,2,3]; a=n.reduce((a,b) => (a+b)) / n.length };
console.log("100k reduce took " + (Date.now()-s) + "ms.");

s=Date.now();for(i=0;i<100000;i++){n=[1,2,3]; nl=n.length; a=0; for(j=nl-1;j>0;j--){a=a+n[j];} a/nl };
console.log("100k for loop took " + (Date.now()-s) + "ms.");

s=Date.now();for(i=0;i<1000000;i++){n=[1,2,3]; nl=n.length; a=0; for(j=nl-1;j>0;j--){a=a+n[j];} a/nl };
console.log("1M for loop took " + (Date.now()-s) + "ms.");

s=Date.now();for(i=0;i<1000000;i++){ n=[1,2,3]; a=n.reduce((a,b) => (a+b)) / n.length };
console.log("1M reduce took " + (Date.now()-s) + "ms.");

/* 
 * RESULT on Chrome 51
 * 100k reduce took 26ms.
 * 100k for loop took 35ms.
 * 10M for loop took 126ms.
 * 10M reduce took 209ms.
 */
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-12-16T15:54:26.593

```
Array.prototype.avg=function(fn){
    fn =fn || function(e,i){return e};
    return (this.map(fn).reduce(function(a,b){return parseFloat(a)+parseFloat(b)},0) / this.length ) ; 
}; 
```

然后 ：

```
[ 1 , 2 , 3].avg() ;  //-> OUT : 2

[{age:25},{age:26},{age:27}].avg(function(e){return e.age}); // OUT : 26 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-03-18T15:05:04.373

在阅读了其他选择之后，我将尝试为未来的观众制作一个更简单的版本，详细说明现有的代码，而不是创建一个更优雅的代码。首先，您将数字声明为字符串。除了 .parseInt 我们还可以这样做：

```
const numberConverter = elmt.map(Number); 
```

所以 map 所做的是它“返回原始数组的副本”。但我将其值转换为数字。然后我们可以使用 reduce 方法（它也可以更简单，但我正在编写易于阅读的版本，并且我还有 2 个平均方法）reduce 方法的作用是它有一个累加器，如果你将值添加到它，因为它遍历数组并将（在本例中） currentValue 添加到它。：

```
var i;
const elmt = new Array();
elmt[0] = '0';
elmt[1] = '1';
elmt[2] = '2';
elmt[3] = '3';
elmt[4] = '4';
elmt[5] = '7';
elmt[6] = '8';
elmt[7] = '9';
elmt[8] = '10';
elmt[9] = '11';

console.log(elmt);

const numberConverter = elmt.map(Number);

const sum = numberConverter.reduce((accumulator, currentValue) => {
  return accumulator + currentValue;
}, 0);

const average = numberConverter.reduce(
  (accumulator, currentvalue, index, numArray) => {
    return accumulator + currentvalue / numArray.length;
  },
  0
);

const average2 =
  numberConverter.reduce(
    (accumulator, currentValue) => accumulator + currentValue,
    0
  ) / numberConverter.length;

for (i = 9; i < 10; i++) {
  console.log(
    `The sum of all the elements is: ${sum}. <br> The average of all the elements is: ${average2}`
  );} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-07-08T18:26:28.337

如果您需要平均值并且可以跳过计算总和的要求，您可以通过一次调用 reduce 来计算平均值：

```
// Assumes an array with only values that can be parsed to a Float
var reducer = function(cumulativeAverage, currentValue, currentIndex) {
  // 1\. multiply average by currentIndex to find cumulative sum of previous elements
  // 2\. add currentValue to get cumulative sum, including current element
  // 3\. divide by total number of elements, including current element (zero-based index + 1)
  return (cumulativeAverage * currentIndex + parseFloat(currentValue))/(currentIndex + 1)
}
console.log([1, 2, 3, 4, 5, 6, 7, 8, 9, 10].reduce(reducer, 0)); // => 5.5
console.log([].reduce(reducer, 0)); // => 0
console.log([0].reduce(reducer, 0)); // => 0
console.log([].reduce(reducer, 0)); // => 0
console.log([,,,].reduce(reducer, 0)); // => 0
console.log([].reduce(reducer, 0)); // => 0 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-03-20T19:42:11.163

我发现[Mansilla](https://stackoverflow.com/users/78640/sergi-mansilla)的[答案](https://stackoverflow.com/a/10624256/8565438)可以很好地确保我正在使用[parseFloat()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseFloat)对浮点数求和而不是字符串连接：

```
let sum = ourarray.reduce((a, b) => parseFloat(a) + parseFloat(b), 0);
let avg = (sum / ourarray.length) || 0;

console.log(sum); // print out sum
console.log(avg); // print out avg 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-10-07T16:18:37.170

只是为了踢球：

```
var elmt = [0, 1, 2,3, 4, 7, 8, 9, 10, 11], l = elmt.length, i = -1, sum = 0;
for (; ++i < l; sum += elmt[i])
    ;
document.body.appendChild(document.createTextNode('The sum of all the elements is: ' + sum + ' The average of all the elements is: ' + (sum / l))); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-05-29T18:55:41.640

这是我简单地找到平均值的新手方法。希望这可以帮助某人。

```
function numAvg(num){
    var total = 0;
    for(var i = 0;i < num.length; i++) { 
        total+=num[i];
    }
    return total/num.length;
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-02-25T18:41:19.403

似乎有无数种解决方案，但我发现这简洁而优雅。

```
const numbers = [1,2,3,4];
const count = numbers.length;
const reducer = (adder, value) => (adder + value);
const average = numbers.map(x => x/count).reduce(reducer);
console.log(average); // 2.5 
```

或者更简洁：

```
const numbers = [1,2,3,4];
const average = numbers.map(x => x/numbers.length).reduce((adder, value) => (adder + value));
console.log(average); // 2.5 
```

根据您的浏览器，您可能需要执行显式函数调用，因为不支持箭头函数：

```
const r = function (adder, value) {
        return adder + value;
};
const m = function (x) {
        return x/count;
};
const average = numbers.map(m).reduce(r);
console.log(average); // 2.5 
```

或者：

```
const average1 = numbers
    .map(function (x) {
        return x/count;
     })
    .reduce(function (adder, value) {
        return adder + value;
});
console.log(average1); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-03-15T11:01:18.730

我认为我们可以这样做

```
var k=elmt.reduce(function(a,b){return parseFloat(a+parseFloat(b));})
var avg=k/elmt.length; 
console.log(avg); 
```

我使用 parseFloat 两次，因为当 1) 添加 (a)9+b("1") 数字时，结果将是“91”，但我们想要添加。所以我使用了 parseFloat

2）当添加（a）9 + parseFloat（“1”）时，虽然结果将是“10”，但它会在我们不想要的字符串中，所以我再次使用了parseFloat。

我希望我很清楚。欢迎提出建议

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-01-04T19:51:52.227

这是你的一个班轮：

```
var average = arr.reduce((sum,item,index,arr)=>index !== arr.length-1?sum+item:sum+item/arr.length,0) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-02-02T20:54:41.423

我认为这可能是使用 for 循环和函数计算平均值的直接解决方案。

```
var elmts = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];

function average(arr) {
    var total = 0;
    for (var i = 0; i < arr.length; i++) {
        total += arr[i];
    }
        console.log(Math.round(total/arr.length));
}

average(elmts); 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2014-07-19T14:46:24.813

## HTML 内容的平均数

使用 jQuery 或 Javascript `querySelector`，您可以直接访问格式化数据...示例：

```
<p>Elements for an average: <span class="m">2</span>, <span class="m">4</span>,
   <span class="m">2</span>, <span class="m">3</span>.
</p> 
```

所以，使用 jQuery 你有

```
var A = $('.m')
  .map(function(idx) { return  parseInt($(this).html()) })
  .get();
var AVG = A.reduce(function(a,b){return a+b}) / A5.length; 
```

查看其他 4 种方式（！）来访问 itens 并对其进行平均：http: [//jsfiddle.net/4fLWB/](http://jsfiddle.net/4fLWB/)

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2015-12-15T23:50:46.900

var arr = [1,2,3,4,5]

```
function avg(arr){
  var sum = 0;
  for (var i = 0; i < arr.length; i++) {
    sum += parseFloat(arr[i])
  }
  return sum / i;
} 
```

平均（arr）======>>>> 3

这适用于字符串作为数组中的数字或数字。

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2019-03-20T17:14:04.503

```
 var scores =[90, 98, 89, 100, 100, 86, 94];
        var sum = 0;
        var avg = 0;
        for(var i = 0; i < scores.length;i++){
  //Taking sum of all the arraylist
            sum = sum + scores[i];   
                }
  //Taking average     
             avg = sum/scores.length;        
  //this is the function to round a decimal no    
             var round = avg.toFixed();
             console.log(round); 
```

* * *

## 回答 #32

> 赞同：-3
> 
> 时间：2016-07-13T20:37:35.727

我正好有 10 个元素（如示例中所示），所以我做了：

```
( elmt[0] + elmt[1] + elmt[2] + elmt[3] + elmt[4] +
  elmt[5] + elmt[6] + elmt[7] + elmt[8] + elmt[9] ) / 10 
```

* * *

## 回答 #33

> 赞同：-3
> 
> 时间：2015-09-16T00:05:28.483

在这种情况下，我会推荐 D3。它是最易读的（并提供 2 种不同的平均值）

```
let d3 = require('d3');
let array = [1,2,3,4];
let sum = d3.sum(array); //10
let mean = d3.mean(array); //2.5
let median = d3.median(array); 
```

# javascript - 使用 JavaScript 创建在线 CMD/终端

> ID：10359911
> 
> 赞同：3
> 
> 时间：2012-04-28T01:49:54.700
> 
> 标签：javascript, cmd

我想为使用 javascript 的网站部署 CMD/终端。CMD 可能只是用于运行 python 和其他基本命令。我该怎么做呢？有没有例子？JavaScript 是最好的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T02:08:32.700

[我猜Termlib](http://www.masswerk.at/termlib/)就是你要找的东西。它提供了一个“终端”对象，您可以根据需要对其进行扩展。

可以在[这里找到演示](http://www.masswerk.at/termlib/multiterm_test.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T02:14:26.893

示例：Anyterm、Ajaxterm

如果您的防火墙/站点设置允许，您也可以使用 ssh。

或者，如果您在服务器上运行 gui，则可以使用 vnc 获取 gui 访问权限。

我认为获得访问权限的最佳方式是 ssh 或 vnc。如果您使用 Windows 服务器，则使用远程桌面。

我可以看到在浏览器 UI 中使用基于 javascript 的主要原因是，如果您和服务器之间的防火墙不允许 ssh，并且您不想或无法在所涉及的机器上配置 vnc。

最后，在网站上进行此类访问的一个非常漂亮的示例是... [koding.com 几个月前](http://koding.com/) ，我在 SFJS 聚会上看到了这些人。

# java - 手动删除后，文件内容还能读出吗？

> ID：10359912
> 
> 赞同：4
> 
> 时间：2012-04-28T01:50:04.300
> 
> 标签：java, file

```
import java.io.FileReader;

public class SimpoTest {

    public static void main(String[] args) {
        FileReader fileReader = null;
        try {
            fileReader = new FileReader("/home/brian/Desktop/me");
            int read = fileReader.read();
            System.out.println((char) read);
        } catch (Exception e) {
            fileReader = null;
            e.printStackTrace();
        }
    }
} 
```

1\ echo "1" > /home/brian/Desktop/me
2\ 设置断点为 "int read = fileReader.read();"
3\ 开始调试
4\ rm -f /home/brian/Desktop/me
5\ 跳到最后 <======== 控制台上仍然输出“1”...

嗯……这对我来说真的很奇怪。好像我应该抛出一个异常。谁能给出任何解释？任何意见或建议表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T01:53:50.757

在大多数类 Unix 系统上，文件的数据会保留在磁盘上，直到*所有*引用都消失为止。这包括路径名（硬链接）和打开的文件句柄。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T01:53:07.950

这至少在类 Unix 操作系统上是预期的行为：只要有一个打开的文件描述符，rm'd 文件的块将保持分配状态，并可通过该文件描述符访问。

但是，我希望您不能通过已删除的文件名向他们打开新的文件描述符。

# ios - 如何在我的popoverController中显示我的tableview和数据

> ID：10359917
> 
> 赞同：1
> 
> 时间：2012-04-28T01:51:45.267
> 
> 标签：ios

现在我已经创建了一个带有 tableview 的 popoverController，并且我创建了将在 tableview 中显示的数据。但是，该表始终是空的。PS（委托和数据源已设置，委托方法也已调用）

在 tableview 中创建数据的方法：

```
-(void) createCategoryData
{
NSMutableArray *categoriesForJiangSu;
NSMutableArray *categoriesForZheJiang;

categorySections=[[NSMutableArray alloc]initWithObjects:@"JiangSu",@"ZheJiang", nil];
categoriesForJiangSu=[[NSMutableArray alloc]init];
categoriesForZheJiang=[[NSMutableArray alloc]init];

[categoriesForJiangSu addObject:[[NSMutableDictionary alloc]initWithObjectsAndKeys:@"package 1",@"name",
                                 @"JiangSu.jpg",@"picture",nil]];
[categoriesForJiangSu addObject:[[NSMutableDictionary alloc]initWithObjectsAndKeys:@"package 2",@"name",
                                 @"JiangSu.jpg",@"picture",nil]];
[categoriesForZheJiang addObject:[[NSMutableDictionary alloc]initWithObjectsAndKeys:@"package 1",@"name",
                                  @"ZheJiang.jpg",@"picture",nil]];
[categoriesForZheJiang addObject:[[NSMutableDictionary alloc]initWithObjectsAndKeys:@"package 2",@"name",
                                  @"ZheJiang.jpg",@"picture",nil]];

categoryData=[[NSMutableArray alloc]initWithObjects:categoriesForJiangSu,categoriesForZheJiang, nil];
[categoriesForJiangSu release];
[categoriesForZheJiang release];

} 
```

这是委托方法：

```
-(NSInteger)numberOfSections
{
return [categorySections count];
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
return [[categoryData objectAtIndex:section] count];
}

-(NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:     (NSInteger)section
{
return [categorySections objectAtIndex:section];
}
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier=@"Cell";
UITableViewCell *cell=(UITableViewCell*)[tableView
                                           dequeueReusableCellWithIdentifier:CellIdentifier];
if(cell==nil)
{
    cell=[[[UITableViewCell alloc]
           initWithStyle:UITableViewCellStyleDefault 
           reuseIdentifier:CellIdentifier] autorelease];
}
[[cell imageView] setImage:[UIImage imageNamed:[[[categoryData
                                                  objectAtIndex:indexPath.section] objectAtIndex:indexPath.row]
                                                objectForKey:@"picture"]]];

[[cell textLabel] setText:[[[categoryData objectAtIndex:indexPath.section]
                            objectAtIndex:indexPath.row] objectForKey:@"name"]];
cell.accessoryType=UITableViewCellAccessoryDisclosureIndicator;
return cell;
} 
```

popoverController 的 viewDidLoad 方法：

```
- (void)viewDidLoad
{
[self createCategoryData];
self.contentSizeForViewInPopover=CGSizeMake(200.0, 320.0);
[super viewDidLoad];
} 
```

而mainViewController中的showPopover方法：

```
-(IBAction)showPopover:(id)sender
{
if(popoverController==nil)
{
    popoverController=[[UIPopoverController alloc]
                       initWithContentViewController:popoverContentViewController];
    [popoverController presentPopoverFromBarButtonItem:sender   permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
    popoverController.delegate=self;
}
} 
```

popoverContentViewController 是 popoverController 的名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T06:17:14.363

作为初学者，如果您不清楚 xib 概念，请不要使用 xib。最好在没有 xib 的情况下完成工作，正如 CodaFi 建议的那样。将您的表格视图添加到您传递给 popoverController 的控制器视图中。

# c++ - 在 C++ 中使用引用而不是指针有什么好处吗？

> ID：10359940
> 
> 赞同：6
> 
> 时间：2012-04-28T01:56:48.337
> 
> 标签：c++, pointers, reference

> **可能重复：**
> [C++ 中的指针变量和引用变量有什么区别？](https://stackoverflow.com/questions/57483/what-are-the-differences-between-pointer-variable-and-reference-variable-in-c)

例如，我有两个做同样事情的函数：

```
int func(int &a)
{
   return a+1;
} 
```

和

```
int func2(int *a)
{
   return *a+1;
} 
```

调用这些函数中的任何一个时，使用 func 优于 func2 有什么优势？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-28T01:58:54.640

*   引用不能直接赋值为null，但指针可以。
*   不能重新分配引用以指向其他内容，但可以重新分配指针。

这两者都可以是优点或缺点，具体取决于情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T02:20:41.253

你的两个函数都是错误的。由于它们不修改传入的参数，因此应该将它们作为 const 接收，如下所示：

```
int func(const int &a)
{
    return a+1;
}

int func2(const int *a)
{
    return *a+1;
} 
```

现在这是参考的一个优势，我可以将右值传递给参考版本：

```
func(10);
func(func(func(10))); 
```

我不能用指针版本做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T02:03:13.150

指针更灵活，它也可以在声明中预定义，如：

```
 int func2(int *a = nullptr); 
```

这在您的简单情况下不起作用，但在许多其他情况下它起作用。

指针也可以更容易地用于其他事情，比如存储在列表中、打字和其他事情。

是的，不能重新分配引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T03:08:50.877

如果 a 是重载标准 C++ 运算符（例如 operator[] 或 operator*）的对象，客户端可以在更标准的 C++ 语法中使用它，例如 a[i]，而不是 a->operator[](i) 或 (*a ）[一世]

# java - 代码在 Google App Engine 中运行非常缓慢

> ID：10359943
> 
> 赞同：0
> 
> 时间：2012-04-28T01:57:38.937
> 
> 标签：java, google-app-engine, performance

我正在使用 MapReduce 框架在 Google App Engine 上做一些工作（在本例中为 MD5 暴力破解）。

我遇到了一个问题，即代码在 GAE 中运行非常缓慢，即使只是使用开发服务器也是如此

此代码[https://github.com/jordan-thoms/Hash/blob/f982956f41313cd4fe3b5105aee21ea11bd3af16/src/nz/net/thoms/hash/mapreduce/HashMapper.java](https://github.com/jordan-thoms/Hash/blob/f982956f41313cd4fe3b5105aee21ea11bd3af16/src/nz/net/thoms/hash/mapreduce/HashMapper.java)每秒只能处理大约 4,000 个哈希（这是单个调用map()，里面根本没有使用google app engine api)。

我将代码带到外面并独立运行 - [https://github.com/jordan-thoms/Hash/blob/f982956f41313cd4fe3b5105aee21ea11bd3af16/src/nz/net/thoms/hash/StandaloneTest.java](https://github.com/jordan-thoms/Hash/blob/f982956f41313cd4fe3b5105aee21ea11bd3af16/src/nz/net/thoms/hash/StandaloneTest.java)，该版本将超过 100 万每秒。运行速度较慢的是中央循环，这很奇怪，因为这些代码都与谷歌应用引擎无关。

我已经尝试在 Google App 引擎代码上运行分析器，但我没有发现任何有用的东西 - 似乎是对 checkRestricted() 的大量调用以及类似的事情。我尝试删除安全管理器

即使是这个简单的代码：

```
 int i;
    for (i=0; i< 1000000; i++) {
        i += 2;
        i += (int) Math.sin(i * (i + (int) System.currentTimeMillis()));
    }
    long enda = System.currentTimeMillis();
    System.out.println("took " + (enda - starta) + " i:" + i); 
```

如果我把它放在一个普通程序中，运行时间为 117 毫秒，而在开发人员模式下的 servlet 中，在同一处理器上运行时间超过 400 毫秒。

（有趣的是，映射器每秒在生产的 Google App Engine 上完成大约 60,000 个哈希。所以速度要快得多，但与独立程序相比仍然非常慢）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T06:39:56.810

默认[前端实例](https://developers.google.com/appengine/docs/adminconsole/performancesettings)有 128MB 内存和 600MHz CPU 限制。这可以解释性能差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T16:09:23.160

MapReduce 迭代每个 DataStore 实体，与纯 hadoop 映射器相比，这很慢。考虑迭代 blob，或将散列分组。请记住，单个映射进程可以处理 10 分钟的工作，然后您可以确定要处理的每个数据块的最佳大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-15T08:52:02.683

根据我对 CPU 密集型任务的测量，应用引擎的速度比考虑到实例规格的预期慢大约十倍。例如，在我的 2.5 GHz 机器上通常需要 3 秒的计算通常在 2.4 GHz 后端实例上需要 30 秒。

对于本地开发模式，应用引擎的开箱即用性能更差。但是，通过设置 vm 参数 -Dappengine.disableRestrictedCheck="true" 可以在一定程度上缓解这种情况，特别是在使用自定义类加载器时。

# java - 当类不因数据而异时，Java完全从超类实现复制

> ID：10359944
> 
> 赞同：1
> 
> 时间：2012-04-28T01:57:42.597
> 
> 标签：java, inheritance, constructor, copy, subclass

我有几个“A”类的子类，比如 B、C 和 D。我将其中几个存储在一个泛型中

```
ArrayList<A> stuff; 
```

B、C 和 D 与 A 完全没有不同的数据成员。它们不同的唯一方式是通过不同的覆盖方法。我希望能够将 A 类的任何实例复制到 A 类的另一个实例（同时保留真正的子类）

就像是：

```
A obj1 = (A)new B(...)
A obj2 = (A)new C(...)
A obj3 = obj1.copy();
// (obj3 instanceof B) == true 
```

通常这需要 B、C 和 D 来实现自定义复制方法。但是，这似乎是一种浪费，因为数据成员完全相同，并且它们只会存在以便保留类。

有什么办法可以让我只在 A 类中实现复制，并且仍然保留对象的底层类？

编辑：

如果我的想法是正确的，如果只有超类有一个复制方法，我会遇到的问题：

```
class A {
    int dataMember;
    public A copy() {
        A ret = new A(); // !!
        ret.dataMember = dataMember;
        return ret;
    } 
```

}

当调用“new”时，我一般无法确定该类是 A 的哪个子类，并进一步显式实例化该类的实例。或者有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:25:42.313

你可以给`A`一个[复制构造函数](http://www.javapractices.com/topic/TopicAction.do?Id=12)：

```
class A {

    public A(A other) {
        //copy other's fields to this instance
    }
} 
```

的子类`A`还可以公开一个构造函数，该构造函数接受一个`A`实例并将其传递给`super`构造函数：

```
class B extends A {

    public B(A other) {
        super(other);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T03:40:01.423

你熟悉[克隆](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#clone%28%29)吗？它将复制您的所有字段并维护派生类。请注意，它不会克隆每个字段的对象，但它们将指向相同的引用。

```
public Object clone() {
    try {
        return super.clone(); 
    } catch (CloneNotSupportedException e) {} // Will never happen if your object implements the Cloneable interface
} 
```

# c# - 使用 Visual Studio 进行报告的新手

> ID：10359947
> 
> 赞同：0
> 
> 时间：2012-04-28T01:57:50.310
> 
> 标签：c#, winforms, visual-studio-2010, crystal-reports

我第一次使用 C# 和 Visual Studio 2010 进行报告。我的大多数应用程序都是由 sql server 数据驱动的 win forms 应用程序。我应该使用什么来开始报告？我看到工具箱中有一个内置的报表设计器，还有一种在项目级别添加报表的方法。这包括某种内置的报表设计器和报表向导。我还注意到一个名为 Crystal 报表的报表设计器。

有什么好的方向吗？还有任何提示让我开始，这样我就不会浪费很多时间？

任何帮助或方向将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T02:03:25.743

去水晶报表，它是一个众所周知的报告工具，你会在网上找到很多关于它的资源。除此之外，它是完全免费的。
检查这些以获取更多详细信息：

*   [http://msdn.microsoft.com/en-us/library/aa287920%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa287920%28v=vs.71%29.aspx)
*   [http://msdn.microsoft.com/en-us/library/ms225615%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms225615%28v=vs.90%29.aspx)
*   [http://www.youtube.com/watch?v=wud4VtqpetU](http://www.youtube.com/watch?v=wud4VtqpetU)

# php - Youtube oembed：它如何计算“宽度”和“高度”值？

> ID：10359948
> 
> 赞同：5
> 
> 时间：2012-04-28T01:57:55.643
> 
> 标签：php, youtube, dimensions, oembed

当我在我的 PHP 代码中使用 oembed URL`$video->width`并`$video->height`从我上传的视频中提取 and 时，我得到的值与我看到的与我的 Youtube 视频相关的任何内容都不匹配。

*   [http://youtu.be/p7ftPYU2_0w](http://youtu.be/p7ftPYU2_0w)

*   上传到 Youtube 的原始视频尺寸：**640 x 336**

*   oembed 返回：**480 x 270**

*   从 Youtube 页面 UI 共享时最小的嵌入选项：**560 x 316**

有谁知道 oembed 从哪里得到这些值？为什么默认为480？有没有办法获得真正的视频尺寸，或者至少将默认值提高到 640 x `[proportional_height]`？

我的目标是在嵌入我的网站时保留视频的原始尺寸（无缩放），*而*用户实际上不需要再次键入视频尺寸。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-09-17T21:00:48.227

Youtube 可能会生成一个内容，它可以提供嵌入内容而不是原始视频。生成内容的宽度和高度可以是**480 x 270**。因此，oEmbed api 可以始终返回此值。AFIK 没有办法从 api 端获取视频值的原始尺寸，除非或直到提供者提供。

您可以尝试在 jquery 和 css 的帮助下调整视频的宽度和大小。

[oEmbed](http://oembed.com)规范说`maxwidth`，`maxheight`在请求 api 时可以提供参数。所以我们可以限制视频的最大宽度和高度。

希望能帮助到你 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T16:53:10.567

您始终可以使用 CSS 进行调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T17:01:56.400

尝试这样的事情

```
<iframe title="YouTube video player" width="727" height="430" src='http://www.youtube.com/embed/p7ftPYU2_0w' frameborder="0"></iframe> 
```

据我所知，没有办法从嵌入中获取视频的高度。当页面加载并从那里开始时，您可以使用 jquery 获取播放器的高度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-13T22:36:14.197

oembed 响应中的宽度和高度是正确显示返回的 html 内容所需的最小高度和宽度。这是视频、界面、任何额外的标题栏或控件或徽标等。

唯一重要的是当请求 oembed 响应时。请求将指定宽度和高度，它们是支持的最大尺寸，响应将指定显示内容所需的最小尺寸。

如果最小内容响应大小不适合最大容器请求大小，则 oembed 尝试应该失败。

在这种情况下，youtube 声明需要 480 x 270 才能显示 youtube 界面。它实际上并没有说明视频本身，只有界面，因为任何浏览器都可以将任何视频自动缩放到任何分辨率。

# javascript - 如何为此使用 addEventListener？

> ID：10359951
> 
> 赞同：0
> 
> 时间：2012-04-28T01:59:15.550
> 
> 标签：javascript, oop, html, addeventlistener

我正在尝试向容器 div 中的子 div 添加事件侦听器。我在弄清楚如何正确执行此操作时遇到问题。到目前为止我的代码在这里：[pastebin](http://pastebin.com/7Nc2hwZ6)。监听器（点击）在第 35 行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:25:01.070

您正在调用该`context`函数，而不是将其作为侦听器传递。我的意思是，这个：

```
divs[i].addEventLisenter('click', context(divs[i].id), true); 
```

应该：

```
divs[i].addEventLisenter('click', context, true); 
```

还有这个：

```
function context(id) {
    console.log(id+' clicked');
} 
```

应该：

```
function context(evt) {
    console.log(this.id + ' clicked');
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-28T02:13:05.583

JavaScript 是解释型的，因此您应该将 docINIT 的定义移到它的使用之上。

# javascript - 如何替换jQuery中一组元素的部分属性值？

> ID：10359952
> 
> 赞同：1
> 
> 时间：2012-04-28T01:59:21.947
> 
> 标签：javascript, jquery, ajax, regex, replace

我正在尝试根据标签的当前内容替换一系列“for”标签属性。

该应用程序正在使用 AJAX 将项目添加到发票而不刷新页面。在收到成功添加项目的通知后，我的脚本应该替换表单中所有标签，其“for”属性以“-new”结尾，相同的属性减去“-new”并添加（“-”+ itemValue），其中 itemValue 是添加的发票项目的项目 ID。

我知道如何一次选择要更改的所有标签：

```
jQuery('label[for$=new]') 
```

我知道如何获得他们的“for”属性：

```
jQuery('label[for$=new]').attr('for') 
```

我尝试了 JavaScript 替换方法：

```
jQuery('label[for$=new]').attr('for').replace(/-new/,itemValue) 
```

但这似乎选择了每个标签的“for”属性，替换文本，并将替换的文本传回（什么都没有），因为我不知道如何识别具有我想要替换的“for”属性的标签。

这是一些示例 HTML：

```
<form id="InvoiceItemsForm-1" action="<?=$_SERVER['PHP_SELF'];?>" method="post" name="InvoiceItemsForm-1" onsubmit="return false">
<div id="InvoiceItem-new-1" class="InvoiceItem">
<label for="InvoiceItemNumber-new">New Invoice Item Number: </label>
<input id="InvoiceItemNumber-new" class="InvoiceItemNumber" type="text" value="" name="InvoiceItemNumber-new">
<label for="InvoiceItemDescription-new">Item Description: </label>
<input id="InvoiceItemDescription-new" class="InvoiceItemDescription" type="text" value="" name="InvoiceItemDescription-new">
<label for="InvoiceItemAmount-new">Item Amount: </label>
<input id="InvoiceItemAmount-new" class="InvoiceItemAmount" type="text" value="" name="InvoiceItemAmount-new">
<input id="addInvoiceItem-1" width="25" type="image" height="25" src="/payapp/images/greenplus.th.png" alt="Add New Invoice Item" onclick="addInvoiceItemButtonPushed(this)" value="invoiceItem">
</div>
<button id="CloseInvoice-1" onclick="closeInvoice(this)" type="button">Close Invoice</button>
</form> 
```

一旦我让它工作，我将替换所有输入的所有 id。同样的问题。我想解决方案看起来像这样：

```
jQuery('input[id$=new]').attr('id').replace(/-new/,itemValue) 
```

我根本无法弄清楚它的语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T12:16:01.913

无需使用`.each()`...该[`.attr()`](http://api.jquery.com/attr/#attr2)方法接受一个函数作为第二个参数，该参数返回要用作替换的新值

```
jQuery('label[for$=new]').attr('for', function(index, currentValue){
   return currentValue.replace(/-new/,'-' + itemValue);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T02:03:34.060

不知道我得到了这个问题，但类似：

```
var oldFor = $('label[for$=new]').attr('for');
var newFor = oldfor.replace(/-new/,itemValue);

$('label[for$=new]').attr('for', newFor); 
```

> .attr（属性名，值）
> 
> ```
> attributeName = The name of the attribute to set.
> value = A value to set for the attribute. 
> ```

选择多个元素时，您将需要迭代：

```
$('label[for$=new]').each(function(index) {
  $(this).attr('for', $(this).attr('for').replace(/-new/, '-' + itemValue));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T02:15:54.753

如果可以的话，为什么不把标签放在`input`标签里面`label`呢？这样，您将不需要标签`for`内的属性。`label`

接下来，完成您想要做的事情的更好方法是使用发票 ID 号作为周围的 ID `div`，并为“新”发票条目添加一个“新”类。

所以你的表格看起来像这样：

```
<form id="InvoiceItemsForm-1" action="<?=$_SERVER['PHP_SELF']" method="post" name="InvoiceItemsForm-1" onsubmit="return false">   
    <div class="InvoiceItem new">   
        <label>New Invoice Item Number: <input class="InvoiceItemNumber" type="text" value="" name="InvoiceItemNumber"></label>   
        <label>Item Description: <input class="InvoiceItemDescription" type="text" value="" name="InvoiceItemDescription-new"></label>   
        <label for="InvoiceItemAmount-new">Item Amount: <input class="InvoiceItemAmount" type="text" value="" name="InvoiceItemAmount-new"></label>   
        <input id="addInvoiceItem-1" width="25" type="image" height="25" src="/payapp/images/greenplus.th.png" alt="Add New Invoice Item" onclick="addInvoiceItemButtonPushed(this)" value="invoiceItem">   
    </div>   
    <button id="CloseInvoice-1" onclick="closeInvoice(this)" type="button">Close Invoice</button>   
</form> 
```

您仍然拥有获取新发票项目字段数据所需的所有可定位性，但现在，您只需要做两件事即可将“新”发票行转换为“现有”发票项目行：添加`id`属性到`div`并删除`new`类，jQuery 将让您轻松完成这两个操作。

# eclipse - 如何为 JBOSS 设置 JNDI 名称

> ID：10359953
> 
> 赞同：0
> 
> 时间：2012-04-28T01:59:22.330
> 
> 标签：eclipse, jndi, jboss7.x

我使用过 EJB 并在 JBOSS Server 上启动它。我想测试这个应用程序，所以我将使用客户端来访问它。但是，我不知道如何为此服务器设置 JNDI 名称。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T12:15:37.227

除非在启动服务器时使用 -b 选项指定不同的主机名或 IP 地址。EJB 或 JBoss JNDI 对象可以在同一台机器上通过 localhost 访问。

请参考以下可能对您有所帮助的链接

[https://community.jboss.org/wiki/AccessEJBsRemotely](https://community.jboss.org/wiki/AccessEJBsRemotely)

[https://community.jboss.org/wiki/NamingContextFactory](https://community.jboss.org/wiki/NamingContextFactory)

# hibernate - 如何避免“N+1 Select”并为具有多对一的 (N)Hibernate 用户类型指定获取策略？

> ID：10359957
> 
> 赞同：5
> 
> 时间：2012-04-28T02:00:09.903
> 
> 标签：hibernate, nhibernate, nhibernate-mapping

我有一个复合组件，它具有多对一的引用。

```
class MyComposite
{
    SomeEntity ManyToOne { get; set; }
    SomeOtherUserType Value { get; set; }
} 
```

为了便于映射，我做了一个`ICompositeUserType`包含这个组件的自定义：

```
class MyCompositeUserType : ICompositeUserType
{
    // ...
    private static readonly IType[] _propertyTypes = new[]
                                   {
                                       new ManyToOneType("SomeEntity"), 
                                       new CustomType(typeof(SomeOtherUserType))
                                   };
    // ...
} 
```

现在，我有一个`composite-element`包含此组件的 s 集合：

```
<class name="Container">
...
<set name="Pairings"
     cascade="all-delete-orphan"
     generic="true"
     lazy="false"
     table="Pairings"
     fetch="join">
    <key column="ContainerId" />
    <composite-element class="Pair">
        <property name="Item1" type="mycomposite" lazy="false">
            <column name="Entity1Id" />
            <column name="Amount1" />
        </property>
        <property name="Item2" type="mycomposite" lazy="false">
            <column name="Entity2Id" />
            <column name="Amount2" />
        </property>
        <property name="Tag" column="Tag" />
    </composite-element>
</set>
</class> 
```

当我查询`Container`该类时，该`Pairings`集合按设计被急切地加载，但是，然后我得到一个*N+1*选择，`SomeEntity`它构成了`MyCompositeUserType`. 我想加载这些实体以及`Pairings`集合上的连接。

如何指定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T17:59:38.397

如果映射为组件，您可以使用lazy="false" 将其多对一映射，或者应该可以在查询时设置fetchmode

```
<composite-element class="Pair">
    <component name="Item1">
        <many-to-one name="Entity1" column="Entity1Id" />
        <property name="Amount" column="Amount1" />
    </component>
    <component name="Item2">
        <many-to-one name="Entity2" column="Entity2Id"/>
        <property name="Amount" column="Amount2" />
    </component>
    <property name="Tag" column="Tag" />
</composite-element> 
```

# mysql - 选择数据：对日期不一致的多个表中的数据进行分页

> ID：10359958
> 
> 赞同：1
> 
> 时间：2012-04-28T02:00:12.050
> 
> 标签：mysql, sql, pagination

我有 8 张单独的桌子。每个表都有 id、一个日期时间字段和一些文本。

我在时间线视图的单个页面上呈现来自所有表的组合数据，最近的条目位于顶部，每个表中的条目在此时间轴中混合。

现在最困难的部分 - 我需要在这个网站上添加分页，所以在每个页面上我想准确显示 10 天（除了最后一页，可能少于 10 天）。每个表可能有可变数量的行。

我已经为此苦苦挣扎了很长一段时间，但还没有想出一个优雅的解决方案。

这是一个示例（我将为此示例仅选择两个表以使其更简单）。

## 表A

4 月 1 日 | a1
4 月 5 日 | a2
4 月 7 日 | a3

## 表B

4 月 2 日 | b1
4 月 2 日 | b2
4 月 5 日 | b3
4 月 6 日 | b4

全球时间表看起来像这样

* * *

4 月 7 日 a3
4 月 6 日 b4
4 月 5 日 a2
4 月 5 日 b3
4 月 2 日 b2
4 月 2 日 b1
4 月 1 日 a1

如果每个页面只显示 3 天，我需要它看起来像这样：

--- p1 ---
4 月 7 日 a3
4 月 6 日 b4
4 月 5 日 a2

--- p2 ---
4 月 5 日 b3
4 月 2 日 b2
4 月 2 日 b1

--- p3 ---
4 月 1 日 a1

问题是 - 我想不出一种优雅的方式来查询这些数据。这是我一直在搞乱的一些实时查询：

select date(d.entryTime) entryDate, date(wc.changeTime) wcDate from diary_entry d join water_change wc on d.aquariumId = wc.aquariumId where d.aquariumId = 2 group by entryDate order by entryDate limit 10, 5

所以，对于一个表，我有这个查询： select date(d.entryTime) entryDate from diary_entry d where d.aquariumId = 2 group by entryDate

它产生 13 个结果条目日期 2012-01-13
2012-01-14
2012-01-25
2012-01-26
2012-01-31
2012-02-04
2012-02-17
2012-02-20
2012-02-25
2012-03-17
2012-03-31
2012-04-01
2012-04-06

另一个： select date(wc.changeTime) changeDate from water_change wc where wc.aquariumId = 2 group by changeTime

它产生 8 个结果 2012-01-22
2012-01-26
2012-02-17
2012-02-25
2012-03-04
2012-03-10
2012-04-04
2012-04-24

两者之间共有三天 2012-01-26 2012-02-17 2012-02-25

所以我需要生成的查询必须有 13 + 8 - 3 行 = 18 行

并找到了解决方案！(select date(d.entryTime) activityDate from diary_entry d where d.aquariumId = 1 group by activityDate) union (select date(wc.changeTime) activityDate from water_change wc where wc.aquariumId = 1 group by activityDate order by activityDate) 限制 10 , 10

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T03:06:44.637

使用联合查询它。

```
SELECT TheDate,
       TheText
  FROM Table_A
 WHERE [your critera]
 UNION
SELECT TheDate,
       TheText
  FROM Table_B
 WHERE [your critera]
... 
```

如果您只需要选择不同的，则可以将其包装如下：

```
Select Distinct
       TheDate,
       TheText
  From 
(
 SELECT TheDate,
       TheText
  FROM Table_A
 WHERE [your critera]
 UNION
SELECT TheDate,
       TheText
  FROM Table_B
 WHERE [your critera]
...
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T02:47:58.877

听起来您已经有了选择和连接，只是缺少分页。如果是这种情况，您的脚本将必须跟踪您所在的页面，并且每次单击“下一页”都必须通过将其附加到您的 SELECT 查询来告诉 MySQL 从何处返回下一个 10 条记录：

*选择...加入...在哪里...排序*...**限制 20、10**

将返回从完整记录集中第 21 行开始的接下来的 10 行

# c# - 解密时出现错误数据错误

> ID：10359959
> 
> 赞同：0
> 
> 时间：2012-04-28T02:00:39.420
> 
> 标签：c#, cryptography, des

我正在尝试创建一个客户端和服务器，以将文件从客户端安全并加密地发送到服务器。首先，我将使用 RSA 在两端（客户端到服务器）之间发送 DES 密钥。我发送了 RSA public 使用它并将加密的 DES 密钥发送到服务器并解密。然后我将文件名长度、文件名和数据（加密）添加到要发送到服务器的字节数组中。在使用 DES 解密文件时，我收到了错误的数据异常，所以我认为文件发送错误或 DES 密钥从客户端错误地发送到服务器。该文件也可以在源头解密。

这是客户端代码：

```
//encrypt the file with the des key
            byte [] encryptedFile = DESEncrypt(fileBytes);
            MessageBox.Show("enc file length  " + encryptedFile.Length);
            //send the file
            byte[] k = DESdecrypt(encryptedFile);

            byte[] fileNameByte = Encoding.ASCII.GetBytes(Path.GetFileName(filePath.Text));

            byte[] clientData = new byte[4 + fileNameByte.Length + encryptedFile.Length];
            byte[] fileNameLen = BitConverter.GetBytes(fileNameByte.Length);

            fileNameLen.CopyTo(clientData, 0);
            fileNameByte.CopyTo(clientData, 4);
            encryptedFile.CopyTo(clientData, 4 + fileNameByte.Length);

            soc.Send(clientData); 
```

这是服务器代码：

```
byte[] clientData = new byte[1024 * 5000];
                int receivedBytesLen = s.Receive(clientData);
                byte[] b = clientData;
                int fileNameLen = BitConverter.ToInt32(clientData, 0);

                fileName = Encoding.ASCII.GetString(clientData, 4, fileNameLen);
                byte[] l = Encoding.ASCII.GetBytes(fileName);
                Console.WriteLine("Client:{0} connected & File {1} started received.", s.RemoteEndPoint, fileName);
                Console.WriteLine("buffer size  : ", b.Length);
                Console.WriteLine("index  : ", 4 + fileNameLen);

                string temp = System.Text.Encoding.UTF8.GetString(b, 3 + fileNameLen, receivedBytesLen);
                fileBytes = System.Text.Encoding.UTF8.GetBytes(temp);
                Console.WriteLine("rec file");

            }
            catch (Exception exx)
            {
                Console.WriteLine(exx.ToString());
                Console.Read();
            }
            //decrypt
            byte[] decryptedFile = null;
            try
            {

                decryptedFile = DESdecrypt(fileBytes);
            }
            catch(Exception exx)
            {
                Console.WriteLine(exx.ToString());
                Console.Read();
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T12:17:15.870

问题是我试图解密错误的块。这是因为我使用了错误的索引

```
string temp = System.Text.Encoding.UTF8.GetString(b, 3 + fileNameLen, receivedBytesLen); 
```

并更新为：

```
Array.Copy(b, fileNameLen + 4, fileBytes, 0, dataLengthInt - fileNameLen-4); 
```

在我使用的文件中，receivedBytesLen 为 2756 字节，而解密数据为 1496，因此我需要发送数据长度以从数据块中提取它。

# r - 在 ggplot2 中编辑，geom = "line"

> ID：10359963
> 
> 赞同：2
> 
> 时间：2012-04-28T02:01:10.710
> 
> 标签：r, time, ggplot2, dashboard

我有一个我一直在苦苦挣扎的医院发生的一些事件的线图。

我尚未解决的挑战是，1）对绘图上的线进行排序，以便患者线按评估日期排序，2）通过变量“openCase”为线着色，最后，3）我会喜欢删除 2014 年（或其他随机日期）案例的出院点（蓝色方块）。

任何帮助，将不胜感激？

这是我的样本数据，

```
library(ggplot2)
library(plyr)

df <- data.frame(
 date = seq(Sys.Date(), len= 156, by="5 day")[sample(156, 78)],
 openCase = rep(0:1, 39),
 patients = factor(rep(1:26, 3), labels = LETTERS)
)

df <- ddply(df, "patients", mutate, visit = order(date))
df$visit <- as.factor(df$visit)
levels(df$visit) <- c("Assessment (1)", "Treatment (2)", "Discharge (3)")

qplot(date, patients, data = df, geom = "line") + 
geom_point(aes(colour = visit), size = 2, shape=0) 
```

我知道我的示例数据并不完美，因为一些评估数据是在治疗之后，而一些出院数据是在评估数据之前，但是我的基础数据被搞砸的那部分挑战。

此刻的样子， ![客户仪表板草稿](../Images/7ce7b950d66cd2f6a1e43d8536788c7d.png)

### 更新 2012-04-30 16:30:13 PDT

我的数据来自数据库，看起来像这样，

```
df <- structure(list(date = structure(c(15965L, 15680L, 16135L, 15730L, 
15920L, 15705L, 16110L, 15530L, 15575L, 15905L, 16140L, 15795L, 
15955L, 15945L, 16205L, 15675L, 15525L, 15830L, 15625L, 15725L, 
15855L, 15840L, 15615L, 15500L, 15780L, 15765L, 15610L, 15690L, 
16080L, 15570L, 15685L, 16175L, 15740L, 15600L, 15985L, 15485L, 
15605L, 16115L, 15535L, 15755L, 16145L, 16040L, 15970L, 16000L, 
16075L, 15995L, 16010L, 15990L, 15665L, 15895L, 15865L, 16120L, 
15880L, 15930L, 16055L, 15820L, 15650L, 16155L, 15700L, 15640L, 
15505L, 15750L, 15800L, 15775L, 15825L, 15635L, 16150L, 15860L, 
16100L, 15475L, 16050L, 15785L, 15495L, 15810L, 15805L, 15490L, 
15460L, 16085L), class = "Date"), openCase = c(0L, 0L, 0L, 1L, 
1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 
0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 
0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 
1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 
0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L, 1L), patients = structure(c(1L, 
1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 6L, 6L, 
6L, 7L, 7L, 7L, 8L, 8L, 8L, 9L, 9L, 9L, 10L, 10L, 10L, 11L, 11L, 
11L, 12L, 12L, 12L, 13L, 13L, 13L, 14L, 14L, 14L, 15L, 15L, 15L, 
16L, 16L, 16L, 17L, 17L, 17L, 18L, 18L, 18L, 19L, 19L, 19L, 20L, 
20L, 20L, 21L, 21L, 21L, 22L, 22L, 22L, 23L, 23L, 23L, 24L, 24L, 
24L, 25L, 25L, 25L, 26L, 26L, 26L), .Label = c("A", "B", "C", 
"D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", 
"Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"), class = "factor"), 
    visit = structure(c(2L, 1L, 3L, 3L, 1L, 2L, 2L, 3L, 1L, 3L, 
    1L, 2L, 2L, 1L, 3L, 2L, 1L, 3L, 1L, 2L, 3L, 3L, 2L, 1L, 3L, 
    2L, 1L, 3L, 1L, 2L, 1L, 3L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 1L, 
    3L, 2L, 1L, 2L, 3L, 3L, 1L, 2L, 1L, 3L, 2L, 2L, 3L, 1L, 3L, 
    2L, 1L, 3L, 2L, 1L, 1L, 2L, 3L, 3L, 1L, 2L, 2L, 3L, 1L, 1L, 
    3L, 2L, 1L, 3L, 2L, 2L, 1L, 3L), .Label = c("zym", "xov", "poi"
    ), class = "factor")), .Names = c("date", "openCase", "patients", 
"visit"), row.names = c(NA, -78L), class = "data.frame") 
```

中的级别数`visit`和特定标签很可能会发生变化，因此我想要某种代码，我`rank`或`sort`基于我现有的数据而不是（`visit`）生成新变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T02:32:36.767

这是部分方法：

从您对数据的初始定义开始。

首先，我认为你想要`rank(date)`而不是`order(date)`——无论如何，这对我来说更有意义。

```
df <- ddply(df, "patients", mutate, visit = rank(date))
df$visit <- as.factor(df$visit)
levels(df$visit) <- c("Assessment (1)", "Treatment (2)", "Discharge (3)") 
```

按最小日期值重新排序患者（= 评估日期）：

```
df$patients <- reorder(df$patients,df$date,function(x) min(as.numeric(x))) 
```

创建一个缺少出院点的新数据集，它们在 2014 年 1 月 1 日之后的位置（如果您想删除在给定日期之后*评估*的病例的出院点，您需要使用`ddply`）：

```
df2 <- subset(df,!(visit=="Discharge (3)" & date > as.Date("2014-01-01"))) 
```

正如@Joran 上面指出的那样，为不同的变量获得两个单独的色标有点困难，但是这种工作（您必须`openCase`将其与色标结合起来`visit`）

```
ggplot(df, aes(date, patients)) + geom_line(aes(colour=factor(openCase))) + 
    geom_point(data=df2,aes(colour = visit), size = 2, shape=0) 
```

或者（我认为无论如何这更漂亮），您可以`openCase`使用线型进行编码：

```
ggplot(df, aes(date, patients)) + geom_line(aes(linetype=factor(openCase))) + 
    geom_point(data=df2,aes(colour = visit), size = 2, shape=0) 
```

![在此处输入图像描述](../Images/c27bdfd19787dd35307207130003d6b9.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T16:13:55.173

我仍然不确定我是否理解@Ben 的回答有什么问题，但我会尝试添加我自己的一个。从`df`编辑中给出的开始。

`Visit`根据给定日期的顺序创建一个新变量（注意大写 V），即评估/治疗/出院。这是@Ben 的代码，刚刚重写。

```
df <- ddply(df, "patients", mutate, 
  Visit = factor(rank(date),
                 levels = 1:3,
                 labels=c("Assessment (1)", "Treatment (2)", "Discharge (3)"))) 
```

我不明白这与`visit`最初的数据列有何关系；实际上，`visit`以后不再使用原始列：

```
> table(df$Visit, df$visit)

                 zym xov poi
  Assessment (1)  16   7   3
  Treatment (2)    3  16   7
  Discharge (3)    7   3  16 
```

重新排序患者（再次复制 Ben）：

```
df$patients <- reorder(df$patients,df$date,function(x) min(as.numeric(x))) 
```

确定应显示的点的子集（与 Ben 的想法相同，但代码不同）

```
df2 <- df[!((df$Visit == "Discharge (3)") & (df$date > as.Date("2014-01-01"))),] 
```

要添加新内容，这是一种在不影响图例的情况下使线条不同颜色的方法

```
ggplot(df, aes(date, patients)) +
    geom_blank() +
    geom_line(data = df[df$openCase == 0,], colour = "black") +
    geom_line(data = df[df$openCase == 1,], colour = "red") +
    geom_point(data = df2, aes(colour = Visit), size = 2, shape = 0) 
```

![在此处输入图像描述](../Images/ae8fd046a37ae93210b7b332e2323371.png)

# ruby-on-rails-3 - 使用单表继承时是否可以访问父类（而不是子类）？

> ID：10359964
> 
> 赞同：2
> 
> 时间：2012-04-28T02:01:38.590
> 
> 标签：ruby-on-rails-3, sti

我有一个 Post 类，包含 TextPost、ImagePost 和 LinkPost 子类（使用 STI）。这些 Post 类型被指定为字符串`Post.type`（根据 STI 约定）。

我可以打电话给`TextPost.all`, `ImagePost.all`,`LinkPost.all`就可以了。

我以为我仍然可以打电话`Post.all`，但我收到以下错误：

```
ActiveRecord::SubclassNotFound: The single-table inheritance mechanism failed to locate the subclass: 'text'. This error is raised because the column 'type' is reserved for storing the class in case of inheritance. Please rename this column if you didn't intend it to be used for storing the inheritance class or overwrite Post.inheritance_column to use another column for that information. 
```

作为参考，这是我的 schema.rb 的相关部分：

```
create_table "posts", :force => true do |t|
  t.string   "title"
  t.string   "type"
  t.integer  "author_id"
  t.datetime "publish_datetime"
  ...
end 
```

还有我的子类（每个子类都在自己适当命名的 .rb 文件中）：

```
class TextPost < Post
  ...
end

class ImagePost < Post
  ...
end

class LinkPost < Post
  ...
end 
```

**难道我做错了什么？还是在使用 STI 时无法（简单而简洁地）调用父类？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:45:01.730

听起来您的数据库中有一行类型列等于“文本”。Rails 正试图将它引入一个`text`类。看起来你想要的是`TextPost`在类型列中，而不是`text`.

# macos - Mac 应用程序崩溃时不显示 CrashReporter 对话框

> ID：10359966
> 
> 赞同：4
> 
> 时间：2012-04-28T02:02:07.377
> 
> 标签：macos, cocoa

我有一个 Mac 应用商店应用程序，它在崩溃时会默默消失。它不显示 CrashReporter 对话框，让用户有机会向 Apple 报告崩溃。

我在多台机器上看到相同的行为。是否有任何已知的原因导致这种情况发生？

根据[TN2123](https://developer.apple.com/library/mac/#technotes/tn2004/tn2123.html)：

> 此外，如果崩溃的程序以登录的 GUI 用户身份运行，CrashReporter 将向用户显示一个对话框，询问他们是否要向 Apple 提交错误报告

“以登录的 GUI 用户身份运行”是什么意思？窗户必须是可见的吗？

**更新：**

我正在阅读[ReportCrash](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man8/ReportCrash.8.html)的手册页，发现以下内容：

> 对于应用程序崩溃（但不是后台进程崩溃），ReportCrash 将显示一个对话框，通知用户应用程序意外退出并提供重新打开应用程序或将报告发送给 Apple。对于开发人员，可以使用作为开发人员工具的一部分安装的 /Developer/Applications/Utilities/CrashReporterPrefs.app 调整此对话框的行为。

我运行了 CrashReporterPrefs 并将我的 CrashReporter 模式更改为 Developer。当我运行应用程序并触发崩溃时，会显示 CrashReporter 对话框！

所以我想现在的问题是：**“应用程序”崩溃和“后台进程”崩溃有什么区别？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T14:06:25.160

如果您的应用程序使用 LSUIElement 或 LSBackgroundOnly，则它是一个“后台进程”，用于确定是否显示 Crash Reporter。（其他“后台进程”包括 UNIX 领域的守护进程，例如 Apache Web 服务器，以及从 SSH 或 telnet 连接启动的进程。）

# perl - 无法加载“/Compress/Raw/Zlib/Zlib.so”

> ID：10359979
> 
> 赞同：2
> 
> 时间：2012-04-28T02:03:37.330
> 
> 标签：perl

我正在尝试运行变体效果预测器 perl 脚本（通过 ensembl），但出现此错误：

```
Testing VEP script
ERROR: Testing VEP script failed with the following error
Can't load '/home/sahel/perl5/lib/perl5/x86_64-linux/auto/Compress/Raw/Zlib/Zlib.so' for module Compress::Raw::Zlib: /home/sahel/perl5/lib/perl5/x86_64-linux/auto/Compress/Raw/Zlib/Zlib.so: undefined symbol: PL_unitcheckav at /usr/lib64/perl5/5.8.8/x86_64-linux-thread-multi/DynaLoader.pm line 230.
 at /home/sahel/perl5/lib/perl5/Compress/Zlib.pm line 11
Compilation failed in require at /home/sahel/perl5/lib/perl5/Compress/Zlib.pm line 11.
BEGIN failed--compilation aborted at /home/sahel/perl5/lib/perl5/Compress/Zlib.pm line 11.
Compilation failed in require at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/ProteinFunctionPredictionMatrix.pm line 73.
BEGIN failed--compilation aborted at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/ProteinFunctionPredictionMatrix.pm line 73.
Compilation failed in require at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/TranscriptVariationAllele.pm line 65.
BEGIN failed--compilation aborted at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/TranscriptVariationAllele.pm line 65.
Compilation failed in require at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/TranscriptVariation.pm line 57.
BEGIN failed--compilation aborted at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/TranscriptVariation.pm line 57.
Compilation failed in require at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/DBSQL/TranscriptVariationAdaptor.pm line 68.
BEGIN failed--compilation aborted at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/DBSQL/TranscriptVariationAdaptor.pm line 68.
Compilation failed in require at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/VariationFeature.pm line 105.
BEGIN failed--compilation aborted at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/VariationFeature.pm line 105.
Compilation failed in require at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/Utils/VEP.pm line 52.
BEGIN failed--compilation aborted at /projects/sahel_proj/localperl/Bio/EnsEMBL/Variation/Utils/VEP.pm line 52.
Compilation failed in require at variant_effect_predictor.pl line 57.
BEGIN failed--compilation aborted at variant_effect_predictor.pl line 57. 
```

我已经通过 cpan 安装了所有必需的模块，并通过以下方式设置模块的路径：

```
echo 'eval `/projects/sahel_proj/localperl/bin/perl -I ~/perl5/lib/perl5 -Mlocal::lib`' >> ~/.profile 
```

Compress::Raw::Zlib 和 Compress::Zlib 似乎安装成功：

```
./bin/perl -e 'use Compress::Raw::Zlib;'
./bin/perl -e 'use Compress::Zlib;' 
```

所以我想不出什么是错的，在网上找不到任何东西......

这是我第一次使用 perl 的经验 :( 任何帮助将不胜感激......

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T07:57:57.930

似乎有 Perl 版本不匹配。迹象表明：`.so`您正在加载的内容是使用一个版本的 Perl 构建的，并且正在由不兼容的 Perl 版本加载。

我怀疑您的测试是用一个`perl`（用于安装模块的那个）完成的，而实际程序是用另一个运行的`perl`。

现在你知道为什么我无法理解为什么人们认为`INSTALL_BASE`aka`--install_base`是个好主意。当然，目录结构更漂亮，但它会导致这些问题！您正在通过 local::lib使用`INSTALL_BASE`aka `--install_base`（一种告知模块安装位置`Makefile.PL`和安装位置的方法）。`Build.PL`

解决方案 1。

`perl`使用与安装模块相同的脚本运行脚本。

解决方案 2。

摆脱 local::lib 安装模块的目录并重新安装它们而不使用 local::lib：

```
perl Makefile.PL PREFIX=~ LIB=~/lib/perl5
make
make test
make install 
```

或者

```
perl Build.PL --prefix ~ --lib ~/lib/perl5
./Build
./Build test
./Build install 
```

如果您同时使用上述两种方法`perl`，则两种方法都可以使用特定于版本的模块`perl`。如果您仅使用一个 执行上述操作`perl`，则特定于版本的模块将仅适用于该`perl`. 没有冲突。

（您可以`cpan`通过配置它来使用上述命令。）

不要忘记告诉`perl`您模块的位置。在您的登录脚本中，

```
export PERL5LIB=~/lib/perl5 
```

# javascript - 将跨度文本复制到隐藏的输入值

> ID：10359984
> 
> 赞同：0
> 
> 时间：2012-04-28T02:05:37.817
> 
> 标签：javascript, jquery, html, css

我已经尝试了大约两周来找到这个问题的答案。行。我正在尝试复制跨度文本（更改）并将其放入输入值中。我这样做的原因是我可以通过电子邮件收到用户选择的内容。这是我的代码。[http://jsfiddle.net/Hunter4854/qfdvE/](http://jsfiddle.net/Hunter4854/qfdvE/)

请发布一个jsfiddle。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T02:09:28.143

```
$(function(){
    $("#test_select").change(function(){
        $("#dropdown").val($(this).val());        
    });    
});
​ 
```

**编辑**：如果您想获取跨度（装饰下拉菜单）的值并设置为隐藏，您需要更新示例中的这部分代码。新添加的行以粗体显示

```
$lists.live('click',function(e) {
    e.stopPropagation();
    $lists.not(this).find('ul:visible').hide()
    var $tgt = $(e.target);
    $(this).find('ul').slideToggle('fast');
    if ($tgt.is('li')) {
        $(this).find('span').html($tgt.html());
        var value=$tgt.attr('rel');    

        $("#dropdown").val(value);   //This line is what you want

        $('#test_select').val( value);
    }   

}) 
```

# python - += 在 python 线程中是安全的吗？

> ID：10359985
> 
> 赞同：8
> 
> 时间：2012-04-28T02:05:44.013
> 
> 标签：python

```
globalnum = 0
n = 1

class T( threading.Thread ):
  def run( self ):
    global globalnum
    globalnum += n

for _ in xrange( 0, 999 ):
  t = T()
  t.start()

print globalnum 
```

结果是 999 在我的测试中，我似乎 += 线程安全我的问题是：+= 真的是线程安全的吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-28T02:13:41.310

不，它不是线程安全的，因为该操作`x += 1`需要 4 个操作码，如下所示：

```
 4           0 LOAD_GLOBAL              0 (x)
              3 LOAD_CONST               1 (1)
              6 INPLACE_ADD         
              7 STORE_GLOBAL             0 (x) 
```

选自：

```
>>> import dis
>>> def test():
...     global x
...     x += 1
...     
... 
>>> dis.disassemble(test.func_code)
  4           0 LOAD_GLOBAL              0 (x)
              3 LOAD_CONST               1 (1)
              6 INPLACE_ADD         
              7 STORE_GLOBAL             0 (x)
             10 LOAD_CONST               0 (None)
             13 RETURN_VALUE 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-28T02:13:15.860

`+=` is not threadsafe ([source](http://effbot.org/pyfaq/what-kinds-of-global-value-mutation-are-thread-safe.htm)).

# jquery - jQuery拖入后调用函数

> ID：10359992
> 
> 赞同：3
> 
> 时间：2012-04-28T02:07:13.030
> 
> 标签：jquery, syntax

我试图在拖动后调用一个函数来检查 div 的位置，但我不知道如何使它工作。我已经像这样和其他一些方式写出来了，但它要么导致整个事情不起作用，要么函数没有被调用：

```
$(".block").draggable(),function() { check(); }; 
```

有没有一种简单的方法来完成这项工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T02:14:04.390

有一个名为 的事件`stop`。你可以在这里阅读：http: [//jqueryui.com/demos/draggable/#event-stop](http://jqueryui.com/demos/draggable/#event-stop)。

停止拖动后获取被拖动元素位置的示例代码可以是这样的：

```
$(".block").draggable({
    stop: function(event, ui) {
        var pos = ui.helper.position(); // just get pos.top and pos.left
    }
}); 
```

在此处检查工作解决方案：http: [//jsfiddle.net/rcmyy/](http://jsfiddle.net/rcmyy/)

# python - 转到字符串中的某个位置

> ID：10359993
> 
> 赞同：0
> 
> 时间：2012-04-28T02:07:17.130
> 
> 标签：python, string, coordinates

我想在与我所得到的相反（从负侧）的字符串上到达某个点。

啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊！

所以你需要转换坐标。在底链上，碱基 0（最右边的 C）与顶链上的碱基 39 相对。以 1 为底数与 38 为底数。以 2 为底数以 37 为底数。（重要一点：注意每次将这两个数字相加时会发生什么。）因此，以 10 为底数以 29 为底数，以 19 为底数以 20 为底数。

所以：如果我想在底部链上找到基数 10-20，我可以查看顶部的基数 20-29（然后反向补码）。

我写了以下内容：

```
fp = open(infile, 'r')
for line in fp:
   tokens = line.split()
   exonstarts = tokens[8][:-1].split(',')
   exonends = tokens[9][:-1].split(',')
   zipped = list(zip(exonstarts, exonends))
   chrom_len = len(chr_string)
   s = ''.join(bc[base.upper()] for base in chr_string[-starts-1:-ends-1] for starts, ends in zipped)+'\n' 
```

然而，每次我这样做时，我都会得到：

错误：未定义全局名称“starts”

我该如何解决？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T02:44:01.980

尝试在最后一个术语周围添加括号：

```
s = ''.join(bc[base.upper()] for base in (chr_string[-starts-1:-ends-1]\
                                         ^
            for starts, ends in zipped)) +'\n'
                                      ^ 
```

您在这里定义了两个不同的生成器。这相当于：

```
strands = (chr_string[-starts-1:-ends-1] for starts, ends in zipped)
complementary_strands = (bc[base.upper()] for base in stage_1)
joined_exons = ''.join(stage_2) + '\n' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T02:40:19.720

*看起来您试图在生成器表达式*中做太多事情。

这两个`for`s 是错误的方式。你的意思是：

```
s = ''.join(bc[base.upper()] for starts,ends in zipped for base in chr_string[-starts-1:-ends-1])+'\n' 
```

然后`starts`和`ends`被定义为第二个`for`。

鉴于您今天提出的问题，我建议您阅读[一本好书](https://stackoverflow.com/questions/22873/language-books-tutorials-for-popular-languages)，例如[Dive Into Python 3](http://getpython3.com/diveintopython3/)，以便您自己解决这些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T02:10:13.823

您正在定义 exonstarts 然后引用未定义的开始。

# django - 如何让 Chrome 尊重我的字段名称而不尝试自动完成

> ID：10359998
> 
> 赞同：1
> 
> 时间：2012-04-28T02:09:16.017
> 
> 标签：django, forms, google-chrome, autocomplete

我的主页上有两种不同的表单：一种用于登录，一种用于注册。从代码中可以看出，表单具有不同名称的输入：

```
<h3> Log In </h3>
<form action="/login/" method="POST" class="form-vertical" style="padding-top: 5px">
  <input id="id_login_username" type="text" name="login_username" maxlength="25" />
  <input type="password" name="login_password" id="id_login_password" /><br>
  <button type="submit" class="btn btn-info">Login</button>
</form>

<h3> Sign Up <small>(It's free!)</small></h3>
<form action="/register/" method="POST" class="form-vertical" style="padding-top: 5px">
  <input id="id_register_username" type="text" name="register_username" maxlength="25" />
  <input type="text" name="register_email" id="id_register_email" />
  <input type="password" name="register_password" id="id_register_password" />
  <input type="password" name="register_password2" id="id_register_password2" /><br>
  <button type="submit" class="btn">Submit</button>
</form> 
```

这在 Chrome 中呈现：

![在此处输入图像描述](../Images/531fb7a9cb26b2f75d6508926929566a.png)

这可能是什么原因造成的？我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T07:37:56.483

> 这是一个非常好的问题，我很抱歉说我不知道​​。您是否尝试注册一次并至少登录一次？如果是这样，那“可能”就是导致它的原因，因为浏览器配备了“自动记忆”功能。

假设启用了自动填充（默认情况下），它自动填充其余部分的原因是因为 chrome 的自动填充服务器适用于正则表达式，而不是完全匹配。

用于各种字段的所有正则表达式都可以在[`autofill_regex_constants.cc.utf8`](http://code.google.com/codesearch#OAMlx_jo-ck/src/chrome/browser/autofill/autofill_regex_constants.cc.utf8).

从那里您可以看到电子邮件字段的表达式是`"e.?mail"`，用户名的表达式是`"user.?name|user.?id|nickname|maiden name|title|prefix|suffix"`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T02:18:14.827

之前似乎有人问过类似的问题：

[停止表单输入框自动完成的正确方法是什么？](https://stackoverflow.com/questions/3306920/what-is-the-correct-way-to-stop-form-input-boxes-auto-completing)

您可以在表单字段中使用自动**完成属性。**

```
<input id="id_login_username" type="text" name="login_username" maxlength="25" autocomplete="off" /> 
```