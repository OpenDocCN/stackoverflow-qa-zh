# StackOverflow 问答 10572000-10572999

# javascript - 下拉列表 - 单击选项时显示 div

> ID：10572004
> 
> 赞同：2
> 
> 时间：2012-05-13T13:09:05.237
> 
> 标签：javascript, html

您必须编写一个函数，根据用户选择的内容“显示”表单的相应部分。例如，如果选择了“Pizza”，则应显示带有有关 Pizza 类型问题的 div #section2。

这是html代码的一部分

```
<form id="survey" action="#" method="post">

<div id="section1">
    <label for="food">What is your favourite type of food?</label>
    <select id="food" onchange="selection()">
        <option value="pizza">Pizza</option>
        <option value="mex">Mexican</option>
        <option value="thai">Thai</option>
    </select>
</div>
<div id="section2">
    What is your favourite type of pizza?<br>
    <label for="hawaiian">Hawaiian</label><input type="radio" id="hawaiian">
    <label for="supreme">Supreme</label><input type="radio" id="supreme">
    <label for="vegetarian">Vegetarian</label><input type="radio" id="vegetarian">
</div> 
```

我将如何编写一个 javascript 函数，以便当我单击选项比萨时，它将显示第 2 部分？我是一个完整的 javascript 新手，所以任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T13:43:17.447

演示：http: [//jsfiddle.net/iambriansreed/rQr6v/](http://jsfiddle.net/iambriansreed/rQr6v/)

JavaScript：

```
var sections = {
    'pizza': 'section2',
    'mex': 'section3',
    'thai': 'section4'   
};

var selection = function(select) {

    for(i in sections)
        document.getElementById(sections[i]).style.display = "none";    

    document.getElementById(sections[select.value]).style.display = "block";

} 
```

查看演示。用实际内容替换`section3`和`section4`div。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T13:15:29.367

有很多解决方案。最简单的选项之一是稍微更改您的标记并使用`div`ID。

*HTML：*

```
<div id="section1">
    <label for="food">What is your favourite type of food?</label>
    <select id="food" onchange="selection(this)">
        <option value="pizza">Pizza</option>
        <option value="mex">Mexican</option>
        <option value="thai">Thai</option>
    </select>
</div>
<div id="section_pizza" style="display: none;">
    What is your favourite type of pizza?<br>
    <label for="hawaiian">Hawaiian</label><input type="radio" id="hawaiian">
    <label for="supreme">Supreme</label><input type="radio" id="supreme">
    <label for="vegetarian">Vegetarian</label><input type="radio" id="vegetarian">
</div> 
```

*JavaScript：*

```
function selection(select) {
    document.getElementById("section_" + select.value).style.display = "block";
} 
```

* * *

但是，您可以使用[JQuery 库](http://jquery.com/)并使其更快、更灵活。您可以轻松地将动画添加到块并添加额外的功能。

*HTML：*

```
<div id="section1">
    <label for="food">What is your favourite type of food?</label>
    <select id="food">
        <option value="pizza">Pizza</option>
        <option value="mex">Mexican</option>
        <option value="thai">Thai</option>
    </select>
</div>
<div id="section2" data-type="pizza" style="display: none;">
    What is your favourite type of pizza?<br>
    <label for="hawaiian">Hawaiian</label><input type="radio" id="hawaiian">
    <label for="supreme">Supreme</label><input type="radio" id="supreme">
    <label for="vegetarian">Vegetarian</label><input type="radio" id="vegetarian">
</div> 
```

*JavaScript：*

```
$("#food").change(function() {
    $("[data-type]").hide();
    $("[data-type='" + this.value + "']").show(1000);
}); 
```

# javascript - 我可以用普通按钮替换 OpenLayers 编辑工具栏吗？

> ID：10572005
> 
> 赞同：4
> 
> 时间：2012-05-13T13:09:15.153
> 
> 标签：javascript, openlayers

这个小[`OpenLayers.Control.EditingToolbar`](http://dev.openlayers.org/docs/files/OpenLayers/Control/EditingToolbar-js.html)from 默认插入：

![](../Images/9ab940e1ef2889a335d2e27dd5b2ecb8.png)

这些按钮的含义并不十分明显。我想用一个按钮组替换这个编辑工具栏（例如 Twitter Bootstrap 提供的那个）：

![](../Images/ff72dd10698c38b7bfc7b7f0492d8877.png)

当前编辑工具栏的标记是这样的：

```
<div id="panel" class="olControlEditingToolbar">
  <div class="olControlNavigationItemInactive olButton"></div>
  <div class="olControlDrawFeaturePointItemActive olButton"></div>
  <div class="olControlDrawFeaturePathItemInactive olButton"></div>
  <div class="olControlDrawFeaturePolygonItemInactive olButton"></div>
</div> 
```

这些图像是基本的精灵——所以我知道我可以改变这些。但我看不出我怎么能摆脱这些`div`s，用 s 代替它们`button`。我想过手动创建按钮组并向按钮添加`click()`事件侦听器，触发 OpenLayers 的不同编辑模式。但我找不到任何关于如何做到这一点的文档。

* * *

所以，基本上，我看到了这些选项：

*   手动创建按钮组，并通过我自己的 JS 触发相应的 OpenLayers 事件——但我需要触发哪些事件？

*   不要使用`EditingToolbar`，而是使用 OpenLayers 手动构建我的工具栏——我该怎么做？

*   通过破解 OpenLayers 源代码来修改自动创建的编辑工具栏*（嗯……）* ——这值得吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T13:30:07.390

最好的方法是手动构建控制按钮。基于[Draw Feature Example](http://openlayers.org/dev/examples/draw-feature.html)，您可以继续添加控件：

```
drawControls = {
  point: new OpenLayers.Control.DrawFeature(pointLayer,
      OpenLayers.Handler.Point),
  line: new OpenLayers.Control.DrawFeature(lineLayer,
      OpenLayers.Handler.Path),
  polygon: new OpenLayers.Control.DrawFeature(polygonLayer,
      OpenLayers.Handler.Polygon),
  )
};

for(var key in drawControls) {
  map.addControl(drawControls[key]);
} 
```

然后，添加一个函数，根据单击的元素更改当前使用的控件：

```
function toggleControl(element) {
    for(key in drawControls) {
        var control = drawControls[key];
        if(element.value == key && element.checked) {
            control.activate();
        } else {
            control.deactivate();
        }
    }
} 
```

最后，自己创建 HTML 标记。对于更改控件的每个元素，添加一个`onClick`调用该`toggleControl`函数的处理程序。您也可以通过 jQuery 附加点击处理程序，但本质上，这是有效的：

```
<ul id="controlToggle">
  <li>
      <input type="radio" name="type" value="none" id="noneToggle"
             onclick="toggleControl(this);" checked="checked" />
      <label for="noneToggle">navigate</label>
  </li>
  <li>
      <input type="radio" name="type" value="point" id="pointToggle" onclick="toggleControl(this);" />
      <label for="pointToggle">draw point</label>
  </li>
  <!-- add more elements here, based on which draw modes you added -->
</ul> 
```

您可以[在此处查看此操作](http://maphub.herokuapp.com/)（使用测试用户注册，无需真正的电子邮件）并[在 GitHub 上找到代码](https://github.com/maphub/maphub-portal/blob/master/app/assets/javascripts/maps/annotation_view.js.erb)。

# java - JTable 不更新 fireXXXX() 事件

> ID：10572006
> 
> 赞同：1
> 
> 时间：2012-05-13T13:09:17.030
> 
> 标签：java, swing, model-view-controller, user-interface

我的项目中发生了一些错误的事情。抱歉，这里有很大一部分代码：

```
public abstract class RowTableModel<T> extends AbstractTableModel {
protected List<T> modelData;
protected List<String> columnNames;
@SuppressWarnings("rawtypes")
protected Class[] columnClasses;
protected Boolean[] isColumnEditable;
@SuppressWarnings("rawtypes")
private Class rowClass = Object.class;
private boolean isModelEditable = true;

@SuppressWarnings("rawtypes")
protected RowTableModel(Class rowClass) {
    setRowClass(rowClass);
}

protected RowTableModel(List<String> columnNames) {
    this(new ArrayList<T>(), columnNames);
}

protected RowTableModel(List<T> modelData, List<String> columnNames) {
    setDataAndColumnNames(modelData, columnNames);
}

@SuppressWarnings("rawtypes")
protected RowTableModel(List<T> modelData, List<String> columnNames, Class rowClass) {
    setDataAndColumnNames(modelData, columnNames);
    setRowClass(rowClass);
}

protected void setDataAndColumnNames(List<T> modelData, List<String> columnNames) {
    this.modelData = modelData;
    this.columnNames = columnNames;
    columnClasses = new Class[getColumnCount()];
    isColumnEditable = new Boolean[getColumnCount()];
    fireTableStructureChanged();
}

@SuppressWarnings("rawtypes")
protected void setRowClass(Class rowClass) {
    this.rowClass = rowClass;
}

@SuppressWarnings({"rawtypes", "unchecked"})
public Class getColumnClass(int column) {
    // Class columnClass = null;
    //
    // if (column < columnClasses.length)
    // columnClass = columnClasses[column];
    //
    // // Get the default class
    //
    // if (columnClass == null)
    // columnClass = super.getColumnClass(column);
    //
    // return columnClass;
    Class columnClass = getValueAt(0, column).getClass();
    if (columnClass != null) {
        return columnClass;
    } else {
        return String.class;
    }

}
public int getColumnCount() {
    return columnNames.size();
}

public String getColumnName(int column) {
    Object columnName = null;

    if (column < columnNames.size()) {
        columnName = columnNames.get(column);
    }

    return (columnName == null) ? super.getColumnName(column) : columnName.toString();
}

public int getRowCount() {
    return modelData.size();
}

public boolean isCellEditable(int row, int column) {
    Boolean isEditable = null;

    // Check is column editability has been set

    if (column < isColumnEditable.length)
        isEditable = isColumnEditable[column];

    return (isEditable == null) ? isModelEditable : isEditable.booleanValue();
}

public void addRow(T rowData) {
    insertRow(getRowCount(), rowData);
}

public T getRow(int row) {
    return modelData.get(row);
}

@SuppressWarnings("unchecked")
public T[] getRowsAsArray(int... rows) {
    List<T> rowData = getRowsAsList(rows);
    T[] array = (T[]) Array.newInstance(rowClass, rowData.size());
    return (T[]) rowData.toArray(array);
}

public List<T> getRowsAsList(int... rows) {
    ArrayList<T> rowData = new ArrayList<T>(rows.length);

    for (int i = 0; i < rows.length; i++) {
        rowData.add(getRow(rows[i]));
    }

    return rowData;
}

public void insertRow(int row, T rowData) {
    modelData.add(row, rowData);
    fireTableRowsInserted(row, row);
}

public void insertRows(int row, List<T> rowList) {
    modelData.addAll(row, rowList);
    fireTableRowsInserted(row, row + rowList.size() - 1);
}

public void insertRows(int row, T[] rowArray) {
    List<T> rowList = new ArrayList<T>(rowArray.length);

    for (int i = 0; i < rowArray.length; i++) {
        rowList.add(rowArray[i]);
    }

    insertRows(row, rowList);
}

public void moveRow(int start, int end, int to) {
    if (start < 0) {
        String message = "Start index must be positive: " + start;
        throw new IllegalArgumentException(message);
    }

    if (end > getRowCount() - 1) {
        String message = "End index must be less than total rows: " + end;
        throw new IllegalArgumentException(message);
    }

    if (start > end) {
        String message = "Start index cannot be greater than end index";
        throw new IllegalArgumentException(message);
    }

    int rowsMoved = end - start + 1;

    if (to < 0 || to > getRowCount() - rowsMoved) {
        String message = "New destination row (" + to + ") is invalid";
        throw new IllegalArgumentException(message);
    }

    // Save references to the rows that are about to be moved

    ArrayList<T> temp = new ArrayList<T>(rowsMoved);

    for (int i = start; i < end + 1; i++) {
        temp.add(modelData.get(i));
    }

    // Remove the rows from the current location and add them back
    // at the specified new location

    modelData.subList(start, end + 1).clear();
    modelData.addAll(to, temp);

    // Determine the rows that need to be repainted to reflect the move

    int first;
    int last;

    if (to < start) {
        first = to;
        last = end;
    } else {
        first = start;
        last = to + end - start;
    }

    fireTableRowsUpdated(first, last);
}

public void removeRowRange(int start, int end) {
    modelData.subList(start, end + 1).clear();
    fireTableRowsDeleted(start, end);
}

public void removeRows(int... rows) {
    for (int i = rows.length - 1; i >= 0; i--) {
        int row = rows[i];
        modelData.remove(row);
        fireTableRowsDeleted(row, row);
    }
}

public void replaceRow(int row, T rowData) {
    modelData.set(row, rowData);
    fireTableRowsUpdated(row, row);
}

@SuppressWarnings("rawtypes")
public void setColumnClass(int column, Class columnClass) {
    columnClasses[column] = columnClass;
    fireTableRowsUpdated(0, getColumnCount() - 1);
}

public void setColumnEditable(int column, boolean isEditable) {
    isColumnEditable[column] = isEditable ? Boolean.TRUE : Boolean.FALSE;
}

public void setModelEditable(boolean isModelEditable) {
    this.isModelEditable = isModelEditable;
}

public static String formatColumnName(String columnName) {
    if (columnName.length() < 3)
        return columnName;

    StringBuffer buffer = new StringBuffer(columnName);
    boolean isPreviousLowerCase = false;

    for (int i = 1; i < buffer.length(); i++) {
        boolean isCurrentUpperCase = Character.isUpperCase(buffer.charAt(i));

        if (isCurrentUpperCase && isPreviousLowerCase) {
            buffer.insert(i, " ");
            i++;
        }

        isPreviousLowerCase = !isCurrentUpperCase;
    }

    return buffer.toString().replaceAll("_", " ");
} 
```

}

这是抽象表模型，我这样扩展：

```
public class ProfessorTableModel extends RowTableModel<Professor> {

public ProfessorTableModel(List<Professor> modelData,
        List<String> columnNames) {
    super(modelData, columnNames);
}

@Override
public Object getValueAt(int rowIndex, int columnIndex) {
    Professor professor = super.getRow(rowIndex);
    switch (columnIndex) {
    case 0: {
        return professor.getId();
    }
    case 1: {
        return professor.getSurname();
    }
    case 2:{
        return professor.getName();
    }
    case 3:{
        return professor.getPatronymic();
    }
    case 4:{
        return professor.getMail();
    }
    case 5:{
        return professor.getPhone();
    }
    case 6:{
        return professor.getDays();
    }
    default:
        return null;
    }
}

@Override
public boolean isCellEditable(int row, int column) {
    return false;
} 
```

像这样：

```
public class LessonTableModel extends RowTableModel<Lesson>{
    public LessonTableModel(List<Lesson> modelData,
            List<String> columnNames) {
        super(modelData, columnNames);
    }

    @Override
    public Object getValueAt(int rowIndex, int columnIndex) {
        Lesson lesson = super.getRow(rowIndex);
        switch (columnIndex) {
        case 0: {
            return lesson.getId();
        }
        case 1: {
            return lesson.getProfessor();
        }
        case 2:{
            return lesson.getCourse();
        }
        case 3:{
            return lesson.getGroup();
        }
        case 4:{
            return lesson.isLab();
        }
        default:
            return null;
        }
    }

    @Override
    public boolean isCellEditable(int row, int column) {
        return false;
    }
} 
```

因此，在模型的第一种情况下，我进行了以下编辑：

```
int[] selectedIndexes = professorTable.getSelectedRows();
            if (selectedIndexes.length == 1) {
                int selectedIndex = professorTable.convertRowIndexToModel(professorTable.getSelectedRow());
                Professor professor = professorTableModel.getRow(selectedIndex);
                ProfessorFrame professorFrame = ProfessorFrame.show(professor);
                if (professorFrame.getDialogResult() == DialogResult.OK) {
                    professorTableModel.replaceRow(selectedIndex, professorFrame.getProfessor());
                }
            } 
```

在第二种情况下，我做的几乎一样：

```
int[] selectedIndexes = lessonTable.getSelectedRows();
                    if (selectedIndexes.length == 1) {
                        int selectedIndex = lessonTable.convertRowIndexToModel(lessonTable.getSelectedRow());
                        Lesson lesson = lessonTableModel.getRow(selectedIndex);
                        LessonFrame lessonFrame = LessonFrame.show(lesson);
                        if (lessonFrame.getDialogResult() == DialogResult.OK) {
                            lessonTableModel.replaceRow(selectedIndex, lessonFrame.getLesson());
                        }
                    } 
```

但在第一种情况下，表格会正确更新，而在第二种情况下，我单击表格后会应用更新。我知道有大量的代码字符串，但我真的希望有人能提供帮助。（尝试用 fireTableDataChanged 替换 fireTableRowInserted，但没有任何改变）

提前感谢大家，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T06:32:47.307

问题在于框架的形式。ProfessorFrame 是模态的，而 LessonFrame 不是。这就是为什么第一种情况下的更改正确应用导致编辑的值被挂钩，而在第二种情况下，代码执行时没有暂停（模态暂停），并且没有新值被挂钩。感谢@HovercraftFullOfEels 的帮助和建议。

# php - 使用 IN 子句与多个 SELECT

> ID：10572007
> 
> 赞同：6
> 
> 时间：2012-05-13T13:09:34.430
> 
> 标签：php, mysql

我想知道其中哪一个会更快（在性能方面）查询（如果这很重要，在 MySQL 5.x CentOS 5.x 上）：

```
SELECT * FROM table_name WHERE id=1;
SELECT * FROM table_name WHERE id=2;
.
.
.
SELECT * FROM table_name WHERE id=50; 
```

或者...

```
SELECT * FROM table_name WHERE id IN (1,2,...,50); 
```

我有大约 50`id`秒的时间要查询。我知道通常数据库连接很昂贵，但我发现该`IN`子句 [有时] 也不是那么快。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T13:12:09.277

我很确定第二个选项可以为您提供最佳性能；一个查询，一个结果。在它可能成为问题之前，您必须开始寻找 > 100 个项目。

另请参阅此处接受的答案：[MySQL "IN" operator performance on (large?) number of values](https://stackoverflow.com/questions/4514697/mysql-in-operator-performance-on-large-amount-of-values)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-13T13:12:11.417

恕我直言，您应该尝试一下并测量响应时间：`IN`应该会给您更好的性能...
无论如何，如果您的 id 是连续的，您可以尝试

```
SELECT * FROM table_name WHERE id BETWEEN 1 AND 50 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T13:14:41.953

这是另一篇文章，讨论了使用 OR 与 IN 的性能。 [SQL WHERE 子句中的 IN 与 OR](https://stackoverflow.com/questions/3074713/in-vs-or-in-the-sql-where-clause)

您建议使用多个查询，但使用 OR 也可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T13:30:25.990

2nd会更快，因为在查询被解释时以及在与mysql进行php通信以发送查询和等待结果时会消耗资源，如果您的数据是连续的，您也可以这样做

```
 SELECT * FROM table_name WHERE id <= 50; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T15:21:43.450

`IN`在一个子句中试验了 3000 多个值之后，我正在研究这个。事实证明，它比单个`SELECT`s 快很多，因为 s 中引用的列`IN`没有键控。我的猜测是，在我的情况下，它只需要为该列构建一个临时索引一次，而不是 3000 次单独的时间。

# php - 寻找最新的 PayPal API？

> ID：10572009
> 
> 赞同：2
> 
> 时间：2012-05-13T13:10:01.133
> 
> 标签：php, paypal

我在查找 PayPal 的最新 API 版本时遇到问题。我找到的当前版本是 51.0，但它不是最新版本。

我需要在付款摘要中添加项目，并且版本必须 >= 53.0。

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECCustomizing](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECCustomizing)

我在哪里可以找到最新的 PHP API 示例？(NVP)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:20:31.857

您可以[在此处](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_reference)参考 PayPal API 参考，向下滚动以查看您的 NVP 参考。

我不明白您正在尝试自定义快速结帐，请参阅[此处](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_ExpressCheckout_IntegrationGuide.pdf)以获取*PayPal 快速结帐集成指南*(PDF)。

虽然技术文档页面[在这里](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/library_documentation)。

当我浏览这些内容时，它似乎在**April 2012**的某个时候更新。

只需使用当前的 PayPal API 版本。当前版本是**89.0**。这似乎很棘手，但要找到 PayPal 的 API 版本是通过查看 PayPal 网页的源代码。您会在标题中看到如下所示的片段：

```
<!--
        Script info: script: webscr, cmd: _home, template: xpt/Marketing_CommandDriven/homepage/MainHome, date: May 9, 2012 08:36:29 PDT; country: US, language: en_US, xslt server: 
        web version: 89.0-2920756 branch: UPR_890_int
        content version: -
        pexml version: 89.0-2896586
        page XSL: Marketing_CommandDriven/default/en_US/homepage/MainHome.xsl
       hostname : HuqmOnXTzOtlL7CprWmgAQwFlQK1lZ0z6u5fc-r5fMk
         rlogid : HuqmOnXTzOtlL7CprWmgAYVSw2GbAGynG1%2bkpma0nBQchRCqNea%2ffA%3d%3d_1374663724c
--> 
```

`web version: 89.0-2920756`说明 API 版本。好像不靠谱吧？一个月前，当我做一些需要 PayPal 的项目时，我才关注这个[线程。](https://www.x.com/developers/paypal/forums/nvp/latest-paypal-api-version-api-calls)但是，嘿，它正在工作。

# android - 如何在意图之间传递对象

> ID：10572010
> 
> 赞同：1
> 
> 时间：2012-05-13T13:10:03.293
> 
> 标签：android, android-intent, parcelable

我有一个包含我想在意图之间传递它的数据的类，这个类有包含另一个类对象的arraylist。这是我的课

```
 public class ParsedData implements Parcelable {

        public String error;
        public float protectionLevel;
        public int protectionLevelColor;
        public double lastBackup;
        public boolean compressedType;
        public Long driveFreeSpaceSize;
        ArrayList<Item>Items = new ArrayList<Item>();
}

class Item {

    public String name;
    public float percentage;
    public int files;
    public long size;
} 
```

我如何在意图之间发送这个类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:16:15.373

你可以让你`class Item`实现`Serializable`接口，并使用[Intent.putExtra(String, Serializable)](http://developer.android.com/reference/android/content/Intent.html#putExtra%28java.lang.String,%20java.io.Serializable%29)。由于`ArrayList`还实现了`Serializable`接口，因此您可以传递整个`Items`对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T13:19:09.173

您可以查看 Intent.putExtra(String name, Parcelable object) 并在您的类中实现 parcelable 接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T14:19:44.560

这可能是你的问题：

> 实现 Parcelable 接口的类还必须有一个名为 的静态字段`CREATOR`，它是实现该`Parcelable.Creator`接口的对象。

或者，我也会尝试`Item`实现 implement `Parcelable`。

故障安全的替代方法是将您的数据结构写入 JSON 字符串，这还允许您将数据传递给无权访问您的`ParsedData`类的其他应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T07:44:28.903

毕竟我找到了答案。感谢所有对我的帮助这是答案：

```
import android.os.Parcel;
import android.os.Parcelable;

public class ParsedData implements Parcelable  {

    public String error;
    public float protectionLevel;
    public int protectionLevelColor;
    public double lastBackup;
    public boolean compressedType;
    public Long statusSendTime;
    ArrayList<Item>Items = new ArrayList<Item>();

    //---------------------Constructors---------------------------
    public ParsedData() { ; };

    public ParsedData(Parcel in) {
        readFromParcel(in);
    }
    //------------------------------------------------------------

    @Override
    public int describeContents() {
        return 0;
    }
    @Override
    public void writeToParcel(Parcel dest, int flags) {
        dest.writeString(error);
        dest.writeFloat(protectionLevel);
        dest.writeInt(protectionLevelColor);
        dest.writeDouble(lastBackup);
        dest.writeByte((byte) (compressedType ? 1 : 0));  
        dest.writeLong(statusSendTime);
        dest.writeList(Items);

    }

    private void readFromParcel(Parcel in) {
        error = in.readString();
        protectionLevel = in.readFloat();
        protectionLevelColor = in.readInt();
        lastBackup = in.readDouble();
        compressedType =in.readByte() == 1; 
        statusSendTime = in.readLong();
        in.readList(Items,Item.class.getClassLoader() );

    }

     public static final Parcelable.Creator CREATOR = new Parcelable.Creator() {
                    public ParsedData createFromParcel(Parcel in) {
                        return new ParsedData(in);
                    }

                    public ParsedData[] newArray(int size) {
                        return new ParsedData[size];
                    }
                };
}

class Item implements Parcelable {

    public String name;
    public float percentage;

    //---------------------Constructors---------------------------
    public Item() {
       }
    public Item(Parcel in) {
          readFromParcel(in);
       }
    //------------------------------------------------------------

    @Override
    public int describeContents() {
        return 0;
    }
    @Override
    public void writeToParcel(Parcel dest, int flags) {
        dest.writeString(name);
        dest.writeFloat(percentage);
    }
    public static final Creator<Item> CREATOR = new Creator<Item>() {
          public Item createFromParcel(Parcel source) {
             return new Item(source);
          }
          public Item[] newArray(int size) {
             return new Item[size];
          }
       };
       private void readFromParcel(Parcel in) {
           this.name = in.readString();
           this.percentage = in.readFloat();
           }
} 
```

并在调用者活动中

```
 ParsedData data = new PArsedData();
    Intent intentBreakDown = new Intent(this,BreakDownBarActivity.class);
    intentBreakDown.putExtra("data", data);
    startActivity(intentBreakDown); 
```

在被调用的活动中（在我的情况下为 BreakDownBarActivity）

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.breakdownbar);

        Bundle b = getIntent().getExtras();
        ParsedData data = (ParsedData)b.getParcelable("data");
    } 
```

# at-command - AT 命令 (ATD) 拨打网络服务号码(**21* ;) 在华为调制解调器上

> ID：10572022
> 
> 赞同：1
> 
> 时间：2012-05-13T13:10:59.650
> 
> 标签：at-command

我在使用华为调制解调器拨打服务命令（例如：ATD* *21* #;）时遇到问题，而它与具有相同 AT 命令集和相同 SIM 卡的 teracom 调制解调器完美配合，

在 teracom 上，

```
phone_cmd(conn,"ATE0")  
phone_cmd(conn,"AT+CFUN=1")  
phone_cmd(conn,"AT+CMEE=1")  
phone_cmd(conn,"AT+CPIN?")  
phone_cmd(conn,"AT*ECAM=1")  
phone_cmd(conn,"AT*EREG=2")  
phone_cmd(conn,"AT+CLIP=1;+CRC=1")  
phone_cmd(conn,"ATD**21*XXXXXXXXXXXX#;") //works for teracom (LW272) 
```

但是相同的命令集，在华为 E173B-u 调制解调器上不起作用，我在这里缺少什么，可能是一些命令还是硬件限制..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T08:30:34.403

您需要使用用于发送 USSD 而不是拨号的“at”命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T23:17:27.273

对于一些补充业务，建议不要使用 AT 命令。但是您可以通过“AT”命令启用补充服务，然后尝试使用ATD。例如： +CLIR 在设置消息中抑制 BCD 可以通过 At+CLIR=2 激活 之后如果您通过 ATD 呼叫.. 被叫方看不到主叫方号码。用 UI 做同样的练习很简单=> *31#XXXXXXXXXX

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-30T17:34:18.427

第 6.2 章中的[27.007条规定：](http://www.3gpp.org/ftp/Specs/html-info/27007.htm)

> 6.2 ITU-T V.250 拨号指令 D
> 
> V.250 拨号命令 D 根据 3GPP TS 22.030 列出了可以在拨号字符串中用于进行呼叫或控制补充服务的字符。本小节列出了它们在 GSM/UMTS 中​​的使用，并介绍了仅适用于 GSM/UMTS 的新拨号修饰符。对于仅支持 AT 命令的 MT，必须通过拨号命令或通过特定的补充服务命令（+CCFC、+CLCK 等）支持根据 3GPP TS 22.030 对补充服务的控制，其中 3GPP TS 22.030将补充服务标识为强制性的。

因此，如果这个华为调制解调器是一个纯调制解调器，没有用户界面来与之交互并发送一些补充服务命令，这显然违反了规范（尽管并非不可能）（假设 21 是强制性的，我相对确定它是） .

您可以尝试使用非结构化补充服务命令`AT+CUSD`。尽管 USSD 与 SS 是分开的，但网络可能有也可能没有一些映射/重叠。

# google-app-engine - GAE 为什么我收费的实例比我使用的少？

> ID：10572024
> 
> 赞同：0
> 
> 时间：2012-05-13T13:11:08.890
> 
> 标签：google-app-engine

我在设置中限制了 1 个实例的最小值和最大值。

但是为什么 GAE 使用多个实例而不向我收费？

![实例](../Images/de63ea7c74e1f1508c62e991ad0b8763.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T17:04:26.543

您很可能将最大空闲实例设置为 1。
调度程序仍在启动更多实例以处理请求峰值，但计费实例不会超过您的设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T01:09:45.913

您无需为空闲超过 15 分钟的实例付费。如果没有理由关闭未使用的实例，App Engine 基础架构可能会继续运行它们。

# java - HashMap 迭代/删除获取 java.util.ConcurrentModificationException

> ID：10572025
> 
> 赞同：0
> 
> 时间：2012-05-13T13:11:11.830
> 
> 标签：java, multithreading, hashmap

我有一个 ClientSocket 和客户端对象的 HashMap。

我正在使用 for 循环迭代抛出它们，但有时会在哈希图中添加新行，然后我得到 java.util.ConcurrentModificationException 错误。我完全理解它为什么会发生，但我不明白如何解决它。我试图在迭代开始之前制作我的 HashMap 的新副本，但是 - 我仍然得到错误。

我的代码：

```
private volatile HashMap<ClientSocket, Client> clientsMap = new HashMap<ClientSocket, Client>();
private volatile HashMap<ClientSocket, Client> iteratorClientsMap = new HashMap<ClientSocket, Client>();
private volatile ClientsMapIterator iterator;

iterator = new ClientsMapIterator(clientsMap);
iteratorClientsMap = iterator.getItreator();

for (Map.Entry<ClientSocket, Client> entry : iteratorClientsMap.entrySet()) {                                                                   
    ClientSocket key = entry.getKey();
    //Client value = entry.getValue();              
    long diff = currentTime - key.getLastOnline();
    boolean isAvailable = false;

    try {
        isAvailable = (key.getSocket().getInputStream().available() > 0);
    } catch (IOException e) {
        e.printStackTrace();
    }               

    if ( diff > keepAlive)              
        removeClientSocket(key);
}

public synchronized void addClientSocket(ClientSocket clientSocket) {
    clientsMap.put(clientSocket, null);                 
} 
```

addClientSocket 是因为它我得到错误的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:14:13.523

您在迭代集合时正在修改集合。这被标记为并发修改。

最简单的解决方案是使用不会触发 CME 的 ConcurrentHashMap。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:12:35.873

我找到了一个我不知道它是否是最好的解决方案：

```
synchronized (this) {
            iterateClientsMap = new HashMap<ClientSocket, Client>(clientsMap);  
        }           

        for (Map.Entry<ClientSocket, Client> entry : iterateClientsMap.entrySet())      
        {                                                                                                   
            ClientSocket key = entry.getKey();
            //Client value = entry.getValue();              
            long diff = currentTime - key.getLastOnline();
            boolean isAvailable = false;
            try {
                isAvailable = (key.getSocket().getInputStream().available() > 0);
            } catch (IOException e) {
                e.printStackTrace();
            }               
            if ( diff > keepAlive)              
                removeClientSocket(key);
} 
```

我已经复制了我的 HashMap 并在副本上对其进行了迭代，并且在每个迭代过程之前，我将它阻塞到其他线程（使用同步标题），因此它不会在复制过程中被中断

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T14:16:10.493

这个问题似乎从`removeClientSocket(key);`

似乎集合也在被迭代时被修改。

解决此问题的一种方法是将迭代器传递给此方法

```
removeClientSocket(iterator, key); 
```

通过调用`iterator.remove()`而不是在迭代过程中从集合本身中删除来从该迭代器中删除键。

似乎您的问题出在多个线程上，或者您对同一锁的添加和删除同步访问，例如：

```
public void removeClientSocket(iterator, key){
    synchronized(clientMap){
      //now remove
    }
} 
```

和

```
public void addClientSocket(ClientSocket clientSocket) {
    synchronized(clientsMap){
        clientsMap.put(clientSocket, null);    
    }             
} 
```

或使用 java.util.Concurrent 包进行自动并发控制。您可以专门使用[`ConcurrentHashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html).

# perl - 在 RedHat 机器上为 twiki 安装 GD 库

> ID：10572035
> 
> 赞同：6
> 
> 时间：2012-05-13T13:12:24.583
> 
> 标签：perl, redhat, gdlib, twiki

我的最终目标是为我的研究小组运行一个[twiki网站。](http://twiki.org/)

我在运行 Apache 等的 RedHat 服务器上有空间，但我没有 root 访问权限。由于我无法使用当前权限安装 perl 模块，因此我决定手动安装本地版本的 perl。得到那个工作没问题。使 twiki 工作需要以下模块：

*   FreezeThaw - [http://search.cpan.org/~ilyaz/FreezeThaw](http://search.cpan.org/%7Eilyaz/FreezeThaw)
*   CGI::Session - [http://search.cpan.org/~markstos/CGI-Session](http://search.cpan.org/%7Emarkstos/CGI-Session)
*   错误 - [http://search.cpan.org/~shloif/Error](http://search.cpan.org/%7Eshlomif/Error)
*   GD - [http://search.cpan.org/~lds/GD](http://search.cpan.org/%7Elds/GD)
*   HTML::Tree - [http://search.cpan.org/~petek/HTML-Tree](http://search.cpan.org/%7Epetek/HTML-Tree)
*   时间模块 - [http://search.cpan.org/~muir/Time-modules](http://search.cpan.org/%7Emuir/Time-modules)

我已经安装了 FreezeThaw、CGI、Error，但它在 GD 上失败并出现以下错误：

> **UNRECOVERABLE ERROR**在搜索路径中找不到 gdlib-config。
> 
> 请安装 libgd 2.0.28 或更高版本。如果你想尝试
> 
> 无论如何编译，请使用选项 --ignore_missing_gd 重新运行此脚本。

在寻找如何绕过这个最新障碍的过程中，我发现了一个之前的 SO 问题：[How to install GD library with Strawberry Perl](https://stackoverflow.com/questions/1627143/how-to-install-gd-library-with-strawberry-perl)询问有关安装此问题的问题，而最佳答案[建议手动编译](http://www.libgd.org/FAQ_C_Compile)gdlib。但是，您会注意到该链接已损坏。基本站点：[http](http://www.libgd.org/) ://www.libgd.org/基本上是说去项目的[b​​itbucket](https://bitbucket.org/pierrejoye/gd-libgd)页面。

所以我从那个页面得到了 tarball 并试图安装它。当我按照随附的说明进行操作时，会出现以下问题。README.TXT 说：“如果源代码是从 CVS 获取的，请运行 bootstrap.sh [options]。”

运行 bootstrap.sh 产生：

> configure.ac:64：警告：在库中找不到宏“AM_ICONV”
> 
> configure.ac:10：所需目录 ./config 不存在 cp：不能
> 
> 创建常规文件`config/config.guess'：没有这样的文件或目录
> 
> configure.ac:11: 安装 `config/config.guess' configure.ac:11:
> 
> 复制 cp 时出错：无法创建常规文件
> 
> `config/config.sub': 没有这样的文件或目录 configure.ac:11:
> 
> 安装 `config/config.sub' configure.ac:11: error while
> 
> 复制 cp：无法创建常规文件 `config/install-sh'：没有这样的
> 
> 文件或目录 configure.ac:28: 安装 `config/install-sh'
> 
> configure.ac:28：复制 cp 时出错：无法创建常规
> 
> 文件`config/missing'：没有这样的文件或目录configure.ac：28：
> 
> 安装“config/missing”configure.ac:28：复制时出错
> 
> configure.ac:577：找不到所需的文件“config/Makefile.in”
> 
> configure.ac:577：找不到所需的文件“config/gdlib-config.in”
> 
> configure.ac:577：找不到所需的文件“test/Makefile.in”
> 
> Makefile.am:14：使用了 Libtool 库，但未定义“LIBTOOL”
> 
> Makefile.am:14：定义“LIBTOOL”的常用方法是添加
> 
> `AC_PROG_LIBTOOL' Makefile.am:14: to` configure.ac' 并运行
> 
> `aclocal' and` 再次自动配置。Makefile.am:14: 如果 `AC_PROG_LIBTOOL'
> 
> 在 `configure.ac' 中，确保 Makefile.am:14: 它的定义在
> 
> aclocal 的搜索路径。cp：无法创建常规文件
> 
> `config/depcomp': 没有这样的文件或目录 Makefile.am: 正在安装
> 
> `config/depcomp' Makefile.am：复制失败时出错

它说我还应该安装以下 3rd 方库：

1.  zlib，可从[http://www.gzip.org/zlib/ 获取](http://www.gzip.org/zlib/) 数据压缩库

2.  libpng，可从[http://www.libpng.org/pub/png/](http://www.libpng.org/pub/png/) 便携式网络图形库获得；需要 zlib

3.  FreeType 2.x，可从[http://www.freetype.org/](http://www.freetype.org/)获得 免费、高质量和可移植的字体引擎

4.  JPEG 库，可从[http://www.ijg.org/](http://www.ijg.org/)获得 便携式 JPEG 压缩/解压缩库

5.  XPM，可从[http://koala.ilog.fr/lehors/xpm.html](http://koala.ilog.fr/lehors/xpm.html) X Pixmap 库获得

我现在忽略了。

切换到它说遵循安装文件中的建议的通用说明；它说：“cd 到包含包源代码的目录并键入 ./configure 为您的系统配置包。” 哪个平面不起作用：我已经 cd'ed 到 tarball 的每个目录中并且运行该命令什么都不做。

因此，尝试安装 twiki 需要我安装 perl，这需要我安装 perl 模块：FreezeThaw、CGI、Error、HTML、Time-modules 和 GD——这本身需要我安装 gdlib——这进一步建议我安装 zlib、libpng、FreeType 2.x、JPEG 库和 XPM。当然，我被困在安装 gdlib 阶段。

**我的问题是**：还有什么其他过程可能将人类贬低到这样的程度？当我越陷越深这颗悲惨的洋葱时，我无法理解摆在我面前的残酷的深度。我应该结束这一切吗？能从这种疯狂中获得意义吗？明天太阳会升起吗？如果是这样，这还重要吗？

但说真的，任何关于如何做不同/更好的建议都会非常感激 - 我不记得孩子的笑声听起来像什么了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-13T19:26:06.783

安装包`gd-devel`，它包含`/usr/bin/gdlib-config`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-22T11:21:29.567

这应该有效：

```
sudo apt-get -y install libgd2-xpm-dev build-essential 
```

# ruby-on-rails - Ruby on Rails：将变量传递给活动记录查询

> ID：10572043
> 
> 赞同：1
> 
> 时间：2012-05-13T13:13:57.957
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

此问题与 RoR 测验应用程序有关。我希望显示测验的结果，显示正确答案以及用户的答案。

因此，在我看来，我需要遍历每个问题并显示问题答案以及用户的答案。但是，我正在努力弄清楚如何正确查询用户的答案。

要查询 user_answer，我需要 user_id = current_user.id 的 response_set，并且我需要在 question_id 循环遍历每个循环时传递它。但是，我坚持如何做到这一点。

我需要做什么才能在正确答案旁边的视图中显示 user_answer？

**我有 3 个模型：**

```
Response_set
belongs_to :user
has_many :responses

Reponse
belongs_to :response_set
belongs_to :question

Question
has_many :responses 
```

**表字段：**

```
create_table :response_sets do |t|
  t.integer :user_id

create_table :responses do |t|
  t.integer :response_set_id
  t.integer :question_id
  t.integer :user_answer

create_table :questions do |t|
  t.integer :correct_answer 
```

**控制器**

```
@questions = Question.all
@user = current_user.id 
```

**查看（只是循环问题而不显示用户的答案）**

```
<% @questions.each do |question| %>
   <%= question.correct_answer %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T13:16:40.923

我的导师最终为我解决了这个问题。这是他提出的解决方案：

> “我认为这里更好的方法是从响应集中获取响应并循环处理，而不是循环处理问题。”

**控制器：**

```
 @response_set = Response_set.where("user_id = ?", @user).includes({:responses => :question}).last 
```

**看法：**

```
 <% @response_set.responses.each do |response| %>
   <%= response.question.correct_answer %>
   <%= response.user_answer %>
 <% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:37:56.157

在response表中添加user_id，这样就不用查询response_set表了。在此之后，您可以在循环中执行类似的操作

```
 question.responses.where(:user_id => current_user.id).first.user_answer 
```

# silverlight - Windows Phone Silverlight 中的 UI 未更新

> ID：10572045
> 
> 赞同：0
> 
> 时间：2012-05-13T13:14:12.860
> 
> 标签：silverlight, windows-phone-7

我正在玩创建一个 Windows Phone 应用程序。我一直在看[这个教程](http://www.youtube.com/watch?v=UMJb2zaFvvg&list=FLm9ZzpetZtIeaiwY9lqgNLQ&index=2&feature=plpp_video)，但我遇到了一些问题，即视图没有用数据更新（模板只是空的）。

我已确保项目集合实际上是用数据设置的，但我怀疑它是 NotifyPropertyChanged 事件未正确触发。

我可能会错过什么？

我的 MainViewModel 看起来像这样：

```
public class MainViewModel : INotifyPropertyChanged
{
    private ServiceAgent _serviceAgent;
    public MainViewModel()
    {
        this.Items = new ObservableCollection<SocialListItemViewModel>();
        if (_serviceAgent == null)
        {
            _serviceAgent = new ServiceAgent();
        }
    }

    /// <summary>
    /// A collection for ItemViewModel objects.
    /// </summary>
    public ObservableCollection<SocialListItemViewModel> Items { get; private set; }

    public bool IsDataLoaded
    {
        get;
        private set;
    }

    /// <summary>
    /// Creates and adds a few ItemViewModel objects into the Items collection.
    /// </summary>
    public void LoadData()
    {
        _serviceAgent.GetSocialItems();
        _serviceAgent.SocialItemsLoaded += new ServiceAgent.SocialListItemsLoadedEventHandler(_serviceAgent_SocialItemsLoaded);

        //// Sample data; replace with real data
        //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Facilisi faucibus habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
        //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu suscipit torquent", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
        //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Ultrices vehicula volutpat maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
        //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos interdum lobortis nascetur", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });

        this.IsDataLoaded = true;
    }

    void _serviceAgent_SocialItemsLoaded(ObservableCollection<SocialListItemViewModel> socialItems)
    {
        Deployment.Current.Dispatcher.BeginInvoke(() =>
                                                      {

                                                          this.Items = socialItems;

                                                          //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Facilisi faucibus habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
                                                          //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu suscipit torquent", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
                                                          //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Ultrices vehicula volutpat maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
                                                          //this.Items.Add(new SocialListItemViewModel() { ContentShort = "Maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos interdum lobortis nascetur", ImageUrl = "http://profile.ak.fbcdn.net/hprofile-ak-ash2/50215_277666338969761_534345200_t.jpg" });
                                                          NotifyPropertyChanged("ContentShort");
                                                      });
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (null != handler)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

视图模型如下所示：

```
[DataContract]
public class SocialListItemViewModel : INotifyPropertyChanged
{

    private string _contentshort;
    /// <summary>
    /// Sample ViewModel property; this property is used in the view to display its value using a Binding.
    /// </summary>
    /// <returns></returns>
    [DataMember]
    public string ContentShort
    {
        get
        {
            return _contentshort;
        }
        set
        {
            if (value != _contentshort)
            {
                _contentshort = value;
                NotifyPropertyChanged("ContentShort");
            }
        }
    }

    private string _imageUrl;
    /// <summary>
    /// Sample ViewModel property; this property is used in the view to display its value using a Binding.
    /// </summary>
    /// <returns></returns>
    [DataMember]
    public string ImageUrl
    {
        get
        {
            return _imageUrl;
        }
        set
        {
            if (value != _imageUrl)
            {
                _imageUrl = value;
                NotifyPropertyChanged("ImageUrl");
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (null != handler)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

提取数据的服务代理如下所示：

```
public class ServiceAgent
{
    public delegate void SocialListItemsLoadedEventHandler(ObservableCollection<SocialListItemViewModel> socialItems);
    public event SocialListItemsLoadedEventHandler SocialItemsLoaded;

    private ObservableCollection<SocialListItemViewModel> socialListItemViewModels = new ObservableCollection<SocialListItemViewModel>();
    public void GetSocialItems()
    {
        WebClient wcNewsTractor = new WebClient();
        wcNewsTractor.DownloadStringCompleted += new DownloadStringCompletedEventHandler(wcNewsTractor_DownloadStringCompleted);
        wcNewsTractor.DownloadStringAsync(new Uri("URL TO JSON FEED"));

    }

    void wcNewsTractor_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        if (e.Error == null && e.Cancelled == false)
        {
            //ObservableCollection<SocialListItemViewModel> socialListItemViewModels = new ObservableCollection<SocialListItemViewModel>();

            ThreadPool.QueueUserWorkItem((s) =>
            {
            socialListItemViewModels = ReadToObject(e.Result);
            Deployment.Current.Dispatcher.BeginInvoke(() =>
                                                          {
                                                              SocialItemsLoaded(socialListItemViewModels);
                                                          });

            });

        }
    }

    // Deserialize a JSON stream to a User object.
    public static ObservableCollection<SocialListItemViewModel> ReadToObject(string json)
    {
        ObservableCollection<SocialListItemViewModel> res = new ObservableCollection<SocialListItemViewModel>();
        List<SocialListItemViewModel> deserializedItems = new List<SocialListItemViewModel>();
        MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(json));
        DataContractJsonSerializer ser = new DataContractJsonSerializer(deserializedItems.GetType());
        deserializedItems = ser.ReadObject(ms) as List<SocialListItemViewModel>;
        ms.Close();
        return new ObservableCollection<SocialListItemViewModel>(deserializedItems);
    }
} 
```

在我的 MainPage 中，构造函数如下所示：

```
public partial class MainPage : PhoneApplicationPage
    {
        // Constructor
        public MainPage()
        {
            InitializeComponent();

            // Set the data context of the listbox control to the sample data
            DataContext = new SocialListItemViewModel(); //App.ViewModel;
            this.Loaded += new RoutedEventHandler(MainPage_Loaded);
        } 
```

添加模板的 MainPage.xaml 如下所示：

```
 <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <ListBox x:Name="MainListBox" Margin="0,0,-12,0" ItemsSource="{Binding Items}" SelectionChanged="MainListBox_SelectionChanged" ItemContainerStyle="{StaticResource ListBoxItemStyle1}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                  <StackPanel Margin="0,0,0,17" Width="432" Height="225" d:DataContext="{d:DesignData /SampleData/SocialListItemViewModelSampleData1.xaml}">
                      <Image  Height="125" Width="125" Margin="0" Source="http://myimage.com/myimage.jpg" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                      <TextBlock x:Name="ContentShort" Text="{Binding ContentShort}" TextWrapping="Wrap" Margin="0,-125,0,0" Style="{StaticResource PhoneTextSubtleStyle}" HorizontalAlignment="Right" Foreground="#99FFFFFF" Width="279" RenderTransformOrigin="0.459,0.513" VerticalAlignment="Center" Height="160"/>
                      <Button Name="btnVote" Height="72" HorizontalAlignment="Center" Width="225" Margin="0,-10,-130,0" VerticalAlignment="Center" BorderThickness="2" Content="Vote" Background="#FF0090A1" />
                  </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T01:36:20.293

好的，我认为这里可能发生的事情是您没有触发 ObservableCollection 的通知`Items`。

在这一行：

```
 Deployment.Current.Dispatcher.BeginInvoke(() =>
                       {
                           this.Items = socialItems; 
```

您正在丢弃旧的 ObservableCollection，并将其分配给从您的服务返回的那个。ObservableCollection 仅在添加/删除时发送通知，因此当您执行此操作时，视图不会触发任何内容。

你有两种方法可以解决这个问题。一种是设置`Items`一个私有的后备成员变量，并`NotifyPropertyChanged("Items")`在 setter 中调用。或者，您可以返回一个 generic `List<>`，并遍历内容，将它们添加到`Items`集合中，如下所示：

```
 Deployment.Current.Dispatcher.BeginInvoke(() =>
                       {
                           this.Items.Clear();
                           foreach(var item in socialItems)
                           {
                                this.Items.Add(item);
                           }
                       } 
```

# android - ListView SectionIndexer 的框是透明的

> ID：10572048
> 
> 赞同：0
> 
> 时间：2012-05-13T13:14:21.487
> 
> 标签：android, listview, colors, indexer

在我的应用程序中，我正在使用带有部分索引器的列表视图，该部分索引器显示当前选择的字母。在很多设备上都可以，但是当我在运行 Android 3.2 的 Galaxy Tab 上使用我的应用程序时，显示的字母没有小框。我不知道如何让它出现或改变这封信的颜色。

我尝试使用`android:textColorPrimary`，但我没有找到如何使用它，也没有找到样品。

要查看我的问题，以下是屏幕截图。如果你仔细看，字母`G`在列表的第二个元素上方是白色的。

![问题截图](../Images/f2bbf8a6ae93703337b0842dc375f897.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T13:04:33.733

这是一个奇怪的答案，因为我修复了它，但我不知道为什么。当我设置`FastScrollEnable = true`晚于派生的构造函数时，我也会`ListView`得到这种行为。虽然，我的信几乎完全从屏幕上消失了。

我可能会对这个答案投反对票，但经过 6 个小时的催促，它救了我。当我从主类中删除原型代码以`FastScrollEnable`从外部更改时，我注意到了这一点。

# unit-testing - 模拟工厂并验证是否在返回的类型上调用了方法

> ID：10572050
> 
> 赞同：1
> 
> 时间：2012-05-13T13:14:33.117
> 
> 标签：unit-testing, mocking, factory

假设我有这项服务：

```
public class Service
{
   ... 

  public Service(IFactory factory)
  {
      ...
  }

  public void Method() 
  {
      IInsatnce instance1 = factory.CreateInstance(params1);
      IInstance instance2 = factory.CreateInstance(params2);

      instance1.CallMethod1();
      instance2.CallMethod2();
  }      
} 
```

我想在测试中验证这些创建的实例上的方法是否被调用。据我所知，我必须创建将返回模拟实例的工厂模拟。但是，我是否应该保留将在其中创建的所有模拟实例的引用`Method()`并使用它们来验证方法调用？这是正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T13:29:08.190

这是一个很常见的用例。是的，您必须从模拟工厂返回模拟，然后对该模拟进行验证。这里使用[mockito](/questions/tagged/mockito "显示标记为“mockito”的问题")语法：

```
IInstance instanceMock1 = mock(IInstance.class);
IInstance instanceMock2 = mock(IInstance.class);
IFactory factoryMock = mock(IFactory.class);

given(factoryMock(params1)).willReturn(instanceMock1);
given(factoryMock(params2)).willReturn(instanceMock2);

//...
verify(instanceMock1).CallMethod1();
verify(instanceMock2).CallMethod2(); 
```

# matlab - matlab - 查找 x 中元素的索引

> ID：10572052
> 
> 赞同：1
> 
> 时间：2012-05-13T13:15:02.220
> 
> 标签：matlab, octave

我有一个`x`大小为 Nx2 的矩阵（包含 (x,y) 坐标）和一个`c`大小为 Px1 (P<=N) 的矩阵，其中包含我感兴趣的某些 x 坐标。例如：

```
x = [10 3; 21 9; 98 54; 4 30; 37 12];
c = [4 98]; 
```

我想获取元素的坐标`c`（在上述情况下`[4 3]`）。我怎样才能做到这一点？我只找到了`c`一个 1x1 矩阵（即标量）的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T13:28:50.080

`ismember`可用于测试多个值的成员资格。您可以对 N×2 矩阵进行切片以仅搜索 x 坐标。

```
coords = [1 2; 3 4; 5 6; 7 8];
c = [3 7 99];
[v i] = ismember(c, coords(:, 1));
i = 
  [2 4 0] 
```

`i``c`应包含其中的值显示为 x 坐标的索引，`coords`如果未找到该元素，则为 0。如果你有最新版本的 Matlab，你可以`v`用`~`.

# tsql - 更新 SQL Server 表中的特定列并忽略 Null 值

> ID：10572053
> 
> 赞同：2
> 
> 时间：2012-05-13T13:15:02.457
> 
> 标签：tsql, null

我有一个没有大量列的数据库表。我想编写一个 T-SQL 存储过程，它将更新该表中的记录，并且我想使用该过程来更新所有或仅特定列，这样如果为任何列值传递 NULL，而不是现有值不应该被改变。目前我可以使用这样的解决方案

```
UPDATE table
    SET column1 = COALESCE(@param1, column1),
        column2 = COALESCE(@param2, column2),
        ...
    WHERE id = @id 
```

或者

```
UPDATE table
set   column1 = isnull(@param1,column1),
      column2 = isnull(@param2,column2) 
```

它们都运作良好，我唯一的问题是有时我想在任何列中显式保存 null 而我无法使用上述解决方案来做到这一点。谁能告诉我我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:32:04.850

我们使用的方法非常有效，它为每一列声明两个参数，第一个包含值，第二个是指示查询显式插入 null 的位。例如

```
create table example (column1 nvarchar(255), column2 nvarchar(255))

create procedure pUpdate(
    @column1 nvarchar(255)  = null,
    @nullColumn1 tinyint    = 0,
    @column2 nvarchar(255)  = null,
    @nullColumn2 tinyint    = 0
    ) as
    BEGIN

    update example 
        set column1 = Case When @nullcolumn1 = 1 Then NULL ELSE IsNull(@column1, column1) End
        set column2 = Case When @nullcolumn2 = 1 Then NULL ELSE IsNull(@column2, column2) End

    END 
```

然后从代码调用时，您只需传递您知道需要更新的参数，或显式设置@null 列以强制为空。

# c++ - Sha1 的 C++ Base64 - WebSocket 握手

> ID：10572057
> 
> 赞同：2
> 
> 时间：2012-05-13T13:15:33.647
> 
> 标签：c++, binary, hex, websocket, handshake

我目前正在尝试运行可以与 WebSocket 通信的 C++ 服务器。HandShake 由几个步骤组成，最后一个步骤我没有成功。

第一步是生成一个 SHA1 编码的字符串，我成功获得了正确的十六进制字符串。（例如[http://en.wikipedia.org/wiki/WebSocket](http://en.wikipedia.org/wiki/WebSocket)和[https://www.rfc-editor.org/rfc/rfc6455](https://www.rfc-editor.org/rfc/rfc6455)）。

我的输出在这两种情况下都与文档中所述相同：

```
Wikipedia: 1d 29 ab 73 4b 0c 95 85 24 00 69 a6 e4 e3 e9 1b 61 da 19 69
My Server: 1d 29 ab 73 4b 0c 95 85 24 00 69 a6 e4 e3 e9 1b 61 da 19 69

IETF Docu: b3 7a 4f 2c c0 62 4f 16 90 f6 46 06 cf 38 59 45 b2 be c4 ea
My Server: b3 7a 4f 2c c0 62 4f 16 90 f6 46 06 cf 38 59 45 b2 be c4 ea 
```

所以这是对的。当我现在进行 Base64 编码时，我得到以下结果：

```
Wikipedia: HSmrc0sMlYUkAGmm5OPpG2HaGWk=
My Server: MWQyOWFiNzM0YjBjOTU4NTI0MDA2OWE2ZTRlM2U5MWI2MWRhMTk2OQ==

IETF Docu: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
My Server: YjM3YTRmMmNjMDYyNGYxNjkwZjY0NjA2Y2YzODU5NDViMmJlYzRlYQ== 
```

而这完全不同。我确认我的 Base64 算法适用于某些在线转换器，并且它们都产生了我的服务器所做的输出。所以问题是输入格式。我在一个 javascript 论坛中找到了一个论坛条目，其中一个有同样的问题，答案是，我们应该传递 20 个字符的二进制表示，而不是传递 40 个字符的十六进制字符串。

我知道 openssl SHA1 返回二进制表示，但由于某些原因我不能使用该库。我使用的 SHA1 库将编码的输出放在一个 int 数组中。输出如下所示（IETF 示例）：

```
result[0] = 3011137324
result[1] = 3227668246
result[2] = 2432058886
result[3] = 3476576581
result[4] = 2998846698 
```

我把它转换成这样的十六进制：

```
std::ostringstream oss;
oss << std::setfill('0');
            for (int i = 0; i < 5; ++i) {
                    oss << std::setw(8) << std::hex << result[i];
            } 
```

现在是个大问题。如何将我的十六进制字符串转换为二进制？

非常感谢提前。马库斯

**编辑**

如果有人对代码感兴趣： [https ://github.com/MarkusPfundstein/C---Websocket-Server](https://github.com/MarkusPfundstein/C---Websocket-Server)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T09:46:23.627

我在 c 中测试 websocket，发现字节顺序错误。调整顺序（反向）解决了我的 base64 编码问题，导致正确接受的密钥字符串：

```
unsigned char byteResult [20];
    for(i = 0; i < 5; i++) {
        byteResult[(i * 4) + 3] = sha.result[i] & 0x000000ff;
        byteResult[(i * 4) + 2] = (sha.result[i] & 0x0000ff00) >> 8;
        byteResult[(i * 4) + 1] = (sha.result[i] & 0x00ff0000) >> 16;
        byteResult[(i * 4) + 0] = (sha.result[i] & 0xff000000) >> 24;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T12:12:40.123

在一个稍微相关的注释上（我看到你已经发现了[EVP BIO base64 方式](http://www.openssl.org/docs/crypto/BIO_f_base64.html)......）：

```
result[0] = 3011137324
...
oss << std::setw(8) << std::hex << result[i]; 
```

如果我理解正确，这会导致 output `b37a4f2c`，这是您的 IETF Docu 示例。在这里要非常小心，因为您正在关注平台特定[字节序](http://en.wikipedia.org/wiki/Endianness)的开放水域危险。0n3011137324 确实是 0xb37a4f2c 但*仅在小端机器上*，如英特尔架构。您可能最好重新解释强制`&result[0]`转换为`unsigned char*`，然后将其作为字节数组处理，而不是（无符号）整数数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T13:27:01.843

大多数 Baser64 编码器需要一个字节数组/二进制数据流。您想使用位掩码和逻辑移位将整数拆分为字节。在 32 位系统上，每个 int 包含 4 个字节，您可以按如下方式提取它们：

```
for(i = 0; i < 5; i++) {

    byteResult[(i * 4) + 0] = result[i] & 0x000000ff;
    byteResult[(i * 4) + 1] = (result[i] & 0x0000ff00) >> 8;
    byteResult[(i * 4) + 2] = (result[i] & 0x00ff0000) >> 16;
    byteResult[(i * 4) + 3] = (result[i] & 0xff000000) >> 24;
} 
```

其中`byteResult`byte[] 比结果数组大 4 倍。我假设字节被打包到这里的整数的顺序，它可能是相反的。

将此 byte[] 传递到您的 Base64 编码器中。

# java - 如何将 DynamoDB 扫描结果添加到对象列表？

> ID：10572058
> 
> 赞同：4
> 
> 时间：2012-05-13T13:15:35.567
> 
> 标签：java, iterator, amazon-dynamodb

我正在对 DynamoDB 表执行扫描，然后我需要将返回的项目中的相应属性添加到类型列表中`User`（`User`具有单个构造函数`User(String uuid)`）。该代码当前成功扫描了数据库并返回了一个`List`扫描结果。但是，由于某种原因，我的迭代似乎返回 null。

```
 AmazonDynamoDBClient client = dynamoClient.getDynamoClient();
    DynamoDBMapper mapper = new DynamoDBMapper(client);

    try {
        DynamoDBScanExpression scanExpression = new DynamoDBScanExpression();

        Map<String, Condition> scanFilter = new HashMap<String, Condition>();
        Condition scanCondition = 
            new Condition().withComparisonOperator(ComparisonOperator.NOT_NULL);
        scanFilter.put("uuid", scanCondition);
        scanExpression.setScanFilter(scanFilter);

        List scanResults = mapper.scan(UserAccounts.class, scanExpression);

        for (Iterator it = scanResults.iterator(); it.hasNext();) {
            //User user = (User) it.next();
            allUserSummary.add(new User(scanResults.get(1).toString()));
        }
    } catch (Exception e) {
        // TODO
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:23:30.187

[我建议您通过For-Each 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)开始使用现代且紧凑的列表迭代，这有助于避免使用旧迭代样式时的许多常见错误：

> [...]
> 
> 迭代器只是混乱。此外，这是犯错的机会。迭代器变量在每个循环中出现 3 次：这是两次出错的机会。for-each 结构消除了混乱和出错的机会。下面是使用 for-each 构造的示例的外观：
> 
> ```
> void cancelAll(Collection<TimerTask> c) {
>     for (TimerTask t : c)
>         t.cancel();
> } 
> ```

将此应用于您的用例会产生以下大致结果：

```
 List<UserAccounts> scanResults = mapper.scan(UserAccounts.class, scanExpression);

    for (UserAccounts userAccounts : scanResults) {
        allUserSummary.add(new User(userAccounts.toString()));
    } 
```

如果这还不起作用，它也可能暗示实际错误，只要您的代码假定`toString()`of 类`UserAccounts`返回*uuid*，情况可能会也可能不会。通常的方法是使用`getKey()`or`getUuidAttribute()`方法和相应的注释`@DynamoDBHashKey`or `@DynamoDBAttribute`，如[Class DynamoDBMapper](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/dynamodb/datamodeling/DynamoDBMapper.html)的示例所示，例如：

```
@DynamoDBTable(tableName = "UserAccounts")
 public class UserAccounts{     
     private String key; // or uuid right away

     @DynamoDBHashKey
     public String getKey() {
         return key;
     }

     public void setKey(String key) {
         this.key = key;
     }

     // ...
 } 
```

对于您的示例，这显然会产生以下结果：

```
 List<UserAccounts> scanResults = mapper.scan(UserAccounts.class, scanExpression);

    for (UserAccounts userAccounts : scanResults) {
        allUserSummary.add(new User(userAccounts.getKey()));
    } 
```

# python - 当轮廓部分超出可见区域时删除重复的 matplotlib 轮廓标签

> ID：10572059
> 
> 赞同：1
> 
> 时间：2012-05-13T13:15:58.790
> 
> 标签：python, plot, matplotlib

我在等高线图中绘制“放大”时遇到问题。下图最好地说明了这个问题：

我有一个如下图所示的等高线图：

![全图](../Images/a435da180f2effe821cffdc810b5c78c.png)

但是，当我“放大”时，仅绘制部分数据（取原始输入数组的一部分），结果如下：

![局部图](../Images/f57d10cd4208e04bfe07d51d38fc9e32.png)

似乎每行添加了两次标签，可能是因为这些行超出了可见空间然后再次返回。如何防止出现第二组标签，而无需手动放置所有标签？无论如何，在中心的矩形附近，所有线条都重叠，因此不需要放置在那里的标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T05:43:57.760

您可以从cs对象中临时删除不需要标签的路径，调用clabel()后，将那些已删除的路径恢复到cs对象。

这是一个例子。对于每个级别的集合，保持最长的路径，并删除所有其他的。path_length() 计算路径的长度。

```
import pylab as pl
import numpy as np

x, y = np.mgrid[-2:1:100j, -1:1:100j]
z = np.sqrt(x*x+y*y)

cs = pl.contour(x, y, z, linewidths=2)

def path_length(path):
    v = path.vertices
    dv = np.diff(v, axis=0)
    return np.sum(np.sqrt(np.sum(dv**2, axis=-1)))

# remain the longest path and remove all others
deleted_path = []
for c in cs.collections:
    paths = c.get_paths()
    if len(paths) > 1:
        paths.sort(key=path_length, reverse=True)
        for p in paths[1:]:
            deleted_path.append((c, p))
        del paths[1:]

# create labels
r = pl.clabel(cs, cs.levels, inline=True, fontsize=10)

# restore all removed paths
for c, p in deleted_path:
    c.get_paths().append(p)

pl.show() 
```

这是结果，如您所见，绿色和棕色线只有一个标签。

从你的情节来看，我认为你可以使用路径长度作为判断。如果矩形的长度大于外部曲线，则需要寻找其他方法来确定要删除的路径。

![在此处输入图像描述](../Images/0c1df6936221f62fcc186d1aa63bd21a.png)

# actionscript-3 - 1009 仅 FF12 中的类型错误

> ID：10572067
> 
> 赞同：1
> 
> 时间：2012-05-13T13:17:45.877
> 
> 标签：actionscript-3, firefox, actionscript

以我现在的智慧结束，Firefox 在其永无止境的智慧*咳嗽*中似乎已经在其更高版本（我正在运行 12）和一个适用于其他每个版本的 Firefox 的应用程序以及每个版本的每个版本其他浏览器（是的，包括 IE！）

因此，当运行我的应用程序（它更多的是不支持功能的 polyfill）时，它会在调用 Matrix translate 时失败。它从来没有这样做过，我有理由认为它是一个 Firefox 错误（转储 Matrix 对象给我一个空对象？）

我已将导致错误的代码放在下面

```
try {
    var smx:Matrix = new Matrix;
    smx.translate(-100, -50);
} catch (e:*) {
    ExternalInterface.call('console.log', e);
} 
```

任何帮助都将是神奇的，就像独角兽一样，但要让 Firefox 已经成为玩球的混乱局面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T14:13:20.817

所以事实证明，BitmapData 没有正确实例化并最终引发类型错误是一个问题。总是加括号！

避免：

```
var someVar = new BitmapData; 
```

并使用：

```
var someVar = new BitmapData(); 
```

这很烦人，因为我讨厌重复的代码。

# oracle - 迭代所有列以查找和替换字符

> ID：10572068
> 
> 赞同：1
> 
> 时间：2012-05-13T13:17:49.313
> 
> 标签：oracle, plsql

我想遍历所有列以查找和替换特定字符。这是我的 pl/sql 块：

```
 Declare
  match_count     Number:=0;
  v_search_string VARCHAR2(4000) := '%ي%';
BEGIN
 FOR t IN
 (SELECT owner,
  table_name,
column_name
FROM all_tab_columns
 WHERE (SUBSTR(table_name,1,2)='PN'
OR (SUBSTR(table_name,1,2)   ='CD'
AND owner                    ='PNET_USER' ))
AND (data_type               ='VARCHAR2'
OR data_type                 ='CLOB')
)
LOOP
BEGIN
  EXECUTE IMMEDIATE 'SELECT count(*) FROM '||t.owner || '.' || t.table_name|| ' WHERE '||t.column_name||' LIKE :1' INTO match_count USING v_search_string;
  IF match_count > 0 THEN
    dbms_output.put_line( t.owner || '.' || t.table_name ||' '||t.column_name||' '||match_count );
    --EXECUTE IMMEDIATE 'UPDATE '||t.table_name||' SET '||t.column_name||'=replace()'
  END IF;
END;
END LOOP; 
```

它工作正常并打印具有无效字符的列的名称。但我不知道如何替换字符。我怎样才能得到的值`t.column_name`，替换无效字符然后更新`t.table_name`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T22:41:25.577

好吧，这几乎没问题（还有stevo的回答）。我让你用你的字符改变 v_from 和 v_to 。

```
Declare
  match_count     Number       :=0;
  v_from          varchar2(5)  := 'a';
  v_like          varchar2(5)  := '%'||v_from||'%';
  v_to            varchar2(5)  := 'b';
  v_sql           varchar2(1000);
  v_emesg         varchar2(1000);

  CURSOR s is
        (SELECT owner, table_name, column_name
        FROM    all_tab_columns
        where   SUBSTR(table_name,1,2)    IN ('PN', 'CD')
        AND     owner                     ='PNET_USER' 
        AND     data_type                 IN('VARCHAR2', 'CLOB'););
begin       
for t in s  LOOP
     begin
      EXECUTE IMMEDIATE 'SELECT count(*) FROM '||t.owner || '.' || t.table_name|| ' WHERE '||t.column_name||' LIKE :1' INTO match_count USING v_like;
      IF match_count > 0 THEN
            begin
            dbms_output.put_line( t.owner || '.' || t.table_name ||' '||t.column_name||' '||match_count );
            v_sql := 'UPDATE '||t.owner||'.'||t.table_name||' SET '||t.column_name||'= REPLACE('||t.column_name||', '''||v_from||''', '''||v_to||''') WHERE '||t.column_name||' LIKE '''|| v_like||'''';
            dbms_output.put_line(v_sql);

            EXECUTE IMMEDIATE v_sql;
            EXCEPTION WHEN OTHERS THEN
               v_emesg := SQLERRM;
               dbms_output.put_line(v_emesg);
               dbms_output.put_line('Errow while trying to update '||t.owner||'.'||.t.table_name||' : column '||t.column_name||'.';
            END;
      END IF;
      end;
  END LOOP;
end; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-13T16:11:21.123

就像是

立即执行'更新'||t.table_name||' SET '||t.column_name||'=replace('||t.column_name||',''FROM'',''TO'')'

应该这样做，其中 FROM 是无效字符，而 TO 是您想要将其更改为的任何字符。有关 REPLACE 工作原理的说明，请参阅链接中的 oracle 文档。

[http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions134.htm](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions134.htm)。

注意我没有任何地方可以尝试这个，所以语法可能不正确。

# c# - 为字符串 .split c# 引发 IndexOutOfRangeException

> ID：10572070
> 
> 赞同：2
> 
> 时间：2012-05-13T13:18:19.663
> 
> 标签：c#, .net, mysql, string

我有一个使用 MySQL .Net 连接的应用程序，但由于某种原因，我在解析结果以返回它们时遇到问题，

```
public NameValueCollection[] query(string query)
{
    connect();
    NameValueCollection[] resultSet;

    MySqlCommand command = connection.CreateCommand();
    MySqlDataReader Reader;

    command.CommandText = query;
    connection.Open();
    Reader = command.ExecuteReader();
    string theserows = "";
    while (Reader.Read())
    {
        for (int i = 0; i < Reader.FieldCount; i++){
            theserows += Reader.GetName(i)+"="+Reader.GetValue(i).ToString() + ",";
            Count = i;
        }
        theserows += "\n";
    }
    connection.Close();
    string[] results = theserows.Split(new char[] {'\n'}, StringSplitOptions.RemoveEmptyEntries);
    int countResultRows = 0;
    resultSet = new NameValueCollection[Count];
    foreach (string s in results)
    {
        resultSet[countResultRows] = new NameValueCollection();
        string[] result = s.Split(new char[] {','}, StringSplitOptions.RemoveEmptyEntries);
        foreach (string col in results)
        {
            if (string.IsNullOrEmpty(col))
                continue;

            string[] kv = col.Split('=');
            resultSet[countResultRows].Add(kv[0], kv[1]);
        }
        countResultRows++;
    }
    return resultSet;
} 
```

在此`theserows = "site_id=1,\n"`，但我有一个`string[] result = s.Split(',');`例外`IndexOutOfRangeException`

任何人都可以深入了解为什么会发生此错误吗？

另一方面，我正在阅读所有内容然后构建 NameValueCollection 的原因是我想添加一个记录完整查询及其结果的日志系统

编辑：：

“count”（小写）更改为 countResultRows

调用栈

```
HTML5Streamer.exe!HTML5Streamer.Classes.MySQL.query(string query) Line 53   C#
HTML5Streamer.exe!HTML5Streamer.Classes.Query.getSiteId(string domain) Line 17 + 0x10 bytes C#
HTML5Streamer.exe!HTML5Streamer.Classes.Query.checkUserPass(string username, string password, string domain) Line 31 + 0xb bytes    C#
HTML5Streamer.exe!HTML5Streamer.Classes.Service.ProccessAdminRequest(System.Net.HttpListenerContext context) Line 239 + 0xd9 bytes  C#
HTML5Streamer.exe!HTML5Streamer.Classes.Service.ProcessRequest(System.Net.HttpListenerContext context) Line 176 + 0xb bytes C#
HTML5Streamer.exe!HTML5Streamer.Classes.Service.ListenerCallback(System.IAsyncResult result) Line 150 + 0xb bytes   C# 
```

![完整的异常详细信息](../Images/0b2c753d3539cb2c141856024f2de313.png)

[http://i.stack.imgur.com/EST4w.png](https://i.stack.imgur.com/EST4w.png) 第 52 行是`resultSet[countResultRows] = new NameValueCollection();` 函数开始于第 26 行，结束于 65

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:40:11.737

就在第二个循环之前，您尝试使用逗号作为分隔符拆分字符串“site_id=1” - 结果将是一个包含两个字符串的数组，第二个字符串为空。只需将您的内部 foreach 循环更改为以下内容：

```
foreach (string col in result)
{
    if (string.IsNullOrEmpty(col))
        continue;

    string[] kv = col.Split('=');
    resultSet[count].Add(kv[0], kv[1]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T13:41:16.487

您不应该对 2 个不同的值（计数、计数）使用相同的变量名称，即使它在语法上是正确的，这也可能会造成混淆。

其次，您应该在访问数组之前检查 kv 长度是否 > 1

```
resultSet[count].Add(kv[0], kv[1]); 
```

如果我按照你程序的逻辑，给定字符串“site_id=1,\n”，在拆分后，result = {"site_id=1","\n"}，对于第二个字符串 kv = {"\n "} 因此 kv[1] 将返回 OutOfRangeException。

这就是我将如何编写您的代码

```
string[] results = theserows.Split(new char[]{'\n'},StringSplitOptions.RemoveEmptyEntries);
resultSet = new NameValueCollection[Count];
for(int i = 0; i < results.Length && i < Count; i++)
{
    string s = results[i];
    resultSet[i] = new NameValueCollection();
    string[] result = s.Split(new char[]{','},StringSplitOptions.RemoveEmptyEntries);
    foreach (string col in result) // As pointed by other users, this should be result insead of results, again bad var name choice
    {
        string[] kv = col.Split('=');
        if(kv.Length >= 2)
        resultSet[i].Add(kv[0], kv[1]);
    }
 } 
```

避免任何可能的 OutOfRangeExceptions

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T13:46:10.083

你有尾随逗号和空格的问题。另外，`results`当您应该迭代时，您正在迭代`result`。试试这个。

```
string[] results = theserows.Trim().Split(new string[] { "\n" }, StringSplitOptions.RemoveEmptyEntries); ;
int count = 0;
resultSet = new System.Collections.Specialized.NameValueCollection[results.Length];
foreach (string s in results)
{
    resultSet[count] = new System.Collections.Specialized.NameValueCollection();
    string[] result = s.Trim().Split(new string[] { ","}, StringSplitOptions.RemoveEmptyEntries);
    foreach (string col in result)
    {
        string[] kv = col.Split('=');
        resultSet[count].Add(kv[0], kv[1]);
    }
    count++;
} 
```

# .net - 按内存顺序物理排列的矩形阵列

> ID：10572073
> 
> 赞同：12
> 
> 时间：2012-05-13T13:18:34.840
> 
> 标签：.net, arrays, memory, multidimensional-array

在 C 中，在数组中说`A[2][3]`最右边的索引更改导致最小的内存地址偏移，即元素位于内存中`A[0][0], A[0][1]...`

.NET 中的矩形数组也是如此吗？如果我们有，说数组`a[2, 3]`是位于内存中的元素`a[0, 0], a[0, 1]...`吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-13T13:26:53.263

[CLI 规范](http://www.ecma-international.org/publications/standards/Ecma-335.htm)第8.9.1 节规定：

> 数组元素应在数组对象中按行优先顺序排列（即，与最右边数组维度相关的元素应从最低索引到最高索引连续排列）。为每个数组元素分配的实际存储空间可以包括特定于平台的填充。

所以答案是肯定的——你会首先遇到第一行的所有元素，然后是第二行的所有元素，等等（正如规范所说，这称为*row-major order*）。

# c# - 确定 FileSystemAccessRule 在 C# 中的继承位置

> ID：10572077
> 
> 赞同：1
> 
> 时间：2012-05-13T13:19:45.787
> 
> 标签：c#, security, acl

在 C#/.NET 中是否可以确定`System.Security.AccessControl.FileSystemAccessRule`实际继承自何处？如果是这样，我该怎么做？我想创建一个类似于 Windows 安全属性的输出，您可以在其中查看继承的 ACE 附加到哪个对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:57:46.597

您必须遍历文件或文件夹的路径才能找到规则的来源。这是一组粗略的函数，将打印所有访问规则及其来源。您可以轻松地对其进行修改以创建更有用的 API（换句话说，不仅仅是打印到控制台）。

```
void PrintAccessRules(string path)
{   
    var security = File.GetAccessControl(path);

    var accessRules = security.GetAccessRules(true, true, typeof(NTAccount));

    foreach (var rule in accessRules.Cast<FileSystemAccessRule>())
    {
        if (!rule.IsInherited)
        {
            Console.WriteLine("{0} {1} to {2} was set on {3}.", rule.AccessControlType, rule.FileSystemRights, rule.IdentityReference, path);
            continue;
        }

        FindInheritedFrom(rule, Directory.GetParent(path).FullName);
    }
}

void FindInheritedFrom(FileSystemAccessRule rule, string path)
{
    var security = File.GetAccessControl(path);
    var accessRules = security.GetAccessRules(true, true, typeof(NTAccount));

    var matching = accessRules.OfType<FileSystemAccessRule>()
        .FirstOrDefault(r => r.AccessControlType == rule.AccessControlType && r.FileSystemRights == rule.FileSystemRights && r.IdentityReference == rule.IdentityReference);

    if (matching != null)
    {
        if (matching.IsInherited) FindInheritedFrom(rule, Directory.GetParent(path).FullName);
        else Console.WriteLine("{0} {1} to {2} is inherited from {3}", rule.AccessControlType, rule.FileSystemRights, rule.IdentityReference, path);
    }
} 
```

例如：

```
PrintAccessRules(@"C:\projects\mg\lib\repositories.config"); 
```

为我打印以下内容：

```
Allow FullControl to SkipTyler\Mike was set on C:\projects\mg\lib\repositories.config.
Allow ReadAndExecute, Synchronize to SkipTyler\Mike is inherited from C:\projects\mg
Allow FullControl to BUILTIN\Administrators is inherited from C:\
Allow FullControl to NT AUTHORITY\SYSTEM is inherited from C:\
Allow ReadAndExecute, Synchronize to BUILTIN\Users is inherited from C:\ 
```

# authentication - grails 插件每次限制每个用户一个会话

> ID：10572080
> 
> 赞同：0
> 
> 时间：2012-05-13T13:20:22.073
> 
> 标签：authentication, grails, plugins

我正在使用“plugins.spring-security-core”，想知道是否有任何简单的方法可以将给定用户的会话数限制为 1。我尝试了“HttpSessionBindingListener”，但在当前的插件实现中看起来它只是绑定了用户“ id' 而不是完整的用户会话，因此不会调用适当的事件。

我想知道是否有人遇到过上述问题的解决方案。

提前致谢

-阿弥陀佛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:00:15.623

这是一个很好的例子

[http://blog.block-consult.com/2012/01/restricting-concurrent-user-sessions-in-grails-2-using-spring-security-core-plugin/](http://blog.block-consult.com/2012/01/restricting-concurrent-user-sessions-in-grails-2-using-spring-security-core-plugin/)

/约格

# php - PHP bbcode 递归正则表达式

> ID：10572081
> 
> 赞同：0
> 
> 时间：2012-05-13T13:20:26.227
> 
> 标签：php, regex, recursion, nested, bbcode

```
[div="desc"][1="text1"][2="text2"][3="link3"][/div] 
```

它继续可以继续限制为 6。如何创建一个提取“desc”、数字和文本的正则表达式？我尝试使用 php 数组，但我做不到。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:44:22.933

这里没有递归 - 至少你的例子没有显示它。如果在您的一般情况下确实存在递归，则正则表达式将不起作用；您将不得不使用解析器。

对于这种情况，我建议首先将 preg_match_all 与 /[([^]]+)]/ 之类的正则表达式一起使用。如果你将一个数组传递`matches`给这个函数，在运行 preg_match_all 之后，`matches[1]`应该是一个包含字符串 '[div="desc"]'、'[1="text1"]' 等的数组。一旦你有了这个数组，你可以使用`foreach`并拆分每个字符串循环遍历它`=`，然后对您解析的字符串的两个部分执行任何您喜欢的操作。

# html - 画布 LineTo 中的多色

> ID：10572083
> 
> 赞同：5
> 
> 时间：2012-05-13T13:20:29.973
> 
> 标签：html, canvas

```
function TrackGraphic(model, canvas) {
    //TrackModel
    this._model = model;
    this.draw = function(context) {
        var dx = Math.cos(this._model.startAngle + Math.PI / 2);
        var dy = Math.sin(this._model.startAngle + Math.PI / 2);

        context.beginPath();
        context.lineWidth = 10;
        context.moveTo(this._model.offsetX, this._model.offsetY);
        //CurvePoint
        var p;
        for (var d = 0; d < this._model.length; d += 1) {
            if (d > 1000) {

                console.log('2F2F2F');
                context.strokeStyle = "#2F2F2F" //"rgb(255,165,0)"; //0x2F2F2F

            } else {
                context.strokeStyle = "#FFF" //"rgb(255,165,0)"; //0x2F2F2F;
                console.log('FFFFFF');

            }
            p = this._model.getTrackPoint(d);
            context.lineTo(this._model.offsetX + p.x, this._model.offsetY + p.y)
        }
        context.stroke();
    }
}​ 
```

上面的代码在画布中生成线条。这条线是一种颜色，我想在开始时或在任何市政颜色中有所不同。我的代码不起作用：（为什么？。如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-13T15:37:08.353

在构建路径时更改颜色不会做任何事情。颜色只应用一次，当`stroke()`被调用时，所以`strokeStyle`你设置的最后一个将是整行的颜色。

`beginPath()`, `moveTo()`, `lineTo()`, 等仅创建一条路径，而该路径本身没有颜色。抚摸或填充该路径只会应用一种颜色。

如果您想要一条具有多种颜色的路径，则必须执行以下两项操作之一：

开始一条路径，画几条线，用一种颜色描边，然后开始另一条路径，用另一种颜色描边。换句话说：

```
// make a red line segment
ctx.beginPath();
ctx.moveTo(x, y);
ctx.lineTo(x, y);
ctx.strokeStyle = 'red';
ctx.stroke();
// Begin a new path and make this line segment green
ctx.beginPath();
ctx.moveTo(x, y);
ctx.lineTo(x, y);
ctx.strokeStyle = 'green';
ctx.stroke();
//etc 
```

或者，根据你在做什么，你也可以使用 linearGradient

# java - 评估 Xpath 时出现 InputStream 异常

> ID：10572090
> 
> 赞同：0
> 
> 时间：2012-05-13T13:21:30.720
> 
> 标签：java, xml, exception, xpath

我得到： `javax.xml.transform.TransformerException: Unable to evaluate expression using this context`

```
 at com.sun.org.apache.xpath.internal.XPath.execute(Unknown Source)
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.eval(Unknown Source)
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(Unknown Source)
    at XPathImplementation.evaluate(XPathImplementation.java:136)
    at Main.main(Main.java:23)
Caused by: java.lang.RuntimeException: Unable to evaluate expression using this context
    at com.sun.org.apache.xpath.internal.axes.NodeSequence.setRoot(Unknown Source)
    at com.sun.org.apache.xpath.internal.axes.LocPathIterator.execute(Unknown Source) 
```

在尝试使用`InputStream`object 评估 Xpath 表达式时，我尝试对其进行调试，但没有发现任何错误（当然我错过了一些东西..）。这是代码：

从主要：

```
 XPathProject m = new XPathImplementation();
    m.loadXML("books.xml"); 
    String q = "inventory/book/chapter[3]/preceding-sibling::chapter//title";
    Object ob = m.evaluate(q, null, XPathConstants.NODESET); 
```

我们使用这种`evaluate`方法：

```
public Object evaluate(String expression, Node source, QName returnType) throws XPathExpressionException,IllegalArgumentException,NullPointerException, TransformerException
{
...
  InputStream  is = nodeToInputStream(source);
  Object returnedObject= xpath.evaluate(expression, is, returnType); // it happens here !!

... more code
} 
```

辅助方法`nodeToInputStream`：

```
/*
 *    Convert Node object into InputStream object
 */

    private InputStream nodeToInputStream(Node node) throws TransformerException {
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        StreamResult outputTarget = new StreamResult(outputStream);
        Transformer t = TransformerFactory.newInstance().newTransformer();
        t.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
        t.transform(new DOMSource(node), outputTarget);
        return new ByteArrayInputStream(outputStream.toByteArray());
} 
```

知道我哪里出错了吗？10倍！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:39:00.480

好吧`m.evaluate(q, null, XPathConstants.NODESET);`，传入对评估方法的空引用，因此您创建`new DOMSource(null)`我认为这对我来说似乎没有意义，并且可能会导致稍后在`inventory/book/chapter[3]/preceding-sibling::chapter//title`评估相对 XPath 时出现该错误。

# c++ - 模板方法上的 gcc 链接错误

> ID：10572093
> 
> 赞同：1
> 
> 时间：2012-05-13T13:21:46.183
> 
> 标签：c++, gcc, linker-errors

我遇到了这个链接器错误，并且在通过它时遇到了一些麻烦。

> `o/foo/bar.cc.o: In function 'foo::bar()': bar.cc:(.text+0x728): undefined reference to 'rf<PlayerInfo> Util::getClosestToGlobal<PlayerInfo>(std::vector<rf<bats::PlayerInfo>, std::allocator<rf<PlayerInfo> > >, Eigen::Matrix<double, 3, 1, 2, 3, 1>)'`

`Util.h`文件定义：

```
template <class ObjectClass>
static rf<ObjectClass> getClosestToGlobal(
    std::vector<rf<ObjectClass> > objects, Eigen::Vector3d targetPosGlobal); 
```

`Util.cpp`定义：

```
template <class ObjectClass>
rf<ObjectClass> Util::getClosestToGlobal(
    std::vector<rf<ObjectClass> > objects, Eigen::Vector3d targetPosGlobal)
{
    // ...
} 
```

我知道我的 cpp 文件编译成功，因为它按预期重新创建了 .o 文件。

我是否在此处提供了足够的信息以供更有经验的人识别问题？如果没有，我还应该去哪里寻找？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:30:56.377

模板类/方法定义应该[在头文件](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.13)中可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T13:23:13.417

您需要在声明它的头文件中定义您的模板化函数。

# tomcat - Restlet css 和 javascript 文件

> ID：10572094
> 
> 赞同：0
> 
> 时间：2012-05-13T13:22:13.767
> 
> 标签：tomcat, servlets, web.xml, restlet

WebContent - 资源 - css - style.css WEB-INF - index.html

```
public synchronized Restlet createInboundRoot() {
    Router router = new Router(getContext());
    router.attach("/", IndexResource.class); 
    return router;
} 
```

IndexResource 执行 HTML Respresentation (index.html)

在我的 index.html 中，我指定了一个 css 文件。问题是找不到。

```
 <link href="/resources/css/style.css" rel="stylesheet" type="text/css"> 
```

我认为`/resources/css/style.css`是通过 restlet 而不是实际的文件路径。如何停止资源文件夹作为 servlet (restlet) 执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T15:11:29.343

您的 css 文件必须由 Restlet 提供吗？如果是这样，您应该考虑使用如下所述的 Directory 类（在您的应用程序类中）：

```
public Restlet createInboundRoot() {
    Router router = new Router(getContext());
    (...)
    router.attach("/resources", new Directory(getContext(), "file://<STATIC_DIR>"));
} 
```

在这种情况下，您需要在文件夹下有 css/style.css。

希望它可以帮助你。蒂埃里

# ios - 处理兼容性问题 IOS 4.0- 5.1

> ID：10572101
> 
> 赞同：2
> 
> 时间：2012-05-13T13:23:17.417
> 
> 标签：ios, core-data, ios5, ios4, uicolor

我创建了一个在 5.0 及更高版本上运行良好的应用程序，但是当我在较低的设备上进行测试时，我遇到了一些我不确定如何解决和纠正的问题。

第一个大问题是当保存到核心数据时，我使用了一个错误方法，我相信这是苹果在创建核心数据模型时创建的默认错误方法。该应用程序在低于 5.0 时崩溃，但如果我屏蔽错误代码，一切正常。下面是用于查找错误和处理它的代码。

```
NSError *error;
if (![managedObjectContext save:&error]) { // crash here
    // This is a serious error saying the record could not be saved.
    // Advise the user to restart the application       
} 
```

//下面的崩溃日志

```
2012-05-13 10:17:22.062 PreviewMaker[41595:207] -[UIImage encodeWithCoder:]:   
unrecognized selector sent to instance 0x5e7ce80
2012-05-13 10:17:22.064 PreviewMaker[41595:207] *** Terminating app due to uncaught   
exception 'NSInvalidArgumentException', reason: '-[UIImage encodeWithCoder:]:   
unrecognized selector sent to instance 0x5e7ce80'
*** Call stack at first throw:
(
0   CoreFoundation                      0x013fc5a9 __exceptionPreprocess + 185
1   libobjc.A.dylib                     0x0178b313 objc_exception_throw + 44
2   CoreFoundation                      0x013fe0bb -[NSObject(NSObject) 
doesNotRecognizeSelector:] + 187
3   CoreFoundation                      0x0136d966 ___forwarding___ + 966
4   CoreFoundation                      0x0136d522 _CF_forwarding_prep_0 + 50
5   Foundation                          0x00c45b3e _encodeObject + 1076
6   Foundation                          0x00c50f89 +[NSKeyedArchiver 
archivedDataWithRootObject:] + 206
7   CoreData                            0x01122cb5 -[NSSQLiteConnection execute] +   
2677
8   CoreData                            0x011771d6 -[NSSQLiteConnection insertRow:] 
+ 262
9   CoreData                            0x01173e64 -[NSSQLConnection   
performAdapterOperations:] + 180
10  CoreData                            0x01173b0e -[NSSQLCore 
_performChangesWithAdapterOps:] + 494
11  CoreData                            0x011725ea -[NSSQLCore performChanges] + 410
12  CoreData                            0x0116c038 -[NSSQLCore saveChanges:] + 216
13  CoreData                            0x0112a199 -[NSSQLCore 
executeRequest:withContext:error:] + 409
14  CoreData                            0x011da70b -[NSPersistentStoreCoordinator 
executeRequest:withContext:error:] + 3691
15  CoreData                            0x01162948 -[NSManagedObjectContext save:] + 
712
16  PreviewMaker                        0x0000a0c0 -[MainViewController 
noUploadJustSaveImage:] + 331
17  PreviewMaker                        0x00009d3c -[MainViewController 
UserConfirmedToSaveImage] + 756
18  UIKit                               0x004774fd -[UIApplication 
sendAction:to:from:forEvent:] + 119
19  UIKit                               0x00507799 -[UIControl 
sendAction:to:forEvent:] + 67
20  UIKit                               0x00509c2b -[UIControl(Internal) 
_sendActionsForEvents:withEvent:] + 527
21  UIKit                               0x005087d8 -[UIControl   
touchesEnded:withEvent:] + 458
22  UIKit                               0x0049bded -[UIWindow _sendTouchesForEvent:] 
+ 567
23  UIKit                               0x0047cc37 -[UIApplication sendEvent:] + 447
24  UIKit                               0x00481f2e _UIApplicationHandleEvent + 7576
25  GraphicsServices                    0x01eb8992 PurpleEventCallback + 1550
26  CoreFoundation                      0x013dd944 
__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 52
27  CoreFoundation                      0x0133dcf7 __CFRunLoopDoSource1 + 215
28  CoreFoundation                      0x0133af83 __CFRunLoopRun + 979
29  CoreFoundation                      0x0133a840 CFRunLoopRunSpecific + 208
30  CoreFoundation                      0x0133a761 CFRunLoopRunInMode + 97
31  GraphicsServices                    0x01eb71c4 GSEventRunModal + 217
32  GraphicsServices                    0x01eb7289 GSEventRun + 115
33  UIKit                               0x00485c93 UIApplicationMain + 1160
34  PreviewMaker                        0x00002e07 main + 121
35  PreviewMaker                        0x00002d85 start + 53

)
terminate called after throwing an instance of 'NSException' 
```

我遇到的另一个问题是设置`tintColor`UI 对象，例如`UISwitch`. 我有一个设置控制器，它有几个`UISwitch`es 等，几乎都设置了 tint 颜色，但是一旦低于 5.0 的任何东西都崩溃了。我如何处理这两者而不必为了与 5.0 以下的设备兼容而重新编写代码。

```
shineSwitch = [[[UISwitch alloc] initWithFrame:CGRectZero] autorelease];
[cell.contentView addSubview:shineSwitch];
cell.accessoryView = shineSwitch;
[shineSwitch addTarget:self action:@selector(switchChanged:)  
forControlEvents:UIControlEventValueChanged];
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
shineSwitch.onTintColor = [UIColor colorWithRed:0.0 green:0.61 blue:0.99 alpha:1.0]; 
```

//下面的崩溃日志

```
2012-05-13 10:19:45.033 PreviewMaker[41611:207] -[UISwitch setOnTintColor:]: 
unrecognized selector sent to instance 0x5eab860
2012-05-13 10:19:45.034 PreviewMaker[41611:207] *** Terminating app due to uncaught   
exception 'NSInvalidArgumentException', reason: '-[UISwitch setOnTintColor:]:     
unrecognized selector sent to instance 0x5eab860'
*** Call stack at first throw:
(
0   CoreFoundation                      0x013fc5a9 __exceptionPreprocess + 185
1   libobjc.A.dylib                     0x0178b313 objc_exception_throw + 44
2   CoreFoundation                      0x013fe0bb -[NSObject(NSObject)   
doesNotRecognizeSelector:] + 187
3   CoreFoundation                      0x0136d966 ___forwarding___ + 966
4   CoreFoundation                      0x0136d522 _CF_forwarding_prep_0 + 50
5   PreviewMaker                        0x0000f6fb -[FlipsideViewController 
tableView:cellForRowAtIndexPath:] + 1353
6   UIKit                               0x004ecb98 -  
[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:withIndexPath:] + 634
7   UIKit                               0x004e24cc -
[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:] + 75
8   UIKit                               0x004f78cc -  
[UITableView(_UITableViewPrivate) _updateVisibleCellsNow:] + 1561
9   UIKit                               0x004ef90c -[UITableView layoutSubviews] +   
242
10  QuartzCore                          0x001e2a5a -[CALayer layoutSublayers] + 181
11  QuartzCore                          0x001e4ddc CALayerLayoutIfNeeded + 220
12  QuartzCore                          0x0018a0b4 
_ZN2CA7Context18commit_transactionEPNS_11TransactionE + 310
13  QuartzCore                          0x0018b294 _ZN2CA11Transaction6commitEv +  
292
14  QuartzCore                          0x0018b46d 
_ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv + 99
15  CoreFoundation                      0x013dd89b 
__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 27
16  CoreFoundation                      0x013726e7 __CFRunLoopDoObservers + 295
17  CoreFoundation                      0x0133b1d7 __CFRunLoopRun + 1575
18  CoreFoundation                      0x0133a840 CFRunLoopRunSpecific + 208
19  CoreFoundation                      0x0133a761 CFRunLoopRunInMode + 97
20  GraphicsServices                    0x01eb71c4 GSEventRunModal + 217
21  GraphicsServices                    0x01eb7289 GSEventRun + 115
22  UIKit                               0x00485c93 UIApplicationMain + 1160
23  PreviewMaker                        0x00002e07 main + 121
24  PreviewMaker                        0x00002d85 start + 53

)
terminate called after throwing an instance of 'NSException' 
```

任何帮助将不胜感激！

# java - 如何使用 java 的 String.replaceAll(String, String) 方法将“”等字符串转换 为“ ”？

> ID：10572103
> 
> 赞同：4
> 
> 时间：2012-05-13T13:23:43.213
> 
> 标签：java, regex, string

如何转换字符串

```
"<br><br><br><br><br><br>" to 
"<br>" using java's String.replaceAll(String, String) method? 
```

我都试过了：

```
 str.replaceAll("<br>+","<br>");
    str.replaceAll("<br>{1,}","<br>); 
```

但两者都不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-13T13:26:32.810

`<br>+`匹配`"<br>>>>>>>>"`，试试这个：`(<br>)+`

如果标签之间有空格，请执行以下操作：

```
str = str.replaceAll("(<br>\\s*)+","<br>"); 
```

# cuda - 库达。重用已使用的指针

> ID：10572105
> 
> 赞同：0
> 
> 时间：2012-05-13T13:23:51.887
> 
> 标签：cuda, jcuda

我在使用 JCUDA 时遇到了麻烦。我的任务是使用 CUFFT 库进行 1D FFT，但结果应该乘以 2。所以我决定使用 CUFFT_R2C 类型进行 1D FFT。接下来负责这个的类：

```
public class FFTTransformer {

    private Pointer inputDataPointer;

    private Pointer outputDataPointer;

    private int fftType;

    private float[] inputData;

    private float[] outputData;

    private int batchSize = 1;

    public FFTTransformer (int type, float[] inputData) {
        this.fftType = type;
        this.inputData = inputData;
        inputDataPointer = new CUdeviceptr();

        JCuda.cudaMalloc(inputDataPointer, inputData.length * Sizeof.FLOAT);
        JCuda.cudaMemcpy(inputDataPointer, Pointer.to(inputData),
                inputData.length * Sizeof.FLOAT, cudaMemcpyKind.cudaMemcpyHostToDevice);

        outputDataPointer = new CUdeviceptr();
        JCuda.cudaMalloc(outputDataPointer, (inputData.length + 2) * Sizeof.FLOAT);

    }

    public Pointer getInputDataPointer() {
        return inputDataPointer;
    }

    public Pointer getOutputDataPointer() {
        return outputDataPointer;
    }

    public int getFftType() {
        return fftType;
    }

    public void setFftType(int fftType) {
        this.fftType = fftType;
    }

    public float[] getInputData() {
        return inputData;
    }

    public int getBatchSize() {
        return batchSize;
    }

    public void setBatchSize(int batchSize) {
        this.batchSize = batchSize;
    }

    public float[] getOutputData() {
        return outputData;
    }

    private void R2CTransform() {

        cufftHandle plan = new cufftHandle();

        JCufft.cufftPlan1d(plan, inputData.length, cufftType.CUFFT_R2C, batchSize);

        JCufft.cufftExecR2C(plan, inputDataPointer, outputDataPointer);

        JCufft.cufftDestroy(plan);
    }

    private void C2CTransform(){

        cufftHandle plan = new cufftHandle();

        JCufft.cufftPlan1d(plan, inputData.length, cufftType.CUFFT_C2C, batchSize);

        JCufft.cufftExecC2C(plan, inputDataPointer, outputDataPointer, fftType);

        JCufft.cufftDestroy(plan);
    }

    public void transform(){
        if (fftType == JCufft.CUFFT_FORWARD) {
            R2CTransform();
        } else {
            C2CTransform();
        }
    }

    public float[] getFFTResult() {
        outputData = new float[inputData.length + 2];
        JCuda.cudaMemcpy(Pointer.to(outputData), outputDataPointer,
                outputData.length * Sizeof.FLOAT, cudaMemcpyKind.cudaMemcpyDeviceToHost);
        return outputData;
    }

    public void releaseGPUResources(){
        JCuda.cudaFree(inputDataPointer);
        JCuda.cudaFree(outputDataPointer);
    }

    public static void main(String... args) {
        float[] inputData = new float[65536];
        for(int i = 0; i < inputData.length; i++) {
            inputData[i] = (float) Math.sin(i);
        }
        FFTTransformer transformer = new FFTTransformer(JCufft.CUFFT_FORWARD, inputData);
        transformer.transform();
        float[] result = transformer.getFFTResult();

        HilbertSpectrumTicksKernelInvoker.multiplyOn2(transformer.getOutputDataPointer(), inputData.length+2);

        transformer.releaseGPUResources();
    }
} 
```

负责乘法的方法使用 cuda 核函数。Java方法代码：

```
public static void multiplyOn2(Pointer inputDataPointer, int dataSize){

        // Enable exceptions and omit all subsequent error checks
        JCudaDriver.setExceptionsEnabled(true);

        // Create the PTX file by calling the NVCC
        String ptxFileName = null;
        try {
            ptxFileName = FileService.preparePtxFile("resources\\HilbertSpectrumTicksKernel.cu");
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        // Initialize the driver and create a context for the first device.
        cuInit(0);
        CUdevice device = new CUdevice();
        cuDeviceGet(device, 0);
        CUcontext context = new CUcontext();
        cuCtxCreate(context, 0, device);

        // Load the ptx file.
        CUmodule module = new CUmodule();
        cuModuleLoad(module, ptxFileName);

        // Obtain a function pointer to the "add" function.
        CUfunction function = new CUfunction();
        cuModuleGetFunction(function, module, "calcSpectrumSamples");

        // Set up the kernel parameters: A pointer to an array
        // of pointers which point to the actual values.
        int N = (dataSize + 1) / 2 + 1;
        int pair = (dataSize + 1) % 2 > 0 ? 1 : -1;

        Pointer kernelParameters = Pointer.to(Pointer.to(inputDataPointer),
                Pointer.to(new int[] { dataSize }),
                Pointer.to(new int[] { N }), Pointer.to(new int[] { pair }));

        // Call the kernel function.
        int blockSizeX = 128;
        int gridSizeX = (int) Math.ceil((double) dataSize / blockSizeX);
        cuLaunchKernel(function, gridSizeX, 1, 1, // Grid dimension
                blockSizeX, 1, 1, // Block dimension
                0, null, // Shared memory size and stream
                kernelParameters, null // Kernel- and extra parameters
        );
        cuCtxSynchronize();

        // Allocate host output memory and copy the device output
        // to the host.
        float freq[] = new float[dataSize];
        cuMemcpyDtoH(Pointer.to(freq), (CUdeviceptr)inputDataPointer, dataSize
                * Sizeof.FLOAT); 
```

接下来是核函数：

```
extern "C"

__global__ void calcSpectrumSamples(float* complexData, int dataSize, int N, int pair) {

    int i = threadIdx.x + blockIdx.x * blockDim.x;

    if(i >= dataSize) return;

    complexData[i] = complexData[i] * 2;
} 
```

但是，当我试图将指向 FFT 结果的指针（在设备内存中）传递给 multiplyOn2 方法时，它会在 cuCtxSynchronize() 调用上引发异常。例外：

```
Exception in thread "main" jcuda.CudaException: CUDA_ERROR_UNKNOWN
    at jcuda.driver.JCudaDriver.checkResult(JCudaDriver.java:263)
    at jcuda.driver.JCudaDriver.cuCtxSynchronize(JCudaDriver.java:1709)
    at com.ifntung.cufft.HilbertSpectrumTicksKernelInvoker.multiplyOn2(HilbertSpectrumTicksKernelInvoker.java:73)
    at com.ifntung.cufft.FFTTransformer.main(FFTTransformer.java:123) 
```

我试图使用 Visual Studion C++ 做同样的事情，这没有问题。请你帮助我好吗。

PS我可以解决这个问题，但是我需要将数据从设备内存复制到主机内存，然后在每次调用新的cuda函数之前通过创建新指针复制回来，这会减慢我的程序执行速度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T12:49:39.867

错误究竟发生在哪一行？

Cuda 错误也可能是先前的错误。

为什么要使用 Pointer.to(inputDataPointer)，你已经有了那个设备指针。现在你将一个指向设备的指针传递给设备？

```
Pointer kernelParameters = Pointer.to(Pointer.to(inputDataPointer), 
```

我还建议使用“this”限定符或任何其他标记来检测实例变量。如果我看不到方法中的变量试图通过阅读它来调试它的哪个范围，我讨厌并拒绝查看代码，尤其是嵌套的并且像你的示例一样长。
我不想总是问自己这个变量到底是从哪里来的。

如果 SO 问题中的复杂代码格式不正确，我不会阅读它。

# css - CSS元素覆盖/重叠问题

> ID：10572107
> 
> 赞同：0
> 
> 时间：2012-05-13T13:24:31.097
> 
> 标签：css, html, overlay, overlap

我不是 CSS 专家，但我相信我的任务对你们专家来说非常简单/基本。提前感谢您的帮助。

**更新 #1：在这里找到 HTML/CSS 代码：http: [//jsfiddle.net/x5buy/3](http://jsfiddle.net/x5buy/3)**

截图也：这是当前接受的布局：http: [//img31.imageshack.us/img31/5198/56133492.png](http://img31.imageshack.us/img31/5198/56133492.png)

我需要在导航中添加更多项目，但布局已损坏，请参阅：http: [//img9.imageshack.us/img9/1058/21950608.png](http://img9.imageshack.us/img9/1058/21950608.png)

**这就是我需要达到的结果：http:** [//img13.imageshack.us/img13/9349/45543510.png](http://img13.imageshack.us/img13/9349/45543510.png)

这是当前负责的CSS代码..

标头主容器：http: [//img406.imageshack.us/img406/7692/513201231541pm.png](http://img406.imageshack.us/img406/7692/513201231541pm.png)

标题内容：http: [//img442.imageshack.us/img442/4977/513201222222pm.png](http://img442.imageshack.us/img442/4977/513201222222pm.png)

导航：http: [//img269.imageshack.us/img269/6426/513201222314pm.png](http://img269.imageshack.us/img269/6426/513201222314pm.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:20:01.653

很难弄清楚发生了什么，因为它不是您在屏幕截图中显示的精确复制品。

无论如何，您的顶部菜单似乎很明显被向下推，因为左侧`<div id="caption">`很大。出路是`<ul id="navigation">`绝对定位在内部`<div class="content">`（如果需要，更改 z-index）。

# php - Backbone.js 同步 - PHP 返回

> ID：10572108
> 
> 赞同：2
> 
> 时间：2012-05-13T13:24:32.670
> 
> 标签：php, rest, backbone.js

我正在学习使用 Backbone.js 并设置以下环境：

```
/* define the model */
var Login = Backbone.Model.extend({
    url:"api/index.php/login/"
});

/* the following code is contained in a view method */

var login = new Login({
    email: $("#email").val(),
    pass: $("#pass").val()
});

var result = Backbone.sync('create',login);
alert(JSON.stringify(result)); 
```

在服务器上的“index.php”中调用了正确的方法并且数据正确可用。

警报仅输出：`{"readyState":1}`

现在我的问题是：服务器（index.php）应该返回/输出什么来回答客户端？我想将数据传输回客户端以例如显示它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:56:54.363

`Backbone.sync()`是一个*异步*操作。你不能做

```
var result = Backbone.sync('create', login); 
```

因为`sync()`不*返回*任何有用的东西。它将请求发送到服务器并立即返回，远远早于服务器的响应到达。

在那里使用[`options`参数](http://documentcloud.github.com/backbone/#Sync)和放置`success`和`error`回调函数。

```
Backbone.sync('create', login, {
  success: function () {
    // whatever you want to do when login succeeds
  },
  error: function () {
    // display an error message
  }
}); 
```

如果服务器返回响应，`error`回调将被执行`401 Unauthorized`，例如；服务器返回时的`success`回调`200 OK`。

有关如何使用这些回调以及您可以使用哪些其他选项的文档，请阅读[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)文档。

# spring-mvc - Spring MVC 不处理来自休眠验证器的错误

> ID：10572112
> 
> 赞同：0
> 
> 时间：2012-05-13T13:25:23.327
> 
> 标签：spring-mvc, spring-security, hibernate-validator, tiles2

我创建表单和控制器，这个表单使用 Hibernate 验证器有一些验证约束。我在开始测试验证约束时遇到问题，但是我得到了带有拒绝的属性模型的蓝色异常页面。

这个配置

```
 @Configuration
    @ComponentScan(basePackages = {"com.whatever.core.web"})
    @EnableWebMvc
    public class WebMvcConfig extends WebMvcConfigurationSupport {

private static final String MESSAGE_SOURCE = "/WEB-INF/classes/messages";
private static final String TILES = "/WEB-INF/tiles/tiles.xml";
private static final String VIEWS = "/WEB-INF/views/**/views.xml";

private static final String RESOURCES_HANDLER = "/resources/";
private static final String RESOURCES_LOCATION = RESOURCES_HANDLER + "**";

@Override
public RequestMappingHandlerMapping requestMappingHandlerMapping() {
    RequestMappingHandlerMapping requestMappingHandlerMapping = super.requestMappingHandlerMapping();
    requestMappingHandlerMapping.setUseSuffixPatternMatch(false);
    requestMappingHandlerMapping.setUseTrailingSlashMatch(false);
    return requestMappingHandlerMapping;
}

public void configureMessageConverters(List<HttpMessageConverter<?>> converters) {
    converters.add(new MappingJacksonHttpMessageConverter());
}

@Bean(name = "messageSource")
public MessageSource configureMessageSource() {
    ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
    messageSource.setBasename(MESSAGE_SOURCE);
    messageSource.setCacheSeconds(5);
    return messageSource;
}

@Bean
public TilesViewResolver configureTilesViewResolver() {
    return new TilesViewResolver();
}

@Bean
public TilesConfigurer configureTilesConfigurer() {
    TilesConfigurer configurer = new TilesConfigurer();
    configurer.setDefinitions(new String[] {TILES, VIEWS});
    return configurer;
}

@Override
public Validator getValidator() {
    LocalValidatorFactoryBean validator = new LocalValidatorFactoryBean();
    validator.setValidationMessageSource(configureMessageSource());
    return validator;
}

@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
    registry.addResourceHandler(RESOURCES_HANDLER).addResourceLocations(RESOURCES_LOCATION);
}

@Override
public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
    configurer.enable();
}
    } 
```

和这里的控制器

```
 if(result.hasErrors()){
        return null; OR "view name"
    }
    User user = new User();
    user.setUsername(userModel.getUsername());        
    user.setFirstName(userModel.getFirstName());
    user.setLastName(userModel.getLastName());
    user.setGender(userModel.getGender());
    user.setLocation(userModel.getLocation());
    user.setPassword(passwordEncoder.encodePassword(userModel.getPassword(),null));

    userRepository.save(user);
    doAutoLogin(userModel.getUsername(),userModel.getPassword(),request);
    return "redirect:/home"; 
```

注意：我使用 springMVC、spring security、tile 和 hibernate 验证器

我将 SpringMVC 与带有 XML 配置和门户环境的休眠验证器一起使用，并且工作正常我不知道这里出了什么问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T21:25:53.083

我发现了问题！方法控制器的签名应该是这样的

```
 public String signup(@ModelAttribute("userModel") @Valid SignupForm userModel,BindingResult result,HttpServletRequest request,HttpServletResponse response,ModelMap model) 
```

正如我在 sprinsource 论坛中所读到的，BindingResult 应该遵循 modelAttribute 并找到工作。我没有找到任何官方文档，但它现在可以工作了。

要查看 springsource 论坛的主题，请查看此链接[http://forum.springsource.org/showthread.php?85815-BindException-Thrown-on-bind-errors-(instead-of-returning-errors-to-controller-method](http://forum.springsource.org/showthread.php?85815-BindException-Thrown-on-bind-errors-(instead-of-returning-errors-to-controller-method)

# css - CSS中的左边框和右边框高度相等

> ID：10572115
> 
> 赞同：5
> 
> 时间：2012-05-13T13:25:28.457
> 
> 标签：css, border

![在此处输入图像描述](../Images/f675e961277b77617961be43cc9230d0.png) ![在此处输入图像描述](../Images/ab9bfb6547f7416208a113cf3e2b2db1.png)

如何使左边框与右边框的高度相同？换句话说，如何改变边框的顺序？左边框比右边框高。这会导致 1px 的“间隙”。

```
.tab-header > ul > li
{
display: inline-block;
background-color: #ffffff;
border-bottom: 1px solid #ffffff;
border-left: 1px solid #cecece;
border-right: 1px solid #cecece;
border-top: 1px solid #cecece;
padding: 8px;
font-size: 10px;
text-transform: uppercase;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T13:37:12.530

正在发生的事情是，css 试图在边框中做出漂亮的对角线颜色变化。如果您将所有更改`1px`为`10px`，您会看到问题。（图片见：http: [//jsfiddle.net/DaTCy/1/](http://jsfiddle.net/DaTCy/1/)）

![在此处输入图像描述](../Images/7f2d1d0fe99a5ddf1bf406be7fc1be69.png)

如果您使用 1px 宽度的边框，底部和右侧边框将始终在右下角像素重叠。

* * *

编辑：作为一种解决方案，您可以尝试将底部边框的宽度设为 0px，并解决放置按钮的容器中的高度问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T13:45:04.167

最简单的解决方案是显式使用：

```
border-bottom-width: 0; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/M2bWa/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T13:41:04.780

将`border-left/-top/-right`and`border-bottom`用于*不同*的[嵌套] 元素。

# c# - 通过 c# 控制台应用程序运行批处理文件。命令被忽略

> ID：10572122
> 
> 赞同：2
> 
> 时间：2012-05-13T13:26:46.173
> 
> 标签：c#, windows, batch-file, console-application, command-prompt

我正在尝试使用此处的代码通过 ac# 控制台应用程序执行 .bat 文件： [Service hangs up at WaitForExit after calling batch file](https://stackoverflow.com/questions/361097/c-sharp-service-cannot-execute-batch-file)

凯文的解决方案有点工作，但我的 .bat 文件中的一些命令由于某种原因被忽略了，但是当我手动执行 .bat 文件时，所有命令都可以正常工作。

例如，xcopy 命令在从控制台应用程序执行 .bat 时不起作用，但 start 命令工作正常。

知道为什么会这样吗？

ps 最近我发现如果程序是从命令提示符启动的，它运行良好。怎么来的？我仍然需要将其置于自动运行状态，所以这并不能解决问题。

此外，如果通过单击 exe 文件启动，输出显示

xcopy 文件夹1 文件夹2

但如果从命令提示符启动，输出显示

xcopy 文件夹1 文件夹2

smth/smth.smth 已复制

……

复制了 5 个文件。

它实际上正在被复制。

```
proc.StartInfo.FileName                 = target;
        proc.StartInfo.RedirectStandardError    = true;
        proc.StartInfo.RedirectStandardOutput   = true;
        proc.StartInfo.UseShellExecute          = false;

        proc.Start();

        proc.WaitForExit
            (
                (timeout <= 0)
                ? int.MaxValue : timeout * NO_MILLISECONDS_IN_A_SECOND *
                   NO_SECONDS_IN_A_MINUTE
            );

        errorMessage    = proc.StandardError.ReadToEnd();
        proc.WaitForExit();

        outputMessage   = proc.StandardOutput.ReadToEnd();
        proc.WaitForExit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:51:50.700

当您从服务执行命令处理器时，批处理文件命令*不会被忽略。*然而，它们很容易*失败*并且可以在不被观察的情况下这样做，因为你看不到它们的输出。失败的典型原因是 ProcessStartInfo.WorkingDirectory 设置不正确，因此相对路径不再起作用，或者由使用不同用户帐户运行的服务引起的问题，该用户帐户与您在桌面上使用的用户帐户没有相同的权限。

通过将输出重定向到文件来诊断问题，运行 cmd.exe /c 并使用`>`操作符。追加`2>&1`以便文件包含常规和错误输出。并且通过明智地使用[%errorlevel% 变量](http://technet.microsoft.com/en-us/library/bb490920)和[EXIT 命令](http://technet.microsoft.com/en-us/library/bb490902)，您可以通过使用 Process.ExitCode 属性发现执行失败。

# nhibernate - 如何使用 nhibernate 调用存储过程？

> ID：10572128
> 
> 赞同：1
> 
> 时间：2012-05-13T13:27:42.997
> 
> 标签：nhibernate, stored-procedures, nhibernate-mapping

我对此进行了研究，所有解决方案都指向一种解决方案，使用下面的代码库并将其放入 .hbm.xml 文件中。但我没有。我所拥有的是hibernate.cfg.xml 和nhvalidator.cfg.xml。

我从这里读到：[http](http://forums.asp.net/t/1407518.aspx/1) ://forums.asp.net/t/1407518.aspx/1 但是我在哪里可以输入查询标签？我在 hibernate.cfg.xml 中输入了它（见下文），但它不起作用。

```
<?xml version="1.0" encoding="utf-16"?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
        <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
        <property name="dialect">NHibernate.Dialect.MsSql2005Dialect</property>
        <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
        <property name="connection.connection_string">Server=localhost\MSSQLSERVERR2;Database=SupplierSearch;Trusted_Connection=True</property>
        <property name="proxyfactory.factory_class">NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>
        <property name="cache.use_minimal_puts">false</property>
        <property name="use_outer_join">false</property>
    </session-factory>
   <hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
  namespace="Quarry.SupplierSearch"
  assembly="SupplierSearch">
    <class name="SupplierSearch" table="Client" lazy="true">
      <id name="ClientId" column="ClientId">
        <generator class="native" />
      </id>

      <property name="FirstName" column="FirstName" />
      <property name="ClientId" column="ClientId" />

      <loader query-ref="GetAllClient"/>
    </class>
    <sql-query name="GetAllClient" >
      <return alias="GetAllClient" class="SupplierSearch">
        <return-property name="ClientId" column="ClientId"/>
        <return-property name="FirstName" column="FirstName"/>
      </return>
      exec GetAllClient 
    </sql-query>
  </hibernate-mapping>
</hibernate-configuration> 
```

由于它不起作用，我尝试在客户端映射的 Client.nhv.xml 中输入它（见下文）

```
<?xml version="1.0" encoding="utf-8"?>
<nhv-mapping assembly="Quarry.SupplierSearch" namespace="Quarry.SupplierSearch.Model" xmlns="urn:nhibernate-validator-1.0">
    <class name="Client">
        <property name="Address1">
            <not-null />
        </property>
        <property name="Address2">
            <not-null />
        </property>
        <property name="BusinessName">
            <not-null />
        </property>
        <property name="ClientId">
            <not-null />
            <digits integerDigits="10" />
        </property>
        <property name="Country">
            <not-null />
        </property>
        <property name="FirstName">
            <not-null />
        </property>
        <property name="LastName">
            <not-null />
        </property>
        <property name="ListingType">
            <not-null />
            <digits integerDigits="10" />
        </property>
        <property name="PhoneNumber">
            <not-null />
        </property>
        <property name="PostCode">
            <not-null />
        </property>
        <property name="State">
            <not-null />
        </property>
    </class>
  <loader query-ref="GetAllClient"/>
  <sql-query name="GetAllClient">
    <load-collection alias="Clients" role ="Client"/>
    exec [GetAllClient] 
  </sql-query>
</nhv-mapping> 
```

有什么建议可以让它工作吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T17:31:48.420

它需要被称为`Client.hbm.xml`not`Client.hbv.xml`和嵌入式资源。

**编辑**我不熟悉任何生成 hbv 的工具，也从未见过以`<nhv-mapping .. >`. 必须有一个自定义插件/dll，您必须使用它才能使其正常工作。你用的是什么工具？

但是，您是否看过这篇[博文](http://puredotnetcoder.blogspot.co.uk/2012/04/using-stored-procedures-with-nhibernate.html)以让 SP 在没有任何自定义工具的情况下工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T03:33:43.207

负载收集不支持使用存储过程（仅限标量）。使用格式：

```
<sql-query name="GetAllClient">
    <load-collection alias="Clients" role ="Client"/>
    SELECT {c.*}
    FROM client c
</sql-query> 
```

（当然，用你存储的过程内部的东西代替“SELECT ... FROM ...”部分。）

# php - 在下拉列表中回显所选日期

> ID：10572129
> 
> 赞同：0
> 
> 时间：2012-05-13T13:28:06.237
> 
> 标签：php

好的，我有这段代码来回显如果选择了值，我如何在不为每天创建变量的情况下将其用于日期下拉列表？

```
if ($st_title[$i] == 'Mr') {
    $mr_select='selected="selected"';
    $mrs_select='';
    $ms_select='';  
} else if ($st_title[$i]=='Mrs') {
    $mr_select='';
    $mrs_select='selected="selected"';
    $ms_select='';  
} else {
    $mr_select='';
    $mrs_select='';
    $ms_select='selected="selected"';
} 
```

我想通了，仅供参考，这是我想出的：

```
for ($x=0; $x<=31; $x++){
$dobd[$x]='';
  if ($x ==$st_dobd){
      $dobd[$x]='selected="selected"';
      }else{
          $dobd[$x]='';
          }
}
for ($x=0; $x<=12; $x++){
$dobm[$x]='';
  if ($x ==$st_dobm){
      $dobm[$x]='selected="selected"';
      }else{
          $dobm[$x]='';
          }
}
for ($x=2000; $x>=1970; $x--){
$doby[$x]='';
  if ($x ==$st_doby){
      $doby[$x]='selected="selected"';
      }else{
          $doby[$x]='';
          }
}

                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:32:27.207

您可以使用您的日期创建一个数组并通过该数组生成下拉列表，键可能是天（日期）和值 0 或 1（如果选择）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T13:34:38.533

我认为您应该在此符号 '"' 之前添加 '\' 符号

# php - 使用 onChange、ajax、php 和 Mysql 提交表单。Dropdown 列表的值不会发送到 php 提交页面

> ID：10572133
> 
> 赞同：0
> 
> 时间：2012-05-13T13:28:14.300
> 
> 标签：php, mysql, ajax, forms, submit

我有一个表格，其中包含国家/地区的下拉列表。

如果用户选择其中一个国家（onchange），则会出现一个新的城市下拉列表，仅显示该特定国家的城市。

```
<select name = \"countries\" id=\"ListOfCountries\" onchange=\"showCities(this.value)\"> 
```

我已经通过使用 php、mysql 和 ajax 实现了这一点。

我学习并遵循的教程在以下链接中：

[http://www.w3schools.com/php/php_ajax_database.asp](http://www.w3schools.com/php/php_ajax_database.asp)

城市的下拉列表会自动显示在网页上，无需再次加载页面。

当城市框出现时，如果我按 Ctrl-U 来查看页面的源代码，则**城市下拉列表**的 html 代码不在源代码页面中。

我的问题是，当我提交表单时，城市下拉列表的值**不会发送**到**submit.php**文件

**索引.php**

```
 <form action="submit.php" name="my_form" method="post"> 
```

**提交.php**

```
 echo $_POST['cities']; 
```

$_POST [ **'cities'];** 为空白。

这意味着在提交页面**中没有发送城市下拉列表的值。**

我应该怎么做才能解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:39:16.423

添加客户端和服务器端验证器。例如在客户端，如果没有选择城市，则禁用提交按钮。在服务器端，如果`isset($_POST['cities'])`为假，则不执行任何查询，只需将用户重定向到同一页面，并显示错误消息“请选择城市”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T13:46:31.657

似乎您没有正确更新 DOM，因此当您提交表单时，城市参数不可用。如果您使用 jQuery，请使用 jQuery.after() 或任何类似的函数来更新 DOM。如果不是，您必须使用选择创建一个节点并将其添加到表单中。

# c++ - 作为成员函数和非成员函数的运算符函数

> ID：10572135
> 
> 赞同：0
> 
> 时间：2012-05-13T13:28:34.137
> 
> 标签：c++

我很困惑将运算符重载为成员和非成员函数的想法。

当我们将运算符重载为非成员函数时，我们实际上是什么意思，同样，当我们将运算符重载为成员函数时，我们的意思是什么。虽然我知道非成员函数是*友*元函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:31:31.430

如果将运算符重载为非成员函数，则需要在参数列表中指定要专门对其进行操作的对象。

如果您将其作为成员函数重载，“this”指针将为您完成部分工作。

考虑以下示例：

```
class Test {
   public:
   friend Test operator+(const Test &lhs, const Test &rhs); // Non-member function
   Test operator+(const Test &rhs); // Member function
}; 
```

`this`两者之间的区别在于，当您谈论类的特定实例时， 非成员函数没有编译器方便地为您传递的指针。

成员函数 one 已推断出 lhs，因此您只需提供 rhs。

请注意，“朋友”不是必需的，但如果您想访问 Test 的私人成员，则需要它。

编译器可以根据参数计数来消除歧义。如果你想声明`friend Test operator+(const Test &rhs)`，它会抱怨参数不足，因为 + 是一个二元运算符。成员函数 operator+ 的 lhs 是 " `this`"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T13:44:07.323

例子

```
class Foo {
public:
  Foo operator+(Foo) // member variant
  // declared inside the function
}; // end of class

Foo operator+(Foo lhs, Foo rhs) // non-member variant
{ // declared outside the class
  // could be just a call to the member variant
  lhs.operator+(rhs);
  // I usually do this when implementing std::stream operators,
  // don't remember why just now.
} 
```

非成员不需要成为朋友，但如果它需要访问内部状态，则可能是。如果我没记错的话，非成员在某些编译器上的模板化代码和命名空间方面具有一些优势到这堂课。它告诉我，如果我更改该类，我可能必须检查非成员运算符以确保我没有破坏任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T13:46:43.963

大多数运营商应该被定义为成员。

```
class MyClass
{
...
public:
    const MyClass& operator+=(const MyClass&);
}; 
```

这在行为上与以下内容相同：

```
class MyClass {...};
const MyClass& operator+=(const MyClass&, const MyClass&); 
```

第一个示例中的暗示`this`类似于第二个示例的第一个参数。如果第二个示例需要访问 的内部状态`MyClass`，则需要对其进行`friend`编辑。

```
class MyClass
{
    friend const MyClass& operator+=(const MyClass&, const MyClass&);
};
const MyClass& operator+=(const MyClass&, const MyClass&); 
```

对此的典型例外是`operator<<`on `std::ostream`。

```
std::ostream& operator<<(std::ostream&, const MyClass&); 
```

这在逻辑上是您的成员`MyClass`，但由于参数的顺序，它必须是两个类的非成员或`std::ostream`. 因为您不能向 中添加成员`std::ostream`，所以必须将其定义为非成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T13:47:54.993

一个小例子：（我没有尝试编译这段代码，但我希望它能工作）

```
class MyClass
{
public:
    MyClass operator+(const MyClass& other) const; //member operator declaration

    friend MyClass operator-(const MyClass& first, const MyClass& second); //non-member operator friend declaration
private:
    int _a;
}

//member operator definition
MyClass MyClass::operator+(const MyClass& other) const
{
    MyClass result;
    result._a = _a + other._a;
    return result;
}

//non-member operator definition
MyClass MyClass::operator-(const MyClass& first, const MyClass& second)
{
    MyClass result;
    result._a = first._a - second._a;
    return result;
} 
```

请注意差异：在成员运算符定义中，我没有在“=”之后的第一个 _a 之前指定任何内容 - 假定为 this->_a。

只有当您的类的实例是运算符的第一个参数时，才能使用成员运算符函数。例如，如果您想做类似的事情`2 + myClassObject`，则需要覆盖非成员运算符`MyClass MyClass::operator+(int first, const MyClass& second)`（或使用您希望它具有的任何返回值）。

另请注意，我只需要我的非会员操作员才能访问私有`_a`字段的友谊声明。

# android - 如何从数据库中检索所有表？（安卓、SQLite）

> ID：10572144
> 
> 赞同：-2
> 
> 时间：2012-05-13T13:29:42.263
> 
> 标签：android, sqlite

> **可能重复：**
> [如何列出 SQLite 数据库文件中的表](https://stackoverflow.com/questions/82875/how-do-i-list-the-tables-in-a-sqlite-database-file)

我正在尝试制作一个简单的界面来使用 Android 设备创建一个简单的数据库。例如，将我的家庭电影收藏插入数据库的程序。也许我从一开始就错了，但这是我的尝试：

在这里，我从字段中检索数据并将它们插入到一个新表中。

```
 EditText title = (EditText)findViewById(R.id.Title); 
        String Title = title.getText().toString();

        EditText d = (EditText)findViewById(R.id.director); 
        String Director = d.getText().toString();

                SQLiteDatabase db = openOrCreateDatabase("Films", MODE_PRIVATE, null);
        db.execSQL("CREATE TABLE IF NOT EXISTS " + Title + " (Title VARCHAR, Director VARCHAR);");
        db.execSQL("INSERT INTO " + Title + "(Title) VALUES('" + Title + "');");
        db.execSQL("INSERT INTO " + Title + " (Director) VALUES('" + Director + "');");
        db.close(); 
```

因此，对于每个新标题，我都会创建一个新表。但是后来我需要所有这些表在一​​个新的活动中作为一个列表或类似的东西打印出来。但我不知道如何从数据库中获取所有表。

我找到了命令：

```
SQLiteDatabase db = openOrCreateDatabase("Films", MODE_PRIVATE, null);
Cursor c = db.rawQuery("SELECT * FROM tablename", null); 
```

但如果我知道它的名称，它只适用于一个表，我需要的是从它们中获取所有表和数据。

请问你能帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:34:40.717

使用以下命令运行查询：

```
Cursor c = db.rawQuery("SELECT * FROM films.sqlite_master WHERE type='table'",null); 
```

**编辑**

我忘了这是 Android 并且 rawQuery 已经有表名。这应该有效：

```
Cursor c = db.rawQuery("SELECT * FROM sqlite_master WHERE type='table'",null); 
```

# iphone - iPhone 应用程序的主机选项

> ID：10572147
> 
> 赞同：0
> 
> 时间：2012-05-13T13:30:14.820
> 
> 标签：iphone, cordova, app-store, host

我正在开发一个 iPhone/android 应用程序，对于 iphone one，我需要尽快托管它。我即将完成它，但在 AppStore 中发布的平均时间约为 7 天，一旦获得批准。我正在寻找任何其他主机，但我不确定它们是否可以作为 AppStore 工作，我的意思是：由每个客户下载而不通过 Cydia 或类似的东西。

有什么建议或经验吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:52:08.610

如果您有企业帐户，则可以将[Enterprise Distribution 用于内部应用程序](https://help.apple.com/iosdeployment-apps/?lang=en-us#app43ad6a6a)。但你可能不会，或者你不会问这个问题。

如果设备数量非常有限，并且您与所有潜在用户都有个人联系：

*   您可以自己将其部署在设备上。

*   您可以使用 ad-hoc beta 分发（例如，使用[TestFlight](https://testflightapp.com)很容易）。

除此之外 - 没有其他合法的选择。

如果你想在 iOS 上广泛、“普通”地分发原生应用程序，你就必须通过应用程序商店。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T17:36:03.970

除了有时间限制和设备数量限制的 beta 测试分发（Ad Hoc 和/或 testflight）之外，向拥有库存设备的普通客户无限分发 iOS 应用程序的唯一主机选项是等待应用程序发布在 Apple 的 iTunes App Store 上获得批准和托管。

# python - Wunderground API 获取每小时预测返回错误。- Python

> ID：10572150
> 
> 赞同：0
> 
> 时间：2012-05-13T13:30:21.243
> 
> 标签：python, api, wunderground

我正在尝试从 Wunderground API 获取每小时预报，但我的代码返回此错误。

> 回溯（最近一次调用）：文件“weathergraph.py”，第 10 行，在 forecast = parsed_json['hourly_forecast']['FCTTIME']['temp']['english'] 类型错误：列表索引必须是整数，不是 str

这是我的代码。

> f=urllib2.urlopen('http://api.wunderground.com/api/mykey/hourly/q/NY/New_York_City.json')
> 
> json_string = f.read()
> 
> parsed_json = json.loads(json_string)
> 
> 预测 = parsed_json['hourly_forecast']['FCTTIME']['temp']['english']
> 
> f.close()

parsed_json = [http://pastie.org/3905346](http://pastie.org/3905346)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T16:56:44.233

1) hourly_forecast 的值是字典列表，不是字典。看起来列表中大约有 36 个。

2) temp 不是 FCTTIME 的一个元素。他们处于同一水平

这不应产生错误：

```
forecast = parsed_json['hourly_forecast'][-1]['temp']['english'] 
```

看起来列表是按时间排序的，所以最后一个是最新的。检查 FCTTIME 的内容会告诉你它是否与你上次阅读的时间不同。

# canvas - 允许对象操作的 Canvas JS 库？

> ID：10572158
> 
> 赞同：1
> 
> 时间：2012-05-13T13:31:27.237
> 
> 标签：canvas, fabricjs

我正在寻找替代解决方案来构建类似 [http://kangax.github.com/fabric.js/quantity/](http://kangax.github.com/fabric.js/quantity/) 的东西，它允许对画布对象进行操作，例如旋转、移动和缩放。更重要的是，它们确实有控制点，因此对用户来说很容易。

我真的很害怕一开始就走错路，请帮忙。

谢谢

# c# - 实体关系？

> ID：10572160
> 
> 赞同：0
> 
> 时间：2012-05-13T13:31:43.167
> 
> 标签：c#, entity-framework, foreign-keys, ef-code-first, code-first

这些是我的实体：

```
public class Department
{
    public Department()
    {
        Employees = new List<Employee>();
    }

    public int ID { get; set; }
    public string Name { get; set; }

    public IList<Employee> Employees { get; set; }
}

public class Employee
{
    public int ID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int DepartmentID { get; set; }
    public Department Department { get; set; }
}

public class User
{
    public int ID { get; set; }
    public string Username { get; set; }
    public string Password { get; set; }
    public int EmployeeID { get; set; }
    public Employee Employee { get; set; }
} 
```

部门有很多员工。每个用户**只有**一名员工（一对一）。我怎样才能首先与流利的代码建立这种关系？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:46:36.963

由于您没有使用共享主键，因此您可以将其映射为“一对多”关系并忽略“多”端。

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        ...

        modelBuilder.Entity<User>()
         .HasRequired(u => u.Employee)
         .WithMany()
         .HasForeignKey(u => u.EmployeeId);

    } 
```

# sql - 如何在 PLSQL 中动态选择字段（LOOP）？

> ID：10572161
> 
> 赞同：1
> 
> 时间：2012-05-13T13:31:48.030
> 
> 标签：sql, loops, plsql, sequence

我在工作，需要按小时对特定值求和。假设一个班次是 10 个小时，我希望能够在 PLSQL 中循环并执行以下伪代码：

```
For (int i=0; i<10; i++) {
    SUM( DB.Sales) AS Hour#i
    FROM
         DB
    WHERE DB.sale_Time BETWEEN 
    DB.Shift_Start_Time + i AND
    DB.Shift_Start_Time + (i+1)
} 
```

它应该返回一个包含 11 列的表，其中一列表示轮班时间，其他每一列汇总了 10 小时轮班中一小时的销售额，每一列都以其代表的小时命名。基本上我想将它用于其他目的，因为我的工作与销售无关，其中“i”可以大到 1000，所以我正在寻找一个通用的解决方案来解决我的问题。

同样，我正在使用 PLSQL。

帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:08:05.233

您可以使用 Oracle 中的分析函数来执行此操作。首先，我按小时汇总销售数据，因为这似乎是您想要的单位，然后使用带有窗口子句的分析函数总结小时数：

```
select db.shift_start_time,
       sum(db.sales) over (partition by null order by db.sale_time
                           range between current_row and <i> following)
from (select trunc(shift_start_time*24)/24 as thehour, sum(sales) as sales
      from DB
      group by trunc(shift_start_time*24)/24
     ) db 
```

请注意，这假设每小时都有销售。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T13:48:30.607

您可以使用光标来执行此操作，循环遍历每个元素。关键是按您感兴趣的时间分组。

```
BEGIN
    FOR x IN (
        SELECT TRUNC( DB.sale_Time, 'HH' ) AS start_time, 
               SUM( db.sales ) INTO mysum
          FROM db
         GROUP BY TRUNC( DB.sale_Time, 'HH' )
    ) LOOP

        /* Do loop stuff here */

    END LOOP;
END; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T07:33:21.487

我最终放弃了我最初的要求，并找到了一种很好且简单的方法来循环使用：

SELECT
db.shift_start_time, T1.n AS Hour, SUM(db.sales) A​​S Hourly_Sales FROM db, (SELECT n FROM (SELECT rownum n FROM DUAL CONNECT BY LEVEL <=10) WHERE n > 0) T1 WHERE db.sale_time BETWEEN db.shift_start_time+(T1.n - 1)/24 AND db.shift_start_time + (T1.n)/24 GROUP BY db.shift_start_time, T1.n
ORDER BY db.shift_start_time, T1.n

它还解决了我的时间不四舍五入的问题。如果班次从 9:45 开始，它将按预期工作，而不是四舍五入到 9 或 10。

我对这个解决方案的唯一问题是每个小时都有一个单独的行。尽管如此，它仍然是最好的解决方案。

# c# - 当父表单更改其当前项目时，如何阻止数据绑定子表单更改其当前项目？

> ID：10572162
> 
> 赞同：1
> 
> 时间：2012-05-13T13:31:57.393
> 
> 标签：c#, winforms, data-binding, bindingsource

我有一个包含“客户”表和“预订”表的数据集。两者之间建立了一个 DataRelation，“ClientsBookings”。

我已将 Clients 表绑定到父窗体中的 DataGridView。双击一行时，将为所选客户打开一个新的子表单，其中显示客户详细信息及其相关预订。

目前，每个新表单似乎都绑定到父表单中的当前项目。因此，当父表中的行发生变化时，每个打开的子表单中的当前项也会发生变化。我认为在子表单中创建一个新的 BindingSource 并设置它的位置会使其当前项目独立于父表单的绑定源（它不起作用）。

目前，我使用“ClientsBookings”关系在子表单中将两个 BindingSource 链接在一起。这确保只有与当前客户相关的预订才会显示在子表单中。如果我改为传入 DataRow 或类似的东西，我无法弄清楚如何获得同样的效果。

无论如何，这是到目前为止的代码：

**父表格：**

```
public partial class ClientsSearchForm : Form
{
    BindingSource bsClients = new BindingSource();

    private void ClientsSearchForm_Load(object sender, EventArgs e)
    {
        DataSet clientsDataSet = GetDataSet();
        bsClients.DataSource = myDataSet;
        bsClients.DataMember = "Clients";
        dataGridView1.DataSource = bsClients;

        this.dataGridView1.CellDoubleClick += new System.Windows.Forms.DataGridViewCellEventHandler(this.dataGridView1_CellDoubleClick);
    }

    private void dataGridView1_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
    {
        ClientForm form = new ClientForm(bsClients);
        form.Show();
    }

} 
```

**子表：**

```
public partial class ClientForm : Form
{
private BindingSource bsClients = new BindingSource();
private BindingSource bsBookings = new BindingSource();

public ClientForm()
{
    InitializeComponent();
}

public ClientForm(BindingSource bsClients)
{
    private BindingSource bsClients = new BindingSource();
    private BindingSource bsBookings = new BindingSource();

    public ClientForm(BindingSource bs)
    {
        InitializeComponent();

        // set up client binding source
        // Note: intent is to have this form associated with only one client
        // and not change when the selection on the search forlm changes.
        this.bsClients.DataSource = bs.DataSource;
        this.bsClients.DataMember = bs.DataMember;
        this.bsClients.Position = bs.Position;

        // set up bookings binding source
        this.bsBookings.DataSource = this.bsClients;
        this.bsBookings.DataMember = "ClientsBookings";

        // set up control bindings
        textBox1.DataBindings.Add("Text", bsClients, "Given Name");
        dataGridView1.DataSource = bsBookings;
    }
} 
```

# php - sql联合查询无法获取

> ID：10572167
> 
> 赞同：0
> 
> 时间：2012-05-13T13:32:26.383
> 
> 标签：php, sql, union

这可能是因为查询没有正确执行。它看起来像这样：

```
SELECT a_email AS email FROM Table_a 
UNION 
SELECT b_email AS email FROM Table_b 
```

两个带有电子邮件的表，不同的列名。由于重复的电子邮件，我希望它选择不同的。可以`UNION`如上构造吗？如果不是，如何以另一种方式获得效果？

当我以另一种方式查询此数据库时，问题已解决，是什么带来了更丰富的错误消息。这是

```
Illegal mix of collations 
```

解决方案是匹配每个表中这两个列的两种排序规则。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T13:37:39.680

您查询的语法似乎没问题。

如果这导致您出现问题，则可能是数据类型与注释等效。

尝试将两者都转换为相同的数据类型并重试

# c# - 大网站根本没有加载 - 错误

> ID：10572169
> 
> 赞同：1
> 
> 时间：2012-05-13T13:32:41.963
> 
> 标签：c#, windows-phone-7

我已经为 Windows Phone 7 创建了一个网络浏览器。在那里，我还保存了浏览历史记录以及该页面的标题。但是由于这些代码，当我尝试加载像 thinkdigit 等有点大的网站时。没有加载。同时，如果我删除该特定代码，则历史页面中不会记录任何历史。它显示以下**突出显示的代码**的错误- **“发生未知错误。错误：80020006”**。我认为这是由于网站大，否则我需要放几毫秒还是我必须做什么？？？提前感谢您的辛勤工作！！！

以下是我使用的代码-

```
private void browsers_Navigated(object sender,System.Windows.Navigation.NavigationEventArgs e)      
{
    pbarWebClient.Visibility = System.Windows.Visibility.Collapsed; 
    if (!fromHistory)
    {
        if (HistoryStack_Index < HistoryStack.Count)
        {
           HistoryStack.RemoveRange(HistoryStack_Index, HistoryStack.Count - HistoryStack_Index);
        }

        HistoryStack.Add(e.Uri);

        if (!app.incognito)
        {
            ********string title = (string)browsers[this.currentIndex].InvokeScript("eval", "document.title.toString()");********----->This is the error.
            stream.WriteLine(title + ";" + e.Uri.ToString());
        }

        HistoryStack_Index += 1;
    }
    fromHistory = false;
    navigationcancelled = false;
    Stop.Visibility = Visibility.Collapsed;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T08:51:31.337

我希望`eval`在相关站点上已被覆盖或以其他方式压制。

“80020006”是一个javascript调用错误代码。简单地假设 javascript 方法将可用并且在任何站点上以相同的方式工作并不总是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T07:48:33.040

最后我得到了适合我自己问题的答案。只需用这个替换上面的代码 -

```
 if (!app.incognito)
            {
                Thread.Sleep(100);
                Dispatcher.BeginInvoke(() =>
                {
                    string title = (string)browsers[this.currentIndex].InvokeScript("eval", "document.title.toString()");
                    stream.WriteLine(title + ";" + e.Uri.ToString());
                });
            } 
```

# iphone - 如何将核心数据导出到 CSV

> ID：10572172
> 
> 赞同：6
> 
> 时间：2012-05-13T13:33:45.103
> 
> 标签：iphone, ios, xcode, core-data, export-to-csv

我想用来`CHCSVParser`将我的核心数据导出到 CSV。我知道如何从实体中获取所有值，但我不知道如何写入 CSV。

有人可以教我如何用 CSV 写入`CHCSVParser`吗？

```
// Test listing all Infos from the store
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription 
                               entityForName:@"NoteLog" inManagedObjectContext:context];
[fetchRequest setEntity:entity];

NSArray *fetchedObjects = [context executeFetchRequest:fetchRequest error:&error];
for (NoteLog *noteInfo in fetchedObjects) {

    NSLog(@"Name: %@", noteInfo.city );
    NSLog(@"Name: %@", noteInfo.country);
    NSLog(@"Name: %@", noteInfo.datetime);
    NSLog(@"Name: %@", noteInfo.notelatitude);
    NSLog(@"Name: %@", noteInfo.notelongtitude);
    NSLog(@"Name: %@", noteInfo.state);
    NSLog(@"Name: %@", noteInfo.text);        
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-13T13:59:23.083

A`CHCSVWriter`有几种构造 CSV 文件的方法：

`-writeField:`接受一个对象并将其 -description（在正确转义后）写入 CSV 文件。如有必要，它还将写入字段分隔符 (,)。您可以传递一个空字符串 (@"") 或 nil 来写入一个空字段。

`-writeFields:`接受一个以逗号分隔和以 nil 结尾的对象列表，并将每个对象发送到 -writeField:。

`-writeLine`用于终止当前的 CSV 行。如果您不调用 -writeLine，那么您的所有 CSV 字段都将位于一行。

`-writeLineOfFields:`接受一个以逗号分隔和以 nil 结尾的对象列表，将每个对象发送到 -writeField:，然后调用 -writeLine。

`-writeLineWithFields:`接受一个对象数组，将每个对象发送到 -writeField:，然后调用 -writeLine。

`-writeCommentLine:`接受一个字符串并将其作为 CSV 样式的注释写入文件。

除了写入文件之外，`CHCSVWriter`还可以初始化直接写入`NSString`.

像这样的东西应该适合你。

```
CHCSVWriter *writer = [[CHCSVWriter alloc] initForWritingToString];

for (NoteLog *noteInfo in fetchedObjects) {

    [writer writeLineOfFields:noteInfo.city, noteInfo.country, noteInfo.datetime, noteInfo.notelatitude, noteInfo.notelongtitude, noteInfo.state, noteInfo.text, nil];     
}  

NSLog(@"My CSV File: %@",writer.stringValue); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-26T22:15:10.723

上面的答案似乎已被弃用，作者似乎用另一种方法替换了该方法。这对我有用，希望它有帮助：

```
NSOutputStream *stream = [[NSOutputStream alloc] initToMemory];
CHCSVWriter *writer = [[CHCSVWriter alloc] initWithOutputStream:stream encoding:NSUTF8StringEncoding delimiter:','];

for (Type *instance in fetchedResults) {
    [writer writeLineOfFields:@[instance.propertyA, instance.B]];
}
[writer closeStream];

NSData *buffer = [stream propertyForKey:NSStreamDataWrittenToMemoryStreamKey];
NSString *output = [[NSString alloc] initWithData:buffer encoding:NSUTF8StringEncoding]; 
```

# android - 无法下载安卓源

> ID：10572176
> 
> 赞同：0
> 
> 时间：2012-05-13T13:34:11.970
> 
> 标签：android, osx-lion

我正在使用 mac 系统，同时我为下载 android 源进行 repo 同步。我在两者之间得到了这个错误。我能做些什么来解决这个问题？

```
From /Users/ArunAbraham/ANDROID_DIRECTORY/.repo/projects/docs/source.android.com.git/clone.bundle
 * [new branch]      master     -> aosp/master
Downloading device/ti/panda:  68% (17MB/25MB)  error: Couldn't resolve host 'android.googlesource.com' while accessing https://android.googlesource.com/platform/external/android-mock/info/refs
fatal: HTTP request failed
Downloading device/ti/panda:  76% (19MB/25MB)  error: Couldn't resolve host 'android.googlesource.com' while accessing https://android.googlesource.com/platform/docs/source.android.com/info/refs
fatal: HTTP request failed
Downloading device/ti/panda:  80% (20MB/25MB)  error: Couldn't resolve host 'android.googlesource.com' while accessing https://android.googlesource.com/platform/external/android-mock/info/refs
fatal: HTTP request failed
Downloading device/ti/panda:  88% (22MB/25MB)  error: Cannot fetch platform/external/android-mock 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:08:09.670

我必须在[http://source.android.com/source/downloading.html](http://source.android.com/source/downloading.html)中执行 Using Authentication 部分。

# android - 在 Google+ Hangout API 中处理音频数据

> ID：10572178
> 
> 赞同：3
> 
> 时间：2012-05-13T13:34:31.867
> 
> 标签：android, audio, google-plus

是否可以使用 google+ hangout api 拦截音频数据？我使用 g+ hangout for android 编写了一个应用程序，我想处理音频。为了进动，我想对语音进行降噪并使用语音转文本（例如谷歌搜索、狮身人面像）来制作基本的语音命令。

因为我完全控制了 android 应用程序，所以对于我来说，我是否会使用来自视频群聊的音频数据进行回调，或者我可以使用 android 录制音频`AudioRecorder`然后以某种方式将这些数据转发到谷歌视频群聊（尽管后一种解决方案是更好，因为我们可以在安卓设备上去噪）。实际上，我会对在 API 的这个阶段可行的任何可行的解决方法感到满意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:49:27.503

[Hangouts API](http://developers.google.com/+/hangouts)不会帮助您开发此功能。

您需要的是一个与平台无关的 API，用于访问环聊数据。相反，该 API 旨在解决不同的问题。它允许您编写在桌面网络浏览器上运行的环聊画布内运行的 HTML/JavaScript 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T23:50:45.723

我自己目前正在调查的一种可能的“解决方法”——</p>

*   发布环聊“直播”
*   获取 youtube live id（自 2012 年 8 月 22 日起可用，大致......自 Hangout API 1.2 起）~ `gapi.hangout.onair.getYouTubeLiveId()` [https://developers.google.com/+/hangouts/api/gapi.hangout.onair#gapi.hangout .onair.getYouTubeLiveId](https://developers.google.com/+/hangouts/api/gapi.hangout.onair#gapi.hangout.onair.getYouTubeLiveId)（注意这个只能被主播抢？）
*   抓取`http://www.youtube.com/watch?v=${LIVEID}`// 建议：查看 youtube-dl：[http ://rg3.github.com/youtube-dl/documentation.html](http://rg3.github.com/youtube-dl/documentation.html)
*   然后使用ffmpeg处理flv

此答案的信息主要来自[从 youtube 下载 flv 格式的视频。](https://stackoverflow.com/questions/4287748/downloading-videos-in-flv-format-from-youtube)和[http://grokbase.com/t/gg/google-plus-developers/128fbteedb/google-hangout-api-url-to-youtube-stream-screenshot-and-hangout-topic](http://grokbase.com/t/gg/google-plus-developers/128fbteedb/google-hangout-api-url-to-youtube-stream-screenshot-and-hangout-topic)

# android - 没有这样的表例外

> ID：10572187
> 
> 赞同：1
> 
> 时间：2012-05-13T13:35:15.370
> 
> 标签：android, database, sqlite

我在访问数据库时遇到问题。有趣的是它曾经运行良好，但最近它开始显示 SQLiteException “没有这样的表”。每次我启动应用程序时都不会发生这种情况，只是偶尔会发生，而且我看不到任何导致问题的特定设置。它总是与同一个类 RunForm 中的同一个表 form_data 相关。我在 adb 中检查了该表和数据库确实存在。这是我的 createDB 类公共类 createDB{

```
private static final String DATABASE_NAME = "mydatabase.db";
private static final String DB_PATH = "/data/data/com.mypackage/databases/";
private static final int DATABASE_VERSION = 2;

private OpenHelper openHelper;

private Context context;
private SQLiteDatabase db;

public createDB(Context ctx){
    try{
        this.context = ctx;

        openHelper = new OpenHelper(context);

        this.db = openHelper.getWritableDatabase();         
    }
    catch (IllegalStateException e){
        Log.e("ILLEGALstateEXC","CAUGHT");
    }   

}

public SQLiteDatabase openDataBase(){

    //Open the database
    String myPath = DB_PATH + DATABASE_NAME;
    try{
        db = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.CREATE_IF_NECESSARY);

    }catch(Exception e){
        Log.e("Opening database", e.toString());
    }

    return db;
}

public boolean checkDataBase(){      
    SQLiteDatabase checkDB = null; 
    try{
        String myPath = DB_PATH + DATABASE_NAME;
        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);           
    }catch(SQLiteException e){
        //database does't exist yet.
        checkDB = null;
    }
    if(checkDB != null){
        checkDB.close(); 
    }
    return checkDB != null ? true : false;
}

public void close() 
{
     openHelper.close();
}

private static class OpenHelper extends SQLiteOpenHelper {
    OpenHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

    }
} 
```

除此之外，我还创建了两个类（dataDB 和 structureDB），它们包含对数据库特定表的操作（包括创建表）。它们基本上是相同的，所以我只展示了一个对导致问题的 form_data 表执行操作的。

```
public class dataDB{
private SQLiteDatabase db;
private structureDB structure_db;

private String TABLE_DATA = "form_data";
private String[] TABLE_DATA_FIELDS = {"id", "attr_id", "entity_id", "attr_value", "instance_number", "plot_number"};

private String TABLE_EXTRAS = "form_extras";
private String[] TABLE_EXTRAS_FIELDS = {"id", "name", "value", "instance_number", "plot_number"};

private String TABLE_VERSION = "form_version";
private String[] TABLE_VERSION_FIELDS = {"id", "name"};

public dataDB(SQLiteDatabase database){
    Log.e("DATA_DB","CONSTRUCTOR");
    this.db = dynamicTabs.db;//database;
    structure_db = new structureDB(this.db);
    this.createDataTables();
}

public void createDataTables(){
    db.execSQL(
            "create table if not exists " + TABLE_DATA + 
            " (" + TABLE_DATA_FIELDS[0] + " integer primary key autoincrement, "
            + TABLE_DATA_FIELDS[1] + " integer, "
            + TABLE_DATA_FIELDS[2] + " integer, "
            + TABLE_DATA_FIELDS[3] + " text, "
            + TABLE_DATA_FIELDS[4] + " integer, "
            + TABLE_DATA_FIELDS[5] + " integer "
            + ");"    );

    db.execSQL(
            "create table if not exists " + TABLE_EXTRAS + 
            " (" + TABLE_EXTRAS_FIELDS[0] + " integer primary key autoincrement, "
            + TABLE_EXTRAS_FIELDS[1] + " text, "
            + TABLE_EXTRAS_FIELDS[2] + " text, "
            + TABLE_EXTRAS_FIELDS[3] + " integer, "
            + TABLE_EXTRAS_FIELDS[4] + " integer "
            + ");"    );

    db.execSQL(
            "create table if not exists " + TABLE_VERSION + 
            " (" + TABLE_VERSION_FIELDS[0] + " integer primary key autoincrement, "
            + TABLE_VERSION_FIELDS[1] + " text "
            + ");"    );
}

public void recreateDataTables(){
    db.execSQL("drop table if exists " + TABLE_DATA);
    db.execSQL("drop table if exists " + TABLE_EXTRAS);
    db.execSQL("drop table if exists " + TABLE_VERSION);
    this.createDataTables();
}

public void saveVersion (String name){
    ContentValues initialValues = new ContentValues();
    initialValues.put(TABLE_VERSION_FIELDS[1], name);
    this.insertQuery(TABLE_VERSION, initialValues);
}

public String getVersionName(){
    String versionName = "";
    Cursor mCursor;
    mCursor = db.rawQuery("select * from " + TABLE_VERSION, null);
    if (mCursor.moveToFirst()){
        versionName = mCursor.getString(1);
    }   
    mCursor.close();
    return versionName;
}

public void saveExtraItem(String name, String value, int plotNo, int instanceNo){
    ContentValues initialValues = new ContentValues();
    initialValues.put(TABLE_EXTRAS_FIELDS[2], value);               
    if (this.itemExists(name, plotNo, instanceNo))
    {
        String condition = "" + TABLE_EXTRAS_FIELDS[4] + "='" + plotNo + "'"
        + " and " + TABLE_EXTRAS_FIELDS[1] + "='" + name + "'"
        + " and " + TABLE_EXTRAS_FIELDS[3] + "='" + instanceNo + "'";
        this.updateQuery(TABLE_EXTRAS, initialValues, condition);
    }
    else{
        initialValues.put(TABLE_EXTRAS_FIELDS[1], name);
        initialValues.put(TABLE_EXTRAS_FIELDS[3], instanceNo);
        initialValues.put(TABLE_EXTRAS_FIELDS[4], plotNo);          
        this.insertQuery(TABLE_EXTRAS, initialValues);
    }
}

public String getExtraItem(String name, int plotNo, int instanceNo){
    String itemValue = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_EXTRAS + 
            " where " + TABLE_EXTRAS_FIELDS[1] + "='" + name + "'" +
            " and " + TABLE_EXTRAS_FIELDS[3] + "='" + instanceNo + "'" +
            " and " + TABLE_EXTRAS_FIELDS[4] + "='" + plotNo + "'", null);
    if (mCursor.moveToFirst()){
        itemValue = mCursor.getString(mCursor.getColumnIndex(TABLE_EXTRAS_FIELDS[2]));
    }
    mCursor.close();
    return itemValue;
}   
public void cleanExtras(){
    db.execSQL("drop table if exists " + TABLE_EXTRAS);
    db.execSQL(
            "create table if not exists " + TABLE_EXTRAS + 
            " (" + TABLE_EXTRAS_FIELDS[0] + " integer primary key autoincrement, "
            + TABLE_EXTRAS_FIELDS[1] + " text, "
            + TABLE_EXTRAS_FIELDS[2] + " text, "
            + TABLE_EXTRAS_FIELDS[3] + " integer, "
            + TABLE_EXTRAS_FIELDS[4] + " integer "
            + ");"    );
}

public void saveItem(int structureIndex, int entityIndex, String value, int plotNo, int instanceNo){
    ContentValues initialValues = new ContentValues();
    initialValues.put(TABLE_DATA_FIELDS[3], value);             
    if (this.itemExists(structureIndex, plotNo, instanceNo))
    {
        String condition = "" + TABLE_DATA_FIELDS[5] + "='" + plotNo + "'"
        + " and " + TABLE_DATA_FIELDS[1] + "='" + structureIndex + "'"
        + " and " + TABLE_DATA_FIELDS[4] + "='" + instanceNo + "'";
        this.updateQuery(TABLE_DATA, initialValues, condition);
    }
    else{
        initialValues.put(TABLE_DATA_FIELDS[1], String.valueOf(structureIndex));
        initialValues.put(TABLE_DATA_FIELDS[2], entityIndex);
        initialValues.put(TABLE_DATA_FIELDS[4], instanceNo);
        initialValues.put(TABLE_DATA_FIELDS[5], plotNo);            
        this.insertQuery(TABLE_DATA, initialValues);
    }
}

public String loadItem(int structureIndex, int plotNo, int instanceNo){
    String itemValue = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + 
            " where " + TABLE_DATA_FIELDS[1] + "='" + structureIndex + "'" +
            " and " + TABLE_DATA_FIELDS[4] + "='" + instanceNo + "'" +
            " and " + TABLE_DATA_FIELDS[5] + "='" + plotNo + "'", null);
    if (mCursor.moveToFirst()){
        itemValue = mCursor.getString(mCursor.getColumnIndex(TABLE_DATA_FIELDS[3]));
    }
    mCursor.close();
    return itemValue;
}

public boolean itemExists(int structureIndex, int plotNo, int instanceNo){
    boolean exists = false;
    Cursor mCursor =  db.rawQuery("select count(*) from " + TABLE_DATA + 
            " where " + TABLE_DATA_FIELDS[5] + "='" + plotNo + "'"
            + " and " + TABLE_DATA_FIELDS[1] + "='" + structureIndex + "'"
            + " and " + TABLE_DATA_FIELDS[4] + "='" + instanceNo + "'", null);
    if (mCursor.moveToFirst()){
        exists = (mCursor.getInt(0)>0)?true:false;
    }
    mCursor.close();
    return exists;
}

public boolean itemExists(String name, int plotNo, int instanceNo){
    boolean exists = false;
    Cursor mCursor =  db.rawQuery("select count(*) from " + TABLE_EXTRAS + 
            " where " + TABLE_EXTRAS_FIELDS[4] + "='" + plotNo + "'"
            + " and " + TABLE_EXTRAS_FIELDS[1] + "='" + name + "'"
            + " and " + TABLE_EXTRAS_FIELDS[3] + "='" + instanceNo + "'", null);
    if (mCursor.moveToFirst()){
        exists = (mCursor.getInt(0)>0)?true:false;
    }
    mCursor.close();
    return exists;
}

private String getItemParent(int itemIndex){
    String itemName = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + " where " + TABLE_DATA_FIELDS[0] + "='" + itemIndex + "'", null);
    if (mCursor.moveToFirst()){
        itemName = structure_db.getFieldParent(mCursor.getInt(1));
    }
    mCursor.close();
    return itemName;
}   
public String getItemValue(int itemIndex){
    String itemValue = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + " where " + TABLE_DATA_FIELDS[0] + "='" + itemIndex + "'", null);
    if (mCursor.moveToFirst()){
        itemValue = mCursor.getString(3);
    }
    mCursor.close();
    return itemValue;

}

public String getItemType(int itemIndex){
    String itemType = "";
    int attributeID = -1;
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + " where " + TABLE_DATA_FIELDS[0] + "='" + itemIndex + "'", null);
    if (mCursor.moveToFirst()){
        try{
            attributeID = mCursor.getInt(1);
            itemType = structure_db.getFieldType(attributeID);
        }catch (Exception e){

        }           
    }
    mCursor.close();
    return itemType;
}

public String getItemInstanceValue(int itemIndex, int instanceNo, int plotNo){
    String itemValue = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA 
            + " where " + TABLE_DATA_FIELDS[1] + "='" + itemIndex + "'"
            + " and " + TABLE_DATA_FIELDS[4] + "='" + instanceNo + "'"
            + " and " + TABLE_DATA_FIELDS[5] + "='" + plotNo + "'", null);
    if (mCursor.moveToFirst()){
        itemValue = mCursor.getString(3);
    }
    mCursor.close();
    //Log.e("index"+itemIndex+"instance"+instanceNo, "plotNO"+plotNo+"value=="+itemValue+"===");
    return itemValue;
}

private String getItemPath(int itemIndex){
    String itemPath = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + " where " + TABLE_DATA_FIELDS[0] + "='" + itemIndex + "'", null);
    if (mCursor.moveToFirst()){
        itemPath = structure_db.getFieldPath(mCursor.getInt(1));
    }
    mCursor.close();
    return itemPath;
}

private String getItemPlot(int itemIndex){
    String itemPlot = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + " where " + TABLE_DATA_FIELDS[0] + "='" + itemIndex + "'", null);
    if (mCursor.moveToFirst()){
        itemPlot = mCursor.getString(5);
    }
    mCursor.close();
    return itemPlot;        
}

public String getItemInstanceNumber(int itemIndex){
    String itemInstanceNumber = "";
    Cursor mCursor =  db.rawQuery("select * from " + TABLE_DATA + " where " + TABLE_DATA_FIELDS[0] + "='" + itemIndex + "'", null);
    if (mCursor.moveToFirst()){
        itemInstanceNumber = mCursor.getString(4);
    }
    mCursor.close();
    return itemInstanceNumber;
}

public int getNumberOfInstances(int structureIndex, int plotNo){
    int instanceNumber = -1;
    Cursor mCursor =  db.rawQuery("select count(*) from " + TABLE_DATA              
            + " where " + TABLE_DATA_FIELDS[1] + "='" + structureIndex + "'"
            + " and " + TABLE_DATA_FIELDS[5] + "='" + plotNo + "'", null);      
    if (mCursor.moveToFirst()){
        instanceNumber = mCursor.getInt(0);
    }
    mCursor.close();
    return instanceNumber;
}

public String[] getItemData(int itemIndex){
    Cursor mCursor =  db.rawQuery("select id, attr_id from " + TABLE_DATA, null);
    if (mCursor.moveToFirst())
        for (int i=1;i<itemIndex;i++){
            mCursor.moveToNext();
        }
    itemIndex = mCursor.getInt(0);

    String[] itemData = new String[9];
    itemData[0] = this.getItemName(itemIndex);
    itemData[1] = this.getItemParent(itemIndex);
    itemData[2] = this.getItemGrandparent(itemIndex);
    itemData[3] = this.getItemValue(itemIndex);
    itemData[4] = this.getItemPath(itemIndex);
    itemData[5] = this.getItemPlot(itemIndex);
    itemData[6] = this.getItemInstanceNumber(itemIndex);
    itemData[7] = this.getItemType(itemIndex);
    itemData[8] = String.valueOf(mCursor.getInt(1));
    mCursor.close();
    return itemData;
}   
public void removePlotData(int plotNo){
    int maxPlotNumber = 0;
    db.delete(TABLE_DATA, TABLE_DATA_FIELDS[5]+"="+plotNo, null);
    Cursor mCursor =  db.rawQuery("select max("+TABLE_DATA_FIELDS[5]+") from " + TABLE_DATA, null);
    if (mCursor.moveToFirst()){
        maxPlotNumber = mCursor.getInt(0);
    }
    mCursor.close();
    ContentValues plotNumberValue;          
    for (int i=plotNo+1;i<=maxPlotNumber;i++){
        plotNumberValue = new ContentValues();
        plotNumberValue.put(TABLE_DATA_FIELDS[5],i-1);
        db.update(TABLE_DATA, plotNumberValue, TABLE_DATA_FIELDS[5] + "=" + i, null);           
    }       
}

private long insertQuery(String table, ContentValues values){
    return db.insert(table, null, values);
}

private long updateQuery(String table, ContentValues values, String whereClause){
    return db.update(table, values, whereClause, null);
}
} 
```

然后我在跨应用程序的活动中使用它，如下所示：

```
createDB database = new createDB(this);
db = database.openDataBase();
dataDB data_db = new dataDB(db); 
```

当我在 onCreate 方法中执行以下活动之一时显示错误

```
protected void onCreate(Bundle savedInstanceState) {
...
createDB database = new createDB(this);
db = database.openDataBase();
structureDB structure_db = new structureDB(db);
dataDB data_db = new dataDB(db);
Intent i = new Intent(dynamicTabs.this,RunForm.class);
...
} 
```

并在 RunForm 活动的 onCreate 中

```
protected void onCreate(Bundle savedInstanceState) {
...
createDB database = new createDB(this);
db = database.openDataBase();
structureDB structure_db = new structureDB(db);
dataDB data_db = new dataDB(db);
this.structure_db.getFieldLabel(fieldID)
this.data_db.getItemInstanceValue(fieldID, 0, this.formPlotNo);
...
} 
```

当我尝试从 form_data 表中选择值时，错误出现在代码的最后一行。使用 structureDB 类的早期查询工作正常。Logcat 显示如下：

```
 05-13 18:19:49.047: I/dAWF(20223): dynamicTabs:onCreate
05-13 18:19:49.566: D/dalvikvm(20223): GC freed 13081 objects / 937960 bytes in 69ms
05-13 18:19:49.566: I/dalvikvm(20223): Uncaught exception thrown by finalizer (will be discarded):
05-13 18:19:49.566: I/dalvikvm(20223): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44eafea8 on null that has not been deactivated or closed
05-13 18:19:49.566: I/dalvikvm(20223):  at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
05-13 18:19:49.566: I/dalvikvm(20223):  at dalvik.system.NativeStart.run(Native Method)
05-13 18:19:49.576: I/dalvikvm(20223): Uncaught exception thrown by finalizer (will be discarded):
05-13 18:19:49.576: I/dalvikvm(20223): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44efb6b8 on null that has not been deactivated or closed
05-13 18:19:49.586: I/dalvikvm(20223):  at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
05-13 18:19:49.586: I/dalvikvm(20223):  at dalvik.system.NativeStart.run(Native Method)
05-13 18:19:49.626: E/Database(20223): Leak found
05-13 18:19:49.626: E/Database(20223): java.lang.IllegalStateException: /data/data/com.mypackage/databases/mydatabase.db SQLiteDatabase created and never closed
05-13 18:19:49.626: E/Database(20223):  at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1695)
05-13 18:19:49.626: E/Database(20223):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:739)
05-13 18:19:49.626: E/Database(20223):  at com.mypackage.ddatabase.createDB.openDataBase(createDB.java:45)
05-13 18:19:49.626: E/Database(20223):  at com.mypackage.dform.RunForm.onCreate(RunForm.java:70)
05-13 18:19:49.626: E/Database(20223):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.startActivityNow(ActivityThread.java:2335)
05-13 18:19:49.626: E/Database(20223):  at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
05-13 18:19:49.626: E/Database(20223):  at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
05-13 18:19:49.626: E/Database(20223):  at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:648)
05-13 18:19:49.626: E/Database(20223):  at android.widget.TabHost.setCurrentTab(TabHost.java:320)
05-13 18:19:49.626: E/Database(20223):  at android.widget.TabHost.addTab(TabHost.java:213)
05-13 18:19:49.626: E/Database(20223):  at com.mypackage.dawf.plotDynamicTabs.onCreate(plotDynamicTabs.java:108)
05-13 18:19:49.626: E/Database(20223):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.startActivityNow(ActivityThread.java:2335)
05-13 18:19:49.626: E/Database(20223):  at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
05-13 18:19:49.626: E/Database(20223):  at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
05-13 18:19:49.626: E/Database(20223):  at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:648)
05-13 18:19:49.626: E/Database(20223):  at android.widget.TabHost.setCurrentTab(TabHost.java:320)
05-13 18:19:49.626: E/Database(20223):  at android.widget.TabHost.addTab(TabHost.java:213)
05-13 18:19:49.626: E/Database(20223):  at com.mypackage.dawf.dynamicTabs.onCreate(dynamicTabs.java:157)
05-13 18:19:49.626: E/Database(20223):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
05-13 18:19:49.626: E/Database(20223):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-13 18:19:49.626: E/Database(20223):  at android.os.Looper.loop(Looper.java:123)
05-13 18:19:49.626: E/Database(20223):  at android.app.ActivityThread.main(ActivityThread.java:4363)
05-13 18:19:49.626: E/Database(20223):  at java.lang.reflect.Method.invokeNative(Native Method)
05-13 18:19:49.626: E/Database(20223):  at java.lang.reflect.Method.invoke(Method.java:521)
05-13 18:19:49.626: E/Database(20223):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
05-13 18:19:49.626: E/Database(20223):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
05-13 18:19:49.626: E/Database(20223):  at dalvik.system.NativeStart.main(Native Method)
05-13 18:19:49.686: E/Database(20223): Leak found
05-13 18:19:49.686: E/Database(20223): java.lang.IllegalStateException: /data/data/com.mypackage.dynamicAWF/databases/mydatabase.db SQLiteDatabase created and never closed
05-13 18:19:49.686: E/Database(20223):  at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1695)
05-13 18:19:49.686: E/Database(20223):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:739)
05-13 18:19:49.686: E/Database(20223):  at com.mypackage.ddatabase.createDB.openDataBase(createDB.java:45)
05-13 18:19:49.686: E/Database(20223):  at com.mypackage.dawf.plotDynamicTabs.onCreate(plotDynamicTabs.java:80)
05-13 18:19:49.686: E/Database(20223):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread.startActivityNow(ActivityThread.java:2335)
05-13 18:19:49.686: E/Database(20223):  at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
05-13 18:19:49.686: E/Database(20223):  at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
05-13 18:19:49.686: E/Database(20223):  at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:648)
05-13 18:19:49.686: E/Database(20223):  at android.widget.TabHost.setCurrentTab(TabHost.java:320)
05-13 18:19:49.686: E/Database(20223):  at android.widget.TabHost.addTab(TabHost.java:213)
05-13 18:19:49.686: E/Database(20223):  at com.mypackage.dawf.dynamicTabs.onCreate(dynamicTabs.java:157)
05-13 18:19:49.686: E/Database(20223):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
05-13 18:19:49.686: E/Database(20223):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-13 18:19:49.686: E/Database(20223):  at android.os.Looper.loop(Looper.java:123)
05-13 18:19:49.686: E/Database(20223):  at android.app.ActivityThread.main(ActivityThread.java:4363)
05-13 18:19:49.686: E/Database(20223):  at java.lang.reflect.Method.invokeNative(Native Method)
05-13 18:19:49.686: E/Database(20223):  at java.lang.reflect.Method.invoke(Method.java:521)
05-13 18:19:49.686: E/Database(20223):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
05-13 18:19:49.686: E/Database(20223):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
05-13 18:19:49.686: E/Database(20223):  at dalvik.system.NativeStart.main(Native Method)
05-13 18:19:49.717: E/Database(20223): Leak found
05-13 18:19:49.717: E/Database(20223): java.lang.IllegalStateException: /data/data/com.mypackage.dynamicAWF/databases/mydatabase.db SQLiteDatabase created and never closed
05-13 18:19:49.717: E/Database(20223):  at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1695)
05-13 18:19:49.717: E/Database(20223):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:739)
05-13 18:19:49.717: E/Database(20223):  at com.mypackage.ddatabase.createDB.openDataBase(createDB.java:45)
05-13 18:19:49.717: E/Database(20223):  at com.mypackage.dawf.dynamicTabs.onCreate(dynamicTabs.java:100)
05-13 18:19:49.717: E/Database(20223):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 18:19:49.717: E/Database(20223):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
05-13 18:19:49.717: E/Database(20223):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
05-13 18:19:49.717: E/Database(20223):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
05-13 18:19:49.717: E/Database(20223):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
05-13 18:19:49.717: E/Database(20223):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-13 18:19:49.717: E/Database(20223):  at android.os.Looper.loop(Looper.java:123)
05-13 18:19:49.717: E/Database(20223):  at android.app.ActivityThread.main(ActivityThread.java:4363)
05-13 18:19:49.717: E/Database(20223):  at java.lang.reflect.Method.invokeNative(Native Method)
05-13 18:19:49.717: E/Database(20223):  at java.lang.reflect.Method.invoke(Method.java:521)
05-13 18:19:49.717: E/Database(20223):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
05-13 18:19:49.717: E/Database(20223):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
05-13 18:19:49.717: E/Database(20223):  at dalvik.system.NativeStart.main(Native Method)
05-13 18:19:49.776: I/fileVERSIONname(20223): ==0.1
05-13 18:19:49.787: I/dbVERSIONname(20223): ==0.1
05-13 18:19:49.796: I/dAWF(20223): plotDynamicTabs:onCreate
05-13 18:19:49.897: E/currPLOTNo(20223): ==0
05-13 18:19:49.907: I/dAWF(20223): RunForm:onCreate
05-13 18:19:49.977: E/FORMplotNO(20223): ==0
05-13 18:19:50.097: E/currPLOTN1111(20223): ==0
05-13 18:19:50.107: I/dAWF(20223): RunForm:onResume
05-13 18:19:50.117: I/dAWF(20223): plotDynamicTabs:onResume
05-13 18:19:50.117: I/dAWF(20223): dynamicTabs:onResume
05-13 18:19:50.237: E/com.mypackage.dform.RunForm(20223): Error occurred in ProcessForm:no such table: form_data
05-13 18:19:50.237: W/System.err(20223): android.database.sqlite.SQLiteException: no such table: form_data
05-13 18:19:50.237: W/System.err(20223):    at android.database.sqlite.SQLiteQuery.native_fill_window(Native Method)
05-13 18:19:50.237: W/System.err(20223):    at android.database.sqlite.SQLiteQuery.fillWindow(SQLiteQuery.java:75)
05-13 18:19:50.237: W/System.err(20223):    at android.database.sqlite.SQLiteCursor.fillWindow(SQLiteCursor.java:288)
05-13 18:19:50.247: W/System.err(20223):    at android.database.sqlite.SQLiteCursor.getCount(SQLiteCursor.java:269)
05-13 18:19:50.247: W/System.err(20223):    at android.database.AbstractCursor.moveToPosition(AbstractCursor.java:171)
05-13 18:19:50.247: W/System.err(20223):    at android.database.AbstractCursor.moveToFirst(AbstractCursor.java:248)
05-13 18:19:50.247: W/System.err(20223):    at com.mypackage.ddatabase.dataDB.getItemInstanceValue(dataDB.java:264)
05-13 18:19:50.247: W/System.err(20223):    at com.mypackage.dform.RunForm.getFormData(RunForm.java:530)
05-13 18:19:50.247: W/System.err(20223):    at com.mypackage.dform.RunForm.run(RunForm.java:563)
05-13 18:19:50.247: W/System.err(20223):    at java.lang.Thread.run(Thread.java:1096)
05-13 18:19:50.807: I/ActivityManager(52): Displayed activity com.mypackage.dynamicAWF/com.mypackage.dawf.dynamicTabs: 1795 ms (total 1795 ms)
05-13 18:19:51.147: E/gralloc(52): [unregister] handle 0x4fe5b0 still locked (state=40000001)
05-13 18:19:56.057: D/dalvikvm(104): GC freed 334 objects / 15920 bytes in 150ms 
```

我做了一些更改并摆脱了 IllegalStateException，但问题仍然存在，日志看起来像这样（数据库之前已经成功读取了很多次，但 form_data 表仍然会导致问题）：

```
05-14 15:52:28.345: I/dAWF(455): dynamicTabs:onCreate
05-14 15:52:28.715: I/fileVERSIONname(455): ==0.1
05-14 15:52:28.725: I/dbVERSIONname(455): ==0.1
05-14 15:52:28.755: I/dAWF(455): plotDynamicTabs:onCreate
05-14 15:52:28.895: D/dalvikvm(455): GC freed 5524 objects / 349592 bytes in 68ms
05-14 15:52:28.935: I/dAWF(455): RunForm:onCreate
05-14 15:52:29.195: I/dAWF(455): RunForm:onResume
05-14 15:52:29.205: I/dAWF(455): plotDynamicTabs:onResume
05-14 15:52:29.205: I/dAWF(455): dynamicTabs:onResume
05-14 15:52:29.335: E/com.mypackage.android.dform.RunForm(455): Error occurred in ProcessForm:no such table: form_data
05-14 15:52:29.345: W/System.err(455): android.database.sqlite.SQLiteException: no such table: form_data
05-14 15:52:29.345: W/System.err(455):  at android.database.sqlite.SQLiteQuery.native_fill_window(Native Method)
05-14 15:52:29.345: W/System.err(455):  at android.database.sqlite.SQLiteQuery.fillWindow(SQLiteQuery.java:75)
05-14 15:52:29.345: W/System.err(455):  at android.database.sqlite.SQLiteCursor.fillWindow(SQLiteCursor.java:288)
05-14 15:52:29.345: W/System.err(455):  at android.database.sqlite.SQLiteCursor.getCount(SQLiteCursor.java:269)
05-14 15:52:29.345: W/System.err(455):  at android.database.AbstractCursor.moveToPosition(AbstractCursor.java:171)
05-14 15:52:29.345: W/System.err(455):  at android.database.AbstractCursor.moveToFirst(AbstractCursor.java:248)
05-14 15:52:29.345: W/System.err(455):  at com.mypackage.android.ddatabase.dataDB.getItemInstanceValue(dataDB.java:264)
05-14 15:52:29.345: W/System.err(455):  at com.mypackage.android.dform.RunForm.getFormData(RunForm.java:529)
05-14 15:52:29.345: W/System.err(455):  at com.mypackage.and 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T19:59:42.367

查看[Finalizing a Cursor 尚未停用或关闭的非致命错误](https://stackoverflow.com/questions/3068320/finalizing-a-cursor-that-has-not-been-deactivated-or-closed-non-fatal-error)

看看你的例外。它与游标管理有关。尝试使用 startManagingCursor。

# c - 客户端使用 C 使用 TCP 套接字向端口发送数据

> ID：10572188
> 
> 赞同：1
> 
> 时间：2012-05-13T13:35:47.407
> 
> 标签：c, sockets, tcp, udp, client-server

我正在用 C 语言制作一个必须处理这种情况的客户端程序：

1-服务器程序在端口号为 X 的客户端发送的端口号 8080 中接收 udp 数据报

2- 服务器在端口号 X 中创建一个新的套接字 (TCP)

3-使用这个TCP套接字，服务器读取客户端发送的字符串

（在本地主机上运行）

我不需要制作服务器程序，它已经完成了。第 1 点和第 2 点已涵盖，但我已经花了几天时间试图解决第 3 点，但我无法让它发挥作用 ><

我为客户提供的代码是这样的：

```
#define MYPORT 8080

int main(int argc, char *argv[ ]) {

int sockfd;

/* connector’s address information */

struct sockaddr_in their_addr;
struct hostent *he;
int numbytes;

int sockfd2, n;
struct sockaddr_in serv_addr;
struct hostent *server;
char buffer[256];

if (argc != 3) {
    fprintf(stderr, "Usage: %s <hostname> <message>\n", argv[0]);
    exit(1);
}

/* get the host info */

if ((he = gethostbyname(argv[1])) == NULL) {
perror("Error obtaining the client. \n");
    exit(1);
}

else printf("Client obtained\n");

if((sockfd = socket(AF_INET, SOCK_DGRAM, 0)) == -1) {
    perror("Error creating UDP socket\n");
    exit(1);
}

else printf("UDP Socket done\n");

their_addr.sin_family = AF_INET;

printf("Port: 8080\n");

their_addr.sin_port = htons(MYPORT);

their_addr.sin_addr = *((struct in_addr *)he->h_addr);

memset(&(their_addr.sin_zero), '\0', 8);

 sockfd2 = socket(AF_INET, SOCK_STREAM, 0);
if (sockfd2 < 0) 
    error("ERROR opening socket");
server = gethostbyname(argv[1]);
if (server == NULL) {
    fprintf(stderr,"ERROR, no such host\n");
    exit(0);
}

//sending port where the TCP socket will be associated
//server client connects correctly to this port 
//and the code it's working fine in this point
if((numbytes = sendto(sockfd, argv[2], strlen(argv[2]), 0, (struct sockaddr *)&their_addr, sizeof(struct sockaddr))) == -1)

{

perror("Client-sendto() error lol!");

exit(1);

}
//port is sent, now let's connect to the port by tcp and write the string
//not working properly from now on

bzero((char *) &serv_addr, sizeof(serv_addr));
serv_addr.sin_family = AF_INET;
bcopy((char *)server->h_addr, 
     (char *)&serv_addr.sin_addr.s_addr,
     server->h_length);
serv_addr.sin_port = htons(atoi(argv[2]));
if (bind(sockfd2,(struct sockaddr *) &serv_addr, sizeof(serv_addr)) < 0) 
    error("ERROR connecting");

listen(sockfd2, 5);
accept(sockfd2, 0, 0);
printf("accepted!\n");

//sending the string to the TCP Port...
if((numbytes = sendto(sockfd2, "hi", 2, 0, (struct sockaddr *)&serv_addr, sizeof(struct sockaddr))) == -1)

{

printf("Client-sendto()-TCP error\n");

exit(1);

}

if (close(sockfd) != 0) printf("Client-sockfd-UDP closing is failed!\n");
else printf("Client-sockfd-UDP successfully closed!\n");
if (close(sockfd) != 0) printf("Client-sockfd2-TCP closing is failed!\n");
else printf("Client-sockfd2-TCP successfully closed!\n");
return 0;

} 
```

该代码适用于前两个步骤，但在最后一步中，它似乎与 TCP 端口连接不好，因为我的客户端程序结束但我的服务器程序说他收到 null。当然，我总是发送端口 > 1024

在此先感谢，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:48:48.533

```
listen(sockfd2, 5);
accept(sockfd2, 0, 0);
printf("accepted!\n"); 
```

我还没有阅读您的所有代码，但以上（至少）是错误的。您绝对需要保留的返回值`accept`：这是您需要写入的套接字！

`accept`在您的情况下，为刚刚创建用于与“服务器”通信的新 TCP 套接字返回一个文件描述符。您需要将其用作写入字符串的文件描述符。

（`sendto`在那之后的调用，除了使用错误的套接字之外，有点可疑，因为服务器无法确定要读取多少数据/消息停止的位置。传递长度为 3（包括`\0`字节，将少一点怀疑。）

# algorithm - 点的对数绘图

> ID：10572189
> 
> 赞同：2
> 
> 时间：2012-05-13T13:35:49.573
> 
> 标签：algorithm, drawing, logarithm, drawing2d

我想知道是否给出多个 2D 点，如何计算在屏幕上以对数 y 比例绘制点的位置？

我试图只取所有点的 y 值的对数，而不是“正常”地绘制它们（绘图点 [x, log(y)] => on height: height*log(y)/log(max)） . 但是这种方法会导致 y 值低于 1 时出现问题。所以这让我想知道我的方法总体上是否是正确的方法。我可能会使用的一个调整是使用 log(y/min) 而不是 log(y)。

欢迎任何关于改进或更好方法的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:40:35.450

通过假设`y`值是积极的，使用你自己的方法，有一个小的偏差，比如：`height*log(y-min+1)/log(max-min+1)`防止非常大的负值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T13:47:33.110

如果您`y/ymin`以对数方式绘制，您会将最小值缩放为`1`，从而保证所有对数值都是非负数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T16:10:59.380

查看 plot 的 R 实现，它可能会为您提供一些线索。如果您使用`plot(x,y,log='y')`，则 y 轴将绘制在对数刻度上。

关于积分<1，您将面临与 -ve 数字相同的问题，对吧？所以基本上你需要标准化数据，使所有点都在屏幕上的可见范围内。使用以下转换：

ny = number_of_pixels*(log(y) - min(log(Y)))/(max(log(Y))-min(log(Y)))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T19:15:36.647

据我了解，您似乎正在尝试绘制 log(y) 但保持 y 轴与 y 一样？这真的没有意义。

您绘制的方式很好：您在 (x, log(y)) 处绘制一个点。

但是你需要改变的是y轴的限制。如果它最初从 ymin 变为 ymax，现在需要从 log(ymin) 变为 log(ymax)。

如果您以这种方式更改 y 轴限制，那么这些点将非常适合。

# excel - Excel 单元格自动填充数值

> ID：10572190
> 
> 赞同：0
> 
> 时间：2012-05-13T13:36:13.900
> 
> 标签：excel, vba

我在 MS Excel 2010 中想要的是，当我在值框中输入数字“15”时，十五个单元格应自动填充黄色，如下面的链接示例图像所示。如果我输入数字“5”，则应自动填充五个单元格。有没有可能？请指导。非常感谢您的帮助。

[http://www.thewebmakerz.com/Sample/excel-help.gif](http://www.thewebmakerz.com/Sample/excel-help.gif)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:16:22.453

使用 Excel 的**条件格式**功能：

![在此处输入图像描述](../Images/9a2caa67fbc757727b1557c2ba29ef3b.png)

# java - 将 Spring applicationContext.xml 放在非 Web 应用程序中的什么位置？

> ID：10572191
> 
> 赞同：1
> 
> 时间：2012-05-13T13:36:25.737
> 
> 标签：java, spring

我正在创建一个使用 Spring bean 的应用程序，我需要`ApplicationContext`从`xml`. 由于它不是服务器应用程序，它没有文件夹。`WEB-INF`那么，我应该把`xml`文件放在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T13:50:12.550

这个主题的 spring 文档起初有点压倒性。应用程序上下文配置的 spring 文档中的一个方便的起点是[here](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-factory-instantiation)

文件[系统 xml 应用程序上下文](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/support/FileSystemXmlApplicationContext.html)可能是最容易开始的。所以：

```
ApplicationContext appCtx = 
    new FileSystemXmlApplicationContext("/path/to/springconfig.xml"); 
```

如果`ClassPathApplicationContext`您的应用程序类路径中有 xml 配置，请使用。在此示例中，它可能是项目目录 src/config/springconfig.xml 下的 springconfig.xml。

```
ApplicationContext appCtx = 
    new ClassPathXmlApplicationContext("config/springconfig.xml"); 
```

如果在构建应用程序后不确定 springconfig.xml 的最终位置，可以使用以下命令列出 jar 的内容：

```
jar -tvf myapp.jar 
```

对于默认的 eclipse java 项目，**project-home/bin**目录是类路径的开始。

[在这里](https://stackoverflow.com/questions/10412225/what-is-difference-between-class-path-file-system)提出了一个相关的问题

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-13T13:50:32.520

使用[`ClassPathXmlApplicationContext`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/context/support/ClassPathXmlApplicationContext.html)：

```
ApplicationContext ctx = 
  new ClassPathXmlApplicationContext("applicationContext.xml"); 
```

或者考虑迁移到[`@Configuration`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/context/annotation/Configuration.html)：

```
ApplicationContext ctx = 
  new AnnotationConfigApplicationContext(AppConfig.class); 
```

where`AppConfig`被注释`@Configuration`并且不需要 XML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T13:47:12.033

检查此示例[Spring Setter Injection](http://www.vaannila.com/spring/spring-bean-setter-injection-1.html)

如果 XML 在应用程序类路径中，则像这样使用

```
 ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml"); 
```

否则，如果 XML 在文件系统中，则使用

```
 ApplicationContext context = new FileSystemXmlApplicationContext("beans.xml"); 
```

# java - 使用 google web toolkit 的 Netbeans 和 play 框架

> ID：10572193
> 
> 赞同：1
> 
> 时间：2012-05-13T13:36:27.393
> 
> 标签：java, gwt, netbeans, playframework

`netbeansify`我得到了一个 java 项目，我试图使用命令（在 play 框架中）将它导入 Netbeans 。本项目使用 gwt 框架。`play run`该应用程序使用该命令运行良好。当我尝试使用 netbeans 运行项目时，我连接到 localhost:9000（播放框架侦听的端口）。浏览器中出现以下错误消息。

* * *

编译错误

文件 /app/gwt/core/server/DSPServiceImpl.java 无法编译。引发的错误是：GWT2Service 无法解析为类型

在 /app/gwt/core/server/DSPServiceImpl.java 中（大约第 174 行）

```
 import controllers.utils.DateUtil;
 import controllers.utils.DateUtil.Time;

 @GWT2ServicePath("/core/greet")

 public class DSPServiceImpl extends GWT2Service implements DSPService { 
```

. . . . .

这可能是一个非常新手的问题，但如果我应该做更多的事情，有人可以帮助我吗？

# cron - 如何搜索恶意 cron 作业？

> ID：10572197
> 
> 赞同：-1
> 
> 时间：2012-05-13T13:37:16.820
> 
> 标签：cron

我在 WebFaction 有一个帐户，并且在过去的一个月中，多个网站被黑客入侵了多次。其中大部分是 WordPress 安装。

每次发生这种情况时，我都会更改所有密码——用户、站点访问、数据库等——更新 WordPress，并在 WordPress 安装中查找 cron 作业。

我非常有信心知道如何更改密码（并生成安全密码）。如果我的（低水平）知识存在差距，那就是 cron 工作，以及在“后门”打开的情况下，我是否可能会在完成所有这些工作时遗漏一些东西。

有没有一种自动化的方式可以搜索这些？如果我必须手动打开这数百个受感染的 PHP 文件中的每一个，是否有特定的文本字符串或我可以搜索的内容来帮助我找到（并理解）这些文件是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:40:07.680

如果您被黑客入侵，则只有两种安全方法：从已知的良好安装源完全重新安装，或恢复您确定在入侵之前进行的备份。

一旦攻击者获得了对系统的访问权限，就有很多方法可以隐藏恶意代码，以至于不可能全部通过并确保没有留下任何东西。

# python - 查找字符串中子字符串的位置

> ID：10572199
> 
> 赞同：15
> 
> 时间：2012-05-13T13:37:23.860
> 
> 标签：python, string, find, position

我有一个格式的python字符串

```
mystr = "hi.this(is?my*string+" 
```

在这里，我需要获取被特殊字符或非字母字符包围的“is”的位置（即本例中的第二个“is”）。然而，使用

```
mystr.find('is') 
```

如果 'is' 与不想要的 'this' 相关联，则将返回该位置。如何找到字符串中被非字母字符包围的子字符串的位置？使用 python 2.7

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-13T13:43:25.307

这里最好的选择是使用正则表达式。Python 有用于处理正则表达式[的`re`模块。](http://docs.python.org/library/re.html)

我们使用简单的搜索来找到 的位置`"is"`：

```
>>> match = re.search(r"[^a-zA-Z](is)[^a-zA-Z]", mystr) 
```

这会将第一个匹配项作为匹配对象返回。然后我们简单地使用[`MatchObject.start()`](http://docs.python.org/library/re.html#re.MatchObject.start)来获取起始位置：

```
>>> match.start(1)
8 
```

编辑：提出了一个很好的观点，我们组成`"is"`一个小组并匹配该小组以确保我们获得正确的位置。

正如评论中所指出的，这做出了一些假设。一个是被*包围*的意思是`"is"`不能在字符串的开头或结尾，如果是这种情况，则需要不同的正则表达式，因为它只匹配被包围的字符串。

另一个是这将数字视为特殊字符-您说的是*non-alphabetic*，我认为它是指包含的数字。如果您不想计算数字，那么使用`r"\b(is)\b"`是正确的解决方案。

# java - 我可以使用哪个 java 集合？

> ID：10572201
> 
> 赞同：3
> 
> 时间：2012-05-13T13:37:47.097
> 
> 标签：java, collections, dictionary, map

我需要存储一组数据结构，这些数据结构由时间段（开始、结束）和这段时间的计数器定义，其中包含一些复杂的计算结果。数据结构的简化定义如下：

```
public class CounterBag {
    private Period period;   // collection key
    private Counter counter;
    // accessors
    // ...
} 
```

这`Period`很简单：

```
public class Period {
    public DateTime start;
    public DateTime end;
    // accessors
    // ...
} 
```

我需要一个包含`CounterBag`distinct 定义的对象的集合`Periods`。该集合需要通过 提供有效的查找（这是捕获！）`long timeInMillis`，所以`HashMap`这不是一个真正的选择，因为我不想覆盖`equals`和`hashcode`（`CounterBag`我需要它们两者）。集合需要按`Period`（按结束日期）排序。`Period`s 具有灵活的持续时间，执行查找的部分不知道。

**我想知道在 java 标准 API 或一些开源库中是否有一个开箱即用的集合可以帮助我解决它？**某种排序集或排序映射，可以实现按日期进行有效查找。按日期查找将返回日期在`CounterBag`其中`Period`的 a。

感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T13:42:01.283

您可以使用 TreeMap 作为它的排序集合（这使得查找高效）

如果您的经期有固定间隔（这是最简单的形式），则您不需要这样的集合。您可以为每个间隔设置一个计数器。例如`int[]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:29:45.710

我建议一个`TreeMap<Long, CounterBag>`. 您可以使用以下`NavigableMap`界面访问它：

```
NavigableMap<Long, CounterBag> map = new TreeMap<Long, CounterBag>();
map.put(bag.period.end.toMillis(), bag); // Get end DateTime as a Long

long lookupLong = 10000L; // or whatever

/*
 * Retrieves the greatest Bag whose Period's end is
 * less than or equal to the Long
 */
CounterBag newBag = map.floorEntry(lookupLong).getValue(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T13:59:54.620

我只想扩展@Peter Lawrey 的答案，为您的 CounterBag 使用带有自定义比较器的 TreeMap。

此比较器将确保返回范围内的 CounterBag。

查找的效率将取决于您的比较器实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T14:02:49.063

如果期间不重叠，那么我建议使用`TreeMap<Period, CounterBag>`. 当您需要以`CounterBag`毫秒为单位获得给定时间时，您可以使用以下内容：

```
// Initialize map
Map<Period, CounterBag> map = new TreeMap<Period, CounterBag>();
map.put(...);

// Prepare "query"
long timeInMillis = ...;
Period fakePeriod = new Period(new Date(timeInMillis), new Date(timeInMillis));

// Get bag for given time.
CounterBag bag = map.get(fakePeriod); 
```

在这种情况下，要么`Period`必须实现`Comparable`，要么将自己的比较器传递给树。如果两个时期重叠，则比较它们应该返回 0（在我们的例子中，如果某个真实时期包括我们的假时期，其开始和结束时间等于`timeInMillis`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-13T16:31:24.930

因为任何开始时间都可能符合条件，给定足够的持续时间，按开始时间排序的简单 ArrayList 将是一种有效的方法，尤其是在允许重叠的情况下（产生多个结果）。您将仅迭代到开始时间 > 请求 timeInMillis 的第一条记录。

# c# - MediaElement.SetSource 使应用程序崩溃

> ID：10572202
> 
> 赞同：0
> 
> 时间：2012-05-13T13:37:56.143
> 
> 标签：c#, windows, xaml, windows-8, windows-runtime

我正在开发适用于 Windows 8 的录音机应用程序，并注意到当我将 IRandomAccessStream 传递给 MediaElement.SetSource 时，应用程序崩溃，并且没有抛出 Visual Studio 可见的异常。我应该如何调试这个问题？可能是什么原因造成的？

这是导致崩溃的代码：

```
void mediaFiles_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (e.AddedItems.Count == 1)
    {
        string fname = e.AddedItems[0] as string;
        Stream fstream = GlobalVariables.encryptedFS.OpenFile(fname);
        MediaElement elem = new MediaElement();
        mainGrid.Children.Add(elem);
        elem.AutoPlay = true;
        elem.SetSource(new WinRTStream(fstream, true), "audio/x-ms-wma");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T18:10:15.593

解决它。原来是我的 IAsyncOperationWithProgress 实现中的一个错误。
对于那些面临类似困难的人，这里是修复它的代码：

```
class ReadOperation : IAsyncOperationWithProgress<IBuffer, uint>
{
    Stream _underlyingstream;
    IAsyncAction _task;
    IBuffer val;
    byte[] _buffer;
    int bytesread;

    public ReadOperation(Stream str, IBuffer buffer, uint cnt)
    {
        uint count = cnt;
        _underlyingstream = str;

        if (_underlyingstream.Length - _underlyingstream.Position < count)
        {

            _buffer = new byte[_underlyingstream.Length - _underlyingstream.Position];
            count = (uint)_buffer.Length;
        }

        _buffer = new byte[count];
        val = buffer;

        _task = Task.Run(async delegate()
        {
            while (bytesread < count)
            {
                int cout = await str.ReadAsync(_buffer, bytesread, (int)count);
                if (cout == 0)
                {
                    break;
                }
                bytesread += cout;
            }
        }).AsAsyncAction();
    }
} 
```

# unit-testing - Tamejs 不能和摩卡一起工作？

> ID：10572204
> 
> 赞同：2
> 
> 时间：2012-05-13T13:38:46.357
> 
> 标签：unit-testing, mocha.js, tamejs

使用 mocha + tamejs 查看我的测试代码：

**测试/t.tjs**

```
require('should');

function inc(n, callback) {
  setTimeout(function() {
    console.log('### inc: ' + n);
    callback(n+1);
  }, 1000);
};

describe('test', function(){
  it('show ok with tamejs', function(){
     console.log('### testing ...');
     var result;
     await { inc(1, defer(result)); }
     console.log('result: ' + result);
     result.should.equal(123456); // won't pass
  });
}); 
```

将其编译为 t.js：

```
tamejs -o test/t.js test/t.tjs 
```

运行摩卡

```
mocha 
```

结果：

```
### testing ...
.

✔ 1 test complete (1ms) 
```

似乎该`inc`方法从未被调用过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:31:19.443

问题是我没有正确使用摩卡。

它应该写成：

```
describe('test', function(){
  it('show ok with tamejs', function(done){
     console.log('### testing ...');
     var result;
     await { inc(1, defer(result)); }
     console.log('result: ' + result);
     result.should.equal(123456); // won't pass
     done();
  });
}); 
```

请注意`done`, 它在 mocha 中用于确定异步调用是否已完成。没有它，mocha 不会等待异步调用。

# eclipse - 我可以在 Eclipse 调试器中将结果集作为表格查看吗

> ID：10572211
> 
> 赞同：21
> 
> 时间：2012-05-13T13:39:35.213
> 
> 标签：eclipse, debugging, resultset

我在 Eclipse 中有一个从 SQL 查询创建的结果集。

来自 Visual Studio 的世界，我希望找到我的变量的监视视图，它将结果集显示为表格，而不仅仅是显示所有字段和属性。

Eclipse 是否存在这样的解决方案，也许作为插件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T03:29:34.860

好问题！

遗憾的是，任何插件都必须基于现有的调试器创建。以下文章讨论了如何在 Eclipse 中为新语言创建调试器：http: [//www.eclipse.org/articles/Article-Debugger/how-to.html](http://www.eclipse.org/articles/Article-Debugger/how-to.html)

这篇文章非常详细地介绍了调试过程在 eclipse 中是如何工作的。我相信这将是 Eclipse 中的一个很棒的功能，并建议您提交一个新的功能请求： http: [//www.eclipse.org/stem/feature_request.php](http://www.eclipse.org/stem/feature_request.php)

作为一种解决方法，我建议使用包含您的查询的字符串变量，将该字符串添加到您的监视列表中，以便您可以在调试时访问它。复制字符串的内容并将其粘贴到 SQL 查询分析器等工具中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T16:49:08.230

不知道有没有插件可以在调试器中格式化一个ResultSet，我从来没见过这样的东西。但是，数据工具平台 (DTP) 提供了与数据库交互的工具，包括查询结果的表视图等。否则，您可以安装它。

[这](http://www.vogella.com/articles/EclipseDataToolsPlatform/article.html)是一个关于使用这些工具的好教程。

# c - 使用 fork() 的不均匀进程树

> ID：10572218
> 
> 赞同：3
> 
> 时间：2012-05-13T13:40:12.580
> 
> 标签：c, fork

我必须使用`fork()`C 语言构建一个进程树。我从标准输入中得到一个数字序列（例如：1 5 0 3），这些数字告诉我每个节点有多少个子节点。如果我们以这个例子为例，那么根进程会创建 1 个子进程，然后这个子进程会创建自己的 5 个子进程，然后从这 5 个子进程中，第一个不会创建任何子进程，第二个进程会创建其中的 3 个，然后我们重做。完成后，根进程调用`pstree`绘制树。

这是示例的图片：

![](../Images/09472690363329c25eec06603c25514f.png)

我的问题是如何从特定节点创建新子节点？一个需要创建 0 个新进程，下一个需要创建 3 个。我不知道如何区分，以便只有那个特定的孩子会产生新的孩子，而不是所有的孩子。另外我不确定如何使用`pstree`，因为树通常在`pstree`被调用时已经消失了。我知道我可以`wait()`让孩子们先执行，但最后一个没有孩子要等待，所以他们结束得太快了。

我已经编写了创建示例的代码。需要想法如何将其推广到不同的输入。也有人可以告诉我如何从这段代码中调用 pstree，因为我似乎无法让它工作。

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/wait.h>

int main() {

pid_t pid;
pid_t temppid;
pid_t temppid2;
int  root_pid;
int status;

root_pid = getpid();

pid = fork(); // creates a child from root
if (pid == 0) { // if child
    pid = fork(); // fork again (child#1)
    if (pid != 0) { // if not child of child#1
        temppid = getpid(); // get pid
        if (getpid() == temppid) { // create child#2
            pid = fork();
            if (pid == 0) {
                temppid2 = getpid();
                if (getpid() == temppid2) { // create child#1
                    fork();
                }
                if (getpid() == temppid2) { // create child#2
                    fork();
                }
                if (getpid() == temppid2) { // create child#3
                    fork();
                }
            }
        }
        if (getpid() == temppid) { // create child#3
            fork();
        }
        if (getpid() == temppid) { // create child#4
            fork();
        }
        if (getpid() == temppid) { // create child#5
            fork();
        }
    }
}
else {
    // create another child from root
    pid = fork();
        if (pid == 0) {
            // run pstree in this child with pid from root
        }
}

while (1) {
    sleep(1);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:22:36.617

因为`pstree`，解决方案很简单——每个进程在完成它应该做的事情之后，都会进入睡眠状态（比如说，一分钟）。
然后你可以用它`pstree`来看看发生了什么。

对于正确的分叉次数，问题似乎在于解析输入，而不是分叉。
我将从编写读取输入的代码开始，而不是分叉，只是打印您要创建的进程树。一旦你清楚了这一点，它就不应该能够正确地分叉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:29:55.217

仅测试您的应用创建的层次结构：

而不是放置一个

```
return 0; 
```

正如最后一句话所说

```
while (1)
  sleep(1); 
```

这使该过程永远运行，直到您按下`Ctrl-C`。

启动应用程序后，使用另一个终端并发出 a`pstree`检查应用程序创建的进程层次结构。

要清理（如果在 linux 上）发出`killall <app name>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T16:04:25.647

我的一个建议是您使用的返回值`fork`来判断您的代码是在子进程还是父进程中运行。

# arrays - 在 PL/pgSQL 中使用动态查询创建数组

> ID：10572224
> 
> 赞同：7
> 
> 时间：2012-05-13T13:41:36.620
> 
> 标签：arrays, postgresql, stored-procedures, execute, plpgsql

我正在尝试在 plpgsql 函数中创建一个带有动态选择查询的数组。不幸的是，我收到语法错误。

```
ERROR:  syntax error at or near "EXECUTE"
ZEILE 19:  SELECT DISTINCT INTO outputIdsToDelete ARRAY( EXECUTE findA...
                                                         ^ 
```

有人可以帮我吗？这是函数本身：

```
创建或替换函数 deleteMAPPINGs(
   mapTable1_key 文本、mapping_table 文本、mapTable2_key 文本、
   table2 文本，table2_key 文本，
   inputIdsToDelete bigint[]) 返回 bigint[] AS
$身体$
宣布
    outputIdsToDelete bigint[];
    findAllQuery 文本；
    findUnreferencedQuery 文本；
    开始
    findAllQuery := 'SELECT DISTINCT ' || mapTable2_key ||
        '来自' || 映射表 ||
        '在哪里' || mapTable1_key || ' = ANY(inputIdsToDelete)';
    findUnreferencedQuery := 'SELECT DISTINCT ' || table2_key || --查找未使用的
        '来自' || 表2 ||
        '在哪里' || table2_key || '不在 (' ||
            '选择不同的' || mapTable2_key || --全部使用
            '来自' || 映射表 || ')';

    SELECT DISTINCT INTO outputIdsToDelete ARRAY(EXECUTE findAllQuery);

    从映射表中删除
        mapTable1_key = ANY(inputIdsToDelete) 和
        mapTable2_key = ANY(outputIdsToDelete);

    SELECT DISTINCT INTO outputIdsToDelete --用未使用的覆盖
        数组（执行 findUnreferencedQuery）；

    返回输出IdsToDelete；
结尾;
$身体$
语言 plpgsql 易失性
费用 100；

```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-13T14:23:04.243

您不能在 SQL 语句中使用 EXECUTE - EXECUTE 只是 plpgsql 语句，因此它不能在 SQL 中 -

```
EXECUTE string INTO variable 
```

# jquery - iframe 上的点击事件？

> ID：10572227
> 
> 赞同：4
> 
> 时间：2012-05-13T13:42:02.813
> 
> 标签：jquery, iframe, click

我有一个简单的 iFrame……</p>

```
<iframe src="url" width="980px" height="90px" id="inviteFrame" name="inviteFrame" scrolling="no"></iframe> 
```

我知道我无法在框架内的元素上捕获点击事件，但是在 iFrame 本身上进行简单的单击或鼠标按下怎么样？

```
$('#inviteFrame').click(function() {
    console.log('test');
    $(this).attr('height', '140px');
}); 
```

这对我不起作用！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-13T13:50:57.283

jQuery 有一个名为[.contents()](http://docs.jquery.com/Traversing/contents)的方法，当在`iframe`元素上使用它时会返回 iframe 的文档。

```
// Get a reference to the iframe document
var iframeDoc = $('#inviteFrame').contents().get(0); 
```

现在您可以将事件绑定到它，获取尺寸，获取各种元素的样式等：

```
// Get width of iframe document
$(iframeDoc).width();

// Get height of iframe document
$(iframeDoc).height();

// Bind event to iframe document
$(iframeDoc).bind('click', function( event ) {
    // do something
});

// Get the style of an element in the iframe
$('div', iframeDoc).css('backgroundColor'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T17:49:14.783

[由于网络浏览器的同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您不能这样做。

但是您可以使用模糊事件和 mouseover/mouseout 事件的解决方法。这就是我的 iframeTracker jQuery 插件的工作原理，旨在跟踪 iframe 上的点击：[https ://github.com/finalclap/iframeTracker-jquery](https://github.com/finalclap/iframeTracker-jquery)

这是一个例子：

```
jQuery(document).ready(function($){
    $('.iframe_wrap iframe').iframeTracker({
        blurCallback: function(){
            // Do something when iframe is clicked (like firing an XHR request)
        }
    });
}); 
```

享受 ！

# node.js - Buffer.byteLength() 被窃听

> ID：10572232
> 
> 赞同：2
> 
> 时间：2012-05-13T13:43:13.080
> 
> 标签：node.js

节点版本为 0.6.17。

我试图获取字符的字节数（[SO question](https://stackoverflow.com/questions/10571814/how-to-count-the-number-of-bytes-of-a-character)），但现在我正在测试如何获取真实的字节数。REAL 数字意味着如果 char 的值大于 127，则必须使用前导额外字节（[UTF8 wiki](http://en.wikipedia.org/wiki/UTF-8)）对其进行编码。

请参见：

```
console.log (Buffer.byteLength ("a", "utf8"));  //bytes: 1, UNICODE hex: 0x61 (1), REAL hex: 0x61 (1)
console.log (Buffer.byteLength ("¡", "utf8"));  //bytes: 2, UNICODE hex: 0xA1 (1), REAL hex: 0xC2A1 (2)
console.log (Buffer.byteLength ("↑", "utf8"));  //bytes: 3, UNICODE hex: 0x2191 (2), REAL hex: 0xE28691 (3)
console.log (Buffer.byteLength ("", "utf8")); //bytes: 3, UNICODE hex: 0x24065 (3), REAL hex: 0xF0A481A5 (4) 
```

这里我们有两种可能性：

1.  `Buffer.byteLength()`返回 UNICODE 字节数。示例：Unicode 为`¡`0xA1（1 个字节）。如果这是真的，那么函数就会出错，因为它返回 2（实际长度为 2）。
2.  `Buffer.bytelength()`返回 REAL 字节数。示例：真实的十六进制值`是 0xF0A481A5（4 个字节）。如果这是真的，那么这个函数就会出错，因为它返回 3（unicode 长度为 3）。`

 `你怎么看？功能有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:34:46.460

解决了：

[https://github.com/joyent/node/issues/3262#issuecomment-5677385](https://github.com/joyent/node/issues/3262#issuecomment-5677385)

node.js 版本 6 仅支持[BMP](http://en.wikipedia.org/wiki/Basic_Multilingual_Plane)字符集 (0x0000 - 0xFFFF)。版本 7 及更高版本支持大于 0xFFFF 的字符（未测试）。

该函数返回 REAL 长度，因此示例 1、2、3 正确，示例 4 错误。`

# javascript - 如何使用 JavaScript 从 Google 日历 (API) 获取今天的事件？

> ID：10572237
> 
> 赞同：2
> 
> 时间：2012-05-13T13:43:51.493
> 
> 标签：javascript, google-calendar-api, google-api-client

我是谷歌日历 API 的新手，我想做的是使用 JavaScript 从公共谷歌日历显示今天的事件。

我找到了这个[资源](http://gdata-javascript-client.googlecode.com/svn/trunk/samples/calendar/simple_sample/simple_sample.html)[（死链接）]，但我不知道如何修改它，以便它只输出今天的事件。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:26:37.513

看看 API：[https ://developers.google.com/calendar/quickstart/apps-script](https://developers.google.com/calendar/quickstart/apps-script)

您可以设置 start-min 和 start-max 参数。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-05-21T11:38:25.497

AuthSub 代理身份验证由需要向 Google 帐户验证其用户身份的 Web 应用程序使用。网站运营商不需要访问日历用户的用户名和密码 - 只需要特殊的 AuthSub 令牌。有关更多详细信息，请参阅 AuthSub 文档。

当用户第一次访问您的应用程序时，他们尚未通过身份验证。在这种情况下，您需要打印一些文本和将用户引导至 Google 的链接，以验证您访问其日历的请求。Python Google Data API 客户端库提供了从 CalendarService 类生成此 URL 的函数。下面的代码设置了到 AuthSubRequest 页面的链接。

# r - 聚合字符串列并计算选择字符串

> ID：10572238
> 
> 赞同：1
> 
> 时间：2012-05-13T13:44:06.650
> 
> 标签：r

我在 R 中有一个这样的数据框

```
> head(data)
  var1 var2    var3    var4  level
1  Yes  Yes Unknown      No level1
2   No  Yes      No     Yes level2
3  Yes   No     Yes Unknown level1
4  Yes  Yes Unknown     Yes level2 
```

我想在每个级别都有一个“是”的计数，就像这样

```
 var1 var2 var3 var4
level1     2    1    1    0
level2     1    2    0    2 
```

有什么提示吗？提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:02:34.900

首先，我创建了一个假数据框...

```
# first a handy helper function :-)
set.seed(123)
f1 <- function(N) { sample(c('Yes','No','Unknown'), N, replace=TRUE) }
# how many rows do I want in my fake data.frame?
N <- 15
data <- data.frame(var1=f1(N),var2=f1(N),var3=f1(N),var4=f1(N),
     level=sample(c('level1','level2'),N, replace=TRUE)) 
```

现在我使用表格功能...

```
# this gives me how many 'Yes' as the TRUE column for the 'var1' column
table(data$level, data$var1=='Yes')
          FALSE TRUE
  level1     5    2
  level2     7    1

# alternatively I just say for all the levels of var1
table(data$level, data$var1)        
         No Unknown Yes
  level1  3       2   2
  level2  3       4   1 
```

然后可以将其扩展到您要查找的内容...

或使用 plyr ...

```
library(plyr)
f2 <- function(x, c='Yes') { length(which(x==c)) }
f3 <- function(ndf) { res <- c(); for(i in 1:ncol(ndf)) res <- c(res, f2(ndf[,i])) ; res } 
ddply(data, .(level), f3)
   level V1 V2 V3 V4 V5
1 level1  2  5  2  3  0
2 level2  1  0  4  4  0 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-13T14:12:09.797

```
data.aux <- data.frame(data[,1:3] == "Yes", level = data[, 'level'])
uni <- unique(data[, 'level'])
f <- sapply(uni, function(x) colSums(data.aux[data.aux[, 'level']==x, 1:3]))
data.frame(t(f), levels = uni) 
```

# python - 使用 PyQt4 在屏幕右下角显示 Skype 样式的信息框

> ID：10572242
> 
> 赞同：1
> 
> 时间：2012-05-13T13:44:50.300
> 
> 标签：python, user-interface, pyqt4

据我了解，Skype 是在 Qt 中开发的，Skype 的信息框出现在右下角。我可以在`PyQt4`运行时制作这些信息框`Ubuntu`吗？“信息框”的意思是这样[的](http://help.admin.mtu.edu/docs/images/1/14/New_program_available.jpg)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:22:29.320

For `Mac OS` [Growl](http://growl.info/applications.php?cat=Chat)就是这样一个通知系统。`Ubuntu`有一个类似的通知系统，称为[NotifyOSD](https://wiki.ubuntu.com/NotifyOSD)。以下是使用该框架的 python 的一些[示例](https://wiki.ubuntu.com/NotificationDevelopmentGuidelines#Layout_cases_.28with_examples_in_C.2C_Python_and_C.23.29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:10:28.327

我相信这些是自定义小部件。

在 PyQt 中在线创建这些小部件的文档很少，但这里有两个可能有用的页面：[zetcode](http://zetcode.com/tutorials/pyqt4/customwidgets/)和[官方文档](http://doc.qt.nokia.com/qq/qq26-pyqtdesigner.html)。

在你的 PyQt 安装中也应该有一些示例。`/usr/share/doc/python-qt4-doc/examples`是我的 debian 机器上的位置。

# mysql - Mysql：时间+整数

> ID：10572246
> 
> 赞同：1
> 
> 时间：2012-05-13T13:45:18.653
> 
> 标签：mysql, time, add

我有一个带有时间字段的表，我需要向它添加一个 int 字段。这是代码行（它是触发器的一部分。）

```
DECLARE duration Int;
[....]
SET NEW.appointmentEnd = NEW.appointmentTime + duration; 
```

这一直有效，直到时间达到一个完整小时。所以 8:30:00 + 1500 = 8:45:00 但是 8:30:00 + 3000 = 0:00:00。

如何解决这个问题？

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:53:07.323

您应该添加一个显式*间隔*，而不是添加“普通”int ：

```
new.appointmenttime = (new.appointmenttime + INTERVAL durationInMinutes MINUTE) 
```

当然，您不仅限于使用：如果您需要更高的精度`MINUTE`，您可以使用。`SECOND`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T13:53:31.640

MySQL 不会通过添加您尝试的“秒”来直接进行日期/时间数学运算。但是您可以通过 Date_Add() 和 Date_Sub() 进行，例如

设置约会结束 = date_Add(约会时间，间隔 15 分钟)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T14:10:12.540

您应该使用日期算术，例如：

```
 mysql> SELECT '2008-12-31 23:59:59' + INTERVAL 1 SECOND;
    -> '2009-01-01 00:00:00' 
```

或者

```
 mysql> SELECT DATE_ADD('2010-12-31 23:59:59', INTERVAL 1 DAY);
    -> '2011-01-01 23:59:59' 
```

因此，例如，如果持续时间以秒为单位：

```
 SET NEW.appointmentEnd = NEW.appointmentTime + INTERVAL duration SECOND; 
```

# android - 显示存储在 SQlite 数据库中的所有记录

> ID：10572247
> 
> 赞同：2
> 
> 时间：2012-05-13T13:45:21.733
> 
> 标签：android, sqlite

我想显示存储在数据库中的所有记录

```
c = db.DBhelper.getChamp1(c.getCount);
//startManagingCursor(c);
int j = 0;
stateNameArray = new String[c.getCount()];
c.moveToFirst();
while(!c.isAfterLast()) {
  stateNameArray[j] = c.getString(0);
  j++;
  Log.i("DEBUG_SQL","" + c.getString(0)+ " "+c.getString(j));
   c.moveToNext();
}
//String resultat = ;
Log.i("DEBUG_SQL","" + c.getColumnIndex("article")); 
```

我写的时候出错了`c.getCount`——为什么？当我写一个像 1 或 2 或 3 这样的数字时......这很有效。

如果我写

```
c = db.rawQuery("SELECT * FROM loan", null); 
```

我得到一个错误，但如果我写

```
db.rawQuery("SELECT * FROM loan WHERE _id=1", null); 
```

这样可行。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:17:04.720

要回答有关您的 getCount isuue 的问题，您会收到以下错误：

```
c = db.DBhelper.getChamp1(c.getCount); 
```

您正在尝试在拥有光标之前获取光标的计数（并且您丢失了`()`）。

这会起作用，因为您在拉下一个光标之前要计算光标：

```
c = db.getSomeCursor;
c1 = db.DBhelper.getChamp1(c.getCount()); 
```

让我们知道您要实现的目标（我无法从您发布的代码中弄清楚），也许我们可以提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T13:57:35.873

至少，我看到这个日志语句存在问题，其中 c.getString(j) 没有意义。随着 j 变大，它可能会触发错误。

```
 Log.i("DEBUG_SQL","" + c.getString(0)+ " "+c.getString(j)); 
```

您打算使用语句 c.getString(j) 访问哪些数据？

关于 getCount 错误。我认为下面的错误是一个错字。但这是与 getCount 相关的错误所在的位置吗？

```
c = db.DBhelper.getChamp1(c.getCount); 
```

但我不应该假设 - 你永远不知道。它应该是（在方法调用中添加方括号）。

```
c = db.DBhelper.getChamp1(c.getCount()); 
```

正如@Barak 所提到的，这个声明是怎么回事？

# android - 为部分字符串设置文本大小

> ID：10572253
> 
> 赞同：0
> 
> 时间：2012-05-13T13:46:22.660
> 
> 标签：android, android-edittext

我有两个字符串：

```
<string name="bigtext">Big text</string>
<string name="anothertext">Small text</string> 
```

我在 EditText 的 android:hint 中都需要它们。

我试图将它们结合起来并将“大文本”放入`<b>Big text</b>`：

```
<string name="test">"<b>Big text</b> \nSmall text"</string> 
```

“大文本”是粗体，是的。但是如何指定“大文本”应该比“小文本”有更大的字体呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T13:51:16.280

`<big>`在大文本周围添加标签。或者，如果您愿意，可以`<small>`在小文本周围添加标签。但是，这些在字符串资源 AFAIK 中不起作用——您需要在 Java 代码或其他东西中包含此字符串，`Html.fromHtml()`用于获取`SpannedString`您将提供的`setHint()`内容`EditText`。

# javascript - 只能在页面重新加载时删除

> ID：10572267
> 
> 赞同：0
> 
> 时间：2012-05-13T13:47:18.677
> 
> 标签：javascript, jquery, html, local-storage

我正在尝试使用 html5 localstorage 和一些 JavaScript/jQuery 做一个待办事项列表。我使用 ul 并存储它，它工作正常，我可以将 li 添加到它，当我重新加载页面时它们会保留。但是在尝试执行删除功能时，我遇到了一些问题。**下面的代码可以在我重新加载页面后删除 li**。但我无法删除刚刚添加的 li。

添加项目时，我会这样做：

```
$(add).click(function(e) {
 if (addtext.value != ""){
  $(listan).append("<li>" + addtext.value + "</li>"); //listan is my <ul>
  localStorage.setItem('todo', listan.innerHTML);
  addtext.value = "";
  color(); //this adds some color to the li and also adds a delete-button
 }
} 
```

颜色（）函数：

```
function color(){
   lin = document.getElementsByTagName('li');

   for (var i = 0; i < lin.length;i++) {
     if (!(lin[i].childNodes.length > 1)){
       $(lin[i]).append("<input type='button' value='ta bort' class='tabort'></intput>"); //adds a deletebutton to all li's that doesnt have one

}}} 
```

当删除一个项目时，我会这样做：

```
$('input[type="button"]').click(function() {
if (this.id != 'clear'){
  $(this).parent().remove();
  color();
  localStorage.setItem('todo', listan.innerHTML);

}
}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T13:52:06.773

问题是您刚刚添加的新项目没有附加用于删除的单击处理程序。

您有两种选择来处理此问题，一种是使用`.live`而不是`.click`(http://api.jquery.com/live/)。另一种是将删除代码包装在一个函数中，并在添加新项目后调用该函数。

第一个选项看起来像这样（未经测试）：

```
$('input[type="button"]').live('click', function() {
    if (this.id != 'clear'){
      $(this).parent().remove();
      color();
      localStorage.setItem('todo', listan.innerHTML);
    }
}); 
```

第二个选项看起来像

```
addDeleteHandler = function($item) {
  $item.click(function() {
    if (this.id != 'clear'){
      $(this).parent().remove();
      color();
      localStorage.setItem('todo', listan.innerHTML);
    }
  });
}

// Modify the add handler
$(add).click(function(e) {
  if (addtext.value != ""){
    $newItem = $("<li>" + addtext.value + "</li>")
    $(listan).append($newItem); //listan is my <ul>
    addDeleteHandler($newItem); // Add delete handler
    localStorage.setItem('todo', listan.innerHTML);
    addtext.value = "";
    color(); //this adds some color to the li and also adds a delete-button
  }
}

// Need this to add delete handlers for items that are already in the list when page loads
addDeleteHandler($('input[type="button"]')) 
```

# matlab - 如何给 MATLAB 中的符号变量一个数字？

> ID：10572269
> 
> 赞同：5
> 
> 时间：2012-05-13T13:47:21.443
> 
> 标签：matlab, symbolic-math

我尝试使用以下代码在 MATLAB 中声明一个符号变量：

```
 syms a; 
```

我对这个变量进行计算，一切都很好。但我的问题是，我不知道如何给变量一个数字并将结果作为一个数字。例如我的代码的答案是

```
 answer=exp(-10*a); 
```

例如，我想给 "a" 40 并得到答案

```
 answer = 
        1.9152e-174 
```

我真的很感激任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-13T16:58:17.760

您可以使用 Symbolic Math Toolbox 中的[SUBS](http://www.mathworks.com/help/toolbox/symbolic/subs.html)函数来执行符号替换。

```
syms a;
answer = exp(-10*a);

subs(answer,a,40)

ans =

  1.9152e-174 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-13T14:03:49.063

使用[评估](http://www.mathworks.nl/help/toolbox/mupad/stdlib/eval.html)

```
syms a;
answer = exp(-10*a);

a=40;
eval(answer)

ans =
  1.9152e-174 
```

# c++ - 相同模式多次出现的 Horspool 算法

> ID：10572270
> 
> 赞同：1
> 
> 时间：2012-05-13T13:47:30.640
> 
> 标签：c++, string

我已经在 C++ 中实现了 Horspool 算法（取决于*Anany Levitin**的算法设计和分析简介*，第 2 版，第 258 页），用于查找文本中所需模式的第一次出现的位置。但是，我想扩展算法以查找相同模式的多次出现。不幸的是，我被困在后一种实现上。你可以在下面看到我的代码：

 *该函数计算并返回所需模式在文本中第一次出现的位置。移位大小存储在 ShiftTable 中，并且 ShiftTable 由所需字母表的字符索引。此外，整数*计数器*用于计算模式和文本字符之间的总比较。计数器最初具有零值。我如何扩展它以找到相同模式的多次出现？

我在 main() 函数的主体中尝试了以下操作，但它虽然有效，但它不是有效的。如果遇到第一次出现的模式，它的位置将被打印，并且以第一次出现的模式结束的文本部分将被删除。此外，该程序将检查模式等的剩余文本。

```
int counter=0;
while ((position = Find(pattern,text,ShiftTable,counter)) != -1) {
    cout << position << endl;
    text = text.erase(0,result+m);
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:06:47.800

目前，您总是从头开始 ( `i = m - 1`)。如果你想恢复之前的搜索，只需传入最后一个开始的位置。

在下文中，我删除了`counter`变量 - 无论如何它有什么用？

```
int Find(string pattern, string text, int *ShiftTable, int start = 0) 
```

……和……</p>

```
i = start + m - 1, 
```

......只需按如下方式调用代码：

```
while ((position = Find(pattern,text,ShiftTable,position)) != -1)  {
    cout << position << endl;
    ++position;
} 
```*

# c - 如何多次将相同的变量打印到字符串中？

> ID：10572271
> 
> 赞同：14
> 
> 时间：2012-05-13T13:47:31.893
> 
> 标签：c, printf

我有一个这样的格式字符串：

```
buf[] = "A%d,B%d,C%d,D%d,F%d,G%d,H%d,I%d,J%d"; 
```

我想为每个插入相同的整数，`%d`所以我使用：

```
 int val = 6;
 sprintf(buf2, buf, val,val,val,val,val,val,val,val,val); 
```

我可以`sprintf`以只需要我写`val`一次的方式`sprintf`使用它，并且每次都使用它`%d`吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-13T13:49:13.540

是的，您可以随时使用`%1$d`。引用第二`1$`个参数，你显然也可以用其他参数来做。

演示：[http ://codepad.org/xVmdJkpN](http://codepad.org/xVmdJkpN)

请注意，位置说明符是 POSIX 扩展 - 因此它可能不适用于每个编译器。如果您需要它与 Visual C++ 编译器一起工作，请考虑使用重复参数的丑陋方式或根本不使用 printf 样式的函数。另一种选择是使用与 POSIX 兼容的 sprintf 实现或使用多个调用在循环中每次附加一个数字（如果格式字符串是动态构建的，这将阻止您指定正确数量的参数）。

* * *

在旁注中，`sprintf`应该避免。改为使用`snprintf(buf2, sizeof(buf2), ....)`。当然，这需要`buf2`在编译时知道静态大小 - 但是如果您手动分配它，您可以简单地使用包含长度的变量而不是`sizeof(buf2)`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-13T13:56:29.353

没有标准的（即便携的）方法可以做到这一点。

# python - 如何从彩色图像创建 CMYK 半色调图像？

> ID：10572274
> 
> 赞同：8
> 
> 时间：2012-05-13T13:47:38.057
> 
> 标签：python, image, image-processing, python-imaging-library, cmyk

我正在做一个项目，该项目需要我分离出 CYMK 图像中的每种颜色并生成将在特殊的半色调打印机上打印的半色调图像。使用的方法类似于丝网印刷，因为过程几乎相同。拍一张照片并打破每个颜色通道。然后为半色调制作一个网屏。每个彩色屏幕的屏幕必须倾斜 15-45（可调）度。点大小和 LPI 必须根据用户可配置的值计算，以实现不同的效果。有人告诉我这个过程用于丝网印刷，但我无法找到任何解释 CYMK 半色调的信息。我发现有很多可以减少到单一颜色并生成新的打印风格的黑白半色调图像。

我想我需要：

1.  将文件拆分为其颜色通道。
2.  为该通道生成单色半色调图像。
3.  将生成的半色调图像倾斜度数 * 通道数。

有谁知道这是否是正确的方法以及任何现有的python代码？或者对这个过程或算法有什么好的解释？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-13T23:11:26.953

我曾经经营过一家丝网印刷工作室（那是一间很小的），虽然我从未真正做过分色印刷，但我对这些原理相当熟悉。这就是我的处理方式：

1.  将图像拆分为 C、M、Y、K。
2.  将每个分离的图像分别旋转 0、15、30 和 45 度。
3.  取每个图像的半色调（点大小将与强度成正比）。
4.  旋转每个半色调图像。

现在你有你的颜色分离的图像。正如您所提到的，旋转步骤减少了点对齐问题（这会使一切变得混乱），并且诸如[莫尔图案效果](http://en.wikipedia.org/wiki/Moir%C3%A9_pattern)之类的事情将被合理地最小化。

这应该很容易使用[PIL](http://www.pythonware.com/library/pil/handbook/image.htm)进行编码。

**更新 2：**

我写了一些快速代码来为你做这件事，它还包括一个`GCR`函数（如下所述）：

```
import Image, ImageDraw, ImageStat

def gcr(im, percentage):
    '''basic "Gray Component Replacement" function. Returns a CMYK image with 
       percentage gray component removed from the CMY channels and put in the
       K channel, ie. for percentage=100, (41, 100, 255, 0) >> (0, 59, 214, 41)'''
    cmyk_im = im.convert('CMYK')
    if not percentage:
        return cmyk_im
    cmyk_im = cmyk_im.split()
    cmyk = []
    for i in xrange(4):
        cmyk.append(cmyk_im[i].load())
    for x in xrange(im.size[0]):
        for y in xrange(im.size[1]):
            gray = min(cmyk[0][x,y], cmyk[1][x,y], cmyk[2][x,y]) * percentage / 100
            for i in xrange(3):
                cmyk[i][x,y] = cmyk[i][x,y] - gray
            cmyk[3][x,y] = gray
    return Image.merge('CMYK', cmyk_im)

def halftone(im, cmyk, sample, scale):
    '''Returns list of half-tone images for cmyk image. sample (pixels), 
       determines the sample box size from the original image. The maximum 
       output dot diameter is given by sample * scale (which is also the number 
       of possible dot sizes). So sample=1 will presevere the original image 
       resolution, but scale must be >1 to allow variation in dot size.'''
    cmyk = cmyk.split()
    dots = []
    angle = 0
    for channel in cmyk:
        channel = channel.rotate(angle, expand=1)
        size = channel.size[0]*scale, channel.size[1]*scale
        half_tone = Image.new('L', size)
        draw = ImageDraw.Draw(half_tone)
        for x in xrange(0, channel.size[0], sample):
            for y in xrange(0, channel.size[1], sample):
                box = channel.crop((x, y, x + sample, y + sample))
                stat = ImageStat.Stat(box)
                diameter = (stat.mean[0] / 255)**0.5
                edge = 0.5*(1-diameter)
                x_pos, y_pos = (x+edge)*scale, (y+edge)*scale
                box_edge = sample*diameter*scale
                draw.ellipse((x_pos, y_pos, x_pos + box_edge, y_pos + box_edge), fill=255)
        half_tone = half_tone.rotate(-angle, expand=1)
        width_half, height_half = half_tone.size
        xx=(width_half-im.size[0]*scale) / 2
        yy=(height_half-im.size[1]*scale) / 2
        half_tone = half_tone.crop((xx, yy, xx + im.size[0]*scale, yy + im.size[1]*scale))
        dots.append(half_tone)
        angle += 15
    return dots

im = Image.open("1_tree.jpg")

cmyk = gcr(im, 0)
dots = halftone(im, cmyk, 10, 1)
im.show()
new = Image.merge('CMYK', dots)
new.show() 
```

这将变成这样：

![在此处输入图像描述](../Images/9eb95e1fddabc79f3fae94c7b95f5cb6.png)

进入这个（模糊你的眼睛并远离显示器）：

![在此处输入图像描述](../Images/24122c3332e190d78799deed14270da9.png)

请注意，图像采样可以逐像素进行（从而在最终图像中保留原始图像的分辨率）。通过设置来做到这一点`sample=1`，在这种情况下，您需要设置`scale`一个更大的数字，以便有许多可能的点大小。这也将导致更大的输出图像大小（原始图像大小 * 比例 ** 2，所以要小心！）。

默认情况下，当您转换`RGB`为通道`CMYK`时`K`（黑色通道）为空。是否需要`K`通道取决于您的打印过程。您可能想要它的原因可能有多种：获得比重叠更好的黑色`CMY`、节省墨水、缩短干燥时间、减少墨水渗色等。总之我还写了一点[灰色组件替换](http://en.wikipedia.org/wiki/Grey_component_replacement)功能`GCR`，因此您可以设置`K`您想要替换重叠的频道百分比`CMY`（我在代码注释中进一步解释了这一点）。

这里有几个例子来说明。处理`letter F`来自图像的`sample=1`和`scale=8`，因此分辨率相当高。

4`CMYK`个通道，带有`percentage=0`，因此为空`K`通道：

![在此处输入图像描述](../Images/c0dc9df8876cf2dc0259bc158232366e.png)![在此处输入图像描述](../Images/9da285c5779ef1d7c0d24626f1befd08.png)![在此处输入图像描述](../Images/f6c423976aaa72d9ae3efe4eb04efb11.png)![在此处输入图像描述](../Images/f89d92dd04022cf840209edd1b874d85.png)

结合产生：

![在此处输入图像描述](../Images/cab8e5c40bfcc37385df9972cbb84c36.png)

`CMYK`通道，有`percentage=100`，所以`K`使用通道。您可以看到青色通道被完全抑制，品红色和黄色通道使用的墨水少得多，在图像底部的黑色带中：

![在此处输入图像描述](../Images/fb81456501f8cbce573de5beae178709.png)![在此处输入图像描述](../Images/47da588d48c2c0cf7f402c0393075d60.png)![在此处输入图像描述](../Images/2cb51cc57311a7df39b4cce651353072.png)![在此处输入图像描述](../Images/4b78f26465e394eb9d4e5eecbec67085.png)![在此处输入图像描述](../Images/ff9191a8e29bc5370af658907c1564f9.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-16T13:50:13.713

我的解决方案也使用 PIL，但依赖于内部支持的内部抖动方法 (Floyd-Steinberg)。但是会创建工件，所以我正在考虑重写它的 C 代码。

```
 from PIL import Image

    im  = Image.open('tree.jpg')             # open RGB image
    cmyk= im.convert('CMYK').split()         # RGB contone RGB to CMYK contone
    c = cmyk[0].convert('1').convert('L')    # and then halftone ('1') each plane
    m = cmyk[1].convert('1').convert('L')    # ...and back to ('L') mode
    y = cmyk[2].convert('1').convert('L')
    k = cmyk[3].convert('1').convert('L')

    new_cmyk = Image.merge('CMYK',[c,m,y,k]) # put together all 4 planes
    new_cmyk.save('tree-cmyk.jpg')           # and save to file 
```

隐式 GCR PIL 应用也可以扩展为更通用的，但我试图描述一个简单的解决方案，其中也忽略了分辨率和采样。

# php - 一个动作中的蛋糕 php 验证在另一个动作中可见

> ID：10572279
> 
> 赞同：2
> 
> 时间：2012-05-13T13:48:47.367
> 
> 标签：php, cakephp, cakephp-2.0

我有控制器`users`。在这个控制器中，我有一个不做任何事情的操作帐户 - 它只是有一个包含多个表单的视图 - 更改密码、更改某些内容、阻止帐户等。每个表单都链接到一些操作：`users/changepassword`等`users/changesomething`。这些操作不没有任何意见，只是`save(..)`在简单的过程中和最后的一些逻辑和验证`redirect->( array( 'action' => 'account' ) );`。总而言之 - 在用户/帐户视图中，有几种形式指向单独的操作。逻辑执行后的这些操作重定向回用户/帐户。

现在问题是我想查看提交的任何表单中的所有无效字段（根据验证规则） - 如果视图与控制器在相同的操作中，但当我使用重定向时，所有无效字段都丢失了 - 我怎么能解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T10:26:36.557

两种选择：

1）保存会话中的错误，重定向回帐户并再次设置它们。

2）更好的解决方案：将所有表单发布到您的帐户操作中，并在每个表单中包含一个包含类型或其他内容的隐藏字段。如果您正确遵循 MVC，则基于类型调用应该执行所有验证并保存工作的模型方法。

# c# - WP7 Periodic Agent - 与主应用程序共享命名空间？

> ID：10572281
> 
> 赞同：0
> 
> 时间：2012-05-13T13:49:06.763
> 
> 标签：c#, windows-phone-7, namespaces, scheduler

我的主应用程序中有一些代码调用 Web 服务并获取一些信息以放入动态磁贴中。我希望磁贴通过定期代理自动更新，但是我不想复制代码，我需要访问身份验证设置...

我可以将我的调度程序代理的命名空间更改为与我的主应用程序相同，以便我可以访问现有的代码/配置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:03:43.787

定期代理要求是您的主项目引用定期代理的项目。如果您忘记了这一步，那么您的代理将无法工作。

由于这个要求，你不能从代理中引用主项目，否则你会有循环引用。所以只要把你的公共代码放在代理的项目中，根据需要从主项目中使用。如果你想让事情变得更干净，你甚至可以创建第三个项目，它将被主项目和代理项目引用。

# java - Ant：多次替换源文件中的令牌

> ID：10572286
> 
> 赞同：0
> 
> 时间：2012-05-13T13:49:42.977
> 
> 标签：java, eclipse, ant, properties, build

我有一个带有常量的 Java 配置文件。

我正在使用 ant 根据构建替换常量的值。在预编译目标中：

```
<replace 
    file="Config.java"
    value="default"
    propertyFile="${build.env}.properties">
<replacefilter 
    token="@mytoken@" 
    property="myprop.x"/>
</replace> 
```

效果很好。但是在我运行这个之后，我的源文件被修改了。所以如果我再次运行它，它不会替换任何东西，因为@mytoken@ 第一次被替换了。

我不想将 Config.java 放在项目之外，因为我希望它可以与 eclipse 一起使用，并且如果文件不在预期的位置，则会出现很多编译错误。

我正在考虑替换后构建目标或其他东西，但不确定这是否安全。如果构建失败或用户中断脚本，它将不会运行并且值不会被设置回来。

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:22:07.737

当我不得不处理这项任务时，我采取了不同的方式。ant 脚本总是创建一个名为`Version.java`. `Version.java`永远不会签入存储库，但接口`Version`实现是。这样，您不必静态依赖于生成文件的存在。

```
public String getVersionHelper() {
  try {
    Class versionClass = Class.forName("Version");
    IVersion version = (IVersion) versionClass.newInstance() 
    return version.getVersion();
  } catch (ClassNotFoundException ex) {
    return "NO VERSION";
  }
} 
```

关键是官方的构建总是用ant而不是eclipse完成的。这允许您在 eclipse 中运行以进行测试，并且仍然可以成功编译。

# cmake - 使用 CMake 的 find_package(PCL 1.2 REQUIRED) 返回错误的路径

> ID：10572287
> 
> 赞同：6
> 
> 时间：2012-05-13T13:49:56.553
> 
> 标签：cmake, point-cloud-library

我正在使用 Ubuntu 12.04 机器，但遇到以下问题：我正在尝试使用 CMake 编译和构建 C++ 文件，但是当我在“cmake ..”之后给出命令“make”时，出现错误：

> pcl_openni_grabber.cpp:2:29：致命错误：pcl/point_cloud.h：没有此类文件或目录编译终止。

现在我的 CMakeLists.txt 如下：

```
cmake_minimum_required(VERSION 2.8 FATAL_ERROR)

project(pcl-openni-grabber)

find_package(PCL 1.2 REQUIRED)

include_directories(${PCL_INCLUDE_DIRS})
link_directories(${PCL_LIBRARY_DIRS})
add_definitions(${PCL_DEFINITIONS})

add_executable (pcl_openni_grabber pcl_openni_grabber.cpp)
target_link_libraries (pcl_openni_grabber ${PCL_LIBRARIES}) 
```

其中环境变量 PCL_INCLUDE_DIRS 包含：

```
/usr/include/pcl-1.5 
```

现在经过 2 个小时的工作来了解问题，我在命令 find_package() 中找到了它。实际上，当我运行“cmake ..”时，它会将错误的路径返回到 pcl 库（点云库）。事实上，这是“cmake ..”的输出：

```
-- The C compiler identification is GNU
-- The CXX compiler identification is GNU
-- Check for working C compiler: /usr/bin/gcc
-- Check for working C compiler: /usr/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- checking for module 'eigen3'
--   found eigen3, version 3.0.5
-- Found eigen: /usr/include/eigen3 
-- Boost version: 1.46.1
-- Found the following Boost libraries:
--   system
--   filesystem
--   thread
--   date_time
--   iostreams
-- checking for module 'flann'
--   found flann, version 1.7.1
-- Found Flann: /opt/ros/fuerte/lib/libflann_cpp_s.a 
-- checking for module 'openni-dev'
--   found openni-dev, version 1.5.2.23~precise
-- Found openni: /usr/lib/libOpenNI.so 
-- Found libusb-1.0: /usr/include 
-- Found qhull: /usr/lib/libqhull.so 
-- looking for PCL_COMMON
-- Found PCL_COMMON: /opt/ros/fuerte/lib/libpcl_common.so 
-- looking for PCL_KDTREE
-- Found PCL_KDTREE: /opt/ros/fuerte/lib/libpcl_kdtree.so 
-- looking for PCL_OCTREE
-- Found PCL_OCTREE: /opt/ros/fuerte/lib/libpcl_octree.so 
-- looking for PCL_SEARCH
-- Found PCL_SEARCH: /opt/ros/fuerte/lib/libpcl_search.so 
-- looking for PCL_SAMPLE_CONSENSUS
-- Found PCL_SAMPLE_CONSENSUS: /opt/ros/fuerte/lib/libpcl_sample_consensus.so 
-- looking for PCL_FILTERS
-- Found PCL_FILTERS: /opt/ros/fuerte/lib/libpcl_filters.so 
-- looking for PCL_TRACKING
-- Found PCL_TRACKING: /opt/ros/fuerte/lib/libpcl_tracking.so 
-- looking for PCL_IO
-- Found PCL_IO: /opt/ros/fuerte/lib/libpcl_io.so 
-- looking for PCL_FEATURES
-- Found PCL_FEATURES: /opt/ros/fuerte/lib/libpcl_features.so 
-- looking for PCL_REGISTRATION
-- Found PCL_REGISTRATION: /opt/ros/fuerte/lib/libpcl_registration.so 
-- looking for PCL_SEGMENTATION
-- Found PCL_SEGMENTATION: /opt/ros/fuerte/lib/libpcl_segmentation.so 
-- looking for PCL_SURFACE
-- Found PCL_SURFACE: /opt/ros/fuerte/lib/libpcl_surface.so 
-- looking for PCL_VISUALIZATION
-- Found PCL_VISUALIZATION: /opt/ros/fuerte/lib/libpcl_visualization.so 
-- looking for PCL_KEYPOINTS
-- Found PCL_KEYPOINTS: /opt/ros/fuerte/lib/libpcl_keypoints.so 
-- Found PCL: /usr/lib/libboost_system-mt.so;/usr/lib/libboost_filesystem-mt.so;/usr/lib/libboost_thread-mt.so;pthread;/usr/lib/libboost_date_time-mt.so;/usr/lib/libboost_iostreams-mt.so;optimized;/opt/ros/fuerte/lib/libpcl_common.so;debug;/opt/ros/fuerte/lib/libpcl_common.so;optimized;/opt/ros/fuerte/lib/libflann_cpp_s.a;debug;/opt/ros/fuerte/lib/libflann_cpp_s-gd.a;optimized;/opt/ros/fuerte/lib/libpcl_kdtree.so;debug;/opt/ros/fuerte/lib/libpcl_kdtree.so;optimized;/opt/ros/fuerte/lib/libpcl_octree.so;debug;/opt/ros/fuerte/lib/libpcl_octree.so;optimized;/opt/ros/fuerte/lib/libpcl_search.so;debug;/opt/ros/fuerte/lib/libpcl_search.so;optimized;/opt/ros/fuerte/lib/libpcl_sample_consensus.so;debug;/opt/ros/fuerte/lib/libpcl_sample_consensus.so;optimized;/opt/ros/fuerte/lib/libpcl_filters.so;debug;/opt/ros/fuerte/lib/libpcl_filters.so;optimized;/opt/ros/fuerte/lib/libpcl_tracking.so;debug;/opt/ros/fuerte/lib/libpcl_tracking.so;/usr/lib/libOpenNI.so;vtkCommon;vtkRendering;vtkHybrid;optimized;/opt/ros/fuerte/lib/libpcl_io.so;debug;/opt/ros/fuerte/lib/libpcl_io.so;optimized;/opt/ros/fuerte/lib/libpcl_features.so;debug;/opt/ros/fuerte/lib/libpcl_features.so;optimized;/opt/ros/fuerte/lib/libpcl_registration.so;debug;/opt/ros/fuerte/lib/libpcl_registration.so;optimized;/opt/ros/fuerte/lib/libpcl_segmentation.so;debug;/opt/ros/fuerte/lib/libpcl_segmentation.so;optimized;/usr/lib/libqhull.so;debug;/usr/lib/libqhull.so;optimized;/opt/ros/fuerte/lib/libpcl_surface.so;debug;/opt/ros/fuerte/lib/libpcl_surface.so;optimized;/opt/ros/fuerte/lib/libpcl_visualization.so;debug;/opt/ros/fuerte/lib/libpcl_visualization.so;optimized;/opt/ros/fuerte/lib/libpcl_keypoints.so;debug;/opt/ros/fuerte/lib/libpcl_keypoints.so (Required is at least version "1.2")
-- Configuring done
-- Generating done
-- Build files have been written to: /home/jacopo/dev/university/prova/build 
```

如您所见，它返回通过 Synaptic 包管理器安装在“/opt/ros”目录中的特定 ros（机器人操作系统）包的 pcl 库的路径。正确的 pcl 库和包含在“/usr/include/pcl.1.5”和“/usr/lib”中。

卸载 ros 时，find_package 返回正确的路径，我可以毫无问题地编译和构建。但是因为我需要 ros 上大学，同时我需要 cmake，我如何让 cmake 在安装了 ros 的情况下工作？任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-13T14:31:01.950

[`find_package`](http://www.cmake.org/cmake/help/v2.8.8/cmake.html#command:find_package)您可以在命令中微调搜索路径：

```
find_package(PCL 1.2 REQUIRED PATHS /usr NO_DEFAULT_PATH) 
```

这可能有点蛮力；`/opt`当 CMake 搜索包时，您可能会找到一种更好的方法来排除考虑。

顺便说一句，您可能不应该使用[`link_directories`](http://www.cmake.org/cmake/help/v2.8.8/cmake.html#command:link_directories). 该文档说明了为什么通常不需要它。

# jquery - 将 Datepicker 放入对话框 jquery

> ID：10572290
> 
> 赞同：0
> 
> 时间：2012-05-13T13:50:25.947
> 
> 标签：jquery, datepicker

我真的需要一些帮助！我想创建一个输入字段，当我的访问者单击输入字段时，会显示一个对话框。在这个对话框中，我想实现一个日期选择器，一个带有名称、电话号码和提交按钮的表单。

我试过这样做，但我想我把我的代码搞混了。有人可以帮我写这种泡菜的代码吗？:)

我主要关心的是如何让日期选择器和表单进入对话框。我已经创建了日期选择器和表单，但我不知道如何编写代码以便将它们放入对话框中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T13:53:41.543

看看像[这样](http://jqueryui.com/demos/datepicker/)的 jQuery ui 插件。
如果您想使用[原生 html5 日期选择器](http://www.w3.org/TR/html-markup/input.date.html)，只需将属性添加`type="date"`到您的输入中：

```
Birthday: <input type="date" name="bday" /> 
```

# javascript - 优化多个变量

> ID：10572296
> 
> 赞同：-1
> 
> 时间：2012-05-13T13:51:31.677
> 
> 标签：javascript, jquery, variables

我将尝试使用 jQuery 添加一个类。

```
var tit = ('.tit a');
txt_animal = ['pig','horse','rabbit','cat','monkey'];
txt_fruit = ['melon','apple','kiwi','orange'];
txt_hobby = ['movie','ski','swim','dance','internet','baseball'];

$(txt_animal).each(function(i,v){
    $(tit + ':contains("'+ v +'")').addClass('tag tag_animal');
}
$(txt_fruit).each(function(i,v){
    $(tit + ':contains("'+ v +'")').addClass('tag tag_fruit');
}
$(txt_hobby).each(function(i,v){
    $(tit + ':contains("'+ v +'")').addClass('tag tag_hobby');
} 
```

它工作正常。但我认为比这更好的方法。
如何优化 javascript 以获得最佳性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:33:06.377

改为针对 DRY 进行优化。

```
var tit = ('.tit a');
var txt = {
  "animal": ['pig','horse','rabbit','cat','monkey'],
  "fruit": ['melon','apple','kiwi','orange'],
  "hobby": ['movie','ski','swim','dance','internet','baseball']
};

for (var cat in txt) {
  $(txt[cat]).each(function(i,v){
    $(tit + ':contains("'+ v +'")').addClass('tag tag_' + cat);
  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:55:21.800

下面的代码应该避免重复（和昂贵的）DOM 查询*和*通过可能匹配的重复迭代，通过对每个标签类使用正则表达式。

```
var txt = {
  animal: /(pig|horse|rabbit|cat|monkey)/i,
  fruit: /(melon|apple|kiwi|orange)/i,
  hobby: /(movie|ski|swim|dance|internet|baseball)/i
};

$('.tit a').each(function() {
    var $this = $(this);       // saves three calls to `$(this)`
    var t = $this.text();      // get the text contents of the link

    for (var tag in txt) {     // for each key word
       if (txt[tag].test(t)) { // test the text against the regexp
           $this.addClass('tag').addClass('tag_' + tag);
       }
    }
}); 
```

见[http://jsfiddle.net/alnitak/DFcFH/1/](http://jsfiddle.net/alnitak/DFcFH/1/)

# simperium - 将现有数据“导入”到 Simperium

> ID：10572299
> 
> 赞同：0
> 
> 时间：2012-05-13T13:51:54.087
> 
> 标签：simperium

打开现有数据库并随后启动 simperium 时，现有实体不会加载到服务器。仅加载新创建的实体。

是否可以将 Simperium 添加到现有数据库并将所有尚未加载的实体上传到服务器？我正在考虑将 Simperium 添加到必须在首次启动时上传当前数据的现有应用程序中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T04:55:28.130

这是为了得到支持（并且已经在应用程序 Simplenote 中完成），但可能有一些东西不起作用。

当您的应用程序启动时，您是否会看到一条日志消息，其中显示您希望 Simperium 看到的现有实体显示“Simperium 管理 X MyEntity 实例”？X 是否与数据库中现有对象的数量相匹配？

Simperium 在启动时执行验证步骤。如果在您的模型中检测为子类的任何现有对象`SPManagedObject`都缺少有效的 simperiumKey，则会创建一个。

目前，此验证过程不会自动保存生成的新密钥。您是否尝试在 Simperium 首次启动后保存您的上下文以查看是否会触发更新？

此外，如果它有帮助，还有一个未记录的方法`getSimperiumKeyFromLegacyKey`，如果您希望在此验证过程中保留在 Simperium 中的现有唯一 ID，您可以在您的对象子类上实现该方法。

# ios - TWTweetComposeViewController 中“发件人：”字段的默认值

> ID：10572300
> 
> 赞同：0
> 
> 时间：2012-05-13T13:51:56.773
> 
> 标签：ios, twitter

如果用户在其设备上设置了 >1 个 Twitter 帐户，我希望能够控制哪个帐户用户名是 TWTweetComposeViewController 中 From 字段的默认值。

目前，它似乎默认为系统上的第一个 Twitter 帐户，我看不出有什么办法可以改变它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T08:42:01.020

据我所知，除了添加图像、链接和初始文本之外，我无法操纵 TWTweetComposeViewController。苹果对此非常清楚：

> 尽管您可以代表用户执行 Twitter 请求，但您不能在用户不知情的情况下将文本、图像或 URL 附加到推文。因此，您可以在将推文呈现给用户之前设置初始文本和其他内容，但在用户查看推文后无法更改推文

我知道预先选择用户帐户并不是反对它，但是在类参考中我看不到更改帐户的方法。这完全取决于用户。

[http://developer.apple.com/library/ios/#DOCUMENTATION/Twitter/Reference/TWTweetSheetViewControllerClassRef/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/Twitter/Reference/TWTweetSheetViewControllerClassRef/Reference/Reference.html)

我有一个类似的问题。我正在尝试获取推文后使用的帐户。TWTweetComposeViewController 似乎记得最后一个用来发推文的帐户。如果有人知道...

# javascript - aspx 与 html 性能

> ID：10572307
> 
> 赞同：1
> 
> 时间：2012-05-13T13:53:15.787
> 
> 标签：javascript, asp.net, html, performance

在我的 asp.net 项目中，我有一些只是 html 和 JavaScript 的页面，它们具有 aspx 扩展名。现在我想知道将它们制作成 html 文件（而不是 aspx）是个好主意吗？是否影响性能，不是很重要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:01:28.983

**Html**总是比 aspx 运行得快，因为**aspx**必须在服务器端处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:09:38.613

您可以只为这些页面打开缓存，它们会运行得更快，可能与 html 一样。但是如果您使用的是 IIS 6，那么 html 肯定会更快，因为 IIS 6 将直接提供 html 文件，并将转到整个 asp.net 架构来提供服务。IIS 7 总是使用 asp.net 架构。

# c# - 当整个 Web 应用程序驻留在单个服务器上时，是否需要 DTO？

> ID：10572312
> 
> 赞同：1
> 
> 时间：2012-05-13T13:53:49.010
> 
> 标签：c#, entity-framework, dto, n-tier-architecture

我已经开始研究将驻留在单个服务器（包括数据库）上的 WebForms（不是 MVC）应用程序，并决定使用（我认为）非常标准的 N 层架构来设计它。

## 数据层

*   使用实体框架 4 和通用存储库/工作单元模式。

*   将广泛使用存储过程（这是权力赋予我的要求）。

*   持有对业务对象层的引用，以将数据传入/传出 BO。

## 业务对象“层”

*   代码优先的 POCO。
*   他们将拥有的唯一行为是验证内容（名称不为空，数量必须为正整数等）。
*   不引用任何其他层或关心数据的来源。

## 业务逻辑层

*   包含我的业务服务，它将充当 UI 和数据层之间的中间人，并执行其他业务“规则”，例如记录更改时的电子邮件通知等。

*   具有对数据层和业务对象层的引用。
*   将 BO 传入/传出 UI。

## 界面层

*   包含所有常见的 UI 内容 - Web 表单、javascript、样式表等。
*   引用业务逻辑和业务对象层。

几个问题......好吧，实际上很多：/

1.  当应用程序要跨多个服务器，将使用 Web 服务，或者当传递给视图的数据是多种类型的业务对象的编译时，我可以看到使用 DTO 的优势，但是真的需要当所有东西都在同一台物理机器上时，将所有 BO 转换为 DTO，然后在 BLL 和 UI 之间传递它们？大多数 DTO 都是“复制、粘贴、将‘DTO’添加到类名末尾”的事情，所以这似乎是一种毫无意义的浪费时间？我最终得到的只是更高的维护成本和稍慢的性能（现在必须用相同的代码更新两个类而不是一个）。
2.  假设在某些情况下需要 DTO，是否可以向 DTO 添加验证（即：名称不能为空，数量必须是正整数等）。？
3.  使用 FluentValidation 之类的东西将验证代码分离到它自己的类库中是最好/更好的做法吗？如果我这样做了，那么 BO 基本上会变成 DTO，因为它们的行为为零……在这种情况下，我似乎最终会得到一个贫血的域模型？
4.  当 BO 被 EF 使用时，数据层是否可以引用业务对象层？
5.  看到我的服务“Find(predicate)”和“FindAll()”方法将使用相同的存储过程（提取所有记录），这是否意味着执行以下操作：

    ```
    List<Foo> myFoo = FooService.Find( f => f.Country == "Australia" && f.Status = OrderStatus.New ); 
    ```

实际上会通过存储过程提取所有记录，并在事后执行过滤吗？在这种情况下，如何使用只检索所需记录的存储过程，同时允许使用 linq 表达式（需要允许 &&、||、！= 等）？这甚至是可能的吗（无需放弃存储过程）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:06:41.453

如果它是一个单一的应用程序，我认为它是一个过度架构。在 YAGNI 和 DRY 之后，只需让您的服务返回 BO。我还建议在使用 WebForms 时使用 MVP 模式，甚至避免使用“服务层”，而只使用域驱动设计 (DDD)。

[http://en.wikipedia.org/wiki/Domain-driven_design](http://en.wikipedia.org/wiki/Domain-driven_design)

[http://en.wikipedia.org/wiki/Don](http://en.wikipedia.org/wiki/Don) 't_repeat_yourself

[http://en.wikipedia.org/wiki/You_ain](http://en.wikipedia.org/wiki/You_ain) 't_gonna_need_it

[http://www.codeproject.com/Articles/23562/Building-an-MVP-Framework-for-NET-Part-1-The-Basic](http://www.codeproject.com/Articles/23562/Building-an-MVP-Framework-for-NET-Part-1-The-Basic)

MVP 真的很容易实现。解释总是充满组件和箭头，示例实现总是试图让事情变得复杂（我不知道为什么），但它确实是一种简单的关注点分离模式，它确实有效:)

希望能帮助到你 ：）

# asp.net - 对于非 ASCII 字符，我需要 web.config 吗？

> ID：10572314
> 
> 赞同：7
> 
> 时间：2012-05-13T13:54:03.613
> 
> 标签：asp.net, .net, iis, encoding, utf-8

尝试制作我的第一个 ASP.NET 页面。在 XP 上安装了 IIS 5.1，配置为运行 .NET 4。创建了一个新的虚拟目录并添加了一个 .aspx 文件。当我浏览文件时，非 ASCII 字符已损坏。例如，将 ü (U+00FC) 转换为 Ã¼ (U+00C3 U+00BC)，这是 I-don't-get-this-is-UTF-8 等价物。

我尝试了各种方法来利用它：

1.  我确保 .aspx 文件确实被编码为 UTF-8。
2.  我设置了元标记：

    `<meta charset="UTF-8">`

3.  `text/html;charset=utf-8`我将虚拟目录设置为在 IIS 中的 HTTP 标头 > 文件类型下处理 .aspx 。

4.  我添加`ResponseEncoding="utf-8"`到`<%@ Page ... %>`.
5.  我将字符串插入`HttpUtility.HtmlEncoded()`. 现在 ü 被转换为 ü (U+00C3 U+00BC)。

最后，我找到了两种有效的方法：

1.  用字符引用替换非 ASCII 字符，例如`&#252;`这在 90 年代还可以，而不是今天。
2.  将 web.config 文件添加到虚拟目录，其中包含以下内容：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <configuration>
      <system.web>
        <globalization fileEncoding="utf-8"/>
      </system.web>
    </configuration> 
    ```

如果不`fileEncoding`进行设置，ASP.NET 解析器将读取 .aspx 并破坏每个非 ASCII 字符，而不会尝试推断文件编码。这只是你的专业人士已经学会忍受的东西，还是我错过了什么？具有全球化设置*的*web.config 文件是处理 .aspx 页面上的“国际”字符的方式吗？我不记得 PHP 有过类似的问题，所以我很困惑为什么 ASP.NET 会出现这种问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T16:05:59.270

要使用非 ASCII 字符，您需要具备两个条件。使用 UTF-8 保存文件，为此文件选择此编码，并确保您的**web.config中有这些设置**

```
<globalization requestEncoding="utf-8" responseEncoding="utf-8"  fileEncoding="utf-8" /> 
```

请注意，在 ASP.NET 上总是有一个 web.config。有一个全局的也有这些设置并位于 asp.net 目录`{drive:}\WINDOWS\Microsoft.NET\Framework\{version}\CONFIG\`中，然后是您项目中的 web.config 。有时，全局设置来自当前国家/地区的编码。在这种情况下，您需要在项目中将其设置回 UTF-8。

您已经找到了所有这些，我只是指出了 3 个设置：

1.  使用 unicode 保存文件。
2.  设置 requestEncoding="utf-8"
3.  设置 responseEncoding="utf-8"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-02T09:32:38.397

你有三个选择。

选项 1 - 要么对所有不适合 ASCII 的字符进行实体编码，要么将它们替换为外观相似的 ASCII 等价物。这是容易出错且难以维护的。下次您必须合并一大段文本时，您可能会忘记检查包含的部分，并且它再次“看起来很垃圾”。

选项 2 - 将 .aspx 保存为“带有 BOM 的 UTF-8”。此类文件会自动正确处理 - 在web.config 部分的`fileEncoding`属性描述中记录。`system.web/globalization`这也很难维护 - 下次您将文件重新保存为“UTF-8”（没有 BOM）时，它再次“看起来很垃圾”，它可能会被忽视。当您添加新的 .aspx 文件时，您必须检查它们是否也保存为“带有 BOM 的 UTF-8”。这种方法容易出错 - 例如，一些文件比较工具不显示添加/删除 BOM（至少在默认设置下）。

选项 3 - 确保文件保存为“UTF-8”或“UTF-8 with BOM”，同时将web.config 部分的`fileEncoding`属性设置为. 此属性的默认值为“单字节字符编码”，因此保存为 UTF-8 的非 ASCII 字符的文件处理不当，结果“看起来很垃圾”。这是最易于维护的方法 - 它易于查看和验证，并且在重新保存文件时不会随机中断。是三个属性中唯一一个默认为“单字节字符编码”的属性 -并且默认为在大多数情况下无需更改（或设置）它们，设置通常就足够了。`system.web/globalization``utf-8``fileEncoding``???Encoding``responseEncoding``requestEncoding``utf-8``fileEncoding`

# simperium - Simperium 尝试为 nil 键发送对象更改

> ID：10572316
> 
> 赞同：0
> 
> 时间：2012-05-13T13:54:19.467
> 
> 标签：simperium

是什么`Simperium tried to send object changes for nil key`意思，我该如何调试/修复它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T17:34:16.027

如果对象没有`simperiumKey`. 需要检查的一些事项：

1.  您的实体是否继承自模型文件（通常为 SPManagedObject）中具有`simperiumKey`String 类型属性的父实体？

2.  您的实体的类是否设置为`SPManagedObject`？或者，如果您使用的是自定义子类，您是否更新了子类的头文件以继承`SPManagedObject`而不是`NSManagedObject`？

3.  如果您手动将`simperiumKey`属性添加到模型（例如，对表进行微观管理：[从 SPManagedObject 继承](https://stackoverflow.com/questions/10565002/inherit-from-spmanagedobject)），您可能还需要手动将`simperiumKey`和`ghostData`变量添加到自定义子类（如果有的话）。

我们还将改进日志消息，让您更好地了解在这种情况下发生的情况。

# java - 在简单的测验应用程序中在窗口之间导航

> ID：10572317
> 
> 赞同：-1
> 
> 时间：2012-05-13T13:54:19.740
> 
> 标签：java

我必须在 JAVA 中制作一个简单的测验应用程序，我不知道如何在窗口之间导航，例如，如何转到下一个问题或如何返回。每个窗口我都有一个问题。你能给我一个关于如何导航的想法吗？我应该使用 repaint() 还是 CardLayout 或其他什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:16:08.407

如果测验是多项选择题，您还有其他选择：更改问题（可能是 JRadioButtons）显示的数据。否则，我投票支持 CardLayout。此外，如果您希望用户能够轻松地回到其他问题，您可以使用 JScrollPane 持有的 JPanel 将它们全部显示为 GridLayout 中的 JPanel。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:00:39.297

是的 CardLayout 可能是一个好主意，如果您需要一些示例，请查看[oracle how to](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)。

# c# - 自定义文件类型使用什么文件扩展名？

> ID：10572319
> 
> 赞同：0
> 
> 时间：2012-05-13T13:55:13.370
> 
> 标签：c#, windows, file-extension, file-association

我有一个程序可以在使用过程中创建某些保存文件。从技术上讲，它们是 XML 文件，但是我不想使用`.xml`扩展名，因为我将修改 shell，以便在资源管理器中双击文件时打开我的程序。

关于我可以有效“发明”哪些文件扩展名有什么指导吗？我在任何地方都找不到任何官方指南。

我想使用`.senx`，但我不知道这样做是否安全？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-13T13:58:51.447

没有文件扩展名的“官方”注册表（尽管可能应该有）。

互联网搜索将显示几个不同的站点，其中包含各种应用程序常用的文件扩展名的非官方列表，但如果你这样做，几乎没有任何文件扩展名可供选择。

重要的是要弄清楚您的目标受众可能安装了哪些应用程序，然后确保您的自定义文件扩展名不会与其中任何一个冲突。（如果*必须*这样做，您还*必须*为用户提供恢复文件扩展名关联的选项，并且最好在安装期间将其设为可配置选项。）

请记住，您没有理由将自己限制为三个甚至四个字符的文件扩展名。您可以根据需要使用任意数量，这会成倍增加您的选择独一无二的可能性。例如，Visual Studio 将其环境设置保存在一个`.vssettings`文件中；任何其他应用程序都不太可能很快与它发生冲突。

其实这是[微软官方的建议](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144156.aspx)：

> ### 不要使用短文件扩展名
> 
> 长文件扩展名具有以下优点：
> 
> *   短扩展的有限长度使它们容易发生扩展冲突。当使用相同的扩展名对多种文件类型进行分类时，会发生扩展名冲突。使用长扩展显着降低了冲突的机会。
>     
>     
> *   短文件名往往有点神秘。长扩展往往更有意义，因为可以在扩展中嵌入附加信息。
>     
>     
> 
> 有关详细信息，请参阅[文件扩展名](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144146.aspx)。

# c# - 异步读取标准输出到字节数组

> ID：10572320
> 
> 赞同：0
> 
> 时间：2012-05-13T13:55:13.477
> 
> 标签：c#, bytearray, stdout

我一直试图让这个与这里的几个教程/答案一起工作，但不幸的是无法这样做。

我想做的是执行一个进程，捕获它的 DefaultOutput 并将其添加到一个字节数组中。到目前为止我得到的是：

```
private void startProcess(string path, string arguments)
{
    Process p = new Process();
    p.StartInfo.FileName = path;
    p.StartInfo.Arguments = arguments;
    p.StartInfo.UseShellExecute = false;
    p.StartInfo.CreateNoWindow = false;
    p.StartInfo.RedirectStandardOutput = true;
    p.StartInfo.RedirectStandardError = true;
    p.OutputDataReceived += p_OutputDataReceived;
    p.EnableRaisingEvents = true;
    p.Start();
    p.BeginErrorReadLine();
    p.BeginOutputReadLine();
    p.WaitForExit();
}

void p_OutputDataReceived(object sender, DataReceivedEventArgs e)
{
    string str = e.Data;
    // what goes here?!
} 
```

我现在的问题是：如何将这些数据添加到（增长的）字节数组中，或者是否有另一种更适合此目的的数据类型？另外我不确定在哪里声明这个目标字节数组，最好是在`startProcess`方法中的某个地方，这样我就可以在进程退出后继续处理数据，但是我怎么能把它传递给`p_OutputDataReceived`呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-23T15:10:59.340

数组在 C# 中是不可变的，因此您不能拥有*不断增长的*数组。这`List<T>`就是为了。

如果您不关心字符编码，只需执行以下操作：

```
List<byte> OutputData = new List<byte>(); //global

void p_OutputDataReceived(object sender, DataReceivedEventArgs e)
{
    string str = e.Data;
    byte[] bytes = new byte[str.Length * sizeof(char)];
    System.Buffer.BlockCopy(str.ToCharArray(), 0, bytes, 0, bytes.Length);
    OutputData.AddRange(bytes);
} 
```

如果您想要显式编码：

```
void p_OutputDataReceived(object sender, DataReceivedEventArgs e)
{
    string str = e.Data;
    byte[] bytes = Encoding.ASCII.GetBytes(str); //or replace ASCII with your favorite
    //encoding
    OutputData.AddRange(bytes);
} 
```

如果您在完成后真的想要一个字节数组，只需执行以下操作：

```
byte[] OutputDataAry = OutputData.ToArray(); 
```

老实说，我认为`List<string>`这会是一种更清洁的方法，但你要求 a`byte[]`所以我给你一个`byte[]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:04:29.777

你可以试试内存流；它真的做了你想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-21T20:02:35.447

如果您想一次阅读整个输出，以下代码将帮助您...

```
 static void Main(string[] args)
    {
        StreamReader reader;

        Process p = new Process();
        p.StartInfo.FileName = "cmd";
        p.StartInfo.Arguments = "/c echo hi";

        p.StartInfo.UseShellExecute = false;
        p.StartInfo.StandardOutputEncoding = Encoding.UTF8;
        p.StartInfo.RedirectStandardOutput = true;
        p.Start();
        reader = p.StandardOutput;

        byte[] result = Encoding.UTF8.GetBytes(reader.ReadToEnd());

        Console.WriteLine(result.ToString());
        Console.WriteLine(Encoding.UTF8.GetString(result));
        Console.ReadLine();
    } 
```

如果不是，您必须调用 ReadToEnd 以外的其他方法并在线程中使用 StreamReader 来连续读取数据...而不是字节数组，如果您想要不断增长的集合，您可以使用列表或类似的东西...检查与其他线程结合的同步集合[http://msdn.microsoft.com/en-us/library/ms668265(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ms668265(v=vs.110).aspx)

# php - 高端 Node.js 框架

> ID：10572322
> 
> 赞同：4
> 
> 时间：2012-05-13T13:55:55.407
> 
> 标签：php, javascript, node.js

我对 Node.js 世界有点陌生。但是我尝试了一些 Node.js 框架，比如 Express.js，不幸的是，它们都没有满足我的要求。

由于我是 PHP 本地人，我一直在寻找一些类似于 Symfony、CodeIgnitier、CakePHP 等的框架。

基本上，我不是在寻找允许“仅”路由、支持 MVC 的低端框架，它或多或少是一切。

我希望在强大的 Web 应用程序框架中看到支持模板系统、易于处理的 HTML 表单、用户身份验证/授权、会话、缓存、电子邮件、一些低端 ORM 等（主要是具有高-结束 PHP 框架）

我知道，Node.js 是一种新技术，但是有没有一些框架，它是这样发展的？你知道一些发行版吗？或者一些团体（论坛），在那里人们创建和讨论这样的事情？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T17:35:34.183

我会把你送到[Flatiron](http://flatironjs.com)，因为它是一个很棒的框架，但我认为你正在寻找（我敢说吗？）[Tower.js](http://towerjs.org/)。但是，我强烈建议从大型 npm 模块数据库中选择最适合您需求的模块。Flatiron 非常适合这一点，因为它由一组模块组成，每个模块都执行特定的操作，并将这些模块在`flatiron`模块中联系在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-14T08:23:40.223

[您可以在站点nodeframeworks](http://nodeframework.com/)上找到一些最常用的 Node.js 全栈框架。如果您喜欢 OOP 和 Symfony 的依赖注入（带有服务），请查看[Danf](https://github.com/gnodi/danf)（相反，不要期望像现在那样拥有 Symfony 的所有功能）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:01:10.110

您提到的一些功能实际上在 express.js 中。我认为在 PHP/Ruby/Python 中没有任何功能齐全的框架。好消息是 Node.js 是 Javascript，它是一种非常简单的语言。因此，如果您在 express.js 之上需要额外的东西，那么做到这一点应该不难。虽然不是每个开发人员都喜欢这个，但我喜欢编写自己的小模块来解决某些问题。

# c# - 如何使用相对路径将本地 *.htm 文件加载到 WPF WebBroswer

> ID：10572325
> 
> 赞同：3
> 
> 时间：2012-05-13T13:56:24.350
> 
> 标签：c#, wpf, browser

> **可能重复：**
> [在 C# WebBrowser 中加载本地 HTML 文件](https://stackoverflow.com/questions/7194851/load-local-html-file-in-a-c-sharp-webbrowser)

我正在用 C#（VS 2010）创建程序，我想显示帮助文件。我创建了文件 help.htm。此文件包含在帮助目录中的解决方案中。我希望这个 htm 文件在 Dialog 中加载到 webBroswer。但是有一个问题，当我尝试使用相对路径时。

```
 HelpWindow helpwin = new HelpWindow(); //creating new window

            Uri helpUri = new Uri ("help\\pm_view.htm",UriKind.RelativeOrAbsolute); //setting path

            helpwin.webBrowser.Navigate(helpUri); //navigating webBroswer 
```

之后，我收到错误：不允许使用相对 URI。参数名称：来源

图片中有我的 C# 解决方案架构：

![在此处输入图像描述](../Images/8e55bd98700c076a37512faaaf92e34b.png)

请问有人可以帮忙吗？！

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:51:12.367

您是否尝试过使用

> Path.GetFullPath(YourRelativePath)

根据这个答案：[回答 WPF 中的相对路径](https://stackoverflow.com/a/3342049/169334)？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-13T14:56:43.730

我为此写了一篇短文：[WebBrowserEx: WinForms WebBrowser + HTTP Server](http://simplygenius.net/Article/WebBrowserEx)

该代码适用于 WinForms，但您可以为 WPF 修改它。

# solr - solr 的建议者给出“SolrException：未知搜索组件：org.apache.solr.core.SolrCore 的拼写检查”

> ID：10572327
> 
> 赞同：3
> 
> 时间：2012-05-13T13:56:35.293
> 
> 标签：solr

我尝试使用 Solr 的`Suggester`组件，但它给出了异常`Unknown Search Component: spellcheck`。我正在使用 solr 3.6 版。我做了更改，`solrconfig.xml`所以看起来像这样

```
<searchComponent class="solr.SpellCheckComponent" name="suggester">
 <lst name="spellchecker">
      <str name="name">suggester</str>
      <str name="field">name</str>
      <str name="classname">org.apache.solr.spelling.suggest.Suggester</str>
      <str name="lookupImpl">org.apache.solr.spelling.suggest.tst.TSTLookup</str>
      <float name="threshold">0.005</float>
      <str name="buildOnCommit">true</str>
      <str name="spellcheckIndexDir">spellchecker</str>
 </lst> 
</searchComponent>

<requestHandler class="org.apache.solr.handler.component.SearchHandler" name="/suggester">
  <lst name="defaults">
  <str name="spellcheck">true</str>
  <str name="spellcheck.dictionary">suggester</str>
  <str name="spellcheck.count">10</str>
  </lst>
  <arr name="components">
  <str>suggester</str>
  </arr>
</requestHandler> 
```

现在我保存了它并启动了 solr，但它给出了一个`500`错误。有一个长的堆栈跟踪是这样的

```
HTTP Status 500 - Severe errors in solr configuration. Check your log files for more detailed information on what may be wrong. If you want solr to continue after configuration errors, change: <abortOnConfigurationError>false</abortOnConfigurationError> in solr.xml ------------------------------------------------------------- org.apache.solr.common.SolrException: No cores were created, please check the logs for errors at org.apache.solr.core.CoreContainer$Initializer.initialize(CoreContainer.java:172) at org.apache.solr.servlet.SolrDispatchFilter.init(SolrDispatchFilter.java:96) at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:295) at 
```

---很多行---

还有一些

```
Caused by: org.apache.solr.common.SolrException: Unknown Search Component: spellcheck at org.apache.solr.core.SolrCore.getSearchComponent(SolrCore.java:893) at org.apache.solr.handler.component.SearchHandler.inform(SearchHandler.java:118) at org.apache.solr.core.SolrResourceLoader.inform(SolrResourceLoader.java:527) at org.apache.solr.core.SolrCore.<init>(SolrCore.java:594) ... 32 more 
```

根据堆栈跟踪，Solr 无法找到该`spellcheck`组件，但根据 Solr wiki，该组件带有 Solr 版本 > 1.4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:35:56.260

您似乎已经命名了您的搜索组件`suggester`，并且您的 requestHandler 正确地引用了它，所以这可能不是问题所在。您能否检查 solrconfig.xml 的其余部分是否**有其他 requestHandler**引用了`spellcheck`在其 last-components 部分或其他地方命名的组件？这将引发错误，因为它无法再找到具有该名称的组件（它已重命名为`suggester`）。

solrconfig 的问题在于它带有许多预配置的搜索处理程序，如果您更改一项的默认名称，它可能会导致引用它的处理程序出现问题。

# linq-to-entities - Linq 使用 GroupBy 时，Include 不起作用

> ID：10572328
> 
> 赞同：33
> 
> 时间：2012-05-13T13:56:40.487
> 
> 标签：linq-to-entities, ef-code-first, entity-framework-4.3

包括 matchparticipants 不起作用。我调试时它总是说空。但是当我将 GroupBy 放在评论中时，它工作正常。我正在使用代码优先的实体框架 4.3.1。

实体：

```
public class Match
    {
        [ScaffoldColumn(false)]
        public int MatchId { get; set; }

        [Required(ErrorMessage = "Matchtype is a required field")]
        public int Scheme { get; set; }

        [Required]
        [DefaultValue(false)]
        public bool Finished { get; set; }

        public int Round { get; set; }

        // Relations
        [Required]
        public Category Category { get; set; }

        public Official Official { get; set; }

        public Slot Slot { get; set; }

        public ICollection<MatchParticipant> MatchParticipants { get; set; }
    }

 public class MatchParticipant
    {
        [ScaffoldColumn(false)]
        public int MatchParticipantId { get; set; }

        public int Points { get; set; }

        public int Goals { get; set; }

        [Required]
        public Match Match { get; set; }

        [Required]
        public Team Team { get; set; }
    }

public class Team
    {
        [ScaffoldColumn(false)]
        public int TeamId { get; set; }

        [Required(ErrorMessage="Name is a required field")]
        public string Name { get; set; }

        [Required(ErrorMessage="Number of players is a required field")]
        public int NumberOfPlayers { get; set; }

        [Required(ErrorMessage="Coach is a required field")]
        public string Coach { get; set; }

        [Required(ErrorMessage="Phone is a required field")]
        public string Phone { get; set; }

        public string CellPhone { get; set; }

        public string Fax { get; set; }

        [Required(ErrorMessage="Email is a required field")]
        public string Email { get; set; }

        [Required(ErrorMessage="Address is a required field")]
        public Address Address { get; set; }

        public Pool Pool { get; set; }

        [Required(ErrorMessage = "Category is a required field")]
        public Category Category { get; set; }

        public ICollection<MatchParticipant> matchParticipants { get; set; }
    }

        var matches =
        context.matches
       .Include("Official")
       .Include("Slot")
       .Include("MatchParticipants.Team")
       .Include("Category.Tournament")
       .Where(m => m.Category.Tournament.TournamentId == tournamentId)
       .GroupBy(m => m.Category); 
```

如何使包含工作？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-13T18:24:30.383

`Include`要求查询的形状不改变。这意味着您的查询必须返回`IQueryable<Match>`。`GroupBy`运算符可能被认为是形状改变，因为它返回`IQueryable<IGrouping<TKey, TSource>>`. 一旦查询的形状发生变化，所有的 Include 语句都将被省略。因此，您不能`Include`与投影、自定义连接和分组一起使用。

作为一种解决方法，您可以在 Linq-to-objects 中执行分组：

```
var matches = context.matches
                     .Include("Official")
                     .Include("Slot")
                     .Include("MatchParticipants.Team")
                     .Include("Category.Tournament")
                     .Where(m => m.Category.Tournament.TournamentId == tournamentId)
                     .ToList()
                     .GroupBy(m => m.Category); 
```

**编辑：**如评论和其他答案中所述，这是非常危险的解决方法，可能导致性能问题。它将所有记录从数据库拉到应用程序并在应用程序中进行聚合。它可以在相同的情况下工作，但绝对不适用于通用解决方案。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-06-30T08:05:57.310

在这种特殊情况下，当您的 GroupBy 是最新的运算符时，此查询效果很好......但恕我直言**，上面的答案是 beginer 最糟糕的答案**，因为当您的 GroupBy 没有在它之后立即执行时，它**会导致非常糟糕的优化查询**，而是然后是其他一些语句（Where，Select...）。

```
var ctx = new MyDataContext(); // Please use "using"
var result = ctx.SomeTable
                //.Include(ah => ah.IncludedTable) // DO NOT PUT IT HERE
                .Where(t => t.IsWhateverTrue)
                .GroupBy(t => t.MyGroupingKey)
                .Select(gt => 
                    gt.OrderByDescending(d => d.SomeProperty)
                        .FirstOrDefault(ah => ah.SomeAnotherFilter))
                .Include(ah => ah.IncludedTable) // YES, PUT IT HERE
                .ToList(); // Execute query here 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-18T09:14:21.497

`.Select()`在、 之后指定包含`GroupBy()`。这会将它们包括在结果中：

```
var result = ctx.SomeTable
                .Where(t => t.IsWhateverTrue)
                .GroupBy(t => t.MyGroupingKey)
                .Select(g => new
                  {
                    Date = g.Key.Value,
                    Reservations = g.Select(m => new
                        {
                          m,
                          m.IncludedTable // this selects/includes the related table
                        })
                  }
                ); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-09-03T05:39:02.927

我找不到在 SQL 端使用实体框架进行分组的工作方式，然后在 .net 站点上使用 Include()。另一种方法是编写自己的 SQL 查询并进行自己的映射。这实际上并不难：

1.  `Install-Package dapper`在 Nuget 包管理器控制台中运行以进行实体映射

2.  定义要映射到的自定义对象（或使用现有对象）

    ```
    class MyClass { int userID; int numRows;} 
    ```

3.  查询您的上下文对象：

    ```
    List<MyClass> results = _context.Database.GetDbConnection().Query<MyClass>("SELECT u.id as userID, count(1) as numRows FROM Users u inner join Table2 t2 on u.id= t2.userID  group by u.id;").ToList(); 
    ```

# python - django modelform 验证从 db 获取字段，如果不是，如果表单

> ID：10572332
> 
> 赞同：1
> 
> 时间：2012-05-13T13:57:22.017
> 
> 标签：python, django, validation, django-forms

我有一个 Django 模型和来自。

```
class Settings(models.Model):
    field_1 = models.BooleanField()
    field_2 = models.CharField(max_length = 255) 
```

和表格

```
class SiteSettingsForm(forms.ModelForm):
    class Meta:
        model = SiteSettings 
```

我有一个 HTML 表单，当`field_1`未选中布尔复选框时，第二个字段 ( `field_2`) 被禁用。

问题是，如果我尝试保存表单，它会说有错误，因为`field_2`它是空的。

我希望，如果`field_2`未禁用且不为空，则获取错误，但如果`field_2`已禁用，我希望表单从数据库中获取值。

我试过这个：

```
class SettingsForm(forms.ModelForm):
    class Meta:
        model = Settings

    def __init__(self, *args, **kwargs):
        super(SettingsForm, self).__init__(*args, **kwargs)

    def clean(self):
        field_1 = self.data.get('field_1','')
        if not field_1:   # field_2 is disabled 
            self.data['field_2'] = self.instance.field_2 # so get from db
        super(SettingsForm, self).clean()
        return self.cleaned_data 
```

问题是我得到一个错误：

> 这个 QueryDict 实例是不可变的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:32:04.057

更改您的表格：

```
class SettingsForm(forms.ModelForm):
    class Meta:
        model = Settings

    def __init__(self, *args, **kwargs):
        super(SettingsForm, self).__init__(*args, **kwargs)

    def clean(self):
        cleaned_data = super(SettingsForm, self).clean()
        field_1 = cleaned_data.get('field_1','')
        if not field_1:   # field_2 is disabled 
            cleaned_data['field_2'] = self.instance.field_2 # so get from db
        self.cleaned_data = cleaned_data
        return self.cleaned_data 
```

# erlang - 全局注册进程的最大数量

> ID：10572336
> 
> 赞同：7
> 
> 时间：2012-05-13T13:57:50.750
> 
> 标签：erlang, erlang-otp

全局注册的进程数有限制吗？或者这仅受内存/最大原子数的限制？

Ubuntu 12.04 和 Erlang R15B01。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-13T14:13:23.617

好问题！如果您考虑以下因素，我会赌原子数。[效率指南](http://www.erlang.org/doc/efficiency_guide/advanced.html)有一个关于系统限制的部分：

```
Processes
The maximum number of simultaneously alive Erlang processes is by default 32768\. This limit can be raised up to at most 268435456 processes at startup (see documentation of the system flag +P in the erl(1) documentation). The maximum limit of 268435456 processes will at least on a 32-bit architecture be impossible to reach due to memory shortage.

Distributed nodes
Known nodes
A remote node Y has to be known to node X if there exist any pids, ports, references, or funs (Erlang data types) from Y on X, or if X and Y are connected. The maximum number of remote nodes simultaneously/ever known to a node is limited by the maximum number of atoms available for node names. All data concerning remote nodes, except for the node name atom, are garbage-collected. 
```

此外，[erl 手册部分](http://www.erlang.org/doc/man/erl.html#max_processes)描述了可用于更改节点中进程数的标志：

```
+P Number
Sets the maximum number of concurrent processes for this system. Number must be in the range 16..134217727\. Default is 32768. 
```

由于您可以更改每个节点的并发进程数，但您不能更改允许的原子数，并且进程名称是在每个节点的副本中复制的原子，这应该是全局注册进程的允许总数。

希望能帮助到你 ：）

**编辑**：实际上，事实证明您可以更改允许的原子数:)

```
 Atoms
By default, the maximum number of atoms is 1048576\. This limit can be raised or lowered using the +t option.

+t size
Set the maximum number of atoms the VM can handle. Default is 1048576. 
```

# apache - 在 tomcat/apache 配置中找不到 .htaccess 文件

> ID：10572338
> 
> 赞同：1
> 
> 时间：2012-05-13T13:58:16.290
> 
> 标签：apache, tomcat, url-rewriting

我在我的 ubuntu 机器上安装了 tomcat 和 apache，用于开发基于 jsp 的网站。我需要配置 url_rewrite，因此需要访问 .htaccess 文件。你能帮我找到它吗？

谢谢，

伦纳德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:48:48.327

It doesn't have to exist already. You can make it yourself in the document root. Make sure AllowOverride All is set in your conf file :)

# html - Firefox中的CSS怪异-向左浮动而不向左浮动，除非使用大宽度

> ID：10572340
> 
> 赞同：0
> 
> 时间：2012-05-13T13:58:45.123
> 
> 标签：html, css, firefox, google-chrome

我有个问题

```
 #column-left {
     float: left;
     width: 350px;
 } 
```

会向左浮动，但是当我缩小宽度时

有了这个： `#column-left { float: left; width: 250px; }`

它不起作用。这两种形式都可以在 chrome 中使用，但不能在 Firefox 中使用。有任何想法吗？

这里有一些图片来说明：http: [//imgur.com/a/v0uIZ](http://imgur.com/a/v0uIZ)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:55:29.133

如下更新您的 CSS 代码。

从中删除`float: left;`和。`width: 350px;``#column-left`

添加`position: absolute;`到`#column-left`

改变`margin-left: 220px;`_`#content`

这会变魔术。在 Firefox 和 Google Chrome 上测试。

# javascript - 带有变量字符串的 indexOf

> ID：10572342
> 
> 赞同：0
> 
> 时间：2012-05-13T13:59:11.947
> 
> 标签：javascript, jquery

我在使用 javascript/jQuery 时遇到了这个问题，我有这段代码

```
//settings is the array of options passed to the function
$input = $('#par_kw[ref="'+settings['ref'] +'"]')
var prev = $input.val();
alert(prev + ' : '+settings['new_kw']+' : '+ prev.indexOf(settings['new_kw'])); 
```

在运行时我收到如下消息： `maths, computing : maths : -1`总是`-1`但是当我尝试恒定时`indexOf("maths")`它可以工作并且我得到`0`或者它的索引是什么你
能看到我做错了什么吗？因为我不能:(

## 更新

哦，好吧，这更令人困惑：/我[在这里](http://jsfiddle.net/katkootable/DXyBY/1/)
尝试了JSFIDDLE.net ，但它工作得很好:(文件中可能有问题吗，因为在我的项目中我将代码分成2个文件，但我在一个文件中保持简单@ jsfiddle ?!! 但这没有任何意义!! 无论指令在哪里，我都确保在警报中正确捕获该值！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:48:01.287

我已经为你更新[了 FIDDLE](http://jsfiddle.net/shehovn/DXyBY/9/)。那是什么？

# jquery - jQuery提交功能无法正常工作

> ID：10572350
> 
> 赞同：2
> 
> 时间：2012-05-13T13:59:59.937
> 
> 标签：jquery, submit

我对 jQuery 提交功能有一些疑问。

这里是工作环境

jQuery：1.7.2，铬（18.0.1025.168 m）。

有2个问题。

第一个：

我的代码是这样的

html

```
<form id="test" action="..." method="post">
     <input type="text" />
     <input type="submit">
</form> 
```

jQuery

```
$('#test').submit(function(){
      return false;
}) 
```

问题是它在 Firefox 和 Opera 中运行良好，但在 chrome 中运行良好。

第二：

html：如上。

jQuery：

```
$('#test').submit(function(){
      if(...)
         alert(something..);
      return false;
}) 
```

它在 firefox、opera 和 chrome 中不起作用。它总是触发 form.submit 为什么。

我很困惑呢。谁能弄清楚谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-13T14:08:34.797

不要使用`return false;`. 试试这个：

```
$('#test').submit(function(event){
      event.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-13T14:08:47.673

代替：

```
$('#test').submit(function(){
      return false;
}); 
```

和：

```
$('form#test').submit(function(event){    
      event.preventDefault();
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-13T14:12:29.980

如果您只是不想提交页面，您可以简单地使用

`onsubmit="return false"`或者，如果您想要有条件的提交，也可以使用您拥有的代码。

我认为这没有任何问题

[演示](http://jsfiddle.net/mprabhat/bJsCd/2/)

代码：

```
$('#test').submit(function(event) {
    if(jQuery('#textbox').val() == '') {
       alert('Not submitting');
       //event.preventDefault(); Not necessary but better
       return false;
    }
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-22T22:00:16.763

这有时是 JS 库或自定义代码与提交处理程序的行为冲突的结果（例如，具有另一个显式提交表单的提交处理程序）。

理想的解决方案是调试并找到冲突的代码并解决它。

但是作为一种解决方法，可以更改为使用提交按钮上的单击处理程序，而不是表单上的提交处理程序。

可以做这样的事情：

```
 <input type="submit" id="btnSubmit"> 
```

然后在代码中你可以做

```
$('#btnSubmit').click(function(){ //Actually we can do 'input[type="submit"]'
    return false;
}) 
```

但是，如果允许通过点击“enter”提交表单，则必须小心，因为在这种情况下，点击处理程序的调用可能取决于浏览器和/或基于正在使用的库，请参阅[onsubmit="](https://stackoverflow.com/questions/4078245/onsubmit-return-false-has-no-effect-on-internet-explorer-7-8-form-is-still-su/4078284#comment20547026_4078284)中的注释return false"对 Dirk Paessler 的答案中的[Internet Explorer 7/8（仍提交表单）没有影响以获取更多信息。](https://stackoverflow.com/questions/4078245/onsubmit-return-false-has-no-effect-on-internet-explorer-7-8-form-is-still-su/4078284#comment20547026_4078284)

但是为了独立于浏览器，也可能会捕获“enter”按键按钮，如下面的代码所示：

```
document.onkeypress = function(evt) {
   var evt = (evt) ? evt : ((event) ? event : null);
   var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
   if ((evt.keyCode == 13) && (node.type == "text")) { 
         /*return true or false here based on your logic*/;
   }
} 
```

但是，人们也可以尝试此线程中的其他建议，例如直接调用 e.preventDefault() ，尽管这是 Jquery 在幕后实际所做的，但您的冲突代码仍然可以使用它

# android - 无法在 Android 中将图像导出到 excel

> ID：10572351
> 
> 赞同：0
> 
> 时间：2012-05-13T14:00:05.317
> 
> 标签：android, image, excel, apache-poi

我尝试使用以下代码在 Android 上的 excel 中导出图像，但出现错误。复制logcat ...请帮助！

代码：

```
 package com.android.testexcel;

        import java.io.ByteArrayOutputStream;
        import java.io.FileInputStream;
        import java.io.FileOutputStream;
        import java.io.IOException;

        import org.apache.poi.hssf.usermodel.HSSFClientAnchor;
        import org.apache.poi.hssf.usermodel.HSSFPatriarch;
        import org.apache.poi.hssf.usermodel.HSSFSheet;
        import org.apache.poi.hssf.usermodel.HSSFWorkbook;

        public class MyWorkBook {
            void writeImageToExcel(String filePath, String imageFileName) {
                int col = 1, row = 1;
                HSSFWorkbook wb = new HSSFWorkbook();
                HSSFSheet testsheet = wb.createSheet("test");
                System.out.println("The work book is created");
                try {
                    FileOutputStream fos = new FileOutputStream(filePath);
                    System.out.println("File sample.xls is created");
                    FileInputStream fis = new FileInputStream(imageFileName);
                    ByteArrayOutputStream img_bytes = new ByteArrayOutputStream();
                    int b;
                    while ((b = fis.read()) != -1)
                        img_bytes.write(b);
                    fis.close();
                    HSSFClientAnchor anchor = new HSSFClientAnchor(0, 0, 0, 0,
                            (short) col, row, (short) ++col, ++row);
                    int index = wb.addPicture(img_bytes.toByteArray(),
                            HSSFWorkbook.PICTURE_TYPE_JPEG);
                    HSSFSheet sheet = wb.getSheet("test");
                    HSSFPatriarch patriarch = sheet.createDrawingPatriarch();
                    patriarch.createPicture(anchor, index);
                    anchor.setAnchorType(2);
                    wb.write(fos);
                    System.out.println("Writing data to the xls file");
                    fos.close();
                    System.out.println("File closed");
                } catch (IOException ioe) {

                    System.out
                            .println("Hi ! You got an exception. " + ioe.getMessage());
                    ioe.printStackTrace();
                }
            }
        }// end of class MyWorkBook 
```

* * *

日志猫：

> 05-13 19:11:47.665：E/AndroidRuntime(7288)：致命异常：主要 05-13 19:11:47.665：E/AndroidRuntime(7288)：java.lang.NoClassDefFoundError：org.apache.commons.codec。 digest.DigestUtils 05-13 19:11:47.665: E/AndroidRuntime(7288): at org.apache.poi.hssf.usermodel.HSSFWorkbook.addPicture(HSSFWorkbook.java:1580) 05-13 19:11:47.665: E /AndroidRuntime(7288): 在 com.android.testexcel.MyWorkBook.writeImageToExcel(MyWorkBook.java:30) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 com.android.testexcel.MainActivity.onClick( MainActivity.java:71) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 android.view.View.performClick(View.java:2408) 05-13 19:11:47.665: E/AndroidRuntime( 7288): 在 android.view.View$PerformClick.run(View.java:8816) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 android.os.Handler.handleCallback(Handler.java:587) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 android.os.Handler.dispatchMessage(Handler.java:92) 05-13 19:11:47.665: E/AndroidRuntime(7288) : 在 android.os.Looper.loop(Looper.java:123) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 android.app.ActivityThread.main(ActivityThread.java:4627) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 java.lang.reflect.Method.invokeNative(Native Method) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 java.lang.reflect。 Method.invoke(Method.java:521) 05-13 19:11:47.665: E/AndroidRuntime(7288): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 05-13 19:11:47.665: E/AndroidRuntime(7288): 在 dalvik .system.NativeStart。主要（本机方法）

提前致谢，赫曼特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T20:16:58.943

您的错误的关键部分是：

```
java.lang.NoClassDefFoundError: org.apache.commons.codec.digest.DigestUtils 
```

您需要确保在项目中包含公共编解码器。有关 POI 所有不同位的依赖项列表，请参阅[Apache POI 组件页面](http://poi.apache.org/overview.html#components)。（或者，如果您使用 Maven，它会为您处理）

# android - 如何更新列表视图

> ID：10572352
> 
> 赞同：0
> 
> 时间：2012-05-13T14:00:05.990
> 
> 标签：android

```
 Cursor smCursor = getContentResolver().query( 
            Uri.parse("content://contact"),
            new String[] { "_id", "address", "body" }, "address like?",
            new String[] { searchContactPhone }, null); 
CustomAdapter ada = new CustomAdapter(this,
                R.layout.sm_layout, smCursor, new String[] {
                        "body" }, new int[] {
                        R.id.txt2 });
        lvSm.setAdapter(ada);

btnDel.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            ArrayList<Boolean> ca = ada.getItemsThatAreChecked();
            // this ArrayList will hold our Strings from the rows that were clicked.
            ArrayList<String> results = new ArrayList<String>();
            int s = ca.size();
            for (int i = 0; i < s; i++) {
                    if (ca.get(i).booleanValue()) {
                            smCursor.moveToPosition(i);
                            Log.v("sss", smCursor.getString(smCursor.getColumnIndex("_id")));
                            results.add(smCursor.getString(smCursor.getColumnIndex("_id")));
                    }
            }
            if(results != null && !results.isEmpty()){
                String [] mSelectionArgs  = results.toArray(new String[results.size()]);
                String mSelectionClause = "_id=?";
                int delCursor = 0;

                Uri uri = Uri.parse("content://contact");
                for(int delCount = 0;delCount < mSelectionArgs.length;delCount++)
                {
                delCursor = getContentResolver().delete(uri ,mSelectionClause,new String[]{mSelectionArgs[delCount]});
                }
                ada.notifyDataSetChanged();
                Toast.makeText(getApplicationContext(), mSelectionArgs.length +" number of rows deleted", 5).show();

            }
            else
                Toast.makeText(getApplicationContext(), "Sorry no deletion occurs", 5).show();

        } 
```

我想知道如何更新我的列表视图，因为我正在从列表视图中删除选定的项目，删除后选择会自动发生到下一个项目。我使用了 notifyDataSetChanged() 但不起作用。我正在使用自定义适配器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T04:41:00.057

要使其在删除后工作，您需要在调用 notifyDataSetChanged 方法之前更改数据源，这可以通过 smCursor.requery(); 方法，但作为不推荐使用的方法，我建议再次执行查询，因此单击删除按钮时的代码块应如下所示：

```
btnDel.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            ArrayList<Boolean> ca = ada.getItemsThatAreChecked();
            // this ArrayList will hold our Strings from the rows that were clicked.
            ArrayList<String> results = new ArrayList<String>();
            int s = ca.size();
            for (int i = 0; i < s; i++) {
                    if (ca.get(i).booleanValue()) {
                            smCursor.moveToPosition(i);
                            Log.v("sss", smCursor.getString(smCursor.getColumnIndex("_id")));
                            results.add(smCursor.getString(smCursor.getColumnIndex("_id")));
                    }
            }
            if(results != null && !results.isEmpty()){
                String [] mSelectionArgs  = results.toArray(new String[results.size()]);
                String mSelectionClause = "_id=?";
                int delCursor = 0;

                Uri uri = Uri.parse("content://contact");
                for(int delCount = 0;delCount < mSelectionArgs.length;delCount++)
                {
                delCursor = getContentResolver().delete(uri ,mSelectionClause,new String[]{mSelectionArgs[delCount]});
                }

            smCursor = getContentResolver().query( 
            Uri.parse("content://contact"),
            new String[] { "_id", "address", "body" }, "address like?",
            new String[] { searchContactPhone }, null); 
                ada.notifyDataSetChanged();
                Toast.makeText(getApplicationContext(), mSelectionArgs.length +" number of rows deleted", 5).show();

            }
            else
                Toast.makeText(getApplicationContext(), "Sorry no deletion occurs", 5).show();

        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:47:50.047

```
btnDel.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            ArrayList<Boolean> ca = ada.getItemsThatAreChecked();
            // this ArrayList will hold our Strings from the rows that were clicked.
            ArrayList<String> results = new ArrayList<String>();
            int s = ca.size();
            for (int i = 0; i < s; i++) {
                    if (ca.get(i).booleanValue()) {
                            smCursor.moveToPosition(i);
                            Log.v("sss", smCursor.getString(smCursor.getColumnIndex("_id")));
                            results.add(smCursor.getString(smCursor.getColumnIndex("_id")));
                    }
            }
            if(results != null && !results.isEmpty()){
                String [] mSelectionArgs  = results.toArray(new String[results.size()]);
                String mSelectionClause = "_id=?";
                int delCursor = 0;

                Uri uri = Uri.parse("content://contact");
                for(int delCount = 0;delCount < mSelectionArgs.length;delCount++)
                {
                delCursor = getContentResolver().delete(uri ,mSelectionClause,new String[]{mSelectionArgs[delCount]});
                }
        ada = new CustomAdapter(this,
                R.layout.sm_layout, smCursor, new String[] {
                        "body" }, new int[] {
                        R.id.txt2 });
        lvSm.setAdapter(ada);

                Toast.makeText(getApplicationContext(), mSelectionArgs.length +" number of rows deleted", 5).show();

            }
            else
                Toast.makeText(getApplicationContext(), "Sorry no deletion occurs", 5).show();

        } 
```

工作正常，因为我只重新创建自定义适配器的实例并在删除后将其绑定到列表视图。

# python - 如何从字典中的键中获取值

> ID：10572353
> 
> 赞同：0
> 
> 时间：2012-05-13T14:00:10.993
> 
> 标签：python

我有一些用于停车的汽车登记代码。我创建了一个字典，其中汽车注册号作为键，其余信息作为值。我正在尝试通过输入注册号来获取每个注册的详细信息（值）。即使 id 在字典中，它也会显示在字典中找不到的消息。

```
global variable
data_dict = {}
def createNameDict(filename):
  path = "C:\Users\user\Desktop"
  basename = "ParkingData_Part2.txt"
  filename = path + "\\" + basename
  file = open(filename)
  contents = file.read()
  print contents,"\n"

  data_list = [lines.split(",",1) for lines in contents.split("\n")]
  #data_list.sort()
  #print data_list 
  #dict_list = []

  for line in data_list:
    keys = line[0]
    values = line[1]

    data_dict[keys] = values
  print data_dict,"\n"
  print data_dict.keys(),"\n"
  print data_dict.values(),"\n"
  print data_list  
def detailForRegistrationNumber(regNumber):
  regNumber == "keys"
  if regNumber in data_dict:
    print data_dict[regNumber]
  else:
    print regNumber, "Not in dictionary" 
```

我收到的错误消息是：

```
======= Loading Progam =======
>>> detailForRegistrationNumber('EDF768')
EDF768 Not in dictionary 
```

但是字典有上面的注册号：

```
{'HUY768': ' Wilbur Matty, 8912, Creche_Parking', 'GH7682': ' Clara Hill, 7689, AgHort_Parking', 'GEF123': ' Jill Black, 3456, Creche_Parking', 'WER546': ' Olga Grey, 9898, Creche_Parking', 'TY5678': ' Jane Miller, 8987, AgHort_Parking', 'ABC234': ' Fred Greenside, 2345, AgHort_Parking', 'KLOI98': ' Martha Miller, 4563, Vet_Parking', **'EDF768'**: ' Bill Meyer, 2456, Vet_Parking', 'JU9807': ' Jacky Blair, 7867, Vet_Parking', 'DF7800': ' Jacko Frizzle, 4532, Creche_Parking', 'ADF645': ' Cloe Freckle, 6789, Vet_Parking'} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:03:46.693

我认为你的问题是你的函数`def createNameDict(filename):`没有返回任何东西，所以`data_dict`它内部只是一个局部变量！

制作函数的最后一行，`return data_dict`然后像`data_dict = createNameDict(filename)`. 不需要全局变量部分，所以只需删除它。

# ios - 在 iPad 中使用 NavigationController 解除 ModalViewController 当在视图外点击时

> ID：10572354
> 
> 赞同：0
> 
> 时间：2012-05-13T14:00:18.373
> 
> 标签：ios, ipad, modalviewcontroller

因此，当在其视图之外点击时，我通常会按照这种方式关闭 ModalViewController

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    if(UIUserInterfaceIdiomPad == UI_USER_INTERFACE_IDIOM())
    {
        if(![self.view.window.gestureRecognizers containsObject:recognizer])
        {
            recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapBehind:)];

            [recognizer setNumberOfTapsRequired:1];
            recognizer.cancelsTouchesInView = NO; //So the user can still interact with controls in the modal view
            [self.view.window addGestureRecognizer:recognizer];
            [recognizer release];
        }
    }
}

- (void)handleTapBehind:(UITapGestureRecognizer *)sender
{
    if (sender.state == UIGestureRecognizerStateEnded)
    {
        CGPoint location = [sender locationInView:nil]; //Passing nil gives us coordinates in the window

        //Then we convert the tap's location into the local view's coordinate system, and test to see if it's in or outside. If outside, dismiss the view.

        if (![self.view pointInside:[self.view convertPoint:location fromView:self.view.window] withEvent:nil]) 
        {
            [self dismissModalViewControllerAnimated:YES];
            [self.view.window removeGestureRecognizer:recognizer];
        }
    }
} 
```

它与*常规*的 ModalViewController 一起工作得很好 .. 但现在我有一个 modelViewController ，它是一个以“x”viewController 作为根的 NavigationViewController ..当我使用这种方式并点击导航栏时，控制器被关闭，或者当我导航到“ y" 控制器来自 x 控制器并想要返回，当我单击后退按钮时，ModalView 也会被关闭！这对我来说是错误的行为..我只是希望在点击完全在控制器之外（视图区域+导航栏区域）的情况下关闭控制器..任何人都可以提供帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T23:16:13.820

更新您的代码如下：

```
- (void)handleTapBehind:(UITapGestureRecognizer *)sender
{
    if (sender.state == UIGestureRecognizerStateEnded)
    {
        CGPoint flocation = [sender locationInView:nil]; //Passing nil gives us coordinates in the window

        //Then we convert the tap's location into the local view's coordinate system, and test to see if it's in or outside. If outside, dismiss the view.

        CGPoint tap = [self.view convertPoint:flocation fromView:self.view.window];
        CGPoint tapBar = [self.navigationController.navigationBar convertPoint:flocation fromView:self.view.window];
        if (![self.view pointInside:tap withEvent:nil] && ![self.navigationController.navigationBar pointInside:tapBar withEvent:nil])
        {
            // Remove the recognizer first so it's view.window is valid.
            [self.view.window removeGestureRecognizer:sender];
            [self dismissModalViewControllerAnimated:YES];
        }
    }
} 
```

点击 UIBarButtonItem 时从窗口中删除 UITapGestureRecognizer

```
-(void)viewWillDisappear:(BOOL)animated {
    [self.view.window removeGestureRecognizer:self.tapOutsideGestureRecognizer];
} 
```

# c# - 如何让 Quartz.Server.exe 运行我的 ASP.NET 作业

> ID：10572357
> 
> 赞同：1
> 
> 时间：2012-05-13T14:01:40.853
> 
> 标签：c#, asp.net, quartz.net

我有一个生成文档的 ASP.NET 网站。每个文档都需要一段时间来生成，并且有很多文档请求，所以我正在探索使用 Quartz.NET 来帮助汇集请求，通过重启保持它们，并将它们交付给用户以获得更好的体验。

`Quartz.Server.exe`包含在下载中，它似乎是一个用于运行 Quartz 作业的守护进程，即使前端没有运行也是如此。这对于像我这样的网络场景来说显然是完美的。

**主要问题**是 Quartz.Server.exe 无法实例化我提供的作业类型。

```
Could not load file or assembly 'quartztest01' or one of its dependencies. The system cannot find the file specified. -- 
```

这是有道理的，因为我的程序集`quartztest01`不在 GAC 中，并且`Quartz.Server.exe`对我的程序集一无所知。但是当我试图解决这个问题时会提出很多问题。

1.  我不希望我的程序集出现在 GAC 中。我怎样才能做到这一点？`Quartz.Server.exe`参考我的程序集重建？
2.  我是否采取了正确的方法？前端，并`Quartz.Server.exe`使用相同的数据存储，并配置为集群，但我很怀疑它会运行。
3.  `Quartz.Server.exe`甚至是用于生产用途吗？它似乎创建了一个示例作业，对我来说这表明它只是一个示例。我应该修改这个 exe 以满足我自己的需要吗？
4.  将 Quartz.NET 安装为合法的 Windows 服务而不是此控制台应用程序的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T19:07:03.313

1.  您不必在 GAC 中安装。只需确保您的程序集与quartz.dll 位于同一文件夹中，或者框架可以使用定位程序集的常用技术找到它。
2.  是的，让 UI 充当客户端是很常见的，因此它必须指向同一个商店。不常见的是将调度程序设置为集群，除非 UI 也将充当服务器。
3.  是的。Quartz.Server.exe install 将其安装为服务。
4.  @James 评论中的链接就是这个问题的答案。

FWIW，由于 Web 应用程序生命周期由 IIS 管理的方式，将 Quartz.net 作为服务安装通常比将其嵌入到 ASP.Net Web 应用程序中更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T04:18:21.753

只需将您的程序集放在与服务器 exe 相同的目录中，它应该可以正常加载。您也可以使用 probePath，但可能不需要。

# html - 无法居中 元素

> ID：10572359
> 
> 赞同：-2
> 
> 时间：2012-05-13T14:01:54.217
> 
> 标签：html, css

我尝试在我的网页中将一个 div 元素（在这种情况下为页脚 div）居中，但它坚持保持在左侧。

我不太确定出了什么问题...有什么想法吗？先感谢您。

HTML：

```
<div id='main'>
</div>

<div id='footer'>Centered Text</div>​ 
```

CSS：

```
* {
    padding: 0;
    margin:  0;
    font-size:   12px;
}

body {
    font-family: helvetica, serif;
    font-size:   12px;
    overflow-y:scroll;
}

#main {
    border: 1px solid #bbbbbb;
    margin: 3% 5%;
    padding: 10px 10px;
}

#footer {
    font-size: 75%;
    margin: 0px auto;
    position: absolute;
    bottom: 0px;
} 
```

​</p>

[http://jsfiddle.net/DjPjj/2/](http://jsfiddle.net/DjPjj/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:04:41.037

[http://jsfiddle.net/DjPjj/13/](http://jsfiddle.net/DjPjj/13/)

试试这个：

```
#footer {
    font-size: 75%;
    width: 100%;
    position: absolute;
    bottom: 0px;
    text-align: center;
} 
```

因为您的页脚是绝对定位的，所以您必须告诉它相对于其父容器的宽度。然后，您可以使用 text-align 将其中的文本居中。

这是另一个例子：http: [//jsfiddle.net/DjPjj/17/](http://jsfiddle.net/DjPjj/17/)

这个在绝对定位的元素中居中放置一个框。内盒可以居中使用`margin: 0 auto`，因为它不是绝对定位的。

```
#footer {
    font-size: 75%;
    width: 100%;
    position: absolute;
    bottom: 0px;
}

#footerInner {
  margin: 0 auto;
  width: 300px;
  background-color: #ddd;
  text-align: center;
} 
```

这更灵活，因为内部元素为您提供了一个相对于父元素居中的新容器。​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:06:57.267

它不会居中的原因是因为`positon: absolute;`.

请记住，这意味着页脚将始终位于页面底部，即使内容溢出它也是如此。它会重叠。如果要将其附加到页面底部，则必须将其上方容器的最小高度设置为 100%，然后处理负边距顶部并删除`position: abosolute;`

[http://jsfiddle.net/4fuk7/1/](http://jsfiddle.net/4fuk7/1/)

注意居中的文本是如何被覆盖的。

如果您正在寻找始终处于底部的东西，这将起作用 [http://jsfiddle.net/4fuk7/3/](http://jsfiddle.net/4fuk7/3/)

Sorry, the last one would scroll to the top. This one doesn't, but you'd need to fiddle with it a bit to get it to properly align around the margin's you've set. [http://jsfiddle.net/4fuk7/9/](http://jsfiddle.net/4fuk7/9/) http://www.tlunter.com/Layout 2/ is where I did something similar. You can reference that if you want.

# iphone - 如何在 UITextView 或字符串中查找重复或相同单词的范围？

> ID：10572363
> 
> 赞同：0
> 
> 时间：2012-05-13T14:02:29.467
> 
> 标签：iphone, uitextview

我正在努力在 textview 中查找任何单词的 rect ，我需要在其中找到单词的范围，首先说为

```
NSRange textRange=[textview.text rangeofString:@"sabby"]; 
```

现在我在我的 textview 中有 3 次 sabby 说。现在我需要获取第二个 sabby 单词的范围，而不是第一个……那我该怎么做……其他单词也是如此。因为如果我使用上面的代码行，它会给我文本视图中第一个单词的范围......

谢谢 n 干杯.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:19:55.633

使用`rangeOfString:options:range:`并设置范围以在后续搜索中最后一次出现字符串后开始。

# c# - 是否可以在 C# 5.0 中使用相同的异步方法签名并能够在以后决定如何执行此类方法

> ID：10572365
> 
> 赞同：6
> 
> 时间：2012-05-13T14:02:36.070
> 
> 标签：c#, .net, async-await, c#-5.0

我想使用最近的 C# 5.0 异步方法，但是一些特定的方法。

考虑以下示例代码：

```
public abstract class SomeBaseProvider : ISomeProvider
{
   public abstract Task<string> Process(SomeParameters parameters);    
}

public class SomeConcreteProvider1 : SomeBaseProvider 
{

   // in this method I want to minimize any overhead to create / run Task
   // NOTE: I remove here async from method signature, because basically I want to run 
   // method to run in sync!
   public override Task<string> Process(SomeParameters parameters) {

      string result = "string which I don't need any async code to get";

      return Task.Run(() => result);
   }
}

public class SomeConcreteProvider2 : SomeBaseProvider 
{

   // in this method, it's OK for me to use async / await 
   public async override Task<string> Process(SomeParameters parameters) {

      var data = await new WebClient().DownloadDataTaskAsync(urlToRequest);

      string result = // ... here we convert data byte[] to string some way

      return result;

   }
} 
```

现在我将如何使用异步方法（在我的情况下，你可以忽略消费者实际上是 ASP.NET MVC4 应用程序......它可以是任何东西）：

```
public class SomeAsyncController : AsyncController
{

    public async Task<ActionResult> SomethingAsync(string providerId)
    {
       // we just get here one of providers I define above
       var provider = SomeService.GetProvider(providerId);

       // we try to execute here Process method in async. 
       // However we might want to actually do it in sync instead, if  
       // provider is actually SomeConcreteProvider1 object.
       string result = await provider.Process(new SomeParameters(...));

       return Content(result);
     }
} 
```

如您所见，我有 2 个实现，每个实现不同：一个我想异步运行并且不阻塞线程 (SomeConcreteProvider2)，而另一个我希望能够同步运行并且不创建任何 Task 对象等（我未能在上面的代码中编码，即我确实在这里创建了新任务！）。

已经有一些问题，例如[我将如何同步运行异步 Task<T> 方法？](https://stackoverflow.com/questions/5095183/how-would-i-run-an-async-taskt-method-synchronously). 但是我不想同步运行某些东西......如果我在代码时（即运行时之前）知道某些方法实现实际上不会是异步的并且不需要使用任何线程，我想避免任何开销/我/O完成端口等。如果您检查上面的代码，很容易看到SomeConcreteProvider1中的方法基本上会构造一些字符串（html），可以在同一个执行线程中非常快速地完成。但是 SomeConcreteProvider2 中的相同方法将需要创建 Web 请求，获取 Web 响应并以某种方式处理它，我确实希望至少在异步中发出 Web 请求以避免在请求期间阻塞整个线程（实际上可能会退出很长时间）。

所以问题是：如何组织我的代码（不同的方法签名或不同的实现，或者？）能够决定如何执行方法并避免任何可能的开销，例如由 SomeConcreteProvider1 中的 Task.Run(...) .工艺方法？

**更新1**：明显的解决方案（我在提问过程中想到了其中一些），例如向每个提供者添加一些静态属性（比如'isAsyncImplementation'），然后检查该属性以决定如何运行方法（使用等待或在控制器操作中没有等待）也有一些开销：DI 如果可能的话想要更好的东西：D

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-13T14:15:33.580

在您的第一种情况下，我建议您返回：

```
Task.FromResult(result) 
```

它返回一个已完成的任务。

[http://msdn.microsoft.com/en-us/library/hh194922%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/hh194922%28v=vs.110%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:12:48.447

你的设计看起来不错。

对于这种`SomeConcreteProvider1`情况，您可以使用[TaskCompletionSource](http://msdn.microsoft.com/en-us/library/dd449174%28v=vs.110%29.aspx)

这将返回 a`Task`而不需要并发。

此外，在消费者代码中，如果已经完成，`await`则不会产生。`Task`这称为“快速路径”并有效地使方法同步。

# asp.net - 将 SQL 数据类型时间显示为标准时间

> ID：10572367
> 
> 赞同：1
> 
> 时间：2012-05-13T14:02:47.093
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

我的数据库将时间存储在 SQL DataType Time 中。我在 vb.net 中使用 mvc 3 并试图获得以标准格式 (AM/PM) 显示的时间。但是，我不断收到错误消息“无法将 'System.TimeSpan' 类型的对象转换为 'System.IConvertible' 类型。”

这是我正在使用的代码

```
<h4>Tuesday</h4>
<ul>
@For Each c As ClassSchedule In ViewBag.Tuesday

   @<li>@c.timeStart - @c.timeEnd - @c.name</li>

Next
</ul> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:13:45.007

编辑：

```
@<li>
  @(new DateTime(c.timeStart.Ticks).ToString("hh:mm:ss tt")) - 
  @(new DateTime(c.timeEnd.Ticks).ToString("hh:mm:ss tt")) - @c.name
</li> 
```

~~错误发生是因为你减去了日期~~

 ~~```
 @<li>
   <span>@c.timeStart </span>- 
   <span>@c.timeEnd </span>- 
   <span>@c.name</span>
  </li> 
```~~  ~~* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T23:20:04.950

Figured it out --- you have to convert the time into a string first

@

*   @Convert.ToDateTime(c.timeStart.ToString).ToShortTimeString - @Convert.ToDateTime(c.timeEnd.ToString).ToShortTimeString - @c.name

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T14:15:40.927

您可以在 TimeSpan 上显式调用 ToString()。~~

# string - 最大子串搜索

> ID：10572369
> 
> 赞同：0
> 
> 时间：2012-05-13T14:02:57.450
> 
> 标签：string, algorithm, suffix-array

给定一个字符串 S，由小写拉丁字母组成。我想为每个位置 S[i] 最大长度 L[i] 找到一个位置 i' < i that s[i'..i'+L[i]-1] = s[i.. i+L[i]-1]。例如：s = ababaab，L= {0,0,3,2,1,2,1}。我想在 < O(|S|^2) 的时间内完成。我猜这个问题是用后缀数组解决的，但是如何解决呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:13:54.383

你应该看看 ZBlock 算法，虽然这个算法解决了一个稍微不同的问题（其中 i' 总是等于 0），它运行在 O(|S|) 中。您应该可以在方便时对其进行修改。

动态编程将使用修改后的子字符串匹配版本在 O(|S|^2) 中解决这个问题，但我猜你不是在寻找这样的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T04:12:32.950

您正在寻找的东西被称为“最长的先前因子”，并且确实有 Crochemore 和 Ilie 的一篇论文，其中包含两个后缀数组算法来计算这一点。好消息是两者都是线性时间。第二种算法使用 Lcp 表，在我看来要容易一些。

# java - Java中具有非ascii字符的BigInteger类

> ID：10572370
> 
> 赞同：-2
> 
> 时间：2012-05-13T14:03:02.647
> 
> 标签：java, string, biginteger

我一直在开发一个小应用程序，它可以抓取嵌入在图片中的字符串，而这些字符串又用于计算 2 个大整数，以便在密钥交换系统中使用。但是，当我尝试从属性文件中读取字符串并将它们实现为 bigint 时：

```
String primeStr = "ekoeaokimcgmigcqu{uq{y}sw}ywsAEKOEAOKIMCGMIGCQU[_UQ_[Y]SW]YWS!%+/%!/+)-#'-)'#15;?51?;9=37=973"
BigInteger prime = new BigInteger(this.primeStr,10); 
```

我被抛出一个关于字符串不正确的错误。我的问题是我将如何解决这个问题，以便我可以在应用程序中使用该字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:08:18.790

的`String`构造函数`BigInteger`需要一个*数字*，如果您的`primeStr`变量以某种方式对数字进行编码，则必须先对其进行解码，然后再将其传递给`BigInteger`.

# django - django jsi18n 和 jquery ui datepicker 格式兼容性

> ID：10572373
> 
> 赞同：1
> 
> 时间：2012-05-13T14:03:32.777
> 
> 标签：django, jquery-ui, internationalization, jquery-ui-datepicker

我试图在本地化的 Django 应用程序中使用 jquery ui datepicker。我想根据语言格式化日期（由于对不同语言的自定义验证）。在 django 中，有 js helper django.views.i18n.javascript_catalog 返回所需的格式，但这些格式与 jquery ui datepicker dateFormat 属性不兼容。

例如，django 给出了这个：

```
formats['SHORT_DATE_FORMAT'] = 'd.m.Y';

formats['DATETIME_INPUT_FORMATS'] = ['%d.%m.%Y %H:%M:%S', '%d.%m.%Y %H:%M', '%d.%m.%Y', '%Y-%m-%d %H:%M:%S', '%Y-%m-%d %H:%M', '%Y-%m-%d'];` 
```

但是这些都不能用于 jquery ui datepicker dateFormat attr。Datepicker 需要不同的格式。

这个问题有什么解决办法吗？例如 django(python) 到 datepicker 解析器？感谢您提供任何解决方案。至少，我可以编写自己的 djangoToDatepicker 解析器，但我希望有更清洁的解决方案。

# c - 如何使用openmp在c中进行一些for循环的任务并行化？

> ID：10572377
> 
> 赞同：0
> 
> 时间：2012-05-13T14:03:59.887
> 
> 标签：c, openmp

我有如下交流程序：

```
int a[10];
int b;

for(int i = 0; i < 10; i++)

     function1(a[i]);
function1(b); 
```

现在我想并行化所有这 11 个函数 function1() 的调用。我怎样才能使用openmp做到这一点？

我试过了

```
#pragma omp parallel sections
{
#pragma omp section
#pragmal omp parallel for
for(int i = 0; i < 10; i++)
     function1(a[i]);
#pragma omp section
function1(b);
} 
```

但是上面的代码似乎不起作用。编辑：请将函数 1(b) 读作一些不同的函数，即函数 2(b)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:14:42.383

最简单的方法是使用`parallel for`编译指示：

```
#pragma omp parallel for
for(int i = 0; i < 10; i++)
    function1(a[i]); 
```

请记住，您必须为编译器打开适当的开关以启用 OMP 支持。例如，在 GCC 中，该开关是`-fopenmp`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:16:37.650

一种不依赖于 OpemMP 的简单方法是添加`b`到`a`数组中。
这样，您就可以并行化一个循环。
只需`a`长 11 个整数，然后将 的值`b`放在最后一个整数中。

在更一般的情况下（假设 的成员`a`不是整数，而是更大的东西），您可能需要更改`function1`以获取指针。然后构建另一个包含 11 个指针的数组。设置 10 指向 的单元格`a`，最后一个指向`b`。

在更一般的情况下，调用的函数`b`是不同的（可能具有完全不同的参数）。在这种情况下，您仍然可以使用一个循环：

```
for (i=0; i<11; i++) {
    if (i<10) {
        function1(a[i]);
    } else {
        function2(b);
    }
} 
```

# odbc - SQLAllocConnect 成功，但 SQLConnect 失败

> ID：10572378
> 
> 赞同：0
> 
> 时间：2012-05-13T14:04:11.727
> 
> 标签：odbc

我已经成功地制作了连接器/ODBC，然后我编写了一些代码：

```
SQLHENV henv;       
SQLHDBC phdbc;      
SQLRETURN retcode; 
retcode = SQLAllocEnv(&henv); 
retcode = SQLAllocConnect(henv,&phdbc);    
if(retcode == SQL_SUCCESS)
{
    char *a="cc_mysql";
    char *b="chen1991";         
    retcode = SQLConnect(phdbc,(SQLCHAR*)a,SQL_NTS,(SQLCHAR*)b,SQL_NTS,(SQLCHAR*)b,SQL_NTS);
             } 
```

但我无法连接。我调试它，发现 SQLAllocConnect 返回 true ，但 SQLConnect 返回 -1，我无法理解发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T07:34:06.243

发生的事情是您对 SQLConnect 的调用失败，您需要调用 SQLError 来获取错误。我只是猜测，但可能是 DSN cc_mysql 不存在或您的用户名/密码无效，或者 mysql 不允许该用户访问它等。

顺便说一句，这些天你真的应该至少编写 ODBC 3 应用程序，为此你应该调用 SQLAllocHandle、SQLSetEnvAttr（设置 ODBC 行为）、SQLDriverConnect 和 SQLGetDiagRec。

# python - 我可以使用 Linux LiveCD 安装任何东西（比如 Python）吗？

> ID：10572382
> 
> 赞同：-2
> 
> 时间：2012-05-13T14:04:49.657
> 
> 标签：python, linux, unix, linux-mint, live-cd

我暂时需要在 Linux/Unix 机器上使用 Python

例如，我可以运行 Linux Mint LiveCD，然后安装 Python 或模拟安装吗？

或者 LiveCD 是否严格用于**查看**发行版？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:08:23.103

如果您使用的是 LIVE CD-RW/USB，则可以安装该程序。当然，您将无法将程序安装在 CD/DVD 磁盘中。讲的是传统意义上的。可以“安装”该程序以供一次性使用。它将被保存在内存中。重新启动后，它会消失。但是，例如，当使用真实的现场 USB 时，它将被“安装”在媒体中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:16:17.803

此外，几乎每个发行版都带有 python。只需打开一个终端并尝试`python -v`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:10:30.547

首先，你想得到什么？关于live-cd的问题是什么？

> 我暂时需要在 Linux/Unix 机器上使用 Python

大多数发行版都有开箱即用的 Python

> 例如，我可以运行 Linux Mint LiveCD，然后安装 Python 或模拟安装吗？

当然可以。但是重启后会消失。如果您希望它在重新启动后保留，您应该将操作系统安装到 USB 驱动器，而不是像 live-CD 那样使用它。

> 或者 LiveCD 是否严格用于查看发行版？

是的，某种。

# delphi - 使用类函数进行类型转换

> ID：10572384
> 
> 赞同：-1
> 
> 时间：2012-05-13T14:05:26.737
> 
> 标签：delphi, casting

我想使用类函数进行类型转换。我有基础（TBase）、派生（TDer）和类型转换（TMyType）类。

版本：德尔福 7

```
TBase = class;
TDer = class;
TMyType = class;

TBase = class
  function Say : String;
  class function MYType:TMyType;
end;

TDer = class(TBase)
  a: string;
  b: string;
  function Say2 : String;
end;

TMyType=class(TBase)
  class function AsDer:TDer;
end;

{ TBase }

class function TBase.MYType: TMyType;
begin
  Result:=TMyType(Self);
end;

function TBase.Say: String;
begin
   Result:='TBase';
end;

{ TDer }

function TDer.Say2: String;
begin
  Result:='TDer';
end;

{ TMyType }

class function TMyType.AsDer: TDer;
begin
  Assert(Assigned(Self));
  Result := TDer(Self) ;
end; 
```

示例用法如下，它是调用方法，但是当设置/获取字段的引发错误时。

```
procedure TForm1.Button1Click(Sender: TObject);
var
  b,c:TBase;
begin
  b:=TDer.Create;
  c:=b.MYType.AsDer;

  ShowMessage(b.MYType.AsDer.Say2); // OK. Running      
  if (@b<>@c) then ShowMessage('Not Equal');  // Shows message, Why ?
  b.MYType.AsDer.a:='hey'; // Error

  FreeAndNil(b);
end; 
```

你有什么主意吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-13T14:37:06.977

根本问题在这里：

```
class function TBase.MYType: TMyType;
begin
  Result:=TMyType(Self);
end; 
```

这是一个类方法，因此`Self`指的是一个*类*而不是一个*实例*。将其转换为实例并不会使其如此。`AsDer`您的类函数中也出现了完全相同的错误。

调查细节，呼吁

```
b.MYType.AsDer.Say2 
```

是良性的，并且似乎可以正常工作，因为它不涉及`Self`. 您同样可以编写`TDer(nil).Say2`，并且该代码也可以毫无问题地工作。现在，如果`Say2`引用的函数`Self`，即引用的实例，则会出现运行时错误。

```
@b<>@c 
```

总是评估为真，因为您正在比较两个不同局部变量的位置。

```
b.MYType.AsDer.a 
```

是运行时错误，因为`AsDer`不返回`TDer`. 因此，当您尝试写入时，`a`您会遇到运行时错误。这是因为您指的是`Self`，这就是该代码失败的原因，但之前的调用`Say2`没有。

* * *

我不太确定你想在这里做什么，但它看起来全错了。即使您使用的是实例方法而不是类方法，将基类实例大小写为派生类实例也是错误的。如果某样东西是错误的类型，再多的转换也不会将它变成正确的类型。

此外，您永远不应该编写具有`TBase`假设它是 type的方法的代码`TDerived`。基类应该完全不知道它的派生类。这是 OOP 设计的基本原则之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T05:06:19.117

这是编辑后的新版本：

```
TBase = class;
TDer = class;
TMyType = class;

TBase = class
  MYType:TMyType;
  constructor Create;
  destructor Destroy;
  function Say : String;
end;

TDer = class(TBase)
  a: string;
  b: string;
  function Say2 : String;
end;

TMyType=class
public
  T: TObject;
  function AsDer:TDer;
end;

{ TBase }

constructor TBase.Create;
begin
  MYType:=TMYType.Create;
  MYType.T:=TObject(Self);
end;

destructor TBase.Destroy;
begin
  MYType.Free;
end;

function TBase.Say: String;
begin
  Result:='TBase';
end;

{ TDer }

function TDer.Say2: String;
begin
  Result:='TDer';
end;

{ TMyType }

function TMyType.AsDer: TDer; 
begin
  Result := TDer(T) ;
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  b:TBase;
  c:TDer;
begin
  b:=TDer.Create;
  TDer(b).a:='a';
  c:=b.MYType.AsDer;

  ShowMessage('b.MYType.AsDer='+b.MYType.AsDer.a+', c.a ='+ c.a); // OK. Running
  FreeAndNil(b);
end; 
```

# assembly - 如何将寄存器中的数据放入汇编中的缓冲区

> ID：10572386
> 
> 赞同：0
> 
> 时间：2012-05-13T14:05:44.850
> 
> 标签：assembly, nasm

所以我正在尝试编写一个汇编程序，显示命令行参数的十六进制地址，然后是命令行参数本身，例如

```
0x01234567: command line argument 1 
```

我已将字符串的地址加载到寄存器中，并尝试将其放入缓冲区以将其从十六进制转换为文本，以便在终端中正确显示。

如果我执行以下操作将第一个字符串的地址加载到 ebx 中，

```
lea ebx,[ArgPtrs+edi*4] 
```

有没有办法将该值移动到缓冲区中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T17:04:31.447

想通了，这只是一些组装成长的痛苦和糟糕的语法。

我最初的想法是——

```
lea ebx,[ArgPtrs+edi*4]
mov [AddrBuff+edi*4],ebx 
```

只需在 mov 指令中添加 dword 即可使其成为合法指令。

```
mov dword [AddrBuff+edi*4],ebx 
```

# iphone - 如何向 UIImagePickerController 添加指标

> ID：10572387
> 
> 赞同：4
> 
> 时间：2012-05-13T14:05:56.343
> 
> 标签：iphone, ios, uiimagepickercontroller, uiactivityindicatorview

我有一个图像选择器可以从照片库中选择多个图像。选择的照片将调整大小并保存到`imagePickerController:didFinishPickingMediaWithInfo:`. 这需要几秒钟。

我可以在视图上放置一个指示器吗？我曾尝试`addSubview:indicatorView`在`imagePickerController:didFinishPickingMediaWithInfo:`方法中使用。但是没有出现*indicatorView 。*它被 imagePickerView 解散。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:24:04.447

您应该在视图层次结构的顶部添加 UIActivityIndi​​catorView，否则它将被 UIPickerViewController 解除，除非您在调整大小操作后使用回调并且在回调中解除 UIImagePickerController。

或者你可以使用像[SVProgressHUD](https://github.com/samvermette/SVProgressHUD)这样的进度 HUD 。

希望这会有所帮助=)

我们做了一个小聊天并以这种方式解决：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{ 
    dispatch_async(dispatch_get_main_queue(), ^{ 
          UIView *primaryImage = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,460)]; 
          primaryImage.backgroundColor = [UIColor redColor]; 
          primaryImage.alpha =0.9; 

          UIView *secondaryImage = [[UIView alloc] initWithFrame:CGRectMake(0,0,70,70)]; 
          secondaryImage.center = CGPointMake(160, 240); 
          secondaryImage.backgroundColor = [UIColor blackColor]; 
          secondaryImage.alpha = 0.9; 
          secondaryImage.layer.cornerRadius = 12; 
          [primaryImage addSubview:secondaryImage]; 
          UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc] initWithFrame:CGRectMake(0, 0, 25, 25)]; 
          indicator.center = CGPointMake(35, 35); 
          [indicator setHidesWhenStopped:NO]; 
          [secondaryImage addSubview:indicator]; 
          [indicator startAnimating]; 

          [indicator release]; 
          [secondaryImage release]; 

          [picker.view addSubview:primaryImage]; 

         [primaryImage release]; 
     }); 

    // Put here the code to resize the image 

    dispatch_async(dispatch_get_main_queue(), ^{ 
    // Dismiss the picker controller

    });
}); 
```

# android - android中EditView中的可点击链接和复制/粘贴菜单

> ID：10572389
> 
> 赞同：6
> 
> 时间：2012-05-13T14:05:59.250
> 
> 标签：android, hyperlink, copy, android-edittext

`EditText`我在我的 Android 应用中有一个视图。我需要其中的“内部链接”，这意味着我需要一些按钮或跨越内部`EditText`，并且使用`onClick`此按钮我可以执行一些操作（而不是重定向到网页）。`ClickableSpan()`我用这样的方式实现了这个按钮

```
linkWord = "my link";
link = new SpannableString(linkWord);
cs = new ClickableSpan(){
private String w = linkWord;
    @Override
    public void onClick(View widget) {
    wrd.setText(w);
    }
};
link.setSpan(cs, 0, linkWord.length(), 0);
et.append(link); 
```

为了使这个跨度可点击，我使用了

`et.setMovementMethod(LinkMovementMethod.getInstance());`

“内部链接”工作正常，但使用复制和粘贴项目后，菜单`et.setMovementMethod()`上被禁用。`OnLongClick`这是一个问题，因为我需要“链接”`EditText`并同时从该视图复制文本。

我有想法在侦听器中设置`OnLongClickListener`类似`removeMovementMethod()`临时禁用“链接”功能并使用带有复制/粘贴的菜单并在处理文本后再次打开`setMovementMethod()`方法。但我不知道如何实现这一点。

你能帮助我吗？您可能还有其他方法...

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-08-30T21:49:46.040

我不认为让用户在链接和复制模式之间切换会为你赢得可用性奖。我的解决方案允许您同时选择文本并打开链接。为了实现这一点，我简单地扩展了允许选择文本的 ArrowKeyMovementMethod，并从处理链接的点击/触摸的 LinkMovementMethod 添加了 onTouchEvent() 方法。只有一行代码需要更改，即在触摸屏幕的坐标处找不到链接时从 TextView 中删除选择的代码。

这是完整的课程：

```
public class MyMovementMethod extends ArrowKeyMovementMethod {

    private static MyMovementMethod sInstance;

    public static MovementMethod getInstance() {
        if (sInstance == null) {
            sInstance = new MyMovementMethod ();
        }
        return sInstance;
    }

    @Override
    public boolean onTouchEvent(TextView widget, Spannable buffer, MotionEvent event) {
        int action = event.getAction();

        if (action == MotionEvent.ACTION_UP ||
            action == MotionEvent.ACTION_DOWN) {
            int x = (int) event.getX();
            int y = (int) event.getY();

            x -= widget.getTotalPaddingLeft();
            y -= widget.getTotalPaddingTop();

            x += widget.getScrollX();
            y += widget.getScrollY();

            Layout layout = widget.getLayout();
            int line = layout.getLineForVertical(y);
            int off = layout.getOffsetForHorizontal(line, x);

            ClickableSpan[] link = buffer.getSpans(off, off, ClickableSpan.class);

            if (link.length != 0) {
                if (action == MotionEvent.ACTION_UP) {
                    link[0].onClick(widget);
                }
                else if (action == MotionEvent.ACTION_DOWN) {
                    Selection.setSelection(buffer, buffer.getSpanStart(link[0]), buffer.getSpanEnd(link[0]));
                }

                return true;
            }
            /*else {
                that's the line we need to remove
                Selection.removeSelection(buffer);
            }*/
        }

        return super.onTouchEvent(widget, buffer, event);
    }

} 
```

即使文档说明，这样做也非常安全：

> 此接口 [MovementMethod] 旨在供框架使用；它不应该由应用程序直接实现。 [http://developer.android.com/reference/android/text/method/MovementMethod.html](http://developer.android.com/reference/android/text/method/MovementMethod.html)

上面的代码扩展了文档类而不是实现接口。它所做的只是添加一个检查以查看是否点击了链接，否则使用超类方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T14:34:01.333

我解决了这个问题，可能这对某人来说会很有趣......

对于我使用的 EditText 内的可点击链接

```
et.setMovementMethod(LinkMovementMethod.getInstance()); 
```

在这种情况下，在 longClick 菜单中没有复制/粘贴项目。为了激活它们，我需要回到正常的 EditText 状态，我可以这样做：

```
et.setMovementMethod(ArrowKeyMovementMethod.getInstance()); 
```

使用此方法后链接将不起作用，但会出现正常的 longClick 菜单。

因此，我在上下文菜单中添加了新项目并在这两个选项之间切换：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    if(et.getSelectionStart() == -1){ // in case of setMovementMethod(LinkMovementMethod.getInstance())
        menu.add(0, 1, 0, "Enable copy");
    }
    else{
        menu.add(0, 2, 0, "Enable links");
    }
}
@Override
public boolean onContextItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case 1:
          et.setMovementMethod(ArrowKeyMovementMethod.getInstance());
          et.setSelection(0, 0);
              //re-register EditText for context menu:
          unregisterForContextMenu(et);
          registerForContextMenu(et);
          break;
      case 2:
          et.setMovementMethod(LinkMovementMethod.getInstance());
          break;
      }
      return true;
  } 
```

我还为上下文菜单注册了 EditText：

```
registerForContextMenu(et); 
```

希望这会对某人有所帮助！

# java - 如何快速计算我的点给定距离内的点

> ID：10572390
> 
> 赞同：2
> 
> 时间：2012-05-13T14:06:17.877
> 
> 标签：java, math, geometry, coordinates

我有大量的经度和纬度，我想快速找出哪些在某个经度纬度的 5 公里半径范围内。

我应该能够非常快速地执行 n do 产品，而不是使用数据结构（这将是矫枉过正）。我刚刚做错了什么，似乎看不到什么。

我一直在尝试在 Java 中实现这一点：

```
 final List<CoOrds> coOrds = Create20x20Grid();

        // Determine point X (centre of earth)
        final Vector2 X = new Vector2(0,0);

        // My CoOrd I want to check
        final double srclon = coOrds.get(0).getLongitude();
        final double srclat = coOrds.get(0).getLatitude();

        final Vector2 A = new Vector2(srclon, srclat, true);

        final double brng = 0;
        final double d = 5;
        final double R = 6371.1;
        double dist = 0;

        dist = d / R; // convert dist to angular distance in radians

        final double lat1 = Math.toRadians(srclat);
        final double lon1 = Math.toRadians(srclon);

        final double lat2 = Math.asin(Math.sin(lat1) * Math.cos(dist)+ Math.cos(lat1) * Math.sin(dist) * Math.cos(brng));
        double lon2 = lon1 + Math.atan2(Math.sin(brng) * Math.sin(dist) * Math.cos(lat1),Math.cos(dist) - Math.sin(lat1) * Math.sin(lat2));

        // normalise to -180..+180º
        lon2 = (lon2 + 3 * Math.PI) % (2 * Math.PI) - Math.PI;

        //Create another point which is the distance is d away from your point
        final Vector2 B = new Vector2(Math.toDegrees(lon2),Math.toDegrees(lat2), true);

        // Create a vector from X->A
        final Vector2 X_A = new Vector2((A.getX() - X.getX()),(A.getY() - X.getY()));
        // Create a vector from X->B
        final Vector2 X_B = new Vector2((B.getX() - X.getX()),(B.getY() - X.getY()));

        // Normalize XA
        final Vector2 nX_A = X_A.normalize();
        // Normalize XB
        final Vector2 nX_B = X_B.normalize();

        // Calculate the Dot Product
        final Double Alpha = nX_A.dot(nX_B);

        int count = 0;
        for (final CoOrds c : coOrds) {

            final Vector2 P = c.getPosition();
            final Vector2 X_P = new Vector2((P.getX() - X.getX()),(P.getY() - X.getY()));

            final Vector2 nX_P = X_P.normalize());
            final Double Beta = nX_A.dot(nX_P);

            if (Beta < Alpha) {
                System.out.println(count + " -- " + Beta + " : " + Alpha);
                count++;
            }

        }

        System.out.println("Number of CoOrds within Distance : " + count); 
```

新点 P 是正确的，因为我已将其加载到 Google 地图中，但我不完全确定我的计算是否正确。

我创建了一个自定义 Vector2 类，它存储经度和纬度。它还将它们转换为笛卡尔：

```
 private void convertSphericalToCartesian(final double latitude, final double longitude) {

    x = (earthRadius * Math.cos(latitude) * Math.cos(longitude)) ;
    y = (earthRadius * Math.cos(latitude) * Math.sin(longitude)) ;
} 
```

点积：

```
 public double dot(final Vector2 v2) {

    return ((getX() * v2.getX()) + (getY() * v2.getY()));

} 
```

规范化：

```
 public Vector2 normalize() {

    final double num2 = (getX() * getX()) + (getY() * getY());
    final double num = 1d / Math.sqrt(num2);

    double a = x;
    double b = y;

    a *= num;
    b *= num;

    return new Vector2(a, b);
} 
```

对此的任何帮助将不胜感激

我使用了这个网站：[http](http://www.movable-type.co.uk/scripts/latlong.html) ://www.movable-type.co.uk/scripts/latlong.html 来帮助我计算 B 点。

我使用了这个网站：[http](http://rbrundritt.wordpress.com/2008/10/14/conversion-between-spherical-and-cartesian-coordinates-systems/) : //rbrundritt.wordpress.com/2008/10/14/conversion-between-spherical-and-cartesian-coordinates-systems/ 帮助我将球坐标转换为笛卡尔坐标。

谢谢

[编辑]

我目前正在运行的测试用例是：

0-0-0

2-2-0

1-2-0

上面是9个点的网格。我正在检查的点是“1”。我希望它能够返回所有点“2”。但它正在返回网格中的所有点。我已经手动检查了谷歌地图上的距离，它应该只返回点“2”。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:29:30.493

从上面的评论中，您不确定您的公式是否准确。

第一步是弄清楚这一点。

选择地球上的一些知名点（北极、南极、英国格林威治等），并创建一个使用这些坐标调用 convertSphericaltoCartesian() 的测试用例。检查结果，看看它们是否有意义。

# javascript - 输入计算

> ID：10572394
> 
> 赞同：3
> 
> 时间：2012-05-13T14:07:19.623
> 
> 标签：javascript

我有几个表格，如下所示：

```
<table id="table1">
<tr>
    <th>Item</th>
    <th>Price</th>
</tr>
<tr>
    <td>Item 1</a></td>
    <td><input type="text" name="sum1" id="sum1" /></td>
</tr>
<tr>
    <td>Item 2</a></td>
    <td><input type="text" name="sum2" id="sum2" /></td>
</tr>
<tr>
    <td>Item 3</td>
    <td><input type="text" name="sum3" id="sum3" /></td>
</tr>
<tr>
    <td>&nbsp;</td>
    <td>Total:</td>
    <td>$total </td>
</tr>
</table>

<table id="table2">
<tr>
    <th>Item</th>
    <th>Price</th>
</tr>
<tr>
    <td>Item 1</a></td>
    <td><input type="text" name="sum1" id="sum1" /></td>
</tr>
<tr>
    <td>Item 2</a></td>
    <td><input type="text" name="sum2" id="sum2" /></td>
</tr>
<tr>
    <td>Item 3</td>
    <td><input type="text" name="sum3" id="sum3" /></td>
</tr>
<tr>
    <td>Item 4</td>
    <td><input type="text" name="sum4" id="sum4" /></td>
</tr>
<tr>
    <td>&nbsp;</td>
    <td>Total:</td>
    <td>$total</td>
</tr>
</table> 
```

有谁知道是否有可能对每个输入的项目价格求和（分别为 table1、table2 等。）最后打印所有项目的项目总和？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:10:33.223

您将需要一个 dom 操纵器，如 jQuery 或简单的 javascript。我会给这些字段一个类，让它更容易——比如“sum”。然后您可以从父表中获取所有子“总和”。将它们的值解析为 int 并添加。还不错。

[这是一个有效的 JS 小提琴示例](http://jsfiddle.net/kJX5b/13/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:13:30.923

使用jquery这应该很容易，假设您可以在每个输入中添加一个名为“line-item”或其他名称的类名，并在应该显示计算总和的单元格中添加一个类名“total”，您可以这样做

```
function calculateSum(tableId){
 var sum = 0;
 $(tableId + ' .line-item').each(function(){
   var value = parseFloat($(this).val().trim());
   if(value){
    sum += parseFloat($(this).val());
   }
 });
 $(tableId + ' .total').html(sum);
} 
```

并使用您想要的表的 id 调用此函数。

如果你不能添加一个类名，这不会得到 tuffer 甚至一点点，但不是`.line-item`试图把 just `input`，它应该在这种情况下做的伎俩。而不是 .total 你可以写`tr:last-child td:nth-child(2)`

更新：添加“parseInt”以避免字符串连接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T14:13:49.513

更好的方法是不要调用具有相似 ID 的不同元素，这是无效的方法。但即使是这样 - 您也可以简单地使用该表中的输入为每个表执行计算。

算法：

1.  您为所有 <table> 标签运行循环。
2.  对于每个 <table> 标签，您都可以找到所有 <input>（无论它们有什么 ID）；
3.  计算当前表的所有输入的总和。

你可以用 JavaScript 做到这一点，但更适合你的是 jQuery。

但是：不要调用具有相似 ID 的 HTML DOM 元素。这是错的！！！

# android - 在android语音输入识别器中预处理音频

> ID：10572396
> 
> 赞同：0
> 
> 时间：2012-05-13T14:07:45.830
> 
> 标签：android, speech-recognition, audio-processing

我正在做一些基本的命令识别并为此使用 Google Search Input API。但是我想自己捕获音频，预处理音频（去噪，提升幅度等），将这些修改后的音频发送到识别器并获得结果。是否可以？

我知道您可以使用`SpeechRecognizer`with`RecognitionListener`来获取音频 using`onBufferReceived`方法。但是我想做预处理而不是后处理。是否有任何解决方法/黑客向谷歌识别器提供处理过的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T05:16:38.960

> 预处理音频（去噪、提升幅度等），将修改后的音频发送到识别器并获得结果

通常语音识别系统会遇到这种情况。不正确实施的去噪会降低语音识别的准确性，因为它会以不可预测的方式破坏频谱。幅度提升没有帮助，因为幅度在语音识别的一开始就被归一化。您的预处理只会造成伤害。

如果你还想试试，试试pocketsphinx

[http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/](http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/)

# java - 如何轻松地在字节数组中压缩和解压缩字符串？

> ID：10572398
> 
> 赞同：12
> 
> 时间：2012-05-13T14:07:50.013
> 
> 标签：java, string, compression

我有一些字符串，每个字符串大约有 10K 个字符。其中有很多重复。它们是序列化的 JSON 对象。我想轻松地将它们压缩成一个字节数组，然后从一个字节数组中解压缩它们。

我怎样才能最容易地做到这一点？我正在寻找方法，以便可以执行以下操作：

```
String original = "....long string here with 10K characters...";
byte[] compressed = StringCompressor.compress(original);
String decompressed = StringCompressor.decompress(compressed);
assert(original.equals(decompressed); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-13T14:22:10.890

你可以试试

```
enum StringCompressor {
    ;
    public static byte[] compress(String text) {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        try {
            OutputStream out = new DeflaterOutputStream(baos);
            out.write(text.getBytes("UTF-8"));
            out.close();
        } catch (IOException e) {
            throw new AssertionError(e);
        }
        return baos.toByteArray();
    }

    public static String decompress(byte[] bytes) {
        InputStream in = new InflaterInputStream(new ByteArrayInputStream(bytes));
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        try {
            byte[] buffer = new byte[8192];
            int len;
            while((len = in.read(buffer))>0)
                baos.write(buffer, 0, len);
            return new String(baos.toByteArray(), "UTF-8");
        } catch (IOException e) {
            throw new AssertionError(e);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-17T06:30:12.320

使用这个不太复杂的解压缩函数代码可以稍微改进彼得劳里的答案

```
 ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try {
        OutputStream out = new InflaterOutputStream(baos);
        out.write(bytes);
        out.close();
        return new String(baos.toByteArray(), "UTF-8");
    } catch (IOException e) {
        throw new AssertionError(e);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-16T19:00:01.370

我制作了一个库来解决压缩通用字符串（特别是短字符串）的问题。它尝试使用各种算法（纯 utf-8、5 位拉丁字母编码、huffman 编码、gzip 用于长字符串）压缩字符串，并选择结果最短的算法（在最坏的情况下，它将选择 utf-8编码，这样您就永远不会冒丢失空间的风险）。

我希望它可能有用，这是链接 [https://github.com/lithedream/lithestring](https://github.com/lithedream/lithestring)

编辑：我意识到你的字符串总是“长”的，我的库默认为这些大小的 gzip，我担心我不能为你做得更好。

# c# - 连接未从 WCF 与 dsn 打开

> ID：10572399
> 
> 赞同：0
> 
> 时间：2012-05-13T14:07:54.563
> 
> 标签：c#, wcf, oledb, oledbconnection, dsn

此代码是用 WCF 编写的。当我从 localhost 添加引用时，此代码工作正常，但是当从 IIS 添加服务引用时，它在 cn.Open() 中失败。它不会抛出任何异常，只是挂在这一行。

```
 OdbcConnection cn = new OdbcConnection();
        cn.ConnectionString = "DSN=myDsn;Uid=myuid;Pwd=mypassword;";
        cn.Open(); // Fails on this line 
```

或者有没有其他方法可以在 C# 中使用 dsn 获取数据源名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:20:31.813

确保将 DSN 创建为系统 DSN 而不是用户 DSN。如果它是作为用户 DSN（作为您）创建的，那么 IIS 服务用户将无权访问它。

# scala - 关于 Java 和 Scala 中的泛型

> ID：10572403
> 
> 赞同：16
> 
> 时间：2012-05-13T14:08:09.840
> 
> 标签：scala, generics, subtyping

我对通用子类型感到困惑。

在 Java 中，如果 type`A`是 的子类型，则`B`泛型类型是不变的。例如，不是 的子类型。`C<A>``C<B>``ArrayList<Base>``ArrayList<Derived>`

`C<A>`但是，在 Scala 中，`C<B>`如果 type`A`是`B`. 那么Scala中泛型类的属性是什么，而Java中没有呢？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-13T14:58:03.220

首先请注意，方差是泛型*类型参数*的属性，而不是*参数化类型*本身的属性。

其次：您对 scala 的看法是错误的 - 默认情况下，类型参数是不变的。让我们调查一下！

## 爪哇

Java 有*使用点差异注释*。也就是说，您可以像这样声明方法：

```
boolean addAll(Collection<? extends T> c); 
```

然而，有一种形式的“参数化类型”（我使用松散的术语），其中类型参数是协变的：Java 数组！（这实际上很疯狂，因为数组是可变的，因此很容易绕过类型系统）。考虑以下：

```
public static void subvert(Object[] arr) { arr[0] = "Oh Noes!"; } 
```

进而：

```
Integer[] arr = new Integer[1];
subvert(arr); //this call is allowed as arrays are covariant
Integer i = arr[0]; 
```

一个很好的面试问题：*会发生什么？*

## 斯卡拉

在 Scala 中，您有**声明站点变量**。也就是说，类型参数的方差与参数一起声明（使用注释`+`和`-`）：

```
trait Function1[-I, +O] 
```

这表示特征`Function1`有两个类型参数，`I`它们`O`分别是反变体和协变体。**如果没有`+/-`声明注释**，则**类型参数是不变的**。例如，Set 在其类型参数中是不变的：

```
scala> def foo(set: Set[Any]) = ()
foo: (set: Set[Any])Unit

scala> Set(1)
res4: scala.collection.immutable.Set[Int] = Set(1)

scala> foo(res4)
<console>:10: error: type mismatch;
 found   : scala.collection.immutable.Set[Int]
 required: Set[Any]
Note: Int <: Any, but trait Set is invariant in type A.
You may wish to investigate a wildcard type such as `_ <: Any`. (SLS 3.2.10)
              foo(res4)
                  ^ 
```

然而，列表被声明为协变的：

```
scala> def bar(list: List[Any]) = ()
bar: (list: List[Any])Unit

scala> List(1)
res6: List[Int] = List(1)

scala> bar(res6) 
```

## 为什么不问编译器？

另一种证明这一点的方法是直接向编译器询问子类型证据：

```
scala> class Cov[+A]
defined class Cov

scala> implicitly[Cov[Int] <:< Cov[Any]]
res8: <:<[Cov[Int],Cov[Any]] = <function1> 
```

但是有一个不变的类型参数

```
scala> class Inv[A]
defined class Inv

scala> implicitly[Inv[Int] <:< Inv[Any]]
<console>:9: error: Cannot prove that Inv[Int] <:< Inv[Any].
              implicitly[Inv[Int] <:< Inv[Any]]
                        ^ 
```

最后，逆变：

```
scala> class Con[-A]
defined class Con

scala> implicitly[Con[Any] <:< Con[Int]]
res10: <:<[Con[Any],Con[Int]] = <function1> 
```

[另见标识符`<:<`](https://stackoverflow.com/questions/2603003/operator-in-scala)

# hibernate - 如何克服Hibernate中union-subclass生成SQL导致的性能问题

> ID：10572408
> 
> 赞同：6
> 
> 时间：2012-05-13T14:08:43.663
> 
> 标签：hibernate, jpa, union-subclass

我正在使用 Hibernate 对 TABLE_PER_CLASS 继承策略的支持。功能方面它运作良好。每当发出多态查询时，Hibernate 都会为我的两个具体类 A 和 B 生成一个包含“union all”的 SQL。生成的 SQL 具有以下格式：

```
select C1, C2, C3 from (
    select C1, C2, C3 from ClassA
  union all
    select C1, C2, C3 from ClassB
)
where 
    C1 == <value>
order by C2
limit 100 
```

这种方法的问题在于数据库端的性能非常差。考虑到 C1 列是 ClassA 和 ClassB 的共享属性（派生自抽象父级），Hibernate 可以在两个子选择中插入 where 子句并显着提高性能。例如，

```
select C1, C2, C3 from ( 
    select C1, C2, C3 from ClassA where C1 == <value>
    union all
    select C1, C2, C3 from ClassB where C1 == <value>
)
order by C2
limit 100 
```

也可以在极限上做一些优化。我在我的 DAO 层中使用 Hibernate 标准 API。

拦截器，onPrepareStatment() 无法使用，因为参数不可见。在数据库上使用分区和可能的其他选项目前超出了范围，因为我们希望在此工作阶段避免特定于数据库的优化。

知道如何操纵休眠以提高性能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T08:45:44.820

我你想要比我不建议使用 table-pr-class 和许多或巨大的多态查询更高的跨数据库性能。鉴别器列通常会更好。

请注意，如果您的类层次结构中有两个以上的级别，则可以将 table-pr-class 与 discrimantor-columns 结合使用。

# php - PHP：从文件名中删除无用的部分

> ID：10572410
> 
> 赞同：-1
> 
> 时间：2012-05-13T14:09:02.650
> 
> 标签：php, arrays, file

我有一个文件列表（在数组中）：

```
C:\Data\..\Users\admin\history.dat
C:\\Users\admin\..\user\history.dat
C:\Users\..\Data\debug.log 
```

我怎样才能删除不必要的部分，所以列表将如下所示：

```
C:\Users\admin\history.dat
C:\Users\user\history.dat
C:\Data\debug.log 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:12:19.277

使用[`realpath()`](http://www.php.net/manual/en/function.realpath.php)功能...

# ipad - 用于 ipad 横向折叠栏的 Twitter 引导程序

> ID：10572411
> 
> 赞同：2
> 
> 时间：2012-05-13T14:09:11.020
> 
> 标签：ipad, twitter-bootstrap, responsive-design

我正在使用 twitter 引导程序库构建一个网站，这样我就可以拥有一个可以在 ipad 和触摸电话设备上运行的网站。到目前为止，我的网站在所有浏览器、PC ipad 和手机上看起来都很棒，但是 ipad 只能在纵向上正常工作。在纵向时，它的角落有一个可爱的按钮，可以打开扩展菜单。

我希望这也适用于景观，但似乎无法让它发挥作用。

有人可以告诉我我需要查看的 CSS 中的位置，如果可能的话，我正在寻找什么屏幕尺寸以使折叠栏出现在横向中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T15:47:52.630

回答我自己的问题。以防其他人有同样的问题：

iPad 屏幕分辨率为 1024 x 768，因此在横向模式下，它呈现为一个完整的网页。

有办法通过检测设备的浏览器用户代理来克服这个问题。

有关更多信息，请参阅：[检查 iPad 用户代理](http://www.htmlgoodies.com/beyond/webmaster/toolbox/article.php/3888106/How-Can-I-Detect-the-iPhone--iPads-User-Agent.htm)

# php - PHP，了解 MVC 和 Codeigniter

> ID：10572412
> 
> 赞同：2
> 
> 时间：2012-05-13T14:09:51.553
> 
> 标签：php, model-view-controller, codeigniter, model

我正在尝试了解 MVC，并学习 CI 框架。我有一些关于 MVC 的问题和一些关于 CI 的基本问题。

1）当我从教程中阅读时，视图是应用程序的视觉部分，我的问题是：例如，有一个“登录”按钮，但如果用户已经登录，按钮将是“注销”。登录检查在哪里？在控制器上还是在视图上？我的意思是

```
 //this is view//

     <?php if($_SESSION('logged') == true):?>
     <a href="logout">Logout</a>
     <?php else: ?>
     <a href="login">login</a>        
     <?php endif; ?> 
```

或者

```
 //this is controller//

 if($_SESSION('logged') == true)
 $buttonVal = 'logout';
 else
 $buttonVal = 'login';

 //and we pass these value to view like
 $this->view->load('header',$someData);

 //this time view is like
 <a href="<?=$somedata['buttonVal']?>"><?=$somedata['buttonVal']?></a> 
```

我只是写这些代码作为示例，我知道它们不会工作，它们是虚构的代码，但我想你明白我的意思。登录检查应该在控制器上还是在视图上？

2）模型应该只包含关于数据的代码并将它们返回给控制器吗？例如有一个数学，我们从数据库中获取 2 个值并将它们相乘并显示它们。模型会成倍增加还是控制器会做？

在这里，我们使用模型加载数据并在控制器上进行数学运算：//模型

```
 $db->query(....);
   $vars=$db->fetchAll();

   return $vars;

   //controller
   $multi = $vars[0] * $vars[1];
   $this-load->view('bla.php',$mutli); 
```

在这里，我们使用模型加载数据并对模型进行数学运算，控制器只是将数据从模型传递到视图：

```
 //model

   $db->query(....);
   $vars=$db->fetchAll();
   $multi = $vars[0] * $vars[1];
   return $multi;

   //controller
   $multi = $this->model->multiply();
   $this-load->view('bla.php',$mutli); 
```

我的意思是，模型应该只做数据库工作并将数据传递给控制器​​，控制器做剩下的工作并将视图发送到渲染？或者模型确实有效，控制器获取它们并将它们发送到视图？

3）这是关于codeigniter的，我有一个必须在每个页面中的标题，但它有javascripts，css取决于我正在使用的页面

```
 <?php foreach ($styles as $style): ?>
        <link id="stil" href="<?= base_url() ?>/css/<?= $style ?>.css" rel="stylesheet" type="text/css" />
        <?php endforeach; ?> 
```

这将在每个页面上，所以在我拥有的每个控制器中

```
$data['styles'] = array('css1','css2');
$this->load->view('header', $headers); 
```

我正在考虑做一个主控制器，在里面写这个，我所有的其他控制器都会扩展这个，我在 CI wiki 上看到了 MY_Controller，这个 MY_Controller 和我正在做的一样吗？还有其他方法可以做到这一点吗？

很抱歉英语不好和愚蠢的问题。感谢您的回答。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T14:28:14.810

这绝对是视图逻辑，在我看来是正确的做法：

```
 <?php if($logged_in):?>
 <a href="logout">Logout</a>
 <?php else: ?>
 <a href="login">login</a>        
 <?php endif; ?> 
```

的值`$logged_in`可能会从对库方法的调用中检索：

```
<?php if ($this->auth->logged_in()): ?> 
```

身份验证是您希望全局访问的内容之一，因此您可能`$this->auth->logged_in()`出于不同原因调用控制器或视图（但可能不在模型中）。

> 在我拥有的每个控制器中
> 
> `$data['styles'] = array('css1','css2');`
> `$this->load->view('header', $headers);`

是的，您可以使用 扩展控制器类`MY_Controller`，但最好将其保留在视图/表示层中。我通常创建一个主模板：

```
<html>
<head><!-- load assets --></head>
<body id="my_page">
  <header />
  <?php $this->load->view($view); ?>
  <footer />
</body>
</html> 
```

并编写一个用于加载模板的小包装类：

```
class Template {
  function load($view_file, $data) {
      $CI = &get_instance();
      $view = $CI->load->view($view_file, $data, TRUE);
      $CI->load->view('master', array('view' => $view));
  }
} 
```

在控制器中的用法：

```
$this->template->load('my_view', $some_data); 
```

这样可以避免重复加载页眉/页脚。在我看来，展示逻辑，如加载哪个 CSS 文件或页面标题应该尽可能属于视图。

就模型而言，您希望它们可重用 - 所以让它们做您需要的事情并使其与数据操作（通常只是您的数据库）严格相关。让您的控制器决定如何*处理*数据。

与 MVC 无关，但通常您希望编写尽可能少的代码。冗余表明您可能会找到更好的解决方案。这些是广泛的提示（正如您的问题），但希望它有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-13T14:29:10.410

1) 如果需要，视图逻辑应该很简单，并且主要是 if-then 语句。在您的示例中，任何一种情况都可以工作，但使用视图中的逻辑。但是，如果您正在检查登录并在未登录时重定向，那么这将发生在控制器（或库）中。

2) 将 Codeigniter 模型视为访问数据库功能的方式 - 创建、检索、更新、删除。对于 Codeigniter 模型，我的（松散的）经验法则是返回更新、删除或插入查询的结果或获取查询的结果集。然后可以在控制器中进行任何适用的数学运算。如果这是每次都会发生的数学运算，请考虑将其添加到库函数中。见下文...

3）扩展控制器是实现此目的的正确和最佳方法。

*) 不要在您的盘子中添加更多内容，但也一定要了解[Codeigniter 库](http://codeigniter.com/user_guide/general/libraries.html)。例如，在您的控制器中，您可以加载您的库。然后你从你的控制器调用你的库函数。库函数调用一个模型来检索您的数据库结果。然后库函数对该函数执行数学运算并将结果返回给控制器。控制器只剩下很少的代码，但由于库和模型而完成了很多工作。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-13T14:27:38.553

用户登录检查应该在控制器中。这应该是需要在构造函数中调用的第一个函数。

```
Below i have given the sample code which redirects the user to the login page if he is not logged in, hope this would give you some idea,

<?php

class Summary extends Controller {

    function Summary() {
        parent::Controller();
        $this->is_logged_in();
    }

    function is_logged_in() {
        $logged_in = $this->session->userdata('logged_in');
        if (!isset($logged_in) || $logged_in != true) {
            $url = base_url() . 'index.php';
            redirect($url);
            exit();
        }
    }

?> 
```

通过检查视图中的会话变量并相应地做出决策，可以在视图中实现按钮更改。

请看这个[链接](http://codeigniter.com/user_guide/libraries/sessions.html)

# database - 使用 Redis 数据库开发像 DRAW SOMETHING 这样的游戏有什么缺点吗？

> ID：10572414
> 
> 赞同：1
> 
> 时间：2012-05-13T14:10:01.690
> 
> 标签：database, node.js, redis

我正在开发一个类似于流行的手机游戏 - Draw Something 的 Web 应用程序。我正在使用 Node.js 和 Socket.io

该应用程序允许人们绘制图形并将绘制过程逐个像素地存储在服务器端，并在以后根据游戏逻辑重播 - 尽管速度较慢/更快。

这是一个 Web 应用程序，我使用的是 Node.js + Socket.io。你会推荐什么数据库来配合这个？我打算使用 Redis 。Redis 在这种情况下有什么缺点吗？我将主要使用数据库来存储每个绘图的像素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T04:54:16.010

您应该绝对确定您的数据将适合可用内存。在您的情况下，您正在保存每个像素，因此这可能是一个问题。图形很重。

也许，使用 Redis 作为快速的临时存储，并在绘制完成后将数据保存在磁盘上（好处是您可以在后台执行此操作）。当然，您需要在成功保存后从 redis 中清除数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:35:48.097

我不是 redis 专家，但据我了解，redis 可以做到这一点。请务必研究 redis 持久性，因为 redis 更像是内存存储而不是实际的数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T10:45:47.357

只要您寻找水平可伸缩性，并且几乎没有关系数据，我猜 REDIS 最适合。

# jquery - Js 代码未使用 ajax 加载的内容执行

> ID：10572418
> 
> 赞同：0
> 
> 时间：2012-05-13T14:10:32.803
> 
> 标签：jquery, ajax, forms, modal-dialog

我正在使用 Twitter Bootstrap 模式来显示由 ajax 加载的表单。

我单击按钮以显示模式，顺便说一句，它将通过 ajax 获取其内容：

```
$('#team_join_modale_show').on('click', function(e) {
    e.preventDefault();
    var href = $(e.target).attr('href');

    $.get(href, function(data) {
        $(data).modal();
    });
}); 
```

然后，显示名为“#team_join_modal”的模式（之前不在 DOM 中）。上面有一个表格“#ajax_form_team_join”。

```
$('#team_join_modal').on('shown', function () {
    $('#ajax_form_team_join').ajaxForm({
        target:        '#errorTeamJoin',
        clearForm:     true
    });
}); 
```

**问题是片段 $('#ajax_form_team_join').ajaxForm(); 从未执行，因此我的表单无法正常工作。**

我尝试在我的 js 中移动事件，将 .on 更改为 .live，更改为新方法 .on，但没有结果。请问我缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T17:43:15.567

您可以立即在成功的 AJAX 函数中绑定事件。

```
$('#team_join_modale_show').on('click', function(e) {
    e.preventDefault();
    var href = $(e.target).attr('href');
    $.get(href, function(data) {
        var $data = $(data);
        $data
          .on('shown', function () {
            $('#ajax_form_team_join', $data).ajaxForm({
              target: '#errorTeamJoin',
              clearForm: true
            });
          })
          .modal();
    });
}); 
```

不过，这可以更好地重构。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-13T14:56:15.167

```
$('#team_join_modale_show').on('click', function(e){
    e.preventDefault();
    var href = $(e.target).attr('href');
    $.get(href, function(data) {
        $(data).modal();
    });
    $('#ajax_form_team_join').ajaxForm({
        target:'#errorTeamJoin',
        clearForm: true
    });
}); 
```

试试这个。

# c# - 如何跳过 printDocument.print() 中的打印对话框并直接打印页面？

> ID：10572420
> 
> 赞同：16
> 
> 时间：2012-05-13T14:10:49.273
> 
> 标签：c#, .net, winapp

当我`MyPrintDocument.print()`在用 C# 编写的 Windows 应用程序中使用时，会显示一个对话框，用于处理带有取消按钮的 Windows 处理打印例程。我不希望显示此对话框，可以吗？

如果没有，我应该使用哪种方式？我的程序使用热敏打印机。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-13T14:27:42.307

您使用的是哪个[PrintController 。](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printcontroller)

> .NET Framework 包括三个派生自`PrintController`帮助完成常见任务的打印控制器。将`StandardPrintController`文档打印到打印机。`PreviewPrintController`生成文档在打印时的预览，并由和`PrintPreviewControl`类`PrintPreviewDialog`使用。在`PrintControllerWithStatusDialog`打印过程中提供打印状态对话框。

听起来您正在使用.[`PrintControllerWithStatusDialog`](http://msdn.microsoft.com/en-us/library/system.windows.forms.printcontrollerwithstatusdialog) `PrintController`

* * *

*警告：*我无法验证基本的`PrintController`行为方式不同。

根据this [MSDN Forum Posting](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/cb78e90b-bf27-462c-90d3-78d935f49ed1)，这`PrintControllerWithStatusDialog`是默认设置：

他建议这样的事情：

```
MyPrintDocument.PrintController = new System.Drawing.Printing.StandardPrintController(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-13T14:46:11.940

如果您不分配该`PrintDocument.PrintController`属性，那么您将获得一个默认的打印控制器。它的一个实例`PrintControllerWithStatusDialog`显示进度对话框、计算页面数并通常通知用户程序由于某种原因没有响应但没有挂起。

只需在表单构造函数中重新分配它。样板代码是：

```
Public Class Form1
    Public Sub New()
        InitializeComponent()
        PrintDocument1.PrintController = New System.Drawing.Printing.StandardPrintController
    End Sub
End Class 
```

而且您必须做其他事情来告诉用户打印正在进行中。至少显示一个[沙漏光标](https://stackoverflow.com/questions/302663/cursor-current-vs-this-cursor-in-net-c/302865#302865)。

# actionscript-3 - 在 AS3 中推送对象

> ID：10572421
> 
> 赞同：0
> 
> 时间：2012-05-13T14:10:49.887
> 
> 标签：actionscript-3, object

我想知道是否可以将值推送到数组中的对象：

```
array.push("value"); 
```

我想给每种颜色一个字母，比如 a、b、c、.. 它应该是这样的：

```
var colors = { "a" : "ffffff", "b" : "000000" }; 
```

我现在如何添加其他带有字母的颜色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:35:41.963

简单如：

```
colors["c"] = "ff0000";
colors["d"] = "00ff00";
colors["e"] = "0000ff";
// etc 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:46:15.013

您可以从对象、字典或数组中进行选择。但是，如果您想使用“a”、“b”、“c” 作为键，您将需要使用 Object 或 Dictionary 实例。

```
var colors:Object = {};
colors["a"] = "etc.";
colors["b"] = "etc.";
// or
var colors:Object = {};
colors.a = "etc.";
colors.b = "etc.";
// or
var colors:Object = {a:"etc.",b:"etc"}; 
```

# mysql - 如何使用两个值来定义 MySQL 中的顺序但优先考虑其中一个？

> ID：10572430
> 
> 赞同：0
> 
> 时间：2012-05-13T14:12:22.333
> 
> 标签：mysql

我有一个具有以下表格结构的讨论板：

```
+-------------------------------+
|       TABLE: MESSAGES         |
+-------------------------------+
| id             | int(11)      |
+-------------------------------+
| parent         | int(11)      |
+-------------------------------+
| author         | int(11)      |
+-------------------------------+
| last_reply     | datetime     |
+-------------------------------+
| written        | datetime     |
+-------------------------------+
| title          | varchar(256) |
+-------------------------------+
| content        | text         |
+-------------------------------+ 
```

的默认值为`last_reply`NULL。如果回复了一个线程，则`last_reply`其中所有消息的时间将设置为最后一次回复的日期时间。

我想要实现的是对话的顺序，两者都`last_reply`将`written`被考虑，但在可用时`last_reply`将优先考虑`written`。

因此，如果`last_reply`可用，我们将使用该值进行排序。如果没有，我们使用书面。

如果解释不当，我深表歉意。

到目前为止，我最好的镜头是这样的：

```
SELECT *, COALESCE(last_reply,written) AS tmp FROM messages
WHERE parent = 0 ORDER BY written DESC, tmp DESC 
```

这不能正常工作。

如果你明白我的意思，请指导我正确的方向:)

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:16:51.913

```
SELECT * FROM messages
WHERE PARENT=0
ORDER BY IFNULL(last_reply,written) DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:27:49.767

试试这个：

```
SELECT *, COALESCE(last_reply,0) AS with_replay FROM messages
WHERE parent = 0
ORDER BY with_replay DESC,written DESC 
```

# vb.net - 在 vb.net 中自动完成文本框建议

> ID：10572432
> 
> 赞同：1
> 
> 时间：2012-05-13T14:12:34.773
> 
> 标签：vb.net, winforms, autocomplete, textbox

我在 vb.net 文本框中实现了自动完成，但是存在一个问题，即当用户在文本框中键入内容时，自动完成建议列表会闪烁并消失，就像焦点改变时一样

这是代码：

```
 Dim Bl As New ItemBL
        Dim suggestions = DAL.DisplayLikeNameList(Trim(MyTextBox.Text))
        Dim MySource As New AutoCompleteStringCollection()
        MySource.AddRange(suggestions.ToArray)

        With MyTextBox
            .AutoCompleteCustomSource = MySource
            .AutoCompleteMode = AutoCompleteMode.Suggest
            .AutoCompleteSource = AutoCompleteSource.CustomSource
        End With
    End If 
```

我相信 Mdi 形式的问题，因为它在上述代码之后执行了计时器代码：

```
 Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    LblDateAndTime.Text = Now
End Sub 
```

注意：自动完成代码是在子表单中执行的，而不是在 Mdi 表单中，您建议在用户在文本框中书写时保持建议列表“粘性”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T07:25:03.463

我解决了这个问题，

这段代码是在 `Key_Up`事件中编写的，但现在我在`Text_Changed`事件中编写它并且它有效

# matlab - Levenberg-Marquardt 优化

> ID：10572435
> 
> 赞同：-1
> 
> 时间：2012-05-13T14:12:59.620
> 
> 标签：matlab, optimization, newtons-method, levenberg-marquardt

任何人都知道我在哪里可以找到一个 .m (matlab) 文件，其中 Levenberg-Marquardt 修改了牛顿的方法来优化函数？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:29:14.410

我总是从搜索[文件交换](http://www.mathworks.com/matlabcentral/fileexchange/)开始。找到了一个[LMF非线性解](http://www.mathworks.com/matlabcentral/fileexchange/17534-lmfnlsq-solution-of-nonlinear-least-squares)。[在优化工具箱](http://www.mathworks.com/help/toolbox/optim/ug/lsqnonlin.html)中似乎也有一个 lsqnonlin 函数。当然，这会花费一大笔钱，并且会限制代码的可移植性（这是我这些天使用 Python 的众多原因之一）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T14:24:34.553

如果适合您的目的，您可以尝试使用[CMPFIT的](http://www.physics.wisc.edu/~craigm/idl/cmpfit.html)[MATLAB MEX 版本](http://www.imm.dtu.dk/~guuru/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-08T16:14:03.880

在这里试试：http: [//people.cas.uab.edu/~mosya/cl/MATLABcircle.html](http://people.cas.uab.edu/~mosya/cl/MATLABcircle.html)

这是 Chernov 教授的网页，他就此事发表了一些论文和一本书。还有c和matlab源。

# html - 防止html中空格分隔的中文文本中的换行符

> ID：10572439
> 
> 赞同：1
> 
> 时间：2012-05-13T14:13:36.873
> 
> 标签：html, css

我有一些中文文本已用空格分隔，以供学习者使用。例如我喜欢学中文。

我想在 HTML 中呈现这个文本，而不是在单词中引入换行符。我还希望文本可以在单词之间中断。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T14:18:34.570

您可以使用[Unicode Word Joiners (U+2060, HTML Code `&#8288;`)](http://www.fileformat.info/info/unicode/char/2060/index.htm)连接不应在行之间断开的字符。

HTML

```
<span>我 喜&amp;#8288;欢 学 中&amp;#8288;文&lt;/span> 
```

这有效，但不是很语义化。

以下要好得多，因为它不会更改实际文本（这对复制/粘贴很有用），并且您可以使用 CSS 和其他方法（HTML 标题、JavaScript）对其进行格式化并使其具有交互性：

```
span.chineseWord {
  white-space: nowrap;
  padding: 0px 5px;
}
span.chineseWord:hover {
  background-color: yellow;
}
```

```
<span class="chineseWord">我&lt;/span>
<span class="chineseWord">喜欢</span>
<span class="chineseWord">学&lt;/span>
<span class="chineseWord">中文</span>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T17:35:56.593

使用不间断空格 (U+00A0) 而不是普通空格，您可以在很大程度上防止在您希望有一些空间的特定位置出现换行符。（我写了“大部分”，因为浏览器并不十分一致地实现不间断空格语义。）但是在中文文本中这样做只会让浏览器在没有使用空格的位置在中文字符之间断行 - 在现代浏览器上。

现代浏览器一般会实现部分[Unicode 换行规则](http://unicode.org/reports/tr14/)，它定义了汉字之间一般允许换行，除非有特定规则禁止。

如果您希望防止一段文本中的**所有**换行符，那么最有效的方法是拍打标签`<nobr>`并`</nobr>`围绕它。如果您希望以牺牲一些功能为代价来符合标准，请将该段设置为一个元素，例如，并在 CSS 中`span`分配给它。`white-space: nowrap`如果您希望允许在此类段内的特定位置换行，请使用（空）标签`<wbr>`或 U+200B 字符（例如，您可以通过写入 来包含它`&#x200b;`）。

更多信息：[http ://www.cs.tut.fi/~jkorpela/html/nobr.html](http://www.cs.tut.fi/~jkorpela/html/nobr.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-09T09:28:38.247

在这个问题发布几年后，`word-break: keep-all`Firefox 15 和 Chrome 44 终于支持了。这将是 OP 想要的：

```
.text {
  word-break: keep-all;

  resize: both;
  overflow: hidden;
  border: 1px solid #aaa;
}
```

```
<div class="text">我 家 的 后面 有 一个 很大 的 园 ， 相传 叫作 百草园 。 现在 是 早已 并 屋子 一起 卖 给 朱文公 的 子孙 了 ， 连 那 最 末次 的 相见 也 已经 隔 了 七八年 ， 其中 似乎 确凿 只有 一些 野草 ； 但 那时 却是 我的 乐园 。&lt;/div>
```

# entity-framework - 使用 Entity Framework Code First 时如何忽略属性

> ID：10572442
> 
> 赞同：60
> 
> 时间：2012-05-13T14:13:55.660
> 
> 标签：entity-framework, code-first

Entity Framework Code First 将根据模型在数据库中自动创建一个表。

有没有可以避免这种情况的属性？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-05-13T14:17:28.867

将属性添加[`[System.ComponentModel.DataAnnotations.Schema.NotMapped]`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.notmappedattribute.aspx)到属性。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-12-31T20:24:51.687

根据[接受的答案](https://stackoverflow.com/a/10572463/1037948)和[类似的问题/答案](https://stackoverflow.com/a/10385738/1037948)，除了`[NotMapped]`您还可以使用 Fluent API 指定它：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
   modelBuilder.Entity<TheModelAffected>().Ignore(t => t.TheIgnoredProperty);
   base.OnModelCreating(modelBuilder);
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-03-11T17:56:38.917

`[NotMapped]`如果您喜欢简洁，则为简短版本。当然，您会添加：

```
using System.ComponentModel.DataAnnotations.Schema; 
```

到你的班级。

# clojure - 在 Clojure 中的函数上使用“应用”时，如何显式指定命名空间？

> ID：10572443
> 
> 赞同：2
> 
> 时间：2012-05-13T14:14:05.673
> 
> 标签：clojure

这里的“graph”是高阶函数，它返回一个在其范围内设置了配置的函数：

```
(ns bulbs.neo4jserver.graph)

(defn out1
  "Test func that simply returns out1."
  [config]
  "out1")

(defn graph
  [config]
  (fn [func & args]
    (apply func config args))) 
```

您创建一个图形实例，然后可以使用它来调用其他函数并自动传入配置参数：

```
(def g (graph {:root-uri "http://localhost"}))

(g out1)
;; => "out1" 
```

这行得通；但是，如果您需要/将图形导入另一个命名空间，则必须在每个函数调用前加上图形命名空间：

```
(ns bulbs.neo4jserver.junk
  (:require [bulbs.neo4jserver.graph :as graph]))

(def g (graph/graph {:root-uri "http://localhost"}))

;; would rather do (g out1)
(g graph/out1) 
```

相反，我想在`apply`函数中明确指定命名空间，这样用户就不必：

```
(defn graph
  [config]
  (fn [func & args]
    ;; somehow specify the graph namespace here
    (apply func config args))) 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T02:01:25.640

不是您的问题的直接答案，但您使用的一般模式更常见：拥有一个保存连接参数（到数据库或另一台服务器）的有状态数据结构。大多数框架都扭转了这一点：不像你那样从保存连接参数的函数中调用你的函数，它们具有接受连接数据结构作为参数的函数。

例如，给定一个数据库连接`conn`，一个典型的虚构数据库库可能如下所示（注意：为清楚起见，示例已简化）：

```
(let [conn (make-db-connection :host .... :user ....)]
  (read-from-db conn :user)) 
```

在为消息传递框架（例如 RabbitMQ）使用库时，可能如下所示：

```
(let [conn (make-amqp-connection :host .... :port ...)]
  (send-message conn :my-queue "hello world")) 
```

在这两种情况下，都有一个`conn`数据结构用于对库函数的所有后续调用。在 OO 语言中，您将拥有一个全局的、有状态的对象来保存连接（在 Java 领域可能是一个单例）。在 Clojure 中，库通常使用`with-...`宏来处理此问题，该宏将特定连接绑定到内部使用的动态 var：

```
(with-db-connection (make-db-connection ....)
  (read-from-db :user ....))

(with-rabbit-connection (make-rabbitmq-connection ....)
  (send-message :my-queue "hello world")) 
```

这是实现此模式的（虚构）示例。假设一个连接是一个 Java 对象：

```
;; a var to hold the connection
(def ^:dynamic *current-connection* nil)

(defmacro with-connection [conn & body]
  `(binding [*current-connection* ~conn]
     ~@body))

;; send-msg is using the connection object bound to
;; the *current-connetion* var
(defn send-msg [msg]
  (.sendMessage *current-connection* msg))

;; usage:
(with-connection conn
  (send-msg "hello world!")) 
```

如果您想花哨，可以通过定义如下函数来支持这两种模式（接受连接作为参数*或*使用绑定连接）`send-msg`：

```
(defn send-msg [msg & {:keys [connection]
                       :or {connection *current-connection*}}]
  (.sendMessage connection msg))

;; usage with bound connetion:
(with-connection conn
  (send-msg "Hello World!"))

;; usage with explicit connection:
(send-msg "Hello World!"
          :connection conn) 
```

此版本`send-msg`使用提供的连接，如果未指定连接，则使用绑定连接*。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T14:41:15.050

您可以传递符号而不是函数并在`graph`函数中解析它：

```
(defn graph
  [config]
  (fn [func & args]
    (apply (ns-resolve 'bulbs.neo4jserver.graph func) config args))) 
```

并称之为：

```
(ns bulbs.neo4jserver.junk
  (:require [bulbs.neo4jserver.graph :as graph]))

(def g (graph/graph {:root-uri "http://localhost"}))

(g 'out1) 
```

但`g`不再是一个高阶函数。它需要符号，而不是功能。我个人不喜欢这种方法。你为什么不喜欢指定命名空间？也许你也可以用宏做你需要的事情，但我不太了解宏。

**编辑**

不要这样做。使用@Ankur 和@Gert 在评论中解释的常规函数​​。

# delphi - 请问如何使用 Delphi ADO 组件创建 D-Base IV 表？

> ID：10572444
> 
> 赞同：1
> 
> 时间：2012-05-13T14:14:15.937
> 
> 标签：delphi, ado, create-table, dbase

我正在开发用于将批处理结果记录到文件夹中单个 DBase 4 (*.dbf) 磁盘文件的仪器的软件。为了准备添加新的日志分析功能，计划使用这些 DBF 文件中的多个，我正在更改现有的简单 BDE TTable 和 CreateTable，它们分别重新打开并创建一个新的 DBF 文件，以使用 Delphi ADO 组件。

在这里使用其他建议，我已经成功创建了一个测试应用程序，该应用程序使用以下核心代码使用 TAdoDataSet 和 TAdoConnection 打开现有 DBF 文件：

```
ADODataSet1.DisableControls;
try
  S := ExtractFileDir( ParamStr(0) ); //set the dbf folder location here
  ADOConnection1.LoginPrompt:=false;
  ADOConnection1.ConnectionString:=Format('Provider=Microsoft.JET.OLEDB.4.0;Data Source=%s;Extended  Properties=dBase IV;',[S]);
  ADOConnection1.Connected:=True;
  ADODataSet1.CommandText:='Select * from test.dbf'; //The SQL query uses the name of the dbf file
  ADODataSet1.Open;
finally
  AdoDataSet1.EnableControls;
end; 
```

这很好用，但在第一次使用我的 DBF 之前，我还需要创建一个空的 DBF 文件来准备添加我的日志记录。我可以通过每次打开一个现有的“空”DBF 文件来做到这一点，但我希望有一个 SQL？如果我已经创建并定义了我的字段（这对我来说很容易），那么创建我的文件的方法。我用 TAdoTable 尝试了这个，我可以在其中创建所需的字段，但我找不到任何示例说明如何在没有任何内容的情况下将此表结构放到磁盘上，主要是因为 ADO 示例太多但几乎总是在现有的数据表。

任何人都可以帮我使用 ADO 组件创建一个包含几个字段的示例 DFB 表文件吗？我确信我可以在此基础上再接再厉。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T21:23:06.967

使用 TADOCommand 并执行 Create Table SQL，例如：

```
Create Table Test (TestField1 char(64), TestField2 integer) 
```

# ios-simulator - XCodes 4.3.2 中 iPad 模拟器的大小太大

> ID：10572451
> 
> 赞同：3
> 
> 时间：2012-05-13T14:16:11.707
> 
> 标签：ios-simulator, xcode4.3

现在我正在使用 13 英寸的 macbook pro。

昨天我将 XCodes 版本升级到 4.3.2。

因为 iPad Simulator 太大，iPad Retina Simulator 也太大。

这不是修复我的屏幕。

iPad Retina Simulator 大小占据了我的所有屏幕，它只能显示 iPad 的底座。

我看不到概览 iPad 屏幕。

我总是向下和向上滚动来测试。

当我将 Simulator 的 Window > Scale 更改为 75 % 时，它仍然太大。

50%太小了，什么都看不清楚。

当我使用 XCodes 4.2 开发时，iPad Simulator 是固定大小并且可以测试。

我想要 iPad 模拟器大小修复我的屏幕。

反正有吗？

如果我的问题是不可能的，很抱歉。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:21:35.763

也许是因为 iPad 3 的分辨率非常大（2048x1536）。这比大多数电脑屏幕还要多。正因为如此，您*将*需要缩小以显示整个屏幕，或者如果您不想缩放程序，则必须为您的计算机获得更大（更高分辨率）的屏幕。

原因是 iPad 3 的像素密度比大多数其他电脑屏幕要小得多，因此 iPad 上的每个像素都小于电脑屏幕上的每个像素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T08:54:13.047

您可以做的是通过抑制标题栏和停靠栏（如果碰巧显示）来启动模拟器。

请按照以下步骤操作，请在编辑任何内容之前负责并备份您的文件，因为我不对出现的问题负责。

在开始之前关闭所有正在运行的模拟器。

1.  在 Finder`CMD+SHIFT+G`中按下并输入文件夹`/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/Applications/iPhone Simulator.app/Contents/`；根据您的模拟器/SDK 的位置，此文件夹可能会有所不同。
2.  备份名为`Info.plist`
3.  复制`Info.plist`到您的主目录。
4.  双击`Info.plist`您的主目录。您将看到 plist 编辑器。
5.  选择第一个调用的条目`Information Property List`，然后单击右侧的加号 (+)。
6.  输入`Application UI Presentation Mode`新条目的 Key 字段，提示：键入后将自动填充`Application UI`。
7.  `4`在该字段中输入`Value`，然后将更改为`All Suppressed`。
8.  保存并关闭文件。
9.  用这个新的替换原来的 plist 文件，记得先备份原来的。

现在，当您运行模拟器时，它不会在激活时显示菜单栏。您需要将文件复制到主目录的原因是您没有对其的写入权限。它还可以防止您在编辑文件时弄乱它并阻止模拟器运行。

您可以通过找到它的 plist 文件将此技巧应用于任何应用程序，因此我也更改 Xcode.app 来执行此操作。

您需要将模拟器缩放到 75%，但现在它将几乎是屏幕的整个高度，而不会丢失 iPad 窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-04T11:43:20.393

现在使用 Xcode 9- Simulator 更加灵活。您可以选择和拖动任何角落或模拟器来调整它的大小并根据您的要求进行设置。

看看这张截图。

[![在此处输入图像描述](../Images/d423e909771ad6cb7840c37c67c3e033.png)](https://i.stack.imgur.com/kkQWB.gif)

[https://apple.stackexchange.com/questions/205865/ios-simulator-screen-size-not-equal-to-window-size](https://apple.stackexchange.com/questions/205865/ios-simulator-screen-size-not-equal-to-window-size)

# java - 如何保护 JSF 2.0 facelets 免受直接访问？

> ID：10572458
> 
> 赞同：7
> 
> 时间：2012-05-13T14:16:38.950
> 
> 标签：java, jsf, facelets

我在[这里](http://old.nabble.com/how-to-prevent-direct-access-to-jsf-pages--td16807991.html)找到了一个想法，将文件放在 /WEB-INF 下是一种阻止直接访问的方法：

> 使用 Facelets，如果 XHTML 文件是模板或包含文件（本质上与 JSP 相同的限制），也可以将它们放在 /WEB-INF 下。

该页面还提供了一个基于 Java EE 安全性的解决方案，它只允许特定用户组的成员直接访问 XHTML。

```
<security-constraint>
    <display-name>Restrict XHTML Documents</display-name>
    <web-resource-collection>
        <web-resource-name>XHTML</web-resource-name>
        <url-pattern>*.xhtml</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <description>Only let 'developer's access XHTML pages</description>
        <role-name>developer</role-name>
    </auth-constraint>
</security-constraint> 
```

您会推荐其中一种解决方案，还是两者都被普遍使用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-13T18:35:35.143

放入`/WEB-INF`文件夹仅适用于模板文件、包含文件和标记文件，这些文件不应**通过**URL 直接和独立访问，也不能通过有效映射访问。

安全约束仅适用于未映射`FacesServlet`on的公共文件`*.xhtml`。例如，如果您已将其映射，`*.jsf`那么您可以通过 URL 打开公共资源`foo.jsf`，但只需将扩展名更改为`foo.xhtml`. 该安全约束阻止了这一点。

但更好的是`FacesServlet`直接映射`*.xhtml`。这样你就不再需要那个安全约束了。但是，模板/包含/标签文件仍应放在`/WEB-INF`文件夹中。要获得总体思路，您可能会发现[OmniFaces 展示项目](https://github.com/omnifaces/showcase)的源代码很有帮助（请参阅`WEB-INF` [此处](https://github.com/omnifaces/showcase/tree/master/src/main/webapp/WEB-INF)）。

### 也可以看看：

*   [我需要将哪些 XHTML 文件放入 /WEB-INF 而哪些不需要？](https://stackoverflow.com/questions/9031811/which-xhtml-files-do-i-need-to-put-in-web-inf-and-which-not)
*   [WEB-INF 目录中的 JSF 文件，我如何访问它们？](https://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T16:32:10.860

.xhtml 可以放置在 Web 信息文件夹下并从中提供服务是非常合理的。

我不会依赖诸如将规则放入 web.xml 之类的装饰性编程，而是研究诸如 JSecurity 之类的安全解决方案来为我的应用程序提供 JAAS。

# c# - 如何在 C# 中访问泛型类型的元素

> ID：10572461
> 
> 赞同：2
> 
> 时间：2012-05-13T14:17:09.757
> 
> 标签：c#, entity-framework, entity-framework-4

我正在研究一种可重用的数据库存储库方法，用于使用 EntityFramework 4.3 将实体附加和保存到数据库。

```
 private void SaveObject<T>(T entityToSave, DbSet<T> dbSet) where T : class
    {
        if (db.Entry(entityToSave).State == EntityState.Detached)
        {
            if (entityToSave.Id == Guid.Empty) // how do I access the Id property?
                dbSet.Add(entityToSave);
            else
                db.Entry(entityToSave).State = EntityState.Modified;
        }
    } 
```

我遇到的问题是我需要告诉我的方法哪个属性是 Id，以便我可以检查它是否已设置。如果它是空的，那么我知道我正在创建一个全新的记录。否则，我正在修改现有记录。

如何告诉我的方法 Id 属性是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:19:50.080

您需要创建一个包含该`Id`属性的接口。

让你所有的实体类都实现这个接口并约束`T`去实现它。( `where T : IHasId`)
然后您将能够在您的方法中访问此接口的所有成员。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-13T14:20:01.390

您需要一个定义`Id`属性的接口或基类，并将其用作您的通用约束。例子：

```
public interface IEntity
{
    Guid Id { get; }
}

private void SaveObject<T>(T entityToSave, DbSet<T> dbSet) where T : class, IEntity
    {
        if (db.Entry(entityToSave).State == EntityState.Detached)
        {
            if (entityToSave.Id == Guid.Empty) // how do I access the Id property?
                dbSet.Add(entityToSave);
            else
                db.Entry(entityToSave).State = EntityState.Modified;
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T14:25:47.090

正如其他人所展示的，您可以通过使用界面来解决问题。另一种可能性是定义访问器委托

```
private void SaveObject<T>(T entityToSave, DbSet<T> dbSet, Func<T,Guid> accessId)
{
    ...
    Guid id = accessId(entityToSave);
    ...
} 
```

打电话给

```
SaveObject(entityToSave, dbSet, e => e.Id)
SaveObject(otherEntityToSave, dbSet, e => e.UserID) 
```

与接口相比的优势在于，id 可以具有不同的名称，并且与第二个通用参数一起，甚至可以具有不同的类型

```
private void SaveObject<T,I>(T entityToSave, DbSet<T> dbSet, Func<T,I> accessId)
{
    ...
    I id = accessId(entityToSave);
    ...
} 
```

# algorithm - 车间调度：我应该考虑哪些解决方案？

> ID：10572462
> 
> 赞同：1
> 
> 时间：2012-05-13T14:17:27.837
> 
> 标签：algorithm, job-scheduling, resource-scheduling

给定一家软件公司，其中开发人员在多个不同项目的团队中工作。项目需要指定开发人员的特定技能。出于我的目的，我想保持简单并将其限制为一种技能，即编程语言。所以有些项目需要Java，有些需要C等。项目有固定的持续时间，每个项目应该有两个开发人员分配给它。

在任何时间点，一些项目正在进行中，新项目进来，需要在未来的某个时间点进行计划。我想计算一个时间表，哪些开发人员应该在什么时间和什么项目上工作。

我不是在寻找最佳解决方案（如果可能的话）。我对人类经理可以创建的时间表感到满意。

我读过关于资源约束调度问题和分配问题的文章，但我很少接受正式的 CS 培训，而且我经常迷失在这些问题的不同变体中的所有细微差别中。

我认为我的问题是作业车间调度的一个更简单的变体，其中作业是项目，开发人员是机器，因此作业需要同时多台机器。只有一个先例约束，即运行中的项目不能中止，因此必须先完成。

从我读过的所有可能的解决方案中，我倾向于使用遗传算法，主要是因为我读过人们使用它们得到了很好的结果，并且因为我前一段时间将一个用于另一个项目。我也读过线性规划的好结果，但我对此知之甚少。

遗传算法是否是此类问题的可行解决方案？还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T20:44:24.483

创建一个二分图，一方面是开发人员，另一方面是需要的项目成员。“需要的项目成员”是指如果一个项目`P`需要 3 个开发人员，您将添加 3 个节点，可能命名`P0`为`P1`和`P2`。

如果开发人员具有该项目所需的所有技能，请在开发人员和所需的项目成员之间划清界限。然后，您的问题会简化为在该图中找到[匹配项；](http://en.wikipedia.org/wiki/Matching_%28graph_theory%29)您可以使用标准算法来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:57:49.670

使用遗传算法是一种可行的方法，但它非常雄心勃勃。

从[贪心算法](http://en.wikipedia.org/wiki/Greedy_algorithm)开始。

# iphone - NSSortDescriptor 不对值进行排序

> ID：10572465
> 
> 赞同：0
> 
> 时间：2012-05-13T14:18:07.120
> 
> 标签：iphone, objective-c, xcode, ipad, nssortdescriptor

我有一个自定义 plist：

```
 <key>Ford</key>
<dict>
    <key>name</key>
    <string>Ford</string>
    <key>color</key>
    <string>green</string>
    <key>price</key>
    <integer>45000</integer>
</dict

    <key>Toyota</key>
<dict>
    <key>name</key>
    <string>Toyota</string>
    <key>color</key>
    <string>blue</string>
    <key>price</key>
    <integer>40000</integer>
</dict

    <key>BMW</key>
<dict>
    <key>name</key>
    <string>BMW</string>
    <key>color</key>
    <string>blue</string>
    <key>price</key>
    <integer>40000</integer>
</dict> 
```

我也有一个`UITableView`，我用这个 plist 中的一些汽车填充它。

```
NSEnumerator *enumerator = [dictionary objectEnumerator];
id returnValue;
while ((returnValue = [enumerator nextObject])) 
{
    if ([[returnValue valueForKey:@"color"]isEqualToString:@"blue")
    {  
        [array addObject:[returnValue valueForKey:@"name"]];
    } 
```

现在，当我`UITableView`的车满了，我想按价格对汽车进行分类`NSSortDescriptor:`

```
 NSSortDescriptor *descriptor = [[NSSortDescriptor alloc] initWithKey:@"price" ascending:YES];
    [array sortedArrayUsingDescriptors:[NSArray arrayWithObjects:descriptor,nil]]; 
```

但是使用此代码，我的应用程序崩溃了：`reason: '[<__NSCFString 0x89a1710> valueForUndefinedKey:]: this class is not key value coding-compliant for the key price.'`

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:23:58.993

你说你正在用汽车填充你的阵列，但你不是。您正在用汽车名称填充它，这些名称是字符串。错误消息告诉您字符串没有“价格”属性。

# machine-learning - 机器学习当数据集只包含一类实例时使用什么方法？

> ID：10572466
> 
> 赞同：0
> 
> 时间：2012-05-13T14:18:09.583
> 
> 标签：machine-learning, cluster-analysis, classification, document-classification, cosine-similarity

我有一个特定领域的数据集（比如运动 - 1 类）。我想要做的是，当我将网页提供给分类器/集群时，我想得到一个结果，无论该实例（网页）是否与运动相关。

weka 中的大多数分类器都不能处理一元类数据集，除了 LibSVM（包装器）。我用 LibSVM 做了一些测试，但问题是在对不相关的数据集进行测试期间，即使实例是空的，我也能正确分类它们！有什么建议么？
如果我在这里使用余弦相似度测量怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T15:05:02.057

你[在weka中见过这个线程一元类文本分类吗？](https://stackoverflow.com/questions/10394615/unary-class-text-classification-in-weka)这篇文章[https://list.scms.waikato.ac.nz/mailman/htdig/wekalist/2007-October/011631.html](https://list.scms.waikato.ac.nz/mailman/htdig/wekalist/2007-October/011631.html)？

我假设您的意思是，当您针对另一个不是“体育”的数据集运行分类器时，它会得到错误分类的结果（即误报），例如“这是体育”。

你确定你的数据集只包含一个类吗？您是否确保数据集不包含任何空实例？（不要嘲笑，这曾经发生在我身上）。

在前面提到的线程的评论中，有一个关于调整 SVM 的 PDF 链接：[http](http://www.csie.ntu.edu.tw/~cjlin/papers/guide/guide.pdf) ://www.csie.ntu.edu.tw/~cjlin/papers/guide/guide.pdf - 我会说 SVM 是一个比其他常见的分类器更难。

作为替代方案，您不能将问题切换到二进制分类吗？获得好的结果要容易得多，对于大多数问题，有很多不属于该类别的示例，例如体育网站与有趣的图像网站，编程网站等...

PS：您可以使用其他算法进行异常值检测：[http ://en.wikipedia.org/wiki/Outlier_detection](http://en.wikipedia.org/wiki/Outlier_detection)

# powerpivot - PowerPivot 钻取格式化

> ID：10572468
> 
> 赞同：1
> 
> 时间：2012-05-13T14:18:22.793
> 
> 标签：powerpivot

有谁知道在 PowerPivot 钻取中进行格式化的方法？每当我在 PowerPivot 工作簿上进行钻取时，生成的报告都没有在 PowerPivot 中设置格式，它只有表格中的原始格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T19:27:30.200

要更改默认表格颜色，请执行以下操作：

1.  双击向下钻取并查看页面。
2.  您的标签现在显示表格工具..
3.  在表格样式组中单击右下方的下拉按钮以查看所有样式
4.  在底部看到“新表格样式...”
5.  找到此对话框底部的复选框（新建表格快速样式）“设置为此文档的默认表格快速样式”

如果你想做其他事情，你必须使用宏，这就是我过去完成列隐藏的方式：

```
Dim pt As PivotTable 
Dim pf As PivotField 
Dim pi As PivotItem 

Set pt = Me.PivotTables("PivotTable1") ' replace with your PT name (see in pivot table options)

For Each pf In pt.PivotFields 
    If pf.Name = "Field1" Then ' change this to your field name
        For Each pi In pf.PivotItems 
            pi.ShowDetail = True ' True to show, False to Hide
    Next pi 
End If 
Next pf 
```

通过宏完成此操作的另一种方法是将类似这样的内容放入工作簿模块中：

```
Private Sub Workbook_NewSheet(ByVal Sh As Object)
ans = MsgBox("Format this sheet?", vbYesNo)
If ans = vbYes Then blahh Sh
End Sub 
```

然后把它放在标准代码模块中：

```
Sub blahh(sht As Worksheet)
MsgBox "formatting new sheet: " & sht.Name
End Sub 
```

Excel 2007 经过测试并与数据透视表一起使用，已经为向下钻取表添加了一些样式。

# sql - 多列中的唯一索引键

> ID：10572472
> 
> 赞同：0
> 
> 时间：2012-05-13T14:18:50.710
> 
> 标签：sql, sql-server, unique-constraint, unique-index, multiple-columns

我需要使用 SQL Server 在我的表中定义唯一索引键。

例如：

```
ID    Contact1     Contact2    RelationType
-------------------------------------------------------------------
1     1            2           sister       // 1 is the 2nd sister
2     3            4           brother      // 3 is the 4th brother
3     5            1           father       // 5 is the 1st father
4     2            1           sister       // bad entry !!! 
```

现在，我如何禁止使用唯一索引键在上表中插入错误数据，如上表中的第 4 个 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:50:40.710

您可以将唯一键与检查约束结合使用，使您在 Contact1 中具有较低的值。

```
create table Relation
(
  ID int identity primary key,
  Contact1 int not null,
  Contact2 int not null,
  unique (Contact1, Contact2),
  check (Contact1 < Contact2)
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:34:55.437

您可以创建一个计算列，其中包含两个数字（第一个较小的）组合的字符表示，然后在计算列上创建一个唯一约束。

```
case when Contact1 > Contact2 then convert(varchar, Contact2) + convert(varchar, Contact1)
else convert(varchar, Contact1) + convert(varchar, Contact2) 
```

如果 5, 3 已经存在，此解决方案将允许输入 5, 3 但不能输入 3, 5。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T16:50:41.590

你在建模什么逻辑/规则？如果不知道这个问题的答案，就很难确切地知道问题是什么。

话虽如此，看起来您的表已非规范化，并且可能会使应用约束变得复杂。如果您试图简单地强制执行“联系人对于 id 是唯一的”，则取出 Contact 2 列并在 Contact 1 上设置唯一约束

# php - Joomla：从 PHP 5.2 迁移到 5.3 时的问题

> ID：10572473
> 
> 赞同：0
> 
> 时间：2012-05-13T14:19:38.977
> 
> 标签：php, joomla

我的主机将在几周后停止支持 PHP 5.2，这就是我必须切换到 PHP 5.3 的原因。我正在使用 Joomla 2.5 来管理网站的内容。在托管程序的后端，我通过单击按钮切换到新的 PHP 版本，但这导致网站崩溃并出现以下错误。

显然，我的代码还没有为 PHP 5.3 做好准备。如何将 joomla 代码更新为新的 PHP？或者 joomla 是否应该毫无问题地处理新的 PHP 版本，而我添加的内容实际上会导致错误？来自我的唯一代码是加载自定义设计的模板。

我有点卡在这里，并没有真正看到 joomla、PHP 之间的联系，以及我使用旧 PHP 的新主机后端如何。任何建议将不胜感激......

* * *

错误。注意：这是从另一个站点复制的，我加载了备份以修复站点上的错误，但除了路径之外它完全相同：

```
jos-Error: Application Instantiation Error

JFactory :: getApplication() @ /home/parolevo/public_html/tiptopart/index.php:28
JApplication :: getInstance() @ /home/parolevo/public_html/tiptopart/libraries/joomla/factory.php:102
JSite -> __construct() @ /home/parolevo/public_html/tiptopart/libraries/joomla/application/application.php:208
JApplication -> __construct() @ /home/parolevo/public_html/tiptopart/includes/application.php:48
JApplication -> _createSession() @ /home/parolevo/public_html/tiptopart/libraries/joomla/application/application.php:173
JFactory :: getSession() @ /home/parolevo/public_html/tiptopart/libraries/joomla/application/application.php:1046
JFactory :: createSession() @ /home/parolevo/public_html/tiptopart/libraries/joomla/factory.php:152
JSession :: getInstance() @ /home/parolevo/public_html/tiptopart/libraries/joomla/factory.php:661
JSession -> __construct() @ /home/parolevo/public_html/tiptopart/libraries/joomla/session/session.php:155
JSession -> _start() @ /home/parolevo/public_html/tiptopart/libraries/joomla/session/session.php:118
session_start() @ /home/parolevo/public_html/tiptopart/libraries/joomla/session/session.php:492
JSessionStorageDatabase -> read()
JFactory :: getDbo() @ /home/parolevo/public_html/tiptopart/libraries/joomla/session/storage/database.php:67
JFactory :: createDbo() @ /home/parolevo/public_html/tiptopart/libraries/joomla/factory.php:308
JError :: raiseError() @ /home/parolevo/public_html/tiptopart/libraries/joomla/factory.php:723
JError :: raise() @ /home/parolevo/public_html/tiptopart/libraries/joomla/error/error.php:251
JError :: throwError() @ /home/parolevo/public_html/tiptopart/libraries/joomla/error/error.php:176
call_user_func_array() @ /home/parolevo/public_html/tiptopart/libraries/joomla/error/error.php:214
JError :: handleMessage()
JFactory :: getApplication() @ /home/parolevo/public_html/tiptopart/libraries/joomla/error/error.php:705
JError :: raiseError() @ /home/parolevo/public_html/tiptopart/libraries/joomla/factory.php:99
JError :: raise() @ /home/parolevo/public_html/tiptopart/libraries/joomla/error/error.php:251 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T21:42:13.050

正如您从[Joomla 的技术要求页面中看到的那样！](http://www.joomla.org/technical-requirements.html)2.5 版推荐 PHP 5.3。

我还可以确认我们所有的（+ 客户端）2.5 站点都在 PHP 5.3 上运行没有问题，所以唯一的结论是它是您添加到基本安装或在*核心*Joomla 中更改的内容！代码。

查看错误日志不是很有帮助，但我可以告诉您，它似乎在连接到数据库时出现问题。我会检查您的`configuration.php`文件是否存在可能的问题 - 确认数据库和连接类型设置正确。

# apache - 配置 Apache 重写规则以将 404 请求重定向到 html 文件

> ID：10572478
> 
> 赞同：0
> 
> 时间：2012-05-13T14:19:50.303
> 
> 标签：apache

我确实需要将所有 404 错误页面重写为 html 文件。我试过了

```
ErrorDocument htdocs/error.html 
```

但是如果没有页面，页面不会被重定向到它。我正在使用 Apache 使用 Mod-JK 从 JBOSS 获取数据。

请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:24:41.800

在 htdocs 文件夹中创建一个 .htaccess。

```
ErrorDocument 404 /error.html 
```

# bash - “回声$？” 仅适用于 linux/aix，不适用于 solaris/hp-ux [奇怪！或者我错过了什么]？

> ID：10572480
> 
> 赞同：2
> 
> 时间：2012-05-13T14:19:58.433
> 
> 标签：bash, shell, command

如果我在所有平台上触发“zcat1”[它在任何地方都不存在]，并立即回显“$？”，我在 Linux 和 AIX 中得到失败值 [1]，而在 HP-UX 和 Solaris 中没有？请让我知道，缺少什么，我到处都在使用 sh shell？我需要做任何设置吗？

```
uname -a
Linux xxxxx 2.6.18-164.el5 #1 SMP Tue Aug 18 15:51:48 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux
[root@xxxxx tmp_a]# which zcat1
/usr/bin/which: no zcat1 in (/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/bin/admincmd/:/root/bin)
[root@cllin11 tmp_a]# echo $?
1

uname -a
AIX xxxxxx 1 7 00CE6F1F4C00
[root@xxxxx /]# which zcat1
which: 0652-141 There is no zcat1 in /usr/bin /etc /usr/sbin /usr/ucb /usr/bin/X11 /sbin /usr/java5/jre/bin /usr/java5/bin /root/bin /opt/VRTSvcs/bin /opt/VRTSvxfs/cfs/bin /etc/vx/bin /opt/pware/bin /opt/VRTSvcs/bin /etc/vx/bin /opt/VRTSvxfs/cfs/bin /opt/VRTS/bin /opt/pware/bin /opt/VRTSat/bin /opt/VRTSat/bin.
[root@claix01 /]# echo $?
1

# uname -a
HP-UX xxx B.11.23 U 9000/800 3547050632 unlimited-user license
# which zcat1
no zcat1 in /usr/sbin /usr/bin /usr/ccs/bin /usr/contrib/bin /usr/contrib/Q4/bin /opt/perl/bin /opt/ipf/bin /opt/hparray/bin /opt/nettladm/bin /opt/fcms/bin /opt/ssh/bin /opt/mx/bin /opt/wbem/bin /opt/wbem/sbin /opt/resmon/bin /usr/bin/X11 /opt/sec_mgmt/bastille/bin /opt/drd/bin /opt/dsau/bin /opt/dsau/sbin /opt/firefox /opt/gnome/bin /opt/perf/bin /opt/ignite/bin /usr/contrib/kwdb/bin /opt/mozilla /var/opt/netscape/servers/shared/bin /var/opt/netscape/servers/bin /var/opt/netscape/servers/bin/slapd/server /var/opt/netscape/server7/shared/bin /var/opt/netscape/server7/bin /opt/graphics/common/bin /opt/perl_32/bin /opt/perl_64/bin /opt/prm/bin /usr/sbin/diag/contrib /opt/sfm/bin /opt/sec_mgmt/spc/bin /opt/java1.4/jre/bin /opt/spb/bin /opt/swa/bin /opt/hpsmh/bin /opt/thunderbird /opt/upgrade/bin /opt/gwlm/bin /usr/contrib/bin/X11 /sbin /home/root
# echo $?
0

uname -a
SunOS xxxxxx 5.10 Generic_141445-09 i86pc i386 i86pc
# which zcat1
no zcat1 in /usr/sbin /usr/bin /opt/VRTS/bin /var/VRTS/bin/
# echo $?
0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:46:34.940

您正盯着 POSIX 实施地狱的深渊.....这里有一个来自“红木城的 Oracle”的花絮，可以帮助您：

[未经许可，任何人不得通过 POSIX 河](https://blogs.oracle.com/moazam/entry/solaris_which_command_does_not)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:48:58.043

好吧，[hp-ux 联机帮助页`which`](http://nixdoc.net/man-pages/HP-UX/man1/which.1.html)没有说明退出状态，因此您不应该真的期待退出状态。

作为替代方案，您可以使用POSIX`type`的[一部分，](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/type.html)并且应该要求在失败时返回错误代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:29:28.080

其他答案已经涵盖了为什么您不能依赖`which`. 在 bash 中，您应该使用 builtin `type`，它不会因操作系统而改变。

```
$ type -P ls
/bin/ls
$ echo $?
0
$ type -P askdjas
$ echo $?
1 
```

# html - Autoit3中的多行正则表达式

> ID：10572481
> 
> 赞同：0
> 
> 时间：2012-05-13T14:19:59.767
> 
> 标签：html, regex, autoit, pcre

我正在尝试将多行 HTML 源代码与正则表达式匹配（使用 AutoIt）。要匹配的 HTML 源代码：

```
<li class="mission">
    <div>
        <div class="missionTitle">
            <h3>Eat a quarter-pounder with cheese</h3>
            <div class="missionProgress">
                <span>100%</span>
                <div class="missionProgressBar" style="width: 100%;"></div>
            </div>
        </div>
        <div class="missionDetails">
            <ul class="missionRewards">
                <li class="rewardCash">5,000&ndash;8,000</li>
                <li class="rewardXP">XP +5</li>
                                </ul>
                            <div class="fightItems clearfix">
                <h5><span>Prerequisites:</span></h5>
                                    <div class="fightItemsWrap">
                                            <div class="fightItem tooltip" title="Sunglasses" data-attack="Attack: 2" data-defence="Defence: 2">
                        <img src="/img/enhancement/3.jpg" alt="">
                        <span>&times; 1</span>
                    </div>
                                            <div class="fightItem tooltip" title="Broad Shoulders" data-attack="Attack: 0" data-defence="Defence: 3">
                        <img src="/img/enhancement/1003.jpg" alt="">
                        <span>&times; 1</span>
                    </div>
                                            <div class="fightItem tooltip" title="Irish Fond Anglia" data-attack="Attack: 4" data-defence="Defence: 8">
                        <img src="/img/enhancement/2004.jpg" alt="">
                        <span>&times; 1</span>
                    </div>
                                        </div>
            </div>
                            <form action="/quest/index/i/kdKJBrgjdGWKqtfDrHEkRM2duXVn1ntH/h/c0b2d58642cd862bfad47abf7110042e/t/1336917311" method="post">
                <input type="hidden" id="id" name="id" value="17"/>
                <button class="button buttonIcon btnEnergy"><em>5</em></button>
            </form>
        </div>
    </div>
</li> 
```

它在一个页面上出现多次（但其中的项目`<div class="fightItems clearfix">...</div>`有所不同）。

*   我需要匹配
    *   `<h3>Eat a quarter-pounder with cheese</h3>`,
    *   第一个跨度`<span>100%</span>`和
    *   `<input type="hidden" id="id" name="id" value="17"/>`.

预期结果（对于页面上的每次出现）：

```
$a[0] = "Eat a quarter-pounder with cheese"
$a[1] = "100%"
$a[2] = "17" 
```

我想出了什么：

```
(?U)(?:<div class="missionTitle">\s+<h3>(.*)</h3>\s+<div class="missionProgress">\s+<span>(.*)</span>)|(?:<form .*\s+.*<input\stype="hidden"\sid="id"\sname="id"\svalue="(\d+)"/>\s+.*\s+</form>) 
```

但这会使一些数组项为空。我也尝试了该`(?s)`标志，但它只捕获第一次出现（并在之后停止匹配）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T13:28:12.663

`.`由于`(?s)`标志，我不必使用匹配单词或整数。正确的正则表达式是：

```
(?U)(?s)<div class="missionTitle">\s+<h3>([\w\s]+)</h3>(?:.*)<div class="missionProgress">\s+<span>(\d+)%</span>(?:.*)<input.* value="(\d+)"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-04T23:11:41.973

正则表达式匹配多行 HTML 源代码：

*   根据[文档](https://www.autoitscript.com/autoit3/docs/functions/StringRegExp.htm)；

    *   `\R`匹配换行符`(?>\r\n|\n|\r)`，
    *   dot`.`不会（除非`(?s)`已设置）。
    *   `\s`匹配空白字符。
*   通常需要一些组合（如`\R\s*?`）。

*   非捕获组是多余的（匹配而不捕获）。
*   如果被唯一地括起来，则可能会排除单个字符（例如`attribute="([^"]*?)"`双引号之间的文本）。

示例（包含双引号；按[文档处理 - 常见问题解答 - 双引号](https://www.autoitscript.com/autoit3/docs/faq.htm#3)）：

```
(?s)<div class="missionTitle">.*?<h3>(.*?)</h3>.*?<div class="missionProgress">.*?<span>([^<]*?)</span>.*?<input type="hidden" id="id" name="id" value="([^"]*?)"/> 
```

视觉解释：

[![正则表达式图片](../Images/c8fd09ae07eafde8a51f58db054b253e.png)](https://www.debuggex.com/r/lOhtvdwP5uBXgBN7) [![正则表达式图片](../Images/14955f2603ed832df94ca4a983b00ed9.png)](https://i.stack.imgur.com/359EC.gif)

如果应该在 HTML 上使用正则表达式（除了像这样的简单列表）是一个[不同的问题](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)（been、done、[T-shirt](https://meta.stackexchange.com/questions/18382/help-design-our-stack-overflow-t-shirts/35432#35432)）。

# jquery - 更改表单的“操作”

> ID：10572486
> 
> 赞同：2
> 
> 时间：2012-05-13T14:20:45.993
> 
> 标签：jquery, forms, submit

我可以像这样使用 Jquery 提交：

```
$('.SomeLink').bind('click', function()
{
      $(form).submit();
}); 
```

实际形式如下所示：

```
<form id="foo" method="get" action="http://www.google.com/search">
</form> 
```

现在假设我有另一个链接，我希望能够在其中使用相同的表单，但是现在我想更改“操作”的 url。如果单击不同的链接，我如何更改操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:23:12.357

```
$("#foo").attr("action","http://your_new_val"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-13T14:23:23.917

动作只是表单的一个属性。

```
$("different button").click(function(){
     $("form").attr("action","new action");
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-13T14:25:18.540

您可以尝试将操作编辑为一个简单的参数：

```
$(form).attr('action', 'newUrlInString'); 
```

然后调用 submit();

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-13T14:28:58.593

尝试：

```
$('.DifferentLink').bind('click', function() {
      $("#foo").attr("action","new/action");
      $("#foo").submit();
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-13T14:35:31.390

我假设您有一个带有文本框的表单和几个可以将表单提交到所选位置的链接。这就是你可以使它通用的方法：

```
<form id="theform">
    <input type="text" name="q" />
</form>
<div id="choices">
    <a href="#" data-url="http://www.google.com/search/">Google</a> 
    <a href="#" data-url="http://www.yahoo.com/">Yahoo</a>
</div> 
```

然后是 JavaScript：

```
$(function() {
  $('a', $('#choices')).on('click', function() {
    $('#theform')
        .attr('action', $(this).data('url'))
        .submit();
    return false;
  });
}); 
```

# android - 以编程方式注册 ACTION_BOOT_COMPLETED

> ID：10572487
> 
> 赞同：1
> 
> 时间：2012-05-13T14:20:47.583
> 
> 标签：android, broadcastreceiver

好的，所以我已经搜索和搜索，但似乎无法找到声明这不应该的参考。基本上我想在我的应用程序中完成的是允许用户注册或取消注册 ACTION_BOOT_COMPLETED 的广播接收器。

我尝试使用下面的代码注册它，但没有骰子。如果我将它添加到清单中，那么我可以接收事件，但无法将其关闭（据我所知）。有没有办法注册和注销 ACTION_BOOT_COMPLETED 的接收器？

```
 IntentFilter bootFilter = new IntentFilter(Intent.ACTION_BOOT_COMPLETED);
    mBootCompleted = new BootBroadcastReceiver();
    registerReceiver(mBootCompleted, bootFilter); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:40:22.440

> 基本上我想在我的应用程序中完成的是允许用户注册或取消注册 ACTION_BOOT_COMPLETED 的广播接收器。

第 1 步：`<receiver>`在清单中添加一个`<intent-filter>`用于`BOOT_COMPLETED`广播的

步骤#2：根据应用程序的需要启用或禁用组件，使用`PackageManager`和`setComponentEnabledSetting()`，基于下次启动是否需要它

第 3 步：没有第 3 步

> 我尝试使用下面的代码注册它，但没有骰子。

当然。在这个存在平面中，时间以线性方式前进，总是向前发展（以 TARDIS 或适当装备的 DeLorean 为模）。当您执行您显示的代码时，启动已经完成，并且在您的代码不再运行之前不会再有启动广播（因为设备已重新启动）。

> 如果我将它添加到清单中，那么我可以接收事件，但无法将其关闭（据我所知）。

请参阅我答案顶部的食谱。

# css - z-index 不能与溢出结合使用

> ID：10572489
> 
> 赞同：0
> 
> 时间：2012-05-13T14:21:45.873
> 
> 标签：css, overflow, z-index, popupwindow

这张图片说明了我的问题： ![在此处输入图像描述](../Images/a57c726cdcdbc0756c313180cb36947b.png)

我认为这是来自 Sohtanaka 的弹出脚本，所以你看到的是一个弹出窗口。CSS看起来像这样：

```
#fade { /*--Transparent background layer--*/
    display:none; /*--hidden by default--*/
    background:#000000;
    position:fixed;
    left:0;
    top:0;
    width:100%;
    height:100%;
    opacity:.80;
    z-index:9999;
}

.popup_block{
    display:none; /*--hidden by default--*/
    background:#ffffff;
    padding:20px;
    border:20px solid #dddddd;
    float:left;
    position:absolute;
    top:50%;
    left:50%;
    z-index:99999;
    /*--CSS3 Box Shadows--*/
    -webkit-box-shadow:0px 0px 20px #000000;
    -moz-box-shadow:0px 0px 20px #000000;
    box-shadow:0px 0px 20px #000000;
    /*--CSS3 Rounded Corners--*/
    -webkit-border-radius:10px;
    -moz-border-radius:10px;
    border-radius:10px;
    font-size:12px;
    height:625px;
}

img.btn_close {
    float:right;
    margin:-55px -55px 0 0;
}
/*--Making IE6 Understand Fixed Positioning--*/
*html #fade {
    position:absolute;
}

*html .popup_block {
    position:absolute;
} 
```

和javascript：

```
$(document).ready(function(){

    //When you click on a link with class of poplight and the href starts with a # 
    $('a.poplight[href^=#]').click(function() {
        var popID = $(this).attr('rel'); //Get Popup Name
        var popURL = $(this).attr('href'); //Get Popup href to define size

        //Pull Query & Variables from href URL
        var query= popURL.split('?');
        var dim= query[1].split('&');
        var popWidth = dim[0].split('=')[1]; //Gets the first query string value

        //Fade in the Popup and add close button
        $('#' + popID).fadeIn().css({ 'width': Number( popWidth ) }).prepend('<a href="#" class="close"><img src="../images/close_pop.png" class="btn_close" title="Close Window" alt="Close" /></a>');

        //Define margin for center alignment (vertical + horizontal) - we add 80 to the height/width to accomodate for the padding + border width defined in the css
        var popMargTop = ($('#' + popID).height() + 80) / 2;
        var popMargLeft = ($('#' + popID).width() + 80) / 2;

        //Apply Margin to Popup
        $('#' + popID).css({ 
            'margin-top' : -popMargTop,
            'margin-left' : -popMargLeft
        });

        //Fade in Background
        $('body').append('<div id="fade"></div>'); //Add the fade layer to bottom of the body tag.
        $('#fade').css({'filter' : 'alpha(opacity=80)'}).fadeIn(); //Fade in the fade layer 

        return false;
    });

    //Close Popups and Fade Layer
    $('a.close, #fade').live('click', function() { //When clicking on the close or fade layer...
        $('#fade , .popup_block').fadeOut(function() {
            $('#fade, a.close').remove();  
    }); //fade them both out

        return false;
    });         

}); 
```

第一张图片是当我使用下面链接的 CSS 时。一切都在工作，右上角的紧密交叉在那里并且正在工作。问题是，我在弹出窗口上做了一个固定的高度，根据链接到弹出窗口的 ID，里面的东西可能更多，也可能更少。因此，固定高度并不总是足够的，您可以在第一张图片的底部看到，其中内容实际上超出了窗口框架。

好吧，然后我尝试使用溢出：自动（我知道我应该溢出-y 用于两侧的滚动条，但另一张图片只是溢出，所以请耐心等待；）），我得到了另一张图片。然后我在窗口内得到一个滚动条，我可以轻松滚动以查看其他内容，因为它应该是（再次，忽略 x 滚动条）。但是，不幸的是，不是关闭十字按钮不想像以前那样显示，而是隐藏在边框后面。

我尝试了一些方法，将 javascript 中的按钮包含在一个 div 中，然后定位它，但这似乎不像我那样工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:01:54.413

编写 javascript 以获取 id，您的 popup_block 是一个类。如果您将一些 HTML 代码发布到，我会非常有帮助。=)

`float:left`注意：当位置是绝对的时，我认为不起作用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T03:52:42.720

我为你找到了解决方案。在里面添加一个新的部门`popup_block`并给它溢出。然后你可以正确地看到接近的图像。我创建了两个 jsfiddle 示例。一个内容较少，另一个内容较多。

[包含更多内容的示例](http://jsfiddle.net/libinvbabu/Q2Nhv/3/)

[内容较少的示例](http://jsfiddle.net/libinvbabu/Q2Nhv/4/)

我也调整了一些 CSS。关闭外部添加的图像。

希望这能解决您的问题。

干杯！！！

# emacs - 在 org 模式 emacs 中意外运行了 org-columns 的快捷键组合，现在想要摆脱缓冲区顶部的列视图

> ID：10572493
> 
> 赞同：4
> 
> 时间：2012-05-13T14:22:23.607
> 
> 标签：emacs, org-mode

如前所述，意外运行了 org-column 命令，我设法以某种方式将其从待办事项中删除。不知道如何，但它摆脱了它，但它仍然在缓冲区的顶部，它显示列标签。如果这种情况再次发生，我如何删除它并在将来从待办事项中删除 org-column 视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T18:19:57.783

发现您必须运行以下命令：

```
org-columns-quit 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T10:01:26.220

此外，点击`q`列上的任何位置都相当于`M-x org-columns-quit RET`.

# c# - C# 更改智能感知信息

> ID：10572494
> 
> 赞同：0
> 
> 时间：2012-05-13T14:22:26.897
> 
> 标签：c#, intellisense

我有某个类的成员，其定义如下：

```
public static object CallMethod(Type oType, String sMethodName, params object [] paramenters)
{
    /* some code exist here, not required in this scenario */

    CarrierContainer cc = new CarrierContainer();
    CarrierContainer.SetMethod.SetServiceAndFunction(cc, oType.Name.Substring(1), sMethodName);

    foreach (object item in paramenters) {  cc.Params.Add(item); }

    object obj = WCFClient.ExecuteService(cc);
    return obj;
} 
```

我的呼叫部分是这样的：

```
return (ID)WCFServiceClient.CallMethod(ServiceType, "Save", this); 
```

现在我的意思是当我完成输入时：

```
return (ID)WCFServiceClient.CallMethod(ServiceType, "Save", 
```

我不知道“保存”需要多少个参数，并且我想在基于两个参数类型为*ServiceType、“保存”*的输入时显示 IntelliSense 信息。

在 C# 编辑器中键入一些代码时，请有人对控制 IntelliSense 信息有任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:26:55.990

该方法的明确定义声称：

> 我不知道*该*数组中有多少个参数

因此，您对 IntelliSense 的期望并不是代码中定义的。如果您希望 IntelliSense 帮助您，您应该在函数定义中明确定义参数。

其他“解决方案”可以以适当的方式使用评论。

# android - setid 和 getid？错误 putIntArray？

> ID：10572497
> 
> 赞同：0
> 
> 时间：2012-05-13T14:22:42.233
> 
> 标签：android

```
for(int i=0; i<value1; i++) {
            addAnsMCQ = new EditText(this);
            AnswerRG.addView(addAnsMCQ, 1);
            addAnsMCQ.setId(i); 
```

大家好，我开始编写 android 代码并看到了 setId 方法，但是如何获取 id？我使用 findViewById 但不能。请帮帮我谢谢？

我的第二个问题是？按钮创建；

```
TextView gotAnswer, NoAnsV;
    EditText NoQues, NoAnswer;
    Integer data[] = new Integer[]{};
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.manualask);     
        NoQues = (EditText) findViewById (R.id.NoQues);
        NoAnswer = (EditText) findViewById (R.id.NoAnsw);
        create = (Button) findViewById (R.id.create);
        create.setOnClickListener(this);
    }
    public void onClick(View v) {
        // TODO Auto-generated method stub      
        switch (v.getId()){     
        case R.id.create:
            Intent intent = new Intent(Manual.this, MCQSample.class);
            Bundle b = new Bundle();

            data[0] = Integer.parseInt(NoQues.getText().toString());    

            data[1] = Integer.parseInt(NoAnswer.getText().toString());  
            b.putIntArray("key", data);
            intent.putExtras(b);    
            startActivity(intent);
            finish();
            break; 
```

如何放置 putIntArray。我不断收到错误，甚至更改参数 data[] 等。请帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:25:11.230

> 即使更改参数 data[] 等，我也会不断收到错误。

的声明`data`应该是：

```
int data[] = new int[2]; 
```

在您的声明 ( `Integer data[] = new Integer[]{};`) 中，您声明了一个大小为 0 的数组，然后您尝试访问不存在的单元格 0 和 1。

# python - ImportError：没有名为 sqlalchemy 的模块

> ID：10572498
> 
> 赞同：70
> 
> 时间：2012-05-13T14:22:42.653
> 
> 标签：python, sqlalchemy, flask-sqlalchemy

我无法在 python 中找到一个模块，尽管 easy_install 说它已经安装了。知道如何解决这个问题吗？

```
$ python -c "from flaskext.sqlalchemy import SQLAlchemy"
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named sqlalchemy

$ python -V
Python 2.7

$ sudo easy_install sqlalchemy
Searching for sqlalchemy
Best match: SQLAlchemy 0.7.7
Adding SQLAlchemy 0.7.7 to easy-install.pth file

Using /usr/lib/python2.7/site-packages
Processing dependencies for sqlalchemy
Finished processing dependencies for sqlalchemy 
```

> $ sudo pip install SQLAlchemy --upgrade 要求已经是最新的：/usr/lib/python2.7/site-packages 中的 SQLAlchemy 清理...

虽然 pip 说它已安装。但我在 sys.path 输出中找不到它们。

```
$ sudo python -c "import sys;print sys.path" ['',
'/usr/lib/python2.7/site-packages/Flask_SQLAlchemy-0.15-py2.7.egg',
'/usr/lib/python2.7/site-packages/Flask-0.8-py2.7.egg',
'/usr/lib/python2.7/site-packages/Jinja2-2.6-py2.7.egg',
'/usr/lib/python2.7/site-packages/Werkzeug-0.8.3-py2.7.egg',
'/usr/lib/python2.7/site-packages/Flask_WTF-0.5.2-py2.7.egg',
'/usr/lib/python2.7/site-packages/WTForms-0.6.3-py2.7.egg',
'/usr/lib/python2.7/site-packages/Flask_Mail-0.6.1-py2.7.egg',
'/usr/lib/python2.7/site-packages/blinker-1.2-py2.7.egg',
'/usr/lib/python2.7/site-packages/lamson-1.1-py2.7.egg',
'/usr/lib/python2.7/site-packages/python_daemon-1.6-py2.7.egg',
'/usr/lib/python2.7/site-packages/nose-1.1.2-py2.7.egg',
'/usr/lib/python2.7/site-packages/mock-0.8.0-py2.7.egg',
'/usr/lib/python2.7/site-packages/chardet-1.0.1-py2.7.egg',
'/usr/lib/python2.7/site-packages/lockfile-0.9.1-py2.7.egg',
'/usr/lib/python2.7/site-packages/Flask_FlatPages-0.2-py2.7.egg',
'/usr/lib/python2.7/site-packages/Markdown-2.1.1-py2.7.egg',
'/usr/lib/python2.7/site-packages/PyYAML-3.10-py2.7-linux-i686.egg',
'/usr/lib/python2.7/site-packages/uWSGI-1.0.3-py2.7.egg',
'/usr/lib/python2.7/site-packages/MySQL_python-1.2.3-py2.7-linux-i686.egg',
'/usr/lib/python27.zip', '/usr/lib/python2.7',
'/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk',
'/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload',
'/usr/lib/python2.7/site-packages',
'/usr/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg-info'] 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-05-13T14:32:54.803

你安装了[`flask-sqlalchemy`](https://flask-sqlalchemy.palletsprojects.com/)吗？看起来您已经安装了 SQLAlchemy，但没有安装 Flask 扩展。尝试`pip install Flask-SQLAlchemy`在项目的 virtualenv 中从[PyPI](https://pypi.org/project/Flask-SQLAlchemy/)安装它。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-05-27T15:33:42.750

我刚刚遇到了同样的问题。显然，有一种新的分发方式，扩展代码不再存储在`flaskext`.

**资料来源：** Flask [CHANGELOG](https://github.com/mitsuhiko/flask-sqlalchemy/commit/b2eac43ab2a13acdc037d16812c92649bcdf4680) 这对我有用：

```
from flask_sqlalchemy import SQLAlchemy 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-12-19T20:40:25.113

在你的 virtualenv 中使用 pip 安装 Flask-SQLAlchemy：

```
pip install flask_sqlalchemy 
```

`flask_sqlalchemy`然后在您的代码中导入：

```
from flask_sqlalchemy import SQLAlchemy 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-05-15T02:12:50.107

好的，我已经通过 pip 重新安装了软件包，即使这没有帮助。然后我从其他具有与当前机器类似配置的工作机器上同步整个 /usr/lib/python-2.7 目录。它开始工作。我不知道，我的设置有什么问题。我之前和现在看到了一些不同的“print sys.path”输出。但现在我的问题已通过这项工作得到解决。

编辑：为我的设置找到了真正的解决方案。升级“仅 sqlalchemy 不能解决问题”我还需要升级`flask-sqlalchemy`以解决问题。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-05-13T16:52:25.897

[试试这个](http://packages.python.org/Flask-SQLAlchemy/api.html)：

```
from flask.ext.sqlalchemy import SQLAlchemy 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-06-30T13:13:10.923

所以这是一个想法！

因为它似乎在其他地方工作。

安装`python-virtualenv` 并且可以选择安装 virtualenv-wrapper （创建项目等非常酷）

在每个环境中，您可能有不同版本的鸡蛋。换句话说，您可以在两个不同的环境中拥有 sqlalchemy 1 和 sqlaclhemy 1.5，并且它们不会相互冲突。您当前安装的鸡蛋似乎有问题。

所以我们开始：

```
virtualenv --no-site-packages foo
source foo/bin/activate 
```

参数 --no-site-packages 将创建一个 virtualenv 并且不使用您计算机上已安装的包。这很像一个裸 python 安装。

`source foo/bin/activate`加载虚拟环境。

这并不是真正的用户友好。这就是[http://www.doughellmann.com/projects/virtualenvwrapper/](http://www.doughellmann.com/projects/virtualenvwrapper/)存在的原因。

也就是说，一旦你的 virtualenv 被激活，你应该在你的终端 "(foo)user@domain$:" 中看到类似的东西。这意味着你可以继续！

然后你必须做。

`python setup.py develop`你的项目。它应该在位于`foo`. 如果您需要安装其他任何东西，请使用`pip`或`easy_install`不使用`sudo`. 使用 virtualenv 时，您几乎不需要使用`sudo`. Sudo 将在您的全局 python 安装中安装包，而它不是必需的，也不是真正可取的。

如果您的 virtualenv 中发生了某些事情，您可以随时将其删除并创建一个新的。这没什么大不了的。没必要乱来。不工作？重新开始，在需要时执行`pip install -U`，在需要时定义版本等等。

最后但并非最不重要的一点是，在其他答案中，导入似乎发生了变化。如果 flask-sqlalchemy 的新版本位于其他地方，您应该更新您的导入或安装您以前使用的版本。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-09-18T16:35:52.860

首先安装库

```
pip install flask_sqlalchemy 
```

之后

```
from flask_sqlalchemy import SQLAlchemy 
```

把它放在 app.py 文件中，通过 SQLAlchemy 获取数据库的访问权限

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-13T14:24:52.060

此代码完美运行：

```
import sqlalchemy 
```

也许您将软件包安装在另一个版本的解释器中？

此外，就像 Shawley 指出的那样，您需要安装烧瓶扩展才能访问它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-04-11T18:11:58.287

我是新手，使用 python 3.8 并遇到了同样的问题。我安装了，`pip`而不是`pip3`因为我认为 pip 安装程序对于 python2 和 python3 是相同的，所以这是正确的安装

`pip3 install flask_sqlalchemy`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-09-21T04:47:10.167

可能是一个愚蠢的错误；但是，我遇到了这个问题，结果是“pip3 install sqlalchemy”将库安装在用户特定的目录中。

在我的 Linux 机器上，我以 user1 身份登录，在 user2 的目录中执行 python 脚本。我将 sqlalchemy 安装为 user1，默认情况下将文件放在 user1 的目录中。在 user2 的目录中安装 sqlalchemy 后，问题就消失了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-12T17:06:03.833

我的解决方案是使用：

```
from flask_sqlalchemy import SQLAlchemy 
```

代替

```
from flask.ext.sqlalchemy import SQLAlchemy 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-12-09T22:58:41.107

聚会很晚了，但希望这会对某人有所帮助，在相同的情况下大约一个小时，上面提到的任何解决方案都没有工作。（在 Windows 10 机器上）。

在 Settings/Preferences 对话框 ( `Ctrl`+ `Alt`+ `S`) 中，从侧面菜单中选择 Project: | 项目口译员。

检查您当前安装了哪些软件包（您需要 SQLAlchemy 和 Flask-SQLAlchemy）。双击任何包名称，将打开“可用包”菜单。

搜索丢失的软件包并单击安装。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-08-08T16:46:43.267

### 在 Windows 10 @ 2019 上

我遇到了同样的问题。原来我忘了安装以下软件包：

```
pip install flask_sqlalchemy 
```

安装软件包后，一切正常。希望，它帮助了像我这样的其他菜鸟。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-12-11T08:47:35.260

我刚刚在使用虚拟环境时遇到了同样的问题。对我来说，使用 venv 中的 python 安装软件包有效：
`.\venv\environment\Scripts\python.exe -m pip install flask-sqlalchemy`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-06-05T13:54:52.077

我不确定它是否仍然相关，但尝试卸载 sqlalchemy，然后安装 flask-sqlalchemy。

我想如果你有 sqlalchemy，flask-sqlalchemy 就行不通了。

在 Python 3.8 中尝试过

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-12T22:10:19.043

我也因一个愚蠢的错误而面临同样的问题。我从头开始为烧瓶创建了一个单独的 conda 环境。但是，我尝试使用 IPython 测试 FlaskSQLAlchemy 的导入。最后，我意识到它是基于系统的 python，而不是来自 conda env 的。始终确保您`sys.path`包含带有 flask_sqlalchemy 的目录。

# java - 如何调试这个java代码？该代码旨在获取Linux系统中的CPU使用率和内存信息

> ID：10572499
> 
> 赞同：-4
> 
> 时间：2012-05-13T14:22:45.103
> 
> 标签：java, linux, debugging, snmp, snmp4j

这是我从互联网上搜索的一个 java 代码：http: [//avery-leo.iteye.com/blog/298724](http://avery-leo.iteye.com/blog/298724)

它的目标是获取 Linux 系统中的 CPU 使用率和内存信息。我在eclipse中编译，发现两个错误如下：

```
private Config config=Config.getInstance();
SnmpUtil util=new SnmpUtil(); 
```

我也在注释部分用粗体标记。

我认为这两个错误是由于缺少class `Config`and引起的`SnmpUtil`，我尝试从网上搜索下载一个config.jar并将其添加到lib中，但仍然无法正常工作！我需要你的帮助！！

```
import java.io.BufferedReader;  
import java.io.File;  
import java.io.FileInputStream;  
import java.io.IOException;  
import java.io.InputStreamReader;  
import java.net.InetAddress;  
import java.util.StringTokenizer;  

import org.apache.log4j.Logger;  

/** 
 * To get the cpu usage and memory in Linux system
 *  
 * <p> 
 */  
public final class LinuxSystemTool implements Runnable{  
    private Logger log = Logger.getLogger(LinuxSystemTool.class);  
    private Config config=Config.getInstance();  //**Error when compiled**
    /** 
     * get memory by used info 
     *  
     * @return int[] result 
     *                      
     * result.length==4; int[0]=MemTotal;int[1]=MemFree；                  
     * int[2]=SwapTotal；int[3]=SwapFree; 
     * @throws IOException    
     * @throws InterruptedException 
     */  
public void run() {  
    // TODO Auto-generated method stub  

    while (true) {  

        try {  
            exec();  
            Thread.sleep(config.getThreadTime());  
        } catch (Exception e) {  
            // TODO Auto-generated catch block  
            log.error("Performance Monitoring error:"+e.getMessage());  
            e.printStackTrace();  
        }  
    }  
}  
public void exec() throws Exception {  
//      ServerStatus ss = new ServerStatus();  

    InetAddress inet = InetAddress.getLocalHost();  
    System.out.println("Performance Monitoring ip:"+inet.toString());  

    String ip=inet.toString().substring(inet.toString().indexOf("/")+1);  
    log.info("Performance Monitoring ip:"+ip);  

    int[] memInfo = LinuxSystemTool.getMemInfo();  
    System.out.println("MemTotal：" + memInfo[0]);  
    System.out.println("MemFree：" + memInfo[1]);  

    SnmpUtil util=new SnmpUtil();  //**Error when compiled**
    util.setCPU(getCpuInfo());  
//  util.setDISK(1);  
    util.setMEM(memInfo[0]/memInfo[1]);  
    util.setIP(ip);  

}  
public static int[] getMemInfo() throws IOException, InterruptedException {  
    File file = new File("/proc/meminfo");  
    BufferedReader br = new BufferedReader(new InputStreamReader(  
            new FileInputStream(file)));  
    int[] result = new int[4];  
    String str = null;  
    StringTokenizer token = null;  
    while ((str = br.readLine()) != null) {  
        token = new StringTokenizer(str);  
        if (!token.hasMoreTokens())  
            continue;  

        str = token.nextToken();  
        if (!token.hasMoreTokens())  
            continue;  

        if (str.equalsIgnoreCase("MemTotal:"))  
            result[0] = Integer.parseInt(token.nextToken());  
        else if (str.equalsIgnoreCase("MemFree:"))  
            result[1] = Integer.parseInt(token.nextToken());  
        else if (str.equalsIgnoreCase("SwapTotal:"))  
            result[2] = Integer.parseInt(token.nextToken());  
        else if (str.equalsIgnoreCase("SwapFree:"))  
            result[3] = Integer.parseInt(token.nextToken());  
    }  

    return result;  
}  

/** 
 * get memory by used info 
 *  
 * @return float efficiency 
 * @throws IOException 
 * @throws InterruptedException 
 */  
public static float getCpuInfo() throws IOException, InterruptedException {  
    File file = new File("/proc/stat");  
    BufferedReader br = new BufferedReader(new InputStreamReader(  
            new FileInputStream(file)));  
    StringTokenizer token = new StringTokenizer(br.readLine());  
    token.nextToken();  
    int user1 = Integer.parseInt(token.nextToken());  
    int nice1 = Integer.parseInt(token.nextToken());  
    int sys1 = Integer.parseInt(token.nextToken());  
    int idle1 = Integer.parseInt(token.nextToken());  

    Thread.sleep(1000);  

    br = new BufferedReader(  
            new InputStreamReader(new FileInputStream(file)));  
    token = new StringTokenizer(br.readLine());  
    token.nextToken();  
    int user2 = Integer.parseInt(token.nextToken());  
    int nice2 = Integer.parseInt(token.nextToken());  
    int sys2 = Integer.parseInt(token.nextToken());  
    int idle2 = Integer.parseInt(token.nextToken());  

    return (float) ((user2 + sys2 + nice2) - (user1 + sys1 + nice1))  
            / (float) ((user2 + nice2 + sys2 + idle2) - (user1 + nice1  
                    + sys1 + idle1));  
}  

/** 
 *  
 * <p> 
 *  
 * @author 
 * </p> 
 * @date 
 */  

public static void main(String[] args) throws Exception {  
    int[] memInfo = LinuxSystemTool.getMemInfo();  
    System.out.println("MemTotal：" + memInfo[0]);  
    System.out.println("MemFree：" + memInfo[1]);  
    System.out.println("SwapTotal：" + memInfo[2]);  
    System.out.println("SwapFree：" + memInfo[3]);  

    System.out.println("CPU use ratio：" + LinuxSystemTool.getCpuInfo());  
}  
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:33:17.240

您需要 snmp4j jar 用于 snmp 相关的 java 开发。你可以从[这里](http://www.snmp4j.org/)得到。

希望这对你有用。

# spring - 春改日期输入格式

> ID：10572502
> 
> 赞同：2
> 
> 时间：2012-05-13T14:23:04.917
> 
> 标签：spring, jakarta-ee, spring-mvc

我正在尝试创建一个表单，它将发回一个带有时间戳的对象。现在，输入格式必须是`yyyy-MM-dd HH:mm:ss`，我希望以格式输入时间戳`dd.MM.yyyy HH:mm`- 如何更改输入格式？

对象类：

```
public class Test {
    private Timestamp dateStart;

    public Timestamp getDateStart() {
        return dateStart;
    }
    public void setDateStart(Timestamp dateStart) {
        this.dateStart = new Timestamp(dateStart.getTime());
    }
} 
```

控制器方法：

```
@RequestMapping(value="test", method = RequestMethod.POST)
public View newTest(@ModelAttribute("test") Test test, Model model) {
    //save the Test object
} 
```

jsp形式：

```
<form:form action="service/test" method="post" modelAttribute="test">
    <form:input type="text" path="dateStart" />
</form:form> 
```

当格式不正确时，我收到此错误：

```
Field error in object 'test' on field 'dateStart': rejected value [22.05.2012 14:00]; codes [typeMismatch.test.dateStart,typeMismatch.dateStart,typeMismatch.java.sql.Timestamp,typeMismatch]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [test.dateStart,dateStart]; arguments []; default message [dateStart]]; default message [Failed to convert property value of type 'java.lang.String' to required type 'java.sql.Timestamp' for property 'dateStart'; nested exception is org.springframework.core.convert.ConversionFailedException: Unable to convert value "22.05.2012 14:00" from type 'java.lang.String' to type 'java.sql.Timestamp'; nested exception is java.lang.IllegalArgumentException: Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T08:00:05.667

感谢 Tomasz 我得到了答案，我必须在控制器中添加一个 binder 方法：

```
@InitBinder
public void binder(WebDataBinder binder) {binder.registerCustomEditor(Timestamp.class,
    new PropertyEditorSupport() {
        public void setAsText(String value) {
            try {
                Date parsedDate = new SimpleDateFormat("dd.MM.yyyy HH:mm").parse(value);
                setValue(new Timestamp(parsedDate.getTime()));
            } catch (ParseException e) {
                setValue(null);
            }
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-19T08:49:29.067

仅供参考，这是一个完整的 Timestamp 自定义编辑器的代码（它也支持 getAsText()），由[http://adfinmunich.blogspot.com/2011/04/how-to-write-sqltimestamppropertyeditor.html](http://adfinmunich.blogspot.com/2011/04/how-to-write-sqltimestamppropertyeditor.html)提供，只需更改 DEFAULT_BATCH_PATTERN匹配所需的日期/时间戳模式，或在构造 SqlTimestampPropertyEditor 时发送所需的模式：

```
package org.springframework.beans.custompropertyeditors;

import java.beans.PropertyEditorSupport;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;

/**
 * Property editor for java.sql.Timestamp, supporting SimpleDateFormat.
 * 
 * Using default Constructor uses the pattern yyyy-MM-dd
 * Using the constructor with String, you can use your own pattern.
 * 
 */
public class SqlTimestampPropertyEditor extends PropertyEditorSupport {

public static final String DEFAULT_BATCH_PATTERN = "yyyy-MM-dd";

private final SimpleDateFormat sdf;

/**
 * uses default pattern yyyy-MM-dd for date parsing.
 */
public SqlTimestampPropertyEditor() {
    this.sdf = new SimpleDateFormat(SqlTimestampPropertyEditor.DEFAULT_BATCH_PATTERN);
}

/**
 * Uses the given pattern for dateparsing, see {@link SimpleDateFormat} for allowed patterns.
 * 
 * @param pattern
 *            the pattern describing the date and time format
 * @see SimpleDateFormat#SimpleDateFormat(String)
 */
public SqlTimestampPropertyEditor(String pattern) {
    this.sdf = new SimpleDateFormat(pattern);
}

/**
 * @see java.beans.PropertyEditorSupport#setAsText(java.lang.String)
 */
@Override
public void setAsText(String text) throws IllegalArgumentException {

    try {
        setValue(new Timestamp(this.sdf.parse(text).getTime()));
    } catch (ParseException ex) {
        throw new IllegalArgumentException("Could not parse date: " + ex.getMessage(), ex);
    }
}

/**
 * Format the Timestamp as String, using the specified DateFormat.
 */
@Override
public String getAsText() {
    Timestamp value = (Timestamp) getValue();
    return (value != null ? this.sdf.format(value) : "");
}
} 
```

要使用此类，您将定义以下@InitBinder：

```
@InitBinder
public void binder(WebDataBinder binder) {binder.registerCustomEditor(Timestamp.class,
    new org.springframework.beans.custompropertyeditors.SqlTimestampPropertyEditor();} 
```

如果要使用非默认日期/时间戳模式，请在构造函数中将其提供给 SqlTimestampPropertyEditor，因此对于此特定示例，您可以使用：

```
@InitBinder
public void binder(WebDataBinder binder) {binder.registerCustomEditor(Timestamp.class,
    new org.springframework.beans.custompropertyeditors.SqlTimestampPropertyEditor("dd.MM.yyyy HH:mm");} 
```

# ruby-on-rails-3 - 使用时设置和访问环境变量的 cron 作业

> ID：10572510
> 
> 赞同：2
> 
> 时间：2012-05-13T14:24:13.587
> 
> 标签：ruby-on-rails-3, cron, environment-variables, whenever

我有一个 cronjob 调用需要访问环境变量（S3 凭据）的 rails 任务。我在 .bashrc 中设置了环境变量，我可以从命令行运行任务，但由于缺少凭据，cronjob 会失败。

如果我将凭据添加到 crontab，则 cronjob 将成功执行。我的 crontab 是使用when gem 生成的，因此我在 schedule.rb 中添加了 S3 凭据，如下所示：

```
# aws credentials
env :AWS_S3_KEY, ENV['AWS_S3_KEY']
env :AWS_S3_SECRET, ENV['AWS_S3_SECRET'] 
```

有没有办法让 cron 作业访问环境变量而无需在 crontab 文件中专门设置它们，同时仍然使用when gem？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T18:18:46.717

您应该定义一个接受这些环境变量的自定义 job_type。一个示例 schedule.rb 将是：

```
every 1.day do 
  job_type :my_custom_rake_job, "cd :path && RAILS_ENV=:environment AWS_S3_KEY=:aws_s3_key AWS_S3_SECRET=:aws_s3_secret bundle exec rake :task --silent :output"
  my_custom_rake_job 'foo:bar', :aws_s3_key => @aws_s3_key, :aws_s3_secret => @aws_s3_secret
end 
```

现在要在更新 crontab 时运行，您可以在 bash 中执行以下操作：

```
whenever --set "aws_s3_key=$AWS_S3_KEY&aws_s3_secret=$AWS_S3_SECRET" --update-crontab 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:50:12.487

是的，您需要设置一些脚本文件来为 cron 设置 evniroment 变量。[请参阅 SO 问题](https://stackoverflow.com/questions/2229825/where-can-i-set-environment-variables-that-crontab-will-use)

# javafx - Javafx 报告工具解决方案

> ID：10572519
> 
> 赞同：6
> 
> 时间：2012-05-13T14:26:42.857
> 
> 标签：javafx, javafx-2

我必须将我的 Swing 桌面应用程序重新创建为 javafx2 桌面。但是在摇摆时，我使用 Jasper 报告作为报告部分。将碧玉输出放置到 JFrame 以在同一帧上显示报告。但不幸的是，我在 Javafx2 上找不到此选项的最佳解决方案。所以我做了一个临时解决方案。jasper 部分将输出作为 pdf 并在 javafx 应用程序（jpedalfx pdf 查看器解决方案）上查看 pdf。它不是最好的，因为耗时..任何其他解决方案。我不喜欢 Webview 集成 (http://localhost/myreport.jasper)。因为它有额外的 apache 服务器。这样对吗？

javafx 新手的任何可行解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T17:40:45.380

Jasper 可以生成 PDF、XML、HTML、CSV、XLS、RTF、TXT 格式的报告。你可以：

*   将报告放入 HTML 并在 WebView 中呈现
*   将报告放入 XML，使用 JAXB 加载它并使用它来填充 TableView
*   解析任何格式并填充 TableView
*   将数据作为 Java 对象并填充 TableView

# c# - 我可以以某种方式暂时禁用 WPF 数据绑定更改吗？

> ID：10572522
> 
> 赞同：19
> 
> 时间：2012-05-13T14:27:19.460
> 
> 标签：c#, wpf, data-binding, mvvm

我有一个使用 MVVM 数据绑定的 WPF 应用程序。我`ObservableCollection<...>`确实在其中添加了很多项目。

现在我想知道每次我向集合中添加一个时，它是否会立即触发事件并导致不必要的开销？如果是这样，我是否可以以某种方式暂时禁用事件通知并在我的代码末尾手动触发一次，这样如果我添加 10k 个项目，它只会触发一次，而不是 10k 次？

更新：我尝试过这门课：

```
using System;
using System.Linq;
using System.Collections.Specialized;
using System.Collections.Generic;

namespace MyProject
{

    /// <summary> 
    /// Represents a dynamic data collection that provides notifications when items get added, removed, or when the whole list is refreshed. 
    /// </summary> 
    /// <typeparam name="T"></typeparam> 
    public class ObservableCollection<T> : System.Collections.ObjectModel.ObservableCollection<T>
    {

        /// <summary> 
        /// Adds the elements of the specified collection to the end of the ObservableCollection(Of T). 
        /// </summary> 
        public void AddRange(IEnumerable<T> collection)
        {
            foreach (var i in collection) Items.Add(i);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, collection.ToList()));
        }

        /// <summary> 
        /// Removes the first occurence of each item in the specified collection from ObservableCollection(Of T). 
        /// </summary> 
        public void RemoveRange(IEnumerable<T> collection)
        {
            foreach (var i in collection) Items.Remove(i);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Remove, collection.ToList()));
        }

        /// <summary> 
        /// Clears the current collection and replaces it with the specified item. 
        /// </summary> 
        public void Replace(T item)
        {
            ReplaceRange(new T[] { item });
        }
        /// <summary> 
        /// Clears the current collection and replaces it with the specified collection. 
        /// </summary> 
        public void ReplaceRange(IEnumerable<T> collection)
        {
            List<T> old = new List<T>(Items);
            Items.Clear();
            foreach (var i in collection) Items.Add(i);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Replace, collection.ToList()));
        }

        /// <summary> 
        /// Initializes a new instance of the System.Collections.ObjectModel.ObservableCollection(Of T) class. 
        /// </summary> 
        public ObservableCollection() : base() { }

        /// <summary> 
        /// Initializes a new instance of the System.Collections.ObjectModel.ObservableCollection(Of T) class that contains elements copied from the specified collection. 
        /// </summary> 
        /// <param name="collection">collection: The collection from which the elements are copied.</param> 
        /// <exception cref="System.ArgumentNullException">The collection parameter cannot be null.</exception> 
        public ObservableCollection(IEnumerable<T> collection) : base(collection) { }
    }
} 
```

我现在收到此错误：

> 附加信息：不支持范围操作。

错误出现在这里：

```
OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, collection.ToList())); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-04-28T05:08:01.123

ObservableCollection 的这种扩展很容易解决这个问题。

它公开了一个公共的 SupressNotification 属性，以允许用户控制何时禁止 CollectionChanged 通知。

它不提供范围插入/删除，但如果 CollectionChanged 通知被抑制，在大多数情况下，对集合执行范围操作的需求就会减少。

此实现将所有被抑制的通知替换为重置通知。这在逻辑上是合情合理的。当用户禁止通知，进行批量更改然后重新启用它时，应该适当地发送重新发送通知。

```
public class ObservableCollectionEx<T> : ObservableCollection<T>
{
    private bool _notificationSupressed = false;
    private bool _supressNotification = false;
    public bool SupressNotification
    {
        get
        {
            return _supressNotification;
        }
        set
        {
            _supressNotification = value;
            if (_supressNotification == false && _notificationSupressed)
            {
                this.OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset));
                _notificationSupressed = false;
            }
        }
    }

    protected override void OnCollectionChanged(NotifyCollectionChangedEventArgs e)
    {
        if (SupressNotification)
        {
            _notificationSupressed = true;
            return;
        }
        base.OnCollectionChanged(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-13T15:34:59.663

一个非常快速和简单的方法是继承 ObservableCollection 并在调用 AddRange 时暂停通知。有关说明，请参阅[以下博客文章](http://peteohanlon.wordpress.com/2008/10/22/bulk-loading-in-observablecollection/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-13T14:32:43.353

在我看来，有一种“棘手”的方式，但非常准确，可以实现这一目标。是写你自己`ObservableCollection`并实现`AddRange`处理。

通过这种方式，您可以将所有 10k 元素添加到某个“持有人集合”中，然后在您完成后，使用*您的*`AddRange`来执行此操作。 *`ObservableColleciton`*

 *您可以在此链接上找到更多信息：

[ObservableCollection 不支持 AddRange 方法....](https://stackoverflow.com/questions/670577/observablecollection-doesnt-support-addrange-method-so-i-get-notified-for-each)

或者这个也是

[AddRange 和 ObservableCollection](http://blogs.msdn.com/b/nathannesbit/archive/2009/04/20/addrange-and-observablecollection.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-05T03:03:03.037

抱歉，我想将此作为评论发布，因为我不会提供完整的实现细节，但这有点太长了。

关于“不支持范围动作”，这来自`ListCollectionView`WPF 用于绑定的，它确实不支持范围动作。但是，正常情况下`CollectionView`会。

WPF 选择`ListCollectionView`在绑定集合实现非泛型`IList`接口时使用。因此，基本上要使`AddRange`解决方案正常工作，您需要**完全**重新实现 ObservableCollection （而不是对其进行交互），但没有非泛型接口：

```
public class MyObservableCollection<T> :
    IList<T>,
    IReadOnlyList<T>,
    INotifyCollectionChanged,
    INotifyPropertyChanged
{
   // ...
} 
```

在 dotPeek 或等效工具的帮助下，实现这一点应该不会花很长时间。请注意，由于您将使用 a`CollectionView`而不是 a ，您可能会失去一些优化`ListCollectionView`，但根据我自己的经验，在全球范围内使用这样的类完全提高了性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-19T00:13:36.090

[我发现有必要对小果哥的回答](https://stackoverflow.com/a/29910752/2998072)进行扩展。我的代码与该答案相同，除了：

1.  我添加了对 OnPropertyChanged 方法的覆盖，以禁止发布 PropertyChanged 事件。
2.  在属性设置器中，对 OnPropertyChanged 进行了两次调用
3.  为了清楚起见，我重命名了字段和属性

我的 ObservableCollection 是 DataGrid 的 ItemsSource，在那里我有替换数千个项目的案例。如果不实施#1，我发现我没有获得我需要的性能提升（这是巨大的！）。我不确定#2 可能有多重要，但它显示在[另一个 StackOverflow 页面](https://stackoverflow.com/a/13303245/2998072)中，该页面对同一问题采取了稍微不同的方法。我猜测抑制 PropertyChanged 事件提高了我的性能这一事实证明 DataGrid 已订阅该事件，因此在关闭通知抑制时发布事件可能很重要。

有一点需要注意的是，我认为没有必要从方法 OnPropertyChanged 设置 _havePendingNotifications = true，但如果您发现不同，可以考虑添加。

```
 /// <summary>
    /// If this property is set to true, then CollectionChanged and PropertyChanged
    /// events are not published. Furthermore, if collection changes occur while this property is set
    /// to true, then subsequently setting the property to false will cause a CollectionChanged event
    /// to be published with Action=Reset.  This is designed for faster performance in cases where a
    /// large number of items are to be added or removed from the collection, especially including cases
    /// where the entire collection is to be replaced.  The caller should follow this pattern:
    ///   1) Set NotificationSuppressed to true
    ///   2) Do a number of Add, Insert, and/or Remove calls
    ///   3) Set NotificationSuppressed to false
    /// </summary>
    public Boolean NotificationSuppressed
    {
        get { return _notificationSuppressed; }
        set
        {
            _notificationSuppressed = value;
            if (_notificationSuppressed == false && _havePendingNotifications)
            {
                OnPropertyChanged(new PropertyChangedEventArgs("Item[]"));
                OnPropertyChanged(new PropertyChangedEventArgs("Count"));
                OnCollectionChanged(
                           new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset));
                _havePendingNotifications = false;
            }
        }
    }
    /// <summary> This field is backing store for public property NotificationSuppressed </summary>
    protected Boolean _notificationSuppressed = false;
    /// <summary>
    /// This field indicates whether there have been notifications that have been suppressed due to the
    /// NotificationSuppressed property having value of true.  If this field is true, then when
    /// NotificationSuppressed is next set to false, a CollectionChanged event is published with
    /// Action=Reset, and the field is reset to false.
    /// </summary>
    protected Boolean _havePendingNotifications = false;
    /// <summary>
    /// This method publishes the CollectionChanged event with the provided arguments.
    /// </summary>
    /// <param name="e">container for arguments of the event that is published</param>
    protected override void OnCollectionChanged(NotifyCollectionChangedEventArgs e)
    {
        if (NotificationSuppressed)
        {
            _havePendingNotifications = true;
            return;
        }
        base.OnCollectionChanged(e);
    }
    /// <summary>
    /// This method publishes the PropertyChanged event with the provided arguments.
    /// </summary>
    /// <param name="e">container for arguments of the event that is published</param>
    protected override void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (NotificationSuppressed) return;
        base.OnPropertyChanged(e);
    } 
```*

# magento - Magento产品页面上的选择性HTML块？

> ID：10572537
> 
> 赞同：0
> 
> 时间：2012-05-13T14:31:17.033
> 
> 标签：magento

我想在 Magento 中特定类别的所有产品页面上显示特定的 HTML 块。

例如：

类别 - 连衣裙、电话、gps 这些类别的 HTML 块：dress.phtml、phone.phtml、gps.phtml

在dress中的产品的所有页面上，都显示dress.phtml——礼服尺码表、颜色表、如何洗涤等。

在手机产品的所有页面上，都会显示phone.phtml - 电池保养，我们如何包装手机等。

在gps中的所有产品页面上，都会显示gps.phtml——GPS使用、安装等。

你明白了。我怎样才能在 Magento 中做到这一点？如何按产品类别在 catalog/product/view.phtml 中调用不同的 PHTML 文件（dress.phtml、phone.phtml 或 gps.phtml）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T18:26:10.730

*这可以通过对您的catalog/product/view.phtml*文件和自定义主题的*layout/local.xml*文件进行一些修改来轻松实现。

让我们从修改 local.xml 开始。打开它并输入/复制并粘贴以下代码：

```
<catalog_product_view>
    <reference name="content">
        <reference name="product.info">
            <block type="catalog/product_view" name="product.dress" as="productDress" template="wherever/you/keep/dress.phtml" />
            <block type="catalog/product_view" name="product.phone" as="productPhone" template="wherever/you/keep/phone.phtml" />
            <block type="catalog/product_view" name="product.gps" as="productGps" template="wherever/you/keep/gps.phtml" />
        </reference>
    </reference>
</catalog_product_view> 
```

我们通过修改 local.xml 所做的基本上是使您的新模板可用于*product.info*块中的*catalog/product/view.phtml*文件。块类型是 *catalog/product_view* 因此我们可以访问*catalog/product/view.phtml*中可用的所有相同信息和方法。然后我们可以在 view.phtml 中写一点代码来决定输出什么块

 **```
$_currentCategory = Mage::registry('current_category');
if ($_currentCategory->getId() == id of dress category) {
    echo $this->getChildHtml('productDress');
} elseif ($_currentCategory->getId() == id of phone category) {
    echo $this->getChildHtml('productPhone');
} elseif ($_currentCategory->getId() == id of gps category) {
    echo $this->getChildHtml('productGps');
} 
```

我们在这里所做的只是检查产品的当前类别并输出相关的块。当然，您需要将“ ***_* __**类别的 ID”替换为适当的类别 ID 值。如果您位于您想要查找的类别之一的子类别中，这*将不起作用。*例如，如果您的结构如下*电话 > 配件 > 手机充电器产品*，我们只会在手机充电器产品中找到最新的类别（配件）。还有其他方法可以找到分散在 Google 和 StackOverflow 中的父类别。

希望有帮助。不幸的是，我没有办法测试这段代码，但它应该可以工作。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T18:34:17.813

$product->getCategoryIds() 可以为您提供产品所属的类别 ID。**

# php - 如何使用 get_headers 检查远程文件是否为图像

> ID：10572538
> 
> 赞同：1
> 
> 时间：2012-05-13T14:31:19.810
> 
> 标签：php

```
$headers = get_headers("http://www.domain.com/image.jpg"); 
```

如何使用它确保文件是实际图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:34:48.567

一点也不。标头可能会或可能不会告诉您（通过`Content-type`），服务器**认为**这是什么 - 但没有什么能阻止您将例如`myfile.zip`放在网络服务器上，然后将其重命名为`myfile.jpg`. 网络服务器将提供它`Content-type: image/jpeg`，它肯定不是。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-13T14:39:47.663

就像 Eugen Rieck 所说，不下载就无法确定它是否是图像。服务器始终可以更改 Content-Type 标头以使其看起来像图像。

但是，下载后，您可以使用此功能进行检查：

```
if (getimagesize('path/to/image.jpg')) {
    // image
}
else {
    // not an image
} 
```

如果您仍然想使用 Content-Type，这应该可以工作：

```
$headers = array_change_key_case (get_headers ('http://example.com/exampleimage.jpg', 1) );
if (substr ($headers ['content-type'], 0, 5) == 'image') {
    // image
}
else {
    // not an image
} 
```

`array_change_key_case()`用于使所有数组键小写，因此大小写没有区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T14:37:32.117

在结果数组中查找“Content-Type”并检查它是否以“image/”开头

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T19:09:29.437

这个方法很简单，

```
$headers = get_headers( 'http://covers.openlibrary.org/b/isbn/9780141323367-S.jpg' );
$image_exist = implode(',',$headers);
if (strpos($image_exist, 'image') !== false) 
{
    echo 'Yups';
}
else 
{
    echo "Nopes";
} 
```

# c++ - ')' 标记之前的预期主表达式：c++

> ID：10572539
> 
> 赞同：0
> 
> 时间：2012-05-13T14:31:20.940
> 
> 标签：c++, qt

我是 C/C++ 的新手，我一直在使用 python，我正在尝试获取当前时间并对其进行分区，但是我在使用`ctime`.

```
float t2lmst(){
    QString t = ctime(time_t); //line with error
    QString year =t.substr(20,4);
    QString monthn =t.substr(4,3);
    QString day =t.substr(8,2);
    QString hour =t.substr(11,2);
    QString minute =t.substr(14,2);
    QString second =t.substr(17,2);
} 
```

错误正是：

```
error: expected primary-expression before ')' token 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:40:21.847

您不能将类型传递给函数。您需要传递实际的对象/结构。`ctime`接受一个指向 a 的指针`time_t`。

```
time_t now = time(0);
QString t = ctime(&now); 
```

也`QString`没有`substr`成员函数。[`mid`](http://qt-project.org/doc/qt-4.8/qstring.html#mid)而是查看和相关的功能。或使用`localtime`/ `gmtime`。或者更好的是，使用 Qt 日期和时间对象。

# python - 如何使用 Rabbyt 进行像素完美碰撞检测？

> ID：10572540
> 
> 赞同：3
> 
> 时间：2012-05-13T14:31:34.463
> 
> 标签：python, collision-detection, pyglet

我已经开始研究 Rabbyt 库，到目前为止，我真的很喜欢将它与 pyglet 结合使用。

库中似乎没有实现的一件事是精灵之间的像素完美碰撞检测。我在实施时有两个问题。

首先，我正在使用 pyglet 加载精灵的纹理，但我不明白如何从纹理中获取位掩码（我非常有限的 OpenGL 知识是主要问题）。似乎 BufferImageMask 是从 AbstractImage 实例获得的，而不是从纹理本身获得的。这样做的正确方法是什么？

其次，实现实际的碰撞检测算法有哪些不同的方法？如果有任何方法/变化，我最感兴趣，因为到目前为止我读过的所有内容都是这样的：

[碰撞检测算法@gamedev.net](http://www.gamedev.net/page/resources/_/technical/game-programming/collision-detection-r735)

我只是尽量不要错过任何重要信息，算法本身是可靠的。

提前致谢！

PS 我在 Python 2.7 中编码，但我宁愿在 C 中实现实际的像素完美碰撞检测算法并将其用作扩展。

## 更新

我已经设法使用非旋转精灵进行像素完美碰撞检测：

```
 r1 = collision[entity1].aabb
    r2 = collision[entity2].aabb
    sprite1 = renderable[entity1].sprite
    sprite2 = renderable[entity2].sprite
    ri = r1.intersect(r2)

    offx1, offy1 = int(ri.left - r1.left), int(ri.top - r1.top)
    offx2, offy2 = int(ri.left - r2.left), int(ri.top - r2.top)

    d1 = sprite1.texture.get_image_data().get_data('A', sprite1.texture.width)
    d2 = sprite2.texture.get_image_data().get_data('A', sprite2.texture.width)

    p1 = cast(d1, POINTER(c_ubyte))
    p2 = cast(d2, POINTER(c_ubyte))

    for i in range(0, int(ri.width)):
        for j in range(0, int(ri.height)):
            c1, c2 = 0, 0
            x1 = offx1+i
            y1 = (j+offy1)*sprite1.texture.width
            x2 = offx2+i
            y2 = (offy2+j)*sprite2.texture.width

            if x1 >= 0 and y1 >= 0:
                c1 = p1[x1 + y1]

            if x2 >= 0 and y2 >= 0:
                c2 = p2[x2 + y2]

            if c1>0 and c2 >0:
                pairs.add(pair)
                break 
```

碰撞和可渲染只是与给定实体相关联的对象的字典。该算法是这个算法的修改版本：[Pyglet 像素完美碰撞](http://code.google.com/p/darkcoda/source/browse/sprite_collision/collide.py)

虽然这非常好（而且速度很快，即使对于像这样被破解的代码也是如此）它对旋转的精灵没有用（我需要，除非为不同角度缓存大约 100 个不同版本的相同精灵是一个可行的选择），所以我是仍在寻找解决该问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:21:48.637

虽然我无法回答关于 pyglet、纹理和图像的第一个问题（我在在线 API 的 Texture 中找到了一个名为“get_image_data”的方法；也许可以使用？），我可以回答第二个问题。

除了您在链接中提供的方法之外，我至少知道另外两种方法：第一种是使用 OpenGL，将图像绘制到缓冲区，并检查它们是否重叠。我不知道这有多快，但我可以想象它很慢。但是，它确实支持旋转和缩放。

第二个和你给出的有点相似；但是不是找到两个轴对齐的边界框的交点并且只检查交点内部，而是找到并检查两个凸包的交点。这样做的一个优点是凸包通常提供更好的拟合，另一个优点是凸包可以旋转，而轴对齐的边界框不能。主要缺点是凸包相交比轴对齐边界框相交复杂得多，因此难以实现。

我编写了一个使用第二种方法的库；你可以在[PoxelColl](https://github.com/Poxelcoll/Poxelcoll)找到它。它应该比其他像素完美的碰撞检测库更快，尤其是对于旋转和缩放。我不知道你是否可以从 Python 中使用它；如果您使用 Jython，则有一个 Scala 版本，还有一个您可以在 Python 中绑定的 C++ 版本，但这可能是相当多的额外工作。因此，如果您不需要缩放或旋转，最好简单地实现您已经找到的版本并测试它是否足够快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T18:06:37.637

**回答更新**

以下伪代码可能会解决问题：

```
...

middleX1 = sprite1.texture.width/2
middleY1 = sprite1.texture.height/2

middleX2 = sprite2.texture.width/2
middleY2 = sprite2.texture.height/2

angle1 = ?   #Radians.
vX11 = -cos(angle1)
vY11 = -sin(angle1)
vX12 = -cos(angle1 + math.pi/2)
vY12 = -sin(angle1 + math.pi/2)

angle2 = ?   #Radians.
vX21 = -cos(angle2)
vY21 = -sin(angle2)
vX22 = -cos(angle2 + math.pi/2)
vY22 = -sin(angle2 + math.pi/2)

for ...
    for ...

        ...

        aX1 = x1 - middleX1
        aY1 = j+offy1 - middleY1
        aX2 = x2 - middleX2
        aY2 = j+offy2 - middleY2

        tX1 = vX11*aX1 + vY11*aY1 + middleX1
        tY1 = vX12*aX1 + vY12*aX1 + middleY1

        tX2 = vX21*aX2 + vY21*aY2 + middleX2
        tY2 = vX22*aX2 + vY22*aX2 + middleY2

        #Use tX* and tY* for indexing. Remember to multiply tY* with width.

        ... 
```

这应该有效，假设角度是顺时针和弧度，并且旋转应该发生在每个精灵的中间。基本上，它是一些手工编码的向量和矩阵数学。一个更整洁、更易于维护的解决方案将使用矩阵，但我不太了解 Python，所以我决定避免使用矩阵。

数学的工作原理是，对于每个图像中的每个点，找到它与中间的相对位置，通过将坐标与沿新旋转轴的单位向量相乘来旋转它，最后将中间加回以获得非相对协调。

# javascript - 用javascript替换子字符串，但不是在标签之间或标签中

> ID：10572541
> 
> 赞同：1
> 
> 时间：2012-05-13T14:31:39.360
> 
> 标签：javascript, html, regex, parsing, replace

所以我在这里写了这段代码：

```
highlighter: function (item) {
    var parts = this.query.split(" ");
    var length = parts.length;
    for (var i = 0; i < length; i++){
        if(parts[i] != ""){
            item = item.replace(new RegExp('(' + parts[i] + ')', 'ig'), function ($1, match) {
                return '<strong>' + match + '</strong>'
            })
        }
    }

  return item;
} 
```

它的作用是：

*   我有字符串`item`和字符串`this.query`
*   我`this.query`在每个空间拆分，并将生成的子字符串放入`parts[]`

我的目标是使每次出现的子字符串都`parts[]`以`item`粗体显示。

因此，如果

```
item = "This is some text" 
```

和

```
this.query = "This some" 
```

我想要`<strong>This</strong> is <strong>some</strong> text`。

这非常有效，除非我在`<strong>`元素本身中获得匹配项。所以我只想替换`strong`标签本身中没有的匹配项。因为我得到了带有`ong>`or`trong>`的结果字符串。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:06:49.467

如果您想避免使用强标签，请一步完成替换：

```
item = item.replace(
    new RegExp(parts.join('|'), 'ig'),
    function (match) {
        return '<strong>' + match + '</strong>'
    }
) 
```

如果“item”在开始之前包含strong，您仍然会遇到问题，但否则您不会遇到问题。

### 编辑：

假设您要匹配“this”、“that”和“the other”。一个*正则表达式*，或者`RegExp`说是`This|some|the other`。奇怪的是，传递给的字符串`new RegExp`被解析为常规表达式。

另一个需要注意的重要事情是，`item.replace(regex, callback)`它将用调用*每个匹配的结果替换它找到的每个*`callback(match, ...)`匹配。传递给回调的第一个参数是正则表达式的整个匹配，而其余参数是匹配中的组。

如果您想了解更多信息，请阅读正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T17:01:50.050

因为在这些语言中没有原生的否定后视，如果你想在*替换时**忽略*标签，你需要*匹配*它们并*用它们自己替换它们*，如下所示：

 ***```
item = item.replace(
  new RegExp(
    "(<\\/?\\w+(\\s+\\w+(\\s*=\\s*(\"[^\"]*\"|'[^']*'|\\S+))?)*>)"
      + "|(" + parts.join("|") + ")",
    "ig"),
  function (match, tag, p2, p3, attributeValue, matchedText) {
    if (tag)
    {
      return tag;
    }

    return "<strong>" + matchedText + "<\/strong>";
  }); 
```

（不需要循环）

请注意，这`\w+`只是元素类型名称或属性名称中允许的字符的近似值，并且`\s`只是标记空白的近似值。

如果您将搜索词用作`RegExp`构造函数的字符串参数，您可能还必须转义搜索词。为此，如果您对此处所需的转义序列的数量感到困惑，请参阅[JSX:regexp.js](http://PointedEars.de/scripts/regexp.js)，其中`String.prototype.regExpEscape()`和`RegExp.prototype.concat()`方法应该分别派上用场。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:02:23.357

要仅在标签之外进行搜索，您需要一个可以过滤掉所有 HTML 标签并仅向您显示标签之间可以搜索的文本片段的解析器。我不知道您的特定应用程序是如何工作的，但获得解析器的最佳位置通常是让浏览器为您解析 HTML，并仅在标签之间的结果文本节点上进行搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T00:12:33.807

我使用的解决方案！：

```
highlighter: function (item) {
    var parts = this.query.replace(/\s+/g, " ").replace(/^\s|\s$/g,"").split(/\s/);
    if( item.match(/(?:&[^;]*;)+/) != null){
        item = strip(item);
    }
    item = item.replace(
        new RegExp('(' + parts.join('|') + ')', 'ig'),
        function (_, match) {
            return '<strong>' + match + '</strong>'
        }
    )
    return item;
} 
```

这就是我把这个功能变成的。第一行是去掉末尾的空格和空格序列。这是进行正确分割所必需的，否则荧光笔会突出显示所有空间。（只有在观看 HTML 时才能看到）。接下来我检查项目中是否有任何特殊字符。如果是这样，我使用此功能剥离它们：

```
function strip(html)
{
    var tmp = document.createElement("DIV");
    tmp.innerHTML = html;
    return tmp.textContent||tmp.innerText;
} 
```

然后我做了替换部分，我使用了 Eric 的代码。

非常感谢！我也更好地了解了正则表达式！***

# php - PHP合并数组只有不重复的值

> ID：10572546
> 
> 赞同：77
> 
> 时间：2012-05-13T14:32:13.370
> 
> 标签：php, arrays, merge

我需要将两个数组合并为 1 个数组，但我需要在它们共有的主要数据（我的意思是重复值）之前删除，合并时我只需要唯一值。

我怎样才能做到这一点？

这是数组示例：

第一个数组

```
array(3) { 
    [0]=> object(stdClass)#17 (1) { 
        ["email"]=> string(7) "gffggfg" 
    } 
    [1]=> object(stdClass)#18 (1) { 
        ["email"]=> string(6) "wefwef@test.it" 
    } 
    [2]=> object(stdClass)#19 (1) { 
        ["email"]=> string(6) "wefewf" 
    } 
} 
```

第二个数组

```
array(3) { 
    [0]=> object(stdClass)#17 (1) { 
        ["email"]=> string(7) "gffggfg@test.it" 
    } 
    [1]=> object(stdClass)#18 (1) { 
        ["email"]=> string(6) "wefwef" 
    } 
    [2]=> object(stdClass)#19 (1) { 
        ["email"]=> string(6) "wefewf" 
    } 
} 
```

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-05-13T14:36:21.847

您可以将[`array_merge()`](http://php.net/manual/en/function.array-merge.php)功能与[`array_unique()`](http://php.net/manual/en/function.array-unique.php)功能结合起来（两个标题都很不言自明）

```
$array = array_unique (array_merge ($array1, $array2)); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-13T14:41:26.270

如果我正确理解了这个问题：

```
 $a1 = Array(1,2,3,4);
 $a2 = Array(4,5,6,7);
 $array =  array_diff(array_merge($a1,$a2),array_intersect($a1,$a2));
 print_r($array); 
```

返回

```
Array
(
[0] => 1
[1] => 2
[2] => 3
[5] => 5
[6] => 6
[7] => 7
) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-22T13:31:32.140

我一直在运行一些我能想象到的所有方式的基准测试。我对堆叠大量包含 10-20 个字符串元素的数组进行了测试，结果生成了一个包含所有唯一字符串的数组。对于仅堆叠 2 个阵列，这应该是相同的。

我发现最快的是我尝试过的最简单的事情。

```
$uniques = [];
foreach($manyArrays as $arr ) {
  $uniques = array_unique(array_merge($uniques, $arr));
} 
```

我给这个贴上了“太天真而无法工作”的标签，因为它必须在每次迭代时对 uniques 数组进行排序。然而，这比任何其他方法都快。在 manyArrays 中使用 500.000 个元素进行测试，每个元素包含 10-20 个字符串（来自 PHP 7.3）。

紧随其后的是这种方法，它慢了大约 10%。

```
$uniques = [];
foreach($manyArrays as $arr ) {
  foreach($arr as $v) {
    if( !in_array($v, $uniques, false) ) {
      $uniques[] = $v;
    }
  }
} 
```

在某些情况下，第二种方法可能会更好，因为它支持[in_array](https://www.php.net/manual/en/function.in-array.php) () 的 'strict' 参数以进行严格的类型检查。如果设置为 true，则第二个选项确实比第一个选项慢得多（大约 40%）。第一个选项不支持严格的类型检查。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-04T19:53:44.280

更快的解决方案：

```
function concatArrays($arrays){
    $buf = [];
    foreach($arrays as $arr){
        foreach($arr as $v){
            $buf[$v] = true;
        }
    }
    return array_keys($buf);
}

$array = concatArrays([$array1, $array2]); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-06-06T13:09:42.747

答案有点晚了，但我刚刚发现数组联合运算符`+`做得很好（[在](https://www.dyn-web.com/php/arrays/combine.php)第 3 部分找到）。

```
$array1 + $array2 = $array //if duplicate found, the value in $array1 will be considered ($array2 value for array_merge, if keys clearly specified) 
```

# html - 你如何创建一个凸起的标签栏项目，比如在 Instagram 或 Dailybooth 中找到的带有 css / html 的项目

> ID：10572547
> 
> 赞同：4
> 
> 时间：2012-05-13T14:32:17.130
> 
> 标签：html, css, ios, web-applications, uitabbar

我在一个使用 HTML5/CSS 的 webapp 项目上工作。我想加入一个 iOS 风格的标签栏。有几个插件，如 iTabBar / BarTender / ...但我想加入一个自定义中心按钮，如[Instagram](http://idevrecipes.files.wordpress.com/2010/12/instagram.png)或[Dailybooth](http://idevrecipes.files.wordpress.com/2010/12/dailybooth.png)。

您使用现有的解决方案吗？或实现它的想法？

预先感谢您的回答。

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T10:58:00.467

[在这里](http://idevrecipes.com/2010/12/16/raised-center-tab-bar-button/)您可以找到一个非常有用的解决方案！！

我希望你喜欢它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:58:08.227

我实际上还没有找到现成的解决方案，但我可以推荐的是使用 sencha 或 jquery mobile 并检查现有的应用程序！

[jQuery 移动示例](http://i.stack.imgur.com/NCqV1.jpg)

这是[煎茶触摸应用程序](http://www.sencha.com/apps/)

这两个框架需要完全不同的经验水平，采用 sencha 方法需要一段时间（如果您熟悉 ExtJS 会更容易），但它提供了非常可靠的平台，还具有编译器工具，为 ios 和 android 的市场应用程序做好准备

另外，如果您只需要这个工具栏，请考虑自己编写代码，只需检查在这两个框架中的任何一个中如何实现停靠的工具栏，因为这在 iphone 上有点令人头疼

# objective-c - 绑定到 NSArrayController 的排列对象显示一个左括号

> ID：10572548
> 
> 赞同：1
> 
> 时间：2012-05-13T14:32:27.043
> 
> 标签：objective-c, cocoa, binding, key-value-observing, nsarraycontroller

我有一个 NSArrayController 通过它的`contentArray`绑定绑定到我的可变模型数组。我有一些控件（如检查器），我想在其中显示数组中对象的一些属性。我将控件的值绑定到`arrangedObjects.property`我的 NSArrayController。

当我将一个对象添加到我的模型数组时，所有控件都显示一个左括号`(`。如果我将控件绑定到`selection.property`而不是让 NSArrayController 一直选择所有对象，它就可以工作。但我想知道为什么它不适用于安排内容？你有什么主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T19:55:04.667

您将哪些控件绑定到阵列控制器？各种控件使用它们的绑定做不同的事情。

左括号是数组的第一行`description`。控件需要一个字符串，并通过调用从绑定的事物中获取一个字符串`-description`。

# asp.net - 在 asp.net mvc 应用程序上以另一个用户身份运行带有 Process.Start 的 .bat 文件

> ID：10572549
> 
> 赞同：2
> 
> 时间：2012-05-13T14:32:34.690
> 
> 标签：asp.net, asp.net-mvc, iis-7, iis-7.5

我正在尝试使用 Process.Start 运行批处理文件

我正在使用以下代码：

```
Process myProcess = new Process();
myProcess.StartInfo.FileName = "D:\\test.bat";
myProcess.StartInfo.UserName = "user";
var strPass = new SecureString();

for (int i = 0; i < strUserPass.Length; i++)
    {
        strPass.AppendChar(strUserPass[i]);
    }
strPass.MakeReadOnly();

myProcess.StartInfo.Password = strPass;
myProcess.StartInfo.UseShellExecute = false;
myProcess.StartInfo.RedirectStandardInput = true;
myProcess.StartInfo.RedirectStandardOutput = true;
myProcess.StartInfo.RedirectStandardError = true;

myProcess.Start(); 
```

我正在使用 ASP.NET MVC 3 和 IIS 7.5

当我在本地计算机（Windows 7）上运行此代码时，它运行良好。

当我在我的服务器 (Windows Server 2008 R2) 上运行此代码时，它不起作用。进程启动但批处理文件未执行且进程没有任何 StandardOutput 或 StandardError。我无法获得任何信息，也没有错误。

如果我没有指定任何用户名和密码，它可以在我的服务器上运行。批处理文件使用我的网络服务帐户执行。

我真的需要使用特定的用户名执行该过程。

你知道为什么它不起作用吗？

---编辑：微软支持找到了解释

由于 Windows Vista 和会话隔离，服务和用户应用程序在不同的会话中执行。

Windows 不允许使用其他凭据执行从会话到另一个会话的进程。该过程将使用会话的默认凭据（AppPool 凭据）执行。

更多信息[在这里](http://msdn.microsoft.com/en-us/library/bb756986.aspx)和[这里](http://msdn.microsoft.com/en-us/windows/hardware/gg463353)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T07:50:58.450

你试过`myProcess.StartInfo.CreateNoWindow = true;`吗？

我曾经发现过这段很棒的代码（我猜在这里）对我来说很好用：

```
 private bool RunProcess(string executableProgram, string arguments, int timeOut)
    {
        bool Result = false;
        int exitCode = 0;

        using (Process process = new Process())
        {
            process.StartInfo.FileName = executableProgram;
            process.StartInfo.Arguments = arguments;
            process.StartInfo.UseShellExecute = false;
            process.StartInfo.RedirectStandardOutput = true;
            process.StartInfo.RedirectStandardError = true;
            process.StartInfo.CreateNoWindow = true;
            process.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;

            StringBuilder output = new StringBuilder();
            StringBuilder error = new StringBuilder();

            using (AutoResetEvent outputWaitHandle = new AutoResetEvent(false))
            using (AutoResetEvent errorWaitHandle = new AutoResetEvent(false))
            {
                process.OutputDataReceived += (sender, e) =>
                {
                    if (e.Data == null)
                    {
                        outputWaitHandle.Set();
                    }
                    else
                    {
                        output.AppendLine(e.Data);
                    }
                };
                process.ErrorDataReceived += (sender, e) =>
                {
                    if (e.Data == null)
                    {
                        errorWaitHandle.Set();
                    }
                    else
                    {
                        error.AppendLine(e.Data);
                    }
                };

                process.Start();

                process.BeginOutputReadLine();
                process.BeginErrorReadLine();

                if (process.WaitForExit(timeOut) && outputWaitHandle.WaitOne(timeOut) && errorWaitHandle.WaitOne(timeOut))
                {
                    exitCode = process.ExitCode;
                    Result = (exitCode == 0);
                }
                else
                {
                    // Timed out.
                    Result = false;
                }
            }

            if (!string.IsNullOrEmpty(output.ToString()))
            {
                Logger.Info(output.ToString());
            }
            if (!string.IsNullOrEmpty(error.ToString()))
            {
                Logger.Error(error.ToString());
            }

        }
        return (Result);
    } 
```

# java - 此错误是什么意思“setDataSource：JNI 中的外部路径是？x@”

> ID：10572556
> 
> 赞同：0
> 
> 时间：2012-05-13T14:33:38.670
> 
> 标签：java, android

嗨，我一直`E/MediaPlayer-JNI(14285): setDataSource: outside path in JNI is ?x@`在我的 logcat 中得到这个。这意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T13:42:28.233

在使用 videoView 设置 MediaControllers setAnchorView 和 setMediaPlayer 后，我的问题得到了解决。

```
 MediaController mc = new MediaController(this);
                mc.setAnchorView(videoView);
                mc.setMediaPlayer(videoView);

                videoView.setMediaController(mc);
                videoView.setVideoURI(myUri);
                videoView.start(); 
```

我仍然在错误 logcat 中收到消息。如果有人知道问题是什么，请分享。

# java - 类层次解决方案

> ID：10572557
> 
> 赞同：0
> 
> 时间：2012-05-13T14:33:46.963
> 
> 标签：java, android, design-patterns, application-design

我有 `Activity`课，`ListActivity`课，`TabActivity`课。我想使用相同的功能扩展这些类。例如，将方法添加`toDoSomething()`到它们中的每一个中。在 Java 中使用多重继承是不可能的。

您能否告诉我设计模式或其他解决方案无需复制粘贴即可解决此问题

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:43:39.417

`DoSomethingHelper`如果您使用`doSomething()`方法（可能）定义自己的类，则可以减少复制粘贴`doSomething(Activity activity)`，然后根据需要从所有活动中引用它。我不知道有什么更好的解决方案。

# c - 在 C 中：如何检查输入文件是否存在，文件中的数字是 int 还是 float 以及它们是否在一个范围内？

> ID：10572559
> 
> 赞同：0
> 
> 时间：2012-05-13T14:34:17.297
> 
> 标签：c

首先，这是我的第一个 C 项目（也是我的第一个任何语言的编程项目之一），所以如果我的语法看起来很奇怪或者我做了一些奇怪的事情，我深表歉意。

我有一个使用三个输入文件的程序。每个文件都包含一些数字：一些是整数，一些是浮点数。我已经设法检查文件是否存在，但不是其他东西。如果不满足这些要求中的任何一个，则程序应结束并相应地显示错误消息。我已经看到一些问题询问其中之一，但并非所有问题都结合在一起。我看到的答案也需要一些空间。我希望用尽可能少的行来完成这项工作。非常感谢您的帮助。

我一直在处理的脚本之一可以在下面看到。如果输入文件不存在，它会给出一条错误消息，但我已经删除了检查 int 与 float 以及它们是否在范围内的尝试。

* * *

```
#include "header.h"
void visualreader(int *x_range, int *y_range, int *z_range,
                  int *x_cells, int *y_cells, int *z_cells, int *time) {

  // Scans the input file containing parameters for visualizing
  // the velocity vector field
  FILE *fp = fopen("visual_input.dat", "r");

  if (fp) {
    fscanf(fp, "%d %d %d\n", x_range, y_range, z_range);
    fscanf(fp, "%d %d %d\n", x_cells, y_cells, z_cells);
    fscanf(fp, "%d\n", time);
    fclose (fp);
  } else {
    perror("error opening the file" );
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:43:15.893

> 检查输入文件是否存在

`fopen()``NULL`如果失败，将返回，因此您的条件 with`fp`是正确的方法。

> 如果文件中的数字是 int 或 float

您必须将值作为字符串读取，然后手动检查`.`字符串中的 a。老实说，如果这些值可以是浮点数，那么只需假设它们始终是浮点数并照此读取它们。在这个阶段使您的程序复杂化以优化整数是没有好处的。

> 如果它们在一个范围内

对于读入的每个值（作为浮点数），只需手动检查，例如：

```
if (x_range < minimum_value || x_range > maximum_value) {
  error_routine(...);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:16:02.463

要检查文件是否存在于纯 C 中，您可以使用unistd.h 中的[访问函数，如下所示：](http://itee.uq.edu.au/~comp2303/Leslie_C_ref/C/MAN/access.htm)

```
if( access( "visual_input.dat", F_OK ) != -1 ) {
    // file exists
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T21:51:34.863

以下示例是一个主程序，但很容易成为一个库函数。它不打印任何东西，而是返回一个值，以防它变成一个库函数。

为了测试这个程序——我使用的是 Ubuntu 10.04——我只是`echo $?`在程序完成时，所以查看错误代码。0 是成功，非零是失败。

如果文件打开成功，我添加了一个 fclose。打开文件而不关闭它是不好的做法。

我已经包括了对 errno 和 fp 值的检查。我确实检查了 C fopen 文档，您真正需要检查的是 fp 的值是否为 NULL。因此，我使用了||，而不是&&。

```
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>

#define MIN_ARGS_SUPPLIED 2

int main(int argc, char *argv[])
{
    FILE *fp;
    int rc = 0;

    if(MIN_ARGS_SUPPLIED != argc)
    {
       printf("Usage: file_detect file-name\n");
       rc = -1;
    }
    else
    {
        errno = 0; /* errno is already declared by including errno.h */

        fp=fopen(argv[1],"r");

        if(fp == NULL || errno == ENOENT)
        {
           rc = errno; 
        }
        else
        {
            fclose(fp);
        }
    }

    return rc;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T22:17:25.707

这是一个将检测文件是否存在的示例。

```
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>

int main(){
    FILE *fp;
    errno = 0;
    fp=fopen("Not_exist.txt","r");
    if(fp == NULL && errno == ENOENT)
        perror("file does not exist");
    else
        fclose(fp);

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-13T18:05:50.333

测试文件是否存在是特定于操作系统的。但是，仅使用标准库调用，设置`fopen()`失败时*errno*；该值是特定于操作系统的，但您可以使用 use[`perror()`](http://www.cplusplus.com/reference/clibrary/cstdio/perror/)来输出有意义的消息。

由于您使用的是 fscanf() ，这意味着这些值是数值的 ASCII 表示，而不是二进制值。如果您通过使用 %f 格式说明符将所有值解释为浮点数，则将正确解释*实数*和*整数*十进制表示。这比试图通过检查来确定一个数字是否是整数要容易得多。

# c++ - 提取当前可执行文件名

> ID：10572560
> 
> 赞同：5
> 
> 时间：2012-05-13T14:34:25.543
> 
> 标签：c++, windows

首先，我想说我不是指完整路径，
GetModuleFileName 或 argv[0] 产生什么。有没有比在最后一个反斜杠之前忽略所有内容更聪明的解决方案？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-13T14:46:22.663

[`GetModuleFileName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683197.aspx)首先，您希望通过调用传递`NULL`作为模块句柄来获取可执行文件的完整路径。然后调用[`PathFindFileName`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773589.aspx)拉出文件名组件。

和之间其实是有区别`GetModuleFileName`的`argv[0]`。后者是用于启动进程的名称。它可能缺少完整路径，但更重要的是，它可能缺少`.exe`扩展名。如果您想知道实际的文件名，那么您需要使用`GetModuleFileName`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:39:10.203

如果您使用 .NET，那么[这里](https://stackoverflow.com/questions/980202/how-do-i-find-the-current-executable-filename)有一个答案。但在内部它可能正在调用`GetModuleFileName`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-17T15:03:10.860

在 Windows C/C++ 中，有一个`extern char * _pgmptr`可以读取的全局变量以及来自`_get_pgmptr(char ** buffer)`.

**注意事项**

> 仅当您的程序有一个狭窄的入口点（如 main() 或 WinMain()）时才调用[_get_pgmptr( )。](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/get-pgmptr?view=vs-2019)_pgmptr 全局变量包含与进程关联的可执行文件的完整路径。有关详细信息，请参阅[_pgmptr、_wpgmptr](https://docs.microsoft.com/en-us/cpp/c-runtime-library/pgmptr-wpgmptr?view=vs-2019)。
> 
> 如果 DLL 在两个进程中加载​​，则一个进程中的文件名可能与另一进程中的文件名不同。
> 
> 全局变量 _pgmptr 自动初始化为可执行文件的全路径，可用于检索可执行文件的全路径名。

# c++ - c++ 是clock_gettime() 溢出吗？

> ID：10572562
> 
> 赞同：0
> 
> 时间：2012-05-13T14:34:51.063
> 
> 标签：c++, time

当使用下面的示例代码时， tv_nsec 值，我认为是循环的，因为它*只是*一个`long`;

```
#include <iostream>
using namespace std;
#include <time.h>

int main(int argc, char *argv[]) {
  timespec time1, time2;
  timespec timens = {0};
  timens.tv_sec = 1;

  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &time1);
  nanosleep(&timens, (struct timespec *)NULL);
  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &time2);

  cout << time1.tv_nsec << " : " << time2.tv_nsec << endl;
  cout << (time2.tv_nsec-time1.tv_nsec) << endl;
  return 0;
}

$ ./microtime 
2754095 : 2766801
12706 
```

开始时间和结束时间的差是12706ns（12.7us），12us没睡1秒，我*有理由*确定！那么这里发生了什么，tv_nsec 循环了吗？假设`singed long`给出较小范围的正值（0 到 2147483647）而不是`unsigned long`（0 到 4294967295），2147483647 纳秒仍然刚刚超过 2 秒！

如果我将代码更改为以下内容，我仍然会得到看似无效的输出；

```
timens.tv_sec = 0;
timens.tv_nsec = 100000;

$ ./microtime
2743552 : 2754327
10775 
```

睡眠持续时间设置为 100,000ns，但根据该输出，程序已睡眠 10,000ns。我知道那是一小段时间，但我想在这里表明，无论是像 1 秒这样的长时间还是像 100us 这样的短时间，这里似乎没有准确性，或者介于这些值之间的任何地方。我做错了什么，我是否以某种方式错误地实现了这一点？为什么我不能在调用clock_gettime() 之间获得事件的实际持续时间？

非常感谢您的时间。

**更新**

@奥利；我可以使用以下代码测试您的建议，但它似乎不起作用：

```
int main(int argc, char *argv[]) {
  timespec time1, time2;
  timespec timens = {0};
  timens.tv_sec = 1;
  timens.tv_nsec = 0;

  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &time1);
  nanosleep(&timens, (struct timespec *)NULL);
  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &time2);

  cout <<time1.tv_sec<<"s:"<<time1.tv_nsec<<"ns : "<<
         time2.tv_sec<<"s:"<<time2.tv_nsec<<"ns"<<endl;
  cout <<(time2.tv_nsec-time1.tv_nsec)<<endl;
  return 0;
}

$ ./microtime
0s:2801478ns : 0s:2813732ns
12254 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:38:14.573

`tv_sec`在计算时间间隔时，您还需要考虑该字段。

**更新**

此外，`CLOCK_PROCESS_CPUTIME_ID`测量用于此进程的 CPU 时间。如果您使用 a 让步`nanosleep`，则此计时器不会增加。尝试例如`CLOCK_MONOTONIC`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T15:21:09.937

来自 nano_sleep 的手册：

> 未屏蔽的信号将导致 nanosleep() 提前终止睡眠，无论中断信号上的 SA_RESTART 值如何。

因此，您对 nanosleep() 的使用非常简单：
它应该看起来像这样（尽管这不是为了给您一个粗略的想法而测试的）。

```
timespec requestedSleep = {0};
requestedSleep.tv_sec = 1;

timespec start = {0};
start = /* current real time */;

while( nanosleep(&requestedSleep, NULL) == -1)
{
    timespec end.t = {0};
    end = /* current real time */;

    updateRequestedSleepTime(requestedSleep, start, end);
    start = end;
} 
```

# javascript - DOM附加文本节点的子节点不起作用

> ID：10572564
> 
> 赞同：0
> 
> 时间：2012-05-13T14:35:14.113
> 
> 标签：javascript, dom

我正在尝试将文本节点插入到文档中的标签中，但由于某种原因，它似乎不起作用（我没有收到任何消息，只是不起作用！）。下面是 HTML 和 JS。任何帮助将不胜感激！

**HTML（仅重要的部分）：**

```
<div>
    <h4 id="hompageNameDiv"></h4>
</div> 
```

**Java Script（同样，只是我们真正关心的部分）：**

```
window.onload = function () {
 var userPersonalName = "jonathan";
 var didSetPersonalname = true;
 if (didSetPersonalName == true) {
  var nametextNode = document.createTextNode(userPersonalName);
  var hompageUserPersonalName = document.getElementById("hompageNameDiv");
  hompageUserPersonalname.appendChild(nametextNode);

 }
} 
```

**再次，非常感谢任何帮助！:D**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:40:19.990

两个错别字：

*   `didSetPersonalname`对比`didSetPersonalName`
*   `hompageUserPersonalName`对比`hompageUserPersonalname`

JS 中的变量名区分大小写。此外，了解如何使用浏览器的调试工具 ;-) 如今，几乎所有浏览器都有它：

*   火狐（萤火虫）
*   IE9+（按 F12）
*   铬合金

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:42:33.673

您的变量名称不同......请注意 JavaScript 中的命名区分大小写。

# android - 我的代码中有什么错误

> ID：10572565
> 
> 赞同：-2
> 
> 时间：2012-05-13T14:35:26.563
> 
> 标签：android

我想连续有一个文本加图像按钮。如果我添加图像按钮，并以编程方式向右侧对齐，我仍然可以在手机中看到主题的背景颜色。

这是代码

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
<LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:padding="0dp">

     <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

     <RelativeLayout
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:orientation="horizontal" 
         android:background="#041A37">
<TextView
    android:id="@+id/list_item_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="left"
    android:ellipsize="end"
    android:text="All contact list" />

<ImageButton
    android:id="@+id/Contact_icon"
    android:layout_width="45dip"
    android:layout_height="50dip"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:src="@drawable/ic_launcher" />

<AutoCompleteTextView
    android:id="@+id/autoCompleteTextView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_toLeftOf="@+id/Contact_icon"
    android:ems="10"
    android:text="AutoCompleteTextView"
    android:visibility="invisible" >
    <requestFocus />
</AutoCompleteTextView>

    </RelativeLayout>

            <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:padding="0dp" />
    </LinearLayout>
</TabHost> 
```

![](../Images/11cfce8265e4ea03550537b02bb0693d.png)

这是图像的外观，我希望该按钮也能覆盖蓝色边框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:52:28.060

看起来按钮背景设置为透明（您可以在蓝色背景上看到机器人的手臂）。

尝试将 android:background 设置为某种颜色，看看会发生什么。

我看到的另一篇文章提到尝试`android:background="@null"`，所以也许这会有所帮助，而不是颜色变化。

# excel - Excel VB Vlookup

> ID：10572570
> 
> 赞同：1
> 
> 时间：2012-05-13T14:35:54.397
> 
> 标签：excel, vba

我正在尝试使用`VLOOKUP`，但使用列偏移量的变量。例如：`=VLOOKUP(RC[-1],'Sheet2'!C[-14],1,FALSE)`我想`-14`用命名变量替换 。
谁能在这里指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:00:18.947

您可以使用 OFFSET 工作表函数，例如：`=VLOOKUP(RC[-1],OFFSET(Sheet2!C,0,YourNamedVariable),1,FALSE)`

# ruby-on-rails - Facebook 调试器不会抓取我的网站

> ID：10572571
> 
> 赞同：0
> 
> 时间：2012-05-13T14:35:55.367
> 
> 标签：ruby-on-rails, facebook, ruby-on-rails-3, debugging, heroku

我正在创建网站[http://Meer.li](http://Meer.li)，当我通过 facebook 调试器运行它时 - [http://developers.facebook.com/tools/debug/og/object?q=meer.li](http://developers.facebook.com/tools/debug/og/object?q=meer.li) - 它不能找到我的元标签。

当我查看 facebook 抓取内容的来源时，它显示了我网站的精简版本，其中更改了文档类型并且没有元标记 - [http://developers.facebook.com/tools/debug/og /echo?q=http%3A%2F%2Fmeer.li%2F](http://developers.facebook.com/tools/debug/og/echo?q=http%3A%2F%2Fmeer.li%2F)。

我在这里做错了什么？

我正在运行 rails 3.2、ruby 1.9.3 并且整个事情都在带有 mongo 数据库的 Heroku 上运行。

**编辑**

看来我的应用程序中确实有正确的接受标头...如果我在不同的视图中执行此操作：

```
<%= request.headers["Accept"] %> 
```

我得到：

```
text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 
```

如果我们执行 curl -H 和正确的标题，为什么我们可以抓取整个站点？为什么 facebook 不抓取我的网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:44:27.767

在调试器中尝试您的 url，它说响应状态代码是 206，这意味着“部分内容”。

我试图卷曲 url，实际上我得到的响应是部分的，它不包括 html、head 和 body 标签（或它们的结束标签），并且看起来像包裹在 html 中的 jsonp 响应

```
$("#designs_content").append 
```

我不确定为什么会发生这种情况，也许您的服务器会根据它检查请求和响应的用户代理字符串？

* * *

# 编辑

我不确定这是否与 Heroku 有关，我从未与他们合作过。另外，我对rails一无所知，所以我无能为力。

wget 与此无关，它是您的 Web 服务器根据 http 请求的标头返回的响应。当您使用浏览器发出请求时，它会在请求中添加一些标头以帮助服务器找出一些事情。如果您在 chrome（Safari 等）、网络选项卡（它们都有）或使用网络嗅探器中打开 firebug 或开发人员工具，则可以查看发送的标头。

为了让您的生活更轻松，我检查了导致此问题的标题是什么...试试这个：

```
curl "http://meer.li/" 
```

您会看到响应是 jsonp 而不是整个 html 页面。现在试试这个：

```
curl -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" "http://meer.li/" 
```

您将获得页面的完整 html 版本。

由于 facebook 在废弃您的页面时不会发送“接受”标头，因此当您使用浏览器查看源代码时，响应不是您所看到的。

我不知道如何解决这个问题，因为这肯定与您的特定设置有关，但现在至少您知道问题所在。

# c# - c#在网页上选择下载链接

> ID：10572581
> 
> 赞同：0
> 
> 时间：2012-05-13T14:36:53.167
> 
> 标签：c#, forms, networking, browser, download

我正在尝试创建 ac# 程序，该程序将能够自动从麦考瑞大学的回声中心下载讲座。

示例链接：[http ://echo.mq.edu.au:8080/ess/portal/section/ANTH106_FHFYR_2012](http://echo.mq.edu.au:8080/ess/portal/section/ANTH106_FHFYR_2012)

问题是我不知道如何选择 mp3 或 m4v 的下载链接（如果可能的话）。我想出的唯一解决方案是下载源代码并尝试解析它的链接。

如果有人可以请告诉我如何从优秀的浏览器对象中选择下载链接:) 否则我将尝试使用源代码。

```
Broswer browser = new Broswer(address);

if (!System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
{
    MessageBox.Show("This machine needs to be connected to the internet to download your lectures.\n\nPlease connect to the internet and try again.", "Network Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
}

else
{
    //
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T14:47:21.377

您将需要抓取页面的 HTML 并查找链接。您可以尝试使用可用的 API 以编程方式读取 HTML 文档，例如[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)，或者手动解析它，使用正则表达式或任何您想要的。

获得文件的 URL 后，您可以使用它`HttpWebRequest`以编程方式下载文件。

```
 var request = WebRequest.Create(" http://echo.mq.edu.au:8080/ess/portal/section/file.pdf");
        var response = request.GetResponse();

        using (Stream responseStream = response.GetResponseStream())
        using (Stream fileStream = File.OpenWrite("c:\lectures\file.pdf")) 
        {
                var buffer = new byte[4096];
                int bytesRead = responseStream.Read(buffer, 0, buffer.Length);

                while (bytesRead > 0) 
                {
                    fileStream.Write(buffer, 0, bytesRead);
                    bytesRead = responseStream.Read(buffer, 0, buffer.Length);
                }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T14:48:23.107

为此，您可以使用`WebClient`. 首先使用 WebClient 方法下载页面 HTML`DownloadString`然后解析下载链接并使用`DowloadData`.

# gedit - gedit 可以通过单击在 Web 浏览器中打开链接吗？

> ID：10572588
> 
> 赞同：6
> 
> 时间：2012-05-13T14:39:17.380
> 
> 标签：gedit

我正在寻找一种键盘快捷键，以便使用 Web 浏览器快速打开文本文件中的链接。那里有技巧或插件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-26T15:20:37.380

我使用 Jean-Philippe 的[Open URI Context Menu](https://github.com/jpfleury/open-uri-context-menu)插件。它没有快捷键，但使用简单的右键单击打开链接。

刚刚升级到 Gedit 2.8，这个插件的第 2 版现在更快了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T15:00:58.150

您可以使用 Gedit 附带的外部工具插件来执行此操作。选择`Tools`> `Manage External Tools`。`+`通过单击左下角的小图标创建一个新工具并将其命名为“打开链接”（或任何您想要的）。在框中使用以下代码`Edit`（假设您使用的是 Firefox）：

```
#!/bin/sh
xargs -I '{}' firefox '{}' 
```

然后指定您的快捷键并确保`Input`设置为`Current word`. 如果光标位于单词（URL）中的任意位置，您现在可以通过选择`Tools`> `External Tools`>`Open Link`或使用键盘快捷键打开链接。

# iphone - UITextField 的委托方法

> ID：10572589
> 
> 赞同：-1
> 
> 时间：2012-05-13T14:39:31.090
> 
> 标签：iphone, uitextfield

我是 IOS 开发的新手。我有一个要求，我需要在点击 IPHone 模拟器键盘的返回按钮时保存在 UITextField 上输入的数字数据。请帮助我并告诉我使用哪种委托方法单击返回按钮保存在 TextField 中输入的数据。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:47:00.647

以下委托方法：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField 
```

当您单击返回按钮时文本字段退出时，这将被触发。然后，您可以对输入的文本做任何您想做的事情。

# node.js - 在猫鼬中获得最大值

> ID：10572592
> 
> 赞同：10
> 
> 时间：2012-05-13T14:40:15.887
> 
> 标签：node.js, mongodb, mongoose

如何在猫鼬查询中获得最大值。在 SQL 中很容易

```
SELECT MAX(LAST_MOD) FROM table1
Where field1=1 
```

我想在猫鼬（node.js）中等效于上述SQL代码

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-15T21:30:10.083

I couldn't get the other answers to work. Perhaps I'm using a newer version of Mongoose (mongoose@3.0.1).

This worked for me:

```
Table1.findOne()
    .where({field1: 1})
    .sort('-LAST_MOD')
    .exec(function(err, doc)
    {
        var max = doc.LAST_MOD;
        // ...
    }
); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-13T16:28:30.307

MongoDB 支持 max/min，但他们不建议在实际应用程序中使用它：

> min 和 max 主要用于支持 mongos（分片）进程。

[http://www.mongodb.org/display/DOCS/min+and+max+Query+Specifiers](http://www.mongodb.org/display/DOCS/min+and+max+Query+Specifiers)

你几乎可以得到相同的结果：

```
Model.findOne({ field1 : 1 }).sort(last_mod, 1).run( function(err, doc) {
     var max = doc.last_mod;
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-10-09T20:49:29.380

您可以使用它来返回集合中的一条记录（例如货物）：

```
Goods
   .find({})
   .select({"price"})
   .sort({"price" : -1})
   .limit(1)
   .exec(function(err, doc){
      let max_price = doc[0].price;
}); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-24T17:09:31.520

在提供以下答案之前，我对俄罗斯同事进行了投票，我将解释原因作为我的答案。

我的理解是，目标是从集合中取出任何模型的列表，按特定顺序对它们进行排序，然后只取出第一个条目。

所以首先我们从一个最小查询开始，如下所示：

```
const minQuery = Model.find({}).sort().limit(1); 
```

请注意，我正在使用`find()`而不是`findOne()`，我相信它的性能更高。

然后我们进行排序，在这种情况下，我将以同事的示例`Goods`作为模型，让我了解我们正在排序的内容：

```
const minQuery = Goods.find({}).sort({ price: 1 }).limit(1); 
```

这是关键部分，我只想取回第一个商品，因为第一个商品将是价格最低的商品，这就是您所看到的限制方法的来源：

```
const minQuery = Goods.find({}).sort({ price: 1 }).limit(1); 
```

为什么我`.limit(1);`像上面的同事一样添加这个？

因为我们总是希望最小化从 MongoDB 数据库返回的记录数量，所以使用 a`limit(1)`可以确保这种情况发生。同样，目标是提高性能，而不是用数千条记录轰炸我们的 Nodejs 服务器。

因此`limit(1)`确保 Mongo 只回传一条记录，而不是大量记录。但我不只是提供我在上面赞成的类似答案的另一种变体。

我将添加另一个步骤。因为我只关心这个商品的价格，因为它是从查询中返回的，我不关心商品名称或其他什么。

我要添加一份`.then()`声明，列出退回的商品清单，然后说把第一件商品从那里拿出来，然后给我它的价格，如下所示：

```
const minQuery = Goods.find({}).sort({ price: 1 }).limit(1).then(goods => goods[0].price); 
```

请记住我使用的术语。我会拿货物清单。因为我使用`limit(1)`了这并不意味着查询将仅使用一个模型自行解析。因为我使用了`find({})`助手，这意味着给我一个商品列表或商品数组。因此，即使我将该列表限制为`1`它并不意味着我们只会用一个模型本身来调用它。

它仍将是一系列模型，但其中只会有一个模型。

所以我们必须认识到这仍然是一个数组，因为我们使用了`find({})`但该数组中将有一个单一的商品。

我这样做的原因是为了按摩 API 响应。通过添加`.then()`意味着，如果我`.then()`在未来在其他任何地方添加任何后续内容，则通过获取此最小查询并添加 a `.then()`，它将以最低价格调用。

因此，如果我们将 a 添加`.then(minPrice => )`到查询中，它将仅使用 调用`minPrice`，它将仅使用我们关心的最低价格调用。

所以这`.then()`只是为了让我们自己终止这个查询。

所以现在反过来做，我们这样做：

```
const maxQuery = Goods.find({}).sort({ price: -1 }).limit(1).then(goods => goods[0].price); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-12-22T00:24:16.293

它工作得很好。

```
Model.findOne().sort({
        "field": -1
    }); 
```

# python - 在 pypi python setup.py 中指定可选依赖项

> ID：10572603
> 
> 赞同：43
> 
> 时间：2012-05-13T14:41:21.793
> 
> 标签：python, setup.py, pypi

如何在 python 中指定可选依赖项`setup.py`？

这是我为我的开源库指定可选依赖项的尝试，但它似乎并没有做太多。

[https://github.com/od-eon/django-cherrypy/blob/master/setup.py](https://github.com/od-eon/django-cherrypy/blob/master/setup.py)

特别`extra_requires`是在这个片段中：

```
setup(
    name='django-cherrypy',
    version='0.1',
    packages=packages,
    license='LICENSE',
    description='cherrypy, running under django',
    long_description=open('README.md').read(),
    author='Calvin Cheng',
    author_email='calvin@calvinx.com',
    install_requires=['cherrypy-wsgiserver'],
    extra_requires=['newrelic'],
    url='https://github.com/od-eon/django-cherrypy',
) 
```

建议？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-13T15:11:27.277

您的关键字不正确。它是`extras_require`，[它应该是一个字典。](https://stackoverflow.com/a/45043494/547270)

```
setup(
    name="django-cherrypy",
    ...
    extras_require = {
        'mysterious_feature_x':  ["newrelic"]
    }
) 
```

# rdf - 查询 dbpedia 以查找可能的上下文以消除单词的歧义

> ID：10572606
> 
> 赞同：5
> 
> 时间：2012-05-13T14:42:28.790
> 
> 标签：rdf, sparql, dbpedia, disambiguation

美好的一天，堆栈溢出，

我需要向用户建议一个单词的不同上下文，以便他有可能消除它的歧义。

例如：一个单词“ **less** ”可以是 Unix 程序、css 框架或其他一些东西。单词“ **apple** ”可以是水果、公司、河流、美国的一个州（大苹果）或一堆其他东西。

我希望你明白了。

我查看了互联网，到目前为止我只能提出[这个](http://dbpedia.org/snorql/?query=SELECT%20DISTINCT%20?concept%20?conceptLabel%20WHERE%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20?s%20rdfs%3alabel%20?label%20.%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20FILTER%20%28lang%28?label%29%20=%20%27en%27%29%20.%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20?label%20bif%3acontains%20%22apple%22%20.%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20?s%20dbpedia-owl%3awikiPageDisambiguates%20?concept%20.%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20?concept%20rdfs%3alabel%20?conceptLabel%20.%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20FILTER%20%28regex%28STR%28?conceptLabel%29,%20%22apple%22,%20%22i%22%29%29%20.%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20FILTER%20%28lang%28?conceptLabel%29%20=%20%27en%27%29%20%0D%0A%7D%0D%0A%0D%0A)查询。

但它仍然远非完美。它经常给出太多或太少的词，有时什么也没有（对于“jquery”）。

[http://www.visualdataweb.org/relfinder/relfinder.php](http://www.visualdataweb.org/relfinder/relfinder.php)似乎也使用了 dbpedia，但它的结果比我的要好得多。

我应该如何更改我的查询以获得更相关的结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T08:49:17.647

如果您正在寻找 Web API，请使用：[DBpedia Lookup](http://spotlight.dbpedia.org)或[DBpedia Spotlight](http://spotlight.dbpedia.org)。如果您需要在 SPARQL 中执行此操作，可以使用[DBpedia Lexicalization Dataset](http://dbpedia.org/Datasets/NLP)。

对于 DBpedia 查找，您可以提供一个字符串并检索带有与这些字符串匹配的标签的 DBpedia 资源： [lookup.dbpedia.org/api/search.asmx/KeywordSearch?QueryString=apple](http://lookup.dbpedia.org/api/search.asmx/KeywordSearch?QueryString=apple)

对于 DBpedia Spotlight，您可以选择提供更多上下文： [spotlight.dbpedia.org/rest/candidates ?text=apple+company+macintosh+computer](http://spotlight.dbpedia.org/rest/candidates?text=apple%20company%20macintosh%20computer)

对于词汇化数据集，尚无可用的 SPARQL 端点。您需要[下载它](http://lookup.dbpedia.org/api/search.asmx/KeywordSearch?QueryString=apple)，将其加载到您自己的 RDF 存储中并运行如下查询：

```
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
SELECT ?resource ?score WHERE {
GRAPH ?g {
  ?resource skos:altLabel ?label.
}
  ?g <http://dbpedia.org/spotlight/score> ?score.
  FILTER (REGEX(?label, "apple", "i"))
} 
```

# linux - 事件按钮作为模块还是作为用户程序？

> ID：10572608
> 
> 赞同：0
> 
> 时间：2012-05-13T14:42:32.043
> 
> 标签：linux, module, embedded, daemon

我正在编写一个按钮以在基于 linux 的板上启动软件。基于 Linux 的嵌入式板上的按钮。GPIO 不适用于那个 Linux 内核，所以我使用了事件接口。该按钮基本上是在监听按钮按下以激活所有硬件并在按下两次时停止硬件。我想知道是作为内核模块还是作为用户程序编写？还是作为一个恶魔？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T21:10:32.930

如果可以在用户空间（即守护程序）中执行此操作，您应该在那里执行此操作。

在这种情况下，可能需要两者。您需要以某种方式访问​​该按钮，这取决于硬件的外观。然后，您需要响应事件并基于该事件执行操作。

遵循“政策不属于内核”的口头禅，这意味着虽然您可以（并且可能需要）从内核处理按钮本身，但您需要从用户空间启动应用程序部分。内核不应该负责启动新的用户空间进程。相反，它应该将偶数传递给用户空间，例如通过 netlink 套接字。然后，您需要一个用户空间守护程序，它侦听 netlink 套接字并启动应用程序以响应某些事件。

# c++ - 使用单例时内存泄漏

> ID：10572610
> 
> 赞同：4
> 
> 时间：2012-05-13T14:43:01.803
> 
> 标签：c++, memory-leaks, valgrind

我有一个类，我在其中实现了singelton 设计模式。我知道有些人认为这不是一个好主意，但它很有帮助，

无论如何 - 我有内存泄漏和 vlagrind 指向我这些行：

```
_singleton = new Manager(); //Manager::instance() (Manager.cpp:18) 
```

和

```
Manager::Manager() : _file(new ofstream), _tasks(new map<int, Task *>()),
        _idState(new map<int, int>()), _closing(false), _pending(false),
        _lock(new pthread_mutex_t), _endLock(new pthread_mutex_t),  _cond(new pthread_cond_t),
        _flushCond(new map<int, pthread_cond_t *>()), _attr(new pthread_attr_t) {
//The last line is line 25 in Manager::Manager 
```

现在在 Manager 的析构函数中，我无法显式删除它，因为它会创建一个愚蠢的循环（因为在删除 _singleton 时会调用析构函数，从而导致无限循环）。我该如何摆脱这种泄漏？谢谢！

Ps 这里是 Valgrind 的输出：

```
==17823== 512 bytes in 1 blocks are definitely lost in loss record 2 of 2
==17823==    at 0x4C27297: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==17823==    by 0x40151E: Manager::Manager() (Manager.cpp:25)
==17823==    by 0x4014DB: Manager::instance() (Manager.cpp:18)
==17823==    by 0x406475: initdevice(char*) (outputdevice.cpp:66)
==17823==    by 0x4061D5: main (driver.cpp:21)
==17823== 
==17823== LEAK SUMMARY:
==17823==    definitely lost: 512 bytes in 1 blocks
=    =17823==    indirectly lost: 0 bytes in 0 blocks
==17823==      possibly lost: 288 bytes in 1 blocks
==17823==    still reachable: 0 bytes in 0 blocks
==17823==         suppressed: 0 bytes in 0 blocks 
```

另外：这是我创建管理器的代码：

```
Manager.h:
class Manager {
public:
    ~Manager();
    static Manager * instance();
private:
    Manager();
    static Manager * _singleton;
}; 
```

和实施：

```
Manager.cpp:
Manager * Manager::_singleton = 0;

Manager * Manager::instance() {
    if (!_singleton)
        _singleton = new Manager();
    return _singleton;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:50:21.507

在 C++ 中实现单例的一种常见方法是使实例成为`std::unique_ptr<T>`实例 getter 内的函数静态，而不是类静态变量。这确保了在程序完成时调用析构函数，并允许您创建一个实例，该实例可以通过多态访问，例如通过指向抽象基类的指针。

[Scott Meyers 在他的“More Effective C++”一书中](http://www.aristeia.com/books.html)对这个主题进行了很好的讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T14:46:46.493

创建`Manager`一个静态对象，它的构造函数和析构函数会自动被调用。或者，如果您必须使用 operator new 分配它，请将其放入智能指针（如果可以，则为 unique_ptr，否则为 auto_ptr），以便在指针存在时将其销毁。

# php - PHP + 将多行从 .csv 保存到 mysql

> ID：10572615
> 
> 赞同：0
> 
> 时间：2012-05-13T14:43:41.130
> 
> 标签：php, mysql, csv

我正在尝试上传`.csv`文件，然后将每一行保存到`mysql`数据库中。因此，对于文件中的每一行`.csv`，我想在我的`mysql`数据库中创建一行。请原谅我的英语，但我希望你明白我的意思。

到目前为止，我能够从第一行获取数据：

```
$path   = $targetPath;
$row    = 1;

if (($handle = fopen($path, "r")) !== FALSE) {

    while (($data = fgetcsv($handle, 1000, ";")) !== FALSE) {

        $row++;
        $dataEntries[] = $data ;

    }

    fclose($handle);

} else{

    echo("There has been an error parsing ".$csvname);

}

//Everything seems to be okay, we can save it
foreach($dataEntries as $line){

    $oName  = $line[0];
    $oUrl   = $line[1];
    $oType  = $line[2];
    $oDescr = $line[3];

    //If there is just one row in the csv file, Output: "string"
    //If there are more rows, than the output is "stringstring1string2"
    echo($oName);

} 
```

**更新**

只是为了让每个人都知道：@Greg P 的解决方案效果很好，但我必须将 LOCAL 添加到 infile 命令，以便我可以访问上传到我的服务器的 csv 文件：

```
LOAD DATA LOCAL INFILE '$targetPath' INTO TABLE tableName FIELDS TERMINATED BY ';' (name,url,type,descr) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-13T14:48:53.113

为什么不使用 LOAD DATA INFILE，如下所示：

```
LOAD DATA INFILE 'filename.csv' 
INTO TABLE filenames
FIELDS TERMINATED BY ',' 
(Name, Url, Type, Descr) 
```

# android - 通过没有“动作”属性的表单登录过程？

> ID：10572616
> 
> 赞同：1
> 
> 时间：2012-05-13T14:44:05.240
> 
> 标签：android, html, forms, login, action

我的问题是我有一个 Android Class 项目，我需要开发一个简单的 Android 应用程序来连接到我大学的学生信息系统。

有它的链接[https://my.fatih.edu.tr/](https://my.fatih.edu.tr/)

我要做的是在这里登录，并使用正则表达式显示课程信息、考试日期等。android 部分并不难。在我从浏览器手动登录后，我已经开始使用源代码创建这些表达式和我的视图。

索引处有一个登录页面，允许通过那里登录。

当我查看源代码时，我看到一个带有属性名称和方法的表单。没有动作属性。我搜索了一个脚本文件，但是找不到。

我不明白这里的过程。它是如何让我登录的？没有动作，没有脚本文件。提交时也没有 onclick 属性。

也许它不可能通过链接，但可能有其他方式。我在网上搜索了很多。我看到很多例子，但大多数形式都有属性“动作”。其他人使用onclick。

任何想法都会很棒。此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T16:08:27.923

它使用“post”方法写在php的同一页面上，这意味着你看不到它。为了让您制作应用程序，您需要查看完整的代码，唯一的方法是联系制作页面的人...... =）

# javascript - 如何使用两个具有相同名称的 jQuery 插件？

> ID：10572618
> 
> 赞同：2
> 
> 时间：2012-05-13T14:44:08.837
> 
> 标签：javascript, jquery, jquery-plugins, requirejs

在一个大型网络项目中，我想使用一个 jQuery 插件`editable`，它的名称与现有的相同，但具有不同的行为。
有一种干净的方法来重命名插件吗？也许使用require.js？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-13T14:47:29.413

您可以像这样重命名插件：

```
<script src="jquery.js"></script>
<script src="firstplugin.js"></script>
<script>
    $.fn.editableFirst = $.fn.editable;
</script>
<script src="secondplugin.js"></script> 
```

`editableFirst`应该是对你更有意义的东西。

# oracle - 解释计划和执行计划的区别

> ID：10572619
> 
> 赞同：14
> 
> 时间：2012-05-13T14:44:11.520
> 
> 标签：oracle, sql-execution-plan

谁能解释一下执行计划和解释计划之间的区别。

当我执行

```
 set autotrace traceonly;
 select * from emp where empno=7369;

Execution Plan
----------------------------------------------------------
  0       SELECT STATEMENT Optimizer Mode=ALL_ROWS (Cost=1 Card=1 Bytes=38)
  1    0    TABLE ACCESS BY INDEX ROWID SCOTT.EMP (Cost=1 Card=1 Bytes=38)
  2    1      INDEX UNIQUE SCAN SCOTT.PK_EMP (Cost=0 Card=1)

 Explain Plan

 explain plan for select * from emp where empno=7369;
 select * from table(dbms_xplan.display);

Plan hash value: 2949544139

--------------------------------------------------------------------------------------
| Id  | Operation                   | Name   | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |        |     1 |    38 |     1   (0)| 00:00:01 |
|   1 |  TABLE ACCESS BY INDEX ROWID| EMP    |     1 |    38 |     1   (0)| 00:00:01 |
|*  2 |   INDEX UNIQUE SCAN         | PK_EMP |     1 |       |     0   (0)| 00:00:01 |
-------------------------------------------------------------------------------------- 
```

我得到相同的输出，那么两者之间有什么区别。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-13T15:21:23.143

解释计划是优化器认为在您运行时会发生的事情，而执行计划实际上是在您运行查询时发生的。

请参阅此处的链接。

[http://tkyte.blogspot.co.uk/2007/04/when-explanation-doesn-sound-quite.html](http://tkyte.blogspot.co.uk/2007/04/when-explanation-doesn-sound-quite.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-13T14:53:00.257

`explain plan`是用于显示执行计划的语句。

您展示的两个示例只是格式不同，仅此而已。

您没有告诉我们您是如何生成这些输出的，也没有告诉我们您使用的是哪个工具。

但如果没记错的话，其中一个是`autotrace`内部 SQL*Plus 的输出，另一个是使用该`dbms_xplan`包的程序时的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-17T12:38:14.600

> EXPLAIN PLAN 语句用于显示优化器为 SQL 语句选择的计划操作。我要澄清的第一件事是，当您有 EXPLAIN PLAN 输出时，您就有了实际执行 SQL 语句时应该使用的估计执行计划

> SQL 语句的实际执行计划是在执行语句时产生的

资料来源：Pro Oracle SQL

[http://rsmt.it.fmi.uni-sofia.bg/OracleDB/Pro%20Oracle%20SQL,%202nd%20Edition.pdf](http://rsmt.it.fmi.uni-sofia.bg/OracleDB/Pro%20Oracle%20SQL,%202nd%20Edition.pdf)

根据当前情况（例如可用内存、统计数据），差异可能很大。

# python - Python中的可变字符串

> ID：10572624
> 
> 赞同：46
> 
> 时间：2012-05-13T14:45:10.800
> 
> 标签：python, string, mutable

你知道提供可变字符串的 Python 库吗？谷歌返回的结果出奇地少。我发现的唯一可用库是[http://code.google.com/p/gapbuffer/](http://code.google.com/p/gapbuffer/)，它是用 C 语言编写的，但我更希望它用纯 Python 编写。

编辑：感谢您的回复，但我想要一个*高效*的图书馆。也就是说，`''.join(list)`可能会起作用，但我希望得到更优化的东西。此外，它必须支持常规字符串的常用功能，例如 regex 和 unicode。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-13T15:01:07.877

在 Python 中，可变序列类型是**字节数组**，请参阅[此链接](http://docs.python.org/library/stdtypes.html#typesseq-mutable)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-10-03T02:14:49.260

这将允许您有效地更改字符串中的字符。虽然你不能改变字符串的长度。

```
>>> import ctypes

>>> a = 'abcdefghijklmn'
>>> mutable = ctypes.create_string_buffer(a)
>>> mutable[5:10] = ''.join( reversed(list(mutable[5:10].upper())) )
>>> a = mutable.value
>>> print `a, type(a)`
('abcdeJIHGFklmn', <type 'str'>) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-05-13T15:06:55.190

```
class MutableString(object):
    def __init__(self, data):
        self.data = list(data)
    def __repr__(self):
        return "".join(self.data)
    def __setitem__(self, index, value):
        self.data[index] = value
    def __getitem__(self, index):
        if type(index) == slice:
            return "".join(self.data[index])
        return self.data[index]
    def __delitem__(self, index):
        del self.data[index]
    def __add__(self, other):
        self.data.extend(list(other))
    def __len__(self):
        return len(self.data) 
```

... 等等等等。

您还可以继承 StringIO、缓冲区或字节数组。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-27T00:25:54.380

简单的子类化`list`（Python 中可变性的主要例子）怎么样？

```
class CharList(list):

    def __init__(self, s):
        list.__init__(self, s)

    @property
    def list(self):
        return list(self)

    @property
    def string(self):
        return "".join(self)

    def __setitem__(self, key, value):
        if isinstance(key, int) and len(value) != 1:
            cls = type(self).__name__
            raise ValueError("attempt to assign sequence of size {} to {} item of size 1".format(len(value), cls))
        super(CharList, self).__setitem__(key, value)

    def __str__(self):
        return self.string

    def __repr__(self):
        cls = type(self).__name__
        return "{}(\'{}\')".format(cls, self.string) 
```

如果您想打印它或主动要求字符串表示，这只会将列表连接回字符串。变异和扩展是微不足道的，用户已经知道如何去做，因为它只是一个列表。

示例用法：

```
s = "te_st"
c = CharList(s)
c[1:3] = "oa"
c += "er"
print c # prints "toaster"
print c.list # prints ['t', 'o', 'a', 's', 't', 'e', 'r'] 
```

以下是固定的，请参阅下面的更新。

> 有一个（可解决的）警告：（还）没有检查每个元素确实是一个字符。它至少会失败打印除字符串之外的所有内容。但是，这些可以加入并可能导致如下奇怪的情况：[参见下面的代码示例]

使用自定义`__setitem__`，将长度为 != 1 的字符串分配给 CharList 项将引发`ValueError`. 其他所有内容仍然可以自由分配，但`TypeError: sequence item n: expected string, X found`由于`string.join()`操作原因，打印时会引发 a。如果这还不够好，可以轻松添加进一步的检查（可能也可以`__setslice__`或通过将基类切换为`collections.Sequence`（性能可能不同？！），参见[此处](https://stackoverflow.com/a/32772786/655404)）

```
s = "test"
c = CharList(s)
c[1] = "oa"
# with custom __setitem__ a ValueError is raised here!
# without custom __setitem__, we could go on:
c += "er"
print c # prints "toaster"
# this looks right until here, but:
print c.list # prints ['t', 'oa', 's', 't', 'e', 'r'] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-08-10T00:11:16.683

pypi 中的[FIFOStr](https://pypi.org/project/FIFOStr)包支持模式匹配和可变字符串。这可能是也可能不是真正想要的，但它是作为串行端口模式解析器的一部分创建的（字符一次从左侧或右侧添加一个字符 - 请参阅文档）。它源自双端队列。

```
from fifostr import FIFOStr

myString = FIFOStr("this is a test")
myString.head(4) == "this"  #true
myString[2] = 'u'
myString.head(4) == "thus"  #true 
```

（完全披露我是 FIFOstr 的作者）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-21T10:55:21.750

Python 中高效的可变字符串是*数组*。`array.array`使用标准库的 unicode 字符串的 PY3 示例：

```
>>> ua = array.array('u', 'teststring12')
>>> ua[-2:] = array.array('u', '345')
>>> ua
array('u', 'teststring345')
>>> re.search('string.*', ua.tounicode()).group()
'string345' 
```

`bytearray`是为字节预定义的，并且在转换和兼容性方面更加自动化。

您还可以考虑`memoryview`/ `buffer`、`numpy`数组`mmap`和`multiprocessing.shared_memory` 某些情况。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2020-10-20T07:27:37.527

就这样做
`string = "big"`
`string = list(string)`
`string[0] = string[0].upper()`
`string = "".join(string)`
`print(string)`

'''输出'''
  > 大

# sql - 将独立的 YAF 集成到 DNN 中

> ID：10572625
> 
> 赞同：0
> 
> 时间：2012-05-13T14:45:11.287
> 
> 标签：sql, dotnetnuke, yaf

我有一个活跃的 YAF 论坛，论坛成员要求将其集成到 DNN 中。以前做过这件事的人（以某种方式将现有的独立 YAF 集成到 DotNetNuke 中，这样就不会丢失数据）可以帮助我吗？如果有人能告诉我确切的步骤，我将非常感激。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T04:43:17.803

YAF 有一个模块作为 dnn 的模块 (http://dnnafnet.codeplex.com/)

然而，将现有的 YAF 迁移到 DNN 可能并不那么容易。

YAF 有一个大规模用户导出导入，我会将它用于您的基本 DNN 安装（查看商店中的导入模块之一）

之后是繁重的工作 - 您可以尝试在新的 dnn 安装上安装 YAF 模块，看看您是否可以简单地导入信息或连接到 YAF 的当前数据库方案。

# xml - 竖线 (|) Unicode 替换

> ID：10572627
> 
> 赞同：4
> 
> 时间：2012-05-13T14:45:14.113
> 
> 标签：xml, unicode, csv, separator

我们在其中一个模块中使用竖线`|`( `&#124;`) 字符作为字段分隔符。所以用户不应该在标题中使用这个字符。

如果他们确实使用它，我想用类似的字符替换它。

**有 Unicode 替代品吗？**我发现的唯一一个看起来与之相似的字符是竖线`¦`（`&#166;`）。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-13T15:19:13.927

我不明白你真正需要什么。您是否需要将分隔符序列更改为保证在数据集中不存在的东西？

如果是这样，那么这就是 Unicode 的 66 个“非字符”代码点专门设计的用途。您可以将它们用作内部哨兵，知道它们不会出现在有效数据中。

如果您只是在寻找视觉上相似的东西，那将是非常不同的。我不建议这样做，因为有很多易混淆的东西。这里只是其中的几个：

```
U+0007C ‭ |  GC=Sm SC=Common       VERTICAL LINE
U+000A6 ‭ ¦  GC=So SC=Common       BROKEN BAR
U+002C8 ‭ ˈ  GC=Lm SC=Common       MODIFIER LETTER VERTICAL LINE
U+002CC ‭ ˌ  GC=Lm SC=Common       MODIFIER LETTER LOW VERTICAL LINE
U+02016 ‭ ‖  GC=Po SC=Common       DOUBLE VERTICAL LINE
U+023D0 ‭ ⏐  GC=So SC=Common       VERTICAL LINE EXTENSION
U+02758 ‭ ❘  GC=So SC=Common       LIGHT VERTICAL BAR
U+02759 ‭ ❙  GC=So SC=Common       MEDIUM VERTICAL BAR
U+0275A ‭ ❚  GC=So SC=Common       HEAVY VERTICAL BAR
U+02AF4 ‭ ⫴  GC=Sm SC=Common       TRIPLE VERTICAL BAR BINARY RELATION
U+02AF5 ‭ ⫵  GC=Sm SC=Common       TRIPLE VERTICAL BAR WITH HORIZONTAL STROKE
U+02AFC ‭ ⫼  GC=Sm SC=Common       LARGE TRIPLE VERTICAL BAR OPERATOR
U+02AFE ‭ ⫾  GC=Sm SC=Common       WHITE VERTICAL BAR
U+02AFF ‭ ⫿  GC=Sm SC=Common       N-ARY WHITE VERTICAL BAR
U+0FF5C ‭ ｜ GC=Sm SC=Common       FULLWIDTH VERTICAL LINE
U+0FFE4 ‭ ￤ GC=So SC=Common       FULLWIDTH BROKEN BAR 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-13T14:49:27.637

Unicode 中有一个[“浅色竖线” ：❘，代码点 U+2758](http://www.fileformat.info/info/unicode/char/2758/index.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-09T13:11:31.267

[http://www.fileformat.info/info/unicode/char/007c/index.htm](http://www.fileformat.info/info/unicode/char/007c/index.htm)

也可以看看：

*   拉丁字母牙科点击 U+01C0
*   希伯来语标点符号 paseq U+05C0
*   划分 U+2223
*   浅色竖条 U+2758

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-03T17:27:00.560

# performance - 用于收集网站性能指标、页面浏览量、平均延迟的分析工具？

> ID：10572629
> 
> 赞同：0
> 
> 时间：2012-05-13T14:45:39.853
> 
> 标签：performance, google-analytics, web-analytics, website-metrics

我们正在寻找收集和绘制网站指标的分析工具...

**我们需要的...**

*   实时性能指标
*   页面点击量
*   平均响应时间、页面浏览延迟等
*   在 Intranet 中工作，用于性能和负载测试场景

**我们不需要什么**

*   跟踪用户行为等（我们正在为这些东西寻找单独的工具）

我们最关心的是收集站点性能指标以进行优化和调整。该工具还必须在 Intranet 上运行以进行负载测试场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T09:06:08.360

我没有具体的经验，但[New Relic](http://newrelic.com/)可能是你的人

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T22:56:24.153

您可以从 Web 服务器的日志中获取大部分内容。但我不知道有什么工具可以为你阅读和做完整的分析。

我找到了这个，也许它可以工作。

[http://www.weblogexpert.com/lite.htm](http://www.weblogexpert.com/lite.htm)

# python - 艰难地学习 Python 练习 5 EC4

> ID：10572635
> 
> 赞同：2
> 
> 时间：2012-05-13T14:46:41.283
> 
> 标签：python

我正在尝试编写一些将英寸和磅转换为厘米和公斤的变量。我正在尝试用 Python 计算数学并遇到了一些麻烦。

经过一段时间的努力，我设法在 Python 中做到了这一点：

```
inches = 19
centimeters = inches * 2.54
print "%r inches equals %r centimeters." % (inches, centimeters)

pounds = 180
kilos = pounds /2.2
print "%r pounds equals %r kilos." % (pounds, kilos) 
```

虽然英寸到厘米的计算效果很好，但我得到的磅到公斤的结果不正确（例如，wolframalpha 说它应该是 81.65 公斤。）

**我做错了什么，我该如何解决这个问题以获得正确的结果？**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T14:49:28.107

> 1 磅 = 0.45359237 公斤

所以你的代码必须是：

```
pounds = 180
kilos = pounds * 0.45359237
print "%r pounds equals %r kilos." % (pounds, kilos) 
```

你会得到正确的结果。

# java - 迭代模式

> ID：10572638
> 
> 赞同：4
> 
> 时间：2012-05-13T14:46:50.627
> 
> 标签：java

假设您正在处理按以下格式组织的数据：

```
[123]="some string" [234]=999999999 [345]="some other string" 
```

在 Java 中，通过 KV 组合拆分每个最简单的方法是什么，其中 K 是标签（包含在 中`[ ]`）。

是否有您知道的 Utils（Apache 或其他？）方法可以让您定义如上所示的结构以帮助迭代它，而不必手动计算和读取过去和之间的数据 `[ ]`？

我们知道什么？

*   每个元素都有一个标签
*   每个标签将被包围`[ ]`
*   标签和分配给标签的值将由`=`
*   价值将在那里。不允许有空值。
*   值可能会或可能不会被引号包围

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T15:06:35.550

使用`Pattern`带有正则表达式`"\\[(.*?)\\]=(.*?)( (?=\\[)|$)"`的一次抓取对。
唯一的限制是假设下一个术语以空格开头，后跟 a `[`，因此该字符序列可能不会出现在值中。

此代码演示：

```
public static void main(String[] args) {
    String input = "[123]=\"some string\" [234]=999999999 [345]=\"some other string\"";
    Pattern pattern = Pattern.compile("\\[(.*?)\\]=(.*?)( (?=\\[)|$)");
    Matcher matcher = pattern.matcher(input);
    while (matcher.find()) {
        String k = matcher.group(1);
        String v = matcher.group(2);
        System.out.println(k + "-->" + v);
    }
} 
```

输出：

```
123-->"some string"
234-->999999999
345-->"some other string" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:57:05.993

听起来像是一份工作[`java.util.Scanner`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T14:58:47.363

你可以`java.util.Properties`用来读取数据。毕竟，他们只是一`key=value`对。

例如：

```
String input="[123]=\"some string\" [234]=999999999 [345]=\"some other string\"";
input = input.replaceAll("\\s+\\[", System.getProperty("line.separator") + "[");

Reader in = new StringReader(input);
Properties props = new Properties();
props.load(in);
in.close(); 
```

要提取数据，请使用以下命令：

```
private static String getValue(String key, Properties props) {
    return props.getProperty("[" + key + "]");
} 
```

结果如预期：

```
System.out.println(getValue("123", props));
> "some string"

System.out.println(getValue("234", props));
> 999999999

System.out.println(getValue("345", props));
> "some other string" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T14:58:37.833

我会使用 string.split(" ") 来获取所有键值对，然后使用 string.replaceFirst() 在每个项目中解析两次（一次获取键，一次获取值）。

我认为这不是最有效的方法，但在打字方面很容易。

# c++ - PNG块读取器，无效长度

> ID：10572640
> 
> 赞同：0
> 
> 时间：2012-05-13T14:47:16.097
> 
> 标签：c++, png, corrupt

我目前正在编写自己的 png 阅读器，我正在阅读单个块，它似乎正确读取了前 2 个块，但是当涉及到 IDAT 块时，它的大小很可笑。

```
bool LoadImage(char * path, Image * target)
{
std::ifstream file;

file.open("Lenna.png", std::ios::in | std::ios::binary);
if(!file.is_open())
    return -false;

std::cout << "Opened file : Lenna.png" <<  std::endl;
struct stat filestatus;
if (stat("Lenna.png", &filestatus) != 0)
    return false;

unsigned int fileSize = filestatus.st_size;
unsigned int bytesRead = 8;
file.seekg(8, std::ios::beg);

while(bytesRead < fileSize)
{
    //Read the length, type, then the data and at last the crc(Cyclic redundancy crap, whatever that may be)
    char length [4];
    file.read(length, 4);
    //Reverse the 4 bytes due to network type writing.
    unsigned int dataLength = (length[0] << 24) | (length[1] << 16) | (length[2] << 8) | length[3];
    char type [4];
    file.read(type, 4);
    char * data = new char[dataLength];
    file.read(data, dataLength);
    char crc [4];
    file.read(crc, 4);
    bytesRead += 12 + dataLength;
}

return true;
} 
```

使用调试器，它将前 2 个块读取为

类型：IDHR
长度：13 字节

类型：sRGB
长度：1 字节

类型：IDAT
长度：4294967201 字节

那是大约 2.3 gb 的数据，而 png 是 462kb。任何想法为什么会出错？

来源图片：http: [//i.cubeupload.com/sCHXFV.png](http://i.cubeupload.com/sCHXFV.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:19:03.923

问题在于字节顺序和左移的反转。移位运算结果的符号与被移位值的符号相同。因此，转移有符号的`char`行为会与您的预期不同。

要修复，请将`length`数组的类型更改为`unsigned char`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:27:22.527

您需要声明长度`unsigned char`，因此 byte 值 >= 128 的符号扩展不会*byte*。这就是您最终得到 0xffffffa1 的方式，您对负值进行了或运算。

# java - Java 接口中的可选方法

> ID：10572643
> 
> 赞同：127
> 
> 时间：2012-05-13T14:47:36.030
> 
> 标签：java, methods, interface

据我了解，如果您在 java 中实现接口，则该接口中指定的方法必须由实现所述接口的子类使用。

我注意到在某些接口（例如 Collection 接口）中，有一些方法被注释为可选，但这究竟是什么意思？它让我有点吃惊，因为我认为接口中指定的所有方法都是必需的？

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2012-05-13T22:13:54.087

这里的答案似乎有很多混乱。

Java 语言要求接口中的每个方法都由该接口的每个实现来实现。时期。**这条规定没有例外。**说“收藏是一个例外”意味着对这里真正发生的事情的理解非常模糊。

重要的是要意识到有两个级别的符合接口：

1.  Java 语言可以检查什么。这几乎可以归结为：每种方法都有*一些*实现吗？

2.  实际履行合同。也就是说，实现是否按照接口中的文档所说的去做？

    编写良好的接口将包括文档，准确解释实现的预期。您的编译器无法为您检查。您需要阅读文档，并按照他们所说的去做。如果您不按照合同的规定执行，那么就*编译器*而言，您将拥有接口的实现，但这将是有缺陷/无效的实现。

在设计集合 API 时，Joshua Bloch 决定不再使用非常细粒度的接口来区分集合的不同变体（例如：可读、可写、随机访问等），而是只使用非常粗略的接口集，主要是 `Collection`, `List`,`Set`和`Map`, 然后将某些操作记录为“可选”。这是为了避免细粒度接口导致的组合爆炸。来自[Java 集合 API 设计常见问题解答](http://docs.oracle.com/javase/8/docs/technotes/guides/collections/designfaq.html#a1)：

> 为了详细说明问题，假设您想将可修改性的概念添加到层次结构中。您需要四个新接口：ModifiableCollection、ModifiableSet、ModifiableList 和 ModifiableMap。以前简单的等级制度现在变成了杂乱无章的等级制度。此外，您需要一个新的 Iterator 接口来与不可修改的集合一起使用，该接口不包含删除操作。现在你可以取消 UnsupportedOperationException 了吗？不幸的是没有。
> 
> 考虑数组。它们实现了大多数 List 操作，但没有删除和添加。它们是“固定大小”的列表。如果你想在层次结构中捕捉这个概念，你必须添加两个新接口：VariableSizeList 和 VariableSizeMap。您不必添加 VariableSizeCollection 和 VariableSizeSet，因为它们与 ModifiableCollection 和 ModifiableSet 相同，但为了保持一致性，您可以选择添加它们。此外，您需要一种新的不支持添加和删除操作的 ListIterator 来配合不可修改的 List。现在我们有多达十个或十二个接口，加上两个新的迭代器接口，而不是我们原来的四个。我们完了吗？不。
> 
> 考虑日志（例如可恢复数据对象的错误日志、审计日志和日志）。它们是自然的仅追加序列，支持除删除和设置（替换）之外的所有列表操作。它们需要一个新的核心接口和一个新的迭代器。
> 
> 与不可修改的集合相比，不可变集合又如何呢？（即，客户无法更改的集合，并且永远不会因任何其他原因而更改）。许多人认为这是最重要的区别，因为它允许多个线程同时访问一个集合而无需同步。将此支持添加到类型层次结构需要另外四个接口。
> 
> 现在我们有多达 20 个左右的接口和 5 个迭代器，而且几乎可以肯定，在实践中仍然会出现不完全适合任何接口的集合。例如， Map 返回的集合视图是自然的仅删除集合。此外，有些集合会根据它们的值拒绝某些元素，所以我们仍然没有消除运行时异常。
> 
> 当一切都说完了，我们觉得这是一个合理的工程妥协，通过提供一组非常小的可以引发运行时异常的核心接口来回避整个问题。

当 Collections API 中的方法被记录为“可选操作”时，这并不意味着您可以将方法实现留在实现中，也不意味着您可以使用空的方法主体（一方面，许多他们需要返回一个结果）。相反，这意味着一个有效的实现选择（仍然符合合同）是抛出一个[`UnsupportedOperationException`](http://docs.oracle.com/javase/7/docs/api/java/lang/UnsupportedOperationException.html).

请注意，因为`UnsupportedOperationException`is a`RuntimeException`您可以从任何方法实现中抛出它，就编译器而言。例如，您可以从`Collection.size()`. 但是，这样的实现会违反合同，因为文档`Collection.size()`没有说这是允许的。

另外：Java 的 Collections API 使用的方法有些争议（不过，现在可能比首次引入时少）。在一个完美的世界里，接口*不会*有可选的操作，而是使用细粒度的接口。问题是 Java 既不支持推断的结构类型也不支持交集类型，这就是为什么尝试以“正确的方式”做事最终在集合的情况下变得极其笨拙。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-05-13T14:51:32.393

为了编译接口的实现（非抽象）类 - 必须实现所有方法。

**但是**，如果我们认为一个方法的实现是一个简单的异常抛出作为“未实现”（如接口中的某些方法`Collection`），那么`Collection`接口在这种情况下是异常，而不是常规情况。*通常*，实现类应该（并且将）实现所有方法。

集合中的“可选”意味着实现类不必“实现”（根据上面的术语）它，它只会抛出 [`NotSupportedException`](http://docs.oracle.com/javaee/6/api/javax/transaction/NotSupportedException.html)）。

一个很好的例子 -`add()`不可变集合的方法 - 具体将只实现一个除了抛出之外什么都不做的方法`NotSupportedException`

如果这样`Collection`做是为了防止混乱的继承树，那会让程序员很痛苦——但在*大多数*情况下，不建议使用这种范例，如果可能的话应该避免使用。

* * *

**更新：**

从 java 8 开始，引入了[默认方法](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)。

这意味着，一个接口可以定义一个方法——包括它的实现。
添加此功能是为了允许向接口添加功能，同时仍支持不需要新功能的代码片段的向后兼容性。

请注意，该方法仍然由声明它的所有类实现，但使用接口的定义。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-05-13T14:57:32.400

Java 中的接口只是声明实现类的协定。该接口中的所有方法都**必须**实现，但实现类可以自由地将它们保留为未实现，即空白。作为一个人为的例子，

```
interface Foo {
  void doSomething();
  void doSomethingElse();
}

class MyClass implements Foo {
  public void doSomething() {
     /* All of my code goes here */
  }

  public void doSomethingElse() {
    // I leave this unimplemented
  }
} 
```

现在我没有`doSomethingElse()`实现，让我的子类可以自由实现。那是可选的。

```
class SubClass extends MyClass {
    @Override
    public void doSomethingElse() {
      // Here's my implementation. 
    }
} 
```

但是，如果您谈论的是 Collection 接口，正如其他人所说，它们是一个例外。如果某些方法未实现而您调用它们，它们可能会引发 `UnsupportedOperationException`异常。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-05-13T14:50:40.643

Collection 接口中的可选方法意味着该方法的实现允许抛出异常，但无论如何都必须实现。如[文档中所述](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)：

> 一些集合实现对它们可能包含的元素有限制。例如，一些实现禁止空元素，而一些实现对其元素的类型有限制。尝试添加不合格的元素会引发未经检查的异常，通常是 NullPointerException 或 ClassCastException。尝试查询不合格元素的存在可能会引发异常，或者它可能只是返回 false；一些实现会表现出前一种行为，而另一些会表现出后者。更一般地，尝试对不合格元素执行操作，该不合格元素的完成不会导致将不合格元素插入集合中，这可能会引发异常，也可能会成功，这取决于实现的选择。此类例外被标记为“可选”

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-05-13T14:48:44.077

必须实现所有方法才能编译代码（除了那些`default`在 Java 8+ 中实现的方法），但实现不必做任何功能上有用的事情。具体来说，它：

*   可能为空白（一个空方法。）
*   可能只是扔一个`UnsupportedOperationException`（或类似的）

后一种方法通常在集合类中采用 - 所有方法仍然实现，但如果在运行时调用，有些方法可能会抛出异常。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-12-22T23:22:26.813

在 Java 8 及更高版本中，这个问题的答案仍然有效，但现在更加细微。

首先，来自已接受答案的这些陈述仍然正确：

*   接口旨在指定它们在契约中的隐含行为（实现类必须遵守的行为规则声明才能被认为是有效的）
*   合同（规则）和实施（规则的程序化编码）之间存在区别
*   必须始终实现接口中指定的方法（在某些时候）

那么，Java 8 中新的细微差别是什么？当谈到*“可选方法”*时，以下任何一种现在都很合适：

**1\. 一种方法，其实现在合同上是可选的**

“第三条声明”表示必须始终实现抽象接口方法，这在 Java 8+ 中仍然适用。但是，就像在 Java 集合框架中一样，可以在合同中将一些抽象接口方法描述为“可选”。

在这种情况下，实现接口的作者可以选择不实现该方法。然而，编译器将坚持实现，因此作者将此代码用于特定实现类中不需要的任何可选方法：

```
public SomeReturnType optionalInterfaceMethodA(...) {
    throw new UnsupportedOperationException();
} 
```

在 Java 7 和更早的版本中，这确实是唯一一种“可选方法”，即如果没有实现，就会抛出 UnsupportedOperationException 的方法。这种行为必须由接口契约指定（例如，Java 集合框架的可选接口方法）。

**2.一个默认方法，其重新实现是可选的**

Java 8 引入了*默认方法*的概念。这些方法的实现可以由接口定义本身提供。通常只有在方法体可以使用其他接口方法（即“原语”）编写时才可能提供默认方法，并且何时`this`可以表示“其类已实现该接口的该对象”。

默认方法必须满足接口的约定（就像任何其他接口方法实现必须一样）。因此，在实现类中指定接口方法的实现由作者自行决定（只要行为适合他或她的目的）。

在这个新环境中，Java Collections Framework**可以**重写为：

```
public interface List<E> {
    :
    :
    default public boolean add(E element) {
        throw new UnsupportedOperationException();
    }
    :
    :
} 
```

这样，`add()`如果实现类没有提供自己的新行为，则“可选”方法具有抛出 UnsupportedOperationException 的默认行为，这正是您希望发生的并且符合 List 的约定。如果作者正在编写一个不允许将新元素添加到 List 实现的类，则实现`add()`是可选的，因为默认行为正是需要的。

在这种情况下，上面的“第三条语句”仍然成立，因为接口本身已经实现了方法。

**3.返回`Optional`结果的方法**

最后一种新的可选方法只是一个返回`Optional`. 该类`Optional`提供了一种更加面向对象的方式来处理`null`结果。

在流畅的编程风格中，例如在使用新的 Java Streams API 编码时常见的那种，任何时候的 null 结果都会导致程序崩溃并出现 NullPointerException。该类`Optional`提供了一种将空结果返回到客户端代码的机制，该机制可以启用流畅的样式，而不会导致客户端代码崩溃。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-03-11T19:14:45.620

事实上，我受到 SurfaceView.Callback2 的启发。我认为这是官方的方式

```
public class Foo {
    public interface Callback {
        public void requiredMethod1();
        public void requiredMethod2();
    }

    public interface CallbackExtended extends Callback {
        public void optionalMethod1();
        public void optionalMethod2();
    }

    private Callback mCallback;
} 
```

如果您的类不需要实现可选方法，只需“实现回调”。如果您的类需要实现可选方法，只需“实现 CallbackExtended”。

对不起，糟糕的英语。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-02-11T07:08:49.497

如果我们通过 grepCode 中的[AbstractCollection.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/AbstractCollection.java)的代码，它是所有集合实现的祖先类，它将帮助我们理解可选方法的含义。这是 AbstractCollection 类中 add(e) 方法的代码。add(e) 方法根据[集合](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)接口是可选的

```
public boolean  add(E e) {

        throw new UnsupportedOperationException();
    } 
```

可选方法意味着它已经在祖先类中实现，并在调用时抛出 UnsupportedOperationException。如果我们想让我们的集合可修改，那么我们应该覆盖集合接口中的**可选**方法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-07-31T19:02:26.553

好吧，这个话题已经解决了......是的..但是想想，一个答案是缺失的。我在谈论接口的“默认方法”。例如，假设您将有一个用于关闭任何东西（如析构函数或其他东西）的类。假设它应该有3种方法。我们称它们为“doFirst()”、“doLast()”和“onClose()”。

所以我们说我们希望该类型的任何对象至少实现“onClose()”，但另一个是可选的。

您可以使用接口的“默认方法”来实现这一点。我知道，大多数时候这会否定接口的原因，但如果你正在设计一个框架，这可能很有用。

因此，如果您想以这种方式实现它，它将如下所示

```
public interface Closer {
    default void doFirst() {
        System.out.print("first ... ");
    }
    void onClose();
    default void doLast() {
        System.out.println("and finally!");
    }
} 
```

现在会发生什么，例如，如果您在一个名为“Test”的类中实现它，编译器将完全可以使用以下内容：

```
public class TestCloser implements Closer {
    @Override
    public void onClose() {
        System.out.print("closing ... ");
    }
} 
```

输出：

```
first ... closing ... and finally! 
```

或者

```
public class TestCloser implements Closer {
    @Override
    public void onClose() {
        System.out.print("closing ... ");
    }

    @Override
    public void doLast() {
        System.out.println("done!");
    }
} 
```

输出：

```
first ... closing ... done! 
```

所有组合都是可能的。任何带有“默认”的东西都可以实现，但不能，但是任何没有“默认”的东西都必须实现。

希望我现在回答不是完全错误的。

祝大家有美好的一天！

[edit1]：请注意：这只适用于 Java 8。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-27T21:19:19.120

我正在寻找一种实现回调接口的方法，因此实现可选方法是必要的，因为我不想为每个回调实现每个方法。

因此，我没有使用接口，而是使用了一个具有空实现的类，例如：

```
public class MyCallBack{
    public void didResponseCameBack(String response){}
} 
```

你可以像这样设置成员变量CallBack，

```
c.setCallBack(new MyCallBack() {
    public void didResponseCameBack(String response) {
        //your implementation here
    }
}); 
```

然后这样称呼它。

```
if(mMyCallBack != null) {
    mMyCallBack.didResponseCameBack(response);
} 
```

这样，您不必担心每次回调都实现每个方法，而只需覆盖您需要的方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-03T00:22:06.030

虽然它没有回答 OP 的问题，但值得注意的是，从 Java 8 开始，向接口添加默认方法[实际上是可行的](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)。放置在接口的方法签名中的`default`关键字将导致类可以选择覆盖该方法，但不需要它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-12-04T08:39:37.410

[Oracle 的 Java 集合教程：](https://docs.oracle.com/javase/tutorial/collections/interfaces/index.html)

> 为了保持核心集合接口的数量易于管理，Java 平台没有为每个集合类型的每个变体提供单独的接口。（这样的变体可能包括不可变、固定大小和仅附加。）相反，每个接口中的修改操作都被指定为可选的——给定的实现可能选择不支持所有操作。如果调用了不受支持的操作，则集合将引发[UnsupportedOperationException](https://docs.oracle.com/javase/8/docs/api/java/lang/UnsupportedOperationException.html)。实现负责记录它们支持哪些可选操作。Java 平台的所有通用实现都支持所有可选操作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-23T18:34:50.207

我想对接口中的“可选”方法做一些澄清，请记住这篇文章已经有将近 10 年的历史了。

正如已经提到的（尤其是@amit），从 Java 8 开始，接口可以有`default`方法。这是您可以解决此问题的一种方法，因为实现类不需要实现默认方法（因此您可以从实现的角度调用“可选”）。然而，事实上，一个实现类仍然可以调用这个方法，因为接口正在定义它。因此，实际上，它不是可选行为，因为该类已经包含接口强加的（默认）行为。我有一个更好的选择，我稍后会提到。

我要说明的第二点是，在绝大多数情况下实施“什么都不做”方法是一个糟糕的想法。“什么都不做”方法会引入副作用，这些副作用在大多数情况下弊大于利，而且您可能永远不会意识到这些副作用。作为一个例子，我想用 JUnit 测试来说明这一点。如果您使用一堆“什么都不做”测试方法创建一个测试类，框架将执行这些方法并将它们标记为通过，而实际上没有执行任何测试。这是一个非常危险的副作用。将此场景扩展到您可能创建的包含“什么都不做”方法的公共库。客户端可能不知道这些空实现，并且可能在不知道它们不做任何事情的情况下调用这些方法。我可以举例说明更多的例子，但这不是我回答的重点。话虽如此，实现“什么都不做”方法并不是“可选”行为的示例。该方法首先实现的事实已经证明它不是可选的（“什么都不做”行为与不存在的行为不同）。

无论您使用什么版本的 Java，**解决此问题的最佳方法是遵循 SOLID 原则中的“I”：*接口隔离原则***。使用 ISP，您可以在单独的接口中分离可选和必需的方法。假设您需要创建一个`Calculator`并且您打算使用一个`CalculatorOperations`接口。但是这个界面的操作比你需要的要多，因为你的计算器只需要使用四种基本的数学运算（加法、减法、乘法、除法）。ISP 声明*不应强迫任何客户端依赖它不使用的方法*。因此，处理这个问题的最好方法是将`CalculatorOperations`接口分成两个或多个接口；例如，`BasicOperations`和`AdvancedOperations`. 一旦您通过使用不同的接口将必需的功能与可选功能分离，您可以让您的类实现所需的接口，或者更好的是，在需要时使用依赖注入 (DI) 来注入所需的行为（甚至删除它）。例如，使用 DI 可以让您通过简单地单击按钮（即 Windows 计算器）来显示和隐藏操作。

我知道计算器操作接口是一个微不足道的例子，但关键是 ISP 是使用 Java 中的接口明确区分必需操作和可选操作的最佳方法。

# javascript - 在 html5 上检查在线状态的最佳方法

> ID：10572645
> 
> 赞同：1
> 
> 时间：2012-05-13T14:48:09.947
> 
> 标签：javascript, html, extjs

如果浏览器连接到互联网，我需要了解我的网络应用程序是否正常工作。这意味着我必须使用云数据或本地存储之一。

当我使用 navigator.onLine 时，只有 chrome 告诉我真相。Firefox 或 Safari 仅检查我是否连接到 wi-fi。

我创建了一个向特定网站发送 ping 的函数，并尝试每次下载一个小文件，但如果我在移动设备上使用我的网络应用程序，这不是一个好的解决方案。

谁能告诉我另一个想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:10:41.467

这取决于您所说的“连接到互联网”是什么意思。从浏览器到服务器资源的路径上有很多可能会失败的点。是你的本地连接吗？您的默认网关有问题吗？更广泛的网络上的路由问题？您尝试访问的服务器应用程序有问题吗？

绝对确定您需要的资源是可用的，并且在旅途中的任何地方都没有问题的唯一方法是尝试获取您需要的资源。但是，如果您必须等待超时才能确定确实存在问题，那么检查这一点可能会很慢。

您是否考虑过另一种离线运行浏览器应用程序的方法，即始终将数据保存到本地存储并定期将其异步同步到服务器？您可以向用户提供有关与服务器同步是否成功的反馈，但对数据始终保存在本地感到满意。

我知道一个对此有帮助的库，那就是新的 Microsoft [Single Page Application framework](http://www.asp.net/single-page-application/an-introduction-to-spa/overview/landingpage)。当然，还必须有其他非微软的等价物。

**编辑：** [这看起来是一个非常有趣的从头开始的方法，你可以如何做到这一点。](http://dmfrancisco.github.com/Desligado/)

如果您想自己写一些东西，那么关于这种方法有一些问题：[关于离线 HTML5 数据库同步的问题。](https://stackoverflow.com/questions/4488854/how-to-sync-offline-html5-webdatabase-with-centralised-database)

# jquery - 绝对位置 + 相对位置

> ID：10572647
> 
> 赞同：1
> 
> 时间：2012-05-13T14:48:21.507
> 
> 标签：jquery, html, css

我正在重新设计一个不同的旧页面。为了使菜单系统正常工作，他们使用 position: relative; `<body>`标签上。我的问题是，例如，当我创建一个 jQuery ui datepicker 或绝对定位的东西时，它会向左/右显示 +- ~200px。有什么解决方法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:50:30.127

`<div>`在整个页面周围制作一个容器并将其设置为`position: relative`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-06T03:50:31.950

我知道这是一个非常古老的帖子，但如果这对其他人有帮助，那么这个问题可能是由于身体左侧的边缘而发生的。

一个简单的解决方法是在日期选择器出现之前抵消边距。

```
$('#container').datepicker(
{
    beforeShow: function(inputElem, dp)
    {
        dp.dpDiv.css({ marginLeft: '-' + $('body').css('margin-left') });
    }
}); 
```

# java - R.java 错误：类文件冲突

> ID：10572649
> 
> 赞同：2
> 
> 时间：2012-05-13T14:48:29.133
> 
> 标签：java, android, mobile

我正在开发一个android应用程序，我不断收到这个错误：

> 类文件冲突：存在不同情况的资源：'/Fit Fray/bin/classes/com/a/ff/act/R$String.class'。

我以前通过玩一些布局ID来“修复”它，但我最终得到了这个错误：

> 说明资源路径位置类型所需库的存档：项目“...”中的“...”无法读取或不是有效的 ZIP 文件 SP-Reversi 构建路径 构建路径问题

我曾尝试清理项目、重建、重新启动 Eclipse 并创建一个新项目，但我创建的所有新项目似乎都在发生这种情况。

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-10T05:48:02.467

我有同样的问题，我修复了它：我可能是由于：案例 1\. XML 文件或 .java 文件或自定义 id 的名称频繁更改，例如：而不是 `@+id/myid -->@+classname/myid and referenced as (R.Classname.myid)`. 案例 2\. 同一个 xml 或不同的 xml 中具有相同名称的 ID。

解决方案：案例 1。主要是由于自定义 id 的 Check for all the views 应该有`@+classname/myid`而不是`@+id`.
案例 2。多个资源共享相同的 id 或反之亦然，因此为 id 提供唯一名称并消除任何冗余。清洁并运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-02T13:29:58.313

有时我仍然会遇到同样的错误（在导出、清理或构建应用程序之后，在创建新项目时，或者在关闭 eclipse 并再次打开它之后）。我发现**可以**通过进入 R.java 并删除顶部的注释行来解决该错误。然后关闭文件，它将重新生成，这**可以**解决错误。如果不重试。不得不一直这样做真的很烦人，特别是因为有时需要多次尝试才能消除错误，但至少我可以再次编译。如果有人有一个永久的解决方案，那就太好了。

# ms-access - 启用 Access DB 的开发人员视图？

> ID：10572658
> 
> 赞同：3
> 
> 时间：2012-05-13T14:49:38.137
> 
> 标签：ms-access, ms-access-2007, ms-access-2003

MS Access 不是我的主要知识领域。因此，我的问题可能不够具体。尽管如此。

我们有一个定制的 MS Access 应用程序，我们想稍微改变一下，例如将 2012 年添加到某个控件中。

**与 MS Access 应用程序一样，此应用程序隐藏了数据库的开发人员视图**。最近 - 虽然应用程序在关机期间发布了一条错误消息 - 开发人员视图被暴露了。不幸的是，下面出现错误对话框，通过单击确定终止了 MS Access。

我认为，有一种标准的方法来培养这样一个数据库的开发人员。有人可以提供提示吗？

**请不要提供指向破解软件的链接。我只对标准/合法方式感兴趣。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T15:14:04.973

只要您处理的是 mdb/accdb，而不是 mde/accde，则在打开数据库时按住 shift 键可能会启用禁用的菜单。按住 shift 键，直到数据库完全打开。在某些情况下，Shift 键覆盖被禁用，但也有解决此问题的方法。

数据库打开后，按 alt+F11 打开代码窗口。

如果禁用了 shift 键绕过，生活会变得更加困难，首先阅读[MS Access 启动属性](https://stackoverflow.com/questions/7683216/ms-access-start-up-properties/7687070#7687070)

# python - 跟踪碰撞的最有效方法是什么

> ID：10572660
> 
> 赞同：1
> 
> 时间：2012-05-13T14:50:14.063
> 
> 标签：python

我是一个新的年轻程序员，我正在学习 python。我只是在制作一个示例程序来学习如何制作更大的程序。

```
class Robot():

    def __init__(self):
        self.xpos = 0
        self.ypos = 0

    def step(self, axis):
        print "step"
        if axis in "xX":
            self.xpos += 1
        elif axis in "yY":
            self.ypos += 1

    def walk(self, axis, steps=2):
        for i in range(steps):
            self.step(axis)

    def get_pos(self):
        print "X:%i  Y:%i" % (self.xpos, self.ypos)

robot = Robot()
robot.walk("x", steps=3) 
```

所有这些都是跟踪单个机器人的位置。如果我有两个机器人并且它们是否在同一个位置，我如何跟踪。

例子：

```
robot1 = Robot()
robot2 = Robot()
robot1.walk("x",5)
robot2.walk("x",5) 
```

他们将在同一个位置，那么我将如何检查是否有机器人在同一个位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:56:56.653

我认为您需要另一个类，例如 Room() 或 CoordinateSystem() 或包含对所有 Robot 对象的引用的东西。然后你可以有一个类方法说房间，占用，它返回该位置是否被占用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:01:16.877

如果你创建一个类似的类`Map`，编写一个检查所有机器人位置的方法很简单：

```
class Map:
    def __init__(self):
        self.robots = []

    def add_robot(self, robot):
        self.robots.add(robot)

    def is_occupied(self, x, y):
        for r in self.robots:
            if r.xpos == x and r.ypos == y:
                return True
        return False 
```

这具有允许您可能希望在地图上执行许多其他操作的优势 - 例如，您可以判断路径是否清晰。

顺便说一句，您可能希望在每个 Robot 上包含一个对它所在的 Map 的引用（可以由`add_robot`方法设置，以便当您调用它的方法时机器人可以判断它是否可以移动`move`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:02:52.243

虽然创建一个容器来保存所有机器人的信息肯定是检查碰撞的一种方法，但您仍然需要做的底层检查是对每个机器人 (x,y) 进行相等性测试。

因此，以最简单的形式，您可以通过简单的“与”相等测试进行检查，然后创建一个函数来容纳它：

```
def check_collision(r1, r2):
    if r1.x == r2.x and r1.y == r2.y:
        return True
    return False 
```

然后可以修改这样的功能，以添加到机器人类或新的地图/房间类。

# c++ - 从 'int' 到 'const char*' 的无效转换

> ID：10572671
> 
> 赞同：0
> 
> 时间：2012-05-13T14:52:09.543
> 
> 标签：c++, qt

我是 c/c++ 的新手，我已经使用 python 很长时间了，我没有学习任何教程，但是当我尝试声明一个字符串数组时出现了这个错误。

代码：

```
 QString months[12]={'Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'}; 
```

错误：从 'int' 到 'const char*' 的无效转换

这个错误是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T14:53:53.870

对字符串 ( `"`) 使用双引号。`'`用于字符文字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-22T08:34:21.537

`'`在 Python 中和(是字符串)之间没有区别`"`，但在 C++ 中它们是不同的：

```
char   c = 'c';
string str = "string"; 
```

不要忘记 C++ has not `'''`，而它在 Python 中是字符串。

你的代码：

```
 ... "Oct", "Nov", "Dec"}; 
```

# symfony - 当使用 symfony2 的表单类型“collection”时，我如何验证是否至少提交了一个表单？

> ID：10572672
> 
> 赞同：4
> 
> 时间：2012-05-13T14:52:19.440
> 
> 标签：symfony, doctrine

我使用[本教程](http://symfony.com/doc/current/cookbook/form/form_collections.htm)嵌入了一组表单。如何添加验证以确保表单与至少一个表单一起提交？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-04-09T15:05:53.940

Symfony 现在有一个`Count`约束，可以与集合类型一起使用来设置最小项目数：

```
use Symfony\Component\Validator\Constraints as Assert;
use Symfony\Component\Form\Extension\Core\Type\CollectionType;

$formBuilder->add('example', CollectionType::class, [
  // other options...
  'constraints' => [
    new Assert\Count([
      'min' => 1,
      'minMessage' => 'Must have at least one value',
      // also has max and maxMessage just like the Length constraint
    ]),
  ],
]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:26:32.640

使用[回调函数](http://symfony.com/doc/current/reference/constraints/Callback.html)，调用您的集合的[计数](http://php.net/count)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-14T16:24:45.083

也许您应该在表单 Type 类中或作为 Entity 类中的 Assert 注释中至少创建一个字段？

# javascript - 如何将参数传递给使用 setTimeout 调用的函数？

> ID：10572673
> 
> 赞同：6
> 
> 时间：2012-05-13T14:52:23.923
> 
> 标签：javascript, closures, scope, settimeout

我想将一个参数传递给一个名为 using 的函数`setTimeout`。我找到了这三个选项：

```
A = 1;
// Method 1: closure things
setTimeout(function() { whatsA(A); }, 100);
// Method 2: third argument (same result with [A])
setTimeout(whatsA, 100, A);
// Method 3: eval
setTimeout('whatsA(' + A + ')', 100);
A = 2;
function whatsA(X) { console.log(X); } 
```

这在 Internet Explorer 9 中显示`2`、`undefined`和。`1`

**方法1**：显然，我不希望在传递参数后更改参数（当然在简单整数的情况下）。

**方法二**：如果只有 Internet Explorer 支持就完美了。

**方法3**：这似乎是唯一的选择。但它似乎不如其他漂亮，传递要评估的东西而不是函数。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-13T14:58:19.013

我能想到的最佳解决方案是使用`bind()`：

```
A = 1;
setTimeout(whatsA.bind(this, A), 100); 
```

因为`bind()`实际上是一个函数调用，它读取当前`A`值并返回一个将该值绑定为参数的函数。如果你觉得很难理解，试试这个：

```
var newFun = whatsA.bind(this, 42);
newFun() 
```

请注意，这`this`是一种谎言——你也可以安全地通过`window`。

* * *

第一种方法也可以，只是需要稍微改进一下：

```
A = 1;
var tmpA = A;
setTimeout(function() { whatsA(tmpA); }, 100); 
```

您所观察到的实际上是一个功能，而不是一个错误。您正在将闭包传递给`setTimeout()`引用局部变量。JavaScript 足够聪明，可以将对该变量的访问延迟到实际调用该函数的那一刻。由于您修改了变量，因此您会看到最新版本。

* * *

第二种方法已弃用~~无法在任何浏览器中使用~~.

* * *

第三种方法很糟糕，避免将字符串传递给`setTimeout()`，总有更好的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-13T14:59:06.277

你可以使用闭包：

```
setTimeout((function(A){
               return function(){
                   whatsA(A);
               }; 
            })(A), 100); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:10:53.730

在您的三种方法中：

**选项1：**

`setTimeout(function() { whatsA(A); }, 100);`

这个适用于任何地方并且很简单。这是我推荐的，除非变量`A`在调用 setTimeout 函数之前可能会发生变化。如果您需要冻结 的值`A`，请参阅下面的选项 4。

* * *

**选项 2：**

`setTimeout(whatsA, 100, A);`

这仅适用于某些浏览器。不建议。

* * *

**选项 3：**

`setTimeout('whatsA(' + A + ')', 100);`

永远不建议这样做。将代码构造为字符串然后再对其进行评估几乎从来都不是最好的解决方案。

* * *

我会推荐**选项 4**：

要冻结 的值`A`，您可以使用自执行函数创建闭包：

```
A = 1;

function(A) {
    setTimeout(function() {whatsA(A);}, 100);
}(A);

A = 2;
function whatsA(X) { console.log(X); } 
```

# google-chrome - 可以在 Google Chrome Web 应用程序中使用多功能框吗？

> ID：10572675
> 
> 赞同：0
> 
> 时间：2012-05-13T14:52:39.980
> 
> 标签：google-chrome, google-chrome-extension

我想为一个简单的 Chrome 网络应用程序添加使用 Chrome Omnibox 的可能性。该应用程序应该只是 chrome 起始页上的一个图标，并添加 Omnibox 功能。

将属性添加`"omnibox": { "keyword" : "x" }`到我的 manifest.json 会显示消息

> 功能“多功能框”不可访问。不允许用于指定的包类型（主题、应用程序等）。

是否可以启用此功能，或者我可以开发一个行为与 Chrome 网络应用程序完全相同的扩展程序，以便我可以在该扩展程序中使用多功能框？

感谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T02:32:35.460

如果您正在制作[托管应用程序](https://developers.google.com/chrome/apps/docs/developers_guide)，那么您可以访问的内容非常有限。我相信托管应用程序只能执行普通 HTML5 网页可以执行的操作（少数例外，例如长时间运行的[背景页面](https://developers.google.com/chrome/apps/docs/background)）。如果您想包含多功能框功能，则必须将其设为打包应用程序——但它可能是一个打包应用程序，可以像当前应用程序一样打开您的网页*并*包含多功能框支持，因为打包应用程序的功能是一个超集托管应用程序功能。

# php - 无法从数据库中的选择中获取价值

> ID：10572676
> 
> 赞同：0
> 
> 时间：2012-05-13T14:52:50.080
> 
> 标签：php

我从选择中获取值时遇到问题，该选择将其选项从数据库中获取。我已经尝试寻找解决方案，但我似乎找不到答案，因为这些选项不是硬编码的。

这是选项选择：

```
<select id="selectmission" name='missionselect' onchange='showoptions()'>
              <?php while($mission = $allmissions->fetch_assoc())
        { echo "<option value='".$mission['missionid']."'>".$mission['missionname']."</option>";?>
                <option value="other">Other</option>
                </select> 
```

这是php：

```
if(isset($_POST['btnSubmit']))
    {
        try
        {
            $t->Description = $_POST['description'];
            if($_POST['missionselect'] = 'other')
            {
                $m->Missionname = $_POST['missionname'];
                $m->CreateNewMission();
            }
        else
            {
                $t->Missionid = $_POST['missionselect'];
            } 
```

我试图让它通过使用此代码来回显它标识的值：

```
$select = $_POST['missionselect'];
echo $select; 
```

它表明它总是检测到选项“其他”，这是唯一的硬编码选项。

我希望有人能看到我错过了什么！谢谢大家，贾娜

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:56:49.753

也许这种变化：

```
if($_POST['missionselect'] = 'other')
if($_POST['missionselect'] == 'other') 
```

# java - playframework 使用 find 和 IN 和模型列表

> ID：10572679
> 
> 赞同：0
> 
> 时间：2012-05-13T14:53:28.350
> 
> 标签：java, hibernate, playframework, playframework-1.x

我在播放（1.2.4）中编写的以下代码有问题：

```
List<MSprache> sprachen = MSprache.find("active = ?", true).fetch();
List<MFieldDscr> textey     = MFieldDscr.find("sprache IN", sprachen).fetch(); 
```

如果我执行一个测试这部分代码的测试，则会显示以下错误：

```
A java.lang.IllegalArgumentException has been caught, org.hibernate.hql.ast.QuerySyntaxException: unexpected token: null near line 1, column 48 [from models.Sprache.MFieldDscr where sprache IN] 
```

我不明白错误在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:27:31.413

我不太确定你想要实现什么，
但我认为这就是你想要的：

```
String jpql = "FROM MFieldDescr fd WHERE fd.sprache "
            + "IN ( SELECT s FROM MSprache s WHERE s.active = ? ) ";
List<MFieldDscr> textey = MFieldDescr.find( jpql, true ).fetch(); 
```

这将找到所有具有活动集的`MFieldDescr`实体。 `MSprache``true`

* * *

顺便说一下，用于查询实体的语言是 JPQL，以防您想了解更多信息。

以下是一些有用的链接：

*   [JPQL 表达式](http://openjpa.apache.org/builds/1.2.0/apache-openjpa-1.2.0/docs/manual/jpa_langref.html#jpa_langref_in "JPQL 表达式")
*   [JPQL 子查询](http://openjpa.apache.org/builds/1.2.0/apache-openjpa-1.2.0/docs/manual/jpa_langref.html#jpa_langref_subqueries)

# php - 清除 url 变量

> ID：10572681
> 
> 赞同：0
> 
> 时间：2012-05-13T14:53:31.190
> 
> 标签：php

我正在尝试整理设置页面的错误部分，并且因为我正在验证单独脚本上的所有数据，所以我必须使用 url 变量来检查是否存在错误

所以如果有错误，它看起来像这样

本地主机/site123675/settings.php?eid=1

但是，错误显示正常，但我想要一种删除它的方法，因为如果用户收到错误然后输入正确答案，它仍然显示相同的错误。

那么，如何在用户重新提交页面之前清除任何变量的 url？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T14:58:16.260

不完全确定您面临的确切问题，但您可以进行标头重定向：

```
if (isset($_GET['eid'])) {
    header('Location: /site123456/settings.php');
    exit;
} 
```

# java-me - 在 J2ME 中获取上一个日期

> ID：10572686
> 
> 赞同：0
> 
> 时间：2012-05-13T14:54:07.290
> 
> 标签：java-me

我想在 J2ME 中获取上个月的日期。

我找到了这段代码：

```
Calendar c = Calendar.getInstance();  
c.add(Calendar.YEAR, -1); //one year back  
c.add(Calendar.MONTH, -1);// then one month 
```

但这在 Java SE 而不是 J2ME 中工作，如果有人可以帮我在 J2ME 中找到相应的方法或类吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T18:13:09.553

日历没有方法添加。

```
 c.set(Calendar.MONTH, -1) 
```

表示您在字段 MONTH 处设置值 -1。你的解决方案是

```
 // get current month
    int m = c.get(Calendar.MONTH);
    // decrement it
    if (--m < 0) {
        // if was january, must become december of past year
        m = 11;
        // set year to previous
        c.set(Calendar.YEAR, c.get(Calendar.YEAR) - 1);
    }
    // set new value "m" to field MONTH
    c.set(Calendar.MONTH, m); 
```

有关文档，请参阅[http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/index.html](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/index.html) 。除非你知道你需要的一切，否则你不应该在没有它的情况下工作。

# formatting - 引用 YAML（对于 Travis CI）

> ID：10572689
> 
> 赞同：11
> 
> 时间：2012-05-13T14:54:44.267
> 
> 标签：formatting, escaping, yaml, travis-ci, string-literals

我如何在 YAML 中转义整行？我想有`json='{"title": "travis_saulshanabrook_site","key": "'$(cat ~/.ssh/id_rsa.pub)'"}'` 一个列表，但我不能让它解析成一个字符串。我可以在整行周围加上单引号，但是我必须转义字符串中的每个单引号，这使得它很难阅读。该字符串将在[Travis CI中作为 bash 命令运行](http://about.travis-ci.org/docs/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-06-30T06:42:24.810

最优雅的解决方案是使用[文字样式](http://www.yaml.org/spec/1.2/spec.html#id2795688) `|`指示符，使用`-`修饰符去除最后的换行符。这样就不需要额外的引号。

如果这个标量恰好是 YAML 文件中的唯一内容，请使用：

```
|-
  json='{"title": "travis_saulshanabrook_site","key": "'$(cat ~/.ssh/id_rsa.pub)'"}' 
```

如果它是 key 的映射值`abc`：

```
abc: |-
  json='{"title": "travis_saulshanabrook_site","key": "'$(cat ~/.ssh/id_rsa.pub)'"}' 
```

或者如果它是列表的一部分：

```
- |-
  json='{"title": "travis_saulshanabrook_site","key": "'$(cat ~/.ssh/id_rsa.pub)'"}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:27:25.343

我不确定是否有一种解决方案可以使该字符串转义*并*使其易于阅读。

仅供参考，这就是该字符串看起来像已转义的内容：

```
script: ! 'your_cmd json=''{"title": "travis_saulshanabrook_site","key": "''$(cat ~/.ssh/id_rsa.pub)''"}''' 
```

# c# - 为什么使用 var 而不是类名？

> ID：10572693
> 
> 赞同：13
> 
> 时间：2012-05-13T14:55:27.943
> 
> 标签：c#, variables, var

> **可能重复：**
> [var 关键字的意义何在？](https://stackoverflow.com/questions/209199/whats-the-point-of-the-var-keyword)
> [与 C# 中的显式类型相比，使用 var 有什么优势？](https://stackoverflow.com/questions/3425966/what-advantages-does-using-var-have-over-the-explicit-type-in-c)

我总是看到其他人生成如下代码：

> var smtp = 新的 SmtpClient();

但是为什么在这种情况下使用`var`而不是呢？`SmtpClient`我**总是**用

> SmtpClient smtp = new SmtpClient();

`var`更有效率吗？为什么使用`var`而不是实际的变量类型？我错过了什么吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-13T14:59:29.393

想象一下。

```
Dictionary<Dictionary<String, String>, String> items = new Dictionary<Dictionary<String, String>, String>(); 
```

`var`对这样的事情很有用。

```
var items = new Dictionary<Dictionary<String, String>, String>(); 
```

简单得多。的点与C++ 11`var`中的相同`auto`，编译器知道类型，所以我们为什么要如此重复自己。我个人`var`很少使用，但仅用于冗长的声明。这只是语法糖。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-13T14:56:03.137

不，这与效率无关，仅与代码编写风格有关。

考虑到它是关于一种*风格*的，这个规则不能**总是**适用。

想象以下片段：

`var myVar = Some3dPartFunction()`, 是什么*类型*的`myVar`？从代码风格的角度来看，以这种方式编写并不是很清楚，也不是很好。

总之，巧妙地选择合适的写作方式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-13T15:10:10.573

不，它不是更有效。明确地写类型是一样的。事实上，编写变量的类型而不是使用是好的编程，`var`因为它使代码更具可读性。

所以：

```
var smtp = new SmtpClient(); 
```

和：

```
SmtpClient smtp = new SmtpClient(); 
```

是同一件事用两种不同的方式写的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-13T15:06:56.657

它是语法糖：

```
var smtp = new SmtpClient(); 
```

等于：

```
SmtpClient smtp = new SmtpClient(); 
```

这是 C# 3.0 中的一项新功能，称为类型推断。

# apple-push-notifications - Apple Push Notifications，更高级一点

> ID：10572696
> 
> 赞同：0
> 
> 时间：2012-05-13T14:55:43.667
> 
> 标签：apple-push-notifications

我确实知道如何配置推送通知，但我不知道在设置它以发送通知时从哪里开始，当一些人走过特定的俱乐部时......

下面是我想要它做什么的简要说明：假设在晚上，你出去过夜，你走过一个俱乐部，当你走过俱乐部时，如果他们有任何报价，推送通知将是直接发送到您的 iphone/ipod。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T20:53:36.350

我认为这不仅仅是 APNS，您需要在您的应用程序中添加一些代码以实际跟踪用户位置并将其通知服务器（您将在其中获得优惠）以及用户是否在附近然后其中一个报价将发送一个 APNS 让他知道。

# java - Element.getStyle() 在 GWT 中不返回任何值

> ID：10572697
> 
> 赞同：0
> 
> 时间：2012-05-13T14:55:47.770
> 
> 标签：java, html, css, gwt

下面我的 CSS 文件为样式“myButton”设置了宽度“50px”，因此正确地创建了宽度为 50px 的元素。

问题是从 Java (GWT) 管理元素。以下几行：

**我的文件.java**

```
final Element box1 = DOM.getElementById("myButton");
String test=box1.getStyle().getWidth();
box1.getStyle().setWidth(100, Unit.PX);
String test2=box1.getStyle().getWidth(); 
```

结果有**test=""**和**test2="100px"**，并且元素被正确调整为 100px。为什么测试没有任何价值？

谢谢，

**我的文件.html**

```
<div style="width: 100%"> 
  <a  id ="myButton" href="#" class="myButton" style="text-decoration: none">Hey</a>    
</div> 
```

**我的文件.css**

```
.myButton {
    display:block;
    padding: 10px;
    font-family:"Garamond 3 W01","Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;/*"Lucida Sans", "Lucida Sans Regular", "Lucida Grande", "Lucida Sans Unicode", Geneva, Verdana, sans-serif;*/
    font-size: medium;
    color: #000000;
    text-align: center;
    border-radius: 8px;
    background-color: #E7E7E7;
    background-image: url('bar1.png');
    border-bottom: 1px solid #BBB;
    border-top: 1px solid #BBB;
    box-shadow: 0 0 6px 0 #B3B2B7;
    text-shadow: 0 1px 0 white;
    width: 50px; 
    height: 30px;
    margin: 10px 10px 10px 10px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T21:04:07.847

`Element#getStyle()`返回与 JavaScript 相同的`element.style`，即*内联*应用于元素的样式（*通过*其`style=""`属性）。

GWT 不模仿`getComputedStyle`或类似；如果你真的需要它们（这不太可能；你可能应该重构你的代码），那么你将不得不使用 JSNI。

见[https://developer.mozilla.org/en/DOM/element.style](https://developer.mozilla.org/en/DOM/element.style)

# php - 如何将 php 5.2 mhash 代码更改为 php5.3 哈希

> ID：10572699
> 
> 赞同：1
> 
> 时间：2012-05-13T14:55:59.357
> 
> 标签：php, hash, md5, php-5.2

朋友们，我的 php 5.2 代码保存我的密码是这样的

```
echo '<br>'.base64_encode(mhash(MHASH_MD5,'test'));
result  CY9rzUYh03PK3k6DJie09g== 
```

在 php 5.3 中，mhash 扩展已被 Hash 淘汰，就像我在文档中看到的那样。所以我这样尝试。但它给出了错误的结果。

```
echo '<br>'.base64_encode(hash(MD5,'test'));
result MDk4ZjZiY2Q0NjIxZDM3M2NhZGU0ZTgzMjYyN2I0ZjY= 
```

请帮我将我的 5.2 mhash 代码转换为 5.3。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T14:59:44.603

实际上，它们是相同的，只是格式不同。第一个是二进制数据，第二个是十六进制。您可以使用此函数将第一个转换为第二个：

```
$second_hash = bin2hex ($first_hash); 
```

或者反过来：

```
$first_hash = hex2bin ($second_hash); 
```

## 更新

添加此功能：

```
define('HEX2BIN_WS', " \t\n\r");

function hex2bin($hex_string) {
    $pos = 0;
    $result = '';
    while ($pos < strlen($hex_string)) {
      if (strpos(HEX2BIN_WS, $hex_string{$pos}) !== FALSE) {
        $pos++;
      } else {
        $code = hexdec(substr($hex_string, $pos, 2));
        $pos = $pos + 2;
        $result .= chr($code); 
      }
    }
    return $result;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-14T13:24:54.767

如果您想使用 sha1 将过时的 mhash() 方法更新为 hash_hmac() 方法，只需替换：

```
mhash(MHASH_SHA1, $data, $key) 
```

进入

```
hash_hmac('sha1', $data,$key,true) 
```

在我的上下文中，我遇到了旧代码

```
base64_encode(mhash(MHASH_SHA1, $data, $key)); 
```

我替换为

```
base64_encode(hash_hmac('sha1', $data,$key,true)); 
```

我希望它可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-02T15:34:47.663

```
mhash(MHASH_MD5, 'FOOBAR'); // what you have
pack('H*', hash(MD5, 'FOOBAR')) // what you accepted
pack('H*', md5('FOOBAR')); // ...
md5('FOOBAR', true); // what you could/should have used 
```

我知道这个问题已经很老了，但今天我遇到了同样的问题。基于这篇文章，我能够找到一种更短且性能更高的方式，我认为这值得分享。

# java - 如何从 TreeSet 打印对象

> ID：10572706
> 
> 赞同：5
> 
> 时间：2012-05-13T14:56:52.670
> 
> 标签：java, iterator, treeset

我想打印存储在 TreeSet 中的对象的实例变量。

因此，给定一个具有三个实例变量的对象，我想遍历 TreeSet 中的对象并打印它们的 ivars，但是：

```
while ( iter.hasNext() )
{
  System.out.println( iter.next().getIvar1 );
  System.out.println( iter.next().getIvar2 );
} 
```

让我得到第一个对象的 ivar1 和第二个对象的 ivar2。通过我的所有搜索，我发现在将迭代器移动到下一个对象之前无法打印一个对象的所有 ivars，例如：

```
while ( iter.hasNext() )
{
  System.out.println( iter.hasNext().getIvar1() );
  System.out.println( iter.getIvar2 );
  System.out.println( iter.getIvar3 );
  System.out.println( iter.hasNext().getIvar1() );
  ....
} 
```

关于如何实施的任何想法？

提前致谢！=)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-13T15:01:47.970

使用[增强的 for 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)：

```
for (Element element : set) {
    System.out.println(element.getIvar1());
    System.out.println(element.getIvar2());
} 
```

在内部，它只是一个迭代器——但它省去了手动调用`next()`and的麻烦`hasNext()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:58:03.780

不要一直`iter.next()`在循环内调用。只调用一次。每次调用 时[`Iterator.next()`](http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html#next%28%29)，它都会将迭代器推进到迭代中的下一个元素。

```
while ( iter.hasNext() )
{
    Foo element = iter.next();
  System.out.println( element.getIvar1 );
  System.out.println( element.getIvar2 );
} 
```

# wordpress - Wordpress：给定当前类别ID的父类别ID？

> ID：10572711
> 
> 赞同：1
> 
> 时间：2012-05-13T14:57:19.147
> 
> 标签：wordpress

> **可能重复：**
> [Wordpress - 获取当前类别的父母](https://stackoverflow.com/questions/3114988/wordpress-get-current-category-parents)

我正在学习wordpress。

如何从当前类别 ID 中获取父类别 ID？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T15:04:13.997

搜索谷歌，你会得到很多答案。检查以下 WordPress 功能和其他链接。

WordPress具有内置功能[**获取类别父母**](http://codex.wordpress.org/Function_Reference/get_category_parents)

其他有用的链接：

1.  [WORDPRESS：获取顶级父类别的 ID](http://alex.leonard.ie/2011/04/20/wordpress-get-id-of-top-level-parent-category/)
2.  [如何在 WordPress 中获取父类别名称](http://corpocrat.com/2008/10/31/how-to-get-parent-category-name-in-wordpress/)
3.  [Wordpress - 获取当前类别的父母](https://stackoverflow.com/questions/3114988/wordpress-get-current-category-parents)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:21:53.893

```
$childCat = get_category($child_category_id);
$parentCat = get_category($childCat->parent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T18:49:13.430

这应该做得又好又简单

祝一切顺利

阿迪 www.mindmyweb.com

# html - 以编程方式重定向网页

> ID：10572712
> 
> 赞同：0
> 
> 时间：2012-05-13T14:57:27.973
> 
> 标签：html

我的网站上有一个反馈页面。在我网站的主页上，当有人点击“反馈”时，它会打开一个模式窗口来询问人工验证问题。如果响应正确，我想以编程方式打开我的反馈页面的 url。

我担心的是：直接输入网址（即 www.mysite\feedback.html）应该无法访问反馈页面。我怎样才能防止它打开我的反馈页面？

我也知道我的反垃圾邮件工作不是最好的选择，但现在我不需要一个强大的机制。

有什么解决办法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:01:39.780

你为什么不把验证码放在你的反馈页面上？

如果这不是一个选项，您需要使用会话来存储“验证码通过”标志并在联系页面上检查它（也在您的服务器端代码中）。成功提交表单后，您需要清除标记，这样某人就不能在完成一个验证码后手动发送垃圾邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:02:18.547

您应该能够在您的 Web 平台中访问请求的 Referrer 标头。您可以检查此值以查看推荐人是否来自您接受的页面。如果没有，您可以返回 403 或任何响应，如果是，您可以返回实际页面。您将需要访问服务器端框架，例如 PHP 或 ASP.NET。但是请注意，创建 HTTP 请求和欺骗 Referrer 标头很容易。

# mysql - MySQL：如何存储身高/体重信息？

> ID：10572714
> 
> 赞同：1
> 
> 时间：2012-05-13T14:57:33.717
> 
> 标签：mysql, database, database-design

我需要在我的数据库中捕获用户的身高和体重。在 UI 中，我需要提供一个选项来指定以厘米和英寸为单位的高度——以及重量、公斤和磅。稍后，当我显示用户时，我只需要以 1 个测量单位显示他们的身高和体重（例如，以厘米或英寸为单位）。

存储这些数据的最佳方式是什么？我是否存储2条身高数据（例如身高值，身高单位）和2条体重数据（例如体重值，体重单位），然后存储用户输入的数据？当我需要以统一的单位显示数据时，我会在 SQL 中进行转换。

或者我应该在存储之前转换数据，以便以后需要显示用户数据时不需要进行对话？

顺便说一句，当我将数据显示给实际用户时，它必须与用户选择的单位相同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-13T15:00:54.010

想想规范化——除非有令人信服的理由不这样做，否则以一种格式将其存储在一个地方，并在以后始终在代码中使用标准转换。数据库应该存储您的数据，而不是业务规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:00:54.623

您肯定只想保存一个高度和一个宽度 - 使用您选择的单位。单位换算是单次乘法，本质上是零成本。

您还可以有一个单位表，并且带有计算字段的简单内部联接将在单个查询中为您提供正确的数值（SELECT 以及 INSERT/UPDATE）

# c++ - Valgrind：使用 c_str 和 strtod 进行“无效读取”

> ID：10572715
> 
> 赞同：6
> 
> 时间：2012-05-13T14:57:43.743
> 
> 标签：c++, string, g++, valgrind, strtod

我使用 strtod() 来转换一些输入字符串。在使用 valgrind 检查我的代码时，我遇到了“8 号大小的无效读取”。如果 b 以“i”或“n”开头，则会显示该消息，这就是我目前发现的。此外，如果我直接创建一个 const char*（不调用 c_str()），strtod 似乎也可以。继承人的代码：

```
#include <cstdlib>
#include <string>

int main(int argc, char** argv) {
      char*       a = 0; 
      std::string b = "i";
      const char* c = b.c_str();
      double      d = strtod(c, &a); 
} 
```

和（详细的）valgrind 输出：

```
==12638== Memcheck, a memory error detector
==12638== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==12638== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==12638== Command: ./leak
==12638== 
--12638-- Valgrind options:
--12638--    --suppressions=/usr/lib/valgrind/debian-libc6-dbg.supp
--12638--    --show-reachable=yes
--12638--    --leak-check=full
--12638--    -v
--12638-- Contents of /proc/version:
--12638--   Linux version 3.2.0-24-generic (buildd@yellow) (gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) ) #37-Ubuntu SMP Wed Apr 25 08:43:22 UTC 2012
--12638-- Arch and hwcaps: AMD64, amd64-sse3-cx16
--12638-- Page sizes: currently 4096, max supported 4096
--12638-- Valgrind library directory: /usr/lib/valgrind
--12638-- Reading syms from /media/userdata/NetBeansProjects/leak/dist/Debug/GNU-Linux-x86/leak (0x400000)
--12638-- Reading syms from /lib/x86_64-linux-gnu/ld-2.15.so (0x4000000)
--12638--   Considering /lib/x86_64-linux-gnu/ld-2.15.so ..
--12638--   .. CRC mismatch (computed c5d70380 wanted 7d4a76d0)
--12638--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/ld-2.15.so ..
--12638--   .. CRC is valid
--12638-- Reading syms from /usr/lib/valgrind/memcheck-amd64-linux (0x38000000)
--12638--   Considering /usr/lib/valgrind/memcheck-amd64-linux ..
--12638--   .. CRC mismatch (computed b9a585cc wanted 749d1a67)
--12638--    object doesn't have a symbol table
--12638--    object doesn't have a dynamic symbol table
--12638-- Reading suppressions file: /usr/lib/valgrind/debian-libc6-dbg.supp
--12638-- Reading suppressions file: /usr/lib/valgrind/default.supp
==12638== embedded gdbserver: reading from /tmp/vgdb-pipe-from-vgdb-to-12638-by-chri-on-???
==12638== embedded gdbserver: writing to   /tmp/vgdb-pipe-to-vgdb-from-12638-by-chri-on-???
==12638== embedded gdbserver: shared mem   /tmp/vgdb-pipe-shared-mem-vgdb-12638-by-chri-on-???
==12638== 
==12638== TO CONTROL THIS PROCESS USING vgdb (which you probably
==12638== don't want to do, unless you know exactly what you're doing,
==12638== or are doing some strange experiment):
==12638==   /usr/lib/valgrind/../../bin/vgdb --pid=12638 ...command...
==12638== 
==12638== TO DEBUG THIS PROCESS USING GDB: start GDB like this
==12638==   /path/to/gdb ./leak
==12638== and then give GDB the following command
==12638==   target remote | /usr/lib/valgrind/../../bin/vgdb --pid=12638
==12638== --pid is optional if only one valgrind process is running
==12638== 
--12638-- REDIR: 0x40189e0 (strlen) redirected to 0x380625c7 (???)
--12638-- Reading syms from /usr/lib/valgrind/vgpreload_core-amd64-linux.so (0x4a25000)
--12638--   Considering /usr/lib/valgrind/vgpreload_core-amd64-linux.so ..
--12638--   .. CRC mismatch (computed c82927cb wanted 1861273b)
--12638--    object doesn't have a symbol table
--12638-- Reading syms from /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so (0x4c27000)
--12638--   Considering /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so ..
--12638--   .. CRC mismatch (computed 72e29ec9 wanted f3ad49da)
--12638--    object doesn't have a symbol table
--12638-- REDIR: 0x4018850 (index) redirected to 0x4c2bc60 (index)
--12638-- REDIR: 0x40188d0 (strcmp) redirected to 0x4c2cc20 (strcmp)
--12638-- Reading syms from /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16 (0x4e32000)
--12638--   Considering /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16 ..
--12638--   .. CRC mismatch (computed ef748751 wanted e44c0328)
--12638--    object doesn't have a symbol table
--12638-- Reading syms from /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x5132000)
--12638--   Considering /lib/x86_64-linux-gnu/libgcc_s.so.1 ..
--12638--   .. CRC mismatch (computed c8e4b229 wanted 098e39f6)
--12638--    object doesn't have a symbol table
--12638-- Reading syms from /lib/x86_64-linux-gnu/libc-2.15.so (0x5348000)
--12638--   Considering /lib/x86_64-linux-gnu/libc-2.15.so ..
--12638--   .. CRC mismatch (computed 0dfc7f92 wanted 306696b6)
--12638--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.15.so ..
--12638--   .. CRC is valid
--12638-- Reading syms from /lib/x86_64-linux-gnu/libm-2.15.so (0x5705000)
--12638--   Considering /lib/x86_64-linux-gnu/libm-2.15.so ..
--12638--   .. CRC mismatch (computed 84e90409 wanted 8a8fcc58)
--12638--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libm-2.15.so ..
--12638--   .. CRC is valid
--12638-- REDIR: 0x53d48c0 (strcasecmp) redirected to 0x4a25610 (_vgnU_ifunc_wrapper)
--12638-- REDIR: 0x53d0c60 (strnlen) redirected to 0x4a25610 (_vgnU_ifunc_wrapper)
--12638-- REDIR: 0x53d6b90 (strncasecmp) redirected to 0x4a25610 (_vgnU_ifunc_wrapper)
--12638-- REDIR: 0x53d2650 (__GI_strrchr) redirected to 0x4c2ba80 (__GI_strrchr)
--12638-- REDIR: 0x53d0b30 (strlen) redirected to 0x4a25610 (_vgnU_ifunc_wrapper)
--12638-- REDIR: 0x54a93d0 (__strlen_sse2_pminub) redirected to 0x4c2bfa0 (strlen)
--12638-- REDIR: 0x4ee7dd0 (operator new(unsigned long)) redirected to 0x4c2b160 (operator new(unsigned long))
--12638-- REDIR: 0x53d0b80 (__GI_strlen) redirected to 0x4c2bfc0 (__GI_strlen)
==12638== Invalid read of size 8
==12638==    at 0x53D6C4F: __GI___strncasecmp_l (strcmp.S:213)
==12638==    by 0x538900A: ____strtod_l_internal (strtod_l.c:566)
==12638==    by 0x40088B: main (main.cpp:9)
==12638==  Address 0x59ff058 is 24 bytes inside a block of size 26 alloc'd
==12638==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==12638==    by 0x4ED0A88: std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED2494: char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED25E2: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x40085C: main (main.cpp:7)
==12638== 
==12638== Invalid read of size 8
==12638==    at 0x53D6C57: __GI___strncasecmp_l (strcmp.S:215)
==12638==    by 0x538900A: ____strtod_l_internal (strtod_l.c:566)
==12638==    by 0x40088B: main (main.cpp:9)
==12638==  Address 0x59ff060 is 6 bytes after a block of size 26 alloc'd
==12638==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==12638==    by 0x4ED0A88: std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED2494: char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED25E2: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x40085C: main (main.cpp:7)
==12638== 
--12638-- REDIR: 0x4ee6150 (operator delete(void*)) redirected to 0x4c2a450 (operator delete(void*))
--12638-- REDIR: 0x53cb010 (free) redirected to 0x4c2a7c0 (free)
==12638== 
==12638== HEAP SUMMARY:
==12638==     in use at exit: 0 bytes in 0 blocks
==12638==   total heap usage: 1 allocs, 1 frees, 26 bytes allocated
==12638== 
==12638== All heap blocks were freed -- no leaks are possible
==12638== 
==12638== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 2 from 2)
==12638== 
==12638== 1 errors in context 1 of 2:
==12638== Invalid read of size 8
==12638==    at 0x53D6C57: __GI___strncasecmp_l (strcmp.S:215)
==12638==    by 0x538900A: ____strtod_l_internal (strtod_l.c:566)
==12638==    by 0x40088B: main (main.cpp:9)
==12638==  Address 0x59ff060 is 6 bytes after a block of size 26 alloc'd
==12638==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==12638==    by 0x4ED0A88: std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED2494: char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED25E2: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x40085C: main (main.cpp:7)
==12638== 
==12638== 
==12638== 1 errors in context 2 of 2:
==12638== Invalid read of size 8
==12638==    at 0x53D6C4F: __GI___strncasecmp_l (strcmp.S:213)
==12638==    by 0x538900A: ____strtod_l_internal (strtod_l.c:566)
==12638==    by 0x40088B: main (main.cpp:9)
==12638==  Address 0x59ff058 is 24 bytes inside a block of size 26 alloc'd
==12638==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==12638==    by 0x4ED0A88: std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED2494: char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x4ED25E2: std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16)
==12638==    by 0x40085C: main (main.cpp:7)
==12638== 
--12638-- 
--12638-- used_suppression:      2 dl-hack3-cond-1
==12638== 
==12638== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 2 from 2) 
```

有错误还是我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-13T17:21:47.810

我认为您的代码中没有错误。我认为这是 Valgrind 中的一个错误。

Valgrind 有自己的函数实现，如`strchr`,`strcasecmp`等，它重定向您的应用程序以使用而不是 libgcc 中的版本。Valgrind[`mc_replace_strmem.c`](http://valgrind.sourcearchive.com/documentation/3.6.1/mc__replace__strmem_8c_source.html)文件中的一条评论解释说：

```
/* ---------------------------------------------------------------------
   We have our own versions of these functions for two reasons:
   (a) it allows us to do overlap checking
   (b) some of the normal versions are hyper-optimised, which fools
       Memcheck and cause spurious value warnings.  Our versions are
       simpler.

   Note that overenthusiastic use of PLT bypassing by the glibc people also
   means that we need to patch multiple versions of some of the functions to
   our own implementations.

   THEY RUN ON THE SIMD CPU!
   ------------------------------------------------------------------ */ 
```

`REDIR`您可以在日志的输出中看到这些重定向。

从检查来看`mc_replace_strmem.c`，Valgrind 似乎没有替换`__GI___strncasecmp_l`，您的日志表明正在调用它。我建议针对 Valgrind[提交一个错误](http://www.valgrind.org/support/bug_reports.html)，并将您的程序作为测试用例。

# java - 是否可以将检索到的 Class 对象（通过反射）转换为接口？

> ID：10572716
> 
> 赞同：3
> 
> 时间：2012-05-13T14:57:45.910
> 
> 标签：java, android, reflection

我的工作区中有 3 个项目 - A、B 和 C，这是一个 Android lib 项目。

1.  A 包含一个名为`Atest`
2.  B 包含一个名为`Btest`实现接口的类`I`。
3.  C 包含`I`接口。

A 和 B 都安装在我的 Android 设备上。在`Atest`运行时，我正在执行下一个代码：

```
Context otherContext = createPackageContext("com.package.b",
                CONTEXT_INCLUDE_CODE | CONTEXT_IGNORE_SECURITY);
ClassLoader loader = otherContext.getClassLoader();
Class<?> btest = Class.forName("com.package.b.BTest", true, loader); 
```

现在这是我的问题 - 有没有办法将 btest 投射到`I`运行`A`上下文中？

我尝试了许多明显（以及一些不太明显）的技巧，但没有任何对我有用。我当然可以探索 btest 的方法和接口，调用它的方法等。但我根本无法将其转换为，尽管 A 和 B在 lib-project C 中`I`引用了完全相同的接口。`I`

提前致谢！

附言

请注意，我将其转换为接口，而不是对象，所以我猜`ClassLoader`在这种情况下，不同不是原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:20:40.227

你的问题非常不清楚，所以我将不得不猜测你的意思。

首先，Java 中没有`Interface`类，所以你不能这样说：

```
 Interface<?> i = // some magic transformation of btest 
```

因此，我假设您正在谈论将 INSTANCE of`com.package.b.BTest`转换为接口（我们称之为...）`com.package.i.I`。

*   如果两者`Btest`都是`I`静态加载的，那么`(I) bTestInstance`就可以完成这项工作。

*   如果`Btest`是动态加载并`Btest`实现`I`，那么以下应该可以工作：

    ```
     Class<?> btestCls = Class.forName("com.package.b.BTest", true, loader);
        // This will work, because I has to be on the classpath of 'loader'
        // for the previous load to work ...
        Class<?> iCls = Class.forName("com.package.i.I", true, loader);

        Object btest = // create a BTest instance reflectively
        Object i = iCls.cast(btest); 
    ```

    问题当然是因为你的代码已经动态加载了`BTest`and `I`，所以没有办法编写静态类型为`BTest`or的变量`I`。所以演员表没有真正的目的，除了作为一种迂回的方式来断言`BTest`implements `I`。

另一种可能性是您在谈论强制转换 Class 对象。但这没有任何意义，因为您必须使用通配符作为`Class`.

* * *

重申一下，如果`I`静态链接到您的代码中，那么您可以这样做：

```
Object btest = // create or retrieve the instance reflectively
I i = (I) btest; 
```

如果`I`不是静态链接到您的代码中，那么您（显然）不能`I i`在上面声明，并且您必须对 btest 实例的所有操作使用反射。你不能反思地“做”静态类型。时期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T16:14:45.163

因为您在运行时执行所有这些动态加载，所以没有构建虚拟方法表及其关联的 vpointer。因此，运行时无法动态地将对接口方法的调用分派给适当加载的实现。你必须使用反射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:08:06.987

该接口`I`必须在类路径上（或者可以由运行时加载），否则您将获得运行时异常。反思不会让你避免这个问题。

# arrays - Mathematica - plotting an array with values and exponential function

> ID：10572722
> 
> 赞同：0
> 
> 时间：2012-05-13T14:58:32.343
> 
> 标签：arrays, wolfram-mathematica, plot, exponential

I have a question about mathematica. I have an array with values called tempDep:

```
{10.7072,11.5416,12.2065,12.774,13.2768,13.7328,14.1526,14.5436,14.9107,15.2577,15.5874,15.9022,16.2037,16.4934,16.7727,17.0425,17.3036,17.5569,17.803,18.0424,18.2756,18.503,18.725,18.9419,19.154,19.3615,19.5647,19.7637,19.9588,20.1501,20.3378,20.5219,20.7025,20.8799,21.0541,21.2252,21.3933,21.5584,21.7207,21.8801,22.0368,22.1908,22.3423,22.4911,22.6374,22.7813,22.9228,23.0619,23.1987,23.3332,23.4655,23.5955,23.7235,23.8493,23.973,24.0947,24.2143,24.332,24.4478,24.5616,24.6736,24.7837,24.892,24.9986,25.1034,25.2064,25.3078,25.4075,25.5055,25.602,25.6968,25.7901,25.8819,25.9722,26.061,26.1483,26.2342,26.3186,26.4017,26.4835,26.5638,26.6429,26.7207,26.7972,26.8724,26.9464,27.0192,27.0908,27.1612,27.2304,27.2986,27.3656,27.4315,27.4963,27.56,27.6227,27.6844,27.7451,27.8048,27.8635,27.9212,27.978,28.0338,28.0887,28.1428,28.1959,28.2482,28.2996,28.3502,28.3999,28.4488,28.497,28.5443,28.5908,28.6366,28.6817,28.726,28.7695,28.8124,28.8545,28.896,28.9368,28.9769,29.0163,29.0551,29.0933,29.1308,29.1678,29.2041,29.2398,29.2749,29.3095,29.3435,29.3769,29.4098,29.4421,29.474,29.5053,29.536,29.5663,29.5961,29.6254,29.6542,29.6825,29.7104,29.7378,29.7647,29.7913,29.8173,29.843,29.8682,29.893,29.9175,29.9415,29.9651,29.9883,30.0112,30.0336,30.0557,30.0775,30.0989,30.1199,30.1406,30.1609,30.1809,30.2006,30.22,30.239,30.2578,30.2762,30.2943,30.3121,30.3297,30.3469,30.3639,30.3806,30.397,30.4131,30.429,30.4446,30.4599,30.4751,30.4899,30.5045,30.5189,30.533,30.5469,30.5606,30.5741,30.5873,30.6003,30.6131,30.6257,30.6381,30.6503,30.6623,30.674,30.6856} 
```

and I am plotting it using

```
ListPlot[tempDep] 
```

What I want to do is to display this plot together with an exponential (that should look pretty much the same as this listPlot) in one graph. Can u help me out with this plz?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T02:52:29.083

You can use

```
f = Interpolate[tempDep] 
```

and then plot the graph of interpolating function with

```
Plot[f,{x,1,198}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T09:37:27.970

Perhaps something like this?

```
data = Table[Sin[x], {x, 0, 2 Pi, 0.3}];

Show[
 ListPlot[data, PlotStyle -> PointSize[0.02]],
 ListLinePlot[data,
   InterpolationOrder -> 2,
   PlotStyle -> Directive[Thick, Orange]]
] 
```

![Mathematica graphics](../Images/049ff0113b222487d5785952b267b894.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T12:10:26.263

It seems to me that your data obey something else, but if you want an exponential fit:

```
model    = a + b Exp[c + d x];
tempDep1 = Partition[Riffle[Range@Length@tempDep, tempDep], 2];
fit      = FindFit[tempDep1, model, {a, b, c, d}, x, Method -> NMinimize];
modelf   = Function[{x}, Evaluate[model /. fit]]
Plot[modelf[t], {t, 0, Length@tempDep}, Epilog -> Point@tempDep1] 
```

![enter image description here](../Images/ca28f3945de77e9f4869393c316b49bb.png)

# wpf - 相对源祖先类型是什么意思？

> ID：10572727
> 
> 赞同：0
> 
> 时间：2012-05-13T14:59:10.267
> 
> 标签：wpf, mvvm

在这里，我知道相对来源使用相对于其他来源获得价值，但我无法理解`RelativeSource AncestorType={x:Type UserControl}}`

```
Value="{Binding Path=DataContext.ItemOptions, RelativeSource={RelativeSource AncestorType={x:Type UserControl}} 
```

请解释一下。我认为这是微不足道的。你可以解释一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:01:58.987

它告诉 WPF 从当前控件向上遍历“父级”树并找到第一个类型为 UserControl 的控件。在这种情况下，绑定到该用户控件的 DataContext 的 ItemOptions 属性

# java - 在 Java 中模拟类分类的方法

> ID：10572729
> 
> 赞同：1
> 
> 时间：2012-05-13T14:59:11.360
> 
> 标签：java, oop, design-patterns

一些编程语言具有向类添加“类别”的特性（例如 Objective-C），这意味着在没有子类化的情况下向类添加新功能。

我真的觉得它很有用，但我无法想象在 Java 中模拟此功能的方法。

所以问题是：

在 Java 中模拟类类别看起来如何是一种优雅的模式？我真正想要的是达到同样的效果，而不是以同样的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:10:37.597

在 Java 8 中，您可能可以通过接口注入（向`interface`现有类添加新的 s）和默认方法（为方法提供默认实现）的组合来做到这一点`interface`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:40:43.893

您可以使用[AspectJ](http://www.eclipse.org/aspectj/)[的类型间声明](http://www.eclipse.org/aspectj/doc/released/progguide/language-interType.html)功能向现有类添加功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:09:06.797

我可以看到两种方式。

您可以使用动态代理。此功能意味着 JVM 在运行时为您“实现”接口，提供实现回调方法的能力，您可以在其中调用“真实”实现。

另一种方式是字节码工程。但恕我直言，第一种方法更容易。

# facebook - 嵌入式 Facebook 视频是否有“完整”事件？

> ID：10572731
> 
> 赞同：0
> 
> 时间：2012-05-13T14:59:21.510
> 
> 标签：facebook, video, embed

我想在 web 应用程序中嵌入一个 facebook 视频，但是当它结束时做一些事情。
与 YouTube API 播放器类似，我可以在嵌入式 FB 视频上收听任何“完整”事件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:47:02.133

一位朋友提醒我的一个解决方案/解决方法是将 mp4 嵌入 jwplayer 并连接到播放器的事件 API。

听起来它可能有效，但我宁愿使用更好的解决方案。

# asp.net - 自定义 .NET 成员资格

> ID：10572733
> 
> 赞同：0
> 
> 时间：2012-05-13T14:59:31.717
> 
> 标签：asp.net, security, c#-4.0, login, asp.net-membership

我使用 .net 会员资格，但我工作的一切我都想定制。

我想做的是：

1.  使用自定义字段创建自定义数据表 [用户]
2.  将当前数据导入新表
3.  创建关于我需要的一切的自定义类和函数 [用户]

我不确定 .net 会员是如何工作的，但是当我使用它时，它可能会发送加密的 cookie

```
var user = Membership.GetUser(); 
```

.Net 解密用户 cookie 并知道哪个用户是。

这是 .net 如何创建用户 AUTH cookie [http://prntscr.com/97043的屏幕截图](http://prntscr.com/97043)

但是每次用户logout-login，这个值都不一样。

所以我想知道的是：

1.  假设我想制作 100% 自定义网站，我如何制作自定义登录？
2.  你能告诉我关于申请自定义会员的所有安全问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:25:36.793

这些都不是必需的。您可以创建自己的用户表，而无需更改与成员资格或身份验证相关的任何内容。您只需确保您的 users 表有一个名为 AspNetUserID 或类似 uniqueidentifier (a guid) 类型的列。您将 MembershipUser 中的 ProviderUserKey 放入此表中，并通过从 Membership 中获取 ProviderUserKey 来查找用户表中的任何用户。

因此，例如，您可以这样做：

```
var userid = Membership.GetUser().ProviderUserKey;

// lookup your record in users based on userid above 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:40:31.913

实现自定义后端并不困难。您只需实现一个自定义`MembershipProvider`，在您认为合适的时候从您的用户表中存储和检索数据。见[MSDN](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)。此外，您不必完全重写[SqlMembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx)，您可以对其进行子类化并添加您正在寻找的功能。

如果你真的想在后端从头开始，这里有一些问题需要注意：

*   不要在任何地方以明文形式存储密码；散列它们。
*   [给你的密码加盐](http://www.aspheute.com/english/20040105.asp)
*   记录和监控密码重置

此外，您不必完全重写[SqlMembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx)，您可以对其进行子类化并添加您正在寻找的功能，并且您可能遇到的大多数问题都将在默认实现中涵盖。您可能只需稍微修改数据访问调用或存储过程以映射到您的表结构。您还可以将[SqlRoleProvider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlroleprovider.aspx)子类化，以便为您的站点提供基于角色的授权，而无需付出额外的努力。

至于前端组件，MSDN 也描述[了表单身份验证的工作原理](http://msdn.microsoft.com/en-us/library/ff647070.aspx)，但就我个人而言，我不会弄乱您自己的 cookie 方案。甚至像 Oauth for asp.net 这样的大型自定义实现仍然使用表单。查看[http://msdn.microsoft.com/en-us/library/system.web.security.sqlroleprovider.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.sqlroleprovider.aspx)

# javascript - Javascript getElement by href？

> ID：10572735
> 
> 赞同：54
> 
> 时间：2012-05-13T14:59:59.550
> 
> 标签：javascript, href, getelementsbytagname

我有下面的脚本

```
var els = document.getElementsByTagName("a");
for(var i = 0, l = els.length; i < l; i++) {
  var el = els[i];
  el.innerHTML = el.innerHTML.replace(/link1/gi, 'dead link');
} 
```

然而，这个搜索页面需要大约 20 秒，因为有很多链接。

但是，我只需要针对`a`具有特定 的 ' `href`，例如。“http://domain.com/”

所以理想情况下，我希望能够以与 jQuery 类似的方式执行此操作，但不使用框架。所以像

```
var els = document.getElementsByTagName("a[href='http://domain.com']"); 
```

我将如何执行此操作，以便仅搜索具有该匹配项的对象`href`？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2016-06-14T19:34:31.427

# 2016 年更新

自发布此问题以来已经有 4 年多了，事情取得了很大进展。

你**不能**使用：

```
var els = document.getElementsByTagName("a[href='http://domain.com']"); 
```

但你**可以**使用的是：

```
var els = document.querySelectorAll("a[href='http://domain.com']"); 
```

（**注：**浏览器支持见下文）

这将使您问题中的代码**完全按照您的预期**工作：

```
for (var i = 0, l = els.length; i < l; i++) {
  var el = els[i];
  el.innerHTML = el.innerHTML.replace(/link1/gi, 'dead link');
} 
```

`a[href^='http://domain.com']`如果您想要所有以**开头**的链接，您甚至可以使用选择器`'http://domain.com'`：

```
var els = document.querySelectorAll("a[href^='http://domain.com']");

for (var i = 0, l = els.length; i < l; i++) {
  var el = els[i];
  el.innerHTML = el.innerHTML.replace(/link/gi, 'dead link');
} 
```

见：[**演示**](https://jsbin.com/luqeyuh/edit?html,js,console,output)

## 浏览器支持

根据[Can I use](http://caniuse.com/queryselector)截至 2016 年 6 月的浏览器支持看起来相当不错：

[![caniuse.com/queryselector](../Images/1dc15d3111cbbcc5b28bb3fbb3afbe20.png)](https://i.stack.imgur.com/cIQXF.png) （有关最新信息，请参阅： [http ://caniuse.com/queryselector）](http://caniuse.com/queryselector)

**IE6**和**IE7**没有支持，但 [IE6 已经死了](http://www.ie6death.com/) ，IE7 很快就会拥有[0.68% 的市场份额](https://www.netmarketshare.com/browser-market-share.aspx?qprid=2&qpcustomd=0)。

**IE8**已经超过 7 年了，它**部分**支持 querySelectorAll - “部分”我的意思是你可以使用[CSS 2.1 选择器](http://caniuse.com/css-sel2)，如`[attr]`, `[attr="val"]`,和[CSS 3 选择器](http://caniuse.com/#feat=css-sel3)的一小部分，**幸运**的是包括： , ，所以**看起来 IE8 是我上面的例子很好。**`[attr~="val"]``[attr|="bar"]`**`[attr^=val]``[attr$=val]``[attr*=val]`**

 ******IE9**、**IE10**和**IE11**都毫无问题地**支持**querySelectorAll，**Chrome**、**Firefox**、**Safari**、**Opera**和**所有**其他主流浏览器（**桌面和移动**）也是如此。

换句话说，我们似乎可以安全地开始`querySelectorAll`在生产中使用了。

## 更多信息

有关详细信息，请参阅：

*   [https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)
*   [https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector)
*   [http://caniuse.com/queryselector](http://caniuse.com/queryselector)

另请参阅[此答案](https://stackoverflow.com/questions/23269785/whats-the-difference-between-queryall-and-queryselectorall/38245620#38245620)，了解它们**从 DOM 规范**`querySelectorAll`中删除时、、和之间的区别。`querySelector``queryAll``query`

 *** * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-13T15:07:53.217

在每个元素上读取和写入`innerHTML`属性可能非常昂贵，因此会导致速度变慢 - 它迫使浏览器“序列化”元素，然后您通过正则表达式运行该元素，然后再次“反序列化”。更糟糕的是，您正在为*每个* `a`元素都这样做，即使它不匹配。

相反，请尝试直接查看`a`元素的属性：

```
var els = document.getElementsByTagName("a");
for (var i = 0, l = els.length; i < l; i++) {
    var el = els[i];
    if (el.href === 'http://www.example.com/') {
        el.innerHTML = "dead link";
        el.href = "#";
    }
} 
```

**在具有更高 W3C 一致性的现代浏览器上进行**编辑**`document.querySelectorAll()`，您现在可以使用它来更有效地获取您想要的链接：**

 **```
var els = document.querySelectorAll('a[href^=http://www.example.com/]');
for (var i = 0, l = els.length; i < l; i++) {
    els[i].textContent = 'dead link';
    els[i].href = '#';
} 
```

但是，如果您希望匹配多个域名，或者例如，如果您想同时匹配这两个域名，那么这就不那么灵活`http:`了`https:`。********

# javascript - 我的 innerHTML 出现在它应该写入的 div 之前

> ID：10572736
> 
> 赞同：-1
> 
> 时间：2012-05-13T15:00:05.333
> 
> 标签：javascript, html, innerhtml

我目前正在为网页上的购物车编写一些非常基本的代码（它用于分配，我仅限于 JS、HTML 和 CSS）

我正在尝试填写一个表格，其中填充了一系列数组（Name[]、Quantity[] 和 Sum[]）中包含的任何内容。我已经有一个表，我正在写入的 div 在一个表中。然而，每当我运行网页时，表格及其内容总是作为单独的表格写在我之前。

我不完全确定出了什么问题，所以这里是代码： HTML：

```
 <table border="1">
        <thead>
        <tr>
           <th>Product</th>
           <th>Quantity</th>
           <th>Sum Total</th>
        </tr>
        </thead>
        <div id="cart"></div>
        </table> 
```

JavaScript：

```
 function ViewShoppingCart(){
        document.getElementById("cart").innerHTML = ""; // Empties the cart

        for (var i=0; i<Name.length; i++) {
            var tr= document.createElement("tr");
            document.getElementById("cart").appendChild(tr);
            var td= document.createElement("td");
            td.appendChild(document.createTextNode(Name[i]));
            tr.appendChild(td);
            var td1= document.createElement("td");
            td1.appendChild(document.createTextNode(Quantity[i])); 
            tr.appendChild(td1);
            var td2= document.createElement("td");
                    td2.appendChild(document.createTextNode("\u00A3"+parseFloat(Sum[i]).toFixed(2))); 
            tr.appendChild(td2);
            }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:02:33.183

[`<div>`不是 的有效子级`<table>`。](http://www.w3.org/TR/html5/the-table-element.html#the-table-element)浏览器正在重新排列代表您的标记的 DOM，以试图理解它。

如果您想在表格中使用 div，则该 div 必须位于 a[`<th>`](http://www.w3.org/TR/html5/the-th-element.html#the-th-element)或[`<td>`](http://www.w3.org/TR/html5/the-td-element.html#the-td-element)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:02:03.193

你的html是错误的。您不能将 a`<div>`放在`<table>`标签内。它需要在里面`<td>`。

# ios - SudzC iOS 自动编码 XML？

> ID：10572738
> 
> 赞同：0
> 
> 时间：2012-05-13T15:00:18.317
> 
> 标签：ios, sudzc

我在 iOS 应用程序中将 SudzC 用于 SOAP Web 服务。我面临的问题是，有一个自动生成的方法，其参数包含一个简单的 XML 有效负载。当我将 XML 有效负载作为 NSString 发送到参数时，它会自动将 XML 有效负载中的 & 转换为 & amp;

在此过程中，我没有手动使用任何编码。我该如何避免这种情况？任何帮助，将不胜感激。

编辑 - 这是根据请求自动生成和处理的代码部分

```
if(postData != nil) {
    [request setHTTPMethod: @"POST"];
    [request addValue: @"text/xml; charset=utf-8" forHTTPHeaderField: @"Content-Type"];        
    [request setHTTPBody: [postData dataUsingEncoding: NSUTF8StringEncoding]];
    if(self.logging) {
        NSLog(@"%@", postData);
    }
} 
```

谢谢

尼廷

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:13:43.547

好吧，简单的答案是您必须探索由 SudzC 生成的代码。但是提示是，当您请求或接收响应时，SudzC 代码可能正在某处清理您的代码，很可能是带有 serializeElement 的方法名称。如果它是一个 XML 请求，那么尝试从您的 main 方法和 Soap Create 方法开始跳转到几个定义（只是一个猜测，我不确定您的代码是如何工作的。）尝试找到类似的代码并相应地修改它。

```
[[self.YourXML stringByReplacingOccurrencesOfString:@"\"" withString:@"&quot;"] stringByReplacingOccurrencesOfString:@"&" withString:@"&amp;"]]; 
```

# c# - .NET Regex.Matches 在查找与包含 * () 的模式的多个匹配项时表现不如预期

> ID：10572739
> 
> 赞同：1
> 
> 时间：2012-05-13T15:00:19.997
> 
> 标签：c#, .net, regex

我的目标是找到文本中某个模式的所有匹配项。假设我的模式是：

```
h.*o 
```

这意味着我正在搜索以`'h'`结尾开头`'o'`并在其间包含任意数量的字符（也为零）的任何文本。

我的理解是该方法`Matches()`将根据描述提供多个匹配项（请参阅[MSDN](http://msdn.microsoft.com/de-de/library/e7sf90t3.aspx)）。

```
const string input = "hello hllo helo";
Regex regex = new Regex("h.*o");

var result = regex.Matches(input);
foreach (Match match in result)
{
    Console.WriteLine(match.Value);
} 
```

我的期望是：

```
1\. "hello"
2\. "hllo"
3\. "helo"
4\. "hello hllo"
5\. "hello hllo helo" 
```

令我惊讶的是，返回的匹配只包含一个字符串——整个输入字符串。

```
"hello hllo helo" 
```

**问题：**

1.  哪一个是错的：我的期望，我的正则表达式或类的使用？
2.  如何达到我的示例所示的结果？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T15:05:04.163

这`*`是*贪婪*的- 它会尝试匹配尽可能多的字符。您可以通过问号来使其*不情愿*`o`，但更好的解决方案是从列表中排除`.`匹配的字符，如下所示：

```
h[^o]*o 
```

这是一个非常好的解释贪婪与不情愿的[链接。](http://www.regular-expressions.info/repeat.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T15:12:01.600

`*`除了贪心的事实之外，该`Matches`方法只找到不重叠的匹配；也就是说，它会从上次匹配的位置开始查找每个后续匹配。从[MSDN 库](http://msdn.microsoft.com/en-us/library/h9ee7wwd)：

> 通常，正则表达式引擎在前一个匹配停止的位置开始搜索下一个匹配。

因此，即使您使用`*?`or`h[^o]*o`代替`*`，它仍然只能找到“hello”、“hllo”和“helo”。

我不知道是否`Regex`有一个内置方法可以有效地找到与指定模式匹配的*所有*可能的子字符串，但是您可以自己遍历所有可能的子字符串并检查每个子字符串是否匹配：

```
const string input = "hello hllo helo";
Regex regex = new Regex("^h.*o$");

for (int startIndex = 0; startIndex < input.Length - 1; startIndex++)
{
    for (int endIndex = startIndex + 1; endIndex <= input.Length; endIndex++)
    {
        string substring = input.Substring(startIndex, endIndex - startIndex);
        if (regex.IsMatch(substring))
            Console.WriteLine(substring);
    }
} 
```

输出：

```
hello
hello hllo
hello hllo helo
hllo
hllo helo
helo 
```

请注意，我在正则表达式中添加了`^`and`$`以确保它匹配整个`substring`. 而不仅仅是`substring`.

# macos - 为什么这个简单的 CoreMIDI 程序不产生 MIDI 输出？

> ID：10572747
> 
> 赞同：20
> 
> 时间：2012-05-13T15:01:12.387
> 
> 标签：macos, midi, core-foundation, coremidi

这是一个发送 MIDI 数据的极其简单的 CoreMIDI OS X 应用程序。问题是它不起作用。它编译得很好，并且可以运行。它不报告任何错误，也不会崩溃。创建的源在 MIDI 监视器中可见。但是，**没有 MIDI 数据出来**。

有人可以让我知道我在这里做错了什么吗？

```
#include <CoreMIDI/CoreMIDI.h>

int main(int argc, char *args[])
{
    MIDIClientRef   theMidiClient;
    MIDIEndpointRef midiOut;
    MIDIPortRef     outPort;
    char pktBuffer[1024];
    MIDIPacketList* pktList = (MIDIPacketList*) pktBuffer;
    MIDIPacket     *pkt;
    Byte            midiDataToSend[] = {0x91, 0x3c, 0x40};
    int             i;

    MIDIClientCreate(CFSTR("Magical MIDI"), NULL, NULL,
                     &theMidiClient);
    MIDISourceCreate(theMidiClient, CFSTR("Magical MIDI Source"),
                     &midiOut);
    MIDIOutputPortCreate(theMidiClient, CFSTR("Magical MIDI Out Port"),
                         &outPort);

    pkt = MIDIPacketListInit(pktList);
    pkt = MIDIPacketListAdd(pktList, 1024, pkt, 0, 3, midiDataToSend);

    for (i = 0; i < 100; i++) {
        if (pkt == NULL || MIDISend(outPort, midiOut, pktList)) {
            printf("failed to send the midi.\n");
        } else {
            printf("sent!\n");
        }
        sleep(1);
    }

return 0;
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-13T17:55:40.840

您正在调用`MIDISourceCreate`创建一个虚拟 MIDI 源。

这意味着您的源将出现在其他应用程序的 MIDI 设置 UI 中，并且这些应用程序可以选择是否收听您的源。你的 MIDI 不会被发送到任何物理 MIDI 端口，除非其他一些应用程序碰巧在那里引导它。这也意味着您的应用程序无法选择它发送的 MIDI 去向。我假设这就是你想要的。

[MIDISourceCreate 的文档](https://developer.apple.com/library/mac/documentation/MusicAudio/Reference/CACoreMIDIRef/MIDIServices/CompositePage.html#//apple_ref/c/func/MIDISourceCreate)说：

> 创建虚拟源后，使用 MIDIReceived 将 MIDI 消息从虚拟源传输到连接到虚拟源的任何客户端。

所以，做两件事：

*   删除创建输出端口的代码。你不需要它。
*   更改`MIDISend(outPort, midiOut, pktList)`为：`MIDIReceived(midiOut, pktlist)`。

那应该可以解决您的问题。

那么输出端口有什么用呢？如果你想将你的 MIDI 数据指向一个特定的目的地——也许是一个物理 MIDI 端口——你不会创建一个虚拟 MIDI 源。反而：

1.  调用`MIDIOutputPortCreate()`以创建输出端口
2.  使用`MIDIGetNumberOfDestinations()`and`MIDIGetDestination()`获取目的地列表并找到您感兴趣的目的地。
3.  要将 MIDI 发送到一个目的地，请调用`MIDISend(outputPort, destination, packetList)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-24T16:21:51.820

我只是把这个留在这里供我自己参考。这是一个 100% 基于您的完整示例，但包括另一方（接收）、我的错误 C 代码和接受的答案的更正（当然）。

```
#import "AppDelegate.h"

@implementation AppDelegate

@synthesize window = _window;

#define NSLogError(c,str) do{if (c) NSLog(@"Error (%@): %u:%@", str, (unsigned int)c,[NSError errorWithDomain:NSMachErrorDomain code:c userInfo:nil]); }while(false)

static void spit(Byte* values, int length, BOOL useHex) {
    NSMutableString *thing = [@"" mutableCopy];
    for (int i=0; i<length; i++) {
        if (useHex)
            [thing appendFormat:@"0x%X ", values[i]];
        else
            [thing appendFormat:@"%d ", values[i]];
    }
    NSLog(@"Length=%d %@", length, thing);
}

- (void) startSending {
    MIDIEndpointRef midiOut;
    char pktBuffer[1024];
    MIDIPacketList* pktList = (MIDIPacketList*) pktBuffer;
    MIDIPacket     *pkt;
    Byte            midiDataToSend[] = {0x91, 0x3c, 0x40};
    int             i;

    MIDISourceCreate(theMidiClient, CFSTR("Magical MIDI Source"),
                     &midiOut);
    pkt = MIDIPacketListInit(pktList);
    pkt = MIDIPacketListAdd(pktList, 1024, pkt, 0, 3, midiDataToSend);

    for (i = 0; i < 100; i++) {
        if (pkt == NULL || MIDIReceived(midiOut, pktList)) {
            printf("failed to send the midi.\n");
        } else {
            printf("sent!\n");
        }
        sleep(1);
    }
}

void ReadProc(const MIDIPacketList *packetList, void *readProcRefCon, void *srcConnRefCon)
{
    const MIDIPacket *packet = &packetList->packet[0];

    for (int i = 0; i < packetList->numPackets; i++)
    {

        NSData *data = [NSData dataWithBytes:packet->data length:packet->length];
        spit((Byte*)data.bytes, data.length, YES);

        packet = MIDIPacketNext(packet);
    }
}

- (void) setupReceiver {
    OSStatus s;
    MIDIEndpointRef virtualInTemp;
    NSString *inName = [NSString stringWithFormat:@"Magical MIDI Destination"];
    s = MIDIDestinationCreate(theMidiClient, (__bridge CFStringRef)inName, ReadProc,  (__bridge void *)self, &virtualInTemp);
    NSLogError(s, @"Create virtual MIDI in");
}

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    MIDIClientCreate(CFSTR("Magical MIDI"), NULL, NULL,
                     &theMidiClient);
    [self setupReceiver];
    [self startSending];

}

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-30T10:04:31.030

其他人正在跳过的一个小细节：`time`参数 of对某些音乐应用程序`MIDIPacketListAdd` **很**重要。

以下是如何检索它的示例：

```
#import <mach/mach_time.h>
MIDITimeStamp midiTime = mach_absolute_time(); 
```

资料来源：[苹果文档](https://developer.apple.com/documentation/coremidi/miditimestamp)

然后，应用于此处的其他示例：

```
pktBuffer[1024];
MIDIPacketList *pktList = (MIDIPacketList*)pktBuffer;
MIDIPacket *pktPtr = MIDIPacketListInit(pktList);
MIDITimeStamp midiTime = mach_absolute_time();
Byte midiDataToSend[] = {0x91, 0x3c, 0x40};
pktPtr = MIDIPacketListAdd(pktList, sizeof(pktList), pktPtr, midiTime, sizeof(midiDataToSend), midiDataToSend); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-05T18:18:27.797

考虑您自己的 midi 客户端创建应用程序可能会崩溃，或者发送 midi 的主机也可能崩溃。您可以通过检查客户端/目的地是否已经存在，然后通过处理单例分配来更轻松地处理这个问题。当您的 Midi 客户端存在但无法正常工作时，这是因为您需要告诉 CoreMidi 您的服装制作客户端能够处理什么以及当主机发送客户端大量使用时间戳时它将有什么延迟（又名ableton 和其他） .

在你的 .h 文件中

```
#import <CoreMIDI/CoreMIDI.h>
#import <CoreAudio/HostTime.h>

@interface YourVirtualMidiHandlerObject : NSObject 

@property (assign, nonatomic) MIDIClientRef midi_client;
@property (nonatomic) MIDIEndpointRef outSrc;
@property (nonatomic) MIDIEndpointRef inSrc;
- (id)initWithVirtualSourceName:(NSString *)clientName;

@end 
```

在你的 .m 文件中

```
@interface YourVirtualMidiHandlerObject () {
   MIDITimeStamp midiTime;
   MIDIPacketList pktList;
}
@end 
```

您也可以在 .m 文件中以下列方式准备启动虚拟客户端

```
@implementation YourVirtualMidiHandlerObject 

// this you can call in dealloc or manually 
// else where when you stop working with your virtual client
-(void)teardown {
    MIDIEndpointDispose(_inSrc);
    MIDIEndpointDispose(_outSrc);
    MIDIClientDispose(_midi_client);
}

- (id)initWithVirtualSourceName:(NSString *)clientName { 
    if (self = [super init]) {
        OSStatus status = MIDIClientCreate((__bridge CFStringRef)clientName, (MIDINotifyProc)MidiNotifyProc, (__bridge void *)(self), &_midi_client);

        BOOL isSourceLoaded = NO;
        BOOL isDestinationLoaded = NO;

        ItemCount sourceCount = MIDIGetNumberOfSources();
        for (ItemCount i = 0; i < sourceCount; ++i) {
            _outSrc = MIDIGetSource(i);
            if ( _outSrc != 0 ) {
                if ([[self getMidiDisplayName:_outSrc] isEqualToString:clientName] && !isSourceLoaded) {
                    isSourceLoaded = YES; 
                    break; //stop looping thru sources if it is existing
                }
            }
        }

        ItemCount destinationCount = MIDIGetNumberOfDestinations();
        for (ItemCount i = 0; i < destinationCount; ++i) {
            _inSrc = MIDIGetDestination(i);
            if (_inSrc != 0) {
                if ([[self getMidiDisplayName:_inSrc] isEqualToString:clientName] && !isDestinationLoaded) {
                    isDestinationLoaded = YES;
                    break; //stop looping thru destinations if it is existing
                }
            }
        }

        if(!isSourceLoaded) {
            //your costume source needs to tell CoreMidi what it is handling
            MIDISourceCreate(_midi_client, (__bridge CFStringRef)clientName, &_outSrc);
            MIDIObjectSetIntegerProperty(_outSrc, kMIDIPropertyMaxTransmitChannels, 16);
            MIDIObjectSetIntegerProperty(_outSrc, kMIDIPropertyTransmitsProgramChanges, 1);
            MIDIObjectSetIntegerProperty(_outSrc, kMIDIPropertyTransmitsNotes, 1);
            // MIDIObjectSetIntegerProperty(_outSrc, kMIDIPropertyTransmitsClock, 1);
            isSourceLoaded = YES;
        }

        if(!isDestinationLoaded) {
            //your costume destination needs to tell CoreMidi what it is handling
            MIDIDestinationCreate(_midi_client, (__bridge CFStringRef)clientName, midiRead, (__bridge void *)(self), &_inSrc);
            MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyAdvanceScheduleTimeMuSec, 1); // consider more 14ms in some cases
            MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyReceivesClock, 1);
            MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyReceivesNotes, 1);
            MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyReceivesProgramChanges, 1);
            MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyMaxReceiveChannels, 16);
            // MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyReceivesMTC, 1);
            // MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyReceivesBankSelectMSB, 1);
            // MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertyReceivesBankSelectLSB, 1);
            // MIDIObjectSetIntegerProperty(_inSrc, kMIDIPropertySupportsMMC, 1);
            isDestinationLoaded = YES;
        }

        if (!isDestinationLoaded || !isSourceLoaded) {
            if (status != noErr ) {
                NSLog(@"Failed creation of virtual Midi client \"%@\", so disposing the client!",clientName);
                MIDIClientDispose(_midi_client);
            }
        }
    }
    return self;
}

// Returns the display name of a given MIDIObjectRef as an NSString
-(NSString *)getMidiDisplayName:(MIDIObjectRef)obj {
    CFStringRef name = nil;
    if (noErr != MIDIObjectGetStringProperty(obj, kMIDIPropertyDisplayName, &name)) return nil;
    return (__bridge NSString *)name;
} 
```

对于那些试图在创建过程中读取速度（midi 传输）并为虚拟目的地设置属性的人...不要忘记时间戳随数据包一起发送，但一个数据包可以包含多个相同类型的命令，甚至几个时钟命令。在构建时钟计数器以查找 bpm 速度时，您必须考虑在计算之前至少计算其中的 12 个。当您只使用其中的 3 个时，您实际上是在测量自己的缓冲区读取处理延迟，而不是真正的时间戳。如果 midi 发件人未能正确设置时间戳，您的读取程序（回调）将处理时间戳...

```
void midiRead(const MIDIPacketList * pktlist, void * readProcRefCon, void * srcConnRefCon) {

    const MIDIPacket *pkt = pktlist->packet;

    for ( int index = 0; index < pktlist->numPackets; index++, pkt = MIDIPacketNext(pkt) ) {
        MIDITimeStamp timestamp = pkt->timeStamp;
        if ( !timestamp ) timestamp = mach_absolute_time();
        if ( pkt->length == 0 ) continue;

        const Byte *p = &pkt->data[0];
        Byte functionalDataGroup = *p & 0xF0;

        // Analyse the buffered bytes in functional groups is faster
        // like 0xF will tell it is clock/transport midi stuff
        // go in detail after this will shorten the processing
        // and it is easier to read in code
        switch (functionalDataGroup) {
            case 0xF : {
                   // in here read the exact Clock command
                   // 0xF8 = clock
               }
               break;
            case ... : {
                   // do other nice grouped stuff here, like reading notes
               }
               break;
            default  : break;
        }
    }
} 
```

不要忘记客户端需要一个回调来处理内部通知。

```
void MidiNotifyProc(const MIDINotification* message, void* refCon) {

    // when creation of virtual client fails we despose the whole client
    // meaning unless you need it you can ignore added/removed notifications
    if (message->messageID != kMIDIMsgObjectAdded &&
        message->messageID != kMIDIMsgObjectRemoved) return;

    // reactions to other midi notications you gonna trigger here..
} 
```

然后你可以发送midi...

```
-(void)sendMIDICC:(uint8_t)cc Value:(uint8_t)v ChZeroToFifteen:(uint8_t)ch {

    MIDIPacket *packet = MIDIPacketListInit(&pktList);
    midiTime = packet->timeStamp;

    unsigned char ctrl[3] = { 0xB0 + ch, cc, v };
    while (1) {
        packet = MIDIPacketListAdd(&pktList, sizeof(pktList), packet, midiTime, sizeof(ctrl), ctrl);
        if (packet != NULL) break;
        // create an extra packet to fill when it failed before
        packet = MIDIPacketListInit(&pktList);
    }

    // OSStatus check = // you dont need it if you don't check failing
    MIDIReceived(_outSrc, &pktList);
} 
```

# objective-c - IBOutletCollection 和初始化自定义类实例

> ID：10572750
> 
> 赞同：0
> 
> 时间：2012-05-13T15:01:17.557
> 
> 标签：objective-c, ios, iboutlet, iboutletcollection

我正在使用 MHRotaryKnob 类并且无法配置它，以便多个插座具有相同的默认设置。使用 IBOutlet 让它与一个实例一起工作是没有问题的，但现在它正在寻找 NSArray 中的 MHRotaryKnob 类的属性。

我究竟如何在实现中定义旋转旋钮，以便将设置中继到连接到 IBOutletCollection 的所有控件？实现中的属性在 MHRotaryKnob.m 中定义，但现在编译器正在 NSArray 中查找它。

## 视图控制器.h

```
#import <UIKit/UIKit.h>
#import "MHRotaryKnob.h"

@interface CBViewController : UIViewController

@property (nonatomic, retain) IBOutletCollection (MHRotaryKnob) NSArray *rotaryKnob; 
```

## 视图控制器.m

```
#import "ViewController.h"
#import "MHRotaryKnob.h"

@implementation CBViewController;

@synthesize rotaryKnob;

- (void)viewDidLoad
{
[super viewDidLoad];

rotaryKnob.interactionStyle = MHRotaryKnobInteractionStyleSliderVertical;
rotaryKnob.scalingFactor = 1.5f;
rotaryKnob.defaultValue = rotaryKnob.value;
rotaryKnob.resetsToDefault = YES;
rotaryKnob.backgroundColor = [UIColor whiteColor];
rotaryKnob.backgroundImage = [UIImage imageNamed:@"knob_passive.png"];
[rotaryKnob setKnobImage:[UIImage imageNamed:@"knob_passive.png"] forState:UIControlStateNormal];
[rotaryKnob setKnobImage:[UIImage imageNamed:@"knob_highlighted.png"] forState:UIControlStateHighlighted];
[rotaryKnob setKnobImage:[UIImage imageNamed:@"Knob Disabled.png"] forState:UIControlStateDisabled];
rotaryKnob.knobImageCenter = CGPointMake(35.0f, 32.0f);
[rotaryKnob addTarget:self action:@selector(rotaryKnobDidChange) forControlEvents:UIControlEventValueChanged]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:44:53.180

An`IBOutletCollection`是一个集合，因此`NSArray`在这种情况下它由 an 支持。

因此，将 ivar 重命名为`rotaryKnobs`以明确这一事实可能会有所帮助，然后像这样使用它

```
for (MHRotaryKnob *rotaryKnob in self.rotaryKnobs) {
    rotaryKnob.interactionStyle = MHRotaryKnobInteractionStyleSliderVertical;
    rotaryKnob.scalingFactor    = 1.5f;
    rotaryKnob.defaultValue     = rotaryKnob.value;
    rotaryKnob.resetsToDefault  = YES;
    rotaryKnob.backgroundColor  = [UIColor whiteColor];
    rotaryKnob.backgroundImage  = [UIImage imageNamed:@"knob_passive.png"];
    rotaryKnob.knobImageCenter  = CGPointMake(35.0f, 32.0f);
    [rotaryKnob setKnobImage:[UIImage imageNamed:@"knob_passive.png"]     forState:UIControlStateNormal];
    [rotaryKnob setKnobImage:[UIImage imageNamed:@"knob_highlighted.png"] forState:UIControlStateHighlighted];
    [rotaryKnob setKnobImage:[UIImage imageNamed:@"Knob Disabled.png"]    forState:UIControlStateDisabled];
    [rotaryKnob addTarget:self action:@selector(rotaryKnobDidChange) forControlEvents:UIControlEventValueChanged];
} 
```

# java - 通过网络发送活动信息

> ID：10572753
> 
> 赞同：0
> 
> 时间：2012-05-13T15:01:30.830
> 
> 标签：java, android

我想通过 tcp/ip 发送我在 onLocationChanged() 中获得的数据。我也可以读取位置和网络工作：我可以连接和发送数据。问题是：网络不能在活动线程中，但 onLocationChanged() 必须。现在这是我的问题：如何从活动线程获取位置信息到网络线程？

提前致谢。

编辑：我必须一遍又一遍地发送数据，不想每秒重新连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:03:26.053

```
onLocationChanged()
{
     new Thread(){
              public void run(){
                       //POST YOUR DATA.
              }
     }.start();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:05:23.650

您将需要启动一个单独的线程或使用 an`AsyncTask`来执行网络操作，因为您不允许将 UI 线程与可能长时间运行的操作捆绑在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T21:31:19.140

好的，好像我可以直接从活动线程访问在网络线程中创建的套接字。（至少我还没有得到任何虚假行为......）

起初它不起作用，但那是因为一个相当不相关的错误。

# php - 如何在 MySQL 中的多个表中进行搜索

> ID：10572765
> 
> 赞同：1
> 
> 时间：2012-05-13T15:02:36.897
> 
> 标签：php, mysql, search, full-text-indexing

# 详细的

想象一下，我们有如下表格：

![在此处输入图像描述](../Images/bf62f0bfff85e3e355056bc1030ba12e.png)

如您所见，`questions`通过外键与 4 个表连接。

将[Datatables](http://datatables.net/index)与[服务器端处理](http://datatables.net/release-datatables/examples/server_side/server_side.html)（我修改给定的 php 代码以处理多个表）一起用于客户端。

# 问题

我想要做的是：当用户搜索某些东西时，客户端通过 ajax 将关键字发送到服务器端。处理官网搜索的代码（[页面链接](http://datatables.net/release-datatables/examples/server_side/server_side.html)）如下所示：

```
$sWhere = "";
if ( isset($_GET['sSearch']) && $_GET['sSearch'] != "" )
{
    $sWhere = "WHERE (";
    for ( $i=0 ; $i<count($aColumns) ; $i++ )
    {
        $sWhere .= "`".$aColumns[$i]."` LIKE '%".mysql_real_escape_string( $_GET['sSearch'] )."%' OR ";
    }
    $sWhere = substr_replace( $sWhere, "", -3 );
    $sWhere .= ')';
} 
```

我想修改这部分来处理多表处理。

例如：如果用户输入了某个部分的名称（名称位于`sections`表、`section`列中），我如何找到`questions`与该部分相关的问题（从表中）？这可能只需要一个查询吗？

任何建议将不胜感激 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:34:43.463

您可以使用 Union Select 并组合您的结果。只需在先前的选择中使用与相同选定列的联合：

```
$sWhere = "";
if ( isset($_GET['sSearch']) && $_GET['sSearch'] != "" )
{
    $sWhere = "WHERE (";
    for ( $i=0 ; $i<count($aColumns) ; $i++ )
    {
        $sWhere .= "`".$aColumns[$i]."` LIKE '%".mysql_real_escape_string( $_GET['sSearch'] )."%' OR ";
    }
    $sWhere = substr_replace( $sWhere, "", -3 );
    $sWhere .= ')';

    $sWhere .= ' UNION SELECT question FROM questions , sections WHERE ( sections.`section` LIKE '%".mysql_real_escape_string( $_GET['sSearch'] )."%' AND questions.section = sections.id ) "; //this union in select columns count  must be same with your previous Select columns count 

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T16:22:32.643

您根本不应该为此使用 LIKE 运算符，尤其是当这些表可以增长到超过几百行时。LIKE 前面带有通配符（例如`LIKE '%key'`or `LIKE '%key%'`）不能使用任何索引来优化搜索，这意味着这些查询可能会变得非常慢，只有数千行。

理想情况下，您应该构建一个非规范化结构，在一行中包含任何可文本搜索的信息，然后将其放入全文搜索中，并将其用于查询。它可能是`FULLTEXT`MySQL 在 MyISAM 表中本机支持的关键，或者是外部全文搜索引擎，例如 Sphinx (http://www.sphinxsearch.com/)。

如果您将其非规范化为单个结构，您将能够非常轻松地完成所有查询。

这并不意味着您应该摆脱基本结构，而是为了为此类搜索构建有效的解决方案，您将不得不引入一些数据重复。

# jakarta-ee - JPA：单个数据库字段，在同一实体上以不同形式多次

> ID：10572767
> 
> 赞同：2
> 
> 时间：2012-05-13T15:03:14.007
> 
> 标签：jakarta-ee, jpa, entity

就像在一个主题中一样......我如何从一个实体中的数据库中获取相同的字段，但有两种不同的类型......

IE

```
@Entity
@Table(name = "ROOMS")
public class Rooms implements Serializable {
private static final long serialVersionUID = 1L;

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "ID_ROOM")

private int idRoom;

@ManyToOne
@JoinColumn(name = "ID_HOTEL")
private Hotel hotel;
//and right here I need a something like

@JoinColumn(name = "ID_HOTEL")
private int hotelId; 
```

但是....我只需要它来使用 EL 进行一些搜索...我不需要它来插入或更新....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T19:05:27.847

您的hotelId 是@Basic，因此您必须使用@Column 而不是@JoinColumn。您还应该将其中一列设置为可插入/可更新=false，因为您要对其进行两次映射。

# ubuntu - plot() 函数导致 Scilab 在 Ubuntu 11.10 中冻结

> ID：10572777
> 
> 赞同：0
> 
> 时间：2012-05-13T15:05:02.917
> 
> 标签：ubuntu, plot, scilab

每当我尝试在 Ubuntu 11.10 中运行 plot() 函数时，Scilab 5.3.3 就会冻结。任何人都可以提出解决方案吗？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T07:27:19.490

这是由于 Ubuntu 的 mesa 包中的一个错误。Ubuntu 人介绍了一个破坏台面的补丁（Debian 没有这个错误）。

看：

[https://bugs.launchpad.net/ubuntu/+source/mesa/+bug/965798](https://bugs.launchpad.net/ubuntu/+source/mesa/+bug/965798)

[https://jogamp.org/bugzilla/show_bug.cgi?id=566](https://jogamp.org/bugzilla/show_bug.cgi?id=566)

修复方法是将 Ubuntu 更新到最新版本。

# java - 类使用

> ID：10572783
> 
> 赞同：0
> 
> 时间：2012-05-13T15:06:01.447
> 
> 标签：java

我想知道使用这种语法有什么用处。我写了一个简单的程序如下，

```
public class Sample{

    public static void main(String[] args) {
        Class<? extends Collection> someCollectionClass = someMethod();
    }

    public static ArrayList someMethod() {
        return new ArrayList();
    }
} 
```

为什么它显示编译错误，

```
- Collection is a raw type. References to generic type Collection<E> should be 
 parameterized
- Type mismatch: cannot convert from ArrayList to Class<? extends Collection> 
```

在这里，该类是否期望一个扩展集合的类（它实际上是它接受的对象知道，是吗？）。那么 ArrayList 有什么问题呢？

如果我将某些东西声明为，它也是有效的 if 语法吗`Class<? extends T>`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T15:08:31.273

因为`ArrayList`不是一个`Class`。也许你的意思是`someMethod().getClass()`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:14:43.577

第一条错误消息源于声明中的类型参数：

```
Class<? extends Collection> someCollectionClass = someMethod(); 
```

该类型`Collection`在 Java 中被称为“原始类型”，因为接口`Collection`采用类型参数，但在声明中没有给出。这同样适用于`ArrayList`.

但是，该声明实际上并没有像我猜你认为的那样做......你实际上声明了一个名为 的变量`someCollectionClass`，你可以为其分配 type 的实例`Class<? extends Collection>`，即（反射）类描述符（特定类型）。第二条错误消息是编译器抱怨：不能将类型的实例`ArrayList`（由返回`someMethod`）分配给变量，其类型被声明为“只允许`Class<...>`（这是一种描述类的特殊 Java 运行时类型）的实例。

```
Collection someCollection = someMethod(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T15:11:17.737

someMethod 正在返回 List 类型的实例，您试图将其分配给期望 Collection 类而不是实例的变量。以下代码应该可以工作。

```
Collection someCollectionClass = someMethod(); 
```

# .net - MS Jet Oledb ComSys 是什么类型的源？

> ID：10572785
> 
> 赞同：0
> 
> 时间：2012-05-13T15:06:08.283
> 
> 标签：.net, database, oledb, jet

我试图了解使用各种数据库进行研究，最近我一直在研究 Jet OLEDB。在一些源代码中，我看到了这个：

```
Provider=Microsoft.Jet.OLEDB.4.0;
Data Source=ComSys; 
```

这是什么 ComSys？它是通往某个地方的路径吗？如果有，在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:19:53.607

它是数据源的名称，在控制面板 + 管理工具 + 数据源 (ODBC) 中配置。DSN 指定 ODBC 驱动程序和它需要的任何配置。就像 Jet 驱动程序的 .mdb 路径一样。实际的配置数据存储在注册表中，并在运行时通过数据源名称返回。因此，您不必在代码中对数据库进行任何硬编码，并且可以将其留给管理员来设置和调整映射。

# openlayers - OpenLayers 中的复合（复杂）功能

> ID：10572786
> 
> 赞同：2
> 
> 时间：2012-05-13T15:06:18.190
> 
> 标签：openlayers

我玩了一下 OpenLayers，想知道是否有办法创建自定义“功能”。我想要完成的是具有多个部分的功能，或者是否有办法将多个功能“绑定”在一起。

我想要完成的是，我想在地图上的某个位置显示各种数量的数据，并且我想将它包裹在边框中（有点像标注）。

据我所知，有几种方法可以做到这一点，但每种方法都有自己的缺点：

*   生成具有内容+边框的单个图像服务器端。这种方法的问题是我在服务器上浪费了大量的计算时间，并且为地图上的每个点提供了部分基本相同的图片。
*   使用多种功能。这里的问题是，当我在鼠标悬停时修改显示的数据时，我只能对鼠标悬停的一个特征做出反应，而不是对所有特征做出反应。

那么有没有办法在 OpenLayers 中创建自定义功能？我该怎么做呢？或者是否有更简单的方法来处理我尚未发现的复合/复杂功能？

提前致谢！

# jquery - 如何在jquerymobile中禁用后退按钮

> ID：10572787
> 
> 赞同：2
> 
> 时间：2012-05-13T15:06:19.483
> 
> 标签：jquery, jquery-mobile

> **可能重复：**
> [如何自定义（或禁用）JQueryMobile 中的自动“后退”按钮](https://stackoverflow.com/questions/5478156/how-to-customize-or-disable-the-automatic-back-button-in-jquerymobile)

嗨，我正在尝试为移动设备开发一个网页，我的要求是

用户首先从页面 A 转到页面 B，然后他不能通过单击浏览器的后退按钮回到页面 B。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T17:26:04.657

如果您想防止使用浏览器后退按钮返回上一页，您可以使用此代码段

```
<head>
<script type="text/javascript">
    window.history.forward();
    function noBack() { window.history.forward(); }
</script>
</head>
<body onload="noBack();"
    onpageshow="if (event.persisted) noBack();" onunload=""> 
```

实际来源 - [http://viralpatel.net/blogs/2009/11/disable-back-button-browser-javascript.html](http://viralpatel.net/blogs/2009/11/disable-back-button-browser-javascript.html)

# c# - MVC3 重载索引操作得到 500 个错误

> ID：10572788
> 
> 赞同：1
> 
> 时间：2012-05-13T15:06:31.990
> 
> 标签：c#, asp.net-mvc-3

我在控制器中重载索引操作时遇到了一些问题。在控制器中，我有以下操作：

```
public ActionResult Index(int id)
{
    return View();
}

public ActionResult Index()
{
    return View();
} 
```

转到任一 URL（控制器名称/或控制器名称/1）都会导致 500 错误。但是，当我使用：

```
public ActionResult Index(int? id)
{
    return View();
} 
```

controllername/ URL 有效，但 controllername/1 导致 404 错误。我的 global.asax 很普通：

```
routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
); 
```

我想做的是能够处理空 id 以及整数 id 值。任何建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:14:45.583

我认为您需要为此明确路线：

```
routes.MapRoute(
    "ControllerName", // Route name
    "ControllerName/{id}", // URL with parameters
    new { controller = "ControllerName", action = "Index", id = UrlParameter.Optional }
); 
```

如果它不起作用，您可能需要更明确并在之前添加：

```
routes.MapRoute(
    "ControllerName",
    "ControllerName",
    new { controller = "ControllerName", action = "Index"}
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:23:14.130

我认为您在这里不需要重载，而只需要在索引操作中检查空值。重载动作不是一个好主意，因为框架不知道在空索引的情况下调用哪个动作。

为每个动作重载添加自定义路由将导致响应时间变慢，因为要解决的自定义路由太多。

# java - 使用我的位置纬度经度和DB纬度经度计算距离

> ID：10572803
> 
> 赞同：1
> 
> 时间：2012-05-13T15:07:51.140
> 
> 标签：java, android, json

使用我的位置纬度经度和 DB 纬度经度计算距离。但总是错误“应用程序 AndroidGoogleMaps（进程 com.androidhive.googlemaps）已意外停止。请重试。”

```
public class AndroidGoogleMapsActivity extends MapActivity {

public int mm[][]= new int[100][100];
double[][] rtdist= new double[50][2]; 
double[][] okdist= new double[50][2]; 
public  GeoPoint[] endpp = new GeoPoint[100]; 
private static String KEY_SUCCESS = "success";
private MyLocationOverlay mylayer;
private MapController mapController;
private MapView mapView;
protected GeoPoint geoPoint;

   @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    findViews();
    setupMap();
}

private void findViews() {
        mapView = (MapView) findViewById(R.id.mapView);
        mapController = mapView.getController();
        mapView.setBuiltInZoomControls(true);           
}

private void setupMap() {
 List<Overlay> overlays = mapView.getOverlays();
    mylayer = new MyLocationOverlay(this, mapView);
    mylayer.runOnFirstFix(new Runnable() {
        public void run() {
            // Zoom in to current location
            mapView.setTraffic(true);
            mapController.setZoom(17);
            mapController.animateTo(mylayer.getMyLocation());
        }
    });

overlays.add(mylayer);
GeoPoint startpp =  mylayer.getMyLocation();

        String b="SELECT lat,lng FROM markers";
    UserFunctions userFunction = new UserFunctions();
    JSONObject json = userFunction.execqlcmd(b);

    try {
        if (json.getString(KEY_SUCCESS) != null) 
        {
            String res = json.getString(KEY_SUCCESS); 
            if(Integer.parseInt(res) == 1)
            {

                for(int i=0 ; i<100 ; i++) {

                JSONObject json_row = json.getJSONObject("r"+i);

     mm[i][0]=(int)(Double.parseDouble(json_row.getString("c0")) * 1E6) ;
 mm[i][1]=(int)(Double.parseDouble(json_row.getString("c1")) * 1E6) ;
     endpp[i] =new GeoPoint(mm[i][0], mm[i][1] ); 

        MapController mc = mapView.getController();

DistanceCalculator caldist= new DistanceCalculator(6371); 

for(int j = 0;  j < 2; j++)
   {
    rtdist[j][0]=1;
    rtdist[j][1]=caldist.CalculationByDistance(startpp, endpp[j]); 

    //startpp  The location of the phone is
    //endpp DB's lat lng

    //To judge the results of this array is in line with the distance required by the user
  if(rtdist[j][1]<=50)
    {
    okdist[j][0]=rtdist[j][0]; //The amount of store 
    okdist[j][0]=rtdist[j][1]; //Store the distance
    } 

    }

    mc.animateTo(geoPoint);  
    mc.setZoom(15);
    mapView.invalidate(); 

        List<Overlay> mapOverlays = mapView.getOverlays();

    Drawable drawable = this.getResources().getDrawable(R.drawable.mark_red);
    AddItemizedOverlay itemizedOverlay = 
    new AddItemizedOverlay(drawable, this);

    OverlayItem overlayitem = new OverlayItem(geoPoint, "Hello", "Sample Overlay   item");
    itemizedOverlay.addOverlay(overlayitem);

    mapOverlays.add(itemizedOverlay);

    }}}}
    catch (JSONException e) {
        e.printStackTrace();
    }

 }

     @Override
 protected void onResume() {
 // TODO Auto-generated method stub
 super.onResume();
 mylayer.enableMyLocation();
 }
 @Override
 protected void onPause() {
 // TODO Auto-generated method stub
 super.onPause();
 mylayer.disableMyLocation();
 }

@Override
protected boolean isRouteDisplayed() {
    return false;
}
    public class DistanceCalculator {  

       private double Radius;  

       // R = earth's radius (mean radius = 6,371km)  
       // Constructor  
       DistanceCalculator(double R) {  
          Radius = R;  
       }  

    public double CalculationByDistance(GeoPoint startpp, GeoPoint endpp) {  
          double lat1 = startpp.getLatitudeE6()/1E6;  
          double lat2 = endpp.getLatitudeE6()/1E6;  
          double lon1 = startpp.getLongitudeE6()/1E6;  
          double lon2 = endpp.getLongitudeE6()/1E6;  
          double dLat = Math.toRadians(lat2-lat1);  
          double dLon = Math.toRadians(lon2-lon1);  
          double a = Math.sin(dLat/2) * Math.sin(dLat/2) +  
             Math.cos(Math.toRadians(lat1)) * Math.cos(Math.toRadians(lat2)) *  
             Math.sin(dLon/2) * Math.sin(dLon/2);  
          double c = 2 * Math.asin(Math.sqrt(a));  
          return Radius * c;  
       } 
  } 
} 
```

日志猫：

```
05-13 14:49:44.703: D/dalvikvm(303): GC_FOR_MALLOC freed 4358 objects / 275032 bytes in 316ms
05-13 14:49:44.903: D/dalvikvm(303): GC_FOR_MALLOC freed 10567 objects / 641664 bytes in 58ms
05-13 14:49:45.063: D/dalvikvm(303): GC_FOR_MALLOC freed 4727 objects / 310440 bytes in 45ms
05-13 14:49:45.243: D/dalvikvm(303): GC_FOR_MALLOC freed 6480 objects / 394584 bytes in 48ms
05-13 14:49:45.443: D/dalvikvm(303): GC_FOR_MALLOC freed 7949 objects / 616640 bytes in 51ms
05-13 14:49:45.623: D/dalvikvm(303): GC_FOR_MALLOC freed 6072 objects / 370040 bytes in 51ms
05-13 14:49:45.813: D/dalvikvm(303): GC_FOR_MALLOC freed 4449 objects / 354128 bytes in 62ms
05-13 14:49:45.823: I/dalvikvm-heap(303): Grow heap (frag case) to 3.048MB for 87396-byte allocation
05-13 14:49:45.884: D/dalvikvm(303): GC_FOR_MALLOC freed 45 objects / 2392 bytes in 66ms
05-13 14:49:45.953: D/dalvikvm(303): GC_FOR_MALLOC freed 2 objects / 80 bytes in 67ms
05-13 14:49:45.953: I/dalvikvm-heap(303): Grow heap (frag case) to 3.129MB for 87396-byte allocation
05-13 14:49:46.013: D/dalvikvm(303): GC_FOR_MALLOC freed 0 objects / 0 bytes in 58ms
05-13 14:49:46.273: E/JSON(303): {"tag":"exesqlcmd","success":1,"error":0,"rownum":2,"colnum":2,"r0":{"c0":"23.973728","c1":"121.583641"},"r1":{"c0":"23.973827","c1":"121.585625"}}
05-13 14:49:46.293: D/AndroidRuntime(303): Shutting down VM
05-13 14:49:46.293: W/dalvikvm(303): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
05-13 14:49:46.313: E/AndroidRuntime(303): FATAL EXCEPTION: main
05-13 14:49:46.313: E/AndroidRuntime(303): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.androidhive.googlemaps/com.androidhive.googlemaps.AndroidGoogleMapsActivity}: java.lang.NullPointerException
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
05-13 14:49:46.313: E/AndroidRuntime(303):  at    android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.os.Looper.loop(Looper.java:123)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-13 14:49:46.313: E/AndroidRuntime(303):  at java.lang.reflect.Method.invokeNative(Native Method)
05-13 14:49:46.313: E/AndroidRuntime(303):  at java.lang.reflect.Method.invoke(Method.java:521)
05-13 14:49:46.313: E/AndroidRuntime(303):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-13 14:49:46.313: E/AndroidRuntime(303):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-13 14:49:46.313: E/AndroidRuntime(303):  at dalvik.system.NativeStart.main(Native Method)
05-13 14:49:46.313: E/AndroidRuntime(303): Caused by: java.lang.NullPointerException
05-13 14:49:46.313: E/AndroidRuntime(303):  at com.androidhive.googlemaps.AndroidGoogleMapsActivity$DistanceCalculator.CalculationByDistance(AndroidGoogleMapsActivity.java:178)
05-13 14:49:46.313: E/AndroidRuntime(303):  at com.androidhive.googlemaps.AndroidGoogleMapsActivity.setupMap(AndroidGoogleMapsActivity.java:106)
05-13 14:49:46.313: E/AndroidRuntime(303):  at com.androidhive.googlemaps.AndroidGoogleMapsActivity.onCreate(AndroidGoogleMapsActivity.java:41)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-13 14:49:46.313: E/AndroidRuntime(303):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
05-13 14:49:46.313: E/AndroidRuntime(303):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T16:53:10.200

如果要计算两个地理点之间的距离，则必须在 Location Class 中查看这两种方法

[位置类](http://developer.android.com/reference/android/location/Location.html)

你可以像这样使用它：

```
Location locationA = new Location("point A");

locationA.setLatitude(latA);
locationA.setLongitude(lngA);

Location locationB = new Location("point B");

locationB.setLatitude(latB);
LocationB.setLongitude(lngB);

distance = locationA.distanceTo(locationB); 
```

# wpf - 如何注销信使事件 - Galasoft MVVM

> ID：10572805
> 
> 赞同：2
> 
> 时间：2012-05-13T15:07:54.193
> 
> 标签：wpf, mvvm-light

## 环境;

WPF、Galasoft MVVM 光

我有一个场景，我的应用程序的许多非活动 xaml 视图一直在收听信使的消息，这使我的应用程序工作非常缓慢。

## 问题;

从非活动视图中注销消息的最佳方法是什么？我只想要一个视图的活动实例来收听消息。

我试图在视图的卸载事件中注销它，但这也从活动实例中注销它。

谢谢，阿西夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T16:44:04.927

事件并不昂贵，它是您在收到事件时执行的代码。
（重新）设计您的消息事件接收器，以便它们仅在视图处于活动状态时执行。

# android - Android小部件不响应触摸

> ID：10572813
> 
> 赞同：1
> 
> 时间：2012-05-13T15:08:48.767
> 
> 标签：android, widget, android-appwidget, appwidgetprovider

我正在尝试一些非常简单的代码来让 Android 小部件运行，但没有运气。我环顾四周，并没有找到一个好的答案。

我想要的（现在）只是在触摸小部件时增加一个计数器并显示当前值。

这是我的 AppWidgetProvider：

```
public class WordWidget extends AppWidgetProvider
{
    Integer touchCounter = 0;

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds)
    {
        //This is run when a new widget is added or when the update period expires.
        Log.v("wotd",  "Updating " + appWidgetIds.length + " widgets");

        for(int x = 0; x < appWidgetIds.length; x++)
        {
            Integer thisWidgetId = appWidgetIds[x];

            RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widgetlayout);
            remoteViews.setTextViewText(R.id.mainText, touchCounter.toString());

            Intent widgetIntent = new Intent(context, WordWidget.class);
            widgetIntent.setAction("UPDATE_NUMBER");

            PendingIntent widgetPendingIntent = PendingIntent.getBroadcast(context, 0, widgetIntent, 0);

            remoteViews.setOnClickPendingIntent(R.id.widgetLinearLayout, widgetPendingIntent);
            appWidgetManager.updateAppWidget(thisWidgetId, remoteViews);
        }
    }

    @Override
    public void onReceive(Context context, Intent intent)
    {
        Log.v("wotd", "In onReceive with intent=" + intent.toString());
        if (intent.getAction().equals("UPDATE_NUMBER"))
        {
            Log.v("wotd", "In UPDATE_NUMBER");
            touchCounter++;
            RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widgetlayout);
            remoteViews.setTextViewText(R.id.mainText, touchCounter.toString());
        } else
        {
            Log.v("wotd", "In ELSE... going on to super.onReceive()");
            super.onReceive(context, intent);
        }
    }
} 
```

这是我清单的一部分：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <receiver
        android:icon="@drawable/ic_launcher"
        android:name="com.example.mywidget.WordWidget"
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            <action android:name="UPDATE_NUMBER" />
        </intent-filter>

        <meta-data
            android:name="android.appwidget.provider"
            android:resource="@xml/widgetinfo" />
    </receiver>

</application> 
```

日志显示 onReceive() 被放置在主屏幕上后立即被调用，并且在被触摸后，但数量从未增加。我不完全理解小部件是如何工作的，但是它们在 onUpdate() 之后被杀死了吗？所以要做到这一点，我必须使用某种持久存储？

此外，如果我当前添加另一个小部件，即使我只是触摸一个，两者都会显示相同的值并增加。有没有办法让每个小部件都有自己的计数器？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-13T15:48:11.067

其实你已经回答了你的问题。但是让我们澄清一些事情：

A. 只要 AppWidgets 在主屏幕上，它们就不会被杀死。但它们不属于你。它们在主应用程序的进程中运行。更具体地说，他们的视图在主应用程序的进程中运行，这就是为什么您会看到您的小部件但它没有按照您的预期执行，这就是我们使用 RemoteViews 而不是 Views 来更新它们的原因.

B. 另一方面，AppWidgetProviders（在您的情况下是 WordWidget 类）在 onReceive 方法完成后立即被销毁。每次调用 onReceive 方法时，它们中的所有变量都会重新初始化。这就是为什么你的人数永远不会增加的原因。AppWidgetProvider 的目的是更新小部件的 RemoteViews 并通知您的应用程序已注册的广播已到达。

C. AppWidgetProvider 的 onUpdate 方法为您提供了一个包含必须更新的小部件 Id 的数组。这是唯一可用于获取小部件实例数量及其 ID 的代码点。由于 RemoteViews 没有办法从小部件的视图中获取一些有用的值（例如，您无法从 TextView 读取计数器值），因此您必须使用提供的信息并**坚持**每个小部件 id 的计数器值。当下一个 onUpdate 被调用时，您从存储中读取值，增加它，使用新值更新小部件，然后将新值存储回来。

D. 如果您的小部件在更新自身时必须做很多事情或减慢速度（如网络），您应该考虑为此使用服务。但是在您的情况下（增加数字），只要您将计数器保存在持久存储或其他地方，您的方法就可以了。

最后我注意到，在您的 onReceive 覆盖中，只有在您没有收到“UPDATE_NUMBER”操作时才调用“super.onReceive”。这不是一个好的做法，除非有很好的理由（那是另一回事）总是调用 super.onReceive 作为覆盖中的第一个或最后一个命令。

希望这可以帮助...

# jquery - jQuery扩展

> ID：10572815
> 
> 赞同：0
> 
> 时间：2012-05-13T15:09:02.090
> 
> 标签：jquery, expando

我想为表格行添加一些额外的属性。该表是根据从服务器返回的数据动态创建的

在 HTML 上定义的表：

然后，假设我有一些来自服务器的 json 数据（数据简化）：

```
people = [{name:"John Doe", person_id:"1234"}, {name:"Jane Roe", person_id:"5678"}] 
```

我现在用以下代码填写表格（在我的 ajax.done 处理程序中）：

```
for( i=0; i<people.length; ++i ) {
    var person = people[i];
    var row = $('<tr><td>' + person.name + '</td></tr>');
    row.person_id = person.person_id;      // <<=== HERE I'm trying to add the expando
    row.click( clickHandler );
    $('#myTable > tbody').append(row);
}

function clickHandler( ev ) {
    row = ev.currentTarget;               // This is fine
    id = ev.currentTarget.person_id       // HERE unable to get my expando
} 
```

我几乎可以肯定，对于普通的 HTML 对象（即 document.createElement('TR')，没有任何 JS 以及 Javascript 对象，这种语法是有效的。使用 jQuery 会发生其他事情。

（注意，有很多方法可以解决它，但出于教育目的，我真的很想知道如何使用 expandos 和 jQuery）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:12:32.227

您正在设置`person_id`jQuery 集合对象，而不是 DOM 元素。jQuery 等价物是`row.prop('person_id', person.person_id);`.

也就是说，要保留随机数据位以及 DOM 元素，您应该使用`attr()`或`data()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:14:39.827

这

```
row.person_id = person.person_id; 
```

应该

```
row[0].person_id = person.person_id; 
```

`row`是jquery wrapper，但是`row[0]`是DOM Element。

# java - 如何正确组织一组在不同包中实现接口的具体类？

> ID：10572817
> 
> 赞同：3
> 
> 时间：2012-05-13T15:09:11.367
> 
> 标签：java, oop, package

我已经定义了一个我的系统将依赖的接口：

```
IMethodCall 
```

我创建了一堆实现的类`IMethodCall`：

```
AbstractMethodCall
ConstructorCall
TargetConstructorCall
VoidMethodCall
TargetVoidMethodCall
NonVoidMethodCall
TargetNonVoidMethodCall 
```

它们是实现的细节，我的系统不知道它们（或者至少不需要知道）。

根据我当时手头的一组数据选择要实例化的实现背后有一些棘手的逻辑，所以我决定创建一个工厂，将所有逻辑分组在一个地方：

```
MethodCallFactory 
```

我试图了解这里使用的包结构应该是什么。我最初的想法是将所有具体类放在一个`methodCalls`包中，并将它们设置为受包保护，这样就没有人知道它们的存在了。然后我让`IMethodCall`外面`MethodCallFactory`，所以我的系统的用户可以使用它们。问题是，如果我将具体类作为包保护，那么工厂也必须在它们的包中，这反过来看起来有点奇怪，因为对于外部查看者来说，它看起来像是一个只存在包含的包一个工厂。

目前我看到的最好的权衡是将具体类公开，但我想知道你们通常如何处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:47:07.593

当我遇到这种情况时，我会将具体的实现类和工厂放在同一个包中，并将实现类包私有化。

您提到这种方法似乎很奇怪，因为外部观点。我不同意外部用户不知道有实现类。大多数 IDE 将显示包中的类，即使它们不可访问。此外，如果程序员试图使用您的实现类，编译器将暗示该类存在但不允许访问。

我也不同意只有一个包含工厂并且它是私有实现的包是很奇怪的。这组类是紧密相关的，这使得将它们组合在一个地方是合乎逻辑的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:28:18.817

您可以将您的工厂类和接口放在公共包中，并将实现的类放在内部包中。

不鼓励使用内部包，内部包中的类可能随时更改。用户应调用公共包中的 api。

例如：

公共包是 org.feeling.ui.dialogs

一个内部包是 org.feeling.internal.ui.dailogs

# dojo - 如何在 dijit.TooltipDialog 上设置 zIndex？

> ID：10572820
> 
> 赞同：0
> 
> 时间：2012-05-13T15:09:59.297
> 
> 标签：dojo, xpages, xpages-ssjs

我创建了一个 dijit.TooltipDialog 并且一切正常。但是，如果从工具提示对话框中生成另一个对话框，它将显示在工具提示对话框的后面而不是在它的顶部。我检查了 2 个对话框上的 zIndex，工具提示对话框是 1000，另一个对话框是 950。

我尝试在相应的容器节点和工具提示对话框的“domNode”上设置 zIndex，但都没有成功。那么有人知道如何在工具提示对话框上设置 zIndex 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:36:55.860

如果您在创建编程工具提示后检查 dom，您会发现 - 工具提示放置在下面的覆盖容器中`<body>`。

如前所述，为此寻求替代方法。但答案如下；要成功设置 z-index，您必须找到正确的节点 - 这不是 domNode，因为对话框通过 dijit.popup 设计拥有自己的“层”。

这是它的小提琴：http: [//jsfiddle.net/rQHSP/](http://jsfiddle.net/rQHSP/)

简而言之，这是您可以做的。

```
 myDialog.onShow = function() {
        node = this.domNode
        // loop upwards untill we hit a wall or nodes class mathes popup
        while (node 
           && (!node.className || !node.className.match("dijitTooltipDialogPopup")))
              node = node.parentNode

        console.log(dojo.style(node, "zIndex")
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T23:26:56.033

按照 mschr 的回答，我找不到 dijit.TooltipDialog 的 underlayAttrs 属性。但这确实让我找到了 _popupWrapper，它是整个弹出窗口的包装节点。此节点的 zIndex 为 1000。以下代码更正了该问题：

```
var dij = dijit.byId(dojo.query("[id*='_TooltipDialog_']")[0].id);
dij.onShow = function() {
    dojo.style(dij._popupWrapper,"zIndex",900);
} 
```

# jquery - 在延迟回调中没有抛出/显示错误

> ID：10572821
> 
> 赞同：1
> 
> 时间：2012-05-13T15:10:00.477
> 
> 标签：jquery, node.js, requirejs

我们正在使用 RequireJS 和 Node 构建一个项目，并在服务器端和客户端重用模块。到目前为止一切都很好（需要解决一些小问题）。

一个问题似乎是延迟回调中的错误永远不会显示在节点控制台中（或以任何其他方式显示）。使调试变得非常困难。

```
asdasdasd(); // Throws error, function is undefined, as intended
this.loadOrganization(organization_key, true).then(function(org) {
    asdasdasd(); // No error anywhere, script just stops executing
}); 
```

loadOrganization 返回一个延迟对象，并且回调被正常调用 - 但是没有显示与 undefined 有关的错误消息（评估模块时节点报告一般语法错误）。

我们使用 jsdom 和 jquery 在服务器端为浏览器引导内容。然后将 jquery 从 jsdon 传递给大多数方法 - 所以用于 loadOrganization 的延迟对象是来自 jQuery 通过 jsdom 的对象。然而，从 npm installed jquery 将 deferred used 更改为 one 并没有什么区别。

任何建议都会有所帮助，当没有打印错误时很难调试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:08:42.680

弄清楚了，这是我们在服务器端的 Backbone.Sync 实现中的一个疯狂的 try/catch 语句。这意味着通过 API 的任何东西（几乎是任何东西）都被 try/catch 捕获，该 try/catch 将错误传递给 Backbone.Sync 错误回调，并且再也没有收到任何消息。

这个故事很道德；如果没有输出错误，请查看您的 Try/Catches 代码。

# objective-c - NSProgressIndicator 中的标签/文本？

> ID：10572823
> 
> 赞同：0
> 
> 时间：2012-05-13T15:10:18.953
> 
> 标签：objective-c, macos, cocoa

似乎每个需要一些文本的人`NSProgressIndicator`（即显示下载的百分比）最终都会将文本放在小部件上方或旁边。

你真的不能在`NSProgressIndicator`小部件内显示任何文本吗？

我的意思的一个例子：

![示例图片](../Images/9988bfc846590886b33f1aa29fe633f9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:19:35.410

在 IB 中，只需将进度指示器嵌入到自定义视图中，向该视图添加标签，并将进度指示器和标签都居中在自定义视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:12:20.067

你可以在任何你想要的地方贴上标签。进度指示器没有文本属性。所以是的，您可以在进度指示器上贴上标签。如果那看起来不错是另一个问题。

# android - iOS Android 上的回声消除？

> ID：10572825
> 
> 赞同：2
> 
> 时间：2012-05-13T15:10:30.917
> 
> 标签：android, ios, audio, operating-system

我正在尝试找出 iOS 和 Android 是否内置了 AEC 并且在任何地方都找不到它（令人惊讶的是，谷歌搜索没有提供任何有意义的结果）。

有谁知道他们有没有？我知道有些设备内置了它，但不确定整个操作系统。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:49:35.437

Android 为 3.0 及更高版本 (VOICE_COMMUNICATION AudioSource) 提供了内置回声消除选项。这也不能保证。

除此之外，您还可以使用 Speex AEC。当您知道如何正确使用它并了解它的要求时，它可以完美地工作。

# wpf - 设置应用程序

> ID：10572828
> 
> 赞同：0
> 
> 时间：2012-05-13T15:10:45.847
> 
> 标签：wpf, installation

有没有其他方法可以为我的 WPF 应用程序创建设置？

MS 的内置安装程序创建者与安装/卸载有相同的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:13:43.190

有 WiX 工具集[http://wix.codeplex.com/](http://wix.codeplex.com/)以及 InstallShield [http://www.flexerasoftware.com/products/installshield.htm](http://www.flexerasoftware.com/products/installshield.htm)

# mongodb - .NET 会话状态缓存与 Redis、MongoDB、ServiceStack

> ID：10572834
> 
> 赞同：2
> 
> 时间：2012-05-13T15:11:30.710
> 
> 标签：mongodb, redis, servicestack, distributed-caching

我一直在研究是否可以在外部数据库（如 Redis、MongoDb 或其他高度可扩展的工具）中缓存 .NET 会话状态。

我的研究结果是，尽管 MongoDB 有更多的集成来做这类事情，但似乎 Redis 的性能要高得多，并且有更多的选项（密钥过期、集合等）可供使用。

还有另一个名为[ServiceStack](https://github.com/ServiceStack)的框架，它有一个 RedisClient 的实现，但恕我直言，它的实现方式比我想的要耦合得多。

```
 public override object OnGet(CachedOrders request)
    {
        var cacheKey = "some_unique_key_for_order";
        return base.RequestContext.ToOptimizedResultUsingCache(this.CacheClient, cacheKey, () =>
            {
                    //This delegate will be executed if the cache doesn't have an item
                    //with the provided key

                //Return here your response DTO
                //It will be cached automatically
            });
    } 
```

所以在这项研究之后，我想知道你的意见，以及你是否在你的任何应用程序中实现了这种缓存。你能分享你的经验吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T15:52:04.750

[ServiceStack 的](http://www.servicestack.net)缓存不是耦合的，该`ToOptimizedResultUsingCache()`方法只是一种[方便的扩展方法](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/ServiceHost/RequestContextExtensions.cs)，允许您在必要的最小样板中实现通用缓存模式。该`ToOptimizedResult`方法根据来自 IRequestContext 的 MimeType 和 CompressionType 返回最优化的结果。例如，在 JSON 服务中，它通常是 JSON 响应 DTO 的放气输出。

您不必使用扩展方法，并且可以直接访问[ICacheClient API](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/CacheAccess/ICacheClient.cs)，因为它是类中的自动连接属性`ServiceBase`。如果您需要的功能比 ICacheClient API 所能提供的更多，我建议使用[Redis](http://redis.io/)和[ServiceStack 的 C# RedisClient](https://github.com/ServiceStack/ServiceStack.Redis)，它可以让您快速、原子地访问分布式 comp-sci 集合。

使用`ICacheClient`API 的好处是它是一个可测试的与实现无关的缓存接口，目前有[InMemory、Redis 和 Memcached 提供程序](https://github.com/ServiceStack/ServiceStack/wiki/Caching)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-10T14:12:34.667

2 年前我为此编写了一个 NuGet 包，从那时起我们就一直在生产中使用它。它使用允许持久性到 Redis 的自定义类覆盖 .NET `SessionStateProvider`，具有各种功能，例如：

*   仅在值更改时写入 Redis
*   来自具有相同会话 ID 的多个请求的并发会话访问
*   能够从 Web API 访问会话（尽管这样做违反了 REST 原则，如果您关心的话）
*   轻松自定义序列化格式（自行滚动或更改 Json 结构）

你可以在这里得到它：[https ://www.nuget.org/packages/RedisSessionProvider](https://www.nuget.org/packages/RedisSessionProvider)

文档：[https ://github.com/welegan/RedisSessionProvider](https://github.com/welegan/RedisSessionProvider)

# iphone - Fade away at top - UIScrollView 的 CALayer 掩码

> ID：10572835
> 
> 赞同：3
> 
> 时间：2012-05-13T15:11:37.800
> 
> 标签：iphone, ios5, uiview, uiscrollview, calayer

我有一个 UIScrollView，我想让它只在顶部消失。其余的将是坚实的，就像我在图片中看到的那样。为了清楚起见，我不希望内容褪色，我希望整个滚动视图都褪色。scrollView 本身是完全透明的，但我希望它在某些时候消失......这甚至可能吗？

![我多么想要它...](../Images/3dbc8aba81d2cda7892da4284bf2ea0a.png)

我希望这已经足够清楚了......如果我可以更清楚，请给我写评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T12:53:07.807

当您说“淡入透明”时，透明度背后是什么颜色？是黑色背景会透出来吗？

如果是这样，那么只需在 UIScrollView 顶部粘贴一个 UIImageView 并在其中放置一个包含从 0% 不透明度到 100% 背景颜色不透明度的渐变的图像。

这样，任何在其下方向上移动的东西都会看起来像是淡入背景。

# jquery - 使用 jQuery 将句子/字符串拆分为单词

> ID：10572836
> 
> 赞同：1
> 
> 时间：2012-05-13T15:11:39.063
> 
> 标签：jquery

我有一个句子/H1，我需要将其拆分，使其如下所示

原始状态

```
<h1>This is the heading </h1> 
```

后

```
<h1>This <br> 
is <br> 
the <br> 
heading </h1> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T15:14:44.470

我建议：

```
$('h1').each(
    function(){
        var that = $(this),
            newText = that.text().replace(/\W/g,'<br />');
        that.html(newText);
    }); 
```

*   [JS 小提琴演示](http://jsfiddle.net/davidThomas/uJZpB/)。

参考：

*   jQuery 参考资料：
    *   [`html()`](http://api.jquery.com/html/).
    *   [`text()`](http://api.jquery.com/text/).
*   JavaScript 参考：
    *   [`regular expressions`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp).
    *   [`replace()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T15:17:56.240

```
$("h1").html( $("h1").text().replace(/ /g,"<br>"))​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T15:24:34.870

```
$('h1').each(function() {
    var txt = $(this).html().replace(/^\s*(.*?)\s*$/,'$1');
    // this trims the string
    $(this).html(txt.split(/\s+/).join(' <br/>')+' ');
    // this splits the character groups (not containing spaces)
    // and joins them by a br tag, then adds an extra space at the end.
}); 
```

替代方案和更短的版本（感谢[VisioN](https://stackoverflow.com/users/1249581/vision)）：

```
$('h1').each(function() {
    $(this).html($.trim($(this).html()).split(/\s+/).join(' <br/>')+' ');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T15:25:03.827

试试这个：

```
var h = $('h1').text().split(' ').join('<br>'); 
$('h1').html(h); 
```

# c - 破解 Chrome 语音到文本 API 以使用我自己的服务

> ID：10572838
> 
> 赞同：0
> 
> 时间：2012-05-13T15:11:47.417
> 
> 标签：c, api, webkit, google-api

是否有可能通过扩展来破解 Chrome（更准确地说是 Webkit），以便使用我自己的媒体服务器而不是 Google 的？

需要制作实时语音交互应用程序，我正在寻找替代方案，而不是在 Flash 或 Java Applet 中执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T18:50:40.303

我发现（对于我的项目）使用[VideoIO.swf](http://code.google.com/p/flash-videoio/)和[RTMPLite](http://code.google.com/p/rtmplite/)是更容易和更便携的解决方案。

# json - RavenDB 和小写 json 序列化 - 执行查询时出现问题

> ID：10572846
> 
> 赞同：2
> 
> 时间：2012-05-13T15:13:27.277
> 
> 标签：json, ravendb, json.net

对我来说 json 是小写的。

所以我定义了这样的简单类型：

```
public class Profile: RootAggregate
{
    [JsonProperty("name")]
    public string Name { get; set; }
} 
```

使用 ravendb，我可以坚持下去：

```
documentSession.Store(new Profile { Name = "myprofile" }); 
```

![](../Images/2a6575a38a1355e9f1d5e5895ba7494b.png)

然后检索：

```
var profile = session.Query<Profile>()
                     .Customize(x => x.WaitForNonStaleResultsAsOfNow())
                     .Where(x => x.Name == "myprofile")
                     .SingleOrDefault(); 
```

它返回... NULL。

如果该属性`[JsonProperty("name")]`不存在，则会导致：

![](../Images/6fd8f6a84a19bd6901a6e13d705f6536.png)

查询工作正常。

如何保留属性并强制查询按预期工作？

顺便说一句：我正在使用 RavenDB - Build #888

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:51:35.627

这可能是 LINQ 查询检查器中的一个问题。请通过以下链接打开一个关于它的问题，如果可以的话，提供一个失败的测试是最好的。

[http://issues.hibernatingrhinos.com/issues](http://issues.hibernatingrhinos.com/issues)

# unit-testing - CakePHP 2.1：使用 Session::read() 制作模拟控制器

> ID：10572847
> 
> 赞同：3
> 
> 时间：2012-05-13T15:13:32.207
> 
> 标签：unit-testing, cakephp, mocking, phpunit

一般来说，我是 phpunit 和单元测试的新手。我正在尝试将大型应用程序转换为 cakephp 2.0 并对所有内容进行单元测试。

我正在尝试创建一个模拟对象，在该对象中调用 $this->Session->read('Auth.Account.id') 时，它返回 144 ...这将提供一个具有包含项目的 id 的帐户。

但是，我收到一个错误，因为 Mock 似乎在各种 beforeFilter 调用中的其他 Session::read('AuthCode') 调用上出错；

***方法名称的期望失败等于调用 1 次时调用的参数 0 SessionComponent::read('AuthCode') 与期望值不匹配。断言两个字符串相等时失败。***

就像我说我是 phpunit 和单元测试的新手......我做错了什么？

```
class PagesController extends MastersController {
        public function support(){
        if($this->Session->read('Auth.Account.id')) {
            $items = $this->Account->Items->find('list', array('conditions'=>array('Items.account_id'=>$this->Session->read('Auth.Account.id'))));           
        }
        $this->set(compact('items'));
    }
}

class PagesControllerTestCase extends CakeTestCase {
        /**
     * Test Support
     *
     * @return void
     */
    public function testSupport() { 
        #mock controller
        $this->PagesController = $this->generate('Pages', array(
            'methods'=>array('support'),
            'components' => array(
                'Auth',
                'Session',
            ),
        ));

                #mock controller expects
        $this->PagesController->Session->expects(
            $this->once())
                ->method('read') #Session:read() method will be called at least once
                ->with($this->equalTo('Auth.Account.id')) #when read method is called with 'Auth.Account.id' as a param
                ->will($this->returnValue(144)); #will return value 144

        #test action
        $this->testAction('support');
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:46:26.020

我决定手动编写会话。就像他们所做的一样，是核心中的 SessionComponentTest。

[https://github.com/cakephp/cakephp/blob/master/lib/Cake/Test/Case/Controller/Component/SessionComponentTest.php](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Test/Case/Controller/Component/SessionComponentTest.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T04:28:23.853

您应该使用 Auth 组件而不是 Session 组件来访问 Auth 会话变量。

代替

`if($this->Session->read('Auth.Account.id')) {`

尝试

`if ($this->Auth->user('Account.id')) {`

您的 Items::find 调用也是如此。

模拟 Auth 组件仍然是要走的路。

`class PagesControllerTestCase extends CakeTestCase {`

应该

`class PagesControllerTestCase extends ControllerTestCase {`

然后在你的测试中：

```
$PagesController = $this->generate('Pages', array(
    'methods'=>array('support'),
    'components' => array(
        'Auth' => array('user')
     ),
));

$PagesController->Auth->staticExpects($this->exactly(2))
    ->method('user')
    ->with('Account.id')
    ->will($this->returnValue(144)); 
```

# tomcat - java.lang.ClassNotFoundException: org.apache.http.entity.mime.content.ContentBody

> ID：10572854
> 
> 赞同：9
> 
> 时间：2012-05-13T15:14:12.127
> 
> 标签：tomcat, solr

您好，当我尝试从我的 servlet 的 get 方法初始化 HttpSolrServer 时，我遇到了这个奇怪的异常

```
org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/MAVL].[Resteasy]- Servlet.service() for servlet Resteasy threw exception
org.jboss.resteasy.spi.UnhandledException: java.lang.NoClassDefFoundError: org/apache/http/entity/mime/content/ContentBody
    at org.jboss.resteasy.core.SynchronousDispatcher.unwrapException(SynchronousDispatcher.java:345)
    at org.jboss.resteasy.core.SynchronousDispatcher.handleApplicationException(SynchronousDispatcher.java:321)
    at org.jboss.resteasy.core.SynchronousDispatcher.handleException(SynchronousDispatcher.java:214)
    at org.jboss.resteasy.core.SynchronousDispatcher.handleInvokerException(SynchronousDispatcher.java:190)
    at org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:534)
    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:496)
    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:119)
    at org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:208)
    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)
    at org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:50)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.NoClassDefFoundError: org/apache/http/entity/mime/content/ContentBody
    at com.polgar.dipl.index.SolrIndex.init(SolrIndex.java:48)
    at com.polgar.dipl.index.SolrIndex.getInstance(SolrIndex.java:42)
    at com.polgar.dipl.Articles.getRandomArticles(Articles.java:37)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:140)
    at org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:255)
    at org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:220)
    at org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:209)
    at org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:519)
    ... 18 more
Caused by: java.lang.ClassNotFoundException: org.apache.http.entity.mime.content.ContentBody
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    ... 30 more 
```

第 48 行是我初始化 solr 服务器的地方：

```
 server = new HttpSolrServer(url); 
```

Solr 在同一个 Tomcat 实例上作为另一个 servlet 运行。我这样称呼它：

```
@GET
@Path("/test")
public String getTest() {
    SolrIndex s = SolrIndex.getInstance();
    s.query()

public class SolrIndex {
    private static SolrIndex solrIndex = null;
    private static String url = "http://localhost:8080/solr/";
    public static HttpSolrServer server = null;

   public static SolrIndex getInstance() {
        if (server == null)
            init();
        return solrIndex;
    }

    private static void init() {
        solrIndex = new SolrIndex();
        server = new HttpSolrServer(url); //<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
        server.setSoTimeout(1000); // socket read timeout
        server.setConnectionTimeout(1000);
        server.setDefaultMaxConnectionsPerHost(20);
        server.setMaxTotalConnections(50);
        server.setMaxRetries(1); // defaults to 0\. > 1 not recommended.
    } 
```

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-13T15:17:50.257

这是你的类路径，你需要 httpmime-4.0.jar

# java - 将 ISO 时间戳格式的 Java 字符串转换为 SimpleDateFormat

> ID：10572855
> 
> 赞同：0
> 
> 时间：2012-05-13T15:14:30.257
> 
> 标签：java, date

我正在尝试将 ISO 时间戳格式的字符串转换为`SimpleDateFormat`这样的：

```
public static void convertDate () {
  String timestamp = DateFormatUtils.ISO_DATETIME_TIME_ZONE_FORMAT.format(new Date());
  DateFormat formatter = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZZ");
  Date date = (Date)formatter.parse(timestamp);  
} 
```

上面的代码抛出以下异常：

```
java.text.ParseException: Unparseable date: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:26:16.933

如果您从 XML 中以 ISO 8601 格式解析日期，则可以使用 JAXB 解析器。

[查看此帖子以获取示例](https://stackoverflow.com/questions/2201925/converting-iso8601-compliant-string-to-java-util-date)

# sql - 优化sql函数获取常用元素

> ID：10572858
> 
> 赞同：1
> 
> 时间：2012-05-13T15:14:40.723
> 
> 标签：sql, optimization, sql-server-2008-r2

我有一个函数，它接受两个分隔字符串并返回公共元素的数量。这

函数的主要代码是（@intCount 是预期的返回值）

```
 SET @commonCount = (select count(*) from (
    select token from dbo.splitString(@userKeywords, ';')
    intersect
    select token from dbo.splitString(@itemKeywords, ';')) as total) 
```

其中 splitString 使用 while 循环和 charIndex 将字符串拆分为分隔标记并将其插入表中。

我遇到的问题是，这仅以每秒约 100 行的速度处理，并且根据我的数据集的大小，这将需要大约 8-10 天才能完成。

两个字符串的长度最多可达 1500 个字符。

无论如何，我是否可以足够快地实现这一目标以供使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:33:16.707

性能问题可能是游标（用于 while 循环）和用户定义函数的组合。

如果这些字符串之一是常量（例如项目关键字），您可以独立搜索每个字符串：

```
select *
from users u
where charindex(';'+<item1>+';', ';'+u.keywords) > 0
union all
select *
from users u
where charindex(';'+<item2>+';', ';'+u.keywords) > 0 union all 
```

或者，可以使用基于集合的方法，但您必须对数据进行规范化（插入此处以获得正确格式的数据）。也就是说，您需要一个包含以下内容的表：

```
userid
keyword 
```

另一个有

```
itemid
keyword 
```

（如果有不同类型的项目。否则这只是一个关键字列表。）

然后您的查询将如下所示：

```
select *
from userkeyword uk join
     itemkeyword ik
     on uk.keyword = ik.keyword 
```

SQL 引擎将发挥它的魔力。

现在，您如何创建这样的列表？如果每个用户只有几个关键词，那么您可以执行以下操作：

```
with keyword1 as (select u.*, charindex(';', keywords) as pos1,
                         left(keywords, charindex(';', keywords)-1) as keyword1
                  from user u
                  where charindex(';', keywords) > 0
                 ),
     keyword2 as (select u.*, charindex(';', keywords, pos1+1) as pos2,
                         left(keywords, charindex(';', keywords)-1, pos1+1) as keyword2
                  from user u
                  where charindex(';', keywords, pos1+2) > 0
                 ),
        ...
select userid, keyword1
from keyword1
union all
select userid, keyword2
from keyword2
... 
```

要获取 itemKeyWords 中的最大元素数，可以使用以下查询：

```
select max(len(Keywords) - len(replace(Keywords, ';', '')))
from user 
```

# r - r中某些值的具有自己颜色的热图

> ID：10572862
> 
> 赞同：4
> 
> 时间：2012-05-13T15:15:46.933
> 
> 标签：r, colors, scale, heatmap

这是数据：

```
set.seed(123)
mat <- matrix(rnorm(5000, 0.5, 0.2), 50)
heatmap (mat) 
```

![在此处输入图像描述](../Images/2ef5bbbe910f319101f5cf207c0c5f70.png)

```
mat[mat > 0.05] <- NA
heatmap (mat)

Error in hclustfun(distfun(x)) : 
  NA/NaN/Inf in foreign function call (arg 11) 
```

通过替换为其他值（任意值会有所帮助），但它会欺骗读者，因为它会从相同的比例中选择颜色，这是不正确的。所以我想为那些大于 0.05 的值设置完全不同的颜色。

```
mat[mat > 0.05] <- 0.1
heatmap (mat) 
```

![在此处输入图像描述](../Images/5b00e4b2a5353b81f968cec4962df118.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T15:58:59.940

maybe...

```
library(gplots)
set.seed(123)
mat <- matrix(rnorm(5000, 0.5, 0.2), 50)
heatmap.2(mat, breaks=c(-1,0.02,0.05,1), col=c("yellow", "red", "blue"), 
# aiming for >0.05 is blue
dendrogram="both", trace="none") 
```

Basically play around with `col=` and `breaks=`

looks like:

![enter image description here](../Images/243733a3fc433ef07ec687fd30d0086d.png)

# php - 用 PHP 在服务器上上传图像

> ID：10572865
> 
> 赞同：0
> 
> 时间：2012-05-13T15:17:11.417
> 
> 标签：php, image, upload

上传图片有问题...

这是上传脚本：

```
$image = imagecreatefromjpeg($_FILES['uploadfile']['tmp_name']) or die('Uploading     failed!');
$ext = '.jpg';
$last_id = mysql_insert_id($db);
$image_name = $last_id. $ext;
imagejpeg($image, $dir. '/'. $image_name, 100);
$priecinok = '/images/';
$place = $priecinok. $image_name; 
```

我收到此错误： *注意：未定义索引：第 124 行 H:\xampp\htdocs\transact.php 中的上传文件*

*警告：imagecreatefromjpeg() [function.imagecreatefromjpeg]：第 124 行的 H:\xampp\htdocs\transact.php 中的文件名不能为空上传失败！*

我正在上传图片：

```
<form enctype="multipart/form-data" action="transact.php" method="POST">
<table>
<tr>
<td>Nadpis:</td>
<td><input type="text" id="title" name="title" value="<?php echo   htmlspecialchars($title); ?>" /></td></tr>
<tr>
<td>Text článku:</td>
<td><textarea id="text" name="text" cols="55" rows="20"><?php if(!empty($a_text)) { echo htmlspecialchars($a_text); } ?></textarea></td>
</tr><tr>
<td>Obrázok k článku:</td>
<td><input type="file" name="uploadfile" /></td></tr>
<tr><td><input type="submit"name=" action" value="Odoslat" /> 
```

而当我键入 print_r($_FILES) 时，它只写： Array () 问题出在哪里？几天前它运行正常。

# r - 从包含一个或多个时间序列的数据框中绘制

> ID：10572869
> 
> 赞同：2
> 
> 时间：2012-05-13T15:17:56.107
> 
> 标签：r, plot, dataframe

我定期构建一个带有时间值（源自 xts 或 zoo 对象）的数据框，用于分析和绘图。这是一个例子：

```
library(xts)   

x1 <- xts(rnorm(10), as.Date("2012-01-01") + 0:9)   
x2 <- xts(rnorm(10), as.Date("2012-01-04") + 0:9)   

(df <- data.frame(merge(x1=x1, x2=x2), v1=4:16, v2=rnorm(13)))    

                   x1          x2 v1          v2   
2012-01-01  0.1930827          NA  4  1.05972724   
2012-01-02  0.4429592          NA  5 -1.89299068   
2012-01-03  1.6657630          NA  6  0.70445966  
2012-01-04 -0.2765922 -0.26728223  7  0.35336959   
2012-01-05 -0.1756590 -2.04888130  8  0.90129924  
2012-01-06 -2.4849132  0.49400975  9  1.54486914  
2012-01-07 -0.9993353 -1.09308203 10  1.16600015  
2012-01-08 -0.7326309  0.55781566 11  0.37178542  
2012-01-09 -0.2973543 -0.59872496 12  0.07512468  
2012-01-10 -1.5061380  0.08567125 13  1.77494367  
2012-01-11         NA  0.81835375 14 -0.38211167  
2012-01-12         NA  1.30131894 15 -1.09220795  
2012-01-13         NA -1.29505649 16  1.27148069 
```

要绘制时间序列，我需要使用`as.Date(row.names(df))`水平轴。例如：

```
plot(as.Date(row.names(df)), df$x1, type="l", xlab="", ylab="Test", main="Using row.names()", col="red")   
lines(as.Date(row.names(df)), df$x2, col="blue")    
lines(as.Date(row.names(df)), df$v2, col="green") 
```

`as.Date(row.names(df))`一遍又一遍地使用真的很痛苦，所以在过去，我使用以下代码在数据框中添加了一个列：

```
(df <- cbind(df, tim=as.Date(row.names(df)))) 
```

我现在可以将时间序列绘制为：

```
with(df, {  
  plot(tim, x1, type="l", xlab="", ylab="Test", main="Using a new tim column", col="red")  
  lines(tim, x2, col="blue")  
  lines(tim, v2, col="green")  
}) 
```

这种技术有效，但添加该`tim`列感觉很草率。有没有更好/更清洁的方法来做到这一点？

编辑 1 (2012-05-13) ====================================

我使用数据框的原因是因为这些数据通常被提供给需要数据框的一个或多个包，和/或因为我通常需要在某些变量中表示非数字数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T17:15:05.103

我会尽可能坚持使用动物园设施：

```
library(xts)   
x1 <- xts(rnorm(10), as.Date("2012-01-01") + 0:9)   
x2 <- xts(rnorm(10), as.Date("2012-01-04") + 0:9)   

dz <- merge(x1=x1, x2=x2); dz$v1=4:16; dz$v2=rnorm(13)    
 # keeps it a zoo object rather than a data.frame

with(dz, plot( x1, type="l", xlab="", ylab="Test", main="Not using row.names()\nStick with zoo" ) )
lines( dz$x2, col="blue")    
lines( dz$v2, col="green") 
```

![在此处输入图像描述](../Images/91c560f7e75bcfd075fca936bda195e5.png)

# sql-server - 将 Quartz 作业添加到正在运行的 SQL 服务器

> ID：10572874
> 
> 赞同：1
> 
> 时间：2012-05-13T15:18:44.043
> 
> 标签：sql-server, quartz-scheduler

我有一个 SQL DB，它的计划 Quartz 作业已经在系统中运行了一段时间。我想添加一份新工作，但是，每当我尝试添加时，我都会不断弄乱现有的工作。这是我的工作描述（其中一部分）：

![石英调度](../Images/8e32066bc95ea916a6b9d5e505e37ada.png)

我的主要问题是，当我插入新工作时，我不知道从哪个值开始。我知道这有点晦涩，但任何指向正确方向的指针都会很好。

# r - ggplot2 中的 geom_map 边界 - 重新访问

> ID：10572878
> 
> 赞同：5
> 
> 时间：2012-05-13T15:19:29.713
> 
> 标签：r, map, ggplot2

我在[这个问题](https://stackoverflow.com/questions/10305614/geom-map-borders-in-ggplot2)中遇到了与@Mike 类似的问题。问题是如何设置地图中区域的轮廓颜色。

`geom_polygon`建议的解决方案是在边界上添加一个绘图。只要绘制了整个区域，这将起作用。当试图限制到一个子区域时，多边形会被奇怪地绘制（可能是因为一些顶点被丢弃）。使用标准`geom_map`示例：

```
# Create example data
ids <- factor(c("1.1", "2.1", "1.2", "2.2", "1.3", "2.3"))
values <- data.frame(id = ids, value = c(3, 3.1, 3.1, 3.2, 3.15, 3.5))
positions <- data.frame(
  id = rep(ids, each = 4),
  x = c(2, 1, 1.1, 2.2, 1, 0, 0.3, 1.1, 2.2, 1.1, 1.2, 2.5, 1.1, 0.3, 0.5, 1.2, 2.5, 1.2, 1.3, 2.7, 1.2, 0.5, 0.6, 1.3),
  y = c(-0.5, 0, 1, 0.5, 0, 0.5, 1.5, 1, 0.5, 1, 2.1, 1.7, 1, 1.5, 2.2, 2.1, 1.7, 2.1, 3.2, 2.8, 2.1, 2.2, 3.3, 3.2)
)

# Plot data
ggplot(values, aes(fill = value)) + 
    geom_map(aes(map_id = id), map = positions) +
    geom_polygon(aes(x,y,group=id), fill = NA, colour = 'red', data = positions) +
    expand_limits(positions) +
    ylim(0, 3) 
```

一种可能的解决方法是使用颜色美学，`geom_map`然后使用 手动选择轮廓颜色`scale_colour_manual`，如下所示：

```
ggplot(values, aes(fill = value)) + 
    geom_map(aes(map_id = id, colour = 'white'), map = positions) +
    scale_colour_manual(values=c('white')) +
    expand_limits(positions) +
    ylim(0, 3) 
```

所以我有两个问题：

1.  `geom_polygon`限制轴限位时为什么不能正常工作？
2.  有没有比这里展示的更优雅的轮廓着色解决方案？

下面是绘图输出。提前谢谢了。

![使用 geom_polygon 无法正常工作](../Images/9505abb245ba153f9bd103269b1a557c.png) ![工作，但不是很优雅](../Images/82cf35e31f8f47df5b3600eaa39be48b.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-13T15:26:56.833

我相信你对为什么它不起作用是正确的。`xlim`在绘图之前使用或`ylim`剪辑数据来限制 x 或 y 限制。这最终会从你的多边形中省略一些顶点，所以有些东西不会被绘制出来。

这就是为什么有，它允许您在*不*裁剪数据的情况下`coord_cartesian`调整 x 和 y 限制。它将“放大”到正确的区域，而不是剪裁然后绘图。

 *所以，而不是`ylim`，尝试`+ coord_cartesian(ylim = c(0,3))`。*

# java - 如何使用 JSlider 控制 PC 扬声器的音量？

> ID：10572880
> 
> 赞同：0
> 
> 时间：2012-05-13T15:19:38.213
> 
> 标签：java, javasound, jslider

我目前正在用 Java 编写一个程序，我想用它来控制我的 PC 的主扬声器。目前我正在尝试使用`JSlider`. 有没有办法可以`ChangeListener`用来做到这一点？如果没有`ChangeListener`，是否有另一种方法可以将其集成到我的程序中？我一直在不知疲倦地在网上搜索这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T09:23:00.653

警告：关于声音的 Java 教程并不是最容易阅读的。

[http://docs.oracle.com/javase/tutorial/sound/accessing.html](http://docs.oracle.com/javase/tutorial/sound/accessing.html) 这个将向您展示如何找出系统上的内容。您需要确定哪条线路或端口对应于 OS 扬声器输出。

[http://docs.oracle.com/javase/tutorial/sound/controls.html](http://docs.oracle.com/javase/tutorial/sound/controls.html) 这个将向您展示如何在线路或端口上放置一个控件。然后，您将 JSlider 输出绑定到此控件。

如果（何时！）您遇到问题，也许可以从这个开始，然后在此过程中提出更具体的问题。

# android - 防止屏幕加载时闪烁并滚动到特定位置

> ID：10572897
> 
> 赞同：3
> 
> 时间：2012-05-13T15:23:04.823
> 
> 标签：android, android-webview, flicker, android-scroll

目标 - 一旦 webview 加载网页，我想滚动到（0,60）。至少我想防止网页完成加载时看到的闪烁。闪烁 - 当 web 视图加载一个 url（例如 wiki）时，用户可以滚动它来阅读文本。然而，当它完成加载时，webview 会自动滚动到顶部。这在标准浏览器上不会发生。我的目标是 API 8。（旧但人们仍在使用该版本）。

这是一些代码：

```
private class WebBrowserWebViewClient extends WebViewClient 
{   
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) 
    {
        Log.d(TAG, "Load URL");
        view.loadUrl(url);                                 
        return true;                
    }

    @Override
    public void onPageFinished(WebView view, String url) 
    {
        super.onPageFinished(view, url);

        Log.d(TAG, "Page Finished Loading");

        //Attempt scrollTo here does not work.
        view.scrollTo(0, 60);
    }            
} 
```

我还创建了一个图片监听器。

```
mWebView.setPictureListener(new PictureListener()
{               
        @Override
        public void onNewPicture(WebView view, Picture picture) 
        {
            Log.d(TAG, "On New Picture called....Y is " + view.getScrollY());

                //Does not work because it is called multiple times         
                view.scrollTo(0, 60);
            }       
}); 
```

我也一直在进步

```
mWebView.setWebChromeClient(new WebChromeClient()
{
       @Override
       public void onProgressChanged(WebView view, int newProgress) 
       {
            super.onProgressChanged(view, newProgress);

            Log.d(TAG,"On PRogress Changed. New Prgoress = " + newProgress);
       }
}); 
```

所以我注意到日志调试是在 webview 完成加载 URL 之前调用 onPageFinished() 。onNewPicture() 会根据 URL 中图片的数量被多次调用，并在 onPageFinsiehd() 被调用后调用。onProgressChanged() newProgress 总是达到 100 然后停止。在 onProgressChanged() 达到 100 并且 onNewPicture 触发后，webview 滚动回顶部。

问题 - 如何防止 webview 滚动回顶部？

*注意 - 我看过其他关于类似问题的帖子，但没有一个解决了这个问题。*

# python - 元组字典返回列表错误？

> ID：10572901
> 
> 赞同：-4
> 
> 时间：2012-05-13T15:23:27.960
> 
> 标签：python, dictionary, tuples

我的主程序有问题：

```
E, back = dict(), dict()

for C in range(cols+1): 
    E[0,C], back[0,C] = m[0,C], None 
```

哪个返回我这个错误：

> TypeError：列表索引必须是整数，而不是元组

我很困惑，因为我清楚地初始化了字典而不是列表。

这个错误是关于什么的，bot E 和 back 是第一行中所述的字典。但是当我尝试添加元素时，它会给我一个 LIST 错误？

编辑---“m”是像素数组“cols”是len（m [0]）我的代码的目的是对存储在m中的图像执行垂直Seam Carving，其中m [x] [y]是 x,y 位置像素的灰度。我不想要/不需要缝雕刻算法的帮助，但是这个错误信息现在让我发疯，没有任何意义。

好的，我在编辑中更正了自己......我试图将 m 作为字典访问，它确实是一个数组。真丢人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T15:26:40.830

您还没有显示所有代码，但我猜那`m`是一个列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-13T15:33:28.473

你说`m`的是一个列表列表。Python 中访问子列表元素的语法不是`[a, b]`it's `[a][b]`。

`m[0,C]`表示访问`m`由元组索引的元素`(0, C)`。

您想要的是获取 的元素`0`，`m`然后获取`C`该元素的元素，因此`m[0][C]`.

为了清楚地表明这一点：

```
>>> a = [list(range(5)) for _ in range(5)]
>>> a
[[0, 1, 2, 3, 4], [0, 1, 2, 3, 4], [0, 1, 2, 3, 4], [0, 1, 2, 3, 4], [0, 1, 2, 3, 4]]
>>> a[0, 2]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: list indices must be integers, not tuple
>>> a[0][2]
2 
```

您可以看到该错误完全有意义。

# c# - 在 C# 中编码字符

> ID：10572902
> 
> 赞同：3
> 
> 时间：2012-05-13T15:23:32.133
> 
> 标签：c#, .net, character-encoding, char

> **可能重复：**
> [char 对象对应于哪个字符编码（Unicode 版本）集？](https://stackoverflow.com/questions/6549054/to-which-character-encoding-unicode-version-set-does-a-char-object-correspond)

我有点害怕问这个，因为我确定以前有人问过，但我找不到。它可能很明显，但我以前从未研究过编码。

```
int Convert(char c)
{
    return (int)c;
} 
```

该方法产生什么编码？我认为它可能是 ASCII（至少对于 <128），但是执行下面的代码会产生......笑脸作为第一个字符？什么？绝对不是ASCII...

```
for (int i = 0; i < 128; i++)
    Console.WriteLine(i + ": " + (char)i); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T15:30:08.913

C#`char`使用 UTF-16 编码。[语言规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)1.3 Types and *variables*说：

> C# 中的字符和字符串处理使用 Unicode 编码。char 类型代表一个 UTF-16 代码单元，而 string 类型代表一个 UTF-16 代码单元序列。

UTF-16 与 ASCII 重叠，因为 ASCII 范围 0-127 中的字符代码在 UTF-16 中与 ASCII 中的含义相同。程序输出中的笑脸大概是您的控制台如何解释 0-31 范围内的不可打印字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T15:30:19.943

每个字符都是一个 UTF-16 代码点。但是，您应该使用正确的 Encoding 类来确保对 unicode 进行规范化。请参阅 [C# 和 UTF-16 字符](https://stackoverflow.com/questions/697055/c-sharp-and-utf-16-characters)

# marionette - 作用于 onRender 中的元素不起作用

> ID：10572906
> 
> 赞同：0
> 
> 时间：2012-05-13T15:24:03.293
> 
> 标签：marionette

当我尝试对`onRender`方法（或`item:rendered`回调）中的某些 HTML 元素进行操作时，它会失败。

例子：

```
Bars.EditGallery = Backbone.Marionette.ItemView.extend
  模板：'bars/edit_gallery'
  类名：'编辑画廊'

  渲染：->
    # 如果我只写@$('select').chosen() 是行不通的
    # 尽管 jQuery 对象包含我所期望的。
    # 为了让它工作，我必须写：
    回调 = -> @$('select').chosen()
    设置超时（回调，0）

```

其他操作也是如此，例如将焦点放在某个领域。
你怎么处理？有效的技巧，`setTimeout`但它不是很优雅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T12:56:27.057

当用于渲染的模板异步加载时，我已经看到了这种情况。我以为我的拉取请求在最近的版本中解决了这个问题。你用的是什么版本的木偶？

但无论如何，看起来你正在使用 JST，所以这不应该是问题。您的设置中是否还有其他任何内容导致渲染异步发生？

不过，似乎可能发生了一些异步问题。由于使用解决了这个问题，这让我认为在调用方法`setTimeout`之前渲染没有完成。`onRender`

此外 - 很难判断 jQuery 选择器是否真的立即返回了您想要的对象。如果您使用 console.log 来检查选择器，这可能会给出错误的结果。`console.log`本身是异步的（在大多数浏览器中，无论如何......不确定），这意味着记录项目的请求在事件循环结束时排队。记录发生时，DOM 元素很可能是可用的。

FWIW：我`onRender`经常使用这个确切的目的，而且我从来没有使用`setTimeout`它来使它工作。所以我的假设是渲染过程中发生的一些有趣的事情，与异步的东西有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T10:02:52.647

如本期所述，[此](https://github.com/harvesthq/chosen/issues/358)问题是由[Chosen](http://harvesthq.github.com/chosen/)引起的。

# java - 如何从列表中提取数据？

> ID：10572909
> 
> 赞同：-1
> 
> 时间：2012-05-13T15:24:08.507
> 
> 标签：java, android, tweets

我正在开发一个 Android 应用程序，我想识别主题标签、提及和链接。我有一个可以在我的建议中使用的 Objective-C 代码。我质疑[这些](https://stackoverflow.com/questions/10566449/translate-objective-c-code-to-recognize-links-to-java-for-android/10566572#10566572/)，现在我有这些代码：

```
import java.net.URL;
import java.util.List;

String input = /* text from edit text */;

String[] words = input.split("\\s");
List<URL> urls=null;

for (String s : words){
try 
{
    urls.add(new URL(s));
}
catch (MalformedURLException e) {
    // not a url
}

} 
```

现在我想把这些放在一条推文上，我已经开发了代码来做这件事，这条推文是基于一个字符串的。**我的问题是如何将列表中的数据放入字符串中？**

```
//I test these
String tweet="Using my app"+urls 
```

但在推文中出现“Using my appnull”

**我如何重用此代码来识别主题标签和提及？**

```
I think that is changing the input.split("\\s") by "@\\s" or "#\\s" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:34:17.080

你可以在这里使用一个库： [https](https://github.com/twitter/twitter-text-java) ://github.com/twitter/twitter-text-java 来做你想做的事情。

# php - 在多维数组php中搜索

> ID：10572913
> 
> 赞同：0
> 
> 时间：2012-05-13T15:25:07.150
> 
> 标签：php

我有一个包含各种站点链接的多维数组，这是输出：

```
Array
(
    [0] => Array
        (
            [0] => http://www.msn.com/etc
            [1] => http://www.yahoo.com/etc
            [2] => http://www.google.com
        )

    [1] => Array
        (
            [0] => http://www.abc.com/etc
            [1] => http://www.hotmail.com/etc
            [2] => http://www.hotmail.com/page/2
        )

    [2] => Array
        (
            [0] => http://www.live.com/etc
            [1] => http://www.google.com/etc
            [2] => http://www.stock.com
        )

) 
```

我想匹配多个 URL，这里是我的示例代码：

```
$sites = array("msn.com","hotmail.com","live.com");
$links = array(
    array("http://www.msn.com/1","http://www.yahoo.com/etc","http://www.google.com"),
    array("http://www.msn.com/2","http://www.hotmail.com/","http://www.hotmail.com/page/2"),
    array("http://www.live.com/etc","http://www.google.com/etc","http://www.stock.com")
); 
```

我需要 $sites 中的任何站点，首先它会从 $links 数组中找到 msn.com 站点，因此如果它在第一个数组（$links[0]）中找到 msn.com，它将不会在其他 $links 中搜索 msn.com数组但继续搜索其他（hotmail.com 和 live.com），如果它在一个数组中找到同一主机的 2 个链接，它将加入它们，这意味着如果它在一个数组元素中找到主机，它将不会搜索该主机在 $links 数组的其他元素中，因此上面的最终输出将是：

```
Array
(
    [msn] => Array
        (
            [0] => http://www.msn.com/1
        )

    [hotmail] => Array
        (
            [0] => http://www.hotmail.com/
            [1] => http://www.hotmail.com/page/2
        )

    [live] => Array
        (
            [0] => http://www.live.com/etc
        )

) 
```

我不确定如何执行此任务，我将不胜感激任何输入。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T15:48:25.793

最好我给你的是伪代码。

```
for each of the links arrays
    for each of the non eliminated sites
        find all the matching entries in this link array, for this site
        if theres at least one match
            eliminate this site from the list
            store the matches into a results array indexed by sitename, 
            --for example $results[$sitename] = $matchesArray 
```

玩得开心

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-13T15:59:05.267

这是完整的代码：

```
$final = array();
foreach($sites as $site)
{
    $found = false;
    foreach($links as $link_batch)
    {   
        foreach($link_batch as $link)
        {
            if(strpos($link, $site))
            {
                $found = true;
                $final[$site][] = $link;
            }
        }
        if($found)
        {
            break;
        }
    }
}
print_r($final); 
```

# javascript - 为什么画布和 webgl 渲染器不一样？(三.js)

> ID：10572914
> 
> 赞同：0
> 
> 时间：2012-05-13T15:25:10.347
> 
> 标签：javascript, opera, html5-canvas, webgl, three.js

我尝试用three.js渲染一个球体，但是如果我用canvasRenderer渲染它，那么球体上有灰线

代码：http: [//jsfiddle.net/jzpSJ/](http://jsfiddle.net/jzpSJ/)

截图：[http ://desmond.imageshack.us/Himg209/scaled.php?server=209&filename=canvase.png&res=landing](http://desmond.imageshack.us/Himg209/scaled.php?server=209&filename=canvase.png&res=landing)

但是如果我接下来在opera中使用webGL渲染器渲染它，那么它看起来很糟糕

代码：http: [//jsfiddle.net/jzpSJ/1/](http://jsfiddle.net/jzpSJ/1/)

截图：[http ://desmond.imageshack.us/Himg51/scaled.php?server=51&filename=webglopera.png&res=landing](http://desmond.imageshack.us/Himg51/scaled.php?server=51&filename=webglopera.png&res=landing)

在谷歌浏览器中，它看起来应该是这样。

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T16:53:53.350

**画布渲染器：**

更改材质定义，`overdraw: false`必须`overdraw: true`

**WebGLRenderer：**

WebGL 和 Opera？你在测试 alpha 版本吗？很多东西还是坏了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T15:39:38.717

尝试设置`dirty`和/或`dynamic`标志。看到[这个](https://github.com/mrdoob/three.js/issues/1155)和[这个](https://github.com/mrdoob/three.js/wiki/Updates)。

这并不能真正回答你的*问题*，但它可能是一个修复。

# jqgrid - 如何在 jqGrid 编辑模式中为 asp.net mvc 站点中的选择控件获取返回的值？

> ID：10572919
> 
> 赞同：0
> 
> 时间：2012-05-13T15:25:41.897
> 
> 标签：jqgrid

我有一个从 jqGrid 编辑表单中的 dataurl 填充选择列表的网格。这些值在 get 上成功填充。我将我的数据作为 json 撤回，并且对于选择列表中显示的项目，有一个带有字段 Id 和 Name 的自定义类型的 LookupItem - 这部分工作正常。例如，我有一个代表预定课程的对象模型（在下面的第二个代码示例中），它有一个 LookupItem 类型的 Location 字段，而 LookupItem 有 Id 和 Name 字段。

我的问题是，尽管在我的 ActionResult 方法中，这些字段没有发回服务器 - 我得到空值。我添加了一个 custom_func 函数并验证了 value 参数包含我正在寻找的 Id，但我不确定如何将其发布到 ActionResult 方法。有任何想法吗？

HTML/jqGrid 代码：

```
 $("#grid").jqGrid({
            url: 'ABC.Admin/CourseAdmin/GetScheduledCourses/',
            datatype: 'json',
            jsonReader: { repeatitems: false },
            mtype: 'GET',
            colNames: ['Id', 'Date', 'LocationId', 'Location', 'TimeId', 'Time', 'CostId', 'Cost', 'InstructorId', 'Instructor', 'Additional Info'],
            colModel: [
              { name: 'ScheduledCourseId', index: 'ScheduledCourseId', width: 40, key: true, hidden: true },
              { name: 'ScheduledCourseDate', index: 'ScheduledCourseDate', width: 50, editable: true },
              { name: 'Location.Id', index: 'Location.Id', width: 25, editable: false, hidden: true },
              { name: 'Location.Name', index: 'Location.Name', width: 150, editable: true, edittype: 'select',
                  editoptions: {
                      dataUrl: 'ABC.Admin/CourseAdmin/GetLookupItems?lookupType=locations',
                      buildSelect: createSelectList
                  },
                  editrules: {
                    custom: true, 
                    custom_func: locationCheck
                  }

              },
              { name: 'Time.Id', index: 'Time.Id', width: 25, editable: false, hidden: true },
              { name: 'Time.Name', index: 'Time.Name', width: 50, editable: true, edittype: 'select',
                  editoptions: {
                      dataUrl: 'ABC.Admin/CourseAdmin/GetLookupItems?lookupType=times',
                      buildSelect: createSelectList
                  }
              },
              { name: 'Cost.Id', index: 'Cost.Id', width: 25, editable: false, hidden: true },
              { name: 'Cost.Name', index: 'Cost.Name', width: 50, editable: true, edittype: 'select',
                  editoptions: {
                    dataUrl: 'ABC.Admin/CourseAdmin/GetLookupItems?lookupType=costs',
                    buildSelect: createSelectList 
                  }
              },
              { name: 'Instructor.Id', index: 'Instructor.Id', width: 25, editable: false, hidden: true },
              { name: 'Instructor.Name', index: 'Instructor.Name', width: 100, editable: true, edittype: 'select',
                  editoptions: {
                      dataUrl: 'ABC.Admin/CourseAdmin/GetLookupItems?lookupType=instructors',
                      buildSelect: createSelectList                      
                      }
              },
              { name: 'AdditionalInfo', index: 'AdditionalInfo', width: 200, editable: true, edittype: 'textarea',
                  editoptions: {
                      rows: "6", 
                      cols: "40"
                  } 
              },
            ],
            pager: jQuery('#pager'),
            rowNum: 20,
            sortname: 'Date',
            sortorder: "asc",
            viewrecords: true,
            caption: 'Scheduled Courses',
            height: 400,
            loadonce: true, // needs to be true for client side paging to work
            autowidth: true,
            loadtext: 'Loading...'
        })
        $("#grid").jqGrid('navGrid', '#pager', { edit: true, add: true, del: true },
            { /* edit options */
                url: 'ABC.Admin/CourseAdmin/UpdateScheduledCourse/',
                closeOnEscape: true,
                closeAfterEdit: true,
                width: 450
            },
            { /* add options */
                url: 'ABC.Admin/CourseAdmin/CreateScheduledCourse/',
                closeOnEscape: true,
                closeAfterAdd: true
            },
            { /* delete options */
                url: 'ABC.Admin/CourseAdmin/DeleteScheduledCourse/',
                closeOnEscape: true
            }
        );

    });

        function locationCheck(value, colname) {
            debugger;
            if (value < 0 || value > 20)
                return [false, "Please enter value between 0 and 20"];
            else
                return [true, ""];
        } 
```

ScheduledCourse 的对象模型：

```
public class ScheduledCourse
    {
        public ScheduledCourse() { }
    //for admin scheduled course page
    public ScheduledCourse(int scheduledCourseId, string scheduledCourseDate, int locationId, string locationName,
        int timeId, string timeName, int costId, string costName, int instructorId, string instructorName, string additionalInfo)
    {
        this.ScheduledCourseId = scheduledCourseId;
        this.ScheduledCourseDate = scheduledCourseDate;
        this.Location = new LookupItem(locationId, locationName);
        this.Time = new LookupItem(timeId, timeName);
        this.Cost = new LookupItem(costId, costName);
        this.Instructor = new LookupItem(instructorId, instructorName);
        this.AdditionalInfo = additionalInfo;
    }

    public int ScheduledCourseId { get; set; }
    public string ScheduledCourseDate { get; set; }
    public LookupItem Location { get; set; }
    public LookupItem Time { get; set; }
    public LookupItem Cost { get; set; }
    public LookupItem Instructor { get; set; }
    public string UserName { get; set; }
    public string AdditionalInfo { get; set; }
}
public class LookupItem
{
    public LookupItem(int id, string name)
    {
        this.Id = id;
        this.Name = name;
    }

    public int Id { get; set; }
    public string Name { get; set; }
} 
```

控制器代码：

```
 //colNames: ['Id', 'Date', 'LocationId', 'Location', 'TimeId', 'Time', 'CostId', 'Cost', 'InstructorId', 'Instructor', 'Additional Info'],
    [HttpPost]
    public ActionResult UpdateScheduledCourse(string oper, int id, string scheduledCourseDate, string location, string locationId, string timeId, 
        string timeName, string costId, string costName, string instructorId, string instructorName, string additionalInfo)
    {
        Models.ScheduledCourseProvider p = new Models.ScheduledCourseProvider();

        //Models.ScheduledCourse o = new Models.ScheduledCourse(
        //    id, scheduledCourseDate, Convert.ToInt32(locationId), locationName, Convert.ToInt32(timeId), timeName, Convert.ToInt32(costId), 
        //    costName, Convert.ToInt32(instructorId), instructorName, additionalInfo);

        //bool saved = p.UpdateScheduledCourse(o);

        bool saved = false;
        if (!saved)
        {
            Response.StatusCode = 500;
            return Content("Record not saved!");
        }
        else
        {
            return Json(false);
        }
    } 
```

以下是在控制器中调用 ActionResult 方法时传递给服务器的参数 (http://localhost:30320/OrchardLocal/ABC.Admin/CourseAdmin/UpdateScheduledCourse/) - 请注意正在使用的点符号，因为我是使用共享类型的 LookupItem：

```
ScheduledCourseDate=07%2F01%2F2011&Location.Name=10016&Time.Name=1014&Cost.Name=1001&Instructor.Name=10001&AdditionalInfo=blahblahblah&oper=edit&id=12126 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T06:30:37.877

首先，您应该将`name`列的属性更改为内部没有点。例如，您可以改用下划线。此外，我不确定您是否需要`'Location.Id'`,`'Time.Id'`和`'Instructor.Id'`. 如果服务器需要它，您可以使用`name: 'location', jsonmap: 'Location.Name'`. 以同样的方式，您可以使用`name: 'scheduledCourseDate', jsonmap: 'ScheduledCourseDate'`代替`name: 'ScheduledCourseDate'`.

更改后，从选择中选择的 ID 将通过短名称“位置”、“时间”和“讲师”发布。所以你可以在`UpdateScheduledCourse`方法中使用名称

```
[HttpPost]
public ActionResult UpdateScheduledCourse(string oper, int id, string scheduledCourseDate,
    string location, string time, string cost, string instructor, string additionalInfo) 
```

# xml - 如何设置 XMLNS 元素的样式？

> ID：10572930
> 
> 赞同：0
> 
> 时间：2012-05-13T15:27:26.057
> 
> 标签：xml, html, xml-namespaces

我试图定义我自己的 HTML 属性不是为了样式目的，而是主要是因为它们实际上会获得 javascript 中描述的函数。现在我知道 HTML5 带有`data-`属性，但我个人喜欢我自己的 HTML 标签的想法。

浏览互联网我发现 XMLNS 是要走的路，但是，我找不到如何设置这些元素的样式。

有人可以对此事有所了解吗？

[http://jsfiddle.net/KaJT8/](http://jsfiddle.net/KaJT8/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:34:08.753

如果您的元素名为 ui:tabbar，则需要使用如下选择器：

```
ui\:tabbar {

} 
```

在你的 CSS 中。您需要在旧版本的 IE 中对此进行测试，因为我相信他们需要更多的强制。

尽管您可能知道，但这并不是您真正“打算”做的事情，而且您会发现很多人认为您完全是个疯子来建议它 :)

# linux - Java Swing - 当JFrame最大化时，鼠标指针在上下文菜单上“移动”

> ID：10572934
> 
> 赞同：4
> 
> 时间：2012-05-13T15:28:16.730
> 
> 标签：linux, swing, java

在最大化 JFrame 时，我遇到了 Swing 处理鼠标位置的奇怪行为：

当我执行这个非常简单的代码时......

```
public class Test {
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame();

                JMenuBar menubar = new JMenuBar();
                JMenu menu = new JMenu("File");
                menu.add(new JMenuItem("New"));
                menubar.add(menu);
                frame.setJMenuBar(menubar);

                frame.setSize(200, 200);
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
} 
```

...我通常可以单击`File`（第一次单击-按下，释放）-> `New`（第二次单击）。但是当我最大化 JFrame 并单击时`File`- 上下文菜单会在鼠标释放时立即消失。此外，当我按住鼠标按钮时 - 为了防止消失 - 我必须将鼠标移动得更远以专注于`New`项目。

![鼠标移位](../Images/e32ab773752dd7a3036ceaa50c2f0995.png)

红点表示在按住鼠标按钮`New`后我必须移动鼠标以聚焦的区域（或多或少） 。`File`

我在使用“右键单击上下文菜单”时观察到相同的行为，例如在 JFreeChart 中右键单击图表时。

我以为是 JDK 的问题，因为我使用了 Oracle 的 JDK，但是安装 OpenJDK 后我得到了相同的结果。

有人观察到这种奇怪的行为吗？还是我错过了一些明显的东西？

我用：

*   1.7.0_147-icedtea（或 1.7.0_04 用于 java-7-oracle）
*   OpenJDK 运行时环境 (IcedTea7 2.0) (7~b147-2.0-0ubuntu0.11.10.1)
*   OpenJDK 64 位服务器 VM（内部版本 21.0-b17，混合模式）
*   Linux Mint 12 (lisa) GNOME 3.2.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T06:06:44.810

是的 - 这是@nIcE cOw 提到的 JDK7 中的一个错误。

我已经安装了 JDK6，但无法重现此错误。

```
java version "1.6.0_23"
OpenJDK Runtime Environment (IcedTea6 1.11pre) (6b23~pre11-0ubuntu1.11.10.2)
OpenJDK 64-Bit Server VM (build 20.0-b11, mixed mode) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T12:42:10.337

当需要使用 Oracle Java 7 时（例如使用 JavaFX 时），还有一种解决方法。只需将以下代码行添加到您的窗口/框架类：

```
 if (Arrays.asList("gnome-shell", "mate", "other...").contains(System.getenv("DESKTOP_SESSION"))) {
        try {
            Class<?> xwm = Class.forName("sun.awt.X11.XWM");
            Field awt_wmgr = xwm.getDeclaredField("awt_wmgr");
            awt_wmgr.setAccessible(true);
            Field other_wm = xwm.getDeclaredField("OTHER_WM");
            other_wm.setAccessible(true);
            if (awt_wmgr.get(null).equals(other_wm.get(null))) {
                Field metacity_wm = xwm.getDeclaredField("METACITY_WM");
                metacity_wm.setAccessible(true);
                awt_wmgr.set(null, metacity_wm.get(null));
            }
        }
        catch (Exception x) {
            x.printStackTrace();
        }
    } 
```

此代码片段基于[Netbeans 开发人员的解决方法](http://hg.netbeans.org/core-main/rev/409566c2aa65)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-27T23:41:39.287

我想补充problemzebra给出的解决方案。

对于我来说，Linux 上的任何 Swing 应用程序（使用 Cinnamon 桌面）仍然会发生这种情况，即使在 Java 6（更新 45）上也是如此

每次我移动窗口或调整窗口大小时都会再次出现该问题，因此每次窗口更改时都需要重新应用解决方法。我创建了以下类并在创建新窗口时使用它：

```
class LinuxWindowFix implements WindowStateListener {

    private final String desktop;
    private Field metacity_wm;
    private Field awt_wmgr;
    private boolean applyFix;

    private static LinuxWindowFix instance = new LinuxWindowFix();

    public static LinuxWindowFix getInstance() {
        return instance;
    }

    private LinuxWindowFix() {
        applyFix = false;

        List<String> linuxDesktops = Arrays.asList("gnome-shell", "mate", "cinnamon"); //add more desktop names here.

        desktop = System.getenv("DESKTOP_SESSION");
        if (desktop != null && linuxDesktops.contains(desktop.toLowerCase())) {
            try {
                Class<?> xwm = Class.forName("sun.awt.X11.XWM");
                awt_wmgr = xwm.getDeclaredField("awt_wmgr");
                awt_wmgr.setAccessible(true);
                Field other_wm = xwm.getDeclaredField("OTHER_WM");
                other_wm.setAccessible(true);
                if (awt_wmgr.get(null).equals(other_wm.get(null))) {
                    metacity_wm = xwm.getDeclaredField("METACITY_WM");
                    metacity_wm.setAccessible(true);
                    applyFix = true;
                }
            } catch (Exception ex) {
                //ignore
            }
        }
    }

    @Override
    public void windowStateChanged(WindowEvent e) {
        try {
            awt_wmgr.set(null, metacity_wm.get(null));
        } catch (Exception ex) {
            //ignore
        }
    }

    public void apply(Window w) {
        if (!applyFix) {
            return;
        }
        w.removeWindowStateListener(this);
        w.addWindowStateListener(this);
    }
} 
```

只需为您创建的每个窗口调用它，它就会按预期工作。

```
LinuxWindowFix.getInstance().apply(myWindow); 
```

# github - 管理我的存储库的可见性

> ID：10572936
> 
> 赞同：0
> 
> 时间：2012-05-13T15:28:42.297
> 
> 标签：github

我已将我的项目推送到 GitHub 上的存储库。我的帐户是免费模式。我不能管理我的存储库的可见性，以便我让它只对我的队友可见（红色和写入）。

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:37:34.167

不，没有免费帐户。只有付费帐户才允许私人回购。见[https://github.com/plans](https://github.com/plans)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T14:55:45.543

@swatso33 是正确的。[但如果您是学生，您可以访问github.com/edu](https://github.com/edu)免费获得 Github Micro 计划。它将免费使用两年。在该微型帐户上，您可以管理可见性。

# c++ - ld 查找库

> ID：10572938
> 
> 赞同：0
> 
> 时间：2012-05-13T15:28:54.840
> 
> 标签：c++, build-process, ld

我正在交叉编译到 arm 嵌入式系统并收到一个我有疑问的错误。这是错误：

```
[ 19%] Built target cxjpeg-6b
Linking CXX shared library /home/botbear/JAUS++-2.110519-   src/libraries/jaus++/2.0/lib/libcxutils.so
/home/botbear/openwrt/trunk/staging_dir/toolchain-arm_v6k_gcc-linaro_uClibc-    0.9.32_eabi/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.5.4/../../../../arm-openwrt-linux-    uclibcgnueabi/bin/ld: cannot find -lpng 
collect2: ld returned 1 exit status
make[2]: *** [/home/botbear/JAUS++-2.110519-src/libraries/jaus++/2.0/lib/libcxutils.so]     Error 1
make[1]: *** [libcxutils/CxUtils/libcxutils/CMakeFiles/cxutils.dir/all] Error 2
make: *** [all] Error 2 
```

如您所见，链接器正在寻找一个名为“libpng”的静态库。除了 libpng 库之外，子 make 文件中的命令使用 -l 开关链接到以​​下库：-lpng -lz -lX11 -lXtst -lpthread -Wl。所有库（libpng、libz、libX11 等）都在我的主机 /usr/lib/ 目录中，但我的目标工具链没有这些库。我的问题是如果我用我的目标编译器手动重新编译库会解决我的问题吗？或者我将为我的目标平台的每个库查找并安装包。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:38:02.087

你似乎是为目标编译的，所以你需要目标库。可以自己编译，也可以由工具链开发环境提供（如果有的话）。后者通常会为您省去一些麻烦（交叉编译并在必要时设置路径）。

我看到你正在使用 openwrt 工具链。Openwrt 似乎将 libpng 作为一个包。如果可能的话，我会同意的。

# python - 在 Python 和 matplotlib 中连接 3D 散点图中的两个点

> ID：10572939
> 
> 赞同：20
> 
> 时间：2012-05-13T15:29:00.903
> 
> 标签：python, matplotlib, mplot3d

在下面的代码中，如何在 .show() 指令之前创建由两行代码创建的连接每对散点图的线（即，将绿色圆圈连接到黄色箭头）？

```
import matplotlib.pyplot
from mpl_toolkits.mplot3d import Axes3D

dates       = [20020514, 20020515, 20020516, 20020517, 20020520]
highs       = [1135, 1158, 1152, 1158, 1163]
lows        = [1257, 1253, 1259, 1264, 1252]
upperLimits = [1125.0, 1125.0, 1093.75, 1125.0, 1125.0]
lowerLimits = [1250.0, 1250.0, 1156.25, 1250.0, 1250.0]

zaxisvalues0= [0, 0, 0, 0, 0]
zaxisvalues1= [1, 1, 1, 1, 1]
zaxisvalues2= [2, 2, 2, 2, 2]

fig = matplotlib.pyplot.figure()
ax  = fig.add_subplot(111, projection = '3d')

ax.plot(dates, zaxisvalues1, lowerLimits, color = 'b')
ax.plot(dates, zaxisvalues2, upperLimits, color = 'r')

ax.scatter(dates, zaxisvalues0, highs, color = 'g', marker = "o")
ax.scatter(dates, zaxisvalues0, lows, color = 'y', marker = "^")

matplotlib.pyplot.show() 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-13T16:15:45.537

在这些点之间画一条线段：

```
import matplotlib.pyplot
from mpl_toolkits.mplot3d import Axes3D

dates       = [20020514, 20020515, 20020516, 20020517, 20020520]
highs       = [1135, 1158, 1152, 1158, 1163]
lows        = [1257, 1253, 1259, 1264, 1252]
upperLimits = [1125.0, 1125.0, 1093.75, 1125.0, 1125.0]
lowerLimits = [1250.0, 1250.0, 1156.25, 1250.0, 1250.0]

zaxisvalues0= [0, 0, 0, 0, 0]
zaxisvalues1= [1, 1, 1, 1, 1]
zaxisvalues2= [2, 2, 2, 2, 2]

fig = matplotlib.pyplot.figure()
ax  = fig.add_subplot(111, projection = '3d')

ax.plot(dates, zaxisvalues1, lowerLimits, color = 'b')
ax.plot(dates, zaxisvalues2, upperLimits, color = 'r')

for i,j,k,h in zip(dates,zaxisvalues0,lows,highs):
    ax.plot([i,i],[j,j],[k,h],color = 'g')

ax.scatter(dates, zaxisvalues0, highs, color = 'g', marker = "o")
ax.scatter(dates, zaxisvalues0, lows, color = 'y', marker = "^")

matplotlib.pyplot.show() 
```

产生：

![在此处输入图像描述](../Images/25e31649b18d5ead096b4ac1dd4ebb0b.png)

# android - 做一个搜索功能

> ID：10572941
> 
> 赞同：-2
> 
> 时间：2012-05-13T15:29:14.093
> 
> 标签：android

我想为我的 android 应用程序添加搜索功能。我想要你要在应用程序中搜索的东西，而不是数据库或类似的东西！:) 所以是的，也许有人可以给我链接一个教程或什么的？:)

谢谢！（真的很抱歉英语不好！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T15:44:34.720

你应该看看这个教程：

[搜索员工](http://coenraets.org/blog/android-samples/androidtutorial/)

这个来自 android 开发者[网站](http://developer.android.com/guide/topics/search/search-dialog.html#SearchingYourData)

# vb.net - VB silverlight for windows phone "System.Xml.Linq"

> ID：10572943
> 
> 赞同：0
> 
> 时间：2012-05-13T15:29:24.743
> 
> 标签：vb.net, silverlight, windows-phone-7

我的两个 Windows Phone 应用程序中有这条线：

`Dim doc = XDocument.Parse(e.Result)` 在其中一个应用程序中运行良好，在另一个应用程序中似乎错误......实际上它找不到对象“XDocument”

当我打字时：

`Imports System.Xml.Linq`

它向我发送错误警告：

`Warning 2
Namespace or type specified in the Imports 'System.Xml.Linq' doesn't contain any public member or cannot be found. Make sure the namespace or the type is defined and contains at least one public member. Make sure the imported element name doesn't use any aliases.`

有效的应用程序和向我发回这个错误和磨损的应用程序之间的唯一区别是，一个是简单的 Windows Phone 页面（工作页面），另一个是全景页面：S

任何想法为什么我有这个警告？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:31:48.610

我认为您可能需要首先使用 Visual Studios“添加引用”命令包含对 System.XML.Linq 的引用（在项目资源管理器中右键单击您的项目节点，添加引用）。

# ruby-on-rails - Rails 验证和自定义错误消息

> ID：10572945
> 
> 赞同：1
> 
> 时间：2012-05-13T15:29:30.350
> 
> 标签：ruby-on-rails, ruby, validation

我遇到了验证问题，如果我使用以下语法，一切都很好（没有失败）。

```
validates :title, uniqueness: true 
```

但是，如果我将其更改为此，我会失败。

```
validates :title, uniqueness: {message: 'Title must be unique'} 
```

以下是完整性测试：

```
test "product is not valid without a unique title " do
  product = Product.new( title: products(:ruby).title,
  description: "yyy",
  price: 1,
  image_url: "fred.gif" )

  assert !product.save
  assert_equal "has already been taken", product.errors['title'].join('; ')
end 
```

我有一个固定装置，可以为 Ruby 产品等添加书名。

据我了解，这两个验证应该是相同的，只是一个给出了自定义错误消息。这是我在使用自定义消息时遇到的错误。

1) 失败：test_product_is_not_valid_without_a_unique_title_(ProductTest) <“已被采用”> 预期但 <“标题必须是唯一的”>。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:04:59.453

这里：

```
assert_equal "has already been taken", product.errors['title'].join('; ') 
```

您希望在错误哈希中看到“已被占用”，但您已使用自定义消息覆盖了此消息。测试显示您的自定义消息按原样显示。为什么你仍然期待默认消息？你必须期待`Title must be unique`。

**提示**不要在自定义消息中提供字段名称。Rails 会在生成错误时自动处理它，例如`product.errors.full_messages`（“必须是唯一的”就足够了）。

# html - 如何使用 PHP 最小化 HTML 以提高性能

> ID：10572952
> 
> 赞同：1
> 
> 时间：2012-05-13T15:30:29.227
> 
> 标签：html, css, minify, minimize

我对最小化的概念有些陌生，但它似乎很简单。我了解 jQuery 之类的库如何从最小化中受益，但我的问题是它是否应该扩展到 HTML 和 CSS（我已经看到 CSS 重置最小化代码，所以性能的提高可能已经被衡量）。

首先，我不知道如何衡量提高的性能，但我想知道你们中是否有人对最小化 HTML 和 CSS 代码时可以预期的性能提升幅度有任何知识或经验（大量、可忽略不计等）。

最后，我知道 HTML 尤其是 XHTML 应该对维护代码的人尽可能可读，这就是为什么我认为最好只在渲染时使用 PHP 来最小化这段代码。如果这是可行的，那么最好的方法是什么？只是修剪 HTML 和 CSS ( `$html = trim($html);`)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T15:52:31.630

雅虎有一些[高性能的网站规则](http://developer.yahoo.com/performance/rules.html "加快网站速度的最佳实践")。我引用了一些规则。仔细阅读。这些规则回答了你的问题。

> 前端工程师做出的决定可以显着减少通过网络传输 HTTP 请求和响应所需的时间。确实，最终用户的带宽速度、互联网服务提供商、与对等交换点的接近程度等都超出了开发团队的控制范围。但是还有其他变量会影响响应时间。压缩通过减小 HTTP 响应的大小来缩短响应时间。
> 
> 缩小是从代码中删除不必要的字符以减小其大小从而缩短加载时间的做法。缩小代码后，所有注释以及不需要的空白字符（空格、换行符和制表符）都会被删除。在 JavaScript 的情况下，这会提高响应时间性能，因为下载文件的大小会减小。两种用于压缩 JavaScript 代码的流行工具是 JSMin 和 YUI Compressor。YUI 压缩器还可以缩小 CSS。

因此，最小化将通过 HTTP 传输的任何内容会减少传输时间。因此，在渲染方面领先一步。因此，您的网站运行速度更快。如果启用压缩，站点性能改进将是显着的。此外，如果您压缩和缩小 Javascript、HTML 和 CSS，一切都会变得更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-05T12:59:57.390

```
<?php header('Expires: '.gmdate('D, d M Y H:i:s \G\M\T', time() + 3600));
header('Content-Type: text/html; charset=utf-8');
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
header('X-UA-Compatible: IE=Edge,chrome=1');
function ob_html_compress($buf){
    return preg_replace(array('/<!--(?>(?!\[).)(.*)(?>(?!\]).)-->/Uis','/[[:blank:]]+/'),array('',' '),str_replace(array("\n","\r","\t"),'',$buf));
}
ob_start("ob_html_compress"); ?>
<?php // Your Code ?>
<?php ob_end_flush(); ?> 
```

我正在使用我的简单 php 脚本在一行中优化 HTML

见例子：[http ://cs.lviv.pro/](http://cs.lviv.pro/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-13T15:35:22.187

要在这种情况下测量性能，您可以使用一些工具，例如 YSlow（在 firefox > firebug 中）或 Chrome 检查器中的 Profile 选项卡。

要加快网页速度，有很多事情要做。如果您有许多小图像（图标），最好将所有图像加入一个大图像并使用 css 选择正确的图像。并按顺序放置css和script标签。

# machine-learning - 实例的数量或实例的内容更重要（机器学习）？

> ID：10572955
> 
> 赞同：0
> 
> 时间：2012-05-13T15:32:21.380
> 
> 标签：machine-learning, classification, document-classification

比如说在文档分类领域，如果我有一个包含 1000 个实例的数据集，但实例（文档）的内容相当少；而且我有另一个包含 200 个实例的数据集，但每个实例都具有更丰富的内容。如果 IDF 不在我的考虑范围之内，那么训练实例的数量真的很重要吗？分类算法是否会考虑到这一点？

谢谢。山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T17:48:20.500

您可以将其视为一般的机器学习问题。可以帮助您了解训练数据大小的重要性的最简单问题是曲线拟合。

分类器或拟合模型的不确定性和偏差是样本量的函数。小样本量是一个众所周知的问题，我们经常试图通过收集更多的训练样本来避免这个问题。这是因为非线性分类器的不确定性估计是通过模型的线性近似来估计的。而这种估计只有在有大量样本作为[中心极限定理](http://en.wikipedia.org/wiki/Central_limit_theorem)的主要条件时才是准确的。

在决定训练样本大小时，异常值的比例也是您应该考虑的一个重要因素。如果更大的样本量意味着更大比例的异常值，那么应该限制样本量。

文档大小实际上是特征空间大小的间接指标。例如，如果从每个文档中您只有 10 个特征，那么您正在尝试在 10 维空间中分离/分类文档。如果每个文档中有 100 个特征，那么在 100 维空间中也会发生同样的情况。我想您很容易看到在更高维度上分隔文档的画线更容易。

对于文档大小和样本大小，经验法则是尽可能高，但实际上这是不可能的。例如，如果您估计分类器的不确定性函数，那么您会发现样本量高于该阈值的阈值实际上不会减少不确定性和偏差。根据经验，您还可以通过蒙特卡罗模拟找到某些问题的阈值。

大多数工程师不会费心去估计不确定性，这通常会导致他们实施的方法的行为不理想。这对于玩具问题来说很好，但在考虑到估计和计算的不确定性的现实问题中，对于大多数系统来说都是至关重要的。我希望这能在一定程度上回答你的问题。

# android - Android，通知区右侧的闹钟图标？

> ID：10572956
> 
> 赞同：3
> 
> 时间：2012-05-13T15:32:37.307
> 
> 标签：android, notifications

当我使用内置闹钟应用程序设置闹钟时，通知区域右侧会出现一个图标。但如果我用 AlarmManager 设置警报，它就不会存在。有没有办法让那个图标显示？

* * *

我发现闹钟似乎实际上将记录写入 ContentProvider 而不是直接使用 AlarmManager。我明天试一试。

而且似乎提供者不打算被其他应用程序使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T15:47:34.677

> 有没有办法让那个图标显示？

该图标用于作为固件一部分的闹钟应用程序。只有当用户有一个活跃的闹钟闹钟时，该图标才会出现。它不能被 Android SDK 直接操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T16:10:04.957

此图标是闹钟应用程序的一部分，而不是 android SDK。Android 有一个内置（库存）闹钟应用程序，但许多供应商（如三星）正在用他们自己的替换它。因此，没有一种安全的方法可以从您的应用程序中显示该特定图标。

最好的方法是制作自己的图标，因为您正在制作一个设置警报的应用程序并且您希望您的用户得到通知。

PS 这是[在股票 AlarmClock 应用程序中显示图标的 Activity 代码，](https://github.com/android/platform_packages_apps_alarmclock/blob/master/src/com/android/alarmclock/AlarmReceiver.java)正如您在第 181 行中看到的那样，图标的可绘制对象是**R.drawable.stat_notify_alarm**而不是 Android.R.drawable.stat_notify_alarm 所以你不能使用它。

希望这可以帮助...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-16T10:22:53.090

（从相关问题的自我回答中交叉发布：[控制状态栏中的警报图标](https://stackoverflow.com/questions/23105038/controlling-the-alarm-icon-in-status-bar)）

* * *

## v5 棒棒糖

Lollipop 最终移除了那些私有 API 功能。此技术不再适用于 v5。

我专门发布了一个关于 Lollipop 的新问题，希望很快能得到答案：

*   [Lollipop API 用于控制状态栏中的警报图标](https://stackoverflow.com/questions/28367822/lollipop-api-for-controlling-the-alarm-icon-in-status-bar)

## 前棒棒糖

这是使用**私有 api**属性的方式完成的：

```
protected void setStatusBarIcon(boolean enabled)
{
    Intent alarmChanged = new Intent("android.intent.action.ALARM_CHANGED");
    alarmChanged.putExtra("alarmSet", enabled);
    sendBroadcast(alarmChanged);
} 
```

感谢 Andy Savage 在这个 Google Groups 线程上：

*   [带有警报图标的 AlarmManager](https://groups.google.com/d/topic/android-developers/pUP15UcZi2M/discussion)
*   [存档帖子的直接链接](https://www.mail-archive.com/android-developers@googlegroups.com/msg138053.html)

* * *

**重要说明：**如上所述，这使用私有的、未记录的属性。正如 Dianne Hackborn 在同一线程中指出的那样，所有常见的警告都适用于此：

> 请注意，当您看到这样的原始字符串（“android.intent.action.ALARM_CHANGED”和“alarmSet”）时，您的脑海中应该会响起警告铃声，表明这是使用私有 API。
> 
> 确实如此。
> 
> 如果您使用它，如果它在未来随机中断在某些设备上不起作用，请不要感到惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T15:39:35.820

根据我从您的问题中了解到的情况，您想知道如何使图标出现在通知区域中。

你必须自己编程。该文档很好地概述了这一点。

[http://developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

# iphone - 通过蓝牙播放时 AVAudioPlayer 不流畅

> ID：10572963
> 
> 赞同：0
> 
> 时间：2012-05-13T15:33:51.980
> 
> 标签：iphone, audio

我使用 AVAudioPlayer 播放音乐文件。它在通过 iPhone 机身上的耳机或扬声器播放时效果很好。但通过蓝牙播放时不流畅。为什么？

这是我的代码：

```
AVAudioPlayer *newMusicPlayer = [[AVAudioPlayer alloc] initWithData:musicData error:&error];
if (!newMusicPlayer)
{
}
else
{
    [newMusicPlayer play];
} 
```

特别感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T06:56:16.800

This is an apple's bug on 3GS running ios5.1.1, because "Music" is not smooth too.

# sql - 在运行时更新悖论表

> ID：10572965
> 
> 赞同：0
> 
> 时间：2012-05-13T15:34:09.653
> 
> 标签：sql, delphi, runtime

我目前正在使用以下方法在运行时将字段添加到悖论表。

```
procedure TfrmMain.AddField(UpdTable, FieldName, FieldType: string);
begin
 with qryUpdate do
 begin
  Close;
  ParamByName('UPDTABLE').AsString := UpdTable;
  ParamByName('FLDNAME').AsString  := FieldName;
  ParamByName('FLDTYPE').AsString  := FieldType;
  ExecSQL;
  Open;
 end;
end;

procedure TfrmMain.FormShow(Sender: TObject);
begin
  AddField('Test','newfield', 'VARCHAR(30)');
end; 
```

在名为“qryUpdate”的组件中，我有以下查询：

```
ALTER TABLE :UPDTABLE
ADD :FLDNAME :FLDTYPE 
```

但是，执行查询时会显示以下消息：

> 关键字使用无效。
> 
> 令牌：？
> 
> 行号：1。

我究竟做错了什么？

另一个（相关）问题：将这样的字段添加到现有数据库是否会损害现有字段/数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T03:16:08.387

您只能将字段添加到表中一次！编写的代码将在每次运行程序时尝试添加该字段。在添加新字段之前，您应该首先检查您的表包含多少个字段。

我曾经使用以下代码在运行时添加字段（这是用于 BDE/Paradox 表）

```
with ttable.create (nil) do
 try
  databasename:= 'whatever';
  tablename:= 'test.db';
  open;
  fc:= fieldcount;
  close;
 finally
  free
 end;

if fc = 7 then
 with tquery.create (nil) do
  try
   databasename:= 'whatever';
   close;
   sql.add ('alter table "test.db" add newfield varchar (30)');
   execsql
  end;
   finally
  free
 end; 
```

请注意，我的“alter table”语句的语法与您的不同 - 表名用引号括起来并包含文件的扩展名。

# php - Symfony2：如何从其他包的控制器动态注册包（并清除缓存）

> ID：10572966
> 
> 赞同：2
> 
> 时间：2012-05-13T15:34:13.587
> 
> 标签：php, caching, module, symfony, bundle

我正在创建某种“准备好扩展”的管理面板。我正在尝试做的是一个模块，用于通过下载适当的包并从管理面板中安装它来扩展一些管理面板功能。

我已经准备了一个额外的画廊模块，我不想使用标准版本的管理面板启用它（或者甚至将此捆绑包部署到产品服务器）。额外的图库捆绑包只能从管理面板/模块站点安装。用户可以上传图库模块（一个包，从服务器下载）并让应用程序处理其余部分：将包解压缩到 src/proper_path，在 AppKernel.php 中注册并清除缓存（如果有必要） . 最后也是唯一的问题是：**在 Symfony2 中是否可行以及如何实现？**

[是否可以在 Symfony2 中动态注册捆绑包？](https://stackoverflow.com/questions/6609240/is-it-possible-to-dynamically-register-bundles-in-symfony2)说是，但这是正确的还是唯一的方法？那么缓存清除呢，我可以从控制器中运行它吗？作曲家是否与整个问题有关，或者可以提供帮助？使用这种方法扩展站点的功能在许多公共免费 CMS 中非常受欢迎。你有什么经验或智慧之言吗？

# ruby-on-rails-3 - Rails simple_form 预先填充的输入值在服务器端表单验证期间丢失

> ID：10572969
> 
> 赞同：1
> 
> 时间：2012-05-13T15:34:33.057
> 
> 标签：ruby-on-rails-3, simple-form

我的 rails 应用程序中有一个 simple_form，我想用 URL 参数预填充一些字段。

示例网址是：

```
http://localhost:3000/surveys/new?phone=8675309 
```

这使用以下代码正确地预填充电话字段：

```
<%= simple_form_for @survey, :html => { :class => 'form-horizontal' } do |f| %>
<%= f.input :state, :required => true %>
<%= f.input :zip, :required => true %>
<%= f.input :phone, :required => true, :input_html => { :value => params['phone'] } %>
<% end %> 
```

问题是如果提交的表单没有必填字段，则会重新加载表单，但不会保留电话输入值。

如果表单在没有 zip 值的情况下提交，则在红色 URL 中出现验证错误的重新加载页面现在是：

```
http://localhost:3000/surveys 
```

例如，如果状态字段正确但没有邮政编码，则重新加载表单并显示错误消息，说明需要 zip。

状态值被保留，但手机没有。

我想这与手机的 f.input 中的 :value => params['phone'] 有关。

无论如何，我是否可以在 simple_form 的初始加载中填充 URL 参数，并在服务器端验证失败时保留这些值？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T09:44:34.917

谢谢马克，

不久前我再次重新发布了这个问题，并在这里得到了正确的回答：

[Rails simple_form 服务器端验证丢失 URL 参数](https://stackoverflow.com/questions/11036381/rails-simple-form-server-side-validations-lost-url-params)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T02:32:36.203

`:value`从您的视图中删除：

```
<%= f.input :phone, :required => true %> 
```

并使用此网址：

```
http://localhost:3000/surveys/new?survey[phone]=8675309 
```

这应该生成`survey`控制器期望的“标准”参数散列。在我的测试中，这与用户输入值的效果相同，并使用通常的验证处理。

在控制器内部，使用表示为、等`params[survey]`的各个参数调用散列。`params[survey][phone]``params[survey][zip]`

[在这个答案](https://stackoverflow.com/a/7219342/550712)的帮助下，我发现您可以生成带有 link_to 签名的 URL `link_to(body, url_options = {}, html_options = {})`：

```
<%= link_to 'New survey', { :controller => "surveys", 
                            :action => "new", 
                            :survey => { :phone => "8675309", :zip => "10001" } },
                          { :target => "_blank" } %> 
```

请注意，这`url_options`是第一个散列，在该散列中，您有一个`survey`用于预加载值的散列。最后是可选的哈希`html_options`（我`target="_blank"`为了说明而添加的）。

# javascript - Javascript中的查询字符串加密和通用处理程序中的解密

> ID：10572976
> 
> 赞同：-1
> 
> 时间：2012-05-13T15:35:12.170
> 
> 标签：javascript, encryption, query-string, generic-handler

我有一种情况，我需要在 JS 中加密查询字符串，使其变得不可读并在通用处理程序中解密。你能给我一些链接吗？

你能建议一些其他的方法吗？

我已经看到该方法应用于很多网站

> www.somesite.com/SomeHandler.ashx?QueryStringData=ghsgysghetwRFDTVW5632

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T16:47:38.717

如果您需要通过可能不安全的网络（例如公共 WiFi 接入点）传输敏感数据，请**使用 HTTPS**。它负责加密数据，更重要的是，还确保通信的其他部分（例如从服务器发送的 JavaScript 代码）不被篡改。

如果你不使用 HTTPS，在 JavaScript 中进行任何类型的加密总是不安全的，因为中间人攻击者可以修改发送到浏览器的脚本。如果您确实使用 HTTPS，通常不需要在 JavaScript 中进行加密，因为传输层已经加密了发送到服务器和从服务器发送的所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T17:38:10.003

您的方法通常是不安全的。您永远不应该通过 Web 界面公开通用 SQL 界面。

如果您只想执行某些 SQL 命令，请在服务器端实现它们，并且只从 URL 中提取所需的参数。其他一切都将导致数据库的直接 SQL 注入接口。

# c# - .NET 互操作中是否存在内存安全级别？

> ID：10572981
> 
> 赞同：1
> 
> 时间：2012-05-13T15:35:39.980
> 
> 标签：c#, interop, nunit, unmanaged

我有一个很奇怪的问题：

我正在使用 NUnit 测试对非托管 C dll 的几个函数调用。奇怪的是，测试在正常运行时失败，但是当我用调试器运行它时（即使没有断点）它通过了。

那么，调试器是否像普通的 NUnit 应用程序一样拥有更广泛的内存访问权限？

我已经隔离了失败的呼叫。它传回一个指向字符串的 char 指针，编组器应将其转换为 C# 字符串。C端看起来像这样：

```
#define get_symbol(a) ((a).a_w.w_symbol->s_name)
EXTERN char *atom_get_symbol(t_atom *a);

...

char *atom_get_symbol(t_atom *a) {
  return get_symbol(*a);
} 
```

和 C# 代码：

```
[DllImport("csharp.dll", EntryPoint="atom_get_symbol")]
[return:MarshalAs(UnmanagedType.LPStr)]
private static extern string atom_get_symbol(IntPtr a); 
```

从 c 返回的指针在代码和列表的一部分中非常深入。所以我只是想念一些安全设置吗？

编辑：这是我得到的例外：

System.AccessViolationException ：（翻译成英文：）试图读取或写入受保护的内存。这可能表明其他内存已损坏。

```
at Microsoft.Win32.Win32Native.CoTaskMemFree(IntPtr ptr)
at ....atom_get_symbol(IntPtr a) 
```

解决方案：

问题是，编组器想要释放作为 C 结构一部分的内存。但它应该只是复制字符串并保持原样：

```
[DllImport("csharp.dll", EntryPoint="atom_get_symbol")]
private static extern IntPtr atom_get_symbol(IntPtr a); 
```

然后在代码中获取字符串的副本：

```
var string = Marshal.PtrToStringAnsi(atom_get_symbol(ptrToStruct)); 
```

伟大的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T16:04:38.313

这总是会导致 Vista 及更高版本崩溃，您如何避免它并不是很清楚。堆栈跟踪告诉我们，pinvoke marshaller 正在尝试释放为字符串分配的字符串缓冲区。它总是使用 CoTaskMemFree() 来执行此操作，这是对可能用于为字符串分配内存的分配器的唯一合理猜测。但这很少奏效，C 或 C++ 代码几乎总是使用 CRT 的私有堆。这不会在 XP 上崩溃，它有一个更宽容的内存管理器。这会产生无法诊断的内存泄漏。

值得注意的是，C 声明并没有给出太多的承诺，即您可以调用该函数，它不返回 a `const char*`。您唯一的希望是将返回类型声明为 IntPtr 而不是字符串，这样 pinvoke 编组器就不会尝试释放指向的内存。您需要使用 Marshal.PtrToStringAnsi() 将返回的 IntPtr 转换为字符串。

您需要对其进行测试，调用该函数十亿次以确保您不会泄漏内存。如果该测试因 OutOfMemoryException 而崩溃，那么您遇到了一个大问题。唯一的选择是用 C++/CLI 语言编写一个包装器，并确保它使用与本机代码完全相同的 CRT 版本，以便它们都使用相同的堆。如果您没有源代码，这将是棘手且不可能的。这个函数很难从任何语言调用，包括 C。它应该被声明为`int atom_get_symbol(t_atom* a, char* buf, size_t buflen)`可以使用客户端代码分配的缓冲区来调用它。

# sql - 为数据库中的单个字段存储多个值

> ID：10572987
> 
> 赞同：7
> 
> 时间：2012-05-13T15:36:23.980
> 
> 标签：sql, database, oracle, database-design

假设我有一个包含 3 个字段的表

Person_id、姓名和地址。现在的问题是一个人可以有多个地址。原子值原则说数据应该是原子的。

那么我想如何为一个人存储多个地址呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-13T15:38:57.670

您应该创建一个`ADDRESS`具有将其链接到`PERSON`记录的外键的表，即`PERSON_ID`. 这是关系数据库的“关系”组件，这就是它比平面文件（就像单个表）更灵活的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:39:14.427

将地址放在第二个表中，给每个地址一个“Person ID”，以便地址表中的多行可以引用一个人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-06T18:55:58.973

我建议在地址表中添加一个地址类型，以确定它是哪种类型的地址（家庭、假期、办公室）等。例如：AddType 指的是一个列表表，可以在其中添加更多类型。

# c++ - 试图将文本文件数据读入要操作的数组然后吐出

> ID：10572993
> 
> 赞同：1
> 
> 时间：2012-05-13T15:37:26.583
> 
> 标签：c++, visual-c++

我的目标是从文件中获取数据，将其拆分并将它们放入一个数组中以供将来修改。

这是数据的样子：

```
course1-Maths|course1-3215|number-3|professor-Mark

sam|scott|12|H|3.4|1/11/1991|3/15/2012

john|rummer|12|A|3|1/11/1982|7/15/2004

sammy|brown|12|C|2.4|1/11/1991|4/12/2006

end_Roster1| 
```

我想把数学、3215、3 和 Mark 放入一个数组中，然后 sam scott 12 H 3.4 1/11/1991 3/15/2012。

这是我到目前为止所拥有的：

```
infile.open("file.txt", fstream::in | fstream::out | fstream::app);
while(!infile.eof())
{
    while ( getline(infile, line, '-') )
    {
        if ( getline(infile, line, '|') )
        {
            r = new data;
            r->setRcourse_name(line);
            r->setRcourse_code(3);//error not a string
            r->setRcredit(3);//error not a string pre filled
            r->setRinstructor(line);

            cout << line << endl;
        }
    }
} 
```

然后我试图查看它没有存储任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T17:46:06.067

首先，第 1 行与其余行非常不同，因此您需要为它们使用不同的解析算法。就像是：

```
bool first = true;
while(!infile.eof()) 
    {
        if (first) 
            {
            // read header line
            first = false;
            }
        else 
            {
            // read lines 2..n
            }   
    } 
```

可以通过为每行创建一个字符串流来处理读取第 2..n 行，然后使用 '|' 将其传递给另一个 getline 作为分隔符，获取每个令牌 (sam, scott, 12, H, 3.4, 1/11/1991, 3/15/2012)

```
if (getline(infile, line, '\n')) 
    {
    stringstream ssline(line);
    string token;
    while (getline(ssline, token, '|'))
        vector.push_back(token);
    } 
```

阅读标题行将完全相同的概念更进一步，其中每个标记然后用另一个以“-”作为分隔符的 getline 进一步解析。您每次都会忽略第一个标记（course1、course1、number、professor）并使用第二个标记（Maths、3215、3、Mark）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T15:43:18.137

您完全忽略了在嵌套 while 循环的条件内获得的行。您应该从 while 循环中的一个位置调用 getline，然后使用一系列 if-then-else 条件检查其内容。

# c# - 为什么双向数据绑定在 WPF 中不起作用？

> ID：10572994
> 
> 赞同：1
> 
> 时间：2012-05-13T15:37:28.503
> 
> 标签：c#, wpf, xaml, data-binding

我正在做一个小型大学项目，我需要读取一个带有一些表和函数的 Lua 文件并从中制作一个形状。就这样完成了。

问题是当我尝试使其具有交互性时。这是我的 XAML：

```
<Window x:Class="Gemi.WPF.VentanaPrincipal"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Gemi.WPF"
        Title="GEMI - Geometría Interactiva!" Height="350" Width="525">
    <Window.Resources>
        <local:DoblesAPunto x:Key="DoblesAPunto"/>
    </Window.Resources>
    <DockPanel LastChildFill="True" Background="White">
        <Grid DockPanel.Dock="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Content="Figura Seleccionada: "/>
            <ComboBox Name="cbFiguras" HorizontalAlignment="Stretch" Grid.Column="1" 
                      ItemsSource="{Binding Path=Figuras}" DisplayMemberPath="Nombre" SelectionChanged="cbFiguras_FiguraSeleccionada" />
        </Grid>
        <ScrollViewer DockPanel.Dock="Bottom" Name="scrollPropiedades" 
                      Height="Auto" VerticalScrollBarVisibility="Auto">
            <DockPanel Name="dpPropiedades">
                <StackPanel Orientation="Vertical" Name="spNombres" DockPanel.Dock="Left"/>
                <StackPanel Orientation="Vertical" Name="spValores" DockPanel.Dock="Right" Margin="10, 0, 0, 0"/>
            </DockPanel>
        </ScrollViewer>
        <DockPanel LastChildFill="True">
            <Slider Name="controlZoom" DockPanel.Dock="Bottom" Value="1" 
                    Maximum="50" Minimum="0.1" Orientation="Horizontal" ToolTip="Controla el zoom de la figura"/>
            <ItemsControl x:Name="cnvFigura" ItemsSource="{Binding Puntos}">
                <ItemsControl.LayoutTransform>
                    <ScaleTransform 
                    CenterX="0" CenterY="0"
                    ScaleX="{Binding ElementName=controlZoom,Path=Value}"
                    ScaleY="{Binding ElementName=controlZoom,Path=Value}"/>
                </ItemsControl.LayoutTransform>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Path Fill="Black" local:DragCanvas.CanBeDragged="True" 
                              local:DragCanvas.Top="{Binding Y, Mode=TwoWay}" 
                              local:DragCanvas.Left="{Binding X, Mode=TwoWay}">
                            <Path.Data>
                                <EllipseGeometry RadiusX="5" RadiusY="5">
                                    <EllipseGeometry.Center>
                                        <MultiBinding Converter="{StaticResource DoblesAPunto}">
                                            <Binding Path="X" />
                                            <Binding Path="Y" />
                                        </MultiBinding>
                                    </EllipseGeometry.Center>
                                </EllipseGeometry>
                            </Path.Data>
                            <Path.ToolTip>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="X = " Grid.Column="0" Grid.Row="0"/>
                                    <TextBlock Text="{Binding X}" Grid.Column="1" Grid.Row="0"/>
                                    <TextBlock Text="Y = " Grid.Column="0" Grid.Row="1"/>
                                    <TextBlock Text="{Binding Y}" Grid.Column="1" Grid.Row="1"/>
                                </Grid>
                            </Path.ToolTip>
                        </Path>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <local:DragCanvas IsItemsHost="True"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
            </ItemsControl>
        </DockPanel>
    </DockPanel>
</Window> 
```

有问题的问题是绑定没有更新。即使我拖动构成 DataTemplate 的省略号，也永远不会调用“Punto”对象的设置器。有任何想法吗？

另外，为什么我似乎需要绑定椭圆的中心？如果我只绑定 DragCanvas 的 Top/Bottom/Left/Right 所有点都绘制在 0,0 处，这会引发一个问题，因为我不能将这些点拖到更左也不能拖到它们最初所在的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T06:29:13.327

这可能是因为拖放没有修改 Canvas.Left 和 Canvas.Top 而是使用了转换（Translation）。

绑定到这个转换可能会很棘手，因为我希望拖放系统将此转换添加到转换组。因此它不会更新您添加到转换中的翻译。

# vim - 将命令范围传递给函数

> ID：10572996
> 
> 赞同：18
> 
> 时间：2012-05-13T15:37:53.663
> 
> 标签：vim

我正在尝试定义一个可以采用范围并将其传递给函数的命令。这是我认为我应该拥有的：

```
function! PrintGivenRange() range
    echo "firstline ".a:firstline." lastline ".a:lastline
    " Do some more things
endfunction

command! -range PassRange call PrintGivenRange() 
```

但是，它不起作用，它似乎只通过了第一行。

例如

```
:1,5PassRange "outputs firstline 1 lastline 1
:1,5call PrintGivenRange() "outputs firstline 1 lastline 5
" if you select lines in visual mode, same thing for both 
```

我已经阅读`:help command-range`了，但仍然无法弄清楚这一点。我应该将前缀中的范围传递给`call`? 我该如何解决？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-13T15:46:54.063

您需要明确传递范围，请尝试：

```
command! -range PassRange <line1>,<line2>call PrintGivenRange() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-07-09T11:13:46.607

如果要在可视模式下使用当前选定行的范围，可以使用以下命令：

```
command! -range PassRange '<,'> call PrintGivenRange() 
```

*   `'<`：当前缓冲区中当前选定可视区域的第一行。
*   `'>`：当前缓冲区中当前选定可视区域的最后一行。

# ruby-on-rails-3 - 当我运行查询时，Rails 将我注销

> ID：10572998
> 
> 赞同：1
> 
> 时间：2012-05-13T15:38:35.520
> 
> 标签：ruby-on-rails-3, session

我有一个使用 railstutorial 作为模板构建的网站。我添加了一个搜索控制器以允许我执行站点搜索并将用户重定向到搜索视图。当我转到路径“/搜索”时，它符合预期（没有结果），但如果我实际使用搜索输入框，我将被注销并必须重新登录。这是什么原因造成的？

我的表格：

```
<form action="/search" method="POST" class="navbar-search pull-right">
    <input name="query" type="text" class="search-query" placeholder="Search">
</form> 
```

我的搜索控制器：

```
class SearchController < ApplicationController
    def index
        unless params[:query].nil?
            @results = ThinkingSphinx.search params[:query]
        else
            @results = []
        end
    end
end 
```

我的观点：

```
<% unless @results.empty? %>
    <table class="table">
        <% @results.each do |result| %>
            <tr>
                <% if result.class.name == "Event" %>
                    <td><%= link_to result.name, organisation_event_path(result.organisation, result.slug) %></td>
                    <td><%= result.summary %></td>
                <% end %>
            </tr>
        <% end %>
    </table>
<% else %>
    <p>No results found.</p>
<% end %> 
```

我的路线：

```
match '/search', to: 'search#index' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T14:57:10.293

它与 CSRF 问题有关。您可以在[此处阅读详细信息](http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails/)，或此[SO question/answer](https://stackoverflow.com/questions/5082769/why-does-the-post-method-seem-to-be-clearing-my-rails-session-data)。