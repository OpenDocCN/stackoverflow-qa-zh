# StackOverflow 问答 000568000-000568999

# .net - DataGridViewComboBoxCell 非活动项绘制

> ID：568001
> 
> 赞同：0
> 
> 时间：2009-02-20T01:54:12.713
> 
> 标签：.net, datagridview, combobox

我们正在尝试更改 DataGridViewComboBoxCell，以便当用户展开下拉菜单时，非活动项目以灰色文本显示。

我发现了如何通过创建一个继承自 DataGridViewComboBoxEditingControl 的新对象来做到这一点。

问题在于，当用户单击单元格时，我不确定如何告诉组合框单元格或列使用此 EditingControl。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T02:01:44.020

您必须实现一个所有者绘制的组合框。看看这个链接：

[http://www.codeproject.com/KB/combobox/ownerdrawncombobox.aspx](http://www.codeproject.com/KB/combobox/ownerdrawncombobox.aspx)

# sharepoint - 文档库的事件接收器

> ID：568011
> 
> 赞同：7
> 
> 时间：2009-02-20T01:56:39.057
> 
> 标签：sharepoint, events, list

我正在尝试从事件接收器更新 word 文档的属性之一。

我正在使用***ItemAdded***事件处理它并按原样更新属性：

```
// Modify property
DisableEventFiring();
properties.ListItem.File.CheckOut();
properties.AfterProperties[HelloWorldInternalFieldName] = "Hello World!";
properties.ListItem.UpdateOverwriteVersion();
properties.ListItem.File.CheckIn("Updating Property!");
properties.ListItem.SystemUpdate();
EnableEventFiring(); 
```

当我尝试修改它时出现异常，它说：

> 该事件不支持更改属性。

有谁知道为什么以及为什么在将文档保存到 Word 中的文档库后无法更新属性？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-20T15:33:34.447

我知道问题是什么：

AfterProperties 在 -"ed" 事件中是只读的。您可以只修改列表项：

```
properties.ListItem["HelloWorldInternalFieldName"] = "Hello World!"; 
```

# wpf - WPF 窗口拖动/移动边界

> ID：568012
> 
> 赞同：1
> 
> 时间：2009-02-20T01:56:44.440
> 
> 标签：wpf, winforms

只是好奇您是否知道为窗口设置拖动边界的任何方法？

拥有这些属性会很好：

```
Me.MinLeft = 10
Me.MinTop = 10
Me.MaxLeft = 150
Me.MaxTop = 150 
```

**这些是由属性组成的，顺便说一句**，如果有的话会很好。

我知道我可能会设置一个计时器，每 10 秒触发一次，然后检查左侧和顶部，然后在结束时将其移回。但是让窗口表现得像撞到墙上一样不能走得更远，比如移动到屏幕边缘或类似的东西会更优雅。

编辑：某处似乎有些混乱，我要说明的重点是在上面的段落中，拖动，而不是重新调整大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T10:57:59.647

这是创建此功能所需的“魔法”，您所要做的就是将 Window_SourceInitialized 方法设置为窗口的 SourceInitialized 事件，并将逻辑插入到大注释所在的位置。

我结合了来自多个来源的代码，因此其中可能存在一些语法错误。

```
internal enum WM
{
   WINDOWPOSCHANGING = 0x0046,
}

[StructLayout(LayoutKind.Sequential)]
internal struct WINDOWPOS
{
   public IntPtr hwnd;
   public IntPtr hwndInsertAfter;
   public int x;
   public int y;
   public int cx;
   public int cy;
   public int flags;
}

private void Window_SourceInitialized(object sender, EventArgs ea)
{
   HwndSource hwndSource = (HwndSource)HwndSource.FromVisual((Window)sender);
   hwndSource.AddHook(DragHook);
}

private static IntPtr DragHook(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handeled)
{
   switch ((WM)msg)
   {
      case WM.WINDOWPOSCHANGING:
      {
          WINDOWPOS pos = (WINDOWPOS)Marshal.PtrToStructure(lParam, typeof(WINDOWPOS));
          if ((pos.flags & (int)SWP.NOMOVE) != 0)
          {
              return IntPtr.Zero;
          }

          Window wnd = (Window)HwndSource.FromHwnd(hwnd).RootVisual;
          if (wnd == null)
          {
             return IntPtr.Zero;
          }

          bool changedPos = false;

          // ***********************
          // Here you check the values inside the pos structure
          // if you want to override tehm just change the pos
          // structure and set changedPos to true
          // ***********************

          if (!changedPos)
          {
             return IntPtr.Zero;
          }

          Marshal.StructureToPtr(pos, lParam, true);
          handeled = true;
       }
       break;
   }

   return IntPtr.Zero;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-21T16:29:38.803

因为我毫不怀疑 Nir ​​的答案会花一点时间来实现它，所以我可以用这段代码做我想做的更优雅的事情：

```
Private Sub myWindow_LocationChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.LocationChanged

    Dim primaryBounds As System.Drawing.Rectangle = Windows.Forms.Screen.PrimaryScreen.Bounds
    Dim windowBounds As System.Drawing.Rectangle = New System.Drawing.Rectangle(CInt(Me.Left), CInt(Me.Top), CInt(Me.Width), CInt(Me.Height))

    If (windowBounds.Left < 0) Then
        windowBounds = New System.Drawing.Rectangle(0, windowBounds.Top, windowBounds.Width, windowBounds.Height)
    ElseIf (windowBounds.Right > primaryBounds.Right) Then
        windowBounds = New System.Drawing.Rectangle(primaryBounds.Right - windowBounds.Width, windowBounds.Top, windowBounds.Width, windowBounds.Height)
    End If

    If (windowBounds.Top < 0) Then
        windowBounds = New System.Drawing.Rectangle(windowBounds.Left, 0, windowBounds.Width, windowBounds.Height)
    ElseIf (windowBounds.Bottom > primaryBounds.Bottom) Then
        windowBounds = New System.Drawing.Rectangle(windowBounds.Left, primaryBounds.Bottom - windowBounds.Height, windowBounds.Width, windowBounds.Height)
    End If

    Me.Left = windowBounds.Left
    Me.Top = windowBounds.Top

End Sub 
```

这使得被拖动的窗口保持在主屏幕（整个窗口）内，但您可以轻松地将边界更改为您需要的任何值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T04:37:03.167

为此目的，WPF 的 Window 有依赖属性。

他们来了：

*   Window.MaxWidth
*   Window.MaxHeight

这些属性将约束 Window 的大小，就像 WinForm 的 Form 一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T14:52:31.410

也许您可以处理[`PreviewMouseMove`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.previewmousemove.aspx)（事件或覆盖相应的受保护方法）并`e.Handled = true`在鼠标移动会导致窗口移动到您想要将其约束到的区域之外时进行设置。

这似乎是最合乎逻辑的、类似 WPF 的方式。

# bandwidth - 可编程网络诊断工具？

> ID：568025
> 
> 赞同：0
> 
> 时间：2009-02-20T02:04:40.973
> 
> 标签：bandwidth, measurement

是否有任何可用的网络诊断工具可用于测量带宽等内容。

因此有很多工具可以做到这一点，但我需要一个可以嵌入到我的应用程序和程序中的工具。环境是 WinCE，但也请列出任何通用工具，最好是开源的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T03:56:26.210

Winpcap 是一个用于 windows 的网络数据包捕获库，我相信它是 *nix 库的一个端口。网络流量分析器 Wireshark（又名 Ethereal）正在（或曾经）使用它

虽然我不确定该库是否可以在 WinCE 上运行，或者它是否直接提供您正在寻找的内容，但它可以作为任何需要完成的数据包分析的框架，以促进带宽使用测量

# python - 灵活、可靠和便携的服务发现

> ID：568028
> 
> 赞同：5
> 
> 时间：2009-02-20T02:08:38.700
> 
> 标签：python, language-agnostic, service-discovery

我正在寻找一种方法，让 LAN 中的客户端无需任何配置即可找到我的服务器应用程序的所有实例。我不想自己破解某些东西，而是想使用现有的解决方案。就个人而言，我需要用 Python 来完成它，但我很高兴听到任何其他语言的解决方案。

那么为什么我不使用[avahi](http://avahi.org/)或[OpenSLP](http://www.openslp.org/)或其他[Zeroconf](http://en.wikipedia.org/wiki/Zeroconf#Service_discovery) / [SLP](https://www.rfc-editor.org/rfc/rfc2608)解决方案呢？好吧，还有一些额外的标准，我的印象是上述系统都不符合它们。

我正在寻找一个解决方案：

*   **灵活**。它必须不需要超级用户权限，即只使用端口>1024。
*   **固体**。它必须允许在一台机器上提供相同和不同服务类型的多个服务，并且即使在启动广告服务器的实例停止或崩溃时也能继续广告服务。
*   **便携**。它几乎必须在任何地方运行，或者至少在 *BSD、Debian/gentoo/RedHat/SuSe Linux、Mac OS X、Solaris 和 Windows NT 上运行。
*   **光**。理想情况下，一个 Python 脚本将是整个解决方案。我对地址自动配置或类似的东西一点也不感兴趣，尽管我不情愿地接受一个有很多我不需要的功能的解决方案。此外，任何一次性设置都是严格禁止的。

我期待这样的事情：

```
def registerService(service): # (type, port)
    if listen(multicast, someport):
        if fork() == child:
            services = [service]
            for q in queriesToMe():
                if q == DISCOVERY:
                    answer(filter(q.criteria, services))
                elif q == ADVERTISE and q.sender == "localhost":
                    services.append(q.service)
    else:
        advertiseAt("localhost", service) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-17T18:09:38.947

我编写了一个匹配所有这些标准的应用程序/库（目前是 Python 和 CLI 接口）。它被称为[减号](http://code.google.com/p/minusconf/)。事实证明，甚至不需要分叉。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-13T16:02:32.343

对于 LAN 中的节点发现，我使用了 Twisted 和 UDP 多播。希望对你也有帮助。

链接到解释如何操作的扭曲文档： [https ://twistedmatrix.com/documents/current/core/howto/udp.html#auto3](https://twistedmatrix.com/documents/current/core/howto/udp.html#auto3)

这是基于扭曲代码的服务器/客户端的基本实现。如果您运行一次，它会自行回答，但所有检查代码和额外功能都已删除，以使其更易于阅读。

```
from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor

class MulticastPingPong(DatagramProtocol):
    MULTICAST_ADDR = ('228.0.0.5', 8005)
    CMD_PING = "PING"
    CMD_PONG = "PONG"

    def startProtocol(self):
        """
        Called after protocol has started listening.
        """
        # Set the TTL>1 so multicast will cross router hops:
        self.transport.setTTL(5)
        # Join a specific multicast group:
        self.transport.joinGroup(self.MULTICAST_ADDR[0])

        self.send_alive()

    def send_alive(self):
        """
        Sends a multicast signal asking for clients.
        The receivers will reply if they want to be found.
        """
        self.transport.write(self.CMD_PING, self.MULTICAST_ADDR)

    def datagramReceived(self, datagram, address):
        print "Datagram %s received from %s" % (repr(datagram), repr(address))

        if datagram.startswith(self.CMD_PING):
            # someone publishes itself, we reply that we are here
            self.transport.write(self.CMD_PONG, address)
        elif datagram.startswith(self.CMD_PONG):
            # someone reply to our publish message
            print "Got client: ", address[0], address[1]

if __name__ == '__main__':
    reactor.listenMulticast(8005, MulticastPingPong(), listenMultiple=True)
    reactor.run() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T06:43:55.700

我假设您可以控制客户端应用程序，而不仅仅是服务器应用程序，在这种情况下，[Pyro](http://pyro.sourceforge.net/)可能适合您。

**灵活：**使用非特权端口。

**坚固：**多年来一直保持良好状态。

**便携：**纯 Python 并在多个平台上经过良好测试。

**Light：**我认为 Pyro 对于你所得到的东西来说很轻。也许要求一个 Python 脚本对于网络命名服务来说是不现实的？

即使您不想实际使用 Pyro 的“远程对象”范例，您仍然可以只使用它的命名服务。

# c# - NHibernate - 非空属性引用空值或瞬态值

> ID：568029
> 
> 赞同：24
> 
> 时间：2009-02-20T02:09:10.743
> 
> 标签：c#, nhibernate, exception, fluent-nhibernate, nhibernate-mapping

我得到了这个例外（底部的完全例外）：

```
NHibernate.PropertyValueException was unhandled by user code
 Message="not-null property references a null or transient
valueClearwave.Models.Encounters.Insurance.Patient"
 Source="NHibernate"
 EntityName="Clearwave.Models.Encounters.Insurance"
 PropertyName="Patient" 
```

我做了很多谷歌搜索，似乎最常见的错误原因是关联是双向的，但只设置了一半。如： Insurance.Patient = Patient 被调用但 Patient.Insurances.Add(Insurance) 不是。事实上，我确实有这样的场景，但我在使用它调用 Save 之前检查了该对象，Insurance.Patient 和 Patient.Insurances[0] 都是正确的对象。

此异常似乎引用的另一种可能性是瞬态值。在我的情况下*，每个*对象都是瞬态的，所以我怀疑我的问题的根源就在这里。但是，现在一切都需要是暂时的，因为尚未保存任何内容。我希望 NHibernate 坚持一些事情，而不是抱怨他们没有坚持下去。

以下是我的映射中的一些片段（流利）：

```
 public PatientMap()
       {
           WithTable("tPatient");

           Id(x => x.Id, "uid_Patient").GeneratedBy.GuidComb
().Access.AsReadOnlyPropertyThroughCamelCaseField();

           HasMany(x => x.Insurances).WithKeyColumn("uid_Patient")
               .Cascade.All()
               .Inverse();

          ...
       }

      public InsuranceMap()
       {
           WithTable("tPatientInsuranceInfo");

           Id(x => x.Id,
"uid_PatientInsuranceInfo").GeneratedBy.GuidComb
().Access.AsReadOnlyPropertyThroughCamelCaseField();

           References(x => x.Patient, "uid_Patient").Not.Nullable
().Cascade.All();

           ...
        } 
```

那么，可能是什么问题？

* * *

```
NHibernate.PropertyValueException was unhandled by user code
 Message="not-null property references a null or transient
valueClearwave.Models.Encounters.Insurance.Patient"
 Source="NHibernate"
 EntityName="Clearwave.Models.Encounters.Insurance"
 PropertyName="Patient"
 StackTrace:
      at NHibernate.Engine.Nullability.CheckNullability(Object[]
values, IEntityPersister persister, Boolean isUpdate)
      at
NHibernate.Event.Default.AbstractSaveEventListener.PerformSaveOrReplicate
(Object entity, EntityKey key, IEntityPersister persister, Boolean
useIdentityColumn, Object anything, IEventSource source, Boolean
requiresImmediateIdAccess)
      at
NHibernate.Event.Default.AbstractSaveEventListener.PerformSave(Object
entity, Object id, IEntityPersister persister, Boolean
useIdentityColumn, Object anything, IEventSource source, Boolean
requiresImmediateIdAccess)
      at
NHibernate.Event.Default.AbstractSaveEventListener.SaveWithGeneratedId
(Object entity, String entityName, Object anything, IEventSource
source, Boolean requiresImmediateIdAccess)
      at
NHibernate.Event.Default.DefaultMergeEventListener.EntityIsTransient
(MergeEvent event, IDictionary copyCache)
      at NHibernate.Event.Default.DefaultMergeEventListener.OnMerge
(MergeEvent event, IDictionary copyCache)
      at NHibernate.Impl.SessionImpl.FireSaveOrUpdateCopy(IDictionary
copiedAlready, MergeEvent event)
      at NHibernate.Impl.SessionImpl.SaveOrUpdateCopy(String
entityName, Object obj, IDictionary copiedAlready)
      at
NHibernate.Engine.CascadingAction.SaveUpdateCopyCascadingAction.Cascade
(IEventSource session, Object child, String entityName, Object
anything, Boolean isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeToOne(Object child, IType
type, CascadeStyle style, Object anything, Boolean
isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeAssociation(Object child,
IType type, CascadeStyle style, Object anything, Boolean
isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeProperty(Object child,
IType type, CascadeStyle style, Object anything, Boolean
isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeOn(IEntityPersister
persister, Object parent, Object anything)
      at
NHibernate.Event.Default.AbstractSaveEventListener.CascadeBeforeSave
(IEventSource source, IEntityPersister persister, Object entity,
Object anything)
      at
NHibernate.Event.Default.DefaultMergeEventListener.EntityIsTransient
(MergeEvent event, IDictionary copyCache)
      at NHibernate.Event.Default.DefaultMergeEventListener.OnMerge
(MergeEvent event, IDictionary copyCache)
      at NHibernate.Impl.SessionImpl.FireSaveOrUpdateCopy(IDictionary
copiedAlready, MergeEvent event)
      at NHibernate.Impl.SessionImpl.SaveOrUpdateCopy(String
entityName, Object obj, IDictionary copiedAlready)
      at
NHibernate.Engine.CascadingAction.SaveUpdateCopyCascadingAction.Cascade
(IEventSource session, Object child, String entityName, Object
anything, Boolean isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeToOne(Object child, IType
type, CascadeStyle style, Object anything, Boolean
isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeAssociation(Object child,
IType type, CascadeStyle style, Object anything, Boolean
isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeProperty(Object child,
IType type, CascadeStyle style, Object anything, Boolean
isCascadeDeleteEnabled)
      at NHibernate.Engine.Cascade.CascadeOn(IEntityPersister
persister, Object parent, Object anything)
      at
NHibernate.Event.Default.AbstractSaveEventListener.CascadeBeforeSave
(IEventSource source, IEntityPersister persister, Object entity,
Object anything)
      at
NHibernate.Event.Default.DefaultMergeEventListener.EntityIsTransient
(MergeEvent event, IDictionary copyCache)
      at NHibernate.Event.Default.DefaultMergeEventListener.OnMerge
(MergeEvent event, IDictionary copyCache)
      at NHibernate.Event.Default.DefaultMergeEventListener.OnMerge
(MergeEvent event)
      at NHibernate.Impl.SessionImpl.FireSaveOrUpdateCopy(MergeEvent
event)
      at NHibernate.Impl.SessionImpl.SaveOrUpdateCopy(Object obj)
      at Clearwave.Models.Data.Util.RepositoryBase`2.Save(EntityType&
entity) in C:\Projects\ClearWave\Src\Common\Domain Models
\Clearwave.Models.Data-NHibernate\Util\RepositoryBase.cs:line 25
      at IntegrationWebServices.FromMirth.SubmitMessage(Message
theMessage, Guid providerOrganizationId)
      at SyncInvokeSubmitMessage(Object , Object[] , Object[] )
      at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke
(Object instance, Object[] inputs, Object[]& outputs)
      at
System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin
(MessageRpc& rpc)
 InnerException: 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-21T14:33:56.860

另一种可能性是您正在保存整个对象图，并且该图是圆形的，并且项目不能为空。您可能没有给 NHibernate 提供执行插入的法律命令。（它应该产生更好的错误消息，但它会产生这个）。

如果没有看到源的其余部分，很难获得更多帮助。尝试从映射中删除实体（而不是保存它们），直到找出导致问题的原因。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-07-31T17:40:10.393

不确定它是否有帮助，但这对我有用。

```
<many-to-one name="Company" column="CompanyId" cascade="all" not-null="true"/> 
```

cascade="all" 是我之前错过的

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-10-06T21:20:39.450

我最近遇到了这个问题，它与 NHibernate 双向关系的持久化方式有关。您的映射正确，因此 NHibernate 将执行 Patient insert 没有问题。然后 NHibernate 需要从患者那里获取密钥并将其级联到保险中。由于 Patient 尚不存在，因此密钥不存在，因此无法执行第二次插入。关键是在持久化之前通过代码设置关系，如下所示：

```
patient = new Patient();
patient.Insurances.Add( new Insurance{ Patient = patient } );
repository.Save( patient); 
```

现在，您必须在集合项上设置 Patient 属性对我来说很陌生，但是如果您一起忽略持久性，您将在代码中设置它，而与您的持久性策略无关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-13T17:55:11.613

这对我有用。这里重要的事情是我们有`References`，我们`Cascade.All()`没有`Inverse()``HasMany`

```
public PatientMap()
{
    HasMany(x => x.Insurances)
        .WithKeyColumn("uid_Patient")
        .Cascade.All();

    ...
}

public InsuranceMap()
{
    References(x => x.Patient, "uid_Patient")
        .Not.Nullable()
        .Cascade.All();

    ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T14:45:40.317

看起来异常源自您的 RepositoryBase.cs 文件的第 25 行，大概是在您的一个瞬态对象上调用 Save() 时。哪一个得救了？

此外，由于我不熟悉 Fluent 语法，它可能无关紧要，子对象（在这种情况下是保险）是否应该有 .Cascade.All 呢？在标准 XML 模式语法中，只有父映射在子对象集合上具有 cascade="all"。

# c - 如何检测在 Linux 或 Solaris 下使用 C 按下箭头键？

> ID：568035
> 
> 赞同：7
> 
> 时间：2009-02-20T02:13:32.307
> 
> 标签：c, linux, solaris

在 C 程序中检测在 Linux 或 Solaris 下按下箭头键的最佳方法是什么？

据我所知，没有标准的 C 函数可以做到这一点。我不想使用 int86 函数。我需要以便携的方式进行。

**编辑**：我在询问控制台应用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T02:39:33.073

您应该查看 curses/ncurses 库，它将为您提供控制台应用程序的高级屏幕和键盘处理。

有很多可用于 curses的[文档，这是一个广泛的库。](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/)

这里有一篇关于这个问题的[文章](http://parameshm.blogspot.com/2005/11/how-to-getor-read-arrow-key-input-in-c.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T11:32:06.837

我相信您的程序应该切换到[非规范模式](http://www.gnu.org/software/libc/manual/html_node/Terminal-Modes.html#Terminal-Modes)才能读取特殊字符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T02:18:10.597

如果您想在不使用 SDL 之类的东西的情况下执行此操作，您应该查看 select() 语句以及如何使用它来读取控制台输入。

# visual-c++ - 如何在 vc++ clistbox 中启用水平滚动？

> ID：568036
> 
> 赞同：2
> 
> 时间：2009-02-20T02:13:39.453
> 
> 标签：visual-c++, scrollbar

如何在 vc++ clistbox 中启用水平滚动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T12:29:20.673

[http://www.codeguru.com/cpp/controls/listbox/article.php/c4759](http://www.codeguru.com/cpp/controls/listbox/article.php/c4759)

# c++ - 嵌套模板专业化

> ID：568046
> 
> 赞同：23
> 
> 时间：2009-02-20T02:18:50.377
> 
> 标签：c++, templates

有脑子放屁……有可能做出这样的事情吗？

```
template<int a> struct Foo
{
    template<int b> struct Bar;
};

template<int a> struct Foo<a>::Bar<1> //Trying to specialize Bar
{
}; 
```

我不必这样*做*，但它可以让我很好地隐藏命名空间范围内的一些实现细节。

建议赞赏！

PS：我忘了提到该语言不支持明确专门针对 Foo 范围内的 Bar 。无论如何，AFAICS。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-21T18:35:49.430

是的你可以。但是您需要更改调用结构，但只是一点点。

具体来说，使用策略模式将成员函数的实现重构为一个类（允许专门化）。

只要策略类不嵌套（因此不依赖于非专门模板类型），这是允许的。

例如（这可能在语法上不正确，但这个想法应该很清楚）

```
template <class T>
class OuterThingThatIsNotSpecialized
{
  template <class U>
  void memberWeWantToSpecialize(const U& someObj_)
  {
    SpecializedStrategy<U>::doStuff(someObj_);
  }
};

template <class U>
struct SpecializedStrategy;

template <>
SpecializedStrategy<int>
{
  void doStuff(const int&)
  {
    // int impl
  } 
};

template <>
SpecializedStrategy<SomeOtherType>
{
  void doStuff(const SomeOtherType&)
  {
    // SOT impl
  } 
}; 
```

这非常有用，因为对不存在实现的类型调用 OuterThingThatIsNotSpecialized 将无法编译。

PS。您甚至可以使用此策略来部分专门化模板函数，这是 C++ 不可能做到的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-07-29T23:21:42.510

1998 年标准 (ISO14882:1998) 第 18 节第 14.7.3 节规定，当（外部）模板类未明确专门化时，不允许（内部）模板成员类的明确专门化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T03:10:14.527

根据这些帖子：

[http://www.cpptalk.net/template-member-function-specialization-vt11666.html](http://www.cpptalk.net/template-member-function-specialization-vt11666.html)

如果不专门化外部类，就不能专门化模板类的模板成员。他们没有引用经文和章节。我的“C++ 编程语言”副本没有立即显示任何内容，而我的标准副本在家里（我的备份副本，在这里更广为人知的“克里斯”也不在身边:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-07T19:21:13.053

这是我一直在做的事情，我认为这更简单/更符合你想要做的事情：

***有帮手***

```
template<int a> struct Foo
{
    template<int, int> struct Bar__;
    template<int b> using Bar = Bar__<b, b>;
};

template<int a> template<int b, int c> struct Foo<a>::Bar__
{
    // general case
    const static int x = 0;
};
template<int a> template<int b> struct Foo<a>::Bar__<b, 1>
{
    const static int x = 1;
};

int main(int argc, const char * argv[]) 
{   
    std::cout << Foo<1>::Bar<0>::x << "\r\n"; // general case - output 0
    std::cout << Foo<1>::Bar<1>::x << "\r\n"; // specialized case - output 1
    return 0;
} 
```

或者 - 如果您不介意每次都将专业化加倍，则可以删除助手：

***没有助手***

```
template<int a> struct Foo
{
    template<int b, int c> struct Bar;
};

template<int a> template<int b, int c> struct Foo<a>::Bar
{
    // general case
    const static int x = 0;
};
template<int a> template<int b> struct Foo<a>::Bar<b, 1>
{
    const static int x = 1;
};

int main(int argc, const char * argv[])
{   
    std::cout << Foo<1>::Bar<0, 0>::x << "\r\n"; // general case - output 0
    std::cout << Foo<1>::Bar<1, 1>::x << "\r\n"; // specialized case - output 1
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T06:47:42.447

你不能那样做。我尝试了很多变化。然而，这在 GCC 4.1 中编译*：*

```
template<int a> struct Foo
{
    template<int b> struct Bar;
    template<1> struct Bar;
}; 
```

编辑（在查看标准后）：但是，如果给出 a，您可以这样做：

```
template <> template <> Foo<1> Bar<1>; 
```

但如果 Foo 不是首先专门化的，则不是。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-06T09:39:26.083

正如其他人指出的那样，如果外部类模板也不是专门化的，C++ 不允许您专门化嵌套类。当我遇到这样的情况时，我可以使用隐藏在内部命名空间中的辅助类来解决它：

```
namespace internal {
  template <int a, int b> struct FooBarHelper
  { /* ... */ };
  // Specialization
  template <int a> struct FooBarHelper<a, 1>
  { /* specialized version goes here */ };
}

template<int a> struct Foo
{
  template<int b> struct Bar : public internal::FooBarHelper<a, b>;
}; 
```

当然，它并不像您希望的那样隐藏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-18T10:59:39.497

正如之前的海报所解释的，这是不可能的。但是，您可以将嵌套模板移动到非模板基类中：

```
struct FooBase
{
    template<int b> struct Bar;
}
template<int a> struct Foo : public FooBase
{
};

struct FooBase::Bar<1> // specializing Bar
{
}; 
```

# bash - 将全局匹配从案例转换为数组

> ID：568056
> 
> 赞同：0
> 
> 时间：2009-02-20T02:24:00.317
> 
> 标签：bash

我正在尝试使用 case 语句在我的 initramfs 中解析 /proc/cmdline。

```
CMDLINE=`cat /proc/cmdline`

for param in $CMDLINE ; do
    case "$param" in
    root=*|init=*)
        eval "$param"
    ;;
    rescue)
        escue="y"
    ;;
    drive*)
        echo -n $param
    ;;
    esac
done 
```

现在的问题是我有驱动器*，我想从 cmdline 获取多个驱动器实例并将它们全部解析为一个数组。

所以 /proc/cmdline 可能看起来像这样。

```
/dev/mapper/Betsy-root vga=792 quiet=y opt2=bar opt1=bar op3=bar drive1="abcde:key.gpg" drive2="qrstuv:key2.gpg" drive3="foobar:false" 
```

问题出在 case 语句期间，当我驱动 *) $param 现在看起来像这样。

```
drive1="abcde:key.gpg"drive2="qrstuv:key2.gpg"drive3="foobar:false" 
```

很好奇实现我想要的最佳方式。这将是动态创建驱动器阵列。例如

```
drive[0]
drive[1]
drive[2] 
```

我尝试做的只是寻找 [a-zA-Z]" 并插入一个新行。这样它们就会被拆分，我可以将它们扔进一个数组中。虽然我从来没有运气让它像我一样工作希望。所以说了这么多……

不知道 /proc/cmdline 中有多少实例。如何将每个驱动器 [0-9] 推入数组。或者也许这只是一个案例陈述的坏地方？任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T03:20:08.000

```
drive*)
    drive_array+=($param) 
```

砰！你有你的阵列。为了与旧 bash 版本兼容：

```
drive*)
    drive_array=("${drive_array[@]}" $param) 
```

如果原始字符串在 drive= 之间有一个空格，那么你就可以了。如果在某些情况下它们没有空格，则必须做一些额外的工作：

```
drive*)
    drive_array+=(${param//drive/ drive}) 
```

这会进行全局替换以在每个驱动器前面添加一个空格，这样它就会被拆分为数组中的不同元素。如果需要，请执行相同的转换以使其与旧版本兼容。

# lucene - 显示每个类别下的搜索文档计数

> ID：568057
> 
> 赞同：0
> 
> 时间：2009-02-20T02:24:48.897
> 
> 标签：lucene, lucene.net

我需要在搜索结果中显示每个类别的文档总数...例如：Rock(1010) Blues(5030) Pop(2209) : :

我在某处读到使用 TopFieldDocCollector 比 HitCollector 类更有效。

鉴于我的要求，我该如何使用 TopFieldDocCollector 类？或者在 Lucene 中还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T08:10:26.953

`HitCollector`是一个抽象类。`TopDocCollector`并且`TopFieldDocCollector`是该类的实现。它们不能“更高效”，因为`HitCollector`. `TopDocCollector`至于和之间的区别`TopFieldDocCollector`- 前者用于您想要按相关性对结果进行排序，而后者用于您想要自定义排序。

现在，关于您的问题，请查看[我](https://stackoverflow.com/questions/152127/using-lucene-to-count-results-in-categories/482639#482639)对类似问题的回答。

# php - 在 PHP 中使用“史努比”通过 GET 提交数据

> ID：568060
> 
> 赞同：1
> 
> 时间：2009-02-20T02:26:09.033
> 
> 标签：php, post, get, httprequest, snoopy

我正在尝试通过`GET`PHP 将数据发送到 url。在这里收到另一个问题的答案后，我决定参加[史努比班。](http://sourceforge.net/projects/snoopy/)问题是，我似乎无法为此类中的方法找到非常好的文档/示例。

我看到了该`->httprequest()`方法，但看不到可以在哪里添加值数组以及请求。

有没有比较熟悉的可以帮忙啊？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T02:36:30.693

```
$vars = array( "fname" => "Jonathan", "lname" => "Sampson" );
$snoopy = new Snoopy();

$snoopy->httpmethod = "GET"; // is GET by default
$snoopy->submit( "http://www.example.com", $vars );
print $snoopy->results; 
```

# asp.net - 计算本季度和上一季度的 StartDate 和 EndDate

> ID：568062
> 
> 赞同：2
> 
> 时间：2009-02-20T02:27:15.287
> 
> 标签：asp.net, asp.net-2.0, asp.net-3.5

我需要在 vb.net 中计算当前季度和上一季度的 StartDate 和 EndDate。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-20T03:02:15.577

我知道你指定`VB.Net`了，但我更愿意在`C#`. 如果需要，我相信有人可以翻译。

```
public static DateTime QuarterEnd() {
    DateTime now = DateTime.Now;
    int year = now.Year;
    DateTime[] endOfQuarters = new DateTime[] {
        new DateTime(year, 3, 31),
        new DateTime(year, 6, 30),
        new DateTime(year, 9, 30),
        new DateTime(year, 12, 31)
    };
    return endOfQuarters.Where(d => d.Subtract(now).Days >= 0).First();
} 
```

我更喜欢这个解决方案而不是其他涉及模算术和丑陋条件的解决方案，因为它很容易修改以处理非标准季度定义。方法的定义`QuarterStart`类似处理，留给亲爱的读者作为练习。或者，您可以修改此方法以返回`struct`包含所需开始和结束日期的 a。

**编辑，添加上述 C#-code /Stefan**的 VB.Net 版本：****

 **```
Public Function QuarterEnd() As Date
    Dim endOfQuarters As Date() = New Date() { _
        New Date(Now.Year, 3, 31), _
        New Date(Now.Year, 6, 30), _
        New Date(Now.Year, 9, 30), _
        New Date(Now.Year, 12, 31)}
    Return endOfQuarters.Where(Function(d) d.Subtract(Now).Days >= 0).First()
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T02:42:47.603

请原谅我缺乏特定于 VB.net 的答案，但给出了一种通用的日期对象，它具有一些伪语言中的各种功能（具有从零开始的日期和月份索引）......

```
//round the current month number down to a multiple of 3
ThisQuarterStart = DateFromYearMonthDay(Today.Year,Today.Month-(Today.Month%3),0);
//round the current month number up to a multiple of 3, then subtract 1 day
ThisQuarterEnd = DateFromYearMonthDay((Today.Month<9)?(Today.Year):(Today.Year+1),(Today.Month-(Today.Month%3)+3)%12,0) - 1;
//same as above, but minus 3 months
LastQuarterStart = DateFromYearMonthDay((Today.Month<3)?(Today.Year-1):(Today.Year),(Today.Month-(Today.Month%3)+9)%12,0)
LastQuarterEnd = ThisQuarterStart - 1; 
```

**编辑将上述伪代码转换为工作**VB.Net：/Stefan

```
Dim ThisQuarterStart As Date = New Date(Today.Year, Today.Month - (Today.Month Mod 3) + 1, 1)  
Dim ThisQuarterEnd As Date = New Date(CInt(IIf(Today.Month < 9, Today.Year, Today.Year + 1)), (Today.Month - (Today.Month Mod 3) + 3 Mod 12) + 1, 1).AddDays(-1)
Dim LastQuarterStart As Date = New Date(CInt(IIf(Today.Month < 3, Today.Year - 1, Today.Year)), (Today.Month - (Today.Month Mod 3) + 9 Mod 12) + 1, 1)
Dim LastQuarterEnd As Date = ThisQuarterStart.AddDays(-1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T11:20:33.090

vb.net 转换需要更改。将其更改为 vb 6，它应该是；

ThisQuarterStart = DateSerial(today.Year, today.Month - (IIf(today.Month Mod 3 = 0, 3, today.Month Mod 3)) + 1, 1)

ThisQuarterEnd = DateSerial(CInt(IIf(today.Month < 9, today.Year, today.Year + 1)), ((today.Month - (IIf(today.Month Mod 3 = 0, 3, today.Month Mod 3) )) + 3) 模型 12) + 1, 1) - 1

# actionscript-3 - 协议简单性与“适当性”

> ID：568074
> 
> 赞同：4
> 
> 时间：2009-02-20T02:35:46.250
> 
> 标签：actionscript-3, erlang, network-programming, network-protocols

我和我的一个朋友还有另一个争论。

考虑需要设计一个简单的基于 JSON 的协议，该协议基本上用于在各方之间发送某种事件（消息）。

说，像

```
 { event_id: 1, chat_message: "Hello" }
 { event_id: 2, group_id: 3, presence: "online" }
 ... 
```

我建议像上面一样保留这个协议，而我的朋友建议做类似的事情：

```
 { event_id: 1, details: { chat_message: "Hello" } }
 { event_id: 2, group_id: 3, details: {  presence: "online" } }
 ... 
```

他的论点是，就像 TCP 和 HTTP 处于不同的“责任”层一样，该协议应该使用“详细信息”子对象以保持数据分离。

他的另一个论点是处理匹配事件的处理程序不应该知道任何有关“路由”信息（例如 event_id）的信息。

我的论点是：

1.  为了向处理程序隐藏这些信息，我们正在增加每条消息的长度（以及网络流量，这对于与大量消息交换的系统可能很重要）
2.  处理程序确实需要知道“路由”信息，例如，才能正确回答它们：

    ```
    this.replyTo(event['event_id'], reply); // or...
    this.replyTo(event, reply); 
    ```

3.  即使我们需要从处理程序中隐藏 event_id 和类似的东西，我们也可以在传递给处理程序之前将它们去掉，这样仍然可以节省流量

该协议非常简单，不应该被其他任何人使用。

你怎么**看**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T10:26:45.183

在大型项目的长期经验之后，我必须强烈反对[gahooa](https://stackoverflow.com/questions/568074/protocol-simplicity-versus-properness/568100#568100)和[Charlie Martin](https://stackoverflow.com/questions/568074/protocol-simplicity-versus-properness/568113#568113)的建议。敏捷方法和经典方法之间存在很大的张力。他们的建议看起来很敏捷，但我不能同意。如果你设计了一些东西，千万不要以你现在就知道是错误的方式来设计它。这不是敏捷，是愚蠢。我不敢相信您认为您的需求在未来不会改变，因此请保持开放并将重构影响降至最低。在您当前的设计中，当事件由不同的子系统作为事件类型调度程序 -> 路由器到组 -> 最终事件处理程序/存储或其他方式处理时，请保持每个子系统中的更改对彼此的影响最小。对我来说最好的负担是像洋葱皮芽这样的设计协议，不要将它设计到您*当前*要求之外的每一个细微细节上。它很敏捷。

你的论点：

广告 1\. 这是过早的优化。如果您确实需要最小化流量，请改用二进制协议；-) ti 的其他成本/收益方式是错误的。

广告 2\. 它适用于内部程序检测，而不是协议本身。这是错误的设计，尤其是在 Erlang 中。您的处理程序不应该直接返回到目的地，而是返回到保持套接字所有权和类似的某些路由器（通常返回到调度程序）。看起来又是过早的优化！

广告 3\. 我更喜欢相反的方法。为子系统提供最小的数据集以最大程度地减少副作用，简化（单元）测试并避免使用第 2 点的方法。必要时延长。不要以相反的方式进行。

PS：为什么你不命名你的活动而是使用ID？再次过早优化？

**编辑：** Ids 被澄清，那些是事件编号但不是事件类。应该有另一个类键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T02:48:17.233

喜欢简单...

当您编写规范、分布式系统以及将在您无法控制的许多不同情况下使用的规范时，将需要适当性。

**务实**，通常最好使用“语言的力量”并编写代码来处理每种情况。除非你**需要，**否则不要**抽象**。

 ***把事情简单化。保持快速。保持干净。*

您不知道它可能需要演变成什么（功能或性能），并且您拥有的抽象越多，重构就越困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T02:55:52.410

曾几何时，当 ARPAnet 还很新，IP 还只是一个想法的萌芽时，有人说：“哦，天哪，一个 32 位 IP 地址就足够了——四*十亿*个地址？没有人会需要它。见鬼，我们可以将它们分成不同的地址类型，有足够的空间。”

25 年后，我们几乎不知道这将是一个问题。

甚至不要和我*谈论*域名命名。

关键是：你需要考虑什么可以改变。*仅仅为了优雅而*将其变成名称空间的层次结构是不必要且浪费的，而且当您的额外层不提供任何更多信息内容时，那何必费心呢。

另一方面，如果您这样做是为了使您的代码对问题的变化不那么敏感，或者使实现明显更容易或更不容易出错，那么它可能是值得的。

所以这就是你的答案：它*只是*为了更优雅，还是有其他优势？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-08T09:30:12.393

这是两个*正确的*解决方案。如果您真的需要担心网络流量，您的解决方案是可以接受的。但是您还必须记住，代码维护占据了代码生命周期的大部分时间，因此今天让代码更干净，您将来可能会节省一些时间（已经提到过维护）。

在我看来，您应该有基于强有力事实的良好论据来考虑这种优化。

# blackberry - 黑莓：本地化、资源包

> ID：568079
> 
> 赞同：5
> 
> 时间：2009-02-20T02:36:47.323
> 
> 标签：blackberry, localization

我需要 BlackBerry 本地化方面的帮助。我学习了[http://na.blackberry.com/eng/developers/resources/developer_labs.jsp#tab_tab_jde](http://na.blackberry.com/eng/developers/resources/developer_labs.jsp#tab_tab_jde)上 题为**Localizing an application**的课程。我已经创建了资源头文件 (.rrh) 和资源内容文件 (.rrc)。我很困惑他们从哪里得到这个“CityInfoBResource”？它是一个名为“CityInfoBResource.java”的文件，它包含一些定义。见注 1。这个文件是如何生成的？请给我一些关于如何生成此文件的线索或指出正确的方向，谢谢。

```
Note 1:
package com.rim.samples.cityinfo.i18n;

public interface CityInfoBResource {
    // Hash of: "com.rim.training.cityinfo.i18n.CityInfoB".
    long BUNDLE_ID = 0x14bf5713287b65c0L;
    String BUNDLE_NAME = "com.rim.training.cityinfo.i18n.CityInfoB";

    int FIELD_TITLE = 1;
    int FIELD_NEWYORK_POP = 17;
    int CLOSE = 20;
    int FIELD_LA_SIGHTS = 21;
    int FIELD_CITIES = 2;
    int FIELD_STATE = 7;
    int APPLICATION_TITLE = 0;
    int FIELD_LA_POP = 10;
    int FIELD_NEWYORK_STATE = 18;
    int FIELD_CHICAGO_SIGHTS = 15;
    int FIELD_CHICAGO_STATE = 14;
    int FIELD_CHOICE = 3;
    int FIELD_CHICAGO_POP = 13;
    int MENUITEM_VIEW = 4;
    int FIELD_LA = 9;
    int FIELD_NEWYORK = 16;
    int FIELD_LA_STATE = 11;
    int FIELD_CHICAGO = 12;
    int FIELD_NEWYORK_SIGHTS = 19;
    int FIELD_POP = 6;
    int MENUITEM_CLOSE = 5;
    int FIELD_SIGHTS = 8;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T16:03:13.907

你已经明白了。当您创建一个名为“MyFile.rrh”的资源头文件（以及相应的 .rrc 文件）时，BlackBerry 编译器会自动在同一个包中（或者更具体地说，在对应的包中）生成一个名为“MyFileResource”的接口到您的 .rrh 文件所在的目录）。

这是在编译时完成的，因此您实际上在任何时候都不会为该接口获得相应的 .java 文件。但是，JDE 和 Eclipse 的 JDE 插件也会识别您何时将更改保存到 .rrh 文件并将这些更改提供给编辑环境，这样您在开发时就不会收到警告。

# iphone - 可以“重置”UIDatePicker 突出显示的月/日/年吗？

> ID：568097
> 
> 赞同：1
> 
> 时间：2009-02-20T02:46:32.137
> 
> 标签：iphone, cocoa, cocoa-touch, uidatepicker

我有一个视图控制器，我正在重复使用它来编辑以前视图控制器的 TableView 中的单个对象（NSString、NSNumber、NSDate）。我松散地基于 Apple 的 SQLiteBooks 示例项目中的 EditingViewController。datePicker 在 nib 文件中实例化。

这里的问题是它在我设置的第一次约会时效果很好。但是，当在第二个日期再次调用时，它会在加载时正确显示我在其翻转器中编辑的下一个日期（？），但是，突出显示的（蓝色）月份、日期和年份是选择器第一次出现时的日期在第一次编辑之前显示。如何将这些突出显示的值设置为第二个日期对象的初始值或重置整个 UIdatePicker 实例。

第二个相关问题（加分；-），因为我很难把头绕在 Cocoa 周围：为什么，在 SQLiteBooks 示例中，EditingVewController.h 中声明的 datePicker 没有 @property 或 @synthesize 语句？还是我忽略了显而易见的事情？谢谢！

编辑：在使用 UIDatePickers 对其他应用程序进行一些实验后，无论出于何种原因，UIDatePicker 在日期模式下使用时都会突出显示当前月份、日期和年份，即使您正在编辑 1776 年的日期。我们如何才能改变这种行为离开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T07:51:07.083

存储第一个选择器的日期，例如storedDate。然后使用它的 date 属性设置要在 UIDatePicker 中显示的日期。假设你的 UIDatePicker 被命名为选择器，那么

```
 picker.date = storedDate; // picker's date is initialised to today's date/time 
```

如果您希望选择器为您的日期设置动画，也可以使用此方法：

```
[picker setDate:storedDate animated:YES]; 
```

至于属性，它们只应用于公共数据是不正确的。属性是指通过方法访问而不是通过实例变量直接访问的数据。属性声明（特别是@synthesize）告诉编译器使用这些声明来根据需要自动生成访问器方法以满足您的类的接口。

Objective-C 中的点语法被编译器转换为访问器方法的调用。所以...

```
foo.bar = @"hello"; 
```

被编译器翻译成...

```
[foo setBar:@"hello"]; 
```

同样生成的 setBar 将根据其 @property 声明做它应该做的一切。所以如果它被声明为retain，它将被正确地保留在它的setter中，而你不必担心它。

因此，总而言之，虽然您提到的 Apple 代码可能正常工作（我没有看过），但使用属性会是更好的防御性编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T03:57:11.483

> 第二个相关问题（加分；-），因为我很难把头绕在 Cocoa 周围：为什么，在 SQLiteBooks 示例中，EditingVewController.h 中声明的 datePicker 没有 @property 或 @synthesize 语句？还是我忽略了显而易见的事情？谢谢！

如果你想公开属性，你只需要声明一个@property。对于私有实例变量，您可以忽略它。

而@synthesize 只是让编译器为你的@property 创建访问器方法，所以如果它不是@property，你就不要使用@synthesize（或@dynamic）。

# dojo - 为自定义构建 Dojo 脚本设置过期时间

> ID：568107
> 
> 赞同：1
> 
> 时间：2009-02-20T02:50:57.163
> 
> 标签：dojo

您好我是 Dojo 的新手，并尝试通过创建自定义构建来压缩 Dojo 脚本。我们知道最好设置过期时间，这样文件就不会每次都被下载，但这是我的问题，因为压缩和自定义构建后，Dojo.js 没有过期时间。

我们如何为编译的自定义构建设置过期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T09:04:07.697

我真的不明白你的问题。

人们通常创建自定义 dojo 构建，因为他们只想包含他们需要的包。通过创建你的构建，你不是在处理缓存问题，也不是缩小代码——它是关于**下载和解释更少的代码**（你可以使用很棒的“Xdomain loading”功能，但这是另一个问题）。

我认为您想调整 httpd.conf 文件（如果您使用的是 apache 服务器）并使用以下内容设置 Expire Header：

```
<IfModule mod_expires.c>
ExpiresActive On
ExpiresByType application/x-javascript A8640000
</IfModule> 
```

（在这里，您将所有 javascript 文件的到期日期设置为“客户端访问日期 + 100 天”）

一些额外的建议：

*   不要忘记将“FileETag none”行添加到您的配置中，尤其是当您的文件托管在多个服务器上时。
*   当您的应用程序的新版本发布时，不要忘记更改 URL。在 URL 中添加版本号或交付日期是个好主意。否则你的激进缓存指令将是一个问题。

# login - IE7 中的 DotNetNuke (dnn) 登录问题

> ID：568112
> 
> 赞同：0
> 
> 时间：2009-02-20T02:55:40.210
> 
> 标签：login, dotnetnuke

我刚刚将 dnn 网站移至运行 Windows 2008 64 位的新网络服务器。经过一些调整后，我能够让事情运行得很好。然而，还有最后一个怪癖。当我尝试登录网站的管理员/主机部分时，我收到一个错误。具体来说，我得到

```
A critical error has occurred.- Object reference not set to an instance of an object 
```

讽刺的是，我只在使用 Internet Explorer 7 登录时收到此错误。我可以使用FF3成功登录。有谁知道会导致这种情况的原因是什么？我完全不知所措。

我正在使用经典应用程序池在 IIS7 中运行 dnn 3.0.13。

**dnn 应用程序中的日志或 Web 服务器上的事件查看器中没有报告错误/异常。令人沮丧，我知道。**

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T19:24:36.723

事实证明，问题不仅仅是 IE7 登录问题。每当我尝试更新内容时，都会收到错误消息（红色三角形，但日志中没有任何内容）。最后，我意识到我非常旧的 DNN 版本无法在 .NET 2.0 中运行。我正在运行这样一个旧版本，因为它是一个我仍然需要支持的遗留应用程序。显然，应该探索升级路径。

无论如何，我的解决方案是安装 .NET 1.1。我按照[此处](http://blogs.iis.net/rakkimk/archive/2008/03/20/iis7-running-asp-net-1-1-applications.aspx)列出的说明进行操作。我的其他 Web 服务器上没有这个问题，因为它们预装了 .NET 1.1。IIS7 没有与它捆绑在一起。

这解决了我所有的问题，并且运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T03:33:37.250

您能否查看服务器的应用程序事件日志，如果您看到异常，请编辑您的问题并发布它？

# c# - 自定义配置、ConfigurationElements 和 ConfigurationProperties

> ID：568125
> 
> 赞同：14
> 
> 时间：2009-02-20T03:04:10.283
> 
> 标签：c#, app-config, configurationsection, configurationelement

最近三天我一直在网上搜索，找不到任何关于这个问题的参考资料。我创建了一个自定义配置类以与我的 app.config 一起使用。一切正常。当不需要（配置元素的）配置属性并且未在 app.config 中定义时，就会出现问题。似乎为配置属性返回了默认值。有谁知道如何确定该属性是否未在 app.config 中定义？（我一直在尝试发布我的 app.config，但不知道该怎么做……有人知道吗？）

```
 //Main
namespace TestStub
{
    class Program
    {
        static void Main(string[] args)
        {
            CustomSettingsHandler config = (CustomSettingsHandler)ConfigurationManager.GetSection("CustomSettingsManager");
            Console.WriteLine("Setting1 {0}", config.Setting1.CustomSettingItem);
            Console.WriteLine("Setting2 {0}", config.Setting2.CustomSettingItem);
        }
    }
}

//Custom Configuration Class
namespace CustomConfiguration
{
    public class CustomSettingsHandler : ConfigurationSection
    {
        [ConfigurationProperty("setting1", IsRequired = false)]
        public CustomSettingElement Setting1 { get { return (CustomSettingElement)this["setting1"]; } }

        [ConfigurationProperty("setting2", IsRequired = false)]
        public CustomSettingElement Setting2 { get { return (CustomSettingElement)this["setting2"]; } }
    }

    public class CustomSettingElement : ConfigurationElement
    {
        [ConfigurationProperty("customsettingitem", IsRequired = false)]
        public int CustomSettingItem { get { return (int)this["customsettingitem"]; } }
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-13T13:45:16.407

我发现最好的方法是覆盖`ConfigurationSection.PostDeserialize()`并检查`IsPresent`派生自`ConfigurationElement`.

```
public class CustomSettingsHandler : ConfigurationSection
{
    // ...

    protected override void PostDeserialize()
    {
        foreach (ConfigurationProperty property in Properties)
        {
            var configElement = this[property] as ConfigurationElement;

            if (configElement != null 
                && !configElement.ElementInformation.IsPresent)
            {
                this[property] = null;
            }
        }

        base.PostDeserialize();
    }
} 
```

未从配置文件中读取的每个`ConfigurationElement`都将在`null`之后。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T03:10:42.140

我能想到的两件事是使用 DefaultValue，如下所示：

```
 [ConfigurationProperty("customsettingitem", DefaultValue = -1)]
    public int CustomSettingItem { get { return (int)this["customsettingitem"]; } } 
```

假设有一些无效的值。在这种情况下，CustomSettingItem == -1 表示未设置，>= 0 是在 config.xml 中设置的值。当然，这首先假设 -1 不是有效输入。

第二个想法是使用可为空的 int 代替：

```
 [ConfigurationProperty("customsettingitem", IsRequired = false)]
    public int? CustomSettingItem { get { return (int?)this["customsettingitem"]; } } 
```

现在，如果在配置中没有设置任何内容，它应该默认为 null 而不是 0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-26T15:47:29.050

尝试以下操作：

```
configElement.ElementInformation.Properties[propName].ValueOrigin = 
        PropertyValueOrigin.SetHere 
```

物业`ValueOrigin`告诉你价值从何而来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-06T14:35:40.053

到目前为止，如果配置文件中没有定义一个属性，我还不能告诉它为空。似乎在它的无限智慧中，当您键入 null 时，Microsoft 决定您的真正意思是 String.Empty 或 new ConfigurationElement()。

我目前解决它的方式是这样的：

```
 bool _hasProp = true;
    protected override object OnRequiredPropertyNotFound(string name)
    {
        if (name == "prop")
        {
            _hasProp = false;
            return null; // note that this will still not make prop null
        }
        return base.OnRequiredPropertyNotFound(name);
    }

    [ConfigurationProperty("prop", IsRequired = true)]
    public string Prop
    {
        get { return _hasProp ? (string) this["prop"] : null; }
    } 
```

这是一种黑客行为，会根据需要错误地标记该属性。如果您使用工具来编辑配置文件，则不会这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-26T22:36:22.007

您还可以使用以下方法进行检查：

```
config.Setting1.CustomSettingItem.ElementInformation.IsPresent 
```

如果在您的配置文件中找不到它，它将给您错误。

# c# - Form Post 通过 Request.QueryString 而不是 Request.Form 发送值

> ID：568129
> 
> 赞同：3
> 
> 时间：2009-02-20T03:05:05.163
> 
> 标签：c#, html, forms, post

以下是标准 HTML 页面中的 HTML 摘录：

```
<form name="login_form" action="http://localhost/BOB.WebPortal/LoginForm.aspx" method="post>
        <div id="content_logins">

            <div id="spacer_ie" style="width:990px; height:7px; border:none; float:left"></div>
            <div style="width:255px; height:22px; border:none; float:left"></div>
            <div style="width:172px; border:none; float:left; vertical-align:bottom">
                    <input type="text" name="uname" id="uname" size="13" /></div>
                <div style="width:110px; border:none; float:left">
                    <input type="password" name="pword" id="pword" size="13" /></div>
                <div style="width:140px; height:22px; border:none; margin-top:-2px; float:left">
                    <!--input class="btbgfix" type="image" src="images/submit.png" alt="Submit" value="Login"-->
                <input name="submit" id="loginButton" class="btbgfix" type="image" src="images/submit.png" alt="Submit" value="Login"></div>
            <div style="width:320px; height:22px border:none; float:left">
                <img name="login" src="x.gif" id="alogin" usemap="#m_login" border="0" width="320" height="22" />
                <map name="m_login" id="m_login">
                    <area shape="rect" coords="0,0,681,22" href="https://www.aetmyportfolio.com.au" target="_blank" alt="Go to AET My Portfolio" />
                </map>
            </div>  

            </div> 
    </form> 
```

我的问题是我正在尝试使用 Request.Form 从我的 ASP.Net 应用程序中的 C# 代码隐藏文件的 Page_Load 事件中检索帖子值 uname 和 pword。但是我发现 Request.Form 是空的。但是，如果我使用 Request.Params，那么我可以访问这些值，因为它们作为 URL 中的查询字符串值传递。

我在我的 html 中做错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T03:29:27.383

假设这是从您的 HTML 直接复制粘贴，那么您在“post”末尾缺少一个结束引号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T03:30:20.953

由于您正在为登录控件使用标准 HTML 页面，因此 runat="server" 似乎无法解决您的所有问题。这是我如何复制您的解决方案的快速示例。它似乎正确地提取了这些值。

**登录页面**

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
</head>
<body>
    <form name="login_form" action="Default.aspx" method="post">
    <div id="content_logins">
            user:<input type="text" name="uname" id="uname" size="13" /><br />
            pass:<input type="password" name="pword" id="pword" size="13" /><br />
            <input name="submit" id="loginButton" type="submit" alt="Submit" value="Login">
    </div>
    </form>
</body>
</html> 
```

**默认.aspx**

```
 <%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
        <br />
        <asp:Label ID="Label2" runat="server" Text="Label"></asp:Label>
    </div>
    </form>
</body>
</html> 
```

**默认.aspx.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        this.Label1.Text = Request.Params["uname"].ToString();
        this.Label2.Text = Request.Params["pword"].ToString();
    }
} 
```

# java - 何时应使用 EJB 事务属性“强制”和“从不”

> ID：568134
> 
> 赞同：3
> 
> 时间：2009-02-20T03:10:35.790
> 
> 标签：java, jakarta-ee, ejb

我指的是 Enterprise Java Beans 中的容器管理事务属性。我想不出任何使用“强制”和“从不”有意义的用例。任何人都可以解释使用这些交易属性的情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-25T16:46:08.793

我最近参与了一个项目，该项目坚持所有事务都在应用层（服务类）被标记出来，并且不能直接调用数据访问对象。

这是为了确保在没有调用相关应用程序逻辑的情况下永远不会写入数据库（通常，数据库操作与发送到队列的消息配对）。

在每个 DAO EJB 上应用 MANDATORY 可确保当它们在事务中运行时，调用者的工作是启动一个事务。由于 DAO 是由服务类调用的（默认为 REQUIRED），这意味着它们工作得很好，但任何不小心直接调用它们的人都会得到异常奖励。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T15:43:29.697

这是我对此的看法：

**强制**：一个 EJB 可能提供了一些内部函数，假设/依赖于调用者的*事务*已经运行，如果不是，由于各种原因，不能启动一个，所以它会抛出一个 EJB 错误。所以这里真正的问题是为什么这永远是一个要求，我可以设计的唯一场景是在事务开始时可能必须执行特定的事务相关操作，并且某些 EJB 没有为这些操作配备等等被标记为强制性的。我想您也可以使用此属性来确保获得一致且正确排序的锁，如果不这样做可能会导致死锁。

**Never**：如果在调用 EJB 时事务正在运行，这会强制您的 EJB 抛出异常，同样，真正的问题是什么样的场景需要这样做。参考[Mastering EJB Third Edition](http://www.theserverside.com/tt/books/wiley/masteringEJB/downloads/MasteringEJB3rdEd.pdf)，Ed Roman 断言该属性通过防止错误地假设 EJB 将参与[ACID](http://en.wikipedia.org/wiki/ACID)过程，从而有助于减少客户端编码错误。

也许其他人将能够为这些属性提供更具体的场景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T08:28:53.767

我有一个**强制**属性有用的情况：

我有一个 bean，它被许多应用程序调用。根据调用应用程序，我希望能够加入调用事务，或在新事务中运行。所以我定义了2个bean，一个带有RequiresNew，一个带有Required。第二个可以使用 Mandatory，以确保有调用事务，但这不是必需的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T14:50:27.480

**强制**和**从不**用于通过抛出异常明确告知客户端未在事务范围内运行的情况。

**强制**抛出*TransactionRequiredException*而**从不**抛出*RemoteException*。

例如，如果客户端在事务*内部/外部*运行并调用企业 bean 的方法，该方法也将在事务*内部/外部*运行，则不会为**SUPPORTS**引发异常。但是，如果您使用**MANDATORY**，对于*外部*情况，将抛出 TransactionRequiredException。

# asp.net-mvc - 将控制器工厂添加到 ASP MVC

> ID：568137
> 
> 赞同：14
> 
> 时间：2009-02-20T03:11:06.850
> 
> 标签：asp.net-mvc

我有一个正在工作的大型项目的设计理念，我想我已经想通了，但我真的很想得到一些关于 a) 总体想法和 b) 我提议的实施的反馈。

基本思想很简单：我想创建一个 ASP MVC 应用程序，该应用程序将来可以通过额外的控制器和视图进行扩展，而无需重新编译代码。这个想法是让一个 MVC 应用程序具有一组非常基本的功能，然后通过添加另一个“Application.dll”来扩展功能，其中包含特定于该应用程序的控制器、数据和业务逻辑。视图将被简单地复制在安装期间进入与主 MVC 应用程序相同的目录。

问题是 MVC 对同一程序集中的类型进行路由，因此即使我将路由定义移动到数据库，MvcHttpHandler 也无法将任何内容路由到新的 Dll，因为它不“知道”控制器类型在里面。查看 MVC 代码，我发现要加载控制器，它们只需调用 Activator.CreateInstance ，它只在当前程序集中查看。

我的解决方案很简单，但也许我遗漏了一些东西：我将通过直接替换 ControllerFactory（不知道如何做）或在派生类中复制该功能来覆盖 MvcHttpHandler。新代码将读取请求并尝试首先从当前程序集加载控制器，然后从扩展程序集加载。一旦找到合适的程序集，我将使用 CreateInstance 并将该程序集传递给它以获得我想要的控制器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T03:17:47.270

[本文](http://weblogs.asp.net/shijuvarghese/archive/2008/10/10/asp-net-mvc-tip-dependency-injection-with-structuremap.aspx)最后展示了如何实现自己的ControllerFactory。基本上，您从 DefaultControllerFactory 派生，然后将其连接到 global.asax 中的 Application_Start() 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T03:40:23.177

控制器工厂的想法并没有错，只要它只是为了以后的灵活性。当您使用属于其他层的代码加载控制器时出现问题，这是您可能“需要”其他控制器灵活性的原因之一。只要你不将层混合在一起，我认为工厂的想法没有真正的问题。

# emacs - 分析行为不端的 Emacs Lisp 的提示？

> ID：568150
> 
> 赞同：46
> 
> 时间：2009-02-20T03:17:10.143
> 
> 标签：emacs, profiling, elisp, dot-emacs

我经常定制 Emacs。最近，我在我的 .emacs 配置中添加了一些东西，它偶尔会将我的 CPU 固定在 100%，但我真的不知道它是什么。

*如果我按 Cg 多次，最终我会在 minibuffer下方*收到一条消息，询问我是否要自动保存文件，然后是否要完全中止 emacs。如果我一直拒绝并一直按 Cg，最终我可以恢复正常运行 emacs。一个小时左右后，它会再次发生。

我可以像现在这样继续前进，评论我最近添加的各种内容，重新启动 emacs，试图缩小罪魁祸首，但进展缓慢。

**有没有办法可以直接分析 emacs 以找出占用 CPU 的 lisp 函数？**

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-02-20T13:48:56.943

设置`debug-on-quit`为`t`以便您可以了解 Emacs 正在做什么的建议是一个很好的建议。您可以将其视为使用单个样本进行抽样分析的一种形式：通常您只需要一个样本。

* * *

**更新：**从 24.3 版开始，Emacs 包含*两个*分析器。中有一个（新的）采样分析器`profiler.el`，和一个（旧的）仪器分析器在`elp.el`.

采样分析器[在此处记录](http://www.gnu.org/software/emacs/manual/html_node/elisp/Profiling.html)。使用起来非常简单：

> 要开始分析，请键入`M-x profiler-start`。您可以选择按处理器使用情况、内存使用情况或两者进行分析。完成一些工作后，键入`M-x profiler-report`以显示您选择分析的每个资源的摘要缓冲区。完成分析后，键入`M-x profiler-stop`.

这是我维护的带有[Perforce/Emacs 集成](https://github.com/gareth-rees/p4.el)`cpu+mem`的分析器会话的一些示例输出。我扩展了最顶层的函数 ( )，以便找出[CPU 时间和内存使用的来源](https://github.com/gareth-rees/p4.el/issues/112)。`progn`

```
Function                                            Bytes    %
- progn                                        26,715,850  29%
  - let                                        26,715,850  29%
    - while                                    26,715,850  29%
      - let                                    26,715,850  29%
        - cond                                 26,715,850  29%
          - insert                             26,715,850  29%
            + c-after-change                   26,713,770  29%
            + p4-file-revision-annotate-links       2,080   0%
+ let                                          20,431,797  22%
+ call-interactively                           12,767,261  14%
+ save-current-buffer                          10,005,836  11%
+ while                                         8,337,166   9%
+ p4-annotate-internal                          5,964,974   6%
+ p4-annotate                                   2,821,034   3%
+ let*                                          2,089,810   2% 
```

你可以看到罪魁祸首是`c-after-change`，所以看起来我可以通过[本地绑定`inhibit-modification-hooks`到`t`周围的代码](https://github.com/gareth-rees/p4.el/commit/4e015793877a56c4ccb1bfbb6e2d278be7c078d8)来节省大量的 CPU 时间和内存。

* * *

您还可以使用 Emacs Lisp Profiler。这是相当不足的记录：您必须阅读注释以`elp.el`了解详细信息，但基本上您运行`elp-instrument-package`以打开具有给定前缀的所有函数的分析，然后`elp-results`查看结果。

`M-x elp-instrument-package RET c- RET`这是键入、字体化 4,000 行 C，然后运行`elp-results`（并使用`elp-sort-by-function`按调用次数排序）后的一些典型输出：

```
Function Name                  Call Count  Elapsed Time  Average Time
=============================  ==========  ============  ============
c-skip-comments-and-strings    107         0.0           0.0
c-valid-offset                 78          0.0           0.0
c-set-offset                   68          0.031         0.0004558823
c-end-of-macro                 52          0.0           0.0
c-neutralize-CPP-line          52          0.0           0.0
c-font-lock-invalid-string     20          0.0           0.0
c-set-style-1                  19          0.031         0.0016315789
... 
```

在您的特定情况下，分析器不会立即提供帮助，因为您不知道哪个包有问题。但是，如果您可以做出猜测（或使用`debug-on-quit`它来确定），那么分析器可以帮助您详细诊断问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-20T03:41:29.787

你有没有试过：`Options->Enter debugger on Quit/C-g`？（这是在 emacs22 上）

如果您需要调试 emacs 的启动：使用`emacs -q --no-site-file`，访问您的`.emacs`（`site-start.el`或其他），激活菜单项`Options->Enter debugger on Quit/C-g`，然后是菜单项`Emacs-Lisp->Evaluate buffer`，`C-g`当它出现冻结时。可能有更简单的方法来做到这一点............

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-19T12:26:26.143

使用 dope.el，您可以分析整个 .emacs 或在启动时加载的多个 elisp 文件。从[www.gnufans.net/~deego/pub/emacspub/lisp-mine/dope/下载](http://www.gnufans.net/~deego/pub/emacspub/lisp-mine/dope/)

`M-x dope-quick-start`将显示一个小介绍教程。

**编辑：**原始 URL 现已失效，但 Git Hub 上有一个工作镜像：
[https ://raw.github.com/emacsmirror/dope/master/dope.el](https://raw.github.com/emacsmirror/dope/master/dope.el)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-20T03:23:40.470

严格来说，这不是您问题的答案，而是您可以使用该`-q`选项启动 emacs，将您的 .emacs 加载到缓冲区中并使用 Cx Ce 自己评估每个 sexpr ，而不是执行注释和重新启动的事情追查有问题的人。

# ajax - django，谷歌地图集成

> ID：568151
> 
> 赞同：4
> 
> 时间：2009-02-20T03:17:21.423
> 
> 标签：ajax, django, google-maps

我需要将 django 应用程序与视觉直观的 google-maps 界面集成，以用于无线电派遣保安/emt 的目的。

我已经在使用 GeoDjango，尽管它看起来对于特定用途来说可能有点矫枉过正。无论如何，它已经使服务器上的地理空间处理变得像我需要的那样简单。

但是我的 javascript 足够弱，无需自己构建 ajax rpc 层。有什么工具或技术可以帮助做到这一点吗？

**编辑：**为了澄清，我不是在问如何使用谷歌地图 api。正如[这篇文章](https://stackoverflow.com/questions/568151/django-google-maps-integration/568699#568699)所解释的，谷歌提供了很好的文档，网络上有很多例子，来自[谷歌](http://code.google.com/apis/ajax/playground/?exp=maps)或[其他](http://koti.mbnet.fi/ojalesa/exam/index.html)，解释了如何使用独立的 api。Django 也有很好的文档。

将它们一起使用会减慢我的速度。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-12-02T22:32:41.163

有点晚了，但是有一个[http://pypi.python.org/pypi/django-easy-maps](http://pypi.python.org/pypi/django-easy-maps)应用程序可以让 Google Maps 集成在简单情况下变得轻松（显示地址的地图）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T08:19:03.070

Google Maps API 并不难学（+ 有很好的文档），自己试试吧，这里[有](http://code.google.com/apis/ajax/playground/)很多示例。

附带说明一下，作为 Web 应用程序开发人员，您应该已经开始使用 javascript（请参阅James Bennett[的这篇非常古老但并不过时的帖子）。](http://www.b-list.org/weblog/2006/jul/02/django-and-ajax/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T02:10:51.543

我会用我将要尝试做的事情来回答我自己的问题。如果效果很好，那就更好了。

一些工作将只是标准 CRUD 类型的输入和操作。Django 通过继承 django.forms.Widget 并使用 media 属性，使这部分至少相当容易。

自从我问了这个问题后，我发现了 jQuery.forms，它可能对 90% 的其余部分有帮助，因为它使 ajax 更容易，即使不是很容易，也很有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T16:34:29.400

那么你的问题很模糊。您具体需要什么帮助？目前还不清楚。

我编写了一个与 Google Maps 集成的 PHP 应用程序，我刚刚将它移植到 Django。我的原始代码只是普通的旧 Javascript，但在移植到 Django 期间，我开始利用 jQuery，它将我必须写下的代码减少了一半。我的应用程序所做的只是允许站点用户在地图上放置他们的位置标记以及一条短消息和他们的头像。

没有任何细节，我可以推荐学习像 jQuery 这样的东西来帮助减少你必须编写的重复的 Javascript 代码。否则，它只是在操纵 Google Maps Javascript API，正如您所注意到的，我同意，它的文档非常好并且易​​于使用。

# sql-server - 按计划将 SQL Server 数据从一台服务器复制到另一台服务器

> ID：568157
> 
> 赞同：6
> 
> 时间：2009-02-20T03:20:00.230
> 
> 标签：sql-server, sql-server-2005, replication

我在不同的虚拟主机上有一对 SQL Server，我正在寻找一种方法来使用另一个服务器定期更新一个服务器。这就是我要找的东西：

1.  尽可能自动化 - 理想情况下，一旦设置完成，我无需参与。
2.  将多个数据库完全（包括任何架构更改）从一台服务器推送到另一台服务器
3.  在不破坏我的进程的情况下自由地允许源服务器上的更改。出于这个原因，我不想使用复制，因为每次源更新时我都必须打破它，然后重新创建发布和订阅
4.  一个数据库大小约为 4GB，包含二进制数据。我不确定是否有办法将其导出到脚本，但如果我这样做了，那将是一个庞大的文件。

最初，我正在考虑编写一些东西，对每个数据库进行预定的完整备份，完成后将备份从一台服务器 FTP 到另一台服务器，然后新服务器将其拾取并恢复。我能看到的唯一缺点是在开始传输之前无法知道备份是否已完成 - 这些备份可以同步完成吗？此外，正在刷新的服务器是我们的测试服务器，所以如果移动数据涉及一些停机时间，那很好。

有没有人有更好的主意，或者我目前正在考虑最好的非复制方式？谢谢大家的帮助。

**更新：** 我最终设计了一个自定义解决方案，使用 BAT 文件、7Zip、命令行 FTP 和 OSQL 完成此任务，因此它以完全自动的方式运行并聚合来自全国十几个服务器的数据。[我在博客条目中详细介绍了这些步骤](http://trycatchfinally.net/2009/09/moving-a-sql-server-database-to-another-server-on-a-schedule-without-using-replication/)。

感谢您的输入！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T03:45:05.507

这是 SSIS/DTS 的主要目的。我经常用 SSIS 来做这件事。如果您之前没有使用过 SSIS，那么[sqlis.com](http://www.sqlis.com/)是一个很好的起点（除非您使用的是 SQL2000，否则您将使用 DTS，在这种情况下，请从[sqldts.com](http://www.sqldts.com/)开始）。也有很多关于这个主题的好书。

但绝对值得您花时间研究学习 SSIS。阅读您的问题，SSIS 是迄今为止 IMO 最好的路线。您不需要编写一行代码，它具有内置的所有工具来完成这项工作。您也可以安排它按时间间隔运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T03:30:09.753

我会为此编写一个 .NET 控制台应用程序。进行备份就像打开 SQL 连接并执行“BACKUP DATABASE [] TO DISK = N'' 一样简单。然后使用内置的 .NET FTP 库将其推送到另一台服务器。您甚至可以使用[sharpziplib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)先压缩它。然后把它扔到一个计划任务中。

另一方面，设置一个 Windows 服务，它使用[FileSystemWatcher 监视](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)ftp 传输到的文件夹，然后在完成后恢复备份。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-20T12:50:46.703

我发现了一个开源工具，有些人可能会觉得它很有用，并且可以根据他们的需要进行修改。

[SQL Server 数据库复制工具](http://dbcopytool.codeplex.com/)
*“通过备份将 sql server 数据库从一台服务器复制到另一台服务器，将备份文件复制到目标服务器并还原数据库。”*

HTH 有人搜索此主题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T03:37:49.563

您可以通过分离每个数据库并复制 MDF/LDF 文件来获得更快的“备份” - 这确实意味着您的数据库在短时间内处于脱机状态。除此之外，我会同意克里斯的评论。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-23T16:05:03.490

使用复制数据库向导。- 右键单击​​源数据库 - 选择任务 - 复制数据库。

在指南中，您也可以选择为作业创建计划。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-03-26T13:48:11.983

使用导入和导出向导创建新表或附加到现有表。您还可以使用查询在向导中进行数据传输..

# c# - VS 2008 无法在 Windows 7 中打开项目

> ID：568164
> 
> 赞同：0
> 
> 时间：2009-02-20T03:23:00.317
> 
> 标签：c#, visual-studio, wcf, windows-7

我已经安装了 VS 2008 和 SP1。我尝试加载具有 WCF 项目的解决方案，但它抱怨“此安装不支持此项目类型”。

我试过 devenv.exe /setup 但这没有帮助。

如果重要的话，这一切都在 Windows 7 上。在 Windows Vista 安装上，我对相同的解决方案（也是 VS2008 w/sp1）没有任何问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T04:15:57.490

您最好在受支持的操作系统上使用 VS2008。Windows 7 处于测试阶段，您更有可能遇到问题......就像这个......

除非您的目标是在 Windows 7 上测试 VS2008，在这种情况下您想要做的就是联系 Microsoft 以向他们提供反馈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T03:27:03.967

所以，事实证明我在安装过程中做了一个相当愚蠢的操作，没有安装 Web Developer 部分，只安装了 C# 部分。一旦我安装了它，一切都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T13:08:02.940

[请在http://connect.microsoft.com/visualstudio/](http://connect.microsoft.com/visualstudio/)报告此问题。我敢肯定他们*真的*很想听听 Win7 的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T01:11:03.917

我每天在 Windows 7 上用 VS2008 开发，我还没有遇到这个问题。但是，我在 Vista 上安装了它，然后做了升级选项，所以这可能是部分原因。

# reporting-services - 升级 Reporting Services RLD 2005 --> 2008

> ID：568180
> 
> 赞同：1
> 
> 时间：2009-02-20T03:32:09.997
> 
> 标签：reporting-services, upgrade, ssrs-2008, rdl

我为我维护的一堆报告运行了解决方案转换，但少数（大约六个）未能转换。我设法手动转换了一些，但是有些不同，以至于很难手动更改 RDL。有没有更好的方法来修复这些报告？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2010-12-16T13:44:09.947

您是否尝试将这些文件打开到 SQL Server Business Intelligence Development Studio 并再次保存？

# windows - 如何向 Windows 询问系统托盘图标的大小？

> ID：568199
> 
> 赞同：9
> 
> 时间：2009-02-20T03:42:42.780
> 
> 标签：windows, winapi, taskbar, system-tray

我注意到我的应用程序将图标发送到大小为 16x16 像素的 Windows 托盘 - 而我的 Vista PC 我有一个双宽任务栏，似乎以 18x18 显示图标。我的应用程序图标上调整大小的工件看起来很糟糕。我如何询问 Windows 图标的大小？

编辑：

我正在动态生成图标，并带有像素字体文本覆盖。动态生成一堆图标大小似乎很浪费，因此最好避免构建具有所有“可能”大小的图标（我什至不确定它们是什么）。

GetSystemMetrics(SM_CXSMICON) 返回 16 - 不正确的值。

GetThemeBackgroundContentRect 也没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T04:07:53.767

Mark 的核心答案是正确的：创建多种格式的图标并让 Windows 选择正确的一种。不要忘记为 HighDPI 场景制作 32x32 和 64x64 图标。

但是 SM_CXICON/SM_CYICON 不一定会返回将在任务栏中使用的大小。任务栏为其大小选择正确的图标大小（这在 Window 7 中更为重要）*。*

只需提供适当大小的图标，就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T03:51:12.497

以多种格式创建您的图标，并让 Windows 选择它想要的一种。

[这是关于 .ico 格式的维基百科文章。](http://en.wikipedia.org/wiki/ICO_(icon_image_file_format))

如果你真的需要知道，带有 SM_CXICON 或 SM_CYICON 参数的[GetSystemMetrics](http://msdn.microsoft.com/en-us/library/ms724385(VS.85).aspx)会告诉你 Windows 想要加载的宽度和高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T05:26:09.630

您最好的选择可能是[GetThemeBackgroundContentRect](http://msdn.microsoft.com/en-us/library/bb773375(VS.85).aspx)`TBN_BACKGROUND`作为托盘通知背景的iPartId传递。

GetThemeBackgroundContentRect 应该返回由当前主题定义的大小，可用于绘制而不重叠父元素的边框。如果我没看错，那将是允许的最大尺寸通知图标，并且可能是正在使用的尺寸。

使用多个 DPI 设置进行测试可能是判断这是否返回正确值的最简单方法。

# visual-studio - 一个 MSI 用于两种不同的安装

> ID：568203
> 
> 赞同：3
> 
> 时间：2009-02-20T03:44:51.760
> 
> 标签：visual-studio, windows-installer

有没有办法创建 MSI，以便您可以通过重新运行将软件安装在两个不同的位置？我正在创建一个 MSI 来部署 Web 应用程序。我想构建一次 MSI（我正在使用 Web 设置项目），例如用于暂存，然后一旦构建合格，我想再次为另一个环境 (UAT) 运行相同的 MSI。然而，问题是我们为 STG 和 UAT 共享同一个网络服务器（在 IIS 上作为两个不同的网站运行）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T04:21:24.717

只要您不在同一台机器上使用相同的 MSI，一个 MSI，两个不同的安装位置是可行的。利用属性，特别是[公共](http://msdn.microsoft.com/en-us/library/aa370912(VS.85).aspx)和[目录](http://msdn.microsoft.com/en-us/library/aa372403(VS.85).aspx)属性，让您的 MSI 根据属性的设置方式执行条件操作。

如果您想使用同一台机器，我建议使用[WiX](http://wix.sourceforge.net/)来编写两个具有不同 ProductCode 和默认值的 MSI，但共享其他所有内容。WiX 让编译不同风格的 MSI 变得很容易，而且麻烦最少。

更新：看起来可能有一种方法可以使用一些转换来更改产品代码：

[http://msdn.microsoft.com/en-us/library/aa369523(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa369523(VS.85).aspx)

# c# - AS3 和 C# 的精益数据包协议？

> ID：568205
> 
> 赞同：1
> 
> 时间：2009-02-20T03:45:40.463
> 
> 标签：c#, actionscript-3, protocols, network-protocols

是否有在 actionscript 3 和 C# 中实现的精简（不是 xml 或 json）数据包协议？如果有一个已经有两种语言的实现，那就太好了。如果没有，我可能不得不编码一侧。话虽如此，找出（或查找）C# 的序列化规范的文档然后使用它是愚蠢/不安全的，所以我只需要制作一个 AS3 到 C# 对象编码器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T04:18:29.277

[协议缓冲区](http://code.google.com/p/protobuf/wiki/OtherLanguages)。

在 C# 中，protobuf-net 和 dotnet-protobufs 非常健壮。我没有亲自尝试过 AS 版本。

马克

# jquery - 如何使用 jQuery 获取其他图像

> ID：568207
> 
> 赞同：0
> 
> 时间：2009-02-20T03:46:23.303
> 
> 标签：jquery

我的 DOM 看起来像这样：

```
<div class="stuff">
  <a href="#"><img src=""></a> <b>hello</b>
  <a href="#"><img src=""></a>
</div> 
```

有时我在第一张图片上有参考，有时在第二张图片上有参考。

1.  当我使用 $() 获得第一张图像时，如何选择第二张图像？
2.  当我使用 $() 获得第二张图像时，如何选择第一张图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T04:12:14.677

`myImage`作为对其中一个图像的参考，应该给`$(".stuff img").not(myImage)`你另一个（或其他，如果你有两个以上的图像）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T04:16:32.667

在这两种情况下，您都可以通过以下方式获得另一个：

```
$(this).parent().siblings().children("img").remove(this); 
```

要不就：

```
$("div.stuff img").remove(this); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T04:19:00.993

看看[jQuery eq 选择器](http://docs.jquery.com/Selectors/eq)。

```
var first = $('.stuff img:eq(0)');
var second = $('.stuff img:eq(1)'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T04:09:41.547

1.  `.parent().nextAll("a").children("img")`
2.  `.parent().prevAll("a").children("img")`

这是一种相当不雅的方式来完成它，但它对于您要寻找的内容非常明确 - 几乎就像 XPath。一旦您开始处理两个以上的链接，您可能会发现像 Ben Alpert 或 cletus 所描述的技术更灵活（较少依赖于严格的层次结构）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-20T04:16:39.313

你应该能够使用类似的东西

```
$('DIV.stuff:first-child')
$('DIV.stuff:nth-child(3)' 
```

这将返回可用于访问图像的锚标记。第二个是 nth-child(3) 因为 nth-child(2) 将返回粗体标记。理想的方法是对每个图像或锚点应用一个类或 id。

# visual-c++ - 编译器错误 C2632：类型 1 后跟类型 2 是非法的

> ID：568212
> 
> 赞同：0
> 
> 时间：2009-02-20T03:49:12.797
> 
> 标签：visual-c++, types

我正在尝试学习需要包含头文件的 SDK。头文件中有两条语句说

```
typedef long long SomeIdentifier_SInt64; 
```

和

```
typedef unsigned long SomeIdentifier_UInt64; 
```

编译器（MSVC++ 6）抱怨这是非法的。如果是这样，这是否意味着 SDK 已损坏？我严重怀疑情况是否如此。这在其他编译器中合法吗？有没有办法解决？

谢谢。

我的环境是 MS Windows XP Pro 32 位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T04:00:49.133

VC6 太老太破，不知道“长长”。它将编译 __int64。VS200x 没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T04:24:35.473

您需要使用 2003 年 2 月版的 Platform SDK。

[http://blogs.msdn.com/mapo/archive/2007/06/07/last-platform-sdk-compatible-with-visual-studio-6-0.aspx](http://blogs.msdn.com/mapo/archive/2007/06/07/last-platform-sdk-compatible-with-visual-studio-6-0.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T04:10:54.943

MSVC6 是一个相当陈旧且蹩脚的编译器。他们的最新版本要好得多（很多），您可以在[他们的网站](http://www.microsoft.com/express/download/)上免费下载。

它确实支持`__int64`，`unsigned __int64`所以如果由于某种原因您不能使用最新版本，您可以搜索 SDK 标头并替换`long long`您找到的每个实例。

# nvelocity - NVelocity 是否不再支持字符串模板？

> ID：568215
> 
> 赞同：5
> 
> 时间：2009-02-20T03:51:01.170
> 
> 标签：nvelocity

我们在用于电子邮件的嵌入式资源中有一堆 NVelocity 模板。我们希望将这些模板移动到数据库中，以便用户可以轻松配置它们。

似乎 NVelocity (Castle port) 不支持字符串作为模板。有谁知道该怎么做。

需要明确的是，这是我想要做的（语法可能不准确，我正在记忆中）......

```
string templateString = "Hello $!user";
Template template = new Template(templateString);
string results = template.Merge(....); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-18T13:52:49.643

这对我有用：

```
using System.Collections;
using System.IO;
using NUnit.Framework;
using NVelocity;
using NVelocity.App;

[Test]
public void StringParsing()
{
    var h = new Hashtable {
        { "foo", "Template" },
        { "bar", "is working" },
        { "foobar", new[] { "1", "2", "3" } } };
    Velocity.Init();
    var c = new VelocityContext( h );
    var s = new StringWriter();
    Velocity.Evaluate( c, s, "",
        "$foo $bar: #foreach ($i in $foobar)$i#end" );
    Assert.AreEqual( "Template is working: 123", s.ToString() );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T01:11:37.230

经过我自己的大量研究，NVelocity 的城堡端口似乎从内存字符串中获取模板将是一个巨大的 PITA。

我已经放弃了 NVelocity 并开始使用 StringTemplate。特别是这个实现：[http ://websitelogic.net/articles/MVC/stringtemplate-viewengine-asp-net-mvc/](http://websitelogic.net/articles/MVC/stringtemplate-viewengine-asp-net-mvc/)

# c++ - 如何在双变量中划分两个整数？

> ID：568218
> 
> 赞同：2
> 
> 时间：2009-02-20T03:51:57.983
> 
> 标签：c++

我正在为学校设计一个实验室，该实验室运行 10 条 10000 5 张牌手的轨迹。我必须在每手牌中找到同花和对子。我必须找到每条线索的对子和同花的百分比。

我的问题是，例如，当我尝试获取一对单轨的百分比时

```
double percent =  total_pairs/10000; 
```

或者

```
double percent = 5600/10000; 
```

当我想打印出 2 个小数位时，我的输出变为 0 我得到以下信息

```
0.00 
```

使用此代码

```
cout<<setiosflags(ios::fixed | ios::showpoint);
cout<<setprecision(2)<<percent<<endl; 
```

但我仍然得到零当我像这样投射它时得到实际数字

```
double percent = (double) 5600/10000; 
```

这是正确的，因为我不希望它截断我的输出或者我错过了什么

希望你能理解我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T03:58:14.037

是的，就是这样，下面进行整数除法。然后将结果 (0) 转换为双精度。

```
double percent = 5600/10000 
```

下面的行将 5600 强制为双精度，因此现在您有了双精度的实际除法

```
double percent = (double) 5600/10000 
```

如果您的数字之一是常数，您可以确保使用十进制格式来强制浮点除法：

```
double percent = 5600.0/10000 
```

我有时使用的另一个技巧是乘以 1.0，它将后面的内容转换为双精度数：

```
double percent = 1.0 * inta / intb 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-20T03:55:51.813

“total_pairs”是一个整数吗？如果是这样，则除以整数除法。您需要将其中一个数字显式转换为双精度数（另一个将自动提升为双精度数）：

```
double percent = ((double)total_pairs)/10000; // or just simply 10000.0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T03:57:32.027

将整数除以 C 和 C++ 中的整数（我不确定相应操作的正确英文单词，但 10/4 给您 2 等……这是除法的整数部分）。所以以下内容：

```
double a = 1000 / 10000; 
```

首先以 int 形式计算 1000 / 10000（在本例中为 0），然后将其转换为 double。

转换参数是一种方法 - 我更喜欢自己输入浮点数而不是整数，但这是个人喜好：

```
double a = 1000\. / 10000.; 
```

（只需一个就足够了：即 1000 / 10000。也可以）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-20T04:02:30.813

您的代码的问题：

```
double percent = (double) 5600/10000; 
```

您是否假设类型转换适用于 5600。事实并非如此。实际发生的是除法完成（并被截断，因为两个数字都是整数），然后最终结果被强制转换为双精度数。所以，你得到截断的结果。上面的代码等价于：

```
double percent = (double) (5600/10000); 
```

要使除法发挥作用，您需要的是分子（第一个数字）是双精度数。您可以通过将演员表括在括号中来做到这一点

```
double percent = ((double) 5600)/10000; 
```

如果分子实际上是一个变量，这会更有用。或者，如果您正在处理数字常量，您可以在数字的末尾放一个小数位。

```
double percent = 5600.0/10000; 
```

# mysql - 在 MySQL 中查找中位数和计数的复杂性是什么？

> ID：568220
> 
> 赞同：1
> 
> 时间：2009-02-20T03:53:57.870
> 
> 标签：mysql, rdbms

我想知道以下两个操作的复杂性是什么。第一种情况是计数，我按我有索引的列排序，并询问低于或高于某个数字的所有值的计数，如下所示：

```
SELECT count(*) FROM tbl WHERE col1 > 10 ORDER BY col1; 
```

另一种情况是关于中位数操作。中位数是指找到 (int)n/2 的行值，其中 n 是表中的行数。这方面的一个例子可能如下（再次在 col1 上有一个索引）：

```
SELECT median(col1) FROM tbl ORDER BY col1; 
```

这些案例中最坏的案例复杂度是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T04:03:37.347

这些`ORDER BY`条款是不必要的 - 或令人困惑的，或两者兼而有之。

`SELECT COUNT(*)`将返回一行（通常）。因为你有一个搜索条件，优化器可能必须对 col1 进行索引扫描（如果有一个索引以 col1 作为索引的前导列），或者进行表扫描。这是一个 O(N) 操作，其中 N 是表中的行数。

`SELECT MEDIAN(col1)`还将返回一行（通常）。这将是一个 O(N) 操作，再次使用索引扫描或表扫描。

'normally' 限定词在那里，因为我不确定优化器将如何处理这些`ORDER BY`子句。一种可能性是优化器将确定它是多余的并忽略它。另一种可能性是它会以某种方式将`col1`您添加`ORDER BY`到投影列中，将其包含在其他操作中，然后在返回结果之前将其删除。但是，这会在没有子句的情况下混合聚合和非聚合`GROUP BY`- 所以我认为优化器会忽略它，或者拒绝查询。但是，我还没有用 MySQL 做过实验。

FWIW，IBM Informix Dynamic Server (IDS) 产生错误 -19828：ORDER BY 列或表达式必须在此上下文中的 SELECT 列表中。

如果没有 ORDER BY 子句，上面的分析就足够准确了。请注意，对于没有条件的 SELECT COUNT(*)，服务器通常可以使用它保留的有关表的元数据在 O(1) 时间内回答查询。

# java - 如何在不使用 JNI 的情况下对 Java 中的本机操作系统进行身份验证？

> ID：568227
> 
> 赞同：3
> 
> 时间：2009-02-20T03:56:09.520
> 
> 标签：java, authentication

我的 Java RCP 应用程序在启动时提示用户输入用户名和密码。如何在不使用 JNI 移植某些 C 库的情况下使用这些凭据对本机操作系统进行身份验证？谢谢！

PS。如果可能，不使用第三方库的纯 Java 实现将是非常可取的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T04:45:16.953

AFAIK，如果不以某种方式涉及对 Java 的本机扩展，这是不可能的——没有用于此的 Java API。

你可以看看[JNA 项目](https://github.com/twall/jna/)。它使用本机代码，但您不必编写任何代码 - 它为您完成。

* * *

编辑：如果您想要做的只是*验证*用户名/密码，那么我相信 JNDI/LDAP 方向可能对您有用 - 我之前在 Java 的 AS/400 上做过这个，尽管我并不完全满意最终结果。

如果您想让 O/S 将您的 JVM 进程识别为特定用户的凭据，您将需要某种形式的访问不可移植的本机 API。

顺便说一句，我们在谈论什么 O/S(s)。

* * *

EDIT2：我将发布我如何使用 LDAP 验证用户名/密码的片段，如果这就是你所追求的；这些是直接从我的代码中提取的，不打算直接编译。

这是我写的第一个 Java 代码，请见谅：

```
import java.security.*;
import java.util.*;

import javax.naming.*;
import javax.naming.directory.*;
import javax.naming.ldap.*;

...

private Hashtable                       masterEnv;          // master environment settings
private String                          authMethod;         // default authentication method

...

public void init() {
    // NOTE: Important to use a non-pooled context and a clone of the environment so that this authenticated
    //       connection is not returned to the pool and used for other operations
    masterEnv=new Hashtable();
    masterEnv.put(Context.INITIAL_CONTEXT_FACTORY,ldapFactory);
    masterEnv.put(Context.PROVIDER_URL,providerUrl);
    masterEnv.put(Context.SECURITY_PROTOCOL,secProtocol);
    masterEnv.put(Context.REFERRAL,"follow");
    masterEnv.put("com.sun.jndi.ldap.connect.pool","false");

    authMethod=System.getProperty("authenticationMethod","simple");
    }

...

private void verifyUserPassword(String ui, String pw, String am) throws NameNotFoundException, AuthenticationException, AuthenticationNotSupportedException, NamingException, NamingException {
    // ui=user ID
    // pw=password
    // am=authentication method

    DirContext      lc=null;                                // ldap context object
    Hashtable       le;                                     // ldap environment object

    if(am.length()==0) { am=authMethod; }

    le=(Hashtable)masterEnv.clone();
    le.put(Context.SECURITY_AUTHENTICATION,am);
    le.put(Context.SECURITY_PRINCIPAL     ,ui);
    le.put(Context.SECURITY_CREDENTIALS   ,pw);
    lc=new InitialDirContext(le);
    lc.close();
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T04:59:48.337

您可以使用 JNDI 和 LDAP 进行验证（假设您使用 LDAP/Active Directory 进行验证）。查看[此线程](http://forums.sun.com/thread.jspa?threadID=581444)以获取有关如何执行此操作的更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-16T08:57:45.883

这个例子[http://spnego.sourceforge.net/pre_flight.html](http://spnego.sourceforge.net/pre_flight.html)讨论了一个 HelloKDC.java 程序，它唯一要做的就是验证用户名和密码。

# python - pycurl 失败，但 curl（来自 bash）在 ubuntu 中工作

> ID：568247
> 
> 赞同：3
> 
> 时间：2009-02-20T04:07:39.587
> 
> 标签：python, ssl, curl, https, pycurl

我正在使用 curl 和 pycurl 连接到安全的 3rd 方 api，当我使用 pycurl 时，我从服务器收到身份验证错误，但是当我在命令行上使用 curl 并执行相同的操作时，它可以工作。我将两者都设置为详细模式并且看到请求中有一些差异，但我似乎无法弄清楚错误是什么。

他们似乎使用了不同的加密方法，也许这就是问题所在？如果有人对尝试使用 pycurl 的不同选项有想法或建议重新编译 pycurl 以像 curl 一样工作，那就太棒了。谢谢。

这是我的 pycurl 设置，仅供参考：

```
 buffer = cStringIO.StringIO()

    curl = pycurl.Curl()
    curl.setopt(pycurl.VERBOSE,1) 
    curl.setopt(pycurl.POST, 1)
    curl.setopt(pycurl.POSTFIELDS, post_data)
    curl.setopt(pycurl.TIMEOUT_MS, self.HTTP_TIMEOUT)
    curl.setopt(pycurl.URL, url)
    curl.setopt(pycurl.FOLLOWLOCATION, self.HTTP_FOLLOW_REDIRECTS)
    curl.setopt(pycurl.MAXREDIRS, self.HTTP_MAX_REDIRECTS)
    curl.setopt(pycurl.WRITEFUNCTION, buffer.write)
    curl.setopt(pycurl.NOSIGNAL, 1)
    curl.setopt(pycurl.SSLCERT, self.path_to_ssl_cert)

    curl.setopt(pycurl.SSL_VERIFYPEER, 0)

    # 1/0

    try:
        curl.perform() 
```

...

哦，最后一件事：我使用的相同 python 脚本在我的 Mac 笔记本电脑上工作，但在我试图设置的 ubuntu 服务器上不起作用。

```
python test.py 
18:09:13,299 root INFO fetching: https://secure.....
* About to connect() to secure.... 1129 (#0)
*   Trying 216....... * connected
* Connected to secure.... port 1129 (#0)
* found 102 certificates in /etc/ssl/certs/ca-certificates.crt
*        server certificate verification OK
*        common name: secure.... (matched)
*        server certificate expiration date OK
*        server certificate activation date OK
*        certificate public key: RSA
*        certificate version: #3
*        subject: .......
*        start date: Sat, 14 Feb 2009 22:45:27 GMT
*        expire date: Mon, 15 Feb 2010 22:45:27 GMT
*        issuer: ...
*        compression: NULL
*        cipher: AES 128 CBC
*        MAC: SHA
User-Agent: PycURL/7.16.4
Host: secure....
Accept: */*
Content-Length: 387
Content-Type: application/x-www-form-urlencoded

< HTTP/1.1 200 OK
< Content-Length: 291
< 
* Connection #0 to host secure.... left intact
* Closing connection #0

 curl -v -d '...' --cert cert.pem  https://secure....
* About to connect() to secure.... port 1129 (#0)
*   Trying 216....... connected
* Connected to secure.... port 1129 (#0)
* successfully set certificate verify locations:
*   CAfile: /etc/ssl/certs/ca-certificates.crt
  CApath: none
* SSLv2, Client hello (1):
* SSLv3, TLS handshake, Server hello (2):
* SSLv3, TLS handshake, CERT (11):
* SSLv3, TLS handshake, Request CERT (13):
* SSLv3, TLS handshake, Server finished (14):
* SSLv3, TLS handshake, CERT (11):
* SSLv3, TLS handshake, Client key exchange (16):
* SSLv3, TLS handshake, CERT verify (15):
* SSLv3, TLS change cipher, Client hello (1):
* SSLv3, TLS handshake, Finished (20):
* SSLv3, TLS change cipher, Client hello (1):
* SSLv3, TLS handshake, Finished (20):
* SSL connection using AES256-SHA
* Server certificate:
*        subject: .......
*        start date: 2009-02-14 22:45:27 GMT
*        expire date: 2010-02-15 22:45:27 GMT
*        common name: secure.... (matched)
*        issuer: ... Certificate Authority
* SSL certificate verify ok.
> User-Agent: curl/7.16.4 (i486-pc-linux-gnu) libcurl/7.16.4 OpenSSL/0.9.8e zlib/1.2.3.3 libidn/1.0
> Host: secure....:1129
> Accept: */*
> Content-Length: 387
> Content-Type: application/x-www-form-urlencoded
> 
< HTTP/1.1 200 OK
< Content-Length: 342 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-17T20:03:38.037

Ubuntu pycurl 使用 GnuTLS，而 ubuntu curl 命令行使用 OpenSSL。支持的证书格式等方面存在差异。

我无法理解 ubuntu 开发人员/打包人员做出的这一决定。我偶然发现了一次并且无法解决它，幸运的是，除了 ubuntu 之外还有其他发行版 :-)

您总是可以尝试向“人性对他人”抱怨。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T10:27:04.023

我在理解您发布的代码/输出片段时遇到了一些麻烦。是否包含实际的错误消息？

SSL/TLS 的问题通常是因为 X.509 证书基础结构。有像 Verisign、RapidSSL 等“证书颁发机构”（CA），它们对服务器的证书进行数字“签名”。要检查这些签名，您需要 CA 的所谓“根证书”，该 CA 签署了您要连接的服务器（“颁发者”）的证书。

通常操作系统会预装大量的证书。通常浏览器、操作系统和某些库都有自己的证书列表。在 Mac 上，您可以看到它们，如果您启动程序“Keychain Access”并打开“System Roots”钥匙串。

因此，我建议您检查 Ubuntu 中是否缺少证书，如果是，则将其添加到那里。（也许这些都保存在 /etc/ssl/certs/ 中）

# sql - 有没有办法选择引用游标的内容作为 SQL Select 语句的一部分？

> ID：568251
> 
> 赞同：1
> 
> 时间：2009-02-20T04:10:38.423
> 
> 标签：sql, oracle

我希望能够获取一个引用光标并通过从中选择另一个引用光标来转换它。例如，像这样：

```
begin
declare c_cur sys_refcursor;
        c_cur2 sys_refcursor;

open c_cur for 
  select 1 from dual;

open c_cur2 for
  select 1
    from c_cur
   where 1 = 2;

end;
/ 
```

Oracle 是否可以在 SELECT 语句中从引用游标的结果中选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T05:13:23.670

您无法在此处完全按照您的意愿进行操作，但以下内容可能适合您的需求。基本上两个游标循环，其中一个从第一个游标中获取数据。

```
declare

cursor my_cur_1 is
select foo from bar;

cursor my_cur_2 (my_foo bar.foo%TYPE) is
select foo2 from bar2 where bar2.foo = my_foo;

begin

for t in my_cur_1 LOOP

  for s in my_cur_2(t.foo) LOOP
  -- do some stuff here with data from both.
  end loop;
end loop;

end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T08:30:15.460

看起来您只想动态构建一个 ref_cursor 。

你可以这样做：

```
FUNCTION test_dyn_ref RETURN sys_refcursor IS
  l_cur2  sys_refcursor;
  l_query varchar2(4000);
begin
  l_query := 'select 1 from dual ';
  l_query := l_query||' where 1 = 2 ';
  --
  open l_cur2 for l_query;
  return l_cur2;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T05:14:47.053

我不知道你为什么想要。我认为您正在寻找更多类似于[bulk collect](http://www.oracle.com/technology/oramag/oracle/08-mar/o28plsql.html)的东西。这将允许您将结果提取到集合或表中，然后您可以从第二个查询中的结果中进行选择。更好的是，将其重构为一个更优雅的查询。

# sql - 为什么我会收到此 SQL/DB 错误？

> ID：568263
> 
> 赞同：5
> 
> 时间：2009-02-20T04:17:26.083
> 
> 标签：sql, db2

我正在尝试使用 DB2 运行一个简单的 SQL 语句，但遇到了一些问题。我想在 txt/db2 文件中有一个脚本，并让引擎处理所有命令

这是脚本：

```
CONNECT TO MYDB

CREATE TABLE PERSONS(
     PID SMALLINT NOT NULL,
     NAME VARCHAR(20) NOT NULL
)

TERMINATE 
```

当我运行 db2 -f /pathtofile 我得到：

```
SQL0104N  An unexpected token "(" was found following "CREATE TABLE PERSONS".  
Expected tokens may include:  "END-OF-STATEMENT".  SQLSTATE=42601 
```

我究竟做错了什么？我的脚本有问题吗？另外，为什么没有“;” 我的陈述结束时的终结者？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T05:43:37.467

可能这会有所帮助，
[http](http://www.uc.edu/R/r25/documentation/Version3.2/install_instructions.pdf) ://www.uc.edu/R/r25/documentation/Version3.2/install_instructions.pdf ：

> 脚本使用分号 (;) 来终止每个 SQL 命令。如果您使用 DB2 命令行处理器，您应该记住使用“-t”标志。
> ...
> 如果不使用 -t 标志，则
> 在运行 db2ct32.sql 脚本时会出现如下错误：
> create table “ACCOUNTS” (
> DB21034E 该命令被作为 SQL 语句处理，因为它不是
> 有效的命令行处理器命令。在 SQL 处理期间它返回：
> SQL0104N 在“吃表”帐户“之后发现了一个意外的标记“（”。
> 预期的标记可能包括：“END-OF-STATEMENT”。SQLSTATE=42601

所以，我会添加分号并使用 -t switch 调用它所代表的任何废话。
我查看了样本，他们使用类似的东西

```
db2 -tf "pathtofile" 
```

还与

```
db2 -tvf "pathtofile" 
```

你可能会得到更多的诊断。
不要将专有软件推到极限，它们并没有那么宽。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T04:27:10.897

姓名行后面有一个逗号

改变：

```
NAME VARCHAR(20) NOT NULL, 
```

到：

```
NAME VARCHAR(20) NOT NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T06:01:24.663

如果我包含分号并使用 -t 标志，我会得到：

```
SQL0104N  An unexpected token "/" was found following "BEGIN-OF-STATEMENT".  
Expected tokens may include:  "<values>".  SQLSTATE=42601 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T05:10:19.030

为了安全起见，我会在 CREATE TABLE PERSONS 和 ( 之间插入一个空格或行分隔符
。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-11T14:21:27.513

以下不带空格的语法可在命令行上正常工作，

`CREATE TABLE PERSONS (PID SMALLINT NOT NULL, NAME VARCHAR(20) NOT NULL)`

用这个格式化文件，而不是段落样式适合我在这里的作业 - [http://www.eecs.yorku.ca/course_archive/2016-17/F/3421/project/create/yrb-create.txt](http://www.eecs.yorku.ca/course_archive/2016-17/F/3421/project/create/yrb-create.txt)

# c# - C# 用于嵌入式系统？

> ID：568266
> 
> 赞同：19
> 
> 时间：2009-02-20T04:20:11.753
> 
> 标签：c#, embedded

> “C# 旨在适用于为托管系统和嵌入式系统编写应用程序，从使用复杂操作系统的大型系统到具有专用功能的非常小的系统。” [-- 设计目标（维基百科）](http://en.wikipedia.org/wiki/C_Sharp_(programming_language)#Design_goals)

虽然很大程度上取决于嵌入是如何“嵌入”的，

您认为 C# 实现这一目标的程度如何？

你认为 C# 是否与 C/C++ 一样好，如果不是更好的工具吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-20T04:27:29.960

嗯，有[微框架](http://en.wikipedia.org/wiki/.NET_Micro_Framework)；我没有听到很多关于它的噪音，但我不喜欢“嵌入式”。但这取决于它在做什么...... C# 是一种很好的通用语言，但仍然有一些时候需要一些硬核（并挂起代码复杂性）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-20T04:29:58.313

有许多商业上成功的软件应用程序是用 C# 和 WinCE 平台编写的。例如，一些机顶盒（来自 AT&T 等）在 .net CF 上运行 C# 代码。鉴于这些盒子有 64 或 128 MB 内存，我认为嵌入式 C# 已足够嵌入。

重点是硬件加速和其他编译器的进步，像 C# 这样的 JITed 语言能够很好地工作。

最大的优势是使用最新的 Visual Studio，您可以从 VS**调试设备。**至少对于开发环境来说，现在没有什么比这更好的了。

注意：在平台方面，WinCE/WinMobile 有很多竞争对手，每个都有自己的优势。在上面我只谈论开发环境的优势。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T04:33:19.010

如您所知，如果您想在 C# 中针对它编写代码，则需要有一个嵌入式 .net 迷你运行时。你可以说，比如 Win CE。

我希望我们很快就会在市场上推出低成本的.NET mini-mini 嵌入式芯片，或者它们已经上市了吗？对这个消息有点兴趣

[http://www.windowsfordevices.com/news/NS4666205829.html](http://www.windowsfordevices.com/news/NS4666205829.html)

> 微软后院的一家小型初创公司正准备开始运送一个微型 32 针芯片状计算机模块，该模块运行“.NET Embedded”，这是一种新的微软嵌入式软件平台，用于手表和其他“智能个人物品”。该模块由初创公司 .netcpu Corp. 开发，整合了微软的智能个人对象技术 (SPOT) 硬件和软件的一部分。

但是，这对您来说很有趣。看看 COSMOS 项目。它可以将您的 IL 代码转换为各种平台（并有望在未来转换为嵌入式架构）

[http://www.gocosmos.org/index.en.aspx](http://www.gocosmos.org/index.en.aspx)

> Cosmos 包括一个编译器（IL2CPU，它是 Cosmos 的一部分），它读取输入文件（通常是 shell）和 Cosmos 库，并将生成的 IL 编译为 x86 代码。IL2CPU 有一个跨平台层，我们计划支持其他处理器和平台，包括 x64。IL2CPU 还支持某些扩展方法，允许 C# 代码直接与内核中的 CPU、寄存器和端口进行交互。IL2CPU 包含一些内联汇编程序，但没有需要链接的 ASM 文件。
> 
> 目前 IL2CPU 首先输出原始 asm 文件（带有 IL 注释），然后通过 nasm（一个免费的汇编程序）处理它们。稍后我们计划直接发射到二进制文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-24T03:17:40.590

您可以查看 Netduino。它是 .Net Micro Framework 在使用 C# 的 ARM 32 位微控制器上的应用程序。它在 netduino.com 或这个视频[http://www.youtube.com/watch?v=UN-JXHHlgcY](http://www.youtube.com/watch?v=UN-JXHHlgcY)上。

由于 C# 使用框架或虚拟机作为其 C# 代码和机器代码之间的中间体，我预计它会比使用 C 或 C++ 运行得更慢。但是在速度不是那么重要并且交付是即时的应用中，这绝对是相当可观的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-04-24T08:36:40.700

不使用 WinCE 或 Windows Embedded 的嵌入式系统上的 C# 需要 .NET Micro，因此实际上“托管和嵌入式”之间没有区别，因为无论如何它都需要*托管*。那就是它*是*托管的，并且*可以*嵌入，因此“托管*或*嵌入”是没有意义的。

目前 .NET Micro 的内存占用为 300Kb，仅在 ARM 和 Blackfin 上受支持，因此不适合或过于昂贵，无法用于大量嵌入式应用程序。此外，虽然它支持多线程，但它不具备实时能力，因此不适合另一大块应用程序。

几年前，微软在英国嵌入式系统展上举办了一次免费会议，推出了当时新的 .NET Micro；在问答环节中，当我问到关于实时支持的问题，得到的答案是“*不，这不是实时的*。”时，观众听到了一阵呻吟声，一个号码起身离开，浪费时间。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-06T07:57:07.387

我将 C# 用于我的一些嵌入式应用程序，它在 72MHz ARM 芯片上运行得足够快，足以满足我的目的（小型 Web 服务器等）。此外，.NET 微框架带有许多可以修剪的额外库。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-01T00:50:11.890

嵌入式系统通常具有实时要求。满足那些使用垃圾收集语言的人可能会很*有趣。*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T04:51:40.587

有趣的是创建一个“编译器”，将 .Net Micro Framework 程序集转换为原生嵌入式程序集语言。但是，它必须将内存管理调用注入方法中。或者，您可以使用伪方法，例如 System.Memory.Delete()，而不是尝试“猜测”它们的去向，并将其用作在此处插入删除的标志。

尝试使用 Phoenix 框架将是一件有趣的事情；我可能会在下个假期尝试一下。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-20T04:57:00.980

检查 .net 微框架[http://www.microsoft.com/netmf/default.mspx](http://www.microsoft.com/netmf/default.mspx)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-20T06:41:17.297

我很难相信 c# 永远是嵌入式系统的最佳选择，至少就目前可用的处理能力而言。C# 通常针对 MSIL/CIL 而不是合适的机器语言。从 c# 获取特定处理器的机器代码是可行的，但不太可能非常有效。最好的选择：坚持使用更接近硬件的语言（c、c++、非托管），尽管缺乏内置的内存管理（尽管它是非确定性的）并且可用库的范围有限。在嵌入式中，精简和透明是最好的选择，恕我直言。

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2012-04-06T22:11:48.577

对于嵌入式设备，c# 永远不会像 c/c++ 那样好，因为它是托管代码并在 .net 框架内运行。就虚拟机而言，java 远远优于 .NET，这就是为什么数十亿嵌入式设备在 Java 上运行的原因……而在 .NET 上运行的却很少。简而言之，微软让人们在嵌入式设备中使用 c# 并没有商业利益。为这些设备编程的人永远不会购买他们的 Visual Studio IDE..那为什么还要麻烦呢？

# html - Usemap 在 Firefox 中不起作用

> ID：568267
> 
> 赞同：0
> 
> 时间：2009-02-20T04:20:35.327
> 
> 标签：html

我有以下 HTML 文本来显示包含链接的图像：

```
<img src="header.gif" alt="" width="900" height="47" usemap="#logoMap"/>
   <map name="logoMap">
     <area shape="Home" coords="795, 16, 870, 30" href="abc.htm"/>
   </map> 
```

问题是 usemap**在 Firefox 中不起作用**。它在 IE 7.0 中运行良好。我的图像尺寸为 900 X 47。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T04:42:43.307

在您的区域标签中，您有“家”，它不是有效的形状。尝试“正确”。这应该够了吧。

```
<img src="header.gif" alt="" width="900" height="47" usemap="#logoMap"/>
   <map name="logoMap">
     <area shape="rect" coords="795, 16, 870, 30" href="abc.htm"/>
</map> 
```

# dll - 在安装过程中对某些 dll 进行有条件的注册。（模糊的）

> ID：568268
> 
> 赞同：0
> 
> 时间：2009-02-20T04:21:01.363
> 
> 标签：dll, installation, compilation, registration

我有一个在某些情况下会使用设备（即打印机）的应用程序。基本上，在一个办公室将使用这台打印机，而在另一个办公室将永远不会使用这台打印机。

使用打印机的功能位于应用程序代码中，与打印机通信的 dll 在代码中被引用。所以 dll 是安装 .msi 包的一部分。

但是，如果先决条件（打印机的一堆驱动程序，由制造商作为单个安装 exe 提供）未安装，则无法在安装过程中注册这些 dll。驱动程序的安装程序大小约为 50M。

我不想在永远不会使用打印机的办公室的安装包中包含额外的 50M 文件。该问题的可能解决方法是什么？

最终，我希望有一个选项可以在安装过程中以某种方式跳过这些 dll 的注册。但我不知道如何解决这个问题。

我想我可以在代码中进行条件编译。但这需要大量工作才能将与此类打印机通信的代码与其他应用程序代码完全分开。

任何可能的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T04:45:14.753

将有条件地安装/注册组件的 DLL 分组。然后在您的 MSI 的[Component](http://msdn.microsoft.com/en-us/library/aa368007.aspx)表中，使用 Condition 列来依赖要设置的属性。在 MSI 的[定位器表](http://msdn.microsoft.com/en-us/library/aa369773(VS.85).aspx)中，配置行以查找先决条件并设置属性。

您可以通过阅读了解更多信息：

[http://msdn.microsoft.com/en-us/library/aa371564(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa371564(VS.85).aspx)

# python - 如何检查Python中是否存在具有给定pid的进程？

> ID：568271
> 
> 赞同：122
> 
> 时间：2009-02-20T04:22:43.480
> 
> 标签：python, process, pid

有没有办法检查 pid 是否对应于有效进程？我从不同于 from 的其他来源获取 pid `os.getpid()`，我需要检查机器上是否不存在具有该 pid 的进程。

我需要它在 Unix 和 Windows 中可用。我还在检查 PID 是否未在使用中。

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2009-02-20T04:31:14.083

如果 pid 未运行，则向 pid 发送信号 0 将引发 OSError 异常，否则不执行任何操作。

```
import os

def check_pid(pid):        
    """ Check For the existence of a unix pid. """
    try:
        os.kill(pid, 0)
    except OSError:
        return False
    else:
        return True 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2013-07-12T19:16:25.830

看一下[`psutil`](https://pypi.python.org/pypi/psutil)模块：

> **psutil**（python 系统和进程实用程序）是一个跨平台库，用于在 Python 中检索有关**正在运行的进程**和**系统利用率**（CPU、内存、磁盘、网络）的信息。[...] 它目前支持**32 位**和**64 位**架构的**Linux**、**Windows**、**OSX**、**FreeBSD**和**Sun Solaris**， Python 版本从**2.6 到 3.4**（Python 2.4 和 2.5 的用户可以使用 2.1.3 版本） . PyPy 也可以工作。

 ******它有一个名为的函数`pid_exists()`，您可以使用它来检查具有给定 pid 的进程是否存在。

这是一个例子：

```
import psutil
pid = 12345
if psutil.pid_exists(pid):
    print("a process with pid %d exists" % pid)
else:
    print("a process with pid %d does not exist" % pid) 
```

以供参考：

*   [https://pypi.python.org/pypi/psutil](https://pypi.python.org/pypi/psutil)
*   [https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil)
*   [http://pythonhosted.org/psutil/#psutil.pid_exists](http://pythonhosted.org/psutil/#psutil.pid_exists)

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2011-08-04T11:08:51.197

mluebke 代码不是 100% 正确的；kill() 也可以引发 EPERM（拒绝访问），在这种情况下，这显然意味着存在进程。这应该有效：

（根据 Jason R. Coombs 的评论编辑）

```
import errno
import os

def pid_exists(pid):
    """Check whether pid exists in the current process table.
    UNIX only.
    """
    if pid < 0:
        return False
    if pid == 0:
        # According to "man 2 kill" PID 0 refers to every process
        # in the process group of the calling process.
        # On certain systems 0 is a valid PID but we have no way
        # to know that in a portable fashion.
        raise ValueError('invalid PID 0')
    try:
        os.kill(pid, 0)
    except OSError as err:
        if err.errno == errno.ESRCH:
            # ESRCH == No such process
            return False
        elif err.errno == errno.EPERM:
            # EPERM clearly means there's a process to deny access to
            return True
        else:
            # According to "man 2 kill" possible error values are
            # (EINVAL, EPERM, ESRCH)
            raise
    else:
        return True 
```

除非您使用 pywin32、ctypes 或 C 扩展模块，否则您无法在 Windows 上执行此操作。如果您可以依赖外部库，则可以使用[psutil](https://github.com/giampaolo/psutil)：

```
>>> import psutil
>>> psutil.pid_exists(2353)
True 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-01-25T12:33:38.887

**仅当相关进程归运行测试的用户所有时，**涉及向进程发送“信号 0”的答案才有效。否则你会得到一个`OSError`由于*权限*，即使系统中存在 pid。

为了绕过此限制，您可以检查是否`/proc/<pid>`存在：

```
import os

def is_running(pid):
    if os.path.isdir('/proc/{}'.format(pid)):
        return True
    return False 
```

显然，这仅适用于基于 linux 的系统。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-11-25T07:05:53.367

在 Python 3.3+ 中，您可以使用异常名称而不是 errno 常量。[正版](http://pubs.opengroup.org/onlinepubs/9699919799/functions/kill.html)：

```
import os

def pid_exists(pid): 
    if pid < 0: return False #NOTE: pid == 0 returns True
    try:
        os.kill(pid, 0) 
    except ProcessLookupError: # errno.ESRCH
        return False # No such process
    except PermissionError: # errno.EPERM
        return True # Operation not permitted (i.e., process exists)
    else:
        return True # no error, we can send a signal to the process 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-20T07:20:11.260

[在此处](http://mail.python.org/pipermail/python-win32/2003-December/001482.html)查找特定于 Windows 的获取运行进程及其 ID 的完整列表的方法。会是这样的

```
from win32com.client import GetObject
def get_proclist():
    WMI = GetObject('winmgmts:')
    processes = WMI.InstancesOf('Win32_Process')
    return [process.Properties_('ProcessID').Value for process in processes] 
```

然后，您可以根据此列表验证您获得的 pid。我不知道性能成本，所以如果您要经常进行 pid 验证，最好检查一下。

对于 *NIx，只需使用 mluebke 的解决方案。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-05-01T14:06:04.710

在 ntrrgc 的基础上，我增强了 windows 版本，因此它检查进程退出代码并检查权限：

```
def pid_exists(pid):
    """Check whether pid exists in the current process table."""
    if os.name == 'posix':
        import errno
        if pid < 0:
            return False
        try:
            os.kill(pid, 0)
        except OSError as e:
            return e.errno == errno.EPERM
        else:
            return True
    else:
        import ctypes
        kernel32 = ctypes.windll.kernel32
        HANDLE = ctypes.c_void_p
        DWORD = ctypes.c_ulong
        LPDWORD = ctypes.POINTER(DWORD)
        class ExitCodeProcess(ctypes.Structure):
            _fields_ = [ ('hProcess', HANDLE),
                ('lpExitCode', LPDWORD)]

        SYNCHRONIZE = 0x100000
        process = kernel32.OpenProcess(SYNCHRONIZE, 0, pid)
        if not process:
            return False

        ec = ExitCodeProcess()
        out = kernel32.GetExitCodeProcess(process, ctypes.byref(ec))
        if not out:
            err = kernel32.GetLastError()
            if kernel32.GetLastError() == 5:
                # Access is denied.
                logging.warning("Access is denied to get pid info.")
            kernel32.CloseHandle(process)
            return False
        elif bool(ec.lpExitCode):
            # print ec.lpExitCode.contents
            # There is an exist code, it quit
            kernel32.CloseHandle(process)
            return False
        # No exit code, it's running.
        kernel32.CloseHandle(process)
        return True 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-07-15T00:24:57.327

结合[Giampaolo Rodolà 对 POSIX 的回答](https://stackoverflow.com/a/6940314/1777162)和[我对 Windows](https://stackoverflow.com/a/17645054/1777162)的回答，我得到了这个：

```
import os
if os.name == 'posix':
    def pid_exists(pid):
        """Check whether pid exists in the current process table."""
        import errno
        if pid < 0:
            return False
        try:
            os.kill(pid, 0)
        except OSError as e:
            return e.errno == errno.EPERM
        else:
            return True
else:
    def pid_exists(pid):
        import ctypes
        kernel32 = ctypes.windll.kernel32
        SYNCHRONIZE = 0x100000

        process = kernel32.OpenProcess(SYNCHRONIZE, 0, pid)
        if process != 0:
            kernel32.CloseHandle(process)
            return True
        else:
            return False 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-05-26T23:00:03.663

这适用于 Linux，例如，如果您想检查 banshee 是否正在运行...（banshee 是一个音乐播放器）

```
import subprocess

def running_process(process):
    "check if process is running. < process > is the name of the process."

    proc = subprocess.Popen(["if pgrep " + process + " >/dev/null 2>&1; then echo 'True'; else echo 'False'; fi"], stdout=subprocess.PIPE, shell=True)

    (Process_Existance, err) = proc.communicate()
    return Process_Existance

# use the function
print running_process("banshee") 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-01-21T11:19:17.283

在 Windows 中，您可以这样做：

```
import ctypes
PROCESS_QUERY_INFROMATION = 0x1000
def checkPid(pid):
    processHandle = ctypes.windll.kernel32.OpenProcess(PROCESS_QUERY_INFROMATION, 0,pid)
    if processHandle == 0:
        return False
    else:
        ctypes.windll.kernel32.CloseHandle(processHandle)
    return True 
```

首先，在这段代码中，您尝试获取给定 pid 的进程句柄。如果句柄有效，则关闭进程的句柄并返回True；否则，您返回 False。OpenProcess 的文档：[https ://msdn.microsoft.com/en-us/library/windows/desktop/ms684320%28v=vs.85%29.aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684320%28v=vs.85%29.aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-20T01:56:09.970

以下代码适用于 Linux 和 Windows，并且不依赖于外部模块

```
import os
import subprocess
import platform
import re

def pid_alive(pid:int):
    """ Check For whether a pid is alive """

    system = platform.uname().system
    if re.search('Linux', system, re.IGNORECASE):
        try:
            os.kill(pid, 0)
        except OSError:
            return False
        else:
            return True
    elif re.search('Windows', system, re.IGNORECASE):
        out = subprocess.check_output(["tasklist","/fi",f"PID eq {pid}"]).strip()
        # b'INFO: No tasks are running which match the specified criteria.'

        if re.search(b'No tasks', out, re.IGNORECASE):
            return False
        else:
            return True
    else:
        raise RuntimeError(f"unsupported system={system}") 
```

如果您需要，它可以轻松增强

1.  其他平台
2.  其他语言

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-10-14T01:50:17.493

我发现这个解决方案似乎在 windows 和 linux 中都运行良好。我用 psutil 来检查。

```
import psutil
import subprocess
import os
p = subprocess.Popen(['python', self.evaluation_script],stdout=subprocess.PIPE, stderr=subprocess.STDOUT) 

pid = p.pid

def __check_process_running__(self,p):
    if p is not None:
        poll = p.poll()
        if poll == None:
            return True
    return False

def __check_PID_running__(self,pid):
    """
        Checks if a pid is still running (UNIX works, windows we'll see)
        Inputs:
            pid - process id
        returns:
            True if running, False if not
    """
    if (platform.system() == 'Linux'):
        try:
            os.kill(pid, 0)
            if pid<0:               # In case code terminates
                return False
        except OSError:
            return False 
        else:
            return True
    elif (platform.system() == 'Windows'):
        return pid in (p.pid for p in psutil.process_iter()) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-11T00:10:38.807

Windows 的另一个选项是通过 pywin32 包：

```
pid in win32process.EnumProcesses() 
```

win32process.EnumProcesses() 返回当前运行进程的 PID。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-02-20T07:39:21.370

我会说将 PID 用于您获得它的任何目的并优雅地处理错误。否则，这是一场经典的比赛（当您检查它的有效时，PID 可能是有效的，但稍后会消失）

# c# - 在 C# 中类似 Python 的列表解包？

> ID：568280
> 
> 赞同：10
> 
> 时间：2009-02-20T04:28:17.117
> 
> 标签：c#, iterable-unpacking

在 python 中，我可以这样做：

```
List=[3, 4]

def Add(x, y):
    return x + y

Add(*List) #7 
```

有没有办法在 C# 中做到这一点或类似的东西？基本上我希望能够将参数列表传递给任意函数，并将它们作为函数的参数应用，而无需手动解包列表并调用显式指定参数的函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T04:49:59.560

好吧，最接近的是反射，但那是缓慢的一面......但是看看[MethodInfo.Invoke](http://msdn.microsoft.com/en-us/library/a89hcwhh.aspx) ...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-10-04T15:55:13.013

您可以在定义方法时使用 params 关键字，然后可以直接将列表（在调用 ToArray 之后）放入方法调用中。

```
public static void UseParams(params object[] list)
{
        for (int i = 0; i < list.Length; i++)
        {
            Console.Write(list[i] + " ");
        }
        Console.WriteLine();
} 
```

...您以后可以使用以下命令调用它。

```
object[] myObjArray = { 2, 'b', "test", "again" };
UseParams(myObjArray); 
```

供参考：http: [//msdn.microsoft.com/en-us/library/w5zay9db.aspx](http://msdn.microsoft.com/en-us/library/w5zay9db.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T04:53:02.223

你不能，你可以用一点手来做一些接近的事情（或者屈服于一个 foreach，或者在接受 lambda 的集合上添加一个 foreach 扩展方法），但没有什么比你在 python 中获得的优雅。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T04:56:11.043

```
Func<List<float>, float> add = l => l[0] + l[1];
var list = new List<float> { 4f, 5f };
add(list); // 9 
```

或者：

```
Func<List<float>, float> add = l => l.Sum();
var list = new List<float> { 4f, 5f };
add(list); // 9 
```

考虑到它是静态类型的，是你在 c# 中得到的最接近的。您可以查看 F# 的模式匹配，以确定您正在寻找的内容。

# flash - Flash：调度/处理事件

> ID：568281
> 
> 赞同：0
> 
> 时间：2009-02-20T04:28:20.223
> 
> 标签：flash, actionscript-3, events, flexbuilder

我有加载另一个 swf 文件 (page1.swf) 的 Flash 应用程序 (main_container.swf)。

我想在 page1 完成时调度一个事件，告诉 main_container 关闭 page1。

这是您将事件从 page1 分派到 main_container 的方式吗？

```
parent.dispatchEvent(new Event("pageFinish", true)); 
```

那么如何从 main_container 中捕获事件呢？我试过这个，但没有用。

```
loader.addEventListener("pageFinish", OnPage1Finish); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T04:32:47.450

最简单的方法就是

```
// main, somewhere
loader.content.addEventListener("imDone", imDoneListener);

// page1 timeline/doc class
dispatchEvent(new Event("imDone")); 
```

当然，您必须等到加载器有一个 .content 供您添加侦听器，您可以等待 loader.contentLoaderInfo 中的 Event.INIT，然后再添加完整的侦听器或在加载器上调度：

```
// page1 again, parent.dispatchEvent() would also work
// if you don't reparent the content (which is a bad idea, it confuses Loader)
loaderInfo.loader.dispatchEvent(new Event("imDone")); 
```

# c# - 将数据源分配给区域

> ID：568282
> 
> 赞同：0
> 
> 时间：2009-02-20T04:29:14.760
> 
> 标签：c#, asp.net, forms, datagrid

我想知道是否有一个现有的控件可以用来实现我正在尝试的目标。

基本上，我有一个显示标题信息的 html 表。

它看起来像这样：

```
<table class="tableEdit">
    <tr>
        <th>Job ID</th><td>10</td>
        <th>Client</th><td>Tom</td>
    </tr>
    <tr>
        <th>Comments</th><td>Comments are here</td>
    </tr>
</table> 
```

我想知道是否有一个可以用作容器的现有控件。然后我可以将数据源分配给该控件并利用字段值。

```
<asp:Somecontrol runat="server" ID="someid">

<table class="tableEdit">
    <tr>
        <th>Job ID</th><td><%# Eval("Id") %></td>
        <th>Client</th><td><%# Eval("Client.Name") %></td>
    </tr>
    <tr>
        <th>Comments</th><td><%# Eval("Comments") %></td>
    </tr>
</table> 

</asp:Somecontrol>

private void BindHeader()
{
 SomeObjectType data = DAL.SomeMethod();
 someid.Datasource = data;
 someid.DataBind();
} 
```

有什么可以做的吗？我希望能够控制容器内字段的布局。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T07:09:18.373

实际上，我所追求的是 FormView 控件。

我以前从未使用过此控件，但这是我想做的确切控件。

它允许根据需要标记区域、分配数据源和绑定项目。

```
 <asp:FormView ID="FormView1" runat="server" DataSourceID="ObjectDataSource2" Visible="false">
                    <ItemTemplate>
                        <table style="border-collapse: collapse;" class="tableEdit">
                            <tr>
                                <td>ClientId</td>
                                <td><asp:Label ID="ClientId" runat="server" Text='<%# Eval("ClientId") %>' /></td>
                            </tr>
                            <tr>
                                <td>ClientCode</td>
                                <td><asp:TextBox ID="TextBox1" runat="server" Text='<%# Eval("ClientCode") %>' /></td>
                            </tr>
                            <tr>
                                <td>Name</td>
                                <td><asp:TextBox ID="TextBox2" runat="server" Text='<%# Eval("Name") %>' /></td>
                            </tr>
                            <tr>
                                <td>BillingContactName</td>
                                <td><asp:TextBox ID="TextBox3" runat="server" Text='<%# Eval("BillingContactName") %>' /></td>
                            </tr> 
```

感谢 AI W 的输入。中继器也适用，但对于绑定“a”记录，我认为 FormView 是理想的。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T04:36:32.620

使用 GridView 控件。您可以在设计模式下将 CSS 类附加到许多属性以控制布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T06:38:24.480

对于 asp.net 2.0

```
<asp:Repeater runat="server" id="someid">
        <ItemTemplate>
    <table class="tableEdit">
        <tr>
            <th>Job ID</th><td><%# Eval("Id") %></td>
            <th>Client</th><td><%# Eval("Client.Name") %></td>
        </tr>
        <tr>
            <th>Comments</th><td><%# Eval("Comments") %></td>
        </tr>
    </table>
        </ItemTemplate>
</asp:Repeater> 
```

您可以在 asp.net 3.5 中使用该控件，但我不会立即尝试语法，因为我不会每天都使用 3.5。

# grails - Grails 应用程序中的 Google 搜索

> ID：568294
> 
> 赞同：2
> 
> 时间：2009-02-20T04:38:17.843
> 
> 标签：grails, google-search

我正在 GRAILS 框架中创建一个 Web 应用程序。我想实现谷歌搜索功能。我们可以实现这个功能吗？如果可以，如何在 grails 应用程序中实现此功能？

任何人都可以提供帮助吗？

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T04:41:31.877

是的，使用[Google AJAX 搜索 API](http://code.google.com/apis/ajaxsearch/)。

# visual-c++ - 我们想做一个不动态转发具有引用渗透性的异常的函数吗？

> ID：568295
> 
> 赞同：1
> 
> 时间：2009-02-20T04:40:09.927
> 
> 标签：visual-c++

谷歌翻译 ：

解释器创建后，将字节数组转换为机器语言数组中的枚举类型和函数，我已经做了一个动态执行函数的方法，参考请告诉我机器语言网站。

巴别鱼翻译：

是做解释器，但是在字节单元的排列中插入机器语言，但是如果是用它排列很强制转换的方法动态地制作函数，它通过枚举在函数类型中执行，有一个景象请教成为参考的机器语言。

原始问题：

インタプリタ作っのですが，をバイト単位で配列にをををををををををををををををを关数关数型型ににキャストキャストしし，それそれをを実行実行実行するといういうになる机械语のサイトがあれば教えてください。</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T04:45:31.900

我要做一个猜测——纯粹的猜测：

> 您有一个包含函数机器代码的字节数组。你如何编写一个强制转换以使函数可以执行？

在这种情况下，答案很可能是：

> 在大多数现代操作系统中，系统会保护您免于将数据转换为可执行代码。处理它的最佳方法是将代码打包为动态加载（共享）库中的函数，然后使用操作系统的标准调用来加载该库并执行该函数。

# extjs - Extjs SetEditor - 查询生成器

> ID：568298
> 
> 赞同：0
> 
> 时间：2009-02-20T04:44:58.310
> 
> 标签：extjs

我正在尝试向单元格添加编辑器，具体取决于在另一个单元格中选择的组合值。

考虑有 2 列，其中一列应用了组合编辑器。如果我选择索引 1，则第 2 列添加一个日期编辑器，否则添加一个字符串编辑器。

基本上我正在构建一个查询生成器，所以 | | |

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T05:00:29.897

如果没有看到一些示例代码，很难给出具体的答案，但基本的想法是让第 1 列的“选择”处理程序使用适当的编辑器对象在第 2 列调用“setEditor()”。

有关更多详细信息，请查看[API 文档](http://www.extjs.com/deploy/dev/docs/)- 查找“ColumnModel”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-30T13:59:05.260

我认为 4.0 中存在一个错误，当您使用 setEditor() 时会导致错误，但没有人支持或反驳我...

# c++ - 如何将 argv[1] 传递给接受 0 个参数的函数？

> ID：568301
> 
> 赞同：0
> 
> 时间：2009-02-20T04:45:32.943
> 
> 标签：c++, command-line-arguments

我究竟需要做什么才能将 argv[1] 的内容传递给不使用参数的函数？

这是如何运作的？

```
const char *cPtr = argv[1]; 
```

并将其传递给接受 0 个参数的 someFunction() ！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T04:47:53.780

如果您不想将其作为参数传递，则需要将其推入全局，以便函数可以以这种方式访问​​它。我不知道其他方法（除了愚蠢的事情，比如将它写入文件`main()`并在函数中读取它）：

```
static char *x;
static void fn(void) {
    char *y = x;
}
int main (int argc, char *argv[]) {
    x = argv[1];
    fn();
    return 0;
} 
```

我不会这样做。由于您需要能够更改`fn()`才能访问`x`，我将重写它以传递参数：

```
static void fn(char *x) {
    char *y = x;
}
int main (int argc, char *argv[]) {
    fn(argv[1]);
    return 0;
} 
```

当然，除非这是家庭作业、脑筋急转弯或面试问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T05:25:08.213

我想知道你为什么要这样做。但是可以使用一些不太漂亮的代码来完成。本质上调用该方法，就好像它是采用 char* 参数的方法一样。然后在方法中，使用内联汇编来访问参数。这是一个使用 __cdecl 调用约定实现的 someFunction 的示例。

```
#include "stdafx.h"

void someFunction()
{
    TCHAR *x = NULL;
    __asm 
    {
        mov eax, dword ptr[ebp + 8]
        mov x, eax
    }

#ifdef _UNICODE
    printf("%ws\n", x);
#else
    printf("%s\n", x);
#endif
}

int _tmain(int argc, TCHAR* argv[])
{
    if (argc < 2)
        return 1;

    const TCHAR *message = argv[1];

    typedef void (*FuncPtr)(const TCHAR*);

    FuncPtr p = (FuncPtr)someFunction;

    p(message);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T04:48:48.723

我能想到的唯一方法是使“const char *cPtr”成为全局变量。

例如

```
char *cPtr;

main(int argc, char **argv) 
{
    cPtr = argv[1];
} 
void someFunction()
{
  printf("%s\n", cPtr);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T09:35:36.383

如果我们更多地了解为什么要将参数传递给不带参数的函数，那将会有所帮助。
例如，您是否尝试将功能应用于容器中的项目？

其他人提到了全局变量，这是一种通过将参数传递给类或结构的构造函数来“作弊”的方法：

```
struct fnstruct { 
    const char* p_; 
    fnstruct(const char* p) : p_(p) { }
    void operator()() { printf(p_); }
};

int main(int argc, char* argv[]) {
    if(argc < 2)
        return 0;

    fnstruct fn(argv[1]); //argument passed to constructor

    fn(); //function called with no argument!
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T04:48:41.017

做到这一点的唯一方法是将 argv[1] 存储在一个全局变量中并从函数内部访问它。

# c# - 在使用 arraylist 存储动态值方面需要帮助

> ID：568302
> 
> 赞同：-1
> 
> 时间：2009-02-20T04:45:37.403
> 
> 标签：c#, arraylist

有人请帮助我如何使用arraylist动态存储值。每次我想添加患者详细信息时。这是我的代码层：

`PatientDataLayer`：

```
public class PatientData
{
    public string str = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString.ToString();
    public int AddPatient(Patient obj)
    {
        using (var con = new SqlConnection(str))
        {
            using (var com = new SqlCommand("AddPatient", con))
            {
                com.CommandType = CommandType.StoredProcedure;
                com.Parameters.AddWithValue("@Name", obj.Name);
                com.Parameters.AddWithValue("@Address", obj.Address);
                com.Parameters.AddWithValue("@DateOfBirth", obj.DateOfBirth);
                com.Parameters.AddWithValue("@Phone", obj.Phone);
                com.Parameters.AddWithValue("@EmergencyContact", obj.EmergencyContact);
                com.Parameters.AddWithValue("@DateOfRegistration", obj.DateOfRegistration);
                con.Open();
                com.ExecuteNonQuery();
                con.Close();
                return 0;                       
            }
        }
    } 
```

`PatientBusinessLayer`：

```
public class PatientBusiness
{
    public void Add(Patient obj)
    {      
        PatientData pd = new PatientData();
        pd.AddPatient(obj);      
    }   
} 
```

`Patient.aspx.cs`：

```
 protected void BtnAdd_Click(object sender, EventArgs e)
    {
        if (!Page.IsValid)   //validating the page
            return;
        string name = TxtName.Text;
        string address = TxtAddress.Text;
        DateTime dateofbirth =Convert.ToDateTime(TxtDateOfBirth.Text);
        int phone = Convert.ToInt32(TxtPhone.Text);
        int emergencyno=Convert.ToInt32(TxtContact.Text);
        DateTime registrationdate =Convert.ToDateTime(TxtRegistrationDate.Text);
        PatientBusiness PB = new PatientBusiness();
        Patient obj = new Patient();
        try
        {
            obj.Name = name;
            obj.Address = address;
            obj.DateOfBirth = dateofbirth;
            obj.Phone = phone;
            obj.EmergencyContact = emergencyno;
            obj.DateOfRegistration = registrationdate;
            PB.Add(obj);
            LblMessage.Text = "Patient has been added successfully";
            TxtName.Text = "";
            TxtAddress.Text = "";
            TxtDateOfBirth.Text = "";
            TxtPhone.Text = "";
            TxtContact.Text = "";
            TxtRegistrationDate.Text = "";
        }
        catch (Exception ee)
        {
            LblMessage.Text = ee.Message.ToString();
        }
        finally
        {
            PB = null;
        }   
    } 
```

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T05:50:01.133

我不明白你的问题，但是在查看了你的代码之后，我只能建议你考虑结合使用 ObjectDataSource 和 FormView 并停止在后面的代码中做“业务”。

# c# - Html 邮件中的字体

> ID：568303
> 
> 赞同：3
> 
> 时间：2009-02-20T04:47:31.377
> 
> 标签：c#, .net, html, email

```
Using MailMessage email = new MailMessage();email.IsBodyHtml = true; 
```

是否可以设置消息的字体？

另外，也许这是一个怪癖，但 p 和 br 标签对我来说是一样的吗？这是正常的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T04:51:57.293

您可以使用 CSS：

```
<style>
   p {color:#999; font-family:arial;} /*grey*/
</style> 
```

您仅限于接收器机器上安装的字体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T04:53:09.397

我建议研究使用样式表属性来更改字体大小。

不知道你所说的“和标签对我来说是一样的”部分是什么意思......出来和什么一样？

...查尔斯打败了我

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T08:00:21.587

在处理 HTML 电子邮件时，您会发现**很多**挫折。
一些我记得的问题

*   某些邮件客户端在将 CSS 放置在元素**之外**时不会呈现 CSS 。`<body>`
*   一些邮件客户端根本不会呈现 CSS。

一个很好的 HTML 电子邮件资源是[email-standards.org](http://www.email-standards.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T05:05:19.430

您可以在邮件正文中包含 css。由于邮件正文为 html 格式，因此此处可以使用所有 html 功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T05:34:33.340

不，中断和段落标签不一样。

Break 只是从一个新行开始，段落在它周围增加了一些空间。它们还会导致浮动对象在其周围表现出不同的行为。

它们也可以使用 css 独立设置样式。

# drupal - Drupal 6添加节点表单提交时关闭

> ID：568305
> 
> 赞同：0
> 
> 时间：2009-02-20T04:48:07.867
> 
> 标签：drupal, drupal-6

当您点击保存然后强制下一页重新加载并使用表单中的数据更新时，如何关闭提交表单？这是drupal 6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T20:04:41.773

您可以`$form['#redirect'] = 'somepath';`在提交功能中设置。然后，它会在您完成后重定向到该位置。

查看[http://api.drupal.org/api/file/developer/topics/forms_api_reference.html/6#redirect](http://api.drupal.org/api/file/developer/topics/forms_api_reference.html/6#redirect)上的文档。

# sql - 聚合列值的 SQL 脚本

> ID：568310
> 
> 赞同：2
> 
> 时间：2009-02-20T04:49:48.283
> 
> 标签：sql, sql-server

我很感激一些帮助，将一个 sql 脚本放在一起，将数据从一个表复制到另一个表。基本上我需要为源表中的每一行做的是聚合列值并将它们存储到目标表中的单个列中。

```
TableA: ID, ColumnA, ColumnB, ColumnC
TableB: Identity, ColumnX 
```

因此，ColumnX 需要类似于“ColumnA、ColumnB、ColumnC”。

此外，我需要跟踪每个 TableA.ID -> SCOPE_IDENTITY() 映射以更新第三个表。

提前致谢！

编辑：TableA.ID 与 TableB.Identity 不同。TableB.Identity 将在插入时返回一个新的标识值。所以要么我需要将映射存储在临时表中，要么在每次插入 TableB 时更新 TableC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T05:57:22.300

这是一个逐行处理的示例。这将以一种您可以一次处理每一行的方式为您提供结果。或者您可以在最后使用 TableC 并执行您需要执行的任何处理。

但是，如果您在 TableB 中添加一个额外的列（称为 TableA_ID）并将结果插入其中，则会快得多。您可以立即访问 TableA.ID 和 TableB.Identity。但在不了解您的具体情况的情况下，这可能不可行。（但您总是可以添加该列，然后再将其删除！）

```
USE tempdb
GO

CREATE TABLE TableA (
    ID int NOT NULL PRIMARY KEY,
    ColumnA varchar(10) NOT NULL,
    ColumnB varchar(10) NOT NULL,
    ColumnC varchar(10) NOT NULL
)

CREATE TABLE TableB (
    [Identity]  int IDENTITY(1,1) NOT NULL PRIMARY KEY,
    ColumnX varchar(30) NOT NULL
)

CREATE TABLE TableC (
    TableA_ID  int NOT NULL,
    TableB_ID  int NOT NULL,
    PRIMARY KEY (TableA_ID, TableB_ID)
)

GO

INSERT INTO TableA VALUES (1, 'A', 'A', 'A')
INSERT INTO TableA VALUES (2, 'A', 'A', 'B')
INSERT INTO TableA VALUES (3, 'A', 'A', 'C')
INSERT INTO TableA VALUES (11, 'A', 'B', 'A')
INSERT INTO TableA VALUES (12, 'A', 'B', 'B')
INSERT INTO TableA VALUES (13, 'A', 'B', 'C')
INSERT INTO TableA VALUES (21, 'A', 'C', 'A')
INSERT INTO TableA VALUES (22, 'A', 'C', 'B')
INSERT INTO TableA VALUES (23, 'A', 'C', 'C')
GO

-- Do row-by-row processing to get the desired results
SET NOCOUNT ON
DECLARE @TableA_ID int
DECLARE @TableB_Identity int
DECLARE @ColumnX varchar(100)

SET @TableA_ID = 0

WHILE 1=1 BEGIN

  -- Get the next row to process
  SELECT TOP 1 
    @TableA_ID=ID,
    @ColumnX = ColumnA + ColumnB + ColumnC
  FROM TableA
  WHERE ID > @TableA_ID

  -- Check if we are all done
  IF @@ROWCOUNT = 0
    BREAK

  -- Insert row into TableB
  INSERT INTO TableB (ColumnX)
    SELECT @ColumnX

  -- Get the identity of the new row
  SET @TableB_Identity = SCOPE_IDENTITY()

  -- At this point, you have @TableA_ID and @TableB_Identity.
  -- Go to town with whatever extra processing you need to do
  INSERT INTO TableC (TableA_ID, TableB_ID)
    SELECT @TableA_ID, @TableB_Identity

END
GO

SELECT * FROM TableC
GO 
```

**从表 A 中选择 ***

```
ID          ColumnA    ColumnB    ColumnC
----------- ---------- ---------- ----------
1           A          A          A
2           A          A          B
3           A          A          C
11          A          B          A
12          A          B          B
13          A          B          C
21          A          C          A
22          A          C          B
23          A          C          C 
```

**从表 B 中选择 ***

```
Identity    ColumnX
----------- ------------------------------
1           AAA
2           AAB
3           AAC
4           ABA
5           ABB
6           ABC
7           ACA
8           ACB
9           ACC 
```

**从表 C 中选择 ***

```
TableA_ID   TableB_ID
----------- -----------
1           1
2           2
3           3
11          4
12          5
13          6
21          7
22          8
23          9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T04:57:36.487

假设：TableB 存在

```
INSERT INTO TableB (ColumnX)
SELECT [TableA]![ColumnA]+","+[TableA]![ColumnB]+","+[TableA]![ColumnC] AS ColumnX
FROM TableA; 
```

# c# - 动态过滤 DataGrid 中的数据

> ID：568312
> 
> 赞同：1
> 
> 时间：2009-02-20T04:50:19.840
> 
> 标签：c#, asp.net, sql-server-2005, .net-2.0, asp.net-3.5

我有一个值为“打开”、“关闭”的组合框。根据 ComboBox 中更改的值，我想更改 DataGrid 以显示“打开”或“关闭”值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T05:01:55.163

您的[DataGrid](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.aspx)可以绑定到[DataView](http://msdn.microsoft.com/en-us/library/system.data.dataview.aspx)。根据[DropDownList](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.dropdownlist.aspx)中的 Selected 项创建不同的*DataViews*（这是一篇关于[如何检索选定项](http://msdn.microsoft.com/en-us/library/a5kfekd2(VS.80).aspx)的文章）。

用您的数据填充[DataTable](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)。[为组合状态派生不同的 DataView](http://msdn.microsoft.com/en-us/library/8sd1cd0a.aspx)。当组合更改（启用 AutoPostback）时，选择适当的 DataView 并[绑定 DataGrid](http://msdn.microsoft.com/en-us/library/kf1c24y6.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T22:29:29.407

您可以使用任何 *DataSource 控件并添加带有组合框 ID 的控件参数。为组合打开自动回发，asp.net 将使用新的打开/关闭值自动调用对象数据源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T05:29:17.157

您可以使用绑定到 DataGrid 的 DataView 对象的[RowFilter属性。](http://msdn.microsoft.com/en-us/library/system.data.dataview.rowfilter.aspx)

# xpath - 如何通过 XPath 检索 CDATA 标记内的元素文本？

> ID：568315
> 
> 赞同：31
> 
> 时间：2009-02-20T04:51:25.627
> 
> 标签：xpath

考虑以下 xml 片段：

```
<Obj>
   <Name><![CDATA[SomeText]]></Name>
</Obj> 
```

如何通过 XPath 检索“SomeText”值？我正在使用 Nauman Leghari 的（优秀的）[Visual XPath 工具](http://weblogs.asp.net/nleghari/articles/27951.aspx)。
`/Obj/Name`返回元素
`/Obj/Name/text()`返回空白

我不认为它是该工具的问题（我可能错了）-我还阅读了 XPath 无法提取 CDATA（请参阅[此线程中的](http://bytes.com/groups/xml/469620-xpath-cdata)最后一个回复）-这对我来说听起来有点奇怪。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-20T17:33:26.717

`/Obj/Name/text()`是返回 CDATA 标记内容的 XPath。

让我失望的是 Value 属性的行为。对于 XMLNode（DOM 世界），元素的 XmlNode.Value 属性（使用 CDATA 或其他）返回 Null。InnerText 属性将为您提供 CDATA/Text 内容。如果您使用 Xml.Linq，XElement.Value 将返回 CDATA 内容。

```
string sXml = @"
<object>
    <name><![CDATA[SomeText]]></name>
    <name>OtherName</name>
</object>";

XmlDocument xmlDoc = new XmlDocument();
xmlDoc.LoadXml( sXml );
XmlNamespaceManager nsMgr = new XmlNamespaceManager(xmlDoc.NameTable);

Console.WriteLine(@"XPath = /object/name" );
WriteNodesToConsole(xmlDoc.SelectNodes("/object/name", nsMgr));

Console.WriteLine(@"XPath = /object/name/text()" );
WriteNodesToConsole( xmlDoc.SelectNodes("/object/name/text()", nsMgr) );

Console.WriteLine(@"Xml.Linq = obRoot.Elements(""name"")");
XElement obRoot = XElement.Parse( sXml );
WriteNodesToConsole( obRoot.Elements("name") ); 
```

输出：

```
XPath = /object/name
        NodeType = Element
        Value = <null>
        OuterXml = <name><![CDATA[SomeText]]></name>
        InnerXml = <![CDATA[SomeText]]>
        InnerText = SomeText

        NodeType = Element
        Value = <null>
        OuterXml = <name>OtherName</name>
        InnerXml = OtherName
        InnerText = OtherName

XPath = /object/name/text()
        NodeType = CDATA
        Value = SomeText
        OuterXml = <![CDATA[SomeText]]>
        InnerXml =
        InnerText = SomeText

        NodeType = Text
        Value = OtherName
        OuterXml = OtherName
        InnerXml =
        InnerText = OtherName

Xml.Linq = obRoot.Elements("name")
        Value = SomeText
        Value = OtherName 
```

原来 Visual XPath 的作者有一个用于 XmlNodes 的 CDATA 类型的 TODO。一个小代码片段，我现在有 CDATA 支持。 ![替代文字](https://lh6.ggpht.com/_nxgDpneh8yk/SZ7oO-OIGzI/AAAAAAAAAos/RxIisuTehho/s800/Visual_XPath.JPG)

MainForm.cs

```
private void Xml2Tree( TreeNode tNode, XmlNode xNode)
{
   ...
   case XmlNodeType.CDATA:
      //MessageBox.Show("TODO: XmlNodeType.CDATA");
      // Gishu                    
      TreeNode cdataNode = new TreeNode("![CDATA[" + xNode.Value + "]]");
      cdataNode.ForeColor = Color.Blue;
      cdataNode.NodeFont = new Font("Tahoma", 12);
      tNode.Nodes.Add(cdataNode);
      //Gishu
      break; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-20T14:21:22.670

**CDATA 部分只是[XPath](http://www.w3.org/TR/xpath)中称为 a[`text node`](http://www.w3.org/TR/xpath#section-Text-Nodes)或在[XML Infoset](http://www.w3.org/TR/xml-infoset/#infoitem.character)中称为“字符信息项块”的部分。**

**显然，您的工具是错误的**。其他工具，如[**XPath Visualizer**](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)`Name`在评估此 XPath 表达式时正确突出显示元素的文本：

```
/*/Name/text() 
```

**也可以编写一个简单的 XSLT 转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
<xsl:template match="/">
  "<xsl:value-of select="/*/Name"/>"
</xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<Obj>
    <Name><![CDATA[SomeText]]></Name>
</Obj> 
```

**产生正确的结果：**

```
 "SomeText" 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-20T05:25:29.930

我认为您引用的线程说 XPATH 忽略了 CDATA 标记本身，而不是 CDATA 标记中包含的文本。

我的猜测是工具的问题，源代码可以下载，也许你可以调试它......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T05:37:07.450

看看这是否有帮助 - [http://www.zrinity.com/xml/xpath/](http://www.zrinity.com/xml/xpath/)
XPATH = /Obj/Name/text()

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2010-05-26T16:15:26.980

一个建议是拥有 cdata 的 md5 散列的另一个字段。然后，您可以使用 xpath 根据 md5 进行查询，没有问题

```
<sites>
  <site>
    <name>Google</name>
    <url><![CDATA[http://www.google.com]]></url>
    <urlMD5>ed646a3334ca891fd3467db131372140</urlMD5>
  </site>
</sites> 
```

然后你可以搜索：

```
/sites/site[urlMD5=ed646a3334ca891fd3467db131372140] 
```

# python - 获取两个MSWord doc文件的diff并输出到html

> ID：568320
> 
> 赞同：2
> 
> 时间：2009-02-20T04:54:57.863
> 
> 标签：python, ms-word, diff

> **可能重复：**
> [如何比较两个word文档？](https://stackoverflow.com/questions/90075/how-to-compare-two-word-documents)

如何以编程方式获得两个单词 .doc 文档的差异？然后您可以在其中获取结果输出并生成结果的 html 文件。（正如您期望在普通的 gui diff 工具中看到的那样）

我想如果您通过 COM 获取文档并将输出转换为文本，您可以提供*一些*差异功能。想法？

有没有办法在没有 Windows 和 COM 的情况下做到这一点？

（最好在 python 中，但我对其他解决方案持开放态度）

**更新**

询问 msword 差异工具的原始问题与以下内容重复：（感谢 Nathan）

[如何比较两个word文档？](https://stackoverflow.com/questions/90075/how-to-compare-two-word-documents/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T05:31:28.120

在 Word 2003 中使用此选项：

> **工具**| 比较和合并**文档**

或者在 Word 2007 中：

> **评论**| 比较**_** _

它会提示您输入一个文件，与您正在编辑的文件进行比较。

* * *

这个问题是[如何比较两个word文档的副本？](https://stackoverflow.com/questions/90075/how-to-compare-two-word-documents/)，这个答案与[我在那里的答案](https://stackoverflow.com/questions/90075/how-to-compare-two-word-documents/90277#90277)重复。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T05:03:50.993

我不确定您是否正在寻找以下功能。微软本身有office套件的选项，请查看 [http://support.microsoft.com/kb/306484](http://support.microsoft.com/kb/306484)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T05:05:39.337

看起来如果您安装了 word 和 win32com，则获取文本相对容易：

```
import win32com.client
app = win32com.client.Dispatch('Word.Application')
doc = app.Documents.Open('c:\\files\\mydocument.doc')
print doc.Content.Text
app.Quit() 
```

来源：[http ://win32com.goermezer.de/content/view/158/192/](http://win32com.goermezer.de/content/view/158/192/)

然后，您可以对结果文本运行标准差异。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T05:06:08.057

我使用 Araxis Merge 比较各种源文件，但它也提取和比较各种办公文档格式，如 MS Word、PDF、OpenDocument 等。我认为如果你愿意花一点钱，这将是你最好的选择的钱。

[http://www.araxis.com/merge/index.html](http://www.araxis.com/merge/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T05:04:50.697

可能不相关（因为您已经知道这一点），但 Word 确实具有更改跟踪功能（需要事先打开）。 [http://office.microsoft.com/en-us/word/HA012186901033.aspx](http://office.microsoft.com/en-us/word/HA012186901033.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T02:02:52.763

如果它是 docx，并且您对 java 很满意，则可以使用[docx4j](http://dev.plutext.org) (ASL v2)。这具有内置的差异功能。

请参阅[CompareDocuments 示例](http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/samples/CompareDocuments.java)

如果它是一个文档，它还具有转换为 docx（使用 poi）的基本代码，您可以先执行此操作。

# html - jsp中如何获取get方法参数？

> ID：568321
> 
> 赞同：1
> 
> 时间：2009-02-20T04:56:03.277
> 
> 标签：html, jsp

从第一页获得输入后，我使用 get 方法将其传递给 url。在下一页中，我想使用 jsp 对其进行处理，但是如何获取该参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T04:59:36.323

您可以从请求对象中获取它。

```
request.getParameter("<param name>"); 
```

# emacs - Mac OS X Emacs 无法正确突出显示注释

> ID：568329
> 
> 赞同：1
> 
> 时间：2009-02-20T04:59:15.203
> 
> 标签：emacs, terminal

有时我很老派，我喜欢在终端中使用 Emacs。（我一直在使用 IDE。但有时，在我自己家里的私密空间中，我只喜欢文本编辑器、终端和啤酒）

但是，OS X 自带的默认 Emacs 似乎并没有突出显示 font-lock-mode 中的注释。我在 Python 和 C 模式下都看到过这种行为。

我已经搜索了一些论坛，我发现一个帖子中的人和我有同样的问题：

[http://forums.macosxhints.com/showthread.php?p=512361](http://forums.macosxhints.com/showthread.php?p=512361)

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T04:41:52.297

我有这个完全相同的问题。解决方案是更改用于评论面的颜色，如下所示：

```
(set-face-foreground 'font-lock-comment-face "red") 
```

或者，如果您只想对某些模式执行此操作：

```
;;; Only do this for the common C mode (C, C++, Objective-C)
(add-hook 'c-mode-common-hook #'(lambda () (set-face-foreground 'font-lock-comment-face "red"))) 
```

有关面的更多信息，请参阅[http://www.gnu.org/software/emacs/manual/html_node/emacs/Faces.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Faces.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T04:27:58.960

根据我的经验，这通常与现有评论中某处的未配对引用（单引号、双引号或其他引号）有关。

在你的源代码中寻找并消除它们（或者如果你更有野心，看看你是否可以在你的主要模式的 emacs 源代码中更新 fontlock 代码）

当我在 emacs 中编辑 Perl 时遇到这种情况时，我经常将主要模式切换到，`cperl-mode`因为它通常比默认的 perl 更好地处理 perl 的解析`perl-mode`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T05:33:41.453

我不确定如何修复它，但我相当确定您可以在 .emacs 文件中添加一些内容。事实上，我想我以前做过。我会查找我的文件并告诉你我能找到什么。

当我今晚下班回家时，我会试着给你我的 .emacs 文件。

[编辑] 我看了又看，在我使用的任何一个系统上都找不到 .emacs 文件，在我的 OS X 安装（Leopard 默认）上，默认情况下它看起来是正确的。我在[这里](http://sunsite.ualberta.ca/Documentation/Gnu/emacs-21.1/html_chapter/faq_5.html#SEC32)做了一些研究，看起来默认安装不再使用 .emacs 文件，因为像我这样的人会弄乱它们并破坏东西，他们厌倦了不得不帮助我们修复它。但是，有一组菜单可以让您进行调整。首先输入“ `M-x customize RET`”，其中 M 是元字符（在我的 OSX 安装中，这是`esc`关键。不要按住它，只需像普通字符一样输入它。这会让你进入一个你可以使用的菜单改变。我没有四处寻找太多，所以我不确定你会在菜单中的哪个位置找到你要找的东西。

# ruby-on-rails - 您希望看到哪些 Rails 插件？

> ID：568337
> 
> 赞同：5
> 
> 时间：2009-02-20T05:02:21.467
> 
> 标签：ruby-on-rails, ruby, plugins, ruby-on-rails-plugins

您必须在 Rails 应用程序中实现哪些行为，您认为可以作为插件很好地存在？

您过去搜索过哪些插件功能但找不到？

哪些现有的 Rails 插件可以改进或扩展，如何改进？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T09:17:10.263

我希望在管理界面中看到一个引擎插件，该插件提供应用程序中所有模型的仪表板摘要以及可配置的活动图表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T05:07:23.403

我曾经为一个应用程序编写了一个组件，它确实将照片的 zip 文件上传到应用程序，所以它们不必一个一个地完成，我想我有时间可以把它做成一个插件，以及一个新版本它，代码有点难看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T08:34:18.757

不容易回答。每个人都偏向于自己当前的项目。此外，已经存在很多很棒的插件。

就个人而言，我希望看到一些用于典型数据库应用程序的菜单插件。例如，用户角色很少，每个用户角色都有不同的权限。以及一个带有子菜单的主菜单，这取决于用户的操作权限。

几乎每个数据库应用程序都重新实现了 (CSS) 菜单。它是特定于应用程序的东西，我不知道实现一些通用解决方案或模板有多难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T15:11:41.953

**信用卡支付系统**

目前，在网站达到“生产质量”之前，没有人会费心实施信用卡支付。单人项目或小型初创公司一开始不会费心去做这件事，因为他们宁愿花时间制作新的、困难的或有趣的功能原型。

从长远来看，这对每个人（包括最终用户）都是不利的，b/c 默认是免费提供（通常是创新且非常棒的）服务，这意味着只有已经获得资助的团队或有大量额外时间的人才能甚至到了做点什么的地步。

如果它存在，被整齐地打包，并且像 Rails 脚手架一样简单，小项目可以默认使用任何真正有意义的支付方案——比如按使用付费、捐赠、试用期、前 5 次免费等. - 使资助真正伟大的产品成为*可能*，而不是强迫他们依赖外部资金或广告，这会破坏产品。

在真正的实体店中，人们期望付款。如果柜台另一边的人免费给我一些东西（根本不买任何东西），我会说“你是认真的吗？？” 然后迷茫地走开。但在网上，我几乎期待它。这是不好的！因为现在每个人都期待它，而试图做出伟大事情的人不能专注于实际做那个 b/c 他们太忙于想办法让它变得伟大*和自由*。

很多时候，网上有一些我非常喜欢并且愿意付费的免费东西，但根本没有简单的方法可以做到这一点。而且[我并不孤单](http://www.gabrielweinberg.com/blog/2009/03/twitter-charge-me-for-biz-tweets-instead-of-suspending-my-account.html)。我使用[tipjoy ，并且已经向像](http://tipjoy.com/)[Auditorium](http://www.playauditorium.com/)这样具有 PayPal 捐赠设置的东西捐款，但我认为这些还不够。

我见过的最好的东西是[RailsKits](http://railskits.com/)。但据我了解，它们没有正确打包，因此我可以在喜欢插件或 gem 时将它们添加到我的网站。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T08:01:14.173

我想看到某种内置的视频播放/流媒体。我当前的项目需要它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T02:09:21.053

我同意 Greg 的观点……有很多很棒的插件，还有很多很棒的想法。

我认为总是需要支持更多的 Web API。随着我们推进 API 驱动的服务和语义网络，在这方面有大量的工作要做。

[http://www.programmableweb.com/](http://www.programmableweb.com/)是思考哪些真正有用的 API 还没有 rails 插件或 ruby​​ gem 的一个很好的起点。

干杯!

沃尔特

# linq - 如何使用 LINQ 从对象列表中获取唯一的属性列表？

> ID：568347
> 
> 赞同：187
> 
> 时间：2009-02-20T05:05:14.283
> 
> 标签：linq, class, list, c#-3.0, properties

我正在尝试使用 LINQ 返回一个 id 列表，给定一个对象列表，其中 id 是一个属性。我希望能够做到这一点，而无需遍历每个对象并提取我找到的唯一 ID。

我有一个 MyClass 类型的对象列表，这个类的属性之一是一个 ID。

```
public class MyClass
{
  public int ID { get; set; }
} 
```

我想编写一个 LINQ 查询来返回这些 Id 的列表。

`IList<MyClass>`如果它返回一个`IEnumerable<int>`id ，我该怎么做？

我确信必须可以使用 LINQ 在一两行中完成此操作，而不是遍历 MyClass 列表中的每个项目并将唯一值添加到列表中。

* * *

## 回答 #1

> 赞同：344
> 
> 时间：2009-02-20T05:08:38.207

```
IEnumerable<int> ids = list.Select(x=>x.ID).Distinct(); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-20T05:09:17.363

使用[Distinct 运算符](http://msdn.microsoft.com/en-us/library/vstudio/system.linq.enumerable.distinct(v=vs.100).aspx)：

```
var idList = yourList.Select(x=> x.ID).Distinct(); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-06-30T21:25:34.060

使用直接[LINQ](https://en.wikipedia.org/wiki/Language_Integrated_Query)，`Distinct()`扩展名：

```
var idList = (from x in yourList select x.ID).Distinct(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-08T08:42:26.397

```
int[] numbers = {1,2,3,4,5,3,6,4,7,8,9,1,0 };
var nonRepeats = (from n in numbers select n).Distinct();

foreach (var d in nonRepeats)
{

    Response.Write(d);
} 
```

### 输出

1234567890

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-01-14T06:29:43.060

使用*Distinct*时，我们也必须转换为 IEnumerable 。如果列表是 <T> 模型，则意味着您需要编写如下代码：

```
 IEnumerable<T> ids = list.Select(x => x).Distinct(); 
```

# assembly - 编写 MBR 代码

> ID：568359
> 
> 赞同：15
> 
> 时间：2009-02-20T05:08:21.653
> 
> 标签：assembly, mbr

我是一名电气工程师，最近发现需要修改 MBR 中的代码。基本上我需要能够在硬盘驱动器上执行代码之前，操作系统启动并接管。

我完全理解这需要用汇编编写，并且考虑到 MBR 中大约 446 字节的代码空间，我只是希望调用 MBR 之外的其他代码。我的问题是写入 MBR 的最佳方式是什么？如果我想更改磁盘 HDD_1 的 MBR ... 将 HDD_1 从属到另一台机器然后写入它，或者在当前机器中直接写入（在 Windows 之外）是否更好。基本上，我想我会插入一个呼叫，而不要理会 MBR 的其余部分。

任何建议，将不胜感激

克里斯

我很清楚这将是困难的。我的问题是将指令放入 MBR 的最佳方式是什么？不用说，Windows 不允许直接访问磁盘。您如何建议我将指令写入 MBR ？是否可以引导 *nix 的 live CD 并从那里写入 MBR？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-20T09:16:02.060

有多种写入驱动器引导扇区的方法，我在尝试自制操作系统开发时使用了一个通用参考：[http ://wiki.osdev.org/](http://wiki.osdev.org/)

我个人只是在linux下启动并使用dd：

1.  先备份

    dd if=/dev/sda of=~/windows_bootloader.bin bs=512 count=1

2.  拆卸引导加载程序

    ndisasm -b16 -o7C00h ~/windows_bootloader.bin > ~/windows_bootloader.asm

3.  进行修改并重新组装

    nasm ~/windows_bootloader.asm -f bin ~/modified_bootloader.bin

4.  覆盖引导加载程序

    dd if=~/modified_bootloader.bin of=/dev/sda bs=512 count=1

这假设您的“sda”是正确的块设备。请注意，步骤 4 不只是将文件复制到 /dev/sda （它可以，但是如果输出二进制 > 512 Bytes ，那么您可能会覆盖的不仅仅是第一个扇区）

显然，您不想在实时系统上调试这种方法。使用某种 x86 仿真器（如 bochs、qemu 或 VMWare Server）将为您省去很多麻烦。

然而，正如迈克尔伯尔所说，这可能是一个坏主意。修改 Windows 引导加载程序可能会让您几乎没有空间或根本没有空间供您自己的代码使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-20T05:15:15.507

BIOS 通过读取每个引导设备的第一个扇区（512 字节）并检查一组特定的签名字节来从硬盘驱动器（或软盘驱动器）引导计算机。如果找到这些字节，则将 512 字节扇区复制到 ram（在特定位置），然后 BIOS 跳转以运行它。

除了签名字节之外，扇区中的 446 个字节可供您用作引导程序，但引导程序必须完全适合该扇区！由于 446 字节不是很大，您必须调用 BIOS 以将其他扇区从硬盘驱动器（或软盘驱动器或其他）复制到 ram 中以运行它们。

一旦你在 ram 中加载了足够的内容来运行你的程序，跳到它，你就可以开始了。

这就是操作系统如何从字面上“通过自己的引导程序将自己拉起来”

见[http://en.wikipedia.org/wiki/Master_boot_record](http://en.wikipedia.org/wiki/Master_boot_record)

现在，您没有理由不能用 C 或 C++（或大多数其他语言）编写引导代码，除非使用汇编，您可以确切地知道将生成什么代码并且很容易进行 BIOS 调用。

我建议你写一个 512 字节的磁盘驱动器到 ram copier，将你的程序从磁盘加载到 ram 中，然后跳转到程序的起始地址。然后，您可以用您想要的任何语言编写程序。请记住，当您的启动代码开始运行时，这 512 个字节是您唯一可以依靠的，就像在 ram 中一样。（好吧，BIOS 在那里，您可以进行 BIOS 调用。BIOS 还会在 ram 中的某些位置放置一些系统信息……）自己将它们加载到ram中。

此外，测试代码的最简单方法可能是将其放在软盘上并启动。

要回答您最初的问题，您可以在某处保留旧 MBR 的备份副本，并且您的新 MBR 可以将您的功能加载到 ram 中，运行它，然后加载原始 MBR 并运行它，允许 Windows 继续启动。

此外，迈克尔·伯尔是对的，得到你想要的东西将是一场噩梦。

为了回答您关于如何在硬盘驱动器上实际写入的评论，有几个“原始写入”程序可以复制到磁盘上的扇区。此外，您可以从 linux live cd 启动并使用 dd 将数据写入您选择的块设备上您选择的扇区。——简单的那部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-20T05:25:46.730

> 基本上我想我会插入一个电话，而不要管 MBR 的其余部分

这个子程序调用会调用什么？此时内存中唯一的代码是 MBR 或 ROM 中的任何代码。

在您花费太多时间之前，请仔细考虑您是否真的需要这个或那个没有更好的选择。写入 MBR（除了 OS 加载程序放入的 MBR）的第三方代码通常不被用户接受，因为：

*   防病毒程序经常将其标记为可疑代码，因为这是病毒用来控制机器的一种技术
*   程序使用了将自己插入 MBR 并将附加代码和数据存储在磁盘的“保留”扇区中的技术（因为在 MBR 中确实没有太多可以做的事情和存储）。不幸的是，由于没有好的、标准的方法来实际保留这些扇区，这种技术（有时用于复制保护）可能会导致磁盘上的数据结构损坏（即，驱动器上的所有数据都消失了）。用户真的很讨厌这样。我相信 Quicken 曾经使用过一种保护方案，它做了类似的事情并面临相当大的反弹。

因此，如果您决定继续走这条路，请谨慎行事并为头痛做好准备。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-20T06:48:21.010

为什么不用说 Windows 不允许直接访问磁盘？[CreateFile()](http://msdn.microsoft.com/en-us/library/aa363858.aspx)的 MSDN 页面这样说：

> 对磁盘或卷的直接访问受到限制。有关详细信息，请参阅帮助和支持知识库 [http://support.microsoft 中的“更改文件系统和存储堆栈以限制 Windows Vista 和 Windows Server 2008 中的直接磁盘访问和直接卷访问”。 com/kb/942448](http://support.microsoft.com/kb/942448)。
> 
> Windows Server 2003 和 Windows XP/2000：以这种方式直接访问磁盘或卷不受限制。

[KB942448](http://support.microsoft.com/kb/942448)解释了这些限制，它们似乎允许具有足够权限的进程写入 MBR 或分区引导扇区。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T05:18:28.340

我发现了一个类似的问题，可能会有所帮助：

[修改Windows的MBR](https://stackoverflow.com/questions/39503/modifying-the-mbr-of-windows)

但是，您可能需要详细说明您打算做什么。正如我发现自己的引导加载程序代码可能非常繁琐。另外，如果可能的话，我当然会用软盘测试它。

至于实际上是从 Windows 完成这一切，我有点无能为力。到目前为止，我几乎所有的编程经验都是在 Unix 环境下进行的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-15T12:42:56.620

我认为您最好的方法是使用 linux，它可以`nasm`用于编译、集群复制（这也意味着 MBR），如果您不想弄乱实际分区`dd`，甚至可以使用引导加载程序菜单（例如）。`lilo`

去年我不得不制作自己的启动顺序。基本上，我有这个：

```
LILO boot menu:
    -> WindowsXP
    -> linux 
```

我想在 MBR 上单独做一些事情，而不影响实际安装，所以我创建了一个新的（小）分区并将其添加到 LILO 列表（这里省略细节），它给出了这个：

```
LILO boot menu:
    -> WindowsXP
    -> linux
    -> TESTMBR 
```

这样一来，由于每个分区也都有自己的 MBR，我可以将任何我想要的古怪代码放在那里，而不会有将自己锁在外面的风险（修复起来有点烦人）。

为了真正改变那个 MBR，我这样做了：

1.  备份实际 MBR，例如`dd if=/dev/sda3 of=/home/you/mbr−backup count=1`
2.  编辑文件中的代码：boot.asm
3.  使用 nasm 编译：`nasm boot.asm -o boot.bin -f bin`纠正错误
4.  将新创建的 MBR 复制到驱动器：`dd if=boot.bin of=/dev/sda3`
5.  重启。
6.  在菜单中选择 TESTMBR。
7.  看看情况如何。

当然，您可以直接在驱动器的 MBR 而不是分区的 MBR 上执行此操作，就像我在这里所做的那样，但对于我自己的情况，它更实用。

关于实际的代码跳出 MBR，您需要使用[INT 13,42](http://en.wikipedia.org/wiki/INT_13#INT_13h_AH.3D42h:_Extended_Read_Sectors_From_Drive)中断，它将任何集群加载到磁盘上。为了我的测试目的，我只需要显示它的内容，但如果你愿意，我可以仔细看看。

希望能帮到你，抱歉回复太长了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-10T18:22:55.217

如果你可以制作一个软盘、光盘或记忆棒来引导到一个 MS 命令提示符，并且有一个匹配的 MS 调试版本，你可以像下面这样读写 MBR。运行 win95 或 win98 的机器应该能够为您创建启动软盘。只需将调试从 windows\command 目录复制到软盘。

内部调试：使用 r 命令更改寄存器值。将 ax 设置为 0201 用于读取，或 0301 用于写入。将 es:bx 设置为您希望使用的内存（缓冲区）的起始地址。0000:7C00 可能会起作用，因为这通常是在引导过程中读取下一个扇区的区域。将 cx 设置为 0001 以读取/写入一个 512 字节的扇区。将第一个物理硬盘的 dx 设置为 0080。

使用“a”命令汇编一行代码：INT 13h

使用“p”命令继续。根据您选择的 AX，将读取或写入数据。

您可以读取内存，“n”命名文件，“w”写入文件，然后在其他程序中编辑 mbr 的副本。完成后，使用调试的“n”和“L”命名并加载编辑的 MBR 文件，并使用 ax=0301h 调用 int 13h 将图像写入正确的扇区。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-30T10:30:10.303

你确定你需要写MBR吗？我是带分区的磁盘，还可以修改分区的VBR（Volume Boot Record）。这可能更容易/更安全，因为您不需要触摸 MBR，即使您完全破坏了测试分区，您的机器仍然能够引导到其他分区（和操作系统）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-20T07:18:31.747

您可以查看[GRUB](http://www.gnu.org/software/grub/)。我绝不是 MBR 代码方面的专家，而且我已经很久没有运行 *nix 操作系统了，但我记得引导加载程序分阶段工作，并在操作系统启动之前从磁盘加载阶段。您可以编写自己的阶段以在操作系统加载之前完成您需要完成的工作，然后启动操作系统。我不确定这个选项有多实用，特别是因为代码似乎处于重写中间，因为根据文档，“旧”版本是不可维护的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-04-15T12:12:09.383

在 Windows(XP) 中完全可以编辑 MBR。因为这是使用 HxD 十六进制编辑器，您可以在 MBR 上复制粘贴十六进制文件，甚至在您的活动系统驱动器上（谨慎使用！:)）[http://mh-nexus.de/en/hxd/](http://mh-nexus.de/en/hxd/)

作为起点，a 将获取源可用的 MBR，例如 Grub。（所以让 grub 对 Windows 进行 botoing）这样你就有了一个很好的起点来对你的 MBR 进行更改。编辑 MBR 应该不会太难，因为这个小软件非常基础。不过需要一些 16 位 (DOS) 汇编程序技能。另一种方法是让 grub 运行一些额外的有效负载而不改变 MBR，但我 100% 确定这是否可能；请参阅 Grub 手册。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-15T11:53:45.320

Windows 有一个未记录的实用程序“调试”，它允许：1) 将硬盘的任何扇区（包括 mbr）加载到内存。2）将该代码视为二进制或汇编。3）在ram.4中组装一些代码）将该代码写入任何扇区（也写入mbr）。要启动此实用程序，请在命令提示符处键入调试，然后按 Enter。提示变为“-”。然后键入“帮助”。你会得到关于如何使用它的信息，

# c# - 将 C# 表单加载到 ActiveX 控件中

> ID：568360
> 
> 赞同：0
> 
> 时间：2009-02-20T05:08:32.793
> 
> 标签：c#, .net

是否可以将 C# 表单（或 C# 应用程序）加载到 ActiveX 控件中？我知道如何将 ActiveX 控件加载到 C# 表单中......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T05:32:38.680

您可以在 VB6 中调用 .Net 表单（使用 Interop Forms Toolkit 2.0），并且可以使用 VB6 创建 ActiveX，所以我猜这是可能的。

我还听说过 ppl 使用从 .net-dlls 创建的表单，并使用 setparent-api 将其用作 vb6-form 的子级。

总而言之，是的，似乎可以在 activeX 控件中加载 C# 表单。

**Interop Forms Toolkit 2.0：在 VB6 应用程序中显示 .NET Winforms** [http://hubpages.com/hub/Interop_Forms_Toolkit_20](http://hubpages.com/hub/Interop_Forms_Toolkit_20)

有人使用 SetParent，不是一个解决方案，但很容易从谷歌搜索到其他解决方案。 [http://www.eggheadcafe.com/forumarchives/NETFrameworkinterop/Oct2005/post24062147.asp](http://www.eggheadcafe.com/forumarchives/NETFrameworkinterop/Oct2005/post24062147.asp)

# design-patterns - 即使你知道你不应该使用什么反模式？

> ID：568365
> 
> 赞同：5
> 
> 时间：2009-02-20T05:09:40.090
> 
> 标签：design-patterns, coding-style, anti-patterns

我是不是唯一一个有时会采取看似简单但错误的方式摆脱某些设计情况的人？我承认我已经分享了有问题的 Singleton 对象。除此之外，众所周知，我会制作一两个上帝对象以使事情看起来更容易。

即使您知道不应该使用反模式，您是否曾经使用过？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T05:28:31.950

尝试使某些东西变得灵活并以[内部平台效果](http://en.wikipedia.org/wiki/Inner-Platform_Effect)结束是很容易的。例如，我对内部数据库感到内疚。

有时，自己编写代码而不是使用预先罐装的类似版本 - [Not Invented Here](http://en.wikipedia.org/wiki/Not_Invented_Here)太诱人了。我试图避免它，但...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T05:14:29.207

[复制和粘贴](http://en.wikipedia.org/wiki/Copy_and_paste_programming)反图案

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T05:12:01.660

[God Object](http://en.wikipedia.org/wiki/God_object)反模式是一个容易犯的错误。有时，拆分课程似乎工作量太大。然后在稍后的某个时候，您会为此付出代价。我发现这种反模式与紧密耦合密切相关。

当您使用供应商特定语言时，供应商锁定反模式也很难避免。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T05:40:15.743

在评论中，我认为这是一个答案——单例模式。

当一种语言（如 Java）不支持它时，它是一种实现全局变量的方法。这是你永远不应该使用的模式之一——除非你需要它。重要的是能够区分何时需要全局变量（有实例）和何时只需要一个。

除了引入全局状态的严重问题之外，单例还存在问题，例如，在 Java 中，它们在类加载器中只有一个，具有多个类加载器，您最终可以得到多个副本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T05:16:22.713

您可以在 SO 本身中找到更多信息：

[你“最喜欢”的反模式是什么？](https://stackoverflow.com/questions/126158/what-is-your-favorite-anti-pattern)

[最常用的反模式有哪些？](https://stackoverflow.com/questions/57331/what-are-the-most-commonly-used-anti-patterns)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T05:35:42.573

[供应商锁定](http://en.wikipedia.org/wiki/Vendor_lock-in)

总是会为特定功能添加一个特定于供应商的东西，因为它比自己编写更有意义。后来我花了很多时间为这个决定自责。

# design-patterns - 对象上的 UI 特定属性

> ID：568377
> 
> 赞同：1
> 
> 时间：2009-02-20T05:15:55.803
> 
> 标签：design-patterns

假设我有一个名为 Category 的简单类，具有属性 Id、Name。我想在 UI 中将这些显示为菜单。但是显示逻辑也受第三个属性 IsSelected 的影响，我在渲染菜单时必须考虑到该属性。

有很多不同的方法可以实现这一点，例如通过继承或使用部分类。但是我的代码真的有必要从类似的东西改变吗

```
List<Category> list = CategoryLogic.GetCategories(); 
```

至

```
List<UICategoryItem> list = UICategoryLogic.GetCategories(intSelected); 
```

对于这么小的东西，这似乎有点矫枉过正，但这是我能想到的唯一方法。我可以通过使用继承来减少所需的新代码量，但我仍在寻找至少 2 个新代码文件（ UICategoryLogic 和 UICategoryItem ），如果类别发生更改，它们可能需要更改。

更不用说我的 UI 在不同的地方使用不同的类别的情况，每个可能都有一些独特的属性。我很快就会为每个目的使用大量不同类型的 Category 类，这可能会使代码难以理解。此外，我可能会使用不容易继承的数据集之类的东西，或者我使用的 ORM 可能会使类难以继承和扩展。

对于这种情况，是否有一般模式，我需要扩展基本数据项以满足我的需求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T05:20:26.103

转出继承kool-aid，作文是你的朋友。保留您的 Category 类并将其封装在更适合您目的的东西中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T05:23:55.550

UI 开发的“通用模式”是[MVC](http://en.wikipedia.org/wiki/Model-view-controller) - 模型视图控制器。让您的 Category 对象成为模型的一部分，您的 UI 控件（列表组合框等）成为视图，这些具有选择状态等概念，控制器是执行 UI 控件上的逻辑映射输入以更改模型对象并在必要时更新视图对象以反映更改。

# wcf - Wcf 服务错误

> ID：568382
> 
> 赞同：0
> 
> 时间：2009-02-20T05:17:23.770
> 
> 标签：wcf, service

当我尝试通过 wcf 服务发送大文件时，它会给出意外的服务响应，错误的请求 400 错误。如果我发送低于 16000 字节大小的文件不会给出错误。我如何增加尺寸，并帮助我解决问题。谢谢大家。通过 Senthil

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T13:10:34.663

在服务端点的服务器上的绑定中，找到您的传输绑定元素并增加以下两个属性的值。

```
maxReceivedMessageSize="999999" 
maxBufferSize="999999" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T05:48:15.880

听起来您正在达到配额或油门，请查看例如

[http://msdn.microsoft.com/en-us/library/bb463275.aspx](http://msdn.microsoft.com/en-us/library/bb463275.aspx)

[http://www.danrigsby.com/blog/index.php/2008/02/20/how-to-throttle-a-wcf-service-help-prevent-dos-attacks-and-maintain-wcf-scalability/](http://www.danrigsby.com/blog/index.php/2008/02/20/how-to-throttle-a-wcf-service-help-prevent-dos-attacks-and-maintain-wcf-scalability/)

[http://blogs.msdn.com/drnick/archive/2006/11/21/tuning-service-throttles.aspx](http://blogs.msdn.com/drnick/archive/2006/11/21/tuning-service-throttles.aspx)

# sql - 我可以从存储过程中查询参数和“选定”列名吗？

> ID：568383
> 
> 赞同：1
> 
> 时间：2009-02-20T05:17:52.303
> 
> 标签：sql, code-generation

我正在尝试编写一个可以解析存储过程的自定义代码生成器。我写了一些正则表达式，但它们似乎并不总是有效。我确实可以访问数据库；是否存在将返回所需参数和可能返回值的系统查询？我玩过 sp_depends，但它似乎不包含参数。是否有任何其他可能对此有用的系统过程？...我是在尝试错误的方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T00:18:49.257

您可以从中获取参数

```
select c.* 
from syscolumns c
inner join sysobjects o on o.id = c.id 
where o.type = 'P' and o.name = '<storedProcName>' 
```

正如 Marc 所说，返回值很棘手。你可以有

```
if (...)
     select * from Customers
else
     select * from CustomerOrders 
```

所以，在那里不会有太大的成功。当然我不知道什么样的人会写出像上面这样的东西，或者为什么，但这是可能的，所以......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T05:21:08.690

[sp_help](http://msdn.microsoft.com/en-us/library/aa933429(SQL.80).aspx)可以提供存储过程的参数（连同它们的数据类型）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T05:22:40.467

这些参数应该在元数据表中可用（我似乎记得它们甚至可能在针对 proc 的 object_id 的 syscolumns 中）。或[info-schemas](http://msdn.microsoft.com/en-us/library/aa933216(SQL.80).aspx)。

然而，结果更复杂，因为 SP 没有非常正式的输出。UDF 具有更强大的元数据。使用 SP 可以做的最好的事情（它仍然是命中的）是 SET FMT_ONLY ON，并执行它并希望它不使用任何扩展存储过程......

# php - IIS7 + PHP + Zend - 不执行 <= *pic*

> ID：568402
> 
> 赞同：0
> 
> 时间：2009-02-20T05:30:44.050
> 
> 标签：php, zend-framework, iis, rewrite

我已经安装了 PHP、IIS7、IIS 和 Zend 的重写模块。

我可以很好地执行 PHP 页面，甚至显示 PHPINFO。

我在 IIS 上设置了一个 Zend 快速入门应用程序，当我打开它时，我看到的是：

您可以从源代码中看到它没有执行 <= 部分。

知道需要改变什么吗？

[替代文字 http://www.gonrad.com/200902/zendiis.jpg](http://www.gonrad.com/200902/zendiis.jpg)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T12:20:06.517

您需要在 php.ini 中启用短标签：

```
short_opentag = on 
```

然而，即使 Zend 的示例使用 open 标记，为了可移植性，您确实应该使用完整的 echo 语句，因为并非所有 webhosts 都允许 short_opentag。短标签可能会节省一些打字时间，但从长远来看实际上可能会更糟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T05:34:42.123

确保 <? 已启用，而不仅仅是 <?php

如果你使用 <?

php.ini --->short_opentag=开启

# wpf - 处理 WPF 窗口的正确方法是什么？

> ID：568408
> 
> 赞同：57
> 
> 时间：2009-02-20T05:33:59.097
> 
> 标签：wpf, window

我有一个 WPF 窗口，我通过调用从另一个窗口创建`Show()`它，然后让它`Close()`自己运行。当窗口关闭时，我预计它会死掉，调用它的析构函数，并删除它的所有子元素（例如计时器..）。

调用此类操作的正确方法是什么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-20T05:50:09.057

`Close()`释放所有非托管资源，并关闭所有拥有`Window`的资源。

您需要确定性处置的任何其他托管资源都应从[Closed](http://msdn.microsoft.com/en-us/library/system.windows.window.closed.aspx)事件中处理。

[参考](http://msdn.microsoft.com/en-us/library/system.windows.window.close.aspx)

（注意：删除了之前的答案，这是一个完全错误的猜测）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-20T10:25:46.683

与 Windows 窗体不同，实际上需要显式释放的 WPF 元素很少。

对于 Window，调用 Close() 足以根据[文档](http://msdn.microsoft.com/en-us/library/system.windows.window.close.aspx)处理所有托管和非托管资源。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-08-07T19:18:00.287

以防万一，我会加两分钱。

我的问题是我没有做足够的故障排除。我的窗口是一个可以打开、关闭和重新打开的子窗口，所以我添加了以下内容以防止它完全关闭：

```
private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e) {
  e.Cancel = true;
  this.Hide();
} 
```

但是，当调用 Window.Close 时，它​​只隐藏了窗口。我最终赶上了并添加了以下内容：

```
private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e) {
  e.Cancel = true;
  this.Hide();
}

public void Close() {
  this.Closing -= Window_Closing;
  //Add closing logic here.
  base.Close();
} 
```

这很好 - 它删除了阻止窗口关闭的事件处理程序，然后将其关闭。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T14:44:30.633

关闭窗口并确信您已向其释放所有资源及其任何子级将导致逻辑​​树中所有表现良好的元素被垃圾收集。

我说“表现良好”是因为理论上可以有一个元素来执行诸如创建一个未正确停止的线程之类的操作，但实际上，如果您使用的是基本的 WPF 框架和编写良好的控件，那么您应该可以只是释放一切。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-21T12:49:47.540

关于持有的资源`Window`，根据[文档](https://docs.microsoft.com/en-us/dotnet/api/system.windows.window.close?redirectedfrom=MSDN&view=net-5.0#remarks)：

（重点补充）

> 关闭窗口会引发 Closing 事件。如果未取消 Closing 事件，则会发生以下情况：
> 
> 1.  Window 将从 Application.Windows 中删除（如果存在 Application 对象）。
>     
>     
> 2.  如果在显示拥有的窗口之前和打开所有者窗口之后建立了所有者/拥有关系，则从所有者窗口中删除窗口。
>     
>     
> 3.  引发 Closed 事件。
>     
>     
> 4.  **释放由 Window 创建的非托管资源。**
>     
>     
> 5.  如果调用 ShowDialog 来显示窗口，则 ShowDialog 返回。

我相信这是按顺序列出的。

* * *

我不确定计时器子问题的具体情况；我认为这个问题没有足够的细节来真正回答这个问题。

# asp.net - 验证 ASP.NET MVC 中动态创建的字段

> ID：568412
> 
> 赞同：1
> 
> 时间：2009-02-20T05:36:31.557
> 
> 标签：asp.net, asp.net-mvc

我在 ASP.NET MVC 视图中有以下表单：

```
<%= Html.ValidationSummary() %>
<% var fields = ViewData.Model; %>
<% using (Html.BeginForm("Dynamic", "Candidate")) { %>
    <% foreach (var field in fields) { %>
       <label for="<%= field.FieldName %>"><%= field.FieldName %></label>
       <%= Html.TextBox(field.FieldName, field.Value, new { @class = "short" }) %>
    <% } %>    
    <a class="button green" onclick="$('form').submit(); return false;">Submit</a>
<% } %> 
```

我有一个单独的控制器动作来加载这个表单并接受帖子，它看起来像这样：

```
public ActionResult Dynamic() {

    var fields = DataProvider.Candidates.GetAllDynamicFields();

    if (Request.HttpMethod == "POST") {
        fields.ForEach(f => f.Value = Request[f.FieldName]);
        var validation = DataProvider.Candidates.SaveDynamicFields(fields);
        if (validation.IsValid)
            return RedirectToAction("Index");
        ViewData.ModelState.AddErrorsFromValidationResult(validation);
    }

    return View(fields);
} 
```

我的问题是，如果任何验证器失败（即验证对象包含错误），那么我会在视图渲染时收到错误，因为 ViewData.ModelState 不包含任何键。我在哪里错了？有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T06:21:46.703

弄清楚了。ViewData.ModelState 由响应对象中的参数填充。因此，对于动态创建的表单，您不知道帖子中传递的确切内容。所以我只是动态地重新创建我的 ModelState：

```
fields.ForEach(f => ViewData.ModelState.Add(f.FieldName ... 
```

然后我们都很好......当在视图上运行验证时，它可以找到 ModelState 中的所有键，没有例外......就像一个魅力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-17T16:03:52.197

[Asp.Net C# MVC 动态表单（更改 Dom 结构并在服务器上获取数据）](https://stackoverflow.com/questions/2300574/asp-net-c-mvc-dynamic-forms-changing-dom-structure-and-getting-data-on-the-serv)

# algorithm - 2/3D 几何：如何以最佳方式对齐两个点列表

> ID：568414
> 
> 赞同：3
> 
> 时间：2009-02-20T05:36:49.060
> 
> 标签：algorithm, geometry, matching

我要解决的问题如下：给定两个包含点的长度相等的列表，找到一个使对之间的距离总和最小化的映射。我尝试这样做的原因是为我正在构建的遗传算法找到两个多边形中最近的点，理想情况下，这将根据该计算的输出排列两个基因以最大化空间相似性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T05:42:48.687

这被称为[线性分配问题](http://en.wikipedia.org/wiki/Assignment_problem)。[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)是解决它的一种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T06:18:32.890

几天前我实际上[在这里](https://stackoverflow.com/questions/550557/need-better-algorithm-for-finding-mapping-between-2-sets-of-points-with-minimum-d)问了基本相同的问题。有很多很好的链接可以解释可能的解决方案，包括模拟退火。

# mfc - （SHLWAPI.DLL）：0xC00000FD：堆栈溢出

> ID：568419
> 
> 赞同：1
> 
> 时间：2009-02-20T05:40:06.117
> 
> 标签：mfc

我有一个 SDI 应用程序 Vc++6.0。我正在使用 ShellExecute 函数从 MDI 应用程序运行此应用程序。当 SDI 应用程序运行时，它会打开一个 ODBC 对话框，如果用户单击 HELP 按钮，应用程序将终止。我使用 SPY++ 检查并得到以下应用程序终止原因

(SHLWAPI.DLL)：0xC00000FD：堆栈溢出。

为什么会出现这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T07:10:15.573

您可以尝试[在 Visual C++ 应用程序中捕获堆栈溢出](http://support.microsoft.com/kb/315937)以：

*   克服第一个堆栈溢出
*   分析它何时发生（它是否在第一次发生后发生了几次？）

可以使用Microsoft Visual C++ 中的`__try`and关键字捕获此异常`__except`

```
 __try
    {
        StackOverflow(0);
    }
    __except (EXCEPTION_EXECUTE_HANDLER)
    {
        printf("Exception handler %lX\n", _exception_code()); 
        Sleep(2000);
    } 
```

本文的其余部分解释了如何处理后续的堆栈溢出，而不会引发访问冲突异常。

# vb.net - VB.NET 表单在设计时表现得很奇怪

> ID：568429
> 
> 赞同：2
> 
> 时间：2009-02-20T05:47:38.830
> 
> 标签：vb.net, forms

我正在使用 VB.NET 2008 进行开发。我的一个主机崩溃了，所以我拿走了文件并在另一台主机上继续开发。但是现在发生了一些奇怪的事情：所有框架、线条和形状在设计时都消失了，但在运行时正常可见。请参阅随附的屏幕截图（上为设计时，下为运行时）。 [http://gomidjets.com/forms.JPG](http://gomidjets.com/forms.JPG)

我该如何解决？

### 更新：

形状是`GroupBox`和`LineShape`。`LineShape`确实是“VisualBasic PowerPack”的一部分。

如果我尝试添加线条形状，它会被添加但在设计器中不可见，而在运行时可见。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-08-02T00:27:37.033

如果我是你，我肯定会检查 zorder。作为最后的手段，将控件从 groupbox 中取出并重新创建 groupbox。此外，如果您在另一个窗体上添加一个组框或一个线形控件，它是否有效？如果他们这样做，你应该检查你的代码

# wcf - 如何检测等待异步 wcf 调用？

> ID：568439
> 
> 赞同：3
> 
> 时间：2009-02-20T05:50:56.093
> 
> 标签：wcf, silverlight, user-interface, asynchronous, silverlight-2.0

我从 silverlight 应用程序调用 WCF 服务。我正在异步执行此操作，并且在进行异步后我不会阻止执行。调用（这意味着，我没有使用[此页面](https://stackoverflow.com/questions/314433/how-do-you-wait-join-on-a-wcf-web-service-called-from-silverlight)的等待加入机制）。我不希望流程被阻塞。

但是，我想检测到 WCF 调用已进入等待状态，以便我可以在 UI 上显示一个忙碌的图标 - 一种指示 UI 后面正在发生的事情的视觉通信。

我可以更改我的代码，以便我可以开始为忙碌图标设置动画，并在异步调用完成时停止该动画。

但是，这是很多样板代码，并且随着在整个客户端代码中进行的调用越来越多，这只会变得更加混乱。

那么，是否有任何由 wcf 服务客户端参考代码公开的方法或属性可用于在任何异步 wcf 服务调用进入等待状态时触发事件，同样，当所有异步 wcf 服务调用完成时触发事件?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T09:23:57.440

生成的客户端引用类上没有可用于标识对 Silverlight WCF 服务方法的异步调用*当前正在进行*的属性或事件。不过，您可以使用简单的布尔变量自己记录这一点，或者使用您提到的在这种情况下要避免的阻塞线程同步。

下面是一个示例，说明如何使用[Silverlight ProgressBar 控件](http://msdn.microsoft.com/en-us/library/system.windows.controls.progressbar(VS.95).aspx#Mtps_DropDownFilterText)来指示正在等待/处理对一个非常简单的 Silverlight Web 服务的调用：

页面.xaml：

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="100">

    <StackPanel x:Name="LayoutRoot" Background="White">
        <Button x:Name="ButtonDoWork" Content="Do Work"
                Click="ButtonDoWork_Click"
                Height="32" Width="100" Margin="0,20,0,0" />
        <ProgressBar x:Name="ProgressBarWorking"
                     Height="10" Width="200" Margin="0,20,0,0" />
    </StackPanel>
</UserControl> 
```

页面.xaml.cs：

```
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using SilverlightApplication1.ServiceReference1;

namespace SilverlightApplication1
{
    public partial class Page : UserControl
    {
        public bool IsWorking
        {
            get { return ProgressBarWorking.IsIndeterminate; }
            set { ProgressBarWorking.IsIndeterminate = value; }
        }

        public Page()
        {
            InitializeComponent();
        }

        private void ButtonDoWork_Click(object sender, RoutedEventArgs e)
        {
            Service1Client client = new Service1Client();
            client.DoWorkCompleted += OnClientDoWorkCompleted;
            client.DoWorkAsync();

            this.IsWorking = true;
        }

        private void OnClientDoWorkCompleted(object sender, AsyncCompletedEventArgs e)
        {
            this.IsWorking = false;
        }
    }
} 
```

在对 DoWork 的异步调用之后将 IsIndeterminate 设置为 true 会使进度条像这样不确定地动画：

[替代文字 http://www.freeimagehosting.net/uploads/89620987f0.png](http://www.freeimagehosting.net/uploads/89620987f0.png)

因为对 OnClientDoWorkCompleted 的回调发生在 UI 线程上，所以可以在方法主体中将 IsIndeterminate 属性的值改回 false；由于工作/等待现已完成，这将再次导致非动画空白 ProgressBar。

下面是 Web 服务的代码和上述代码异步调用的 DoWork 方法，它通过休眠 5 秒来模拟一些长时间运行的任务：

```
using System;
using System.ServiceModel;
using System.ServiceModel.Activation;
using System.Threading;

namespace SilverlightApplication1.Web
{
    [ServiceContract(Namespace = "")]
    [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
    public class Service1
    {
        [OperationContract]
        public void DoWork()
        {
            Thread.Sleep(TimeSpan.FromSeconds(5.0));
            return;
        }
    }
} 
```

# user-interface - 不同的 GUI 工具包和语言绑定之间有什么区别？

> ID：568441
> 
> 赞同：5
> 
> 时间：2009-02-20T05:51:17.807
> 
> 标签：user-interface, language-agnostic

据我所知，所有的 GUI 工具包都基本相同。

*   它们都有某种基础*Widget*，可以绘制的所有其他东西都继承自该 Widget。
*   它们都有基本相同的小部件——窗口、滚动条、按钮、对话框、文件选择器、绘图区、菜单、容器等。
*   它们都使用带有“主循环”的事件驱动架构，通过应用程序注册的回调来响应用户事件。
*   大多数都有某种“GUI-builder”程序（用于 GTK+ 的 ala Glade）。

据我所知，大多数语言绑定到每个单独的工具包或多或少都是 API 的字面翻译。这让我觉得任何编程语言都和其他语言一样高效。

一些工具包自称不仅仅是一个 GUI 工具包，而是一个“应用程序框架”，例如 wxWidgets。他们为网络、数据结构、日志记录、线程和数据库访问等其他内容添加了 API。考虑到大多数其他东西通常都有更好的库来访问您需要的功能，似乎在决定工具包之间并不特别重要。事实上，如果你知道你已经掌握了这些东西，那么选择一个简单的工具包并知道它*只是*一个 GUI 工具包，比如 GTK+ 或 FLTK，将是有益的。

是否有与这个模具完全不同的 GUI 库？

作为试图闯入 GUI 编程的人，您会建议如何在 GUI 工具包之间进行选择 - 或者这真的很重要吗？对于开发 GUI 应用程序来说，哪种编程语言往往最容易——还是我应该坚持我所知道的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T06:47:36.550

您正在编写这个问题，就好像您从未使用过这些工具包一样。我不确定这里的实际问题是什么。你用过 Swing 吗？这看起来是否与 .NET WinForms API 的生产力水平相同？真的，说任何关于这些的任何事情都会导致一场激烈的战争或一系列的反对票。有区别。当然，有很多相似之处。其中很多与您在事件驱动的 GUI 编程环境中所需的许多基本结构有关，例如消息循环。当然，可能还有许多其他方法可以做到这一点，但这是一种行之有效的方法。

我不知道有任何“彻底”的突破。我所知道的用于通用 GUI 应用程序的最不同的 GUI 库可能来自 REBOL 及其 VIEW：

[http://www.rebol.com/docs/view-guide.html](http://www.rebol.com/docs/view-guide.html)

然而，实际上它并没有“根本”不同。

生产力的一大差异是这些不同工具包的工具具有非常不同的成熟度。你有点问两个问题。一个问题更具理论性：“这些工具包中是否有任何*根本*不同？” 另一个是关于**生产力**的，那就是“各种工具包的生产力水平是否不同？” 第一个问题非常值得商榷。第二个问题有明确的答案：是的。

有很多问题要问。首先，您将使用什么编程语言或平台？您是否需要移植到 Windows、Mac OS X 和 Linux 等不同平台？只是 Windows 还是 Linux？显然，您不想在 Linux 上使用 WinForms（如果有人想学究气，也不想使用 Gnome/KDE）。您可以在 Windows 上使用 GTK+，但“小部件”的外观与原生 Windows 工具包提供的外观和感觉不同。您可以选择 Swing，但它实际上只在 Java 中可用，并且有其自身的问题。我个人认为 Swing 的生产力水平不高。我认为必须添加所有这些“适配器”和连接所有这些“布局”工具并没有那么高效。不过有些人会。

另一个方面是您选择的工具包拥有的内置小部件的选择以及第三方免费和商业小部件中的选择是什么。如果您选择一个更晦涩的工具包，您将不会有那么多奇特的小部件可供选择。例如，您会发现一个用于 .NET WinForms 的 Mac OS X 风格的“停靠”小部件，可能还有其他一些小部件，但可能不在 GTK+ 中（实际上，它可能存在于那里，但这只是示例）。

所以，简而言之，我不认为你真的可以说所有的 GUI 工具包都是可以互换的。除了它们是否具有基本小部件和消息循环之外，还有许多其他问题需要考虑。

# cocoa - pyobjc 中的 NSThread 或 pythons 的线程模块？

> ID：568444
> 
> 赞同：4
> 
> 时间：2009-02-20T05:53:14.637
> 
> 标签：cocoa, pyobjc

我需要做一些网络绑定调用（例如，获取一个网站），我不希望它阻塞 UI。如果我在 pyobjc 中工作，我应该使用 NSThread 还是 python 的线程模块？我找不到任何有关如何选择其中一个的信息。请注意，我并不真正关心 Python 的 GIL，因为我的任务根本不受 CPU 限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T06:02:54.393

没有区别，您将获得相同的行为，但界面略有不同。使用最适合您的系统的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-05T15:56:31.723

我有一个不同的建议，主要是因为 GIL（全局解释器锁）导致 python 线程非常糟糕，尤其是当你有多个 cpu 内核时。有一个视频演示非常详细，但我现在找不到视频 - 它是由 Google 员工完成的。

无论如何，您可能想考虑使用子进程模块而不是线程（有一个可以执行的帮助程序，或者在系统上使用另一个二进制文件。或者使用 NSThread，它应该给你比 CPython 获得的性能更高的性能线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T13:18:51.587

学会爱上运行循环。使用[Cocoa 的 URL 加载系统](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/)（或者，如果您需要普通套接字，则[NSFileHandle](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html)）并让它在响应（或失败）返回时调用您。然后您根本不必处理线程（URL 加载系统将为您使用线程）。

几乎在 Cocoa 中创建自己的线程的唯一时间是当您有一个无法中断的大任务（>0.1 秒）时。

（有人可能会说 NSOperation，但是[NSOperationQueue 坏了](http://www.mikeash.com/?page=pyblog/dont-use-nsoperationqueue.html)，[RAOperationQueue](http://www.rogueamoeba.com/utm/2008/12/01/raoperationqueue-an-open-source-replacement-for-nsoperationqueue/)不支持并发操作。如果你已经有一堆 NSOperationQueue 代码或者真的想为工作 NSOperationQueue 做准备，但是如果你现在需要并发，运行循环或线程。 )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-26T00:05:36.753

我更喜欢原生 python 线程解决方案，因为我可以加入和引用线程。AFAIK, `NSThread`s 不支持线程加入和取消，您可以使用 python 线程完成各种事情。

此外，`NSThread`s 不能有多个参数，这很糟糕，尽管有解决方法（比如使用`NSDictionary`s 和`NSArray`s），但它仍然不像调用具有按顺序排列的参数/对应参数的线程那样优雅和简单.

但是，是的，如果情况要求您使用`NSThread`s，则根本不应该有任何问题。否则，坚持使用本机 python 线程很酷。

# flash - Flash：请问这个事件名称的硬编码在哪里？

> ID：568447
> 
> 赞同：1
> 
> 时间：2009-02-20T05:55:14.990
> 
> 标签：flash, transitions

我对我在网上找到的这样的代码感到非常不舒服

```
myTM.addEventListener("allTransitionsInDone", doneTrans); 
```

（myTM 是一个 TransitionManager 实例。）**当非运动转换（如淡入淡出）完成时，触发事件的正确方法是什么？**我通常使用`Event.EVENT_NAME`，但这个没有出现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T06:20:21.857

事件名称的常量是按照约定在事件类型上定义的，例如，“mouseDown”事件是 MouseEvent.MOUSE_DOWN。

但是，“allTransitionsInDone”实际上没有常数，因为它（有点，参见[livedocs](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/transitions/TransitionManager.html#eventSummary)上的评论）没有记录。因此没有 .ALL_TRANSITIONS_IN_DONE 常量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T03:20:51.627

添加到西蒙的回答中，如果您想避免“松散引用”的事件名称并定义自己的事件名称，这里有一些使用这些传统方法的不同建议：

**1\. 创建自定义事件子类 flash.events.Event**

可能是最传统和最明显的方式，尽管有点浪费代码。

```
package transitions.events 
{
    import flash.events.Event;

    public class MyTransitionEvent extends Event 
    {

        public static const TRANSITION_INIT : String = "events.TransitionEvent.transitionInit";
        public static const TRANSITION_PROGRESS : String = "events.TransitionEvent.transitionProgress";
        public static const TRANSITION_COMPLETE : String = "events.TransitionEvent.transitionComplete";

        public function MyTransitionEvent(type : String, bubbles : Boolean, cancelable : Boolean)
        {
            super(type, bubbles, cancelable);
        }

        override public function clone() : Event
        {
            return new TransitionEvent(type, bubbles, cancelable);
        }
    }
} 
```

**2\. 将事件名称定义为事件调度程序中的静态常量（例如 Sprite 或 MovieClip 的子类）**

为了使事情更清楚，事件类型应该专门从事件被调度的类中定义。

```
package  
{
    import flash.events.Event;
    import flash.events.EventDispatcher;        

    public class Transition extends EventDispatcher
    {

        public static const TRANSITION_INIT : String = "events.TransitionEvent.transitionInit";
        public static const TRANSITION_UPDATE : String = "events.TransitionEvent.transitionUpdate";
        public static const TRANSITION_COMPLETE : String = "events.TransitionEvent.transitionComplete";

        public function Transition()
        {
        }

        private function init() : void
        {
            dispatchEvent(new Event(TRANSITION_INIT))
        }
    }
} 
```

**3.复用原生的flash.events**

幸运的是，预定义的事件（即*flash.events.Event*、*flash.events.StatusEvent*、*flash.events.NetStatusEvent*等）涵盖了大多数可能的情况。因此，为了不重新发明轮子并节省一些宝贵的代码行，如果您找到符合您要求的代码，只需重用它即可。

```
package  
{
    import flash.events.Event;
    import flash.events.EventDispatcher;    

    public class Transition extends EventDispatcher
    {

        public function Transition()
        {
        }

        private function init() : void
        {
            dispatchEvent(new Event(Event.INIT));
        }

        private function change():void
        {
            dispatchEvent(new Event(Event.CHANGE));
        }

        private function complete():void
        {
            dispatchEvent(new Event(Event.COMPLETE));
        }
    }
} 
```

# oop - 设计适当的类

> ID：568449
> 
> 赞同：5
> 
> 时间：2009-02-20T05:55:59.403
> 
> 标签：oop

我已经阅读了所有关于为什么要创建类的书籍以及诸如“在您的要求中查找名词”之类的书籍，但这似乎还不够。我的课在我看来很乱。我想知道是否有某种指标或可以比较我的课程的东西，看看是否设计得很好。如果不是，谁是最受尊敬的 OO 大师，我可以从中获得正确的类设计技巧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T06:08:45.770

创建开始干净然后变得混乱的类是 OO 的核心部分，那就是重构的时候。许多开发人员试图从一开始就跳到完美的类设计，根据我的经验，这是不可能的，相反，你会四处走动，解决问题，然后重构。随着设计的出现，您可以收获基类和接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T06:06:42.730

如果您熟悉数据库设计，特别是规范化的概念，那么答案很简单：以数据为中心的类应该以第三范式表示实体

如果这没有帮助，请尝试以下操作：

*   类是数据元素和对它们进行操作的方法的集合
*   一个类应该有一个单一的责任，即它应该代表你模型中的一件事；如果它代表不止一件事，那么它应该不止一个类。
*   一个类中的所有数据元素都应该在逻辑上相互关联/相关；如果不是，请将其分成两个或更多类
*   一个类中的所有方法都应该只对它们的输入参数和类的数据元素进行操作——参见得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_Of_Demeter)

这就是我所能提供的一般抽象建议（无需写长篇论文）；如果您需要具体建议，您可以发布您的一门课程以供批评

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T06:14:18.923

尝试关注行为而不是结构。对象是具有行为和责任的“活”实体。你告诉他们做事。查看 CRC-card 方法来帮助您以这种方式建模。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T06:05:19.863

我认为对象设计既是科学又是艺术。理解如何设计干净优雅的课程需要时间和实践。也许如果你可以举一个你设计的简单类的例子，你对 SO 用户不满意可以批评和指点。我不确定除了您在文本中已经阅读的内容之外还有任何一般性的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T06:06:12.873

我个人认识的最受尊敬的 OO 大师是 StackOverflow。把你的班级名字放在这里，我想你会得到很多评论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T06:06:47.630

类通常用于对问题域的概念进行建模。一旦你有一个明确定义的问题（也就是一组用例），你将能够识别所有参与者。一部分参与者将是您正在设计的系统所固有的。从一个大黑匣子开始作为您的系统。当你有更多信息时，继续分解它。当你的水平不再能被分解（分解成你的问题域中的概念）时，你就开始学习你的课程了。

但是，这是非大师的主观看法。我建议在菜单上加一点盐。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T06:13:04.057

指标？并非如此，你会相信他们。

您的课程是否正在完成让程序正常工作并通过多次修订保持其可维护性的工作？

如果是，那么你做得很好。

如果不是，问问自己为什么不这样做，然后改变什么不起作用。

# sql - 当我们在网页中使用 where 子句时，如何在 where 子句中输入？

> ID：568450
> 
> 赞同：0
> 
> 时间：2009-02-20T05:57:07.887
> 
> 标签：sql, html, database, jsp

根据用户的输入，我想从数据库中选择记录。这是我的代码：

```
<%
String jempid=request.getParameter("empid");
out.println(jempid);
int intempid=1223;
Connection conn=null;
String url="jdbc:mysql://localhost/employees";
Class.forName("com.mysql.jdbc.Driver").newInstance();
conn=DriverManager.getConnection(url,"root","");
Statement st=conn.createStatement();
ResultSet rs=st.executeQuery("select * from empdetails where empnum=jempid");
%> 
```

它抛出以下错误

> javax.servlet.ServletException：java.sql.SQLException：'where 子句中的未知列'jempid'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T06:11:11.847

使用字符串连接构造 SQL 是个坏主意——你只是在向 SQL 注入攻击敞开大门——特别是考虑到你直接从请求中获取“empid”的值。哎呀！

更好的方法是使用参数化查询，如下所示：

```
PreparedStatement st=conn.prepareStatement("select * from empdetails where empnum=?");
st.setString(1, jempid);
ResultSet rs=st.executeQuery(); 
```

此外，您应该检查 jempid 是否为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T06:01:32.150

这是您的选择声明：

```
select * from empdetails where empnum=jempid 
```

jempid 是硬编码的，而不是用作变量。除非您将其更改为客户输入的变量值，否则这永远不会起作用。

改为：

```
"select * from empdetails where empnum=" + CleanseUserInput(jempid) 
```

你可以走了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T06:01:14.773

看起来jsp页面中的代码太多了....说：

```
... empnum='"+jempid+"');" ...... 
```

而且当你完成后，一定要关闭数据库

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-01T13:18:38.667

是的，有时它会引发未知列的错误，例如我们有台式自行车

假设我们有一个查询，例如**select * from bikes where bikename=hayabusa;**

如果你点击这个查询，它可能会抛出一个类似未知列的错误，所以你应该注意的最好的事情是引用你在**where**子句中给出的值，所以正确的方法是**select * from bikes where bikename='hayabusa' ;**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T06:01:17.127

尝试这个：

```
ResultSet rs=st.executeQuery(
    "select * from empdetails where empnum=" + jempid); 
```

您需要将 jempid 的**值**放入字符串，而不是**文本**“jempid”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T06:18:32.673

与其他响应相比，为什么不使用 PreparedStatement？

基本上，您必须像这样编写代码：

```
PreparedStatement st=conn.prepareStatement("select * from empdetails where empnum=?");
st.setString(1, jempId);
ResultSet rs=st.executeQuery(); 
```

您应该使用 PreparedStatements 的原因是[SQL 注入](http://en.wikipedia.org/wiki/SQL_Injection)问题。例如，使用您在问题中发布的代码，黑客始终可以在您选择 jempid 的文本框中键入“1;delete * from empdetails”。

因此形成的最终查询将是

```
select * from empdetails where empnum=1;delete * from empdetails 
```

这将导致 empdetails 中的所有数据都被删除。

所以总是使用 PreparedStatements！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T06:04:21.787

```
ResultSet 
  rs=st.executeQuery("select * from empdetails where empnum=" + jempid + ";") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T06:06:12.110

```
"select * from empdetails where empnum="+jempid 
```

但是你真的想保护它免受 SQL 注入！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-22T05:45:30.593

`where`应该在`" "`. 像这样：

```
"select * from empdetails where empnum = "jempid"; 
```

因此这应该工作：

```
ResultSet rs = st.executeQuery("select * from empdetails where empnum=" +"'"+ jempid+"'"); 
```

# iphone - 如何使用按钮操作（xcode）调用屏幕？

> ID：568464
> 
> 赞同：2
> 
> 时间：2009-02-20T06:03:13.567
> 
> 标签：iphone, objective-c, cocoa-touch

我正在为 iPhone 开发一个基于窗口的应用程序。我使用界面生成器来构建界面。我想用按钮操作调用一个新屏幕。如何使用 Button 操作调用屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T06:35:48.137

通过将新控制器推到窗口堆栈的顶部。例如：

```
EnterNameController *newEnterNameController = [[EnterNameController alloc] initWithNibName:@"EnterName" bundle:[NSBundle mainBundle]];
[[self navigationController] pushViewController:newEnterNameController animated:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T07:22:23.517

Apple 有大量的示例代码，只需访问 Apple 的 iPhone 开发网站即可轻松解决这个问题（以及许多其他问题）。 [iPhone 开发网站](http://developer.apple.com/iphone)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T20:04:27.057

如果您使用的是导航控制器，请按照 alamodey 的建议将其推送到导航控制器的堆栈中。

如果您希望它成为模态控制器（即从底部向上滑动并覆盖前一个控制器的视图，如 Safari 中的书签屏幕），请将其呈现为模态视图控制器：

```
[self presentModalViewController:myNewController animated:YES]; 
```

当您想恢复旧控制器时，请关闭模态视图控制器。从模态视图控制器内部：

```
[self.parentViewController dismissModalViewControllerAnimated:YES]; 
```

如果您不想这样做，只需从窗口中删除当前控制器的视图并添加新控制器的：

```
UIView * containingView = self.view.superview;
[self.view removeFromSuperview];
[containingView addSubview:myNewController.view]; 
```

如果您走这条路，您可能需要查看 +[UIView beginAnimations:context:]、+[UIView setAnimationTransition:onView:] 和 +[UIView commitAnimations]（如果我没记错方法名称——请查看文档）动画过渡。您应该几乎总是为 iPhone OS 中屏幕之间的任何切换设置动画。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-05T06:25:21.890

（在.m类工作）

```
#import "classtocall.h"
- (IBAction)ButtonPressed:(id)sender 
{
classtocall *mvc = [[classtocall alloc]initWithNibName:@"classtocall" bundle:nil];
[self presentModalViewController:mvc animated:NO];
} 
```

（对于基于窗口的应用程序）在 .h 类中定义

```
- (IBAction)ButtonPressed:(id)sender; 
```

其中“classtocall”是您要调用的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-16T08:53:36.403

您只需要从 XCode 帮助中下载示例应用程序。试试 Elements 和 UIcatalog。在帮助和下载示例中还有其他类型的“pushViewController”或“addSubview”和“makeKeyAndVisible”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-12T16:51:54.293

```
nextscreenViewController *login = [[self storyboard] instantiateViewControllerWithIdentifier:@"nextscreenidentifier"];

nextscreenidentifier.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;

[self presentModalViewController: nextscreenidentifier animated: YES]; 
```

# c# - 替换 DataGridView 中的 DateTime.MinValue

> ID：568483
> 
> 赞同：9
> 
> 时间：2009-02-20T06:11:32.610
> 
> 标签：c#, datetime, sqlite, datagridview

我正在开发一个姓名记录应用程序，信息存储在 SQLite 数据库中。数据库中的所有列都是 TEXT 类型，但出生日期列除外，它是 DATETIME。我转移到 SQLite 数据库的原始 Access 数据库允许出生日期为空值，因此当我复制它时，我将所有空值设置为 DateTime.MinValue。

在我的应用程序中，出生日期列的格式如下：

```
DataGridViewTextBoxColumn dateOfBirth = new DataGridViewTextBoxColumn();
        dateOfBirth.HeaderText = "DOB";
        dateOfBirth.DataPropertyName = "DateOfBirth";
        dateOfBirth.Width = 75;
        dateOfBirth.DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter;
        dateOfBirth.DefaultCellStyle.Format = "MM/dd/yyyy"; 
```

我的问题是没有出生日期的行，数据库有 DateTime.MinValue，它在我的 DataGridView 中显示为 01/01/0001。

我正在寻找一种在我的 DataGridView 中用空字符串 ("") 替换 01/01/0001 的方法。

```
private void resultsGrid_DateFormatting(object sender, System.Windows.Forms.DataGridViewCellFormattingEventArgs e)
    {
        if(resultsGrid.Columns[e.ColumnIndex].Name.Equals("DateOfBirth"))
        {
            if ((DateTime)(resultsGrid.CurrentRow.Cells["DateOfBirth"].Value) == DateTime.MinValue)
            {
                 // Set cell value to ""
            }
        }
    } 
```

有人知道如何用空字符串替换 DataGridView 中的 DateTime.MinValue 吗？谢谢！

编辑：使用 DateTime 转换单元格值允许我必须工作的 if 语句，但我仍然无法弄清楚用空白字符串替换 MinValues 的编码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T06:17:36.230

您只需要将其转换为 DateTime

```
if ((DateTime)(resultsGrid.CurrentRow.Cells["DateOfBirth"].Value) == DateTime.MinValue)
            {
                 // Set cell value to ""
            } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T20:28:52.160

我发现了为什么`DateTime.MinValue`显示！

单元格格式部分中的这一行导致“01/01/0001”的 MinValue 显示：

```
dateOfBirth.DefaultCellStyle.Format = "MM/dd/yyyy"; 
```

如果没有这一行，我的“出生日期”字段`datagridview`将留空。

Barbaros Alp 关于我当时想做的事情仍然是正确的。谢谢大家！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-12-12T16:01:39.510

使用 nullabe DateTime 格式而不是 DateTime ("DateTime?") - 不要使用字符串。

例子：

```
public DateTime? mydate; 
```

进而：

```
DGview.Rows.Add(mydate.HasValue ? mydate : null); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-20T06:28:16.953

虽然实现所需的转换可能非常简单（请参阅我之前的出色答案），但我认为理想情况下，您应该将数据库中此特定列中的所有 DateTime.MinValue 值替换为`NULL`. 这将正确地表示该位置实际缺少数据。目前您的数据库包含*不正确*的数据，您正在尝试对数据进行后处理以供显示。

因此，您将能够使用`EmptyDataText`或`NullDisplayText`属性来处理 GridView 中的数据显示，以提供适当的呈现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T06:18:44.513

```
if (yourDateOfBirth != null)
{
    Convert.ToDate(yourDateOfBirth) == DateTime.MinValue
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T06:18:59.253

您可以将对象转换为 DateTime 对象：

```
//create a nullable intermediate variable
System.DateTime? dtCellValue = resultsGrid.CurrentRow.Cells["DateOfBirth"].Value as System.DateTime?;

//if this cell has been set to String.Emtpy the cast will fail
//so ensure the intermediate variable isn't null
if ( dtCellValue.HasValue && dtCellValue == System.DateTime.MinValue )
//set cell value appropriately 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T06:19:21.423

```
private void resultsGrid_DateFormatting(object sender, System.Windows.Forms.DataGridViewCellFormattingEventArgs e)
{
    if(resultsGrid.Columns[e.ColumnIndex].Name.Equals("DateOfBirth"))
{
    if ((string)resultsGrid.CurrentRow.Cells["DateOfBirth"].Value == DateTime.MinValue.ToString())
    {
         // Set cell value to ""
    }
} 
```

}

或者您可能必须转换为 DateTime，然后与 MinValue 进行比较，但听起来您的想法是正确的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T13:47:17.790

已经有答案可以实现您想要的；但我想知道你为什么不把 NULL 放在数据库中？在 sqlite3 中，“datetime”或多或少只是一个字符串，（datetime 列没有什么特别之处，因为 sqlite3 只是类型关联，而不是类型绑定），所以你只需在该列中插入 NULL。如果您想在查询时获得日期时间的 MinValue，您可以轻松地执行如下查询

```
select coalesce(your_datetime_column,'01/01/0001') from your_table 
```

# sql - ADO.Net 同步和 SQL CE

> ID：568487
> 
> 赞同：1
> 
> 时间：2009-02-20T06:14:00.217
> 
> 标签：sql, synchronization, sql-server-ce, microsoft-sync-framework

我已经使用 VS 2008 中的本地数据库缓存项成功同步了源数据库和本地数据库。

但是，我需要直接从另一个 dll/进程中访问 SQL CE db，而不使用数据集。原因是我的业务对象代码不使用数据集。

最终的代码看起来像这样：

```
Dim conn As New SqlServerCe.SqlCeConnection("Data Source=C:\Development\UserDirectory\UserDirectory.DBSyncher\ProfDir.sdf;Persist Security Info=False;")
Dim cmd As New SqlServerCe.SqlCeCommand("Select EmailAddress from Employees Where ID=23", conn)
Dim returnString As String = ""

If conn.State = ConnectionState.Closed Then
    conn.Open()
End If
returnString = cmd.ExecuteScalar

conn.Close()
cmd = Nothing 
```

我注意到使用显示同步更改的数据集非常奇怪，但访问 CE 数据库文件直接返回旧数据 - 没有任何同步数据。

我错过了什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T06:25:22.750

弄清楚了！

忘记了 CE 正在处理中，因此它将数据库文件（.sdf）复制到 Debug 文件夹。您必须引用该数据库而不是项目中的数据库。哦！

# ubuntu - AWK - 我的正则表达式不尊重大小写

> ID：568490
> 
> 赞同：0
> 
> 时间：2009-02-20T06:14:46.177
> 
> 标签：ubuntu, awk, case-sensitive, case-insensitive, gawk

我正在运行 Ubuntu 8.04，我的代码看起来像这样......

```
 for (i=1;i<=n;i++)
 {
  if (arr[i] ~ /^[A-Z]{2,4}$/) printf(arr[i])
 } 
```

我很快发现如果没有 --posix 开关，{n} 表达式将无法在 gawk 中工作。一旦启用，表达式就可以工作，但它是不区分大小写的匹配 AAAA 和 aaaa。这里发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T10:38:06.077

表达式本身对我有用：

```
dfs:~# gawk --posix '/^[A-Z]{2,4}$/ {print "Yes"}'
AAAA
Yes
AA
Yes
TT
Yes
tt
YY
Yes
yy 
```

您的问题可能是由两件事引起的。要么您不小心设置了`IGNORECASE`awk 变量，要么以其他方式关闭了[不区分大小写的操作](http://www.gnu.org/software/gawk/manual/gawk.html#Case_002dsensitivity)（BTW`IGNORECASE`不适用于`--posix`，但可以使用`--re-interval`，这也启用了正则表达式中的大括号），或者这是语言环境整理序列的经典问题（因为 gawk 确实语言环境感知字符比较），这意味着小写字符在一些大写字符之间进行比较。[从手册的相关部分](http://www.gnu.org/software/gawk/manual/gawk.html#Character-Lists)引用：

> 许多语言环境按字典顺序对字符进行排序，在这些语言环境中，'[a-dx-z]' 通常不等同于 '[abcdxyz]'；例如，它可能等同于“[aBbCcDdxXyYz]”。要获得括号表达式的传统解释，您可以通过将 LC_ALL 环境变量设置为值“C”来使用 C 语言环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T07:57:45.053

我只安装了 mawk，但也许这就是你要找的？

for (i=1;i<=n;i++) { if (arr[i] ~ [^AZ]{2,4}$/) printf(arr[i]) }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T19:36:45.663

否则，如果您使用***GNU awk***，则可以使用*[:upper:]*字母字符类。

```
% awk '{print /[:upper:]/?"OK":"KO"}'
AA
KO
aa
KO 
```

# javascript - Javascript - 试图让我的头脑围绕自定义事件

> ID：568499
> 
> 赞同：3
> 
> 时间：2009-02-20T06:18:30.410
> 
> 标签：javascript, javascript-events

我试图了解自定义事件。我了解如何注册和触发自定义事件。但是，似乎不可能注册真正的自定义事件。一切都必须追溯到 DOM 事件，例如 click、onload、blur 等。还是我错了？

例如，假设我有一个数组。我想注册一个在数组长度更改时触发的事件。据我了解，我必须注册该事件，然后创建一个 setInterval 计时器来检查当前数组长度与先前存储的长度。如果长度发生了变化，我需要从 setInterval 内部触发我的自定义事件。

有没有办法为我的数组注册一个事件并在长度改变时自动触发它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T19:29:40.550

自定义事件在[W3C 规范](http://www.w3.org/TR/DOM-Level-3-Events/events.html#Events-CustomEvent)中，但没有一个主流浏览器支持它们。这就是为什么其他几个用户建议使用 3rd 方库的原因。Prototype、YUI、JQuery 和其他大多数都具有这些功能。你也可以[自己滚](http://www.truerwords.net/articles/web-tech/custom_events.html)。

如果您想了解一些自定义事件语法可能是什么样子，您可以查看[本教程的原型自定义事件](http://alternateidea.com/blog/articles/2006/2/8/working-with-events-in-prototype)。一些重要的点：

*   原型自定义事件必须附加到 DOM 元素，以便它们可以像原生事件一样冒泡。
*   它们必须在`prefix:event`语法中才能触发
*   它们可以包含一个非常有用的`memo`参数，该参数允许任意上下文或一组对象随事件冒泡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T06:30:31.160

你为什么不为你的数组编写一个方法 addElement ，只要你想插入元素，你就可以使用它，这样你就可以在 array.length 发生变化时编写代码。与 removeElement 相同。事件不应该用于这种事情。

# linux - 哪个 linux 发行版适合 linux 编程的新学习者？

> ID：568510
> 
> 赞同：2
> 
> 时间：2009-02-20T06:25:01.893
> 
> 标签：linux

当我想出 linux 时，我发现 OpenSuse 和 Ubuntu 中的命令是不同的。

哪个适合linux新手并想掌握命令的人

编程和使用linux时需要吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T06:30:09.803

我的印象是 OpenSuSE 做了一些非常规的事情（kdesu，gksu），但它是一个很好的（KDE）发行版。我发现 (K)Ubuntu 对初学者来说更好一些，因为它可以访问巨大的编译包存储库，[而且社区](http://ubuntuforums.org/)是无与伦比的。

它们在大多数事情上都非常相似，包括编程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T06:28:14.053

你身边的人可以问任何一个知道的问题。知识渊博的支持网络的价值远远超过特定分发的好处。如果您没有本地支持网络，我会选择 Ubuntu，他们往往在“网络”上有更多有用的资源（这是我在这两个选项中更喜欢的发行版）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T20:23:31.457

任何 Ubuntu/Slackware/Gentoo 都可以作为开发环境使用。你没有提到你对什么样的编程感兴趣，这也可能对答案有一些影响。

如果您对编写更好的代码感兴趣，我还建议您在非 Linux 系统（如 OpenBSD/FreeBSD、OpenSolaris 等）中双引导（或运行第二台计算机）。编写可跨 UNIX 系统移植的代码不仅仅是考虑到可移植性的好主意，它还可以帮助消除一些错误。使用 32 位与 64 位、大端与小端平台时也是如此。您可以以便宜的价格购买一台旧的 64 位 Sun 工作站，并用它来测试您的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-20T07:38:30.500

我现在在 Ubuntu 上运行。它比 windows 更容易运行。非常顺利。当然，高级功能现在超出了我的范围。有了 C# 类和其他一切，我放弃了尝试学习太多并按原样运行它的方法。它有一个非常好的用户界面，而且我听说新版本已经发布或即将发布，可能更吸引眼球。

查看 Ubuntu。从那时起，进行双启动就不会受到伤害，您可以尝试一下！你也可以直接从光盘上运行一些发行版来试用它们。当它是免费的时候尝试一下不会有什么坏处。对我来说比 XP 稳定得多，而且速度更快。我希望 Windows 7 最终不再是一个怪物！如果它与 Windows 程序更兼容，我会坚持使用 Ubuntu。在学校期间的 .NET 开发通常不会在 Linux 发行版上完成！

最好的祝愿，试试吧！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T06:27:00.467

我们必须更好地了解您的偏好才能回答这个问题。我猜基本上任何 LINUX 都可以。不过，我从 Ubuntu 那里听到了很好的反馈。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T06:32:55.867

实际上，作为一名程序员，您每天都会面临这样的问题。哪个框架？哪种语言？哪种数据结构？...你明白了。没有正确的答案。

选择任何一个。它们并没有太大的不同。很快你就不会成为一个“新学习者”，那么无论如何这都无关紧要了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-20T07:10:37.227

根据您想学习的深度，一个可能的候选发行版是[Linux From Scratch](http://www.linuxfromscratch.org/)。它也有很棒的文档，通过使用它肯定会让你思考更多“Linux”的方式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-20T07:23:07.807

这是一个非常难的问题；大多数发行版的目标是成为“最好的”，或者至少“足够好”以适应各种各样的活动，当然包括编程。

这也是一个容易引发“战争”的问题，人们争相声称*他们*使用的发行版是最好的，并且所有其他发行版都应该遵守。呵呵。

我目前的偏好是[Gentoo](http://www.gentoo.org/)，我认为它在编程时的一个（可能是次要的）优势是，由于它是基于源代码的发行版，您通常不需要费心去获取软件包的“开发版本”。如果您安装了例如 readline，您也将拥有它的头文件，依此类推。许多其他发行版将软件包拆分为“用户”和“开发人员”版本，因此您需要安装这两个软件包。

当然，我猜在那些情况下，开发者包无论如何都依赖于非开发者版本，所以如果你总是安装开发者版本，你就准备好了。那好吧。没关系。:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-20T20:08:52.070

我使用 Gentoo 和 Ubuntu 进行开发。

我喜欢 Gentoo，因为我可以轻松选择可用的软件包和版本。开发 Flash 9 和 10 的人也在 Gentoo 系统上进行开发。

我现在喜欢 Ubuntu，因为它非常稳定。几年后，Gentoo 安装会趋于不稳定，有时需要重建整个安装。

另一个我要看的是 Slackware。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-20T08:19:50.773

在选择 linux 发行版时，我通常会考虑两件事：

1：打包系统（及发布周期）：

Opensuse 可能拥有任何发行版中最新的软件包（无需构建您自己的软件包），但 Ubuntu 的软件包系统往往会更多地握住您的手。我都使用过，发现作为开发人员，我稍微偏爱 Opensuse，因为它更容易获得最新版本的开发包（例如 IDE）。

2：默认配置/易于管理：

所有 linux 发行版都有它们的怪癖。Opensuse 和 Ubuntu 都有很好的文档并且有很好的支持论坛。Opensuse 有 Yast，它对于大多数配置任务来说是一个不错的一站式商店。Ubuntu 在自动配置方面似乎略胜一筹。真的，任何一个发行版都可以。

* * *

好消息是，这本身并没有错误的决定。我使用了很多（超过 10 个）Linux 发行版，现在我坚持使用 Opensuse。Ubuntu 紧随其后，我不使用它的唯一原因是我发现我经常被困在等待其 6 个月的发布周期以获取最新的开发包（当时构建 monodevelop beta 是不可行的） . Opensuse 的构建服务和 Packman 第三方存储库似乎为我想要的一切保留了几乎最新的包。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-20T06:27:51.417

我更喜欢 Ubuntu。我的2美分...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-20T06:28:47.313

它们是工具。使用你最舒服的那个。真正称它们为工具并不是一个很好的类比。更好的是称它们为车辆。使用适合您的需求和愿望的车辆。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-20T06:38:53.373

不同发行版的原理大致相同，因此我建议您选择一个并深入研究。但是，需要考虑一些因素。如果您想编写 gui 程序，您需要决定使用哪个图形工具包库（Qt、Gtk+ ...），这也意味着选择您的桌面环境（GNOME、KDE、XFCE）。您会注意到，在 Linux 世界中，一切（或几乎一切）都依赖于其他东西。我说的是包裹。重用可用库而不是自己编写库是很常见的，因此您可能必须做出的决定是关于使用哪些库/框架以及使用哪种语言。

然而，我选择了 Ubuntu，一点也不感到抱歉。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-20T06:44:14.497

这取决于你想做什么。如果您想要一些易于设置并且基本上可以正常工作的东西，请使用 Ubuntu。如果你想 /learn/ Linux，我会推荐 Slackware。启动并运行 Slackware 将迫使您了解安装的方式和内容。这可能是好是坏，取决于你的愿望。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-20T15:49:37.667

Gentoo 是最容易使用的。我会去的

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-20T08:03:14.697

Ubuntu 适合构建，社区非常有帮助。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-20T08:23:25.977

如果您以程序员的身份探索 Linux/GNU，您可能会考虑选择使用[apt 打包工具](http://en.wikipedia.org/wiki/Advanced_Packaging_Tool)的发行版。

您可能需要安装大量带有开发头文件的库并获取其他东西的源代码。Apt 让做这些事情变得非常简单，它非常擅长解决包依赖和获取源包。

使用 apt（带有 .deb 或 .rpm 包）的发行版是 Debian、Ubuntu（及其分支）等。

话虽如此，Ubuntu 在跟上最新的库和工具方面做得非常好，同时抵制了挑选 alpha / 不稳定代码的冲动。我的桌面是我的开发机器，我使用 Ubuntu。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-20T06:27:39.217

我会投票给[Ubuntu](http://www.ubuntu.com/)。原则是一样的，但有些“命令”是不同的。我假设您的意思是“sudo”之类的差异。

我对处理我所有开发 Windows VM 的 Ubuntu Server 感到非常满意。我什至在我的笔记本电脑上使用了一段时间的 Ubuntu 桌面……至少在我再次需要 Visual Studio 之前。:-)

编辑 - OpenSUSE 中确实存在“sudo”

# c# - 如何安全地使用 WaitHandles 来防止死锁？

> ID：568511
> 
> 赞同：1
> 
> 时间：2009-02-20T06:25:12.733
> 
> 标签：c#, .net, asp.net, multithreading, threadpool

观察以下伪：

```
ManualResetEvent[] resetEvents = new ManualResetEvent[operations.Count];

for( int i = 0; i < operations.Count; i++ )
{
  resetEvents[i] = new ManualResetEvent(false);
  ThreadPool.QueueUserWorkItem(new WaitCallback(timeConsumingOpHandler), resetEvents[i]);
}

WaitHandle.WaitAll(resetEvents); 
```

如果在其中一个池线程中发生异常，我的 ASP.NET WebApp 就会死锁。响应流上没有传递异常信息。我正在寻求建议以防止这种情况发生。固定超时是可以接受的。假设 timeConsumingOpHandler Set()s 是 WaitHandle。

整个 timeConsumingOpHandler 被包装在一个 try-catch-finally 块中，在 finally 部分中 WaitHandle 是 Set()。尽管如此，还是会发生死锁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T12:43:29.300

你确定你陷入僵局吗？在 .NET 2.0 中，`ThreadPool` [终止进程](http://msdn.microsoft.com/en-us/library/ms228965.aspx)中未处理的异常。

您不应该`ThreadPool`在 ASP.NET 应用程序中使用。ASP.NET 本身使用`ThreadPool`to 服务请求，因此您正在竞争同一组线程。如果您必须进行异步执行，请使用异步委托。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T06:35:43.987

任何阻塞操作都是潜在的死锁。有一些方法可以最大限度地减少或几乎消除死锁发生的机会（如果您始终确保同步操作在有限的时间内完成），但在一般情况下，您不能只假设有一种安全的方法防止死锁。

超时在确保您的应用程序不会死锁方面大有帮助，但是您会遇到停顿，并且您需要以一种特殊的方式从超时中恢复。相同的程序流程不再适用。

如果您有抛出异常的线程，请检查 Visual Studio 中的“调试”>“输出”窗口，即使调试器在处理多个线程时无法中断，它似乎总是会捕获异常。

看起来您正在将工作分成单独的线程，以实现并行性。为什么在 ASP.NET 应用程序中需要这个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T15:37:41.177

您可能想查看MSDN上的一个自定义[CLR 主机，](http://msdn.microsoft.com/en-us/magazine/cc163618.aspx) [Joe Duffy](http://www.bluebytesoftware.com/blog/Default.aspx)开发该主机以提供自动死锁检测。

# c# - 如何在 DataGridView 的同一列中使用不同的字段

> ID：568520
> 
> 赞同：1
> 
> 时间：2009-02-20T06:29:31.350
> 
> 标签：c#, .net, winforms, datagridview

我有一个可能是独特的情况，我需要将单个列用于两个不同的交替值。

我的数据有单独的日期和时间列。这不是我的选择，我必须忍受它。行以“对”的形式显示 第 1 行和第 2 行是同一功能单元的一部分，但它们在数据库中是单独的行。在网格中，第 1 行第 1 列必须使用日期列，而在第 2 行中，第 1 列是时间列。这对每个偶数行和奇数行重复。请参见下面的 ASCII 绘图。

**是否可以将一个单元格隐藏在一行而不是另一行，然后使两个字段共享一个共同的列标题？**

如果您知道可以使此功能更容易实现的网格，我也愿意使用其他网格。

```
-----------------------------------------------------------------
|Date/Time| ......
=================================================================
|1/1/2008 | .......
|10:00pm  | .......
-----------------------------------------------------------------
|1/2/2008 | .......
|7:00pm   | .......
-----------------------------------------------------------------
...
...
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T06:49:48.820

如果您可以控制进入系统的数据馈送，比如 SQL 存储过程，那么这样的事情呢？

```
SELECT 
   ROWID AS 'ID'
   , MYDATE + MYTIME AS 'MYDATETIME'
FROM
   MYTABLE 
```

如果您无法控制数据源，我建议您使用 on Row_Databound 事件并更改单元格的文本以满足您的需要。这可能意味着您使单元格 3 等于单元格 3 + 单元格 4，然后隐藏单元格 4...但无论哪种方式，Row_Databound 都可能非常适合...

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        //ASSUMES COLUMN 2 IS DATE
        //AND COLUMN 3 IS TIME
        e.Row.Cells[2].Text = e.Row.Cells[2].Text + " " + e.Row.Cells[3].Text;
        e.Row.Cells[3].Visible = false;
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-20T06:37:10.723

我会将数据库重构为更合乎逻辑的格式，然后继续。

如果您绝对不能更改数据库，我可能会包装 GridView 并添加处理特殊情况数据所需的自定义功能。

# apache-flex - 如何设置背景图像以使用 actionscript 进行控制

> ID：568523
> 
> 赞同：0
> 
> 时间：2009-02-20T06:30:37.447
> 
> 标签：apache-flex, actionscript

是否可以与应用程序或除图像控制之外的任何其他控制有关

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T14:50:26.483

你可以使用

`myControl.setStyle('backgroundImage', image);`

假设您的控制继承自`UIComponent`

# c++ - c ++输出和输入单个字符

> ID：568524
> 
> 赞同：2
> 
> 时间：2009-02-20T06:30:48.070
> 
> 标签：c++, list, linked-list, char, cout

我正在用 C++ 编写一个程序，它实现了一个双向链表，每个节点中都包含一个字符。我通过附加功能插入字符：

```
doubly_linked_list adam;
adam.append('a'); 
```

该功能实现如下：

```
//Append node
    node* append(const item c){

        //If the list is not empty...
        if(length){
            //maintain pointers to end nodes
            node* old_last_node = last;
            node* new_last_node = new node;

            //re-assign the double link and exit link
            old_last_node->next = new_last_node;
            new_last_node->back = old_last_node;
            new_last_node->next = NULL;

            //re-assign the last pointer
            last = new_last_node;
        }
        //If this is the first node
        else{
            //assign first and last to the new node
            last = first = new node;

            //assign nulls to the pointers on new node
            first->next = first->back = NULL;
        }

        //increase length and exit
        ++length;
        return last;
    } 
```

但是，我认为存在一个问题，可能与 C++ 处理字符的方式有关。当我去打印我的列表时，不知何故我从来没有得到我已经附加到我的列表中的要打印的字符。这是我用来打印的：

```
//Friendly output function
    friend std::ostream& operator << (std::ostream& out_s, const doubly_linked_list& source_list){
        //create iteration node pointer
        node* traverse_position = source_list.first;

        //iterate through, reading from start
        for(int i = 1; i <= source_list.length; ++i){
            //print the character
            out_s << (traverse_position->data);
            traverse_position = traverse_position->next;
        }

        //return the output stream
        return out_s;
    } 
```

我只是在打印时得到废话。它打印出我从未添加到列表中的字符——你知道，只是来自内存中某处的字符。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T06:33:13.043

你在哪里分配函数`c`中的值`append()`？我担心您可能过于关注双向链表部分，而对存储数据部分关注不够。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T08:18:23.803

正如其他人已经提到的那样，您忘记存储您应该附加的字符。这是一个合理的错误。为了将来避免它，您可以让编译器帮助您。

大多数编译器会针对技术上没问题的事情提供*警告*，但可能不是您真正想要做的事情。在您的情况下，您声明了 parameter `c`，但您从未使用过它。启用警告后，您的编译器可能会注意到这一点并告诉您您没有使用它。这可能足以提醒您，您还没有完成编写该函数。

GCC 启用常见警告的选项是`-Wall`. （这是“警告”的“W”，加上“全部”；它与墙壁无关。但也不是*所有*的警告。）例如：

```
g++ -Wall list-program.cpp

```

其他编译器也有类似的选项。查看编译器的文档以获取详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T06:35:42.663

在您的追加方法中，您实际上没有将项目放入新节点中。当您进行打印时，它只会打印该内存位置中发生的任何值（一些随机值）。

# android - Android MenuItem 切换按钮

> ID：568533
> 
> 赞同：7
> 
> 时间：2009-02-20T06:36:37.277
> 
> 标签：android, button, toggle, menuitem, togglebutton

在我的 Android 应用程序中，我希望在其菜单中可以切换设置，就像 Dialer 应用程序对扬声器和静音所做的那样。你可以看到下面的图片：

[http://www.isaacwaller.com/images/acall.png](http://www.isaacwaller.com/images/acall.png)

您会看到扬声器、静音和保持选项是如何切换按钮的 - 您可以再次点击它们，它们将切换绿色。他们可能会以自定义方式执行此操作，但我怀疑这是一个选项（我尝试设置 Checkable 属性）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-21T02:53:13.423

你也可以做类似下面的代码片段，最初来自[anddev.org](http://www.anddev.org/)

```
public boolean onPrepareOptionsMenu(final Menu menu) {       
      if(super.mMapView.isTraffic()) 
           menu.findItem(MENU_TRAFFIC_ID).setIcon(R.drawable.traffic_off_48); 
      else 
           menu.findItem(MENU_TRAFFIC_ID).setIcon(R.drawable.traffic_on_48); 

      return super.onPrepareOptionsMenu(menu); 
 } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-21T02:48:48.317

看起来这个菜单项是作为自定义视图实现的。

在 android 源代码中，您可以查看[com.android.phone.InCallMenuView.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/2.0_r1/com/android/phone/InCallMenuView.java)以了解它是如何实现的。

它看起来不像是公共 API 的一部分，但看起来非常独立。如果您的项目具有兼容的许可证，您可以将其复制到您的项目中，并根据需要使用和修改它。

# php - 如何在表格中搜索 jQuery 中某个单词的定义？

> ID：568534
> 
> 赞同：-1
> 
> 时间：2009-02-20T06:36:49.820
> 
> 标签：php, jquery, html, css

这有点难以解释，但我有一个 HTML 表，其中充满了 SQL 定义，可以很好地相互交流。例如，有人在谈论“INSERT statements”，并提到了“unique key”。另一行谈论唯一键。

我想用适当行中的定义创建一个小的[定义气泡](http://www.webdesignerwall.com/demo/jquery/animated-hover1.html)（当您将鼠标悬停在 INSERT 行中的“唯一键”上时）。我计划使用 jQuery，但我愿意接受替代方案。有任何想法吗？

**更新**：我的代码在[这里](http://snipt.org/ykk)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T06:43:56.840

有一些 jQuery 工具提示插件（这正是您所追求的）。就我个人而言，我一直在使用[jQuery Tooltip](http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)，对此我很满意。我用它在工具提示中放置了一些非常复杂的内容。

我不完全理解你的其余问题。你想让这自动发生吗？表格是否出现在页面上？服务器端代码是否创建了定义气泡？

现在 jQuery Tooltip 有一个 bodyHandler 属性，您可以在其中提供一个回调（函数）来定义工具提示的内容，这样就可以了。您是否希望自动创建这些链接/提示？

**编辑：**也看看这个[高亮插件](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)。即使您不使用它，您也可以复制在文档中查找文本并将元素包装在它们周围的方法。就像是：

```
$(function() {
  $("table.definitions th").each(function() {
    var term = $(this).text();
    var definition = $(this).nextSibling().text(); // assuming it's in a <td> in the same row
    // find all occurrences of 'term' in relevant text block
    // and wrap in <span class="term" title="definition">...</span>
  });
}); 
```

然后选择使用 jQuery Tooltip 从该标题中制作出更现代的工具提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T06:41:26.923

jQuery 应该可以很好地完成这项任务。将定义气泡的值存储在看不见的地方，并在悬停时使用 jQuery 将其弹出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T06:42:02.693

而不是直接解析 HTML，也许你可以给每个`<tr/>`一个可用于查找定义的 id。相反，如果您想更好地控制触发气泡的文本，请将单词包含在`<span />`带有 id 的 a 中。

jt

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T07:27:20.713

我建议不要像@jason 建议的那样用 span 包装，而是建议使用 < acronym > 或 < abbr > 标签来标记您选择的单词。

在任何情况下，你都可以做这样的*事情*。

我将把工具提示的设置留给你。

Javascript

```
$(document).ready(function() {
    $('acronym').hover(function(){
        var text = $('#definition_'+$(this).attr('title')).text();
        console.log(text);  
        $('#cbfsettinguptooltip').text(text)
        });

}); 
```

HTML

```
<table border="1" cellspacing="0" cellpadding="5">

    <tr>
        <td >Insert</td>
        <td id="definition_insert">The insert statement is better than the <acronym title="select">select</acronym> statement</td>
    </tr>
    <tr>        
        <td >Select</td>
        <td id="definition_select">No No Select is best, much better than <acronym title="insert">insert</acronym></td>
    </tr>
</table>

<div id="cbfsettinguptooltip">

</div> 
```

# actionscript-3 - 减小 SWF 文件大小

> ID：568543
> 
> 赞同：7
> 
> 时间：2009-02-20T06:41:35.347
> 
> 标签：actionscript-3, actionscript

我有一个只有几个图形和大量 ActionScript 3 的项目。有人对减小 SWF 文件大小有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T07:27:12.290

首先要做的是打开大小报告（手边没有 Flash，但应该在发布设置中）并查看真正占用该空间的内容。根据您的描述，它应该主要在 actionscript 中。

如果您有任何带有嵌入字体的动态或文本字段，请注意只嵌入您需要的字符子集，如果您使用的是位图，请确保使用适当的压缩（无损实际上更适合“计算机”图像，很多纯色或简单渐变）。

至于减少 actionscript 字节大小......首先尝试明显的事情：使用发布或测试而不是调试（Shift-F12 或 Ctrl-Enter，而不是 Ctrl-Shift-Enter）来编译发布代码，仔细检查没有您可以使用 flash 内置函数代替 actionscript，使用函数共享代码，添加局部变量以减少常见的子表达式。

您可以尝试避免使用动态对象或更多地使用它们……每个类的描述都有开销，但我认为它们对成员访问的开销可能更少。不过，我还没有测试过这个。

从其他库中修剪或复制您正在使用的任何方法。如果您使用的是 Flex... 抱歉，您太笨了 :(。注意类引用会引入一大堆未使用的类：制作经过修剪的私有库副本在这里也很有用。

如果您愿意牺牲代码质量：您可以尝试使用类成员而不是参数来实现深度调用层次结构。注意内部函数——有几种情况会导致膨胀。由于包含名称（一次），即使使用较短的包、类和成员名称（不是参数或局部变量），以及文字而不是常量，所以只需要发出值，而不是成员名称（我不确定关于私人成员，或密封类）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T07:14:36.157

在文件膨胀的情况下，图形应该始终是第一个嫌疑人。如果您有图像，请降低质量或大小，或者查看不同的格式是否会产生更小的文件大小。不要复制粘贴矢量图，将它们放在影片剪辑或图形中，然后将其放在其他地方。此外，如果您有任何复杂的矢量图，平滑可以帮助降低它们的复杂性。

可以像减少任何其他代码一样减少动作脚本。寻找重复和其他可以删减的地方。但老实说，文件大小受代码影响不大。

一些相关的问题：[为什么减少内容时我的 SWF 文件大小没有减小？](https://stackoverflow.com/questions/533098/why-does-my-swf-file-size-not-decrease-when-reducing-content)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T23:46:10.537

运行时共享库

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T07:02:17.013

你可以做几件事..

*   将图像保存为外部链接并动态加载（需要权衡）

*   检查 SIZE REPORT ，跟踪并修剪大型嵌入文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T06:43:43.890

增加图形的压缩率（例如降低 jpg 质量）并寻找代码中没有被使用的部分，看看是否可以修剪或重构。

# .net-2.0 - Windows Installer 是否使用程序集版本或文件版本来更新 dll

> ID：568544
> 
> 赞同：4
> 
> 时间：2009-02-20T06:41:39.263
> 
> 标签：.net-2.0, windows-installer, versioning, isolatedstorage

我有一个需要在客户端机器上升级的 .net (2.0) winforms 应用程序。目前，这是通过增加所有项目的程序集版本和文件版本并增加 VS2008 中安装程序项目的版本来完成的。

该应用程序现在利用独立存储将一些用户设置保存在 XML 文件（网格布局等）中。

我现在面临的问题是，如果我增加所有版本号，则应用程序的***独立存储****有一个新位置***，因为***文件版本***已经改变。有了新的隔离存储位置，所有设置实际上都丢失了。**

 **升级时，Windows 安装程序是否会根据**文件版本**或**程序集版本**替换 dll ？

如果它是程序集版本，那么我所要做的就是不增加文件版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T08:38:31.993

这里有一些很好的阅读和讨论：

[http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/6ed4d384-f6e9-42ee-b485-0bf40d0abd65/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/6ed4d384-f6e9-42ee-b485-0bf40d0abd65/)

不过，要回答您的问题，我认为 MSI 主要尊重 FileVersion：

[文件版本控制规则](http://msdn.microsoft.com/en-us/library/aa368599(VS.85).aspx)

# c++ - 可能的内存泄漏？

> ID：568560
> 
> 赞同：0
> 
> 时间：2009-02-20T06:51:47.053
> 
> 标签：c++, inheritance, pointers, memory-leaks, class

好的，所以我有两个类，按代码中的顺序将它们称为 A 和 B。B 类将 A 类实例化为一个数组，B 类也有一个错误信息 char* 变量，A 类在发生错误时必须设置该变量。我用纯虚函数创建了第三个类来设置 B 中的 errorMessage 变量，然后使 B 成为第三个类的子类。A 类创建一个指向第三个类的指针，称为 C——当 B 初始化 A 对象的数组时，它循环遍历它们并调用 A 中的一个函数来将 A 的指针设置为 C——它将“this”传递给该函数，然后 A 将指向 C 的指针设置为“this”，并且由于 C 是 B 的父级，A 可以设置 C->errorMessage （我必须这样做，因为 A 和 B 在编译时不能同时知道彼此时间）。

无论如何它工作正常，但是，当我将命令行参数传递给 main(int,char**) 时，它可以工作，除非我传递七个、八个或超过十二个参数给它......我缩小了范围（通过评论out lines) 到 A 中的代码行，它将指向 C 的指针设置为 B 传递给它的值。这对我来说毫无意义......我怀疑是内存泄漏或其他什么，但它似乎是错误的，并且我不知道如何解决它......我也不明白为什么特别是七个、八个和十二个以上的参数不起作用，1-6 和 9-12 工作正常。

这是我的代码（精简）-

```
//class C
class errorContainer{

public:
    virtual ~errorContainer(){ }
    virtual void reportError(int,char*)=0;

};

//Class A
class switchObject{
    void reportError(int,char*);
    errorContainer* errorReference;

public:
    void bindErrorContainer(errorContainer*);
};

//Class A member function definitions
void switchObject::reportError(int errorCode,char* errorMessage){
    errorReference->reportError(errorCode,errorMessage);
}

void switchObject::bindErrorContainer(errorContainer* newReference){
    errorReference=newReference; //commenting out this line fixes the problem
}

//Class B
class switchSystem: public errorContainer{
    int errorCode;
    char* errorMessage;

public:
    switchSystem(int); //MUST specify number of switches in this system.
    void reportError(int,char*);
    int errCode();
    char* errMessage();
    switchObject* switchList;
};

//Class B member function definitions
switchSystem::switchSystem(int swLimit){
    int i;
    switchList=new (nothrow) switchObject[swLimit];
    for(i=0;i<swLimit;i++){
        switchList[i].bindErrorContainer(this);
    }
    errorCode=0;
    errorMessage="No errors.";
}

void switchSystem::reportError(int reportErrorCode,char* reportErrorMessage){
    int len=0,i;    
    errorCode=reportErrorCode;
    if(errorMessage){
        delete[] errorMessage;
    }
    while(reportErrorMessage[len]!='\0'){
        len++;
    }
    errorMessage=new char[len];
    for(i=0;i<=len;i++){
        errorMessage[i]=reportErrorMessage[i];
    }   
}

int switchSystem::errCode(){
    return errorCode;   
}

char* switchSystem::errMessage(){
    return errorMessage;    
} 
```

有人知道我在这里做错了什么吗？它让我烦透了……我似乎无法修复它。

---编辑---好的，我已经按照我的方式设置了它，以便我可以在 main() 中像这样使用它

```
int main(int argc,char** argv){
   switchSystem sw (2)
   sw.switchList[0].argumentCount=2;
   sw.switchList[1].argumentCount=0;
   sw.switchList[0].identifier="a";
   sw.switchList[1].identifier="switch";
   sw.init(argc,argv);
   if(sw.errCode()>0){
      cout<< "Error "<< sw.errCode()<< ": "<< sw.errMessage()<< endl;
   }
} 
```

这个程序应该读取命令行参数并处理用户定义的“开关”——就像大多数命令行程序如何处理开关一样，但是我不想在 main 开头测试所有这些开关，我想尝试编写一个类和一些函数可以帮我完成——创建一个带有开关数量的 switchSystem 对象，设置它们的标识符，不管它们是否接受参数，然后将命令行参数传递给“init()”以对其进行排序。然后像这样测试，

```
if(sw.isSet("switch")){ ... }
```

等等

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T07:02:54.890

你似乎很害怕：

*   在同一个指针中混合动态内存和静态字符串常量（“No errors.”）。
*   使用显式`while`-loop 来计算字符串的长度；你没听说过`strlen()`吗？
*   无缘无故地使用这种类似 C 的低级字符串处理......有什么问题`std::string`？
*   在为其分配空间并复制它时，不要正确考虑字符串中的终止 '\0'。长度也没有被存储，使得结果`char`数组很难解释。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T07:12:01.093

*   `reportError()`应该在 中声明为虚拟的`switchSystem`，就像在 中一样`errorContainer`。
*   `char*`相反，应该`std::string`避免所有不必要的工作。
*   有什么原因不能使用 an`std::vector<switchObject>`代替`new[]`吗？
*   `delete[] errorMessage`当它指向静态文字字符串时，您不应该这样做。这会导致未定义的行为。（翻译：坏事（TM）。）
*   为什么要反复计算和复制 a 的内容`char*`？这是在自找麻烦。你没有做任何事情来保护自己免受伤害。
*   为什么必须`switchObject`将字符串传递给`switchSystem`？简单地返回错误代码或`throw`派生自的某个类不是更好`std::exception`吗？或者它应该向全局日志记录工具发送一个字符串？

我认为也许你应该重新考虑你的设计，而不是试图解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T11:44:12.640

以上所有信息都包含非常好的建议，除非这是家庭作业并且您不能使用 STL 我建议您遵循它们，您的问题会少得多。

例如在这个片段中

```
errorMessage=new char[len];
for(i=0;i<=len;i++){
  errorMessage[i]=reportErrorMessage[i];
} 
```

You have allocated len bytes, but you are writing to len+1 bytes, you have not allocated memory for the null terminator '\0', overwriting memory lead to nasty bugs that are difficult to trackdown.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T09:42:15.353

我认为内存泄漏是你的小问题。你最好扔掉这段代码，然后用一种新方法重新开始。这是一团糟。

# padding - 段落之间垂直间距的 CSS 框模型（边距和填充）

> ID：568561
> 
> 赞同：4
> 
> 时间：2009-02-20T06:52:21.373
> 
> 标签：padding, margin, css

CSS 'margin' 和 'padding' 应该如何用于垂直段落间距：

*   可以使用填充和/或使用边距来定义段落之间的垂直空间吗？
*   如果两者都可以，那么使用哪个更好或更正常？
*   您是否倾向于定义非零填充*和*非零边距，如果是，那么每个定义多少？

[边距、内边距和边框](http://www.w3.org/TR/CSS21/box.html#mpb-examples)的示例*在理论上*解释了边距和内边距之间的区别：我质疑*在实践*中要使用多少来呈现正常、美观的页面。

* * *

其次，给定如下标记......

```
<p>Paragraph.</p>
<ul>
<li>List item.</li>
<li>Another list item.
<p>List paragraph.</p>
</li>
</ul> 
```

如果您希望每个段落和/或列表项之间的垂直间距相等，则：

*   您是否倾向于将其定义`<ul>`为具有零边距+填充？
*   或者`<ul>`通常会有非零边距，这将没有效果，因为这个边距将与`<li>`它内部的边距和`<p>`它之前的边距一起折叠？

* * *

第三（我不确定我是否应该问第三个问题），[折叠边距的规范](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)说，“如果盒子的顶部和底部边距相邻，那么边距有可能通过它折叠。” 如果我在中间有一个像下面这样的空段落......

```
<p>Hello</p>
<p></p>
<p>World</p> 
```

...然后我希望将其视为一个空段落，即在 the`Hello`和之间有额外的垂直空间`World`：

*   什么会阻止这个空段落的边距折叠，因此空段落是不可见的：它是非零填充吗？
*   在什么情况下，一个盒子有相邻的顶部和底部边距折叠**是有用的？**

* * *

欢迎回答这三个问题中的任何一个或所有问题。

目前我对特定于 IE 的框模型问题并不特别感兴趣：相反，我想知道如何使用该标准。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T08:11:06.473

要回答您的第一个问题，通常使用边距或填充来添加元素之间的间距并不重要，但是如果您将边框应用到元素并使用填充来创建空间，它会将边框推出那么远。

要回答您的第二个问题，只需查看此代码并尝试使用它：

```
<html>
<head>
<title>Box Model Tests</title>
<style type="text/css">
/* Just to get rid of the annoying padding/margin setting that is default
 in most browsers on the body tag from messing up our experiments */
body{
margin: 0px;
padding: 0px;
}
p{
margin: 0px;
padding: 0px;
}
/* It appears that if you modify the ul padding it tends
 to remove the bullet points, that is if you set the paddign to zero */
ul{
margin: 0px;
}
</style>
</head>
<body>
<p>Paragraph.</p>
<ul>
<li>List item.</li>
<li>Another list item.
<p>List paragraph.</p>
</li>
</ul>
</body>
</html> 
```

请记住，在上面的示例中，所有剩余空间都与字体的属性有关，可以使用与任何其他元素相同的方法进行更改。

到第三个：

我认为 'garrow' 是正确的，`<p>` 我没有遇到这个问题，因为我经常`<p>`在我的布局中使用越来越少，但是[这篇文章](http://www.researchkitchen.de/blog/archives/css-autoheight-and-margincollapsing.php)看起来很有趣，我认为提供了比 W3C 更好的解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T07:53:59.230

回答你的**第三个**问题；

第二个 < P > 作为一个空的块级元素根本不会被渲染。

您可以通过给它一个高度或填充，或包括一个不间断的空间来强制元素在空时呈现段内。（可能有更多方法可以做到这一点）。
正常的空格（例如换行符、制表符或空格）在这方面似乎不起作用。

编辑#2 :: 为了正确说明这一切是如何工作的，请将其保存在本地并查看呈现的内容。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
        <title>Page Title</title>
        <style type="text/css" media="screen">
            p { margin:10px; background-color:#ccc;}
            p.padding { padding:5px; background-color:#eec; }
            p.height { height:30px; background-color:#cee; }

        </style>
    </head>
    <body>

        <p>text</p>
        <p class="padding">i have padding</p>
        <p class="padding"></p>
        <p></p>
        <p></p>
        <p></p>
        <p></p>
        <p>5 empty paragraphs before this, only one will render. (it has padding)</p>
        <p>& nbsp;</p>
        <p>     </p>
        <p>     </p>
        <p>

        </p>
        <p>3 whitespace before me, one will render, it has &amp;nbsp;</p>
        <p class="height">im 30 px high</p>
        <p class="height"></p>
        <p></p>
        <p></p>
        <p>3 empty before me, 1 will show (it has height)</p>
        <p>text</p>
        <p>text</p>

    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T07:30:06.057

呵呵，嗯...网络浏览器是不同的，我会说与 Firefox 配合的东西通常与标准配合得很好，但这也不完全正确。

根据 xhtml1-strict.dtd，只有 <li/> 可以是 <ul/> 的子级。我建议你给自己找一个了解标准的设计师。这些是您可以用来验证 HTML 的正式规范。

```
<p>Paragraph.</p>
<ul>
    <li>List item.</li>
    <li>Another list item.
    <p>List paragraph.</p> <!--illegal here-->
    </li>
</ul> 
```

但回到你的问题（顺便说一句，这很难回答）。在很多情况下，您会定义非零边距和填充。我倾向于在不需要填充时更喜欢额外的边距，然后在边距不起作用时填充。每种情况都不同，您需要知道何时首选。

我不会详细介绍，因为我认为你在这里是正确的。继续尝试，我知道你会明白的。但请记住，网络浏览器的处理方式不同。

我不确定那个折叠边距的事情，但空白有时也算作边距。如果一堆元素之间没有空格，则有时与没有空格的情况不同。

再说一次，要吸收的东西很多，所以我不会详细介绍，但是您需要了解这些内容，并且您将通过练习获得这些知识。

默认情况下，段落和列表边距不是相同的跨浏览器，当您开始进行所有布局时，您需要为页面定义一组基本 CSS 规则。如果你需要关于设置什么边距的帮助，我建议你看看[页面构造](http://en.wikipedia.org/wiki/Canons_of_page_construction)的规范。

```
p { margin: 1em 0; }
ul { margin: 1em 0; }
ul > li { margin: 1em 0; } 
```

上面的规则只是一个例子，但它们的作用是确保段落和列表项的顶部和底部边距相同，尽管浏览器。这样的事情使您的页面看起来与跨浏览器相同。

继续测试并阅读优秀的 CSS 博客。当您遇到真正晦涩难懂的边缘情况时寻求帮助。这些人花了很多时间试图解决问题，而你的时间最好花在学习他们是如何做到的，而不是重新发明轮子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T07:43:39.940

您需要知道的主要事情是相邻（垂直）边距，所以如果您有：

```
p { margin: 1em 0; }
...
<p>Paragraph one</p>
<p>Paragraph two</p> 
```

它们之间的空间将是 1em 而不是 2em。

填充是分开的。如果段落有填充，它将在它们的框内。所有这些事情的真实来源是 W3C CSS 标准。例如，[折叠边距](http://www.w3.org/TR/CSS2/box.html#collapsing-margins)：

> 在本说明书中，表达 *折叠边距*意味着两个或多个框（可能彼此相邻或嵌套）的相邻边距（没有填充或边框区域将它们分开）组合形成单个边距。
> 
> 在 CSS2 中，水平边距永远不会塌陷。
> 
> 某些框之间的垂直边距可能会折叠：
> 
> *   正常流程中两个或多个相邻的块框垂直边距折叠。生成的边距宽度是相邻边距宽度的最大值。在负边距的情况下，从正相邻边距的最大值​​中减去负相邻边距的绝对最大值。如果没有正边距，则从零中减去负相邻边距的绝对最大值。
> *   浮动框和任何其他框之间的垂直边距不会折叠。
> *   绝对和相对定位框的边距不会塌陷。
> 
> 请参阅边距、填充和边框的示例，以获取折叠边距的说明。

边框有点不同，特别是在[表格](http://www.w3.org/TR/CSS2/tables.html#borders)中，它们可以根据 CSS 相互折叠或不折叠。

现在故事当然还没有结束。浏览器可以在计算宽度、边距、边框和填充组合的方式上有所不同，但通过强制浏览器进入标准模式（使用 DOCTYPE）和本身的大主题（就像你为最小化这些类型所做的那样），这在很大程度上减少了问题）。

# mysql - 如何查看实时 MySQL 查询？

> ID：568564
> 
> 赞同：575
> 
> 时间：2009-02-20T06:54:18.763
> 
> 标签：mysql, monitoring

如何在我的 Linux 服务器上跟踪 MySQL 查询？

例如，我想设置某种监听器，然后请求一个网页并查看引擎执行的所有查询，或者只查看在生产服务器上运行的所有查询。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：594
> 
> 时间：2011-09-19T11:57:58.937

您可以非常轻松地将每个查询记录到日志文件中：

```
mysql> SHOW VARIABLES LIKE "general_log%";

+------------------+----------------------------+
| Variable_name    | Value                      |
+------------------+----------------------------+
| general_log      | OFF                        |
| general_log_file | /var/run/mysqld/mysqld.log |
+------------------+----------------------------+

mysql> SET GLOBAL general_log = 'ON'; 
```

做你的查询（在任何数据库上）。grep 或以其他方式检查`/var/run/mysqld/mysqld.log`

然后别忘了

```
mysql> SET GLOBAL general_log = 'OFF'; 
```

否则性能将直线下降，您的磁盘将被填满！

* * *

## 回答 #2

> 赞同：353
> 
> 时间：2009-02-20T07:01:32.133

您可以运行 MySQL 命令`SHOW FULL PROCESSLIST;`以查看在任何给定时间正在处理哪些查询，但这可能无法实现您所希望的。

无需修改使用服务器的每个应用程序即可获取历史记录的最佳方法可能是通过触发器。您可以设置触发器，以便每个查询运行都会导致查询被插入到某种历史记录表中，然后创建一个单独的页面来访问此信息。

请注意，这可能会大大减慢服务器上的所有内容，并`INSERT`在每个查询之上添加额外的内容。

* * *

编辑：另一种选择是[General Query Log](http://dev.mysql.com/doc/refman/5.1/en/query-log.html)，但是将其写入平面文件会消除很多显示灵活性的可能性，尤其是实时显示。如果您只是想要一种简单、易于实现的方式来查看正在发生的事情，那么启用 GQL 然后`tail -f`在日志文件上运行就可以了。

* * *

## 回答 #3

> 赞同：244
> 
> 时间：2014-07-22T09:04:24.363

即使已经接受了答案，我还是想介绍一下可能是最简单的选择：

```
$ mysqladmin -u bob -p -i 1 processlist 
```

这将每秒在您的屏幕上打印当前查询。

*   `-u`您要执行命令的mysql用户
*   `-p`提示您输入密码（因此您不必将其保存在文件中或让命令出现在命令历史记录中）
*   `i`以秒为单位的间隔。
*   使用`--verbose`标志显示完整的进程列表，显示每个进程的整个查询。（谢谢，[nmat](https://stackoverflow.com/users/848330/nmat)）

有一个可能的缺点：如果快速查询在您设置的时间间隔之间运行，它们可能不会显示。IE：我的间隔设置为一秒，如果有一个查询需要`.02`几秒钟才能运行并且在间隔之间运行，您将看不到它。

当您想要快速检查正在运行的查询而无需设置侦听器或其他任何东西时，最好使用此选项。

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2014-07-31T11:46:52.480

运行这个方便的 SQL 查询来查看正在运行的 MySQL 查询。它可以在您喜欢的任何环境中运行，无需任何代码更改或开销。它可能需要一些 MySQL 权限配置，但对我而言，它无需任何特殊设置即可运行。

```
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != 'Sleep'; 
```

唯一的问题是您经常会错过执行速度非常快的查询，因此它对于运行时间较长的查询或 MySQL 服务器有正在备份的查询最有用 - 根据我的经验，这正是我想要查看的时间“实时”查询。

您还可以添加条件以使其更具体，就像任何 SQL 查询一样。

例如显示所有运行 5 秒或更长时间的查询：

```
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != 'Sleep' AND TIME >= 5; 
```

例如显示所有正在运行的更新：

```
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND != 'Sleep' AND INFO LIKE '%UPDATE %'; 
```

有关完整的详细信息，请参阅：[http ://dev.mysql.com/doc/refman/5.1/en/processlist-table.html](http://dev.mysql.com/doc/refman/5.1/en/processlist-table.html)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2016-03-09T18:33:50.980

### `strace`

查看实时 MySQL/MariaDB 查询的最快方法是使用调试器。在 Linux 上，您可以使用`strace`，例如：

```
sudo strace -e trace=read,write -s 2000 -fp $(pgrep -nf mysql) 2>&1 
```

由于有很多转义字符，您可以通过上面的*管道* （只需在这两个单行之间添加）将[strace 的输出格式化为以下命令：](https://stackoverflow.com/a/36557550/55075)*`|`*

 *```
grep --line-buffered -o '".\+[^"]"' | grep --line-buffered -o '[^"]*[^"]' | while read -r line; do printf "%b" $line; done | tr "\r\n" "\275\276" | tr -d "[:cntrl:]" | tr "\275\276" "\r\n" 
```

因此，您应该看到相当干净的 SQL 查询，无需接触配置文件。

显然，这不会取代启用日志的标准方式，如下所述（涉及重新加载 SQL 服务器）。

### `dtrace`

使用 MySQL 探针查看实时 MySQL 查询，而无需接触服务器。示例脚本：

```
#!/usr/sbin/dtrace -q
pid$target::*mysql_parse*:entry /* This probe is fired when the execution enters mysql_parse */
{
     printf("Query: %s\n", copyinstr(arg1));
} 
```

将上述脚本保存到文件（如`watch.d`），然后运行：

```
pfexec dtrace -s watch.d -p $(pgrep -x mysqld) 
```

了解更多：[DTracing MySQL 入门](http://mirror.metrocast.net/mysql/tech-resources/articles/getting_started_dtrace_saha.html)

### Gibbs MySQL 望远镜

看到这个[答案](https://stackoverflow.com/a/53209674/55075)。

### 日志

以下是对开发建议有用的步骤。

将这些行添加到您的`~/.my.cnf`或全局中`my.cnf`：

```
[mysqld]
general_log=1
general_log_file=/tmp/mysqld.log 
```

[路径：`/var/log/mysqld.log`或者`/usr/local/var/log/mysqld.log`也可能取决于您的文件权限。]

然后重启你的 MySQL/MariaDB（`sudo`如果需要的话，加上前缀）：

```
killall -HUP mysqld 
```

然后检查您的日志：

```
tail -f /tmp/mysqld.log 
```

完成后，更改`general_log`为`0`（以便您将来可以使用），然后删除文件并再次重新启动 SQL Server `killall -HUP mysqld`：.

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2010-06-17T12:48:58.597

我处于一种特殊情况，我无权打开登录，并且如果打开日志，也无权查看日志。我无法添加触发器，但我确实有权调用 show processlist。所以，我尽了最大的努力，想出了这个：

创建一个名为“showsqlprocesslist”的 bash 脚本：

```
#!/bin/bash

while [ 1 -le 1 ]
do
         mysql --port=**** --protocol=tcp --password=**** --user=**** --host=**** -e "show processlist\G" | grep Info | grep -v processlist | grep -v "Info: NULL";
done 
```

执行脚本：

```
./showsqlprocesslist > showsqlprocesslist.out & 
```

尾随输出：

```
tail -f showsqlprocesslist.out 
```

宾果班戈。即使它没有受到限制，它也只占用了我运行它的机器上 2-4% 的 CPU。我希望这可能对某人有所帮助。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2015-05-22T13:23:42.293

您可以从命令行运行：

```
watch --interval=[your-interval-in-seconds] "mysqladmin -u root -p[your-root-pw] processlist | grep [your-db-name]" 
```

将值 [x] 替换为您的值。

甚至更好：

```
 mysqladmin -u root -p -i 1 processlist; 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2012-11-19T15:56:57.140

这是我遇到的 Linux Ubuntu 机器上最简单的设置。疯狂地看到所有的查询。

找到并打开您的 MySQL 配置文件，通常是 Ubuntu 上的 /etc/mysql/my.cnf。查找“日志记录和复制”部分</p>

```
#
# * Logging and Replication
#
# Both location gets rotated by the cronjob.
# Be aware that this log type is a performance killer.

log = /var/log/mysql/mysql.log 
```

只需取消注释“log”变量即可打开日志记录。使用以下命令重新启动 MySQL：

```
sudo /etc/init.d/mysql restart 
```

现在我们已准备好在查询进入时开始监视它们。打开一个新终端并运行此命令以滚动日志文件，并在必要时调整路径。

```
tail -f /var/log/mysql/mysql.log 
```

现在运行您的应用程序。您将在终端窗口中看到数据库查询开始飞来飞去。（确保您在终端上启用了滚动和历史记录）

来自[http://www.howtogeek.com/howto/database/monitor-all-sql-queries-in-mysql/](http://www.howtogeek.com/howto/database/monitor-all-sql-queries-in-mysql/)

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-02-20T07:01:13.117

查看[mtop](http://sourceforge.net/projects/mtop/)。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2012-02-22T16:14:06.930

我一直在寻求做同样的事情，并从各种帖子中拼凑出一个解决方案，并创建了一个小型控制台应用程序来输出实时查询文本，因为它被写入日志文件。这对我来说很重要，因为我正在使用带有 MySQL 的实体框架，并且我需要能够检查生成的 SQL。

创建日志文件的步骤（其他帖子的一些重复，为了简单起见，都在这里）：

1.  编辑位于以下位置的文件：

    ```
    C:\Program Files (x86)\MySQL\MySQL Server 5.5\my.ini 
    ```

    将“log=development.log”添加到文件底部。（注意保存这个文件需要我以管理员身份运行我的文本编辑器）。

2.  使用MySql工作台打开命令行，输入密码。

    运行以下命令以打开常规日志记录，该日志记录将记录所有运行的查询：

    ```
    SET GLOBAL general_log = 'ON';

    To turn off:

    SET GLOBAL general_log = 'OFF'; 
    ```

    这将导致正在运行的查询被写入以下位置的文本文件。

    ```
    C:\ProgramData\MySQL\MySQL Server 5.5\data\development.log 
    ```

3.  创建/运行将实时输出日志信息的控制台应用程序：

    [可在此处下载源](http://code.google.com/p/livelogs/)

    来源：

    ```
    using System;
    using System.Configuration;
    using System.IO;
    using System.Threading;

    namespace LiveLogs.ConsoleApp
    {
      class Program
      {
        static void Main(string[] args)
        {
            // Console sizing can cause exceptions if you are using a 
            // small monitor. Change as required.

            Console.SetWindowSize(152, 58);
            Console.BufferHeight = 1500;

            string filePath = ConfigurationManager.AppSettings["MonitoredTextFilePath"];

            Console.Title = string.Format("Live Logs {0}", filePath);

            var fileStream = new FileStream(filePath, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);

            // Move to the end of the stream so we do not read in existing
            // log text, only watch for new text.

            fileStream.Position = fileStream.Length;

            StreamReader streamReader;

            // Commented lines are for duplicating the log output as it's written to 
            // allow verification via a diff that the contents are the same and all 
            // is being output.

            // var fsWrite = new FileStream(@"C:\DuplicateFile.txt", FileMode.Create);
            // var sw = new StreamWriter(fsWrite);

            int rowNum = 0;

            while (true)
            {
                streamReader = new StreamReader(fileStream);

                string line;
                string rowStr;

                while (streamReader.Peek() != -1)
                {
                    rowNum++;

                    line = streamReader.ReadLine();
                    rowStr = rowNum.ToString();

                    string output = String.Format("{0} {1}:\t{2}", rowStr.PadLeft(6, '0'), DateTime.Now.ToLongTimeString(), line);

                    Console.WriteLine(output);

                    // sw.WriteLine(output);
                }

                // sw.Flush();

                Thread.Sleep(500);
            }
        }
      }
    } 
    ```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-05-20T18:06:11.547

除了描述如何启用常规日志记录的先前答案之外，在将任何 SQL 写入日志之前，我还必须在我的 vanilla MySql 5.6 安装中修改一个附加变量：

```
SET GLOBAL log_output = 'FILE'; 
```

默认设置为“无”。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-11-08T14:21:53.523

### Gibbs MySQL 望远镜

AgilData 最近推出了*Gibbs MySQL Scalability Advisor*（一个免费的自助服务工具），它允许用户捕获要上传到 Gibbs 的实时查询流。*Spyglass*（它是开源的）将监视您的 MySQL 服务器和客户端应用程序之间的交互。无需重新配置或重新启动 MySQL 数据库服务器（客户端或应用程序）。

GitHub: [AgilData/gibbs-mysql-spyglass](https://github.com/AgilData/gibbs-mysql-spyglass/)

了解更多：[使用 Rust 抓包 MySQL](http://www.agildata.com/packet-capturing-mysql-with-rust/)

安装命令：

```
curl -s https://raw.githubusercontent.com/AgilData/gibbs-mysql-spyglass/master/install.sh | bash 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-13T13:39:28.543

如果您想进行监控和统计，那么有一个很好的开源工具[Percona Monitoring and Management](https://www.percona.com/doc/percona-monitoring-and-management/2.x/index.html)

但它是一个基于服务器的系统，启动起来并不是很简单。

它还具有用于测试的[现场演示系统。](https://pmmdemo.percona.com/)

# linq-to-sql - 使用 LINQ 动态搜索和动态创建的谓词

> ID：568571
> 
> 赞同：1
> 
> 时间：2009-02-20T07:03:53.733
> 
> 标签：linq-to-sql

我有一些动态构建的谓词，它们具有以下签名作为参数传递到函数中：

```
Expression<Func<TblTableR, bool>> TableRPredicate,
Expression<Func<TblTableN, bool>> suspectNamesPredicate,
Expression<Func<TblTableS, bool>> TableSPredicate,
Expression<Func<TblTableI, bool>> suspectTableIPredicate, 
```

我正在尝试使用以下内容进行查询：

```
var registries = (from r in db.TblTableR.Where(TableRPredicate)
join s in db.TblTableS.Where(TableSPredicate) 
        on r.TblTableRID equals s.TblTableSTableRID into ss
from suspects in ss.DefaultIfEmpty()
    join si in db.TblTableI.Where(suspectTableIPredicate) 
        on suspects.TblTableSIndexCardID equals si.TblTableIID into sisi
    from suspectTableI in sisi.DefaultIfEmpty()
    join sn in db.TblTableN.Where(suspectNamesPredicate) 
        on suspectTableI.TblTableIID equals sn.TblTableNIndexCardID into snsn
    from suspectNames in snsn.DefaultIfEmpty()
    select r.TblTableRID).Distinct(); 
```

这具有将任何生成的“where”子句放入 JOIN 语句的结果，例如：

```
left outer join tblTableI on tblTableITableRID = tblTableRID 
   AND (expression created by predicate) 
```

实际发生的是创建的最终 SQL 不正确。它正在创建以下类型的 sql

```
 select * from table1 left outer join table2 on field1 = field2 
    AND field3 = 'CRITERIA' 
```

问题在于最后的这个 AND 子句 - 最终返回太多行。本质上，我想将 where 子句放入语句中，而不是将额外条件粘贴到连接中。

像这样的东西：

```
select * from table1 left outer join table2 on field1 = field2 
    WHERE field3 = 'CRITERIA' 
```

我尝试添加 Where 子句，如下所示：

```
...
...
...
select r.TblTableRID).Where(TableRPredicate).Distinct(); 
```

但由于每个谓词的泛型参数，这不会编译。

如果我将 LINQ 查询修改为仅从一个表中选择并使用谓词，则 WHERE 子句将正确生成。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T09:08:10.503

（编辑后澄清）

第1步; 将最终选择更改为将所有三个实体都选择为匿名类型；对我来说（在 Northwind 上测试），即：

```
select new {emp, cust, order}; 
```

第2步; 使用我在下面添加的扩展方法将您的过滤器应用于此；对我来说，这个过滤看起来像：

```
var qry2 = qry.Where(x => x.emp, employeeFilter)
            .Where(x => x.cust, custFilter)
            .Where(x => x.order, orderFilter); 
```

步骤3；**现在从这个过滤**的查询中选择你真正想要的实体：

```
var data = qry2.Select(x => x.order) 
```

这是扩展方法：

```
static IQueryable<T> Where<T,TValue>(
    this IQueryable<T> source,
    Expression<Func<T, TValue>> selector,
    Expression<Func<TValue, bool>> predicate)
{
    var row = Expression.Parameter(typeof (T), "row");
    var member = Expression.Invoke(selector, row);
    var lambda = Expression.Lambda<Func<T, bool>>(
        Expression.Invoke(predicate, member), row);
    return source.Where(lambda);
} 
```

# sharepoint - 将多个功能打包到一个 WSP 解决方案文件中

> ID：568575
> 
> 赞同：3
> 
> 时间：2009-02-20T07:09:00.180
> 
> 标签：sharepoint, moss, sharepoint-2007, wspbuilder, wsp

我正在研究一个共享点功能，其中包括几个列表定义、2 个 web 部件、一个功能接收器程序集和一个 InfoPath 表单。

我必须使用 WSPBuilder 来打包这些，并且要求将所有这些功能打包到一个 WSP 解决方案文件中。

现在，WSP builder 需要特定文件夹结构中的部署文件，与 sharepoint 的 12 Hive 相同。

我的问题是我所有的功能都是单独开发的，并且由多个项目文件组成，而且这些文件不一定在同一个文件夹结构中。

如何使用 WSP Builder 将多个功能打包到一个 WSP 解决方案中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T07:43:02.813

也许这会有所帮助：[http ://www.codeplex.com/wspbuilder/Thread/View.aspx?ThreadId=43125](http://www.codeplex.com/wspbuilder/Thread/View.aspx?ThreadId=43125)

最终，我认为通过使用 NANT 之类的工具构建自己的 wsp 文件，您可以获得很大的灵活性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T08:31:43.897

您无需在 wspbuilder 中执行任何特定操作即可在同一个解决方案包中拥有多个功能。您需要做的就是在 Visual Studio 的解决方案内的 12\TEMPLATE\FEATURES 文件夹下为每个功能创建一个新文件夹，并将适当的 feature.xml 文件放在该文件夹中。例如，您可能有：

12\TEMPLATE\FEATURES\FancyFeature\feature.xml 12\TEMPLATE\FEATURES\ReallyCoolFeature\feature.xml

... 等等。

在构建解决方案时，wspbuilder 将读取 12 文件夹的整个树结构并将相应的节点附加到 wsp 的 manifest.xml 文件中。“TEMPLATE”文件夹中的任何其他可能的子文件夹也是如此，包括 IMAGES、LAYOUTS 等：在部署时，它们都将被复制到真正的 12 个配置单元内的正确文件夹中，因为解决方案中的 12 个文件夹旨在成为原版的复制品。

为了更好地理解，请在 Visual Studio 解决方案的 12 文件夹中创建一些文件夹和文件，编译您的项目并查看生成的 manifest.xml 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T10:21:59.173

简单的答案是，您必须将所有文件从单个项目复制到一个主项目中以用于您的解决方案。只要您所有的个人功能文件都位于“12”文件夹中的正确位置，那么您就可以开始使用了。

***注意：***您需要检查对任何程序集的所有引用，因为此解决方案将为您的所有自定义逻辑创建 1 个程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-04T20:38:13.783

我在向 wsp 添加 dll 时遇到了麻烦，所以我写了一篇关于它的简短文章：[如何将 DLL 添加到 WSP 解决方案](http://blogs.windwardreports.com/tomasr/2009/09/how-to-add-dlls-to-a-wsp-sharepoint-solution.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-29T17:54:28.560

我通常在解决方案中有一个项目被指定为“主要”项目。我设置了依赖关系，以便最后构建这个“主”项目。然后对于我想包含在 wsp 包中的其他项目，我编辑“构建后事件”以将 12 文件夹的内容和项目构建的 dll 复制到主项目的相应文件夹中。然后在我构建了整个解决方案之后，我可以为主项目构建 wsp 包，并且知道它包含了所有内容。

# javascript - javascript中的动态代理？

> ID：568581
> 
> 赞同：5
> 
> 时间：2009-02-20T07:12:16.193
> 
> 标签：javascript

我可以通过做这样的事情来代理javascript中的单个函数（只是从内存中记下来，所以请耐心等待）

```
function addAroundAdvice(target){
    var targetFunction = target.aFunction;
    target.aFunction = new function(){
           invokePreCall();
           targetFunction.apply(target, arguments);
           invokePostCall();
    }
} 
```

作为一名 java 程序员，我认为这是一个动态代理。每次我编写这样的代码时，我都认为一定*有人*制作了一个非常智能的库，它执行常见的代理操作至少比我匆忙做的要好 10%。我期待一些东西，比如正确拦截任何给定对象的所有方法，这可能并不完全是微不足道的。然后是不同类型的建议。因此，虽然我并不期待脚本的大小，但它肯定超过 6 行代码。

那么这些库在哪里呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T09:15:16.727

试试[jQuery AOP 插件](http://code.google.com/p/jquery-aop/)

查看[源代码](http://code.google.com/p/jquery-aop/source/browse/trunk/src/aop.js)似乎只使用 jQuery 作为命名空间，所以即使你不想使用 jQuery ，也可以尝试这个*插件。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T17:50:10.713

Dojo 工具包对 AOP 结构有很多支持，如下所示：
[Eugene Lazutkin 的关于使用 Dojo 进行面向方面编程的博客文章](http://lazutkin.com/blog/2008/may/18/aop-aspect-javascript-dojo/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T09:07:26.980

我认为你已经能够做到这一点意味着有一个库可以以纯 JavaScript 的形式实现它，即你上面的例子。如您所知，设计模式可以应用于 JavaScript，所以我认为我会向您提供的建议是由 Google 和 Yahoo GUI 开发人员提供的：

[http://jsdesignpatterns.com/](http://jsdesignpatterns.com/)

第 14 章：代理模式。参考那里的解决方案。您可能仍然更喜欢您的方法，或者您可能会从他们的方法中找到提示。

干杯，

安德鲁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T09:15:38.987

我认为您无法拦截所有功能。

您可以做的最好的事情是遍历对象的所有元素并查找任何函数：

```
for elem in someObject {
    if typeof(elem) == "function" {
        // replace the function
    }
} 
```

麻烦的是，如果您稍后添加一个功能，它不会通过代理进行路由。

# asp.net-mvc - ASP.NET MVC 自动解码来自 AJAX 的 JSON 编码参数

> ID：568594
> 
> 赞同：5
> 
> 时间：2009-02-20T07:23:33.733
> 
> 标签：asp.net-mvc, json

当我的 JavaScript 代码使用 AJAX 调用 ASP.NET MVC 方法时，它以 JSON 格式传递值。例如：

```
var request = new XMLHttpRequest();
request.open("GET", "http://www.awesome.com/DoSomething?param1=%22some%20string%22&param2=1234", true);  // parameter string created with JSON.stringify 
```

或者

```
var request = new XMLHttpRequest();
request.open("POST", "http://www.awesome.com/DoSomething", true);
// set some headers
request.send("param1=%22some%20string%22&param2=1234");  // parameter string created with JSON.stringify 
```

在 ASP.NET MVC 方面，我有处理调用的方法：

```
public void DoSomething(string param1, string param2) { 
```

糟糕的是 param1 被引号包围：

```
"some string" 
```

更糟糕的是 param2 是*字符串*：

```
1234 
```

当我真的想要该值作为整数时。所以，我要做的第一件事是使用 DataContractJsonSerializer 来解码这两个小狗，这样我的字符串就没有引号，我的第二个字符串被转换为 int。前一两次还不错，但是对于每一个 AJAX 操作都不得不做。

理想情况下，拥有这样的签名会很棒：

```
public void DoSomething(string param1, int param2) 
```

我可以直接进入并使用我的值而不必担心 JSON 解码，就像对非 AJAX 操作所做的那样。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T07:30:34.683

哦，发布后我发现代码可以满足我的需求。请参阅底部附近的“ObjectFilter”类：

[http://weblogs.asp.net/omarzabir/archive/2008/10/03/create-rest-api-using-asp-net-mvc-that-speaks-both-json-and-plain-xml.aspx](http://weblogs.asp.net/omarzabir/archive/2008/10/03/create-rest-api-using-asp-net-mvc-that-speaks-both-json-and-plain-xml.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-03T20:39:47.310

我不确定使用 ModelBinder 与 ObjectFilter 相比有什么优势，但这是我想出的使用自定义 ModelBinder 的解决方案。

[如何将字典作为参数从 jQuery/Ajax 传递给 ActionResult 方法？](https://stackoverflow.com/questions/1077481/how-do-i-pass-a-dictionary-as-a-parameter-to-an-actionresult-method-from-jquery-a)

# c++ - 简单的 Makefile 问题（具有简单的依赖关系）

> ID：568596
> 
> 赞同：1
> 
> 时间：2009-02-20T07:24:04.730
> 
> 标签：c++, unix, makefile

我有 4 个“.cpp”文件和 1 个头文件：

```
Tools.cpp
Code1.cpp
Code2.cpp
Code3.cpp

and Tools.hh 
```

现在所有`Code1.cpp, Code2.cpp, Code3.cpp` 使用存储在`Tools.cpp`.

目前，我编译它们的方法是使用这个简单的 shell 脚本：

```
#!/bin/bash
echo "compiling Code1.cpp";
g++ Code1.cpp Tools.cpp -o Code1

echo "compiling Code2.cpp";
g++ Code2.cpp Tools.cpp -o Code2 

echo "compiling Code3.cpp";
g++ Code3.cpp Tools.cpp -o Code3 
```

一切正常。

现在我想使用标准的 makefile 来做到这一点。但为什么这不起作用：

```
CXX = g++

TOOLSRC = Tools.cpp Code1.cpp Code2.cpp \
Code3.cpp    

TOOLSINC = Tools.hh      

all: Code1 Code2 Code3

Code1: $(TOOLSRC) $(TOOLSINC) makefile
    $(CXX) $^ -o $@  

Code2: $(TOOLSRC) $(TOOLSINC) makefile
    $(CXX) $^ -o $@  

Code3: $(TOOLSRC) $(TOOLSINC) makefile
    $(CXX) $^ -o $@ 
```

我得到的错误是这样的：

```
ld: warning in makefile, file is not of required architecture
ld: duplicate symbol neighbors(std::vector<int, std::allocator<int> >&, int, int)in /var/folders/Yx/YxKmmyVPGpakdPL4St7X6++++TI/-Tmp-//ccQCrGHe.o and /var/folders/Yx/YxKmmyVPGpakdPL4St7X6++++TI/-Tmp-//ccreq9YU.o

collect2: ld returned 1 exit status
make: *** [FindNeighbours] Error 1 
```

我怎样才能纠正错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T07:45:17.237

总之，`$^`这里不是你想要的。它评估为“所有先决条件的名称，它们之间有空格”。在问题 Makefile 中，这导致所有三个目标都使用几乎相同的命令行，每个看起来像

```
g++ Tools.cpp Code1.cpp Code2.cpp Code3.cpp Tools.hh makefile -o Code1 
```

从引用的错误消息中，g++ 决定将 makefile 传递给链接器，就好像它是一个对象一样。它不是。如果没有 makefile 在线，您仍将编译和链接所有四个源文件，并且很可能让链接器决定`main()`使用四个函数中的哪一个。

您可能想利用 make 有大量用于常见情况的内置规则这一事实。编译两个源文件并链接结果非常适合这些常见情况。它未经测试，但以下内容应该可以满足您的所有需求（至少假设最近构建了 gnu make），并且具有只编译每个对象一次的优势。

```
all: Code1 Code2 Code3
Code1: Code1.o Tools.o
Code2: Code2.o Tools.o
Code3: Code3.o Tools.o

Code1.o Code2.o Code3.o Tools.o: Tools.hh 
```

如果您需要设置一些编译器选项，您可以添加 CXXFLAGS 的定义，通常在文件顶部附近。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T07:46:31.930

在这些目标中：

```
Code1: $(TOOLSRC) $(TOOLSINC) makefile
    $(CXX) $^ -o $@ 
```

结果命令将是：

```
g++ Tools.cpp Code1.cpp Code2.cpp Code3.cpp Tools.hh makefile -o Code1 
```

**这显然不是你想要的。** `g++`正在尝试编译头文件和 makefile**并且不知道如何处理 makefile**。您还为每个单元声明了对所有三个主要单元的依赖关系。因此，如果 Code3.cpp 发生变化，Code1 将需要重新编译。**这也是不可取的。**

尝试这样的事情：

```
CXX = g++

all: Code1 Code2 Code3

%.o: %.cpp
    $(CXX) $(CXXFLAGS) -c -o $@ $^

Code1: Code1.o Tools.o
    $(CXX) -o $@ $^

Code2: Code1.o Tools.o
    $(CXX) -o $@ $^

Code3: Code1.o Tools.o
    $(CXX) -o $@ $^ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T07:29:38.897

嗯。通常，您会指定对目标文件的依赖关系，并带有“.o”扩展名。可能是 Make 被混淆了，因为它具有针对各种类型文件的内置规则。

该错误是因为您试图通过将 $^ 传递给编译器来将生成文件链接到程序中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T07:38:35.600

在规则的右侧，您应该*只*放置有用的文件。

```
Code1: Code1.cpp Tools.cpp
    $(CXX) $^ -o $@
Code1: Code2.cpp Tools.cpp
    $(CXX) $^ -o $@
Code3: Code3.cpp Tools.cpp
    $(CXX) $^ -o $@ 
```

虽然这可以解决您的问题，但您绝对应该阅读 Grayfade 关于如何以“正确方式”做事的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T14:14:12.957

我不是 makefile 方面的专家，但我通常是这样做的，而且效果很好。

```
COMPILER = g++
CXXFLAGS = 
EXECUTABLE = code 

all: code

code: Code1.o Code2.o Code3.o Tools.o
  ${COMPILER} ${CXXFLAGS} -o ${EXECUTABLE} Code1.o Code2.o Code3.o Tools.o

Code1.o: Code1.cpp Tools.o
  ${COMPILER} ${CXXFLAGS} -c Code1.cpp

Code2.o: Code2.cpp Tools.o
  ${COMPILER} ${CXXFLAGS} -c Code2.cpp

Code3.o: Code3.cpp Tools.o
  ${COMPILER} ${CXXFLAGS} -c Code3.cpp

Tools.o: Tools.cpp Tools.hh
  ${COMPILER} ${CXXFLAGS} -c Tools.cpp

clean:
  rm *.o
  rm ${EXECUTABLE} 
```

# c# - 如何检查c#项目安装路径是否存在

> ID：568606
> 
> 赞同：0
> 
> 时间：2009-02-20T07:33:19.683
> 
> 标签：c#, installation

我想获取 C# 项目设置的安装路径。在 C#.net 中。如何在安装程序类中使用此路径来检查安装程序是否已安装？

实际上我想检查系统中是否安装了设置。如果是，我想修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T09:44:27.577

使用安装程序创建一个注册条目。hkey_local_machine/software/ 和一个带有路径值的 var installdir。

当您拥有程序的更新版本时，请在安装程序类中检查该密钥。如果存在更新，则重新安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-06T13:56:56.137

您可以从中获取要安装的文件夹的路径

`Context.Parameters["targetdir"]`

因此，您可以在安装前检查它是否为空。显然，这不会告诉您是否在其他地方安装了其他版本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-20T09:38:56.670

我不完全了解您想要什么，但您可以使用[Directory.Exists](http://msdn.microsoft.com/en-us/library/system.io.directory.exists.aspx)方法简单地检查目录是否存在

```
Environment.SystemDirectory gets the system directory on the machine. 
```

# jquery - 德语文本中的 jQuery

> ID：568608
> 
> 赞同：2
> 
> 时间：2009-02-20T07:36:00.287
> 
> 标签：jquery

我在 jQuery 中处理德语文本。

1.  马斯纳姆
2.  文本

现在我需要在我的 switch 案例中检查这些文本：

```
switch(compare){
    case 'Text':
        alert("Text");break;
    case 'Maßnahme':
        alert("Welcome");break;
    default:;
} 
```

是否有等效的 Unicode 来检查德语文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T07:47:41.443

以 UTF8 编码保存您的文件，开关盒应该可以工作。

在 head 部分添加以下内容：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

并使您的服务器以 UTF8 格式返回内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T08:07:28.917

只是对[kgiannakakis 答案](https://stackoverflow.com/questions/568608/jquery-in-german-text/568628#568628)的补充：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

如果您使用 utf-8，请务必**将文件保存为 UTF-8 编码**。检查（文本）编辑器的设置。

# php - 为什么 Suhosin 不是 PHP 核心的一部分？

> ID：568609
> 
> 赞同：13
> 
> 时间：2009-02-20T07:36:33.030
> 
> 标签：php, security, suhosin

Suhosin 似乎对 PHP 核心进行了修补和扩展，以保护用户免受核心缺陷的影响。似乎一些聪明人也在使用这个系统。由于它看起来是一件好事，我很好奇为什么它不是 PHP 核心的一部分。有人知道吗？

**更新：**显然一些 Linux 发行版默认也使用 Suhosin 打包 PHP。这对于 Debian（至少是 Lenny）和 Arch Linux 来说似乎是正确的。任何其他发行版默认使用 Suhosin 打包 PHP？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-20T23:41:30.530

Suhosin 背后的主要人物之一是 Stefan Esser。在过去的几年里，Stefan 似乎一直与 PHP 核心开发人员[在安全性方面存在分歧。](http://www.securityfocus.com/columnists/432)他也是[PHP 漏洞月](http://www.php-security.org/)背后的人之一，该漏洞旨在引起人们对（在 Stefan 看来）PHP 核心安全性的可悲状态的关注。

鉴于 Suhosin 人已经决定走自己的路并在 PHP 项目之外工作，我可以想象：

*   Suhosin 可能没有被回馈以供纳入。
*   Suhosin 人无法让 PHP 团队相信它的用处，或者没有尝试过。
*   核心 PHP 团队不接受 Suhosin 背后的人的贡献。

一些 Linux 发行版，如 Debian（Etch 和 Lenny）、Ubuntu 和 Arch，在其 PHP 包中包含 Suhosin 补丁，因此在这些系统上，您经常会发现它默认处于打开状态。Red Hat 派生发行版（Red Hat Enterprise、CentOS、Fedora 等）的 PHP 包中不包含 Suhosin。

注意：我与 Core PHP 开发人员或 Suhosin 没有任何关联，但基于所涉及的一些个性进行了合理的猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T09:30:22.993

我猜 php 团队不包括 Suhosin 的主要原因是：

*   它可能会破坏现有（写得不好）的 php 代码
*   它可能会破坏（写得不好）php 扩展（我记得 Zend Optimizer 有问题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T09:29:11.857

我想知道他们是否将他们的代码贡献回了主 php 项目？

这通常是新代码集成到开源项目中的方式。

# compatibility - 向后兼容性与标准兼容性？

> ID：568615
> 
> 赞同：3
> 
> 时间：2009-02-20T07:40:24.457
> 
> 标签：compatibility, standards-compliance

假设您有一个需要维护的旧代码库，它显然不符合当前标准。在获得标准合规性的同时，您将如何分配您的努力以保持代码库向后兼容？对你来说什么是重要的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T07:58:12.230

在我的工作场所，我们没有时间仅仅因为它使代码更好而重构事物。必须有来自客户的错误或功能请求。

鉴于该规则，我执行以下操作：

## 当我重构时：

*如果我必须对旧项目进行更改，我会清理、重构或重写我正在更改的部分。*

因为我总是必须首先了解代码才能进行更改，所以这是进行其他更改的最佳时机。

这也是为您的更改和现有代码添加缺少的单元测试的好时机。

我总是先进行重构，然后再进行更改，这样我就更有信心我的更改没有破坏任何东西。

## 优先事项：

最需要重构的代码部分，往往包含最多的 bug。此外，对于客户不感兴趣的部件，我们不会收到任何错误报告或功能请求。因此，通过这种方法，优先级会自动出现。

## 规避不良设计：

我想有很多关于这方面的书，但这是对我帮助最大的：

我建造[外墙](http://en.wikipedia.org/wiki/Facade_pattern)：

1.  具有“隔离”现有不良代码的新良好设计的外墙。如果我必须编写新代码并且必须重用结构不良的现有代码，我会使用它，由于时间限制我无法更改。
2.  具有原始不良设计的外观，隐藏了新的良好代码。如果我必须编写现有代码使用的新代码，我会使用它。

这些外观的主要目的是区分好代码和坏代码，从而限制依赖关系和级联效应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T07:45:04.163

我会及时考虑修复模块，因为我需要使用它们。前期的重写/重构不会在任何合理的公司中进行，但是维护一个庞大的代码库而不对其进行一些清理几乎肯定是一场噩梦。

# java - 从同一个 FileInputStream 中读取字符串和二进制文件

> ID：568616
> 
> 赞同：8
> 
> 时间：2009-02-20T07:40:59.150
> 
> 标签：java, io, stream

我有一个文件，该文件在开头包含一定数量的纯文本，最后是二进制内容。二进制内容的大小由我阅读的一些纯文本行决定。

我使用 a`BufferedReader`来读取各个行，但是它没有公开任何方法来引用读取字节数组。`readUTF`for a`DataInputStream`不会一直读到行尾，并且该方法`readLine`已被弃用。

使用底层`FileInputStream`读取返回空字节数组。关于如何解决这个问题的任何建议？

* * *

```
private DOTDataInfo parseFile(InputStream stream) throws IOException{
DOTDataInfo info = new DOTDataInfo();
BufferedReader reader = new BufferedReader(new InputStreamReader(stream));
int binSize = 0;
String line;
while((line = reader.readLine()) != null){
    if(line.length() == 0)
        break;
    DOTProperty prop = parseProperty(line);
    info.getProperties().add(prop);
    if(prop.getName().equals("ContentSize"))
        binSize = Integer.parseInt(prop.getValue());
}
byte[] content = new byte[binSize];
stream.read(content); //Its all empty now. If I use a DataInputStream instead, its got the values from the file
return info;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T07:53:06.283

你可以使用[**`RandomAccessFile`**](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html). 用于[`readLine()`](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html#readLine())在开始时读取纯文本（注意此限制，如 API 中所述），然后[`readByte()`](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html#readByte())或[`readFully()`](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html#readFully(byte%5b%5d))读取后续二进制数据。

> 使用底层[`FileInputStream`](http://java.sun.com/javase/6/docs/api/java/io/FileInputStream.html) 读取返回空字节数组。

那是因为您已将流包装在 a[`BufferedReader`](http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html)中，它可能在填充其缓冲区时消耗了流中的所有字节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T08:01:36.527

如果您真的有一个文件（而不是更难查找的文件，例如网络流），那么我建议您这样做：

*   将文件作为 FileInputStream 打开
*   将其包装在 InputStreamReader 和 BufferedReader 中
*   阅读文本，这样你就可以知道有多少内容
*   关闭 BufferedReader（这将关闭 InputStreamReader，这将关闭 FileInputStream）
*   重新打开文件
*   跳到（总文件长度 - 二进制内容长度）
*   正常读取其余数据

You could just call `mark()` at the start of the FileInputStream and then `reset()` and `skip()` to get to the right place if you want to avoid reopening the file. (I was looking for an `InputStream.seek()` but I can't see one - I can't remember wanting it before in Java, but does it really not have one? Ick.)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T07:49:10.457

您需要使用 InputStream。阅读器用于字符数据。研究用 DataInputStream 包装您的输入流，例如：

```
stream=new DataInputStream(new BufferedInputStream(new FileInputStream(...))); 
```

数据输入流将为您提供许多有用的方法来读取各种类型的数据，当然还有用于读取字节的基本 InputStream 方法。

（这实际上正是 HTTP 服务器在读取带有内容的请求时必须做的事情。）

* * *

readUTF 不读取一行，它读取以（修改的）UTF8 格式编写的字符串 - 请参阅 JavaDoc。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-31T12:48:31.857

Alas, `DataInputStream` is deprecated and does not handle UTF. But this should help (it reads a line from a binary stream, without any lookahead).

```
public static String lineFrom(InputStream in) throws IOException {
    byte[] buf = new byte[128];
    int pos = 0;
    for (;;) {
        int ch = in.read();
        if (ch == '\n' || ch < 0) break;
        buf[pos++] = (byte) ch;
        if (pos == buf.length) buf = Arrays.copyOf(buf, pos + 128);
    }
    return new String(Arrays.copyOf(buf, pos), "UTF-8");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T07:48:45.967

正确的方法是使用某种形式的 InputStream，可能是 FileInputStream，除非这会成为性能障碍。

您是什么意思“使用底层 FileInputStream 读取返回空字节数组。”？这似乎不太可能，并且可能是您的错误所在。您能向我们展示您尝试过的示例代码吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T07:49:33.453

您可以使用 BufferedReader 阅读文本。当您知道二进制文件从哪里开始时，您可以关闭文件并使用 RandomAccessFile 打开它并从文件中的任何位置读取二进制文件。或者您可以将文件读取为二进制文件并将您标识为文本的部分转换为文本。{使用新字符串（字节，编码）}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T07:56:39.037

我建议使用[DataInputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/DataInputStream.html)。您有以下选择：

*   使用 DataInputStream 读取文本和二进制内容
*   打开 BufferedReader，读取文本并关闭流。然后打开一个DataInputStream，跳过等于文本大小的字节，读取二进制数据。

# javascript - 我可以假设动态加载的 JS 脚本上的 DOM 还没有准备好吗？

> ID：568625
> 
> 赞同：0
> 
> 时间：2009-02-20T07:45:43.743
> 
> 标签：javascript, dom, dynamic, onload

我编写了一个外部脚本，需要在 DOM 准备好后运行（如果不可能，则在 onload 后运行）。

我使用此方法动态加载脚本，因为我需要脚本上的参数：

```
<script type="text/javascript">
document.write(unescape("%3Cscript src='mydomain.com/script.js.php?u="+encodeURIComponent(window.location.host)+"' type='text/javascript'%3E%3C/script%3E"));
</script> 
```

为了按时启动脚本，我使用跨浏览器方法来附加 dom 就绪或 onload 事件。

我的问题：当我的脚本运行并立即运行我的脚本时，我是否可以假设 DOM 已准备好，或者 DOM 尚未准备好，并附加到 DOM 就绪事件（或文档加载）？

如果我也不能确定，我的问题是当我的脚本运行时如何判断 DOM 是否已经准备好（在不同的浏览器上）？在这种情况下，在 DOM 就绪或文档加载事件上启动脚本的方法将不起作用，因为这些事件已经被触发。

注意： 1.我无法控制脚本将附加到的网站。2\. 不能使用 Jquery 或其他库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T08:03:02.733

你几乎可以肯定 dom 还没有准备好。

[这](http://www.javascriptkit.com/dhtmltutors/domready.shtml)是一个很好的参考，可以让你按照自己的意愿工作。

我会：

1) 动态加载该脚本，然后将函数附加到 onload 甚至调用/做任何你想做的与非现场 .js 。

2) 仅在 DOM 准备好后加载脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T08:31:38.077

将脚本放在`body`文档末尾附近。当您的脚本被调用时，上述任何内容都将可用（因为浏览器必须解析它才能看到您的脚本标签；QED）。

请注意，此时其他资源（如图像或帧）仍可以加载。

# rdlc - Rdlc：报告作为某种原始类型的 IList 的子对象

> ID：568639
> 
> 赞同：1
> 
> 时间：2009-02-20T07:53:50.227
> 
> 标签：rdlc

我正在使用 rdlc 报告来报告一些业务对象。我使用子报表来报告嵌套对象（如此[处](http://www.gotreportviewer.com/objectdatasources/index.html)所述）。

当使用常规的子对象列表时，例如 IList(Of Books)，我为书籍创建了一个数据源，然后将其用作子报表的数据源。

当嵌套对象是 IList(Of String) 或其他原始类型列表时，我不太了解如何使用此技术。

在这种情况下进行报告的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-29T08:03:21.530

我有一个像这样的对象结构

订单 -> 列表：OrderItems（产品） -> 列表：AdditionalProducts（产品）

我有一个带有子报表和子子报表的主报表。

我通过以下方式解决了这个问题

在子报表中，我将参数传递给子报表。此参数具有产品名称的值，称为“thisproduct”。

子报表和子子报表都调用子报表处理函数。所以我需要在这里为两者分配数据源。

1.  我为子报表（order.items）分配数据源

2.  如果子子报表 (InternalOrderItemAdditionalProducts) 正在调用此函数，我添加了一个“if”。在这里我检查参数，并获取产品名称。然后我可以遍历订单项，找到与正在查看的产品相关的订单项，然后将子报表数据源分配为与该产品相关的附加产品。

    ```
     private void SubreportProcessing(object sender, SubreportProcessingEventArgs e)
      {     
      // assign subreport datasource
      e.DataSources.Add(new ReportDataSource("OrderItems", order.Items));

      // if the subsubreport is calling this then
      if (e.ReportPath != null)
          if (e.ReportPath == "InternalOrderItemAdditionalProducts")
          {
              // find the orderitem relating to this product
              foreach (var orderitem in order.Items)
              {
                  if (e.Parameters["thisproduct"].Values[0] == orderitem.ProductType.Name)
                  {
                      // assign the subsubreport datasource to be the additional products of that order item
                      e.DataSources.Add(new ReportDataSource("AdditionalProducts",
                                                             orderitem.Product.AllDescendentAdditionalProducts));
                  }
              }
          } 
    ```

    }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T16:52:01.177

我遇到了类似的问题。我有一个运行自定义对象列表的报告。CustomObject 列表是从对包含对其所有 CustomObjects 的许多引用的 ParentObjects 列表的查询中填充的。该关系已被删除，而是在 ParentObject (ParentObject.CustomObjectName) 上使用了一个字符串列。现在我的报告收到一个包含所有 CustomObject 名称的字符串 []。

我的解决方案是使用单个字符串属性和构造函数创建一个包装器对象，以用作我的数据源。我将它命名为我的报告所期望的 CustomObject。

```
class CustomObject 
{ 
   public string Name {get; set;} 

   public CustomObject(string name)
   {
      Name = name;
   }
} 
```

我使用 LINQ 加载列表，在 select 语句中调用包装器构造函数

```
var wrappedObjects = from parent in GetParentObjects()
   select new CustomObject(parent.CustomObjectName); 
```

从报告中，您可以像往常一样为 CustomObject 类添加数据源，并像往常一样访问对象“=Fields!Name.Value”。

# sql-server - Sql Server 全文目录可以找到以下内容吗？

> ID：568644
> 
> 赞同：1
> 
> 时间：2009-02-20T07:56:40.610
> 
> 标签：sql-server, full-text-search, full-text-catalog

我在一个字段中有以下数据，该字段由`Full Text Catalog`.

> 美国加利福尼亚州洛杉矶帕莫拉马市

简单的。（我还有很多其他人，但他们工作正常）。

现在，如果用户提供了这个*不正确、拼错的*搜索词

> pamorma city <--注意第 6 个字符槽中缺少中间的“a”

那么这个数据字段不会被返回。

那么，**目录上的 Sql 2008 FTS 能否返回它认为接近的单词？**

这是sql，顺便说一句，如果这有帮助......

```
SELECT TOP(10) a.Address, AddressSearch.RANK AS TopRank
FROM Addresses a WITH (NOLOCK)
    INNER JOIN CONTAINSTABLE (Addresses, FormattedAddress, 
                             'panorma NEAR city') AS AddressSearch 
        ON a.IdAddress = AddressSearch.[KEY] 
```

如果是这样..你也可以为'close'单词定义一个权重吗？比如 90% 的比赛或其他什么？干杯:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T08:39:59.837

也许您可以使用 T-SQL 函数[SOUNDEX](http://msdn.microsoft.com/en-us/library/ms187384.aspx)和[DIFFERENCE](http://msdn.microsoft.com/en-us/library/ms188753.aspx)？

# php - 可以将密码以纯文本形式存储在 php 变量或 php 常量中吗？

> ID：568657
> 
> 赞同：31
> 
> 时间：2009-02-20T08:02:28.663
> 
> 标签：php, security, passwords

根据问题，将密码存储在 php 页面上是否安全，例如

```
$password = 'pa$$w0rd'; 
```

如果用户看不到它，它是安全的，对吧？

编辑：有些人实际上建议使用哈希，但是，数据库服务器连接密码会有问题，不是吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-20T08:13:14.707

简短的回答是否定的，这取决于。

以纯文本形式存储密码几乎不是一个好主意，尤其是在 Web 可访问的位置，如果**没有**其他原因，只是简单的服务器配置错误或错误位置的回显可能会将其暴露给世界。

如果您必须存储密码（这是可能的），您可以尝试将其存储在 webroot 之外，例如 `/var/www/public_html/`将您的 codez 放在这里
`/var/www/includes/`将您的密码放在这里

比这更好的是让您需要密码的系统（例如数据库包装器）返回一个已经实例化的对象。因此，与其要求`$databasepassword`您提供 PDO 对象，不如将您的数据库类存储在 webroot 之外。

It Depends 来自于哪些攻击向量会导致某人可以访问该密码文本，并且是否要求它们已经在您的文件系统中，如果是这样，那么您可能无论如何都被搞砸了。

另外，如果它是您的 supa-secrit 订阅者内容的密码，嗯，您所失去的只是一些订阅费用，如果是您的数据库，您可能会遇到问题，如果是您的网上银行详细信息，那么对您有好处。

密码保护的东西有多大价值？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-20T09:37:26.800

根据您对安全的定义，任何方法都有其积极和消极方面。

如果您真的想在源中存储密码，那么执行以下操作可能是个好主意：

文件：config.php

```
if( ! defined('IN_CODE') ) die( 'Hacking attempt' );

define( 'PASSWORD_HASH', '098f6bcd4621d373cade4e832627b4f6' ); 
```

文件：index.php

```
define( 'IN_CODE', '1' );

include( 'passwd.php' );

if( md5($password) == PASSWORD_HASH )
... 
```

纯文本永远不是一个好主意，始终存储您要存储的密码的哈希值。

此外，尝试将这样的定义与您的主源文件分开。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-20T08:10:42.700

通常他们是看不到的。但是，如果服务器上发生了不好的事情，那么服务器很有可能会以纯文本形式返回您的 php 代码而不执行它，因此用户将看到该文件的所有源以及您的密码。

我会将密码存储在不在文档根目录上的某个位置（无法在浏览器中打开），然后用 php 打开该文件并读取内容（密码）。或者，如果您有多个密码/用户，我会将它们存储在数据库中以便快速访问。

如果你想使用文件方法目录布局应该看起来像这样（depneds on server）

> /public_html/index.php
> 
> /密码.txt

```
$myFile = $_SERVER['DOCUMENT_ROOT'] + "/../password.txt";
if file_exists($myFile) { 
   $fh = fopen($myFile, 'r');
   $password = fgets($fh);
   fclose($fh);
} else die("No password file");
if ($user_input == $password) {
   ...... Authentication succeeded ..........
   ......your relatively protected code .....
} else die("Wrong password"); 
```

如果您想要更高的安全性，而不是将密码作为文本存储在该文本文件中。痛它是哈希，然后当您想将其与用户输入进行比较时，从用户输入生成哈希并将其与您从文本文件加载的密码哈希进行比较

```
sha1($user_input) == $password_from_txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-20T08:10:42.840

只要您的 PHP 安装工作正常，这并不比任何其他方法安全。我更喜欢命名常量（定义）而不是变量。此外，您可能会考虑存储密码的哈希值，而不是普通密码。即使网站遭到入侵，这也可以防止窃取您的密码。

至于是不好的做法，这取决于。如果您只需要存储一个密码，这种方法就可以了。将它们存储在文档根目录之外可能会给人一种额外的安全感；文档根目录并不比服务器的任何其他设置更绝对。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T08:08:51.190

除非站点本身受到威胁，并且现在这些密码授予访问权限的所有内容（也许是您的数据库？）也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T08:09:34.027

这取决于您如何定义“安全”。

你是对的，一般用户不会看到它。

但是，这绝对是一种不好的做法；如果您的网站遭到入侵，这些密码还能访问哪些内容？我会说您至少应该存储密码的哈希值，而不是明文。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T11:49:05.610

有时它只需要一个邮件应用程序，您只能使用普通密码而不是哈希登录。如果您的应用程序没有安全问题，它应该不会影响您。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T19:32:32.970

我相信大多数时候纯文本密码将是数据库密码，例如 MySQL，不会接受哈希进行身份验证。

如前所述，最好的解决方案是将带有密码的 PHP 配置文件保存在 webroot 之外。

如果您担心在查看文件时有人可能会看到您的密码，您可以使用 base64 函数简单地使其对人类不可读。

有关详细信息，甚至适用于 Windows、Linux 和 Mac 的小型实用程序，请参阅[这篇文章](http://developingmadness.com/blog/2009/05/10/don%E2%80%99t-let-them-see-your-mysql-password/)，以使其更容易。

# .net - 从开发角度：如何说服老板升级到Vista/Windows 7？

> ID：568665
> 
> 赞同：7
> 
> 时间：2009-02-20T08:07:14.580
> 
> 标签：.net, windows-vista, windows-xp, upgrade

我们当前工作的开发环境是 Windows XP pro。这是一个很好的操作系统，但在家里使用 Vista 和 Windows 7 之后，我发现自己想在工作中使用它们，因为我大部分时间都花在电脑上。

问题在于 Windows XP 完成了这项工作，并且显然它已经到位并且可以工作，因此前进的成本为 0，而 Vista / Windows 7 在短期内显然会花费金钱和时间，但我相信从长远来看无论是 Vista 还是 7 环境，我们都会更有效率。

所以我的问题是如何说服决策者至少升级到 Vista，我了解 Service Pack 1 规则，并且很乐意接受这一点。（即现在的 Vista，7 之后）。

参数可以从 .Net 程序员的角度出发，因为我们都是我工作的开发人员。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T08:14:36.387

这一切都取决于您企业的规模。

我们有超过 10000 个工作站需要管理，这也是我们仍在 XPSP2 中的主要原因。

操作系统带有许多必须测试的组策略规则。
它还附带必须评估/升级的自定义软件（防病毒、限制用户配置文件空间，...）。

简而言之，迁移到新操作系统并非易事。仅迁移/部署过程就需要一个月的时间。而这只是一步。必须事先对支持团队进行所有培训。

* * *

现在，对于一家*小*公司来说，所涉及的工作仍然不是微不足道的。

*   许可证需要更新
*   需要确定*所有*软件和驱动程序的兼容性或升级。
*   需要审查政策和安全性

*如果您正在编写的程序的行为与预期目标没有太大*不同，那么所有这些都是有意义的。

如果绝大多数用户将在 Xp 上使用您的应用程序，而您在 Vista 或 W7 上进行开发，您最终可能会发现问题不是在开发阶段，而是在认证或预生产步骤期间，这使得任何修复都变得如此之多更难做。

最后，它是关于投资回报率的。您将获得怎样的生产力，这个新的开发平台将在您的应用程序上市时间方面带来什么优势？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T08:48:33.547

我能想到的升级到 Vista 的最佳理由是更好地利用硬件。我刚刚将我的机器升级到四核 CPU 和 8 GB 内存。使用 Vista 64 位，一切都像梦一样运行。更少的交换，一切似乎都变得更快了。

就硬件价格而言，确实没有理由为更少的内存而苦苦挣扎。当然，您的 IT 部门可能会以不同的方式看待它，但从开发人员的角度来看，具有大量内存的快速机器才是正确的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T09:16:08.660

我肯定会因此被指责为 FUD，但是 Vista 呢？严重地？

我认为这与大多数人的经验相反，如果您的生产力会完全提高[，](http://blogs.bnet.com/teamwork/?p=315)[这](http://www.theregister.co.uk/2009/02/02/windows_vista_forrester/)是*值得*怀疑的[（](http://www.infoworld.com/article/08/03/17/12TC-vista-versus-xp_10.html)[1、2、3、4](http://www.tomshardware.com/reviews/xp-vs-vista,1531-11.html)）。有核心开发者认为升级是在[另一个方向](http://news.cnet.com/8301-13506_3-9837180-17.html)，或者可以通过[XP 插件](http://pcsplace.com/windows/xp-windows/get-vistas-productivity-features-in-xp-with-add-ons/)更好地实现，然后有悲观的猜测认为[你应该只购买许可证](http://vista.blorge.com/2008/05/28/microsoft-says-upgrade-to-vista-because-windows-7-is-pretty-much-the-same/)。不要假装[专业](http://www.microsoft.com/windows/products/windowsvista/features/experiences/productivity.mspx)[意见](http://blog.gabefrost.com/?p=23)不存在。

 *对于成本（不要忘记硬件升级和缺少驱动程序），几乎没有明显的收益（大的 USP 应该是安全性，任何公司都不应该让操作系统处理）。如果您在谈论服务器 2k3 -> 2k8，那将是更合理的销售，但据我所知，推动 vista 的最佳理由是因为[最终](http://www.theregister.co.uk/2009/02/03/windows_migration_schedule/)您将不得不这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T08:19:40.213

我们使用以下参数来运行最新的 Office 和 IE 版本：

> 我们的应用程序需要为下一个版本做好准备，所以如果整个公司都进行切换，我们知道我们的应用程序可以在新版本中运行，并且我们有解决某些兼容性问题的经验。

当然可以说这就是虚拟机的用途，但我们选择了相反的方式，使用虚拟机来测试旧版本。

我们公司拥有超过 6000 台计算机，因此我们提出不获得公司对我们自己升级的软件的支持。

我们也希望升级我们的操作系统，但 Novell 服务器版本没有兼容的 Vista 客户端。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-21T00:31:00.207

我和 anakata 在一起，真的吗？Vista的发展？

# c++ - 你最喜欢的 g++ 选项是什么？

> ID：568668
> 
> 赞同：26
> 
> 时间：2009-02-20T08:07:40.913
> 
> 标签：c++, unix, gcc, compiler-construction, g++

我是 C++ 编程的新手。编译时我从不使用任何选项。

这是我的日常命令：

```
g++ MyCode.cc -o MyCode 
```

对于安全实践，最好的选择是什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-20T08:15:11.223

```
g++ -W -Wall -Werror 
```

将显示所有可能的错误和警告并将它们视为错误。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-20T08:09:49.130

“-Werror”：将所有警告视为错误，因此您必须修复它们。无比珍贵。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-20T08:32:54.253

```
g++ -g 
```

我真的需要那个调试信息....

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-20T08:41:17.120

如果你认为你抓住了一切，试试`-Wextra`

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-20T08:28:13.313

```
g++ -Wall -Weffc++ -Werror -pedantic 
```

但是，当我使用 Boost 时，我将其归为：

```
g++ -Wall -Werror 
```

不过，我正在焦急地等待 GCC 4.4 和 4.5。有一些我非常需要的功能即将推出。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-17T13:07:55.707

```
-ansi
-pedantic

-D__STDC_FORMAT_MACROS
-D__STDC_CONSTANT_MACROS
-D__STDC_LIMIT_MACROS
-D_GNU_SOURCE
-D_REENTRANT

-Wall
-Wextra
-Wwrite-strings
-Winit-self
-Wcast-align
-Wcast-qual
-Wold-style-cast
-Wpointer-arith
-Wstrict-aliasing
-Wformat=2
-Wuninitialized
-Wmissing-declarations
-Woverloaded-virtual
-Wnon-virtual-dtor
-Wctor-dtor-privacy
-Wno-long-long

-O3
-ftree-vectorize
-ftree-vectorizer-verbose=2
-ffast-math
-fstrict-aliasing
-march=native/pentium4/nocona/core2
-msse2
-mfpmath=sse

```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-02-20T22:07:45.637

We always use

```
g++ -Wall -Wextra ... 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-20T08:10:08.440

实际上，它是一个集合：`-Wall -pedantic -std=c++98`

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-20T10:43:44.987

-pipe，它加快了编译速度。还有-O2，它可以加快执行速度。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-20T14:38:21.240

I like `-march=athlon -O2 -pipe` for building most programs (I run Gentoo at home), and I use `-ansi -pedantic -Wall` for code I write myself.

# file - 为什么我应该使用人类可读的文件格式？

> ID：568671
> 
> 赞同：55
> 
> 时间：2009-02-20T08:08:53.903
> 
> 标签：file, encoding, formatting, binary, abstraction

为什么我应该使用人类可读的文件格式而不是二进制格式？有没有这种情况不是这样的？

编辑：我在最初发布问题时确实有这个解释，但现在它不那么相关了：

*在回答[这个问题](https://stackoverflow.com/questions/567516)时，我想向提问者推荐一个标准的 SO 答案，说明为什么使用人类可读的文件格式是一个好主意。然后我找了一个，没找到。所以这里的问题*

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-02-20T08:52:06.987

## 这取决于

正确的答案是视情况而定。例如，如果您正在编写音频/视频数据，如果您将其转换为人类可读的格式，那么它的可读性将不高！Word 文档是人们希望它们是人类可读的、更灵活的经典示例，并且通过迁移到 XML，MS 正在朝着这个方向发展。

比二进制或文本更重要的是标准或非标准。如果您使用标准格式，那么您和下一个人很有可能不必编写解析器，这对每个人来说都是一个胜利。

以下是一些固执己见的原因，如果您必须编写自己的格式（和解析器），您可能希望选择其中一个。

## 为什么要使用人类可读的？

1.  **下一个家伙**。考虑一下维护开发人员在 30 年或 6 个月后查看您的代码。是的，他应该有源代码。是的，他应该有文件和评论。但他很可能不会。作为那个人，不得不拯救或转换旧的、非常有价值的数据，我会感谢你让它成为我可以看到和理解的东西。
2.  **让我用我自己的工具来读和写吧**。如果我是 emacs 用户，我可以使用它。或者 Vim，或者记事本，或者……即使你已经创建了很棒的工具或库，它们也可能无法在我的平台上运行，甚至根本无法运行。此外，我可以使用我的工具创建新数据。
3.  **税收不是那么大——存储是免费的**。几乎总是磁盘空间是空闲的。如果不是，你会知道的。不要担心几个尖括号或逗号，通常不会有太大的不同。过早的优化是万恶之源。如果你真的很担心，只需使用标准压缩工具，然后你就有了一种人类可读的小格式——任何人都可以运行解压缩。
4.  **税收不是那么大——电脑很快**。解析二进制文件可能更快。直到您需要添加额外的列或数据类型，或者同时支持旧文件和新文件。（尽管使用[Protocol Buffers](http://code.google.com/apis/protocolbuffers/)可以缓解这种情况）
5.  **那里有很多好的格式**。即使您不喜欢 XML。试试 CSV。或 JSON。或 .properties。甚至是 XML。已经有很多工具可以用很多语言来解析这些。如果神秘地所有源代码都丢失了，只需 5 分钟即可再次编写它们。
6.  **差异变得容易**。当您签入版本控制时，更容易看到发生了什么变化。并在网上查看。或者你的 iPhone。二进制，你知道有些事情发生了变化，但你依靠评论告诉你什么。
7.  **合并变得容易**。您仍然会在网络上收到有关如何将一个 PDF 附加到另一个 PDF 的问题。文本不会发生这种情况。
8.  **如果损坏更容易修复**。尝试修复损坏的文本文档与损坏的 zip 存档。说够了。
9.  **每种语言（和平台）都可以读或写它**。当然，二进制是计算机的本机语言，因此每种语言也都支持二进制。但是许多经典的小工具脚本语言在处理文本数据时效果要好得多。我想不出一种语言可以很好地处理二进制而不是文本（可能是汇编程序），但反过来不行。这意味着您的程序可以与您甚至没有想到的其他程序进行交互，或者那些比您早 30 年编写的程序。Unix 成功是有原因的。

## 为什么不呢，改用二进制？

1.  **你可能有很多数据**——也许是 TB。然后因子 2 可能真的很重要。但过早的优化仍然是万恶之源。现在使用人类如何，然后再转换？不会花很多时间。
2.  **存储可能是免费的，但带宽不是**（评论中的 Jon Skeet）。如果您在网络上扔文件，那么大小确实会有所作为。甚至往返磁盘的带宽也可能是一个限制因素。
3.  **真正的性能密集型代码**。二进制可以认真优化。数据库通常没有自己的纯文本格式是有原因的。
4.  **二进制格式可能是标准的**。因此，请使用 PNG、MP3 或 MPEG。它使下一个家伙的工作更容易（至少在未来 10 年内）。
5.  **那里有很多好的二进制格式**。有些是该类型数据的全球标准。或者可能是硬件设备的标准。有些是标准的序列化框架。一个很好的例子是[Google Protocol Buffers](http://code.google.com/apis/protocolbuffers/)。另一个例子：[Bencode](http://en.wikipedia.org/wiki/Bencode)
6.  **更容易嵌入二进制文件**。有些数据已经是二进制的，您需要嵌入它。这在二进制文件格式中自然有效，但在人类可读的格式中看起来很丑陋并且效率非常低，并且通常会阻止它们成为人类可读的。
7.  **刻意默默无闻**。有时您不希望您的数据在做什么很明显。加密比通过默默无闻的意外安全要好，但如果你正在加密，你最好将它变成二进制并完成它。

## 值得商榷

1.  **更容易解析**。人们声称文本和二进制都更容易解析。现在显然最容易解析的是当您的语言或库支持解析时，这对于某些二进制和一些人类可读的格式是正确的，因此也不真正支持。可以清楚地选择二进制格式，以便它们易于解析，但人类可读（想想 CSV 或固定宽度）也是如此，所以我认为这一点没有实际意义。一些二进制格式可以直接转储到内存中并按原样使用，所以这可以说是最容易解析的，特别是如果数字（不仅仅是字符串）。但是我认为大多数人会认为人类可读的解析更容易调试，因为更容易看到调试器中发生的事情（稍微）。
2.  **更容易控制**。是的，更有可能有人会在他们的编辑器中破坏文本数据，或者当一种 Unicode 格式有效而另一种无效时会抱怨。使用不太可能的二进制数据。然而，人和硬件仍然可以破坏二进制数据。您可以（并且应该）为人类可读的数据指定文本编码，可以是灵活的也可以是固定的。

归根结底，我认为两者都不能真正在这里占据优势。

## 还要别的吗

你确定你真的想要一个文件吗？你考虑过数据库吗？:-)

**学分**

很多这个答案是将其他人在其他答案中写的东西合并在一起（你可以在那里看到它们）。尤其要感谢 Jon Skeet 的评论（无论是在这里还是离线），他提出了可以改进的方法。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-20T08:17:54.367

这完全取决于情况。

人类可读格式的好处：

*   您可以阅读它的“本机”格式
*   您可以自己编写它，例如用于单元测试 - 甚至用于真实内容，具体取决于它的用途

二进制格式的可能好处：

*   更容易解析（就代码而言）
*   解析速度更快
*   空间效率更高
*   更容易控制（任何时候你需要文本，你可以确保它是 UTF-8 编码的，长度前缀等）
*   更容易有效地包含不透明的二进制数据（图像等 - 使用您将进入 base64 的文本格式）

不要忘记，您始终可以实现二进制格式，但也可以生成工具来转换为人类可读的格式。这就是 Protocol Buffers 框架所做的——实际上，IME 很少需要解析协议缓冲区的文本版本，但能够将其写成文本真的很方便。

编辑：以防万一这最终成为一个公认的答案，您还应该记住[starblue 提出的观点](https://stackoverflow.com/questions/568671/why-should-i-use-a-human-readable-file-format/568740#568740)：人类可读的形式*更*适合区分。我怀疑设计一种适用于差异的二进制格式是可行的（并且可以生成人类可读的差异），但现有差异工具的开箱即用支持对于文本来说会更好。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-20T08:37:31.747

**文本格式的版本控制**更容易，因为可以轻松查看和合并更改。

尤其是 MS-Word 在这方面让我们感到悲痛。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-20T08:13:26.873

*   开放格式——没有二进制位杂耍
*   可读性:)
*   跨平台交换
*   调试辅助
*   易于解析（并轻松转换为**任何**格式）

重要的一点：您编写了一次解析器，但多次读取了输出。这种倾向使天平有利于 HRF。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-20T08:18:04.787

一个主要原因是，如果有人需要读取数据，比如 30 年后，可以找出人类可读的格式。二进制要困难得多。

如果您有本质上是二进制的大型数据集（例如图像），那么它们显然不能以二进制形式存储。但即便如此，元数据也可以（而且应该！）是人类可读的。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-20T08:46:08.623

有一种东西叫做*Unix 编程的艺术*。

我不会说它的好坏，但它相当有名。它有一[整章叫做 Textuality](http://www.catb.org/~esr/writings/taoup/html/textualitychapter.html)，其中作者断言人类可读的文件格式是 Unix 编程方式的重要组成部分。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-20T08:16:53.980

它们打开了使用原始工具以外的工具创建/编辑的可能性。其他人可以开发新的更好的工具，集成到第三方应用程序成为可能。例如，想想二进制 iCal 文件——这种格式会成功吗？

除此之外：人类可读的文件提高了调试能力，或者对于精明的用户来说，至少可以找到错误的原因。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-20T08:18:23.070

二进制的优点：

*   快速解析
*   通常较小的数据
*   易于编写解析器

人类可读的优点：

*   阅读时更容易理解 - 没有“字段 X 设置为 4 487，这意味着反应堆现在应该关闭”
*   如果使用 XML 之类的东西很容易编写一个可以解析任何文件的工具

我不得不处理这两种类型。如果您要发送数据并且希望将其保持为小二进制，则很好。如果您希望人们阅读它，那么人类可读性很好。

人类可读的通常也有点自我记录。使用二进制很容易出错 - 并且很难发现它们。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-20T08:14:06.933

因为您是人类，迟早您（或您的一位客户）将能够读取数据。

如果速度是一个问题，我们只使用二进制格式。即使这样调试也很麻烦，所以我们添加了一个人类可读的等价物。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-20T08:19:27.123

*   可编辑
*   可读（呃！）
*   可打印
*   记事本和 vi 已启用

最重要的是，它们的功能可以从内容中推断出来（大多数情况下）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-20T08:16:29.957

互操作性是标准论点，即人类可读的形式对于不同系统的开发人员来说更容易处理，因此具有一定的优势。

我个人认为这不是真的，二进制文件的性能优势应该超过这个论点，特别是如果你发布你的协议。然而，基于 XML/HTTP 的机器交互框架无处不在，这意味着它更容易被采用。

XML 被过度使用了。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-20T08:23:45.490

只是一个简单的说明，其中人类可读的文档格式可能是更好的选择：

**用于在生产中部署应用程序的文档**

我们曾经有Word 格式的*发行说明*，但发行说明文档必须在预生产和生产平台的各种环境（Linux、Solaris）上打开。
为了提取各种数据，还必须对其进行解析。

最后，我们切换到基于 wiki 的语法，仍然可以通过 wiki 以 HTML 格式很好地显示，但在其他情况下仍然用作简单的文本文件。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-20T08:24:36.427

作为对此的补充，人类可读性有不同的水平，所有这些都可以通过使用带有代码着色、折叠或导航的优秀编辑器或查看器来增强。

例如，

*   即使是明文，JSON 也非常易读
*   XML 有[尖括号税](http://www.codinghorror.com/blog/archives/001114.html)，但*在使用好的编辑器时可以使用*
*   INI 主要是人类可读的
*   CSV 可以读取，但最好加载到电子表格中。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-03T14:18:04.040

没有人说，所以我会说：人类可读性实际上并不是文件格式的属性（毕竟所有文件都是二进制文件），而是文件格式和查看器应用程序组合的属性。

所谓的人类可读格式都是基于现有文本编码之一的附加抽象层之上的。能够以人类可读的形式呈现这些编码的查看器程序（通常也用作编辑器）非常常见。

文本编码标准广泛且相当成熟，这意味着它们在可预见的未来不太可能发生太大变化。

通常在格式的文本编码层之上，我们会找到一个语法层，它在给定目标用户知识和文化背景的情况下相当直观。

因此，“人类可读”格式的好处：

*   合适的观众和编辑无处不在。

*   永恒（鉴于文化习俗不会发生太大变化）。

*   易于学习、阅读和修改。

依赖额外的抽象层制作文本编码文件：

*   太空饥渴。

*   处理速度较慢。

“二进制”文件不采用文本编码抽象层作为基础（或公分母），但它们可能会或可能不会使用更适合其目的的某种额外抽象，因此，它们可以更好地优化手头的具体任务的意思：

*   处理速度更快。

*   占地面积更小。

另一方面：

*   查看器和编辑器特定于特定的二进制格式，使互操作性更加困难。

*   任何给定格式的观众都不太广泛，因为他们更专业。

*   格式可能会随着时间的推移发生显着变化或不再使用：它们的主要好处是非常适合特定任务，并且随着任务或任务要求的发展，格式也会发生变化。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-06-23T18:14:22.370

花点时间想想 Web 开发以外的应用程序。

假设： A) 它在文本格式中具有“明显”的含义是错误的。像钢铁厂或制造厂的控制系统这样的东西在人类可读方面通常没有任何优势。用于这些类型环境的软件通常具有以图形有意义的方式显示数据的例程。

B）以文本形式输出更容易。实际上需要更多代码的不必要的转换使系统变得不那么健壮。事实上，如果您不使用将所有变量都视为字符串的语言，那么人类可读的文本就是额外的转换。IE 额外代码意味着需要验证、测试的代码更多，并且有更多机会在应用程序中引入错误。

C）无论如何你都必须解析它。对于我工作过的 DSP 系统来说，很多情况下（IE NO 人类可读接口开始）。数据以统一大小的数据包从系统中流出。记录数据以供分析和后续处理只需指向缓冲区的开头并将块大小的倍数写入数据记录器系统即可。这使我能够分析“未触及”的数据，因为客户的系统会看到它，再次将其转换为不同的格式会导致可能引入错误。不仅如此，如果您只保存“转换后的数据”，您可能会丢失翻译中可能帮助您诊断问题的信息。

D) 文本是数据的自然格式。我从未见过任何硬件使用“TEXT”接口。（我大学毕业后的第一份工作是为相机线扫描相机编写设备驱动程序。）建立在它之上的系统可能确实如此，但适用于每台“PC”。

对于信息在文本格式中具有“自然”含义的网页，请务必将自己击倒。当然，对于处理源代码来说，这是一件轻而易举的事。但是，即使是冰箱和牙刷也将内置处理器的普遍计算环境，并没有那么多。简单地给这些类型的系统增加处理文本的能力会带来不必要的复杂性。您不会将“printf”链接到控制鼠标的 8 位微控制器的软件中。（是的，也必须有人编写该软件。）

世界不是一个非黑即白的地方，需要考虑的唯一计算形式是 PC 和 Web 服务器。

即使在 PC 上，如果我可以使用单个 OS 读取调用直接将数据加载到数据结构中并在不编写序列化和反序列化例程的情况下完成它，那就太棒了，检查块 CRC 工作——完成下一个问题.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-20T08:14:39.320

嗯……因为人类可读的文件格式可以被人类阅读？对我来说似乎是一个很好的理由。

（嗯，对于配置文件，它们不可避免地会被人类读取（和编辑！）。用于某种持久存储的文件实际上不需要人类读取或编辑。）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-20T08:17:53.510

> 为什么我应该使用人类可读的文件格式而不是二进制格式？有没有这种情况不是这样的？

是的，如果它们是人类可读的压缩卷（zip、jpeg、mp3 等）将不是最理想的。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-20T08:22:08.070

我想它可能在大多数情况下都不好。我认为这些格式（例如 JSON 和 XML）的主要原因是 Web 开发，以及在 Web 上的普遍使用，您需要能够在用户端处理数据，而您不一定能读取二进制文件。使用人类可读格式的坏情况的一个很好的例子是任何非文本的东西，例如图像、视频、音频。我注意到在 Web 开发中使用非二进制格式没有意义，我感到内疚！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-20T08:19:58.013

文件通常会成为您的人机界面的一部分，因此它们应该是人性化的（不仅仅是程序员）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-20T08:44:18.673

我对非归档文件使用二进制流的唯一一次是当我想对不经意的观察者隐藏一些东西时。例如，如果我正在制作*只有*我的应用程序应该编辑的临时文件，我将使用二进制文件。

它不是试图混淆，而只是阻止用户手动编辑文件（这可能会破坏应用程序）。

这将是一个好主意的一个实例是存储/保存有关某些游戏的运行数据..即保存您的游戏并稍后继续。其他场景将描述中间文件，但无论如何这些通常都是二进制/字节编译的。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-20T08:44:45.850

> 为什么我应该使用人类可读的文件格式而不是二进制格式？

取决于内容和上下文，即数据从哪里来和去哪里。如果数据通常是由人类直接编写的，那么以可以通过文本编辑器操作的格式存储它是一个好主意。例如，程序源代码通常会被存储为人类可读的，这是有充分理由的。但是，如果我们归档它，或者使用版​​本控制系统共享它，我们的存储策略就会改变。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-20T08:55:35.683

如果您对某个字段有问题（例如：一个字段包含一个数字，其中规范规定该字段必须是一个字符串），则人工格式更易于解析和调试，而且人工格式更接近问题领域。

我更喜欢包含大量数据的二进制格式，并且我确信我有解析他的软件:)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-20T12:30:44.510

在阅读菲尔丁关于 REST 的论文时，我非常喜欢“[架构属性](http://www.ics.uci.edu/~fielding/pubs/dissertation/net_app_arch.htm#sec_2_3)”的概念；坚持的是“可见性”。这就是我们在这里谈论的内容：能够“看到”数据。调试系统时的巨大好处。

我发现其他答案中缺少一个方面：*强制语义*。

从您追求人类可读的那一刻起，您就允许愚蠢的记事本用户创建要输入系统的数据。没有办法保证这些数据是有意义的。无法保证系统会以合理的方式做出响应。

因此，如果您不需要记事本检查您的数据，并且您想要强制执行有效数据（例如通过使用 API）而不是首先验证它，您最好避免使用人类可读的数据。如果可调试性是一个问题（通常是），也可以使用 API 来检查数据。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-08-28T22:11:47.180

人类可读不等于更容易被机器代码解析。

以人类自然语言为例。:) 人类语言的机器解析仍然是一个有待完全解决的悬而未决的问题。

所以我同意[https://stackoverflow.com/a/714111/2727173](https://stackoverflow.com/a/714111/2727173)对这个问题有更深入的了解。

# asp.net-mvc - 通过 Windsor IInterceptor 访问操作

> ID：568689
> 
> 赞同：0
> 
> 时间：2009-02-20T08:15:39.893
> 
> 标签：asp.net-mvc, castle-windsor

我希望通过使用 Windsor IInterceptor 在 MVC 应用程序中处理授权 - 因为这似乎是我可以获得对参数的命名访问的唯一方法，传递的操作与确定用户是否具有访问权限相关。

从我的 Intercept 方法中，我需要访问被调用的操作。我想出了如何获取控制器和操作名称（通过 RequestContext），但不是实际的方法 - 有什么好主意吗？

作为参考，这大致是代码的样子：

```
public class AuthorizationInterceptor : IInterceptor
{
    public void Intercept(IInvocation invocation)
    {
        if (invocation.Arguments != null && invocation.Arguments.Length > 0 && invocation.Arguments[0] != null)
        {
            if (invocation.Arguments[0].GetType() == typeof(RequestContext))
            {
                var context = (RequestContext)invocation.Arguments[0];
                var values = context.RouteData.Values;

                if (!auth.Authorize(values, HttpContext.Current.User))
                {
                    //RedirectToLogin                    }
            }
        }

        invocation.Proceed();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T00:57:08.323

`invocation.Method`为您提供拦截的方法，但我认为您最好使用[ActionFilter](http://www.google.com/search?q=asp.net+mvc+actionfilter)代替。

# wpf - 如何向标准 XAML 元素添加附加属性？

> ID：568701
> 
> 赞同：6
> 
> 时间：2009-02-20T08:19:29.230
> 
> 标签：wpf, xaml

当单击内容为“Reports”的按钮时，此按钮单击方法会启动一个名为“(assemblyname).Reports”的窗口：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    Button button = (Button)e.OriginalSource;
    Type type = this.GetType();
    Assembly assembly = type.Assembly;
    Window window = (Window)assembly.CreateInstance(String.Format("{0}.{1}", type.Namespace, button.Content));
    window.ShowDialog();
} 
```

但我希望按钮的 Content 属性值能够更改，例如它可能会更改为“Stock Reports”，但我仍然希望单击按钮以启动“(assemblyname).Reports”。

有没有办法为按钮标签添加属性，例如“TheWindowFileName”？

```
<Button x:Name="btnReports" Content="Stock Reports" TheWindowFileName="Reports"/> 
```

如果没有，我还能如何向按钮元素添加其他信息，我可以在后面的代码中读取和处理这些信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-20T08:23:46.473

当然，您可以使用[附加](http://msdn.microsoft.com/en-us/library/ms749011.aspx)属性向 XAML 元素添加额外的属性，但对于您需要的内容，您可能只需使用现有的[Tag](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.tag.aspx)属性：

```
<Button x:Name="btnReports" Content="Stock Reports" Tag="Reports"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T08:37:42.867

在此处使用附加属性可能有点过头了，但您可以尝试将按钮行为封装在[命令](http://msdn.microsoft.com/en-us/library/ms752308.aspx)中，并将您要在命令中使用的数据作为`CommandParameter`. 这应该够了吧。

# apache-flex - 我应该使用 Flex 还是 Air SDK 来开发 Air 应用程序？

> ID：568706
> 
> 赞同：4
> 
> 时间：2009-02-20T08:21:35.887
> 
> 标签：apache-flex, air

我想开发一个 Adob​​e air 应用程序。使用 Air SDK 或 Flex SDK 有什么区别，有什么优点/缺点？我的应用程序将使用 SQLlite 数据库，如果我将整个东西变成 Web 应用程序，以后可能会涉及 PHP。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T21:33:24.627

> “如果你想开发一个Air应用程序，你必须使用Air SDK。如果你想开发一个在Air上运行的Flex应用程序，你需要同时使用两者。” - @joshtnjala

我相信@joshtnjala 部分正确，但我想补充一下。如果使用 Flex 3.3 SDK，则不再需要 AIR SDK，因为这些工具可用于 Flex 3.3 SDK。重要的是要注意，因为我看到很多混淆或误用术语，Flex 实际上是三件事。

*   ## Flex SDK（当前为 3.3）

    允许没有 Flash 和/或 Flex IDE 的开发人员开发和编译/发布 Actionscript3 和 MXML 代码到 Flash 内容 (SWF)。例如，可以将 FlashDevelop 用于 IDE，并使用 Flex 3.3 SDK 编译代码。

*   ## 弹性框架

    （来自 adobe [ [http://www.adobe.com/products/flex/overview/][1]](http://www.adobe.com/products/flex/overview/][1])） Flex 是一个免费的开源框架，用于构建高度交互、富有表现力的 Web 应用程序，这些应用程序可以一致地部署在所有主要浏览器、桌面上, 和操作系统。它提供了一种现代的、基于标准的语言和支持常见设计模式的编程模型。MXML 是一种基于 XML 的声明性语言，用于描述 UI 布局和行为，而强大的面向对象编程语言 ActionScript™ 3 用于创建客户端逻辑。Flex 还包括一个丰富的组件库，其中包含 100 多个经过验证的、可扩展的 UI 组件，用于创建富 Internet 应用程序 (RIA)，以及一个交互式 Flex 应用程序调试器。

*   ## 弹性生成器 3

    Flex Builder 只是一个 IDE，用于协助开发 Flash (SWF) 或 AIR 内容。该构建器使用上面的 SDK 进行编译。根据开发人员的需要，可以使用也可以不使用该框架。许多开发人员已经离开了 FLASH IDE（那是一个糟糕的时间线！）并开始纯粹在 Flex Builder IDE 中编写他们的 AS3 脚本，因为它为“高级”程序员提供了许多有用的功能；更不用说它是一个非常干净的 UI 并且建立在 eclipse 上，所以它有许多插件和一个坚实的社区支持它的架构。

话虽如此，扩展 joshtnala 所说的，使用 AIR SKD 和 Flex 3.3 SDK 之间的区别在于，如果您只想构建一个由 Actiosncript3 代码组成的 AIR 应用程序，那么您只需要 AIR SDK (33mb解压）。如果您打算使用 MXML 和“Flex 框架”的任何部分，那么您必须使用 Flex 3.3 SDK（190mb 未打包）。这将允许您在 AIR 应用程序中使用许多可用的组件，例如 Datagrids、Accordions 等。因此，最终双方都将开发 AIR 应用程序，因为 Flex 3.3 SDK 包含了 AIR 1.5 开发工具。抽象出你的项目，弄清楚你需要什么，如果一个组件适用于此，或者是否需要自定义实现等，然后选择你的工具包。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T10:35:31.073

这些框架是可以组合的。如果您希望您的应用程序同时出现在 Web 和桌面上，请使用 Flex SDK 制作它，然后使用 Air 包装它的桌面版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T08:22:41.873

如果您正在考虑在 Web 上部署，并与后端服务器和所有爵士乐进行通信，那么 flex 是您的最佳选择。如果您的目标是桌面用户，那么 AIR。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T22:50:08.343

如果要开发 Air 应用程序，则必须使用 Air SDK。如果您想开发一个在 Air 上运行的 Flex 应用程序，您需要同时使用这两者。

# macos - Mac OS X：我应该在哪里存储常见的应用程序数据？

> ID：568708
> 
> 赞同：20
> 
> 时间：2009-02-20T08:22:19.957
> 
> 标签：macos

MacOS X 上存储由不同用户共享的应用程序数据的标准路径是什么？我不是在谈论临时数据，而是由一个特定程序定期使用并且不属于特定用户的数据。例如游戏高分表。

谢谢，

阿德里安

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-20T08:38:43.677

我相信你在谈论支持文件 - 一个支持应用程序但不需要运行的文件（例如你的高分表）。

对于共享用户，这些文件应该放在 ~/Library/Application Support/YourApp 或 /Library/Application Support/YourApp 中。

[库目录存储应用程序特定的文件](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW1)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T09:18:16.673

要获取目录，可以使用函数“NSSearchPathForDirectoriesInDomains”，目录参数为“NSApplicationSupportDirectory”，domainMask 参数为“NSLocalDomainMask”。

（NSApplicationSupportDirectory 是“应用程序支持文件的位置”，而 NSLocalDomainMask 的意思是“本地到当前机器——安装此机器上每个人都可用的项目的地方。”）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T08:38:12.010

一些应用程序将文件放入 /Users/Shared 目录。我知道这是在用户之间共享文件的标准方式，但我不能 100% 确定它是否适用于应用程序数据存储。

有 /Library*-文件夹，它被认为是系统范围的公共数据，类似于 /Users/Usernames/Library。

但是您当然不应该将数据写入 Application.app 目录。没有管理员权限的用户甚至没有权限写入这些目录。

```
* = Or /System/Library. Need to verify. 
```

# asp.net - TreeView-Like 链接列表

> ID：568711
> 
> 赞同：2
> 
> 时间：2009-02-20T08:22:58.333
> 
> 标签：asp.net, vb.net, treeview, list, bulletedlist

我有一个包含 Region_Name、Region_ID 字段的表，以及另一个包含 Area_Name、Region_ID 字段的表（每个区域都有属于它的区域）。我想在我的 asp.net 页面上显示一个链接列表（看起来像 treeView 的东西），所以当有人点击这个列表中来自纽约地区的前布朗克斯时：

*   纽约

    *   布朗克斯

    *   布鲁克林

    *   曼哈顿

*   肯塔基州

    *   阿什兰

    *   巴兹敦

*   新泽西州

    *   埃塞克斯

    *   米德尔塞克斯

等等......等等......所以，除了基础知识，我想知道如何自动填充上面的列表并确保结果是所有链接，换句话说，纽约是一个链接，布朗克斯是一个链接，列表中的所有元素都是链接，我稍后会将查询字符串附加到...

我正在使用 VB.Net 和 ASP.Net 3.5。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T13:07:27.557

如果您想以声明方式执行此操作，请使用嵌套的 Repeater 控件。外部循环区域表，内部循环区域，当然基于区域 ID。

进行嵌套转发器的一种简单方法是使用 DataSet 并在两个相关 DataTable 之间创建关系。

这是一个很好的例子：http: [//jamesewelch.com/2008/03/06/how-to-use-nested-repeater-controls-with-relational-data/](http://jamesewelch.com/2008/03/06/how-to-use-nested-repeater-controls-with-relational-data/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T08:12:10.927

感谢所有回答或尝试的人。我发现了一个不同但简单的解决方案：

在我的 page_load 中，我调用了：

labelwhatever.text = outputRegionAsLinks()

功能是：

```
Private Function outputRegionAsLinks() As String
    Dim sb As New StringBuilder
    Dim regionsTable As GKP.tblRegionsDataTable = Regions.GetRegions()

    For Each region In regionsTable
        sb.Append("<a href=''>")
        sb.Append(region.RegionName)
        sb.Append("</a>")
        sb.Append("<br />")
    Next

    Return sb.ToString

End Function 
```

这样我可以避免创建 asp 链接按钮或超链接的重载，并直接在我的表单中注入 html 标签，还可以按照我的意愿定制链接。

# xml - 具有多个谓词的 Xpath 表达式

> ID：568713
> 
> 赞同：48
> 
> 时间：2009-02-20T08:23:24.633
> 
> 标签：xml, xpath, predicate

我正在尝试构建一个复杂的 xpath 表达式，它将回答以下条件。

从下面的 XML 数据中，返回**User**实体：

1.  他的登录名是“ **user1** ”
2.  他的名字是“**用户1** ”
3.  他有 2 个不同的配置文件值，即“**操作员**”和“**管理员**”（我不知道前面的确切顺序）

    ```
    <user>
      <login>user1</login>
      <name>User 1</name>
      <profile>
        <value>admin</value>
        <id>2</id>
        <description>admin users</description>
      </profile>
      <profile>
        <value>operator</value>  
        <id>1</id>
        <description>Operator</description>
      </profile>
    </user>

    <user>
      <login>user2</login>
      <name>User 2</name>
      <profile>
        <value>admin</value>
        <id>4</id>
        <description>admins users</description>
      </profile>
      <profile>
        <value>poweruser</value>  
        <id>5</id>
        <description>power users</description>
      </profile>
    </user>

    </root> 
    ```

有人可以为这种情况提供一个例子吗？

**编辑：添加了一个复杂的配置文件实体**

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-20T08:40:18.997

以下应该做你所追求的：

```
/root/user[login='user1' and 
           name='User 1' and 
           profile='admin' and
           profile='operator'] 
```

对该值进行两次测试`profile`可能看起来很奇怪，但由于存在多个`profile`节点，因此只要至少一个节点与测试匹配，就会满足条件。

您可以`profile`直接与 a进行比较`string`，即使它实际上是 a 的`node`原因是`string-value`元素节点的 是其`string-value`所有后代连接在一起的，在这种情况下，它只是 的内容`value`。

如果`profile`包含的元素多于`value`您必须使用稍微复杂的谓词测试来确定匹配`profile`节点的存在，则仅基于`value`（这应该适用于您更新的问题）：

```
/root/user[login='user1' and 
           name='User 1' and 
           profile[value='admin'] and
           profile[value='operator']] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-20T14:43:09.730

**这是一个更准确的答案**（目前 Greg Beech 的答案不检查条件 3\. 在问题中：`user`元素必须正好有 2 个`profile`孩子）：

```
/*/user
        [login='user1' 
        and            
         name='User 1' 
        and  
         not(profile[3])
        and          
         profile/value='admin' 
        and           
         profile/value='operator'
         ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T08:35:10.910

假设`users`是根：

```
/users/user[login='user1' and name='User 1' 
            and (profile='admin' and profile='operator')] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-27T11:52:08.100

```
/root/user[login='user1' and name='User 1' and profile/value='admin' and profile/value='operator' 
```

# asp.net - ASP.NET 母版页：如何在 aspx 内的 head 部分插入标记？

> ID：568717
> 
> 赞同：7
> 
> 时间：2009-02-20T08:24:07.970
> 
> 标签：asp.net, header, master-pages, declarative

我知道我可以通过这种方式（在代码后面）以[编程方式访问使用母版页的页面的 head 部分：](http://weblogs.asp.net/scottgu/archive/2006/03/24/Access-to-a-page_2700_s-head-element-using-ASP.NET-2.0.aspx)

这*只是一个例子*（我想插入脚本和样式等）：

```
this.Header.Title = "I just set the page's title"; 
```

是否有一种简单的方法可以**在 aspx 文件本身中以****声明**方式执行此操作？

 **有时插入**客户端脚本**或**样式声明**或指向外部资源的链接会很方便。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-20T09:38:48.917

您可以通过在 中使用内容区域来做到这一点，其方式与在页面`head`中的方式完全相同`body`。例如，在您的母版页中：

```
<head>
    <link type="text/css" rel="stylesheet" href="/styles/common1.css" />
    <script type="text/javascript" src="/scripts/common1.js"></script>
    <asp:contentplaceholder id="ExtraStylesAndScripts" runat="server" />
</head> 
```

然后在页面本身就像：

```
<asp:content contentplaceholderid="ExtraStylesAndScripts" runat="server">    
    <link type="text/css" rel="stylesheet" href="/styles/extra1.css" />
    <link type="text/css" rel="stylesheet" href="/styles/extra2.css" />
    <script type="text/javascript" src="/scripts/extra1.js"></script>
    <script type="text/javascript" src="/scripts/extra2.js"></script>
</asp:content> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T08:48:24.343

对于**样式表**，您可以使用：

```
HtmlLink cssRef = new HtmlLink();
cssRef.Href = "addins/main.css";
cssRef.Attributes["rel"] = "stylesheet";
cssRef.Attributes["type"] = "text/css";
Page.Header.Controls.Add(cssRef); 
```

对于**元标签**：

```
HtmlMeta metaTag = new HtmlMeta();
metaTag.Name = "author";
metaTag.Content = "ScarletGarden";
Page.Header.Controls.Add(metaTag); 
```

但是没有办法将外部脚本文件添加到标题元素。

您可以通过以下方式添加内部正文元素：

```
if (!ClientScript.IsClientScriptIncludeRegistered("myExternalScript"))
{
   ClientScript.RegisterClientScriptInclude("myExternalScript", "js/myJSFile.js");
} 
```

希望这可以帮助 ！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T09:00:17.153

您可以在内容页面声明中声明页面标题。

```
<%@ Title="Page Title" Page Language="C#" AutoEventWireup="true" CodeFile="Subpage.aspx.cs" Inherits="Subpage" MasterPageFile="~/MasterPage.master" %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T08:40:07.047

我没试过这个。
但是您可以将 HEAD 元素放在 html 中，并使用 asp 样式标记中的封闭字符串。

例如 `<%=myTitle%>`

# javascript - 监控 location.hash 是 XHR 应用中历史的解决方案吗？

> ID：568719
> 
> 赞同：19
> 
> 时间：2009-02-20T08:25:16.127
> 
> 标签：javascript, ajax, browser-history, xmlhttprequest

众所周知，在 XHR（又名 AJAX）Web 应用程序中，不会为您的应用程序构建历史记录，并且单击刷新按钮通常会使用户退出他/她当前的活动。我偶然发现了 location.hash（例如`http://anywhere/index.html#somehashvalue`）来规避刷新问题（使用 location.hash 来通知您的应用程序它的当前状态并使用页面加载处理程序来重置该状态）。这真的很简单。

这让我开始考虑使用 location.hash 来跟踪我的应用程序的历史记录。我不想使用现有的库，因为它们使用 iframe 等。所以这是我的五分钱：当应用程序页面加载时，我开始：

```
setInterval(
       function(){
           if (location.hash !== appCache.currentHash) {
               appCache.currentHash = location.hash;
               appCache.history.push(location.hash);
               /* ... [load state using the hash value] ... */
               return true;
           }
           return false;
       }, 250
 ); 
```

（*appCache*是一个包含应用程序变量的预定义对象）这个想法是从哈希值触发应用程序中的每个动作。在体面的浏览器中，哈希值更改会在历史记录中添加一个条目，而在 IE (<= 7) 中则不会。在所有浏览器中，向后或向前导航到具有另一个哈希值的页面不会触发页面刷新。这就是间隔函数接管的地方。每次检测到哈希值更改时（以编程方式，或通过单击后退或前进），应用程序都可以使用该功能采取适当的措施。该应用程序可以跟踪它自己的历史记录，我应该能够在应用程序中显示历史记录按钮（尤其是对于 IE 用户）。

据我所知，这可以跨浏览器工作，并且在内存或处理器资源方面没有成本。所以我的问题是：这是否是管理 XHR 应用程序历史的可行解决方案？优缺点都有什么？

更新：因为我使用我的自制框架，我不想使用现有的框架之一。为了能够在 IE 中使用 location.hash 并将其保存在历史记录中，我创建了一个简单的脚本（是的，它需要一个 iframe），它可能对您有用。[我在我的网站上](http://www.nicon.nl/hash2history/)发布了它，请随意使用/修改/批评它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-01T14:20:28.900

大多数解决方案往往会解决三个问题：

1.  返回键
2.  可书签性
3.  刷新按钮

在`window.location.hash`大多数情况下，基于的解决方案可以解决所有三个问题：`hash`映射中的值到应用程序/网页的状态，因此用户可以按“后退”/“前进”/“刷新”之一并跳转到现在的状态哈希。他们还可以添加书签，因为地址栏中的值已更改。（请注意，`iframe`与不影响浏览器历史的哈希相关的 IE 需要隐藏）。

但是，我只想指出，可以使用仅 iframe 的解决方案，而无需监控`window.location.hash`非常有效的解决方案。

谷歌地图就是一个很好的例子。为每个用户操作捕获的状态太大而无法放入 window.location.hash（地图质心、搜索结果、卫星与地图视图、信息窗口等）。所以他们将状态保存到一个隐藏的表单中`iframe`。顺便说一句，这也解决了[软]“刷新”问题。他们通过“链接到此页面”按钮单独解决书签问题。

我只是认为值得了解/分离您正在考虑的问题域。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T17:02:55.590

我认为您将很难知道用户是前进还是后退。假设 url 开始 /myapp#page1 所以你开始跟踪状态。然后用户做一些事情来制作 url /myapp#page2 然后用户做一些事情来再次制作 url /myapp#page1。现在他们的历史是模棱两可的，你不知道要删除什么。

历史框架使用 iframe 来解决您提到的浏览器不一致问题。您只需要在需要它们的浏览器中使用 iframe。

另一个缺点是用户总是会先选择浏览器的后退按钮，然后再选择您的自定义后退按钮。我感觉每 250 毫秒读取一次历史记录的延迟也会很明显。也许您可以将间隔做得更紧，但我不知道这是否会使事情表现不佳。

我使用过 yui 的历史管理器，虽然它在所有浏览器（尤其是 ie6）中并不是一直都能完美运行，但它已经被很多用户和开发者使用。他们使用的模式也非常灵活。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-29T12:26:41.860

所有这些对于支持全系列浏览器都很重要，但希望对它的需求会消失。IE8 和 FF3.6 都引入了对[onhashchange](https://developer.mozilla.org/en/DOM/window.onhashchange)的支持。我想其他人也会效仿。在使用超时或 iframe 之前检查此功能的可用性是一个好主意，因为它确实是目前最好的解决方案 -*它甚至可以在 IE 中使用！*

# c# - 有没有更好的方法来获取每个项目与谓词匹配的子序列？

> ID：568724
> 
> 赞同：4
> 
> 时间：2009-02-20T08:28:54.323
> 
> 标签：c#, linq

假设我有一个 IEnumerable。例如，{2,1,42,0,9,6,5,3,8}。

我需要获得与谓词匹配的项目的“运行”。例如，如果我的谓词是

```
bool isSmallerThanSix(int number){...} 
```

我想得到以下输出：{{2,1},{0},{5,3}}

是否有内置函数可以完成此操作？

到目前为止，我有这个：

```
public static IEnumerable<IEnumerable<T>> GetSequences<T>(this IEnumerable<T> source,
      Func<T, bool> selector) {

        if (source == null || selector == null) {
            yield break;
        }

        IEnumerable<T> rest = source.SkipWhile(obj => !selector(obj));

        while (rest.Count() > 0) {
            yield return rest.TakeWhile(obj => selector(obj));
            rest = rest
                    .SkipWhile(obj => selector(obj))
                    .SkipWhile(obj => !selector(obj));
        }

    } 
```

这似乎有效，但是是我在半夜写的，因此从星期二开始有十五种方式效率低下。有没有更好的，最好是内置的（因此经过良好测试）的方法？

非常感谢你们的时间，

里亚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T08:49:17.507

据我所知，没有内置方法。但是，在 an 上调用`Count`扩展方法`IEnumerable`效率不高，因为它必须枚举列表才能获得计数。因此，我想出了具有相同效果的这个。

```
public static IEnumerable<IEnumerable<T>> 
    GetSequences<T>(this IEnumerable<T> source, Func<T, bool> selector)
{
    // omitted null checks for brevity
    var list = new List<T>();

    foreach(var item in source)
    {
        if (selector.Invoke(item))
        {
            list.Add(item);
        }
        else if (list.Count > 0)
        {
            yield return list;
            list = new List<T>();
        }
    }

    if (list.Count > 0)
        yield return list;
} 
```

正如 Jon Skeet 所提到的，在这种情况下使用`SkipWhile`and`TakeWhile`似乎也非常低效，因为它们将在迭代器上创建迭代器。您可以检查这一点，因为在调试您的示例时它会有点疯狂，因为您逐步尝试查找下一个序列等等，即使示例很简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T08:50:06.757

我怀疑您的代码实际上并非在所有情况下都有效。特别是， SkipWhile 和 TakeWhile 被懒惰地评估 - 如果调用代码实际上没有读取所有产生的`IEnumerable<T>s`（或更糟糕的是，缓冲它们并以不同的顺序读取它们！）我强烈怀疑你会得到错误的结果.

我怀疑您确实需要执行以下操作：

```
public static IEnumerable<IEnumerable<T>> GetSequences<T>(
    this IEnumerable<T> source,
    Func<T, bool> selector)
{
    List<T> current = new List<T>();
    foreach (T element in source)
    {
        if (selector(element))
        {
            current.Add(element);
        }
        else if (current.Count > 0)
        {
            yield return current;
            current = new List<T>();
        }           
    }
    if (current.Count > 0)
    {
        yield return current;
    }
} 
```

（这忽略了错误检查 - 由于迭代器块的延迟执行，您希望在一个单独的方法中执行此操作，然后将此方法作为私有方法调用 - 这是编写生产质量迭代器块时非常常见的模式。）

顺便说一句，选择`List<T>`有点随意——`LinkedList<T>`例如，您当然可以使用 a 代替。或者，如果您*确实*选择了 List，则可以返回`IEnumerable<IList<T>>`而不是返回，`IEnumerable<IEnumerable<T>>`这*可能*会使调用者更容易处理结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T09:34:37.447

不知道我知道我在说什么，但这不会阻止我说话......

定义一种新类型的迭代器是否有意义，当当前完成时可以跳到下一个子序列？

使用 Java 和 Integer 示例语法，客户端代码如下所示：

```
Iterator2<Integer> iter = getSequencences(someCollection, someCriteria)
while (iter.hasNextSequence())
{
  iter.nextSequence();
  while (iter.hasNext())
  {
    Integer i = iter.next();
  }
} 
```

*鸭子*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T12:41:07.060

通过直接使用枚举器，可以产生完全延迟的结果。

我可能会使用 Garry 和 Jon 提供的版本，因为它更简单并且可以完成工作，但是写起来很有趣。

```
public static class Program
{
    static IEnumerable<IEnumerable<T>>
        GetSequences<T>(this IEnumerable<T> source, Func<T, bool> selector)
    {
        var enumerator = source.GetEnumerator();
        while (enumerator.MoveNext())
            if (selector(enumerator.Current))
                yield return TakeWhile(enumerator, selector);
        yield break;
    }

    static IEnumerable<T> 
        TakeWhile<T>(IEnumerator<T> enumerator, Func<T, bool> selector)
    {
        do
        {
            yield return enumerator.Current;
        } while (enumerator.MoveNext() && selector(enumerator.Current));
        yield break;
    }

    static void Main()
    {
        var nums = new[] { 2, 1, 42, 0, 9, 6, 5, 3, 8 };
        var seqs = nums.GetSequences(i => i < 6);

        Console.WriteLine(string.Join(",", seqs.Select(s =>
            string.Format("{{{0}}}",
                string.Join(",", s.Select(i => i.ToString()).ToArray())
            )).ToArray()));
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T16:53:26.517

您可以利用 GroupBy 将按顺序运行项目的事实。

```
 public static IEnumerable<IEnumerable<T>> GetSequences<T>
      (this IEnumerable<T> source, Func<T, bool> predicate)
    {
        bool flag = false;
        int id = 0;
        return source.GroupBy(x =>
            {
                bool match = predicate(x);
                if (match != flag)
                {
                    id += 1;
                    flag = match;
                }
                return new { keep = match, id = id };
            })
            .Where(g => g.Key.keep)
            .Select(g => g.AsEnumerable());
    } 
```

这是一个测试方法：

```
 public static void Test1()
    {
        List<int> myList = new List<int>() {2,1,42,0,9,6,5,3,8};

        foreach (var g in myList.GetSequences(i => i < 6))
        {
            Console.WriteLine("g");
            foreach (int i in g)
            {
                Console.WriteLine(i);
            }
        }
    } 
```

# scala - 基于代理/参与者的并发设计的设计模式

> ID：568727
> 
> 赞同：21
> 
> 时间：2009-02-20T08:31:18.343
> 
> 标签：scala, erlang, actor, agent

最近我一直在研究支持演员/代理/无共享架构的替代语言 - 即。scala、clojure 等（clojure 也支持共享状态）。

到目前为止，我阅读的大多数文档都集中在介绍级别。我正在寻找的是四个更高级的文档，但没有共享任何基础。

为什么 ？它有助于理解设计思维的变化。简单的示例很简单，但在现实世界的 Java 应用程序（单线程）中，您可以拥有具有 1000 个具有复杂关系的成员的对象图。但是随着基于代理的并发开发，它引入了一套全新的想法，以便在设计大型系统时理解。IE。代理粒度 - 一个代理应该管理多少状态 - 对性能等的影响，或者是将共享状态对象图映射到基于代理的系统的良好模式。将域模型映射到设计的技巧。讨论不是关于技术，而是更多关于如何在设计中最好地使用技术（现实世界的“复杂”示例会很棒）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-26T09:42:10.887

即使我无法想出任何好的现实世界示例来直接为您提供设计模式，也有几个地方可以开始。

首先是让你的头脑正确地围绕这些概念。帮助您做到这一点的一本书是由 Erlang Guru Joe Armstrong 编写的[在存在软件错误的情况下构建可靠的分布式系统，](http://erlang.org/download/armstrong_thesis_2003.pdf) 其中以一种非常容易理解的方式解释了面向并发的编程。它实际上是一个博士学位。论文，但不要让那吓到你。与大多数普通教科书相比，它更容易阅读，而且讨价还价。

查看实际系统通常意味着您必须对实际语言了解太多，因为它对于评估事物也很有意义。对于 Erlang，[文档](http://www.erlang.org/doc/design_principles/part_frame.html) 提供了设计方法和行为（Erlang speek for design pattern library）。这将说明此设置中最常用的设计模式。并且这些已被证明在构建大规模系统方面是有效的，即数百万行代码（相当于 Java 等其他语言的 4 到 10 倍）和在分布式机器集群中的一台机器上运行的数百万并发进程。一个真实的实时系统的最新例子是 [Facebook 聊天](http://www.facebook.com/note.php?note_id=51412338919)。

对于其他框架，恐怕我无法真正帮助您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-10T23:38:20.843

An "actor" is itself the unifying pattern for concurrent programming (an asynchronous message queue plus an execution context for processing it), but there are many design patterns which assist in specifying aspects or elements of agent-based systems. Many of the most common can be found in Wikipedia's article on [Concurrency Patterns](http://en.wikipedia.org/wiki/Concurrency_pattern). Some highlights:

*   [Reactor Pattern](http://en.wikipedia.org/wiki/Reactor_pattern)
*   [Mediator Pattern](http://en.wikipedia.org/wiki/Mediator_pattern)
*   [Scheduler Pattern](http://en.wikipedia.org/wiki/Scheduler_pattern)
*   [Observer Pattern](http://en.wikipedia.org/wiki/Observer_pattern)

If you haven't come across it already, [Akka](http://akkasource.org/) may be of interest to you -- it is a "purely" event-driven actor framework running on the JVM.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T09:18:14.740

[我在这里](https://stackoverflow.com/questions/541344/what-problem-characteristics-promote-the-use-of-parallel-concurrent-architectures)问了一个类似的问题，其中有一些合理的答案可能会有所帮助。我在仔细观察你的。我还没有找到真正帮助我的东西，但我非常积极地寻找。

我认为思维转变是迈向并发架构和语言的最大障碍，在此之前，开发人员将坚持使用易于学习的 MS 样式范例。为了让它真正成为主流，它需要找到进入学校的途径，并与 C# 和 VB 一起教授。

我对[2080 程序员问题](https://stackoverflow.com/questions/463628/how-do-you-think-our-grandchildren-will-program-in-2080)的回答是“同时”。

# sql - 如何通过批处理将 SQL 存储过程保存到 .sql 文件

> ID：568734
> 
> 赞同：9
> 
> 时间：2009-02-20T08:34:11.147
> 
> 标签：sql, sql-server-2005, stored-procedures, export

我想将我的 MS SQL Server 2005 存储过程自动保存到 .sql 文件（我更喜欢可以通过 .bat 调用的工具），因此我不必手动单击每个存储过程并保存它。

我已经从 devio IT 找到了 SMOscript，但它收集了所有表和存储过程，这需要一些时间。是否有任何类似的工具可以定义要导出的存储过程？此外，与手动导出为 CREATE 的脚本存储过程相比，我还缺少 SMOScript 未添加到导出文件中的 USE 子句。

最好的问候肖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T16:04:23.093

使用脚本创建批处理文件（对不起格式化，但它确实应该内联执行批处理）：

```
osql -U %1 -P %2 -S %3 -d %4 -h-1 -Q "SELECT ROUTINE_NAME FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_TYPE = 'PROCEDURE'" -n -o "sp_list.txt"
for /f %%a in (sp_list.txt) do osql -U %1 -P %2 -S %3 -d %4 -h-1 -Q "SELECT ROUTINE_DEFINITION FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_NAME = '%%a'" -n -o "%%a.sql" 
```

将其命名为“run.bat”。现在，要执行批处理使用参数：
run.bat [username] [password] [servername] [database]
例如：
run.bat sa pwd111 localhost\SQLEXPRESS master
首先所有存储过程名称将存储在文件 sp_list.txt 中，然后在单独的脚本文件中一一对应。唯一的问题 - 每个脚本的最后一行带有结果计数 - 我正在处理它:)

**已编辑**：已修复查询中的错误

**删除“受影响的行”行**
好的，现在我们需要再创建一批：

```
type %1 | findstr /V /i %2  > xxxtmpfile 
copy xxxtmpfile %1 /y /v
del xxxtmpfile 
```

将其命名为“line_del.bat”。看，第一个参数是要处理的文件，第二个 - 搜索要删除的行的字符串。现在修改主批次（再次抱歉格式化）：

```
osql -U %1 -P %2 -S %3 -d %4 -h-1 -Q "SELECT ROUTINE_NAME FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_TYPE = 'PROCEDURE'" -n -o "sp_list.txt"
call line_del sp_list.txt "rows affected"
call line_del sp_list.txt "row affected"
for /f %%a in (sp_list.txt) do osql -U %1 -P %2 -S %3 -d %4 -h-1 -Q "SELECT ROUTINE_DEFINITION FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_NAME = '%%a'" -n -o "%%a.sql" 
for /f %%a in (sp_list.txt) do call line_del %%a.sql "rows affected"
for /f %%a in (sp_list.txt) do call line_del %%a.sql "row affected" 
```

请参阅相关文章：
[批处理环境中的简单编程命令](http://www.aumha.org/a/batches.php)
[osql Utility](http://msdn.microsoft.com/en-us/library/aa214012(SQL.80).aspx)
[MSSQL：如何使用代码编写存储过程创建脚本？](https://stackoverflow.com/questions/513158/mssql-how-do-you-script-stored-procedure-creation-with-code)
[通过批处理文件删除txt文件中的某些行](https://stackoverflow.com/questions/418916/delete-certain-lines-in-a-txt-file-via-a-batch-file)

:) 你可能会注意到，最后两个来自 SO！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T08:56:39.737

在 SQL Server Management Studio 中有一个替代方案，为数据库编写脚本......

展开对象资源管理器视图以找到数据库，右键单击并选择“任务：生成脚本”

从那里您可以编写所有对象的脚本，只是存储的 preocedures，以及介于两者之间的任何内容。一页上有很多选项，尽管我更改的主要选项是：-“如果不存在则包括”

通过将该选项设置为“FALSE”，您将获得完整的 CREATE 语句列表。

然后，您可以选择将对象编写到新的查询窗口或文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-02T13:38:44.877

添加 SET NOCOUNT ON 确实消除了对 line_del.bat 的需要，但是用 sys.sql_modules 替换 syscomments 会导致每个存储过程被截断为 258 个字符。因此，为了获得最佳结果，我使用的代码是：

```
sqlcmd -E -S SERVER-d DB -h-1 -Q "SET NOCOUNT ON SELECT ROUTINE_NAME FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_TYPE = 'PROCEDURE'" -o "sp_list.txt"
for /f %%a in (sp_list.txt) do sqlcmd -E -S SERVER-d DB -h-1 -Q "SET NOCOUNT ON SELECT text from dbo.syscomments WHERE id = OBJECT_ID('%%a')" -o "%%a.sql" 
```

哪个有效，并且不需要使用 line_del.bat。当我使用 SSMS 向导（任务/生成脚本/存储过程/全选）进行手动导出时，我没有得到的是：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO 
```

在每个 .sql 的开头，以及尾随的 GO 命令。不是非常重要，但有一点需要注意。感谢 Max Gontar、Seansilver 和 Lee 的贡献！我现在可以自动备份数据库中的存储过程，并应用版本控制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T09:00:18.230

不久前我想做同样的事情，最后我做了一个小的 vbscript。

看这里[源代码控制和存储过程](https://stackoverflow.com/questions/468703/source-control-and-stored-procedures)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T09:41:56.100

我使用了 sqlcmd 和 -E 而不是用户，通过。到目前为止，这工作正常，只有超过 4000 个字符的存储过程会有换行符

```
sqlcmd -E -S SERVER -d DB -h-1 -Q "SELECT ROUTINE_NAME FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_TYPE = 'PROCEDURE'" -o "sp_list.txt"
call line_del sp_list.txt "rows affected"
call line_del sp_list.txt "row affected"
for /f %%a in (sp_list.txt) do sqlcmd -E -S SERVER -d DB -h-1 -Q "SELECT text from dbo.syscomments WHERE id = OBJECT_ID('%%a')" -o "%%a.sql"
for /f %%a in (sp_list.txt) do call line_del %%a.sql "rows affected"
for /f %%a in (sp_list.txt) do call line_del %%a.sql "row affected" 
```

最好的问候肖恩

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T15:53:18.133

我添加了 SET NOCOUNT ON 以消除对 line_del.bat 的需要。还将 syscomments 替换为 sys.sql_modules (SQL 2005)。我也可以使用 OBJECT_DEFINITION 函数，但它比 sys.sql_modules 慢。

```
sqlcmd -E -S SERVER -d DB -h-1 -Q "SET NOCOUNT ON SELECT ROUTINE_NAME FROM INFORMATION_SCHEMA.Routines WHERE ROUTINE_TYPE = 'PROCEDURE'" -o "sp_list.txt" for /f %%a in (sp_list.txt) do sqlcmd -E -S SERVER -d DB -h-1 -Q "SET NOCOUNT ON SELECT definition from sys.sql_modules WHERE object_id = OBJECT_ID('%%a')" -o "%%a.sql" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-07T05:31:26.547

感谢以上所有人的帮助，并将其留在这里，以供像我这样的其他 sqlcmd 菜鸟找到。适用于 sql server 2005。objectName 是一个过程、视图等名称。

```
:reset

-- :setvar ObjectName "objectName"  -- works
:setvar ObjectName objectName  -- works too
declare @sql varchar(max);
set @sql = 'select text from dbo.syscomments where id = object_id(upper("' + '$(ObjectName)' + '"))';
-- exec sp_helptext $(ObjectName)  -- quick n easy but gets chopped to 256 width
/*   4000 byte limit
set @sql = 
   'select view_definition 
    from information_schema.views 
    where upper(table_name) = upper("' + '$(ObjectName)' + '")';
*/
:out $(ObjectName).sql

exec(@sql)
go

:out stdout 
```

# variables - 创建曾经使用过的变量是一种好习惯吗？

> ID：568751
> 
> 赞同：25
> 
> 时间：2009-02-20T08:41:08.010
> 
> 标签：variables, refactoring, coding-style

我的一位同事重构了这段代码：

```
private void btnGeneral_Click(object sender, RoutedEventArgs e)
{
    Button button = (Button)e.OriginalSource;
    Type type = this.GetType();
    Assembly assembly = type.Assembly;
    string userControlFullName = String.Format("{0}.{1}", type.Namespace, button.Name);
    UserControl userControl = (UserControl)assembly.CreateInstance(userControlFullName);
} 
```

到这段代码：

```
private void btnGeneral_Click(object sender, RoutedEventArgs e)
{
    Button button = (Button)e.OriginalSource;
    Type type = this.GetType();
    Assembly assembly = type.Assembly;
    UserControl userControl = (UserControl)assembly.CreateInstance(String.Format("{0}.{1}", type.Namespace, button.Name));
} 
```

说如果只使用一次，则不需要创建变量。

我的回答是，制作曾经使用过的变量是一种很好的做法，因为它：

*   用作并减少注释（很清楚“userControlFullName”是什么）
*   使代码更易于阅读，即更多的代码“读起来像英语”
*   通过用清晰的变量名替换部分语句来避免超长语句
*   更容易调试，因为您可以将鼠标悬停在变量名上，并且在没有调试器的 PHP 编程等情况下，更容易回显这些变量名以获取它们的值

反对这种方式的“更多代码行”、“不必要的变量”的论点是让编译器的生活更轻松，但没有显着的速度或资源节省。

谁能想到不应该创建曾经使用过的变量名的任何情况？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-20T08:46:56.640

在这种情况下，我同意你的意见。可读性是关键。我确信编译器在这两种情况下都会生成相同的可执行文件，并且编译器和现在一样智能。

但我也不会声称“总是使用曾经使用过的变量”。例子：

```
String name = "John";
person.setName(name); 
```

是不必要的，因为

```
person.setName("John"); 
```

读起来同样好——如果不是更好的话。但是，当然，并非所有情况都如此明确。毕竟，“可读性”是一个主观术语。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-20T08:45:20.230

你所有的理由对我来说似乎都是有效的。

在某些情况下，您实际上*必须*避免使用中间变量，在这种情况下您需要一个表达式（例如，用于 Java/C# 中的成员变量初始化），但为了清楚起见，在适用的情况下引入一个额外的变量绝对没问题。显然不要对*每个方法的**每个*参数都这样做，但适度它可以帮助很多。

 *调试参数特别强大 - 能够*跨过*为方法“准备”参数的行，并直接进入方法本身，在调试器中轻松查看参数，这也非常好。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-20T08:58:16.847

您的同事似乎并不一致。

一致的解决方案如下所示：

```
private void btnGeneral_Click(object sender, RoutedEventArgs e)
{
    UserControl userControl = ((UserControl)type.Assembly).CreateInstance(String.Format("{0}.{1}", this.GetType().Namespace, ((Button)e.OriginalSource).Name));
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-20T08:47:12.910

在这一点上，我完全同意你的看法。

如果一个方法需要很多布尔值，我特别使用它，即

```
public void OpenDocument(string filename, bool asReadonly, bool copyLocal, bool somethingElse) 
```

对我来说，这更具可读性：

```
bool asReadonly = true;
bool copyLocal = false;
bool somethingElse = true;

OpenDocument("somefile.txt", asReadonly, copyLocal, somethingElse); 
```

..比：

```
OpenDocument("somefile.txt", true, false, true); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-20T08:46:09.433

由于我使用的编程语言通常不会告诉我异常堆栈跟踪中的空值是*什么*，因此我通常尝试使用变量，以便每行不超过一个项目可以为空。实际上，我发现这是我想在一行中放置多少语句的最重要限制因素。

如果您从生产日志中获得此语句中的 nullpointerexception，那么您真的有麻烦了：

getCustomer().getOrders().iterator().next().getItems().iterator().next().getProduct().getName()

虽然我同意你的想法，但是添加一个额外的变量可以在方法中引入一个额外的概念，这个概念可能并不总是与方法的总体目标相关。因此过度添加变量也会*增加*方法的复杂性并降低易读性。注意这里使用*excess*。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-20T08:50:16.427

两个代码完全相同。当然，您的代码更具可读性、可维护性和可调试性，但是，如果这是您同事的观点，那么他的代码并不是内存较少的消费者。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-20T08:51:06.723

我认为这是根据您希望代码的整洁程度做出的判断。我也认为你和你的同事都是对的。

在这种情况下，我会根据您提供的代码（出于性能原因）支持您的同事，但是正如我之前所说，它确实取决于使用它的上下文，我认为您的立场是完全可以接受的。

我要指出，为曾经使用过的参数创建变量可能毫无意义，除非它们是 const 变量或您需要在许多地方使用的东西。

我会争辩说，如果有很多这样的变量，那么在调试时声明一个曾经使用过的变量可能会造成更多的混乱，但在这里和那里可能没问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-20T08:53:25.640

我猜在某些情况下它可能会对性能产生影响。特别是在这个例子中：

```
for (int i1 = 0; i1 < BIG_NR; i1++)
{
  for (int i2 = 0; i2 < BIG_NR; i2++)
  {
    for (int i3 = 0; i3 < BIG_NR; i3++)
    {
      for (int i4 = 0; i4 < BIG_NR; i4++)
      {
        int amount = a + b;
        someVar[i1][i2][i3][i4] = amount;
      }
    }
  }
} 
```

...额外的分配可能会对性能产生太大的影响。但总的来说，你的论点是 100% 正确的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-20T10:49:11.853

我原则上完全支持你的同事，但在这种情况下不是。

一次性变量的问题在于它们引入了状态，更多的状态意味着代码更难理解，因为你不知道它会对程序的流程产生什么影响。正是由于这个原因，函数式编程根本没有变量。所以变量越少越好。消除变量是好的。

However, in this particular case, where the method ends right after the variable's only use, the disadvantages of having it are minimal, and the advantages you mention are probably more substantial.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-20T09:03:46.457

努力提出反对引入新变量的论点我会说，当您阅读代码时（至少是第一次），您不*知道*该变量是否被多次使用。因此，您将立即让您的眼睛向下扫描代码，看看它是否在更多地方使用。功能越长，您就越需要查看是否可以找到它。

这是我能想到的最好的*反对理由！*:-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-20T09:25:21.307

创建一个新变量意味着读者需要跟踪的另一个概念。（考虑极端情况：int b=a;c=b;）如果一个方法如此复杂——需要分解——额外的概念是值得付出的代价，那么你应该全力以赴并拆分它分为两种方法。这样您就可以获得有意义的名称和较小的尺寸。（对于您的原始方法来说更小：如果就像您说的那样，那么人们通常不需要阅读辅助方法。）

这是一种概括，尤其是在一种具有大量用于添加新方法的样板的语言中，但您不会经常不同意这种概括，以至于值得将其从您的风格指南中删除。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-20T09:19:43.347

我同意这里的大多数人，代码可读性是关键。

它是一个罕见的行数十字军，实际上编写了高度可读、高度可维护的代码。

此外，无论如何，它都会被编译成 MSIL，编译器会为你优化很多。

在以下示例中，编译器无论如何都会优化代码：

```
List<string> someStrings = new List<string>();
for (int i = 0; i < 1000; i++)
{
    string localString = string.Format("prefix{0}", i);
    someStrings.Add(localString);
} 
```

而不是：

```
List<string> someStrings = new List<string>();
string localString = string.Empty;
for (int i = 0; i < 1000; i++)
{
    localString = string.Format("prefix{0}", i);
    someStrings.Add(localString);
} 
```

因此，在许多情况下，确实没有不使用它的性能理由。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-20T09:29:58.783

这就是我过去编码的方式。现在我试图最小化中间变量。如果中间变量是不可变的，那么使用中间变量是非常好的。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-20T08:47:30.413

同意

> “使代码更易于阅读，即您的代码更多”“读起来像英语”

我认为这是最重要的因素，因为大多数现代托管语言的性能或功能没有差异

毕竟我们都知道代码比写更难读。

卡尔

# .net - 多个小组件或一个大组件哪个更好？

> ID：568780
> 
> 赞同：14
> 
> 时间：2009-02-20T08:51:36.207
> 
> 标签：.net

一切都在标题中:)

目前，我们有 20 多个项目的 VS2005 解决方案。像

```
MySolution
MySolution.Modules.Foo
MySolution.Modules.Bar
[insert many here]
MySolution.Modules.Baz 
```

在一个项目中“合并” MySolution.Modules.* 会有危害吗？所有命名空间都将被保留，所以这里没有问题。

但是有什么我没有想到的吗？

注意：目前，不能有循环引用：如果 MySolution.Modules.Foo 引用 MySolution.Modules.Bar，MySolution.Modules.Bar 不能引用 MySolution.Modules.Foo。所以我们必须小心不要创建一些。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-20T08:56:38.520

我曾在几家公司工作过，那里有太多的项目在各个方面都是一种痛苦。我还没有去过任何项目太少*的*地方，尽管这当然是可能的。

除其他外，将项目视为重用单元。是否有任何产品需要 Foo 而不需要 Bar，反之亦然？如果没有，请将它们合并在一起。

我喜欢将不同的层（表示、业务逻辑、数据访问）分开，拥有一个通用的、与产品无关的实用程序库很好，但在很多情况下就是这样。

哦，当然，将测试保存在与您的生产代码不同的项目中 :)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-20T08:55:43.920

一个组装的优点：

*   潜在性能
*   可能更容易部署

许多组件的优点：

*   **其他一切**。假设这些是良好的内聚模块，它有助于分离关注点，通过迫使您考虑架构的水平/分层等来检查依赖关系。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-28T05:34:53.560

我们使用[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)将我们所有的小程序集绑定到一个更大的块中。尤其是位于不同项目中但最终属于同一名称空间的程序集。

例如，我们有很多用于记录和视图的数据实体，分布在许多程序集中，MJ.DE.views.dll、MJ.DE.tables.dll、MJ.DE.sprocs.dll 等，但最终我们使用 ILMerge 将它们绑定到一个 MJ.DE.DLL 中。- 使更新/同步应用程序更容易，因为生产服务器上需要处理的部分更少，而且我们知道所有相关的类都来自同一个编译。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T08:59:09.823

编译时间。如果您将项目分解为多个部分，则只需编译已修改的部分。如果它是一个大项目的一部分，那么每次更改某些内容时都必须重新编译所有内容。根据您的项目有多大，这可能很重要。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-20T08:59:57.450

一方面，如果你有大量项目，Visual Studio 加载解决方案的时间就会越来越长，而不是少数项目中有大量代码。

这不一定是一个足够好的理由，只拥有一个项目，而不是这里提到的所有其他项目，但要记住一些事情。

# asp.net - jQuery模态表单对话框回发问题

> ID：568784
> 
> 赞同：27
> 
> 时间：2009-02-20T08:53:36.983
> 
> 标签：asp.net, jquery-ui, postback

我创建了一个[jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)模态表单，我希望该表单触发回发，但我很难让它工作。

我知道有很多基于使用 SimpleModal 插件的文章，我尝试调整这些并覆盖 _doPostback 函数，但没有任何乐趣。

我认为问题在于对我的 __doPostBack 函数的调用以及参数应该是什么。是这样吗？

这是我的表格

```
<form id="summaryForm" runat="server">
    <div id="dialog" title="Quick Booking">
        <p>Select user from list or enter name in box</p>
        <fieldset>
            <p><label>Is machine going out of the office?</label></p>
            <asp:RadioButton  TextAlign="Left" GroupName="outOfOffice" Text="Yes" ID="optYes" class="radio" runat="server" />
            <asp:RadioButton  TextAlign="Left" GroupName="outOfOffice" Text="No" ID="optNo" class="radio" runat="server" Checked="true" />

            <label for="dropLstUser">User:</label>
            <asp:DropDownList ID="dropLstUser" runat="server" />
            <input type="text" name="txtUser" id="txtUser" value="" class="text" />
            <label for="txtStartDate">Start Date:</label>
            <input type="text" id="txtStartDate" name="txtStartDate" class="datepicker" />
            <asp:HiddenField ID="assetField" runat="server" />
            <%--<button onclick="performPostBack('summaryForm')">Postback</button>--%>
        </fieldset>
    </div>
    //-------------------------------- 
```

这是 JavaScript 代码：

```
<script type="text/javascript">
    $(function() {
        $("#dialog").dialog({
            bgiframe: true,
            height: 300,
            modal: true,
            buttons: {
                'Close': function() {
                             alert("closing");
                             $(this).dialog("close");
                             __doPostBack = newDoPostBack;
                             __doPostBack("aspnetForm",null);
                         }
            }
        });
    });

    function newDoPostBack(eventTarget, eventArgument)
    {
        alert("postingback");
        var theForm = document.forms[0];

        if (!theForm)
        {
            theForm = document.aspnetForm;
        }

        if (!theForm.onsubmit || (theForm.onsubmit() != false))
        {
            document.getElementById("__EVENTTARGET").value = eventTarget;
            document.getElementById("__EVENTARGUMENT").value = eventArgument;
            theForm.submit();
        }
    }
</script> 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-03-03T21:14:31.400

创建对话框后，只需将对话框移回您的表单。例子：

```
 $("#divSaveAs").dialog({bgiframe:false,
                            autoOpen:false,
                            title:"Save As",
                            modal:true});
    $("#divSaveAs").parent().appendTo($("form:first")); 
```

这对我有用。回发作品找到。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-05-11T11:11:31.077

请注意，jQuery UI v1.10 中有一个附加设置。添加了一个 appendTo 设置，以解决您用于将元素重新添加到表单的[ASP.NET解决方法。](http://en.wikipedia.org/wiki/ASP.NET)

尝试：

```
$("#dialog").dialog({ autoOpen: false, height: 280, width: 440, modal: true, appendTo:"form" }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-31T03:39:53.850

“AppendTo”选项对我有用。

$("#dialog").dialog({ ..., appendTo:"form" });

请参阅：[http ://api.jqueryui.com/dialog/#option-appendTo](http://api.jqueryui.com/dialog/#option-appendTo)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T14:30:10.063

我使用的一个厚颜无耻的技巧是在页面上的 div 中创建一个普通的[.NET](http://en.wikipedia.org/wiki/.NET_Framework)按钮以及文本框等，使用 jQuery 获取该div 的[HTML](http://en.wikipedia.org/wiki/HTML)，将其添加到对话框中，然后删除原始中的 HTML div 以避免 id 重复。

```
<div id="someDiv" style="display: none">
    <p>A standard set of .net controls</p>
    <asp:TextBox ID="textBoxl" runat="server" CssClass="required email"></asp:TextBox>
    <input id="button1" type="button" value="Confirm"  onclick="SomeEvent();" />
</div> 
```

和脚本：

```
var html = $("#someDiv").html();
$("#dialog").append(html);
$("#someDiv").remove();
$("#dialog").dialog({
        bgiframe: true,
        height: 300,
        modal: true
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-19T12:58:16.943

非常感谢 csharpdev 的帖子！以下代码为我的页面完成了它：

```
$("#photouploadbox").dialog({
    autoOpen: false,
    modal: true,
    buttons: { "Ok": function() { $(this).dialog("close"); } },
    draggable: false,
    minWidth: 400 });

$("#photouploadbox").parent().appendTo($("form#profilform")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T09:00:04.063

```
'Close': function() {
             alert("closing"); 
             $(this).dialog("close"); 
             __doPostBack = newDoPostBack; 
             __doPostBack("aspnetForm", null); 
         }}});}); 
```

__doPostBack 函数获取导致回发的控制权和一个参数（如果需要）。您的 JavaScript 示例和您的标记似乎不匹配。例如，在我上面引用的地方，您引用 aspnetForm，将其更改为表单的 ID，然后重试。

确保您用于客户端脚本的 ID 与运行时[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)控件的客户端 ID 相同。如果控件驻留在 INamingContainer 中，那么它将具有基于其父容器的唯一 ID，因此 YourControlID 将变为 YourINaminContainerID_YourControlID。

让我们知道结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T15:30:39.710

我设法解决了这个问题——可能不是最好的方法，但这就是我所做的。

该对话框不会回发，因为[jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)将提交按钮从表单中取出并将其附加到正文标记的底部，因此当您尝试回发按钮时，它不知道它正在发布什么。

我通过改变这个来修改jQuery UI代码来解决这个问题：

```
uiDialog = (this.uiDialog = $('<div/>'))
               .appendTo(document.body)
               .hide()
               .addClass(
                       'ui-dialog ' +
                       'ui-widget ' +
                       'ui-widget-content ' +
                       'ui-corner-all ' +
                       options.dialogClass
               ) 
```

对此：

```
uiDialog = (this.uiDialog = $('<div/>'))
               .appendTo(document.forms[0])
               .hide()
               .addClass(
                       'ui-dialog ' +
                       'ui-widget ' +
                       'ui-widget-content ' +
                       'ui-corner-all ' +
                       options.dialogClass
               ) 
```

修改源库并不理想，但总比没有好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-15T03:12:52.893

当我使用它时，它按预期工作

```
$("#divDlg").dialog("destroy"); 
```

代替

```
$("#divDlg").dialog("close").appendTo($("#Form1")).hide(); 
```

当我们追加到表单并重新打开对话框时，我遇到了布局和 z-index 的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-11T19:24:13.000

如果我每个都有一个，我可以让这个工作。一个div，一个脚本，一个链接。在我的例子中，对话框允许用户为每个数据库记录留下一个“注释”。我的对话框上没有任何按钮，只有默认的右上角“x”来关闭对话框。

但我试图让它在[ColdFusion](http://en.wikipedia.org/wiki/Adobe_ColdFusion)查询循环中工作。多条记录，每条记录都有自己的对话框按钮、关联的脚本和 div。我正在动态更改 ID，因此它们都是唯一的（也就是说，将 _XX 附加到所有 ID 中，其中 XX 是记录的主键）。

当我扩展到这个模型时，有多个对话框、脚本、div。如果我打开每个对话框来编辑该记录的相应“注释”，它只会保存最后一个。我应该在按钮单击时自动执行 .parent().appendTo 吗？某处变得混乱。

如果我不打开任何对话框（不通过对话框进行任何更改）并对表单结果运行转储，我会看到所有对话框字段都按预期在帖子中出现。

当我查看生成的原始 HTML 时......所有的 ID 都是唯一的并且被适当地调用。我在想我在某处发生冲突的名称/ID，但在这方面看起来一切都很好。

我的脚本：

```
<script type="text/javascript">
    // Increase the default animation speed to exaggerate the effect
    $.fx.speeds._default = 1000;
    $(function() {
        $( "##dialog#getALLFacilityEquipOrders.order_id#" ).dialog({
            autoOpen: false,
            show: "blind",
            hide: "explode",
            width: 500,
            resizable: false
        });

        $('.countable2').jqEasyCounter({
            'maxChars': 2000,
        });

        // Dialog Link
        $('##dialog_link#getALLFacilityEquipOrders.order_id#').click(function(){
            $('##dialog#getALLFacilityEquipOrders.order_id#').dialog('open');
            return false;
        });

        //hover states on the static widgets
        $('##dialog_link#getALLFacilityEquipOrders.order_id#, ul##icons li').hover(
            function() { $(this).addClass('ui-state-hover'); },
            function() { $(this).removeClass('ui-state-hover'); }
        );

        $("##dialog#getALLFacilityEquipOrders.order_id#").parent().appendTo($("form##allequipedit"));
    });
</script> 
```

我的分区：

```
<div id="dialog#getALLFacilityEquipOrders.order_id#"
     title="Notes For #getALLFacilityEquipOrders.cLicenseNumber# - Order ID: ORD-#getALLFacilityEquipOrders.order_id#"
     style="display:none;">

    <cfquery datasource="#a_dsn#" name="getOrderNotes">
        select notebody
        from QIP_EquipOrders_Notes
        where fk_order_id = #getALLFacilityEquipOrders.order_id#
    </cfquery>
    <fieldset class="qip_menu">
        <label><b>Enter/Edit Notes:</b></label>
        <textarea class="countable2"
                  id="notebody_#getALLFacilityEquipOrders.order_id#"
                  name="notebody_#getALLFacilityEquipOrders.order_id#"
                  rows="10"
                  cols="75">#getOrderNotes.notebody#</textarea>
    </fieldset>
</div> 
```

我的按钮：

```
<a href="##"
   id="dialog_link#getALLFacilityEquipOrders.order_id#"
   class="ui-state-default ui-corner-all"
><span class="ui-icon ui-icon-newwin"></span>Notes</a> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-04T06:29:47.930

要在将对话框附加到表单时消除动画故障，以下是策略。

```
open: function (event, ui) {
     var dg = $(this).parent();
     setTimeout(function () { dg.appendTo("form"); }, 1000);
}); 
```

# online-storage - 有哪些在线解决方案可以从任何地方轻松访问我的源代码？

> ID：568792
> 
> 赞同：3
> 
> 时间：2009-02-20T08:57:47.690
> 
> 标签：online-storage

我是一名大学生，在任何给定时间，我都有 4-5 个程序，我正在为各种课程/项目用各种语言编写。

在一天中的任何特定时间，我都可能在图书馆、家里、我们任何不同的计算机实验室教室等。

现在，我目前的工作方式是在每个课程或编码会议结束时，我用适当的主题行向自己发送我正在处理的任何内容的当前状态（即“MIPS 组装实验室 2，修订版 #3”） .

但是，这变得很麻烦，我正在寻找其他解决方案。

限制：

1.  **没有拇指驱动器**。我尽可能地心不在焉，同时仍然以某种方式设法发挥作用。我会失去它。

2.  **仅限便携式或 Web 应用程序**。我无法安装不可移植的可执行文件。所以，如果一个工具需要安装向导或管理权限，我就不能使用它。但是，我可以使用可移植的可执行文件，它们存储在我们分配给每个学生的网络驱动器空间中。因此，这可能会带来一些可能性。

我正在寻找某种在线存储，我可以轻松地为我的项目下载最新文件或更新在线存储中的文件，尽可能减少摩擦。

我考虑过使用一些免费的版本控制存储库并试图找到一个可移植的可执行文件或网络工具，我可以用它来集成它，但我想知道它是否可能是矫枉过正。我并不是真的要保留修订历史。

我看过有关[Dropbox](https://www.getdropbox.com/)之类的视频，这似乎是朝着正确方向迈出的一步。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T09:00:39.320

一个好的解决方案是在一些提供 shell（例如[Dreamhost](http://www.dreamhost.com/)）的托管服务提供商处获得一个帐户并远程完成您的工作。这样，您始终拥有一个一致的环境，您可以从任何地方 ssh 进入。

[找到一个随处运行的 SSH 客户端](http://www.chiark.greenend.org.uk/~sgtatham/putty/)比找到一个随处运行的文件共享或修订控制系统要容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T09:04:04.057

www.github.com？

Git 二进制文件应该可以在没有任何安装过程的情况下使用（我没有在那里得到“便携式”部分，因为你没有提到任何关于你的工作环境的内容）。

或者，或者，一个拇指驱动器 git 存储库，尽管您说过您不想使用拇指驱动器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T10:31:25.047

最简单的解决方案（如果您可以与世界共享代码），就是在[Google 代码](http://code.google.com/hosting/createProject)上创建一个项目。这为您提供了一个 subversion 存储库和一个 wiki，用于对您的想法进行排序，还为您的 TODO 列表提供了一个问题跟踪器。

今天，在您的情况下，我更喜欢 Subversion，原因有两个：

1.  有一个适用于 Windows 的命令行独立客户端（只是几个不需要安装的文件）。Git 需要 Cygwin 或 MinGW 以及某种 Unix 环境。太麻烦了。
2.  使用起来比 Git 简单一些。Git 要求你的大脑进行范式转换，除非你做对了，否则 Git 会感到“奇怪”。

对于大型项目的专业工作，我更喜欢 Git :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T09:17:52.523

CVS、Subversion 和 GIT 都允许在网络共享上创建存储库。他们都不鼓励这样做，因为在网络中断的情况下，存储库可能会损坏。

因此，如果您经常出现网络中断，这可能不是一个选择，但坦率地说，今天大多数网络都相当稳定。在我使用 VCS 的 15 年中，我从来没有对股票进行过损坏的回购。大多数网络文件系统会尽最大努力提交挂起的写入，因此除非服务器完全死机，否则数据将在打嗝结束时保存。

但是，如果您仍然担心，请使用 git，因为它允许从本地副本中以最小的数据丢失还原主存储库（有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/552832/how-to-restore-git-after-fatal-file-system-error)）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T09:14:26.497

[您可以在drivehq](http://www.drivehq.com/secure/signup.aspx)上获得一个免费帐户来存储多达 1GB 的数据。没什么特别的，但是如果您正在寻找放置软件的地方，它可能会成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T09:32:52.987

您可能想查看[**Bespin**](https://bespin.mozilla.com/)：

> Bespin 是 Mozilla 实验室的一个实验，它提出了一个开放的、可扩展的基于 Web 的代码编辑框架。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T15:19:20.173

我使用[Dreamhost 的集成 SVN](http://www.dreamhost.com/hosting-features.html#svn)。他们有一个用于设置存储库和用户帐户的界面。我在一个安装了 SVN 的 mac 上工作，所以对我来说整个事情完全没有痛苦。单击几下，将 SVN 指向我的服务器，我就可以开始了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T09:04:14.290

我们使用[CVSDude](http://cvsdude.com/)，谁做 CVS 和 SVN，这是一项付费服务​​，每月 6 美元 = 2.5 亿美元，效果非常好，虽然也许你想要一些免费的东西？

# c# - 您对一组编码标准或最佳实践有什么好的建议/链接可以遵循吗？

> ID：568804
> 
> 赞同：8
> 
> 时间：2009-02-20T09:03:35.180
> 
> 标签：c#, .net, c++, coding-style

对于我们这些已经足够编程的人，我确信我们遇到了许多不同风格的编码标准，您可以在编程时使用它们。

例如[http://msdn.microsoft.com/en-us/library/ms229042.aspx](http://msdn.microsoft.com/en-us/library/ms229042.aspx)

您可能会从您工作的当前公司或您正在处理的代码的原始作者那里获得您的编码标准。编码风格通常用于特定的程序语言，一种编码语言中的某些风格可能不适合其他语言。当然，一些编码标准可以应用于许多不同的程序语言。

感谢您的时间。

编辑：我们知道有很多关于这个主题的相关文章，但是[C# 编码标准/](https://stackoverflow.com/questions/14967/c-coding-standard-best-practices) SO 中的最佳实践有一些非常有用的链接，值得一看。（查看 ESV 的 .NET/C# 指南上的 2 个链接 - 已接受的答案）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-20T09:07:53.327

[谷歌在这里](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)发布了一个 C++ 风格指南，我有时会参考。只是阅读解释和推理，不管你最终是否同意某些风格，可能会教给你一些你可能没有想到的东西。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-20T09:09:37.287

关于编码标准，我最好的建议是：在尝试完成工作时不要让它们妨碍工作。

一个庞大的官僚机构实际上可能会阻碍项目的进展，而不是帮助实现更好的团队合作。当人们抱怨没有遵循编码标准而不是代码的实际质量时，那就是监管太多了。

除此之外，从众多建议中选择一个并尝试尽可能长时间地坚持下去，以按照您习惯的单一标准构建代码库。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-20T09:12:21.803

编码标准是好的，但公司重新发明轮子从头开始编写的编码标准，或由单个“先知”强加的编码标准，可能比根本没有编码标准更糟糕。

这表示：

*   应讨论并商定编码标准。
*   编码标准文件应包括每条规则背后的原因。
*   编码标准应至少部分基于可靠来源。

我所知道的标签中语言的来源是：

*   对于 C++：Sutter/Alexandrescu所著的**[C++ 编码标准一书。](http://www.gotw.ca/publications/c++cs.htm)**
*   对于 C#：4 或 5 个 PDF，我发现谷歌搜索 C# 编码标准 :)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-20T12:58:24.477

Adam Cogan 在他的网站上有一套很棒的规则。有编码指南，但还有更多。

[亚当科根更好的规则...](http://www.ssw.com.au/ssw/Standards/Default.aspx)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-20T09:08:57.960

编码标准很棒。我们一直在使用[Lance Hunt 的 C# Coding Standards for .NET](http://weblogs.asp.net/lhunt/pages/CSharp-Coding-Standards-document.aspx)几乎没有修改

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-20T09:07:09.960

如果您正在维护的代码继续使用与开发原始代码相同的标准（没有什么比在代码看起来很糟糕时尝试调试问题更糟糕的了）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-20T10:18:26.810

对帖子的一些评论建议查看 Google C++ 指南。关于这些指南某些方面的详细讨论发布在[comp.lang.c++.moderated](http://groups.google.ch/group/comp.lang.c++.moderated/browse_frm/thread/d7b0a5c663467471/ec4c733dd30b34e3?hl=de&tvc=1&q=hope+spread&fwc=2)。

一些奇怪或有争议的观点包括：

> 我们不认为异常的可用替代方法（例如错误代码和断言）会带来很大的负担。

好像断言是一个可行的替代方案......断言通常用于编程错误和不应该发生的情况，而异常可能在执行流程中发生（在某种程度上是预期的）。

> 引用参数：所有通过引用传递的参数都必须标记为 const。...事实上，输入参数是值或 const 引用，而输出参数是指针，这是一个非常严格的约定。

没有评论，关于黄鼠狼短语*一个非常强烈的约定*。

> 在构造函数中做工作：在构造函数中只做简单的初始化。如果可能，请使用 Init() 方法进行非平凡的初始化。...如果您的对象需要非平凡的初始化，请考虑使用显式 Init() 方法和/或添加指示对象是否已成功初始化的成员标志。

是的...两阶段初始化使事情变得更简单...如果我有`const`字段怎么办？这条规则很可能是对例外的态度的影响。

> 仅将流用于日志记录

哪些流？IOStreams，标准 C 流，其他？

一方面，他们建议仅在特殊情况下使用宏，而他们建议使用 DISALLOW_COPY_AND_ASSIGN 来禁止复制/分配。他们本可以通过特殊课程（例如在 Boost 中）建议该方法

> 除非在极少数特殊情况下，否则不要重载运算符。

用于数值计算等的赋值或算术运算符呢？

> 默认参数更难维护，因为从以前的代码复制和粘贴可能不会显示所有参数。当默认参数不适用于新代码时，代码段的复制和粘贴可能会导致严重问题。

什么？从以前的代码复制/粘贴？

**请记住**，阅读任何指南都会对您的思维方式产生偏见。有时它对您或您的代码没有好处。我同意其他一些建议事先阅读好作者的好书的帖子。当您有足够的*知识*时，您就可以查看指南并轻松找到优点和缺点，而不会在您的大脑中造成混乱；）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-20T09:06:08.653

*   [Sun Java 代码约定](http://java.sun.com/docs/codeconv/)
*   [Python 风格指南](http://www.python.org/dev/peps/pep-0008/)
*   [PHP 的 Zend 编码标准](http://framework.zend.com/manual/en/coding-standard.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-20T09:13:25.123

对于Java 和其他C 系列语言，我推荐[Sofware Monkey 的编码标准](http://www.softwaremonkey.org/Article/CodingStandards)（当然，因为它们是我的）。

一般来说，保持它们简单，并为每个要求提供示例和理由。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-20T09:20:53.873

如果您打算向现有的编程团队引入代码格式标准，请从团队的每个成员那里获得意见，这样他们就会“接受”并更有可能按照该标准编写代码。

编程风格和习惯一样难以改变，你必须接受有些人不会让他们的代码在 100% 的时间里 100% 兼容。值得您花时间找到（或编写自己的）漂亮的打印机程序并定期通过它运行您的所有代码以强制一致性。（当手动检查仅包含对其他人代码的格式更正的源代码更改时，我总是感到不安；我担心别人会给我贴上吹毛求疵的标签。）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-20T10:28:02.607

问[了这个问题](https://stackoverflow.com/questions/14967/c-coding-standard-best-practices)。我发现[接受的答案](https://stackoverflow.com/questions/14967/c-coding-standard-best-practices/14974#14974)证明足以满足我的需求。

但是，我意识到这不是一个“一刀切”的场景，因此线程中有大量信息，您可能会发现或多或少有用。值得一读！

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-20T09:32:57.200

标准中的内容并不重要。重要的是您拥有一个，并且您的开发人员遵循它。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-20T09:34:14.763

它并没有完全回答这个问题，但值得一提......

我阅读了[Steve McConnell 的 Code Complete](http://cc2e.com/)。虽然它没有为您提供一套预先制定的编码标准，但它确实为各种方法提供了很多很好的论据。它会让你想到以前没有想到的事情。

它改变了我的小世界。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-04-30T08:32:28.227

编码标准本身非常棒，但我认为更重要的是要与您维护的任何代码的风格保持一致。我已经看到人们将一个函数添加到以一种方式编写的某个类中，并将他们的编码标准强制用于该函数。这是不一致的，它很突出，而且，在我看来，这使得“作为一个整体”享受课堂变得更加困难。

每当您维护代码时，请查看它周围的代码。看看是什么风格。K&R 牙套？资本骆驼案的方法？匈牙利？每个函数之间的双行注释块？不管是什么，你也应该在那个特定的领域做。

在我离开之前，我想指出一件相关的事情——命名文件。我主要是一个 C++ 人，所以这可能不适用于其他任何东西，但基本上它是 _.h 或 .cpp。因此，Foo::Bar 将在 Foo_Bar.h 中。Foo 命名空间的常见事物（即预编译的标头）将在 Foo_common.h 中（注意小写 common）。当然，这是一种品味，但所有与它合作过的人都站出来支持它。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-20T09:07:19.290

我认为[Code Craft - 编写优秀代码的实践](https://rads.stackoverflow.com/amzn/click/com/1593271190)几乎总结了这一切

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-20T09:09:34.213

非常流行的是C++ 的[Ellemtel 规则](http://www.doc.ic.ac.uk/lab/cplus/c++.rules/)。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-20T09:10:15.583

对于 C#，我推荐[Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries (2nd Edition) (Microsoft .NET Development Series)](https://rads.stackoverflow.com/amzn/click/com/0321545613)。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-20T09:28:31.343

[单声道编码指南](http://www.mono-project.com/Coding_Guidelines)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-20T09:38:49.120

这里的答案非常完整，因此我没有指向另一个编码标准文档。然而，一旦你决定坚持一种风格，你应该在整个团队中使用**自动编码风格强制执行器。**

对于 Java，有[checkstyle](http://checkstyle.sourceforge.net/)，对于 .NET [Microsoft Style Cop](http://code.msdn.microsoft.com/sourceanalysis)。

这是关于 Stackoverflow 的类似讨论：[C# 编码标准/最佳实践](https://stackoverflow.com/questions/14967/c-coding-standard-best-practices)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-12-05T15:21:18.413

仅骆驼和帕斯卡套管就解决了很多编码标准问题

# math - 我可以强制三向线性回归中的两个分量为正吗？

> ID：568821
> 
> 赞同：1
> 
> 时间：2009-02-20T09:09:17.350
> 
> 标签：math, matlab, linear-regression

如果我没有使用正确的数学术语，我很抱歉，但我希望你能理解我想要完成的事情。

我的问题：我对来自两个向量 x 和 y 的值针对结果 z 使用线性回归（目前是最小二乘法）。这将在 matlab 中完成，我正在使用 \-operator 执行回归。我的数据集将包含几千个观察值（最多约 50000 个）。

x 值将在 10-300 范围内（大多数在 60 和 100 之间），y 值在 1-3 范围内。

我的代码如下所示：

```
X = [ones(size(x,1) x y];
parameters = X\y; 
```

输出“参数”是该公式中使用的三个因子 a0、a1 和 a2：

```
a0 * 1 + a1 * xi + a2 * yi = zi 
```

（我应该是下标的）

尽管我希望 a1 和 a2 这两个参数始终为正值，但即使向量 z 为负数（这意味着 a0 当然是负数），这也可以正常工作，因为这是真实模型的样子（z 总是与 x 和 z 正相关）。这可以使用最小二乘法吗？我也对其他线性回归算法持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T12:40:03.770

让我试着重新措辞澄清一下。根据您的模型，z 始终与 x 和 y 正相关。但是，有时当您求解系数的线性回归时，这会给您一个负值。

如果您对数据的看法是正确的，那么这只应该在正确的系数很小并且噪声恰好取负时才会发生。您可以将其分配为零，但是方法将无法正确匹配。

在这种情况下，正确的解决方案是[jpalacek](https://stackoverflow.com/users/51831/)所说的，但在此处进行了更详细的解释：

1.  尝试对 x 和 y 进行回归。如果两者都为阳性，则取结果。
2.  如果 a1 是负数，假设它应该是零。对 y 回归 z。如果 a2 为正，则将 a1 设为 0，并将 a0 和 a2 从该回归中获取。
3.  如果 a2 是负数，假设它也应该是零。将 z 针对 1 回归，并将其作为 a0。令 a1 和 a2 为 0。

这应该给你你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T16:28:16.737

简单的解决方案是使用旨在解决它的工具。也就是说，使用优化工具箱中的 lsqlin。为三个参数中的两个设置下限约束。

因此，假设 x、y 和 z 都是 COLUMN 向量，

A = [一个(长度(x),1),x,y];

磅 = [-inf, 0, 0];

a = lsqlin(A,z,[],[],[],[],lb);

这将仅约束第二个和第三个未知参数。

如果没有优化工具箱，请使用 lsqnonneg，它是 matlab 本身的一部分。这里的解决方案也很简单。

A = [一个(长度(x),1),x,y];

a = lsqnonneg(A,z);

你的模型将是

z = a(1) + a(2)*x + a(3)*y

如果a(1) 基本上为零，即它在零容差内，则假设第一个参数受零处的界限约束。在这种情况下，通过改变 A 中一列的符号来解决第二个问题。

A(:,1) = -1;

a = lsqnonneg(A,z);

如果此解决方案的 a(1) 显着非零，则第二个解决方案必须优于第一个解决方案。您的模型现在将是

z = -a(1) + a(2)*x + a(3)*y

调用 lsqnonneg 最多花费您两次，而第二次调用仅占时间的一小部分（缺少有关您的问题的任何信息，几率是第二次调用的 50%）。

# apache-flex - 如何在flex上动态创建事件？

> ID：568826
> 
> 赞同：3
> 
> 时间：2009-02-20T09:10:59.653
> 
> 标签：apache-flex, events

请帮忙。我想在我动态创建的复选框上添加一个点击事件，以便我知道我点击了哪个复选框。

这是我关于动作脚本的代码：

var myCheckbox:CheckBox = new CheckBox(); vbox.addChild(myCheckbox);

如何在复选框上添加点击事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T09:14:09.117

```
private function myCheckboxClicked(event:MouseEvent)
{
    // doStuff();
}

...

myCheckbox.addEventListener(MouseEvent.CLICK, myCheckboxClicked); 
```

只要它继承了 EventDispatcher，你就可以附加一个监听器，它会像往常一样发送事件。

# .net - 您将 f# 用于哪些代码领域？

> ID：568827
> 
> 赞同：14
> 
> 时间：2009-02-20T09:11:05.160
> 
> 标签：.net, f#, functional-programming

对于那些正在使用 f# 的人，你用它编写了哪些功能领域？什么语言真正适合它？它比 C# 更强大、更容易做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T09:50:27.407

[Deep Fried Bytes #24](http://deepfriedbytes.com/podcast/episode-24-chatting-about-f-with-chris-smith-and-dustin-campbell/)播客涵盖了这一点：

*   算法处理（包括计算）
*   DSL 创建
*   并发处理（不可变数据、消息队列、异步工作流）

当然，对于许多系统，F# 可能会形成一个处理核心，但在我看来，它通常会用 C#/VB 包装（接口、用户或其他）以提供常规接口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T12:54:06.560

使用[FParsec](http://www.quanttec.com/fparsec/)进行解析（Haskell 的[Parsec](http://legacy.cs.uu.nl/daan/parsec.html)的精神端口）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-20T17:56:15.180

我目前正在使用 F# 来开发我的下一个独立视频游戏。到目前为止，我发现我正常的 OO 方法与我在 c# 中的开发方式不同。

我注意到的一些好处是我平均使用较小的函数，即每个函数的行数下降了很多。现在对我来说，将静态私有成员函数的范围限定在另一个成员内部而不是让它暴露给对象中的所有内容也更自然。编写碰撞算法真的很容易。我现在说用 F# 编写算法更容易还为时过早，但我已经倾向于这种方式。

自从我开始使用 F# 以来，并非一切都是美好的。我仍然发现缺少在线文档。专家 F# 提供了一些帮助，但由于它略过 OO，它让我迷失了很多次。当它是目前最流行的开发形式时，作者选择不深入研究 OO，这让我很紧张。我不打算转储 OO。我希望将功能集成到其中。

到目前为止，我看到的最大优势是我的代码正确性。我知道这听起来很有趣，但每次我编译我的代码时，它都按预期工作。我希望我破万行代码标记时仍然如此。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T14:36:00.637

我目前正在探索 F# 在

*   SOA
*   并行执行
*   数据密集型
*   长时间运行的进程

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-20T09:54:52.873

1.  科学著作（数学和统计计算、可视化、优化……）
2.  并行编程（F# 支持异步工作流、Erlang 风格的并发、Parallel FX，...）
3.  面向语言的编程（例如 DSL）
4.  数据密集型分析
5.  ...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-28T13:38:33.143

小型（ish）数据处理脚本。考虑解析长日志文件并尝试检测“奇怪”行为。活动模式和流处理使程序变得很好（和快速）。我曾经用 C# 编写这些，但它们被丢弃了 - 使用 F# 我实际上发现自己重用了以前的脚本并扩展了它们。

使用[FsCheck](http://www.codeplex.com/fscheck)进行测试（好吧，我想这是作弊，因为我自己移植了这个东西......），但它非常有用（我自己对此感到惊讶；））不仅用于测试 F# 程序，还用于测试 .NET 库一般的。由于 FsCheck 是一个测试 DSL，我想我也应该加入 DSL 的行列。

很长时间以来，我一直想将 F# 与 WPF 或 XNA 一起使用，但一直没有得到解决。

与某些人相反，我发现一旦你掌握了 F# 的隐式类构造语法，使用 F# 进行 OO 编程就像使用 C# 或 VB 一样令人愉快。

确实，如果您用 F# 编写库，除非您非常小心，否则它最终只能在理论上实现互操作。真正可互操作的 F# 库要么需要非常小心要使用的 F# 构造，要么编写 C#/VB 包装器。

库尔特

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-21T05:13:45.130

[以下是来自Trauma Pony](https://stackoverflow.com/users/18658/traumapony)的 F# 和函数式编程的一些很好的实际用途，作为对我的[类似问题](https://stackoverflow.com/questions/212347/what-are-some-practical-problems-that-parallel-computing-f-and-gpu-parallel-pr/221433#221433)的回答。

*   计算流体动力学
*   物理处理
*   光线追踪
*   数据挖掘
*   医学影像
*   控制工程软件
*   数字信号处理
*   生物信息学

事实上，请查看此页面以获取更多使用 GPGPU 的示例。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-21T02:41:01.113

F# 几乎完成了 C# 的所有工作，只是更简单。它的高级功能意味着您最终编写的代码要少得多。OO 语法比其他 F# 语法更冗长，但仍然比使用 C# 更好。

我们将它用于 Web 服务、ASP.NET MVC 站点、守护进程、

问题是，在哪里不使用它。现在看来，这主要是缺乏工具支持的地方。因此，例如，对于 ASP.NET，ASPX 页面内联代码是 C#，但控制器和其他一切都是 F#。

F# 没有我想象的那么流畅的几个地方将在即将发布的版本中解决。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-20T20:17:49.677

我正在考虑使用 F# 进行 HTML 处理，因为列表模式匹配语法非常适合问题域（Prolog 可能更好，但仍然如此）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-28T17:28:09.003

我正在使用 F# 为我正在设计的回合制策略游戏开发引擎。我发现 F# 的函数式编程和 OO 编程的组合让我能够以在命令式 C# 中过于复杂而无法做到的方式简洁地操作游戏中的数据。将改变状态的动作与折叠分开也是很自然的，这样就可以确定状态应该如何改变，这肯定有助于保持代码更简单和更有条理。

我在项目中可能陷入的最大陷阱是对在其中一个类中大量使用的几种数据类型使用元组的类型注释。使用元组可以生成非常简洁的代码，但我不确定在某些情况下在使用它们的函数的签名中使用类型注释是否足以保持可读代码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-21T16:40:43.717

我目前正在为客户使用引文、linq 表达式编译、dsls、异步工作流和典型的 fp 构造。许多与 C# 的互操作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-04-08T10:00:15.803

程序分析和转换。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-20T21:50:45.133

**1) 模拟（蚂蚁和菌丝体）**

利用异步工作流程进行大规模并行模拟很容易。

**2) C# API 的单元测试**

F# 可以进行简短、甜美且可读性很强的测试。此外，FsStory 也相当不错。

**3) 数据分析与可视化**

它有很棒的可视化库，并且尝试不同的东西非常快。我也喜欢 VSLab 并希望它很快会发布另一个版本。

**4) 快速 XNA 开发**

一旦你建立了一个小框架来保持 XNA 的面向对象性，F# 开发就会更快，也更容易进行试验。

简而言之，我发现 F# 在开发速度或不变性胜过 API 正确性的任何地方都很棒。如果有一个编译指示或编译器标志来关闭公共函数和类型定义的类型推断，我可能会推动将它用于我的 API。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-20T09:40:09.133

有大量数学计算的地方。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-01T12:43:29.630

我正在使用 F# 接收（TCP）、解析和存储来自工业设备的二进制协议消息。目前，我正在测试异步工作流程。

下一个项目是接收数据的可视化和分析。

# php - 脚本告诉我谁和有多少用户在线

> ID：568835
> 
> 赞同：5
> 
> 时间：2009-02-20T09:14:40.613
> 
> 标签：php, sql, mysql

在我研究如何让 PHP 告诉我有多少人在我的网站上“在线”时，我发现有一些方法可以“估计”这一点。

我选择记录网站上发生的所有事情，也是为了错误管理，但现在我一直在编写我的 SQL 查询。

基本上我有一个带有“IP”、“userid”和“datetime”的数据库，我认为这样的查询可以解决问题：

```
SELECT distinct(IP), datetime 
FROM `bigBrother` 
WHERE datetime BETWEEN DATE_SUB(NOW(), INTERVAL 3 MINUTE) AND NOW() 
```

问题是我的网站主要由学校网络上的学生查看和使用，而且……他们都拥有相同的 IP。

所以问题是，我这样做是否正确，我是否可以从我的数据库中选择两个不同的行，以便我可以整理出注册用户（谁将拥有一个“用户 ID” - 其他人将拥有用户 ID = 0）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-20T09:25:29.433

只需使用[会话 ID](http://www.php.net/manual/en/function.session-id.php)而不是 IP。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T09:17:47.470

使用 cookie 而不是 IP 地址。

PHP 通过它的会话机制使它变得非常容易。在每一个上，您首先执行[session_start()](http://www.php.net/manual/en/function.session-start.php)，然后使用[session_id()](http://www.php.net/manual/en/function.session-id.php)返回的值作为访问者的标识符，您可以将其放入数据库中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T09:19:17.920

我为一个学校网站创建了一个系统，该网站也要求提供此功能，这就是我的做法。

我有一张用户表，在该表中有一个名为“online_time”的字段

如果用户登录，则在每个页面上都会调用一个函数，将“online_time”更新为该用户的当前时间。(unixtime)

然后我有一个“谁在线”功能，查看“online_time”并显示所有用户最后 5 分钟的在线时间。

编辑评论：

您可以使相同的函数将会话 ID 保存在另一个表中以及保存时间。会话 ID 对该用户浏览是唯一的，因此您可以获得过去 5 分钟内活动的会话 ID 的数量。

```
session_id() 
```

# c# - 在 ASP.NET 中缓存用户控件？

> ID：568837
> 
> 赞同：7
> 
> 时间：2009-02-20T09:15:36.587
> 
> 标签：c#, asp.net, caching, user-controls, asp.net-2.0

我在我的应用程序“header.ascx”中创建了一个用户控件，我将一个 selectedMenu 属性传递给该控件，该控件在该控件上选择指定的 selectedMenu 值。假设我传递了值“home”或“search”，那么它将选择（突出显示）搜索菜单。

我想缓存这个控件，当 selectedMenu 属性的值发生变化时，只有缓存会被刷新，否则它应该从缓存中获取控件？

是否可以在 asp.net 中缓存用户控件？我正在使用 ASP.NET 2.0 (C#)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T09:33:59.770

ASP.NET 中的用户控件缓存称为[片段缓存](http://msdn.microsoft.com/en-us/library/h30h475z.aspx)。这是通过在页面顶部添加一个 OutputCache 指令来完成的：

您不能通过在控件上设置属性来更改缓存，因为如果在缓存中找到控件，则实际上并没有创建该控件。如果您尝试访问其缓存代码中的控件，它将为空。

确定控件是否应该被缓存的条件是否可以通过查看当前请求来确定？如果是，您可以使用输出缓存指令的 varybycustom 属性 ( [http://msdn.microsoft.com/en-us/library/system.web.ui.partialcachingattribute.varybycustom.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.partialcachingattribute.varybycustom.aspx) )。您可以将所需的任何字符串作为参数放入其中，然后在评估缓存时调用[Global.asxa 中的 GetVaryByCustomString() 方法](http://msdn.microsoft.com/en-us/library/ms550239.aspx)，您可以将控件是否应缓存的逻辑放在那里。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T09:21:16.870

当然可以！它被称为“片段缓存”。这是[快速入门页面](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/fragment.aspx)和[MS 知识库](http://support.microsoft.com/kb/308378)的链接。此外，[谷歌](http://www.google.com/search?q=fragment+caching).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T10:53:17.227

我认为缓存控件本身不是一个好主意：

*   首次创建控件时，它会引用其父页面等。
*   当您从缓存中检索控件时，这些引用不再存在。

我认为，更好的方法是缓存控件正在使用的数据。ASP.NET 在页面生命周期中创建了如此多的控件，缓存这个控件实际上并没有改善任何东西。

然后最后一个愚蠢的问题：这个控制是瓶颈吗？你真的需要缓存吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-06T05:21:40.963

总结

使用 VaryByCustom，意味着

1-再次构建控件。
2-在缓存中有多个版本的控件。**满足自定义条件**时使用。

仅当控件花费大量时间来构建并且我们有有限数量的缓存版本以不浪费内存并且应用程序将需要访问控件属性时（当它被缓存为“或空”时）时，这才有用。

**但如果自定义条件**取决于控件属性本身，那就不好了。我无法访问它，它是空的。

例如，我想写一些类似 if（国家列表中的默认选择值不是美国）然后重建和缓存（给它一个不同的字符串）

否则不要

当其他对象试图访问国家列表时，它将检查是否为空，并将国家下拉列表设置为美国。

数据缓存将完成工作。这是唯一的方法。

谁同意？

谢谢你的时间

# perl - 如何使用 Perl 获取 DOS 工具的命令行输出？

> ID：568846
> 
> 赞同：3
> 
> 时间：2009-02-20T09:18:38.857
> 
> 标签：perl, command-line, ftp, stdout

我想在 Perl 脚本中使用 Windows 内置 FTP 工具来测量链接的吞吐量。因此，该脚本会创建以下命令脚本：

```
open <ip>
<username>
<password>
hash
get 500k.txt
quit 
```

之后，我使用以下 Perl 代码运行命令脚本：

```
system(@args);
@args = ("ftp", "-s:c:\\ftp_dl.txt");
system(@args); 
```

如果我在 DOS 框中运行命令，则输出如下所示：

```
ftp> open <ip>
Connected to <ip>
220 "Welcome to the fast and fabulous DUFTP005 ftp-server :-) "
User (<ip>:(none)):
331 Please specify the password.

230 Login successful.
ftp> hash
Hash mark printing On  ftp: (2048 bytes/hash mark) .
ftp> get 500k.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for 500k.txt (14336 bytes).
#######
226 File send OK.
ftp: 14336 bytes received in 0.00Seconds 14336000.00Kbytes/sec.
ftp> quit
221 Goodbye. 
```

为了能够获得吞吐量，我需要提取该行：

```
 ftp: 14336 bytes received in 0.00Seconds 14336000.00Kbytes/sec. 
```

我对 Perl 不是很熟悉。有人知道如何获得那条线吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T09:32:08.950

使用在管道模式下[打开：](http://perldoc.perl.org/open.html)

```
open($filehandle, "$command|") or die "did not work: $! $?";
while(<$filehandle>)
{
#do something with $_
} 
```

或使用反引号：

```
my  @programoutput=`$command` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T09:38:22.333

您[无法使用`system()`](http://perldoc.perl.org/perlfaq8.html#Why-can%27t-I-get-the-output-of-a-command-with-system()%3F).

而是使用反踢：

```
my $throughput = 0;
my $output = `ftp -s:c:\\ftp_dl.txt`;
if (($? == 0) && ($output =~ /([\d+\.]+)\s*K?bytes\/sec/m)) {
    $throughput = $1;
} 
```

`$output`将包含执行`ftp`命令的所有行（但不包含发送到的任何错误消息`STDERR`）。
然后我们检查是否`ftp`返回成功 ( `0`) 以及是否在输出中的某处获得了吞吐量。
如果是这样，我们设置`$throughput`它。

这是 Perl，有很多方法可以做到这一点：

您还可以使用[`Net::FTP`](http://search.cpan.org/~gbarr/libnet-1.22/Net/FTP.pm)支持 Windows 的模块来处理文件传输，并使用[Time::HiRes](http://search.cpan.org/~jhi/Time-HiRes-1.9719/HiRes.pm)等计时模块来计时并计算您的吞吐量。

这样您就不会依赖 ftp 程序（例如，如果没有大量返工，您的脚本将无法在 Windows 的本地化版本上运行，并且您需要依赖 ftp 程序安装在同一位置）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T19:12:27.463

请参阅[perlfaq8](http://faq.perl.org/perlfaq8.html)，其中有几个与此主题相关的答案。这个问题你可能需要的是：

*   [为什么我无法使用 system() 获得命令的输出？](http://faq.perl.org/perlfaq8.html#Why_can_t_I_get_the_)
*   [如何从外部命令捕获 STDERR？](http://faq.perl.org/perlfaq8.html#How_can_I_capture_ST)

此外，您可能对标准库中的一些 IPC（进程间通信）Perl 模块感兴趣：

*   IPC::Open2
*   IPC::Open3

一些 Perl 文档也可能有帮助：

*   [perlipc](http://perldoc.perl.org/perlipc.html) - Perl 进程间通信
*   [perlopent](http://perldoc.perl.org/perlopentut.html) - Perl 开放教程

如果您不熟悉 Perl 文档，可以查看我的[Perl 文档文档](http://www.perlmonks.org/?node=perl+documentation+documentation)。

祝你好运，

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-20T09:25:55.453

您应该尝试使用更适合该任务的[libcurl 。](http://curl.netmirror.org/libcurl/perl/)

有一个[易于使用的 API](http://search.cpan.org/~crisb/WWW-Curl-3.02/Easy.pm.in)

# asp.net - ASP。NET 母版页 - 你使用它们吗？

> ID：568855
> 
> 赞同：2
> 
> 时间：2009-02-20T09:23:49.780
> 
> 标签：asp.net, master-pages

我正在使用一本很棒的 Sitepoint 书籍来学习 ASP.NET，并且我还在学习有关 CSS 的更多信息。我不确定母版页有多有用。有人可以让我知道现实世界是否使用母版页面 - 如果他们不这样做，他们会做什么？

干杯迈克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T09:26:08.137

是的，我们绝对使用它们。通常，您将使用母版页来处理在您网站的所有页面中保持一致的页眉、页脚和导航部分。

这遵循 DRY 原则，即在创建新的 Web 表单时不必重复自己。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T09:28:55.087

MasterPages 是 ASP.NET 2.0 附带的最佳功能。

我尽可能使用它们。它们简化了您在网站上的维护和管理。通过一次更改，您可以更改整个站点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T10:35:19.373

我总是使用母版页。它有助于保持每个页面的代码不那么混乱，并且如前所述，它减少了重复自己的需要。

Speaking of CSS, I use CSS to style the master pages, and set text formating "rules", while I usually end up styling graphics in each individual aspx/ascx-file. I find this less confusing, as you'll otherwise end up with one massive CSS-file - which is hard to keep structured - or a myriad of CSS-files - which often get hard to keep track of.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T09:31:36.390

我们将 Masterpages 用于我们的许多应用程序并发现它们有好处，但我认为您有权质疑它们的用处。

对于我们拥有大量页面的应用程序来说，能够将大量样式信息提取到一个位置非常棒。我知道包含文件等是可能的，但由于 Masterpages 是 Visual Studio 的主要方法，它显然集成得非常好并且易​​于使用。

对我来说最大的好处是我倾向于在许多应用程序中使用相同的 Masterpage，从而使它们具有相同的外观和感觉。我再次知道这可以通过其他方式实现，但它的 Visual Studio 集成使其对我们来说最简单。

我认为您决定的最佳方法是尝试它们并尝试另一种方法。选择你最喜欢的，然后让我们都知道！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T09:34:31.737

母版页对任何 ASP.Net 应用程序都至关重要。它们是您网站的构建块。

如果您开始关注 SharePoint，它们就是所有自定义和品牌的基础。

为什么你会有其他想法？我很想知道为什么您可能不认为它们有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T09:35:23.793

我有一个没有母版页的解决方案，尝试更改页面布局真的很痛苦，因为每个页面都必须单独更改。

# regex - 在整个代码库中更改变量名称只是在要求灾难吗？

> ID：568859
> 
> 赞同：3
> 
> 时间：2009-02-20T09:25:22.943
> 
> 标签：regex, architecture, codebase

假设您决定将 Stack Overflow 的名称更改为 Frack Overflow。

现在，在您的代码中，您已经有几十个对象、变量和选择器，它们的名称有些变体“堆栈”。您现在希望将它们替换为“Frack”。

所以我的问题是，你会选择通过正则表达式过滤器运行整个代码库并更改所有这些名称吗？或者你会让他们这样吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T09:30:15.770

我会使用一个好的 IDE 的“重命名”功能来为我做这件事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T09:34:38.990

这取决于，真的。

在像 C++ 这样的语言中，您可以避免这种情况，因为编译器会立即让您知道是否会出现问题。但是，其他不那么挑剔的语言将允许您引用不存在的变量，并且发生的最糟糕的情况是以针对空引用引发异常的形式拍打手腕。

有一次我在一个 flex 项目上工作，其中代码库真的很乱，我们决定检查代码并稍微美化它以符合 Adob​​e AS3 编码标准。由于我是该项目的新手，我没有意识到某些类中的变量名实际上引用了休眠（为后端服务器运行 java webapp）用于创建映射的持久对象。因此，重命名这些变量会导致整个 flex 前端行为异常，即使我们使用 IDE 中的“正确”重构工具进行了重命名。

但实际上，我会说在门口检查你的强迫症，一次做一点改变。每当您在一个大型项目中更改数十个文件时，都有可能破坏它的稳定性，在这种情况下，这种风险带来的好处并没有得到回报。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T09:28:24.277

我首先会问自己这个问题，为什么？这是一天结束时的风险/回报判断，只有你才能做出。

出于文体原因，我非常不愿意这样做，但对于类重构，它可能是合法的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T09:31:06.657

好吧，不一定是灾难，但它肯定会在大型代码库上造成一些麻烦。这就是我讨厌匈牙利符号的原因：如果你碰巧改变了它的类型，它会让你改变所有的变量名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T09:31:26.750

如果您的解决方案中有名称引用某个客户实现的对象、成员和字段，我会努力重构这些以使用更通用的名称，我会让[Resharper](http://www.jetbrains.com/resharper/)进行重命名，而不是一些通用的文本搜索和替换工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T09:32:22.677

只需使用重构工具，例如 JetBrains 的 Resharper 或 CodeRush 和 Refactor！由 DevExpress 提供。它们会自动更改整个代码库中变量的所有引用，并且可以做更多事情。我相信重构！甚至包含在 Visual Studio 的 VB 版本中。我使用 Resharper，没有它我拒绝开发。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-20T09:45:02.193

如果我使用源代码版本控制系统（如 svn、git、bazar、mercurial 等），我不会害怕重构我的代码。

使用某种“查找全部替换”或重构某些 IDE，编译（如果它不是动态语言）并运行测试（如果有）。

如果出现严重错误，您始终可以使用源代码控制系统还原您的代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-20T10:17:10.557

重命名可能是最常见的[重构](http://en.wikipedia.org/wiki/Code_refactoring)。建议您随时重构您的代码，因为这样可以让您在首次编写应用程序时不必对名称、代码位置等做出永久性决定。如果您不熟悉这个想法，我建议您从[Wikipedia 页面](http://en.wikipedia.org/wiki/Code_refactoring)开始，然后深入[Martin Fowler 的网站](http://www.refactoring.com)。

但是，如果您需要编写自己的正则表达式来重命名事物，那么恕我直言，您可以使用一些更好的工具。不要浪费时间重新发明轮子——然后修理你的新轮子意外损坏的东西。如果您可以选择，请使用现有工具（IDE 或其他工具）来完成这项繁琐的工作。

即使您有“数十个”要重命名的东西，我认为您最好手动一一找到它们，然后使用自动重命名来修复整个代码中的所有实例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-20T10:24:25.407

我认为，您需要有充分的理由这样做。当我在大型代码库中进行具有大量潜在副作用的更改时，我通常会寻找一种方法让编译器在我错过的地方失败。而且，如果可能的话，我倾向于分阶段进行，以尽量减少休息时间。

不过，我不会为了重命名而重命名。

# c# - 通过正则表达式匹配网址

> ID：568864
> 
> 赞同：0
> 
> 时间：2009-02-20T09:27:02.127
> 
> 标签：c#, regex, url

我想通过正则表达式匹配一个网址，它应该捕获[http://www.google.com](http://www.google.com)以及 www.google.com 即有和没有协议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T09:34:38.427

好吧，这将取决于您要捕获的确切内容（“FTP”？“/index.htm”？），因为基于 RFC 标准的一般 URI 捕获非常困难，但您可以从以下开始：

```
/^((https?\:\/\/)?([\w\d\-]+\.){2,}([\w\d]{2,})((\/[\w\d\-\.]+)*(\/[\w\d\-]+\.[\w\d]{3,4}(\?.*)?)?)?)$/ 
```

复杂看看？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T09:28:56.460

试试[RegexLib](http://regexlib.com/DisplayPatterns.aspx?cattabindex=1&categoryId=2)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T09:29:20.610

阅读[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)。它并不像你想象的那么容易。如果您只需要解析一小组 URL，这项工作会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T10:16:25.083

为什么不

```
/google\.com/ 
```

?

它免费捕获*[http://www.google.com](http://www.google.com)*、*www.google.com*甚至*google.com*！:-)

# .net - 使用 NHibernate 时限制结果数量

> ID：568865
> 
> 赞同：1
> 
> 时间：2009-02-20T09:27:41.533
> 
> 标签：.net, nhibernate

我想知道人们通常如何限制从查询返回的实体数量。我知道 SetMaxResults 但这似乎在涉及连接时就崩溃了——结果是 3 个实体和每个 2 个孩子将产生 6 行。如果我使用 SetMaxResults(3) 只获取 3 个实体，我只会得到 3 个结果行，这可能会给我一个不完整的对象图。

我知道这是由于 DistinctRootEntityResultTransformer，但我想知道其他人做了什么来避免获得 1000 行只是为了获得构建我的 3 个实体所需的 6 行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T10:36:13.880

我的回答可能不是 100% 准确，因为我是 Java Hibernate 类型的人，但我猜 NHibernate 的设计与其 Java 表亲完全相同。

Hibernate 承诺查询结果中的项目数将完全等于从查询返回的行数。这一切都很好，因为通常查询为每个实体返回一行，当查询连接到另一个表并产生笛卡尔积时，问题就出现了。

几个选项：

1.  从您的查询中删除任何“加入”条件/子句。如果它们只是为了性能而包括在内，这可能很容易，请注意它们可以替换为不会创建连接的“获取”子句
2.  在最终 sql 的 where 子句中为创建子查询的条件添加 sql 限制

请注意，这与休眠或休眠无关，对连接的结果集进行分页是完全不可能的（没有蛮力和无知）

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T01:28:15.257

你能发布你的映射文件和你正在使用的查询吗？我不确定我是否完全理解这个问题，或者 DistinctRootEntityResultTransformer 如何发挥作用，但如果您的实体包含其他实体的集合，或者是连接子类关系的一部分，（或其他关系？）NHibernate 将进行连接为您填充实体（即使您的查询中没有显式连接）。

您可以通过在特定映射上设置惰性属性来阻止 hibernate 进行各种连接。如果您最终使用它，它只会获取数据。

# c# - Unauthorisedaccessexception - 如何获得访问权限？

> ID：568866
> 
> 赞同：0
> 
> 时间：2009-02-20T09:28:17.117
> 
> 标签：c#, .net, winforms

我有一个 winform 应用程序来压缩和移动一些文件。当我尝试访问我桌面上的路径时，我得到一个未经授权的访问异常。我以管理员身份运行 Visual Studio（在程序栏中说）并且我是我机器上的完整管理员（可以访问其他帐户等）。

如何访问此路径（文件夹）？我遇到的问题之一是文件夹不断将自身设置为只读。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T09:34:42.267

具有写访问权限的任何人都可以清除只读标志。如果仅此而已，那么您只需要设置文件属性。但是，如果文件 ACL 阻止了您（并且很容易创建不允许管理员使用的 ACL），那么您的选择就会受到更多限制。

首先找出为什么文件一直设置为只读，因为如果有其他东西正在更新文件，您将不得不与其他进程协调，否则可能会出现各种问题。

查看文件发生情况的最佳工具是SysInternals[的](http://technet.microsoft.com/en-us/sysinternals/default.aspx)[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)。

# configuration - 显示具有不同字符的选项卡 (Emacs)

> ID：568885
> 
> 赞同：22
> 
> 时间：2009-02-20T09:32:43.923
> 
> 标签：configuration, emacs, tabs, character

我很乐意使用非常柔和的字符“>>”而不是空格，如下所示：

[Mono 开发 http://primates.ximian.com/~miguel/pictures/Valabinding-classpad.png](http://primates.ximian.com/~miguel/pictures/Valabinding-classpad.png)

如何在 Emacs 中实现这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-20T10:11:02.177

**编辑：**刚刚意识到空白模式已被[whitespace](http://www.emacswiki.org/emacs/WhiteSpace "空白模式")取代。加载这个并自定义`whitespace-style`至少包含`tabs`and `tabs-mark`。我目前有：

```
(setq whitespace-style '(trailing tabs newline tab-mark newline-mark)) 
```

还有[空白模式可以让你实现你想要的，它给你一些很好的功能来清理你喜欢的空白：](http://www.emacswiki.org/emacs/BlankMode "空白模式") [http](http://www.emacswiki.org/emacs/BlankMode) ://www.emacswiki.org/emacs/BlankMode

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-09-17T13:02:07.453

在我的 Emacs 版本 (24.3) 上，不需要额外的模块。启动就够了

```
M-x whitespace-mode 
```

要自定义转到`whitespace-style`变量帮助，

```
C-h C-h v whitespace-style 
```

这种模式有很多功能。为了使其更简单，可以选择不使用“面部可视化”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-20T09:42:34.477

使用“M-:”（Mx eval-expression）并输入以下表达式：

```
(let ((d (make-display-table))))
  (aset d 9 (向量 ?> ?>))
  (set-window-display-table nil d))

```

要恢复正常，请输入：

```
(set-window-display-table nil nil)

```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T09:42:13.887

谷歌搜索提出了[show whitespace-mode](http://aurelien.tisne.free.fr/emacs-pages/emacs/show-whitespace-mode.html)。自己没试过。

# rest - REST 中基于事件的交互风格

> ID：568897
> 
> 赞同：21
> 
> 时间：2009-02-20T09:35:24.353
> 
> 标签：rest

我目前正在努力解决涉及 REST 的设计问题。我正在设计的应用程序需要发送事件并支持发布/订阅样式的交互。在不打破 REST 的“无状态交互”约束的情况下，我无法设计出提供这些交互风格的设计。我并不像某些人那样反对投票（投票很烂），但我的应用程序需要基于事件和发布/订阅样式的交互（投票对我来说不是一种选择）。所以，我的问题是：

1.  我能否设计一个支持基于事件和发布/订阅交互的 RESTful 应用程序，而不会打破 REST 约束？
2.  REST风格适合这种交互风格吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-22T18:49:02.120

我推荐 Duncan Cragg 的[Distributed Observer Pattern](http://duncan-cragg.org/blog/post/distributed-observer-pattern-rest-dialogues/)作为一本好书（有点难以理解，但值得努力）。

正如其他人指出的那样，您可能需要使用轮询，但正如您正确地说的那样，订阅者可以注册自己的兴趣（POST 以创建订阅）。如果您将订阅视为自己的资源，即发布者和订阅者之间的合同，那么我不会将其视为破坏 REST 约束（有关应用程序和资源状态之间的区别，请参阅**[RESTful Web 服务](https://rads.stackoverflow.com/amzn/click/com/0596529260)**第 217 页的**状态和无**状态)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T10:49:01.680

我假设您的意思是服务器应该通知客户端有关事件。我看不出具体技术在这里有什么重要性：您将面临同样的问题，并且必须从同一个池中选择一个解决方案，而不管使用 REST、基于 SOAP 的 Web 服务或任何其他替代方案。

基本问题是，您的服务器可以发起连接吗？作为补充，客户端可以监听端口吗？如果是这样，客户端注册（sub），服务器通知事件（pub）。注册操作和通知事件都可以是 RESTful。

您需要服务器发起的连接和侦听客户端。如果其中任何一个都不是一个选项（例如，因为客户端是 Web 浏览器），您将不得不使用轮询（如果您正在处理浏览器，您也可以查看 websockets 之类的东西）。仔细设计您的轮询：服务器对轮询事件的响应应指示客户端再次轮询之前的最小延迟。服务器的初始实现可以为此延迟值返回一个常量，但稍后（假设客户端表现良好）这将允许您控制服务器上的负载，区分关键客户端和非关键客户端，等等在。

当然，轮询可以是 RESTful 的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T09:43:35.287

我看不出 RESTful 接口不支持事件的原因。

请注意，这必须通过投票来完成；即使您要改用 SOAP，这也是正确的。

虽然您的 Web 服务器绝对应该保持无状态，但您可能确实在后端某处有一个数据库。您可以使用此数据库通过添加订阅表来处理对事件的订阅。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-09T01:32:07.460

快速检查一下 REST 约束：

*   **客户端-服务器架构**
*   无国籍
*   缓存
*   统一界面
    *   资源识别
    *   通过表征操纵资源
    *   自描述信息
    *   应用状态引擎的超媒体
*   分层系统
*   按需代码（可选）

来自菲尔丁论文：

> 客户端-服务器风格是基于网络的应用程序架构风格中最常遇到的。提供一组服务的服务器组件侦听对这些服务的请求。需要执行服务的客户端组件通过连接器向服务器发送请求。服务器拒绝或执行请求并将响应发送回客户端。

顺便提一句。基于事件的系统可能会违反大多数约束。很难定义没有客户端（因为is`hypermedia the engine of application state`的另一个名称）和超链接（因为它们对 pub/sub 来说没有意义）等等......`application state``client state`

无论如何，如何设计一个类似于 REST 的基于事件的系统是一个有趣的问题。我认为您应该发布包含 RDF 的自描述消息，但这只是一个提示。轮询可能是一个[可行的解决方案](https://serverfault.com/questions/562701/how-to-scale-up-a-web-server-supporting-long-polling)，但如果我是你，我不会尝试在基于事件的系统上强制 REST...

**更新 2016.05.15。**

据我了解客户端 - 服务器架构 - 菲尔丁在他的论文中[在这里](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_1_2)和[这里](http://www.ics.uci.edu/~fielding/pubs/dissertation/net_arch_styles.htm#sec_3_4_1)描述- 总是使用 REQ/REP 通信。客户端发送请求，REST 服务做出响应。如果你想在不违反客户端-服务器约束的情况下拥有像 PUB/SUB 这样的东西，那么唯一的方法就是使用轮询。如果您不想使用轮询，那么 ofc。你可以同时使用 REST 服务和 websocket 服务，这不是被禁止的……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-13T08:25:04.043

Webhook 是这个问题的答案。它们允许事件而不违反 REST 原则。

# html - HTML 表格“摘要”属性的使用

> ID：568905
> 
> 赞同：9
> 
> 时间：2009-02-20T09:37:47.063
> 
> 标签：html, accessibility

HTML4.01 ( [http://www.w3.org/TR/html401/struct/tables.html#adef-summary](http://www.w3.org/TR/html401/struct/tables.html#adef-summary) ) 的规范规定表格摘要属性应包含“......表格**用途的摘要和结构**......”和给出的例子支持这种用法。

Web 内容可访问性指南 2.0 ( [http://www.w3.org/TR/WCAG20-TECHS/H73.html](http://www.w3.org/TR/WCAG20-TECHS/H73.html) ) 说，summary 属性是“提供数据如何组织成表格或如何浏览表格的简要说明"

WCAG 1.0 ( [http://www.w3.org/TR/WCAG10-HTML-TECHS/#table-summary-info](http://www.w3.org/TR/WCAG10-HTML-TECHS/#table-summary-info) ) 说了类似的话，并且这些示例再次显示了用于描述表格的目的和结构的用法。

* * *

另一方面，伊利诺伊州信息技术无障碍中心 iCITA ( **http://html.cita.uiuc.edu/nav/dtable/dtable-rules.php** [)](http://html.cita.uiuc.edu/nav/dtable/dtable-rules.php)将该属性的最佳实践描述为“应该描述表或作者打算通过表中数据传达的**结论"** ****我怀疑 iCITA 是否突然选择了这个，并且还有其他 HTML 书籍和指南建议类似的做法。

在许多方面，这种用法对我来说更有意义，因为明智地使用 thead 和 th 元素以及 scope 和 headers 属性应该足以向无视力的用户描述表格的结构，而没有其他视力正常的用户可以通过快速扫描表格获得复杂表格的要点，以匹配视力正常的用户可以获得的相同级别的信息。

但是，我不愿偏离 WCAG 的经过充分研究的建议。

所以，我的问题是：如果您在数据表的摘要属性中添加任何内容，您是否输入目的、结构、内容描述、结论和/或其他内容，为什么？特别欢迎基于此属性的真实用户反馈的原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T15:04:11.920

摘要属性已过时。如果表格标题元素不合适，则将表格放在图形元素中，在 figcaption 元素中添加附加信息。轴属性也已过时；而是在适当的 th 元素上使用范围。

来自[W3C](http://dev.w3.org/html5/markup/table.html)关于总结：

> *   元素表不能作为标题元素的后代出现。
> *   table 元素上的 summary 属性已过时。考虑在标题元素或包含表格元素的图形元素中描述表格的结构；或者，简化表的结构，以便不需要描述。
> *   table 元素的 align 属性已过时。改用 CSS。
> *   表格元素的宽度属性已过时。改用 CSS。
> *   table 元素上的 bgcolor 属性已过时。改用 CSS。
> *   表格元素的边框属性值必须为“1”或空字符串。要调节表格边框的粗细，请改用 CSS。
> *   表格元素上的 cellpadding 属性已过时。改用 CSS。
> *   表格元素上的 cellspacing 属性已过时。改用 CSS。
> *   table 元素上的 frame 属性已过时。改用 CSS。
> *   表格元素的规则属性已过时。改用 CSS。

来自[W3C](http://dev.w3.org/html5/markup/td.html)关于轴：

> *   td 元素的范围属性已过时。改为在 th 元素上使用 scope 属性。
> *   td 元素的 abbr 属性已过时。考虑改为以简洁的文本开始单元格内容，然后根据需要进一步详细说明。
> *   td 元素的轴属性已过时。请改用范围属性。
> *   td 元素上的 align 属性已过时。改用 CSS。
> *   td 元素的 width 属性已过时。改用 CSS。
> *   td 元素上的 char 属性已过时。改用 CSS。
> *   td 元素上的 charoff 属性已过时。改用 CSS。
> *   td 元素上的 valign 属性已过时。改用 CSS。
> *   td 元素上的 bgcolor 属性已过时。改用 CSS。
> *   td 元素的 height 属性已过时。改用 CSS。
> *   td 元素的 nowrap 属性已过时。改用 CSS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T15:43:22.940

我使用`summary`属性来描述表的*结构*以及行和列之间的关系。它增加了`<tbody>`and`<th>`元素和`scope`, `axis`, 和`id`and`headers`属性。使用这些元素和属性可以理解表格的结构，但最好在前面有一个简单的描述。

不要低估通过简单地查看表格在视觉上传达了多少信息。这就是我试图在`summary`属性中捕获的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T09:54:59.783

我放了一个内容描述。将其视为您可能在标题中看到的文本。该表不应该**是**一个结论，它应该**支持**这个结论（在别处提到）。

通常，考虑到页面其余部分的内容，表格的目的很明确。例如，如果您正在讨论与投票模式相关的人口统计变化，那么很明显为什么您有一张包含州人口增长率的表格。如果没有，您可以简要说明它存在的原因。

至于为什么，很简单：可访问性。那些使用屏幕阅读器的人依靠这些信息来提供表格上下文。您是否需要使您的网站可访问将取决于您的雇主或客户。即使不需要，也推荐它（并且肯定会受到依赖它的人的赞赏）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-22T11:30:29.697

根据[W3C](https://www.w3.org/TR/WCAG20-TECHS/H73.html)

> table 元素的 summary 属性使这些信息可供使用屏幕阅读器的人使用；信息不直观地显示。
> 
> 当表结构复杂时（例如，当有几组行或列标题，或者当有多组列或行时），摘要很有用。对于包含多列或多行数据的简单数据表，摘要也可能会有所帮助。
> 
> 无论表格是否包括标题元素，都可以使用摘要属性。如果两者都使用，摘要不应重复标题。

**在 HTML5 中，*summary*属性已过时**。因此，假设我们使用以下 HTML 表格，取自[Tables - W3C](https://www.w3.org/TR/html401/struct/tables.html)

```
<TABLE border="1"
          summary="This table gives some statistics about fruit
                   flies: average height and weight, and percentage
                   with red eyes (for both males and females).">
<CAPTION><EM>A test table with merged cells</EM></CAPTION>
<TR><TH rowspan="2"><TH colspan="2">Average
    <TH rowspan="2">Red<BR>eyes
<TR><TH>height<TH>weight
<TR><TH>Males<TD>1.9<TD>0.003<TD>40%
<TR><TH>Females<TD>1.7<TD>0.002<TD>43%
</TABLE> 
```

并使用[W3C Validator](https://validator.w3.org/)测试一切是否正常。然后我们会得到以下错误

> table 元素上的 summary 属性已过时。考虑在标题元素或包含表格的图形元素中描述表格的结构；或者，简化表的结构，以便不需要描述。

[![W3C 验证器表摘要错误](https://i.stack.imgur.com/itdgh.png)](https://i.stack.imgur.com/itdgh.png)

所以，我会使用[标题标签](https://www.w3schools.com/tags/tag_caption.asp)而不是摘要并写一个简单的描述（几行文字用于解释和详细说明表格）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T10:09:04.960

我包含了表中数据试图传达的信息的摘要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T15:31:44.577

我会遵循 WCAG 指南。您可以尝试的一件事是获取屏幕阅读器软件包，闭上眼睛，看看它对您的表格的描述，无论是否带有标题和摘要。这应该可以让您很好地了解文本描述中缺少的内容，以帮助传达表格中的信息。

# php - 使用 PHP 的本机 SOAP 类时生成 WSDL？

> ID：568916
> 
> 赞同：18
> 
> 时间：2009-02-20T09:40:55.153
> 
> 标签：php, soap, wsdl

我在 PHP 5 中使用本机 SOAP 类，由于本机类更快（并且 NuSOAP 开发似乎已经停止），因此已从 NuSOAP 更改。然而，PHP 5 SOAP 缺乏生成 WSDL 的能力。

有没有人在 PHP 中生成 WSDL 的经验？如果是这样，请推荐您的首选方法。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-10-12T15:23:12.623

斯图尔特，

如果您或其他任何人正在寻找解决此问题的方法，这就是我所做的。

首先得到这个脚本：[http ://www.phpclasses.org/browse/download/zip/package/3509/name/php2wsdl-2009-05-15.zip](http://www.phpclasses.org/browse/download/zip/package/3509/name/php2wsdl-2009-05-15.zip)

然后查看它的示例文件。之后我只是按照我需要的方式对其进行切片，因为我使用的是 codeigniter：

```
function wsdl(){
  error_reporting(0);
  require_once(APPPATH."/libraries/WSDLCreator.php"); //Path to the library
  $test = new WSDLCreator("Webservice", $this->site."/wsdl");
  //$test->includeMethodsDocumentation(false);

  $test->addFile(APPPATH."/controllers/gds.php");

  $test->addURLToClass("GDS", $this->site);

  $test->ignoreMethod(array("GDS"=>"GDS"));
  $test->ignoreMethod(array("GDS"=>"accessCheck"));

  $test->createWSDL();

  $test->printWSDL(true); // print with headers
 } 
```

就是它，你的一切都完成了。顺便说一句，我在 php5+ 中使用 SoapServer 和 SoapClient

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T12:42:32.097

动态生成 W​​SDL 并不是经常发生的事情——它往往会引发一些关于服务稳定性的问题！

Zend Studio 可以从 PHP 类生成 WSDL，还有一些其他类似的工具。

如果确实需要动态生成 W​​SDL，请查看 Zend Framework 库：[Zend_Soap_AutoDiscover](http://framework.zend.com/manual/1.12/en/zend.soap.autodiscovery.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-01T21:09:06.813

您可以尝试以下选项：
- [https://code.google.com/p/php-wsdl-creator/](https://code.google.com/p/php-wsdl-creator/) (GPLv3)
- [https://github.com/piotrooo/wsdl-creator/](https://github.com/piotrooo/wsdl-creator/) (GPLv3)
- [http:// /www.phpclasses.org/package/3509-PHP-Generate-WSDL-from-PHP-classes-code.html](http://www.phpclasses.org/package/3509-PHP-Generate-WSDL-from-PHP-classes-code.html)（类似 BSD）

如果许可证适合您的项目，第一个可能是您的最佳选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-28T12:55:48.670

Zend_Soap_AutoDiscover 是 NuSOAP 的一个很好的替代品。但是，您也可以从头开始创建 WSDL 文件，这可能非常复杂且容易出错。为了简化此过程，您可以使用 IDE 为您的 PHP 函数生成 WSDL 文件，并将其作为参数传递给您的 PHP SoapServer 类。查看有关[如何为 php 本机肥皂类生成 wsdl的完整教程](http://osarogabriel.blogspot.com/2014/03/how-to-generate-wsdl-for-php-soap-server.html)

# asp.net - ASP.NET 菜单和 CSS？

> ID：568922
> 
> 赞同：2
> 
> 时间：2009-02-20T09:42:36.507
> 
> 标签：asp.net, menu, css-selectors

我有一种感觉，在 ASP.NET 中使用 Sitemap 不利于 CSS。我在哪里格式化菜单看起来像 CSS 可以使它看起来。mu ul 和 li's 在哪里？

...初学者，如果就在我的眼皮底下，请原谅我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T10:07:14.793

为什么不直接使用带有 ul's 和 li's 的 CSS 菜单？ASP.NET 中没有任何内容表明您必须使用 Web 控件，普通的 HTML 也可以正常工作（可能更好）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T10:32:04.327

使用站点地图显示菜单和面包屑时非常有用。

您可以阅读一些有关如何完成此操作的[教程](http://www.eggheadcafe.com/articles/20050531.asp)。如果你想**生成纯 UL / LI**我建议你阅读[这篇文章](http://blogs.sqlxml.org/bryantlikes/archive/2006/02/17/4839.aspx)

总是有关于[我如何：在 ASP.NET 中**实现站点导航**的 ASP.NET 视频教程？](http://www.asp.net/learn/videos/video-192.aspx)

尝试，以及使用[**CSS Friendly Adapters**](http://www.asp.net/CssAdapters/)（这就是它们的目的）——还有一个[视频教程](http://www.asp.net/learn/videos/video-185.aspx)。

*希望能帮助到你*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T10:03:19.000

要完全控制菜单，您可以使用中继器并将其绑定到您的 Web.SiteMap。

```
<asp:Repeater ID="MenuRepeater" DataSourceID="SiteMapDataSource1" runat="server">
  <ItemTemplate>
    <li>
      <a href='<%#Eval("url")%>'><%#Eval("Title")%></a>
    </li>
  </ItemTemplate>
</asp:Repeater> 
```

如果您正在寻找 CSS 下拉菜单，那么只需添加一个嵌套的中继器。

```
<asp:Repeater ID="MenuRepeater" DataSourceID="SiteMapDataSource1" runat="server" EnableViewState="false">
  <ItemTemplate>
    <li>
      <a href='<%#Eval("url")%>'><%#Eval("Title")%></a>
      <ul>
        <asp:Repeater ID="DropDownRepeater" DataSource='<%#Container.DataItem.ChildNodes()%>' runat="server">
          <ItemTemplate>
            <li>
              <a href='<%#Eval("url")%>'><%#Eval("Title")%></a>
            </li>
          </ItemTemplate>
        </asp:Repeater>
      </ul>
    </li>
  </ItemTemplate>
</asp:Repeater> 
```

因此，您将获得所需的 CSS 菜单，并且仍然可以使用您的 Web.SiteMap。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T10:21:55.693

您可以将 SiteMapDataSource 与 Repeater 结合使用，从而生成标准`<ul><li>`菜单列表。您甚至可以将自己的属性添加到 web.sitemap 文件中，例如为菜单项指定图像...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T10:48:39.930

teknohippy 关于使用中继器的建议很棒！

然而，线

```
 <asp:Repeater ID="DropDownRepeater" DataSource='<%#Container.DataItem.ChildNodes()%>' runat="server"> 
```

是不正确的。它需要是

```
 <asp:Repeater ID="Repeater1" runat="server" DataSource='<%# ((SiteMapNode) Container.DataItem).ChildNodes %>'> 
```

为了工作。

这个优秀的教程中提供了详细信息：

[http://msdn.microsoft.com/en-us/library/aa581781.aspx](http://msdn.microsoft.com/en-us/library/aa581781.aspx)

# perl - 如何在 Perl 中禁止 Excel 的密码提示？

> ID：568924
> 
> 赞同：2
> 
> 时间：2009-02-20T09:43:01.340
> 
> 标签：perl, excel, passwords

请告诉我一个抑制excel文件密码提示的解决方案。

```
 use Win32::OLE;

      my $xlApp = Win32::OLE->new('Excel.Application');

      $xlApp->{Visible} = 0;

      $xlApp->{DisplayAlerts} = 0;

      # Open excel file.
      my $xlBook = $xlApp->Workbooks->Open("C:\\Documents and Settings\\username\\Desktop\\testfile.xls");
      my $Sheet1 = $xlBook->Worksheets(1);

        my $row = 1;
        my $col = 1;

       $Sheet1->Cells($row,$col)->{'Value'} = 5;

        if (Win32::OLE->LastError) 
        {
                print "File protected";
        }

      $xlBook ->Close();

  undef $xlBook; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T10:23:35.767

如果您知道密码，您可以在 open 命令的密码和/或 writerespassword 参数中提供它们。如果以这种方式提供密码，Excel 将不会提示输入密码。

如果您不知道密码但想阻止对话框出现，您可以在这些参数中提供虚拟密码（例如“ThisIsNotAPassword”）。我没有在文档中找到这个，但在 Excel 2003 中对其进行了测试：

*   如果 Excel 文件没有密码，则会打开它。
*   如果它确实有密码（除了提供的密码），它不会要求用户输入密码，但会失败并显示您可以检测到的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T10:02:39.967

您可以将以下 vb 代码转换为 perl 并尝试一下，请注意此代码是针对 vbproject 的，同样您可以检查工作表、单元格或整个工作表，同样的方式。

' 如果活动文档中的 VB 项目受到保护，则返回 TRUE ' 请不要

```
Function ProtectedVBProject(ByVal wb As Workbook) As Boolean

Dim VBC As Integer

  VBC = -1

  On Error Resume Next

  VBC = wb.VBProject.VBComponents.Count

  On Error GoTo 0

  If VBC = -1 Then

    ProtectedVBProject = True

  Else

    ProtectedVBProject = False

  End If

End Function 
```

例子：

```
If ProtectedVBProject(ActiveWorkbook) Then Exit Sub 
```

对于工作表

```
If ActiveWorkbook.ProtectStructure=True  Then Exit Sub 
```

对于活动的工作簿窗口

```
If ActiveWorkbook.ProtectWindows= True Then Exit sub 
```

等等..

或者你可以用密码打开excel表

Workbook 对象的 Open 方法采用 12 个参数。要打开具有密码保护的工作簿，您需要编写以下代码：

```
 Workbooks.Open "Book1.xls", , , ,"pswd" 
```

你也可以用 perl 来检查空参数。我不知道怎么给...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T17:27:41.193

根据 lakshmanaraj 的想法和未知的回应：

```
use Win32::OLE;

sub is_protected_vb_project { 
    my $work_book = shift;
    eval { 
        my $count = $work_book->{VBProject}{VBComponents}{Count};
    };
    Carp::carp $@ if $@;
    return $@ ? 1 : 0;
}

my $work_book = Win32::OLE->GetObject( 'd:/some/path/somewhere.xls' );
printf "is_protected_vb_project( \$work_book )=%s\n"
     , is_protected_vb_project( $work_book )
     ; 
```

# weblogic - 如何更改最大失败登录尝试以锁定 Weblogic 10.0 中的用户？

> ID：568926
> 
> 赞同：1
> 
> 时间：2009-02-20T09:43:18.953
> 
> 标签：weblogic, login-attempts, lockout

在锁定用户之前，我们需要将登录尝试次数设置为 3。似乎默认值为 5。如何在 Weblogic 10.0 中更改此值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T06:34:43.787

登录 WLS 控制台并转到：主页 > 安全领域摘要 > myrealm > 配置 > 用户锁定

锁定阈值是用户在锁定之前尝试登录的时间。

# coding-style - 要遵循的 url 参数命名约定或标准是什么

> ID：568929
> 
> 赞同：47
> 
> 时间：2009-02-20T09:43:42.120
> 
> 标签：coding-style, web-standards

是否有要遵循的 Url 参数的命名约定或标准。我通常使用驼色套管，例如`userId`or `itemNumber`。当我即将开始一个新项目时，我正在搜索是否有任何东西，但找不到任何东西。我不是从语言或框架的角度来看这个，而是作为一个通用的网络标准。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-20T10:13:07.790

我建议阅读Tim Berners-Lee 的[Cool URI's Don't Change](http://www.w3.org/Provider/Style/URI)以深入了解这个问题。如果您在 URI 中使用参数，最好重写它们以反映数据的实际含义。

因此，而不是具有以下内容：

```
/index.jsp?isbn=1234567890
/author-details.jsp?isbn=1234567890
/related.jsp?isbn=1234567890 
```

你会有

```
/isbn/1234567890/index
/isbn/1234567890/author-details
/isbn/1234567890/related 
```

它创建了一个更明显的数据结构，这意味着如果您更改平台架构，您的 URI 不会改变。如果没有上述结构，

```
/index.jsp?isbn=1234567890 
```

变成

```
/index.aspx?isbn=1234567890 
```

这意味着您网站上的所有链接现在都已损坏。

通常，您应该只在用户可以合理地期望他们正在检索的数据被生成时使用查询字符串，例如通过搜索。如果您使用查询字符串从数据库中检索不变的资源，则使用 URL 重写。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-20T09:49:11.187

没有我知道的标准。请注意 IE 的[URL 长度限制](http://support.microsoft.com/kb/208427)为 2,083 个字符。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-20T10:13:53.293

URI 的标准由[RFC2396](http://www.ietf.org/rfc/rfc2396.txt)定义。
URL 标准化部分之后的任何内容都留给您。

您可能只想根据您使用的框架遵循特定的参数约定。
大多数时候你甚至不会真正关心，因为这些不在你的控制之下，但当它们控制时，你可能希望至少保持一致并尝试生成用户友好的位：

*   很短，
*   如果它们旨在让用户直接访问，它们应该很容易记住，
*   不区分大小写（可能很难，具体取决于服务器操作系统）。
*   遵循一些[SEO 指南和最佳实践](http://www.seomoz.org/blog/11-best-practices-for-urls)，它们可能会对您有很大帮助。

我想说的是，在呈现 URL 时，整洁和用户友好是值得称赞的目标。
StackOverflow 在这方面做得相当好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T10:11:53.190

我用小写。根据您使用的技术，QS 可能会被威胁为区分大小写（例如 PHP）或不区分大小写（例如 ASP）。使用小写可以避免可能的混淆。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-20T09:51:43.083

像其他答案一样，我没有听说过任何约定。

我会坚持的唯一“标准”是使用对搜索引擎更友好的做法，即使用 URL 重写器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T09:58:56.933

没有我知道的标准，大小写无关紧要。

但是，在您的应用程序（网站）中，您应该坚持自己的标准。如果没有别的，为了你自己的理智。

# c# - 如何获得一个看起来像没有选项卡的 TabControl 的控件？

> ID：568941
> 
> 赞同：1
> 
> 时间：2009-02-20T09:47:28.193
> 
> 标签：c#, .net, winforms, tabcontrol

我们有一个表单，可以在选项卡控件的选项卡页中显示媒体项目，我正在实现一项功能，该功能允许用户将选项卡页“弹出”到他们自己的表单中。

但是，当我将媒体播放器添加到表单而不是 TabPage 时，背景会从选项卡页的渐变填充切换到父表单的普通 SystemColors.Control 背景。我需要将媒体播放器添加到与 TabControl 具有相同背景但顶部不显示选项卡的控件中。我尝试将媒体播放器添加到 TabControl 的控件集合中，但这只会引发异常。

如何获得一个看起来像没有选项卡的 TabControl 的控件？我应该继续尝试将媒体播放器添加到 TabControl，还是应该尝试编写具有自定义绘制背景的面板？如果是后者，我如何确保它适用于所有可能的主题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T10:35:49.123

这些问题似乎与 UseVisbleBackgroundStyle 有关。只有 AFAIK 按钮和 TabPages 具有此属性。

以下是一个非常肮脏的hack，只是为了让你开始：

1) 从 Panel 派生一个 customControl 并添加“使用 System.Windows.Forms.VisualStyles;”

2）添加以下代码

```
//warning: incomplete, add error checking etc
private readonly VisualStyleElement element = VisualStyleElement.Tab.Body.Normal;
public bool UseVisbleBackgroundStyle { get; set; }

protected override void OnPaint(PaintEventArgs pe)
{
    if (UseVisbleBackgroundStyle)
    {
        var x = new VisualStyleRenderer(element);                           
        x.DrawBackground(pe.Graphics, this.ClientRectangle);
    }
    else
    {
        base.OnPaint(pe);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T11:27:59.590

感谢 Henk - 我最终选择了：

```
protected override void OnPaintBackground(PaintEventArgs e)
{
    if (TabRenderer.IsSupported && Application.RenderWithVisualStyles)
    {
        TabRenderer.DrawTabPage(pe.Graphics, this.ClientRectangle);
    }
    else
    {
        base.OnPaintBackground(pe);
        ControlPaint.DrawBorder3D(pe.Graphics, this.ClientRectangle, Border3DStyle.Raised);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T09:54:15.603

尝试创建您自己的客户 UserControl

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-21T17:33:22.070

此答案是从另一个[答案站点](http://www.aspnet-answers.com/microsoft/Visual-Studio-General/30164969/tab-control-without-tabs.aspx)修改的。它做得相当干净。

在包含选项卡控件的窗口的加载事件中，尝试：

```
// TabControl is the name of the tab control in this window.
TabControl.Appearance = TabAppearance.FlatButtons;
TabControl.Multiline = false;
TabControl.SizeMode = TabSizeMode.Fixed;
TabControl.ItemSize = new Size(0,1);

// The tabs are now gone.  Select the panel you want to display
TabControl.SelectTab("InProgressTab"); 
```

# objective-c - 同一视图控制器中的两个警报视图

> ID：568948
> 
> 赞同：4
> 
> 时间：2009-02-20T09:51:36.233
> 
> 标签：objective-c, iphone

我`UIAlertView`在同一个视图控制器中有两个，我想使用委托方法

```
-(void)alertView:(UIAlertView *）alertView clickedButtonAtIndex:(NSInteger) buttonIndex 
```

当按下警报视图中的按钮时，将调用此方法。但是，两个警报视图都将调用相同的方法。

如何区分两个警报视图？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T09:56:12.743

`tag`显示警报时将属性设置为不同的值。它只是一个整数，可以在回调/委托方法中查询。

这是一个示例（使用 ActionSheet 而不是 AlertView，但原理完全相同）：

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Title"
                                                         delegate:self
                                                cancelButtonTitle:@"Cancel"
                                           destructiveButtonTitle:nil
                                                otherButtonTitles:@"Some option", nil];
actionSheet.actionSheetStyle = UIActionSheetStyleDefault;
actionSheet.tag = 10;
[actionSheet showInView:self.view];
[actionSheet release]; 
```

然后在您的选择器中：

```
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
  switch (actionSheet.tag) {
    case 10:
      // do stuff
      break;
    case 20:
      // do other stuff
      break;
  }
} 
```

当然，您会使用常量而不是文字值、本地化字符串等，但这是基本思想。

# .htaccess - RewriteRule - a.php?a=123 到 /b/123

> ID：568953
> 
> 赞同：3
> 
> 时间：2009-02-20T09:54:28.817
> 
> 标签：.htaccess, mod-rewrite

我试图让 Apache 将**/a.php?a=123**重定向到**/b/123**（其中 123 可以是 1 到 9999 之间的任何数字），但似乎无法让它工作。

这就是我在 htaccess 中所拥有的：

```
RewriteEngine on

RewriteRule ^a.php?a=([0-9]+) /b/$1 [L]
RewriteRule ^a.php$ /c/ [L] 
```

这将 a.php?a=123 结果为 404，但仅 a.php 按预期工作。我试图逃避？（*RewriteRule ^a.php\?a=([0-9]+) /b/$1 [L]*）但它仍然不起作用。

请问我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T10:39:15.323

查询字符串不是`RewriteRule`指令中测试的 URI 路径的一部分。这只能使用`RewriteCond`指令进行测试：

```
RewriteCond %{QUERY_STRING} ^a=([0-9]+)$
RewriteRule ^a\.php$ /b/%1? [L,R]
RewriteCond %{QUERY_STRING} ^$
RewriteRule ^a\.php$ /c/ [L,R] 
```

但是如果你想要它的另一种方式（请求`/b/123`被重定向到`/a.php?a=123`）：

```
RewriteRule ^b/([0-9]+)$ a.php?a=$1 [L] 
```

# python - 如何在 NumPy 中创建一个空数组/矩阵？

> ID：568962
> 
> 赞同：397
> 
> 时间：2009-02-20T09:58:11.680
> 
> 标签：python, arrays, numpy

我不知道如何以通常使用列表的方式使用数组或矩阵。我想创建一个空数组（或矩阵），然后一次添加一列（或行）。

目前我能找到的唯一方法是：

```
mat = None
for col in columns:
    if mat is None:
        mat = col
    else:
        mat = hstack((mat, col)) 
```

而如果它是一个列表，我会做这样的事情：

```
list = []
for item in data:
    list.append(item) 
```

有没有办法为[NumPy](http://en.wikipedia.org/wiki/NumPy)数组或矩阵使用这种表示法？

* * *

## 回答 #1

> 赞同：532
> 
> 时间：2009-02-20T10:36:46.047

您对有效使用 NumPy 有错误的心智模型。NumPy 数组存储在连续的内存块中。如果要向现有数组添加行或列，则需要将整个数组复制到新的内存块中，从而为要存储的新元素创建间隙。如果重复构建数组，这是非常低效的。

在添加行的情况下，最好的办法是创建一个与数据集最终一样大的数组，然后逐行为其分配数据：

```
>>> import numpy
>>> a = numpy.zeros(shape=(5,2))
>>> a
array([[ 0.,  0.],
   [ 0.,  0.],
   [ 0.,  0.],
   [ 0.,  0.],
   [ 0.,  0.]])
>>> a[0] = [1,2]
>>> a[1] = [2,3]
>>> a
array([[ 1.,  2.],
   [ 2.,  3.],
   [ 0.,  0.],
   [ 0.,  0.],
   [ 0.,  0.]]) 
```

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-02-20T10:44:19.947

NumPy 数组是与列表非常不同的数据结构，旨在以不同的方式使用。您的使用`hstack`可能非常低效......每次调用它时，现有数组中的所有数据都会被复制到一个新数组中。（这个`append`函数也会有同样的问题。）如果你想一次建立你的矩阵一列，你最好把它保存在一个列表中，直到它完成，然后才将它转换成一个数组。

例如

```
 mylist = []
for item in data:
    mylist.append(item)
mat = numpy.array(mylist) 
```

`item`可以是列表、数组或任何可迭代的，只要每个`item`具有相同数量的元素。
在这种特殊情况下（`data`是一些可迭代的保存矩阵列），您可以简单地使用

```
 mat = numpy.array(data) 
```

（另请注意，`list`用作变量名可能不是一个好习惯，因为它会用该名称掩盖内置类型，这可能会导致错误。）

编辑：

如果出于某种原因您确实想创建一个空数组，则可以使用 `numpy.array([])`，但这很少有用！

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2014-04-10T04:34:58.840

要在 NumPy 中创建一个空的多维数组（例如，一个 2D 数组`m*n`来存储您的矩阵），以防您不知道`m`要追加多少行并且不关心 Stephen Simmons 提到的计算成本（即重新构建每个追加的数组），您可以将要追加到的维度压缩到 0: `X = np.empty(shape=[0, n])`。

例如，您可以使用这种方式（在这里`m = 5`我们假设我们在创建空矩阵时不知道，并且`n = 2`）：

```
import numpy as np

n = 2
X = np.empty(shape=[0, n])

for i in range(5):
    for j  in range(2):
        X = np.append(X, [[i, j]], axis=0)

print X 
```

这会给你：

```
[[ 0\.  0.]
 [ 0\.  1.]
 [ 1\.  0.]
 [ 1\.  1.]
 [ 2\.  0.]
 [ 2\.  1.]
 [ 3\.  0.]
 [ 3\.  1.]
 [ 4\.  0.]
 [ 4\.  1.]] 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2013-04-10T12:39:58.700

我对此进行了很多研究，因为我需要在我的一个学校项目中使用 numpy.array 作为一个集合，并且我需要初始化为空......我在 Stack Overflow 上没有找到任何相关答案，所以我开始了涂鸦的东西。

```
# Initialize your variable as an empty list first
In [32]: x=[]
# and now cast it as a numpy ndarray
In [33]: x=np.array(x) 
```

结果将是：

```
In [34]: x
Out[34]: array([], dtype=float64) 
```

因此，您可以直接初始化一个 np 数组，如下所示：

```
In [36]: x= np.array([], dtype=np.float64) 
```

我希望这有帮助。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-20T10:27:31.797

您可以使用附加功能。对于行：

```
>>> from numpy import *
>>> a = array([10,20,30])
>>> append(a, [[1,2,3]], axis=0)
array([[10, 20, 30],      
       [1, 2, 3]]) 
```

对于列：

```
>>> append(a, [[15],[15]], axis=1)
array([[10, 20, 30, 15],      
       [1, 2, 3, 15]]) 
```

* * *

**编辑**
当然，正如其他答案中所提到的，除非您每次都在矩阵/数组上进行一些处理（例如反转），否则我只会创建一个列表，附加到它然后将其转换为大批。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-02-05T08:41:38.503

这是使 numpys 看起来更像列表的一些解决方法

```
np_arr = np.array([])
np_arr = np.append(np_arr , 2)
np_arr = np.append(np_arr , 24)
print(np_arr) 
```

输出：数组（[2., 24.]）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-04-14T06:23:31.393

要创建一个空的 NumPy 数组而不定义其形状，您可以执行以下操作：

```
arr = np.array([]) 
```

第一个是首选，因为您知道您将使用它作为 NumPy 数组。NumPy`np.ndarray`之后将其转换为类型，无需额外`[]`的“维度”。

为了向数组添加新元素，我们可以这样做：

```
arr = np.append(arr, 'new element') 
```

> 请注意，在 python 的背景中，没有定义其形状的数组是不存在的。正如@hpaulj 提到的，这也构成了一个单秩数组。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-09-06T21:20:44.693

如果您绝对不知道数组的最终大小，可以像这样增加数组的大小：

```
my_arr = numpy.zeros((0,5))
for i in range(3):
    my_arr=numpy.concatenate( ( my_arr, numpy.ones((1,5)) ) )
print(my_arr)

[[ 1\.  1\.  1\.  1\.  1.]  [ 1\.  1\.  1\.  1\.  1.]  [ 1\.  1\.  1\.  1\.  1.]] 
```

*   注意`0`第一行中的。
*   `numpy.append`是另一种选择。它调用`numpy.concatenate`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-10-01T17:50:36.103

您可以应用它来构建任何类型的数组，例如零：

```
a = range(5)
a = [i*0 for i in a]
print a 
[0, 0, 0, 0, 0] 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-09-11T00:28:42.980

根据您使用它的目的，您可能需要指定数据类型（参见['dtype'](http://docs.scipy.org/doc/numpy/reference/generated/numpy.dtype.html)）。

例如，要创建一个 8 位值的二维数组（适合用作单色图像）：

```
myarray = numpy.empty(shape=(H,W),dtype='u1') 
```

对于 RGB 图像，在形状中包含颜色通道的数量：`shape=(H,W,3)`

您可能还需要考虑使用`numpy.zeros`而不是使用 进行零初始化`numpy.empty`。[请参阅此处](http://docs.scipy.org/doc/numpy/reference/generated/numpy.empty.html)的注释。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-03-11T07:11:00.920

另一种创建可以接受数组的空数组的简单方法是：

```
import numpy as np
np.empty((2,3), dtype=object) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-10-09T06:43:11.327

我认为您想使用列表处理大部分工作，然后将结果用作矩阵。也许这是一种方式；

```
ur_list = []
for col in columns:
    ur_list.append(list(col))

mat = np.matrix(ur_list) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-08-30T13:47:41.997

我认为您可以创建空的 numpy 数组，例如：

```
>>> import numpy as np
>>> empty_array= np.zeros(0)
>>> empty_array
array([], dtype=float64)
>>> empty_array.shape
(0,) 
```

当您想在循环中附加 numpy 数组时，此格式很有用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-06-19T23:38:01.083

也许您正在寻找的是这样的：

```
x=np.array(0) 
```

通过这种方式，您可以创建一个没有任何元素的数组。它类似于：

```
x=[] 
```

这样您就可以提前将新元素附加到您的数组中。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-05-20T16:33:58.127

# **最简单的方法**

输入：

```
import numpy as np
data = np.zeros((0, 0), dtype=float)   # (rows,cols)
data.shape 
```

输出：
(0, 0)

输入：

```
for i in range(n_files):
     data = np.append(data, new_data, axis = 0) 
```

# c# - 有谁知道更快的方法来执行 String.Split()？

> ID：568968
> 
> 赞同：23
> 
> 时间：2009-02-20T10:00:00.503
> 
> 标签：c#, .net, performance, string, csv

我正在读取 CSV 文件的每一行，并且需要获取每列中的各个值。所以现在我只是在使用：

```
values = line.Split(delimiter); 
```

where`line`是保存由分隔符分隔的值的字符串。

测量我的`ReadNextRow`方法的性能时，我注意到它花费了 66% `String.Split`，所以我想知道是否有人知道更快的方法来做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-20T10:08:36.257

string.Split 的 BCL 实现实际上非常快，我在这里做了一些测试，试图超越它，这并不容易。

但是您可以做一件事，那就是将其实现为生成器：

```
public static IEnumerable<string> GetSplit( this string s, char c )
{
    int l = s.Length;
    int i = 0, j = s.IndexOf( c, 0, l );
    if ( j == -1 ) // No such substring
    {
        yield return s; // Return original and break
        yield break;
    }

    while ( j != -1 )
    {
        if ( j - i > 0 ) // Non empty? 
        {
            yield return s.Substring( i, j - i ); // Return non-empty match
        }
        i = j + 1;
        j = s.IndexOf( c, i, l - i );
    }

    if ( i < l ) // Has remainder?
    {
        yield return s.Substring( i, l - i ); // Return remaining trail
    }
} 
```

对于小字符串，上述方法不一定比 string.Split 快，但它会在找到结果时返回结果，这就是惰性求值的威力。如果您排长队或需要节省内存，这就是您要走的路。

上述方法受限于 IndexOf 和 Substring 的性能，它们执行过多的超出范围检查的索引，为了更快，您需要优化这些并实现自己的辅助方法。您可以击败 string.Split 性能，但它需要 cleaver int-hacking。[你可以在这里](https://stackoverflow.com/questions/399798/memory-efficiency-and-performance-of-string-replace-net-framework/400065#400065)阅读我的帖子。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-20T10:08:18.783

应该指出的`split()`是，如果您在文件中遇到逗号，则解析 CSV 文件是一种有问题的方法，例如：

```
1,"Something, with a comma",2,3 
```

在不知道您是如何分析的情况下，我要指出的另一件事是在分析这种低级细节时要小心。Windows/PC 计时器的粒度可能会发挥作用，并且您在循环时可能会有很大的开销，因此请使用某种控制值。

话虽如此，`split()`它是为处理正则表达式而构建的，这显然比您需要的更复杂（无论如何处理转义逗号的工具都是错误的）。此外，`split()`还会创建许多临时对象。

因此，如果您想加快速度（我很难相信这部分的性能确实是一个问题），那么您想手动完成，并且您想重用缓冲区对象，这样您就不会不断地创建对象并给出垃圾收集器在清理它们时要做的工作。

算法相对简单：

*   停在每个逗号处；
*   当您点击引号时继续，直到您点击下一组引号；
*   处理转义的引号（即 \"）和可以说转义的逗号 (\,)。

哦，为了让您了解正则表达式的成本，有一个问题（Java 不是 C#，但原理相同）有人想用字符串替换每个第 n 个字符。我建议`replaceAll()`在字符串上使用。Jon Skeet 手动编码循环。出于好奇，我比较了两个版本，他的版本要好一个数量级。

所以如果你真的想要性能，是时候手动解析了。

或者，更好的是，使用其他人的优化解决方案，例如[快速 CSV 阅读器](http://www.codeproject.com/KB/database/CsvReader.aspx?fid=142714&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=126&select=2741699)。

顺便说一句，虽然这与 Java 有关，但它通常涉及正则表达式的性能（这是通用`replaceAll()`的）和手工编码的循环：[将 char 放入每个 N 个字符的 java 字符串中](https://stackoverflow.com/questions/537174/putting-char-into-a-java-string-for-each-n-characters)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-04T19:01:04.727

根据使用情况，您可以使用 Pattern.split 而不是 String.split 来加快速度。如果您在循环中有此代码（我假设您可能会这样做，因为听起来您正在解析文件中的行） String.split(String regex) 每次循环语句都会在您的正则表达式字符串上调用 Pattern.compile执行。为了优化这一点，Pattern.compile 循环外的模式一次，然后使用 Pattern.split，在循环内传递要拆分的行。

希望这可以帮助

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-16T17:34:11.763

[我从Dejan Pelzel 的博客](http://dejan-pelzel.com/post/109194509740/c-high-performance-net-string-split)中发现这个实现快了 30% 。我从那里引用：

**解决方案**

> 考虑到这一点，我开始创建一个字符串拆分器，该拆分器将使用类似于 StringBuilder 的内部缓冲区。它使用非常简单的逻辑来遍历字符串并将值部分保存到缓冲区中。

```
public int Split(string value, char separator)
{
    int resultIndex = 0;
    int startIndex = 0;

    // Find the mid-parts
    for (int i = 0; i < value.Length; i++)
    {
        if (value[i] == separator)
        {
            this.buffer[resultIndex] = value.Substring(startIndex, i - startIndex);
            resultIndex++;
            startIndex = i + 1;
        }
    }

    // Find the last part
    this.buffer[resultIndex] = value.Substring(startIndex, value.Length - startIndex);
    resultIndex++;

    return resultIndex; 
```

**如何使用**

> 正如您在下面的示例中所见，StringSplitter 类的使用非常简单。请注意重用 StringSplitter 对象，而不是在循环中或一次性使用它的新实例。在这种情况下，最好使用内置的 String.Split。

```
var splitter = new StringSplitter(2);
splitter.Split("Hello World", ' ');
if (splitter.Results[0] == "Hello" && splitter.Results[1] == "World")
{
    Console.WriteLine("It works!");
} 
```

> Split 方法返回找到的项目数，因此您可以轻松地遍历结果，如下所示：

```
var splitter = new StringSplitter(2);
var len = splitter.Split("Hello World", ' ');
for (int i = 0; i < len; i++)
{
    Console.WriteLine(splitter.Results[i]);
} 
```

这种方法有优点也有缺点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-07T17:39:07.193

这是一个使用 ReadOnlySpan 的非常基本的示例。在我的机器上，这大约需要 150ns，而 string.Split() 大约需要 250ns。这是一个不错的 40% 的改进。

```
string serialized = "1577836800;1000;1";
ReadOnlySpan<char> span = serialized.AsSpan();

Trade result = new Trade();

index = span.IndexOf(';');
result.UnixTimestamp = long.Parse(span.Slice(0, index));
span = span.Slice(index + 1);

index = span.IndexOf(';');
result.Price = float.Parse(span.Slice(0, index));
span = span.Slice(index + 1);

index = span.IndexOf(';');
result.Quantity = float.Parse(span.Slice(0, index));

return result; 
```

请注意，ReadOnlySpan.Split() 将很快成为框架的一部分。见 [https://github.com/dotnet/runtime/pull/295](https://github.com/dotnet/runtime/pull/295)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T10:09:23.320

您可能认为需要进行优化，但现实情况是您将在其他地方为它们付费。

例如，您可以“自己”进行拆分并遍历所有字符并在遇到每一列时对其进行处理，但从长远来看，您将复制字符串的所有部分。

例如，我们可以在 C 或 C++ 中进行的优化之一是将所有分隔符替换为 '\0' 字符，并保留指向列开头的指针。然后，我们不必复制所有字符串数据来获取其中的一部分。但这在 C# 中是做不到的，您也不想这样做。

如果源中的列数与您需要的列数之间存在很大差异，则手动遍历字符串可能会产生一些好处。但是这种好处会花费您开发和维护它的时间。

有人告诉我，90% 的 CPU 时间花在 10% 的代码上。这个“真相”有不同的说法。在我看来，如果处理 CSV 是您的应用程序需要做的事情，那么在拆分中花费 66% 的时间并没有那么糟糕。

戴夫

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T10:13:45.353

[对 String.Slit() vs Regex 和其他方法进行了一些非常彻底的分析。](http://dotnetperls.com/Content/String-Split-Benchmark.aspx)

不过，我们正在谈论通过非常大的字符串节省 ms。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T10:32:35.870

String.Split 的主要问题（？）是它是通用的，因为它可以满足许多需求。

如果您比拆分更了解您的数据，它可以改进您自己的数据。

例如，如果：

1.  您不关心空字符串，因此您不需要以任何特殊方式处理它们
2.  你不需要修剪字符串，所以你不需要对它们做任何事情或围绕它们做任何事情
3.  您无需检查引用的逗号或引号
4.  你根本不需要处理报价

如果其中任何一个是正确的，您可能会通过编写自己的更具体版本的 String.Split 来看到改进。

话虽如此，您应该问的第一个问题是这是否真的是一个值得解决的问题。读取和导入文件所花费的时间是否如此之长，以至于您实际上觉得这是一种很好的利用时间？如果没有，那我就别管它了。

第二个问题是为什么 String.Split 与您的其他代码相比使用了那么多时间。如果答案是代码对数据做的很少，那么我可能不会打扰。

但是，如果您将数据填充到数据库中，那么您在 String.Split 中花费的代码时间的 66% 构成了一个大问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-20T12:29:57.320

CSV 解析实际上是非常复杂的，我使用了基于包装 ODBC 文本驱动程序的类，这是我唯一一次必须这样做。

上面推荐的 ODBC 解决方案乍一看基本上是相同的方法。

我强烈建议您在走得太远之前对 CSV 解析进行一些研究，而这条路几乎但不是很有效（太常见了）。在我的经验中，只有双引号字符串*需要*它的 Excel 是最棘手的处理之一。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-03-04T15:51:58.010

正如其他人所说，`String.Split()`它并不总是适用于 CSV 文件。考虑一个看起来像这样的文件：

```
"First Name","Last Name","Address","Town","Postcode"
David,O'Leary,"12 Acacia Avenue",London,NW5 3DF
June,Robinson,"14, Abbey Court","Putney",SW6 4FG
Greg,Hampton,"",,
Stephen,James,"""Dunroamin"" 45 Bridge Street",Bristol,BS2 6TG 
```

（例如，语音标记的使用不一致，包括逗号和语音标记的字符串等）

这个 CSV 阅读框架将处理所有这些，并且非常高效：

[Sebastien Lorien 的 LumenWorks.Framework.IO.Csv](http://www.codeproject.com/KB/database/CsvReader.aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-18T01:53:36.577

这是我的解决方案：

```
Public Shared Function FastSplit(inputString As String, separator As String) As String()
        Dim kwds(1) As String
        Dim k = 0
        Dim tmp As String = ""

        For l = 1 To inputString.Length - 1
            tmp = Mid(inputString, l, 1)
            If tmp = separator Then k += 1 : tmp = "" : ReDim Preserve kwds(k + 1)
            kwds(k) &= tmp
        Next

        Return kwds
End Function 
```

这是一个带有基准测试的版本：

```
Public Shared Function FastSplit(inputString As String, separator As String) As String()
        Dim sw As New Stopwatch
        sw.Start()
        Dim kwds(1) As String
        Dim k = 0
        Dim tmp As String = ""

        For l = 1 To inputString.Length - 1
            tmp = Mid(inputString, l, 1)
            If tmp = separator Then k += 1 : tmp = "" : ReDim Preserve kwds(k + 1)
            kwds(k) &= tmp
        Next
        sw.Stop()
        Dim fsTime As Long = sw.ElapsedTicks

        sw.Start()
        Dim strings() As String = inputString.Split(separator)
        sw.Stop()

        Debug.Print("FastSplit took " + fsTime.ToString + " whereas split took " + sw.ElapsedTicks.ToString)

        Return kwds
End Function 
```

以下是一些相对较小但大小不一的字符串的结果，最多 8kb 块。（时间以刻度为单位）

FastSplit 花了 8 而 split 花了 10

FastSplit 需要 214 而 split 需要 216

FastSplit 需要 10 而 split 需要 12

FastSplit 花了 8 而 split 花了 9

FastSplit 花了 8 而 split 花了 10

FastSplit 需要 10 而 split 需要 12

FastSplit 需要 7 而 split 需要 9

FastSplit 需要 6 而 split 需要 8

FastSplit 需要 5 而 split 需要 7

FastSplit 需要 10 而 split 需要 13

FastSplit 用了 9 而 split 用了 232

FastSplit 需要 7 而 split 需要 8

FastSplit 花了 8 而 split 花了 9

FastSplit 花了 8 而 split 花了 10

FastSplit 需要 215 而 split 需要 217

FastSplit 花了 10 而 split 花了 231

FastSplit 花了 8 而 split 花了 10

FastSplit 花了 8 而 split 花了 10

FastSplit 需要 7 而 split 需要 9

FastSplit 花了 8 而 split 花了 10

FastSplit 花了 10 而 split 花了 1405

FastSplit 用了 9 而 split 用了 11

FastSplit 花了 8 而 split 花了 10

> 另外，我知道有人会阻止我使用 ReDim Preserve 而不是使用列表...原因是，列表在我的基准测试中确实没有提供任何速度差异，所以我回到了“简单”的方式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-05-11T16:19:02.533

```
 public static unsafe List<string> SplitString(char separator, string input)
    {
        List<string> result = new List<string>();
        int i = 0;
        fixed(char* buffer = input)
        {
            for (int j = 0; j < input.Length; j++)
            {
                if (buffer[j] == separator)
                {
                    buffer[i] = (char)0;
                    result.Add(new String(buffer));
                    i = 0;
                }
                else
                {
                    buffer[i] = buffer[j];
                    i++;
                }
            }
            buffer[i] = (char)0;
            result.Add(new String(buffer));
        }
        return result;
    } 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-02-20T10:09:12.043

您可以假设 String.Split 将接近最优；即它可能很难改进。到目前为止，更简单的解决方案是检查是否需要拆分字符串。您很可能会直接使用各个字符串。如果您定义一个 StringShim 类（引用 String、begin & end index），您将能够将 String 拆分为一组 shim。这些将具有较小的固定大小，并且不会导致字符串数据复制。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2010-12-09T02:13:10.887

`String.split`相当慢，如果你想要一些更快的方法，你去。:)

但是，基于规则的解析器可以更好地解析 CSV。

这家伙，为java制作了一个基于规则的标记器。（不幸的是需要一些复制和粘贴）

[http://www.csdgn.org/code/rule-tokenizer](http://www.csdgn.org/code/rule-tokenizer)

```
private static final String[] fSplit(String src, char delim) {
    ArrayList<String> output = new ArrayList<String>();
    int index = 0;
    int lindex = 0;
    while((index = src.indexOf(delim,lindex)) != -1) {
        output.add(src.substring(lindex,index));
        lindex = index+1;
    }
    output.add(src.substring(lindex));
    return output.toArray(new String[output.size()]);
}

private static final String[] fSplit(String src, String delim) {
    ArrayList<String> output = new ArrayList<String>();
    int index = 0;
    int lindex = 0;
    while((index = src.indexOf(delim,lindex)) != -1) {
        output.add(src.substring(lindex,index));
        lindex = index+delim.length();
    }
    output.add(src.substring(lindex));
    return output.toArray(new String[output.size()]);
} 
```

# c# - 如果我有用户名和密码，我如何使用另一个身份在 asp.net 中执行我的代码

> ID：568970
> 
> 赞同：1
> 
> 时间：2009-02-20T10:01:51.263
> 
> 标签：c#, asp.net, security, wmi

我正在构建一个基于 Web 的小型管理应用程序。在其中，我需要通过 wmi 使用不同的帐户连接到不同的服务器。

我想告诉我的应用程序：你现在由 user1 运行，做这个和这个。然后我想告诉它：现在你是user2，做这个做这个。

我想，我的问题不是很清楚，我会重构它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T10:06:01.457

您必须编写一段单独的 .Net 代码（也有一些非托管调用）来模拟您的用户，然后在模拟该用户时调用您的代码。然后，您可以在之后恢复用户帐户：

为 VB 示例道歉，但这很容易移植到 C#。

* * *

## VB 示例

```
Public Class UserImpersonation

    Private Declare Auto Function LogonUser Lib "advapi32.dll" (ByVal lpszUsername As [String], _
        ByVal lpszDomain As [String], ByVal lpszPassword As [String], _
        ByVal dwLogonType As Integer, ByVal dwLogonProvider As Integer, _
        ByRef phToken As IntPtr) As Boolean

    <DllImport("kernel32.dll")> _
    Private Shared Function FormatMessage(ByVal dwFlags As Integer, ByRef lpSource As IntPtr, _
        ByVal dwMessageId As Integer, ByVal dwLanguageId As Integer, ByRef lpBuffer As [String], _
        ByVal nSize As Integer, ByRef Arguments As IntPtr) As Integer

    End Function

    Private Declare Auto Function CloseHandle Lib "kernel32.dll" (ByVal handle As IntPtr) As Boolean

    Private Declare Auto Function DuplicateToken Lib "advapi32.dll" (ByVal ExistingTokenHandle As IntPtr, _
            ByVal SECURITY_IMPERSONATION_LEVEL As Integer, _
            ByRef DuplicateTokenHandle As IntPtr) As Boolean

    <PermissionSetAttribute(SecurityAction.Demand, Name:="FullTrust")> _
    Public Shared Function ImpersonateUser(ByVal strDomain As String, ByVal strUserid As String, ByVal strPassword As String) As WindowsImpersonationContext

        Dim tokenHandle As New IntPtr(0)
        Dim dupeTokenHandle As New IntPtr(0)

        Try
            ' Get the user token for the specified user, domain, and password using the 
            ' unmanaged LogonUser method.  
            ' The local machine name can be used for the domain name to impersonate a user on this machine.

            Const LOGON32_PROVIDER_DEFAULT As Integer = 0
            'This parameter causes LogonUser to create a primary token.
            Const LOGON32_LOGON_INTERACTIVE As Integer = 2

            tokenHandle = IntPtr.Zero

            ' Call LogonUser to obtain a handle to an access token.
            Dim returnValue As Boolean = LogonUser(strUserid, strDomain, strPassword, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, tokenHandle)

            If returnValue = False Then
                Dim ret As Integer = Marshal.GetLastWin32Error()
                Throw New System.ComponentModel.Win32Exception(ret)
            Else
                ' Use the token handle returned by LogonUser.
                Dim newId As New WindowsIdentity(tokenHandle)
                Dim ImpersonatedUser As WindowsImpersonationContext = newId.Impersonate()

                Return ImpersonatedUser
            End If

        Catch ex As Exception
            Console.WriteLine("UserImpersonation.impersonateUser Exception Occurred: " + ex.Message)

            Return Nothing
        End Try

        ' Free the tokens.
        If Not System.IntPtr.op_Equality(tokenHandle, IntPtr.Zero) Then
            CloseHandle(tokenHandle)
        End If
    End Function

    Public Shared Function UndoImpersonate(ByVal WIC As WindowsImpersonationContext) As Boolean
        Try
            ' Stop impersonating the user.
            WIC.Undo()

            Return True
        Catch ex As Exception
            Console.WriteLine(("Exception occurred. " + ex.Message))

            Return False
        End Try

    End Function
End Class 
```

# python - 如何以编程方式将注释插入 Microsoft Word 文档？

> ID：568972
> 
> 赞同：10
> 
> 时间：2009-02-20T10:02:47.423
> 
> 标签：python, ms-word, common-lisp, openxml

寻找一种以编程方式将注释（使用 Word 中的注释功能）插入 MS Word 文档中特定位置的方法。我更喜欢一种可以在最新版本的 MS Word 标准格式中使用并且可以在非 Windows 环境中实现的方法（最好使用 Python 和/或 Common Lisp）。我一直在查看 OpenXML SDK，但似乎无法在那里找到解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T10:44:49.507

这是我所做的：

1.  用word创建一个简单的文档（即一个非常小的文档）
2.  在 Word 中添加评论
3.  另存为 .docx。
4.  使用 python 的 zip 模块访问存档（docx 文件是 ZIP 存档）。
5.  转储档案中条目“word/document.xml”的内容。这是文档本身的 XML。

这应该让你知道你需要做什么。之后，您可以使用 Python 中的 XML 库之一来解析文档，对其进行更改并将其添加回扩展名为“.docx”的新 ZIP 存档。只需从原始 ZIP 中复制所有其他条目，您就有了一个新的、有效的 Word 文档。

还有一个可能有帮助的库：[openxmllib](http://code.google.com/p/openxmllib/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T10:27:54.977

如果这是服务器端（非交互式），则不支持使用 Word 应用程序本身（但我认为这不适用）。因此，要么采取这条路线，要么使用[OpenXML SDK](http://msdn.microsoft.com/en-us/library/bb448854.aspx)来学习创建评论所需的标记。有了这些知识，一切都与操纵数据有关。

.docx 格式是具有定义结构的 XML 文件的 ZIP，因此大多数情况下，一旦您进入 ZIP 并获得正确的 XML 文件，就变成了修改 XML DOM 的问题。

最好的方法可能是获取一个 docx，复制它，在其中添加评论（使用 Word），然后进行比较。差异将向您展示您需要在 SDK（或 ISO/Ecma 标准）中查找的元素/结构类型。

# c# - UML 2 Profiles 包：如何扩展操作？

> ID：568973
> 
> 赞同：1
> 
> 时间：2009-02-20T10:02:48.250
> 
> 标签：c#, uml, profile, metaclass

我在 uml 配置文件实现方面遇到了很大的麻烦。问题是我不知道如何使用 Profile 从 Infrastructure::Core::Constructs 扩展 uml Operation 类？

根据 uml 元模型，来自 Profiles 包的扩展关联仅允许元类属于 Core::Constructs::Class 类型。

操作是元类吗？如果是这样，我怎么能把它作为 Core::Consructs::Class 呢？据我所见，没有一个 uml 元模型 Operation 确实专门或实现了 Core::Constructs::Class。

请帮我。

我正在尝试使用 C# 中的第三方 uml 2.* 元模型实现在 C# 中实现我的 uml 配置文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T03:41:10.513

一些工具可能不支持操作扩展，但如果支持，这里是如何。如果您不是在谈论模型的简单构造型扩展，例如尝试创建用于操作的数据类型，请澄清您的问题。Stereotype 只是扩展 Metaclass 操作，然后您在模型中使用该构造型。这些示例来自 IBM RSM，并且运行良好。

**轮廓：**

![简介答案](https://lh6.ggpht.com/_WOVuHMLDMuw/Scmm71lVM-I/AAAAAAAAABI/HI0zPmyWZLs/operation-extension-example.jpg)

**申请：**

![应用示例](https://lh6.ggpht.com/_WOVuHMLDMuw/Scmm8bVnPUI/AAAAAAAAABQ/BmzKYYcATNU/operation-stereotype-applied-example.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T11:10:18.263

已经找到答案了。这可以通过泛化结合 Profiles::Class 和 Kernel::Operation 来实现。

# javascript - 识别刷新和关闭浏览器操作

> ID：568977
> 
> 赞同：55
> 
> 时间：2009-02-20T10:06:23.033
> 
> 标签：javascript, browser

当我们刷新页面（F5，或者浏览器中的图标）时，它会首先触发 ONUNLOAD 事件。当我们关闭浏览器（右上角的 X 图标）时，会触发 ONUNLOAD 事件。现在当 ONUNLOAD 事件被触发时，没有办法区分刷新页面或关闭浏览器。如果您有任何解决方案，请给我。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-17T15:18:33.227

有一个解决方案。

我想在关闭选项卡或浏览器窗口时断开服务器上的用户连接，但不是在重新加载页面时断开连接（您可能希望区分重新加载/关闭事件以用于不同的目的，但您可能会从我的解决方案中受益）。基于 HTML5 的本地存储和客户端/服务器 AJAX 通信，我最终完成了以下过程：

1.  在您的页面上，将一个添加`onunload`到`window`以下处理程序（伪javascript）：

    ```
    function myUnload(event) {
        if (window.localStorage) {
            // flag the page as being unloading
            window.localStorage['myUnloadEventFlag']=new Date().getTime();
        }

        // notify the server that we want to disconnect the user in a few seconds (I used 5 seconds)
        askServerToDisconnectUserInAFewSeconds(); // synchronous AJAX call
    } 
    ```

2.  在您的页面上，将 a 添加`onload`到`body`以下处理程序（伪 javascript）：

    ```
    function myLoad(event) {
        if (window.localStorage) {
            var t0 = Number(window.localStorage['myUnloadEventFlag']);
            if (isNaN(t0)) t0=0;
            var t1=new Date().getTime();
            var duration=t1-t0;
            if (duration<10*1000) {
                // less than 10 seconds since the previous Unload event => it's a browser reload (so cancel the disconnection request)
                askServerToCancelDisconnectionRequest(); // asynchronous AJAX call
            } else {
                // last unload event was for a tab/window close => do whatever you want (I do nothing here)
            }
        }
    } 
    ```

3.  在服务器上，收集列表中的断开连接请求并设置一个计时器线程，它会定期检查列表（我每 20 秒使用一次）。一旦断开请求超时（即 5 秒过去），断开用户与服务器的连接。如果同时接收到断线请求取消，则将对应的断线请求从列表中删除，使用户不会被断线。

如果您想区分选项卡/窗口关闭事件和跟随链接或提交的表单，此方法也适用。您只需将两个事件处理程序放在包含链接和表单的每个页面上以及每个链接/表单登录页面上。

请注意，我使用`unload`事件而不是`beforeUnload`事件来正确管理指向附件的链接：当用户单击指向附件（例如 PDF 文件）的链接时，将`beforeUnload`调度事件，然后引发打开/保存弹出窗口，并且仅此而已（浏览器不会更改显示的页面，也不会调度`unload`事件）。如果我正在使用该`beforeUnload`事件（就像我之前所做的那样），我会在没有页面更改时检测到页面更改。

这种方法仅限于支持 HTML5 本地存储的浏览器，因此您可能会为 MSIE7 等旧浏览器使用特定方法。

`event.clientY`其他基于例如 Alt-F4)。依赖事件 X 的位置也是不可靠的，因为按钮不是放在每个浏览器上的相同位置（例如左侧的关闭按钮）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-05T00:51:22.567

不幸的是，正如这里的一些答案所建议的那样，检查事件的`clientY`/`pageY`值并不是确定`unload`事件是否因用户关闭页面而被触发的可靠方法。

`clientY`当您单击浏览器的关闭按钮时/为负数的原因`pageY`是因为关闭按钮位于文档顶部上方（即像素 0 上方），但重新加载按钮也是如此，这意味着单击重新加载按钮也会导致负数`clientY`/的值`pageY`。

沿着检查事件的 x 坐标的路径下去也是有问题的，因为浏览器关闭按钮并不总是在窗口的右侧（例如，它在 OS X 的左侧）并且因为可以关闭窗口通过关闭其选项卡或通过键盘。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-08-18T23:05:44.000

也许有人还在寻找答案……

您可以为此使用**SessionStorage**！SessionStorage在页面**重新加载**但关闭时**不会被清除。**所以基本上你可以在页面加载时设置一个键/值对，但在此之前你检查键/值对是否存在。如果确实存在，则表示页面已重新加载，如果不存在，则表示用户第一次打开该页面或在新选项卡中打开。

 **```
if (sessionStorage.getItem('reloaded') != null) {
    console.log('page was reloaded');
} else {
    console.log('page was not reloaded');
}

sessionStorage.setItem('reloaded', 'yes'); 
```

这样您就可以`doStuff()`使用`onunload`事件（用户离开页面），并且`otherStuff()`如果设置了键/值对（用户重新加载页面）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-08-05T19:09:07.013

这是一个**巨大的 hack**，有一些限制，但它适用于大多数实际情况。

因此，如果您只需要在用户使用`ctrl`+`r`或`cmd`+`r`快捷方式时起作用的东西，您可以跟踪`r`在重新加载/关闭时需要执行的任何操作是否被按下。

只需创建切换变量`keydown`的`keyup`事件侦听器。`rDown`

```
let rDown = false;
window.addEventListener("keydown", event => {
    if (event.key == 'r')
        rDown = true;
})
window.addEventListener("keyup", event => {
    if (event.key == 'r')
        rDown = false;
}) 
```

然后你有你的“onunload”事件监听器，其中监听器函数有一个`if`检查 if `rDown`is的语句`true`。

```
window.addEventListener("onunload", () => {
    if (!rDown) {
        // code that only gets run when the window is closed (or
        // some psychopath reloads by actually clicking the icon)
    }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-12T08:46:53.807

今天我遇到了同样的问题，并找到了一个可能的解决方案，我想与大家分享。

在考虑什么可以帮助区分刷新和关闭时，我想到了 cookie。我记得在没有明确过期日期的情况下设置 cookie，使其仅可用于当前会话。在浏览器关闭之前，当前会话显然是有效的。这不包括关闭选项卡，但我的问题是关于用户身份验证，我不想仅仅因为关闭选项卡而注销用户（我认为这与`ASPXAUTH`ASP.NET 的 cookie 方法相同）。

因此，当用户登录并在页面加载时检查它时，我在集合中放置了一个简单的 cookie `document.cookies`：如果 cookie 仍然存在，则表示刷新或重新打开选项卡并保留用户数据，如果 cookie 不存在，则会话已过期，因此用户数据被清除（与显式注销相同）。

希望这种方法对其他人有用！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-03T12:57:28.983

为案例使用 window.onbeforeunload 事件以离开页面，但它将包括刷新或锚标记....使用相同的验证标志，该过程的 1 个示例是 URL 检查（初始 URL = 当前 URL ) 或 F5 检查使用 keycode 进行刷新，如果是锚标签，请使用 bind()

注意* 在 Chrome 的情况下，Keycode 可能会导致问题。

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>Test Page</title>

<style type='text/css'>
body {
    font-family: sans-serif;
}
</style>
<script src="jquery-1.9.1.js" type='text/javascript'></script>
<script type='text/javascript'>
var valid=false;
function wireUpEvents() {

if(valid){
alert("Page Refreshed or Redirected");
}else{

window.onbeforeunload = askWhetherToClose;

}
function askWhetherToClose(event) {

if(!valid){

    var msg;

    msg = "You're leaving the page, do you really want to?";
    event = event || window.event;
    event.returnValue = msg;
    return msg;
}}
$(document).bind('keypress', function(e) { 
 if (e.keyCode == 116){ 

 // or you can insert some code to check page refresh
 valid = true; 

//wireUpEvents();
 } 
 }); 
 $("a").bind("click", function() {
//To check redirection using Anchor tags  
 valid = true; 
 //wireUpEvents();
 }); 
 }
$(document).ready(function() { 
 wireUpEvents(); 

 });
</script>
</head>
<body>
<p>Close the browser window, or navigate to <a href="http://stackoverflow.com">StackOverflow</a></p>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-06T03:48:35.460

不幸的是，还没有建议或可靠的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-29T09:32:38.400

归功于[https://www.anandkanatt.com/how-do-i-detect-browser-window-closed-refreshed/#comment-15892](https://www.anandkanatt.com/how-do-i-detect-browser-window-closed-refreshed/#comment-15892)。我通过使用开瓶器本身进行检查来简化它。在 Chrome 版本 78.0.3887.7 中测试。

你可以试试这个：

*   添加一个 refresh-close-detector.html 文件。这是示例代码：

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Processing...</title>
</head>
<body>

<script>
  if (this.opener) {
    // the opener was refreshed, do something if you want
  } else {
    // the opener was closed, do something if you want
  }

  // you may want to close the pop up
  this.close()
</script>
</body>
</html> 
```

*   在要识别刷新和关闭浏览器操作的页面中，添加要卸载的事件侦听器：

```
window.addEventListener('unload', () => {
  open('refresh-close-detector.html', '', 'width=100,height=100');
}) 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-04-15T21:39:09.027

我刚刚尝试过，它解决了这个问题：创建一个 sessionStorage 对象，当用户关闭浏览器时该对象将被销毁。我们可以通过查看 sessionStorage 对象来判断用户是否关闭了浏览器或刷新了页面（页面刷新时 sessionStorage 对象不会被销毁）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-09-25T14:36:31.350

```
 $(window).bind('unload', function () {
        if (/Firefox[\/\s](\d+)/.test(navigator.userAgent) && new Number(RegExp.$1) >= 4) {
            console.log('firefox delete');
            var data = { async: false };
            endSession(data);
            return null;
        }
        else {
            console.log('NON-firefox delete');
            var data = { async: true };
            endSession(data);
            return null;
        }
    });

    function endSession(data) {
        var id = 0

        if (window) { // closeed
            id=1
        }

        $.ajax({
            url: '/api/commonAPI/'+id+'?Action=ForceEndSession',
            type: "get",
            data: {},
            async: data.async,
            success: function () {
                console.log('Forced End Session');
            }
        });
    } 
```

使用 if (window) 来确定是关闭还是重新加载。为我工作。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-06-28T10:35:57.260

它是一个有效的解决方案

```
export class BootstrapComponent implements OnInit {

  validNavigation = 0;

  constructor(
    private auth: AuthenticationService
  ) { }

  ngOnInit() {
    const self = this;
    self.registerDOMEvents();
  }

  registerDOMEvents() {
    const self = this;
    window.addEventListener('unload', () => {
      if (self.validNavigation === 0) {
        self.endSession();
      }
    });
    document.addEventListener('keydown', (e) => {
      const key = e.which || e.keyCode;
      if (key === 116) {
        self.validNavigation = 1;
      }
    });
  }

  endSession() {
    const self = this;
    self.auth.clearStorage();
  }
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-02-20T13:56:46.503

我早期的解决方案在 IE 中对我有用。window.event 对于 IE 以外的浏览器将是未定义的，因为与其他浏览器不同，“事件”在 IE 中是全局定义的。如果是其他浏览器，您需要提供事件作为参数。另外，没有为firefox定义clientX，我们应该使用pageX。

尝试这样的事情......应该适用于IE和Firefox这个......

```
<html>
<body>
<script type="text/javascript">

window.onunload = function(e) {
// Firefox || IE
e = e || window.event;

var y = e.pageY || e.clientY;

if(y < 0)  alert("Window closed");
else alert("Window refreshed");

}
</script>
</body>
</html> 
```

* * *

## 回答 #13

> 赞同：-10
> 
> 时间：2009-02-20T10:40:34.463

```
<html>
<body onunload="doUnload()">
<script>
   function doUnload(){
     if (window.event.clientX < 0 && window.event.clientY < 0){
       alert("Window closed");
     }
     else{
       alert("Window refreshed");
     }
   }
</script>
</body>
</html> 
```

# mysql - 一般mysql冻结

> ID：568984
> 
> 赞同：0
> 
> 时间：2009-02-20T10:08:59.203
> 
> 标签：mysql

我们的 MySQL 服务器的行为很奇怪 - 对一个表执行繁重的查询几乎会锁定它，不会响应其他查询，即使它是在完全不相关的表上的一个微不足道的查询（如`SELECT`通过主键，`INSERT`甚至`EXPLAIN`） - 它只会等待沉重的完成。

我真的不知道是什么原因导致的 - 有很多空闲线程，CPU 处于空闲/等待状态，网络空闲，内存充足......等等。

有人知道要寻找什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T16:02:31.960

MySQL有多少内存？我的猜测是它必须去磁盘获取临时表，这可能是致命的。您的 my.cnf/my.ini 文件中的 innodb_buffer_pool_size 有多大？通过增加它（这会增加内存使用），较小的查询（以及需要进行大量排序的查询）将不必命中磁盘。

下次查询开始对您执行此操作时，登录 MySQL，执行“显示完整进程列表”并记录那里的内容。如果您对运行缓慢的查询发出 EXPLAIN 或 DESCRIBE，它是什么？它是否包含将要进入临时表的注释？

当 MySQL 开始使用临时表时，感觉就像它们正在死去，尤其是在您没有快速磁盘的情况下。

# sql-server-2005 - 如何在 Xquery 中检测来自 xml 的数据字符串

> ID：568990
> 
> 赞同：3
> 
> 时间：2009-02-20T10:09:47.063
> 
> 标签：sql-server-2005, xquery

我在 Sql Server 数据库中有一个无类型的 XML 列，其中包含诸如

```
 1
 <root><a>123</a></root>
 <root>23d</root>
 23 
```

我正在尝试以下查询

```
declare @x xml
set @x='1'
select @x.exist('xs:int(.)') 
```

但这里的问题是存在函数将返回 1 即使`@x='<root><a>12</a></root>'`

在这种情况下，我希望输出为“0”。

有出路吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T11:24:09.727

如果 XQuery 表达式的计算结果为非空节点列表，则 .exist() 方法返回 1，否则返回 0。因此在您的示例中每次都会返回 1。

如果我理解正确，您希望它在值只是一个整数时返回 1，而在它是 XML 时返回 0？

在这种情况下，您需要执行以下操作：

```
declare @x xml
set @x='<root><a>12</a></root>'
select ISNUMERIC(CAST(@x.query('/') AS nvarchar)) 
```

这应该返回 0

```
declare @x xml
set @x='12'
select ISNUMERIC(CAST(@x.query('/') AS nvarchar)) 
```

这应该返回 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T11:29:46.640

XQuery 中的内置类型测试怎么样？

```
. instance of xs:integer 
```

如果上下文项是整数，将给您一个布尔值 true，否则为 false。

# php - 拆分包含的函数会提高 PHP 性能吗？

> ID：568991
> 
> 赞同：4
> 
> 时间：2009-02-20T10:09:58.703
> 
> 标签：php, performance, oop

我有主类的主 php 文件。同样在这个类中，我做 require_once("func.php"); 它对我的网站有很多有用的功能。

func.php 的大小非常大，因为**在不同的页面上有很多不同的操作**函数。但是我将它包含在每个页面上，因为包括由主类调用。我需要做什么来优化它？

将 func.php 重写为 OOP 并在主类中使用“$funcs->my_func()”之类的东西？我会赢得一些表演吗？未被调用的函数不会占用内存和CPU时间？

或者我必须将 func.php 重写为许多文件并在指定页面上调用每个文件？例如：对于“about.php”，我将包含所需功能的“about_func.php”。但是我觉得不太舒服...

请帮帮我:)对不起我的英语:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T10:21:06.537

1.  func.php 有多大？你确定尺寸有问题吗？
2.  这似乎是一个性能/优化问题。你确定优化是有保证的吗？您是否测量了页面的性能并证明包含这个大函数文件是其缓慢的罪魁祸首？

我建议您在继续之前先对自己回答 1 和 2。如果您提出问题的动机是更简洁的设计和模块化，那么是的，我同意将错误“utils”文件拆分为共享责任或一般相关领域的较小文件是一个好主意。另一方面，如果这是一个过早优化的情况，那么你最好留下糟糕的“func.php”（嘿，有时有一个大的通用 utils 文件是可以的，只要它不伤害你）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T10:23:24.567

拆分成oop类，使用PHP5的__autoload函数：[http ://www.php.net/manual/en/language.oop5.autoload.php](http://www.php.net/manual/en/language.oop5.autoload.php)

这只会在需要时加载类，您不必担心包含所有必需的文件。它不会给您带来任何性能优势，但是为了一个目的管理较小的文件比管理具有多个相互不依赖的功能的大文件更容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T10:35:40.230

您是否启用了 PHP 加速器？

*   [Zend 优化器](http://www.zend.com/en/products/guard/optimizer/)
*   [电子加速器](http://eaccelerator.net/)
*   [装甲运兵车](http://php.net/apc)

因为他们在内存中保留了 func.php 的“编译”版本，这应该可以加快速度，而无需修改任何代码。

虽然我推荐 OOP，但这并不是因为性能原因。

# java - 可以在 Java 中绘制 YCbCr 吗？

> ID：568994
> 
> 赞同：4
> 
> 时间：2009-02-20T10:11:05.173
> 
> 标签：java, video, colors, canvas, rgb

我目前有一个项目，使用 Java，它使用 YCbCr 颜色空间中固有的文件类型。其中，在幕后（我必须编写代码）发生了很多数字运算，以从 YCbCr 值转换为 RGB。这是按像素、每帧、每秒 25 帧完成的……

该项目必须完全用软件编写，并且必须独立于平台。

如果我可以跳过这一步，并且仍然从数组创建图像，但是采用 YCbCr 格式，我可以节省很多工作......

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T12:31:16.723

您可能可以使用[ColorSpace](http://java.sun.com/javase/6/docs/api/java/awt/color/package-frame.html)类来做到这一点。如果您需要单独转换每个 YCbCr 值，我会感到惊讶。我确信[java.awt.image](http://java.sun.com/javase/6/docs/api/java/awt/image/package-frame.html)包将提供用于处理此问题的类。您可能会在[Java Advanced Imaging](http://java.sun.com/products/java-media/jai/forDevelopers/jai1_0_1guide-unc/JAITOC.fm.html)的第 5 章中找到一些内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-20T12:43:39.427

基于 McDowell 的回答，[这](http://java.sun.com/products/java-media/jai/forDevelopers/jai1_0_1guide-unc/Color.doc.html#51551)似乎很有趣，它解释了如何进行色彩空间转换。

# php - 防御mysql注入和跨站点脚本的最佳方法

> ID：568995
> 
> 赞同：15
> 
> 时间：2009-02-20T10:11:36.497
> 
> 标签：php, sql, security, xss

目前，我采用“把所有东西都扔在墙上，看看有什么东西会粘住”的方法来阻止上述问题。以下是我拼凑的功能：

```
function madSafety($string)
{

$string = mysql_real_escape_string($string);
$string = stripslashes($string);
$string = strip_tags($string);
return $string;

} 
```

但是，我相信有更好的方法来做到这一点。我正在使用 FILTER_SANITIZE_STRING，这似乎并不完全安全。

我想我在问，你们采用了哪些方法，它们有多成功？谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-20T10:52:58.240

只是做很多你并不真正理解的事情，对你没有帮助。您需要了解什么是注入攻击，以及您应该如何以及在哪里做什么。

在要点中：

*   [禁用魔术引号](http://www.php.net/manual/en/security.magicquotes.disabling.php)。它们是一个不充分的解决方案，它们使事情变得混乱。
*   切勿将字符串直接嵌入 SQL 中。使用绑定参数，或转义（使用`mysql_real_escape_string`）。
*   **`stripslashes`当您从数据库中检索数据时，**不要**转义（例如）。**
***   当你在 html 中嵌入字符串时（例如当你`echo`），你应该默认转义字符串（使用`htmlentities`with `ENT_QUOTES`）。*   如果需要在 html 中嵌入 html-strings，则必须考虑字符串的来源。如果它不受信任，则应通过过滤器对其进行管道传输。`strip_tags`理论上是你应该使用的，但它有缺陷；请改用[HtmlPurifier](http://htmlpurifier.org/)。**

 **另请参阅：[使用 PHP 清理用户输入的最佳方法是什么？](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-20T10:21:00.627

对抗 SQL 注入的最好方法是绑定变量，而不是将它们“注入”到字符串中。 [http://www.php.net/manual/en/mysqli-stmt.bind-param.php](http://www.php.net/manual/en/mysqli-stmt.bind-param.php)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T10:16:23.833

**不要**！使用`mysql_real_escape_string`足以保护您免受 SQL 注入，而`stropslashes`您*之后*所做的事情会使您容易受到 SQL 注入的攻击。如果你真的想要它，把它放在*前面*：

```
function madSafety($string)
{
    $string = stripslashes($string);
    $string = strip_tags($string);
    $string = mysql_real_escape_string($string);
    return $string;
} 
```

`stripslashes`如果你在做`mysql_real_escape_string`.

`strip_tags`防止 HTML/XML 注入，而不是 SQL。

需要注意的重要一点是，您应该根据您对它的即时使用以*不同的方式转义您的字符串。*

当您执行 MYSQL 请求时，请使用`mysql_real_escape_string`. 当您输出网页时，请使用`htmlentities`. 要建立网络链接，请使用`urlencode`……</p>

正如 vartec 所指出的，如果您可以使用占位符，请务必这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-01T13:01:06.230

这个话题太不对劲了！

您不应该过滤用户的输入！这是他输入的信息。如果我希望我的密码是这样的，你会怎么做：`'"'>s3cr3t<script>alert()</script>`

过滤字符并让我更改密码，所以我什至无法在第一次登录时成功？这是不好的。

正确的解决方案是使用准备好的语句或`mysql_real_escape_string()`避免 sql 注入并使用上下文感知的字符转义来避免您的 html 代码被弄乱。

让我提醒您，网络只是您可以表示用户输入的信息的方式之一。如果某些桌面软件这样做，您会接受这样的剥离吗？我希望您的回答是否定的，并且您会理解为什么这不是正确的方法。

请注意，在不同的上下文中，必须转义不同的字符。例如，如果您需要将用户名显示为工具提示，您将使用如下内容：

```
<span title="{$user->firstName}">{$user->firstName}</span> 
```

但是，如果用户将他的名字设置为 like`'"><script>window.document.location.href="http://google.com"</script>`你会怎么做？去掉引号？这样就大错特错了！与其胡说八道，不如考虑在渲染数据时转义引号，而不是在持久化数据时！

您应该考虑的另一个上下文是在呈现值本身时。考虑之前使用的 html 代码，并想象用户名是`<textarea>`. 这会将后面的所有 html 代码包装到这个 textarea 元素中，从而分解整个页面。

再一次 - 考虑根据您使用它的上下文转义数据！

PS 不太确定如何对这些反对票作出反应。各位，你们真的在看我的回复吗？*************************