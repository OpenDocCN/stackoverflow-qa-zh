# StackOverflow 问答 000512000-000512999

# java - 要在 GWT 中使用 Gears WorkerPool，我必须用 Java 和 Javascript 编写相同的代码吗？

> ID：512002
> 
> 赞同：0
> 
> 时间：2009-02-04T16:03:08.433
> 
> 标签：java, javascript, gwt, google-gears

为了在 GWT/Gears 中使用 WorkerPool（Javascript 线程）类和功能，我是否需要同时使用 Java 和 Javascript 编写代码？在检查了[WorkerPool - Getting Started](http://code.google.com/docreader/#p=gwt-google-apis&s=gwt-google-apis&t=GearsGettingStartedWorkerPool)和 GWT-Gears-1.1 下载包中的示例 WorkerPool 应用程序后，我似乎需要这样做。似乎 Java 代码用于演示 Javascript 的同步特性，而 Javascript 中的相同算法用于异步调用。

我错过了什么吗？GWT 不是为了让您不必编写 Javascript 代码而创建的吗？为什么不能用 Java 编写 WorkerThread 代码并让编译器将其编译为 Javascript？

以下是该 url 中的相关 Java 代码：

```
 public void syncWorker(String message) {
// Busy wait for 5 seconds
long end = System.currentTimeMillis() + 5000;
while (true) {
  int busyCounter = 1000;
  String busyVar;
  while (busyCounter-- > 0) {
    busyVar = "garbage" + busyCounter;
  }
  long now = System.currentTimeMillis();
  if (now > end) {
    break;
  }
}
logMessage("Approved: " + message);
} 
```

这是 worker.js 中的相关 Javascript 代码（注意它是如何用 Javascript 编写的相同算法）：

```
function doWork(message) {
// Busy wait for 5 seconds
var start = new Date();
while (true) {
  var busyCounter = 10000;
  var busyVar;
  while (busyCounter-- > 0) {
    busyVar = "garbage" + busyCounter;
  }
  var now = new Date();
  if (now.getTime() - start.getTime() > 5000) {
    break;
  }
 }

 return "Approved: " + message;
 }; 
```

这是Java中的调用：

```
wp = Factory.getInstance().createWorkerPool();
wp.setMessageHandler(GearsWorkerPoolTutorial.this);
workerId = wp.createWorkerFromUrl("worker.js"); 
```

任何有 GWT 和 Gears 经验的人都可以对此有所了解吗？

谢谢！

编辑：

根据这个[http://markmail.org/message/gxipzth2jheccpha#query:+page:1+mid:sabv4llpymbavt7t+state:results](http://markmail.org/message/gxipzth2jheccpha#query:+page:1+mid:sabv4llpymbavt7t+state:results) ，我的怀疑似乎是正确的。我不确定我是否理解为什么存在这种限制。我很想阅读有关此事的任何见解。

编辑2：

这似乎也证实了这一点：[http ://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/658f6665e5b09bed](http://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/658f6665e5b09bed)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T00:08:31.587

我从未将 Gears 用于 GWT，但在阅读了您的证据后，我相信您说 WorkerPool 类只能运行 JavaScript 文件而不能运行 Java-compiled-to-JavaScript 是正确的。这是来自 GWT-Gears v1.1.1 WorkerPool API 的引用。

> WorkerPool 模块允许 Web 应用程序在后台运行 JavaScript 代码，而不会阻塞主页面的脚本执行。目前这个类只能从原始的 JavaScript 代码中创建工作线程。也就是说，用户代码当前无法从 Java 代码创建工作主体。

WorkerPool 类管理线程和通信，这是一项不小的任务。

# c# - C#（或 VB6）将 Word 文档转换为 Tiff

> ID：512006
> 
> 赞同：1
> 
> 时间：2009-02-04T16:03:53.050
> 
> 标签：c#, vb6, ms-word, tiff

我正在开发一个被一百多个用户使用的 VB6 应用程序。它生成一个 Word 文档，然后将该文档的 TIFF 图像保存在数据库中。目前，它只是将打印机设置为 Microsoft Office Document Image Writer，将文档“打印”到设置的位置，然后将生成的 TIFF 文件导入数据库。但是，该组织正在将每个人都升级到 Office 07，这意味着 Microsoft Office Document Image Writer 即将消失。所以，我想知道以编程方式从 Word 转换为 TIFF 有多难。
我们已经将 C# (.NET 3.5) 控件库作为 COM 引入，因此这似乎是放置功能的好地方。在某个时候，我会将整个应用程序转换为 3.5，所以我希望任何新代码都已经存在，这样可以转换的更少。

编辑：我很欣赏这些建议，但我真的很想在不使用昂贵的第三方组件的情况下尝试这样做。很难让有钱的人看到花费数千美元来修复曾经免费工作的东西的好处。另外，我真的对自己推出它所需要的东西很感兴趣。有点自虐，我知道，但我开始编程是因为我渴望知道事情是如何运作的...... :)

感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T16:47:51.310

As far as I know (and a quick google seems to confirm this), both the TIFF format and DOC binary format specifications are available for free on the web. Therefore, and this would be a fairly big and complex project (I'm thinking man months rather than man weeks), you could write code to read the DOC document and populate an object model. You could then write more code to then output the object model as a TIFF document.

But, just think of some of the complexities: Tables, formatting, character sets, spacing, embedded content, etc. Eek! I guess this is why it is normally the job of expensive third party libraries or professional document management systems.

Out of interest, might this be the time to move away from proprietary document formats and store the document in the DB as something more manageable?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-24T19:59:31.293

您可以使用 Microsoft Windows 提供的标准“传真”驱动程序以编程方式将 Word 文档转换为 TIFF。这项工作的关键是确保 OutputFileName 具有“.tiff”的扩展名这是示例代码（VB.net 和 Word 2010）：

```
Dim objWdDoc As Word.Document
Dim objWord As Word.Application
Dim sDesktop As String = Environment.GetEnvironmentVariable("userprofile") & "\Desktop\"

objWord = CreateObject("Word.Application")
objWdDoc = objWord.Documents.Open(sDesktop & "testdocument.doc")
objWord.Visible = True

'Select Printer
objWord.ActivePrinter = "Fax"
'Print to Tiff
objWdDoc.PrintOut(Range:=WdPrintOutRange.wdPrintAllDocument, _
                      OutputFileName:=sDesktop & "test.tiff", _
                      Item:=WdPrintOutItem.wdPrintDocumentContent, _
                      PrintToFile:=True)
'Close Document
objWdDoc.Close()
'Close Word
objWord.Quit()
'General Cleanup
objWdDoc = Nothing
objWord = Nothing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:06:14.763

试试[Aspose.Word](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)组件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T22:11:41.947

Microsoft Office Document Image Writer 在 Office 2007 中仍然可用（至少在 Enterprise 中）——它是一个可选组件。

# jquery - 为什么我的 jQuery 警报显示两次？

> ID：512010
> 
> 赞同：4
> 
> 时间：2009-02-04T16:04:36.327
> 
> 标签：jquery, list

我正在使用 jQuery。当警报列表的 ID 显示两次而不是一次时，我遇到了问题。

名单：

```
<ul id="testnav">
    <li> <a href="#">Page 1</a></li>
    <li> <a href="#">Page2..</a>
        <ul id="subnav">
            <li id="content_1"><a href="#"> Page3</a></li>
        </ul>
    </li>
</ul> 
```

编码：

```
$("li").click(function(){
    var current_id = $(this).attr('id');
    alert(current_id);
    // These alert two times, one is empty and another one is content_1
}); 
```

为什么要让代码警报两次？如何让它执行一次？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T16:11:41.350

$("li").click() 将点击事件应用于页面上的所有 LI。

当你点击

```
<li> <a href="#">Page2..</a>
     <ul id="subnav">
          <li id="content_1"><a href="#"> Page3</a></li>
     </ul>
</li> 
```

您实际上是在单击外部 LI 和最内部的 LI，这将导致事件触发两次。外层LI没有ID，所以是空的，内层LI的ID是“content_1”，所以显示出来。

那有意义吗？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-11T18:53:52.573

添加`event.stopImmediatePropagation();`到您的事件，然后它不会触发两次：

```
$("li").click(function(event)
{
       event.stopImmediatePropagation();
}); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-04T16:11:20.227

你有一个`<li>`嵌套在另一个里面`<li>`。

当您单击内部`<li>`时，您将获得内部`<li>`和外部的事件`<li>`

将您的 HTML 更改为以下内容，您将收到“Content_1”和“OUTER-LIST-ITEM”的警报，这可以更清楚地了解正在发生的事情......

```
<ul id="testnav">
    <li> <a href="#">Page 1</a></li>
    <li id="OUTER-LIST-ITEM">
        <a href="#">Page2..</a>
        <ul id="subnav">
            <li id="content_1"><a href="#"> Page3</a></li>
        </ul>
    </li>
</ul> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-04T16:10:44.160

您正在经历[事件冒泡](http://www.quirksmode.org/js/events_order.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-06T22:36:56.433

您应该使用防止事件冒泡 DOM 树。

以下代码将解决您的问题：

```
 $("li").click(function(event){ 
      var current_id=$(this).attr('id'); 
      alert(current_id);  
      event.stopPropagation();
    }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T16:11:48.120

因为 $("li") 返回一个所有匹配的对象。因此，当您单击一个，即 id=content_1 的那个时，您还单击了它没有 id 的父级。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T16:23:14.480

它会为每个 li 发出一次警报，并且您的链接是两个深度列表。要修复它，假设您只想触发子导航项，请将代码的第一行更改为

```
$("#subnav li").click(function(){ 
```

如果您需要更多列表，请创建一个类来标识要附加到单击事件的列表。

# jsp - 在 JSP 会话中存储页面代码

> ID：512011
> 
> 赞同：2
> 
> 时间：2009-02-04T16:05:17.760
> 
> 标签：jsp, session, navigation, preferences

我有一个选项菜单，在一个 jsp 页面上，用户可以在其中探索项目，有子项目，有子子项目等等。项目是可折叠的，因此用户可以看到他想要的项目的层次结构。

使用 javascript 和 jquery 操作 css 扩展菜单。

该菜单显示在应用程序的所有页面上，并且每次用户进入新页面时，该菜单必须显示为用户在前一页面中离开时的状态（用户展开的所有菜单项必须是记住了）。

他可以通过提交表单、点击链接或返回浏览器来更改页面。

怎么能这样？将菜单的 HTML 部分上传到会话是可行的解决方案吗？也许是饼干？还是有更好的方法？

PS：应用程序上也使用了struts2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:11:25.267

制作一些代表（Menu，MenuItem）的java类并将它们存储在服务器上的会话中。为每个菜单项分配一个唯一的整数 id，并在用户点击它时将此 id 提交给服务器。您可以使用 jsp 基于 java 类以当前状态呈现菜单。

# c - 为什么 C 没有无符号浮点数？

> ID：512022
> 
> 赞同：145
> 
> 时间：2009-02-04T16:06:58.770
> 
> 标签：c, types, floating-point, format, unsigned

我知道，这个问题似乎很奇怪。程序员有时想得太多。请继续阅读...

在 CI 中使用`signed`和`unsigned`整数很多。我喜欢这样一个事实，即如果我执行诸如将有符号整数分配给无符号变量之类的操作，编译器会警告我。如果我比较有符号整数和无符号整数等等，我会收到警告。

我喜欢这些警告。他们帮助我保持我的代码正确。

为什么我们对花车没有同样的奢侈？平方根绝对不会返回负数。还有其他地方负浮点值没有意义。无符号浮点数的完美候选者。

顺便说一句 - 我并不热衷于通过从浮点数中删除符号位可以获得的单个额外精度。我`float`对现在的 s 非常满意。我有时只想*将浮点数标记为无符号*，并得到与整数相同的警告。

我不知道任何支持无符号浮点数的编程语言。

知道为什么它们不存在吗？

* * *

## 编辑：

我知道 x87 FPU 没有处理无符号浮点数的指令。让我们只使用签名的浮点指令。滥用（例如低于零）可以被视为未定义的行为，就像未定义有符号整数的溢出一样。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-02-04T16:16:34.803

为什么 C++ 不支持无符号浮点数是因为没有等效的机器代码操作供 CPU 执行。所以支持它是非常低效的。

如果 C++ 确实支持它，那么您有时会使用无符号浮点数并且没有意识到您的性能刚刚被杀死。如果 C++ 支持它，则需要检查每个浮点运算以查看它是否已签名。而对于进行数百万次浮点运算的程序，这是不可接受的。

所以问题是为什么硬件实现者不支持它。我认为答案是最初没有定义无符号浮点标准。由于语言喜欢向后兼容，即使添加了语言也无法使用它。要查看浮点规范，您应该查看[IEEE 标准 754 Floating-Point](http://steve.hollasch.net/cgindex/coding/ieeefloat.html)。

您可以通过创建一个封装浮点或双精度的无符号浮点类来解决没有无符号浮点类型的问题，如果您尝试传入负数，则会引发警告。这效率较低，但如果您不频繁使用它们，您可能不会关心轻微的性能损失。

我绝对看到了无符号浮点数的用处。但是 C/C++ 倾向于选择对每个人都最有效的效率而不是安全性。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-05T01:14:36.917

C/C++ 中的有符号整数和无符号整数之间存在显着差异：

```
value >> shift 
```

有符号值保持最高位不变（符号扩展），无符号值清除最高位。

没有无符号浮点数的原因是，如果没有负值，您很快就会遇到各种问题。考虑一下：

```
float a = 2.0f, b = 10.0f, c;
c = a - b; 
```

c 有什么价值？-8。但这在没有负数的系统中意味着什么。FLOAT_MAX - 8 也许？实际上，由于精度效应，这不起作用，因为 FLOAT_MAX - 8 是 FLOAT_MAX，所以事情变得更加棘手。如果它是更复杂表达式的一部分怎么办：

```
float a = 2.0f, b = 10.0f, c = 20.0f, d = 3.14159f, e;
e = (a - b) / d + c; 
```

由于 2 的补码系统的性质，这对于整数来说不是问题。

还要考虑标准数学函数：sin、cos 和 tan 仅适用于其输入值的一半，您找不到值 < 1 的对数，您无法求解二次方程：x = (-b +/- root ( bb - 4.ac)) / 2.a，依此类推。事实上，它可能不适用于任何复杂的函数，因为这些函数往往被实现为多项式近似，它会在某处使用负值。

所以，无符号浮点数是非常没用的。

但这并不意味着范围检查浮点值的类没有用，您可能希望将值限制在给定范围内，例如 RGB 计算。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-04T16:24:12.463

（顺便说一句，Perl 6 允许您编写

```
subset Nonnegative::Float of Float where { $_ >= 0 }; 
```

然后你可以`Nonnegative::Float`像使用任何其他类型一样使用。）

无符号浮点运算没有硬件支持，因此 C 不提供它。C 主要被设计为“便携式组件”，即尽可能靠近金属而不被束缚在特定平台上。

[编辑]

C 就像汇编：所见即所得。一个隐含的“我会检查这个浮点数对你来说是非负的”违背了它的设计理念。如果你真的想要它，你可以添加`assert(x >= 0)`或类似的，但你必须明确地这样做。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-04T16:18:51.897

我相信创建 unsigned int 是因为需要比已签名 int 所能提供的更大的值余量。

浮点数的边距要大得多，因此对无符号浮点数从来没有“物理”需求。正如您在问题中指出的那样，额外的 1 位精度没什么可杀的。

**编辑：** 阅读[Brian R. Bondy 的答案](https://stackoverflow.com/questions/512022/why-doesnt-c-have-unsigned-floats/512071#512071)后，我必须修改我的答案：他绝对正确，底层 CPU 没有无符号浮点操作。但是，我坚持认为这是基于我上述原因的设计决定；-)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-04T16:27:06.747

我认为 Treb 走在正确的轨道上。对于具有无符号对应类型的整数来说更重要。这些是用于*位移*和*位图*中的那些。一个符号位刚刚进入。例如，右移一个负值，结果值是 C++ 中定义的实现。使用无符号整数或溢出这样的整数具有完美定义的语义，因为没有这样的位。

所以至少对于整数来说，对单独的无符号类型的需求比仅仅给出警告要强。浮动不需要考虑以上所有点。所以，我认为，对它们的硬件支持并不真正需要，而且 C 那时已经不支持它们了。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-04T16:31:59.687

> 平方根绝对不会返回负数。还有其他地方负浮点值没有意义。无符号浮点数的完美候选者。

C99 支持复数和 sqrt 的类型泛型形式，因此`sqrt( 1.0 * I)`将为负数。

* * *

评论者在上面强调了一点亮点，因为我指的是类型泛型`sqrt`宏而不是函数，它会通过将复数截断为其实部来返回标量浮点值：

```
#include <complex.h>
#include <tgmath.h>

int main () 
{
    complex double a = 1.0 + 1.0 * I;

    double f = sqrt(a);

    return 0;
} 
```

它还包含一个脑屁，因为任何复数的 sqrt 的实部都是正数或零，并且 sqrt(1.0*I) 是 sqrt(0.5) + sqrt(0.5)*I 而不是 -1.0。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-04T16:12:36.683

我想这取决于仅对 IEEE 浮点规范进行签名，并且大多数编程语言都使用它们。

[关于 IEEE-754 浮点数的维基百科文章](http://en.wikipedia.org/wiki/IEEE_754)

编辑：另外，正如其他人所指出的，大多数硬件不支持非负浮点数，因此由于有硬件支持，因此普通类型的浮点数更有效。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-04T17:51:20.493

我认为主要原因是与无符号整数相比，无符号浮点数的用途非常有限。我不相信这是因为硬件不支持它的论点。较旧的处理器根本没有浮点功能，它们都是在软件中模拟的。如果无符号浮点数有用，它们将首先在软件中实现，然后硬件也会效仿。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-06-01T21:20:47.980

C 中的无符号整数类型以遵循抽象代数环规则的方式定义。例如，对于任何值 X 和 Y，将 XY 添加到 Y 将产生 X。无符号整数类型保证在所有不涉及与任何其他数字类型 [或不同大小的无符号类型] 之间转换的情况下遵守这些规则，而这种保证是此类类型最重要的特征之一。在某些情况下，放弃表示负数的能力以换取只有无符号类型才能提供的额外保证是值得的。浮点类型，无论是否有符号，都不能遵守代数环的所有规则[例如，它们不能保证 X+YY 将等于 X]，而 IEEE 确实没有 甚至允许他们遵守等价类的规则[通过要求某些值与它们自己比较不相等]。我不认为“无符号”浮点类型可以遵守普通浮点类型不能遵守的任何公理，所以我不确定它会提供什么优势。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-02-27T17:03:32.953

IHMO 这是因为在硬件或软件中同时支持有符号和无符号浮点类型太麻烦了

对于整数类型，我们可以[在大多数情况下使用**相同**的逻辑单元进行*有符号和无符号整数运算*](https://stackoverflow.com/q/21475286/995714)，使用 2 的补码的好属性，因为[在这些情况下](https://stackoverflow.com/q/34377711/995714)，加法、减法、非扩展 mul 和大多数按位运算的结果是相同的。对于区分有符号和无符号版本的操作，我们仍然可以*共享大部分逻辑*。例如

*   算术和逻辑移位只需要对最高位的填充进行轻微更改
*   加宽乘法可以对主要部分使用相同的硬件，然后使用一些单独的逻辑来调整[结果以改变符号](https://stackoverflow.com/a/28827013/995714)。并不是说它用于实际乘数，但可以这样做
*   [有符号比较可以通过切换最高位或添加`INT_MIN`](https://stackoverflow.com/q/27527943/995714)轻松转换为无符号比较，反之亦然。理论上也是可能的，它可能不在硬件上使用，但在[仅支持一种比较类型](https://stackoverflow.com/a/54643085/995714)（如 8080 或 8051）的系统上很有用

使用 1 的补码的系统也只需要对逻辑进行一些修改，因为它只是将进位位包裹到最低有效位。不确定符号幅度系统，但似乎它们[在内部使用 1 的补码](https://en.wikipedia.org/wiki/Signed_number_representations#History)，所以同样适用

不幸的是**，我们对浮点类型并不那么奢侈。**通过简单地释放符号位，我们将获得无符号版本。但是那我们应该用那个位做什么呢？

*   通过将范围添加到指数来增加范围
*   通过将其添加到尾数来提高精度。这通常更有用，因为我们通常需要比范围更高的精度

但是这两种选择都需要一个**更大的加法器**来适应更广泛的价值范围。这增加了逻辑的复杂性，而加法器的最高位大部分时间都没有使用。乘法、除法或其他复杂运算将需要更多电路

在使用软件浮点的系统上，每个函数都需要 2 个版本，这在内存非常昂贵的时候是意料之中的，或者你必须找到一些“棘手”的方法来共享部分有符号和无符号函数

但是[浮点硬件早在 C 发明之前就已经存在了](https://en.wikipedia.org/wiki/Floating-point_arithmetic#History)，所以我认为选择 C ​​是由于我上面提到的原因缺乏硬件支持

也就是说，存在几种*专门*的无符号浮点格式，主要用于图像处理，如[Khronos 集团的 10 位和 11 位浮点类型](https://www.khronos.org/registry/DataFormat/specs/1.2/dataformat.1.2.html#11bitfp)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-09-01T22:16:58.357

> 我不知道任何支持无符号浮点数的编程语言。知道为什么它们不存在吗？

存在无符号浮点数。参见`unsigned float16`GPU 硬件的（11 个小数位，5 个指数位，0 个符号位），[HDR 格式 DXGI_FORMAT_BC6H](http://docs.microsoft.com/en-us/windows/win32/direct3d11/bc6h-format)。只是它们在大多数计算硬件中并不常见，以至于主流编程语言都忽略了它们。在这种用法中，符号被省略，因为比黑色深的颜色无论如何都没有意义。

即使是更常见的[IEEE half](https://en.wikipedia.org/wiki/Half-precision_floating-point_format) or signed `float16_t`，它在图形和机器学习领域非常频繁地用于 HDR 图像和较低带宽的张量，也没有获得被纳入 C/C++ 的荣誉（尽管，更多的领域- CUDA/HLSL 等特定语言确实有`half`/ `float16_t`，并且也有[C++ 提议](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1468r1.html)）。因此，即使`signed float16`不能在编译器特定扩展（例如[gcc __fp16](https://gcc.gnu.org/onlinedocs/gcc/Half-Precision.html)）之外进入 C++，那么 an`unsigned float16`就没有什么希望了：b，甚至 CUDA 或 HLSL*在语言中都没有无符号类型*，就在纹理定义本身（在 .DDS 文件或 GPU 纹理内存中）。[在那之前，我们将不得不通过帮助库](http://half.sourceforge.net/)在没有编译器帮助的情况下继续实现更多奇特的类型。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T16:13:18.460

我怀疑这是因为 C 编译器所针对的底层处理器没有处理无符号浮点数的好方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-23T07:10:18.250

好问题。

如果，如您所说，它仅用于编译时警告并且它们的行为没有改变，否则底层硬件不会受到影响，因此它只会是 C++/编译器的更改。

我以前也有同样的想法，但问题是：这没有多大帮助。编译器充其量只能找到静态分配。

```
unsigned float uf { 0 };
uf = -1f; 
```

或极简主义更长

```
unsigned float uf { 0 };
float f { 2 };
uf -= f; 
```

但仅此而已。使用无符号整数类型，您还可以获得定义的环绕，即它的行为类似于模算术。

```
unsigned char uc { 0 };
uc -= 1; 
```

在这个“uc”之后，它的值是 255。

现在，在给定无符号浮点类型的情况下，编译器会如何处理相同的场景？如果在编译时不知道这些值，则需要生成首先执行计算然后进行符号检查的代码。但是，当这种计算的结果是“-5.5”时——应该将哪个值存储在声明为无符号的浮点数中？可以尝试像整数类型那样的模算术，但这有其自身的问题：最大值无疑是无穷大......那不起作用，你不能有“无穷大 - 1”。追求它可以保持的最大不同值也不会真正起作用，因为你会遇到它的精确度。“NaN”将是一个候选人。

最后，这不会是定点数的问题，因为模数是明确定义的。

# php - 在 Linux 上从 PHP 连接到 MS SQL Server

> ID：512024
> 
> 赞同：2
> 
> 时间：2009-02-04T16:07:06.133
> 
> 标签：php, sql-server, redhat, freetds

我需要从在 Red Hat Enterprise Linux 4 上运行的 PHP 连接到 Windows 上的 MS SQL Server。我已经安装了 FreeTDS，我可以使用 tsql 命令连接到数据库。

我当前的 PHP 没有 mssql 函数/扩展。

我的问题是，如何在不重建 PHP 的情况下设置 mssql 扩展？是否有为此预先构建的软件包？我试过用谷歌搜索，但我没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T17:19:35.347

如果您使用的是 RHEL 4.x 附带的 PHP 库存版本，您可以安装 php-odbc 模块。FreeTDS 提供了一个 ODBC 接口。您应该能够一起使用这些将 PHP 连接到 MSSQL 服务器。

也就是说，我建议重建 PHP，以便您可以访问 mssql 扩展。与以这种方式使用 ODBC 相比，这应该会带来更好的性能和可靠性。

（对于它的价值，RHEL 5.x 有一个 php-mssql RPM，您可以安装。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:51:37.917

如果不重新构建 PHP，就无法设置 mssql 扩展来工作。PHP Group 旨在提供可互操作且独立的代码。MS SQL 和 Sybase 都需要 freetds，它不是也不应该是 PHP 包的一部分。为自定义包维护 rpm 或 deb 将再次成为一种痛苦。因此，您必须手动构建它。

# c# - 显示 Windows 字符映射小程序？

> ID：512031
> 
> 赞同：0
> 
> 时间：2009-02-04T16:08:55.333
> 
> 标签：c#, .net, windows, shellexecute

从我的 .NET (C#) 应用程序中显示 Windows 字符映射小程序的最佳方式是什么？我知道它是一个可选组件，所以如果他们没有安装它，我想向用户显示一条消息。

我试过使用

```
ShellExecute( 0, "OPEN", "charmap.exe", "", "", 0 ); 
```

但所发生的只是我的应用程序失去焦点并且字符图没有打开。作为测试，我尝试了“calc.exe”，它可以正常工作，就像在“运行”对话框中使用“charmap.exe”一样。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:23:53.853

怎么样`Process.Start("charmap.exe")`，如果没有安装就捕获异常？

```
try
{
    Process.Start("charmap.exe");
}
catch (Win32Exception e)
{
    // show message
} 
```

# delphi - Delphi 2009：将 TList<[any interface]> 与默认比较器一起使用是否可能很危险？

> ID：512035
> 
> 赞同：3
> 
> 时间：2009-02-04T16:10:09.480
> 
> 标签：delphi, generics, com, delphi-2009, interface

我想知道使用泛型`TList<T>`where `T`is any interface type (除了`IUnknown`/ `IInterface`) 是否可能是危险的。我大量使用接口并将它们存储在列表中。有些接口是我自己的，有些是由一些COM接口提供的，所以涉及到COM。

我看到了一个潜在的问题，即检查实例是否相等，例如，当我使用`Remove`列表的方法时（内部需要将我提供的值与包含的值进行比较）。根据 COM 规则，您只能在将两个接口转换为`IUnknown`. 我不知道在 中查找我的接口所涉及的默认比较器`TList<T>`是否知道这一点。

用一个例子来说明我的问题：

```
var
  list:TList<IMyInterface>;
  intf:IMyInterface;
begin
  ...
  list:=TList<IMyInterface>.Create;
  list.Add(intf);
  ...
  list.Remove(intf);
end; 
```

上面的代码合法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T15:11:31.693

除非接口通过 QueryInterface() 降级为 IUnknown，否则这可能会成为您的问题，因为它可能不遵守 COM 规则。

tkInterface 的默认 IComparer 和 IEqualityComparer 只是将指针值作为四字节整数进行比较（因此，在 QueryInterface 上完成了返回聚合的操作）。在 Generics.Defaults 中查找 tkInterface 以查看。

您可以通过在构建列表时提供 IComparer 或 IEqualityComparer 自己来避免此问题。

我不相信将泛型与接口一起使用会产生任何引用计数问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T21:10:52.227

TInterfaceList 类型对你有用吗？

这是专门为使用接口列表而设计的。

# python - 为什么 PyRun_String 不评估布尔文字？

> ID：512036
> 
> 赞同：5
> 
> 时间：2009-02-04T16:10:14.787
> 
> 标签：python, boolean, cpython

我需要从 C++ 评估 Python 表达式。这段代码似乎工作：

```
PyObject * dict = PyDict_New();
PyObject * val = PyRun_String(expression, Py_eval_input, dict, 0);
Py_DECREF(dict); 
```

不幸的是，如果表达式是“假”的“真”（即 val 为 0 并且 PyErr_Occurred() 返回真），它会严重失败。我究竟做错了什么？他们不应该分别评估 Py_True 和 Py_False 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T19:07:32.540

```
PyObject* PyRun_String(const char *str, int start, PyObject *globals, PyObject *locals); 
```

如果你想要 True 和 False，它们必须在`*globals`传递给解释器的 dict 中。你也许可以通过调用来解决这个问题`PyEval_GetBuiltins`。

从 Python 2.6 源代码：

```
if (PyDict_GetItemString(globals, "__builtins__") == NULL) {
    if (PyDict_SetItemString(globals, "__builtins__",
                 PyEval_GetBuiltins()) != 0)
        return NULL;
} 
```

如果这不起作用，您可以`PyRun_String("import __builtin__ as __builtins__", globals, locals)`在调用`PyRun_String("True", ...)`.

您可能会注意到 Python 交互式解释器总是在`__main__`我们没有费心在此处创建的模块中运行代码。我不知道你是否需要一个`__main__`模块，除了有很多脚本包含`if __name__ == "__main__"`.

# authentication - 开始将 ADFS 与 AzMan 集成的好方法是什么？

> ID：512040
> 
> 赞同：5
> 
> 时间：2009-02-04T16:10:36.720
> 
> 标签：authentication, active-directory, authorization, federated-identity, adfs

有谁知道有关 Active Directory 联合身份验证服务 (ADFS) 与授权管理器 (AzMan) 集成的任何好的截屏视频或文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T08:24:56.577

我会推荐很多链接，截屏视频始终是入门的好方法：

***第 9 频道截屏视频***：

*阿兹曼*

[揭秘系列：AzMan 入门](http://channel9.msdn.com/posts/donovanf/Demystified-Series-Getting-Started-with-AzMan/)

[揭秘系列：编程 AzMan](http://channel9.msdn.com/posts/donovanf/Demystified-Series-Programming-AzMan/)

[揭秘系列：企业中的 AzMan](http://channel9.msdn.com/posts/donovanf/Demystified-Series-AzMan-in-the-Enterprise/)

[揭秘系列：Windows Server 代号“Longhorn”和 Windows Vista 上的 AzMan](http://channel9.msdn.com/posts/donovanf/Demystified-Series-AzMan-on-Windows-Server-Code-Name-Longhorn-and-Windows-Vista/)

*ADFS*

[Active Directory 联合身份验证服务 (AD FS) 第 1 部分，作者：Keith Brown](http://channel9.msdn.com/posts/donovanf/Demystified-Series-Active-Directory-Federation-Services-AD-FS-Part-1/)

[Active Directory 联合服务 (AD FS) 第 2 部分，作者 Keith Brown](http://channel9.msdn.com/posts/donovanf/Demystified-Series-Active-Directory-Federation-Services-AD-FS-Part-2/)

***文档/文章***

[使用 Windows 授权管理器开发应用程序的白皮书](http://msdn.microsoft.com/en-us/library/aa480244.aspx)

[有关在中间层 .NET 应用程序中使用基于角色的安全性的 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc300469.aspx)

[使用授权管理器的多层应用程序的基于角色的访问控制](http://technet.microsoft.com/en-us/library/cc780256.aspx)

[使用 Windows Server 2003 授权管理器的基于角色的访问控制](http://msdn.microsoft.com/en-us/library/ms952386.aspx)

[安全应用程序块](http://msdn.microsoft.com/en-us/library/aa480465.aspx)

***博客***

[ADFS 文档博客](http://blogs.technet.com/adfs_documentation/default.aspx)

[ADFS 产品支持博客](http://blogs.technet.com/adfs/)

[身份和访问博客（.NET 开发人员的资源）](http://blogs.msdn.com/donovanf/default.aspx)

[安全简报（Keith Brown 的博客）](http://www.pluralsight.com/community/blogs/keith/default.aspx)

[授权经理团队博客](http://blogs.msdn.com/azman/)

[联邦识别博客](http://identity-des.com/)

[T4 Toolbox：强类型 AzMan 包装器生成器](http://www.olegsych.com/2008/12/t4-toolbox-strongly-typed-azman-wrapper-generator/)

现在这可能已经足够了，希望这些链接中的一些将有助于您了解 AzMan 以及它的基于角色的访问控制 (RBAC) 功能如何在 ADFS 使用的基于声明的编程模型中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T22:14:17.600

一直在阿兹曼路上，我建议你看看这个： [链接文本](http://netsqlazman.codeplex.com/)

要做任何通过 MS AZMan 角色检查的事情，您最终都必须进行 COM 调用。另外，另一个是开源的，这使得扩展 ADFS 变得更加容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T06:37:27.097

我的建议是避免使用 AzMan 并转至 ADFS v2，即“日内瓦”。
或者您可以使用[.NET 访问控制服务。](http://www.microsoft.com/azure/accesscontrol.mspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T07:33:34.187

一个很好的起点是[this](http://msdn.microsoft.com/en-us/magazine/cc300469.aspx)。

# asp.net - 什么可能导致 IIS 接收 HTTP 动词“2GET”

> ID：512042
> 
> 赞同：7
> 
> 时间：2009-02-04T16:10:46.563
> 
> 标签：asp.net, http, http-status-code-405

我有一个用户在单击我的应用程序中的链接时间歇性地收到 HTTP 405。据我所知，链接没有什么好笑的......

```
<a id="ctl00_ctlNavigationMenu_viewTransfersLink" href="Navigate.ashx?target=6">- View Transfers</a> 
```

正如我所说，大多数情况下链接都会成功执行。但是，用户偶尔会遇到：

> 405 - 不允许用于访问此页面的 HTTP 动词。

当我检查 IIS 日志时，我可以看到以下条目：

```
2009-02-04 15:12:50 192.168.202.204 2GET /Navigate.ashx target=6 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 13203 
```

这似乎是在报告用户的浏览器已使用动词**2GET**提交了请求。怎么会这样？

查看我们测试服务器上的日志，我可以看到这个问题的其他一些实例：

```
2008-11-06 13:30:10 192.168.202.204 2GET /Content/Css/origo_advanced_horiz.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 109
2008-11-06 13:31:44 192.168.202.204 2GET /Content/Css/origo_advanced_horiz.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 62
2008-11-06 13:37:20 192.168.202.204 2GET /Content/Css/datepicker.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 109
2008-11-06 14:06:00 192.168.202.204 2GET /Content/Css/origo_advanced_horiz.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 125
2008-11-06 16:30:42 192.168.202.204 2GET /Content/Css/origo_advanced_horiz.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 406
2008-11-07 11:01:07 192.168.202.204 2GET /Content/Css/origo_advanced_horiz.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 406
2008-11-10 11:27:31 192.168.202.204 2GET /Content/Css/origo_advanced_horiz.css - 80 - 192.168.202.190 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322) 405 0 1 46
2009-02-03 12:00:38 192.168.202.204 2GET /Navigate.ashx target=6 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 13438
2009-02-03 12:00:49 192.168.202.204 2GET /Navigate.ashx target=6 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 1593
2009-02-04 15:12:50 192.168.202.204 2GET /Navigate.ashx target=6 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 13203 
```

我们在 IIS7 上运行。

有任何想法吗？2GET 作为动词存在吗？它可以与我表单上的 UpdatePanel 相关吗？

沙

更新：我得到了各种奇怪的动词：2GET、9GET、1POST、5POST ......

```
2009-02-04 15:12:50 192.168.202.204 2GET /Navigate.ashx target=6 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 13203
2009-02-04 15:28:12 192.168.202.204 1POST /Transfer/View.aspx - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 3171
2009-02-04 15:28:28 192.168.202.204 5POST /Transfer/View.aspx - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 2515
2009-02-04 15:34:21 192.168.202.204 5POST /Transfer/View.aspx - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 1828
2009-02-04 15:44:52 192.168.202.204 2GET /Transfer/View.aspx - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 5390
2009-02-04 16:15:23 192.168.202.204 2POST /Transfer/View.aspx - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 7781
2009-02-04 16:16:04 192.168.202.204 2GET /Navigate.ashx target=3 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 44938
2009-02-04 16:16:09 192.168.202.204 2GET /Navigate.ashx target=3 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 45876
2009-02-04 16:16:27 192.168.202.204 2GET /Content/Css/reset.css - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 4687
2009-02-04 16:16:52 192.168.202.204 9GET /Transfer/View.aspx - 80 - 192.168.202.141 Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1;+.NET+CLR+1.1.4322;+InfoPath.2;+.NET+CLR+2.0.50727) 405 0 1 5468 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T16:39:48.907

This request is malformed GET request is coming from the browser side. And you can pinpoint error to IP 192.168.202.204\.

It is not IIS or your server, it is not network card (TCP has error correction).

It can be that browser is buggy or that there is some proxy / firewall on that box that interceps http trafic. Could be the virus too. But, as I see, it's on the client side.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T18:16:34.733

如果您有权访问客户端计算机，请在其上运行 Wireshark 以捕获流向您的服务器的流量。您还应该在服务器上运行 Wireshark 并过滤来自该 IP 地址的流量，以排除 IIS 中的问题（不太可能。）

了解线路上发生了什么可以帮助您缩小问题所在的范围。最有可能的是，您会看到靠近浏览器的流量看起来还不错，并且在到达服务器的途中被某些东西破坏了，但至少您可以缩小可能的嫌疑人的较小列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:42:10.807

Very odd indeed.

*   Is this only occurring from one computer?
*   Are these requests coming directly from the user's computer, via a proxy, or perhaps via ISA Server?
*   Is it an option to install [IEHttpHeaders](http://www.blunck.se/iehttpheaders/iehttpheaders.html) onto the problem browser and monitor the HTTP headers from that end?

# javascript - 使用 jQuery CSS 属性设置背景图像

> ID：512054
> 
> 赞同：405
> 
> 时间：2009-02-04T16:12:19.337
> 
> 标签：javascript, jquery, css

我在变量中有一个图像 URL，`imageUrl`我正在尝试使用 jQuery 将其设置为 CSS 样式：

```
$('myObject').css('background-image', imageUrl); 
```

这似乎不起作用，因为：

```
console.log($('myObject').css('background-image')); 
```

返回`none`。

任何想法，我做错了什么？

* * *

## 回答 #1

> 赞同：971
> 
> 时间：2009-02-04T16:15:26.927

你可能想要这个（让它像一个普通的 CSS 背景图像声明）：

```
$('myObject').css('background-image', 'url(' + imageUrl + ')'); 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2011-03-10T17:07:52.920

您需要在 imageUrl 之前和之后包含双引号 (")，如下所示：

```
$('myOjbect').css('background-image', 'url("' + imageUrl + '")'); 
```

这样，如果图像有空格，它仍然会被设置为属性。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2011-07-02T18:16:48.943

除了其他人正确建议的内容之外，我发现切换 CSS 类而不是单独的 CSS 设置（尤其是背景图像 URL）通常更容易。例如：

```
// in CSS 
.bg1 
{
  background-image: url(/some/image/url/here.jpg);
}

.bg2 
{
  background-image: url(/another/image/url/there.jpg);
}

// in JS
// based on value of imageUrl, determine what class to remove and what class to add.
$('myOjbect').removeClass('bg1').addClass('bg2'); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-07-02T18:10:53.603

这是我的代码：

```
$('body').css('background-image', 'url("/apo/1.jpg")');
```

享受吧，朋友

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-02-27T15:37:50.343

除了其他答案，您还可以使用“背景”。当您要设置与背景使用图像的方式相关的其他属性时，这特别有用，例如：

```
$("myObject").css("background", "transparent url('"+imageURL+"') no-repeat right top"); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-01T00:36:36.000

对于那些使用实际 URL 而不是变量的人：

```
$('myObject').css('background-image', 'url(../../example/url.html)'); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2019-07-12T16:42:10.723

`;`我遇到的问题是，我一直在值的末尾添加一个分号`url()`，这阻止了代码工作。

❌***不工作代码：***

```
$('#image_element').css('background-image', 'url(http://example.com/img.jpg)**;**');
//--------------------------------------------------------------------------^
```

✅**工作代码：**

```
$('#image_element').css('background-image', 'url(http://example.com/img.jpg)'); 
```

`;`请注意工作代码末尾省略的分号。我只是不知道正确的语法，而且很难注意到它。希望这可以帮助同一条船上的其他人。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-05-29T02:37:59.580

尝试修改“样式”属性：

```
$('myObject').attr('style', 'background-image: url("' + imageUrl +'")'); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-02-18T01:47:14.430

字符串插值救援。

```
let imageUrl = 'imageurl.png';
$('myOjbect').css('background-image', `url(${imageUrl})`); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-01T11:54:54.847

不要忘记 jQuery css 函数允许传递对象，这允许您同时设置多个项目。回答的代码将如下所示：

`$(this).css({'background-image':'url(' + imageUrl + ')'})`

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2017-08-02T23:28:27.457

```
$('myObject').css({'background-image': 'url(imgUrl)',});
```

# unix - Unix路径结构的含义

> ID：512063
> 
> 赞同：1
> 
> 时间：2009-02-04T16:14:39.363
> 
> 标签：unix, path, suse, rhel

有没有人参考过各种路径名称在不同风格的 Unix 上的含义？如果可能，请在列表中包括 Solaris、RHEL 和 SLES。

例如，从我收集到的 /lib 是发行版的标准库，它永远不会改变（这是正确的吗？或者他们会不时获得新版本？），/usr/local 用于由系统管理员安装的应用程序等。但我不确定这是否正确，我仍然不清楚 /usr/lib 和 /lib （前者用于 sysadmin 安装的库？）和 /sbin 和 /bin 等之间的区别......谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T16:18:11.417

所有这些都是直接从[kdubois.net](http://kdubois.net/?p=25)复制的。去投票那个网站。

**/home** - 这是包含特定于一个用户的信息的所有目录和文件所在的位置。系统的每个用户都应该被授予 /home 中与该用户名匹配的目录。每个用户的配置文件中通常包含您定期处理的所有文件，您的文档、媒体和设置都最好放在 /home/$USERNAME 目录中。

**/etc** — 这是系统通常存储系统配置文件的地方。网络设置、图形 X 服务器以及许多其他系统功能都位于此文件夹中。看看里面。您的图形 X 服务器将其所有配置保存在 X11/ 目录中。文件 mtab 存储 cron 设置。如果您在 Debian 系统上，配置 apt 的文件位于 apt/ 目录中。此文件夹中有大量其他系统设置，因此如果可以，请尝试了解它们。弄乱 /etc 目录中的任何内容时要小心！

**/启动**— 此文件夹包含启动计算机所需的内容。它至少包含一个引导加载程序，如 GRUB 或 LILO（引导时弹出的菜单，允许您选择操作系统）和内核映像。通常，这里也包括初始 ramdisk。我更习惯于 GRUB，所以我将深入探讨使用 grub 的 /boot 目录是如何工作的。启动时，系统会查看 /boot/grub/menu.lst 以尝试确定如何启动您想要用于此会话的任何系统。在 menu.lst 中，有关于应该使用什么内核引导映像以及应该使用什么初始 ramdisk 的规范。然后，GRUB 会接受它所获知的系统信息，然后将内核跳转到引导状态。除非你搞乱了引导选项，否则你可能不会经常处理 /boot，但它是 Linux 系统的关键部分，

**/bin** — 这包含系统范围的基本二进制可执行文件。此处包含用于解压缩文件或导航目录等基本工具。例如，'cd'、'ls'、'ip'、'cat' 和其他通用的基本 linux 标准的程序都包含在这里。

**/mnt**和**/media** — 根据您使用的系统，这两个文件夹是您将挂载 / 文件系统以外的文件系统的位置。查看 Ubuntu（我通常在笔记本电脑上写博客的发行版），无论何时插入 USB 记忆棒、CD 或新硬盘驱动器，它都会挂载在 /media 目录下。

**/dev**— 这包含系统的所有设备节点。内核检测到的任何硬件都被放置在这里作为入口。在现代 Linux 系统中，此文件夹主要由 Udev 管理，这有助于自动配置和填充此目录。强烈建议强行删除此目录中的任何内容。:-D。这个文件夹对于判断您刚刚编译的驱动程序是否正在运行以及查看您的系统所认为的硬件非常有用。例如，hd1、hd2 等是 PATA 硬盘，sd1、sd2 等是 SCSI 驱动器，ram 是系统内存，video0 通常是某种电视调谐器。严格来说，/dev 中的每一项都不是系统的物理组件，但大多数都是。每个设备都被视为一个文件。这个概念对于资深的开源人员来说很熟悉，但对于 Windows 的新转换者来说是一个奇怪的概念。这消除了巨大的抽象层次，使写入图形卡与编写学期论文一样。内核处理使设备按其应有的方式处理数据所需的实际步骤。巧妙的小技巧由此产生。例如，我可以 cat /dev/video0（我的 Hauppauge 电视调谐器）并使用单个命令录制电视节目。(cat /dev/video0 > show.mpg)。尊重开发目录！:-D

**/lost+found** — 当一个 EXT 文件系统出现问题时，任何孤立或有问题的文件都会放在这里。希望您永远不必考虑这个文件夹。:-)

**/sbin** - “系统二进制文件”的串联，此文件夹通常包含更高级别的系统实用程序，例如用于网络配置的 ifconfig。/bin 和 /sbin 中的内容之间的界限对我来说总是有点模糊，但 sbin 实用程序似乎总是执行更高级的功能，例如用于获取 DHCP IP 地址的 dhclient 或用于格式化磁盘的 mkfs。

**/root** — 这是超级用户（root 用户）的主文件夹。就那么简单。

**/tmp——**你可能猜到了，这个文件夹包含临时文件。如果 Mozilla Firefox 需要缓存您当前的下载，它可以将部分文件存储在 /tmp 中，直到完成下载，然后将其从 /tmp 复制到您选择的下载位置。好的程序在使用完 /tmp 后会自行清理它，但它的内容会在重新启动时自动删除，所以不要担心这个文件夹会随着时间的推移而膨胀，直到它导致性能问题。

**/lib** — 这包含所有系统库。往里看，你会发现一堆*.so*文件。这些是其他程序运行所需的库。如果您对此感到好奇，请输入“ldd /bin/echo”（echo 是一个用于输出文本的简单实用程序）。您的系统将返回 echo 链接到的库，即 ld-linux.so.2 和 libc.so.6 和 linux-gate.so.1。ldd 适用于任何程序。修改系统库的名称会破坏您的系统。当程序需要访问位于库中的关键组件时，它们将不知道去哪里寻找。几乎所有内容都与 libc.so.6 和 ld-linux.so.2 相关联，因此重命名它是破坏系统的可靠方法。您不必过于担心系统库，因为包管理器在保持一切井井有条方面做得很好。但是，编译代码或帮助开发 linux，您可能会在这里或那里遇到库问题，所以要小心！

**/srv** — 很多时候，此文件夹在 Web 服务器上用于包含可通过 Internet 访问的信息。

**/proc** — 这是一个您可能不应该乱搞的关键任务文件夹。内核使用它来组织进程（运行程序，或多或少）的信息。

**/opt** - 可选。很多时候，系统管理员会使用此文件夹来安装您想要轻松手动删除的程序。例如，在我这里基于 gnome 的系统上，我将 KDE 的库安装到 /opt，这样我就可以轻松地删除整个文件夹。编译软件时，默认安装会将库、二进制文件和配置文件分散在目录中，因此通过告诉安装程序将所有内容放在 /opt 中，您仍然可以安装程序，但可以将其留在可以删除的地方全部一起。

**/var** — 此文件夹包含包含系统状态信息的重要文件。例如，图形服务器的错误日志包含在此文件夹中

**/usr**— 可能是 / 中我最喜欢的文件夹。通常，更多面向用户而不是让系统运行的程序安装在 /usr 中。GNOME 或 KDE 通常安装在此文件夹中，您会在此处找到许多您在日常使用中启动的程序（如 Firefox、Evolution 或 Gedit）。下降到 /usr，你会发现一堆文件夹，就像你在 / 中看到的那样。这样做的原因是程序可以安装到类似根目录的文件夹集（如安装程序所期望的那样），而实际上不会用过多的文件弄乱 / 目录。系统的链接器知道在 /lib 和 /usr/lib 中查找，因此任何安装到 /usr/lib 中的库都可以像 /lib 中的库一样容易地找到。同样地，/usr/bin 中的二进制文件与 /bin 一样容易找到，因为系统知道在两个路径中查找。/usr/local 包含另一个根目录！这与 /usr 中的 root like 文件夹的原因相同，但旨在供系统管理员安装更多永久程序（通常是他个人编译的程序）。这样做的原因可能看起来有点模糊或武断，但如果您开始尝试组织系统或开发新软件，它们实际上非常有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T16:20:59.087

大多数 Linux 发行版都遵循[文件系统层次标准 FHS](http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard)（至少大部分情况下）。其中很大一部分只是适用于 UNIX 相当长一段时间的规则（`/usr`, `/var`, ...），其他则相当新（`/media`, ...）。

我最初发现令人困惑的一件事是两者的存在，`/bin`以及，`/usr/bin`以及看似随机分布的东西去哪里。这种拆分背后的原因是，它可能从与根目录不同的存储（可能是远程）安装，因此应该包含一个最小系统，足以在某些系统故障的情况下启动并运行整个系统。`/lib``/usr/lib``/usr``/bin``/lib`

因此 Gnome、GIMP 等可以进入`/usr`，因为它们不是必需的，但文件系统工具（如`fsck`和`mkfs`shell `sh`）需要驻留在非`usr`目录中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T16:28:26.760

在 Mac OS X 上，被`/home`替换为.`/Users``/mnt``/Volumes`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-24T16:55:59.080

只是添加一些上面没有提到的东西：

```
/home — user home directories, e.g.
          /home/bob
          /home/mary
          etc. 
```

有时有用的用户有一个`~/etc`和`~/bin` 太。（当然取决于用户）

`/etc`— 配置文件、启动脚本。一些（旧的）Unix 版本在这里卡住了一些二进制文件，所以我认为历史上从来没有对内容进行过任何严格的强制执行。如今，这意味着“配置文件”。

`/mnt`- 一个可以挂载更多文件系统的地方

`/sbin`— 系统二进制文件或服务器二进制文件、守护进程可能需要超级用户才能运行（而不是 /bin ）

`/root`— root 的主目录。我见过的一个 Unix 版本将 root 的主目录作为 / 并且只是分散在那里的东西。这更干净:)

# asp.net - 无法将“X”类型的对象转换为“X”类型 - ASP.NET

> ID：512064
> 
> 赞同：5
> 
> 时间：2009-02-04T16:14:49.690
> 
> 标签：asp.net, visual-studio, .net-3.5, web

我目前正在使用 Visual Studio 2008 中的 ASP.NET 网站项目，每次我对用户控件的代码隐藏页面进行更改并浏览到使用用户控件的页面时，我都会收到以下错误：

> 无法将“ASP.basepage_master”类型的对象转换为“ASP.basepage_master”类型。

我必须重建我的整个解决方案才能解决此错误。有没有其他人遇到过这个错误，他们知道如何解决吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T16:44:36.290

删除您的临时 ASP.NET 文件（C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 中的所有内容）会使它消失......一段时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T04:47:14.600

这是有道理的，据我了解。

您正在更改代码隐藏。为了使这些更改生效，您需要构建该项目，以便可以将代码隐藏编译到该项目的 DLL 文件中。当您更改代码隐藏并且不构建项目时，您实际上拥有该页面的两个版本，而 ASP.Net 无法解析这两个版本。因此，当您编译该类时，更改将被协调到 DLL 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T15:25:54.397

如果我在本地工作站上停止并重新启动 IIS，我能够解决此问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-19T07:24:38.357

尤里卡！！明白了...这个有效...

当您拖放用户控件或通过该`LoadControl`方法加载它时，请在其路径中使用“波浪号”。例如`this.LoadControl("~/MyUserControl.ascx");`

这同样适用于放置在页面上的控件。将波浪号添加到 aspx 页面中用户控件的声明性路径。

我们可以将其称为 VS2005 中的错误，并在 VS 2008 中修复。

如果这不起作用或需要更多解释，请回复我。或者，不要忘记将此标记为答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-12T14:36:12.940

这篇博文很好地描述了这个问题：

[http://professionalaspnet.com/archive/2007/04/09/Unable-to-cast-object-of-type-_2700_ASP.masterpage_5F00_master_2700_-to-type-_2700_ASP.masterpage_5F00_master_27002E00_.aspx](http://professionalaspnet.com/archive/2007/04/09/Unable-to-cast-object-of-type-_2700_ASP.masterpage_5F00_master_2700_-to-type-_2700_ASP.masterpage_5F00_master_27002E00_.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-07T15:56:34.897

我遇到了同样的问题，我终于能够建立网站。

我必须为 ASP.NET 项目创建另一个具有不同名称的母版页，将原始内容复制并粘贴到新的母版页中，使我的所有子窗体都从新母版页继承，并删除旧的母版页.

该网站现在将运行。我不知道调试器是如何混淆并开始使用不存在的缓存对象的。我尽一切努力让它释放该缓存（删除下`C:\%USER%\AppData\Local`和下的临时文件`C:\Windows\Microsoft.NET`，重命名母版页，重命名主类，更改文件以强制它们重新加载，重建解决方案，添加`web.config`选项`<compilation batch="false" debug="false"/>`）除了删除母版页。

删除母版页为我修复了它，但我不明白为什么我必须这样做。

这是我挣扎的线索：

[https://forums.asp.net/t/2172428.aspx](https://forums.asp.net/t/2172428.aspx)

# asp.net - ASP.NET 2.0 的最佳免费富文本框？

> ID：512068
> 
> 赞同：3
> 
> 时间：2009-02-04T16:15:27.647
> 
> 标签：asp.net, .net-2.0, richtextbox

与 ASP.NET 2.0 一起使用的最佳富文本框是什么？

我需要允许用户（非技术人员）使用简单的样式来格式化他们自己的电子邮件，但它需要在他们键入时显示，而不是带有预览的标记语言。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T16:21:24.390

[http://tinymce.moxiecode.com/](http://tinymce.moxiecode.com/)没有问题，并且也有一些不错的功能。它是用 javascript 编写的，就像[http://www.fckeditor.net/](http://www.fckeditor.net/)

[http://tinymce.moxiecode.com](http://tinymce.moxiecode.com)在 chrome 中工作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T16:18:14.783

试试这个：

[http://freetextbox.com/](http://freetextbox.com/)

我唯一的抱怨是它在 Chrome 中不起作用（但会优雅地降级）。无论如何，我希望很快能解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T08:00:11.000

我会投赞成票

[http://www.fckeditor.net/](http://www.fckeditor.net/)

尽管它是一个“几乎是顽皮”的名字，但它是一个很棒的富文本框并且非常易于使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T16:18:05.580

我刚刚开始使用[WYMeditor](http://www.wymeditor.org/ "WYMeditor")，到目前为止看起来还不错。

# javascript - 动态添加链接样式表

> ID：512070
> 
> 赞同：17
> 
> 时间：2009-02-04T16:16:23.010
> 
> 标签：javascript, internet-explorer, dom, crash

如何将链接样式表引用添加到文档的开头？

我找到了这段代码，但它不适用于所有浏览器，它使我的 IE7 崩溃：

```
var ss = document.createElement("link");
ss.type = "text/css";
ss.rel = "stylesheet";
ss.href = "style.css";
document.getElementsByTagName("head")[0].appendChild(ss); 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T16:26:39.730

Internet Explorer 将支持 innerHTML，尽管它添加了回流，这将起作用：

```
var headHTML = document.getElementsByTagName('head')[0].innerHTML;
headHTML    += '<link type="text/css" rel="stylesheet" href="style.css">';
document.getElementsByTagName('head')[0].innerHTML = headHTML; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T16:24:09.423

在 IE 中，你可以试试 createStyleSheet 方法吗？这需要 URL 作为参数。我不知道 FF/chrome 中是否有等价物..

——森提尔

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2009-02-05T10:04:10.670

那是一个简单的交叉引用 javascript 错误。祝你今天过得愉快。

# mfc - 如何知道控件何时将被隐藏

> ID：512073
> 
> 赞同：0
> 
> 时间：2009-02-04T16:17:22.650
> 
> 标签：mfc, controls, cwnd

我有一个从 CWnd 对象派生的控件，该对象具有其自定义实现的工具提示系统。工具提示是使用 CDialog 实现的并且工作正常，但我有一个问题要知道何时必须隐藏它。

工具提示在鼠标悬停在控件上时显示 (WM_MOUSEHOVER)，在鼠标离开控件时隐藏 (WM_MOUSELEAVE)。到现在为止还挺好。问题是设置控件的对话框可以从菜单中隐藏（不破坏它可以从菜单中再次显示）。发生这种情况时，不会将 WM_MOUSELEAVE 事件发送到控件并且不会删除工具提示...它会出现在新对话框上。

我的问题是：有没有办法知道控件被隐藏了？我知道我可以为设置控件的对话框捕获 WM_SHOWWINDOW 消息，但我想从控件本身执行此操作，因此我可以在其他地方使用控件而无需添加额外的代码。

提前致谢！

哈维尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T16:30:07.850

通常，如果您有一个需要将对话框消息转发给它的自定义控件，您可以使用子类化。类似于以下内容

```
BOOL CMyDialog::OnInitDialog() 
{
    m_MyCtrl.SubclassDlgItem(IDC_MY_CTRL_ID,this);
    CMyDialog::OnInitDialog();
    return TRUE;
} 
```

然后您可以处理来自您的控件的对话框消息，例如

```
BEGIN_MESSAGE_MAP(CMyCtrl, CWnd)
    //{{AFX_MSG_MAP(CMyCtrl)
    ON_WM_SHOWWINDOW()
    //}}AFX_MSG_MAP
END_MESSAGE_MAP()

void CMyCtrl::OnShowWindow(BOOL bShow,UINT nStatus ) 
{
.
.
} 
```

您仍然需要在小范围内修改主机对话框代码以使用该控件，但您的控件是可重用的。

# asp.net - 没有 Microsoft Ajax JavaScript 的 CompositeScript

> ID：512074
> 
> 赞同：4
> 
> 时间：2009-02-04T16:17:53.990
> 
> 标签：asp.net, asp.net-ajax, scriptmanager, microsoft-ajax

我目前正在使用 System.Web.Extensions 的 CompositeScript 功能来组合我的 JavaScript 文件以减少下载时间。但是，通过包含任何脚本管理器，MicrosoftAjax JavaScript 代码将包含在我的页面中。我不希望这种情况发生，因为它添加了很多不需要的代码并且使事件处理复杂化。

我正在寻找以下内容之一：

1.  组合 JavaScript 文件的 Microsoft Script Manager 的替代方案，不包括 MicrosoftAjax，但仍允许用户控件将脚本添加到复合脚本中。
2.  一种说服 Microsoft 脚本管理器不发出任何我未指定的 JavaScript 的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T19:55:46.577

试试这个： [http ://weblogs.asp.net/bleroy/archive/2008/07/07/using-scriptmanager-with-other-frameworks.aspx](http://weblogs.asp.net/bleroy/archive/2008/07/07/using-scriptmanager-with-other-frameworks.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:33:51.260

它基本上只是一个带有一些格式化功能的静态字符串构建器类，如果没有办法阻止它发出 ajax 框架脚本，编写自己的脚本管理器类应该不会太难。

# javascript - 在创建后修改 YUI RTE 工具栏

> ID：512081
> 
> 赞同：0
> 
> 时间：2009-02-04T16:18:57.827
> 
> 标签：javascript, yui, rte

我处于无法控制一个或多个[YUI 富文本编辑器](http://developer.yahoo.com/yui/editor/)的创建的情况；它是在别人的图书馆里完成的。

出于本次讨论的目的：

*   修补代码——猴子或其他——不是一种选择。
*   删除 ( `editor.destroy()`) 已经存在的编辑器并添加我自己的编辑器也不是一种选择。创建编辑器的代码对其做了*其他事情*并引用了参考等——我需要**修改当前的编辑器**。

我所说的创造是指：

```
var myEditor = new YAHOO.widget.Editor(control, {
  // toolbar config would go here if I controled this code
});

myEditor.render(); 
```

问题是我希望这些编辑器具有与他们所拥有的不同的工具栏配置。确切地说，我想删除一堆按钮（[默认](http://developer.yahoo.com/yui/examples/editor/toolbar_editor.html)有点臃肿）。

我设法用该[`EditorInfo`](http://developer.yahoo.com/yui/docs/YAHOO.widget.EditorInfo.html)工具获得了编辑器，但我真的无法用它做任何事情。编辑器上[显然](http://developer.yahoo.com/yui/docs/YAHOO.widget.SimpleEditor.html#property_toolbar)有一个变量可以让您获取[`Toolbar`](http://developer.yahoo.com/yui/docs/YAHOO.widget.Toolbar.html)实例，但是当我尝试它时，我得到的只是`null`.

那么，**有没有办法在`render()`调用删除工具栏按钮后修改 YUI 富文本编辑器？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T23:45:58.157

由于我看不到代码，所以很难给出答案。但是，一旦您可以访问 Editor 实例，工具栏属性应该可以让您完全访问 addButton/detroyButton 方法。

```
var editor = YAHOO.widget.EditorInfo._instances['editor_id'];
editor.toolbar.destroyButton('bold'); //This should destroy the bold button 
```

该代码应该可以工作。如果 editor.toolbar 为 null，则您可能在创建工具栏之前访问它。你可以试试这个：

```
editor.on('toolbarLoaded', function() {
  this.toolbar.destroyButton('bold');
}); 
```

同样，在不查看代码或访问（Firebug）页面的情况下进行调试有点困难。

[我不使用这个网站，所以你可能想在官方YUI 邮件列表](http://tech.groups.yahoo.com/group/ydn-javascript/)上提问，以便其他人也可以学习；）

# sql-server - 如何解决 VSTS DB 项目中的 4 部分名称链接服务器查询错误？

> ID：512083
> 
> 赞同：1
> 
> 时间：2009-02-04T16:19:36.857
> 
> 标签：sql-server, visual-studio-2008, linked-server

我正在使用安装了开发人员和数据库版本的 VSTS 2008。我安装了 DB 版 GDR（版本 9.0.31124）。我们在代码中有几个地方引用了链接服务器（DB2 大型机、iSeries 和 SQL Server）。一个这样的例子是我们在存储过程中的这段代码：

```
SELECT VendorID   
INTO     #tmpVendors   
FROM    DataWhse.BIDataWhse.BP.Vendors   
WHERE  EffectiveDate < DATEADD(day, -1, DATEADD(month, 1, CAST(LTRIM(RTRIM(CAST(@Month AS CHAR(2)))) + '/01/' + CAST(@YEAR AS CHAR(4)) AS DATETIME)))   
AND     ExpirationDate > CAST(LTRIM(RTRIM(CAST(@Month AS CHAR(2)))) + '/01/' + CAST(@YEAR AS CHAR(4)) AS DATETIME) 
```

我在此类代码上遇到未解决的参考错误 (TSD03006)。当前关于如何处理此类链接服务器引用的建议是什么？在本例中，我们正在处理另一个 SQL Server 2005 实例。我们链接的数据库有大量我们永远不会使用的表。所以，如果可能的话，我想避免不得不为该数据库拉下整个模式。

我搜索时找到的信息似乎已过时。GDR 在过去一年中发生了很大变化，以前的 CTP 版本提供了很多指导，现在已经过时了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T13:33:20.993

我终于解决了这个问题。我创建了一个名为 BIDataWhse 的数据库项目，添加了 bp 模式，添加了 bp 用户，并添加了 bp.vendors 表定义。然后编译该项目并添加对我遇到错误的项目的数据库引用。在参考中，我为服务器和数据库指定了变量并允许变量替换。结果代码是：

```
SELECT VendorID      
INTO     #tmpVendors      
FROM    [$(DataWhse)].[$(BIDataWhse)].BP.Vendors      
WHERE  EffectiveDate < DATEADD(day, -1, DATEADD(month, 1, CAST(LTRIM(RTRIM(CAST(@Month AS CHAR(2)))) + '/01/' + CAST(@YEAR AS CHAR(4)) AS DATETIME)))      
AND     ExpirationDate > CAST(LTRIM(RTRIM(CAST(@Month AS CHAR(2)))) + '/01/' + CAST(@YEAR AS CHAR(4)) AS DATETIME) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-09T18:57:47.367

为了扩展这种情况，添加数据库引用将为您完成大部分工作。您需要为链接数据库创建项目并从数据库中导入 db 模式（或者如果您不想做整个数据库，则为您需要的表导入脚本）。“在参考中，我为服务器和数据库指定了变量并允许变量替换” - 这意味着在 Add DB Ref 对话框中，您可以检查 Define Server Variable、Define Database Variable 和 Update Schema Objects and Scripts。输入变量的名称（它将用 $(..) 包围它们）并输入要替换的值（生成部署脚本时要插入的真实服务器/数据库名称）。更新选项将导致它通过您的项目并编辑所有脚本以将服务器/数据库名称替换为变量。凉爽的。

# javascript - 通过 JavaScript 检查浏览器标签？

> ID：512087
> 
> 赞同：2
> 
> 时间：2009-02-04T16:21:19.163
> 
> 标签：javascript, browser, webbrowser-control

我可以通过 IE7/FF/Opera 中的浏览器选项卡检查 JavaScript 的主机页面是否处于活动状态？

但是，检查除此 JS 运行的页面之外的其他选项卡可能会带来安全风险..

我的另一个选择是我记得的原型方法，用于检查鼠标光标是否处于活动状态，但它并不准确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T16:28:40.303

您可以将`onBlur`和`onFocus`事件附加到`window`; 这会告诉你是否有焦点。我已经对此进行了测试，并且可以正常工作。您无法查看其他页面，但您绝对可以查看自己的页面。

# sql - 错误处理 CLR 例程

> ID：512089
> 
> 赞同：0
> 
> 时间：2009-02-04T16:21:40.317
> 
> 标签：sql, sql-server, sqlclr

如何从 SQL CLR 例程中引发 SQL Server 错误事件（类似于 RAISERROR）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T19:01:44.237

理论上，基于我从我们的一位开发人员那里获得的代码示例：

```
try
{
    response = service.ProcessThisInfo(info);
}
catch (Exception ex)
{
      returnCode = Convert.ToInt32(ErrorEnum.SomeError);
      string msg = string.Format("RAISERROR('{0}',16,1)", ex.Message.Replace('\'', ' '));
      SqlCommand cmd = new SqlCommand(msg, connection);
      try
      {
            SqlContext.Pipe.ExecuteAndSend(cmd);
      }
      catch { } // stop duplicate exception throwing...
} 
```

[在实践中，也许不是](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=251376)这是 sql 2005 中的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T21:23:26.183

我认为如果你尝试这个，你只会得到一个令人讨厌的错误。MSDN 上的 SqlContext.Pipe.ExecuteAndSend(cmd) 有一个有趣的示例[http://msdn.microsoft.com/en-us/library/ms255336(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms255336(VS.80).aspx)它不经过修改就无法工作，如果您将其更改为发送 raiserror，它会变成 dolally 并向您发送 NET 异常。你不能用函数来做到这一点。

就最初的问题而言，我想说它（从 CLR 函数中引发 SQL Server 错误）在 SQL Server 2005 中是不可能的，但可以通过 CLR 过程来完成。

# asp.net - ASP.net：在标题上实现元刷新时奇怪的 url 参数

> ID：512090
> 
> 赞同：0
> 
> 时间：2009-02-04T16:21:46.573
> 
> 标签：asp.net

我试图在[本文中实现 Rick 通过标题添加元刷新](http://www.west-wind.com/Weblog/posts/6841.aspx)

出于某种原因，我的网址看起来像这样

[http://localhost/pickweb/(S(hp5mypqznxgquf45vzz4fi55))/Login.aspx](http://localhost/pickweb/(S(hp5mypqznxgquf45vzz4fi55))/Login.aspx)

我的网址中的“（S（hp5mypqznxgquf45vzz4fi55））”是什么？即使我删除了 Rick 博客中的代码，它仍然有那个奇怪的参数。

我实现了 Rick 的代码

```
Response.AppendHeader("Refresh", "4; url=profile.aspx"); 
```

在我的母版页中。

杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T18:16:11.037

看起来您正在使用无 cookie 会话：

[http://msdn.microsoft.com/en-us/library/aa479314.aspx](http://msdn.microsoft.com/en-us/library/aa479314.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:25:30.013

嗯...我想我知道它是从哪里来的。我认为这是因为我的 web.config 在 InProc 中设置了会话。这可能是该参数来自的原因。

# flash - 一个 Flash 电影重新加载/倒带/刷新另一个的最简单方法是什么？

> ID：512093
> 
> 赞同：1
> 
> 时间：2009-02-04T16:22:59.410
> 
> 标签：flash, actionscript-3

我有一个包含两部 Flash 电影的页面。当一个（内容应用程序）达到特定状态（即用户现在已登录）时，我想完全刷新另一个（菜单）以反映用户会话的新整体状态（即用户已登录在，所以现在包括一个“注销”项目）。状态实际上是保存在服务器端的，所以不需要详细的通信，只是某种通用的“更新自己”命令。

似乎我可以通过设置 LocalConnection 并将命令从第一部电影发送到第二部电影来做到这一点，但这似乎有点矫枉过正。

有没有更简单的方法让第一部电影重新加载/刷新/倒带第二部电影？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T21:57:57.533

LocalConnection，尤其是当您在页面上下文中使用两个 SWF 运行时，实际上听起来是一种相当简单的方法。另一种方法是使用 ExternalInterface 将 SWF 与 JavaScript 连接在一起，但这可能比实现 LocalConnection 更复杂且更容易出错，而且安全性也可能更低，具体取决于应用程序的详细信息。

除了通过 LocalConnection 或 ExternalInterface 直接相互发送消息外，唯一想到的其他选项将涉及第二个 SWF（菜单）的某种轮询——轮询浏览器会话/cookie 值（以及相应地更新其状态）、轮询某个 JavaScript 变量的更改、轮询 SharedObject 值等。

实际上，现在我想起来了，[**SharedObject**](http://livedocs.adobe.com/flex/3/langref/index.html?flash/net/SharedObject.html&flash/net/class-list.html)在这种情况下实际上可能是一个好方法。我没有亲自使用过它，所以我没有任何代码可以分享，但从文档中看起来它非常适合该任务，并且可能比 LocalConnection 或 ExternalInterface 更合适，因为它减少了两个 SWF紧密耦合。

# c# - c#一个表单在winform项目中阻塞另一个表单

> ID：512097
> 
> 赞同：0
> 
> 时间：2009-02-04T16:23:24.807
> 
> 标签：c#, winforms, forms, blocking

我有一个使用 2 个表单的应用程序，一个主表单和一个启动表单，用于以下配置：

```
public class MainForm : Form
{
    public MainForm()
    {
       SplashScreen splash = new SplashScreen();

       // configure Splash Screen
    }
}

public class SplashScreen
{
    public SplashScreen()
    {
       InitializeComponent();

       // perform initialization

       this.ShowDialog();
       this.BringToFront();
    }
} 
```

注意：主窗体是使用以下代码创建的：

```
Application.Run( new MainForm() ); 
```

上面的问题是splash的配置不会发生，除非splash被关闭了

```
splash.Close(); 
```

只有当这种情况发生时，MainForm 构造函数的其余部分才会运行。我怎样才能轻松阻止这种阻塞行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:29:59.597

通常，您需要在单独的线程上显示启动画面，并让主线程继续加载。不是微不足道的 - 特别是，您需要使用`Control.Invoke`来要求启动屏幕在准备好时自行关闭（线程关联）......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T16:33:02.587

我已经用一个关于你问同样问题的另一个问题的工作示例回复了你：

[C# winforms 启动（Splash）表单不隐藏](https://stackoverflow.com/questions/510765/510786#510786)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:29:44.620

使用 splash.Open() 而不是 splash.OpenDialog() 这不会发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T16:31:28.690

基本上，您只想向您展示启动表单，而不是让它阻塞主表单。

这是我的做法：

```
class MainForm : Form {

    SplashScreen splash = new SplashScreen();  //Make your splash screen member

    public MainForm()
    {
        splash.Show();  //Just show the form
    }

} 
```

然后在您的 MainForm_Load 中，您照常进行初始化。

现在，当您的表单准备好显示时（MainForm_Shown）：

```
public MainForm_Shown()
{
    splash.Close();
} 
```

这让您的 MainForm 在显示初始屏幕时正常加载。

# sql - 在 Reporting Services 中为单个参数传递多个值

> ID：512105
> 
> 赞同：70
> 
> 时间：2009-02-04T16:24:50.247
> 
> 标签：sql, reporting-services, parameters, query-string

我的报告中有几个多选参数。我正在尝试找到一种方法来为 Web 查询字符串中的单个参数传递多个值？如果我传入一个值，它工作正常。

该报告运行良好，为单个参数选择多个选项。我的麻烦在于网络查询字符串。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-02-06T08:42:32.313

尽管 John Sansom 的解决方案有效，但还有另一种方法可以做到这一点，而不必使用可能效率低下的标量值 UDF。在 SSRS 报告中，在查询定义的参数选项卡上，将参数值设置为

```
=join(Parameters!<your param name>.Value,",") 
```

在您的查询中，您可以像这样引用该值：

```
where yourColumn in (@<your param name>) 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-18T22:54:39.387

这是我在将多选参数传递给另一个多选参数时使用的。

```
=SPLIT(JOIN(Parameters!<your param name>.Value,","),",") 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-04T17:08:43.497

这是 SQL Reporting Services 中支持较差的功能之一。

您需要做的是将所有选定的项目作为单个字符串传递给您的存储过程。字符串中的每个元素都将用逗号分隔。

然后我要做的是使用将提供的字符串作为表返回的函数来拆分字符串。见下文。

```
ALTER FUNCTION [dbo].[fn_MVParam]
   (@RepParam nvarchar(4000), @Delim char(1)= ',')
RETURNS @Values TABLE (Param nvarchar(4000))AS
  BEGIN
  DECLARE @chrind INT
  DECLARE @Piece nvarchar(100)
  SELECT @chrind = 1 
  WHILE @chrind > 0
    BEGIN
      SELECT @chrind = CHARINDEX(@Delim,@RepParam)
      IF @chrind  > 0
        SELECT @Piece = LEFT(@RepParam,@chrind - 1)
      ELSE
        SELECT @Piece = @RepParam
      INSERT  @Values(Param) VALUES(CAST(@Piece AS VARCHAR))
      SELECT @RepParam = RIGHT(@RepParam,LEN(@RepParam) - @chrind)
      IF LEN(@RepParam) = 0 BREAK
    END
  RETURN
  END 
```

然后，您可以在主查询的 where 子句中引用结果，如下所示：

```
where someColumn IN(SELECT Param FROM dbo.fn_MVParam(@sParameterString,',')) 
```

我希望你发现这个解决方案很有用。请随时提出您可能有的任何问题。

干杯，约翰

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-03-26T13:00:37.027

John Sansom 和 Ed Harper 有很好的解决方案。但是，在处理 ID 字段（即整数）时，我无法让它们工作。我修改了下面的拆分函数，将值转换为整数，以便表将与主键列连接。我还注释了代码并添加了一个顺序列，以防分隔列表顺序很重要。

```
CREATE FUNCTION [dbo].[fn_SplitInt]
(
    @List       nvarchar(4000),
    @Delimiter  char(1)= ','
)
RETURNS @Values TABLE
(
    Position int IDENTITY PRIMARY KEY,
    Number int
)

AS

  BEGIN

  -- set up working variables
  DECLARE @Index INT
  DECLARE @ItemValue nvarchar(100)
  SELECT @Index = 1 

  -- iterate until we have no more characters to work with
  WHILE @Index > 0

    BEGIN

      -- find first delimiter
      SELECT @Index = CHARINDEX(@Delimiter,@List)

      -- extract the item value
      IF @Index  > 0     -- if found, take the value left of the delimiter
        SELECT @ItemValue = LEFT(@List,@Index - 1)
      ELSE               -- if none, take the remainder as the last value
        SELECT @ItemValue = @List

      -- insert the value into our new table
      INSERT INTO @Values (Number) VALUES (CAST(@ItemValue AS int))

      -- remove the found item from the working list
      SELECT @List = RIGHT(@List,LEN(@List) - @Index)

      -- if list is empty, we are done
      IF LEN(@List) = 0 BREAK

    END

  RETURN

  END 
```

如前所述使用此功能：

```
WHERE id IN (SELECT Number FROM dbo.fn_SplitInt(@sParameterString,',')) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-11-02T22:21:35.640

甲骨文：

“IN”短语（Ed 的解决方案）不适用于 Oracle 连接（至少版本 10）。但是，发现了这个简单的解决方法。使用数据集的参数选项卡将多值参数转换为 CSV：

```
 :name =join(Parameters!name.Value,",") 
```

然后在你的 SQL 语句的 WHERE 子句中使用 instring 函数来检查匹配。

```
 INSTR(:name, TABLE.FILENAME) > 0 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-04-19T19:08:25.237

我遇到了另一个很棒的 fn_MVParam 的问题。SSRS 2005 发送的数据带有撇号作为 2 个引号。

我添加了一行来解决这个问题。

```
select @RepParam = replace(@RepParam,'''''','''') 
```

我的 fn 版本也使用 varchar 而不是 nvarchar。

```
CREATE FUNCTION [dbo].[fn_MVParam]
   (
    @RepParam varchar(MAX),
    @Delim char(1)= ','
   )
RETURNS @Values TABLE (Param varchar(MAX)) AS
/*
  Usage:  Use this in your report SP 
     where ID in (SELECT Param FROM fn_MVParam(@PlanIDList,','))
*/

BEGIN

   select @RepParam = replace(@RepParam,'''''','''')
   DECLARE @chrind INT
   DECLARE @Piece varchar(MAX)
   SELECT @chrind = 1
   WHILE @chrind > 0
      BEGIN
         SELECT @chrind = CHARINDEX(@Delim,@RepParam)
         IF @chrind > 0
            SELECT @Piece = LEFT(@RepParam,@chrind - 1)
         ELSE
            SELECT @Piece = @RepParam
         INSERT @VALUES(Param) VALUES(@Piece)
         SELECT @RepParam = RIGHT(@RepParam,DATALENGTH(@RepParam) - @chrind)
         IF DATALENGTH(@RepParam) = 0 BREAK
      END
   RETURN
END 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-03T12:53:50.763

修改伟大的约翰解决方案，解决：

*   “2 引号”错误
*   参数中的一块后的空格

    ```
     ALTER FUNCTION [dbo].[fn_MVParam]
    (@RepParam nvarchar(4000), @Delim char(1)= ',')
    RETURNS @Values TABLE (Param nvarchar(4000))AS
    BEGIN
    //2 quotes error
    set @RepParam = replace(@RepParam,char(39)+char(39),CHAR(39))
    DECLARE @chrind INT
    DECLARE @Piece nvarchar(100)
    SELECT @chrind = 1 
    WHILE @chrind > 0
    BEGIN
      SELECT @chrind = CHARINDEX(@Delim,@RepParam)
      IF @chrind  > 0
        SELECT @Piece = LEFT(@RepParam,@chrind - 1)
      ELSE
        SELECT @Piece = @RepParam
      INSERT  @Values(Param) VALUES(CAST(@Piece AS VARCHAR(300)))
      //space after one of piece in parameter: LEN(@RepParam + '1')-1
      SELECT @RepParam = RIGHT(@RepParam,LEN(@RepParam + '1')-1 - @chrind)
      IF LEN(@RepParam) = 0 BREAK
    END
    RETURN
    END 

    ```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-05-24T19:54:14.557

这适用于一组不同的字符串（例如“START”、“END”、“ERROR”、“SUCCESS”）

1）定义报告参数（例如@log_status）并检查“允许多个值”
[![在此处输入图像描述](https://i.stack.imgur.com/AP4xU.png)](https://i.stack.imgur.com/AP4xU.png)

2) 定义数据集
3) 打开数据集属性窗口
3a) 在查询选项卡中输入您的查询：例如

```
select * from your_table where (CHARINDEX(your_column, @log_status,0) > 0) 
```

3b) 在参数选项卡中输入您的参数，例如
`Parametername: @log_status ; Parametervalue: <<Expr>>`
3c) 对于 Expr，单击“fx”按钮并输入：

```
=join(Parameters!log_status.Value,",") 
```

[![在此处输入图像描述](https://i.stack.imgur.com/yseig.png)](https://i.stack.imgur.com/yseig.png)

完成的！（它类似于 Ed Harper 的解决方案，但很抱歉这对我不起作用）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-04-23T14:48:32.690

从 MSSQL 2016 开始 - 兼容级别为 130，您可以利用`String_Split()`它来解析来自 SSRS 的连接参数。假设您想从 SSRS 中的查询中填充参数，然后将该参数传递给存储的过程或 SSRS 共享数据集：

1.  将两个数据集添加到您的 SSRS 报告中，一个返回要在参数中显示的值和标签列表，另一个包含您要过滤的实际数据。这些数据集中的每一个都可以是存储过程或共享数据集或嵌入式查询。
2.  在 SSRS 中创建一个不在您要过滤的数据集上的参数。让我们称之为`Customer`
3.  设置参数以允许多个值，并使用要从查询中显示的数据集、标签和值`Customer`设置选项卡。`Available Values`
4.  右键单击要过滤的数据集并添加在存储过程中定义的参数。让我们称之为`CustomerList`。
5.  单击此参数的值字段旁边的表达式按钮，然后执行`Join(Parameters!Customer.Value, ",")`
6.  在您的存储过程或共享数据集中，利用 string_split 将逗号分隔的`@CustomerList`参数分解为一个数组： `Customer.CustID in (select value from string_split(@CustomerList, ',') where value = Customer.CustID)`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-07T17:33:52.303

只是一个评论 - 我遇到了一个痛苦的世界，试图让一个 IN 子句在与 Oracle 10g 的连接中工作。我认为重写后的查询不能正确传递给 10g db。我不得不完全放弃多值。The query would return data only when a single value (from the multi-value parameter selector) was chosen. 我尝试了 MS 和 Oracle 驱动程序，结果相同。我很想知道是否有人在这方面取得了成功。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-06-27T13:58:30.050

1.  为报表中的列表创建数据集
2.  右键单击参数并选择可用值
3.  选择新创建的数据集作为数据集
4.  将传递给存储过程的值作为值字段添加
5.  将参数的描述添加到标签字段（如果参数是 customerID，则标签可以是 CustomerName ex。）
6.  最后，将以下代码添加到您的存储过程

将@paramName 声明为 NVARCHAR(500)，

IF RIGHT(@paramName, 1) = ',' BEGIN SET @paramName = LEFT((@paramName, LEN((@paramName)-1) END

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-08-05T18:42:05.623

首先将多个值添加到表中可能会更容易，然后您可以加入或任何您想要的（即使使用通配符）或将数据保存到另一个表以供以后使用（甚至将值添加到另一个表） .

**通过数据集中的表达式设置参数值：**

```
="SELECT DISTINCT * FROM (VALUES('" & JOIN(Parameters!SearchValue.Value, "'),('") & "')) 
AS tbl(Value)" 
```

**查询本身：**

```
DECLARE @Table AS TABLE (Value nvarchar(max))

INSERT INTO @Table EXEC sp_executeSQL @SearchValue 
```

**通配符示例：**

```
SELECT * FROM YOUR_TABLE yt 

INNER JOIN @Table rt ON yt.[Join_Value] LIKE '%' + rt.[Value] + '%' 
```

我很想找到一种无需动态 SQL 的方法，但由于 SSRS 将参数传递给实际查询的方式，我认为它不会起作用。如果有人知道更好，请告诉我。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-12-13T15:12:24.333

您还可以在存储过程中添加以下代码：

```
set @s = char(39) + replace(@s, ',', char(39) + ',' + char(39)) + char(39) 
```

（假设@s 是一个多值字符串（如“A,B,C”））

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-03-12T22:59:12.903

如果您想通过查询字符串将多个值传递给 RS，您需要做的就是为每个值重复报告参数。

例如; 我有一个名为 COLS 的 RS 列，该列需要一个或多个值。

```
&rp:COLS=1&rp:COLS=1&rp:COLS=5 etc.. 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-02-14T19:41:53.447

我是该网站的新手，不知道如何评论以前的答案，我觉得这应该是。我也无法投票给 Jeff 的帖子，我相信这给了我答案。无论如何...

虽然我可以看到一些很棒的帖子和随后的调整是如何工作的，但我只有对数据库的读取权限，所以没有 UDF、SP 或基于视图的解决方案对我有用。所以 Ed Harper 的解决方案看起来不错，除了 VenkateswarluAvula 的评论，您不能将逗号分隔的字符串作为参数传递给 WHERE IN 子句并期望它按您的需要工作。但 Jeff 的 ORACLE 10g 解决方案填补了这一空白。我将这些与 Russell Christopher 的博文放在一起，网址为[http://blogs.msdn.com/b/bimusings/archive/2007/05/07/how-do-you-set-select-all-as-the-default- for-multi-value-parameters-in-reporting-services.aspx](http://blogs.msdn.com/b/bimusings/archive/2007/05/07/how-do-you-set-select-all-as-the-default-for-multi-value-parameters-in-reporting-services.aspx)我有我的解决方案：

使用任何可用值来源（可能是数据集）创建多选参数 MYPARAMETER。就我而言，多选来自一堆 TEXT 条目，但我确信通过一些调整它可以与其他类型一起使用。如果您希望全选为默认位置，请将相同的源设置为默认位置。这为您提供了您的用户界面，但创建的参数不是传递给我的 SQL 的参数。

跳到 SQL 和 Jeff 对 WHERE IN (@MYPARAMETER) 问题的解决方案，我自己有一个问题，其中 1 个值（'Charge'）出现在其他值之一（'Non Charge' )，这意味着 CHARINDEX 可能会发现误报。我需要在参数之前和之后搜索分隔值。这意味着我需要确保逗号分隔的列表也有前导和尾随逗号。这是我的 SQL 片段：

```
where ...
and CHARINDEX(',' + pitran.LINEPROPERTYID + ',', @MYPARAMETER_LIST) > 0 
```

中间的部分是创建另一个参数（在生产中隐藏，但在开发时不隐藏）：

*   MYPARAMETER_LIST 的名称
*   一种文本
*   一个可用的值 `="," + join(Parameters!MYPARAMETER.Value,",") + ","`和一个无关紧要的标签
    （因为它不会显示）。
*   默认值完全相同
*   可以肯定的是，我在两个参数的高级属性中都设置了始终刷新

正是这个参数被传递给 SQL，它恰好是一个可搜索的字符串，但 SQL 像处理任何文本一样处理它。

我希望将这些答案片段放在一起可以帮助人们找到他们正在寻找的东西。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-03-20T19:25:30.560

过去，我曾求助于使用存储过程和函数在 SQL Server 查询中为报告服务选择多年。按照 Ed Harper 的建议在查询参数值中使用 Join 表达式，仍然无法在 where 语句中使用 SQL IN 子句。我的解决方案是在 where 子句中使用以下内容以及参数 Join 表达式：和 charindex (cast(Schl.Invt_Yr as char(4)) , @Invt_Yr) > 0

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-05-03T23:34:58.613

这是关于使用连接函数保存多值参数，然后稍后从数据库中恢复完全相同的选择。

我刚刚完成了一个要求必须保存参数的报表，当再次打开报表时（报表传递了一个 OrderID 参数），必须再次选择用户之前选择的值。

该报告使用了六个参数，每个参数都有自己的数据集和生成的下拉列表。这些参数依赖于先前的参数来缩小最终选择的范围，并且在“查看”报告时调用存储过程来填充。

存储过程接收从报告中传递给它的每个参数。它检查数据库中的存储表以查看是否为该 OrderID 保存了任何参数。如果没有，则保存所有参数。如果是这样，它会更新该订单的所有参数（这是用户稍后改变主意的情况）。

当报表运行时，有一个数据集 dsParameters，它是 SQL 文本，如果有，则选择该 orderID 的单行。报表中的每个参数都从该数据集中获取其默认值，并从专用于该参数的数据集中获取其选择列表。

我遇到了多选参数的问题。我在主数据集参数列表中使用了 join(@Value,",") 命令，将逗号分隔的字符串传递给存储过程。但是如何恢复呢？您不能将逗号分隔的字符串反馈回参数的默认值框。

## 我必须创建另一个数据集来拆分参数，其方式与您所说的类似。它看起来像这样：

```
IF OBJECT_ID('tempdb..#Parse','U') IS NOT NULL DROP TABLE #Parse

DECLARE @Start int, @End int, @Desc varchar(255)

SELECT @Desc = fldDesc FROM dbCustomData.dbo.tblDirectReferralFormParameters WHERE fldFrom = @From and fldOrderID = @OrderID

CREATE TABLE #Parse (fldDesc varchar(255))

SELECT @Start = 1, @End = 1

WHILE @End > 0
    BEGIN
        SET @End = CHARINDEX(',',@Desc,@Start)
        IF @End = 0 
            BEGIN
                INSERT #Parse SELECT REPLACE(SUBSTRING(@Desc,@Start,LEN(@Desc)),',','') AS fldDesc 
                BREAK
            END
        ELSE        
            BEGIN
                INSERT #Parse SELECT REPLACE(SUBSTRING(@Desc,@Start,@End-@Start),',','') AS fldDesc 
            END
        SET @Start = @End + 1
    END

SELECT * FROM #Parse 
```

* * *

每次打开表单时，此数据集都会检查数据库中保存的该多值参数的字符串。如果没有，则返回 null。如果打开，它会解析逗号并为每个值创建一行。

然后将默认值框设置为此数据集和 fldDesc。有用！当我选择一个或多个时，它们会在再次打开表单时保存并补充。

我希望这有帮助。我搜索了一段时间，没有发现将连接字符串保存在数据库中然后在数据集中解析出来的任何提及。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-05-29T15:28:36.833

这对我很有用：

```
WHERE CHARINDEX(CONVERT(nvarchar, CustNum), @CustNum) > 0 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-12-09T11:24:25.557

因此，乘以文本值将在查询中结束，每个我使用的单引号 =join(Parameters!Customer.Value,"','")。所以在“.Value”之后就是逗号，双引号，单引号，逗号，单引号，双引号，右括号。简单的:)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-06-12T00:13:27.580

以下解决方案对我有用。

1.  在数据集属性的参数选项卡中，单击您需要允许逗号的参数旁边的表达式图标（！ [http://chittagongit.com//images/fx-icon/fx-icon-16.jpg](http://chittagongit.com//images/fx-icon/fx-icon-16.jpg) [fx symbol]）分隔条目。

2.  在出现的表达式窗口中，使用拆分函数（通用函数 -> 文本）。示例如下所示：

> =拆分（参数！参数名称。值，，，，）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-01-09T22:02:18.177

我需要 Oracle 的解决方案，我发现这在我对 DB>=10g 报告的查询中对我有用。

select * from where in ( select regexp_substr(,'[^,]+', 1, level) from dual connect by regexp_substr(, '[^,]+', 1, level) 不为空);

来源 [https://blogs.oracle.com/aramamoo/entry/how_to_split_comma_separated_string_and_pass_to_in_clause_of_select_statement](https://blogs.oracle.com/aramamoo/entry/how_to_split_comma_separated_string_and_pass_to_in_clause_of_select_statement)

# math - 误解 MixColumns 步骤

> ID：512106
> 
> 赞同：5
> 
> 时间：2009-02-04T16:25:05.300
> 
> 标签：math, logic, aes

我在理解[此处](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)描述的 MixColumns 步骤时遇到问题。

我知道扩散，这一切都是有道理的，它指出每一列都被视为多项式并在 GF(2^8) 上乘以模。

但是..乘以 GF(2^8)。尽管域仍然是相同的，但由于 mod.... 而它是不可逆的，它必须是可逆的，因为这就是它的全部意义所在。

就第一位而言，我的方法是将 A、B、C 和 D 作为列的 4 个字节，将 A1、A2、...、A8 作为位，将 E、F、G 和 H 作为输出字节。我要设置

```
E = A1,B2,C3,D4,A5,B6,C7,D8
F = D1,A2,B3,C4,D5,A6,B7,C8
G = C1,D2,A3,B4,C5,D6,A7,B8
H = B1,C2,D3,A4,B5,C6,D7,A8 
```

因此它是可逆的、一对一的、线性的和分布的

它后来指出，它可以被视为矩阵乘法，但由于矩阵的元素必须是字节并以字节输出，因此矩阵的每个元素必须是模 256，因此不可逆和非线性。

我理解错了吗？我在数学上苦苦挣扎，并试图了解需要做什么，以便将其转换为逻辑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-25T14:44:19.080

MixColumns 可能是 AES 最难的部分，但对我来说，计算出数学并实际查看数字的来源让我很兴奋。我在我的博客文章“[高级加密标准 (AES) 简图指南](http://www.moserware.com/2009/09/stick-figure-guide-to-advanced.html)”中详细计算了它的数学。具体来说，看第 4 幕，第 16 场。我还在下一个场景 (17) 中将它的反面放在婴儿床单上。如果您还有其他问题，请随时在该帖子或此处发表评论。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T03:45:28.940

MixColumns 中的乘法确实是可逆的，它不是模[256。samiam.org/mix-column.html](http://samiam.org/mix-column.html)对 MixColumns 步骤有很好的解释，[samiam.org](http://samiam.org/galois.html) /galois.html很好地解释了如何做AES有限域中的算术。

# javascript - 在 jQuery 中，如何判断当前对象是否隐藏？

> ID：512119
> 
> 赞同：14
> 
> 时间：2009-02-04T16:28:07.417
> 
> 标签：javascript, jquery, css

在我打电话之前：

```
$('myObject').show(); 
```

我想知道它当前是隐藏的还是可见的。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-04T16:30:52.140

我知道有两种方法可以做到：

```
if ($('#something').is(':hidden')) { } 
```

或者

```
if ($('#something').is(':visible')) { } 
```

他们都应该工作。

你也可以这样做：

```
$('#something:hidden').show();
$('#something:visible').hide(); 
```

如果该项目已经隐藏，它将仅调用 .show() ，或者如果该项目已经可见，则仅调用 .hide() 。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-04T16:32:05.007

您也可以使用切换`$(this).toggle();`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-04T16:30:42.607

您可以使用 css() 函数对此进行测试：

```
if ($('myObject').css('display') == 'none') {
  $('myObject').show();
} 
```

编辑：

不知道 :hidden 选择器有多酷。我的建议对于测试其他属性仍然有用，但在这种情况下，Alex 的建议更好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T16:33:55.800

来自[jQuery 常见问题解答](http://docs.jquery.com/Frequently_Asked_Questions#How_do_I_determine_the_state_of_a_toggled_element.3F)：

```
 var isVisible = $('myObject').is(':visible');
 var isHidden = $('myObject').is(':hidden'); 
```

# php - PHP地雷一般

> ID：512120
> 
> 赞同：35
> 
> 时间：2009-02-04T16:28:16.840
> 
> 标签：php, performance

其他人在编写 PHP Web 应用程序时发现了哪些惊喜？编译时类继承存在众所周知且需要解决的问题，但我知道其他几个问题，并想尝试构建该语言的顶级问题列表。

笔记：

我担任过几个高级 PHP5 开发人员的职位，所以 PHP 的工作支付了我的账单，这个问题并不是要打破 PHP 作为一种语言，因为我使用过的每一种语言都有一些众所周知或不太知名的惊喜.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-04T16:35:32.457

I'm not sure if this counts, but the need to compile PHP scripts is a huge performance issue. In any serious PHP project you need some kind of compiler cache like [APC](http://de.php.net/apc), [eAccelerator](http://eaccelerator.net/), [PHP Accelerator](http://www.php-accelerator.co.uk/), or the (commercial) [Zend Platform](http://www.zend.com/).

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-04T23:02:20.867

[递归引用泄漏内存](http://bugs.php.net/bug.php?id=33595)

如果您创建两个对象并将它们存储在彼此的属性中，垃圾收集器将永远不会接触它们：

```
$a = new stdClass;
$b = new stdClass;
$a->b = $b;
$b->a = $a; 
```

当一个大类创建一个通常存储主类的小帮助对象时，这实际上很容易做到：

```
// GC will never clean up any instance of Big.
class Big {
  function __construct() {
    $this->helper = new LittleHelper($this);
  }
}
class LittleHelper {
  function __construct(Big $big) {
    $this->big = $big;
  }
} 
```

只要 PHP 以短的快速页面请求为目标，它们就不可能解决这个问题。这意味着 PHP 不能依赖于具有较长生命周期的守护程序或其他应用程序。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-04T16:34:58.260

require_once and include_once can often result in major performance killers when used excessively. If your including/require a file that holds a class... a pattern like so can save some serious processing time.

```
class_exists("myFoo") or require("myFoo.someClass.php"); 
```

Update: This is still a issue - [http://www.techyouruniverse.com/software/php-performance-tip-require-versus-require_once](http://www.techyouruniverse.com/software/php-performance-tip-require-versus-require_once)

Update: Read the selected answer for the following question: [Would performance suffer using autoload in php and searching for the class file?](https://stackoverflow.com/questions/135373/would-performance-suffer-using-autoload-in-php-and-searching-for-the-class-file) If implemented along these lines, you pretty much minimize as best as possible the penalties for file include/requires.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-05T04:11:45.313

一个有趣的地雷：[全局变量会影响on 的`$_SESSION`时间`register_globals`](http://php.net/manual/en/reserved.variables.session.php)。但我猜这就是当 register_globals（地雷本身）打开时会发生的情况。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-05T04:00:11.170

NULL 和“0”字符串在 PHP 中是纯粹的邪恶

```
if ("0" == false) //true
if ("0" == NULL)  //true
if ("0" == "NULL")//true 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-04T22:16:25.640

*   foreach() 在后台默默地复制数组并遍历该副本。如果您有一个大型阵列，这将降低性能。在这些情况下，对于 php5 或使用 for() 循环的 foreach() 的引用选项是新的。

*   请注意平等 (==) 与身份 (===)。

*   请注意什么构成 empty() 与什么构成 isset()。

* * *

现在我有更多的时间，更多的地雷：

*   不要比较浮点数是否相等。PHP 不是 matlab，它根本不是为精确的浮点运算而设计的。试试这个：

> ```
> if (0.1 + 0.2 == 0.3)
>   echo "equal";
> else
>   echo "nope"; // <-- ding ding 
> ```

*   同样，不要忘记你的八进制！带前导零的 int 被转换为八进制。

> ```
> if (0111 == 111)
>   echo "equal";
> else
>   echo "nope"; // <-- ding ding 
> ```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-04T16:32:22.883

It was kind of obvious after the fact but a well known gotcha has to do with scope and references when used in foreach.

```
foreach($myArray as &$element){
   //do something to the element here... maybe trim or something more complicated
}
//Multiple lines or immediately after the loop

$element = $foobar; 
```

The last cell in your array has now become $foobar because the reference in the foreach above is still in the current context scope.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-04T22:37:39.263

`@`应始终避免使用错误消音器。

一个例子：

```
// Don't let the user see an error if this unimportant header file is missing:
@include 'header.inc.php'; 
```

使用上面的代码，您将永远不会知道任何代码中的任何错误`header.inc.php`，或从 调用的任何函数`header.inc.php`，如果某处出现致命错误，您的网页将停止，无法找出错误曾是。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-04T16:56:58.467

`__autoload()` proved to be a major landmine for me recently. Some of our legacy code and libraries use `class_exists()`, and it tries to autoload classes that were never meant to be loaded in that way. Lots of fatal errors and warnings. `class_exists()` can still be used if you have autoload, but the second parameter (new since PHP 5.2.0) has to be set to `false`

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-04T17:02:56.020

不知道[运算符优先级](http://docs.php.net/manual/en/language.operators.precedence.php)可能会导致一些问题：

```
if ($foo = getSomeValue() && $bar) {
    // …
}
// equals
if ($foo = (getSomeValue() && $bar)) {
    // …
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-04T19:35:23.280

我见过人们成为牺牲品的最大问题是精度（在 php 和其他语言中）。

如果你想要一点乐趣，用 >= 将任何浮点数与一个整体进行比较，并找出你得到预期结果的次数。

这是许多在 PHP 中使用金钱并试图根据不允许舍入为整数的比较做出逻辑决策的人的失败。

例如——织物

织物以 1 码或 1 个半码为单位出售，并保留织物剩余精确尺寸的库存。

如果这个系统不是用整数表示，而是用浮点数表示，那么做出可靠的决定就会变得非常困难。

最好的办法是将 1 半码表示为 1，例如，如果您有 300 码织物，则您的库存为 600（600 个半码单位）。

无论如何，这就是我的问题 - 由于不了解精度，是时候重构 4 个月的编程了....

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-01-10T15:07:20.293

**数字字符串自动转换为整数**

这是迄今为止 PHP 中最丑陋和最晦涩的 hack。每当您有一个全为数字的字符串时，在某些情况下，它会自动被视为整数。

```
php > var_dump("0" == "00");
bool(true) 
```

与 PHP 的“关联数组”结合起来，这可能会变得非常讨厌，导致奇怪的地方`$a == $b`并不意味着，`$arr[$a] == $arr[$b];`

```
php > var_dump(array('00'=>'str(zerozero)', '0'=>'str(zero)'));
array(2) {
  ["00"]=>
  string(13) "str(zerozero)"
  [0]=>
  string(9) "str(zero)"
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-10T16:31:07.493

如果您习惯使用智能逻辑运算符的语言，您将尝试执行以下操作：

```
$iShouldTalkTo = $thisObj || $thatObj; 
```

在 PHP 中，`$iShouldTalkTo`现在是一个布尔值。你被迫写：

```
$iShouldTalkTo = $thisObj ? $thisObj : $thatObj; 
```

在 PHP 的早期设计决策如何试图抓住不称职的程序员的手以换取能力不足的程序员的所有示例中，这可能是最让我恼火的一个。

构造中的深度脑损伤`switch()`比比皆是。考虑一下：

```
switch($someVal) {
case true  :
    doSomething();
    break;
case 20    :
    doSomethingElse();
    break;
} 
```

事实证明这`doSomethingElse()`永远不会被调用，因为“case true”将吸收$someVal 的*所有*真实情况。

认为这是合理的，也许？好吧，试试这个：

```
for($ix = 0; $ix < 10; $ix++) {
    switch($ix) {
    case 3  :
        continue;
    default :
        echo ':';
    }
    echo $ix;
} 
```

猜猜它的输出是什么？应该是：0:1:2:4:5:6:7:8:9，对吧？不，它是：0:1:23:4:5:6:7:8:9。也就是说，它*忽略了语句的语义*并将`continue`其视为`break`.

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-05T04:04:35.310

我最喜欢的 PHP 陷阱：

考虑这包括：

```
# ... lots of code ...
$i = 42;
# ... more code ... 
```

然后在某处使用此包含：

```
for($i = 0; $i < 10; $i++){
    # ...
    include 'that_other_file.php';
} 
```

然后尝试猜测循环运行了多少次。是的，一次。词法作用域（和适当的动态作用域）都是已解决的问题。但不是在 PHP 中。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-01-10T14:41:40.900

最糟糕的一个是**PHP 的“关联数组”**的概念，它是数组、字典和列表的完全失败的混合体。PHP 的作者似乎不确定它在每种情况下应该如何表现，这会导致我们对数组的 plus 运算符和`array_merge`函数的不同行为感到奇怪。

```
php > $a = array(1=>'one');
php > $b = array(2=>'two');
php > var_dump($a+$b); /* plus preserves original keys */
array(2) {
  [1]=>
  string(3) "one"
  [2]=>
  string(3) "two"
}
php > var_dump(array_merge($a,$b)); /* array_merge reindexes numeric keys */
array(2) {
  [0]=>
  string(3) "one"
  [1]=>
  string(3) "two"
}

php > $a = array(1=>'one');
php > $b = array(1=>'another one');
php > var_dump($a+$b);  /* plus ignores duplicate keys, keeping the first value */
array(1) {
  [1]=>
  string(3) "one"
}
php > var_dump(array_merge($a,$b)); /* array_merge just adds them all, reindexing */
array(2) {
  [0]=>
  string(3) "one"
  [1]=>
  string(11) "another one"
}

php > $a = array(1,2,3);
php > $b = array(4,5,6);
/* non-associative arrays are really associative arrays with numeric keys… */
php > var_dump($a+$b);  /* … so plus doesn’t work as you’d normally expect */
array(3) {
  [0]=>
  int(1)
  [1]=>
  int(2)
  [2]=>
  int(3)
}
php > var_dump(array_merge($a,$b));  /* you should use array_merge instead */
array(6) {
  [0]=>
  int(1)
  [1]=>
  int(2)
  [2]=>
  int(3)
  [3]=>
  int(4)
  [4]=>
  int(5)
  [5]=>
  int(6)
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-04T22:27:46.943

PHP 中的另一个陷阱，我从其他语言的人那里看到了这个错误，但并不经常。

```
<?php
/**
 * regular
 */
echo (true && true); // 1
echo (true && false); // nothing

echo (true || false); // 1
echo (false || false); // nothing

echo (true xor false); // 1
echo (false xor false); // nothing

/**
 * bitwise
 */
echo (true & true); // 1
echo (true & false); // 0

echo (true | false); // 1
echo (false | false); // 0

echo (true ^ false); // 1
echo (false ^ false); // 0
?> 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-04T16:49:04.740

Total memory while running PHP. Many large projects just include all the class files and use them when they need them. This adds to the total memory PHP needs to use for each run.

Also projects using Frames or IFrames as this could easily double your memory usage.

So employ a conditional loading of your class files, have nothing loaded that you aren't using

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-04T16:57:13.740

PHP 应用程序的性能问题通常是以下之一：

*   文件系统访问 - 读写磁盘
    *   这是 APC、eAccelerator 等派上用场的地方，它们通过在内存中缓存已解析的 PHP 文件来减少文件系统访问
*   数据库 - 慢查询，大型数据集
*   网络 I/O - 访问外部资源

PHP（或以任何语言编写的任何 Web 应用程序）很少遇到性能问题。上述问题通常比代码执行慢几个数量级。

与往常一样，分析您的代码！

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2010-02-11T11:55:50.453

没有获得 if/else 分支的编译器消息：

```
if( $foo )
{
  some_function();
}
else
{
  non_existing_function();   // oops!
} 
```

PHP 不会提到它`non_existing_function`不存在，直到你输入一个`$foo`错误的情况。

* * *

忘记设置：

```
error_reporting( E_ALL ); 
```

所以通知没有被捕获，花时间调试：

*   不存在的变量
*   无效的对象属性
*   无效的数组键

* * *

将不同“类型”/来源的字符串粘贴在一起，而不转义它们：

```
// missing mysql_real_escape_string() or an int cast !
$sql = "SELECT * FROM persons WHERE id=$id";

// missing htmlentities() and urlencode() !
$html = "<a href='?page=$id'>$text</a>"; 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-06-25T11:37:14.993

根据[为什么在引用的值上调用函数（如 strlen、count 等）这么慢？](https://stackoverflow.com/questions/3117604/why-is-calling-a-function-such-as-strlen-count-etc-on-a-referenced-value-so-sl/3117608)

如果您通过引用将变量传递给函数，然后在其上调用函数，则速度**非常**慢。

如果您循环调用函数并且变量很大，则它可能比变量按值传递时慢许多数量级。

例子：

```
<?php
function TestCount(&$aArray)
{
    $aArray = range(0, 100000);
    $fStartTime = microtime(true);

    for ($iIter = 0; $iIter < 1000; $iIter++)
    {
        $iCount = count($aArray);
    }

    $fTaken = microtime(true) - $fStartTime;

    print "took $fTaken seconds\n";
}

$aArray = array();
TestCount($aArray);
?> 
```

这始终需要大约 20 秒才能在我的机器上运行（在 PHP 5.3 上）。

但是，如果我将函数更改为按值传递（即，`function TestCount($aArray)`而不是`function TestCount(&$aArray)`），那么它会在大约 2 毫秒内运行 -**实际上快 10,000 倍**！

任何按值传递的函数都是如此 - 内置函数（如`strlen`, 和用户定义的函数）。

这是一个我以前不知道的相当可怕的tarpit！

幸运的是，有一个适用于许多情况的简单解决方法 - 在循环内使用临时局部变量，并在最后复制到引用变量。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-11T19:38:20.623

in the very beginning one could spent a lot of time debugging that kind of code:

```
$a = 1;
echo $a;      # 1
echo "$a";    # 1
echo '$a';    # $a 
```

damn quotes! very frustrating :(

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-05T03:47:50.337

刚想到一个惊喜。对数组应用回调的array_map 是一个严重的性能杀手。我不完全确定为什么，但我认为这与 PHP 的循环写入机制的复制有关。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2011-01-10T14:55:25.837

**类型转换和三等式**

通常在大多数语言中，当您对两种不同类型的数据进行操作时，您要么得到异常，要么将其中一种转换为更通用的一种。在语言中，除了 PHP，字符串被认为比整数更通用。只有在 PHP 中你有：

```
php > var_dump('nada' == 0);
bool(true) 
```

为了应对 PHP 引入了三等式运算符。如果值具有相同的类型和相同的值，则根据定义返回 true。适用于上面的示例：

```
php > var_dump('nada' === 0);
bool(false) 
```

但是，当您实际上希望值相等时，它的行为也很**丑陋**。

```
php > var_dump(0.0 === 0);
bool(false) 
```

如果您要使用任何其他语言的经验来使用 PHP，那么您肯定会遇到问题。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2011-03-22T19:40:31.497

```
$x = array();
$x == null ? "true": "false"; 
```

输出为“真”。

```
$x = array("foo");
$x == null ? "true": "false"; 
```

输出为“假”；

# java - 在 C# 中使用 .jar java 库 API？

> ID：512124
> 
> 赞同：54
> 
> 时间：2009-02-04T16:28:42.877
> 
> 标签：java, c#, .net, interop

我是入门级程序员，所以请在您的回复中进行描述。

我正在尝试在我的 C# .net 应用程序中使用作为 .jar 文件提供的 Java API。我不太了解Java，但是当我尝试运行它时，这个.jar 文件说“没有主类清单属性”，所以这意味着它是一个库？这个 Java API 还附带了一个 .java 文件，该文件显示了如何使用该库，但我看不到 .jar 中的代码。

我在这个网站上发现[了这个问题](https://stackoverflow.com/questions/171717/using-java-classes-with-c)，其中一个答案是：“以简单的方式，您可以将 java 类打包到 jar 文件中，然后在 C# 中使用 Process 类来执行和映射 IO 流。” 我对 C# 中的 Process 类有点熟悉，但我不明白如何在我的 C# .net 项目中使用它来使用 Java 库。

这可能吗？还是那个答案不正确？

如果是这样，您能否解释一下如何在我的 C# 应用程序中使用 .jar 库。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-02-04T16:58:39.273

您可以使用 IVKM.Net 来完成。IVKM.NET 包含一个名为 ikvmc 的应用程序。这是此工具的文档：

[http://www.ikvm.net/userguide/ikvmc.html](http://www.ikvm.net/userguide/ikvmc.html)

要使用它，请将您的 java 代码编译成一个 Jar。

然后运行 ​​ikvmc 程序：

ikvmc myCode.jar

如果您的 jar 包含 main() 函数，它将被转换为可以在 CLR 上运行的 exe。否则它将被转换为dll。要在您的项目中使用 dll，只需将它们作为引用添加到 Visual Studio 中，您可以在您的 .Net 应用程序中访问在 Java 中可用的相同 API。

您还可以包含来自 ikvmc 的 IKVM.GNU.Classpath.dll dll，并在您的应用程序中使用标准的 java 类库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T17:04:30.917

看看[IKVM](http://www.ikvm.net/) ...它有一些工具可以为您提供一定程度的互操作。当您说 Java API 时，我假设您想从 jar 中调用某些功能，而不仅仅是执行它

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-01-01T14:23:05.310

1.  您可以使用 IKVM.NET - [http://www.ikvm.net/userguide/ikvmc.html](http://www.ikvm.net/userguide/ikvmc.html)

    在官方网站上下载 - 你可以得到 **ikvmbin-7.2.4630.5**（适用于 Java 7）

    但是，在所有者的博客上，您可以下载更新的版本。 [http://weblog.ikvm.net/default.aspx](http://weblog.ikvm.net/default.aspx) - 您可以获得 **ikvmbin-8.1.5717.0**（最高支持 Java 8）

    要创建 dll/exe，请使用：

    **ikvmc hello.jar**

2.  另一方面，如果您可以编辑 .jar lib（您创建它），您可以使用[http://jni4net.com/](http://jni4net.com/)项目。

# sql-server - Visual Studio 将无法连接到 Sql Server 2000

> ID：512126
> 
> 赞同：2
> 
> 时间：2009-02-04T16:29:10.503
> 
> 标签：sql-server, visual-studio, visual-studio-2008, ado.net

我不再能够在 Visual Studio 2008 中以图形方式查看表、服务器或数据库。如果我打开以前创建的数据集，我看到的只是 XML，就好像我选择了视图代码而不是设计器一样，我也丢失了我的服务器资源管理器窗口和当我尝试从工具重新添加它时——>连接到服务器或数据库没有任何反应。在此问题出现之前或之后未安装任何内容。请提供任何建议。

当前相关环境：

*   操作系统：Windows XP SP3
*   IDE：Visual Studio 2008 SP1
*   SQL：SQL Server 2000

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T18:23:55.280

愚蠢的问题，但我打了很多。如果您在启用 UAC 的情况下运行 Vista 并且 SQL 框是 localhost，您必须以管理员身份启动 VS2008 才能打开连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T17:32:34.240

通过恢复计算机解决的问题原来很多问题开始级联，我不得不将整个计算机恢复到更早的状态。

# .net - 使用 Linq to XML 时出现 NullReferenceException

> ID：512133
> 
> 赞同：2
> 
> 时间：2009-02-04T16:30:15.917
> 
> 标签：.net, xml, linq

鉴于此 xml 文档：

```
<projects><project><name>sample project</name><location>http://somewhere.com/</location></project></projects> 
```

这个 linq to xml 语句用于检索名称/位置元素并创建一个新的项目对象：

```
return xmlDocumentFromAbove.Descendants("project").Select(p => new Project(p.Element("Name").Value, p.Element("Location").Value)); 
```

我不断得到一个 NRE，我正在访问 p.Element("Name").Value。我在这里遗漏了一些明显的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T16:32:55.427

“名称”应该是“名称” - 同样是“位置”到“位置”。

```
return xmlDocumentFromAbove.Descendants("project").Select(p =>
    new  Project(p.Element("name").Value, p.Element("location").Value)); 
```

# asp.net - 在 ASP.net 中生成 excel 时等待页面

> ID：512135
> 
> 赞同：1
> 
> 时间：2009-02-04T16:30:28.690
> 
> 标签：asp.net

我有一个要求，其中我需要在执行 excel 报告时显示等待消息，并且当执行完成时，将写入 excel 以响应用户保存。保存完成后，我需要隐藏等待消息。

我能够显示等待消息，但执行完成后我无法隐藏相同的消息。我已经使用 Ifames 来实现相同的目标。我在 iframe 中完成了 excel 所需的所有处理，并在同一个 iframe 中写入响应。我试图使用 Javascript 隐藏等待消息，但是任何用 iframe 的 onload、onunload、onbeforeunload 等编写的 JavaScript 函数都没有被执行。

有什么方法可以调用 JavaScript 函数，或者有没有其他方法可以解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T16:47:31.713

以下是我的做法：

*   创建一个 HttpHandler 生成文档，保存它（在缓存/磁盘/数据库中，您的调用）并返回生成文档的标识符
*   使用 AJAX 调用调用 HttpHandler（使用[jQuery](http://jquery.com)让这变得非常简单）
*   使用 javascript/jQuery 显示等待消息/图形/动画/其他
*   [在 AJAX 请求回调中，重定向到一个页面，该页面采用生成的标识符并使​​用Content-Disposition](http://support.microsoft.com/kb/260519)标头将相应的文档作为附件发送。

作为旁注，这在 ASP.NET MVC 中会更简单一些

**GenerateDocument HttpHandler 存根：**

```
public class GenerateMyDocumentHandler : IHttpHandler
{
    #region [ IHttpHandler Members ]

    public Boolean IsReusable
    {
        get { return true; }
    }

    public void ProcessRequest(HttpContext context)
    {
        var docIdentifier = this.GenerateDocument();

        context.Response.ContentType = "text/plain";
        context.Response.Write(docIdentifier.ToString("N"));
    }

    #endregion

    private Guid GenerateDocument()
    {
        var identifier = Guid.NewGuid();

        // Logic that generates your document and saves it using the identifier

        return identifier;
    }
} 
```

**客户端脚本存根：**

```
function generateDocument() {
    var result = $.get('/GenerateDocument.ashx', { any: 'parameters', you: 'need', go: 'here' }, generateDocumentCallback, 'text');
    // display your waiting graphic here
}

function generateDocumentCallback(result) {
    window.location.href = '/RetrieveDocument.ashx/' + result;
} 
```

**RetrieveDocument HttpHandler 存根：**

```
public class RetrieveDocument : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        var identifier = new Guid(context.Request.Url.Segments[1]);
        var fileContent = this.GetFileAsBytes(identifier);

        context.Response.ContentType = "application/vnd.ms-excel";
        context.Response.AddHeader("Content-Disposition", "attachment; filename=yourfilename.xls");
        context.Response.OutputStream.Write(fileContent, 0, fileContent.Length);
    }

    private Byte[] GetFileAsBytes(Guid identifier)
    {
        Byte[] fileBytes;
        // retrieve the specified file from disk/memory/database/etc

        return fileBytes;
    }

    public Boolean IsReusable
    {
        get
        {
            return true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T16:40:55.503

几年前我做过类似的事情。我打开了一个新线程来进行后台处理，然后重定向到“等待”页面。等待页面检查任务的状态，如果完成，则重定向回来。这是一个非常简单的解决方案。[在这里](http://www.simple-talk.com/dotnet/asp.net/implementing-waiting-pages-in-asp.net/)查看

# mysql - 从 MySQL 查询的顶部和底部截断 13%？

> ID：512138
> 
> 赞同：3
> 
> 时间：2009-02-04T16:31:05.633
> 
> 标签：mysql

我目前正在尝试优化一些查询和脚本，我想知道是否有办法切断一定比例的 MySQL 结果集？

例如，我有一个这样的查询：

```
SELECT TrackingID, OpenTime, FirstPoint
FROM PointsTable 
```

我需要“中间”的 74%，按 FirstPointGMT 和 OpenTimeGMT 之间的差异排序，这意味着：我需要切断顶部和底部的 13%。

目前，脚本只会获取所有行，按持续时间计算和排序，然后将它们切断，但如果可能的话，我想在 SQL 查询中进行，以使脚本更清晰。

我知道 LIMIT 条款，但这似乎不支持像“13%”这样的相对值。

任何人都可以判断a）是否真的只有SQL才有可能，b）如何实现？

MySQL 是 5.0.45。

PS：是的，我知道 13% 似乎是一个非常奇怪的数字，但这都是更大过程的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T17:24:27.570

您需要通过结果集中返回的行所在的百分位来限制要返回的数据。

试试这个：

```
SELECT TrackingID, OpenTime, FirstPoint
FROM PointsTable
ORDER BY FirstPointGMT - OpenTimeGMT
LIMIT (13*((SELECT COUNT(*) FROM PointsTable) +1) / 100), 
((SELECT COUNT(*) FROM PointsTable)
 -
 (26*((SELECT COUNT(*) FROM PointsTable) +1) / 100)
) 
```

**以上的解释**

这里唯一棘手的是 Limit 子句及其语法：

```
> LIMIT start_row,number_of_rows_to_return 
```

我们的 start_row 需要成为结果集中第一个记录 13/100（13%）之后的第一个元素。为此，我们使用以下公式：

```
rownumber_or_number_of_rows_in_resultset_Npercent_in = 
( Npercent * ( number_of_rows_in_resultset + 1) / 100) 
```

这是`(13*((SELECT COUNT(*) FROM PointsTable) +1) / 100)`。

我们的 number_of_rows_to_return 必须是总行数，减去 26% 的行数（底部 13% 和顶部 13%），或者

```
(total_number_of_rows - number_of_rows_26percent_of_the_way_in) 
```

因此实际计算为：

```
( (SELECT COUNT(*) FROM PointsTable)
  - 
  (26*((SELECT COUNT(*) FROM PointsTable) +1) / 100) 
) 
```

* * *

**编辑：** 查看 Niyaz 的回复后，我意识到查询可以重写为：

```
SELECT TrackingID, OpenTime, FirstPoint
FROM PointsTable
ORDER BY FirstPointGMT - OpenTimeGMT
LIMIT (13*((SELECT COUNT(*) FROM PointsTable) +1) / 100), 
 (74*((SELECT COUNT(*) FROM PointsTable) +1) / 100) 
```

这更简洁，因为它消除了第三个嵌套查询，并且在功能上应该是等效的。限制行数，从距顶部 13% 的行开始，并从该点开始显示表外总行数的 74%。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T17:15:20.380

您将不得不为此使用两个查询。

第一的：

```
SELECT count(*) as c 
FROM PointsTable; 
```

然后在php中找到以下内容：

```
a = c * 13 / 100
b = c * 74 / 100 
```

第二：

```
SELECT TrackingID, OpenTime, FirstPoint 
FROM PointsTable
LIMIT a,b; 
```

请记住将 a,b 替换为其值。

我不知道在单个查询中执行此操作的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T16:37:00.583

截断某个百分比意味着仍然必须对查询进行全面评估，因为必须知道结果的数量才能计算百分比。

但是，您可以通过不从数据库中检索不需要的结果来节省一些带宽/cpu，但这取决于您的数据库驱动程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T17:09:58.487

您将无法在单个查询中执行此操作。至少需要3个，沿着这些方向：

```
从条件限制为 0 的表中选择 sql_calc_found_rows 字段；
选择@cnt := found_rows();
从条件限制的表中选择字段@cnt*0.13,@cnt-@cnt*0.13
```

额外的 'sql calc found rows parameter' 使 MySQL 确定如果限制子句不愉快，将检索多少行，然后您使用 found_rows() 函数检索它，并使用它以正确的数字重新运行查询限制得到你的 74%。

# c# - 在双缓冲控件上重新绘制图像而不闪烁的问题

> ID：512142
> 
> 赞同：1
> 
> 时间：2009-02-04T16:32:09.967
> 
> 标签：c#, drawing, doublebuffered

我知道双缓冲是一个经常被谈论的主题，但无论我如何搜索和尝试不同的方法，我仍然无法让控件在没有闪烁的情况下重新绘制自身。这是我的代码：

```
using System;
using System.Drawing;
using System.Windows.Forms;

namespace Emgu.UI
{
    public class DoubleBufferedPictureBox : Control
    {
        const BufferedGraphics NO_MANAGED_BACK_BUFFER = null;

        BufferedGraphicsContext GraphicManager;
        BufferedGraphics ManagedBackBuffer;

        public Bitmap Bitmap { get; set; }
        public Rectangle DrawRectangle { get; set; }

        public DoubleBufferedPictureBox()
        {
            SetStyle(ControlStyles.AllPaintingInWmPaint, true);

            GraphicManager = BufferedGraphicsManager.Current;
            GraphicManager.MaximumBuffer =
                   new Size(Width + 1, Height + 1);
            ManagedBackBuffer =
                GraphicManager.Allocate(CreateGraphics(),
                                               ClientRectangle);

            Resize += DoubleBufferedPictureBox_Resize;
        }

        void DoubleBufferedPictureBox_Resize(object sender, EventArgs e)
        {
            if (ManagedBackBuffer != NO_MANAGED_BACK_BUFFER)
                ManagedBackBuffer.Dispose();

            GraphicManager.MaximumBuffer =
                  new Size(Width + 1, Height + 1);

            ManagedBackBuffer =
                GraphicManager.Allocate(CreateGraphics(),
                                                ClientRectangle);
            Refresh();
        }

        protected override void OnPaint(PaintEventArgs pe)
        {
            ManagedBackBuffer.Graphics.DrawImage(Bitmap, DrawRectangle);
            ManagedBackBuffer.Render(pe.Graphics);
        }

    }
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T22:17:14.280

您使用的是 .Net 2.0 吗？如果是这样，我发现以下 Windows 样式可以解决问题，即使嵌入了旧的顽固 Win32 控件，而且速度也很快！

```
// Note the >>> Optimized <<< DoubleBuffer
SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
SetStyle(ControlStyles.AllPaintingInWmPaint, true);
SetStyle(ControlStyles.ResizeRedraw, true);
SetStyle(ControlStyles.UserPaint, true); 
```

确保你**总是**从 WM_PAINT 消息中绘制，否则它会闪烁。你不需要其他任何东西，一切都是自动的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:12:06.713

我的天啊...

就像我在评论中所说的那样，pictureBox 包含在另一个我没有编写的控件中（但有源代码）。事实证明，闪烁是由这两行引起的：

```
if (pictureBox.Width != _displayedImage.Width) pictureBox.Width = _displayedImage.Width;
if (pictureBox.Height != _displayedImage.Height) pictureBox.Height = _displayedImage.Height; 
```

我认为那是因为 PictureBox 实际上停靠在父控件中......

无论如何，感谢您的所有回复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:43:00.570

Have you tried setting the controls [DoubleBuffered](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.doublebuffered.aspx) property to true?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T17:02:07.287

父控件（表单？）中的绘画是否也是双缓冲的？

您的自定义控件可能会在没有闪烁的情况下绘制，但是当父控件被绘制并且没有双缓冲时，它会闪烁。

你可能会双重缓冲错误的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T17:11:03.680

我认为问题出在您的 OnPaint 方法中，[来自 MSDN](http://msdn.microsoft.com/en-us/library/ka0yazs1(VS.80).aspx)，当您调用 ManagedBackBuffer.Render 方法时，您应该传递 CreateGraphics() 而不是 Graphics 属性：

# excel - 错误：“找不到可安装的 ISAM”

> ID：512143
> 
> 赞同：40
> 
> 时间：2009-02-04T16:32:12.837
> 
> 标签：excel, ms-access, vba, connection-string

我在 Excel 工作簿中编写了一些 VBA 代码，以从桌面上同一目录中的 Access 数据库中检索数据。它在我的机器和其他几台运行 Windows XP 的机器上运行良好，但是当我们在 Vista 机器上测试它时，我们遇到了以下错误：

> 找不到可安装的 ISAM

我在网上做了很多搜索，但似乎找不到具体的答案。连接字符串似乎很好，而且，正如我所提到的，它可以在多台机器上运行。

有谁知道是什么原因造成的？我的连接字符串如下：

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\ptdb\Program Tracking Database.mdb; 
```

谢谢

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-05-23T05:36:27.937

`Extended Properties`在:周围放置单引号

```
OleDbConnection oconn = 
    new OleDbConnection(
        @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + path + ";Extended Properties='Excel 8.0;HDR=YES;IMEX=1;';"); 
```

试试看，确实有效。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-04T16:44:53.093

Try putting single quotes around the data source:

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source='D:\ptdb\Program Tracking Database.mdb'; 
```

The problem tends to be white space which does have meaning to the parser.

If you had other attributes (e.g., Extended Properties), their values may also have to be enclosed in single quotes:

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source='D:\ptdb\Program Tracking Database.mdb'; Extended Properties='Excel 8.0;HDR=YES;IMEX=1;'; 
```

You could equally well use double quotes; however, you'll probably have to escape them, and I find that more of a *Pain In The Algorithm* than using singles.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-08T12:25:03.633

只需在您的连接字符串中使用 Jet OLEDB:。它为我解决了。

下面是一个例子：

```
"Provider=Microsoft.Jet.OLEDB.4.0;Persist Security Info=False;Data Source=E:\Database.mdb;Jet OLEDB:Database Password=b10w" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-13T22:12:45.393

我刚刚遇到了一个非常相似的问题。

和你一样，我的连接字符串看起来是正确的——事实上，完全相同的连接字符串在其他情况下也能正常工作。

问题原来是缺乏资源。20 次中有 19 次，我会看到“找不到可安装的 ISAM”，但有一两次（根本没有任何代码更改），它会产生“内存不足”。

重新启动机器“解决”了问题（现在......？）。这发生在 Windows XP 上使用 Jet 版本 4.0.9505.0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-25T21:32:29.260

我用它来更新一个 excel 12 xlsx 文件

```
 System.Data.OleDb.OleDbConnection MyConnection;
        System.Data.OleDb.OleDbCommand myCommand = new System.Data.OleDb.OleDbCommand();
        MyConnection = new System.Data.OleDb.OleDbConnection("provider=Microsoft.ACE.OLEDB.12.0;Data Source='D:\\Programming\\Spreadsheet-Current.xlsx';Extended Properties='Excel 12.0;HDR=YES;';");
        MyConnection.Open();
        myCommand.Connection = MyConnection;
        string sql = "Update [ArticlesV2$] set [ID]='Test' where [ActualPageId]=114";// 
        myCommand.CommandText = sql;
        myCommand.ExecuteNonQuery();
        MyConnection.Close(); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-10-13T06:09:45.093

**使用此连接字符串**

```
string connectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;" +
      "Data Source=" + strFileName + ";" + "Extended Properties=" + "\"" + "Excel 12.0;HDR=YES;" + "\""; 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-04T16:55:33.790

This problem is because the machine can't find the the correct ISAM (indexed sequential driver method) registered that Access needs.

It's probably because the machine doesn't have MSACeesss installed? I would make sure you have the latest version of Jet, and if it still doesn't work, find the file Msrd3x40.dll from one of the other machines, copy it somewhere to the Vista machine and call regsvr32 on it (in Admin mode) that should sort it out for you.

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-11-22T13:07:52.347

使用下面的连接字符串从 XLSX 文件中读取：

> string ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + <> + ";Extended Properties=Excel 8.0;";

# drupal - 为特定内容类型自定义创建内容表单

> ID：512144
> 
> 赞同：8
> 
> 时间：2009-02-04T16:32:15.413
> 
> 标签：drupal

如何为特定内容类型自定义创建内容表单。在这种情况下，我有一个 CCK 类型的产品，但每次创建产品时，我都会使用 4 个字段名称、价格、图片和尺寸。

有没有办法缩小创建内容的形式，只拥有这些选项？这是Contempt做的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T17:56:31.747

你会想要使用[hook_form_alter](http://api.drupal.org/api/function/hook_form_alter)钩子。

在 Drupal 6 中，我使用它来隐藏节点编辑/添加表单中的大部分无关内容。

```
function mymodule_form_alter(&$form, $form_state, $form_id) {
  // hide extraneous options in the node form for nodetype nodes
  if($form_id == 'nodetype_node_form') {
    $form['path']['#access'] = FALSE;
    $form['menu']['#access'] = FALSE;
    $form['author']['#access'] = FALSE;
    $form['options']['#access'] = FALSE;
    $form['comment_settings']['#access'] = FALSE;
    $form['revision_information']['#access'] = FALSE;
  }
} 
```

Contemplate 用于设置节点视图的样式，而不是节点表单。[我不建议这样做 - 使用node-nodetype.tpl.php](http://api.drupal.org/api/file/modules/node/node.tpl.php/6)文件要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:00:34.383

另一种选择——如果你真的想精简一些东西，这可能更简单——是从头开始创建自己的表单，并在表单的提交处理程序中自己创建一个节点对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:31:48.283

找到了一个很好的资源：

[http://www.lullabot.com/articles/modifying-forms-5-and-6](http://www.lullabot.com/articles/modifying-forms-5-and-6)

它提到的伊顿或 ceejayoz 未涵盖的一件事是隐藏主题层中的字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T11:06:11.587

我创建了一个模块并使用 form_alter 和 nodeapi。

以下是您的模块需要的组件的基本概念。

我的 product.install 文件具有以下内容：

```
function product_install() {
  db_query("CREATE TABLE {product} (
    nid int(10) unsigned NOT NULL default '0',
    primary key (nid),
    price DECIMAL(7, 2) UNSIGNED NOT NULL DEFAULT 0.00
    ) TYPE=MyISAM /*!40100 DEFAULT CHARACTER SET utf8 */;"
  );
}

function product_uninstall() {
  db_query("DROP TABLE {product}");
} 
```

然后 product.module 文件包含：

```
function product_nodeapi(&$node, $op, $a3 = NULL, $a4 = NULL) {
  if($node->type != 'product') {
    return;
  }
  switch($op) {
    case 'load':
      return _product_load($node);
    case 'insert':
      _product_insert($node);
      break;
    case 'delete':
      _product_delete($node);
      break;
    case 'update':
      _product_delete($node);
      _product_insert($node);
      break;
    case 'view':
      //display your product 
      $node->content['price'] = array(
        '#value' => theme('transact_node_status', $node),
        '#weight' => 5,
      );
      break;
  }
}

function product_form_alter(&$form, $form_state, $form_id) {
  if($form_id == 'product_node_form'){
    $form['price'] = array(
      '#type' => 'textfield',
      '#title' => t('Price'),
      '#default_value' => $form['#node']->price,
    );
  }
  return $form;
}

function _product_load($node) {
  $result = db_query("SELECT * FROM {product} WHERE nid = %d", $node->nid);
  $arr = db_fetch_array($result);
  unset($arr['nid']);
  return $arr;
}

function _product_insert($node) {
  db_query("INSERT INTO {product} (nid, price) VALUES(%d, %d)", $node->nid, $node->price);
}

function _product_delete($node) {
  db_query("DELETE FROM {product} WHERE nid = %d", $node->nid);
} 
```

# .net - 新奇的“查看统计”在升级后的 CruiseControl.NET 服务器上不起作用

> ID：512145
> 
> 赞同：0
> 
> 时间：2009-02-04T16:32:19.077
> 
> 标签：.net, cruisecontrol.net, upgrade

最近我将几个 CruiseControl.NET 服务器从 1.3 版升级到 1.4.2.14 版。升级后，我很高兴地注意到项目 Web 仪表板中的“查看统计信息”链接显示了一个新视图：

![替代文字](https://tvl7tg.blu.livefilestore.com/y1pJXOc5a-GHWftIp_G9K6qZpNnt6H-9XKsjtQRNgUZPuf9iDDBrqx8xJr3dpx43CeFyw8qGG2EnNA/CCNetViewStatsNew.PNG)

然而，

我很失望地发现我以相同方式升级的另一台服务器运行旧式统计页面：

![替代文字](https://tvl7tg.blu.livefilestore.com/y1pVz14MxrzMQ7_4R7p2U92pG79rxcHPuu7nFjlDaeyW5S6ZethkDodIbB4x9vdDa6t9dN33SfQnZw/CCNetViewStatsOld.PNG)

当我升级第二台服务器时，似乎有一些配置设置没有启用。有什么想法可以控制这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T17:27:03.377

删除 Web 仪表板并再次安装似乎可以解决此问题。我按照以下步骤操作：

1.  停止 WWW 服务
2.  进入CC.NET安装目录，删除webdashboard文件夹
3.  重新安装 CC.NET
4.  重启 CCService 和 WWW 服务

# java - 使用 javax.swing.ProgressMonitor 时如何禁用取消按钮？

> ID：512151
> 
> 赞同：2
> 
> 时间：2009-02-04T16:33:10.980
> 
> 标签：java, swing

我想使用`ProgressMonitor`'s 的功能，但我不想让用户选择取消操作。我知道如果我不打电话`isCanceled()`，那么按下按钮就没有效果，但我不希望用户相信程序没有响应。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T16:39:51.543

你不能。[如The Java Tutorial](http://java.sun.com/docs/books/tutorial/uiswing/components/progress.html)中所述，使用 JProgressBar 创建您自己的对话框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T22:26:09.043

我不知道为什么所有 ProgressMonitor 字段都是私有的。可能不是戈斯林先生最自豪的创作:)

```
 * @author James Gosling
 * @author Lynn Monsanto (accessibility) 
 * @version 1.37 04/12/06 
```

只需克隆它，连同一些来自 Swing 的包私有内容，然后你就可以做任何你想做的事情，比如添加一个可取消标志，并在 ProgressOptionPane 的构造函数中使用它。

* * *

（更新）如果您不能在 SCSL 下派生 JDK 代码，那么这是一种获取 JDialog 的迂回方法，那么您可以做任何您想做的事情，包括删除 Cancel 按钮：

```
progressMonitor = new ProgressMonitor(ProgressMonitorDemo.this,
                                     "Running a Long Task",
                                     "", 0, 100);
progressMonitor.setMillisToDecideToPopup(0);
progressMonitor.setMillisToPopup(0);
progressMonitor.setProgress(0);
JDialog dialog = (JDialog)progressMonitor.getAccessibleContext().getAccessibleParent();
JOptionPane pane = (JOptionPane)dialog.getContentPane().getComponent(0);
pane.setOptions(new Object[]{}); 
```

它很丑，而且完全依赖于 ProgressMonitor 的实现。所以你应该检查 ClassCastException 和 null。

为什么需要将两个时间段都设置为 0？否则，不会在 setProgress 中创建对话框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-02T12:55:42.277

我知道这篇文章有点旧，但谷歌的第一个答案，所以我会发布我的答案......

我没有禁用取消按钮的解决方案，但我使用了这个提示：单击取消时重新显示进度监视器。

```
public void propertyChange (PropertyChangeEvent event) {
    if (event.getPropertyName().equals("progress")) {
        int progress = ((Integer) event.getNewValue()).intValue();
        lastProgress = progress;
        progressMonitor.setProgress(progress);
    }
    if (progressMonitor.isCanceled()) {
        progressMonitor = new ProgressMonitor(panel, "", "", 0, 100);
        progressMonitor.setMillisToDecideToPopup(0);
        progressMonitor.setMillisToPopup(0);
        progressMonitor.setProgress(lastProgress);
    }
} 
```

当然，您必须记住最后的进度值。

这个解决方案有点难看，但它对我有用。

伊夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T16:48:48.547

第一个问题是您为什么不希望用户能够取消操作？如果需要那么长时间，为什么他们不能决定他们不想等待呢？

如果您真的不想要取消按钮，您将不得不硬着头皮创建自己的进度对话框。您可以查看`ProgressMonitor`源代码以了解他们是如何做到的（他们将 a`JOptionPane`用于对话框并将其传递给一对`Strings`和 a `JProgressBar`）。

# oop - 在 OCaml 中即时创建对象

> ID：512157
> 
> 赞同：4
> 
> 时间：2009-02-04T16:34:32.070
> 
> 标签：oop, functional-programming, ocaml

我正在尝试通过使用编译代码而不是顶级代码来学习 OCaml；然而，网上的大部分示例代码似乎更适合后者。

我想在下面的对象的方法中创建一个新的 Foo 。此代码无法编译，引用 doFooProc 定义的语法错误。

```
class bar =
object (self)
 method doFooProc = (new Foo "test")#process
end;;

class foo (param1:string)=
object (self)
 method process = Printf.printf "%s\n" "Processing!"
 initializer Printf.printf "Initializing with param = %s\n" param1
end;; 
```

此外，“let”语法在类定义中似乎并不友好。这是为什么？

```
class bar =
object (self)
 method doFooProc = 
  let xxx = (new Foo "test");
  xxx#process
end;;

class foo (param1:string)=
object (self)
 method process = Printf.printf "%s\n" "Processing!"
 initializer Printf.printf "Initializing with param = %s\n" param1
end;; 
```

如何在 doFooProc 方法中创建类 foo 的新对象并调用实例化的 foo 的 process 命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T18:37:03.320

您大多是正确的，但要么将语法与模块系统混淆，要么考虑其他语言。以我的考虑，你应该很好！

> 我想在下面的对象的方法中创建一个新的 Foo 。此代码无法编译，引用 doFooProc 定义的语法错误。

对象的小写“foo”，模块是大写的。此外，您必须将 foo 的定义放在调用它的对象之上。如果发生这种情况，您应该得到一个`Unbound class foo`。

```
class bar =
object (self)
 method doFooProc = (new foo "test")#process
end;; 
```

> 此外，“let”语法在类定义中似乎并不友好。这是为什么？

因为你没有匹配`in`，而是你有一个分号。然后它将起作用。此外，您可以删除那些额外的括号，但这并不重要。

```
class bar =
object (self)
 method doFooProc = 
  let xxx = (new Foo "test") in
  xxx#process
end;; 
```

> 比如说，如果 foo 中的一个方法也实例化了一个 bar，那么有没有办法避免在源文件中对类定义进行排序时出现的问题？

是的。这就像编写相互递归的函数和模块一样，您将它们与`and`关键字连接起来。

```
class bar =
  object (self)
    method doFooProc = (new foo "test")#process
  end

and foo (param1:string) = 
  object (self)
    method process = Printf.printf "%s\n" "Processing!"
    initializer Printf.printf "Initializing with param = %s\n" param1
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:34:00.787

对于两个相互递归的类，使用 and 关键字

```
class bar =
  object (self)
    method doFooProc = 
      let xxx = (new foo "test") in
      xxx#process
  end
and foo (param1:string)=
  object (self)
    method process = Printf.printf "%s\n" "Processing!"
    initializer Printf.printf "Initializing with param = %s\n" param1
    method bar = new bar
  end;;` 
```

# .net - .NET 中的声明式线程安全

> ID：512164
> 
> 赞同：4
> 
> 时间：2009-02-04T16:38:32.093
> 
> 标签：.net, multithreading, functional-programming, remoting, declarative

我需要使现有的应用程序线程安全。由于情况（见下文），我决定为整个业务对象图使用一个 ReaderWriterLock。所有方法/属性必须如下所示：

```
public int MyReadOperation(string inputParam)
{
   rwLock.AcquireReaderLock(10000);
   try
   {
      // do all read operations
      ...
   }
   finally
   {
      rwLock.ReleaseReaderLock();
   }
}

public void MyWriteOperation(string input)
{
   rwLock.AcquireWriterLock(10000);
   try
   {
      // do all write operations
      ...
   }
   finally
   {
      rwLock.ReleaseWriterLock();
   }

} 
```

但是我有大量的方法可以覆盖，我被复制/粘贴的想法吓坏了。受 MethodImplAttribute 的启发，我希望有这样的代码，而其行为与上面的代码一样：

```
[ReadOperation]
public int MyReadOperation(string inputParam)
{
   // do all read operations
   ...
}

[WriteOperation]    
public void MyWriteOperation(string input)
{
   // do all write operations
   ...
} 
```

有没有办法在进入属性或方法并添加线程安全预防措施之前/之后中断线程执行？或者以某种方式利用 C# 的函数式语言特性，将方法的生产主体嵌入到获取“框架”的通用 ReaderWriterLock 中？

一点背景：

我正在开发一个通过 .NET Remoting 公开数据载体业务对象的项目。但是，这些数据类不是可序列化的，而是 MarshalByRef-s。这意味着所有客户端实际上读/写完全相同的业务对象。这是无法改变的，它是刻在石头上的。线程安全的希望是这些远程业务对象在远程客户端的眼中是只读的（认为它们确实循环了许多列表）并且所有写入操作都很好地分离到一个专用的外观中。我期待罕见的写入和频繁的读取。业务对象高度连接，它们非常“图形化”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T16:41:10.213

[我会使用PostSharp](http://www.postsharp.org/aop-net/overview)做类似的事情。

它作为一个额外的构建步骤运行并插入相应的 MSIL，但它会做你想做的事。PostSharp 属性定义看起来像这样（取决于您的具体实现）。然后可以按照您上面的描述使用这些。

```
public sealed class ReadOperationAttribute : OnMethodBoundaryAspect
{
  // not quite sure how you manage your lock, so put this dummy method in.
  ReaderWriterLock _rwLock = ReaderWriterLock.GetCorrectReaderWriterLock();

  [ThreadStatic]
  static bool _isLocked;

  public override void OnEntry( MethodExecutionEventArgs e )
  {
    try
    {
        _rwLock.AcquireReaderLock(10000);
        _isLocked = true;
    }
    catch
    {
        _isLocked = false;
        throw;
    }
  } 

  public override void OnExit( MethodExecutionEventArgs e )
  {    
      if (_isLocked) 
      {
          _rwLock.ReleaseReaderLock();
          _isLocked = false;
      }
  } 
}

public sealed class WriteOperationAttribute : OnMethodBoundaryAspect
{
  // not quite sure how you manage your lock, so put this dummy method in.
  ReaderWriterLock _rwLock = ReaderWriterLock.GetCorrectReaderWriterLock();

  [ThreadStatic]
  static bool _isLocked;

  public override void OnEntry( MethodExecutionEventArgs e )
  {
     try
    {
        _rwLock.AcquireWriterLock(10000);
        _isLocked = true;
    }
    catch
    {
        _isLocked = false;
        throw;
    }
  } 

  public override void OnExit( MethodExecutionEventArgs e )
  {
      if (_isLocked) 
      {
          _rwLock.ReleaseReaderLock();
          _isLocked = false;
      }
  } 
} 
```

编辑：更新以解决问题。（未经测试；））另外，请注意，正如我在对问题的评论中所说，微软[建议](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)`ReaderWriterLockSlim`优先使用`ReaderWriterLock`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T13:10:05.270

首先，感谢 Andrew 将我指向 [PostSharp](http://www.postsharp.org/ "PostSharp")。根据他的回答，我最终得到了这个。

```
[Serializable]
public class ReadOperationAttribute : PostSharp.Laos.OnMethodInvocationAspect
{
    public override void  OnInvocation(MethodInvocationEventArgs eventArgs)
    {
        ReaderWriterLock rwLock = GetLock();
        rwLock.AcquireReaderLock(10000);
        try { eventArgs.Proceed(); }
        finally { rwLock.ReleaseReaderLock();}
    }
}
public class Foo
{
    [ReadOperation]
    public string Bar
    {

        get { return "stuff"; }
        set { Console.WriteLine(value); }
    }

    [ReadOperation]
    public void Test(string input)
    {
        Console.WriteLine(input);
    }
} 
```

它完全按照我在问题中表达的方式进行，并且完全可以调试。如果我们声明整个程序集的属性，我们可以使它更加有用：

```
[assembly: ReadOperation(AttributeTargetElements=MulticastTargets.Method,
AttributeTargetTypes="MyNamespace.*")] 
```

这样我们就不必装饰每个方法/属性，但是将这个属性放置在程序集中一次，我们用 ReaderWriterLock 对所有方法/属性进行制动。

此外，正如 Andrew 所指出的，如果您使用 .NET3.5 或更高版本，Microsoft 建议使用 ReaderWriterLockSlim。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:40:44.237

使用构建后步骤可能是一个很好的解决方案。在纯代码中，我会像这样在 ReaderWriterLock 上创建扩展方法：

```
public static void ReadLock(this ReaderWriterLock l, Action f) {
  l.AquireReaderLock();
  try { f(); }
  finally { l.ReleaseReaderLock(); }
} 
```

和一个写。如果锁是真正的全局锁，你甚至可以创建静态方法。然后你的代码看起来不那么烦人了：

```
public void DoSomething() {
  theLock.ReadLock( () => {
  // Existing code
  });
} 
```

这具有细粒度的好处，因此不需要同步的部分方法将不会同步。但是，它仍然需要对每种方法进行更改。幸运的是，它们相对较小，并且您最终要更改的所有锁定代码至少都在一个地方。

# c# - foreach 标识符和闭包

> ID：512166
> 
> 赞同：79
> 
> 时间：2009-02-04T16:39:26.177
> 
> 标签：c#, enumeration, closures

在以下两个片段中，第一个是安全的还是必须做第二个？

安全我的意思是每个线程都保证从创建线程的同一个循环迭代中调用 Foo 上的方法？

还是必须将对新变量“本地”的引用复制到循环的每次迭代中？

```
var threads = new List<Thread>();
foreach (Foo f in ListOfFoo)
{      
    Thread thread = new Thread(() => f.DoSomething());
    threads.Add(thread);
    thread.Start();
} 
```

-

```
var threads = new List<Thread>();
foreach (Foo f in ListOfFoo)
{      
    Foo f2 = f;
    Thread thread = new Thread(() => f2.DoSomething());
    threads.Add(thread);
    thread.Start();
} 
```

**更新：**正如 Jon Skeet 的回答所指出的，这与线程没有任何关系。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-02-04T17:02:01.653

编辑：这一切都在 C# 5 中发生了变化，改变了变量的定义位置（在编译器的眼中）。从**C# 5 开始，它们是相同的**.

* * *

**在 C#5 之前**

二是安全；第一个不是。

使用`foreach`，变量在循环**外**声明- 即

```
Foo f;
while(iterator.MoveNext())
{
     f = iterator.Current;
    // do something with f
} 
```

这意味着就`f`闭包范围而言只有 1 个，并且线程很可能会感到困惑——在某些实例上多次调用该方法，而在其他实例上则根本不调用。您可以使用循环*内*的第二个变量声明来解决此问题：

```
foreach(Foo f in ...) {
    Foo tmp = f;
    // do something with tmp
} 
```

然后，这在每个闭包范围中都有一个单独`tmp`的，因此不存在此问题的风险。

这是问题的简单证明：

```
 static void Main()
    {
        int[] data = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };
        foreach (int i in data)
        {
            new Thread(() => Console.WriteLine(i)).Start();
        }
        Console.ReadLine();
    } 
```

输出（随机）：

```
1
3
4
4
5
7
7
8
9
9 
```

添加一个临时变量，它可以工作：

```
 foreach (int i in data)
        {
            int j = i;
            new Thread(() => Console.WriteLine(j)).Start();
        } 
```

（每个数字一次，但当然不能保证顺序）

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-02-04T17:17:36.770

Pop Catalin 和 Marc Gravell 的答案是正确的。我只想添加一个链接，指向[我关于闭包的文章](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)（其中讨论了 Java 和 C#）。只是觉得它可能会增加一点价值。

编辑：我认为值得举一个不具有线程不可预测性的示例。这是一个简短但完整的程序，展示了这两种方法。“不良行为”列表打印 10 次十次；“好行为”列表从 0 到 9 计数。

```
using System;
using System.Collections.Generic;

class Test
{
    static void Main() 
    {
        List<Action> badActions = new List<Action>();
        List<Action> goodActions = new List<Action>();
        for (int i=0; i < 10; i++)
        {
            int copy = i;
            badActions.Add(() => Console.WriteLine(i));
            goodActions.Add(() => Console.WriteLine(copy));
        }
        Console.WriteLine("Bad actions:");
        foreach (Action action in badActions)
        {
            action();
        }
        Console.WriteLine("Good actions:");
        foreach (Action action in goodActions)
        {
            action();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-04T16:57:52.333

您需要使用选项 2，围绕变化的变量创建闭包将在使用变量时使用变量的值，而不是在创建闭包时使用。

[C# 中匿名方法的实现及其后果（第 1 部分）](http://blogs.msdn.com/oldnewthing/archive/2006/08/02/686456.aspx)

[C# 中匿名方法的实现及其后果（第 2 部分）](http://blogs.msdn.com/oldnewthing/archive/2006/08/03/687529.aspx)

[C# 中匿名方法的实现及其后果（第 3 部分）](http://blogs.msdn.com/oldnewthing/archive/2006/08/04/688527.aspx)

编辑：为了清楚起见，在 C# 中，闭包是“**词法闭包**”，这意味着它们不捕获变量的值，而是捕获变量本身。这意味着当为变化的变量创建闭包时，闭包实际上是对变量的引用，而不是其值的副本。

Edit2：如果有人有兴趣阅读有关编译器内部的内容，则添加指向所有博客文章的链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T17:20:34.800

这是一个有趣的问题，似乎我们已经看到人们以各种方式回答。我的印象是第二种方式将是唯一安全的方式。我做了一个真正的快速证明：

```
class Foo
{
    private int _id;
    public Foo(int id)
    {
        _id = id;
    }
    public void DoSomething()
    {
        Console.WriteLine(string.Format("Thread: {0} Id: {1}", Thread.CurrentThread.ManagedThreadId, this._id));
    }
}
class Program
{
    static void Main(string[] args)
    {
        var ListOfFoo = new List<Foo>();
        ListOfFoo.Add(new Foo(1));
        ListOfFoo.Add(new Foo(2));
        ListOfFoo.Add(new Foo(3));
        ListOfFoo.Add(new Foo(4));

        var threads = new List<Thread>();
        foreach (Foo f in ListOfFoo)
        {
            Thread thread = new Thread(() => f.DoSomething());
            threads.Add(thread);
            thread.Start();
        }
    }
} 
```

如果你运行它，你会看到选项 1 绝对不安全。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-20T12:55:35.110

在您的情况下，您可以通过将您映射`ListOfFoo`到一系列线程来避免该问题，而无需使用复制技巧：

```
var threads = ListOfFoo.Select(foo => new Thread(() => foo.DoSomething()));
foreach (var t in threads)
{
    t.Start();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-18T17:38:33.067

从 C# 版本 5（.NET 框架 4.5）开始，两者都是安全的。有关详细信息，请参阅此问题：[C# 5 中是否更改了 foreach 对变量的使用？](https://stackoverflow.com/questions/12112881/has-foreachs-use-of-variables-been-changed-in-c-sharp-5)

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-02-04T16:47:15.803

```
Foo f2 = f; 
```

指向相同的参考

```
f 
```

所以什么都没有失去，也没有任何收获......

# c# - Deitel 现场课程 C# 2008

> ID：512167
> 
> 赞同：1
> 
> 时间：2009-02-04T16:39:42.777
> 
> 标签：c#, resources

我一直试图通过书籍更好地理解 C#，但我倾向于通过有人向我解释它们来更快地学习东西。有没有人尝试过任何 Deitel 现场课程 DVD，特别是 C# 2008 集？只是想知道是否有人对他们有任何意见。谢谢！

乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T19:23:48.717

我真的可以向您推荐这些 DVD，我自己拥有它们，它们非常全面，当我将偏好从 Delphi 切换到 C# 时，它们帮助我理解了 C# 开发的基本原则。

# python - 如何使用 Python 将目录及其内容复制到现有位置？

> ID：512173
> 
> 赞同：33
> 
> 时间：2009-02-04T16:41:12.803
> 
> 标签：python, operating-system, filesystems, copy

我正在尝试将目录及其所有内容复制到已经存在的路径中。问题是，在 os 模块和 shutil 模块之间，似乎没有办法做到这一点。该`shutil.copytree()`函数期望目标路径事先不存在。

我正在寻找的确切结果是将整个文件夹结构复制到另一个之上，在找到的任何重复项上静默覆盖。在我开始编写自己的函数来执行此操作之前，我想我会问是否有人知道这样做的现有食谱或片段。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-04T17:03:21.463

[`distutils.dir_util.copy_tree`](http://docs.python.org/distutils/apiref.html#distutils.dir_util.copy_tree)做你想做的事。

> 将整个目录树 src 复制到新位置 dst。src 和 dst 都必须是目录名。如果 src 不是目录，则引发 DistutilsFileError。如果 dst 不存在，则使用 mkpath() 创建它。复制的最终结果是src中的每个文件都复制到dst，src下的目录递归复制到dst。使用它们的输出名称返回已复制或可能已复制的文件列表。返回值不受 update 或 dry_run 影响：它只是 src 下所有文件的列表，名称更改为 dst 下。

（以上网址中的更多文档）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:56:19.763

为什么不使用自己实现它`os.walk`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T22:06:33.070

对于像这样的高级文件操作，请使用[shutil](http://docs.python.org/library/shutil.html)模块，在您的情况下使用 copytree 函数。我认为这比“滥用” distutils 更干净。

**更新：：**忘记答案，我忽略了OP确实尝试了shutil。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T16:08:51.540

您是否收到“无法在目录已存在时创建目录”的错误消息？我不确定这有多傻，但我所做的只是在 copytree 模块中插入一行：我改变了：

```
def copytree(src, dst, symlinks=False):
    names = os.listdir(src)
    os.makedirs(dst) 
```

进入：

```
def copytree(src, dst, symlinks=False):
    names = os.listdir(src)
    if (os.path.isdir(dst)==False):
        os.makedirs(dst) 
```

我想我做了一些更愚蠢的事情。如果是这样，有人可以指出我吗？抱歉，我对 python 很陌生：P

# excel - 非 Web SQL 注入

> ID：512174
> 
> 赞同：21
> 
> 时间：2009-02-04T16:41:50.260
> 
> 标签：excel, vba, ms-access, sql-injection

SQL 注入攻击似乎有些歇斯底里。最近，这里

[如何根据另一字段中的查找值返回一个字段中的值](https://stackoverflow.com/questions/505838/vba-simple-database-query-from-word)

如果我在 Excel 中创建一个连接到 Access 数据库的宏，我真的需要担心 SQL 注入吗？它不在网络上，而是在我的办公室使用（你们还记得台式机吗？）。我不担心我的同事会破坏我。如果他们足够聪明，可以进行 SQL 注入，难道他们还不够聪明，可以破解我的插件密码并更改代码吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-04T16:49:11.150

如果您在宏中构建 SQL，它很容易受到 SQL 注入的影响。即使您信任将使用该东西的人，您也应该至少注意基础知识，例如尝试将单引号和分号字符放入数据库字段的人。在您的情况下，这不仅仅是数据验证的安全问题。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-04T16:56:23.117

**SQL 注入不仅是一种安全威胁，它也是一个非常真实的错误来源。**

您**确定**您的任何记录都不会包含撇号 (') 吗？

```
INSERT INTO NAMES (FIRSTNAME, LASTNAME) VALUES('Jack', 'O'Neill') 
```

在这种情况下，即使没有人想破解您的系统，您也会遇到错误。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-04T20:54:11.577

你永远不知道 bobby tables 什么时候会使用你的 word 宏：

[![xkcd](https://imgs.xkcd.com/comics/exploits_of_a_mom.png "她的女儿叫Help，我被困在一家驾照工厂。")](http://xkcd.com/327/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-06T22:01:36.680

我想扩展我在上面针对 onedaywhen 的帖子所做的评论，该帖子概述了如何利用 MS Access 中的 SELECT 语句。请记住，这些*不是*关于如何防止 SQL 注入的概括性评论，而是专门适用于 MS Access 中的编程。

我从来没有见过任何 Access 的示例代码，它会允许利用 onedaywhen 概述的那种 SELECT 漏洞。这样做的原因是，几乎从来没有这样的情况，您会使用如此简单的方法来收集标准，而无需在途中某处对输入进行一些验证，不是为了避免 SQL 注入，而是为了避免由无效 SQL 引起的错误。

这是实现此最简单版本的代码：

```
Public Sub TestSQLExploit()
  Dim strSQL As String

  strSQL = "SELECT tblInventory.* FROM tblInventory WHERE InventoryID = "
  strSQL = strSQL & InputBox("Enter InventoryID")
  Debug.Print strSQL
End Sub 
```

因此，传递 "10036 or 'a' = 'a'" 会产生以下 SQL：

```
SELECT tblInventory.*
FROM tblInventory
WHERE InventoryID=10036 Or 'a'='a' 
```

而且这绝对*不好*！

现在，我永远不会那样写我的代码，因为我总是希望允许多个值。相反，如果我使用 InputBox() 函数来收集用户输入（老实说，我从来没有这样做过，因为它太难以验证），我会使用 Application.BuildCriteria 来编写 WHERE 子句，因为这样我就可以处理多个标准值。这将导致以下代码：

```
Public Sub TestSQLExploit1()
  Dim strSQL As String
  Dim strWhere As String

  strSQL = "SELECT tblInventory.* FROM tblInventory "
  strWhere = "WHERE " & Application.BuildCriteria("tblInventory.InventoryID", _
      dbLong, InputBox("Enter InventoryID"))
  strSQL = strSQL & strWhere
  Debug.Print strSQL
End Sub 
```

老实说，我认为 Application.BuildCriteria 会对此抛出错误，但事实并非如此，并且当通过“10036 or 'a' = 'a'”时会产生完全相同的 SQL。正如您所说，由于 Jet 表达服务的工作方式，它将是完全开放的。

现在，我从来没有真正写过这样的动态 SQL，因为我只是不喜欢 InputBox() 函数，正是因为你必须编写一堆代码来验证输入。如果你像上面的代码那样使用它，你必须做很多事情来确保它是有效的。

我从未见过任何不建议使用参数化 SQL（这当然可以避免问题）或 Query-By-Form 接口的此类操作的 Access 代码示例。我通常不会在 Access 中使用保存的参数查询，因为我喜欢将保存的查询编写为在任何地方都可以使用。这意味着它们大多没有具有在运行时更改的标准的 WHERE 子句。当我使用这些保存的查询时，我会为适当的情况提供 WHERE 子句，无论是作为表单中的记录源还是作为列表框或下拉列表的行源。

现在，这里的重点是，在这些情况下，我不是要求用户输入，而是从 Access 对象（例如表单上的控件）中提取标准值。现在，在大多数情况下，这将是表单上的一个控件，它只有一个目的——为某种形式的过滤收集标准。该表单上不会有未经验证的自由文本字段——日期字段将具有输入掩码（这会将输入限制为有效日期），并且有效值数量有限的字段将具有将选择限制为有效的控制类型数据。通常这类似于下拉菜单或选项组。

这种设计的原因不一定是为了避免 SQL 注入（尽管它会阻止这种情况），而是为了确保用户不会因输入无效且不会产生任何结果的条件而感到沮丧。

现在，另一个考虑因素是，有时您*确实*希望使用一些纯文本字段，以便用户可以输入某种尚未受到限制的数据（例如查找姓名）。只是看看我的一些应用程序的名称查找例程和未经验证的文本字段，我发现我很好，因为在这些情况下我*不*使用 BuildCriteria，因为它旨在一次只收集一个标准（尽管用户可以输入“*”来检索多条记录）。

如果我有一个文本框，用户在其中输入“fent* or 'a' = 'a'”，并且我在 WHERE 子句中使用它：

```
WHERE tblDonor.LName Like "fent* or 'a' = 'a'" 
```

结果是什么都找不到。如果用户输入“fent* 或 a = a”，它仍然不起作用，因为它是一个文本字段，我在它周围使用了双引号。如果用户输入：

```
fent* or "a" = "a" 
```

这也会中断，因为当我的代码在它周围加上双引号时，WHERE 子句将无效。

现在，在只使用 use 输入并在其周围加上双引号的情况下，很明显输入以下内容：

```
" Or "fent*" or "a" = "a" Or " 
```

会导致：

```
WHERE tblDonor.LName Like "" Or "fent*" or "a" = "a" Or "" 
```

那将是非常糟糕的，因为它会返回所有内容。但是在我现有的应用程序中，我已经从用户输入中清除了双引号（因为双引号在 LName 字段中理论上是有效的），所以我的应用程序构造了这个 WHERE 子句：

```
WHERE tblDonor.LName Like "? Or ?fent*? or ?a? = ?a? Or ?*" 
```

那不会返回任何行。

但它没有的原因*不是*因为我试图避免 SQL 注入，而是因为我希望用户能够查找其中嵌入了双引号的名称。

======

一些结论：

1.  过滤数据时从不接受用户的自由格式输入——相反，使用预先验证输入的控件（例如，带有输入掩码的文本框、下拉列表、选项组）并将其限制为您知道有效的值。

2.  当从没有限制的文本框中接受数据时，请避免使用 Application.BuildCriteria，它会以用户可以欺骗您的应用程序返回所有行的方式处理输入（尽管这是漏洞可以做的范围）。

这实际上意味着，如果要收集多个标准，则需要以用户只能从预选值中进行选择的方式进行。最简单的方法是使用多选列表框（或一对带有 ADD>> 和 <<REMOVE 命令按钮的列表框）。

当然，您是否需要担心这种 SELECT 漏洞利用取决于所检索数据的重要性和隐私级别，以及返回给用户的确切内容。当以不可编辑的形式（例如，报告）呈现数据时，冒着返回所有非敏感数据行的风险可能没有问题，而如果您以可编辑的形式呈现它并且有人更改了不应该的数据，则可能会出现问题。 t 被编辑。

但是对于非敏感数据，用户返回的数据是否过多通常根本无关紧要（性能问题除外，例如，服务器超载——但最好以其他方式处理）。

所以，我对这一切的看法：

1.  永远不要使用 InputBox() 来收集标准（这个我已经避免了）。

2.  始终使用尽可能限制性的控制类型来收集标准（这已经是我经常做的事情）。

3.  如果使用文本框来收集字符串数据，无论用户输入什么，都将其视为单一标准。

这确实意味着我有一些应用程序，用户可以在其中输入“或'a'='a'”以及有效的标准并返回所有行，但在这些应用程序中，这根本不是问题，因为数据不敏感。

但这很好地提醒我不要自满。我原以为 Application.BuildCriteria 会保护我，但现在意识到 Jet 表达式服务在 WHERE 子句中接受的内容过于宽容。

2009/12/08 编辑：刚刚在 MS Access 中的 SQL 注入中找到了这些链接。所有这些都是针对 Web 注入的，因此不能直接适用于非 Web SQL 注入的讨论（其中许多在交互式 Access 中会浪费时间，因为您已经可以访问大量的蛮力信息 -例如，有关文件系统、路径、可执行文件等的信息），但许多技术也适用于 Access 应用程序。此外，从 Access 执行会打开许多​​无法从 ODBC/OLEDB 运行的功能。深思熟虑。

*   [通过访问访问 (PDF)](http://www.insomniasec.com/publications/Access-Through-Access.pdf)
*   [测试 MS Access](http://www.owasp.org/index.php/Testing_for_MS_Access)
*   [MS Access SQL 注入备忘单](http://www.xuexi123.net/chm/MS%20Access%20SQL%20Injection%20Cheat%20Sheet.htm)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-04T16:49:40.103

老实说，如果这是您正在谈论的现有应用程序，我不会去重写它。但是，如果您正在开发它，我认为使用参数化查询而不是替代方法很难。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T16:45:11.440

作为开发人员，您有责任（如果不是全部的话）至少部分地对您的应用程序所持有的数据的安全性负责。

无论您的应用程序是在线的还是仅在您的办公室使用，都是如此。尽一切可能确保您的数据存储是密封的。

归根结底，您不想成为必须向老板解释去年销售数据去向的人。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-04T16:50:22.847

物理安全始终是数据安全的第一道防线。如果您的应用程序只打算在办公室内分发，并且访问的数据价值不足以让某人去麻烦和窃取和破解的费用，那么您可以遵守比在外部使用更低的安全标准 -面向 Web 应用程序。

但是，真正的安全最终是关于可能发生的事情，而不是我们期望发生的事情。如果您的应用程序处理公众委托给您的数据（SSN、信用卡号等），或者如果它是对您的公司至关重要的唯一数据存储库，则您必须考虑潜在的恶意用户可能对您的代码执行哪些操作未来。今天快乐的员工就是明天心怀不满的反社会者。

一个好的经验法则是问问自己：如果我对这个产品有充分的了解，想用它来伤害我的公司，我能造成多大的损失？然后，建立足够的安全性以将该数字降低到可容忍的水平。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-04T16:50:25.407

不。（是的。）是的。:)

很多时候，我看到开发人员在加固“前门”上浪费了宝贵的资源，却没有注意到后面的摆动纱门。这通常类似于将前端强化到不安全的后端，强化基本上对不同用户开放的应用程序等等......

就安全性做出一揽子声明固然很好，但它必须符合要求。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-04T16:47:13.027

IMO 如果您的系统将暴露给可能希望造成伤害的人（例如在 Internet 上），那么您确实应该防止 SQL 注入。

另一方面，如果它是一个内部系统，任何可以访问 SQL 注入的恶意用户也可能以其他方式损害它，那么它真的没那么重要。

我自己编写了易受 SQL 注入攻击的代码，但唯一拥有这种访问权限的人是拥有 SQL 访问权限的同事。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T16:48:37.330

尽管我们都希望应用程序不受任何和所有攻击的影响，但开发所有防弹功能所花费的时间必须与额外的好处一起权衡。如果您可以合理地预期安全要求不会很高，那么这可能是您可能想要传递的东西。如果您认为这可能是值得担心的事情，也许您现在应该采取措施防止这种可能性，而不必再担心了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T16:54:26.147

> 如果我在 Excel 中创建一个连接到 Access 数据库的宏，我真的需要担心 SQL 注入吗？

也许。这取决于，真的。我个人不会担心，但是您要存储什么样的数据，它的敏感性是多少？

> 如果他们足够聪明，可以进行 SQL 注入，难道他们还不够聪明，可以破解我的插件密码并更改代码吗？

也许。仅仅因为有人可以进行 sql 注入并不意味着他们足够聪明，可以破解您的加载项密码。另一方面，他们可能是。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-05T04:32:36.893

有人可以使用 Jet 数据库作为后端发布用于 SQL 注入的上下文证明 Excel VBA 代码吗？[或者在如何根据另一个字段中的查找值返回一个字段中的值](https://stackoverflow.com/questions/505838/vba-simple-database-query-from-word)（而不是仅仅破坏代码）中准确地演示哪些参数可以传递给代码？

鉴于 Jet 无法执行由“;”分隔的多个 SQL 语句，我很难想象任何带有 Jet 后端的 SQL 注入威胁。但也许那是因为我不像黑客那样富有想象力。

哦，一个免费的线索（关于传统 SQL 注入以外的危险主题）：

1.  Access 表达式服务无法通过 ODBC 获得。

2.  它*可以*通过 DDE 获得，但我不知道您是否可以通过 DDE 将 SQL 传递给 Access（我在大约 10 年内没有将 DDE 与 Access 一起使用）。

3.  如果您对 Access 和 Jet 表达式服务一无所知，那么您可能没有资格回答有关 Jet（和 Access）的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-05T09:27:55.577

迪克，这取决于你如何处理参数。这是一个如何不做事的 VBA 示例：

```
Friend Function DeleteAnAccount() As Boolean

  Const SQL_DELETE_AN_ACCOUNT As String * 50 = _
      "DELETE FROM Accounts WHERE account_owner_ID = '?';"

  Dim sql As String
  sql = Replace$(SQL_DELETE_AN_ACCOUNT, "?", txtAccountOwnerID.Text)

  m_Connection.Execute sql

End Function 
```

考虑一下，如果某些人不是在文本框 (txtAccountOwnerID) 中输入他们的帐户 ID，而是实际输入了以下内容：

```
dummy' OR 'a' = 'a 
```

那么生成的 SQL 字符串将是这样的：

```
DELETE FROM Accounts WHERE account_owner_ID = 'dummy' OR 'a' = 'a'; 
```

不好，因为`'a' = 'a'`谓词将解析为`TRUE`并且所有帐户都将被删除。

更好的是使用使用参数对象的准备好的语句，例如 ADODB.Command 对象。

杰米。

--

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-06T22:49:12.590

三点：

1.  使用参数化查询通常比逃避可能破坏 SQL 的方法（例如，O'Neill 先生）更少工作，这样您就可以直接将数据连接到查询字符串中。如果更强大的选项也可以减少实施工作，那么您为什么*不想*这样做呢？

2.  我已经很久没有使用 Jet 了，所以我不知道它现在是否支持预先准备好的语句，但是，如果您要多次运行该语句，请使用参数化查询并重新运行它具有不同的参数将比每次构建新查询更快。

3.  即使所有用户都是 100% 值得信赖的，并且永远不会因为不满而试图造成任何损害，但始终存在拼写错误或其他真正错误的可能性。防止用户错误通常被认为是一件好事。

因此，您绝对应该使用参数化查询，如 Spolsky 对另一个问题的回复所示，即使不是为了安全起见。它们不仅更安全，而且更耐错误，通常编写速度更快，并且对于重复查询具有更高的性能。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-07T07:48:12.737

**>使用参数化查询并使用不同的参数重新运行它会比每次构建新查询更快。**

实际上，如果您谈论查询性能，它不会提高 jet 的性能。事实上，从 JET 白皮书《性能概述和优化技术》中，我们得到了这个宝石：

**第 18 页**

**由于存储查询具有预编译的查询计划，因此在索引列上包含参数的参数化查询可能无法有效执行。由于查询引擎事先不知道要传入参数的值，因此只能猜测最有效的查询计划。根据我们检查过的客户性能场景，我们发现在某些情况下，可以通过将存储的参数化查询替换为临时查询来实现显着的性能提升。这意味着在代码中创建 SQL 字符串并将其传递给 DAO OpenRecordset 或 Database 对象的 Execute 方法**

整洁哦？而且，我经历过以上！

请记住，查询计划的编译时间无论如何都在 1000 秒内。我的意思是，实际上，查询计划时间从 0.01 到 0.0001。当然，它快了 100 倍，但这只是为我们节省了 100 分之一秒。我们运行一个需要 2 秒的报告，因此查询计划时间甚至不是问题。

我们今天有 GOBS 的处理。磁盘驱动器、内存和网络 I/O 速度是瓶颈。我们也没有为提交给 JET 的每个新 sql 字符串浪费服务器 sql 查询缓存的问题。无论如何，这些内联 sql 查询计划都不会被缓存。而且，更重要的 JET 是基于客户端的引擎，因此当您的办公室局域网上有 10 个用户时，每台机器上都有 10 个 JET 副本在本地运行。查询计划缓存不是 sql server 的问题。

正如上面的 jet 白皮书所示（以及我的经验），通过强制重新编译不带参数的 sql 来获得更好的查询计划的好处超过了具有参数的预编译查询计划的好处。

但是，要保持正轨，必须同意大卫的观点。我不认为当您使用 odbc 时，或者在这种情况下使用 dao 对象模型 + jet，我无法想出任何方式来注入真正的 sql 语句。

也许可以通过上面的“蹩脚” InputBox() 示例输入可能产生意外结果的条件。正如所指出的，内置访问的应用程序并不经常以这种方式工作。

对于删除记录之类的事情，您正在查看一个表单，它将有一个自定义菜单栏（或现在的功能区），或者只是一个放置在表单上的删除按钮。因此，用户不能为这种类型的删除代码输入错误数据。

更重要的是，当我们经常接受用户在表单上的输入时，请记住我们的表单具有内置的数据掩码。毕竟，这正是 MS Access 的设计初衷。因此，如果我们要求输入电话号码，则用户不能为该输入掩码输入字母甚至任何非数字字符。该掩码甚至会在该电话号码的适当位置放置 () 和 – 以进行显示，但只有数字才会出现在用户的实际输入中。

对于大多数其他类型的提示，我们使用组合框、lisbox 和其他 UI 元素，这再次限制了用户将表单允许的内容以外的内容注入该文本框中的能力。

由于如此丰富的屏蔽和输入能力远远超出了大多数屏幕构建器，因此注入对于基于 MS 访问的应用程序来说是很少见的话题。

如果有人可以展示一个 JET 示例，其中用户可以通过注入执行 sql 语句，我全神贯注，因为我认为 dao + jet 不可能。

对于一个 MS-access 应用程序来说，这可能是可能的，但再次强调，在实际实践中，非常困难。

# java - 最佳实践：在 setUp() 或声明时初始化 JUnit 类字段？

> ID：512184
> 
> 赞同：133
> 
> 时间：2009-02-04T16:44:06.700
> 
> 标签：java, junit

我应该像这样在声明中初始化类字段吗？

```
public class SomeTest extends TestCase
{
    private final List list = new ArrayList();

    public void testPopulateList()
    {
        // Add stuff to the list
        // Assert the list contains what I expect
    }
} 
```

或者像这样在 setUp() 中？

```
public class SomeTest extends TestCase
{
    private List list;

    @Override
    protected void setUp() throws Exception
    {
        super.setUp();
        this.list = new ArrayList();
    }

    public void testPopulateList()
    {
        // Add stuff to the list
        // Assert the list contains what I expect
    }
} 
```

我倾向于使用第一种形式，因为它更简洁，并且允许我使用最终字段。如果我*不需要*使用 setUp() 方法进行设置，我还应该使用它吗，为什么？

**澄清：** JUnit 将为每个测试方法实例化一次测试类。这意味着`list`每次测试都会创建一次，无论我在哪里声明它。这也意味着测试之间没有时间依赖性。因此，使用 setUp() 似乎没有任何优势。但是 JUnit 常见问题解答中有许多在 setUp() 中初始化空集合的示例，所以我认为一定是有原因的。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-02-08T17:39:24.150

如果您特别想知道 JUnit 常见问题解答中的示例，例如[基本测试模板](http://junit.sourceforge.net/doc/faq/faq.htm#tests_16)，我认为展示的最佳实践是应该在您的 setUp 方法（或测试方法）中实例化*被测类*.

当 JUnit 示例在 setUp 方法中创建 ArrayList 时，它们都会继续测试该 ArrayList 的行为，例如 testIndexOutOfBoundException、testEmptyCollection 等。有人编写课程并确保其正常工作的观点。

在测试您自己的类时，您可能应该这样做：在 setUp 或测试方法中创建您的对象，这样如果您以后破坏它，您将能够获得合理的输出。

另一方面，如果您在测试代码中使用 Java 集合类（或其他库类），可能不是因为您想测试它——它只是测试夹具的一部分。在这种情况下，您可以放心地假设它按预期工作，因此在声明中对其进行初始化不会有问题。

对于它的价值，我在一个相当大的、有几年历史的、由 TDD 开发的代码库上工作。我们习惯性地在测试代码的声明中初始化东西，在我从事这个项目的一年半里，它从未引起过问题。所以至少有一些轶事证据表明这是一件合理的事情。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-02-04T17:53:08.323

我开始挖掘自己，发现使用`setUp()`. 如果在执行期间抛出任何异常`setUp()`，JUnit 将打印一个非常有用的堆栈跟踪。另一方面，如果在对象构造过程中抛出异常，错误消息只是说 JUnit 无法实例化测试用例并且您看不到发生故障的行号，可能是因为 JUnit 使用反射来实例化测试类。

这些都不适用于创建空集合的示例，因为它永远不会抛出，但这是该`setUp()`方法的一个优点。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-04T17:22:26.230

除了亚历克斯 B 的回答。

甚至需要使用 setUp 方法来实例化处于某种状态的资源。在构造函数中执行此操作不仅是时间问题，而且由于 JUnit 运行测试的方式，每个测试状态在运行后都会被删除。

JUnit 首先为每个测试方法创建 testClass 的实例，并在每个实例创建后开始运行测试。在运行测试方法之前，先运行它的 setup 方法，在其中可以准备一些状态。

如果数据库状态将在构造函数中创建，则所有实例将在运行每个测试之前立即实例化数据库状态。在第二个测试中，测试将以脏状态运行。

JUnit 生命周期：

1.  为每个测试方法创建不同的测试类实例
2.  对每个 testclass 实例重复：调用 setup + 调用 testmethod

通过使用两种测试方法在测试中进行一些日志记录，您将获得：（数字是哈希码）

*   创建新实例：5718203
*   创建新实例：5947506
*   设置：5718203
*   测试一：5718203
*   设置：5947506
*   测试二：5947506

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-04-23T23:39:58.250

在 JUnit 4 中：

*   对于*被测类*，在一个方法中初始化[`@Before`](http://junit.sourceforge.net/javadoc/org/junit/Before.html)，以捕获失败。
*   对于*其他类*，在声明中初始化...
    *   ...为简洁起见，并标记字段`final`，完全按照问题中的说明，
    *   ...除非是可能失败的*复杂初始化*，在这种情况下使用`@Before`, 来捕获失败。
*   对于*全局状态*（尤其是*缓慢*的初始化，如数据库），请使用`@BeforeClass`，但*要注意*测试之间的依赖关系。
*   *单个测试*中使用的对象的初始化当然应该在测试方法本身中完成。

在方法或测试方法中进行初始化`@Before`可以让您获得更好的失败错误报告。这对于实例化被测类（可能会中断）特别有用，但对于调用外部系统也很有用，例如文件系统访问（“找不到文件”）或连接到数据库（“连接被拒绝”）。

有一个简单的标准并且总是使用（清楚的错误但冗长）或总是在声明中初始化（简洁但给出令人困惑的错误）是*可以接受*`@Before`的，因为复杂的编码规则很难遵循，这没什么大不了的。

初始化`setUp`是 JUnit 3 的遗留物，其中所有测试实例都被急切地初始化，如果您进行昂贵的初始化，这会导致问题（速度、内存、资源耗尽）。因此，最佳实践是在 中进行昂贵的初始化`setUp`，这仅在执行测试时运行。这不再适用，因此使用`setUp`.

这总结了其他几个埋没问题的回复，特别是 Craig P. Motlin（问题本身和自我回答）、Moss Collum（被测类）和 dsaff。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-06-01T13:53:42.700

*在 JUnit 3 中，在运行任何测试之前*，您的字段初始值设定项将在每个测试方法中运行一次。只要您的字段值在内存中很小，只需很少的设置时间，并且不影响全局状态，使用字段初始化器在技术上就可以了。但是，如果这些不成立，您最终可能会在第一次测试运行之前消耗大量内存或时间来设置您的字段，甚至可能会耗尽内存。出于这个原因，许多开发人员总是在 setUp() 方法中设置字段值，它总是安全的，即使它不是绝对必要的。

请注意，在 JUnit 4 中，测试对象初始化发生在测试运行之前，因此使用字段初始化器更安全，并且是推荐的样式。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-07T04:53:54.680

在您的情况下（创建列表）在实践中没有区别。但通常最好使用 setUp()，因为这将有助于 Junit 正确报告异常。如果在测试的构造函数/初始化程序中发生异常，则为测试*失败*。但是，如果在设置过程中出现异常，自然会认为这是设置测试的问题，而 junit 会适当地报告它。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-04T16:52:53.483

我首先更喜欢可读性，它通常不使用设置方法。当基本设置操作需要很长时间并且在每个测试中重复时，我会例外。
那时，我使用`@BeforeClass`注释将该功能移动到设置方法中（稍后进行优化）。

使用 setup 方法进行优化的示例`@BeforeClass`：我使用 dbunit 进行一些数据库功能测试。setup 方法负责将数据库置于已知状态（非常慢...... 30 秒 - 2 分钟，具体取决于数据量）。我在带有注释的设置方法中加载这些数据，`@BeforeClass`然后针对同一组数据运行 10-20 次测试，而不是在每个测试中重新加载/初始化数据库。

使用 Junit 3.8（扩展 TestCase 如您的示例所示）需要编写比添加注释更多的代码，但“在类设置之前运行一次”仍然是可能的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-08T00:52:39.050

由于每个测试都是独立执行的，并且使用对象的新实例，因此除了在`setUp()`单个测试和`tearDown()`. 这是使用该`setUp()`方法很好的原因之一（除了其他人给出的原因）。

注意：让 JUnit 测试对象保持静态状态是个坏主意！如果您在测试中将静态变量用于跟踪或诊断目的以外的任何其他目的，那么您将使 JUnit 的部分目的无效，即测试可以（并且可以）以任何顺序运行，每个测试都以清新、干净的状态。

使用的优点`setUp()`是您不必在每个测试方法中剪切和粘贴初始化代码，并且您在构造函数中没有测试设置代码。在你的情况下，差别不大。只需创建一个空列表就可以安全地显示它或在构造函数中完成，因为它是一个微不足道的初始化。`Exception`但是，正如您和其他人所指出的那样，应该完成任何可能引发的事情，`setUp()`以便在失败时获得诊断堆栈转储。

在您的情况下，您只是创建一个空列表，我会按照您的建议进行操作：在声明点分配新列表。特别是因为`final`如果这对您的测试课程有意义，您可以选择标记它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-12T20:43:51.920

*   常量值（在夹具或断言中使用）应该在它们的声明中初始化并且`final`（因为永远不会改变）

*   被测对象应该在 setup 方法中初始化，因为我们可以设置一些东西。当然，我们现在可能不设置某些东西，但我们可以稍后设置。在 init 方法中实例化将简化更改。

*   如果这些被模拟对象的依赖关系，甚至不应该由你自己实例化：今天模拟框架可以通过反射来实例化它。

不依赖于 mock 的测试可能如下所示：

```
public class SomeTest {

    Some some; //instance under test
    static final String GENERIC_ID = "123";
    static final String PREFIX_URL_WS = "http://foo.com/ws";

    @Before
    public void beforeEach() {
       some = new Some(new Foo(), new Bar());
    } 

    @Test
    public void populateList()
         ...
    }
} 
```

具有隔离依赖项的测试可能如下所示：

```
@RunWith(org.mockito.runners.MockitoJUnitRunner.class)
public class SomeTest {

    Some some; //instance under test
    static final String GENERIC_ID = "123";
    static final String PREFIX_URL_WS = "http://foo.com/ws";

    @Mock
    Foo fooMock;

    @Mock
    Bar barMock;

    @Before
    public void beforeEach() {
       some = new Some(fooMock, barMock);
    }

    @Test
    public void populateList()
         ...
    }
} 
```

# c# - Problem writing to a file from webserver

> ID：512195
> 
> 赞同：0
> 
> 时间：2009-02-04T16:48:01.590
> 
> 标签：c#, asp.net, file

One requirement of a project I'm working on is to export a file to a network share based on certain criteria. When I run the code in visual studio it works just fine but when I deploy it the actions that would initiate saving the file end in failure. the users see an alert with:

```
Could not find file '<full filename...>'. 
```

In the web.config I set impersonate to true and the users have permission to write to the network share in question.

Here is the code to write to the file:

```
using (System.IO.FileStream fs = new System.IO.FileStream(fullpath, System.IO.FileMode.Create))
{
    using (System.IO.StreamWriter sw = new System.IO.StreamWriter(fs))
    {
        sw.WriteLine(RouteMeter.HeaderString);
        foreach (RouteMeter meter in rm)
        {
            sw.WriteLine(meter);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:09:43.793

有许多变量可能导致用户模拟失败，在这种情况下，IIS 将尝试以匿名用户身份执行操作。您是否在尝试写入文件之前验证用户是否已正确验证？

> 如果为 ASP.NET 应用程序启用了模拟，则该应用程序将在其访问令牌 IIS 传递给 ASP.NET 的身份的上下文中运行。该令牌可以是经过身份验证的用户令牌，例如登录 Windows 用户 *的令牌，也可以是 IIS 为匿名用户提供的令牌*（通常是 IUSR_MACHINENAME 身份）。
> 
> [http://msdn.microsoft.com/en-us/library/xh507fc5.aspx](http://msdn.microsoft.com/en-us/library/xh507fc5.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:57:21.210

我怀疑这里更好的方法是将应用程序池的身份设置为可以访问（没有模拟）。此外，请确保您使用的是 UNC 路径 - 而不是网络共享名称（“\\foo\bar”，而不是“f:”等）。

# sql - Question about a query

> ID：512196
> 
> 赞同：0
> 
> 时间：2009-02-04T16:48:14.710
> 
> 标签：sql

```
$sql = "SELECT count(u_id) AS num_replies FROM `replies` WHERE `u_id`='".$uid."'";
$res = mysql_query($sql) or die(myqsl_error()); 
```

Will that return the number of replies a user with id $uid has made? If not, can anyone suggest something that will?

Thx for the help.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T16:49:54.860

It difficult to answer this question without knowing more about the replies table, but just looking at your query, then yes your query looks like it will.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-15T02:41:07.303

请出于对互联网的热爱，不要自己构建 SQL 查询。使用[PDO](http://php.net/pdo)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:52:17.760

`$ssql = "SELECT count(*) AS num_replies FROM replies WHERE u_id = $uid";
$rres = mysql_query($ssql);` 

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T16:52:52.127

It will return the number of records in the table with that u_id. Doesn't matter what you put in the paretheses. You don't need any GROUP BY clause.

# migration - 什么是 Boost Jam，Jam 是否值得迁移？

> ID：512202
> 
> 赞同：18
> 
> 时间：2009-02-04T16:49:17.017
> 
> 标签：migration, build-system, jam, bjam

什么是 Boost Jam，Jam 是否值得迁移？

我知道 jam 是 perforce 构建的构建系统，但是我不确定 boost jam 和常规 jam 有何不同。

我也希望 SO 社区中有人与它合作过，也许可以突出一些差异和/或好处。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-09-25T04:12:20.107

I use Boost Jam for my cross-platform C++ development. I chose it because

*   I want my code to build everywhere Boost builds,
*   it uses a relatively simple declarative language to specify how to build targets, and
*   it can build all the different flavors of your binaries (e.g. debug vs. release, 32-bit vs. 64-bit, msvc vs. gcc) in a single invocation with an absolute minimum of flavor-related exceptions in the build declarations.

You can refine generic rules with flavor-specific settings, rather than writing separate rules for each flavor permutation. The syntax isn't exactly what I would have chosen, but it's not too hard to get used to.

This paper compares Boost Jam to CMake, SCons, and Eclipse CDT: [http://syrcose.ispras.ru/2009/files/04_paper.pdf](http://syrcose.ispras.ru/2009/files/04_paper.pdf)

My understanding is that Boost Jam is an offshoot of Perforce Jam maintained by the Boost community, and that Perforce Jam isn't actively maintained anymore (the [release notes](http://public.perforce.com/public/jam/src/RELNOTES) have the last update in April 2003).

Of course, if you don't care about cross-platform development, there are easier ways to go, as others have mentioned here. Personally, I keep meaning to revisit Eclipse CDT; it didn't seem usable 5 years ago, but I hear it has come a long way.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-18T14:47:46.233

正如您所说，Boost Jam 是一个构建系统，可以独立于任何其他 boost 库使用。我对 Perforce Jam 一无所知，但据我了解，Boost jam 非常相似，而且大多兼容。

The main difference is that Boost Jam often comes with [Boost Build](http://www.boost.org/doc/tools/build/index.html), a collection of jam rules designed for common tasks, e.g. compiling libraries, running unit tests, creating doxygen documentation, etc.

Compared to other build systems, Boost Jam/Boost Build is designed for easily compilation of different variants. So if you want to change compilation settings from debug to release, or single- to multi-threaded, it determines a lot of the changes automatically.

The drawback is that the syntax is very finicky, and outside the boost website, there's no good documentation. But I imagine Perforce Jam is just as bad in that regard.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-18T15:00:59.260

Given the choice of build tools I would not migrate to jam. There are better build systems out there - CMake / SCons for C/C++, qmake for Qt, Ant for Java, NAnt and MSBuild for .NET, and so on. They might not be technically superior but they will be less painful to use simply because far more people are familiar with them (on the other hand, they might be technically superior, of course :D).

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-08T22:57:39.210

出于我的目的，它只是为您构建 boost 库的东西，我不知道您可以用它做任何其他事情，所以我不明白迁移到它意味着什么。我很抱歉，但我不知道普通果酱是什么。由于没有其他人提供答案，我只提供我对它的理解。

Boost 是 C++ 的类和函数的集合，可用于各种任务。boost 的类和函数被分组到库中。一些库的所有代码都在头文件中，您可以通过使用#include 预处理器语句简单地使用它们，而其他库（例如文件系统或正则表达式库）在 .cpp 文件中具有部分实现。

编译这些 .cpp 文件可能需要很长时间（大约需要 30 分钟，具体取决于您正在编译的内容），如果每次您想重新编译程序都需要半个小时，那将是一个真正的痛苦。所以他们所做的只是对那些部分存储在.cpp文件中的库，你可以将它们预编译成.lib文件，这就是boost jam的目的。这意味着你只需要花半个小时编译**一次**，从那以后你再也不用等半个小时了。

然而，正如你可以想象的那样，每个 boost 库都由许多 cpp 文件和许多头文件组成，并且每个文件都有许多不同的风格（调试版本、发布版本、多线程等），因此这不是一个简单的过程只需自己编译 boost 库。这就是 boost jam 的用武之地。你给它编译库的命令，然后它为你发出所有命令给编译器，到最后，你将拥有一组预编译的 .lib 文件，其中一个用于每个库的每种不同风味。头文件以某种方式告诉链接器要包含哪些 lib 文件，因此如果您设置了正确的路径，预编译的 .lib 文件的正确风格将自动链接到您的程序，从而为您节省 30 分钟的编译时间。

您可以通过查看此页面了解 boost jam 需要编译哪些库以及不需要编译哪些库：http: [//www.boost.org/doc/libs/1_37_0](http://www.boost.org/doc/libs/1_37_0) - 如果库不需要 lib 文件（因此不需要你先搞砸 boost jam），它会说“Build & Link: Header only”，而如果一个库确实需要你预编译一个 lib 文件，它会说“Build & Link: Automatic linking”。

此外，如果您使用的是 Windows，则可以下载预编译的 .lib 文件，这样您就不必使用 boost jam。为此，您应该访问 www.boost.org 页面，转到“入门”部分并一直遵循它，以确保您已正确设置所有内容。该页面的 Windows 版本上的链接之一告诉您在哪里可以找到预编译的 .lib 文件。

# virtual-pc - VirtualPC：无法启动任何东西

> ID：512212
> 
> 赞同：0
> 
> 时间：2009-02-04T16:50:58.277
> 
> 标签：virtual-pc

我正在玩[VirtualPC](http://www.microsoft.com/downloads/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2dc0b40a73b6&displaylang=en)并按照[Phil Haack 的说明](http://haacked.com/archive/2007/05/06/installing-ubuntu-on-virtual-pc-for-windows-lovers.aspx)来了解如何让 ubuntu（因为为什么不呢？）在其上运行。

我启动了我的虚拟电脑，在启动过程中它只是停留在显示 DHCP 的行上......

捕获 ubuntu iso 并没有改变这一点，最终它告诉我重新启动并选择正确的启动设备 - 再次 - 什么都不做。

我觉得我必须错过一些步骤......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:24:04.840

你在bios里把cd-rom设置为第一个设备吗？是的，你必须这样做，他们认为这很有趣。

# language-agnostic - 消除编译器警告是个好主意吗？

> ID：512222
> 
> 赞同：16
> 
> 时间：2009-02-04T16:53:28.113
> 
> 标签：language-agnostic, warnings

过去，我使用 -Wall 和其他 gcc 开关来消除我参与的项目的每个编译器警告。类似地，在 Perl 中，我总是使用 use strict 和 use 警告进行编程（通常也是 -T ) 尽量达到最好的代码质量。我知道几年前，Perl 搬运工小组努力使 perl 本身（Perl 解释器）在 gcc 下干净地编译并启用所有警告。显然，他们认为这是提高代码质量的好主意。我还了解到，现在 Perl 程序员已经使用 Perl::Critic 在他们的代码中添加了更多警告，当他们违反 Damian Conway 的 Perl Best Practices 书中的最佳实践时会发出警告（我相信来自其他来源）。

对于这样清理的代码，我总是有一种很好的感觉，但有时我无法避免有些工作有点浪费的感觉。例如，在十多年前的 C 入门课程中，我被教导要像这样启动我的 main() 函数：

```
void main(void) { 
```

这是最小的，只能在您没有返回值并且没有访问您的参数时使用。在这种情况下它工作得很好，但是 gcc 警告会让你知道这个函数真的应该看起来像：

```
int main(int args, char* argv) { 
```

那天我一定已经输入了几百个未使用的 int args, char* argv 行。我真的让我的代码变得更好，还是只是把我的手指磨短了？

现在我在 Eclipse 中用 Java 编程，我们的项目有数以万计的警告。我想把它们清理干净。其中一些特别难以理解和消除，但我正在慢慢学习。其中一些我不得不使用编译器指令来处理以抑制警告（通常以极小的最小方法来排除忽略警告的不良做法），但我也在寻找处理这些的方法。

这值得程序员的时间吗？如果您跟踪每一个编译器警告，项目真的会更好吗？

如果不出意外，将警告的数量减少到零似乎会很好，这样严重的警告就不会在混乱中丢失。

**注意**：[这个问题的重复](https://stackoverflow.com/questions/183788/c-c-compiler-warnings-do-you-clean-up-all-your-code-to-remove-them-or-leave)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-04T16:57:23.223

当然是。警告表明您的代码可能有问题。要么你修复它，要么你应该禁用警告——如果你不打算对它采取行动，警告只是阻止你检测新警告何时出现。

获取并保持代码无警告的最简单方法是始终使用 -Werror（Visual Studio 中的 /WX）或等效项进行编译。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T16:57:53.690

> 这值得程序员的时间吗？如果您跟踪每一个编译器警告，项目真的会更好吗？

是的。即使是关于符号不匹配的琐碎问题也会对代码生成和优化产生深远影响。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-04T17:12:57.983

我同意所有说“全部解决”的答案，但我仍然想提出相反的观点：

有一些遗留系统，其中一些（许多或全部）组件没有专门的维护者，并且系统的大部分基本上是未知的。修复此类未知代码中的编译器警告可能需要大量代码（因为对于每个警告，都需要了解代码及其上下文）并引入可能的错误来源（某些代码*取决于*未定义的行为）。而且由于此类遗留系统很少有广泛的测试覆盖率，您甚至不能依靠测试来通知您回归。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-04T17:01:31.187

C 中的 main 有两个兼容的原型。

```
int main(void) 
```

和

```
int main(int argc, char **argv) 
```

`void main(void)`在技​​术上并不正确，尽管某些编译器可能会支持它作为标准的扩展。

因此，在您的特定情况下，您可以使用一个简短的声明，`main`并且如果符合，它不会触发警告。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-04T17:03:24.973

是的。即使是微不足道的也值得修复。这就是为什么。有些，例如您提到的 main 示例，可能不值得自己修复，但它们是总体上的。从长远来看，大多数编译器警告都会为您省去直接的痛苦。它们是等待发生（甚至现在发生）的错误。为了找到它们，您需要一种简单的方法来注意到它们。如果您修复了所有警告，那么每个新警告都是一个危险信号并且很容易注意到。如果你修复了所有的关键问题，但只留下一些像“主要”问题一样，你将错过新的关键问题。

哪个更容易记住？是否需要修复任何警告，或者您昨天在此代码库中有 23 个不相关的警告，所以如果您看到 24 个，您需要去看看吗？

在我处理的代码库中，我们告诉编译器在所有警告上生成错误。这迫使我们修复它们并使代码保持更好的状态。如果有真正不值得修复的警告，总有#pragma 让它消失。这样你仍然有一条失败的明线。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-04T17:02:02.527

**是的，这样做..**

就在昨天，我为工作中的一个项目这样做了。在删除警告时，我遇到了两个问题，结果证明是真正的错误。

这是一个 C 项目，在一个源代码中调用了 sqrt（平方根）。我收到以下警告：

```
test.c:4: warning: implicit declaration of function 'sqrt' 
```

原来，编码器忘记包含正确的头文件，平方根是用整数参数调用的，而不是浮点数。这显然是错误的，不是他的本意。

该警告已经存在了很长一段时间，但没有人看到它，因为它在刚刚滚动到屏幕上的其他 1000 个无害警告中丢失了。 **警告是有原因的。**

顺便说一句 - 修复警告花了我...... 4 小时......与编写所有这些东西所花费的时间相比，这算不了什么。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-04T17:20:37.500

我将在这里反对包并说可能存在一些不值得修复的编译器警告。示例如下：

我们有大量在 Java 1.5 和泛型之前编写的代码。它仍然有效。Eclipse 还会生成数以千计的关于未参数化集合的警告。实际上，所有这些集合的范围都是有限的；他们永远不会破裂。但是等等，你可能会问；那少数几个不受范围限制的系列*呢*？你不是在冒着收集某个地方的风险，其中包含一个永远不应该进入那里的东西的实例吗？

回应是：很多代码也没有改变。这是传统的；没有新代码正在修改这些集合，并且该代码已使用多年而没有问题。它仍在我们的代码库中，如果出现错误，我们将不得不维护它，但实际上，它已经完成了它的工作。花必要的时间参数化所有这些通用集合将占用其他所需项目的时间。

请注意此处的警告，然后：

*   该代码已经使用了很长时间，没有报告任何错误。
*   该代码未进行任何实质性编辑。

如果其中任何一个不再是真的——例如，一个错误突然出现，我们必须进入并编辑——警告突然变得更值得修复*。*（顺便说一句，此时修复它们的成本也非常低；我们可以在修复错误的过程中修复相关块。）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T16:57:44.377

它将节省编译器写出警告的时间，并且如果您减少代码中无意义的警告数量，则更容易找到潜在的危险警告。是否值得花时间寻找每个警告并修复它？通常不会……但是当警告明显且易于修复时，或者当您出于其他原因需要花时间更改包含警告的逻辑时，值得修复警告。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-04T17:00:35.840

Eclipse、IntelliJ 和其他现代代码质量系统有大量可用的警告。

清理警告是一种有用的做法，如果没有其他原因，只是为了消除噪音。您的代码可能已经有一些真正的错误。

但是，许多警告可能是虚假的。来自 Eclipse 的一些警告是诸如微优化或风格挑剔之类的东西。这意味着您的一些清理工作必须调整工具的设置，而不是代码更改或本地化抑制指令。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-04T17:01:00.313

我的意见。是的。

就像你最后说的。它有助于使真正的错误更加突出。

当您在 Apache 服务器上运行输出警告的 Perl cgi 脚本时，警告会记录在 error.log 中。为什么要浪费空间。修复警告。

此外，我认为这是一种更好地理解语言和编译器的学习体验。在我开始使用 strict 之前，我没有意识到动态作用域甚至是 Perl 的一个特性。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-04T17:07:10.007

您的示例很好地说明了为什么不应忽略警告。`void main(void)`是无效的原型（但`int main(void)`有效！））并且您的代码可能会在某些编译器上中断。你的编译器很好地指出了这一点。

我发现几乎*每个*警告实际上都指向了一个真正的问题，即使我当时未能理解原因。基本上，我总是做某事并打算做其他事情。无论如何，效果可能已经实现，但纯属巧合。

将警告视为错误。存在异常（VB.NET 编译器中有一个关于未初始化值类型的异常），但极为罕见。如果您偶然发现这些例外之一，您就会*知道*。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-04T17:27:45.720

您应该始终尝试在编译时不出现警告。这样，新的警告就会引起注意。（我在这方面最令人沮丧的经历是 2002 年的 AIX C++ 编译器，它针对没有大量模板化的代码发出了数百条警告。）

了解每个警告的含义。在您的情况下，您应该输入 standard`int main()`而不是不正确`void main(void)`或 clumsier `int main(int argc, char **argv)`。消除你能做的，并压制你认为可以接受的警告。

您可能不想修复所有警告。正如 saua 所说，有些遗留系统修复警告是非常危险的，而像 CGAL 这样的复杂系统，你也不想弄乱代码。在将我们的应用程序转换为在 64 位下运行时，我发现我只能通过强制转换来消除警告，这可能会导致其他问题。我们压制了那个警告。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-04T17:42:40.963

只是为了添加警告，以下是 gnome 开发人员在其代码中使用的内容：

[http://blogs.gnome.org/otte/2008/12/22/warning-options/](http://blogs.gnome.org/otte/2008/12/22/warning-options/)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-04T23:14:37.987

确保您的代码在没有警告的情况下编译的另一个原因是，如果其他人*必须在将来某个时候对代码进行更改，那么一个好的开始是确保他们可以在当前版本中编译代码形式。

但是，如果他们这样做并看到很多警告，这些警告是一直存在的，还是他们在 PC 上错误地安装了编译器？

至少如果有一个规则（如果你使用一个复选框，在清单上打勾）代码必须在没有警告的情况下编译，那么你就可以避免这种歧义。

（* 其他人可能包括你未来的自己）。

# vba - 非连续范围

> ID：512223
> 
> 赞同：2
> 
> 时间：2009-02-04T16:53:41.313
> 
> 标签：vba, excel

我可以将范围对象设置为等于一组非顺序单元格吗？我希望我的范围等于单元格 A1、A3、A5 等，我可以在其中随意选择行和列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:00:52.157

当然，例如，这会选择一组相当随机的单元格：

```
Range("A1:C8,E13:G21,C20:D26,L13:N22").Select 
```

这将选择您提到的单元格：

```
Range("A1,A3,A5").Select 
```

您还可以将**Range**对象与**Union**方法结合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:01:59.893

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa174290(office.11).aspx)：

联合法

使用 Union(range1, range2, ...) 返回多区域范围，即由两个或多个连续单元格块组成的范围。下面的示例创建一个定义为范围 A1:B2 和 C3:D4 的并集的对象，然后选择定义的范围。

```
Dim r1 As Range, r2 As Range, myMultiAreaRange As Range
Worksheets("sheet1").Activate
Set r1 = Range("A1:B2")
Set r2 = Range("C3:D4")
Set myMultiAreaRange = Union(r1, r2) 
```

# jquery - 使用我在 jQuery 中的切换功能为图像设置动画

> ID：512225
> 
> 赞同：0
> 
> 时间：2009-02-04T16:54:04.540
> 
> 标签：jquery, animation

我已经制作了`Toggle()`交替图像的功能（按下时将图像更改为不同的颜色）。

我现在想为图像*设置动画*，所以基本上调用我的`Toggle()`函数，但在调用之间留有时间延迟，使其看起来像过渡/动画。

最好的方法是什么？

注意：我已经有了函数代码，我只需要一种方法来调用具有时间延迟等的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:03:47.330

在 Javascript 中实现时间延迟的方法是设置超时：

```
setTimeout(function(){alert("hi")}, 3000); 
```

第一个参数是一个将在延迟后执行的函数（您可以传递一个匿名函数，如此处所示，也可以在某个对象上传递一个命名函数，例如：“MyThing.doSomething”）。第二个参数是以毫秒为单位的所需延迟。

有关 Javascript 中计时器的详细分析，请参阅[John Resig 的 Javascript 计时器的工作原理](http://ejohn.org/blog/how-javascript-timers-work/)。

# state-machine - 您是否曾经必须创建有限状态机？

> ID：512228
> 
> 赞同：3
> 
> 时间：2009-02-04T16:55:02.870
> 
> 标签：state-machine

这不包括你可能在大学里做过的有限状态机。

我想知道谁必须创建一个，为什么？

制造这台机器最困难的方面是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T16:58:49.960

是的，很多。基本上，出于性能原因，我不得不手动实现词法分析器。其他个人用途是在 GUI 设计中，其中 FSA 控制了与用户的交互流程。

*制造*这样的机器一点也不难。*更改*它们是因为 FSA 的至少一部分结构被严格地嵌入在代码中。[状态模式](http://en.wikipedia.org/wiki/State_pattern)有助于缓解其中一些转换——但不是全部。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T17:23:38.490

很多次！

通信系统中使用的大多数协议栈都是作为状态机实现的。CSTA 呼叫模型就是一个很好的例子。

此外，大多数嵌入式系统本质上都是状态机。

基本上，任何必须对现实世界中的事件做出反应的系统都是作为状态机实现的良好候选者。

状态机最困难的事情是在没有最新文档的情况下理解它们的作用。他们倾向于将错误修复得面目全非。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T17:34:52.930

当然，我设计并制造了一个涡轮调速器来控制小型涡轮机、泵和电机。它是带有 DSP 芯片的嵌入式设备。它具有停止、启动、运行、超速测试等状态，然后在运行状态下有几种状态，以涵盖其他控制可能性。

在我的例子中，关于状态机管理最困难的部分是设计一个干净的转换，特别是当状态可以有子状态时。对于涡轮调速器，这意味着必须在转换之间平滑地调整速度输出（执行器）。其他挑战与用户界面（按钮和 7 段 LED 显示屏）以及它们如何与状态机交互有关。所以最终有一个主控制状态机、一个相关的用户界面状态机和一个相关的通信状态机（不允许在涡轮机运行时写入某些值）。

我在各种其他项目中使用过状态机，一些嵌入式和一些标准软件，以及从通信到用户界面软件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T17:16:17.540

如上所述，FSA 的目的只是一步一步地进行，所有处理（和状态更改）都在一个循环中处理。而且，当流程发生变化时，很容易进入下一个合乎逻辑的步骤。

是的，它们很容易做到，25 年来我经常使用它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T17:44:38.887

我也有。我通常创建小型 FSM（状态很少），因为较大的 FSM 会成为维护的噩梦，但有时 FSM 对于给定任务来说是一种非常简单而优雅的设计。

作为一个真实的例子，我创建了一个小工具来修复某种类型的文件。与用户只有 3 或 4 种可能的交互路径：

*   显示一条小消息，选择文件（可能取消并重新开始），
*   修复文件（可能取消并退出并显示错误消息），
*   显示确认消息。

创建状态机使这些路径变得明显且易于实现。

# image-processing - regarding image editing

> ID：512231
> 
> 赞同：0
> 
> 时间：2009-02-04T16:56:09.903
> 
> 标签：image-processing, image-manipulation, photoshop

I have a requirement where I need to erase a particular area of an image, but the constraint is that i shouldn't see white color in the area where I applied my eraser tool. The area where I used my eraser tool shouldn't look different from the rest of the image's background color.

For eg: ~~[http://www.hdwallpapers.net/gallery/thumbnails/computer/computer_0099_lightbox.jpg](http://www.hdwallpapers.net/gallery/thumbnails/computer/computer_0099_lightbox.jpg)~~

here you see windows icon in the middle, I want to remove that icon alone. In icon's place I need background color in such a manner that it matches with the rest of the image.

Could you suggest the steps and tools which i can use to achieve the same. I have adobe photoshop at present. can that be done using photoshop. If not, please suggest the tool which does that.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:12:12.447

好吧，你不能完美地做你想做的事。假设它是一个平面图像（只是像素数据），那么徽标下的信息就不存在了。

但是，您可以使用传统的橡皮擦工具擦除它，然后使用**克隆**工具来伪造背景*应该*是什么样子。

这不是一个真正的编程问题，所以它不属于这里，但我希望我有所帮助。

# java - Eclipse 中的自定义 TODO 标记

> ID：512235
> 
> 赞同：35
> 
> 时间：2009-02-04T16:56:36.597
> 
> 标签：java, eclipse, todo

在 Eclipse`// TODO`中，Java 文件中的注释将代码中的一个区域标记为一项任务，以供以后考虑。

有没有办法添加其他可以做同样的表达式？

例如，如果我想使用`// myprojectname`.

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-02-04T17:00:03.250

*窗口 > 首选项 > Java > 编译器 > 任务标签*

您可以将新标签添加到您心中的内容中。

* * *

注意：为什么 Eclipse 人把它作为*编译器*设置超出了我的理解。它只是让人们很难找到设置，所以它很少被定制。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-06T20:26:59.537

benjismith 和 j pimmel 的答案是完全有效和正确的。我只想补充一点，您可以使用 eclipse 简洁的首选项对话框功能找到此设置和其他设置：

当您通过“窗口/首选项”打开首选项对话框时，在左上角的文本字段中输入“todo”。选项树将仅限于匹配设置。

瞧

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T12:46:37.727

我在我的 Mac 机器上这样做了，

**Eclipse>首选项>Java>编译器>任务标签>新建**

现在进入**标签**并设置它的**优先级**（即**Normal**、**Low**或**High**）。

**应用>确定**

将弹出一个对话框并要求您进行完整的重建，告诉它*现在重建*。重建后你很高兴。

# active-directory - 将 InterAction 分发列表与 AD 分发列表同步

> ID：512238
> 
> 赞同：0
> 
> 时间：2009-02-04T16:57:00.823
> 
> 标签：active-directory, exchange-server, crm

我们需要允许用户直接通过电子邮件发送到 InterAction 中定义的邮件列表。

InterAction 似乎提供了创建这些邮件列表的功能，但您只能从 InterAction 客户端（Web 和 Windows）中向它们发送邮件。

我们真正需要的是有一种方法可以向“interactionGroup@company.com”发送电子邮件。

我最初的想法是启用 AD/InterAction 同步，并通过对 InterAction 的更改来填充（和更新）一个 AD 分发组，但这似乎只有一种方式，AD -> InterAction。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T18:32:19.283

我认为您的想法听起来像是实现您正在寻找的最佳/最可靠的方法。通过计划作业从 InterAction 填充 AD 组将允许您在任何应用程序中使用这些 AD 组。您必须记住在 InterAction 中维护这些组，而不是在 AD 中，否则您的更改将在下一次同步期间被覆盖。我建议将所有同步的 InterAction 组放在他们自己的 OU 中，以使它们与其他托管 AD 组分开。

# java - 使用 Mockito 验证方法后没有调用任何内容

> ID：512254
> 
> 赞同：51
> 
> 时间：2009-02-04T17:00:09.927
> 
> 标签：java, unit-testing, mocking, mockito

我正在使用 Mockito 在 Java 中编写单元测试，并且我想验证某个方法是否是对象上调用的*最后一个方法。*

我在被测代码中做这样的事情：

```
row.setSomething(value);
row.setSomethingElse(anotherValue);
row.editABunchMoreStuff();
row.saveToDatabase(); 
```

在我的模拟中，我不关心编辑行中所有内容的顺序，但重要的是我在保存后*不要*尝试对其进行任何操作。有没有好的方法来做到这一点？

请注意，我不是在寻找 verifyNoMoreInteractions：它不确认 saveToDatabase 是最后一个调用的东西，如果我在行上调用任何我没有明确验证的东西，它也会失败。我希望能够这样说：

```
verify(row).setSomething(value);
verify(row).setSomethingElse(anotherValue);
verifyTheLastThingCalledOn(row).saveToDatabase(); 
```

如果有帮助，我将从执行此操作的 JMock 测试切换到 Mockito：

```
row.expects(once()).method("saveToDatabase").id("save");
row.expects(never()).method(ANYTHING).after("save"); 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-05T03:43:07.383

我认为这需要更多的定制工作。

```
verify(row, new LastCall()).saveToDatabase(); 
```

进而

```
public class LastCall implements VerificationMode {
    public void verify(VerificationData data) {
        List<Invocation> invocations = data.getAllInvocations();
        InvocationMatcher matcher = data.getWanted();
        Invocation invocation = invocations.get(invocations.size() - 1);
        if (!matcher.matches(invocation)) throw new MockitoException("...");
    }
} 
```

上一个答案：

你说的对。verifyNoMoreInteractions 是您所需要的。

```
verify(row).setSomething(value);
verify(row).setSomethingElse(anotherValue);
verify(row).editABunchMoreStuff();
verify(row).saveToDatabase();
verifyNoMoreInteractions(row); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-01-27T14:20:00.370

不是 100% 的主题，但我只是想找到验证的反面，这是唯一相关的结果，最终我在 Mockito.verifyZeroInteractions(mock);

以防万一其他人最终在这里寻找这个......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-29T00:01:47.540

这个问题促使我对[JMockit中的](http://code.google.com/p/jmockit)*Verifications* API进行了一些增强（在即将发布的 0.983 版本中提供）。

我提出的解决方案允许您编写（在测试方法中）：

```
 new VerificationsInOrder() {{
        unverifiedInvocations();
        row.saveToDababase();
    }}; 
```

...如果您只想验证某个方法是否在其他所有操作之后被调用。要验证它在所有其他调用*之前*发生，只需将调用移至顶部。这实际上适用于任何连续调用序列。

如果除了上述验证之外，您还想验证是否以任意顺序调用了其他一些方法，则可以在测试中添加第二个*验证*块（在另一个块之前或之后，没关系）：

```
 new Verifications() {{
        row.setSomething(value);
        row.setSomethingElse(anotherValue);
    }}; 
```

虽然因为使用匿名内部类有点长，但这种语法既简单又灵活；注意它如何为测试添加结构并避免方法调用的重复（如`verify(...)`）。它比我在这里描述的要多（Hamcrest 匹配器、调用计数等），而且它不限于实例方法的验证（静态方法和构造函数可以以相同的方式进行模拟和验证）。

# javascript - JQuery 模态框和 iframe

> ID：512257
> 
> 赞同：19
> 
> 时间：2009-02-04T17:00:44.950
> 
> 标签：javascript, jquery, iframe, refresh, modal-dialog

我一直在使用 Simple Modal，我觉得它不能满足我目前的需要。

是否有支持加载外部文件并允许这些外部文件关闭模态框并将父页面重定向到某个 url 的模态框。

我想做的一个例子。您有一个用户列表，您可以单击“添加用户”并弹出一个带有表单的模态框，您填写并提交它。这将关闭该框并重新加载用户列表页面，以便您在列表中看到该用户。

然后您可以单击“编辑用户”，然后会弹出一个在表单字段中填写用户信息的模态框，您可以编辑、提交，它会关闭并刷新。

我知道如果我将用户信息表单作为每个用户的隐藏 div 可以做到这一点，但这不会很好地扩展，而且它是很多开销数据。

我[在 Google Code 上找到了一些关于此的代码](http://code.google.com/p/simplemodal/source/browse/branches/simplemodal-1.2/test/iframe.html?r=159)，但无法让它工作（可能是不同的简单模式版本

我也愿意换成另一个模态框工具。

更新：

Thickbox 或 Fancybox 是否支持从子 IFrame 元素关闭？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-24T21:03:23.707

听起来您已经找到了答案，但为了其他人的利益，您可以通过在 iFrame 中使用以下 JavaScript 来关闭 FancyBox 的 iFrame 实现：

```
parent.$.fn.fancybox.close(); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-05-08T21:01:03.743

下面是一个基本的对话框交互，将内容加载到 iFrame 中，然后从 iFrame 关闭对话框。

请注意，为了说明这一点，我有两个代码片段。第一个标记为file1.html。第二个你应该命名为“myPage.html”，如果你想让它工作并将它放在与第一个文件相同的目录中。

请注意，关闭对话框的调用可以根据您所需的功能以其他方式使用。例如，另一个示例可能是成功提交表单。

在您的系统上本地创建文件并打开 file1.html 并尝试一下。

**文件1.html**

```
<html>
    <head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.0/themes/base/jquery-ui.css"/>
    <script type="text/javascript">
      $(document).ready(function() {
            $("#modalDiv").dialog({
                modal: true,
                autoOpen: false,
                height: '180',
                width: '320',
                draggable: true,
                resizeable: true,   
                title: 'IFrame Modal Dialog'
            });
            $('#goToMyPage').click(
                function() {
                    url = 'myPage.html';
                    $("#modalDiv").dialog("open");
                    $("#modalIFrame").attr('src',url);
                    return false;
            });                 
      });
    </script>
    </head>
    <body>
        <a id="goToMyPage" href="#">Go to My Page</a>
        <div id="modalDiv"><iframe id="modalIFrame" width="100%" height="100%" marginWidth="0" marginHeight="0" frameBorder="0" scrolling="auto" title="Dialog Title"></iframe></div>
    </body>
</html> 
```

**我的页面.html**

```
<html>
    <head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.0/themes/base/jquery-ui.css"/>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#clickToClose').click(
                function() {
                    window.parent.$("#modalDiv").dialog('close');
                    return false;
            });
            // uncomment and use the below line close when document is ready (no click action by user needed)
            // the same call could be put elsewhere depending on desired functionality (after successful form submit, etc.)
            // window.parent.$("#modalDiv").dialog('close');                    
        });
    </script>
    </head>
    <body>
        <a id="clickToClose" href="#">Click to close.</a>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-04T17:17:48.067

[Fancybox](http://fancy.klade.lv/)也是另一种选择。工作原理类似于厚盒

**编辑：**

经过一番玩弄之后，该插件本身不支持通过子 iframe 元素关闭 Fancybox。我认为这肯定可以通过一点努力来实现（我开始[在这里](http://jsbin.com/epabi)***拼凑***一些东西，尽管我强调这只是一个 POC 并且不起作用，因为 iframe 中的按钮从 DOM 中删除了 fancybox div 包装器，因此没有当您再次单击谷歌图像时显示）。但是我想知道，如果 iframe 是正确的行。

对于添加用户，我的想法是您可以向用户展示一种模式表单，就像[您在单击“登录”时获得的 Monster 网站上的那种。](http://jobsearch.monster.co.uk/Browse.aspx)单击添加用户后，对数据源进行 AJAX 调用以插入新用户，然后返回成功后，您可以启动页面刷新或使用 AJAX 更新列表。

对于编辑用户，一旦选择了用户，您可以使用用户 ID 进行 AJAX 调用，以在 AJAX 调用返回成功时使用从数据源检索到的用户详细信息填充模式表单。完成用户编辑后，进行 AJAX 调用以更新数据源，然后再次启动页面刷新或使用 AJAX 更新列表。

您可以简单地使用 JavaScript/jQuery 来更新列表/列表详细信息，而不是在每个场景中进行页面刷新或最终 AJAX 调用，具体取决于用户是否已被添加或编辑。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-18T23:50:44.747

`parent.$.modal.close();`适用于简单的模态插件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T09:42:36.860

我已经为我找到了解决方案，它使用的是 nyroModal。它支持 iframe 并使用此代码通过其 iframe 子项关闭模式。

```
parent.$.nyroModalRemove(); 
```

我将接受 Russ Cam 的回答给他更多的代表，因为他的回答让我思考了很多关于这将如何工作并最终让我找到答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-28T10:51:33.910

这是我用萤火虫跟踪时的对话框脚本

```
<iframe> 
       scrolling="auto" 
       height="100%" 
       frameborder="0" 
       width="100%" 
       title="Dialog Title" 
       marginheight="0" 
       marginwidth="0" 
       id="modalIFrame"
       src="test.php" 
</iframe> 
```

我需要将高度更改为 95%，因为对话框滚动始终在屏幕 TT 中可见

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T17:04:40.697

你试过[厚盒](http://jquery.com/demo/thickbox/)吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-16T20:39:33.457

我的 FrameDialog 将允许这样做，它基本上在 Dialog 上扩展......如果您使用相同的域，您应该能够调用 $.FrameDialog.close() 但是，如果您正在重定向，您可以简单地重定向父母。window.parent.location 会做。

[http://plugins.jquery.com/project/jquery-framedialog](http://plugins.jquery.com/project/jquery-framedialog)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-16T11:38:29.160

嗨，任何在 Wordpress 3.0 中使用手动安装 Fancy Box 来关闭 Fancy Box iFrame 时遇到问题的人：

在您的 iframe 中使用此链接：

```
<a href="#" onClick="parent.jQuery.fancybox.close();" title="Close window">close fancybox</a> 
```

有用 ：）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-06-01T13:54:23.077

这对我有用...

```
<input name="Envoyer" value="Annuler" type="button" onclick="javascript:window.parent.$.fancybox.close();" /> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-21T07:25:05.583

试试[colorbox](http://www.jacklmoore.com/colorbox)，它也是一个不错的选择。

# cocoa-touch - iPhone SDK 有没有像样的 OpenGL 文本绘图库？

> ID：512258
> 
> 赞同：24
> 
> 时间：2009-02-04T17:00:48.740
> 
> 标签：cocoa-touch, opengl-es, freetype

我试图找出一个简单的在OpenGL中绘制一些文本。我的研究表明这是一项相当复杂的任务。它涉及创建（或在运行时生成）字体图集纹理，然后为每个字母创建一个具有正确位置和纹理坐标的四边形。

我听说过一些关于 freetype 的好消息，但几乎没有发现如何让它在 iPhone 上运行，而且它似乎相当复杂。

那么是否有任何 Objective-C 包装的 OpenGL 文本库可以与人们一直在使用的 iPhone SDK 一起使用？还是我只是在想这个并且我缺少一种更简单的方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-04T18:46:00.150

一种方法是设置 UILabel，然后将其图层渲染为纹理。对此的间接途径是首先使用文本、字体等设置 UILabel，然后使用以下代码

```
UIGraphicsBeginImageContext(yourLabel.frame.size);
[yourLabel.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *layerImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

将 UILabel 捕获到 UIImage。然后，您可以使用 CrashLanding 项目中 Texture2D 类的 initWithImage: 构造函数将其转换为纹理。

它看起来像 initWithImage：在该示例中，将 UIImage 重新渲染到位图上下文并使用它来创建纹理。通过一些工作，您可以从该方法中提取相关代码并更改上述代码以将您的图层直接渲染到纹理中。

这样，在为纹理创建文本时，您可以获得 UILabel 的 Unicode 和字体支持。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T17:21:32.240

您对使用 freetype 创建纹理图集以及所有字形信息的描述正是我在当前 iPhone 项目中所做的。

我在预处理步骤中对字体进行了所有解析（所有在 Windows 上的 C# 中）。地图集本身会生成并且只包含所需的字符 - 为了减少空间，我有时也会生成多个地图集以保持纹理大小 pow2 和合理的分辨率。

您可以轻松地从 freetype 中提取字形信息。在运行时将其与纹理一起传递给您的应用程序，然后根据需要更改纹理的 UV 坐标相当简单。

对于它的价值，这就是我在我的小引擎中定义字形字符的方式：

```
struct FontGlyph
{

u32 char_code;

u32 m_x;                // base x position on tpage

u32 m_y;            // base y position on tpage

u32 m_width;            // glyph width

u32 m_height;           // glyph height

i32 m_horiBearingX;     // Distance to X shift

i32 m_horiBearingY;     // Distance to Y shift

u32 m_horiAdvance;      // Total Horizontal advance this character requires

u32 m__tpage_index;     // Which tpage does this glyph use?

}; 
```

然后我有一个“SpriteString”对象，它的行为与任何其他字符串非常相似，除了我可以使用精灵来绘制它......

我同意这对于一个相当微不足道的问题来说似乎是一项艰巨的工作，但我发现它给了我很大的灵活性，并且当我开始着手时真的不需要那么长时间来实施。

如果您需要任何其他详细信息，请随时回复或发表评论。（还有祝你好运 ：）

* * *

当我在评论部分的空间用完时回复您的评论...

查看 freetype 文档，它基本上为您提供字形数据而不会弄乱，它只是将它从字体中拉出来。至于纹理本身，您可以使用 freetype 来渲染每个字形，然后对其进行管理以构建纹理。这是我作为一个完全独立于我的主应用程序的预处理来完成的。

这是我执行此操作的工具代码的摘录：http: [//pastebin.com/md1c6354](http://pastebin.com/md1c6354)

但请注意，这只是为了我的眼睛而不是为了公众消费，所以请原谅它很混乱的事实:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-24T05:58:00.303

我找到了一个简单的解决方案。这是我为它写的一个快速函数。（您将需要 Texture2D 类。）

```
- (void) drawText:(NSString*)theString AtX:(float)X Y:(float)Y {
// Use black
glColor4f(0, 0, 0, 1.0);

// Set up texture
Texture2D* statusTexture = [[Texture2D alloc] initWithString:theString dimensions:CGSizeMake(150, 150) alignment:UITextAlignmentLeft fontName:@"Helvetica" fontSize:11];

// Bind texture
glBindTexture(GL_TEXTURE_2D, [statusTexture name]);

// Enable modes needed for drawing
glEnableClientState(GL_TEXTURE_COORD_ARRAY);
glEnableClientState(GL_VERTEX_ARRAY);
glEnable(GL_TEXTURE_2D);
glEnable(GL_BLEND);

glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA);

// Draw
[statusTexture drawInRect:CGRectMake(X,Y-1,1,1)];   

// Disable modes so they don't interfere with other parts of the program
glDisableClientState(GL_TEXTURE_COORD_ARRAY);
glDisableClientState(GL_VERTEX_ARRAY);
glDisable(GL_TEXTURE_2D);
glDisable(GL_BLEND);    
} 
```

我相信输入坐标需要在你的世界坐标中，但我不确定这是否是真的，或者它是否适合我。您可能需要使用偏移量才能使其正确。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T08:16:47.877

谢谢你的方法。它为我节省了一些时间。

不过，有几件事我必须改变。glBlendFunc 调用必须是：

```
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_ALPHA) 
```

其次，文本似乎正在绘制成一个点。CGRectMake 调用正在创建一个 1x1 矩形，除非我读错了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-20T21:11:31.833

使用“musings”字体库：

[http://www.themusingsofalostprogrammer.com/2010/01/how-to-do-font-rendering-in-opengl-on.html](http://www.themusingsofalostprogrammer.com/2010/01/how-to-do-font-rendering-in-opengl-on.html)

```
Font font("Verdena");
font.print("Hello World!", x, y, z); 
```

简单的 ：）

它带有 unicode 支持，“按需”加载字形，甚至可以输出变量

```
font.print(x, y, z) << "fps: " << fps; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-10T02:46:16.973

我创建了一个类似于“musings”字体库的 Font 类，减去了内存泄漏和为每个字符、每一帧创建的纹理。不过，它仍然为每个字符使用不同的 glTexture。注意：Texture2D 已更改以注释掉其纹理删除。

在构造函数中初始化： `_font = new Font("Helvetica", 40);`

在 redraw() 方法中使用： `_font->draw("Hello, World!", 50, 100, ALIGN_LEFT);`

GitHub链接：

[https://github.com/chandl34/public/tree/master/personal/c%2B%2B/Font](https://github.com/chandl34/public/tree/master/personal/c%2B%2B/Font)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T17:04:29.840

检查坠机着陆演示。提供的 Texture2D 类允许使用文本和字体创建纹理。（希望会有一个更好的答案，我会喜欢一种更简单的方式来绘制 opengles 视图）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-22T19:03:49.630

**是的，我知道有 2 个**。诀窍是，您必须使用 Quartz（CGContext* 函数）渲染到纹理，然后渲染该纹理供用户查看。

如果你关心性能，你也可以使用 Quartz 来生成你的纹理图集。

[一旦您了解了渲染字体的基础知识，](http://www.71squared.com/2009/04/iphone-game-programming-tutorial-4-bitmap-font-class/)就很容易启动纹理生成工具（在 xCode 中）。

您所要做的就是拥有一个有效的 CGContext。[你可以在这个纹理加载器](http://www.71squared.com/2009/03/iphone-game-programming-tutorial-2-image-class/)中找到一些非常棒的示例代码。

基本上代码是：

```
// Create the cgcontext as shown by links above

// Now to render text into the cg context,
// the drop the raw data behind the cgcontext
// to opengl.  2 ways to do this:
// 1)  CG* way: (advantage: easy to use color)
CGContextSelectFont(cgContext, "Arial", 24, kCGEncodingMacRoman);

// set color to yellow text
CGContextSetRGBFillColor(cgContext, 1, 1, 0, 1) ; // Be sure to use FILL not stroke!

// draw it in there
CGContextShowTextAtPoint(cgContext, 20, 20, "HI THERE", strlen("HI THERE") ) ;

/*
// WAY #2:  this way it's always black and white
// DRAW SOME TEXT IN IT
// that works ok but let's try cg to control color
UIGraphicsPushContext(cgContext);
UIFont *helv = [UIFont fontWithName:@"Helvetica" size:[UIFont systemFontSize]];
NSString* msg = @"Hi hello" ;  
[msg drawInRect:CGRectMake(0,0,pow2Width,pow2Height) withFont:helv] ;
    UIGraphicsPopContext();
*/

// put imData into OpenGL's memory
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, pow2Width, pow2Height, 0, GL_RGBA, GL_UNSIGNED_BYTE, imData);
CHECK_GL ; 
```

它看起来非常好并且抗锯齿，

![特克斯地图集](https://i.stack.imgur.com/wmI3v.png)

[此处提供](http://support.apple.com/kb/HT4980)ios 字体列表，并[在此处提供预渲染](http://iosfonts.com/)

# database - 文件存储的推荐位置 - 在数据库或其他地方？

> ID：512262
> 
> 赞同：19
> 
> 时间：2009-02-04T17:01:05.463
> 
> 标签：database, architecture, storage, documents

**背景：**

我们有一个很久以前实施的内部文件存储系统。无论出于何种原因，都选择了使用数据库作为文档的存储机制。

**我的问题是这样的：**

存储文档的最佳做法是什么？有哪些替代方案？优缺点都有什么？ *答案不必是特定于技术或平台的，它更多的是一般的最佳实践问题。*

**我的想法：**

数据库不适用于文档存储。文件系统或第 3 方文档管理系统可能更有用。数据库中的文档存储很昂贵。操作很慢。这些是逻辑假设吗？也许这是最好的，但在我看来，我们有更好的选择。oracle BFILE（指向 NAS 或 SAN 上的文档的链接）是否比 BLOB / CLOB 更好？

**细节：**

*   文档有多种类型（pdf、word、xml）
*   中间层代码是用 .net 2.0 / c# 编写的
*   文档以 BLOB 格式存储在 Oracle 10g 数据库中并进行压缩（NAS 存储）
*   文件大小风靡一时
*   文档数量正在急剧增长，并且没有放缓的迹象
*   在高峰期，插入通常是每小时数百次
*   高峰期的检索速度通常为每小时数千
*   NAS存储和SAN存储可用

***更新（来自以下问题）：***

*   我的背景是发展
*   有关于存储在数据库中文件旁边的文件的相关元数据

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-04T17:09:43.637

根据我的经验，我会说将它们保存在数据库中。我们已经移动了两个系统来执行此操作。

将其放入数据库意味着：

*   即使从多台服务器访问也很容易
*   它是自动备份的（而不是必须有一个单独的工作来做到这一点）
*   您不必担心空间问题（因为人们会防止数据库过度填充磁盘，但可能会忘记监视文档的存储位置）
*   您不必有复杂的目录方案

我们从数据库中有文件。大量文件成为问题。Linux中的普通目录是一个块，通常是4K。我们有一个**58MB**的目录，因为里面有很多文件（它只是一个平面目录，没有层次结构）。它有*那么多*间接块。删了一个多小时。需要几分钟才能计算目录中的文件数。这太糟糕了。这是在 ext3 上。

使用您需要的文件系统：

*   单独的备份机制（从数据库备份）
*   保持同步（因此如果没有文件，数据库中就不存在记录）
*   存储层次结构（为了防止上面列出的问题，所以没有目录最终会包含 10,000 个文件）
*   如果您需要集群（可能是 NFS 或类似的），可以通过某种方式从其他服务器查看它们

这真的很痛苦。对于任何重要数量的文档，我建议根据我所看到的文件系统。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-04T17:04:30.637

我更喜欢**将文档存储在文件系统中**，然后**将指向文件的链接和关联的文件元数据存储在数据库中**。

事实证明，它比其他替代方案更方便、更易于维护且成本更低。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-13T22:37:39.040

大多数企业级文档管理系统不会将目标文件存储在数据库中。仅仅因为你*可以*并不意味着你*应该*。如果可伸缩性和性能对您很重要，并且您有一个大型文档集，则需要非常小心地将对象存储在数据库中。考虑以下：

在文档成像的情况下，2 亿个 TIFF 文件可以被认为是一个相对较大但不是海量的系统。更大规模的系统可以拥有超过 10 亿个对象文件。例如，在每个双色调 TIFF 20KB 时，您可以拥有 4TB 的目标文件存储空间。您的数据库备份需要多长时间？您的查询需要多长时间？这些对象的访问频率是多少？如果这些对象的访问频率很高，您是否希望您的高端数据库服务器将所有时间都用于提供文件？如果您有数百万个对象，那么您需要非常小心地设计一个将对象存储在数据库中的解决方案。

假设您现在的任务是将这些 200M TIFF 文件转换为 PDF 文件。准备好让您的解决方案崩溃，因为您的数据库服务器浪费时间为转换过程提供每个目标文件，然后重新保存结果。

举个例子，Sharepoint 以在数据库中存储对象而闻名。Sharepoint 也因可扩展性问题而闻名。

我的回答：
对于小型系统（< 1M 文件），可以考虑在数据库中存储文件。对于大型系统（> 1M 文件），将文件存储在数据库中是错误的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-04T17:21:36.450

将文件存储在数据库本身中，我最大的担忧是管理备份和其他数据库维护操作的大小和复杂性。

缓解这种困难的一种策略（至少在 MS SQL 中）是创建单独的数据库分区，可能存储在不同的驱动器上。

然后分离您的数据模式，以便*有关*文件的元数据位于一个分区中，而实际的 BLOB 文件位于单独的分区中。

这些分区可以按不同的计划进行备份，甚至可以单独恢复。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-05T04:24:19.360

在数据库中存储文档的唯一限制是技术。

[关系数据库](http://en.wikipedia.org/wiki/Relational_database)旨在成为企业关键任务数据的持久存储。当然，它执行该功能的能力因数据库和系统而异。但*理想情况下*，[关系数据库](http://en.wikipedia.org/wiki/Relational_model)的[ACID](http://en.wikipedia.org/wiki/ACID)属性**旨在**使其成为所有[企业数据](http://en.wikipedia.org/wiki/Enterprise_Data_Management)的存储。文件系统、修订控制器系统和其他本地存储存储系统可能具有特定的优势，但它们并不是为企业数据存储而设计的。

 **如果您存储的文档符合企业数据的条件——如果它们在整个企业中持续使用——那么将它们保存在数据库中是合乎逻辑的。如果您在数据库中存储时遇到问题，也许 DBA 可以找到更好的解决方案。出于性能原因，您甚至可能不得不将它们移出数据库，但出于最佳实践的原因，我认为您不应该将它们移出数据库。

当然，如果文档不是企业数据，例如它们仅用于一个应用程序，那么将它们移出数据库也是有意义的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T17:06:21.163

我曾经将图像作为 BLOB 存储在数据库中，并且在我第一次不得不对这些图像执行批处理操作时后悔了。在文件系统中这样做会容易得多。此外，正如您所提到的，如果文档位于文件系统上，则检索文档要快得多。

我的简单观点：文件系统应该存储文件，关系数据库应该存储关系数据。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T18:00:03.910

将二进制文件存储在文件系统中。为存储和检索操作创建一个 ASP.NET 应用程序。您可能会喜欢 Web 应用程序（文档版本控制、多层安全性等）。我想这是文档管理行业的共识。

由于您的“文档数量正在急剧增长”，因此看起来规模越来越大。您可能想开始寻找第三方的开箱即用解决方案（例如[http://kofax.com/capture/](http://kofax.com/capture/) - 我在这方面有丰富的经验！）为你。或者更好的是，考虑看看像这些家伙这样的 SaaS 产品[http://www.edocumentsolutionsllc.com/](http://www.edocumentsolutionsllc.com/)

:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T17:05:51.913

如果您希望能够访问文件并编辑和重新保存它们，请将您的文档存储为 .doc 等文件。

如果您想要可以提取和复制的实际历史副本，请将您的文档存储为 .pdf 或 .tiff 等文件。

将有关文件的所有信息（例如日期、作者、位置）存储在数据库中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T17:06:34.703

我总是在数据库中存储文档的核心信息和文件路径，但从不存储文档本身。整个文档很少需要在数据库中。

这为使用这些文档提供了更大的灵活性。例如，想要使用分层备份存储和重复数据删除机制？在 Oracle BLOB 中尝试一下。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T17:13:21.023

我可以看到将文档存储在数据库中的唯一优势是可以轻松地将这些文档移动到另一个环境。除此之外，由于已经提到的所有原因，我不会这样做。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T17:21:29.727

相反，出于以下几个原因，我会在数据库中进行存储：

1.  更简单的备份策略
2.  可以对存储在数据库中的文档进行索引和搜索
3.  您不必担心文件被移动/安全性被篡改
4.  发生崩溃时易于移植到另一台服务器
5.  如果政府要求您必须存储 x 年前的数据，那么使用数据库进行管理会容易得多

数据库是用来存储数据的。文件只是数据。

虽然已经说过在文件系统上存储文件有好处，但主要是数据库性能更好，大小也更小。SQL Server 2008 允许您使用 FileStream 获得两全其美的效果。[阅读本白皮书](https://web.archive.org/web/20110501070548/http://www.microsoft.com/sqlserver/2008/en/us/wp-sql-2008-manage-unstructured.aspx)了解更多信息

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T17:48:18.847

个人专长：您是数据库管理员还是程序员？

安全性：数据库设置一项，数据库和文件系统设置一项。是否有人不小心移动/删除文件？在复杂的设置中，管理员可能会选择将文件移动到另一台服务器，然后只更改共享或映射。我知道，这永远不会发生。

该领域的新数据库正在改进。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T20:04:08.417

考虑将您的文档存储在 subversion 或其他版本控制系统中。您将拥有良好的备份、查看旧版本文档的能力和出色的网络访问。参见“[我的颠覆生活](http://www.onlamp.com/pub/a/onlamp/2005/01/06/svn_homedir.html)”。

# java - Java乘法运算行为

> ID：512266
> 
> 赞同：8
> 
> 时间：2009-02-04T17:02:01.920
> 
> 标签：java, overflow, integer-overflow

我编写了一个将给定数字从天数转换为毫秒数的方法：

```
private long expireTimeInMilliseconds;
...
public void setExpireTimeInDays(int expireTimeInDays)
{
   expireTimeInMilliseconds = expireTimeInDays * 24 * 60 * 60 * 1000;
} 
```

我很难弄清楚我做错了什么。现在我的问题是： ***这个错误如此明显吗？***

修正方法：

```
private long expireTimeInMilliseconds;
...
public void setExpireTimeInDays(int expireTimeInDays)
{
   expireTimeInMilliseconds = ((long) expireTimeInDays) * 24 * 60 * 60 * 1000;
} 
```

如果我在计算之前没有将整数转换为 long，我会得到一个完全错误的结果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T17:14:06.730

很明显吗？我想这取决于您使用 Java 的时间以及您必须处理毫秒的次数。当然，最多24天应该没问题...

我认为最大的提示应该是`System.currentTimeMillis()`返回一个`long`. 这是一个很好的迹象，表明毫秒数可能会变大。您设置的变量类型也应该是一个很好的提示。

当然，您*还*必须知道，如果您对整数进行算术运算，结果将是`int`溢出时回绕。这是否足够明显可以辩论，但这将是一个毫无意义的讨论。在 C# 中，如果您打开溢出检查，您会很快发现错误 - 但没有多少开发人员这样做（确实，我不这样做，尽管我可能应该这样做）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T17:14:53.827

是的，如果你以前做过，那就很明显了。每当您看到一串数字相乘时，您应该自动开始考虑整数溢出错误。在这种情况下，如果`expireTimeInDays`大于 24，您将设置为溢出。从技术上讲，您应该在**使用 integers 时**考虑溢出错误，但是像这样将一组它们相乘应该是一个非常大的危险信号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T17:17:50.093

您的操作数变量和文字数字是 int 类型。int 数据类型的最大值为 2^31 -1。因此，对于如此大的数字，int 的数据类型会溢出，导致看起来不正确的答案。

在您的第一个示例中， int 仅提升为对计算**后发生的变量的 long 赋值。**计算结果是一个int。

第二个示例将第一个操作数强制转换为 long，从而将计算提升为 long。在这种情况下，由于提升，计算的结果很长。long 数据类型对于您的计算来说已经足够大了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T17:30:55.030

您可能有兴趣知道这在 Joshua Bloch 和 Neal Gafter 的“Java Puzzlers”中有所介绍。

[![替代文字](https://i.stack.imgur.com/JK4YQ.jpg)](https://i.stack.imgur.com/JK4YQ.jpg)
[（来源：[javapuzzlers.com](http://www.javapuzzlers.com/lg-puzzlers-cropped.jpg)）]

在这本书中，您会发现许多其他 Java 陷阱、陷阱和极端案例。

我同意留下评论的starblue。将 L 附加到数字。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T17:13:17.310

不，这并不明显。

但是相信我，经过几年的实践和修复这样的错误，你对整数溢出变得非常敏感，并且做正确的事情甚至不考虑它。

这是发生在每个人身上的事情。绝对没有不良代码实践，无知等迹象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T18:33:43.107

只是为了添加其他答案，我发现过去定义常量 ( `public static final long`) 很有帮助，例如`MILLISECS_DAY`or `MILLISECS_HOUR`。更具可读性和实用性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T02:39:04.360

另一种写法是

```
public void setExpireTimeInDays(int expireTimeInDays)
{
   expireTimeInMilliseconds = (long) expireTimeInDays * 24 * 60 * 60 * 1000;
} 
```

或者

```
public void setExpireTimeInDays(int expireTimeInDays)
{
   expireTimeInMilliseconds = expireTimeInDays * 24L * 60 * 60 * 1000;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-05T02:47:55.327

如果您在代码中使用 FindBugs，它将检测到这个确切的问题。“ICAST：整数乘法转换为长整数的结果。” FindBugs 的例子正是你正在做的；以毫秒为单位计算天数。

当我第一次遇到这个问题时，这个问题对我来说并不明显。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-05T03:05:25.307

有一些静态分析工具（findbugs）会发现这些类型的错误。

计算机上的数值数学可能很难。操作顺序可能会以您意想不到的方式影响精度和准确性。日期数学也可能非常棘手。通常最好使用日期/日历例程，而不是尝试自己进行数学运算，但这些例程并不是 Java 类库中设计最好的例程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T20:10:07.093

我并不是要为我的错误辩护，但是如果 java 编译器足够聪明，可以在计算之前将 int 提升为 long（一旦将计算分配给 long 类型的变量），那就太好了

顺便说一句，我曾经使用 C/C++，如果它是一个 C 程序，我也会遇到同样的问题，但几年前我对这种操作更加小心。

下次我会更加注意（或切换到python）......：D

# jar - 在另一个目录中运行带有源文件的 jar 文件

> ID：512275
> 
> 赞同：0
> 
> 时间：2009-02-04T17:03:27.940
> 
> 标签：jar

我想直接从命令行运行一个 jar 文件，而不必将 jar 文件放在包含我的输入文件的目录中。如果可能的话，关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T17:05:38.027

在 JAR 中执行类时，您不会只提供类路径参数吗？例如：

java -cp lib/somejar.jar org.foo.bar.MyClass

其中 -cp 是类路径参数，而 lib/somejar.jar 是您尝试执行的 jar 的路径。

我不确定我是否清楚你在寻找什么。

# asp.net - 使用 CSS 分页符，但在绝对定位的 DIV 内

> ID：512276
> 
> 赞同：0
> 
> 时间：2009-02-04T17:03:43.383
> 
> 标签：asp.net, html, css, asp.net-ajax, modalpopupextender

我在页面上使用 ASP.NET AJAX ModalPopupExtender。弹出窗口包含需要打印的一个或多个客户订单的详细信息。每个订单都需要在单独的页面上。

我应该能够使用 CSS`page-break-after`样式，但这在这种情况下不起作用，因为 ModalPopupExtender 导致包含`div`设置为`position: absolute`.

任何人都可以提出解决方法吗？

为了完整起见，下面是一个说明问题的示例 HTML 页面。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Printing Pagination</title>
    <style type="text/css">
        div
        {
            padding: 10px;
            margin: 10px;
        }
        div.outer
        {
            border: solid 5px green;
            position: absolute;
            top: 100px;
            left: 100px;
            width: 200px;
        }
        div.page
        {
            border: solid 5px red;
        }
    </style>
    <style type="text/css" media="print">
        div.outer
        {
            border: none;
        }
        div.page
        {
            page-break-after: always;
        }
    </style>
</head>
<body>
    <div class="outer">
        <div class="page">
            This should be on page 1 when printed
        </div>
        <div class="page">
            This should be on page 2 when printed
        </div>
        <div class="page">
            This should be on page 3 when printed
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T20:14:46.040

你能不能把这段代码添加到你的打印风格中？

```
div.outer { position: relative; } 
```

这看似简单，但在打印时，我怀疑客户端/报表查看器是否想要与定位有关，并且最关心内容是吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-23T21:09:03.860

我有一个类似的问题。我正在使用 gridster 插件，并且有许多绝对定位的 div。我最终得到的解决方案是`margin-top`用于将被切断的 div，从而将它们移动到分页符下方。

如果您尝试重新定位多个元素，并且您正在使用 Sass，您可以尝试以下操作：

```
@for $i from 1 through 10 {
  &[data-SOME-ATTR="#{$i}"] {
    margin-top: #{SOME_OPERATIONS}px;
  }
} 
```

# rest - RESTful 删除策略

> ID：512279
> 
> 赞同：11
> 
> 时间：2009-02-04T17:04:21.463
> 
> 标签：rest

假设我有一个资源，在调用 delete 时可以有两种不同的行为

1.  资源被删除。
2.  资源被移动到回收站。

如何以符合 REST 的方式对其进行建模？

我想到了以下解决方案：

```
DELETE /myresource 
```

将资源移动到回收站（默认行为）

```
DELETE /myresource?force-delete=true 
```

强制删除资源。

这符合 REST 吗？我在调用 DELETE 时从未在 URL 中看到查询参数，可以吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-05T03:07:12.853

您的想法很好，但我认为自定义请求标头会更合适一些。查询参数更适合参数。

自定义请求标头看起来像这样：

```
DELETE /myresource
X-Really-Delete: Yup 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T17:11:30.107

纯 REST 策略应该更喜欢不变的资源。在我看来，您并没有通过附加参数来更改资源，所以对我来说这听起来是个好策略。

如果您要执行相同的操作，如下所示：

```
DELETE /myresource.force 
```

这将像另一种资源一样，这不是最佳的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T17:11:08.453

为什么不？您已经传递了一个参数来识别哪个资源，因此发送另一个参数来建立不同的操作过程。IMO，它是完全 RESTful 的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T03:18:40.957

您还可以将 2\. 实现为 POST 请求而不是 DELETE。

```
POST /myresource

recycle-bin=true... 
```

正如您所做的一切都是更新资源以指示它在回收站中。

**编辑**：将方法从更改`PUT`为给`POST`定`PUT`必须包含资源的完整替换（或添加），而显然这里我们只更新资源的一部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-27T15:19:45.080

DELETE 应该删除该项目，不问任何问题。

遗憾的是，HTTP 中没有“MOVE”请求。POST 通常用于创建内容，PUT 是更多的修改。

因此，我建议您`PUT /myresource`使用某种形式的元数据或 json 字符串`{ "recycle":"true" }`来表示您想要“回收”它。

# sql - LINQ to SQL - 选择字符串数组之类的文本

> ID：512285
> 
> 赞同：7
> 
> 时间：2009-02-04T17:05:32.850
> 
> 标签：sql, linq, linq-to-sql, sql-like

我有一个`<string`变量计数的列表>，我想查询（通过 LINQ）一个表来查找包含文本列中任何这些字符串的任何项目。

试过这个（不起作用）：

```
items = from dbt in database.Items
         where (stringList.FindAll(s => dbt.Text.Contains(s)).Count > 0)
         select dbt; 
```

查询将类似于：

```
select * from items where text like '%string1%' or text like '%string2%' 
```

这可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-06T15:49:18.053

看看这篇文章做你想做的事：
[http](http://www.albahari.com/nutshell/predicatebuilder.aspx)

://www.albahari.com/nutshell/predicatebuilder.aspx 这就像一个梦。我基本上剪切并粘贴了他们的代码并将其取回（当然使用我自己的数据方案）：

```
SELECT [t0].[Id], [t0].[DateCreated], [t0].[Name] ...
FROM [dbo].[Companies] AS [t0]
WHERE ([t0].[Name] LIKE @p0) OR ([t0].[Name] LIKE @p1) 
```

这是我为概念验证运行的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Linq.Expressions;

namespace PredicateTest
{
class Program
{
    static void Main(string[] args)
    {
        DataClasses1DataContext dataContext = new DataClasses1DataContext();

        Program p = new Program();
        Program.SearchCompanies("test", "test2");
        var pr = from pi in  dataContext.Companies.Where(Program.SearchCompanies("test", "test2")) select pi;
    }

    DataClasses1DataContext dataContext = new DataClasses1DataContext();

    public static Expression<Func<Company, bool>> SearchCompanies(
                                                  params string[] keywords)
    {
        var predicate = PredicateBuilder.False<Company>();
        foreach (string keyword in keywords)
        {
            string temp = keyword;
            predicate = predicate.Or(p => p.Name.Contains(temp));
        }
        return predicate;
    }

}

public static class PredicateBuilder
{
    public static Expression<Func<T, bool>> True<T>() { return f => true; }
    public static Expression<Func<T, bool>> False<T>() { return f => false; }

    public static Expression<Func<T, bool>> Or<T>(this Expression<Func<T, bool>> expr1,
                                                        Expression<Func<T, bool>> expr2)
    {
        var invokedExpr = Expression.Invoke(expr2, expr1.Parameters.Cast<Expression>());
        return Expression.Lambda<Func<T, bool>>
              (Expression.OrElse(expr1.Body, invokedExpr), expr1.Parameters);
    }

    public static Expression<Func<T, bool>> And<T>(this Expression<Func<T, bool>> expr1,
                                                         Expression<Func<T, bool>> expr2)
    {
        var invokedExpr = Expression.Invoke(expr2, expr1.Parameters.Cast<Expression>());
        return Expression.Lambda<Func<T, bool>>
              (Expression.AndAlso(expr1.Body, invokedExpr), expr1.Parameters);
    }
}
} 
```

我建议去该网站获取代码和解释。

（我将留下第一个答案，因为如果您需要 IN 语句，它会很好地工作）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T17:15:29.287

对整个 LINQ to SQL 游戏来说是一种新事物，但是这种语法有帮助吗？

```
string[] items = new string[] { "a", "b", "c", "d" };

var items = from i in db.Items
             where items.Contains(p.text)
            select i; 
```

得到它：

[http://blog.wekeroad.com/2008/02/27/creating-in-queries-with-linq-to-sql/](http://blog.wekeroad.com/2008/02/27/creating-in-queries-with-linq-to-sql/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-30T14:25:53.537

阅读这篇文章后，寻找与您相同的解决方案，我发现使用 Linq 的`.Any`and`.All`方法的解决方案是一种简单而优雅的方式来获取数组的匹配结果。

在本例中，我使用搜索输入，以逗号分隔作为示例。我不在乎比赛是否在同一情况下。

```
var qry = Query.Split(',').Select(c => c.Trim().ToLower()); 
```

首先获取一些要查询的数据，从 Linq 到 SQL 或任何地方

```
var search = db.tablename; 
```

使用 lambda 语法编写紧凑的代码，并导致`.Any`查询中的字符串与表中的名称或描述匹配。

```
search = search.Where(
    record => 
    qry.Any(q => record.Name.ToLower().Contains(q)) || 
    qry.Any(q => record.Description.ToLower().Contains(q))); 
```

如果您只想要在任何字段中匹配所有字符串的结果，您可以替换`.Any`为`.All`：

```
search = search.Where(
    record => 
    qry.All(q => record.Name.ToLower().Contains(q)) || 
    qry.All(q => record.Description.ToLower().Contains(q))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-08T14:57:54.437

**使用：**

```
string searh = "test1 test2,test3";    
data.Persons.Search(p => p.Name, search); 
```

**搜索功能是：**

```
public static IQueryable<T> Search<T>(this IQueryable<T> source, Expression<Func<T, string>> selector, string s)
{
    if (string.IsNullOrEmpty(s))
        return source;

    string[] str = s.Split(new char[] { ' ', ',' }, StringSplitOptions.RemoveEmptyEntries);

    MethodInfo methodContains = typeof(string).GetMethod("Contains", new[] { typeof(string) });

    Expression strExpression;
    Expression expressionContains;
    Expression resultExpression = Expression.Empty();

    for (int i = 0; i < str.Length; i++)
    {
        strExpression = Expression.Constant(str[i].Trim(), typeof(string));
        expressionContains = Expression.Call(selector.Body, methodContains, strExpression);

        if (i == 0)
            resultExpression = expressionContains;
        else
            resultExpression = Expression.OrElse(resultExpression, expressionContains);
    }

    Expression<Func<T, bool>> lambdaExpr = Expression.Lambda<Func<T, bool>>(resultExpression, new ParameterExpression[] { selector.Parameters[0] });

    return source.Where(lambdaExpr);
} 
```

# mysql - 何时在 MySQL 中使用 STRAIGHT_JOIN

> ID：512294
> 
> 赞同：98
> 
> 时间：2009-02-04T17:07:13.640
> 
> 标签：mysql, join

我刚刚处理了一个相当复杂的查询，运行它需要 8 秒。EXPLAIN 显示了一个奇怪的表顺序，即使使用 FORCE INDEX 提示，我的索引也没有全部被使用。我遇到了 STRAIGHT_JOIN join 关键字，并开始用它替换我的一些 INNER JOIN 关键字。我注意到显着的速度提高。最终，我只是用 STRAIGHT_JOIN 替换了我所有的 INNER JOIN 关键字，现在它在 0.01 秒内运行。

我的问题是你什么时候使用 STRAIGHT_JOIN 什么时候使用 INNER JOIN？如果您正在编写好的查询，是否有任何理由不使用 STRAIGHT_JOIN？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-05T16:40:43.707

如果没有充分的理由，我不建议使用 STRAIGHT_JOIN。我自己的经验是 MySQL 查询优化器比我想要的更频繁地选择一个糟糕的查询计划，但不够频繁，以至于您通常应该绕过它，如果您总是使用 STRAIGHT_JOIN，您会这样做。

我的建议是将所有查询保留为常规 JOIN。如果您发现一个查询正在使用次优查询计划，我建议您首先尝试重写或重新构造查询，看看优化器是否会选择更好的查询计划。此外，至少对于 innodb，确保不仅仅是您的索引统计信息过时（[分析表](http://dev.mysql.com/doc/refman/5.0/en/analyze-table.html)）。这可能会导致优化器选择一个糟糕的查询计划。优化器提示通常应该是您最后的手段。

不使用查询提示的另一个原因是您的数据分布可能会随着时间的推移而变化，或者您的索引选择性可能会随着表的增长而变化，等等。您现在最佳的查询提示可能会随着时间的推移变得次佳。但是由于您现在已经过时的提示，优化器将无法调整查询计划。如果您允许优化器做出决定，您将保持更灵活。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-02-09T14:09:55.510

这是最近在工作中出现的一个场景。

考虑三个表，A、B、C。

A 有 3,000 行；B 有 300,000,000 行；C 有 2,000 行。

外键定义：B(a_id), B(c_id)。

假设您有一个如下所示的查询：

```
select a.id, c.id
from a
join b on b.a_id = a.id
join c on c.id = b.c_id 
```

根据我的经验，在这种情况下，MySQL 可能会选择 C ​​-> B -> A。C小于A，B很大，它们都是等值的。

问题是 MySQL 不一定会考虑（C.id 和 B.c_id）与（A.id 和 B.a_id）之间的交集的大小。如果 B 和 C 之间的连接返回的行数与 B 一样多，那么这是一个非常糟糕的选择；如果从 A 开始将 B 过滤到与 A 一样多的行，那么这将是一个更好的选择。`straight_join`可用于强制执行此命令，如下所示：

```
select a.id, c.id
from a
straight_join b on b.a_id = a.id
join c on c.id = b.c_id 
```

现在`a`必须在之前加入`b`。

通常，您希望以最小化结果集中行数的顺序进行连接。因此，从一个小表开始并加入使得结果连接也很小，是理想的。如果从一张小桌子开始，然后将它连接到一张更大的桌子上，结果就和大桌子一样大，事情就会变成梨形。

不过，这取决于统计数据。如果数据分布发生变化，计算可能会发生变化。它还取决于连接机制的实现细节。

我见过的 MySQL 最糟糕的情况是，除了必需`straight_join`或激进的索引提示之外，所有查询都是以严格的排序顺序对大量数据进行分页的查询，并带有轻度过滤。MySQL 强烈倾向于对任何过滤器和连接使用索引而不是排序；这是有道理的，因为大多数人不是试图对整个数据库进行排序，而是对查询做出响应的行的有限子集，并且对有限子集进行排序比过滤整个表要快得多，无论它是排序的还是不是。在这种情况下，将直接连接放在具有我想要对固定事物进行排序的索引列的表之后。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-04T21:29:18.713

来自[MySQL JOIN 参考](http://dev.mysql.com/doc/refman/5.1/en/join.html)：

“STRAIGHT_JOIN 类似于 JOIN，除了左表总是在右表之前读取。这可用于连接优化器以错误顺序放置表的那些（少数）情况。”

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-04T17:15:18.117

MySQL 不一定擅长在复杂查询中选择连接顺序。通过将复杂查询指定为 straight_join，查询会按照指定的顺序执行连接。通过首先将表放置为最小公分母并指定 Straight_join，您可以提高查询性能。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-04-13T19:35:55.653

`STRAIGHT_JOIN`，使用该子句，可以控制`JOIN`顺序：在外循环中扫描哪个表，在内循环中扫描哪个表。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-11-10T11:27:56.387

我会告诉你为什么我必须使用 STRAIGHT_JOIN ：

*   我在查询时遇到了*性能*问题。
*   简化查询，查询一下子变得更有效率了
*   试图找出导致问题的具体部分，我就是做不到。（2 个左连接在一起很慢，每个都独立快）
*   然后我使用慢速和快速查询执行 EXPLAIN（添加左连接之一）
*   令人惊讶的是，MySQL 完全改变了 2 个查询之间的 JOIN 顺序。

因此，我强制其中一个连接为 straight_join 以强制首先读取前一个连接。这阻止了 MySQL 更改执行顺序并像魅力一样工作！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-04-17T01:00:33.510

在我短暂的经验中，`STRAIGHT_JOIN`将我的查询从 30 秒减少到 100 毫秒的情况之一是执行计划中的第一个表不是按列排序的表

```
-- table sales (45000000) rows
-- table stores (3) rows
SELECT whatever
FROM 
    sales 
    INNER JOIN stores ON sales.storeId = stores.id
ORDER BY sales.date, sales.id 
LIMIT 50;
-- there is an index on (date, id) 
```

如果优化器选择先命中`stores` **它**会导致`Using index; Using temporary; Using filesort`因为

> 如果 ORDER BY 或 GROUP BY 包含来自连接队列中第一个表以外的表的列，则会创建一个临时表。

[来源](https://stackoverflow.com/a/13639502/5407848)

这里优化器需要一点帮助，告诉他`sales`首先使用

```
sales STRAIGHT_JOIN stores 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-27T17:56:53.753

如果*您*`ORDER BY... LIMIT...`的查询以. *_**`LIMIT` *`JOIN`**

 **（此答案不仅适用于关于 的原始问题`STRAIGHT_JOIN`，也不适用于 的所有情况`STRAIGHT_JOIN`。）

从[*@Accountantم 的示例*](https://stackoverflow.com/a/49868286/1766831)开始，这在大多数情况下应该运行得更快。（并且它避免了需要提示。）

```
SELECT  whatever
    FROM  ( SELECT id FROM sales
                ORDER BY  date, id
                LIMIT  50
          ) AS x
    JOIN  sales   ON sales.id = x.id
    JOIN  stores  ON sales.storeId = stores.id
    ORDER BY  sales.date, sales.id; 
```

笔记：

*   首先，获取 50 个 ID。这将特别快`INDEX(date, id)`。
*   然后 join back to`sales`让您只获得 50 个“whatevers” *，而无需*将它们拖到临时表中。
*   由于子查询根据定义是无序的，因此`ORDER BY`必须在外部查询中重复。（优化器可能会找到一种方法来避免实际执行另一种排序。）
*   是的，它更混乱。但它通常更快。

我反对使用命中，因为“即使今天更快，明天也可能无法更快。”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-03T15:35:18.127

我知道它有点旧，但这是一个场景，我一直在做批处理脚本来填充某个表。在某些时候，查询运行得很慢。特定记录上的连接顺序似乎不正确：

*   以正确的顺序

[![在此处输入图像描述](https://i.stack.imgur.com/oIOsX.png)](https://i.stack.imgur.com/oIOsX.png)

*   将 id 增加 1 会打乱顺序。注意“额外”字段

[![在此处输入图像描述](https://i.stack.imgur.com/Vfpvv.png)](https://i.stack.imgur.com/Vfpvv.png)

*   使用 straight_join 解决了这个问题

[![在此处输入图像描述](https://i.stack.imgur.com/BdIaU.png)](https://i.stack.imgur.com/BdIaU.png)

不正确的顺序运行大约 65 秒，而使用 straight_join 以毫秒为单位运行

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2017-04-05T06:43:50.847

```
--use 120s, 18 million data
    explain SELECT DISTINCT d.taid
    FROM tvassist_recommend_list_everyday_diverse d, tvassist_taid_all t
    WHERE d.taid = t.taid
      AND t.client_version >= '21004007'
      AND t.utdid IS NOT NULL
      AND d.recommend_day = '20170403'
    LIMIT 0, 10000

--use 3.6s repalce by straight join
 explain SELECT DISTINCT d.taid
    FROM tvassist_recommend_list_everyday_diverse d
    STRAIGHT_JOIN 
      tvassist_taid_all t on d.taid = t.taid 
    WHERE 
     t.client_version >= '21004007'
       AND d.recommend_day = '20170403'

      AND t.utdid IS NOT NULL  
    LIMIT 0, 10000 
```

# c# - 如何确定表单上的哪个控件具有焦点？

> ID：512296
> 
> 赞同：14
> 
> 时间：2009-02-04T17:07:18.243
> 
> 标签：c#, .net, winforms, controls, focus

我在这里的其他地方读过，要在文本框中捕获“Enter”键击并像按下按钮一样使用它，我应该将表单的 KeyPreview 属性设置为 true 并检查 KeyDown 的值。

我希望能够在多个 TextBox 控件上使用此功能，每个控件都与不同的 Button 相关联。

我的问题是我怎么知道哪个控件导致了 KeyPress 事件？发件人被列为表单本身。

G

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T17:09:08.677

我找到了一个似乎有效的解决方案。

```
 private void DeviceForm_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyValue == 13 && tstxtDeviceFilter.Focused)
        {
            filterByDeviceSN();
        }
    } 
```

我不禁认为一定有更好的方法！

--编辑--编辑--编辑--编辑--编辑--

好吧，在查看了下面的建议（谢谢）之后，在这种情况下，我找到了一种“更好”的方法。

```
 this.tstxtDeviceFilter.KeyDown += new System.Windows.Forms.KeyEventHandler(this.tstxtDeviceFilter_KeyDown);

    private void tstxtDeviceFilter_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyValue == 13)
        {
            filterByDeviceSN();
        }
    } 
```

显然，通过将事件捕获在文本框本身而不是表单上，我不需要担心焦点。我又一次因为这么久没有想到这一点而感到愚蠢！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T17:14:28.853

每个表单都有一个“接受”按钮和“取消”按钮的属性，当用户分别按下回车键和退出键时，这些按钮会被“点击”。

您可以在每个控件获得焦点时更改默认按钮（您可以为每个按钮设置一个焦点事件处理程序，并与一组文本框共享）

如果您这样做，那么按钮的外观会发生变化，从而为用户提供视觉提示，告诉他们哪个按钮是默认按钮。

或者，如果您不想这样做，您可以使用“ActiveControl”属性，并测试它属于哪一组文本框。

您是否问过自己，如果默认按钮不是这些文本框之一，它应该是什么？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T17:15:05.513

你试过[Form.ActiveControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.containercontrol.activecontrol.aspx)吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T22:31:38.850

您可以将此代码用作捕获表单的按键事件的起点。ActiveControl 是一个具有焦点的控件。在此示例中，当您在表单上的不同文本框中时，可以灵活地在“Enter”上添加其他操作。它是 VB.NET，但您应该能够轻松转换为 C#。

```
Private Sub MyForm_KeyDown(ByVal sender As Object, _
    ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown

    If e.KeyCode = Keys.Enter Then
        If Me.ActiveControl.Name = Me.TextBox1.Name Then
            ' This is the TextBox we want to be active to run filterByDeviceSN()
            filterByDeviceSN()
        ElseIf Me.ActiveControl.Name = Me.TextBox2.Name Then
            foo()
        End If
    End If
End Sub 
```

# c# - 为用户缓存唯一的自动建议列表采取什么方法？

> ID：512297
> 
> 赞同：3
> 
> 时间：2009-02-04T17:07:42.220
> 
> 标签：c#, asp.net, sql, xml, autosuggest

我正在制作一个应用程序 (asp.net/c#)，它将自动建议用户输入的几个字段。每个用户最终都会建立自己的自动建议列表。每次他们添加一个项目时，如果它是一个新词，它就会被添加到他们的自动建议列表中，就像 gmail 一样。

我想知道大多数人是怎么做到的？每次按键都调用服务器似乎效率不高？我应该为每个用户制作一个包含一个条目的巨大 xml 文件吗？每个用户的 xml 文件？我将如何缓存它以使其高效？

各种各样的问题，但我基本上在寻找的是最佳实践。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T07:16:25.940

**数据存储**
您应该将此信息存储在数据库中。创建一个或两个表来保存每个用户每个字段的此类信息。

**客户端查询**
当用户开始在文本字段中键入时，您可以从客户端（通过 AJAX）查询数据库。如果您这样做，最佳做法是等到字段中至少有 3 个（ish）字符，然后再向服务器查询建议。这会稍微减少请求的数量以及客户端和服务器之间的流量。

我将此方法用于存在大量可能的自动建议命中的字段。

*缓存*
如果您使用此方法，您可以通过在某些情况下缓存响应来优化流程。

假设仅在文本字段中有 3 个字符后才触发查询，那么您可以缓存整个结果。添加到文本框中的任何其他字符都不会增加返回的结果数。因此，您可以继续过滤缓存的结果。但是，如果用户删除了一个字符，您可以刷新缓存以确保您有最合适的自动建议命中可用。

**服务器端预加载**
在服务器端，收集所有这些数据并将其与页面请求一起发送。（您可以将它作为一个 javascript 数组下推到某个地方，以便在`onchange`文本字段的事件中被引用。这样，您不必进行任何 AJAX 调用。

对于不会有大量可能的自动建议命中的字段，这似乎更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:13:52.300

我会将值存储在数据库中（您可能在其中存储他们的用户配置文件），并在用户登录时将值拉入 ASP.NET 会话。然后只需使用会话中的值作为自动完成值。这样，您只需在他们登录时访问数据库一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T06:30:25.080

Chuck Norris 建议，根据您的 JavaScript 框架，您可以在进行服务器调用之前构建客户端检查，以查看字段中是否写入了给定数量的字符或单词。XML 文件应根据该用户在数据库中输入的信息，使用给定用户的自动建议词动态生成。

根据您尝试构建的应用程序，对特定数据库字段执行全文 SQL 查询可能更容易。为了提高性能，您可能会构建一个 cookie，该 cookie 将由客户端的浏览器缓存，并让您的应用程序检查更改或在执行完整的数据库查询之前检查它是否存在。

Chuck 不建议使用会话变量，因为您会降低应用程序的性能，因为它必须为每个用户将这些自动建议值保存在内存中。

Chuck 想知道在他交出我的大脑之前你还需要什么。

# java - 如何避免显示警报后提交表单？

> ID：512304
> 
> 赞同：1
> 
> 时间：2009-02-04T17:09:36.273
> 
> 标签：java, javascript, jsf

如果用户名和密码不匹配，它会显示一个警报，但如果我单击“确定”进入警报，则表单已登录。谁能告诉我如何避免它？谢谢。

```
<html>
<f:view>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
<h:form id="loginForm">
<h1><center>Login page</center> </h1>
<h:panelGrid columns="2">
<h:outputLabel value="UserName"></h:outputLabel>
<h:inputText id="name" value="#{user.name}"> </h:inputText>
<h:outputLabel value="Password"></h:outputLabel>
<h:inputSecret id="password" value="#{user.password}"></h:inputSecret>
</h:panelGrid>
<h:commandButton type="button" value="Login" action="logged" onclick="checkPassword(this.form)"></h:commandButton>
</h:form>
</body>
<script type="text/javascript">
<!--
function checkPassword(form) {
var passsword = form["loginForm:password"].value;
var username=form["loginForm:name"].value;
var confirmpassword ="welcome";
var confirmusername="admin";
if((passsword == confirmpassword)&&(username==confirmusername))
form.submit();
else
alert("Username and Password does not match");
}
-->
</script>
</f:view>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T17:11:26.753

```
... onclick="checkPassword(this.form); return false;" ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:14:56.463

将函数的结尾更改为

```
else {
    alert("Username and Password does not match");
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T19:35:09.647

```
if((passsword == confirmpassword)&&(username==confirmusername))
form.submit(); 
```

最好不要那样做。如果在没有单击按钮的情况下提交表单（例如，在按下 Enter 的各种情况下），您的验证将不会执行。

放置验证的最佳位置是在 form.onsubmit 事件处理程序中。例如：丢失源中的 onclick 并以编程方式将测试放在表单上：

```
var form= document.getElementById('loginForm');
form.onsubmit= function() {
    var isok= this.elements['loginForm:username'].value=='admin' && this.elements['loginForm:password'].value=='welcome';
    if (!isok)
        alert('Wrong, fool!');
    return isok;
} 
```

您当然知道客户端密码检查是徒劳的。

# database - 数据库作为文件格式

> ID：512310
> 
> 赞同：3
> 
> 时间：2009-02-04T17:10:13.307
> 
> 标签：database, database-design, sqlite

一个关于数据库设计的新手问题。
我有一个应用程序管理一些记录器数据，例如。对时间、电压、电流、温度进行 1000 次连续测量。此外，每个序列运行都有元数据（日期、位置等）。
所以我需要一个表来记录每组测量值和一个主表，列出这些表和每个表的元数据。

几个问题：
这并没有真正使用所有数据表格式相同的事实——没有“表数组”的概念，这是否意味着什么？

我是否只需给每个数据表一个唯一的名称，将其作为列放在主表中，然后简单地将其替换为 SQL 选择语句 - 还是有更好的方法？

编辑：许多表（每次运行一个）的原因是可能有 10-100 次运行，每个运行有许多 1000 次测量。如果我只想显示/查询/删除一次运行，将每个运行在自己的表中似乎更自然。
看起来这是一种程序员的心态（一切都应该是单独对象的集合），数据库方法似乎更喜欢 - 将所有内容存储在一起并使用索引/交叉引用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T17:18:30.577

您将拥有一个存储日期/时间/位置的表（运行）和一个整数主键（自动增量）。

您将拥有另一个存储时间/电压/电流/温度的表（测量）、一个整数主键（自动增量）和一个要运行的 FK（只是一个名为 RunID 的非空整数列）。

所以总共2张桌子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T17:52:05.330

您提出这个问题的假设是您需要的不仅仅是两张表，到目前为止所有答案都建议您创建。

但是，您说这是一个关于数据库设计的问题，正确的设计确实是使用这两个表。如果绝对有必要，数据分区是您稍后会做的事情，而且很可能一旦您超过了那些*nx 100 运行 xmx 1000*测量。

带有运行的表不会有很多行。包含测量数据的表将有很多行，但是通过引用运行表的键，您可以创建索引，从而加快数据库操作。您的应用程序设计会更容易 OTOH。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T18:01:29.273

我会做以下事情（感谢格兰特的表格设计）：

```
+-------------------+     +----------------------+
|    Sequence       |     | Measurements         |     +------------------+
+-------------------+     +----------------------+     | Measurement Type |
|  metaID (pri Key) |---->| metaID               |     +------------------+
|  location         |     | typeID               |---->| typeID (pri Key) |
|  other metadata   |     | measureID   (pri Key)|     | typeName         |
+-------------------+     | value                |     | typeUnits        |
                          +----------------------+     +------------------+ 
```

因此类型表将具有：

```
typeID      typeName     typeUnits
0           Volts        V
1           Current      A 
```

测量表将有一个用于每个测量的行。

因此，一个序列行将与多个测量行相关联，每个测量行都将指定它是什么类型的测量。

这将使您能够轻松地使用电压和电流进行一次测试，并使用 volts1、volts2、电流、电阻进行另一次测试，而无需更改表和所有随之而来的查询。

> 许多表（每次运行一个）的原因是可能有 10-100 次运行，每个运行有许多 1000 次测量。如果我只想显示/查询/删除一次运行，将每个运行在它自己的表中似乎更容易

好吧，这实际上并没有那么容易，因为在某些时候您必须决定要查看哪个表并将该表名放入 SQL 语句中。将它们全部放在一个表中同样容易，而不是将表名放入 SQL 请求中，而是将序列名称作为 WHERE sequence="sequencenumber"。即使有数千个条目，这也同样简单并且不应该更慢。在某些 SQL 服务器中，您也可以创建视图，这有点像“假”表。它看起来像一个表，但它实际上是一个嵌入式 SQL 语句——您可以根据需要为每个序列创建一个新视图，然后您可以像操作它们自己的表一样操作它们。

但是 -
你走哪条路真的没关系。如果您对每个序列的表格感到满意，请继续执行。它只是一个数据库，如果/当您了解并需要更复杂的布局时，将现有数据库转换为新的、更灵活的布局并不难。

现在让它变得简单，随着您的学习，您可以根据需要进行调整。

-亚当

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T18:46:31.367

顺便说一句，我想解决一个问题，即管理一个表中的所有数据与拥有多个表相比是否很痛苦。

开始假设：您至少需要一个元数据表来存储实验元数据，以及一个或多个表来存储测量结果。

如果您采用“我想要每个测量集的表格”的方法，您需要知道表格的名称。所以你的元数据表看起来像：

```
Metadata
----------
experimentName
experimentLocation
experimentDateTime
...
measurementTableName 
```

每个实验都有一个表格，每个看起来都一样：

```
Measurement0001    Measurement0002    Measurement0003    Measurementt0004 
--------------     --------------     --------------     -------------- 
measurementNum     measurementNum     measurementNum     measurementNum 
voltage            voltage            voltage            voltage        
amps               amps               amps               amps 
```

然后在您的程序中，您首先需要获取元数据：

```
select * from Metadata where experimentName='Johnson Controls 1' 
```

除其他外，这将为感兴趣的实验返回measurementTableName（例如Measurement0002）。然后，您的下一个查询是：

```
select * from Measurement0002 order by measurementNum 
```

现在，让我们采用“将所有数据存储在测量表中”的方法。您的元数据表将如下所示：

```
Metadata
----------
experimentName
experimentLocation
experimentDateTime
...
measurementSetID 
```

以及所有实验的表格。

```
Measurement
--------------
measurementSetID
measurementNum
voltage            
amps 
```

然后，就像以前一样，您首先需要获取元数据：

```
select * from Metadata where experimentName='Johnson Controls 1' 
```

除其他外，它将为您提供measurementSetID，您将使用它仅从所需集合中获取测量值（假设id = 2）。然后，您的下一个查询是：

```
select * from Measurement where measurementSetID=2 order by measurementNum 
```

所以让我们比较这两种方法......元数据查询本质上是相同的。唯一的区别是，在第一种情况下，您正在检索所需实验表的 measureTableName；而在第二种情况下，您正在检索测量表中所需条目的measurementSetId。

获取测量的查询也基本相同：

```
select * from Measurement0002                      order by measurementNum
select * from Measurement where measurementSetID=2 order by measurementNum 
```

唯一的变量是表名或measurementSetID：

```
select * from <tablename>                                order by measurementNum
select * from Measurement where measurementSetID=<setID> order by measurementNum 
```

查询结果几乎相同，第二种方法只会在数据中为您提供一个额外的列（measurementSetID），您可以忽略它，因为所有返回的行都将具有相同的集合 ID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T17:17:28.050

如果单个测量值具有所有值（时间、电压、电流、温度），那么您将为一个表中的每个值使用一个字段。

如果它们不相关，最好简单地拥有一个值和一个值类型指示器（1=电压，2=电流等）。

如果它们**是**相关的，并且您想要处理元数据，则可能需要一个通用元数据字段和一个元数据类型字段，具体取决于元数据的性质。

为了论证的缘故，让我们假设您的元数据只是位置。您将设置一个位置表，然后将适当的 locationID 放入元数据字段中。（如果要输入 locationId，请确保输入 INT 以便以后加入表格）

您通常会为类型指示器使用查找表，并使用视图通过连接这些字段来创建端口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T17:18:43.523

如果我理解你的问题，我可能会使用两张表。

'测试信息'。每条记录包含运行测试的日期等。这是您的元数据。另外我会添加一个生成的“RunId”，它是一个唯一的数字。

'RunInfo' 每条记录包含runId，以及当前、温度、时间等信息。

RunId 将数据与正确的测试运行联系起来，您不必创建一堆表。此外，您可以在任何测试中对您的 runinfo 进行查询。

现在 - 根据您的用例，这可能并不理想，但它是一个很好的起点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T17:26:20.327

我要做的是在元数据表中有一个唯一的 ID（自动递增），并使用该 ID 将测量值和元数据组合在一起。

```
+-------------------+     +----------------------+
|    Meta Data      |     | Measurements         |
+-------------------+     +----------------------+
|  metaID (pri Key) |---->| metaID <-(index this)| 
|  location         |     | measureID   (pri Key)|
|  metaDate         |     | voltage              |
+-------------------+     | amperes              |
                          | current              |
                          +----------------------+ 
```

您将拥有一堆具有相同元 ID 的测量记录（但它们有自己的 ID），并且它们每个都将与元数据匹配。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T18:11:04.790

笼统地说，两表方法似乎最适合您的应用程序。

为确保良好的性能，请确保在表上创建索引。以 Grant 的模式为例，您需要在 Measurements 表上创建一个索引，以 metaID（主键）和 measureID（辅助键）为键。

每个实验集几千个测量值并不是很多数据 - 因此，通过正确的索引和正确编写的查询，您的数据库将有效地仅读取磁盘以获取所需实验的数据行。

因为您可能一次将来自一个实验的实验数据加载到表中，所以相关数据已经具有高度的局部性——因此您不会从将数据分离到单独的表中受益。

最后，您可能想了解如何创建表视图——这将使您能够创建虚拟表，每个视图仅代表一个实验的数据。您可以按需创建视图，然后在完成后删除视图。

# c# - C++ CLI 神秘的函数调用

> ID：512320
> 
> 赞同：1
> 
> 时间：2009-02-04T17:12:00.853
> 
> 标签：c#, c++-cli, marshalling

所以我试图调用一个函数，它是一个围绕 OCX 对象的管理包装器。有很大的困难。功能是；

```
foo(System::Object ^% theBuffer) 
```

其中 'theBuffer' 是一个字节数组。'foo' 包装的非托管 OCX 的模板是

```
goo(VARIANT* theBuffer); 
```

所以我试过了；

```
System::Int32 buf[10];
foo(buf); 
```

失败了。和

```
Bitmap ^b;
foo(b); 
```

它可以编译，但显然被调用的函数不会为我创建 .NET 位图。

所以我想问题是我如何将这个函数传递给它可以写入的内存块，然后在.NET世界中访问它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:21:03.067

您不能`VARIANT`直接将 a 转换为缓冲区。

首先，您需要通过检查来检查其中存储了哪种对象`theBuffer->vt`。返回的值将是类型`VARTYPE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T17:50:05.410

怎么样..

```
Bitmap ^b = gcnew Bitmap(...
foo(b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T19:02:13.317

好的，所以我实际上是在使用 Axis Media Control SDK 来连接网络摄像机（[http://www.axis.com/techsup/cam_servers/dev/activex.htm](http://www.axis.com/techsup/cam_servers/dev/activex.htm)）。我通过包装器调用的 OCX 函数看起来像；

```
HRESULT GetCurrentImage(int theFormat,    [C++]
        VARIANT* theBuffer,
        LONG* theBufferSize
       ); 
```

包装器由 Axis 提供。使用 .NET Reflector 我已经反汇编了包装函数；

```
public: virtual void __gc* GetCurrentImage(Int32 __gc* theFormat, [Out] Object __gc*   *theBuffer, [Out] Int32 __gc* *theBufferSize)
{
    if (this->ocx == 0)
    {
        throw __gc new InvalidActiveXStateException(S"GetCurrentImage", ActiveXInvokeKind::MethodInvoke);
    }
    this->ocx->GetCurrentImage(theFormat, out theBuffer, out theBufferSize);
} 
```

所以它没有做任何聪明的事情，只是传递了一大块内存。在 C++ CLI 语法中，模板看起来像；

```
GetCurrentImage(int theFormat, System::Object ^% theBuffer, int % theBufferSize) 
```

所以我的问题变成了如何传递这块内存来写入，然后将其恢复回.NET 对象。我试过这个；

```
unsigned char c[100];
GetCurrentImage(0, (System::Object)c, BufSize); 
```

但显然它不起作用。

# opengl-es - 在 OpenGLES 中让精灵正确面对相机

> ID：512326
> 
> 赞同：6
> 
> 时间：2009-02-04T17:13:06.733
> 
> 标签：opengl-es

我有一个或多或少是 2D 的游戏，但以 3D 呈现。摄像机悬停在 2D 游戏场上方，从完全垂直的角度倾斜约 20 度，以提供一点 3D 视角。

我有一些精灵需要被渲染成完全正方形，因为它们代表球形物体。我的第一种方法在 2D 场上将四边形渲染为平面，从而正确定位它们，但精灵受到透视失真的影响，并且它并不总是看起来是圆形的。

我目前的方法是，在渲染精灵时，我将相机移动到垂直于游戏场（和精灵），这保证了四边形永远不会被透视扭曲。缺点是精灵的位置与摄像机倾斜时的位置略有不同。

那么，我怎样才能渲染精灵：

1.  完美的方形和面向相机，但不需要我移动相机来实现这一点。
2.  具有受与相机距离影响的大小（与点精灵不同）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T18:14:46.720

您可以使用始终面向相机的多边形来实现您想要的效果。这被称为“广告牌”。[这是](http://www.lighthouse3d.com/opengl/billboarding/)一个很好的教程，它似乎解释了所涉及的数学以及如何使用 OpenGL 来实现它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T17:49:47.423

按照您的建议绘制垂直于相机的四边形，但将它们放置在场地上方一点。上面的距离应该是球体的半径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-04T04:01:32.410

你仍然可以使用点精灵...使用 glPointParameter() 你可以给它深度衰减。我目前正在使用 0.00025 作为我正在开发的粒子系统的深度衰减。不利的一面是，在第一代机器上（我假设您正在为 iphone 或 ipod touch 执行此操作）您将被困在 64x64 像素的最大精灵大小

# javascript - 使用 firebug 时，部署时是否必须删除控制台输出？

> ID：512331
> 
> 赞同：1
> 
> 时间：2009-02-04T17:13:46.357
> 
> 标签：javascript, firebug

我正在使用萤火虫进行调试等。

当我部署时，似乎我必须从我的 javascript 代码中删除所有 console.log 语句？

在没有萤火虫的浏览器上查看时，我收到与控制台相关的错误...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T17:19:46.580

我用[这篇文章](https://stackoverflow.com/questions/398111/javascript-that-detects-firebug)创建了一个日志功能。它将避免这些错误。

```
function log(string) {  
  if (window.console && window.console.firebug) {
    console.log(string);
  }
} 
```

打字也更容易:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T17:16:01.173

是的，由于 IE 没有控制台，它们会导致 IE 错误。

这也是一种很好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-08T22:27:27.677

关于 StuffMaster 的回答：请看[这个答案](https://stackoverflow.com/a/8781890/1132101)——`console.firebug`不再是检查萤火虫可用性的有效方法。

# java - JAXB 中的自定义序列化

> ID：512337
> 
> 赞同：1
> 
> 时间：2009-02-04T17:14:51.253
> 
> 标签：java, xml, xml-serialization, jaxb

有没有办法在 JAXB 中自定义 XML 序列化，就像在 .NET 中使用 IXmlSerializable 一样？（即使用等效的 XmlReader/Writer 直接控制对象序列化的能力）。

我已经查看了 XmlAdapter 和 @XmlJavaTypeAdapter，但它们似乎只是用于将类型转换为可序列化形式和从可序列化形式转换，这并不是我想要的。

更新：特别是，我想自定义根对象的反序列化，它以编程方式确定如何反序列化内部 XML（例如，创建具有一组特定已知类型的 jaxb 解组器）。

更新：我找到了解决问题的方法，但这是一个令人讨厌的 hack，我可能会采用其他海报建议的解决方案之一。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T10:38:21.147

好的，所以我设法让这个工作，虽然它是如此讨厌的解决方案，我想我会找到解决问题的更高级别的方法，正如 Fabian 和 basszero 所提到的。以下代码的想法是创建一个对要序列化的数据的通用可序列化引用，它维护一个 JAXB Java 类型适配器以编程方式执行序列化，以及一个存储生成的 XML 的字符串字段。

注意：代码已大大简化以显示...

```
// Create an instance of this class, to wrap up whatever you want to custom-serialize
@XmlRootElement
public static class SRef
{
    public SRef() { }
    public SRef(Object ref)
    {
        this.ref = ref;
    }

    @XmlJavaTypeAdapter(SRefAdapter.class)
    public Object ref;
}

// This is the adapted class that is actually serialized 
public static class SRefData
{
    // This is a hint field to inform the adapter how to deserialize the xmlData
    @XmlAttribute
    public String hint;

    // This contains the custom-serialized object
    @XmlElement
    public String xmlData;
}

    // Converts an object to and from XML using a custom serialization routine
public static class SRefAdapter extends XmlAdapter<SRefData, Object>
{
    @Override
    public SRefData marshal(Object value) throws Exception
    {
        if (value instanceof MyType)
        {
            SRefData data = new SRefData();
            data.xmlData = doSomeSpecificSerialization(value);
            data.hint = "myType";
            return data;
        }
        throw new IllegalArgumentException("Can't serialize unknown object type " + value.getClass());
    }

    @Override
    public Object unmarshal(SRefData refData) throws Exception
    {
        if (refData.hint.equals("myType"))
        {
            return doSomeSpecificDeserialization(refData.xmlData);
        }
        throw new IllegalArgumentException("Unhandled hint value in SRefData: " + refData.hint); 
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T22:37:11.037

我不确定我完全理解你的目标是什么，但也许你可以在你的根对象的无参数构造函数中以编程方式做你想做的事情，当对象被解组时，它将被调用来实例化对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T23:08:22.477

听起来您希望根节点基于从根节点本身获得的某种属性或知识包含两组不同的 xml 节点/树。

我倾向于通过首先创建一个模式 (xsd) 然后生成 Java 源代码来使用 JAXB，我从不修改它。我只修改架构和再生。我意识到JAXB不能以其他方式使用，通过注释源，购买我不能那样说，因为我不使用它。如果您是架构...请继续阅读

考虑一下：[http ://www.w3schools.com/Schema/schema_complex_indicators.asp](http://www.w3schools.com/Schema/schema_complex_indicators.asp)

而不是切换解组器，只需包含两个 xml 定义。无论如何，它们都会被解析，您可以通过在根节点上检查的任何属性来改变程序控制流。

# java - Java中的正则表达式，查找开始和结束标记

> ID：512342
> 
> 赞同：1
> 
> 时间：2009-02-04T17:15:07.650
> 
> 标签：java, html, regex, matcher

我正在尝试在 HTML 文档中查找数据。我不需要一个完整的解析器，因为它只是一个标签之间的数据。

但是，我想检测“选择”标签和介于两者之间的数据。

```
return Pattern.compile(pattern, 
                       Pattern.CASE_INSENSITIVE | Pattern.MULTILINE |
                       Pattern.DOTALL);

/// End right angle bracket left off intentionally:
track_pattern_buf.append("<select");
track_pattern_buf.append("(.*?)");
track_pattern_buf.append("</select"); 
```

这是您将使用的“正则表达式”吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T17:31:32.907

如果您真的想使用正则表达式进行拼接（这不是最佳选择），我会使用：

```
"<select[^>]*>(.+?)</select\s*>" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:28:14.877

我会使用看起来像这样的东西：

```
"<select>([^<>]+)</select>" 
```

我不确定您为什么不使用“>”并且我不想匹配其他标签（这里我假设我们正在寻找文本数据而不是文档片段）。

话虽这么说，我真的会考虑获取一个 DOM 并使用 XPath（或类似的）来进行查询，因为正则表达式的[处理能力并不为人所知](http://steve.yegge.googlepages.com/the-emacs-problem)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T17:31:32.750

我认为更安全的是拥有类似的东西：

```
"<\s*select\s*>(.*?)<\s*/select\s*>" 
```

为了提高安全性，您可能应该在第一次选择之后添加 \w*，以防出现任何其他选择选项。

如果您的 HTML 符合标准，第三个 \s* 也可能会被跳过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T19:48:45.867

我知道您认为您不需要一个成熟的解析器 - 我们都曾在某个时候编写过 HTML 正则表达式解析器，并认为“我的用例非常简单，*这次*我肯定可以使用正则表达式！”

但我认为每个完成它的人最终都会得出结论，将繁重的工作外包给现有的众多优秀解析器之一会更快、更容易、更简单和更安全。我知道我有。

查看[jSoup](http://jsoup.org/) - 它简单、快速且有效。真的没有充分的理由不使用它。

如果您仍然不相信，那么您必须来询问正确的模式是什么这一事实-*您得到了三个不同的答案作为回应-没有一个可以完成整个工作*-应该说明问题要复杂得多比乍一看似乎。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-03T13:36:38.387

根据您的需要，我还建议您进行负面预测，以确保您在第一次出现选择时停止。

```
"(?<selectGroupName><select>((?:(?!select).)*)</select>)" 
```

这里的重要部分是“((?:(?!select).)*)”，它接受任何不与否定前瞻冲突的内容。

同样也可以通过使用惰性量词来完成：

```
"(?<selectGroupName><select>(.*?)</select>)" 
```

这些都将确保您将在第一次出现阻止您同时参加多个部分时停止。然而，它并不能保护您免受嵌套选择标签的影响，相反，这些标签会导致此表达式出现问题。使用此表达式，以下将是一个问题：

```
<select>
    <select>
    </select>
</select> 
```

如果没有前瞻或惰性量词，则会出现以下问题：

```
<select>
</select>
<a>
    <select>
    </select>
</a> 
```

# .net - .NET 的通用缓存机制

> ID：512343
> 
> 赞同：2
> 
> 时间：2009-02-04T17:15:08.587
> 
> 标签：.net, caching

我有一个类库，它有一个 Person 类。Person 类包括 CountryName 和 CountryCode 的属性。CountryCode 是存储在 Person 表中的值。CountryName 从随附的查找表中检索。

因为 CountryName 和 CountryCode 之间的映射不可能永远改变，所以我对在 Person 业务对象中使用缓存进行查找感到很自在。

我的类库将来将用于 ASP.NET 站点以及控制台和 Windows 应用程序。 **实现这种类型的通用缓存的正确机制是什么？** （注意小“g”，而不是 .NET 泛型）

您可能会争辩说缓存应该在不同的层完成，但我仍然可能会受益于适用于任何类型 .NET 项目的缓存机制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:26:22.043

我使用[企业库](http://msdn.microsoft.com/en-us/library/cc512464.aspx)缓存应用程序块来缓存我的应用程序的每一层。在 ASP.NET 中，我使用内置的 ASP.NET 缓存。

我实际上建议您使用与实现无关的缓存接口创建一个单独的程序集。这样，您可以稍后在需要时交换实现，而无需在大量地方更改代码。这也将允许您在 ASP.NET 和其余代码中使用相同的缓存接口，但使用 Unity 等依赖注入框架替换实际实现。

# sql - 您使用了哪些编码技巧来避免编写更多的 sql？

> ID：512350
> 
> 赞同：7
> 
> 时间：2009-02-04T17:16:06.243
> 
> 标签：sql, reference

这个问题是[Kyralessa](https://stackoverflow.com/users/5486/kyralessa)在[What is your most useful sql trick to avoid writing more sql?中提出的。](https://stackoverflow.com/questions/488020/what-is-your-most-useful-sql-trick-to-avoid-writing-more-code) 我从最后一个问题中得到了很多好主意，我很想看看这个问题会带来什么。

再一次，我没有保留这个问题的声誉。我等了 7 天，等待答案，然后将其标记为 wiki。该问题所获得的声誉将成为该问题的赏金。

基本原则：

*   虽然编写代码当然是合理的，但将处理从 SQL 转移到代码中以解决性能问题，但这并不是问题的重点。问题不仅限于性能问题。目标不是简单地使用更少的 sql 来完成工作。

*   传达这个概念，让其他用户说“哦，哇，我不知道你能做到这一点。”

*   示例代码非常有用，可以帮助主要是视觉学习者的人。

*   明确说明您使用的语言以及您使用的 SQL 方言。

*   设身处地为读者着想。他们需要在他们面前的屏幕上看到什么，这会引起顿悟。你的答案是为了让读者受益。为他们写。

*   非现场链接是可以的，如果它们出现在示例之后。代替真实答案的非现场链接不是。

可能还有其他一些我没有想到的让读者觉得更好的事情。发挥创意。分享知识。尽情炫耀吧。

[编辑] - 好像有一段时间没有任何活动了。5 票 = 50，所以有赏金，并且已被维基化。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T17:29:19.913

如果您想避免编写 SQL，请使用诸如 nHibernate 之类的 ORM，或 Microsoft 提供的 Linq to SQL / Entity Framework 之一

这甚至比使用生成器更好，因为您不需要重新运行生成器，并且如果您使用 Fluent nHibernate，您可以通过约定启用配置，甚至无需维护映射文件/类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T17:20:33.317

从`INFORMATION_SCHEMA`. 然后可以使用自定义代码来增强该代码生成。

如果多个SP会做类似的事情，为了方便单点维护，我会生成动态SQL来代替。

所有这些都导致更少的 SQL 代码，更多的代码被重用，因此得到更好的测试——就像任何库一样。

[这是避免编写SQL的代码生成示例](https://stackoverflow.com/questions/507869/trim-all-database-fields)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T17:35:47.123

语言：C#/VB.NET。

我目前可以编写一个数据库支持的系统，而无需编写任何 SQL。我的 DAL 使用 POJO 的类定义动态生成 SQL。例子：

```
SearchCriteria sc = new SearchCriteria();
sc.AddBinding("Customer_id", "ALFKI");
List<Entity> customers = SQL.Read(sc, new Customers()); 
```

上面的代码将返回与 Customer_id 匹配到“ALFKI”的客户实例列表。DAL 连接到数据库，构建 SQL，执行它，实例化新对象，填充它们并将它们发回。完成更改对象后，只需调用

```
SQL.Write(customer); 
```

将所有更改的项目更新回数据库 - 请注意，只有更改的项目和更改的列。

额外的好处：它支持 SQL Server、Oracle、Informix。客户端代码永远不必更改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T15:03:46.260

我在 PHP for MySQL 中推出了自己的 ORL（对象关系映射器）。它确实简化了与更改数据库有关的所有事情，并且在简单的情况下效果很好。

它由一个可以继承的基类组成。您可以轻松地将其子类化：

```
<?php
class CSomething extends CDatabaseObject
{

}

// create a new Something
$oSomething = new CSomething();
$oSomething->somevariable = 'blah';
$oSomething->Save();

// fetch an old Something by primary key
$oSomething = new CSomething(1);
// .. and delete it
$oSomething->Delete();
?> 
```

它会自动计算出表中的索引和主键。如果需要，您当然可以告诉班级这些事情，如果它做了坏事。

您可以通过指定 SQL 的 WHERE 子句来进行基本搜索（因此它不是完全免费的 SQL）。由于现在涉及字段的数据类型，因此参数化查询很简单。

当然，它不能做我需要的一切，但它节省了大量的开发时间和代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T18:23:54.127

在我工作的地方，我们做了几件事来减少 SQL 并减少在 Java 中使用 SQL 的相关开销。（我们使用 MSSQL、MySQL 和 Oracle 运行 Java）。

最有用的技巧是使用 Java 的 setObject 方法来绑定参数。这与 Varargs 相结合，让您可以编写一个用于执行 SQL 的实用方法：

```
DBUtil.execSQL(Connection con, String sql, Object... params) 
```

只需遍历参数并使用 statement.setObject(index, param[index-1])。对于空值，您使用 setNull()。我们使用 getResultSet 方法扩展了查询的这个概念；包装后的 ResultSet 对象也会关闭其语句，从而更容易进行资源管理。

为了减少实际编写的 SQL 代码，我们有一个查询构建框架，可以让您指定一堆列及其类型，然后使用它来自动指定搜索条件和输出列。我们可以轻松地指定连接和连接条件，这可以处理大多数正常情况。好处是大约10行代码就可以生成报表，包括不同的查询参数、排序、分组等。代码太复杂，这里就不放了。

我还使用了 Oracle 的 ALL_TABLES 和 ALL_TAB_COLUMNS 表来生成 SELECT 语句；我使用的另一个技巧是使用 ResultSetMetadata 来分析表：

```
ResultSet rs = DBUtil.getResultSet(con, "SELECT * FROM " + someTable);
ResultSetMetaData rsm = rs.getMetaData();

boolean first = true;
for (int i = 1; i <= rsm.getColumnCount(); i++) {
  String col = rsm.getColumnName(i).toUpperCase();
  // do something with the column name
} 
```

这使得生成某些类型的语句变得容易；在这种情况下，我们有一个活动表和一个存档表，我们正在将记录从一个表移动到另一个表。无需对使用存档表进行辩论，我编写的 Java 代码允许我修改这两个表，而无需修改存档脚本。

我们使用的另一个技巧是对所有表名和列名使用常量。这使得输入 SQL 有点乏味，但它允许我们（除其他外）为具有相似或相同结构的表轻松生成 SQL。由于我们使用常量来定义列名，因此代码实际上强制相同的列具有相同的名称。使用常量还可以让您找到对特定列的引用，从而允许您检查可能与您正在做的工作相关的其他 SQL 语句。这让我们可以重用来自其他模块的 SQL，而不是盲目地重新编写相同的语句。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T20:59:16.107

在我的一个项目中，我使用了一个元模型（表、列、关系），它将信息添加到内置的 sys* 视图中。

我的元模型中的部分数据用于为插入/更新/删除生成日志记录触发器，并在代替删除触发器中实现级联删除。约。100 个表为这些触发器生成的代码大约是 12.000 行 TSQL 代码。

SP 生成一个 C# 数据结构，它将实时数据库模式与我的开发数据库模式进行比较，以确保升级正常。

最近，元模型甚至允许我在基于 FormView 的 Asp.Net 表单中生成用于删除验证的 C# 代码（即，如果存在依赖记录，则不能删除记录）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T16:27:45.317

我建议创建专注于任务的共享方法，并使用简单的 SQL 元素，而无需编写 sql。我使用 Subsonic 来访问 MS SQL 的数据。但是，您可以使其与数据库无关，例如 DAL。这些示例可以自定义为 ORM，或者您可以访问数据。我建议创建一个将其缩小到特定任务的静态类。

例如，如果您有一个要填充的数据网格，并且您知道要从中填充它的视图、表、存储过程，请创建一个类似于以下 c# 代码的函数：

```
public static void BindDataGridViewWhere(DataGridView dgv, string tablename, string selectList, string whereClause)
{
    Query qQuery = new Query(tablename);
    qQuery.SelectList = selectList;
    qQuery.WHERE(whereClause);
    DataSet dsDGV = qQuery.ExecuteDataSet();
    dgv.DataSource = dsDGV.Tables[0];
    dgv.RowHeadersVisible = false;
} 
```

然后，在页面初始化或类似的东西中，对该方法进行简单的 1 行调用，将 datagridview 与 where 语句一起传入，您希望出现的内容以及在选择中的方式，以及 where 子句和您的绑定。

BindDataGridViewWhere(dgvCars, "tbl_Cars", "CarName", "Color, mdl as Model", "Color = 'blue'");

这适用于您进行大量绑定的任何对象，例如下拉框、列表框、数据网格视图等。然后，对于不适合此模型的其他人，有一个只返回数据集的方法。这样，如果您需要在显示之前与之交互，您可以执行其他业务逻辑等。

我喜欢这种方法，因为如果您想切换数据框架，您可以在 1 个地方进行更改。通过这种方式，您可以非常快速地构建屏幕。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T07:46:32.970

如果您可以使用 python 环境，我强烈推荐 SQLAlchemy。

我尝试的另一件事是编写自己的模式生成器来测试我们的工作系统。这更多是为了生成不同的查询组合以试图使系统崩溃。基本上，我定义了一个伪解析树，带有字典和列表

[SQL炼金术](http://www.sqlalchemy.org/)

这是一个代码片段

```
>>>for row in session.query(User, User.name).all():
...    print row.User, row.name
SELECT users.id AS users_id, users.name AS users_name, users.fullname AS users_fullname, users.password AS users_password FROM users []
<User('ed','Ed Jones', 'f8s7ccs')> ed
<User('wendy','Wendy Williams', 'foobar')> wendy
<User('mary','Mary Contrary', 'xxg527')> mary
<User('fred','Fred Flinstone', 'blah')> fred 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-12T01:03:12.243

使用内置的 .NET 功能，例如表达式列（显示 VB 示例）来数据绑定多个列以同时显示：

```
ds.Tables(0).Columns.Add(
    New DataColumn("CustomDescription", GetType(String), 
                   "LastName + ', ' + FirstName + ' - ' + 
                   WorkEmail"))
ResultsListBox.DataSource = ds
ResultsListBox.DataTextField = "CustomDescription"
ResultsListBox.DataValueField = "EmployeeID"
ResultsListBox.DataBind() 
```

# html - 可移植的相对 URL - 到域根目录的文件夹

> ID：512355
> 
> 赞同：2
> 
> 时间：2009-02-04T17:16:38.163
> 
> 标签：html, url

我想编写有效的 URL，无论基本 URL 是否是：

> [http://example.com/myfolder/](http://example.com/myfolder/)
> 
> [http://example.com/](http://example.com/)

例如

```
<a href="other.html">Other</a> 
```

应该去

> [http://example.com/myfolder/other.html](http://example.com/myfolder/other.html)
> 
> [http://example.com/other.html](http://example.com/other.html)

分别，

但相反，在这两种情况下，他们都会去：

> [http://example.com/other.html](http://example.com/other.html)

如果基本 URL 是

> [http://example.com/myfolder/index.html](http://example.com/myfolder/index.html)
> 
> [http://example.com/index.html](http://example.com/index.html)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T17:20:55.657

相对 URI 总是从基本 URI 解析出来，如果没有明确声明，基本 URI 就是文档的 URI（参见`base`元素）。那么在您的情况下，基本 URI 是什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T17:23:37.883

我怀疑您正在使用以下基本网址进行测试：

[http://example.com/myfolder](http://example.com/myfolder)

（没有尾部斜杠）

如果没有斜线，浏览器会认为“myfolder”只是一个文件而不是文件夹。因此，单击相对 url 不会进入该文件夹。

[http://example.com/myfolder/](http://example.com/myfolder/)

如果基本 url 是这样的，那么它应该可以按您的预期工作。

通常，我更喜欢使用绝对 URL 来避免这些麻烦。几乎我的 webapps 中的每个链接都采用以下样式：

/myfolder/other.html

它总是从任何位置指向同一个地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T17:20:41.633

如果你给完全一样

```
<a href="other.html">Other</a> 
```

这是一个相对地址，它应该像那样工作。

请记住，当您链接到文件时：

```
www.example.com/folder/other.html 
```

从：

```
www.example.com/index.html 
```

您必须将 index.html 中的链接指定为：

```
<a href="folder/other.html">Other</a> 
```

也就是说，您必须使用相对地址链接到文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T17:20:40.587

您是在静态 HTML 中执行此操作吗？"../other.html" 可能是一个安全的选择（假设你不再嵌套）。

# javascript - Javascript Regex 对象和美元符号

> ID：512363
> 
> 赞同：3
> 
> 时间：2009-02-04T17:18:42.307
> 
> 标签：javascript, regex

在下面的代码中。我期望是真的，但我却是假的。我错过了什么？

```
var text = "Sentence $confirmationlink$ fooo";     
alert(placeHolderExists(text,'confirmationlink'); // alerts false
function placeHolderExists(text,placeholdername) {  
  var pattern = new    RegExp('\$'+placeholdername+'\$');    
  return pattern.test(text);
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T17:25:22.077

RegExp 表达式构建器中的“\”在构建字符串时被视为转义字符，就像在实际 RegExp 中一样。您需要逃脱两次，请尝试：

```
new RegExp('\\$'+placeholdername+'\\$'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T17:24:50.843

应该

```
function placeHolderExists(text,placeholdername) {  
  var pattern = new    RegExp('\\$'+placeholdername+'\\$');    
  return pattern.test(text);
} 
```

您需要双重转义 $ 符号

编辑：
[annakata](https://stackoverflow.com/questions/512363/javascript-regex-object-and-the-dollar-symbol/512418#512418)解释了原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T19:16:44.393

这种混淆是另一个例子，说明除非你真的需要，否则你不应该使用正则表达式。

```
return text.indexOf('$'+placeholdername+'$')!=-1; 
```

...更简单，更快，并且当你有有趣的角色时不会摔倒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T17:27:37.203

把你的斜线加倍。

```
new RegExp('\\$'+placeholdername+'\\$'); 
```

# vpn - 以编程方式确定 Cisco VPN Client 是否已连接

> ID：512365
> 
> 赞同：6
> 
> 时间：2009-02-04T17:18:50.637
> 
> 标签：vpn, cisco

我正在使用基本的 Cisco VPN 客户端（我相信 v.5）。无论如何，是否以编程方式确定是否连接了特定配置文件（或任何相关配置文件）？

我希望以某种方式从客户本身获得状态。我不想尝试 ping VPN 另一端的某个 IP 来查看是否得到响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T11:58:09.520

我不知道 Cisco VPN 客户端有任何 API，但您可以使用底层操作系统。

在 Mac OS X 上，您可以查询系统配置框架，因为当 Cisco VPN 客户端连接时，它会在配置目录（DNS 和其他东西）中创建许多键：

```
$ printf "get State:/Network/Service/com.cisco.VPN" | sudo scutil 
```

上面的程序等价物可以在普通的 C Carbon 或 ObjC Cocoa 中实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-01T21:07:01.607

[Cisco VPN](http://www.cisco.com/en/US/docs/security/vpn_client/cisco_vpn_client/vpn_client500_501/release/notes/51client.html#wp1549190)有一个 API (vpnapi.dll)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-07T19:30:53.407

实际上，有几种方法，而不使用 API（我仍然找不到/DL）

最简单的方法之一是检查位于以下位置的注册表设置：HKEY_LOCAL_MACHINE\SOFTWARE\Cisco Systems\VPN Client\AllAccess\TunnelEstablished（0 或 1）

另一种方法是通过使用 ManagementObjectSearcher 建立的网络接口的名称来检测它，示例代码如下：

```
 ManagementObjectSearcher query = null;
                try { query = new ManagementObjectSearcher("SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = 'TRUE'"); }
                catch (Exception ex)
                {

                }
                // "native code call stack error" 
                try { queryCollection = query.Get(); }
                catch (Exception ex)
                {

                }
                int i = 0;
                try
                {
                    foreach (ManagementObject mo in queryCollection)
                    {
                        MojPopisDostupnih[i] = mo["Description"].ToString();
                        // networksListBox.Items.Add(mo["Description"].ToString());
                        i = i + 1;
                    }
                    for (int j = 0; j <= MojPopisDostupnih.Length - 1; j++)
                    {
                        if (MojPopisDostupnih[j] != null)
                        {
                            if (MojPopisDostupnih[j].IndexOf("Cisco Systems VPN Adapter") != -1)
                            {  }
                            else 
                             {  }
                        }
                    }
                }
                catch (Exception ex)
                {

                } 
```

另一种方法是使用 process.start 运行“vpnclient stat”的 CLI（命令行），将标准输出重定向到应用程序中的字符串生成器，然后检查字符串是否包含适当的数据 - 有关更多信息，请参见此处：

[http://www.cisco.com/en/US/docs/security/vpn_client/cisco_vpn_client/vpn_client46/administration/guide/vcAch5.html](http://www.cisco.com/en/US/docs/security/vpn_client/cisco_vpn_client/vpn_client46/administration/guide/vcAch5.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-04T15:08:02.387

在 vbs 脚本下方检查连接状态：

```
bIsVPNConnected = False

Set objWMIService = GetObject("winmgmts:\\.\root\CIMV2") 
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_NetworkAdapterConfiguration",,48) 

For Each objItem in colItems 
   strConnection = LCase(objItem.Description)

   If(InStr(strConnection, "cisco") > 0) Then
      wscript.echo (strConnection)
      bIsVPNConnected = objItem.IPEnabled
   End If
Next

If(bIsVPNConnected) Then
   WScript.echo  "VPN connected"
Else
   WScript.echo  "Not VPN connected"
End If 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-25T22:25:17.587

正如“diciu”所写，您可以查询系统配置框架。他给出的 scutil 命令的程序等价物类似于

```
#import <SystemConfiguration/SystemConfiguration.h>

- (void)printPrimaryService {

    SCDynamicStoreRef dynamicStoreDomainState = SCDynamicStoreCreate(NULL,
                                                                     CFSTR("myApplicationName"),
                                                                     NULL,
                                                                     NULL);
    if (dynamicStoreDomainState) {
        NSString *netIPv4Key = [NSString stringWithFormat:@"%@/%@/%@/%@",
                                kSCDynamicStoreDomainState,
                                kSCCompNetwork,
                                kSCCompGlobal,
                                kSCEntNetIPv4];
        NSMutableDictionary *netIPv4Dictionary = (NSMutableDictionary *) SCDynamicStoreCopyValue(dynamicStoreDomainState, (CFStringRef)netIPv4Key);
        if (netIPv4Dictionary ) {
            NSString *primaryService = [netIPv4Dictionary objectForKey:(NSString *)kSCDynamicStorePropNetPrimaryService];
            if (primaryService) {
                NSLog(@"primary service = \"%@\"\n", primaryService);   /* When the Cisco VPN is active, I get "com.cisco.VPN" here */
            }
            [netIPv4Dictionary release];
        }
        CFRelease(dynamicStoreDomainState);
    }
} 
```

使用上述内容，您可以判断 Cisco VPN 客户端是否已连接。然后，您可以执行类似的操作来获取与 VPN 连接关联的 DNS 服务器。我将生成的 DNS 服务器与我公司的 DNS 服务器进行比较，以判断我是否通过 VPN 进入了我的公司。Klunky，但它可以工作而且速度很快 - 无需等待 ping 超时。

请注意，在最新版本的 Cisco VPN Client 中，Cisco 发布了一个 API。不幸的是，它仅适用于 Microsoft Windows。也许有一天他们会为 Mac 生产一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-01T21:09:45.033

好吧，如果一切都失败了，请解析“路线”的输出。CiscoVPN 使用的路由有一个明显的标记。

# delphi - 如何将字符串从我的 Delphi 程序的一个实例发送到另一个实例？

> ID：512366
> 
> 赞同：18
> 
> 时间：2009-02-04T17:18:50.840
> 
> 标签：delphi, dde, message-passing

将字符串从我的程序的一个实例发送到我的程序的另一个实例的最佳和最简单的方法是什么？接收程序必须执行一个过程，使用接收到的字符串作为参数。

我开始阅读有关 DDE 的内容，但我感到困惑。我还有哪些其他选择，最简单的方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-04T19:01:30.557

使用命名管道，但我会推荐 Russell Libby 的命名管道组件。有一个 TPipeClient 和 TPipeServer 组件。

截至 (2013-10-04) [Francoise Piette 和 arno.garrels@gmx.de 更新了此源代码](http://francois-piette.blogspot.com/2013/04/inter-process-communication-using-pipes.html)以使用 Delphi 7 编译到 XE5（早期版本可能编译但未经测试）并将其放在这里： [http://www.overbyte .be/frame_index.html?redirTo=/blog_source_code.html](http://www.overbyte.be/frame_index.html?redirTo=/blog_source_code.html)

这两个组件使使用命名管道变得非常容易，命名管道非常适合进程间通信 (IPC)。

[他的网站在这里](http://home.roadrunner.com/~rllibby/source.html)。寻找“Pipes.zip”。来自源的描述是： // 描述：Delphi 的客户端和服务器命名管道组件集，以及 // 以及控制台管道重定向组件。

此外，Russell 帮助我在 Experts-Exchange 上使用该组件的旧版本在控制台应用程序中工作，以通过命名管道发送/接收消息。这可能有助于指导您开始使用他的组件。请注意，在 VCL 应用程序或服务中，您不需要像我在此控制台应用程序中那样编写自己的消息循环。

```
program CmdClient;
{$APPTYPE CONSOLE}

uses
  Windows, Messages, SysUtils, Pipes;

type
  TPipeEventHandler =  class(TObject)
  public
     procedure  OnPipeSent(Sender: TObject; Pipe: HPIPE; Size: DWORD);
  end;

procedure TPipeEventHandler.OnPipeSent(Sender: TObject; Pipe: HPIPE; Size: DWORD);
begin
  WriteLn('On Pipe Sent has executed!');
end;

var
  lpMsg:         TMsg;
  WideChars:     Array [0..255] of WideChar;
  myString:      String;
  iLength:       Integer;
  pcHandler:     TPipeClient;
  peHandler:     TPipeEventHandler;

begin

  // Create message queue for application
  PeekMessage(lpMsg, 0, WM_USER, WM_USER, PM_NOREMOVE);

  // Create client pipe handler
  pcHandler:=TPipeClient.CreateUnowned;
  // Resource protection
  try
     // Create event handler
     peHandler:=TPipeEventHandler.Create;
     // Resource protection
     try
        // Setup clien pipe
        pcHandler.PipeName:='myNamedPipe';
        pcHandler.ServerName:='.';
        pcHandler.OnPipeSent:=peHandler.OnPipeSent;
        // Resource protection
        try
           // Connect
           if pcHandler.Connect(5000) then
           begin
              // Dispatch messages for pipe client
              while PeekMessage(lpMsg, 0, 0, 0, PM_REMOVE) do DispatchMessage(lpMsg);
              // Setup for send
              myString:='the message I am sending';
              iLength:=Length(myString) + 1;
              StringToWideChar(myString, wideChars, iLength);
              // Send pipe message
              if pcHandler.Write(wideChars, iLength * 2) then
              begin
                 // Flush the pipe buffers
                 pcHandler.FlushPipeBuffers;
                 // Get the message
                 if GetMessage(lpMsg, pcHandler.WindowHandle, 0, 0) then DispatchMessage(lpMsg);
              end;
           end
           else
              // Failed to connect
              WriteLn('Failed to connect to ', pcHandler.PipeName);
        finally
           // Show complete
           Write('Complete...');
           // Delay
           ReadLn;
        end;
     finally
        // Disconnect event handler
        pcHandler.OnPipeSent:=nil;
        // Free event handler
        peHandler.Free;
     end;
  finally
     // Free pipe client
     pcHandler.Free;
  end;

end. 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-04T17:24:52.543

我为此使用命名管道，这是我发现的最简单的管道。下班回家后我会发布代码。

这是一篇关于如何在delphi中使用它的文章：http: [//www.delphi3000.com/articles/article_2918.asp? SK=](http://www.delphi3000.com/articles/article_2918.asp?SK=)

顺便说一句，这有一百万种解决方案，所有这些似乎都很烦人。Pipes 是迄今为止我发现的最好的。

这是代码，抱歉延迟。您也应该查看 Mick 提到的 Pipe 库。我在这里所做的事情是一个非常快速的实验。请注意，它是在 Delphi 2009 中制作的。

```
unit PetriW.Pipes;

interface

uses
  Windows,
  Classes,
  Forms,
  SyncObjs,
  SysUtils
  ;

type
  TPBPipeServerReceivedDataEvent = procedure(AData: string) of object;

  TPBPipeServer = class
  private
    type
      TPBPipeServerThread = class(TThread)
      private
        FServer: TPBPipeServer;
      protected
      public
        procedure Execute; override;

        property  Server: TPBPipeServer read FServer;
      end;
  private
    FOnReceivedData: TPBPipeServerReceivedDataEvent;
    FPath: string;
    FPipeHandle: THandle;
    FShutdownEvent: TEvent;
    FThread: TPBPipeServerThread;
  protected
  public
    constructor Create(APath: string);
    destructor Destroy; override;

    property  Path: string read FPath;

    property  OnReceivedData: TPBPipeServerReceivedDataEvent read FOnReceivedData write FOnReceivedData;
  end;

  TPBPipeClient = class
  private
    FPath: string;
  protected
  public
    constructor Create(APath: string);
    destructor Destroy; override;

    property  Path: string read FPath;

    procedure SendData(AData: string); overload;
    class procedure SendData(APath, AData: string); overload;
  end;

implementation

const
  PIPE_MESSAGE_SIZE = $20000;

{ TPipeServer }

constructor TPBPipeServer.Create(APath: string);
begin
  FPath := APath;

  FShutdownEvent := TEvent.Create(nil, True, False, '');

  FPipeHandle := CreateNamedPipe(
    PWideChar(FPath),
    PIPE_ACCESS_DUPLEX or FILE_FLAG_OVERLAPPED,
    PIPE_TYPE_MESSAGE or PIPE_READMODE_MESSAGE or PIPE_WAIT,
    PIPE_UNLIMITED_INSTANCES,
    SizeOf(Integer),
    PIPE_MESSAGE_SIZE,
    NMPWAIT_USE_DEFAULT_WAIT,
    nil
  );

  if FPipeHandle = INVALID_HANDLE_VALUE then
    RaiseLastOSError;

  FThread := TPBPipeServerThread.Create(true);
  FThread.FreeOnTerminate := false;
  FThread.FServer := self;
  FThread.Resume;
end;

destructor TPBPipeServer.Destroy;
begin
  FShutdownEvent.SetEvent;
  FreeAndNil(FThread);
  CloseHandle(FPipeHandle);
  FreeAndNil(FShutdownEvent);

  inherited;
end;

{ TPipeServer.TPipeServerThread }

procedure TPBPipeServer.TPBPipeServerThread.Execute;
var
  ConnectEvent, ReadEvent: TEvent;
  events: THandleObjectArray;
  opconnect, opread: TOverlapped;
  Signal: THandleObject;
  buffer: TBytes;
  bytesRead, error: Cardinal;
begin
  inherited;

  //SetThreadName('TPBPipeServer.TPBPipeServerThread');

  ConnectEvent := TEvent.Create(nil, False, False, '');
  try
    setlength(events, 2);
    events[1] := Server.FShutdownEvent;

    FillMemory(@opconnect, SizeOf(TOverlapped), 0);
    opconnect.hEvent := ConnectEvent.Handle;

    while not Terminated do
    begin
      ConnectNamedPipe(Server.FPipeHandle, @opconnect);

      events[0] := ConnectEvent;
      THandleObject.WaitForMultiple(events, INFINITE, False, Signal);
      if Signal = ConnectEvent then
      try
        // successful connect!
        ReadEvent := TEvent.Create(nil, True, False, '');
        try
          FillMemory(@opread, SizeOf(TOverlapped), 0);
          opread.hEvent := ReadEvent.Handle;
          setlength(buffer, PIPE_MESSAGE_SIZE);

          if not ReadFile(Server.FPipeHandle, buffer[0], PIPE_MESSAGE_SIZE, bytesRead, @opread) then
          begin
            error := GetLastError;
            if error = ERROR_IO_PENDING then
            begin
              if not GetOverlappedResult(Server.FPipeHandle, opread, bytesRead, True) then
                error := GetLastError
              else
                error := ERROR_SUCCESS;
            end;
            if error = ERROR_BROKEN_PIPE then
              // ignore, but discard data
              bytesRead := 0
            else if error = ERROR_SUCCESS then
              // ignore
            else
              RaiseLastOSError(error);
          end;

          if (bytesRead > 0) and Assigned(Server.OnReceivedData) then
            Server.OnReceivedData(TEncoding.Unicode.GetString(buffer, 0, bytesRead));

          // Set result to 1
          PInteger(@buffer[0])^ := 1;
          if not WriteFile(Server.FPipeHandle, buffer[0], SizeOf(Integer), bytesRead, @opread) then
          begin
            error := GetLastError;
            if error = ERROR_IO_PENDING then
            begin
              if not GetOverlappedResult(Server.FPipeHandle, opread, bytesRead, True) then
                error := GetLastError
              else
                error := ERROR_SUCCESS;
            end;
            if error = ERROR_BROKEN_PIPE then
              // ignore
            else if error = ERROR_SUCCESS then
              // ignore
            else
              RaiseLastOSError(error);
          end;
        finally
          FreeAndNil(ReadEvent);
        end;
      finally
        DisconnectNamedPipe(Server.FPipeHandle);
      end
      else if Signal = Server.FShutdownEvent then
      begin
        // server is shutting down!
        Terminate;
      end;
    end;
  finally
    FreeAndNil(ConnectEvent);
  end;
end;

{ TPBPipeClient }

constructor TPBPipeClient.Create(APath: string);
begin
  FPath := APath;
end;

destructor TPBPipeClient.Destroy;
begin

  inherited;
end;

class procedure TPBPipeClient.SendData(APath, AData: string);
var
  bytesRead: Cardinal;
  success: Integer;
begin
  if not CallNamedPipe(PWideChar(APath), PWideChar(AData), length(AData) * SizeOf(Char), @success, SizeOf(Integer), bytesRead, NMPWAIT_USE_DEFAULT_WAIT) then
    RaiseLastOSError;
end;

procedure TPBPipeClient.SendData(AData: string);
var
  bytesRead: Cardinal;
  success: boolean;
begin
  if not CallNamedPipe(PWideChar(FPath), PWideChar(AData), length(AData) * SizeOf(Char), @success, SizeOf(Integer), bytesRead, NMPWAIT_USE_DEFAULT_WAIT) then
    RaiseLastOSError;
end;

end. 
```

这是我发送东西的方式：

```
TPBPipeClient.SendData('\\.\pipe\pipe server E5DE3B9655BE4885ABD5C90196EF0EC5', 'HELLO'); 
```

以下是我阅读内容的方式：

```
procedure TfoMain.FormCreate(Sender: TObject);
begin
  PipeServer := TPBPipeServer.Create('\\.\pipe\pipe server E5DE3B9655BE4885ABD5C90196EF0EC5');
  PipeServer.OnReceivedData := PipeDataReceived;
end;

procedure TfoMain.PipeDataReceived(AData: string);
begin
  if AData = 'HELLO' then
    // do something, but note that you're not in the main thread, you're in the pipe server thread
end; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-04T17:29:18.590

对于非常短的消息，[WM_COPYDATA](http://msdn.microsoft.com/en-us/library/ms649011(VS.85).aspx)可能是最简单的。除此之外，PetriW 建议使用命名管道或套接字。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-06T09:05:52.783

请参阅[JCL](http://sourceforge.net/projects/jcl)中的[JclAppInstances](http://jcl.svn.sourceforge.net/viewvc/jcl/trunk/jcl/source/windows/JclAppInst.pas?view=markup)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-02T14:02:33.690

看看 ZeroMQ。如果您了解架构背后的想法，它可能会极大地改变您的思维方式。据我了解，他们有许多编程语言的库，包括 Delphi。但我没有机会尝试它。

[零MQ](http://www.zeromq.org)

[这是图书馆的德尔福](https://github.com/bvarga/delphizmq)端口。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-26T12:58:07.247

检查[Cromis.IPC](http://www.cromis.net/blog/)，它在内部使用命名管道，但提供了更简单的 API，并且与最新的 Delphi 版本兼容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-06T23:45:46.270

我建议 TMappedFile - 比命名管道更有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-30T20:20:25.687

我使用[InterAppComm](http://subsimple.com/delphi.asp)，它非常好。

它在两个或多个应用程序之间发送数据。它可以发送字符串、整数和其他数据类型。

# c# - 这个操作员在这段代码中做什么 &= ？（C＃）

> ID：512369
> 
> 赞同：4
> 
> 时间：2009-02-04T17:19:17.563
> 
> 标签：c#

在下面的代码中，x 的值是多少，为什么？

```
bool x =true;
x &= false; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-04T17:21:11.600

x 是假的，因为 (true & false) == false。

&= 是 & 就像 += 是 +。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-04T17:22:04.330

```
x &= false; 
```

是以下的简写：

```
x = x & false; 
```

所以在你的代码中： true & false 解析为 false。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T17:22:54.937

```
x &= false; 
```

是相同的

```
x = x & false; 
```

所以，正如月影所说：假...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T17:25:01.110

查看这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/sbf85k1c(VS.80).aspx)

摘录：二进制 & 运算符是为整数类型和 bool 预定义的。对于整数类型， & 计算其操作数的逻辑按位与。对于 bool 操作数， & 计算其操作数的逻辑与；也就是说，当且仅当它的两个操作数都为真时，结果才为真。

所以换句话说，这就是说 x 在你的例子中是假的，因为 (true and false) 是假的

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T17:23:54.840

&= 是 AND 赋值运算符[（请参阅此 MSDN 页面）](http://msdn.microsoft.com/en-us/library/e669ax02(VS.80).aspx)。

这与 += 的想法相同，您可以将其解读为：

'对变量执行 + 操作，然后将其分配回自身'

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T17:27:11.947

```
x &= false 
```

只是一个简短的形式

```
x = x & false 
```

x 将在该代码的末尾为假。

&= 是一个赋值运算符，其中有很多（+=、-=、*=、/=、|= 等等）。它们只是对变量执行操作并将结果分配回该变量的简短方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T17:27:51.617

& 运算符是一个逻辑“与”，它总是计算表达式的两半。除非两个操作数都为真，否则 & 返回假。x &= y 是 x = x & y 的简写。

在 C# 中更常见的是 && 运算符，它返回相同的值，但一旦发现错误值就会停止计算操作数。这与返回值的函数的副作用有关。例如：

```
if(ConnectToDatabase() && ExecuteQuery()) 
```

将在所有情况下运行 ConnectToDatabase()，但仅在 ConnectToDatabase() 返回 true 时运行 ExecuteQuery。在这种情况下，如果数据库未连接，您不想尝试运行查询。

另一方面：

```
if(VerifyIdentity() & RegisterRequest()) 
```

将始终执行 VerifyIdentity() 和 RegisterRequest()，然后评估它们组合返回值的真实性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-28T04:09:17.493

此运算符可与验证一起使用...

```
valid = True;
valid &= firstname.isValid();
valid &= lastname.isValid();
valid &= email.isValid();

if(valid)
   // do something; 
```

# oracle - 使用 Rownum 时出现数据库死锁？

> ID：512371
> 
> 赞同：0
> 
> 时间：2009-02-04T17:19:28.843
> 
> 标签：oracle, plsql, deadlock, row-number

如果我从应用程序中的多个线程调用以下代码，是否存在死锁风险？用于为此连接到数据库的事务在此调用之前打开，并在它返回后关闭。应用程序：Java 数据库：Oracle

```
 FUNCTION reserveWork(in_batch_id NUMBER,
                       in_work_size NUMBER,
                       in_contentType_id NUMBER) RETURN NUMBER IS
    rows_reserved NUMBER := 0;

  BEGIN
    UPDATE
          D_Q1
    SET
          DQ1_BAT_ID = in_batch_id
    WHERE
         DQ1_BAT_ID is null
         AND DCT_ID = in_contentType_id
         AND ROWNUM < (in_work_size + 1);

    rows_reserved := SQL%ROWCOUNT;

    RETURN (rows_reserved);

  END; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T22:24:58.727

为了发生死锁，您必须具备这两个条件。

1.  每个事务必须有多个锁。

2.  必须以不同的顺序抓住锁。

条件 1 为真，因为您的每个线程都锁定了多行。条件 2 在理论上是正确的，因为返回的行的顺序是不确定的。例如，线程 1 可能会尝试更新第 1、2、3 行，而线程 2 可能会尝试更新第 3、2、1 行。

实际上，Oracle 可能总是以相同的顺序返回行，因此它可能永远不会死锁。无论如何，准备好处理 ORA-00060 错误并重新提交请求。

另一个想法是分两步完成。第一个过程执行 SELECT * WHERE ... FOR UPDATE NO WAIT 来锁定行，如果不返回 ORA-00054，则第二个过程执行实际更新。否则你重试。

无论哪种方式，请确保您将 CREATE TABLE 中的 INITTRANS 设置为将同时更新表的客户端数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:54:46.900

如果您在同一张表上运行多个 UPDATE，则存在一定的死锁风险。

特别是因为我在您的代码中看不到 COMMIT 或 ROLLBACK？我认为这是在 JDBC 中完成的？

UPDATE 花费的时间越长，死锁风险就越高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T22:30:52.537

当事务 A 锁定一条记录然后必须等待事务 B 解锁记录，而事务 B 正在等待已被事务 A 锁定的记录时，就会发生死锁。

Oracle 有一个非常复杂的机制来处理更新过程中对表的更改。看

```
http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:11504247549852 
```

通常，事务运行的时间越长，事务更改的数据越多，死锁的风险就会增加。我想说这不太可能死锁，但可能会“排队” - 如果您有三个或四个并发会话运行此 SQL，每个会话将具有相同的 SQL 执行路径，将识别相同的更新行，一个会先找到他们，其他人会等待。当第一个事务完成时，另一个事务将重新获取记录，发现它们已更改，然后按照 Tom Kyte 的文章中所述重新启动并选择下一组行。

如果您使用的是 11g，则可以使用 SKIP LOCKED。它存在于早期版本中，但未记录在案。因此，您将自行承担使用风险。

```
http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_10002.htm#SQLRF01702 
```

这样一来，你

```
SELECT primary_key BULK COLLECT INTO pk_variable_array FROM D_Q1
WHERE    DQ1_BAT_ID is null
AND DCT_ID = in_contentType_id
AND ROWNUM < (in_work_size + 1)
FOR UPDATE SKIP LOCKED;
--
FORALL i in 1..pk_variable_array
 UPDATE D_Q1
 SET DQ1_BAT_ID = in_batch_id
 WHERE primary_key = pk_variable_array(i) 
```

# macos - 访问 I/O 目录类对象

> ID：512382
> 
> 赞同：2
> 
> 时间：2009-02-04T17:20:45.300
> 
> 标签：macos, driver, iokit

我正在开发一个将用作 I/O Kit 驱动程序的 OS X 内核扩展 (kext)。然而，这个驱动程序将是严格的“虚拟”；它不会与任何硬件接口。

OS X 保留了所有加载到内核中的驱动程序的目录（I/O 目录）。它还保留一个注册表（I/O 注册表），其中包含与硬件设备匹配且当前控制硬件的 I/O 目录驱动程序。

由于我的驱动程序不依赖于硬件并且不“匹配”，因此它只加载到 I/O 目录中，而不是在 I/O 注册表中注册。这会导致一个问题，因为获取 I/O 驱动程序对象的 API 仅限于在 I/O 注册表中注册的驱动程序，并且不会访问 I/O 目录中的对象。我尝试[使用推荐的 API 匹配我的驱动程序](http://developer.apple.com/DOCUMENTATION/DeviceDrivers/Conceptual/WritingDeviceDriver/MakingHWAccessible/chapter_5_section_2.html#//apple_ref/doc/uid/TP30000698-TPXREF101)，但是，正如我之前提到的，这些 API 不会公开 I/O 目录条目。

我的最终目标是获得对我的驱动程序的引用，以便[使用“setProperties”方法传输数据](http://developer.apple.com/DOCUMENTATION/DeviceDrivers/Conceptual/AccessingHardware/AH_Finding_Devices/chapter_4_section_2.html#//apple_ref/doc/uid/TP30000379-TPXREF108)。如果一切都失败了，我[可以使用 syscall、copyin 和 copyout 的组合](http://developer.apple.com/DOCUMENTATION/Darwin/Conceptual/KernelProgramming/boundaries/chapter_14_section_1.html#//apple_ref/doc/uid/TP30000905-CH217-BEHJDFCA)来将数据传入和传出驱动程序，但我目前对该解决方案不感兴趣。

简而言之：有没有办法获得对 I/O 目录中但**不在**I/O 注册表中的驱动程序的引用？

**更新**：要了解我的意思，请查看以下 IORegistryExplorer 的两个屏幕截图：

*   [注册司机](http://mpiche.com/misc/Registered.png)
*   [未注册的司机](http://mpiche.com/misc/Unregistered.png)

已**注册的驱动程序可以**[通过 API](http://developer.apple.com/DOCUMENTATION/DeviceDrivers/Conceptual/AccessingHardware/AH_Finding_Devices/chapter_4_section_2.html#//apple_ref/doc/uid/TP30000379-TPXREF108)轻松访问，但未**注册**的驱动程序将无法使用 IOServiceGetMatchingServices(...) 进行匹配。如何获取对未注册的已加载驱动程序的引用？

欲了解更多信息，请查看：

*   [I/O 注册表](http://developer.apple.com/DOCUMENTATION/DeviceDrivers/Conceptual/IOKitFundamentals/TheRegistry/chapter_4_section_1.html#//apple_ref/doc/uid/TP0000014-TP9)
*   [驱动程序和设备匹配](http://developer.apple.com/DOCUMENTATION/DeviceDrivers/Conceptual/IOKitFundamentals/Matching/chapter_5_section_1.html#//apple_ref/doc/uid/TP0000015-TP9)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T19:30:10.590

您可以在没有硬件的情况下加载驱动程序。您可能想考虑针对“IOKit”或“IOBSD”做类似“IOResourceMatching”的事情。当这些资源可用时，这将导致在您的驱动程序上触发被动匹配。

# c# - 从 ChildForm 添加数据后 ComboBox 刷新

> ID：512385
> 
> 赞同：0
> 
> 时间：2009-02-04T17:21:00.337
> 
> 标签：c#, combobox, refresh

将新数据添加到 Access 数据库后，我似乎无法刷新 ComboBox。

这是我用来添加新数据的代码：

```
private void btnAddUser_Click(object sender, EventArgs e)
{
        AccountForm actFrm = new AccountForm();

        if (actFrm.ShowDialog() == DialogResult.OK)
        {
            try
            {
                this.oleDbDataAdapter1.InsertCommand.CommandText =
                    "INSERT INTO userTable (AccountName, Username, PopServer, PopPort, Psswrd, SmtpServer, SmtpPort, Email)" +
                    "VALUES     ('" + actFrm.txtAccName.Text + "','" + actFrm.txtUsername.Text + "','" + actFrm.txtPop3.Text + "','" + actFrm.txtPop3Port.Text + "','" + actFrm.txtPassword.Text + "','" + actFrm.txtSmtp.Text + "','" + actFrm.txtSmtpPort.Text + "','" + actFrm.txtEmail.Text + "')";

                //open the bridge between the application and the datasource
                this.oleDbConnection1.Open();

                this.oleDbDataAdapter1.InsertCommand.Connection = oleDbConnection1;

                //execute the query 
                this.oleDbDataAdapter1.InsertCommand.ExecuteNonQuery();

                //close the connection
                this.oleDbConnection1.Close();

                MessageBox.Show("User Added Successfully");  //inform the user
                //tried here to refresh and even open close the myConn connection. to no avail
            }
            catch (System.Data.OleDb.OleDbException exp)
            {
                //close the connection
                this.oleDbConnection1.Close();

                MessageBox.Show(exp.ToString());
            }
      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:28:25.190

您的 BindingSource 是否使用 DataSet？如果是这样，您需要通过 DataSet 进行插入，并可能刷新您的绑定源。如果你这样做，你也将避免重复的插入逻辑。

或者，您可以只刷新 DataSet，但这种方法没有利用 DataSet 的功能，并且会导致大量重复代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-15T14:32:36.887

我最近在 VB.NET 中遇到了同样的问题。我发现将数据源设置为 Nothing（我相信在 C# 中为 null），然后将其分配给我的对象列表解决了这个问题。

IE

```
 attendanceDataFiles.DataSource = Nothing
  attendanceDataFiles.DataSource = myFileList.files 
```

# c# - 显示带有 WPF、Winforms 和双显示器的窗口

> ID：512398
> 
> 赞同：12
> 
> 时间：2009-02-04T17:23:50.567
> 
> 标签：c#, wpf, winforms, multiple-monitors

我有 2 个显示器和一个启动 WPF 窗口的 WinForm 应用程序。我想获取 WinForm 所在的屏幕，并在同一屏幕上显示 WPF 窗口。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-04T18:38:35.470

WPF 不包括方便的 System.Windows.Forms。**Screen**类，但您仍然可以使用它的属性在 WinForms 应用程序中完成任务。

假设**这**意味着 WinForms 窗口和**_wpfWindow**是一个定义的变量，在下面的示例中引用 WPF 窗口（这将在您设置为打开 WPF 窗口的任何代码处理程序中，如某些 Button.Click 处理程序）：

```
Screen screen = Screen.FromControl(this);
_wpfWindow.StartupLocation = System.Windows.WindowStartupLocation.Manual;
_wpfWindow.Top = screen.Bounds.Top;
_wpfWindow.Left = screen.Bounds.Left;
_wpfWindow.Show(); 
```

上面的代码将在包含 WinForms 窗口的屏幕左上角实例化 WPF 窗口。如果您希望将其放置在另一个位置（例如屏幕中间）或以“层叠”样式放置在 WinForms 窗口下方和右侧，我将把数学留给您。

在屏幕中间获取 WPF 窗口的另一种方法是简单地使用

```
_wpfWIndow.StartupLocation = System.Windows.WindowStartupLocation.CenterScreen 
```

但是，这并不那么灵活，因为它使用鼠标的位置来确定显示 WPF 窗口的屏幕（显然，如果用户快速移动鼠标，鼠标可能与 WinForms 应用程序位于不同的屏幕上，或者您使用默认按钮或其他）。

编辑：这是关于使用 InterOp 使您的 WPF 窗口居中于非 WPF 窗口[的 SDK 文档的链接。](http://blogs.msdn.com/wpfsdk/archive/2007/04/03/centering-wpf-windows-with-wpf-and-non-wpf-owner-windows.aspx)它基本上完成了我在计算数学方面所描述的内容，但正确地允许您使用窗口的 HWND 设置 WPF 窗口的“所有者”属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T01:13:44.877

这是最简单的方法（使用 WindowStartupLocation.CenterOwner）。

```
MyDialogWindow dialogWindow = new MyDialogWindow();
dialogWindow.Owner = this;
dialogWindow.WindowStartupLocation = WindowStartupLocation.CenterOwner;

dialogWindow.ShowDialog(); 
```

无需互操作或设置窗口坐标 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T03:46:48.447

另一种方法是：

```
WindowInteropHelper helper = new WindowInteropHelper(this);

this.StartupLocation = System.Windows.WindowStartupLocation.Manual;
this.Left = System.Windows.Forms.Screen.FromHandle(helper.Handle).Bounds.Left;
this.Top = System.Windows.Forms.Screen.FromHandle(helper.Handle).Bounds.Top; 
```

这 = 你的 WPF 窗口...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T18:50:08.037

您应该能够使用 System.Windows.Forms.Screen [1]，并使用 FromControl 方法获取表单的屏幕信息。然后，您可以使用它根据您尝试定位的屏幕来定位 WPF 窗口（顶部，左侧）。

[1] 如果您不加载 WinForms dll，您也可以使用 win32 MonitorFromRect 等。但是，由于您已经获得了 winforms API，因此您无需支付任何内存/性能损失。

# c# - Xna 调试

> ID：512401
> 
> 赞同：7
> 
> 时间：2009-02-04T17:24:17.773
> 
> 标签：c#, debugging, xna, console.out.writeline

我使用 console.out.writeline() 来打印属于 XNA 游戏中不同精灵的坐标。但几秒钟后，游戏开始变得非常缓慢，几乎停止。
（不写入控制台时，性能没有问题）。（精灵的位置写在每个更新方法中）

有没有办法在不破坏游戏性能的情况下写入控制台？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T17:37:07.357

您是否能够写入日志文件而不是控制台？由于缓冲和缺乏滚动、显示等，这可能会更快。

当它运行时，你真的有一个控制台吗？如果是这样，请在您不感兴趣时​​尝试将其最小化。我的猜测是导致问题的滚动。

编辑：好的，似乎有一些证据是有序的。

一些测试......我没有安装 XNA，但不同的写入控制台的方式仍然很有趣。我将数字 0-99999 写入各种控制台：

*   作为 WinForms 应用程序，在调试器下，到 Visual Studio 控制台：135000 毫秒，无论控制台是可见的还是被隐藏的。
*   作为 WinForms 应用，在调试器下，写入文件：160ms
*   作为控制台应用程序，不在调试器下，控制台最小化：4149ms
*   作为控制台应用程序，不在调试器下，控制台未最小化：14514ms

如您所见，Visual Studio 控制台非常缓慢，非最小化的“普通”控制台次之，最小化的控制台相当简单，写入文件非常快。

我坚持我的建议，尝试写入文件而不是控制台，否则，如果它是一个独立的控制台，请尝试在大多数情况下将其最小化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T17:35:26.300

“有没有办法在不破坏游戏性能的情况下写入控制台？”

好吧，你可以像大多数游戏引擎一样创建*自己的游戏控制台*（最著名的是 Quake），并在按下某个键时显示控制台。

编辑：

如果您不想实现自己的控制台，有一个项目可以这样做：

[http://www.codeplex.com/XnaConsole](http://www.codeplex.com/XnaConsole)

它比 Win32 控制台具有优势，因为它在游戏中以游戏帧速率运行，并且在控制台和 xna 应用程序之间切换时不会让您丢失设备。（虽然在 XNA 中设备恢复是自动的，但丢失设备仍然会在幕后发生）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T20:56:30.480

您可能正在向控制台写入太多数据。通过使用计数器或计时器来降低控制台写入的频率。每秒一次更新通常足以查看您需要的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-04T21:58:56.360

我知道这是一篇旧帖子，但对于那些有类似问题的人来说，有更好的方法。您可以包含另一个控制台类型的库，它非常易于使用（比 xna 控制台项目容易得多）。它被称为 XNA 调试终端，可以在[http://www.protohacks.net/xna_debug_terminal](http://www.protohacks.net/xna_debug_terminal)
找到它在 游戏顶部放置一个类似命令窗口的终端，并允许您查看/设置任何变量的值，调用任何方法，甚至实时观察值的变化。它是完全开源的，可与 XNA 3.0 和 XNA 3.1 一起使用。这可以让您在游戏执行期间随时轻松查看精灵坐标（或其他任何内容）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-13T13:17:24.723

简单地说，您可以执行以下操作：

创建一个名为 eg 的类`Trace`，并在 draw 方法中使用它在屏幕上绘制所需的信息，`SpriteBatch.DrawString(...)`这比我猜的 Console 更好..

我希望这有帮助，

和平。

# javascript - Javascript 搜索和替换

> ID：512411
> 
> 赞同：7
> 
> 时间：2009-02-04T17:26:48.797
> 
> 标签：javascript, regex, replace

我想在 Javascript（伪代码）中执行以下操作：

```
myString.replace(/mypattern/g, f(currentMatch)); 
```

也就是说，替换字符串不是固定的，而是当前匹配的函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T17:30:05.077

只需省略参数，即使用这个：

```
myString.replace(/mypattern/g, f); 
```

这是一个例子：[http ://ejohn.org/blog/search-and-dont-replace/](http://ejohn.org/blog/search-and-dont-replace/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T17:33:32.730

[MDC](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/String/Replace)声称您可以做到这一点：

```
function styleHyphenFormat(propertyName)
{
  function upperToHyphenLower(match)
  {
    return '-' + match.toLowerCase();
  }
  return propertyName.replace(/[A-Z]/, upperToHyphenLower);
} 
```

或更笼统地说：

```
myString.replace(/mypattern/g, function(match){
    return "Some function of match";
}); 
```

# version-control - 源签入频繁还是不频繁？

> ID：512412
> 
> 赞同：6
> 
> 时间：2009-02-04T17:27:07.250
> 
> 标签：version-control

我只是签入我的代码，并意识到我不知道我的代码应该满足什么条件才能执行签入。

昨天我在我的项目签出一周后签入。今天我做了一点更新后再次签到。有时我喜欢保留我正在处理的代码，直到它可以通过一点测试。

我的老板通常抱怨人们在周末或假期检查代码，所以我尽量避免这种情况（如果没有其他原因，只是因为我忘记了我在做什么）。

我应该担心遇到大量代码还是因为要搜索的代码太多而无法找到错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T18:27:24.853

应经常检查。

签到应该是

*   原子。包含所有需要的更改，但仅此而已。这也意味着
*   空白更改会自行提交。
*   只改变一项功能。这可能会更改多个功能，但不应以多种方式和/或位置更改功能。
*   评论道。签入评论应该使您能够快速找到提交，即使它已有 2 年历史并且您不再处理该特定源（甚至项目）。
*   在职的。仅在代码实际构建并执行其声称的操作时才提交。

如果您需要个人游乐场来提交，请考虑使用工作分支或使用 git svn 之类的东西镜像存储库。请记住尽可能合并以原子方式完成的更改。这可能需要更多的工作，但如果您需要计算出更改或可能破坏某些内容的提交，它会立即得到回报。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T17:34:24.850

我可以推荐以下准则：

*   每次签入都应该是“原子的”，这意味着您只更改系统的一部分。不建议进行一项更改很多事情的大型检查，因为这样很难仅恢复一项更改。
*   在彻底测试之前不要签入代码。
*   准备好后立即签入代码。它有利于备份目的，因为您的工作副本与源代码控制中的最新更改不同步，它放在那里的时间越长。
*   无论您是经常签入还是不经常签入，磁盘空间都应该大致相同。
*   为了便于搜索，只需确保您的签到附有评论即可。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-04T17:34:37.407

就像投票一样，尽早并经常签到。

需要注意的是，集成过程的工作方式会有所不同。如果你有持续集成，你不想把东西检查回*主干*，除非你已经运行了单元测试并且确信它会工作。

协调这两件事的方法是为您的工作区创建一个分支，经常在分支上签入，并在您做出并测试更改后合并回来。对许多更改进行大合并的烦恼将鼓励您将它们分解为小步骤。这是一件好事。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T17:33:56.193

如果您的源代码管理系统允许，我更喜欢创建一个私有分支或活动，并且至少每天检查一次，或者如果我要开始有风险的事情，则更频繁地检查。我只在我正在处理的位实际工作之后才合并或交付以使其他人可以访问它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T17:34:15.753

在实际可行的情况下，我尽量保持我的签入尽可能细化，条件是我不会/不签入任何 a) 无法编译、b) 破坏单元测试或 c ) 破坏向后兼容性（除非它是这样要求/设计的）。

如果我担心在我的机器上留下新的或更新的代码很长一段时间，我通常会创建（或要求创建）一个临时分支供我自己使用，但我只会在我必须使用的最短时间内使用它在我可以重新加入我工作的分支机构之前。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-04T17:44:54.737

如果磁盘空间是一个问题，你真的需要更大的硬盘驱动器。即使在冗余、安全的环境中，它们也足够便宜，以至于不得不考虑它们是荒谬的。

至于你多久登记一次，这通常是个人政策的问题。在我自己的七人编码团队中，我倾向于每张工作票签到一次，而一位同事平均每天签到六次。

这真的是你觉得舒服的问题。唯一的官方政策是：不要破坏构建，不要破坏工作功能。如果您可能不得不在中途交出您的工作，请更频繁地签到。这对我们有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-04T17:49:53.603

我经常检查。

源代码控制给您带来的两件事是您因不经常签入而失去的：

*   简化协作
*   跟踪随时间变化的历史记录

其他开发人员需要了解代码库中正在发生的变化。尽早签入您的更改会通知他们您正在做什么。它可以帮助防止重复工作（多个人实施相同的事情来修复相同的错误）。不频繁的签入可能会导致对代码的重大和意外更改，这更有可能导致困难的调试情况（由于您刚刚签入的代码较少，但由于它与系统其余部分交互的复杂性）。

如果源代码控制系统不知道所做的更改，它就无法帮助您恢复更改。此外，如果您失去了过去一周一直在进行的本地更改，那么损失会更大。

你不应该因为磁盘空间而限制自己。SCM 系统在磁盘使用方面非常智能，但无论如何，存储既便宜又充足。

就是说，我建议你把你必须做的工作分成小块，在你完成一个这样的块后签到。这对您和其他开发人员来说会更容易。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-20T11:52:08.253

您检查源代码的频率实际上与少数几件事有关，最值得注意的是文化和流程。您可能希望通过经常签到来遵守良好的“卫生”，以最大程度地减少数据丢失的风险，但这种做法还有其他好处，可能或多或少适用于您的方法：

*   在敏捷环境中，定期签入可**降低构建中断**或与其他程序员**遇到合并冲突的风险；**

*   更频繁的签入意味着更精细的签入，这意味着您正在 **收集更多信息**——这对于获取项目运行状况的统计数据和查找错误很有用；

*   细化签入意味着签入评论更加集中，并且**较少描述所做的更改的可能性** ；

*   细粒度的签入确保**版本间的差异变得更容易导航**。

不过，您的具体问题是关于*入住标准的*——这当然是风格问题。根据经验，我的目标是将任务分解为 1 到 3 小时的子任务，每个子任务都有一个特定的目标——完成子任务后检查。“完成”是主观的，但在我的书中，它意味着*工作*，即所有单元测试都通过，并且您的代码覆盖率处于可接受的水平（也就是说，您可以接受）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T18:44:05.847

问题：您使用的是哪种 VCS？当您在假期中签出代码时，您的老板抱怨您的评论似乎很奇怪。我总是使用 Subversion 签出代码，但没人在意。

如果您使用需要保留结帐的 VCS，或者您需要伪造保留结帐，则您无法使用最佳实践，并且您的组织应该升级到 Subversion 或更高版本。

这可能不取决于您，但如果您使用的是古董 VCS，则可能会影响给出的答案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-05T00:06:17.227

我同意这里所说的大部分内容，但我要补充一点，即如果您使用像 bzr 或 git 这样的分布式 vcs，那么频繁签入中央存储库并不重要。在这种情况下，只要您只是更新本地存储库，您还可以更倾向于未测试的提交。即使您还没有测试过，如果您在一天中休息并继续提交，这很方便，因为您不必担心任何影响其他人的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T17:32:17.490

您应该只签入正在工作且不会破坏构建的代码，您不应该尝试将所有代码一起签入以创建一个很好的可管理变更集（假设您的版本控制系统支持变更集概念）。

我不确定您所说的磁盘空间或搜索能力是什么意思。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T18:52:47.173

这是我们使用的程序：

*   开发人员获得了一份包含描述新功能或错误修复的设计文档的任务。
*   该开发人员进行这些更改并对其进行测试。
*   新代码由至少 2 名其他开发人员进行同行评审，以确保设计文档中描述的功能和错误已实现或修复。
*   代码审查员建议的任何更改都会被执行。如有必要，将进行另一次审查。
*   当审阅者满意并且首席开发人员同意时，开发人员会“控制”存储库（程序上 - 在释放控制权之前没有其他人可以签入任何内容），签入更改，签出新的副本应用程序并编译和测试它仍然可以成功构建和运行。

这意味着开发人员的提交之间可能需要数周，有时甚至数月，但这为我们提供了很多防止破坏构建的保护，并允许我们密切跟踪任务以及与每个任务相关的更改。

# opengl - 经历垂直变形的多边形网格中的恒定水平带高度（OpenGL ES 1.1）

> ID：512414
> 
> 赞同：0
> 
> 时间：2009-02-04T17:27:12.570
> 
> 标签：opengl, mesh, texture-mapping, artifacts

当使用通常的算法在标准多边形网格上实现纹理映射时，您可能会遇到与沿 y 轴的变形相关的问题，因为变形沿着四边形的恒定高度行的带而不是该方向上的顶点能够与沿 x 轴的拉伸相比独立拉伸。

我遇到了这个问题，因为在定义网格的顶点时，每一行都定义了一个底部和一个顶部顶点，导致一行的顶行顶点共享其上方行的底行顶点。

如果您只沿 x 或 z 轴变形网格，这是可以的，但如果您沿 y 轴变形网格而不考虑这一点，您会看到四边形的行一起作为一个带恒定高度而不是独立点的行。您将看到网格沿 y 轴发生变形，但您还会看到纹理撕裂，因为这些条带的宽度不会改变，从而导致网格中出现间隙。

有没有其他人遇到过这个问题，他们会对如何最好地将（x，y）置换贴图过滤器应用于以这种方式构建的多边形网格提出建议？或者定义网格的方法是否必须以某种基本方式改变？

可以在[ZEUS OpenGL|ES Tutorial on Texture Mapping](http://www.zeuscmd.com/tutorials/opengles/21-WavingFlag.php)中查看网格生成算法的示例。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T18:32:46.293

好的，让我们先看看我是否理解这个问题。

如果我理解正确，您正在尝试渲染纹理映射补丁。但是，当您尝试在垂直方向拉伸补丁以使其变高时，网格中不同的水平带会撕裂，最终会出现几个水平带的补丁。

是对的吗？

如果是这样，问题出在网格生成算法上，纹理映射本身必须保持不变。从我在提供的链接上可以看到，每个水平带之间的顶点不共享，它们是重复的。因此，如果您缩放顶部顶点之间的间距，您还需要缩放带高度，以便底部顶点适合下一行顶部顶点。

该算法的基础工作，您只需要调整行间距和行高。当您进一步了解原始列表的工作原理时，您可能想了解索引原始列表。这些实际上会让您共享顶点，而不是为每个图元复制它们。

希望能帮助到你。

# c# - BizTalk 是解决这个问题的“正确”技术吗？

> ID：512417
> 
> 赞同：2
> 
> 时间：2009-02-04T17:27:33.740
> 
> 标签：c#, sql, architecture, biztalk

我目前正在研究涉及以下工作流程的解决方案：

1.  系统发送一封电子邮件，其中包含某种标识符/会话 ID。
2.  用户回复电子邮件。
3.  系统接收回复，并解析电子邮件以获取发件人、标识符和用户响应。
4.  系统根据用户响应查询sql数据库以检索一些信息，然后插入一些数据。
5.  然后系统对属于另一个系统的网页执行 http post。

所以我的问题是，对于这个解决方案的全部或部分，BizTalk 是正确的技术吗？为什么或者为什么不？如果不是，那么合适的技术是什么？

在这种情况下，企业已经决定使用 BizTalk，所以我需要证明一个否定的答案。我们已经有其他 BizTalk 解决方案，因此配置初始 BizTalk 服务器设置的产品和时间成本不考虑在内。

谢谢。

编辑：公平地说，BizTalk 的使用是可以讨论的，比我的问题看起来更重要。我更感兴趣的是知道它是对技术的适当使用还是仅仅根据你对问题域的直觉的感觉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T17:34:38.860

我会说你已经回答了你自己的问题。是的，Biztalk 可以工作。是否最好已经由您的管理层决定。为了真正评估实现这一点的复杂性和范围，我们需要更多关于您的信息结构、业务流程、预期数量、各种电子邮件源和服务器等的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T23:58:24.200

我一直在构建这样的应用程序。您需要做的就是创建一个执行这些操作的 Windows 服务。对于破败。

*   系统发送一封电子邮件，其中包含某种标识符/会话 ID。

.NET 的内置 SMTP 客户端

*   用户回复电子邮件。

您需要某种电子邮件服务器，无论哪种类型。

*   系统接收回复，并解析电子邮件以获取发件人、标识符和用户响应。

使用 IndySockets 读取电子邮件帐户。

[http://www.indyproject.org/Sockets/index.EN.aspx](http://www.indyproject.org/Sockets/index.EN.aspx)

*   系统根据用户响应查询sql数据库以检索一些信息，然后插入一些数据。

System.Data 或您最喜欢的 ORM。

*   然后系统对属于另一个系统的网页执行 http post。

System.NET 有制作 HTTP 帖子的方法。

从该列表中，我可以绝对肯定地说，如果没有 BizTalk，您所做的一切都会变得更容易（更不用说在金钱、内存和 CPU 利用率方面更便宜）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T23:36:49.627

正如您在问题本身中所述，该场景是工作流解决方案。

您可以使用 WF 或 BizTalk，具体取决于您希望如何实施和管理它，但是

与 WF 相比，BizTalk 具有以下优势

*   BizTalk 拥有广泛的适配器和管道组件系列，它们通常是跨平台企业应用程序集成 (EAI) 的必备工具。
*   BizTalk 提供与贸易伙伴合作的工具，例如商业活动服务 (BAS)、行业标准加速器（RosettaNet、SWIFT
    等）。这些特性使 BizTalk
    更适合 B2B 场景。

*   BizTalk 具有但
    WF 没有或必须
    由开发人员实现的其他功能）

*   跟踪：
    与业务活动
    监控 (BAM) 本地集成 事务：
    支持原子事务和长时间运行的事务
    用于管理、
    管理、迁移和扩展的广泛工具集（但是，所有这些都在都柏林发生了变化！！！）

再次阅读您的要求后，我认为您的应用程序既不属于 B2B 也不属于 EAI 类别，因此 BizTalk 可能是矫枉过正。但您也提到您的企业已经有其他 BizTalk 解决方案，因此仅使用 BizTalk 进行工作流可能是避免向技术堆栈添加更多层的一种方法。

# jquery - 图像未在 jQuery 中加载

> ID：512424
> 
> 赞同：1
> 
> 时间：2009-02-04T17:28:03.990
> 
> 标签：jquery, image, load

我正在使用 jQuery。test.html 包含图像和文本。现在我需要使用 test.html 加载

```
<img src="../images/lib.jpg" alt="test" width="320" height="290" />
<p>Textt </p> 
```

### jQuery

```
$("#content2").load("sub_test.html"); 
```

content2 的结果没有显示图像。有没有更好的办法？还是正确显示图像和 HTML 的替代解决方案？是我的标签问题还是 jQuery？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T17:38:42.313

正如评论所述，查看更多文件会有所帮助。

一个可能的问题是，当一个页面中的 img 标签被加载到另一个页面时，它们将根据加载到的页面进行解析，而不是基于它们的原始位置。因此，如果您有这样的目录树：

```
root
   page1.html
   /images
   /dir1
      page2.html 
```

那么 page2.html 中的图像将具有 src="../images/something.jpg" 而 page1.html 中的图像将具有 src="images/something.jpg"。如果要将 page2.html 加载到 page1.html 中，则必须重写 page2.html 中的图像标签以匹配 page1.html 的位置。（或者使用基于根的引用：src="/images/something.jpg"）。

# .net - .NET：.NET 的动画通用控件？

> ID：512428
> 
> 赞同：0
> 
> 时间：2009-02-04T17:28:45.983
> 
> 标签：.net, winapi

Microsoft 是否没有为 .NET 开发人员提供围绕[Animation 通用控件的托管包装器？](http://msdn.microsoft.com/en-us/library/bb761884.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:34:22.790

不，但你可以在[这里得到它。](http://www.codeproject.com/KB/miscctrl/CGAnimation.aspx)

# testing - 测试工具软件

> ID：512429
> 
> 赞同：2
> 
> 时间：2009-02-04T17:28:57.030
> 
> 标签：testing

我们目前的测试系统工具最初是在 13 年前用 16 位 Clipper 编写的，并且开始显示它已经过时了。测试本身都是用 C 语言编写的，并作为可执行文件运行。虽然有将 Clipper 代码重新编译为 32 位可执行文件的解决方案，但我们宁愿转向更主流的编程语言。

测试系统工具处理在多个客户端之间划分测试运行并报告结果的工作。我们对线束的构建与购买是不可知的，那么人们使用哪些解决方案来运行自动化和回归测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:33:27.287

我们建立了自己的。这实际上取决于您的商店有多大，以及您是否会收回您为编写商店投入的资源。自己编写比购买更昂贵，但比商业包更适合你想要的东西。自己滚动的最大优点是它很灵活。你可以修改它来做你需要的任何事情。缺点是您必须投入精力来构建和维护它。这将随着时间的推移而增加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:41:48.737

如果您的应用程序是交互式的并且可以使用自动化技术进行测试，我建议您研究[AutoIT](http://www.autoitscript.com/autoit3/index.shtml)。我们使用它来测试 C#/.NET 应用程序和非 .NET 应用程序。我们已经报告了内部构建的这些结果。AutoIT 也有一个优秀的开发者社区。

# apache-flex - 在 Flex 上显示数据点

> ID：512432
> 
> 赞同：2
> 
> 时间：2009-02-04T17:30:01.880
> 
> 标签：apache-flex, charts

我正在使用带有`<mx:LineSeries>`. 当我将鼠标悬停在线上时，它会将数据点显示为小圆形点。我怎样才能让这些点一直显示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T13:19:43.893

如果您正在使用`<mx:LineSeries>`，则设置以下属性：

```
itemRenderer="mx.charts.renderers.CircleItemRenderer" 
```

在 ActionScript 中构造 LineSeries 时，请在添加到系列数组之前在 LineSeries 对象上设置 itemRenderer 样式：

```
lineSeries.setStyle("itemRenderer", new ClassFactory(mx.charts.renderers.CircleItemRenderer)); 
```

别忘了...

```
import mx.charts.renderers.*; 
```

您也不必坚持使用圆形项目渲染器，您可以使用渲染器包中的任何项目渲染器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-18T23:09:26.747

要关闭特定系列的数据提示，请将 series.interactive 属性设置为 false。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-29T15:28:22.920

不，你在找

```
LineChart.showAllDataTips = true; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T21:10:13.197

我认为您正在寻找的是：

```
showDataTips="true" 
```

# java - Java：播放 WAV 声音

> ID：512436
> 
> 赞同：3
> 
> 时间：2009-02-04T17:30:25.700
> 
> 标签：java, audio

我正在尝试构建一个需要播放各种鼓部分（低音鼓、军鼓等）的 WAV 声音样本的 java 鼓机。因为我需要以紧凑的顺序播放声音，所以我需要高性能。目前我正在使用：

```
import sun.audio.*;
import java.io.*;

public class MusicPlayer {

    private String filename;

    public MusicPlayer(String filename) {
        this.filename = filename;
    }

    public void play() {
        try {
            InputStream in = new FileInputStream(filename);
            AudioStream as = new AudioStream(in);
            AudioPlayer.player.start(as); 

        } catch (IOException e) {
            e.printStackTrace();
        }          
    }
} 
```

如此处建议：[如何在 Java 中播放声音？](https://stackoverflow.com/questions/26305/how-can-i-play-sound-in-java)

虽然它的工作速度确实比 MP3 + Javazoom jLayer 快，但在高速时以及当我执行 cpu 密集型操作（如调整应用程序窗口大小）时，它仍然听起来不连贯。

关于提高性能的任何提示？

顺便提一句。我也读过它`sun.audio.*`已被弃用。有没有类似的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:36:13.113

您是否看过[**Java 媒体框架 (JMF)**](http://java.sun.com/javase/technologies/desktop/media/jmf/)：

> Java Media Framework API (JMF) 允许将音频、视频和其他基于时间的媒体添加到基于 Java 技术构建的应用程序和小程序中。这个可选包可以捕获、播放、流式传输和转码多种媒体格式，通过提供强大的工具包来开发可扩展的跨平台技术，为多媒体开发人员扩展了 Java 2 平台标准版 (J2SE)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:45:30.537

也许您应该将声音缓存起来：如果每次播放时都从磁盘加载它们，那确实很慢。现在，您可能有记忆问题，但这取决于您的声音（大小、数量...）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-21T13:19:45.903

您可以尝试的一件事是制作几个额外的线程。

如果您可以一次播放两种声音，那么只需制作一个包含 5 个相同声音实例的缓冲区并播放可用的一个。

# sql - How can I add a column that doesn't allow nulls in a Postgresql database?

> ID：512451
> 
> 赞同：292
> 
> 时间：2009-02-04T17:33:34.243
> 
> 标签：sql, postgresql, alter-table

I'm adding a new, "NOT NULL" column to my Postgresql database using the following query (sanitized for the Internet):

```
ALTER TABLE mytable ADD COLUMN mycolumn character varying(50) NOT NULL; 
```

Each time I run this query, I receive the following error message:

> ```
> ERROR:  column "mycolumn" contains null values 
> ```

I'm stumped. Where am I going wrong?

NOTE: I'm using pgAdmin III (1.8.4) primarily, but I received the same error when I ran the SQL from within Terminal.

* * *

## 回答 #1

> 赞同：471
> 
> 时间：2009-02-04T17:39:55.027

You have to set a default value.

```
ALTER TABLE mytable ADD COLUMN mycolumn character varying(50) NOT NULL DEFAULT 'foo';

... some work (set real values as you want)...

ALTER TABLE mytable ALTER COLUMN mycolumn DROP DEFAULT; 
```

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2009-02-05T14:05:02.243

As others have observed, you must either create a nullable column or provide a DEFAULT value. If that isn't flexible enough (e.g. if you need the new value to be computed for each row individually somehow), you can use the fact that in PostgreSQL, all DDL commands can be executed inside a transaction:

```
BEGIN;
ALTER TABLE mytable ADD COLUMN mycolumn character varying(50);
UPDATE mytable SET mycolumn = timeofday();    -- Just a silly example
ALTER TABLE mytable ALTER COLUMN mycolumn SET NOT NULL;
COMMIT; 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2009-02-04T17:35:37.250

Since rows already exist in the table, the `ALTER` statement is trying to insert `NULL` into the newly created column for all of the existing rows. You would have to add the column as allowing `NULL`, then fill the column with the values you want, and then set it to `NOT NULL` afterwards.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-04T17:37:37.307

You either need to define a default, or do what Sean says and add it without the null constraint until you've filled it in on the existing rows.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T17:41:54.960

Specifying a default value would also work, assuming a default value is appropriate.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-12T11:25:33.040

this query will auto-update the nulls

```
ALTER TABLE mytable ADD COLUMN mycolumn character varying(50) DEFAULT 'whatever' NOT NULL; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T17:39:47.880

Or, create a new table as temp with the extra column, copy the data to this new table while manipulating it as necessary to fill the non-nullable new column, and then swap the table via a two-step name change.

Yes, it is more complicated, but you may need to do it this way if you don't want a big UPDATE on a live table.

* * *

## 回答 #8

> 赞同：-10
> 
> 时间：2017-02-09T06:20:43.873

This worked for me: :)

```
ALTER TABLE your_table_name ADD COLUMN new_column_name int; 
```

# .net - .NET Bootstrap 无需设置

> ID：512452
> 
> 赞同：3
> 
> 时间：2009-02-04T17:33:42.167
> 
> 标签：.net, winforms, bootstrapping

我有一个需要从 CD 运行的 .NET WinForms 应用程序。我需要弄清楚的是用户是否需要安装 .NET 版本或在必要时安装而不是在安装后运行应用程序。我发现的有关引导的任何信息都涉及应用程序的设置和安装。如果我不安装任何东西，我该怎么做？我愿意提供任何信息..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T14:50:52.093

我也在想，如果不制作安装程序，您将无法做到这一点，但事实并非如此。有一个 msbuild 操作，称为["GenerateBootstrapper"](http://msdn.microsoft.com/en-us/library/ms164294.aspx)。如果您在 Visual Studio 中：

1.  右键单击您的项目
2.  卸载项目
3.  编辑 YourProjectName.csproj"

然后您可以通过不同的方式添加 GenerateBootstrapper 操作（取决于您要安装的内容）。MSDN 给出了 .NET 2.0 的示例：

```
<ItemGroup>
    <BootstrapperFile Include="Microsoft.Net.Framework.2.0">
        <ProductName>Microsoft .NET Framework 2.0</ProductName>
    </BootstrapperFile>
</ItemGroup>

<Target Name="BuildBootstrapper">
    <GenerateBootstrapper
        ApplicationFile="WindowsApplication1.application"
        ApplicationName="WindowsApplication1"
        ApplicationUrl="http://mycomputer"
        BootstrapperItems="@(BootstrapperFile)"
        OutputPath="C:\output" />
</Target> 
```

我没有尝试这个示例，但我尝试了自己的示例，我可以告诉您，为了在 XP 机器上安装 .NET 4 Client Profile（这是今天最新的稳定 .NET 版本），您需要安装[Windows首先是成像组件](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=32)。这就是为什么包含在 VS2010 中的标准 .NET4 客户端配置文件先决条件在 XP 上失败的原因。所以我写了[我自己的引导程序](https://stackoverflow.com/questions/9188274/vs-2010-bootstrapper-for-wic-windows-imaging-component-before-net-4-installat/10125457#10125457)。您可以下载我的示例 VS2010 解决方案，它为控制台应用程序创建引导程序。但这需要您安装（只需复制）我的引导程序。所以这里是步骤：

1.  下载我的[Windows 映像组件引导程序](http://www.mediafire.com/?84lvsyvb08v1t8a)
2.  解压到 %PROGRAMFILES%\Microsoft SDKs\Windows\v7.0A\Bootstrapper\Packages
3.  下载我的[BootstrapperTest 解决方案](http://www.mediafire.com/?2qrru1dzelr5gn6)
4.  构建解决方案。您会看到它在 \bin\Debug 目录中创建了 BootstrapperTest.exe 和 setup.exe。Setup.exe 是一个引导程序，您可以在不安装 .NET 的情况下运行它 - 它会为您获取它，然后运行 ​​BootstrapperTest.exe。
5.  如果您想将其作为单个文件分发，我建议使用[ChilkAt Zip2Secure](http://www.chilkatsoft.com/chilkatsfx.asp)或其类似物。Zip2Secure 非常易于使用，希望您不会遇到任何麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T17:37:59.680

您使用 Visual Studio 构建的 msi 安装程序可以包含一个本机 setup.exe，它会检查框架依赖性并在需要时首先启动安装程序。您甚至可以在您的 cd 中包含可再发行文件。但是您必须安装该程序才能使其正常工作。

否则，您*必须*构建自己的本机代码工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T17:38:07.650

您可以编写一个小型本机代码加载器来检查 .NET 运行时，在必要时触发 .NET 的安装，然后启动您的 .NET 应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T17:45:36.137

最直接的方法是检查此问题中列出的注册表项：

[.Net 框架检测](https://stackoverflow.com/questions/199080/how-to-detect-what-net-framework-versions-and-service-packs-are-installed)

脚本文件可能是从 CD 中检查的最简单方法：

[Windows 脚本宿主 - RegRead 方法](http://msdn.microsoft.com/en-us/library/x05fawxd(VS.85).aspx)

# ruby - 如何在 Ruby 中实现一个抽象类

> ID：512466
> 
> 赞同：131
> 
> 时间：2009-02-04T17:35:43.210
> 
> 标签：ruby, abstract-class

我知道 Ruby 中没有抽象类的概念。但是如果需要实施，我该怎么做呢？我试过这样的事情：

```
class A
  def self.new
    raise 'Doh! You are trying to write Java in Ruby!'
  end
end

class B < A
  ...
  ...
end 
```

但是，当我尝试实例化 B 时，它会在内部调用`A.new`会引发异常的调用。

此外，模块不能被实例化，但它们也不能被继承。将新方法设为私有也行不通。

有没有人有任何指示？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2010-03-23T19:05:31.467

只是在这里插话，我认为没有理由阻止某人实例化抽象类，[特别是因为他们可以动态添加方法](http://asqyzeron.wordpress.com/2007/01/14/toying-with-the-dynamic-features-of-ruby-adding-methods-at-run-time/)。

像 Ruby 这样的鸭子类型语言在运行时使用方法的存在/不存在或行为来确定是否应该调用它们。因此，您的问题适用于抽象**方法**，是有道理的

```
def get_db_name
   raise 'this method should be overriden and return the db name'
end 
```

这应该是故事的结尾。在 Java 中使用抽象类的唯一原因是坚持某些方法被“填充”，而其他方法在抽象类中具有它们的行为。在鸭式语言中，重点是方法，而不是类/类型，所以你应该把你的担忧转移到那个层面。

在您的问题中，您基本上是在尝试`abstract`从 Java 重新创建关键字，这是在 Ruby 中执行 Java 的代码气味。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-02-04T17:48:27.410

我不喜欢在 Ruby 中使用抽象类（几乎总是有更好的方法）。但是，如果您真的认为这是针对这种情况的最佳技术，则可以使用以下代码段来更明确地说明哪些方法是抽象的：

```
module Abstract
  def abstract_methods(*args)
    args.each do |name|
      class_eval(<<-END, __FILE__, __LINE__)
        def #{name}(*args)
          raise NotImplementedError.new("You must implement #{name}.")
        end
      END
      # important that this END is capitalized, since it marks the end of <<-END
    end
  end
end

require 'rubygems'
require 'rspec'

describe "abstract methods" do
  before(:each) do
    @klass = Class.new do
      extend Abstract

      abstract_methods :foo, :bar
    end
  end

  it "raises NoMethodError" do
    proc {
      @klass.new.foo
    }.should raise_error(NoMethodError)
  end

  it "can be overridden" do
    subclass = Class.new(@klass) do
      def foo
        :overridden
      end
    end

    subclass.new.foo.should == :overridden
  end
end 
```

基本上，您只需`abstract_methods`使用抽象方法列表进行调用，当它们被抽象类的实例调用时，`NotImplementedError`将引发异常。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-02-04T18:06:50.073

试试这个：

```
class A
  def initialize
    raise 'Doh! You are trying to instantiate an abstract class!'
  end
end

class B < A
  def initialize
  end
end 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-05-26T18:19:36.867

对于 Rails 世界中的任何人，将 ActiveRecord 模型实现为抽象类是通过模型文件中的以下声明完成的：

```
self.abstract_class = true 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-02-06T02:11:32.027

```
class A
  private_class_method :new
end

class B < A
  public_class_method :new
end 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-02-04T20:27:44.703

在过去 6 1/2 年的 Ruby 编程中，我一次*不需要*抽象类。

如果您认为您需要一个抽象类，那么您在提供/需要它们的语言中思考太多，而不是在 Ruby 中。

正如其他人所建议的那样，mixin 更适合应该是接口的东西（正如 Java 定义的那样），重新考虑你的设计更适合那些“需要”来自其他语言（如 C++）的抽象类的东西。

2022 年更新：在 20 年的使用中，我不需要 Ruby 中的抽象类。所有对我的回复发表评论的人所说的一切都是通过实际学习 Ruby 和使用适当的工具来解决的，比如模块（甚至为您提供通用实现）。在我管理的团队中，有些人创建了具有失败的基本实现的类（如抽象类），但这些主要是浪费编码，因为`NoMethodError`会产生与生产中完全相同的结果`AbstractClassError`。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2012-05-10T06:15:35.203

我的 2¢：我选择了一个简单、轻量级的 DSL mixin：

```
module Abstract
  extend ActiveSupport::Concern

  included do

    # Interface for declaratively indicating that one or more methods are to be
    # treated as abstract methods, only to be implemented in child classes.
    #
    # Arguments:
    # - methods (Symbol or Array) list of method names to be treated as
    #   abstract base methods
    #
    def self.abstract_methods(*methods)
      methods.each do |method_name|

        define_method method_name do
          raise NotImplementedError, 'This is an abstract base method. Implement in your subclass.'
        end

      end
    end

  end

end

# Usage:
class AbstractBaseWidget
  include Abstract
  abstract_methods :widgetify
end

class SpecialWidget < AbstractBaseWidget
end

SpecialWidget.new.widgetify # <= raises NotImplementedError 
```

当然，在这种情况下，为初始化基类添加另一个错误将是微不足道的。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-08-12T10:32:22.280

您可以尝试 3 个 ruby​​gems：
[接口](http://rubygems.org/gems/interface)
[抽象](http://rubygems.org/gems/abstract)
[简单抽象](https://rubygems.org/gems/simple_abstract)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-04T20:19:45.610

您尝试使用抽象类服务的目的是什么？在 Ruby 中可能有更好的方法，但您没有提供任何细节。

我的指针是这个；使用[mixin](http://www.rubycentral.com/pickaxe/tut_modules.html)而不是继承。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-04T17:39:40.363

就个人而言，我提出`NotImplementedError`了抽象类的方法。`new`但是由于您提到的原因，您可能希望将其排除在方法之外。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-04T19:08:03.163

如果你想使用一个不可实例化的类，在你的 A.new 方法中，`self == A`在抛出错误之前检查是否。

但实际上，一个模块看起来更像你想要的。例如，Enumerable 是一种在其他语言中可能是抽象类的东西。从技术上讲，您不能将它们子类化，但调用`include SomeModule`可以实现大致相同的目标。有什么原因这对你不起作用吗？

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-04T20:23:05.727

另一个答案：

```
module Abstract
  def self.append_features(klass)
    # access an object's copy of its class's methods & such
    metaclass = lambda { |obj| class << obj; self ; end }

    metaclass[klass].instance_eval do
      old_new = instance_method(:new)
      undef_method :new

      define_method(:inherited) do |subklass|
        metaclass[subklass].instance_eval do
          define_method(:new, old_new)
        end
      end
    end
  end
end 
```

这依赖于正常`#method_missing`报告未实现的方法，但阻止实现抽象类（即使它们具有初始化方法）

```
class A
  include Abstract
end
class B < A
end

B.new #=> #<B:0x24ea0>
A.new # raises #<NoMethodError: undefined method `new' for A:Class> 
```

就像其他海报所说的那样，您可能应该使用 mixin，而不是抽象类。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-10-29T09:30:32.217

我是这样做的，所以它在子类上重新定义了新的，以在非抽象类上找到一个新的。我仍然认为在 ruby​​ 中使用抽象类没有任何实际意义。

```
puts 'test inheritance'
module Abstract
  def new
    throw 'abstract!'
  end
  def inherited(child)
    @abstract = true
    puts 'inherited'
    non_abstract_parent = self.superclass;
    while non_abstract_parent.instance_eval {@abstract}
      non_abstract_parent = non_abstract_parent.superclass
    end
    puts "Non abstract superclass is #{non_abstract_parent}"
    (class << child;self;end).instance_eval do
      define_method :new, non_abstract_parent.method('new')
      # # Or this can be done in this style:
      # define_method :new do |*args,&block|
        # non_abstract_parent.method('new').unbind.bind(self).call(*args,&block)
      # end
    end
  end
end

class AbstractParent
  extend Abstract
  def initialize
    puts 'parent initializer'
  end
end

class Child < AbstractParent
  def initialize
    puts 'child initializer'
    super
  end
end

# AbstractParent.new
puts Child.new

class AbstractChild < AbstractParent
  extend Abstract
end

class Child2 < AbstractChild

end
puts Child2.new 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-09-08T05:15:12.670

还有这个小`abstract_type`宝石，允许以不显眼的方式声明抽象类和模块。

示例（来自[README.md](https://github.com/dkubb/abstract_type/blob/master/README.md)文件）：

```
class Foo
  include AbstractType

  # Declare abstract instance method
  abstract_method :bar

  # Declare abstract singleton method
  abstract_singleton_method :baz
end

Foo.new  # raises NotImplementedError: Foo is an abstract type
Foo.baz  # raises NotImplementedError: Foo.baz is not implemented

# Subclassing to allow instantiation
class Baz < Foo; end

object = Baz.new
object.bar  # raises NotImplementedError: Baz#bar is not implemented 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-04T17:48:33.713

你的方法没有错。在初始化程序中引发错误似乎很好，只要您的所有子类`initialize`当然都覆盖。但是你不想这样定义`self.new`。这是我要做的：

```
class A
  class AbstractClassInstiationError < RuntimeError; end
  def initialize
    raise AbstractClassInstiationError, "Cannot instantiate this class directly, etc..."
  end
end 
```

另一种方法是将所有功能放在一个模块中，正如您所提到的，它永远无法实例化。然后，将模块包含在您的类中，而不是从另一个类继承。但是，这会破坏`super`.

这取决于您希望如何构建它，尽管模块似乎是解决“我如何编写一些设计供其他类使用的东西”问题的更清洁的解决方案

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-07-05T12:01:11.097

2 行宝石：[https ://rubygems.org/gems/abstract](https://rubygems.org/gems/abstract)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-06-05T04:25:07.490

虽然这感觉不像 Ruby，但您可以这样做：

```
class A
  def initialize
    raise 'abstract class' if self.instance_of?(A)

    puts 'initialized'
  end
end

class B < A
end 
```

结果：

```
>> A.new
  (rib):2:in `main'
  (rib):2:in `new'
  (rib):3:in `initialize'
RuntimeError: abstract class
>> B.new
initialized
=> #<B:0x00007f80620d8358>
>> 
```

# iphone - 检查是否已实现可选协议方法

> ID：512487
> 
> 赞同：55
> 
> 时间：2009-02-04T17:41:19.733
> 
> 标签：iphone, objective-c, delegates, protocols

有谁知道检查是否已实现可选协议方法的最佳方法。

我试过这个：

```
if ([self.delegate respondsToSelector:@selector(optionalProtocolMethod:)] ) 
```

其中委托是：

```
id<MyProtocol> delegate; 
```

但是，我收到一条错误消息，指出`respondsToSelector:`在协议中找不到该功能！

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-02-04T18:23:39.383

`respondsToSelector:`是`NSObject`协议的一部分。包括在内`NSObject`应该`MyProtocol`可以解决您的问题：

```
@protocol MyProtocol <NSObject>

@optional
-(void)optionalProtocolMethod:(id)anObject;

@end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-10T07:01:33.537

我所做的是应用以下配方：

```
if(self.delegate && [self.delegate respondsToSelector:@selector(closed)]){
    [self.delegate closed];
} 
```

“关闭”是我想要调用的方法。

# asp.net - 开发与生产：连接字符串

> ID：512497
> 
> 赞同：5
> 
> 时间：2009-02-04T17:44:51.833
> 
> 标签：asp.net, sql-server, web-config, visual-sourcesafe, app-config

我正在将 SQL 服务器移动到单独的机器上。目前我们在同一个盒子上运行我们的 web 服务器和 sql 服务器。所以我们有一个带有 IIS 和 SQLServer 的生产服务器，然后是一个独立的开发服务器来反映这个设置。

当涉及到我们的 asp.net 控件的 app.config 和网站的 web.config 时，这很有效，因为我们可以使用“Initial Catalog=MyDB;...”，而且因为两台机器上的 DB 名称相同，所以效果很好.

现在我正在考虑在同一个盒子（MyDB，MyDB-Dev）上运行两个数据库。有没有一种简单的方法可以做到这一点，而无需在每次部署或编译时编辑 web.config 和 app.config？这是 Visual Source Safe 可以处理的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T18:24:56.417

这是我使用的解决方案。在 Web.Config 中，放置以下“include”行：

```
<connectionStrings configSource="WebCS.config"/> 
```

然后，创建 WebCS.config 文件并输入以下内容：

```
<connectionStrings>
<add name="ConnString" 
     connectionString="Data Source=YourServer;Initial Catalog=YourDB;etc..
     providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

然后，在 VS 中发布您的站点后，删除 WebCS.config 文件（我有一个批处理文件来执行此操作），然后将其他所有内容捆绑起来以传输到新机器。然后，您可以放心，所有 Web.Config 文件设置都随您而行，而不会弄乱您的连接字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T17:59:09.573

部署 web.config 几乎从来不是将文件从 dev 复制到 prod 的情况。有不同的条目是正常的，例如，您的开发网站指向本地数据库或开发数据库框，而您的产品网站通常必须指向您的产品数据库框。

部署时，如果您在应用程序中进行了需要新配置元素的架构更改或您想要删除冗余元素，则通常只需要更改您的生产 web.config。

对于源代码管理，通常的做法是排除 web.config 并拥有一个模板文件，该文件可用作创建配置文件的基础，例如 web.config.template。在对 web.config 进行结构更改时，您应该对 web.config.template 进行更改，然后为 dev 和 prod 制作副本，并相应地应用 dev 和 prod 设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T18:14:08.513

我使用 NAnt 来构建和部署。我使用 .config.template 命名约定将 .config 文件制作成模板。我有一个名为“environment”的 NAnt 属性，它是从命令行调用 NAnt 设置的。在我的 build.xml 顶部，我根据“环境”属性（如 switch 语句）设置了一个“db.connectionstring”属性。在构建任务中，我使用 grep 将“db.connectionstring”字符串推送到构建目录输出模板中的位置。这样，我只需要调用：

```
nant -D:environment=dev 
```

这将获得一组特定于开发的 .config 文件。

如果您不喜欢 grep，请按照以下说明操作：

[http://www.haidongji.com/2008/11/11/use-nant-to-replace-values-in-other-xml-config-files/](http://www.haidongji.com/2008/11/11/use-nant-to-replace-values-in-other-xml-config-files/)

这仅适用于 XML 文件。Grep 更通用。我实际上根据部署环境有不同的数据库名称，而 grep 让我可以根据环境将不同的数据库名称插入到 SQL 脚本中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T17:57:56.317

我在这里可能不完全理解您的问题，但在我看来，当您部署应用程序时，您根本无法重新部署 web.config，除非需要对 web.config 进行更改。也就是说，将所有文件复制到*除*web.config 文件之外的目录。

如果您必须在部署之间更改 web.config 文件，则需要编辑每个服务器的 web.config。

或者，您可以在每台计算机上找到另一个位置来存储除 web.config 之外的连接字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T18:27:21.140

查看 web.config 中 connectionStrings 元素的 configSource 属性

那应该很容易

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T08:19:03.723

我很清楚，您当前的环境是两台服务器，即

开发应用程序/数据库服务器
生产应用程序/数据库服务器

你正在考虑把它做成这样

应用服务器（开发+生产）
数据库服务器（开发+生产）

如果是这种情况，我建议您将数据库和应用程序隔离到两个单独的服务器中 - 从单个服务器环境迁移时这是第一步，因为如果您需要集群多个数据库服务器或（更常见) 负载平衡单个 DB 服务器前面的多个 Web 服务器以提高应用程序性能。

话虽如此，我不建议在同一台服务器上像这样并排运行开发和生产环境。虽然在财务上可能有意义，但隔离开发环境的目的是防止“开发错误”流入生产环境，如果您将一些错误代码推送到开发环境，这样做可能会导致停机。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T03:46:34.923

您能否将所有连接字符串放在 web.config 中，然后在应用程序的一个主要点根据应用服务器确定要使用哪一个？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-31T15:16:59.833

对于开发，使用 Web.Debug.config 文件，对于生产，使用 Web.Release.config。每个都可以定义自己的单独连接字符串。

# python - 如何在 Python 中访问模板？

> ID：512499
> 
> 赞同：2
> 
> 时间：2009-02-04T17:45:28.540
> 
> 标签：python, templates

有时，对于具有大量数据的程序，将数据放在外部文件中是很常见的。一个示例是生成 HTML 报告的脚本，使用外部文件保存模板。

在 Java 中，最推荐的检索程序资源的方法是使用`getClass().getClassLoader().getResource()`或`getClass().getClassLoader().getResourceAsStream()`用于流。

优点是它独立于文件系统。此外，无论类是在文件系统中还是应用程序作为 Jar 文件分发，它都可以工作。

你如何在 Python 中达到同样的效果？如果您使用[py2exe](http://www.py2exe.org/)或[Freeze](http://wiki.python.org/moin/Freeze)生成独立运行的应用程序，如[本问题](https://stackoverflow.com/questions/331377/how-to-pack-python-libs-im-using-so-i-can-distribute-them-with-my-app-and-have-a)所示，该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T18:34:38.677

可以`os.path.dirname(__file__)`用来获取当前模块的目录。然后使用[路径操作](http://docs.python.org/library/os.path.html)函数（特别是 os.path.join）和[文件输入/输出](http://docs.python.org/tutorial/inputoutput.html#reading-and-writing-files)打开当前模块下的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:19:38.100

丹尼尔所说的。:-) 此外，可以告诉 py2exe 包含外部文件（这通常用于图像等）。

# ruby - 将 Ruby 库和 gem 与 Shoes 应用程序一起使用

> ID：512502
> 
> 赞同：14
> 
> 时间：2009-02-04T17:46:15.280
> 
> 标签：ruby, rubygems, shoes

我正在编写一个小鞋应用程序，它需要一个我用常规 Ruby 安装编写的库。我的库使用“net-ssh”gem 和一堆其他 Ruby 库。

当我使用常规 ruby​​ 直接运行我的库时（它有自己的命令行界面），如下所示：

```
ruby my_lib.rb 
```

...一切皆好。但是当我尝试在我的鞋子应用程序中要求它时，我得到一个“没有这样的文件来加载 - net/ssh”错误（因为 my_lib 使用 net-ssh）。

我试着在鞋子应用程序中弄乱 $: 包含路径变量，如下所示：

```
$:.unshift "C:/ruby/lib/ruby/1.8"
$:.unshift "C:/ruby/lib/ruby/site_ruby/1.8"
require 'rubygems'
gem 'net-ssh'
require 'my_lib.rb' 
```

...但没有成功。我得到“找不到 RubyGem net-ssh”。

有人遇到过同样的问题吗？在 Shoes 应用程序中使用 Ruby 库和 gem 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-04T17:55:03.483

嘿，[_why 在他的博客hackety.org 上发布了](http://hackety.org/2008/05/08/clearingUpTheWholeShoesAndRubyGemsDeal.html)关于在Shoes 中使用宝石的信息。我希望它有帮助！

```
Shoes.setup 做
  宝石'json> = 1.1.1'
  宝石'活动记录'
结尾

需要'json'
需要“活动记录”

鞋子.app 做
  @msg = para "所有系统运行"
  动画（20）{@msg.toggle}
结尾

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-30T15:08:14.433

对于 shoes4，该`Shoes.setup`方法已弃用。您可以通过以下任一方式安装所需的 gem：

1.  `gem install net-ssh`
2.  使用捆绑器和 Gemfile

然后，您只需要`require 'net-ssh'`在您的应用程序中。

# java - 向客户解释 .NET 或 Java

> ID：512503
> 
> 赞同：2
> 
> 时间：2009-02-04T17:47:49.143
> 
> 标签：java, .net

在我的公司，我们开发在 JVM（Java EE 和 Grails）以及 .NET 应用程序（ASP.NET 和客户端/服务器 Forms 应用程序）上运行的应用程序。根据您的经验，您何时向客户推荐过其中一个？

[我在这里](https://stackoverflow.com/questions/512321/java-vs-net)错误地问了这个问题，但我认为我放了一个初始列表的事实让它关闭了。我正在寻找诸如如果您想做 X，那么 Y 因为 Z 会更好。我认为这对社区来说将是一个宝贵的资源/案例研究。例如，我尝试在 Java/Windows 中做一些 USB 硬件的东西，但由于 Java 中缺乏好的库，我不会再推荐它了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T17:51:44.440

不要费心解释技术，解释解决方案及其好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T18:20:10.250

如果您想与 Windows、其他 Microsoft 产品或 COM 组件紧密集成，那么 .NET 会更好，因为它在设计时就考虑到了这种集成。

如果您需要提供或使用 XML Web 服务，那么 .NET 会更好，因为用于此类开发的工具更加一致且易于使用。

如果您想在非 Windows 平台上进行开发或部署，请以 JVM 为目标，因为大多数平台都有稳定的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T17:59:31.367

我建议看看客户是否对一种解决方案感到满意或不满意（例如检查部署平台要求），并且 - 如果没有障碍 - 去团队（或其中合格的大多数）工作的环境该解决方案拥有最多和最好的知识。我发现在个人舒适区工作比在个人舒适区之外工作更有效率。

当然，有时你想走出舒适区来学习新东西，但我不建议在付费客户项目上这样做（至少如果*每个人*都在他们的舒适区之外的话）。毕竟，您需要一种估算工作量的方法，如果您不了解环境，就无法做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T18:09:25.387

这是一个很大的兔子洞，但是......

如果我不得不争论一种技术而不是另一种技术，我会围绕现在和未来的成本节约来做。即，我现在可以从开源 Java 项目开始更快地完成它，但以后升级和维护会更昂贵。

我不认为你可以把这些东西放在一个神奇的网格中，因为每个项目都不一样，每个团队都不一样，每个公司都不一样，所有这些因素都会影响平台决策和建议。除了使用 Perl 等最简单的情况之外，这并不是编写 MS Office 插件的最佳选择……这是无用的信息。

# php - PHP Session 变量已设置，但 PHP 看不到它。很奇怪

> ID：512514
> 
> 赞同：2
> 
> 时间：2009-02-04T17:50:09.030
> 
> 标签：php, session, session-variables

好吧，也许这是因为我已经编码了超过 24 小时，我的眼睛已经呆滞了，但我在这里被难住了。为什么会这样：

```
<?php
session_start();
$tmp = "索引";

回声“A：”。$_SESSION['page_loaded']['index']; // 返回 1
回声“B：”。$_SESSION['page_loaded'][$tmp]; // 已设置，但为空
?>

```

我觉得我在这里遗漏了一些非常基本的东西，但我不知道是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T22:45:47.700

我有一种感觉，您实际上并没有剪切和粘贴该代码？你有什么要漏掉的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T18:09:25.480

您在哪里设置以下内容？

```
$_SESSION['page_loaded'][$tmp]; 
```

以下作品：

```
<?php

    session_start();
    $tmp = "index";

    $_SESSION["page_loaded"][$tmp] = "Foo";

    echo "A: " . $_SESSION['page_loaded']["index"]; // foo
    echo "<br/>";
    echo "B: " . $_SESSION['page_loaded'][$tmp]; // foo

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T17:52:28.200

`var_dump`用函数试试看它的价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T18:04:47.923

尝试使用：

```
$tmp = 'index'; // Note the single quotes.
//...
echo "B: " . $_SESSION['page_loaded'][$tmp]; 
```

PHP 对双引号和单引号字符串的解释略有不同。[在此处](http://us3.php.net/types.string)和[此处](http://v1.jeroenmulder.com/weblog/2005/04/php_single_and_double_quotes.php)阅读这些文章，因为这可能就是您所面临的。

更新：只是为了澄清（给出下面的评论）我检查使用单引号或双引号字符串是否影响原始海报问题的理由如下面的示例所示，其中两个字符串不相等：

```
$var = 1;

$tmpA = 'index_$var'; // will resolve to index_$var
$tmpB = "index_$var"; // will resolve to index_1

if ( $tmpA === $tmpB)
  echo 'Identical';
else
  echo 'Not Identical!'; // <--- we get this because they are NOT identical. 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-02-04T18:11:47.863

你应该使用

```
 $_SESSION['page_loaded']['tmp'] = "index"; 
```

代替

```
 $tmp = "index"; 
```

并检索值使用这个

```
 echo "B: " . $_SESSION['page_loaded']['tmp']; // the output is: B: index 
```

（去掉美元符号 $）

# maven-2 - 如何根据目标环境在 Maven 中复制资源或其他资源？

> ID：512516
> 
> 赞同：33
> 
> 时间：2009-02-04T17:51:29.463
> 
> 标签：maven-2, resources

我必须创建测试战争和生产战争，这将`log4j.properties`在目录中有不同的文件`WEB-INF`。我有这些文件`log4j.properties`（测试战争）和`dev.log4j.properties`（用于生产环境）。

如何将文件复制`dev.log4j.properties`到`log4j.properties`文件中以进行生产战争？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-02-14T21:13:24.643

*   使用 Maven 配置文件 ( [http://maven.apache.org/guides/introduction/introduction-to-profiles.html](http://maven.apache.org/guides/introduction/introduction-to-profiles.html) )
*   创建一个“dev”和“prod”配置文件，为每个配置文件选择一组备用资源。默认情况下使 Dev 处于活动状态。

    ```
    <profiles>
        <profile>
            <id>dev</id>
            <activation>
                <activeByDefault>true</activeByDefault>
            </activation>
            <build>
                <resources>
                    <resource>
                        <directory>src/main/resources/dev</directory>
                    </resource>
                </resources>
            </build>
        </profile>
        <profile>
            <id>prod</id>
            <build>
                <resources>
                    <resource>
                        <directory>src/main/resources/prod</directory>
                    </resource>
                </resources>
            </build>
        </profile>
    </profiles> 
    ```

*   通过以下方式使用所需的配置文件构建： `mvn install -Pdev` 或 `mvn install -Pprod`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-04T18:52:54.550

我使用 maven-resources 插件解决了这个问题，我在其中创建了包含生产环境资源的 prod 目录，并在 process-resources 阶段将它们复制到 WEB-INF/classes 目录。

```
<plugin>
   <groupId>org.apache.maven.plugins</groupId>
   <artifactId>maven-resources-plugin</artifactId>
    <version>2.3</version>
    <executions>
        <execution>
            <id>copy-prod-resources</id>
            <phase>process-resources</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>webapp/WEB-INF/classes</outputDirectory>
                <resources>
                    <resource>
                        <directory>src/main/resources/prod</directory>
                        <filtering>true</filtering>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-04-29T12:10:09.347

上面的代码对我不起作用 - 必须将其更改为以下内容：

```
<plugin>
  <artifactId>maven-resources-plugin</artifactId>
  <executions>
    <execution>
      <id>copy-prod-resources</id>
      <phase>process-resources</phase>
      <goals>
         <goal>copy-resources</goal>
      </goals>
      <configuration>
        <!-- this is important -->
        <overwrite>true</overwrite>
        <!-- this as well (target/ was missing) -->
        <outputDirectory>${basedir}/target/classes</outputDirectory>
        <resources>
          <resource>
            <directory>src/main/resources/prod</directory>
          </resource>
        </resources>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-10-11T10:59:16.627

最后一个响应有效。但是您需要提供版本才能使其正常工作。

```
<plugin>
  <artifactId>maven-resources-plugin</artifactId>
  <version>2.3</version>
  <executions>
    <execution>
      <id>copy-prod-resources</id>
      <phase>process-resources</phase>
      <goals>
         <goal>copy-resources</goal>
      </goals>
      <configuration>
        <!-- this is important -->
        <overwrite>true</overwrite>
        <!-- target -->
        <outputDirectory>${basedir}/target/classes</outputDirectory>
        <resources>
          <resource>
            <!-- source -->
            <directory>src/main/resources/prod</directory>
          </resource>
        </resources>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-10T20:40:15.093

另一种方法是使用 maven-antrun-plugin

```
<build>
    <plugins>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-antrun-plugin</artifactId>
          <version>1.7</version>
          <executions>
            <execution>
              <phase>validate</phase>
              <goals>
                <goal>run</goal>
              </goals>
              <configuration>
                <tasks>
                  <echo>build.env: ${build.env} </echo>
                  <delete file="src/main/resources/log4j.properties" />
                  <copy file="src/env/${build.env}/log4j.properties"
                        tofile="src/main/resources/log4j.properties" />
                </tasks>
              </configuration>
            </execution>
          </executions>
        </plugin>
    </plugins>
</build> 
```

假设资源文件具有以下结构：

```
src/
  env/
      dev/
          log4j.properties
      local/
          log4j.properties
      prod/
          log4j.properties 
```

在进行 maven 构建时，每个环境运行以下命令：

```
mvn package -Dbuild.env=dev
mvn package -Dbuild.env=local
mvn package -Dbuild.env=prod 
```

# asp.net - 如何将 HtmlEncode 与 TemplateFields、数据绑定和 GridView 一起使用

> ID：512517
> 
> 赞同：27
> 
> 时间：2009-02-04T17:51:41.070
> 
> 标签：asp.net, data-binding, gridview, html-encode, templatefield

我有一个绑定到 ObjectDataSource 的 GridView。我也支持编辑，效果很好。但是，我想安全地对显示的文本进行 HtmlEncode，因为我们确实允许在某些字段中使用特殊字符。这与标准 BoundFields 无关，因为我只是将 HtmlEncode 设置为 true。

但是为了设置验证控件，需要使用 TemplateFields。如何轻松添加 HtmlEncoding 以这种方式输出？这是一个 ASP.NET 2.0 项目，所以我使用较新的数据绑定快捷方式（例如`Eval`和`Bind`）。

我想做的是如下所示：

```
<asp:TemplateField HeaderText="Description">
    <EditItemTemplate>
        <asp:TextBox ID="TextBoxDescription" runat="server"
                     Text='<%# System.Web.HttpUtility.HtmlEncode(Bind("Description")) %>'
                     ValidationGroup="EditItemGrid"
                     MaxLength="30" />
        <asp:Validator ... />
    </EditItemTemplate>
    <ItemTemplate>
        <asp:Label ID="LabelDescription" runat="server"
                   Text='<%# System.Web.HttpUtility.HtmlEncode(Eval("Description")) %>' />
    </ItemTemplate>
</asp:TemplateField> 
```

但是，当我以这种方式尝试时，出现以下错误：

> CS0103：当前上下文中不存在名称“绑定”

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-11-06T12:34:58.197

现在可以使用 ASP.NET 4 中引入的新 HTML 编码数据绑定语法来实现。

您可以简单地使用：

```
<%#: Eval("MyField") %> 
```

或者

```
<%#: Bind("MyField") %> 
```

**注意井号/井号后面的冒号就**这么简单。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-04T18:16:02.193

引自[http://weblogs.asp.net/leftslipper/archive/2007/06/29/how-asp-net-databinding-deals-with-eval-and-bind-statements.aspx](http://weblogs.asp.net/leftslipper/archive/2007/06/29/how-asp-net-databinding-deals-with-eval-and-bind-statements.aspx)

> ASP.NET 中没有 Bind 方法。当 ASP.NET 解析您的文件并看到您正在使用
> 
> 它会为它生成一些特殊的代码。当您使用它时，它不是真正的函数调用。如果 ASP.NET 分析代码并检测到 Bind() 语句，它会将语句分成两部分。第一部分是单向数据绑定部分，最终只是一个常规的 Eval() 调用。第二部分是反向部分，通常是一些类似于“string name = TextBox1.Text”的代码，用于从绑定的位置获取值。但是，因为 ASP.NET 必须解析 Bind() 语句，所以双向数据绑定不支持除 Bind() 之外的任何内容。例如，以下语法是无效的，因为它试图调用任意代码并同时使用 Bind()：
> 
> 双向数据绑定中支持的唯一格式是 Bind("field") 和 Bind("field", "format string {0}")。

您可以在 EditItemTemplate 中使用 Eval 而不是 Bind。您还需要转换为字符串：

```
<asp:Label ID="LabelDescription" 
           runat="server" 
           Text='<%# System.Web.HttpUtility.HtmlEncode((string)Eval("Description")) %>' /> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-04-10T23:07:19.770

正如 Darin Dimitrov 已经解释的那样，您不能将`Bind`其用作函数的参数。所以`Text='<%# System.Web.HttpUtility.HtmlEncode(Bind("Description")) %>'`是不可能的。另一方面，这里通常不需要使用 HtmlEncode，因为您将使用`Bind`允许更改数据的控件，例如与 TextBox 一起使用（如 EditItemTemplate 的示例）。但是 TextBox 会自动编码，因此您可以`Bind`在不需要 HtmlEncode 的情况下安全地调用：

```
<EditItemTemplate>
    <asp:TextBox ID="TextBoxDescription" runat="server"
                 Text='<%# Bind("Description") %>'
                 ValidationGroup="EditItemGrid"
                 MaxLength="30" />
    <asp:Validator ... />
</EditItemTemplate> 
```

**如果 TextBox 不能自动编码使用`Bind`将是一个巨大的安全漏洞**（除非您绝对确定您的数据可以安全地在不编码的情况下呈现为 HTML）。

但是自动编码不是例如标签的情况。虽然您也可以`Bind`在标签的 Text 属性中使用，但标签的输出不会自动编码 - 这就是为什么使用`Bind`标签不是一个好习惯的原因，因为您不能使用`Bind`. 而是使用`Eval`它并将其包装到 HtmlEncode 中，就像您在 ItemTemplate 中所做的那样：`Text='<%# System.Web.HttpUtility.HtmlEncode((string)Eval("Description")) %>'`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-17T05:46:13.573

```
<asp:TemplateField HeaderText="Description">     
  <EditItemTemplate>         
    <asp:TextBox ID="TextBoxDescription" runat="server" Text='<%# System.Web.HttpUtility.HtmlEncode(Bind("Description")) %>'                ValidationGroup="EditItemGrid"  MaxLength="30" />
     <asp:Validator ... />     
  </EditItemTemplate>     
  <ItemTemplate>         
     <asp:Label ID="LabelDescription" runat="server"  Text='<%# System.Web.HttpUtility.HtmlEncode(Convert.ToString(Eval("Description"))) %>' /> 
  </ItemTemplate> 
</asp:TemplateField> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T07:10:59.677

Bind() 用于[双向数据绑定](http://www.devx.com/DevX/Article/35058)，为此，您必须使用 gridview 的 [RowUpdating](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowupdating.aspx)事件。

```
void GridView_RowUpdating(Object sender, GridViewUpdateEventArgs e)
{
    foreach (DictionaryEntry entry in e.NewValues)
    {
        e.NewValues[entry.Key] = System.Web.HttpUtility.HtmlEncode(entry.Value.ToString());
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-31T13:23:55.683

在我的情况下，我被迫在 mi EditItemTemplate 的 TextBox 上使用“Bind”方法，因为需要在 item_Updating 事件处理的 NewValues 数组中访问数据。所以我想出如下：

在我的 EditItemTemplate 上：

```
<EditItemTemplate>
     <asp:TextBox runat="server" Text='<%# Bind("field")%>' ID="TextBox112" OnPreRender="TextBox_PreRender_decode"></asp:TextBox>                                            
</EditItemTemplate> 
```

然后在后面的代码中：

```
protected void TextBox_PreRender_decode(object sender, EventArgs e)
{
    TextBox tb = (TextBox)sender;
    tb.Text = WebUtility.HtmlDecode(tb.Text);
} 
```

该解决方案允许我正确显示所有文本框的 html 编码数据，同时能够在 item_Updating 事件触发时从 newValues 数组访问这些数据。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-09-16T11:34:48.983

请参考

[http://forums.asp.net/p/1056231/1504717.aspx](http://forums.asp.net/p/1056231/1504717.aspx)

我从这里得到了工作解决方案。它对我来说就像一个魅力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-08T14:52:23.693

一个简单的扩展方法呢？

```
public static string HtmlEncode(this string s)
    {            
        s = HttpUtility.HtmlEncode(s);
        return s;
    } 
```

然后你可以简单地运行：

```
<asp:Label runat="server" Text=<%# ((string)Eval("MyStringField")).HtmlEncode() %> /> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-04T04:18:19.097

但是，如果您使用 Phaedrus 的以下代码并且您有一个复选框列，请注意！

```
void GridView_RowUpdating(Object sender, GridViewUpdateEventArgs e)
{
    foreach (DictionaryEntry entry in e.NewValues)
    {
        e.NewValues[entry.Key] = System.Web.HttpUtility.HtmlEncode(entry.Value.ToString());
    }
} 
```

因为这`entry.Value.ToString()`会使复选框从真到真然后你不能将它保存在数据库字段中！

# c# - 如何处理这个 c# 泛型问题？

> ID：512527
> 
> 赞同：0
> 
> 时间：2009-02-04T17:54:47.757
> 
> 标签：c#, generics

我有一个继承 List<> 的基类，它有多个派生自它的类。

我想创建一个可以将项目添加到从该基类继承的任何类的方法，这可能吗？

**伪代码：**

```
public class BaseList<T> : List<T> where T: baseItem
{
}

public BaseList<T> AddItems<T>(int someArg) where T: new(), baseItem
{

BaseList<T> temp = new BaseList<T>();
temp.add(new T());
temp.add(new T());
return temp;
} 

public class MyDerived: BaseList<SomeClass>
{
} 
```

然后调用此代码：

```
MyDerived temp = (MyDerived)AddItems(); 
```

这样的事情可能吗？我无法弄清楚正确的语法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T18:01:07.730

你真的需要派生`List<T>`而不是使用组合吗？

听起来您想要一个非泛型类型的静态方法：

```
public static TList CreateList<TList,TItem>(int someArg)
    where TList : BaseList<TItem>, new()
    where TItem : baseItem, new()
{
    TList temp = new TList();
    temp.Add(new TItem());
    temp.Add(new TItem());
    return temp;
} 
```

不过，这似乎不是特别好……也许如果您解释了这样做的目的，我们可以想出一个更好的主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:26:16.030

我不能真正理解你的问题，但我以前遇到过这个问题。如果你遇到和我一样的问题：你在编译时不知道 <T> 参数。幸运的是，这是使用接口解决的问题——您可以通过使用非泛型接口来创建更强大的类型绑定。

```
class Program
{
    static void Main(string[] args)
    {
        IAddBaseItem addItem = new DerivedList();
        BaseItem item = new DerivedItem();
        IgnorantMethod(addItem, item);
    }

    static void IgnorantMethod(IAddBaseItem list, BaseItem item)
    {
        list.Add(item);
    }
}

class BaseItem
{
}

class BaseList<T> : List<T>, IAddBaseItem
{
    #region IAddBaseItem Members

    void IAddBaseItem.Add(BaseItem item)
    {
        if (item == null)
            Add(item);
        else
        {
            T typedItem = item as T;
            // If the 'as' operation fails the item isn't
            // of type T.
            if (typedItem == null)
                throw new ArgumentOutOfRangeException("T", "Wrong type");
            Add(typedItem);
        }
    }

    #endregion
}

class DerivedList : BaseList<DerivedItem>
{
}

class DerivedItem : BaseItem
{
}

interface IAddBaseItem
{
    void Add(BaseItem item);
} 
```

正如我所说，这是我对你所问问题的最佳猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T18:48:53.653

你也可以使用

```
public static void AddItems<T>(List<T> list, int someArg) where T: new() {
    list.Add(new T());
    list.Add(new T());
} 
```

并这样称呼它：

```
List list = new List<SomeClass>();
AddItems(list, someArg); 
```

# javascript - 在 html 文本框中设置键盘插入符号位置

> ID：512528
> 
> 赞同：214
> 
> 时间：2009-02-04T17:54:51.593
> 
> 标签：javascript, textbox, input

有人知道如何将文本框中的键盘插入符号移动到特定位置吗？

例如，如果一个文本框（例如输入元素，而不是文本区域）中有 50 个字符，并且我想将插入符号放在第 20 个字符之前，我该怎么做呢？

这与这个问题不同：[jQuery Set Cursor Position in Text Area](https://stackoverflow.com/questions/499126/jquery-set-cursor-position-in-text-area)，它需要 jQuery。

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2009-02-04T17:59:10.727

摘自 Josh Stdola 的*[Setting keyboard caret Position in a Textbox or TextArea with Javascript](http://blog.josh420.com/archives/2007/10/setting-keyboard%20caret-position-in-a-textbox-or-textarea-with-javascript.aspx)*

一个通用函数，可让您在所需的文本框或文本区域的任何位置插入插入符号：

```
function setCaretPosition(elemId, caretPos) {
    var elem = document.getElementById(elemId);

    if(elem != null) {
        if(elem.createTextRange) {
            var range = elem.createTextRange();
            range.move('character', caretPos);
            range.select();
        }
        else {
            if(elem.selectionStart) {
                elem.focus();
                elem.setSelectionRange(caretPos, caretPos);
            }
            else
                elem.focus();
        }
    }
} 
```

第一个预期参数是您希望在其上插入键盘插入符号的元素的 ID。如果无法找到该元素，则什么都不会发生（显然）。第二个参数是插入符号位置索引。零会将键盘插入符号放在开头。如果您传递的数字大于元素值中的字符数，它将把键盘插入符号放在最后。

在 IE6 及更高版本、Firefox 2、Opera 8、Netscape 9、SeaMonkey 和 Safari 上测试。不幸的是，在 Safari 上它不能与 onfocus 事件结合使用）。

使用上述函数强制键盘插入符在获得焦点时跳转到页面上所有文本区域的末尾的示例：

```
function addLoadEvent(func) {
    if(typeof window.onload != 'function') {
        window.onload = func;
    }
    else {
        if(func) {
            var oldLoad = window.onload;

            window.onload = function() {
                if(oldLoad)
                        oldLoad();

                func();
            }
        }
    }
}

// The setCaretPosition function belongs right here!

function setTextAreasOnFocus() {
/***
 * This function will force the keyboard caret to be positioned
 * at the end of all textareas when they receive focus.
 */
    var textAreas = document.getElementsByTagName('textarea');

    for(var i = 0; i < textAreas.length; i++) {
        textAreas[i].onfocus = function() {
            setCaretPosition(this.id, this.value.length);
        }
    }

    textAreas = null;
}

addLoadEvent(setTextAreasOnFocus); 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2010-11-29T10:11:14.103

答案中的链接已损坏，这个应该可以工作（所有学分都转到[blog.vishalon.net](http://blog.vishalon.net/javascript-getting-and-setting-caret-position-in-textarea)）：

[http://snipplr.com/view/5144/getset-cursor-in-html-textarea/](http://snipplr.com/view/5144/getset-cursor-in-html-textarea/ "获取/设置 html 区域中的光标")

万一代码再次丢失，这里有两个主要功能：

```
function doGetCaretPosition(ctrl)
{
 var CaretPos = 0;

 if (ctrl.selectionStart || ctrl.selectionStart == 0)
 {// Standard.
  CaretPos = ctrl.selectionStart;
 }
 else if (document.selection)
 {// Legacy IE
  ctrl.focus ();
  var Sel = document.selection.createRange ();
  Sel.moveStart ('character', -ctrl.value.length);
  CaretPos = Sel.text.length;
 }

 return (CaretPos);
}

function setCaretPosition(ctrl,pos)
{
 if (ctrl.setSelectionRange)
 {
  ctrl.focus();
  ctrl.setSelectionRange(pos,pos);
 }
 else if (ctrl.createTextRange)
 {
  var range = ctrl.createTextRange();
  range.collapse(true);
  range.moveEnd('character', pos);
  range.moveStart('character', pos);
  range.select();
 }
} 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-09-20T18:32:14.463

由于我实际上确实需要这个解决方案，并且典型的基线解决方案（*关注输入 - 然后将值设置为等于自身*）**不能跨浏览器工作**，所以我花了一些时间调整和编辑所有内容以使其正常工作。以@ **kd7**的代码为基础，这就是我想出的。

**享受！适用于 IE6+、Firefox、Chrome、Safari、Opera**

[**跨浏览器插入符号定位技术（例如：将光标移动到 END）**](http://jsfiddle.net/VP9zT/1/)

```
// ** USEAGE ** (returns a boolean true/false if it worked or not)
// Parameters ( Id_of_element, caretPosition_you_want)

setCaretPosition('IDHERE', 10); // example 
```

肉和土豆基本上是@ **kd7**的 setCaretPosition，最大的调整是`if (el.selectionStart || el.selectionStart === 0)`，在 Firefox 中 selectionStart 从**0**开始，在布尔值中当然会变成 False，所以它在那里中断。

在 chrome 中，最大的问题是仅仅给出它`.focus()`是不够的（它一直选择所有文本！）因此，我们`el.value = el.value;`在调用我们的函数之前将自身的值设置为自身，现在它有了一个掌握和位置输入以使用**selectionStart**。

```
function setCaretPosition(elemId, caretPos) {
    var el = document.getElementById(elemId);

    el.value = el.value;
    // ^ this is used to not only get "focus", but
    // to make sure we don't have it everything -selected-
    // (it causes an issue in chrome, and having it doesn't hurt any other browser)

    if (el !== null) {

        if (el.createTextRange) {
            var range = el.createTextRange();
            range.move('character', caretPos);
            range.select();
            return true;
        }

        else {
            // (el.selectionStart === 0 added for Firefox bug)
            if (el.selectionStart || el.selectionStart === 0) {
                el.focus();
                el.setSelectionRange(caretPos, caretPos);
                return true;
            }

            else  { // fail city, fortunately this never happens (as far as I've tested) :)
                el.focus();
                return false;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-04-19T11:54:15.707

我稍微调整了 kd7 的答案，因为当 selectionStart 偶然为 0 时，elem.selectionStart 将评估为 false。

```
function setCaretPosition(elem, caretPos) {
    var range;

    if (elem.createTextRange) {
        range = elem.createTextRange();
        range.move('character', caretPos);
        range.select();
    } else {
        elem.focus();
        if (elem.selectionStart !== undefined) {
            elem.setSelectionRange(caretPos, caretPos);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2019-08-29T12:13:25.410

我找到了一种解决此问题的简单方法，在 IE 和 Chrome 中进行了测试：

```
function setCaret(elemId, caret)
 {
   var elem = document.getElementById(elemId);
   elem.setSelectionRange(caret, caret);
 } 
```

将文本框 ID 和插入符号位置传递给此函数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-01-14T08:47:09.930

如果您需要关注某个文本框，而您唯一的问题是整个文本被突出显示，而您希望插入符号位于末尾，那么在这种特定情况下，您可以使用在焦点后将文本框值设置为自身的技巧：

```
$("#myinputfield").focus().val($("#myinputfield").val()); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-03-23T16:44:21.397

```
function SetCaretEnd(tID) {
    tID += "";
    if (!tID.startsWith("#")) { tID = "#" + tID; }
    $(tID).focus();
    var t = $(tID).val();
    if (t.length == 0) { return; }
    $(tID).val("");
    $(tID).val(t);
    $(tID).scrollTop($(tID)[0].scrollHeight); } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-05-31T04:55:16.660

我会修复如下条件：

```
function setCaretPosition(elemId, caretPos)
{
 var elem = document.getElementById(elemId);
 if (elem)
 {
  if (typeof elem.createTextRange != 'undefined')
  {
   var range = elem.createTextRange();
   range.move('character', caretPos);
   range.select();
  }
  else
  {
   if (typeof elem.selectionStart != 'undefined')
    elem.selectionStart = caretPos;
   elem.focus();
  }
 }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-08-14T14:04:48.390

```
<!DOCTYPE html>
<html>
<head>
<title>set caret position</title>
<script type="application/javascript">
//<![CDATA[
window.onload = function ()
{
 setCaret(document.getElementById('input1'), 13, 13)
}

function setCaret(el, st, end)
{
 if (el.setSelectionRange)
 {
  el.focus();
  el.setSelectionRange(st, end);
 }
 else
 {
  if (el.createTextRange)
  {
   range = el.createTextRange();
   range.collapse(true);
   range.moveEnd('character', end);
   range.moveStart('character', st);
   range.select();
  }
 }
}
//]]>
</script>
</head>
<body>

<textarea id="input1" name="input1" rows="10" cols="30">Happy kittens dancing</textarea>

<p>&nbsp;</p>

</body>
</html> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-20T16:22:33.407

*HTML 输入元素*。**设置选择范围（*选择开始，选择*结束）；**

```
// References
var e = document.getElementById( "helloworldinput" );

// Move caret to beginning on focus
e.addEventListener( "focus", function( event )
{
    // References
    var e = event.target;

    // Action
    e.setSelectionRange( 0, 0 );            // Doesn’t work for focus event

    window.setTimeout( function()
    {
        e.setSelectionRange( 0, 0 );        // Works
        //e.setSelectionRange( 1, 1 );      // Move caret to second position
        //e.setSelectionRange( 1, 2 );      // Select second character

    }, 0 );

}, false ); 
```

浏览器兼容性（仅适用于类型：文本、搜索、url、电话和密码）： [https ://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange#Specifications](https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange#Specifications)

# sdk - 在 Sprint PCS 上具有良好 SDK 的智能手机？

> ID：512530
> 
> 赞同：0
> 
> 时间：2009-02-04T17:55:43.247
> 
> 标签：sdk, smartphone, emulation

只要手机一直在运行第三方应用程序，我就想尝试写一些。

现在是更换我的 PalmOS 驱动的 Treo 530 的时候了，我正在寻找一款具有强大的第三方开发平台的新手机。出于合同原因，它必须在 Spring PCS 网络上运行。

理想情况下，这样的手机应该有一个文档齐全的 API、一个得到良好支持的操作系统，以及一个可以在 Windows XP 或 Fedora Core 下运行的模拟器。

有人知道这样的电话吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T18:02:18.897

对于 Sprint 网络，您最好使用 BlackBerry 或 Windows Mobile 设备。只有这两个具有非常强大的 SDK。如果这不是用于个人/爱好项目工作并且您打算为他们开发商业应用程序，那么您应该选择 Sprint 3.3.2 SDK。它适用于大多数 sprint 手机，包括触摸屏、Qwerty 键盘和翻转/滑屏手机。

由于您可能不会针对多个手机支持（如我的日常工作），这将容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T17:57:25.100

如果您喜欢 Palms，那么最新的 Palms 可以运行 windows mobile，它可以运行符合您标准的 .NET Compact Framework。

# silverlight - Silverlight 控件中的旋转变换后按钮渲染不正确

> ID：512531
> 
> 赞同：0
> 
> 时间：2009-02-04T17:56:16.490
> 
> 标签：silverlight, rotation

看起来子 silverlight 控件的宽度总是被容器的宽度剪裁。即使子控件旋转。

XAML 的第一个“块”将呈现一个对于堆栈面板来说太大并且被剪裁的 Button，这是有道理的。

```
<StackPanel Width="20">
    <Button Width="100" Content="Foo" />
</StackPanel> 
```

第二个 XAML 块将按钮旋转 90 度。我希望看到完整的按钮，因为它现在是垂直的。

```
<StackPanel Width="20">
    <Button Width="100" Content="Foo" >
        <Button.RenderTransform>
        <TransformGroup>
            <ScaleTransform/>
            <SkewTransform/>
            <RotateTransform Angle="90"/>
            <TranslateTransform/>
        </TransformGroup>
            </Button.RenderTransform>
    </Button>
</StackPanel> 
```

在 XAML 的第二块中，似乎按钮被剪裁在同一点，如果它是水平的，我希望看到完整的按钮。

这显然是标准行为，但有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T02:30:44.813

如果垂直 StackPanel 中的元素比 StackPanel 的宽度宽，它将被剪裁到 StackPanel 的宽度。如果你删除你的 TransformGroup 你会看到你得到了相同的剪辑，只是没有旋转。裁剪发生在旋转之前，所以即使你让它足够高以显示结果，它仍然会被裁剪，因为旋转之前的容器不够大。解决这个问题的一种方法是在两者之间插入一个 Canvas，因为 Canvas 元素没有被剪裁，所以它应该按预期工作。不产生其他副作用的最佳方法是使 Canvas 与其包含的元素大小相同，否则您可能会从 StackPanel 获得奇怪的大小调整行为。

所以你的代码看起来像这样：

```
 <StackPanel Width="20">
        <Canvas Width="100" Height="20">                
            <Button Width="100" Content="Foo" >
                <Button.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform/>
                        <SkewTransform/>
                        <RotateTransform Angle="90"/>
                        <TranslateTransform/>
                    </TransformGroup>
                </Button.RenderTransform>
            </Button>
        </Canvas>
    </StackPanel> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T23:12:53.810

也许检查您的 RenderTransformOrigin 值是否正确？

通常，如果您只想将元素旋转 90°，您可以将 RenderTransformOrigin 设置为 0.5,0.5。

这将导致旋转以按钮为中心发生，即按钮中心的位置不会改变。

代码中指定的 .0,1 的 RenderTransformOrigin 将使 Button 围绕一个圆的圆周旋转，该圆的中心是 Button 的左下角。这意味着按钮的中心将会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-30T09:48:41.637

而不是使用`Button.RenderTransform`，你应该使用`Button.LayoutTransform`。有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/library/ms750596.aspx](http://msdn.microsoft.com/en-us/library/ms750596.aspx)

# internet-explorer - 如何以编程方式清理 Internet Explorer cookie？

> ID：512537
> 
> 赞同：5
> 
> 时间：2009-02-04T17:57:47.017
> 
> 标签：internet-explorer, cookies

如何以编程方式清理 Internet Explorer cookie？

是否有一些 Windows API 功能可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T23:11:43.450

其实，我明白了！

在 Windows API 中，您有一个名为 cookie 的函数[**`InternetSetCookie`**](http://msdn.microsoft.com/en-us/library/aa385326(VS.85).aspx)，您可以像这样使用它：

```
InternetSetCookie("http://teste.com", NULL, "name = value; expires = Sat,01-Jan-2020 00:00:00 GMT"); 
```

但是，如果你想删除 cookie 而不是创建它，你只需要在过去的某个地方设置过期字段，如下所示：

```
InternetSetCookie("http://teste.com", NULL, "name = value; expires = Sat,01-Jan-2000 00:00:00 GMT"); 
```

有关它的更多信息，[**请参阅管理 Cookie**](http://msdn.microsoft.com/en-us/library/aa385326(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T18:04:35.943

您不能只搜索`C:\Documents and Settings\user\Local Settings\Temporary Internet Files`文件名中带有“cookie”的文件吗？

这是获取文件夹的 Win32 调用：

```
BOOL SHGetSpecialFolderPath(
  HWND hwndOwner,
  LPTSTR lpszPath,
  int nFolder,
  BOOL fCreate 
); 
```

`CSIDL_COOKIES`作为`nFolder`参数传递。

检查此链接[A Cleanup API for Windows](http://www.codeproject.com/KB/system/Cleanup_API.aspx?display=Print#cookies_cleanup)。

`FindFirstUrlCacheEntry`您可以通过和功能删除缓存的 cookie `FindNextUrlCacheEntry`。`DeleteUrlCacheEntry`您可以将 'cookie:' 作为第一个参数 ( `LPCTSTR lpszUrlSearchPattern`) 传递给`FindFirstUrlCacheEntry`.

# sql-server - 为索引指定默认文件组？

> ID：512540
> 
> 赞同：2
> 
> 时间：2009-02-04T17:59:08.670
> 
> 标签：sql-server, sql-server-2005, indexing, filegroup

这让我很困惑——在 SQL Server 2005/2008 中，我可以指定默认文件组，然后将其用于所有数据表。我还可以为所有 BLOB 类型字段指定另一个文件组。

但我无法弄清楚是否以及如何为索引指定默认文件组.....

我的设置通常是： * 主文件组 - 只有系统目录 - 最低限度 * DATA 文件组 - 我为我的数据库设置默认值 * 所有索引的 INDEX 文件组 * 所有 BLOB 数据的 BLOB 文件组（可选） * LOG（显然）

现在，如果我通过脚本手动创建所有表和索引，当然我可以为每个指定适当的文件组。但是有没有办法/技巧/黑客可以指定放置索引的位置？当我使用 SQL Server Mgmt Studio 例如将列指定为表上的主键时，它会创建一个 PK_(tablename) 索引 - 但不幸的是，它会将其粘贴到 DATA 文件组中，一旦它存在，似乎我无法更改它不再（在视觉设计师中）。

我错过了什么吗？还是微软没有提供这样的设置？

感谢任何提示，指针，线索！

马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T18:12:35.227

如果表上有聚集索引，则数据和聚集索引始终位于同一文件组中。您不能将基表和聚集索引放在单独的文件组上。这是因为聚集索引是实际的表数据。

您当然可以将非聚集索引放置在与它们引用的表不同的文件组中。

您不能指定两个默认文件组，即一个用于数据，一个用于索引。

希望这可以为您解决问题，但请随时提出进一步的问题。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-02-27T11:56:51.897

您可以在 table 所在的文件组以外的文件组上创建聚集索引，但 table 的文件组可能会自动更改为索引的文件组。

# javascript - 创建程序化颜色选择器

> ID：512548
> 
> 赞同：2
> 
> 时间：2009-02-04T18:01:03.313
> 
> 标签：javascript, colors, random, color-picker, prng

如何创建一个***确定性***的Javascript HTML 颜色选择器，它给出需要多少颜色的参数返回一组 HTML 十六进制颜色代码，即：

```
 function createColours(numColours) {
        return [/* colours array of size numColours */]     
    } 
```

颜色本身可以随机*选择/生成*，但该方法必须保证在调用之间选择的颜色始终相同，并且始终以相同的顺序排列。

例如，如果函数决定的颜色系列以以下 8 开头：

```
 "#47092E", "#CC2A43", "#00C66B", "#BC1300", "#667E00", "#795800", "#FFD245", "#6EFFAD", etc, etc 
```

该函数将在客户端上的单独方法调用中以以下一致的响应运行

```
 ["#47092E", "#CC2A43"] == createColours(2);
    ["#47092E", "#CC2A43", "#00C66B", "#BC1300", "#667E00"] == createColours(5);
    ["#47092E"] == createColours(1);        
    ["#47092E", "#CC2A43", "#00C66B", "#BC1300", "#667E00", "#795800", "#FFD245", "#6EFFAD", #and 49 others#] == createColours(57); 
```

**注意**：颜色没有预先定义为变量；可能会要求该方法提供 345 种颜色，所有这些都需要通过任何合适的方式生成。

要解决的问题是 -**首先也是最重要**的 - 你将如何在方法中创建一种能力来生成 n 个 HEX 颜色值，每次都一致地相同，同时保留序列

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T18:34:43.543

您需要使用具有固定起始种子的伪随机数生成器 (PRNG)。javascript 中的 Math.random 方法是 PRNG，但您不能像在其他语言中那样设置种子。

PRNG 的创建相当简单——互联网上有很多代码。给定一个固定的起始种子，它总是会生成相同的随机数序列，这就是您所要求的。

这些颜色看起来是否令人愉悦，[完全是另一个问题](https://stackoverflow.com/questions/43044/coloring-algorithm)......

一种具有播种功能的 javascript 实现：
[http ://www.erikoest.dk/rng2.htm](http://www.erikoest.dk/rng2.htm)

您还可以在此处找到 C 实现（易于转换为 javascript）和构建您自己的 Lehmer 类型 PRNG 的其他详细信息：
[http ://www.google.com/search?q=Lehmer%20random%20number%20generator](http://www.google.com/search?q=Lehmer%20random%20number%20generator)

另一个有代码的（[Mersenne twister](http://en.wikipedia.org/wiki/Mersenne_Twister)）： http:
[//www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/JAVASCRIPT/java-script.html](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/JAVASCRIPT/java-script.html)

这个问题涵盖了 javascript 中几种类型的 PRNG：
[Seedable JavaScript random number generator](https://stackoverflow.com/questions/424292/how-to-create-my-own-javascript-random-number-generator-that-i-can-also-set-the-s)

如果你在函数的开头给 PRNG 相同的起始种子，它总是会在每次连续调用时返回相同的数字序列。

将该数字转换为颜色，一切就绪。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T18:32:09.727

每对十六进制颜色代表一个 RGB 值。给定#AABBCC，可以推断出AA代表红色，BB代表绿色，CC代表蓝色。要获得 Red 的“值”，您首先需要将 A 从十六进制格式转换为十进制格式。

A 代表十进制的 10。当您将十六进制颜色的值对相乘时，您将获得 RBG 的每个值。因此，当您将前面所述的十六进制颜色转换为 RGB 时，您将得到 Red = A *A、Green = B* B 和 Blue = C*C 或 Red = 10*10 = 100、Green = 11*11 = 121 和 Blue = 12*12 = 144。

所以#AABBCC 是 (100,121,144) 的 RGB。我认为这应该是足够的信息来扭转这个过程......因为你不需要每种颜色长度超过 2 个十六进制字符的十六进制值，你不需要一个花哨的算法来将十进制转换为十六进制然后回来。RGB 仅从 0 到 255，因此您可以使用内置函数在基数之间进行转换，也可以通过页面上的资源制作表格：

[十六进制的维基百科页面](http://en.wikipedia.org/wiki/Hexadecimal)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T18:14:46.967

[使用上面提供的答案以及此处](https://stackoverflow.com/questions/424292/how-to-create-my-own-javascript-random-number-generator-that-i-can-also-set-the-s)的 RNG 代码，我最终得到了（假设使用[Prototype](http://prototypejs.org/)库进行类创建）：

```
 var ColourPicker = Class.create({
        initialize: function() {
            this.hash = '#';
            this.rngRed = new RNG(5872323); // using same seed always guarantees number order response same
            this.rngGreen = new RNG(332233);
            this.rngBlue = new RNG(3442178);
        },
        numberToHex: function(number, padding) {
            var hex = number.toString(16);
            return hex;
        },
        createColours: function(numColours) {
            var colours = [];
            for (var i = numColours - colours.length; i-- > 0;) {
                var r = this.rngRed.nextRange(5,240);
                var g = this.rngGreen.nextRange(10,250);
                var b = this.rngBlue.nextRange(0,230);
                colours.push(this.hash + this.numberToHex(r) + this.numberToHex(g) + this.numberToHex(b));
            }
            return colours;
        }
    });

    var colourPicker = new ColourPicker();
    var colours = colourPicker.createColours(10);

    for (var i = 0 ; i < colours.length ; i++) {
        alert(colours[i]);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T18:24:03.470

我就是这样做的。

```
(function(){
var colours = [];
var x = "0123456789ABCDEF".split('');
var addColour = function() {
  var s='#';
  for(var i=6; i-->0;)
    s+=x[Math.round(Math.random()*15)];
  colours.push(s);
};
createColours = function(numColours) {
  for(var i=numColours-colours.length; i-->0;) addColour();
  return colours.slice(0,numColours);
}
})(); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-04T18:11:01.407

也许是这样：

```
function createColours(numColours){
   var all  = ["#47092E", "#CC2A43", "#00C66B", .... ];
   var selected = [];
   for(var i=0;i<numColours;i++){
     selected.push(all[i]);
   }
   return selected;
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-04T18:18:13.093

见这篇[文章](http://www.tipstrs.com/tip/1084/Static-variables-in-Javascript)。它描述了 javascript 中的所有函数实际上是如何成为对象的。

所以这里有一个快速原型：

```
function createColours(num) {
  if ( typeof createColors.colors == 'undefined' ) {
    // We've not yet created any colors...
    createColors.colors = new array();
   }
  if ( createColors.colors.length >= num ) {
     // Create new colors and add them to the array here...

  }
  // Otherwise, return the array...
  return createColors.colors;
} 
```

# c# - 有没有办法在不使用图形对象的情况下测量适合打印区域的字符串数量？

> ID：512553
> 
> 赞同：3
> 
> 时间：2009-02-04T18:01:31.253
> 
> 标签：c#, .net, vb.net

有没有办法在不使用图形对象的情况下测量适合打印区域的字符串数量？

这是我能找到的唯一方法：

```
Graphics instance = this.CreateGraphics();
instance.MeasureString(text, f, printArea1, StringFormat.GenericDefault, 
     out end, out lines); 
```

我正在使用 .net 2.0 和 c#，但我不介意 VB 代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T11:13:04.897

是的，在 .NET 2.0 中有

`Size size = TextRenderer.MeasureString(this.Text, this.Font);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T18:09:21.567

字符串将占用的空间量直接取决于要在其上呈现字符串的图形对象。

您是在屏幕、打印机、内存表面还是位图上打印字符串？您尝试在其上测量文本的表面的 DPI 是多少？什么单位？需要应用哪些空间变换？

这一切都取决于 System.Drawing.Graphics，因为它是跟踪此信息的图形对象。

您不想使用 Graphics 对象的原因是什么？如果由于某种原因您要渲染到非图形对象，您始终可以创建一个尽可能适合您的*其他*目标的对象，并保留它以供测量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T18:08:36.980

您始终可以自己对其进行近似，但基本分析取决于了解所选字体中不同字形在不同尺寸下的相对宽度。

几年前，我在 BASIC 中通过构建字符串（相同字符的运行）来填充固定数量的空间以得出每个字符的空间的近似值。收集到这些信息后，您可以遍历字符串来累积每个字符的宽度。

这本质上是图形例程要做的事情，但它们更快、更精确。

# java - 检测Java应用程序中的Windows注销事件

> ID：512555
> 
> 赞同：2
> 
> 时间：2009-02-04T18:02:04.263
> 
> 标签：java, windows, events, shutdown-hook

是否有一个库可以与 Java 一起使用来监听用户注销和可能的其他 Windows 事件？（如果它支持多个平台就更好了！）

我记得几年前读过关于这种图书馆的书，但现在似乎找不到了。我已经看到其他线程在使用带有 win32ts 的 Python 时基本上做同样的事情。

如果它是免费和/或开源的也更好。

谢谢。

**注意**： using 的候选解决方案`Runtime.getRuntime().addShutdownHook(Thread)`不能与`javaw`. 我仍在寻找适用于 javaw 的解决方案。请参阅 java 错误 ID [4486580](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4486580)和[4302814](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4302814)。谢谢--cam

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T18:28:50.823

我想你想看看[Runtime.addShutdownHook()](http://java.sun.com/javase/6/docs/api/index.html?java/lang/Runtime.html)。这为您提供了在 JVM 关闭之前执行操作的最后机会。这使您可以检测到所有应用程序都已关闭的实际注销，但它们不仅仅是临时切换用户，而是让他们的状态准备好返回。但是，作为警告，无论您计划在关闭过程中做什么，都需要简短，因为操作系统可能随时对您发出 SIGKILL（或等效的）信号，这会立即停止 JVM。

如果这不是您所需要的，您可能需要使用 JNI 来注册本机侦听器。至于其他 Windows 事件，AWT 库提供了许多类来实现大多数普通应用程序都会感兴趣的侦听器。在这种情况下，您可能对[FocusEvent](http://java.sun.com/javase/6/docs/api/java/awt/event/FocusEvent.html)感兴趣。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T18:21:27.127

我最好的猜测是使用[ShutdownHook](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))。您可以注册一个在 JVM 关闭时立即调用的线程。

**编辑：**
如果您想在 Windows 下实现这一点，您可以创建一个不可见的窗口并对操作系统在用户注销或系统关闭时发送的[WM_QUERYENDSESSION消息做出反应。](http://msdn.microsoft.com/en-us/library/aa376890(VS.85).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-11T21:23:09.107

似乎有很多人遇到了这个问题。虽然，Java 项目的人显然不认为这是一个优先事项（最初的票是在大约 10 年前打开的）。

我在使用隐藏 JWindow 的 bug 4486580 中发布的解决方法取得了一些成功。但是，这种解决方法被认为是不可靠的。我还发现了由cowwoc 发起的一点讨论，他发布了解决方法：[http](http://forums.java.net/jive/thread.jspa?threadID=46716) ://forums.java.net/jive/thread.jspa?threadID=46716 。这种解决方法总比没有好，但是在程序确定完成清理之前阻止 Windows 注销会很好。当进程终止时，您不希望参与进程。

围绕此问题最近打开的错误是 6798985。它似乎几乎没有被注意到。

# css - CakePHP 中的 CSS 文件中的 URL 是如何处理的，以便它们引用正确的位置？

> ID：512556
> 
> 赞同：9
> 
> 时间：2009-02-04T18:02:10.300
> 
> 标签：css, url, cakephp, image, stylesheet

我正在设计一个使用 CSS 文件的网站，但我在列表中有几次背景图像、项目符号图像，我可能会发现另一个对 css`url()`函数的需求。

但是，在 cake 中，所有 URL 都应该由该`Route::url()`函数以多种方式处理，其中最常见的是`$html->url()`

但我的问题是 PHP 不解释 CSS 文件。如何创建包含以下内容的 CSS 文件：

```
div.coolbg {
  background-image: url('<?= $html->url("/img/coolbg.jpg") ?>');
} 
```

看，我的最后一个选择是在布局中内联导入 css 文件，以便对其进行解释。但我非常喜欢使用更“蛋糕”的方法。

谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-04T20:13:17.010

您不需要在 css 文件中使用 $html->url()，因此您不需要通过 PHP 解析 CSS 文件或创建 CssController。

如果您的蛋糕应用程序安装在您的虚拟主机 DocumentRoot 中，只需将所有图像路径设置为来自 webroot 的绝对路径。例如

```
div.coolbg {
  background-image: url(/img/coolbg.jpg);
} 
```

这会将 app/webroot/img/coolbg.jpg 中的图像应用到您的

如果您的蛋糕应用程序未安装在虚拟主机 DocumentRoot 中，即您通过诸如[http://www.domain.com/myapp/](http://www.domain.com/myapp/)之类的 URL 访问您的蛋糕应用程序，那么您将创建相对于 css 文件的图像路径。查看 app/webroot/css/cake.generic.css 中的样式规则，例如

```
#header h1 {
background:#003D4C url(../img/cake.icon.gif) no-repeat scroll left center;
color:#FFFFFF;
padding:0 30px;
} 
```

这是可行的，因为样式表位于 app/webroot/css/ 目录中，而图像位于 app/webroot/img/ 目录中，因此路径“../img/cake.icon.gif”来自 css目录，然后返回到 img 目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-04T21:28:27.903

我肯定会选择 zam3858 建议的解决方案。如果您不喜欢将图像放在两个不同的位置，请在指向图像的 css 目录中创建一个符号链接。像这样：

```
$ cd app/webroot/css 
$ ln -s ../img . 
```

现在，将正确解析 html 帮助程序和样式表的图像路径：

```
// css:
url(img/image.png);

// view.ctp
echo $html->image('image.png'); 
```

它可能不是 cakiest 解决方案，但它看起来不像 cakephp 提供的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-13T20:32:56.173

将行更改`background`为

```
background:url(../img/menu_027_l.jpg) no-repeat left; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T18:10:44.293

您可以通过在 Apache 中编辑 .htaccess 文件来添加要通过 PHP 处理的 CSS。处理它，而不是仅仅吐出它，确实会对性能产生轻微影响。

```
AddType application/x-httpd-php .css 
```

另见：[http ://www.webmasterworld.com/forum88/5648.htm](http://www.webmasterworld.com/forum88/5648.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T19:18:51.487

除非您首先实例化 Cake 对象，否则这对 Cake 的东西没有太大帮助。如果你想使用 html 帮助器，你可能想弄清楚第一个 Cake 对象是如何被实例化的，然后在你的 CSS 东西中模仿它。不知道我该怎么做——我认为拥有一个完整的 CSSController 会有点过头了，但我认为你可能必须实例化一个应用控制器（毕竟，你希望重写的 css url 反映你的应用设置，对吧？ ）。所以我想你可能无论如何都必须创建一个 CSSController。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T09:43:06.670

一大堆 cakephp 专家可能会因为我建议这个而讨厌我.. :)

对我来说最简单的解决方案是将图像文件包含在 css 文件夹中。像这样的东西

```
/app/webroot/css/css_images/mypic.jpg 
```

所以在css文件中我会输入：

```
background-image: url(css_images/mypic.jpg); 
```

糟糕的是，这显然不是最容易做的事情。好消息是，无论您是否使用花哨的 url，它都会起作用，因为 css 会找到相对于 css 文件的图像。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-26T16:20:12.360

我发现在将 CSS 嵌入到 CakePHP 的帮助器中时，CSS 中的相对 URL 会分崩离析。这是由于路由器能够将不同的 url 映射到同一页面，因此相对 url 需要不同。例如，如果您有一个 localhost/myapp/parts/index 或 localhost/myapp/parts/ 或 localhost/myapp/parts 之类的 url，那么 ../img/image.gif 的相对 url 将仅适用于其中一个。

在我的助手中，我发现解决它的唯一方法是让我的 css 像这样

```
.jquery-dialog-spinner {
    display:    none;
    position:   fixed;
    z-index:    1010;
    top:        0;
    left:       0;
    height:     100%;
    width:      100%;
    background: rgba( 0, 0, 0, .1 ) 
            url('__loader_image__') 
            50% 50% 
            no-repeat; 
```

}

然后在输出css之前用代码中生成的url替换标签。

```
 $map = array(
      '__loader_image__' => $this->Html->assetUrl('ajax-loader.gif', array('pathPrefix' => IMAGES_URL))
  );
  $formatted_css = strtr($this->css, $map);
  $response .= "<style type=\"text/css\">" . $formatted_css . "</style>"; 
```

如果有更简单的方法可以做到这一点，我将不胜感激。

# sql - SQL 中是否有与 iSeries OVRDBF 命令等效的命令？

> ID：512560
> 
> 赞同：2
> 
> 时间：2009-02-04T18:04:30.797
> 
> 标签：sql, ibm-midrange, control-language

我在 SQL 环境中有一个要求，即在特定情况下，过程中对表（或视图）A 的所有引用实际上都使用表（或视图）B。在 iSeries 上，我会使用 OVRDBF 命令覆盖对表 A 的引用使用表 B：OVRDBF FILE(A) TOFILE(B)。在 SQL 中与此等价的是什么？有吗？

我的目标是最终得到一个不知道覆盖的程序。当满足某些条件时，我不希望在过程中引导处理表 B 的条件逻辑。愿景：

在典型情况下：只需调用该过程

在特定的替代情况下：执行等效的 OVRDBF，然后调用过程

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T18:20:02.590

不确定哪个 SQL 环境支持哪些选项：

我相信 DB2 有一个 CREATE ALIAS 语句。在别名上写入 SQL。

另一种可能性：在视图上运行查询：您将在其中执行 OVRDBF，删除视图并在所需表上重建它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T22:24:54.590

正如 Ed 提到的，如果您可以修改您的程序：

1）为文件（A）创建别名

```
CREATE ALIAS XYZ FOR A 
```

2) 修改程序以参考 XYZ 而不是 A。

3) 运行程序时使用文件 B 执行

```
DROP ALIAS XYZ;
CREATE ALIAS XYZ FOR B;
CALL PROCEDURE;
DROP ALIAS XYZ;
CREATE ALIAS XYZ FOR A; 
```

如果您无法修改该过程并且您不担心同时访问表 A，您可以使用：

```
RENAME TABLE A TO C;
CREATE ALIAS A FOR B;
CALL PROCEDURE;
DROP ALIAS A;
RENAME TABLE C TO A; 
```

# makefile - 从大型 Makefile 变量创建文件

> ID：512567
> 
> 赞同：3
> 
> 时间：2009-02-04T18:06:38.827
> 
> 标签：makefile

我在一个名为 OBJECTS 的 Makefile 变量中有一个对象列表，它对于命令缓冲区来说太大了。因此，我使用以下方法创建一个列出对象的文件（传递给 ar）：

```
objects.lst:
    $(foreach OBJ,$(OBJECTS),$(shell echo "$(OBJ)">>$@)) 
```

虽然这可行，但它非常慢（至少在 Cygwin 上）而且我不喜欢依赖 shell 命令和重定向。

`rm -f objects.lst`此外，foreach 并非用于此目的-在运行任何命令之前对其进行评估，这意味着例如在附加之前我不能。

有没有更好的办法？我不想使用增量归档，因为这会导致多个作业出现问题。

我唯一能想到的是使用单独的脚本解析 Makefile 以读取对象列表或将对象列表存储在单独的文件中。两种解决方案都有自己的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T18:24:19.867

尝试类似：

```
OBJECTS:=a b c d
objects.lst:
        echo > $@ <<EOF      $(OBJECTS) 
```

即利用`<<EOF`外壳内置的功能。它没有任何最大长度限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T13:18:50.807

在下面的示例中，我还用一个简单的 Perl 脚本替换了 echo 以将参数拆分到新行上，但这就是它的要点。

```
objects.lst:
    echo $(wordlist 1,99,$(OBJECTS))>$@
    echo $(wordlist 100,199,$(OBJECTS))>>$@
    echo $(wordlist 200,299,$(OBJECTS))>>$@
    echo $(wordlist 300,399,$(OBJECTS))>>$@
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T18:34:02.030

像这样的东西怎么样：

```
OBJECTS_AM=$(filter a% b% c% d% e% f% g% h% i% j% k% l% m%,$(OBJECTS))
OBJECTS_NZ=$(filter-out a% b% c% d% e% f% g% h% i% j% k% l% m%,$(OBJECTS))

objects.lst:
$(shell echo "$(OBJECTS_AM)">$@)
$(shell echo "$(OBJECTS_NZ)">>$@) 
```

您可能需要再拆分一两次，但这还不错，尤其是文件名的分布不会经常更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-27T23:57:06.933

这是 gnu make 的一个补丁，可让您直接将变量写入文件。它创建了一个新的 'writefile' 函数，类似于现有的 'info' 函数，除了它接受一个文件名参数并写入文件：

[https://savannah.gnu.org/bugs/?35384](https://savannah.gnu.org/bugs/?35384)

# asp.net - 如何从一个方法返回多个 DataTable？

> ID：512570
> 
> 赞同：0
> 
> 时间：2009-02-04T18:08:04.673
> 
> 标签：asp.net, generics, list, datatable

我有一个类，它有一个需要返回三个 DataTables 的方法。我以为我可以使用泛型，但老实说我从未使用过它们，所以我正在尝试弄清楚。这可能不是正确的事情。

我在我的班级员工中有：

```
public List<Employee> GetEmployees()
{
  //calls to other methods in my class;
  //psuedocode
  GetDataTable1;
  GetDataTable2;
  GetDataTable3;

  return all three datatables;
} 
```

在我的演示方面，我有三个网格视图：

我创建了我的 Employee 类并调用 GetEmployees 并取回我的 DataTable 列表，然后

```
gridview1.datasource = datatable1;
gridview2.datasource = datatable2;
gridview3.datasource = datatable3; 
```

我不确定如何进行。我已经尝试过上面的类方法定义，但我没有做对。

希望得到建议。我不想使用三种方法。我正在使用 C# 和 asp.net 2.0。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T18:09:39.647

您可以将它们全部添加到[DataSet](http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx)并返回

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T18:10:07.133

您可以使用 DataSet，它旨在保存多个 DataTable 对象并按名称引用它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T18:10:16.323

我认为这与从方法返回 3 个变量的方式相同：

*   返回一个集合
*   创建一个结构来保存 3 个结果
*   用尽参数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T18:39:51.380

```
 Return New DataTable() {Me.GetDataTable1, Me.GetDataTable2, Me.GetDataTable3} 
```

是的，它*耸了耸肩*

# java - 您在静态变量设置器方法中为参数使用什么名称？

> ID：512577
> 
> 赞同：5
> 
> 时间：2009-02-04T18:10:03.843
> 
> 标签：java, naming-conventions

当我为实例方法编写 setter 时，我使用它来消除实例变量和参数之间的歧义：

```
public void setValue(int value) {
  this.value = value;
} 
```

那么，当 value 是类变量（静态）而不是实例的成员时，我该怎么办？

```
private static int value = 7;
public static void setValue(int value) {
  value = value;  // compile fails; ambiguous
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T18:10:58.410

采用`<classname>.value = value;`

# apache - 如何减少证书验证请求的数量......（IE正在慢慢杀死我）

> ID：512579
> 
> 赞同：0
> 
> 时间：2009-02-04T18:10:07.977
> 
> 标签：apache, internet-explorer, certificate, xampp

在客户的内部网络上，我可以使用 IE6 SP1（在 Win2K 上）向我的 SSL 站点发出请求，并查看一个证书验证请求，但如果我使用 IE6 SP2（在 XP 上），13 个单独的证书验证请求会被触发。不用说，这大大减慢了我的页面加载速度。

Firefox 加载页面很好，没有不必要的证书验证请求。

服务器是运行一个相当新的 Lampp 堆栈的 Apache。所有服务器证书/CA 链配置似乎都很好（用户可以使用受信任的证书进行身份验证，系统可以使用该服务器证书与其他系统通信，等等）

从配置的角度来看，我能做些什么吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T23:59:23.600

我猜“升级 IE”已经不在讨论范围内了，对吧？您可能正在尝试寻找一种方法来支持 IE 6.0、SP2 和 XP，以便您的用户可以使用此版本。

好的...一个想法是试图弄乱 SSL 配置。我记得，SSL 有许多可以使用的设置，也许您可​​以在服务器上更改其中的一个并获得不同的行为。在 IE 6.0 的工作和不工作版本上研究[SSL 握手](http://docs.sun.com/source/816-6156-10/contents.htm#1041640)期间发生的事情可能是值得的。我喜欢 Ethereal，这是一个免费的网络流量监视工具，可以捕获 SSL。它无法轻松解密，但您至少可以清楚地看到前几条消息。它可能会暗示为什么所有这些验证请求都会出现。

# php - PHP中的语言检测（UTF-8）

> ID：512580
> 
> 赞同：3
> 
> 时间：2009-02-04T18:10:10.863
> 
> 标签：php, internationalization

有哪些代码片段可用于检测一大段 UTF-8 文本的语言？我基本上需要过滤大量恰好是中文和阿拉伯文的垃圾邮件。有一个 PECL 扩展，但我想纯粹在 PHP 代码中执行此操作。我想我需要使用 unicode 版本的 ord() 循环遍历一个 Unicode 字符串，然后为不同的语言创建某种范围表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T22:01:55.217

通过[Google 的语言检测](http://www.google.com/uds/samples/language/detect.html)传送您的文本。您可以通过 AJAX 执行此操作。这是[文档/开发人员指南](http://code.google.com/apis/ajaxlanguage/documentation/)。例如：

```
<html>
  <head>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">

    google.load("language", "1");

    function initialize() {
      var text = document.getElementById("text").innerHTML;
      google.language.detect(text, function(result) {
        if (!result.error && result.language) {
          google.language.translate(text, result.language, "en",
                                    function(result) {
            var translated = document.getElementById("translation");
            if (result.translation) {
              translated.innerHTML = result.translation;
            }
          });
        }
      });
    }
    google.setOnLoadCallback(initialize);

    </script>
  </head>
  <body>
    <div id="text">你好，很高興見到你。&lt;/div>
    <div id="translation"></div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T18:14:57.887

您可以将 UTF-8 字符串转换为其 Unicode 代码点并查找“可疑范围”。

```
function utf8ToUnicode($utf8)
{
    if (!is_string($utf8)) {
        return false;
    }
    $unicode  = array();
    $mbbytes  = array();
    $mblength = 1;
    $strlen   = strlen($utf8);

    for ($i = 0; $i < $strlen; $i++) {
        $byte = ord($utf8{$i});
        if ($byte < 128) {
            $unicode[] = $byte;
        } else {
            if (count($mbbytes) == 0) {
                $mblength = ($byte < 224) ? 2 : 3;
            }
            $mbbytes[] = $byte;
            if (count($mbbytes) == $mblength) {
                if ($mblength == 3) {
                    $unicode[] = ($mbbytes[0] & 15) * 4096 + ($mbbytes[1] & 63) * 64 + ($mbbytes[2] & 63);
                } else {
                    $unicode[] = ($mbbytes[0] & 31) * 64 + ($mbbytes[1] & 63);
                }
                $mbbytes = array();
                $mblength = 1;
            }
        }
    }
    return $unicode;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T20:14:35.027

最简单的方法可能是拥有一本不同语言的常用词词典，然后测试每种语言有多少肯定匹配。不过，这是一项相当昂贵的（计算方面的）任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-09T09:51:11.620

**阿拉伯字符**主要在**Unicode 范围** [0600–06FF](http://unicode.org/charts/PDF/U0600.pdf)中。Unicode 对阿拉伯语有一些补充等。例如，[代码范围 0750–077F](http://unicode.org/charts/PDF/U0750.pdf)主要包含主要用于某些非洲语言的阿拉伯字符。[代码范围 08A0–08FF](http://unicode.org/charts/PDF/U08A0.pdf)涵盖了更多用于非洲语言、欧洲和中亚语言、巴基斯坦古兰经标记等的字母。如果您已经了解其他两个 Unicode 代码范围（阿拉伯语FB50 [–FDFF](http://unicode.org/charts/PDF/UFB50.pdf)和[FE70–FEFF](http://unicode.org/charts/PDF/UFE70.pdf)），则可能不太重要封面 0600–06FF。

**中文**（以及日文和韩文）字符注册在不同的 Unicode 范围内（有几个扩展）。最重要的是[4E00–9FD5](http://unicode.org/charts/PDF/U4E00.pdf)。假设您不需要担心日语，这对于*脚本检测*应该足够了，但是如果您想检查扩展名，请查看 Unicode Consortium 的[代码图表列表](http://unicode.org/charts/)。

因此，如果您只需要**过滤阿拉伯语和中文脚本**并且不想使用 troelskn 建议的方法（即使用您想要识别的语言的常用词列表 - 这对于大量语言），检测输入中字符的代码范围就足够了。StackOverflow 已经解决了关于[**如何在 PHP 中检测 Unicode 范围**](https://stackoverflow.com/questions/20713443/detect-unicode-character-range-in-php#20714508)的早期问题。

# asp.net - javascript 和 ASP.NET 控件前缀中的“this”

> ID：512588
> 
> 赞同：0
> 
> 时间：2009-02-04T18:11:12.217
> 
> 标签：asp.net, javascript

我有呈现以下 HTML 的代码

```
<tr>
  <td>Control 1 with onclick="javascript:Test(this);" </td>
  <td>Control 2</td>
  <td><span><div>Control 3</div></span></td>
</tr>

function Test(myThis)
{
  //Here I would like to get references to the siblings of Control 1 (in this ex: Control 2, Control 3)
  //and disable them. Any ideas?

} 
```

我正在使用这种查找兄弟的方法，因为这是在深度 = 3 的嵌套用户控件中，并且 ASP.NET 引用具有前缀的控件，这非常困难，特别是如果我在页面上有多个控件实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T18:15:58.307

如果您使用 jQuery 之类的 javascript 库，它会变得非常简单：

```
$(this).siblings().disable(); 
```

[http://docs.jquery.com/Traversing/siblings#expr](http://docs.jquery.com/Traversing/siblings#expr)

如果您没有 jQuery 或类似的库，则必须手动执行：

```
function disableSiblingsOf(elem)
{
  var nodes = elem.parent.childNodes;
  for(var i=0; i<nodes.length; i++);
     if(nodes[i] != elem)
        nodes[i].disabled = true;
} 
```

这应该够了吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:16:50.787

添加 jQuery 并使用以下内容：

```
$(myThis).nextAll("td").each(function(){
  // Code to "disable" them here, dunno what you mean by that though as they are tds.
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T18:18:12.093

我假设您没有可用的 Javascript 库，因为我已经看到发布的 jQuery 答案。

这在很大程度上取决于您的控件呈现的 HTML。但是，您可能只是`this.parent`在循环中引用，直到`this.tagName === 'TR'`或`this.parent`变为 null。然后再下降。

# algorithm - 计算统计模式

> ID：512590
> 
> 赞同：2
> 
> 时间：2009-02-04T18:11:24.587
> 
> 标签：algorithm, statistics, selection, mode

我目前正在尝试验证，给定一个长度为 N 的未排序数组 A 和一个整数 k，是否存在一些出现 n/k 次或更多次的元素。

我对这个问题的想法是计算模式，然后将其与 n/k 进行比较。但是，我不知道如何快速计算这种模式。我的最终结果需要是 n *log(k)，但我真的不知道如何做到这一点。我能找到的最快的是n* k...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T18:15:29.930

使用哈希表计算每个值的频率：

```
uint[int] counts;
foreach(num; myArray) {
     counts[num]++;
}

int mostFrequent;
uint maxCount = 0;
foreach(num, count; counts) {
    if(count > maxCount) { 
        mostFrequent = num;
        maxCount = count;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T22:09:50.177

设置 m = n/k 向上取整。进行快速排序，但丢弃长度小于 m 的子列表。

像快速排序一样，你可能运气不好，反复选择接近末端的枢轴。但是，如果您随机选择枢轴，这发生的可能性很小。

递归将有 O(log(k)) 个级别，每个级别需要 O(n) 时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T18:16:47.213

只需遍历数组并将计数保存在哈希/字典中（一旦找到 n/k 就返回 true，否则返回 false）将是 O(n)

编辑，类似于：

```
counts = {}
for n in numbers:
    if ( counts.has_key( n ) ):
        counts[ n ] += 1
    else:
        counts[ n ] = 1
    if ( counts[ n ] >= n / k ):
        return true
return false 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T07:48:12.237

在 F# .net 中为具有单一模式的数据集（整数）计算统计模式

```
let foundX (num: int, dList) = List.filter (fun x -> x = num) dList
let groupNum dList =
    dList
    |> (List.map (fun x -> foundX (x, dList)))
    |> (List.maxBy (fun x -> x.Length))

let Mode (dList: int List) = 
    let x = groupNum dList
    x.Head

//using Mode
let data = [1;1;1;1;1;1;1;1;2;2;3;3;3;1;4;4;4;4;4]
Mode data;;` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T18:26:13.093

伪代码：

```
 found = false
 value = null
 B = new hashtable
 for (i =0, j = A[i]; i < |A| and !found; ++i, j=A[i])
    if B contains key j
       B[j] = B[j] + 1
       if B[j] > |A|/k
          found = true
          value = j
       endif
    else 
       B[j] = 1
    endif
 end for 
```

假设您的哈希表实现具有 O(1) 插入/查找，这应该是 O(n)

# java - 保证并发 Web 服务调用之间数据一致性的最佳执行方式？

> ID：512595
> 
> 赞同：0
> 
> 时间：2009-02-04T18:13:14.897
> 
> 标签：java, sql, database, multithreading, jakarta-ee

多个客户端同时访问在 Glassfish 或其他一些应用程序服务器上运行的 JAX-JWS Web 服务。持久性由 Hibernate 或 OpenJPA 之类的东西提供。数据库是 Microsoft SQL Server 2005。

该服务采用一些输入参数，发生一些“魔术”，然后返回基本上是序列中下一个可用值的转换版本，特定序列和转换由输入确定。执行转换的“魔法”取决于输入参数和各种数据库表（描述输入参数之间的关系、转换、从中获取下一个基值的序列以及特定序列的已提供值的列表）。不确定这是否可以全部包含在存储过程中（可能），但也不确定客户是否想要它。

在保持性能的同时，确保一致性的最佳方式是什么（即每个值都是唯一的，并且值是按顺序使用的，值没有机会到达客户端而不存储在数据库中）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:36:12.827

如果没有完整的描述（表模式等），很难提供完整的答案，但是在这里给出我最好的猜测是它是如何工作的，我会说你需要围绕你的“魔法”进行交易，这标志着下一个价值在返回它之前按照使用的顺序。如果您想重用序列号，那么您可以稍后取消标记它们（例如，如果用户随后取消他们正在做的事情），或者您可以认为它们丢失了。

一个警告是，您希望您的交易尽可能短且快，尤其是在这是一个高吞吐量系统的情况下。否则，您的序列表可能很快成为瓶颈。分析流程并查看最短的事务窗口是什么，它仍然允许您确保不重用序列并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:41:56.060

听起来您在这里拥有所需的大部分元素。根据您实现服务的方式，可能会造成困难的一件事是，在您的数据库事务安全提交且没有错误之前，您不希望向浏览器写入任何响应。

许多 web 框架保持持久会话打开（并且未提交），直到响应被呈现以支持视图对持久对象的延迟加载。如果在您的情况下是这样，您将需要确保在您确定它已提交之前，不会将任何渲染视图传递给客户端。

一种方法是 Servlet `Filter`，它缓冲您正在使用的 servlet 或 Web 服务框架的输出，直到它完成工作。

# javascript - 使用 yui 将新项目添加到组合框

> ID：512597
> 
> 赞同：0
> 
> 时间：2009-02-04T18:14:28.200
> 
> 标签：javascript, yui

有人可以帮助我吗？（对不起我的英语，我是法国人）我有一个组合框，我想在读取组合框中填充的数据数组之前插入一个项目“add-item”。总结一下 ：

1-添加到我的组合框“add-item”（在读取数组之前添加），

2- 从我的数组中添加到我的组合框数据（这部分没问题）。

这是我的代码：

```
<h3>What would you like for breakfast?</h3>
<div id="bAutoComplete">
    <input id="bInput" type="text"> <span id="toggleB"></span>
    <div id="bContainer"></div>
    <input id="myHidden" type="hidden">
</div>

<script type="text/javascript" src="assets/datafab.js"></script>
YAHOO.namespace("example.container");
YAHOO.example.Combobox = function() {
    // Instantiate DataSources
    var bDS = new YAHOO.util.LocalDataSource(YAHOO.example.Data.menu.breakfasts);
    // Optional to define fields for single-dimensional array 
    bDS.responseSchema = {fields : ["name"]}; 

    // Instantiate AutoCompletes
    var oConfigs = {
        prehighlightClassName: "yui-ac-prehighlight",
        useShadow: true,
        queryDelay: 0,
        minQueryLength: 0,
        animVert: .01
    }
    var bAC = new YAHOO.widget.AutoComplete("bInput", "bContainer", bDS, oConfigs);
    bAC.resultTypeList = false;

    // Breakfast combobox
    var bToggler = YAHOO.util.Dom.get("toggleB");
    var oPushButtonB = new YAHOO.widget.Button({container:bToggler});
    var toggleB = function(e) {
        //YAHOO.util.Event.stopEvent(e);
        if(!YAHOO.util.Dom.hasClass(bToggler, "open")) {
            YAHOO.util.Dom.addClass(bToggler, "open")
        }

        // Is open
        if(bAC.isContainerOpen()) {
            bAC.collapseContainer();
        }
        // Is closed
        else {
            bAC.getInputEl().focus(); // Needed to keep widget active
            setTimeout(function() { // For IE
                bAC.sendQuery("");
            },0);
        }
    }
    oPushButtonB.on("click", toggleB);
    bAC.containerCollapseEvent.subscribe(function(){YAHOO.util.Dom.removeClass(bToggler, "open")
}); 
```

我的数组数据源来自datafab.js（我们有：甜甜圈，酸奶，......），所以我需要在这个列表之前添加项目“add-item”。项目“add-item”不应该在数组 datafab.js 中是否可以使用 yui 函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T12:04:12.017

我假设`YAHOO.example.Data.menu.breakfasts`是对数组的引用。

尝试换行：

```
var bDS = new YAHOO.util.LocalDataSource(YAHOO.example.Data.menu.breakfasts); 
```

至：

```
var bDS = new YAHOO.util.LocalDataSource(['add-item'].concat(YAHOO.example.Data.menu.breakfasts)); 
```

如果要`add-item`出现在组合框的末尾，请使用：

```
var bDS = new YAHOO.util.LocalDataSource(YAHOO.example.Data.menu.breakfasts.concat('add-item')); 
```

有关详细信息，请参阅 JavaScript[`concat`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/concat)函数。

# python - Python中的Gedit插件开发

> ID：512600
> 
> 赞同：11
> 
> 时间：2009-02-04T18:15:16.797
> 
> 标签：python, plugins, gedit

有谁知道在哪里可以找到有关编写 gedit 插件的信息？我对用 Python 编写它们很感兴趣。我知道[Gedit/PythonPluginHowTo](https://wiki.gnome.org/Apps/Gedit/PythonPluginHowTo)，但它不是很好。除了编写什么都不做的插件的代码之外，我似乎找不到更多信息。我开始看别人的代码，但我认为这不应该是编写插件的自然方式。

有人可以帮忙吗？

# asp.net - jQuery DatePicker 和 .NET - 一个日历控件，但一个 .aspx 页面上有多个实例

> ID：512612
> 
> 赞同：0
> 
> 时间：2009-02-04T18:18:27.210
> 
> 标签：asp.net, jquery

场景：我有一个包含多个可折叠面板的 .aspx 页面。每个面板代表不同的报告。要运行报告，请单击面板，然后会出现报告的用户控件。我创建的日期范围控件可以包含在多个面板“内”。

下面的代码在多面板实例中不起作用。它将所有“to date”文本框设置为等于开始日期，而不仅仅是活动面板的“to date”文本框。

如何仅使用已展开的面板中的文本框？

谢谢你的帮助！

```
<script type="text/javascript">
  $(document).ready(function(){
    $('#dFrom').datepicker();
    $('#dTo').datepicker();

    $('#dTo').click(function(){
    try{    

        var from = $('#dFrom').datepicker("getDate");

        $('#dTo').datepicker("setDate",from);

        }
        catch(Error)
        {
        alert(Error);
        }
    });
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T18:26:06.523

首先，您不应该对任何存在多次的 html 元素使用 ID，而是使用类来标识重复元素。

要回答您的问题，您需要使用 $(this) 指向单击事件来自的特定元素。然后，您可以通过询问其兄弟来简单地查询调用事件的日期选择器。

```
$(document).ready(function(){
    $('.dTo').click(function(){
        var from = $(this).siblings('.dFrom').datepicker("getDate");
        $(this).datepicker("setDate",from);
    });
}); 
```

我不知道您的实际 HTML 结构，因此您可能必须更改发现兄弟姐妹的方式，但希望您能理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:32:30.100

您需要更加了解您的选择器语法。我看到您正在使用每个字段的 id - 这是 ASP.Net UniqueID 的缩写吗？因为这绝对不是它的样子。

与其手动查找 id，不如让 ASP.Net 将其制作出来并以 jQuery 方式找到它们：

```
$(Function() {
  $('input[id$=dFrom]').datepicker();
  $('input[id$=dTo]').datepicker();
  $('.panel').each(function() { //replace with appropriate selector syntax for your panels
    $(this).click(function() {
      var from = $('input[id$=dFrom]',this).datepicker("getDate");
      $('input[id$=dTo]',this).datepicker("setDate",from);
    });
  });
}); 
```

# windows - 如何从 Perl 设置 Windows PATH 变量？

> ID：512613
> 
> 赞同：10
> 
> 时间：2009-02-04T18:19:09.517
> 
> 标签：windows, perl, environment

我需要从 Perl 中设置环境变量。理想情况下，我需要查询一个变量，然后在不需要时更改它。具体来说，它是我要更改的 PATH 变量。

如何获取和设置这些变量？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-04T18:36:03.367

如果您需要全局和永久更改环境变量，就像您在控制面板中设置它一样，那么您必须[使用注册表](http://www.perlmonks.org/?node_id=471822)（更新：现在有模块可以做到这一点，[Win32::Env](http://search.cpan.org/dist/Win32-Env/)和[Win32::Env ::路径](http://search.cpan.org/dist/Win32-Env-Path/)）。请注意，更改注册表中的变量并“广播”更改不会更改某些当前进程中的环境变量，尤其是 perl.exe 和 cmd.exe。

如果您只想更改当前进程（以及随后生成的子进程），那么全局 %ENV 散列变量就是您想要的（例如 $ENV{PATH}）。请参阅[perldoc perlvar](http://perldoc.perl.org/perlvar.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T18:22:12.850

$ENV{路径}？

但是请记住，环境变量只影响子进程。您不能运行 Perl 程序，更改 %ENV，然后在父进程中看到该更改——环境不是那样工作的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T18:22:13.223

您可以使用`%ENV`哈希来做到这一点

```
$ENV{PATH} = 'C:\\Windows\;D:\\Programs'; 
```

# database-design - 名称的推荐数据库列大小是多少？

> ID：512614
> 
> 赞同：4
> 
> 时间：2009-02-04T18:19:28.473
> 
> 标签：database-design, internationalization

关于数据库设计，对于某人的名字、中间名和姓氏等字段，推荐的列大小是多少？此外，中间名的标准一个字符是否安全，或者是否应该为中间名首字母留出额外的空间？

具体来说，我正在寻找可以让我不必担心国际使用的尺寸。我见过一些中间的首字母是两个字符，所以我怀疑单个字符是个好主意，但我很好奇是否已经有任何指导方针。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T18:29:27.703

ISO 还没有发布人类命名标准，尽管我听说初步草案正在最高级别通过。

:)

说真的，64 左右应该足以容纳 99.99% 的名字和姓氏——在任何语言中。我从来没有见过除了一个 MI 字符之外的任何东西（虽然你是对的，但很多人不止一个）。

顺便说一句：除非我弄错了，否则电子邮件地址 - 从技术上讲 - 最多可以包含 320 个字符，并且可以包含 ! # $ % & ' * + - / = ? ^ _ ` { | } ~ 和 . 前提是 . 不是第一个也不是最后一个字符，也不能连续出现两次或多次。

PS。我的宠物兔的名字是“His Imperial Majesty Theopolops Bunny Galore”。不用说，这在兽医的数据库中被截断了。我认为他们将其称为“他的帝国少校”。就这样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T18:28:43.163

如果要支持[世界上最长的名称](http://www.museumofhoaxes.com/hoax/weblog/permalink/worlds_longest_surname/)，则需要组合 590 个字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T18:23:27.573

我不确定长度，但如果您要进行国际化，那么一定要使用，`nvarchar`因为这将支持您可能遇到的任何“扩展”ASCII 字符。另一个好的部分`nvarchar`是它具有固定的最大长度，但不会将值填充到该长度。

换句话说，我的名字将被存储为

```
'Andrew' 
```

在一个`nvarchar(20)`字段中，但将存储为

```
'Andrew              ' 
```

在一个`char(20)`领域。因此，考虑到这一点，我会为名称拍摄大量名称，并认为您不会浪费额外的空间使用`nvarchar`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T18:23:56.810

我个人认为这归结为您合理期望必须存储多少数据。即使您将拥有一百万个名称，对每个名称使用 char(64) 或更大的字符也可能没有什么坏处。如果大小是一个问题，您可以从 32 开始并使用 alter column 增大大小，但请记住，这对于大型表来说是一项昂贵的操作。

# sql-server - 如何从另一个表中“减去”一个表？

> ID：512620
> 
> 赞同：6
> 
> 时间：2009-02-04T18:21:01.340
> 
> 标签：sql-server

我有一个主表`A`，大约有 900 万行。另一个表`B`（相同的结构）有大约 28K 行来自 table `A`。`B`从表中删除所有内容的最佳方法是`A`什么？

所有列 (~10) 的组合都是唯一的。没有更多的唯一键的形式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T12:35:09.663

如果您有足够的权限，您可以创建一个新表并将其重命名为 A。要创建新表，您可以使用以下脚本：

```
CREATE TABLE TEMP_A AS
SELECT *
FROM   A
MINUS
SELECT *
FROM   B 
```

这应该表现得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T18:23:58.213

```
DELETE FROM TableA WHERE ID IN(SELECT ID FROM TableB) 
```

应该管用。不过可能需要一段时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T18:24:11.333

一种方法，只需列出所有列

```
delete table a
where exists (select 1 from table b where b.Col1= a.Col1 
AND b.Col2= a.Col2 
AND b.Col3= a.Col3
AND b.Col4= a.Col4) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T19:16:07.750

```
Delete t2 
from t1 
inner join t2 
  on t1.col1 = t2.col1
  and t1.col2 = t2.col2
  and t1.col3 = t2.col3
  and t1.col4 = t2.col4
  and t1.col5 = t2.col5
  and t1.col6 = t2.col6
  and t1.col7 = t2.col7
  and t1.col8 = t2.col8
  and t1.col9 = t2.col9
  and t1.col10 = t2.col0 
```

这可能会非常慢，因为您必须对每个 col 进行索引，这在这种大小的表没有主键的环境中是极不可能的，所以在非高峰期进行。是什么让你拥有一张包含 900 万条记录但没有主键的表？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T21:14:45.293

如果这是您必须定期做的事情，那么首选应该是尝试改进数据库设计（寻找主键，尝试让“连接”条件出现在尽可能少的列上） .

如果这是不可能的，则不同的第二个选项是找出每列的“选择性”（即每列有多少“不同”值，'name' 将比 'address country' 更具选择性）男/女'）。我建议的一般陈述类型是这样的：

```
Delete from tableA
where exists (select * from tableB
 where tableA.colx1 = tableB.colx1
 and tableA.colx2 = tableB.colx2
 etc. and tableA.colx10 = tableB.colx10). 
```

想法是按选择性顺序列出列，并在 tableB 上的 colx1、colx2 等上建立索引。表 B 中的确切列数将是一些试验和测量的结果。（通过删除语句的改进时间来抵消在 tableB 上建立索引的时间。）

如果这只是一次操作，我会选择上面列出的慢速方法之一。当您可以在回家之前开始声明时，可能不值得为此付出太多努力...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T18:27:21.903

是否有可以使用的键值（或值）？

就像是

```
DELETE a
FROM tableA a
INNER JOIN tableB b
on b.id = a.id 
```

# java - Java 中的 try-catch 块 - catch 代码中的执行语句

> ID：512624
> 
> 赞同：5
> 
> 时间：2009-02-04T18:22:10.323
> 
> 标签：java, catch-block

我对 Java 中的 catch 块中语句的执行顺序有疑问。当我运行以下类 Test1（见下文）时，我希望首先输出 Hi!，然后是 e.printStackTrace(); 声明，然后再见！但是，我从来没有收到过这个订单。请查看我在下面粘贴的输出。

```
public class Test1 {

    public static void calculate() {
        try {
             int h = 5/0; 
        } catch (ArithmeticException e) {
            System.out.println("Hi!");
            e.printStackTrace();
        } 
        System.out.println("Bye!");
    }

    public static void main(String[] args) {
        calculate();
    }

} 
```

输出1：

```
你好！
再见！
java.lang.ArithmeticException: / 由零
    在 Test1.calculate(Test1.java:6)
    在 Test1.main(Test1.java:15)

```

输出2：

```
java.lang.ArithmeticException: / 由零
    在 Test1.calculate(Test1.java:6)
    在 Test1.main(Test1.java:15)
你好！
再见！

```

我有两个问题：

1.）更重要的问题：为什么我总是有嗨！再见！总是一个接一个地打印，即使代码中的 mye.printStackTrace() 在它们之间？

2.) 为什么有时我在 Hi! 之前有语句 e.printStackTrace() 的输出，有时在再见！? 我已经多次运行该程序，但我无法理解在什么情况下我会得到一份或另一份打印。

谢谢你。

我正在使用 Java 6 和 Eclipse (Ganymed)。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-04T18:24:27.993

[`Exception.printStackTrace()`](http://java.sun.com/javase/6/docs/api/java/lang/Throwable.html#printStackTrace(java.io.PrintWriter))打印到**`System.err`**而 " `Hi!`" 和 " `Bye!`" 处于打开状态**`System.out`**。如果您在常规控制台上运行程序，它们最终会出现在屏幕上，但顺序可能会失效。如果您通过 IDE（例如[NetBeans](http://www.netbeans.org/)）运行程序，则流可能会进行颜色编码，以便您可以轻松区分它们。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T18:25:43.187

你打印“嗨！” 和“再见！” 到`System.out`（即标准输出），而堆栈跟踪打印到`System.err`（即标准错误）。它们的打印顺序由刷新两个缓冲区的时间决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T18:25:11.517

这可能是时间问题。Println 写入标准输出，而 printStackTrace 可能与标准错误挂钩。那么这只是首先刷新哪个缓冲区的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T18:26:24.870

A1 - e.printStackTrace() 打印到 System.err 而不是 System.out，所以不同的流，不同的打印顺序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T18:25:50.690

尝试在每次打印后添加 System.out.flush()（包括 printStackTrace）。

# c# - pinvoke：不确定如何使用 dllimport 和导入的库

> ID：512628
> 
> 赞同：0
> 
> 时间：2009-02-04T18:23:07.310
> 
> 标签：c#, .net, pinvoke, dllimport

我正在对 C++ dll 执行 dllImport，并且我有以下签名。到目前为止，StackOverflow 一直很有帮助，所以我想我会扔掉这个，看看我得到了什么。

有什么我应该担心的问题吗？这是我第一次使用 dllimport。

我需要将以下内容导入 C#：

处理 FooInit(char* 名称); //名称似乎是一个字符串，如“COM1”

int Foo1(HANDLE 句柄, const char** 句); //sentence 似乎是一个类似“Hello World”的字符串

int Foo2(HANDLE 句柄, DWORD* val);

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T19:09:46.000

查看[P/Invoke 备忘单](http://khason.net/blog/pinvoke-cheat-sheet/)（不完整，但可以快速参考）。char * 通常变成字符串。const char ** 比较棘手，因为我无法通过查看它来判断它是指向单个字符串还是字符串数组的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:36:02.883

乍一看，我希望您将 IntPtr 用于所有参数和 HANDLE 返回类型，并将 int 用于 Foo1 和 Foo2 的返回值。

# javascript - 显示 web 服务调用的微调器（如 UpdateProgress 控件）

> ID：512636
> 
> 赞同：1
> 
> 时间：2009-02-04T18:24:07.557
> 
> 标签：javascript, web-services, asp.net-ajax, updatepanel

现在，我有一个页面，不幸的是，其中混合了更新面板和从 javascript 调用 webservice web/script 方法。

我有一个更新进度控件，它显示了更新面板活动的微调器。但是当我进行网络服务调用时，它不会显示。

你会建议我如何解决这个可用性问题，因为用户体验需要保持一致。我应该挂钩每个 web 服务调用以隐藏和显示 updatecontrol 的 div 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T19:14:55.817

好吧，[对于初始页面呈现和同步回发，不显示 UpdateProgress 控件。](http://www.asp.net/Ajax/Documentation/Live/overview/UpdateProgressOverview.aspx)因此，请确保您的 UpdatePanel 正在异步更新。

此外，在链接页面的底部，它显示了您必须拥有什么才能控制微调器何时出现。

话虽如此，这是微软解决您问题的黄金途径。ASP.NET Ajax 库中的某个地方可能存在阻止微调器显示的错误。

如果您确实用尽了所有选项，请尝试自己做。如果您覆盖 beginRequest 和 endRequest JavaScript 方法，您可以控制微调器何时显示。我可能会将这些函数中的任何先前代码保存到如下变量中：

```
function addLoadEvent(func)
{
    var oldonload = window.onload;
    if(typeof window.onload != 'function')
    {
        window.onload = func;
    }
    else
    {
        window.onload = function()
        {
            oldonload();
            func();
        }
    }
} 
```

现在，当然，这段代码用于向 window.onload 添加一个新函数，但同样的技术也适用于 beginRequest 和 endRequest。

希望这可以帮助

# c# - 寻找更快的 DataGridView（或同等产品）

> ID：512639
> 
> 赞同：0
> 
> 时间：2009-02-04T18:24:22.207
> 
> 标签：c#, .net, controls

我有一个大表，加载 DataGridView 很慢。桌子会变大。

有没有办法优化加载？有没有好的替换控制？（如果需要，我们会购买一个。）有没有我没想过的选项？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T18:27:34.463

> 有没有我没想过要问的选项？

是的！分页+搜索过滤。如果您的数据网格视图中有这么多记录，那么您的用户很可能会觉得它很麻烦。添加搜索功能以限制他们正在查找的项目数量，并且一次只显示一个页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T18:29:51.947

我会说，我已经尝试了几个 GridView 控件，并与 DevExpress 解决。它真的非常快。

如果您想加快自己的速度，您可能想尝试在数据更新期间暂停布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T21:57:35.897

我发现使用中继器可以很好地工作。

我没有在 DataGrid 和 Repeater 之间进行任何性能测试。它没有 DataGridView 的一些附加功能，这将减少一些开销。由于缺少某些功能，我认为它会更快。另外，您可以对最终的 HTML 进行更多控制。

我也同意 Joel 的观点，即分页和搜索过滤器将是提高速度的好方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T22:09:47.650

您是否考虑过[缓存](http://msdn.microsoft.com/en-us/library/ms998549.aspx#scalenetchapt06_topic14)数据？

> 设计良好的缓存策略可能是与性能相关的最重要的设计考虑因素。ASP.NET 缓存功能包括输出缓存、部分页面缓存和缓存 API。

点击链接了解具体信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T22:38:04.643

分页只是答案的一半。

例如，如果您有一个生产成本很高的记录集，但您一次只呈现一个页面，它可能仍然太慢。另一方面，如果您有一个便宜的记录集，那么检索所有记录并丢弃除一页之外的所有记录并不是什么大问题。

许多人以这样一种方式编写查询，即一次只从 SQL 返回一个页面到 .net，并且只呈现一个页面（就像 Joe 提到的中继器）。这通常是最麻烦和最快的解决方案。

# c# - ZedGraph - 我正在寻找使用 DateTime 的示例

> ID：512642
> 
> 赞同：6
> 
> 时间：2009-02-04T18:25:09.647
> 
> 标签：c#, zedgraph

我正在寻找在 zedgraph 折线图 X 轴上使用日期时间字段的示例。

编辑 - 以及如何设置 XAxis 最大比例

```
myPane.XAxis.Type = AxisType.Date;
myPane.XAxis.Scale.Min = 0;
myPane.XAxis.Scale.Max = 12; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-02-03T10:06:39.057

最近遇到了同样的问题，我发现上面的答案实际上并不正确。示例代码简单地将 XDate() 转换为 double。

但是，该示例确实突出了您需要做的事情。我仍然使用 DateTime.ToOADate()，但是通过添加以下代码，我可以看到时间（HH:MM:SS 格式）：

```
pane.XAxis.Type = AxisType.Date;
pane.XAxis.Scale.MajorUnit = DateUnit.Hour;
pane.XAxis.Scale.Format = "T"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T18:36:41.043

您必须将 DateTime 变量转换为[XDate](http://web.archive.org/web/20080924055001/http://zedgraph.org/wiki/index.php?title=What_is_an_XDate_struct%3F)结构。您可以创建这样的方法：

```
public XDate ConvertDateToXdate(DateTime date)
{
  return new XDate(date.ToOADate);
} 
```

这是使用 XDate 结构的图表[示例](http://web.archive.org/web/20081002210147/http://zedgraph.org/wiki/index.php?title=Hi-Low-Close_Demo)

# c# - 如何在 Silverlight 中的 DataGrid 末尾包含自定义行？

> ID：512644
> 
> 赞同：10
> 
> 时间：2009-02-04T18:25:22.110
> 
> 标签：c#, xaml, datagrid, silverlight-2.0, controltemplates

我的 Silverlight 应用程序中有一个`DataGrid`，它运行良好，在我操作`ItemsSource`集合时添加一行或删除一行。但是，我希望有一个额外的行，或者总是出现在最后一个数据行之后的控件。

我可以使用 a 将附加控件显示在最后一行之后，`ControlTemplate`并将 RowsPresenter 行设置为自动高度，但这意味着当渲染区域变得太小时时，行永远不会滚动。但是，如果我将 RowsPresenter 行高更改为星形，行会滚动，但附加控件会显示在数据网格的底部而不是最后一行的底部。

有没有办法可以让 RowsPresenter 上的星形高度行为，同时仍然让我的控件以我想要的方式显示？

我目前的想法是，我需要以某种方式使用 LoadingRow 事件来找到最后一行的位置，并使用 Canvas 或类似的东西将我的控件放置在适当的位置。

想法？

在此先感谢您的帮助。

### 更新

我还问了一个关于将一个控件固定在另一个控件下方的问题（并最终得到了回答），如果您不希望自定义行与其余行一起滚动（例如在我的情况下，其中我想要另一个数据网格标题行来显示总数并浮动在其他行上）。

[如何在 Silverlight 中将一个控件固定在另一个控件下方？](https://stackoverflow.com/questions/849768/how-do-i-pin-one-control-below-another-in-silverlight)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T15:11:03.530

我昨晚在一阵灵感中解决了我的问题。我注意到没有其他人为这个问题投票，所以这个答案可能对任何人都没有帮助，但以防万一。

首先，我将我的自定义行控件和 RowsPresenter 组合在一个由两行组成的网格中，每行的大小为 Auto。然后我将网格放置在 ScrollViewer 中，然后将滚动查看器行的大小调整为星形大小。我没有将 VerticalScrollbar 模板部分添加到我的模板中，因为这只会滚动 RowsPresenter。

这给了我我一直在寻找添加行的确切行为，并且自定义行仍然固定在最后一个数据行的底部。当行和自定义行溢出可见区域的末尾时，滚动条似乎允许滚动，同时保持标题固定到位。

Job done. I hope someone finds this helpful. Below is my ControlTemplate XAML.

```
<ControlTemplate TargetType="swcd:DataGrid" x:Key="DataGridTemplate">
    <Border
        BorderBrush="{TemplateBinding BorderBrush}"
        BorderThickness="{TemplateBinding BorderThickness}">

        <Grid Name="Root" Background="{TemplateBinding Background}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <swcdp:DataGridColumnHeader Name="TopLeftCornerHeader" Grid.Column="0"/>
            <swcdp:DataGridColumnHeadersPresenter Name="ColumnHeadersPresenter" Grid.Column="1"/>
            <swcdp:DataGridColumnHeader Name="TopRightCornerHeader" Grid.Column="2"/>

            <ScrollViewer
                Grid.Row="1"
                Grid.Column="1"
                Grid.ColumnSpan="1"
                Padding="0,0,0,0"
                BorderThickness="0,0,0,0"
                VerticalScrollBarVisibility="Auto">
                <Grid >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <swcdp:DataGridRowsPresenter Name="RowsPresenter" Grid.Row="0" />

                    <Border
                        Margin="1,1,1,1"
                        Padding="2,2,2,2"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        Grid.Row="1">
                        <Grid Background="{TemplateBinding Background}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                TextAlignment="Left"
                                TextWrapping="NoWrap"
                                Text="Add a new item using the lists below:" />

                            <mystuff:MySelectionControl
                                HorizontalContentAlignment="Stretch"
                                Grid.Row="1"
                                SelectionChanged="OnSelectionChanged"/>
                        </Grid>
                    </Border>
                </Grid>
            </ScrollViewer>

            <Rectangle Name="BottomLeftCorner" Grid.Row="3" Grid.ColumnSpan="2" />
            <Grid Grid.Column="1" Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Rectangle Name="FrozenColumnScrollBarSpacer" />
                <ScrollBar Name="HorizontalScrollbar" Grid.Column="1" Orientation="Horizontal" Height="18" />
            </Grid>
            <Rectangle Name="BottomRightCorner" Grid.Column="2" Grid.Row="3" />
        </Grid>
    </Border>
</ControlTemplate> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-21T08:50:03.767

Not sure if this helps for Silverlight, but I added a totals row to a WPF DataGrid by adding and invisible column, called IsTotal. I was able to get this row to always appear at the buttom of the grid using custom grouping / sorting. The grouping / sort order was configured to use this column as the primary sort, with a fix direction. Seems to work well.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-14T08:48:08.900

First, create a Grid for the DataGrid and the pinned control:

```
<Grid Grid.Row="0" VerticalAlignment="Top">
    <Grid.RowDefinitions>
        <RowDefinition Height="*" />               
        <RowDefinition Height="Auto" />            
    </Grid.RowDefinitions>

    <sdk:DataGrid Grid.Row="0" ItemsSource="{Binding YOUR_COLLECTION}" />

    <TextBlock Grid.Row="1" Text="Hello World" /> <!-- The pinned control. -->
</Grid> 
```

The trick is VerticalAlignment="Top" - when the DataGrid is smaller than the available height, it will move to the top of the available space and the pinned control will appear under it.

Then, put this Grid into a container that stretches vertically, for example in a row of another Grid with Star height:

```
<Grid x:Name="LayoutRoot">
    <Grid.RowDefinitions>
        <!-- RowDefition for the Grid with the DataGrid with the pinned control. --> 
        <!-- If you want to have some other controls, -->
        <!-- add other RowDefinitions and put these controls there.  -->
        <RowDefinition Height="*" /> 
    </Grid.RowDefinitions>

    <!-- The internal Grid for the DataGrid & the pinned control. -->
    <Grid Grid.Row="0" VerticalAlignment="Top">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />               
            <RowDefinition Height="Auto" />            
        </Grid.RowDefinitions>

        <sdk:DataGrid Grid.Row="0" ItemsSource="{Binding YOUR_COLLECTION}" />

        <TextBlock Grid.Row="1" Text="Hello World" /> <!-- The pinned control. -->
    </Grid>
</Grid> 
```

Instead of the root Grid you may have any other container that stretches vertically, the important thing is that it tries to fill all the available space for it.

# c# - Java 的静态概念与 C# 的概念有何不同？

> ID：512651
> 
> 赞同：6
> 
> 时间：2009-02-04T18:26:40.593
> 
> 标签：c#, java, static

我正在阅读 Josh Bloch 的《*Effective Java* 》一书，他建议在构建具有大量成员的对象时使用构建器设计模式。据我所知，这不是香草设计模式，而是看起来像他的变体。我更喜欢它的外观，并试图在我正在编写的 C# Web 应用程序中使用它。这是用Java编写的代码并且可以完美运行

```
public class Property { 

    private String title;
    private String area;

    private int sleeps = 0;

    public static void main(String[] args) {

        Property newProperty = new Property.Builder("Test Property").Area("Test Area").Sleeps(7).build();

    }

    private Property(Builder builder) {
        this.title = builder.title;
        this.area = builder.area;
        this.sleeps =builder.sleeps;
    }

    public static class Builder{
        private String title;
        private String area;

        private int sleeps = 0;

        public Builder (String title){
            this.title = title;
        }

        public Builder Area(String area){
            this.area = area;
            return this;
        }

        public Builder Sleeps(int sleeps){
            this.sleeps = sleeps;
            return this;
        }

        public Property build() {
            return new Property(this);
        }
    }   
} 
```

当我把它放入我认为是 C# 等价物时

```
 public class Property
    {
    private String title;
    private String area;

    private Property(Builder Builder)
    {
        title = Builder.title;
        area = Builder.area;
    }

    public static class Builder
    {
        // Required parameters
        private String title;
        private String area;

        // Optional parameters
        private int sleeps = 0;

        public Builder(String val)
        {
            this.title = val;
        }

        public Builder Area(String val)
        {
            this.area = val;
            return this;
        }

        public Builder Sleeps(int val)
        {
            this.sleeps = val;
            return this;
        }

        public Property build()
        {
            return new Property(this);
        }
    }
    } 
```

然后我得到编译器警告。他们中的大多数“不能在静态类中声明实例成员”。

所以我的问题首先是我错过了什么？如果我遗漏了某些东西，我可以按照 Josh Bloch 推荐的方式但在 C# 中进行操作，最后，这一点也很重要，这是线程安全的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T18:41:55.603

`public static class`在 Java 中意味着您定义了一个静态嵌套类。这意味着它在逻辑上包含在另一个类中，但它的实例可以在不引用它的外部类的情况下存在。非静态嵌套类称为“内部类”，它的实例只能相对于外部类的实例存在。

在 C# 中，a`static class`是不能被实例化的，因此不能有任何非静态成员。Java 中没有与此构造直接等效的语言级别，但您可以通过仅提供私有构造函数来轻松防止 Java 类的实例化。

简短的 Java 回顾：

*   在另一个类中定义的所有类都是“嵌套类”
*   不是嵌套的类`static`称为内部类
*   内部类的实例只能相对于外部类的实例存在
*   `static`嵌套类没有单独的名称
*   `static`嵌套类在很大程度上独立于它们的外部类（除了一些特权访问）。

如果一些 C# 大师告诉我们如何在 C#/.NET 中处理内部/嵌套类，我会很高兴。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T18:43:43.510

我认为如果您将 Builder 创建为顶级类（因为这正是 Java 中的内容）并创建一个工厂方法来接收构建器以保持构造函数私有（这反过来会如果需要，让您返回子类实例）。

关键是让构建器执行创建对象所需的步骤。

所以（在不了解 C# 的情况下，您可以尝试这样的事情）

```
// My naive C# attempt:P

public class Property 
{

    public static void main( String []args ) 
    {
         Property p = Property.buildFrom( new Builder("title").Area("area").Etc() )
    }
    public static Property buildFrom( Builder builder ) 
    {
        return new Propert( builder );
    }

    private Property ( Builder builder ) 
    {
        this.area = builder.area;
        this.title = builder.title;
        // etc. 
    }
}
public class Builder 
{
    public Builder ( String t ) 
    {
       this.title = t;
    }

    public Builder Area( String area )
    {
       this.area = area;
       return this;
    }
    // etc. 
} 
```

将 Builder 作为属性的静态内部类的全部意义在于在两者之间创建高度耦合（就好像它们在哪里一样）。这就是 Builder 中的 build 方法调用私有“Property”构造函数的原因。

可能在 C# 中，您可以使用替代工件来创建相同的耦合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T18:40:51.690

在 Java 中，嵌套类默认与其包含类的特定实例相关联。嵌套类的实例可以访问包含实例的变量和方法。如果嵌套类具有“static”关键字，则它不与外部类的实例相关联。正是在这个意义上，Bloch 在 Builder 类上使用了“static”关键字。

当应用于 C# 中的嵌套类时，“静态”意味着不同的东西。我不知道你会在 C# 中使用什么关键字，或者即使有必要。您是否尝试将 static 关键字从类定义中删除？

在 Java 类定义中使用“静态”在 Effective Java 的第 18 条中讨论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T18:48:25.277

saua 有正确的答案，但我想特别清楚你的例子：

在 C# 版本中，您应该从内部类中删除 static 关键字。它与 Java 版本的含义不同，实际上它在 Java 版本中的作用是 C# 中内部类的*正常*行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T18:33:23.793

我不确定 Java 对静态类声明做了什么，但在 C# 中，静态类是只有类级成员的类，根据定义，它不能实现到实例中。这就像类和模块之间的旧 VB 区别。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T18:43:18.830

我不知道为什么 C# 会抱怨，但我可以说代码是线程安全的。如果您同时创建两个或多个实例`Property`，每个实例都在各自的线程中，您不会遇到任何问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T18:59:10.373

我将尝试删除 static 关键字。正如其他人已经建议的那样，我的另一个想法是将构建器类创建为顶级类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T19:57:31.067

为了回答一些关于如何在 C# 中获取 Java 内部类行为的评论，似乎需要在内部类的构造函数中传递对封闭类的引用（来自快速谷歌 - C# 可能已经添加了该功能） .

```
public class Outer 
{

...
void SomeMethod() {
    Inner             workerBee=new Inner(this);
    }
...

    class Inner
    private Outer outer;
    {
    Inner(Outer out) {
        outer=out;
        }
    }
} 
```

因此，C# 只是明确说明了 Java 隐式所做的事情，包括明确需要引用来访问外部类的成员。

就个人而言，我从不喜欢 Java 对外部类成员的隐式访问，因为它似乎太容易出错并意外破坏封装 - 我几乎总是将我的内部类创建为静态并将它们传递给外部类的引用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T21:30:21.287

假设您的类具有与构建器成员对应的可公开设置的属性，则您不需要 C# 中的 Bloch 构建器模式。您可以使用**对象初始化**器：

```
public class Property 
{ 

    public String Title {get; set};
    public String Area {get; set};
    public int Sleeps {get; set};

    public static void main(String[] args)
    {

        Property newProperty = new Property {Title="Test Property", Area="Test Area", Sleeps=7};

    }
} 
```

如果您需要更多封装，这将是不可能的。

# c# - 尝试使用 c# 从 .net 运行 .dtsx 包

> ID：512652
> 
> 赞同：0
> 
> 时间：2009-02-04T18:26:44.370
> 
> 标签：c#, sql-server, ssis

我有类似的 vb 和 .net 代码，它们可以很好地运行我的 SSIS 包。问题是 c# 代码和 .net 不运行我的 .dtsx 包。我遇到各种错误，包括无法在桌面上找到文件。我尝试远程运行包并在本地运行。是我的代码吗。我不确定下一步该做什么。我确实有所有正确的参考资料。

```
//    public class clsSSIS1
 //   {
  //      public static void RunDTSX()
   //     {
   //         string pkgLocation;
   //         pkgLocation = "C:\\Documents and Settings\\otmxm1\\Desktop\\LoadBeaPayroll\\LoadBeaPayroll\\bin\\package.dtsx";

  //              Application app = new Application();
  //              Package package = null;               
   //             Package pkg = app.LoadPackage(pkgLocation, null,true);
                //Package pkg = app.LoadPackage(@"C:\Documents and Settings\otmxm1\Desktop\LoadBeaPayroll\LoadBeaPayroll\bin\package.dtsx", null);
  //              DTSExecResult result = package.Execute();
                //Console.WriteLine (result.ToString);
  //              Console.ReadKey();

 //           }
//        }
//    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T14:53:19.630

为什么不直接执行

```
dtexec.exe -f package.dtsx /conf ConfigurationIfYouGotOne 
```

使用`System.Diagnostics.Process.Start(xxx)`？

或者，如果 SSIS 部署到 SQL Server，您可以使用存储过程执行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T20:59:52.157

这是我发现的一个很好的例子：

1.  启动 Visual Studio 开发环境，并使用您首选的开发语言创建一个新应用程序。此示例使用控制台应用程序；但是，您也可以从 Windows 窗体应用程序、ASP.NET Web 窗体或 Web 服务或 Windows 服务运行包。

2.  在项目菜单上，单击添加引用并添加对 Microsoft.SqlServer.ManagedDTS.dll 的引用。单击确定。

3.  使用 Visual Basic Imports 语句或 C# using 语句导入 Microsoft.SqlServer.Dts.Runtime 命名空间。

4.  在主程序中添加以下代码。完成的控制台应用程序应类似于以下示例。

* * *

```
 string pkgLocation;
  Package pkg;
  Application app;
  DTSExecResult pkgResults;

  pkgLocation =
    @"C:\Program Files\Microsoft SQL Server\100\Samples\Integration Services" +
    @"\Package Samples\CalculatedColumns Sample\CalculatedColumns\CalculatedColumns.dtsx";
  app = new Application();
  pkg = app.LoadPackage(pkgLocation, null);
  pkgResults = pkg.Execute();

  Console.WriteLine(pkgResults.ToString()); 
```

来源：http: [//msdn.microsoft.com/en-us/library/ms136090.aspx](http://msdn.microsoft.com/en-us/library/ms136090.aspx)

# html - 关于鼠标悬停和使用的问题

> ID：512672
> 
> 赞同：1
> 
> 时间：2009-02-04T18:33:24.467
> 
> 标签：html, dynamic-css

我想创建一个带有子菜单的下拉菜单，但有一个问题，我的按钮出现在主菜单的文本下。我怎样才能提出来？查看源代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head> 
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<style type="text/css" media="screen"> 
/**************** menu coding *****************/
#menu {
width: 100%;

float: left;
}

#menu ul {
list-style: none;
margin: 0;
padding: 0;
width: 12em;
float: left;
}

#menu a, #menu h2 {
font: bold 11px/16px arial, helvetica, sans-serif;
display: block;
border-width: 1px;
border-style: none;
border-color: #ccc #888 #555 #bbb;
margin: 0;
padding: 2px 3px;
}

#menu h2 {
color: #fff;
text-transform: uppercase;
width: 18em;
}

#menu a {
color: #000;
background: url('MenuBackground.jpg');
border-width:1px; border-style:solid; zoom:1; overflow:hidden; background-image:url('MenuBackground.jpg'); background-color:transparent

}

#menu a:hover {
color: #a00;
border-width: 1px;
border-style: solid;
background: url('MenuBackground.jpg');

}

#menu li {position: relative; text-align:right;
} 
#menu li.sub {  
text-align:left; 
background-color: transparent;
background-image:url('MenuBackground.jpg');
overflow: hidden;
display: block
}

#menu ul ul {
position: absolute;
z-index: 500;
}

#menu ul ul ul {
position: absolute;
top: 0;
left: 100%;
width: 100%;
}

div#menu ul ul,
div#menu ul li:hover ul ul,
div#menu ul ul li:hover ul ul
{display: none;}

div#menu ul li:hover ul,
div#menu ul ul li:hover ul,
div#menu ul ul ul li:hover ul
{display: block;}

#menu2 {
width: 100%;

float: left;
}

#menu2 ul {
list-style: none;
margin: 0;
padding: 0;
width: 12em;
float: left;
}

#menu2 a, #menu2 h2 {
font: bold 11px/16px arial, helvetica, sans-serif;
display: block;
border-width: 1px;
border-style: none;
border-color: #ccc #888 #555 #bbb;
margin: 0;
padding: 2px 3px;

}

#menu2 h2 {
color: #fff;
text-transform: uppercase;
width: 18em;

}

#menu2 a {
color: #000;
background: #efefef;
text-decoration: none;
border-width: 1px;
border-style: solid;

}

#menu2 a:hover {
color: #a00;
background: #fff;
border-width: 1px;
border-style: solid;

}

#menu2 li {position: relative;}

#menu2 ul ul {
position: absolute;
z-index: 500;
}

#menu2 ul ul ul {
position: absolute;
top: 0;
left: 100%;
width: 100%;
}

div#menu2 ul ul,
div#menu2 ul li:hover ul ul,
div#menu2 ul ul li:hover ul ul
{display: none;}

div#menu2 ul li:hover ul,
div#menu2 ul ul li:hover ul,
div#menu2 ul ul ul li:hover ul
{display: block;}

#menu3 {
width: 100%;

float: left;
}

#menu3 ul {
list-style: none;
margin: 0;
padding: 0;
width: 12em;
float: left;
}

#menu3 a, #menu3 h2 {
font: bold 11px/16px arial, helvetica, sans-serif;
display: block;
border-width: 1px;
border-style: none;
border-color: #ccc #888 #555 #bbb;
margin: 0;
padding: 2px 3px;
}

#menu3 h2 {
color: #fff;
text-transform: uppercase;
width: 18em;
}

#menu3 a {
color: #000;
background: #efefef;
text-decoration: none;
border-width: 1px;
border-style: solid;
}

#menu3 a:hover {
color: #a00;
background: #fff;
border-width: 1px;
border-style: solid;

}

#menu3 li {position: relative;}

#menu3 ul ul {
position: absolute;
z-index: 500;
}

#menu3 ul ul ul {
position: absolute;
top: 0;
left: 100%;
width: 100%;
}

div#menu3 ul ul,
div#menu3 ul li:hover ul ul,
div#menu3 ul ul li:hover ul ul
{display: none;}

div#menu3 ul li:hover ul,
div#menu3 ul ul li:hover ul,
div#menu3 ul ul ul li:hover ul
{display: block;}

#menu4 {
width: 100%;

float: left;
}

#menu4 ul {
list-style: none;
margin: 0;
padding: 0;
width: 12em;
float: left;
}

#menu4 a, #menu4 h2 {
font: bold 11px/16px arial, helvetica, sans-serif;
display: block;
border-width: 1px;
border-style: none;
border-color: #ccc #888 #555 #bbb;
margin: 0;
padding: 2px 3px;
}

#menu4 h2 {
color: #fff;
text-transform: uppercase;
width: 18em;
}

#menu4 a {
color: #000;
background: #efefef;
text-decoration: none;
border-width: 1px;
border-style: solid;
}

#menu4 a:hover {
color: #a00;
background: #fff;
border-width: 1px;
border-style: solid;

}

#menu4 li {position: relative;}

#menu4 ul ul {
position: absolute;
z-index: 500;
}

#menu4 ul ul ul {
position: absolute;
top: 0;
left: 100%;
width: 100%;
}

div#menu4 ul ul,
div#menu4 ul li:hover ul ul,
div#menu4 ul ul li:hover ul ul
{display: none;}

div#menu4 ul li:hover ul,
div#menu4 ul ul li:hover ul,
div#menu4 ul ul ul li:hover ul
{display: block;}

#menu5 {
width: 100%;

float: left;
}

#menu5 ul {
list-style: none;
margin: 0;
padding: 0;
width: 12em;
float: left;
}

#menu5 a, #menu5 h2 {
font: bold 11px/16px arial, helvetica, sans-serif;
display: block;
border-width: 1px;
border-style: none;
border-color: #ccc #888 #555 #bbb;
margin: 0;
padding: 2px 3px;
}

#menu5 h2 {
color: #fff;
text-transform: uppercase;
width: 18em;
}

#menu5 a {
color: #000;
background: #efefef;
text-decoration: none;
border-width: 1px;
border-style: solid;
}

#menu5 a:hover {
color: #a00;
background: #fff;
border-width: 1px;
border-style: solid;

}

#menu5 li {position: relative;}

#menu5 ul ul {
position: absolute;
z-index: 500;
}

#menu5 ul ul ul {
position: absolute;
top: 0;
left: 100%;
width: 100%;
}

div#menu5 ul ul,
div#menu5 ul li:hover ul ul,
div#menu5 ul ul li:hover ul ul
{display: none;}

div#menu5 ul li:hover ul,
div#menu5 ul ul li:hover ul,
div#menu5 ul ul ul li:hover ul
{display: block;}

#menu6 {
width: 100%;

float: left;
}

#menu6 ul {
list-style: none;
margin: 0;
padding: 0;
width: 12em;
float: left;
}

#menu6 a, #menu6 h2 {
font: bold 11px/16px arial, helvetica, sans-serif;
display: block;
border-width: 1px;
border-style: none;
border-color: #ccc #888 #555 #bbb;
margin: 0;
padding: 2px 3px;
}

#menu6 h2 {
color: #fff;
text-transform: uppercase;
width: 18em;
}

#menu6 a {
color: #000;
background: #efefef;
text-decoration: none;
border-width: 1px;
border-style: solid;
}

#menu6 a:hover {
color: #a00;
background: #fff;
border-width: 1px;
border-style: solid;

}

#menu6 li {position: relative;}

#menu6 ul ul {
position: absolute;
z-index: 500;
}

#menu6 ul ul ul {
position: absolute;
top: 0;
left: 100%;
width: 100%;
}

div#menu6 ul ul,
div#menu6 ul li:hover ul ul,
div#menu6 ul ul li:hover ul ul
{display: none;}

div#menu6 ul li:hover ul,
div#menu6 ul ul li:hover ul,
div#menu6 ul ul ul li:hover ul
{display: block;}

div.clear {clear:both;}

</style>
<!--[if IE]>
<style type="text/css" media="screen">
 #menu ul li {float: left; width: 100%;}
 #menu2 ul li {float: left; width: 100%;}
 #menu3 ul li {float: left; width: 100%;}
      #menu4 ul li {float: left; width: 100%;}
        #menu5 ul li {float: left; width: 100%;}
          #menu6 ul li {float: left; width: 100%;}
</style>
<![endif]-->
<!--[if lt IE 7]>
<style type="text/css" media="screen">
body {
behavior: url(csshover.htc);
font-size: 100%;
}

#menu ul li a {height: 1%;} 
#menu2 ul li a {height: 1%;}
#menu3 ul li a {height: 1%;} 
#menu4 ul li a {height: 1%;} 
#menu5 ul li a {height: 1%;} 
#menu6 ul li a {height: 1%;} 

#menu a, #menu h2 {
font: bold 0.7em/1.4em arial, helvetica, sans-serif;
}
#menu2 a, #menu2 h2 {
font: bold 0.7em/1.4em arial, helvetica, sans-serif;
}

</style>
<![endif]-->
</head>

<div align="center">
    <table border="0" width="777" id="table1" cellspacing="0" cellpadding="0" height="436" bgcolor="#888888">
        <tr>
            <td valign="top">
            <table border="0" width="777" id="table3" cellspacing="0" cellpadding="0" height="9">
                <tr>
                    <td>
                    <img border="0" src="spacer.gif" width="1" height="1"></td>
                </tr>
            </table>
            <table border="0" width="777" id="table4" cellspacing="0" cellpadding="0" height="240">
                <tr>
                    <td>
            <table border="0" width="777" id="table49" cellspacing="0" cellpadding="0" height="240">
                <tr>
                    <td valign="top" width="144" height="240">
                    <p align="center">
                    &nbsp;</td>
                    <td valign="top" width="489" height="240">
                    <table border="0" width="489" id="table50" cellspacing="0" cellpadding="0" height="240">
                        <tr>
                            <td>&nbsp;</td>
                        </tr>
                    </table>
                    </td>
                    <td valign="top" width="144" height="240">
                    &nbsp;</td>
                </tr>
            </table>
                    </td>
                </tr>
            </table>
            <table border="0" width="777" id="table5" cellspacing="0" cellpadding="0">
                <tr>
                    <td>&nbsp;</td>
                </tr>
            </table>
            <table border="0" width="100%" id="table35" cellspacing="0" cellpadding="0">
                <tr>
                    <td width="245" height="32">
                    <table border="0" width="245" id="table36" cellspacing="0" cellpadding="0">
                        <tr>
                            <td width="200" ><div id="menu" style="width: 192px; height: 19px" align=right>
<ul>
  <li><h2>Page 1</h2>
    <ul style="position: absolute; left: 188px; top: 18px; height: 0px; width:130px; background-image:url('MenuBackground.jpg');">
      <li class="sub"><a href="http://www.seoconsultants.com/css/menus/vertical/"  align=left>Submenu1 Page1</a></li>
      <li class="sub"><a href="http://www.tanfa.co.uk/css/examples/menu/vs7.asp" >Submenu2 Page1</a>
      </li>
    </ul>
  </li>
</ul>
</div><div class="clear"><!-- --></div>

</td>
                            <td width="45">&nbsp;</td>
                        </tr>
                    </table>
                    </td>
                    <td width="300" rowspan="3" valign="top">
                    <table border="0" width="100%" id="table42" cellspacing="0" cellpadding="0" height="100%">
                        <tr>
                            <td valign="top">
                            <table border="0" width="100%" id="table43" cellspacing="0" cellpadding="0" height="74">
                                <tr>
                                    <td width="10">&nbsp;</td>
                                    <td width="280">
                                    <p align="center">
                                    &nbsp;</td>
                                    <td width="10">&nbsp;</td>
                                </tr>
                            </table>
                            </td>
                        </tr>
                    </table>
                    </td>
                    <td width="232">
                    <table border="0" width="232" id="table37" cellspacing="0" cellpadding="0">
                        <tr>
                            <td width="45">&nbsp;</td>
                            <td width="187" align=left><div id="menu2" style="width: 192px; height: 19px; top: 50px;">
<ul>
  <li><h2>Page 4</h2>
    <ul style="position: absolute; left: 30px; top: 18px; height: 0px; width:130px">
      <li><a href="http://www.seoconsultants.com/css/menus/vertical/" title="SEO Consultants Vertical Example">Submenu1 Page4</a></li>
      <li><a href="http://www.tanfa.co.uk/css/examples/menu/vs7.asp" title="Complete Example">Submenu2 Page4</a>
      </li>
    </ul>
  </li>
</ul>
</div></div><div class="clear"><!-- --></div>
</td>
                        </tr>
                    </table>
                    </td>
                </tr>
                <tr>
                    <td width="245" height="32">
                    <table border="0" width="245" id="table38" cellspacing="0" cellpadding="0">
                        <tr>
                            <td width="200" align="right"><div id="menu2" style="width: 192px; height: 19px; top: 50px;">
<ul>
  <li><h2>Page 2</h2>
    <ul style="position: absolute; left: 188px; top: 18px; height: 0px; width:130px">
      <li><a href="http://www.seoconsultants.com/css/menus/vertical/" title="SEO Consultants Vertical Example">Submenu1 Page2</a></li>
      <li><a href="http://www.tanfa.co.uk/css/examples/menu/vs7.asp" title="Complete Example">Submenu2 Page2</a>
      </li>
    </ul>
  </li>
</ul>
</div></div><div class="clear"><!-- --></div>
</td>
                            <td width="45">&nbsp;</td>
                        </tr>
                    </table>
                    </td>
                    <td width="232">
                    <table border="0" width="232" id="table39" cellspacing="0" cellpadding="0">
                        <tr>
                            <td width="45">&nbsp;</td>
                            <td width="187" align=left><div id="menu2" style="width: 192px; height: 19px; top: 50px;">
<ul>
  <li><h2>Page 5</h2>
    <ul style="position: absolute; left: 30px; top: 18px; height: 0px; width:130px">
      <li><a href="http://www.seoconsultants.com/css/menus/vertical/" title="SEO Consultants Vertical Example">Submenu1 Page5</a></li>
      <li><a href="http://www.tanfa.co.uk/css/examples/menu/vs7.asp" title="Complete Example">Submenu2 Page5</a>
      </li>
    </ul>
  </li>
</ul>
</div></div><div class="clear"><!-- --></div>
</td>
                        </tr>
                    </table>
                    </td>
                </tr>
                <tr>
                    <td width="245" height="32">
                    <table border="0" width="245" id="table40" cellspacing="0" cellpadding="0">
                        <tr>
                            <td width="200" align="right"><div id="menu2" style="width: 192px; height: 19px; top: 50px;">
<ul>
  <li><h2>Page 3</h2>
    <ul style="position: absolute; left: 188px; top: 18px; height: 0px; width:130px">
      <li><a href="http://www.seoconsultants.com/css/menus/vertical/" title="SEO Consultants Vertical Example">Submenu1 Page3</a></li>
      <li><a href="http://www.tanfa.co.uk/css/examples/menu/vs7.asp" title="Complete Example">Submenu2 Page3</a>
      </li>
    </ul>
  </li>
</ul>
</div></div><div class="clear"><!-- --></div>
</td>
                            <td width="45">&nbsp;</td>
                        </tr>
                    </table>
                    </td>
                    <td width="232">
                    <table border="0" width="232" id="table41" cellspacing="0" cellpadding="0">
                        <tr>
                            <td width="45">&nbsp;</td>
                            <td width="187" align=left>
                            <div id="menu2" style="width: 192px; height: 19px; top: 50px;">
<ul>
  <li><h2>Page 6</h2>
    <ul style="position: absolute; left: 30px; top: 18px; height: 0px; width:130px">
      <li><a href="http://www.seoconsultants.com/css/menus/vertical/" title="SEO Consultants Vertical Example">Submenu1 Page6</a></li>
      <li><a href="http://www.tanfa.co.uk/css/examples/menu/vs7.asp" title="Complete Example">Submenu2 Page6</a>
      </li>
    </ul>
  </li>
</ul>
</div></div><div class="clear"><!-- --></div>
</td>
                        </tr>
                    </table>
                    </td>
                </tr>
            </table>
            <table border="0" width="777" id="table44" cellspacing="0" cellpadding="0" height="50">
                <tr>
                    <td valign="top" width="20">&nbsp;</td>
                    <td valign="top" width="368">
                    <table border="0" width="100%" id="table46" cellspacing="0" cellpadding="0">
                        <tr>
                            <td><b><font face="Tahoma" size="4" color="#FFFFFF">
                            sflkd lksdjf jdsjeritu ieritu </font></b></td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                        </tr>
                    </table>
                    </td>
                    <td width="388" valign="top">
                    <table border="0" width="388" id="table47" cellspacing="4" cellpadding="0">
                        <tr>
                            <td align="left">
<style type="text/css">
<!--
#ContactElement {
  width: 30em;
  height: 4em;
  padding: 0em;
  border: 0px solid #cc0000;
  color: #FFFFFF;
}
-->
</style>
<p>
<div style="overflow: hidden; font-family:tahoma; font-face:tahoma; font-size:0.8em" id="ContactElement">
&nbsp;</div>
</p>

                        </tr>
                    </table>
                    </td>
                </tr>
            </table>
            </td>
        </tr>
    </table>
</div>

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T18:57:53.557

您的问题是 IE 无法识别 sudoclass :hover 除了锚标记之外的任何内容。使“suckerfish 下拉菜单”在 IE 中工作的解决方案是添加一个小 javascript，在其悬停事件中向 LI 元素添加一个新类。[http://www.alistapart.com/articles/dropdowns](http://www.alistapart.com/articles/dropdowns)上的页面详细说明了您需要的一切。

另一种选择是在页眉中添加以下内容：

```
<!--[if lt IE 8]>
   <script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js" type="text/javascript"></script>
<![endif]--> 
```

这个 js 库应该修复很多在 IE 中发现的错误。[您可以在http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)找到有关它的更多信息。

另一个提示，为简洁起见，如果您为每个 div 元素提供相同的类，您可以在您的 css (div.class) 中一次引用所有元素，而不是像上面那样单独引用它们。我注意到您的 CSS 中有很多重复项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:36:57.750

将来，将您的代码限制为仅直接相关的部分。您的按钮和冲突元素就足够了。

话虽如此，您应该在元素上使用 z-index 来确定哪个比另一个“更高”。在您更具体地展示您要解决的问题之前，这将尽我所能提供帮助。

# .net - 抽象枚举选择框

> ID：512678
> 
> 赞同：0
> 
> 时间：2009-02-04T18:34:45.587
> 
> 标签：.net, vb.net, enums, abstraction

我正在尝试制作一个可以采用枚举类型的函数，向用户显示所有可能的选择，让他们选择一个然后将其传回。泛型不允许您限制枚举。我的代码可以来回转换，但我希望它接受并返回相同的枚举类型。

这段代码有效，但不如我想的那么好：

Public Function getEnumSelection(ByVal owner As Windows.Forms.IWin32Window, ByVal sampleValue As [Enum], ByVal subtitle As String) As String

```
 Dim names As String() = [Enum].GetNames(sampleValue.GetType)
    Using mInput As New dlgList
        mInput.ListBox1.Items.Clear()
        For Each name As String In names
            mInput.ListBox1.Items.Add(name)
        Next
        mInput.ShowDialog(owner)
        Return mInput.ListBox1.SelectedItem.ToString
    End Using
End Function 
```

在它运行之后，我可以 [Enum].parse 在调用者上直接解析到枚举类型，因为我可以在那里访问它，但我想消除这个手动步骤。

我希望能够返回相同的枚举类型，或者至少将解析返回到我收到的值并将其转换为该函数，但它似乎不允许这一行。暗淡结果 As Object = [Enum].Parse(GetType(sampleValue), mInput.ListBox1.SelectedItem.ToString, True)

它说 sampleValue 不是一种类型。那么...如何获取要解析的 sampleValue 类型？

或者是否有另一种方法可以轻松且通用地允许用户选择枚举值，而无需为每个枚举手动编码映射函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T20:57:30.027

要首先回答最小的问题，您可以通过调用 sampleValue.GetType() 来获取对象的类型，就像您已经在函数的第一行中所做的那样。GetType 既是关键字又是 Object 类的方法 - 第一个获取类型的类型（有点重言式），第二个获取对象实例的类型。

至于更大的问题，我建议使用对参数的约束稍微宽松的泛型方法：让它接受任何结构，而不仅仅是枚举。你失去了一点类型安全，但我认为这是一个不错的权衡。如果有人传入一个非枚举结构，他们会在运行时得到一个 ArgumentException，所以你不会从函数中得到垃圾。

```
Public Function getEnumSelection(Of T As Structure)(ByVal owner As Windows.Forms.IWin32Window, ByVal subtitle As String) As T
    Dim names As String() = [Enum].GetNames(GetType(T))
    Using mInput As New dlgList
        mInput.ListBox1.Items.Clear()
        For Each name As String In names
            mInput.ListBox1.Items.Add(name)
        Next
        mInput.ShowDialog(owner)
        Return DirectCast([Enum].Parse(GetType(T), mInput.ListBox1.SelectedItem.ToString), T)
    End Using
End Function 
```

# com - Lua COM 编程

> ID：512679
> 
> 赞同：1
> 
> 时间：2009-02-04T18:35:52.777
> 
> 标签：com, scripting, lua, photoshop, luacom

任何人都知道通过 Lua 显示 COM 编程的任何示例吗？可能需要一个库。

我需要为 Photoshop 编写一些外部脚本，所以想知道 Lua 是否有可能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T18:47:28.650

看看[Lua for Windows](http://luaforwindows.luaforge.net/)。它包含 LuaCOM。不过我自己没试过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T12:19:51.330

正如 gimpf 所说，看看 LuaCOM。您可以[从其官方网站](http://luacom.luaforge.net/luacom-1.4.zip)获取它，这是最新版本（1.4）。将其解压缩到某个地方并查看文件夹“Demo”，其中包括以下示例：

*   ADO
*   微软幻灯片软件
*   SAPI（语音 API）
*   WMI

它们更像是测试用例而不是示例，但您可以理解。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-08T14:22:14.863

您可以使用 CInvoke 和一些自定义 C/C++ 代码结合 Lua 元表来推出自己的系统。

[http://www.nongnu.org/cinvoke/](http://www.nongnu.org/cinvoke/)

根据经验，虽然我不能推荐这个，但它非常复杂，需要付出很多努力才能做到正确并使其防弹。

# .net - 程序化 MSIL 注入

> ID：512690
> 
> 赞同：7
> 
> 时间：2009-02-04T18:38:23.520
> 
> 标签：.net, cil

假设我有一个这样的错误应用程序：

```
using System;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("2 + 1 = {0}", Add(2, 1));
        }

        static int Add(int x, int y)
        {
            return x + x; // <-- oops!
        }
    }
} 
```

该应用程序已经编译并部署到野外。有人发现了这个错误，现在他们正在请求修复它。虽然我可以使用修复程序重新部署此应用程序，但由于我无法控制的原因，这非常麻烦——我只想为该错误编写一个补丁程序。

具体来说，我想将我自己的 MSIL 插入到有问题的汇编源文件中。我以前从来没有做过这样的事情，谷歌搜索也没有找到任何有用的信息。如果我可以在上面的代码中看到如何执行此操作的示例，它将极大地帮助我:)

**如何以编程方式将自己的 MSIL 注入已编译的 .NET 程序集？**

[编辑添加：] 对于那些问的人：我不需要运行时热交换。关闭应用程序，操作程序集，然后再次重新启动程序对我来说非常好。

[再编辑一次：] 看起来普遍的共识是“操纵程序集是修补程序的**坏**方法”。[如果这是一个坏主意](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx)，我不会走那条路。

我会留下这个问题，因为 MSIL 注入可能仍然对其他目的有用:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T18:43:44.007

我想我会问的问题是“你将如何部署补丁”？在某个地方，您必须部署一些东西来修复已经存在的错误。为什么重新编译 dll 并发布固定版本真的是个问题？我的猜测是，弄清楚如何以编程方式注入 MSIL 将比简单地重新部署固定程序集更麻烦。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T18:40:39.803

您是否考虑过将源代码直接插入到程序集中，而不是在运行时注入 MSIL？

您可以使用 ildasm 进行拆卸，插入您的 MSIL，然后使用 ilasm 重新组装，然后部署其产品。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T18:50:20.000

如果你不想重新部署整个东西的原因是因为它真的是半场演出，你可能应该使用某种二进制补丁工具——这是谷歌的第一个结果：

[二进制差异 http://www.daemonology.net/bsdiff/](http://www.daemonology.net/bsdiff/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-09T22:39:46.867

很好的信息来源...

[IL 编程电子书](http://www.vijaymukhi.com/documents/books/ilbook/contents.htm)

另一个是关于 IL 编程的 MS Press 书籍。

反编译为 IL 并重新编译的步骤

1\. ildasm /output=ConsoleApplication1.il ConsoleApplication1.exe

2\. //修改ConsoleApplication1.il代码

3\. ilasm ConsoleApplication1.il

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T18:56:38.897

如果您的 exe 已签名，那么这是不可能的。为什么不能只发布单个程序集，而不是再次发布整个应用程序？看起来您的目标是为一个简单的问题提供一个复杂的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T19:14:48.000

您可以使用静态 MSIL 注入。Mono Cecil 或 PostSharp 可能会有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-13T03:21:52.927

您将需要非托管代码才能成功执行此操作，但可以完成...

请参阅[http://www.codeproject.com/Articles/463508/NET-CLR-Injection-Modify-IL-Code-during-Run-time](http://www.codeproject.com/Articles/463508/NET-CLR-Injection-Modify-IL-Code-during-Run-time)

# java - 列表> 到 org.json.JSONObject？

> ID：512692
> 
> 赞同：16
> 
> 时间：2009-02-04T18:38:44.533
> 
> 标签：java, json, javabeans, map

```
List<Map<String, Object>> list = new ArrayList<Map<String, Object>>();
Map<String, Object> map = new HashMap<String, Object>();

map.put("abc", "123456");
map.put("def", "hmm");
list.add(map);
JSONObject json = new JSONObject(list);
try {
    System.err.println(json.toString(2));
} catch (JSONException e) {
    e.printStackTrace();
} 
```

这段代码有什么问题？

输出是：

```
{"empty": false} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-03T07:19:55.550

```
public String listmap_to_json_string(List<Map<String, Object>> list)
{       
    JSONArray json_arr=new JSONArray();
    for (Map<String, Object> map : list) {
        JSONObject json_obj=new JSONObject();
        for (Map.Entry<String, Object> entry : map.entrySet()) {
            String key = entry.getKey();
            Object value = entry.getValue();
            try {
                json_obj.put(key,value);
            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }                           
        }
        json_arr.put(json_obj);
    }
    return json_arr.toString();
} 
```

好吧，试试这个~这对我有用：D

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-14T04:35:58.647

```
List<Map<String, Object>> list = new ArrayList<Map<String, Object>>();
Map<String, Object> map = new HashMap<String, Object>();

map.put("abc", "123456");
map.put("def", "hmm");
list.add(map);
// it's wrong JSONObject json = new JSONObject(list);
// if u use list to add data u must be use JSONArray

JSONArray json = JSONArray.fromObject(list);
try {
    System.err.println(json.toString(2));
} catch (JSONException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T19:07:55.800

您需要以 JSONObjects（地图）的 JSONArray（对应于列表）结束。

尝试将 json 变量声明为 JSONArray 而不是 JSONObject（我相信 JSONArray 构造函数会做正确的事情）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T20:58:01.997

另外：您可以考虑使用 json.org 列表中的其他解析器之一：它们中的大多数允许您的 Json“对象”和“数组”本地映射到 java.util.Maps 和 java.util.Lists；或者在某些情况下也可以是真正的 Java 对象。

我的建议是 Jackson，[http://jackson.codehaus.org/Tutorial](http://jackson.codehaus.org/Tutorial) ，它允许映射到 List/Map/Integer/String/Boolean/null 以及真正的 Beans/POJO。只需给它类型，它就会将数据映射给您，或者将 Java 对象写入 Json。其他类似 berlios 的“json-tools”或 google-gson 也提供了类似的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-15T20:20:13.397

这对我有用：

```
List<JSONObject> jsonCategories = new ArrayList<JSONObject>();

JSONObject jsonCategory = null;

for (ICategory category : categories) {
    jsonCategory = new JSONObject();
    jsonCategory.put("categoryID", category.getCategoryID());
    jsonCategory.put("desc", category.getDesc());
    jsonCategories.add(jsonCategory);
}
try {
    PrintWriter out = response.getWriter();
    response.setContentType("text/xml");
    response.setHeader("Cache-Control", "no-cache");
    _log.info(jsonCategories.toString());
    out.write(jsonCategories.toString());

} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T18:46:12.287

您有一个嵌套在列表中的地图。您正在尝试调用 Map 而不先遍历列表。JSON 有时感觉像魔术，但实际上并非如此。稍后我会发布一些代码。
制作地图而不是地图列表会更符合 JSON。

```
JSONObject json = new JSONObject(list);
Iterator<?> it = json.keys();
while (keyed.hasNext()) {
    String x = (String) it.next();
    JSONObject jo2 = new JSONObject(jo.optString(x));
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-23T18:45:11.023

如果您使用的是**org.json.simple.JSONArray**

（[https://mvnrepository.com/artifact/com.googlecode.json-simple/json-simple/1.1.1](https://mvnrepository.com/artifact/com.googlecode.json-simple/json-simple/1.1.1)）

```
List<Map<String, Object>> list = new ArrayList<Map<String, Object>>();
Map<String, Object> map = new HashMap<String, Object>();
map.put("abc", "123456");
map.put("def", "hmm");
list.add(map);

JSONArray jsonArray = new JSONArray();
jsonArray.addAll(listOfMaps); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-06T15:20:50.893

您可以同时使用这两种方法：

`JSONArray`直接作为，

```
String toJson(Collection<Map<String, Object>> list)
{       
    return new JSONArray(list).toString();
} 
```

或者通过使用 Java8 迭代列表（如 @ShadowJohn 解决方案）：

```
String toJson(Collection<Map<String, Object>> list)
{       
    return new JSONArray( 
            list.stream()
                .map((map) -> new JSONObject(map))
            .collect(Collectors.toList()))
        .toString();
} 
```

# html - 如何防止单选按钮与其标签之间的换行符，同时仍然允许标签本身内的换行符？

> ID：512695
> 
> 赞同：23
> 
> 时间：2009-02-04T18:39:56.217
> 
> 标签：html, css

我想确保单选按钮与其相邻标签的开头之间没有换行符。但是，我希望允许标签*内*的文本换行。这可能吗？您可以通过呈现以下 HTML 来查看我的失败尝试：

```
<html>
 <head>
   <style type="text/css">
.box {
  border: solid gray 2px;
  width: 200px;
  margin: 5px;
}
.chopped {
  overflow: hidden;
}
   </style>
 </head>
<body> 
```

盒子需要固定宽度，因此需要包装长内容，如下面的第一个盒子所示。如果有人试图发布一个没有任何空格的长得离谱的字符串，我们需要将其截断，而不是超出框的边缘——问题在第二个框中可见：

```
 <div class="box">
  <input type="radio"/>
  <label>This is a really long string with no spaces</label>
 </div>

 <div class="box">
  <input type="radio"/>
  <label>This_is_a_really_long_string_with_no_spaces</label>
 </div>

 <hr/> 
```

所以我添加了“溢出：隐藏”，情况有所好转，但我仍然不喜欢第二个框在单选按钮和它的标签之间有一个换行符：

```
 <div class="chopped box">
  <input type="radio"/>
  <label>This is a really long string with no spaces</label>
 </div>

 <div class="chopped box">
  <input type="radio"/>
  <label>This_is_a_really_long_string_with_no_spaces</label>
 </div>

 <hr/> 
```

如果我添加 <nobr>，则单选按钮位于它们的标签旁边，因此无空格的字符串现在看起来很完美。但是，这会破坏第一个字符串（带有空格的字符串），因为它不再换行：

```
 <div class="chopped box">
  <nobr>
    <input type="radio"/>
    <label>This is a really long string with no spaces</label>
  </nobr>
 </div>
 <div class="chopped box">
  <nobr>
    <input type="radio"/>
    <label>This_is_a_really_long_string_with_no_spaces</label>
  </nobr>
 </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-04T18:55:14.983

首先，移动标签内的单选按钮。这增加了一个很好的功能，您可以通过单击文本来选择单选按钮。然后在文本周围添加一个跨度。

```
<div class="chopped box">
 <label>
  <input type="radio"/>
  <span class="wrappable">This is a really long string with no spaces</span>
 </label>
</div>

<div class="chopped box">
 <label>
  <input type="radio"/>
  <span class="wrappable">This_is_a_really_long_string_with_no_spaces</span>
 </label>
</div> 
```

其次，将以下样式添加到您的 css 中：

```
label {
    white-space:nowrap;
}

.wrappable {
    white-space:normal;
} 
```

标签上的空白样式可防止单选按钮和文本之间的换行，而文本周围的跨度允许它仅在文本内换行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T18:54:01.820

你试过空白：nowrap；在您的 .chopped 定义中？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T19:11:56.510

如果您不介意不那么整洁的标记，您可以通过简单地消除`<input>`和`<label>`文本之间的空白来获得所需的内容。

```
<div class="chopped box">
    <label><input type="radio"/>This is a really long string with no spaces</label>
</div>

<div class="chopped box">
    <label><input type="radio"/>This_is_a_really_long_string_with_no_spaces</label>
</div> 
```

（根据 JacobM 的建议`<label>`放置在s 周围。）`<input>`

如果您想`<input>`在标签的第一个字符和第一个字符之间留一点空间，请使用不间断空格 ( `&nbsp;`) 实体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T20:54:30.480

JacobM 提供的解决方案对于这种特殊情况当然是最好的解决方案。但是这个问题不仅仅是一些带有标签的单选按钮。我的一般解决方案：

```
In line text blabla <span style="white-space: normal;"><element /></span> blabla 
```

因此，作为这种特定情况的解决方案，结果将是：

```
<label>
    <span style="white-space: normal;">
        <input type="radio" />
    </span>
    This_is_a_really_long_string_with_no_spaces
</label> 
```

PS：我的情况是`<input />`包装文本中的内联元素。问题是它会在元素之后换行而不是行尾的文本。使用搜索引擎搜索这个问题真的很难，我希望这可以帮助其他人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-25T10:12:15.453

有时您无法移动标签，因为生成的输出超出了您的控制范围。因此，如果您无法将复选框/单选按钮移动到您可能想要使用的标签中：

```
.box {
    white-space: nowrap;
}
.box label {
    white-space: normal;
} 
```

# inno-setup - 你如何将参数传递给 Inno Setup 命令行编译器？

> ID：512706
> 
> 赞同：16
> 
> 时间：2009-02-04T18:42:30.343
> 
> 标签：inno-setup

在 IS 新闻组中建议使用 /D=，但使用 5.2.3 版附带的 iscc.exe 我收到“未知选项：”错误。

那么在脚本中，如何使用命令行参数的值呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-04T22:21:16.097

正如 MicSim 所说，你确实需要预处理器。它包含在最新的 ISPack 中。安装后，iscc 支持 /D。

然后，您可以使用这样定义的值（假设您已完成 /DVERSION_NAME=1.23）：

```
AppVerName=MyApplication v{#VERSION_NAME} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T22:20:54.507

从 Inno Setup 帮助文件：

> Inno Setup Preprocessor 用扩展版本替换了标准的 Inno Setup Command Line Compiler (ISCC.exe)。这个扩展版本提供了额外的参数来控制 Inno Setup Preprocessor。

“额外参数”包括 /d 选项。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-03-03T15:12:13.237

如果要从 inno 中的代码中解析命令行参数，请使用与此类似的方法。只需从命令行调用 inno 脚本，如下所示：

```
C:\MyInstallDirectory>MyInnoSetup.exe -myParam parameterValue 
```

然后，您可以在需要的任何地方调用 GetCommandLineParam：

```
myVariable := GetCommandLineParam('-myParam'); 
```

//================================================= ===================

```
{ Allows for standard command line parsing assuming a key/value organization }
function GetCommandlineParam (inParam: String):String;
var
  LoopVar : Integer;
  BreakLoop : Boolean;
begin
  { Init the variable to known values }
  LoopVar :=0;
  Result := '';
  BreakLoop := False;

  { Loop through the passed in arry to find the parameter }
  while ( (LoopVar < ParamCount) and
          (not BreakLoop) ) do
  begin
    { Determine if the looked for parameter is the next value }
    if ( (ParamStr(LoopVar) = inParam) and
         ( (LoopVar+1) < ParamCount )) then
    begin
      { Set the return result equal to the next command line parameter }
      Result := ParamStr(LoopVar+1);

      { Break the loop }
      BreakLoop := True;
    end

    { Increment the loop variable }
    LoopVar := LoopVar + 1;
  end;
end; 
```

希望这可以帮助...

# visual-studio-2008 - Visual Studio 2008 链接器错误：ALINK 操作失败 (80070005)：访问被拒绝

> ID：512709
> 
> 赞同：0
> 
> 时间：2009-02-04T18:43:06.973
> 
> 标签：visual-studio-2008, c++-cli, access-denied

我的计算机和构建机器上安装了 Visual Studio 2008 (9.0.30729.1 SP)。在我的电脑上，一个项目构建良好。在构建机器上，我已经开始收到此错误。ALINK 操作失败 (80070005)：访问被拒绝

这非常令人恼火，因为它没有说访问什么？？？被拒绝。

我尝试重新启动机器，并更改项目的输出目录。这是一个 C++/CLI DLL。该项目与大量库链接，因此广泛检查它链接的所有内容并不实际，但快速扫描该项目，似乎没有任何东西丢失或锁定。

无论如何，我可以弄清楚链接器在抱怨什么？听起来像是链接器（1）中的错误，但正如我所说，我的 PC 中安装了相同的 Visual Studio，并且项目构建良好。

(1) 您可能会争辩说无用的错误消息*是*错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T18:46:38.933

[将FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)作为工具包中的工具总是好的：它可以记录每个文件操作，并有助于显示链接器*究竟*想对什么文件执行什么操作。

（在 sysinternals.com 上找到它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:47:59.990

在输出窗口中，你能看到它在执行什么操作时失败的地方吗？

通常你可能会得到一个错误，因为它试图修改的文件在源代码控制下/由于某些原因不可写。

此外，您可能只是缺少一些它正在寻找的文件。

# css - CSS：可滚动嵌套表，在 FF 中工作，在 IE 中失败

> ID：512713
> 
> 赞同：4
> 
> 时间：2009-02-04T18:43:55.130
> 
> 标签：css, internet-explorer, firefox

我真的很喜欢这个在 IE 中工作。我无法改变此处不应使用表格的事实。IE 是我正在开发的项目唯一需要支持的浏览器。

这是代码：

```
<html>
<body>

<style type="text/css">
#test table {
   border-collapse: collapse;
   table-layout: fixed;
   width: 95%;
}

#test table td {
   border: 1px solid rgb(0,0,0);
}

#test table div.scrollable {
   max-width: 100%;
   overflow: auto;
}

#test table table {
   table-layout: auto;
   width: 100%;
}
</style>

<div id="test">
<table>
<tr>
<td colspan="2">

<div class="scrollable">

<table>
<tr>
<td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td>
<td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td>
<td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td>
<td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</    td>
</tr>

</table>

</div>

</td>
</tr>
<tr><td>1</td><td>2</td></tr>
<tr><td>1</td><td>2</td></tr>
</table>
</div>
</body>
</html> 
```

我一直在使用 Tryit Editor 来玩这个。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T18:55:39.367

我不确定您要完成什么，但请在您的 CSS 中尝试：

```
#test table {
   border-collapse: collapse;
   table-layout: fixed;
   width: 50%;
}

#test table td {
   border: 1px solid rgb(0,0,0);
}

#test table div.scrollable {
   max-width: 100%;
   overflow: auto;
}

#test table table {
   table-layout: auto;
   width: 100%;
}

.scrollable {
    height:40px;
    width:100%;
    overflow-x:scroll;
    overflow-y:none;

} 
```

# c# - 有 C# 的 CSS 解析器吗？

> ID：512720
> 
> 赞同：65
> 
> 时间：2009-02-04T18:45:23.490
> 
> 标签：c#, css, parsing

我的程序需要将 css 文件解析为内存对象格式。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-04T18:53:03.660

GitHub 上的 ExCSS（支持 CSS2.1 和 CSS3）：[https](https://github.com/TylerBrinks/ExCSS) ://github.com/TylerBrinks/ExCSS 。

这是代码项目文章的较新版本：http: [//www.codeproject.com/KB/recipes/CSSParser.aspx](http://www.codeproject.com/KB/recipes/CSSParser.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T18:58:32.543

稍微慢一点的搜索会出现博客文章“ [.NET 中的 CSS 解析器类”，它](http://blog.dynamicprogrammer.com/2008/01/20/CSSParserClassInNET.aspx)[在 GitHub 上](https://gist.github.com/561823)嵌入了这个要点（以防博客死了）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-08T20:35:54.130

GoldParser有一个CSS语法文件：

[http://goldparser.org/grammars/files/css.zip](http://goldparser.org/grammars/files/css.zip)

GoldParser 很容易包含在 C# 项目中，并生成一个真正的 LALR 解析器 - 而不是一些 regex hack。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-09-01T18:27:58.327

您是否尝试过[JsonFx 中的功能](http://code.google.com/p/jsonfx/source/browse#svn/trunk/JsonFx/JsonFx.BuildTools/CssCompactor)？它是用 C# 编写的，解析 CSS3 语法，并在 MIT 样式许可下分发。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-06T02:35:19.427

我写了一个，使用 CSS 2.1 规范中指定的语法。我现在也发布了：详情见[http://www.modeltext.com/css/](http://www.modeltext.com/css/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T19:11:51.673

[在这里](http://itecharch.blogspot.com/2008/09/css-parser.html)，您可以找到另一个特别适用于 C# 的示例源代码。

# c# - 有趣的 API 设计/模式

> ID：512730
> 
> 赞同：0
> 
> 时间：2009-02-04T18:47:25.000
> 
> 标签：c#, vb.net, design-patterns, orm, api-design

我正在重新设计我们内部 ORM 工具的一部分，并且我想将 Field（代表数据库中的字段的类，如 CustomerFirstName）直接公开给最终开发人员。

所以这很容易实现，但是 API 变得有点难看，因为这个 Field 类以前在内部使用并且过于开放。例如，这只是一个小例子：IsDirty 属性不是只读的，这是最终开发人员不应该篡改的东西。

我考虑过可能创建两个接口，IPublicField 和 IPrivateField，并尝试让字段类来实现它们。但是，继续 IsDirty 示例，我不想要这样的东西：

```
Public ReadOnly Property PrivateIsDirty Implements IPrivateField.IsDirty
 ...
End  Property

Public Property IsDirty Implements IPublicField.IsDirty
 ...
End  Property 
```

...它只是有点难看，而且您仍然可以转换回 Field 类并进入非只读方法。我也不想引入单独的 setter 方法，因为这将是另一个我不想考虑的重大更改，并且还会与 API 的其他部分产生不一致。

我最终将 Field 类重命名为 InnerField，并围绕它创建了一个外观/包装器样式结构，如下所示：

```
Public Class Field
    Implements BusinessObjects.IField

    Private InnerField As BusinessObjects.IInnerField

    Public Sub New(ByVal field As IInnerField)
        InnerField = field
    End Sub

    ...

     Public ReadOnly Property IsDirty() As Boolean Implements BusinessObjects.IField.IsDirty
        Get
            Return InnerField.IsDirty
        End Get
    End Property

    ...
End Class 
```

这似乎工作得很好。在内部，InnerField 是适当开放的，我们可以在不影响最终开发人员的情况下自由地在未来使其更加开放，而在外部，Field 类提供了最终开发人员所需的简化、锁定工具。

因此，假设这是连贯的，我想知道您在这种情况下可能会如何进行，以及我的解决方案从外面看起来是否合理。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T22:20:49.997

在 VB.NET 的上下文中，您可以提供 IsDirty 属性范围的设置器。如果您希望程序集中的其他类可以“设置”此属性，只需将其设置为 Friend：

```
Public Property IsDirty() As Boolean
    Get
        Return _isDirty
    End Get
    Friend Set(ByVal trueFalse As Boolean)
        _isDirty = trueFalse
    End Set
End  Property 
```

现在，任何外部程序集都可以检查 IsDirty 属性，但只有同一程序集中的类可以设置它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:57:15.280

在 isDirty 属性的特定情况下，您可以只限制设置器的范围：

```
public bool IsDirty
     {
        get
        {
            // logic here that the end-devs can use safely.
        }
        private set
        {
            // logic here that is only exposed to other members of your private
            // ORM assembly.
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:13:57.363

您可以*尝试*使用 CAS 来发挥自己的优势。这是一个例子：

```
 public bool IsDirty
    {
        get;
        [StrongNameIdentityPermissionAttribute(SecurityAction.LinkDemand, Name = "<assembly name>")]
        set;
    } 
```

该属性在 System.Security 中。

如果您担心您的开发人员可能会通过反射调用它，您可能希望将 LinkDemand 更改为 Demand：但您也可以“替换”这些开发人员而不是 SecurityAction :)。

唯一的问题是现在您可以在运行时进行检查。这可能不是您想要的，但如果没有重大的重组努力，我看不到它以任何其他方式工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T19:19:27.977

如果您不反对使用 get 和 set 方法而不是属性，请尝试让 IPublicField 实现 IPrivateField。

```
Public Interface IPrivateField
    Function GetDirty() As Boolean
End Interface

Public Interface IPublicField
    Inherits IPrivateField

    Sub SetDirty(ByVal dirty As Boolean)
End Interface

Public Class Whatever
    Implements IPublicField

    Public Function GetDirty() As Boolean Implements IPrivateField.GetDirty
        ' logic here
    End Function

    Public Sub SetDirty(ByVal dirty As Boolean) Implements IPublicField.SetIsDirty
        ' logic here
    End Sub
End Class 
```

或者，如果您可以放弃 VB 并切换到 C#，则效果很好：

```
public interface IPrivateField
{
    bool IsDirty { get;}
}

public interface IPublicField : IPrivateField
{
    new bool IsDirty { get; set; }
}

public class Whatever : IPublicField
{
    public bool IsDirty 
    {
        get
        {
            // logic here
        }
        set
        {
            // logic here
        }
    }
} 
```

# caching - 关于使用子域强制缓存的问题

> ID：512732
> 
> 赞同：1
> 
> 时间：2009-02-04T18:47:50.257
> 
> 标签：caching

我没有很大的机会研究这个主题，但我想我会问这个问题，看看我们是否可以在这里创建一个关于这个主题的知识库。

1）使用子域将强制客户端缓存，这是默认情况下还是客户端有简单的方法来禁用它？更好奇我应该期望影响什么样的用户百分比。

2）什么都将被缓存？图片？样式表？闪存 SWF？Javascript？一切？

3）我记得读过你必须在你的 URL 中使用子域或 www 才能工作，这是正确的吗？（这是否意味着不允许这样做？）

我计划最终将它集成到我的所有网站上，但首先我将尝试为 Flash 游戏网站网络做这件事，所以我认为该网站的 www.example.com 将保持不变，而不是使用 www。 example.com/images、www.example.com/stylesheets、www.example.com/javascript 和 www.example.com/swfs 我将创建指向它们的子域（img.example.com、css.example. com、js.example.com 和 swf.example.com）——这是最好的做法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T18:51:34.617

[对内容元素](http://www.askapache.com/htaccess/apache-speed-subdomains.html)使用子域与其说是强制缓存，不如说是为了欺骗浏览器打开更多的连接。这可以加快页面加载时间。

这些元素的缓存完全在随该内容提供的 HTTP 标头中。

对于 CSS、JS 等静态文件，服务器通常会在文件被修改时通知客户端，这允许浏览器请求文件“ [If-Modified-Since](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.25) ”那个时间戳。如何通过添加一些额外的缓存标头来改进这一点的细节取决于您使用的网络服务器。例如，对于 Apache，您可以使用[mod_expires](http://httpd.apache.org/docs/2.0/mod/mod_expires.html)模块来设置 Expires 标头，或者使用[Header](http://httpd.apache.org/docs/2.0/mod/mod_headers.html#header)指令来输出其他类型的缓存控制标头。

例如，如果您有一个包含 css 文件的子目录，并希望确保它们被缓存至少一个小时，您可以在该目录中放置一个 .htaccess 并包含这些内容

```
ExpiresActive On
ExpiresDefault "access plus 1 hours" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:17:15.080

查看 YSlow 的文档。YSlow 是 Firebug 的插件，令人惊叹的 Firefox Web 开发插件。有很多关于加速页面加载的方法的有用信息，其中之一是使用一个或多个子域来鼓励浏览器进行更多的并行对象加载。

我在两个 Django 站点上做过的一件事是使用自定义模板标签来创建图像、css 等的伪路径。路径包含最后修改时间作为伪目录。该路径组件被 Apache .htaccess mod_rewrite 规则剥离。然后对象被赋予 10 年的生存时间（ExpiresDefault “现在加上 10 年”），因此浏览器只会加载它一次。如果对象改变，伪路径改变并且浏览器将获取更新的对象。

# sql-server - 从 varchar 列中选择 max int

> ID：512735
> 
> 赞同：15
> 
> 时间：2009-02-04T18:48:26.947
> 
> 标签：sql-server, tsql

我正在尝试从包含数字和字符串的 varchar 列中检索最大数字。我正在使用的数据示例：

**箱号**
123
A5
789
B1

我需要从列中返回最大的数字（在本例中为 789），同时忽略 A5 和 B1 的非数字值。

我找到了使用[自定义函数](http://www.tek-tips.com/faqs.cfm?fid=6423)来解决问题的解决方案，但我需要一些可以执行临时查询而不依赖于自定义函数或过程的东西。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-04T19:04:13.360

您需要一个组合，因为 isnumeric 为以下内容返回 1

```
select isnumeric('+'),isnumeric('5d2') 
```

你的 where 子句是这样的

```
WHERE VALUE NOT LIKE '%[a-z]%'
        AND ISNUMERIC(VALUE) = 1

create table #bla (value varchar(50))
insert #bla values('123')
insert #bla values('a5')
insert #bla values('789')
insert #bla values('b1')

SELECT MAX(CAST(value AS Int)) FROM #bla
WHERE VALUE NOT LIKE '%[a-z]%'
    AND ISNUMERIC(VALUE) = 1 
```

我在这里写过这个[ISNUMERIC 麻烦](http://wiki.lessthandot.com/index.php/ISNUMERIC_Trouble)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T18:54:40.727

你可以试试

```
Select MAX(BoxNumber) from {table} where IsNumeric(BoxNumber) = 1 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-04T05:12:14.667

为什么不

```
SELECT MAX(CAST(Value AS Int)) FROM #bla 
WHERE ISNUMERIC(Value)=1 
    AND Value LIKE '%[0-9]%' 
```

那么你只处理数字字符串。在这种情况下，您可能不需要 ISNUMERIC()

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-29T15:49:53.260

选择的答案对我有用，直到我将此值与示例中的其他值一起添加到临时表中：

```
insert #bla values('1234') 
```

我预计我的 max() 结果现在是 1234，但它仍然是 789。也许这是由于一些排序规则设置，但我能够在多个数据库上重现。我发现下面的这个查询对我有用，但我当然很想知道是否有更有效的方法来做这件事。另外，我不想包含任何十进制值，所以我也排除了任何带句点的内容。

```
SELECT MAX(CAST(Value AS Int)) FROM #bla 
WHERE ISNUMERIC(Value)=1 
    AND Value NOT LIKE '%[a-z]%' 
    AND Value NOT LIKE '%.%' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T19:01:41.787

您应该检查此解决方案中的“+”和“-”等值，因为我认为 IsNumeric 函数可能会为这些值返回 1

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T18:51:25.770

考虑将列转换为 int，然后选择 MAX()。我不知道它会对包含字母的列做什么，但值得探索。

[http://doc.ddart.net/mssql/sql70/ca-co_1.htm](http://doc.ddart.net/mssql/sql70/ca-co_1.htm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-22T21:03:23.157

这些答案只对了一半。他们成功地隔离了数值，但没有意识到当底层字段是数字时，Max 函数将计算为字符（无论转换如何），从左到右读取，因此 789 > 1000 因为 7 > 1。当字符模式下的 Max 应该工作时，这可能是忘记强制转换并用零填充数字到一个共同的长度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-06T15:14:47.867

好吧，在问这个问题之后的 11 年里，SQL Server 获得了这个函数，如果转换不成功[`try_cast`](https://docs.microsoft.com/en-us/sql/t-sql/functions/try-cast-transact-sql?view=sql-server-ver15)，它会返回而不是抛出错误。`null`所以在当前版本的 SQL Server 中，一个有效的答案是

```
select max(try_cast(BoxNumber as int)) from theTable 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-06T15:04:10.207

```
SELECT MAX(CAST(value as signed)) FROM yourTable
WHERE VALUE NOT LIKE '%[a-z]%'
AND ISNUMERIC(VALUE) = 1 
```

在 MySql 中

您应该使用 signed 而不是 int 来正确转换。

用于强制转换的 Ps 类型在 MySql 中可能不同

如需更多转化，请访问[此](https://www.w3schools.com/sql/func_mysql_cast.asp)链接

# php - 用于文件上传的 PHP 的 $_FILES 的 Perl 等效项是什么？

> ID：512738
> 
> 赞同：3
> 
> 时间：2009-02-04T18:49:28.147
> 
> 标签：php, perl, file-upload

什么是 PHP 的 Perl 等价物`$_FILES`？我有一些将日志文件发送到 Web 服务器的软件，我需要使用 Perl 而不是 PHP 来检索它们。我正在使用 CGI.pm。

这是PHP中的代码：

```
<?
    foreach ($_FILES as $key=>$value)
        {
         $uploaded_file = $_FILES[$key]['tmp_name'];
        }
?> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T19:06:57.580

它在[吊舱](http://search.cpan.org/~lds/CGI.pm-3.42/CGI.pm#CREATING_A_FILE_UPLOAD_FIELD)中：

```
my $q = CGI->new();

# get filehandle like objects from the query. 
my @uploaded_files = $q->upload();

# get file by name
my $fh = $q->upload('uploaded_file'); 
```

# html - Joomla 1.5 iframe

> ID：512753
> 
> 赞同：1
> 
> 时间：2009-02-04T18:52:39.623
> 
> 标签：html, joomla, joomla1.5

我有一个 joomla 1.5 安装，由于某种原因，当我将 iframe 放入网站时，joomla 会将其剥离。

我将此代码复制并粘贴到代码编辑器中，然后选择保存，它将删除它。我如何让它停止这个？

```
<iframe src ="client_login.html" width="100%" height="300px">
  <p>Your browser does not support iframes.</p>
</iframe> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T22:48:32.517

我在尝试将 Google 地图小部件嵌入文章时遇到了同样的问题。我找到的解决方案是执行以下操作：

1.  在文章首选项（内容->文章管理器->参数）中，在“过滤选项”下，*取消*选择与您的用户帐户关联的组——这将禁用服务器端清理
2.  在您的用户帐户页面（站点->用户管理器->*您的姓名*）下，在“参数”下将“用户编辑器”设置为“无编辑器”——这将防止所见即所得编辑器去除 IFRAME 标记

现在很明显，这个解决方案有一个明显的问题：**你不会想为普通大众将陷入的群体这样做**。就我而言，这只是针对“超级管理员”，所以我认为这是可以接受的风险。

您可以轻松地打开和关闭用户编辑器，因此如果您只需少量添加此类内容，它应该不会太烦人。这里的另一个优点是这是 Joomla 的股票！1.5 解决方案，因此未来的升级不应破坏此解决方法，并且不需要可能影响性能的扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-25T20:39:02.130

在文章管理器中尝试白名单，并使用 iframe 插件但不工作后，`sourcerer`插件做到了。使用`[[ ]]`替换`<`和`>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T19:27:36.727

我之前曾尝试过插件来执行此操作，但它们似乎都不起作用。我发现了一个非常简单的插件，效果很好。

[http://extensions.joomla.org/extensions/style-&-design/popups-&-iframes/4144/details](http://extensions.joomla.org/extensions/style-&-design/popups-&-iframes/4144/details)

要使用它添加 iframe，您只需 {iframe}url{/iframe} 即可设置宽度和高度以及所有内容。

# asp.net-mvc - 自定义验证摘要

> ID：512760
> 
> 赞同：0
> 
> 时间：2009-02-04T18:54:00.040
> 
> 标签：asp.net-mvc

我正在使用 UpdateModel 方法进行验证。当错误消息出现在验证摘要中时，如何指定它们的文本？

* * *

抱歉，我不是很清楚。当我调用 UpdateModel() 时，如果出现解析错误，例如，如果为双字段指定了字符串值，则会自动将“SomeProperty 无效”错误消息添加到 ModelState。

如何为所述*自动*生成的错误消息指定文本？

如果我按照建议实现 IDataErrorInfo ，则无论默认绑定器是否认为它有效，都会为*每一列调用错误消息属性。*

我必须重新实现使用默认活页夹免费获得的解析错误捕获功能。

顺便说一句，默认的“SomeProperty is invalid”错误消息似乎在 RC 中神秘地消失了。出现验证摘要并突出显示相关字段，但缺少文本！知道这是为什么吗？

再次感谢，我希望所有这些华夫饼都有意义！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T10:19:49.837

[本教程](http://schotime.net/blog/index.php/2009/03/05/validation-with-aspnet-mvc-xval-idataerrorinfo/)是该`IDataErrorInfo`技术的一个很好的示例 - 它通过将验证参数作为属性直接添加到模型类的属性中来轻松添加验证参数。

[这些](http://www.asp.net/learn/mvc/tutorial-29-cs.aspx) [示例](http://weblogs.asp.net/scottgu/archive/2007/07/11/linq-to-sql-part-4-updating-our-database.aspx)也可能有所帮助 - 验证方法略有不同。

此外，[这个创意（也实现了`IDataErrorInfo`）](https://stackoverflow.com/questions/1721327/validate-object-based-on-external-factors-ie-data-store-uniqueness/1741831#1741831)可能对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:22:52.727

`[IDataErrorInfo](http://blog.maartenballiauw.be/post/2009/01/30/Form-validation-with-ASPNET-MVC-release-candidate.aspx)`在您的模型上实施。

# sql - .NET TimeSpan 的 T-SQL 检查约束？

> ID：512762
> 
> 赞同：1
> 
> 时间：2009-02-04T18:54:13.130
> 
> 标签：sql, sql-server, regex, parsing, timespan

我在 sql server 2005 表中有一个 nvarchar(max) 列，用于存储 .NET TimeSpan 对象的字符串表示形式。有时表格是手动编辑的。我想添加一个检查约束来验证字符串是否可以被 TimeSpan.Parse() 解析。我该怎么做？我想我可以使用其中一种方法在 sql server 中启用正则表达式，但如果有的话，我想找到一种更简单的方法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T19:16:33.443

存储 .Net 时间跨度的更好方法是`int`使用 TimeSpan 的`.Ticks`属性在列中。

当然，这会破坏手动表格编辑。但是手动表格编辑无论如何都是邪恶的。确保 TimeSpan.Parse() 有效或您具有有效值的最佳方法是提供一个使用相关功能的客户端应用程序来完成您的编辑。

最后，如果您必须这样做，请尝试构建一个使用 TimeSpan.Parse() 进行测试的 clr 用户定义函数。然后看看你是否可以在你的约束中包含这个函数（我真的不知道是否允许udf（特别是clr udf）在那里）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:26:51.377

我同意 Joel 的观点，如果可能的话，您应该尝试摆脱直接的表格编辑。我还要补充一点，将数据库如此紧密地耦合到前端代码通常不是一个好主意。以最适合数据库的方式存储数据，并根据需要将其转换为任何前端代码。

如果你不能，那么也许这第一次尝试会让你接近。它不允许 Timespan.Parse 的完整精度，因为 ISDATE() 函数只接受最接近 1000 秒的时间。也许你可以建立在它之上。像我以前那样去掉第二部分，然后分别检查。不过，这是一种表达方式。

```
CREATE TABLE dbo.Test_Timespan
(
    my_string   NVARCHAR(MAX)   NOT NULL,
    CONSTRAINT CK_Test_Timespan_my_string CHECK (CAST(SUBSTRING(RTRIM(LTRIM(my_string)), 1, CHARINDEX('.', RTRIM(LTRIM(my_string))) - 1) AS INT) BETWEEN -10675199 AND 10675199 AND ISDATE(SUBSTRING(RTRIM(LTRIM(my_string)), CHARINDEX('.', RTRIM(LTRIM(my_string))) + 1, LEN(my_string) - CHARINDEX('.', RTRIM(LTRIM(my_string))))) = 1)
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-29T17:58:08.230

`TimeSpan`在 SQL中存储值有两种明智的方法。作为 a 中的刻度`bigint`，这是首选，或者作为 varchar(26) 中的字符串。如果它以 100 纳秒的刻度存储在 a 中`bigint`，它自然会被限制在 TimeSpan 的适当数字范围内。（在 C# 中`TimeSpan.Ticks`是一个。）`long`

如果存储为字符串，则该值必须介于 -10675199.02:48:05.4775808 和 10675199.02:48:05.4775807 之间。验证这一点的最简单方法是转换为刻度。如果转换成功，则价值良好。

请参阅我[对存储值 > 24:00:00 的 .Net 时间跨度的正确 SQL 类型是什么的回答？](https://stackoverflow.com/questions/8503825/what-is-the-correct-sql-type-to-store-a-net-timespan-with-values-240000)用于在 SQL 中执行 TimeSpan 操作的函数。

安装这些函数后，可以使用以下代码作为模板轻松创建约束，您可以根据需要进行更改：

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TimeSpanStringTest](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [TimeSpanString] [varchar](26) NOT NULL
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[TimeSpanStringTest]  WITH CHECK ADD  CONSTRAINT [CK_TimeSpanString] CHECK  (([dbo].[ConvertFromTimeSpanString]([TimeSpanString]) IS NOT NULL))
GO

ALTER TABLE [dbo].[TimeSpanStringTest] CHECK CONSTRAINT [CK_TimeSpanString]
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Validates a TimeSpan string by trying to convert it to ticks.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TimeSpanStringTest', @level2type=N'CONSTRAINT',@level2name=N'CK_TimeSpanString'
GO 
```

# asp.net - 会话状态删除和增加开销

> ID：512771
> 
> 赞同：3
> 
> 时间：2009-02-04T18:55:39.257
> 
> 标签：asp.net, session-state

以下是我通常如何处理会话状态中的对象，我有一个 const 字符串作为会话名称，然后有一个属性，其中包含对象的获取和设置。

我想知道是否有必要调用“Session.Remove()”（以保持事物干净整洁），以及是否存在大量开销并执行此删除。

我有 Session.Remove 基本上是因为它让我感觉更好（我知道强迫症），让我觉得会话更干净，但我想知道它是否不需要。

```
private const string sesMyObject = "{C2CC72C3-1466-42D4-8579-CAA11F261D55}";
public MyObject MyObjectProperty
{
    get
    {
        return Session[sesMyObject] as MyObject;
    }
    set
    {
        Session.Remove(sesMyObject);
        Session.Add(sesMyObject, value);
    }
} 
```

**根据以下答案编辑** 我已将我的属性更改为以下内容：

```
private const string sesMyObject = "{C2CC72C3-1466-42D4-8579-CAA11F261D55}";
public MyObject MyObjectProperty
{
    get
    {
        return Session[sesMyObject] as MyObject;
    }
    set
    {
        Session[sesMyObject] = value;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:16:38.997

如果您*真的*想要安全，请尝试将对象转换为 IDisposable，如果成功，请调用 Dispose。

```
IDisposable sesDispObj =  Session[sesMyObject] as IDisposable;
if (sesDispObj != null)
   sesDispObj.Dispose(); 
```

除此之外，

```
 Session[sesMyObject] = value 
```

几乎一样

```
 Session.Remove(sesMyObject);        
 Session.Add(sesMyObject, value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:17:26.093

It's overkill. Refering [MSDN](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.add.aspx)

> If the name parameter refers to an existing session state item, the existing item is overwritten with the specified value.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:19:49.660

```
Session[sesMyObject] = value; 
```

is shorter, simpler to read, and should have slightly better performance, but unless this code is being repeated very many times in succession, it shouldn't make a difference.

# visual-studio-2008 - 在 Visual Studio 2008 中，是否可以创建和管理 css 和 html 代码片段？

> ID：512775
> 
> 赞同：2
> 
> 时间：2009-02-04T18:55:59.490
> 
> 标签：visual-studio-2008

有谁知道将 css 和 html 代码片段添加到 Visual Studio 2008 的方法？

我喜欢我的 C# 片段，而 HTML/CSS 片段会节省大量时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T19:01:35.297

您可以简单地标记一段 HTML/CSS 代码并将其拖到工具箱中。然后重命名工具箱中的代码片段并为其命名，以便您轻松记住它是什么。

然后只需将其从工具箱拖放到另一个页面上即可插入片段。

（也许首先在工具箱中为您的片段创建一个单独的组）。

# java - 在 Eclipse 的 JUnit 视图中排序单元测试

> ID：512778
> 
> 赞同：43
> 
> 时间：2009-02-04T18:57:33.917
> 
> 标签：java, eclipse, junit

Eclipse 中的 JUnit 视图似乎对测试进行随机排序。如何按班级名称订购它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-07T16:30:25.333

正如加里在评论中所说：

> 如果可以告诉 Unit Runner 继续并按类名对它们进行排序，那就太好了。嗯，也许我应该看看源代码......

我确实看过，但没有提示对这些名称进行排序的功能。我建议对 JUnit 插件提出更改请求，但我不认为有很多人在使用这个东西，所以：DIY。

如果您修改插件代码，我想看看解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-26T11:20:51.023

可能会做的一件事是使用 JUnit 3.x 的模式。我们使用了一个名为 AllTests 的测试套件，您可以在其中按特定顺序将测试添加到其中。对于每个包裹，我们都会得到另一个 AllTests。为这些测试套件提供与包相同的名称，可以轻松构建 junit 插件应该重视的层次结构。

我真的不喜欢它在 Junit 查看器中呈现测试方法的方式。它应该与它们在 TestCase 类中指定的顺序完全相同。我以重要性和特征的方式对这些方法进行排序。所以最失败的方法是先更正，然后在测试用例的后面部分更特殊。

测试运行者正在扰乱这些，这真的很烦人。我会自己看一下，如果我找到解决方案，我会更新这个答案。

更新：

我对 TestCase 中方法名称排序的问题与此有关： [http](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7023180) ://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7023180 （感谢 Oracle！）。

所以最后 oracle 改变了 class.getMethods 或 class.getDeclaredMethods 调用中方法的顺序。现在这些方法是随机的，并且可以在 JVM 的不同运行之间改变。它似乎与比较的优化有关，甚至是一种压缩方法名称的尝试-谁知道...。

那么还剩下什么。第一个可以使用：@FixMethodOrder（来自[javacodegeeks.com](http://www.javacodegeeks.com/2013/01/junit-test-method-ordering.html)）：

> 1.  @FixMethodOrder(MethodSorters.DEFAULT) – 基于内部比较器的确定性顺序
> 2.  @FixMethodOrder(MethodSorters.NAME_ASCENDING) - 方法名的升序
> 3.  @FixMethodOrder(MethodSorters.JVM) – 4.11 之前的依赖于基于反射的顺序的方式

这很愚蠢，但解释了为什么人们开始使用 test1TestName 模式。

**更新2**：

我使用 ASM，因为 Javassist 还在 getMethods() 上生成随机排序的方法。他们在内部使用地图。对于 ASM，我只使用访客。

```
package org.junit.runners.model;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

import org.objectweb.asm.ClassReader;
import org.objectweb.asm.ClassVisitor;
import org.objectweb.asm.MethodVisitor;
import org.objectweb.asm.Opcodes;

import com.flirtbox.ioc.OrderTest;

/**
 * @author Martin Kersten
*/
public class TestClassUtil {
public static class MyClassVisitor extends ClassVisitor {
    private final List<String> names;
    public MyClassVisitor(List<String> names) {
        super(Opcodes.ASM4);
        this.names = names;
    }

    @Override
    public MethodVisitor visitMethod(int access, String name, String desc,
            String signature, String[] exceptions) {
        names.add(name);
        return super.visitMethod(access, name, desc, signature, exceptions);
    }
}

private static List<String> getMethodNamesInCorrectOrder(Class<?> clazz) throws IOException {
    InputStream in = OrderTest.class.getResourceAsStream("/" + clazz.getName().replace('.', '/') + ".class");
    ClassReader classReader=new ClassReader(in);
    List<String> methodNames = new ArrayList<>();
    classReader.accept(new MyClassVisitor(methodNames), 0);
    return methodNames;
}

public static void sort(Class<?> fClass, List<FrameworkMethod> list) {
    try {
        final List<String> names = getMethodNamesInCorrectOrder(fClass);
        Collections.sort(list, new Comparator<FrameworkMethod>() {
            @Override
            public int compare(FrameworkMethod methodA, FrameworkMethod methodB) {
                int indexA = names.indexOf(methodA.getName());
                int indexB = names.indexOf(methodB.getName());
                if(indexA == -1)
                    indexA = names.size();
                if(indexB == -1)
                    indexB = names.size();
                return indexA - indexB;
            }
        });
    } catch (IOException e) {
        throw new RuntimeException("Could not optain the method names of " + fClass.getName() + " in correct order", e);
    }
}
} 
```

只需将它放在包 org.junit.runners.model 中的 src/test/java 文件夹中。现在将 junit 4.5 lib 的 org.junit.runners.model.TestClass 复制到同一个包中，并通过添加排序例程来更改其构造函数。

```
 public TestClass(Class<?> klass) {
    fClass= klass;
    if (klass != null && klass.getConstructors().length > 1)
        throw new IllegalArgumentException(
                "Test class can only have one constructor");

    for (Class<?> eachClass : getSuperClasses(fClass))
        for (Method eachMethod : eachClass.getDeclaredMethods())
            addToAnnotationLists(new FrameworkMethod(eachMethod));

            //New Part
    for(List<FrameworkMethod> list : fMethodsForAnnotations.values()) {
        TestClassUtil.sort(fClass, list);
    }

    //Remove once you have verified the class is really picked up
    System.out.println("New TestClass for " + klass.getName());

} 
```

干得好。现在，您已经按照在 java 文件中声明的顺序对方法进行了很好的排序。如果您想知道类路径通常设置为类加载器首先考虑 src（目标或 bin）文件夹中的所有内容。因此，在定义相同的包和相同的类时，您可以“覆盖”您使用的任何库中的每个类/接口。这就是诀窍！

**Update3** 我能够以正确的顺序获得每个包和每个类的树视图。

*   这个想法是继承 ParentRunner，然后将所有你认为是公共的类添加到它，并且具有用 test 注释的方法。
*   添加一个 getName() 方法，仅返回套件运行程序所代表的类的包名称（因此您将树视为没有套件类名称的包树）。
*   如果您找到某个套件类，请检查子目录（我对所有套件类都使用 AllTests）。
*   如果您在子目录中找不到套件类，请检查其所有子目录，这样如果父目录不包含套件，您就不会错过包含测试的包。

就是这样。我到处添加的套件类是： `@RunWith(MySuiteRunner.class) public class AllTests { }`

就是这样。你应该付出足够的努力来开始和扩展这个。套件运行器仅使用反射，但我按字母顺序对子目录的测试类和套件进行排序，并且子目录套件（代表它们所在的包）排在最前面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T19:06:42.073

马克写道：

> 它根据执行时间对它们进行排序，也许您应该对方法进行排序？源/排序成员

马克是对的。但是你不能对你的单元测试进行排序。不允许推测执行顺序。

单元测试必须独立构建，并且是随机的，UnitRunner 如何调用它们。

在大多数情况下，测试方法按字母顺序排序。班级是随机的。尝试使用 TestSuite 来订购您的测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:17:56.413

如果您确实需要 JUnit 测试之间的硬依赖，请尝试**[JExample 扩展](http://smallwiki.unibe.ch/JExample)**

> JExample 将生产者-消费者关系引入单元测试。
> 生产者是一种测试方法，它产生其被测单元作为返回值。
> 消费者是一种依赖于一个或多个生产者及其返回值的测试方法。

您可以[将它安装在 Eclipse](http://smallwiki.unibe.ch/jexample/quickstart/)中，适用于 Junit4.4 或 4.5。

```
import jexample.Depends;

  @Test
  @Depends("#testEmpty") 
  public Stack<Integer> testPush(Stack<Integer> $) { 
      $.push(42); 
      assertFalse($.isEmpty()); 
      return $; 
  } 
```

* * *

正如这篇 IBM 文章[“追求代码质量：JUnit 4 与 TestNG”中](http://www.ibm.com/developerworks/java/library/j-cq08296/)所述：

> JUnit 框架试图实现的一件事是**测试隔离**。
> 不利的一面是，这使得指定测试用例执行的顺序变得非常困难，这对于任何类型的依赖测试都是必不可少的。
> 开发人员使用了不同的技术来解决这个问题，例如按字母顺序指定测试用例或严重依赖固定装置 ( `@Before` `@After`) 来正确设置。
> 
> 这些变通方法对于成功的测试来说很好，但对于失败的测试，它们会带来不便的后果：每个后续的依赖测试也会失败。在某些情况下，这可能会导致大型测试套件报告不必要的失败

所以请注意：如果您保留任何解决方案来以您想要的方式订购 JUnit 测试......您需要考虑该解决方案是否支持“跳过”功能，以便即使其中一个测试失败也允许其他测试继续进行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-11T19:14:36.527

JUnit 视图中的排序测试已[在 Eclipse Bugzilla 中作为 bug #386453](https://bugs.eclipse.org/bugs/show_bug.cgi?id=386453)提交。在那里发表评论和/或投票可能有助于更多地了解这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-08-28T07:09:34.817

11 年后，JUnit 视图确实有名称排序，并且刚刚获得了“执行时间”排序。
参见[Eclipse 4.17 (2020-09)](https://www.eclipse.org/eclipse/news/4.17/jdt.php#junit-sort-time)

> ## 按执行时间排序测试结果
> 
> JUnit 视图现在提供了按执行时间对结果进行排序的能力。
> 
> 默认情况下，结果将按执行顺序排序。一旦所有测试完成，从 JUnit View 菜单中选择将重新排序结果
> 。`Sort By > Execution Time`
> 
> 当测试仍在运行时，它们将按执行顺序显示。

[![https://www.eclipse.org/eclipse/news/4.17/images/junit-sort-time-before.png](https://i.stack.imgur.com/KjiFM.png)](https://i.stack.imgur.com/KjiFM.png)

按执行顺序排序的结果是：

[![https://www.eclipse.org/eclipse/news/4.17/images/junit-sort-time-after.png](https://i.stack.imgur.com/RyaZA.png)](https://i.stack.imgur.com/RyaZA.png)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-02-09T15:02:19.607

我也在寻找解决方案，我从下面的 URL 中找到了一种破解。我不知道它是否适合你，但它在 Spring Tool Suite 2.5.2 中对我有用。

[http://osdir.com/ml/java.junit.user/2002-10/msg00077.html](http://osdir.com/ml/java.junit.user/2002-10/msg00077.html)

# ruby-on-rails - 在我的 Rails 应用程序中适当地处理非 UTF8 内容

> ID：512779
> 
> 赞同：2
> 
> 时间：2009-02-04T18:57:39.847
> 
> 标签：ruby-on-rails, ruby, utf-8, character-encoding

我有一个 Rails 应用程序，它允许用户使用 RSS 提要等从各种来源导入信息。我在数据库上的默认编码是 UTF8，我收到了很多关于非 UTF8 数据的异常，这些数据来自系统并在到达数据库后崩溃。

我要使用 is_utf8 适当地检测非 UTF8 数据？在保存完成之前属性上的方法，但我还没有想出一种方法来处理它。我已经看到 iconv 进行转换，但似乎需要能够确定我正在转换的编码类型。

有没有一种简单的方法来进行猜测转换，或者可能只是去掉非 UTF8 字符，然后保存到数据库中？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T19:59:11.953

在切换编码方面，Iconv 是您的朋友。要检测编码，有一个可用的小宝石：[rchardet](http://github.com/jmhodges/rchardet/blob/master/Rakefile) 我们用它来检测亚洲编码以阻止垃圾邮件，它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:11:29.353

非 UTF-8 数据如何进入系统？确保您的所有页面都作为 Content-Type text/html;charset=utf-8 提供，并且浏览器将始终将 UTF-8 数据提交到您的表单。

（当然，仍然会留下邮件和上传文件等内容，但许多此类特定上下文通常会为您提供继续编码。）

# wpf - WPF：WrapPanel 何时已满

> ID：512783
> 
> 赞同：0
> 
> 时间：2009-02-04T18:57:56.163
> 
> 标签：wpf, clipping, wrappanel

我正在使用 WrapPanel 在列中显示可变高度项。包裹面板的大小受到限制。

有没有办法确定 WrapPanel 何时“满”？然后，我将使用动画分页到另一个面板。

我已经查看了作为子面板的项目的 ArrangeOverride，但它们似乎总是获得他们想要的所有空间。我需要一种方法来确定它们何时开始被剪裁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T10:33:39.330

实际上，使用 WrapPanel 来实现您想要实现的目标似乎不是一个好主意。

> “[...] 然后，我将使用动画分页到另一个面板。”

这将是布局到布局动画，也不是那么容易。

您应该编写自己的面板类：请参见[此处](http://www.codeproject.com/KB/WPF/Panels.aspx)或（动画）[此处](http://www.switchonthecode.com/tutorials/wpf-tutorial-creating-a-custom-panel-control)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:35:58.163

这是一个使用带有触发器的 ScrollViewer 来确定它是否会使用[ScrollableHeight](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.scrollableheight.aspx)显示的示例。现在它只是改变了一些文本，但你可以做其他事情。删除其中一个矩形将触发触发器：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Width="100" Height="50">
    <ScrollViewer x:Name="scrollViewer" VerticalScrollBarVisibility="Hidden">
        <WrapPanel>
            <Rectangle Width="50" Height="20" Fill="Red"/>
            <Rectangle Width="50" Height="20" Fill="Blue"/>
            <Rectangle Width="50" Height="20" Fill="Green"/>
            <Rectangle Width="50" Height="20" Fill="Yellow"/>
            <Rectangle Width="50" Height="20" Fill="Orange"/>
        </WrapPanel>
    </ScrollViewer>
    <TextBlock IsHitTestVisible="False">
        <TextBlock.Style>
            <Style TargetType="{x:Type TextBlock}">
                <Setter Property="Text" Value="Clipped"/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=scrollViewer, Path=ScrollableHeight}" Value="0">
                        <Setter Property="Text" Value="Not Clipped"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </TextBlock.Style>
    </TextBlock>
</Grid> 
```

您也可以基于[ScrollViewer.ComputedVerticalScrollBarVisibility](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.computedverticalscrollbarvisibility.aspx)触发，但这需要 ScrollBar 实际可见，而当您基于[ScrollableHeight](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.scrollableheight.aspx)触发时，可以隐藏 ScrollBar。

# c# - 为什么我的事件在回发后没有注册？

> ID：512794
> 
> 赞同：0
> 
> 时间：2009-02-04T19:01:07.700
> 
> 标签：c#, asp.net

我有一个带有复选框的页面的问题：

```
<asp:CheckBox runat="server" ID="chkSelectAll" OnCheckedChanged="chkSelectAll_CheckedChanged" EnableViewState="true" Text='<%# CommonFunctions.GetText(Page, "CreateTask", "chkSelectAll.text") %>' AutoPostBack="true" /> 
```

首先，我遇到的问题是，当事件引发时，复选框没有保留选中的属性值。这仍然很奇怪，因为在应用程序中我们没有将 EnableViewState 设置为 false，默认情况下它应该为 true。这个行为是通过设置 EnableViewState="true" 来解决的。

所以现在，我有一个复选框，当我第一次加载页面时，它可以正常工作。我选中该框，引发事件 Checked property value is good 并执行该方法。回发完成并呈现页面。我将复选框重新选中为 false，事件未触发，页面重新加载了以前的数据，但 Checked 属性保持为 true。

所以在第一次回发之后，我似乎失去了事件和 ViewState 的行为。

我们怀疑我们动态移动页面中的控件这一事实（请参阅[此处](https://stackoverflow.com/questions/375093/asp-net-possible-to-create-a-usercontrol-that-include-inside-markup-content)的答案）

但是这种怀疑并不能解释为什么在第一次加载后一切正常，而在第一次 PostBack 后停止工作。

**编辑**

[**代码示例**](http://www.mediafire.com/?14udjznyjmj)

我创建了一个测试项目，您可以在其中体验我的问题。在加载时，如果您选中任何复选框，都会引发各自的事件。回发后只有第二次引发这两个事件。移动控制后注册事件时似乎有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T19:12:02.657

听起来您在回发时覆盖了复选框数据。在处理页面加载事件的方法中设置动态控件，如下所示：

```
void Page_Load(){
    if (!Page.IsPostBack)
    {
       /* call methods to render a clean page with fresh controls */
    }
} 
```

**更新 -**示例代码发布后

我原则上是正确的，但是在看到您的代码示例后，我能够更好地解释：

在您的用户控件中，您有在页面加载时调用的方法，需要告知该控件是第一次加载还是在回发时加载 - 否则，它只会不断重建控件的新副本。

这是您的文件“CollapsiblePanel.ascx.cs”中修改后的代码：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            for (int i = 0; i < Controls.Count; i++)
                if (Controls[i] is CollapsiblePanelExtender)
                    while (i + 2 < Controls.Count)
                    {
                        SearchUpdatePanel(Controls[i + 2]);
                        plhContent.Controls.Add(Controls[i + 2]);
                    }
        }
    } 
```

通过此更改，复选框在回发后保持其值，并且每次更改都会触发您的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T21:27:09.743

我有一个解决方案，其中 Page_Load 似乎不适合放置我的移动代码。将其移至 CreateChildControls 似乎解决了我的问题：

```
protected override void CreateChildControls()
{
    for (int i = 0; i < Controls.Count; i++)
        if (Controls[i] is CollapsiblePanelExtender)
            while (i + 2 < Controls.Count)
            {
                SearchUpdatePanel(Controls[i + 2]);
                plhContent.Controls.Add(Controls[i + 2]);
            }
    base.CreateChildControls();
} 
```

非常感谢所有试图提供帮助的人（例如 Rob）

# c++ - C++新手：有各种各样的链接问题

> ID：512804
> 
> 赞同：0
> 
> 时间：2009-02-04T19:03:30.100
> 
> 标签：c++, visual-studio, visual-studio-2008, linker, linker-errors

我在 Visual Studio 2008 中遇到了 tessdll 的几个问题。仅供参考，我将此应用程序创建为 MFC 应用程序，我这样做只是为了利用我需要的简单 GUI。从那里开始就是直接的 C++ 和 win32。

由于某种原因，这作为调试版本构建得很好（因为我已经包含了我需要的头文件和 lib 文件，并且 dll 驻留在我可以放置的每个目录中......）。

因此，在构建发布版本期间存在链接问题：

```
Linking...
MTGOBot.obj : error LNK2001: unresolved external symbol "__declspec
(dllimport) public: __thiscall TessDllAPI::TessDllAPI(char const
*)" (__imp_??0TessDllAPI@@QAE@PBD@Z)
MTGOBot.obj : error LNK2001: unresolved external symbol "__declspec
(dllimport) public: __thiscall TessDllAPI::~TessDllAPI(void)" (__imp_??
1TessDllAPI@@QAE@XZ)
MTGOBot.obj : error LNK2001: unresolved external symbol "__declspec
(dllimport) public: int __thiscall TessDllAPI::BeginPage(unsigned
int,unsigned int,unsigned char *,unsigned char)" (__imp_?
BeginPage@TessDllAPI@@QAEHIIPAEE@Z)
MTGOBot.obj : error LNK2001: unresolved external symbol "__declspec
(dllimport) public: struct ETEXT_STRUCT * __thiscall
TessDllAPI::Recognize_all_Words(void)" (__imp_?
Recognize_all_Words@TessDllAPI@@QAEPAUETEXT_STRUCT@@XZ)
C:\CPP Projects\Visual Studio 2008\Projects\MTGO SO Bot\MTGO SO Bot
\Release\MTGO SO Bot.exe : fatal error LNK1120: 4 unresolved externals 
```

此外，作为参考，可以在此处找到 tessdll.h 的源代码： [http ://code.google.com/p/tesseract-ocr/source/browse/trunk/tessdll.h?r=165](http://code.google.com/p/tesseract-ocr/source/browse/trunk/tessdll.h?r=165)

更多细节：

*   我从工具栏调试并使用集成调试器。
*   我使用 Batch Build 创建发布版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:18:38.710

第一个猜测：您没有使用 DLL 的链接库。链接器大喊没有找到一些符号，`TessDllAPI`听起来很像一个 DLL。默认情况下（阅读：在项目设置对话框启动中）所有项目设置都特定于构建配置（调试、发布），但您可以从 GUI 中选择“所有配置”。这可以解释为什么它在一种配置中有效，而在另一种配置中无效。

试一试

```
#pragma comment(lib:"tessdll")
// (Of course you need to replace the `tessdll` with the name of the library.) 
```

在头文件中，或添加此库以在“发布”配置中进行链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:10:33.923

没有看到项目设置，这很难。要检查的事项（调试和发布设置之间的差异）：

1）您是否在发布版本中包含 .lib ？

2）您是否不小心为 tessdll 定义了预处理器指令？

我会浏览设置，在调试和发布之间来回切换，看看意外添加/忘记了什么。

DLL 的存在仅在运行时需要。你没有走那么远。

# ftp - 用于文件传输的 IBM MQ

> ID：512807
> 
> 赞同：8
> 
> 时间：2009-02-04T19:04:14.980
> 
> 标签：ftp, message-queue, file-transfer, ibm-mq

我们面临着使用 IBM MQ over SFTP 进行文件传输的选择。我听说过这种方法的优点，但我从未见过有人真正将它用于大文件。

所以主要问题：IMB MQ 处理大文件（最大 100 MB）传输的能力如何？稳定吗？它是从大型机到 UNIX 服务器，如果它确实重要的话。

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T19:17:46.903

我使用 MQ 的文件大小最大为 8GB，没有发生任何意外。您必须为 MQ 分配足够的空间来管理它们，但它确实有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-24T17:13:29.767

MQ 本身提供程序之间基于消息的通信。您不能直接使用它来传输文件。人们谈论“通过MQ发送文件”通常意味着他们将自己编写程序以从文件中读取，通过MQ发送，从MQ接收并写入另一个文件。起初这听起来微不足道，但如果你想让它变得健壮，很快就会变得非常复杂。不建议。

如果您想让 MQ 参与文件传输，您*应该*做的是使用 MQ 上的文件传输产品之一。有许多成熟的产品，我对此几乎一无所知，包括 IBM 本身的新产品（“Websphere MQ 文件传输版”），该产品正在积极开发中，最近宣布了更新版本 (7.0.1)。

为了回答你的具体问题，我个人使用 WMQFTE 将 1000GB 的文件从 AIX 机器传输到 Windows 机器，所以我认为你的“大”100MB 文件不会有问题:-)。我没有过多地参与大型机，但它在很大程度上是 FTE 的核心平台。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T19:45:08.767

供应商通过消息传递系统（如 WebSphere MQ）进行文件传输已超过 12 年。我没有使用过 IBM 产品。然而，我直到最近才知道 IBM 转售了 Metastorm 的产品（以[PM4Data](http://www.metastorm.com/products/PM4Data.asp)品牌），并且直到最近才以第一代产品进入市场。

我已经看到[Metastorm Integration Manager](http://www.metastorm.com/products/metastorm_integration_manager.asp)一直在处理 TB 大小的文件。跨 WebSphere MQ 分解消息并执行缓冲区确认，以免消息队列溢出或不必执行大量 MQ 管理。

与 SFTP 相比，使用消息传递系统进行文件传输的其他值得考虑的因素包括：

1.  **数据移动前后处理**- 作为一种网络传输，SFTP 移动数据（就像通过 WebSphere MQ 传输文件的产品一样）。要进行移动前或移动后处理，您必须编写自己的监控、触发、错误处理等。在消息空间上进行文件传输的成熟供应商为您提供开箱即用的基础设施。根据您的应用，他们还可以提供帮助
2.  **Audit Trail** - SFTP 提供通常提供的系统级日志记录。通常，通过 MQ 提供文件集成的供应商具有更强大的审计能力，包括数据移动前和数据移动后处理。一些供应商还提供基于 Web 的安全系统，以向授权用户公开某些集成。
3.  **异常处理**– SFTP 将提供同步错误消息，然后您可以从中编写错误逻辑。通过 MQ 提供文件集成的供应商通常提供异常功能，从“这里有一条消息在队列中表示发生了问题......祝你好运”到基于 Web 的控制台甚至 BPM 系统的内置集成。
4.  **将文件传输视为服务**– 通常，文件传输是更大业务流程的一部分。一些供应商利用它来链接文件传输，甚至让他们与以人为中心的流程协作，以提供围绕点对点文件传输上下文的端到端可见性。此外，使用消息系统进行文件传输有助于将组织转移到更实时、消息驱动的方法。

我希望额外的细节能在你的评估中提供一些细节。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-08T19:35:30.817

在先前的答案之一中，有以下声明：

> 人们谈论“通过MQ发送文件”通常意味着他们将自己编写程序以从文件中读取，通过MQ发送，从MQ接收并写入另一个文件。起初这听起来微不足道，但如果你想让它变得健壮，很快就会变得非常复杂。不建议。

从理论上讲，“通过 MQ 发送文件”会很好，因为当收件人从队列中获取（读取）文件时，您会收到一条发送确认 (CoD) 消息。另一个好处是，当收件人从队列中获取（读取）文件时，该文件将自动从队列中删除。

您是否知道 MQFTE 是否提供上述（或类似的）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-08T20:01:28.793

Capitalwares [Universal File Mover](http://www.capitalware.com/ufm_overview.html)是这里的一个选项。

[WebSphere Message Broker for Remote Adapter Deployment](http://www-01.ibm.com/software/integration/wbimessagebroker/rad/)和[WebSphere MQ File Transfer Edition](http://www-01.ibm.com/common/ssi/ShowDoc.jsp?docURL=/common/ssi/rep_ca/0/877/ENUSZP10-0400/index.html&breadCrum=DET001PT022&url=buttonpressed=DET001PT116&page=1000&paneltext1=DET001PEF011&user+type=EXT&lang=en_US&InfoType=AN&InfoSubType=CA&InfoDesc=Announcement+Letters&panelurl=index.wss?buttonpressed%3DDET001PT116%26page%3D1000%26paneltext1%3DDET001PEF011%26user%2Btype%3DEXT&paneltext=Announcement%20letter%20search)也是要考虑的选项。

# sql-server - 我可以在 SQL 2005 上创建数据库表后对其进行分区吗

> ID：512808
> 
> 赞同：0
> 
> 时间：2009-02-04T19:04:28.897
> 
> 标签：sql-server, sql-server-2005, partitioning

大多数处理表分区的例子都是在分区方案上创建表。

例如：

```
create table SomeTable
(
  Id int not null ,
  DueDate DateTime not null
) on MyPartitionScheme(DueDate) 
```

其中 MyPartitionScheme 是预定义的分区方案。

如果我有一个已经存在的表，可能带有数据。我可以“更改”它以使用分区方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T19:13:33.747

来自[*Microsoft SQL Server 2005 实施和维护*](https://rads.stackoverflow.com/amzn/click/com/073562271X)：

> 1.  创建分区函数
> 2.  创建分区方案
> 3.  删除现有的聚集索引
> 4.  在分区方案上重新创建聚集索引

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:07:41.463

在 BOL 中查找 ALTER TABLE SWITCH TO PARTITION

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T20:00:33.573

在[SQL Server 2005 中的分区表和索引中](http://msdn.microsoft.com/en-us/library/ms345146.aspx)明确指出：

> *“通过在分区方案上定义聚集索引，您将在加载后有效地对表进行分区。**这也是对现有表进行分区的好方法**。创建与非分区表相同的表，并将聚集索引创建为分区聚集索引，将创建表中的 ON 子句替换为单个文件组目标。然后，在加载数据后在分区方案上创建聚集索引。*

# javascript - 如何获取 GreaseMonkey 脚本以侦听将特定类插入页面的元素

> ID：512819
> 
> 赞同：2
> 
> 时间：2009-02-04T19:08:48.433
> 
> 标签：javascript, greasemonkey

每当将具有特定类的元素插入页面时，我希望我的 GreaseMonkey 脚本运行一个函数。这样做最惯用的方法是什么？

如果它有帮助，`<select>`那就是正在插入的元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T19:17:38.043

你能用[DOMNodeInserted 做点什么](http://www.manticmoo.com/articles/jeff/programming/javascript/domnodeinserted-event-and-domnodeinsertedintodocument-event.php)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T05:53:02.883

您可以使用[DOMNodeInserted](http://www.manticmoo.com/articles/jeff/programming/javascript/domnodeinserted-event-and-domnodeinsertedintodocument-event.php)

无论使用 DOM 方法（appendChild 等）还是 innerHTML 都会触发此事件，并且也会在 Opera 中触发，因此它不会破坏用户脚本的可移植性（如果您关心的话）。查看[http://www.quirksmode.org/dom/events/tests/DOMtree.html](http://www.quirksmode.org/dom/events/tests/DOMtree.html)

如果您为在 DOMNodeInserted 上调用的函数指定参数，则该参数的“目标”属性将是节点被插入的节点。因此，您可以检查它的 nodeType 以查看它是否是您要查找的类型。DOMNode 还有一个你可以检查的 className 属性。[http://www.howtocreate.co.uk/tutorials/javascript/domstructure](http://www.howtocreate.co.uk/tutorials/javascript/domstructure)

# visual-studio - 代码模板的缩进对于VS2005中的代码隐藏文件有问题吗？

> ID：512821
> 
> 赞同：0
> 
> 时间：2009-02-04T19:09:15.377
> 
> 标签：visual-studio

不确定是否还有其他人遇到过这个问题。我喜欢使用 2 或 3 的缩进，而不是 Visual Studio 的默认缩进 4，因为我发现我的代码运行在右侧有点远，为了便于阅读，我更喜欢不在第 80 列上编码。当我使用工具>>选项>>文本编辑器>> C＃>>选项卡将缩进和制表符更改为2并将其设置为“保留制表符”时，创建的新类就可以了。但是，如果我创建一个带有页面后代码的新 ASPX 页面，尽管我指定了 2，但页面的初始代码背后的代码会保留 4 个空格缩进。我必须格式化文档（快速 ctrl e、d）但它仍然很烦人。还有人遇到这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T19:19:55.307

尝试设置工具 -> 选项 -> 文本编辑器 -> 所有语言 -> 选项卡而不是 C# -> 选项卡。

或者尝试使用不同的[字体](https://stackoverflow.com/questions/4689/recommended-fonts-for-programming)或尝试通过 Visual Studio 内置重构工具等提取方法，将代码分解成更小的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:34:10.397

现在才看了一下。所有语言都已设置。我可以进一步分解我的代码，但不希望它进入意大利面条代码。我喜欢我的方法做一个合乎逻辑的工作单元:)

# javascript - JavaScript 关联数组的键必须是字符串，还是可以是任何对象？

> ID：512825
> 
> 赞同：15
> 
> 时间：2009-02-04T19:09:54.657
> 
> 标签：javascript, arrays

JavaScript 关联数组的键必须是字符串，还是可以是任何对象？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-04T20:00:02.700

JavaScript 中没有原生关联数组，只有对象。对象具有属性。属性的名称始终是字符串：即使是数组的数字索引[也会](https://stackoverflow.com/questions/453765/javascript-arrays-and-type-conversion-inconsistencies/453773#453773)在“数组魔法”发生之前转换为字符串。

如果您正在寻找具有任意键的关联数组，[请查看此处](https://stackoverflow.com/questions/368280/javascript-hashmap-equivalent/383540#383540)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-09T21:05:22.523

我已经实现了 JavaScript HashMap，可以从[http://github.com/lambder/HashMapJS/tree/master获得代码](http://github.com/lambder/HashMapJS/tree/master)

键和值可以是任意 JavaScript 对象。对用作键或值的对象没有任何要求。

机制是微不足道的。对于每个键，都会生成一个唯一的 id（每个 HashMap 实例）。该 id 以极不可能发生冲突的字段名称注入到关键对象中；）

然后该 id 用于键入底层烘焙标准 JavaScript 关联对象。

这是代码：

```
/*
 =====================================================================
 @license MIT
 @author Lambder
 @copyright 2009 Lambder.
 @end
 =====================================================================
 */
var HashMap = function() {
  this.initialize();
}

HashMap.prototype = {
  hashkey_prefix: "<#HashMapHashkeyPerfix>",
  hashcode_field: "<#HashMapHashkeyPerfix>",

  initialize: function() {
    this.backing_hash = {};
    this.code = 0;
  },

  /*
   Maps value to key, returning the previous association
   */
  put: function(key, value) {
    var prev;
    if (key && value) {
      var hashCode = key[this.hashcode_field];
      if (hashCode) {
        prev = this.backing_hash[hashCode];
      } else {
        this.code += 1;
        hashCode = this.hashkey_prefix + this.code;
        key[this.hashcode_field] = hashCode;
      }
      this.backing_hash[hashCode] = value;
    }
    return prev;
  },

  /*
   Returns value associated with given key
   */
  get: function(key) {
    var value;
    if (key) {
      var hashCode = key[this.hashcode_field];
      if (hashCode) {
        value = this.backing_hash[hashCode];
      }
    }
    return value;
  },
  /*
   Deletes association by given key.
   Returns true if the association existed, false otherwise
   */
  del: function(key) {
    var success = false;
    if (key) {
      var hashCode = key[this.hashcode_field];
      if (hashCode) {
        var prev = this.backing_hash[hashCode];
        this.backing_hash[hashCode] = undefined;
        if(prev !== undefined)
          success = true;
      }
    }
    return success;
  }
}

//// Usage

// Creation

var my_map = new HashMap();

// Insertion

var a_key = {};
var a_value = {struct: "structA"};
var b_key = {};
var b_value = {struct: "structB"};
var c_key = {};
var c_value = {struct: "structC"};

my_map.put(a_key, a_value);
my_map.put(b_key, b_value);
var prev_b = my_map.put(b_key, c_value);

// Retrieval

if(my_map.get(a_key) !== a_value){
  throw("fail1")
}
if(my_map.get(b_key) !== c_value){
  throw("fail2")
}
if(prev_b !== b_value){
  throw("fail3")
}

// Deletion

var a_existed = my_map.del(a_key);
var c_existed = my_map.del(c_key);
var a2_existed = my_map.del(a_key);

if(a_existed !== true){
  throw("fail4")
}
if(c_existed !== false){
  throw("fail5")
}
if(a2_existed !== false){
  throw("fail6")
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:11:49.897

您是在谈论 JavaScript 对象 (JSON) 吗？

[规范](http://json.org/)说键应该是字符串。

但是 JavaScript 解释器允许`{"key": "val"}`和`{key: "val"}`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-14T18:17:13.847

基于[Lambder 的想法](https://stackoverflow.com/questions/512825/do-the-keys-of-javascript-associative-arrays-need-to-be-strings-or-can-they-be/1106452#1106452)，我实现了一个小型 DataStructures 库。

我已经对其进行了一些测试，一切似乎都有效。

它还自动为每个 HashTable/HashSet 分配一个唯一的 id，用于唯一标识对象的关键属性。

```
var DataStructure = {};

DataStructure.init = function(){
    DataStructure.initHashables();
    delete DataStructure.initHashables;
}

DataStructure.initHashables = function(){
    var objectHashableIndexer = new DataStructure.Indexer();

    DataStructure.Hashable = function(){
        var self = this;

        // Constant
        //
        //
        const ERROR_KEY_DOES_NOT_EXIST = "Key doesn't exists in Hashable when trying to pop. Associated Key Object and Hashable logged to console.";
        const HASH_MAP_KEY_PROPERTY_BASE = "DATA_STRUCTURE_HASH_MAP_KEY_PROPERTY_";

        // Attributes
        //
        //
        var tableNumber = objectHashableIndexer.getIndex();
        var tableKeyProperty = HASH_MAP_KEY_PROPERTY_BASE + tableNumber.toString();
        self.tableKeyProperty = tableKeyProperty;
        var indexer = new DataStructure.Indexer();
        var data = {};
        self.data = data;

        // Methods
        //
        //
        self.getObjectKey = function(){
            return indexer.getIndex().toString();
        }

        self.putBackObjectKey = function(index){
            indexer.putBackIndex(parseInt(index));
        }

        var getObjectKey = self.getObjectKey;
        var putBackObjectKey = self.putBackObjectKey;

        self.exists = function(key){
            if (!(tableKeyProperty in key))
                return false;

            var realKey = key[tableKeyProperty];

            if (!(realKey in data))
                return false;

            return true;
        }

        self.pop = function(key){
            if (!self.exists(key)){
                console.log(key);
                console.log(self);
                throw ERROR_KEY_DOES_NOT_EXIST;
            }
            else{
                var realKey = key[tableKeyProperty];
                delete key[tableKeyProperty];
                delete data[realKey];
                putBackObjectKey(realKey);
            }
        }

        self.destroy = function(){
            objectHashableIndexer.putBackIndex(tableNumber);
            delete self;
        }

    }

    /*
        Class DataStructure.ObjectHashMap
            Purpose: Provides a way to hash arbitrary objects to values.

            Prototype Arguments:

            Attributes:

            Methods:

            Notes:
                Should call inherited method destroy() when done with table to preserve indexes
    */
    DataStructure.ObjectHashMap = function(){
        DataStructure.Hashable.call(this);
        var self = this;

        // Constant
        //
        //
        const ERROR_KEY_EXISTS = "Key already exists in ObjectHashMap when trying to push. Associated Key Object and ObjectHashMap logged to console.";
        const ERROR_KEY_DOES_NOT_EXIST = "Key doesn't exists in ObjectHashMap when trying to getValue. Associated Key Object and ObjectHashMap logged to console.";

        // Attributes
        //
        //

        var tableKeyProperty;
        var data;

        // Initialization
        //
        //
        self.init = function(){
            self.privatize();
            delete self.privatize;
        }

        self.privatize = function(){
            tableKeyProperty = self.tableKeyProperty;
            delete self.tableKeyProperty;

            getObjectKey = self.getObjectKey;
            delete self.getObjectKey;

            putBackObjectKey = self.putBackObjectKey;
            delete self.putBackObjectKey;

            data = self.data;
            delete self.data;
        }

        // Methods
        //
        //
        var getObjectKey;
        var putBackObjectKey;

        self.push = function(key, value){
            if (self.exists(key)){
                console.log(key);
                console.log(self);
                throw ERROR_KEY_EXISTS;
            }
            else{
                var realKey = getObjectKey();
                key[tableKeyProperty] = realKey;
                data[realKey] = value;
            }
        }

        self.getValue = function(key){
            if(!self.exists(key)){
                console.log(key);
                console.log(self);
                throw ERROR_KEY_DOES_NOT_EXIST;
            }
            else{
                var realKey = key[tableKeyProperty];
                return data[realKey];
            }
        }

        self.init();
        delete self.init;
    }

    /*
        Class DataStructure.ObjectHashSet
            Purpose: Provides a way to store arbitrary objects and check that they exist.

            Prototype Arguments:

            Attributes:

            Methods:

            Notes:
                Should call inherited method destroy() when done with table to preserve indexes
    */
    DataStructure.ObjectHashSet = function(){
        DataStructure.Hashable.call(this);
        var self = this;

        // Constant
        //
        //
        const ERROR_KEY_EXISTS = "Key already exists in ObjectHashSet when trying to push. Associated Key Object and ObjectHashSet logged to console.";
        const ERROR_KEY_DOES_NOT_EXIST = "Key doesn't exists in ObjectHashSet when trying to getValue. Associated Key Object and ObjectHashSet logged to console.";

        // Attributes
        //
        //

        var tableKeyProperty;
        var data;

        // Initialization
        //
        //
        self.init = function(){
            self.privatize();
            delete self.privatize;
        }

        self.privatize = function(){
            tableKeyProperty = self.tableKeyProperty;
            delete self.tableKeyProperty;

            getObjectKey = self.getObjectKey;
            delete self.getObjectKey;

            putBackObjectKey = self.putBackObjectKey;
            delete self.putBackObjectKey;

            data = self.data;
            delete self.data;
        }

        // Methods
        //
        //
        var getObjectKey;
        var putBackObjectKey;

        self.push = function(key){
            if (self.exists(key)){
                console.log(key);
                console.log(self);
                throw ERROR_KEY_EXISTS;
            }
            else{
                var realKey = getObjectKey();
                key[tableKeyProperty] = realKey;
                data[realKey] = "";
            }
        }

        self.init();
        delete self.init;
    }

}

DataStructure.Indexer = function(){
    var self = this;

    // Constant
    //
    //
    const DEFAULT_SIZE = 1000;

    // Attributes
    //
    //
    var nextIndex = 0;
    var availableIndicies = 0;
    var freeIndicies = [];

    // Initialization
    //
    //
    self.init = function(){
        freeIndicies.length = DEFAULT_SIZE;
    }

    // Methods
    //
    //
    self.getIndex = function(){
        var index = 0;

        if (availableIndicies === 0){
            index = nextIndex;
            ++nextIndex;
        }
        else{
            --availableIndicies;
            index = freeIndicies[availableIndicies];
        }

        return index;
    }

    self.putBackIndex = function(index){
        if (availableIndicies === freeIndicies.length)
            freeIndicies.push(index);
        else
            freeIndicies[availableIndicies] = index;

        ++availableIndicies;
    }

    self.init();
    delete self.init;
}

DataStructure.init();
delete DataStructure.init; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-23T15:51:03.043

这取决于您所说的“关联数组”是什么意思。JavaScript 中没有所谓的“关联数组”，有对象和映射。

对象是可以使用`[]`符号访问的对象，例如`foo["bar"]`，并且键必须是字符串，正如[克里斯托夫的回答](https://stackoverflow.com/a/513016/4284627)所解释的那样。

还有[maps](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)，它可以将任何对象作为键。但是，要访问它们，您不能将`[]`as 用于对象，而必须使用`get`and`set`方法。以下是如何使用它们的示例：

```
let myMap = new Map();    // Create the map
myMap.set("key", "value");    // To set a value, use the set method.
                            // The first argument is the key, the second one is the value.
myMap.set(Math, "bar");    // You can really use any object as key
myMap.set(console.log, "hello");    // Including functions
myMap.set(document.body, "world");    // And even DOM elements

// To get the value associated to a key, use the get method
console.log(myMap.get(Math));    // "bar"
console.log(myMap.get(document.body));    // "world" 
```

在此示例中，我使用内置对象作为键，以避免在定义新对象以用作键时使示例混乱，但当然可以使用您自己的对象作为键。

但是要小心，不要使用它`[]`来访问地图的元素。Doing`myMap[whatever]`是有效代码，因此不会引发错误，但不会按预期工作：

```
// Don't do this
myMap[Math] = 3;
myMap["[object Math]"] = 4;
console.log(myMap[Math]);    //4
console.log(myMap.get(Math));    // 'undefined'

// Do this instead
myMap.set(Math, 3);
myMap.set("[object Math]", 4);
console.log(myMap.get(Math));    //3 
```

要了解有关地图的更多信息，请参阅*[地图](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)*。

# sql - 在 Postgres 中爬取父/子数据库关系

> ID：512831
> 
> 赞同：6
> 
> 时间：2009-02-04T19:10:45.997
> 
> 标签：sql, postgresql, recursion

我们有以下示例表（实际上取自 stackoverflow 上的另一个示例...）

```
CREATE TABLE example (
  id integer primary key,
  name char(200),
  parentid integer,
  value integer); 
```

给定一个特定的孩子，我们希望得到最高的父母。

我知道 tablefunc connectby 函数，但那是为了让父母孩子。

但是，我对另一个方向感兴趣，给一个孩子，它的最高父母是什么？我会尝试使用什么类型的查询？

任何友好的建议表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T19:41:45.763

查看 Joe Celko 的书籍、[Smarties 的 SQL](https://rads.stackoverflow.com/amzn/click/com/0123693799)和他关于[Trees and Hierarchies](https://rads.stackoverflow.com/amzn/click/com/1558609202)的书籍。他在 SQL for Smarties 中有一两节关于树和层次结构的内容，或者如果你想真正深入了解它，那么你可以得到另一本书。Smarties 的 SQL 还将涉及许多其他数据库设计和查询信息。里面有一些非常好的东西。他提出了建模树的替代方法，这些方法比您正在使用的邻接列表模型工作得更好。

在他的一个模型中，“谁是最高的父母”这个问题变得非常琐碎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:40:06.373

您可以编写一个 PL/PgSQL 函数来执行递归：

```
CREATE LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION get_top_parent(
        child integer
) RETURNS integer as $$
DECLARE
        parent integer;
        last_parent integer;
BEGIN
        last_parent := child;
        SELECT INTO parent parentid
        FROM example
        WHERE id = child;

        IF parent is NOT NULL THEN
                parent := get_top_parent(parent);
        ELSE
                parent := last_parent;
        END IF;
        RETURN parent;
END
$$ LANGUAGE plpgsql; 
```

这个功能绝对可以优化。如果深度很高并且表很大，它可能会很慢，所以就像 Jegern 提到的那样，缓存层次结构可能是值得的，可能使用触发器等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T09:41:21.323

您可以考虑使用[“ltree”](http://www.postgresql.org/docs/current/static/ltree.html) contrib 模块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T22:00:53.987

从 PostgreSQL 8.4 开始使用递归？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T19:15:46.160

以我的经验，SQL 不太擅长这种查询（递归）。我建议创建一个带有 id 和最高父 id 的附加表。当您添加更多孩子时，您只需查找其父级的最高父级 ID 并在附加表中插入适当的行。

您还可以将顶级父 ID 存储在原始表中。

# c++ - GCC/Windows DLLs/C++ STL 前端有什么改进吗？

> ID：512841
> 
> 赞同：2
> 
> 时间：2009-02-04T19:13:57.427
> 
> 标签：c++, string, dll, gcc, libstdc++

昨天，在 Cygwin 下使用 GCC 编译的 DLL 时，我遇到了一个相当烦人的崩溃。基本上，一旦您使用调试器运行，您最终可能会陷入由 RtlFreeHeap() 接收到它未分配的地址所引起的调试陷阱。

这是Cygwin[上 GCC 3.4 的一个已知错误。](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=24196)出现这种情况是因为 libstdc++ 库包含针对空字符串的“聪明”优化。我为您省去了细节（请参阅本文中的参考资料），但是每当您在一个 DLL 中为“属于”另一个 DLL 的 std::string 对象分配内存时，您最终都会给一个堆释放一个来自另一个堆。因此**RtlFreeHeap() 中的 SIGTRAP**。

当跨 DLL 边界引发异常时，还会报告其他问题。

一旦您的项目基于 DLL 和 STL，这使得 Windows 上的 GCC 3.4 成为不可接受的解决方案。我有几个选项可以跳过这个选项，其中许多非常耗时和/或烦人：

*   我可以[修补我的 libstdc++](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=24196#c11)或使用 --enable-fully-dynamic-string配置选项[重建它](http://gcc.gnu.org/ml/libstdc++/2004-09/msg00232.html)
*   我可以改用静态库，这会增加我的链接时间

由于我正在使用其他一些工具，我也不能（还）切换到另一个编译器。我从一些 GCC 人那里得到的评论是“它几乎从未被报道过，所以这可能不是问题”，这让我更加恼火。

**有人有这方面的消息吗？**[除了GNU Radio bug tracker](http://www.gnuradio.org/trac/ticket/48)上的一条评论外，我找不到任何明确的声明表明此问题已得到修复（该错误仍被标记为“已分配”）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T21:17:20.357

您遇到的一般问题是 C++ 从来都不是真正意义上的组件语言。它实际上是为创建完整的独立应用程序而设计的。诸如共享库和其他此类机制之类的东西是由供应商自己创建的。想想这个例子：假设您创建了一个返回 C++ 对象的 C++ 组件。C++ 组件如何知道它将被 C++ 调用者使用？如果调用者是 C++ 应用程序，为什么不直接使用库呢？

当然，以上信息并不能真正帮助您。

相反，我会创建共享库/DLL，以便您遵循一些规则：

1.  由组件创建的任何对象也会被同一个组件销毁。
2.  当所有创建的对象都被销毁时，可以安全地卸载组件。

您可能必须在您的组件中创建额外的 API 来确保这些规则，但是通过遵循这些规则，它将确保不会发生类似的问题。

# wpf - 您如何在后面的代码中将添加到画布的用户控件置于前面

> ID：512847
> 
> 赞同：3
> 
> 时间：2009-02-04T19:15:43.007
> 
> 标签：wpf, vb.net, user-controls, canvas, z-order

我有一系列用户控件，它们在后面的代码中从画布中添加和删除。我需要确保某些人领先于其他人。您如何设置，曾经是 VB6 中的 ZOrder，用户控件添加到画布后的顺序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T19:27:07.133

编辑：嗯，抱歉...您必须将其转换为 VB.Net 代码...因为我只使用 WPF 在 C# 中编写代码

```
Canvas.SetZIndex(control, zIndex); 
```

[Canvas.SetZIndex()](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.setzindex(VS.95).aspx)

有关画布和 z-index 的更多信息：[Canvas.ZIndex 附加属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.zindex(VS.95).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-09T13:09:40.627

[我在那里](https://stackoverflow.com/questions/453613/how-do-i-bring-an-item-to-the-front-in-wpf/24120993#24120993)发布了一个带有代码的解决方案。这个解决方案在 WPF 中，所以如果你想要 VB，你将不得不做一些翻译。

# java - 2-D（并发）HashMap：2-property key type？哈希图的哈希图？[更新]

> ID：512850
> 
> 赞同：1
> 
> 时间：2009-02-04T19:16:00.403
> 
> 标签：java, performance, hashmap, concurrenthashmap

所以我需要一个二维的`ConcurrentHashMap`.

它必须尽可能快，因为我将非常频繁地添加和更新它的值。它在多线程应用程序中，因此选择使用 ConcurrentHashMap 而不仅仅是 HashMap。

“x”和“y”索引都是具有已知范围（0 到 40,000,000）的整数。

我需要知道的是：实现这一点的最有效方法是什么，以便尽可能快？最明显的路线是做一个文字二维哈希图：

`ConcurrentHashMap<Integer, ConcurrentHashMap<Integer, ValueObj>> foo;`

`equals()`或者我可以创建一个具有两个属性 x 和 y 的私有类“IntPair”，并将其用作键......但如果我这样做，最有效的方法是什么`hashcode()`？我最终会分配太多新`IntPair`的吗？我可以为我分配的每个 x/y保留一组`IntPair`s，然后使用纯粹的自反 equals() 以便我只检查完全相同的对象实例吗？

* * *

## 更新：

现在我已经仔细研究了 Integer.valueOf(int)，它使用的特定缓存模型在这里没有意义，因为我正在处理一个非常稀疏的矩阵，其中包含不可预测的条目。我真的需要缓存所有使用的 IntPair，而不是预先指定的子集。

直观地说，在我看来，在大地图中查找 IntPair 以查看我是否已经创建了它，实际上，与仅在大“2-D”中查找它或多或少相同ConcurrentHashMap 无论如何，不​​是吗？因此，这里的解决方案似乎真的是`new IntPair(x,y)`每次我查找密钥时都使用它。是的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:24:17.950

`ConcurrentHashMap`很大，所以你可能不想要它们的集合。

短期对象实际上分配得非常快。无论如何，您将不得不创建`Integers`吗？

您可以实习坐标对象，但仅查找的成本可能与创建它们的成本相当。真正的胜利`Integer`在于，当您将大量实例保留一段时间时，它们会共享相同的实例。

如果性能确实是一个大问题，您可以编写（或使用）将 long 映射到引用的映射类型对象。看到自定义地图也具有与坐标系相关的功能（例如查找最近的或在某个范围内），我不会感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:32:43.113

这取决于 40,000,000 x 40,000,000 矩阵中 (x,y) 点的稀疏程度。我的猜测是矩阵无论如何都会非常稀疏，所以创建很多`ConcurrentHashMap`s 会很昂贵。

相比之下，您的（不可变的）`IntPair`建议似乎更具吸引力。正如您所建议的，您甚至可以缓存其中一些对以提高性能（请[`Integer.valueOf(int)`](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html#valueOf(int))参阅了解如何使用静态嵌套类和静态工厂方法来实现这一点）。由于始终需要哈希码，因此您可以在构造函数中预先计算它并将其保存为最终字段。要计算相等，您可以对缓存中的对象使用身份相等，否则您需要单独比较 x 和 y。

[编辑](http://www.docjar.com/html/api/java/lang/Integer.java.html)：这是[`Integer.valueOf(int)`](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html#valueOf(int)).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T19:46:41.680

作为对 Zach 的回应，是的，矩阵将非常稀疏。

我查看了您链接的页面，毫无疑问， Integer.valueOf(int) 的功能将是理想的。如果我在我的`IntPair`类中开发了一个类似的静态方法，我可以假设我可以定义`equals()`为只检查严格的反身相等吗？

也就是说，我没有在该页面中看到它解释了如何使用静态嵌套类和静态工厂方法实现该功能......我只是以某种方式错过了它吗？我怎么做？

谢谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T22:13:52.307

我基于标准的 Java HashMap 做了一个 Int2DMap 实现。我发现它比使用 IntPair 作为键要快。但是，它将需要同步。

```
import java.io.*;
import java.util.*;

public class Int2DMap implements Map, Serializable {
    private static final int DEFAULT_INITIAL_CAPACITY = 16;
    private static final int MAXIMUM_CAPACITY = 1 << 30;
    private static final float DEFAULT_LOAD_FACTOR = 0.75f;
    protected Entry[] table;
    protected int size;
    protected int threshold;
    protected float loadFactor;
    protected transient volatile int modCount;

    public Int2DMap(int initialCapacity, float loadFactor) {
        if (initialCapacity < 0)
            throw new IllegalArgumentException("Illegal initial capacity: " + initialCapacity);
        if (initialCapacity > MAXIMUM_CAPACITY)
            initialCapacity = MAXIMUM_CAPACITY;
        if (loadFactor <= 0 || Float.isNaN(loadFactor))
            throw new IllegalArgumentException("Illegal load factor: " + loadFactor);
        // Find a power of 2 >= initialCapacity
        int capacity = 1;
        while (capacity < initialCapacity) {
            capacity <<= 1;
        }
        this.loadFactor = loadFactor;
        this.threshold = (int) (capacity * loadFactor);
        this.table = new Entry[capacity];
    }

    public Int2DMap(int initialCapacity) {
        this(initialCapacity, DEFAULT_LOAD_FACTOR);
    }

    public Int2DMap() {
        this(DEFAULT_INITIAL_CAPACITY, DEFAULT_LOAD_FACTOR);
    }

    public boolean containsKey(Object key) {
        int[] xy = (int[]) key;
        return containsKey(xy[0], xy[1]);
    }

    public Object get(Object key) {
        int[] xy = (int[]) key;
        return get(xy[0], xy[1]);
    }

    public Object put(Object key, Object value) {
        int[] xy = (int[]) key;
        return put(xy[0], xy[1], value);
    }

    public Object remove(Object key) {
        int[] xy = (int[]) key;
        return remove(xy[0], xy[1]);
    }

    public int size() {
        return size;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    protected static final int indexFor(int x, int y, int length) {
        return (x * 31 + y) & (length - 1);
    }

    public Object get(int x, int y) {
        for (Entry e = table[indexFor(x, y, table.length)]; e != null; e = e.next) {
            if (e.x == x && e.y == y) {
                return e.value;
            }
        }
        return null;
    }

    public boolean containsKey(int x, int y) {
        return getEntry(x, y) != null;
    }

    protected Entry getEntry(int x, int y) {
        for (Entry e = table[indexFor(x, y, table.length)]; e != null; e = e.next) {
            if (e.x == x && e.y == y) {
                return e;
            }
        }
        return null;
    }

    public Object put(int x, int y, Object value) {
        int i = indexFor(x, y, table.length);
        for (Entry e = table[i]; e != null; e = e.next) {
            if (e.x == x && e.y == y) {
                Object oldValue = e.value;
                e.value = value;
                e.recordAccess(this);
                return oldValue;
            }
        }
        modCount++;
        addEntry(x, y, value, i);
        return null;
    }

    protected void resize(int newCapacity) {
        Entry[] oldTable = table;
        int oldCapacity = oldTable.length;
        if (oldCapacity == MAXIMUM_CAPACITY) {
            threshold = Integer.MAX_VALUE;
            return;
        }
        Entry[] newTable = new Entry[newCapacity];
        transfer(newTable);
        table = newTable;
        threshold = (int) (newCapacity * loadFactor);
    }

    protected void transfer(Entry[] newTable) {
        Entry[] src = table;
        int newCapacity = newTable.length;
        for (int j = 0; j < src.length; j++) {
            Entry e = src[j];
            if (e != null) {
                src[j] = null;
                do {
                    Entry next = e.next;
                    int i = indexFor(e.x, e.y, newCapacity);
                    e.next = newTable[i];
                    newTable[i] = e;
                    e = next;
                } while (e != null);
            }
        }
    }

    public void putAll(Map m) {
        int numKeysToBeAdded = m.size();
        if (numKeysToBeAdded == 0) {
            return;
        }
        if (numKeysToBeAdded > threshold) {
            int targetCapacity = (int) (numKeysToBeAdded / loadFactor + 1);
            if (targetCapacity > MAXIMUM_CAPACITY)
                targetCapacity = MAXIMUM_CAPACITY;
            int newCapacity = table.length;
            while (newCapacity < targetCapacity)
                newCapacity <<= 1;
            if (newCapacity > table.length)
                resize(newCapacity);
        }
        for (Iterator i = m.entrySet().iterator(); i.hasNext();) {
            Map.Entry e = (Map.Entry) i.next();
            put(e.getKey(), e.getValue());
        }
    }

    public Object remove(int x, int y) {
        Entry e = removeEntryForKey(x, y);
        return (e == null ? null : e.value);
    }

    protected Entry removeEntryForKey(int x, int y) {
        int i = indexFor(x, y, table.length);
        Entry prev = table[i];
        Entry e = prev;
        while (e != null) {
            Entry next = e.next;
            Object k;
            if (e.x == x && e.y == y) {
                modCount++;
                size--;
                if (prev == e)
                    table[i] = next;
                else
                    prev.next = next;
                e.recordRemoval(this);
                return e;
            }
            prev = e;
            e = next;
        }
        return e;
    }

    protected Entry removeMapping(Object o) {
        if (!(o instanceof Entry))
            return null;
        Entry entry = (Entry) o;
        int x = entry.x;
        int y = entry.y;
        int i = indexFor(x, y, table.length);
        Entry prev = table[i];
        Entry e = prev;
        while (e != null) {
            Entry next = e.next;
            if (e.x == x && e.y == y) {
                modCount++;
                size--;
                if (prev == e)
                    table[i] = next;
                else
                    prev.next = next;
                e.recordRemoval(this);
                return e;
            }
            prev = e;
            e = next;
        }
        return e;
    }

    public void clear() {
        modCount++;
        Entry[] tab = table;
        for (int i = 0; i < tab.length; i++)
            tab[i] = null;
        size = 0;
    }

    public boolean containsValue(Object value) {
        Entry[] tab = table;
        for (int i = 0; i < tab.length; i++)
            for (Entry e = tab[i]; e != null; e = e.next)
                if (value.equals(e.value))
                    return true;
        return false;
    }

    static class Entry implements Map.Entry {
        final int x;
        final int y;
        Object value;
        Entry next;

        Entry(int x, int y, Object value, Entry next) {
            this.x = x;
            this.y = y;
            this.value = value;
            this.next = next;
        }

        public final Object getKey() {
            return new int[] { x, y };
        }

        public final Object getValue() {
            return value;
        }

        public final Object setValue(Object newValue) {
            Object oldValue = value;
            value = newValue;
            return oldValue;
        }

        public final boolean equals(Object o) {
            if (!(o instanceof Map.Entry))
                return false;
            Map.Entry e = (Map.Entry) o;
            int[] xy = (int[])e.getKey();
            if (x == xy[0] && y == xy[1]) {
                Object v1 = getValue();
                Object v2 = e.getValue();
                if (v1 == v2 || (v1 != null && v1.equals(v2)))
                    return true;
            }
            return false;
        }

        public final int hashCode() {
            return ((31 + x) * 31 + y);
        }

        public final String toString() {
            return "[" + x + ", " + y + "]=" + value;
        }

        /**
         * This method is invoked whenever the value in an entry is overwritten by
         * an invocation of put(k,v) for a key k that's already in the HashMap.
         */
        void recordAccess(Int2DMap m) {
        }

        /**
         * This method is invoked whenever the entry is removed from the table.
         */
        void recordRemoval(Int2DMap m) {
        }
    }

    void addEntry(int x, int y, Object value, int bucketIndex) {
        Entry e = table[bucketIndex];
        table[bucketIndex] = new Entry(x, y, value, e);
        if (size++ >= threshold)
            resize(2 * table.length);
    }

    private abstract class HashIterator implements Iterator {
        Entry next; // next entry to return
        int expectedModCount; // For fast-fail
        int index; // current slot
        Entry current; // current entry

        HashIterator() {
            expectedModCount = modCount;
            if (size > 0) { // advance to first entry
                Entry[] t = table;
                while (index < t.length && (next = t[index++]) == null)
                    ;
            }
        }

        public final boolean hasNext() {
            return next != null;
        }

        final Entry nextEntry() {
            if (modCount != expectedModCount)
                throw new ConcurrentModificationException();
            Entry e = current = next;
            if (e == null)
                throw new NoSuchElementException();
            if ((next = e.next) == null) {
                Entry[] t = table;
                while (index < t.length && (next = t[index++]) == null)
                    ;
            }
            return e;
        }

        public void remove() {
            if (current == null)
                throw new IllegalStateException();
            if (modCount != expectedModCount)
                throw new ConcurrentModificationException();
            int x = current.x;
            int y = current.y;
            current = null;
            Int2DMap.this.removeEntryForKey(x, y);
            expectedModCount = modCount;
        }
    }

    private final class ValueIterator extends HashIterator {
        public Object next() {
            return nextEntry().value;
        }
    }

    private final class KeyIterator extends HashIterator {
        public Object next() {
            return nextEntry().getKey();
        }
    }

    private final class EntryIterator extends HashIterator {
        public Map.Entry next() {
            return nextEntry();
        }
    }

    // Subclass overrides these to alter behavior of views' iterator() method
    Iterator newKeyIterator() {
        return new KeyIterator();
    }

    Iterator newValueIterator() {
        return new ValueIterator();
    }

    Iterator newEntryIterator() {
        return new EntryIterator();
    }

    public Set keySet() {
        return new KeySet();
    }

    private final class KeySet extends AbstractSet {
        public Iterator iterator() {
            return newKeyIterator();
        }

        public int size() {
            return size;
        }

        public boolean contains(Object o) {
            return containsKey(o);
        }

        public boolean remove(Object o) {
            int[] xy = (int[]) o;
            return Int2DMap.this.removeEntryForKey(xy[0], xy[1]) != null;
        }

        public void clear() {
            Int2DMap.this.clear();
        }
    }

    public Collection values() {
        return new Values();
    }

    private final class Values extends AbstractCollection {
        public Iterator iterator() {
            return newValueIterator();
        }

        public int size() {
            return size;
        }

        public boolean contains(Object o) {
            return containsValue(o);
        }

        public void clear() {
            Int2DMap.this.clear();
        }
    }

    public Set entrySet() {
        return new EntrySet();
    }

    private final class EntrySet extends AbstractSet {

        public Iterator iterator() {
            return newEntryIterator();
        }

        public boolean contains(Object o) {
            if (!(o instanceof Map.Entry))
                return false;
            Entry e = (Entry) o;
            Entry candidate = getEntry(e.x, e.y);
            return candidate != null && candidate.equals(e);
        }

        public boolean remove(Object o) {
            return removeMapping(o) != null;
        }

        public int size() {
            return size;
        }

        public void clear() {
            Int2DMap.this.clear();
        }
    }

    public static void main(String[] args) {                
        try {

            Int2DMap map = new Int2DMap();

            map.put(20, 6000, "Test");
            System.out.println(map.size() == 1);

            System.out.println(map.get(20, 6000) != null);

            System.out.println("Test".equals(map.get(20, 6000)));

            for (Iterator iter = map.values().iterator(); iter.hasNext();) {
                System.out.println("Test".equals(iter.next()));
            }

            for (Iterator iter = map.keySet().iterator(); iter.hasNext();) {
                int[] key = (int[])iter.next();
                System.out.println(key[0] == 20 && key[1] == 6000);
            }

            for (Iterator iter = map.entrySet().iterator(); iter.hasNext();) {
                Map.Entry e = (Map.Entry)iter.next();
                System.out.println(e.toString().equals("[20, 6000]=Test"));
            }

            map.remove(20, 6000);
            System.out.println(map.size() == 0 && map.get(20, 6000) == null);

            long start = System.nanoTime();
            int max = 40000000;
            for (int i = 0; i < 500000; i++) {
                int x = (int)(Math.random() * max);
                int y = (int)(Math.random() * max);
                map.put(x, y, "");

                int x2 = (int)(Math.random() * max);
                int y2 = (int)(Math.random() * max);
                Object o = map.get(x2, y2);

            }
            System.out.println(map.size());
            System.out.println((System.nanoTime() - start) / 1000000);

            Map map2 = new HashMap();
            start = System.nanoTime();

            for (int i = 0; i < 500000; i++) {
                String key = "" + (int)(Math.random() * max) + "," + (int)(Math.random() * max);
                map2.put(key, "");

                String key2 = "" + (int)(Math.random() * max) + "," + (int)(Math.random() * max);
                Object o = map2.get(key2);

            }
            System.out.println(map2.size());
            System.out.println((System.nanoTime() - start) / 1000000);

        } catch (Throwable t) {
            t.printStackTrace();
        }
    }
} 
```

# css - CSS：IE8 仍然无法正确呈现 CSS。有什么黑客吗？

> ID：512852
> 
> 赞同：0
> 
> 时间：2009-02-04T19:16:29.247
> 
> 标签：css

我在我的 ASP.net 中将这段 CSS 代码用于字段集

```
.important 
{
    border:1px solid #33CC00;
    padding:8px 10px 7px 20px;
}

.important 
{
    -moz-border-radius-bottomleft:4px;
    -moz-border-radius-bottomright:4px;
    -moz-border-radius-topleft:4px;
    -moz-border-radius-topright:4px;
    background:#FFFFFF none repeat scroll 0 0;
}

.important legend 
{
    -moz-border-radius-bottomleft:4px;
    -moz-border-radius-bottomright:4px;
    -moz-border-radius-topleft:4px;
    -moz-border-radius-topright:4px;
    -x-system-font:none;
    background:#F3FFF3 none repeat scroll 0 0;
    border:1px solid #33CC00;
    color:#33AA00;
    font-family:"Trebuchet MS";
    font-size:1.2em;
    font-size-adjust:none;
    font-stretch:normal;
    font-style:normal;
    font-variant:normal;
    font-weight:normal;
    line-height:normal;
    padding:1px 15px;
} 
```

它在 FireFox 上看起来不错，但在 IE7 和 IE8 上看起来像废话。我不确定如何在 IE 上解决此问题。有谁知道任何处理 IE 中的 CSS hack 的网站，或者我应该放弃，因为生命太短，不能浪费在跨浏览器兼容性上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T19:25:04.597

-moz-border-radius- 是IE 将忽略的[Mozilla 特定选择器。](https://developer.mozilla.org/en/CSS/-moz-border-radius)[border-radius](http://www.w3.org/TR/2005/WD-css3-background-20050216/#the-border-radius)是等效的 CSS3 选择器，但 IE 几乎可以肯定不支持它（Firefox 3 支持，但我似乎记得标准或[实现](http://virtuelvis.com/download/218/border-radius.html)都存在问题）

# sql-server-2005 - 如何将多个数据库合并为一个

> ID：512858
> 
> 赞同：1
> 
> 时间：2009-02-04T19:17:15.143
> 
> 标签：sql-server-2005

有没有一种简单的方法可以将两个 SQL Server 2005 数据库组合成一个数据库？我想获取数据库'A'和数据库'B'并将它们完全合并到数据库'C'中。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:21:56.350

这取决于您所说的“合并”是什么意思。如果您有两组不相交的表并希望将它们转移到同一个数据库结构中，那不是一个大问题。

如果您需要交错或转换来自 A 和/或 B 的数据，他们的方式将完全取决于您要完成的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:19:04.793

这在业务中称为“数据转换”。它本身可以是一个完整的项目，您的问题没有快速而肮脏的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:22:48.017

我不确定您是想自己执行此操作还是正在寻找可以帮助您的工具。如果后者是一个选项，请查看 RedGate 的 SQL 比较和 SQL 数据比较。这些工具将让您看到模式之间的差异（SQL 比较），以及每个数据库中的数据（SQL 数据比较）。此外，它们可免费使用 14 天，并在此期间完全正常运行。

希望这可以帮助，

斯尔詹

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T19:20:57.117

右键单击数据库并单击导出数据，然后按照向导进行操作。对另一个数据库执行相同的操作。

# wpf - 为 WPF 表单组合图像和纯色背景

> ID：512869
> 
> 赞同：8
> 
> 时间：2009-02-04T19:19:46.337
> 
> 标签：wpf, background

我有一个正在构建的 WPF 表单。我想为窗口指定一个背景图像，这很容易。但是，我还想指定一种颜色，以便图像未覆盖的表单区域为白色。我已经看到一些示例显示使用两种不同的背景画笔，但是当我尝试 VS.NET 告诉我我不能有多个画笔时。

这是我正在使用的 XAML

```
<Window x:Class="Consent.Client.Shell"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cal="http://www.codeplex.com/CompositeWPF"
    Title="Shell" WindowStyle="None" WindowState="Maximized" FontSize="24">
    <Window.Background>
        <ImageBrush AlignmentX="Left" AlignmentY="Top"  Stretch="None" TileMode="None" ImageSource="logo_header2.png" />
    </Window.Background>
    <ItemsControl Background="White" VerticalAlignment="Center" cal:RegionManager.RegionName="MainRegion" >
    </ItemsControl>
</Window> 
```

这对图像很有用，但图像未覆盖的背景是黑色的。我怎样才能让它变白？更改图像本身并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T12:11:21.177

试试这个（我删除了与问题不直接相关的所有内容，以使代码更清晰）：

```
<Window x:Class="Consent.Client.Shell"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Background="White">
   <Grid>
      <Grid.Background>
         <ImageBrush ImageSource="logo_header2.png" />
      </Grid.Background>
      <ItemsControl>
      </ItemsControl>
   </Grid>
</Window> 
```

基本上，将窗口的背景设置为图像背后的颜色，而不是在窗口中放置一个网格并为网格提供背景图像，将所有内容放在网格内而不是直接在窗口中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-29T16:16:49.923

作为[Nirs](https://stackoverflow.com/a/515650/5006592)答案的扩展。如果您想在内容周围留出边距，但让背景图像能够填满整个窗口，您还可以使用边框堆叠背景：

```
<Window x:Class="Consent.Client.Shell"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Background="White">

    <Border Padding="10">
        <Border.Background>
            <ImageBrush ImageSource="logo_header2.png" />
        </Border.Background>
     <!--<Your content >-->
    </Border>

</Window> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:38:26.550

我不确定你可以结合画笔。您可以使用 ImageBrush，或者您可以忘记“背景”并将项目堆叠在网格中：

```
<Window x:Class="Consent.Client.Shell"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cal="http://www.codeplex.com/CompositeWPF"
    Title="Shell" WindowStyle="None" WindowState="Maximized" FontSize="24">
    <Grid>
        <Image Source="logo_header2.png" Stretch="None" VerticalAlignment="Top" />
        <ItemsControl Background="White" VerticalAlignment="Center" cal:RegionManager.RegionName="MainRegion" >
        </ItemsControl>
    </Grid>
</Window> 
```

# javascript - JSON 新手，我能用这个 json 响应做什么

> ID：512875
> 
> 赞同：2
> 
> 时间：2009-02-04T19:21:20.827
> 
> 标签：javascript, json

网站返回以下 JSON 响应，我将如何使用它（在 javascript 中）？

```
[{"ID1":9996,"ID2":22}] 
```

JSON 只是返回一个数组吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T19:25:14.080

我们用：

```
function evalResponse(response) {
    var xyz123 = null;
    eval("xyz123 = " + response);
    return xyz123;
} 
```

另一种方法是简单地使用：

```
var myObj = eval(response); 
```

基本上，您必须调用`eval()`响应来创建一个 javascript 对象。这是因为当您从 AJAX 调用中获取响应时，响应本身只是一个字符串。在你`eval`之后，你就有了一个可以操纵的对象。

```
function myCallback(response) {
    var myObj = evalResponse(response);
    alert(myObj.ID1);
} 
```

您可以使用 javascript 库为您处理此问题。或者，您可以尝试自己解析字符串。`eval()`有它自己的问题，但它的工作原理。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T19:35:45.930

如果您使用[http://www.JSON.org/json2.js](http://www.JSON.org/json2.js)您可以使用它的方法 JSON.parse 将 json*字符串*作为对象检索（不使用 eval （这被认为是邪恶的）），所以在这种情况下你会使用：

```
var nwObj = JSON.parse('[{"ID1":9996,"ID2":22}]');
alert(nwObj.ID1); //=> 9996 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T19:26:39.507

它看起来像一个包含两个属性的单个对象的数组。我更希望看到像这样结构化的相同数据：

> {“ID”：[9996,22]}

然后你有一个对象包含一个包含两个元素的数组，这似乎更适合呈现的数据。然后使用 Endangered 的`evalResponse()`代码，您可以像这样使用它：

```
var responseObj = evalResponse(response);

// responseObj.ID[0] would be 9996, responseObj.ID[1] would be 22 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T19:36:13.247

我认为其他答案可能无法回答您的问题，也许您正在寻找一种使用“1 个对象数组”的方法。也许这可以帮助：

```
var arr = [{"ID1":9996,"ID2":22}];
var obj = arr[0];
var id1 = obj.ID1;
var id2 = obj.ID2; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T19:25:48.870

以下是您获取数据的方式：

```
<script type="text/javascript" >
var something = [{"ID1":9996,"ID2":22}]
alert(something[0].ID1)
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T19:27:55.853

您发布的 JSON 表示一个包含一个对象的数组，该对象具有属性 ID1 和 ID2（初始化为冒号后的相应值）。

要将字符串转换为 javascript 对象，请将其传递给 eval，如下所示：

```
var obj = eval('[{"ID1":9996,"ID2":22}]'); 
```

但是，如果您只有一个对象而不是数组，则此方法将失败，因此将其包装在括号中更安全：

```
var obj = eval('(' + jsonResponse + ')'); 
```

# java - 为什么我不能在 Java 接口中定义静态方法？

> ID：512877
> 
> 赞同：540
> 
> 时间：2009-02-04T19:21:29.737
> 
> 标签：java, interface, static-methods

**编辑：** *从 Java 8 开始，接口中现在允许使用静态方法。*

这是示例：

```
public interface IXMLizable<T>
{
  static T newInstanceFromXML(Element e);
  Element toXMLElement();
} 
```

这当然行不通。但为什么不呢？

可能的问题之一是，当你打电话时会发生什么：

```
IXMLizable.newInstanceFromXML(e); 
```

在这种情况下，我认为它应该只调用一个空方法（即{}）。所有子类都将被迫实现静态方法，因此在调用静态方法时它们都可以。那么为什么这不可能呢？

**编辑：**我想我正在寻找比“因为 Java 就是这样”更深的答案。

静态方法不能被覆盖是否有特定的技术原因？也就是说，为什么 Java 的设计者决定让实例方法可覆盖而不是静态方法？

**编辑：**我的设计问题是我正在尝试使用接口来强制执行编码约定。

也就是说，接口的目标是双重的：

1.  我希望 IXMLizable 接口允许我将实现它的类转换为 XML 元素（使用多态，工作正常）。

2.  如果有人想创建一个实现 IXMLizable 接口的类的新实例，他们总是知道会有一个 newInstanceFromXML(Element e) 静态构造函数。

除了在界面中添加评论之外，还有其他方法可以确保这一点吗？

* * *

## 回答 #1

> 赞同：558
> 
> 时间：2009-02-04T19:56:13.190

# Java 8 允许静态接口方法

在 Java 8 中，接口*可以*有静态方法。它们也可以有具体的实例方法，但不能有实例字段。

这里真的有两个问题：

1.  为什么在过去糟糕的日子里，接口不能包含静态方法？
2.  为什么不能覆盖静态方法？

# 接口中的静态方法

没有强有力的技术原因说明接口在以前的版本中不能有静态方法。重复问题[的海报很好地总结了](https://stackoverflow.com/questions/129267/why-no-static-methods-in-interfaces-but-static-fields-and-inner-classes-ok/135722#135722)这一点。静态接口方法最初被认为是[一个小的语言变化，](http://blogs.oracle.com/darcy/entry/project_coin)后来[官方提议](http://docs.google.com/Doc?docid=dfkwr6vq_30dtg2z9d8&hl=en)在 Java 7 中添加它们，但后来[由于无法预料的复杂情况而被放弃。](http://bugs.sun.com/view_bug.do?bug_id=4093687)

最后，Java 8 引入了静态接口方法，以及具有默认实现的可覆盖实例方法。他们仍然不能有实例字段。这些功能是 lambda 表达式支持的一部分，您可以在[JSR 335 的 H 部分中了解更多信息。](http://jcp.org/en/jsr/detail?id=335)

# 覆盖静态方法

第二个问题的答案有点复杂。

静态方法在编译时是可解析的。动态分派对实例方法有意义，其中编译器无法确定对象的具体类型，因此无法解析要调用的方法。但是调用静态方法需要一个类，并且由于该类是*静态*已知的——在编译时——动态调度是不必要的。

了解实例方法如何工作的一些背景知识对于理解这里发生的事情是必要的。我确信实际的实现是完全不同的，但让我解释一下我的方法分派的概念，它可以准确地模拟观察到的行为。

假设每个类都有一个哈希表，该哈希表将方法签名（名称和参数类型）映射到实际的代码块以实现该方法。当虚拟机尝试调用实例上的方法时，它会查询对象的类并在类的表中查找请求的签名。如果找到方法体，则调用它。否则，获取该类的父类，并在那里重复查找。这将继续进行，直到找到该方法，或者没有更多的父类——这会导致`NoSuchMethodError`.

如果超类和子类的表中都有相同方法签名的条目，则首先遇到子类的版本，并且永远不会使用超类的版本——这是“覆盖”。

现在，假设我们跳过对象实例并从子类开始。解决方案可以如上进行，为您提供一种“可覆盖”的静态方法。然而，解析都可以在编译时发生，因为编译器是从一个已知的类开始的，而不是等到运行时为它的类查询一个未指定类型的对象。“覆盖”静态方法没有意义，因为总是可以指定包含所需版本的类。

* * *

# 构造函数“接口”

这里有更多材料来解决最近对该问题的编辑。

听起来您想为`IXMLizable`. 暂时忘记尝试使用接口强制执行此操作，并假装您有一些满足此要求的类。你会如何使用它？

```
class Foo implements IXMLizable<Foo> {
  public static Foo newInstanceFromXML(Element e) { ... }
}

Foo obj = Foo.newInstanceFromXML(e); 
```

由于在“构造”新对象时必须显式命名具体类型`Foo`，编译器可以验证它确实具有必要的工厂方法。如果没有，那又如何？如果我可以实现一个`IXMLizable`缺少“构造函数”的实例，并且我创建一个实例并将其传递给您的代码，那么它*就是*一个`IXMLizable`具有所有必要接口的实例。

*构造是实现的一部分，*而不是接口。任何与接口一起成功工作的代码都不关心构造函数。任何关心构造函数的代码无论如何都需要知道具体类型，接口可以忽略。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-02-04T19:50:18.367

这已经被问和回答了，[here](https://stackoverflow.com/questions/129267/why-no-static-methods-in-interfaces-but-static-fields-and-inner-classes-ok/129934#129934)

复制我的答案：

在接口中声明静态方法是没有意义的。它们不能通过正常调用 MyInterface.staticMethod() 来执行。如果您通过指定实现类 MyImplementor.staticMethod() 来调用它们，那么您必须知道实际的类，因此接口是否包含它是无关紧要的。

更重要的是，静态方法永远不会被覆盖，如果你尝试这样做：

```
MyInterface var = new MyImplementingClass();
var.staticMethod(); 
```

static 的规则说必须执行在声明的 var 类型中定义的方法。因为这是一个接口，所以这是不可能的。

无法执行“result=MyInterface.staticMethod()”的原因是它必须执行 MyInterface 中定义的方法版本。但是在 MyInterface 中不能定义一个版本，因为它是一个接口。它没有定义的代码。

虽然您可以说这相当于“因为 Java 这样做”，但实际上该决定是其他设计决策的逻辑结果，也是有充分理由做出的。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-11-26T17:13:17.233

随着**Java 8**的出现，现在可以在接口 中编写**默认**方法和**静态方法。**[docs.oracle/staticMethod](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)

例如：

```
public interface Arithmetic {

    public int add(int a, int b);

    public static int multiply(int a, int b) {
        return a * b;
    }
} 
```

```
public class ArithmaticImplementation implements Arithmetic {

    @Override
    public int add(int a, int b) {
        return a + b;
    }

    public static void main(String[] args) {
        int result = Arithmetic.multiply(2, 3);
        System.out.println(result);
    }
} 
```

**结果**：6

**提示：**调用静态接口方法不需要由任何类实现。当然，这是因为超类中静态方法的相同规则适用于接口上的静态方法。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-02-13T21:37:49.037

通常这是使用工厂模式完成的

```
public interface IXMLizableFactory<T extends IXMLizable> {
  public T newInstanceFromXML(Element e);
}

public interface IXMLizable {
  public Element toXMLElement();
} 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-02-04T19:22:59.047

因为静态方法不能在子类中被覆盖，因此它们不能是抽象的。接口中的所有方法*实际上*都是抽象的。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-07-01T13:33:05.697

> 为什么我不能在 Java 接口中定义静态方法？

**实际上你可以在 Java 8 中。**

根据 Java[文档](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)：

> 静态方法是与定义它的类相关联的方法，而不是与任何对象相关联的方法。类的每个实例共享其静态方法

在 Java 8 中，接口可以有**默认方法**和**静态方法**。这使我们更容易在我们的库中组织辅助方法。我们可以将特定于接口的静态方法保留在同一个接口中，而不是在单独的类中。

## 默认方法示例：

```
list.sort(ordering); 
```

代替

```
Collections.sort(list, ordering); 
```

## 静态方法示例（来自[文档](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html#:%7E:text=static%20ZoneId%20getZoneId%20(String%20zoneString)%20%7B)本身）：

```
public interface TimeClient {
    // ...
    static public ZoneId getZoneId (String zoneString) {
        try {
            return ZoneId.of(zoneString);
        } catch (DateTimeException e) {
            System.err.println("Invalid time zone: " + zoneString +
                "; using default time zone instead.");
            return ZoneId.systemDefault();
        }
    }

    default public ZonedDateTime getZonedDateTime(String zoneString) {
        return ZonedDateTime.of(getLocalDateTime(), getZoneId(zoneString));
    }    
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-04T19:28:41.297

接口与多态性有关，多态性本质上与对象实例相关，而不是类。因此静态在接口的上下文中没有意义。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-07-05T22:54:11.227

首先，所有语言决策都是由语言创建者做出的决定。在软件工程或语言定义或编译器/解释器编写的世界中，没有任何东西说静态方法不能成为接口的一部分。我已经创建了几种语言并为它们编写了编译器——这一切都只是坐下来定义有意义的语义。我认为接口中静态方法的语义非常清楚——即使编译器必须将方法的解析推迟到运行时。

其次，我们完全使用静态方法意味着拥有包含静态方法的接口模式是有正当理由的——我不能代表你们任何人，但我经常使用静态方法。

最可能的正确答案是，在定义语言时，接口中的静态方法并不需要。Java 多年来发展了很多，这显然引起了人们的兴趣。对 Java 7 的研究表明它已上升到可能导致语言更改的程度。一方面，当我不再需要实例化一个对象时，我会很高兴，这样我就可以调用我的非静态 getter 方法来访问子类实例中的静态变量......

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-04T19:59:36.320

静态方法不像实例方法那样是虚拟的，所以我想 Java 设计者决定他们不希望它们出现在接口中。

但是您可以将包含静态方法的类放在接口中。你可以试试！

```
public interface Test {
    static class Inner {
        public static Object get() {
            return 0;
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-04T21:16:21.203

*   “是否有特定原因不能覆盖静态方法”。

让我通过填写定义为您重新提出这个问题。

*   “是否有特殊原因导致在编译时解析的方法无法在运行时解析。”

或者，更完整地说，如果我想调用一个没有实例但知道类的方法，如何根据我没有的实例来解决它。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-06-15T10:29:18.640

评论`EDIT: As of Java 8, static methods are now allowed in interfaces.`

没错，接口中允许使用 Java 8 以来的静态方法，但您的示例仍然无法正常工作。你不能只定义一个静态方法：你必须实现它，否则你会得到一个编译错误。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-04T20:40:48.093

几个答案讨论了可覆盖静态方法概念的问题。但是，有时您会遇到一种看起来正是您想要使用的模式。

例如，我使用具有值对象的对象关系层，但也具有用于操作值对象的命令。由于各种原因，每个值对象类都必须定义一些静态方法，让框架找到命令实例。例如，要创建一个 Person 你会做：

```
cmd = createCmd(Person.getCreateCmdId());
Person p = cmd.execute(); 
```

并通过 ID 加载 Person 你会做

```
cmd = createCmd(Person.getGetCmdId());
cmd.set(ID, id);
Person p = cmd.execute(); 
```

这相当方便，但也有问题；值得注意的是静态方法的存在不能在接口中强制执行。接口中的一个可覆盖的静态方法正是我们所需要的，只要它能够以某种方式工作。

EJB 通过 Home 接口解决了这个问题；每个对象都知道如何找到它的 Home 并且 Home 包含“静态”方法。这样，可以根据需要覆盖“静态”方法，并且您不会将普通（称为“远程”）接口与不适用于 bean 实例的方法混淆。只需让普通接口指定一个“getHome()”方法即可。返回 Home 对象的一个​​实例（我想它可能是一个单例），调用者可以执行影响所有 Person 对象的操作。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-08-20T06:23:40.707

```
Why can't I define a static method in a Java interface? 
```

接口中的所有方法都是显式抽象的，因此您不能将它们定义为静态，因为静态方法不能是抽象的。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-04T19:27:39.940

好吧，没有泛型，静态接口就毫无用处，因为所有静态方法调用都是在编译时解决的。所以，它们没有真正的用处。

使用泛型，它们可以使用——有或没有默认实现。显然需要覆盖等等。但是，我的猜测是，这种用法不是很 OO（正如其他答案所指出的那样），因此不值得他们为有效实现所需付出的努力。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-02-14T12:22:47.460

永远不能静态地取消引用接口，例如`ISomething.member`. 接口总是通过引用接口子类实例的变量来取消引用。因此，如果没有子类的实例，接口引用永远无法知道它引用的是哪个子类。

因此，与接口中的静态方法最接近的方法是忽略“this”的非静态方法，即不访问实例的任何非静态成员。在低级抽象中，每个非静态方法（在任何 vtable 中查找之后）实际上只是一个具有类范围的函数，它将“this”作为隐式形式参数。请参阅[Scala 的单例对象和与 Java 的互操作性](http://blogs.oracle.com/sundararajan/entry/scala_for_java_programmers)作为该概念的证据。因此，每个静态方法都是一个具有类范围的函数，它不带“this”参数。因此，通常可以静态调用静态方法，但如前所述，接口没有实现（是抽象的）。

因此，要最接近接口中的静态方法，就是使用非静态方法，然后不要访问任何非静态实例成员。任何其他方式都不可能带来性能优势，因为无法静态链接（在编译时） a `ISomething.member()`. 我在接口中看到静态方法的唯一好处是它不会输入（即忽略）隐式“this”，因此不允许访问任何非静态实例成员。这将隐式声明不访问“this”的函数是不可变的，甚至就其包含的类而言甚至不是只读的。但是在接口中声明“静态”`ISomething`也会混淆试图访问它的人`ISomething.member()`这会导致编译器错误。我想如果编译器错误足够解释，它会比试图教育人们使用非静态方法来完成他们想要的更好（显然主要是工厂方法），就像我们在这里所做的那样（并且已经重复了 3本网站的问答时间），因此这显然是一个对许多人来说并不直观的问题。我不得不考虑一段时间才能得到正确的理解。

在接口中获取可变静态字段的方法是在接口中使用非静态 getter 和 setter 方法来访问子类中的静态字段。旁注，显然不可变的静态可以在 Java 接口中声明`static final`。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-04T19:23:34.473

接口只是提供一个类将提供的东西的列表，而不是这些东西的实际实现，这就是你的静态项目。

如果您想要静态，请使用抽象类并继承它，否则，请删除静态。

希望有帮助！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-04T19:35:55.557

您不能在接口中定义静态方法，因为静态方法属于类而不属于类的实例，并且接口不是类。[在这里阅读更多。](http://java.sun.com/docs/books/tutorial/java/javaOO/classvars.html)

但是，如果你愿意，你可以这样做：

```
public class A {
  public static void methodX() {
  }
}

public class B extends A {
  public static void methodX() {
  }
} 
```

在这种情况下，您拥有的是两个具有 2 个不同的静态方法的类，称为 methodX()。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-13T16:04:34.410

假设你能做到；考虑这个例子：

```
interface Iface {
  public static void thisIsTheMethod();
}

class A implements Iface {

  public static void thisIsTheMethod(){
    system.out.print("I'm class A");
  }

}

class B extends Class A {

  public static void thisIsTheMethod(){
    System.out.print("I'm class B");
  } 
}

SomeClass {

  void doStuff(Iface face) {
    IFace.thisIsTheMethod();
    // now what would/could/should happen here.
  }

} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-10-03T14:43:33.147

可以实现的是静态接口（而不是接口中的静态方法）。所有实现给定静态接口的类都应该实现相应的静态方法。您可以使用从任何 Class clazz 获取静态接口 SI

```
SI si = clazz.getStatic(SI.class); // null if clazz doesn't implement SI
// alternatively if the class is known at compile time
SI si = Someclass.static.SI; // either compiler errror or not null 
```

然后你可以打电话`si.method(params)`。这将很有用（例如对于工厂设计模式），因为您可以从编译时未知类中获取（或检查）SI 静态方法的实现！动态调度是必要的，您可以通过扩展类的静态方法（如果不是最终方法）（通过静态接口调用时）来覆盖它。显然，这些方法只能访问其类的静态变量。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-05-20T19:10:56.913

虽然我意识到 Java 8 解决了这个问题，但我想我会加入我目前正在处理的场景（锁定使用 Java 7），其中能够在接口中指定静态方法会很有帮助。

我有几个枚举定义，其中我定义了“id”和“displayName”字段以及出于各种原因评估值的辅助方法。实现一个接口可以让我确保 getter 方法就位，但不是静态辅助方法。作为一个枚举，确实没有一种干净的方法可以将辅助方法卸载到继承的抽象类或类似的东西中，因此必须在枚举本身中定义这些方法。也因为它是一个枚举，你永远不能真正将它作为实例对象传递并将其视为接口类型，但是能够通过接口要求存在静态帮助方法是我喜欢的Java 8 支持它。

这是说明我的观点的代码。

接口定义：

```
public interface IGenericEnum <T extends Enum<T>> {
    String getId();
    String getDisplayName();
    //If I was using Java 8 static helper methods would go here
} 
```

一个枚举定义的示例：

```
public enum ExecutionModeType implements IGenericEnum<ExecutionModeType> {
    STANDARD ("Standard", "Standard Mode"),
    DEBUG ("Debug", "Debug Mode");

    String id;
    String displayName;

    //Getter methods
    public String getId() {
        return id;
    }

    public String getDisplayName() {
        return displayName;
    }

    //Constructor
    private ExecutionModeType(String id, String displayName) {
        this.id = id;
        this.displayName = displayName;
    }

    //Helper methods - not enforced by Interface
    public static boolean isValidId(String id) {
        return GenericEnumUtility.isValidId(ExecutionModeType.class, id);
    }

    public static String printIdOptions(String delimiter){
        return GenericEnumUtility.printIdOptions(ExecutionModeType.class, delimiter);
    }

    public static String[] getIdArray(){
        return GenericEnumUtility.getIdArray(ExecutionModeType.class);
    }

    public static ExecutionModeType getById(String id) throws NoSuchObjectException {
        return GenericEnumUtility.getById(ExecutionModeType.class, id);
    }
} 
```

通用枚举实用程序定义：

```
public class GenericEnumUtility {
    public static <T extends Enum<T> & IGenericEnum<T>> boolean isValidId(Class<T> enumType, String id) {       
        for(IGenericEnum<T> enumOption : enumType.getEnumConstants()) {
            if(enumOption.getId().equals(id)) {
                return true;
            }
        }

        return false;
    }

    public static <T extends Enum<T> & IGenericEnum<T>> String printIdOptions(Class<T> enumType, String delimiter){
        String ret = "";
        delimiter = delimiter == null ? " " : delimiter;

        int i = 0;
        for(IGenericEnum<T> enumOption : enumType.getEnumConstants()) {
            if(i == 0) {
                ret = enumOption.getId();
            } else {
                ret += delimiter + enumOption.getId();
            }           
            i++;
        }

        return ret;
    }

    public static <T extends Enum<T> & IGenericEnum<T>> String[] getIdArray(Class<T> enumType){
        List<String> idValues = new ArrayList<String>();

        for(IGenericEnum<T> enumOption : enumType.getEnumConstants()) {
            idValues.add(enumOption.getId());
        }

        return idValues.toArray(new String[idValues.size()]);
    }

    @SuppressWarnings("unchecked")
    public static <T extends Enum<T> & IGenericEnum<T>> T getById(Class<T> enumType, String id) throws NoSuchObjectException {
        id = id == null ? "" : id;
        for(IGenericEnum<T> enumOption : enumType.getEnumConstants()) {
            if(id.equals(enumOption.getId())) {
                return (T)enumOption;
            }
        }

        throw new NoSuchObjectException(String.format("ERROR: \"%s\" is not a valid ID. Valid IDs are: %s.", id, printIdOptions(enumType, " , ")));
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-09-19T13:54:23.907

假设接口中允许使用静态方法： * 它们将强制所有实现类声明该方法。* 接口通常会通过对象使用，因此唯一有效的方法是非静态方法。* 任何知道特定接口的类都可以调用其静态方法。因此，将在下面调用实现类的静态方法，但调用者类不知道是哪个。怎么知道？它没有实例化来猜测！

接口被认为是在处理对象时使用的。这样，一个对象是从一个特定的类中实例化的，所以最后一个问题就解决了。调用类不需要知道哪个特定类是因为实例化可以由第三个类完成。所以调用类只知道接口。

如果我们希望将其扩展到静态方法，我们应该可以在之前指定一个实现类，然后将引用传递给调用类。这可以通过接口中的静态方法使用该类。但是这个引用和一个对象有什么区别呢？我们只需要一个对象来表示它是什么类。现在，该对象代表旧类，并且可以实现包括旧静态方法的新接口——这些现在是非静态的。

元类用于此目的。你可以试试 Java 类。但问题是 Java 对此不够灵活。您不能在接口的类对象中声明方法。

这是一个元问题 - 当你需要做的时候

..胡说八道

无论如何，您有一个简单的解决方法 - 使该方法具有相同的逻辑非静态。但是你必须首先创建一个对象来调用该方法。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-10-29T09:10:26.657

解决这个问题：错误：缺少方法体，或声明抽象静态无效主（字符串[] args）；

```
interface I
{
    int x=20;
    void getValue();
    static void main(String[] args){};//Put curly braces 
}
class InterDemo implements I
{
    public void getValue()
    {
    System.out.println(x);
    }
    public static void main(String[] args)
    {
    InterDemo i=new InterDemo();
    i.getValue();   
    }

} 
```

输出：20

现在我们可以在接口中使用静态方法

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2009-02-04T20:35:31.800

我认为 java 没有静态接口方法，因为您不需要它们。你可能认为你这样做了，但是......你会如何使用它们？如果你想这样称呼他们

```
MyImplClass.myMethod() 
```

那么你不需要在接口中声明它。如果你想这样称呼他们

```
myInstance.myMethod() 
```

那么它不应该是静态的。如果您实际上要使用第一种方式，但只是想强制每个实现都具有这样的静态方法，那么它实际上是一种编码约定，而不是实现接口的实例和调用代码之间的约定。

接口允许您在实现接口的类实例和调用代码之间定义契约。而java帮助你确保这个契约没有被违反，所以你可以依赖它，不用担心什么类实现了这个契约，只要“签了契约的人”就足够了。如果是静态接口，您的代码

```
MyImplClass.myMethod() 
```

不依赖每个接口实现都有这个方法，所以不需要java帮你确定。

* * *

## 回答 #24

> 赞同：-5
> 
> 时间：2013-04-04T11:06:52.610

接口中需要静态方法是什么，当您不必创建对象实例时基本上使用静态方法接口的整个想法是引入OOP概念并引入静态方法，您正在转移概念。

# language-agnostic - 您如何确定以正确的方式做某事是否会妨碍您？

> ID：512878
> 
> 赞同：4
> 
> 时间：2009-02-04T19:21:48.470
> 
> 标签：language-agnostic

我有一个可怕的习惯，实际上是我此刻正在努力解决的问题，当我想到更好的方法来做某事时——要么重构，要么看起来更酷的东西，或者更好的用户体验，我只需要这样做。即使这会花费我时间而且我正处于时间紧缩状态。我不知道什么时候该说，“不，我没时间做这个，我以后可以做。”

有你画的线吗？

就像现在我需要一种方法来显示数据库中的杂志文章。最简单的方法是创建一个新的 .aspx 页面并传递文章 ID。令人敬畏的方式将是显示文章的模式中的 jquery 淡入淡出。至少我是这么认为的。不是大师，我会花更长的时间来写。我们将在下周推出，没有时间再胡说八道了。但是，我就是不能让自己轻松地做到这一点。

还有其他人遇到这个问题吗？想知道更有经验的程序员是否有一些智慧可以分享。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T19:25:18.557

我会先走快速路线。

编写一个 ASPX 页面，该页面显示基于 ID 的文章，或者更酷且对 SEO 更友好的 slug。您将能够按时完成任务。然后，我将从很棒的 jQuery 方式开始。

这样做的好处是您将有一个后备选项，以防用户禁用了 JavaScript。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T19:24:56.203

你说的是“镀金”。对于软件开发人员来说，这是一个非常普遍且众所周知的问题。

来自StackOverflow的[光荣创始人本人：](http://www.codinghorror.com/blog/archives/000150.html)

> 30：显影剂镀金。开发人员对新技术着迷，有时急于尝试他们的语言或环境的新功能，或者创建他们自己在另一个产品中看到的巧妙功能的实现——无论他们的产品是否需要它。设计、实施、测试、记录和支持不需要的功能所需的工作会延长时间表。

解决这个问题的正确方法是自愿做很多工作，以至于你没有时间把它做好，更不用说添加额外的花里胡哨了。:)

编辑：其他“经典错误”链接[在这里](http://www.stevemcconnell.com/rdenum.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:25:07.997

我认为这只是确定优先事项的问题。另外，如果您的客户或老板不希望您以华而不实的方式做事，而您真的没有时间以华而不实的方式来做，那就用简单的方式，然后回来升级到华而不实你以后有时间。当您完成他们交给您的工作，然后继续改进工作时，客户和老板通常会更快乐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T19:27:45.807

我看看我还剩下多少时间，如果我感到压力很大，我不会冒险超出我的专业领域。我完全赞成正确而优雅地做这件事，但现实情况是，大多数情况下，最后期限优先，而且我知道如果我在被按下时留在我的舒适区，我很可能会犯更少的错误，这意味着我保存了 QA人们测试事物的时间。

话虽如此，我不止一次知道要突破可以做多少的极限。如果你还没有大量加班，你总是可以多花点时间来走更艰难的路。是的，这样做可能会给额外的人带来更多的工作，但有时这就是拥有最好的应用程序或拥有第一个失败者之间的区别。

我的另一个建议是不要尝试两种选择。如果您创建一个基本版本，请坚持使用它并继续前进。如果你尝试两者都做，最后你真的是在浪费时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T19:40:25.000

正确的方法是让它发挥作用，以便用户可以获得他们寻求的信息。设计师的方式是让它工作，但也让 javascript 点亮并移动。

最好的方法是让它正常工作，然后修改它。如果您知道在哪里放置东西，则不应该涉及太多重构。显然，检索文章将是业务/应用程序逻辑，而实际花哨的设计（如淡入淡出/动画）将是设置的设计/视图方面的一部分。这些部分应该能够坐下来，并且对其他部分在做什么一无所知——它们不应该紧密耦合。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T05:45:37.073

In **[test driven development](http://en.wikipedia.org/wiki/Test-driven_development)** approach, when you implement a feature by writing a test for it and implementing it the easiest possible way, you will be able to go back and do it "right" only when you find really ***need*** to do so. Knowing this allows you to avoid overdesign. And often, you find you won't need to after all.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T19:27:24.293

听起来像是典型的特征蠕变。说服自己现在提出一个功能想法以赶上最后期限与简单地完全放弃该功能是完全不同的。您可以在发布几个月后重新使用它并添加新功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T19:30:00.157

我想你已经在那里回答了你自己的问题。你说添加这个功能会花费太多时间，而且你正处于时间紧迫的状态，下周就要发布了。我认为很明显你需要走“简单”的路线。

您基本上是在描述功能蠕变。[http://en.wikipedia.org/wiki/Featuritis](http://en.wikipedia.org/wiki/Featuritis)

你需要约束自己，我在你的位置上要做的就是记录我想要添加的新功能，并在你脱离紧缩模式后，当你有时间工作时实施它。您显然知道添加此功能会花费您的时间，并且很可能会阻碍该产品的发布，您只需要有纪律来确定优先级并坚持下去。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T19:31:26.907

我认为，如果每个开发人员都对编程感兴趣并且不只是将编码作为在朝九晚五的办公室工作中赚钱的一种方式，那么每个开发人员都会遇到这个问题。

这是我的建议：列出您在编写代码时想到的每件很酷的事情。在你有一个**工作的基本版本**之后，将它提交到你的源存储库。

现在，如果您还有时间，请返回并做尽可能多的酷事情。如果您将不得不认真修改代码，请使用分支标签。

一旦你的时间用完了，如果你在做敏捷，把剩下的写成故事，交给你的项目经理或客户。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T19:36:01.453

我认为当您说您正在以“正确的方式”做某事时，这意味着质量与写入速度之间的平衡。

如果您尽可能地制作高质量的东西，但从不发布它，那不是“正确的方式”。另一方面，如果你写的是废话，但写得非常快，那也不是“正确的方法”。要以“正确的方式”做某事，您必须平衡这两者。

想到的一个经济短语是“质量、价格或生产速度，选择两个”。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T20:00:06.193

这样的事情曾经绝对要了我的命！

这是我的建议：

*   做简单的方法（带有 id 参数的 aspx）
*   写一个小概念证明给客户看

稍后向客户展示工作页面和概念证明，并估计需要多长时间。设计原型的经验将使您更好地了解所涉及的内容、如何做以及真正需要多长时间。概念证明还可以告知维护开发人员什么是什么（衰落与逻辑），并允许他们在衰落机制或逻辑被破坏时进行隔离。

就个人而言，我会远离褪色的东西。根据我的经验，客户不会看到褪色功能的附加价值，恕我直言，将其分离到另一个页面将更容易维护。我相信以后它会不太容易出现错误，因为两页的代码不会混合到一页上（如果我理解正确的话）。

# asp.net - 如何有效地使用 DTO 对象（Data Transfer Objects）？

> ID：512880
> 
> 赞同：2
> 
> 时间：2009-02-04T19:22:22.993
> 
> 标签：asp.net, design-patterns, oop, dto

实施 DTO 的最佳方式是什么？

我的理解是它们是在对象之间传输数据的一种方式。例如，在 ASP.Net 应用程序中，您可能使用 DTO 将数据从代码隐藏发送到业务逻辑层组件。

其他选项呢，比如将数据作为方法参数发送？（这在要发送的数据较少的情况下最容易吗？）

一个只保存数据的静态类，可以被其他对象引用（一种全局汇编数据存储类）呢？（这是否会过多地破坏封装？）

每次传输都使用一个通用 DTO 怎么样？使用起来可能有点麻烦，但减少了需要使用的类的数量（减少了对象混乱）。

感谢您分享您的想法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T19:31:47.483

我使用 DTO 来：

*   在标准 3 层应用程序的 UI 和服务层之间传递数据。
*   将数据作为方法参数传递以封装大量（5+）参数。

“一个 DTO 来统治它们”方法可能会变得混乱，最好的办法是为每个特性/特性组使用特定的 DTO，注意命名它们，以便它们易于在它们所使用的特性之间进行匹配。

我从未以您提到的方式看到过静态 DTO，并且会犹豫创建您所描述的 DTO 单例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T19:27:40.643

我保持简单并将一个 DTO 类映射到一个数据库表。它们很轻，所以我可以将它们发送到任何地方，包括通过电线发送。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-21T09:37:56.660

我希望它可以这么简单。尽管 DTO 源于系统的网络分布层，但如果将域对象返回到视图层，则可能会出现大量问题。这里是其中的一些：

1.通过将域对象暴露给视图层，视图可以了解域对象的结构，这让视图可以对相关对象如何可用做出一些假设。例如，如果域对象“Person”被返回到它“绑定”到的视图，而在其他一些视图上，Person 的“地址”将被绑定，应用程序层将倾向于使用类似的语义person.getAddresse() woukd 失败，因为此时地址域对象可能尚未加载。本质上，随着域对象对视图层可用，视图总是可以对数据如何可用做出假设。

2.) 当域对象绑定到视图时（在胖客户端中更是如此），以视图为中心的逻辑总是会潜入这些对象中，使它们在逻辑上被破坏。

基本上，根据我的经验，我已经看到使域对象可用于视图会产生架构问题，但是使用 DTO 也存在问题，因为使用 DTO 在创建汇编程序（DTO 到域对象和反向）方面会产生额外的工作，类似的对象，例如 Patient 域对象、Patient DTO 以及可能绑定到视图的 Patient bean。

显然，在一个胖客户端系统中，这个问题没有正确的答案。

我借用了这个简短但不完整但对 DTO 陈词滥调的真实答案：
[http ://www.theserverside.com/discussions/thread.tss?thread_id=32389#160505](http://www.theserverside.com/discussions/thread.tss?thread_id=32389#160505)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T19:41:47.853

我认为使用 DataSet/DataTable 作为“一个 DTO 来统治它们”是很常见的。很容易从数据库中加载它们，并将值持久化，并且它们可以很容易地序列化。

我肯定会说它们使用起来更麻烦。它们确实提供了所有的管道，但是针对它们进行编程是一种痛苦（大量的强制转换、空检查、魔术字符串等）。看到一组很好的扩展方法使使用它们更“自然”会很有趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T23:23:00.963

DTO 用于通过线路而不是对象之间发送数据。看看这篇文章： [POCO vs DTO](https://stackoverflow.com/questions/725348/poco-vs-dto/725365#725365)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T18:28:14.147

感谢所有有用的想法...

总结+我对此的看法：

--如果要移动的数据量很少，而且要移动的地方不多，则常规参数可能就足够了

--如果有很多数据和/或许多对象要移动到，特别创建的对象可能是最简单的（DTO 对象）。

——一个可以被各种对象引用（而不是传递）的全局数据对象似乎不受欢迎……但是，我想知道在特定的子系统中是否有时没有它的位置？这是减少数据传递量的一种方法。它确实推动了“良好封装”的极限，但是在特定层内的特定实例中，也许它可以为特定的类组合增加简单性。因此，一个人将失去类级别的封装，但仍可能具有程序集级别的封装。

# python - 大型数据结构操作/处理中的内存使用

> ID：512893
> 
> 赞同：4
> 
> 时间：2009-02-04T19:25:03.923
> 
> 标签：python, data-structures, memory-leaks, garbage-collection

我有一些我经常处理的大型（~100 Mb）文件。虽然我试图在处理过程中删除不需要的数据结构，但内存消耗有点太高了。我想知道是否有一种方法可以有效地处理大数据，例如：

```
def read(self, filename):
    fc = read_100_mb_file(filename)
    self.process(fc)
def process(self, content):
    # do some processing of file content 
```

是否存在重复的数据结构？使用像 self.fc 这样的类范围属性不是更节省内存吗？

我什么时候应该使用垃圾收集？`del fc`我知道 gc 模块，但是例如在我之后调用它吗？

**update**
ps 100 Mb 本身不是问题。但是浮点转换，进一步处理显着增加了工作集和虚拟大小（我在 Windows 上）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T13:09:36.147

我建议查看[David Beazley](http://www.dabeaz.com/generators/)关于在 Python 中使用生成器的演示文稿。这种技术允许您快速处理大量数据并进行复杂的处理，而且不会占用大量内存。IMO，诀窍不是尽可能有效地在内存中保存大量数据；诀窍是避免同时将大量数据加载到内存中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T19:29:07.503

在开始使用垃圾收集器之前，您可能可以通过使用内存映射文件对象来避免将整个文件加载到内存中的 100mb 命中。请参阅[mmap](http://docs.python.org/library/mmap.html)模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T19:32:48.043

不要一次读取整个 100 meg 文件。使用流一次处理一点。查看这篇关于处理大型 csv 和 xml 文件的博客文章。 [http://lethain.com/entry/2009/jan/22/handling-very-large-csv-and-xml-files-in-python/](http://lethain.com/entry/2009/jan/22/handling-very-large-csv-and-xml-files-in-python/)

这是文章中的代码示例。

```
from __future__ import with_statement # for python 2.5

with open('data.in','r') as fin:
    with open('data.out','w') as fout:
        for line in fin:
            fout.write(','.join(line.split(' '))) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T19:56:08.357

因此，根据您的评论，我假设您的文件看起来像这样：

```
item1,item2,item3,item4,item5,item6,item7,...,itemn 
```

通过重复应用某些组合功能，您都可以将其减少为单个值。作为一种解决方案，一次只读取一个值：

```
def read_values(f):
    buf = []
    while True:
        c = f.read(1)
        if c == ",":
            yield parse("".join(buf))
            buf = []
        elif c == "":
            yield parse("".join(buf))
            return
        else:
            buf.append(c)

with open("some_file", "r") as f:
     agg = initial
     for v in read_values(f):
         agg = combine(agg, v) 
```

这样，内存消耗保持不变，除非`agg`随时间增长。

1.  提供适当的实现`initial`，`parse`和`combine`
2.  不要逐字节读取文件，而是在固定缓冲区中读取，从缓冲区中解析并根据需要读取更多内容
3.  这基本上是内置`reduce`函数所做的，但为了清楚起见，我在这里使用了一个显式的 for 循环。这是同样的事情`reduce`：

    ```
    with open("some_file", "r") as f:
        agg = reduce(combine, read_values(f), initial) 
    ```

我希望我正确地解释了你的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T00:22:10.767

首先，不要碰垃圾收集器。这不是问题，也不是解决方案。

听起来您遇到的真正问题根本不是文件读取，而是您在处理文件时分配的数据结构。考虑使用*del*删除处理过程中不再需要的结构。此外，您可能会考虑在处理下一个 100mb 的输入文件时使用*marshal*将一些已处理的数据转储到磁盘。

对于文件读取，您基本上有两种选择：作为流的 unix 样式文件，或内存映射文件。对于基于流的文件，默认的 python 文件对象已经被缓冲，所以最简单的代码也可能是最有效的：

```
  使用 open("filename", "r") 作为 f：
    对于 f 中的行：
       # 对一行文件做一些事情

```

或者，您可以使用 f.read([size]) 读取文件块。但是，通常您这样做是为了获得 CPU 性能，通过对脚本的处理部分进行多线程处理，以便您可以同时读取和处理。但这对内存使用没有帮助；事实上，它使用更多的内存。

另一个选项是 mmap，如下所示：

```
  使用 open("filename", "r+") 作为 f：
    地图 = mmap.mmap(f.fileno(), 0)
    line = map.readline()
    而线！=''：
       # 处理一行
       line = map.readline()

```

这有时优于流，但也不会提高内存使用率。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T23:54:11.357

在您的示例代码中，数据存储在`fc`变量中。如果您不保留对周围的引用，则当方法结束`fc`时，您的整个文件内容将从内存中删除。`read`

如果它们不是，那么**您将在某处保留参考**。也许引用正在创建`read_100_mb_file`，也许在`process`. 如果没有引用，CPython 实现将几乎立即释放它。

有一些工具可以帮助您找到此参考的位置， [guppy](http://guppy-pe.sourceforge.net/)、[dowser](http://www.aminus.net/wiki/Dowser)、[pysizer](http://pysizer.8325.org/) ...

# c# - WPF 保持键盘焦点

> ID：512902
> 
> 赞同：4
> 
> 时间：2009-02-04T19:26:29.583
> 
> 标签：c#, wpf, keyboard, focus

我正在创建一个`UserControl`由 a`TextBox`和 a组成的`ListView`。`TextBox`只要控件具有键盘焦点，我希望键盘焦点保持不变（`ListView`不应该从 中删除键盘焦点的选择更改`TextBox`）。

我已经尝试捕获`GotKeyboardFocus`并将`ListView`键盘焦点传递回`TextBox`using`Keyboard.Focus(),`但这似乎取消了`ListView`. 下面的代码显示了问题。有谁知道如何实现这个功能？

```
<Window x:Class="WpfApplication5.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <TextBox x:Name="TextBox1" />
        <ListView x:Name="ListBox1" Keyboard.GotKeyboardFocus="ListBox1_GotKeyboardFocus">
            <ListViewItem Content="Able" />
            <ListViewItem Content="Baker" />
            <ListViewItem Content="Charlie" />
        </ListView>
    </StackPanel>
</Window> 
```

* * *

```
using System.Windows;
using System.Windows.Input;

namespace WpfApplication5
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }

        private void ListBox1_GotKeyboardFocus(object sender, KeyboardFocusChangedEventArgs e)
        {
            Keyboard.Focus(TextBox1);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T20:49:50.150

相反，您是否考虑过仅捕获击键并将这些击键放入 TextBox 中？

```
<Window PreviewKeyDown="Window_PreviewKeyDown" >
    <Grid>
        <TextBox x:Name="TextBox1" />
        <ListBox />
    </Grid>
</Window> 
```

然后在您窗口的代码隐藏中：

```
private void Window_PreviewKeyDown(object sender, KeyEventArgs e)
{
   TextBox1.Text += e.Key.ToString();
} 
```

您必须为特殊字符（退格等）之类的任何东西做额外的工作，显然还有一个用于“Enter”或“Post”操作的 Key 处理程序，但它使您能够在 Window 时自由输入有焦点并在必要时正确处理击键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T21:20:52.350

看起来可以在 MouseUp 事件中更改焦点。我认为如果你做得太早，比如在 GotKeyboardFocus 事件中，你会在 listview 处理事件并选择所选项目之前窃取焦点。

```
<StackPanel>
    <TextBox x:Name="TextBox1" />
    <ListView x:Name="ListBox1" MouseUp="ListBox1_MouseUp">
        <ListViewItem Content="Able" />
        <ListViewItem Content="Baker" />
        <ListViewItem Content="Charlie" />
    </ListView>
</StackPanel>

private void ListBox1_MouseUp(object sender, MouseButtonEventArgs e)
{
    TextBox1.Focus();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-17T20:11:11.047

如果你从 WinForm 调用你的 WPF 窗口，你必须使用这个：

```
System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop(wpfWindow);
wpfWindow.show(); 
```

来自[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.enablemodelesskeyboardinterop.aspx)。

这就是我解决键盘问题的方法。

冰X

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T19:29:25.880

这是一个 hack，但是如果您不听 GotKeyboardFocus 事件，而是听 ListBox 上的 SelectionChanged 事件怎么办？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T16:20:08.807

将 Focusable=false 放在您的 ListView 上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-07T01:41:01.747

好吧，这让我发疯了。即使将焦点设置为`UserControl`每次失去焦点，仍然无法让我的命令热键工作。我所要做的就是将属性设置`Focusable`为`true`，瞧，它正在工作！

# repository - Debian：如何从另一个存储库中提取具有依赖关系的单个包？

> ID：512906
> 
> 赞同：11
> 
> 时间：2009-02-04T19:27:07.820
> 
> 标签：repository, debian, package, apt

我在 debian etch 上，我想从测试中提取 subversion1.5.1，尽管它是一台生产机器。我需要把风险降到最低。

有什么提示吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-04T20:11:19.260

只需将测试存储库添加到您的 sources.list 并将测试包的优先级固定到一个非常低的值：

将以下内容添加到 /etc/apt/preferences：

```
Package: *
Pin: release a=testing
Pin-Priority: 200 
```

200 表示测试中的新包仍会覆盖不稳定的本地包（本地始终为 100），但也不会覆盖稳定库中的包。

阅读 apt_preferences(5) 了解更多关于固定的信息。

然后，您可以通过以下方式从测试中安装软件包

```
$ apt-get install -t testing $some_package 
```

但它们不会通过正常的升级操作安装，或者在使用 apt 安装时不会是默认设置。

# sql - 缓慢的 MySQL 查询。我应该索引什么？

> ID：512909
> 
> 赞同：1
> 
> 时间：2009-02-04T19:27:26.727
> 
> 标签：sql, mysql, indexing

每次保存页面编辑时，PHPWiki 都会有 5 秒的慢查询。“mysql-slow.log”中经常出现的查询是：

```
INSERT INTO wikiscore 
SELECT w1.topage, COUNT(*) 
FROM wikilinks AS w1, wikilinks AS w2 
WHERE w2.topage=w1.frompage 
GROUP BY w1.topage; 
```

目前的指标如下：

```
table "wikilinks" has a primary index on "frompage" and "topage" 
table "wikiscore" has a primary index on "pagename" and "score" 
```

如何重新制定 SELECT 查询以更快地返回相同的结果？我如何更改索引以便此查询更快？我的想法是它可能被过度索引了吗？

我只对查询的 SELECT 部分的结果进行了计时，仅需要 1-2 秒。INSERT 必须占用剩下的时间。

保存我想消除的页面时存在延迟。由于已经完成的修改量，我没有升级到另一个 wiki 引擎（或 PHPwiki 版本）的选项。

有任何想法吗？

编辑 - -

查询的 SELECT 部分的“EXPLAIN”结果是：

```
SIMPLE
w2
index
PRIMARY
204
31871   
Using index; Using temporary; Using filesort

SIMPLE
w1
ref
PRIMARY
PRIMARY
102 
phpwiki.w2.topage   
14
Using index 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T19:39:26.970

> 表“wikilinks”在“frompage”和“topage”上有一个主索引

```
WHERE w2.topage=w1.frompage 
```

无法在上述复合索引中搜索此条件。

更改订单（在 上创建索引`topage, frompage`）或在 上创建附加索引`topage`。

PS 问题的根源在于系统中每个页面的排名都会随着每次编辑而更新。

这个排名系统对我来说似乎有点奇怪：它计算链接的链接，而不是链接本身。

如果有 1000 个页面链接到**莫斯科**，而只有**莫斯科**链接到**Beket 池塘**，那么该池塘将获得 1000 分，而**莫斯科**则根本不会获得任何积分，尽管每个人都知道莫斯科，却不知道池塘。

我想这不是你的意思。很可能它应该是这样的：

```
INSERT INTO
       wikiscore 
SELECT
       linked.topage, COUNT(*) AS cnt
FROM   wikilinks current, wikilinks linked
WHERE  current.frompage=@current_page
       AND linked.topage = current.topage
GROUP BY
       linked.topage
ON DUPLICATE KEY UPDATE
       score = cnt; 
```

这将汇总从当前页面引用的所有页面的所有链接，这似乎是您想要的。

`score`在这种情况下，您将需要摆脱`PRIMARY KEY`它`wikiscore`，但无论如何我认为将它放在那里毫无意义。

如果您想加快排名查询，您可以创建如下索引：

```
ALTER TABLE wikilinks ADD CONSTRAINT pk_wikilinkes_fromto PRIMARY KEY (frompage, topage);

CREATE INDEX ix_wikilinks_topage ON wikilinks (topage);

ALTER TABLE wikiscore ADD CONSTRAINT pk_wikiscore_pagename PRIMARY KEY (pagename);

CREATE INDEX ix_wikiscore_score ON wikiscore (score); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T19:31:15.753

[使用EXPLAIN](http://dev.mysql.com/doc/refman/5.1/de/explain.html)语句来确定查询的哪一部分花费的时间应该会有所帮助。然后，您可以决定要采取哪些措施来优化您的查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T19:48:02.740

我在理解查询的作用时遇到了一些麻烦。我收集到它会找到从一页到另一页的链接。所以 w1.topage 是指向该页面的链接，而 w1.frompage 是从该页面到其他页面的链接。因此插入添加了页面和指向该页面的链接数。

我走上正轨了吗？

您的主要问题是这一行：

```
FROM wikilinks AS w1, wikilinks AS w2 
```

如果您假设该表有 1000 个条目，则查询引擎必须将 1000 个条目与其他条目匹配，因此它会抓取 1000×1000 行（不考虑 WHERE 或 GROUP 子句）。随着您获得越来越多的条目，查询时间呈指数增长。（卡布姆）

此外，您只编辑一个页面，因此您应该能够合理地假设指向该特定页面的链接不会更改，但来自该页面的链接可能会更改。因此，与其在每次更新时都编写 wikilinks 表，不如从该特定页面删除链接，然后重新将该页面中的所有链接插入到其他页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T19:51:04.713

Quassnoi 的回答会让您加快 SELECT 的速度。如果 INSERT 再花四秒钟，那么添加索引将无济于事。如果希望省略传入链接计数为零的页面，则可以通过将 AND COUNT(*) > 0 添加到您的 SELECT 中来减少流程中的大量数据。

通过从 wikiscore 中删除索引，您至少可以获得一些改进。您在 pagename,score 上的主键实际上没有意义（您可以存储来自同一页面的多个分数，但如果它们是*相同*的分数则不能？），并且可能应该只是 pagename 上的主键。如果还有其他索引，您也许可以摆脱它们。

如果发生这种情况时没有重新创建 wikiscore，您可能会从向其抛出 OPTIMIZE TABLE 中获得一些好处。

但是，真正令人敬畏的是，如果您更改了此查询背后的整个理论，那么您无需在每次保存页面时都重建*整个 wikiscore 表*，而只需更新已保存页面及其链接到的页面的分数.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T16:37:23.013

这是我在 PHPWiki 的源代码中修改 PHP 代码的方法

```
// update pagescore
//old way... 
/*     
mysql_query("DELETE FROM $WikiScoreStore", $dbi["dbc"]);
mysql_query("INSERT INTO $WikiScoreStore"
                 ." SELECT w1.topage, COUNT(*) FROM $WikiLinksStore AS w1, $WikiLinksStore AS w2"
                 ." WHERE w2.topage=w1.frompage GROUP BY w1.topage", $dbi["dbc"]);

*/

//delete this pagescore            
mysql_query("DELETE FROM $WikiScoreStore WHERE pagename='$frompage'", $dbi["dbc"]);
//insert just this pagescore
mysql_query("INSERT INTO $WikiScoreStore" 
                    ." SELECT w1.topage, COUNT(*) FROM $WikiLinksStore AS w1, $WikiLinksStore AS w2"
                ." WHERE w2.topage=w1.frompage AND w1.topage='$frompage' GROUP BY w1.topage", $dbi["dbc"]); 
```

由于此代码更改和索引调整，我没有慢查询。谢谢你这么！

# c++ - 想要：一个 C++ 模板想法来解决问题，但在编译时？

> ID：512915
> 
> 赞同：4
> 
> 时间：2009-02-04T19:27:52.890
> 
> 标签：c++, templates, static-assert

我们有一个 const 结构数组，如下所示：

static const SettingsSuT _table[] = { {5,1}, {1,2}, {1,1} 等 };

该结构具有以下内容：

*   大小字节：
*   数量：
*   其他“元数据”成员

所以“总大小”是单个元素的 size_bytes*num_items 。所有这些信息都在 const 数组中，在编译时可用。但是，请注意，_table 的总大小与 EEPROM 本身的大小无关。_table 不镜像 EEPROM，它只描述了布局、使用和其他我们需要的“元数据”类型信息。但是，您可以使用此元数据来确定我们正在使用的 EEPROM 数量。

该数组仅描述了存储在具有固定/最大大小的外部 EEPROM 中的数据。随着功能的添加和删除， const 数组中的条目会发生变化。我们目前对数据的总大小进行运行时检查，以确保它不超过 EEPROM 大小。

但是，我们已经将其中许多运行时检查更改为 static_assert 样式的模板检查，以便立即停止构建。我不是模板专家，所以可以在这方面使用一些帮助。

所以，问题是：如何创建一个模板来将所有元素的大小相加（将每个元素的值相乘，然后将所有结果相加），然后执行 static_assert 并在它们超过幻数大小时停止构建的 EEPROM。我将典型的递归阶乘模板示例作为一种方法，但它无法访问数组，它需要一个 const 值（我认为）。

非常感谢您的帮助，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T22:35:43.930

您的问题是它们是常量，但在评估时它们不是常量表达式：

```
// f is constant, but its value not known at compile-time
int const f = rand() % 4; 
```

您需要的是真正的常量表达式。您可以使用`boost::mpl`mpl 对组成一个 mpl 向量，每个 mpl 对都有一对整数常数：

```
using namespace boost::mpl;
typedef vector<
    pair< int_<5>, int_<1> >,
    pair< int_<1>, int_<2> >,
    pair< int_<1>, int_<1> >,
    > numbers; 
```

`boost::mpl`现在，您可以使用算法迭代它的项目。每个`int_`都公开一个静态 int 常量`value`，设置为您告诉它的值。这将评估为一个常量表达式：

```
// get at the first element of the pair, located in the first element
// of the vector. Then get its ::value member. 
int array[at<numbers, 0>::type::first::value]; 
```

这实际上会使该数组包含 5 个元素。

boost::mpl 参考手册的网站：[这里](http://www.boost.org/doc/libs/1_37_0/libs/mpl/doc/refmanual.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T19:33:37.620

如果您将值更改为模板参数而不是构造函数参数或其他一些运行时初始化值，那么它们是可用于您的 static_asserts 的常量。

我不确定这如何适用于结构数组。您可能需要使用一些宏预处理器魔术来声明您的结构，以便它跟踪您的分配。

```
BEGIN_EEPROM_STRUCT_TABLE()
  STRUCT(size, num_bytes)
  // etc.
END_EEPROM_STRUCT_TABLE() 
```

这可能会声明您的表和一个将所有大小相加的 const，前提是它们在编译时是恒定的（当然，您要适当地编写宏）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T22:56:14.277

这基本上与 litb 的答案相同，但也显示了如何在不对数组大小进行硬编码的情况下将大小相加。这就是为什么它看起来如此复杂。

目前尚不清楚您需要帮助的部分。下面是如何使用类型来跟踪所有元数据而不是内存中的数组。这允许使用枚举进行编译时检查，而您不能在结构中使用 const int 进行检查。如果您有更多元数据，请在设置模板中添加其他参数并将它们存储为枚举值。

使用 Loki 库： http://loki-lib.sourceforge.net/index.php?n= [Main.Development](http://loki-lib.sourceforge.net/index.php?n=Main.Development)。由于 MakeTypeList 的实现方式，它被限制为 18 个“设置”。

您可以使用`TypeAt<TList, index>::Result::size_bytes`（例如）访问元数据。

```
 #include "loki-0.1.7\include\loki\typelist.h"
   #include "loki-0.1.7\include\loki\static_check.h"

   using namespace Loki;
   using namespace Loki::TL;

   // based on the Length<> template from loki for adding up the sizes
   template <class TList> struct TotalSize;
   template <> struct TotalSize<NullType>
   { enum { value = 0 }; };
   template <class T, class U>
   struct TotalSize< Typelist<T, U> >
   { enum { value = T::size_bytes*T::num_items + TotalSize<U>::value }; };

   // struct for holding the sizes (and other meta data 
   // if you add extra template args and enum values)
   template <size_t s, size_t n> struct Settings
   { enum { size_bytes = s, num_items = n }; };

   // the table of setting structs (limited to 18)
   typedef MakeTypelist< Settings<5,1>, Settings<1,2>, Settings<1,1> >
   SettingsSuT;

   int _tmain(int argc, _TCHAR* argv[])
   {
       LOKI_STATIC_CHECK(TotalSize< SettingsSuT::Result >::value == 8,is8);
       // this will trigger at compile time if uncommented
       //LOKI_STATIC_CHECK(TotalSize< SettingsSuT::Result >::value != 8,isnt8);

       int x = TotalSize< SettingsSuT::Result >::value;
       return 0;
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T00:19:22.143

在我的扶手椅上，我倾向于尝试将配置数据表示为一个结构，以便可以在编译时检查大小（任何静态断言都可以做到这一点）。根据所提供的信息，很难说这是否是一种合适的方法，但同样，基于同样的理由，我看不出有任何直接的理由来驳回它。

表格的基本翻译如下：

```
struct SettingsTable
{
    char a[5][1];//maybe call it "featureX_conf", or whatever...
    char b[1][2];
    char c[1][1];
}; 
```

（插入合适的编译器魔法来移除填充和对齐，尽管在实践中`char`似乎通常对大多数平台/编译器组合上的这种事情免疫。）

然后获得可以`sizeof`酌情使用的尺寸。如果仍然需要实际的值表，则可以通过这种方式生成。它会有点难看，但很容易隐藏在宏后面。

这是否比模板重的方法“更好”可能取决于目标市场。

# asp.net-mvc - 使用 NHibernate 时如何处理成员资格/角色？

> ID：512922
> 
> 赞同：12
> 
> 时间：2009-02-04T19:29:21.357
> 
> 标签：asp.net-mvc, nhibernate, asp.net-membership, membership-provider

我即将开始一个使用 NHibernate 和 ASP.Net MVC 的新项目，并且遇到了成员资格问题。我想知道我是否应该使用第 3 方 NHibernate 成员资格/角色提供程序，创建我自己的，或者只是一起跳过这些提供程序。

到目前为止，我看过：
[Manuel Abadia 的 NHCustomProviders](http://www.manuelabadia.com/blog/PermaLink,guid,3b6ccb3f-2f2a-4dcb-a414-605371a00618.aspx) - 似乎有很多配置，不确定是否要将所有这些都放在我的 web.config 中。
[Leo Vildosola 的 NHibernateProvider](http://www.codeplex.com/nhibernateprovider) - 项目所有者似乎不再支持它，因为他不再使用 NHibernate。
[Eucalypto](http://devage.com/Wiki/ViewArticle.aspx?name=eucalypto&version=0) - 我喜欢表格结构，但对它附带的所有额外的 CMS 东西有点担心。
* 这些项目中的每一个看起来都已经有一段时间没有被触及了，这可能意味着需要额外的工作来更新它们以使用最新版本的 NHibernate。

这是已经解决了很多次的问题之一，我想花时间解决新问题，并希望增加一些商业价值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T19:48:18.980

我自己滚动。它实际上比大多数人想象的要容易得多（我也很惊讶）——一旦你真正开始滚动，一切都会很快融合在一起。花几天或更长时间解决一个已解决的问题是一回事，但这花了我几个小时，包括计划。

# project-management - 当客户端的错误确实是一项新功能时

> ID：512933
> 
> 赞同：6
> 
> 时间：2009-02-04T19:32:56.077
> 
> 标签：project-management, waterfall, scope-creep

我读 [了what-payment-structure-do-you-use-for-small-projects](https://stackoverflow.com/questions/383975/what-payment-structure-do-you-use-for-small-projects) ，我想知道你们是如何处理错误与功能的。我曾经遇到过客户想要静态报告的情况。然后在项目的大部分工作完成后，在项目接近尾声时，他说他一直想要动态报告。这种改变并不容易，因为我们选择的框架不支持动态报告。这是一个奇怪的情况，因为客户有一个编程团队，所以他们应该知道。也许只是缺乏沟通技巧。

你们如何处理试图让您添加功能的客户，因为他们忘记了，改变了主意，或者被误解了？

我的意思是大功能，而不是小功能。

编辑：

他说预算是固定的，不能改变，而且这个特性（就像每一个一样）是至关重要的，没有它他们就不会接受这个系统。（只是最坏的情况）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:05:37.977

以我的经验，在这个问题的两边都有，这通常更多地是关于经济学，而不是关于编程、流程或项目管理。

我们，客户，经常说“它可能是一个功能，但如果我们称之为错误，也许我们可以让他们免费做。”

最后，作为程序员，我们根据是否有助于或损害我们未来工作的机会来收取或不收取更多费用。我们，客户，将未来工作的胡萝卜作为让程序员免费做额外工作的动力。

我不相信这会因为我们有更好的流程来表达“这是一个错误”或“这是一个新功能”而改变。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T19:37:43.417

在软件开发过程的早期，双方都了解他们的钱是什么，这一点很重要。敏捷方法是管理此过程的绝佳工具。如果您有团队的速度，您可以相当准确地确定在每次迭代期间可以添加多少功能。估计任务，并让客户参与确定要添加哪些功能以及哪些事情不那么重要的优先级。确保在每次迭代后都有一个客户演示，以展示你们都同意在当前迭代结束时工作的功能。如果客户想要其他功能或对您已经同意的功能进行重大更改，估计需要多少故事点（敏捷中使用的工作单元）来进行新的更改或重新设计当前的功能。这将帮助他们删除另一个他们认为不如他们刚刚建议的当前重要的功能。这让每个人都开心，并且产品“发货”时不会有任何意外

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T20:36:11.380

试图将它们排除在该功能之外是没有意义的。毕竟，无论是否存在沟通问题，我们的使命是在软件中交付客户需要的东西。

我会采用如下铁三角论点：
1) 显然我们想要提供您需要的产品，所以让我们一起努力。
2）我们都明白，无论我们如何走到现在，我们都只能从今天的位置继续前进。
3）我们也明白，实施变革需要时间和金钱，而这必须来自某个地方。
4）此时您的选择是这些（选择一个）
*用此更改所需的工作替换为某些其他功能计划的工作以保持预算和时间表（牺牲其他功能）
*延长截止日期（增加成本/班次期限）
* 添加资源（增加成本）

警告：尽管如果您从事制造类工作（再制造 1000 支铅笔），C 语言在逻辑上是有意义的，但在像软件工程这样的研发工作中，它通常只是 B 的另一种风格，您会放大成本和截止日期的变化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-04T19:37:43.197

如果不在项目计划/书面协议中，则超出范围。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T19:36:59.360

我们有书面的规范，并让客户在上面签字，同意为该文档中描述的功能付费。如果他们稍后在一些简单的事情上改变主意，我们通常会在不收取额外费用的情况下进行更改，但是像您描述的任何事情都需要新的采购订单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-04T19:39:21.540

嗯，最简单的答案是预算或合同规定了要求。对这些要求的更改必须作为额外提交，然后通过与原始项目相同的过程。必须对它们进行预算和估计。

完成所有这些后，如果客户希望它接近原始发布日期（这是可行的），请为加班时间添加额外的时间。

至少，这就是我所做的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-04T19:51:18.443

我向他们收费。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T21:17:10.063

我建议确保尽可能地解决这些要求，并且双方都清楚地了解所承诺的内容。它让客户高兴，因为像你描述的情况更少，它让你高兴，因为你不会一直被拉扯。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T13:52:13.470

问题是关于两个主题：谈判和项目管理。

就项目管理而言，您需要提前管理客户改变主意或误解协议的风险。以下是在软件开发项目中通常会采取的预防措施列表，可在计划或重新审视项目时用作清单：

*   通过在开始之前批准书面规范来避免大部分风险。如果您进行较小的迭代，请获得批准的迭代规范。它不需要过于详细，但应该设定客户期望并作为参考点。详细说明您在规范中不确定的事情。

*   您可能有机会直接向客户报告其他一些组织来做某些有风险的事情。

*   在计划中加入一些应急时间和预算，向客户解释任何应急措施只有在与他们达成协议的情况下才会使用。

*   在规划阶段明确向客户提供替代解决方案，讨论利弊并记录决策。

*   即使您在项目中构建了几个里程碑，您也将在其中向客户进行小演示或阐明需求。借此机会，客户仍然可以接受建议的解决方案。

*   正如 Webdtc 所指出的，总是通过发送简短的摘要电子邮件来确认电话和面对面讨论的结果。

*   将可交付成果、验收和付款分散到超过一个月的项目中。即使客户在项目结束时付款，也要确保您获得他们批准临时可交付成果的证据。

希望当您需要与受不付款威胁的客户事后协商交付成果时，遵循这些提示不会让您陷入困境。但是，如果您发现自己不得不忍受不合理的要求，那么您在那时积累的信息会给您带来非常强大的影响力。谈判技巧：

*   从了解客户需求背后的确切原因开始。他们的立场究竟是什么。与客户确认您正确理解他们。

*   在这一点上，这可能是你的错（如果你正确地管理项目，不太可能），客户的错（有时他们确实改变了主意）或双方的公鸡（很可能）。

*   当一切都是你的错时，你很可能需要吞下药丸并吸取教训。但是，您需要与客户协商新的截止日期，以防止问题让您付出更多代价。始终考虑为基于您现在拥有的软件构建的问题提出替代解决方案。

*   当它是客户或相互的错误时，从“不”开始。推回去让他们明白你没有吸收成本，至少没有完全吸收。不要让他们让你相信他们可以轻易地走开，这绝不是真的。在这一点上，即使他们没有付给你一分钱，他们对项目的投资也将是相当可观的：评估投标所花费的时间、参加会议、他们为沟通需求所做的努力、他们和他们的客户对项目的依赖程度主要是完成按时并在预算范围内等。您可能仍然需要在两个组织之间分摊成本，但以“否”开头，以明确表示他们有责任努力及时澄清要求，就像你有责任发现什么是需要。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T20:30:23.170

在我看来，客户可能正在寻找借口退出协议而不支付任何费用。如果他可以随意添加功能并坚持最终验收，无需额外费用，他就有办法让你违约。

有两种明显的方法可以避免这种情况。

一种是在整个开发过程中的付款，这样客户就无法摆脱大部分付款，并且您或多或少会从您在任何时候所做的事情中获得补偿。

另一个是良好的合同。对于任何合理的软件项目，几个小时的律师费对于此类事情来说都是便宜的保险。如果您有信心可以以约定的费用起诉客户并获胜，那么客户就不太可能制造麻烦，如果其他一切都失败了，您可以起诉。

我不知道你的工作合同安排是什么（而且我也不是律师），但在这种情况下，我会找律师，看看我处于什么样的情况。甚至如果您处于可疑的法律地位，您的律师的信可能会帮助解决问题。

并且不要再进入那个位置。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-04T21:07:54.933

好吧，如果这是真的，那就顺其自然吧。如果你同意一件事，现在他想做额外的事情，该怎么解释？你收到推回了吗？

我要明确表示，我们最初设计了一份静态报告，这就是签署的内容。它可以扩展到动态报告，如果他想知道细节，您可以提供报价。

我经常用盖房子的比喻。客户正在更改蓝图，或者需要更多时间的整理材料，这些材料要从最初同意的内容中完成。

希望有帮助！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-05T23:35:50.797

在这种情况下，我所做的是查看先前的文档和通信。

例如，如果文档/通信显示“创建报告”。如果没有具体提及动态报告，我不会向客户屈服。

如果有任何文件说“动态报告”，那么客户是对的，我必须免费开发报告。

如果有关于“动态报告”的交流，我将不得不看看最终结果是什么。这可能会变得更难，因为很多时候客户可能会问“是否可以创建动态报告？” 开发人员可能会说“是的，这是可能的”。（意味着它是可能的，但并不意味着我们会这样做）。这是我必须解释的地方，尽管讨论过它不在工作范围内。必须就开发一个功能达成具体协议。

如果您不保留文件和之前的沟通，那么我会说您不知所措，需要决定您是否要给客户他们想要的东西或冒失去客户的风险。

对我来说最糟糕的事情之一是坚持电话沟通的客户。这些客户通常会根据他们的要求快速轻松地播放它。我通常在这里做的是始终对客户在面对面会议或电话中讨论的所有内容进行书面跟进，并要求客户做出回应以确保我们在将要和赢得的内容上达成一致做不完。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-05T13:35:43.300

没有正确的答案——只有几个错误的答案。规格和要求比信息有更多的空白 - 总是有解释和误解的空间......它真正归结为：

*   未来的工作——这个客户是否有未来的工作或未来工作的潜在参考？如果是这样，请稍作让步，尝试将可交付成果的其他区域取消灰色，基于此实例，这些区域可能会转向正确的方向。
*   付款 - 他们是否基于此付款？并且这项工作是否仍在您的缓冲预算内（您确实为此类工作添加了缓冲 - 对吗？好吧，下次你会 - 未来的客户为过去的客户错误付出代价）
*   快速且频繁地交付 - IKIWISI - 当我看到它时我就知道 - 如果它迟早出现在客户面前，那么“解释”/灰色区域会减少......迭代交付（甚至是不完整的交付）创造奇迹

在你无能为力的事实之后，如果归结为法律诉讼，你就会失去这个客户和良好的声誉（潜在的）——小心你推动它的努力

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-06T14:01:42.123

我处于这种情况经常发生的情况。我们编写执行复杂任务的 Web 应用程序，然后在我们按照规范完成它之后，用户会转身说“我们不仅想要 X 和 Y，还想要 Z”。Z 不在项目范围内，因此在当前系统中无法实现，因此必须重写它以适应新引入的“功能”。

我们解决这个问题的方法如下。像对待白痴一样对待用户，并且比他们更了解系统。我知道这听起来很刻薄，起初当我的老板向我介绍这个时，我直截了当地告诉他我永远不会这样对待用户 - 不幸的是，我学会了艰难的道路，现在必须比用户了解更多才能完成我的任务. 缓解是最重要的，预见*可能*引入的重大变化是随着时间的推移而学到的技能。

我现在减轻这些计划外但可能发生的变化。

# c++ - C/C++ 从标准输入的十六进制输入中读取一个字节

> ID：512941
> 
> 赞同：2
> 
> 时间：2009-02-04T19:35:53.233
> 
> 标签：c++, byte, stdin, scanf

无法完全找到如何在 C/C++ 中执行以下操作的方法。

输入：十六进制值，例如：ffffffffff...

为了读取输入，我尝试了以下代码：

```
uint16_t twoBytes;
scanf("%x",&twoBytes); 
```

这一切都很好，但是我如何将 2bytes 拆分为 1bytes`uint8_t`值（或者甚至可能只读取第一个字节）。想从输入中读取第一个字节，并将其存储在字节矩阵中的选择位置。

```
uint8_t matrix[50][50] 
```

由于我在格式化/读取 C/C++ 中的输入方面不是很熟练（并且到目前为止只使用了 scanf），因此非常感谢任何其他关于如何轻松（如果可以的话，速度很快）的想法。

编辑：通过使用 fread 函数找到了一种更好的方法，因为它可以指定应该从流中读取多少字节（在这种情况下为标准输入）并保存到变量/数组中。

```
size_t fread ( void * ptr, size_t size, size_t count, FILE * stream ); 
```

参数

ptr - 指向最小大小为 (size*count) 字节的内存块的指针。

size - 要读取的每个元素的大小（以字节为单位）。

count - 元素的数量，每个元素的大小为 size 字节。

stream - 指向指定输入流的 FILE 对象的指针。

[cplusplus 参考](http://www.cplusplus.com/reference/clibrary/cstdio/fread.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:42:32.330

`%x`读取 a `unsigned int`，而不是 a `uint16_t`（认为它们在您的特定平台上可能相同）。

要仅读取一个字节，请尝试以下操作：

```
uint32_t byteTmp;
scanf("%2x", &byteTmp);
uint8_t byte = byteTmp; 
```

这读取一个`unsigned int`，但在读取两个字符后停止（两个十六进制字符等于八位或一个字节）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:43:08.333

您应该能够像这样拆分变量：

```
uint8_t LowerByte=twoBytes & 256;
uint8_t HigherByte=twoBytes >> 8; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T19:47:28.823

几个想法：

1）将其读取为字符并手动转换 - 痛苦

2）如果你知道有4个hexits的倍数，你可以读入twobytes，然后转换成high = twobytes << 8; 低 = 双字节 & FF;

3) %2x

# c# - 将文本框绑定到货币，如何获得双倍？

> ID：512954
> 
> 赞同：0
> 
> 时间：2009-02-04T19:39:30.010
> 
> 标签：c#, .net, data-binding, masking

我有一个绑定到货币数据字段的文本框。所以它会在文本的开头添加 '$' 或 ($xx.xx) 如果它是负数。如何从文本框中获取普通的双精度（xx.xx）而不是所有内容（$xx.xx）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T19:44:22.310

确保在调用 double.Parse 时设置了正确的 NumberStyles 标志。

显然，您将使用下面的示例，但将文字字符串替换为对 TextBox 中文本的引用。

```
double d = double.Parse ("$10.10", NumberStyles.Currency); 
```

# javascript - 力量 到网页底部居中

> ID：512957
> 
> 赞同：8
> 
> 时间：2009-02-04T19:40:18.870
> 
> 标签：javascript, html, css, ajax

我的 HTML 中有一个`<div>...</div>`部分，基本上就像一个工具栏。

有没有办法可以将该部分强制到网页底部（文档，而不是视口）并将其居中？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-04T20:02:15.677

我认为您正在寻找的是：[http ://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

这是一个优雅的、**仅限 CSS**的解决方案！

我使用它，它适用于所有浏览器中的各种布局！就我而言，它是唯一适用于所有浏览器和布局的优雅解决方案。

@Josh：不，不是，这就是布兰克曼想要的，他想要一个贴在文档底部的页脚，而不是视口（浏览器窗口）。因此，如果内容比浏览器窗口短，页脚会粘在窗口的下端，如果内容较长，页脚会向下并且直到向下滚动时才可见。

### Twitter Bootstrap 实现

我看到很多人询问如何将其与 Twitter Bootstrap 结合使用。虽然很容易弄清楚，但这里有一些应该有所帮助的片段。

```
// _sticky-footer.scss SASS partial for a Ryan Fait style sticky footer

html, body {
  height: 100%;
}

.wrapper {
  min-height: 100%;
  height: auto !important;
  height: 100%;
  margin: 0 auto -1*($footerHeight + 2); /* + 2 for the two 1px borders */
}

.push {
  height: $footerHeight;
}

.wrapper > .container {
  padding-top: $navbarHeight + $gridGutterWidth;
}

@media (max-width: 480px) {
  .push {
    height: $topFooterHeight !important;
  }
  .wrapper {
    margin: 0 auto -1*($topFooterHeight + 2) !important;
  }
} 
```

和粗略的标记体：

```
<body>
    <div class="navbar navbar-fixed-top">
        // navbar content
    </div>
    <div class="wrapper">
        <div class="container">
            // main content with your grids, etc.
        </div>
        <div class="push"><!--//--></div>
    </div>
    <footer class="footer">
        // footer content
    </footer>
</body> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T23:23:39.310

如果我理解正确，您希望工具**栏***始终*可见，无论垂直滚动位置如何。如果这是正确的，我会推荐以下 CSS ...

```
 body {
    margin:0;
    padding:0;
    z-index:0;
  }

  #toolbar {
    background:#ddd;
    border-top:solid 1px #666;
    bottom:0;
    height:15px;
    padding:5px;
    position:fixed;
    width:100%;
    z-index:1000;
  } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T20:35:58.227

我只是想清楚你在这里所说的话：

> 网页底部（ **文档**，而不是*视口*）

自然，一个 div 将位于“文档”的底部，具体取决于您的布局。

如果它没有到文档的底部，或者没有注意你的列有多高，是因为你的浮动吗？明确：两者；将是为了解决这个问题。

我认为粘性页脚是您要寻找的，但是当您说文档而不是视口时，我会感到有些困惑。粘性页脚通常这样做：注意短页面，如果它比视口短，粘性页脚会将页脚 div 固定到底部。

这是一些粘性页脚（有数以百万计的 em，但这是我最喜欢的顺序）：

*   [http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)
*   [http://css-tricks.com/sticky-footer/](http://css-tricks.com/sticky-footer/)
*   [http://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/) *（之前列出的）*
*   [http://brassblogs.com/blog/sticky-footer](http://brassblogs.com/blog/sticky-footer)
*   [http://alistapart.com/](http://www.pmob.co.uk/temp/spointfooter.htm) *（那里有一个我只是找不到）*

也许如果您提供了一个快速说明或者更具体地说明您想要什么？希望这会有所帮助：D

-肯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T19:47:17.157

试试这个：[没有 Javascript 的固定页脚](http://boagworld.com/technology/fixed_footers_without_javascri/)。我不知道它是否会完美契合，但我认为它已经足够接近了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T20:01:19.280

你可以给 div 一个：

**明确：两者；文本对齐：居中；**

并将 div 作为结束正文语句之前的最后一个元素。这将迫使它成为最后一个没有任何东西的元素。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T20:20:07.387

最好的办法是使用 javascript 来确定页面的大小。您可以使用非 IE 浏览器使用 window.innerHeight 获取高度，使用 IE 使用 document.documentElement.clientHeight 获取高度。使用该值，您应该能够将您的元素绝对定位在页面设置顶部到该值减去您的 div 的高度。如果你的 div 的高度是可变的，你需要检查 div 的 offsetHeight 属性来获得真实的高度。

对于居中，使用以下示例：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <style>
            .wrapper
            {
                width: 100%;
                padding-left: 50%;
            }
            .test
            {
                width: 400px;
                margin-left: -200px;
                border: 1px solid black;
                padding-left: -200px;
            }
        </style>
    </head>
    <div class="wrapper">
    <div class="test">This is a test</div>
    </div>
 </html> 
```

你有一个围绕你想要居中的 div 的包装器 div。包装器 div 的宽度为 100%，内部 div 的宽度设置为您想要的任何值。给包装器 div 一个 50% 的左填充，给内部 div 一个负左边距，等于其宽度的一半。

# php - 对于基于 CLI 的多线程 PHP 应用程序，什么是好的分析器？

> ID：512960
> 
> 赞同：1
> 
> 时间：2009-02-04T19:41:28.807
> 
> 标签：php, multithreading, command-line-interface

我编写了一个运行多个线程的批处理器（pcntl_fork），当子进程停止运行并且似乎没有释放它们的资源时，我得到了一些奇怪的结果。

是否有一个好的代码分析器，我可以使用跟踪实用程序来“监视”父进程和子进程以查看发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T19:59:49.440

我知道的唯一探查器是[XDebug](http://www.xdebug.org/)。您可以使用[Webgrind](http://code.google.com/p/webgrind/)或 KCachegrind 处理结果。

它提供了有关您编写的 PHP 代码的性能统计信息，因此您应该能够确定问题是由于您的代码还是某些 PHP/OS 错误造成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T20:11:51.537

Xdebug 既可以进行[分析](http://www.xdebug.org/docs/profiler)，也可以进行[交互式调试](http://www.xdebug.org/docs/remote)。有几个客户端可用于连接到调试过程。

# c# - C# .NET 中的重载方法

> ID：512974
> 
> 赞同：2
> 
> 时间：2009-02-04T19:46:55.223
> 
> 标签：c#, .net, generics, reflection, overloading

如果我们在传递给下面的重载方法之前将其转换为“Object”，则 Int32 类型的变量不会被威胁为 Int32：

```
public static void MethodName(int a)
{
    Console.WriteLine("int");
}

public static void MethodName(object a)
{
    Console.ReadLine();
} 
```

将其作为 Int32 处理，即使它被转换为“Object”也可以通过反射来实现：

```
public static void MethodName(object a)
{
    if(a.GetType() == typeof(int))
    {
        Console.WriteLine("int");
    }
    else
    {
        Console.ReadLine();
    }
} 
```

还有另一种方法吗？也许使用泛型？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T20:38:48.940

运行时重载解析直到 C# 4.0 才可用，它具有`dynamic`：

```
public class Bar
{
    public void Foo(int x)
    {
        Console.WriteLine("int");
    }

    public void Foo(string x)
    {
        Console.WriteLine("string");
    }

    public void Foo(object x)
    {
        Console.WriteLine("dunno");
    }

    public void DynamicFoo(object x)
    {
        ((dynamic)this).Foo(x);
    }
}

object a = 5;
object b = "hi";
object c = 2.1;

Bar bar = new Bar();
bar.DynamicFoo(a);
bar.DynamicFoo(b);
bar.DynamicFoo(c); 
```

转换`this`为`dynamic`启用动态重载支持，因此包装器方法能够根据参数的运行时类型`DynamicFoo`调用最合适的重载。`Foo`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T19:49:53.797

```
public static void MethodName(object a)
{
        if(a is int)
        {
                Console.WriteLine("int");
        }
        else
        {
                Console.WriteLine("object");
        }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T19:51:52.653

不，调用的方法的特定重载是在编译时确定的，而不是在运行时确定的，除非您使用反射，因此如果您将 int 转换为对象，则将调用对象重载。我不相信有任何其他方法可以做到这一点，而且泛型也不会为你做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T20:00:57.957

这行不通吗？

```
void MethodName<T>(object a){
    T item = a as T;
    // treat in the manner you require
}

MethodName<object>(1);
MethodName<Int32>(1); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T19:54:58.217

也许：

```
public static void MethodName(Type t)
{
     Console.WriteLine(t.Name);
} 
```

然后调用它：

```
int a = 0;
string b = "";
object c = new object();
MethodName(a.GetType());
MethodName(b.GetType());
MethodName(c.GetType()); 
```

或者：

```
public static void MethodName<T>(T a)
{
    Console.WriteLine(a.GetType().Name);
} 
```

最后：

```
public static void MethodName<T>()
{
    Console.WriteLine(typeof(T).Name);
} 
```

* * *

更新：
归根结底，语言*必须*能够以某种方式确定您将*在编译时*处理的类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T19:51:17.897

如果你想打开类型，你几乎会被 if/else 结构所困扰。由于多态性，switch 语句本身将不起作用。如果您使用的是非原始对象，则通常可以使用多态性或接口来完成这种行为，例如：

```
public static void MethodName(MyBaseObject obj)
{
     Console.WriteLine(obj.MyVirtualFunctionCall());
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-11T05:45:13.050

在 .NET 3.5 之前，动态重载是一个问题，但在 .NET 4 中，它非常可行，只需几行代码。

```
 public void publish(dynamic queue)
     {
         publish(queue);
         Console.WriteLine("dynamic queue publishing");
     }

     public void publish(ValidationQueue queue)
     {
         Console.WriteLine("Validation queue publishing");
     } 
```

怎么打电话

```
 foreach (var queue in  _vodaQueueDAO.FetchAllReadyQueuesWithHighestPriority())
        {
            PublishingService.publish(queue);
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T16:29:15.447

我为 .NET 3.5 编写了一个实现，您可以在其中执行以下操作：

```
object a = 5;

OverloadResolver.Invoke(MethodName, a); 
```

它会使用 int 重载。

适用于编译和缓存的 Lambda 表达式，因此性能应该没问题。

如果有人需要，请给我发邮件，herzmeisterderwelten，他住在 gmail.com

# eclipse - Eclipse 中是否有折叠当前方法/块的键盘快捷键？

> ID：512976
> 
> 赞同：78
> 
> 时间：2009-02-04T19:47:05.503
> 
> 标签：eclipse, ide, keyboard-shortcuts

嘿，问题说明了一切。我在 Eclipse (v3.4) 中打开了折叠功能，而不必单击页面装订线中的小 +/-，我想知道是否有一个键盘快捷键可以“折叠当前方法”。快速浏览一下 Eclipse 中的菜单和什么没有显示它的菜单项，所以也许你就是做不到。

任何人？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-02-04T20:05:55.823

要扩展 petrilli 的答案：

*   `Ctrl`+`Numpad_Multiply`也可以用来扩展所有
*   `Ctrl`++`Shift`势必`Numpad_Divide`全部崩塌
*   `Ctrl`+`Numpad_Divide`切换折叠打开和关闭

是的，如果您知道在 Windows 中过滤哪些文本，它们都可以被反弹 | 偏好 | 一般 | 钥匙。

“折叠”、“展开”、“折叠”是应该为您提供所有相关命令的关键字。

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-02-04T19:52:22.013

默认情况下，它们绑定到`Ctrl`+`Numpad_Minus`和`Ctrl`+ `Numpad_Plus`，但您可以重新绑定它们。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-20T08:38:46.310

如果您使用的是 eclipse-pydev，那么默认的键绑定是

`ctrl`+ `9`: 折叠所有一层

`ctrl`+ `0`: 展开所有一层

`ctrl`+ `-_`: 折叠当前位置

`ctrl`+ `=+`: 扩展当前

# resources - Exchange Server 组织结构

> ID：512982
> 
> 赞同：0
> 
> 时间：2009-02-04T19:48:21.663
> 
> 标签：resources, build, exchange-server, hierarchy

我需要找出一种方法来通过交换服务器的 Director->Manager->Employee 构建层次结构。我对交流的了解非常有限，所以有人对我有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T06:04:32.043

The only thing that I can think of that may help here is the manager attribute in AD.

To build a proper hierarchy based upon the manager settings may require some coding.

I can't understand what you are trying to achieve in Exchange.

# .net - WPF 如何使用同一个模板

> ID：512983
> 
> 赞同：2
> 
> 时间：2009-02-04T19:48:41.943
> 
> 标签：.net, wpf, templates

好吧，我如何在 TextBox 和 PasswordBox atm 上使用模板，我定义了 2 个模板，但它们包含完全相同的内容....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T19:57:25.763

在类层次结构中，两个控件只有“控件”类共有。因此，您可以为“控件”制作 ControlTemplate 并分配给两者。但是，如果您需要在模板中包含任何 TextBox/PasswordBox 特定的 TemplateBindings，那么这将不适合您。例如，此波纹管模板将适用于这两个控件。

```
<ControlTemplate x:Key="template" TargetType="{x:Type Control}">
<Border BorderThickness="1,1,1,1" BorderBrush="#FF000000">
    <ScrollViewer x:Name="PART_ContentHost" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
</Border>
</ControlTemplate> 
```

# c# - LINQ to SQL：对来自订购系统的多个表的报告的聚合数据进行复杂查询

> ID：512984
> 
> 赞同：8
> 
> 时间：2009-02-04T19:49:24.937
> 
> 标签：c#, linq, linq-to-sql, grouping, aggregate-functions

我想将以下查询转换为 LINQ 语法。我在设法让它工作时遇到了很多麻烦。我实际上尝试从 LINQ 开始，但发现如果我反过来写它可能会更好。

```
SELECT
    pmt.guid,
    pmt.sku,
    pmt.name,
    opt.color,
    opt.size,
    SUM(opt.qty) AS qtySold,
    SUM(opt.qty * opt.itemprice) AS totalSales,
    COUNT(omt.guid) AS betweenOrders
FROM
    products_mainTable pmt 
        LEFT OUTER JOIN 
            orders_productsTable opt ON opt.products_mainTableGUID = pmt.guid
            LEFT OUTER JOIN orders_mainTable omt ON omt.guid = opt.orders_mainTableGUID AND
                (omt.flags & 1) = 1
GROUP BY
    pmt.sku, opt.color, opt.size, pmt.guid, pmt.name
ORDER BY
    pmt.sku 
```

最终结果是一个表格，向我显示了有关产品的信息，如您在上面看到的。如何使用理解语法以 LINQ 形式编写此查询？

此外，我可能想要添加额外的过滤器（例如，添加到 orders_mainTable）。

这是我尝试制作的一个示例，并且相当接近，但不确定它是否是“正确”的方式，并且无法从 orders_productsTable 中按大小和颜色对其进行分组。

```
from pmt in products_mainTable
let Purchases = 
        from opt in pmt.orders_productsTable
        where ((opt.orders_mainTable.flags & 1) == 1)
        where ((opt.orders_mainTable.date_completedon > Convert.ToDateTime("01/01/2009 00:00:00")))
        select opt
orderby pmt.sku
select new {
    pmt.guid,
    pmt.sku,
    pmt.name,
    pmt.price,  
    AvgPerOrder = Purchases.Average(p => p.qty).GetValueOrDefault(0),
    QtySold = Purchases.Sum(p => p.qty).GetValueOrDefault(),
    SoldFor = Purchases.Sum(p => p.itemprice * p.qty).GetValueOrDefault()           
} 
```

*编辑：

为了更明确一点，这样你就可以理解我想要做什么，这里有一些更多的解释。

商品存放在 products_mainTable 订单存放在 orders_mainTable 已下单的商品存放在 orders_productsTable

我想根据产品、订单等创建几个报告。钻取数据并找到有意义的位以显示给最终用户。

在这种情况下，我试图显示在一段时间内购买了哪些产品，并且是最受欢迎的。卖出了多少，价格是多少，每个订单的突破是多少。也许不是最好的顺序，但我只是在试验并选择了这个。

所有表都与其他表有关系。所以从产品表中，我可以得到订购该产品的订单等。

我遇到的最大问题是了解 LINQ 的工作原理，尤其是在分组、聚合数据、扩展、子查询等方面。这很有趣，但它开始变得令人沮丧，因为我很难找到有关如何执行此操作的详细解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T21:44:59.773

我也是 LINQ 的初学者。我不知道这是否是按多个字段分组的正确方法，但我认为您必须将这些分组字段转换为表示键。因此，假设您的所有分组字段都是字符串或整数，您可以按如下方式创建一个键：

```
 var qry = from pmt in products_mainTable
                  join opt in orders_productsTable on pmt.guid equals opt.products_mainTableGUID
                  join omt in orders_mainTable on opt.orders_mainTableGUID equals omt.guid
                  where (opt.orders_mainTable.flags & 1) == 1
                  group omt by pmt.sku + opt.price + opt.size + pmt.guid + pmt.name into g
                  orderby g.sku
                  select new
                  {
                      g.FirstOrDefault().guid,
                      g.FirstOrDefault().sku,
                      g.FirstOrDefault().name,
                      g.FirstOrDefault().color,
                      g.FirstOrDefault().price,
                      AvgPerOrder = g.Average(p => p.qty).GetValueOrDefault(0),
                      QtySold = g.Sum(p => p.qty).GetValueOrDefault(),
                      SoldFor = g.Sum(p => p.itemprice * p.qty).GetValueOrDefault()
                  }; 
```

我没有对此进行测试，所以请看看这是否对您有任何帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T04:32:25.223

布鲁诺，非常感谢您的帮助！FirstOrDefault() 可能是最大的帮助。遵循您所做的一些事情，以及另一个资源，我想出了以下似乎效果很好的资源！下面的这个 LINQ 查询几乎完全复制了我上面发布的 SQL。

这是我在 LINQ 中执行 LEFT OUTER JOIN 时发现的另一个资源：[博客文章](http://solidcoding.blogspot.com/2007/12/left-outer-join-in-linq.html)

**最终答案：**

```
 from pmt in products_mainTable
    join opt in orders_productsTable on pmt.guid equals opt.products_mainTableGUID into tempProducts
    from orderedProducts in tempProducts.DefaultIfEmpty()
    join omt in orders_mainTable on orderedProducts.orders_mainTableGUID equals omt.guid into tempOrders
    from ordersMain in tempOrders.DefaultIfEmpty()
    group pmt by new { pmt.sku, orderedProducts.color, orderedProducts.size } into g
    orderby g.FirstOrDefault().sku
    select new {
        g.FirstOrDefault().guid,
        g.Key.sku,
        g.Key.size, 
        QTY = g.FirstOrDefault().orders_productsTable.Sum(c => c.qty),
        SUM = g.FirstOrDefault().orders_productsTable.Sum(c => c.itemprice * c.qty),
        AVG = g.FirstOrDefault().orders_productsTable.Average(c => c.itemprice * c.qty),
        Some = g.FirstOrDefault().orders_productsTable.Average(p => p.qty).GetValueOrDefault(0),
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:37:35.990

这对我很有帮助，谢谢。我有一个类似的问题，我试图解决只是我的案例要简单得多，因为我没有任何连接。我只是想对一个字段进行分组，得到另一个字段的最小值，然后计数。（同一查询中的最小值和计数）

这是我想用 Linq 语法重新创建的 SQL：

```
select t.Field1, min(t.Field2), COUNT(*)
from SomeTable t
group by t.Field1
order by t.Field1 
```

感谢您的帖子，我最终设法想出了这个：

```
from t in SomeTable
group t by new { t.Field1 } into g
orderby g.Key.Field1
select new
{ 
  g.Key.Field1,
  code = g.Min(c => c.Field2),
  qty = g.Count()
} 
```

这在幕后创建了以下 SQL：

```
SELECT [t1].[Field1], [t1].[value] AS [code], [t1].[value2] AS [qty]
FROM (
    SELECT MIN([t0].[Field2]) AS [value], COUNT(*) AS [value2], [t0].[Field1]
    FROM [SomeTable] AS [t0]
    GROUP BY [t0].[Field1]
    ) AS [t1]
ORDER BY [t1].[Field1] 
```

完美，正是我想要做的。对我来说，关键是您展示了在新的 {} 中执行此操作的可能性，这是我从未考虑过尝试的事情。这是巨大的，我现在觉得我对未来有了更好的理解。

# authentication - rsa 密钥卡如何工作？

> ID：512985
> 
> 赞同：16
> 
> 时间：2009-02-04T19:49:53.110
> 
> 标签：authentication, rsa

谁能用简单的编程术语向我解释这些 RSA 密钥加密狗是如何工作的？我知道暴雪有它们用于魔兽世界和贝宝以及一些交易网站。

谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-04T19:56:14.517

fob 有一个时钟和一个序列号，用作[PRNG](http://en.wikipedia.org/wiki/PRNG)的种子。当您点击“显示代码”按钮时，fob 会显示一个数字，该数字是该时间戳的乘积，序列号通过 PRNG 运行。服务器知道您的 fob 的序列号和时间，并执行相同的操作。如果您的代码匹配，则您已通过身份验证。

您可以在服务器端计算上一个/下一个 N 值以解决时钟偏差。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T19:59:31.907

程序化条款不是必需的。想象一下两个硬件（你的加密狗和公司里的东西）以相同的定期间隔生成相同的数字。由于某些专有算法，几乎不可能猜出该数字是多少，因此如果您输入的数字（或由加密狗自动发送）与服务器上的数字匹配，您的身份就会得到验证。

至少对于我拥有的加密狗，您还必须提供一个只有您和服务器知道的引脚。因此，为了获得身份验证，您需要一些物理的东西和头脑中的一些东西。这种组合很难伪造。即使有人得到了加密狗，除非他们知道你的密码，否则它一文不值。如果他们知道您的密码，那么如果没有加密狗，这些信息将毫无价值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:10:57.873

[立即安全！第 103 集](http://www.grc.com/sn/sn-103.htm)讲述了它们的工作原理。（该链接指向节目说明，但页面顶部有一个指向音频播客的链接。）

基本上，密钥卡与服务器同步，并且它们都被播种以生成相同的伪随机数序列。如果您在正确的时间输入正确的数字，服务器就会知道是您。

# c# - 如何检测用户何时单击 Windows Mobile (.NET CF 3.5) 中的通知图标

> ID：512990
> 
> 赞同：0
> 
> 时间：2009-02-04T19:50:43.373
> 
> 标签：c#, .net, windows-mobile, compact-framework

在网上冲浪，我遇到了这个：

[此代码](http://groups.google.com/group/microsoft.public.dotnet.framework.compactframework/msg/d202f6a36c5c4295?dmode=source&hl=en)显示如何在 Windows Mobile 设备的屏幕底部显示通知。我的问题是，有没有办法指定通知下方（在任务栏上）显示哪些选项，或者有没有办法检测用户何时单击通知本身，以便我可以对该编程盟友做出反应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T20:08:10.373

使用这个特定的 API，密钥在 SHNOTIFICATIONDATA 的 hwndSink 成员中。当点击通知时，这里传入的 hwnd 会收到点击消息。为此，最简单的方法是传入[MessageWindow](http://msdn.microsoft.com/en-us/library/microsoft.windowsce.forms.messagewindow(VS.80).aspx)的句柄。

您也可以查看[CeSetUserNotification](http://msdn.microsoft.com/en-us/library/ms908104.aspx) API。实际上，它在允许您执行的操作以及如何在应用程序中获取通知方面更加强大。****