# StackOverflow 问答 000091000-000091999

# windows - 如何在 Windows XP/Vista 上创建临时文件的路径

> ID：91007
> 
> 赞同：3
> 
> 时间：2008-09-18T08:46:13.373
> 
> 标签：windows, windows-vista, temporary-files

这样做的最佳方法是什么？tmpnam() 返回驱动器根目录中文件的路径，这需要 Windows Vista 上的管理员权限，因此这不是一个选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T08:50:37.903

[GetTempPath](http://msdn.microsoft.com/en-us/library/aa364992(VS.85).aspx)和[GetTempFileName](http://msdn.microsoft.com/en-us/library/aa364991(VS.85).aspx)应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T08:53:29.723

Windows 上的环境变量 %TEMP% 指向用户临时目录。

在托管 C++ 中，您可以调用 Path::GetTempFileName() ，它将在用户临时目录中为您提供一个临时文件（可以使用 Path::GetTempPath() 找到）。GetTempFileName() 基本上只是为您提供 %TEMP% 路径中的文件的路径，使用 GUID 作为文件名。然后，您使用该路径创建文件并使用它做您想做的事情。您可以使用任何可以访问当前进程环境变量的语言来执行类似的逻辑。

希望有帮助，

马丁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T08:48:57.847

您是否尝试过将环境变量 TEMP 和 TMP 设置为所有人可写的目录？要更改 XP 中的环境变量（不熟悉 Vista），请转到系统属性，[高级]选项卡，[环境变量]按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T08:54:13.357

也许您可以在 kernel32.dll 中使用 Win32 方法 GetTempPath()。这由 System.IO.Path.GetTempFileName() 包装在 .NET 中。

在 XP 上，这会返回 C:\Documents and Settings\username\Local Settings\Temp\ 中的路径，因此您不需要管理员权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T09:18:05.060

如果您关心互操作性，tmpnam 的手册页建议：

## tmpnam 手册页

```
BUGS
       Never use this function. Use mkstemp(3) instead. 
```

## mkstemp 手册页

```
SYNOPSIS
       #include <stdlib.h>

       int mkstemp(char *template);

DESCRIPTION
       The mkstemp() function generates a unique temporary file name from template.  The last six characters of template must be
       XXXXXX and these are replaced with a string that makes the filename unique. The file is then created with mode read/write 
```

但所有这些都表明您已经准备好以 TMP 环境变量内容为前缀的模板。

# mod-rewrite - How to rewrite an URL on a JBoss server?

> ID：91038
> 
> 赞同：13
> 
> 时间：2008-09-18T08:53:57.647
> 
> 标签：mod-rewrite, redirect, jboss, url-rewriting

I would like to redirect/rewrite this two kinds of URLs:

*   mydomain.com -> newdomain.com
*   mydomain.com/specificPage -> newdomain.com/newSpecificPage
*   mydomain.com/anyOtherPage -> mydomain.com/anyOtherPage (no redirect here)

So I just want to redirect the root domain to a new domain, and *some* pages from my domain to some pages on a new domain...

How can I do that on a JBoss server ?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T08:59:55.527

你看过[http://www.jboss.org/jbossweb/modules/rewrite.html](http://www.jboss.org/jbossweb/modules/rewrite.html)吗？它看起来像您要查找的内容，并且与 Apache 的 Mod_rewrite 非常相似。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T09:26:29.020

你可以看看这个[http://code.google.com/p/urlrewritefilter/](http://code.google.com/p/urlrewritefilter/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T09:21:59.933

听起来您想发送一个[HTTP 301 Moved Permanently](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.2)响应。

```
RewriteCond %{REQUEST_URI} ^URI_TO_REDIRECT
RewriteRule redirect=301 NEW_SITE [L] 
```

或类似的。`[L]`就是告诉它立即重定向而不是继续重写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-28T12:36:51.777

如果您完全通过 apache 进行路由，则可以使用 mod_rewrite；您只需要注意声明重写规则的位置。目录配置和 .htaccess 文件不起作用；您需要它作为整个主机的全局配置。服务器故障上的类似[线程](https://serverfault.com/questions/76402/jboss-modrewrite/79075#79075)。

# java - Java EE 应用服务器 Hello World

> ID：91061
> 
> 赞同：3
> 
> 时间：2008-09-18T09:00:12.827
> 
> 标签：java, jakarta-ee

我对独立的 Java 应用程序开发相当满意，但很快就会使用 Java EE 应用程序服务器开发一个项目。

有谁知道让 hello-world 类型的应用程序在应用程序服务器中工作的简单操作教程？我（也许很天真）假设不同框架之间的总体方法是相似的，所以我更感兴趣的是找出方法，而不是陷入不同框架之间的差异。

如果您不知道一个好的指南，那么您能否发布项目符号类型的步骤来让 hello-world 运行？，即

1.  下载 XX
2.  写一些代码做YY
3.  更改文件 ZZ
4.  其他步骤...

注意：仅仅因为我家里有一台 windows 机器，如果它可以在 windows 上运行，我更愿意运行，但为了更好的答案，欢迎基于 linux/mac 的实现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T09:19:03.937

一开始我会选择 JBoss AS 或 GlassFish。但是，我不确定 Java EE“Hello World”是什么意思。如果您只想部署一些 JSP，您可以使用本教程（针对 JBoss）：

[http://www.centerkey.com/jboss/](http://www.centerkey.com/jboss/)

如果您想更进一步并做 EJB 堆栈和/或部署一个 ear-file，您可以阅读非常好的 JBoss 文档：

[安装指南](http://www.redhat.com/docs/manuals/jboss/jboss-eap-4.3/doc/Installation_Guide/html/index.html)

[入门](http://www.redhat.com/docs/manuals/jboss/jboss-eap-4.3/doc/Getting_Started/html/index.html)

[配置指南](http://www.redhat.com/docs/manuals/jboss/jboss-eap-4.3/doc/Server_Configuration_Guide/html/index.html)

一般来说，您也可以只进行基本安装和更改或尝试预安装的示例应用程序。

我目前安装了 JBoss（在 Windows 上）。我使用 Eclipse 进行开发并使用 Java EE 服务器集成来热部署或调试我的代码。在你运行你的第一个代码之后，你真的应该看看 ide 集成，因为它使开发/部署往返速度更快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T09:12:13.703

JavaEE（他们放弃了 2）空间非常大。一个很好的入门教程是[来自 Sun 的](http://java.sun.com/javaee/5/docs/tutorial/doc/)教程。对于一个简单的 hello world 应用程序，Web 容器就足够了。一个众所周知的 servlet jsp 容器是 tomcat。有关安装说明，请参见[此处](http://www.coreservlets.com/Apache-Tomcat-Tutorial/)。尝试使用 eclipse 安装它并创建一个 web 项目。这将为您生成一些文件，您可以查看和编辑。启动和停止应用程序服务器也更简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-20T09:08:56.913

另一种选择是获取[Oracle JDeveloper](http://www.oracle.com/technology/products/jdev/index.html)（免费下载和使用 - 它是一个功能齐全的 IDE，包括一些简洁的附加功能，如 SQL 工作台和 BPEL 设计器）。

作为一个学习工具，它非常好，不仅适用于 Oracle 提供的教程，而且它在工具本身中包含了一系列“提示卡”课程，用于教授许多常用技术。

[提示卡视图 http://tardate.heroku.com/images/jdev-cuecards.jpg](http://tardate.heroku.com/images/jdev-cuecards.jpg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T09:30:46.513

如果您有一段时间没有接触过 NetBeans，它会很快赶上 Eclipse，值得一看，尤其是在启动 Java EE 时。

6.x 版为您安装 Tomcat 和/或 Glassfish，然后提供创建/部署/重新部署应用程序的向导。

Web 应用程序的初始教程在[这里](http://www.netbeans.org/kb/60/web/quickstart-webapps.html)，更复杂的示例[在这里](http://www.netbeans.org/kb/60/web/tutorial-webapps.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T09:25:40.753

正如 JeroenWyseur 所说，Java EE 是一个相当大的空间。除了他所说的之外，您还应该尝试了解您将要做什么的更多细节：servelts & co、EJB（实体、会话、消息 bean？）并尝试熟悉这些。

您应该清楚，您的代码在托管环境中运行，这会带来很多限制。为了确保您了解发生了什么，您应该熟悉部署的概念。那么，如果您使用 EJB，那么事务管理也很重要。如果您不确切了解部署 bean 或 servlet 时会发生什么、如何管理事务、如何调用 bean，那么您将遇到困难。

Ed Roman 所著的《精通 EJB》是一本对我帮助很大的书。

此外，熟悉 RMI 将帮助您了解 EJB。

# emacs - Emacs，切换到上一个窗口

> ID：91071
> 
> 赞同：97
> 
> 时间：2008-09-18T09:02:41.527
> 
> 标签：emacs

在 Emacs 中，`C-x o`将我带到下一个窗口。

什么键盘宏将我带到 Emacs 中的上一个窗口？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-09-18T20:27:11.600

您可能还想尝试使用 windmove，它可以让您根据几何图形导航到您选择的窗口。我的 .emacs 文件中有以下内容可以使用 Cx 箭头键更改窗口。

```
(global-set-key (kbd "C-x <up>") 'windmove-up)
(global-set-key (kbd "C-x <down>") 'windmove-down)
(global-set-key (kbd "C-x <right>") 'windmove-right)
(global-set-key (kbd "C-x <left>") 'windmove-left) 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2008-09-18T09:05:05.327

那将是`C-- C-x o`

换句话说，`C-x o`参数为 -1。`C-u`您可以通过在和 命令之间插入数字参数来指定要移动的窗口数量，如`C-u 2 C-x o`. （`C--`是 的快捷方式`C-u - 1`）

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-06-25T05:57:05.830

我个人更喜欢使用[`window-number.el`](http://www.emacswiki.org/emacs-es/NumberedWindows)

要选择不同的窗口，请使用`Ctrl`- `x`, `Ctrl`- `j` *n*

其中*n*是窗口的编号，每个窗口的模式行显示它的编号，如屏幕截图所示。

![](https://i.imgur.com/7Qm7H.png)

只需下载[window-number.el](https://www.emacswiki.org/emacs/download/window-number.el)，将其放在您的 emacs 加载路径中，然后在您的`.emacs`

```
 (autoload 'window-number-mode "window-number"
   "A global minor mode that enables selection of windows according to
 numbers with the C-x C-j prefix.  Another mode,
 `window-number-meta-mode' enables the use of the M- prefix."
   t) 
```

还有另一种类似的模式[`switch-window.el`](https://github.com/dimitri/switch-window)，它可以在窗口中为您提供大数字......（按下数字会切换窗口并恢复显示。）

[![](https://i.stack.imgur.com/nsXUO.png)](https://i.stack.imgur.com/nsXUO.png)
[（来源：[tapoueh.org](http://tapoueh.org/images/emacs-switch-window.png)）]

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-02-16T04:54:55.750

如果您经常使用多个 emacs 窗口 (>3)，并且您希望保存一些击键，请将其添加到您的 init 文件中，这样会更好：

```
(defun frame-bck()
  (interactive)
  (other-window-or-frame -1)
)
(define-key (current-global-map) (kbd "M-o") 'other-window-or-frame)
(define-key (current-global-map) (kbd "M-O") 'frame-bck) 
```

现在只需使用 Mo 在窗口中快速循环

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-08-01T02:52:36.453

这里有一些非常好的和完整的答案，但是以极简的方式回答这个问题：

```
 (defun prev-window ()
   (interactive)
   (other-window -1))

 (define-key global-map (kbd "C-x p") 'prev-window) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-05-21T10:58:28.730

基于@Nate 的想法，但稍作修改以支持窗口之间的向后循环

```
;; Windows Cycling
(defun windmove-up-cycle()
  (interactive)
  (condition-case nil (windmove-up)
    (error (condition-case nil (windmove-down)
         (error (condition-case nil (windmove-right) (error (condition-case nil (windmove-left) (error (windmove-up))))))))))

(defun windmove-down-cycle()
  (interactive)
  (condition-case nil (windmove-down)
    (error (condition-case nil (windmove-up)
         (error (condition-case nil (windmove-left) (error (condition-case nil (windmove-right) (error (windmove-down))))))))))

(defun windmove-right-cycle()
  (interactive)
  (condition-case nil (windmove-right)
    (error (condition-case nil (windmove-left)
         (error (condition-case nil (windmove-up) (error (condition-case nil (windmove-down) (error (windmove-right))))))))))

(defun windmove-left-cycle()
  (interactive)
  (condition-case nil (windmove-left)
    (error (condition-case nil (windmove-right)
         (error (condition-case nil (windmove-down) (error (condition-case nil (windmove-up) (error (windmove-left))))))))))

(global-set-key (kbd "C-x <up>") 'windmove-up-cycle)
(global-set-key (kbd "C-x <down>") 'windmove-down-cycle)
(global-set-key (kbd "C-x <right>") 'windmove-right-cycle)
(global-set-key (kbd "C-x <left>") 'windmove-left-cycle) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-10-01T04:02:04.417

只是添加到@Nate、@aspirin 和@Troydm 的答案，如果您决定将windmove 命令绑定到您选择的任何组合键，我发现这是一个非常有用的补充：

```
(setq windmove-wrap-around t) 
```

使用默认配置，当您尝试移动到不存在的窗口时会收到错误消息，这会在一段时间后变得有点烦人。但是，当设置了 windmove-wrap-around 时，例如尝试移出框架的底部将改为选择框架中最顶部的窗口。这对您来说可能是一种更直观的行为。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-11-28T10:23:46.210

`M-n`对我来说最`M-p`有意义，因为它们类似于`C-n`( **next-line** ) 和`C-p`( **previous-line** )：

```
(define-key global-map (kbd "M-p") 'previous-multiframe-window)
(define-key global-map (kbd "M-n") 'other-window) 
```

（灵感来自[这个](https://stackoverflow.com/a/17984479)和[那个](https://stackoverflow.com/a/9305758)）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-06-10T13:24:03.730

参考 Nate 的回答，我替换了`arrow keys`使用传统`p`的 for going `up`、`n`for going `down`、`f`for going`right`和`b`for going `left`。我还将`Ctrl`with`Super`键替换为`C-p, C-n, C-f and C-b`默认移动键。这种组合`M`使您可以跳过字符和行，而不是在每次击键后逐个处理。因此`Super`，key 认为是保持其简单键绑定的最佳选择。此外，现在您不必再将手从主行移开！

```
(global-set-key (kbd "s-p") `windmove-up)
(global-set-key (kbd "s-n") `windmove-down)
(global-set-key (kbd "s-f") `windmove-right)
(global-set-key (kbd "s-b") `windmove-left) 
```

希望能帮助到你！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-02-01T20:06:21.640

```
(global-unset-key (kbd "M-j"))
(global-unset-key (kbd "M-k"))
(global-set-key (kbd "M-j") (lambda () (interactive) (other-window 1)))
(global-set-key (kbd "M-k") (lambda () (interactive) (other-window -1))) 
```

`alt``j`并将`alt``k`循环通过您的可见缓冲区。准确地说，向前和向后。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-30T23:06:02.183

已经有一个包可以让你使用 M- 切换窗口。[检查这个网站](http://emacs-fu.blogspot.co.uk/2008/12/easy-switching-between-visible-buffers.html)。将此添加到您的初始化文件中：

```
(require 'windmove)
(windmove-default-keybindings 'meta) ;; or use 'super to use windows key instead alt 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-04-09T11:40:12.230

```
(global-set-key (kbd "C-x a") 'ace-swap-window)  
(global-set-key (kbd "C-x q") 'ace-select-window)

download ace-window from the melpa repo if you don't know how to do that
put this in your .emacs file if you don't have one create it 

(package-initialize)                                                                                                                                                                     

(require 'package)                                                                                                                                                                       
(add-to-list 'package-archives '("melpa" , "http://melpa.org/packages/"))                                                                                                                

(package-initialize) 

then "m-x list-packages" 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-10-07T17:42:31.860

我发现切换到上一个窗口的最快方法是将**几个键混合在一起**作为["key-chord"](https://www.emacswiki.org/emacs/KeyChord)。以下内容可让您同时使用左小指+无名指转到上一个窗口：

```
(key-chord-define-global "qw" 'prev-window)
(key-chord-define-global "'y" 'other-window) ; bonus for my colemak, adjust otherwise
(key-chord-define-global ";'" 'other-window) ; probably normal 
```

*（这是可能的，因为 Emacs 键和弦是顺序无关的，这意味着它`qw`与`wq`.）*

# windows - 为什么easyphp会停止多个PC上的所有apache进程？

> ID：91086
> 
> 赞同：0
> 
> 时间：2008-09-18T09:06:54.433
> 
> 标签：windows, apache, process, easyphp

在某些 Windows PC 上，当我在另一个网络端口上配置了 easyPHP 和独立的 apache 服务并具有特定的服务名称时，我遇到了一个问题：当我停止 easyphp 时，另一个 apache 也停止了。

这个问题不会出现在我拥有的所有 PC 上，但对我来说似乎很奇怪。任何的想法？

雷达回答后的更多信息：我的进程有一个特殊的名称（ecapache），但easyphp似乎不使用进程，而是直接启动服务器。

谢谢塞德里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T12:46:50.723

也许它杀死它的方式是它找到所有称为“apache”或类似的进程并杀死它们，无论它是否“拥有”它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T13:12:43.480

我认为两者是集成在一起的，由于端口号，我并没有出现在所有 PC 中。

# c# - 如何让我的 C# 程序休眠 50 毫秒？

> ID：91108
> 
> 赞同：306
> 
> 时间：2008-09-18T09:11:49.727
> 
> 标签：c#, vb.net

如何让我的 C# 程序休眠 50 毫秒？

这似乎是一个简单的问题，但我有一个暂时的脑力衰竭时刻！

* * *

## 回答 #1

> 赞同：380
> 
> 时间：2008-09-18T09:14:16.817

```
System.Threading.Thread.Sleep(50); 
```

但请记住，在主 GUI 线程中执行此操作会阻止您的 GUI 更新（它会感觉“缓慢”）

只需删除它`;`以使其也适用于 VB.net。

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2011-04-21T12:07:50.747

在（几乎）任何编程语言中等待基本上有 3 种选择：

1.  **松散的等待**
    *   在给定时间内执行线程块（= 不消耗处理能力）
    *   阻塞/等待线程无法处理
    *   没那么精确
2.  **紧等待**（也称为紧循环）
    *   处理器在整个等待时间间隔内都非常繁忙（实际上，它通常会消耗一个内核 100% 的处理时间）
    *   等待时可以执行一些操作
    *   非常精确
3.  **前2的 **组合**

    *   它通常结合了 1\. 的处理效率和 2\. 的严谨性 + 做某事的能力。** 

 *** * *

**1\. - C# 中的松散等待：**

```
Thread.Sleep(numberOfMilliseconds); 
```

然而，windows 线程调度程序会导致 15 毫秒`Sleep()`左右的准确度（因此睡眠可以轻松等待 20 毫秒，即使计划仅等待 1 毫秒）。

**2\. - C# 中的紧张等待是：**

```
Stopwatch stopwatch = Stopwatch.StartNew();
while (true)
{
    //some other processing to do possible
    if (stopwatch.ElapsedMilliseconds >= millisecondsToWait)
    {
        break;
    }
} 
```

我们也可以使用`DateTime.Now`或其他时间测量方法，但`Stopwatch`速度要快得多（这在紧密循环中确实变得可见）。

**3\. - 组合：**

```
Stopwatch stopwatch = Stopwatch.StartNew();
while (true)
{
    //some other processing to do STILL POSSIBLE
    if (stopwatch.ElapsedMilliseconds >= millisecondsToWait)
    {
        break;
    }
    Thread.Sleep(1); //so processor can rest for a while
} 
```

此代码定期将线程阻塞 1 毫秒（或稍长，取决于操作系统线程调度），因此处理器在阻塞时间并不忙，代码不会消耗 100% 的处理器功率。其他处理仍然可以在阻塞之间执行（例如：更新 UI、处理事件或进行交互/通信）。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2008-09-18T13:26:54.683

您无法在 Windows 中指定*确切的*睡眠时间。为此，您需要一个实时操作系统。您可以做的最好的事情是指定*最短*睡眠时间。然后由调度程序来唤醒你的线程。并且**永远不要**调用`.Sleep()`GUI 线程。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2012-12-03T14:07:44.817

由于现在你有 async/await 功能，睡眠 50 毫秒的最佳方法是使用 Task.Delay：

```
async void foo()
{
    // something
    await Task.Delay(50);
} 
```

或者，如果您的目标是 .NET 4（针对 VS2010 或 Microsoft.Bcl.Async 使用 Async CTP 3），则必须使用：

```
async void foo()
{
    // something
    await TaskEx.Delay(50);
} 
```

这样你就不会阻塞 UI 线程。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-09-18T09:14:36.707

使用此代码

```
using System.Threading;
// ...
Thread.Sleep(50); 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-18T10:19:33.573

```
Thread.Sleep(50); 
```

该线程将不会被操作系统安排在指定的时间内执行。此方法将线程的状态更改为包含 WaitSleepJoin。

此方法不执行标准 COM 和 SendMessage 泵送。如果您需要在具有 STAThreadAttribute 的线程上休眠，但您想要执行标准 COM 和 SendMessage 泵送，请考虑使用指定超时间隔的 Join 方法的重载之一。

```
Thread.Join 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-03-27T00:59:43.483

为了可读性：

```
using System.Threading;
Thread.Sleep(TimeSpan.FromMilliseconds(50)); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-05T18:50:23.403

从 .NET Framework 4.5 开始，您可以使用：

```
using System.Threading.Tasks;

Task.Delay(50).Wait();   // wait 50ms 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2016-10-28T18:54:13.823

两全其美：

```
using System.Runtime.InteropServices;

    [DllImport("winmm.dll", EntryPoint = "timeBeginPeriod", SetLastError = true)]
    private static extern uint TimeBeginPeriod(uint uMilliseconds);

    [DllImport("winmm.dll", EntryPoint = "timeEndPeriod", SetLastError = true)]
    private static extern uint TimeEndPeriod(uint uMilliseconds);
    /**
     * Extremely accurate sleep is needed here to maintain performance so system resolution time is increased
     */
    private void accurateSleep(int milliseconds)
    {
        //Increase timer resolution from 20 miliseconds to 1 milisecond
        TimeBeginPeriod(1);
        Stopwatch stopwatch = new Stopwatch();//Makes use of QueryPerformanceCounter WIN32 API
        stopwatch.Start();

        while (stopwatch.ElapsedMilliseconds < milliseconds)
        {
            //So we don't burn cpu cycles
            if ((milliseconds - stopwatch.ElapsedMilliseconds) > 20)
            {
                Thread.Sleep(5);
            }
            else
            {
                Thread.Sleep(1);
            }
        }

        stopwatch.Stop();
        //Set it back to normal.
        TimeEndPeriod(1);
    } 
```

# bash - 如何匹配sed中的单引号

> ID：91110
> 
> 赞同：43
> 
> 时间：2008-09-18T09:12:09.570
> 
> 标签：bash, shell, sed, escaping

如果表达式用单引号括起来，如何匹配 sed 中的单引号：

```
sed -e '...' 
```

例如需要匹配这个文本：

```
'foo' 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-18T09:24:12.817

您可以使用：

```
"texta'textb" (APOSTROPHE inside QUOTATION MARKs) 
```

或者

```
'texta'\''textb' (APOSTROPHE text APOSTROPHE, then REVERSE SOLIDUS, APOSTROPHE, then APOSTROPHE more text APOSTROPHE) 
```

我使用了 unicode 字符名称。REVERSE SOLIDUS 通常被称为反斜杠。

在后一种情况下，您关闭撇号，然后用反斜杠对撇号进行壳引用，然后为其余文本打开另一个撇号。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-16T00:05:12.603

正如对问题的评论中所指出的，这实际上与 sed 无关，而是如何在 shell（例如 bash）的带引号的字符串中包含引号。

为了澄清先前的答案，您需要使用反斜杠转义引号，但您不能在单引号表达式中执行此操作。从 bash 手册页：

> 将字符括在单引号中会保留引号内每个字符的字面值。单引号之间不能出现单引号，即使前面有反斜杠。

因此，您需要终止带引号的表达式，插入转义的引号，并开始一个新的带引号的表达式。shell 的引号删除不会添加任何额外的空格，因此实际上您得到了字符串连接。

因此，要回答如何单引号表达式 'foo' 的原始问题，您可以执行以下操作：

```
sed -e '...'\''foo'\''...' 
```

（其中 '...' 是 sed 表达式的其余部分）。

总的来说，为了便于阅读，如果可能的话，最好将周围的引号更改为双引号：

```
sed -e "...'foo'..." 
```

[作为第一种（单引号）方法的潜在维护噩梦的示例，请注意 StackOverflow 的语法如何突出显示引号、反斜杠和其他文本的颜色——这绝对是不正确的。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-03T19:55:51.857

对于sed，一个很简单的解决办法就是把单引号格式改成双引号。

对于包含单引号的给定变量

```
var="I'm a string with a single quote" 
```

如果双引号用于 sed，这将匹配单引号。

```
echo $var | sed "s/'//g"
Im a string with a single quote 
```

而不是单引号，这会挂起

```
echo $var | sed 's/'//g' 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-07-31T14:03:48.827

您还可以使用`[']`来匹配文字单引号，而无需执行任何 shell 引用技巧。

```
myvar="stupid computers can't reason about life"
echo "$myvar" | sed -e "s/[']t//" 
```

输出：

```
stupid computers can reason about life 
```

# sql - SQL查询计算坐标接近度

> ID：91116
> 
> 赞同：7
> 
> 时间：2008-09-18T09:13:51.810
> 
> 标签：sql, geocoding

我正在使用这个公式来计算我的 (My)SQL 数据库中的条目之间的距离，这些条目具有十进制格式的纬度和经度字段：

```
6371 * ACOS(SIN(RADIANS( %lat1% )) * SIN(RADIANS( %lat2% )) + 
COS(RADIANS( %lat1% )) * COS(RADIANS( %lat2% )) * COS(RADIANS( %lon2% ) - 
RADIANS( %lon1% ))) 
```

适当地替换 %lat1% 和 %lat2% 可以在 WHERE 子句中使用它来查找另一个条目的某个半径内的条目，在 ORDER BY 子句中使用它和 LIMIT 将找到最近的 x 条目等。

我写这篇文章主要是为了给自己做笔记，但总是欢迎改进。:)

注意：正如下面 Valerion 所提到的，这是以公里为单位计算的。[用适当的替代数字](http://en.wikipedia.org/wiki/Earth_radius)替换 6371以使用米、英里等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T19:53:25.513

对于不支持三角函数的数据库（例如 SQLite），您可以使用勾股定理。

这是一种更快的方法，即使您的数据库确实支持三角函数，但需要注意以下几点：

*   您需要将坐标存储在 x,y 网格中，而不是（或以及）lat,lng；
*   计算假设“地球平坦”，但这对于相对局部的搜索来说很好。

这是我正在处理的 Rails 项目的一个示例（重要的是中间的 SQL）：

```
class User < ActiveRecord::Base
  ...
  # has integer x & y coordinates
  ...

  # Returns array of {:user => <User>, :distance => <distance>}, sorted by distance (in metres).
  # Distance is rounded to nearest integer.
  # point is a Geo::LatLng.
  # radius is in metres.
  # limit specifies the maximum number of records to return (default 100).
  def self.find_within_radius(point, radius, limit = 100)

    sql = <<-SQL
      select id, lat, lng, (#{point.x} - x) * (#{point.x} - x) + (#{point.y} - y) * (#{point.y} - y) d 
      from users where #{(radius ** 2)} >= d 
      order by d limit #{limit}
    SQL

    users = User.find_by_sql(sql)
    users.each {|user| user.d = Math.sqrt(user.d.to_f).round}
    return users
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T09:18:18.947

我认为这是Haversine公式是否正确？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T10:27:13.773

我在车辆跟踪应用程序上使用了完全相同的方法，并且已经使用了多年。它工作得很好。快速检查一些旧代码显示我将结果乘以 6378137，如果内存服务转换为米，但我已经很长时间没有碰它了。

我相信 SQL 2008 有一个新的空间数据类型，我想它允许在不知道这个公式的情况下进行这些类型的比较，并且还允许可能很有趣的空间索引，但我没有研究它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T23:06:28.147

我一直在使用它，但忘记了我在哪里得到它。

```
SELECT n, SQRT(POW((69.1 * (n.field_geofield_lat - :lat)) , 2 ) + POW((53 * (n.field_geofield_lon - :lon)), 2)) AS distance FROM field_revision_field_geofield n ORDER BY distance ASC 
```

# project-management - 软件项目的基础设施

> ID：91122
> 
> 赞同：4
> 
> 时间：2008-09-18T09:14:42.823
> 
> 标签：project-management, naming-conventions, infrastructure

我很快就会领导一个新项目。我一直在思考软件项目的基本基础设施是什么。这些是我认为每个项目都应该具备的东西：

- 编码风格约定

- 命名约定

-标准项目目录结构（如maven标准目录布局等）

-项目管理和问题跟踪（例如trac、redmine等）

- 持续集成服务器（例如，hudson、巡航控制等）

我不确定我是否错过了什么。有人想补充吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T09:20:49.640

作为初步答案，请查看 Joel 测试： [http ://www.joelonsoftware.com/articles/fog0000000043.html](http://www.joelonsoftware.com/articles/fog0000000043.html)

只是开胃菜：

> 1.  你使用源代码控制吗？
> 2.  您可以一步构建吗？
> 3.  你做日常构建吗？
> 4.  你有错误数据库吗？
> 5.  在编写新代码之前你会修复错误吗？
> 6.  你有最新的时间表吗？
> 7.  你有规格吗？
> 8.  程序员有安静的工作环境吗？
> 9.  您是否使用金钱可以买到的最好的工具？
> 10.  你有测试人员吗？
> 11.  新候选人在面试时会写代码吗？
> 12.  你做走廊可用性测试吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T09:20:36.490

*   修订控制系统（例如颠覆、cvs、git）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T09:17:51.787

除了你的，我会说：

*   单元测试策略
*   集成测试策略
*   定义的过程
*   发布（交付）策略（如里程碑、工作包等）
*   源代码控制分支策略

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T09:21:28.143

*   文档怎么样 - 如何（代码中的注释，高级规范），何时，数量，谁
*   你将如何测试——单元/验收/用户测试
*   代码版本控制，一些 SVN/Git（或者它是否包含在 trac 中？）
*   团队角色和职责 - 需要在项目的 ocntext 中完成

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:23:02.127

我也会将文件共享服务器加入其中。我认为版本控制是如此基础，以至于我什至懒得把它放在列表中。但它是一个很好的版本控制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T22:43:48.603

配置管理计划。您需要有一个记录在案的方法来处理您的开发工作流，以及您将如何在它们之间进行合并等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T09:21:50.107

知识管理至关重要。由于您已经计划使用 wiki（如 Trac 或[Redmine](http://www.redmine.org/)），您也可以将其用于 KM。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T09:25:38.287

功能测试是任何项目的强制性部分。单元测试很棒，它适用于敏捷项目，但功能测试仍然是必要的。您至少需要一个基本的测试计划。如果您计划有多个项目或子项目，则测试策略文档或 Wiki 页面会很好。测试用例、验收测试用例等可以由您的用户故事或其等价物驱动，但它们仍然必须以某种形式存在。

# .net - 如何最好地将字符串表示形式转换为 DbType？

> ID：91124
> 
> 赞同：0
> 
> 时间：2008-09-18T09:14:55.053
> 
> 标签：.net, database, converter

假设我有一个字符串“nvarchar(50)”，例如用于创建该类型表的 T-SQL 字符串段。如何最好地将其转换为 System.Data.DbType 的枚举表示？

它能否处理在 T-SQL 中编写类型的多种不同可能方式，例如：

```
[nvarchar](50) 
nvarchar 50 
```

@Jorge Table：是的，这很方便，但是没有预烘焙的转换器吗？否则很好的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T09:18:21.957

希望这个映射表能完成这项工作。

[http://www.carlprothman.net/Default.aspx?tabid=97](http://www.carlprothman.net/Default.aspx?tabid=97)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T15:12:04.507

我的第一次尝试将涉及使用正则表达式来解析声明的两个部分（其中第二部分仅用于可变大小的类型。）确保在解析时将类型名称转换为小写。

您可以创建一个包含所有各种类型的枚举（小写），然后使用 Enum.Parse 获取枚举值的实例，然后使用 switch-case 为每个获取适当的 System.Data.DbType枚举值。

有点恶心，我承认。

# c# - 在 C# 中验证 TreeView 的拖放操作的最佳方法

> ID：91127
> 
> 赞同：2
> 
> 时间：2008-09-18T09:15:10.467
> 
> 标签：c#, validation, user-controls, treeview

我想验证是否允许拖放操作。有效项目可以来自我们的另一个“控件”，也可以来自内部自定义树视图。目前我有这个：

```
bool CanDrop(DragEventArgs e)
{
    bool allow = false;
    Point point = tree.PointToClient(new Point(e.X, e.Y));
    TreeNode target = tree.GetNodeAt(point);
    if (target != null)
    {
        if (CanWrite(target)) //user permissions
        {
            if (e.Data.GetData(typeof(DataInfoObject)) != null) //from internal application
            {
                DataInfoObject info = (DataInfoObject)e.Data.GetData(typeof(DataInfoObject));
                DragDataCollection data = info.GetData(typeof(DragDataCollection)) as DragDataCollection;
                if (data != null)
                {
                    allow = true;
                }
            }
            else if (tree.SelectedNode.Tag.GetType() != typeof(TreeRow)) //node belongs to this & not a root node
            {
                if (TargetExistsInNode(tree.SelectedNode, target) == false)
                {
                    if (e.Effect == DragDropEffects.Copy)
                    {
                        allow = true;
                    }
                    else if (e.Effect == DragDropEffects.Move)
                    {
                        allow = true;
                    }
                }
            }
        }
    }
    return allow;
} 
```

我已将所有检查代码移至此方法以尝试改进，但对我来说这仍然很可怕！

这么多的逻辑，以及这么多的事情，我希望树视图会自己做（例如。“TargetExistsInNode”检查被拖动的节点是否被拖动到它的一个子节点）。

验证控件输入的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T12:18:01.540

我使用 TreeNode.Tag 属性来存储构成逻辑的小型“控制器”对象。例如：

```
class TreeNodeController {
  Entity data; 

  virtual bool IsReadOnly { get; }
  virtual bool CanDrop(TreeNodeController source, DragDropEffects effect);
  virtual bool CanDrop(DataInfoObject info, DragDropEffects effect);
  virtual bool CanRename();
}

class ParentNodeController : TreeNodeController {
  override bool IsReadOnly { get { return data.IsReadOnly; } } 
  override bool CanDrop(TreeNodeController source, DragDropEffect effect) {
    return !IsReadOnly && !data.IsChildOf(source.data) && effect == DragDropEffect.Move;
  }
  virtual bool CanDrop(DataInfoObject info, DragDropEffects effect) {
    return info.DragDataCollection != null;
  }
  override bool CanRename() { 
    return !data.IsReadOnly && data.HasName;
  }
}

class LeafNodeController : TreeNodeController {
  override bool CanDrop(TreeNodeController source, DragDropEffect effect) {
    return false;
  }
} 
```

然后我的 CanDrop 会是这样的：

```
bool CanDrop(DragDropEventArgs args) {
  Point point = tree.PointToClient(new Point(e.X, e.Y));
  TreeNode target = tree.GetNodeAt(point);
  TreeNodeController targetController = target.Tag as TreeNodeController;

  DataInfoObject info = args.GetData(typeof(DataInfoObject)) as DataInfoObject;
  TreeNodeController sourceController = args.GetData(typeof(TreeNodeController)) as TreeNodeController;

  if (info != null) return targetController.CanDrop(info, e.Effect);
  if (sourceController != null) return targetController.CanDrop(sourceController, e.Effect);
  return false;
} 
```

现在，对于我添加到树中的每一类对象，我可以通过选择将哪个 TreeNodeController 放入 Tag 对象来专门化行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T09:09:49.513

没有严格回答您的问题，但我在您的代码中发现了一个错误。 `DragDropEffects`设置了 flags 属性，因此您可以`e.Effect`按位组合复制和移动。在这种情况下，您的代码将错误地返回 false。

# language-agnostic - OO 设计，开放/封闭原则问题

> ID：91137
> 
> 赞同：7
> 
> 时间：2008-09-18T09:17:30.053
> 
> 标签：language-agnostic, oop, ooad, open-closed-principle

我一直在考虑这个面向对象的设计问题，但无法提出令人满意的解决方案，所以我想在这里向人群开放以征求意见。

我有一个代表回合制棋盘游戏的*Game*类，出于这个问题的目的，我们可以假设它类似于 Monopoly。在我的设计中，我有一个包含方法*TakeTurn的**Player*类。

 **Game*循环遍历所有*Player*并调用 TakeTurn 方法来完成所有必要的事情以完成转弯。我希望能够拥有 n 个玩家，并且能够将任意数量的玩家设置为电脑玩家。所以，我的想法是有一个 HumanPlayer 类和一个*ComputerPlayer*类，它们都派生自 Player。

*Game*只知道*Player*类，并简单地依次调用每个*Player的**TakeTurn*方法。我的问题在于，*ComputerPlayer*对象可以完全自动化，即与 Monopoly 示例保持一致，可以使用某种逻辑决定购买房产。现在，对于*HumanPlayer*对象，它需要从实际用户那里获得输入才能购买房产，例如，这似乎暗示了不同的界面，并且可能意味着它们不应该派生

 ****如果不让Game*类明确知道各种*Player*类的实际实现，我就无法为这个问题提出一个好的解决方案。我总是可以在*Game*类中假设永远只有人类和计算机玩家并有效地关闭它以进行扩展，但这似乎不是好的 OO 编程。

对此的任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T09:21:29.937

我认为你不应该让 Game 类处理 IO。这样，（阻塞的）TakeTurn 方法将从游戏板中隐藏执行方式。它可以使用其他对象与用户进行通信。

所有 Game 类都应该关注的是棋盘和转牌的状态。玩家应该都实现一个单一的 Player 接口，并从游戏中隐藏所有实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-20T20:29:18.480

如果游戏正在管理游戏状态**并**进行 I/O，则游戏做的太多了。

您希望 Game 只关注规则、回合和状态变化。游戏不知道玩家是什么；它只知道它有玩家。

您希望玩家检查游戏状态并在轮到他们时执行法律行动。

人类玩家和整个游戏*都*共享一个通用 I/O 包，该包显示游戏状态并提示人类输入。

`Observable`您可以通过将 I/O 包作为`Observer`游戏的一部分来充分利用 Java 。这样，游戏状态更改会报告给 I/O 以进行显示或记录或两者兼而有之。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-14T16:32:44.193

我可能不会有两个`HumanPlayer`和类，而是在创建时使用正确的输入策略配置`ComputerPlayer`的单个类。`Player`

玩家获取信息以决定其在下一轮游戏中的移动的方式是*唯一*不同的东西（至少与最初的问题描述不同），因此只需将其封装在一个单独的抽象中。

任何设置游戏的高级类也应该创建两组玩家（一个是人类，另一个是计算机模拟的），每个玩家都有适当的输入策略，然后简单地将这些玩家对象提供给游戏对象。然后，Game 类将只`TakeTurn`为每个新回合调用给定玩家列表上的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T09:22:10.370

与其告诉游戏类只有一个人，不如让它在游戏的菜单/初始化过程中获得输入？如果有更多玩家，可以在游戏类初始化之前通过某种形式的输入（在菜单中选择玩家）来决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T09:25:10.707

*Player*呈现给*Game*的接口与派生的*Player*类的行为是正交的。

*TakeTurn*的实现取决于*Player*对象的具体类型这一事实不应引起关注。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T09:23:21.290

我认为`Game`Class 不应该关心 Player 类的任何实现，也应该忽略用户界面。

任何用户输入都需要由`HumanPlayer`该类处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T09:41:20.840

我不确定这是否是你想要的

```
public abstract class Player 
{
  int position;
  DecisionMaker decisionDependency;

  ...

  public void TakeTurn()
  {
    position += RollDice();
    GameOption option GetOptions(position);
    MakeDescion(option);
  }

  protected int RollDice()
  {
    //do something to get the movement
  }

  protected abstract void MakeDecision(GameOption option);

}

Public class ComputerPlayer : Player
{
  public ComputerPlayer()
  {
    decisionDependency = new AIDecisionMaker();
  }

  protected override void void MakeDecision(GameOption option)
  {
    decisionDependency.MakeDecision(option);
    //do stuff, probably delgate toan AI based dependency
  }
}

Public class HumanPlayer : Player
{
  public HumanPlayer()
  {
    decisionDependency = new UIDecisionMaker();
  }

  protected override void void MakeDecision(GameOption option)
  {
    decisionDependency.MakeDecision(option);
    //do stuff, probably interacting with the a UI or delgate to a dependency
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T10:09:05.983

我想说，*Game*类不应该关心这是计算机玩家还是人类玩家。它应该总是在下一个播放器类上调用*TakeTurn 。*如果这是一个人类玩家，那么*Player*类的职责就是与用户交流并询问用户要做什么。这意味着它将阻止直到用户下定决心。由于 UI 交互通常发生在应用程序的主线程中，因此唯一重要的是阻塞的*TakeTurn不会阻塞整个应用程序，否则在**Game*等待*TakeTurn*时无法处理用户输入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T07:25:09.557

**玩家应该在Game**类上调用***TakeTurn*** ，而不是**Game**类对所有玩家调用***TakeTurn***，而Game**类**应该验证是否轮到了正确的玩家。

 **这应该有助于解决**用户**和**计算机**播放器问题。

# wcf - 在 IIS 中托管具有编程设置的 WCF 终结点

> ID：91143
> 
> 赞同：3
> 
> 时间：2008-09-18T09:18:08.807
> 
> 标签：wcf, iis

我需要在 IIS 中托管一个公开 wsHttpBinding 的 WCF 服务。使用我的 web.config 中的 system.serviceModel 设置，该部分运行良好。

我现在需要的是通过客户端也使用的配置程序集来设置配置（如 maxReceivedMessageSize 和其他选项）。

这怎么可能？我在我的 .svc 文件中看不到任何句柄，就像在我的客户端中一样，无法重载绑定配置。我怀疑这是因为它在应用程序启动时由 ISS 自动处理，这与您必须手动声明客户端/通道的 Windows 服务不同。

我说得对吗？他的问题的解决方案（如果我仍然想在 IIS 中托管）是否会删除所有配置，而是创建一个 HttpHandler 来处理启动时的托管？

如果我是对的，我想我只是浪费了大量的空间来写这篇文章，但我不禁认为我错过了一些东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T09:21:28.203

你错过了一些东西:)

创建一个自定义[ServiceHost](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx)并[在 .svc 文件中使用它](http://msdn.microsoft.com/en-us/library/aa395224.aspx)；在自定义服务主机中完成所有配置

# mysql - Mysql存储过程中的可选参数

> ID：91150
> 
> 赞同：8
> 
> 时间：2008-09-18T09:19:22.953
> 
> 标签：mysql

如何在 mysql 存储过程中创建可选参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T09:23:43.893

根据[这个错误](http://bugs.mysql.com/bug.php?id=15975)，目前没有办法创建可选参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T18:55:57.877

mySQL 存储过程不支持可选参数，目前也没有任何添加此功能的计划。我建议为可选参数传递 null 。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-29T19:21:08.487

我使用的（有点笨拙的）解决方法是定义一些我认为我可能会使用的参数，然后在使用之前测试可选参数的值是否为 NOT NULL：

```
CREATE PROCEDURE add_product(product_name VARCHAR(100), product_price FLOAT,
                             cat1 INT, cat2 INT, cat3 INT)
-- The cat? parameters are optional; provide a NULL value if not required
BEGIN

  ...

  -- Add product to relevant categories  
  IF cat1 IS NOT NULL THEN
    INSERT INTO products_to_categories (products_id, categories_id) VALUES (product_id, cat1);
  END IF;
  IF cat2 IS NOT NULL THEN
    INSERT INTO products_to_categories (products_id, categories_id) VALUES (product_id, cat2);
  END IF;
  IF cat3 IS NOT NULL THEN
    INSERT INTO products_to_categories (products_id, categories_id) VALUES (product_id, cat3);
  END IF;

END 
```

如果我不想在调用存储时使用该参数，我只需传递一个 NULL 值。这是调用上述存储过程的示例：

```
CALL add_product("New product title", 25, 66, 68, NULL); 
```

# flashlite - Flash Lite 中的 XMLSockets？

> ID：91158
> 
> 赞同：0
> 
> 时间：2008-09-18T09:21:15.427
> 
> 标签：flashlite, xmlsocket

XMLSockets 在 Flash **Lite**中是否可用，如果是，在哪些版本中可用，常规对象和 lite 对象之间是否存在差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:25:06.430

我无法告诉您 Flash 和 Flash Lite 中的 XML 套接字之间的确切区别，但 Flash Lite 2.1 版和更高版本肯定支持它们。有关示例，请参阅[Flash 移动博客。](http://flashmobileblog.com/examples/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-16T22:09:10.060

我们使用它们在 Flash 9 (PC) 和 Flashlite3.1 (ARM) 中发送和接收文本字符串，而无需更改代码。除非在 XML 解析中存在差异，否则您可能会很高兴。

# .net - 如何最好地将 DbType 转换为 System.Type？

> ID：91160
> 
> 赞同：9
> 
> 时间：2008-09-18T09:21:24.633
> 
> 标签：.net, converter

如何最好地将 System.Data.DbType 枚举值转换为相应的（或至少一个可能的相应）System.Type 值？

例如：

```
DbType.StringFixedLength -> System.String 
DbType.String -> System.String
DbType.Int32 -> System.Int32 
```

我只看到了非常“肮脏”的解决方案，但没有什么真正干净的。

（是的，这是我的另一个问题的后续，但作为两个单独的问题更有意义）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T09:24:53.907

AFAIK .NET 中没有用于将 SqlDbType 转换为 System.Type 的内置转换器。但是了解映射后，您可以轻松推出自己的转换器，从简单的字典到更高级的（基于 XML 的可扩展性）解决方案。

映射可以在这里找到：http: [//www.carlprothman.net/Default.aspx?tabid=97](http://www.carlprothman.net/Default.aspx?tabid=97)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-04T19:15:18.710

System.Data.SqlClient 对象使用 MetaType 组件将 DbType 和 SqlDbType 转换为 .NET CLR 类型。使用反射，您可以在需要时利用此功能：

```
var dbType = DbType.Currency;

Type metaClrType = Type.GetType(
    "System.Data.SqlClient.MetaType, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089",
    true,
    true
    );

object metaType = metaClrType.InvokeMember(
    "GetMetaTypeFromDbType",
    BindingFlags.InvokeMethod | BindingFlags.Static | BindingFlags.NonPublic,
    null,
    null,
    new object[] { dbType }
);

var classType = (Type)metaClrType.InvokeMember(
    "ClassType",
    BindingFlags.GetField | BindingFlags.Instance | BindingFlags.NonPublic,
    null,
    metaType,
    null
);

string cSharpDataType = classType.FullName; 
```

# unix - 什么进程正在监听 Solaris 上的某个端口？

> ID：91169
> 
> 赞同：29
> 
> 时间：2008-09-18T09:22:37.703
> 
> 标签：unix, solaris

于是我登录到一个 Solaris 盒子，尝试启动 Apache，发现已经有一个进程在监听 80 端口，而且不是 Apache。我们的盒子没有安装 lsof，所以我无法查询。我想我可以这样做：

```
pfiles `ls /proc` | less 
```

并寻找“端口：80”，但如果有人有更好的解决方案，我会全力以赴！如果我可以在没有 root 的情况下寻找聆听过程，那就更好了。我对 shell 和 C 解决方案都持开放态度；下次出现这种情况时，我不介意随身携带一个小的自定义可执行文件。

更新：我说的是我不是管理员的 solaris 的通用安装（尽管我确实有超级用户访问权限），所以从免费软件磁盘安装东西不是一种选择。显然，两者都没有对 fuser、netstat 或其他工具使用特定于 Linux 的扩展。不幸的是，到目前为止，在**所有**进程上运行 pfiles 似乎是最好的解决方案。如果情况仍然如此，我可能会发布一个答案，其中包含一些比上面的剪辑更有效的代码。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-05T14:36:07.977

我在某个地方找到了这个脚本。我不记得在哪里，但它对我有用：

```
#!/bin/ksh

line='---------------------------------------------'
pids=$(/usr/bin/ps -ef | sed 1d | awk '{print $2}')

if [ $# -eq 0 ]; then
   read ans?"Enter port you would like to know pid for: "
else
   ans=$1
fi

for f in $pids
do
   /usr/proc/bin/pfiles $f 2>/dev/null | /usr/xpg4/bin/grep -q "port: $ans"
   if [ $? -eq 0 ]; then
      echo $line
      echo "Port: $ans is being used by PID:\c"
      /usr/bin/ps -ef -o pid -o args | egrep -v "grep|pfiles" | grep $f
   fi
done
exit 0 
```

编辑：这是原始来源： [[Solaris] 哪个进程绑定到给定端口？](http://blogs.oracle.com/JoachimAndres/entry/solaris_which_process_is_bound1)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-24T20:25:23.270

这是一个单行：

```
ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep 80' 
```

每次搜索之前都会打印“回显检查进程 PID”，因此一旦您看到引用端口 80 的输出，您就会知道哪个进程正在持有该句柄。

或者使用：

```
ps -ef| grep $USER|awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep 80' 
```

因为'pfiles'可能不喜欢你试图访问其他用户的进程，除非你当然是root。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-03-14T14:24:34.513

Mavroprovato 的答案报告的不仅仅是监听端口。侦听端口是没有对等点的套接字。下面的 Perl 程序只报告监听端口。它适用于我在 SunOS 5.10 上。

```
#! /usr/bin/env perl
##
## Search the processes which are listening on the given port.
##
## For SunOS 5.10.
##

use strict;
use warnings;

die "Port missing" unless $#ARGV >= 0;
my $port = int($ARGV[0]);
die "Invalid port" unless $port > 0;

my @pids;
map { push @pids, $_ if $_ > 0; } map { int($_) } `ls /proc`;

foreach my $pid (@pids) {
    open (PF, "pfiles $pid 2>/dev/null |") 
        || warn "Can not read pfiles $pid";
    $_ = <PF>;
    my $fd;
    my $type;
    my $sockname;
    my $peername;
    my $report = sub {
        if (defined $fd) {
            if (defined $sockname && ! defined $peername) {
                print "$pid $type $sockname\n"; } } };
    while (<PF>) {
        if (/^\s*(\d+):.*$/) {
            &$report();
            $fd = int ($1);
            undef $type;
            undef $sockname;
            undef $peername; }
        elsif (/(SOCK_DGRAM|SOCK_STREAM)/) { $type = $1; }
        elsif (/sockname: AF_INET[6]? (.*)  port: $port/) {
            $sockname = $1; }
        elsif (/peername: AF_INET/) { $peername = 1; } }
    &$report();
    close (PF); } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-07T06:14:36.953

```
#!/usr/bin/bash
# This is a little script based on the "pfiles" solution that prints the PID and PORT.

pfiles `ls /proc` 2>/dev/null | awk "/^[^ \\t]/{smatch=\$0;next}/port:[ \\t]*${1}/{print smatch, \$0}{next}" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-30T11:20:36.497

从 Solaris 11.2 开始，您确实可以使用该`netstat`命令执行此操作。看看[这里](https://blogs.oracle.com/casper/entry/solaris_11_2_user_pid)。`-u`开关就是您要找的。

如果您使用的是较低版本的 Solaris，那么 - 正如其他人所指出的那样 - Solaris 执行此操作的方式是某种围绕`pfiles`命令的脚本包装器。请注意，尽管该`pfiles`命令会暂停该过程一秒钟以检查它。对于 99.9% 的流程，这并不重要。不幸的是，我们有一个进程，如果它被`pfiles`命令击中，它将给出核心转储，因此我们对使用该命令有点谨慎。如果您在 99.9% 中，您的情况可能会完全不同，这意味着您可以安全地使用该`pfiles`命令。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-06-19T16:54:19.317

Solaris 上的 netstat 不会告诉您这一点，旧版本的 lsof 也不会，但如果您下载并构建/安装新版本的 lsof，它可以告诉您这一点。

```
$ lsof -v
lsof version information:
    revision: 4.85
    latest revision: ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/
    latest FAQ: ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/FAQ
    latest man page: ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/lsof_man
    configuration info: 64 bit kernel
    constructed: Fri Mar 7 10:32:54 GMT 2014
    constructed by and on: user@hostname
    compiler: gcc
    compiler version: 3.4.3 (csl-sol210-3_4-branch+sol_rpath)
    8<- - - - ***SNIP*** - - - 
```

有了这个，您可以使用 -i 选项：

```
$ lsof -i:22
COMMAND   PID     USER   FD   TYPE             DEVICE   SIZE/OFF NODE NAME
sshd      521     root    3u  IPv6 0xffffffff89c67580        0t0  TCP *:ssh (LISTEN)
sshd     5090     root    3u  IPv6 0xffffffffa8668580   0t322598  TCP host.domain.com:ssh->21.43.65.87:52364 (ESTABLISHED)
sshd     5091   johngh    4u  IPv6 0xffffffffa8668580   0t322598  TCP host.domain.com:ssh->21.43.65.87:52364 (ESTABLISHED) 
```

这向您确切显示了您的要求。

昨天我遇到了一个崩溃的 Jetty (Java) 进程的问题，该进程在其 /proc/[PID] 目录中只留下了 2 个文件（psinfo 和用法）。

pfiles 找不到进程（因为它需要的日期不存在）

lsof 帮我找到了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-22T23:26:42.450

您可能不想这样做，但最好的办法是获取 sunfreeware CD 并安装 lsof。

除此之外，是的，您可以在 /proc 中使用 shell 脚本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-03T16:39:11.470

我认为第一个答案是我编写自己的 shell 脚本来开发这个想法的最佳答案：

```
#!/bin/sh
if [ $# -ne 1 ]
then
    echo "Sintaxis:\n\t"
    echo " $0 {port to search in process }"
    exit
else
    MYPORT=$1
    for i in `ls /proc`
    do

       pfiles $i | grep port | grep "port: $MYPORT" > /dev/null
       if [ $? -eq 0 ]
         then
           echo " Port $MYPORT founded in $i proccess !!!\n\n"
           echo "Details\n\t"
           pfiles $i | grep port | grep "port: $MYPORT"
           echo "\n\t"
           echo "Process detail: \n\t"
           ps -ef | grep $i  | grep -v grep
       fi
    done
fi 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-08T13:49:56.620

这是一种间接的方法，但是您可以查看网站是否从端口 80 上运行的任何内容加载到您选择的 Web 浏览器上。或者您可以远程登录到端口 80，看看您是否收到可以为您提供线索的响应到该端口上正在运行的内容，您可以将其关闭。由于端口 80 是 http 流量的默认端口，因此默认情况下会在那里运行某种 http 服务器，但不能保证。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T09:26:32.513

很可能是 sun 的管理服务器。它通常与 sun 的目录以及默认安装中的一些其他 webmin-ish 东西捆绑在一起

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-09-18T09:25:54.573

如果您有权访问`netstat`，则可以做到这一点。

# javascript - 使 Web 应用程序可访问

> ID：91170
> 
> 赞同：0
> 
> 时间：2008-09-18T09:23:10.680
> 
> 标签：javascript, html, usability, accessibility

在我可以诚实地告诉自己我的 Web 应用程序可供任何人访问之前，必须做些什么？或者更好的是，说服乔克拉克。我没有任何需要担心的视频或音频，所以我知道我不需要成绩单。我还需要检查什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-20T23:49:30.057

您还应该查看 WAI-ARIA 的内容：

*   [http://www.w3.org/WAI/intro/aria](http://www.w3.org/WAI/intro/aria)
*   [http://alistapart.com/articles/waiaria](http://alistapart.com/articles/waiaria)
*   [http://juicystudio.com/article/wai-aria-live-regions.php](http://juicystudio.com/article/wai-aria-live-regions.php)

而且，要了解各种残障用户在尝试使用 Web 时实际面临的挑战，请查看周五在伦敦举行的 Scripting Enabled 会议上的一些演示文稿和视频：http: [//scriptingenabled.org /](http://scriptingenabled.org/)（我认为它们还没有全部上传）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T09:25:51.220

您的问题非常模糊，但简而言之，您需要确保您的网站符合[Web Content Accessibility Guidelines](http://www.w3.org/TR/WCAG10/)的三个级别（A、AA 或 AAA）之一。

FWIW，根据我的经验，如果您提供的不是纯静态 HTML 网站，请瞄准 AA。试图严格遵循 WCAG 指南以达到动态网站的 AAA 标准是 IMO 脱发之路。这可能会随着 WCAG 2.0 而改变。

祝你好运！

**编辑：** @Blowdart 建议通过在线检查器运行您的网站。这很好，只要您意识到许多 WCAG 指南（尤其是针对高端的）非常随意，只能用人眼进行验证。

不要相信这些在线检查器的输出，并盲目地在您的网站上贴上 AAA 徽章。如果你被召唤，你可能会遇到麻烦。

+1 Blowdart 建议 HTML 和 CSS 验证，Chris Pederick 的插件*很棒*！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T11:21:03.377

如果该站点在禁用 JavaScript 和 CSS 的情况下可用，那么您做得很好。Firefox 中的 Web Developer 工具栏可让您轻松禁用这两者。另一种检查方法是使用 Lynx，一种命令行、纯文本浏览器。除此之外，您最好的选择是根据适用的任何准则（在美国，通常是第 508 节）启发式地检查该站点。没有任何网站是完全可访问的，但做这些事情将确保您的网站非常容易访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T09:26:22.420

通过一堆检查器运行它。检查 HTML 是否有效。尝试在禁用脚本的情况下使用它。尝试在禁用 CSS 的情况下使用它。您可以使用Firefox的[Web 开发者插件完成所有这些操作](https://addons.mozilla.org/en-US/firefox/addon/60)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-06T19:29:14.387

在线可访问性检查器可以提供帮助，遵循 WCAG 可以提供帮助，使用屏幕阅读器的演示版本尝试您的站点会有所帮助，但“确保”站点可访问的唯一方法是让专家为您检查它，或者成为专家你自己。幸运的是，如果您确实遵循 WCAG 2.0，使用屏幕阅读器进行测试，并运行在线测试，98% 的情况下，您会没事的。但是如果你想要保证...

# windows - Excel 报表框架

> ID：91178
> 
> 赞同：1
> 
> 时间：2008-09-18T09:25:06.480
> 
> 标签：windows, excel

有没有可用的 Excel 报告框架？我们需要将一些报告导出为 Excel 格式。我们的应用程序是 java 应用程序，因此任何支持 java 的东西都会很棒。我已经尝试过 Apache POI API，但这还不够好。任何基于 Windows API 的框架都会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T15:52:17.903

FYI, JasperReports uses POI for Excel-conversion.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T09:26:19.050

[SQL Server Reporting Services](http://www.microsoft.com/sql/technologies/reporting/default.mspx)具有导出到 Excel 的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-21T22:53:24.037

您能否详细说明您不喜欢 Apache POI 的哪些方面？我已经使用 POI 多年了，还没有发现任何东西不能通过在这里或那里进行调整或采取创造性的方法来完成。恕我直言，它是目前最好的开源（免费）Excel 生成/报告框架。

如果您愿意付钱，那么 Actuate 可能是最好的解决方案。Actuate 的 e.Spreadsheet Engine 和 Excel API，您可以读取、编写、修改和生成整个电子表格或部分电子表格。我用过它，他们的 API 比 POI 更丰富、更简单。POI 虽然功能强大，但感觉就像是随着时间的推移而发展起来的 API，并且有许多开发人员参与创建功能和补丁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:46:43.943

Try [xlsgen](http://xlsgen.arstdesign.com/), supports Java (but can only run under Windows).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-26T05:29:22.890

你也可以试试 jxl，但老实说它的 API 比 POI 更混乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T15:07:52.427

为什么 poi 对你来说不够好？

另一种可能是碧玉报告。我已经用这个而不是 poi 了几次，体验很愉快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-12T19:09:00.040

[Xylophone](https://github.com/CourseOrchestra/xylophone)是 LGPL Java 库和命令行实用程序，它使用 Apache POI，但减轻了它的大部分缺点。

它使用 XML 格式的数据、XLS(X) 格式的电子表格模板，并使复杂的 Excel 报告的生成更加有趣。[您可以在这篇文章中](https://dzone.com/articles/producing-spreadsheet-reports-using-xylophone)了解它。由于许可和安全问题，这对于 Java 后端来说肯定是比 Windows API 更好的选择。

# java - Java Swing GUI 的自动化测试

> ID：91179
> 
> 赞同：74
> 
> 时间：2008-09-18T09:25:08.663
> 
> 标签：java, swing, testing, automated-tests

为用 Java Swing 编写的 GUI 构建自动化测试有哪些选择？

我想测试一些使用[NetBeans Swing GUI Builder](http://www.netbeans.org/features/java/swing.html)编写的 GUI ，因此不需要对被测代码进行特殊篡改的工作将是理想的。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2015-09-24T21:15:13.367

最近我遇到了看起来很有希望的 FEST，只是开发商[在 2012 年宣布不会继续开发](https://groups.google.com/forum/#!msg/easytesting/bAt1nWx55FM/e3DF0bxGUf8J)。

[AssertJ](https://joel-costigliola.github.io/assertj/)是 FEST 的一个分支，对我来说效果很好。它得到积极维护（在撰写本文时），支持 Java 8，对一些流行的库（如 Guava 和 Joda Time）有断言，并且有很好的文档记录。它也是免费和开放的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-18T11:15:26.840

我目前正在使用[FEST](http://code.google.com/p/fest/)。它可以与 JUnit 一起使用，并且还会截取失败测试的屏幕截图。

它具有默认的组件搜索方法，用于查找正在测试的组件的名称（需要手动设置），但您也可以通过将组件传递给给定组件来生成给定组件的测试器。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-16T11:56:53.580

您可以尝试使用[Cucumber](http://cukes.info)和[Swinger](http://github.com/demetriusnunes/swinger)为 Swing GUI 应用程序用简单的英语编写功能验收测试。Swinger 在后台使用 Netbeans 的 Jemmy 库来驱动应用程序。

Cucumber 允许您编写如下测试：

```
 Scenario: Dialog manipulation
    Given the frame "SwingSet" is visible
      And the frame "SwingSet" is the container
    When I click the menu "File/About"
    Then I should see the dialog "About Swing!"
    Given the dialog "About Swing!" is the container
    When I click the button "OK"
    Then I should not see the dialog "About Swing!" 
```

看看这个[Swinger 视频演示](https://www.youtube.com/watch?v=YCLsXka_QvA)，看看它的实际效果。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-04-24T12:45:46.917

我们正在考虑 [使用 jemmy](https://jemmy.java.net/)来自动化一些 GUI 测试。看起来很有希望。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-18T13:20:09.723

我用`java.awt.Robot`. 不好，不容易，但每次都有效。

优点：

*   你在掌控之中
*   非常快
*   构建自己的 FWK
*   便携的
*   没有外部依赖

缺点：

*   没有很好的 GUI 来构建测试
*   测试时必须不理会 GUI
*   构建自己的 FWK
*   难以更改测试代码并创建您的第一个工具

现在，如果您有预算，我会选择 LoadRunner。班上最好。

（披露：与拥有LR的公司的关系，但在关系之前我曾与LR合作）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-18T11:39:07.873

我们正在使用[QF-Test](http://www.qfs.de/en/qftest/index.html)并且非常满意。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-18T10:25:12.683

我没有亲自使用过，但是[SwingUnit](https://swingunit.dev.java.net/)看起来还不错。您可以将它与 jUnit 一起使用，它不是基于“组件的位置”（即 x 和 y 坐标）。

您可能需要对 NetBeans GUI Builder 做的唯一事情就是为您的组件设置唯一的名称。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-01-04T09:49:16.830

您可以使用[**Marathon**](http://marathontesting.com/)：“Marathon 集成测试环境 MarathonITE 是一种经济实惠、易于使用且跨平台的 Java/Swing™ GUI 测试自动化框架。您可以使用 MarathonITE 的内置脚本记录器来创建干净、可读的测试脚本在 Python 或 Ruby 中。提取方法重构、创建数据驱动测试和对象映射编辑等高级功能允许您创建可维护的、有弹性的测试套件。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-06-28T07:09:27.657

Sikuli：使用屏幕截图的 GUI 测试器 [http://sikuli.org/](http://sikuli.org/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-03-04T22:22:42.940

您可以尝试[ReTest](https://www.retest.de/en/)，这是一种新颖的工具，它实现了功能回归测试的创新方法，并将其与基于 AI 的猴子测试相结合。它也即将成为开源......

免责声明：我是 ReTest 背后公司的创始人之一。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-01-29T16:45:06.660

对于那些有冒险精神的人，有 gooey [https://github.com/robertoaflores/Gooey](https://github.com/robertoaflores/Gooey)一个（非常基本且开发不足的）用于摇摆应用程序的程序化测试工具。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-10-21T19:30:06.633

只是做了一些快速扫描。[Squish](http://www.froglogic.com/squish/gui-testing/editions/java.php)是最有前途的。虽然不是免费的

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-03-03T11:16:55.110

您可以使用[sikuli](http://www.sikuli.org/)或[Automa](http://www.getautoma.com/)来测试您的 GUI 部分，这些都是有据可查和经过测试的工具

# .net - 巡航控制和混淆，如何？

> ID：91181
> 
> 赞同：0
> 
> 时间：2008-09-18T09:25:22.703
> 
> 标签：.net, continuous-integration, cruisecontrol.net, obfuscation

这是我对stackoverflow的第一个问题，所以就在这里...

我将巡航控制用于我的持续集成方案，我想使用混淆来为我的程序集添加另一个保护层。问题是我不知道该怎么做，因为我找不到描述这个的文章。包含其他 CI 工具（例如 NAnt）的建议也被接受。

商业工具也是一种选择，因此请不要犹豫，将它们包含在您的答案中。我正在构建并想要混淆的应用程序大多是用 Compact Framework 2.0、Dot Net 2.0-3.5 编写的。

目前 Cruise Control 检查存储库中的更改，然后基于特定解决方案的脚本下载并使用 devenv 构建项目，在运行安装项目后，它将安装文件复制到不同的文件夹中，更多或少它。所以我需要在这个过程中的某个地方混淆..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T20:30:45.770

@konstantinos.konstantinidis.myopenid.com：您的问题似乎出在安装项目而不是持续集成服务器上。

您让设置项目获取项目的主要输出。

将其更改为使用对输出的文件引用。在设置项目中需要进行更多配置，但我认为您仍然可以实现所有相同的功能。

这样，您就可以从您的混淆工具将它们转储到的任何暂存目录中获取您的混淆程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T09:28:01.013

很高兴听到有人在使用 CruiseControl.NET。这是一个很好的工具。您可以使用命令行工具作为 RemoteSoft .NET Obfuscator 进行混淆，并在构建脚本中集成对该工具的调用。请参阅如何从 CruiseControl.NET wiki 执行以下文件的示例。

[http://www.remotesoft.com/salamander/obfuscator.html](http://www.remotesoft.com/salamander/obfuscator.html)

```
<exec>
    <executable>make</executable>
    <baseDirectory>D:\dev\MyProject</baseDirectory>
    <buildArgs>all</buildArgs>
    <buildTimeoutSeconds>10</buildTimeoutSeconds>
    <successExitCodes>0,1,3,5</successExitCodes>
    <environment>
        <variable>
            <name>MyVar1</name>
            <value>Var1Value</value>
        </variable>
        <variable name="MyVar2" value="Var2Value"/>
        ...
    </environment>
</exec> 
```

# python - 我需要在 python 中编写代码以使用指纹技术比较两个文档的文本

> ID：91183
> 
> 赞同：3
> 
> 时间：2008-09-18T09:25:30.347
> 
> 标签：python, diff

我需要用 python 语言编写代码来使用指纹技术比较文档的文本。我不知道获取文件指纹或生成文件指纹。我在问是否有人知道该方法或具有用于生成以位形式存储的文档指纹的源代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T09:39:06.413

If you want [message digests](http://en.wikipedia.org/wiki/Cryptographic_hash_function) (cryptographic hashes), use the [hashlib](http://docs.python.org/lib/module-hashlib.html) library. Here's an example ([IPython](http://ipython.scipy.org/) session):

```
 In [1]: import hashlib

 In [2]: md = hashlib.sha256(open('/tmp/Calendar.xls', 'rb').read())

 In [3]: md.hexdigest()
 Out[3]: '8517f1eae176f1a20de78d879f81f23de503cfd6b8e4be1d798fb2342934b187'

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T09:41:55.283

You might try the following papers to get started with the concept of fingerprinting:

*   [Winnowing: Local Algorithms for Document Fingerprinting](http://theory.stanford.edu/~aiken/publications/papers/sigmod03.pdf)
*   [Scalable Document Fingerprinting](http://www.cs.cmu.edu/afs/cs/user/nch/www/koala/main.html)

# .net - 删除 DataGridView 行

> ID：91196
> 
> 赞同：0
> 
> 时间：2008-09-18T09:28:00.327
> 
> 标签：.net, winforms

`DataGridView`按键时如何删除边界线`Delete`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T09:42:12.913

如果您在框架 3.5 上，看起来 DataGridView 上有一个方法来处理删除键。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.processdeletekey.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.processdeletekey.aspx)

否则，我建议捕获表单按键事件并向后工作以获取活动/选定的 DataGridView 行以知道要处理哪一个。

# apache-flex - 您如何以编程方式判断 Flex 应用程序是否在调试模式下运行？

> ID：91198
> 
> 赞同：5
> 
> 时间：2008-09-18T09:28:04.383
> 
> 标签：apache-flex, flash, actionscript-3, debugging

是否可以在 Flex 应用程序中编写仅在调试版本或通过调试器运行时运行的代码？Flex 是否提供了一种从发布版本中完全删除代码的方法，例如 C 风格的#defines？

该应用程序不一定在网页中运行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T10:51:19.080

您可以像这样进行条件编译：

```
CONFIG::debugging {
    // this will be removed if CONFIG::debugging resolves to false at compile time
} 
```

然后将其添加到编译器标志中：

```
-define+=CONFIG::debugging,true 
```

用于调试构建，以及

```
-define+=CONFIG::debugging,false 
```

用于发布版本。`CONFIG`and`debugging`可以是任何东西，比如`MY_AWESOME_NAMESPACE`and `fooBar`，没关系。

在这里阅读更多：[使用条件编译](http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_21.html)。

# emacs - 如何为新语言编写 emacs 模式？

> ID：91201
> 
> 赞同：60
> 
> 时间：2008-09-18T09:28:58.747
> 
> 标签：emacs, mode

我想为 4GL 编写一个**Emacs 主模式**。有人可以给我看一个教程吗？据我谷歌搜索，我只能找到这个破碎的：

链接[http://two-wugs.net/emacs/mode-tutorial.html](http://two-wugs.net/emacs/mode-tutorial.html)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-20T16:07:03.477

如果您很懒惰，一种简单的方法是扩展`generic-mode`以了解您的新语言：

[http://emacswiki.org/emacs/GenericMode](http://emacswiki.org/emacs/GenericMode)

我经常为我经常使用的应用程序的配置文件执行此操作，以获得体面的语法突出显示。 [这是](http://lists.digium.com/pipermail/asterisk-dev/attachments/20050113/a1304cae/asterisk-mode.obj)我很久以前为星号 PBX 做的一个例子。

# c# - 有没有一种在 Direct3d 中绘制凹多边形的有效\简单方法

> ID：91202
> 
> 赞同：5
> 
> 时间：2008-09-18T09:29:05.457
> 
> 标签：c#, directx, polygon, concave

我正在尝试使用 c# 和 directx 绘制多边形

我得到的只是文件中点的有序列表，我需要在 3d 世界中绘制平面多边形。

我可以使用三角扇和drawuserprimitives加载点并绘制凸形。

当多边形非常凹（可能是）时，这显然会导致错误的结果。

我无法想象我是唯一一个解决这个问题的人（虽然我是 gfx/directx 新手——我的背景是 gui\windows 应用程序开发）。

任何人都可以指出一个简单的资源\教程\算法可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T09:35:01.463

Direct3D 只能绘制三角形（好吧，它也可以绘制线和点，但除了点之外）。所以如果你想画任何比三角形更复杂的形状，你必须画一堆与那个形状相等的三角形。

在您的情况下，这是一个凹多边形三角剖分问题。给定一堆顶点，您可以将它们保持原样，您只需要计算“索引缓冲区”（在最简单的情况下，每个三角形的三个索引表示三角形使用哪些顶点）。然后通过放入顶点/索引缓冲区或使用 DrawUserPrimitives 来绘制它。

[VTerrain 站点上](http://www.vterrain.org/Implementation/Libs/triangulate.html)提供了一些用于对简单（凸面或凹面，但没有自相交或孔）多边形进行三角剖分的算法。

我过去使用过 Ratcliff 的代码；非常简单并且效果很好。VTerrain 有一个死链接；代码可以在[这里](http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml)找到。它是 C++，但将其移植到 C# 应该很简单。

哦，不要使用三角扇。它们的用途非常有限，效率低下并且很快就会消失（例如 Direct3D 10 不再支持它们）。只需使用三角形列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T10:02:44.627

三角剖分是他显而易见的答案，但很难写出一个可靠的三角剖分。除非你有两个月的时间可以浪费，否则不要尝试。

有几个代码可以帮助你：

GPC 库。非常易于使用，但您可能不喜欢它的许可证：

[http://www.cs.man.ac.uk/~toby/alan/software/gpc.html](http://www.cs.man.ac.uk/~toby/alan/software/gpc.html)

还有三角形：

[http://www.cs.cmu.edu/~quake/triangle.html](http://www.cs.cmu.edu/~quake/triangle.html)

和拳头：

[http://www.cosy.sbg.ac.at/~held/projects/triang/triang.html](http://www.cosy.sbg.ac.at/~held/projects/triang/triang.html)

另一个（也是我更喜欢的）选项是使用 GLU tesselator。您可以很好地从 DirectX 程序加载和使用 GLU 库。它不需要 OpenGL 上下文来使用它，它预装在所有 Windows 机器上。如果您想要源代码，您可以从 SGI 参考实现中提取三角测量代码。我做过一次，只花了我几个小时。

到目前为止三角测量。还有一种不同的方法：您可以使用模板技巧。

一般算法是这样的：

1.  禁用颜色和深度写入。启用模板写入并设置模板缓冲区，它将反转当前模板值。一点模具就足够了。哦 - 你的模板缓冲区也应该被清除。

2.  在屏幕上随机选择一个点。任何人都会做。将此点称为您的锚点。

3.  对于多边形的每条边，从构建边和锚点的两个顶点构建一个三角形。画出那个三角形。

4.  绘制完所有这些三角形后，关闭模板写入，打开模板测试和颜色写入，然后以您选择的颜色绘制全屏四边形。这将只填充凸多边形内的像素。

将锚点放置在多边形的中间并绘制一个与多边形的边界框一样大的矩形是个好主意。这样可以节省一点填充率。

顺便说一句 - 模板技术也适用于自相交多边形。

希望它有帮助，尼尔斯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-07T00:26:42.477

如果您能够使用模板缓冲区，则应该不难做到。这是一个通用算法：

```
Clear the stencil buffer to 1.
Pick an arbitrary vertex v0, probably somewhere near the polygon to reduce floating-point errors.
For each vertex v[i] of the polygon in clockwise order:
    let s be the segment v[i]->v[i+1] (where i+1 will wrap to 0 when the last vertex is reached)
    if v0 is to the "right" of s:
        draw a triangle defined by s, v[i], v[i+1] that adds 1 to the stencil buffer
    else
        draw a triangle defined by s, v[i], v[i+1] that subtracts 1 from the stencil buffer
end for
fill the screen with the desired color/texture, testing for stencil buffer values >= 2. 
```

“s 的权利”是指站在 v[i] 上并面向 v[i+1] 的人的角度。这可以通过使用叉积来测试：

交叉(v0 - v[i], v[i+1] - v[i]) > 0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-30T18:47:38.580

我只需要为一个项目做这个。我发现的最简单的算法称为“Ear Clipping”。一篇很棒的论文在这里：[TriangulationByEarClipping.pdf](http://www.geometrictools.com/Documentation/TriangulationByEarClipping.pdf)

我花了大约 250 行 c++ 代码和 4 个小时来实现它的蛮力版本。其他算法具有更好的性能，但这很容易实现和理解。

# python - 在 Python 3.0 中，标准库中的所有内容都会将字符串视为 unicode 吗？

> ID：91205
> 
> 赞同：12
> 
> 时间：2008-09-18T09:29:23.100
> 
> 标签：python, unicode, string, cgi, python-3.x

既然 Python（从 3.0 开始）是基于 unicode 的，我对标准库的行为方式有点困惑。CGI 和 urllib 等模块会使用 unicode 字符串，还是会使用新的“字节”类型并仅提供编码数据？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T09:52:48.190

从逻辑上讲，像 MIME 编码的邮件消息、URL、XML 文档等很多东西都应该作为`bytes`非字符串返回。这可能会引起一些恐慌，因为 Python 3 的库开始被确定下来，人们发现他们必须更加了解`bytes`/`string`转换而不是`str`/ `unicode`...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T09:58:19.473

这个问题（以及一般的 Python）的一大优点是你可以在解释器中乱搞！[Python 3.0 rc1 目前可供下载](http://www.python.org/download/releases/3.0/)。

```
>>> import urllib.request
>>> fh = urllib.request.urlopen('http://www.python.org/')
>>> print(type(fh.read(100)))
<class 'bytes'> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T10:35:07.187

这里会有两步舞。请参阅[Python 3000 和您](http://www.artima.com/weblogs/viewpost.jsp?thread=227041)。

第 1 步是在 3.0 下运行。

第 2 步是重新考虑您的 API，或许可以做一些更明智的事情。

最有可能的情况是库将切换到 unicode 字符串，以尽可能与它们过去的工作方式保持兼容。

然后，也许有些人会切换到字节以更正确地实现各种协议的 RFC 标准。

# html - 在计划 9 上开始 Web 开发

> ID：91211
> 
> 赞同：6
> 
> 时间：2008-09-18T09:30:28.027
> 
> 标签：html, web-applications, plan-9

一段时间以来，我一直想为 Plan 9 操作系统编程。我真的很想在那里玩一个网络应用程序。当然，我所知道的 Plan 9 的唯一语言是 C，这对于 Web 开发来说似乎并不理想。我也知道它也不运行 apache 或 mysql。

在 Plan 9 上开始编写 Web 应用程序的最佳方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T10:20:02.043

查看 Kenji Arisawa 的[Pegasus](http://plan9.aichi-u.ac.jp/netlib/pegasus/)（[纸质](http://lsub.org/iwp9/cready/pegasus-5.pdf)）网络服务器，用于计划 9。

Plan 9 可能以仅 C 语言而闻名，但包括 Scheme、Ruby、Python 和 Perl 在内的几种语言已经被移植。查看代码的[贡献索引](http://plan9.bell-labs.com/wiki/plan9/Contrib_index/index.html)。

最后，开始阅读 Plan 9[白皮书](http://plan9.bell-labs.com/wiki/plan9/Documentation/index.html)，以便了解其理念。如果你想做网络相关的事情，文件协议[9p](http://plan9.bell-labs.com/sources/contrib/uriel/doc/charles/servers.pdf)是必不可少的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-19T17:55:30.900

[Werc](http://werc.cat-v.org)是一个 Web 框架，旨在在 Plan 9（以及来自用户空间的 Plan 9）上运行。它是使用 rc shell 构建的，并遵循经典的贝尔实验室“工具理念”。

它使用存储在文件系统中的纯文本文件，而不是数据库，与 Unix 传统保持一致。

# java - 将 Java 对象序列化为 Java 代码

> ID：91214
> 
> 赞同：9
> 
> 时间：2008-09-18T09:31:28.133
> 
> 标签：java

有人知道将 Java 对象层次结构序列化为生成该对象层次结构的 Java 代码的 Java 库吗？与 Object/XML 序列化一样，只是输出格式不是二进制/XML，而是 Java 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T09:43:38.230

序列化数据表示对象的内部数据。没有足够的信息来确定您需要在对象上调用哪些方法来重现内部状态。

有两种明显的方法：

*   将序列化的数据编码为文字字符串并反序列化。
*   使用 java.beans XML 持久性，它应该很容易使用您最喜欢的 XML->Java 源技术进行处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T09:44:07.697

我不知道有什么库会开箱即用，但您应该能够将众多对象之一带到 XML 序列化库并自定义后端代码以生成 Java。可能不会有太多代码。

例如，一个快速的谷歌出现了[XStream](http://xstream.codehaus.org/)。我从未使用过它，但它似乎支持 XML 以外的多个后端 - 例如 JSON。您可以实现自己的编写器，只需写出重新创建层次结构所需的 Java 代码。

我相信您可以对其他库执行相同的操作，特别是如果您可以挂钩到 SAX 事件流。

请参阅： [HierarchicalStreamWriter](http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/HierarchicalStreamWriter.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-16T14:48:43.300

好问题。我正在考虑将对象序列化为 java 代码以使测试更容易。用例是将一些数据加载到数据库中，然后生成创建对象的代码，然后在测试方法中使用此代码来初始化数据，而无需访问数据库。

确实，对象状态不包含足够的信息来了解它是如何创建和转换的，但是，对于简单的 java bean，没有理由不应该这样做。

您是否想为此目的编写一个小型库？我很快就会开始编码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T09:40:00.063

XStream 是我用来序列化为 XML 的序列化库。应该可以并且相当容易地对其进行扩展，以便编写 Java 代码。

# php - mysql_real_escape_string 和 addlashes 有什么区别？

> ID：91216
> 
> 赞同：9
> 
> 时间：2008-09-18T09:32:48.160
> 
> 标签：php

`mysql_real_escape_string`并且`addslashes`都是用来在数据库查询前转义数据的，那么有什么区别呢？（这个问题不是关于参数化查询/PDO/mysqli）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T09:42:41.930

> `string mysql_real_escape_string ( string $unescaped_string [, resource $link_identifier ] )`
> `mysql_real_escape_string()`调用 MySQL 的库函数 mysql_real_escape_string，该函数将反斜杠添加到以下字符：\x00、\n、\r、\、'、" 和 \x1a。

> `string addslashes ( string $str )`
> 在需要在数据库查询等中引用的字符之前返回带有反斜杠的字符串。这些字符是单引号 (')、双引号 (")、反斜杠 (\) 和 NUL（NULL 字节）。

它们影响不同的角色。`mysql_real_escape_string`特定于 MySQL。Addslashes 只是一个通用函数，它可能适用于其他事物以及 MySQL。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T11:15:48.587

`mysql_real_escape_string()`*通过可选的link_identifier*参数，具有相对于数据库字符集正确转义文本输入的额外好处。

字符集意识是一个关键的区别。`addslashes()`将在要转义的每个字符的每八位二进制表示之前添加一个斜杠。

如果您使用某种形式的多字节字符集，尽管可能只是由于字符集设计不佳，16 位或 32 位字符表示的一半或两半与字符的八位`addslashes()`相同添加一个斜线到。

在这种情况下，您可能会在不应转义的字符之前添加斜线，或者更糟糕的是，您可能会在十六（或三十二）位字符的中间添加斜线，这会破坏数据。

如果您需要在数据库查询中转义内容，则应`mysql_real_escape_string()`尽可能使用。`addslashes()`如果您确定数据库或表仅使用 7 位或 8 位 ASCII 编码，则很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T09:11:02.270

**情况1：**

```
$str = "input's data";

print mysql_real_escape_string($str);      input\'s data

print addslashes($str);                    input\'s data; 
```

**案例2：**

```
$str = "input\'s data";

print mysql_real_escape_string($str);      input\'s data

print addslashes($str);                    input\\'s data; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T09:42:03.910

这似乎`mysql_real_escape_string`是二进制安全的 - 文档指出：

> 如果要插入二进制数据，则必须使用该函数。

我认为始终使用它可能`mysql_real_escape_string`比添加斜杠更安全。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T09:45:02.827

`mysql_real_escape_string`应该在接收二进制数据时使用，`addslashes`用于文本输入。

您可以在这里看到不同之处：[mysql-real-escape-string](http://www.php.net/function.mysql-real-escape-string)和[addlashes](http://www.php.net/addslashes)

# asp-classic - 检查另一个 Web 服务器是否正在侦听 asp

> ID：91223
> 
> 赞同：0
> 
> 时间：2008-09-18T09:34:00.453
> 
> 标签：asp-classic

我正在使用 Microsoft.XMLHTTP 从旧的 ASP/VBScript 站点的另一台服务器获取一些信息。但是该其他服务器经常重新启动，因此我想在尝试从中提取信息之前检查它是否已启动并运行（或通过以其他方式检测问题来避免我的页面提供 HTTP 500）。

我怎样才能用 ASP 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T09:59:07.660

您可以尝试对服务器进行 ping 操作并检查响应。看看这篇[文章](http://classicasp.aspfaq.com/general/how-do-i-execute-a-ping-command-from-asp-and-retrieve-the-results.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T10:27:48.980

您需要做的就是让代码继续出错，然后发布到另一台服务器并从帖子中读取状态。像这样的东西：

```
PostURL = homelink & "CustID.aspx?SearchFlag=PO"
set xmlhttp = CreateObject("MSXML2.ServerXMLHTTP.3.0") 
```

**错误继续下一步**

```
xmlhttp.open "POST", PostURL, false
xmlhttp.send "" 
```

**状态 = xmlhttp.status**

```
if err.number <> 0 or status <> 200 then
    if status = 404 then
        Response.Write "ERROR: Page does not exist (404).<BR><BR>"
    elseif status >= 401 and status < 402 then
        Response.Write "ERROR: Access denied (401).<BR><BR>"
    elseif status >= 500 and status <= 600 then
        Response.Write "ERROR: 500 Internal Server Error on remote site.<BR><BR>"
    else
        Response.write "ERROR: Server is down or does not exist.<BR><BR>"
    end if
else
    'Response.Write "Server is up and URL is available.<BR><BR>"
    getcustomXML = xmlhttp.responseText
end if
set xmlhttp = nothing 
```

# c# - 列出 VS2008 项目中所有类的名称

> ID：91232
> 
> 赞同：0
> 
> 时间：2008-09-18T09:36:26.920
> 
> 标签：c#, visual-studio-2008, class, list

是否有一种快速而肮脏的方式来获取 Visual Studio 2008 (c#) 项目中所有类的列表？其中有很多，我只是懒得不想手动做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T09:41:47.423

如果您打开“类视图”对话框（视图 -> 类视图或 Ctrl+W、C），您可以获得项目中所有类的列表，然后您可以选择并复制到剪贴板。该副本将发送您选择的所有类的完全限定（即具有完整命名空间）名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T09:39:19.330

我已经成功地使用**[doxygen](http://www.doxygen.nl/)**从我的项目中的 XML 注释生成文档 - 这是一个很好的、超链接的类列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T09:42:25.893

也许您可以编写一个 XSL/XSLT 来仅显示 XML 文档生成的 XML 中的类名（如果有的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:22:55.993

我可能会构建程序集，然后使用反射来遍历所有导出的类型......如果你想要一些示例代码，你可以在[http://www.timvw.be/presenting-assemblytypepicker/](http://www.timvw.be/presenting-assemblytypepicker/)。

# c# - 多个键盘和低级挂钩

> ID：91234
> 
> 赞同：15
> 
> 时间：2008-09-18T09:37:51.333
> 
> 标签：c#, winapi, keyboard, hardware, hook

我有一个系统，我有多个键盘，并且真的需要知道击键来自哪个键盘。解释设置：

1.  我有一台普通的 PC 和 USB 键盘
2.  我有一个带有一些硬键的外部 VGA 屏幕
3.  硬键映射为标准 USB 键盘，发送有限数量的键码（F1、F2、Return、+ 和 -）

我有一个低级钩子（在 C# 中，但实际上调用 Win32 功能），即使我的应用程序没有聚焦，它也能够处理输入。

问题是，当使用普通键盘时，一些映射的键码被外部屏幕上驱动的应用程序拾取。外部屏幕发送并用于确认的按键之一是 VK_RETURN。除非我可以识别“设备”并对其进行过滤，否则用户可能正在执行操作并在他们甚至没有看的屏幕上确认它们。

我怎么知道哪个键盘负责按键？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T14:18:25.167

是的，我得到了纠正，我的错，每天都在学习新的东西。

这是我弥补它的尝试:)：

*   使用 ::RegisterRawInputDevices() 注册要用于原始输入的设备（两个键盘）。

*   您可以从 GetRawInputDeviceList() 获取这些设备

*   注册设备后，您将开始收到 WM_INPUT 消息。

*   WM_INPUT 消息的 lParam 包含一个 RAWKEYBOARD 结构，您可以使用它来确定输入来自的键盘，以及虚拟键码和消息类型（WM_KEYDOWN、WM_KEYUP、...）

*   因此，您可以设置最后一条消息来自何处的标志，然后将其发送到常规键盘输入处理程序。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2008-09-18T10:01:56.330

没有办法做到这一点。Windows 为您抽象了这一点。如前所述，您需要编写/修改设备驱动程序。

# .net - VS：构建时忽略缺少的 XML 注释的属性

> ID：91246
> 
> 赞同：2
> 
> 时间：2008-09-18T09:41:17.783
> 
> 标签：.net, visual-studio-2008, attributes, xml-comments

我有一个使用 xml 文档的 VS2008 解决方案，并且在为发布模式打开错误时我们会收到警告（恕我直言，这是一个不错的功能）；然而，这会导致诸如（自我描述）枚举的每个元素之类的“缺少 xml 注释”错误的长列表。

有谁知道一个属性或类似的东西会关闭对 xml 注释的要求？理想情况下，对于某些分隔区域，而不仅仅是一行（否则我可以在每个项目之前放置空标签，有点违背目的......）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T09:43:45.640

使用#pragma 警告禁用。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/441722ys (VS.80).aspx](http://msdn.microsoft.com/en-us/library/441722ys(VS.80).aspx)

# agile - Scrum 燃尽问题

> ID：91257
> 
> 赞同：19
> 
> 时间：2008-09-18T09:42:53.660
> 
> 标签：agile, scrum

我们已经使用 Scrum 大约 9 个月了，而且基本上是成功的。然而，我们的燃尽图很少看起来像“模型”图表，而更像是一个可怕的过山车，带有一些呕吐物引起的爬升和下降。

为了尝试解决这个问题，我们在 sprint 原型设计和设计之前花费了更多时间，但我们在 sprint 期间发现的工作似乎仍然比最初想象的要多得多。注意：我的意思是满足积压工作所需的工作比最初想象的要复杂得多，而不是我们已经确定了积压工作的新项目。

这是 Scrum 的一个常见问题吗？是否有人有任何提示可以帮助顺利进行？

我应该指出，我们的大部分开发工作都不是全新的，因此我们正在维护现有大型复杂应用程序的功能。Scrum 是否不太适合这种类型的开发仅仅是因为您不知道现有代码会抛出什么问题？

在 sprint 开始制定开发细节之前，我们应该花费多少时间？

更新：我们现在取得了更大的成功和更顺畅的旅程。这主要是因为我们在估计时采取了更加悲观的观点，这给了我们更多的喘息空间来处理没有按计划进行的事情。你可以说它让我们更加“敏捷”。我们还试图改变燃尽图是某种时间表而不是范围v资源指示的看法。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T23:07:50.917

一些关于平滑事物的技巧。

1）正如其他人所说 - 尝试将任务分解成更小的块。更明显的方法是尝试更详细地分解技术任务。在可能的情况下，我鼓励您与产品负责人交谈，看看您是否可以缩小范围或“精简”故事。我觉得后者更有效。如果团队和产品负责人都了解正在讨论的内容，那么兼顾优先级和估计会更容易。

我的一般经验法则是任何大于理想一天一半的估计都可能是错误的:-)

2）尝试做更短的冲刺。如果您正在进行一个月的冲刺 - 尝试两周。如果你做两周 - 尝试一个。

*   它限制了故事的大小——鼓励产品所有者和团队处理更容易准确估计的较小的故事
*   您会更频繁地收到有关您的估计的反馈 - 并且更容易看到您在 sprint 开始时做出的决定与实际发生的事情之间的联系
*   通过练习，一切都会变得更好:-)

3）使用站立和回顾来更多地了解起起落落的原因。是在您花时间处理代码库的特定区域时吗？是民间对产品负责人的误解造成的吗？会占用团队开发时间的随机紧急情况？一旦你对起起落落的来源有了更多的了解，你通常可以专门解决这些问题。再一次 - 较短的冲刺可以帮助使这一点更加明显。

4）相信你的历史。你可能知道这个......但我还是会说 :-) 如果摆弄那个可怕的遗留 Foo 包所花费的时间比你认为它持续 sprint 的时间长 3 倍 - 那么它也需要 3 倍，只要你认为下一个冲刺。无论您认为这次会变得多么有效；-) 相信历史并使用昨天的天气之类的东西来指导您在明年春天的估计。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T16:19:59.583

我很高兴听到 Scrum 对你来说基本上是成功的——这比让 sprint 燃尽图看起来很理想更重要。sprint 燃尽图只是团队的一个工具，可以帮助它了解它是否在实现 sprint 目标的轨道上。如果团队一直在实现冲刺目标，我不会太担心图表看起来像过山车。几点建议

*   在 sprint 回顾中，询问团队额外工作的来源
*   额外的工作可能来自冲刺早期没有进行良好的验收测试
*   额外的工作可能来自没有精心整理的积压工作。一个好的经验法则是提前花费至少 5% 的团队时间来思考下一个 sprint 的故事。
*   监控正在进行的工作——团队是否并行执行了太多工作？
*   在 sprint 计划期间——团队如何看待构成故事的任务分解？

如果您还没有达到 sprint 目标 - 使用既定的团队速度在下一个 sprint 期间承担更少的任务。你必须擅长走路才能跑步。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T12:32:24.797

根据我的经验，Scrum 肯定更倾向于新的开发而不是维护。新的开发比维护一个旧的、大型的代码库更容易预测。

话虽如此，一个可能的问题是您没有将任务分解成足够小的块。总体而言，人们对软件规划的一个常见问题是他们认为“哦，这项任务应该花我 2 天时间”，而没有真正考虑过执行该任务的内容。通常，你会发现，如果你坐下来想一想，这项任务由做 A、B、C 和 D 组成，最终需要超过 2 天的工作时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T10:06:17.193

正如其他人所说，我预计烧毁会上下波动。事情发生了！您应该使用“上下”部分作为回顾的素材。

确保每个人都清楚“正在完成”的含义，并利用这种共同理解来帮助推动您的计划会议。通常，列出可用的已完成内容的清单将（a）帮助您记住您可能忘记的事情，并且（b）可能会引发更多关于任务的想法，否则这些任务将在以后浮出水面。

要考虑的另一点 - 如果您每月都在使用不可预测的代码库工作，我仍然希望您的速度正常化到一个合理稳定的速度。只需根据计划的工作跟踪您的成功，并在计划时最大限度地使用已完成的项目。然后专注于你计划外的任务，看看是否有任何模式表明你可以做不同的事情来将这些事情包括在计划的工作中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:42:29.980

我有过类似的问题。我以前的团队（工作了一年多）很大，我们为一系列初始产品发布维护了一个非常大的、快速变化的代码库。我们的烧毁看起来很可耻，但这是我们能做的最好的。

可能有帮助的一件事（使您的图表看起来更好）是坚持不变的小时数/点数。如果您低估了一项任务，并且不得不加倍工作，请从 sprint 中抽出一些东西。如果你拉入一项新任务，它显然比你的团队承诺的事情具有更高的优先级，因此将其他事情拉出来。

我们尝试在计划中和计划之前将任务分解为许多任务，但这似乎没有帮助。事实上，它只是给了我们更多该死的票，以便在冲刺期间跟踪。需求开始迁移到票证上，并且（毫不奇怪）在所有的洗牌中迷失了方向。

在我的新团队中，我们采取了一种非常激进的方法，并开始创建大票（有些超过一周），上面写着“在 ProjectX 中实现 v1.2 功能”之类的内容。ProjectX 的需求/功能列表（包括 1.2 版）保存在 wiki 上，因此工单非常干净，只跟踪执行的工作。这对我们帮助很大——我们需要跟踪*的*工单要少得多，并且能够完成所有的 sprint，即使我们不断地完成我们的 sprint 任务来帮助其他团队或扑灭火灾。

当（且仅当）我们被迫（被人）引入新项目时，我们会继续将项目推出 sprint。

另一个对我们有帮助的简单提示：将“冲刺总小时数”添加到您的燃尽图。这应该是所有估计值的总和。努力保持这条线平坦可能会有所帮助，并增加您的团队可能面临的问题的可见性（假设这不会让您降级......）

-ab

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T16:06:33.020

我在燃尽时也遇到了类似的问题。我通过精炼包含在燃尽图中的内容来“修复”它。

SiKeep 评论说：

> 它针对为该 sprint 选择的积压工作取得了进展，这可能会也可能不会最终作为一个版本发布。

由于您为 sprint 选择了某些东西，而这就是燃尽图上的内容，我不知道所有“新工作”都应该出现在燃尽图中。我会看到它进入积压工作（不影响燃尽），除非它足够重要到进入你当前的冲刺（然后会在燃尽中显示为上升趋势）。

也就是说，如果趋势线基本上遵循您的预期速度，则**小幅上涨和下跌是正常的。**我会担心你提到的过山车趋势。但是，通过仅在当前 sprint 中添加高优先级项目来隔离燃尽的想法可能有助于抑制燃尽中的这些起伏。

正如其他人所说，冲刺开始之前的计划应该很短......（[不超过4小时](http://www.scrumalliance.org/view/scrum_ceremonies)）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-10T23:06:41.363

我们正在为计划外的任务使用“限时”任务。每当高优先级的工作即将到来，或者突然出现错误时，我们都可以使用时间框的时间（但是，我们永远不能低于零）。这种方法还有一个额外的优势，即我们可以轻松跟踪哪些任务是不可预见的，并在我们的下一个 sprint 计划中将这些事情考虑在内。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T09:49:23.317

您可以在 sprint 的开始日期整合新工作，以获得漂亮的燃尽图。

您可以使用特定标记标记额外的工作，并在 sprint 结束时评估您以前无法识别这些任务的原因。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-13T16:30:19.880

我们现在使用燃尽图。我们不仅绘制了剩余的工作量图表，还绘制了两件事：已完成的工作量和总工作量（即已完成 + 未完成）。

这为您提供了图表上的两条线，当所有工作完成时它们应该相交。它还有一个很大的优势，因为它可以清楚地显示什么时候进展缓慢，因为增加了更多的工作。

如果您愿意，PO“拥有”一行（总工作），开发人员/测试人员“拥有”另一行（完成的工作）。

PO 的行会随着他们添加/删除工作而上升和下降。

开发/测试人员线只会在他们完成工作时上升。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-26T09:21:43.253

文章[**是你的燃尽图吗？**](http://www.scrumdesk.com/is-it-your-burn-down-chart/)解释燃尽图中给定状态的含义。它还提供了如何处理的建议。

文章中描述的一些示例：

![在此处输入图像描述](https://i.stack.imgur.com/jPvvG.png)![在此处输入图像描述](https://i.stack.imgur.com/VZu2W.png)![在此处输入图像描述](https://i.stack.imgur.com/9FoDj.png)![在此处输入图像描述](https://i.stack.imgur.com/ppJRh.png)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-18T09:51:22.330

这是应该的。如果您的燃尽图看起来像模型图，那么您就有麻烦了。该图表将有助于查看您是否能够做出承诺并完成所有故事。

在冲刺期间发现故事总会发生。理想情况下，您将能够预先设计并找出任务，但如果它们奏效了，为什么大型前期设计不起作用？回答你最后一个问题，冲刺计划[最多需要四个小时](http://www.scrumalliance.org/view/scrum_ceremonies)。

# windows - 如果发生错误，在 Windows 控制台中暂停 GNU Make

> ID：91263
> 
> 赞同：5
> 
> 时间：2008-09-18T09:43:52.037
> 
> 标签：windows, makefile, gnu

我负责的应用程序安装的一部分，编译了一些 C 代码库。这是在使用 GNU Make 的控制台中完成的。

因此，作为安装的一部分，会弹出一个控制台窗口，您会在编译和链接时看到 make 文件输出向导，完成后控制台窗口关闭，安装程序继续。

一切都好，除非出现编译错误。然后在您有机会弄清楚发生了什么之前，make 文件会出错并且控制台窗口会关闭。

所以，我想要做的是让控制台窗口暂停，并使用“按键继续”类型的功能，如果 makefile 出现错误，以便控制台保持打开状态。否则，只需正常退出并关闭控制台。

我不知道如何在 GNU Makefile 或可以运行 Make 的批处理文件中执行此操作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T09:45:43.683

这应该可以解决问题：

```
if not ERRORLEVEL 0 pause 
```

键入`help if`DOS 以获取有关错误级别使用的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-21T13:47:59.450

这就是你要找的：

```
if ERRORLEVEL 1 pause 
```

* * *

如果你输入

```
HELP IF 
```

你得到这个信息：ERRORLEVEL number | 如果最后一个程序运行返回的退出代码**等于或大于**指定的数字，则指定一个真条件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-10T21:26:27.333

使用这个简单的 C 程序来操作退出代码：

```
#include <stdio.h>
main(int argc, char *argv[]) {
    if (argc == 2) {
        // return integer of argument 1
        return strtol(argv[1], NULL, 10);
    }
    else {
        return 0;
    }
} 
```

我们可以像这样在**批处理文件**中测试退出代码：

```
test.exe 0
IF ERRORLEVEL 0 PAUSE 
```

**条件**：`0 => 0 == TRUE`

当 时`ERRORLEVEL = 0`，将发生暂停，因为逻辑是`>=`or**大于或等于**。这很重要，因为目前尚不清楚该条件不是`==`比较。

请注意，替换为`1 => 0`也将为真，因此也会发生暂停。对于任何正数都是如此。

我们只能通过以下方式触发相反的效果`0`：

```
test.exe -1
IF ERRORLEVEL 0 PAUSE 
```

**条件**：`-1 => 0 == FALSE`

由于 an通常意味着`ERRORLEVEL`有`1`错误，`0`没有错误，我们可以增加比较条件中的最小值来获得我们想要的结果，如下所示：

```
test.exe 0
IF ERRORLEVEL 1 PAUSE 
```

**条件**：`-1 => 1 == FALSE`

**条件**：`0 => 1 == FALSE`

**条件**：`1 => 1 == TRUE`

在这个例子中。脚本将在`ERRORLEVEL`is`1`或更高时暂停

请注意，这允许`-1`退出代码与`0`. 如果一个人只想`0`不暂停怎么办？我们可以使用单独的语法：

```
test.exe 0
IF NOT %ERRORLEVEL% EQU 0 PAUSE 
```

**条件**：`-1 != 0 == TRUE`

**条件**：`0 != 0 == FALSE`

**条件**：`1 != 0 == TRUE`

在这个例子中，脚本暂停 if `%ERRORLEVEL%`is not`0`我们可以通过使用 EQU 运算符先检查 if `%ERRORLEVEL% EQU 0`，然后使用 NOT 运算符来获得相反的效果，相当于`!=`运算符。但是，我相信这只适用于 NT 机器，而不是普通的 DOS。

参考：

[http://chrisoldwood.blogspot.ca/2013/11/if-errorlevel-1-vs-if-errorlevel-neq-0.html](http://chrisoldwood.blogspot.ca/2013/11/if-errorlevel-1-vs-if-errorlevel-neq-0.html) [http://ss64.com/nt/errorlevel.html](http://ss64.com/nt/errorlevel.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T10:01:57.653

您是否尝试过“暂停”命令？

```
@echo off
echo hello world
pause 
```

*   有关“暂停”的更多信息：[http ://technet.microsoft.com/en-us/library/bb490965.aspx](http://technet.microsoft.com/en-us/library/bb490965.aspx)
*   DOS 命令行参考 AZ：[http ://technet.microsoft.com/en-us/library/bb490890.aspx](http://technet.microsoft.com/en-us/library/bb490890.aspx)

# open-source - Any free alternative to Robohelp?

> ID：91269
> 
> 赞同：18
> 
> 时间：2008-09-18T09:44:45.403
> 
> 标签：open-source, chm, robohelp, help-authoring

Any free alternative to Robohelp? Prefer open source

Need some sort of online help authoring tool for an open source project.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T09:57:18.510

查看此[免费帮助创作工具列表，](http://www.thefreecountry.com/programming/helpauthoring.shtml)那里肯定会有用处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T09:59:04.480

刚刚记住：根据您想要做什么，您可以使用 doxygen (www.doxygen.org) 或来自[http://www.vizacc.com/](http://www.vizacc.com/)的免费帮助工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-15T22:44:09.613

我喜欢[狮身人面像](http://sphinx.pocoo.org/)。

[您使用纯文本标记格式reStructuredText](http://docutils.sourceforge.net/rst.html)编写文档。

Sphinx 可以创建 HTML、Windows HTML 帮助和 PDF（通过 Latex）。

我已经使用 Sphinx 为两个项目创建了最终用户文档，并且还使用它来记录几个 Python 包（Sphinx 有很多关于从 Python 模块中提取文档的功能，它最初是为了编写 Python 文档而创建的）。

它很容易上手，并且您只需付出最少的努力即可获得具有专业外观的文档。

如果您习惯了所见即所得的文本编辑方式，那么使用纯文本标记格式可能需要一些时间来适应。但我相信这将是值得的努力。

我也有一些使用 DocBook 的经验（提到的最终用户文档项目之一是 DocBook 到 Sphinx 的迁移）。我更喜欢 Sphinx 而不是 Docbook：纯文本比 XML 更易于使用，Sphinx 具有更简单的工具链。

也可以看看：

*   [使用 Sphinx 的项目列表](http://sphinx.pocoo.org/examples.html)。
*   [PDF 示例](http://sphinx.pocoo.org/sphinx.pdf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T09:47:36.737

Are you trying to make just CHM or other output formats too?

Take a look at DocBook. You can make (from one source file) pdf, html and chm - and some others, too. I've used it in the past but it's not very easy or convenient to use. If you only want to output chm (and need to use a free solution), see if you can get away with using the htmlhelp workshop ([http://www.microsoft.com/downloads/details.aspx?familyid=00535334-c8a6-452f-9aa0-d597d16580cc&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=00535334-c8a6-452f-9aa0-d597d16580cc&displaylang=en)).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T09:58:58.363

如果您正在尝试构建基于 .chm 的帮助，请尝试[**chm-build**](http://sourceforge.net/projects/chm-build/)

# statistics - 统计删除错误值

> ID：91270
> 
> 赞同：2
> 
> 时间：2008-09-18T09:44:52.937
> 
> 标签：statistics

我们有一个应用程序，用户可以在其中全天输入价格。这些价格被记录在一个带有时间戳的表格中，然后用于生成价格如何变动的图表......用户时不时地输入一个错误的价格（例如，输入零到多或少），这有点破坏图表（你会得到很大的峰值）。如果价格波动超过 20%，我们甚至会进行额外的确认对话，但这并不能阻止他们输入错误的值......

在绘制图表之前，我可以使用什么统计方法来分析这些值以排除任何与其他值不同的值？

**编辑：**在骨头上加点肉。假设价格是股价（它们不是，但它们的行为方式相同）。您可以看到价格在白天大幅上涨或下跌。平均每天我们记录大约 150 个价格，有时一两个是错误的。其他时候都很好...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T09:48:14.740

计算并跟踪一段时间的[标准偏差。](http://en.wikipedia.org/wiki/Standard_deviation)在你有一个体面的积压后，你可以通过查看离平均值有多少标准偏差来忽略异常值。更好的是，如果你有时间，你可以使用这些信息来做一些[朴素的贝叶斯分类](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T10:04:16.777

这是一个很好的问题，但可能会引发相当多的讨论，因为答案可能千差万别。这取决于

*   你愿意为此付出多少努力？

*   有些答案真的会相差 +/-20% 或您发明的任何测试吗？那么总是需要一些人为干预吗？

*   并且要发明一个相关的测试，我需要更多地了解这个主题。

话虽如此，以下是可能的替代方案。

*   针对先前值（或先前 10 或 20 个值的平均值/模式）的简单测试将直接实施

*   下一个复杂级别将涉及对所有值（或以前的 x 值，或最近 3 个月的值）的一些统计测量，正态分布或高斯分布将使您能够确定每个值是否是错误的与准确。这种确定程度通常以百分比表示。

请参阅[http://en.wikipedia.org/wiki/Normal_distribution](http://en.wikipedia.org/wiki/Normal_distribution)和[http://en.wikipedia.org/wiki/Gaussian_function](http://en.wikipedia.org/wiki/Gaussian_function)这些页面有足够的链接来帮助编程，也取决于您使用的语言可能有功能和/或插件可以帮助解决这个问题

*   一种更高级的方法可能是使用某种学习算法，该算法可以考虑其他参数（在最后的 x 值之上），例如，学习算法可以考虑产品类型或制造商。甚至监控一天中的时间或已输入数字的用户。这个选项似乎超出了您的需求，但是，它需要大量的工作来编写代码并训练学习算法。

我认为第二个选项对您来说是正确的。使用标准偏差（很多语言都包含一个函数）可能是一个更简单的选择，这只是衡量该值与 x 个先前值的平均值的偏差程度，我会将标准偏差选项放在介于两者之间选项 1 和 2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T09:48:27.483

您可以测量现有总体的标准差，并排除那些与平均值相差 1 或 2 个标准差的人吗？

这将取决于您的数据看起来如何给出更准确的答案......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T09:51:19.083

或者绘制价格的移动平均值而不是实际价格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T09:51:44.903

[从这里](http://www.graphpad.com/quickcalcs/GrubbsExplain.cfm)引用：

*统计学家设计了几种检测异常值的方法。所有方法首先量化离群值与其他值的距离。这可以是异常值与所有点的平均值之间的差异、异常值与其余值的平均值之间的差异，或者是异常值与下一个最接近值之间的差异。接下来，通过除以某种分散度量来标准化该值，例如所有值的 SD、剩余值的 SD 或数据范围。最后，计算一个 P 值来回答这个问题：如果所有值都是从高斯总体中采样的，那么随机获得离其他值很远的异常值的机会是多少？如果 P 值较小，您可以得出离群值与其他值的偏差在统计上显着的结论。*

谷歌是你的朋友，你知道的。;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T12:36:22.883

对于您的特定**绘图**问题，以及您在 150 次中平均每天出现 1-2 个错误的具体情况，最简单的方法可能是绘制*修剪后的均值*，或中间 95% 值的范围，或类似的东西. 这实际上取决于您想要从情节中获得什么价值。

如果您真的关心一天价格的真实最大值和真实值，那么您必须将异常值作为异常值处理，并正确排除它们，可能使用之前提出的异常值测试之一（数据点比下一个多 x%点，或最后 n 个点，或与每日平均值相差超过 5 个标准差）。另一种方法是查看异常值之后发生的情况。如果它是一个异常值，那么它将急剧上升，然后急剧下降。

但是，如果您关心总体趋势，则绘制每日修剪平均值、中位数、5% 和 95% 百分位数将很好地描绘历史。

*根据分析问题*选择您的显示方法和需要进行多少异常值检测。如果您关心中位数或百分位数，它们可能无关紧要。

# c# - WebRequest 是与网站交互的正确 C# 工具吗？

> ID：91275
> 
> 赞同：35
> 
> 时间：2008-09-18T09:46:29.597
> 
> 标签：c#, .net, webrequest

我正在用 C# 编写一个小工具，它需要使用 POST 和 json 格式向/从网站发送和接收数据。我以前从未在 C#（或任何语言）中做过这样的事情，所以我正在努力寻找一些有用的信息来帮助我开始。

我在 C# 中找到了一些关于 WebRequest 类的信息（特别是从[这里](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)开始），但在我开始深入研究之前，我想知道这是否是适合这项工作的工具。

我找到了很多将数据转换为 json 格式的工具，但没有太多其他工具，所以任何信息在这里都会很有帮助，以防我最终陷入死胡同。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-18T09:58:32.547

WebRequest，更具体地说是 HttpWebRequest 类是您想要实现的一个很好的起点。要创建请求，您将使用 WebRequest.Create 并将创建的请求转换为 HttpWebRequest 以实际使用它。然后，您将创建您的帖子数据并将其发送到流，例如：

```
HttpWebRequest req = (HttpWebRequest)
WebRequest.Create("http://mysite.com/index.php");
req.Method = "POST";
req.ContentType = "application/x-www-form-urlencoded";
string postData = "var=value1&var2=value2";
req.ContentLength = postData.Length;

StreamWriter stOut = new
StreamWriter(req.GetRequestStream(),
System.Text.Encoding.ASCII);
stOut.Write(postData);
stOut.Close(); 
```

同样，您可以使用 GetResponse 方法读回响应，这将允许您读取结果响应流并执行您需要执行的任何其他操作。您可以在以下位置找到有关该课程的更多信息：

[http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T09:56:57.107

[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)有时比[WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)更容易使用。你可能想看看它。

对于 JSON 反序列化，您需要查看[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer_members.aspx)类。

网络客户端示例：

```
using (WebClient client = new WebClient ())
{
    //manipulate request headers (optional)
    client.Headers.Add (HttpRequestHeader.UserAgent, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");

    //execute request and read response as string to console
    using (StreamReader reader = new StreamReader(client.OpenRead(targetUri)))
    {
        string s = reader.ReadToEnd ();
        Console.WriteLine (s);
    }
} 
```

**标记为 wiki 以防有人想要更新代码**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T09:58:02.733

在将数据发布到网站时，[System.Net.HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)（WebRequest 的 HTTP 特定实现）是一个完美的解决方案。它支持 SSL、异步请求和许多其他好东西，并且在 MSDN 上有详细记录。

有效负载可以是任何东西：JSON 格式的数据或其他格式的数据——只要您将 ContentType 属性设置为服务器期望和理解的内容（很可能是 application/json、text/json 或 text/x-json），所有内容都将是美好的。

从系统服务使用 HttpWebRequest 时的一个潜在问题：由于它使用 IE 代理和凭据信息，因此在以 LOCALSYSTEM 用户（或基本上任何不定期交互登录的帐户）运行时，默认行为可能有点奇怪）。将 Proxy 和 Authentication 属性设置为`Nothing`（或者，我猜 C# 的人更喜欢这样称呼它`null`）应该避免这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T09:50:45.637

我使用 WebRequest 与网站交互。这是正确的“工具”

我无法评论您问题的 JSON 方面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-06T04:49:08.253

要将实例对象转换为 json 格式的字符串，反之亦然，请尝试 [Json.NET：http://json.codeplex.com/](http://json.codeplex.com/)

我目前正在将它用于一个项目，它易于学习和使用，并且在序列化和自定义类型转换器方面提供了一些灵活性。它还支持用于查询 json 输入的 LINQ 语法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T18:00:08.623

当前评分最高的答案很有帮助，但它不会发送或接收 JSON。

这是一个使用 JSON 进行发送和接收的示例：

[如何在 Web 服务中发布 json 对象](https://stackoverflow.com/questions/2309954/how-to-post-json-object-in-web-service/10821570#10821570)

这是对我解决这个问题最有帮助的 StackOverflow 问题：

[在 ASP.net Web 服务和 ASP.Net Web 客户端之间发送和接收 JSON 的问题](https://stackoverflow.com/questions/10433551/problems-sending-and-receiving-json-between-asp-net-web-service-and-asp-net-web)

这是另一个相关的问题：

[使用 C# 调用 json](https://stackoverflow.com/questions/4982765/json-call-with-c-sharp)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T09:52:00.923

在 3.5 中有一个内置的 jsonserializer。webrequest 是您正在寻找的正确类。

几个例子：

*   [http://geekswithblogs.net/JuanDoNeblo/archive/2007/10/24/json_in_aspnetajax_part2.aspx](http://geekswithblogs.net/JuanDoNeblo/archive/2007/10/24/json_in_aspnetajax_part2.aspx)
*   [http://dev.aol.com/blog/markdeveloper/ShareFileWithNETFramework](http://dev.aol.com/blog/markdeveloper/ShareFileWithNETFramework)
*   [http://geekswithblogs.net/JuanDoNeblo/archive/2007/10.aspx](http://geekswithblogs.net/JuanDoNeblo/archive/2007/10.aspx)

# java - 在 Excel 中使用 EJB 的最佳解决方案

> ID：91280
> 
> 赞同：1
> 
> 时间：2008-09-18T09:47:13.727
> 
> 标签：java, excel, ejb, corba, vba

我们希望允许从 Excel 访问我们的一些 EJB。目标是提供可从 VBA 使用的 API。

我们的 EJB 主要是无状态会话 Bean，它们使用 POJO 执行简单的 CRUD 操作。

一些可能的解决方案：

*   将 EJB 公开为 WebServices 并创建一个包装它们的 VB/C# dll，
*   使用 Corba 从 C# 访问 EJB，
*   创建一个使用 Java 访问 EJB 的 COM 库，

欢迎指出这些解决方案的框架或其他想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T09:59:58.283

您可以查看解决此问题的[IIOP.NET 。](http://www.codeproject.com/KB/cs/iiop_net_and_ejb.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T10:56:01.597

如果您有一个相当新的 ejb 容器，最便宜和最简单的应该是将您的 bean 公开为 Web 服务并从 VB/C# 调用它。这不需要任何额外的工具或库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T09:45:38.230

[我在一个名为XLLoop](http://xlloop.sourceforge.net/ "XLloop")的开源项目上工作——这个框架允许您将 POJO 函数公开为 Excel 函数。

它包括：

1.  Excel 加载项 (XLL)，它通过 TCP 与以下对象进行通信：
2.  调用 java 方法的 Java 服务器/库。

您可以将此 java 函数服务器嵌入到 EJB 中，并将其部署为您的应用程序服务器的一部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:06:37.807

回到 VB6/COM/DCOM 时代，我们使用套件[J-Integra](http://j-integra.intrinsyc.com/)来完成这项任务。不过，我没有使用 .NET 版本的经验。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T22:48:04.657

我强烈推荐[IKVM](http://www.ikvm.net/)。它是 .NET 汇编编译器（即 JAR --> DLL）的 java 字节码，我用它在 Excel 自动化服务器中创建实时 JMX 链接和侦听器。创建 EJB 客户端存根和支持库的 .NET 程序集对您来说应该不难。

//尼古拉斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-26T18:31:59.640

你可以试试[Obba](http://www.obba.info)（我在这个项目上工作）：

> *Obba 是用于电子表格应用程序的 Java 对象处理程序。*
> 
> *它在电子表格和 Java 类之间提供了一座桥梁，因此电子表格可以用作 Java 库的图形用户界面。从电子表格访问 Java 库不需要胶水代码（不需要 VBA，不需要特殊的 Java 代码）。对象由其原始构造函数实例化。使用“按名称”反射调用构造函数和方法。不需要特定于电子表格的工厂方法。Obba 提供了处理电子表格中的对象的功能。*
> 
> *提供插件的 Java 虚拟机可以在同一台计算机或远程计算机上运行——无需对电子表格进行任何更改，即电子表格中引用的对象可以驻留在远程 Java 虚拟机上。*

# asp.net - 如何以编程方式构建 TemplateColumn

> ID：91282
> 
> 赞同：1
> 
> 时间：2008-09-18T09:47:38.453
> 
> 标签：asp.net

如何以编程方式构建 TemplateColumn 对象并将其添加到 DataGrid。我知道如何添加它，但不知道如何构建 TemplateColumn 的内容。列类公开的 ITemplate 上没有有用的外观方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T09:58:56.413

您可以使用[CompiledTemplateBuilder](http://msdn.microsoft.com/en-us/library/system.web.ui.compiledtemplatebuilder.aspx)类。

这是一个例子：

[http://iridescence.no/post/Using-Templated-Controls-Programmatically.aspx](http://iridescence.no/post/Using-Templated-Controls-Programmatically.aspx)

# ruby-on-rails - Ruby on Rails 迁移 - 创建新的数据库模式

> ID：91289
> 
> 赞同：3
> 
> 时间：2008-09-18T09:49:20.273
> 
> 标签：ruby-on-rails, ruby, postgresql, schema, migration

我有一个运行 SQL 脚本来创建新 Postgres 模式的迁移。默认情况下，在 Postgres 中创建新数据库时，它会创建一个名为“public”的模式，这是我们使用的主要模式。创建新数据库模式的迁移似乎工作正常，但是在迁移运行后出现问题，当 rails 尝试更新它所依赖的“schema_info”表时，它说它不存在，就好像它是在新的数据库架构中查找它，而不是在表实际所在的默认“公共”架构中查找。

有谁知道我如何告诉 Rails 查看该表的“公共”模式？

正在执行的 SQL 示例：~

```
CREATE SCHEMA new_schema;
COMMENT ON SCHEMA new_schema IS 'this is the new Postgres database schema to sit along side the "public" schema';
-- various tables, triggers and functions created in new_schema 
```

抛出错误：〜

```
RuntimeError: ERROR C42P01  Mrelation "schema_info" does not exist
L221    RRangeVarGetRelid: UPDATE schema_info SET version = ?? 
```

谢谢你的帮助

克里斯奈特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T10:56:14.747

这取决于你的迁移是什么样的，你的 database.yml 是什么样的，以及你到底想尝试什么。无论如何，如果您必须更改名称并发布示例 database.yml 和迁移，则需要更多信息。例如，迁移是否会更改适配器的 search_path？

但是要知道，通常 rails 和 postgresql 模式不能很好地协同工作（还没有？）。

有几个地方有问题。尝试构建只使用一个 pg 数据库和 2 个非默认模式的应用程序，一个用于开发，一个用于测试，然后告诉我。（从下面我可以告诉你，你会被烧死）

也许自从我上次玩它以来它已经修复了，但是当我看到[http://rails.lighthouseapp.com/projects/8994/tickets/390-postgres-adapter-quotes-table-name-breaks-when-non- default-schema-is-used](http://rails.lighthouseapp.com/projects/8994/tickets/390-postgres-adapter-quotes-table-name-breaks-when-non-default-schema-is-used)或者这个[http://rails.lighthouseapp.com/projects/8994/tickets/918-postgresql-tables-not-generating-correct-schema-list](http://rails.lighthouseapp.com/projects/8994/tickets/918-postgresql-tables-not-generating-correct-schema-list)或者这个在 postgresql_adapter.rb

```
 # Drops a PostgreSQL database
  #
  # Example:
  #   drop_database 'matt_development'
  def drop_database(name) #:nodoc:
    execute "DROP DATABASE IF EXISTS #{name}"
  end 
```

（是的，如果您为开发和测试使用具有不同架构的同一数据库，这是错误的，这会在您每次运行单元测试时删除两个数据库！）

我实际上开始编写补丁。第一个是适配器中的索引方法，它不关心 search_path 在某些情况下最终会出现重复的索引，然后我开始受到其余部分的伤害并最终放弃了使用模式的想法：我想得到*我的*应用程序完成了，我没有额外的时间来解决我使用模式时遇到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T10:20:18.423

我不确定我是否理解您的确切要求，但是，rake 期望将 Rails 模式的版本更新到 schema_info 表中。检查你的 database.yml 配置文件，这是 rake 寻找要更新的表的地方。

您是否有可能正在迁移到新的 Postgres 模式并且 rake 仍然指向旧模式？我不确定您是否需要标准的 Rails 迁移。最好创建自己的 rake 任务。

编辑：如果您引用两个不同的数据库或 Postgres 模式，Rails 在标准迁移中不支持这一点。Rails 假定一个数据库，因此从一个数据库迁移到另一个数据库通常是不可能的。当您运行“rake db:migrate”时，它实际上会查看 RAILS_ENV 环境变量以在 database.yml 中找到正确的条目。如果 rake 从 database.yml 查看“开发”环境和数据库配置开始迁移，它将期望在迁移结束时更新到此环境。

因此，您可能需要从 Rails 堆栈外部执行此操作，因为您无法在 Rails 中同时引用两个数据库。插件尝试允许这样做，但它们主要是hacky并且不能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-14T09:23:48.623

您可以使用[pg_power](https://github.com/TMXCredit/pg_power)。它提供了额外的 DSL 用于迁移以创建 PostgreSQL 模式，而不仅仅是。

# .net - .NET 的 SslStream 总是与我拥有的最不安全的密码进行协商。我怎样才能改变这个？

> ID：91304
> 
> 赞同：5
> 
> 时间：2008-09-18T09:54:24.817
> 
> 标签：.net, encryption, ssl, aes

SslStream 应该与它的对等 SSL 堆栈协商密码类型、密钥长度、哈希算法等。在我的代码中使用它时，我发现协商始终默认为 RC4 和 MD5。我想使用 3DES 或 AES 来增加一些安全性。

环顾网络，我发现只有几个关于这个问题的参考，没有解决方案；一位发帖人声称这实际上是有道理的，因为两个堆栈之间的最小公分母是安全的，同时具有更快/使用更少 CPU 资源的额外好处。虽然这在技术上可能是正确的，但我在复杂性和成本之间的特殊权衡在于其他地方（我更喜欢使用带有长密钥的 AES）。

如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T09:56:04.707

SSLStream 使用操作系统提供的 Schannel。这些套件按 Microsoft Schannel Provider 选择的默认顺序列出：

**视窗：**

> RSA 与 AES_128 CBC SHA
> RSA 与 AES_256 CBC SHA
> RSA 与 RC4_128 SHA
> 
> ...

**视窗XP：**

> RSA 带 RC4 128 MD5
> RSA 带 RC4 128 SHA
> 
> 带有 3DES CBC SHA 的 RSA
> 
> ……

您还可以通过使用 Microsoft 管理控制台 (Windows Vista) 中的组策略对象管理单元配置**SSL 密码套件顺序**组策略设置来修改密码套件列表

但问题是 Windows XP**没有**在 SSLStream 可用的密码列表中包含 AES。但是，可以在 Windows XP 中更改注册表设置： HKLM\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy 1 以获取**3DES**密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-18T09:44:46.100

您可以通过进行一些简单的注册表更改来选择哪些协议可供选择。例如，我们删除了选择 RC4 的功能。您只需要在连接的一端（例如服务器）进行更改，因为客户端和服务器会协商找到共同支持的算法

[http://msdn.microsoft.com/en-us/library/ms925716.aspx](http://msdn.microsoft.com/en-us/library/ms925716.aspx)

最好的祝愿詹姆斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T14:10:46.997

它应该使用两个列表中最安全的算法集。我很难相信它不是，因为 SslStream 正在包装 SChannel SSPI，如果它被破坏了，那么 Internet Explorer、IIS 和 Windows 上的所有其他东西也会被破坏。

可能是您的 SChannel.dll/Secur32.dll 版本过时。您安装了哪些操作系统和 Internet Explorer 版本？

可以[在 SCHANNEL 中禁用协议](http://support.microsoft.com/kb/245030)。你能检查一下这还没有完成吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:17:03.373

我正在使用带有所有更新的 XP SP3 和 IE7。注册表似乎配置了一切启用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-20T11:03:45.030

在 Java 中，您可以根据自己的需要和偏好订购各种算法/密码。.NET中可能有类似的API ...

# xml - 在 AS3 中更改 XML 对象的属性值

> ID：91305
> 
> 赞同：3
> 
> 时间：2008-09-18T09:54:40.027
> 
> 标签：xml, actionscript-3, actionscript

有没有简单的方法可以做到这一点？还是我必须自己解析文件并进行一些搜索/替换？

理想情况如下：

```
var myXML: XML = ???; // ... load xml data into the XML object

myXML.someAttribute = newValue; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T12:12:32.147

`@`在 AS3 中可以使用前缀访问属性。

例如：

```
var myXML:XML = <test name="something"></test>;
trace(myXML.@name);
myXML.@name = "new";
trace(myXML.@name); 
```

输出：

```
something
new 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-18T09:50:09.273

问题在于某些属性，例如@class。想象一下你想创建 HTML 源代码并想创建标签测试

所以代码应该是

var myDiv:XML = test myDiv.@class = "myClass"; //我想在这里设置，因为它可以变化

但这不是可编译的，并且会引发错误（至少在 Flex Builder 中）

在这种情况下，您也可以使用它：

myDiv.@['class'] = "myClass";

# java - 在 Intellij IDEA 中附加额外的 javadoc

> ID：91307
> 
> 赞同：65
> 
> 时间：2008-09-18T09:54:47.890
> 
> 标签：java, intellij-idea, javadoc

当我在 IDEA 中对 j2ee 类或注释使用快速文档查找 (Ctrl+Q) 时，我只会得到一个空的 javadoc。它只包含类名等基础知识。

如何将 javadoc 添加到 IDEA 提供的库中？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2008-09-18T10:37:06.213

您可以将 javadoc 附加到您在模块或项目中配置的任何库。只需访问项目结构窗口`(File -> Project Structure)`，然后选择“模块”并选择具有您要配置的依赖项的模块。

然后选择“依赖项”选项卡，选择缺少 javadoc 的依赖项，然后单击“编辑”。在刚刚显示的窗口中，您会看到两个按钮“添加”和“指定 Javadoc URL”。如果您在 jar 文件中有 javadoc，请选择第一个，如果您想指向包含 javadoc 的网站，请选择最新的。就是这样。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2019-03-26T00:22:32.767

如果使用 Maven：

“右键单击您的 pom.xml”->“Maven”-> 然后选择“下载源和文档”

为避免将来出现这种情况：“首选项”->“构建、执行、部署”->“构建工具”->“Maven”->“导入”->选中自动下载源和文档框。

感谢 Intellij 用户论坛的 Yacov Schondorf 和 Stephen Boesch。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-07T11:58:53.140

扩展 API 的文档呢？我已将 j3d API 添加到我的 jdk1.6 并成功使用它，下一步，获取 javadoc

忘记 java.sun.com 上的链接（这是一团糟）直接访问 java.net 并获取所有内容（API、javadoc，甚至获取源代码 - 对于每个包 -）

转到您的 jdk 并选择文档路径并添加 javadoc zip。转到源选项卡并添加源的 zip

你完成了。

实际上只需要源代码就可以享受javadoc和未编译的类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-12T02:38:34.283

右键单击maven pom.xml -> “Maven” -> 下载文档，稍等片刻，你会成功的！

# flash - 如何在 Flash 应用程序中延长默认超时时间？

> ID：91318
> 
> 赞同：8
> 
> 时间：2008-09-18T09:56:57.620
> 
> 标签：flash, timeout, haxe

我有一个用 Flash 编写的应用程序（实际上它是用 Haxe 编写的并在 SHWX 下运行，但在这里没关系）。我有一个非常复杂的任务，它消耗大量 CPU 功率，有时执行时间超过 15 秒。如果发生这种情况，我会收到一条错误消息，提示“脚本执行的时间超过了 15 秒的默认超时时间。” 一切都崩溃了。

我知道我可以使用延续来阻止这种情况的发生，但是有没有办法延长“默认超时期限”？这是一个开发者工具，responsivnes 并不重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-20T21:48:08.400

另一种方法是通过 -swf-lib 开关链接基于[swfmill](http://swfmill.org/)的 swf 并在此处设置此 ScriptLimits 标记，然后 haxe 将重新使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-22T18:49:04.387

在 CS3+ 中，您只需在发布时设置 swf 的“脚本时间限制”属性 - 它位于发布设置的 flash 选项卡中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-08T13:07:47.913

> 测试应用程序时，请注意 scriptTimeLimit 属性。如果应用程序初始化时间过长，Flash Player 会警告用户脚本导致 Flash Player 运行缓慢并提示用户中止应用程序。如果是这种情况，您可以将标记的 scriptTimeLimit 属性设置为更长的时间，以便 Flex 应用程序有足够的时间进行初始化。
> 
> 但是，**scriptTimeLimit 属性的默认值为 60 秒，这也是最大值**，因此如果您之前已将其设置为较低的值，则只能增加该值。您很少需要更改此值。

来源：[http ://livedocs.adobe.com/flex/3/html/help.html?content=performance_05.html](http://livedocs.adobe.com/flex/3/html/help.html?content=performance_05.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T12:07:38.243

我不确定是否有更本地的东西来完成这项工作，但似乎有一个[命令可以破解 SWF 以添加 ScriptLimits 标记](http://www.buraks.com/swfsli/)以延长超时期限。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-18T13:10:42.600

我建议将您的功能分成更小的块并将它们分布在多个帧上。这样您就可以显示进度动画，并且 Flash 应用程序不会无响应。因此，例如，如果您必须循环超过 1000 个项目，则在一帧中执行 100 个，然后在下一帧中再执行 100 个，依此类推，直到您处理完所有项目。我不建议破解您的 swf。

# visual-studio - Visual Studio 2008 可以与 Team System 2005 一起使用吗？

> ID：91344
> 
> 赞同：5
> 
> 时间：2008-09-18T10:01:39.823
> 
> 标签：visual-studio, tfs

我想在不触及 Team Server 2005 版本的情况下将我的团队从 VS2005 升级到 VS2008。

那可能吗？

如果是这样，我如何告诉 VS 识别 TFS？
目前在我的 VS2008 选项菜单中，我没有任何源代码管理可供选择。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T11:52:29.417

VS 2008 与 TFS 2005 配合得很好。Team Build 区域有几个例外（在 2005 年和 2008 年之间发生了巨大变化），否则您将能够从 Visual Studio 2008 客户端执行您需要执行的所有操作。

您需要确保已安装 2008 版 Team Explorer 以将 TFS 功能添加到 Visual Studio。2005 版只能安装到 Visual Studio 2005 中。要下载 2008 版，请参阅以下链接

[http://www.microsoft.com/downloads/details.aspx?familyid=0ed12659-3d41-4420-bbb0-a46e51bfca86](http://www.microsoft.com/downloads/details.aspx?familyid=0ed12659-3d41-4420-bbb0-a46e51bfca86)

请注意，如果您之前应用了 Visual Studio 2008 的 SP1，那么您需要在安装 Team Explorer 后再次运行它。

对于它的价值，我建议您尽快在服务器端升级到 TFS 2008。TFS 2008 与从 Visual Studio 2005 机器连接的客户端正常工作，但它具有一些显着的性能改进，并且 Team Build 功能得到了很大改进。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T10:04:16.730

是的，你可以......（我们也在这样做）

*   工具 -> 连接到 Team Foundation Server
*   “添加...”
*   输入 IP / 主机名

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T10:04:35.900

是的，这很好用。如果您在 VS 计算机上从 TFS 2008 DVD 安装 Team Foundation Client，则可以连接到 TFS 2005 和 TFS 2008 服务器。如果您无法访问 TFS 2008 DVD（请注意，试用版应该没问题），在 VS 2008 上安装 2005 客户端也应该可以，但我从未亲自尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T10:12:58.987

您是否安装了 Team Foundation 客户端？

如果您有团队版本，它应该位于安装 DVD 上的 TFC 文件夹中。（我不知道为什么它不是安装程序中的选项）

也可以从 Microsoft 下载 TFC（免费），Microsoft 下载中有 SP1 版本。

# asp.net - ASP.NET 页面上的多个表单

> ID：91350
> 
> 赞同：5
> 
> 时间：2008-09-18T10:02:52.863
> 
> 标签：asp.net, webforms

来自经典 ASP 背景，我习惯于在一个页面上使用多个表单，但这显然仅限于 ASP.NET 页面。

但是，我有一种情况，我有一个表单，它收集用户的输入，将数据保存到数据库，然后我想呈现（并调整其值）一个发布到 PayPal 网站的特殊表单。

如果 PayPal 表单的字段值是静态的，则不会有问题，但由于我想在服务器端操作表单（调整数量、说明、价格字段等），这*将*是一个问题。

我正在考虑在写入数据库后重定向到不同的页面，我怀疑这会很好地工作，但这可能是不必要的一些额外的努力。

也有人建议我，我可以以编程方式呈现不同的形式，具体取决于我在循环中的位置。也就是说，使用占位符，在 Page_Load 上，我最初会添加一个 DB 表单（带有子控件），然后在回发之后添加 PayPal 表单。

这种情况对你们来说必须是一个常见的情况，所以如果你有首选方法，我正在寻找意见建议和任何相关的代码示例。

我知道我能过得去，但这个项目是一个学习工具，所以我想采用通过的最佳实践。

提前致谢...

克里斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T10:07:29.950

你可以有多种形式，只有一种形式可以有`runat="server"`属性。

让 PayPal 工作有很多答案。但因为它是一种可能会作弊的学习工具。老实说，我会看完整的 PayPal API，而不是使用有点简单的形式的方法（还有一个额外的好处，那就是它应该更多地扩展你的学习）。

否则，是的，在服务器端表单之外设置一个 HTML 表单，并在其中添加一个文字并在其中写入点点滴滴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T10:06:26.287

一种基本方法是在页面上使用两个面板——一个用于第一个表单，另一个用于第二个表单。

您可以根据要显示的表单（在 page_load 期间或渲染前的任何时间）更改这些面板的可见性属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T10:08:03.320

也许我误解了这个问题，但你不能在表单中简单地有 2 个 div，在任何时候只有一个可见。例如

```
<form id="Form1" method="post" runat="server">
    <div id="getUserInput" visible="true">
          <asp:button id="btnSubmitFirst" />
    </div>
    <div id="doSubmissionToPaypal" visible="false">
          <asp:button id="btnSubmitSecond" />
    </div>
</form> 
```

然后，在 btnSubmitFirst_Click 中：

```
 doSubmissionToPaypal.visible=True
 getUserInput.visible = false 
```

类似的东西？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:03:05.807

此 paypal 的解决方法是使用[Paypal 集成代码](http://www.spiderweblogic.com/Paypal-Integration-Code.aspx)，因为 Paypal 并不总是最易于集成。艰苦的工作基本上是为你完成的。

# ruby - Ruby 的 XMP 库

> ID：91352
> 
> 赞同：3
> 
> 时间：2008-09-18T10:03:42.097
> 
> 标签：ruby, xmp

谁能推荐一个开源 Ruby 库来将 XMP 元数据添加到 JPEG 图像？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T10:54:59.337

[MiniExiftool](http://miniexiftool.rubyforge.org/)只是[Exiftool](http://www.sno.phy.queensu.ca/~phil/exiftool/)命令行应用程序的一个包装器，是我所知道的唯一一个开源工具。

有一个[名为 Chilkat 的商业图书馆](http://www.chilkatsoft.com/ruby-xmp.asp)，但我没有使用它的经验，因为它是商业的。

# windows-xp - GnuPG：Windows 上 gpg 的“解密失败：密钥不可用”错误

> ID：91355
> 
> 赞同：27
> 
> 时间：2008-09-18T10:04:05.060
> 
> 标签：windows-xp, gnu, gnupg

环境：装有 Windows XP SP2 的 HP 笔记本电脑

我使用 GnuPG (gpg) for Windows 创建了一些加密文件。昨天，我的硬盘出现故障，所以我重新映像了硬盘。我现在重新安装了 gpg 并使用与之前相同的密码重新生成了我的密钥。但是，我现在无法解密这些文件。我收到以下错误：

```
C:\sureshr>gpg -ac:\sureshr\work\passwords.gpg
gpg：使用 1024 位 ELG-E 密钥加密，ID 279AB302，创建于 2008-07-21
      “苏雷什·拉马斯瓦米 (AAA) BBB”
gpg：解密失败：密钥不可用

C:\sureshr>gpg --list-keys
C:/Documents and Settings/sureshr/应用程序数据/gnupg\pubring.gpg
-------------------------------------------------- ------------------
酒馆 1024D/80059241 2008-07-21
uid Suresh Ramaswamy (AAA) BBB
潜艇 1024g/279AB302 2008-07-21

```

AAA = gpg 评论
BBB = 我的电子邮件地址

我确定我使用了正确的密码。这个错误到底是什么意思？我如何告诉 gpg 在哪里可以找到我的密钥？

谢谢，

苏雷什

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2011-11-02T00:45:31.223

您不仅需要导入您的密钥，还需要导入相应的公钥，否则您会收到此错误。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-18T10:21:38.107

从旧密钥环重新导入密钥时，您需要指定命令：

```
gpg --allow-secret-key-import --import <keyring> 
```

否则它只会导入公钥，而不是私钥。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T10:06:50.763

是的，您的密钥似乎丢失了。没有它，您将无法解密文件。

您是否在某处备份了密钥？

重新创建密钥，无论您是否使用相同的密码，都不起作用。每个密钥对都是唯一的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-09-27T02:46:45.020

[workmad3](https://stackoverflow.com/questions/91355/gnupg-decryption-failed-secret-key-not-available-error-from-gpg-on-windows/91457#91457)显然已经过时了，至少对于当前的 gpg 而言，因为`--allow-secret-key-import`它现在已经过时并且什么都不做。

发生在我身上的是我未能正确导出。仅仅做`gpg --export`是不够的，因为它只导出公钥。导出密钥时，您必须这样做

```
gpg --export-secret-keys >keyfile 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-09-06T11:36:54.590

“密钥不可用”消息的另一个原因：GPG 版本不匹配。

实际示例：我一直在使用 GPG v1.4。切换打包系统，MacPorts 提供的 gpg 被删除，并在路径中显示另一个 gpg 二进制文件，这个版本 2.0。对于解密，它无法找到密钥并给出了这个错误。对于加密，它抱怨一个不可用的公钥。但是， gpg -k 和 -K 都列出了有效的密钥，这是造成严重混乱的原因。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-13T19:10:12.527

对我来说，解决这个问题的方法是通知发件人他确实使用了我发送给他们的公钥，而不是其他人。您应该看到他们使用的密钥。告诉他们使用正确的。

# openid - 如果 Techorati OpenID 托管在我的站点上，那么 openid.server 链接标签中的 href 属性的值是多少？

> ID：91357
> 
> 赞同：0
> 
> 时间：2008-09-18T10:04:13.657
> 
> 标签：openid

我想使用托管在我网站上的 Techorati OpenID 登录 Stack Overflow。

[https://stackoverflow.com/users/login](https://stackoverflow.com/users/login)有一些基本信息。

我明白我应该改变

```
<link rel="openid.delegate" href="http://yourname.x.com" /> 
```

到

```
<link rel="openid.delegate" href="http://technorati.com/people/technorati/USERNAME/" /> 
```

但如果我改变

```
<link rel="openid.server" href="http://x.com/server" /> 
```

到

```
<link rel="openid.server" href="http://technorati.com/server" /> 
```

或者

```
<link rel="openid.server" href="http://technorati.com/" /> 
```

这没用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T10:04:57.163

来自[http://blog.blogupp.com/2008/06/get-openid-fied-and-discover-new-web.html](http://blog.blogupp.com/2008/06/get-openid-fied-and-discover-new-web.html)

```
<link rel="openid.server" href="http://technorati.com/openid/" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T18:35:47.030

找出这个问题的答案的一般方法是加载您要委托给的页面（在这种情况下为[http://technorati.com/people/technorati/USERNAME](http://technorati.com/people/technorati/USERNAME)），查看源代码，然后找到服务器标签在那里使用。

如果有 openid2 标签，你也应该复制它们。

# sql - 如何使用 SQL 计算树中值的总和

> ID：91360
> 
> 赞同：7
> 
> 时间：2008-09-18T10:04:26.447
> 
> 标签：sql, tree

我需要总结用户树获得的每个级别的积分。级别 1 是用户下一级用户的用户积分之和。2级是用户低于用户2级的用户的1级积分，等等......

该计算每月在非生产服务器上进行一次，无需担心性能。

SQL 会是什么样子？

如果你感到困惑，别担心，我也是！

用户表：

```
ID    ParentID    Points
1     0           230
2     1           150
3     0           80
4     1           110
5     4           54
6     4           342

Tree:
0
|---\
1    3
| \
2  4---
    \  \
     5  6 
```

输出应该是：

```
ID    Points    Level1     Level2
1     230       150+110    150+110+54+342
2     150
3     80
4     110       54+342
5     54
6     342 
```

SQL Server 语法和函数最好...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T10:10:55.933

如果您使用的是 Oracle DBMS，那将非常简单，因为 Oracle 支持使用**CONNECT BY/STARTS WITH**语法的树查询。对于 SQL Server，我认为您可能会发现[Common Table Expressions](http://searchwindevelopment.techtarget.com/tip/0,289483,sid8_gci1277481,00.html)很有用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T10:11:51.797

树不适用于 SQL。如果您有非常（非常非常）很少的写访问，您可以更改树实现以使用嵌套集，这将使此查询非常容易。

示例（如果我没记错的话）：

```
SELECT SUM(points) 
FROM users 
where left > x and right < y 
```

但是，树上的任何更改都需要接触大量的行。最好只在您的客户端中进行递归。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:44:54.760

Ok, this gives you the results you are looking for, but there are no guarantees that I didn't miss something. Consider it a starting point. I used SQL 2005 to do this, SQL 2000 does not support CTE's

```
WITH Parent (id, GrandParentId, parentId, Points, Level1Points, Level2Points)
AS
(
    -- Find root
    SELECT id,  
            0 AS GrandParentId,
            ParentId,
            Points,
            0 AS Level1Points,
            0 AS Level2Points
    FROM tblPoints ptr
    WHERE ptr.ParentId = 0

    UNION ALL (
    -- Level2 Points
    SELECT pa.GrandParentId AS Id,
            NULL AS GrandParentId,
            NULL AS ParentId,
            0 AS Points, 
            0 AS Level1Points,
            pa.Points  AS Level2Points
    FROM tblPoints pt
            JOIN Parent pa ON pa.GrandParentId = pt.Id 
    UNION  ALL
    -- Level1 Points
    SELECT pt.ParentId AS Id,
            NULL AS GrandParentId,
            NULL AS ParentId,
            0 AS Points, 
            pt.Points AS Level1Points,
            0 AS Level2Points
    FROM tblPoints pt
            JOIN Parent pa ON pa.Id = pt.ParentId AND pa.ParentId IS NOT NULL 
    UNION  ALL
    -- Points
    SELECT pt.id,
            pa.ParentId AS GrandParentId,
            pt.ParentId,
            pt.Points, 
            0 AS Level1Points,
            0 AS Level2Points
    FROM tblPoints pt
            JOIN Parent pa ON pa.Id = pt.ParentId AND pa.ParentId IS NOT NULL )
)
SELECT id, 
    SUM(Points) AS Points,  
    SUM(Level1Points) AS Level1Points,
    CASE WHEN SUM(Level2Points) > 0 THEN  SUM(Level1Points) + SUM(Level2Points) ELSE 0 END AS Level2Points
FROM Parent
GROUP BY id 
ORDER by id 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T10:06:56.113

我会说：创建一个存储过程，可能有最好的性能。或者，如果您有最大数量的级别，您可以创建子查询，但它们的性能会很差。

（或者您可以获得 MS SQL Server 2008 并获得新的层次结构函数......；））

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T10:14:49.090

如果您正在使用存储在关系数据库中的树，我建议您查看“嵌套集”或“修改的预序树遍历”。SQL 将如此简单：

```
SELECT id, 
       SUM(value) AS value 
FROM table 
WHERE left>left\_value\_of\_your\_node 
  AND right<$right\_value\_of\_your\_node; 
```

...并为您感兴趣的每个节点执行此操作。

也许这会对您有所帮助： [http](http://www.dbazine.com/oracle/or-articles/tropashko4) ://www.dbazine.com/oracle/or-articles/tropashko4或使用谷歌。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T12:05:23.880

就像其他人所说的那样，一般的 SQL 不能很好地处理这种关系。通常，需要一个代理“关系”表（id，parent_id，（id，parent_id）上的唯一键），其中：

*   每次在“表”中添加记录时，您：

    `INSERT INTO relations (id, parent_id) VALUES ([current_id], [current_id]);`

    `INSERT INTO relations (id, parent_id) VALUES ([current_id], [current_parent_id]);`

    `INSERT INTO relations (id, parent_id)` `SELECT [current_id], parent_id` `FROM relations` `WHERE id = [current_parent_id];`

*   有逻辑避免循环

*   确保使用存储过程处理“关系”上的更新、删除

鉴于该表，您想要：

```
SELECT rel.parent_id, SUM(tbl.points)
FROM table tbl INNER JOIN relations rel ON tbl.id=rel.id
WHERE rel.parent_id <> 0
GROUP BY rel.parent_id; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T10:12:51.840

你有几个选择：

1.  使用游标和递归用户定义函数调用（它很慢）
2.  创建一个缓存表，使用触发器在 INSERT 上更新它（这是最快的解决方案，但如果您对主表进行大量更新，则可能会出现问题）
3.  做一个客户端递归计算（如果你没有太多的记录最好）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T10:23:21.550

您可以编写一个简单的递归函数来完成这项工作。我的 MSSQL 有点生锈，但看起来像这样：

```
CREATE FUNCTION CALC
(
@node integer,
)
returns 
(
@total integer
)
as
begin
    select @total = (select node_value from yourtable where node_id = @node);

    declare @children table (value integer);
    insert into @children   
    select calc(node_id) from yourtable where parent_id = @node;

    @current = @current + select sum(value) from @children;
    return
end 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-13T13:13:57.303

下表：

```
Id   ParentId
1   NULL
11    1
12    1
110 11
111 11
112 11
120 12
121 12
122 12
123 12
124 12 
```

以及以下金额表：

```
Id     Val
110 500
111 50
112 5
120 3000
121 30000
122 300000 
```

只有叶子（最后一级）ID 定义了一个值。获取数据的 SQL 查询如下所示：

```
;WITH Data (Id, Val) AS
(
    select t.Id, SUM(v.val) as Val from dbo.TestTable t
    join dbo.Amount v on t.Id = v.Id
    group by t.Id
)

select cd.Id, ISNULL(SUM(cd.Val), 0) as Amount FROM
(
    -- level 3
    select t.Id, d.val from TestTable t
    left join Data d on d.id = t.Id

    UNION

    -- level 2
    select t.parentId as Id, sum(y.Val) from TestTable t
    left join Data y on y.id = t.Id
    where t.parentId is not null
    group by t.parentId

    UNION

    -- level 1
    select t.parentId as Id, sum(y.Val) from TestTable t
    join TestTable c on c.parentId = t.Id
    left join Data y on y.id = c.Id
    where t.parentId is not null
    group by t.parentId
) AS cd
group by id 
```

这导致输出：

```
Id     Amount
1     333555
11   555
12   333000
110 500
111 50
112 5
120 3000
121 30000
122 300000
123 0
124 0 
```

我希望这有帮助。

# c# - 如何在.NET中以格式字符串转义大括号（大括号）

> ID：91362
> 
> 赞同：1100
> 
> 时间：2008-09-18T10:04:48.583
> 
> 标签：c#, .net, string, parsing, formatting

如何在使用中转义括号`string.Format`？

例如：

```
String val = "1,2,3"
String.Format(" foo {{0}}", val); 
```

此示例不会引发异常，但会输出字符串`foo {0}`。

有没有办法逃脱括号？

* * *

## 回答 #1

> 赞同：1400
> 
> 时间：2008-09-18T10:07:35.737

要输出 `foo {1, 2, 3}`，您必须执行以下操作：

```
string t = "1, 2, 3";
string v = String.Format(" foo {{{0}}}", t); 
```

输出`{`你使用`{{`的和输出`}`你使用的`}}`。

**或者现在，您也可以像这样使用 C# 字符串插值（C# 6.0 中提供的功能）**

**转义括号：字符串插值 $("")**。这是 C# 6.0 中的新功能。

```
var inVal = "1, 2, 3";
var outVal = $" foo {{{inVal}}}";
// The output will be:  foo {1, 2, 3} 
```

* * *

## 回答 #2

> 赞同：220
> 
> 时间：2013-02-26T09:12:39.003

`{`是的，要输出`string.Format`你必须像这样逃避它：`{{`

所以下面会输出`"foo {1,2,3}"`。

```
String val = "1,2,3";
String.Format(" foo {{{0}}}", val); 
```

*但是*您必须了解 C# 中的一个设计错误，即按照上述逻辑，您会假设下面的代码将打印 {24.00}：

```
int i = 24;
string str = String.Format("{{{0:N}}}", i); // Gives '{N}' instead of {24.00} 
```

但这会打印 {N}。这是因为 C# 解析转义序列和格式化字符的方式。要在上述情况下获得所需的值，您必须改用它：

```
String.Format("{0}{1:N}{2}", "{", i, "}") // Evaluates to {24.00} 
```

### 参考文章

*   [String.Format 问题](https://docs.microsoft.com/en-us/archive/blogs/brada/string-format-gottach)
*   [字符串格式常见问题解答](https://docs.microsoft.com/en-us/archive/blogs/brada/string-formatting-faq)

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2008-09-18T10:08:47.997

差不多好了！对于您将使用的示例，大括号`{{`的转义序列大约是：`}}`

```
string t = "1, 2, 3";
string v = String.Format(" foo {{{0}}}", t); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2010-03-22T10:09:28.993

您可以使用双开括号和双闭括号，它们只会在页面上显示一个括号。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-06-20T19:30:43.400

转义**大括号**和使用**字符串插值**是一个有趣的挑战。您需要使用*四方括号*来逃避**字符串插值**解析和`string.format`解析。

### 转义括号：字符串插值 $("") 和 String.Format

```
string localVar = "dynamic";
string templateString = $@"<h2>{0}</h2><div>this is my {localVar} template using a {{{{custom tag}}}}</div>";
string result = string.Format(templateString, "String Interpolation");

// OUTPUT: <h2>String Interpolation</h2><div>this is my dynamic template using a {custom tag}</div> 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2017-04-18T14:24:01.153

我来这里是为了寻找如何在 C# 中临时构建 JSON 字符串（不序列化类/对象）。换句话说，如何[在 C# 中使用插值字符串](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/interpolated-strings)和“[逐字字符串文字](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/string)”（带有 '@' 前缀的双引号字符串）时转义大括号和引号，例如...

```
var json = $@"{{""name"":""{name}""}}"; 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-05-06T16:48:54.820

```
[TestMethod]
public void BraceEscapingTest()
{
    var result = String.Format("Foo {{0}}", "1,2,3");  //"1,2,3" is not parsed
    Assert.AreEqual("Foo {0}", result);

    result = String.Format("Foo {{{0}}}", "1,2,3");
    Assert.AreEqual("Foo {1,2,3}", result);

    result = String.Format("Foo {0} {{bar}}", "1,2,3");
    Assert.AreEqual("Foo 1,2,3 {bar}", result);

    result = String.Format("{{{0:N}}}", 24); //24 is not parsed, see @Guru Kara answer
    Assert.AreEqual("{N}", result);

    result = String.Format("{0}{1:N}{2}", "{", 24, "}");
    Assert.AreEqual("{24.00}", result);

    result = String.Format("{{{0}}}", 24.ToString("N"));
    Assert.AreEqual("{24.00}", result);
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-01-03T16:49:01.153

或者您可以像这样使用 C# 字符串插值（C# 6.0 中提供的功能）：

```
var value = "1, 2, 3";
var output = $" foo {{{value}}}"; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-04-11T16:10:02.113

**我的目标：**

我需要将值分配`"{CR}{LF}"`给`string`变量`delimiter`。

**C#代码：**

```
string delimiter= "{{CR}}{{LF}}"; 
```

注意：要正常转义特殊字符，您必须使用 \。要打开花括号`{`，请额外使用一个，例如`{{`. 要关闭大括号`}`，请使用一个额外的`}}`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-11T14:01:35.320

**转义括号：字符串插值 $(""):**

现在，您还可以像这样使用 C# 字符串插值（C# 6.0 中提供的功能）：

```
var inVal = "1, 2, 3";
var outVal = $" foo {{{inVal}}}";
// The output will be:  foo {1, 2, 3} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-24T12:45:55.663

你也可以这样使用。 `var outVal = $" foo {"{"}{inVal}{"}"} --- {"{"}Also Like This{"}"}"`

# vb.net - Mercury Quick Test Pro 和虚拟机：可在一台客户端机器上工作，但不能在另一台机器上工作

> ID：91364
> 
> 赞同：6
> 
> 时间：2008-09-18T10:05:25.587
> 
> 标签：vb.net, automated-tests, qtp

我有一个安装了 Mercury Quick Test Professional 9.2 的虚拟机 (VMware)。我有一个脚本来测试应用程序，使用 Infragistics 库在 VB.NET 中编写。

如果我使用笔记本电脑（使用远程桌面）访问此虚拟机，一切正常，脚本完成没有问题。我的笔记本电脑运行 XP，带有 Windows 经典主题。

如果我使用另一台机器（使用远程桌面）访问此虚拟机，脚本启动正常，但中途停止，没有来自 QTP 的错误消息，什么都没有。本机运行 XP，带有 Windows Classic 主题。

两种设置之间的一个区别是屏幕尺寸，笔记本电脑为 1920x1280，其他机器为 1280x1024。

脚本停止的步骤涉及检查 UltraWinGrid 中的复选框。复选框本身会显示，在两种情况下都在屏幕上。

以前有没有人遇到过这个问题，或者知道为什么两台机器的行为不同？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-15T14:29:38.193

好的。我发现了问题。事实上，脚本在默默地失败了，因为这是编写脚本的人告诉它要做的。它无法验证屏幕外的内容，因此脚本失败。

问题在于 QTP 对“屏幕外”的定义。我的笔记本电脑上有两个屏幕，笔记本电脑本身的屏幕（1920x1200）和另一个屏幕（1280x1024）。我使用远程桌面连接到 QTP 的 VM，它使用笔记本电脑的屏幕设置。这意味着当我启动我的 QTP 脚本并将其移动到另一个屏幕时，它不适合，因此屏幕不再最大化，并且对象部分不在屏幕上，因此无法找到。

修复很简单：在远程桌面中，使用显示选项卡，将屏幕尺寸设置为 1280x1024，QTP 就没有任何问题了。

瞧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:44:02.320

如果您没有使用专家模式，和/或允许 QTP 完成大部分工作来创建您的存储库对象，那么是的，它是按像素引用所有内容。

我手动创建了所有存储库对象，查看源代码（在自动化 Web 应用程序测试的情况下）并在需要时使用 Object Spy 寻求帮助。我指出没有任何定位信息作为我的对象定义的一部分，这正是您遇到的原因。

对于我的 Web 应用程序中与 Windows 交互的部分（打开要上传的文件等），Object Spy 对于创建用于创建存储库对象的唯一标识符所必需的反复试验至关重要。但这是可以完成的。

*Ex1: File Browse Dialog*
text = "Choose file"
nativeclass = #32770（显然是一些用于文件打开对话框的 Windows VooDoo？）

*Ex2：浏览对话框中的文件名文本框：*
nativeclass =“编辑”
附加文本“文件和名称：”（更多Windows VooDoo？没有“&”对我不起作用）

*Ex3：在对话框中打开按钮：*
text = "&Open"
object class = "Button"

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T18:44:14.163

澄清点：您提到 QTP 停止时没有错误消息。这是否也意味着测试结果日志文件也没有错误消息？如果日志有任何信息，这可能有助于诊断问题。您能否分享脚本失败时的代码行？

此外，远程桌面将调整远程计算机上的桌面大小。尽管 QTP 脚本本身不是基于坐标的，但单个语句可以相对于对象基于坐标。在这方面，该决议可能是一个问题。例如，假设您在更高分辨率的机器上记录了 Button.Click(5, 150) 之类的行。但是，如果您尝试在较低分辨率的机器上播放它，并且 150 超出了较低分辨率的对象范围，则可能会导致问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T06:47:03.680

QTP 不**使用**屏幕坐标，除非作为最后的手段，如果对象被识别为高级对象（`SwfTable`在这种情况下）你应该没问题，但是如果 QTP 不能识别它回退到的对象`WinObject`和屏幕坐标。

如果您使用的是 Infragistics，那么您应该知道他们通过他们的[TestAdvantage](http://www.infragistics.com/dotnet/testadvantage/ta-qtp.aspx)产品扩展了 QTP 的支持，这可能会解决您的问题。

* * *

**编辑：** @MatthieuF[说](https://stackoverflow.com/questions/91364/mercury-quick-test-pro-and-virtual-machines-works-from-one-client-machine-but-n#126515)：

> 其实我们使用QTP的Infragistics插件，还是有问题

你能给我一个失败的例子吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T18:15:58.000

一些东西：

您应该能够轻松地在 VM 上进行调试 - 只需等待它停止，进入您的对象存储库，看看它是否可以识别对象。如果不是，则使用 object spy 来找出操作系统之间的哪些属性不同。如果存在差异，那么您始终可以将该属性设置为正则表达式并让它检查两种可能性。

假设这不是我们在远程窗口关闭或最小化时使用 QTP 使用远程桌面时遇到的问题。对我们来说，这是一个在 RDP 窗口不可见时无法更改剪贴板的问题，但以这种方式使用 QTP 可能会出现其他意外情况。

# javascript - 如何跟踪诸如 onclick onblur 之类的 JavaScript 事件？

> ID：91367
> 
> 赞同：12
> 
> 时间：2008-09-18T10:05:44.197
> 
> 标签：javascript, debugging, events

有没有办法在 Internet Explorer 7 中调试或跟踪每个 JavaScript 事件？

我有一个阻止文本选择后滚动的错误，我不知道哪个事件或操作会导致错误。例如，我真的很想看看当我移动鼠标时触发了哪些事件。

重新连接源的工作量太大，我有点希望有像嗅探器这样的东西，它可以向我显示所有触发的事件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T13:03:27.827

遍历页面上定义了 onXYZ 函数的所有元素，然后将跟踪添加到它们：

```
var allElements = document.all; // Is this right? Anyway, you get the idea.

for (var i in allElements) {
    if (typeof allElements[i].onblur == "function") {
        var oldFunc = allElements[i].onblur;
        allElements[i].onblur = function() {
             alert("onblur called");
             oldFunc();
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T10:13:19.000

您可能想尝试使用 Visual Studio 2008 及其调试 JavaScript 代码的功能。

如果问题不是特定于 Internet Explorer 7 而是在 Firefox 中也出现，那么调试 JavaScript 代码的另一个好方法是 Firefox 和具有 JavaScript 调试器的[Firebug](http://en.wikipedia.org/wiki/Firebug)插件。然后，您还可以将语句放入 JavaScript 代码中，然后您可以在 Firebug 的*控制台窗口*`console.log`中看到输出，而不是使用有时会弄乱事件链的警报。

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:07:01.470

@[nickf] - 我很确定`document.all`是 Internet Explorer 特定的扩展。

您需要附加一个事件处理程序，没有办法只是“观察”事件。像 Microsoft Ajax 库的 jQuery 这样的框架将轻松地为您提供添加事件处理程序的方法。jQuery 很好，因为它的选择器框架。

然后我使用 Firebug（Firefox 扩展）并放置一个断点。我发现 Firebug 比 Visual Studio 2008 更容易设置和拆卸。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:50:04.257

Borkdude 说：

> 您可能想尝试使用 Visual Studio 2008 及其调试 JavaScript 代码的功能。

我已经多次研究事件处理，在我看来，虽然经典的步进调试器对于跟踪长时间的代码运行很有用，但它们在跟踪事件方面并不好。想象一下监听鼠标移动事件并在每个事件上闯入另一个应用程序......所以在这种情况下，我强烈建议记录。

> 如果问题不是特定于 Internet Explorer 7 而是在 Firefox 中也出现，那么调试 JavaScript 代码的另一个好方法是 Firefox 和具有 JavaScript 调试器的[Firebug](http://en.wikipedia.org/wiki/Firebug)插件。

还有适用于 Internet Explorer 的[Firebug Lite](http://getfirebug.com/firebuglite)。我没有机会使用它，但它存在。:-) 它的缺点是它不是一个成熟的调试器，但它有一个 window.console 对象，这正是您所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T10:12:36.553

这是基本的，但您可以在触发某些内容时粘贴警报或 document.write 调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T10:14:21.930

我不确定确切的代码（自从我编写复杂的 JavaScript 代码以来已经有一段时间了），但是您可以枚举表单上的所有控件并附加一个在触发事件时输出某些内容的事件。

您甚至可以使用匿名函数来包装必要的信息，以识别正在触发的事件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T10:14:59.527

显而易见的方法是为各种事件设置一些警报，例如：

```
element.onclick = function () { alert('点击事件'); }
```

否则，您可以将警报插入到 dom 某处的侵入性较小的选项。

但是，请认真考虑使用像[jQuery](http://jquery.com/)这样的库来实现您的功能。许多跨浏览器问题都是已解决的问题，您无需再次解决它们。我不确定您正在尝试实现的功能，但很可能有很多您可以使用的 jQuery 滚动和选择插件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T10:20:48.500

我喜欢做的一件事是在 JavaScript 中创建一个专门用于事件的绑定函数（就像您可以在[Prototype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)库中找到的那样），以便它将“事件”对象传递给绑定函数。现在，如果您要这样做，您可以简单地抛出一个跟踪调用，该调用将为使用它的每个处理程序调用。然后在不需要时将其删除。一个地方。简单的。

但是，无论您如何获取要调用的跟踪语句，您仍然希望看到它。最好的策略是有一个单独的窗格或窗口来处理跟踪调用。[Dojo Toolkit](http://en.wikipedia.org/wiki/Dojo_Toolkit)有一个在 Internet Explorer 中运行的内置控制台，还有其他类似的东西。这样做的经典方法是创建一个新窗口并`document.write`对其进行操作。

*   我建议为每个跟踪附加一个日期时间。过去对我帮助很大。
*   调试和警报通常对您没有帮助，因为它会中断正常的事件流。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T10:34:52.473

Matt Berseth 可能是您在*[使用 Trace Console AjaxControlToolkit Control 调试 ASP.NET AJAX 应用程序时](http://mattberseth.com/blog/2007/12/debugging_aspnet_ajax_applicat.html)*正在寻找的东西。

它基于 Yahoo [YUI](http://en.wikipedia.org/wiki/Yahoo!_UI_Library)记录器*[YUI 2: Logger](http://developer.yahoo.com/yui/logger/)*。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-18T13:10:06.860

我的建议是，将 FireFox 与 FireBug 一起使用，并使用内置的 Debug/Trace 对象。他们是一种魅力。

# bash - 从 shell 脚本检查目录是否包含文件

> ID：91368
> 
> 赞同：134
> 
> 时间：2008-09-18T10:05:52.217
> 
> 标签：bash, unix, shell

从 shell 脚本中，如何检查目录是否包含文件？

类似的东西

```
if [ -e /some/dir/* ]; then echo "huzzah"; fi; 
```

但如果目录包含一个或多个文件（上述文件仅适用于恰好 0 或 1 个文件），则此方法有效。

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2013-07-27T22:16:46.973

# 三个最佳技巧

* * *

## `shopt -s nullglob dotglob; f=your/dir/*; ((${#f}))`

这个技巧是 100%`bash`并调用（生成）一个子 shell。这个想法来自[Bruno De Fraine](https://stackoverflow.com/a/91558/938111)，并由[teambob](https://stackoverflow.com/users/141736)的评论改进。

```
files=$(shopt -s nullglob dotglob; echo your/dir/*)
if (( ${#files} ))
then
  echo "contains files"
else 
  echo "empty (or does not exist or is a file)"
fi 
```

**注意：**空目录和不存在的目录之间没有区别（即使提供的路径是文件）。

[#bash IRC 频道的](http://mywiki.wooledge.org/BashFAQ/004)[*“官方”*](http://mywiki.wooledge.org/BashFAQ/004)常见问题解答中有类似的替代方法和更多详细信息（以及更多示例）：

```
if (shopt -s nullglob dotglob; f=(*); ((${#f[@]})))
then
  echo "contains files"
else 
  echo "empty (or does not exist, or is a file)"
fi 
```

* * *

## `[ -n "$(ls -A your/dir)" ]`

这个技巧的灵感来自于 2007 年发布的[nixCraft 的文章](http://www.cyberciti.biz/faq/linux-unix-shell-check-if-directory-empty/)。添加`2>/dev/null`以抑制输出错误`"No such file or directory"`。
^(另请参见[Andrew Taylor](https://stackoverflow.com/a/91394/938111)的回答 (2008) 和[gr8can8dian](https://stackoverflow.com/a/4778234/938111)的回答 (2011)。)

```
if [ -n "$(ls -A your/dir 2>/dev/null)" ]
then
  echo "contains files (or is a file)"
else
  echo "empty (or does not exist)"
fi 
```

或单行 bashism 版本：

```
[[ $(ls -A your/dir) ]] && echo "contains files" || echo "empty" 
```

**注意：** 当目录不存在时`ls`返回。`$?=2`但是文件和空目录之间没有区别。

* * *

## `[ -n "$(find your/dir -prune -empty)" ]`

最后一个技巧的灵感来自[gravstar 的回答](https://stackoverflow.com/a/91769/938111)，其中被[phils](https://stackoverflow.com/users/324105/phils)`-maxdepth 0`的评论取代`-prune`和改进。

```
if [ -n "$(find your/dir -prune -empty 2>/dev/null)" ]
then
  echo "empty (directory or file)"
else
  echo "contains files (or does not exist)"
fi 
```

变体使用`-type d`：

```
if [ -n "$(find your/dir -prune -empty -type d 2>/dev/null)" ]
then
  echo "empty directory"
else
  echo "contains files (or does not exist or is not a directory)"
fi 
```

**解释：**

*   `find -prune`类似于`find -maxdepth 0`使用更少的字符
*   `find -empty`打印空目录和文件
*   `find -type d`仅打印目录

**注意：**您也可以`[ -n "$(find your/dir -prune -empty)" ]`仅替换为以下缩短版本：

```
if [ `find your/dir -prune -empty 2>/dev/null` ]
then
  echo "empty (directory or file)"
else
  echo "contains files (or does not exist)"
fi 
```

最后一段代码在大多数情况下都有效，但请注意恶意路径可能会表达命令......

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-09-18T10:46:21.353

到目前为止的解决方案使用`ls`. 这是一个全 bash 解决方案：

```
#!/bin/bash
shopt -s nullglob dotglob     # To include hidden files
files=(/some/dir/*)
if [ ${#files[@]} -gt 0 ]; then echo "huzzah"; fi 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2008-09-18T11:05:35.957

以下情况如何：

```
if find /some/dir/ -maxdepth 0 -empty | read v; then echo "Empty dir"; fi 
```

这样就不需要生成目录内容的完整列表。既要丢弃输出，`read`又要使表达式仅在读取某些内容时才计算为真（即`/some/dir/`通过 发现为空`find`）。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-09-18T10:09:04.470

尝试：

```
if [ ! -z `ls /some/dir/*` ]; then echo "huzzah"; fi 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-09-18T11:31:03.557

注意有很多文件的目录！`ls`评估命令可能需要一些时间。

IMO 最好的解决方案是使用

```
find /some/dir/ -maxdepth 0 -empty 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2011-01-24T03:05:58.523

```
# Works on hidden files, directories and regular files
### isEmpty()
# This function takes one parameter:
# $1 is the directory to check
# Echoes "huzzah" if the directory has files
function isEmpty(){
  if [ "$(ls -A $1)" ]; then
    echo "huzzah"
  else 
    echo "has no files"
  fi
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-18T10:10:35.917

```
DIR="/some/dir"
if [ "$(ls -A $DIR)" ]; then
     echo 'There is something alive in here'
fi 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-18T10:12:31.983

你能比较一下这个的输出吗？

```
 ls -A /some/dir | wc -l 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-04T00:52:21.053

这可能是一个非常晚的响应，但这是一个有效的解决方案。此行仅识别文件的存在！如果目录存在，它不会给你一个误报。

```
if find /path/to/check/* -maxdepth 0 -type f | read
  then echo "Files Exist"
fi 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-03-08T17:04:28.510

```
# 检查目录是否包含任何非隐藏文件。
#
# 用法: if isempty "$HOME"; 然后回显“欢迎回家”；菲
#
是空的（） {
    对于 $1/* 中的 _ief；做
        如果 [ -e "$_ief" ]; 然后
            返回 1
        菲
    完毕
    返回 0
}

```

一些实现说明：

*   该`for`循环避免了对外部`ls`进程的调用。它仍然读取所有目录条目一次。这只能通过编写显式使用 readdir() 的 C 程序来优化。
*   循环内部`test -e`捕获空目录的情况，在这种情况下，`_ief`将为变量分配值“somedir/*”。仅当该文件存在时，该函数才会返回“非空”
*   此功能适用于所有 POSIX 实现。但请注意，Solaris /bin/sh 不属于该类别。它的`test`实现不支持该`-e`标志。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-04-24T07:34:27.340

这告诉我目录是空的还是不是空的，它包含的文件数。

```
directory="/some/dir"
number_of_files=$(ls -A $directory | wc -l)

if [ "$number_of_files" == "0" ]; then
    echo "directory $directory is empty"
else
    echo "directory $directory contains $number_of_files files"
fi 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-06-08T00:06:38.163

# ZSH

我知道这个问题被标记为 bash；但是，仅供参考，对于**zsh**用户：

## 测试非空目录

检查是否`foo`为非空：

```
$ for i in foo(NF) ; do ... ; done 
```

其中，如果`foo`为非空，则`for`块中的代码将被执行。

## 测试空目录

检查是否`foo`为空：

```
$ for i in foo(N/^F) ; do ... ; done 
```

其中，如果`foo`为空，`for`将执行块中的代码。

## 笔记

我们不需要引用`foo`上面的目录，但如果需要，我们可以这样做：

```
$ for i in 'some directory!'(NF) ; do ... ; done 
```

我们还可以测试多个对象，即使它不是目录：

```
$ mkdir X     # empty directory
$ touch f     # regular file
$ for i in X(N/^F) f(N/^F) ; do echo $i ; done  # echo empty directories
X 
```

任何不是目录的东西都将被忽略。

## 附加功能

由于我们是 glob，我们可以使用任何 glob（或大括号扩展）：

```
$ mkdir X X1 X2 Y Y1 Y2 Z
$ touch Xf                    # create regular file
$ touch X1/f                  # directory X1 is not empty
$ touch Y1/.f                 # directory Y1 is not empty
$ ls -F                       # list all objects
X/ X1/ X2/ Xf Y/ Y1/ Y2/ Z/
$ for i in {X,Y}*(N/^F); do printf "$i "; done; echo  # print empty directories
X X2 Y Y2 
```

我们还可以检查放置在数组中的对象。使用上述目录，例如：

```
$ ls -F                       # list all objects
X/ X1/ X2/ Xf Y/ Y1/ Y2/ Z/
$ arr=(*)                     # place objects into array "arr"
$ for i in ${^arr}(N/^F); do printf "$i "; done; echo
X X2 Y Y2 Z 
```

因此，我们可以测试可能已经在数组参数中设置的对象。

请注意，`for`块中的代码显然是依次在每个目录上执行的。如果这不是可取的，那么您可以简单地填充一个数组参数，然后对该参数进行操作：

```
$ for i in *(NF) ; do full_directories+=($i) ; done
$ do_something $full_directories 
```

# 解释

对于 zsh 用户，有`(F)`glob 限定符（参见 参考资料`man zshexpn`），它匹配“完整”（非空）目录：

```
$ mkdir X Y
$ touch Y/.f        # Y is now not empty
$ touch f           # create a regular file
$ ls -dF *          # list everything in the current directory
f X/ Y/
$ ls -dF *(F)       # will list only "full" directories
Y/ 
```

限定符`(F)`列出匹配的对象： 是目录且不为空。因此，`(^F)`匹配：不是目录或为空。因此，`(^F)`例如，单独也会列出常规文件。因此，如`zshexp`手册页所述，我们还需要`(/)`glob 限定符，它只列出目录：

```
$ mkdir X Y Z
$ touch X/f Y/.f    # directories X and Y now not empty
$ for i in *(/^F) ; do echo $i ; done
Z 
```

因此，要检查给定目录是否为空，您可以运行：

```
$ mkdir X
$ for i in X(/^F) ; do echo $i ; done ; echo "finished"
X
finished 
```

并且只是为了确保不会捕获非空目录：

```
$ mkdir Y
$ touch Y/.f
$ for i in Y(/^F) ; do echo $i ; done ; echo "finished"
zsh: no matches found: Y(/^F)
finished 
```

哎呀！由于`Y`不为空，zsh 找不到`(/^F)`("directories that is empty") 的匹配项，因此会吐出一条错误消息，指出未找到 glob 的匹配项。因此，我们需要使用`(N)`glob 限定符抑制这些可能的错误消息：

```
$ mkdir Y
$ touch Y/.f
$ for i in Y(N/^F) ; do echo $i ; done ; echo "finished"
finished 
```

因此，对于空目录，我们需要限定符`(N/^F)`，您可以将其解读为：“不要警告我失败，目录未满”。

同样，对于非空目录，我们需要限定符`(NF)`，我们也可以将其读作：“不要警告我失败，完整目录”。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-09-13T01:09:50.873

```
dir_is_empty() {
   [ "${1##*/}" = "*" ]
}

if dir_is_empty /some/dir/* ; then
   echo "huzzah"
fi 
```

假设您没有名为`*`into的文件`/any/dir/you/check`，它应该可以工作`bash` `dash` `posh` `busybox sh`并且`zsh`（对于 zsh）需要`unsetopt nomatch`。

性能应该与任何`ls`使用`*`（glob）相当，我想在具有许多节点的目录上会很慢（我`/usr/bin`的 3000+ 文件并没有那么慢），将至少使用足够的内存来分配所有目录/文件名（以及更多）由于它们都作为参数传递（解析）给函数，因此某些 shell 可能对参数的数量和/或参数的长度有限制。

检查目录是否为空的可移植快速 O(1) 零资源方法将是不错的选择。

**更新**

上面的版本不考虑隐藏文件/目录，以防需要更多测试，例如`is_empty`来自[Rich 的 sh (POSIX shell) 技巧](http://www.etalabs.net/sh_tricks.html)：

```
is_empty () (
cd "$1"
set -- .[!.]* ; test -f "$1" && return 1
set -- ..?* ; test -f "$1" && return 1
set -- * ; test -f "$1" && return 1
return 0 ) 
```

但是，相反，我正在考虑这样的事情：

```
dir_is_empty() {
    [ "$(find "$1" -name "?*" | dd bs=$((${#1}+3)) count=1 2>/dev/null)" = "$1" ]
} 
```

当 dir 为空时，一些关于尾随斜杠与参数和 find 输出的差异以及尾随换行符（但这应该很容易处理）的担忧，遗憾的是，在我的`busybox` `sh`节目中，可能是`find -> dd`管道上的一个错误，输出被随机截断（如果我使用`cat`的输出总是相同的，似乎是`dd`与论点`count`）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-08-01T17:00:22.767

我很惊讶没有提到[空目录的羊毛指南。](http://mywiki.wooledge.org/BashFAQ/004)本指南，以及所有的wooleedge，都是shell类型问题的必读。

该页面的注意事项：

> 永远不要尝试解析 ls 输出。甚至 ls -A 解决方案也可能中断（例如，在 HP-UX 上，如果您是 root 用户，则 ls -A 的作用与您不是 root 用户的情况完全相反——不，我无法编造出令人难以置信的东西愚蠢的）。
> 
> 事实上，人们可能希望完全避免直接的问题。通常人们想知道一个目录是否为空，因为他们想做一些涉及其中文件的事情，等等。看看更大的问题。例如，这些基于查找的示例之一可能是合适的解决方案：

```
 # Bourne
   find "$somedir" -type f -exec echo Found unexpected file {} \;
   find "$somedir" -maxdepth 0 -empty -exec echo {} is empty. \;  # GNU/BSD
   find "$somedir" -type d -empty -exec cp /my/configfile {} \;   # GNU/BSD 
```

> 最常见的是，真正需要的是这样的：

```
 # Bourne
   for f in ./*.mpg; do
        test -f "$f" || continue
        mympgviewer "$f"
    done 
```

> 换句话说，提出问题的人可能认为需要进行明确的空目录测试以避免出现类似 mympgviewer: ./*.mpg: No such file or directory 而实际上不需要这样的测试的错误消息。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-09-16T08:43:18.287

[布鲁诺答案的](https://stackoverflow.com/a/91558/4450526)小变化：

```
files=$(ls -1 /some/dir| wc -l)
if [ $files -gt 0 ] 
then
    echo "Contains files"
else
    echo "Empty"
fi 
```

这个对我有用

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-07-18T12:32:54.353

通过一些解决方法，我可以找到一种简单的方法来找出目录中是否有文件。这可以通过 grep 命令进行更多扩展，以专门检查 .xml 或 .txt 文件等。例如：`ls /some/dir | grep xml | wc -l | grep -w "0"`

```
#!/bin/bash
if ([ $(ls /some/dir | wc -l  | grep -w "0") ])
    then
        echo 'No files'
    else
        echo 'Found files'
fi 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-07-18T03:21:43.337

从 olibre 的回答中得到一个提示（或几个），我喜欢 Bash 函数：

```
function isEmptyDir {
  [ -d $1 -a -n "$( find $1 -prune -empty 2>/dev/null )" ]
} 
```

因为虽然它创建了一个子外壳，但它与我想象的 O(1) 解决方案一样接近，并且给它一个名称使其可读。然后我可以写

```
if isEmptyDir somedir
then
  echo somedir is an empty directory
else
  echo somedir does not exist, is not a dir, is unreadable, or is  not empty
fi 
```

至于 O(1) 存在异常情况：如果一个大目录已经删除了所有或所有但最后一个条目，“查找”可能必须读取整个内容以确定它是否为空。我相信预期的性能是 O(1)，但最坏的情况是目录大小是线性的。我没有测量过这个。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-04-23T14:49:11.643

```
if [[ -s somedir ]]; then
    echo "Files present"
fi 
```

在我使用 bash 5.0.17 进行的测试中，如果有任何孩子，`[[ -s somedir ]]`将返回 true 。`somedir`也是如此`[ -s somedir ]`。请注意，如果存在隐藏文件或子目录，这也将返回 true。它也可能依赖于文件系统。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-08-05T19:11:10.773

到目前为止，我还没有看到使用 grep 的答案，我认为它会给出更简单的答案（没有太多奇怪的符号！）。以下是我如何使用 bourne shell 检查目录中是否存在任何文件：

这将返回目录中的文件数：

```
ls -l <directory> | egrep -c "^-" 
```

可以在写入目录的地方填写目录路径。管道的前半部分确保每个文件的输出的第一个字符是“-”。egrep 然后使用正则表达式计算以该符号开头的行数。现在您所要做的就是存储您获得的数字并使用反引号进行比较，例如：

```
 #!/bin/sh 
 fileNum=`ls -l <directory> | egrep -c "^-"`  
 if [ $fileNum == x ] 
 then  
 #do what you want to do
 fi 
```

x 是您选择的变量。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-16T16:26:39.743

混合修剪的东西和最后的答案，我得

```
find "$some_dir" -prune -empty -type d | read && echo empty || echo "not empty" 
```

也适用于带空格的路径

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-04-28T00:56:30.587

简单的答案*bash*：

```
if [[ $(ls /some/dir/) ]]; then echo "huzzah"; fi; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-05-20T08:57:09.360

我会去`find`：

```
if [ -z "$(find $dir -maxdepth 1 -type f)" ]; then
    echo "$dir has NO files"
else
    echo "$dir has files" 
```

这将检查仅在目录中查找文件的输出，而不通过子目录。然后它使用以下`-z`选项检查输出`man test`：

```
 -z STRING
          the length of STRING is zero 
```

* * *

查看一些结果：

```
$ mkdir aaa
$ dir="aaa" 
```

空目录：

```
$ [ -z "$(find aaa/ -maxdepth 1 -type f)" ] && echo "empty"
empty 
```

只是目录：

```
$ mkdir aaa/bbb
$ [ -z "$(find aaa/ -maxdepth 1 -type f)" ] && echo "empty"
empty 
```

目录中的一个文件：

```
$ touch aaa/myfile
$ [ -z "$(find aaa/ -maxdepth 1 -type f)" ] && echo "empty"
$ rm aaa/myfile 
```

子目录中的文件：

```
$ touch aaa/bbb/another_file
$ [ -z "$(find aaa/ -maxdepth 1 -type f)" ] && echo "empty"
empty 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-03-07T10:07:42.303

在另一个线程[How to test if a directory is empty with find](https://stackoverflow.com/questions/6845525/how-to-test-if-a-directory-is-empty-with-find/66515079#66515079)我提出了这个

```
[ "$(cd $dir;echo *)" = "*" ] && echo empty || echo non-empty 
```

理由是，$dir 确实存在，因为问题是“从 shell 脚本检查目录是否包含文件”，而且 * 即使在大目录上也没有那么大，在我的系统上 /usr/bin/* 只有 12Kb。

更新：感谢@hh skladby，已修复。

```
[ "$(cd $dir;echo .* *)" = ". .. *" ] && echo empty || echo non-empty 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-10-06T10:16:34.523

## 无需[调用 ls](http://mywiki.wooledge.org/ParsingLs)、 find 等工具：

POSIX 安全，即不依赖于您的 Bash / xyz shell / ls / 等版本：

```
dir="/some/dir"
[ "$(echo $dir/*)x" != "$dir/*x" ] || [ "$(echo $dir/.[^.]*)x" != "$dir/.[^.]*x" ] || echo "empty dir" 
```

想法：

*   `echo *`列出非点文件
*   `echo .[^.]*`列出“.”以外的点文件 和 ”..”
*   如果`echo`找不到匹配项，则返回搜索表达式，即此处`*` 或`.[^.]*`-**两者都不是真正的字符串，并且必须与例如字母连接以强制字符串**
*   `||`交替[短路](https://en.wikipedia.org/wiki/Short-circuit_evaluation)的可能性：至少有一个非点文件或目录或至少一个点文件或目录或目录为空 - 在执行级别：“如果第一种可能性失败，请尝试下一个，如果失败, 试试下一个"; 从技术上讲，这里 Bash “尝试执行” `echo "empty dir"`，将您对空目录的操作放在这里（例如退出）。

使用符号链接进行检查，但尚未使用更奇特的可能文件类型进行检查。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2008-09-18T10:14:53.520

```
if ls /some/dir/* >/dev/null 2>&1 ; then echo "huzzah"; fi; 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-04-30T19:25:32.853

测试特定的目标目录

```
if [ -d $target_dir ]; then
    ls_contents=$(ls -1 $target_dir | xargs); 
    if [ ! -z "$ls_contents" -a "$ls_contents" != "" ]; then
        echo "is not empty";
    else
        echo "is empty";
    fi;
else
    echo "directory does not exist";
fi; 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2017-03-17T12:08:17.203

尝试使用命令查找。指定硬编码的目录或作为参数。然后启动 find 搜索目录内的所有文件。检查 find 的返回是否为空。回显 find 的数据

```
#!/bin/bash

_DIR="/home/user/test/"
#_DIR=$1
_FIND=$(find $_DIR -type f )
if [ -n "$_FIND" ]
then
   echo -e "$_DIR contains files or subdirs with files \n\n "
   echo "$_FIND"
else
echo "empty (or does not exist)"
fi 
```

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2012-01-21T16:59:58.210

我不喜欢`ls - A`发布的解决方案。您很可能希望测试该目录是否为空，因为您不想删除它。以下是这样做的。但是，如果您只想记录一个空文件，那么删除和重新创建它肯定比列出可能无限的文件更快吗？

这应该工作...

```
if !  rmdir ${target}
then
    echo "not empty"
else
    echo "empty"
    mkdir ${target}
fi 
```

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2015-02-04T22:24:30.417

这对我很有效（当 dir 存在时）：

```
some_dir="/some/dir with whitespace & other characters/"
if find "`echo "$some_dir"`" -maxdepth 0 -empty | read v; then echo "Empty dir"; fi 
```

全面检查：

```
if [ -d "$some_dir" ]; then
  if find "`echo "$some_dir"`" -maxdepth 0 -empty | read v; then echo "Empty dir"; else "Dir is NOT empty" fi
fi 
```

# c++ - C++ 代码的单元测试 - 工具和方法

> ID：91384
> 
> 赞同：137
> 
> 时间：2008-09-18T10:08:47.000
> 
> 标签：c++, unit-testing, refactoring

我正在开发一个已经开发了几年的大型 c++ 系统。作为提高现有代码质量的努力的一部分，我们参与了一个大型的长期重构项目。

你知道一个可以帮助我用 C++ 编写单元测试的好工具吗？也许类似于 Junit 或 Nunit 的东西？

任何人都可以就为没有考虑单元测试而编写的模块编写单元测试的方法提供一些好的建议吗？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-09-18T10:47:17.373

将单元测试应用于遗留代码是编写[有效使用遗留代码的](https://rads.stackoverflow.com/amzn/click/com/0131177052)**原因** 。Michael Feathers 是作者 - 正如其他答案中提到的，他参与了[CppUnit](http://sourceforge.net/projects/cppunit)和[CppUnitLite](http://www.objectmentor.com/resources/downloads.html)的创建。

![替代文字](https://i.stack.imgur.com/DIt8J.jpg)

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-09-18T10:20:58.250

Google 最近发布了他们自己的用于单元测试 C++ 应用程序的库，称为 Google Test。

[谷歌代码项目](http://code.google.com/p/googletest/)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-09-27T09:23:36.873

查看几个可用套件之间的出色[比较。](http://gamesfromwithin.com/exploring-the-c-unit-testing-framework-jungle)那篇文章的作者后来开发了[UnitTest++](https://github.com/unittest-cpp/unittest-cpp)。

我特别喜欢它（除了它可以很好地处理异常等）是围绕测试用例和测试夹具定义的“管理”数量非常有限。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-09-18T10:25:00.470

Boost 有一个[测试库](http://www.boost.org/doc/libs/1_34_0/libs/test/doc/index.html)，其中包含对单元测试的支持。这可能值得一试。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-09-18T13:35:40.590

*Games From Within*的Noel Llopis是[Exploring the C++ Unit Testing Framework Jungle](http://gamesfromwithin.com/exploring-the-c-unit-testing-framework-jungle)的作者，这是对各种 C++ 单元测试框架的全面（但现在已经过时）评估，以及一本关于游戏编程的书。

他使用 CppUnitLite 很长一段时间，修复了各种东西，但最终与另一位单元测试库作者联手，制作了[UnitTest++](http://gamesfromwithin.com/unittest-v10-released)。我们在这里使用 UnitTest++，到目前为止，我非常喜欢它。它（对我而言）具有精确的功率平衡，占地面积小。

我使用了本地解决方案、CxxTest（需要 Perl）和 boost::test。当我在目前的工作中实现单元测试时，它几乎可以归结为 UnitTest++ 与 boost::test。

我真的很喜欢我用过的大多数 boost 库，但是恕我直言，boost::test 有点太笨拙了。我特别不喜欢它要求您（AFAIK）使用 boost::test 宏来实现测试工具的主程序。我知道它不是“纯”的 TDD，但有时我们需要一种方法来从 GUI 应用程序中运行测试，例如在命令行中传入一个特殊的测试标志，而 boost::test 不支持这种类型的情景。

UnitTest++ 是我在（有限的）经验中遇到的最简单的设置和使用测试框架。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2010-11-18T07:37:13.410

我将优秀的[Boost.Test](http://www.boost.org/doc/libs/1_44_0/libs/test/doc/html/index.html)库与一个鲜为人知但非常棒的[Turtle](http://sourceforge.net/apps/mediawiki/turtle/index.php?title=Turtle)库结合使用：一个基于 boost 的模拟对象库。

作为一个代码示例胜于雄辩，假设您想测试一个`calculator`在接口上工作的对象`view`（即 Turtle 的介绍性示例）：

```
// declares a 'mock_view' class implementing 'view'
MOCK_BASE_CLASS( mock_view, view )
{
    // implements the 'display' method from 'view' (taking 1 argument)
    MOCK_METHOD( display, 1 )                   
};

BOOST_AUTO_TEST_CASE( zero_plus_zero_is_zero )
{
    mock_view v;
    calculator c( v );

    // expects the 'display' method to be called once with a parameter value equal to 0
    MOCK_EXPECT( v, display ).once().with( 0 ); 

    c.add( 0, 0 );
} 
```

看看在模拟对象上声明期望是多么简单和冗长？显然，如果没有达到预期，测试就会失败。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-12-28T03:11:16.563

我刚刚推出了我自己的框架[CATCH](http://www.levelofindirection.com/journal/2010/12/28/unit-testing-in-c-and-objective-c-just-got-easier.html)。它仍在开发中，但我相信它已经超越了大多数其他框架。不同的人有不同的标准，但我试图在没有太多权衡的情况下涵盖大部分内容。请查看我的链接博客条目以供品酒师使用。我的前五个功能是：

*   仅标题
*   基于功能和方法的测试的自动注册
*   将标准 C++ 表达式分解为 LHS 和 RHS（因此您不需要一整套断言宏）。
*   支持基于功能的夹具中的嵌套部分
*   使用自然语言命名测试 - 生成函数/方法名称

它还具有 Objective-C 绑定。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-09-18T10:24:19.880

[CxxTest](http://cxxtest.tigris.org/)是一个轻量级、易于使用且跨平台的 C++ 类 JUnit/CppUnit/xUnit 框架。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-09-18T10:10:19.507

CppUnit 就是这样。请参阅下面的链接：

[http://cppunit.sourceforge.net/cppunit-wiki](http://cppunit.sourceforge.net/cppunit-wiki)

[http://en.wikipedia.org/wiki/CppUnit](http://en.wikipedia.org/wiki/CppUnit)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-18T10:20:38.670

[UnitTest++](http://unittest-cpp.sourceforge.net/)，小而简单。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-11-25T20:09:40.250

我目前正在寻找可以在我们公司用于长期代码库的单元测试和模拟框架。如您所知，用于 c++[的单元测试框架列表](https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks)很长，因此我应用了一些过滤器将其缩减为可以更仔细查看的手办。第一个过滤标准是它必须是免费的。第二个标准是项目活动。我还寻找了模拟框架，因为如果你想编写单元测试，你需要一个。

我想出了以下列表（大约）按活动排序，最高活动在顶部：

*   **GoogleTest / GoogleMock：**许多贡献者并由 Google 自己使用。这可能会在这里存在一段时间并接收更新。对于我的私人代码库，我将切换到这个组合，希望能跳上最快的火车。

*   **BoostTest + Turtle：**不经常更新，但测试框架是 boost 的一部分，所以应该维护它。另一方面，乌龟主要由一个人维护，但它有怨恨活动，所以它没有死。我几乎所有的测试经验都是用这个组合完成的，因为我们在之前的工作中已经使用了 boost 库，而我目前将它用于我的私有代码。

*   **CppUTest：**提供测试和模拟。这个项目从 2008 年到 2015 年一直活跃，最近有很多活动。这个发现有点令人惊讶，因为很多活动明显较少的项目在网络上搜索时出现的频率更高（例如 CppUnit，它的最后一次更新是在 2013 年）。我没有深入研究这个，所以我不能说任何细节。 **编辑（16.12.2015）：**我最近尝试了这个，发现这个框架有点笨拙和“C 风格”，尤其是在使用模拟类时。此外，与其他框架相比，它的断言种类似乎更少。我认为它的主要优势在于它可以与纯 C 项目一起使用。

*   **QTest：** Qt 框架附带的测试库。维护应该保证一段时间，但我将它用作支持库，因为测试注册在 IMO 中比在其他框架中更笨拙。据我了解，它迫使您每个测试夹具都有一个测试exe。但是测试辅助函数在测试 Qt-Gui 代码时会很有用。它没有模拟。

*   **Catch：**它最近有活动，但主要由一个人开发。这个框架的好处是另一种夹具方法，它允许您在测试本身中编写可重用的夹具代码。它还允许您将测试名称设置为字符串，这在您倾向于将整个句子编写为测试名称时非常有用。我希望这种风格会被撕掉并放入 googleTest ;-)

### 模拟框架

模拟框架的数量比测试框架的数量要少得多，但这里是我发现最近有活动的框架。

*   **Hippomock**：从 2008 年开始活跃，但强度较低。

*   **FakeIt**：从 2013 年开始活跃，但或多或​​少是由一个人开发的。

## 结论

如果您的代码库是长期的，请在**BoostTest + Turtle**和**GoogleTest + GoogleMock**之间进行选择。我认为这两个将有长期维护。如果你只有一个短暂的代码库，你可以试试**Catch**，它有一个很好的语法。然后你需要另外选择一个模拟框架。如果您使用 Visual Studio，您可以下载 BoostTest 和 GoogleTest 的测试运行器适配器，这将允许您使用集成到 VS 中的测试运行器 GUI 运行测试。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-22T07:51:37.113

另请参阅密切相关的问题“选择 C++ 单元测试工具/框架”的答案，[这里](https://stackoverflow.com/questions/13699/choosing-a-c-unit-testing-toolframework#113686)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-13T19:34:24.617

还有[TUT](http://tut-framework.sourceforge.net/)，模板单元测试，一个基于模板的框架。它的语法很笨拙（有些人称之为模板滥用），但它的主要优点是它全部包含在一个[头文件](http://tut-framework.sourceforge.net/_src/TUT-2007-07-06.tar.gz)中。

您将在此处找到[使用 TUT 编写的单元测试示例。](http://pantras.free.fr/articles/hwwtut.html)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-18T10:18:30.907

我已经尝试过 CPPunit，但它对用户不是很友好。

我知道的唯一替代方法是使用 C++.NET 来包装 C++ 类并使用 .NET 单元测试框架（NUnit、MBUnit 等）之一编写单元测试

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-06-07T18:33:35.200

[CppUTest](http://www.cpputest.org/)是一个优秀的轻量级 C 和 C++ 单元测试框架。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-18T10:13:36.630

ObjectMentor 的 Michael Feathers 在 CppUnit 和 CppUnitLite 的开发中发挥了重要作用。

他现在推荐[CppUnitLite](http://www.objectmentor.com/resources/downloads.html)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-12T22:16:59.763

看看[CUnitWin32](http://code.google.com/p/cunitwin32/)。它是为 MS Visual C 编写的。它包含一个示例。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-23T07:17:02.117

看看 cfix ( [http://www.cfix-testing.org](http://www.cfix-testing.org) )，它专门用于 Windows C/C++ 开发，支持用户模式和内核模式单元测试。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-05-11T19:30:45.120

如果您使用的是 Visual Studio 2008 SP1，我强烈建议您使用 MSTest 来编写单元测试。然后我使用谷歌模拟来编写模拟。与 IDE 的集成是理想的，并且在编辑三个位置以添加一个测试方面允许并且不承担 CPPunit 的开销。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-09-27T08:36:40.323

我认为[VisualAssert](http://www.visualassert.com/unit-testing-framework/)在 VS 集成方面做得很好。它允许您从 VS 运行和调试测试，并且您无需创建可执行文件即可运行测试。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-22T07:31:35.180

查看果糖：http: [//sourceforge.net/projects/fructose/](http://sourceforge.net/projects/fructose/)

这是一个非常简单的框架，只包含头文件，因此易于移植。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-03-17T10:50:02.527

我正在使用带有[Typemock Isolator++](https://www.typemock.com/isolatorpp-product-page)的 MS 测试。试试看！

# windows - 在 Windows 上调试 ODBC 驱动程序的最佳方法

> ID：91398
> 
> 赞同：3
> 
> 时间：2008-09-18T10:11:21.487
> 
> 标签：windows, odbc

在 Windows 上调试自定义 ODBC 驱动程序的最佳方法是什么？我们团队的一位前成员编写了驱动程序，因此我们有可用的源代码。

如何将调试器附加到驱动程序？或者更容易将“跟踪打印”添加到驱动程序以查看发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T06:38:15.840

到目前为止，我发现的最佳解决方案是将跟踪打印和断点（int 3）编译到驱动程序中。

跟踪打印一般调试信息和代码片段的断点，我需要更彻底地调查驱动程序的内部状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T10:29:47.587

您可以通过控制面板激活日志记录来调试任何 ODBC 驱动程序。

只需转到驱动程序的属性，激活日志记录并设置目标日志文件 - 然后设置另一个程序以交互方式读取它，这样您就可以看到发生了什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T10:39:12.887

据我所知，ODBC 驱动程序只是实现一组特定功能的 DLL。因此，如果您有可用的源代码，则可以使用 Visual Studio 对其进行调试。这是一篇似乎方向正确的文章：[Debugging DLL Projects in Visual Studio 2005](http://aspalliance.com/1327_Debugging_DLL_Projects_in_Visual_Studio_2005)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:00:28.140

作为对 VS 的支持，您可以使用[WireShark](http://www.wireshark.org/)查看 ODCB 驱动程序发送到数据库的内容。

# json - 如何在 JSON 中表示日期和/或时间信息？

> ID：91413
> 
> 赞同：19
> 
> 时间：2008-09-18T10:13:37.673
> 
> 标签：json, data-formats

JSON 文本 ( [RFC 4627](http://www.ietf.org/rfc/rfc4627.txt?number=4627) ) 对对象、数组、字符串、数字、布尔值（字面意思`true`或`false`）和`null`. 但是，它没有定义任何时间信息，如日期和时间，这在应用程序中很常见。[鉴于RFC 4627](http://www.ietf.org/rfc/rfc4627.txt?number=4627)中规定的约束和语法，当前使用哪些方法来表示 JSON 中的时间？

受访者须知：此问题的目的是记录已知流通的各种方法以及示例和相关优缺点（最好来自现场经验）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T10:29:25.530

我在使用中看到的唯一表示（虽然，诚然，我的经验仅限于[DOJO](http://dojotoolkit.org/)）是[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)，它工作得很好，几乎代表了你可能想到的任何东西。

例如，您可以访问上面的链接。

优点：

*   代表几乎任何你可能扔给它的东西，包括时间跨度。（即 3 天 2 小时）

缺点：

*   嗯……其实我也不知道。除了可能需要一点时间来适应？如果没有内置函数来解析它，它当然很容易解析。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T15:19:08.967

**ISO 8601**似乎是一个自然的选择，但如果你想用在浏览器中运行的 JavaScript 来解析它，你将需要使用一个库，因为浏览器对 JavaScript`Date`对象中可以解析 ISO 8601 日期的部分的支持不一致，即使在相对较新的浏览器中。ISO 8601 的另一个问题是它是一个庞大而丰富的标准，并且日期/时间库仅支持它的一部分，因此您必须选择您使用的库支持的 ISO 8601 子集来使用。

相反，我将时间表示**为自 1970-01-01T00:00Z 以来的毫秒**数。在更旧的浏览器中，对象的构造函数可以理解这一点`Date`，至少可以追溯到 IE7（这是我测试过的最古老的浏览器）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T10:19:45.693

没有固定的文字，所以使用对你来说最简单的。对于大多数人来说，这要么是 UTC 输出的字符串，要么是以 UTC 为中心的时间码的长整数。

阅读更多背景信息：http: [//msdn.microsoft.com/en-us/library/bb299886.aspx](http://msdn.microsoft.com/en-us/library/bb299886.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-23T23:46:31.210

我推荐使用[RFC 3339](https://www.ietf.org/rfc/rfc3339.txt)格式，它既美观又简单，并且被越来越多的语言、库和工具所理解。

不幸的是，RFC 3339、Unix 纪元时间和 JavaScript 毫秒时间都还不够准确，因为它们都没有考虑闰秒！在某些时候，我们都将不得不再次重新审视时间表示。也许下次我们可以完成它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-18T21:37:17.460

很抱歉对这样一个老问题发表评论，但在随后的几年里，出现了更多的解决方案。

在 JSON 中表示日期和/或时间信息是在 JSON 中表示复杂类型和复杂数据结构的更普遍问题的一个特例。使问题变得棘手的部分原因是，如果您将复杂类型（如时间戳）表示为 JSON 对象，那么您需要有一种表达关联数组和对象的方式，这恰好看起来像您的时间戳的 JSON 对象表示，就像其他一些标记的对象。

Google 的[协议缓冲区](https://developers.google.com/protocol-buffers/)有一个[JSON 映射](https://developers.google.com/protocol-buffers/docs/proto3#json)，它具有时间戳类型的概念，并具有定义的语义。

MongoDB 的[BSON](http://bsonspec.org/)有一个[扩展 JSON](https://docs.mongodb.com/manual/reference/mongodb-extended-json/)，上面写着`{ "$date": "2017-05-17T23:09:14.000000Z" }`.

除了日期时间之外，两者还可以表达更复杂的结构。

# c++ - 从 C++ 静态库中导出变量

> ID：91420
> 
> 赞同：3
> 
> 时间：2008-09-18T10:14:58.153
> 
> 标签：c++, export

我有一个用 C++ 编写的静态库，并且我有一个描述数据格式的结构，即

```
struct Format{
    long fmtId;
    long dataChunkSize;
    long headerSize;

    Format(long, long, long);

    bool operator==(Format const & other) const;
}; 
```

一些数据格式被广泛使用，比如`{fmtId=0, dataChunkSize=128, headerSize=0}`和`{fmtId=0, dataChunkSize=256, headerSize=0}`

一些数据结构类在构造函数中接收格式。我想为那些广泛使用的格式提供某种快捷方式，比如我可以通过引用传递的几个全局`Format`成员。`gFmt128, gFmt256`我在 .cpp 文件中实例化它们，例如

`Format gFmt128(0, 128, 0);`

在 .h 中有

`extern Format gFmt128;`

另外，我声明`Format const & Format::Fmt128(){return gFmt128;}`并尝试在主模块中使用它。

但是，如果我尝试在使用 lib 的主模块中执行此操作，则链接器会抱怨 unresolved external `gFmt128`。

如何让我的库“导出”这些全局变量，以便可以从其他模块中使用它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T10:21:36.983

不要在全局声明中使用 static 关键字。[这是一篇文章，解释了带/不带静态变量的可见性](http://msdn.microsoft.com/en-us/library/s1sb61xd.aspx)。静态提供全局内部链接，即仅在声明它们的翻译单元中可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T10:18:04.043

它们是否也在 .cpp 文件中定义？粗略地说，它应该如下所示：

```
struct Format
{
    [...]
    static Format gFmt128;
};
// Format.cpp
Format Format::gFmt128 = { 0, 128, 0 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T10:18:39.300

您需要将 Format 对象声明为**extern**而不是**static**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T18:29:57.450

Morhveus，我也试过了。 *我的*链接器宁愿说它已经定义了 gFmt128 符号。这确实是我所期望的行为：编译器将函数体添加到库和客户端对象中，因为它是在包含文件中定义的。

我得到未解决的外部的唯一方法是

*   不将静态库添加到要链接的对象
*   未在静态库的源文件中定义符号 gFmt128

我很困惑……我们怎么会看到不同的东西？你能解释一下会发生什么吗？

# javascript - javascript消息框

> ID：91434
> 
> 赞同：0
> 
> 时间：2008-09-18T10:18:23.200
> 
> 标签：javascript, .net-2.0

我想在我的 asp.net 应用程序上显示一条错误消息。此消息是一条警告消息，这就是我这样做的方式：

```
CmdCalcInvoke.Attributes["onclick"] = "return confirm('Are you sure you want to calculate the certification? WARNING: If the quarter has not finished, all the partners status will change')"; 
```

上面的代码工作正常。是`CmdCalcInvoke`一个`htmlInputButton`. 这是消息框显示的消息；

> *您确定要计算认证吗？警告：如果该季度尚未结束，所有合作伙伴状态将发生变化*

我想做的是显示这条消息，但想通过加粗来突出显示警告词，或者用红色显示这个词，可以这样做吗？？？，不记得看到有这个特征的消息框，但我想以防万一

欢迎任何建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T10:22:35.717

如果您不使用默认警报框，则可以。尝试使用 javascript 模态窗口，它只是普通的 div 标记，您可以控制其样式。查看 jquery 的 blockui（还有很多其他的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T10:23:46.150

您可以尝试类似：[http ://weblogs.asp.net/johnkatsiotis/archive/2008/09/14/asp-net-messagebox-server-and-client.aspx](http://weblogs.asp.net/johnkatsiotis/archive/2008/09/14/asp-net-messagebox-server-and-client.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T10:25:05.557

我使用的模态对话框控件是： [http :](http://foohack.com/2007/11/css-modal-dialog-that-works-right/) [//foohack.com/tests/vertical-align/dialog.html http://foohack.com/2007/11/css-modal-dialog-that-works-right/](http://foohack.com/tests/vertical-align/dialog.html)

我发现它适用于所有浏览器。我已经破解了它以与 ASP .NET 一起工作，这很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T10:26:05.147

无法将格式应用于标准对话框。但是，如果您*真的*想对其进行格式化，您可以在按钮旁边或绝对放置的 div 中以 HTML 格式显示消息，您可以使用 CSS 对其进行格式化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T10:39:10.937

否则，使用像 Thinbox 这样的基于 LightBox 的解决[方案](http://codylindley.com/Javascript/257/thickbox-one-box-to-rule-them-all)？

# unit-testing - Amazon S3 独立存根服务器

> ID：91443
> 
> 赞同：18
> 
> 时间：2008-09-18T10:19:46.350
> 
> 标签：unit-testing, amazon-s3, amazon-web-services, stub

我似乎记得读过有关 Amazon S3 兼容测试服务器的文章，您可以在自己的服务器上运行它以进行单元测试或其他任何事情。然而，我已经用尽了我的耐心在谷歌和 AWS 上寻找这个。这样的事情存在吗？如果没有，我想我会写一个。

注意：我问的是 Amazon S3（存储系统）而不是 Amazon EC2（云计算）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T22:10:02.990

你在想[公园广场](http://github.com/technoweenie/parkplace)吗？

仅供参考，其[旧主页](http://code.whytheluckystiff.net/parkplace/)现已离线。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-18T17:47:37.677

我认为 moto ( [https://github.com/spulec/moto](https://github.com/spulec/moto) ) 是您单元测试的完美工具。Moto 模拟对 S3、SQS 等的所有访问，并且可以使用其 Web 服务器以任何编程语言使用。

设置简单，轻巧且快速。

来自 moto 的自述文件：

假设您有以下要测试的代码：

```
import boto
from boto.s3.key import Key

class MyModel(object):
    def __init__(self, name, value):
        self.name = name
        self.value = value

    def save(self):
        conn = boto.connect_s3()
        bucket = conn.get_bucket('mybucket')
        k = Key(bucket)
        k.key = self.name
        k.set_contents_from_string(self.value) 
```

花点时间想想你过去会如何测试它。现在看看如何用 Moto 测试它：

```
import boto
from moto import mock_s3
from mymodule import MyModel

@mock_s3
def test_my_model_save():
    model_instance = MyModel('steve', 'is awesome')
    model_instance.save()

    conn = boto.connect_s3()
    assert conn.get_bucket('mybucket').get_key('steve') == 'is awesome' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T19:13:41.660

Park Place 已移至 github：http: [//github.com/technoweenie/parkplace](http://github.com/technoweenie/parkplace)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T10:45:06.960

[桉树](http://eucalyptus.cs.ucsb.edu/) [http://eucalyptus.cs.ucsb.edu/](http://eucalyptus.cs.ucsb.edu/)

> EUCALYPTUS - 用于将您的程序链接到有用系统的弹性实用计算架构 - 是一种用于在集群上实现“云计算”的开源软件基础架构。EUCALYPTUS 的当前接口与 Amazon 的 EC2 接口兼容，但基础设施旨在支持多个客户端接口。

请注意，根据文档，Eucalypus 不仅重新实现了 EC2 接口，还重新实现了 S3 存储系统。该存储组件称为海象。( [http://open.eucalyptus.com/wiki/EucalyptusUserGuide_v1.5.2](http://open.eucalyptus.com/wiki/EucalyptusUserGuide_v1.5.2) )

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T20:06:38.157

[Fake S3](https://github.com/jubos/fake-s3)似乎是 S3 的最新重新实现，专门设计用于测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-02T11:41:57.473

我们在本地测试基于 S3 的代码时遇到了问题，实际上实现了一个小型 Java 服务器，它模拟了 S3 对象 API。由于它可能对其他人有用，我们设置了一个 github 存储库和一个小网站：[http](http://s3ninja.net) ://s3ninja.net - 全部在 MIT 许可下开源。

它非常小而简单，可以在几分钟内完成设置。（作为基于[SIRIUS](http://sirius-lib.net "天狼星")的应用程序，中等服务器上的启动只需不到一秒的时间）。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-09-18T10:27:33.553

Amazon 使用 Xen，因此您可以在自己的 Xen 安装中运行您的 AMI。不过，我只是启动一个实例并在那里运行测试。它不会花费太多，您通常应该可以在本地开发并且不经常在他们的系统上对其进行测试。

# user-interface - 分层模型视图控制器 (HMVC) 的示例？

> ID：91478
> 
> 赞同：9
> 
> 时间：2008-09-18T10:27:06.440
> 
> 标签：user-interface, design-patterns, model-view-controller

我对 Presentation-Abstraction-Control 感兴趣？（又名 Hierarchical-Model-View-Controller (HMVC)）用于构建复杂用户界面（GUI 或 Web）的架构模式，想知道是否有人知道我可以阅读代码的野外示例？

我知道[Presentation-Abstraction-Control 维基百科文章](http://en.wikipedia.org/wiki/Presentation-abstraction-control)中引用的 JavaWorld 文章和相关信件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T06:29:32.590

在 php 世界中，我知道一些可能符合 HMVC 的方法。它们都允许调用控制器并在视图中显示结果。调用可以无限嵌套，在小部件中创建小部件。

*   Zend 框架：[动作视图助手](http://framework.zend.com/manual/en/zend.view.helpers.html)
*   CodeIgniter：第 3 方[模块化扩展 - HMVC](http://codeigniter.com/forums/viewthread/73177/)
*   Kohana：第 3 方[组件](http://forum.kohanaphp.com/comments.php?DiscussionID=1170)编辑：Kohana 3 现在原生支持 HMVC

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T06:07:24.343

不久前，我为 J2EE 和 FreeMarker 编写了一个 HMVC 框架：

[http://www.neocoders.com/portal/projects/jandal](http://www.neocoders.com/portal/projects/jandal)

最近还有一个用于 Javascript 的：

[http://www.neocoders.com/portal/projects/subo](http://www.neocoders.com/portal/projects/subo)

这些是相当“实验性的”，但可能有一些学术用途。

干杯，林赛

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:53:08.660

据我了解，Adobe Flex 的 Cairngorm 框架只是 HMVC 实现的一个示例。它是开源的，因此您可以在[Adob​​e 的网站上](http://opensource.adobe.com/wiki/display/cairngorm/Cairngorm)找到更多信息并下载代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-22T21:04:53.420

APF-Webframework - [http://adventure-php-framework.org/Page/001-Home](http://adventure-php-framework.org/Page/001-Home) - 多年来一直使用 HMVC，并且拥有一位经验丰富且敬业的开发人员。只有小社区有点气馁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-20T15:11:37.940

我用 PHP 编写了一个名为 Alloy 的 HMVC 框架：

[http://alloyframework.org/](http://alloyframework.org/)

它非常轻巧，并且具有模块化结构。

# mysql - 如何在mysql中更改Group By子句的默认顺序

> ID：91479
> 
> 赞同：8
> 
> 时间：2008-09-18T10:27:07.487
> 
> 标签：mysql, sql

默认情况下，`GROUP BY`子句提取的数据按升序排序。如何将其更改为降序。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-10-12T13:17:14.640

您应该在 SQL 上使用派生表。例如，如果您想获取您尝试使用的特定活动的最新行：

```
select * 
from activities 
group by id_customer 
order by creation_date 
```

但它不起作用。请尝试：

```
SELECT * 
FROM ( select * 
       from activities 
       order by creation_date desc ) sorted_list 
GROUP BY id_customer 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T10:27:34.067

添加`DESC`到`GROUP BY`子句中，例如：

```
GROUP BY myDate DESC 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T21:20:02.843

正如[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/order-by-optimization.html "按优化排序")所说，

```
SELECT * FROM foo GROUP BY bar 
```

相当于

```
SELECT * FROM foo GROUP BY bar ORDER BY bar 
```

默认行为无法更改，但您可以使用

```
SELECT * FROM foo GROUP BY bar ORDER BY bar DESC 
```

不会遇到任何速度损失，因为无论如何都会在分组字段上执行排序。顺便说一句，当排序不重要时，您可以通过使用 ORDER BY NULL 来获得（小）加速。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T10:27:56.733

`ORDER BY foo DESC`?

# eclipse - eclipse plugin.xml 页面的源代码

> ID：91480
> 
> 赞同：1
> 
> 时间：2008-09-18T10:27:13.133
> 
> 标签：eclipse, rcp

我想知道在哪里可以找到 eclipse 用来在 plugin.xml 文件中显示表单的代码。特别是我正在寻找 plugin.xml 的扩展选项卡中使用的表单布局

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T12:56:57.843

不幸的是，Eclipse 的插件搜索不适用于引用的插件。为了进行这些搜索，我创建了一个工作区，其中包含我的 eclipse 安装中的所有插件作为源文件夹。我只是打开工作区并在那里执行我的插件搜索。只需打开搜索对话框并选择插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T13:06:27.317

您可以使用包资源管理器中的 import -> Plugins and Fragments 将 eclipse 插件导入您的工作区。然后使用以下选项：

*   从指定位置找到的所有插件和片段中选择
*   使用源文件夹从目标平台导入（最后一个选项）

导入 org.eclipse.pde.ui 插件

您寻找的代码在 org.eclipse.pde.internal.ui.editor.plugin

更具体地说，ExtensionPointsPage 类

# java - 如何让嵌入式 Jetty 网络服务器转储 JSP 的临时 Java 代码

> ID：91487
> 
> 赞同：5
> 
> 时间：2008-09-18T10:27:41.073
> 
> 标签：java, jsp, jetty

在 OpenNMS 中调试 JSP 页面时，我一直遇到这个问题。Jetty wiki 在 webdefault.xml 中讨论了 keepGenerated ( [http://docs.codehaus.org/display/JETTY/KeepGenerated](http://docs.codehaus.org/display/JETTY/KeepGenerated) )，但似乎不清楚这在嵌入式设置中是如何工作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-11-28T15:00:11.037

我知道这已经很久了，但我在互联网上的其他任何地方都没有找到答案，而且看起来这似乎并没有变得更容易。希望这会帮助某人：

从 jetty-version.jar 中提取 webdefault.xml，我的在 :C:\Documents and Settings\JB.m2\repository\org\mortbay\jetty\jetty\6.1.22\jetty-6.1.22.jar 里面org/mortbay/jetty/webapp/webdefault.xml 文件

将 webdefault.xml 放入我的项目目录

编辑 webdefault.xml 并添加以下行：

```
<servlet id="jsp">
 ....
  <init-param>
    <param-name>keepgenerated</param-name>
    <param-value>true</param-value>
  </init-param> 
```

将以下内容添加到您的 maven pom.xml 配置中：

```
<plugin>
  <groupId>org.mortbay.jetty</groupId>
  <artifactId>maven-jetty-plugin</artifactId>
  <configuration>    
    <webDefaultXml>webdefault.xml</webDefaultXml>
  </configuration>
</plugin> 
```

当您运行`mvn jetty:run`maven 目标时，我的 jsp 代码现在保存在 target\work\jsp\org\apache\jsp\WEB_002dINF\jsp

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T12:51:25.610

如果您使用的是 Jetty 6，则可以使用以下代码：

```
String webApp = "./web/myapp"; // Location of the jsp files
String contextPath = "/myapp";
WebAppContext webAppContext = new WebAppContext(webApp, contextPath); 
ServletHandler servletHandler = webAppContext.getServletHandler();
ServletHolder holder = new ServletHolder(JspServlet.class);
servletHandler.addServletWithMapping(holder, "*.jsp");
holder.setInitOrder(0);
holder.setInitParameter("compiler", "modern");
holder.setInitParameter("fork", "false");

File dir = new File("./web/compiled/" + webApp);
dir.mkdirs();
holder.setInitParameter("scratchdir", dir.getAbsolutePath()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T12:48:16.867

它已经被倾倒了。例如，如果您有一个名为`index.jsp`的文件，则会创建一个名为的文件，`index_jsp.java` 只需在工作目录中搜索类似的内容即可。

# c# - 如何将现有内存缓冲区包装为 GDI 的 DC

> ID：91511
> 
> 赞同：3
> 
> 时间：2008-09-18T10:36:08.477
> 
> 标签：c#, .net, c++, vb.net, gdi+

我有一个对应于我的屏幕分辨率（1280x800，每像素 24 位）的内存缓冲区，其中包含我的 24bpp 屏幕内容。我想将其转换为 8-bpp（即 Windows 中的半色调调色板）。我目前这样做： 1\. 使用 CreateDIBSection 分配一个新的 1280x800 24-bpp 缓冲区并将其作为 DC 以及普通内存缓冲区访问 2\. 使用 memcpy 从我的原始缓冲区复制到步骤 1 中的这个新缓冲区 3 . 使用 BitBlt 让 GDI 执行颜色转换

我想避免步骤 2 的额外 memcpy。为此，我可以想到两种方法：

一种。将我原来的 mem buf 包装在 DC 中以直接从中执行 BitBlt

湾。编写我自己的 24-bpp 到 8-bpp 颜色转换。我找不到有关 Windows 如何实现这种半色调颜色转换的任何信息。此外，即使我发现，我也不会使用 BitBlt 可以访问的 GDI 加速功能。

那么我该怎么做（a）或（b）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T10:50:36.557

好的，解决问题的两个部分。

1.  以下代码显示了如何获取位图中的像素，更改它们并将它们放回位图中。你总是可以生成一个正确大小和格式的虚拟位图，打开它，复制你的数据，然后你就有一个包含数据的位图对象：

    ```
    private void LockUnlockBitsExample(PaintEventArgs e)
    {

       // Create a new bitmap.
       Bitmap bmp = new Bitmap("c:\\fakePhoto.jpg");

       // Lock the bitmap's bits.  
       Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
       System.Drawing.Imaging.BitmapData bmpData =
             bmp.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadWrite,
             bmp.PixelFormat);

       // Get the address of the first line.
       IntPtr ptr = bmpData.Scan0;

       // Declare an array to hold the bytes of the bitmap.
       int bytes  = bmpData.Stride * bmp.Height;
       byte[] rgbValues = new byte[bytes];

       // Copy the RGB values into the array.
       System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes);

       // Set every third value to 255\. A 24bpp bitmap will look red.  
       for (int counter = 2; counter < rgbValues.Length; counter += 3)
           rgbValues[counter] = 255;

       // Copy the RGB values back to the bitmap
       System.Runtime.InteropServices.Marshal.Copy(rgbValues, 0, ptr, bytes);

       // Unlock the bits.
       bmp.UnlockBits(bmpData);

       // Draw the modified image.
       e.Graphics.DrawImage(bmp, 0, 150);
    } 
    ```

要将内容转换为 8bpp，您需要使用 System.Drawing.Imaging.ColorMatrix 类。我手头没有半色调的正确矩阵值，但是这个例子的灰度和值的调整应该让您了解效果：

```
Graphics g = e.Graphics;
Bitmap bmp = new Bitmap("sample.jpg");
g.FillRectangle(Brushes.White, this.ClientRectangle);

// Create a color matrix
// The value 0.6 in row 4, column 4 specifies the alpha value
float[][] matrixItems = {
                            new float[] {1, 0, 0, 0, 0},
                            new float[] {0, 1, 0, 0, 0},
                            new float[] {0, 0, 1, 0, 0},
                            new float[] {0, 0, 0, 0.6f, 0}, 
                            new float[] {0, 0, 0, 0, 1}};
ColorMatrix colorMatrix = new ColorMatrix(matrixItems);

// Create an ImageAttributes object and set its color matrix
ImageAttributes imageAtt = new ImageAttributes();
imageAtt.SetColorMatrix(colorMatrix, ColorMatrixFlag.Default, ColorAdjustType.Bitmap);

// Now draw the semitransparent bitmap image.
g.DrawImage(bmp, this.ClientRectangle, 0.0f, 0.0f, bmp.Width, bmp.Height, 
            GraphicsUnit.Pixel, imageAtt);

imageAtt.Dispose(); 
```

稍后我将尝试使用半色调的矩阵值进行更新，其中可能有很多 0.5 或 0.333 值！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:22:37.360

使用 CreateDIBitmap 而不是 CreateDIBSection。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T18:18:49.660

如果您想消除副本（第 2 步），只需使用 CreateDIBSection 首先创建您的原始内存缓冲区。然后，您可以为该位图创建一个兼容的 DC，并将其用作 BitBlt 操作的源。

即，如果您首先使用 CreateDIBSection 位图而不是“普通内存”缓冲区，则无需在传输之前将内存从“普通内存”缓冲区复制到 CreateDIBSection 位图。

毕竟，使用 CreateDIBSection 分配的缓冲区本质上只是与您正在寻找的 CreateCompatibleDC 兼容的“普通内存”缓冲区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:51:32.430

首先，您是如何将屏幕内容放入这个 24bpp 内存缓冲区的？

避免不必要的 memcpy 的明显途径是通过首先创建 24bpp DIBSection 并将其作为目标缓冲区传递给 screengrab 函数来颠覆原始屏幕抓取。

如果那不可能，您仍然可以尝试通过创建一个描述内存缓冲区格式的 BITMAPINFOHEADER 来强制 GDI 进行硬提升，然后只需调用 StretchDIBits 将其 blit 到您的 8bpp DIBSection 上。

# javascript - jQuery 属性选择器：如何使用自定义命名空间查询属性

> ID：91518
> 
> 赞同：34
> 
> 时间：2008-09-18T10:38:41.543
> 
> 标签：javascript, jquery

假设我有一个简单的 XHTML 文档，它为属性使用了自定义命名空间：

```
<html xmlns="..." xmlns:custom="http://www.example.com/ns">
    ...
    <div class="foo" custom:attr="bla"/>
    ...
</html> 
```

如何使用 jQuery 匹配具有特定自定义属性的每个元素？使用

```
$("div[custom:attr]") 
```

不起作用。（到目前为止，仅在 Firefox 上试用过。）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-09-18T11:42:08.583

[jQuery](https://jquery.com/)不直接支持自定义命名空间，但您可以使用过滤功能找到您要查找的 div。

```
// find all divs that have custom:attr
$('div').filter(function() { return $(this).attr('custom:attr'); }).each(function() {
  // matched a div with custom::attr
  $(this).html('I was found.');
}); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-02-02T13:55:44.110

这在某些情况下有效：

`$("div[custom\\:attr]")`

但是，对于更高级的方法，请参阅[此 XML Namespace jQuery 插件](http://www.rfk.id.au/blog/entry/xmlns-selectors-jquery)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-28T09:17:25.827

按属性匹配的语法是：

`$("div[customattr=bla]")`火柴`div customattr="bla"`

`$("[customattr]")`匹配具有该属性的所有标签`"customattr"`

具有名称空间属性，例如`'custom:attr'`它不起作用

[在这里](http://www.pamaya.com/jquery-selectors-and-attribute-selectors-reference-and-examples/)你可以找到一个很好的概述。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T10:56:41.110

你应该使用`$('div').attr('custom:attr')`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-04T16:21:35.487

这是一个适合我的自定义选择器的实现。

```
// Custom jQuery selector to select on custom namespaced attributes
$.expr[':'].nsAttr = function(obj, index, meta, stack) {

    // if the parameter isn't a string, the selector is invalid, 
    // so always return false.
    if ( typeof meta[3] != 'string' )
        return false;

    // if the parameter doesn't have an '=' character in it, 
    // assume it is an attribute name with no value, 
    // and match all elements that have only that attribute name.
    if ( meta[3].indexOf('=') == -1 )
    {
        var val = $(obj).attr(meta[3]);
        return (typeof val !== 'undefined' && val !== false);
    }
    // if the parameter does contain an '=' character, 
    // we should only match elements that have an attribute 
    // with a matching name and value.
    else
    {
        // split the parameter into name/value pairs
        var arr = meta[3].split('=', 2);
        var attrName  = arr[0];
        var attrValue = arr[1];

        // if the current object has an attribute matching the specified 
        // name & value, include it in our selection.
        return ( $(obj).attr(attrName) == attrValue );
    }
}; 
```

示例用法：

```
// Show all divs where the custom attribute matches both name and value.
$('div:nsAttr(MyNameSpace:customAttr=someValue)').show();

// Show all divs that have the custom attribute, regardless of its value.
$('div:nsAttr(MyNameSpace:customAttr)').show(); 
```

# c# - drawString 方法如何用于编写对角线方式

> ID：91521
> 
> 赞同：6
> 
> 时间：2008-09-18T10:39:21.590
> 
> 标签：c#, image, visual-studio-2005, gdi, drawstring

我正在使用 c# 2005 我想在图像上对角写入字符串。但默认情况下，c# 提供水平或垂直书写的选项。

我们如何对角书写？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T10:44:22.013

您可以使用 Graphics 类上可用的 RotateTransform 和 TranslateTransform。因为使用 DrawString 是 GDI+，所以变换会影响绘图。所以使用这样的东西......

```
g.RotateTransform(45f);
g.DrawString("My String"...);
g.RotateTransform(-45f); 
```

不要忘记扭转变化！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T10:42:17.730

在调用 drawString 之前执行 [Graphics.rotateTransform 。](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.rotatetransform.aspx)正如 Phil Wright 指出的那样，不要忘记事后扭转这种变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-27T10:58:30.967

您可以使用此功能。

```
 void DrawDigonalString(Graphics G, string S, Font F, Brush B, PointF P, int Angle)
   {
       SizeF MySize = G.MeasureString(S, F);
       G.TranslateTransform(P.X + MySize.Width / 2, P.Y + MySize.Height / 2);
       G.RotateTransform(Angle);
       G.DrawString(S, F, B, new PointF(-MySize.Width / 2, -MySize.Height / 2));
       G.RotateTransform(-Angle);
       G.TranslateTransform(-P.X - MySize.Width / 2, -P.Y- MySize.Height / 2);
   } 
```

像这样

![在此处输入图像描述](https://i.stack.imgur.com/0bEUP.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-29T14:13:41.317

你有权利..可以用这种方式完成..但是文本总是从上到下写，我不确定你可以从下到上改变它..干杯

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-13T13:03:06.250

还有另一种在 C# 中构建的垂直绘制文本的方法。不需要显式的图形转换。您可以使用 StringFormat 类。这是一个垂直绘制文本的示例代码：

StringFormat sf = new StringFormat(); sf.FormatFlags = StringFormatFlags.DirectionVertical; e.Graphics.DrawString("我的字符串", this.Font, Brushes.Black, PointF.Empty, sf);

# flash - 使用 Flash / Actionscript 3 流式传输音频 - 播放缓慢问题

> ID：91525
> 
> 赞同：0
> 
> 时间：2008-09-18T10:40:09.933
> 
> 标签：flash, actionscript-3, streaming, mp3, shoutcast

我为 Shoutcast 流编写了一个简单的 Flash 播放器。起初它似乎工作可靠，但是大约 5% 的时间用户会遇到慢速播放，其中流以大约正常速度的一半播放。

所有流式传输的文件都是 MP3，编码为 128kbps/44.1kHz，与 Shoutcast 配置文件中使用的设置相同，因此问题不是由我读过的许多论坛上建议的比特率不匹配引起的。有没有其他人遇到过这个问题并可能找到了解决方案？

问候，
艾伦

编辑：可以在[http://radionations.com/utils/players/pulse.swf](http://radionations.com/utils/players/pulse.swf)找到一个示例播放器 没有图形显示，因为播放器设计为在后台运行。

该问题仅在一小部分时间发生，并且仅在浏览器中加载播放器时发生。它不会发生在中游。

该播放器已在运行 Windows XP、Vista、Ubuntu 和 MacOS X 的许多不同机器上进行了测试。涉及各种不同的硬件配置。这个问题发生在所有这些测试平台上，所以我倾向于相信这不是有问题/有问题的音频驱动程序的问题。

无论有没有其他使用音频设备的应用程序，我都遇到过这个问题。

编辑：我很惊讶我仍然没有找到解决这个问题的方法。所以我决定现在回到它，希望有人可能知道一些事情。任何帮助是极大的赞赏。

谢谢，艾伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T00:09:07.203

不幸的是，这是一个 Flash 播放器错误。似乎唯一可靠的解决方案是将其回滚到 AS2。

[https://bugs.adobe.com/jira/browse/FP-173](https://bugs.adobe.com/jira/browse/FP-173)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T11:52:44.253

我认为播放缓慢是由音频驱动程序问题引起的。能给个播放器的链接吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:00:23.030

我在您的播放器中遇到了播放缓慢的问题，大约有 25% 的时间是我重新加载它，但前提是当流开始播放时，另一个使用音频设备的应用程序正在运行，我快速查看后估计。也许您应该在多台计算机上测试这种情况。我猜这是音频驱动程序的问题，我使用的是 XP 64，而我的音频驱动程序是测试版。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T11:18:37.930

我制作了一个非常简单的播放器，可以从您的服务器流式传输，但它也有这个问题。非常有趣......然后我让它在加载 100K 并且它似乎正在工作之后稍后开始发出声音，但我现在没有时间对其进行更多测试。你可以在这里得到它[http://rromania.ro/sc/sc.rar](http://rromania.ro/sc/sc.rar)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T20:13:02.417

在发送完成事件后等待 6 秒，它似乎可以正常工作，因此它会下载足够的数据以正常速度运行，尝试了很多次，还没有慢速播放

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-22T21:47:24.947

我已经成功使用：

s.load(新 URLRequest(mp3),新 SoundLoaderContext(3000)); // 3000 是 3 秒的缓冲时间

我不能 100% 确定，但是由于我一直在缓冲它，所以我没有注意到许多重新加载的任何慢速播放。

希望这可以帮助。

# c# - 切换属性类型

> ID：91563
> 
> 赞同：34
> 
> 时间：2008-09-18T10:47:28.717
> 
> 标签：c#, switch-statement

我怎样才能使这项工作？

```
switch(property.PropertyType){
    case typeof(Boolean): 
        //doStuff
        break;
    case typeof(String): 
        //doOtherStuff
        break;
    default: break;
} 
```

我不想使用该名称，因为类型的字符串比较非常糟糕，并且可能会发生变化。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-09-18T10:54:29.400

```
 System.Type propertyType = typeof(Boolean);
        System.TypeCode typeCode = Type.GetTypeCode(propertyType);
        switch (typeCode)
        {
            case TypeCode.Boolean:
                //doStuff
                break;
            case TypeCode.String:
                //doOtherStuff
                break;
            default: break;
        } 
```

您可以对 TypeCode.Object 使用混合方法，如果使用 typeof，您可以在其中动态。这非常快，因为对于第一部分 - 开关 - 编译器可以根据查找表来决定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T10:57:33.573

你不能。您可以做的是使用字典创建类型和委托之间的映射：

```
var TypeMapping = new Dictionary<Type, Action<string>>(){
    {typeof(string), (x)=>Console.WriteLine("string")},
    {typeof(bool), (x)=>Console.WriteLine("bool")}
};

string s = "my string";

TypeMapping[s.GetType()]("foo");
TypeMapping[true.GetType()]("true"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T10:58:22.683

我认为您在这里寻找的是一张好的地图。使用委托和通用 IDictionary 你可以做你想做的事。

尝试这样的事情：

```
private delegate object MyDelegate();

private IDictionary<Type, MyDelegate> functionMap = new IDictionary<Type, MyDelegate>();

public Init()
{
  functionMap.Add(typeof(String), someFunction);
  functionMap.Add(tyepof(Boolean), someOtherFunction);
}

public T doStuff<T>(Type someType)
{
   return (T)functionMap[someType]();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-11T18:19:22.113

C# 7.0 将支持切换类型作为更大模式匹配功能的一部分。此示例取自宣布新功能的[.NET 博客文章：](https://blogs.msdn.microsoft.com/dotnet/2016/08/24/whats-new-in-csharp-7-0/)

```
switch(shape)
{
    case Circle c:
        WriteLine($"circle with radius {c.Radius}");
        break;
    case Rectangle s when (s.Length == s.Height):
        WriteLine($"{s.Length} x {s.Height} square");
        break;
    case Rectangle r:
        WriteLine($"{r.Length} x {r.Height} rectangle");
        break;
    default:
        WriteLine("<unknown shape>");
        break;
    case null:
        throw new ArgumentNullException(nameof(shape));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T10:53:21.853

不要担心在 switch 中使用字符串，因为如果你有多个，编译器会自动将其转换为哈希查找，尽管它看起来非常棒，但它提供了不错的性能。

类型字符串更改的问题可以通过自己进行显式哈希查找并在静态构造函数中填充哈希的内容来解决。这样，哈希在运行时会填充正确的字符串，因此它们保持正确。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T10:53:31.820

你不能用 c# 中的 switch 来做到这一点，因为情况必须是不变的。

出什么问题了：

```
if(property.PropertyType == typeof(bool)) {
    //dostuff;
}
else if (property.PropertyType == typeof(string)) {
    //do other stuff;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T10:58:16.583

我最近不得不做类似的事情，并且不能选择使用 switch。在 typeof(x) 上做一个 == 很好，但更优雅的方法可能是做这样的事情：

```
if(property.PropertyType is bool){
  //dostuff;
}
else if (property.PropertyType is string){
    //do other stuff;
} 
```

但是，我不确定您是否可以以这种方式使用“is”关键字，我认为它仅适用于对象......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T11:35:33.513

关于字符串匹配：问题中的要求之一是不通过字符串匹配来做到这一点。

字典是我将整个序列化算法放在它自己的库中时使用的一种方法。至于现在，我将首先尝试 typeCode，因为我的案例仅使用基本类型。如果这不起作用，我将回到 if/elses 群：S

在 ppl 问我为什么我想要自己的序列化之前：1）.net xml 序列化不会在没有设置器的情况下序列化属性 2）序列化必须遵守一些遗留规则

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T10:54:08.450

只需使用正常的 if/else if/else 模式：

```
if (property.PropertyType == typeof(Boolean))
{
} 
else if (property.PropertyType == typeof(String))
{
}
else if (...)
{
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-18T11:18:37.470

我个人`Dictionary<Type, other>`最喜欢这种方法......我什至可以为您提供另一个示例：[http ://www.timvw.be/presenting-namevaluecollectionhelper/](http://www.timvw.be/presenting-namevaluecollectionhelper/)

如果您坚持编写 switch-case 语句，您可以使用类型名称...

```
switch (blah.PropertyType.FullName)
{
   case typeof(int).FullName: break;
   case typeof(string).FullName: break;
} 
```

# makefile - crti.o 文件丢失

> ID：91576
> 
> 赞同：28
> 
> 时间：2008-09-18T10:50:42.483
> 
> 标签：makefile, linker

我正在使用 GNU 工具链构建一个项目，一切正常，直到我开始链接它，链接器抱怨它丢失/找不到`crti.o`. 这不是我的目标文件之一，它似乎与 libc 有关，但我不明白为什么它需要这个`crti.o`，它不会使用库文件，例如`libc.a`？

我正在为 arm 平台进行交叉编译。我在工具链中有文件，但是如何让链接器包含它？

`crti.o`位于“库”搜索路径之一，但它应该`.o`在库路径上查找文件吗？

`gcc`和的搜索路径是否相同`ld`？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-18T10:54:09.183

`crti.o`是引导库，一般很小。它通常静态链接到您的二进制文件中。它应该在`/usr/lib`.

如果您正在运行二进制发行版，他们倾向于将所有开发人员的东西放入 -dev 包（例如 libc6-dev）中，因为它不需要运行已编译的程序，只是为了构建它们。

你不会交叉编译吧？

如果您正在交叉编译，通常是 gcc 的搜索路径与您的 crti.o 所在的位置不匹配的问题。它应该是在工具链存在时构建的。首先要检查的是`gcc -print-search-dirs`crti.o 是否在这些路径中。

链接实际上是由 ld 完成的，但它的路径由 gcc 传递给它。找出正在发生的事情的最快方法可能是编译一个 helloworld.c 程序并对其进行 strace 以查看传递给 ld 的内容并查看发生了什么。

```
strace -v -o log -f -e trace=open,fork,execve gcc hello.c -o test 
```

打开日志文件，搜索crti.o，可以看到我的非交叉编译器：

```
10616 execve("/usr/bin/ld", ["/usr/bin/ld", "--eh-frame-hdr", "-m", "elf_x86_64", "--hash-style=both", "-dynamic-linker", "/lib64/ld-linux-x86-64.so.2", "-o"
, "test", "/usr/lib/gcc/x86_64-linux-gnu/4."..., "/usr/lib/gcc/x86_64-linux-gnu/4."..., "/usr/lib/gcc/x86_64-linux-gnu/4."..., "-L/usr/lib/gcc/x86_64-linux-g
nu/"..., "-L/usr/lib/gcc/x86_64-linux-gnu/"..., "-L/usr/lib/gcc/x86_64-linux-gnu/"..., "-L/lib/../lib", "-L/usr/lib/../lib", "-L/usr/lib/gcc/x86_64-linux-gnu
/"..., "/tmp/cc4rFJWD.o", "-lgcc", "--as-needed", "-lgcc_s", "--no-as-needed", "-lc", "-lgcc", "--as-needed", "-lgcc_s", "--no-as-needed", "/usr/lib/gcc/x86_
64-linux-gnu/4."..., "/usr/lib/gcc/x86_64-linux-gnu/4."...],  "COLLECT_GCC=gcc", "COLLECT_GCC_OPTIONS=\'-o\' \'test\' "..., "COMPILER_PATH=/usr/lib/gcc/x86_6"..., "LIBRARY_PATH=/usr/lib/gcc/x86_64"..., "CO
LLECT_NO_DEMANGLE="]) = 0
10616 open("/etc/ld.so.cache", O_RDONLY) = 3
10616 open("/usr/lib/libbfd-2.18.0.20080103.so", O_RDONLY) = 3
10616 open("/lib/libc.so.6", O_RDONLY)  = 3
10616 open("test", O_RDWR|O_CREAT|O_TRUNC, 0666) = 3
10616 open("/usr/lib/gcc/x86_64-linux-gnu/4.2.3/../../../../lib/crt1.o", O_RDONLY) = 4
10616 open("/usr/lib/gcc/x86_64-linux-gnu/4.2.3/../../../../lib/crti.o", O_RDONLY) = 5
10616 open("/usr/lib/gcc/x86_64-linux-gnu/4.2.3/crtbegin.o", O_RDONLY) = 6
10616 open("/tmp/cc4rFJWD.o", O_RDONLY) = 7 
```

如果你看到一堆尝试`open(...crti.o) = -1 ENOENT`，`ld`就会感到困惑，你想看看它打开的路径来自哪里......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-05-08T06:52:14.940

我在交叉编译时遇到了同样的问题。crti.o 在**<sysroot>/usr/lib64**但链接器找不到它。

事实证明，创建一个空目录**<sysroot>/usr/lib**解决了这个问题。似乎链接器会首先搜索路径**<sysroot>/usr/lib**，并且只有当它存在时才会考虑**<sysroot>/usr/lib64**。

这是链接器中的错误吗？或者这种行为是否记录在某处？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-10-19T11:19:59.067

就我而言`Linux Mint 18.0/Ubuntu 16.04`，我根本没有`crti.o`：

```
$ find /usr/ -name crti* 
```

我什么也没找到，所以我安装了开发人员包：

```
sudo apt-get install libc6-dev 
```

如果你发现一些库[在这里阅读](https://stackoverflow.com/a/16605434/4632019)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T14:41:26.843

好的，我必须重新安装工具链，以便包含丢失的文件。这似乎很奇怪，因为它应该在 gcc 路径上找到它。我猜的主要问题是我的计算机上有 15 个左右不同的 crti.o 文件，并且没有指向正确的文件。从那以后仍然没有，但它现在可以工作了:-)感谢您的帮助:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-20T14:39:45.133

我有一个错误设置的交叉编译器的类似问题。我像这样绕过它：

```
/home/rob/compiler/usr/bin/arm-linux-gcc --sysroot=/home/rob/compiler hello.c 
```

这假定 /lib、/usr/include 等存在于 sysroot 选项指向的位置。这可能不是应该做的事情，但是当我需要编译一个简单的 C 文件时，它让我摆脱了麻烦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-09T08:03:37.400

如果要交叉编译，请在 LDFLAGS 中添加 sysroot 选项

```
export LDFLAGS=""--sysroot=${SDKTARGETSYSROOT}" -L${SDKTARGETSYSROOT}/lib -L${SDKTARGETSYSROOT}/usr/lib -L${SDKTARGETSYSROOT}/usr/lib/arm-poky-linux-gnueabi/5.3.0" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T10:54:12.303

我在默认的 Ubuntu 8.04 安装中遇到了同样的问题。我必须手动获取 libc 开发人员头文件/文件才能正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-17T21:37:51.100

这为我解决了（为 ARM 交叉编译 pjsip）：

```
export LDFLAGS='--sysroot=/home/me/<path-to-my-sysroot-parent>/sysroot' 
```

# unit-testing - 您需要从测试工具中获得什么？

> ID：91585
> 
> 赞同：17
> 
> 时间：2008-09-18T10:52:34.663
> 
> 标签：unit-testing, testing, testng, xunit, tap

我是参与[测试任何协议 (TAP) IETF 组](http://testanything.org/wiki/index.php/TAP_at_IETF:_Notes)的人员之一（如果有兴趣，请随时加入邮件列表）。许多编程语言开始采用 TAP 作为他们的主要测试协议，他们希望从中获得比我们目前提供的更多的东西。因此，我们希望从具有 xUnit、TestNG 或任何其他测试框架/方法背景的人那里获得反馈。

基本上，除了简单的通过/失败之外，您还需要测试工具提供哪些信息？只是给你一些例子：

*   文件名和行号（如果适用）
*   开始和结束时间
*   诊断输出，例如你得到的和你期望的之间的差异。

等等 ...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T11:10:01.780

绝对是您列表中每个项目的所有内容：

*   文件名
*   电话号码
*   命名空间/类/函数名
*   测试覆盖率
*   开始时间和结束时间
*   和/或总时间（这对我来说比前两项更有用）
*   诊断输出，例如你得到的和你期望的之间的差异。

从我的头顶上看，除了我想知道的一组测试之外，别无他求

*   团队名字
*   总执行时间

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T22:43:35.717

任意一组标签 - 所以我可以将测试标记为，例如“集成、UI、管理员”。

（你知道我会要求这个，不是吗:-)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T11:05:10.810

编写测试必须非常非常容易，并且运行它们同样容易。对我来说，这是测试工具最重要的一个特性。如果有人必须启动 GUI 或跳过一堆圈来编写测试，他们不会使用它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T11:09:01.800

你说的我要补充：

*   方法/函数/类名
*   覆盖率计数工具，有例外（不计算这些方法）
*   最后 N 次运行的结果可用
*   要求必须存在轻松解析测试结果的方法

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T16:56:34.693

任何类型的诊断输出 -**尤其是**在失败时都是至关重要的。如果测试失败，您不希望总是在调试器下重新运行测试以查看发生了什么 - 输出中应该有一些包含。

我还希望看到关键系统变量（如可用内存或硬盘空间）的前后快照，因为这些也可以提供很好的线索。

最后，如果您在任何测试中使用随机种子，请将种子写入日志文件，以便在必要时可以重现测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-03T21:16:01.193

能够识别单个测试的唯一 ID（uuid、md5sum）——例如，用于在数据库中插入测试结果或在错误跟踪器中识别它们以使 QA 可以重新运行单个测试。

这也可以在产品的多个修订的整个生命周期中跟踪单个测试的行为，从构建到构建。这最终可能允许在“历史”事件（新员工、产品发布、硬件升级）和因此类事件而失败的测试配置文件之间建立更大规模的关联。

我还认为 TAP 应该通过专用的侧通道发出，而不是与标准输出混合。我不确定这是否在协议定义的范围内。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-20T17:09:04.560

我想要连接和嵌套 TAP 流的能力。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-06T15:54:20.310

*   可选的 ascii 彩色输出，绿色表示良好，黄色表示未决，红色表示错误

*   事情悬而未决的想法

*   将运行各个测试的命令的测试报告末尾的摘要，其中

*   项目清单

    *   出问题了

    *   测试中的某些内容未决

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T17:03:31.457

我使用 TAP 作为一组简单的 C++ 测试方法的输出协议，并且看到了以下缺点：

*   测试步骤不能分组（只有分组到几个测试脚本中；但是为了在我们的软件中运行所有测试，我至少需要一个级别的分组，以便单个测试步骤可以通过“数据库连接”来标识" -> "重新连接测试" -> "测试步骤 #3")
*   查看预期输出和实际输出之间的差异很有用；我要么将差异打印到标准错误（作为评论），要么实际启动图形差异工具
*   协议和工具必须真正独立于语言。例如，目前我只知道运行测试的 Perl “证明”工具，它仅限于运行 Perl 脚本

最后，测试输出必须适合作为轻松生成 HTML 报告文件的基础，该报告文件非常简洁地列出了成功的测试，给出了失败测试的详细输出，并且可以快速跳转到 IDE 到失败的测试行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-07T16:31:31.337

TAP 的扩展思路：

```
1..4
ok 1 - yay
not ok 2 - boo
ok 3 - yay #json:{...}
ok 4 - see my json 
```

能够附加 #json 注释... - 可以安全地被现有代码忽略 - 可以在 testanything.org 上轻松保留定义明确的标签 - 易于生成、解析和读取复杂类型 - yaml 很痛苦

# c++ - 最简单的跨平台小部件工具包？

> ID：91616
> 
> 赞同：7
> 
> 时间：2008-09-18T10:58:48.470
> 
> 标签：c++, c, cross-platform, gui-toolkit

什么是最简单的跨平台小部件工具包？我正在寻找一个至少涵盖 Windows、OSX 和 Linux 且具有 C 或 C++ 接口的软件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T11:17:16.273

我不知道我个人使用过 C API，但[wxWidgets](http://www.wxwidgets.org/)是 C++。它可以在 Windows、Linux 和 Mac OS X 上运行。如果您正在寻找简单的方法，[wxPython](http://www.wxpython.org/)是 wxWidgets 的 Python 包装器，它非常易于使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T11:18:57.563

我真的很喜欢Qt。现在已经在几个项目中使用它。

尽管我目前正在开发的项目将仅针对 Windows 发布，但我们的一些开发人员在 Mac OS X 下使用 gcc 编写代码。并且使用不同的编译器和环境对于定位错误和错误是一个额外的好处。

我忘了提到 Qt 有一个非常好的文档，其中包括许多有助于快速入门的实用示例。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T14:25:45.150

我专业地使用了 wxWidgets 和 QT。两者当然都能够实现您的目标。哪个最简单很难说。您没有告诉我们您是在寻找易于使用还是易于学习。Qt 对于大型程序更容易。WxWidgets 更容易学习。这在很大程度上是由于 QT 中的信号/槽机制，对于大型应用程序来说，这是一个很好但不直观的架构。

这两个库实际上都非常好，我也推荐它们用于非跨平台编程。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T11:12:20.700

我们在谈论 GUI 小部件吗？如果是这样，我可以建议3

FLTK：

[http://www.fltk.org/](http://www.fltk.org/)

GTK：

[http://www.gtk.org/](http://www.gtk.org/)

质量保证：

[http://trolltech.com/products/qt/](http://trolltech.com/products/qt/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-18T11:34:22.597

与其他海报一样，我强烈建议您查看 C++ 工具包。GTK 可以在 Windows 和 Mac OS 上运行，但只会在 Linux 上为您提供真正好的结果。甚至一些 GTK 维护者也在发明他们自己[的面向对象的 C 方言](http://live.gnome.org/Vala)，以避免针对原生 GTK API 编写 GUI。

至于 C++，这取决于你想要什么。易于开发？每个平台上的原生 GUI？商业支持？

如果您想要在 Win32 和 Linux 上具有原生外观的 GUI（以及在 Mac 上的一些半合理的东西），一个很好的选择是 wxWidgets。这是一篇[较长的文章，介绍了真实的 wxWidgets 体验](http://www.randomhacks.net/articles/2002/12/10/wxwindows-experiences)。自 2002 年撰写那篇文章以来，Mac 端口已经有了很大的改进，但它仍然有一些软肋。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T11:22:25.777

最容易编写新程序的是您最熟悉的程序。
最容易使用、测试或分发的可能是最跨平台、最多分发或最受支持的，所以 GTK+/wx/Qt/Tk?

请注意，C 本身并不是一种特别*简单*的语言，尤其是在面向对象的 GUI 方法不断发展的情况下。

用脚本语言编写原型然后转换为编译原型的最简单方法可能是任何具有脚本语言绑定的工具包（pyGTK、wxPython 等）

话虽如此，在“大”的那些中，只有 GTK+ 和 Tk 具有 C 绑定。wxWidgets、Qt 和 FLTK 都是用 C++ 编写的，据我所知没有任何 C 绑定。

我建议您研究学习 C++，然后比较可用的选项。用 C++ 编码可能感觉就像用脚本语言编码一样，具有极大的便利性，例如自动指针、实用程序类和重载运算符、非侵入式垃圾收集器和易于继承的父类，所有这些都由语言本身和您的小部件工具包提供给您的指尖。

那么我个人的建议是 wxWidgets；非常易于使用，比 GTKmm 有更好的文档记录，比 Qt 更“自由”。

# c# - 从单元测试中自动生成类？

> ID：91617
> 
> 赞同：19
> 
> 时间：2008-09-18T10:58:56.690
> 
> 标签：c#, unit-testing, code-generation

我正在寻找可以进行单元测试的工具，例如

```
IPerson p = new Person();
p.Name = "Sklivvz";
Assert.AreEqual("Sklivvz", p.Name); 
```

并自动生成相应的存根类和接口

```
interface IPerson         // inferred from IPerson p = new Person();
{
    string Name 
    { 
        get;              // inferred from Assert.AreEqual("Sklivvz", p.Name);
        set;              // inferred from p.Name = "Sklivvz";
    }
}

class Person: IPerson     // inferred from IPerson p = new Person();
{
    private string name;  // inferred from p.Name = "Sklivvz";

    public string Name    // inferred from p.Name = "Sklivvz";
    {
        get
        {
            return name;  // inferred from Assert.AreEqual("Sklivvz", p.Name);
        }
        set
        {
            name = value; // inferred from p.Name = "Sklivvz";
        }
    }

    public Person()       // inferred from IPerson p = new Person();
    {
    }
} 
```

我知道 ReSharper 和 Visual Studio 做了其中的一些，但我需要一个完整的工具——命令行或诸如此类的东西——它可以自动推断需要做什么。如果没有这样的工具，您将如何编写它（例如，从头开始扩展 ReSharper，使用哪些库）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-02T01:39:27.873

您似乎需要的是您的语言 (Java) 的解析器，以及名称和类型解析器。（“符号表构建器”）。

解析源文本后，编译器通常有一个名称解析器，它尝试记录名称及其对应类型的定义，以及一个类型检查器，用于验证每个表达式是否具有有效类型。

通常，名称/类型解析器在找不到定义时会抱怨。您希望它做的是找到导致问题的“未定义”事物，并为其推断类型。

为了

```
 IPerson p = new Person(); 
```

名称解析器知道未定义“Person”和“IPerson”。如果是

```
 Foo  p =  new Bar(); 
```

不知道您想要一个接口，只是 Foo 是 Bar 的某种抽象父级（例如，类或接口）。因此，工具必须知道它的决定（“无论何时找到这样的构造，都假设 Foo 是一个接口......”）。您可以使用启发式方法： IFoo 和 Foo 意味着 IFoo 应该是一个接口，并且有人必须将 Foo 定义为实现该接口的类。一旦该工具做出此决定，它就需要更新其符号表，以便它可以继续执行其他语句：

为了

```
 p.Name = "Sklivvz"; 
```

假设 p 必须是一个接口（根据前面的推论），那么 Name 必须是一个字段成员，并且它的类型似乎是赋值中的 String。

有了这个，声明：

```
 Assert.AreEqual("Sklivvz", p.Name); 
```

名称和类型在没有进一步问题的情况下解析。

IFoo 和 Foo 实体的内容取决于您；您不必使用 get 和 set ，但这是个人喜好。

当您在同一语句中有多个实体时，这不会很好地工作：

```
 x = p.a + p.b ; 
```

我们知道 a 和 b 可能是字段，但是如果它们确实是数字，或者它们是否是字符串，您无法猜测它们是什么数字类型（这对于 Java 中的字符串是合法的，不知道 C# 是什么）。对于 C++，你甚至不知道“+”是什么意思；它可能是 Bar 类的运算符。因此，您要做的是收集*约束*，例如，“a 是一些不定数或字符串”等，并且随着工具收集证据，它会缩小可能的约束集。（这就像那些文字问题：“乔有七个儿子。杰夫比山姆高。哈利不能躲在山姆后面。......谁是杰夫的双胞胎？”你必须收集证据并消除不可能）。您还必须担心最终会出现矛盾的情况。

您可以排除 p.a+pb 的情况，但是您不能不受惩罚地编写单元测试。如果您想要不受惩罚，那里有标准的约束求解器。（什么概念）。

好的，我们有了想法，现在，这可以以实际的方式完成吗？

第一部分需要一个解析器和一个可弯曲的名称和类型解析器。您需要一个约束求解器或至少一个“定义的值流向未定义的值”操作（平凡的约束求解器）。

我们的[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)及其[Java 前端](http://www.semanticdesigns.com/Products/FrontEnds/JavaFrontEnd.html)可能可以做到这一点。DMS 是一个工具构建器的工具，适用于想要构建以任意方式处理计算机语言的工具的人。（想想“用程序片段而不是数字计算”）。

DMS 提供通用解析机制，并且可以为任何给定的前端构建树（例如，Java，并且有一个 C# 前端）。我选择 Java 的原因是我们的 Java 前端具有所有名称和类型解析机制，并且它以源代码形式提供，因此可以弯曲。如果您坚持使用琐碎的约束求解器，您可能会弯曲 Java 名称解析器以找出类型。DMS 将允许您组装与代码片段相对应的树，并将它们合并成更大的树；当您的工具为符号表收集事实时，它可以构建原始树。

在某个地方，你必须决定你已经完成了。该工具在了解整个界面之前必须查看多少个单元测试？（我猜它会吃掉你提供的所有东西？）。完成后，它会为各个成员组装片段并为接口构建 AST；DMS 可以使用它的漂亮打印机将该 AST 转换回源代码，就像您展示的那样。

我在这里推荐 Java，因为我们的 Java 前端有名称和类型解析。我们的 C# 前端没有。这只是野心的“单纯”问题；必须有人写一个，但这是相当多的工作（至少它是用于 Java 的，我无法想象 C# 真的不同）。

但这个想法原则上使用 DMS 可以正常工作。

您可以使用其他一些基础设施来做到这一点，这些基础设施可以让您访问解析器以及可弯曲的名称和类型解析器。对于 C# 来说，这可能并不容易获得；我怀疑 MS 可能会给你一个解析器，并且可以访问名称和类型解析，但没有任何方法可以改变它。也许 Mono 是答案？

您仍然需要一个 was 来生成代码片段并组装它们。您可以尝试通过字符串破解来做到这一点；我将程序位粘合在一起的（长期）经验是，如果你用字符串来做，你最终会把它弄得一团糟。您真的想要代表已知类型的代码片段的片段，这些片段只能以语法允许的方式组合；DMS 做到这一点，因此没有混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T09:47:28.623

令人惊讶的是，没有人真正对您的要求做出任何贡献。

我不知道答案，但我会给出我的想法。

如果我自己尝试写这样的东西，我可能会看到一个 resharper 插件。我这么说的原因是因为正如你所说，resharper 可以做到，但需要单独的步骤。所以我会逐行编写一些东西，并将适当的重新生成器创建方法链接在一起。

现在我什至不知道该怎么做，因为我从来没有为 resharper 构建过任何东西，但这就是我会尝试做的。可以做到这一点是合乎逻辑的。

如果您确实编写了一些代码，请发布它，因为我发现这也很有用，能够一步生成整个骨架。很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T11:13:12.850

如果您打算编写自己的实现，我绝对建议您查看[NVelocity](http://www.castleproject.org/others/nvelocity/index.html) (C#) 或[Velocity](http://velocity.apache.org/engine/index.html) (Java) 模板引擎。

我以前在代码生成器中使用过这些，发现它们使工作变得容易得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T14:35:23.450

这是可行的——至少在理论上是这样。我要做的是使用类似[csparser](http://www.codeplex.com/csparser)的东西来解析单元测试（不幸的是，你无法编译它）然后从那里获取它。我能看到的唯一问题是，就方法论而言，您所做的事情是错误的——从实体类生成单元测试（实际上，Visual Studio 正是这样做的）比反过来做更有意义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-08T17:39:16.223

我认为这个问题的真正解决方案将是一个非常专业的解析器。由于这并不容易做到，我有一个更便宜的想法。不幸的是，您必须更改编写测试的方式（即，仅创建对象）：

```
dynamic p = someFactory.Create("MyNamespace.Person");
p.Name = "Sklivvz";
Assert.AreEqual("Sklivvz", p.Name); 
```

将使用工厂对象。如果它可以找到命名对象，它将创建并返回它（这是正常的测试执行）。如果它没有找到它，它将创建一个记录代理（a [`DynamicObject`](http://msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject.aspx)），它将记录所有调用，并在最后（可能在拆除时）可以发出反映它“看到”的类文件（可能基于某些模板）被调用。

我看到的一些缺点：

*   Need to run the code in "two" modes, which is annoying.
*   In order for the proxy to "see" and record calls, they must be executed; so code in a `catch` block, for example, has to run.
*   You have to change the way you create your object under test.
*   You have to use `dynamic`; you'll lose compile-time safety in subsequent runs and it has a performance hit.

The only advantage that I see is that it's *a lot cheaper* to create than a specialized parser.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-20T10:06:09.037

我喜欢 DevExpress 的 CodeRush。他们有一个巨大的可定制的模板引擎。对我来说最好的是没有对话框。它们还具有从不存在的接口创建方法和接口以及类的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-22T14:47:48.797

尝试查看 Pex ，一个关于单元测试的微软项目，它仍在研究中

research.microsoft.com/en-us/projects/Pex/

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-08T09:03:15.330

我认为您正在寻找的是一个模糊测试工具包（https://en.wikipedia.org/wiki/Fuzz_testing）。

我从来没有使用过，你可以给 Randoop.NET 一个生成“单元测试”的机会[http://randoop.codeplex.com/](http://randoop.codeplex.com/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T14:57:14.170

Visual Studio 附带了一些对您有帮助的功能：

**生成方法存根**。当您编写对不存在的方法的调用时，您会在方法名称上获得一个小智能标记，您可以使用它来根据您传递的参数生成方法存根。

如果您是键盘手（我是），那么在输入右括号后，您可以执行以下操作：

*   **Ctrl-。** （打开智能标签）
*   **ENTER** （生成存根）
*   **F12** （去定义，带你去新方法）

仅当 IDE 认为没有匹配的方法时，才会出现智能标记。如果要在智能标签未启动时生成，可以转到**Edit->Intellisense->Generate Method Stub**。

**片段**。小型代码模板，可以轻松生成一些通用代码。有些很简单（试试“if[TAB][TAB]”）。有些很复杂（'switch' 将为枚举生成案例）。你也可以自己写。对于您的情况，请尝试“class”和“prop”。

另请参阅“[如何更改“生成方法存根”以在 VS 中抛出 NotImplementedException？](https://stackoverflow.com/questions/46003/how-to-change-generate-method-stub-to-throw-notimplementedexception-in-vs) ”以获取 GMS 上下文中的信息片段。

**自动道具**。请记住，属性可以简单得多：

```
public string Name { get; set; } 
```

**创建类**。在解决方案资源管理器中，单击项目名称或子文件夹，选择**Add->Class**。输入新班级的名称。点击**ENTER**。您将在正确的命名空间中获得类声明等。

**实现接口**。当您希望类实现接口时，编写接口名称部分，激活智能标记，然后选择任一选项为接口成员生成存根。

这些并不是您正在寻找的 100% 自动化解决方案，但我认为这是一个很好的缓解措施。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-09-18T11:09:49.253

我发现每当我需要这样的代码生成工具时，我可能正在编写可以变得更通用的代码，所以我只需要编写一次。在您的示例中，这些 getter 和 setter 似乎没有为代码添加任何价值 - 事实上，它实际上只是断言 C# 中的 getter/setter 机制有效。

在了解编写此类测试的动机是什么之前，我会避免编写（甚至使用）这样的工具。

顺便说一句，您可能想看看[NBehave](http://code.google.com/p/nbehave/)？

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-09-18T11:15:23.250

当我只需要一个简单的存根时，我会使用 Rhino Mocks。

[http://www.ayende.com/wiki/Rhino+Mocks+-+Stubs.ashx](http://www.ayende.com/wiki/Rhino+Mocks+-+Stubs.ashx)

# php - 动态语言中的接口有什么意义吗？

> ID：91618
> 
> 赞同：26
> 
> 时间：2008-09-18T10:59:41.353
> 
> 标签：php, interface, dynamic-languages, duck-typing

在像 Java 这样的静态语言中，您需要接口，因为否则类型系统不会让您做某些事情。但在 PHP 和 Python 等动态语言中，您只需利用*鸭子类型*。

PHP 支持接口。Ruby 和 Python 没有它们。因此，没有它们，您显然可以幸福地生活。

我大部分时间都在使用 PHP 进行工作，但从未真正使用过定义接口的能力。当我需要一组类来实现某个通用接口时，我只是在文档中描述它。

所以你怎么看？完全不使用动态语言的接口不是更好吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T11:16:30.410

我认为它更多地是一种便利。如果你有一个函数接受一个“类文件”对象并且只调用它的 read() 方法，那么强制用户实现某种 File 接口是不方便的——甚至是限制性的。检查对象是否具有读取方法同样容易。

但是，如果您的函数需要大量方法，则检查对象是否支持接口然后检查每个单独方法的支持会更容易。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T11:10:52.530

是的，有一点

如果您没有明确使用接口，您的代码仍然使用该对象，就好像它实现了某些方法一样，只是不清楚未说出的接口是什么。

如果你定义一个函数来接受一个接口（在 PHP 中说），那么它会更早地失败，问题将出在调用者而不是方法的工作上。一般来说，早期失败是一个很好的经验法则。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T13:15:11.870

接口实际上为拥有它们的静态语言（如 Java）增加了某种程度的动态类语言灵活性。它们提供了一种查询对象*在运行时*实现了哪些合约的方法。

这个概念很好地移植到动态语言中。当然，这取决于您对“动态”一词的定义，甚至包括 Objective-C，它在 Cocoa 中非常广泛地使用了协议。

在 Ruby 中，您可以询问对象是否响应给定的方法名称。但这是一个非常薄弱的​​保证，它会做你想做的事，特别是考虑到反复使用的单词很少，不考虑完整的方法签名等等。

在 Ruby 中，我可能会问

```
object.respond_to? :sync 
```

所以，是的，它有一个名为“sync”的方法，不管这意味着什么。

在 Objective-C 中，我可能会问类似的问题，即“这看起来/行走/嘎嘎像同步的东西吗？”：

```
[myObject respondsToSelector:@selector(sync)] 
```

更好的是，以一些冗长为代价，我可以问一些更具体的问题，即“这看起来/走路/嘎嘎像与 MobileMe 同步的东西吗？”：

```
[myObject respondsToSelector:@selector(sync:withMobileMeAccount:)] 
```

那是鸭子打字到物种水平。

但要真正问一个对象是否有希望实现与 MobileMe 的同步......

```
[receiver conformsToProtocol:@protocol(MobileMeSynchronization)] 
```

当然，您可以通过检查是否存在一系列您认为是协议/鸭子定义的选择器以及它们是否足够具体来实现协议。什么时候协议只是一大堆丑陋的response_to的缩写？查询，以及一些非常有用的语法糖供编译器/IDE 使用。

接口/协议是对象元数据的另一个维度，可用于在处理这些对象时实现动态行为。在 Java 中，编译器恰好要求对正常的方法调用进行这种处理。但即使是 Ruby、Python、Perl 等动态语言也实现了一种类型概念，而不仅仅是“对象响应什么方法”。因此类关键字。Javascript 是唯一没有这个概念的真正常用的语言。如果你有类，那么接口也是有意义的。

诚然，它对于更复杂的库或类层次结构比在大多数应用程序代码中更有用，但我认为这个概念在任何语言中都很有用。

另外，其他人提到了mixins。Ruby mixin 是一种共享代码的方式——例如，它们与类的实现有关。接口/协议是关于类或对象的接口。它们实际上可以相互补充。您可能有一个指定行为的接口，以及一个或多个帮助对象*实现*该行为的 mixin。

当然，我想不出有哪一种语言真正兼具两种不同的一流语言特征。在使用 mixin 的那些中，包括 mixin 通常意味着它实现的接口。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T11:46:57.043

如果您没有高安全性约束（因此没有人会以您不希望的方式访问您的数据）并且您拥有良好的文档或训练有素的编码人员（因此他们不需要解释器/编译器来告诉他们要做什么做），那么不，它没用。

对于大多数中型项目，鸭式打字就是您所需要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T11:14:05.267

我的印象是[Python 没有接口](http://www.python.org/dev/peps/pep-0245/)。据我所知，在 Python 中，您不能强制执行在编译时实现的方法，因为它是一种动态语言。

有 Python 的接口库，但我一个都没用过。

Python 也有 Mixins，所以你可以通过为每个方法实现定义一个 Mixin 来创建一个 Interface 类，`pass`但这并没有真正给你带来太多价值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T11:39:10.120

我认为接口的使用更多地取决于有多少人将使用你的库。如果只是你，或者一个小团队，那么文档和约定会很好，并且需要接口将是一个障碍。如果它是一个公共库，那么接口会更有用，因为它们约束人们提供正确的方法，而不仅仅是提示。所以接口对于编写公共库来说绝对是一个有价值的特性，我认为缺乏（或至少不强调）是动态语言更多地用于应用程序而强类型语言用于大型库的众多原因之一。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T15:09:14.577

在像 PHP 这样的语言中，不存在的方法调用会导致致命错误并导致整个应用程序崩溃，那么是的接口是有意义的。

在 Python 这样的语言中，您可以捕获和处理无效的方法调用，但事实并非如此。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T16:11:03.727

Python 3000 将具有[Abstract Base Classes](http://www.python.org/dev/peps/pep-3119/ "PEP 3119：抽象基类")。非常值得一读。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T11:27:24.830

Rene，请在 StackOverflow 上[阅读我](https://stackoverflow.com/questions/61324/best-practices-for-architecting-large-systems-in-a-dynamic-language#61340)对“用动态语言构建大型系统的最佳实践”问题的回答。我讨论了放弃动态语言的自由以节省开发工作并简化将新程序员引入项目的一些好处。如果使用得当，接口将极大地有助于编写可靠的软件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T12:41:54.790

Java“接口”的一种用途是允许Java中的强类型混合。您混合了适当的超类，以及为支持接口而实现的任何其他方法。

Python 具有多重继承，因此它实际上并不需要接口设计来允许来自多个超类的方法。

然而，我喜欢强类型的一些好处——主要是，我喜欢早期错误检测。我尝试使用“类似接口”的抽象超类定义。

```
class InterfaceLikeThing( object ):
    def __init__( self, arg ):
        self.attr= None
        self.otherAttr= arg
    def aMethod( self ):
        raise NotImplementedError
    def anotherMethod( self ):
        return NotImplemented 
```

这形式化了接口——在某种程度上。它没有为符合预期的子类提供绝对证据。但是，如果子类未能实现所需的方法，我的单元测试将失败并出现明显的`NotImplemented`返回值或`NotImplementedError`异常。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T12:30:25.220

如果您觉得必须这样做，您可以实现一种带有函数的接口，该函数将对象的方法/属性与给定的签名进行比较。这是一个非常基本的示例：

```
file_interface = ('read', 'readline', 'seek')

class InterfaceException(Exception): pass

def implements_interface(obj, interface):
    d = dir(obj)
    for item in interface:
        if item not in d: raise InterfaceException("%s not implemented." % item)
    return True

>>> import StringIO
>>> s = StringIO.StringIO()
>>> implements_interface(s, file_interface)
True
>>> 
>>> fp = open('/tmp/123456.temp', 'a')    
>>> implements_interface(fp, file_interface)
True
>>> fp.close()
>>> 
>>> d = {}
>>> implements_interface(d, file_interface)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 4, in implements_interface
__main__.InterfaceException: read not implemented. 
```

当然，这并不能保证太多。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T11:04:13.247

好吧，首先，Ruby 没有接口是正确的，但是它们有 mixin，它以某种方式从其他语言中汲取了接口和抽象类的精华。

接口的主要目标是确保您的对象应实现接口本身中存在的所有方法。

当然，接口从来都不是强制性的，即使在 Java 中，您也可以想象只使用类并在您不知道要操作哪种对象时使用反射来调用方法，但它很容易出错，应该在很多种方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T11:15:53.763

好吧，检查给定对象是否支持整个接口肯定会更容易，而不是在调用初始方法中使用的一两个方法时*不会崩溃*，例如将对象添加到内部列表。

鸭打字有一些接口的好处，就是到处都好用，但是检测机制还是缺失的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T11:37:14.710

这就像说您不需要动态类型语言中的显式类型。为什么不将所有内容都设为“var”并在其他地方记录它们的类型？

这是程序员强加给程序员的限制。这让你更难射中自己的脚；给你更少的错误空间。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T13:36:52.910

作为一名 PHP 程序员，在我看来，接口基本上是用作合同。它让你说使用这个接口的所有东西都必须实现一组给定的函数。

我不知道这是否有用，但当我试图理解接口的全部内容时，我发现它有点绊脚石。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-12-06T00:49:32.263

除了其他答案之外，我只想指出 Javascript 有一个 instanceof 关键字，如果给定实例位于给定对象的原型链中的任何位置，它将返回 true。

这意味着，如果您将原型链中的“接口对象”用于“实现对象”（两者都只是 JS 的普通对象），那么您可以使用 instanceof 来确定它是否“实现”它。这对执行方面没有帮助，但在多态方面确实有帮助——这是接口的一种常见用途。

[MDN 实例参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/instanceof)

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2009-03-27T08:34:10.030

停止尝试用动态语言编写 Java。

# jboss - JBoss 4.23 和 EJB 2 支持

> ID：91627
> 
> 赞同：0
> 
> 时间：2008-09-18T11:01:35.313
> 
> 标签：jboss

有谁知道为 Java 6 编译的 JBoss 4.2.3 版本是否仍然支持 EJB 2？我遇到的问题是它无法将类强制转换为以前从未遇到过此问题且代码没有更改的某个接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T11:35:02.597

EJB2 风格的 bean 应该在 4.2 版本中仍然可以工作。你想投射到什么接口？也许那个特定的界面被重命名或移动了。您应该尽量不要使用特定于容器的类。

# sql-server - MS SQL Server 2005 - 如何自动增加字段（不是主键）

> ID：91628
> 
> 赞同：1
> 
> 时间：2008-09-18T11:01:53.017
> 
> 标签：sql-server

我想在名为“tb_users”的表中任何行中的任何字段被更新时自动增加一个名为“incrementID”的字段。目前我正在通过 sql update 语句进行操作。即“更新 tb_users SET name = @name, incrementID = incrementID + 1 .....WHERE id = @id;

我想知道如何自动执行此操作。例如，通过更改 sql server 处理字段的方式 - 有点像“身份”的增量设置。在更新一行之前，我希望检查要更新的对象的 incrementID 是否与 db 的行的 incrementID 不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T11:13:41.773

表中的列可以具有**标识规范**集。只需在属性窗口中展开节点并填写详细信息（Is Identity、Increment、Seed）。

**IDENTITYCOL**关键字可用于身份规范上的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T11:13:35.313

您可以为此使用触发器（如果我没看错，并且您希望每次更新行时值都增加）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:17:37.310

如果您只需要知道它发生了变化，而不是具体地知道这是一个更高版本或发生了多少变化，请考虑使用`rowversion`列。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T13:25:47.447

这个触发器应该可以解决问题：

```
create trigger update_increment for update as
if not update(incrementID) 
  UPDATE tb_users SET incrementID = incrementID + 1 
    from inserted WHERE tb_users.id = inserted.id 
```

# javascript - JavaScript RegEx 元素匹配

> ID：91629
> 
> 赞同：1
> 
> 时间：2008-09-18T11:02:58.913
> 
> 标签：javascript, regex

我正在尝试`'container1$container2$chkChecked'`使用 的正则表达式来匹配名称`'.+\$chkChecked'`为 的元素，但是当元素名称与描述的一样时，我没有得到我期望的匹配项。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T11:06:48.780

尝试

```
string.match( /[$]chkChecked$/ ) 
```

或者，您可以尝试

```
string.match( /[^a-zA-Z0-9]chkChecked/ ) 
```

（另外，请确保您`//`在您的正则表达式周围使用，否则您可能会使用字符串文字进行匹配。如果没有更大的代码片段，这并不明显）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T11:20:14.393

我的猜测，通过您使用引号，您是否做了类似的事情

```
re = new RegExp('.+\$chkChecked'); 
```

这不起作用，因为 js 在其字符串解释中利用 \ 作为转义，因此它永远不会进入正则表达式解释器

相反，你想要

```
re = new RegExp('.+\\$chkChecked'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T11:43:45.833

有两个级别的转义：一个是当您的代码第一次被解析时（例如，如果您想`'`在字符串中包含一个），另一个是在正则表达式引擎中。因此，您需要在 regexp 引擎`\s`之前添加两个，`$`以使 regexp 引擎不将其视为特殊字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:06:59.230

看起来它应该工作。

有一个很好的[Javascript Regex Tester](http://www.regular-expressions.info/javascriptexample.html)也说它匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T11:36:20.563

> > 史蒂文·诺布尔：
> 
> 这不起作用，因为 js 在其字符串解释中利用 \ 作为转义，因此它永远不会进入正则表达式解释器

我打算使用 \ 作为转义，因为我真的在元素名称中寻找 $ 。

# c# - PostSharp - il weaving - 想法

> ID：91635
> 
> 赞同：10
> 
> 时间：2008-09-18T11:05:05.240
> 
> 标签：c#, visual-studio, logging, aop, postsharp

我正在考虑使用 Postsharp 框架来减轻应用程序方法日志记录的负担。它基本上允许我用日志属性装饰方法，并在编译时将所需的日志代码注入到 il.xml 中。我喜欢这个解决方案，因为它可以将噪音排除在设计时间码环境之外。有什么想法、经验或更好的选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T11:08:49.163

我使用 Castle Windsor DynamicProxies 应用 AOP 日志记录。我已经将 Castle 用于它的 IoC 容器，因此将它用于 AOP 对我来说是阻力最小的路径。如果您想了解更多信息，请告诉我，我正在整理代码以将其作为博客文章发布

编辑

好的，这是基本的拦截器代码，基本失败，但它可以满足我的一切需求。有两个拦截器，一个记录所有内容，另一个允许您定义方法名称以允许更细粒度的日志记录。此解决方案失败依赖于温莎城堡

**抽象基类**

```
namespace Tools.CastleWindsor.Interceptors
{
using System;
using System.Text;
using Castle.Core.Interceptor;
using Castle.Core.Logging;

public abstract class AbstractLoggingInterceptor : IInterceptor
{
    protected readonly ILoggerFactory logFactory;

    protected AbstractLoggingInterceptor(ILoggerFactory logFactory)
    {
        this.logFactory = logFactory;
    }

    public virtual void Intercept(IInvocation invocation)
    {
        ILogger logger = logFactory.Create(invocation.TargetType);

        try
        {
            StringBuilder sb = null;

            if (logger.IsDebugEnabled)
            {
                sb = new StringBuilder(invocation.TargetType.FullName).AppendFormat(".{0}(", invocation.Method);

                for (int i = 0; i < invocation.Arguments.Length; i++)
                {
                    if (i > 0)
                        sb.Append(", ");

                    sb.Append(invocation.Arguments[i]);
                }

                sb.Append(")");

                logger.Debug(sb.ToString());
            }

            invocation.Proceed();

            if (logger.IsDebugEnabled && invocation.ReturnValue != null)
            {
                logger.Debug("Result of " + sb + " is: " + invocation.ReturnValue);
            }
        }
        catch (Exception e)
        {
            logger.Error(string.Empty, e);
            throw;
        }
    }
}
} 
```

**完整的日志实现**

```
namespace Tools.CastleWindsor.Interceptors
{
using Castle.Core.Logging;

public class LoggingInterceptor : AbstractLoggingInterceptor
{
    public LoggingInterceptor(ILoggerFactory logFactory) : base(logFactory)
    {
    }
}
} 
```

**方法记录**

```
namespace Tools.CastleWindsor.Interceptors
{
using Castle.Core.Interceptor;
using Castle.Core.Logging;
using System.Linq;

public class MethodLoggingInterceptor : AbstractLoggingInterceptor
{
    private readonly string[] methodNames;

    public MethodLoggingInterceptor(string[] methodNames, ILoggerFactory logFactory) : base(logFactory)
    {
        this.methodNames = methodNames;
    }

    public override void Intercept(IInvocation invocation)
    {
        if ( methodNames.Contains(invocation.Method.Name) )
            base.Intercept(invocation);
    }
}
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T20:09:38.343

+1 后锐化。一直在使用几件事（包括一些尝试向 C# 代码添加前置条件和后置条件）并且不知道没有它我将如何做到......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T20:25:07.917

这在一定程度上取决于您将开发和支持该项目多长时间。当然，IL 编织是一项不错的技术，但是如果 IL 和/或程序集元数据格式再次发生变化（就像在 1.1 和 2.0 之间所做的那样）并且这些变化使工具与新格式不兼容，会发生什么情况。

如果您依赖该工具，那么它会阻止您升级您的技术，直到该工具支持它。如果对此没有任何保证（或者甚至这种开发将继续，尽管看起来确实有可能），那么我会对在长期项目中使用它非常谨慎。

短期，不过没问题。

# python - NI CVI 与 Python

> ID：91666
> 
> 赞同：2
> 
> 时间：2008-09-18T11:09:50.177
> 
> 标签：python, labview, labwindows, cvi

我想将 Python IDLE-esque 命令提示界面集成到现有的 NI-CVI (LabWindows) 应用程序中。我尝试关注 Python.org 的讨论，但似乎迷失在细节中。有没有像我这样的傻瓜的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T11:22:06.027

这是一个[调用 CVI 的 python 示例代码](http://decibel.ni.com/content/docs/DOC-1494)。

还有[DaqMx python 绑定](http://www.scipy.org/Cookbook/Data_Acquisition_with_PyUL)。

# sql - 将用户添加到数据库中的多个组的最佳方法是什么？

> ID：91672
> 
> 赞同：3
> 
> 时间：2008-09-18T11:10:40.050
> 
> 标签：sql, database

在用户可以属于多个组的应用程序中，我目前将他们的组存储在称为`groups`二进制的列中。每四个字节是一个 32 位整数，即`GroupID`. 但是，这意味着要枚举组中的所有用户，我必须以编程方式选择所有用户，并手动确定他们是否包含该组。

另一种方法是使用 unicode 字符串，其中每个字符都是表示组的整数，这使搜索变得容易，但有点做作。

另一种方法是创建一个单独的表，将用户链接到组。一列称为`UserID`，另一列称为`GroupID`。

以下哪种方式最好？或者，还有更好的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T11:16:36.133

您在用户和组之间具有多对多的关系。这需要一个单独的表来将用户与组结合起来：

```
User: (UserId[PrimaryKey], UserName etc.)
Group: (GroupId[PrimaryKey], GroupName etc.)
UserInGroup: (UserId[ForeignKey], GroupId[ForeignKey]) 
```

要查找给定组中的所有用户，您只需说：

```
select * from User join UserInGroup on UserId Where GroupId=<the GroupId you want> 
```

经验法则：如果您觉得需要在同一个字段中编码多个值，您可能需要一个单独表的外键。您使用字节块或 Unicode 字符的技巧只是在一个字段中编码多个值的巧妙技巧。数据库设计不应该使用聪明的技巧 - 将其保存为应用程序代码;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T11:16:28.223

我肯定会选择单独的表——当然是最好的数据关系视图。如果您在 UserID 和 GroupID 上都有索引，那么您可以快速获取每个组的用户和每个用户的组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T11:14:03.770

更标准、更实用、更易理解的方式是连接表。除了在大多数情况下具有合理的性能外，它还很容易得到许多 ORM 的支持。只有在你有理由的情况下才以“聪明”的方式输入，比如一百万用户并且必须每半秒回答一次这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:22:32.000

我会做3张桌子。用户、组和用户组，用作交叉引用表以链接用户和组。在 usersgroups 表中，我将添加 userId 和 groupId 列并将它们作为主键。顺便提一句。命名这些外部参照表有哪些命名约定？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T12:30:31.137

这取决于您要做什么，但如果您的数据库支持它，您可能会考虑使用角色。这样做的好处是数据库提供了围绕角色的安全性，您不必创建任何表。

# java - 如何在 java.net.URLConnection 上指定本地地址？

> ID：91678
> 
> 赞同：11
> 
> 时间：2008-09-18T11:12:16.737
> 
> 标签：java, tomcat, ip, urlconnection

我的 Tomcat 实例正在侦听多个 IP 地址，但我想控制在打开`URLConnection`.

我该如何指定？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T12:34:34.013

这应该可以解决问题：

```
URL url = new URL(yourUrlHere);
Proxy proxy = new Proxy(Proxy.Type.DIRECT, 
    new InetSocketAddress( 
        InetAddress.getByAddress(
            new byte[]{your, ip, interface, here}), yourTcpPortHere));
URLConnection conn = url.openConnection(proxy); 
```

你完成了。不要忘记很好地处理异常，并且可以根据您的情况更改值。

啊，我省略了导入语句

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:45:51.293

使用 Apache commons HttpClient 我还发现以下工作（为了清楚起见删除了 try/catch）：

```
HostConfiguration hostConfiguration = new HostConfiguration();
byte b[] = new byte[4];
b[0] = new Integer(192).byteValue();
b[1] = new Integer(168).byteValue();
b[2] = new Integer(1).byteValue();
b[3] = new Integer(11).byteValue();

hostConfiguration.setLocalAddress(InetAddress.getByAddress(b));

HttpClient client = new HttpClient();
client.setHostConfiguration(hostConfiguration);
GetMethod method = new GetMethod("http://remoteserver/");
method.getParams().setParameter(HttpMethodParams.RETRY_HANDLER,
    new DefaultHttpMethodRetryHandler(3, false));
int statusCode = client.executeMethod(method);

if (statusCode != HttpStatus.SC_OK) {
    System.err.println("Method failed: " + method.getStatusLine());
}

byte[] responseBody = method.getResponseBody();
System.out.println(new String(responseBody));"); 
```

但是，我仍然想知道如果 IP 的网关关闭（本例中为 192.168.1.11）会发生什么情况。下一个网关会被尝试还是会失败？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T12:19:35.950

显而易见的可移植方式是在 URL.openConnection 中设置代理。代理可以在本地主机中，然后您可以编写一个非常简单的代理来绑定客户端套接字的本地地址。

如果不能修改URL连接的源，可以在调用URL构造函数时替换URLStreamHandler，也可以通过URL.setURLStreamHandlerFactory全局替换。然后 URLStreamHandler 可以委托给默认的 http/https 处理程序，修改 openConnection 调用。

一个更极端的方法是完全替换处理程序（也许扩展 JRE 中的实现）。或者，可以使用替代（开源）http 客户端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T15:09:56.373

手动设置套接字工作正常...

```
private HttpsURLConnection openConnection(URL src, URL dest, SSLContext sslContext)
        throws IOException, ProtocolException {
    HttpsURLConnection connection = (HttpsURLConnection) dest.openConnection();
    HttpsHostNameVerifier httpsHostNameVerifier = new HttpsHostNameVerifier();
    connection.setHostnameVerifier(httpsHostNameVerifier);
    connection.setConnectTimeout(CONNECT_TIMEOUT);
    connection.setReadTimeout(READ_TIMEOUT);
    connection.setRequestMethod(POST_METHOD);
    connection.setRequestProperty(CONTENT_TYPE, SoapConstants.CONTENT_TYPE_HEADER);
    connection.setDoOutput(true);
    connection.setDoInput(true);
    connection.setSSLSocketFactory(sslContext.getSocketFactory());
    if ( src!=null ) {
        InetAddress inetAddress = InetAddress.getByName(src.getHost());
        int destPort = dest.getPort();
        if ( destPort <=0 ) 
            destPort=SERVER_HTTPS_PORT;
        int srcPort = src.getPort();
        if ( srcPort <=0 ) 
            srcPort=CLIENT_HTTPS_PORT;
         connectionSocket = connection.getSSLSocketFactory().createSocket(dest.getHost(), destPort, inetAddress, srcPort);
    }
    connection.connect();
    return connection;
} 
```

# c++ - 您如何在大型 C++ 项目中实现单元测试？

> ID：91683
> 
> 赞同：42
> 
> 时间：2008-09-18T11:13:14.817
> 
> 标签：c++, unit-testing, coding-style

我坚信使用单元测试作为构建大型多平台应用程序的一部分。我们目前正计划在一个单独的项目中进行单元测试。这有利于保持我们的代码库干净。但是，我认为这会将测试代码与单元的实现分开。您如何看待这种方法，是否有任何工具，如用于 c++ 应用程序的 JUnit？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-18T11:57:34.100

C++ 有许多测试单元框架。CppUnit 肯定不是我会选择的（至少在其稳定版本 1.x 中，因为它缺乏许多测试，并且需要大量冗余代码行）。到目前为止，我首选的框架是[CxxTest](http://cxxtest.sf.net/)，我计划有一天评估[Fructose 。](http://fructose.sourceforge.net/)

无论如何，有一些评估 C++ TU 框架的“论文”：

*   [*探索 C++ 单元测试框架 Jungle*](http://gamesfromwithin.com/exploring-the-c-unit-testing-framework-jungle)，作者 Noel Llopis
*   [Overload Journal #78 中的一篇文章](http://accu.org/index.php/journals/c211/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-18T11:15:50.893

这是一个合理的做法。

我使用[UnitTest++](http://unittest-cpp.sourceforge.net/)和[Boost.Test都取得了非常好的结果](http://www.boost.org/doc/libs/1_36_0/libs/test/doc/html/index.html)

我看过 CppUnit，但对我来说，它更像是对 JUnit 东西的翻译，而不是针对 C++ 的东西。

**更新：**这些天我更喜欢使用[Catch](https://github.com/philsquared/Catch)。我发现它有效且易于使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-25T15:50:48.803

您应该将基本代码分离到一个共享（动态）库中，然后为该库编写单元测试的主要部分。

两年前（2008 年）我参与了由 Linux 基金会部署的大型 LSB 基础设施项目。该项目的目标之一是为 Linux 核心库中的 40.000 个函数编写单元测试。在这个项目的上下文中，我们创建了[AZOV 技术](http://ispras.linuxfoundation.org/index.php/AZOV_Framework)和名为[API Sanity Autotest](http://lvc.github.io/api-sanity-checker/)的基本工具，以便自动生成所有测试。您可以尝试使用此工具为您的基础库生成单元测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T11:41:26.167

我认为您在单元测试方面走在正确的道路上，这是提高产品可靠性的好计划。

尽管在将您的应用程序转换为不同的平台甚至不同的操作系统时，单元测试并不能解决您的所有问题。这样做的原因是，通过单元测试来发现应用程序中的错误。它只是简单地将尽可能多的输入输入到您的系统中，然后在另一端等待结果。这就像让猴子不断敲击键盘并观察结果（Beta 测试人员）。

要进入下一步，通过良好的单元测试，您需要专注于应用程序的内部设计。我发现最好的方法是使用一种称为“合同编程”或“合同设计”的设计模式或设计过程。另一本书对在您的核心设计中建立可靠性非常有帮助。

调试开发过程：保持专注、按时发货和建立稳固团队的实用策略。

在我们的开发团队中，我们非常仔细地研究了我们认为是程序员错误、开发人员错误、设计错误以及我们如何使用单元测试以及如何通过 DBC 在我们的软件包中构建可靠性并遵循调试开发的建议过程。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T12:08:37.443

我使用 UnitTest++。测试在一个单独的项目中，但实际测试与实际代码交织在一起。它们存在于被测部分下的文件夹中。即：
MyProject\src\ <- 实际应用程序的源
MyProject\src\tests <- 测试的源
如果您有嵌套文件夹（并且没有），那么它们也将拥有自己的 \tests 子目录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T11:19:48.513

Cppunit 是用于 C++ 应用程序的 Junit 的直接等价物 [http://cppunit.sourceforge.net/cppunit-wiki](http://cppunit.sourceforge.net/cppunit-wiki)

就个人而言，我在不同的项目中创建了单元测试，并创建了一个单独的构建配置来构建所有单元测试和相关的源代码。在某些情况下，我想测试一个类的私有成员函数，因此我将 Test 类作为要测试的对象的友元类，但在通过预处理器声明构建“非测试”配置时隐藏了友元声明。

然而，当我将测试集成到遗留代码中时，我最终完成了这些编码体操。如果您从单元测试的目的开始，更好的设计可能很简单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T11:36:55.133

您可以在该库的子目录中为源代码树中的每个库创建一个单元测试项目。您最终会为每个库提供一个测试驱动程序应用程序，这样可以更轻松地运行一套测试。通过将它们放在子目录中，它可以使您的代码库保持干净，但也可以使测试接近代码。

可以轻松编写脚本来运行源代码树中的所有测试套件并收集结果。

多年来，我一直在使用原始 CppUnit 的定制版本并取得了巨大成功，但现在还有其他替代方案。 [GoogleTest](http://code.google.com/p/googletest/)看起来很有趣。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T11:48:28.180

[CxxTest](http://cxxtest.tigris.org/)也是值得一看的轻量级、易于使用的跨平台 JUnit/CppUnit/xUnit 类 C++ 框架。我们发现添加和开发测试非常简单

[Aeryn](http://aeryn.tigris.org/)是另一个值得一看的 C++ 测试框架

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T12:48:04.120

使用 tut [http://tut-framework.sourceforge.net/](http://tut-framework.sourceforge.net/) 很简单，只是头文件而已，没有宏。可以生成 XML 结果

# sql-server - 聚集索引和非聚集索引有什么区别？

> ID：91688
> 
> 赞同：302
> 
> 时间：2008-09-18T11:14:23.283
> 
> 标签：sql-server, indexing, clustered-index, non-clustered-index

`clustered`a和 a 有什么区别`non-clustered index`？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2008-09-18T11:20:23.067

聚集索引

*   每桌只有一个
*   由于数据以索引顺序物理存储，因此读取速度比非集群更快

非聚集索引

*   每桌可多次使用
*   插入和更新操作比聚集索引更快

Both types of index will improve performance when select data with fields that use the index but will slow down update and insert operations.

由于插入和更新速度较慢，因此应在通常为增量的字段（即 Id 或时间戳）上设置聚集索引。

SQL Server 通常仅在其选择性高于 95% 时才使用索引。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2008-09-18T11:24:10.810

聚集索引对磁盘上的数据进行物理排序。这意味着索引不需要额外的数据，但只能有一个聚集索引（显然）。使用聚集索引访问数据是最快的。

所有其他索引必须是非聚集的。非聚集索引具有来自索引列的数据的副本，这些数据与指向实际数据行的指针一起保持有序（如果存在则指向聚集索引的指针）。这意味着通过非聚集索引访问数据必须经过一个额外的间接层。但是，如果您仅选择索引列中可用的数据，您可以直接从重复的索引数据中获取数据（这就是为什么最好只选择您需要的列而不使用 *）

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-09-18T11:19:09.000

聚集索引物理存储在表上。这意味着它们是最快的，每个表只能有一个聚集索引。

非聚集索引是单独存储的，您可以拥有任意数量的索引。

最好的选择是在最常用的唯一列上设置聚集索引，通常是 PK。您的表中应该始终有一个精心选择的聚集索引，除非有非常令人信服的理由——想不出一个，但是嘿，它可能就在那里——因为不这样做会出现。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-02-10T14:22:31.823

## 聚集索引

1.  一张表只能有一个聚集索引。
2.  通常在主键上进行。
3.  聚集索引的叶节点包含数据页。

## 非聚集索引

1.  一个表只能有 249 个非聚集索引（直到 sql 版本 2005 以后的版本最多支持 999 个非聚集索引）。
2.  通常在任何键上进行。
3.  非聚集索引的叶节点不包含数据页。相反，叶节点包含索引行。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2016-06-22T16:29:42.180

## 聚集索引

*   一张表中只能有一个聚集索引
*   对记录进行排序并按照顺序进行物理存储
*   数据检索比非聚集索引更快
*   不需要额外的空间来存储逻辑结构

## 非聚集索引

*   一个表中可以有任意数量的非聚集索引
*   不影响物理顺序。为数据行创建逻辑顺序并使用指向物理数据文件的指针
*   数据插入/更新比聚集索引快
*   使用额外的空间来存储逻辑结构

* * *

除了这些差异之外，您必须知道当表是非聚集的（当表没有聚集索引时）数据文件是无序的并且它使用堆数据结构作为数据结构。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-09-18T11:22:21.270

**优点：**

聚集索引适用于范围（例如 select * from my_table where my_key between @min 和 @max）

在某些情况下，如果您使用 orderby 语句，DBMS 将不必进行排序工作。

**缺点：**

聚集索引可能会减慢插入速度，因为如果新键不按顺序排列，则必须在放入记录时修改记录的物理布局。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-09-18T11:20:41.990

集群基本上意味着数据在表中的物理顺序。这就是为什么每张桌子只能有一个。

非聚集意味着它“仅”是一个逻辑顺序。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-18T11:19:57.733

聚集索引实际上描述了记录物理存储在磁盘上的顺序，因此您只能拥有一个。

非聚集索引定义了与磁盘上的物理顺序不匹配的逻辑顺序。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-09-17T15:48:37.127

索引数据库有两部分：一组以任意顺序排列的物理记录，以及一组索引，这些索引标识应读取记录以产生按某种标准排序的结果的顺序。如果物理排列和索引之间没有关联，那么按顺序读取所有记录可能需要进行大量独立的单记录读取操作。因为一个数据库可能能够在比读取两个不连续记录的时间更短的时间内读取数十个连续记录，如果索引中连续的记录也连续存储在磁盘上，则性能可能会有所提高。

例如，如果从一个空的非集群数据库开始并以随机顺序添加 10,000 条记录，则这些记录可能会按照添加顺序添加到末尾。按索引顺序读取数据库需要 10,000 次单记录读取。但是，如果要使用集群数据库，系统可能会在添加每条记录时检查之前的记录是否是自己存储的；如果发现是这种情况，它可能会将该记录与数据库末尾的新记录一起写入。然后，它可以查看移动记录所在的插槽之前的物理记录，并查看后面的记录是否由它自己存储。如果发现是这种情况，它可以将该记录移至该位置。使用这种方法会导致许多记录成对组合在一起，

实际上，集群数据库使用比这更复杂的算法。但是，需要注意的关键是在更新数据库所需的时间和顺序读取数据库所需的时间之间进行权衡。维护集群数据库将显着增加以任何会影响排序顺序的方式添加、删除或更新记录所需的工作量。如果数据库被顺序读取的频率比更新的频率高得多，那么集群可能是一个巨大的胜利。如果它会经常更新但很少按顺序读取，则集群可能会消耗很大的性能，特别是如果将项目添加到数据库的顺序与它们相对于集群索引的排序顺序无关。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-09-18T11:22:08.057

聚集索引本质上是索引列中数据的排序副本。

聚集索引的主要优点是，当您的查询（查找）在索引中定位数据时，不需要额外的 IO 来检索该数据。

维护聚集索引的开销，尤其是在频繁更新的表中，可能会导致性能下降，因此最好创建非聚集索引。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-12-23T02:06:19.240

您可能已经阅读了上述帖子的理论部分：

**-我们可以看到的聚集索引直接指向记录，即直接记录，因此搜索所需的时间更少。此外，它不会占用任何额外的内存/空间来存储索引**

**-虽然，在非聚集索引中，它间接指向聚集索引，然后它将访问实际记录，由于它的间接性质，它需要更多的时间来访问。而且它需要自己的内存/空间来存储指数**

[![在此处输入图像描述](https://i.stack.imgur.com/kFSWR.png)](https://i.stack.imgur.com/kFSWR.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-12-19T10:44:33.877

// 抄自MSDN，非聚集索引的第二点在其他答案中没有明确提到。

**集群的**

*   聚集索引根据键值对表或视图中的数据行进行排序和存储。这些是索引定义中包含的列。每个表只能有一个聚集索引，因为数据行本身只能以一种顺序存储。
*   表中的数据行按排序顺序存储的唯一时间是表包含聚集索引时。当表具有聚集索引时，该表称为聚集表。如果表没有聚集索引，则其数据行存储在称为堆的无序结构中。

**非聚集**

*   非聚集索引具有与数据行分开的结构。非聚集索引包含非聚集索引键值，
    每个键值条目都有一个指向包含键值的数据行的指针。
*   从非聚集索引中的索引行指向数据行的指针称为行定位器。行定位器的结构取决于数据页是存储在堆还是聚集表中。对于堆，行定位器是指向行的指针。对于聚集表，行定位符是聚集索引键。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-07-20T07:11:28.597

**聚集索引**

*   聚集索引的检索速度更快，而插入和更新速度较慢。
*   一张表只能有一个聚集索引。
*   不需要额外的空间来存储逻辑结构。
*   确定数据在磁盘上的存储顺序。

**非聚集索引**

*   非聚集索引检索数据的速度较慢，而插入和更新的速度较快。

*   一个表可以有多个非聚集索引。

*   需要额外的空间来存储逻辑结构。

*   对磁盘上存储数据的顺序没有影响。

# java - 非 JSP（独立）上下文中的 JSTL/JSP EL（表达式语言）

> ID：91692
> 
> 赞同：12
> 
> 时间：2008-09-18T11:15:06.370
> 
> 标签：java, jsp, el, text-formatting

任何人都可以推荐一个框架来按照 JSP EL（表达式语言）的方式在独立应用程序中对消息进行模板/格式化吗？

我希望能够实例化某种对象，给它一个模板

```
Dear ${customer.firstName}. You order will be dispatched on ${order.estimatedDispatchDate} 
```

为它提供一个上下文，该上下文将包括一个参数对象的值字典（在这种情况下，一个名为“customer”的 Customer 类型的对象，以及一个名为“order”的 Order 类型的对象）。

我知道那里有许多模板框架——其中许多在 Web 应用程序上下文之外工作，但我不认为这是一个重量级的大型模板框架。只是 Java 已经提供的基本消息格式功能的更好版本

例如，我可以通过 java.text.MessageFormat 使用模板（或他们称之为“模式”）来完成上述操作，例如

```
Dear {0}. You order will be dispatched on {1,date,EEE dd MMM yyyy} 
```

我可以在我的调用 Java 程序中传递一个 Object 数组

```
new Object[] { customer.getFirstName(), order.getEstimatedDispatchDate() }; 
```

但是，在这种用法中，代码和模式是密切相关的。虽然我可以将模式放在资源属性文件中，但代码和模式需要了解彼此的密切细节。使用类似 EL 的系统，代码和模式之间的契约将处于更高级别（例如，客户和订单，而不是 customer.firstName 和 order.estimatedDispatchDate），从而更容易更改结构、订单和内容的消息而不更改任何代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T11:46:30.367

您可以只使用通用表达式语言本身。您需要一个实现（但有几个可供选择）。之后，需要实现三个类：ELResolver、FunctionMapper 和VariableMapper。

这篇博客文章描述了如何做到这一点：[Java：在 J2EE 之外使用 EL](http://illegalargumentexception.blogspot.com/2008/04/java-using-el-outside-j2ee.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T16:38:06.043

[StringTemplate](http://www.stringtemplate.org/)是 Velocity 和 Freemarker 的更轻量级的替代品。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T11:28:09.350

我建议研究[Apache Velocity](http://velocity.apache.org/)。它非常简单和轻量级。

我们目前正在将它用于我们的电子邮件模板，并且效果很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T11:44:58.080

[Ed Burns 提倡](http://weblogs.java.net/blog/edburns/archive/2006/08/the_case_for_el.html)在 Java EE 之外使用 EL 本身的想法，并[在服务器端进行了讨论](http://www.theserverside.com/news/thread.tss?thread_id=41768)。Tomcats 实现[在单独的 JAR 中提供](http://commons.apache.org/el/proposal.html)，但我不知道它是否可以在服务器外部使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-12T19:04:47.070

您可以使用与 jsp 非常相似且易于使用的 Casper：[Casper](http://code.google.com/p/casper/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-02-22T20:45:34.713

我会选择 Spring Expression 语言：

[http://docs.spring.io/spring/docs/current/spring-framework-reference/html/expressions.html](http://docs.spring.io/spring/docs/current/spring-framework-reference/html/expressions.html)

一些展示强大功能的示例（前两个来自文档）：

```
int year = (Integer) parser.parseExpression("Birthdate.Year + 1900").getValue(context);

String city = (String) parser.parseExpression("placeOfBirth.City").getValue(context);

// weekday is a String, e.g. "Mon", time is an int, e.g. 1400 or 900
{"Thu", "Fri"}.contains(weekday) and time matches '\d{4}' 
```

表达式也可以使用对象属性：

```
public class Data {
    private String name; // getter and setter omitted
}

Data data = new Data();
data.setName("John Doe");

ExpressionParser p = new SpelExpressionParser();
Expression e = p.parseExpression("name == 'John Doe'");
Boolean r = (Boolean) e.getValue(data); // will return true

e = p.parseExpression("Hello " + name + ", how are you ?");
String text = e.getValue(data, String.class); // text will be "Hello John Doe, how are you ?" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T11:29:28.100

您可能想查看[OGNL](http://www.ognl.org/)，这是您所追求的那种库。OGNL 可以相当强大，并且是[WebWork](http://www.opensymphony.com/webwork/) Web 框架中使用的表达语言。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T10:49:02.123

回复：Jasper 和 Juel 是为 1.5 构建的：然后我发现了 RetroTranslator（[http://retrotranslator.sourceforge.net/](http://retrotranslator.sourceforge.net/)）。一旦被逆向翻译，EL 和 Jasper 就像一个魅力

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T11:49:51.467

Freemarker 将完全满足您的需求。这是一个语法与 JSP 非常相似的模板引擎：

[http://freemarker.org/](http://freemarker.org/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T12:33:29.407

啊。而使用 MessageFormat，我可以做到

```
Dear {0}. Your order will be dispatched on {1,date,EEE dd MMM yyyy} 
```

其中参数 #1 是一个 Date 对象，它根据模式进行格式化，EL 中没有等价物。

在 JSP 中，我可能会使用格式标记。在这个独立的示例中，我必须在计算表达式之前在我的代码中将日期格式化为字符串。

# php - PHP 等效于 Perl 的“使用严格”（要求在使用前初始化变量）

> ID：91699
> 
> 赞同：9
> 
> 时间：2008-09-18T11:16:10.533
> 
> 标签：php

Python 的约定是变量是通过第一次赋值创建的，并且在赋值之前尝试读取它们的值会引发异常。相比之下，PHP 在读取时隐式创建一个变量，其值为空。这意味着在 PHP 中很容易做到这一点：

```
function mymodule_important_calculation() {
    $result = /* ... long and complex calculation ... */;
    return $resukt;
} 
```

此函数始终返回 null，如果 null 是该函数的有效值，则该错误可能会在一段时间内未被检测到。Python 等效项会抱怨该变量`resukt`在分配之前已被使用。

那么......有没有办法将PHP配置为更严格的变量分配？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T11:19:47.077

**PHP**在解析时不会做太多的前向检查。

您可以做的最好的事情是提高警告级别以报告您的错误，但是当您收到 E_NOTICE 时，为时已晚，而且还无法强制 E_NOTICE 提前发生。

很多人都携带“error_reporting E_STRICT”标志，但它仍然具有追溯性警告，并且不会像您发布的那样保护您免受不良代码错误的影响。

这个 gem 本周出现在 php-dev 邮件列表中，我认为它正是您想要的工具。它更像是一个 lint-checker，但它增加了当前 lint 检查 PHP 所做的范围。

[**PHP 初始化的谷歌项目**](http://code.google.com/p/php-initialized/wiki/Features)

希望只要稍加注意，我们就可以在 PHP 本身中实现这种行为。所以把你的 2 美分放在 PHP 邮件列表/错误系统/功能请求上，看看我们是否可以鼓励它的集成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T11:18:59.967

据我所知，没有办法让它失败，但是在 error_reporting 设置中使用 E_NOTICE 可以让它发出警告（嗯，一个通知 :-) 但仍然是一个你可以搜索的字符串）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T11:22:17.227

查看错误报告，[http ://php.net/manual/en/function.error-reporting.php](http://php.net/manual/en/function.error-reporting.php)

你想要的可能是 E_STRICT。请记住，PHP 没有命名空间，并且错误报告成为全局性的。如果您使用未打开错误报告的开发人员提供的第 3 方库，那么您会觉得很糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:19:51.273

我很确定如果变量之前没有声明它会产生错误。如果您的安装没有显示此类错误，请检查 php.ini 文件中的 error_reporting() 级别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T11:20:13.193

您可以尝试使用此处指示的错误报告级别：http: [//us3.php.net/error_reporting](http://us3.php.net/error_reporting)但我不确定它是否提到了未启动变量的使用，即使使用 E_STRICT 也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T11:33:12.443

有类似的东西：在 PHP 中，您可以更改错误报告级别。在开发环境中将其设置为最大值是最佳实践。这样做：

添加你的 PHP.ini：

```
error_reporting = E_ALL 
```

或者您可以将其添加到您正在处理的文件的顶部：

```
error_reporting(E_ALL); 
```

这不会阻止您的代码运行，但缺少变量分配将在您的浏览器中显示非常清晰的错误消息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T18:59:11.093

如果您对文件或 Zend Studio 中的项目使用“分析代码”，它会警告您任何未初始化的变量（这实际上有助于发现大量拼写错误的变量潜伏在很少使用的代码部分中，等待导致很难检测错误）。也许有人可以在 PHP lint 函数 (php -l) 中添加该功能，该函数目前仅检查语法错误。

# asp.net - 从用户的角度进行端到端应用程序测试

> ID：91703
> 
> 赞同：1
> 
> 时间：2008-09-18T11:17:03.933
> 
> 标签：asp.net, unit-testing, testing

我正在寻找一种从最终用户的角度持续测试我的 Web 应用程序的好方法。我有各种方法来检查以确保我的代码在幕后工作。我数不清有多少次我对一段代码进行了更改，对其进行了测试，它工作正常，然后部署它只是让它在几周后在其他地方炸毁。到那时我已经忘记了我所做的导致它爆炸的改变。我需要一些我可以在每次进行更改时运行的东西，以向我保证我没有在其他地方破坏某些东西。

它需要能够输入正确和不正确的条目，以便也可以测试客户端验证。

谢谢，

斯科特和开发团队

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T11:22:18.943

我认为您需要调查[Selenium](http://selenium.openqa.org/)。我们使用它在整个解决方案中进行自动化 UI 测试，它是跨浏览器和跨平台的。

您可以使用[Selenium IDE](http://selenium-ide.openqa.org/)记录您的 Web 应用程序的演练，然后您可以在浏览器中运行它，或者将其导出为 C# 等各种语言，然后使用 NUnit 运行它。我发现这是最简单的方法，因为我可以创建基本演练，然后修改代码以使用来自文件/数据库的输入来创建多个场景。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T11:30:18.207

你见过[这种](http://gojko.net/2007/05/20/automating-web-tests-with-fitnesse-and-selenium/)使用[Fitnesse](http://www.fitnesse.org/)和[selenium](http://selenium-core.openqa.org/)的技术吗？

不能保证设置起来有多么容易，我们已经对 selenium 进行了一些研究，我们的一位测试分析师热衷于将 FIT/Fitnesse 之类的东西集成到我们的自动化测试中，但我们还没有做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T08:22:49.573

看看[Seleno](http://teststack.github.com/TestStack.Seleno/)，它将 Selenium / 浏览器交互抽象为 C# 页面对象，代表您网站的页面。[此答案](https://stackoverflow.com/a/14153528/169334)中的更多详细信息。

# database - 当人们谈论使用“分片”扩展网站时，他们是什么意思？

> ID：91710
> 
> 赞同：11
> 
> 时间：2008-09-18T11:17:45.960
> 
> 标签：database, scalability, sharding

关于解决大型网站的扩展问题，我曾多次听到“分片”技术。这是什么“碎片”技术，为什么这么好？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T11:26:49.730

Karl Seguin 有一篇关于分片的[好博文。](http://codebetter.com/blogs/karlseguin/archive/2008/06/30/scale-cheaply-sharding.aspx)

从帖子：

> 分片是跨多个服务器的数据分离。如何分离数据取决于您，但通常它是在一些基本标识符上完成的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T11:28:35.217

简而言之，想象一下将您的 users_tbl 分隔在多个服务器上。所以用户 1-5000 在服务器 1 上，用户 5000-10000 在服务器 2 上；等等。如果您的数据模型在代码中足够抽象，则通常不会对代码进行巨大更改。

当然，如果您的所有查询都类似于“SELECT COUNT(*) FROM users_tbl GROUP BY userType”，那么这种方法会变得很困难，但是当您的 where 是“WHERE userid = 5”时，它就更有意义了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T12:05:51.443

[由于“分片”是大型网站架构原则的一部分，您可能有兴趣在此处](http://www.se-radio.net/podcast/2008-09/episode-109-ebay039s-architecture-principles-randy-shoup)收听“eBay 的 Randy Shoup 架构原则” 。

# c++ - 没有 C++ 字符串 和 STL

> ID：91715
> 
> 赞同：5
> 
> 时间：2008-09-18T11:19:37.657
> 
> 标签：c++, string, list

过去我没有太多使用 C++，最近也做了很多 C#，我真的很难再次回到 C++ 的基础知识。这特别棘手，因为工作要求不能使用任何最方便的 C++ 构造，因此所有字符串都必须是 char *，并且没有提供 STL 列表。

我目前正在尝试做的是创建一个字符串列表，使用 STL 或 C# 完全不需要我花时间。基本上我想要一个功能，例如：

```
char **registeredNames = new char*[numberOfNames]; 
```

然后，

```
RegisterName(const * char const name, const int length)
{
    //loop to see if name already registered snipped
    if(notFound)
    {
        registeredNames[lastIndex++] = name;
    }

} 
```

或者，如果它是 C#...

```
if(!registeredNames.Contains(name))
{
    registeredNames.Add(name);
} 
```

我意识到它不起作用。我知道传递变量（一个常量指针和一个常量字符串）的常量性质使它相当困难，但我的基本问题是我过去总是通过使用 STL 列表等来避免这种情况，所以我从来没有不得不解决它！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T12:17:23.727

有正当理由可以避免 STL。在内存或速度非常重要的固定环境中工作时，有时很难判断 STL 的幕后情况。是的，您可以编写自己的内存分配器，是的，速度通常不是问题，但是跨平台的 STL 实现之间存在差异，这些差异可能很微妙并且可能存在错误。在考虑使用它时，内存可能是我最关心的问题。

记忆是宝贵的，我们如何使用它需要被严格控制。除非你一直走这条路，否则这个概念可能没有意义，但它是真的。我们确实允许在工具中使用 STL（在游戏代码之外），但在实际游戏中是禁止的。另一个相关问题是代码大小。我不太确定 STL 对可执行文件大小的贡献有多大，但我们已经看到使用 STL 时代码大小显着增加。即使您的可执行文件“仅”大了 2M，对于您的游戏的其他内容来说，内存也少了 2M。

STL 确实不错。但它可能会被不知道自己在做什么的程序员滥用。这不是故意的，但是当您不想看到它们时，它可能会带来令人讨厌的惊喜（同样，内存膨胀和性能问题）

我敢肯定你对你的解决方案很满意。

```
for ( i = 0; i < lastIndex; i++ ) {
    if ( !strcmp(&registeredNames[i], name ) {
        break;    // name was found
    }
}
if ( i == lastIndex ) {
    // name was not found in the registeredNames list
    registeredNames[lastIndex++] = strdup(name);
} 
```

您可能不想使用 strdup。这只是一个示例，说明如何根据您的示例存储名称。您可能希望确保自己不想为新名称分配空间，或者使用您的应用程序中可能已经可用的其他一些内存结构。

请不要写字符串类。我认为字符串类可能是如何不重新设计 C++ 中的基本 C 构造的最糟糕的例子。是的，字符串类可以对你隐藏很多漂亮的细节，但是它的内存使用模式很糟糕，而且这些模式不适合控制台（例如 ps3 或 360 等）环境。大约 8 年前，我们也做过同样的事情。在我们点击主菜单之前分配了 200000+ 内存。内存非常碎片化，我们无法让游戏的其余部分适应固定的环境。我们最终把它撕掉了。

类设计在某些方面非常有用，但这不是其中之一。这是一种观点，但它基于现实世界的经验。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T11:28:57.960

您可能需要使用 strcmp 来查看字符串是否已存储：

```
for (int index=0; index<=lastIndex; index++)
{
  if (strcmp(registeredNames[index], name) == 0)
  {
    return; // Already registered
  }
} 
```

然后，如果您确实需要存储字符串的副本，那么您将需要分配一个缓冲区并将字符复制过来。

```
char* nameCopy = malloc(length+1);
strcpy(nameCopy, name);
registeredNames[lastIndex++] = nameCopy; 
```

您没有提到您的输入是否以 NULL 结尾-如果不是，则需要格外小心，并且 strcmp/strcpy 将不合适。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T11:46:39.510

如果可移植性是一个问题，您可能需要查看[STLport](http://www.stlport.org/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T11:29:27.803

为什么不能使用 STL？

无论如何，我建议您实现一个简单的字符串类和您自己的列表模板。这样，您可以使用与通常相同的技术，并将指针和内存管理限制在这些类中。如果你模仿STL，那就更好了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T11:56:12.827

如果你真的不能使用 stl（我很遗憾在我从事游戏行业时相信这是真的），那么你能不创建自己的字符串类吗？最基本的字符串类将在构造和赋值时分配内存，并在析构函数中处理删除。稍后您可以根据需要添加更多功能。完全可移植，非常容易编写和单元测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T11:26:05.567

编辑：我想我误解了你的问题。我知道此代码中没有 constness 问题。

我是从头开始做的，但应该是正确的：

```
static int lastIndex = 0;
static char **registeredNames = new char*[numberOfNames];

void RegisterName(const * char const name)
{
    bool found = false;
    //loop to see if name already registered snipped
    for (int i = 0; i < lastIndex; i++)
    {
        if (strcmp(name, registeredNames[i] == 0))
        {
            found = true;
            break;
        }
    }

    if (!found)
    {
        registeredNames[lastIndex++] = name;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T11:29:23.263

使用 char* 需要您使用 C 函数。在您的情况下，您真正​​需要的是复制字符串。为了帮助你，你有 strndup 功能。然后你必须写一些类似的东西：

```
void RegisterName(const char* name)
{
  // loop to see if name already registered snipped
  if(notFound)
  {
    registerNames[lastIndex++] = stdndup(name, MAX_STRING_LENGTH);
  }
} 
```

此代码假设您的数组足够大。

当然，最好的办法是正确实现您自己的字符串、数组和列表，……或者让您的老板相信 STL 不再是邪恶的了！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T11:29:27.540

使用：

```
const char **registeredNames = new const char * [numberOfNames]; 
```

将允许您将 a 分配给`const * char const`数组的元素。

只是出于好奇，为什么“工作要求不能使用最方便的 C++ 构造”？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T12:13:00.880

我可以理解为什么你不能使用 STL——大多数确实让你的代码非常臃肿。然而，游戏程序员为游戏程序员提供了一些实现[——RDESTL](http://code.google.com/p/rdestl/)就是这样一个库。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T12:37:28.343

如果您不担心约定，只想完成工作，请使用 realloc。我一直在为列表做这种事情，它是这样的：

```
T** list = 0;
unsigned int length = 0;

T* AddItem(T Item)
{
 list = realloc(list, sizeof(T)*(length+1));
 if(!list) return 0;
 list[length] = new T(Item);
 ++length;
 return list[length];
}

void CleanupList()
{
 for(unsigned int i = 0; i < length; ++i)
 {
  delete item[i];
 }
 free(list)
} 
```

您还可以做更多事情，例如每次列表大小翻倍时才重新分配，通过索引或检查相等性从列表中删除项目的功能，制作用于处理列表的模板类等......（我有一个我很久以前写过的，并且总是使用自己......但遗憾的是我在工作，不能在这里复制粘贴）。不过老实说，这可能不会胜过 STL 等价物，尽管如果您做大量工作或 STL 的实现特别差，它可能会与其性能相当。

令人烦恼的是，C++ 没有操作符 renew/resize 来替换 realloc，这将非常有用。

哦，如果我的代码出错了，我很抱歉，我只是把它从内存中拉出来了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T13:18:05.670

建议的所有方法都是有效的，我的观点是，如果 C# 的方式很吸引人，请使用提供的示例代码创建自己的类/接口以呈现相同的抽象，即具有方法 Contains 和 Add 的简单链表类通过其他答案，这应该相对简单。

C++ 的一大优点通常是，如果另一种语言有很好的实现，通常可以重现它，你可以让它看起来和按照你想要的方式运行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T13:37:02.147

无论您是否使用 STL，const 正确性仍然是 const 正确性。我相信您正在寻找的是制作 registeredNames a`const char **`以便对`registeredNames[i]`（即 a `const char *`）的分配有效。

而且，这真的是你想做的吗？似乎制作字符串的副本可能更合适。

此外，鉴于您正在对其进行的操作，您不应该考虑将其存储在列表中，一组会更好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T23:08:27.843

我已经使用这个 String 类多年了。

[http://www.robertnz.net/string.htm](http://www.robertnz.net/string.htm "字符串类")

它几乎提供了 STL 字符串的所有特性，但被实现为真正的类而不是模板，并且不使用 STL。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T17:29:33.520

这是一个明显的例子，你可以自己动手。对向量类做同样的事情。

*   使用测试优先编程来做到这一点。
*   把事情简单化。

如果您在 MT 环境中，请避免对字符串缓冲区进行引用计数。

# html - 跨浏览器问题（iframe 大小）

> ID：91721
> 
> 赞同：3
> 
> 时间：2008-09-18T11:19:53.520
> 
> 标签：html, css, iframe, cross-browser, resize

我在我的一个页面中显示来自外部站点（我拥有的）的`iframe`页面。一切都很好，除非在`Opera`缩小浏览器窗口大小（不是宽屏）的情况下查看，当`iframe`缩小和挤压内容时。它适用于宽屏（最大化浏览器窗口），并且可以`IE7, Firefox, Chrome`在`Safari`最大化和缩小窗口大小中使用。

我已经在 HTML 中设置了框架尺寸，并嵌套了比通过 css更大`iframe`的 a 。`div``iframe`

这是 Opera 的一个特殊错误还是我可以做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T12:27:10.037

`iframe`尽管在 IE6 中，我们的 Web 应用程序主页上的大小也有类似的问题。解决方案是捕获`window.onresize`事件并调用 JavaScript 函数来适当调整`iframe`. `content`是`iframe`我们想要调整大小的名称。另请注意，我们使用的是 ASP.Net AJAX `$get`，它转换为`document.getElementById()`

```
window.onresize=resizeContentFrame;
resizeContentFrame();

function resizeContentFrame() {
    setFrameHeight($get('content'));
}

function setFrameHeight(f) {
    if(isDefined(f)) {
        var h=document.documentElement.scrollHeight;
        h-=(HEADER_HEIGHT+CONTENT_PADDING+5);
        f.style.height=h+'px';
    }
} 
```

# java - JIRA - 从发布功能更新摘要

> ID：91731
> 
> 赞同：0
> 
> 时间：2008-09-18T11:21:04.533
> 
> 标签：java, jira

如何从 JIRA 中的 post 函数更新汇总字段的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T00:22:22.500

有一个内置的 post 功能允许您更改摘要 - 尽管只能更改为硬编码值。

如果您想修改当前摘要，您需要创建一个帖子功能，如前所述。

如果您有商业许可证，您应该可以访问 JIRA 源。查看以下代码：`src/java/com/atlassian/jira/workflow/function/issue/UpdateIssueFieldFunction.java`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T12:38:44.890

好的，我将尝试解释...为简单起见，假设我们有一个 post 函数，并且我们希望将汇总值更改为“foobar”：

```
public class SomePostFunction implements FunctionProvider {

    public void execute(Map transientVars, Map args, PropertySet ps) throws WorkflowException {
        String newValue = "foobar";
        // TODO update summary so it's value becomes newValue
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:00:11.667

怎么样：

```
 transientVars.get("issue").setSummary(newValue); 
```

无论如何，你应该看看这里：[http ://confluence.atlassian.com/display/JIRA/Upgrading+Workflow+Plugins+for+JIRA+3.2](http://confluence.atlassian.com/display/JIRA/Upgrading+Workflow+Plugins+for+JIRA+3.2)

# asp-classic - 如何在经典asp中转换日期字符串

> ID：91734
> 
> 赞同：4
> 
> 时间：2008-09-18T11:21:49.490
> 
> 标签：asp-classic

我现在有点傻……</p>

我有一个欧洲格式 dd.mm.yyyy 的日期字符串，**需要**使用经典 ASP将其转换为**mm.dd.yyyy 。**有什么快速的想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T11:35:55.930

如果它总是采用那种格式，你可以使用 split

```
d = split(".","dd.mm.yyyy")
s = d(1) & "." & d(0) & "." & d(2) 
```

这也允许像 1.2.99 这样的日期

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T11:40:55.967

```
Dim arrParts() As String
Dim theDate As Date

arrParts = Split(strOldFormat, ".")
theDate = DateTime.DateSerial(parts(2), parts(1), parts(0))

strNewFormat = Format(theDate, "mm.dd.yyyy") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T11:34:38.430

好的，我自己找到了一个解决方案：

```
payment_date = MID(payment_date,4,3) & LEFT(payment_date,3) & MID(payment_date,7) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T11:35:06.397

这是一种通过内置的日期健全性检查来做到这一点的方法：

```
Dim OldString, NewString

OldString = "31.12.2008"

Dim myRegExp
Set myRegExp = New RegExp
myRegExp.Global = True
myRegExp.Pattern = "(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.]((19|20)[0-9]{2})"

If myRegExp.Test Then
    NewString = myRegExp.Replace(OldString, "$2.$1.$3")
Else
    ' A date of for instance 32 December would end up here
    NewString = "Invalid date"
End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T11:19:18.650

我有自己的日期操作函数，我在所有应用程序中都使用它，但它最初是基于这个示例：

[http://www.adopenstatic.com/resources/code/formatdate.asp](http://www.adopenstatic.com/resources/code/formatdate.asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-23T08:32:57.377

```
function MyDateFormat(mydate)
    'format: YYYYMMDDHHMMSS
    MyDateFormat = year(mydate) & right("0" & month(mydate),2) & _
        right("0" & day(mydate),2) & right("0" & hour(mydate),2) &_
        right("0" & minute(mydate),2) & right("0" & second(mydate),2)
end function

response.write(MyDateFormat(Now)) 
```

显示：20200623102805

# c# - DataGridViewComboBoxColumn 向每一行添加不同的项目。

> ID：91745
> 
> 赞同：16
> 
> 时间：2008-09-18T11:23:05.433
> 
> 标签：c#, winforms, datagridview

我正在使用 DataGridView 构建一个表格，用户可以在其中从每个单元格的下拉列表中选择项目。为了简化问题，假设我有 1 列。我在设计器中使用 DataGridViewComboBoxColumn。我试图支持让该列中的每一行都有不同的项目列表可供选择。

这可能吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-02T16:13:14.520

是的。这可以使用 DataGridViewComboBoxCell 来完成。

这是一个将项目添加到一个单元格而不是整个列的示例方法。

```
private void setCellComboBoxItems(DataGridView dataGrid, int rowIndex, int colIndex, object[] itemsToAdd)
{
    DataGridViewComboBoxCell dgvcbc = (DataGridViewComboBoxCell) dataGrid.Rows[rowIndex].Cells[colIndex];
    // You might pass a boolean to determine whether to clear or not.
    dgvcbc.Items.Clear();
    foreach (object itemToAdd in itemsToAdd)
    {
        dgvcbc.Items.Add(itemToAdd);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-29T03:20:07.027

```
private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
{
    if (e.ColumnIndex == DataGridViewComboBoxColumnNumber)
    {
        setCellComboBoxItems(myDataGridView, e.RowIndex, e.ColumnIndex, someObj);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-16T11:30:26.847

万一有人发现这个线程，这是我在 VB 2008 中的解决方案。它提供的优点是它允许您为组合框中的每个值分配一个 ID。

```
 Private Sub FillGroups()
    Try
        'Create Connection and SQLCommand here.

        Conn.Open()
        Dim dr As SqlDataReader = cm.ExecuteReader

        dgvGroups.Rows.Clear()

        Dim PreviousGroup As String = ""

        Dim l As New List(Of Groups)

        While dr.Read

            Dim g As New Groups
            g.RegionID = CheckInt(dr("cg_id"))
            g.RegionName = CheckString(dr("cg_name"))
            g.GroupID = CheckInt(dr("vg_id"))
            g.GroupName = CheckString(dr("vg_name"))
            l.Add(g)

        End While
        dr.Close()
        Conn.Close()

        For Each a In (From r In l Select r.RegionName, r.RegionID).Distinct

            Dim RegionID As Integer = a.RegionID 'Doing it this way avoids a warning

            dgvGroups.Rows.Add(New Object() {a.RegionID, a.RegionName})

            Dim c As DataGridViewComboBoxCell = CType(dgvGroups.Rows(dgvGroups.RowCount - 1).Cells(colGroup.Index), DataGridViewComboBoxCell)
            c.DataSource = (From g In l Where g.RegionID = RegionID Select g.GroupID, g.GroupName).ToArray
            c.DisplayMember = "GroupName"
            c.ValueMember = "GroupID"
        Next

    Catch ex As Exception
    End Try
End Sub

Private Class Groups

    Private _RegionID As Integer
    Public Property RegionID() As Integer
        Get
            Return _RegionID
        End Get
        Set(ByVal value As Integer)
            _RegionID = value
        End Set
    End Property

    Private _RegionName As String
    Public Property RegionName() As String
        Get
            Return _RegionName
        End Get
        Set(ByVal value As String)
            _RegionName = value
        End Set
    End Property

    Private _GroupName As String
    Public Property GroupName() As String
        Get
            Return _GroupName
        End Get
        Set(ByVal value As String)
            _GroupName = value
        End Set
    End Property

    Private _GroupID As Integer
    Public Property GroupID() As Integer
        Get            
            Return _GroupID
        End Get
        Set(ByVal value As Integer)
            _GroupID = value
        End Set
    End Property

End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-14T19:07:20.077

这是一个 gridView 的例子，它有 2 个 comboboxColumns，当一个 comboBoxColumns1 选择的索引发生变化时，使用来自数据库的两个不同列的数据加载 comboBoxColumns2。

```
 private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
        {
              if (dataGridView1.Rows[e.RowIndex].Cells[0].Value != null && dataGridView1.CurrentCell.ColumnIndex == 0)
            {

                SqlConnection conn = new SqlConnection("data source=.;initial catalog=pharmacy;integrated security=true");
                SqlCommand cmd = new SqlCommand("select [drugTypeParent],[drugTypeChild] from [drugs] where [drugName]='" + dataGridView1.Rows[e.RowIndex].Cells[0].Value.ToString() + "'", conn);
                conn.Open();
                SqlDataReader dr = cmd.ExecuteReader();
                while (dr.Read())
                {

                    object[] o = new object[] { dr[0].ToString(),dr[1].ToString() };
                    DataGridViewComboBoxCell dgvcbc = (DataGridViewComboBoxCell)dataGridView1.Rows[e.RowIndex].Cells[1];

                    dgvcbc.Items.Clear();
                    foreach (object itemToAdd in o)
                    {
                        dgvcbc.Items.Add(itemToAdd);
                    }
                }
                dr.Close();
                conn.Close();
               }
            } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-10T11:22:01.020

在设置数据源后立即设置组合框单元**对我不起作用**。它必须在绑定操作完成后完成。我选择了 CellBeginEdit

空下拉列表示例：

```
dgv1.datasource = datatable1;
dgv1.columns.add ( "cbxcol"  , typeof(string) );

//  different source for each comboboxcell in rows
var dict_rowInd_cbxDs = new Dictionary<int, object>();
dict_rowInd_cbxDs[1] = new list<string>(){"en" , "us"};
dict_rowInd_cbxDs[2] = new list<string>(){ "car", "bike"};

// !!!!!! setting comboboxcell after creating doesnt work here
foreach( row in dgv.Rows.asEnumerable() )
{ 
   var cell = res_tn.dgv.CurrentCell as DataGridViewComboBoxCell;
   cell.DataSource = dict_dgvRowI_cbxDs[res_tn.dgv.CurrentCell.RowIndex];

} 
```

工作示例：

```
dgv1.datasource = datatable1;
dgv1.columns.add ( "cbxcol"  , typeof(string) );

//  different source for each comboboxcell in rows
var dict_rowInd_cbxDs = new Dictionary<int, object>();
dict_rowInd_cbxDs[1] = new list<string>(){"en" , "us"};
dict_rowInd_cbxDs[2] = new list<string>(){ "car", "bike"};

// cmboboxcell datasource Assingment Must be done after  BindingComplete (not tested )  or cellbeginEdit  (tested by me)    
res_tn.dgv.CellBeginEdit += (s1, e1) => {
    if (res_tn.dgv.CurrentCell is DataGridViewComboBoxCell) {
        if (dict_dgvRowI_cbxDs.ContainsKey(res_tn.dgv.CurrentCell.RowIndex)) 
        {
            var cll = res_tn.dgv.CurrentCell as DataGridViewComboBoxCell;
            cll.DataSource = dict_dgvRowI_cbxDs[res_tn.dgv.CurrentCell.RowIndex];

           // required if it is  list<mycustomClass>
           // cll.DisplayMember = "ColName";
           // cll.ValueMember = "This";
        }
    }

}; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-05-08T06:34:28.733

```
 //Populate the Datatable with the Lookup lists
    private DataTable typeDataTable(DataGridView dataGridView, Lookup<string, Element> type_Lookup, Dictionary<Element, string> type_dictionary, string strNewStyle, string strOldStyle, string strID, string strCount)
    {
        int row = 0;

        DataTable dt = new DataTable();

        dt.Columns.Add(strOldStyle, typeof(string));
        dt.Columns.Add(strID, typeof(string));
        dt.Columns.Add(strCount, typeof(int));
        dt.Columns.Add("combobox", typeof(DataGridViewComboBoxCell));

        //Add All Doc Types to ComboBoxes
        DataGridViewComboBoxCell CmBx = new DataGridViewComboBoxCell();
        CmBx.DataSource = new BindingSource(type_dictionary, null);
        CmBx.DisplayMember = "Value";
        CmBx.ValueMember = "Key";

        //Add Style Comboboxes
        DataGridViewComboBoxColumn Data_CmBx_Col = new DataGridViewComboBoxColumn();
        Data_CmBx_Col.HeaderText = strNewStyle;
        dataGridView.Columns.Add(addDataGrdViewComboBox(Data_CmBx_Col, type_dictionary));

        setCellComboBoxItems(dataGridView, 1, 3, CmBx);

        //Add style Rows
        foreach (IGrouping<string, Element> StyleGroup in type_Lookup)
        {
            row++;
            //Iterate through each group in the Igrouping
            //Add Style Rows
            dt.Rows.Add(StyleGroup.Key, row, StyleGroup.Count().ToString());

        }
        return dt;
    }

    private void setCellComboBoxItems(DataGridView dataGrid, int rowIndex, int colIndex, DataGridViewComboBoxCell CmBx)
    {
        DataGridViewComboBoxCell dgvcbc = (DataGridViewComboBoxCell)dataGrid.Rows[rowIndex].Cells[colIndex];
        // You might pass a boolean to determine whether to clear or not.
        dgvcbc.Items.Clear();
        foreach (DataGridViewComboBoxCell itemToAdd in CmBx.Items)
        {
            dgvcbc.Items.Add(itemToAdd);
        } 
```

# c# - ListBox 项的背景颜色（Windows 窗体）

> ID：91747
> 
> 赞同：53
> 
> 时间：2008-09-18T11:24:05.150
> 
> 标签：c#, winforms, listbox, colors

如何设置 *System.Windows.Forms.ListBox*中特定项目的背景颜色？

如果可能的话，我希望能够设置多个。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2010-09-14T13:46:54.333

感谢[Grad van Horck 的回答](https://stackoverflow.com/a/91758/447356)。它引导我朝着正确的方向前进。

为了支持文本（不仅仅是背景颜色），这是我的完整工作代码：

```
//global brushes with ordinary/selected colors
private SolidBrush reportsForegroundBrushSelected = new SolidBrush(Color.White);
private SolidBrush reportsForegroundBrush = new SolidBrush(Color.Black);
private SolidBrush reportsBackgroundBrushSelected = new SolidBrush(Color.FromKnownColor(KnownColor.Highlight));
private SolidBrush reportsBackgroundBrush1 = new SolidBrush(Color.White);
private SolidBrush reportsBackgroundBrush2 = new SolidBrush(Color.Gray);

//custom method to draw the items, don't forget to set DrawMode of the ListBox to OwnerDrawFixed
private void lbReports_DrawItem(object sender, DrawItemEventArgs e)
{
    e.DrawBackground();
    bool selected = ((e.State & DrawItemState.Selected) == DrawItemState.Selected);

    int index = e.Index;
    if (index >= 0 && index < lbReports.Items.Count)
    {
        string text = lbReports.Items[index].ToString();
        Graphics g = e.Graphics;

        //background:
        SolidBrush backgroundBrush;
        if (selected)
            backgroundBrush = reportsBackgroundBrushSelected;
        else if ((index % 2) == 0)
            backgroundBrush = reportsBackgroundBrush1;
        else
            backgroundBrush = reportsBackgroundBrush2;
        g.FillRectangle(backgroundBrush, e.Bounds);

        //text:
        SolidBrush foregroundBrush = (selected) ? reportsForegroundBrushSelected : reportsForegroundBrush;
        g.DrawString(text, e.Font, foregroundBrush, lbReports.GetItemRectangle(index).Location);
    }

    e.DrawFocusRectangle();
} 
```

上面添加了给定的代码，并将显示正确的文本并突出显示选定的项目。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-09-18T11:28:45.527

可能实现这一点的唯一方法是自己绘制项目。

在 DrawItem 事件上设置`DrawMode`to并编写如下代码：`OwnerDrawFixed`

```
private void listBox_DrawItem(object sender, DrawItemEventArgs e)
{
    e.DrawBackground();
    Graphics g = e.Graphics;

    g.FillRectangle(new SolidBrush(Color.Silver), e.Bounds);

    // Print text

    e.DrawFocusRectangle();
} 
```

第二种选择是使用 ListView，尽管它们有另一种实现方式（不是真正的数据绑定，但列方式更灵活）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T11:31:08.767

```
// Set the background to a predefined colour
MyListBox.BackColor = Color.Red;
// OR: Set parts of a color.
MyListBox.BackColor.R = 255;
MyListBox.BackColor.G = 0;
MyListBox.BackColor.B = 0; 
```

如果您设置多个背景颜色的意思是为每个项目设置不同的背景颜色，那么这对于 ListBox 是不可能的，但对于ListView 来说*是*这样的：

```
// Set the background of the first item in the list
MyListView.Items[0].BackColor = Color.Red; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-01-13T09:44:38.987

```
public MainForm()
{
    InitializeComponent();
    this.listbox1.DrawItem += new DrawItemEventHandler(this.listbox1_DrawItem);
}

private void listbox1_DrawItem(object sender, System.Windows.Forms.DrawItemEventArgs e)
{
    e.DrawBackground();
    Brush myBrush = Brushes.Black;
    var item = listbox1.Items[e.Index];
    if(e.Index % 2 == 0)
    {
        e.Graphics.FillRectangle(new SolidBrush(Color.Gold), e.Bounds);
    }
        e.Graphics.DrawString(((ListBox)sender).Items[e.Index].ToString(), 
            e.Font, myBrush,e.Bounds, StringFormat.GenericDefault);
        e.DrawFocusRectangle();
    }
} 
```

# asp.net - 如何按字段长度对 ASP.NET DataGrid 进行排序？

> ID：91766
> 
> 赞同：0
> 
> 时间：2008-09-18T11:29:49.970
> 
> 标签：asp.net, datagrid

我有一个 DataGrid，其中每一列都有一个 SortExpression。我希望排序表达式相当于“ORDER BY LEN(myField)”。

我试过了

```
SortExpression="LEN(myField)" 
```

但这会引发异常，因为它不是有效的语法。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T11:36:07.757

已经通过查询返回 len ，但不显示该列，仅将其用作原始列的 sortexpression 怎么样？

我认为默认情况下不支持您的想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T11:41:59.507

根据您的 SQL 风格，以下可能有效：

```
SELECT
 ColumnA as FieldA
 , ColumnB as FieldB
 , LEN(ColumnA) as FieldL
FROM TableName
ORDER BY L 
```

然后做

```
SortExpression="FieldL" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T11:44:23.977

参数指定要排序的`SortExpression`列名，后跟“ASC”或“DESC”控制顺序。

您可以更改`DataType`列的属性以指定用户定义的类型，其比较器函数比较字符串长度。这不会是一项微不足道的任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:17:55.410

使用 Linq，您可以编写如下查询：

```
query.OrderBy(column => column.MyField.Length); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T16:21:39.007

嗯。有时间测试一下。我能够让**SortExpression="Description.Length"**工作。这是 1.1、2.0 还是 3.5？

# c# - 如何从事件中删除所有事件处理程序

> ID：91778
> 
> 赞同：404
> 
> 时间：2008-09-18T11:34:23.783
> 
> 标签：c#, .net, winforms, events

要在控件上创建新的事件处理程序，您可以这样做

```
c.Click += new EventHandler(mainFormButton_Click); 
```

或这个

```
c.Click += mainFormButton_Click; 
```

并删除一个事件处理程序，你可以这样做

```
c.Click -= mainFormButton_Click; 
```

但是如何从事件中删除所有事件处理程序？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2008-09-18T11:53:15.280

我在[MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/576f69e7-55aa-4574-8d31-417422954689/)上找到了解决方案。下面的示例代码将删除所有`Click`事件`button1`。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        button1.Click += button1_Click;
        button1.Click += button1_Click2;
        button2.Click += button2_Click;
    }

    private void button1_Click(object sender, EventArgs e)  => MessageBox.Show("Hello");
    private void button1_Click2(object sender, EventArgs e) => MessageBox.Show("World");
    private void button2_Click(object sender, EventArgs e)  => RemoveClickEvent(button1);

    private void RemoveClickEvent(Button b)
    {
        FieldInfo f1 = typeof(Control).GetField("EventClick", 
            BindingFlags.Static | BindingFlags.NonPublic);

        object obj = f1.GetValue(b);
        PropertyInfo pi = b.GetType().GetProperty("Events",  
            BindingFlags.NonPublic | BindingFlags.Instance);

        EventHandlerList list = (EventHandlerList)pi.GetValue(b, null);
        list.RemoveHandler(obj, list[obj]);
    }
} 
```

* * *

## 回答 #2

> 赞同：174
> 
> 时间：2011-03-29T15:59:19.613

你们对自己太苛刻了。这很容易：

```
void OnFormClosing(object sender, FormClosingEventArgs e)
{
    foreach(Delegate d in FindClicked.GetInvocationList())
    {
        FindClicked -= (FindClickedHandler)d;
    }
} 
```

* * *

## 回答 #3

> 赞同：84
> 
> 时间：2008-09-18T11:40:59.820

从*[删除所有事件处理程序](http://bytes.com/forum/thread274921.html)*：

> 直接不，很大程度上是因为您不能简单地将事件设置为空。
> 
> 间接地，您可以将实际事件设为私有并围绕它创建一个属性，以跟踪所有添加/减去的委托。
> 
> 采取以下措施：
> 
> ```
> List<EventHandler> delegates = new List<EventHandler>();
> 
> private event EventHandler MyRealEvent;
> 
> public event EventHandler MyEvent
> {
>     add
>     {
>         MyRealEvent += value;
>         delegates.Add(value);
>     }
> 
>     remove
>     {
>         MyRealEvent -= value;
>         delegates.Remove(value);
>     }
> }
> 
> public void RemoveAllEvents()
> {
>     foreach(EventHandler eh in delegates)
>     {
>         MyRealEvent -= eh;
>     }
>     delegates.Clear();
> } 
> ```

* * *

## 回答 #4

> 赞同：70
> 
> 时间：2011-11-12T22:38:26.627

接受的答案不完整。它不适用于声明为 {add; 的事件。消除;}

这是工作代码：

```
public static void ClearEventInvocations(this object obj, string eventName)
{
    var fi = obj.GetType().GetEventField(eventName);
    if (fi == null) return;
    fi.SetValue(obj, null);
}

private static FieldInfo GetEventField(this Type type, string eventName)
{
    FieldInfo field = null;
    while (type != null)
    {
        /* Find events defined as field */
        field = type.GetField(eventName, BindingFlags.Static | BindingFlags.Instance | BindingFlags.NonPublic);
        if (field != null && (field.FieldType == typeof(MulticastDelegate) || field.FieldType.IsSubclassOf(typeof(MulticastDelegate))))
            break;

        /* Find events defined as property { add; remove; } */
        field = type.GetField("EVENT_" + eventName.ToUpper(), BindingFlags.Static | BindingFlags.Instance | BindingFlags.NonPublic);
        if (field != null)
            break;
        type = type.BaseType;
    }
    return field;
} 
```

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2009-06-23T12:22:52.117

删除不存在的事件处理程序没有任何害处。因此，如果您知道可能有哪些处理程序，您可以简单地删除所有处理程序。我刚遇到类似的情况。这在某些情况下可能会有所帮助。

像：

```
// Add handlers...
if (something)
{
    c.Click += DoesSomething;
}
else
{
    c.Click += DoesSomethingElse;
}

// Remove handlers...
c.Click -= DoesSomething;
c.Click -= DoesSomethingElse; 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2016-07-21T14:19:56.027

我讨厌这里显示的任何完整解决方案，我现在做了混合和测试，适用于任何事件处理程序：

```
public class MyMain()
    public void MyMethod() {
        AnotherClass.TheEventHandler += DoSomeThing;
    }

    private void DoSomething(object sender, EventArgs e) {
        Debug.WriteLine("I did something");
        AnotherClass.ClearAllDelegatesOfTheEventHandler();
    }

}

public static class AnotherClass {

    public static event EventHandler TheEventHandler;

    public static void ClearAllDelegatesOfTheEventHandler() {

        foreach (Delegate d in TheEventHandler.GetInvocationList())
        {
            TheEventHandler -= (EventHandler)d;
        }
    }
} 
```

简单的！感谢斯蒂芬·普纳克。

我使用它是因为我使用通用的本地方法来删除委托，并且在设置不同的委托时，在不同的情况下调用了本地方法。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2010-12-04T05:07:16.783

我实际上正在使用这种方法，并且效果很好。我受到 Aeonhack [here](http://www.dreamincode.net/code/snippet5016.htm)编写的代码的“启发” 。

```
Public Event MyEvent()
Protected Overrides Sub Dispose(ByVal disposing As Boolean)
    If MyEventEvent IsNot Nothing Then
        For Each d In MyEventEvent.GetInvocationList ' If this throws an exception, try using .ToArray
            RemoveHandler MyEvent, d
        Next
    End If
End Sub 
```

MyEventEvent 字段是隐藏的，但它确实存在。

调试，可以看到`d.target`对象实际是如何处理事件的，以及`d.method`它的方法。您只需将其删除。

它工作得很好。由于事件处理程序，没有更多的对象没有被 GC 处理。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-18T11:45:00.793

如果你**真的**必须这样做......这将需要反思和相当长的时间来做到这一点。事件处理程序在控件内的事件到委托映射中进行管理。你需要

*   在控件实例中反映并获取此映射。
*   迭代每个事件，获取委托
    *   每个委托又可以是一系列链接的事件处理程序。所以调用 obControl.RemoveHandler(event, handler)

简而言之，工作量很大。这在理论上是可能的......我从来没有尝试过这样的事情。

看看您是否可以对控件的订阅-取消订阅阶段进行更好的控制/纪律。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-10-20T21:11:20.337

我刚刚发现*[如何在设置 WinForms 控件的属性时暂停事件](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/c873d460-2f7d-41f6-8149-3055a9dd5e7a)*。它将从控件中删除所有事件：

```
namespace CMessWin05
{
    public class EventSuppressor
    {
        Control _source;
        EventHandlerList _sourceEventHandlerList;
        FieldInfo _headFI;
        Dictionary<object, Delegate[]> _handlers;
        PropertyInfo _sourceEventsInfo;
        Type _eventHandlerListType;
        Type _sourceType;

        public EventSuppressor(Control control)
        {
            if (control == null)
                throw new ArgumentNullException("control", "An instance of a control must be provided.");

            _source = control;
            _sourceType = _source.GetType();
            _sourceEventsInfo = _sourceType.GetProperty("Events", BindingFlags.Instance | BindingFlags.NonPublic);
            _sourceEventHandlerList = (EventHandlerList)_sourceEventsInfo.GetValue(_source, null);
            _eventHandlerListType = _sourceEventHandlerList.GetType();
            _headFI = _eventHandlerListType.GetField("head", BindingFlags.Instance | BindingFlags.NonPublic);
        }

        private void BuildList()
        {
            _handlers = new Dictionary<object, Delegate[]>();
            object head = _headFI.GetValue(_sourceEventHandlerList);
            if (head != null)
            {
                Type listEntryType = head.GetType();
                FieldInfo delegateFI = listEntryType.GetField("handler", BindingFlags.Instance | BindingFlags.NonPublic);
                FieldInfo keyFI = listEntryType.GetField("key", BindingFlags.Instance | BindingFlags.NonPublic);
                FieldInfo nextFI = listEntryType.GetField("next", BindingFlags.Instance | BindingFlags.NonPublic);
                BuildListWalk(head, delegateFI, keyFI, nextFI);
            }
        }

        private void BuildListWalk(object entry, FieldInfo delegateFI, FieldInfo keyFI, FieldInfo nextFI)
        {
            if (entry != null)
            {
                Delegate dele = (Delegate)delegateFI.GetValue(entry);
                object key = keyFI.GetValue(entry);
                object next = nextFI.GetValue(entry);

                Delegate[] listeners = dele.GetInvocationList();
                if(listeners != null && listeners.Length > 0)
                    _handlers.Add(key, listeners);

                if (next != null)
                {
                    BuildListWalk(next, delegateFI, keyFI, nextFI);
                }
            }
        }

        public void Resume()
        {
            if (_handlers == null)
                throw new ApplicationException("Events have not been suppressed.");

            foreach (KeyValuePair<object, Delegate[]> pair in _handlers)
            {
                for (int x = 0; x < pair.Value.Length; x++)
                    _sourceEventHandlerList.AddHandler(pair.Key, pair.Value[x]);
            }

            _handlers = null;
        }

        public void Suppress()
        {
            if (_handlers != null)
                throw new ApplicationException("Events are already being suppressed.");

            BuildList();

            foreach (KeyValuePair<object, Delegate[]> pair in _handlers)
            {
                for (int x = pair.Value.Length - 1; x >= 0; x--)
                    _sourceEventHandlerList.RemoveHandler(pair.Key, pair.Value[x]);
            }
        }

    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-04T08:53:35.333

这个页面对我帮助很大。我从这里获得的代码旨在从按钮中删除单击事件。我需要从某些面板中删除双击事件并从某些按钮中删除单击事件。所以我做了一个控制扩展，它将删除某个事件的所有事件处理程序。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;
using System.Reflection;
public static class EventExtension
{
    public static void RemoveEvents<T>(this T target, string eventName) where T:Control
    {
        if (ReferenceEquals(target, null)) throw new NullReferenceException("Argument \"target\" may not be null.");
        FieldInfo fieldInfo = typeof(Control).GetField(eventName, BindingFlags.Static | BindingFlags.NonPublic);
        if (ReferenceEquals(fieldInfo, null)) throw new ArgumentException(
            string.Concat("The control ", typeof(T).Name, " does not have a property with the name \"", eventName, "\""), nameof(eventName));
        object eventInstance = fieldInfo.GetValue(target);
        PropertyInfo propInfo = typeof(T).GetProperty("Events", BindingFlags.NonPublic | BindingFlags.Instance);
        EventHandlerList list = (EventHandlerList)propInfo.GetValue(target, null);
        list.RemoveHandler(eventInstance, list[eventInstance]);
    }
} 
```

现在，这个扩展的用法。如果您需要从按钮中删除点击事件，

```
Button button = new Button();
button.RemoveEvents(nameof(button.EventClick)); 
```

如果您需要从面板中删除双击事件，

```
Panel panel = new Panel();
panel.RemoveEvents(nameof(panel.EventDoubleClick)); 
```

我不是 C# 方面的专家，所以如果有任何错误，请原谅我并请告诉我。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-04-22T10:58:03.953

斯蒂芬是对的。这很容易：

```
public event EventHandler<Cles_graph_doivent_etre_redessines> les_graph_doivent_etre_redessines;
public void remove_event()
{
    if (this.les_graph_doivent_etre_redessines != null)
    {
        foreach (EventHandler<Cles_graph_doivent_etre_redessines> F_les_graph_doivent_etre_redessines in this.les_graph_doivent_etre_redessines.GetInvocationList())
        {
            this.les_graph_doivent_etre_redessines -= F_les_graph_doivent_etre_redessines;
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-07-27T13:38:46.920

哇。我找到了这个解决方案，但没有像我想要的那样工作。但这太好了：

```
EventHandlerList listaEventos;

private void btnDetach_Click(object sender, EventArgs e)
{
    listaEventos = DetachEvents(comboBox1);
}

private void btnAttach_Click(object sender, EventArgs e)
{
    AttachEvents(comboBox1, listaEventos);
}

public EventHandlerList DetachEvents(Component obj)
{
    object objNew = obj.GetType().GetConstructor(new Type[] { }).Invoke(new object[] { });
    PropertyInfo propEvents = obj.GetType().GetProperty("Events", BindingFlags.NonPublic | BindingFlags.Instance);

    EventHandlerList eventHandlerList_obj = (EventHandlerList)propEvents.GetValue(obj, null);
    EventHandlerList eventHandlerList_objNew = (EventHandlerList)propEvents.GetValue(objNew, null);

    eventHandlerList_objNew.AddHandlers(eventHandlerList_obj);
    eventHandlerList_obj.Dispose();

    return eventHandlerList_objNew;
}

public void AttachEvents(Component obj, EventHandlerList eventos)
{
    PropertyInfo propEvents = obj.GetType().GetProperty("Events", BindingFlags.NonPublic | BindingFlags.Instance);

    EventHandlerList eventHandlerList_obj = (EventHandlerList)propEvents.GetValue(obj, null);

    eventHandlerList_obj.AddHandlers(eventos);
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-04-05T17:15:52.160

聚会有点晚了，但我使用了这个对我来说效果很好的链接： [https ://www.codeproject.com/Articles/103542/Removing-Event-Handlers-using-Reflection](https://www.codeproject.com/Articles/103542/Removing-Event-Handlers-using-Reflection)

这段代码的美妙之处在于它适用于所有人，WFP、Forms、Xamarin Forms。我将它用于 Xamarin。请注意，仅当您不拥有此事件时才需要这种使用反射的方式（例如，在您不关心的某些事件上崩溃的库代码）。

这是我稍作修改的代码：

```
 static Dictionary<Type, List<FieldInfo>> dicEventFieldInfos = new Dictionary<Type, List<FieldInfo>>();

    static BindingFlags AllBindings
    {
        get { return BindingFlags.IgnoreCase | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Static; }
    }

    static void BuildEventFields(Type t, List<FieldInfo> lst)
    {
        foreach (EventInfo ei in t.GetEvents(AllBindings))
        {
            Type dt = ei.DeclaringType;
            FieldInfo fi = dt.GetField(ei.Name, AllBindings);
            if (fi != null)
                lst.Add(fi);
        }
    }
    static List<FieldInfo> GetTypeEventFields(Type t)
    {
        if (dicEventFieldInfos.ContainsKey(t))
            return dicEventFieldInfos[t];

        List<FieldInfo> lst = new List<FieldInfo>();
        BuildEventFields(t, lst);
        dicEventFieldInfos.Add(t, lst);
        return lst;
    }
    static EventHandlerList GetStaticEventHandlerList(Type t, object obj)
    {
        MethodInfo mi = t.GetMethod("get_Events", AllBindings);
        return (EventHandlerList)mi.Invoke(obj, new object[] { });
    }
    public static void RemoveEventHandler(object obj, string EventName = "")
    {
        if (obj == null)
            return;

        Type t = obj.GetType();
        List<FieldInfo> event_fields = GetTypeEventFields(t);
        EventHandlerList static_event_handlers = null;

        foreach (FieldInfo fi in event_fields)
        {
            if (EventName != "" && string.Compare(EventName, fi.Name, true) != 0)
                continue;
            var eventName = fi.Name;
            // After hours and hours of research and trial and error, it turns out that
            // STATIC Events have to be treated differently from INSTANCE Events...
            if (fi.IsStatic)
            {
                // STATIC EVENT
                if (static_event_handlers == null)
                    static_event_handlers = GetStaticEventHandlerList(t, obj);

                object idx = fi.GetValue(obj);
                Delegate eh = static_event_handlers[idx];
                if (eh == null)
                    continue;

                Delegate[] dels = eh.GetInvocationList();
                if (dels == null)
                    continue;

                EventInfo ei = t.GetEvent(eventName, AllBindings);
                foreach (Delegate del in dels)
                    ei.RemoveEventHandler(obj, del);
            }
            else
            {
                // INSTANCE EVENT
                EventInfo ei = t.GetEvent(eventName, AllBindings);
                if (ei != null)
                {
                    object val = fi.GetValue(obj);
                    Delegate mdel = (val as Delegate);
                    if (mdel != null)
                    {
                        foreach (Delegate del in mdel.GetInvocationList())
                        {
                            ei.RemoveEventHandler(obj, del);
                        }
                    }
                }
            }
        }
    } 
```

示例用法：RemoveEventHandler(obj, "Focused");

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-16T17:50:35.310

有时我们必须使用第三方控件，我们需要构建这些笨拙的解决方案。基于@Anoop Muraleedharan 的回答，我创建了这个具有推理类型和 ToolStripItem 支持的解决方案

```
 public static void RemoveItemEvents<T>(this T target, string eventName) 
        where T : ToolStripItem
    {            
        RemoveObjectEvents<T>(target, eventName);
    }

    public static void RemoveControlEvents<T>(this T target, string eventName)
        where T : Control
    {
        RemoveObjectEvents<T>(target, eventName);
    }

    private static void RemoveObjectEvents<T>(T target, string Event) where T : class
    {
        var typeOfT = typeof(T);
        var fieldInfo = typeOfT.BaseType.GetField(
            Event, BindingFlags.Static | BindingFlags.NonPublic);
        var provertyValue = fieldInfo.GetValue(target);
        var propertyInfo = typeOfT.GetProperty(
            "Events", BindingFlags.NonPublic | BindingFlags.Instance);
        var eventHandlerList = (EventHandlerList)propertyInfo.GetValue(target, null);
        eventHandlerList.RemoveHandler(provertyValue, eventHandlerList[provertyValue]);
    } 
```

你可以像这样使用它

```
 var toolStripButton = new ToolStripButton();
    toolStripButton.RemoveItemEvents("EventClick");

    var button = new Button();
    button.RemoveControlEvents("EventClick"); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-02-18T17:42:03.100

删除按钮的所有处理程序：save.RemoveEvents();

```
public static class EventExtension
{
    public static void RemoveEvents<T>(this T target) where T : Control
    {
       var propInfo = typeof(T).GetProperty("Events", BindingFlags.NonPublic | BindingFlags.Instance);
        var list = (EventHandlerList)propInfo.GetValue(target, null);
        list.Dispose();
    }
} 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2011-10-26T07:05:46.733

好吧，这里有另一个解决方案来删除关联事件（如果您已经有处理控件事件的方法）：

```
EventDescriptor ed = TypeDescriptor.GetEvents(this.button1).Find("MouseDown",true);            
Delegate delegate = Delegate.CreateDelegate(typeof(EventHandler), this, "button1_MouseDownClicked");
if(ed!=null) 
    ed.RemoveEventHandler(this.button1, delegate); 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-06-29T11:43:35.687

这不是对 OP 的回答，但我想我会在这里发布，以防它可以帮助其他人。

```
 /// <summary>
  /// Method to remove a (single) SocketAsyncEventArgs.Completed event handler. This is 
  /// partially based on information found here: http://stackoverflow.com/a/91853/253938
  /// 
  /// But note that this may not be a good idea, being very .Net implementation-dependent. Note 
  /// in particular use of "m_Completed" instead of "Completed".
  /// </summary>
  private static void RemoveCompletedEventHandler(SocketAsyncEventArgs eventArgs)
  {
     FieldInfo fieldInfo = typeof(SocketAsyncEventArgs).GetField("m_Completed", 
                                                BindingFlags.Instance | BindingFlags.NonPublic);
     eventArgs.Completed -= (EventHandler<SocketAsyncEventArgs>)fieldInfo.GetValue(eventArgs);
  } 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2010-03-04T20:17:44.610

我找到了这个答案，它几乎符合我的需求。感谢 SwDevMan81 的课程。我已经修改它以允许抑制和恢复个别方法，我想我会在这里发布。

```
// This class allows you to selectively suppress event handlers for controls.  You instantiate
// the suppressor object with the control, and after that you can use it to suppress all events
// or a single event.  If you try to suppress an event which has already been suppressed
// it will be ignored.  Same with resuming; you can resume all events which were suppressed,
// or a single one.  If you try to resume an un-suppressed event handler, it will be ignored.

//cEventSuppressor _supButton1 = null;
//private cEventSuppressor SupButton1 {
//    get {
//        if (_supButton1 == null) {
//            _supButton1 = new cEventSuppressor(this.button1);
//        }
//        return _supButton1;
//    }
//}
//private void button1_Click(object sender, EventArgs e) {
//    MessageBox.Show("Clicked!");
//}

//private void button2_Click(object sender, EventArgs e) {
//    SupButton1.Suppress("button1_Click");
//}

//private void button3_Click(object sender, EventArgs e) {
//    SupButton1.Resume("button1_Click");
//}
using System;
using System.Collections.Generic;
using System.Text;

using System.Reflection;
using System.Windows.Forms;
using System.ComponentModel;

namespace Crystal.Utilities {
    public class cEventSuppressor {
        Control _source;
        EventHandlerList _sourceEventHandlerList;
        FieldInfo _headFI;
        Dictionary<object, Delegate[]> suppressedHandlers = new Dictionary<object, Delegate[]>();
        PropertyInfo _sourceEventsInfo;
        Type _eventHandlerListType;
        Type _sourceType;

        public cEventSuppressor(Control control) {
            if (control == null)
                throw new ArgumentNullException("control", "An instance of a control must be provided.");

            _source = control;
            _sourceType = _source.GetType();
            _sourceEventsInfo = _sourceType.GetProperty("Events", BindingFlags.Instance | BindingFlags.NonPublic);
            _sourceEventHandlerList = (EventHandlerList)_sourceEventsInfo.GetValue(_source, null);
            _eventHandlerListType = _sourceEventHandlerList.GetType();
            _headFI = _eventHandlerListType.GetField("head", BindingFlags.Instance | BindingFlags.NonPublic);
        }
        private Dictionary<object, Delegate[]> BuildList() {
            Dictionary<object, Delegate[]> retval = new Dictionary<object, Delegate[]>();
            object head = _headFI.GetValue(_sourceEventHandlerList);
            if (head != null) {
                Type listEntryType = head.GetType();
                FieldInfo delegateFI = listEntryType.GetField("handler", BindingFlags.Instance | BindingFlags.NonPublic);
                FieldInfo keyFI = listEntryType.GetField("key", BindingFlags.Instance | BindingFlags.NonPublic);
                FieldInfo nextFI = listEntryType.GetField("next", BindingFlags.Instance | BindingFlags.NonPublic);
                retval = BuildListWalk(retval, head, delegateFI, keyFI, nextFI);
            }
            return retval;
        }

        private Dictionary<object, Delegate[]> BuildListWalk(Dictionary<object, Delegate[]> dict,
                                    object entry, FieldInfo delegateFI, FieldInfo keyFI, FieldInfo nextFI) {
            if (entry != null) {
                Delegate dele = (Delegate)delegateFI.GetValue(entry);
                object key = keyFI.GetValue(entry);
                object next = nextFI.GetValue(entry);

                if (dele != null) {
                    Delegate[] listeners = dele.GetInvocationList();
                    if (listeners != null && listeners.Length > 0) {
                        dict.Add(key, listeners);
                    }
                }
                if (next != null) {
                    dict = BuildListWalk(dict, next, delegateFI, keyFI, nextFI);
                }
            }
            return dict;
        }
        public void Resume() {
        }
        public void Resume(string pMethodName) {
            //if (_handlers == null)
            //    throw new ApplicationException("Events have not been suppressed.");
            Dictionary<object, Delegate[]> toRemove = new Dictionary<object, Delegate[]>();

            // goes through all handlers which have been suppressed.  If we are resuming,
            // all handlers, or if we find the matching handler, add it back to the
            // control's event handlers
            foreach (KeyValuePair<object, Delegate[]> pair in suppressedHandlers) {

                for (int x = 0; x < pair.Value.Length; x++) {

                    string methodName = pair.Value[x].Method.Name;
                    if (pMethodName == null || methodName.Equals(pMethodName)) {
                        _sourceEventHandlerList.AddHandler(pair.Key, pair.Value[x]);
                        toRemove.Add(pair.Key, pair.Value);
                    }
                }
            }
            // remove all un-suppressed handlers from the list of suppressed handlers
            foreach (KeyValuePair<object, Delegate[]> pair in toRemove) {
                for (int x = 0; x < pair.Value.Length; x++) {
                    suppressedHandlers.Remove(pair.Key);
                }
            }
            //_handlers = null;
        }
        public void Suppress() {
            Suppress(null);
        }
        public void Suppress(string pMethodName) {
            //if (_handlers != null)
            //    throw new ApplicationException("Events are already being suppressed.");

            Dictionary<object, Delegate[]> dict = BuildList();

            foreach (KeyValuePair<object, Delegate[]> pair in dict) {
                for (int x = pair.Value.Length - 1; x >= 0; x--) {
                    //MethodInfo mi = pair.Value[x].Method;
                    //string s1 = mi.Name; // name of the method
                    //object o = pair.Value[x].Target;
                    // can use this to invoke method    pair.Value[x].DynamicInvoke
                    string methodName = pair.Value[x].Method.Name;

                    if (pMethodName == null || methodName.Equals(pMethodName)) {
                        _sourceEventHandlerList.RemoveHandler(pair.Key, pair.Value[x]);
                        suppressedHandlers.Add(pair.Key, pair.Value);
                    }
                }
            }
        }
    } 
} 
```

# sql - 如何删除表中的重复行

> ID：91784
> 
> 赞同：14
> 
> 时间：2008-09-18T11:35:27.290
> 
> 标签：sql, sql-server, database

我有一张桌子，说 3 列。没有主键，所以可以有重复的行。我只需要保留一个并删除其他的。知道如何做到这一点是 Sql Server 吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-18T11:37:31.247

我会选择 DISTINCT 行并将它们放入临时表中，然后删除源表并从临时表中复制回数据。 **编辑：**现在有代码片段！

```
INSERT INTO TABLE_2 
SELECT DISTINCT * FROM TABLE_1
GO
DELETE FROM TABLE_1
GO
INSERT INTO TABLE_1
SELECT * FROM TABLE_2
GO 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T11:36:59.517

添加一个标识列作为代理主键，并使用它来标识要删除的三行中的两行。

之后我会考虑将标识列保留在原位，或者如果这是某种链接表，请在其他列上创建一个复合主键。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T12:16:11.793

当您的 PK 只是所有表列的子集时，以下示例也适用。

（注意：我更喜欢插入另一个代理 id 列的方法。但也许这个解决方案也很方便。）

首先找到重复的行：

```
SELECT col1, col2, count(*)
FROM t1
GROUP BY col1, col2
HAVING count(*) > 1 
```

如果只有少数，您可以手动删除它们：

```
set rowcount 1
delete from t1
where col1=1 and col2=1 
```

“rowcount”的值应该是重复次数的 n-1 倍。在此示例中，有 2 个重复项，因此行数为 1。如果您获得多个重复行，则必须对每个唯一主键执行此操作。

如果您有很多重复项，则将每个键复制一次到另一个表中：

```
SELECT col1, col2, col3=count(*)
INTO holdkey
FROM t1
GROUP BY col1, col2
HAVING count(*) > 1 
```

然后复制密钥，但消除重复项。

```
SELECT DISTINCT t1.*
INTO holddups
FROM t1, holdkey
WHERE t1.col1 = holdkey.col1
AND t1.col2 = holdkey.col2 
```

在您的密钥中，您现在拥有唯一的密钥。检查你是否没有得到任何结果：

```
SELECT col1, col2, count(*)
FROM holddups
GROUP BY col1, col2 
```

从原始表中删除重复项：

```
DELETE t1
FROM t1, holdkey
WHERE t1.col1 = holdkey.col1
AND t1.col2 = holdkey.col2 
```

插入原始行：

```
INSERT t1 SELECT * FROM holddups 
```

顺便说一句，为了完整性：在 Oracle 中，您可以使用一个隐藏字段（rowid）：

```
DELETE FROM our_table
WHERE rowid not in
(SELECT MIN(rowid)
FROM our_table
GROUP BY column1, column2, column3... ; 
```

请参阅：[Microsoft 知识站点](http://support.microsoft.com/kb/139444)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T14:26:59.407

这是[我问这个问题时](https://stackoverflow.com/questions/18932/sql-how-can-i-remove-duplicate-rows)使用的方法-

```
DELETE MyTable 
FROM MyTable
LEFT OUTER JOIN (
   SELECT MIN(RowId) as RowId, Col1, Col2, Col3 
   FROM MyTable 
   GROUP BY Col1, Col2, Col3
) as KeepRows ON
   MyTable.RowId = KeepRows.RowId
WHERE
   KeepRows.RowId IS NULL 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-19T06:52:43.013

这是使用公用表表达式 CTE 的一种方法。它不涉及循环，没有新列或任何东西，也不会导致任何不需要的触发器触发（由于删除+插入）。

受[这篇文章](http://www.databasejournal.com/features/mssql/article.php/3572301)的启发。

```
CREATE TABLE #temp (i INT)

INSERT INTO #temp VALUES (1)
INSERT INTO #temp VALUES (1)
INSERT INTO #temp VALUES (2)
INSERT INTO #temp VALUES (3)
INSERT INTO #temp VALUES (3)
INSERT INTO #temp VALUES (4)

SELECT * FROM #temp

;
WITH [#temp+rowid] AS
(SELECT ROW_NUMBER() OVER (ORDER BY i ASC) AS ROWID, * FROM #temp)
DELETE FROM [#temp+rowid] WHERE rowid IN 
(SELECT MIN(rowid) FROM [#temp+rowid] GROUP BY i HAVING COUNT(*) > 1)

SELECT * FROM #temp

DROP TABLE #temp 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T11:38:27.190

这是一个艰难的情况。在不知道您的特定情况（表格大小等）的情况下，我认为您最好的方法是添加一个标识列，填充它，然后根据它删除。您可以稍后删除该列，但我建议您应该保留它，因为它在表格中确实是一件好事

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T12:45:07.700

清理完当前的混乱后，您可以添加一个包含表中所有字段的主键。这将防止你再次陷入困境。当然，这个解决方案可以很好地破坏现有代码。这也必须处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T14:28:05.503

您可以向表中添加主键标识字段吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T15:17:17.867

Manrico Corazzi - 我专攻 Oracle，而不是 MS SQL，所以你必须告诉我这是否可能作为性能提升：-

1.  保持与第一步相同 - 将不同的值从 TABLE1 插入到 TABLE2 中。
2.  删除表 1。（我认为删除应该比删除快，就像截断比删除快一样）。
3.  将 TABLE2 重命名为 TABLE1（节省您的时间，因为您正在重命名一个对象，而不是将数据从一个表复制到另一个表）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T17:51:25.263

这是另一种方式，使用测试数据

```
create table #table1 (colWithDupes1 int, colWithDupes2 int)
insert into #table1
(colWithDupes1, colWithDupes2)
Select 1, 2 union all
Select 1, 2 union all
Select 2, 2 union all
Select 3, 4 union all
Select 3, 4 union all
Select 3, 4 union all
Select 4, 2 union all
Select 4, 2 

select * from #table1

set rowcount 1
select 1

while @@rowcount > 0
delete #table1  where 1 < (select count(*) from #table1 a2 
   where #table1.colWithDupes1 = a2.colWithDupes1
and #table1.colWithDupes2 = a2.colWithDupes2
)

set rowcount 0

select * from #table1 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T13:53:12.450

怎么样：

```
select distinct * into #t from duplicates_tbl

truncate duplicates_tbl

insert duplicates_tbl select * from #t

drop table #t 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-02T19:56:51.907

这个解决方案怎么样：

首先执行以下查询：

```
 select 'set rowcount ' + convert(varchar,COUNT(*)-1) + ' delete from MyTable where field=''' + field +'''' + ' set rowcount 0'  from mytable group by field having COUNT(*)>1 
```

然后你只需要执行返回的结果集

```
set rowcount 3 delete from Mytable where field='foo' set rowcount 0
....
....
set rowcount 5 delete from Mytable where field='bar' set rowcount 0 
```

当您只有一列时，我已经处理过这种情况，但是很容易将相同的方法应用于不止一列。如果您希望我发布代码，请告诉我。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-09-18T12:51:18.090

我不确定这是否适用于 DELETE 语句，但这是一种查找重复行的方法：

```
 SELECT *
 FROM myTable t1, myTable t2
 WHERE t1.field = t2.field AND t1.id > t2.id 
```

我不确定您是否可以将“SELECT”更改为“DELETE” *（有人想让我知道吗？）*，但即使您不能，您也可以将其变成子查询。

# xml - 用于 XML 命令行处理的 Grep 和 Sed 等效项

> ID：91791
> 
> 赞同：149
> 
> 时间：2008-09-18T11:36:58.067
> 
> 标签：xml, command-line, scripting

在编写 shell 脚本时，通常数据将位于单行记录文件中，例如 csv。`grep`使用和处理这些数据非常简单`sed`。但是我必须经常处理 XML，所以我真的想要一种通过命令行对 XML 数据进行脚本访问的方法。什么是最好的工具？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-09-18T12:14:07.213

我发现 xmlstarlet 在这类事情上非常擅长。

[http://xmlstar.sourceforge.net/](http://xmlstar.sourceforge.net/)

也应该在大多数发行版存储库中可用。介绍性教程在这里：

[http://www.ibm.com/developerworks/library/x-starlet.html](http://www.ibm.com/developerworks/library/x-starlet.html)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-09-18T11:39:59.260

一些有前途的工具：

*   [nokogiri](http://www.nokogiri.org/)：使用 XPath 和 CSS 选择器在 ruby​​ 中解析 HTML/XML DOM

*   [hpricot](https://github.com/hpricot/hpricot "_why 为 ruby​​ 解析 XML/HTML")：已弃用

*   [fxgrep](http://web.archive.org/web/20121027002149/http://www2.in.tum.de:80/~berlea/Fxgrep/ "功能性 XML 查询工具")：使用自己的类似 XPath 的语法来查询文档。用 SML 编写，因此安装可能很困难。

*   [LT XML](http://www.ltg.ed.ac.uk/software/ltxml "LT XML 工具包")：派生自 SGML 工具的 XML 工具包，包括`sggrep`、`sgsort`等 `xmlnorm`。使用自己的查询语法。文档 *非常*正式。用 C 语言编写。LT XML 2 声称支持 XPath、XInclude 和其他 W3C 标准。

*   [xmlgrep2](http://xmltwig.com/tool/xml_grep2/xml_grep2.html)：使用 XPath 进行简单而强大的搜索。使用 XML::LibXML 和 libxml2 用 Perl 编写。

*   [XQSharp](http://www.xqsharp.com/xqsharp/)：支持 XQuery，XPath 的扩展。为 .NET 框架编写。

*   [xml-coreutils](http://www.lbreyer.com/xml-coreutils.html)：Laird Breyer 的工具包，相当于 GNU coreutils。在一篇有趣的[文章](http://www.lbreyer.com/unix_xml-1.html)中讨论了理想的工具包应该包括什么。

*   [xmldiff](http://www.logilab.org/859/)：用于比较两个 xml 文件的简单工具。

*   [xmltk](http://xmltk.sourceforge.net/)：在 debian、ubuntu、fedora 或 macports 中似乎没有包，自 2007 年以来没有发布，并且使用非便携式构建自动化。

xml-coreutils 似乎是文档最齐全且最面向 UNIX 的。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2010-06-22T22:01:13.587

还有`xml2`和`2xml`对。它将允许通常的字符串编辑工具来处理 XML。

例子。q.xml：

```
<?xml version="1.0"?>
<foo>
    text
    more text
    <textnode>ddd</textnode><textnode a="bv">dsss</textnode>
    <![CDATA[ asfdasdsa <foo> sdfsdfdsf <bar> ]]>
</foo> 
```

`xml2 < q.xml`

```
/foo=
/foo=   text
/foo=   more text
/foo=   
/foo/textnode=ddd
/foo/textnode
/foo/textnode/@a=bv
/foo/textnode=dsss
/foo=
/foo=    asfdasdsa <foo> sdfsdfdsf <bar> 
/foo= 
```

`xml2 < q.xml | grep textnode | sed 's!/foo!/bar/baz!' | 2xml`

```
<bar><baz><textnode>ddd</textnode><textnode a="bv">dsss</textnode></baz></bar> 
```

PS 还有`html2`/ `2html`。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-03-04T08:12:52.080

在 Joseph Holsten 的优秀列表中，我添加了 Perl 库 XML::XPath 附带的 xpath 命令行脚本。从 XML 文件中提取信息的好方法：

```
 xpath -q -e '/entry[@xml:lang="fr"]' *xml 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-01-24T00:41:13.737

您可以使用 xmllint：

```
xmllint --xpath //title books.xml 
```

应该与大多数发行版捆绑在一起，并且还与 Cygwin 捆绑在一起。

```
$ xmllint --version
xmllint: using libxml version 20900 
```

看：

```
$ xmllint
Usage : xmllint [options] XMLfiles ...
        Parse the XML files and output the result of the parsing
        --version : display the version of the XML library used
        --debug : dump a debug tree of the in-memory document
        ...
        --schematron schema : do validation against a schematron
        --sax1: use the old SAX1 interfaces for processing
        --sax: do not build a tree but work just at the SAX level
        --oldxml10: use XML-1.0 parsing rules before the 5th edition
        --xpath expr: evaluate the XPath expression, inply --noout 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-07-29T21:29:56.547

如果您正在寻找 Windows 上的解决方案，Powershell 具有用于读取和写入 XML 的内置功能。

测试.xml：

```
<root>
  <one>I like applesauce</one>
  <two>You sure bet I do!</two>
</root> 
```

Powershell脚本：

```
# load XML file into local variable and cast as XML type.
$doc = [xml](Get-Content ./test.xml)

$doc.root.one                                   #echoes "I like applesauce"
$doc.root.one = "Who doesn't like applesauce?"  #replace inner text of <one> node

# create new node...
$newNode = $doc.CreateElement("three")
$newNode.set_InnerText("And don't you forget it!")

# ...and position it in the hierarchy
$doc.root.AppendChild($newNode)

# write results to disk
$doc.save("./testNew.xml") 
```

testNew.xml：

```
<root>
  <one>Who likes applesauce?</one>
  <two>You sure bet I do!</two>
  <three>And don't you forget it!</three>
</root> 
```

来源：[https ://serverfault.com/questions/26976/update-xml-from-the-command-line-windows](https://serverfault.com/questions/26976/update-xml-from-the-command-line-windows)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-05-30T12:20:37.760

还有 NetBSD xmltools 的 xmlsed 和 xmlgrep！

[http://blog.huoc.org/xmltools-not-dead.html](http://blog.huoc.org/xmltools-not-dead.html)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-18T20:41:16.837

完全取决于你想做什么。

XSLT 可能是要走的路，但有一个学习曲线。试试[xsltproc](http://xmlsoft.org/XSLT/xsltproc.html)，注意可以交参数。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-01-12T14:48:08.333

[`saxon-lint`命令行也](https://github.com/sputnick-dev/saxon-lint)可以使用 XPath 3.0/XQuery 3.0。（其他命令行工具使用 XPath 1.0）。

### 例子 ：

http/html:

```
$ saxon-lint --html --xpath 'count(//a)' http://stackoverflow.com/q/91791
328 
```

xml：

```
$ saxon-lint --xpath '//a[@class="x"]' file.xml 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-09-21T04:38:17.600

D. Bohdan 维护一个开源 GitHub 存储库，其中包含用于结构化文本工具的命令行工具列表，其中有一个用于 XML/HTML 工具的部分：

[https://github.com/dbohdan/structured-text-tools#xml-html](https://github.com/dbohdan/structured-text-tools#xml-html)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-30T23:12:49.840

XQuery 可能是一个很好的解决方案。它（相对）容易学习并且是 W3C 标准。

我会推荐[XQSharp](http://www.xqsharp.com)作为命令行处理器。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-03-16T03:21:13.483

我第一次使用**xmlstarlet**并且仍在使用它。当查询变得困难时，我需要 XML 的*xpath2*和*xquery*功能支持我转向**xidel** [http://www.videlibri.de/xidel.html](http://www.videlibri.de/xidel.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-03-14T16:03:53.020

# Grep 等价物

您可以定义一个 bash 函数，比如包装一些 python3 代码的“xp”（“xpath”）。要使用它，您需要安装 python3 和 python-lxml。好处：

1.  您在例如 xmllint 中缺少的正则表达式匹配。
2.  在命令行上用作过滤器（在管道中）

像这样使用它既简单又强大：

```
xmldoc=$(cat <<EOF
<?xml version="1.0" encoding="utf-8"?>
<job xmlns="http://www.sample.com/">programming</job>
EOF
)
selection='//*[namespace-uri()="http://www.sample.com/" and local-name()="job" and re:test(.,"^pro.*ing$")]/text()'
echo "$xmldoc" | xp "$selection"
# prints programming 
```

xp() 看起来像这样：

```
xp()
{ 
local selection="$1";
local xmldoc;
if ! [[ -t 0 ]]; then
    read -rd '' xmldoc;
else
    xmldoc="$2";
fi;
python3 <(printf '%b' "from lxml.html import tostring\nfrom lxml import etree\nfrom sys import stdin\nregexpNS = \"http://exslt.org/regular-expressions\"\ntree = etree.parse(stdin)\nfor e in tree.xpath('""$selection""', namespaces={'re':regexpNS}):\n  if isinstance(e, str):\n    print(e)\n  else:\n    print(tostring(e).decode('UTF-8'))") <<< "$xmldoc"
} 
```

# Sed 等价物

考虑使用 xq，它可以为您提供 jq“编程语言”的全部功能。如果您安装了 python-pip，您可以使用 pip install **yq**安装 xq ，然后在下面的示例中，我们将“Keep Accounts”替换为“Keep Accounts 2”：

```
xmldoc=$(cat <<'EOF'
<resources>
    <string name="app_name">Keep Accounts</string>
    <string name="login">"login"</string>
    <string name="login_password">"password："</string>
    <string name="login_account_hint">input to login</string>
    <string name="login_password_hint">input your password</string>
    <string name="login_fail">login failed</string>
</resources>
EOF
)
echo "$xmldoc" | xq '.resources.string = ([.resources.string[]|select(."#text" == "Keep Accounts") ."#text" = "Keep Accounts 2"])' -x 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-09-18T11:47:15.890

JEdi​​t 有一个名为“XQuery”的插件，它为 XML 文档提供查询功能。

不完全是命令行，但它可以工作！

# sharepoint - 按更多列对 SharePoint 搜索结果进行排序

> ID：91800
> 
> 赞同：2
> 
> 时间：2008-09-18T11:39:48.653
> 
> 标签：sharepoint, search, moss

我在 SharePoint 2007 (MOSS) 中使用 FullTextSqlQuery，需要按两列对结果进行排序：

```
SELECT WorkId FROM SCOPE() ORDER BY Author ASC, Rank DESC 
```

但是，返回结果时似乎只考虑了 ORDER BY 的第一列。在这种情况下，结果按作者正确排序，而不是按排名。如果我更改顺序，结果将按排名排序，而不是按作者排序。

我不得不求助于我自己对结果的排序，这我不太喜欢。有没有人解决这个问题？

**编辑**：不幸的是，它也不接受 ORDER BY 子句中的表达式（SharePoint 抛出异常）。我的猜测是，即使查询看起来像合法的 SQL，它也会在提供给 SQL 服务器之前以某种方式进行解析。

我尝试使用 SQL Profiler 捕获查询，但无济于事。

**编辑2**：最后我使用了单列排序（在我的例子中是作者，因为它是最重要的）并在结果的前N个代码中进行了第二次排序。对项目来说足够好，但留下了笨拙的代码的不好感觉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:09:27.787

微软*终于*发布了一篇关于这个问题的知识库文章。

“在 SharePoint 搜索查询的 ORDER BY 子句中使用 RANK 时，不应使用其他属性”

[http://support.microsoft.com/kb/970830](http://support.microsoft.com/kb/970830)

症状：在 SharePoint 搜索查询的 ORDER BY 子句中使用 RANK 时，结果中仅使用第一个 ORDER BY 列。

原因：RANK 是在全文索引中排名的特殊属性，因此不能与其他托管属性一起使用。

解决方法：不要将多个属性与 RANK 属性结合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T18:54:29.627

Rank 是 MOSS FullTextSqlQuery 中的一个特殊列，它为每个结果的排名提供一个数值。对于每个查询，该值将不同，并且与*该*特定查询的其他结果相关。因为这个排名应该对每个结果都有一个唯一的值，并且按排名排序然后作者将与仅按排名排序相同。我会尝试对另一列进行排序而不是排名，以查看结果是否按预期返回，如果是这样，您的问题可能与 MOSS 对结果进行排名的方式有关，这对于每个唯一查询都会有所不同。

你也是对的，查询看起来像 SQL，但它不是实际传递给 SQL 服务器的查询，它是特殊的 Microsoft Enterprise Search SQL 查询语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T18:41:19.117

我也遇到了与 FullTextSqlQuery 和 MOSS 2007 相同的问题，其中仅尊重多列“ORDER BY”中的第一列。

我在 SharePoint 搜索的 MSDN 论坛中输入了这个主题，但没有收到任何回复：

[http://social.msdn.microsoft.com/Forums/en-US/sharepointsearch/thread/489b4f29-4155-4c3b-b493-b2fad687ee56](http://social.msdn.microsoft.com/Forums/en-US/sharepointsearch/thread/489b4f29-4155-4c3b-b493-b2fad687ee56)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T15:20:49.883

我在 SharePoint 方面没有经验，但如果是只有一个 ORDER BY 子句受到尊重的情况，我会将其更改为表达式而不是列。假设“Rank”是最大值为 10 的数字列，则以下可能有效：

```
SELECT WorkId FROM SCOPE() ORDER BY AUTHOR + (10 - Rank) ASC 
```

# mysql - Wordpress 博客真正需要什么数据库权限？

> ID：91805
> 
> 赞同：9
> 
> 时间：2008-09-18T11:41:27.213
> 
> 标签：mysql, wordpress, privileges

我正在建立一些 Wordpress 博客网站。我在 mysql 中创建了一个用户，wordpress 将使用它来访问其数据库。文档说要授予该用户对数据库的所有权限。

它真的需要完全特权吗？我希望不会，所以有人知道它真正需要的最小权限集吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T11:44:48.593

我不是 Wordpress 专家，但我建议它实际上拥有除 GRANT 之外的所有权限。它需要能够创建表和插入/更新等。几个插件使用自己的表，如果它们不存在，它们会即时创建。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-07T22:13:20.927

我同意：

*   改变
*   创造
*   创建临时表
*   删除
*   降低
*   指数
*   插入
*   锁定表
*   选择
*   更新

希望能帮助其他任何对此进行调查的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-06T18:39:53.830

在 myblog 上授予选择、插入、删除、更新、创建、删除、更改

# python - python数据有漂亮的打印机吗？

> ID：91810
> 
> 赞同：20
> 
> 时间：2008-09-18T11:43:45.413
> 
> 标签：python, prettify

以交互方式使用 python，有时需要显示一个任意复杂的数据结构的结果（例如带有嵌入列表的列表等）。显示它们的默认方式只是一个巨大的线性转储，它只是一遍又一遍地包裹，你有仔细解析阅读它。

有没有什么东西可以接受任何 python 对象并以更合理的方式显示它。例如

```
[0, 1,
    [a, b, c],
    2, 3, 4] 
```

代替：

```
[0, 1, [a, b, c], 2, 3, 4] 
```

我知道这不是一个很好的例子，但我想你明白了。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-18T11:44:54.990

```
from pprint import pprint
a = [0, 1, ['a', 'b', 'c'], 2, 3, 4]
pprint(a) 
```

请注意，对于像我的示例这样的简短列表， pprint 实际上会将其全部打印在一行上。但是，对于更复杂的结构，它可以很好地打印数据。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T12:55:39.547

有时[YAML](http://pyyaml.org/)可以很好地解决这个问题。

```
import yaml
a = [0, 1, ['a', 'b', 'c'], 2, 3, 4]
print yaml.dump(a) 
```

产生：

```
- 0
- 1
- [a, b, c]
- 2
- 3
- 4 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T14:56:26.557

除了`pprint.pprint`,`pprint.pformat`对于制作可读`__repr__`的 s 非常有用。我的 complex `__repr__`s 通常是这样的：

```
def __repr__(self):
    from pprint import pformat

    return "<ClassName %s>" % pformat({"attrs":self.attrs,
                                       "that_i":self.that_i,
                                       "care_about":self.care_about}) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T12:15:04.760

另一个不错的选择是使用[IPython](http://ipython.scipy.org/moin/)，它是一个具有许多额外功能的交互式环境，包括自动漂亮的打印、方法的制表符补全、简单的 shell 访问等等。它也很容易安装。

[IPython 教程](http://ipython.scipy.org/doc/manual/html/interactive/tutorial.html)

# c# - C# 中变量名中 @ 字符的用途/含义是什么？

> ID：91817
> 
> 赞同：323
> 
> 时间：2008-09-18T11:44:52.773
> 
> 标签：c#, variables, naming, specifications, reserved-words

我发现您可以在 C# 中以“@”字符开头变量名。在我的 C# 项目中，我使用了一个用 Java 编写的 Web 服务（我向我的项目添加了一个 Web 引用）。WSDL 中定义的接口对象之一有一个名为“params”的成员变量。显然，这是 C# 中的保留字，因此您不能拥有具有名称为“params”的成员变量的类。生成的代理对象包含如下所示的属性：

```
public ArrayList @params {
    get { return this.paramsField; }
    set { this.paramsField = value; }
} 
```

我搜索了 VS 2008 c# 文档，但找不到任何相关信息。也搜索谷歌并没有给我任何有用的答案。那么变量/属性名称中“@”字符的确切含义或用法是什么？

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2008-09-18T12:24:52.490

直接来自[C# 语言规范](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/)，[标识符 (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/lexical-structure#identifiers) ：

> 前缀“@”允许使用关键字作为标识符，这在与其他编程语言交互时很有用。字符 @ 实际上不是标识符的一部分，因此标识符在其他语言中可能被视为普通标识符，没有前缀。带有@ 前缀的标识符称为逐字标识符。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-09-18T11:45:34.207

它只是让您使用保留字作为变量名。恕我直言，不推荐（除非您有这种情况）。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-09-18T12:01:57.477

在 C# 中，at (@) 字符用于表示明确不遵守语言规范中相关规则的文字。

具体来说，它可用于与保留关键字冲突的变量名称（例如，您不能使用 params，但可以使用 @params 代替，与语言规范中的 out/ref/任何其他关键字相同）。此外，它还可用于未转义的字符串文字；这与路径常量特别相关，例如，`path = "c:\\temp\\somefile.txt"`您可以编写`path = @"c:\temp\somefile.txt"`. 它对正则表达式也非常有用。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-15T10:58:08.263

与 Perl 的符号不同`@`，C# 中变量名前的前缀没有意义。If`x`是一个变量，`@x`是同一变量的另一个名称。

```
> string x = "abc";
> Object.ReferenceEquals(x, @x).Dump();
True 
```

但是正如您所发现的那样，`@`前缀确实有一个*用途*- 您可以使用它来阐明 C# 否则会拒绝为非法的变量名称。

```
> string string;
Identifier expected; 'string' is a keyword

> string @string; 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-04-03T12:48:39.027

该`@`符号允许您使用保留关键字作为变量名。像`@int`, `@string`,`@double`等等

例如：

```
string @public = "Reserved Keyword used for me and its fine"; 
```

上面的代码工作正常，但下面的代码不起作用：

```
string public = "This will not compile"; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-18T11:46:42.270

它只是允许您使用保留字作为变量名。前几天我想要一个 var `event`。我本来打算去的`_event`，但我的同事提醒我，我可以打电话给它`@event`。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-12-03T17:43:24.937

另一个用例是扩展方法。第一个，特殊参数可以用`@this`名称来区分来表示它的真正含义。一个例子：

```
public static TValue GetValueOrDefault<TKey, TValue>(
    this IDictionary<TKey, TValue> @this,
    TKey key,
    TValue defaultValue)
    {
        if (!@this.ContainsKey(key))
        {
            return defaultValue;
        }

        return @this[key];
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T07:06:25.740

如果我们使用关键字作为标识符的名称，我们会得到一个编译器错误“identifier expected, 'Identifier Name' is a keyword”。要克服此错误，请在标识符前加上“@”。这样的标识符是逐字标识符。字符 @ 实际上不是标识符的一部分，因此标识符在其他语言中可能被视为普通标识符，没有前缀

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-15T14:26:48.663

您可以使用它来使用保留关键字作为变量名，例如

```
 int @int = 3; 
```

编译器将忽略`@`并将变量编译为`int`

使用思想不是一种常见的做法

# python - Google App Engine：如何以编程方式访问模型类的属性？

> ID：91821
> 
> 赞同：8
> 
> 时间：2008-09-18T11:45:16.953
> 
> 标签：python, string, google-app-engine

我有一个模型类：

```
class Person(db.Model):
  first_name = db.StringProperty(required=True)
  last_name = db.StringProperty(required=True) 
```

我有一个此类的实例`p`，并且字符串`s`包含该值`'first_name'`。我想做类似的事情：

```
print p[s] 
```

和

```
p[s] = new_value 
```

这两者都会导致`TypeError`.

有人知道我怎样才能实现我想要的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T12:14:37.367

如果模型类足够智能，它应该能够识别标准的 Python 方法。

尝试：

```
getattr(p, s)
setattr(p, s, new_value) 
```

也有 hasattr 可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:46:08.817

非常感谢吉姆，我正在寻找的确切解决方案是：

```
p.properties()[s].get_value_for_datastore(p) 
```

感谢所有其他受访者的帮助。我也希望 Model 类实现这样做的 python 标准方式，但无论出于何种原因，它都没有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T11:54:13.283

```
getattr(p, s)
setattr(p, s, new_value) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:06:25.517

尝试：

```
p.model_properties()[s].get_value_for_datastore(p) 
```

请参阅[文档](http://code.google.com/appengine/docs/datastore/propertyclass.html#Property_get_value_for_datastore)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-04T07:10:55.510

p.first_name = "新名字" p.put()

或 p = Person(first_name = "Firsty", last_name = "Lasty") p.put()

# delphi - 适用于德尔福 2006/德尔福 2007/德尔福 2009 的 FitNesse

> ID：91826
> 
> 赞同：5
> 
> 时间：2008-09-18T11:46:16.017
> 
> 标签：delphi, fitnesse, fit-framework

是否有适用于 Delphi 2006/2007/2009 的 FitNesse 版本？

如果是这样，我在哪里可以找到它？

在 Delphi 2006 上是否有任何其他程序，如 FitNesse？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T12:06:01.727

Fitnesse 支持 Delphi。请参阅 Fitnesse.org 上的[FitServers](http://www.fitnesse.org/FrontPage.FitServers)页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T12:14:23.873

编辑：

[delphixtreme](http://delphixtreme.com/wordpress/?page_id=4) 的 Delphi fit 服务器**现在可以工作了**

代码保存[在这里](http://code.google.com/p/fit4delphi/)

# c# - 检测 Web.Config 认证模式

> ID：91831
> 
> 赞同：14
> 
> 时间：2008-09-18T11:47:15.063
> 
> 标签：c#, asp.net, authentication, web-config

假设我有以下 web.config：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.web>
        <authentication mode="Windows"></authentication>
    </system.web>
</configuration> 
```

使用 ASP.NET C#，如何检测 Authentication 标签的 Mode 值？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-18T11:50:09.737

身份验证部分的模式属性：[AuthenticationSection.Mode 属性 (System.Web.Configuration)](http://msdn.microsoft.com/en-us/library/system.web.configuration.authenticationsection.mode(VS.80).aspx)。你甚至可以修改它。

```
// Get the current Mode property.
AuthenticationMode currentMode = 
    authenticationSection.Mode;

// Set the Mode property to Windows.
authenticationSection.Mode = 
    AuthenticationMode.Windows; 
```

本文介绍[如何获取对 AuthenticationSection 的引用](http://msdn.microsoft.com/en-us/library/system.web.configuration.authenticationsection(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-08-14T00:07:59.380

导入`System.Web.Configuration`命名空间并执行以下操作：

```
var configuration = WebConfigurationManager.OpenWebConfiguration("/");
var authenticationSection = (AuthenticationSection)configuration.GetSection("system.web/authentication");
if (authenticationSection.Mode == AuthenticationMode.Forms)
{
  //do something
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-09-26T09:12:37.997

您也可以通过使用静态 [`ConfigurationManager`](https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager(v=vs.110).aspx)类获取部分然后获取枚举来获取身份验证模式`AuthenticationMode`。

```
AuthenticationMode authMode = ((AuthenticationSection) ConfigurationManager.GetSection("system.web/authentication")).Mode; 
```

[WebConfigurationManager 和 ConfigurationManager 的区别](https://stackoverflow.com/questions/698157/whats-the-difference-between-the-webconfigurationmanager-and-the-configurationm)

* * *

如果要检索指定枚举中的常量名称，可以使用`Enum.GetName(Type, Object)`方法

```
Enum.GetName(typeof(AuthenticationMode), authMode); // e.g. "Windows" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T11:48:38.757

尝试`Context.User.Identity.AuthenticationType`

去找PB的答案伙计们

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-15T09:51:09.500

在 ASP.Net Core 中，您可以使用：

```
public Startup(IHostingEnvironment env, IConfiguration config)
{
    var enabledAuthTypes = config["IIS_HTTPAUTH"].Split(';').Where(l => !String.IsNullOrWhiteSpace(l)).ToList();
} 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-18T12:03:34.743

使用 xpath 查询 //configuration/system.web/authentication[mode] ？

```
protected void Page_Load(object sender, EventArgs e)
{
 XmlDocument config = new XmlDocument();
 config.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);
 XmlNode node = config.SelectSingleNode("//configuration/system.web/authentication");
 this.Label1.Text = node.Attributes["mode"].Value;
} 
```

# editor - 带调试功能的 D-Editor

> ID：91834
> 
> 赞同：3
> 
> 时间：2008-09-18T11:48:27.727
> 
> 标签：editor, d

我现在已经在 D [(http://www.digitalmars.com/d/)](http://www.digitalmars.com/d/)编程了一段时间。我更喜欢它而不是 Java，因为它更快。但是，我还没有找到支持代码完成和调试（Step-Over、Step-Into、Breakpoints，...）的编辑器。

你有什么建议吗？

PS：gdb 没有工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T11:51:19.967

[Eclipse 插件Descent](http://www.dsource.org/projects/descent)应该支持两者（如果您安装了支持 D 的调试器）。我不得不承认我已经很长时间没有尝试过了，当我这样做时，使用 gdb 进行调试不起作用*。*

另请参阅[此问题](https://stackoverflow.com/questions/50179/an-ide-for-d)

我个人使用目前既不提供完成也不提供调试的 Vim，尽管我知道完成引擎已启动一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T00:57:28.653

我建议您尝试出色的[Code::Blocks](http://www.codeblocks.org) IDE。它对 D 有很好的支持（它甚至可以自动识别 DMD 和/或 GDC D 编译器）。

上面已经提到了另一种选择 - Descent。我没有使用 Descent，因为每当我尝试它时都会遇到问题并且在某些时候我放弃了（这并不意味着它很糟糕，这意味着我只是懒得弄清楚问题是什么）。

C::B 使用 GDB，所以我猜（不确定，没有尝试）您可以使用修补过的 GDB 来调试您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T23:04:54.890

在 Linux 下，我使用 Eclipse (+Descent) 或 gEdit 作为 IDE，并使用 gdb 作为调试器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T04:19:55.770

我也使用血统。我不使用它的调试器位，但那是因为我在 Windows 桌面上进行编辑并在 Linux 服务器上构建/运行/调试。

# .net - 多租户架构和 NHibernate

> ID：91840
> 
> 赞同：3
> 
> 时间：2008-09-18T11:49:34.353
> 
> 标签：.net, nhibernate, domain-driven-design, saas

谁能最终解释一下在 NHibernate 支持的域模型中实现对多租户功能的透明和流畅支持的最佳策略是什么？

我正在寻找方法，如何使域逻辑尽可能地与多租户的东西隔离，比如通过 TenantID 过滤等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T02:12:03.927

最简单的方法是为每个客户端使用不同的数据库。

以这种方式实现多租户可以让您有效地编写单租户应用程序，而只需担心创建/检索会话时的多租户。

我还没有深入研究细节（我需要在几个月内做类似的事情），但我认为管理会话连接到哪个数据库的最简单方法是通过可以确定哪个连接的自定义 ISessionFactory 实现使用（基于外部方面，例如请求 url 的主机部分）。

我至少在网上看到过一篇讨论这个问题的帖子，但目前我找不到链接。

如果您使用的是 Castle Windsor，请查看 NHibernate 集成工具。这支持多个（命名的）会话工厂的概念，这将允许您为每个客户端拥有一个会话工厂。集成工具提供了一个 ISessionManager 接口，它允许您在命名会话工厂上打开会话（以及为 Web 应用程序提供每个请求的会话语义）。任何需要访问会话的东西都可以简单地采用 ISession 构造函数参数，您可以创建一个将 ISessionManager 作为构造函数参数的工厂。然后，您的工厂可以通过检查请求以确定应该使用哪个命名会话工厂来在适当的命名会话工厂上打开一个会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T10:02:28.110

我最近也一直在为我的下一个项目深入研究它。您可以实现自定义 IConnectionProvider 并使用“connection.provider”将其注册到配置中。

我建议您从 DriverConnectionProvider 派生并覆盖 ConnectionString 而不是实现完全自定义的。

它可以是这样的：

```
 public class ContextualConnectionProvider : DriverConnectionProvider
    {

        protected override string ConnectionString
        {
            get
            {
                return GetCurrentTenantDatabaseConnectionStringInternally();
            }
        }

        public override void Configure(IDictionary<string, string> settings)
        {
            ConfigureDriver(settings);
        }

    } 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-06T13:46:30.183

[我在这里](http://blogs.imeta.co.uk/jyoung/archive/2010/03/22/845.aspx)写了一个多租户方法，该方法并不适用于所有情况，但是，它确实可以让您在很大程度上忘记多租户问题，而无需使用 3rd 方产品。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T21:45:50.913

There are a variety of ways to accomplish it, but the issues of [multi](http://www.apprenda.com)-tenancy go deeper than just the data model. I hate to be plugging product, but check out SaaSGrid by my the company I work at, [Apprenda](http://www.apprenda.com).We're a cloud operating system that allows you to write single tenant SOA apps (feel free to use NHibernate for data access) that automatically injects multi-tenancy into your app. When you publish your app, you can do things like choose a data model (isolated database or shared) and SaaSGrid will deploy accordingly and your app will run without any code changes - just write code as if it were for a single tenant!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T11:55:24.747

[Ayende](http://www.ayende.com/Blog/archive/2008/08/06/Multi-Tenancy.aspx)有一些关于构建多租户应用程序的优秀博客文章。如何使用 NHibernate 取决于您要使用的多租户类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-20T21:16:07.157

使用共享模式方法需要您拦截并使用附加信息修饰所有查询以限制结果。

NHibernate 提供了拦截器来做到这一点，事件监听器也可以从 NHibernate 2.0 Aplpha 1 中获得。

请参阅[http://elegantcode.com/2008/05/15/implementing-nhibernate-interceptors/](http://elegantcode.com/2008/05/15/implementing-nhibernate-interceptors/)和[http://www.codinginstinct.com/2008/04/nhibernate-20-events-and-listeners.html](http://www.codinginstinct.com/2008/04/nhibernate-20-events-and-listeners.html)讨论这些。

还可以看看 Ayende 的 Rhino Security 组件，因为他在这方面做了很多工作来修改基于安全描述符的附加限制的查询。您可以在[https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/security浏览源代码](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/security)

# c++ - 如何在 C/C++ 项目中获取所有数据类型大小和函数堆栈占用空间大小？

> ID：91849
> 
> 赞同：1
> 
> 时间：2008-09-18T11:52:31.163
> 
> 标签：c++, c, data-structures, size

我有一个大型继承的 C/C++ 项目。是否有任何好的工具或技术来生成有关所有数据类型的“sizeof”的报告，以及此类项目中每个函数的堆栈足迹的细分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T18:05:27.560

我很想知道你为什么要这样做，但这只是一种好奇。

确定使用的每个类的 sizeof 应该很简单，除非它们已被模板化，在这种情况下，您还必须检查每个实例化。

同样，确定函数的**每次调用**sizeof 也很简单：它是每个传递参数的 sizeof 加上一些函数开销。

要确定整个程序的全部内存使用情况，如果不是全部都是静态定义的，那么没有运行时分析器就无法完成。

编写一个将所有类名收集到一个文件中的 shell 脚本将非常简单。该文件可以构造为 .cpp 文件，该文件是对每个类的 sizeof 的一系列调用。如果该文件还#included 每个头文件，则可以编译并运行它以获取仅类的内存占用的输出。

同样，剔除所有函数定义以查看它们何时不使用引用或指针参数（即将整个类实例复制到堆栈上）应该非常简单。

所有这一切都说明我不知道现有的工具，但编写一个应该不难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:28:46.577

我不确定现代编译器是否真的存在堆栈占用空间*的概念。*也就是说，我认为确定使用的堆栈空间量取决于所采用的分支，而分支又取决于输入参数，并且通常需要解决停机问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:01:57.737

我不知道有任何工具，但如果您在 MSVC 下工作，您可以使用[DIA SDK](http://msdn.microsoft.com/en-us/library/t6tay6cz(VS.80).aspx)从 .PDB 文件中提取大小信息。可悲的是，这不适用于堆栈足迹 IIRC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-11T14:03:36.043

我正在寻找有关函数堆栈占用空间的相同信息，但我不相信沃伦所说的是真的。是的，影响函数中堆栈的部分原因是参数，但我还发现函数中的每个局部变量，无论所述变量的范围如何，都用于确定为功能。

在我正在使用的特别糟糕的代码示例中，有超过 200 个本地类实例，每个实例都由 if (blah-blah) 子句保护，但保留的堆栈空间由这些保护的局部变量修改。

我知道我需要的是能够读取每种方法的函数序言以确定为函数保留的空间量，现在我该怎么做......？

# software-design - 软件设计描述实践

> ID：91851
> 
> 赞同：1
> 
> 时间：2008-09-18T11:52:42.320
> 
> 标签：software-design

有多少人在编写一行代码之前实际编写了 SDD 文档？

您如何处理大型 CSCI？

您对 SDD 内容使用什么标准？

你做过什么剪裁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T12:06:45.983

我当然有。历史上和最近的项目。
几年前，我在模板就是一切的组织中工作。然后我在其他模板松散或不存在或不适合我正在从事的项目的地方工作。
现在，软件设计的内容几乎取决于我需要描述的内容，以便将这个想法传达给观众。
“在编写一行代码之前”不会有很多细节。我在开始编码之前制作的文档旨在让受影响的团队和高级管理人员了解我们需要构建什么，以便他们介绍高级架构、功能、技术、风险和范围。最后两个真的很重要。剩下的就是向其他团队展示你需要与他们交流的地方，并让经理们留下一个挥之不去的想法，即正在发生一些很酷的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T12:03:33.930

大多数大型软件公司都有自己的做法。例如，摩托罗拉对软件开发过程的各个方面都有详细的文档。每种类型的文档都有标准模板。拥有严格的标准可以有效地维护大量文档并将其与不同的工具集成。每份文件都从专门的文件跟踪系统获得跟踪号。他们甚至有用于自动需求跟踪的系统（上次我看到它处于早期开发阶段）——你可以说哪一行代码与给定的需求\设计指南相关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T12:06:55.047

我认为大多数编写 SDD 文档和使用 CSCI 等术语的人必须使用特定的软件开发方法，并且很可能正在为一些严肃的政府客户工作。他们通常倾向于非常认真地对待他们的准备工作，并且在任何开发开始之前就已经准备好并批准了文件。

在敏捷过程中，开发和设计文档可以并行开发。这意味着需要进行大量重构，但最终通常会产生非常好的结果。

在更正式的流程（如 RUP）中，SAD 文档主要是在基于团队研究的细化/原型设计阶段创建的。

# tsql - 临时表上的索引在表被删除的时候会被删除吗？

> ID：91856
> 
> 赞同：21
> 
> 时间：2008-09-18T11:53:53.517
> 
> 标签：tsql, indexing, temp-tables

以下 SQL 是否也会删除索引 - 还是必须单独删除？

```
CREATE TABLE #Tbl (field int)

CREATE NONCLUSTERED INDEX idx ON #Tbl (field)

DROP TABLE #Tbl 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-18T11:59:27.060

是的，他们是。您可以在 MSSQL 帮助中搜索 CREATE INDEX 文章，据说那里有：

> “可以在临时表上创建索引。当表被删除或会话结束时，所有索引和触发器都会被删除。”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T11:55:17.693

它将被自动删除，因为没有任何东西可以索引。在这方面将其视为子对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T12:00:17.403

删除表将删除索引。Drop Index 采用索引名称和表名称。

在这种情况下将是 DROP INDEX idc ON #tbl

如果您想删除索引但离开表，可以调用它。

# cygwin - 重命名/映射 Cygwin 文件夹

> ID：91857
> 
> 赞同：3
> 
> 时间：2008-09-18T11:54:00.943
> 
> 标签：cygwin

我可以安全地重命名 cygdrive 文件夹吗？另外，我想在根目录添加其他文件夹并将它们映射到 Windows 上的文件夹，就像 /cygdrive/c 映射到我的 C 驱动器一样。那可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T11:56:07.520

是的你可以。请参阅Cygwin 文档中[的 Cygwin 挂载表](http://www.cygwin.com/cygwin-ug-net/using.html#mount-table)。我将我的文档文件夹安装为 /doc。这些挂载最终保存在注册表中，并在重新启动等时保留。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T11:55:39.957

我不会重命名 cygdrive，因为我不知道那会做什么，但是您可以使用该`mount`命令将根目录下的其他目录映射到各种 windows 目录。

# c# - 读取加速数据文件

> ID：91890
> 
> 赞同：12
> 
> 时间：2008-09-18T12:02:19.317
> 
> 标签：c#, java, python, file-format, quicken

寻找用于 C++、Java、C# 或 Python 的开源库，用于从 Quicken **.qdf**文件中读取数据。

@Swati：Quicken **.qif**格式仅用于传输，不会像 .qdf 文件那样由应用程序保持最新。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-17T04:29:31.037

QDF 是专有的，除了我的 Quicken 之外，并不真正用于阅读，可能是因为它很乱。

我建议找到一种将 qdf 导出到 OFX（开放金融交易所）或 qif 文件的方法。我做了一些财务和快速手册自动化，我也做了类似的事情。问题是，如果您不导出到交换格式，每个版本都会有所不同，并且在许多情况下会发生奇怪的事情，因为它们没有记录（QDF），这对程序员来说是一个糟糕的情况。

OFX 允许在线银行、经纪公司和 mint.com 等应用程序安全地获取财务数据。这是一个标准和一致的。如果可能的话，找到解决这个问题的方法要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:21:35.273

[http://www.west-wind.com/Weblog/posts/10491.aspx](http://www.west-wind.com/Weblog/posts/10491.aspx)

我知道另一个博客，作者正在为 qfx/qif 开发一个解析器……让我查一下……谷歌搜索还没有帮助:(

更新：又找到了一个：

[http://blogs.msdn.com/lucabol/archive/2007/08/31/parsing-qif-quicken-files-in-c.aspx](http://blogs.msdn.com/lucabol/archive/2007/08/31/parsing-qif-quicken-files-in-c.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-17T22:25:49.573

查看[http://qif.codeplex.com/](http://qif.codeplex.com/)

您可能需要在使用前检查许可证。谢谢

# linux - 使用 grep 查找文件中的内容并在匹配时移动它们

> ID：91899
> 
> 赞同：64
> 
> 时间：2008-09-18T12:03:45.833
> 
> 标签：linux, shell, scripting, grep

我正在使用 grep 生成我需要移动的文件列表：

```
grep -L -r 'Subject: \[SPAM\]' . 
```

如何将此列表传递给 mv 命令并将文件移动到其他位置？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-09-18T12:14:06.947

`'Subject \[SPAM\]'`如果您想查找和移动与您的模式不匹配的文件（移动本示例中不包含的文件），请使用：

```
grep -L -Z -r 'Subject: \[SPAM\]' . | xargs -0 -I{} mv {} DIR 
```

-Z 表示在文件名后带有零 (\0) 的输出（因此空格不用作分隔符）。

```
xargs -0 
```

表示将 \0 解释为分隔符。

-L 表示查找与模式不匹配的文件。如果要移动与您的模式匹配的文件，请替换`-L`为。`-l`

然后

```
-I{} mv {} DIR 
```

意味着`{}`用文件名替换，所以你得到`mv filenames DIR`.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-18T12:20:23.313

此替代方法适用于 xargs 不可用的情况：

```
grep -L -r 'Subject: \[SPAM\]' . | while read f; do mv "$f" out; done 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-05-31T19:56:37.133

这是我在 Fedora Core 12 中使用的：

```
grep -l 'Subject: \[SPAM\]' | xargs -I '{}' mv '{}' DIR 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-04-03T09:55:55.007

这对我有帮助：

`grep -lir 'spam' ./ | xargs mv -t ../spam`

当然，我已经在所需的文件夹中（这就是为什么`./`）并将它们移动到相邻的文件夹中。但是您可以将它们更改为任何路径。

我不知道为什么接受的答案不起作用。此外，我的文件名中没有空格和特殊字符——也许这行不通。

在这里被盗：[Grep 命令查找包含文本字符串的文件并移动它们](https://unix.stackexchange.com/a/56906)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-09-10T10:05:18.550

```
mv `grep -L -r 'Subject: \[SPAM\]' .` <directory_path> 
```

假设您编写的 grep 返回您期望的文件路径。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-02-14T10:53:35.790

也许这会起作用：

```
mv $(grep -l 'Subject: \[SPAM\]' | awk -F ':' '{print $1}') your_file 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T12:12:40.977

有几种方法，但这是一种缓慢但安全的方法：

```
IFS=$'\n'; # set the field separator to line break
for $mail in $(grep -L -r 'Subject: \[SPAM\]' .); do mv "$mail" your_dir; done;
IFS=' '; # restore FS 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-05T15:00:27.723

适合我的工作：

*   将包含带有 MYSTRINGTOSEARCH 字样的文本的文件移动到目录 MYDIR。

    寻找 。-type f -exec grep -il 'MYSTRINGTOSEARCH' {} \; -exec mv {} MYDIR/\;

我希望这有帮助

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T12:04:57.000

您可以使用 grep ... | 将结果传递给下一个命令 xargs mv {} 目的地

检查 man xargs 了解更多信息。

# email - 从 mailto 链接向邮件集添加紧急优先级

> ID：91905
> 
> 赞同：8
> 
> 时间：2008-09-18T12:05:48.467
> 
> 标签：email, mailto

我想在我们的网页上添加一个 mailto 链接。我想为这封邮件添加紧急优先级。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T12:07:51.253

mailto 链接不支持此功能，抱歉。

但是，您可以使用特定主题并在收件箱中对其进行过滤

```
<a href="mailto:webmaster@website.com?subject=Urgent">Send a email</a> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T12:15:10.970

你可以得到你的优先权，但可能不是这样。

大多数邮件客户端都尊重`subject=`并`body=`在`mailto:`链接的查询字符串中。一些邮件客户端将多个`body=`属性视为不同的行；其他人只使用最后一个`body`。但是，直截了当地说：**我认为大多数客户端不会让您设置优先级**，并且只需要*一个*客户端不这样做就会使您的系统不可靠。

最简单的方法是**使用邮件过滤器来设置入站邮件的优先级**。*过滤器应根据您可以*可靠控制的主题行设置优先级。

如果您的邮件系统的过滤器无法设置优先级，请尝试分类到不同的邮件文件夹。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T12:44:11.710

您不能使用 mailto: 链接执行此操作，但您可以创建一个服务器端联系表单，该表单使用正确的标题发送电子邮件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:10:13.447

我猜如果存在这样的功能，它是特定于浏览器的。

[来自 w3 的网站：](http://www.w3.org/TR/WD-html40-970917/htmlweb.html)

> 用户代理可能支持尚未成为 Internet 标准的 MAILTO URL 扩展（例如，使用语法“?Subject=my%20subject”将主题信息附加到 URL，其中任何空格字符都被“%20”替换）。一些用户代理还支持“?Cc=email-address”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T12:12:01.913

这是不可能的。

# drools - 我们如何在 JBoss 规则中的 .drl 文件之间共享单独的规则？

> ID：91917
> 
> 赞同：3
> 
> 时间：2008-09-18T12:07:09.337
> 
> 标签：drools, modularization, jboss-rules

我们正在使用[JBoss 规则](http://www.jboss.org/drools/)（又名 Drools）并且有几个*.drl*文件，每个文件都包含多个规则。有没有办法避免文件之间的重复，以便我们可以定义可用于多个*.drl*文件的通用规则？

不幸的是，似乎没有任何类型的*包含*或模块工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T19:38:43.383

无法在 .drl 文件中包含来自另一个 .drl 文件的规则。

但是，您可以将两个 .drl 文件添加到同一个规则库中，它们将像在同一个文件中一样工作。

```
PackageBuilder builder = new PackageBuilder();
builder.addPackageFromDrl( new InputStreamReader( getClass().getResourceAsStream( "common.drl" ) ) );
builder.addPackageFromDrl( new InputStreamReader( getClass().getResourceAsStream( "rules1.drl" ) ) );
RuleBase ruleBase  = RuleBaseFactory.newRuleBase();
ruleBase.addPackage( builder.getPackage()  ); 
```

# design-patterns - 策略模式如何运作？

> ID：91932
> 
> 赞同：64
> 
> 时间：2008-09-18T12:09:49.250
> 
> 标签：design-patterns, strategy-pattern

它是如何工作的，它的用途是什么，什么时候应该使用它？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-18T12:32:30.693

让我们以简单的方式解释策略模式：

您有一个`Car()`带有 method的类`run()`，因此您可以在伪语言中以这种方式使用它：

```
mycar = new Car()
mycar.run() 
```

现在，您可能希望`run()`在程序执行时动态更改行为。例如，您可能想要模拟电机故障或在视频游戏中使用“增强”按钮。

有几种方法可以进行这种模拟：使用条件语句和标志变量是一种方法。策略模式是另一种模式：它将方法的行为委托`run()`给另一个类：

```
Class Car()
{
    this.motor = new Motor(this) 

    // passing "this" is important for the motor so it knows what it is running

    method run()
    {
        this.motor.run()
    }

    method changeMotor(motor)
    {
        this.motor = motor 
    }

} 
```

如果你想改变汽车的行为，你可以改变电机。（在程序中比在现实生活中更容易，对吧？;-)）

如果您有很多复杂的状态，这将非常有用：您可以更轻松地更改和维护它们。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-18T17:59:28.990

## 问题

策略模式用于解决可能（或预计它们可能）由不同**策略**实现或解决的问题，并为此类情况提供明确定义的接口。每个策略本身都是完全有效的，其中一些策略在某些情况下更可取，允许应用程序在运行时在它们之间切换。

## 代码示例

```
namespace StrategyPatterns
{
  // Interface definition for a Sort algorithm
  public interface ISort
  {
    void Sort(List<string> list)
  }

  // QuickSort implementation
  public class CQuickSorter : ISort
  {
    void Sort(List<string> list)
    {
      // Here will be the actual implementation
    }
  }

  // BubbleSort implementation
  public class CBubbleSort : ISort
  {
    void Sort(List<string> list)
    {
      // The actual implementation of the sort
    }
  }

  // MergeSort implementation
  public class CMergeSort : ISort
  {
    void Sort(List<string> list)
    {
      // Again the real implementation comes here
    }
  }

  public class Context
  {
    private ISort sorter;

    public Context(ISort sorter)
    {
      // We pass to the context the strategy to use
      this.sorter = sorter;
    }

    public ISort Sorter
    {
      get{return sorter;)
    }
  }

  public class MainClass
  {
    static void Main()
    {
       List<string> myList = new List<string>();

       myList.Add("Hello world");
       myList.Add("Another item");
       myList.Add("Item item");

       Context cn = new Context(new CQuickSorter());
       // Sort using the QuickSort strategy
       cn.Sorter.Sort(myList);
       myList.Add("This one goes for the mergesort");
       cn = new Context(new CMergeSort());
       // Sort using the merge sort strategy
       cn.Sorter.Sort(myList);
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-05-23T23:29:34.210

*   什么是策略？战略是旨在实现特定目标的行动计划；
*   “定义一系列算法，封装每个算法，并使它们可互换。策略让算法独立于使用它的客户而变化。” （四人组）；
*   指定一组类，每个类代表一个潜在的行为。在这些类之间切换会改变应用程序的行为。（战略）；
*   可以在运行时（使用多态性）或设计时选择此行为；
*   捕获接口中的抽象，将实现细节隐藏在派生类中；

![在此处输入图像描述](https://i.stack.imgur.com/cvV4W.png)

*   策略的替代方法是通过使用条件逻辑来更改应用程序行为。（坏的）;
*   使用此模式可以更轻松地添加或删除特定行为，而无需重新编码和重新测试应用程序的全部或部分；

*   良好的用途：

    *   当我们有一组相似的算法并且它需要在应用程序的不同部分在它们之间进行切换时。使用策略模式可以避免ifs并简化维护；
    *   当我们想向超类添加不一定对每个子类都有意义的新方法时。我们不是以传统方式使用接口，而是添加新方法，而是使用一个实例变量，它是新功能接口的子类。这被称为组合：类不是通过继承来继承能力，而是由具有正确能力的对象组成；

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-05T07:52:56.093

一个密切相关的模式是委托模式。在这两种情况下，一些工作都会传递给其他一些组件。如果我理解正确，这些模式之间的区别是这样的（如果我错了，请纠正我）：

*   在**委托**模式中，委托由封闭（委托）类实例化；这允许通过组合而不是继承来重用代码。封闭类可能知道委托的具体类型，例如，如果它自己调用其构造函数（而不是使用工厂）。

*   在**策略**模式中，执行策略的组件是通过其构造函数或设置器（根据您的宗教信仰）提供给封闭（使用）组件的依赖项。using 组件完全不知道正在使用什么策略；该策略始终通过接口调用。

有人知道其他区别吗？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-18T12:13:13.923

直接来自[Strategy Pattern Wikipedia 文章](http://en.wikipedia.org/wiki/Strategy_pattern)：

> 策略模式对于需要动态交换应用程序中使用的算法的情况很有用。策略模式旨在提供一种方法来定义一系列算法，将每个算法封装为一个对象，并使它们可互换。策略模式让算法独立于使用它们的客户端而变化。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-05T08:05:27.643

补充一下已经很精彩的答案：策略模式与将一个（或多个函数）传递给另一个函数非常相似。在策略中，这是通过将所述函数包装在一个对象中，然后传递该对象来完成的。有些语言可以直接传递函数，所以它们根本不需要模式。但是其他语言不能传递函数，但是*可以*传递对象；然后应用该模式。

尤其是在类 Java 语言中，您会发现该语言的类型动物园非常小，并且您扩展它的唯一方法是创建对象。因此，大多数问题的解决方案是提出一个模式；一种组合对象以实现特定目标的方法。具有更丰富类型动物园的语言通常有更简单的解决问题的方法——但更丰富的类型也意味着你必须花更多的时间来学习类型系统。具有动态类型规则的语言通常也会偷偷摸摸地解决问题。

# c# - 检查重复项时的性能

> ID：91933
> 
> 赞同：1
> 
> 时间：2008-09-18T12:10:00.903
> 
> 标签：c#, performance, collections, .net-2.0

我一直在做一个项目，我需要遍历数据集合并删除“主键”重复的条目。我试过使用

```
List<int> 
```

和

```
Dictionary<int, bool> 
```

使用字典，我发现性能稍好一些，尽管我从不需要为每个条目标记布尔值。我的期望是，这是因为 List 允许索引访问，而 Dictionary 不允许。我想知道的是，有没有更好的解决方案来解决这个问题。我不需要再次访问这些条目，我只需要跟踪我所看到的“主键”并确保我只对具有新主键的条目执行添加工作。我正在使用 C# 和 .NET 2.0。而且我无法控制修复输入数据以从源中删除重复项（不幸的是！）。所以你可以对缩放有感觉，总的来说，我在应用程序中检查了大约 1,000,000 次重复，但在不超过大约 64,000 的子集中需要唯一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T12:12:21.320

他们在 .NET 3.5 中添加了 HashSet 类。但我想它会与字典相提并论。如果您的元素少于 100 个，则 List 可能会表现得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T12:17:43.570

**编辑：没关系我的评论。我以为你在谈论 C++。我不知道我的帖子是否与 C# 世界相关..**

哈希表可能会快一点。由于访问内存的方式，二叉树（字典中使用的）往往相对较慢。如果您的树变得非常大，则尤其如此。

但是，在您更改数据结构之前，您是否尝试过为您的字典使用自定义池分配器？我敢打赌，时间不是花在遍历树本身上，而是字典会为你做的数百万次分配和释放。

只需将一个简单的池分配器插入字典模板，您可能会看到 10 倍的速度提升。Afaik boost 有一个可以直接使用的组件。

另一种选择：如果您知道整数中仅存在 64.000 个条目，则可以将它们写入文件并为其创建完美的散列函数。这样你就可以使用散列函数将你的整数映射到 0 到 64.000 范围内并索引一个位数组。

可能是最快的方式，但不太灵活。每次整数集发生变化时，您都必须重做完美的哈希函数（可以自动完成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T12:16:02.653

我真的不明白你在问什么。

首先与你所说的相反。字典有索引访问（是一个哈希表），而 de List 没有。

如果您已经在字典中有数据，那么所有键都是唯一的，不能有重复项。

我怀疑您将数据存储在另一种数据类型中，并且您将其存储到字典中。如果是这种情况，插入数据将使用两个字典。

```
foreach (int key in keys)
{
  if (!MyDataDict.ContainsKey(key))
  {
    if (!MyDuplicatesDict.ContainsKey(key))
      MyDuplicatesDict.Add(key);
  }
  else
    MyDataDict.Add(key); 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T12:21:50.003

如果您正在检查整数的唯一性，并且整数的范围受到足够的限制，那么您可以只使用一个数组。

为了更好地打包，您可以实现一个位图数据结构（基本上是一个数组，但数组中的每个 int 代表键空间中的 32 个 int，每个键使用 1 位）。这样，如果您的最大数量为 1,000,000，则数据结构只需要约 30.5KB 的内存。

位图的执行将是 O(1)（每次检查），这很难被击败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T12:26:30.943

不久前有一个关于[从数组中删除重复项](https://stackoverflow.com/questions/9673/remove-duplicates-from-array#9763)的问题。出于问题的目的，性能并不是一个考虑因素，但您可能想看看答案，因为它们可能会给您一些想法。另外，我在这里可能不合适，但是如果您尝试从数组中删除重复项，那么像[Enumerable.Distinct](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)这样的 LINQ 命令可能会给您带来比您自己编写的更好的性能。事实证明，有一种方法可以让[LINQ 在 .NET 2.0 上运行，](http://weblogs.asp.net/fmarguerie/archive/2007/09/05/linq-support-on-net-2-0.aspx)因此这可能是一条值得研究的路线。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T16:39:55.873

如果要使用列表，请使用 BinarySearch：

```
 // initailize to a size if you know your set size
List<int> FoundKeys = new List<int>( 64000 );
Dictionary<int,int> FoundDuplicates = new Dictionary<int,int>();

foreach ( int Key in MyKeys )
{
   // this is an O(log N) operation
   int index = FoundKeys.BinarySearch( Key );
   if ( index < 0 ) 
   {
       // if the Key is not in our list, 
       // index is the two's compliment of the next value that is in the list
       // i.e. the position it should occupy, and we maintain sorted-ness!
       FoundKeys.Insert( ~index, Key );
   }
   else 
   {
       if ( DuplicateKeys.ContainsKey( Key ) )
       {
           DuplicateKeys[Key]++;
       }
       else
       {
           DuplicateKeys.Add( Key, 1 );
       }
   } 
} 
```

您还可以将其用于任何可以通过使用重载定义 IComparer 的类型： BinarySearch( T item, IComparer< T > );

# c++ - Windows API 间谍/劫持技术

> ID：91935
> 
> 赞同：7
> 
> 时间：2008-09-18T12:10:07.097
> 
> 标签：c++, windows, winapi

我有兴趣使用 API 间谍/劫持来实现我正在从事的项目的一些核心功能。[在这个问题](https://stackoverflow.com/questions/60641/how-to-replace-winapi-functions-calls-in-the-ms-vc-project-with-my-own-implemen)中也提到了它，但这并不是真正的话题，所以我认为最好有一个自己的问题。，

我想尽可能多地收集关于这方面的信息、不同的技术/库（[MS Detours](http://research.microsoft.com/sn/detours/)、[IAT patching](http://www.codeproject.com/KB/system/hooksys.aspx)）或其他建议。

此外，如果有人有任何使用此类技术的实际生产经验，这将特别有趣——它们是否可以足够稳定以用于生产代码，或者这是否是一种严格的研究技术？它是否可以在多个版本的 Windows 上正常工作？它有多容易出错？

个人经验和外部链接都受到赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T12:34:05.917

我实现了[注射器.dll](http://www.geocities.com/SiliconValley/1741/downloads/)（L-GPL）而不是 MS Detours（我们不喜欢许可证要求或为 x64 支持支付巨额费用）它工作得非常好，我将它从 Win32 移植到 Win64，我们一直在使用自我商业应用大约 2 年了。

我们使用它的原因非常简单，实际上它提供了一个表示框架，用于重新打包、重新标记相同的编译应用程序作为许多不同的产品，我们对字符串、通用资源、工具栏和菜单进行通用过滤和替换。

作为 L-GPL，我们提供源代码、版权等，并且只动态链接到库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T12:40:58.413

挂钩标准 WinAPI 函数相对安全，因为它们在不久的将来不会发生太大变化，如果有的话，因为 Microsoft 最好保持 WinAPI 在版本之间向后兼容。我想说，标准的 WinAPI 挂钩通常是稳定和安全的。

挂钩其他任何东西，如在目标程序的内部，是另一回事。无论目标程序如何，挂钩本身通常都是一种可靠的做法。该过程中最薄弱的环节通常是找到正确的位置并坚持下去。

应用程序中的最小变化可以并且将会改变函数的地址，更不用说动态库等了。

在 gamehacking 中，hook 是标准做法，这在一定程度上被“sigscanning”打败了，这是 LanceVorgin 在有点臭名昭著的 MPC 板上首次开发的一种技术。它通过扫描可执行映像以查找函数的静态部分来工作，除非修改函数的操作，否则实际指令字节不会改变。sigscanning 显然比使用静态地址表要好，但是当目标应用程序发生足够的变化时，它最终也会失败。

可以在[此处](http://wiki.amxmodx.org/Signature_Scanning)找到 c++ 中 sigscanning 的示例实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:54:12.090

几年来，我一直在使用标准的 IAT 挂钩技术，它运行良好，运行良好且稳定，并且可以毫无问题地移植到 x64。我遇到的主要问题更多地与我如何首先注入钩子有关，花了很长时间才弄清楚如何最好地在启动时的“正确”点暂停托管进程，以便注入对我来说是可靠且足够早的。我的注入器使用 Win32 调试 API，虽然这使得挂起非托管进程很容易，但需要一些试验和错误才能在适当的时间暂停托管进程。

我对 IAT 的使用主要用于编写测试工具，我有一个死锁检测程序，详细信息如下：http : [//www.lenholgate.com/blog/2006/04/deadlock-detection-tool-updates.html](http://www.lenholgate.com/blog/2006/04/deadlock-detection-tool-updates.html) GetTickCount() 控制程序可从此处下载[http://www.lenholgate.com/blog/2006/04/tickshifter-v02.html](http://www.lenholgate.com/blog/2006/04/tickshifter-v02.html) 以及仍在开发中的时移应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-24T06:25:35.150

很多人忘记了 Windows dll 被编译为[热补丁图像](http://www.ragestorm.net/blogs/?p=17)( [MSDN](http://technet.microsoft.com/en-us/library/cc782258%28WS.10%29.aspx) )。

热补丁是WinAPI绕道的最好方法，因为它干净简单，并且保留了原始函数，这意味着不需要使用内联汇编，只需稍微调整函数指针。

一个小的热补丁教程可以在[这里](http://www.codeproject.com/KB/winsdk/0xF9EB_Hooking.aspx)找到。

# xml - 如何使用 groovy 在 XML 中搜索+替换？

> ID：91957
> 
> 赞同：2
> 
> 时间：2008-09-18T12:12:56.403
> 
> 标签：xml, groovy, soapui

如何使用 groovy 在 XML 中搜索+替换？

我需要一些尽可能简短/简单的东西，因为我将把这段代码提供给测试人员用于他们的 SoapUI 脚本。

更具体地说，我该如何转：

```
<root><data></data></root> 
```

进入：

```
<root><data>value</data></root> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T07:46:00.207

您可以用 XSLT 做的一些事情也可以用某种形式的“搜索和替换”来做。这完全取决于您的问题有多复杂以及您希望实施解决方案的“通用性”程度。为了使您自己的示例更加通用：

```
xml.replaceFirst("<Mobiltlf>[^<]*</Mobiltlf>", '<Mobiltlf>32165487</Mobiltlf>') 
```

您选择的解决方案取决于您。根据我自己的经验（对于非常简单的问题），使用简单的字符串查找比使用正则表达式要快，而正则表达式又比使用成熟的 XSLT 转换要快（实际上是有道理的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:15:10.890

经过一些疯狂的编码后，我看到了曙光并这样做了

```
import org.custommonkey.xmlunit.Diff
import org.custommonkey.xmlunit.XMLUnit

def input = '''<root><data></data></root>'''
def expectedResult = '''<root><data>value</data></root>'''

def xml = new XmlParser().parseText(input)

def p = xml.'**'.data
p.each{it.value="value"}

def writer = new StringWriter()
new XmlNodePrinter(new PrintWriter(writer)).print(xml)
def result = writer.toString()

XMLUnit.setIgnoreWhitespace(true)
def xmlDiff = new Diff(result, expectedResult)
assert xmlDiff.identical() 
```

不幸的是，这不会保留原始 xml 文档中的评论和元数据等，所以我必须找到另一种方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T12:47:22.450

我用 DOMCategory 做了一些测试，它几乎可以工作了。我可以进行替换，但一些与信息路径相关的评论消失了。我正在使用这样的方法：

```
def rtv = { xml, tag, value ->
    def doc     = DOMBuilder.parse(new StringReader(xml))
    def root    = doc.documentElement
    use(DOMCategory) { root.'**'."$tag".each{it.value=value} }
    return DOMUtil.serialize(root)    
} 
```

在这样的来源：

```
<?xml version="1.0" encoding="utf-8"?>
<?mso-infoPathSolution name="urn:schemas-microsoft-com:office:infopath:FA_Ansoegning:http---ementor-dk-application-2007-06-22-" href="manifest.xsf" solutionVersion="1.0.0.14" productVersion="12.0.0" PIVersion="1.0.0.0" ?>
<?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<application:FA_Ansoegning xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:application="http://corp.dk/application/2007/06/22/"
xmlns:xd="http://schemas.microsoft.com/office/infopath/2003"
xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/200    8-04-14T14:31:48">
    <Mobiltlf></Mobiltlf>
  <E-mail-adresse></E-mail-adresse>
</application:FA_Ansoegning> 
```

结果中唯一缺少的是结果中的 <?mso- 行。有人对此有想法吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T14:35:47.547

这是迄今为止最好的答案，它给出了正确的结果，所以我会接受这个答案:) 但是，它对我来说有点太大了。我想我最好解释一下替代方案是：

```
xml.replace("<Mobiltlf></Mobiltlf>", <Mobiltlf>32165487</Mobiltlf>") 
```

但这不是很 xml'y，所以我想我会寻找替代方案。另外，我不能确定第一个标签一直是空的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T05:40:32.747

要保留属性，只需像这样修改你的小程序（我已经包含了一个示例源来测试它）：

```
def input = """
<?xml version="1.0" encoding="utf-8"?>
<?mso-infoPathSolution name="urn:schemas-microsoft-com:office:infopath:FA_Ansoegning:http---ementor-dk-application-2007-06-22-" href="manifest.xsf" solutionVersion="1.0.0.14" productVersion="12.0.0" PIVersion="1.0.0.0" ?>
<?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<application:FA_Ansoegning xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:application="http://ementor.dk/application/2007/06/22/"
xmlns:xd="http://schemas.microsoft.com/office/infopath/2003"
xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/200    8-04-14T14:31:48">
    <Mobiltlf  type="national" anotherattribute="value"></Mobiltlf>
  <E-mail-adresse attr="whatever"></E-mail-adresse>
</application:FA_Ansoegning>
""".trim()

def rtv = { xmlSource, tagName, newValue ->
    regex = "(<$tagName[^>]*>)([^<]*)(</$tagName>)"
    replacement = "\$1${newValue}\$3"
    xmlSource = xmlSource.replaceAll(regex, replacement)
    return xmlSource
}

input = rtv( input, "Mobiltlf", "32165487" )
input = rtv( input, "E-mail-adresse", "bob@email.com" )
println input 
```

运行此脚本会产生：

```
<?xml version="1.0" encoding="utf-8"?>
<?mso-infoPathSolution name="urn:schemas-microsoft-com:office:infopath:FA_Ansoegning:http---ementor-dk-application-2007-06-22-" href="manifest.xsf" solutionVersion="1.0.0.14" productVersion="12.0.0" PIVersion="1.0.0.0" ?>
<?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<application:FA_Ansoegning xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:application="http://ementor.dk/application/2007/06/22/"
xmlns:xd="http://schemas.microsoft.com/office/infopath/2003"
xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/200    8-04-14T14:31:48">
    <Mobiltlf  type="national" anotherattribute="value">32165487</Mobiltlf>
  <E-mail-adresse attr="whatever">bob@email.com</E-mail-adresse>
</application:FA_Ansoegning> 
```

请注意，匹配的正则表达式现在包含 3 个捕获组：(1) 开始标记（包括属性），(2) 标记的“旧”内容和 (3) 结束标记。替换字符串通过 $i 语法引用这些捕获的组（在 GString 中使用反斜杠将它们转义）。提示：正则表达式是非常强大的动物，熟悉它们真的很值得；-)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T09:44:59.403

[在页面http://groovy.codehaus.org/Processing+XML](http://groovy.codehaus.org/Processing+XML)的“更新 XML”部分中描述了三种“官方”的常规方式来更新 XML 。

在这三个中，似乎只有 DOMCategory 方式保留了 XML 注释等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T09:13:39.850

对我来说，实际的复制、搜索和替换似乎是 XSLT 样式表的完美工作。在 XSLT 中，您完全可以复制所有内容（包括您遇到问题的项目）并在需要的地方插入数据。您可以通过 XSL 参数传递数据的特定值，也可以动态修改样式表本身（如果您在 Groovy 程序中作为字符串包含）。在 Groovy 中调用此 XSLT 来转换您的文档非常简单。

我很快将以下 Groovy 脚本拼凑在一起（但我毫不怀疑它可以写得更简单/更紧凑）：

```
import javax.xml.transform.TransformerFactory
import javax.xml.transform.stream.StreamResult
import javax.xml.transform.stream.StreamSource

def xml = """
<?xml version="1.0" encoding="utf-8"?>
<?mso-infoPathSolution name="urn:schemas-microsoft-com:office:infopath:FA_Ansoegning:http---ementor-dk-application-2007-06-22-" href="manifest.xsf" solutionVersion="1.0.0.14" productVersion="12.0.0" PIVersion="1.0.0.0" ?>
<?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<application:FA_Ansoegning xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:application="http://ementor.dk/application/2007/06/22/"
xmlns:xd="http://schemas.microsoft.com/office/infopath/2003"
xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/200    8-04-14T14:31:48">
    <Mobiltlf></Mobiltlf>
  <E-mail-adresse></E-mail-adresse>
</application:FA_Ansoegning>
""".trim()

def xslt = """
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:param name="mobil" select="'***dummy***'"/>
    <xsl:param name="email" select="'***dummy***'"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="Mobiltlf">
        <xsl:copy>
            <xsl:value-of select="\$mobil"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="E-mail-adresse">
        <xsl:copy>
            <xsl:value-of select="\$email"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet>
""".trim()

def factory = TransformerFactory.newInstance()
def transformer = factory.newTransformer(new StreamSource(new StringReader(xslt)))

transformer.setParameter('mobil', '1234567890')
transformer.setParameter('email', 'john.doe@foobar.com')

transformer.transform(new StreamSource(new StringReader(xml)), new StreamResult(System.out)) 
```

运行此脚本会产生：

```
<?xml version="1.0" encoding="UTF-8"?><?mso-infoPathSolution name="urn:schemas-microsoft-com:office:infopath:FA_Ansoegning:http---ementor-dk-application-2007-06-22-" href="manifest.xsf" solutionVersion="1.0.0.14" productVersion="12.0.0" PIVersion="1.0.0.0" ?>
<?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<application:FA_Ansoegning xmlns:application="http://ementor.dk/application/2007/06/22/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xd="http://schemas.microsoft.com/office/infopath/2003" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/200    8-04-14T14:31:48">
    <Mobiltlf>1234567890</Mobiltlf>
  <E-mail-adresse>john.doe@foobar.com</E-mail-adresse>
</application:FA_Ansoegning> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T09:16:38.383

杰出的！非常感谢您的帮助:)

这以一种更清洁、更简单的方式解决了我的问题。它最终看起来像这样：

```
def rtv = { xmlSource, tagName, newValue ->
    regex = "<$tagName>[^<]*</$tagName>"
    replacement = "<$tagName>${newValue}</$tagName>"
    xmlSource = xmlSource.replaceAll(regex, replacement)
    return xmlSource
}

input = rtv( input, "Mobiltlf", "32165487" )
input = rtv( input, "E-mail-adresse", "bob@email.com" )
println input 
```

由于我将其提供给我们的测试人员以在他们的测试工具 SoapUI 中使用，因此我尝试“包装”它，以使他们更容易复制和粘贴。

这对我的目的来说已经足够了，但如果我们能再增加一个“扭曲”就完美了

假设输入中有这个......

```
<Mobiltlf type="national" anotherattribute="value"></Mobiltlf> 
```

...即使我们替换了值，我们也希望保留这两个属性。有没有办法为此使用正则表达式？

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T12:15:19.893

检查这个： [http ://today.java.net/pub/a/today/2004/08/12/groovyxml.html?page=2](http://today.java.net/pub/a/today/2004/08/12/groovyxml.html?page=2)

# java - 如何模拟对象构造？

> ID：91981
> 
> 赞同：8
> 
> 时间：2008-09-18T12:16:14.307
> 
> 标签：java, tdd, junit, mocking

有没有办法在 Java 中使用 JMock 来模拟对象构造？

例如，如果我有这样的方法：

```
public Object createObject(String objectType) {
    if(objectType.equals("Integer") {
        return new Integer();
    } else if (objectType.equals("String") {
        return new String();
    }
} 
```

...有没有办法在测试方法中模拟对象构造的期望？

我希望能够期望调用某些构造函数，而不是使用额外的代码来检查类型（因为它并不总是像我的示例那样复杂和简单）。

所以而不是：

```
assertTrue(a.createObject() instanceof Integer); 
```

我可以期望调用某个构造函数。只是为了让它更简洁一些，并以更易读的方式表达实际正在测试的内容。

请原谅这个简单的例子，我正在处理的实际问题有点复杂，但是有期望会简化它。

* * *

更多背景知识：

我有一个简单的工厂方法，它创建包装对象。被包装的对象可能需要在测试类中难以获得的参数（它是预先存在的代码），因此很难构造它们。

也许更接近我实际寻找的是：有没有一种方法可以一举模拟整个类（使用 CGLib），而无需指定要存根的每种方法？

所以 mock 被包装在一个构造函数中，所以显然可以在上面调用方法，JMock 是否能够动态地模拟出每个方法？

我的猜测是否定的，因为那会非常复杂。但是知道我在叫错树也很有价值:-)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T12:30:31.370

我唯一能想到的就是在工厂对象上使用 create 方法，而不是模拟。

但就模拟构造函数调用而言，没有。模拟对象以对象存在为前提，而构造函数以对象不存在为前提。至少在分配和初始化一起发生的java中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T15:54:04.360

jmockit 可以做到这一点。

[在https://stackoverflow.com/questions/22697#93675](https://stackoverflow.com/questions/22697#93675)​​中查看我的答案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:53:14.010

唉，我想我问错了问题。

我试图测试的简单工厂看起来像：

```
public Wrapper wrapObject(Object toWrap) {
    if(toWrap instanceof ClassA) {
        return new Wrapper((ClassA) toWrap);
    } else if (toWrap instanceof ClassB) {
        return new Wrapper((ClassB) toWrap);
    } // etc

    else {
        return null;
    }
} 
```

我问的问题是如何查找是否调用了“new ClassAWrapper()”，因为在孤立的测试中很难获得对象 toWrap。包装器（如果它甚至可以被称为）有点奇怪，因为它使用同一个类来包装不同的对象，只是使用不同的构造函数[1]。我怀疑如果我把这个问题问得更好一点，我很快就会得到答案：

“您应该模拟 Object toWrap 以匹配您在不同测试方法中测试的实例，并检查生成的 Wrapper 对象以找到返回的正确类型......并希望您足够幸运，您不必模拟世界以创建不同的实例；-)"

我现在有一个可以解决眼前问题的好方法，谢谢！

[1] 提出是否应该重构的问题完全超出了我当前问题的范围 :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T12:36:29.123

你熟悉[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)吗？

如果不是，那么您肯定会从了解该概念中受益。我想 Martin Fowler 的古老[的控制容器反转和依赖注入模式](http://www.martinfowler.com/articles/injection.html)将作为一个很好的介绍。

使用依赖注入 (DI)，您将拥有一个 DI 容器对象，它能够为您创建各种类。然后，您的对象将使用 DI 容器来实例化类，并且您将模拟 DI 容器以测试该类是否创建了预期类的实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T12:57:27.017

依赖注入或控制反转。

或者，对您创建的所有对象使用抽象工厂设计模式。当您处于单元测试模式时，注入一个测试工厂，它将告诉您正在创建什么，然后在测试工厂中包含断言代码以检查结果（控制反转）。

为了使您的代码尽可能干净，请创建一个内部受保护的接口，将生产代码作为内部类实现接口（您的工厂）。添加初始化到默认工厂的接口的静态变量类型。为工厂添加静态设置器，您就完成了。

在您的测试代码中（必须在同一个包中，否则内部接口必须是公共的），使用断言代码和测试代码创建一个匿名或内部类。然后在您的测试中，初始化目标类，分配（注入）测试工厂，并运行目标类的方法。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-18T12:27:38.133

我希望没有。模拟应该模拟没有构造函数的接口......只有方法。

您在这里进行测试的方法似乎有些不对劲。为什么需要测试显式构造函数被调用的任何原因？
断言返回对象的类型对于测试工厂实现似乎没问题。将 createObject 视为一个黑盒。检查它返回的内容，但不要对它的执行方式进行微观管理。没有人喜欢这样:)

**更新更新：**哎哟！绝望时期的绝望措施是吗？如果 JMock 允许这样做，我会感到惊讶……正如我所说，它适用于接口……而不是具体类型。所以

*   要么尝试花费一些精力来让那些讨厌的输入对象在测试工具下“可实例化”。在你的方法中自下而上。
*   如果那不可行，请使用断点手动对其进行测试（我知道这很糟糕）。然后在源文件的可见区域中粘贴“触摸它，后果自负”评论并继续前进。再战一天。

# eclipse - 如何在 Eclipse 中直接热键到文件搜索选项卡

> ID：91984
> 
> 赞同：116
> 
> 时间：2008-09-18T12:17:14.960
> 
> 标签：eclipse, editor, hotkeys

当我使用`CTRL`+`H`时，我最终会出现在 Java Search 选项卡上。我非常想要一个直接进入文件搜索的快捷方式。那可能吗？

请参阅此处的图片了解我在说什么： [![在此处输入图像描述](https://i.stack.imgur.com/S3Qlf.png)](https://i.stack.imgur.com/S3Qlf.png)

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2008-09-18T12:31:35.860

您可以只定义一个打开文件搜索的键绑定：

1.  转到*首选项*>*常规*>*键*
2.  在搜索框中输入“文件搜索”。（如果没有结果，并且您有一个非常旧的 Eclipse 版本，请选中*Include Unbound Commands*复选框。）
3.  将插入符号放入*Binding*文本框中，然后按您要使用的组合键：

![在此处输入图像描述](https://i.stack.imgur.com/tjQEJ.png)

您可以重新使用`CTRL`+`H`绑定（在这种情况下删除另一个绑定）或定义另一个绑定（例如`CTRL`++ `SHIFT`）`H`。要删除“打开搜索对话框”的其他绑定搜索，然后单击*Unbind Command*。

* * *

其他解决方案：您可以在编辑器中按`CTRL`+ `3`，输入“file s”，然后按`Enter`。下次按`CTRL`+ `3`“文件搜索”时位于顶部。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2010-12-20T18:24:21.927

另一种选择是打开搜索对话框 ( `Ctrl`+ `H`) 然后单击自定义并隐藏 java 和任务搜索选项卡，下次您执行`Ctrl`+`H`时，文件搜索将是唯一显示的选项，因此默认选中

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-07-31T20:00:18.063

我实际上认为最好（也是最简单的方法）是简单地打开搜索对话框（ctrl + h），点击自定义，然后选择“记住最后使用的页面”复选框。然后切换到文件搜索一次。只要那是您使用的最后一个搜索选项卡，它就会一直在那里打开。这样做的好处是，如果您确实需要它们，您不会失去对其他选项卡的轻松访问！（在 Eclipse 开普勒中工作）。

![自定义视图](https://i.stack.imgur.com/taeoR.png)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-10-31T20:38:27.370

我学会了使用“伪热键” `ALT`+ `A` `F`（也可以用作`ALT`++ `A` `ALT`）`F`，它解析为：*“Menu Se[a]rch → [F]ile...”*并且具有始终存在的优点，无需用于重新配置。

![](https://i.imgur.com/fARqgiY.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T13:15:25.880

我以前也遇到过这个问题。

我尝试按照@Martin 给出的问题回复中的建议将`Ctrl`+重新绑定`H`到 Window | 中的“文件搜索” 偏好 | 一般 | 键，但由于某种原因，我在命令列中没有“文件搜索”条目。（我目前正在运行 Eclipse 3.3；也许在后续版本中添加了“文件搜索”条目？）

***更新：****正如 Martin 在对此答案的评论中指出的那样，我没有在 Preferences | 中选中“Include unbound commands”复选框。键对话框，这就是我没有显示“文件搜索”的原因。正如马丁在此页面上的回答中所建议的那样，我现在将`Ctrl`+`H`绑定到“文件搜索”，并且效果很好。谢谢马丁！*

我最终通过使用`Ctrl`+调出“搜索”对话框来解决原始问题`H`，然后单击对话框上的“自定义”按钮，这会调出“搜索页面选择”对话框，允许您在“搜索”对话框中隐藏或显示选项卡。我隐藏了“文件搜索”以外的选项卡，这会导致“文件搜索”在未来使用`Ctrl`+时默认激活`H`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T12:24:25.253

据我所知，搜索窗口选项卡取决于您在调用搜索功能时打开的文件。因此，例如，如果您在 web.xml 文件上，它将打开“插件搜索”而不是“java-search”。

编辑：有一种方法可以强制默认打开选项卡，方法是在“键”首选项面板中为“文件搜索”操作分配快捷方式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-30T04:24:09.303

可能这个功能是最近才出现的[自朱诺以来就已经确认了它的存在]并且看起来很聪明。 **按 Ctrl+H --> 自定义 --> [复选框]**记住上次使用的页面。这样，如果需要，您随时可以使用其他选项。因此，如果您经常使用文件搜索，那么您将不会因为最后选择的内容而烦恼。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-03T07:32:55.503

我想在这里提供一个解决方法：您可以“记住上次使用的页面”以避免一遍又一遍地打开它。

[![在此处输入图像描述](https://i.stack.imgur.com/zHhBz.png)](https://i.stack.imgur.com/zHhBz.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-22T19:35:14.400

更新：用户@muescha，在问题下方的评论中，刚刚向我指出我不小心回答了*错误的问题！*尽管如此，它仍然是一个有价值的答案（只是不是这个问题），所以我要离开它。

# 我的回答回答了这个问题：如何在 Eclipse 中直接使用热键搜索文件？

**`Ctrl`+ `Shift`+`R`效果非常好！**使用星号 (*) 表示通配符。`Ctrl`它与 Sublime Text 3 中的+`P`模糊搜索非常相似。

## `Ctrl`在 Eclipse 中使用++ “Open Resource”搜索的示例搜索`Shift`：`R`

`rea`

[![在此处输入图像描述](https://i.stack.imgur.com/itsfC.png)](https://i.stack.imgur.com/itsfC.png)

`*.txt`

[![在此处输入图像描述](https://i.stack.imgur.com/VuSPX.png)](https://i.stack.imgur.com/VuSPX.png)

`*32*f1*c`

[![在此处输入图像描述](https://i.stack.imgur.com/GOBOz.png)](https://i.stack.imgur.com/GOBOz.png)

`*3*1*c*h`
请注意，如果您只是`*`在搜索字符串中的每个字符之间加上一个星号，它的工作原理就像 Sublime Text 3 的`Ctrl`+ `P`“模糊搜索”！美丽的！

[![在此处输入图像描述](https://i.stack.imgur.com/P3D4F.png)](https://i.stack.imgur.com/P3D4F.png)

* * *

旁注：您也可以使用`Search`-->`File`菜单对话框来搜索文件。

# linq-to-sql - LINQ to SQL：如何编写“喜欢”选择？

> ID：91986
> 
> 赞同：20
> 
> 时间：2008-09-18T12:17:18.220
> 
> 标签：linq-to-sql

我有以下 SQL：

```
select * from transaction_log where stoptime like '%2008%' 
```

如何在 LINQ to SQL 语法中编写它？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-18T12:20:41.860

如果要使用字面量方法，是这样的：

```
var query = from l in transaction_log
            where SqlMethods.Like(l.stoptime, "%2008%")
            select l; 
```

另一种选择是：

```
var query = from l in transaction_log
        where l.stoptime.Contains("2008")
        select l; 
```

如果是日期时间：

```
var query = from l in transaction_log
        where l.stoptime.Year = 2008
        select l; 
```

该方法位于**System.Data.Linq.SqlClient**命名空间中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T12:21:06.150

```
from x in context.Table where x.Contains("2008") select x 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T12:23:41.853

如果 stoptime 数据类型是字符串，您可以使用 .Contains() 函数，也可以使用 .StartsWith() 和 .EndsWith()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T12:44:24.067

如果您使用 contains to 方法，那么您正在执行 LIKE '%somestring%'。如果您使用startswith 方法，那么它与'somestring%' 相同。最后，endswith 与使用 '%somestring' 相同。

总而言之，包含将在字符串中找到任何模式，但开始和结束将帮助您在单词的开头和结尾找到匹配项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T12:50:14.163

真正有趣的一点是，当您使用“from x in context.Table where x.Contains("test") select x” 时，.NET 会创建诸如“Select * from table where name like '%test%'”之类的查询，即相当令人印象深刻

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T17:16:21.027

谢谢 - 很好的答案。

这实际上是一个 DateTime 类型；我不得不将“stoptime”类型转换为：

```
var query = from p in dbTransSummary.Transaction_Logs
    where ( (DateTime) p.StopTime).Year == dtRollUpDate.Year
    select 
```

小点。效果很好！

# c# - 关系运算符表达式顺序

> ID：91994
> 
> 赞同：1
> 
> 时间：2008-09-18T12:17:43.850
> 
> 标签：c#, operators, logical-operators

这可能是一个愚蠢的问题，但好奇心使我变得更好。我最近看到的代码似乎“颠倒”了关系运算符的表达式顺序，例如：

```
if (0 == someVariable) 
```

与我通常看到/写的相反：

```
if (someVariable == 0) 
```

对我来说，第二种方法似乎更具可读性和直观性，所以我想知道我看到第一种方法是否有某些原因？从逻辑上讲，这两个语句的计算结果相同，那么它们的编写方式只是个人喜好问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T12:20:19.507

我明白这是个人喜好。尽管通过将变量放在第二位，您可以确保您不会意外地将常量分配给曾经关心 c 开发人员的变量。这可能就是为什么您在 c# 中看到它作为开发人员切换语言的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T12:19:35.843

顺序无关紧要，但是，前者意味着它是您要检查的零。惯例规定使用 hte 后者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T12:22:05.133

C 和 C++ 中的主要原因是易于键入

```
if (someVariable = 0) {
    ...
} 
```

它总是失败并且也设置`someVariable`为0。

我个人更喜欢变量优先的风格，因为它读起来更自然，只是希望我不要忘记使用`==`not `=`。

如果您在`if`. `if`Java 和 C# 通过在子句中禁止非布尔表达式来避免这个问题。Python 通过让赋值语句而不是表达式来避免这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:20:08.790

第一种方法的存在是为了提醒自己不要在 IF 语句中进行赋值，这在某些语言 (C/C++) 中可能会产生灾难性的后果。在 C# 中，如果你设置布尔值，你只会被这个咬伤。

可能致命的 C 代码：

```
if (succeeded = TRUE)
{
    // I could be in trouble here if 'succeeded' was FALSE
} 
```

在 C/C++ 中，当您打算使用 VAR == CONSTANT 时，任何变量都容易受到 VAR = CONSTANT 这个问题的影响。因此，如果您弄错了，通常习惯于重新排序您的 IF 语句以接收编译错误：

```
if (TRUE = succeeded)
{
    // This will fail to compile, and I'll fix my mistake
} 
```

在 C# 中，只有布尔值易受此影响，因为只有布尔表达式在 if 语句中有效。

```
if (myInteger = 9)
{
    // this will fail to compile
} 
```

因此，在 C# 世界中，没有必要采用 CONSTANT == VAR 样式，除非您愿意这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T12:21:33.123

后一种格式是 C 语法的遗留格式，如果您无意中遗漏了一个等号，它会进行赋值，而不是比较。

但是，您当然不能分配给数字文字，因此如果您像第二个示例那样编写它，您会得到编译器错误，而不是错误。

但是，在 C# 中，您不能无意中这样做，所以这并不重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T12:52:24.093

除了平等之外，我还经常遇到类似的代码

```
if (0 > number) 
```

或者

```
if (NULL != pointer) 
```

在 C/C++ 中甚至没有犯错的危险！这是一种善意的教学技巧变成了明显的坏习惯的情况之一。*********