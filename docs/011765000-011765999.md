# StackOverflow 问答 11765000-11765999

# peoplesoft - Peoplesoft 8.52 菜单授权错误

> ID：11765000
> 
> 赞同：0
> 
> 时间：2012-08-01T18:06:02.850
> 
> 标签：peoplesoft

除了管理员之外的任何类型的帐户，我们都会收到下拉菜单的授权错误。（和其他页面）

用户确实拥有使用 WEBLIB_PT_NAV 的 PTPT1000 访问权限以及对该 weblib 中每个 iscript 的完全访问权限。

我们还执行了安全同步并清除了缓存。

关于什么是错的以及如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:29:49.700

除了通过安全管理授予的权限外，PeopleSoft 中的管理员没有任何特殊访问权限。

我会尝试在视觉上比较这两个帐户，如果证明太费力，则克隆管理员帐户并逐步删除角色，直到找到被授予所需访问权限的那个。

为了安全起见，我会首先删除应用服务器和浏览器缓存。

祝你好运！

# php - Facebook JSON 服务没有检索超过 1000 个 Facebook 朋友

> ID：11765002
> 
> 赞同：2
> 
> 时间：2012-08-01T18:06:10.323
> 
> 标签：php, facebook, facebook-graph-api, developer-tools

我在以下代码上遇到问题，有人可以解决吗？这是我的代码描述：

```
$friends=get_data(https://graph.facebook.com/".$facbookid."/friends?access_token=".Useraccess_token); 
```

这是 get_data 函数，它返回适当的数据：

```
function get_data($url) {
    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch,CURLOPT_URL,$url);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
    $data = curl_exec($ch);
    curl_close($ch);
    return $data;
} 
```

然后我使用了 JSON SERVICE：

```
$json = new Services_JSON();
$friends = $json->decode($friends);
echo "print data".$friends->data;
if (isset($friends->data))
    {   
        foreach($friends->data as $friend) 
        {
            $i++;
            $friendList[] = $friend->id;   
        }
    } 
```

问题是，当我只有 1000 个朋友时，它正在检索数据。但是当朋友超过1000时，它就不起作用了。

事实上，我已经使用过`$friends = $json->decode($friends,true);`等。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:32:59.367

Facebook 的图形 API 限制了结果的数量，以防止它（或您）遭受性能不佳或内存不足的困扰。您需要使用[API 提供的分页功能](https://developers.facebook.com/blog/post/478/)`limit`，即`since`和`until`参数。

除非您有充分的理由，否则最好不要更改默认限制（不打扰页面不是一个好理由）。有用的是，所有结果还包含一个`paging`结构，告诉您下一页（和上一页）的 URL。

# asp.net-mvc-3 - MVC 3 将数据从控制器传递到视图时出现错误

> ID：11765003
> 
> 赞同：-1
> 
> 时间：2012-08-01T18:06:18.413
> 
> 标签：asp.net-mvc-3, linq, entity-framework, linq-to-entities

我收到这个错误。

传入字典的模型项的类型为“System.Data.Entity.Infrastructure.DbQuery `1[<>f__AnonymousType1`3[ACapture.Models.Blog,ACapture.Models.Image,ACapture.Models.Profile]]”，但此字典需要模型项'System.Collections.Generic.IEnumerable`1[ACapture.Models.Blog]' 类型。

这是我的控制器。

```
public class HomeController : Controller
{
    private ACaptureDB db = new ACaptureDB();

    public ViewResult Index()
    {
        ViewBag.Message = "ArchiCapture";
        var dateCheck = DateTime.Now.AddDays(-7);

        var results = (from r in db.Blog
                      join p in db.Image on r.ImageID equals p.ImageID
                      //join l in db.Account on p.AccountID equals l.AccountID
                      join a in db.Profile on p.AccountID equals a.AccountID
                      //where r.dte_created >= dateCheck
                       select new { r, p, a });

        return View(results);
    } 
```

这是我的看法。

```
@model IEnumerable<ACapture.Models.Blog>

@{
    ViewBag.Title = "Home Page";
}

<div class="Forum">
    <p>The Forum</p>

            @foreach (var item in Model)
            {
                <div class="ForumChild">
                    <img src="@item.Image.img_path" alt="Not Found" />
                    <br />
                        <table>
                            @foreach (var comment in item.comment)
                            {
                                var db = new ACapture.Models.ACaptureDB();

                                var Name = from p in db.Profile
                                           where (p.AccountID == comment.AccountID)
                                           select new { p.FirstName, p.LastName };

                                <tr><td></td><td>@comment.Commentation</td></tr>
                            }
                        </table>
                </div>                
            }
</div> 
```

每当数据从控制器传递到视图时，就会发生错误。

**我还需要来自所有三个表博客、图像和个人资料的数据**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:09:13.680

您`IEnumerable<anonymous type>`作为模型传递，而视图期望`IEnumerable<ACapture.Models.Blog>`。尝试

```
public ViewResult Index()
{
    ViewBag.Message = "ArchiCapture";
    var dateCheck = DateTime.Now.AddDays(-7);

    var results = (from r in db.Blog
                  join p in db.Image on r.ImageID equals p.ImageID
                  //join l in db.Account on p.AccountID equals l.AccountID
                  join a in db.Profile on p.AccountID equals a.AccountID
                  //where r.dte_created >= dateCheck
                   select r);

    return View(results);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T18:09:21.940

您正在使用投影来创建匿名类型。您的视图需要一个 IEnumerable。尝试选择新博客 { }

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T18:14:26.310

您的视图需要 ACapture.Models.Blog 的 IEnumerable。但是，您的查询和联接将返回一个新的 {Blog, Image, Profile}。就像您在 SQL 中进行连接并且不指定列时一样，您会将它们全部取回。这将创建一个匿名类型。您只想为博客选择{r}

# python - 如何测试依赖于 boto 和 Amazon AWS 服务的模块？

> ID：11765005
> 
> 赞同：14
> 
> 时间：2012-08-01T18:06:23.827
> 
> 标签：python, testing, mocking, boto, amazon-dynamodb

我正在编写一个非常小的 Python ORM `boto.dynamodb.layer2`。我想为它编写测试，但我不希望测试与 AWS 进行实际通信，因为这需要复杂的设置、凭据、网络访问等。

由于我计划开源该模块，因此在源代码中包含凭据似乎是个坏主意，因为我会为使用付费，并且在环境中包含凭据是一种痛苦。

将我的测试与网络耦合似乎是个坏主意，因为它会使测试运行速度变慢，或者可能由于网络错误或限制而导致测试失败。我的目标不是测试 boto 的 DynamoDB 接口或 AWS。我只想测试我自己的代码。

我打算用它[`unittest2`](http://pypi.python.org/pypi/unittest2/)来编写测试并[`mock`](http://pypi.python.org/pypi/mock/)模拟出网络上的 boto 部分，但我以前从未这样做过，所以我的问题归结为这些：

1.  我会以正确的方式解决这个问题吗？
2.  有没有其他人这样做过？
3.  `boto.dynamodb`界面中是否有最适合模拟的特定点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:14:19.767

我认为您有正确的方法，您绝对不希望您的测试与与 AWS 的实际通信联系在一起。嘲笑服务绝对是在这里做的正确的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-02T13:22:08.777

完整回答我的问题：

1.  与@pcalcao 的回答一样，嘲笑服务是正确的做法。它甚至没有我想象的那么难——测试代码只比被测代码略长，而且大部分是测试，而不是管道。

2.  感谢@gamaat 让我再看一遍，boto[在它自己的测试中](https://github.com/boto/boto/tree/develop/tests/unit)*确实*做到了这一点，在实际传输接口级别进行模拟，在.`httplib`

3.  模拟`boto.dynamodb.layer1`界面（连同`boto.connect_dynamodb`）被证明是正确的做法。设置间谍`boto.dynamodb.layer2`也`boto.dynamodb.table`有帮助。一旦我开始理解它，我发现与它[`mock`](http://www.voidspace.org.uk/python/mock/index.html)一起工作是一种乐趣。

[这是我的解决方案](https://github.com/eykd/duo/blob/master/test_duo.py)，BSD 许可。~~一旦我对它进行了更长时间的测试并整理了一些适当的文档，我将把整个库发布到 PyPI。~~ [我已将其发布到 PyPI。](http://pypi.python.org/pypi/duo)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-01T22:47:13.110

boto 中的所有测试最初都是针对实时服务端点的集成测试。我们仍然有这些测试，但也开始添加模拟单元测试。您可能想查看到目前为止的示例。

# php - MySQL 选择和删除行

> ID：11765014
> 
> 赞同：-4
> 
> 时间：2012-08-01T18:07:00.300
> 
> 标签：php, mysql, select

我有一个 cron 作业，我需要每分钟运行一次以检查数据库表。该表由两个字段（用户名、lastping）组成。lastping 是一个 mysql 日期时间对象，由另一个脚本使用 mysql`NOW()`函数设置。我需要检查 lastping 以查看它自上次更新以来是否已经超过一分钟，如果它在最后一分钟没有更新，我想删除包含该用户名和 lastping 的行。我想我可以使用类似这个 sql 语句的东西进行检查。

```
FROM client WHERE lastping < NOW() - INTERVAL 1 MINUTE; 
```

我的问题是，如何格式化 select 语句以检查整个表并删除记录，如果它已经超过一分钟。

对于仍然连接的用户，我将每 15-30 秒更新一次数据库。这样做的全部目的是让我看到哪些最终用户正在使用我的 C++ 应用程序，或者至少在过去 60 秒内，这样我就可以保持统计数据。

这就是我到目前为止所做的，输出是 Deleted inactive users 但这实际上并没有发生。

```
mysql_connect(SERVER, USERNAME, PASSWORD);
mysql_select_db(DATABASE);
$query="DELETE (username, lastping) from client where lastping < NOW() - INTERVAL 1 MINUTE";
mysql_query($query) or die ('Error updating database');
echo "Deleted inactive users"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:13:03.493

您不能在一个查询中删除和选择行。无法“返回”或“选择”已删除的行。

然后您可能想要使用事务，您将在单个事务中执行两个查询。 [http://dev.mysql.com/doc/refman/5.0/en/commit.html](http://dev.mysql.com/doc/refman/5.0/en/commit.html)

# apache-zookeeper - 动物园管理员没有启动

> ID：11765015
> 
> 赞同：28
> 
> 时间：2012-08-01T18:07:02.383
> 
> 标签：apache-zookeeper

我正在与动物园管理员（http://zookeeper.apache.org/）合作。下载 3.3.5 并创建 zoo.cfg 并放在 $ZOOKEEPER/conf 中，使用 zkServer start 启动 zookeeper。但以下是错误

任何人都可以在这里帮助我..

```
 nfig or no quorum defined in config, running  in standalone mode
 2012-08-01 23:20:32,175 [myid:] - ERROR [main:ZooKeeperServerMain@54] - Invalid
 arguments, exiting abnormally
 java.lang.NumberFormatException: For input string: "C:\Development\apps\zookeeper\zookeeper3.4.1\bin\..\conf\zoo.cfg"
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
        at java.lang.Integer.parseInt(Integer.java:449)
        at java.lang.Integer.parseInt(Integer.java:499)
        at org.apache.zookeeper.server.ServerConfig.parse(ServerConfig.java:60)
        at org.apache.zookeeper.server.ZooKeeperServerMain.initializeAndRun(ZooKeeperServerMain.java:83)
        at org.apache.zookeeper.server.ZooKeeperServerMain.main(ZooKeeperServerMain.java:52)
        at org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:116)
        at org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:78)
 2012-08-01 23:20:32,177 [myid:] - INFO  [main:ZooKeeperServerMain@55] - Usage: Z
 ooKeeperServerMain configfile | port datadir [ticktime] [maxcnxns]
 Usage: ZooKeeperServerMain configfile | port datadir [ticktime] [maxcnxns] 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-08-23T13:38:38.870

只需省略“start”参数，而是调用“bin\zkServer”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-17T05:38:08.967

在 zoo.cfg 文件中转到 dataDir=/usr/zookeeper/ ***data***

在***数据***文件夹中创建一个名为 myid 的文件并写入 1\. 保存文件并启动 zkServer

如果您正在运行多个实例，则对于每个实例，您需要在数据文件夹中创建 myid 文件并分别使用 1、2、3 写入。实际上这用于节点领导者选举。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-22T09:18:24.603

> java.lang.NumberFormatException：对于输入字符串：“C:\Development\apps\zookeeper\zookeeper3.4.1\bin..\conf\zoo.cfg”

看来您使用“start”和 zoo.cfg 文件的位置运行 zkServer，即“C:\Development\apps\zookeeper\zookeeper3.4.1\bin..\conf\zoo.cfg”，以及另一个参数，最多添加3个参数：

> ./zkServer start C:\Development\apps\zookeeper\zookeeper3.4.1\bin..\conf\zoo.cfg xxx

所以，这个问题可以通过简单地删除第二个和第三个参数来解决，这使得命令：

> ./zkServer 启动

这背后的原因是因为 zkServer 用于初始化 zookeeper 系统的类（QuorumPeerMain，ZooKeeperServerMain）接受各种数量的参数并相应地运行。当你给 zkServer 提供两个参数时，这两个参数背后的含义应该是 port 和 datadir。是的，端口应该是一个数字，你的炸弹来了。

顺便说一句，当您在没有任何参数的情况下执行引导脚本时，它们会附带帮助说明。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-20T04:16:51.657

打开zkServer.cmd，找到这一行

```
call %JAVA% "-Dzookeeper.log.dir=%ZOO_LOG_DIR%" "-Dzookeeper.root.logger=%ZOO_LOG4J_PROP%" "-Dzookeeper.log.file=%ZOO_LOG_FILE%" "-XX:+HeapDumpOnOutOfMemoryError" "-XX:OnOutOfMemoryError=cmd /c taskkill /pid %%%%p /t /f" -cp "%CLASSPATH%" %ZOOMAIN% "%ZOOCFG%" %* 
```

并删除`%*`行尾的。新的开始 cmd 行应该是：

```
call %JAVA% "-Dzookeeper.log.dir=%ZOO_LOG_DIR%" "-Dzookeeper.root.logger=%ZOO_LOG4J_PROP%" "-Dzookeeper.log.file=%ZOO_LOG_FILE%" "-XX:+HeapDumpOnOutOfMemoryError" "-XX:OnOutOfMemoryError=cmd /c taskkill /pid %%%%p /t /f" -cp "%CLASSPATH%" %ZOOMAIN% "%ZOOCFG%" 
```

然后运行`zkServer start`或`zkServer`。它现在应该可以工作了。

* * *

解释：

在 ZkServer 源代码中。ZooKeeperServerMain.java

```
protected void initializeAndRun(String[] args) throws ConfigException, IOException, AdminServerException {
    try {
        ManagedUtil.registerLog4jMBeans();
    } catch (JMException e) {
        LOG.warn("Unable to register log4j JMX control", e);
    }

    ServerConfig config = new ServerConfig();
    if (args.length == 1) {
        config.parse(args[0]);
    } else {
        config.parse(args);
    }

    runFromConfig(config);
} 
```

不同的参数长度有不同的解析方法。

如果有一个参数，它将作为配置文件路径。

在多个参数的情况下，有一个固定的顺序。

```
1st arg(must): server port.
2nd arg(must): dataDir
3rd arg(optional): tickTime
4th arg(optional): maxClientCnxns 
```

回到 zkServer.cmd，参数位置有两个占位符。

```
%ZOOMAIN% "%ZOOCFG%" %* 
```

我相信开发人员希望为`%*`.

然而，对于大多数 zk 用户来说。它们用于`zkServer start`启动服务器。

最后， cmd 原来是：

```
org.apache.zookeeper.server.quorum.QuorumPeerMain "C:\Users\...\scoop\apps\zookeeper\current\bin\..\conf\zoo.cfg" "start" 
```

使用了两个参数。第一个参数，这里的配置路径，作为端口号。然后我们有例外。

更多，`zkServer`直接使用启动zooKeeper怎么样？

就我而言，我面临着同样的问题。虽然我们没有任何争论。zkServer.cmd 仍然将一个空字符串传递给 main 方法。像这样：

```
org.apache.zookeeper.server.quorum.QuorumPeerMain "C:\Users\...\scoop\apps\zookeeper\current\bin\..\conf\zoo.cfg" "" 
```

结论：只需删除多余的占位符`%*`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-12T11:27:03.690

```
sudo ./zkServer.sh start
[sudo] password for administrator:
/bin/java
ZooKeeper JMX enabled by default
Using config: apache-zookeeper-3.5.5/bin/../conf/zoo.cfg
Starting zookeeper ... FAILED TO START 
```

解决方案是：`download bin.tar file "apache-zookeeper-3.5.5-bin.tar.gz "`我错误地下载了一个 tar 文件，

# python - 在独特的函数调用下重新缩放 Matplotlib imshow 中的轴

> ID：11765025
> 
> 赞同：6
> 
> 时间：2012-08-01T18:07:55.833
> 
> 标签：python, scale, axis, matplotlib

我编写了一个函数模块，它接受两个变量的参数。为了情节，我有

```
x, y = pylab.ogrid[0.3:0.9:0.1, 0.:3.5:.5]
z = np.zeros(shape=(np.shape(x)[0], np.shape(y)[1]))

for i in range(len(x)):
    for j in range(len(y[0])):    
        z[i][j] = fancyFunction(x[i][0], y[0][j])

pylab.imshow(z, interpolation="gaussian") 
```

我得到的图像如下： ![在此处输入图像描述](../Images/0c227ea80e54a681332cf4f11908a126.png)

但是当我尝试重新调整 x 和 y 轴以匹配 [0.3:0.9:0.1, 0.:3.5:.5] 的范围时，`pylab.imshow(z, interpolation="gaussian", extent=[.3,.9,0.,3.5])`我得到了

![在此处输入图像描述](../Images/25e176efc604f484d0347565bc0e5168.png)

我已经在谷歌上搜索了几个小时，但仍然找不到一种方法来制作具有不同比例轴的方形图。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T18:24:47.483

使用`aspect`参数：

```
pylab.imshow(z, interpolation="gaussian", extent = [.3,.9,0.,3.5], aspect='auto') 
```

# vb.net - SSIS 文档参考

> ID：11765026
> 
> 赞同：0
> 
> 时间：2012-08-01T18:07:59.167
> 
> 标签：vb.net, ssis

SSIS 脚本组件的参考文档在哪里？例如，脚本组件继承自一个名为 UserComponent 的类，并且被覆盖的函数具有一个类型为局部变量：input0buffer。我正在努力寻找解释这些类型的文档。我是 SSIS 的新手。

我意识到 SSIS 包是在 BIDS 中创建的。

我使用的脚本组件是使用 VB.NET 编写的。SSIS 脚本组件是 VB.NET 的扩展吗？

**更新** 我现在意识到 UserComponent 类是在运行时生成的，如下所述：http: [//msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.pipeline.scriptcomponent](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.pipeline.scriptcomponent)。我仍然不了解 hpw 以找到它实现的功能，例如 Input0_ProcessInputRow。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T20:05:19.840

开发脚本组件和任务所需的大部分内容都显示在此处：[开发人员指南（集成服务）](http://msdn.microsoft.com/en-us/library/ms136025%28v=sql.100%29)

# asp.net-mvc - 如何锁定 ASP.NET MVC 中的路径？

> ID：11765030
> 
> 赞同：16
> 
> 时间：2012-08-01T18:08:11.257
> 
> 标签：asp.net-mvc, web-config, forms-authentication, asp.net-authorization

我第一次使用 MVC 4 来检查与 MVC 3 相比发生了哪些更改/添加/等。

首先，我创建了一个空白的 MVC 4 Web 应用程序并从头开始构建。

我注意到在 MVC 4 中不同的第一件事是以下 web.config 设置对网页的可访问性没有影响：

```
<configuration>
    <location path="">
    <system.web>
      <authorization>
        <deny users="?"/>
      </authorization>
    </system.web>
    </location>
    .....
</configuration> 
```

回到 MVC 3，上面的授权设置将拒绝所有匿名用户访问站点内的任何内容。但是，如果我将相同的设置添加到 MVC4 Web.config 文件，匿名用户可以自由支配她/他选择的 URL。

我需要在 MVC 4 中做什么才能像在 MVC 3 中那样锁定所有路径？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-01T18:20:01.103

查看[保护您的 ASP.NET MVC 4 应用程序和新的 AllowAnonymous Attribute](http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx)。

> 您不能使用路由或 web.config 文件来保护您的 MVC 应用程序（任何版本）。保护 MVC 应用程序的唯一受支持的方法是应用 Authorize 属性...

[引用](http://blogs.msdn.com/b/rickandy/archive/2010/08/24/securing-your-mvc-application.aspx)

> MVC 使用路由并且不将 URL 映射到 WebForms、PHP 和传统 Web 服务器等物理文件位置。因此，使用 web.config 肯定会在您的站点中打开一个安全漏洞。

[如果以后有变化，产品团队会有沟通，但目前无一例外。](http://forums.asp.net/t/1583850.aspx/1/10)

例子：

从默认的 ASP.Net MVC 项目（internet/intranet）开始。

编辑 web.config 添加：

```
<location path="Home">
  <system.web>
    <authorization>
      <deny users="*">
    </authorization>
  </system.web>
</location> 
```

运行项目，默认情况下，您将使用*Default*路由`/Home/Index`并看到内容，只需绕过 web.config 而不更改默认模板。为什么？因为 ASP.Net 管道将请求的 URL 与 web.config 中指定的位置进行比较。但是，**在管道中执行授权事件后**，路由发生（默认路由或自定义路由）并允许访问所谓的受限区域。

此外，任何 MVC`Redirect()`还将绕过与在授权管道事件之后再次发生路由相同的安全措施。

我认为任何人都不应该接受*某种工作*安全性。第一次正确地做，不要偷懒，使用不是为特定技术设计的东西。

# ruby - Shopify API：有没有办法检索特定订单号的订单列表？

> ID：11765033
> 
> 赞同：2
> 
> 时间：2012-08-01T18:08:32.047
> 
> 标签：ruby, shopify

我正在使用 ShopifyAPI gem 来查找商店的订单 - 我知道我可以使用它来查找商店的所有订单：

```
ShopifyAPI::Order.find(:all) 
```

这可以找到 1 月 1 日之后创建的所有订单：

```
ShopifyAPI::Order.find(:all, :params => {:created_at_min => "2012-01-01"} 
```

但是，如果我有一个订单 ID 列表，比如`[1009, 1006]`- 有没有办法检索具有这些 ID 的商店的订单，还是我需要单独查找它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T18:56:59.433

您必须单独查找它们。

```
orders = [1009, 1006].collect {|order_id| Shopify::Order.find(order_id)} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-21T15:50:35.953

您可以通过以下方式一次性获得它们：

```
ShopifyAPI::Order.find(:all, :params => { :ids => "1009,1006" }) 
```

# objective-c - Core Data 删除对象但保存过去的数据

> ID：11765035
> 
> 赞同：0
> 
> 时间：2012-08-01T18:08:34.783
> 
> 标签：objective-c, object, core-data, nsmanagedobject

我正在尝试找到一种方法来将对象创建的数据保存在已删除的核心数据中。

例如，我有一个可以添加团队的应用程序。您可以将球员添加到该球队。在该团队中，您可以与其他团队进行比赛。该应用程序记录该游戏的数据。

如果我要删除一个参加比赛的球队，我怎么能让比赛仍然显示球队的所有数据，无论它是否被删除？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:11:33.507

不要使用级联删除关系。如果您这样做，那么您的数据仍然存在，您将无法通过团队访问它。

我不知道您要做什么，但请考虑不要删除团队。有很多方法可以让它看起来像是被删除（对用户而言），而不是从核心数据中实际删除它。

（编辑）例如，您可能要考虑添加一个 BOOL 类型的属性，以指示团队是否“活跃”。

**-更新-**

听起来您需要：

*   将级联删除关系更改为无效。这将使您在团队数据被删除后仍然可以访问它。无效关系只是将指向团队的指针更改为指向`nil`团队被删除的时间。
*   当您想要删除团队的数据（在团队被删除之后）时，遍历所有核心数据属性并删除指向`nil`团队的任何内容。您可以在不再需要信息时执行此操作

# json - SBJsonWriter 嵌套 NSDictionary

> ID：11765037
> 
> 赞同：2
> 
> 时间：2012-08-01T18:08:37.710
> 
> 标签：json, nsdictionary, sbjson

我正在尝试使用 Json 序列化 objc 对象以将其发送到服务器。

同一台服务器在 GET 上为此对象类型发送以下内容：

```
 {
   "TypeProperties":[
      {"Key":"prop 0","Value":"blah 0"},
      {"Key":"prop 1","Value":"blah 1"},
      {"Key":"prop 2","Value":"blah 2"},
      {"Key":"prop 3","Value":"blah 3"}
     ],
   "ImageURls":[
      {"Key":"url 0","Value":"blah 0"},
      {"Key":"url 1","Value":"blah 1"},
      {"Key":"url 2","Value":"blah 2"},
      {"Key":"url 3","Value":"blah 3"}
     ]
} 
```

SBJsonWriter 为我在 objc 中创建的匹配对象/类型生成以下内容：

```
{
  "TypeProperties": {
    "key 2": "object 2",
    "key 1": "object 1",
    "key 4": "object 4",
    "key 0": "object 0",
    "key 3": "object 3"
  },
  "ImageUrls": {
    "key 0": "url 0",
    "key 1": "url 1",
    "key 2": "url 2"
  }
} 
```

这就是我使用 SBJsonWriter 的方式：

```
SBJsonWriter *writer = [[SBJsonWriter alloc] init];
writer.humanReadable = YES;
NSString* json = [writer stringWithObject:itemToAdd]; 
```

这是我在被序列化的类中的 proxyForJson 实现（SBJsonWriter 需要）：

```
- (NSDictionary*) proxyForJson
{
      return [NSMutableDictionary dictionaryWithObjectsAndKeys:
                self.typeProperties, @"TypeProperties",
                self.imageUrls, @"ImageUrls",
                nil];
} 
```

被序列化的类只包含两个属性：typeProperties 和 imageUrls（都是 NSMutableDictionary）。

现在，问题是：当我执行 POST 时，服务器（毫不奇怪）不解析 SBJsonWriter 生成的 Json。问题是：如何生成与服务器提供的 Json 匹配的 Json（假设在上传时会正确解析匹配的 Json）。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T07:54:34.360

这是一个演示如何使用 SBJsonWriter 的简单代码：

```
#import <Foundation/Foundation.h>

#import "SBJsonWriter.h"

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        NSDictionary* aNestedObject = [NSDictionary dictionaryWithObjectsAndKeys:
                                              @"nestedStringValue", @"aStringInNestedObject",
                                              [NSNumber numberWithInt:1], @"aNumberInNestedObject",
                                         nil];

        NSArray * aJSonArray = [[NSArray alloc] initWithObjects: @"arrayItem1", @"arrayItem2", @"arrayItem3", nil];

        NSDictionary * jsonTestDictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                                             @"stringValue", @"aString",
                                             [NSNumber numberWithInt:1], @"aNumber",
                                             [NSNumber numberWithFloat:1.2345f], @"aFloat",
                                             [[NSDate date] description], @"aDate",
                                             aNestedObject, @"nestedObject",
                                             aJSonArray, @"aJSonArray",
                                             nil];

        // create JSON output from dictionary

        NSError *error = nil;
        NSString * jsonTest = [[[SBJsonWriter alloc] init] stringWithObject:jsonTestDictionary error:&error];

        if ( ! jsonTest ) {
            NSLog(@"Error: %@", error);
        }else{
            NSLog(@"%@", jsonTest);
        } 
    }
    return 0;
} 
```

输出

```
{
    "aDate":"2012-09-12 07:39:00 +0000",
    "aFloat":1.2345000505447388,
    "nestedObject":{
        "aStringInNestedObject":"nestedStringValue",
        "aNumberInNestedObject":1
     },
    "aJSonList":["arrayItem1","arrayItem2","arrayItem3"],
    "aString":"stringValue",
    "aNumber":1
} 
```

笔记：

1.  使用“错误”让我发现，如果你写的是 [NSDate date] 而不是 [[NSDate date] description]，你会得到一个“__NSTaggedDate 不支持 JSON 序列化”错误。
2.  注意浮点舍入错误... 1.2345 变为 1.2345000505447388

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T02:42:20.323

在 JSON 中，`{ }`表示一个对象（键/值对）并`[ ]`表示一个数组。从您提供的示例来看，这是您的服务器所期望的：

**顶部对象**：具有两个键的字典：`TypeProperties`和`ImageUrls`。

**TypeProperties**和**ImageUrls**：每个都是一个数组，包含一个或多个具有两个键的对象：`Key`和`Value`。每个键都应该有其各自的值。

为了符合你的服务器的期望，你需要一个类似的结构（注意这只是一个简单的例子，直接写在这里，但应该指出你正确的方向）：

```
NSDictionary *object = [NSDictionary dictionaryWithObjectsAndKeys:
                        @"prop 0", @"Key",
                        @"blah 0", @"Value",
                        nil];

NSArray *typeProperties = [NSArray arrayWithObjects:
                           object, // Add as many similar objects as you want
                           nil];

NSArray *imageUrls = [NSArray arrayWithObjects:
                      object, // Add as many similar objects as you want
                      nil]; 
```

然后，在您的`proxyForJson`方法中，您可以使用：

```
- (NSDictionary*) proxyForJson
{
      return [NSDictionary dictionaryWithObjectsAndKeys:
              typeProperties, @"TypeProperties",
              imageUrls, @"ImageUrls",
              nil];
} 
```

# java - C++ 到 Java：有效地搜索集合

> ID：11765045
> 
> 赞同：8
> 
> 时间：2012-08-01T18:09:00.850
> 
> 标签：java, c++, collections, map, set

来自主要是 C++ 背景的我现在正在愤怒地编写一些 Java。我发现使用 STL 在 C++ 中基本的东西在 Java 中似乎比我认为的更麻烦。我的结论是，可能有一个更好的 Java 习惯用法我还没有掌握。这是一个使用伪代码的示例。

我有一组基于某些恰好是字符串的成员变量具有自然排序关系的事物。

```
class Thing
{
   String key1;
   String key2;
} 
```

在 C++ 中，我可能会定义一个排序运算符<(Thing,Thing) 并将它们放在 std::set 中。例如

```
///
/// @brief
/// provide a total order for 'Things' using key1 and key2
///
bool operator<(const Thing& a, const Thing& b)
{
  if (a.key1 < b.key1) return true; 
  else if (a.key1 > b.key1) return false; 
  else return a.key2 < b.key2;
} 
```

然后，我可以使用 set::find 在 O(log N) 时间内找到元素，以应对拥有事物的情况。使用 operator<() 的额外重载。我可以使用 std::lower_bound 或 std::equal_range 搜索只有 key1 或同时拥有 key1 和 key2。例如：

```
struct Ordering
{
   /// A strict weak ordering not a total ordering
   bool operator()(const Thing& A,const std::string& key1) const;
}

const_iterator iter = std::lower_bound(someThings.begin(),
                                       someThings.end(),
                                       key1,
                                       Ordering()); 
```

为了不那么抽象，想象 key1 是名称，key2 是版本。我可以问我们是否有任何名为 Foobar 的软件，或者更具体地说，我们是否有 Foobar v1.0。

从表面上看，Java 中 std::set 最直接的等价物似乎是 TreeSet ，可以通过继承 Comparator 接口来实现排序。然而，对于我所说的，看起来需要多个地图才能在 Java 中执行此操作。在 C++ 中，如果我想更改值，只会费心使用像 std::map 这样的关联容器。在 C++ std::set 中，就像在 Java TreeSet 中一样，值是它自己的键。但是，在 C++ 中，我可以编写比较器来使用 key1 或 key2 将“Thing”与“std::string”进行比较，并在它们的 std::set 中找到特定的东西。在我看来，您必须使用 Map 在 Java 中执行此操作。否则（因为 Comparator 只有一个类型参数）你最终会遇到这样的混乱：

```
public static class Order implements Comparator<Object>
{
  @Override
  @Constant
  public int compare(Object a, Object b)
  {
     String aString;
     String bString;         
     if (a instanceof String)
     {
        aString = (String)a;
     }
     else if (a instanceof Thing)
     {
        aString = ((Field)a).getKey1();
     }
     else
     {
        throw new ClassCastException("String or Field object expected.");
     }
     if (b instanceof String)
     {
        bString = (String)b;
     }
     else if (b instanceof Thing)
     {
        bString = ((Field)b).getKey1();
     }
     else
     {
        throw new ClassCastException("String or Field object expected.");
     }
     return aString.compareTo(bString);
  }
}; 
```

但是，如果您这样做，您可以（在 Thing 类中）编写：

```
Set<Thing> things = new TreeSet<Thing>(new Order());

boolean hasFieldWithKey1(final String key1) 
{
   return this.fields.contains(key1);
} 
```

使用 Java Set，您只能测试是否存在，但不能检索您正在搜索的对象。例如你不能做

```
Field getFieldWithKey1(final String key1) 
{
   return this.fields.floor(key1);
} 
```

因为像 floor() 这样的方法只接受值类型的对象（即 Thing）

显而易见的解决方案是为每个键使用一个 Map。

```
Map<String,Thing> thingsByKey1 = new TreeMap<Thing>(new Order()); 
```

来自 C++ 背景，这似乎不必要地臃肿。当东西已经包含它时，为什么我要再次存储它？如果我有两把钥匙，那就更糟了。我需要两张地图。

```
Map<String,Thing> thingsByKey1 = new TreeMap<Thing>(new OrderByKey1());
Map<String,Thing> thingsByKey2 = new TreeMap<Thing>(new OrderByKey2()); 
```

我现在不仅要复制密钥，还要创建额外的不必要的树数据结构（或具有更好运行时性能的 HashMap）。对于上面的排序实现，这也可能是“完全错误的”，因为每个键本身仅形成部分顺序，而不是一组事物的总顺序。

我已经看到这里使用线性搜索回答了有关搜索的问题，这几乎总是最糟糕的选择。例如

[查找集合中具有给定属性的所有对象](https://stackoverflow.com/questions/587404/java-finding-objects-in-collections)

我注意到有一个 BinarySearch 版本接受 Comparator 对象作为参数，但返回元素的索引而不是元素本身。这意味着在使用它之后对 get() 进行不必要的调用（假设集合支持它）。

那么在时间和空间上有效地做到这一点的 Java 方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:15:58.790

执行此操作的 Java 方法是，是的，使用`Map`.

> 来自 C++ 背景，这似乎不必要地臃肿。当东西已经包含它时，为什么我要再次存储它？

这并没有你想象的那么多开销。您正在存储一个对 的额外引用`String`，总成本为...4 个字节。（实际上，成本为零：`TreeSet`实现占用的内存与 .) 完全相同`TreeMap`。）

如果要使用两个键进行搜索，可以使用`Comparator<Thing>`比较两个键的 a ，或者 make `Thing`implement `Comparable<Thing>`，然后维护 a `TreeSet<Thing>`。`Comparator`这比你上面写的……不愉快要紧凑得多。如果你想用一个键搜索，只需使用`Map<String, Thing>`. 如果您真的非常想同时搜索两者，请同时维护它们。（实际上，我几乎从来不需要这样做……JDK Collections 框架的作者也不认为你需要经常这样做。）

# silverlight - Silverlight RIA 应用程序在部署时无法连接到数据库

> ID：11765047
> 
> 赞同：1
> 
> 时间：2012-08-01T18:09:08.360
> 
> 标签：silverlight, deployment, ria

我已经开发了一个 Silverlight RIA 应用程序。现在我正在尝试将它部署到本地 IIS7 但使用远程 SQL 数据库。部署后，应用程序正在运行，但它无法连接到 SQL 服务器。我已经生成了架构和数据到远程 SQL 服务器..但应用程序无法连接到 SQL 服务器。

在 web.config 中，指定的连接字符串是：

```
 <connectionStrings>
<add name="IspahaniAgroLTDEntities" connectionString="metadata=res://*/AgroModel.csdl|res://*/AgroModel.ssdl|res://*/AgroModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\SqlExpress;initial catalog=NewLocalDataBase;inut it's tegrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

我试图替换 web.debug.config 和 web.release.config 中的连接字符串，如 ASP.NET，但它不能那样工作。谁能告诉我如何在部署时将连接字符串更改为新的 SQL 服务器.

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T00:03:07.487

不要使用集成安全性。这通常对开发场景很有用。改为设置用户 ID 和密码。

```
 connectionString="
    metadata=res://*/AgroModel.csdl|res://*/AgroModel.ssdl|res://*/AgroModel.msl;
    provider=System.Data.SqlClient;
    provider connection string=&quot;
      data source=YOUR_DBSERVER;
      initial catalog=YOUR_DBNAME;
      user id=YOUR_USER;
      password=YOUR_PASSWORD;
      multipleactiveresultsets=True;
      App=EntityFramework&quot;" 
```

原因是远程 IIS 被配置为以无权访问 SQL Server 的用户身份运行。

# php - 在 PHP 中使用准备好的语句时出现致命错误

> ID：11765049
> 
> 赞同：0
> 
> 时间：2012-08-01T18:09:21.637
> 
> 标签：php, mysql, prepared-statement

这是这种情况。我创建了 3 个 PHP 文件，都在同一个项目文件夹中：

1.  常量.php
2.  Mysql.php（类）
3.  索引.php

当我运行 index.php 时，我得到：

> 致命错误：调用 C:\wamp\www\MyBlog\MyClass\MySql.php 中非对象的成员函数 prepare() 在线 #

常量.php：

```
<?php
//Define constent her
define('DB_SERVER', 'localhost');
define('DB_USER', 'root');
define('DB_PASSWORD', '');
define('DB_NAME', 'myblog'); 
```

mysql.php：

```
<?php 

require_once 'constants.php';

class MySql{
        private $conn;
        protected $_query;

    function __constructert() {
        $this->conn = new mysqli(DB_SERVER,DB_USER,DB_PASSWORD,DB_NAME) or
        die("There was a probelm connecting the database");
        return $this->conn;
    }
    protected function _prepareQuery() 
   {
//her the line that problem come from beetwen the () of if : 
      if (!$stmt = $this->conn->prepare($this->_query)) {
         trigger_error("Problem preparing query", E_USER_ERROR);
      }
      return $stmt;
   }

    protected function _dynamicBindResults($stmt){
        $meta=$stmt->result_metadata();
        while ($field = $meta->fetch_field()) {
            print_r($field);
        }
    }

    function query($query){
        $this->_query = filter_var($query,FILTER_SANITIZE_STRING);
        $stmt = $this->_preparequery();
        $stmt->execute();
        $results=$this->_dynamicBindResults($stmt);
    } 
```

索引.php：

```
<? PHP
        include 'MySql.php';
        $Db= new MySql();
        $Db->query("select * from status"); 
```

正如我所说，当我运行 index.php 时，我得到了这个：

> 致命错误：在线调用 C:\wamp\www\MyBlog\MyClass\MySql.php 中非对象的成员函数 prepare()

那条线是：

```
if (!$stmt = $this->conn->prepare($this->_query)) { 
```

有关更多信息，我测试了与数据库的连接，没关系。我测试了该`_query`属性是否采用 SQL 语句，并且确实如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:12:39.490

您的类的构造函数`MySQL`名为`__constructert()`；正确的构造函数名称是[`__construct()`](http://php.net/manual/en/language.oop5.decon.php).

使用无效的名称，该行`$Db = new MySQL();`创建对象但从不调用构造函数——因此从不创建 MySQL 连接/`$conn`对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:12:00.937

你这里有错字`->_preparequery();`

将其更改为以下内容：

```
function query($query){         
  $this->_query = filter_var($query,FILTER_SANITIZE_STRING);         
  $stmt = $this->_prepareQuery();         
  $stmt->execute();         
  $results=$this->_dynamicBindResults($stmt);     
} 
```

# ruby-on-rails - 您如何对顶部有 Facebook 好友的用户列表进行排序？

> ID：11765053
> 
> 赞同：1
> 
> 时间：2012-08-01T18:09:33.180
> 
> 标签：ruby-on-rails, facebook, facebook-graph-api, facebook-oauth

我希望能够从我的应用程序返回一个用户列表，其中当前用户的 Facebook 朋友首先列出。我看到有一些方法可以查询 Graph API 以返回使用应用程序的用户的朋友，但我希望能够显示在我的网站上采取了特定操作的用户列表，并按照首先列出的 FB 朋友对他们进行排序，所以每当我显示用户列表时，我都可以进行这种排序。

我见过的最好的例子是在 meetup.com 上。他们在显示参加聚会的人员列表时会这样做。这是一个例子：

![Meetup 如何首先对包含 FB 好友的用户列表进行排序的示例](../Images/f3d226abb4f66deb73ba5c2502d6f263.png)

我不知道它会对任何人产生任何影响，但它是一个 Rails 应用程序，我正在使用 OmniAuth 通过 Facebook 进行身份验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T22:37:31.330

您无法按好友状态排序，因为没有好友状态列。您不能执行任何复杂的 SQL 操作，将*朋友*表与另一个表连接或联合，因为 FQL 不支持这些操作。您能做的最好的事情就是通过单独的查询来确定朋友是谁......

```
SELECT uid FROM friend WHERE uid IN (...ALL USER IDs...) 
```

从该查询返回的所有*uid*都将是您完整列表的一个子集，仅包括那些是朋友的人。

***附加信息***：

Meetup 应用程序是...

1.  首先查询它的本地数据库以生成参与者列表。（让我们调用结果 [ `participants`] ）
2.  *然后，他们对 facebook好友*数据库执行查询，以确定其中哪些 [ `participants`] 是好友。（让我们调用结果 [ `participating_friends`] ）

    **从朋友那里选择 uid WHERE uid IN ([ `participants`])**

3.  `participating_friends`他们还将 [ ] uid 的列表存储在本地数据库中。一列是用户的 id ( *uid* )，另一列是他们朋友的 uid ( *friendid* )。

4.  最后，为了确定*朋友的朋友，*他们使用如下查询查询本地朋友数据库（从 3 开始）：

    ***从local_friends* WHERE *uid* IN ([ `participating_friends`])中选择friendid**

**更新**：回想起来，Meetup 可能会撒下更广泛的网络，如下所示：

Meetup 应用程序是...

1.  首先查询它的本地数据库以生成参与者列表。（让我们调用结果 [ `participants`] ）
2.  *然后，他们对 facebook好友*数据库执行查询，以确定其中哪些 [ `participants`] 是好友。（让我们调用结果 [ `participating_friends`] ）

    **从朋友那里选择 uid WHERE uid IN ([ `participants`])**

3.  确定应用程序用户的**所有**朋友也是应用程序用户，并将结果存储在本地数据库中，保存*uid*和相关联的*friendid*。

    **SELECT uid FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND is_app_user**

4.  最后，确定*朋友的朋友*，计算新的集合：

    [ `participants_not_friends`] = [ `participants`] - [ `participating_friends`]。

    然后使用如下查询查询本地好友数据库（从 3 开始）：

    ***从local_friends* WHERE *uid* IN ([ `participants_not_friends`])中选择friendid**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T20:46:06.160

是的，您可以获得每个用户的好友列表。这是我将如何做到的。

在注册时，如果用户在 Facebook 上注册，您将他们的 ID 存储在数据库中。

当经过身份验证的用户查看您的一条记录时，通过 API 发出此 FQL 查询：

```
SELECT uid, name, pic_square, mutual_friend_count FROM user 
 WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me())
   AND is_app_user 
 ORDER BY mutual_friend_count DESC 
```

这将使您返回您的应用程序的其他用户，这些用户与当前用户是朋友，按您的应用程序用户和每个朋友之间的共同朋友计数排序（假设更亲密的朋友有更多的共同朋友）。

您可以通过将此查询的结果与数据库中存储的 Facebook id 进行比较，将此列表与数据库中的任何其他指标进行比较。

显示朋友的朋友是一个更棘手的提议。如果您尝试此查询：

```
SELECT uid2 FROM friend WHERE uid1 IN 
 (SELECT uid2 FROM friend WHERE uid1 = me() LIMIT 1) 
```

它会引发权限错误。Facebook 不允许你交朋友的朋友。

如果它对您的应用很重要，您可以通过在每次登录时缓存每个应用用户的最新朋友列表（或者如果您还要求提供扩展访问令牌，则按计划）并查询此表以查看是否与所有用户的朋友有共同的朋友。您需要仔细查看 TOS 以了解其合法性。

# sql - SQL Server 2008 if else 函数中的语句并根据 bool 值将 int 替换为字符串

> ID：11765054
> 
> 赞同：0
> 
> 时间：2012-08-01T18:09:34.210
> 
> 标签：sql, sql-server-2008

我有一个`@returnValue`从函数获取的 varchar

**AnimalName** varchar **AnimalType** varchar **BigSmall** int （值为 1 或 0 ）

只需制作一个如下所示的长字符串

```
@returnValue = @returnValue + AnimalName + ' ' 
+ AnimalType  + '  ' +  convert(varchar, BigSmall) + ': ' 
```

如果值为 0 到“小”，如果值为 1 到“大”，我想替换 BigSmall 并将其添加到我的字符串 @returnValue

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:11:51.357

您将需要在该字段`CASE`周围使用声明：`BigSmall`

```
@returnValue = @returnValue 
                + AnimalName + ' ' 
                + AnimalType  + '  ' 
                + CASE WHEN BigSmall = 0 THEN 'Small' ELSE 'Big' END + ': ' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:13:39.177

使用这个表达式：

```
case BigSmall
  when 0 then 'Small'
  when 1 then 'Big'
  else 'Oops' end 
```

# python - 打乱两个相关列表的更好方法

> ID：11765061
> 
> 赞同：38
> 
> 时间：2012-08-01T18:10:21.463
> 
> 标签：python, list, shuffle

有没有更好的方法来随机打乱两个相关列表而不破坏它们在另一个列表中的对应关系？我在其中找到了相关的问题`numpy.array`，`c#`但并不完全相同。

作为第一次尝试，一个简单的`zip`技巧就可以了：

```
import random
a = [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]
b = [2, 4, 6, 8, 10]
c = zip(a, b)
random.shuffle(c)
a = [e[0] for e in c]
b = [e[1] for e in c]
print a
print b 
```

它将得到输出：

```
[[1, 2], [7, 8], [3, 4], [5, 6], [9, 10]]
[2, 8, 4, 6, 10] 
```

就是觉得有点别扭。它还需要一个额外的列表。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-01T18:15:54.930

鉴于问题中展示的关系，我将假设列表的长度相同，并且`list1[i]`对应`list2[i]`于任何 index `i`。有了这个假设，改组列表就像改组索引一样简单：

```
 from random import shuffle
 # Given list1 and list2

 list1_shuf = []
 list2_shuf = []
 index_shuf = list(range(len(list1)))
 shuffle(index_shuf)
 for i in index_shuf:
     list1_shuf.append(list1[i])
     list2_shuf.append(list2[i]) 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-01-14T10:47:21.030

如果您愿意安装更多软件包：

要求：NumPy (>= 1.6.1)、SciPy (>= 0.9)。

pip install -U scikit-learn

```
from sklearn.utils import shuffle
list_1, list_2 = shuffle(list_1, list_2) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-01T18:16:48.600

如果您必须经常这样做，您可以考虑通过改组索引列表来添加一个间接级别。

```
Python 2.6.6 (r266:84297, Aug 24 2010, 18:13:38) [MSC v.1500 64 bit (AMD64)] on
win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import random
>>> a = [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]
>>> b = [2, 4, 6, 8, 10]
>>> indexes = range(len(a))
>>> indexes
[0, 1, 2, 3, 4]
>>> random.shuffle(indexes)
>>> indexes
[4, 1, 2, 0, 3]
>>> for index in indexes:
...     print a[index], b[index]
...
[9, 10] 10
[3, 4] 4
[5, 6] 6
[1, 2] 2
[7, 8] 8 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-04-17T16:36:35.877

到目前为止，所有解决方案都创建了新列表以解决问题。如果列表*a*和*b*很长，您可能需要将它们打乱。为此，您需要一个函数，例如：

```
import random

def shuffle(a,b):
    assert len(a) == len(b)
    start_state = random.getstate()
    random.shuffle(a)
    random.setstate(start_state)
    random.shuffle(b)

a = [1,2,3,4,5,6,7,8,9]
b = [11,12,13,14,15,16,17,18,19]
shuffle(a,b)
print(a) # [9, 7, 3, 1, 2, 5, 4, 8, 6]
print(b) # [19, 17, 13, 11, 12, 15, 14, 18, 16] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-18T10:02:17.280

使用 numpy 的快速答案请参考[这里](https://stackoverflow.com/a/4602224/2792278)：
您可以使用

```
p = numpy.random.permutation(len(a)) 
```

为两个列表创建一个新的索引列表并使用它重新排序它们。

在您的场景中：

```
In [61]: a = [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]
In [62]: b = [2, 4, 6, 8, 10]
In [63]: import numpy as np
In [64]: a_ar, b_ar = np.array(a), np.array(b)
In [65]: p = np.random.permutation(len(a))
In [66]: a, b = a_ar[p].tolist(), b_ar[p].tolist()
In [68]: a
Out[68]: [[3, 4], [7, 8], [5, 6], [1, 2], [9, 10]]
In [69]: b
Out[69]: [4, 8, 6, 2, 10] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-16T09:56:52.383

您可以在最后解压缩以减少尴尬吗？

```
import numpy as np
list1 = [1,2,3]
list2 = [4,5,7]
list_zipped = list(zip(list1,list2))
np.random.shuffle(list_zipped)
list1,list2 = zip(*z) #unzipping 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-01T18:17:29.920

我不确定我是否在这里遗漏了一些东西，但看起来你只是在洗牌其中一个列表，另一个重新排列以匹配第一个列表的顺序。所以你所拥有的是最好的方法来做到这一点，而不会使它变得更复杂。如果你想走复杂的路线，你可以只打乱 1 个列表并使用未打乱的列表在打乱的列表中进行查找并以这种方式重新排列。最后，您会得到与开始时相同的结果。为什么创建第三个列表是个问题？如果您真的想回收列表，那么您可以简单地将列表 b 替换为您用于列表 c 的内容，然后稍后将其分离回 a 和 b。

# email - Zend Framework 2 邮件 SmtpOptions SSL

> ID：11765065
> 
> 赞同：1
> 
> 时间：2012-08-01T18:10:42.370
> 
> 标签：email, ssl, zend-framework2, smtp

我试图弄清楚如何使用 Zend SMTP 传输和 SSL 发送电子邮件。新的 SmtpOptions 类似乎不包含 ssl 的属性。任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:06:39.670

这是将 SSL 选项传递给类的示例`SmtpOptions`：

```
use Zend\Mail\Transport\Smtp as SmtpTransport;
use Zend\Mail\Transport\SmtpOptions;

// Setup SMTP transport using LOGIN authentication
$transport = new SmtpTransport();
$options   = new SmtpOptions(array(
    'name'              => 'localhost.localdomain',
    'host'              => '127.0.0.1',
    'connection_class'  => 'login',
    'connection_config' => array(
        'username' => 'user',
        'password' => 'pass',
        'ssl'      => 'tls', // can use tls or ssl
    ),
));
$transport->setOptions($options);
$transport->send($message); 
```

希望有帮助。

# r - 无法安装“zoo”包（R 版本 2.15.1）

> ID：11765067
> 
> 赞同：2
> 
> 时间：2012-08-01T18:10:42.660
> 
> 标签：r, zoo

我目前使用的是 R 版本 2.15.1，我正在尝试安装“zoo”包，但出现以下错误：“包 'zoo' 不可用（对于 R 版本 2.15.1）”。文档说它取决于 R>=2.10.0，是否有任何我需要安装的附加包取决于它？我正在使用函数“install.packages”来尝试安装这个包，任何想法谢谢。

```
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
[1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
[3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
[5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
[7] LC_PAPER=C                 LC_NAME=C                 
[9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] ggplot2_0.9.0    lattice_0.20-6   nlme_3.1-104     MASS_7.3-19     
[5] rms_3.5-0        Hmisc_3.9-3      survival_2.36-14

loaded via a namespace (and not attached):
[1] cluster_1.14.2     colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2      
[5] grid_2.15.1        memoise_0.1        munsell_0.3        plyr_1.7.1        
[9] proto_0.3-9.2      RColorBrewer_1.0-5 reshape2_1.2.1     scales_0.2.0      
[13] stringr_0.6        tcltk_2.15.1       tools_2.15.1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:54:25.910

我之前遇到过这个问题，因为某个特定的镜像似乎暂时遇到了某个包的问题。如果该镜像是默认值，则可能会出现问题。

`chooseCRANmirror()`在这些情况下，选择新的默认镜像很有帮助。选择不同的镜像后，在我的案例中找到并成功安装了该软件包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T15:46:13.723

chooseCRANmirror() 为我在 RStudio 工作。将镜子更改为 UC Berkeley 66。之后直接安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T23:09:02.380

我得到了同样的错误，但在 R-Studio 中使用了不同的包。提示`chooseCRANmirror()`不适用于 R-Studio（我尝试了不同的镜像），所以我开始使用裸 R 控制台。

在 R 控制台中，该命令`install.packages("xts")`运行良好（尽管 R 要求我先从列表中选择一个镜像）。

# java - OpenJDK 和 Ubuntu 服务器

> ID：11765068
> 
> 赞同：0
> 
> 时间：2012-08-01T18:10:46.643
> 
> 标签：java, linux, openjdk

这更像是一个关于 OpenJDK 和被删除的包的一般问题。

我正在删除`libatk-wrapper-java`. 但是，当我使用 apt-get 删除它时，它说`openjdk-7-jre`也将被删除。我的问题是，即使删除后我仍然能够成功使用 java 命令`openjdk-7-jre`，这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:26:51.960

您可以使用它来找出正在使用的 Java 命令的位置：

```
which java 
```

然后，使用它`ls -l`来找出这是否是一个符号链接，如果是，它指向的位置。（很有可能它会指向 中的某些`/etc/alternatives`内容，至少它在我的系统上是这样。）

继续使用`ls -l`链接，直到找到正在运行的真正二进制文件。

然后，使用它来找出哪个包拥有二进制文件：

```
dpkg -S $PATH_TO_JAVA_BINARY 
```

在我的机器上，这个过程是这样的：

```
AWS:~$ which java
/usr/bin/java
AWS:~$ ls -l /usr/bin/java
lrwxrwxrwx 1 root root 22 Jul 30 22:47 /usr/bin/java -> /etc/alternatives/java*
AWS:~$ ls -l /etc/alternatives/java
lrwxrwxrwx 1 root root 45 Jul 30 22:47 /etc/alternatives/java -> /usr/lib/jvm/java-6-openjdk-i386/jre/bin/java*
AWS:~$ dpkg -S /usr/lib/jvm/java-6-openjdk-i386/jre/bin/java
openjdk-6-jre-headless: /usr/lib/jvm/java-6-openjdk-i386/jre/bin/java 
```

这告诉我该软件包`openjdk-6-jre-headless`已安装，这就是我`java`在命令提示符下键入时运行的 Java 二进制文件的所有权。（不过，您的系统上可能还有一个或多个其他 JVM。这只是告诉我哪一个是默认的。）

这可能不是回答您问题的最快方法，但它有望帮助您更好地了解您的系统设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:15:36.313

你有没有安装任何其他的JDK？我也在使用LINUx，它带有openjdk-6。你是这样吗？签入 /usr/share/doc/openjdk-6-jre

# c# - 更改自定义 Http404 错误页面的默认视图文件夹

> ID：11765070
> 
> 赞同：0
> 
> 时间：2012-08-01T18:10:50.440
> 
> 标签：c#, asp.net-mvc-3, http-status-code-404, global-asax, viewengine

我想在我的 asp.net mvc3 网站中自定义错误页面。

所以，我发现这篇非常有用的帖子：[asp.net MVC3 上的自定义错误页面](https://stackoverflow.com/questions/5226791/custom-error-pages-on-asp-net-mvc3)，它运行良好

但是，我的`Http404.cshtml`文件不在`Views`默认文件夹中。它位于一个名为`BaseViews`. 我已经`_Layout.cshtml`在该文件夹中有我的视图和其他视图或部分视图。

默认情况下不检查此文件夹`ViewEngine`（它只检查文件夹和my`Views`的所有文件夹）。因此，我使用 ViewEngineExtension 并将其添加到我的. 我所有的应用程序都运行良好，可以访问我的布局和其他内容。`views``Areas``System.Web.Mvc.ViewEngines``Global.asax``Application_Start()``BaseViews`

我不能对`Global.asax`'s说同样的话`Application_Error()`。此方法忽略以前的视图引擎，只查看默认视图文件夹。我试图`Application_Error()`像这样在方法中添加我的 ViewEngineExtension ，`ViewEngines.Engines.Add(new BaseViewsEngineExtension());`但它没有改变任何东西。这与我在`Application_Start()`.

请参阅我的代码`Application_Error()`：

```
protected void Application_Error()
{
    var exception = Server.GetLastError();
    var httpException = exception as HttpException;
    Response.Clear();
    Server.ClearError();
    var routeData = new RouteData();
    routeData.Values["controller"] = "Error";
    routeData.Values["action"] = "Index";
    routeData.Values["exception"] = exception;
    Response.StatusCode = 500;
    if (httpException != null)
    {
        Response.StatusCode = httpException.GetHttpCode();
        switch (Response.StatusCode)
        {
            case 404:
                routeData.Values["action"] = "Http404";
                break;
        }
    }

    IController errorController = new ErrorController();
    var rc = new RequestContext(new HttpContextWrapper(Context), routeData);
    errorController.Execute(rc);
} 
```

我的问题是：如何强制`errorController.Excecute(rc)`视图引擎在`BaseViews`文件夹中搜索我的 Http404.cshtml 视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:14:53.953

更改`Http404`操作以返回其视图的完整路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T10:11:23.240

正如 SLaks 所说，您应该在 ErrorController 中返回视图的完整路径。

```
 public class ErrorController : Controller
  {
      public ActionResult Http404()
      {
          return View("~/BaseViews/Error/Http404.cshtml");
      }
  } 
```

但它不起作用，因为你的错误被覆盖了，所以你没有得到预期的结果。为了绕过这个问题，你可以告诉你的应用程序在你的 application_error 中一切正常：

```
Request.StatusCode = 200; 
```

我希望它能解决你的问题。

# php - 试图将 HTTP_REFERER 写入 referer.txt 但它不起作用

> ID：11765072
> 
> 赞同：0
> 
> 时间：2012-08-01T18:10:52.617
> 
> 标签：php, javascript, apache, tracking, referrer

我有几个问题。我在 Joomla 中工作。我正在尝试使用此 php 代码将引荐来源网址写入referer.txt，但我在 joomla 的任何地方都找不到“referer.txt”：

```
<?php 
$referer = get_en("HTTP_REFERER");
if($referer){
$fp=fopen("referer.txt","a")||die("Could not open referer file!");
fwrite($fp,$referer);
fclose($fp);
}
?> 
```

但是，登台页面不会在 firebug 中引发任何错误。

老板想要一个特定页面的推荐人记录（我正在使用这个特定页面作为测试。它不是目标页面）。

我的问题是：

1.  如果上面的代码没有失败，那么referer.txt 到底在哪里？

2.  还有另一种方法吗？比如这个页面[http://www.webvanta.com/post/248869-using-referrer-urls-to-better-understand](http://www.webvanta.com/post/248869-using-referrer-urls-to-better-understand)建议使用javascript构建cookies来跟踪referrer，而这个站点[http://webdesign.about .com/cs/loganalysistools/a/aaloganalysis.htm](http://webdesign.about.com/cs/loganalysistools/a/aaloganalysis.htm)建议使用网络日志和日志分析工具。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:28:56.460

第一行`$referer = get_en("HTTP_REFERER");`是 using `get_en()`，但内置函数是[`getenv()`](http://php.net/manual/en/function.getenv.php).

访问当前用户的引荐来源的另一种方法是通过`$_SERVER['HTTP_REFERRER'];`参数 - 尽管根据文档，这与使用`getenv()`.

跟踪引用者的服务器端方法是解析 Apache 创建的[access_log](http://httpd.apache.org/docs/2.2/logs.html)文件。这些日志将为您提供请求日期、请求类型（GET、POST 等）、文件、查询字符串、IP、UserAgent 以及大量其他信息部分。

关于`referer.txt`文件的存储位置，您应该使用绝对路径打开它。您可以使用`$fp=fopen($_SERVER['DOCUMENT_ROOT'] . '/referer.txt', 'a');`或设置自定义路径，例如`$fp=fopen("/tmp/referer.txt", 'a');`.

# java - 在包“android”中找不到属性“exitFadeDuration”的资源标识符

> ID：11765077
> 
> 赞同：0
> 
> 时间：2012-08-01T18:11:16.863
> 
> 标签：java, android, eclipse

我在 Eclipse 的 android 项目中遇到以下错误：

`error: No resource identifier found for attribute 'exitFadeDuration' in package 'android'`

[通过更改构建目标（此处](https://stackoverflow.com/questions/6446300/no-resource-identifier-found-for-attribute-largescreens-in-package-android)，[此处](https://stackoverflow.com/questions/5260686/no-resource-identifier-found-for-attribute-showasaction-in-package-android)）可以解决类似的问题。最低 sdk 级别为 10。因此，我的构建目标是 Android 2.3.3，即使将 Android 版本更改为 4.0.3，错误仍然存​​在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T15:27:35.440

在 ADT (Eclipse) 中，在项目的右键单击菜单上选择：**Android Tools --> Add Support Library**接受，您应该已经完成​​了。

取自[这个对我有用的答案](https://stackoverflow.com/questions/11814061/errorres-menu-main-xml15-error-no-resource-identifier-found-for-attribute-a)，即使它指的是另一个属性。

# linker - 动态链接：如何忽略版本标签？

> ID：11765078
> 
> 赞同：7
> 
> 时间：2012-08-01T18:11:21.177
> 
> 标签：linker, ld

我想编译一个使用 clAmdFFT、AMD 的 OpenCL FFT 的 OpenCL 程序，它是闭源的。

```
$ objdump -x libclAmdFft.Runtime.so
Dynamic Section:
  NEEDED               libOpenCL.so.1
Version References:
  required from libOpenCL.so.1:
    0x028568b0 0x00 05 OPENCL_1.0 
```

在一台机器上，我使用 AMD 驱动程序，它带有一个包含版本信息的 libOpenCL.so，如下所示：

```
a$ objdump -T /opt/AMDAPP/lib/x86_64/libOpenCL.so
0000000000002610 g    DF .text  0000000000000018  OPENCL_1.0  clGetSamplerInfo
00000000000032e0 g    DF .text  0000000000000018  OPENCL_1.1  clSetEventCallback
0000000000002350 g    DF .text  0000000000000018  OPENCL_1.2  clCreateSubDevices 
```

在这台机器上一切都很好。

在另一台机器上，我使用的是 nVidia 驱动程序，它带有一个 libOpenCL.so，它不包含版本信息，如下所示：

```
b$ objdump -T /usr/lib/libOpenCL.so # -> /usr/lib/nvidia-current/libOpenCL.so
00000000000021f0 g    DF .text  0000000000000018  Base        clGetSamplerInfo
0000000000002a40 g    DF .text  0000000000000018  Base        clSetEventCallback 
```

在这里链接程序`-llibOpenCL.so -llibclAmdFft.Runtime.so`失败，因为 clAmdFft 想要链接到标记符号：

```
libclAmdFftRuntime.so: undefinded reference to `clCreateBuffer@OPENCL_1.0` 
```

动态链接器也会产生这个抱怨：

```
b$ ldd libclAmdFft.Runtime.so
libclAmdFft.Runtime.so: …/libOpenCL.so.1: no version information available … 
```

由于 nVidia 驱动程序实现了 OpenCL 1.1，而 AmdFFT 只需要 1.0，如果我能说服它，它应该可以工作`Base = OPENCL_1.0`。那可能吗？

我不能强迫 nVidia 用户安装另一个版本，因为 libOpenCL 是驱动程序的一部分，就像 libGL 一样。

* * *

链接`--unresolved-symbols=ignore-in-shared-libs`成功，但生成的二进制文件不再找到 FFT 库。

* * *

由于 OpenCL 将与设备相关的部分拆分为 ICD 库，因此*如果*我从 AMD 驱动程序提供 libOpenCL.so，即使在 nVidia 机器上，它也会从 /etc/OpenCL/vendors/nvidia 动态加载正确的 ICD。 icd，但我不确定这是否真的是可移植的，例如，目录是硬编码的。

# android - SonyTV 上的 Android 列表适配器问题

> ID：11765097
> 
> 赞同：0
> 
> 时间：2012-08-01T18:12:33.843
> 
> 标签：android, listadapter, sony

这只发生在 SonyTV 盒子上。这是一个屏幕截图：

![在此处输入图像描述](../Images/5ef3a62472fa744b9a6bbd79f752312c.png)

前 2 个项目有角问题。我删除了可能导致此问题的代码，根据条件将图像设置为可见或不可见。

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) {
        int right = 0, top = 0, bottom = 0;

        View view = convertView;
        ViewHolder holder;
        if (view == null) {
            view = mInflater.inflate(R.layout.forecast_item, null);
            LayoutParams lp = (LayoutParams)view.getLayoutParams();
            lp = new LayoutParams(LayoutParams.MATCH_PARENT, mHeight);
            holder = new ViewHolder();
            holder.dateText = (TextView)view.findViewById(R.id.forecastDateText);
            holder.dayText = (TextView)view.findViewById(R.id.forecastDayText);
            holder.img = (ImageView)view.findViewById(R.id.forecastItemIcon);
            holder.realfeelText = (TextView)view.findViewById(R.id.forecastReelFeelText);
            holder.temperatureText = (TextView)view.findViewById(R.id.forecastHiLoTemp);
//          holder.alarmIcon = (ImageView)view.findViewById(R.id.alarm_img);
            holder.hiLoLabel = (TextView)view.findViewById(R.id.forecastHiLoLabel);
            view.setTag(holder);
            view.setLayoutParams(lp);
        } else {
            holder = (ViewHolder)view.getTag();
        }
        ForecastModel f = mForecastList.get(position);
        holder.dayText.setText(f.name);
        Utilities.resizeText(mBaseSize, mResizeFactor, 8, holder.dayText);
        holder.dateText.setText(Utilities.doDateConversion(f.date, mWd));
        String iconBuf = (f.iconCode.length() == 1) ? "0" + f.iconCode : f.iconCode;
        holder.img.setImageResource(Utilities.getDrawableId("icon_" + iconBuf));
        holder.temperatureText.setText(f.high + DEG + "/" + f.low + DEG);
        holder.realfeelText.setText(f.reelfeelhigh + DEG + "/" + f.reelfeellow + DEG);
        holder.hiLoLabel.setVisibility(mContext.getResources().getConfiguration().locale.getLanguage().contains(ENGLISH)
                ? View.VISIBLE : View.INVISIBLE);

//        if (position < 3 && Alarms.hasAlarm(mWd.getCurrentWeatherDataModel(), f)){
//          holder.alarmIcon.setVisibility(View.VISIBLE);
//        } else holder.alarmIcon.setVisibility(View.GONE);

       ...

        return view;
    } 
```

任何想法为什么会发生这种情况？这在电视设置为 720p 而不是 1080p 时有效。“每小时”选项卡也是一个 listAdapter，但它可以工作。

# python - Python初学者：将函数生成的文本输出到文件

> ID：11765105
> 
> 赞同：1
> 
> 时间：2012-08-01T18:13:04.100
> 
> 标签：python, python-2.7

Python新手在这里，运行2.7。

我正在尝试创建一个使用函数生成文本的程序，然后将函数生成的文本输出到文件中。

我在 Python 中打印函数没有问题

我输出手动输入的文本没有问题：（像这样）[http://codepad.org/JrcUTZfC](http://codepad.org/JrcUTZfC)

但是当我尝试输出函数生成的文本时，它不起作用：[http ://codepad.org/Wyj5Li8Y](http://codepad.org/Wyj5Li8Y)

我通常会收到“字符缓冲区”错误。

请让我知道我需要做些什么不同的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:37:29.973

您可能想从函数中返回字符串而不是打印它们。像这样的东西：

```
def fn(a,b,c):
    return "Template string {0} {1} {2}".format(a,b,c) 
```

至于迭代/连接部分，这应该可以满足您的需要。请注意，需要显式添加换行符 ('\n')，如果您使用 print，则不会出现这种情况。

```
def iter_cat(a,b):
    x = ""
    while a < b:
        x += 'This is string {0}, {1}\n'.format(a,b) # x gets previous x with "This.." appended
        a += 1
    return x 
```

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:52:03.740

您的问题在于函数本身，而不是将输出写入文件。您已经编写了函数而没有使用“return”。这在 python 中是合法的，但这意味着该函数将默认返回 None 。

而不是说

```
print "votes%d_%d.append(v%d_%d_%d)" % (b,c,a,b,c,) 
```

利用

```
data_to_write = "votes%d_%d.append(v%d_%d_%d)" % (b,c,a,b,c,)
data_to_write_two = # etc.
return data_to_write, data_to_write_two #etc. as needed 
```

然后你可以像以前一样调用你的函数

```
x, x2 = myfunc()
out_file = open("code.txt", "w")
out_file.write(x)
#etc. 
```

您正确使用了 .write - 但您所写的只是无。请记住，“打印”仅与终端对话，而不与文件或变量对话。

# asp.net-mvc-3 - 化合物验证

> ID：11765107
> 
> 赞同：0
> 
> 时间：2012-08-01T18:13:16.537
> 
> 标签：asp.net-mvc-3, razor

我有一个下拉菜单，如果选择了某个项目，则会弹出一个子表单（出现隐藏的 div），其中包含更多需要填写的内容。对此类事情进行验证的最佳方法是什么？我考虑过编写一个验证器（使用 ValidationAttribute，IClientValidatable），但这意味着我必须从表单的其余部分中取出该组框，以便将它们验证为 1 个对象。

提前致谢。

~~**跟进：我发现这可以在客户端做我想要的！ [http://foolproof.codeplex.com/](http://foolproof.codeplex.com/)**
[RequiredIf]
[RequiredIfNot]
[RequiredIfTrue]
[RequiredIfFalse]
[RequiredIfEmpty]
[RequiredIfNotEmpty]
[RequiredIfRegExMatch]
[RequiredIfNotRegExMatch]~~
_
没关系已经发现了一堆万无一失的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:29:02.187

您将需要扩展 ValidationAttribute 以创建自定义验证器。它可能是这样的：

```
 public YourValidatorNameAttribute()
        {
            ErrorMessage =  /** your not valid messaging **/;
        }  

        public override bool IsValid(object value)
        {
            bool isValid = true;
            YourClass c = value as YourClass;
            if (c != null)
            {
                if (/** check if the item in your dropdown is selected**/)
                {
                    isValid = /** check value of fields or whatever validation is needed in the 'more stuff' fields**/;
                }
            }
            return isValid;
        } 
```

# xpages - 加载选项后设置单选按钮组的值？

> ID：11765108
> 
> 赞同：0
> 
> 时间：2012-08-01T18:13:22.273
> 
> 标签：xpages, xpages-ssjs

我有 2 个单选按钮组。这两个按钮是 radioGroupLoanType 和 radioGroupLoanType。

radioGroupLoanType 的选择将根据 radioGroupLoanType 中的选择而改变。这很好用。

如果只有一个选项，那么 radioGroupLoanType 的点击事件会设置 radioGroupLoanType 的值。似乎正在发生的事情是，每隔一次点击才会设置该值。如果我在选择上单击两次，则设置了正确的值。

我怀疑正在发生的是在设置值时没有设置 radioGroupLoanType 的选择。我可以通过使用@DbColumn 而不是@DbLookup 为radioGroupLoanType 创建一个常量值列表来证明这一点。

关于如何做到这一点的任何其他想法？

```
 <xp:br></xp:br>

<xp:br></xp:br>
<xp:radioGroup id="radioGroupLoanType" layout="pageDirection">

    <xp:eventHandler event="onclick" submit="true"
        refreshMode="complete">
        <xp:this.action><![CDATA[#{javascript:var key =    getComponent("radioGroupLoanType").getValue();
   if (key == null) return;

var val = @DbLookup("","vwRateTypesByLoanTypesOrder",key,"RateName");
if (@IsError(val) || val.constructor == Array)
{   
getComponent("radioGroupRateReq").setValue("");

}
else
{
getComponent("radioGroupRateReq").setValue(val);

}
}]]></xp:this.action>
    </xp:eventHandler>

    <xp:selectItems>
        <xp:this.value><![CDATA[#{javascript:@DbColumn("","vwLoanTypesByOrder",2)}]]></xp:this.value>
    </xp:selectItems>
</xp:radioGroup><xp:br></xp:br>
<xp:br></xp:br><xp:radioGroup id="radioGroupRateReq" layout="pageDirection" styleClass="PNCText">
                <xp:selectItems>
                    <xp:this.value><![CDATA[#{javascript:var key = getComponent("radioGroupLoanType").getValue();
var val = @DbLookup("","vwRateTypesByLoanTypesOrder",key,"RateName");
return (@IsError(val) || val == "") ? @DbColumn("","vwRateTypesByOrder",2) : val;
}]]></xp:this.value>
                </xp:selectItems>

            </xp:radioGroup> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:28:09.523

我得到这个使用范围变量。radioGroupLoanType 的 onCLick 事件设置 radioGroupRateReq 的选项并设置值。radioGroupRateReq 使用范围变量中的选择。

关于如何做到这一点的任何更好的想法？

# python - 你将如何处理 Python 游戏中的插值？

> ID：11765109
> 
> 赞同：5
> 
> 时间：2012-08-01T18:13:23.297
> 
> 标签：python, pygame

我目前正在使用 python 和 pygame 编写一个非常简单的游戏。它有移动的东西。为了让这些东西顺利移动，我安排了主游戏循环，如[Fix Your Timestep](http://gafferongames.com/game-physics/fix-your-timestep/)中所说，并带有插值。

这是我现在处理插值的方式。

```
class Interpolator(object):
    """Handles interpolation"""
    def __init__(self):
        self.ship_prev = None
        self.ship = None

        self.stars_prev = []
        self.stars = []

        self.bullets_prev = {}
        self.bullets = {}

        self.alpha = 0.5

    def add_ship(self, ship):
        self.ship_prev = self.ship
        self.ship = ship

    def add_stars(self, stars):
        self.stars_prev = self.stars
        self.stars = stars[:]

    def add_bullets(self, bullets):
        self.bullets_prev = self.bullets
        self.bullets = bullets.copy()

    def add_enemies(self, enemies):
        self.enemies_prev = self.enemies
        self.enemies = enemies  # to be continued

    def lerp_ship(self):
        if self.ship_prev is None:
            return self.ship
        return lerp_xy(self.ship_prev, self.ship, self.alpha)

    def lerp_stars(self):
        if len(self.stars_prev) == 0:
            return self.stars
        return (lerp_xy(s1, s2, self.alpha) for s1, s2 in izip(self.stars_prev, self.stars))

    def lerp_bullets(self):
        keys = list(set(self.bullets_prev.keys() + self.bullets.keys()))
        for k in keys:
            # interpolate as usual
            if k in self.bullets_prev and k in self.bullets:
                yield lerp_xy(self.bullets_prev[k], self.bullets[k], self.alpha)
            # bullet is dead
            elif k in self.bullets_prev:
                pass
            # bullet just added
            elif k in self.bullets:
                yield self.bullets[k] 
```

lerp_xy() 函数和数据类型

```
def lerp_xy(o1, o2, alpha, threshold=100):
    """Expects namedtuples with x and y parameters."""
    if sqrt((o1.x - o2.x) ** 2 + (o1.y - o2.y) ** 2) > 100:
        return o2
    return o1._replace(x=lerp(o1.x, o2.x, alpha), y=lerp(o1.y, o2.y, alpha))

Ship = namedtuple('Ship', 'x, y')
Star = namedtuple('Star', 'x, y, r')
Bullet = namedtuple('Bullet', 'x, y') 
```

数据类型当然是临时的，但我仍然希望它们将来具有 x 和 y 属性。**更新：** lerper.alpha 每帧更新一次。

船被添加为单个对象 - 它是玩家船。星号作为列表添加。项目符号被添加为 dict {id, Bullet}，因为项目符号一直在添加和删除，我必须跟踪哪个项目符号是哪个项目符号，如果两者都存在则进行插值，如果它刚刚被添加或删除，则执行某些操作。

无论如何，这里的代码都是废话。它随着我添加功能而增长，现在我想将它重写为更通用，这样它就可以继续增长，而不会变成一堆不合常理的臭屎。

现在我对 Python 还是很陌生，尽管我已经对列表推导、生成器和协程感到很舒服。

我最缺乏经验的是 Python 的 OO 方面，并设计了一个比 10 行 hacky 一次性脚本更大的架构。

这个问题不是一个我不知道也无能为力的问题。我确信我有能力重写这个非常简单的代码，它会以某种方式接近我想要的。

我想知道的是，有经验的 Python 程序员将如何以 Python 的方式解决这个简单的问题，所以我（当然还有其他人）可以学习在 Python 开发人员中处理这种情况的优雅方式。

所以，我大概想用伪代码实现：

```
lerper = Interpolator()
# game loop
while(1):
    # physics
    # physics done
    lerper.add(ship)
    lerper.add(stars)
    lerper.add(bullets)
    lerper.add(enemies) # you got the idea

    # rendering
    draw_ship(lerper.lerp('Ship'))
    # or
    draw_ship(lerper.lerp_ship()) 
```

但是，如果您有更好的解决方案，请不要让伪代码阻止您 =)

所以。将所有游戏对象作为单独/继承的类？强迫他们都有身份证？将它们全部添加为 list/dict `lerper.add([ship])`？制作一个从 dict/whatever 继承的特殊容器类？你认为解决这个问题的优雅、pythonic 方式是什么？你会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:13:28.897

这可能不是您正在寻找的，但它有望在尝试编写游戏时将您推向一个有用的方向。以下为 Python 3.x 编写的秘籍提供了编写工作模块的示例。

*   [向量](http://code.activestate.com/recipes/578006)（提供一个用于处理 2D 坐标的类，并且不仅仅是`complex`数字）
*   [处理](http://code.activestate.com/recipes/578004)（为创建动画或制作简单游戏提供可扩展框架）
*   [boids](http://code.activestate.com/recipes/578007)（演示如何创建独立于帧速率运行的结构化动画）

您可能会查看上面提供的代码，并将其用作编写框架或构建代码以使其可重用的灵感。引用的项目受到[Processing.org](http://processing.org/)的启发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:04:05.583

我写了一个半完成的 Breakout 克隆，其中包含与您的类似的“对象四处移动”代码，所以我将分享我是如何做到的。

任何具有位置和速度的东西都是从 Projectile 类中实例化的。不动的物体也可以是弹丸。弹丸负责在有人调用`tick`它时更新自己的位置。

```
class Projectile:
    def __init__(self):
        self.x = 0
        self.y = 0
        self.vel_x = 0
        self.vel_y = 0
    def tick(self, dt):
        self.x += dt * self.vel_x
        self.y += dt * self.vel_y 
```

稍后，您可能希望将`x`和替换[为轴对齐边界框](http://en.wikipedia.org/wiki/Axis-aligned_bounding_box#Axis-aligned_minimum_bounding_box)`y`之类的东西，这样您就可以在射弹之间进行碰撞检测。

所有相互交互的射弹都存在于一个图层中，该图层负责`tick`每个射弹。

```
class Layer:
    def __init__(self):
        self.projectiles = []
    def addProjectile(self, p):
        self.projectiles.add(p)
    def tick(self, dt):
        for p in self.projectiles:
            p.tick(dt)
        #possible future expansion: put collision detection here 
```

设置只是创建具有您想要的属性的游戏对象，并将它们添加到图层中。

```
#setup
l = Layer()

ship = Projectile()
#not shown: set initial position and velocity of ship
l.addProjectile(ship)

for i in range(numStars):
    star = Projectile()
    #not shown: set initial position and velocity of stars
    l.addProjectile(star)

#not shown: add bullets and enemies to l, the same way stars were

#game loop
while True:
    #get dt somehow
    dt = .42
    l.tick(dt)
    for projectile in l.projectiles:
        draw(l) 
```

绘图是您的程序和我的程序不同的地方 - 突破中的所有内容都是一个矩形，因此每个游戏对象都可以以相同的方式绘制。但是太空入侵者看起来不像星星，子弹也不像太空船，所以它们都需要唯一的代码。此时，您应该考虑制作 Ship、Star、Bullet、Enemy 等，它们是 Projectile 的子类。然后每个人都可以指定自己的外观。除了直线移动之外，他们还可能有个人行为 - 例如。船舶响应按键，敌人加速向船舶等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:08:51.633

这是我最终处理插值的方式：

```
class Thing(object):
    """Generic game object with interpolation"""
    def __init__(self, x=0, y=0):
        self._x = self.x = x
        self._y = self.y = y

    def imprint(self):
        """call before changing x and y"""
        self._x = self.x
        self._y = self.y

    def __iter__(self):
        """handy to unpack like a tuple"""
        yield self.x
        yield self.y

Ship = Thing
Bullet = Thing

class Star(Thing):
    """docstring for Star"""
    def __init__(self, x, y, r):
        super(Star, self).__init__(x, y)
        self.r = r

    def __iter__(self):
        yield self.x
        yield self.y
        yield self.r

def lerp_things(things, alpha, threshold=100):
    """Expects iterables of Things"""
    for t in things:
        if sqrt((t._x - t.x) ** 2 + (t._y - t.y) ** 2) > threshold:
            yield (t.x, t.y)
        else:
            yield (lerp(t._x, t.x, alpha), lerp(t._y, t.y, alpha)) 
```

# php - 使用 PHP Switch 语句将表单数据发送到随机 URL

> ID：11765111
> 
> 赞同：1
> 
> 时间：2012-08-01T18:13:26.647
> 
> 标签：php

所以我试图围绕这个逻辑来思考。这是表单处理脚本上的代码。我想要做的是将表单数据随机发送到这些 url 之一。我正在阅读使用 switch case 逻辑，但是当我使用您在下面看到的代码时，它会将表单数据提交给所有 3 个 URL。有没有办法让它只发送给其中一个？

```
function post_to_url($url, $data) {
$fields = '';
foreach($data as $key => $value) { 
  $fields .= $key . '=' . $value . '&'; 
}
rtrim($fields, '&');

$post = curl_init();

curl_setopt($post, CURLOPT_URL, $url);
curl_setopt($post, CURLOPT_POST, 1);
curl_setopt($post, CURLOPT_POSTFIELDS, $fields);

$result = curl_exec($post);

curl_close($post);
}

return $result;

$x = rand(1,3);

switch ($x) {
    case 1:
        post_to_url("http://examplesite1.com/cgi-bin/maxuseradmin.cgi", $data2);
        break;

    case 2:
        post_to_url("http://examplesite2?fid=6646588e54", $data3);
        break;

    case 3:
        post_to_url("http://examplesite1?fid=2fb44e3888", $data4);
        break;
    } 
```

$data 变量是数组——感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:17:40.397

这里的问题是您甚至在 switch 语句发生之前就调用了这些函数。这段代码应该对你有用，因为它只在 switch 语句中调用函数：

```
$x = rand(1,3);

switch ($x) {
    case 1:
        post_to_url("http://examplesite1.com/cgi-bin/maxuseradmin.cgi", $data2);
        break;

    case 2:
        post_to_url("http://examplesite2?fid=6646588e54", $data3);
        break;

    case 3:
        post_to_url("http://examplesite1?fid=2fb44e3888", $data4);
        break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:18:43.397

您要发布到所有 3 个页面，然后将返回的值设置为 $ar1 $ar2 和 $ar3。

将您的选项存储在一个数组中，然后调用`post_to_url()`一次。

```
$urls = array(
    array("http://examplesite1.com/cgi-bin/maxuseradmin.cgi", $data2),
    array("http://examplesite2?fid=6646588e54", $data3),
    array("http://examplesite1?fid=2fb44e3888", $data4)
);

$x = rand(0,2);
post_to_url ($urls[$x][0], $urls[$x][1]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:18:16.183

在前 3 行中，您调用您的`post_to_url`函数

将您的代码更改为

```
$urls = array(
   "http://examplesite1.com/cgi-bin/maxuseradmin.cgi",
   "http://examplesite2?fid=6646588e54",
   "http://examplesite1?fid=2fb44e3888"
);

# don't know what's in $data* but just to give you an idea
$data = array(
    $data2,
    $data3,
    $data4
);
$x = rand(0,2);
post_to_url($urls[x], $data[x]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:18:43.307

对函数 post_to_url 的调用应该在 switch case 语句中。它发布到所有 3 的原因是，即使在切换大小写之前，您也调用了此函数 3 次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-01T18:19:38.660

您实际上在前三行执行了您的 post_to_url 函数三次。你会想做这样的事情：

```
$x = rand(1,3);

switch ($x)
{
case 1:
post_to_url("http://examplesite1.com/cgi-bin/maxuseradmin.cgi", $data2);
break;

case 2:
post_to_url("http://examplesite2?fid=6646588e54", $data3);
break;

case 3:
post_to_url("http://examplesite1?fid=2fb44e3888", $data4);
break;
} 
```

# c++ - 将 uint8_t 类型写入文件 C++

> ID：11765119
> 
> 赞同：4
> 
> 时间：2012-08-01T18:14:01.543
> 
> 标签：c++, file-io

我有一个`uint8_t`*ptr 类型的指针，它指向大约 32 个字节的二进制数据。我想将指针指向的内容打印到 C++ 文件中。我将使用二进制模式，即

```
ofstream fp;
fp.open("somefile.bin",ios::out | ios :: binary );
//fp.write( here is the problem )
fp.write((char*)ptr,sizeof(ptr)); 
```

有没有办法可以打印出 ptr 指向的内容，因为我刚刚展示的方式是，我在文件中获得 8 个字节的数据，而它指向 32 个字节的数据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-01T18:17:22.160

你得到 8 个字节，因为你计算机上的指针是 64 位的。因此，`sizeof(ptr)`返回 8 - 你得到的是指针的大小，而不是数组的大小。您应该传递要写入指针旁边的数据大小，例如，如下所示：

```
uint8_t data[32];
// fill in the data...
write_to_file(data, sizeof(data));

void write_to_file(uint8_t *ptr, size_t len) {
    ofstream fp;
    fp.open("somefile.bin",ios::out | ios :: binary );
    fp.write((char*)ptr, len);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:24:00.730

```
double pi = 3.1415926535; // IEEE 8 bytes
uint8_t bytes[8] = { 0 };
double* dp = (double*)(&bytes[0]); //force dp to point to bytes
*dp = pi; // copies pi into bytes
file.write((char*)dp,sizeof(bytes)); 
```

# android - 在后台监听 Android 通知

> ID：11765122
> 
> 赞同：0
> 
> 时间：2012-08-01T18:14:21.997
> 
> 标签：android, notifications

[http://developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)关于如何为 android 创建通知。现在我的问题是：**如何在后台监听应用程序的更新？**

假设我有一个应用程序可以让用户邀请其他用户参加活动。我希望受邀用户在发生这种情况时收到通知。我会在应用程序中的哪里收听这个？我应该每隔几分钟就调用一次数据库吗？当应用程序在后台运行时，这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:19:09.640

您将希望在您的应用程序中创建一个[服务](http://developer.android.com/reference/android/app/Service.html)。请参阅[此处](http://developer.android.com/guide/components/services.html)专门了解如何使用 IntentService。

# python - 如何在开发与部署中使用不同的数据库主机？

> ID：11765123
> 
> 赞同：1
> 
> 时间：2012-08-01T18:14:23.060
> 
> 标签：python, django

我是 Python 和 Django 的新手，在过去的几周里成功地建立了我的第一个部署 - 一个非常基本的站点，带有用户身份验证和几个页面，我希望在接下来的几周内填充内容。

通过搜索 Google / StackOverflow / Django 文档等，我已经设法找到了迄今为​​止遇到的大约 40 多个问题的答案，但现在我似乎找不到一个好的答案（也许是因为我没有）不知道如何最好地搜索它）：当我在本地机器上开发时，我需要我的 settings.py 文件指向远程数据库（`'HOST': 'www.mysite.com',`）但是当我部署到共享托管服务提供商时，他们需要使用`localhost`（`'HOST': '',`在设置中.py)。

由于我在 GitHub 上托管我的代码并希望将其镜像到服务器，有没有办法解决这个问题，所以我不必每次将更改上传到服务器后手动编辑 settings.py？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:26:27.560

您可以拥有两份`settings.py`文件副本，一份用于生产，一份用于开发。无论您需要成为默认值，将其命名为`settings.py`

只需设置您要使用的文件`DJANGO_SETTINGS_MODULE`的*python 路径即可。*

因此，如果您的设置文件是`myproject/settings.py, myproject/settings_dev.py`; 然后你可以这样做：

`$ DJANGO_SETTINGS_MODULE=settings_dev python manage.py shell`

从`myproject`目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T08:09:37.740

您可以创建一个 local_settings.py 文件，您可以将其放入 .gitignore 并将其包含在原始 settings.py 中。将每个环境敏感变量放入此文件（DATABASES、DEBUG、CACHES、MEDIA_URL 等）

在 settings.py 中：

```
try:
    from local_settings import *
except ImportError:
    pass 
```

在 .gitignore 中：

```
*/local_settings.py 
```

我建议你在 gitrepo 中的设置文件旁边放一个 local_settings.py.example。这样，每当您部署到新环境时，您只需复制此示例并更改必要的行。

# automated-tests - 如何按特定顺序运行机器人测试？

> ID：11765129
> 
> 赞同：2
> 
> 时间：2012-08-01T18:14:58.813
> 
> 标签：automated-tests, functional-testing, robotium

我有这个机器人测试项目，它有一个测试类。测试类包含所有的测试方法。现在，当我运行测试类时，测试方法按字母顺序运行。由于我在测试方法之间有一些依赖关系（我知道这不是首选做法），我希望测试方法以特定顺序运行。我有依赖项的原因是，它允许编写更少的代码并使整个测试类运行得更快。有没有办法按特定顺序运行测试方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-19T08:26:31.733

创建一个包含测试服顺序的类。例如：

```
package com.android.test; 

import junit.framework.TestSuite;
import android.app.Activity;
import android.test.ActivityInstrumentationTestCase2;

public class AllTests extends  ActivityInstrumentationTestCase2<Activity> {

    public AllTests(Class<Activity> activityClass) {
        super(activityClass);
    }

    public static TestSuite suite() {
        TestSuite t = new TestSuite();
        t.addTestSuite(SplashScreenTest.class);
        t.addTestSuite(MainLoginScreenTest.class);
        t.addTestSuite(EmailSignUpScreenTest.class);
        t.addTestSuite(EmailVerificationTest.class);
        t.addTestSuite(EmailLoginScreenTest.class);

        return t; 
    }

    @Override
    public void setUp() throws Exception {

    }

    @Override
    public void tearDown() throws Exception {
    }

} 
```

通过这种方式，您可以设置您的机器人测试套装的执行顺序。有关完整的教程，请查看此**[链接](http://www.androiddevelopersolution.com/2014/03/android-robotium-run-robotium-tests-in.html)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T21:19:10.810

我让它们以特定顺序运行的方法是为每个测试用例创建一个对象，然后在其中一个测试用例中实例化每个对象。这使您可以确定何时运行什么测试。不利的一面是您只运行一次设置方法。

这是我所做的：

```
...//class variables and such
static {
    try {
        launcherActivityClass = Class
                .forName(LAUNCHER_ACTIVITY_FULL_CLASSNAME);
    } catch (ClassNotFoundException e) {
        throw new RuntimeException(e);
    }
}

public NewRobotiumTest() throws ClassNotFoundException {
    super(TARGET_PACKAGE_ID, launcherActivityClass);
}

private Solo solo;

@Override
protected void setUp() throws Exception {

    solo = new Solo(getInstrumentation(), getActivity());
    to = new TestObject();

    /*This resets the test documents. 
     * If running multiple test methods in this class
     * remove this method from the setup and place in first test method*/
    to.restTestDocuments(); 

}

public void testSuite() throws IOException {

    try {

        // Test the Recommended For You section
        RecommendForYou rfy = new RecommendForYou();
        rfy.testRecommedForYou(solo, to);
        Log.i(TAG, RECOMMENDED + " Section test complete.");

        //Test the Music section of the app
        Music music = new Music();
        music.testMusic(solo, to); 
        Log.i(TAG, MUSIC + " Section test complete.");

        // Test Social Networking section of the app
        Social social = new Social();
        social.testSocial(solo, to);
        Log.i(TAG, SOCIAL + " Section test complete.");

        // Test Verizon Apps section of the app
        VerizonApps vza = new VerizonApps();
        vza.testVerizonApps(solo, to);
        Log.i(TAG, VERIZONAPPS + " Section test complete.");

        // Test Entertainment section of the app
        Entertainment ent = new Entertainment();
        ent.testEntertainment(solo, to);
        Log.i(TAG, ENTERTAINMENT + " Section test complete.");

        // Test Games Section of the app
        Games games = new Games();
        games.testGames(solo, to);
        Log.i(TAG, GAMES + " Section test complete.");

        // Test Featured section of the app
        Featured featured = new Featured();
        featured.testFeatured(solo, to);
        Log.i(TAG, FEATURED + " Section test complete.");

        // Test Business section of catalog
        Business bus = new Business();
        bus.testBusiness(solo, to);
        Log.i(TAG, BUSINESS + " Section test complete.");

        // Test the New Apps link in the ODP catalog
        NewApps nat = new NewApps();
        nat.testNewApps(solo, to);
        Log.i(TAG, NEW + " Section test complete.");

        //Test the Top Sellers section of the app
        TopSeller ts = new TopSeller();
        ts.testTopSellers(solo, to);
        Log.i(TAG, TOPSELLER + " Section test complete.");

        //Test the Top Download section of the app
        TopDownload td = new TopDownload();
        td.testTopDownload(solo, to);
        Log.i(TAG, TOPDOWNLOAD + " Section test complete.");

        //Test the Themes section of the app
        Themes themes = new Themes();
        themes.testThemes(solo, to); 
        Log.i(TAG, THEMES + " Section test complete.");

        //Test the Tools section of the app
        Tools tools = new Tools();
        tools.testTools(solo, to);
        Log.i(TAG, TOOLS + " Section test complete.");

        //Test the News section of the app
        News news = new News();
        news.testNews(solo, to);
        Log.i(TAG, NEWS + " Section test complete.");

        //Test the Sports section of the app
        Sports sports = new Sports();
        sports.testSports(solo, to);
        Log.i(TAG, SPORTS + " Section test complete.");

        //Test the Reading section of the app
        Reading read = new Reading();
        read.testReading(solo, to); 
        Log.i(TAG, READING + " Section test complete.");

        //Test the Money section of the app
        Money money = new Money();
        money.testMoney(solo, to);
        Log.i(TAG, MONEY + " Section test complete.");

        //Test the Shopping section of the app
        Shopping shop = new Shopping(); 
        shop.testShopping(solo, to);
        Log.i(TAG, SHOPPING + " Section test complete.");

        //Test the Fitness section of the app
        Fitness fit = new Fitness(); 
        fit.testFitness(solo, to); 
        Log.i(TAG, FITNESS + " Section test complete.");

        //Test the Travel Section of the app
        Travel travel = new Travel();
        travel.testTravel(solo, to);
        Log.i(TAG, TRAVEL + " Section test complete.");

        //Test the Spanish section of the app
        Spanish spanish = new Spanish();
        spanish.testSpanish(solo, to); 
        Log.i(TAG, SPANISH + " Section test complete.");

        // Test the search functionality
        TestSearch test = new TestSearch();
        test.testSearchFunctionality(solo, to);

    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        printTotals(to);
    }

}

@Override
public void tearDown() throws Exception {

    try {

        bw.close();

        solo.finalize();
    } catch (Throwable e) {
        e.printStackTrace();
    }
    solo.finishOpenedActivities();

    super.tearDown();

}

public void printTotals(TestObject to) throws IOException {

    // if there is no SD card
    if (Environment.getExternalStorageState() == null) {
        directory = new File(Environment.getDataDirectory()
                + "/RobotiumTestLog/");
        photoDirectory = new File(Environment.getDataDirectory()
                + "/Robotium-Screenshots/");

        // if no directory exists, create new directory
        if (!directory.exists()) {
            directory.mkdir();
        }

        // if phone DOES have sd card
    } else if (Environment.getExternalStorageState() != null) {
        // search for directory on SD card
        directory = new File(Environment.getExternalStorageDirectory()
                + "/RobotiumTestLog/");
        photoDirectory = new File(Environment.getExternalStorageDirectory()
                + "/Robotium-Screenshots/");

        // if no directory exists, create new directory to store test
        // results
        if (!directory.exists()) {
            directory.mkdir();
        }
    }// end of SD card checking

    String fileName2 = "TotalTestResults.csv";
    File totLogRes = new File(directory, fileName2);
    bw = new BufferedWriter(new FileWriter(totLogRes, true));

    int totCases = to.getTestCase();
    int totPass = to.getTestPass();
    int totFail = to.getTestFail();
    int totRev = to.getNeedReview();
    bw.write("\"\n\"");
    bw.write("Total Test Results\",\"" + totCases + "\",\"" + totPass
            + "\",\"" + totFail + "\",\"" + totRev + "\"\n\"");
}
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:48:13.363

您可以尝试按照 JUnit 的建议来组织您的测试，如下所述：http: [//etutorials.org/Programming/Java+extreme+programming/Chapter+4.+JUnit/4.8+Organizing+Tests+into+Test+套房/](http://etutorials.org/Programming/Java+extreme+programming/Chapter+4.+JUnit/4.8+Organizing+Tests+into+Test+Suites/)

# ios - 从 TapkuLibrary 降低 Coverflow 的滚动灵敏度

> ID：11765130
> 
> 赞同：1
> 
> 时间：2012-08-01T18:15:03.610
> 
> 标签：ios, xcode, coverflow, tapku

我需要降低每个封面之间的滚动速度。有没有人为此提出一个好的解决方案？

我试图降低速度，每英里或固定英里，但没有工作:(

来自“TKCoverflowView.m”的实际代码

```
#pragma mark UIScrollView Delegate
- (void) scrollViewDidScroll:(UIScrollView *)scrollView{
    velocity = abs(pos - scrollView.contentOffset.x);
    pos = scrollView.contentOffset.x;
    movingRight = self.contentOffset.x - origin > 0 ? YES : NO;
    origin = self.contentOffset.x;

    CGFloat num = numberOfCovers;
    CGFloat per = scrollView.contentOffset.x / (self.contentSize.width - currentSize.width);
    CGFloat ind = num * per;
    CGFloat mi = ind / (numberOfCovers/2);
    mi = 1 - mi;
    mi = mi / 2;
    int index = (int)(ind+mi);
    index = MIN(MAX(0,index),numberOfCovers-1); 

    if(index == currentIndex) return;

    currentIndex = index;
    [self newrange];

    if(velocity < 180 || currentIndex < 15 || currentIndex > (numberOfCovers - 16))
        [self animateToIndex:index animated:YES];
} 
```

[编辑] 刚刚发现编辑这个方法实际上并没有改变任何速度，它只是改变了封面的表现。

找到解决方案，回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:44:24.250

使用 decelerationRate 属性

```
[self setDecelerationRate:0.9]; 
```

Coverflow 的动画效果仍然可以很好地使用它。

# asp.net-mvc-3 - “@Html.DropDownListFor”会导致 [HttpPost] ActionResult 出现问题。出现“用户未处理空引用异常”错误

> ID：11765131
> 
> 赞同：0
> 
> 时间：2012-08-01T18:15:05.740
> 
> 标签：asp.net-mvc-3, http-post, nullreferenceexception, html.dropdownlistfor

我用 a`ViewModel`来表示我的数据库中的两个实体，“类别”和“制造商”，因为我希望它们作为下拉列表。我已经设法为它们创建了声音和工作下拉列表。

这是视图模型：

```
 public class New_Product_View_Model
  {
    public int SelectedManufacturerID { get; set; }
    public SelectList Manufacturers { get; set; }
    public int SelectedCategoryID { get; set; }
    public SelectList Categories { get; set; }
  } 
```

这是 [HttpGet]`Controller`操作：

```
public ActionResult Insert_New_Product()
   {
        var dbcontext = new LNQ2SQLDataContext();
        var CatQ = from P in dbcontext.Categories
                where P.SUB_CAT == null
                select P;

        var ManQ = from P in dbcontext.Manufacturers
                   select P;

        var VM = new New_Product_View_Model();
        VM.Categories = new SelectList(CatQ, "CAT_ID", "CAT_Name");
        VM.Manufacturers = new SelectList(ManQ, "MAN_ID", "MAN_Name");

      //Passes the 'VM' to the view
        return View(VM);
   } 
```

**我的视图看起来像这样**：****

 **```
@model MyAppName.ViewModels.New_Product_View_Model
@using (Html.BeginForm(FormMethod.Post))
    {
        @Html.DropDownListFor(m => m.SelectedCategoryID, Model.Categories, "-- Select a category --")
        <br />
        @Html.DropDownListFor(m => m.SelectedManufacturerID, Model.Manufacturers, "-- Select a manufacturer --")

    <input type="submit" value="Add New Product" />

    } 
```

**到目前为止一切正常**

**现在**这里是*[HttpPost]* ActionResult ：

```
[HttpPost]
public ActionResult Insert_New_Product(New_Product_View_Model NPVM)
    {
      //A few things here
      //then
        return View();
    } 
```

当我单击页面中的提交按钮时，我收到此错误：

[看这里的图片](http://ntpc.net46.net/photos/51c5ffd6b62c.jpg)

据我所知，这是因为`Model`视图中`null`的 HttpPost 方法运行时。因为`return`在 HttpPost 操作中，没有`New_Product_View_Model`. 这很愚蠢，因为我不想再次将任何模型传递给**视图**！我只想在需要添加更多产品的情况下使用相同的页面。

我试图`return`用这个交换：

```
return View(new New_Product_View_Model()); 
```

但我收到此错误： [请参阅此处的图片](http://ntpc.net46.net/photos/93c55aea7385.jpg)

我也试过这个：

```
NPVM = new New_Product_View_Model();
return View(NPVM); 
```

但只是得到了同样的错误。

有没有人有任何解决方案？我真的很感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:18:03.913

**HTTP 是无状态**的，而 MVC 是 Statless Loving Web 开发框架的一个很好的例子。每个请求都像新的一样。因此，当您将模型发送回视图时，您应该重新填充 Collection 属性。

考虑使用[**PRG**](http://en.wikipedia.org/wiki/Post/Redirect/Get)（***Post-Redirect-GET***）模式。这意味着，如果您的交易（保存到数据库）成功，您应该执行[重定向](http://www.stevefenton.co.uk/Content/Blog/Date/201104/Blog/ASP-NET-MVC-Post-Redirect-Get-Pattern/)到某个`Get`操作以显示新产品

```
[HttpPost]
public ActionResult Insert_New_Product(New_Product_View_Model model)
{
  if(ModelState.IsValid)
  {     

    //Save & If everything is fine, Do A Redirect (PRG pattern) to Get action
    return RedirectToAction("ShowProduct",new { id=model.ID});
  }

   //Model validation failed. Reload the stuff and send back to view     

    model.Categories = GetCategories();
    model.Manufacturers = GetManufacturers ();

    return View(model);
}

public ActionResult ShowProduct(int id)
{
  var item=repo.GetItemFRomId(id);
  return View(item);
} 
```

假设`GetCategories()`and`GetManufacturers` 方法返回您的类别和制造商的 SelectList，您可以使用它来绑定视图中的下拉菜单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:16:46.347

您需要将`Categories`and填充`Manufacturers`到模型中。
与 WebForms 不同，没有 ViewState 可以从中加载值。

最简单的解决方法是调用原始 (GET) 操作。**

# ms-access - Access 2010 表单关闭按钮

> ID：11765133
> 
> 赞同：1
> 
> 时间：2012-08-01T18:15:28.463
> 
> 标签：ms-access, button, ms-access-2010

我想知道是否有办法知道是否单击了 Windows 窗体按钮。我知道 CloseButton 属性，但您似乎只能启用或禁用它。当用户浏览我的应用程序时，我关闭了表单，但只有在按下 Windows 关闭按钮时才想关闭数据库。所以我需要关闭事件来区分我是通过编程关闭它还是用户通过 Windows 按钮关闭。我可以使用布尔检查，但想知道是否有更优雅的方式。

此外，如果有一种方法可以完全删除按钮，而不仅仅是让它看起来很难看，那将是惊人的，但我读到这可能是不明智的，因为这是一个 Windows 设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:42:54.207

这是一个表单的代码模块，其中包含一个名为`cmdClose`. 表单无法关闭，除非`cmdClose`单击事件。即使尝试关闭 Access 本身也不会允许表单关闭......并且会中止 Access 关闭。

```
Option Compare Database
Option Explicit

Private Sub cmdClose_Click()
    AllowClose "close"
    DoCmd.Close acForm, Me.Name
End Sub

Private Sub Form_Unload(Cancel As Integer)
    If AllowClose = False Then
        Cancel = True
        MsgBox "close aborted"
    End If
End Sub

Private Function AllowClose(Optional ByVal pClose As String) As Boolean
    Static blnClosedFromCode As Boolean
    If pClose = "close" Then
        blnClosedFromCode = True
    End If
    AllowClose = blnClosedFromCode
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-01T20:05:10.107

简而言之，我不认为他们是一种方式，但 HansUp 提供的代码是一种解决方法。我禁用顶部的关闭按钮以确保保存数据。

# java - 如何设置 log4j 来记录违反 JSR 303 验证的值？

> ID：11765136
> 
> 赞同：0
> 
> 时间：2012-08-01T18:15:38.523
> 
> 标签：java, log4j, bean-validation

我正在使用 JSR 303 的 Hibernate 验证器实现来验证程序中的某些实体，我需要记录不正确的数据。由于 JSR 303 验证，我可以获得 ConstraintViolation 列表，但它仅包含验证失败的元数据。违规值本身在任何地方都无法让我记录它们（我必须将约束违规映射回可怕的实体）。

我在 Hibernate 的 ConstraintTree 类中找到了一个跟踪日志，它记录了所有经过验证的值，但这对我来说是无用的（我不知道哪个失败了）。

是否有一些神奇的记录器名称会触发记录失败的验证值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T20:53:08.767

[`ConstraintViolation.getInvalidValue()`](http://docs.oracle.com/javaee/6/api/javax/validation/ConstraintViolation.html#getInvalidValue%28%29)不返回您需要的值？

顺便说一句，Hibernate（从 4.0.0 开始）和 hibernate-validator（从 4.3 开始）使用`jboss-logging`而不是`log4j`.

# click - raphael .click 和 .unclick 帮助

> ID：11765142
> 
> 赞同：0
> 
> 时间：2012-08-01T18:16:09.530
> 
> 标签：click, raphael

所以我一直在使用 raphael 来创建一个用户界面，并希望这样，如果有人点击一个圆圈，它会突出显示该圆圈或对圆圈做一些视觉上有趣的事情来注意它被选中。我还不太担心视觉方面的问题。我试图找出一种方法来实现这一点，但似乎没有任何效果。这是相当简单的。至少我是这么认为的，但事实证明这让我很头疼。我会提供代码，但我现在拥有的是一团糟。如果你想要它，我会添加它。

```
function elemClick(el)
            {
                el.click(function(){
                    circleSelectedArray[0] = true;

                });

                el.unclick(function(){
                    circleSelectedArray[0] = false;
                });

            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T19:12:56.420

您不能同时绑定单击和取消绑定....

```
el.click(fn) means that you are binding a click event to that element like the way you have which is fine ....
el.unclick(fn) means that you are unbinding a click function from that element. 
```

USE -> 如果你这样做`el.unclick()`，如果你想使用一个功能，所有点击事件都将与该元素解除绑定....

```
 function yourFunc(){
    console.log('you clicked me !')}
    el.click(yourFunc); // now when you click this el console will show the phrase
    //when you unbind the function
    el.unclick(yourFunc); 
```

我只是有一种预感，您可能正在尝试使用 mousedown 和 mouseup 事件....

编辑：根据您的要求

```
function sel_unsel(){
if(this.data('selected') == false){
   this.data('selected', true);
   // do here what you want when element is selected
   }else if(this.data('selected') == true){
   this.data('selected', false);
   //do here what you want when element is unselected
   }
   }
function elemClick(el){
     el.data('selected',false);
el.click(sel_unsel);} 
```

# php - 表单提交后取消设置帖子变量

> ID：11765144
> 
> 赞同：10
> 
> 时间：2012-08-01T18:16:21.200
> 
> 标签：php, form-submit

有没有办法做到以上几点？基本上，如果有人在已经提交过一次表单后按下刷新，我不希望再次提交表单。在这种情况下，浏览器会询问您是否要再次提交表单。`unset($_POST['username'])`这种情况会有什么帮助吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-01T18:59:09.137

正如一些海报已经提到的那样，post/redirect/get 是一个不错的选择。

我能想到的另一种方法是在 dostuff.php 页面中设置一个会话以指示发布已经完成。每次检查此会话变量以查看是否由于页面刷新而再次加载页面。

```
<?php
    session_start();
    if(isset($_SESSION['indicator'])) 
    {
        /*
        dont do anything because session indicator says 
        that the processing was already done..

        you might want to redirect to a new url here..          
        */
    }   
    else
    {

        /*
        first set session indicator so that subsequent 
        process requests will be ignored
        */
        $_SESSION['indicator'] = "processed"; 

        //process the request here..
    }
    ?> 
```

在您重定向到的页面中，取消设置会话变量，以便可以重新重新提交表单，使其成为新的发布操作。这将允许新表单发布，但会因页面刷新而阻止发布操作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-01T18:18:38.877

使用中间页面进行操作，然后重定向。

例如：

mypage.php --> 带有表单的页面

dostuff.php --> 接收表单数据并进行操作，然后重定向到任何其他页面。

**要进行重定向：**
将此行放在“dostuff.php”的顶部：`header("Location: mypage.php");`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-01T18:20:00.053

您在上面特别面临的问题可以（并且应该）通过[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)来解决。在php`_POST`端取消设置是无效的，因为问题是它是一个单独的请求。

您还必须处理双击提交按钮。您可以在客户端解决此问题，方法是在单击按钮后禁用表单提交，或者在表单中放置一个随机令牌并将该令牌存储在会话中。令牌只会被接受一次（会话会跟踪令牌是否已发布）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-30T12:02:44.203

这是我用来防止用户两次提交相同数据的好方法，这也将防止页面在重新加载时将相同的记录添加到数据库中。

```
// First IF
if ($_SESSION['dup_comment_body'] == $_POST['comment_body']) { 
    echo 'You already entered that.';
} else {
    // Second IF
    if ($_POST['comment_body']) {

        // Run your query here

    $_SESSION['dup_comment_body'] = $_POST['comment_body']; 
    header('location:'.$_SERVER['REQUEST_URI'].'');
    }
} 
```

第一个`IF`检查`$_POST`是否等于他们键入的最后一个内容 ( `$_SESSION`)。如果不一样，它会运行下一个`IF`以测试`$_POST`变量是否不为空。在最后一个`IF`朝向底部的内部，它设置`$_SESSION['dup_comment_body']`为等于`$_POST`. 所以下一次第一次`IF`运行时`$_POST`，它们是相同的，他们将收到消息“你已经输入了。”。希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-04T09:09:33.877

使用此代码

```
 if(isset($_POST)){
      header('location:'.$_SERVER['PHP_SELF']);
      die();
     } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-01T18:19:30.397

为此，您需要使用[POST/REDIRECT/GET 模式](https://en.wikipedia.org/wiki/Post/Redirect/Get)。

> Post/Redirect/Get (PRG) 是一种 Web 开发设计模式，可以防止一些重复的表单提交，为用户代理（用户）创建更直观的界面。PRG 以可预测的方式支持书签和刷新按钮，不会创建重复的表单提交。
> 
> 当通过 HTTP POST 请求将 Web 表单提交到服务器时，Web 用户尝试在某些用户代理中刷新服务器响应可能会导致重新提交原始 POST 请求的内容，可能会导致不希望的结果，例如重复的网络购买。
> 
> 为了避免这个问题，许多 Web 开发人员使用 PRG 模式——而不是直接返回网页，POST 操作返回一个重定向命令。HTTP 1.1 规范引入了 HTTP 303（“查看其他”）响应代码，以确保在这种情况下，Web 用户的浏览器可以安全地刷新服务器响应，而不会导致重新提交初始 POST 请求。然而，当今使用的大多数常见商业应用程序（新旧都一样）在这些情况下仍会继续发出 HTTP 302（“找到”）响应。

这是 PHP 中的一个示例：

```
header('Location: /yourpage.php', true, 303);
exit; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-12T10:58:24.027

如果您将此表单的内容插入数据库，只需使用 php/sql SELECT 语句检查“用户名”是否已提交。如果是，则抛出错误。像这样：

```
//Database Values: servername, dbname, username and password;
//Also set ($_POST['username']) = $username or anything you like; 
$usererror = ""; //Will be filled later.
try { 
$conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$stmt1 = $conn->prepare("SELECT * FROM yourdb WHERE username=:username");
$stmt1->bindParam(':email', $email);
$stmt1->execute();
$stmt1->fetch();

$querycheck = $stmt1->rowCount();
if ($querycheck >= 1) {
$usererror = "User already exists.";
}
}
catch(PDOException $e) {
// roll back the transaction if something failed
$conn->rollback();
echo "Critical Error. Contact admin immediately.";
error_log("Error: " . $e->getMessage(), 0); //logs connection errors instead of echoing the errors (for security reasons.)
}
$conn = null; 
```

然后你现在可以只插入没有错误的表单：

```
If (empty($usererror)) {
//insert command 
} 
```

注意我使用了prepared statements，因为在很多文章中，它被认为是使用php+sql操作数据库最安全的方法。如果您真的不担心安全问题，您也可以使用普通方法，它也会为您节省更多代码行。

还要注意**$querycheck >= 1**，即使用户刷新 2,000 次、单击返回按钮并再次提交等，确保 1 次插入并且永远不会超过 1 是非常重要的。这个错误让我陷入困境并让我发疯了好几天正在使用**$querycheck > 1**而不是**$querycheck >= 1**，这样，我的表单在抛出“已经存在”错误之前不断提交两次。最后，我已经能够修复它。希望这对稍后将访问此问题的人有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-02T15:56:45.800

您可以在处理表单数据后重置 $_POST 数组，例如下面的代码

```
<?php
if( isset($_POST['submit']))
{
//do some processing related to form;
//after done.....
$_POST = array(); //this declares post as empty array 
//which is global variable anyways.
}
?> 
```

或者第二种方法是使用隐藏形式的东西......

```
<?php
if( isset($_POST['submit']))
{
//do some processing related to form;

//create a form with hidden field
?>
<form method="post" name="myform" action="actionpage">
<input type="hidden" name="somename" value="">
</form>
<?php
echo "<script> document.forms['myform'].submit();</script>";
}
?> 
```

这将基本上提交带有 1 个空值字段的表单，我不知道这是否是最佳的，但它满足了这里的需要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-06T16:30:15.050

如果您的表单要更新数据库，那么只有在记录不存在时才可以更新或插入。只需先执行一个 select 语句。这将防止由于刷新导致重复记录。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-03T13:17:56.383

我的解决方案是如果设置了 post 变量，则进行元刷新，刷新后不要遵循它。

```
<head>
<?php
  if (isset($_POST['Task'])){
  echo' <meta http-equiv="refresh" content="0; url=./ThisFile.php">';
  }
  ?>
</head> 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2017-09-29T21:58:52.800

相反，您可以使用诸如 Recaptcha 之类的验证码，它不允许在不进行验证码的情况下提交后提交。这就是我使用的，并且效果很好。

# asp.net-mvc - 如何获取复选框列表的选定值？

> ID：11765146
> 
> 赞同：0
> 
> 时间：2012-08-01T18:16:29.143
> 
> 标签：asp.net-mvc, checkboxlist

如果我在表单中有一个 CheckBoxList，像这样......

```
@using (Html.BeginForm("Save", "Product", FormMethod.Post))
{
    ...

    @Html.CheckBoxList("Categories", Model.AllCategories);

    ...
} 
```

...如何在我的控制器操作中获取选定值（检查值）的列表？

例如，如果复选框列表中的项目具有以下值：

> 猫。1
> 
> 猫。2
> 
> 猫。3
> 
> 猫。4

...并且`Cat. 2`被`Cat. 3`选中，我怎样才能得到一个包含这些值的数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:16:29.143

在最简单的情况下，控制器操作应如下所示（在 Product 控制器中）：

```
[HttpPost]
public ActionResult Save(string[] Categories)
{
    // Process selected checkbox values here, using the Categories array
    ...
} 
```

在更复杂的情况下（具有更多表单字段），使用视图模型并为其添加类别属性可能会更好。

```
public class MyViewModel
{
    ...

    public string[] Categories { get; set; }

    ...
} 
```

控制器动作：

```
[HttpPost]
public ActionResult Save(MyViewModel model)
{
    // Process selected checkbox values here, using the model.Categories array
    ...
} 
```

简单的问答，但希望它能帮助寻找答案的人（就像我刚开始学习 ASP.NET MVC 时一样）。

PS如果您有更好或更详细的内容，请发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:41:23.713

查看这个问题的答案在[这里](https://stackoverflow.com/questions/9973977/asp-net-mvc-3-retrieve-checkbox-list-values) 我一直使用它并且它工作得很好。

# c# - 如何在 MVC3 中使用 MvcPaging2.0 使用 RouteValues？

> ID：11765150
> 
> 赞同：6
> 
> 时间：2012-08-01T18:16:33.697
> 
> 标签：c#, asp.net, .net, asp.net-mvc-3, paging

`@Html.Pager`来自**MvcPaging 2.0**的Html 助手。有`.Options(o => o.RouteValues(object RouteValues))`它可以将Model返回给Controller，但是MvcPaging需要在他所在的View中填充这个helper `IPagedList<model>`。这是生成表和分页的Model。实现 mvcpaging 2.0 的最佳方法是什么？使用 SearchModel 进行搜索并使用模型显示结果？

*例子：*

**楷模：**

```
public class SearchModel
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

public class Person
{
    [Key]
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime Dob { get; set; }
    public string City { get; set; }
} 
```

**查看：** Index.cshtml

```
@using (Ajax.BeginForm("Search", "SearchPerson", new AjaxOptions
{
    HttpMethod = "GET",
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "main_search_result_table_id"
}))
{    
    @Html.TextBoxFor(m => m.FirstName)
    @Html.TextBoxFor(m => m.LastName)
    <input type="submit" value="Search"/>
}
 <div id="main_search_result_table_id">
      @{Html.RenderPartial("_InitPartialEmpty");}
 </div> 
```

_ResultPartial.cshtml

```
@using MvcPaging
@model IPagedList<Models.Person>

<table>
@foreach (var p in Model)
{
<tr>
    <td>@p.FirstName</td>
    <td>@p.LastName</td>
    <td>@p.Dob</td>
    <td>@p.City</td>
</tr>
}
<table>

 @Html.Pager(Model.PageSize, Model.PageNumber,
                 Model.TotalItemCount,  new AjaxOptions 
 { 
     UpdateTargetId = "main_search_result_table_id"
 }).Options(o => o.RouteValues(Model)) //==> IPagedList<Models.Person> 
```

**控制器**

```
public ActionResult SearchPerson(int? page,SearchModel person)
{
    List<Person> result= adapter.GetPersons(person);

    int currentPageIndex = page.HasValue ? page.Value - 1 : 0;

    return PartialView("_ResultPartial", 
                result.ToPagedList(currentPageIndex, 10, result.Count()));
} 
```

问题是如何实现 MvcPaging2.0 使用模型进行搜索？或者是否有另一种方式，更好的方式来进行复杂的搜索而​​不使用模型来传输数据查询？有什么想法吗？

我正在使用[MvcPaging 2.0。](http://blogs.taiga.nl/martijn/2012/04/23/mvcpaging-2-0/),[文档](https://github.com/martijnboland/MvcPaging)

**编辑：***

感谢达林的回答，但我设法把它拉成这样：

*_ResultPartial.cshtml*

```
@Html.Pager(Model.PageSize, Model.PageNumber,
             Model.TotalItemCount,  new AjaxOptions 
{ 
 UpdateTargetId = "main_search_result_table_id"
 }).Options(o => o.Action("AjaxPaging")) 
```

*控制器*

```
public ActionResult SearchPerson(int? page,SearchModel person)
{
    IQueryable<Person> query= adapter.GetPersons(person);

    Session["SearchQuery"] = query;

    int currentPageIndex = page.HasValue ? page.Value - 1 : 0;

    List<Person> persons = query.ToList();

    return PartialView("_ResultPartial", 
                persons.ToPagedList(currentPageIndex, 10, persons.Count()));
}

public ActionResult AjaxPaging(int? page)
{
    IQueryable<Person> query = Session["SearchQuery"] as IQueryable<Person>;

    int currentPageIndex = page.HasValue ? page.Value - 1 : 0;

    List<Person> persons = query.ToList();

    return PartialView("_ResultPartial", 
                persons.ToPagedList(currentPageIndex, 10, persons.Count()));
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T09:54:04.387

您可以编写一个自定义扩展方法，该方法将收集所有查询字符串参数并将它们添加到页面链接中，以及所有 currentPage、pageNumber、totalItemCount 等......

```
public static class PagerOptionsBuilderExtensions
{
    public static PagerOptionsBuilder AddFromQueryString(
        this PagerOptionsBuilder builder, 
        HttpRequestBase request
    )
    {
        foreach (string item in request.QueryString)
        {
            builder.AddRouteValue(item, request.QueryString[item]);
        }
        return builder;
    }
} 
```

接着：

```
.Options(o => o.RouteValues(Model).AddFromQueryString(Request)) 
```

# android - Android AlertDialog 项目未点击

> ID：11765157
> 
> 赞同：0
> 
> 时间：2012-08-01T18:16:55.993
> 
> 标签：android, android-alertdialog

我有一个这样定义的 AlertDialog：

```
final CharSequence[] items = { "Red", "Green", "Blue", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten" };

AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("Pick a color");

builder.setSingleChoiceItems(items, 0, new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int item) {

        // Set items uncheckable

        Toast.makeText(getApplicationContext(), items[item], Toast.LENGTH_SHORT).show();

    }
});

builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {

    @Override
    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub

    }
});

AlertDialog alert = builder.create();
alert.show(); 
```

**第一个问题**

是否可以将某些项目标记为不可检查？虽然我向用户展示了各种项目，但用户理解这些项目存在，但其中一些是不可检查的。

**第二个问题**

如果有办法完成我的第一个问题，是否可以将不可检查的项目设为灰色？

谢谢，

收藏夹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:24:12.763

也许是这样的：

```
(AlertDialog)builder.getButton(AlertDialog.BUTTON_POSITIVE).setEnabled(false); 
```

这是另一种方式：

```
Button button = dialog.getButton(AlertDialog.BUTTON_POSITIVE);
button.setEnabled(false) 
```

看看这是否有效。**还要确保你这样做，`builder.create();`**但`before alert.show()`

**编辑：**对于我认为您可以使用[getListView()](http://developer.android.com/reference/android/app/AlertDialog.html#getListView%28%29)的列表项，您可以访问可检查的选项，并使用`setEnabled(false)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-18T23:42:31.123

您必须选择一个特定的子项，然后禁用它：

```
ListView list = ((AlertDialog) dialog).getListView();
list.getChildAt(item).setEnabled(false); 
```

# wpf - 使用 wpf 中的 xaml 将光标聚焦在文本框中

> ID：11765159
> 
> 赞同：1
> 
> 时间：2012-08-01T18:17:00.390
> 
> 标签：wpf, xaml

```
private void TextBox1_TextChanged(object sender, TextChangedEventArgs e)
{           
    txt1_focus.Focus();
} 
```

如何在 wpf 中使用 xaml 文件实现上述代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:36:22.647

使用`FocusManager.FocusedElement`如下：

```
<Window x:Class="UI.Views.MyView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         FocusManager.FocusedElement="{Binding ElementName=txtSearch}">
    </Window> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:36:05.300

[http://cloudstore.blogspot.com/2008/06/setting-initial-focus-in-wpf.html](http://cloudstore.blogspot.com/2008/06/setting-initial-focus-in-wpf.html)

该站点解释了如何将初始焦点设置在某个控件上。

```
<Window ...
        FocusManager.FocusedElement="{Binding ElementName=TextBox1}"> 
```

# loops - 使用 flex/bison 循环展开

> ID：11765161
> 
> 赞同：0
> 
> 时间：2012-08-01T18:17:18.700
> 
> 标签：loops, for-loop, bison, lex

我正在为包含 for 循环预处理器指令的语言编写 Flex/Bison 解析器，该指令应该复制循环内容。例子：

```
for (i=0; i<2; i++)
    record$i = value$i;
endfor 
```

我的预处理器应该生成以下输出

```
record0 = value0;
record1 = value1; 
```

我需要支持嵌套循环。任何人都可以提出一个想法如何使用 Flex/Bison 来实现它。

多谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T22:41:00.063

Flex 和 bison 是解析工具。因此，您可以使用它们将您的语言解析为某种内部形式，然后您可以评估该内部形式以产生您想要的输出。这实际上是两个完全不同的任务，仅与您选择使用的内部形式相关（可以是任何东西——最好的取决于您的语言是什么，以及您希望预处理器用它做什么） .

总体而言，您的问题是如此广泛，以至于它无法回答任何更详细的答案，而不仅仅是“使用 flex 和 bison 来解析您的语言，并使用某种简单的解释器来评估结果”。至于你是如何做到这一点的，那大约是 30 或 40 个不同的问题。

# java - Java setBorder 打破了组件填充

> ID：11765163
> 
> 赞同：2
> 
> 时间：2012-08-01T18:17:27.387
> 
> 标签：java, swing, border, collapse, gridbaglayout

当我使用 GridBagLayout 为 JPanel 中的每个项目设置边框颜色时，组件会崩溃。

![折叠](../Images/0b4b0084687f3baefbe5b1e4d8718a09.png)

但是当我只删除一个组件的边框时，填充保持不变。

![普通的](../Images/ddcc0889338220b83883f0247a870645.png)

我究竟做错了什么？

边框设置：

```
 setBorder(BorderFactory.createLineBorder(Color.decode("#"+Constants.Display.OPTIONS_BORDER_COLOR))); 
```

面板：

```
public class OptionsPanel extends JPanel {
    private AddMachineBtn addMachineBtn;
    private SearchField searchField;
    private SearchBtn searchBtn;

    private GridBagConstraints gbc;

    public OptionsPanel() {
        init();
        config();
        build();
    }

    private void init() {
        addMachineBtn = new AddMachineBtn("Add Machine");
        searchField = new SearchField("Search...");
        searchBtn = new SearchBtn("S");

        gbc = new GridBagConstraints();
        int i = Constants.Display.OPTIONS_PANEL_PADDING;
        gbc.insets = new Insets(i, i, i, i);
    }

    private void config() {
        setLayout(new GridBagLayout());
        setBorder(BorderFactory.createMatteBorder(0, 0, 1, 0, Color.decode("#"+Constants.Display.OPTIONS_BORDER_COLOR)));
        setPreferredSize(new Dimension(0, Constants.Display.OPTIONS_PANEL_HEIGHT));
        gbc.gridy = 0;
        gbc.weightx = 1;
        gbc.weighty = 1;
        gbc.anchor = gbc.LINE_START;
    }

    private void build() {
        gbc.gridx = 0;
        add(addMachineBtn, gbc);

        gbc.weightx = 0;
        gbc.gridx = 1;
        add(searchField, gbc);

        gbc.gridx = 2;
        add(searchBtn, gbc);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:48:11.293

我不确定它是如何影响`GridBagLayout`的，但是“一般来说，当您想在`JPanel`or以外的标准 Swing 组件上设置边框时`JLabel`，我们建议您将组件放在 a 中`JPanel`并在 . 上设置边框`JPanel`。”—<一个 href="http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#setBorder%28javax.swing.border.Border%29" rel="nofollow noreferrer"> `setBorder()`。[这里](https://stackoverflow.com/a/3420431/230513)有一个相关的例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T20:42:46.523

是的，布局对组件的大小没有影响。您可以尝试更改布局（例如更改为 FlowLayout），但情况相同。Swing 组件在初始化期间从 Look'n'Feel 获取其边框。

`System.out.println(addMachineBtn.getBorder());`在 addMachineBtn 创建后插入。你会看到边界已经存在

```
javax.swing.plaf.BorderUIResource$CompoundBorderUIResource 
```

此边框为组件提供了自己的插图，当您将边框替换为另一个时，您会丢失其插图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T21:15:57.877

如果保留原始组件的 insets 和替换边框确实很重要，请尝试模仿原生的 Swing 边框。

例如这样的：

```
addMachineBtn.setBorder(new CompoundBorder(new LineBorder(Color.red), new EmptyBorder(5, 17, 5, 17))); 
```

而不是 LineBorder 放置您需要的边框，EmptyBorder 保持不变，只是根据需要更正插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T20:43:43.083

对此的修复正在更改以下内容

```
setSize(new Dimension(w,h));
setMinimumSize(new Dimension(w,h));
setMaximumSize(new Dimension(w,h)); 
```

到

```
setPreferredSize(new Dimension(w,h));
setMinimumSize(new Dimension(w,h));
setMaximumSize(new Dimension(w,h)); 
```

# javascript - 访问新创建的 Facebook 事件返回 false

> ID：11765167
> 
> 赞同：0
> 
> 时间：2012-08-01T18:17:42.633
> 
> 标签：javascript, facebook, facebook-graph-api

我正在尝试使用其 API 创建 Facebook 事件，如以下代码片段所示。

```
function myCallback(callback_response) {
    var eventid = "";
    FB.api('me/events?access_token=(access_token)', 'POST', {name: "Test Event", start_time:1343143952067, privacy:"OPEN", location: "London, England"}, function(response){
        eventid = response.id;
        // eventid gets successfully return, 
        // however, accessing this eventid publicly returns 'false'

        FB.api('/'+ eventid+ '/invited?access_token=(access_token)&users='+callback_response.to,'POST',function(response) {
            // users successfully invited
        });
    });
} 
```

我面临的问题是，即使创建了事件并且我得到了一个 eventid 作为响应，我第二次将用户添加到事件的 FB.api 调用失败了。此外，在直接访问事件 (https://graph.facebook.com/(eventid)) 时，facebook API 返回 false。

我已向用户授予 create_event 权限，所以这不应该是问题。我不确定为什么我看不到由自己的用户 ID 创建的事件。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:52:05.307

我解决了这个问题。在这种特殊情况下，它与 access_token 无关。问题在于 start_time 字段的格式。

将 (start_time:1343143952067) 替换为 (start_time:"2012-10-29T12:00:00") 可以解决问题。

# c# - 为什么当我再次显示相同的 UserControl 时我的内存使用量会增加？

> ID：11765169
> 
> 赞同：0
> 
> 时间：2012-08-01T18:17:45.153
> 
> 标签：c#, memory, user-controls

我有一个 2 窗格 C# 应用程序，左侧是树，右侧是窗格。单击树节点会导致自定义 UserControl 显示在右侧。我在这个应用程序中有几个 UC，具体取决于单击的树节点。当用户单击不同的树节点时，我没有进行任何内存管理，所发生的情况是，无论需要什么 UC 都已加载到旧节点之上。我曾以为 C# 处理内存管理，但是我发现如果我连续单击我的一个树节点，单击离开，然后再次单击同一个树节点，每次加载 UC 时，内存使用量都会持续上升。点击离开并不会释放内存。这里没有非托管代码，但是在 UC 上的 Oracle 中发生了数据库访问，加载了带有记录的 DataGridView。每次单击此树节点时，我需要做什么才能使内存停止爬升？我正在使用 Process Explorer 来监控内存使用情况。在我停止点击之前，它的容量已超过 1 GB。这是加载右侧窗格的代码。谢谢。

```
private void LoadRightPane(TreeNode node)
    {
        splitPanelLeftRight.Panel2.Controls.Clear();

        try
        {
            this.Cursor = Cursors.WaitCursor;

            // Need to create user control on GUI thread
            // But we still will load the various grids on the BW thread
            UserControl uc = null;
            IUap uap;
            INodeTag nodeTag = (INodeTag)node.Tag;
            bool result;
            result = _uapList.TryGetValue(nodeTag.AssemblyTypeName, out uap);
            if (result)
            {
                uc = uap.Create(node); // decides which user control to "new" (based on node info) and returns it
            }

            if (uc != null)
                _bw.RunWorkerAsync(uc);
            else
            {
                this.Cursor = Cursors.Default;
            }
        }
        catch (Exception ex)
        {
            this.Cursor = Cursors.Default;
        }
    }

    void bw_DoWork(object sender, DoWorkEventArgs e)
    {
        if (!(e.Argument is IUapUserControl))
            throw new Exception("Exception: All user controls must implement the IUapUserControl interface.");
        IUapUserControl uc = e.Argument as IUapUserControl;
        uc.Populate(); // populates any info on UC
        e.Result = uc;
    }

    void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        try
        {
            // check for an exception first
            if (e.Error != null)
            {
                return;
            }

            if (e.Result != null)
            {
                splitPanelLeftRight.Panel2.Controls.Add((UserControl)e.Result);
            }
        }
        catch (Exception ex)
        {
            LoggingWrapper.Logger.LogException(ex);
        }
        finally
        {
            this.Cursor = Cursors.Default;
        }
    } 
```

# c# - pictureBox.InvokeRequired 不显示 img

> ID：11765170
> 
> 赞同：0
> 
> 时间：2012-08-01T18:17:53.120
> 
> 标签：c#, image, compact-framework, windows-ce, invoke

我从套接字通信接收`image`as`byte[]`然后我尝试在`pictureBox`. 当我运行代码时，它只显示一条消息错误：`"NullReferenceException"`

处理异常的捕获是`ex1`并且我检查了并且`pic`不是`null`所以我无法弄清楚为什么会发生这个异常。

这是我的代码：

```
try
{
    if (pictureBox1.InvokeRequired)
    {
        try
        {
            pic = imageEmp;
            addControlHandler c = new addControlHandler(addPic);
            this.Invoke(c);
        }
        catch (Exception exc) { MessageBox.Show(exc.Message); }
    }
    else
    {
        pictureBox1.Image = ByteToImage(imageEmp);
    }
}
catch (Exception ex1) 
{
    MessageBox.Show(ex1.Message);                
}

public void addPic()  //when invokeRequired == true
{
    pictureBox1.Image = ByteToImage(pic); 
} 
```

这是要转换为的`byte[]`代码`Image`：

```
public Image ByteToImage(byte[] imageBytes)  //convert byte[] to image
{
    MemoryStream ms = new MemoryStream(imageBytes, 0, imageBytes.Length);
    ms.Write(imageBytes, 0, imageBytes.Length);
    Image image = new Bitmap(ms); 
    return image;
} 
```

**更新 1**：关于汉斯的回答，我对他进行了以下更改：

将我的 ByteToImage 更改为 Hans 的答案并检查错误在哪里，我在以下位置添加了以下行`this.Invoke(c)`：

```
if (c != null)
{
    try
    {
        this.Invoke(c);
    }
    catch (Exception e_c)
    {
        MessageBox.Show(e_c.Message, "exc from e_c");
    }
} 
```

这给了我一个例外：`NullReferenceException`

谢谢你的帮助！

**更新 2：**现在它正在工作，我发送 JPEG 图像而不是 JPG 并且它现在显示它。不知道为什么会发生这种情况，但现在它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:27:51.697

这是一个您可以尝试的示例，我刚刚使用我自己的方法对此进行了测试，此方法有效，因此请用我的 btnStudentPic_Click 中的代码行替换您的代码，让我知道这是否适合您..

对于 Compact Framework，请改用此方法

```
public static byte[] ReadAllBytes(string path)
{
byte[] buffer;

using (FileStream fs = new FileStream(path, FileMode.Open,
FileAccess.Read, FileShare.Read))
{
int offset = 0;
int count = (int)fs.Length;
buffer = new byte[count];
while (count > 0)
{
int bytesRead = fs.Read(buffer, offset, count);
offset += bytesRead;
count -= bytesRead;
}
}

return buffer;
} 
```

//下面的 Windows 示例不用于 CF

```
 private void btnStudentPic_Click(object sender, EventArgs e)
    {
        Image picture = (Image)BrowseForPicture();
        this.picStudent.Image = picture;
        this.picStudent.SizeMode = PictureBoxSizeMode.StretchImage;
    }

    /// <summary>
    /// 
    /// </summary>
    /// <returns></returns>
    private Bitmap BrowseForPicture()
    {
       // Bitmap picture = null;

        try
        {
            if (this.fdlgStudentPic.ShowDialog() == DialogResult.OK)
            {
                byte[] imageBytes = File.ReadAllBytes(this.fdlgStudentPic.FileName);
                StudentPic = new Bitmap( this.fdlgStudentPic.FileName);
                StuInfo.StudentPic = imageBytes;
            }
            else
            {
                StudentPic = Properties.Resources.NoPhotoAvailable;
            }
        }
        catch (Exception)
        {
            MessageBox.Show("That was not a picture.", "Browse for picture");
            StudentPic = this.BrowseForPicture();
        }

        return StudentPic;
    } 
```

# php - 包含路径 - 相对路径

> ID：11765173
> 
> 赞同：-2
> 
> 时间：2012-08-01T18:18:15.607
> 
> 标签：php, include, relative-path

PHP 程序员！

我在 PHP 中遇到了包含函数的问题。

我有一个包含左列栏的网站，该列包含动态内容，我使用包含函数和相对路径获得这些内容，因为绝对路径在包含函数中不可用。

当我导航到其他文件夹中的其他文件时，出现错误：include(folder/fileToBeIncluded.php) [function.include]: failed to open stream: No such file or directory in /home/mywebsite/public_html/thissite/folder/第 3 行的子文件夹/leftcolumn.php

我将如何处理？我完全迷路了，我已经搜索了大约 10 分钟的 Google 和 StackOverflow。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:20:59.330

绝对路径可以与`include`语句一起使用。

尝试：

```
include $_SERVER['DOCUMENT_ROOT'] . '/folder/fileToBeIncluded.php';
// or
include dirname(__FILE__) . '/../fileToBeIncluded.php'; // relative to the path of the file doing the include 
```

至少，您可以对路径进行硬编码以绝对确定（直到您将站点移至其他地方）：

```
include '/home/yoursite/public_html/folder/fileToInclude.php'; 
```

请参阅[`include`](http://php.net/include)文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:25:57.067

我可以建议创建一个专用的“包含”文件夹吗？就像是：

`/home/mywebsite/includes`

在 php.ini 中，您需要添加：

`include_path = "/home/mywebsite/includes/"`

这样，所有调用包含检查`/home/mywebsite/includes`您需要的文件，然后再查找它相对于当前正在处理的页面的位置。

# jquery - 可排序事件获取当前可丢弃

> ID：11765180
> 
> 赞同：3
> 
> 时间：2012-08-01T18:18:44.337
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jquery-ui-droppable

使用 over 事件时，如何获取当前的 droppable？对于当前的 droppable，我的意思是容器暂时悬停在上面。

这是我的代码以使事情变得清晰：

```
$('#widgets-available, #sidebar-drop, #content-drop, #footer-drop').sortable({
    start: function(event, ui) {
        item = ui.item;
        newList = oldList = ui.item.parent().parent();
    },
    over: function(event, ui) {          
        //Get Current droppable??
    }
}).disableSelection(); 
```

});

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-30T15:06:39.597

...或者您可以直接使用事件中的属性而不是进行查找：

```
 over: function(event) { 
      var myDroppable = event.target; //this is element where it's being dropped 
      var mySortable = event.toElement; //this is the "handle" element that fired the sort event in the first place.
} 
```

希望这有效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T01:09:47.020

通过在事件中使用“this”，如下所示

```
over: function(event, ui) {          
        $(this).find('.numdrag').size(); // give the count of elements with class .numdrag in the drop area 
    } 
```

# ios - 使用 UIImageView 参数将 UIView 添加到视图

> ID：11765184
> 
> 赞同：0
> 
> 时间：2012-08-01T18:19:14.243
> 
> 标签：ios, uiview, uiimageview, addsubview

我无法弄清楚这有什么问题。我正在尝试向当前视图添加子视图。我`alloc`和`initWithNibName`我的`SecondViewController`并设置它的`myImageView`参数是 a `UIImageView`。问题是添加子视图时`myImageView`未设置。

这是代码：

```
- (void)viewDidLoad
{
   [super viewDidLoad];
SecondViewController *secondView = [[SecondViewController alloc]initWithNibName:@"SecondViewController" bundle:nil];

secondView.myImageView.image = [UIImage imageNamed:@"image1.png"];

[self.view addSubview secondView.view];
} 
```

如果我`myImageView`通过 Interface Builder 将图像设置为正确显示，`addSubview`但如果我按上述方式设置属性，则它不起作用...`UIImageView`插座在 IB 上正确连接。

这是`SecondViewController`：

```
@interface SecondViewController : UIViewController
{

}

@property(nonatomic,strong)IBOutlet UIImageView *myImageView;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:32:09.010

我相信您的问题是，当您调用`secondView.myImageView.image = [UIImage imageNamed:@"image1.png"];`myImageView 时，插座尚未设置。文档`initWithNibName:bundle:`说，“您指定的 nib 文件不会立即加载。它是在第一次访问视图控制器的视图时加载的。” 所以你需要这样的代码：

```
- (void)viewDidLoad
{
   [super viewDidLoad];
SecondViewController *secondView = [[SecondViewController alloc]initWithNibName:@"SecondViewController" bundle:nil];

// Force the nib to load, which subsequently sets the myImageView outlet
[secondView view];

secondView.myImageView.image = [UIImage imageNamed:@"image1.png"];

[self.view addSubview secondView.view];
} 
```

但是，我不推荐这种方法。您真的应该在 SecondViewController 的 -viewDidLoad 方法中设置 myImageView 插座的图像。那就是它的归属。

```
// SecondViewController.m

- (void)viewDidLoad
{
     [super viewDidLoad];

     self.myImageView.image = [UIImage imageNamed:@"image1.png"];
} 
```

然后在另一个视图控制器的 -viewDidLoad 方法中，只需像以前一样将 SecondViewController 的视图添加为子视图：

```
- (void)viewDidLoad
{
     [super viewDidLoad];

     SecondViewController *secondVC = [[SecondViewController alloc] initWithNibName:@"SecondViewController" bundle:nil];

     [self.view addSubview:secondVC.view];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:22:46.850

如果您通过 IB 设置 myImageView，它将实例化 myImageView。如果您使用上面的代码，myImageView 将被实例化。

您必须在 SecondViewController viewDidLoad 或 initWithFrame 中添加以下行：

```
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0,0,100,100)]
secondView.myImageView = imageView; 
```

[感谢H2CO3]

# java - catch 块中的语句未执行

> ID：11765185
> 
> 赞同：1
> 
> 时间：2012-08-01T18:19:17.987
> 
> 标签：java, exception, exception-handling, catch-block

[在此链接](http://www.java2s.com/Code/JavaAPI/java.sql/SQLExceptiongetErrorCode.htm)的帮助下，我编写了一段`catch`特定的代码。它像是：`exception`

```
catch (SQLException sqle) {
    // TODO Auto-generated catch block
String sqlMessage = sqle.getMessage();
String sqlState = sqle.getSQLState();
int vendorCode = sqle.getErrorCode();
System.out.println("Exception occurred:");
System.out.println("Message: " + sqlMessage);
System.out.println("SQL state: " + sqlState);
System.out.println("Vendor code: " + vendorCode); 
} 
```

但我得到的输出为：

```
java.sql.SQLException: ORA-00001: unique constraint (SYSTEM.PK_USERID) violated

at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:125)
at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:305)
at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:272)
at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:623)
at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:181)
at oracle.jdbc.driver.T4CPreparedStatement.execute_for_rows(T4CPreparedStatement.java:543)
at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1028)
at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:2888)
at oracle.jdbc.driver.OraclePreparedStatement.executeUpdate(OraclePreparedStatement.java:2960)
at accessdb.Dao.insertnewuser(Dao.java:32)
at Registration.doGet(Registration.java:47)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
at java.lang.Thread.run(Thread.java:619) 
```

如果错误是：

> java.sql.SQLException: ORA-00001: 违反唯一约束 (SYSTEM.PK_USERID)

我得到的输出为

```
Exception occurred:
Message: Listener refused the connection with the following error:
ORA-12505, TNS:listener does not currently know of SID given in connect descriptor
The Connection descriptor used by the client was:
localhost:1521:XE
SQL state: null
Vendor code: 0 
```

如果错误是：

> 侦听器拒绝连接并出现以下错误：ORA-12505，TNS:listener 目前不知道连接描述符中给出的 SID 客户端使用的连接描述符是：localhost:1521:XE。

为什么同一段代码会出现输出差异？

**编辑：** 好的，这里是`try`进一步澄清的块。

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    // Authentication and Logging in The Registered User
    Getset g=new Getset();
    Dao dao=new Dao();
    String userid="";
    String fname="";
//  PrintWriter pw=response.getWriter();
    String loginemail=request.getParameter("loginemail");
    String loginpassword=request.getParameter("loginpassword");
    if(loginemail.equals("")||loginemail.equals(" ")||loginpassword.equals("")||loginpassword.equals(" "))
    {
        response.sendRedirect("WelcomePage.jsp");
    }
    else{
    g.setloginemail(loginemail);
    g.setloginpassword(loginpassword);
    try {
        ResultSet rs=dao.loginauthentication(g);
        while(rs.next())   //Fetching all emails and passwords from user table
        {
            String regemail=rs.getString("regemail");
            String regpassword=rs.getString("regpassword");
            System.out.println(""+regemail);
            if(loginemail.equals(regemail) && (loginpassword.equals(regpassword))==true)
            {   
                System.out.println("55555");
                ResultSet rs1=dao.getnameid(g);
                while(rs1.next())   //GET USERID and name FROM NEWUSER TO USE AS PRIMARY KEY
                {
                     userid=rs1.getString("USERID");
                     fname=rs1.getString("FNAME");
                //  System.out.println(""+userid);

                }

                HttpSession session = request.getSession(true);
                  session.setAttribute("USERID", userid);
                  session.setAttribute("FNAME", fname);
                response.sendRedirect("UserHome.jsp");
                return;
            }
        }  
        if(rs.next()==false){
            System.out.println("caught");
            response.sendRedirect("WelcomePage.jsp");
            return; 
        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:36:09.510

您没有发布足够多的代码来提供明确的答案，但这就是您所谓的“有根据的猜测”：您的子句的 the `try`of 您的`catch`子句没有包含这行代码：

```
accessdb.Dao.insertnewuser(Dao.java:32) 
```

使用您的新代码，以下假设更加合理：您的`insertnewuser`方法有自己的`try-catch`块，如下所示：

```
try {
  ...prepare an insert statement...
  stmt.executeUpdate(...);
} catch (SQLException e) { e.printStackTrace(); } 
```

这会**吞下**您的异常，并使您的方法正常完成，尽管有异常。解决方案：从该方法**中删除整个`try-catch`块**并使该方法声明`throws SQLException`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:35:53.397

这里有两个问题。请注意，这个答案只是一个猜测，因为您没有发布足够的代码。

一方面，**当尝试连接到数据库服务器时**`SQLException`抛出an 时，您将获得所需的输出。可能，这意味着您将块放在管理与数据库的连接的代码块中。**`catch`**

 **另一方面，当您尝试这样做时，您会得到一个不需要的输出，`insertnewuser`并且`ORA-00001`DB 会引发错误，这反过来会导致`SQLException`. 这意味着与数据库的连接已成功，但插入操作尚未成功。

你有两个 try-catch 结构吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:41:18.670

让我也加入“让我们猜猜代码”的戏：你正在使用一些持久性抽象而不是调用`flush()`// `ormFlush()`- `what have you`> 所以不能保证立即插入 -> 所以无论何时/何地都会抛出 SQLException？**

# asp.net-mvc-3 - MVC3 razor ----> 删除记录后刷新 OutputCache

> ID：11765190
> 
> 赞同：2
> 
> 时间：2012-08-01T18:19:45.103
> 
> 标签：asp.net-mvc-3, razor, outputcache

我在显示员工记录列表的索引页面上使用 OutputCaching

```
[OutputCache(Duration = 120, VaryByParam = "empId;page;sort;")] 
```

但是当我从列表中删除一条记录时，由于缓存，删除的记录也会被列出，直到 Outputcache 过期。如果发生删除操作，有没有办法刷新输出缓存？我在我的 MVC3 剃须刀页面上使用它。

我的页面上列出了 100 条记录，每条记录都有一个“删除”按钮来删除该特定记录。我还在页面上使用 OutputCaching，以便页面加载更快。

现在，如果我通过点击删除按钮删除一条记录，由于 OutputCaching ，即使已删除的记录也会显示在页面上，直到 outputcache 过期。有没有办法，我可以解决这个问题？

**有没有办法，我可以只从我的输出缓存中删除已删除的记录？**

或者如果要添加新记录，我不想删除 OutputCache 并再次重新创建缓存，而是想将我的新记录附加到现有的 outputCache ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:56:57.187

在控制器或页面加载代码中使用：

```
HttpContext.Cache.Insert("Record"+ recordid, 1);
Response.AddCacheItemDependency("Record"+ recordid); 
```

在记录删除方法中使用

```
 HttpContext.Cache.Remove("Record"+ recordid); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:42:05.557

您能否尝试在您的 url 中附加一个查询字符串参数，该参数会在您删除记录时破坏缓存？这是我用来打破 ajax 获取请求的客户端缓存的常用方法。

然后只需将该查询字符串参数添加到您的 VaryByParam 列表中。我刚刚在本地对此进行了测试，并且能够在我的参数中发送一个不同的值时强制输出缓存中断，该值已被删除RecordId。

因此，每当您完成删除项目并即将重定向回列表操作时，如果您使用 RedirectToAction，请确保在路由值中传递参数，然后只需为路由值创建一个匿名对象以保存您的查询字符串参数缓存破坏。它看起来与此类似：

```
return RedirectToAction("list", "category", new { deletedRecordId = deletedRecordId }); 
```

# c# - 最近的 OpenHardwareMonitor 示例代码 C#

> ID：11765192
> 
> 赞同：5
> 
> 时间：2012-08-01T18:19:53.053
> 
> 标签：c#, cpu, monitor, temperature

有谁知道我在哪里可以找到在 C# 中使用 OpenHardwareMonitor.dll 的最新示例。我尝试了一个简单的实现，但无法获得 cpu Temp。我知道图书馆必须拥有它，因为应用程序本身会获得温度。

我有一种感觉，你必须注册事件才能获得某些事情的读数，但我发现很难找到一个好的例子。

```
Computer myComputer = new Computer();

            myComputer.Open();

            foreach (var hardwareItem in myComputer.Hardware)
            {

                if (hardwareItem.HardwareType == HardwareType.CPU)
                {
                    foreach (var sensor in hardwareItem.Sensors)
                    {
                        if (sensor.SensorType == SensorType.Temperature)
                        {
                            Console.WriteLine(sensor.Value);
                        }
                    }
                }

            } 
```

任何想法或见解将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-01T21:52:33.133

以下是我所得到的。我没有更多的时间花在这上面，所以剩下的侦查工作就交给你了。

我找不到任何文件。代码中甚至没有 XML 注释，所以我挖掘了源代码以达到我所做的一切。你将不得不这样做。

您缺少的第一件事是您必须`Computer.CPUEnabled`在调用之前将属性设置为 true `Computer.Open`。这会导致 Open 添加 CPU 硬件设备。

您缺少的第二件事是您必须调用`Computer.Open`.

您缺少的第三件事是您必须调用`Hardware.Update`它来重新轮询硬件。

您缺少的第四件事是传感器值为 a `Nullable<float>`。您必须检查那里是否存在有效值。

这还不够。虽然它现在输出四个温度传感器（在我的机器上），但从来没有温度值。

我翻遍了设置，发现cpu和cpu的温度有这些长长的初始化项。我添加了代码以将这些设置放入`Computer`（至少对于其中一个内核），但它没有任何效果。

失败的是这个调用`IntelCpu.Update`

```
Ring0.RdmsrTx(IA32_THERM_STATUS_MSR, out eax, out edx, 1UL << cpuid[i][0].Thread) 
```

这就是为什么我怀疑缺少一些初始化。

祝你好运！

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Windows.Forms;
using OpenHardwareMonitor.Hardware;

namespace WindowsFormsApplication1
{
    public class MySettings : ISettings
    {
        private IDictionary<string, string> settings = new Dictionary<string, string>();

        public MySettings(IDictionary<string, string> settings)
        {
            this.settings = settings;
        }

        public bool Contains(string name)
        {
            return settings.ContainsKey(name);
        }

        public string GetValue(string name, string value)
        {
            string result;
            if (settings.TryGetValue(name, out result))
                return result;
            else
                return value;
        }

        public void Remove(string name)
        {
            settings.Remove(name);
        }

        public void SetValue(string name, string value)
        {
            settings[name] = value;
        }
    }

    public class Form1 : Form
    {
        Computer myComputer;
        Timer timer = new Timer { Enabled = true, Interval = 1000 };

        public Form1()
        {
            timer.Tick += new EventHandler(timer_Tick);

            MySettings settings = new MySettings(new Dictionary<string, string>
            {
                { "/intelcpu/0/temperature/0/values", "H4sIAAAAAAAEAOy9B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Iu6//MH37x79i9/+NX6N3/TJm9/5f/01fw1+fosnv+A/+OlfS37/jZ/s/Lpv9fff6Ml/NTef/yZPnozc5679b+i193//TQZ+/w2Dd+P9/sZeX/67v/GTf/b3iP3u4/ObBL//73+i+f039+D8Zk/+xz/e/P6beu2TQZju8yH8f6OgzcvPv/U3/Rb8+z/0f/9b/+yfaOn8079X6fr6Cws7ln/iHzNwflPv99/wyS/+xY4+v/evcJ+733+jJ5//Cw7/4ndy9Im3+U2e/Fbnrk31C93vrt/fyPvdb+N//hsF7/4/AQAA//9NLZZ8WAIAAA==" },
                { "/intelcpu/0/load/0/values", "H4sIAAAAAAAEAOy9B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Iu6//MH37x79i9++mpwcv/md/9df89egZ/xX/ym/5y/4D37618Lv7ya//u+58+u+5d9/z7/5t/w9/6u5fP5bH/6av+eTkXyefXxp26ONaf/v/dG/sf39D/rvnv4e5vc/0IP56/waK/vuHzf5I38P8/tv+mv8Rbb9f0pwTF9/zr/1X9vP/8I//+/6Pf7Z30N+/zdf/HX29zd/859q4aCNP5b//U+U3/+7f+zXOjZwfqvDX/V7/o9/vPz+a1G/pv0f+fGlhfk7eZ//N3/0v28//5X0u/n8Cxq7+f1X/tHft20A5x8a/W5/02+BP36Nf+j/nv8XfzrT+c2//Ob4p3+vktvUhNs/+xcWikP6e/4T/5jS5M8/sL8vP/5ff49f/Ivl9//sHzv6PX/vXyG//9R/94/9HuZ34P/5vyC//3W/5e/1exa/k+Bw4bUBnU2bP4Xg/1bn0uafeTH6PatfKL//N3/0t2y/gG9+/8+IzqYNxmU+/+jwX7afY67/nwAAAP//GYSA31gCAAA=" },
            });

            myComputer = new Computer(settings) { CPUEnabled = true };
            myComputer.Open();
        }

        void timer_Tick(object sender, EventArgs e)
        {
            Trace.WriteLine("");
            foreach (var hardwareItem in myComputer.Hardware)
            {
                if (hardwareItem.HardwareType == HardwareType.CPU)
                {
                    hardwareItem.Update();
                    foreach (IHardware subHardware in hardwareItem.SubHardware)
                        subHardware.Update();

                    foreach (var sensor in hardwareItem.Sensors)
                    {
                        if (sensor.SensorType == SensorType.Temperature)
                        {
                            Trace.WriteLine(String.Format("{0} Temperature = {1}", sensor.Name, sensor.Value.HasValue ? sensor.Value.Value.ToString() : "no value"));
                        }
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-15T01:39:34.013

很抱歉没有将此添加为对先前答案的评论，但我没有足够的声誉。

万一其他人像我一样碰到这个并且有同样的问题，我已经找到了解决这个问题的方法，而不是通过简单地运行 Visual Studio /具有管理权限的编译程序来显示所有 CPU 信息。

如果没有管理权限，似乎无法执行获取 CPU 信息所需的低级 API 调用，但不会显示错误。

# python - 在 Google App Engine 上存储、索引和查询地理空间数据的当前选项有哪些？

> ID：11765202
> 
> 赞同：3
> 
> 时间：2012-08-01T18:20:10.527
> 
> 标签：python, google-app-engine, geospatial

我已经“远离” GAE 平台和社区一段时间了，最​​近的新功能看起来相当引人注目，但我无法弄清楚如何处理 GAE-Python 上的地理数据。有几个可用的开源库：

1.  [地质模型](http://code.google.com/p/geomodel/)
2.  [地理数据存储](http://code.google.com/p/geodatastore/)
3.  [兵变](http://code.google.com/p/mutiny/)

...但是它们没有得到积极维护，并且很长一段时间没有更新，所以我有几个问题：

这些库中的任何一个都可以与[NDB一起使用吗](https://developers.google.com/appengine/docs/python/ndb/)一起使用吗？还有什么我应该尝试使用的吗？GAE 上地理数据的当前最佳实践是什么？

顺便说一句，对于我自己的项目，我不需要存储点以外的任何东西，我需要进行的查询类型（至少在最初）是“X 最接近位置 Y 的结果”和“1 英里内的所有点”位置 Y'。

**更新：**根据评论，geomodel 似乎已被[修补](http://code.google.com/p/geomodel/issues/detail?id=32#c3)以与 NDB 一起使用，而且似乎[新的实验性搜索 API](https://developers.google.com/appengine/docs/python/search/overview#Performing_Location-Based_Searches)允许我需要的搜索类型。然而，这带来了一个新的问题：Search API 会简单地淘汰 geomodel 和类似的库，还是仍然有用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T22:16:34.400

为了放大上述评论之一——[搜索 API](https://developers.google.com/appengine/docs/python/search/overview)现在支持地理搜索。
它可以检索给定半径内的结果并按距离对它们进行排序，因此它应该适用于您想要做的事情。

# php - 如何在 jQuery 中使用 php json_encoded 数组

> ID：11765207
> 
> 赞同：1
> 
> 时间：2012-08-01T18:20:48.267
> 
> 标签：php, javascript, json

在我的 php 代码中，我有

```
 <?php
      $test = json_encode($array);//$array is a valid multidimensional array
 ?> 
```

我正在将此变量传递给 javascript 函数，并尝试将此变量设置为 javascript。

```
 <script>
     var test = "<?php echo $test;?>";
  </script> 
```

（为了澄清我正在使用 codeigniter 框架，为了简单起见，我没有使用如何将变量发送到页面）

但是当我执行上面的代码时，我得到了

```
Uncaught SyntaxError: Unexpected identifier 
```

我检查了我所有的语法。

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T18:23:45.570

不要将解码后的 json 数组放在 javascript 中的双引号内。改成这个。

```
var test = <?php echo $test;?>; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T18:25:03.113

json_encode 的输出不需要用引号括起来，否则会被解释为字符串。此时您需要在 JavaScript 中对其进行解码。

# java - 构造函数和小数格式的Java问题

> ID：11765211
> 
> 赞同：0
> 
> 时间：2012-08-01T18:21:21.657
> 
> 标签：java

java中的以下代码有问题。

我必须有两个构造函数，其中一个我必须默认为黄色，另一个你应该能够选择。我究竟做错了什么？

其次，方法 beraknaomkrets 中小数点后的格式似乎不起作用，我做错了什么。

```
import java.text.*;
import java.io.*;
import java.util.*;

public class Cirkel
{
    //instansvariabler
    private int radie;
    private String farg;

    //konstruktorn
    public Cirkel()
    {
        radie = 0;
        farg = "";
    }

    public Cirkel(String farg)
    {
        radie = 0;
        farg = "gul";
    }

    //metod där man får ange färg
    public void andraFarg()throws IOException
    {
        BufferedReader myIn = new BufferedReader
            (new InputStreamReader (System.in));

        System.out.print("Ange vilken färg cirkeln ska ha: ");
        farg = myIn.readLine();
    }

    //metod som returnerar den aktuella färgen på cirkeln
    public String hamtaFarg()
    {
        return farg;
    }

    //metod där man får ange radien på cirkeln
    public void andraRadie()throws IOException
    {
        BufferedReader stdin = new BufferedReader
            (new InputStreamReader (System.in));

        System.out.print("Välj vilken radie cirkeln ska ha: ");
        radie = Integer.parseInt(stdin.readLine());
    }

    //metod som returnerar radien
    public int hamtaRadie()
    {
        return radie;
    }

    public double beraknaOmkrets()
    {
        NumberFormat formatter = new DecimalFormat("#0.0");

        double omkrets = 0;
        omkrets = radie*2*3.14;
        formatter.format(omkrets);
        return omkrets;
    }

    public double beraknaArea()
    {
        NumberFormat formatter = new DecimalFormat("#0.0");
        double area = 0;
        area = radie*radie*3.14;
        formatter.format(area);

        return area;
    }
}

class TestCirkel
{
    public static void main(String args[])throws IOException
    {
        BufferedReader myIn = new BufferedReader
        (new InputStreamReader (System.in));

        Cirkel c1 = new Cirkel(); //skapa objektet c1
        Cirkel c2 = new Cirkel("gul");

        c1.andraFarg();
        c1.andraRadie();
        System.out.println(" Färgen på cirkel 1 är "+ c1.hamtaFarg());
        System.out.println(" Omkretsen på cirkel 1 är "+ c1.beraknaOmkrets());
        System.out.println("Arean på cirkel 1 är "+c1.beraknaArea());

        c2.andraRadie();
        System.out.println(" Färgen på cirkel 2 är "+c2.hamtaFarg());
        System.out.println(" Omkretsen på cirkel 2 är "+c2.beraknaOmkrets());
        System.out.println("Arean på cirkel 2 är "+c2.beraknaArea());
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:24:45.307

这会将变量 farg 的值从参数分配给实例变量 farg。

```
public Cirkel(String farg)
{
    radie = 0;
    this.farg = farg;
} 
```

现在，如果您希望无论如何都将 farg 的值设置为“gul”，那么您有两个选择。将实例变量初始化为 gul

```
private String farg = "gul"; 
```

或对您的默认构造函数进行修改。任何一个都适合你。

```
public Cirkel()
{
    radie = 0;
    this.farg = "gul";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:26:22.400

在您的非默认构造函数中，您只是将 farg 值设置为“gul”，而不是使用传入的值。该构造函数应该使用

```
this.farg = farg 
```

还可以尝试使用 DecimalFormat 作为您的格式化方法，如此[处所示](https://stackoverflow.com/questions/50532/how-do-i-format-a-number-in-java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:27:39.607

您在构造函数中接收值，但没有将其设置为类变量。在默认构造函数中，该值设置为空字符串，应设置为您感兴趣的颜色（“gul”）。

# sql-server - T-SQL 查询手动工作，但不在触发器中

> ID：11765216
> 
> 赞同：0
> 
> 时间：2012-08-01T18:21:38.380
> 
> 标签：sql-server, tsql, triggers

我的数据库上有一个触发器，用于执行业务规则：当某个“事件”发生时，其中一个表上的标志会更新。我知道这不是触发器的建议使用，最好的办法是在数据库之外，在生成事件的代码中强制执行此规则。但是由于我无法控制的原因，这是不可能的，并且该标志的维护属于数据库。

所以，我设计了适当的查询来维护这个标志。查询是这样的：

```
UPDATE flg_tbl
SET flag = 'T'
FROM flag_table AS flg_tbl
INNER JOIN table1 AS tbl1 ON tbl1.id = flg_tbl.id
INNER JOIN table2 AS tbl2 ON tbl2.id = flg_tbl.id
...
WHERE tbl2.id IN (SELECT id FROM inserted) 
```

当我手动运行此查询时，一切正常。但作为一个触发器，什么都没有发生。

此触发器将在表插入流之后执行，这会影响查询中的所有内部连接表。我将触发器作为 AFTER INSERT 触发器放在表列表中更新的最后一个表上，但它仍然不起作用。我觉得在这个插入流中执行它的事实是罪魁祸首；也许所有表都还没有提交，并且触发器正在使用旧数据，尽管已被触发。

有没有办法将触发器延迟到整个事务提交之后？或者它是等到它被提交，而我只是没有看到真正的原因？

查询的完整混淆版本（X 是要更新的表，I 是触发器所在的表）：

```
UPDATE X
SET X.flag = 'T'
FROM tableA AS A
INNER JOIN tableB AS B ON A.id = B.id
INNER JOIN tableX AS X ON X.otherrow = B.otherrow
INNER JOIN tableA AS A2 ON A.diffrow = A2.diffrow AND X.id = A2.id
INNER JOIN tableC AS C ON B.id = C.id AND C.otherflag = 'A'
INNER JOIN tableI AS I ON I.id = B.id
WHERE I.id IN (SELECT id FROM inserted) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:53:35.543

引用 tableI （带有触发器的那个）似乎没有必要，因为它的行在`inserted`. 以下似乎是等效的，并且可以避免该问题：

```
UPDATE X
SET X.flag = 'T'
FROM tableA AS A
INNER JOIN tableB AS B ON A.id = B.id
INNER JOIN tableX AS X ON X.otherrow = B.otherrow
INNER JOIN tableA AS A2 ON A.diffrow = A2.diffrow AND X.id = A2.id
INNER JOIN tableC AS C ON B.id = C.id AND C.otherflag = 'A'
WHERE B.id IN (SELECT id FROM inserted) 
```

或者

```
UPDATE X
SET X.flag = 'T'
FROM tableX AS X
INNER JOIN tableB AS B ON X.otherrow = B.otherrow
INNER JOIN tableA AS A ON A.id = B.id
INNER JOIN tableA AS A2 ON A.diffrow = A2.diffrow AND X.id = A2.id
INNER JOIN tableC AS C ON B.id = C.id AND C.otherflag = 'A'
WHERE B.id IN (SELECT id FROM inserted) 
```

# php - CodeIgniter：如何在库中使用安全类的 xss_clean 函数？

> ID：11765218
> 
> 赞同：4
> 
> 时间：2012-08-01T18:21:39.693
> 
> 标签：php, codeigniter

我正在尝试在我的库中调用安全类的 xss_clean 函数。这是我正在使用的：

```
array_map('$this->CI->security->xss_clean', $shipping_info); 
```

`$shipping_info`是一个数组。 `CI`是我在构造函数中实例化的全局 CodeIgniter 对象：`$this->CI =& get_instance();`

这是php错误：

```
array_map() expects parameter 1 to be a valid callback, function 
        '$this->CI->security->xss_clean' not found or invalid function name 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T19:05:38.093

尝试：

```
<?php
array_map(array($this->CI->security, 'xss_clean'), $shipping_info); 
```

# c# - UpdateListItems ...几乎可以工作

> ID：11765227
> 
> 赞同：0
> 
> 时间：2012-08-01T18:22:11.547
> 
> 标签：c#, list, sharepoint, caml

我已经把头撞在墙上太久了。

我一直在为我的 Sharepoint 服务器（2007 年，所以没有客户端对象模型）使用 lists.asmx Web 服务，并且我已经能够成功更新服务器上每个所需的项目字段......日期除外。我指的不是只读日期。只是可以为网站本身的列表项以 mm/dd/yyyy 格式输入的日期。

我在 C# 中，如果有人能看到对我的 CAML 的潜在简单更正（这是问题所在，我很确定），我将不胜感激。

```
batchElementGlobal.InnerXml = "<Method ID='1' Cmd='Update'>" +

        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='Title'>" + tempExperiment.ProjName + "</Field></Method>" +

        "<Method ID='1' Cmd='Update'>" +
        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='Experiment_x0020_Lead'>" + tempExperiment.ProjLead + "</Field></Method>" +

        "<Method ID='1' Cmd='Update'>" +
        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='Technology_x0020_Partner'>" + tempExperiment.TechPartner + "</Field></Method>" +

        "<Method ID='1' Cmd='Update'>" +
        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='IT_x0020_Functional_x0020_Area'>" + tempExperiment.FunctionalArea + "</Field></Method>" +

        "<Method ID='1' Cmd='Update'>" +
        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='Start_x0020_Date'>" + strProjStartDateTime + "</Field></Method>" +

        "<Method ID='1' Cmd='Update'>" +
        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='End_x0020_Date'>" + strProjEndDateTime + "</Field></Method>" +

        "<Method ID='1' Cmd='Update'>" +
        "<Field Name='ID'>" + GlobalVariables.ID + "</Field>" +
        "<Field Name='Read_x0020_Out_x0020_Date'>" + strProjReadoutDateTime + "</Field></Method>" + 
```

（这是一个精简的版本。想展示我如何格式化多字字段以及它们的工作原理。strProjXXXDateTime 字符串都采用相同的格式。例如：“6/18/2012”）

SharePoint 结束时可能有某种格式的日期，但我认为由于您可以在网站本身上以标准字符串格式输入日期，因此完全可以选择使用字符串。也许不是？如果您还需要什么，请告诉我。

谢谢！

（旁注——在过去的测试中，我认为我得出的结论是每个字段都需要自己的方法部分，我认为这很奇怪。即使它正在更新一个项目，它也需要区分。这只是侥幸吗？我可以把所有该领域采用一种方法？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T11:51:09.183

在自定义列表的 ItemUpdating (SPItemEventReceiver) 中，为了更新自定义日期时间字段的日期（DateOnly 模式），我被迫使用：

```
SPUtility.CreateISO8601DateTimeFromSystemDateTime(DateTime.Today) 
```

处理日期的奇怪方式；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:26:53.057

...是的。愚蠢的错误。

[http://msdn.microsoft.com/en-us/library/lists.lists.updatelistitems(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/lists.lists.updatelistitems(v=office.12).aspx)

或者，对于那些不喜欢点击链接的在家玩的人：2006-1-11T09:15:30Z

我确实尝试将我的日期转换为这种格式，但显然它不够具体。

这只是成功了。希望遇到这个愚蠢障碍的其他人会发现这很有用。

就这样。:)

# jquery - Add class to href by jquery

> ID：11765237
> 
> 赞同：0
> 
> 时间：2012-08-01T18:23:07.757
> 
> 标签：jquery, class

Following this post: [add class to all links that link to a certain domain with js (jquery)](https://stackoverflow.com/questions/1713222/add-class-to-all-links-that-link-to-a-certain-domain-with-js-jquery)

I attempted to add a class to hyperlinks with jquery, but it is causing me hell. I am developing a site locally which I added this code to (as well as having jquery linked to):

```
<script type="text/javascript">
$("a[href*='gallery']").addClass('thumb');
</script> 
```

with no effect on my links. I decided to strip down the page to the barest bones, see if I could identify the problem. Still no effect. As soon as I place it online, it works:

[http://www.anunexpectacle.com/files/test.html](http://www.anunexpectacle.com/files/test.html)

Is there something about local dev that would stop this? Why am I unable to give my links a class by jquery? Please help!

Thanks, Matt

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:24:58.747

put the code inside a document.ready function so it waits for the dom to load up

```
$(document).ready(function(){
    // code here
}); 
```

or shortform

```
$(function(){
    // code here
}); 
```

Also make sure you are importing the jQuery library into your project

ex.

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

# javascript - 如果匹配，则为数组中的每个项目执行此操作，否则如果使用 jvectormaps

> ID：11765240
> 
> 赞同：1
> 
> 时间：2012-08-01T18:23:18.037
> 
> 标签：javascript, jquery, arrays, variables, jvectormap

我正在尝试设置一个状态数组，如果数组中存在状态或值，则执行一个函数。下面是我试图修改的实际代码，而“stateRedirects” var 是我在 if (code === stateRedirects) { } 中尝试给我们的。

```
var stateRedirects = [
    'US-TX',
    'US-CA',
    'US-AL'
    // more will be added
]

$('.map').vectorMap({
    map: 'us_en',
    backgroundColor: 'transparent',
    color: '#0071A4',
    hoverColor: false,
    hoverOpacity: 0.5,
    normalizeFunction: 'polynominal',
    scaleColors: ['#C8EEFF', '#0071A4'],
    onLabelShow: function(event, label, code){
        if (code === stateRedirects ) {
            //do nothing
        }
        else if (code) { //if a state is not specified in var stateRedirects then prevent default
            event.preventDefault();
        }                   
    },      
    onRegionOver: function(event, code){
        if (code === stateRedirects ) {
            //do nothing
        }
        else if (code) { //if a state is not specified in var stateRedirects then prevent default
            event.preventDefault();
        }                   
    },
    onRegionClick: function (event, code) {
        window.location = '/' + code;
    }   
}); 
```

根据评论，我将其更改为使用 [ 和 ] 但现在无法弄清楚如何让它查看代码是否与此行中的数组匹配`if (code === stateRedirects ) {`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:36:31.117

[用方括号正确定义您的状态代码数组](https://developer.mozilla.org/en/JavaScript/Guide/Values,_Variables,_and_Literals#Array_literals)。然后使用[array.contains 功能](https://stackoverflow.com/q/237104/1048572)，这似乎是你想要的。

# iphone - iOS：来自 Photoshop 的 CIFilter (Hue) 值

> ID：11765244
> 
> 赞同：4
> 
> 时间：2012-08-01T18:23:30.253
> 
> 标签：iphone, ios, image-processing, photoshop, hue

我正在使用`Hue`滤镜来改变图像的色调：

```
CIFilter* hueFilter = 
     [CIFilter filterWithName:@"CIHueAdjust" <blah blah> 
        [NSNumber numberWithFloat:hue], nil]; 
```

我有`Hue`我想使用的号码 from `Photoshop`，但它与我从 iOS 获得的结果不对应。

是否有规则将数字更改为`PhotoShop`我应该使用的数字`iOS`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-01T18:34:02.200

HSL/HSV 颜色模式中的色调是角坐标。在 Photoshop 中，它以度数（-180 到 +180）给出。

在 CIHueAdjust 过滤器中，角度以弧度给出。来自[http://developer.apple.com/library/ios/#documentation/graphicsimaging/Reference/CoreImageFilterReference/Reference/reference.html#//apple_ref/doc/filter/ci/CIHueAdjust](http://developer.apple.com/library/ios/#documentation/graphicsimaging/Reference/CoreImageFilterReference/Reference/reference.html#//apple_ref/doc/filter/ci/CIHueAdjust)

> **参数**
> 
> *输入角度*
> 
> 一个`NSNumber`类，其属性类型为`CIAttributeTypeAngle`，其显示名称为 Angle。
> 
> 默认值：0.00 最小值：0.00 最大值：0.00 滑块最小值：-3.14 滑块最大值：3.14 标识：0.00

从 Photoshop 值（度）到 CIHueAdjust 值（弧度）的公式是线性转换：

```
filterAngle = photoshopAngle * π / 180 
```

# ruby-on-rails-3 - Ruby on Rails 教程第 9 章

> ID：11765248
> 
> 赞同：0
> 
> 时间：2012-08-01T18:24:09.610
> 
> 标签：ruby-on-rails-3

我对在参数中添加 [:session] 感到困惑。它似乎也破坏了我的网站。有人可以解释一下这对我有什么作用吗？

```
class SessionsController < ApplicationController
  .
  .
  .
  def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
      sign_in user
      redirect_back_or user
    else
      flash.now[:error] = 'Invalid email/password combination'
      render 'new'
    end
  end
  .
  .
  .
end 
```

错误信息：

1) 使用无效信息的身份验证登录失败/错误：在 { click_button "Sign in" } NoMethodError: undefined method `[]' for nil:NilClass # ./app/controllers/sessions_controller.rb:7:in`create' # (eval):2:in `click_button' # ./spec/requests/authentication_pages_spec.rb:18:in`block (4 levels) in '之前

# 编辑 8/2

我相信这个问题与从 form_for 到 form_tag 的切换有关。我丢失了对交换机中会话的引用，因为我不知道如何正确包含它。如果有人对此问题有任何建议，将不胜感激。我想知道是否有实际原因希望它是 params[:session][:email] 还是只是为了组织？

新的.html.erb

```
<% provide(:title, "Sign in") %>
<h1>Sign in</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_tag sessions_path do %>

      <%= label_tag :email %>
      <%= text_field_tag :email %>

      <%= label_tag :password %>
      <%= password_field_tag :password %>

      <%= submit_tag "Sign in", class: "btn btn-large btn-primary" %>
    <% end %>

    <p>New user? <%= link_to "Sign up now!", signup_path %></p>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:33:35.737

尝试删除对我有用的 [:session] 括号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:43:31.657

它会阻止您的代码，因为我认为 params[:session] 为零，而您试图从 nil 获取 [:email]，当然应该导致异常。教程中应该有一些代码定义了 params[:session] 哈希。试着看起来更好。为了使您的代码稳定，您必须确保始终定义 params[:session] 或尝试使用 ternar 函数 params[:session] ？参数[：会话] [：电子邮件]：''

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T17:15:27.703

您可以在视图中替换它：

```
<%= form_for :session, :url => sessions_path do %>

  <%= label_tag :email %>
  <%= text_field_tag :email %>

  <%= label_tag :password %>
  <%= password_field_tag :password %>

  <%= submit_tag "Sign in", class: "btn btn-large btn-primary" %>
<% end %> 
```

form_tag 只生成一个 HTML 表单标签，而 form_for 用于描述某些内容。使用 form_for 创建的表单字段的所有输入都将具有如下名称：`user_session[email]`。因此，当您提交表单时，在您的控制器中，您将拥有这个 : `params[:user_session][:email]`。

# python - Python 中的 GData 和 OAuth：无法将请求令牌转换为访问令牌

> ID：11765253
> 
> 赞同：2
> 
> 时间：2012-08-01T18:24:22.937
> 
> 标签：python, oauth, request, token, gdata

我正在尝试在基于 Web 的仪表板上实现一个按钮，该按钮允许用户使用 OAuth 和 GData API 将当前数据导出到 Google 电子表格。目前，我可以让用户进入登录/授予访问页面，但是如果我添加将请求令牌转换为访问令牌的行，我会收到：

“RequestError：无法升级 OAuth 请求令牌以访问令牌：400，parameter_absent oauth_parameters_absent:oauth_token”

我正在遵循此页面上有关 OAuth 2 的说明：

[https://developers.google.com/gdata/docs/auth/oauth](https://developers.google.com/gdata/docs/auth/oauth)

并阅读了 Google API 的 PyDocs 并没有发现有关此问题的详细信息：

[http://gdata-python-client.googlecode.com/hg/pydocs/gdata.docs.client.html#DocsClient](http://gdata-python-client.googlecode.com/hg/pydocs/gdata.docs.client.html#DocsClient)

（不会让我发布此超链接，但其他 Pydoc 是相同的 URL，但将 pydocs/ 之后的部分替换为 gdata.gauth.html#ClientLoginToken）

这是有效的代码：

```
def createDocsClient(self, oauth_callback_url):
  docsClient = gdata.docs.client.DocsClient(source='RiskOps-QualityDashboard')
  request_token = docsClient.GetOAuthToken(SCOPES, oauth_callback_url, CONSUMER_KEY,  consumer_secret=CONSUMER_SECRET)
  domain = None
  auth_url = request_token.generate_authorization_url(google_apps_domain=domain)
  self.redirect(str(auth_url))
  request_token = gdata.gauth.AuthorizeRequestToken(request_token, self.request.uri 
```

使用上面的代码，我进入了一个授权访问页面，如果你点击授权访问页面，你会得到一个 404 错误，因为它不知道去哪里（如预期的那样），但是页面有正确的 URL 显示列表oauth_verifier 和 oauth_token。“AuthorizeRequestToken”行应该使用该 URL 来授权令牌，所以直到这一行，一切似乎都正常。

当我在上面的代码之后添加以下行时，我得到了我写的“RequestError”：

```
access_token = docsClient.GetAccessToken(request_token) 
```

我已经尝试使用 AeSave 和 AeLoad 将调用相互嵌套的不同组合（可能需要说明，但我不确定我的案例是否需要它）以及许多其他随机和不成功的想法，但没有什么是真的让我很好地了解我错过了什么或做错了什么。

真的很感激和帮助或任何人有任何想法。（如果你不能说，我在现实世界的代码（而不是学术代码）方面相当缺乏经验。非常感谢。

# python - Python 字符串和整数

> ID：11765254
> 
> 赞同：1
> 
> 时间：2012-08-01T18:24:28.847
> 
> 标签：python, python-2.7

我有一个 .csv 文件，其中包含如下数据：

```
uc007ayl.1,ENSMUSG00000041439

uc009mkn.1,ENSMUSG00000031708

uc009mkn.1,ENSMUSG00000035491 
```

我有一些代码可以逐列读取它们

```
 import csv
    import os.path
    #open files + readlines
    with open("C:/Users/Ivan Wong/Desktop/Placement/Lists of targets/Mouse/UCSC to Ensembl.csv", "r") as f:
        reader = csv.reader(f, delimiter = ',')
        #find files with the name in 1st row
        for row in reader:
            graph_filename = os.path.join("C:/Users/Ivan Wong/Desktop/Placement/Interesting reading/3'ORF",row[0]+"_nt_counts.txt.png")
            if os.path.exists(graph_filename):
                y = row[0]+'_nt_counts.txt'  
                r = open('C:/Users/Ivan Wong/Desktop/Placement/fp_mesc_nochx/'+y, 'r')
                k = r.readlines()
                r.close
                del k[:1]
                k = map(lambda s: s.strip(), k)
                interger = map(int, k)   
                import iter

tools
            #adding the numbers for every 3 rows
            def grouper(n, iterable, fillvalue=None):
                "grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx"
                args = [iter(iterable)] * n
                return itertools.izip_longest(*args, fillvalue=fillvalue)
            result = map(sum, grouper(3, interger, 0))
            e = row[1] 
```

现在我可以说

```
print row[1] 
```

使其仅显示第二列。我需要这样做，因为我将在另一个文件中找到这些名称。但我有一个问题，因为我认为 python 正在以这种方式读取这些名称：

“E”、“N”、“S”、“M”、“U”、“S”等。

现在这会导致问题，因为我无法从另一个文件夹中找到匹配的名称。有谁知道问题出在哪里以及如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:26:10.823

`row[1]`不是文件的整个第二列。它只是当前行中的第二个字段，即第二列中的许多值之一。

`row[1]`在你的情况下是一个字符串。Python 中的字符串也是序列；您可以调用`len(some_string)`以找出字符串的长度，在给定位置取一个元素`pos`:`some_string[pos]`等。

# c# - 为 Web 服务准备的 SqlCommand

> ID：11765263
> 
> 赞同：1
> 
> 时间：2012-08-01T18:24:59.863
> 
> 标签：c#, web-services, prepared-statement, sqlcommand

我经常使用以下模式为单线程应用程序创建 SqlCommands。

我现在正在创建一个 Web 服务，我担心这种模式无法同时处理来自多个客户端的请求。

有没有办法为多个客户端使用单个“准备好的”SqlCommand，而不是简单地锁定函数以只允许单个客户端一次运行？

```
 private static SqlCommand cmdInsertRecord;

    public static void InsertRecord(String parameter1, String parameter2, SqlConnection connection, SqlTransaction transaction)
    {
        if (cmdInsertRecord == null)
        {
            //Create command
            cmdInsertRecord = connection.CreateCommand();
            cmdInsertRecord.CommandText = @"SQL QUERY";

            //Add parameters to command
            cmdInsertRecord.Parameters.Add("@Parameter1", SqlDbType.Int);
            cmdInsertRecord.Parameters.Add("@Parameter2", SqlDbType.DateTime);

            //Prepare the command for use
            cmdInsertRecord.Prepare();
        }

        cmdInsertRecord.Transaction = transaction;

        //Note SetParameter is an extension that handles null -> DBNull.
        cmdInsertRecord.SetParameter("@Parameter1", parameter1);
        cmdInsertRecord.SetParameter("@Parameter2", parameter2);

        cmdInsertRecord.ExecuteNonQuery();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:28:41.343

> 有没有办法为多个客户端使用单个“准备好的”SqlCommand，而不是简单地锁定函数以只允许单个客户端一次运行？

你不应该——你为什么*要这样做*？

`SqlConnection`您应该每次都创建一个新的和一个新的`SqlCommand`，然后使用它。让连接池和（大概）语句池处理使其高效。

有一个静态`SqlConnection`或`SqlCommand`只是自找麻烦，IMO。

# mongodb - MongoDB：删除基于 ObjectId 的重复文档？

> ID：11765264
> 
> 赞同：0
> 
> 时间：2012-08-01T18:25:00.900
> 
> 标签：mongodb

这确实是一个悬而未决的问题。如果这有点含糊，我很抱歉，但我正在尝试收集其他人的想法，因为我对 Mongo 很陌生

### 情况

*   我意识到我的收藏有多个重复的文档（基于名称键）
*   这些文件`may be same`或`might got changed`在随后的文件转储期间（我们希望保留以后的更改）
*   由于没有插入日期，因此很难通过查看文档来判断哪个是最新的（糟糕的架构设计）

### 通缉

*   删除之前插入的文档
*   我读到集合中的每个文档都被分配了一个`ObjectId`（[此处](http://www.mongodb.org/display/DOCS/Object+IDs)）使文档独一无二

### 问题

*   是否可以根据**ObjectId**知道较早插入的文档并使用删除它`Map Reduce`？
*   还有其他想法和建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:49:52.157

今天晚上我很无聊，所以我们开始吧。

## 第 1 步。让我们准备测试数据。

```
> db.users.insert({name: 'John', other_field: Math.random()})
> db.users.insert({name: 'Bob', other_field: Math.random()})
> db.users.insert({name: 'Mary', other_field: Math.random()})
> db.users.insert({name: 'John', other_field: Math.random()})
> db.users.insert({name: 'Jeff', other_field: Math.random()})
> db.users.insert({name: 'Ivan', other_field: Math.random()})
> db.users.insert({name: 'Mary', other_field: Math.random()})
> db.users.find()
{
    "_id" : ObjectId("501976e9bee9b253265bba8b"),
    "name" : "John",
    "other_field" : 0.9884713875252772
}
{
    "_id" : ObjectId("501976e9bee9b253265bba8c"),
    "name" : "Bob",
    "other_field" : 0.048004131996396415
}
{
    "_id" : ObjectId("501976e9bee9b253265bba8d"),
    "name" : "Mary",
    "other_field" : 0.20415803582615222
}
{
    "_id" : ObjectId("501976e9bee9b253265bba8e"),
    "name" : "John",
    "other_field" : 0.5514446987265585
}
{
    "_id" : ObjectId("501976e9bee9b253265bba8f"),
    "name" : "Jeff",
    "other_field" : 0.8685077449753242
}
{
    "_id" : ObjectId("501976e9bee9b253265bba90"),
    "name" : "Ivan",
    "other_field" : 0.2842514340422925
}
{
    "_id" : ObjectId("501976eabee9b253265bba91"),
    "name" : "Mary",
    "other_field" : 0.984048520281136
} 
```

## 步骤 2\. map-reduce

```
var map = function() {
  emit(this.name, this);
};

var reduce = function(name, vals) {
  var last_obj = null;
  vals.forEach(function(v) {
    if(!last_obj || v._id > last_obj._id) {
      last_obj = v;
    }
  });
  return last_obj;
};

db.users.mapReduce(map, reduce, {out: 'temp_coll'}) 
```

它基本上按名称对所有文档进行分组，然后选择最大的文档`_id`。

## 步骤 3\. 使用独特的数据做一些事情。

```
> db.temp_coll.find()
{
    "_id" : "Bob",
    "value" : {
        "_id" : ObjectId("501976e9bee9b253265bba8c"),
        "name" : "Bob",
        "other_field" : 0.048004131996396415
    }
}
{
    "_id" : "Ivan",
    "value" : {
        "_id" : ObjectId("501976e9bee9b253265bba90"),
        "name" : "Ivan",
        "other_field" : 0.2842514340422925
    }
}
{
    "_id" : "Jeff",
    "value" : {
        "_id" : ObjectId("501976e9bee9b253265bba8f"),
        "name" : "Jeff",
        "other_field" : 0.8685077449753242
    }
}
{
    "_id" : "John",
    "value" : {
        "_id" : ObjectId("501976e9bee9b253265bba8e"),
        "name" : "John",
        "other_field" : 0.5514446987265585
    }
}
{
    "_id" : "Mary",
    "value" : {
        "_id" : ObjectId("501976eabee9b253265bba91"),
        "name" : "Mary",
        "other_field" : 0.984048520281136
    }
} 
```

例如，删除原始集合，迭代这个集合并将值插入新集合。完成后不要忘记删除临时集合。

## 重要的

我没有费心从 objectid 中提取时间戳，因为我假设您不是每秒运行两次导入作业（甚至可能不是每秒）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:40:52.447

好的，因为对象 id 使用时间戳，因为它前导四个字节，你可以用一点数学来做到这一点。

值得庆幸的是，mongo shell 有一种方法可以从对象 id 获取时间戳，您需要做更多的 javascript 来首先查询具有相同名称的文档，然后将它们存储在临时变量（如果使用命令行）或临时表（如果使用驱动程序）并使用下面链接中显示的时间戳获取器解析每个单独的 id。

[http://www.mongodb.org/display/DOCS/Optimizing+Object+IDs#OptimizingObjectIDs-Extractinsertiontimesfromidratherthanhaveaseparatetimestampfield](http://www.mongodb.org/display/DOCS/Optimizing+Object+IDs#OptimizingObjectIDs-Extractinsertiontimesfromidratherthanhavingaseparatetimestampfield)。

请记住，对象 ID 仅精确到秒，因此这在快速插入模式下仍然无济于事。

但无论哪种方式，您所要求的都可以在 map reduce 函数中或以上面显示的方式通过命令行执行。

试一试，如果你卡住了，请告诉我。如果我知道你的收藏结构，我可能会很快做出一些东西，但只有在你敲了几次头之后:)

# .net - 在哪里可以找到和下载不同版本的 mscorwks.dll 和 mscordacwks.dll？

> ID：11765266
> 
> 赞同：2
> 
> 时间：2012-08-01T18:25:03.077
> 
> 标签：.net, windows, windbg, debug-symbols

当我能够获取崩溃转储时，我正在尝试习惯使用 WinDbg 对故障转储进行故障排除，但每次我这样做时，它似乎都在要求我提供不同版本的 mscorwks.dll 和 mscordacwks.dll，而我没有'并不总是可以访问转储所来自的机器。

除了告诉最终用户他们必须在 Windows 目录中挖掘这些文件之外，还要向我发送一个大得离谱的“迷你”转储文件，还有什么地方可以得到这些文件的不同版本的副本吗？WinDbg 似乎无法通过 Microsoft 的符号服务器找到它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T04:15:09.997

您应该从捕获此转储的机器上获取 mscordacwks.dll，然后将其重命名为 WinDbg 期望的名称（通常将其放入 WinDbg 文件夹中）。之后，如果您重新加载转储和符号，您可以获得正确的结果。

如果它恰好具有相同级别的修补程序（Microsoft 修补程序），您可以从您的一台机器复制该文件，但通常很难。

是的，如果 Microsoft 有一个中心位置供我们下载此文件的所有版本，那么我们可能会松一口气，但在此之前我们必须使用此解决方法。

参考

*   [https://blog.lextudio.com/how-to-prepare-your-windbg-magic-box-43b5e9ad8a03](https://blog.lextudio.com/how-to-prepare-your-windbg-magic-box-43b5e9ad8a03)
*   [https://github.com/mscordacwks/MscordacwksCollector](https://github.com/mscordacwks/MscordacwksCollector)

**更新**在别处已经提到您可能能够从修补程序中提取特定版本的 mscordacwks.dll。这是可行的，但通常需要时间来搜索正确的修补程序。

# android - Android中可重复时间段的选择器

> ID：11765268
> 
> 赞同：0
> 
> 时间：2012-08-01T18:25:13.907
> 
> 标签：android, user-interface, datepicker

我想显示选择器组件，它将选择应该重复的日期和月份。

结果，用户可以获得可重复的数据：

例如。*每月重复每月的第四天*或每两个月*重复每月的第一天*

Android中是否有任何标准的UI组件可以允许这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:19:14.700

您可以使用两个[`NumberPicker`小部件](http://developer.android.com/reference/android/widget/NumberPicker.html)。`NumberPicker`是 API 级别 11 的原生版本，并且可能在某处浮动它的反向移植。

# uiviewcontroller - UILabel 控制另一个视图控制器中的 UItextfield

> ID：11765272
> 
> 赞同：1
> 
> 时间：2012-08-01T18:25:25.673
> 
> 标签：uiviewcontroller, uitextfield, uilabel

我正在使用 Xcode 4.3，并且我在一个视图控制器中有一个标签，我想更新另一个视图控制器中文本字段中的文本。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:30:21.383

您应该将文本放在模型类中（假设您有一个；如果没有，则需要创建它）。当最终用户编辑文本字段时，您的代码应该更改模型中的字符串；当标签显示时，您应该从模型中读取其文本。在多个类之间共享模型的最简单方法是定义一个[*单例*](http://en.wikipedia.org/wiki/Singleton_pattern)。

标题：

```
@interface Model : NSObject
@property (NSString*) labelText;
+(Model*)instance;
@end 
```

执行：

```
@implementation Model
@synthesize labelText;
+(Model*)instance{
    static Model *inst;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        inst = [[Model alloc] init];
    });
    return inst;
}
-(id)init {
    if (self = [super init]) {
        labelText = @"Initial Text";
    }
    return self;
}
@end 
```

使用模型：

```
// Setting the field in the model, presumably in textFieldDidEndEditing:
// of your UITextField delegate
[Model instance].labelText = textField.text;

// Getting the field from the model, presumably in viewWillAppear
myLabel.text = [Model instance].labelText; 
```

# c# - ado.net Linq 查询与连接表

> ID：11765275
> 
> 赞同：0
> 
> 时间：2012-08-01T18:25:29.543
> 
> 标签：c#, entity-framework-4, ado.net

这是我的 edmx 图。

![在此处输入图像描述](../Images/071d886a42d28df246bb01f3aeb98949.png)

我正在尝试使用

`UserEntity.users.ToList<user>();`

`User`这为我提供了一个包含 s的复杂对象`user_groups`，但我似乎找不到`Group`信息。我的理解是 EF 应该抽象出连接表并为我提供对`Group`信息的直接访问。请注意，我来自 cakephp，希望得到类似的风格结果！

编辑：型号代码

```
 public static class UserModel
    {
        static UserEntities dataContext = new UserEntities();

        public static void CreateUser(user _newUser)
        {
            dataContext.users.AddObject(_newUser);
            dataContext.SaveChanges();
        }

        public static List<user> GetAllUsers()
        {
            return dataContext.users.ToList<user>();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:32:00.273

`users`和之间存在一对多的关系，因此您可以从中`user_group`选择一个和反对，您将获得组。`user_group``users`

```
var result = users.user_group.FirstOrDefault().group; 
```

Navigation`user_group`中的属性`users`将包含一组`user_group`对象，您可以`First`根据自己的要求进行选择或任何内容，然后从中进行选择`group`。

# php - Google 建议的 num_queries 指标是什么

> ID：11765276
> 
> 赞同：1
> 
> 时间：2012-08-01T18:25:32.483
> 
> 标签：php, api, seo

我使用[http://www.google.com/complete/search?output=toolbar&oe=utf8&hl=fr&q=test](http://www.google.com/complete/search?output=toolbar&oe=utf8&hl=fr&q=test)并且我想知道每个关键字的 num_queries 是每天、每月、每年的查询次数？

你知道吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T04:19:27.257

我确认这是为搜索返回的结果总数。您可以通过将自动建议的 num_queries 与使用该术语搜索 google 时列出的结果总数进行对比来亲自查看。你会发现一个非常线性的关系。

# jsf - 如何清洁 全局过滤器字段？

> ID：11765279
> 
> 赞同：0
> 
> 时间：2012-08-01T18:25:51.670
> 
> 标签：jsf, jsf-2, primefaces

我有以下要求：

如果用户按下分页器按钮之一并且其中有一个值，`globalFilter` `inputText`则应删除该值。

这是表格（延迟加载）：

```
 <p:dataTable id="osTable"
        var="os" 
        value="#{bean.lazyModel}" 
        selection="#{bean.selectedObjectSet}" 
        selectionMode="single"
        rowKey="#{os.ID}"
        paginator="true"
        paginatorPosition="bottom"
        paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
        rowsPerPageTemplate="5,10,15"
        rows="10"
        widgetVar="table">
        <f:facet name="header">  
            <p:outputPanel style="float: right">  
                <h:outputText value="Search all fields:" />  
                <p:inputText id="globalFilter" 
                             value="#{bean.find}" 
                             onkeypress="if (event.keyCode == 13) {table.filter()}" 
                             style="width:150px">

                </p:inputText>
            </p:outputPanel>  
        </f:facet> 
```

我想我需要通过 javascript 来做到这一点，但我不知道如何实现这种功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:06:39.537

尝试这个 ：

```
<p:ajax event="page" oncomplete="jQuery('#yourFormID\\:yourDataTableID\\:globalFilter').val('')"/> 
```

这应该在分页完成时清洁过滤器....

# eclipse - 如何使贡献的 Eclipse 命令键绑定可配置？

> ID：11765283
> 
> 赞同：2
> 
> 时间：2012-08-01T18:25:59.870
> 
> 标签：eclipse, eclipse-plugin

我在 plugin.xml 中为我的命令分配了一个键绑定：

```
 <extension point="org.eclipse.ui.bindings">
        <key commandId="MyCommand"
             contextId="org.eclipse.ui.contexts.window"
             schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
             sequence="M1+R"/>
  </extension> 
```

它可以工作，但它不会出现在 Preferences > Keys 中，因此用户无法更改它。我怎样才能使它可配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:08:59.823

默认情况下，命令会从关键配置首选项页面中过滤掉，除非它被分类。

您可以使用 Key configuration 对话框下半部分的“well-hidden”过滤器按钮禁用此过滤，也可以为您的命令定义一个类别。

# azure - Microsoft BizSpark 和 Azure - 免费提供哪些实例？

> ID：11765285
> 
> 赞同：1
> 
> 时间：2012-08-01T18:26:03.813
> 
> 标签：azure, bizspark

如果这是在正确的 StackExchange 站点中，我深表歉意。我找不到一个似乎非常适合这个问题的地方。我的问题如下..

作为 Microsoft BizSpark 会员，我可以访问免费的 Azure 托管。提供的托管每月 1,500 小时免费小型实例（这相当于 2 个小型实例每天 24 小时运行一整月）。报价的详细信息继续说明**“您可以全职运行 2 个小型实例或以同等比例运行其他大小的实例。”**

这是否意味着我可以在一个月内每天 24 小时免费运行一个 Medium 实例？如果您查看定价，Medium 实例正好是小型实例的两倍。

有没有人有这方面的经验可以加入？提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T20:00:07.073

是的，我知道，我使用 BizSpark 订阅，并且我已经建议并跟随几个 ISV 同行使用它。是的，您是对的，BizSpark 为您提供 1500 个小实例小时，即**单个**Mednium 大小**实例**的 1 个完整月。这是在计算方面。但是您知道，如果您只运行一个实例，您将不在 99.95% 的 SLA 范围内！SLA 仅在每个角色有 2 个或更多实例时才会发生！

# php - 仅选择一个单选按钮

> ID：11765286
> 
> 赞同：1
> 
> 时间：2012-08-01T18:26:07.987
> 
> 标签：php, html, radio-button

我写了下面的代码，它工作得很好并且达到了它的目的，但是我有两个问题。1.它允许选择多个答案& 2.没有选择答案时没有错误消息。

```
<div id="p1" class="SlidingPanelsContent">
  <div class="question"> 
       <div class="label"><span class="number"><?=$question_id++; ?>.</span>
     <? echo $question; ?>
    </div>

<div class="answer" onmouseover="javascript:changeBgColor(event, '#B900A5');" onmouseout="javascript:restoreBgColor(event);"  onclick="this.checked=true; "> 
<input tabindex="-1" type="radio" name="<?php echo rand(); ?>" value="<?=$ans1; ?>" ><? echo $ans1; ?></div>

    <div class="answer" onmouseover="javascript:changeBgColor(event, '#B900A5');" onmouseout="javascript:restoreBgColor(event);" onclick="this.checked=true;">
   <input tabindex="-1" type="radio" name="<?php echo rand(); ?>" value="<?=$ans2; ?>" ><?=$ans2; ?></div>

   <div class="answer" onmouseover="javascript:changeBgColor(event, '#B900A5');" onmouseout="javascript:restoreBgColor(event);" onclick="this.checked=true;">
   <input tabindex="-1" type="radio" name="<?php echo rand(); ?>" value="<?=$ans3; ?>" ><?=$ans3; ?></div>

   <div class="answer" onmouseover="javascript:changeBgColor(event, '#B900A5');" onmouseout="javascript:restoreBgColor(event);" onclick="this.checked=true;">
    <input tabindex="-1" type="radio" name="<?php echo rand(); ?>" value="<?=$ans4; ?>" ><?=$ans4; ?></div>

   </div>

   </div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T18:27:10.700

如果您为单选按钮指定相同的名称，则只能检查一个，因为这是由浏览器强制执行的。如果你给他们不同的名字，就像你`rand()`给他们的名字一样，那么他们都可以被检查，因为他们不会相互关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:28:56.390

您需要为单选按钮提供相同的名称，它们形成一个组，您将只能选择一个组中的一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:29:07.183

> 它允许选择超过 1 个答案

停止使用随机`name`属性。所有相同的`radio`按钮`name`都被认为是同一组的一部分，浏览器只允许选择一个。

> 未选择答案时没有错误消息

你必须实现逻辑来做到这一点。

# language-agnostic - 是否有资源可以找到不同国际货币的分隔符和分隔符？

> ID：11765287
> 
> 赞同：0
> 
> 时间：2012-08-01T18:26:10.557
> 
> 标签：language-agnostic, internationalization, currency, delimiter, separator

具体来说，我正在寻找澳大利亚人将如何展示：

```
$20,000,000.00 
```

他们会在这些地方使用逗号和小数吗？其他国家呢？是否有提供此信息的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T20:09:22.360

为了回答您的问题，en-AU（澳大利亚）货币的格式为 $1,000,000，就像美国货币一样，您可以看到一张漂亮的表格：[https ://code.google.com/p/jquery-formatcurrency/wiki/InternationalSupport](https://code.google.com/p/jquery-formatcurrency/wiki/InternationalSupport)

了解更多信息：

如果您有窗口，则可以进入控制面板-> 区域和语言，然后在格式下更改语言并单击“其他设置”如果您正在寻找可以使用.Net 以编程方式查询的数据库，则有[CultureInfo.NumberFormat](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.numberformat.aspx)可以针对不同区域上拉的功能。您可以试用示例代码。此外，您可能还想查看有关该主题的 microsoft 网站：http: [//msdn.microsoft.com/en-us/goglobal/bb688121](http://msdn.microsoft.com/en-us/goglobal/bb688121)。

# svn - SVN 连接问题

> ID：11765290
> 
> 赞同：1
> 
> 时间：2012-08-01T18:26:27.520
> 
> 标签：svn

我在数据中心有一台 SVN 服务器，在办公室有一台 SVN 服务器。我将代码签入办公室的 SVN 服务器，此代码来自数据中心。我在办公室创建了 SVN 存储库，该存储库指向数据中心代码中的代码。我将 office svn 中的代码签出到我的本地机器中。所以这就是问题所在。我在办公室服务器中更新了指向数据中心svn的代码。它工作正常。更新 svn 后，我在本地机器上更新代码它不起作用。我可以看到办公室 svn 的变化，但我无法更新我的本地 svn。所以整个画面就像office server 中的代码指向数据中心svn repository 我在office server 中创建的repository 指向office server 中指向数据中心repository 的代码。我的本地机器中有指向办公室服务器存储库的代码。如果您更新办公室服务器中的代码。为什么你不能在本地机器上更新代码。理论上，它应该工作。任何想法？

# testng - TestNG：@BeforeClass 失败导致其他@Factory 实例被跳过

> ID：11765292
> 
> 赞同：0
> 
> 时间：2012-08-01T18:26:31.383
> 
> 标签：testng, factory

假设我有一个`@Factory`and `@DataProvider`，它返回三个测试实例（相同或不同的）。我的测试也`group-by-instance`启用了。现在，假设执行的第二个测试实例（不一定是创建的第二个测试实例 - 为什么？）有一个`@BeforeClass`失败的。为什么第三个实例（自测试初始化​​以来未触及）完全跳过而不是执行？三个测试实例不应该是完全独立的吗？

如果这是设计使然，有没有办法拥有一个“实例级”的@Before 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T15:50:47.373

我也遇到了这个问题。我以为`@BeforeClass`在测试开始前只执行了一次。但是，`@BeforeClass`它会按照您希望的方式在实例之间执行。就个人而言，我的管理`WebDriver`不正确，我的第二个实例由于初始化导致第三个实例被跳过而失败。我尝试过但可能不是最佳实践的其他临时解决方案是使用`dependsOnGroups`或`dependsOnMethods`控制测试实例的流程。

# salesforce - Visualforce：如何使用 $User 显示用户帐户

> ID：11765294
> 
> 赞同：3
> 
> 时间：2012-08-01T18:26:40.390
> 
> 标签：salesforce, apex-code, visualforce, force.com

我有一个用于显示用户名的 visualforce 组件。目前我正在使用以下方法进行操作：

```
!$User.FirstName} {!$User.LastName} 
```

有什么方法可以在不编写 SOQL 的情况下使用它来显示用户帐户。我不想创建一个控制器只是为了显示用户的帐户，我希望有一种更简单、更简单的方法，只使用 Visual force。

我确实尝试过`!$User.Contact.Account}`

但它给了我一个错误。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:41:48.660

以下是您可能想尝试的两件事：

1.  从[$User Visualforce 全局变量](http://www.salesforce.com/us/developer/docs/pages/Content/pages_variables_global.htm)中引用帐户名称。

    `{!$User.Contact.Account.Name}`

2.  如果这不起作用，请在使用此公式命名的用户对象上创建一个新[公式字段](http://na8.salesforce.com/help/doc/en/customize_formulas.htm)`Contact Account Name`：`Contact.Account.Name`。创建该公式字段后，您应该能够在 Visualforce 中使用以下命令引用它：`{!$User.Contact_Account_Name__c}`。

# php - PHP从url中提取特定的 html链接是： [/i'; 编辑 ： 如果您只想要那个链接，那么您可以使用标题（或其他参数）作为提示，试试这个模式： $urlpattern1 = '/<a\s+.*?title="next page="" of="" results"\s+.*?href=".*?\_pgn=(.*?)" .*?="">/i'; 于 2012-08-01T18:32:49.590 回答 Related 4 c# - 创建一个正则表达式模式来验证这个示例表达式 (.1)； 1 vba - 如何从 VBA 单击此特定按钮？ 2 java - 在 Spring Controller 方法调用上填充对象 3 ios - 无法让滚动视图工作 1 postgresql - PostgreSQL - 选择入数组 5 python - 在 PyQt PushButton 点击 期间发送附加变量 0 jasper-reports - 如何使用 JasperReports 创建具有动态列数量的表 1 sql - SQL：跟踪每天被截断的表的更改（并从不同的 srvr 中删除） 1 php - 警告：imagejpeg() [function.imagejpeg]：无法打开 [filename] 进行写入：没有这样的文件或目录 1 node.js - nodejs删除标准输出行 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</a\s+.*?title="next>](http://www.link.com/page.html?thisisthelink&_pgn=2&_al=25&at=t
问问题
问问题 2012-08-01T18:26:49.150
411 次
This question shows research effort; it is useful and clear
1
This question does not show any research effort; it is unclear or not useful
Bookmark this question.
Show activity on this post.
phphyperlinkhrefextract
4
1 回答 1
This answer is useful
0
试试这个模式：
$urlpattern1 = '/<a\s+.*?href= "Next page of results")

 [> ID：11765297
> 
> 赞同：1
> 
> 时间：
> 
> 标签：php, hyperlink, href, extract

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:32:49.590

试试这个模式：

```
$urlpattern1 = '/<a\s+.*?href=".*?_pgn=(.*?)".*?>/i'; 
```

**编辑 ：**

如果您只想要那个链接，那么您可以使用标题（或其他参数）作为提示，试试这个模式：

```
$urlpattern1 = '/<a\s+.*?title="Next page of results"\s+.*?href=".*?\_pgn=(.*?)".*?>/i'; 
```](http://www.link.com/page.html?thisisthelink&_pgn=2&_al=25&at=t
问问题
问问题 2012-08-01T18:26:49.150
411 次
This question shows research effort; it is useful and clear
1
This question does not show any research effort; it is unclear or not useful
Bookmark this question.
Show activity on this post.
phphyperlinkhrefextract
4
1 回答 1
This answer is useful
0
试试这个模式：
$urlpattern1 = '/<a\s+.*?href= "Next page of results")

# c++ - 如何包装 posix_memalign（在 mac 上编译旧代码库）？

> ID：11765300
> 
> 赞同：4
> 
> 时间：2012-08-01T18:26:52.360
> 
> 标签：c++, macos, malloc, posix

我正在尝试在 mac 上编译一个工具包。它引用了 malloc.h 的 memalign 函数，但我能为 mac 找到的唯一关闭函数是 posix_memalign。所以我试图包装 posix_memalign 看起来像 memalign。

我对如何做到这一点有点困惑（因为 void* 和 void** 指针）：

posix_memalign 的签名是

```
int posix_memalign(void **memptr, size_t alignment, size_t size); 
```

memalign 的签名是：

```
void *memalign(size_t blocksize, size_t bytes); 
```

任何指针都非常感谢。（蹩脚的双关语意外！:)

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:29:07.310

就像是：

```
void *memalign(size_t blocksize, size_t bytes) {
  void *result=0;
  posix_memalign(&result, blocksize, bytes);
  return result;
} 
```

这`&result`会让你`void**`打电话`posix_memalign`，然后你可以像 memalign 一样返回结果。

需要注意的一点：这与行为不完全匹配 - memalign 通过返回错误`errno`，但`posix_memalign`将它们作为 an 返回`int`并且不触摸`errno`。您应该确保仍然以某种方式适当地处理错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-19T06:17:25.820

所以正确处理错误：

```
void *memalign(size_t blocksize, size_t bytes)
{
  void *m;
  errno = posix_memalign(&m, blocksize, bytes);
  return errno ? NULL : m;
} 
```

# c - 如何将 C 中的 unix 时间戳作为 int 获取？

> ID：11765301
> 
> 赞同：66
> 
> 时间：2012-08-01T18:26:53.413
> 
> 标签：c, unix, timestamp, epoch

我想获取当前时间戳并使用`fprintf`.

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-08-01T18:32:57.957

对于 32 位系统：

```
fprintf(stdout, "%u\n", (unsigned)time(NULL)); 
```

对于 64 位系统：

```
fprintf(stdout, "%lu\n", (unsigned long)time(NULL)); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-08-01T18:37:19.380

只是转换返回的值`time()`

```
#include <stdio.h>
#include <time.h>

int main(void) {
    printf("Timestamp: %d\n",(int)time(NULL));
    return 0;
} 
```

你想要什么？

```
$ gcc -Wall -Wextra -pedantic -std=c99 tstamp.c && ./a.out
Timestamp: 1343846167 
```

要从纪元开始获得微秒，从 C11 开始，可移植的方法是使用

```
int timespec_get(struct timespec *ts, int base) 
```

不幸的是，C11 还不是随处可用，所以到目前为止，最接近便携的是使用 POSIX 函数之一`clock_gettime`或`gettimeofday`（在 POSIX.1-2008 中标记为已过时，建议使用`clock_gettime`）。

这两个函数的代码几乎相同：

```
#include <stdio.h>
#include <time.h>
#include <stdint.h>
#include <inttypes.h>

int main(void) {

    struct timespec tms;

    /* The C11 way */
    /* if (! timespec_get(&tms, TIME_UTC)) { */

    /* POSIX.1-2008 way */
    if (clock_gettime(CLOCK_REALTIME,&tms)) {
        return -1;
    }
    /* seconds, multiplied with 1 million */
    int64_t micros = tms.tv_sec * 1000000;
    /* Add full microseconds */
    micros += tms.tv_nsec/1000;
    /* round up if necessary */
    if (tms.tv_nsec % 1000 >= 500) {
        ++micros;
    }
    printf("Microseconds: %"PRId64"\n",micros);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-01T18:32:38.510

使用第二精度，您可以打印从函数中获得`tv_sec`的结构字段。例如：`timeval`[`gettimeofday()`](http://pubs.opengroup.org/onlinepubs/009604599/functions/gettimeofday.html)

```
#include <sys/time.h>
#include <stdio.h>

int main()
{
    struct timeval tv;
    gettimeofday(&tv, NULL);
    printf("Seconds since Jan. 1, 1970: %ld\n", tv.tv_sec);
    return 0;
} 
```

编译运行示例：

```
$ gcc -Wall -o test ./test.c 
$ ./test 
Seconds since Jan. 1, 1970: 1343845834 
```

但是请注意，自纪元以来已经有一段时间了，因此`long int`这些天用于适应秒数。

还有一些功能可以打印人类可读的时间。有关详细信息，请参阅[此手册页](http://www.unix.com/man-page/FreeBSD/3/ctime/)。这是一个使用示例`ctime()`：

```
#include <time.h>
#include <stdio.h>

int main()
{
    time_t clk = time(NULL);
    printf("%s", ctime(&clk));
    return 0;
} 
```

示例运行和输出：

```
$ gcc -Wall -o test ./test.c 
$ ./test 
Wed Aug  1 14:43:23 2012
$ 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-10T14:02:10.960

```
#include <stdio.h>
#include <time.h>

int main ()
{
   time_t seconds;

   seconds = time(NULL);
   printf("Seconds since January 1, 1970 = %ld\n", seconds);

   return(0);
} 
```

并且会得到类似的结果：
**自 1970 年 1 月 1 日以来的秒数 = 1476107865**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-03T08:19:25.060

重要的一点是要考虑是否根据 2 个时间戳之间的差异执行任务，因为如果使用 生成它`gettimeofday()`，甚至`clock_gettime(CLOCK_REALTIME,..)`在您设置系统时间的那一刻，您会得到奇怪的行为。

为防止此类问题，请`clock_gettime(CLOCK_MONOTONIC_RAW, &tms)`改用。

# c# - 类与 json 字符串不匹配

> ID：11765302
> 
> 赞同：1
> 
> 时间：2012-08-01T18:27:04.633
> 
> 标签：c#, vb.net, json, json.net

我有 jquery 循环遍历一个 html 表并将其放入一个对象中，然后`JSON.stringify`用于将该 javascript 对象转换为 json ，请参见下面的 json

```
{
"0":{"name":"fdgd","surname":"ssdt"},
"1":{"name":"fdsf","surname":"vn"},
"2":{"name":"dfsb","surname":"mry"},
"3":{"name":"hsdsdfry","surname":"smh"}
} 
```

我的问题是 JSON.net 和我正在尝试匹配的类以将 json 转换为我的`tableT`对象

在`Jsonconvert`我得到空对象之后，你能告诉我我的课程有什么问题吗？我正在使用 vb.net 和 .net 2。所以我想我的问题是如何将我的 tableT 类与我的 json 字符串匹配？感谢您的帮助。

```
Dim tableOBJ As tableT = JsonConvert.DeserializeObject(Of tableT)(myJSON)

Public Class tableT

    Private _allRows As List(Of Rows)

    Property AllRows As List(Of Rows)
        Get
            Return _allRows
        End Get
        Set(ByVal value As List(Of Rows))
            _allRows = value
        End Set
    End Property

End Class

Public Class Rows

    Private _name As String
    Private _surname As String

    Property name As String
        Get
            Return _name
        End Get
        Set(ByVal value As String)
            _name = value
        End Set
    End Property

    Property surname As String
        Get
            Return _surname
        End Get
        Set(ByVal value As String)
            _surname = value
        End Set
    End Property

End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:43:30.287

未经测试，似乎

```
JsonConvert.DeserializeObject(Of tableT)(myJSON) 
```

真的应该更像

```
JsonConvert.DeserializeObject(Of List(Of Rows))(myJSON) 
```

因为 JsonConvert 无法知道您想要 AllRows 对象中的行。

因此，您的代码看起来更像：

```
Dim tableOBJ As New tableT 
tableOBJ.AllRows = JsonConvert.DeserializeObject(Of List(Of Rows))(myJSON) 
```

** 编辑 **

在对此进行测试之后，我只能通过修改 Json 字符串使其看起来更像我理解的 Json 数组应该看起来的样子来让它工作。

具体来说，如果我将数组更改为：

```
{"AllRows": [
{"name":"fdgd","surname":"ssdt"},
{"name":"fdsf","surname":"vn"},
{"name":"dfsb","surname":"mry"},
{"name":"hsdsdfry","surname":"smh"}
]} 
```

然后您的原始代码可以正常工作。

您原来的 Json 正在做的是期望类中有名为 0、1、2 和 3 的 Rows 类型的属性，这在 VB 中是不可能的，而且我敢肯定，这不是您想要完成的。

您可以通过向 tableT 添加类型为 Rows 的零、一、二和三的属性来验证这一点：

```
Public Class tableT

    Public Zero As New Rows
    Public One As New Rows
    Public Two As New Rows
    Public Three As New Rows 
```

将您的 json 更改为：

```
{
"Zero":{"name":"fdgd","surname":"ssdt"},
"One":{"name":"fdsf","surname":"vn"},
"Two":{"name":"dfsb","surname":"mry"},
"Three":{"name":"hsdsdfry","surname":"smh"}
} 
```

并使用您的原始类进行反序列化。然后您将看到新属性填充了您的 json 字符串的内容。

# javascript - jQuery计算来自服务器的img的真实高度/宽度值

> ID：11765307
> 
> 赞同：1
> 
> 时间：2012-08-01T18:27:15.723
> 
> 标签：javascript, jquery, css, image

我的情况是；当其中一个在 css 上定义为 0 时，需要计算图像的原始值`width`和值。`heigth`我不能用jQuery改变CSS，需要这样解决：

[这是示例链接。](http://jsfiddle.net/mjaA3/46/)

CSS：

```
img { width:0px; }​ 
```

jQuery：

```
var imgHeight = $('img').height();
alert(imgHeight);//which returning 0 ofcourse 
```

我希望这可以用更少的代码实现，谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:38:12.460

尝试这个：

```
var img = $("img")[0];
alert( img.naturalWidth + "x" + img.naturalHeight ); 
```

[http://jsfiddle.net/mjaA3/50/](http://jsfiddle.net/mjaA3/50/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:30:58.243

```
var img = $('img'),
    imgHeight = img.css("width","auto").height();
img.css("width","0");
alert(imgHeight); 
```

[这](http://jsfiddle.net/purmou/mjaA3/47/)是一个小提琴。我们所做的只是暂时将高度设置为它的自动值（即图像的 100% 宽度），获取高度，然后将图像重置为`width:0;`.

**编辑：**由于您不能直接操作 CSS，您可以更改类：

```
var img = $('img'),
    imgHeight = img.addClass("auto").height();
img.removeClass("auto");
alert(imgHeight);​ 
```

和CSS：

```
img {width:0;}
img.auto {width:auto;}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:31:25.987

您可以将该元素克隆到一个新的隐藏 DOM 节点（我假设您想在此处隐藏它）。然后删除 CSS，然后测量尺寸。

# java - Java中对应数组元素的乘法

> ID：11765311
> 
> 赞同：0
> 
> 时间：2012-08-01T18:27:43.530
> 
> 标签：java, arrays, arraylist, multiplication

是否有一个 Java 函数可以将两个数组作为参数并将第一个数组中的每个元素与第二个数组中的等价元素相乘？

如果有的话。与 a 相比，该功能如何更有效`for loop`？

`Array 1`

```
1, 2, 3, 4 
```

`Array 2`

```
4, 3, 2, 1 
```

结果：

```
4, 6, 6, 4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:29:11.783

我知道没有内置功能，但实现起来非常简单：

```
int[] arr = {1, 2, 3, 4};
int[] arr2 = {4, 3, 2, 1};
int[] result = new int[4];

for(int i=0 ; i<arr.length ; i++) {
    result[i] = arr[i]*arr2[i];
} 
```

如果你真的需要更好的性能，你可以使操作多线程（很容易），但除此之外，我看不到神奇的、巨大的性能提升。真的是很便宜的手术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:43:09.143

[JAMA](http://math.nist.gov/javanumerics/jama/)是一个第三方库，如果您决定不自己滚动，您可以将其用于矩阵运算。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-28T06:49:19.033

您还可以使用`EJML`库进行矩阵运算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:32:38.383

```
Iterator<Integer> it=ar1.iterator();
Iterator<Integer> it2=ar2.iterator();
while(it.hasNext()&&it2.hasNext())
{
    result.add(new Integer(it.next().intValue()*it2.next().intValue()));
} 
```

也可以有效地处理任何列表。

# python - Python：为什么我会收到 ValueError：要解压的值太多

> ID：11765312
> 
> 赞同：1
> 
> 时间：2012-08-01T18:27:47.367
> 
> 标签：python

我不确定为什么会收到此错误。我已经阅读并尝试了不同的东西，但它不起作用。

```
def product():

    y, x= raw_input('Please enter two numbers: ')
    times = float(x) * int(y)
    print 'product is', times
product() 
```

我究竟做错了什么？非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:28:22.603

`raw_input`返回单个字符串。要在你做的时候解压参数，它需要返回两件事。

你可以这样做：

```
y, x = raw_input('Please enter two numbers (separated by whitespace): ').split(None,1) 
```

请注意，这仍然有点脆弱，因为用户可以输入像“2 1 3”这样的字符串。解包将毫无例外地工作，但在尝试将“1 3”转换为整数时会阻塞。做这些事情的最强大的方法是通过一个`try/except`块。这就是我将如何做到的。

```
while True: #try to get 2 numbers forever.
   try:
      y, x = raw_input("2 numbers please (integer, float): ").split()
      y = int(y)
      x = float(x)
      break  #got 2 numbers, we can stop trying and do something useful with them.
   except ValueError:
      print "Oops, that wasn't an integer followed by a float.  Try again" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:33:11.987

@mgilson 的回答是正确的；除非有人输入三个数字，否则您将得到相同的`ValueError`例外。

所以，这个替代版本抓住了：

```
numbers = raw_input('Please enter only two numbers separated by a space: ').split()
if len(numbers) > 2:
   print 'Sorry, you must enter only two numbers!'
else:
   x,y = numbers 
```

# java - 连接到 Amazon EC2 的 Android 网络应用程序

> ID：11765314
> 
> 赞同：2
> 
> 时间：2012-08-01T18:27:53.550
> 
> 标签：java, android, sockets, amazon-ec2, serversocket

我是这种发展的新手。简而言之，我正在开发一个将字符串发送到云的 android 应用程序（我在亚马逊上有一台虚拟服务器机器），一切正常，将字符串从我的手机发送到服务器机器，我打印字符串我发送，它的工作原理！但是，当从服务器将响应返回到我的 android 应用程序（我在我的 android 手机上运行它）时，我什么也没有得到（响应应该是一个字符串 + 另一个串联的字符串），就是这样，简单吧？但不幸的是，我无法收到它。我测试了服务器端，它工作正常（亚马逊 EC2）。我不确定我是否可以做我正在做的事情：

创建传输代码以使用 SOCKET 将数据发送到来自 AsyncTask 类的 doInBackground() 方法的云上的字符串。在相同的方法 doInBackground 中，我执行代码以通过使用 ServerSocket 从云接收响应来接收响应。有可能还是我需要另一个线程或类似的东西？

这是我的代码：

```
`import android.os.Bundle;
 import android.app.Activity;
 import android.widget.TextView;

 import java.io.DataInputStream;
 import java.io.DataOutputStream;
 import java.net.*;
 import android.os.AsyncTask;
 import android.view.View;

 public class ReadWebpageAsyncTask extends Activity {
private TextView textView;

/** Called when the activity is first created. */

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        textView = (TextView) findViewById(R.id.TextView01);
    }

    private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... urls) 
        {
            String response = "";               

            //Transmission
            try 
               {
                  Socket socket = new Socket("MyAmazonServerIp", 5678);
                  DataOutputStream salida = new DataOutputStream  (socket.getOutputStream());
                  salida.writeUTF("Llego Perfectamente");
                  socket.close();
                  salida.close();
               }
                  catch (Exception e) 
                      {
                          e.printStackTrace();
                      }

           //Final ends

           // Reception
            boolean ak=true;
            try 
            {
               ServerSocket ServerSock = new ServerSocket(7896);
                while(ak)
                  {
                    Socket cl=ServerSock.accept();
                    InetAddress ipC = cl.getInetAddress();

                    DataInputStream en= new DataInputStream(cl.getInputStream());
                    response= en.readUTF();
                    //response= response.toString();
                    ak=false;
                 }  
           }
           catch(Exception exp)
             {
               exp.printStackTrace();
             }
           // Reception ends 

           return response;

        } //doInBackground ends

        @Override
        protected void onPostExecute(String result)
          {
            textView.setText(result);
          }
    }

    public void readWebpage(View view) {
        DownloadWebPageTask task = new DownloadWebPageTask();
        task.execute(new String[] { "????" });

    }
 }` 
```

我将非常感谢任何帮助，因为我已经为此工作了好几天，但我无法解决它。谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:36:12.970

你这样做的方式不能通过 3G 甚至可能是 WiFi 连接工作。它不能通过 3G 工作，因为您的亚马逊服务器看到的地址是您的手机提供商网络上的代理/防火墙的地址。没有任何外部应用程序可以直接打开您手机的套接字。相反，您需要通过电话创建的用于发送初始消息的同一套接字将响应发送回。

通过 WiFi，它不会工作，因为您的 WiFi 防火墙可能正在进行 NAT 转换。

这样做有很多原因，其中最重要的是数据使用和安全性。具体来说，考虑一下您的手机是否可以在整个互联网上公开寻址？它会不断受到试图破解它的打击。

所以基本上，只需保持原始套接字打开并监听该套接字上的响应，然后在您的云服务器上只需通过您收到请求的同一个套接字将响应发送回。

# php - Facebook 的“标题”选项未针对非时间线 Facebook 显示

> ID：11765318
> 
> 赞同：2
> 
> 时间：2012-08-01T18:28:17.413
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

所以我正在使用 Graph API 在 facebook 用户的墙上创建帖子

我指的是此处所述的“标题”：

[http://nocturnsoft.com/devblog/?p=906](http://nocturnsoft.com/devblog/?p=906)

当我指定“标题”选项时，标题中的文本对于使用时间线的配置文件将正确显示，但对于使用旧样式的配置文件，标题将不会出现...

我在这里做错了什么还是它应该是这样......如果它应该是这样，我将如何在 Facebook 帖子的链接下方显示非时间线配置文件

顺便说一句：我正在使用 Facebook PHP SDK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:02:55.993

在我的应用程序中，帖子数据数组看起来像这样，并且标题（消息）出现在新旧配置文件中。

```
 /* post to fb */
$post = array(
    'access_token' => $fb_access_token,
    'message' =>  'THIS IS YOUR CAPTION HERE',
    'link' => 'LINK TO YOUR SITE OR APP HERE',
    'picture' => 'URL TO IMAGE HERE',
    'name' => 'APP NAME HERE',
    'description' => 'AWESOME DESCRIPTION ABOUT YOUR APP GOES RIGHT HERE!'
);
$res = $facebook->api('/me/feed', 'POST', $post); 
```

希望这可以帮助。如果是这样，别忘了说出来！:)

# python - 让 Win32 MessageBox 出现在其他程序之上

> ID：11765324
> 
> 赞同：4
> 
> 时间：2012-08-01T18:28:42.857
> 
> 标签：python, windows, user-interface

我最近开始学习 Python 并编写了一个小脚本，当某个网站更改内容时会通知我。然后我将它作为计划任务添加到 Windows，以便它可以每 10 分钟运行一次。我想立即知道网站发生了变化，所以我添加了一个 win32ui 消息框，如果脚本检测到网站已更改，则会弹出该消息框。这是我用于 MessageBox 的小代码片段（我知道富有想象力的文本）：

```
win32ui.MessageBox("The website has changed.", "Website Change", 0) 
```

我的问题是，我大部分时间都在使用远程桌面，所以当 MessageBox 弹出时它位于远程桌面会话后面，有没有办法强制 MessageBox 出现在它上面？

在类似的注释中，当脚本运行时，命令行会在我不想要的远程桌面会话中非常短暂地打开，有没有办法阻止这种行为？

我对 Windows 特定的解决方案很满意，因为我知道这可能意味着与窗口管理器打交道，或者可能是另一种通知我的方式，而不是使用 MessageBox。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T18:35:16.827

当您从任务计划程序启动任何内容时，Windows 会阻止任何将您的窗口或对话框置于顶部的“*简单*”方式。

1.  第一种方式 - 使用`MB_SYSTEMMODAL`（4096 值）标志。以我的经验，它使 Msg 对话框“始终位于顶部”。

    ```
    win32ui.MessageBox("The website has changed.", "Website Change", MB_SYSTEMMODAL) 
    ```

2.  第二种方式 - 尝试通过以下调用将您的控制台/窗口/对话框放在前面。当然，如果你使用`MessageBox`你必须在调用`MessageBox`.

    ```
    SetForegroundWindow(Wnd);
    BringWindowToTop(Wnd);
    SetForegroundWindow(Wnd); 
    ```

至于控制台窗口闪烁，您可以尝试在隐藏状态下启动 Python。例如，使用[ConEmu](https://conemu.github.io/)、 'HidCon' 或[cmdow](http://www.commandline.co.uk/cmdow/index.html)。参考他们的参数，比如：

```
ConEmu -basic -MinTSA -cmd C:\Python27\python.exe C:\pythonScript.py
    or
CMDOW /RUN /MIN C:\Python27\python.exe C:\pythonScript.py 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:33:31.500

`pyw`通过使用扩展名而不是简单地命名脚本来避免命令窗口闪烁`py`。您也可以使用`pythonw.exe`代替`python.exe`，这实际上取决于您的要求。

见[http://onlamp.com/pub/a/python/excerpts/chpt20/index.html?page=2](http://onlamp.com/pub/a/python/excerpts/chpt20/index.html?page=2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T21:35:47.120

使用 ctypes 它显示一个 windows 错误消息框非常好用，

```
import ctypes
if condition:
    ctypes.windll.user32.MessageBoxW(0, u"Error", u"Error", 0) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-01T15:59:04.117

这对我有用：

```
from ctypes import *
def MessageBox(title, text, style):
    sty = int(style) + 4096
    return windll.user32.MessageBoxW(0, text, title, sty) #MB_SYSTEMMODAL==4096
    ## Button Styles:
    ###  0:OK  --  1:OK|Cancel -- 2:Abort|Retry|Ignore -- 3:Yes|No|Cancel -- 4:Yes|No -- 5:Retry|No -- 6:Cancel|Try Again|Continue
    ## To also change icon, add these values to previous number
    ### 16 Stop-sign  ### 32 Question-mark  ### 48 Exclamation-point  ### 64 Information-sign ('i' in a circle) 
```

## 用法：

```
MessageBox('Here is my Title', 'Message to be displayed', 64) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-01T18:34:45.067

使消息框系统模式化将导致它在每个应用程序上弹出，但在它被关闭之前无法与之交互。考虑创建一个可以放在前面的自定义对话框窗口，或者改用通知气泡。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-01T20:43:05.823

Windows 试图使在活动应用程序上弹出窗口变得困难。用户觉得这很烦人，特别是因为中断窗口通常会窃取键盘焦点。

Windows 发出这样的通知的方式是在通知区域中使用气球而不是消息框。通知气球不会窃取焦点，并且（据说）不会分散注意力。

我不确定 python Windows UI 库是否提供[通知气球](http://msdn.microsoft.com/en-us/library/windows/desktop/aa511497.aspx)的包装器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-12T18:19:04.217

借助 Python 和 MSG 命令（在 Win10 上工作）非常简单的模态异步消息框：

```
# In CMD (you may use Username logged on target machine instead of * to send message to particular user):
msg /server:IP_or_ComputerName * /v /time:appearance_in_secs Message_up_to_255_chars 
# I.e. send "Hello everybody!" to all users on 192.168.0.110 disappearing after 5 mins 
msg /server:192.168.0.110 * /v /time:300 "Hello everybody!" 
```

在 Python 中，我一直`subprocess`用来发送 CMD 命令，允许我读取和处理输出，查找错误等。

```
import subprocess as sp

name = 'Lucas'
message = f'Express yourself {name} in 255 characters ;)'
command = f'msg /server:192.168.0.110 * /v /time:360 "{message}"'
output = str(sp.run(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT))

if 'returncode=0' in output:
    pint('Message sent')
else:
    print('Error occurred. Details:\n')
    print(output[output.index('stdout=b'):]) 
```

# android - 如何使用接近传感器来调暗手机屏幕？

> ID：11765334
> 
> 赞同：0
> 
> 时间：2012-08-01T18:29:20.293
> 
> 标签：android, proximity

我知道我应该在这里有代码，但这是我没有代码的情况之一。

我想知道如何在不使用接近传感器中的物体的情况下让我的手机变暗......所以如果这没有意义，我正在尝试让接近传感器的角色切换，以便在屏幕进入时变暗光。

如果这个例子有更多帮助，我也可以尝试使用传感器自动使屏幕更亮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:33:48.937

接近传感器用于检测设备与某物的接近程度，而不是环境光。您想为此使用光传感器。但是，当屏幕靠近用户的脸时，您可以使用接近传感器调暗或关闭屏幕，就像大多数手机上的通话应用程序一样。

# c# - 如何将文件路径数组划分为几个较小的数组？

> ID：11765336
> 
> 赞同：1
> 
> 时间：2012-08-01T18:29:33.093
> 
> 标签：c#, .net, linq

我已经从 SO 阅读了几个关于此问题的不同问题，但仍然无法使其正常工作。我`public static string[] files = Directory.GetFiles(CurrentDirectory, "*.wav", SearchOption.AllDirectories);`用来获取文件路径数组，然后将其传递给文件流。文件流所做的操作花费的时间太长，只有一个线程处理所有文件。所以我决定拆分数组并将这些较小的数组传递给不同的线程。

我使用的代码是从另一个 SO 问题中获得的，并用它来传递拆分数组，但它只适用于第一个数组中的一个文件，但我知道问题出在哪里：

```
var thing = from index in Enumerable.Range(0, files.Length) 
          group files[index] by index/600;
foreach(var set in thing)
    string.Join(";", set.ToArray()); 
```

（这不完全是我使用它的方式，我已经把它弄乱了，我不记得了。）这个问题是所有东西都被视为一个巨大的文件路径，我有一个 foreach 循环可以获取每个来自较小数组的文件，但它将其中的每个文件都视为一个，当搜索​​返回多个文件时抛出 filepathtoolong 异常。我的函数需要一个数组，然后用于`foreach (string file in smallerArray)`写入每个数组。我需要做的是将文件数组分解为 4 个较小的数组并启动新线程，`new Thread(() => { DoWork(newArray); }).Start();`但我尝试过的没有任何效果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:33:41.647

> 所以我决定拆分数组并将这些较小的数组传递给不同的线程。

听起来你这样做很困难:)让框架为你处理它[`Parallel.ForEach`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel.foreach.aspx)：

```
Parallel.ForEach(files, file => 
{
    // Do stuff with one file
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:35:54.157

这是示例

```
 public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> source, int blockSize)
    {
        if (source == null)
            throw new ArgumentNullException("source");
        if (blockSize <= 0)
            throw new ArgumentException("blockSize = {0}".FormatWith(blockSize), "blockSize");
        var result = new List<IEnumerable<T>>();
        for (int blockStartIndex = 0; blockStartIndex < source.Count(); blockStartIndex += blockSize)
        {
            int blockStart = blockStartIndex;
            int blockEnd = blockStartIndex + blockSize - 1;
            IEnumerable<T> block = source.Where((x, i) => i >= blockStart && i <= blockEnd);
            result.Add(block);
        }
        return result;
    } 
```

这是测试

```
 [Test]
    public void TestSplit()
    {
        var list = new[] {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};
        IEnumerable<IEnumerable<int>> splitted = list.Split(10);
        Assert.That(splitted.Count(), Is.EqualTo(1));
        Assert.That(splitted.First().Count(), Is.EqualTo(10));

        splitted = list.Split(11);
        Assert.That(splitted.Count(), Is.EqualTo(1));
        Assert.That(splitted.First().Count(), Is.EqualTo(10));

        splitted = list.Split(9);
        Assert.That(splitted.Count(), Is.EqualTo(2));
        Assert.That(splitted.First().Count(), Is.EqualTo(9));
        Assert.That(splitted.ElementAt(1).Count(), Is.EqualTo(1));

        splitted = list.Split(3);
        Assert.That(splitted.Count(), Is.EqualTo(4));
        Assert.That(splitted.First().Count(), Is.EqualTo(3));
        Assert.That(splitted.ElementAt(1).Count(), Is.EqualTo(3));
        Assert.That(splitted.ElementAt(2).Count(), Is.EqualTo(3));
        Assert.That(splitted.ElementAt(3).Count(), Is.EqualTo(1));
    } 
```

# android - Android 崩溃 - 无法获取提供程序

> ID：11765337
> 
> 赞同：4
> 
> 时间：2012-08-01T18:29:36.883
> 
> 标签：android

对此我失去了理智。我不断遇到这种崩溃。之前在这里问过类似的问题，但我没有犯同样的错误。这是我的清单：

```
<uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="15" />

<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
<uses-permission android:name="android.permission.WAKE_LOCK"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".ReminderListActivity"
        android:label="@string/title_activity_reminder_list" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".ReminderEditActivity"
        android:label="@string/title_activity_reminder_edit" >
    </activity>
    <provider 
        android:name=".ReminderListProvider" 
        android:authorities="com.corsair.android.taskreminder.ReminderListProvider" >            
    </provider>
</application> 
```

如您所见，我拥有完全合格的权限。我在我的代码中为权限声明了一个常量（并在我创建我的 Uri 时使用它：

```
public static final String AUTHORITY = "com.corsair.android.taskreminder.ReminderListProvider";

// basic database info for creation
public static final String DATABASE_NAME = "reminders.db";
public static final String DATABASE_TABLE_NAME = "reminders";
public static final int DATABASE_VERSION = 1;

private ReminderListProviderMetaData() {
}

// inner class describing the Reminders Table
// by implementing BaseColumns, we automatically get the _ID column
// which is necessary for showing the DB contents in a ListView
public static final class RemindersTableMetaData implements BaseColumns {
    private RemindersTableMetaData() {
    }

    public static final String TABLE_NAME = "reminders";

    // uri and MIME type definitions
    // info for database access
    // the content URI is the authority prefixed with "content://"
    public static final String BASE_PATH = "reminders";
    public static final Uri CONTENT_URI = Uri.parse("content://"
            + AUTHORITY + "/" + BASE_PATH); 
```

这是我的日志：

```
 08-01 18:11:10.111: I/dalvikvm(1150): threadid=3: reacting to signal 3
    08-01 18:11:10.141: I/dalvikvm(1150): Wrote stack traces to '/data/anr/traces.txt'
    08-01 18:11:10.481: I/dalvikvm(1150): threadid=3: reacting to signal 3
    08-01 18:11:10.694: I/dalvikvm(1150): Wrote stack traces to '/data/anr/traces.txt'
    08-01 18:11:11.951: I/Process(1150): Sending signal. PID: 1150 SIG: 9
    08-01 18:12:50.231: I/dalvikvm(1196): threadid=3: reacting to signal 3
    08-01 18:12:50.661: I/dalvikvm(1196): Wrote stack traces to '/data/anr/traces.txt'
    08-01 18:12:50.671: I/dalvikvm(1196): threadid=3: reacting to signal 3
    08-01 18:12:50.801: I/ActivityThread(1196): Pub                                 com.corsair.android.taskreminder.ReminderListProvider: com.corsair.android.taskreminder.ReminderListProvider
    08-01 18:12:50.833: D/ReminderProvider(1196): main oncreate called
    08-01 18:12:50.851: I/dalvikvm(1196): Wrote stack traces to '/data/anr/traces.txt'
    08-01 18:12:50.871: D/ReminderProvider(1196): inner oncreate called
    08-01 18:12:50.893: D/AndroidRuntime(1196): Shutting down VM
    08-01 18:12:50.893: W/dalvikvm(1196): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
    08-01 18:12:50.911: E/AndroidRuntime(1196): FATAL EXCEPTION: main
    08-01 18:12:50.911: E/AndroidRuntime(1196): java.lang.RuntimeException: Unable to get provider com.corsair.android.taskreminder.ReminderListProvider: java.lang.NullPointerException
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread.installProvider(ActivityThread.java:4240)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread.installContentProviders(ActivityThread.java:3992)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3946)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread.access$1300(ActivityThread.java:123)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1185)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.os.Handler.dispatchMessage(Handler.java:99)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.os.Looper.loop(Looper.java:137)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread.main(ActivityThread.java:4424)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at java.lang.reflect.Method.invokeNative(Native Method)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at java.lang.reflect.Method.invoke(Method.java:511)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at dalvik.system.NativeStart.main(Native Method)
    08-01 18:12:50.911: E/AndroidRuntime(1196): Caused by: java.lang.NullPointerException
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at com.corsair.android.taskreminder.ReminderListProvider$DatabaseHelper.onCreate(ReminderListProvider.java:75)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at com.corsair.android.taskreminder.ReminderListProvider.onCreate(ReminderListProvider.java:102)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.content.ContentProvider.attachInfo(ContentProvider.java:944)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     at android.app.ActivityThread.installProvider(ActivityThread.java:4237)
    08-01 18:12:50.911: E/AndroidRuntime(1196):     ... 12 more
    08-01 18:12:51.241: I/dalvikvm(1196): threadid=3: reacting to signal 3
    08-01 18:12:51.291: I/dalvikvm(1196): Wrote stack traces to '/data/anr/traces.txt'
    08-01 18:12:51.541: I/dalvikvm(1196): threadid=3: reacting to signal 3
    08-01 18:12:51.601: I/dalvikvm(1196): Wrote stack traces to '/data/anr/traces.txt'
    08-01 18:12:58.262: I/Process(1196): Sending signal. PID: 1196 SIG: 9 
```

这是第 75 行（在 logcat 中引用）：

```
@Override
public void onCreate(SQLiteDatabase db) {
Log.d(TAG, "inner oncreate called");
db.execSQL(RemindersTableMetaData.DATABASE_CREATE_SCHEMA);
} 
```

这是 DATABASE_CREATE_SCHEMA：

```
public static final String DATABASE_CREATE_SCHEMA = "create table "
+ DATABASE_TABLE_NAME + " (" + RemindersTableMetaData._ID
+ " integer primary key autoincrement, " + REMINDER_TITLE
+ " text not null, " + REMINDER_BODY + " text not null, "
+ REMINDER_DATE_TIME + " text not null" + ");"; 
```

这是我的 ContentProvider 的 onCreate()：

```
// database helper member variable
private DatabaseHelper mOpenHelper;
private SQLiteDatabase db;
// component creation callback
@Override
public boolean onCreate() {
Log.d(TAG, "main oncreate called");
mOpenHelper = new DatabaseHelper(getContext());
mOpenHelper.onCreate(db);
return true;
} 
```

这是我的 DataBaseHelper 的构造函数：

```
// this class helps open, create, and upgrade the database
private static class DatabaseHelper extends SQLiteOpenHelper {
public DatabaseHelper(Context context) {
super(context, ReminderListProviderMetaData.DATABASE_NAME, null,
ReminderListProviderMetaData.DATABASE_VERSION);
} 
```

真的到此为止了。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:55:41.143

我想我在您的 ContentProvider 中看到了问题，我的评论详细说明了这些更改：

```
public boolean onCreate() {
    Log.d(TAG, "main oncreate called");
    mOpenHelper = new DatabaseHelper(getContext());

    /* Remove this line next line:
     *   1) db is null
     *   2) DatabaseHelper's constructor already silently calls this
     */
    //mOpenHelper.onCreate(db);

    return true;
} 
```

# ios - 从 ALAssetRepresentation 生成自定义缩略图

> ID：11765340
> 
> 赞同：13
> 
> 时间：2012-08-01T18:29:53.587
> 
> 标签：ios, thumbnails, cgimage, alassetslibrary, alasset

我的主要问题是我需要获取 ALAsset 对象的缩略图。

我尝试了很多解决方案并搜索了几天的堆栈溢出，但由于这些限制，我找到的所有解决方案都不适合我：

*   我不能使用默认缩略图，因为它太小了；
*   我不能使用 fullScreen 或 fullResolution 图像，因为屏幕上有很多图像；
*   我不能使用 UIImage 或 UIImageView 来调整大小，因为它们会加载 fullResolution 图像
*   我无法在内存中加载图像，我正在使用 20Mpx 图像；
*   我需要创建一个 200x200 像素版本的原始资源以加载到屏幕上；

这是我附带的代码的最后一次迭代：

```
#import <AssetsLibrary/ALAsset.h>
#import <ImageIO/ImageIO.h>   

// ...

ALAsset *asset;

// ...

ALAssetRepresentation *assetRepresentation = [asset defaultRepresentation];

NSDictionary *thumbnailOptions = [NSDictionary dictionaryWithObjectsAndKeys:
    (id)kCFBooleanTrue, kCGImageSourceCreateThumbnailWithTransform,
    (id)kCFBooleanTrue, kCGImageSourceCreateThumbnailFromImageAlways,
    (id)[NSNumber numberWithFloat:200], kCGImageSourceThumbnailMaxPixelSize,
    nil];

CGImageRef generatedThumbnail = [assetRepresentation CGImageWithOptions:thumbnailOptions];

UIImage *thumbnailImage = [UIImage imageWithCGImage:generatedThumbnail]; 
```

问题是，结果`CGImageRef`既不是按方向转换的，也不是指定的最大像素大小；

我还试图找到一种使用 调整大小的方法`CGImageSource`，但是：

*   资产 url 不能用于`CGImageSourceCreateWithURL:`;
*   我无法从 中提取`ALAsset`或`ALAssetRepresentation`与`CGDataProviderRef`一起使用`CGImageSourceCreateWithDataProvider:`；
*   `CGImageSourceCreateWithData:`需要我将 fullResolution 或全屏资产存储在内存中才能工作。

我错过了什么吗？

是否有另一种获取自定义缩略图的方法`ALAsset`或`ALAssetRepresentation`我缺少的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-18T21:00:53.987

您可以使用`CGImageSourceCreateThumbnailAtIndex`从可能很大的图像源创建小图像。您可以使用`ALAssetRepresentation`'`getBytes:fromOffset:length:error:`方法从磁盘加载图像，并使用它来创建 CGImageSourceRef。

然后，您只需将`kCGImageSourceThumbnailMaxPixelSize`和`kCGImageSourceCreateThumbnailFromImageAlways`选项传递给`CGImageSourceCreateThumbnailAtIndex`您创建的图像源，它将为您创建一个较小的版本，而无需将大版本加载到内存中。

我已经写了[一篇博客文章](http://mindsea.com/2012/12/18/downscaling-huge-alassets-without-fear-of-sigkill/)和[要点](https://gist.github.com/4331450#file-downscaling-alassets)，充分充实了这种技术。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-21T11:53:32.863

[Jesse Rusak](https://stackoverflow.com/users/3737/jesse-rusak)提到的[这种](http://mindsea.com/2012/12/18/downscaling-huge-alassets-without-fear-of-sigkill/)方法存在问题。如果资产太大，您的应用程序将因以下堆栈而崩溃：

```
0   CoreGraphics              0x2f602f1c x_malloc + 16
1   libsystem_malloc.dylib    0x39fadd63 malloc + 52
2   CoreGraphics              0x2f62413f CGDataProviderCopyData + 178
3   ImageIO                   0x302e27b7 CGImageReadCreateWithProvider + 156
4   ImageIO                   0x302e2699 CGImageSourceCreateWithDataProvider + 180
... 
```

> 链接寄存器分析：
> 
> 符号：malloc + 52
> 
> 描述：我们已经确定链接寄存器（lr）很可能包含帧#0的调用函数的返回地址，并将其作为帧#1插入到崩溃线程的回溯中以帮助分析。该确定是通过应用启发式方法来确定崩溃函数是否可能在崩溃时创建了新的堆栈帧。
> 
> 类型：1

模拟崩溃非常容易。让我们用小块从 getAssetBytesCallback 中的 ALAssetRepresentation 读取数据。块的特定大小并不重要。唯一重要的是调用回调大约 20 次。

```
static size_t getAssetBytesCallback(void *info, void *buffer, off_t position, size_t count) {
    static int i = 0; ++i;
    ALAssetRepresentation *rep = (__bridge id)info;
    NSError *error = nil;
    NSLog(@"%d: off:%lld len:%zu", i, position, count);
    const size_t countRead = [rep getBytes:(uint8_t *)buffer fromOffset:position length:128 error:&error];
    return countRead;
} 
```

这是日志的尾行

> 2014-03-21 11:21:14.250 MRCloudApp [3461:1303] 20: 关闭:2432 长度:2156064
> 
> MRCloudApp(3461,0x701000) malloc: *** mach_vm_map(size=217636864) 失败（错误代码=3）
> 
> *** 错误：无法分配区域
> 
> *** 在 malloc_error_break 中设置断点进行调试

我引入了一个计数器来防止这种崩溃。你可以在下面看到我的修复：

```
typedef struct {
    void *assetRepresentation;
    int decodingIterationCount;
} ThumbnailDecodingContext;
static const int kThumbnailDecodingContextMaxIterationCount = 16;

static size_t getAssetBytesCallback(void *info, void *buffer, off_t position, size_t count) {
    ThumbnailDecodingContext *decodingContext = (ThumbnailDecodingContext *)info;
    ALAssetRepresentation *assetRepresentation = (__bridge ALAssetRepresentation *)decodingContext->assetRepresentation;
    if (decodingContext->decodingIterationCount == kThumbnailDecodingContextMaxIterationCount) {
        NSLog(@"WARNING: Image %@ is too large for thumbnail extraction.", [assetRepresentation url]);
        return 0;
    }
    ++decodingContext->decodingIterationCount;
    NSError *error = nil;
    size_t countRead = [assetRepresentation getBytes:(uint8_t *)buffer fromOffset:position length:count error:&error];
    if (countRead == 0 || error != nil) {
        NSLog(@"ERROR: Failed to decode image %@: %@", [assetRepresentation url], error);
        return 0;
    }
    return countRead;
}

- (UIImage *)thumbnailForAsset:(ALAsset *)asset maxPixelSize:(CGFloat)size {
    NSParameterAssert(asset);
    NSParameterAssert(size > 0);
    ALAssetRepresentation *representation = [asset defaultRepresentation];
    if (!representation) {
        return nil;
    }
    CGDataProviderDirectCallbacks callbacks = {
        .version = 0,
        .getBytePointer = NULL,
        .releaseBytePointer = NULL,
        .getBytesAtPosition = getAssetBytesCallback,
        .releaseInfo = NULL
    };
    ThumbnailDecodingContext decodingContext = {
        .assetRepresentation = (__bridge void *)representation,
        .decodingIterationCount = 0
    };
    CGDataProviderRef provider = CGDataProviderCreateDirect((void *)&decodingContext, [representation size], &callbacks);
    NSParameterAssert(provider);
    if (!provider) {
        return nil;
    }
    CGImageSourceRef source = CGImageSourceCreateWithDataProvider(provider, NULL);
    NSParameterAssert(source);
    if (!source) {
        CGDataProviderRelease(provider);
        return nil;
    }
    CGImageRef imageRef = CGImageSourceCreateThumbnailAtIndex(source, 0, (__bridge CFDictionaryRef) @{(NSString *)kCGImageSourceCreateThumbnailFromImageAlways : @YES,
                                                                                                      (NSString *)kCGImageSourceThumbnailMaxPixelSize          : [NSNumber numberWithFloat:size],
                                                                                                      (NSString *)kCGImageSourceCreateThumbnailWithTransform   : @YES});
    UIImage *image = nil;
    if (imageRef) {
        image = [UIImage imageWithCGImage:imageRef];
        CGImageRelease(imageRef);
    }
    CFRelease(source);
    CGDataProviderRelease(provider);
    return image;
} 
```

# php - Magento 连接功能不起作用

> ID：11765343
> 
> 赞同：0
> 
> 时间：2012-08-01T18:30:10.030
> 
> 标签：php, magento, connect

我最近在两个不同的域上安装了 magento。我尝试使用 magento 连接管理器安装插件，但它在两个域上都显示如下错误：

**community/magento_classic_theme_free：无法连接到 208.86.253.231：权限被拒绝**

然后我尝试用magento配置我的moneybookers帐户，这也无法连接到moneybookers（显示连接错误）。这让我相信我的 magento 安装中没有任何连接功能。有人可以帮忙吗？

附加的屏幕截图显示了错误。

[magento 连接错误 http://www.magentocommerce.com/?ACT=25&fid=83&aid=31740_DgkkHDoDRpSfuMgt5t5q&board_id=1](http://www.magentocommerce.com/?ACT=25&fid=83&aid=31740_DgkkHDoDRpSfuMgt5t5q&board_id=1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:14:33.083

发现了问题。我的主机帐户阻止了传出连接，并且必须明确允许主机帐户的 cpanel 中显示的 IP 地址。

# php - 如何创建一个多页网站

> ID：11765344
> 
> 赞同：0
> 
> 时间：2012-08-01T18:30:10.060
> 
> 标签：php, e-commerce, multipage

如何开发多页网站？我应该以与创建主页相同的方式开发所有其他链接页面吗？我打算为商店开发一个 PHP 网站，我想将每个产品链接到它们各自的页面。但是由于有很多产品，为每个产品创建单独的页面有点乏味。

所以我可以创建一个动态变化的页面并将其用于所有产品链接，而不是为每个产品创建许多不同的页面？我的意思是我可以创建一个页面，其基本布局将始终保持不变，但只有少数内容会根据到所选产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:36:59.787

是的，你可以这么做; 创建一个动态变化的页面是很常见的。

例如，您可以创建一个处理站点标题部分的 php 文件，然后在您的`index.php`页面中简单地调用它，如下所示：

```
<? show_header(); ?> 
```

**看看这个网站开始吧！** [http://www.techiwarehouse.com/engine/d3bf2317/Building-Dynamic-Web-Pages-with-PHP](http://www.techiwarehouse.com/engine/d3bf2317/Building-Dynamic-Web-Pages-with-PHP)

我提供的网站非常适合开始使用 PHP，它提供了很好的信息和易于遵循的步骤。

**另一个很棒的资源是 IBM PHP PDF：** [http ://www.ibm.com/developerworks/linux/tutorials/l-php/l-php-pdf.pdf](http://www.ibm.com/developerworks/linux/tutorials/l-php/l-php-pdf.pdf)

**最后是我个人最喜欢的“实用 PHP 和 MySQL”PDF：** [http ://utopia.duth.gr/~stavtran/vivlia/PHP_and_MySQL.pdf](http://utopia.duth.gr/~stavtran/vivlia/PHP_and_MySQL.pdf)

* * *

还值得注意的是，有一些内容管理系统 (CMS)，例如 Joomla、Worpress，它们非常简单且功能强大，这些 CMS 中的许多都允许使用插件，这将使您的生活变得更加轻松。如果您的目标是简单地拥有一个可靠的工作电子商务网站来销售产品，并且您真的不希望进行核心 php、mysql、javascript、css、html、jquery 编码；-)

**内容管理系统**

1.  [http://wordpress.org/](http://wordpress.org/)
2.  [http://www.joomla.org/](http://www.joomla.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-19T09:52:43.327

您可以使用以下方法创建多页 PHP 网站：

1) 创建一个文件夹并将其命名为“my_first_php_website”。

2) 在“my_first_php_website”文件夹中创建以下文件夹。

“图片”、“包含”</p>

3) 在“includes”文件夹中创建以下文件夹。

“css”、“js”</p>

4) 在“my_first_php_website”文件夹中创建以下文件。

-> “index.php”、“header.php”、“footer.php”、“sidebar.php”、“nav.php”、“404.php”、“about.php”、“functions.php”< /p>

在“css”文件夹中创建以下文件。

-> “style.css”</p>

将您的网站徽标放在“图像”文件夹中。

-> “my_website_logo.png”</p>

5) 现在按照[分步教程](http://webdesignertricks.com/how-to-create-a-website-using-php/)使用 PHP 创建您的第一个网站。

资料来源：[网页设计师技巧](http://webdesignertricks.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:15:02.110

您可以实现单个页面，让我们调用它`product.php`。然后就可以使用该`GET`方法动态调用页面了。它看起来像这样， MySQL 表中产品的主键在`product.php?id=1`哪里。`id=1`你可以通过更改 url 中的 id 来获取各种产品。

# powershell - 在 PowerShell 中使用 ADSI 更改用户邮件属性

> ID：11765347
> 
> 赞同：1
> 
> 时间：2012-08-01T18:30:23.007
> 
> 标签：powershell, adsi, email-address

我正在尝试使用 PowerShell 更新目录用户的电子邮件地址。

我无法使用以下代码修改用户条目的邮件属性：

```
$BadUser = [adsi] $Account.Path

$BadUser.mail.Clear()
$BadUser.mail.Add($User.Email) | Out-Null

$BadUser.SetInfo() 
```

使用 PowerGUI 进行调试时，mail.Clear() 和 mail.Add() 似乎都修改了 $BadUser。

我有一个依赖 QAD 插件的工作版本，如果可能，我想避免使用它。

```
$suf = $AD.Parent.Substring(10)

Connect-QADService -Service "$($AD.dc[0]).$suf" -ErrorVariable AD_Conn_Error -ErrorAction Stop -WarningAction Stop | Out-Null

Set-QADObject $Account.Properties.distinguishedname[0] -ObjectAttributes @{mail=$User.Email} | Out-Null

Disconnect-QADService 
```

我避免使用 QAD 的原因：

*   我正在跨 8 个域服务器搜索用户
*   ADSI 允许我在列表中保存多个连接的条目
*   QAD 一次可以连接到 1 个域
*   ADSI 似乎相对较快
*   QAD 存在大量崩溃的内存泄漏（1kB/s 坏）
*   ~~QAD 无法“识别”一些 ADSI 被 cn 发现的用户~~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T22:13:21.583

这是一些示例代码：

```
$query= "(&(objectCategory=User)(cn=FirstName LastName))"
$OU = "LDAP://OU=Users,dc=subdomain,dc=company,dc=com"
$PageSize = 100
$objOU = New-Object System.DirectoryServices.DirectoryEntry($OU)
$objSearcher = New-Object System.DirectoryServices.DirectorySearcher
$objSearcher.SearchRoot = $objOU
$objSearcher.PageSize = $PageSize 
$objSearcher.Filter = $query
$objSearcher.SearchScope = "Subtree"
$colResults = $objSearcher.FindAll()
foreach($objResult in $colResults) {
    $dirObject = [ADSI]$objResult.GetDirectoryEntry()
    $dirObject.mail = "newaddress@company.com"
    $dirObject.CommitChanges()
} 
```

# java - 从命令行参数控制程序

> ID：11765348
> 
> 赞同：1
> 
> 时间：2012-08-01T18:30:32.390
> 
> 标签：java, command-line

如何选择程序中的方法以使用命令行参数运行？例如，如果我希望我的程序处理一个名为 Moon.jpg 的图像，我该如何让它工作，以便命令行中的 -S Moon.jpg 调用 Scale 方法？或者 -HI Moon.jpg 会水平翻转图像并反转它？我写了一些方法，当我正常运行程序时它们可以工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:31:52.910

[http://commons.apache.org/cli/](http://commons.apache.org/cli/)

这应该会有所帮助。以下是如何使用它： [http ://commons.apache.org/cli/usage.html](http://commons.apache.org/cli/usage.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-01T18:53:10.307

您可以使用如下函数解析参数：

```
private void parseArguments(String[] args)
  {
    int i = 0;
    String curArg;

    while (i < args.length && args[i].startsWith("-"))
    {
      curArg = args[i++];

      if ("-S".compareTo(curArg) == 0)
      {
        if (i < args.length)
        {
            String image = args[i++];
            processImage()
        }
        else
        {
          // ERROR
        }
      }
    } 
  } 
```

您的 main 方法应始终具有 String[] args，其中包含在空格字符上拆分的参数。还有很多库可以用来解析命令行参数。此方法与 Apaches CLI 库使用的方法非常相似（当然，该库附带的还有很多，但解析器使用此逻辑）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:33:18.353

您可能需要为每个目的编写不同的方法，并根据命令输入设置 if/else 条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:55:00.827

为什么不读取传递的参数并读取后续值来执行所需的操作，即，

> java yourprogram -a1 something -a2 somethingelse

在你的程序中

```
public static void main(String[] args){
 for(int i=0;i<args.length;i++){
  switch(args[i]){//you can use if-else to deal with string...
  case "-a1":read args[i+1] to get value to do somethng
  case "-a2": read args[i+1] to get value to do something else
 }
} 
```

# c - 使用 C 函数 fopen、fread 和 fwrite 与串行端口交互？

> ID：11765349
> 
> 赞同：1
> 
> 时间：2012-08-01T18:30:32.933
> 
> 标签：c, file-io, serial-port

我一直在尝试通过 RS232 串行端口（在我的情况下是 COM6）与我的设备通信。我的代码应该向设备写入一串 ascii 值，然后读取响应，但是我似乎无法得到任何响应。当我让它在我的计算机中写入和读取文件时，该程序似乎工作得相对较好，但当我指定 COM6 时则不然。这是我的代码的最新版本：

```
using namespace std;

const char ASCII[ ]= "0123456789ABCDEF";
char *Checksum (char *buffer)
{
static char Hex[10];
static int a1, a2;
register unsigned int i;
int sum;
printf("%s \n", buffer);
sum = 256;
for ( i=0 ; i<strlen(buffer) ; i++ )
{
sum-=buffer[i];
if ( sum<0 )
sum+= 256;
}
a1 = (sum & 0xF0) >> 4;
a2 = sum & 0x0F;
Hex[0] = ASCII[a1];
Hex[1] = ASCII[a2];
Hex[2] = 0;
printf("the checksum is %s \n",Hex);
return(Hex);
}

int main()
{
char data[80], input[80], *data2;
char *response;
DCB dcb;
bool retVal;
DWORD dwBytesTransferred;
DWORD byteswritten;
printf("the variable response is initially: %d\n", response);

dcb.BaudRate = CBR_19200; //19200 Baud
dcb.ByteSize = 8; //8 data bits
dcb.Parity = NOPARITY; //no parity
dcb.StopBits = ONESTOPBIT; //1 stop

//New open port area
HANDLE        hPort;
  if ((hPort = CreateFile ( "\\\\.\\COM6",
      GENERIC_READ | GENERIC_WRITE,
      0,              // exclusive access
      NULL,           // no security attrs
      OPEN_EXISTING,
      FILE_ATTRIBUTE_NORMAL,
      NULL)) != INVALID_HANDLE_VALUE)
  {
      printf("SUCCESS opening the port\n");// success
  } 
//GetCommState
DCB Dcb;
  GetCommState (hPort, &Dcb);
  Dcb.BaudRate        = CBR_19200;
  Dcb.StopBits        = ONESTOPBIT;
  Dcb.ByteSize        = 8;
  Dcb.Parity          = NOPARITY;
  Dcb.fParity         = 0;
  Dcb.fOutxCtsFlow    = 0;
  Dcb.fOutxDsrFlow    = 0;
  Dcb.fDsrSensitivity = 0;
  Dcb.fTXContinueOnXoff = TRUE;
  Dcb.fOutX           = 0;
  Dcb.fInX            = 0;
  Dcb.fNull           = 0;
  Dcb.fErrorChar      = 0;
  Dcb.fAbortOnError   = 0;
  Dcb.fRtsControl     = RTS_CONTROL_DISABLE;
  Dcb.fDtrControl     = DTR_CONTROL_DISABLE;

//Flushing

FlushFileBuffers( hPort );
  PurgeComm (hPort, PURGE_TXABORT | PURGE_RXABORT | PURGE_TXCLEAR | PURGE_RXCLEAR);
  COMSTAT     comStat;
  DWORD       dwErrorFlags;
  ClearCommError ( hPort, &dwErrorFlags, &comStat );

//NEW commtimeouts area
COMMTIMEOUTS CommTimeOuts;
 DWORD dwTimeout = 3000;  // <- set timeout in milliseconds
     if(!dwTimeout)
     {   // Don't use timeout -> Read the bytes already in input buffer and return immediately
         CommTimeOuts.ReadIntervalTimeout      = MAXDWORD;
         CommTimeOuts.ReadTotalTimeoutConstant = 0;
     } else
     {   // Use given timeout, wait until the requested number of bytes are read - or timeout
         CommTimeOuts.ReadIntervalTimeout         = 0;
         CommTimeOuts.ReadTotalTimeoutConstant    = dwTimeout;
     }
     CommTimeOuts.ReadTotalTimeoutMultiplier  = 0;
     CommTimeOuts.WriteTotalTimeoutMultiplier = 0;
     CommTimeOuts.WriteTotalTimeoutConstant   = 0;
     SetCommTimeouts (hPort, &CommTimeOuts);
printf("insert ASCII code string you wish to send:");
scanf("%s", input);
strcpy(data, "{0x02}");
strcat(data, input);
printf("%s \n", data);
data2=Checksum(data);
strcat(data, data2);
strcat(data, "{0x03}");
printf("the final sent message will be: %s \n",data);
retVal = WriteFile(hPort,data, strlen(data), &byteswritten, NULL);
printf("Number of bytes written: %d\n",  byteswritten);
printf("Write Success? %d\n", retVal);
retVal=ReadFile (hPort, &response, 20, &dwBytesTransferred, NULL);
printf("Read Success? %d\n", retVal);
printf("Port Response: %d\n", response);
free(response);
return 0;
} 
```

最新发现总结：使用 Habi 建议的 Free Serial Port Monitor 我现在可以确定 WriteFile 工作正常，并且 COM6 正在接收消息。我仍在寻找交叉电缆来仔细检查消息是否正在通过线路传输。我想，当我试图弄清楚是否有人可以查看这个新版本并告诉我是否有任何问题时，特别是与 ReadFile 函数有关的问题，我将不胜感激。困扰我的是，免费串行端口软件只显示从我的计算机传递的数据，而根本没有来自设备的响应。=\

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T19:05:23.907

代替

```
"COM6" 
```

尝试

```
"\\\\.\\COM6" 
```

我建议使用`CreateFile(), ReadFile(), WriteFile()`.

要打开 COM 端口，请尝试以下操作：

```
HANDLE        hComDev;

if ((hComDev = CreateFile ( "\\\\.\\COM6",
    GENERIC_READ | GENERIC_WRITE,
    0,              // exclusive access
    NULL,           // no security attrs
    OPEN_EXISTING,
    FILE_ATTRIBUTE_NORMAL,
    NULL)) != INVALID_HANDLE_VALUE)
{
      // success
} 
```

您的代码中似乎`GetCommState()`缺少调用。试试这个来配置 COM 端口：

```
DCB Dcb;

GetCommState (hComDev, &Dcb); 

Dcb.BaudRate        = CBR_19200;
Dcb.StopBits        = ONESTOPBIT;
Dcb.ByteSize        = 8;
Dcb.Parity          = NOPARITY;
Dcb.fParity         = 0;
Dcb.fOutxCtsFlow    = 0;
Dcb.fOutxDsrFlow    = 0;
Dcb.fDsrSensitivity = 0;
Dcb.fTXContinueOnXoff = TRUE;
Dcb.fOutX           = 0;
Dcb.fInX            = 0;
Dcb.fNull           = 0;
Dcb.fErrorChar      = 0;
Dcb.fAbortOnError   = 0;
Dcb.fRtsControl     = RTS_CONTROL_DISABLE;
Dcb.fDtrControl     = DTR_CONTROL_DISABLE; 
```

为了最初清除 COM 端口，我会在开始发送和接收字节之前进行这样的重置：

```
FlushFileBuffers( hComDev );

PurgeComm (hComDev, PURGE_TXABORT | PURGE_RXABORT | PURGE_TXCLEAR | PURGE_RXCLEAR);

COMSTAT     comStat;
DWORD       dwErrorFlags;
ClearCommError ( hComDev, &dwErrorFlags, &comStat ); 
```

你要求超时？要配置超时，请尝试以下操作：

```
COMMTIMEOUTS CommTimeOuts;
DWORD dwTimeout = ....  // <- set timeout in milliseconds

if(!dwTimeout)
{   // Don't use timeout -> Read the bytes already in input buffer and return immediately
    CommTimeOuts.ReadIntervalTimeout      = MAXDWORD;
    CommTimeOuts.ReadTotalTimeoutConstant = 0;
}
else
{   // Use given timeout, wait until the requested number of bytes are read - or timeout
    CommTimeOuts.ReadIntervalTimeout         = 0;
    CommTimeOuts.ReadTotalTimeoutConstant    = dwTimeout;
}
CommTimeOuts.ReadTotalTimeoutMultiplier  = 0;
CommTimeOuts.WriteTotalTimeoutMultiplier = 0;
CommTimeOuts.WriteTotalTimeoutConstant   = 0;

SetCommTimeouts (hComDev, &CommTimeOuts); 
```

> 我的代码应该向设备写入一串 ascii 值，然后读取响应，但是我似乎无法得到任何响应。

你确定字节真的被发送到设备吗？如果您有选择，请使用示波器并监控 PC 的 Tx 线路。发送一些字节并检查波特率和开始/停止位。如果您没有硬件来监视此信号，请使用基于软件的串行监视器，例如[Free Serial Port Monitor](http://www.serial-port-monitor.com/)。我没有使用这种软件工具的经验，但它们至少应该向您展示 Windows 驱动程序试图通过您选择的 COM 端口发送一些东西。

问候哈比

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:39:39.283

如果您已经尝试了一个月，那么我建议您查看 windows 函数[CreateFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)。我已经将它用于串行端口通信，它工作正常。您可能还想查看 DCB 结构`GetCommState`和`SetCommState`函数来配置串行端口。`WriteFile`可用于向串口写入数据。我无法发布我公司拥有的所有代码，但这应该可以帮助您入门。

当您等待读取时，查询串行端口缓冲区中是否有任何数据也`ClearCommError`可能对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-31T15:42:38.920

我遇到了类似的问题，发现其他答案很有帮助，但我没有收到字符。

最终我发现问题出在 RTS_CONTROL_DISABLE 或 DTR_CONTROL_DISABLE 上。

通过使 RTS 和 DTR 保持低电平，程序向调制解调器/设备指示程序尚未准备好接收数据，并且调制解调器尊重此信号并且尽职尽责地不发送。

通过将这些更改为 RTS_CONTROL_ENABLE 和 DTR_CONTROL_ENABLE，程序向调制解调器指示可以发送数据，并且我开始接收字符。并非所有设备都尊重这些信号，因此它可能在禁用 DTR 和 RTS 的某些配置中工作——调制解调器无论如何都可能发送数据。

# google-maps-api-3 - 标记聚类器两次调用地图的 zoom_changed 事件

> ID：11765350
> 
> 赞同：0
> 
> 时间：2012-08-01T18:30:34.193
> 
> 标签：google-maps-api-3

我正在使用这个第三方库，称为 Marker Clusterer 和 Google Maps API。[http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/docs/reference.html](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/docs/reference.html)

我试图在地图的缩放级别更改时触发一个事件。不过，我注意到的奇怪之处在于，当您单击标记簇时，它会调用两次缩放事件。有没有人遇到过这个奇怪的错误？为什么会触发两次缩放回调？当我在不使用集群的情况下正常缩放时，缩放回调只调用一次。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:06:42.847

看起来这种行为是[对 IOS 问题的修复](https://code.google.com/p/google-maps-utility-library-v3/issues/detail?id=170)。如果不需要，您可以下载自己的代码副本并删除对 fitBounds 的额外调用。

# mysql - 建议 SQL 查询从邻接列表模型中检索所有叶节点

> ID：11765352
> 
> 赞同：1
> 
> 时间：2012-08-01T18:30:36.387
> 
> 标签：mysql, sql, database

我在mysql中有一个像这样的表结构：

```
 ________________________
 |  id      | int(auto)   |     
 |------------------------|   
 |  name    | varchar     |
 |------------------------|
 |  link    | varchar     |
 |------------------------|
 | parent_id| int         |
 |________________________| 
```

基本上它是数据库驱动菜单的设计，根菜单有`parent_id`0，而子菜单的根菜单在`parent_id`字段上指定。它可以达到3-4级。

现在，我需要在根菜单下找到所有子菜单。我可以很容易地为一级菜单做到这一点，但我不能在后面遍历。我可以通过编写一个程序（通过合并结果集）来做到这一点，但如果我可以只使用 SQL 来做到这一点，那将更加容易和方便。

我无法更改表的任何结构或以其他方式修改系统。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:42:32.040

这会给你所有的父母和他们的孩子：

```
SELECT t1.name AS parentName, t1.Link AS parentLink
 t2.name AS childName, t2.link AS childLink
FROM table t1
 LEFT OUTER JOIN table t2 ON (t2.parent_id = t1.id) 
```

如果您不想要根级别：

```
SELECT t1.name AS parentName, t1.Link AS parentLink
 t2.name AS childName, t2.link AS childLink
FROM table t1
 INNER JOIN table t2 ON (t2.parent_id = t1.id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T05:39:59.247

我使用以下查询来获取根菜单的所有子菜单 ID（逗号分隔）（在此查询中为 2）。它最多可以支持3个级别。我知道查询没有优化并且有性能问题，但我仍然认为这是实现解决方案的唯一方法，而不使用过程（我不能使用）。

```
select group_concat(lev0) from 
(select concat_ws(',',lev2,group_concat(lev3)) as lev0 from 
(SELECT  t2.id as lev2, 
t3.id as lev3, 
t4.id as lev4
FROM menus AS t1
LEFT JOIN menus AS t2 ON t2.parent_id = t1.id
LEFT JOIN menus AS t3 ON t3.parent_id = t2.id
LEFT JOIN menus AS t4 ON t4.parent_id = t3.id
WHERE t1.id = '2') t0 group by lev2) t; 
```

# c# - 将我的 gpg 文件保存到不同的目录

> ID：11765356
> 
> 赞同：0
> 
> 时间：2012-08-01T18:30:53.457
> 
> 标签：c#, windows, gnupg

我正在研究 GPG 加密并希望将文件保存到特定目录...有人可以告诉我如何执行此操作.. 我正在使用此代码

```
 ProcessStartInfo startInfo = new ProcessStartInfo()
        {
            WorkingDirectory = @"C:\",
            CreateNoWindow = false,
            UseShellExecute = false,
            RedirectStandardError = true,
            RedirectStandardInput = true,
            RedirectStandardOutput = true

        };

        startInfo.FileName = "gpg.exe";
        startInfo.WindowStyle = ProcessWindowStyle.Hidden;
        startInfo.Arguments = "-e -r myname config.xml";
        using (Process exeProcess = Process.Start(startInfo))
        {

            exeProcess.WaitForExit();
        } 
```

当我这样做时，它会将其保存到 APPdata 文件夹中，有没有办法可以将其更改为某个默认文件夹？

我是否必须设置一些环境变量才能做到这一点？

请帮助我..如果我不清楚或者我错过了一些非常愚蠢的东西，请告诉我！

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:39:18.980

```
 ProcessStartInfo startInfo = new ProcessStartInfo()
        {
            WorkingDirectory = @"C:\",
            CreateNoWindow = false,
            UseShellExecute = false,
            RedirectStandardError = true,
            RedirectStandardInput = true,
            RedirectStandardOutput = true

        };

        startInfo.FileName = "gpg.exe";
        startInfo.WindowStyle = ProcessWindowStyle.Hidden;
        startInfo.Arguments = @"-e -r myname c:\MYPATH\config.xml -o c:\MYPATH\config.xml.gpg";
        using (Process exeProcess = Process.Start(startInfo))
        {

            exeProcess.WaitForExit();
        } 
```

# html - CSS：“显示”属性的无意义值会导致问题吗？

> ID：11765361
> 
> 赞同：7
> 
> 时间：2012-08-01T18:31:24.317
> 
> 标签：html, css, content-management-system

我正在使用一个 CMS，它允许带大括号的数据占位符，如下所示：

```
Name: {First_Name} <br> 
Email: {Email} <br> 
Phone: {Phone} <br> 
```

但是，它并没有给我任何方法来进行条件输出，例如如果电话字段为空白，我无法隐藏电话线。

CMS 不允许使用 javascript 或服务器端代码。我想出了这个技巧：

```
Name: {First_Name} <br> 
Email: {Email} <br>
<div style="display:none{Phone}">Phone: {Phone} <br></div> 
```

如果此人没有电话号码，则 div 以 display:none 结尾，但如果有，则 div 以无意义的 display 值结尾，并且整个 div 都显示出来。

它适用于 IE8、IE9、FF14、Chrome

有什么理由我不应该这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-01T18:36:14.410

不，那绝对没问题；在 CSS 中，浏览器不理解的值不会导致错误，它只是忽略该值并使用该属性的默认设置显示元素。

> [For] 非法值。用户代理必须忽略具有非法值的声明。例如：
> 
> ```
> img { float: left }       /* correct CSS 2.1 */
> img { float: left here }  /* "here" is not a value of 'float' */
> img { background: "red" } /* keywords cannot be quoted */
> img { border-width: 3 }   /* a unit must be specified for length values */ 
> ```
> 
> CSS 2.1 解析器将遵循第一条规则并忽略其余规则，就好像样式表是：
> 
> ```
> img { float: left }
> img { }
> img { }
> img { } 
> ```

引用：[http ://www.w3.org/TR/CSS21/syndata.html#parsing-errors](http://www.w3.org/TR/CSS21/syndata.html#parsing-errors)

# ajax - jQuery Ajax Get 不会将接收到的数据传递到 Internet Explorer 的成功函数中

> ID：11765363
> 
> 赞同：0
> 
> 时间：2012-08-01T18:31:26.920
> 
> 标签：ajax, internet-explorer, jquery, cross-browser

**我的问题是当我使用 jQuery ajax get 时，我在响应正文中获取数据，但是它没有传递给成功函数。我怎样才能让它工作？**

我正在制作一个ajax put，但它在ie9上不起作用（在其他浏览器上工作）所​​以我改变它只是为了测试：

```
 $.ajax({
        async : false,
        type: 'PUT',
        contentType: 'application/json',
        url:updateUrl + "?_" + new Date().getTime(),
        data: JSON.stringify(model),
        cache: false,
        dataType: "json",
        dataFilter: function(data) {
            var resp = eval('(' + data + ')');
            return resp;
        },
        success: function(data, status, xhr) {
            alert("success> " + data.property);
            alert(typeof data);
            r = resultResponse(data);
         },
        error: function(data, status, xhr) {
            alert("error> " + data.responseText);
            try {
                r = error($.parseJSON(data.responseText));
            } catch (err) {
                //Handle error
            }
        }
    }); 
```

数据警告未定义。我的放置数据发送正确，我的服务器端运行良好并向客户端发送响应但是我得到未定义而不是数据。经过一些测试，我意识到了问题：

当我在 ie 9 处捕获网络通信数据包时，响应正文就是我想要的。但是成功函数无法处理它。如果需要，我可以提供有关我的服务器的更多信息（当我将数据写入响应时，我可以使其工作，而不是在 Java 中使用 jackson json 映射器 - 它正在工作，唯一的区别是响应中不包含工作版本标头：键值内容类型 application/json;charset=UTF8 )

我认为这个问题可以在客户端处理，我认为不是服务器端。有任何想法吗？

**编辑：**我试过那种风格：

```
$.ajax({url: "/url",
  dataType: "text",
  success: function(text) {
    json = eval("(" + text + ")");
    // do something with JSON
  }
}); 
```

但是响应头仍然是：

键值 Content-Type application/json;charset=UTF8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T11:50:19.770

问题是错误的字符集。它是 UTF（而不是 UTF-8）。

# android - Android Twitter4j 401 身份验证错误

> ID：11765364
> 
> 赞同：0
> 
> 时间：2012-08-01T18:31:29.887
> 
> 标签：android, oauth, twitter-oauth, twitter4j

我正在使用[https://github.com/lorensiuswlt/AndroidTwitter](https://github.com/lorensiuswlt/AndroidTwitter)上的 AndroidTwitter 项目连接到 Twitter 并发送推文。我可以通过 Twitter 成功授权，它说我已登录，但是当我发布推文时，我收到此错误。安卓设备上系统时间正确，填写了我的oauth key和secret（登录时没问题）。

```
08-01 14:25:07.222: W/System.err(5527): 401:Authentication credentials (https://dev.twitter.com/docs/auth) were missing or incorrect. Ensure that you have set valid consumer key/secret, access token/secret, and the system clock is in sync.
08-01 14:25:07.222: W/System.err(5527): error - Could not authenticate with OAuth.
08-01 14:25:07.222: W/System.err(5527): request - /1/statuses/update.json
08-01 14:25:07.222: W/System.err(5527): Relevant discussions can be found on the Internet at:
08-01 14:25:07.222: W/System.err(5527):     http://www.google.co.jp/search?q=b2b52c28 or
08-01 14:25:07.222: W/System.err(5527):     http://www.google.co.jp/search?q=1a591522
08-01 14:25:07.222: W/System.err(5527): TwitterException{exceptionCode=[b2b52c28-1a591522],     statusCode=401, retryAfter=-1, rateLimitStatus=null, featureSpecificRateLimitStatus=null, version=3.0.0-SNAPSHOT(build: a5aafcad15add0fbc7a6583e337a1abbafa23435)}
08-01 14:25:07.229: W/System.err(5527):     at twitter4j.internal.http.HttpClientImpl.request(HttpClientImpl.java:176)
08-01 14:25:07.229: W/System.err(5527):     at twitter4j.internal.http.HttpClientWrapper.request(HttpClientWrapper.java:61)
08-01 14:25:07.229: W/System.err(5527):     at twitter4j.internal.http.HttpClientWrapper.post(HttpClientWrapper.java:98)
08-01 14:25:07.229: W/System.err(5527):     at twitter4j.TwitterImpl.post(TwitterImpl.java:1970)
08-01 14:25:07.237: W/System.err(5527):     at twitter4j.TwitterImpl.updateStatus(TwitterImpl.java:415)
08-01 14:25:07.237: W/System.err(5527):     at net.londatiga.android.TwitterApp.updateStatus(TwitterApp.java:106)
08-01 14:25:07.237: W/System.err(5527):     at net.londatiga.android.TestPost$5.run(TestPost.java:106) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:52:42.820

如果您刚刚设置，您的 Twitter 应用程序可能仍设置为只读。在 twitter 设置控制台中检查您的应用程序的应用程序类型。确保在更改后重新生成访问令牌。

# php - Magento I-Banner - 无法设置“启用”

> ID：11765365
> 
> 赞同：1
> 
> 时间：2012-08-01T18:31:31.763
> 
> 标签：php, magento, e-commerce

似乎没有任何可用于此插件的文档（magento 上的 I-Banner）。

我正在尝试向已经有横幅的页面添加新横幅，我只需将此横幅放在页面顶部（这是一个重要通知），因此我已登录 CMS 并转到 I-横幅 > 添加，添加了新横幅。它的状态设置为“禁用”，我无法将其更改为“启用”，它不会显示在页面上。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T18:49:21.210

好吧，这是一个肮脏的把戏。不是真正的解决方案。

如果您为 Firefox 安装 FireBug，您可以右键单击并“检查”下拉菜单。你会看到这个...

```
class=" select" disabled="disabled" 
```

只需点击代码并删除

```
disabled="disabled" 
```

然后，您应该能够更改下拉列表的值并保存。

# javascript - TableDnD onDrop 事件未触发

> ID：11765366
> 
> 赞同：14
> 
> 时间：2012-08-01T18:31:46.247
> 
> 标签：javascript, jquery, tablednd

我确信这是非常简单的事情，通常是这样。

```
$('#sort-table').tableDnD({
    onDragClass: "dnd_drag",
    onDragStart: function(table, row) {
        console.log("start drag");
    },
    onDrop: function(table, row) {
        console.log($.tableDnD.serialize());
    },
    dragHandle: ".dragHandle"
}); 
```

我为 jQuery 表格排序插件 tableDnD 提供了上述代码。这是他们提供的示例中的确切代码，但是当我将项目放入表中时，它不会正确触发 onDrop 事件。我在控制台中没有得到任何响应。表格确实初始化了，并且拖动手柄正常工作，所以我至少知道那部分代码是正确的。我唯一不能工作的是 onDrop 命令。

**更新：**
我更新了上面的代码，添加了一个 onDragStart 和 onDragClass，它们都可以正常工作，只是 onDrop 函数失败了。

这是我的一般表格布局：

```
<table id="sort-table">
    <tbody class="sort-items">
        <tr class="1">
            <td class="dragHandle"></td>
            ...
        </tr>
        ...
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-08T06:04:23.913

您必须定义 tr[id] 属性才能使 onDrop 工作。这是因为 onDrop 仅在行顺序更改时触发。但是，如果不指定 tr[id] 属性，tableDnD.serialize() 会认为没有任何重新排序。（肯定有漏洞）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-02T14:31:44.993

好吧，我的第一个问题，我得到了答案。希望这对将来的某人有所帮助。

问题在于我的表格行的实际 ID。我实际上使用了 uuid，这意味着我的行实际上有一个类似于“26b5122e-bbb8-11e1-9c53-d4856404b576”的 ID。显然，TableDnD 对破坏我的 ID 的数据进行了某种序列化，并且只抓取了最后一组数字，这对于大多数项目来说都是相同的。

导致问题的 jquery.tablednd.js 文件中的行是这样的（大约第 380 行）：

```
...
var rowId = rows[i].id;
if (rowId && table.tableDnDConfig && table.tableDnDConfig.serializeRegexp) {
    rowId = rowId.match(table.tableDnDConfig.serializeRegexp)[0];
}

result += tableId + '[]=' + rowId;
... 
```

我只是删除了序列化程序，因为我知道我的行 ID 不需要它。然后我自己传递了行 ID。这就是结果。

```
...
var rowId = rows[i].id;

result += tableId + '[]=' + rows[i].id;
... 
```

因此，如果您在行 ID 中使用破折号，请确保更改它以使 onDrop 正确触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-03T09:18:18.170

快速解决。

如果您希望 onDrop 在没有 row.id 的情况下工作，您可以编辑插件。

替换这个（第 255 行是函数开始的地方 - currentOrder）

```
 var rows = this.currentTable.rows;
        return $.map(rows, function (val) {
            return ($(val).data('level') + val.id).replace(/\s/g, '');
        }).join(''); 
```

有了这个

```
 return $(this.dragObject).index(); 
```

# cocoa - 可可在 NSArray 中获取磁盘

> ID：11765367
> 
> 赞同：0
> 
> 时间：2012-08-01T18:31:52.487
> 
> 标签：cocoa, iokit, diskarbitration

您好我正在使用 DiskArbitration.framework 来获取磁盘列表

```
+(NSArray*)arrayOfDisks {
    DASessionRef session = DASessionCreate(kCFAllocatorDefault);
    if (session) {
        DARegisterDiskAppearedCallback(session, NULL, driveGo, NULL);
        DASessionScheduleWithRunLoop(session,
                                     CFRunLoopGetCurrent(), kCFRunLoopDefaultMode);
        CFRelease(session);
    }
    return nil;
}

void driveGo(DADiskRef disk, void *context) {
    NSLog(@"%s", DADiskGetBSDName(disk));
} 
```

它记录得很好，但是我怎样才能返回数组呢？它只是循环，所以我什至不知道如何检查它是否完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:35:40.510

您可以更改方法并将数组存储在私有变量中：

```
(void*) driveGo(DADiskRef disk, void *context) {
NSLog(@"%s", DADiskGetBSDName(disk));
self->_myArray = DADiskGetBSDName(disk); 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T21:47:11.373

> 它只是循环，所以我什至不知道如何检查它是否完成。

没有“完成”。将为 DiskArb 当前已知的每个“磁盘”以及此后出现的每个“磁盘”调用您的*回调*。两者之间没有分离。

大多数应用程序应该使用它，而不是反对它。让 DiskArb 告诉您新“磁盘”出现、更改 (DescriptionChanged)、安装或卸载 (也是 DescriptionChanged) 或消失的时刻。随着这些变化的出现，让您的信息保持最新，并始终保持当前状态。

大多数应用程序不需要获取当前已安装卷集的完整且固定的快照。但是，如果出于某种原因，您这样做了，您可能会尝试使用该`getmntinfo`功能。

# javascript - 禁用页面调整 HTML

> ID：11765375
> 
> 赞同：1
> 
> 时间：2012-08-01T18:32:28.743
> 
> 标签：javascript, jquery, html, meta-tags

我试图弄清楚如何在用户可以使用键盘放大文本/图像的浏览器上禁用缩放功能。键盘上的“Command +”和“Command -”功能。如何禁用此功能？

我已经看到它通过年度报告.elevationchurch.org 完成

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:42:04.980

您可以尝试使用键盘事件来设置空值，或者在用户点击 - 或 + 时弹出说禁用缩放事件。

[http://api.jquery.com/category/events/keyboard-events/](http://api.jquery.com/category/events/keyboard-events/)

虽然这不是缩放的唯一方法。您也可以使用鼠标或在某些浏览器上单击查看>放大。

我强烈建议您不要这样做或尝试禁用缩放。

# javascript - 在表中克隆和追加行

> ID：11765376
> 
> 赞同：0
> 
> 时间：2012-08-01T18:32:31.930
> 
> 标签：javascript, jquery, html

如何使用 jquery 执行以下操作？

我有一个三行和一个标题行的表。像这样：当用户在“StudentId”字段中输入数据时，使用 jquery-Ajax 从数据库中填充“StudentFirstName”和“StudentLastName”。我想要实现的是，在第一行文本框中输入 studentId 后，我想克隆第一行并将其附加为第二行，然后清除第一行中的数据。

她是我的表结构：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<dynamic>" %>
<%@ Import Namespace="MyModel.Model" %>
<div>
<table id="MyTableHeaders">
        <tr>
            <th>
                StudentId
            </th>
            <th>
                StudentFirstName
            </th>
            <th>
                StudentLastName
            </th>            
        </tr>
    </table>
</div>

<div>
<table id="MyTableData">
        <tr>
            <td>
                <input name="StudentId"/>
            </td>
            <td>
                <input name="StudentFirstName"/>
            </td>
            <td>
                <input name="StudentLastName"/>
            </td>            
        </tr>    
</table>
</div> 
```

这是我的jQuery：

```
$('input[name="StudentId"]').focusout(function (e) {
    e.preventDefault();
    var link = '/Student/DisplayStudentDetails';
    $.ajax({
        type: 'POST',
        url: link,
        data: { id: $('input[name="StudentId"]').val() },
        dataType: 'json',
        success: function (result) {
            $('input[name="StudentFirstName"]').val(result.FirstName);
            $('input[name="StudentLastName"]').val(result.LastName);
            $("#MyTableData tr:first").clone().appendTo("#MyTableData");
            $("#MyTableData tr:first").find("input").attr("value", "").blur();
        },
        error: function (result) {
            alert("Failed")
        }
    });
}); 
```

我正在努力清除第一行中的数据并将数据保留在克隆行中。使用我的代码，它会清除所有行。

此外，我注意到克隆的行具有相同的字段名称，因此它将使用在第一行中输入的 studentId 更新所有克隆的“StudentFirstName”和“StudentLastName”字段。我应该如何处理这个？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:45:01.620

```
 success: function (result) {
        var clone = $("#MyTableData tr:first").clone();
        clone.find('input[name="StudentId"]').val(result.FirstName);
        clone.find('input[name="StudentFirstName"]').val(result.FirstName);
        clone.find('input[name="StudentLastName"]').val(result.LastName);
        $("#MyTableData ").append(clone);
    }, 
```

-编辑-

虽然，当我过去尝试过这样的任务时，我已经创建了模板行。已存在但具有 display:none 的行。这样，如果您的表没有值，您总是可以知道模板行存在。

-edit- 如果你想在开头添加新行，你可以使用 prepend 而不是 append。或者第二行是 $("#MyTableData tr").first().after(clone)

# java - 休眠查询多对象选择

> ID：11765380
> 
> 赞同：0
> 
> 时间：2012-08-01T18:32:39.987
> 
> 标签：java, hibernate

我有一个这样的实体模型：

```
public class Facture implements Serializable 
{
@Id @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="SEQ_FACTURE")
private long idFacture;
...

private Panier panier;
    ...
 }

 public class Panier
 {
@Id @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="SEQ_PANIER")
private long idPanier;  

@ManyToOne
private Client client;
@OneToMany
private List<LignePanier> articles = new ArrayList<LignePanier>();
...
 }

 public class Client
 {
@Id @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="SEQ_CLIENT")
private long idClient;
...
  } 
```

所以我想从客户端 X 查询所有的事实。我尝试这样的事情：

```
 public List<Facture> listeFacture(Long clientID) {
    List<ParameterMap> parameters = new ArrayList<ParameterMap>();
    parameters.add(new ParameterMap(StandardBasicTypes.LONG, clientID));
    return dao.query("select facture from Facture facture where facture.panier.client.idClient = ?", parameters);
} 
```

我得到这个例外：

```
 org.hibernate.QueryException: could not resolve property: client of: be.infoserv.web.model.Facture [select facture from be.infoserv.web.model.Facture facture where facture.panier.client.idClient = ?] 
```

我认为不可能像这样查询通过对象，但我不知道如何编写这个查询......

对不起我的英语，我是法国用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:56:44.600

您可能必须使用内部连接来执行此操作：

```
select facture
from Facture facture
     inner join facture.panier as panier
     inner join panier.client as client
where client.clientId = ? 
```

或者使用可以更安全的标准，因为你不能搞砸 hql：

```
Criteria factureCrit = session.createCriteria(Facture.class);
Criteria panierCrit = factureCrit.createCriteria("panier");
Criteria clientCrit = panierCrit.createCriteria("client");
clientCrit.add(Restrictions.idEq(clientId));

return factureCrit.list(); 
```

# hibernate - 在 BeanItemContainer 中加载集合时出现 LazyInitializationException

> ID：11765382
> 
> 赞同：0
> 
> 时间：2012-08-01T18:32:51.993
> 
> 标签：hibernate, vaadin

我正在为我的 jpa 实体构建一个 CRUD 视图。一旦我每次选择一个实例时都使用 jpa 容器检索我的实体实例，我必须加载延迟初始化的集合（我将它加载到 BeanItemContainer 中）。所以我做了以下事情：

```
 BeanItemContainer<ModelItem> beans =
                    new BeanItemContainer<ModelItem>(ModelItem.class);

            Property property = item.getItemProperty(propertyID);

            if (property.getType().equals(Collection.class)){
                beans.addAll((Collection<? extends ModelItem>) property.getValue());
            }

            Class<? super ModelItem> clazz = beans.getBeanType();

            PropertyDescriptor properties[]=PropertyUtils.getPropertyDescriptors(clazz);

            ArrayList<Object> tablePropertiesList=new ArrayList<Object>();

            for (PropertyDescriptor propertyDescriptor : properties) {
                if (!(propertyDescriptor.getPropertyType().equals(Collection.class)) && !(propertyDescriptor.getName().equals("class"))){
                    tablePropertiesList.add(propertyDescriptor.getName()); 
                }
            }

            Object tableProperties[]=transform(tablePropertiesList);

            Table currentTable = collections.get(propertyID);
            currentTable.setContainerDataSource(beans);
            currentTable.setVisibleColumns(tableProperties); 
```

在这种情况下，我得到 LazyInitializationException

```
Caused by: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.windy.server.model.core.UserModel.favoriteUsersTo, no session or session was closed 
```

如何使用 vaadin 框架解决这个问题？

PS 我使用 Hibernate 作为 JPA 实现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T03:47:20.567

这是由于 Hibernate 在访问时延迟获取关系（例如，在您的特定情况下访问“favoriteUsersTo”）并且没有可用于获取的 Hibernate 会话。

我建议您考虑改用[JPAContainer](https://vaadin.com/add-ons/jpacontainer/)。它将为您处理休眠会话。

# html - 将下拉菜单与 PayPal 订阅一起用于“A3”参数

> ID：11765386
> 
> 赞同：1
> 
> 时间：2012-08-01T18:33:02.077
> 
> 标签：html, paypal, e-commerce, subscriptions

我正在尝试执行以下操作，以便用户选择他们的定期订阅计划。

尝试提交此表单时，我在 PayPal 中不断收到以下错误：

*'无效的常规期间。您必须为订阅的 A3、P3 和 T3 参数指定有效值。*

我已经在表单中指定了 A3、P3 和 T3 参数，所以我不确定发生了什么。有人可以帮忙吗？提前致谢！

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick-subscriptions">
<table>
<tr><td>Frequency</td></tr><tr><td>
<select name="a3">
                <option value="438.00">Every 2 weeks: $438.00 USD - monthly</option>
                <option value="219.00">Every 4 weeks: $219.00 USD - monthly</option>
                <option value="146.00">Every 6 weeks: $146.00 USD - monthly</option>
                <option value="109.50">Every 8 weeks: $109.50 USD - monthly</option>
</select> </td></tr>
<tr><td>Coffee Selection</td></tr><tr><td>
<select name="item_name"> 
                <option value="Ethiopian Ground Subscription">Ethiopian Ground</option>
                <option value="Colombian Ground Subscription">Colombian Ground</option>
                <option value="Colombian Whole Bean Subscription">Colombian Whole Bean</option>
                <option value="Guatemalan Ground Subscription">Guatemalan Ground</option>
                <option value="Guatemalan Whole Bean Subscription">Guatemalan Whole Bean</option>
                <option value="Decaf Ground Subscription">Decaf Ground</option>
                <option value="Decaf Whole Bean Subscription">Decaf Whole Bean</option>
</select> </td></tr>
</table>
<input type="hidden" name="business" value="info@lifesongfororphans.org">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="t3" value="M"> <!-- billing cycle unit=month -->
<input type="hidden" name="p3" value="1"> <!-- billing cycle length -->
<input type="hidden" name="src" value="1"> <!-- recurring=yes -->
<input type="hidden" name="sra" value="1"> <!-- reattempt=yes -->
<input type="hidden" name="return" value="http://www.gobena.org">
<input type="hidden" name="cancel_return" value="http://www.gobena.org">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_subscribe_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:37:11.670

在你的代码中用大写字母写它们，看看它是否有效。

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick-subscriptions">
<table>
<tr><td>Frequency</td></tr><tr><td>
<select name="A3">
                <option value="438.00">Every 2 weeks: $438.00 USD - monthly</option>
                <option value="219.00">Every 4 weeks: $219.00 USD - monthly</option>
                <option value="146.00">Every 6 weeks: $146.00 USD - monthly</option>
                <option value="109.50">Every 8 weeks: $109.50 USD - monthly</option>
</select> </td></tr>
<tr><td>Coffee Selection</td></tr><tr><td>
<select name="item_name"> 
                <option value="Ethiopian Ground Subscription">Ethiopian Ground</option>
                <option value="Colombian Ground Subscription">Colombian Ground</option>
                <option value="Colombian Whole Bean Subscription">Colombian Whole Bean</option>
                <option value="Guatemalan Ground Subscription">Guatemalan Ground</option>
                <option value="Guatemalan Whole Bean Subscription">Guatemalan Whole Bean</option>
                <option value="Decaf Ground Subscription">Decaf Ground</option>
                <option value="Decaf Whole Bean Subscription">Decaf Whole Bean</option>
</select> </td></tr>
</table>
<input type="hidden" name="business" value="info@lifesongfororphans.org">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="T3" value="M"> <!-- billing cycle unit=month -->
<input type="hidden" name="P3" value="1"> <!-- billing cycle length -->
<input type="hidden" name="src" value="1"> <!-- recurring=yes -->
<input type="hidden" name="sra" value="1"> <!-- reattempt=yes -->
<input type="hidden" name="return" value="http://www.gobena.org">
<input type="hidden" name="cancel_return" value="http://www.gobena.org">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_subscribe_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:08:10.507

这段代码最终运行良好。我遇到了缓存问题，这就是我不断收到错误的原因。:)

# c++ - 简单的 char* 内存分配不起作用

> ID：11765389
> 
> 赞同：0
> 
> 时间：2012-08-01T18:33:20.697
> 
> 标签：c++, oop, memory-management, heap-memory

我有最简单的课文：

```
class Text
{
    char* txt;
public:
    Text(const char*);
    Text(const Text&);
    ~Text();

    const Text operator+(const Text&) const;
}; 
```

和实施：

```
#include "text.h"

Text::~Text()
{
    delete[] this->txt;
}

Text::Text(const char* argText)
{
    txt = new char[strlen(argText)+1];
    strcpy(txt, argText);
}

Text::Text(const Text& other)
{
    txt = new char[strlen(other.txt)+1];
    strcpy(txt, other.txt);
}

const Text Text::operator+(const Text& other) const
{
    char* ttxt, *newLine;
    ttxt = new char[strlen(txt)+strlen(other.txt)+2];
    strcat(ttxt, this->txt);
    newLine = new char[2];
    newLine[0] = '\n';
    newLine[1] = '\0';
    strcat(ttxt, newLine);
    strcat(ttxt, other.txt);
    Text temp(ttxt);
    delete[] newLine;
    return temp;
} 
```

主要：

```
#include "text.h"

int main()
{
    Text a("First text.");
    Text b("Second lol!!\n kthxbye!!!!!!!");
    Text c(a+b);
} 
```

并且程序中断了`newLine = new char[2];`我尝试增加它，例如 new char[5] 但它仍然中断。我收到的信息是：

> Windows 已在 prTextClass.exe 中触发断点。
> 
> 这可能是由于堆损坏，这表明 prTextClass.exe 或其已加载的任何 DLL 中存在错误...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:38:56.197

我认为 Text::operator+ 中的这条线即

```
strcat(ttxt, this->txt); 
```

是错的，应该是

```
strcpy(ttxt, this->txt); 
```

您当前正在添加到新随机内存的末尾，而不是像 strcpy 那样从 ttxt 开始。

但是在 C++ 中更好的解决方法是使用 std::string 而不是 char* 来保存字符串——它会为你分配内存，从而阻止你犯这些错误。

还如注释中所述 ttxt 泄漏未删除，您应该有一个 operator= 来处理 Text a = b;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T18:39:25.390

```
const Text Text::operator+(const Text& other) const
{
    char* ttxt, *newLine;
    ttxt = new char[strlen(txt)+strlen(other.txt)+2];
    strcat(ttxt, this->txt);
 // ^^^^^^^^^^^^^^^^^^^^^^^^ This line is buggy
    newLine = new char[2];
    newLine[0] = '\n';
    newLine[1] = '\0';
    strcat(ttxt, newLine);
    strcat(ttxt, other.txt);
    Text temp(ttxt);
    // .... 
```

注意`ttxt = new char[strlen(txt)+strlen(other.txt)+2];`不初始化数组内容。因此，当`strcat()`被调用时，它会`ttxt`找到第一个`'\0'`字符作为字符串的结尾`ttxt`，因此停在一个未知的位置。

你应该把它改成

```
strcpy(ttxt, this->txt); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:37:23.920

断线之前的 strcat 可能是罪魁祸首

您可能应该在分配 txtt 或确保 strcat 不会继续追加之后将其清空。IE。确保第一个字符是 0 字节。

# openerp - 使用自定义模块修改 OpenERP 的核心字段之一

> ID：11765390
> 
> 赞同：6
> 
> 时间：2012-08-01T18:33:29.853
> 
> 标签：openerp, odoo

有时，我们的 OpenERP 用户想要对核心 OpenERP 模块中的某个字段进行小改动。例如，他们希望产品屏幕的 Rack、Row 和 Case 字段长度超过 16 个字符。

我可以更改现有字段而不更改声明它的模块吗？我宁愿使用我们自己的自定义模块进行更改，而不是编辑`product`模块本身。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:33:29.853

我已经完成了这项工作，但我希望其他人知道更清洁的方法。

您可以在自定义模块中继承核心模块的类，然后只需声明一个与您要更改的名称相同的新字段。本质上，只需从核心模块复制字段声明，将其粘贴到您的自定义模块中，然后进行所需的更改。例如，我们的`product_notes`模块[将 Rack、Row 和 Case 字段从模块的 16 个扩大](http://bazaar.launchpad.net/~zaber/openobject-addons/zaber-custom/view/head:/product_notes/product_notes.py#L36)[到`product`255](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/6927/product/product.py#L328)个。

```
_columns = {'loc_rack': fields.char('Rack', size=255),
            'loc_row': fields.char('Row', size=255),
            'loc_case': fields.char('Case', size=255)} 
```

我不喜欢这样的原因是您现在对该字段的所有其他属性都有重复。如果您更改了字段长度，然后核心模块更改了帮助文本，您仍将拥有旧的帮助文本。我希望在加载模块时可以通过某种方式进入并调整父级的字段属性，但是我在正确的时间找不到任何挂钩。

您可以更轻松地进行的一项更改是字段的默认值。只需在自定义模块中为核心模块的字段声明一个默认值，它将替换原始默认值。例如，我们更改了模块中的默认[值](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/6927/product/product.py#L366)[和](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/6927/product/product.py#L366)默认[`sale_delay`值`produce_delay`](http://bazaar.launchpad.net/~zaber/openobject-addons/zaber-custom/view/head:/product_notes/product_notes.py#L40)。[`product`](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/6927/product/product.py#L366)

```
_defaults = {'sale_delay': lambda *a: 5,
             'produce_delay': lambda *a: 0} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-20T09:45:44.963

在 ODOO 中，我们可以使用 xml 更改字段的任何属性。

```
 <field name="loc_rack" position="attributes">
                <attribute name="string">Axis</attribute>
            </field> 
```

但是在某些情况下，例如扩展字段的大小失败了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-28T12:04:03.420

您需要继承产品形式。

干得好。

```
from openerp.osv import fields, osv
class product_product(osv.Model)  # <<<v7 

    _inherit = 'product.product'

    _columns = {
    'loc_rack': fields.char('Rack', size=<your size>),
    'loc_row': fields.char('Row', size=<your size>),
    'loc_case': fields.char('Case', size=<your size>)
    } 
```

简而言之，您只需要覆盖该字段并应用您将反映的属性更改。

# linux - ARM char 设备驱动程序初始化未创建 /dev/ 文件

> ID：11765395
> 
> 赞同：2
> 
> 时间：2012-08-01T18:33:44.020
> 
> 标签：linux, module, kernel, driver, device

我正在为 ARM 平台上的 GPIO 引脚编写驱动程序。我的驱动程序工作正常，直到现在我通过手动 mknod'ing 设备文件来避免这个问题。

我的初始化代码：

`static int __init gpio_init (void) {`

 ````
 void *ptr_error;
    if (register_chrdev(249, "gpio_device", &fops) < 0){
            printk(KERN_INFO "Registering device failed\n");
            return -EINVAL;
    }

    if ((device_class = class_create(THIS_MODULE, "gpio_device"))
                                                    == NULL){
            unregister_chrdev_region(DEV_T, 1);
            printk(KERN_INFO "Class creation failed\n");
            return -EINVAL;
    }
    ptr_error = device_create(device_class, NULL, DEV_T, NULL, "gpio_device");
    if (IS_ERR(ptr_error)){
            class_destroy(device_class);
            unregister_chrdev_region(DEV_T, 1);
            printk(KERN_INFO "Device creation failed\n");
            return -EINVAL;
    }

    cdev_init(&c_dev, &fops);

    if (cdev_add(&c_dev, DEV_T, 1)){
            device_destroy(device_class, DEV_T);
            class_destroy(device_class);
            unregister_chrdev_region(DEV_T, 1);
            printk(KERN_INFO "Cdev add failed\n");
            return -EINVAL;
    }
    printk(KERN_INFO "Guten tag, GPIO driver initialized\n");
    return SUCCESS; 
```` 

`}`

除了在 /dev 中没有创建文件“gpio_device”外，这运行没有错误。

我正在将 ARM 交叉编译到内核 2.6.39.4 上。（使用 arm-linux-gcc）

据我了解， device_create*应该*创建 /dev 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T06:49:06.750

我尝试运行您的代码并发现了一些错误：

*   当您注册时`register_chrdev()`，您应该取消注册`unregister_chrdev()`。`unregister_chrdev_region()`用于注销使用`alloc_chrdev_region()`或完成的注册`register_chrdev_region()`。

*   调用`register_chrdev()`为给定的主要注册次要编号 0-255，并为每个设置一个默认`cdev`结构，因此，您不需要处理`cdev_init()`& `cdev_add()`。

*   您应该使用`IS_ERR`& `PTR_ERR`for `class_create()`&检查错误，`device_create()`因为`PTR_ERR`将返回指针转换为带有强制转换的错误代码。

您可以在此处阅读更多内容：[字符设备注册](http://www.makelinux.net/ldd3/chp-3-sect-4)。

应用我提到的修改后，`/dev/gpio_device`创建时没有`mknod`：

```
int init_module(void)
{   
    void *ptr_error;
    struct cdev* c_dev;
    int result=0;

    /* register_chrdev */
    result=register_chrdev(my_major, "gpio_device", &fops);
    if (result < 0)
    {
    printk(KERN_INFO "Registering device failed\n");
    return result;
    }

    DEV_T = MKDEV(my_major, my_minor);

    /* class_create */
    device_class = class_create(THIS_MODULE, "gpio_device");
    if (IS_ERR(device_class))
    {
    unregister_chrdev(my_major, "gpio_device");
    printk(KERN_INFO "Class creation failed\n");
    return PTR_ERR(device_class);
    }

    /* device_create */
    ptr_error = device_create(device_class, NULL, DEV_T, NULL, "gpio_device");
    if (IS_ERR(ptr_error))
    {
    class_destroy(device_class);
    unregister_chrdev(my_major, "gpio_device");
    printk(KERN_INFO "Device creation failed\n");
    return PTR_ERR(ptr_error);
    }

    /* //removed
    cdev_init(&c_dev, &fops);
    if (cdev_add(&c_dev, DEV_T, 1)){
    device_destroy(device_class, DEV_T);
    class_destroy(device_class);
    unregister_chrdev_region(DEV_T, 1);
    printk(KERN_INFO "Cdev add failed\n");
    return -EINVAL;
    }*/

    printk(KERN_INFO "Guten tag, GPIO driver initialized\n");
    return SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:16:44.780

我刚刚弄清楚这里发生了什么。我们正在使用 BuildRoot 来创建我们的自定义 linux，结果我们已经编译出了 udev 设备文件管理系统。

所以这就是为什么这不起作用。

# objective-c - 为什么这种打印方法不起作用？

> ID：11765398
> 
> 赞同：0
> 
> 时间：2012-08-01T18:33:51.603
> 
> 标签：objective-c, printf, nslog

它在我使用时有效`NSLog`，但不是`printf`。我想使用`printf`，因为这样所有元素`setA`都将显示在一行中。

```
#import <Foundation/Foundation.h>

#define INTOBJ(v) [NSNumber numberWithInteger: v]

@interface NSSet (Printing) 
-(void) print;
@end

@implementation NSSet (Printing)
-(void) print {
    for (NSNumber *element in self) 
        printf("%li", (long) [element integerValue]);
}

@end

int main (int argc, char *argv[]) {
    @autoreleasepool {
        NSMutableSet *setA = [NSMutableSet setWithObjects:INTOBJ(3), INTOBJ(10), INTOBJ(1), INTOBJ(5), nil];

        [setA print];
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:40:54.360

NSLog 本质上是 printf 的不同版本，它允许使用 Objective C 的东西，而 printf 不能处理 Objective C 的材料。

如果您的 printf 方法不起作用，这可能是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:56:51.820

try`-longValue`而不是`-integerValue`它应该隐式地投射它们，但你永远不知道......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-01T19:18:31.003

首先从作为对象的 NSNumber 转换为 NSInteger，然后您可以使用 printf 语句输出到控制台，所有整数都应该出现在一行上。

> ```
> for(NSNumber *element in setA)
> {
>     NSInteger num = [element intValue];
>     printf("%li", (long)num);
> 
> } 
> ```

# python - 涉及转义字符的 Doctest

> ID：11765401
> 
> 赞同：8
> 
> 时间：2012-08-01T18:34:09.867
> 
> 标签：python, doctest

有一个函数 fix()，作为将字符串写入文本文件的输出函数的辅助函数。

```
def fix(line):
    """
    returns the corrected line, with all apostrophes prefixed by an escape character

    >>> fix('DOUG\'S')
    'DOUG\\\'S'

    """
    if '\'' in line:
        return line.replace('\'', '\\\'')
    return line 
```

打开文档测试，我收到以下错误：

```
Failed example:
    fix('DOUG'S')
Exception raised:
    Traceback (most recent call last):
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/doctest.py", line 1254, in __run
        compileflags, 1) in test.globs
      File "<doctest convert.fix[0]>", line 1
        fix('DOUG'S')
                  ^ 
```

无论我使用什么 \ 和 's 组合，doctest 似乎都不想工作，即使函数本身运行良好。怀疑这是 doctest 在块注释中的结果，但有解决此问题的任何提示。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T18:47:08.623

这是你想要的吗？：

```
def fix(line):
    r"""
    returns the corrected line, with all apostrophes prefixed by an escape character

    >>> fix("DOUG\'S")
    "DOUG\\'S"
    >>> fix("DOUG'S") == r"DOUG\'S"
    True
    >>> fix("DOUG'S")
    "DOUG\\'S"

    """
    return line.replace("'", r"\'")

import doctest
doctest.testmod() 
```

原始字符串是你的朋友......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:46:51.673

首先，如果您在交互式解释器中实际调用您的函数，会发生这种情况：

```
>>> fix("Doug's")
"Doug\\'s" 
```

请注意，您不需要在双引号字符串中转义单引号，并且 Python 在结果字符串的表示中不会这样做 - 只有反斜杠被转义。

这意味着正确的文档字符串应该是（未经测试！）

```
"""
returns the corrected line, with all apostrophes prefixed by an escape character

>>> fix("DOUG'S")
"DOUG\\\\'S"

""" 
```

我会为此文档字符串使用原始字符串文字以使其更具可读性：

```
r"""
returns the corrected line, with all apostrophes prefixed by an escape character

>>> fix("DOUG'S")
"DOUG\\'S"

""" 
```

# php - 如何根据表单输入值（即：邮政编码）显示不同的页面？jQuery 或 .PHP

> ID：11765410
> 
> 赞同：-1
> 
> 时间：2012-08-01T18:34:53.793
> 
> 标签：php, javascript, jquery, zipcode

是否有 jQuery、javascript 或 .php 脚本可以让我根据邮政编码列表显示不同的页面？例如，如果用户在“有效”邮编列表中输入邮政编码，则将显示 pageA.php，否则将显示 pageB.php。这些邮政编码值可以手动列出，也可以包含在 .csv 文件中，只要最简单。

输入后显示的页面将基于用户输入，例如：

```
<input name="zipcode" id="zipcode" type="text" /> 
```

理想情况下，有效的邮政编码将列为：

```
<script>
var zipcodelist = ['12345','12346','12347','12348']; 
```

* * *

**更新的解决方案** 这是我正在使用的代码：

```
<script type="text/javascript">
$(function(){
    var zipCodes = ['92056', '90210', '92121', '92101'];

    $('#zip_form').submit(function(){
        $('#id_div_one, #id_div_two').hide();
        var theZip = $('#id_zip_code').val();
        if(jQuery.inArray(theZip,zipCodes) > -1) {
            $('#id_div_one').fadeIn();
        } else {
            $('#id_div_two').fadeIn();
        }
        return false;
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:39:48.880

您可能只需获取邮政编码的发布值，然后在您的应用程序逻辑中重定向到您想要的页面。例如在 PHP 中：

```
$special_zip_codes = array(
    '10000',
    '10002',
    '10003' // and so forth
);

$zip = $_POST['zip_code'];
// need to add whatever validation/sanitation of zip code value here

if(in_array($zip, $special_zip_codes)) {
    header('Location: http://www.domain.com/fileA.php');
} else {
    header('Location: http://www.domain.com/fileB.php');
}
exit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:38:48.443

制作一个 php 文件，该文件将从 html 文件（具有 pincode）中获取数据，例如使用 post 或 get 然后从 excel 表或 DB 中检查 pincode 并执行所需的操作。

# asp.net-mvc - VB ASP.NET MVC 3 Razor CheckboxFor 错误“模板只能用于字段访问”

> ID：11765412
> 
> 赞同：0
> 
> 时间：2012-08-01T18:35:05.480
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, razor

以下代码产生错误“模板只能用于字段访问、属性访问、单维数组索引或单参数自定义索引器表达式。”

```
Line 66:             </div>
Line 67:             <div class="editor-field">
Line 68:                 @Html.CheckBoxFor(Function(m) m.IsCompanyOwner)
Line 69:                 @Html.ValidationMessageFor(Function(m) m.Company)
Line 70:             </div> 
```

它指向第 68 行。

我已经阅读了其他说设置类型的帖子，我已经在模型中完成了：

```
<DataType(DataType.Text)> _
Public Property IsCompanyOwner As String 
```

但是，它仍然给我错误。我能做些什么来解决？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:55:34.510

您试图将复选框绑定到字符串。它必须绑定到一个布尔值。请参阅[此处的文档](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.inputextensions.checkboxfor.aspx)

所以 IsCompanyOwner 应该是布尔值，而不是字符串。

# django - 所有表单都没有使用基于类的视图保存到我的数据库中

> ID：11765421
> 
> 赞同：0
> 
> 时间：2012-08-01T18:35:46.200
> 
> 标签：django, forms, django-views

我有一个未将订购的项目保存到数据库的订单。我只保存了联系表格。我已经搜索过，但在我的观点中找不到我做错了什么或遗漏了什么。任何帮助将不胜感激。谢谢！

意见：

```
class OrderFormView(CreateView):
    model = Contact
    form_class = ContactForm
    template_name = 'orderform.html'
    success_url = 'thank-you'

    def get_context_data(self, **kwargs):
        context = super(OrderFormView, self).get_context_data(**kwargs)
        formsets = dict(
            letterhead_formset=LetterHeadFormSet(prefix='letterhead'),
            windowenv_formset=WindowEnvFormSet(prefix='windowenv'),
            numbertenenv_formset=NumberTenEnvFormSet(prefix='numbertenenv'),
            ninebytwelveenv_formset=NineByTwelveEnvFormSet(prefix='ninebytwelveenv'),
            tenbythirteenenv_formset=TenByThirteenEnvFormSet(prefix='tenbythirteenenv'),
            businesscard_formset=BusinessCardFormSet(prefix='businesscard'),
        )
        context.update({
            'letterhead_form': LetterHeadForm,
            'windowenv_form': WindowEnvForm,
            'numbertenenv_form': NumberTenEnvForm,
            'ninebytwelveenv_form': NineByTwelveEnvForm,
            'tenbythirteenenv_form': TenByThirteenEnvForm,
            'businesscard_form': BusinessCardForm,
            'rushorder_form': RushOrderForm,
            'ordernote_form': OrderNoteForm,
            })
        context.update(formsets.items())
        return context

    def form_valid(self, form):
        if form.is_valid():
            data = form.cleaned_data
            email = OrderFormNotification(to=[settings.NO_REPLY_EMAIL_ADDRESS, ],
                extra_context=data)
            email.send()
            form.save()

        return super(OrderFormView, self).form_valid(form) 
```

表单类：

```
class ContactForm(forms.ModelForm):
    address = forms.ChoiceField(required = True, widget=RadioSelect(),     choices=ADDRESS_CHOICES,)
    class Meta:
         model = Contact

class LetterHeadForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = LetterHead
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class WindowEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = WindowEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class NumberTenEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = NumberTenEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class NineByTwelveEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = NineByTwelveEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class TenByThirteenEnvForm(forms.ModelForm):
    address = forms.ChoiceField(required = False, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = TenByThirteenEnv
        widgets = {
            'contact': forms.HiddenInput,
            'quantity': forms.Select(choices=QUANTITY_CHOICES),
        }

class BusinessCardForm(forms.ModelForm):
    print_choices = forms.ChoiceField(required = True, widget=RadioSelect(), choices=PRINT_CHOICES)
    card_styles = forms.ChoiceField(required = True, widget=RadioSelect(), choices=CARD_CHOICES)
    card_mailing_address = forms.ChoiceField(required = True, widget=RadioSelect(), choices=ADDRESS_CHOICES)
    class Meta:
        model = BusinessCard
        widgets = {
            'contact': forms.HiddenInput,
        }

class RushOrderForm(forms.ModelForm):
    class Meta:
        model = RushOrder
        widgets = {
            'contact': forms.HiddenInput,
            'rush_order': forms.CheckboxInput,
            'in_hand_date': forms.extras.SelectDateWidget
        }

class OrderNoteForm(forms.ModelForm):
    class Meta:
        model = OrderNote
        widgets = {
            'contact': forms.HiddenInput,
            'add_note': forms.CheckboxInput,
            'notes': forms.Textarea
        }

LetterHeadFormSet = modelformset_factory(LetterHead,
    form=LetterHeadForm, extra=2, max_num=2)
WindowEnvFormSet = modelformset_factory(WindowEnv,
    form=WindowEnvForm, extra=2, max_num=2)
NumberTenEnvFormSet = modelformset_factory(NumberTenEnv,
    form=NumberTenEnvForm, extra=2, max_num=2)
NineByTwelveEnvFormSet = modelformset_factory(NineByTwelveEnv,
    form=NineByTwelveEnvForm, extra=2, max_num=2)
TenByThirteenEnvFormSet = modelformset_factory(TenByThirteenEnv,
    form=TenByThirteenEnvForm, extra=2, max_num=2)
BusinessCardFormSet = modelformset_factory(BusinessCard,
    form=BusinessCardForm, extra=2, max_num=2) 
```

楷模：

```
PRINT_CHOICES = (
    ('exact reprint', 'Exact Reprint'),
    ('reprint with changes', 'Reprint With Changes'),
    ('new', 'New')
)

QUANTITY_CHOICES = (
    ('1000', '1000'),
    ('2500', '2500'),
    ('5000', '5000')
)

CARD_QUANTITY_CHOICES = (
    ('250', '250'),
    ('500', '500'),
    ('1000', '1000')
)

CARD_CHOICES = (
    ('chef/black', 'Chef/Black'),
    ('executive/red', 'Executive/Red')
)

ADDRESS_CHOICES = (
    ('eisenhower', 'Eisenhower'),
    ('wheeler', 'Wheeler'),
)

class Contact(models.Model):
    first_name = models.CharField(max_length=100, help_text="First Name")
    last_name = models.CharField(max_length=100, help_text="Last Name")
    email_address = models.EmailField(max_length=275)
    address = models.CharField(max_length=10, choices=ADDRESS_CHOICES)

    def __unicode__(self):
        return "%s %s" % (self.first_name, self.last_name)

class BaseStationary(models.Model):
    contact = models.ForeignKey(Contact, related_name='%(class)s_related')
    address = models.CharField(max_length=10, choices=ADDRESS_CHOICES)
    quantity = models.CharField(max_length=4, choices=QUANTITY_CHOICES)

    class Meta:
        abstract = True

class LetterHead(BaseStationary):
    pass

class WindowEnv(BaseStationary):
    pass

class NumberTenEnv(BaseStationary):
    pass

class NineByTwelveEnv(BaseStationary):
    pass

class TenByThirteenEnv(BaseStationary):
    pass

class BusinessCard(models.Model):
    contact = models.ForeignKey(Contact, related_name='businesscards')
    card_first_name = models.CharField(max_length=100)
    card_last_name = models.CharField(max_length=100)
    title = models.CharField(max_length=100)
    print_choices = models.CharField(max_length=19, choices=PRINT_CHOICES)
    card_styles = models.CharField(max_length=12, choices=CARD_CHOICES)
    card_email_address = models.EmailField(max_length=275)
    office_phone_number = PhoneNumberField(_('main office phone number'),
         blank=True, null=True)
    toll_free_number = PhoneNumberField(_('toll free number'),
    blank=True, null=True)
    mobile_number = PhoneNumberField(_('mobile phone number'),
        blank=True, null=True)
    fax_number = PhoneNumberField(_('main office fax'),
         blank=True, null=True)
    card_mailing_address = models.CharField(max_length=10,
        choices=ADDRESS_CHOICES)
    card_quantity = models.CharField(max_length=3,
    choices=CARD_QUANTITY_CHOICES)

class RushOrder(models.Model):
    contact = models.ForeignKey(Contact, related_name='rushorders')
    rush_order = models.BooleanField()
    in_hand_date = models.DateField(blank=True, null=True)

class OrderNote(models.Model):
    contact = models.ForeignKey(Contact, related_name='ordernotes')
    add_note = models.BooleanField()
    notes = models.TextField() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:21:17.483

`form_valid`并且您添加到其中的代码仅处理`form_class`. 您必须手动验证并保存每个表单集。

# python - python manage.py startapp 民意调查

> ID：11765426
> 
> 赞同：1
> 
> 时间：2012-08-01T18:36:09.070
> 
> 标签：python, django, pycharm

我正在关注 djangoproject.com 教程。我使用 pyCharm 设置了一个虚拟项目。在我的终端命令行上，我 cd 进入包含 manage.py 的文件夹，然后运行该行。python manage.py startapp 民意调查

我收到此错误：

```
Traceback (most recent call last):
  File "manage.py", line 8, in <module>
    from django.core.management import execute_from_command_line
ImportError: No module named django.core.management 
```

这是什么，为什么我不能创建另一个名为 polls 的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T17:39:14.653

就我而言，我已经安装了 Django，但是我从 virtualenv 输入“runserver”命令，它显示了与*Chapsterj相同的错误*

我解决了输入这个问题：

```
(venv)$ pip install Django 
```

之前，要进入 virtualenv，请输入：

```
$ virtualenv venv --distribute
$ source venv/bin/activate
(venv)$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T20:13:33.997

我从未听说过 PyCharm，但正如评论所暗示的，这意味着 python 解释器找不到 django。

尝试一件事 - 打开终端（任何地方）并输入：

```
python 
```

然后运行

```
import django 
```

如果您安装了 django，这应该可以；否则不会。

就我而言，我通过 virtualenv 运行我所有的 django 安装（基本上，python 包索引的本地化版本，因此不同的项目可以安装不同版本的包），所以从任何旧终端对我来说都行不通。

就我而言，我需要对`PYTHONPATH`环境变量进行调整。好吧，实际上，我有点撒谎，virtualenv 比这要复杂一些，但这是使它工作的另一种方法。

所以，我建议：

*   确保您在 python 站点包目录（大多数第三方包所在的位置）中安装了 django。通常，类似`yum install python-django`或`pip install Django`会为您执行此操作。
*   如果这不是您安装 Django 的位置，请先在 shell 会话中编辑您的 PYTHONPATH（以便于测试和正确），然后在您的 IDE 中编辑，以便 python 可以找到它。
*   如果 IDE 没有为您提供编辑 pythonpath 变量的方法，您应该能够通过如下编辑来管理它`manage.py`：

    ```
    import sys
    sys.path.append('/opt/Django')

    # the rest of manage.py ...
    import django 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-25T06:28:53.187

在 Rhel6 上，umask 阻止了 django 目录被访问，所以我不得不运行：

```
cd /usr/lib/python2.6/site-packages/django/
find django -type d | xargs chmod 775
find django -type f | xargs chmod 664 
```

并将 /usr/lib/python2.6/site-packages/django/ 添加到我在 .bash_profile 中的路径中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-21T21:30:19.443

要正确安装 django，您必须使用“超级用户”，尝试

```
sudo pip install django 
```

希望能帮助到你

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-03T15:25:53.667

我没有看到对此的接受回应，因为它不是一个 Django 问题，而是一个[PyCharm](https://www.jetbrains.com/pycharm/)问题，我将添加我的 2c，以防其他人开始遇到同样的问题。

我还在使用 PyCharm 完成“编写你的第一个 Django”教程，但我没有遇到这些问题。我遇到了各种各样的问题，直到我意识到你让 PyC​​harm 创造了一切，问题就消失了；-)

到目前为止，我正在同时阅读 PyCharm 和 Django tuts。PyCharm tut 在这里：[https ://www.jetbrains.com/pycharm/help/creating-django-application-in-a-project.html](https://www.jetbrains.com/pycharm/help/creating-django-application-in-a-project.html)

您的问题可能会这样回答：

```
To add a new django application to an existing project

On the main menu, choose Tools | Run manage.py task
In the Enter manage.py task name dialog box, type startapp. Note suggestion list that appears under the dialog box after entering the first letter, and shrinks as you type to show the exact match only.
In the dialog box that opens, type the name of the new Django application. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-23T21:59:02.083

我对 PyCharm 有同样的问题，我所做的是：转到文件 - > 默认设置 - > 项目解释器（选择 python 3 ...）如果那是你想要使用的它将显示所有可用的包双击 Django 安装包裹。

然后在终端而不是 *python manage.py migrate* 磁带 *python3 manage.py migrate*

# jquery - Slick Grid每次都没有加载

> ID：11765432
> 
> 赞同：0
> 
> 时间：2012-08-01T18:36:25.440
> 
> 标签：jquery, slickgrid, dataview

**固定的。问题在于列。我正在执行 ajax 调用以使列显示在网格上，然后是列选择器的所有可能列。我忘记了 jQuery 不像后面的代码那样工作，所以我有一个函数 LoadColumns(); 然后是 LoadAllColumns();。在 LoadAllColumns 中进行 ajax 调用后，我正在加载网格。有时 LoadColumns 会先运行，一切都会好起来的，有时则不会。在 LoadColumns 中成功调用 ajax 后，我移动了 LoadAllColumns 函数，现在一切正常。谢谢您的帮助！

我正在将 Slick Grid 实施到我的 Web 应用程序中，但遇到了问题。我在一个单独的应用程序中开发网格，一切正常。然后我将网格和所有代码移动到我的 Web 应用程序中，并且每次都不会加载网格。有时我会来到网格，一切都会正常加载，有时，我会去网格，它不会显示任何东西。我正在使用数据视图并通过 ajax 获取数据。我首先提取所有数据，然后实例化网格和数据视图。我一整天都在浏览我的代码，对可能导致这种情况的原因感到困惑。

1.  进行我的 ajax 调用（所有数据都按原样返回）
2.  下面是我如何加载网格

    ```
    function LoadGrid() {
      dataView = new Slick.Data.DataView({ inlineFilters: true });
      grid = new Slick.Grid("#grid", dataView, columns, options);
      grid.setSelectionModel(new Slick.RowSelectionModel());
      var pager = new Slick.Controls.Pager(dataView, grid, $("#pager"));
      var columnpicker = new Slick.Controls.ColumnPicker(allColumns, grid, options);

      //for sorting of the columns
      grid.onSort.subscribe(function (e, args) {
        sortdir = args.sortAsc ? 1 : -1;
        sortcol = args.sortCol.field;
        dataView.sort(comparer, args.sortAsc);
      });

      // if using the paging option, this is used to page through the rows
      dataView.onPagingInfoChanged.subscribe(function (e, pagingInfo) {
        var isLastPage = pagingInfo.pageNum == pagingInfo.totalPages - 1;
        var options = grid.getOptions();
        var enableAddRow = false;
        grid.setOptions({ enableAddRow: enableAddRow });

      });

      InitializeDataView();
      loadingIndicator.hide();
    }

    function InitializeDataView() {
      UpdateGrid();

      // if you don't want the items that are not visible (due to being filtered out
      // or being on a different page) to stay selected, pass 'false' to the second arg
      dataView.syncGridSelection(grid, true);

      // wire up model events to drive the grid
      dataView.onRowCountChanged.subscribe(function (e, args) {
        grid.updateRowCount();
        grid.render();
      });

      dataView.onRowsChanged.subscribe(function (e, args) {
        grid.invalidateRows(args.rows);
        grid.render();
      });

      //                if using the paging option, this is used to page through the rows
      dataView.onPagingInfoChanged.subscribe(function (e, pagingInfo) {
        var isLastPage = pagingInfo.pageNum == pagingInfo.totalPages - 1;
        var enableAddRow = isLastPage || pagingInfo.pageSize == 0;
        var options = grid.getOptions();

        if (options.enableAddRow != enableAddRow) {
            grid.setOptions({ enableAddRow: enableAddRow });
        }
      });
    }

    function UpdateGrid() {
      // initialize the model after all the events have been hooked up
      dataView.beginUpdate();
      dataView.setItems(data);
      dataView.setFilterArgs({
        searchString: searchString
      });
      dataView.setFilter(myFilter);
      dataView.endUpdate();
      loadingIndicator.hide();
    } 
    ```

网格回来了，只是没有加载数据。此外，正确的行数应该是 312。下面是网格实例化后的 html。

```
 <div class="slick-viewport" style="width: 100%; overflow: auto; outline: 0px; position: relative;
        height: 797px;">
        <div class="grid-canvas" style="width: 0px; height: 7800px;">
            <div class="ui-widget-content slick-row  odd" row="5" style="top: 125px">
            </div>
            <div class="ui-widget-content slick-row  even" row="6" style="top: 150px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="7" style="top: 175px">
            </div>
            <div class="ui-widget-content slick-row  even" row="8" style="top: 200px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="9" style="top: 225px">
            </div>
            <div class="ui-widget-content slick-row  even" row="10" style="top: 250px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="11" style="top: 275px">
            </div>
            <div class="ui-widget-content slick-row  even" row="12" style="top: 300px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="13" style="top: 325px">
            </div>
            <div class="ui-widget-content slick-row  even" row="14" style="top: 350px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="15" style="top: 375px">
            </div>
            <div class="ui-widget-content slick-row  even" row="16" style="top: 400px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="17" style="top: 425px">
            </div>
            <div class="ui-widget-content slick-row  even" row="18" style="top: 450px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="19" style="top: 475px">
            </div>
            <div class="ui-widget-content slick-row  even" row="20" style="top: 500px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="21" style="top: 525px">
            </div>
            <div class="ui-widget-content slick-row  even" row="22" style="top: 550px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="23" style="top: 575px">
            </div>
            <div class="ui-widget-content slick-row  even" row="24" style="top: 600px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="25" style="top: 625px">
            </div>
            <div class="ui-widget-content slick-row  even" row="26" style="top: 650px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="27" style="top: 675px">
            </div>
            <div class="ui-widget-content slick-row  even" row="28" style="top: 700px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="29" style="top: 725px">
            </div>
            <div class="ui-widget-content slick-row  even" row="30" style="top: 750px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="31" style="top: 775px">
            </div>
            <div class="ui-widget-content slick-row  even" row="32" style="top: 800px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="33" style="top: 825px">
            </div>
            <div class="ui-widget-content slick-row  even" row="34" style="top: 850px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="35" style="top: 875px">
            </div>
            <div class="ui-widget-content slick-row  even" row="36" style="top: 900px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="37" style="top: 925px">
            </div>
            <div class="ui-widget-content slick-row  even" row="38" style="top: 950px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="39" style="top: 975px">
            </div>
            <div class="ui-widget-content slick-row  even" row="40" style="top: 1000px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="41" style="top: 1025px">
            </div>
            <div class="ui-widget-content slick-row  even" row="42" style="top: 1050px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="43" style="top: 1075px">
            </div>
            <div class="ui-widget-content slick-row  even" row="44" style="top: 1100px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="45" style="top: 1125px">
            </div>
            <div class="ui-widget-content slick-row  even" row="46" style="top: 1150px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="47" style="top: 1175px">
            </div>
            <div class="ui-widget-content slick-row  even" row="48" style="top: 1200px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="49" style="top: 1225px">
            </div>
            <div class="ui-widget-content slick-row  even" row="50" style="top: 1250px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="51" style="top: 1275px">
            </div>
            <div class="ui-widget-content slick-row  even" row="52" style="top: 1300px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="53" style="top: 1325px">
            </div>
            <div class="ui-widget-content slick-row  even" row="54" style="top: 1350px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="55" style="top: 1375px">
            </div>
            <div class="ui-widget-content slick-row  even" row="56" style="top: 1400px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="57" style="top: 1425px">
            </div>
            <div class="ui-widget-content slick-row  even" row="58" style="top: 1450px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="59" style="top: 1475px">
            </div>
            <div class="ui-widget-content slick-row  even" row="60" style="top: 1500px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="61" style="top: 1525px">
            </div>
            <div class="ui-widget-content slick-row  even" row="62" style="top: 1550px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="63" style="top: 1575px">
            </div>
            <div class="ui-widget-content slick-row  even" row="64" style="top: 1600px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="65" style="top: 1625px">
            </div>
            <div class="ui-widget-content slick-row  even" row="66" style="top: 1650px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="67" style="top: 1675px">
            </div>
            <div class="ui-widget-content slick-row  even" row="68" style="top: 1700px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="69" style="top: 1725px">
            </div>
            <div class="ui-widget-content slick-row  even" row="70" style="top: 1750px">
            </div>
            <div class="ui-widget-content slick-row  odd" row="71" style="top: 1775px">
            </div>
            <div class="ui-widget-content slick-row  even" row="72" style="top: 1800px">
            </div>
        </div>
    </div> 
```

# c# - EventAggregator 和 ServiceLocator 问题

> ID：11765435
> 
> 赞同：2
> 
> 时间：2012-08-01T18:36:50.197
> 
> 标签：c#, wpf, prism, eventaggregator

我开始使用 Prism 和 MVVM 处理 WPF 项目，我正在尝试使用 eventAggregator 但是，当执行下面的行时会引发异常：

```
IServiceLocator ob = ServiceLocator.Current; // This line causes a Null pointer exception
EventAggregator = ob.GetInstance<IEventAggregator>(); 
```

但我无法理解我做错了什么，也许这是一件非常简单的事情，但我已经为此苦苦挣扎了几个小时。

希望有人可以帮助我，在此先感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:46:00.660

您缺少定位器的初始化代码。

您要么使用 Prism（是吗？），并且需要正确设置引导程序 - [http://msdn.microsoft.com/en-us/library/gg430868(PandP.40).aspx](http://msdn.microsoft.com/en-us/library/gg430868(PandP.40).aspx)

或者您不使用 Prism，而只是手动设置定位器（`Main`例如）：

```
IUnityContainer container = new UnityContainer();

// register the singleton of your event aggregator
container.RegisterType<IEventAggregator, EventAggregator>( new ContainerControlledLifetimeManager() ); 

ServiceLocator.SetLocatorProvider( () => container ); 
```

然后你可以在你的代码的任何地方调用

```
var eventAggregator = ServiceLocator.Current.GetInstance<IEventAggregator>(); 
```

编辑：您已经编辑了您的问题，现在您提到了 Prism。然后，您应该创建一个自定义引导程序，注册您的类型并运行引导程序。

```
public class CustomBootstrapper : UnityBootstrapper 
{
} 
```

并打电话

```
var bootstrapper = new CustomBootstrapper();
bootstrapper.Run(); 
```

在应用程序的启动例程中。据我所知，`UnityBootstrapper`将其注册`IEventAggregator`为单例，因此您不必重复。

# java - 如何在 JavaFX 的 TitledPane 中更改标题组件

> ID：11765436
> 
> 赞同：10
> 
> 时间：2012-08-01T18:36:55.970
> 
> 标签：java, accordion, javafx, javafx-2

我在互联网上的任何地方都找不到关于此的答案。

我有一个必须具有可折叠面板的应用程序，因此 Java FX 中的 TitledPane 和 Accordion 设置是自然的选择。

在应用程序中，我需要在容器折叠时为其自定义标题。我在 TitledPane 的 css 文档中看到，标题实际上是一个 HBox 和各种其他组件。

[http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#titledpane](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#titledpane)

我想访问此组件并将其替换为自定义组件。

我一直在使用 TitledPane api 的 setGraphic 函数和 setContentDisplay 到 GraphicOnly。使用自定义组件。但是，我无法让它正确渲染。我在移除箭头和移除箭头占用的空间时遇到了问题。

有关所需外观的屏幕截图及其实际外观，请参阅下面的链接。

[http://tinypic.com/r/s1pxfn/6](http://tinypic.com/r/s1pxfn/6)

如何删除箭头并删除填充？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-01T20:02:37.907

TitledPane 是带标签的，因此您可以在侦听器中在其上[设置图形](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Labeled.html#setGraphic%28javafx.scene.Node%29)或绑定到[扩展](http://docs.oracle.com/javafx/2/api/javafx/scene/control/TitledPane.html#expandedProperty)属性。

更改背景颜色等（包括覆盖 :focused 伪类的样式）可以通过 css 完成（例如，请参阅 jfxrt.jar 中[caspian.css](http://hg.openjdk.java.net/openjfx/2.2/master/rt/raw-file/tip/javafx-ui-controls/src/com/sun/javafx/scene/control/skin/caspian/caspian.css)样式表的 TitledPane 部分）。

如果您需要基于代码访问 TitledPane 的子组件，您可以在 TitledPane 添加到舞台上显示的场景后使用[查找功能。](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#lookup%28java.lang.String%29)

```
adminPane.lookup(".arrow").setVisible(false); 
```

我建议在尝试查找之前尝试基于图形/css 样式表的方法。

如果您不需要 Labeled 来显示文本，则将其设置为[仅显示图形](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ContentDisplay.html#GRAPHIC_ONLY)。

```
titledPane.setContentDisplay(ContentDisplay.GRAPHIC_ONLY); 
```

这是一些示例代码，它在没有自定义标题的 TitledPane 旁边显示带有自定义标题的 TitledPane。

```
import javafx.application.Application;
import javafx.beans.binding.Bindings;
import javafx.geometry.Pos;
import javafx.scene.*;
import javafx.scene.control.*;
import javafx.scene.image.*;
import javafx.scene.layout.*;
import javafx.scene.paint.Color;
import javafx.scene.shape.Circle;
import javafx.scene.shape.Rectangle;
import javafx.stage.Stage;

/** http://stackoverflow.com/questions/11765436/how-to-change-header-component-in-titledpane-in-javafx */
public class TitledPaneCustomization extends Application {
  public static void main(String[] args) { launch(args); }

  @Override public void start(Stage primaryStage) {
    TitledPane adminPane = new TitledPane("Administration", 
      VBoxBuilder.create().style("-fx-padding: 10").spacing(10).children(
        ButtonBuilder.create().text("Admin Client").maxWidth(Double.MAX_VALUE).build(),
        ButtonBuilder.create().text("Admin User").maxWidth(Double.MAX_VALUE).build()
      ).build()            
    );
    adminPane.setAnimated(false);
    adminPane.getStyleClass().add("admin");
    Node open   = HBoxBuilder.create().spacing(5).children(
      new Circle(4, 4, 8, Color.FORESTGREEN),
      new Rectangle(50, 16, Color.AQUAMARINE)
    ).build();
    Node closed = HBoxBuilder.create().spacing(5).children(
      new Circle(4, 4, 8, Color.GOLDENROD),
      new Rectangle(50, 16, Color.AQUAMARINE)
    ).build();

    adminPane.graphicProperty().bind(
      Bindings
        .when(adminPane.expandedProperty())
          .then(open)
          .otherwise(closed)
    );
    adminPane.setContentDisplay(ContentDisplay.GRAPHIC_ONLY);

    TitledPane viewPane = new TitledPane("View", 
      VBoxBuilder.create().style("-fx-padding: 10").spacing(10).children(
        ButtonBuilder.create().text("View Client").maxWidth(Double.MAX_VALUE).build(),
        ButtonBuilder.create().text("View User").maxWidth(Double.MAX_VALUE).build()
      ).build()            
    );
    viewPane.setAnimated(false);

    VBox errorPane = VBoxBuilder.create().style("-fx-padding: 10").spacing(10).children(
      new Label("500: Aug 8, 12:15pm"), 
      new Label("404: Aug 7, 3:27am")
    ).build();
    Label nErrors = new Label();
    nErrors.getStyleClass().add("nerrors");
    nErrors.textProperty().bind(Bindings.size(errorPane.getChildren()).asString());

    TitledPane connectivityPane = new TitledPane(
      "",      
      errorPane
    );
    Label connectivityErrorLabel = new Label("CONNECTIVITY ERROR");
    connectivityErrorLabel.getStyleClass().add("connectivityErrorLabel");
    connectivityPane.getStyleClass().add("connectivity");
    connectivityPane.setAnimated(false);
    connectivityPane.setGraphic(
      HBoxBuilder.create().spacing(2).alignment(Pos.CENTER).styleClass("header").children(
        nErrors,    
        new ImageView(
          new Image(
            "http://openiconlibrary.sourceforge.net/gallery2/open_icon_library-full/icons/png/48x48/actions/network-disconnect-2.png",
            0, 24, true, true
          )
        ),
        connectivityErrorLabel
      ).build()
    );

    HBox layout = new HBox(10);
    layout.setStyle("-fx-padding: 10; -fx-background-color: cornsilk;");
    layout.getChildren().addAll(adminPane, viewPane, connectivityPane);
    layout.setPrefHeight(150);
    layout.getStylesheets().add(this.getClass().getResource("titledpanecustomization.css").toExternalForm());
    primaryStage.setScene(new Scene(layout));
    primaryStage.show();

    Node arrow = adminPane.lookup(".arrow");
    arrow.setVisible(false);
    arrow.setManaged(false);

    // translate the titledpane arrow and header so that the arrow is displayed to right of the header.
    Pane connectivityArrow = (Pane) connectivityPane.lookup(".arrow");
    connectivityArrow.translateXProperty().bind(
      connectivityPane.widthProperty().subtract(connectivityArrow.widthProperty().multiply(2))
    );
    Pane connectivityTitle = (Pane) connectivityPane.lookup(".header");
    connectivityTitle.translateXProperty().bind(
      connectivityArrow.widthProperty().negate()
    );
  }
} 
```

还有一些与之配套的CSS：

```
/** titledpanecustomization.css place in same build directory as TitledPaneCustomization.java 
    and ensure build system copies it to the output classpath. */
.admin .titled-pane > .title {
  -fx-background-color: blue, yellow, linear-gradient(to bottom, derive(coral, +50%), coral);
}

.connectivity {
  -fx-text-fill: white;
}

.nerrors {
  -fx-background-color: derive(-fx-focus-color, -15%);
  -fx-padding: 5 8 5 8;
  -fx-text-fill: white;
}

.connectivityErrorLabel {
  -fx-text-fill: white;
  -fx-padding: 0 40 0 3; 
}

.connectivity .titled-pane > .title {
  -fx-background-color: -fx-box-border, -fx-inner-border, -fx-body-color;
  -fx-background-insets: 0, 1, 2;
  -fx-background-radius: 0 0 0 0, 0 0 0 0, 0 0 0 0;
  -fx-padding: 0.166667em 1.166667em 0.25em 0; /* 2 14 3 0 */
  -fx-color: -fx-focus-color;
}

.connectivity .titled-pane > .title > .arrow-button .arrow {
  -fx-background-color: white;
} 
```

![示例自定义 TitledPane](../Images/5d352373de76a4fdee30ff2722d898d0.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-14T06:11:42.043

[（移动问题的答案）]

这是答案：

要删除箭头，请添加以下 CSS 声明：

```
.titled-pane > .title > .arrow-button .arrow{
    -fx-shape: "";
} 
```

上面的 CSS 片段将删除箭头，但箭头的空间仍然被占用。这真的很棘手，我在互联网上的任何地方都找不到它的文档，但我应用了这个 CSS 语句，它消除了箭头上的间隙。

```
.titled-pane > .title{
   -fx-padding: 0 0 0 -4;
} 
```

这可能不是最好的解决方案，但它是满足我需求的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-16T11:23:04.247

在 2018 年底的今天，这些解决方案中没有一个适用于 JDK 1.8 的 JavaFX。所以我正在研究一个简单的解决方案。您可以将此方法复制到实用程序类中：

```
public static boolean hideArrow(TitledPane pane) {
    Node arrowButton = pane.lookup(".arrow-button");
    if (arrowButton == null) {
        return false;
    }
    // I don't know how with this the arrow space disappears...., but it does
    arrowButton.setStyle("-fx-background-color: black;");
    Parent titleRegion = arrowButton.getParent();
    titleRegion.addEventFilter(MouseEvent.ANY, MouseEvent::consume);
    titleRegion.setCursor(Cursor.DEFAULT);
    ((StackPane) titleRegion).getChildren().remove(arrowButton);
    return true;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-07-24T12:35:34.273

这是删除箭头的方法：

```
.titled-pane > .title > .arrow-button > .arrow{
    -fx-shape: null;
} 
```

# python - 找到确定的字符串并删除单元格

> ID：11765438
> 
> 赞同：1
> 
> 时间：2012-08-01T18:37:06.450
> 
> 标签：python, excel, xlrd

我创建了这个主题（[删除多行文件中的行](https://stackoverflow.com/questions/11746845/delete-lines-found-in-file-with-many-lines)），他们建议使用包“xlrd”。我使用并与文件进行了交互，但无法将单元格的内容与某些字符串进行比较。这是我的代码：

```
import xlrd
arquivo = xlrd.open_workbook('/media/IRREMOVIVEL/arquivo.xls',)
planilha = arquivo.sheet_by_index(0)

def lerPlanilha():
    for i in range(planilha.ncols):
        if (planilha.cell(8,9) == "2010"):
                print 'it works =>'
                break
    else:
            print 'not works'
                break    

lerPlanilha() 
```

但我得到了错误：**不工作**

对不起重复，也许，英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T21:42:58.097

xlrd.sheet.Sheet.cell 方法返回 xlrd.sheet.Cell 实例，该实例表示具有存储在其 value 属性中的值的单元格。所以像 sheet.cell(x,y).value 这样的东西应该可以工作。

关于删除 - 您不能使用 xlrd 修改文档，您应该使用 xlwt 来编写 excel，并使用 xlutils 来读取、修改和编写文档。谷歌搜索有点激烈会给你类似[http://www.python-excel.org/](http://www.python-excel.org/)

# c# - 在ie中的标签之间切换

> ID：11765440
> 
> 赞同：1
> 
> 时间：2012-08-01T18:37:13.390
> 
> 标签：c#, internet-explorer, add-in

我打算用 c# 或 Delphi（可能是插件）编写一个代码，它会自动（例如每 5 秒）在 IE（Internet Explorer）中的选项卡之间切换。请帮我。

# upload - Red5：在 S3 上保存流

> ID：11765448
> 
> 赞同：2
> 
> 时间：2012-08-01T18:37:45.793
> 
> 标签：upload, stream, amazon-s3, amazon-ec2, red5

我正在使用 Red5 将流上传到我的 EC2 实例。不过，最终我希望将上传的流保存在 S3 上。上传后我可以将文件从 EC2 传输到 S3，但理想情况下，我希望 Red5 一开始就将文件保存在 S3 上。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:26:15.863

您不能“录制”到 s3，您只能在录制过程完成后将录制内容上传到 s3。如果您有兴趣，我有使用 red5 播放位于 s3 上的文件的代码。

# ios - 如何给 barbuttonitem 动作？

> ID：11765449
> 
> 赞同：5
> 
> 时间：2012-08-01T18:37:48.600
> 
> 标签：ios

当在我的 UIToolBar 上单击完成按钮时，我想调出“TableViewController”的 .nib。但是下面的内容不允许单击以显示新视图。我该如何纠正这个问题？请告诉我哪里出了问题，应该更换什么以及为什么。

```
//Here's the selector in my overlay. 
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:
UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed)];

//Here's how I made my action. Btw, the uitoolbar has no nib, it's an overlay on the
//(camera mode).

-(void)doneButtonPressed {
TableViewController *tableView = [[TableViewController alloc]
initWithNibName:@"TableViewController" bundle:nil];
tableView.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
[self presentModalViewController:tableView animated:YES];
}

//Yet nothing happens when I click on my done button on my overlay. And I've made sure
//   i've imported .h frameworks correctly too. 
```

假设您要从 UItoolbar 叠加层上的 barbuttonitem 中调出一个 nib。你会怎么做？

有人告诉我，要使其正常运行，我必须添加 [barButtonItem addTarget:self action:@selector(doneButtonPressed) forControlEvents:UIControlEventTouchUpInside]; .

但是，如果我添加它，我会得到：

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:
UIBarButtonSystemItemDone addTarget:self action:@selector(doneButtonPressed)
forControlEvents:UIControlEventTouchUpInside]; 
```

这导致我在读取“实例方法”时出现错误 - initWithBarButtonSystemItem:target:action:forControlEvents:' not found (return type defaults to 'id')

除了我在这里编写的代码之外，请向我展示解决方案，而不是只向我展示正确的添加剂。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:41:30.183

如果你使用 XCode 4，你可以简单地 Ctrl+Drag`BarButtonItem`到你的 .h 文件，然后你可以从那里自动创建一个 IB Action。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:09:21.550

A`UIBarButtonItem`遵循默认值`UIControlEventTouchUpInside`，您无法设置它。Xcode 应该自动建议分配它的方法，但正确的代码是：

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed)]; 
```

注意，没有`forControlEvents:`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T19:58:51.077

尝试以下更改：

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem: UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed:)];

-(void)doneButtonPressed:(id)sender
{
} 
```

目标被传递给启动动作的对象（即 UIBarButtonItem 本身）

其次，在 doneButtonPressed 函数中设置断点。例如，如果 tableView 被设置为 nil，那么您将看不到任何事情发生。即，实例化此视图控制器可能存在问题。

# c# - Linq-to-Entities、参数和 DB2 9.5.3 的问题

> ID：11765451
> 
> 赞同：3
> 
> 时间：2012-08-01T18:38:00.970
> 
> 标签：c#, linq, entity-framework, linq-to-entities, db2

首先，关于环境的一些背景信息......

有两台机器：Windows“客户端”和Linux“服务器”。

1.  Windows 2008 R2 x64 • IIS 7.5 • NET 3.5 • SharePoint 2010 • Visual Studio 2010 • IBM DB2 .NET 数据提供程序运行时版本 v4.0.30319，驱动程序版本 9.7.4.4。
2.  RedHat Linux、IBM DB2 数据库版本 9.5.3*。

* IBM 网站上[推荐的解决方案是将](http://www-01.ibm.com/support/docview.wss?uid=swg1IC77827)**客户端**升级到 9.7 FP5。我已经尝试过了，甚至升级到了 10 版，但仍然遇到同样的错误。如果本文的作者指的是需要升级的服务器上运行的实际**数据库**版本，那么这会带来问题，因为目前这不是我的客户可以接受的解决方案。

我并不死心于使用 LINQ-to-Entities，并且会欢迎兼容的替代方案，前提是我不需要重写当前依赖它的大量现有代码。

现在，关于这个问题……</p>

下面是我试图执行的代码。注意查询中使用的 caseid 参数。

```
public List<JqueryAutocompleteEntity> Cases(string caseid)
{
    var query = (from c in context.ASSET_T
                             where c.CA_ID_AGCY.StartsWith(caseid.Trim().ToUpper())
                             select new JqueryAutocompleteEntity
                                        {
                                            id = c.CA_ID_AGCY.Trim(),
                                            label = c.CA_ID_AGCY.Trim(),
                                            value = c.CA_ID_AGCY.Trim()
                                        }).Distinct().Take(10);
    return query.ToList();
} 
```

当上面的代码在运行时执行时，会抛出以下异常：

> **执行命令定义时发生错误。有关详细信息，请参阅内部异常。IBM.Data.DB2.DB2Exception: ERROR [42815] [IBM][DB2/LINUXX8664] SQL0171N 例程“SYSIBM.STRIP”的位置“string-expr”中的参数的数据类型、长度或参数值不正确. 参数名称：“”。在 IBM.Data.DB2.DB2Command.ExecuteReaderObject（CommandBehavior 行为，String 方法，DB2CursorType reqCursorType，Boolean abortOnOptValueChg，Boolean skipDeleted，Boolean isResultSet，Int32 maxRows，Boolean skipInitialValidation）在 IBM.Data.DB2.DB2Command.ExecuteReaderObject（CommandBehavior 行为，String方法）在 IBM.Data.DB2.DB2Command.ExecuteDbDataReader（CommandBehavior 行为）在 System.Data 的 IBM.Data.DB2.DB2Command.ExecuteReader（CommandBehavior 行为）。**

这是 LINQ-to-Entities 生成的 SQL 语句，它被传递给 .NET DB2 驱动程序，以便在 DB2 数据库中的 Linux 服务器上执行。

> **SELECT CAST(1 AS int) AS C1, STRIP(Extent1.CA_ID_AGCY,BOTH) AS C2, STRIP(Extent1.CA_ID_AGCY,BOTH) AS C3, STRIP(Extent1.CA_ID_AGCY,BOTH) AS C4 从 ASSET_T 作为 Extent1 WHERE (LOCATE( UPPER(STRIP(@p_linq *_1* ,BOTH)), Extent1.CA_ID_AGCY)) = CAST(1 AS int)**

如您所见，似乎在生成最终 SQL 语句时使用了参数/变量的名称，而不是用实际值替换它。此外，将值硬编码到我的 LINQ 查询中实际上可以正常工作。

c.CA_ID_AGCY.StartsWith(“test”.Trim().ToUpper()) <= 这行得通！！！

我已经尝试在 LINQ 查询的第一部分使用 .AsEnumerable() 扩展名，因此我可以将所有数据加载到内存中，然后使用我的参数执行过滤器，但这种方法显然不起作用，因为结果集是 WAY太大（即数百万条记录）。它最终会杀死服务器的 CPU 并最大化 RAM。通过直接对数据库执行查询并使用 foreach 循环来填充 JQueryAutocompleteEntity 对象的集合，我显然可以使用简单的“经过验证的”DataReader/DataTable 方法来完成我所需要的，但我更喜欢使用更优雅的解决方案像 LINQ-to-Entities 一样，也避免浪费额外的执行时间来填充 foreach 循环中的列表。

我发现这一切令人不安的是，对参数化查询的支持似乎是一个如此明显的特性。我的意思是在用任何语言编码时，你多久使用一次常量而不是变量？

我认为 Scott Guthrie 关于他的自定义动态查询库的[博客文章](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)似乎为我的问题提供了一种解决方法，但并不完全存在。

任何解决此问题的帮助（无需升级 .NET Framework 或 DB2）将不胜感激。

谢谢！

# python - 近似比较大型numpy数组中的值的最快方法？

> ID：11765452
> 
> 赞同：2
> 
> 时间：2012-08-01T18:38:01.407
> 
> 标签：python, arrays, performance, numpy

我有两个数组，数组 A 有 ~1M 行，数组 B 有 ~400K 行。除其他外，每个都包含一个点的坐标。对于数组 A 中的每个点，我需要找出数组 B 中有多少点在它的一定距离内。我如何避免天真地比较一切？根据它一开始的速度，在我的机器上天真地运行需要 10 多天。这需要嵌套循环，但数组太大而无法构建[距离矩阵](https://stackoverflow.com/questions/3518574/why-does-looping-beat-indexing-here)（400G 条目！）

我认为方法是仅针对每个 A 坐标检查一组有限的 B 坐标。但是，我还没有确定一个简单的方法来做到这一点。也就是说，进行不需要检查 B 中所有值的选择的最简单/最快的方法是什么（这与我试图避免的任务完全相同）？

编辑：我应该提到这些不是二维（或nD）笛卡尔，而是球面（纬度/经度），距离是大圆距离。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:43:48.560

我现在无法给出完整的答案，但有一些提示可以帮助您入门。`B`在 kd-tree 中组织点会更有效率。您可以使用该类[`scipy.spatial.KDTree`](http://docs.scipy.org/doc/scipy-0.10.1/reference/generated/scipy.spatial.KDTree.html)轻松完成此操作，并且您可以使用`query()`该类上的方法来请求给定距离内的点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T17:14:54.820

这是使用 kd 树在球体上的点列表之间进行交叉匹配的一种可能实现。 [http://code.google.com/p/astrolibpy/source/browse/my_utils/match_lists.py](http://code.google.com/p/astrolibpy/source/browse/my_utils/match_lists.py)

另一种方法是使用 healpy 模块及其 get_neighbors 方法。

# c++ - 如何限制从某个类创建对象

> ID：11765454
> 
> 赞同：2
> 
> 时间：2012-08-01T18:38:18.280
> 
> 标签：c++, inheritance, private-constructor

我有一个“银行”类和一个“分行”类。“分支”继承自“银行”。我只想允许“银行”对象创建新的“分支”对象。（例如只有花旗集团可以开设新的花旗银行分行）。

实现这一目标的最佳设计模式是什么？

我目前正在使用带有私有构造函数的朋友类。但我不确定这是否是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:42:08.097

> “分支”继承自“银行”

有你的问题，你正在使用继承。您正在寻找一种抽象工厂模式，其中`Bank`是分支创建者，并且仅向其各自的创建者提供对分支构造函数的访问。

```
struct Branch  //abstract
{
    virtual ~Branch() = 0;
};
class CitiBranch : Branch
{
    friend class Citi; //only Citi can create instances of CityBranch
private:
    CitiBranch();
};

struct Bank
{
    virtual ~Bank() = 0;
    virtual Branch* createBranch() = 0;
}

struct Citi : Bank
{
    virtual Branch* creatBranch()
    {
        return new CityBranch;
    }
} 
```

这个程序是一个接口而不是一个具体的类。所以你有`Branch`指针和`Bank`指针，并不需要知道它们的确切类型。

如果你有一个`Bank*`and call `createBranch()`，你会得到一个`Branch*`back 但它会指向一个正确的具体对象。

# magento - Magento 1.6：addImageToMediaGallery 不添加到管理商店或媒体库

> ID：11765455
> 
> 赞同：2
> 
> 时间：2012-08-01T18:38:23.087
> 
> 标签：magento, magento-1.6

我正在使用以下代码将图像添加到 Magento 中的现有产品中。

```
Mage::app()->setCurrentStore($target_store);
$product = Mage::getModel("catalog/product")->loadByAttribute($sku);
$product->addImageToMediaGallery(
    $local_img_path,
    array('image', 'thumbnail', 'small_image'),
    false,
    false
);
$product->save(); 
```

一旦我对所有需要更新/添加的产品执行此操作，我就会重新索引所有并清除缓存。图像不会显示在产品的管理区域中。但是图像确实显示在前端产品详细信息页面上，但不在类别列表页面上的小图像上。

查看数据库，catalog_product_entity_varchar 中有以下 3 个与产品相关的条目：

```
value_id entity_type_id attribute_id store_id entity_id value
888509 4 79 4 35743 /t/e/tempimg_791.jpg
888332 4 80 4 35743 /t/e/tempimg_791.jpg
888333 4 81 4 35743 /t/e/tempimg_791.jpg

```

前端商店有基本、小和拇指图像。现在，如果我运行以下 SQL 查询以查找 catalog_product_entity_varchar 中具有 store_id 4 和 attribute_id 79 且没有 store_id 0 的相应条目的所有行，并创建相应的行：

```
插入到 catalog_product_entity_varchar
（entity_type_id、attribute_id、store_id、entity_id、值）
SELECT DISTINCT 4、79、0、entity_id、值
FROM catalog_product_entity_varchar AS cpev
其中attribute_id = 79
AND store_id != 0
AND entity_id
在 （
    选择实体 ID
    FROM catalog_product_entity_varchar
    其中 store_id = 4
    AND 属性 ID = 79
    AND entity_id 不是
    在 （
        选择实体 ID
        FROM catalog_product_entity_varchar
        哪里 store_id = 0
        AND 属性 ID = 79
    )
) 在重复密钥更新值 = cpev.value;

```

然后再次执行相同操作两次，将 79 替换为 80，然后再次替换为 81，我在 catalog_product_entity_varchar 中得到以下相关行：

```
value_id entity_type_id attribute_id store_id entity_id value
888509 4 79 4 35743 /t/e/tempimg_791.jpg
888332 4 80 4 35743 /t/e/tempimg_791.jpg
888333 4 81 4 35743 /t/e/tempimg_791.jpg
888605 4 79 0 35743 /t/e/tempimg_791.jpg
888606 4 80 0 35743 /t/e/tempimg_791.jpg
888607 4 81 0 35743 /t/e/tempimg_791.jpg

```

图像现在显示在类别列表的前端，但仍然不在产品的管理区域中。

现在，我执行以下查询，以在 catalog_product_entity_media_gallery 中添加一个条目，表示已在先前查询中设置的图像：

```
插入到 catalog_product_entity_media_gallery（attribute_id、entity_id、值）
SELECT 82, entity_id, value FROM catalog_product_entity_varchar AS cpev
其中attribute_id = 79 AND store_id = 0 AND
entity_id IN (
    选择实体 ID
    FROM catalog_product_entity_varchar
    其中 store_id = 4
      AND 属性 ID = 79
      AND entity_id 不在（
        选择实体 ID
        FROM catalog_product_entity_media_gallery
        其中attribute_id = 82
    )
) 在重复密钥更新值 = cpev.value;

```

一旦完成，重新索引/重新缓存就完成了。图片显示在管理员中。

必须有一种正确的方法，不会导致我需要手动执行 4 个 SQL 查询来让图像在导入后正常工作！我究竟做错了什么？

谢谢人们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:35:53.953

令人尴尬和愤怒 - 我通过删除 app/code/core/Mage 并将其替换为该文件夹的新下载副本来修复它。看起来一些核心文件已被编辑，并在此过程中被破坏。

故事的寓意——不要编辑核心。

# javascript - Noob javascript，为什么会触发onload？

> ID：11765459
> 
> 赞同：1
> 
> 时间：2012-08-01T18:38:32.417
> 
> 标签：javascript

所以我不明白为什么控制台会立即记录 1 onload 或者我`one.onclick = alterIt(1)`不应该等到我点击的时候`one`。无论如何，显然我不擅长 javascript，感谢您的帮助。

```
window.onload = initialize;
function initialize() {
    if (1 == 1){
        calculation();           
    }
}
function calculation() {
    var one = document.getElementById('one');
    one.onclick = alterIt(1);
}

function alterIt(x) {
    console.log(x);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-01T18:41:36.193

当你写道：

```
one.onclick = alterIt(1); 
```

...然后您调用该`alterIt`函数并将返回值设置为`onclick`处理程序。相反，您想要：

```
one.onclick = function(){ alterIt(1) };

// ...or better yet
one.addEventListener('click',function(){ alterIt(1) },false); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-01T18:42:31.357

当行`one.onclick = alterIt(1);`被执行时，`alterIt(1)`实际被评估。您想要的是将*函数*绑定到`one.onclick`，该函数仅在`onclick`事件触发时执行。你需要类似的东西

```
one.onclick = function() { alterIt(1) }; 
```

它不绑定`alterIt(1)`to的结果`one.onclick`，而是函数评估的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-01T19:05:32.460

您可以通过两种方式编写代码来解决此问题：

```
//Anonymous Closures
one.onclick = function(){ alterIt(1); };

//Bind Closures  
one.onclick = alertIt.bind(window, 1); 
```

注意：所有浏览器都支持 Function.bind() 一年。如果你关心旧的浏览器，匿名闭包是最好的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-01T18:42:34.807

像这样包装函数调用，使其在单击之前不会触发：

```
window.onload = initialize;
function initialize() {
    if (1 == 1){
        calculation();           
    }
}
function calculation() {
    var one = document.getElementById('one');
    one.onclick = function(){ alterIt(1);};
}

function alterIt(x) {
   console.log(x);
} 
```

小提琴示例：http: [//jsfiddle.net/RkH6Q/](http://jsfiddle.net/RkH6Q/)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-08-01T18:42:39.003

`alterIt`正在发生的事情是，当您应该将其传入时，您正在调用该函数。因此，像这样删除括号：

```
one.onclick = alterIt; 
```

# c# - 使用 RSA-SHA256 签名方法问题签署 Xml 文档

> ID：11765460
> 
> 赞同：7
> 
> 时间：2012-08-01T18:38:34.013
> 
> 标签：c#, signedxml

我正在使用以下方法对 Xml 文档进行签名：

```
public static XmlDocument SignDocument(XmlDocument doc)
    {
        string signatureCanonicalizationMethod = "http://www.w3.org/2001/10/xml-exc-c14n#";
        string signatureMethod = @"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256";
        string digestMethod = @"http://www.w3.org/2001/04/xmlenc#sha256";

        string signatureReferenceURI = "#_73e63a41-156d-4fda-a26c-8d79dcade713";

        CryptoConfig.AddAlgorithm(typeof(RSAPKCS1SHA256SignatureDescription), signatureMethod);

        var signingCertificate = GetCertificate();

        SignedXml signer = new SignedXml(doc);
        signer.SigningKey = signingCertificate.PrivateKey;
        signer.KeyInfo = new KeyInfo();
        signer.KeyInfo.AddClause(new KeyInfoX509Data(signingCertificate));

        signer.SignedInfo.CanonicalizationMethod = signatureCanonicalizationMethod;
        signer.SignedInfo.SignatureMethod = signatureMethod;

        XmlDsigEnvelopedSignatureTransform envelopeTransform = new XmlDsigEnvelopedSignatureTransform();
        XmlDsigExcC14NTransform cn14Transform = new XmlDsigExcC14NTransform();

        Reference signatureReference = new Reference();
        signatureReference.Uri = signatureReferenceURI;
        signatureReference.AddTransform(envelopeTransform);
        signatureReference.AddTransform(cn14Transform);
        signatureReference.DigestMethod = digestMethod;

        signer.AddReference(signatureReference);

        signer.ComputeSignature();
        XmlElement signatureElement = signer.GetXml();

        doc.DocumentElement.AppendChild(signer.GetXml());

        return doc;
    }

        private static X509Certificate2 GetCertificate()
    {

        X509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine);
        store.Open(OpenFlags.ReadOnly);
        X509Certificate2 card = null;
        foreach (X509Certificate2 cert in store.Certificates)
        {
            if (!cert.HasPrivateKey) continue;

            if (cert.Thumbprint.Equals("a_certain_thumb_print", StringComparison.OrdinalIgnoreCase))
            {
                card = cert;
                break;
            }
        }
        store.Close();

        return card;
    } 
```

尝试使用错误消息**Invalid algorithm specified**计算签名时引发 System.Security.Cryptography.CryptographicException 类型的异常。有任何想法吗？

机器：Windows Server 2008 R2

.Net 框架：4.0。

IDE：Visual Studio 2010。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-16T03:40:19.960

非常感谢这个博客。它实际上解决了我的问题。顺便说一句，如果证书是从文件加载的，它应该是可导出的： X509Certificate2 x509Key = new X509Certificate2("xxxxx.pfx", "123", **X509KeyStorageFlags.Exportable** );

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-13T10:03:19.297

> 字符串签名方法=@“ [http://www.w3.org/2001/04/xmldsig-more#rsa-sha256](http://www.w3.org/2001/04/xmldsig-more#rsa-sha256) ”；

根据[https://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.signedinfo.signaturemethod(v=vs.110).aspx ，此签名方法未在.NET中实现](https://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.signedinfo.signaturemethod(v=vs.110).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-22T14:38:15.143

@minhj 的回复提到了一些博客，但链接不存在。

[但是，添加此处](https://gist.github.com/sneal/f35de432115b840c4c1f)提到的类并注册它可以解决问题。似乎每个应用程序域只应注册一次。

# javascript - 使用带有 click() javascript 的函数

> ID：11765471
> 
> 赞同：0
> 
> 时间：2012-08-01T18:39:18.240
> 
> 标签：javascript

我正在尝试使用带有`click()`. 我在控制台中没有收到任何错误，我怎样才能让它在点击发生时执行函数中的操作？这是我正在使用的代码。

```
inputIds = [].filter.call(document.getElementsByTagName('input'), function(el) {
                return el.id.indexOf('ansx') === 0;
            }).map(function(el) {
                return el.id;
            });
            // random number between low and high range
            inputId = inputIds[Math.floor(Math.random() * inputIds.length)];

    document.getElementById(inputId).click(function() {
        chrome.extension.sendMessage({ message: "text here" }, function(response) {
            return response;
        });
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T18:41:00.747

`click`不是针对返回的事件绑定`DOMElement`函数`getElementById`。正如评论者所指出`click`的，调用事件。您需要使用 jquery 或使用普通的旧事件处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:42:47.897

如果你没有使用任何 JavaScript 框架，你应该使用`addEventListener`而不是`click`函数。

```
document.getElementById(inputId).addEventListener("click", function() {
    chrome.extension.sendMessage({ message: "text here" }, function(response) {
        return response;
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T19:01:18.200

这是跨浏览器的 addEvent 的通用实现。

```
function addEvent(el, type, eventHandle){
   if ( el.addEventListener ) {
      el.addEventListener( type, eventHandle, false );
   } else if ( el.attachEvent ) {
      el.attachEvent( "on" + type, eventHandle );
   } else {
      el[type] = eventHandle;
   }
} 
```

你的代码看起来像

```
addEvent(document.getElementById(inputId), "click", function() {
    chrome.extension.sendMessage({ message: "text here" }, function(response) {
        return response;
    }); 
  }); 
```

我建议任何人使用像 jQuery 这样的基础框架，因为它会掩盖很多这样的怪癖。

# asp.net - 防止 NVelocity 显示令牌

> ID：11765474
> 
> 赞同：0
> 
> 时间：2012-08-01T18:39:31.283
> 
> 标签：asp.net, velocity, nvelocity

我的模板中有以下代码，它使用 NVelocity 来处理表单数据：

```
$PartnerProfile.Nvalue("Name") 
```

如果*Nvalue*方法不返回任何值，我希望 NVelocity 不显示任何内容。但它宁愿输出代码，即
**“Lorem ipsum dolor sit *$PartnerProfile.Nvalue("Name")* amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt”**

如何防止该代码显示在我的输出中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T17:23:15.137

答案很简单。我只需要添加字符'！' 到令牌的开头。像这样：

```
$!PartnerProfile.Nvalue("Name") 
```

如果指定参数没有值，则输出将为空。

**“Lorem ipsum dolor sit *$PartnerProfile.Nvalue("Name")* amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt"**

将是这个-->

**“Lorem ipsum dolor sit amet，consectetur adipisicing elit，sed do eiusmod tempor incidudunt”**

# regex - Perl中的字符替换

> ID：11765480
> 
> 赞同：3
> 
> 时间：2012-08-01T18:39:50.563
> 
> 标签：regex, perl

我正在努力将每个单词中的所有元音加倍。例如：

```
$string="if it rains, cover with umbrella"; 
```

这是我写的代码，但我没有得到正确的输出。

```
$string=~s/a|e|i|o|u/aa|ee|ii|oo|uu/gi; print $string; 
```

预期输出：`iif iit raaiins cooveer wiith uumbreelaa`

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T19:13:50.910

替换中的正则表达式应该可以正常工作，但是正如您将看到的，替换字符串是一个简单的字符串，它与匹配项无关，除非您在正则表达式中捕获子字符串并在替换字符串中使用它们。

使用字符类来匹配一组字符中的任何一个，例如`[aeiuo]`.

使用括号“捕获”匹配的一部分，以便您可以在替换字符串中使用它。

```
my $string = "if it rains, cover with umbrella";

$string =~ s/([aeiuo])/$1$1/g;

print $string; 
```

**输出**

```
iif iit raaiins, cooveer wiith uumbreellaa 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-01T18:45:01.607

所有匹配都在变量 $1,...,$9 中捕获，因此如果您将 $1 替换两次，它将重复匹配的任何内容，在这种情况下，它将加倍元音

```
$string=~ s/(a|e|i|o|u)/\1\1/gi; 
print $string; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T19:56:52.063

如前所述，在这种情况下，以下方法可以解决问题：

```
s/([aeiuo])/$1$1/ig;    # A => AA 
```

或者，也许你想要

```
s/([aeiuo])/\L$1$1/ig;  # A => aa 
```

以下是适用于任意翻译映射的替代解决方案：

```
my %map = (
   'a' => 'aa',
   'e' => 'ee',
   'i' => 'ii',
   'o' => 'uu',
   'u' => 'oo',
);

my $pat =
   join '|',
    map quotemeta,
     sort { length($b) <=> length($a) }
      keys(%map);

s/($pat)/$map{$1}/g; 
```

如果您有上述内容，甚至可以使用

```
( 'foo' => 'bar',
  'bar' => 'foo' ) 
```

`sort`如果您没有类似的内容，则可以省略该行

```
( 'foo'  => 'bar',
  'food' => 'baz' ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:42:27.443

您没有打印不正确的输出是什么，但您可以简单地将每个元音替换为其双音。例如：

```
$string =~ s/a/aa/g;
$string =~ s/e/ee/g;
$string =~ s/i/ii/g;
$string =~ s/o/oo/g;
$string =~ s/u/uu/g; 
```

# web-services - 确认提交到 Web API 的正确方法是什么？

> ID：11765483
> 
> 赞同：0
> 
> 时间：2012-08-01T18:40:42.053
> 
> 标签：web-services, rest, asp.net-web-api

我有一个不断记录信息的移动设备。信息存储在设备的本地数据库中。每隔几分钟，设备就会通过 REST API 将数据上传到服务器——有时上传的数据对应同一张表中的数十条记录。现在，服务器响应

```
{status: "SAVED"} 
```

如果数据保存到服务器。

为了 100% 确定数据已实际上传（因此设备不会再次尝试上传），这样简单的响应是否足够？或者我应该对传入的数据进行哈希处理并对其进行响应，或者类似的东西？也许我应该发回`id`设备表行的本地行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:43:53.547

如果整个请求确实成功保存，我认为有一个非常简单的“SUCCESS”响应很好。

但是，我认为当出现问题时，您的响应需要包含未能保存的记录的 ID（或其他一些唯一标识符），以便它们可以排队等待重新发送。

如果相同的记录多次失败，您可能需要记录错误或显示错误以便采取进一步措施。

成功的响应可能很简单：

```
<response>
    <status>1</status>
</response> 
```

错误响应可能类似于：

```
<response>
    <status>0</status>
    <errorRecords>
        <id>441</id>
        <id>8462</id>
        <id>12</id>
    </errorRecords>
</response> 
```

您可能会喜欢并拥有不同的状态代码，这意味着不同的、更具体的消息。

# html - CSS 在 JBoss (OpenShift) 上正确应用，但不适用于 Tomcat 7

> ID：11765484
> 
> 赞同：0
> 
> 时间：2012-08-01T18:40:51.303
> 
> 标签：html, css, tomcat, jboss

我有一个页面，我在本地 Tomcat 7 实例和远程 JBoss 实例（OpenShift）上都加载了它。该 css 应用于 JBoss，但不适用于 Tomcat 7：

**html页面**头：

```
<head>
    <title><decorator:title /></title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" type="text/css" href="/static/css/reset.css" media="screen" />   
    <link rel="stylesheet" type="text/css" href="/static/css/960gs-16col.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/static/css/default.css" media="screen" />
</head> 
```

**默认.css**

```
body {
  background-color: #c73b0b;
} 
```

`rest.css`并且`default.css`不适用于Tomcat 7。我检查了FireBug，没有报告错误。我检查了两个系统上的页面源代码，完全一样。

什么可能导致这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:57:23.860

您应该始终在 webapp 中构建 URL，如下所示：

```
<link rel="shortcut icon" href="<%= request.encodeURL(request.getContextPath() + "/images/favicon.ico") %>" type="image/x-icon"/> 
```

当您更改上下文路径时，这将使您的 webapp 可以轻松地重新定位，并解决您上面提出的问题。

请注意，大多数 URL 处理标记库（如 JSTL、Struts 等）都将为您执行上述工作。通常最好使用其中之一，而不是在 JSP 代码中到处都有那个丑陋的 scriptlet。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:06:27.797

正如我们与@JVerstry 一起解决的：

似乎 Tomcat 加载 CSS 文件的方式与 JBoss 不同。

`/static/css/reset.css`是绝对路径。如果`reset.css`是应用程序的一部分，则应将其引用为`static/css/reset.css`（不带前导斜杠）

# powerpoint - 如何创建没有富文本格式的代码框

> ID：11765488
> 
> 赞同：1
> 
> 时间：2012-08-01T18:41:03.227
> 
> 标签：powerpoint, plaintext, richtext

我的问题与此主题有关[如何在没有富文本格式的情况下复制和粘贴代码？](https://stackoverflow.com/questions/122404/how-to-copy-and-paste-code-without-rich-text-formatting)除了从相反的角度来看：我正在从 PowerPoint 创建一个文档，其中我在文本框中有代码片段。我希望通过使代码片段文本框易于复制并将代码粘贴到终端以在不编辑任何内容的情况下运行，从而使文档尽可能简单。但是，我现在拥有它的方式是，当我复制和粘贴它时，它会保留格式，我必须逐个字母地删除行尾符号。我应该如何在 PowerPoint 中设置它的格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T14:13:42.280

您可以通过从 PPT 复制/粘贴到记事本，然后从那里复制/粘贴到您的终端程序来摆脱大多数格式设置，或者如果后者有“选择性粘贴”命令，您应该能够粘贴为纯文本，这摆脱格式化。

换行/分段是另一回事。如果在您将文本粘贴到终端（我假设是仿真程序）时，行尾符号是唯一的格式问题，听起来好像终端使用 CR 或 LF 作为行尾，而 PPT 使用 CR/LF对。可能只需要重新配置终端软件以使用 CR/LF。

值得看看我网站上的这个页面，我在其中解释了不同版本的 PowerPoint 在不同情况下使用的行和段落结尾字符。

段落结尾和换行符 [http://www.pptfaq.com/FAQ00992_Paragraph_endings_and_line_breaks.htm](http://www.pptfaq.com/FAQ00992_Paragraph_endings_and_line_breaks.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:39:59.663

抱歉，我的错误是没有意识到 PowerPoint 自动格式化连字符和引号以使其风格化，并且终端无法识别符号。我所做的只是输入一个引号/连字符，然后在我按下空格键之前复制它以保存原始格式。

# ant - Ant：导入特定的环境变量

> ID：11765489
> 
> 赞同：2
> 
> 时间：2012-08-01T18:41:14.027
> 
> 标签：ant, path, environment-variables

一个快速的问题，但可能没有答案（或者至少是我想要的答案）：

我只想将一组特定的环境变量导入 Ant 脚本。`<property environment="env"/>`我知道我可以通过任务导入整个环境。但是，我正在使用 Jenkins，导入整个环境似乎很愚蠢，因为我想要几个变量，比如`$BUILD_NUMER`和`$JOB_NAME`

我知道我可以做这样的事情：

```
 $ ant -DBUILD_NUMBER=$BUILD_NUMBER package 
```

我想有人可能已经想出一种方法来通过资源集合来做到这一点。如果没有，我只需要接受所有环境变量都已导入的事实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T23:39:57.317

可能作弊...使用[`scriptdef`](http://ant.apache.org/manual/Tasks/scriptdef.html)?

```
<scriptdef name="envproperty" language="javascript">
    <attribute name="name" />
    <attribute name="fromenv" />
<![CDATA[
    importClass( java.lang.System );
    project.setProperty(
        attributes.get( "name" ),
        System.getenv( attributes.get( "fromenv" ) )
    );
]]>
</scriptdef>

<envproperty name="BUILD_NUMBER" fromenv="BUILD_NUMBER" />
<envproperty name="JOB_NAME" fromenv="JOB_NAME" /> 
```

# iframe - 如何禁用网页内容出现在 iframe 元素中幻灯片的 iframe 中？

> ID：11765490
> 
> 赞同：-1
> 
> 时间：2012-08-01T18:41:14.490
> 
> 标签：iframe

看快照，你就会明白我的意思。

![在此处输入图像描述](../Images/a868b45fec55e8d3f57beb3d820e48de.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:51:10.447

您应该使用浏览器的代码检查（通常是`CTRL`+ `U`）在页面上找到 iframe，然后使用 jQuery（因为它方便）将其删除。所以你应该在你的页面中添加一个这样的脚本：`$(function() { $('#pubPath').remove(); });`或者切换到另一个网站。

# .net - VBA：与 .NET 正则表达式平衡组不兼容？

> ID：11765501
> 
> 赞同：3
> 
> 时间：2012-08-01T18:41:49.110
> 
> 标签：.net, regex, vba, porting, balancing-groups

我一直在检查是否可以在 Excel 电子表格 VBA 函数中使用 .NET 正则表达式平衡组。

但是，VBA 似乎与 .NET 不兼容，也不是 .NET 的一部分。例如，维基百科直言[“VBA 与 Visual Basic .NET (VB.NET) 不兼容”。](http://en.wikipedia.org/wiki/Visual_Basic_for_Applications#Language)

所以，为了确定，w/r/t 正则表达式平衡组，我在 VBA 中运气不好，对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:45:13.850

编写 .NET 对象、将其公开给 COM 并从 VBA 使用它并没有错。

“不兼容”可能意味着粘贴到 VBA 编辑器中的 .NET 代码将不起作用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-01T18:54:41.787

实际上，至少从 Office 2003 开始​​，您就可以使用 .Net 来创建 Visual Studio 解决方案，并且使用[Visual Studio Tools for Office](http://msdn.microsoft.com/en-us/office/hh133430.aspx) (VSTO)。

不幸的是，您必须跳过几个环节并遵守一些限制才能部署它，但它可能比公开和注册 COM 对象更容易。[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/office/aa192490%28v=office.11%29.aspx)有一些关于创建和部署 VSTO 解决方案的有用信息。

# amazon-ec2 - Redis 服务器的最佳 EC2 设置

> ID：11765502
> 
> 赞同：19
> 
> 时间：2012-08-01T18:41:58.003
> 
> 标签：amazon-ec2, redis

我们正在部署一个仅使用 redis 作为数据存储的大型 Web 应用程序。我注意到我们的 redis master 在 EC2 上的基准是每秒大约 8000 个事务，远远低于专用硬件上的基准。

我知道在 EC2 等虚拟机上运行 Redis 会降低性能，但我希望在 EC2 上的生产环境中部署 Redis 的人提供一些关于您发现哪种 EC2 设置最有效地从 Redis 中获得更多收益的建议.

谢谢。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-05-06T18:55:26.323

EC2 可能不是在虚拟化硬件上运行 Redis 的最佳环境，但它是一种流行的环境，要在该平台上充分利用 Redis，需要了解许多要点。

我是[http://redis.io/topics/benchmarks](http://redis.io/topics/benchmarks)和 [http://redis.io/topics/latency](http://redis.io/topics/latency)的作者之一，它们涵盖了我在下面介绍的大部分主题。这只是对要点的总结。

**虚拟化收费**

它并不特定于 EC2，但在 VM 上运行时 Redis 的速度要慢得多（就支持的最大吞吐量而言）。这是因为对于基本操作，Redis 不会为处理客户端连接所需的 epoll/read/write 系统调用（如 memcached 或其他高效的键/值存储）增加太多开销。系统调用在 VM 上通常更昂贵，它们代表了 Redis 活动的重要部分（尤其是在基准测试中）。在这种情况下，与裸机相比，最大吞吐量下降 50% 并不少见。

当然，这也取决于管理程序的质量。对于 EC2，使用 Xen。

**在良好条件下进行基准测试**

基准测试可能很棘手，尤其是在 EC2 这样的平台上。经常忘记的一点是确保基准客户端和服务器的正确配置。例如，在针对您的 Redis 服务器时，不要在 CPU 匮乏的微实例（可能会被亚马逊限制）上运行 redis-benchmark。两台机器对于获得良好的最大吞吐量同样重要。

实际上，要评估 Redis 的性能，您需要：

*   假设您有多个 vCPU 内核，在本地运行 redis-benchmark（与服务器在同一台机器上）。

*   在 QoS 配置等同于服务器机器的机器上远程运行 redis-benchmark（从不同的 VM）

因此，您可以评估和比较机器和网络的性能。

在 EC2 上，您将使用第二代 M3 实例（或高内存或集群计算实例）获得最佳结果，因此您可以受益于 HVM（硬件虚拟化），而不是依赖较慢的半虚拟化。

**分叉问题**

这不是 EC2 特有的，而是 Xen 特有的：在 Xen 上分叉一个大型进程可能真的很慢（使用 kvm 看起来更好）。对于 Redis，如果您打算使用持久性，这是一个大问题：两种持久性选项（RDB 或 AOF）都需要主线程分叉并启动后台保存或重写进程。

在某些情况下，fork 延迟可能会使 Redis 事件循环冻结几秒钟。Redis 实例管理的内存越多，延迟就越多。

在 EC2 上，请务必使用启用 HVM 的实例（M3、高内存、集群），它将缓解该问题。

然后，如果您有大量内存需求，并且您的应用程序可以容忍它，请考虑在同一台机器上运行几个较小的 Redis 实例，并对您的数据进行分片。它可以将由于分叉操作导致的延迟降低到可接受的水平。

**持久化配置**

这是从 Redis（在 VM 和裸机上）获得良好性能的关键点。所以请花时间仔细阅读[http://redis.io/topics/persistence](http://redis.io/topics/persistence)

如果您使用 RDB，请记住，一旦保存后台进程被分叉，内存写入时复制机制将开始复制页面。所以你需要保证 Redis 本身有足够的内存，加上一些余量来应付 COW。额外内存的数量取决于您的工作量。您在实例中写入的越多，您需要的额外内存就越多。

请注意，写入文件也可能会消耗一些内存（因为文件系统缓存），因此在 Redis 后台保存期间，您需要考虑 Redis 内存、COW 开销和转储文件的大小。

运行 Redis 服务器的机器绝不能交换。如果是这样，结果将是灾难性的。与其他一些商店相反，Redis 对虚拟内存不友好。

在 Linux 中，一定要设置合理的系统参数：vm.overcommit_memory=1 和 vm.swappiness=0（或者一个非常低的值）。不要使用旧的内核版本：它们在执行低交换性方面非常糟糕（导致在写入大文件时进行交换）。

如果您使用 AOF，请查看 fsync 选项。这是原始性能和写入操作的持久性之间的权衡。您需要做出选择并定义策略。

您还需要熟悉 EC2 存储选项。在某些 VM 上，您可以在临时存储和 EBS 之间进行选择。在其他一些上，您只有 EBS。

临时存储通常更快，并且您可能会遇到比 EBS 更少的问题，但是在磁盘故障或主机重启等情况下您可以轻松丢失数据......您可以想象将 RDB 快照放在临时存储上，并且然后将生成的文件复制到 EBS 目录，作为性能和稳健性之间的权衡。

EBS 是远程存储：它可能会占用分配给 VM 的标准网络带宽，并影响 Redis 的最大吞吐量。如果您计划使用 EBS，请考虑选择“EBS 优化”选项以在标准网络和存储链路之间建立 QoS。

最后，对于使用 EC2 的性能要求高的实例，一个非常常见的设置是停用主实例上的持久性，并且仅在从属实例上激活它。数据可能不太安全，但它可以防止主服务器上的许多潜在延迟问题。

# javascript - 有没有办法重新加载主 GEPlugin 数据库？

> ID：11765508
> 
> 赞同：2
> 
> 时间：2012-08-01T18:42:10.820
> 
> 标签：javascript, html, google-earth, google-earth-plugin

所以我想要做的是替换加载到 Web 浏览器中的 Google Earth GEPlugin 实例中的主数据库。如果我去代码游乐场：[这里 http://code.google.com/apis/ajax/playground/#mars/alternate_server_connectivity](http://code.google.com/apis/ajax/playground/#mars/alternate_server_connectivity)

然后我得到一个加载新数据库的例子。但是，如果我尝试多次调用 CreateInstance，我会一直获取相同的数据库（我猜这是由于在后台运行的 GEPlugin.exe 仍在使用第一个数据库。如果我通过杀死 geplugin 来删除该实例.exe 进程然后加载工作）

在该示例代码页上编辑 HTML，我使用了以下 html/script 组合

```
 <!--
You are free to copy and use this sample in accordance with the terms of the
Apache license (http://www.apache.org/licenses/LICENSE-2.0.html)
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>Google Earth API Sample</title>
    <script src="http://www.google.com/jsapi?key=ABQIAAAAuPsJpk3MBtDpJ4G8cqBnjRRaGTYH6UMl8mADNa0YKuWNNa8VNxQCzVBXTx2DYyXGsTOxpWhvIG7Djw" type="text/javascript"></script>
    <script type="text/javascript">
    var ge;

    google.load("earth", "1");

    function init() {
      google.earth.createInstance('map3d', initCallback, failureCallback,
        { database: 'http://khmdb.google.com/?db=mars' });

    }

    function initCallback(instance) {
      ge = instance;
      ge.getWindow().setVisibility(true);

      // add a navigation control
      ge.getNavigationControl().setVisibility(ge.VISIBILITY_AUTO);

      document.getElementById('installed-plugin-version').innerHTML =
        ge.getPluginVersion().toString();
    }

    function failureCallback(errorCode) {
    }
     function loadmoon()
      {
        delete ge;
        google.earth.createInstance('map3d', initCallback, failureCallback, { database: 'http://khmdb.google.com/?db=moon' });
        //http://khmdb.google.com/?db=moon
      }

    </script>
  </head>
  <body onload="init()" style="font-family: arial, sans-serif; font-size: 13px; border: 0;">
    <div id="map3d" style="width: 500px; height: 380px;"></div>
    <br>
    <a href="" onclick="loadmoon()">LOAD THE MOON</a>
    <div>Installed Plugin Version: <span id="installed-plugin-version" style="font-weight: bold;">Loading...</span></div>

  </body>
</html> 
```

这样做的原因是它重新加载了实例，但它不会更改数据库。

我应该说我知道添加辅助数据库的选项，但是如果我尝试加载辅助数据库，地形仍然映射到第一个数据库的地形。对我来说这是不可接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T16:29:39.620

在再次创建实例之前，将 'map3d' 的 innerHTML 设置为空字符串。

```
function loadmoon(){
    document.getElementById('map3d').innerHTML = '';
    google.earth.createInstance('map3d', initCallback, failureCallback, { database: 'http://khmdb.google.com/?db=moon' });
} 
```

看看这个例子，应该正是你所需要的。[http://earth-api-samples.googlecode.com/svn/trunk/examples/alternate-spheres.html](http://earth-api-samples.googlecode.com/svn/trunk/examples/alternate-spheres.html)

# python - Scipy _fitpack fprank_() 中的分段错误

> ID：11765510
> 
> 赞同：0
> 
> 时间：2012-08-01T18:42:29.717
> 
> 标签：python, segmentation-fault, scipy

我运行了一个 python 代码，我得到了错误，“分段错误”。然后我运行“gdb python”并从（gdb）提示符重新运行代码，得到以下结果：

```
#0  0x00007fffed573487 in fprank_ ()
    from /usr/lib/python2.7/dist-packages/scipy/interpolate/_fitpack.so
#1  0x00007fffed56ee81 in fpsurf_ ()
    from /usr/lib/python2.7/dist-packages/scipy/interpolate/_fitpack.so
#2  0x00007fffed55363d in surfit_ ()
   from /usr/lib/python2.7/dist-packages/scipy/interpolate/_fitpack.so
#3  0x00007fffed54183a in fitpack_surfit (dummy=<value optimised out>, 
    args=<value optimised out>) at scipy/interpolate/src/__fitpack.h:217
#4  0x00000000004965f1 in call_function (f=<value optimised out>, 
    throwflag=<value optimised out>) at ../Python/ceval.c:4013
#5  PyEval_EvalFrameEx (f=<value optimised out>, 
    throwflag=<value optimised out>) at ../Python/ceval.c:2666
#6  0x000000000049d325 in PyEval_EvalCodeEx (co=0x1cf50b0, 
    globals=<value optimised out>, locals=<value optimised out>, 
    args=<value optimised out>, argcount=<value optimised out>, 
    kws=<value optimised out>, kwcount=5, defs=0x1baaca0, defcount=16, closure=
    0x0) at ../Python/ceval.c:3253
#7  0x0000000000496a92 in fast_function (f=<value optimised out>, 
    throwflag=<value optimised out>) at ../Python/ceval.c:4109
#8  call_function (f=<value optimised out>, throwflag=<value optimised out>)
    at ../Python/ceval.c:4034
---Type <return> to continue, or q <return> to quit--- 
```

谁能帮我解决我的错误？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:49:16.690

从回溯可以解释它是在 fprank_() 函数中崩溃的 scipy 本机库。

这很可能是一个 scipy 错误。联系 scipy 社区和/或使用隔离的测试用例提交针对 scipy 的错误。

您不太可能在 stackoverflow.com 中找到解决方案，因为它显然是一个崩溃的错误。

# delphi - 有什么方法可以知道一个对象是在类助手中创建还是销毁？

> ID：11765513
> 
> 赞同：5
> 
> 时间：2012-08-01T18:42:31.287
> 
> 标签：delphi, lifecycle, class-helpers

我几乎没有组件类帮助器来创建子组件，例如弹出菜单，以便在运行时访问这些子组件，我创建了一个单例 TDictionary。

我的问题是我怎么知道所有者组件正在被销毁以从 TDictionary 中删除子组件？

如果它是一个专门的组件，我将它添加到析构函数中，但我不能在类帮助器中添加构造函数和/或析构函数。

**编辑 - 解决方案**

我创建了一个接受 TObject 作为参数的基础对象，使用时，必须手动完成删除操作。

然后我从它继承了一个新类，重写了只接受 TComponent 的方法。这就是代码的相关部分现在的样子：

```
type     
  TCustomLinkedComponents = class(TCustomLinkedObjects)
  strict private
    type
      TCollector = class(TComponent)
      protected
        procedure Notification(AComponent: TComponent; Operation: TOperation); override;
      end;
  strict private
    FCollector: TCollector;
[..]
  end;

procedure TCustomLinkedComponents.Add(Owner: TComponent; const LinkedName: string; LinkedComponent: TComponent);
begin
  inherited Add(Owner, LinkedName, LinkedComponent);
  FCollector.FreeNotification(LinkedComponent);
end;

procedure TCustomLinkedComponents.TCollector.Notification(AComponent: TComponent; Operation: TOperation);
begin
  inherited;
  if Operation = opRemove then
    LinkedObjects.Remove(TObject(AComponent));
end; 
```

使用这种方法，我可以解决我的实际需求，并让稍后轻松扩展。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:53:58.193

代替 a ，创建一个包含 a`TDictionary`的自定义后代。然后研究如何工作，解决方案应该变得显而易见。:)`TComponent``TDictionary``TComponent.FreeNotification`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T19:06:00.557

如果你想*知道*组件是否被销毁，你应该使用

```
function IsBeingDestroyed(AComponent : TComponent) : Boolean;
begin
  Result := csDetroying in AComponent.ComponentState;
end; 
```

如果你想在它被销毁时*得到通知*，使用 FreeNotification 是要走的路。

有关 FreeNotification 的更多详细信息，您可以查看[这篇文章](https://stackoverflow.com/questions/18119/how-to-keep-track-of-the-references-to-an-object)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-01T19:54:05.790

不，你不能。Delphi 不会特别跟踪类助手是否创建/销毁了某些东西。

# java - Java - 自定义哈希映射/表的一些要点

> ID：11765517
> 
> 赞同：4
> 
> 时间：2012-08-01T18:42:41.737
> 
> 标签：java, hashmap, hashtable

在之前的一些帖子中，我问过一些关于 java 中自定义哈希映射/表的编码的问题。现在由于我无法解决它，并且可能我忘记正确提及我真正想要的东西，我正在总结所有这些以使其清晰准确。

**我要做什么：**

我正在尝试为我们的服务器编写代码，我必须在其中通过 URL 查找用户访问类型。

现在，我有 11.1 亿个 URL（大约）。

所以，我们所做的，

1) 将数据库划分为 1.1 亿个 Url 中的 10 个部分。2）使用并行数组构建一个HashMap，其键是URL的一部分（表示为LONG），值是URL的另一部分（表示为INT）-*键可以有多个值*。

3）然后在系统启动时每天在HashMap中搜索其他一些URL（一天保存数百万个URL）。

**您尝试过的内容：**

1) 我尝试了许多 NoSQL 数据库，但我们发现对我们的目的不太好。

2）我为此目的构建了我们的[自定义哈希图](https://stackoverflow.com/questions/11398762/custom-hashmap-code-issue)（使用两个并行数组）。

**那么，问题是什么：**

当系统启动时，我们必须加载每个数据库的哈希表并搜索数百万个 url：

现在，问题是，

1) 虽然 HashTable 的性能相当不错，但代码在加载 HashTable 时需要更多时间（我们使用文件通道和内存映射缓冲区来加载它，加载 HashTable 需要 20 秒 - 2.2 亿个条目 - 因为加载因子是 0.5，[我们发现它最快](https://stackoverflow.com/questions/11312553/java-project-make-hashmap-including-load-store-performance-better)）

因此，我们花费时间：（HashTable Load + HashTable Search）* DB 数量 = (5 + 20) * 10 = 250 秒。这对我们来说相当昂贵，而且大部分时间（250 秒中有 200 秒）用于加载哈希表。

**你有没有想过其他方式：**

一种方法可以是：

无需担心加载和存储，通过使用内存映射缓冲区将缓存留给操作系统。但是，由于我必须搜索数百万个键，它的性能比上面的要差。

当我们发现 HashTable 性能不错但加载时间很长时，我们想以另一种方式将其切断，例如：

1）创建一个大小为 Integer_MAX 的链表数组（[我自己的自定义链表](https://stackoverflow.com/questions/11749817/java-custom-linked-list-issue)）。

2）将值（int's）插入到编号为键号的链接列表中（我们将键大小减小为INT）。

3）因此，我们必须只将链表存储到磁盘中。

现在，问题是，创建如此数量的链接列表需要花费大量时间，如果数据分布不均，创建如此大量的链接列表将毫无意义。

**那么，您的要求是什么：**

只是我的要求：

1) 具有多值插入和搜索的键。寻找良好的搜索性能。2）快速加载（特别）到内存的方法。

（密钥是 64 位 INT，值是 32 位 INT，一个密钥最多可以有 2-3 个值。我们也可以将密钥设为 32 位，但会产生更多冲突，但如果我们能做得更好，我们可以接受） .

任何人都可以帮助我，如何解决这个问题或任何评论如何解决这个问题？

谢谢。

注意：

1) 根据 Stack Overflow 之前的建议，无法为磁盘缓存预读数据，因为系统启动时，我们的应用程序将开始工作，并在系统启动的第二天开始工作。

2）我们还没有发现 NoSQL 数据库的扩展性很好，因为我们的要求很简单（意味着只需插入哈希表键值并加载和搜索（检索值））。

3）由于我们的应用程序是小项目的一部分，并且要应用在一个小校园里，我认为没有人会为此给我买一个SSD磁盘。那是我的局限。

4) 我们也使用 Guava/Trove，但他们也无法在 16 GB 中存储如此大量的数据（我们使用的是 32 GB 的 ubuntu 服务器。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T16:08:19.630

我真的不明白您以什么形式将数据存储在磁盘上。如果您存储的内容由 url 和一些数字组成，您可以通过压缩数据来加快从磁盘加载的速度（除非您已经这样做了）。

创建一个在加载时解压缩的多线程加载程序可能会给您带来很大的提升。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:23:24.290

如果您需要快速访问 11.1 亿个数据项，那么散列是您的最佳选择。但不要重新发明轮子，使用类似的东西：

*   内存缓存数据库：http: [//memcachedb.org](http://memcachedb.org)
*   MongoDB：[http ://www.mongodb.org](http://www.mongodb.org)
*   卡桑德拉：[http ://cassandra.apache.org](http://cassandra.apache.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T20:24:05.430

在我看来（如果我正确理解您的问题）您正试图以一种复杂的方式解决问题。
我的意思是您尝试预加载的数据一开始就很大（比如说 2.2 亿 * 64 ~ 14GB）。您正在尝试为此进行内存映射等。
我认为这是一个典型的问题，可以通过在不同的机器上分配负载来解决。即，而不是试图定位链表索引，您应该尝试找出已加载地图特定部分的相应机器的索引，并从那里获取该机器的值（每台机器都加载了其中的一部分）数据库地图，您每次都从地图的适当部分（即机器）获取数据）。
也许我离这里很远，但我也怀疑你使用的是 32 位机器。
因此，如果您必须继续使用单机架构并且在经济上不可能改进您的硬件（如您所指出的，64 位机器和更多 RAM 或 SSD），我认为您无法做出任何显着的改进。

# facebook - 无法生成 Facebook Like 按钮

> ID：11765518
> 
> 赞同：0
> 
> 时间：2012-08-01T18:42:42.107
> 
> 标签：facebook, iframe, facebook-like

我正在尝试为 www.songmeanings.net 创建一个“赞按钮”

它适用于除 www.songmeanings.net 之外的其他几个地址。有什么特别的原因吗？

在这里试试

[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

输入 google.com，按回车键。完美运行 输入 songmeanings.net 按回车键。没有什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:45:15.053

我怀疑这是因为`<noscript>`第 36 行的未终止标签。或者可能[是类似](http://htmlhelp.com/cgi-bin/validate.cgi?url=http://www.songmeanings.net/&warnings=no)的东西。

# html - IE中不显示元素背景颜色

> ID：11765520
> 
> 赞同：0
> 
> 时间：2012-08-01T18:43:00.650
> 
> 标签：html, css, internet-explorer

我有一个包含 4 的页面，这些页面`<div>`已`float: left`在容器元素内应用于它们。该容器已`background: #ffffff`应用于它，但它不像我在 IE 中所期望的那样工作（特别是 8）。它在 Chrome 和 FireFox 中运行良好。

我知道如果我从容器中移除我的滑块，一切都会按我的预期显示。所以它与此有关，我只是不确定它是什么。

以下是它的外观： ![铬合金](../Images/39e358e45e89f40eb27c954487b9009c.png)

以下是它在 IE 中的显示方式：

## ![IE](../Images/ead905139716ace6c5f66befa19772a4.png)

CSS：

```
/* Container */
.main-content {
    margin-bottom: 15px;

    background: #ffffff;
    border: 1px solid #e1e1e1;
}

/* Columns (Wrecked Vehicles, Welcome, Inv Search) */
.col {
    float: left;
    width: 289px;
    padding: 10px;
    margin: 5px;
}

/* Slider */
.slider {
    float: left;
    padding: 10px;
    margin: 5px;
} 
```

HTML：

```
<div class="main-content">
    <div class="col n1">
        ...
    </div>

    <div class="slider">
        ...
    </div>

    <div class="col n2">
        ...
    </div>

    <div class="col n3">
        ...
    </div>

    <div class="clear"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:44:53.697

尝试添加`overflow:hidden`到`.main_content`. 背景没有显示的原因是，由于所有孩子都漂浮，容器的“真实”高度为零。

# c++ - 我如何在 cout/c++ 中写这个？

> ID：11765522
> 
> 赞同：1
> 
> 时间：2012-08-01T18:43:04.083
> 
> 标签：c++, string, hex, cout

如何用 cout 编写以下函数？我的主要目的是在我知道如何将它与 cout 一起使用之后将所有值实际打印到文件中。std::hex 不起作用！

```
void print_hex(unsigned char *bs, unsigned int n)
{
    int i;
    for (i = 0; i < n; i++)
    {
        printf("%02x", bs[i]);
        //Below does not work
        //std::cout << std::hex << bs[i];
    }

} 
```

* * *

编辑：

cout 打印出值，例如： r9{èZ[¶ôÃ

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-01T18:46:01.450

我认为向 int 添加强制转换可以满足您的要求：

```
#include <iostream>
#include <iomanip>

void print_hex(unsigned char *bs, unsigned int n)
{
    int i;
    for (i = 0; i < n; i++)
    {
        std::cout << std::hex << static_cast<int>(bs[i]);
    }

}

int main() {
  unsigned char bytes[] = {0,1,2,3,4,5};
  print_hex(bytes, sizeof bytes);
} 
```

这需要强制它打印为数字，而不是您所看到的字符。

# ruby - 无法在带有珠宝盒的 Mountain Lion 上安装 Ruby 1.9.3：运行 make -j4 时出错（具有当前的 readline，gcc）

> ID：11765527
> 
> 赞同：0
> 
> 时间：2012-08-01T18:43:32.013
> 
> 标签：ruby

我正在尝试使用珠宝盒（可以使用终端，不过）在我配备了 Mountain Lion 的 MBP 上安装 Ruby 1.9.3。每次编译安装时，我都会收到错误消息：“运行 make -j4 时出错”并且 Jewelry Box 中止。我有当前版本的 XCode、Readline 和 gcc，是的，我尝试过使用 Clang 进行编译 :)

这是我的日志：

[http://pastebin.com/FVLsxZ6P](http://pastebin.com/FVLsxZ6P)

假设有问题的错误（如果您不想点击链接）是：

```
ld: in /usr/local/lib/libz.1.dylib, file was built for unsupported file format ( 0xce 0xfa      0xed 0xfe 0x 7 0x 0 0x 0 0x 0 0x 3 0x 0 0x 0 0x 0 0x 6 0x 0 0x 0 0x 0 ) which is not the architecture being linked (x86_64): /usr/local/lib/libz.1.dylib for architecture x86_64
ld: in /usr/local/lib/libz.1.dylib, file was built for unsupported file format ( 0xce 0xfa 0xed 0xfe 0x 7 0x 0 0x 0 0x 0 0x 3 0x 0 0x 0 0x 0 0x 6 0x 0 0x 0 0x 0 ) which is not the architecture being linked (x86_64): /usr/local/lib/libz.1.dylib for architecture x86_64
ld: in /usr/local/lib/libz.1.dylib, file was built for unsupported file format ( 0xce 0xfa  0xed 0xfe 0x 7 0x 0 0x 0 0x 0 0x 3 0x 0 0x 0 0x 0 0x 6 0x 0 0x 0 0x 0 ) which is not the architecture being linked (x86_64): /usr/local/lib/libz.1.dylib for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
clang: error: linker command failed with exit code 1 (use -v to see invocation)
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [../../../.ext/x86_64-darwin12.0.0/digest/md5.bundle] Error 1
make[2]: *** [../../../.ext/x86_64-darwin12.0.0/digest/sha2.bundle] Error 1
make[2]: make[1]: *** [../../../.ext/x86_64-darwin12.0.0/digest/sha1.bundle] Error 1*** [ext/digest/md5/all] Error 2

make[1]: *** Waiting for unfinished jobs....
make[1]: *** [ext/digest/sha2/all] Error 2 
make[1]: *** [ext/digest/sha1/all] Error 2
installing default rmd160 libraries
ld: in /usr/local/lib/libz.1.dylib, file was built for unsupported file format ( 0xce 0xfa 0xed 0xfe 0x 7 0x 0 0x 0 0x 0 0x 3 0x 0 0x 0 0x 0 0x 6 0x 0 0x 0 0x 0 ) which is not the architecture being linked (x86_64): /usr/local/lib/libz.1.dylib for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [../../../.ext/x86_64-darwin12.0.0/digest/rmd160.bundle] Error 1
make[1]: *** [ext/digest/rmd160/all] Error 2
make: *** [build-ext] Error 2 
```

谢谢你的帮助！同样，我有 GCC V 4.2.1、READLINE 的当前版本和 Xcode 的当前版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:58:47.097

```
ld: in /usr/local/lib/libz.1.dylib, file was built for unsupported file format 
```

看起来您的问题出在 libz 上，而不是 gcc/readline。更新您的 libz 库。

# python - Python：PyPlot 大量数据点

> ID：11765529
> 
> 赞同：1
> 
> 时间：2012-08-01T18:43:34.007
> 
> 标签：python, graph, plot, matplotlib

我有三个列表，每个列表都包含向量的余弦值，每个列表都有 49,742 个数据点。我使用了流动的基本绘图，但整个图表看起来非常混乱，我怎样才能用更少的混乱来绘制这个。如果可能的话，我很想用平滑的曲线来绘制这些。

每个列表中的数据样本：

```
pltfColor = [0.837, 0.98, 0.032, 0.755,....,n] 
```

其他两个列表包含相似的数据，所有三个列表都有 n=49742 个数据点

```
plt.plot(pltfColor, 'r.')
plt.plot(pltEdgeColor, 'b.')
plt.plot(pltTexture, 'g.')
plt.ylabel('cosine values')
plt.yscale('log')
plt.show() 
```

这是我目前的情节 ![在此处输入图像描述](../Images/7b808e990c08025acf91d1a92090fa05.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T00:55:47.560

鉴于点的高密度，您可以通过降低不透明度来挑选集群

```
plt.plot(pltfColor, 'r.', alpha=.1, mec='none') 
```

`hexbin`正如@imsc 建议的那样，还将制作密度图

# java - 如何在 Java 中制定 NOR 运算符

> ID：11765530
> 
> 赞同：6
> 
> 时间：2012-08-01T18:43:34.017
> 
> 标签：java

我只是想知道如何才能像这样在 Java 中获得 NOR 运算符

```
if (!(foo == "bar" || foo1=="bar1")){
...
} 
```

编辑：我正在寻找一种更有效的方式来编写它

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-01T18:45:15.877

> [...]***我一直在寻找一种更有效的方式来编写它***

Java 中没有 NOR 运算符。你必须像以前那样做

```
!(A || B) 
```

或者，`!A && !B`当然。

# iphone - 在 Xcode 故事板中使用可拉伸图像

> ID：11765533
> 
> 赞同：33
> 
> 时间：2012-08-01T18:43:42.570
> 
> 标签：iphone, ios, xcode, cocoa-touch, uistoryboard

我正在使用故事板来布局我的视图控制器，并且我想为我的按钮使用可拉伸的图像（这样我就不需要生成多个不同大小的图像）。

这是否可以直接在情节提要中完成而无需编写任何代码？我真的很喜欢将情节提要用于所有图形内容并保持代码与 UI 内容无关的可能性，但我似乎无法摆脱它。

如果不可能，否则您会建议什么？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-11-13T20:02:17.983

**iOS 7+ 的更新**
iOS 7+ 现在通过资产目录原生支持可拉伸图像。使用资产目录，您现在可以指定图像的切片方式和缩放方式（拉伸或平铺）。图像的这些资产目录属性将立即反映在情节提要中。伟大的新改进。有关更多信息，请参阅[资产目录上的 Apple 文档](http://help.apple.com/xcode/mac/8.0/#/deve65bd8d0d)

**部署到 7 之前的 iOS 版本：**
这是一个鲜为人知的事实，但您完全可以仅使用 Interface Builder/Storyboard 和属性检查器中的拉伸属性来设置图像的 cap insets。感谢[维克多](https://stackoverflow.com/a/11767677/257550)的原始答案。

查看 a 的属性检查器中的拉伸属性`UIImage`，X 和 Y 值是拉伸起点的位置，相对于图像的整个宽度和高度。值 0.5 表示图像中间的一个点。

宽度和高度是相对于图像大小的可拉伸区域的大小。因此，将宽度设置为 1 / imageWidth 会将可拉伸区域设置为 1px 宽。

大多数可拉伸图像将从中间拉伸，因此使用 X、Y、宽度和高度的这些值通常会起作用：

```
X = 0.5
Y = 0.5
Width = 1/imageWidth
Height = 1/imageHeight 
```

注意：除非您要拉伸的图像非常小，否则这意味着宽度和高度属性将非常小（例如 0.008），可以使用 0.0 代替。因此，实际上，0.5、0.5、0.0、0.0 几乎总是适用于 X、Y、宽度和高度。

在少数情况下，0.0 对宽度和高度不起作用，这确实意味着您需要使用计算器在 IB 中设置这些值。但是，我认为这通常比必须以编程方式设置它更可取，因为您将能够在 IB (WYSIWYG) 中看到生成的拉伸图像。

![可拉伸图像属性](../Images/92119da164aefde41fdb23e4682d18ae.png)

**更新：**有人指出，尽管使用上述建议在 Storyboard 中拉伸图像有效，但在按钮上拉伸图像仍然存在问题，即使在 iOS7 中也是如此。不用担心，这很容易通过创建一个`UIButton`负责为控制状态设置上限插图的类别来解决：

```
@implementation UIButton (Stretchable)

/* Automatically set cap insets for the background image. This assumes that
   the image is a standard slice size with a 1 px stretchable interior */
- (void)setBackgroundImageStretchableForState:(UIControlState)controlState
{
    UIImage *image = [self backgroundImageForState:controlState];
    if (image)
    {
       CGFloat capWidth =  floorf(image.size.width / 2);
       CGFloat capHeight =  floorf(image.size.height / 2);
       UIImage *capImage = [image resizableImageWithCapInsets:
                     UIEdgeInsetsMake(capHeight, capWidth, capHeight, capWidth)];

       [self setBackgroundImage:capImage forState:controlState];
    }
} 
```

使用此类别，您可以通过 Storyboard 为按钮设置可拉伸图像，然后通过调用`-setBackgroundImageStretchableForState:`. `-viewDidLoad`即使对视图中的大量按钮，遍历视图层次结构也很容易做到这一点：

```
NSPredicate *predicate = 
    [NSPredicate predicateWithFormat:@"self isKindOfClass:%@",[UIButton class]];
NSArray *buttons = [self.view.subviews filteredArrayUsingPredicate:predicate];
for (UIButton *button in buttons)
   [button setBackgroundImageStretchableForState:UIControlStateNormal]; 
```

虽然这不如拥有一个`UIButton`自动为您执行此操作的子类（子类`UIButton`化不实用，因为它是一个类集群），但它确实为您提供了几乎相同的功能，只需在您的 viewDidLoad 中添加一些样板代码 - - 您可以在 Storyboard 中设置所有按钮图像，并且仍然可以正确拉伸它们。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-03-02T08:32:28.727

使用 Xcode 6（和**iOS7+**目标），您可以在处理图像资源时使用切片编辑器。使用编辑器切换切片模式**-> 显示切片**菜单或在使用编辑器选择特定图像时按**显示切片按钮（如下所示）。**

![显示切片按钮](../Images/243ac57bd2ccb8c79a049388e194eb63.png)

然后，您可以选择特定显示比例的图像并拖动规则或手动编辑插入值。

![规则](../Images/2ad1b7947b03122021598b5f50eea56f.png)

之后，您可以在*Interface Builder*中选择此图像。例如，我将它用于*UIButton* **背景图像**（IB 按钮的表示可能看起来很糟糕，但运行时应该没问题）。

我的按钮看起来不错（运行 iOS 7.1 模拟器和 iOS 8 设备）。

![在此处输入图像描述](../Images/4094269531ac335b694b6bd99e1e8357.png)

这个 Apple 文档[链接](https://developer.apple.com/library/ios/recipes/xcode_help-image_catalog-1.0/chapters/SlicinganImage.html)可能会有所帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-06T04:40:44.433

它在 XCode 的 5.0 Interface Builder 中与资产目录是可行的。创建一个图像资产（如果您还没有资产目录，您可以按如下方式创建一个：

1.  `File`-> `New`-> `File`-> `Resources`->`Asset Catalog`
2.  然后`Editor`->`New Image Set`
3.  为每个`Idiom`&设置图像`Scale`
4.  然后点击`Show Slicing`按钮以根据需要设置切片。

在此处查看 Apple 文档：[Developer Apple: Asset Catalog Help](https://developer.apple.com/library/ios/recipes/xcode_help-image_catalog-1.0/SlicinganImage/SlicinganImage.html) 然后您所要做的就是将按钮的背景图像设置为请求的资产。

编辑：我忘了提到它只在 iOS7 中按要求工作

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-07T17:41:09.827

这是我所做的：我为按钮设置了一个插座并连接它，然后在 viewDidLoad 中执行此操作：

```
[self.someButton setBackgroundImage:[[self.someButton backgroundImageForState:UIControlStateNormal] resizableImageWithCapInsets:UIEdgeInsetsMake(3, 3, 4, 3)] forState:UIControlStateNormal]; 
```

这使它可以重用您在情节提要中设置的图像，因此如果您将其从一种颜色更改为另一种颜色，只要插图不改变，它就会起作用。

对于包含许多此类内容的视图，我这样做了：

```
for (UIView * subview in self.view.subviews) {
        if ([subview isKindOfClass:[UIImageView class]] && subview.tag == 10) {
            UIImageView* textFieldImageBackground = (UIImageView*)subview;
            textFieldImageBackground.image = [textFieldImageBackground.image stretchableImageWithLeftCapWidth:7 topCapHeight:5];
        } else if([subview isKindOfClass:[UIButton  class]] && subview.tag == 11) {
            UIButton * button = (UIButton*)subview;
            [button setBackgroundImage:[[button backgroundImageForState:UIControlStateNormal] resizableImageWithCapInsets:UIEdgeInsetsMake(3, 3, 4, 3)] forState:UIControlStateNormal];
        }
    } 
```

请注意，我为所有我想要拉伸的标签设置了标签。

不过，我和你在同一条船上，我希望能够在情节提要本身上设置这些以 UI 为中心的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-07T04:56:10.283

使用 Xcode Slicing 功能来指定图像可调整大小的中心区域的尺寸，并可选择指定端盖，即不应由可调整大小的区域填充的图像区域。请参阅[关于资产目录](https://developer.apple.com/library/ios/recipes/xcode_help-image_catalog-1.0/chapters/SlicinganImage.html#//apple_ref/doc/uid/TP40013303-CH4-SW1)

# unix - 查找带有通配符或类似于“like”的目录名称

> ID：11765536
> 
> 赞同：102
> 
> 时间：2012-08-01T18:43:44.670
> 
> 标签：unix, directory

我正在使用以下命令来查找目录名称。

```
 find / -type d -name "ora10" 
```

我的问题是，我不确定确切的目录名称是什么，所以我想找到类似于`"ora10g"`,`"ora10client"`等的目录。

我怎样才能用 find 做到这一点？

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2012-08-01T18:49:00.130

find 支持通配符匹配，只需添加一个`*`：

```
find / -type d -name "ora10*" 
```

# ajaxcontroltoolkit - 设置 HTMLEditorExtender 在新窗口中打开链接

> ID：11765538
> 
> 赞同：3
> 
> 时间：2012-08-01T18:43:52.923
> 
> 标签：ajaxcontroltoolkit, htmleditorkit

我正在尝试使用 Ajax Toolkit HTMLEditor（2012 年 6 月发布）来改进用于发布新闻项目和链接（主要是内部资源）的严格内部应用程序。除了我无法让链接创建者创建要在新窗口中打开的链接（基本上带有'target =“_blank”'标签）之外，一切都运行良好。

我已经公开了源代码选项卡并尝试手动将 'target="_blank"' 标记添加到链接中，但这似乎破坏了 HTML 显示，并且我的应用程序显示了原始 HTML 代码而不是呈现的 HTML。如果我使用链接创建器并且不更改它创建的链接，那么一切正常，当然链接会在同一个窗口中打开。消毒剂打开或关闭没有区别。

到目前为止，我还没有发现任何关于如何完成我想要完成的事情的文档。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:34:09.487

好吧，想通了，现在我觉得很愚蠢。所需要的只是使用正则表达式来查找链接模式并将其替换为包含 target="blank" 标记的模式。我只是将扩展文本框生成的文本输入以下函数：

```
Protected Function addLinkTarget(ByVal strText As String) As String
    Dim pattern As String = "(?<start><a[^>]*)(?<end>>)"
    Dim repl As String = "${start} target=""_blank"" ${end}"
    strText = Regex.Replace(strText, pattern, repl)
    Return strText
End Function 
```

或者，在 C# 中

```
protected string addLinkTarget(string strText)
{
    string pattern = "(?<start><a[^>]*)(?<end>>)";
    string repl = "${start} target=\"_blank\" ${end}";
    strText = Regex.Replace(strText, pattern, repl);
    return strText;
} 
```

# javascript - Javascript 代码检查：尝试设置 cookie 时出现令牌错误

> ID：11765542
> 
> 赞同：0
> 
> 时间：2012-08-01T18:44:27.683
> 
> 标签：javascript, cookies

我在页面的头部有这个

```
<script type="text/javascript">
        function makeCookie(name)
        {
            alert("c is for cookie");
            days=30; // number of days to keep the cookie
            var myDate = new Date();
            myDate.setTime(myDate.getTime()+(days*24*60*60*1000));
            expires="myDate.toUTCString();
            document.cookie="pull=" + name;
            alert("c is for cookie");
        }
    </script> 
```

然后是一堆看起来与此类似的列表项：

```
<a href="#tab2" onclick="makeCookie("LastName FirstName")">LastName FirstName</a> 
```

我没有收到警报，也没有设置 cookie。所以我知道我做错了什么。当我在 Chrome 中查看 JavaScript 控制台时，它也给了我令牌错误。所以我猜我在某个地方有一个悬挂支架，但我找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:52:24.410

[JSLint](http://www.jslint.com/)为初学者展示了这个无与伦比的开放式报价：

```
expires = "myDate.toUTCString();
          ^ 
```

此外，您的`onclick`值中的引号是错误的，您应该对内部 JavaScript 引号使用单引号，以避免与 HTML 属性已经存在的双引号产生歧义。

```
<a href="#tab2" onclick="makeCookie("LastName FirstName")">LastName FirstName</a>
                                    ^                  ^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:47:13.183

查看语法突出显示：该`onclick`属性过早关闭，因为您尝试`"`在`"`-delimited 属性中使用。改变这个：

```
<a href="#tab2" onclick="makeCookie("LastName FirstName")">LastName FirstName</a> 
```

对此：

```
<a href="#tab2" onclick="makeCookie('LastName FirstName')">LastName FirstName</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T18:47:32.403

这是因为您使用与`onclick`参数相同类型的引号 to `makeCookie`，所以当您执行 "Lastname.Try:

```
<a href="#tab2" onclick='makeCookie("LastName FirstName")'>LastName FirstName</a> 
```

# javascript - 对于无序列表的水平菜单栏是否可以悬停而不使用 DOCTYPE 标记

> ID：11765543
> 
> 赞同：0
> 
> 时间：2012-08-01T18:44:29.837
> 
> 标签：javascript, html, css, xml

我正在使用 CSS、html、xsl 和 xml 开发水平导航菜单。该站点不使用 DOCTYPE 标记。我尝试将 bt html 页面以不同的方式呈现，例如减小字体大小，显示一些隐藏元素......所以我不能使用 DOCTYPE，因为它会影响现有的。但我想在水平菜单栏上实现悬停。

请提出一种使用 CSS 或 javascript 悬停在菜单栏上的方法。

提前致谢。

# c - 在编译时连接一个链表

> ID：11765547
> 
> 赞同：2
> 
> 时间：2012-08-01T18:45:00.537
> 
> 标签：c, macros, code-generation, constants, compile-time

考虑一个 C 结构，它表示单链表中的一个条目。它包含指向一些任意数据的指针、该数据的大小以及查找下一个条目的方法

```
typedef struct{
  unsigned char *data
  unsigned char dataSize
  unsigned char nextEntry
} Entry; 
```

接下来，考虑以下条目集合及其代表的数据：

```
unsigned char dataA[3];
unsigned char dataB[16];
unsigned char dataC[17];

Entry entryA = {dataA, sizeof(dataA), 3}; //It's important for "3" to match up with the index of entryB once it's put into MasterList below.
Entry entryB = {dataB, sizeof(dataB), 4}; //Likewise
Entry entryC = {dataC, sizeof(dataC), 0}; //0 terminates the linked list
Entry emptyEntry = {(void*)0, 0, 0};

Entry MasterList[8] = {
entryA,     //Index 0 - Contains dataA and points to Index 3 as the next Entry in a linked list
emptyEntry, //Index 1 - Unused (or used for something else)
emptyEntry, //Index 2 - Unused
entryB,     //Index 3 - Contains dataB and points to Index 5 as the next Entry in a linked list
entryC,     //Index 4 - Contains dataC and terminates the linked list
emptyEntry, //Index 5 - Unused
emptyEntry, //Index 6 - Unused
emptyEntry};//Index 7 - Unused 
```

我的问题：你能想出一种在编译时自动计算“nextEntry”值的方法吗？现在，如果有人打乱 MasterList 中条目的顺序或添加一些其他数据并抵消一些条目，则存在巨大的潜在错误。我们通过单元测试或集成测试捕获了所有错误，但不可避免的是，对 MasterList 的任何更改最终都会被检查两次。一次是有人编辑它，第二次是在代码测试失败时修补链表索引。

我最初的直觉是“不，那太愚蠢了”和“你为什么还要试试这个？” 但我过去曾见过一些令人印象深刻的 C-Macro 魔法。我也相信任何宏观魔法都会比上面的更糟糕，但我认为值得一试，对吧？

**澄清**- 我坚持使用 MasterList 数组（而不是正确的链表），因为信息的消费者期望它是这种方式。事实上，那里还有其他不属于需要位于固定索引的链表的信息。然后，最重要的是，有这个链表数据。它是一个链表的原因是使它在添加其他具有固定索引的元素时不会被推来推去。例如，如果我们需要在索引 3 处插入一个特定的字符串，entryB 和 entryC 可能会被推开，但仍然可以从链表头部（固定在索引 0）开始发现走清单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:18:23.573

通过重置和使用行号：

```
#line 0 
#define NUM ( __LINE__ -2)
Entry MasterList[8] =
{ {dataA, sizeof(dataA), NUM }
, {(void*)0, 0, NUM }
, {(void*)0, 0, NUM }
, {dataB, sizeof(dataB), NUM }
, {dataC, sizeof(dataC), NUM }
, {(void*)0, 0, NUM }
, {(void*)0, 0, NUM }
, {(void*)0, 0, NUM }
}; 
```

gcc -E 的输出：

```
# 28 "index.c"
#pragma #line 0 __FILE__
# 1 "index.c"

Entry MasterList[8] =
{ {dataA, sizeof(dataA), ( 2 -2) }
, {(void*)0, 0, ( 3 -2) }
, {(void*)0, 0, ( 4 -2) }
, {dataB, sizeof(dataB), ( 5 -2) }
, {dataC, sizeof(dataC), ( 6 -2) }
, {(void*)0, 0, ( 7 -2) }
, {(void*)0, 0, ( 8 -2) }
, {(void*)0, 0, ( 9 -2) }
}; 
```

应该可以在不重置行号的情况下做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:53:19.157

听起来您应该只使用实际的链表，而不是让每个节点的数据猜测最后一个条目的索引。

您对预处理器的诡计持开放态度，但您通过让运行时访问数据而产生了设计问题，这些数据应该在不应该存在的编译时强制执行。一方面，每个节点都必须拥有它甚至不知道它所在的数组的全局知识。我知道 C 没有 C++/Java/C# 的很多魔力，更不用说 Perl/Python/Ruby 但这是只是一个数据结构问题而不是语言特征问题。

从评论编辑：

```
struct SpecialArray { 
    Entry* entries[10000]; //you'll have to write your own real memory management
    int lastIdx;
};

void addEntry(struct SpecialArray* arr, Entry* entry) {
    arr->entries[arr->lastIdx] = entry;
    entry->nextEntry = arr->lastIdx+1;
    lastIdx++;
} 
```

听起来您实际上需要评论中的 Entry[] 而不是 *Entry[] ，但这可以通过为 Entry 添加深拷贝功能来实现。然后，`(&arr.entries)`只要您的客户端代码需要一个 Entry 数组，您就可以通过。该例程`addEntry`将为您管理索引问题并解决您的原始问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T21:27:15.443

使用编译器或预处理器可用的工具似乎没有真正的好方法。我认为最好的方法是使用代码生成工具来生成已经连接了链表的数组。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-01T19:33:17.247

不要用索引来做，这不值得一点点可能的收益。并且不要使用单独的对象，而是在原地初始化。这是另一个玩具示例，它甚至有`next`指针`const`限定，所以没有人可以乱用它：

```
#include <stddef.h>

typedef struct data data;

struct data {
  char const* D;
  size_t len;
  data*const next;
};

#define STR_INITIALIZER(STR) .D = STR, .len = (sizeof(STR) - 1)
#define DATA_INITIALIZER(NAME, STR, HERE) [HERE] = { STR_INITIALIZER(STR), &(NAME)[HERE+1], }

data table[] = {
  DATA_INITIALIZER(table, "something", 0),
  DATA_INITIALIZER(table, "something else", 1),
  { 0 }
}; 
```

这使用了 C99 的“指定初始化程序”功能，但您可能会提供一个可以不用的版本。

如果您真的希望全部由宏完成，那么您可以使用[P99](http://p99.gforge.inria.fr)进行展开，类似以下内容应该可以使用`"p99_for.h"`（未​​经测试）

```
#define TABLE_ENTRIES(NAME, ...) P99_FOR(NAME, P99_NARG(__VA_ARGS__), P00_SEQ, DATA_INITIALIZER, __VA_ARGS__)

data table[] = {
  TABLE_ENTRIES(table, "something", "something else"),
  { 0 }
}; 
```

# django - Django-voting——一个网页使用两个视图

> ID：11765550
> 
> 赞同：0
> 
> 时间：2012-08-01T18:45:11.450
> 
> 标签：django, django-voting

我有一个页面叫做`view_requests.html`. 页面上的一个选项卡，我基本上希望有一个人们可以投票的对象 reddit 样式列表。我使用`django-voting`.

但是，在第二个选项卡上，我希望能够添加请求。这要求我有一个人们可以提交的表格。

我面临的问题是，为了实现 Reddit 风格的投票，我必须在我的 URLs.py 中使用以下配置（即，不在views.py 中为它创建我自己的视图）。但是要创建一个表单，我需要访问我在views.py 中编写的一些代码。是否可以在不同的选项卡中将两者放在同一页面上，我将如何去做？

```
url(r'^view_requests/?$', object_list, dict(queryset=LibraryRequest.objects.all(),
        template_object_name='request', template_name='spicemodels/view_requests.html',
        paginate_by=15, allow_empty=True), name="view_requests"), 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T20:11:27.770

您不必*使用*它；`object_list`是一个内置的 Django*通用*视图。*Generic 是关键字，因为如果您的视图符合标准*，它只是为了让您更轻松。因为，您需要的视图比`object_list`提供的更多，是时候扔掉它并编写您自己的视图了。您可以将[`object_list`](https://github.com/django/django/blob/1.3.1/django/views/generic/list_detail.py)其用作创建自己的视图的指南，但其中有很多无关的样板代码只是为了使其通用。简单地说，您只需要以下内容：

```
def my_view(request, page=None):
    paginate_by = 15

    qs = LibraryRequest.objects.all()
    paginator = Paginator(qs, paginate_by, allow_empty_first_page=True)
    if not page:
        page = request.GET.get('page', 1)
    try:
        page_number = int(page)
    except ValueError:
        if page == 'last':
            page_number = paginator.num_pages
        else:
            # Page is not 'last', nor can it be converted to an int.
            raise Http404
    try:
        page_obj = paginator.page(page_number)
    except InvalidPage:
        raise Http404

    render_to_response('spicemodels/view_requests.html', {
        'request_list': page_obj.object_list,
        'paginator': paginator,
        'page_obj': page_obj,
        'is_paginated': page_obj.has_other_pages(),
    }, context_instance=RequestContext(request)) 
```

# google-maps - Google Maps v3、反向地理编码和多个信息窗口

> ID：11765553
> 
> 赞同：0
> 
> 时间：2012-08-01T18:45:29.290
> 
> 标签：google-maps, infowindow, reverse-geocoding

我正在研究谷歌地图 v3。在这张地图上，我想显示几个标记，每个标记都有它的信息窗口，其中显示有关该点的一些信息。信息源是一个javascript数组，每个点都有一些数据，在这里一切正常。该数组包含（有时）地址（有时为空）和总是经纬度坐标，所以当地址不存在时，我必须进行反向地理编码。这是我的代码：

```
var geocoder = new google.maps.Geocoder();  
for(var i=0;i<markersArray.length;i++){     
    var la=markersArray[i][0]);
    var lo=markersArray[i][1]);
    gpoint=new google.maps.LatLng( la,lo);
    var aMarker = new MarkerWithLabel({   //part of Google Maps Utility Lib
        position: gpoint,
        map: map,
        labelContent: deviceID,
        labelAnchor: new google.maps.Point(22, 0),
        labelClass: "labelStyle",
        html: "<ul><li>Speed: "+markersArray[i][3]+"</li></ul>",
        address: markersArray[i][4]
    });
    if (aMarker.address<="" || aMarker.address==null) {
        geocoder.geocode({'latLng': gpoint}, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                if (results[1]) {
                    aMarker.address=results[1].formatted_address;
                }
            }
        });
    }    
    google.maps.event.addListener(aMarker, 'click', function () {
        infowindow.setContent(this.html+" "+this.address);
        infowindow.open(map, this);
    });

....
} 
```

几乎一切正常：标记就位，并且所有标记都显示正确的信息窗口和正确的地址，除了那些地址为空且进行反向地理编码的那些。对于这最后一组，只有最后一个标记信息窗口显示正确的地址，所有其他信息窗口地址都是空的。任何想法？很感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:13:17.600

解决此问题的一种方法是创建一个执行反向地理编码的函数，并且可以在信息窗口和标记上具有函数关闭。

由于反向地理编码操作是异步的，因此返回的地址不可用于除最后一个标记之外的任何地址。

# graph - DOT 文件中边缘“pos”属性的含义是什么？

> ID：11765555
> 
> 赞同：3
> 
> 时间：2012-08-01T18:45:31.567
> 
> 标签：graph, matplotlib, graphviz, networkx, pygraphviz

我正在尝试布局一些图表，我正在使用`pygraphviz`它。我建立我的图表，并执行

```
graph.layout(prog='dot') 
```

当我执行`print graph`时，它会吐出 DOT 格式的表示，如下所示：

```
...
94   [height="0.5", pos="1485,18", width="0.75"];
93 -> 94     [pos="e,1485,36.104 1485,71.697 1485,63.983 1485,54.712 1485,46.112"];
98   [height="0.5", pos="1557,18", width="0.75"];
97 -> 98     [pos="e,1557,36.104 1557,71.697 1557,63.983 1557,54.712 1557,46.112"];
... 
```

`pos`对于每个节点，属性的含义非常清楚。但这对边缘意味着什么？我相信它可能以某种方式引用三次样条表示，但是如果我想在 matplotlib 中手动绘制边缘，我将如何使用这些点？

谢谢！乌里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-10-08T04:56:19.670

这个文件：

```
# edge.dot

digraph G {

  A [label = "A"  xlabel="a" pos="0,100" ]
  B [label = "B"  xlabel="b" pos="100,0"]

  A -> B  [label = "A->B www"  xlabel="a->b"]   
 [pos="0,100 0,0 0,0 100,0"]

} 
```

使用neato 运行时绘制曲线边缘：

```
dot -Kneato -n2 -Tpng -O ./edge.dot 
```

编辑： e 代表结束，s 代表箭头位置的开始。以下几点定义了贝塞尔曲线（或者如果不是技术上非常相似的贝塞尔曲线。）

```
 pos="s,15.188,84.812 e,84.997,15.003 22.335,77.665 38.894,61.106 61.363,38.637 77.873,22.127" 
```

[https://web.mit.edu/hyperbook/Patrikalakis-Maekawa-Cho/node12.html#:~:text=A%20B%C3%A9zier%20curve%20is%20a,the%20shape%20of%20the%20curve](https://web.mit.edu/hyperbook/Patrikalakis-Maekawa-Cho/node12.html#:%7E:text=A%20B%C3%A9zier%20curve%20is%20a,the%20shape%20of%20the%20curve) .

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-08-01T22:33:34.420

答案在这里： [http ://www.graphviz.org/doc/info/attrs.html#k:splineType](http://www.graphviz.org/doc/info/attrs.html#k:splineType)

# webfonts - 使用 CNAME 重定向 URL 后，Webfonts 不再工作

> ID：11765556
> 
> 赞同：0
> 
> 时间：2012-08-01T18:45:35.247
> 
> 标签：webfonts, cname, google-webfonts

在 chrome 中运行： [www.AshGavs.com](http://www.ashgavs.com) 与 [http://ashgavs.cloudant.com/site/_design/AshGavsCouch/main/index.html](http://ashgavs.cloudant.com/site/_design/AshGavsCouch/main/index.html)

真的很混乱，特别是因为字体托管在谷歌上......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:48:24.390

哦。跨域错误。我只是为我的字体文件列出了“/fonts.css”，所以我认为该文件将指向“AshGavs.com/fonts.css”。

# android - 如何在android中对两个图像进行异或？

> ID：11765564
> 
> 赞同：0
> 
> 时间：2012-08-01T18:46:15.187
> 
> 标签：android, android-layout, android-intent, xor

我想在android中对两个图像进行异或，因为我正在开发图像加密应用程序，我从SD卡中获取图像并将它们加载到图像视图中，因为我已经加载了两个我想对它们进行异或的图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T12:23:11.070

另一种选择是在`Canvas`你的两个位图上绘制。一个位图没有指定任何设置，但另一个应该在他的对象中指定一个`PorterDuffXfermode`to 。`Mode.XOR``Paint`

前任：

```
ImageView compositeImageView = (ImageView) findViewById(R.id.imageView);

Bitmap bitmap1=BitmapFactory.decodeResource(getResources(), R.drawable.batman_ad);
Bitmap bitmap2=BitmapFactory.decodeResource(getResources(), R.drawable.logo);

Bitmap resultingImage=Bitmap.createBitmap(bitmap1.getWidth(), bitmap1.getHeight(), bitmap1.getConfig());

Canvas canvas = new Canvas(resultingImage);

// Drawing first image on Canvas
Paint paint = new Paint();
canvas.drawBitmap(bitmap1, 0, 0, paint);

// Drawing second image on the Canvas, with Xfermode set to XOR
paint.setXfermode(new PorterDuffXfermode(Mode.XOR));
canvas.drawBitmap(bitmap2, 0, 0, paint);

compositeImageView.setImageBitmap(resultingImage); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:10:36.073

这取决于您想要异或，像素或数据本身。任何一种简单的方法是将图像转换为所有像素的数组，将它们异或在一起，然后将其转换回位图。请注意，此示例仅适用于具有相同分辨率的位图。

```
//convert the first bitmap to array of ints
int[] buffer1 = new int[bmp1.getWidth()*bmp1.getHeight()];
bmp1.getPixels(buffer1,0,bmp1.getWidth(),0,0,bmp1.getWidth(),bmp1.getHeight() );

//convert the seconds bitmap to array of ints
int[] buffer2 = new int[bmp2.getWidth()*bmp2.getHeight()];
bmp2.getPixels(buffer2,0,bmp2.getWidth(),0,0,bmp2.getWidth(),bmp2.getHeight() );

//XOR all the elements
for( int i = 0 ; i < bmp1.getWidth()*bmp1.getHeight() ; i++ )
    buffer1[i] = buffer1[i] ^ buffer2[i];

//convert it back to a bitmap, you could also create a new bitmap in case you need them
//for some thing else
bmp1.setPixels(buffer1,0,bmp1.getWidth(),0,0,bmp2.getWidth(),bmp2.getHeight() ); 
```

见：http: [//developer.android.com/reference/android/graphics/Bitmap.html](http://developer.android.com/reference/android/graphics/Bitmap.html)

# css - CSS可以用精灵图像的1px区域填充元素的背景吗？

> ID：11765565
> 
> 赞同：1
> 
> 时间：2012-08-01T18:46:16.937
> 
> 标签：css, sprite

我喜欢精灵，但是它们对我的整体需求非常有帮助。我试图弄清楚是否有一种方法可以使用精灵图像作为 100% 宽的元素的背景图像，但我要应用的精灵的背景部分是 1px 宽。精灵目前是 100px 宽和大约 180px 高。这甚至可能/合法吗？如果是这样，我会怎么做？或者我是否必须坚持独立于精灵的 1px x 120px 图像的想法，以按照我想要的方式在给定元素上跨越背景？

请注意，我曾考虑将精灵的 0 0 位置作为我想要的 BG，但我的问题是我有类似的精灵部分我想用作某些区域的翻转效果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:49:06.017

对于重复的背景图像，您需要使用独立于精灵的图像；因为据我所知，没有办法指定精灵的特定片段在背景中重复，所以你最终会简单地显示和重复整个精灵。

看来，当然在 Chromium 19 中，使用[`background-size`不是答案](http://jsfiddle.net/davidThomas/uFtCZ/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:51:06.353

我认为您可以通过伪背景裁剪来实现这一点。这里有一篇有用的文章：http: [//nicolasgallagher.com/css-background-image-hacks/](http://nicolasgallagher.com/css-background-image-hacks/)可能会有所帮助。

但是，我怀疑这可以用作重复的背景图像。您也许可以拉伸它（`background-size:100%`），但我不确定。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-07-20T08:13:43.930

所以它使 3 个 div 放置在一个 div 中。对于左右，像往常一样剪辑你的精灵。对于中间，使您的精灵足够长，以便按钮的任何中间部分都被精灵的长部分填充。

永远不要问问题，发挥你的想象力。

# c# - 在下拉列表中设置选定值

> ID：11765573
> 
> 赞同：3
> 
> 时间：2012-08-01T18:47:27.570
> 
> 标签：c#, asp.net-mvc-3, razor

如何在下拉列表中设置选定的值？这是我到目前为止所拥有的：

```
@model Web.Models.PostGraduateModels.PlannedSpecialty

@Html.DropDownList("PlannedSpecialtyID")

//controller
        [HttpGet]
        public PartialViewResult PlannedSpecialty()
        {

            // Get Planned Specialty ID
            var pgtservice = new PgtService();
            PostGraduateModels.PlannedSpecialty plannedSpecialty = pgtservice.GetPlannedSpecialtyId();

           // Get Data for Planned Specialty DropDown List from SpecialtyLookup
            var pgtServ = new PgtService();
            var items = pgtServ.GetPlannedSpecialtyDropDownItems();
            ViewBag.PlannedSpecialtyId = items;

            return PartialView(plannedSpecialty);

        }

// service
        public IEnumerable<SelectListItem> GetPlannedSpecialtyDropDownItems ()
        {
            using (var db = Step3Provider.CreateInstance())
            {
                var specialtyList = db.GetPlannedSpecialtyDdlItems();

                return specialtyList;

            }

        }

// data access
        public IEnumerable<SelectListItem> GetPlannedSpecialtyDdlItems()
       {

            IEnumerable<Specialty> specialties = this._context.Specialties().GetAll();
            var selList = new List<SelectListItem>();

            foreach (var item in specialties)
            {
                var tempps = new SelectListItem()
                    {
                        Text = item.Description,
                        Value  = item.Id.ToString()
                    };
                selList.Add(tempps);
            }

            return selList;
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:03:09.853

我建议您避免使用 ViewBag/ViewData/ Weekly 类型的代码。使用强类型代码，它使代码更具可读性。不要使用魔术字符串/魔术变量。我会向您的 ViewModel 添加一个集合属性来保存 SelectList 项，并添加另一个属性来保存选定的项值。

```
public class PlannedSpecialty
{
   public IEnumerable<SelectListItem> SpecialtyItems { set;get;}
   public int SelectedSpeciality { set;get;}

  //Other Properties
} 
```

在您的 Get 操作中，如果您想将某些项目设置为选中状态，

```
public PartialViewResult PlannedSpecialty()
{ 
    var pgtServ = new PgtService();
    var vm=new PlannedSpecialty();
    vm.SpecialtyItems = pgtServ.GetPlannedSpecialtyDropDownItems();    

   //just hard coding for demo. you may get the value from some source.  
    vm.SelectedSpeciality=25;//  here you are setting the selected value.
   return View(vm);
} 
```

现在在视图中，使用`Html.DropDownListFor`辅助方法

```
@Html.DropDownListFor(x=>x.SelectedSpeciality,Model.SpecialtyItems,"select one ") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:52:31.027

使用 SelectListItem 类的 selected 属性：

```
selList.Selected = true; 
```

# c++ - C++重载新问题

> ID：11765577
> 
> 赞同：-1
> 
> 时间：2012-08-01T18:48:01.037
> 
> 标签：c++, overloading, operator-keyword

我制作了一个小机制来替换常规的 new 运算符。基本上，我们分配一个内存池（如 16mb），当调用 new 时，返回一个偏移量，该偏移量会增长直到没有更多空间，然后我们再创建一个池。只有当池中的所有元素都被释放时，池才会被删除。

我已经测试过这个类，它工作得很好，比原来的新类快 8-15 倍。但是有一个问题：我将它合并到我的另一个规模巨大的项目中，它正常工作，除了内存使用量增长非常快。基本上不会释放池，因为其中的某些项目根本没有被删除。此外，还有许多从 STL 容器对 new(0) 的调用，我不知道它应该如何响应。

这是代码：

```
namespace rt
{
      class pool
      {
            friend class alloc;
            private:
                    unsigned int _numRecords;
                    unsigned int _sizeLeft;
                    char*        _ptr;
                    char*        _data;

      };

      class alloc
      {
            public:
                   alloc();

                   alloc(int mb);

                   ~alloc();

                   void* allocate(unsigned int size);

                   void constructPool(unsigned int idx);

                   void destroyPool(unsigned int idx);

                   void deallocate(void* ptr);

            private:
                    const static unsigned int           _numPools = 256;
                    const static unsigned int           _poolSize = 15*1024*1024;
                    const static unsigned int           _poolReplaceBound = 1*1024*1024; // if 1mb or less left we can replace it
                    pool*                               _pools[_numPools];
                    unsigned int                        _curPoolIdx;

      }; 
```

那是标题。这是实现：

```
namespace rt
{
          class pool
          {
                friend class alloc;
                private:
                        unsigned int _numRecords;
                        unsigned int _sizeLeft;
                        char*        _ptr;
                        char*        _data;

          };

      class alloc
      {
            public:
                   alloc();

                   alloc(int mb);

                   ~alloc();

                   void* allocate(unsigned int size);

                   void constructPool(unsigned int idx);

                   void destroyPool(unsigned int idx);

                   void deallocate(void* ptr);

            private:
                    const static unsigned int           _numPools = 256;
                    const static unsigned int           _poolSize = 15*1024*1024;
                    const static unsigned int           _poolReplaceBound = 1*1024*1024; // if 1mb or less left we can replace it
                    pool*                               _pools[_numPools];
                    unsigned int                        _curPoolIdx;

      };          

      extern alloc default_allocator;
}

#define RT_SAFE_MEM
namespace rt
{
      alloc default_allocator;

      alloc::alloc() 
      {
                     for(int i = 0; i < _numPools; i++) _pools[i] = NULL;
                     _curPoolIdx = 0;
                     constructPool(_curPoolIdx);
      }

      alloc::~alloc()
      {

      }

      void alloc::constructPool(unsigned int idx)
      {
                                    _pools[idx] = (pool*)malloc(sizeof(pool));
                                    _pools[idx]->_numRecords = 0;
                                    _pools[idx]->_sizeLeft = _poolSize;
                                    _pools[idx]->_data = (char*)calloc(_poolSize, 1);

                                    _pools[idx]->_ptr = _pools[idx]->_data; 
      }

      void alloc::destroyPool(unsigned int idx)
      {
           free(_pools[idx]->_data);
           free(_pools[idx]);
           _pools[idx] = NULL;
      }

      void* alloc::allocate(unsigned int size)
      {
            if(size == 0)
            {
                    return NULL;
            }
            #ifdef RT_SAFE_MEM

                                  if(size > _poolSize) 
                                  {
                                          MessageBox(NULL, "Allocation size exceeded maximum.", "Executor", MB_OK);
                                          return NULL;
                                  }
                                  if(*(_pools[_curPoolIdx]->_ptr) != 0)
                                  {
                                                                  //leak
                                                                  unsigned int leaksize = strlen(_pools[_curPoolIdx]->_ptr);
                                                                  char str[50];
                                                                  sprintf(str, "Memory corruption detected: wrote extra %u bytes. \nExporting to corrupt.txt", leaksize);
                                                                  FILE* fp = fopen("corrupt.txt", "w");
                                                                  fwrite(_pools[_curPoolIdx]->_ptr, 1, leaksize, fp);
                                                                  fclose(fp);
                                                                  MessageBox(NULL, str, "Executor", MB_OK);
                                                                  return NULL;
                                  }

            #endif

            if(_pools[_curPoolIdx]->_sizeLeft <= size)
            {
                                              //not enough size in this pool
                                              //make a new one
                                              _curPoolIdx++;
                                              //printf("expand");
                                              constructPool(_curPoolIdx);
                                              return allocate(size);

            }
            else
            {
                void* ans = (void*)_pools[_curPoolIdx]->_ptr;
                _pools[_curPoolIdx]->_ptr+=size;
                _pools[_curPoolIdx]->_sizeLeft-=size;
                _pools[_curPoolIdx]->_numRecords++;
                return ans;
            }
      }

      void alloc::deallocate(void* ptr)
      {
           for(int i = 0; i <= _curPoolIdx; i++)
           {
                   if(ptr >= _pools[i]->_data && ptr < _pools[i]->_ptr)
                   { 
                          //pool i contains this object
                          //printf("found %d\n", i); 
                          _pools[i]->_numRecords--;
                          if(_pools[i]->_numRecords == 0 && _pools[i]->_sizeLeft <= _poolReplaceBound)
                          {
                                                    //replace this pool
                                                    printf("replacing %d\n", i);
                                                    destroyPool(i);
                                                    if(_curPoolIdx == 0) constructPool(0);
                                                    else
                                                    {
                                                        for(int j = i; j < _numPools-1; j++)
                                                        {
                                                                _pools[j] = _pools[j+1];
                                                        } 
                                                        _curPoolIdx--;
                                                    }

                          }
                          return;
                   }
           }
           #ifdef RT_SAFE_MEM
                  char str[50];
                  sprintf(str,  "Attempted to deallocate foreign memory at 0x%.8X.", ptr);
                  MessageBox(NULL, str, "Executor", MB_OK);
           #endif
      } 
```

}

如果有人发现错误或重大问题，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:51:00.917

我建议您执行以下**所有**步骤：

1.  编写一个测试程序来测试您的程序是否运行无错误或“有任何问题”
2.  使用调试器来查找错误，而不是 SO 的受众 :-P
3.  与其发布完整的代码列表，不如写下代码的作用——这将为您提供一个**很好的**参考点，同时也将为您的代码做什么（以及如何）提供有用的文档

# sql - 如何编写存储过程以使用函数选择特定列

> ID：11765580
> 
> 赞同：0
> 
> 时间：2012-08-01T18:48:11.357
> 
> 标签：sql, sql-server-2008, stored-procedures

我有两张桌子

```
tblSTATUS
   StatusID|PlanID|Description|EmailSubject|EmailFrom|EmailTo||Comment
     1        8    Approved                                aaa
     2        7    Rejected                                bbb
     3        7    Rejected                                ccc
     4        42   Rejected                                ccc

tblSTATUSREASON
     PlanID|REASONS 
       7      failed
       7      not eligible
       42     not eligible 
```

当我向特定的人发送电子邮件时，如果他们的计划（仅）被拒绝，它会将拒绝`tblstatusreason`的原因和使用的 PlanID 存储在表中，这取决于`tblStatus`.

我应该使用存储过程在网格视图 C# 代码中检索 evrything 并根据描述向用户显示它。

现在我的问题是我可以检索和显示所有其他列，但我不知道如何显示 rReasons 所以我想在`select [REASONS] from tblSTATUSREASON`哪里为那个`description = rejected from tblSTATUS`特别的，我也不想更改我的表/列。我需要 sql 存储过程来处理这个特定的事情

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:56:08.747

你还需要在哪里

```
select R.PlanID,REASONS
FROM tblSTATUSREASON R
INNER JOIN tblSTATUS S
ON R.PlanID = S.PlanID
AND description = 'rejected' 
```

# php - Linux Server PHP 更新回滚

> ID：11765583
> 
> 赞同：5
> 
> 时间：2012-08-01T18:48:35.793
> 
> 标签：php, ssh, upgrade, plesk, dedicated-server

我有一个专用服务器，它托管了许多当前运行 PHP 5.2 的网站。我需要升级 PHP 版本，有人告诉我可以使用以下命令通过 SSH 执行此操作：

百胜升级php

不，我有点担心进行更新和网站无法再运行，所以有没有我可以使用的回滚命令，以便如果出现问题，我可以快速改回 PHP 5.2？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:16:56.857

你最好先知道从 php 5.2 到 php 5.3 有什么变化，如果你认为这些变化不会影响你的脚本，然后升级，如果没有，然后继续使用 php 5.2 或先在你的脚本中进行必要的更改（个人我建议您升级到 PHP 5.3) ，这里是[从 PHP 5.2 迁移到 5.3的更改列表](http://www.php.net/manual/en/migration53.incompatible.php)

如果您在升级后遇到一些问题，请检查软件包存储库中是否仍然存在 php 5.2（使用命令“yum search php”），如果存在则删除您获得的当前 PHP（命令“yum remove php”）然后安装你找到的包（例如：“yum install php-5.2”）

注意：如果您在存储库中没有找到 PHP 5.2 包，您可能需要从源代码编译 PHP 5.2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:50:19.100

您可以自己备份旧的 php 版本，但我不推荐这样做。通常只有 phpize、php.ini、php.so 和 php 模块文件夹。然后你就可以进行更新了。

# xcode - Xcode 4.4 - 反复按“继续”以通过每个断点

> ID：11765586
> 
> 赞同：1
> 
> 时间：2012-08-01T18:48:42.650
> 
> 标签：xcode

Xcode 4.4 (Mountain Lion) 中有一些新的奇怪行为，我希望有人知道如何解决。

每次我设置断点时，当调试器到达该断点并暂停时，我必须按“继续”5-10 次才能真正越过断点。

现在，它似乎实际上并没有拒绝对前 9 次点击执行任何操作。相反，（这很关键）虽然**这部分的粗体是您的代码**行根本没有改变，但苹果内部调度线程确实发生了变化。

例如：

![在此处输入图像描述](../Images/de6997641a368a1a10a028652434d827.png)

就好像“继续”操作通过一堆苹果内部调用继续深入，这些调用存在于调用断点的最后一段*代码*和调用断点*之间*。

无论如何，它使使用断点成为不可能，因为我实际上无法跟踪程序执行，并且每次构建都单击了 100 次。4.4 中的新功能！

有人经历过吗？关于如何解决的任何想法？

# perl - 如何根据内容删除数组中的元素？

> ID：11765590
> 
> 赞同：0
> 
> 时间：2012-08-01T18:49:00.270
> 
> 标签：perl, mongodb

我正在使用 MongoDB 和 Perl。这是我的数据结构：

```
{
    "_id" : ObjectId("501976f8005c8b541d000000"),
    "err_id" : "err",
    "solution" : [
        {
            "attachment" : "attach",
            "macr" : "macrs",
            "yammer" : "yam",
            "resolution" : "l",
            "salesforce" : "salesforce",
            "username" : "bob"
        },
        {
            "attachment" : "attach",
            "macr" : "macrs",
            "yammer" : "yam",
            "resolution" : "losssss",
            "salesforce" : "salesforce",
            "username" : "bob"
        }
    ]
} 
```

正如你所看到的，我有一个里面有对象的数组。我使用 Perl MongoDB 库创建了它。

我熟悉一些在 Perl MongoDB 库中操作数组的语法。例如，我使用它来查找用户名与`$username`.

```
$users->find({"solution.username" => $username}); 
```

我认为删除一个元素会很简单：

```
$users->remove({"solution.username" => $username}); 
```

但很可惜，事实并非如此。我试过这个并使用拉，但无济于事！我很难找到这个。有人知道根据其中一个字段的内容删除数组元素的语法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T07:07:25.793

MongoDB::Collection [remove()](http://search.cpan.org/dist/MongoDB/lib/MongoDB/Collection.pm#remove_%28%24query?,_%24options?%29)方法将**删除**与您的查询匹配的文档..所以绝对不是您要查找的内容。

要删除特定字段，您应该使用[$unset](http://www.mongodb.org/display/DOCS/Updating/#Updating-%24unset)。

您的 solution.usernames 实际上是在一个数组中，因此您必须为要删除的字段包含一个数组索引，例如：

```
$users->update({"_id" => '123'}, {
   '$unset' => {
       'solution.0.username' => 1,
       'solution.1.username' => 1
   }
}); 
```

我不知道取消设置数组中匹配`username`的所有字段的更短语法，但您可以向命令添加多个字段。`solution``solution.#.username``$unset`

我上面的示例从数组中删除了前两个用户名条目。如果匹配的文档有两个以上的用户名条目，则每次运行此更新时，您最多会删除两个以上的条目（如果它们存在）。

# linq - 请求 Linq 表达式

> ID：11765595
> 
> 赞同：0
> 
> 时间：2012-08-01T18:49:22.927
> 
> 标签：linq

假设我有包含这两条记录的对象列表：

EmployeeId - 类别 - 金额

1 - T - 150

1 - D - 300

我想要在决赛中得到的结果看起来是这样的：

EmployeeId - TAmount - DAmount

1 - 150 - 300

我如何使用 LINQ 来实现这一点，我只是看不到如何在我的 EmployeeId 字段上使用简单的 group by 来做到这一点......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T18:55:37.693

```
var employeeId = 1;
var query =
    from row in table
    group row by row.EmployeeId into g
    where g.Key == employeeId
    select new
    {
        EmployeeId = row.Key,
        TAmount = g.SingleOrDefault(r => r.Categpry == "T"),
        DAmount = g.SingleOrDefault(r => r.Categpry == "D"),
    }; 
```

# java - 在位图周围绘制渐变透明圆圈

> ID：11765596
> 
> 赞同：0
> 
> 时间：2012-08-01T18:49:23.490
> 
> 标签：java, android, bitmap

我从文件中得到了一个位图，我需要能够在它周围绘制一个渐变（逐渐变得更加透明）。我该怎么办？我环顾四周，找不到太多。

指向正确的方向会有所帮助，谢谢。

-编辑-

我想以编程方式执行此操作，例如使用位图类和画布。

我画了一张图来说明我的问题。（仍然坚持这个）：http: [//imgur.com/zfDOC](http://imgur.com/zfDOC)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:52:30.833

您可以在 xml 中执行此操作。

```
<?xml version="1.0" encoding="UTF-8"?>

<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item>
        <shape android:shape="rectangle" >

            <!-- end colour at top, start colour at bottom -->
            <!-- Your colors can include hex alpha values --> 
            <!-- #ff000000 is fully transparent black -->
            <!-- #00000000 is non transparent black -->
            <!-- There are more options in that link to control the gradient more -->
            <gradient
                android:type="radial"
                android:endColor="@color/endColor" 
                android:startColor="@color/startColor"/>

        </shape>

    </item>

    <!-- top, bottom left and right adds padding -->
    <item android:bottom="3px">
        <Bitmap src="@drawable/yourBitmap />
    </item>
</layer-list> 
```

这是一个很好的链接，其中包含有关 xml drawable 的更多信息。 [http://idunnolol.com/android/drawables.html](http://idunnolol.com/android/drawables.html)

# java-me - 如何结合 J2me 波兰语创建 J2me(java)Project

> ID：11765598
> 
> 赞同：0
> 
> 时间：2012-08-01T18:49:25.460
> 
> 标签：java-me, j2mepolish, midp-2.0

Hiii 我是 J2me 应用程序的新手，我需要在我的 j2me (java)MIDP 编程中开发标签创建，我通过 google 了解到，j2me Polish 是创建标签的更好选择，我想将 LCDUI 列表屏幕附加到 j2me波兰的Tab1和Tab2等......

可以将这两者混合在一起的任何一个示例程序，我不在我的应用程序中创建 css 文件的位置以及如何将 MIDP 程序与 j2me 抛光相结合，我在谷歌中搜索了示例程序，但我无法获得示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T12:42:21.120

您不能在波兰选项卡式窗格中添加 LCDUI 列表。

为了更好地了解如何将您的屏幕从 LCDUI 更改为波兰语，请阅读[http://www.enough.de/products/j2me-polish/documentation/tutorial/上提供的教程](http://www.enough.de/products/j2me-polish/documentation/tutorial/)

# iphone - 向 iOS 应用程序添加 Flury

> ID：11765599
> 
> 赞同：0
> 
> 时间：2012-08-01T18:49:29.520
> 
> 标签：iphone, ios, xcode, flurry

1.  在查找器中，将 FlurryAnalytics/ 拖到项目的文件夹中。（注意：如果您要升级 Flurry iOS SDK，请务必在继续之前从项目文件夹中删除所有现有的 Flurry 库文件夹。）
2.  现在将其添加到您的项目中：文件 > 将文件添加到“您的项目” ... > FlurryAnalytics
    *   目的地：选择将项目复制到目的地组的文件夹（如果需要） ￼￼

    *   文件夹：选择“为任何添加的文件夹创建组”

**- 添加到目标：选择库将用于的所有目标**

1.  在您的应用程序委托中：
    *   导入 FlurryAnalytics 并在 "applicationDidFinishLaunching:" 中添加：[FlurryAnalytics startSession:@"YOUR_API_KEY"];

对于上面的粗体步骤，您究竟需要做什么？我正在使用 xcode 4.3.3 你在哪里做那一步？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:23:21.433

这意味着将 FlurryAnalytics 库拖到左侧的 Xcode 项目视图中，当它询问您是否要复制或引用它时，您应该...

1.  复制它

2.  确保所有构建目标的名称旁边都有一个复选标记。

编辑：这是构建目标的技术性、无趣的定义[http://developer.apple.com/library/mac/#featuredarticles/XcodeConcepts/Concept-Targets.html](http://developer.apple.com/library/mac/#featuredarticles/XcodeConcepts/Concept-Targets.html)。有时创建多个目标很有用。如果您不知道它们是什么，那么您可能只有一个目标而不必担心。

# java - Tomcat 尝试在 RESTful Spring MVC 服务中解析 JSP 文件

> ID：11765606
> 
> 赞同：1
> 
> 时间：2012-08-01T18:49:58.980
> 
> 标签：java, spring, model-view-controller, jsp, tomcat

我正在使用 Spring MVC 创建一个 RESTful 服务，使用 @Controller 和 @RequestMapping 注释来控制响应。我也使用 Maven 作为依赖管理系统。

在一个函数中，我在 @RequestMapping 中使用 URI 模板从 GET 请求中检索变量。此函数在完成时返回 JSON。

由于使用 URI 模板导致 JSTL 库出现问题（本质上，由于带有 JSTL 类的 ClassNotFoundException，我得到了 500 个状态代码），我不得不将以下依赖项添加到我的 Maven POM 文件中（这些来自我们的私有存储库，但您应该能够理解它们是什么）：

```
<dependency>
  <groupId>javax.servlet.jsp.jstl</groupId>
  <artifactId>jstl-api</artifactId>
  <version>1.2-rev-1</version>
</dependency>
<dependency>
  <groupId>javax.el</groupId>
  <artifactId>el-api</artifactId>
  <version>2.2</version>
</dependency> 
```

但是，由于添加了这些，我现在得到 404 错误，因为 Tomcat（在 Spring 下处理请求）正在尝试解析我的 URI，这通常是

localhost:9095/DiagnosticToolService/demo-object/1/json （当然 1 是我的 GET 变量）

到一个文件，特别是

本地主机：9095/DiagnosticToolService/WEB-INF/jsp/demo-object/1/json.jsp

当然，这个文件不存在。如何在 Tomcat 中关闭此自动 JSP 解析以使其正常工作？另外，那些是我需要添加来修复 500 错误的依赖项吗？500 错误和 404 错误如下所示：

[![500 错误](../Images/cc7baa11f2a26e36a516423553159669.png)](https://i.stack.imgur.com/Rtrgf.png) 500 错误

[![404错误](../Images/363f093f9764b8d0a0aba39a1bc945fa.png)](https://i.stack.imgur.com/KdEhX.png) 404错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T13:17:08.770

您是否在生成 JSON 的控制器方法上使用 @ResponseBody？从问题的描述来看，请求似乎没有发送到您的控制器，或者控制器的返回值被解释为视图名称。

您可以仅将方法签名发布在控制器上使用的映射吗？

# java - Java 是否存在通用或“胖”类文件？

> ID：11765609
> 
> 赞同：8
> 
> 时间：2012-08-01T18:50:21.133
> 
> 标签：java, android, dalvik, fat-binaries

[胖二进制文件](http://en.wikipedia.org/wiki/Fat_binary)是可以在多个架构上运行的二进制文件。基本上，它由一个程序编译两次，每个架构编译一次，然后写入同一个文件。最著名的例子可能是 Apple 的“通用”二进制文件，它允许为 Intel 和 Power PC 架构编译程序，并从同一个可执行文件运行。

这对 Java 来说从来都不是问题，因为 Java 在 JVM 上运行，允许它在任何支持 JVM 的计算机上运行。但是，Android现在很流行，而且Android的VM（Dalvik），不兼容JVM。是否有某种方法可以将代码编译两次，并创建一个可以由 JVM 和 Dalvik 执行的类文件？如果没有，这甚至可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T01:16:47.107

**回答：** *是的。*

您可以创建一个`.jar`包含 JVM 友好`.class`文件和 Android 友好文件的通用`classes.dex`文件。如果您使用命令行选项`dx`，Android SDK 中包含的工具将发出此类文件。`--keep-classes`

请注意，尽管此类`.jar`文件可以在 JVM 和 Android 上使用，但以这种方式打包代码并不是很有用。Android 应用程序打包为`.apk`包含 Android 清单 XML 文件的文件。`Activity`他们使用JVM 上不可用的特定于 Android 的 API 。

`.jar`如果您想对库进行运行时类加载，通用文件将非常有用。

# python - Django 表单，覆盖初始化，变量范围

> ID：11765610
> 
> 赞同：1
> 
> 时间：2012-08-01T18:50:25.927
> 
> 标签：python, django, forms, scope

在 django 中，我从视图中调用了一个表单，它传递了一个在表单 init 中弹出的额外对象。我想在 init 之外的 clean def 中使用这个对象数据（人）。如何修复此传递信息的范围？谢谢！

```
class RegForm(forms.Form):
    first = forms.CharField(min_length=5)

    def __init__(self, *args, **kwargs):
        person = kwargs.pop("person")
        super(CompleteRegistrationForm, self).__init__(*args, **kwargs)

    def clean_first(self):
        if not self.cleaned_data['first'] == person.first:
            raise forms.ValidationError(_("This information does not match records."))
        else:
            return self.cleaned_data['first'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:52:46.273

`person`应该是一个实例变量：

```
def __init__(self, *args, **kwargs):
    self.person = kwargs.pop("person")
    super(CompleteRegistrationForm, self).__init__(*args, **kwargs) 
```

然后，在其他方法中，将其称为`self.person`（不仅仅是`person`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:53:04.457

您应该将其分配给`self`：

```
self.person = kwargs.pop("person") 
```

这是相当基本的 Python - 你可能会从教程中受益。

# ruby-on-rails - Rails 教程演示应用程序中的 ExecJS::ProgramError

> ID：11765611
> 
> 赞同：1
> 
> 时间：2012-08-01T18:50:30.910
> 
> 标签：ruby-on-rails, railstutorial.org

我正在关注[http://ruby.railstutorial.org/chapters/a-demo-app#sec:planning_the_application](http://ruby.railstutorial.org/chapters/a-demo-app#sec:planning_the_application)上的演示应用教程。为用户生成脚手架后。当我尝试访问 localhost:3000/users 时。我在 ExecJS 上收到以下错误

```
Started GET "/users" for 127.0.0.1 at 2012-08-01 13:35:37 -0500
Connecting to database specified by database.yml
Processing by UsersController#index as HTML
User Load (0.1ms)  SELECT "users".* FROM "users" 
Rendered users/index.html.erb within layouts/application (3.1ms)
Completed 500 Internal Server Error in 458ms

ActionView::Template::Error (ExecJS::ProgramError
(in /Users/kylec/apps/demo_app/app/assets/javascripts/users.js.coffee)):
3: <head>
4:   <title>DemoApp</title>
5:   <%= stylesheet_link_tag    "application", :media => "all" %>
6:   <%= javascript_include_tag "application" %>
7:   <%= csrf_meta_tags %>
8: </head>
9: <body>
app/views/layouts/application.html.erb:6:in    `_app_views_layouts_application_html_erb___642905557_18993590'
app/controllers/users_controller.rb:7:in `index' 
```

如果我取出 #line 6 <%= javascript_include_tag "application"%> 我正在运行 ruby​​ 1.9.3、rails 3.2.7、osx 10.5.8，则页面呈现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T16:54:35.207

您需要查看您的 Gemfile。找到这一行并取消注释。

```
# See https://github.com/sstephenson/execjs#readme for more supported runtimes
# gem 'therubyracer', :platforms => :ruby 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-12T11:45:16.190

我遇到过类似的问题。我已经安装了 node.js 并添加了 ruby​​ 的路径，它工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-24T08:26:21.870

就我而言 [，这是解决方案：](https://stackoverflow.com/questions/28421547/rails-execjsprogramerror-in-pageshome#comment46410989_28436913) 我刚刚修改了 gemfile 将咖啡脚本源降级到 1.8.0，瞧！这是我的宝石文件：

```
# Use CoffeeScript for .coffee assets and views
gem 'coffee-rails', '~> 4.1.0'

# Downgrade coffee-script source
gem 'coffee-script-source', '~>1.8.0'

# See https://github.com/rails/execjs#readme for more supported runtimes
# gem 'therubyracer', platforms: :ruby
# Use jquery as the JavaScript library
gem 'jquery-rails' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-19T11:43:31.337

对于 Windows：

在 /app/views/layouts/application.html.erb 第 5 行和第 6 行中，将第一个参数 application 更改为默认值。

我也遇到了同样的问题

它对我有帮助：将“应用程序”更改为“默认”

我的代码：

```
 <!DOCTYPE html>
<html>
<head>
  <title>AppSample</title>
  <%= stylesheet_link_tag    'default', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'default', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>

<%= yield %>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-21T03:38:21.727

如果您在 Windows 上工作，这绝对有效：

在 /app/views/layouts/application.html.erb 第 5 行和第 6 行中，将第一个参数 application 更改为默认值。

对于我的情况，我也遇到了同样的问题，我不知道为什么，但它只发生在 Windows 上。参数应用程序在 Web 服务器上工作。

# ruby-on-rails - 从 Activerecord 对象中删除索引而不是从数据库中

> ID：11765612
> 
> 赞同：2
> 
> 时间：2012-08-01T18:50:34.383
> 
> 标签：ruby-on-rails, activerecord

我必须从数据库中获取记录，经过一些验证后，如果自定义验证失败，我必须从对象中删除记录。

@posts = Post.all

在进行了一些业务逻辑验证之后，我不想只在 @posts 对象中保留 id 为 1 的帖子我如何才能从 @posts 对象中删除该帖子，而不是从数据库中删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:26:27.693

如果您确实想仅从 activerecord 结果数组而不是数据库中删除记录，请尝试此操作

```
#first convert the @post to array

@post.to_a.delete_if{|post| post.id == 1 } 
```

这将删除 id = 1 的帖子（仅来自数组而不是数据库）

或者

```
#pass the object to delete

post = @post.first
@post.to_a.delete(post) 
```

这将删除匹配的帖子（仅来自数组而不是数据库）

您也可以使用 Array#reject 但这会创建一个新数组，所以我使用上述解决方案。

+1的问题:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T18:59:45.687

您可以使用选择方法：

```
@posts.select do |post| 
  post.id == 1 
  #or any custom validation that returns true in case you want to keep the record 
end 
```

# ios - 包装的 CATextLayer 中的字符被部分截断

> ID：11765613
> 
> 赞同：2
> 
> 时间：2012-08-01T18:50:35.860
> 
> 标签：ios, core-text, catextlayer

我有这段代码可以创建一个 CATextLayer 并将其绘制到 UIView 上：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    CGRect viewRect = CGRectMake(50.0f, 50.0f, 345.0f, 120.0f);

    CATextLayer *textLayer = [CATextLayer layer];
    textLayer.contentsScale = [[UIScreen mainScreen] scale];
    textLayer.wrapped = YES;
    textLayer.truncationMode = kCATruncationNone;
    UIFont *font = [UIFont fontWithName:@"SnellRoundhand" size:20.0f];
    textLayer.string = @"Lorem Lipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.";
    textLayer.alignmentMode = kCAAlignmentLeft;
    textLayer.fontSize = font.pointSize;
    CTFontRef fontRef = CTFontCreateWithName((__bridge CFStringRef)font.fontName, font.pointSize, nil);
    textLayer.font = fontRef;
    CFRelease(fontRef);

    textLayer.backgroundColor = [[UIColor lightGrayColor] CGColor];
    textLayer.foregroundColor = [[UIColor blackColor] CGColor];
    textLayer.frame = viewRect;

    UIGraphicsBeginImageContextWithOptions(textLayer.frame.size, NO, 0);
    [textLayer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *textImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    UIImageView *textImageView = [[UIImageView alloc] initWithImage:textImage];
    textImageView.frame = viewRect;
    [self.view addSubview:textImageView];
} 
```

不幸的是，在渲染视图时，一些字符被截断了。在我发布的示例中，开头的“L”缺少最左边的像素，而第二个末尾的“d”缺少最右边的像素。

有没有办法在不改变文本包装方式的情况下防止这种中断发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T21:30:27.733

我没有使用 CATextLayer 的默认行为，而是编写了一个从 CATextLayer 获取数据并手动将其绘制到 CGContext 中的函数。我添加了一个填充参数来处理截止问题。

```
-(UIImage *)imageFromCATextLayer:(CATextLayer *)layer andPaddingSize:(CGSize)paddingSize
{
    CGFloat paddingWidth = paddingSize.width;
    CGFloat paddingHeight = paddingSize.height;
    CGRect textBounds = layer.frame;
    CGRect paddedImageBounds = CGRectMake(0.0f, 0.0f, textBounds.size.width + 2 * paddingWidth, textBounds.size.height + 2 * paddingHeight);
    UIGraphicsBeginImageContextWithOptions(paddedImageBounds.size, NO, 0);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextTranslateCTM(context, 0.0f, paddedImageBounds.size.height);
    CGContextScaleCTM(context, 1, -1);

    CGContextSetFillColorWithColor(context, layer.backgroundColor);
    CGContextFillRect(context, paddedImageBounds);

    CTTextAlignment alignment;
    if ([layer.alignmentMode isEqualToString: kCAAlignmentLeft]) {
        alignment = kCTLeftTextAlignment;
    }
    else if ([layer.alignmentMode isEqualToString: kCAAlignmentCenter]) {
        alignment = kCTCenterTextAlignment;
    }
    else if ([layer.alignmentMode isEqualToString: kCAAlignmentRight]) {
        alignment = kCTRightTextAlignment;
    }
    else {
        alignment = kCTLeftTextAlignment;
    }

    CTParagraphStyleSetting paragraphSettings = {kCTParagraphStyleSpecifierAlignment, sizeof(alignment), &alignment};
    CTParagraphStyleRef paragraphStyle = CTParagraphStyleCreate(&paragraphSettings, 1);

    NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:layer.font, (NSString*)kCTFontAttributeName, paragraphStyle, kCTParagraphStyleAttributeName, layer.foregroundColor, kCTForegroundColorAttributeName, nil];
    NSAttributedString *attrString = [[NSAttributedString alloc] initWithString:layer.string attributes:attributes];
    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((__bridge_retained CFAttributedStringRef)attrString);
    CGMutablePathRef p = CGPathCreateMutable();
    CGPathAddRect(p, NULL, CGRectMake(10.0f, 2 * paddingHeight - 10.0f, textBounds.size.width, textBounds.size.height));
    CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0,0), p, NULL);
    CTFrameDraw(frame, context);

    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return image;
} 
```

# css - 如何在 CSS 中做到这一点？一个元素上的透明背景在另一个具有背景的元素内

> ID：11765614
> 
> 赞同：0
> 
> 时间：2012-08-01T18:50:43.263
> 
> 标签：css

这可能吗？我的 CSS 还不错，但我不能不听。我想在标题后面使用背景图像，但我希望标题“淘汰”背景图像，将背景留在两侧。我希望这是有道理的。

我做了一个小提琴，以防有人想要狂欢……谢谢！

[http://jsfiddle.net/CnVBU/](http://jsfiddle.net/CnVBU/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T19:19:41.727

最简单的方法是使用`border-image`. [在此处](http://jsfiddle.net/purmou/CnVBU/3/)查看您更新的小提琴。

这是它的CSS（多个浏览器）：

```
.container { 
    border-width: 20px;
    -moz-border-image: url(http://fc09.deviantart.net/fs71/f/2010/163/2/d/PixelBackground_02_by_Kara1984.jpg) 27 round;
    -webkit-border-image: url(http://fc09.deviantart.net/fs71/f/2010/163/2/d/PixelBackground_02_by_Kara1984.jpg) 27 round;
    border-image: url(http://fc09.deviantart.net/fs71/f/2010/163/2/d/PixelBackground_02_by_Kara1984.jpg) 27 round;
    text-align:center;
} 
```

[我使用Border-Image.com](http://border-image.com)生成了此代码（因为自己编写此代码令人困惑：P）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:54:11.170

那么它现在是透明的。听起来您想要的是将与其他颜色（主体背景颜色？）匹配的背景颜色应用于 h1。像这样的东西：

[http://jsfiddle.net/CnVBU/1/](http://jsfiddle.net/CnVBU/1/)

显然，使用您想要的任何背景颜色并添加边距/填充等，为您提供适当的“敲除”尺寸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:00:10.520

我已经更新了你的 jsFiddle：

[http://jsfiddle.net/CnVBU/2/](http://jsfiddle.net/CnVBU/2/)

现在您在 h1 上获得了透明背景。

我使用 rgba 颜色模型：红色（范围：0-255）绿色（0-255）蓝色（0-255）阿尔法（0-1）。如果您想要 50% 的透明度，请使用 0.5 alfa。

这适用于所有常见的浏览器（大多数 IE 需要过滤器/破解）

# java - 修改视图的 Internet 任务 - CalledFromWrongThreadException

> ID：11765615
> 
> 赞同：0
> 
> 时间：2012-08-01T18:50:47.143
> 
> 标签：java, android

我想使用 TimerTask 修改选项卡式活动视图的 TextViews。
这是任务类的代码：

```
 public class QueryServer extends TimerTask {

    public void run(){

        MCQuery mcQuery = new MCQuery(serverAddrress,25565);
        QueryResponse response = mcQuery.basicStat();
        int Onlineplayers = response.getOnlinePlayers();
        int MaxPlayers = response.getMaxPlayers();
        Log.d("MCQuery", "" + Onlineplayers + " OnlinePlayers");

        TextView serverStatus = (TextView) findViewById(R.id.server_status);

        TextView onlinePlayersView = (TextView) findViewById(R.id.online_players);

        serverStatus.setText("Online");

        onlinePlayersView.setText("" + Onlineplayers + "/" + MaxPlayers);
        Log.d("QueryServer", "Querying the server...");

    }
} 
```

这是调用任务的类：

```
 public class FirstTab extends Fragment {

    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
            View v = inflater.inflate(R.layout.first_tab, null);

            //check Internet connection
            if (isOnline() == true) {

                Log.d("CheckConnection", "The device is connected to the network");
            } else {
                Log.d("CheckConnection", "The device is NOT connected to the network");
            }

            Timer timer = new Timer();
            TimerTask task = new QueryServer();

            //run the QueryServer task every 3 seconds
            timer.schedule(task, 3000, 3000);

             return v;
    }
} 
```

这是错误：

> 08-01 20:43:16.759: E/AndroidRuntime(1030): android.view.ViewRootImpl$CalledFromWrongThreadException: 只有创建视图层次结构的原始线程才能触摸其视图。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:06:31.177

您需要调用修改 UI 线程上的视图的方法。[无痛线程](http://android-developers.blogspot.ca/2009/05/painless-threading.html)可能是您的首选文章

# java - Java DecimalFormat.format 不格式化数字？

> ID：11765616
> 
> 赞同：2
> 
> 时间：2012-08-01T18:50:53.677
> 
> 标签：java

我有下面的方法，但由于某种原因，它没有将该区域格式化为只有一位小数。感谢所有帮助。

```
public double beraknaArea()
    {
       DecimalFormat formatter = new DecimalFormat("#0.0");
       double area = 0;
       area = radie*radie*3.14;
       formatter.format(area);
       return area;
     } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T18:52:59.853

您返回的是相同的双精度，而不是格式化程序的输出。

[format() 方法](http://docs.oracle.com/javase/6/docs/api/java/text/NumberFormat.html#format(double))不会更改您传入的双精度，它返回双精度的字符串格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T18:54:24.363

Java 中的任何方法都不能更改已声明变量的类型，或改变任何原始值（或实际上`String`）。您需要返回返回`formatter.format(area)`的内容，而不是`area`.

```
public String beraknaArea()
{
   DecimalFormat formatter = new DecimalFormat("#0.0");
   double area = radie*radie*3.14;
   return formatter.format(area);
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T18:52:41.870

格式化程序[格式化](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/NumberFormat.html#format%28double%29)方法返回字符串

```
String temp = formatter.format(area);

System.out.println(temp); 
```

现在您将看到格式化的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-01T18:53:24.553

您的语句`formatter.format(area);`没有修改变量`area`，变量仍然保持与以前相同的值，如果您想要输出，您可以返回一个字符串

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-01T21:00:14.237

问题是，您不是返回格式化区域，而是返回您计算但未格式化的区域。

参考以下：

```
public String beraknaArea()
    {
       DecimalFormat formatter = new DecimalFormat("#0.0");
       double area = 0;
       area = radie*radie*3.14;
       String formattedArea = formatter.format(area);
       return formattedArea;
     }

/************ OR **************/

public double beraknaArea()
    {
       DecimalFormat formatter = new DecimalFormat("#0.0");
       double area = 0;
       area = radie*radie*3.14;
       String formattedArea = formatter.format(area);
       return Double.parseDouble(formattedArea);
     } 
```

第一个解决方案将 formattedArea 作为字符串返回，而第二个解决方案返回 formattedArea 的 double 值。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-01T19:07:02.707

您可以将数字乘以 10，将其转换为整数，然后将其除以 10.0 以获得恰好有一个小数点的双精度数。

```
area = ((int) (area * 10)) / 10.0; 
```

您可以使用而不是强制转换为 int`Math.floor`

```
area = Math.floor(area * 10) / 10.0; 
```

现在，进一步的算术可以使数字具有不同的小数位数。

**编辑：**

这是假设 OP 希望将返回值保留为双精度而不是字符串（正如其他答案所提供的那样）。

# algorithm - 将 HEX 转换为最接近的 X11 颜色编号

> ID：11765623
> 
> 赞同：14
> 
> 时间：2012-08-01T18:51:10.760
> 
> 标签：algorithm, colors, hex, x11

我正在寻找一种算法/方法来使用 Python、PHP、或 VIM 脚本，我想知道这里是否有人知道方法或指向我执行此操作的方向。

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-02T01:58:19.563

我遇到了同样的问题（采用现有的 vim 颜色方案和 gvim 十六进制颜色并填充终端颜色值）。这是我使用的脚本（尽管 ColorDist 函数可能会受益于更好的颜色距离度量，就像其他一些海报所建议的那样）

```
import re
import math

colors = {
    '000000':  '16', '00005f':  '17', '000087':  '18', '0000af':  '19', '0000d7':  '20',
    '0000ff':  '21', '005f00':  '22', '005f5f':  '23', '005f87':  '24', '005faf':  '25',
    '005fd7':  '26', '005fff':  '27', '008700':  '28', '00875f':  '29', '008787':  '30',
    '0087af':  '31', '0087d7':  '32', '0087ff':  '33', '00af00':  '34', '00af5f':  '35',
    '00af87':  '36', '00afaf':  '37', '00afd7':  '38', '00afff':  '39', '00d700':  '40',
    '00d75f':  '41', '00d787':  '42', '00d7af':  '43', '00d7d7':  '44', '00d7ff':  '45',
    '00ff00':  '46', '00ff5f':  '47', '00ff87':  '48', '00ffaf':  '49', '00ffd7':  '50',
    '00ffff':  '51', '5f0000':  '52', '5f005f':  '53', '5f0087':  '54', '5f00af':  '55',
    '5f00d7':  '56', '5f00ff':  '57', '5f5f00':  '58', '5f5f5f':  '59', '5f5f87':  '60',
    '5f5faf':  '61', '5f5fd7':  '62', '5f5fff':  '63', '5f8700':  '64', '5f875f':  '65',
    '5f8787':  '66', '5f87af':  '67', '5f87d7':  '68', '5f87ff':  '69', '5faf00':  '70',
    '5faf5f':  '71', '5faf87':  '72', '5fafaf':  '73', '5fafd7':  '74', '5fafff':  '75',
    '5fd700':  '76', '5fd75f':  '77', '5fd787':  '78', '5fd7af':  '79', '5fd7d7':  '80',
    '5fd7ff':  '81', '5fff00':  '82', '5fff5f':  '83', '5fff87':  '84', '5fffaf':  '85',
    '5fffd7':  '86', '5fffff':  '87', '870000':  '88', '87005f':  '89', '870087':  '90',
    '8700af':  '91', '8700d7':  '92', '8700ff':  '93', '875f00':  '94', '875f5f':  '95',
    '875f87':  '96', '875faf':  '97', '875fd7':  '98', '875fff':  '99', '878700': '100',
    '87875f': '101', '878787': '102', '8787af': '103', '8787d7': '104', '8787ff': '105',
    '87af00': '106', '87af5f': '107', '87af87': '108', '87afaf': '109', '87afd7': '110',
    '87afff': '111', '87d700': '112', '87d75f': '113', '87d787': '114', '87d7af': '115',
    '87d7d7': '116', '87d7ff': '117', '87ff00': '118', '87ff5f': '119', '87ff87': '120',
    '87ffaf': '121', '87ffd7': '122', '87ffff': '123', 'af0000': '124', 'af005f': '125',
    'af0087': '126', 'af00af': '127', 'af00d7': '128', 'af00ff': '129', 'af5f00': '130',
    'af5f5f': '131', 'af5f87': '132', 'af5faf': '133', 'af5fd7': '134', 'af5fff': '135',
    'af8700': '136', 'af875f': '137', 'af8787': '138', 'af87af': '139', 'af87d7': '140',
    'af87ff': '141', 'afaf00': '142', 'afaf5f': '143', 'afaf87': '144', 'afafaf': '145',
    'afafd7': '146', 'afafff': '147', 'afd700': '148', 'afd75f': '149', 'afd787': '150',
    'afd7af': '151', 'afd7d7': '152', 'afd7ff': '153', 'afff00': '154', 'afff5f': '155',
    'afff87': '156', 'afffaf': '157', 'afffd7': '158', 'afffff': '159', 'd70000': '160',
    'd7005f': '161', 'd70087': '162', 'd700af': '163', 'd700d7': '164', 'd700ff': '165',
    'd75f00': '166', 'd75f5f': '167', 'd75f87': '168', 'd75faf': '169', 'd75fd7': '170',
    'd75fff': '171', 'd78700': '172', 'd7875f': '173', 'd78787': '174', 'd787af': '175',
    'd787d7': '176', 'd787ff': '177', 'd7af00': '178', 'd7af5f': '179', 'd7af87': '180',
    'd7afaf': '181', 'd7afd7': '182', 'd7afff': '183', 'd7d700': '184', 'd7d75f': '185',
    'd7d787': '186', 'd7d7af': '187', 'd7d7d7': '188', 'd7d7ff': '189', 'd7ff00': '190',
    'd7ff5f': '191', 'd7ff87': '192', 'd7ffaf': '193', 'd7ffd7': '194', 'd7ffff': '195',
    'ff0000': '196', 'ff005f': '197', 'ff0087': '198', 'ff00af': '199', 'ff00d7': '200',
    'ff00ff': '201', 'ff5f00': '202', 'ff5f5f': '203', 'ff5f87': '204', 'ff5faf': '205',
    'ff5fd7': '206', 'ff5fff': '207', 'ff8700': '208', 'ff875f': '209', 'ff8787': '210',
    'ff87af': '211', 'ff87d7': '212', 'ff87ff': '213', 'ffaf00': '214', 'ffaf5f': '215',
    'ffaf87': '216', 'ffafaf': '217', 'ffafd7': '218', 'ffafff': '219', 'ffd700': '220',
    'ffd75f': '221', 'ffd787': '222', 'ffd7af': '223', 'ffd7d7': '224', 'ffd7ff': '225',
    'ffff00': '226', 'ffff5f': '227', 'ffff87': '228', 'ffffaf': '229', 'ffffd7': '230',
    'ffffff': '231', '080808': '232', '121212': '233', '1c1c1c': '234', '262626': '235',
    '303030': '236', '3a3a3a': '237', '444444': '238', '4e4e4e': '239', '585858': '240',
    '626262': '241', '6c6c6c': '242', '767676': '243', '808080': '244', '8a8a8a': '245',
    '949494': '246', '9e9e9e': '247', 'a8a8a8': '248', 'b2b2b2': '249', 'bcbcbc': '250',
    'c6c6c6': '251', 'd0d0d0': '252', 'dadada': '253', 'e4e4e4': '254', 'eeeeee': '255',
}

## Example line from a vim colorscheme file
##hi Normal          ctermfg=NONE ctermbg=NONE gui=NONE guifg=#b7af9f guibg=#202020

def Decompose(hexval):
    return float(int(hexval[0:2], 16)), float(int(hexval[2:4], 16)), float(int(hexval[4:6], 16))

def Normalize(r, g, b):
    magsqr = r*r + g*g + b*b
    if magsqr < 0.0001:
        return 0.0, 0.0, 0.0
    n = 1.0 / math.sqrt(magsqr)
    return r*n, g*n, b*n

def ColorDist(c1, c2):
    c1r, c1g, c1b = Decompose(c1)
    c2r, c2g, c2b = Decompose(c2)

    dr = c1r - c2r
    dg = c1g - c2g
    db = c1b - c2b
    return dr*dr + dg*dg + db*db

def BestMatch(hexval):
    best = None
    bestdist = 0.0
    for key in colors.keys():
        dist = ColorDist(hexval, key)
        if best is None or dist < bestdist:
            best = colors[key]
            bestdist = dist
    return best

##                  1   2             3   4        5      6
fg = re.compile(r'^(.*)(ctermfg=)NONE(.*)(guifg=#)([^ ]*)(.*)\n$')
bg = re.compile(r'^(.*)(ctermbg=)NONE(.*)(guibg=#)([^ ]*)(.*)\n$')

with open(r'input_color_scheme.vim', 'r') as f:
    with open(r'output_color_scheme.vim', 'w') as fout:
        for line in f.readlines():
            fgmatch = fg.match(line)
            if fgmatch is not None:
                line = (fgmatch.group(1) +
                        fgmatch.group(2) +
                        BestMatch(fgmatch.group(5)) + 
                        fgmatch.group(3) +
                        fgmatch.group(4) +
                        fgmatch.group(5) +
                        fgmatch.group(6)) + '\n'

            bgmatch = bg.match(line)
            if bgmatch is not None:
                line = (bgmatch.group(1) +
                        bgmatch.group(2) +
                        BestMatch(bgmatch.group(5)) + 
                        bgmatch.group(3) +
                        bgmatch.group(4) +
                        bgmatch.group(5) +
                        bgmatch.group(6) + '\n')

            ## -- print the line
            fout.write(line) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-06-25T18:00:06.530

转到[Wolfram Alpha](http://www.wolframalpha.com/)，输入您的十六进制值，即“#acdffa”。转到名为“最近命名的 HTML 颜色”的部分

我知道这不是代码，但您确实说过“算法/方式”。

干杯

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-02-01T11:11:24.047

这是一个 C 实现，但应该很容易将其转换为其他语言。本文末尾有一个 JavaScript 实现。请注意，C 实现使用整数运算：

```
// Convert RGB24 to xterm-256 8-bit value
// For simplicity, assume RGB space is perceptually uniform.
// There are 5 places where one of two outputs needs to be chosen when the
// input is the exact middle:
// - The r/g/b channels and the gray value: the higher value output is chosen.
// - If the gray and color have same distance from the input - color is chosen.
static int rgb_to_x256(uint8_t r, uint8_t g, uint8_t b)
{
    // Calculate the nearest 0-based color index at 16 .. 231
#   define v2ci(v) (v < 48 ? 0 : v < 115 ? 1 : (v - 35) / 40)
    int ir = v2ci(r), ig = v2ci(g), ib = v2ci(b);   // 0..5 each
#   define color_index() (36 * ir + 6 * ig + ib)  /* 0..215, lazy evaluation */

    // Calculate the nearest 0-based gray index at 232 .. 255
    int average = (r + g + b) / 3;
    int gray_index = average > 238 ? 23 : (average - 3) / 10;  // 0..23

    // Calculate the represented colors back from the index
    static const int i2cv[6] = {0, 0x5f, 0x87, 0xaf, 0xd7, 0xff};
    int cr = i2cv[ir], cg = i2cv[ig], cb = i2cv[ib];  // r/g/b, 0..255 each
    int gv = 8 + 10 * gray_index;  // same value for r/g/b, 0..255

    // Return the one which is nearer to the original input rgb value
#   define dist_square(A,B,C, a,b,c) ((A-a)*(A-a) + (B-b)*(B-b) + (C-c)*(C-c))
    int color_err = dist_square(cr, cg, cb, r, g, b);
    int gray_err  = dist_square(gv, gv, gv, r, g, b);
    return color_err <= gray_err ? 16 + color_index() : 232 + gray_index;
} 
```

这与`tmux`和当前使用的实现相同`mpv`。[您可以在 github](https://github.com/tmux/tmux/pull/432)上的 tmux pull request 中找到该算法的一些解释。

**JavaScript 实现**

```
// Convert RGB24 to xterm-256 8-bit value
// For simplicity, assume RGB space is perceptually uniform.
// There are 5 places where one of two outputs needs to be chosen when the
// input is the exact middle:
// - The r/g/b channels and the gray value: the higher value output is chosen.
// - If the gray and color have same distance from the input - color is chosen.
function RgbToX256(r, g, b) {
  // Calculate the nearest 0-based color index at 16 .. 231
  const v2ci = (v) => {
    if (v < 48) {
      return 0;
    } else if (v < 115) {
      return 1;
    } else {
      return Math.trunc((v - 35) / 40);
    }
  };

  const ir = v2ci(r);
  const ig = v2ci(g);
  const ib = v2ci(b);
  const colorIndex = (36 * ir + 6 * ig + ib);

  // Calculate the nearest 0-based gray index at 232 .. 255
  const average = Math.trunc((r + g + b) / 3);
  const grayIndex = average > 238 ? 23 : Math.trunc((average - 3) / 10);

  // Calculate the represented colors back from the index
  const i2cv = [0, 0x5F, 0x87, 0xAF, 0xD7, 0xFF];
  const cr = i2cv[ir];
  const cg = i2cv[ig];
  const cb = i2cv[ib];
  const gv = 8 + 10 * grayIndex;

  // Return the one which is nearer to the original input rgb value
  const distSquare = (A, B, C, a, b, c) => {
    return ((A - a) * (A - a) + (B - b) * (B - b) + (C - c) * (C - c));
  }
  const colorErr = distSquare(cr, cg, cb, r, g, b);
  const grayErr = distSquare(gv, gv, gv, r, g, b);

  return colorErr <= grayErr ? 16 + colorIndex : 232 + grayIndex;
}

const assertEq = (result, expect) => {
  if (result !== expect) {
    return console.log("[FAIL]", `expected: ${expect}, got ${result}`);
  }

  return console.log("[PASS]", `expected: ${expect}, got ${result}`);
}

const tests = [{
    expect: 16,
    rgb: [0, 0, 0]
  },
  {
    expect: 17,
    rgb: [0, 0, 95]
  },
  {
    expect: 18,
    rgb: [0, 0, 135]
  },
  {
    expect: 19,
    rgb: [0, 0, 175]
  },
  {
    expect: 20,
    rgb: [0, 0, 215]
  },
  {
    expect: 21,
    rgb: [0, 0, 255]
  },
  {
    expect: 22,
    rgb: [0, 95, 0]
  },
  {
    expect: 23,
    rgb: [0, 95, 95]
  },
  {
    expect: 24,
    rgb: [0, 95, 135]
  },
  {
    expect: 25,
    rgb: [0, 95, 175]
  },
  {
    expect: 26,
    rgb: [0, 95, 215]
  },
  {
    expect: 27,
    rgb: [0, 95, 255]
  },
  {
    expect: 28,
    rgb: [0, 135, 0]
  },
  {
    expect: 29,
    rgb: [0, 135, 95]
  },
  {
    expect: 30,
    rgb: [0, 135, 135]
  },
  {
    expect: 31,
    rgb: [0, 135, 175]
  },
  {
    expect: 32,
    rgb: [0, 135, 215]
  },
  {
    expect: 33,
    rgb: [0, 135, 255]
  },
  {
    expect: 34,
    rgb: [0, 175, 0]
  },
  {
    expect: 35,
    rgb: [0, 175, 95]
  },
  {
    expect: 36,
    rgb: [0, 175, 135]
  },
  {
    expect: 37,
    rgb: [0, 175, 175]
  },
  {
    expect: 38,
    rgb: [0, 175, 215]
  },
  {
    expect: 39,
    rgb: [0, 175, 255]
  },
  {
    expect: 40,
    rgb: [0, 215, 0]
  },
  {
    expect: 41,
    rgb: [0, 215, 95]
  },
  {
    expect: 42,
    rgb: [0, 215, 135]
  },
  {
    expect: 43,
    rgb: [0, 215, 175]
  },
  {
    expect: 44,
    rgb: [0, 215, 215]
  },
  {
    expect: 45,
    rgb: [0, 215, 255]
  },
  {
    expect: 46,
    rgb: [0, 255, 0]
  },
  {
    expect: 47,
    rgb: [0, 255, 95]
  },
  {
    expect: 48,
    rgb: [0, 255, 135]
  },
  {
    expect: 49,
    rgb: [0, 255, 175]
  },
  {
    expect: 50,
    rgb: [0, 255, 215]
  },
  {
    expect: 51,
    rgb: [0, 255, 255]
  },
  {
    expect: 52,
    rgb: [95, 0, 0]
  },
  {
    expect: 53,
    rgb: [95, 0, 95]
  },
  {
    expect: 54,
    rgb: [95, 0, 135]
  },
  {
    expect: 55,
    rgb: [95, 0, 175]
  },
  {
    expect: 56,
    rgb: [95, 0, 215]
  },
  {
    expect: 57,
    rgb: [95, 0, 255]
  },
  {
    expect: 58,
    rgb: [95, 95, 0]
  },
  {
    expect: 59,
    rgb: [95, 95, 95]
  },
  {
    expect: 60,
    rgb: [95, 95, 135]
  },
  {
    expect: 61,
    rgb: [95, 95, 175]
  },
  {
    expect: 62,
    rgb: [95, 95, 215]
  },
  {
    expect: 63,
    rgb: [95, 95, 255]
  },
  {
    expect: 64,
    rgb: [95, 135, 0]
  },
  {
    expect: 65,
    rgb: [95, 135, 95]
  },
  {
    expect: 66,
    rgb: [95, 135, 135]
  },
  {
    expect: 67,
    rgb: [95, 135, 175]
  },
  {
    expect: 68,
    rgb: [95, 135, 215]
  },
  {
    expect: 69,
    rgb: [95, 135, 255]
  },
  {
    expect: 70,
    rgb: [95, 175, 0]
  },
  {
    expect: 71,
    rgb: [95, 175, 95]
  },
  {
    expect: 72,
    rgb: [95, 175, 135]
  },
  {
    expect: 73,
    rgb: [95, 175, 175]
  },
  {
    expect: 74,
    rgb: [95, 175, 215]
  },
  {
    expect: 75,
    rgb: [95, 175, 255]
  },
  {
    expect: 76,
    rgb: [95, 215, 0]
  },
  {
    expect: 77,
    rgb: [95, 215, 95]
  },
  {
    expect: 78,
    rgb: [95, 215, 135]
  },
  {
    expect: 79,
    rgb: [95, 215, 175]
  },
  {
    expect: 80,
    rgb: [95, 215, 215]
  },
  {
    expect: 81,
    rgb: [95, 215, 255]
  },
  {
    expect: 82,
    rgb: [95, 255, 0]
  },
  {
    expect: 83,
    rgb: [95, 255, 95]
  },
  {
    expect: 84,
    rgb: [95, 255, 135]
  },
  {
    expect: 85,
    rgb: [95, 255, 175]
  },
  {
    expect: 86,
    rgb: [95, 255, 215]
  },
  {
    expect: 87,
    rgb: [95, 255, 255]
  },
  {
    expect: 88,
    rgb: [135, 0, 0]
  },
  {
    expect: 89,
    rgb: [135, 0, 95]
  },
  {
    expect: 90,
    rgb: [135, 0, 135]
  },
  {
    expect: 91,
    rgb: [135, 0, 175]
  },
  {
    expect: 92,
    rgb: [135, 0, 215]
  },
  {
    expect: 93,
    rgb: [135, 0, 255]
  },
  {
    expect: 94,
    rgb: [135, 95, 0]
  },
  {
    expect: 95,
    rgb: [135, 95, 95]
  },
  {
    expect: 96,
    rgb: [135, 95, 135]
  },
  {
    expect: 97,
    rgb: [135, 95, 175]
  },
  {
    expect: 98,
    rgb: [135, 95, 215]
  },
  {
    expect: 99,
    rgb: [135, 95, 255]
  },
  {
    expect: 100,
    rgb: [135, 135, 0]
  },
  {
    expect: 101,
    rgb: [135, 135, 95]
  },
  {
    expect: 102,
    rgb: [135, 135, 135]
  },
  {
    expect: 103,
    rgb: [135, 135, 175]
  },
  {
    expect: 104,
    rgb: [135, 135, 215]
  },
  {
    expect: 105,
    rgb: [135, 135, 255]
  },
  {
    expect: 106,
    rgb: [135, 175, 0]
  },
  {
    expect: 107,
    rgb: [135, 175, 95]
  },
  {
    expect: 108,
    rgb: [135, 175, 135]
  },
  {
    expect: 109,
    rgb: [135, 175, 175]
  },
  {
    expect: 110,
    rgb: [135, 175, 215]
  },
  {
    expect: 111,
    rgb: [135, 175, 255]
  },
  {
    expect: 112,
    rgb: [135, 215, 0]
  },
  {
    expect: 113,
    rgb: [135, 215, 95]
  },
  {
    expect: 114,
    rgb: [135, 215, 135]
  },
  {
    expect: 115,
    rgb: [135, 215, 175]
  },
  {
    expect: 116,
    rgb: [135, 215, 215]
  },
  {
    expect: 117,
    rgb: [135, 215, 255]
  },
  {
    expect: 118,
    rgb: [135, 255, 0]
  },
  {
    expect: 119,
    rgb: [135, 255, 95]
  },
  {
    expect: 120,
    rgb: [135, 255, 135]
  },
  {
    expect: 121,
    rgb: [135, 255, 175]
  },
  {
    expect: 122,
    rgb: [135, 255, 215]
  },
  {
    expect: 123,
    rgb: [135, 255, 255]
  },
  {
    expect: 124,
    rgb: [175, 0, 0]
  },
  {
    expect: 125,
    rgb: [175, 0, 95]
  },
  {
    expect: 126,
    rgb: [175, 0, 135]
  },
  {
    expect: 127,
    rgb: [175, 0, 175]
  },
  {
    expect: 128,
    rgb: [175, 0, 215]
  },
  {
    expect: 129,
    rgb: [175, 0, 255]
  },
  {
    expect: 130,
    rgb: [175, 95, 0]
  },
  {
    expect: 131,
    rgb: [175, 95, 95]
  },
  {
    expect: 132,
    rgb: [175, 95, 135]
  },
  {
    expect: 133,
    rgb: [175, 95, 175]
  },
  {
    expect: 134,
    rgb: [175, 95, 215]
  },
  {
    expect: 135,
    rgb: [175, 95, 255]
  },
  {
    expect: 136,
    rgb: [175, 135, 0]
  },
  {
    expect: 137,
    rgb: [175, 135, 95]
  },
  {
    expect: 138,
    rgb: [175, 135, 135]
  },
  {
    expect: 139,
    rgb: [175, 135, 175]
  },
  {
    expect: 140,
    rgb: [175, 135, 215]
  },
  {
    expect: 141,
    rgb: [175, 135, 255]
  },
  {
    expect: 142,
    rgb: [175, 175, 0]
  },
  {
    expect: 143,
    rgb: [175, 175, 95]
  },
  {
    expect: 144,
    rgb: [175, 175, 135]
  },
  {
    expect: 145,
    rgb: [175, 175, 175]
  },
  {
    expect: 146,
    rgb: [175, 175, 215]
  },
  {
    expect: 147,
    rgb: [175, 175, 255]
  },
  {
    expect: 148,
    rgb: [175, 215, 0]
  },
  {
    expect: 149,
    rgb: [175, 215, 95]
  },
  {
    expect: 150,
    rgb: [175, 215, 135]
  },
  {
    expect: 151,
    rgb: [175, 215, 175]
  },
  {
    expect: 152,
    rgb: [175, 215, 215]
  },
  {
    expect: 153,
    rgb: [175, 215, 255]
  },
  {
    expect: 154,
    rgb: [175, 255, 0]
  },
  {
    expect: 155,
    rgb: [175, 255, 95]
  },
  {
    expect: 156,
    rgb: [175, 255, 135]
  },
  {
    expect: 157,
    rgb: [175, 255, 175]
  },
  {
    expect: 158,
    rgb: [175, 255, 215]
  },
  {
    expect: 159,
    rgb: [175, 255, 255]
  },
  {
    expect: 160,
    rgb: [215, 0, 0]
  },
  {
    expect: 161,
    rgb: [215, 0, 95]
  },
  {
    expect: 162,
    rgb: [215, 0, 135]
  },
  {
    expect: 163,
    rgb: [215, 0, 175]
  },
  {
    expect: 164,
    rgb: [215, 0, 215]
  },
  {
    expect: 165,
    rgb: [215, 0, 255]
  },
  {
    expect: 166,
    rgb: [215, 95, 0]
  },
  {
    expect: 167,
    rgb: [215, 95, 95]
  },
  {
    expect: 168,
    rgb: [215, 95, 135]
  },
  {
    expect: 169,
    rgb: [215, 95, 175]
  },
  {
    expect: 170,
    rgb: [215, 95, 215]
  },
  {
    expect: 171,
    rgb: [215, 95, 255]
  },
  {
    expect: 172,
    rgb: [215, 135, 0]
  },
  {
    expect: 173,
    rgb: [215, 135, 95]
  },
  {
    expect: 174,
    rgb: [215, 135, 135]
  },
  {
    expect: 175,
    rgb: [215, 135, 175]
  },
  {
    expect: 176,
    rgb: [215, 135, 215]
  },
  {
    expect: 177,
    rgb: [215, 135, 255]
  },
  {
    expect: 178,
    rgb: [215, 175, 0]
  },
  {
    expect: 179,
    rgb: [215, 175, 95]
  },
  {
    expect: 180,
    rgb: [215, 175, 135]
  },
  {
    expect: 181,
    rgb: [215, 175, 175]
  },
  {
    expect: 182,
    rgb: [215, 175, 215]
  },
  {
    expect: 183,
    rgb: [215, 175, 255]
  },
  {
    expect: 184,
    rgb: [215, 215, 0]
  },
  {
    expect: 185,
    rgb: [215, 215, 95]
  },
  {
    expect: 186,
    rgb: [215, 215, 135]
  },
  {
    expect: 187,
    rgb: [215, 215, 175]
  },
  {
    expect: 188,
    rgb: [215, 215, 215]
  },
  {
    expect: 189,
    rgb: [215, 215, 255]
  },
  {
    expect: 190,
    rgb: [215, 255, 0]
  },
  {
    expect: 191,
    rgb: [215, 255, 95]
  },
  {
    expect: 192,
    rgb: [215, 255, 135]
  },
  {
    expect: 193,
    rgb: [215, 255, 175]
  },
  {
    expect: 194,
    rgb: [215, 255, 215]
  },
  {
    expect: 195,
    rgb: [215, 255, 255]
  },
  {
    expect: 196,
    rgb: [255, 0, 0]
  },
  {
    expect: 197,
    rgb: [255, 0, 95]
  },
  {
    expect: 198,
    rgb: [255, 0, 135]
  },
  {
    expect: 199,
    rgb: [255, 0, 175]
  },
  {
    expect: 200,
    rgb: [255, 0, 215]
  },
  {
    expect: 201,
    rgb: [255, 0, 255]
  },
  {
    expect: 202,
    rgb: [255, 95, 0]
  },
  {
    expect: 203,
    rgb: [255, 95, 95]
  },
  {
    expect: 204,
    rgb: [255, 95, 135]
  },
  {
    expect: 205,
    rgb: [255, 95, 175]
  },
  {
    expect: 206,
    rgb: [255, 95, 215]
  },
  {
    expect: 207,
    rgb: [255, 95, 255]
  },
  {
    expect: 208,
    rgb: [255, 135, 0]
  },
  {
    expect: 209,
    rgb: [255, 135, 95]
  },
  {
    expect: 210,
    rgb: [255, 135, 135]
  },
  {
    expect: 211,
    rgb: [255, 135, 175]
  },
  {
    expect: 212,
    rgb: [255, 135, 215]
  },
  {
    expect: 213,
    rgb: [255, 135, 255]
  },
  {
    expect: 214,
    rgb: [255, 175, 0]
  },
  {
    expect: 215,
    rgb: [255, 175, 95]
  },
  {
    expect: 216,
    rgb: [255, 175, 135]
  },
  {
    expect: 217,
    rgb: [255, 175, 175]
  },
  {
    expect: 218,
    rgb: [255, 175, 215]
  },
  {
    expect: 219,
    rgb: [255, 175, 255]
  },
  {
    expect: 220,
    rgb: [255, 215, 0]
  },
  {
    expect: 221,
    rgb: [255, 215, 95]
  },
  {
    expect: 222,
    rgb: [255, 215, 135]
  },
  {
    expect: 223,
    rgb: [255, 215, 175]
  },
  {
    expect: 224,
    rgb: [255, 215, 215]
  },
  {
    expect: 225,
    rgb: [255, 215, 255]
  },
  {
    expect: 226,
    rgb: [255, 255, 0]
  },
  {
    expect: 227,
    rgb: [255, 255, 95]
  },
  {
    expect: 228,
    rgb: [255, 255, 135]
  },
  {
    expect: 229,
    rgb: [255, 255, 175]
  },
  {
    expect: 230,
    rgb: [255, 255, 215]
  },
  {
    expect: 231,
    rgb: [255, 255, 255]
  },
  {
    expect: 232,
    rgb: [8, 8, 8]
  },
  {
    expect: 233,
    rgb: [18, 18, 18]
  },
  {
    expect: 234,
    rgb: [28, 28, 28]
  },
  {
    expect: 235,
    rgb: [38, 38, 38]
  },
  {
    expect: 236,
    rgb: [48, 48, 48]
  },
  {
    expect: 237,
    rgb: [58, 58, 58]
  },
  {
    expect: 238,
    rgb: [68, 68, 68]
  },
  {
    expect: 239,
    rgb: [78, 78, 78]
  },
  {
    expect: 240,
    rgb: [88, 88, 88]
  },
  {
    expect: 241,
    rgb: [98, 98, 98]
  },
  {
    expect: 242,
    rgb: [108, 108, 108]
  },
  {
    expect: 243,
    rgb: [118, 118, 118]
  },
  {
    expect: 244,
    rgb: [128, 128, 128]
  },
  {
    expect: 245,
    rgb: [138, 138, 138]
  },
  {
    expect: 246,
    rgb: [148, 148, 148]
  },
  {
    expect: 247,
    rgb: [158, 158, 158]
  },
  {
    expect: 248,
    rgb: [168, 168, 168]
  },
  {
    expect: 249,
    rgb: [178, 178, 178]
  },
  {
    expect: 250,
    rgb: [188, 188, 188]
  },
  {
    expect: 251,
    rgb: [198, 198, 198]
  },
  {
    expect: 252,
    rgb: [208, 208, 208]
  },
  {
    expect: 253,
    rgb: [218, 218, 218]
  },
  {
    expect: 254,
    rgb: [228, 228, 228]
  },
  {
    expect: 255,
    rgb: [238, 238, 238]
  }
];

for (const {
    expect,
    rgb: [r, g, b]
  } of tests) {
  assertEq(expect, RgbToX256(r, g, b));
}
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-01T18:58:08.460

一旦您知道[X11 颜色的 RGB 值](http://en.wikipedia.org/wiki/Web_colors#X11_color_names)，您就可以确定给定输入颜色与这些颜色中的哪种颜色“最接近”。

这里有一个很好的、快速的颜色距离测量方法

[https://stackoverflow.com/a/74033/141172](https://stackoverflow.com/a/74033/141172)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-06-05T15:50:36.560

这是恒定时间的python实现：

```
N = []
for i, n in enumerate([47, 68, 40, 40, 40, 21]):
    N.extend([i]*n)

def rgb_to_xterm(r, g, b):
    mx = max(r, g, b)    
    mn = min(r, g, b)

    if (mx-mn)*(mx+mn) <= 6250:
        c = 24 - (252 - ((r+g+b) // 3)) // 10
        if 0 <= c <= 23:
            return 232 + c

    return 16 + 36*N[r] + 6*N[g] + N[b] 
```

# python - 使用 Python 的转义序列格式化字符串

> ID：11765625
> 
> 赞同：1
> 
> 时间：2012-08-01T18:51:18.887
> 
> 标签：python, string, escaping, hex, sequence

为澄清起见，我正在从头开始重写附加信息。

考虑以下：

```
y = hex(1200)
y
'0x4b0' 
```

我需要将 y 的第一个 0 替换为“\”，使其看起来像“\x04b0”。我正在通过[RS-232](http://en.wikipedia.org/wiki/RS-232)串行与仪器通信，该串行严格采用该格式（'\xSumCharsHere'）的参数。Python不会让我做以下事情。

```
z = '\x' + y[2:]
ValueError: invalid \x escape 
```

以下是不可接受的，因为它在分配给 z 的实际值中仍然有 '\\'。

```
z = '\\' + y[1:]
z
'\\x4b0' 
```

最终目标是将这样的命令发送到我的串口：

```
s.write(z) # s is a serial object
s.write('\x04b0') # This call is an equivalent of the call above
s.write('\\x04b0') # This command will not work 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:54:22.630

您的最后一段代码并没有按照您的想法执行：

```
>>> x = hex(1200)
>>> y = '\\' + x[1: len(x)]
>>> y
'\\x4b0'
>>> print y
\x4b0 
```

当您在 Python 控制台中键入变量的名称时，Python 会将字符串的*表示形式打印为 Python 代码*，这就是您看到两个反斜杠的原因——Python 字符串中的文字反斜杠被另一个前导反斜杠转义。这段代码确实有效，结果的表示只是让你失望。

但是，我建议您改用此代码段，因为您的代码段省略了前导零：

```
>>> y = '\\x%04x' % 1200
>>> print y
\x04b0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:54:00.857

您的最后一个代码位是正确的，也可以使用原始字符串编写：

```
y = r'\x' + x[2: len(x)] 
```

正如 cdhowie 在他的回答中所说：

> 当您在 Python 控制台中键入变量的名称时，Python 会将字符串的表示形式打印为 Python 代码。这段代码确实有效，结果的表示只是让你失望。

然而，这是手写转义序列的一种替代方法，我认为这是一种更好的编码实践，因为它更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:05:48.777

如果您只是想在控制台获取字符串`\0x4b0`作为表示，则需要在控制台实际调用`print`它：

```
>>> s='\\0{}'.format(hex(1200)[1:])
>>> s
'\\0x4b0'
>>> print s
\0x4b0
>>> s2='\\0'+hex(1200)[1:]
>>> s2
'\\0x4b0'
>>> print s2
\0x4b0 
```

如果您只是在控制台中 FORM 字符串（即，它不会通过`print`），Python 会向您展示它的表示形式：

```
>>> '\\0{}'.format(hex(1200)[1:])
'\\0x4b0'
>>> repr(s2)
"'\\\\0x4b0'"
>>> s2
'\\0x4b0' 
```

**编辑（根据您的评论）：**

我假设这是一台旧的 HP 绘图仪？

不要被 shell 显示为字符串的内容所迷惑。

你声明你想产生一个字符串`\x<someNumGoesHere>`（或者它是否`\x0<someNumGoesHere>`带有前导`0`？）

方法如下：

```
>>> def angle_string(angle):
...    return '\\0{}'.format(hex(angle)[1:])
... 
>>> angle_string(1200)
'\\x04b0'
>>> print _
\x04b0
>>> angle_string(33)
'\\x021'
>>> print _
\x021 
```

当您将字符串发送到您的设备时（通过 OS 文件/类似打印服务到 RS232 端口），它将与您格式化它一样。

**编辑 2**

字符串插值是这些[字符串文字](http://docs.python.org/release/2.5.2/ref/strings.html)的过程：

```
>>> s1
'\n\n\t\tline' 
```

翻译成这样：

```
>>> print s

       line 
```

从逻辑上讲，这些文字字符是单个字符：

```
>>> s1[0]
'\n'
>>> len('\\')
1 
```

我的猜测是您打开串行端口的方式`s`是使用字符串是原始模式，因此字符串`\\x0123`是以这种方式发送（原始模式）而不是被解释为`\x0123`

您可以尝试解决此问题：

```
>>> cmd=chr(92)+'0'+hex(1200)[1:]
>>> s.write(cmd) 
```

我认为您还需要在[FileLike](http://pyserial.sourceforge.net/pyserial_api.html#serial.FileLike)模式下打开串行端口，以便将字符串文字作为正确的单个字符发送。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:55:41.420

后者将起作用。在控制台中，Python 使用`repr()`打印对象，在这种情况下将显示双斜杠。在控制台中执行`print y`，您会看到它正确输出。

您还可以稍微清理一下您的第一个示例：

```
y = "\\x" + x[2:] 
```

或者第二个：

```
y = "\\" + x[1:] 
```

# opengl - 我可以为每个渲染目标指定一个视口吗？

> ID：11765626
> 
> 赞同：0
> 
> 时间：2012-08-01T18:51:18.933
> 
> 标签：opengl, graphics, viewport, framebuffer

首先是我的问题：我正在尝试渲染到 FBO 中的多个缓冲区。我使用 设置多个缓冲区`glDrawBuffers`，并使用适当的`gl_FragData`. 一切都很好，但在我的情况下，应该对其中一个缓冲区进行下采样，准确地说是四分之一（`w/2`，，`h/2`）。

当然，我可以通过事后对那些特定的缓冲区进行 blitting 来做到这一点，或者我可以简单地在 CPU 上进行下采样（当前解决方案）。但后来我阅读了视口数组，并在[ARB 规范](http://www.opengl.org/registry/specs/ARB/viewport_array.txt)中找到了这句话，这似乎正是我想要的，没有任何额外的转换。

> 此外，当与多个帧缓冲区附件结合使用时，它允许为每个选择不同的视口矩形。

当然，规范之后从未提及如何执行此操作或它们的实际含义，这`multiple framebuffer attachments`是非常通用的。我只注意到我可以将特定视口设置为几何着色器的输出（输出`gl_ViewportIndex`）。所以我可以为数组中的每个视口调用几何两次。但据我了解，这将简单地调用片段着色器并应用另一个视口转换，而不是每个目标缓冲区一个。这当然对我的用例没有多大意义，我也看不出这如何有助于为每个帧缓冲区附件选择一个视口

对于我的情况，添加几何着色器没有多大意义。而且由于视口变换仅在片段着色器之后应用，因此每个渲染目标都有一个视口确实有意义，前面的引用似乎证实了这一点。这实际上是否可能，如果是这样，我将如何做到这一点？

哦，我已经尝试了显而易见的方法：将该目标的渲染缓冲区（假设我使用`GL_COLOR_ATTACHMENT1`）调整为下采样版本，并将视口数组的索引 1 设置为相应的大小。我最终得到了图像左下象限的图片，基本上告诉我视口没有改变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T20:58:56.190

视口数组只能与几何着色器一起使用；没有它们，数组索引 0 将用于所有渲染。

请记住：视口变换发生在光栅化之前。因此，如果您想通过多个视口变换三角形，您实际上是在要求系统*多次*渲染该三角形。做到这一点的唯一方法是使用多次输出图元的几何着色器。

# java - 如何在 Java 中找到重载的方法？

> ID：11765627
> 
> 赞同：16
> 
> 时间：2012-08-01T18:51:22.073
> 
> 标签：java, reflection, overloading

写类似的东西时

```
doit(43, 44, "hello"); 
```

编译器知道要调用哪个重载方法。当我想通过反射做同样的事情时，我需要找出自己，方法是

```
doit(Integer, double, CharSequence...); 
```

并通过类似的方式获得它

```
Class[] types = {Integer.class, double.class, CharSequence[].class};
declaringClass.getDeclaredMethod("doit", types); 
```

我想知道是否已经有一些东西可以让我写

```
Method m = getMethod(declaringClass, "doit", 43, 44, "hello"); 
```

我想知道是否有人已经这样做了，因为[JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12)在这方面有点复杂。

* * *

实际上，与编译器*完全*一样的行为是不可能的，因为在[阶段 1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2.2)中，编译器只接受匹配的方法，而无需装箱和拆箱。当从上面调用我的假设`getMethod`时，原语和它们的包装器之间的区别已经丢失（因为通过可变参数传递参数时的自动装箱）。这个问题似乎没有解决办法，所以我们忽略它。

正如答案中所建议的那样，`BeanUtils.invokeMethod`接近了。它应该找到最好的匹配，不管它意味着什么。查看[MethodUtils](http://svn.apache.org/viewvc/commons/proper/beanutils/trunk/src/main/java/org/apache/commons/beanutils/MethodUtils.java?view=markup)`.getMatchingAccessibleMethod`表明

*   它对可变参数一无所知
*   这是不确定的

所以我正在寻找更好的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:09:19.683

或者，您可以使用[Apache Commons 的 Bean Utils](http://commons.apache.org/beanutils)：

```
public static Method getAccessibleMethod(
        Class clazz,
        String methodName,
        Class[] parameterTypes) 
```

根据[文件](http://commons.apache.org/beanutils/api/org/apache/commons/beanutils/MethodUtils.html#getAccessibleMethod%28java.lang.Class,%20java.lang.String,%20java.lang.Class%5b%5d%29)：

> 返回具有给定名称和参数的可访问方法（即可以通过反射调用的方法）。如果找不到这样的方法，则返回 null。这只是 getAccessibleMethod(Method 方法) 的一个方便的包装器。
> 
> 参数： **clazz** - 从此类中获取方法 **methodName** - 使用此名称获取方法 **parameterTypes** - 使用这些参数类型

实现获取可访问的方法并在层次结构中上升，直到找到与之匹配的方法。

## 直接调用

为了按照您的要求直接执行调用，您可以从同一 API 使用此方法：

```
public static Object invokeExactMethod(
        Object object,
        String methodName,
        Object[] args,
        Class[] parameterTypes)
        throws
        NoSuchMethodException,
        IllegalAccessException,
        InvocationTargetException 
```

甚至

```
public static Object invokeExactMethod(
        Object object,
        String methodName,
        Object[] args)
        throws
        NoSuchMethodException,
        IllegalAccessException,
        InvocationTargetException 
```

它首先定位使用的方法`getAccessibleMethod`，然后调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:14:18.680

这[`MethodHandle`](http://docs.oracle.com/javase/7/docs/api/java/lang/invoke/MethodHandle.html)是一种使用签名（java 7）获取重载方法的新方法：

例子：

```
static class A {
    public String get() {
        return "A";
    }
}

static class B extends A {
    public String get() {
        return "B";
    }
}

public static void main(String[] args) throws Throwable {

    MethodHandles.Lookup lookup = MethodHandles.lookup();
    MethodType mt = MethodType.methodType(String.class);
    MethodHandle mh = lookup.findVirtual(A.class, "get", mt);;

    System.out.println(mh.invoke(new B()));
} 
```

输出：

```
B 
```

# python - python中的类继承和cookie

> ID：11765628
> 
> 赞同：-1
> 
> 时间：2012-08-01T18:51:31.793
> 
> 标签：python, inheritance, cookies

我有一个名为 BlogHandler 的类，其中包含一些基本功能。我将这个类传递给另一个名为 MainPage 的类。我试图在我的 MainPage 类中使用 BlogHandler 的一个函数，但它说它没有定义。

```
class BlogHandler:
    def read_secure_cookie(self, name):
        cookie_val = self.request.cookies.get(name)
        return cookie_val and check_secure_val(cookie_val)

class MainPage(BlogHandler):
    def post(self):
        email = self.request.get('email')
        product = self.request.get('product')
        username = read_secure_cookie('content') 
```

cookie 的“内容”是 14|b670fedff24f182e52a1ceacf7790e02。如何只返回“cookie_val”和“cookie_val”的第一部分（14）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:55:46.470

对于第一个错误，您需要使用：

```
self.read_secure_cookie('content') 
```

任何超类方法也必须用`self`. （还有其他方法，但这是最佳做法。）

至于纠正你的其他问题（我假设你想返回多个值），只需使用逗号而不是`and`：

```
return cookie_val, check_secure_val(cookie_val) 
```

对于您的第三个问题，请按照克里斯所说的拆分：

```
cookie_value.split('|')[0] 
```

把它们放在一起：

```
class BlogHandler:
    def read_secure_cookie(self, name):
        cookie_val = self.request.cookies.get(name)
        return cookie_val, check_secure_val(cookie_val)

class MainPage(BlogHandler):
    def post(self):
        email = self.request.get('email')
        product = self.request.get('product')
        cookie_val, cookie_secure_val = self.read_secure_cookie('content')
        username = cookie_val.split("|")[0] 
```

如果我没有正确理解您，请直说！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T18:56:48.333

`read_secure_cookie` 是 BlogHandler 类的实例方法，这意味着它需要对象作为参数。

通过在`MainPage`类中扩展和添加功能，您已经继承了实例方法，并且可以像Python中的所有实例方法一样访问它们，您需要添加关键字`self`ie

`username = self.read_secure_cookie('content')`

要回答您的第二个问题，给定一个包含内容`myStr = '14|b670fedff24f182e52a1ceacf7790e02'`的字符串，最简单的拆分方法是首先找到您希望拆分的字符： `ind = string.find('|')` 然后将其拆分为两个部分：

`first = myStr[:ind] end = myStr[ind:]`

# node.js - Node.js 和 chrooting 当前进程

> ID：11765630
> 
> 赞同：0
> 
> 时间：2012-08-01T18:51:45.917
> 
> 标签：node.js, chroot

我只需要从 chroot 下的 node.js 脚本运行一部分代码。我已经设置了 chroot 并且正在使用 daemon.chroot。chrooting 效果很好，但我需要能够取消root 进程并在其他地方重新chroot。我现在明白了（在以前的语言中，我会分叉该进程，并让子进程在 chroot 中运行）Node.js chroot 整个运行过程，因此后续尝试 chroot 不同环境会使 Node 抱怨 chroot 不存在，并且它不存在于前一个 chroot 中。

使用 Node 实现 chroot 然后“取消root”一部分代码或进程的这种能力的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T00:44:21.400

取消 chroot 进程并没有什么意义。这就像把某人关进监狱，然后把牢房的钥匙交给他们。Node 应该能够很好地支持您以前的方法：

[http://nodejs.org/api/child_process.html#child_process_child_process_fork_modulepath_args_options](http://nodejs.org/api/child_process.html#child_process_child_process_fork_modulepath_args_options)

它的工作方式与经典的 unix fork 略有不同，但它应该可以很好地支持您的情况。

# google-maps - 谷歌地图地理编码器与谷歌地图 Javascript API V3

> ID：11765633
> 
> 赞同：1
> 
> 时间：2012-08-01T18:52:06.220
> 
> 标签：google-maps, google-maps-api-3, google-geocoding-api

我正在尝试对大量地址进行地理编码，并在 python 中编写了一个小程序来自动化该过程并提取我每天运行的数据，因为限制是每天 2500 个。我注意到 Google Maps Javascript API v3 有 25,000 的礼貌限制并具有地理编码功能。是否可以使用 Google Maps API 进行地理编码，或者我在这里误解了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T19:22:17.550

地理[编码 API 文档](https://developers.google.com/maps/documentation/geocoding/#Limits)状态

> 使用 Google 地理编码 API 的查询限制为每天 2,500 个地理定位请求。

[常见问题解答](https://developers.google.com/maps/faq#usagelimits)中提到了 25000，但指的是***地图加载***，而不是对地理编码器服务的调用。

[地理编码器](https://developers.google.com/maps/documentation/javascript/geocoding)文档说

> Google Maps API 提供了一个地理编码器类，用于根据用户输入动态对地址进行地理编码。这些请求是有速率限制的，以阻止滥用服务。

我找不到 Javascript 地理编码器的已发布费率，但 Google Group 也为此提到了 2500。突发率是可变的，因为它受服务器负载和其他因素的影响，但总体速率为 2500/天。实际上它是以 6 小时为单位测量的：每 6 小时 625 个。

谷歌发表了一篇关于[地理编码策略](https://developers.google.com/maps/articles/geocodestrat)的文章，我有一个[演示者](http://www.acleach.me.uk/gmaps/v3/plotaddresses.htm)展示了如何引入可变延迟来满足突发速率限制。但是，没有什么可以绕过总限制。

# html - HTML5 拖放视频播放列表

> ID：11765639
> 
> 赞同：2
> 
> 时间：2012-08-01T18:52:27.227
> 
> 标签：html, audio, drag-and-drop

我正在开发一个客户端项目，该项目需要能够拥有可以通过拖放移动到播放列表的视频文件。每个视频只有几秒钟长——把它想象成一种视觉节拍混合器。我可以让视频拖放，但我很难找到可以让我将视频添加到播放列表的东西。有没有人对此或网络上的相关示例有任何经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T08:47:30.550

您可能必须将播放列表保存在 javascript 或其他内容的数组中。然后每次拖放（添加或删除）时，插入或删除列表中的元素，然后使用更新的列表重新填充您的显示。我希望这有帮助。

# css - SASS 将边框优化为一行代码

> ID：11765642
> 
> 赞同：4
> 
> 时间：2012-08-01T18:52:34.537
> 
> 标签：css, sass

我不确定这是否可能。但我觉得应该有办法做到这一点。我正在使用 SASS，我正在尝试找到一种优化边界的方法。我希望能够在一行中定义我的边框尺寸、类型和颜色。

在某些情况下，我有 1、2 或 3 个边框。而我想做的是。使用 SASS 编写一些东西，其中所有属性都可以在一行中定义。问题是..

`border-left`:`border-right:` `border-top:`和`border-bottom:`

都是单独的选择器，我想将它们组合起来。

我正在考虑做的是这样的事情......

**须藤代码：**

```
border ($top,$left,$right,$bottom, $type, $color);

#div {
    @include border(1px, 1px, 1px, 0, solid, #CCC);
} 
```

我在想这些方面的东西会很接近......但问题再次是将所有边框选择器组合成一行，以便输出为有效的 CSS。

```
@mixin borders {
  border:($top,$left,$right,$bottom, $type, $color);
} 
```

使用@mixin 是完全错误的，我很确定这一点......所以任何帮助我指向正确方向的帮助将不胜感激。提前致谢..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T14:35:56.340

我想做类似的事情，最后得到了这个@mixin。

```
@mixin border ($style,  $sides...){

    @if ($style != "") {

        @if ($sides == "") {

            border: $style;

        } @else {

            @each $side in $sides {

               @if ($side == 'top' or
                    $side == 'right' or
                    $side == 'bottom' or
                    $side == 'left') {

                    border-#{$side}: $style;

                }

            }

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-21T23:18:09.450

另一种可能：

```
@mixin border( $coordinates: 0 0 0 0, $colour: #000000, $style: solid ) {
  $top: nth($coordinates, 1);
  $right: nth($coordinates, 2);
  $bottom: nth($coordinates, 3);
  $left: nth($coordinates, 4);

  @if not(unitless($top)) {
    border-top: $top $style $colour;
  }
  @if not(unitless($right)) {
    border-right: $right $style $colour;
  }
  @if not(unitless($bottom)) {
    border-bottom: $bottom $style $colour;
  }
  @if not(unitless($left)) {
    border-left: $left $style $colour;
  }

}

$side: 1px;
@include border($side 0 $side 0, black); 
```

CSS 输出：

```
 border-top: 1px solid black;
 border-bottom: 1px solid black; 
```

这样您就可以避免覆盖样式，但如果您需要针对所有边框边，我仍然宁愿使用普通的 css 速记。

如果传递了单个 $coordinates 值，则可能会将其扩展为输出速记属性。这样至少你可以标准化你所有的边框样式调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-22T12:30:50.077

好的，因为没有回复我的评论，这是我如何使用最佳答案中的 mixin：

```
@mixin border($style, $color, $sides) {
    @if ($style != "") {

        @if ($sides == "") {
            border: $style $color;

        } @else {
            @each $side in $sides {
               @if ($side == 'top' or
                    $side == 'right' or
                    $side == 'bottom' or
                    $side == 'left') {

                    border-#{$side}: $style $color;
                }
            }
        }  

    }
} 
```

用法：

```
.use-border {
   @include border(1px solid, #22222, bottom right);
} 
```

您可以在最后一个参数上定义多个方向。好用又好用的mixin！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-21T14:17:34.027

这是我的版本。它并不完美，但它很短。

```
@mixin border($side, $style) {
  @if $side == all {
border: $style;
  } @else {
border-#{$side}: $style;
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-10T15:06:34.143

```
@mixin  border($color: $white, $opacity: 1,$width : 1px,$style : solid, $position: '') {

  @if $position != '' {
    $position : "-#{$position}";
  }
  border#{$position}:#{$width } #{$style} #{$color};
  border#{$position}:#{$width } #{$style} #{rgba($color,$opacity)};
} 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-08-02T18:40:15.050

你不需要mixin。您可以[使用 MDN 上记录的纯 CSS](https://developer.mozilla.org/en/CSS/border)：

> 边框 CSS 属性是一种简写属性，用于在样式表中的单个位置设置各个边框属性值。边框可用于设置以下一项或多项的值：边框宽度、边框样式、边框颜色。

使用简写设置所有边框的宽度、样式和颜色的示例：

```
border: 1px solid #CCC 
```

这将仅在一行中适用于每一侧。如果您希望它有所不同，则可以覆盖特定的一侧：

```
border: 1px solid #CCC
border-top: 0 
```

# jquery - Ajax 调用覆盖小部件工厂中的 $(this) 对象

> ID：11765647
> 
> 赞同：0
> 
> 时间：2012-08-01T18:52:44.450
> 
> 标签：jquery, jquery-plugins

小部件代码：

```
 (function($){

        $.widget("demo.widget", {

            _create: function() {
            },

            _init: function() {
            },

            load: function(){
                var widget = this;
                $.post(
                    Url, 
                    ajaxUtils.success(function(json) {
                    //variable widget is overwritten here if I create multiple instances of the widget

                    alert(widget.element.data("name"));
                    }), "json");

            },

            setOptions: function(name) {
                $(this).data("name", name);
            }

    })(jQuery); 
```

我创建同一个小部件的多个实例。

```
 $('<div/>').widget();
    $('<div/>').data('widget').setOptions("Name1");
    $('<div/>').data('widget').load();

    $('<div/>').widget();
    $('<div/>').data('widget').setOptions("Name2");
    $('<div/>').data('widget').load(); 
```

但是ajax成功调用中的widget变量总是返回Name2。我应该如何编写代码来存储特定于实例的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:08:04.967

`this`在上下文中`var widget = this`是插件对象，而不是插件被初始化的元素。

这个：

```
alert(widget.data("name")); 
```

应该：

```
alert(widget.element.data("name")); 
```

编辑：我不知道该`ajaxUtils`对象及其成功方法发生了什么，它是否返回一个`$.post`成功调用的函数？

# asp.net - VS 2010 多项目解决方案：全局/本地 \bin dll 冲突？

> ID：11765649
> 
> 赞同：0
> 
> 时间：2012-08-01T18:52:52.430
> 
> 标签：asp.net, visual-studio-2010, c#-4.0

我有一个多项目解决方案（2 个应用程序，3 个类库），其中包括一个全局`\bin`文件夹，所有项目都将其 dll 构建到该文件夹​​中。

每个项目也有自己的本地`\bin`. 如果我对其中一个应用程序进行更改，我会遇到源代码与原始版本不同的错误。

我相信这是因为在更改后重建解决方案会更新全局`\bin`程序集而不是本地程序集。解决这个问题的最佳方法是什么？

# algorithm - 解析不规则逗号分隔值的算法

> ID：11765657
> 
> 赞同：1
> 
> 时间：2012-08-01T18:53:29.993
> 
> 标签：algorithm, machine-learning

假设我们有一个包含若干事物描述的列表。描述由逗号分隔的单词组成。让我们以下面的列表为例（每一行都是一个单独的描述）：

```
white, leather, round
black, plastic, rectangular
wood, rectangular, brown
... 
```

我们希望将它们解析为以下结构：（颜色、材质、形状）

前两个描述可以直接映射到我们的结构中。但是第三个就不行了。因为值的顺序不同：材料、形状、颜色。

所以实际的问题是：我们如何检测这些不规则条目并解析它们？

我想我们必须以某种方式检测每个单词描述的部分。但我什至不知道从哪里以及如何开始。我也非常感谢任何提示、算法和论文（关于相关算法）。

**编辑：**抱歉忘了提到没有已知和固定的词汇。在不同的类别中可能有相同的词。但可能我认为我错过的最重要的事情是：**大多数条目都是常规的**。所以我想我们可以用它来增长字典。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T22:24:56.070

如果没有某种约束，这是一个不可能的问题。假设您有某种字典来分类单词（可能是模棱两可的），您可以取得一些进展。下面是一个算法的概要：

1.  首先，将每一行解析为三个单词，而不是对其进行分类。
2.  然后使用字典为每个单词分配一组候选类别（颜色、材料和/或形状）。
3.  如果一个词只有一个类别，则从其他两个词中删除该类别。重复直到没有进一步的进展。
4.  如果所有单词都有一个类别，那么您就完成了并且找到了唯一的解决方案。
5.  如果任何单词的类别为零，则这三个单词不能组合有效。
6.  您现在必须猜测：选择一个具有多个类别的词，然后选择一个类别作为该词的暂定分配。重新应用第 3 步中的规则。
7.  如果任何单词的类别为零，如果没有尝试任何类别，则返回步骤 6；否则退出失败。
8.  如果所有单词都有一个类别，那么您已经找到了一致的分配。如果您只需要*一些*解决方案，那么就退出这个解决方案。如果您想要所有解决方案，请将此解决方案添加到一组解决方案中并返回到第 6 步以再次尝试。
9.  如果某些单词仍然有多个类别，则返回步骤 6（不回溯）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:00:37.133

对于第一步，我的想法是建立颜色、材料和形状的字典，然后基于这个字典进行解析。

否则，您无法检测到哪个单词属于哪个类别

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T22:41:08.760

为每个位置的单词保留三个列表。给定一个新条目，根据其在该列表中的频率（绝对频率和/或相对于其出现的总次数）对每个列表中的每个单词进行评分。对于得分最高的单词列表组合，将该单词与该列表匹配。在剩下的两个单词和两个列表中重复。然后将最后剩余的单词与最后剩余的列表相匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T18:59:56.950

从三个单词列表开始，材料、颜色和形状。对于要解析的每一行，尝试将每个条目与所有三个列表中的一个单词进行匹配。当您有匹配项时，将其放入相关的结构字段中。如果您有 2 个匹配项，请将第三个附加到未匹配列表中。如果您可以匹配少于 2 个条目，则跳过该行并在第二遍中尝试使用更大的列表。如果您无法解析第 3 次之后的行，请让用户解析该行并将条目附加到相关列表中。

# java - Apache 负载平衡 - 如何控制访问哪个服务器？

> ID：11765660
> 
> 赞同：0
> 
> 时间：2012-08-01T18:53:50.217
> 
> 标签：java, apache, application-server

如果我正在构建一个对不同后端服务器进行负载平衡的 apache 服务器：我可以控制将请求交给哪个服务器吗？例如，对于特定用户，总是使用特定的服务器？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:20:53.947

您可以为特定会话使用相同的后台和服务器。（请查看 apache 文档以了解粘性会话方法）关于不同用户到不同服务器的类似主题，我在那里讨论过： http: [//social.technet.microsoft.com/Forums/en/winserverTS/thread/67e05eec-1f26-47e1-ade5- e4c904d5f70c](http://social.technet.microsoft.com/Forums/en/winserverTS/thread/67e05eec-1f26-47e1-ade5-e4c904d5f70c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T22:21:20.560

> 例如，对于特定用户，总是使用特定的服务器？

我不知道您为什么要这样做，但我认为您需要阅读有关会话粘性的信息。

# facebook - 使用 Open Graph 在 WordPress 上定义视频？

> ID：11765661
> 
> 赞同：1
> 
> 时间：2012-08-01T18:53:51.967
> 
> 标签：facebook, wordpress, facebook-opengraph

我有兴趣将我在 WordPress 博客上发布的 YouTube 视频标记为自动标记为 og:video（如果它们被插入到帖子中）——是否有任何插件或简化的方法可以做到这一点？我意识到我可以编辑每个帖子的元标记，但我正在寻找一个更优雅的问题解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T21:51:56.047

此插件可能适用于您所描述的内容： [http ://wordpress.org/extend/plugins/meta-ographr/](http://wordpress.org/extend/plugins/meta-ographr/)

# ios - NSDecimalNumber 设置和获取值

> ID：11765663
> 
> 赞同：3
> 
> 时间：2012-08-01T18:53:56.890
> 
> 标签：ios, nsdecimalnumber

我有以下财产：

```
@property (nonatomic, assign) NSDecimalNumber askingPrice; 
```

我正在尝试从文本字段设置值：

```
myManager.askingPrice = [self.askingPriceTextField.text doubleValue]; 
```

我收到以下警告：

```
Assigning to 'NSDecimalNumber' from incompatible type 'double' 
```

另外，当我尝试获取以下值时：

```
[NSDecimalNumber numberWithDouble:myManager.askingPrice]; 
```

我得到错误：

```
 Sending 'NSDecimalNumber' to parameter of incompatible type 'double' 
```

我以前没有使用过 NSDecimalNumber，但是在 Google 上发现它是在处理货币时使用的。有人可以指出我可以使用的帮助函数，它可以让我做我想做的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T19:06:04.123

采用：

```
myManager.askingPrice = [NSDecimalNumber decimalNumberWithString:self.askingPriceTextField.text] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T19:09:56.560

您在中的`askingPrice`属性`myManager`是`NSDecimalNumber`一个 Cocoa 类，它围绕十进制数字包装一个对象。你`askingPriceTextField.text`给你一个`NSString`你可以转换成一个`float`或`double`。

所以基本上你想要做的是在你的文本字段中`NSDecimalNumber`使用构建一个新的。`NSString`以下是您的操作方法：

```
double askingPriceDouble = [self.askingPriceTextField.text doubleValue]; // extract a double from your text field
myManager.askingPrice = [[NSDecimalNumber alloc] initWithDouble:askingPriceDouble]; //create an NSDecimalNumber using your previously extracted double 
```

我在这里使用 alloc-init 方案，因为您将属性设置为`assign`ed。由于 an`NSDecimalNumber`是一个对象（不是像 那样的基本类型`double`），因此您要么需要确保您的要价是`retain`ed，因此在您需要它之前它不会被释放。另一种方法是像这样声明您的财产：

```
@property(nonatomic, retain) NSDecimalNumber *askingPrice; // Do not forget the '*' sign when declaring object properties as pointers. 
```

进而：

```
double askingPriceDouble = [self.askingPriceTextField.text doubleValue];
myManager.askingPrice = [NSDecimalNumber numberWithDouble:askingPriceDouble]; 
```

这将起作用，因为您的askingPrice 属性将`retain`在您设置它时被编辑。

另外，不要忘记确保您的文本字段的内容实际上可以转换为双精度...

# database - 查找要导入的 POI/业务目录数据

> ID：11765665
> 
> 赞同：1
> 
> 时间：2012-08-01T18:53:58.810
> 
> 标签：database, api, google-places-api, yellow-pages

我正在创建一个应用程序，我需要每个城市的基本业务目录数据，例如餐厅名称、地址和电话号码，并将其导入我的数据库。

有谁知道我在哪里可以做到这一点？

有什么免费的吗？也许不太贵？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T21:02:58.593

这两种方法是从下面的资源中免费自己编译，但这会非常耗时且资源密集：

* * *

黄页目录

白页目录

国税局记录

公司注册记录

* * *

我找到了两个商业资源，一个声称 2000 万业务，售价 80 美元[http://www.usadatabase.info/features.html](http://www.usadatabase.info/features.html)和[http://leads.infousa.com/USBusinesses.aspx?bas_vendor=190000](http://leads.infousa.com/USBusinesses.aspx?bas_vendor=190000)需要注册才能访问有定价和数据库信息。可能还有其他更便宜或更好的资源，但这些似乎是您可以比较的东西。如果您不需要静态数据库，使用 google places api 的建议似乎是最好的。

# xcode - Xcode：在构建脚本中设置版本

> ID：11765669
> 
> 赞同：1
> 
> 时间：2012-08-01T18:54:12.463
> 
> 标签：xcode, build, plist, bundle

我正在尝试使用脚本为版本设置自动版本号。

我的第一个构建阶段（在目标依赖项之后）是使用此脚本的运行脚本：

```
if [ "${CONFIGURATION}" = "Release" ]; then
/usr/libexec/PlistBuddy -c "Set :CFBundleVersion `date +%Y%m%d%H%M`" ProtoMemory/ProtoMemory-Info.plist
fi 
```

或者用简单的英语：如果这是一个发布版本，请将构建版本设置为发布日期和时间。

该脚本完全符合我的要求，但它似乎是在将`Info.plist`文件复制到捆绑包之后执行的。这意味着我最终在源代码中获得了正确的内部版本号，但在我的捆绑包中却没有。

现在，我正在使用一个愚蠢的解决方法，在我制作存档之前我构建它一次（实际上构建它两次）。在复制文件之前有没有办法调用构建脚本`Info.plist`？还是 Xcode 使用了某种缓存版本的 plist？或者也许我可以添加一个最终构建阶段，将`Info.plist`文件再次复制到包中......

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-23T16:23:09.393

也许你可以使用`agvtool`？

`agvtool new-version -all `date +%Y%m%d%H%M``

# c - 关于malloc的问题

> ID：11765671
> 
> 赞同：2
> 
> 时间：2012-08-01T18:54:23.020
> 
> 标签：c, malloc, sizeof

有人可以向我解释这部分代码吗？如果我错了，请纠正我。

```
int *longest = malloc(sizeof(int)); 
*longest =0; 
```

意思是不是：

1.  返回一个指向大小为 4 字节的内存块开头的指针（对于 32 位机器）？为什么不直接写`malloc(4)`？
2.  对于第二行，是否意味着最长的是一个 4 字节块的指针，从 0 开始？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T18:56:19.667

1.  是的，它为一个`int`. 您应该避免明确假设给定的大小 - 这使得将来移植到其他平台成为一场噩梦。你自己发现了 -`sizeof(int)`不会总是到处都是 4。

2.  不，这会将值 0 分配给由 指向的新分配的内存`longest`。这里`*`是取消引用运算符，它非正式地说“我想使用这个指针指向的东西”。

# c++ - C2057 构造函数初始化列表中的 const 值定义错误

> ID：11765677
> 
> 赞同：1
> 
> 时间：2012-08-01T18:54:55.447
> 
> 标签：c++, visual-c++

我遇到 C2057 错误（在 Visual Studio 2010 上），我不知道为什么。我知道要初始化堆栈上的数组，必须在编译时知道大小，这就是为什么需要使用 const 值的原因（至少在 Visual Studio 上，因为在 gcc 中不允许使用可变长度数组）。我的班级中有一个 const value 成员，我在初始化列表中定义了他的值。所以从技术上讲，这个值在编译时是已知的，对吧？我想了解为什么它不起作用？这是一个片段：

```
class Dummy
{
    Dummy() : size(4096) {}

    void SomeFunction()
    {
        int array[size]; //return C2057 
        //...
    }

    const unsigned int size;
}; 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-01T18:58:29.993

不幸的是，这个 const 值不是编译时常数。您需要一个枚举、一个静态整数类型或一个 C++11 `constexpr`。

另一种选择是制作`Dummy`一个类模板，采用非类型参数：

```
template <unsigned int SIZE>
class Dummy
{
    void SomeFunction()
    {
        int array[SIZE];
        //...
    }
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-01T18:57:33.427

`size`是 const，但在编译时不知道是 4096。

默认构造函数创建一个大小为 4096 的 Dummy，但谁说 Dummy 类不是用不同大小构造的？如果有另一个构造函数允许不同的大小，那么编译器不能假设它`size`总是 4096，所以它会给出编译时错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-02T05:44:35.750

对所有对象都具有相同值的 const 数据成员可能不是您想要的。如果你想在一个类中嵌套一个符号常量，你有两个选择：

```
class Dummy
{
    // ...

    static const unsigned int size = 4096;
    enum { another_size = 4096 };
}; 
```

# sql - Oracle SQL - 选择 *，案例

> ID：11765681
> 
> 赞同：0
> 
> 时间：2012-08-01T18:55:11.507
> 
> 标签：sql, oracle11g

Oracle SQL 开发人员 3.0.03

我正在尝试运行 Select * 然后在末尾有另一列，该列生成具有指定结果的新列：

```
 select *, 
    case Column_1 when 'Employee' then 'Employee/Worker' 
    when 'Worker' then 'Employee/Worker' else Column_1 
    end as "TEST"
    from DB_TABLE 
```

结果应该是：

```
Column 1    Column 2   ......Test
Employee    Name             Employee/Worker
Worker      Name             Employee/Worker
Temp        Name             Temp 
```

我已经让它在 MS SQL 中工作，但无法在 Oracle 中工作。有任何想法吗？

![在此处输入图像描述](../Images/e5b3fe1c51bc93a389a78da3914cd0f7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T09:12:22.770

试试这个给表名的别名

```
select dt.*, 
case when dt.Column_1 = 'Employee' then 'Employee/Worker'
     when dt.Column_1 = 'Worker'   then 'Employee/Worker'       
     else dt.Column_1  end TEST
from DB_TABLE dt 
```

# c - 如何在 Linux 中读取文件/文件夹属性？

> ID：11765683
> 
> 赞同：-1
> 
> 时间：2012-08-01T18:55:13.100
> 
> 标签：c, linux

如何在 C 中检索文件/文件夹的属性，尤其是在 Linux 中？

我需要有关创建日期、上次修改日期、isDirectory 或 isFile、权限、所有权和大小的信息。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:57:31.333

您很可能需要该[`stat()`功能。](http://linux.die.net/man/3/stat)

例子：

```
struct stat attr;
stat("/home/crazyfffan/foo.txt", &attr);

printf("Size: %u\n", (unsigned)attr.st_size);
printf("Permissions: %o\n", (int)attr.st_mode & 07777);
printf("Is directory? %d\n", attr.st_mode & ST_ISDIR); 
```

等等

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-01T19:00:15.290

使用[`stat`](http://linux.die.net/man/2/stat)系统调用。`man 2 stat`.

您将获得一个包含您正在寻找的内容的结构。

从手册页：

```
struct stat {
           dev_t     st_dev;     /* ID of device containing file */
           ino_t     st_ino;     /* inode number */
           mode_t    st_mode;    /* protection */
           nlink_t   st_nlink;   /* number of hard links */
           uid_t     st_uid;     /* user ID of owner */
           gid_t     st_gid;     /* group ID of owner */
           dev_t     st_rdev;    /* device ID (if special file) */
           off_t     st_size;    /* total size, in bytes */
           blksize_t st_blksize; /* blocksize for file system I/O */
           blkcnt_t  st_blocks;  /* number of 512B blocks allocated */
           time_t    st_atime;   /* time of last access */
           time_t    st_mtime;   /* time of last modification */
           time_t    st_ctime;   /* time of last status change */
       }; 
```

查看手册页中的示例以获取有关使用该`st_mode`字段确定文件类型的详细信息；这是检查`isDirectory`/`isFile`使用 POSIX 宏的方法：

```
isDirectory = S_ISDIR(statBuf.st_mode);
isFile = S_ISREG(statBuf.st_mode); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T19:05:09.260

```
struct stat file_stats;    

fd = open(filename, O_RDONLY);
if (fd == -1) {
    exit(-1);
}

if (fstat(fd, &file_stats) < 0) {
    exit(-1);
}
if (S_ISDIR(file_stats.st_mode)) {
      printf("It is dir\n");
} else {
    snprintf(msg, PATH_MAX, "%lld, %ld, %o, %d, %d, %d, %lld, %ld, %ld, %ld, %ld, %ld,
    %ld\n",
            file_stats.st_dev,
            file_stats.st_ino,
            file_stats.st_mode,
            file_stats.st_nlink,
            file_stats.st_uid,
            file_stats.st_gid,
            file_stats.st_rdev,
            file_stats.st_size,
            file_stats.st_blksize,
            file_stats.st_blocks,
            file_stats.st_atime,
            file_stats.st_mtime,
            file_stats.st_ctime);
} 
```

# c# - 带有数据表的 C# Linq - 从一个表中选择另一个表中不存在的内容

> ID：11765684
> 
> 赞同：1
> 
> 时间：2012-08-01T18:55:19.340
> 
> 标签：c#, linq

例如，我有两个看起来像这样的表

数据表 1

```
COLA  |  COLB  |  COLC 
 1       123      321
 2       321      333
 3       222      232 
```

数据表 2

```
COLA  |  COLB  |  COLC 
 1       123      321
 2       321      333 
```

我只想从表一中选择第 3 行。

我希望能够在 COLA ID 上将两个表连接在一起，然后只选择 DATATABLE 1 中不存在于 DATATABLE 2 中的行。

我怎样才能在 LINQ 中做到这一点？

我强烈希望结果是数据表，或 Ienumerable 或易于更改回数据表的东西。如果不可能，我会管理的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-01T19:14:06.433

```
var rows = from t1 in table1.AsEnumerable()
           join t2 in table2.AsEnumerable() 
               on t1.Field<int>("COLA") equals t2.Field<int>("COLA") into tg
           from tcheck in tg.DefaultIfEmpty()
           where tcheck == null
           select t1 
```

这最终会执行左外连接，并且其中的任何行都`table2`为 null 意味着记录中的记录`table1`不匹配。我建议不要使用该`Any`方法，因为它可能会枚举`table2`中的每一行`table1`（对于较大的集合，这很糟糕）。LINQ Join 将仅枚举两个表一次，以便为您指定的选择器函数找到匹配对。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-01T18:57:50.370

最简单的方法是：

```
var dt2Cola = new HashSet<int>(table2.AsEnumerable()
                                     .Select(x => x.Field<int>("COLA"));

var dt1Rows = table1.AsEnumerable()
                    .Where(x => !dt2Cola.Contains(x.Field<int>("COLA")); 
```

# c# - 在 ios 应用程序中监听 asp.net mvc-4 服务器

> ID：11765695
> 
> 赞同：1
> 
> 时间：2012-08-01T18:55:56.263
> 
> 标签：c#, objective-c, sockets, rest, client-server

我的服务器是一个 REST 平台（使用 asp.net MVC 4 web api 构建），我的客户端是 ios 应用程序（当然是在 Objective-c 中）。目前，对于所有操作，客户端使用 http POST、GET、PUT、DELETE 查询服务器。但是有一种情况是服务器需要通知客户端发生了一些事情。

Apple 方式是推送通知，当用户为应用程序授权推送通知时可以，但即使用户关闭推送通知，我也需要通知应用程序（当它在前台时）。

现在有两种方法可以做到：

1.  客户端每隔几秒查询一次服务器（在 http GET 中）是否发生了什么事（我们到了吗？我们到了吗？:)
2.  客户端以某种方式打开到服务器的套接字并将其保持打开状态，等待服务器通过打开的会话通知它发生了某些事情。

那么你建议做什么？1 还是 2？还是有第三种方法？如果选项 2 有人可以引导我如何有效地做到这一点？考虑到我的应用程序应该处理超过 100,000 个活跃用户？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:27:50.367

看看[SignalR](http://signalr.net)。它是 Microsoft 实时库，但有人为其编写了[iOS 客户端库](https://github.com/DyKnow/SignalR-ObjC)。

# javascript - 限制集合 - .first 不适用于 CompositeViews

> ID：11765696
> 
> 赞同：0
> 
> 时间：2012-08-01T18:56:01.233
> 
> 标签：javascript, backbone.js, marionette

我想显示前 100 个条目，或集合中 101 到 200 之间的条目。

如果我创建一个 Marionette CompositeView 并指定

```
someRegion.show new MyCompositeView(collection: myCollection.first(100)) 
```

我得到一个错误。只有通过才`myCollection`有效。什么是正确的语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:10:43.957

我没用过木偶，但是...

`Collection.first(n)`返回模型数组，而不是集合对象。如果视图期望该属性是一个集合，但您正在传递一个数组，那么这就是您的问题。

您可以从 .first(n) 获取结果并将其传递到新集合中：

```
someRegion.show new MyCompositeView({collection: new Backbone.Collection(myCollection.first(100))}) 
```

# web-services - Java/Spring Jax-ws 在 .Net 的 WSDL 中公开复杂类型

> ID：11765699
> 
> 赞同：1
> 
> 时间：2012-08-01T18:56:04.447
> 
> 标签：web-services, jax-ws

我正在尝试使用 cxf 创建一个 Java Spring Web 服务。我正在采用（自下而上）采用 Java 合同并注释代码以生成 Web 服务的方法。

给定以下带注释的 Web 界面代码。

**网页界面：**

```
package org.webservice;
import java.util.ArrayList;
import java.util.Calendar;
import javax.jws.WebMethod;

@WebService
public interface WebInterfaceI {
    @WebMethod(operationName = "writeXML")
    public String writeStuff(String objectType, String payloadXML,
                             String callerInfo, String options);
@WebMethod(operationName = "XML")
    public ArrayList<String> readStuff(KeyValuePair Data, Calendar asOfDate,
                                       KeyValuePair options);
} 
```

writeStuff *()*函数很好地暴露在 WSDL 中。

readStuff *()*方法传递一个称为 KeyValuePair 的复杂类型（我知道这不是一个好名字）。这些是在单独的文件中定义的（尽管我也尝试将其设为本地类）。

**键值对类：**

```
package org.webservice;
import java.io.Serializable;
import java.util.List;
import javax.jws.WebService;

public class KeyValuePair implements Serializable {    
    private static final long serialVersionUID = 1L;
    KeyValuePair() {
        myValues = null;
        myKeys = null;
    }
    KeyValuePair(List<String> keys, List<String> values) {
        myValues = values;
        myKeys = keys;
    }
    List<String> myValues;
    List<String> myKeys;
} 
```

但是在 WSDL 中，KeyValuePair 被简单地列为复杂类型。因此，当我将 .Net4 服务引用指向 WSDL 时，生成的代码会将 KeyValuePair 视为对象。

**生成的 .Net 客户端代码：**

```
 public partial class keyValuePair: object, System.ComponentModel.INotifyPropertyChanged {
        public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;
        protected void RaisePropertyChanged(string propertyName) {
            System.ComponentModel.PropertyChangedEventHandler propertyChanged = this.PropertyChanged;
            if((propertyChanged != null)) {
                propertyChanged(this, new System.ComponentModel.PropertyChangedEventArgs(propertyName));   
            }
        }
    } 
```

KeyValuePair 的成员未公开，因此无法在客户端上填充一个。

所以问题是：

**我正在尝试做的事情真的可能吗？**

**有没有一种简单的方法可以使用注释通过 WSDL 公开 KeyVlauePair（我相信这称为数据契约）？**

**还是必须以另一种方式完成（通过以某种方式指定 KeyValuePair 的 XSD 文件？）**

我在用着：

弹簧工具套件 2.9.2

CXF 2.6.1

.Net 4 通过 VS 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T23:22:36.720

嗨@DUFF也许不是你将KeyValuePair对象填充到WEB服务中你可以在KeyValuePair类上尝试这样的事情，

```
public class KeyValuePair implements Serializable {
    private static final long serialVersionUID = 1L;
    List<String> myValues;
    List<String> myKeys;

    public KeyValuePair(List<String> keys, List<String> values) {
        this.myKeys = keys;
        this.myValues = values;
    }

    public List<String> getMyValues() {
        return myValues;
    }

    public void setMyValues(List<String> myValues) {
        this.myValues = myValues;
    }

    public List<String> getMyKeys() {
        return myKeys;
    }

    public void setMyKeys(List<String> myKeys) {
        this.myKeys = myKeys;
    }
} 
```

在您可以为暴露的 WSDL 文件填充 KeyValuePair 对象之前。

**希望这些有所帮助。**:)

# c# - AJAX 更新面板会影响 C# 代码吗？

> ID：11765701
> 
> 赞同：0
> 
> 时间：2012-08-01T18:56:07.863
> 
> 标签：c#, asp.net, ajax, visual-studio-2010, updatepanel

我问的原因是因为我有一个更新面板，里面装满了文本框、标签等，我根据用户点击的内容使其可见/不可见。后来，我运行一个循环来清除所有的文本框。它以前工作得很好，但现在我添加了 AJAX 更新面板，它给了我一个“无效的回发或回调参数”错误。

这是因为那个 AJAX 更新面板吗？还是我自己做错了什么？

谢谢，艾莉

[编辑]：好的，我正在添加一大堆代码，因为我不知道它来自哪里：

这是写入记录的方法：

```
protected void AddEmployerRecord()
    {
        connection = new SqlConnection();
        connection.ConnectionString = "****";
        connection.Open();

        newEmployer = new EmployerCRUD(connection);

        employerRow.employerName = tb_employer.Text;
        employerRow.empPhone = tb_phone.Text;
        employerRow.empFax = tb_fax.Text;
        employerRow.empEmail = tb_email.Text;
        employerRow.empAddress = tb_address.Text;
        employerRow.empCity = tb_city.Text;
        employerRow.empState = ddl_state.SelectedValue.ToString();
        employerRow.empZIP = tb_ZIP.Text;
        employerRow.startDate = Convert.ToDateTime(tb_fromDate.Text);
        employerRow.endDate = Convert.ToDateTime(tb_toDate.Text);
        employerRow.startPay = Convert.ToDecimal(tb_startPay.Text);
        employerRow.endPay = Convert.ToDecimal(tb_endPay.Text);
        employerRow.leaveReason = tb_leaveReason.Text;
        employerRow.supervisorFName = tb_superFName.Text;
        employerRow.supervisorLName = tb_superLName.Text;
        employerRow.contactForRef = rbl_contact.SelectedValue.ToString();
        employerRow.jobDesc = tb_jobDesc.Text;
        employerRow.applicantID = 10010;
        //employerRow.applicantID = Convert.ToInt32(Session["ApplicantNum"]);
        employerRow.supervisorTitle = tb_superTitle.Text;
        employerRow.jobTitle = tb_jobTitle.Text;
        employerRow.startPayType = ddl_startPayType.SelectedValue.ToString();
        employerRow.endPayType = ddl_endPayType.SelectedValue.ToString();

        ct_emp = newEmployer.Add(employerRow);
        // *************** Error Message *************** //
        //if (ct_emp.Message != "OK")
        //    Error message
        //else
        //    

        connection.Close();
    } 
```

这是加载网格的方法：

```
protected void LoadGrid()
    {
        try
        {
            SqlConnection pConnection = new SqlConnection();
            pConnection.ConnectionString = "**";
            pConnection.Open();
            string sqlstatement = "SELECT EmployerID, EmployerName FROM dbo.EMPLOYER WHERE ApplicantID = @applicantID";
            command = new SqlCommand(sqlstatement, pConnection);
            command.Parameters.AddWithValue("@applicantID", 10010);
            //command.Parameters.AddWithValue("@applicantID", Session["ApplicantNum"].ToString().Trim());
            ds = new DataSet();
            adapter = new SqlDataAdapter(command);
            builder = new SqlCommandBuilder(adapter);
            adapter.Fill(ds);
            gv_employers.DataSource = ds.Tables[0];
            gv_employers.DataBind();
            pConnection.Close();
        }
        catch (Exception error)
        {
            Response.Write(error.Message);
        }
    } 
```

顺便说一句，当我调试东西（需要一致性）时，申请人 ID 只有 10010。

另外，我在某处读到，当您尝试将数据重新绑定到网格时会出现此问题。每次重新加载页面时，我都会运行该 LoadGrid() 方法。我应该将数据绑定到其他地方吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:02:56.550

如果您想要一种简单的方法来清除所有文本框，请使用类似这样的方法

```
 public  void ClearTextItems(ControlCollection controls)
    {
        foreach (Control c in controls)
        {
            if (c is System.Web.UI.WebControls.TextBox)
            {
                TextBox t = c as TextBox;
                t.Text = string.Empty;
            }
        }
     } 
```

将需要查看您收到回发错误的其他代码...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:03:44.527

仅添加 UpdatePanel 不会导致该错误。

UpdatePanels 封装页面的一部分并导致该部分的部分刷新。

您是否正在更新控件集合？根据某些用户输入动态添加控件或用户控件？

检查控件上的 ViewState 或控件集合的添加。

# java - 集合的伪随机遍历

> ID：11765703
> 
> 赞同：4
> 
> 时间：2012-08-01T18:56:17.623
> 
> 标签：java, random

我一直在阅读*Game Coding Complete（第 4 版）*，但在第 3 章的“Grab Bag of Useful Stuff”部分中理解“Pseudo-Random Traversal of a Set”路径时遇到了一些问题。

> 您有没有想过 CD 播放器上的“随机”按钮是如何工作的？它会随机播放您 CD 上的每首歌曲，而不会将同一首歌曲播放两次。这是一个非常有用的解决方案，可以确保游戏中的玩家在有机会再次看到相同的特征之前看到最广泛的特征，例如对象、效果或角色。

在此描述之后，它继续讨论我尝试在 Java 中实现但无法成功复制的 C++ 实现。它还简要描述了它的工作原理，但我也不明白。

我发现[这个](https://stackoverflow.com/a/3305416/244098)StackOverflow 回答了一个类似的问题，但不幸的是，答案中的示例链接已经失效，我也不理解 Wikipedia 文章，尽管关于它所做的描述似乎描述了我正在寻找的内容。

需要明确的是，我**不是**在寻找一种随机重新排序集合的方法。我正在寻找一种在重复之前从集合中随机选择一个元素的方法。

有人可以解释这种行为是如何工作的并提供一个 Java 示例吗？谢谢！

[**编辑**] 我认为在此处摘录实现可能很有用，以帮助解释我在说什么。

> 这是它的工作原理。通过选择三个大于零的随机值来计算跳过值。这些值成为二次的系数，域值 (x) 设置为集合的序数值：

```
Skip = RandomA * (members * members) + (RandomB * members) + RandomC 
```

> 有了这个跳过值，您可以使用这段代码以伪随机顺序遍历整个集合一次：

```
nextMember += skip;
nextMember %= prime; 
```

> skip 的值远大于集合中的成员数，以至于所选值似乎随机跳过。当然，这段代码在一个 while 循环中，以捕捉所选值大于您的设置但仍小于质数的情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-03T15:55:36.467

以下是在获取一组字符的随机排列的情况下的示例：

```
public static void main(String[] args) {
    // Setup
    char[] chars = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j' };
    int prime = 11; // MUST be greater than the length of the set
    int skip = 0;
    int nextMember = 0;

    // If the skip value is divisible by the prime number, we will only access
    // index 0, and this is not what we want.
    while (skip % prime == 0) {
        // Generate three random positive, non-zero numbers
        int ra = new Random().nextInt(prime) + 1;
        int rb = new Random().nextInt(prime) + 1;
        int rc = new Random().nextInt(prime) + 1;
        skip = ra * chars.length * chars.length + rb * chars.length + rc;
    }

    String result = "";
    for (int x = 0; x < chars.length; x++) {
        do {
            nextMember += skip;
            nextMember %= prime;
        } while (nextMember <= 0 || nextMember > chars.length);
        result += chars[nextMember - 1];
    }

    // Print result
    System.out.println(result);
} 
```

本书中示例的大多数条件都出现在上面的代码示例中，但也有一些例外。首先，如果跳过可以被素数整除，则该算法不起作用，因为由于这部分代码，它只会访问索引 0：

```
 nextMember += skip;
            nextMember %= prime; 
```

其次，三个系数介于 1 和素数之间，包括 1 和素数，但不一定如此。它可以是任何正的、非零的数字，但我发现如果我这样做，我将有整数溢出并得到一个负的跳过值，这是行不通的。这种特殊情况可以通过获取跳跃值的绝对值来解决。

最后，您需要检查下一个成员是否是介于 1 和集合长度（含）之间的数字，然后获取索引处的成员比该数字小一。如果您不这样做（如果您只检查数字是否小于集合的长度），那么无论何时运行程序，这很有趣，但对于随机遍历是不可取的。

该程序将选择一个不同的索引，直到所有索引都被访问，然后它会重复。当它重复时，将产生相同的排列（这是它应该如何工作的），所以如果我们想要一个不同的排列，你需要计算一个新的跳过值。该程序由于二次方程和素数的特性而起作用。我无法详细解释它而不怀疑我在说什么，并且或多或少类似的描述已经出现在书中。

我已经在 3 个和 5 个字符的集合上运行了这个程序的一个稍微修改过的版本。对于这两种情况，每个排列都是均匀分布的，与平均分布的预期平均次数相比，平均绝对差分别为 0.0413% 和 0.000000466726%。两者都运行以产生 6000 万个样本。不会产生重复字符的排列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T09:17:14.730

该算法实际上与随机或随机外观相去甚远。

这种方法只是简单地使用一段跳过 % 素数的周期，然后删除位于 array.length 之外的所有值。

用一个小的素数，你可以很容易地找出模式：

用你填充数组`[0, 1, 2, 3..., 9]`并选择系数 3、5、7 - 素数 11，我们得到 753 的跳过。但是，`753 % 11`是 5，所以实际步长是 5。

结果（使用您的实现）是

`[4, 9, 3, 8, 2, 7, 1, 6, 0, 5]`

我们可以在这里看到步骤：

+5、-6、+5、-6、+5、-6、+5、-6、+5

（-6 来自 (x + 5) % 11，对于 6 <= x <= 10 与 x - 6 相同）

无论您选择什么数字，您都会看到这种模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T19:04:37.677

从集合中随机选择非重复元素与将其打乱并从打乱列表中按顺序选择相同。

```
shuffled = shuffle(my_list);
first = pop(shuffled);
second = pop(shuffled); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-01T19:08:39.047

我将通过在随机位置插入原始列表的成员来创建列表的副本，如下所示：

```
List<T> randomOrder = new ArrayList<T>(original.size());
Random rand = new Random();
int currentSize = 0;
for (T member : original) {
    randomOrder.add(rand.nextInt(++currentSize), member);
} 
```

因此 randomOrder 应该成为原始列表的副本，但具有不同的随机顺序。原名单不受影响。（显然，将 T 替换为列表的类型。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-01T19:09:44.393

这是一个例子：

```
import java.util.*;

public class Randy {

    public static void main(String[] args) {
        ArrayList<String> list = new ArrayList<String>();
        ArrayList<String> copy = new ArrayList<String>();
        list.add("Jack");
        list.add("Tess");
        list.add("Alex");
        list.add("Jeff");
        list.add("Kelli");
        Random randy = new Random();
        int size = list.size();
        for(int i = 0; i < size; i++) {
            int r = randy.nextInt(list.size());
            System.out.println(list.get(r));
            copy.add(list.get(r));
            list.remove(r);
        }
        list = copy;
        copy.clear();
    }

} 
```

在这里，我有一个由字符串对象组成的 ArrayList 列表。然后在 for 循环中，我以随机顺序打印出这些字符串，并从列表中删除随机选择的元素，因此没有重复的输出。但是在我删除元素之前，我将它添加到另一个 ArrayList，复制，所以我不会完全丢失元素。最后，我将列表设置为复制，一切都恢复了，你可以一遍又一遍地重复这个过程。

# c# - MVC3 - 让服务层工作

> ID：11765704
> 
> 赞同：0
> 
> 时间：2012-08-01T18:56:18.273
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework

我试图让一个基本服务层在我的应用程序中工作，但我遇到了麻烦。

界面：

```
public interface IEmailer
    {
        string ServiceTest();
    } 
```

服务：

```
public class SimpleMailer : IEmailer
    {
    public string ServiceTest()
        {
            var ServiceVar = "This is your service working";
            return ServiceVar;
        }
    } 
```

控制器：

```
 public class EmailSendController : Controller
    {

    private IEmailer _service;

     public EmailSendController()
        {
            _service = new SimpleMailer();

        }

        public EmailSendController(IEmailer service)
        {
            _service = service;
        }

        [HttpPost]
        public ActionResult Edit()
        {

            _service.ServiceTest();

            return View();
        }
    }
} 
```

我收到一个`_service.ServiceTest();`空错误。我做错了什么阻止它返回`ServiceVar`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:21:28.037

这一切都取决于被击中的控制器构造函数。如果您正在点击采用 IEmailer 参数的构造函数，那么您需要有一种方法来创建 SimpleMailer 具体类以提供给构造函数。使用该实例创建此控制器的典型方法是使用依赖注入。我假设它正在尝试使用该构造函数创建控制器，因为发生了空引用异常。

您能否将您的 Ninject 映射代码与您的 Global.asax.cs 代码一起发布，以便我们准确了解您如何实现 Ninject 容器？如果没有看到代码，很难确定问题可能是什么。

您不仅需要在 Application_start 中设置一个容器，而且还需要一个用于 Ninject 的 IDependencyResolver 实现，如果您查看的话，它应该可以通过 NuGet 获得。这就是您的控制器将能够查找其参数的具体实现以创建控制器的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:56:46.913

确保您的`NinjectWebCommon.cs`-> `RegisterServices()`（或`global.asax`->`CreateKernel()`如果您以这种方式使用它）中有以下内容：

```
kernel.Bind<IEmailer>().To<SimpleMailer>().InRequestScope(); 
```

此外，删除您的无参数构造函数（或暂时将其“移除”）以测试它是否通过 Ninject 工作，否则将永远不会命中参数化 ctor。

**[编辑]**刚刚注意到，您的代码中没有`HttpGet`操作方法，因此我建议您将`HttpPost`操作的签名更改为`HttpGet`，否则，您无法从当前控制器中存在的任何内容中调用获取请求。

# google-chrome - 从源代码编译 clank (Chrome for Android) 给出错误：stdio.h: No such file or directory

> ID：11765707
> 
> 赞同：1
> 
> 时间：2012-08-01T18:56:35.493
> 
> 标签：google-chrome

我正在尝试从此处提到的 268MB chrome_android.v18.0.1025123.tgz 编译 clank（现在称为 Chrome for Android？）：[https ://developers.google.com/chrome/mobile/docs/faq](https://developers.google.com/chrome/mobile/docs/faq)

我在那里遵循了 README.Chrome_for_Android_SourceDistribution 并在[http://src.chromium.org/chrome/trunk/src](http://src.chromium.org/chrome/trunk/src)上从 master 构建了 Android （截至 2012 年 7 月 31 日）。

然后我到了我建立叮当声的部分：

```
cd external/chrome && . build/android/envsetup.sh && clank_gyp && make -j16 libchromeview.so 
```

起初我遗漏了一些未提及的依赖项，这些依赖项很容易通过以下方式修复：

```
sudo apt-get install libgtk2.0-dev libgconf2-dev libgnome-keyring-dev libdbus-glib-1-dev libudev-dev 
```

现在我看到这样的编译错误：

```
 In file included from third_party/skia/include/core/SkTypes.h:15:0,
             from third_party/skia/include/core/SkTime.h:13,
             from third_party/skia/src/animator/SkTime.cpp:10:
 third_party/skia/include/core/SkPostConfig.h:145:27: fatal error: stdio.h: No such file or directory 
```

我在 android 源代码内的许多文件夹中看到 stdio.h。

我怎么知道该使用哪一个？为什么正确的还没有被使用？

PS 我正在使用 Ubuntu12.04-amd64，我想为 Nexus 7 编译铿锵声。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T16:30:23.353

我发现出了什么问题。我用它来查看构建的更多输出：

出口V=1

这让我注意到以下包含目录不正确：

```
-I/home/alex/android/master/prebuilt/ndk/android-ndk-r8/platforms/android-9/arch-arm/usr/include 
```

它应该是“.../prebuilds/...”，而不是“.../prebuild/...”：

```
-I/home/alex/android/master/prebuilts/ndk/android-ndk-r8/platforms/android-9/arch-arm/usr/include 
```

我为此使用了一个简单的解决方法：

```
ln -s /home/alex/android/master/prebuilts /home/alex/android/master/prebuilt 
```

这允许进一步编译。

在能够成功编译之前，我还必须解决两个问题，但它们与这个问题无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T21:19:56.720

您可能需要其他依赖项并确保您的环境设置为指向 sdks，您可能需要查看此站点： [https ://code.google.com/p/chromium/wiki/AndroidBuildInstructions](https://code.google.com/p/chromium/wiki/AndroidBuildInstructions)

# ios - ios - 如何在其中设置 UITableView 的行数和值，以便在点击时通过 id 识别它们？

> ID：11765708
> 
> 赞同：0
> 
> 时间：2012-08-01T18:56:36.170
> 
> 标签：ios, ios5

我有一个循环，它解析从远程服务器返回的 JSON，我能够循环遍历它并获取值，但我不确定如何使用返回的数据设置我的 UITableView。

如何重置 UITableView 已经认为它将拥有的预期行数？我如何实际设置这些值？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:15:28.340

将数据存储在数组中。然后在完成数据解析后重新加载表，如下所示：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    // when the array is empty, this will just return 0 and your table will 
    // be empty until your data is done downloading
    return [myArray count];
} 
```

在解析数据的方法中：

```
-(void)parseFinished {
    // once the data finished downloading and parsing:
    [self.tableView reloadData];
} 
```

要知道您需要将哪个对象传递给视图控制器或对数据执行任何其他操作：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    SomeViewController *viewController = [[SomeViewController alloc] initObject:[myArray objectAtIndexPath:indexPath]];
    [self.navigationController pushViewController:viewController animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:20:37.690

对于你问题的第二部分，你想要......

```
- (void)tableView:(UITableView *) didSelectRowAtIndexPath:(NSIndexPath *)path
{
    NSUInteger column = path.column;
    NSUInteger row = path.row;

    //The row and/or column values should be useful in accessing your data source array.
} 
```

# android - 有没有办法在 Android 的 OAuth Login Webview 中替换 salesforce 徽标？

> ID：11765711
> 
> 赞同：2
> 
> 时间：2012-08-01T18:56:44.130
> 
> 标签：android, oauth, salesforce, android-webview, oauth-2.0

有没有办法用组织特定的徽标替换 OAuth Login Webview for Android 中的 salesforce 徽标？我尝试使用远程访问中的“徽标图像 URL”字段来执行此操作，但它没有替换 salesforce 徽标。还有其他方法吗？

如需截图，请访问以下链接

[http://i.stack.imgur.com/UF0Pp.png](http://i.stack.imgur.com/UF0Pp.png)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T12:52:33.580

由于这是 oAuth 窗口，由于 oAuth 限制，您无法在此处更改徽标。这是因为您的组织没有对用户进行身份验证，而 Salesforce 是，并且他们需要在此处显示其徽标。

希望这是有道理的！

阿努普

# c# - IAsyncResult 未完成并锁定 UI

> ID：11765714
> 
> 赞同：2
> 
> 时间：2012-08-01T18:56:48.373
> 
> 标签：c#, asynchronous, iasyncresult

我正在进行 REST 调用，服务器端响应采用 XML 的形式。我正在异步进行此调用。我已经将它作为控制台应用程序进行了测试，它可以正常工作。但是，当我在**XBOX**上测试它时，**异步请求永远不会完成**。我的 processVideo 方法解析 XML 并将项目放入列表中。我需要从另一个类中引用这个列表，所以我添加了**(result.IsCompleted == false)** 以确保在我引用和使用列表之前完成异步调用。似乎异步请求永远不会完成并锁定 UI，有什么想法吗？

```
 public void initilaizeRest()
    {
        WebRequest request = HttpWebRequest.Create(URI);
        request.Method = GET;
        // RequestState is a custom class to pass info to the callback
        RequestState state = new RequestState(request, URI);
        IAsyncResult result = request.BeginGetResponse(new AsyncCallback(getVideoList), state);

        Logger.Log("Querystate :"+QUERYSTATE+" URI:"+URI);

        /// Wait for aynchronous response to be completed
        while (result.IsCompleted == false)
        {
            Logger.Log("Sleeping");
            Thread.Sleep(100);
        }

    } 
```

* * *

```
 public void getVideoList(IAsyncResult result)
    {
        RequestState state = (RequestState)result.AsyncState;
        WebRequest request = (WebRequest)state.Request;
        HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(result);

        //Process response
        switch (QUERYSTATE)
        {
            case (int)Querystate.SERIESQUERY:
                Logger.Log("Processing series state");
                processSeries(response);
                break;
            case (int)Querystate.VIDEOQUERY:
                Logger.Log("Processing video state");
                processVideo(response);
                break;
        }

    } 
```

* * *

```
public void processVideo(HttpWebResponse response)
{
      //parses XML into an object  and places items in a LIST
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:54:36.177

while 循环是你的问题。您不应该像这样等待异步调用完成。您应该在发送到 Begin 方法的异步回调中做任何您想做的事情。原因是 UI 设置了用于异步回调的同步上下文。其工作方式是将回调编组到 UI 线程上，以便维护 UI 上下文。因为您的 while 循环阻塞了您的 UI 线程，所以不会发生回调，导致异步调用未完成。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:53:56.860

`getVideoList`将在异步操作完成时调用。如果您需要您的 UI 在此操作完成之前不允许某些操作，您必须在调用`BeginGetResponse`. `IsCompleted`删除在主 UI 线程上等待的任何循环（这将*阻塞*UI 并使其看起来“挂起”）。在中，重新启用在调用完成`getVideoList`时应重新启用的 UI 部分。`BeginGetResponse`

# mysql - Wordpress、自定义查询字符串到第二个 mySQL 数据库和漂亮的永久链接

> ID：11765716
> 
> 赞同：1
> 
> 时间：2012-08-01T18:56:52.273
> 
> 标签：mysql, wordpress, rewrite, permalinks

我的问题：是否可以使用 WP_Rewrite 以便如果将带有自定义查询字符串的 URL（例如：mysite.com/?tid=1）放在地址中，它将变成 mysite.com/1

此查询引用第二个数据库，与正常的 Wordpress 结构无关。它抓取信息并填充索引页面的一部分。

目前我已经能够使用 WP_Rewrite 来做相反的事情。如果您访问[http://www.zacharybrady.com/text/wordpress/1/](http://www.zacharybrady.com/text/wordpress/1/)，wordpress 会将其解释为[http://www.zacharybrady.com/text/wordpress/?tid=1](http://www.zacharybrady.com/text/wordpress/?tid=1)

我的完整代码：

```
/*REWRITING*/
function add_rewrite_rules() {

add_rewrite_rule('([0-9]+)','index.php?tid=$matches[1]','top');

}
add_action( 'init', 'add_rewrite_rules' );

/*QUERY TAGS*/
function tid_register_rewrite_tag() {
    add_rewrite_tag( '%tid%', '([0-9]+)');
}
add_action( 'init', 'tid_register_rewrite_tag'); 
```

我需要能够做到我已经取得的成就和这个问题的目标。结果应该是用户永远看不到查询字符串。

我做了很多研究，但这个问题的答案似乎让我无法理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:28:14.007

所以我有一个答案，但它远非优雅。

在提交时，我使用的表单发送到 test.php 的 PHP 脚本，其中包含以下代码：

```
$id = $_GET['tid'];
$url='http://www.zacharybrady.com/text/wordpress/'.$id;
echo "<script>window.location = '$url'</script>"; 
```

最后，这模拟了重写。如果有人有更优雅的方式，请告诉我。

# c++ - 从重定向的标准输入获取输入时使用 seekg()

> ID：11765718
> 
> 赞同：1
> 
> 时间：2012-08-01T18:57:02.820
> 
> 标签：c++, seekg

因此，我尝试使用 cin.get() 两次读取字符串。输入被重定向为“程序<输入”。所以使用 seekg() 是有效的。

正如标题所说，我认为我可以使用 seekg() 来保存字符串的开始位置，这样我就可以再次使用同一个字符串的开始位置。

这是我的尝试：

```
char c;
while (cin.get(c))
{
  //do stuff 
}

cin.seekg(0, ios::beg);

while (cin.get(c))
{
  //do stuff with the string a second time
} 
```

第二个 while 循环没有做任何事情，所以我显然没有正确使用 seekg。有人可以告诉我我做错了什么吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T18:59:58.543

你不能在流/管道上寻找。它们不会继续存在于内存中。想象一下键盘直接连接到您的程序。您可以使用键盘进行的唯一操作是要求更多输入。它没有历史。

如果它只是一个您无法搜索的键盘，但如果它在 shell 中使用 < 重定向，则可以正常工作：

```
#include <iostream>

int main() {
  std::cin.seekg(1, std::ios::beg);
  if (std::cin.fail()) 
    std::cout << "Failed to seek\n";
  std::cin.seekg(0, std::ios::beg);
  if (std::cin.fail()) 
    std::cout << "Failed to seek\n";

  if (!std::cin.fail()) 
    std::cout << "OK\n";
} 
```

给：

> user@host:/tmp > ./a.out寻找失败
> 寻找
> 失败
> user@host:/tmp > ./a.out < test.cc
> OK

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-01T19:04:16.463

你不能那样做。std::cin 通常连接到终端，因此随机访问是不可能的。

如果您使用的流是 std::istringstream 或 std::ifstream，则可以这样做。

我的建议是将 std::cin 中的所有字符读入单个 std::string，然后从该字符串创建一个 std::istringstream，然后在该 std::istringstream 而不是 std::cin 上尝试您的技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:00:07.440

你不能在流上寻找。你必须取消字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-20T12:44:23.927

您不能在流上搜索，但可以使用`std::cin.peek()`或`std::cin.unget()`。

1）通过使用`cin.peek()`

```
char c;
while (c = cin.peek())
{
  //do stuff 
}

while (cin.get(c))
{
  //do stuff with the string a second time
} 
```

2）通过使用`cin.unget()`

```
char c;
while (cin.get(c))
{
  //do stuff 
}

cin.unget();

while (cin.get(c))
{
  //do stuff with the string a second time
} 
```

# javascript - 第 N 个孩子使用 Jquery 而不是 CSS

> ID：11765722
> 
> 赞同：1
> 
> 时间：2012-08-01T18:57:14.213
> 
> 标签：javascript, jquery, html, css

我`nth-child`在我的 css 代码中使用，但它在 IE 8 中不起作用。我知道 IE 8 无法处理`nth-child`，但我需要找到一种方法让它工作。

这是我的代码：

```
.paypalshop .shop-groups li:nth-child(1){
  float:left;
  border: 1px solid #ccc;
  width:200px;

   }

.paypalshop .shop-groups li:nth-child(2){
  float:left;
  border: 1px solid #ccc;
  width:150px;
   }

.paypalshop .shop-groups li:nth-child(3){
  float:left;
  border: 1px solid #ccc;
  width:210px;
   }

.paypalshop .shop-groups li:nth-child(4){
  float:left;
  border: 1px solid #ccc;
  width:200px;
   }

.paypalshop .shop-groups li:nth-child(5){
  float:left;
  border: 1px solid #ccc;
  width:70px;
   }

.paypalshop .shop-groups li:nth-child(6){
  float:left;
  border: 1px solid #ccc;
  width:105px;
   }

.paypalshop .shop-groups li:nth-child(7){
  float:left;
  border: 1px solid #ccc;
  width:154px;
   }

.paypalshop .shop-groups li:nth-child(8){
  float:left;
  border: 1px solid #ccc;
  width:130px;
   }   

.paypalshop .shop-groups li:nth-child(9){
  float:left;
  border: 1px solid #ccc;
  width:220px;
   }
.paypalshop .shop-groups li:nth-child(10){
  float:left;
  border: 1px solid #ccc;
  width:220px;
   } 
```

所以我需要找到一种方法让该`nth-child`函数在 IE 8 上运行。我可以使用任何 jQuery 方法让它在 IE 8 上运行吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T18:59:00.837

是的，使用 :nth-child 选择器

[http://api.jquery.com/nth-child-selector/](http://api.jquery.com/nth-child-selector/)

随着CSS的变化

[http://api.jquery.com/css/](http://api.jquery.com/css/)

例如

```
$("paypalshop .shop-groups li:nth-child(2)").css("width":"150px","float":"left","border":"1px solid #ccc"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T09:24:57.547

与其用 jQuery 改变 CSS（为您的页面加载和 javascript 对网站布局的依赖添加 80kb），为什么不向其中的每一个添加类`li`？

HTML：

```
<ul>
    <li class="normal"><!-- 200px --></li>
    <li class="narrow"><!--- 70px --></li>
    <li class="wide"><!-- 220px --></li>
    ...
</ul> 
```

CSS：

```
li { float: left; border: 1px solid #ccc; }
li.normal { width: 200px; }
li.narrow { width: 70px; }
li.wide { width: 220px; } 
```

Imo，这是一个更清洁、更易读的解决方案，更易于维护，并解决了当今使用的每一个浏览器的问题。

# selenium - 无法使用 Selenium 打开五个以上的 Chrome 浏览器

> ID：11765726
> 
> 赞同：2
> 
> 时间：2012-08-01T18:57:29.037
> 
> 标签：selenium, webdriver, selenium-grid, selenium-chromedriver

我启动集线器和节点：

```
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role hub
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role node 
    -hub http://localhost:4444/grid/register 
    -browser browserName=chrome,maxInstances=6,platform=WINDOWS 
    -timeout 0
    -Dwebdriver.chrome.driver=c:\...\chromedriver.exe 
```

然后，我创建 Chrome 驱动程序实例：

```
 Dim desiredCapabilities As Remote.DesiredCapabilities = Remote.DesiredCapabilities.Chrome()
    Dim size As String = "--window-size={0},{1}"
    size = String.Format(size, browserWidth, browserHeight)
    Dim position As String = "--window-position={0},{1}"
    position = String.Format(position, browserWidth * index, 0)
    desiredCapabilities.SetCapability("chrome.switches", {size, position})
    driver = New Remote.RemoteWebDriver(New System.Uri("http://localhost:4444/wd/hub"), desiredCapabilities) 
```

五个工作正常。第六次等待 Selenium 响应。这是错误：

```
OpenQA.Selenium.WebDriverException: No response from server for url http://localhost:4444/wd/hub/session. Aborting test execution. 
```

节点中没有活动，因此集线器似乎没有将第六个请求分配给节点。`maxInstances=6`除了我需要的设置之外，还有其他设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:55:32.307

我尝试为每五个浏览器在不同的端口上运行单独的节点，它起作用了：

中心：

```
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role hub 
```

前五名：

```
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role node -port 5555
    -hub http://localhost:4444/grid/register 
    -browser browserName=chrome,maxInstances=5,platform=WINDOWS 
    -timeout 0
    -Dwebdriver.chrome.driver=c:\...\chromedriver.exe 
```

下五个：

```
java -jar C:\...\selenium-server-standalone-2.25.0.jar -role node -port 5556
    -hub http://localhost:4444/grid/register 
    -browser browserName=chrome,maxInstances=5,platform=WINDOWS 
    -timeout 0
    -Dwebdriver.chrome.driver=c:\...\chromedriver.exe 
```

# json - 如何从 Redis 的 ServiceStack 实现返回的 Json Datetime 格式转换为 .net Datetime？

> ID：11765730
> 
> 赞同：1
> 
> 时间：2012-08-01T18:57:35.503
> 
> 标签：json, redis, servicestack

我正在尝试从 Redis 中检索值为 Datetime 类型的值。粘贴代码片段如下。我正在使用 ServiceStack.Redis 与 Redis 进行交互。

```
DateTime dt = DateTime.Now; // current value is dt is --> 8/2/2012 12:18:38 AM
redisClient.Set<DateTime>("myKey", DateTime.Now); 
```

我使用以下命令从 Redis 取回值。

```
var dtvalue = redisClient.Get("myKey"); 
```

dtValue 变量保持的值是

```
\/Date(1343846917510+0530)\/ 
```

**如何将其转换为 .net DateTime？我正在使用 C#。**

我尝试了以下但没有得到正确的结果。

```
DateTime d = new DateTime(1343842541241); 
```

我得到的值为 d 为 1/2/0001 1:19:44 PM。

谢谢，

米

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:52:30.643

使用`IRedisClient.Get<T>()`例如：

```
DateTime dt = DateTime.Now;
redisClient.Set<DateTime>("myKey", DateTime.Now);
var dtFromRedis redisClient.Get<DateTime>("myKey"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:50:12.920

取自[Trivia：如何将 JSON2.org DateTime 字符串转换为 C# DateTime](https://stackoverflow.com/questions/4094118/trivia-how-to-convert-a-json2-org-datetime-string-to-c-sharp-datetime)

对于您的确切示例，这是您可以转换它的方式：

```
 var unixEpoch = new DateTime(1970, 1, 1);
    var ticksSinceEpoch = 1343846917510 * 10000;
    var time = new DateTime(unixEpoch.Ticks + ticksSinceEpoch).AddHours(5).AddMinutes(30); 
```

# maven - maven跨项目集成

> ID：11765732
> 
> 赞同：2
> 
> 时间：2012-08-01T18:57:41.103
> 
> 标签：maven, integration-testing

我是 Maven 的新手，我在解决这个问题时遇到了一些麻烦。

我有一堆集成测试捆绑为一个项目。我希望能够随意将这些测试应用于任何其他项目。

如何使用 POM 将集成测试项目代码放入另一个项目并在集成测试阶段执行？

如果我将其作为依赖项，并且集成测试项目的 POM 指定阶段集成测试。原始项目的构建周期是否会持续到集成测试，然后依赖项目在该阶段接管？

对不起，我觉得我在这里打了一匹死马。您的回答非常有助于让我了解正在发生的事情以及我需要做什么。我的问题是，即使我的测试代码编译并作为依赖项添加，测试作为范围由于某种原因它不会执行或检测到测试。该测试名为 appTest 并带有 JUnit 4.x 标记，我无法弄清楚它为什么不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T13:39:40.127

**您可以在配置 maven-jar-plugin 并运行mvn install**的隔离工件中发布您的测试：

```
<plugin>
 <groupId>org.apache.maven.plugins</groupId>
 <artifactId>maven-jar-plugin</artifactId>
 <executions>
  <execution>
   <goals>
    <goal>test-jar</goal>
   </goals>
  </execution>
 </executions>
</plugin> 
```

然后从要执行测试的其他项目中导入依赖项：

```
<dependency>
 <groupId>project.with.tests.groupid</groupId>
 <artifactId>projectwithtestsartifatid</artifactId>
 <version>1.0</version>
 <type>test-jar</type>
 <scope>test</scope>
</dependency> 
```

**无论如何，surefire 或 failsafe 插件只会在target/test-classes**文件夹中寻找测试，而不是在 classpath 的 jar 中。在surefire中存在一个[未](http://jira.codehaus.org/browse/SUREFIRE-569)分配的固定版本（至少目前是这样）。

一种解决方法是使用依赖插件来解压**target/test-classes**中的测试类，但这可能会污染版本：

```
<plugin>
 <groupId>org.apache.maven.plugins</groupId>
 <artifactId>maven-dependency-plugin</artifactId>
 <executions>
  <execution>
   <id>resource-dependencies</id>
   <phase>process-test-classes</phase>
   <goals>
    <goal>unpack-dependencies</goal>
   </goals>
   <configuration>
    <includeTypes>test-jar</includeTypes>
    <outputDirectory>${project.build.directory}/test-classes</outputDirectory>
   </configuration>
  </execution>
 </executions>
</plugin> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:16:20.583

最好的选择是将集成测试的代码提取到单独的模块中，然后您必须运行`mvn install`以将二进制文件发布到本地存储库，以便在构建另一个项目时可见，或者`mvn compile`如果这些测试将在多模块项目中使用，则需要这些测试其中模块与父模块具有相同的版本。要在另一个项目或模块中使用，它应该在依赖部分中声明，测试范围如 junit 库。

如果上述选项不合适，您可以尝试使用测试分类器（文件名后缀）准备附加的 jar：

```
<build>
    <sourceDirectory>src/main/scala</sourceDirectory>
    <testSourceDirectory>src/test/scala</testSourceDirectory>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <executions>
                    <execution>
                        <id>test-jar</id>
                        <goals>
                            <goal>test-jar</goal>
                        </goals>
                        <configuration>
                            <includes>
                                <include>com/thenewmotion/test/**/*.*</include>
                            </includes>
                        </configuration>
                    </execution>
                </executions>
            </plugin> 
```

并且要在测试范围之外使用，应该添加 test-jar 类型或测试分类器：

```
<dependency>
    <groupId>com.thenewmotion</groupId>
    <artifactId>msp-solveconnector</artifactId>
    <version>${project.version}</version>
    <type>test-jar</type>
    <scope>test</scope>
</dependency> 
```

# c# - 在 C# 中添加和更新 DataTable 列

> ID：11765733
> 
> 赞同：1
> 
> 时间：2012-08-01T18:57:47.553
> 
> 标签：c#, .net

我正在尝试将列添加到 DataTable。

我可以很好地添加列。但是，当我遍历这些新列的行设置值时，它不会更新 DataRow.ItemArray。这是我的代码：

```
private void UpdateTabularDataTable(SqlConnection connection)
{
      // when I add these columns, it works fine.
      var rejectedColumn = table.Columns.Add(Constants.RejectedUiColumnName, typeof(bool));
      var rejectedReasonColumn = table.Columns.Add(Constants.RejectedReasonUiColumnName, typeof(string));

      foreach (var row in table.Rows.Cast<DataRow>())
      {
        var contourId = (Guid)row.ItemArray[0];

        // this is a Dictionary of objects which are rejected.  The others are accepted.
        string rejectedReason;
        var isRejected = _rejectedParticleReasonHolder.TryGetValue(contourId.ToString(), out rejectedReason);

        // these assignments don't work.  There's no exception; they 
        // just don't update the relevant values on the object.
        // Also, I verified that the Ordinal values are correct.
        row.ItemArray[rejectedColumn.Ordinal] = isRejected;
        row.ItemArray[rejectedReasonColumn.Ordinal] = rejectedReason;

      }
    }
  }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:32:32.150

你应该改变你的代码看起来像这样

```
private void UpdateTabularDataTable(SqlConnection connection)
{
      table.Columns.Add(Constants.RejectedUiColumnName, typeof(bool));
      table.Columns.Add(Constants.RejectedReasonUiColumnName, typeof(string));

      foreach (var row in table.Rows.Cast<DataRow>())
      {
        var contourId = (Guid)row.ItemArray[0];

        // this is a Dictionary of objects which are rejected.  The others are accepted.
        string rejectedReason;
        var isRejected = _rejectedParticleReasonHolder.TryGetValue(contourId.ToString(), out rejectedReason);

        row[Constants.RejectedUiColumnName] = isRejected;
        row[Constants.RejectedReasonUiColumnName] = rejectedReason;

      }
    }
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T19:28:35.613

我的一位同事发现了这个问题。`row.ItemArray`不应该直接访问。相反，我曾经`row[columnName] = value`修改列值。

# python - 具有多个字典的 Json

> ID：11765734
> 
> 赞同：1
> 
> 时间：2012-08-01T18:57:48.910
> 
> 标签：python, json, dictionary

我有以下数据：

```
d = "{\"key_1": \" val_1\", \"key_2\": \"val_2\"}{\"key_3\": \" val_3\", \"key_4\": \"val_4\"}" 
```

我想将其翻译成字典列表，例如

```
d_list = [{\"key_1": \" val_1\", \"key_2\": \"val_2\"}, {\"key_3\": \" val_3\", \"key_4\": \"val_4\"}] 
```

1.  json.loads(d) 给我类型错误： raise ValueError(errmsg("Extra data", s, end, len(s)))

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T19:06:23.910

您可以使用[`JSONDecoder`](http://docs.python.org/library/json.html#encoders-and-decoders)及其`raw_decode()`方法来完成此操作。 `raw_decode()`将读取一个完整的 JSON 对象，并返回一个元组，其第一个成员是对象，第二个成员是解码器停止读取的字符串的偏移量。

基本上，您需要读取一个对象，然后将其存储在一个数组中，然后从字符串中读取下一个对象，依此类推，直到您位于字符串的末尾。像这样：

```
import json

def read_json_objects(data):
    decoder = json.JSONDecoder()
    offset = 0

    while offset < len(data):
        item = decoder.raw_decode(data[offset:])

        yield item[0]
        offset += item[1]

d = '{"key_1": " val_1", "key_2": "val_2"}{"key_3": " val_3", "key_4": "val_4"}'

print json.dumps(list(read_json_objects(d))) 
```

这将输出：

```
[{"key_1": " val_1", "key_2": "val_2"}, {"key_4": "val_4", "key_3": " val_3"}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:02:50.443

这不是有效的 JSON，您应该尝试在两个对象之间添加逗号。
`d = "{\"key_1": \" val_1\", \"key_2\": \"val_2\"}, {\"key_3\": \" val_3\", \"key_4\": \"val_4\"}"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-13T08:01:28.120

我也遇到了类似的问题`{key1:val1, key2:val2}{key1:val1, key2:val2}`。我可以解决它的唯一方法是：

```
def json_parser(msg):
    msg=msg.split("{")
    for i in msg:
        L=i.split("}")
        msg_new={}
        for j in L:
            if j:
                LL=j.split(",")
                for l in LL:
                    msg_new[string.strip(l.split(":")[0]).replace('"','')]=string.strip(l.split(":")[1]).replace('"','')
        return msg_new 
```

在哪里....

```
try:
                        data_loaded=json.loads(data)
                    except:
                        data_loaded=json_parser(str(data)) 
```

我尝试了很多尝试，但这一次可以处理大量`{..}{..}{..}`示例。

# .net - .Net MVC3 jQgrid 错误“为空或不是对象”

> ID：11765736
> 
> 赞同：0
> 
> 时间：2012-08-01T18:58:02.483
> 
> 标签：.net, asp.net-mvc-3, jqgrid

我正在尝试在我们的 MVC3 项目中实现 jqgrid。但是我遇到了这个错误： -

**Microsoft JScript 运行时错误：“b.jgrid.errors.model”为空或不是对象。**

这些是 _layout.cshtml 中引用的脚本：-

```
 <script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-1.5.2.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/grid.local-en.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"></script> 
```

我的控制器代码如下所示：-

```
public ActionResult getSummaryRow(string sidx, string sord, int page, int rows)
        {
            int pageIndex = Convert.ToInt32(page) - 1;
            int pageSize = rows;
            int totalRecords = _context.Sales_Dashboard_summary.Where(a=>a.DateId==_dateid).Count();

            int totalPages = (int)Math.Ceiling((float)totalRecords / (float)pageSize);

            var summaryRecord = _context.Sales_Dashboard_summary.Skip(pageIndex * pageSize).Take(pageSize);
            var jsonData = new
            {
                total = totalPages,
                page,
                records = totalRecords,
                rows = (
                            from sRec in _context.Sales_Dashboard_summary
                            where sRec.DateId == _dateid
                            select new
                            {
                                i = sRec.DateId,
                                cell = new string[] { sRec.DateId.ToString(),
                                                      sRec.ReportName, 
                                                      sRec.Month, 
                                                      sRec.tot_msr_cnt.ToString(), 
                                                      sRec.Missing_Count.ToString(), 
                                                      sRec.PubInd 
                                                    }
                            }
                        ).ToArray()
            };
            return Json(jsonData, JsonRequestBehavior.AllowGet);
        } 
```

这是我的查看页面：-

```
<script type="text/javascript">
    $(function () {
          $("#list").jqGrid({
              url: '/Home/getSummaryRow/',
              datatype: 'json',
              mtype: 'GET',
              colNames: ['Date Id','Report Name', 'Month', 'Total Measure','Missing Measure','Published'],
              colModel: [
                      { name: 'DateId', index: 'DateId', width: 20, align: 'left' },
                      { name: 'ReportName', index: 'ReportName', width: 40, align: 'left' },
                      { name: 'Month', index: 'Month', width: 40, align: 'left' },
                      { name: 'tot_msr_cnt', index: 'tot_msr_cnt', width: 20, align: 'right' },
                      { name: 'missing_count', index: 'missing_count', width: 20, align: 'right'}],
              pager: jQuery('#pager'),
              rowNum: 10,
              rowList: [5, 10, 20, 50],
              sortname: 'Month',
              sortorder: "desc",
              viewrecords: true,
              imgpath: '/scripts/themes/coffee/images',
              caption: 'Sales Dashboard'
          });
      }); 
     </script>  

<h2>@ViewBag.Message</h2>
<p>

 <table id="list" class="scroll" cellpadding="0" cellspacing="0"></table>
 <div id="pager" class="scroll" style="text-align:center;"></div>

</p> 
```

提前致谢。

# php - 在 MySQL 中的十进制列上查找最接近的匹配项

> ID：11765738
> 
> 赞同：4
> 
> 时间：2012-08-01T18:58:07.993
> 
> 标签：php, mysql, geolocation, match

下午，

我很难解决这个问题。我有一个 MySQL 表，其中列出了英国邮政编码及其经度和纬度值。我希望能够在表格上进行搜索，以找到最接近给定长/纬度对的邮政编码。

我一直在尝试使用的查询是：

```
"SELECT id, outcode AS thecode, @la := MATCH(lat) AGAINST(?) AS score_lat, @ln := MATCH(lng) AGAINST(?) AS score_lng, @la + @ln AS score_total FROM postcodes ORDER BY score_total DESC LIMIT 10 
```

然而，这只会返回看似随机的邮政编码，例如 Lat: 55.775549 和 Long: -4.047556

```
Array
(
[0] => Array
    (
        [id] => 929
        [thecode] => FK14
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[1] => Array
    (
        [id] => 2785
        [thecode] => UB3
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[2] => Array
    (
        [id] => 993
        [thecode] => G70
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[3] => Array
    (
        [id] => 2849
        [thecode] => WC2B
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[4] => Array
    (
        [id] => 1057
        [thecode] => GU29
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[5] => Array
    (
        [id] => 2913
        [thecode] => WS13
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[6] => Array
    (
        [id] => 1121
        [thecode] => HP20
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[7] => Array
    (
        [id] => 1185
        [thecode] => IG6
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[8] => Array
    (
        [id] => 1249
        [thecode] => IV25
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )

[9] => Array
    (
        [id] => 1313
        [thecode] => KA8
        [score_lat] => 0
        [score_lng] => 0
        [score_total] => 0
    )
) 
```

数据库的架构是：

```
CREATE TABLE `postcodes` (
  `id` int(11) NOT NULL auto_increment,
  `outcode` varchar(4) NOT NULL,
  `lat` varchar(20) NOT NULL,
  `lng` varchar(20) NOT NULL,
  PRIMARY KEY  (`id`),
  FULLTEXT KEY `lat` (`lat`),
  FULLTEXT KEY `lng` (`lng`)
) ENGINE=MyISAM AUTO_INCREMENT=2975 DEFAULT CHARSET=latin1 AUTO_INCREMENT=2975 ; 
```

我希望有人能帮帮忙！如果您需要更多信息，请询问...

谢谢，

提示2尾

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T19:23:32.933

MySQL`MATCH()`函数用于全文搜索以“匹配”字符串。（所以它返回零值也就不足为奇了。）

如果“最近”是指您要计算地图上两点之间的距离（以“乌鸦飞”的方式测量），坐标以（十进制度）纬度和经度为单位，您真的需要使用大圆距离（GCD）计算。

[http://en.wikipedia.org/wiki/Great-circle_distance](http://en.wikipedia.org/wiki/Great-circle_distance)

你可以跳过所有这些血淋淋的细节，直接使用我的实现。下面是我的一条 SQL 语句的 SELECT 列表的摘录，这个表达式计算两点之间的距离（以英里为单位）......

```
 , ACOS(
          COS(RADIANS( d2.latitude ))
        * COS(RADIANS( d1.latitude ))
        * COS(RADIANS( d2.longitude ) - RADIANS( d1.longitude ))
        + SIN(RADIANS( d2.latitude ))
        * SIN(RADIANS( d1.latitude ))
           )*3958.82 AS distance_miles 
```

在本例中，`d1`代表起点，`d2`代表终点。和作为 DECIMAL 值提供`latitude`。`longitude`

有了一个“已知”点`d1`，我可以按这个表达式排序，首先获得“最接近”的点`d2`。（对于多个原点，我可以按`d1.id`，然后按此表达式排序，以获得每个最接近的`d2`第一个`d1`。但我的问题已经足够了......

* * *

我从您的问题中复制了查询并对其进行了修改（如下）。基本上，我删除了“分数”列，并将其替换为执行距离计算的表达式：

```
SELECT id
     , outcode AS thecode
     , ACOS(
           COS(RADIANS( d2.latitude ))
         * COS(RADIANS( @d1_latitude ))
         * COS(RADIANS( d2.longitude ) - RADIANS( @d1_longitude ))
         + SIN(RADIANS( d2.latitude ))
         * SIN(RADIANS( @d1_latitude ))
           )*3958.82 AS distance_miles
  FROM postcodes d2
  JOIN (SELECT @d1_latitude := ?, @d1_longitude := ?) v
 ORDER BY distance_miles LIMIT 10 
```

在这种情况下，`@d1_`变量（从绑定变量分配）是“已知”点的纬度和经度。对于`postcodes`表中的每一行（为方便起见，我将其命名为别名`d2`），此表达式计算表中的纬度/经度与“已知”点之间的距离。

注意：内联视图别名 as`v`就在那里，因此您可以只绑定一次纬度，并将值分配给可以引用的用户变量。可以省略该内联视图，您可以看到需要将纬度绑定两次的位置。

注意：这以“英里”为单位计算距离。通过用不同的值代替`3958.82`常数，您可以轻松地获得以公里 (km) 为单位的距离。

注意：不需要返回距离；如果您只想按距离返回最近的 10 个，则可以将该表达式放在 ORDER BY 子句中，例如

```
SELECT id
     , outcode AS thecode
  FROM postcodes d2
  JOIN (SELECT @d1_latitude := ?, @d1_longitude := ?) v
 ORDER
    BY ACOS(
           COS(RADIANS( d2.latitude ))
         * COS(RADIANS( @d1_latitude ))
         * COS(RADIANS( d2.longitude ) - RADIANS( @d1_longitude ))
         + SIN(RADIANS( d2.latitude ))
         * SIN(RADIANS( @d1_latitude ))
           )*3958.82 AS distance_miles
 LIMIT 10 
```

如果您正在寻找两点之间的距离以外的东西，请告诉我，因为在这种情况下，这个答案对您真的没有帮助。

# cakephp - 使用 CakePHP 发送电子邮件

> ID：11765740
> 
> 赞同：0
> 
> 时间：2012-08-01T18:58:17.380
> 
> 标签：cakephp

我在用户注册后设置了电子邮件验证，但是当用户收到电子邮件时，它只是在 GMAIL 的 FROM 列中显示“信息”。有没有办法可以将其更改为“Example.com”或“电子邮件验证”之类的其他内容？我只想让用户在打开电子邮件之前查看电子邮件的发件人。

这是它在 config/constants.php 中的定义方式——使用 CakePHP

```
if(!defined('EMAIL_FROM')) {

define('EMAIL_FROM', 'info@example.com');

} 
```

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:02:45.747

要定义 from 字段，您需要在启动 CakeEmail 对象后设置它，如文档[http://book.cakephp.org/2.0/en/core-utility-libraries/email.html中所示](http://book.cakephp.org/2.0/en/core-utility-libraries/email.html)

```
$email = new CakeEmail();
$email->from(array('me@example.com' => 'My Site'));
$email->to('you@example.com');
$email->subject('About');
$email->send('My message'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T11:21:41.990

我认为这对你有帮助

$this->Email->from = Configure::read('FROM_EMAIL');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:04:24.133

我认为在电子邮件地址前面添加它会起作用：

```
if(!defined('EMAIL_FROM')) {    
  define('EMAIL_FROM', 'Email Verification <info@example.com>');    
} 
```

# javascript - 带有右胡萝卜的 javascript var 给出了奇怪的结果

> ID：11765742
> 
> 赞同：2
> 
> 时间：2012-08-01T18:58:33.957
> 
> 标签：javascript, html, var

当我运行此代码时：

```
var newHtml = "<jsp:include page=m_searchform.jsp> "; 
```

我的页面无法加载，并且出现错误。

当我运行此代码时：

```
var newHtml = "<>jsp:include page=m_searchform.jsp "; 
```

它加载得很好。为什么字符串末尾的正确胡萝卜会给我这样的问题？

我真正想做的是把它放到一些 div 的 innerHTML 中：

```
<div id = "searchWrapper">
<form style="vertical-align:50%;" name = "searchForm" action="m_search.jsp">
<input class="searchBox" type="search" name="w"/>
<input class = "greenBtn" type="submit" value="Search"/></form>
</div> 
```

但这也行不通。我在所有引号之前都加上了反斜杠，但我确信我错过了其他五件事和三个大概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:03:23.153

尝试使用 < 和> 如果你想让字符出现

编辑#2：

根据 epascarello 的回答（和评论），我的编辑 #2 本身还不够。您将需要从该 JSP 包含文件中提取所有换行符，或者您将需要使用搜索和替换功能在打印输出之前替换导入文本上的换行符，所有这些都在 JSP 方面。

我想通了 - 大声笑，您可以像您正在做的那样在 javascript 中使用您的 JSP 标签，但是，您的页面无法加载并且您收到错误的原因是因为您的服务器正在解析该 JSP 标签（当您正确编写时） ，因此正在注入 html。我想这可能可行，但是您必须将 JSP 标记用单引号而不是双引号括起来，因为服务器要注入的 HTML 里面会有一堆双引号！

所以只需这样做：

```
var newHtml = '<jsp:include page=m_searchform.jsp>'; 
```

编辑＃1：

你已经做了这样的事情，因为你不能从 javascript 中插入 JSP 标签。在 JS 执行开始之前，服务器已经完成了对 JSP 的解析。

```
var newhtml = '<div id = "searchWrapper">
<form style="vertical-align:50%;" name = "searchForm" action="m_search.jsp">
<input class="searchBox" type="search" name="w"/>
<input class = "greenBtn" type="submit" value="Search"/></form>
</div>';

someObject.innerHTML = newhtml; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:05:53.330

因此，当您执行此操作时，您希望服务器将 HTML 内容添加到 JavaScript 变量中。

```
var newHtml = "<jsp:include page=m_searchform.jsp> "; 
```

当您查看页面源时，它看起来像这样

```
var newHtml = "<input type="text" name="asdasdas" />
<input type="text" name="sdfsdf" />
<input type="text" name="werwe" />"; 
```

这不是有效的 JavaScript

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:07:16.723

您应该转义 html 字符，例如`<>&()`在将它们放入 HTML 文档之前。

```
string.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split("(").join("&#40;").split(")").join("&#41;") 
```

应该做的伎俩

# c - md5sum 在从套接字接收的文件上失败

> ID：11765748
> 
> 赞同：0
> 
> 时间：2012-08-01T18:58:57.123
> 
> 标签：c, sockets

我编写了简单的客户端-服务器应用程序，使用 TCP 套接字将文件从一台机器复制到另一台机器。

在同一台机器上复制文件在验证文件的 md5sum 时成功，但在复制到远程机器时同样失败:(

## 本地副本

$>my_copy file.tar.gz root@127.0.0.1:/home/viswesn/file.tar.gz

$>md5sum 文件.tar.gz
199b341684f528012e44dbf13512c5fc

$>md5sum /home/viswesn/file.tar.gz

199b341684f528012e44dbf13512c5fc

## 远程复制

$>my_copy file.tar.gz root@blrlapx12:/home/viswesn/file.tar.gz

$>md5sum 文件.tar.gz

199b341684f528012e44dbf13512c5fc

$>md5sim /home/viswesn/file.tar.gz

d4cbf92a9d2ed632e429c69334c6bf7a

## 服务器端的代码

```
int sendFile(int sock, FILE *fp, long int size) {
int rc = -1;
char dir[DIRSIZE + 1] = {'\0'};
long int nsend = 0;
int nread = DIRSIZE;
int wc = -1;
nleft = size;

while (!feof(fp)) {        
    rc = fread(dir, sizeof(char), nread, fp);        
    nsend += rc;        
    if (rc > 0) {
            printf("Sending %ld of %ld bytes\r", nsend, size);
            wc = write(sock, dir, rc);
            if (wc != rc) {
                    printf("failed to write to sock %d %s\n", sock, strerror(errno));
                    goto end;
            }
    }
    bzero(dir, rc + 1);        
}
printf("\n");
rc = 0;
end:
   if (sock) {
      close(sock);
   }
   return (rc);
} 
```

## 客户端代码

```
int getFile(int sock, char *filename, long int startOffSet, long int size) {
   char dir[DIRSIZE + 1] = {'\0'};
   int rc = -1;  
   FILE *fp = NULL;    
   int cnt = 0;
   int nread = DIRSIZE;
   long int nrecv = 0;
   int wc = 0;
   long int nleft = size;

   fp = fopen(filename, "w");
   if (fp == NULL) {
      printf("unable to open file %s %s\n", filename, strerror(errno));
   } else {
      printf("open file %s success\n", filename);
   } 

   while(nleft > 0) {
    if (nleft < nread) {
        nread = nleft;
    }        
    cnt = read(sock, dir, nread);
    if (cnt <= 0) {
       goto end;
    }
    nleft -= cnt;
    nrecv += cnt;
    dir[cnt] = '\0';
    wc = write(fp, dir, cnt);
    if (wc != cnt) {
        printf("\nFailed to write to %d", fileno(fp));
        break;
    }        
    printf("Writing %d - [Recv : %ld] / [ Total : %ld] bytes\r", cnt, nrecv, size);
   }
   if (nrecv != size) {
       printf("\nFailed to get file data %ld/%ld - diff of %ld\n", nrecv, size, size - nrecv);
       goto end;
   }
   printf("\n");
   rc = 0;
  end:
     if (fp != NULL) {
         /* close descriptor for file that was sent */
         printf("Closing file descriptor %d\n", fileno(fp));
         fclose(fp);
    }
    return (rc);
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:30:55.097

对于客户端，您正在以文本模式打开文件。

```
fp = fopen(filename, "w"); 
```

如果客户端和服务器位于使用不同终端的操作系统上，这可能会导致问题。例如 Unix 和 Windows。尝试以二进制模式打开文件。

```
fp = fopen(filename, "wb"); 
```

如果这没有帮助，则使用例如 kdiff3 比较文件并检查差异在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:31:23.850

尝试以二进制模式打开文件，`fopen(filename, "wb");`不要忘记在客户端做同样的事情。

注意：您的代码需要更严格的错误检查（fopen、fread、fwrite 调用可能会失败）和一些对称的（为什么`FILE *`当 getFile 自行打开时 sendFile 用作参数）。

# c# - LINQ“WhereLike”扩展方法

> ID：11765751
> 
> 赞同：0
> 
> 时间：2012-08-01T18:59:10.957
> 
> 标签：c#, asp.net, linq, linq-to-sql

使用 LINQ，我需要使用自己的通配符（WHERE LIKE）查询表，但我不能使用普通`Contains`方法，因为它一直在转义我的通配符（请参阅[我的其他问题](https://stackoverflow.com/questions/11512539/using-wildcards-with-a-linqdatasource/11546691)）。我发现了一种可以完美运行的[扩展方法](http://forums.asp.net/post/3494722.aspx)，但仅适用于字符串列：

```
public static IQueryable<T> WhereLike<T>(this IQueryable<T> source, string propertyName, string pattern)
{
    if (null == source) throw new ArgumentNullException("source");
    if (string.IsNullOrEmpty(propertyName)) throw new ArgumentNullException("propertyName");

    var a = Expression.Parameter(typeof(T), "a");
    var prop = Expression.Property(a, propertyName);
    var body = Expression.Call(typeof(SqlMethods), "Like", null, prop, Expression.Constant(pattern));
    var fn = Expression.Lambda<Func<T, bool>>(body, a);

    return source.Where(fn);
} 
```

这是我如何使用上述方法的示例：

```
db.TABLE_NAME.WhereLike("COLUMN_NAME", "SEARCH%"); 
```

正如我所提到的，这在字符串列上效果很好，但是当我尝试在非字符串列（如 int）上使用此方法时，它会因错误而爆炸：

`No method 'Like' on type 'System.Data.Linq.SqlClient.SqlMethods' is compatible with the supplied arguments.`

这是可以理解的，因为您不能对非字符串列执行 LIKE 操作，您必须先将数据转换或转换为字符串。我对 LINQ 表达式不是很熟悉，所以我不确定如何修改`WhereLike`上面的方法来进行强制转换或`ToString()`先进行转换。有谁知道我会做到这一点，所以我可以在非字符串列上执行通配符搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T20:01:53.963

您必须将类型更改为字符串，并且[L2S 支持 Object.ToString](http://msdn.microsoft.com/en-us/library/bb882658)。

为了使用它，您将在另一个方法调用表达式中包装属性访问表达式：

```
public static IQueryable<T> WhereLike<T>(
    this IQueryable<T> source,
    string propertyName,
    string pattern)
{
    if (null == source)
        throw new ArgumentNullException("source");
    if (string.IsNullOrEmpty(propertyName))
        throw new ArgumentNullException("propertyName");

    var a = Expression.Parameter(typeof(T), "a");

    // Wrap the property access in a call to property.ToString()
    var prop = Expression.Property(a, propertyName);
    var conv = Expression.Call(prop, "ToString", null);

    // Basically: SqlMethods.Like(Convert.ToString([prop]), pattern)
    var body = Expression.Call(
        typeof(SqlMethods), "Like", null,
        conv,
        Expression.Constant(pattern));

    var fn = Expression.Lambda<Func<T, bool>>(body, a);

    return source.Where(fn);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:03:04.143

也许您可以将最后一行更改为：

```
return source.Select(t => t.ToString()).Where(fn); 
```

**编辑：**

这是您在我发表评论后尝试的吗？

```
public static IQueryable<T> WhereLike<T>(this IQueryable<T> source, string propertyName, string pattern)
{
  if (null == source) throw new ArgumentNullException("source");
  if (string.IsNullOrEmpty(propertyName)) throw new ArgumentNullException("propertyName");

  var a = Expression.Parameter(typeof(string), "a");
  var prop = Expression.Property(a, propertyName);
  var body = Expression.Call(typeof(SqlMethods), "Like", null, prop, Expression.Constant(pattern));
  var fn = Expression.Lambda<Func<string, bool>>(body, a);

  return source.Select(t => t.ToString()).Where(fn);
} 
```

# backbone.js - Backbone Model.set 不粘连？

> ID：11765752
> 
> 赞同：0
> 
> 时间：2012-08-01T18:59:13.550
> 
> 标签：backbone.js, backbone-events, backbone-views

在我的主干应用程序中，我有一个由模型支持的视图，并且我将模型存储在一个集合中。页面上有几个这样的视图，一次只能选择一个。因此，我有另一个视图，其中包含这些视图的集合。当用户单击未聚焦的视图时，视图将模型的“聚焦”属性设置为 true。模型上的集合触发了一个更改事件，该事件由视图本身（将焦点类添加到其 $el）*和*ViewCollection 视图处理，该视图循环遍历集合中的所有视图并取消焦点中的任何焦点（除了刚刚点击的那个）。

当我以中等速度点击时，这一切都很好。但是，当我快速单击时，我发现模型的设置行为不一致。即，当我将模型的“focused”属性设置为true时，下一次点击事件显示该模型的“focused”属性仍然为false。

代码：

```
 var M = Backbone.Model.extend({
            defaults : {
                            "name" : "",
                "focused" : true
            }
    }),

    L = Backbone.Collection.extend({
            model : M
    }),

    V = Backbone.View.extend({
    events : {
        "click .button" : "focus"
    }
    initialize: function() {
      this.model.bind("change:focused", this.handleFocusChange, this)
    },
    focus: function() {
                console.log("Focus: " + this.model.get("name") + ".focused = " + this.model.get("focused"));

                if (this.model.get("focused")) {
                    return;
                }

                this.model.set({focused: true});  // triggers change event
                this.model.save(this.model);
                console.log("Focus: " + this.model.get("name") + ".focused = " + this.model.get("focused"));
            },
            unfocus: function() {
                console.log("Unfocus: " + this.model.get("name") + ".focused = " + this.model.get("focused"));
                if (!this.model.get("focused")) {
                    return;
                }

                this.model.set({focused: false});  // triggers change event
                this.model.save(this.model);
                console.log("Unfocus: " + this.model.get("name") + ".focused = " + this.model.get("focused"));
            },
            handleFocusChange: function(model, focused) {
                if (focused) {
                    console.log("Handling focus change on " + this.model.get("name") + ", " + this.model.cid);
                    this.$('.button').addClass("focused");
                } else {        
                    console.log("Handling unfocus change on " + this.model.get("nickname") + ", " + this.model.cid);
                    this.$('.button').removeClass("focused");
                }
            }
    }),

    ViewCollection = Backbone.View.extend({
    initialize : function(options) {
                _.bindAll(this, 'initViews');

                this._views = [];

                this.collection.each(this.initViews);
            },
            initViews : function(model) {
                var view = new V({
                    model : model
                });

                this._views.push(view);

                view.model.bind("change:focused", this.focusChanged, this);
            },
            focusChanged: function(changed, focused) {
                if (!focused) {
                    return;
                }

                _.each(this._views, function(view) {
                    if (view.model.id !== changed.id) {
                        view.unfocus();
                    }
                });
            }
    }) 
```

以下是上述日志语句的输出：

```
Click
Focus: A.focused = false
Handling focus change on A, c10
Unfocus: B.focused = false
Unfocus: C.focused = false
Unfocus: D.focused = true
Handling ufocus change on D, c7
Unfocus: D.focused = false
Focus: A.focused = true  <-- good!
Click
Focus: C.focused = false
Handling focus change on C, c9
Unfocus: B.focused = false
Unfocus: A.focused = false  <-- bad!
Unfocus: D.focused = false
Focus: C.focused = true 
```

正如你所看到的，我先点击了 A，然后点击了 C。changed 事件被触发，View 和 Collection 的行为都正常。然而，在第二次点击时，A 的“focused”属性在它应该为真时却是假的。同样，这只发生在我非常快速地单击视图时。当我以正常速度单击时，我无法重现此问题。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T20:59:50.773

这需要处理很多，但如果我正确理解了您的设置......看起来来自 ajax 的调用`model.save()`失败了。

`model.save()`是异步的——它在保存调用返回之前触发一个更改事件。如果保存失败，则撤消更改。尝试以下一项/一些：

*   看看在 Firebug、Fiddler 或其他什么中发生了什么......
*   尝试将您的日志记录功能作为`success`或`error`回调，看看哪个触发。
*   添加等待参数 ( `this.model.save(this.model, {wait:true});`) 并查看您的日志记录如何更改。

# c# - asp.net 验证器的客户端事件

> ID：11765766
> 
> 赞同：1
> 
> 时间：2012-08-01T19:00:18.570
> 
> 标签：c#, jquery, asp.net

我想为我的 asp.net 表单进行 ajax 样式的表单验证（在输入有效时显示绿色复选标记）。

对于两个字段，我使用自定义验证器并使用 jquery ajax 来验证值。对于这些验证器，我搭载客户端验证，以便在 ajax 调用等待响应时显示进度条，如果结果正常，则显示绿色复选标记。

对于其他输入，我需要归档和正则表达式验证器，我不想将它们全部转入自定义验证器。是否存在调用非自定义验证器验证的客户端事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:10:29.587

您需要更改`evaluationfunction`验证器上的客户端属性

文档： http: [//msdn.microsoft.com/en-us/library/aa719700 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa719700(VS.71).aspx)

教程：[http ://blogbaris.blogspot.co.uk/2011/03/creating-custom-validator-control-in.html](http://blogbaris.blogspot.co.uk/2011/03/creating-custom-validator-control-in.html)

# php - 加密/解密错误

> ID：11765769
> 
> 赞同：1
> 
> 时间：2012-08-01T19:00:21.433
> 
> 标签：php, encryption

[我已经从这个问题](https://stackoverflow.com/questions/1289061/best-way-to-use-php-to-encrypt-and-decrypt)的答案中复制了来源

并创建了这两个功能

```
function my_encrypt($string) {
    $key="1234";
    return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($key), 
        $string, MCRYPT_MODE_CBC, md5(md5($key))));
}

function my_decrypt($string) {
    $key="1234";
    return rtrim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5($key), 
         base64_decode($string), MCRYPT_MODE_CBC, md5(md5($key))), "\0");
} 
```

当我尝试使用下面显示的代码进行加密和解密时

```
 $string="445676467";
    echo $ecr=my_encrypt($string)."<br/>";
    echo my_decrypt($ecr); 
```

产生以下输出

> 01pEoOCsp7oloZTDMAKF/cxgB0YQFScje6Z8GBXu8Tw=
> 
> 445676467›HŽÇeVJMç>ÑÑBHc.–ãyeÇN–=“VSã

错误在于解密没有给出正确的输出，即`445676467`

但是当我直接尝试这个时

```
$key="1234";
    $string="2011";
    $encrypted= base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, 
        md5($key), $string, MCRYPT_MODE_CBC, md5(md5($key))));

    $decypted= rtrim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5($key), 
        base64_decode($encrypted), MCRYPT_MODE_CBC, md5(md5($key))), "\0");
    echo $encrypted."<br/>";
    echo $decypted; 
```

这给出了正确的答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T10:08:51.027

这很有趣，但原因是你的语法。

我用了你的代码：

```
 $string="445676467";
//You echo & put value in the var at the same time?? smells like troubles.
        echo $ecr=my_encrypt($string)."<br/>"; 
        echo my_decrypt($ecr); 
```

结果：

```
01pEoOCsp7oloZTDMAKF/cxgB0YQFScje6Z8GBXu8Tw=
445676467�H���eVJM�&gt;��BHc.��ye�N�=�VS� 
```

并尝试：

```
 $string="445676467";
    $ecr=my_encrypt($string);
    echo $ecr;
    echo my_decrypt($ecr); 
```

结果：

```
01pEoOCsp7oloZTDMAKF/cxgB0YQFScje6Z8GBXu8Tw=
445676467 
```

因此，您的功能没有问题，只是用法。首先将值放入变量中，然后才打印它。

# django - Django 模型和管理内联

> ID：11765770
> 
> 赞同：0
> 
> 时间：2012-08-01T19:00:21.570
> 
> 标签：django, django-models, django-forms, django-admin

我试图有一组带有个人答案的问题，每个用户都可以回答。为了实现这种功能，我构建了以下模型：

模型.py：

```
class Question(models.Model):
  question = models.TextField(null=False)

class PossibleAnswer(models.Model):
  question=models.ForeignKey(Question, related_name="possible_answer")
  answer = models.CharField(max_length=200)

class Answer(models.Model):
  question = models.ForeignKey(Question)
  user = models.ForeignKey(User)
  real_answer = models.ForeignKey(PossibleAnswer, related_name="real_answer") 
```

最初，管理界面就足够了，可以解决这些问题。它应该在“每个问题”的基础上可见，因此“问题”应该显示它允许的答案以及用户可以给出的答案：

管理员.py：

```
class AnswerInline(admin.TabularInline): 
  model = Answer

class PossibleAnswerInline(admin.TabularInline):
  model = PossibleAnswer   

class QuestionAdmin(admin.ModelAdmin):
  inlines = [PossibleAnswerInline, AnswerInline]

admin.site.register(Question, QuestionAdmin) 
```

一切都很好，直到我保存答案，这会产生一个 IntegrityError。我相信这与对象之间的依赖关系有关？

我无法解决的第二项：为了将 real_answer 的选择限制为实际选项（与问题相关），我在 forms.py 中定义了以下内容：

```
class AnswerForm(ModelForm):
  class Meta:
    model = Answer

  def __init__(self, *args, **kwargs):  
    super(AnswerForm, self).__init__(*args, **kwargs)  
    choices = self.instance.question.possible_answer.all()
    self.fields["real_answer"].choices = choices 
```

并在 admin.py 中使用它，如下所示：

```
class AnswerInline(admin.TabularInline): 
  model = Answer
  form = AnswerForm 
```

当我运行它时， self.instance.question.possible_answer.all()*总是*引发 DoesNotExist

任何指针都非常感谢。

最好的，

安德烈亚斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:54:32.217

我主要以@GonzaloDelgado 的回答为基础，但我觉得他的代码不是最佳的。最好使用`try...except`块。

```
from django.core.exceptions import ObjectDoesNotExist
...
def __init__(self, *args, **kwargs):
    super(AnswerForm, self).__init__(*args, **kwargs)

    if self.instance.pk:
        try:
            self.fields['real_answer'].queryset = self.question.possibleanswer_set.all()
        except ObjectDoesNotExist:
            pass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:26:49.613

当 an`AnswerForm`被初始化时，它的 instance 属性并不总是有与之相关的 question 对象，因此无论何时`self.instance.question`从表单中引用，`DoesNotExist`如果还没有附加到表单的 answer 对象的 question 实例，就会抛出异常。

**在您的表单init**方法中尝试此代码：

```
choices = []
if self.instance.pk
    questions = Question.objects.filter(answer=self.instance)
    if questions.exist():
        choices = questions.get().possibleanswer_set.all() 
```

# r - 从 R 脚本调用 plot() 并在输出文件中获取图形？

> ID：11765771
> 
> 赞同：7
> 
> 时间：2012-08-01T19:00:25.913
> 
> 标签：r, graph, plot

我创建了一个 R 脚本，它从文件中读取某些数据，调用`summary()`方法，然后调用`plot()`方法。

但是当我尝试运行编写以下命令的 R 脚本时，在输出文件中我得到了摘要，但没有图表。

当我在 R 中手动运行以下指令时，一切正常，我得到了摘要和图表。

有没有办法在输出文件中获取图形？

```
m0<-read.csv(file="Myfile", head=FALSE, sep",")
var_m0<-c(m0$ V3)
summary(var_m0)
plot(var_m0) 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-01T19:07:05.800

你需要告诉 R 你想要什么样的输出以及你想要它去哪里。查看`?png`一个相当全面的列表。`dev.off()`打电话后不要忘记`plot()`！

```
m0 <- read.csv(file="Myfile", head=FALSE, sep",")
var_m0 <- c(m0$ V3)
summary(var_m0)

png('plot.png')
plot(var_m0)
dev.off() 
```

如果您特别希望图形与其余代码位于相同的输出文件中，您可以查看`knitr`and `sweave`。

# javascript - 动态添加的链接上的 trigger('click') 不会传播到 JQM 中的外部链接

> ID：11765778
> 
> 赞同：0
> 
> 时间：2012-08-01T19:01:09.397
> 
> 标签：javascript, jquery, jquery-mobile, jquery-events

我正在尝试在导航栏中使用 jQuery Mobile 的选择菜单作为导航工具。它将需要处理内部和外部链接。绑定到`change`允许使用`$.mobile.selectmenu()`小部件来获取已使用 URL 和位置状态的自定义数据位构建的选定链接。然后链接被动态附加到文档并被`.trigger('click')`调用。

[http://jsfiddle.net/wZNMz/](http://jsfiddle.net/wZNMz/)

无论绑定事件、返回值、事件传播争论和属性如何排列，外部链接都将不起作用。内部链接工作得很好。

假设匹配启用默认 URL 处理，引用[jquery.mobile.navigation.js 源](https://github.com/jquery/jquery-mobile/blob/master/js/jquery.mobile.navigation.js#L1287)触发**点击**应该按预期工作。`[rel='external']`请注意，该插件会`<option>`在初始化时从标签中删除链接，这需要添加链接和触发点击`<select>`更改的所有技巧。

肮脏而明显的技巧是`window.location`在外部设置并完成。这确实有效，但我不明白为什么有必要诉诸于此。任何想法或见解表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T21:46:38.500

创建一个链接并触发点击它似乎比使用 hacky 多了`window.location`，因为这个特定的原因，将用户转发到一个新页面。对于内部链接，您可以通过`$.mobile.changePage()`. 这是一个例子：

```
$('#mobile-nav').bind('change', function(e) {
    var nav_to = $(this).selectmenu('selected');

    if (nav_to.data('locality') === false) {
        //this is external, so use window.location
        window.location = nav_to.data('item-url');
    } else {
        //this is internal, so use $.mobile.changePage()
        $.mobile.changePage(nav_to.data('item-url'), {
            //here you can set options such as transition type and direction
        });
    }
}); 
```

这是文档：http `$.mobile.changePage()`: [//jquerymobile.com/demos/1.1.1/docs/api/methods.html](http://jquerymobile.com/demos/1.1.1/docs/api/methods.html)

# html - span 不会在 Mozilla 中的按钮内保持垂直居中

> ID：11765780
> 
> 赞同：2
> 
> 时间：2012-08-01T19:01:16.967
> 
> 标签：html, css, firefox

我正在尝试将其中的`span`a`display:block;`居中`button`

**它适用于 Chrome 和 IE9，但不适用于 Firefox**

这是它的链接：http: [//jsbin.com/adefom/5/edit](http://jsbin.com/adefom/5/edit)

有人知道如何使这个跨度在 Firefox 中居中（垂直）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:14:54.407

只需删除硬编码的高度和宽度`.btn`并给它一些`padding`.

```
<button class='btn'>
  <div class='icon'></div>
</button> 
```

```
按钮
{
  边距：0px；
  填充：0px；
}

/* Firefox 按钮填充修复 */
按钮::-moz-focus-inner
{
  边框：0；
  填充：0；
}

。图标
{
  背景颜色：黑色；
  宽度：17px；
  高度：17px；
}

.btn
{
  填充：4px；
}
```

Firefox 按钮填充修复来自[此处](http://www.aheadcreative.com/removing-unwanted-button-padding-in-firefox/ "前进创意")。感谢@Rajesh 找到那个。

[演示](http://jsbin.com/adefom/25/edit "JSBin")<-- 点击！

# xcode - 自动显示修复错误

> ID：11765791
> 
> 赞同：1
> 
> 时间：2012-08-01T19:02:20.977
> 
> 标签：xcode

Xcode 4 会在您键入代码时检测到错误。不幸的是，它所做的只是在侧面显示一个小红圈。要真正看到消息，您必须瞄准这个圈子并单击每个该死的时间（这在笔记本电脑上非常烦人。）我是 Cocoa 和 Objective-C 的新手，这真的让我慢了下来。

有没有办法在检测到错误时自动显示错误*消息？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:17:29.743

据我所知，除了编译之外，没有办法自动扩展 XCode 4 生成的在线实时问题。但是，您可以让左侧的导航器窗格显示您的问题列表，这几乎一样好。键盘快捷键是`cmd + 4`,`cmd + 1`并将导航器返回到文件树。那些捷径就成了我最好的新朋友！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-03T00:12:58.627

尝试`Editor > Show Issues`或`Editor > Issues > Show All Issues`。后者的键盘快捷键是`ctrl-commmand-M`（或`⌃⌘ M`）。

# spring - Spring MVC 用户验证

> ID：11765795
> 
> 赞同：0
> 
> 时间：2012-08-01T19:02:45.997
> 
> 标签：spring, spring-mvc, spring-security

我正在使用 Spring MVC 开发一个小型应用程序。这是一种广告牌，用户可以在其中放置多种类型的内容。我已经使用 security-config.xml 成功地为我的应用程序（用户、管理员、匿名）中的不同角色配置了安全性。现在您必须登录才能发帖，只有管理员用户才能看到管理面板等。

现在我的问题是我必须为每个用户设置安全性，即修改内容的用户是制作内容的用户。如果登录的用户和内容的创建者都相同，最直接的方法当然是在我调用我的函数之前检查 Java。像这样的东西：

```
@RequestMapping("/listing/deletecontent.html")
public String deleteUserContent(@RequestParam String contentId) {
    //Get the logged user
    UserDetails userDetails = (UserDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();
    User user = userService.loadUserByUsername(userDetails.getUsername());

    //Check if the user logged and the content owner are the same
    if (user == the_user_that_created_the_content)
          listingService.deleteContent(Integer.valueOf(contentId));

    return "redirect:/listing/usercontent.html";
} 
```

我不知道为什么，但我不喜欢这种方法。它只是在我需要的地方一遍又一遍地“复制粘贴”相同的验证，而且感觉不对。我在想也许 Spring 具有某种类型的功能，允许我在 security-config.xml 中进行设置，也许调用一个类来使用*contentId*参数对每个 URL 进行此验证，然后将其重定向到“真实”URL，如果它通过了测试。我不知道，这就是我想问你的。¿ 您如何看待这种方法？¿ 可能是我太挑剔了，没那么糟糕？¿您知道“更好”的方法吗？

提前非常感谢，詹姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:26:29.300

我建议仔细查看Spring Security 参考中[基于表达式的访问控制章节](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/el-access.html#d0e5622)。所以，据我所知，你不应该自己检查权限——只需使用`@PreAuthorize`注释。尝试 ACL 模块，或者如果它不符合您的要求，可能更好地实现 custom `PermissionEvaluator`。

PS还有这样的事情： `@PreAuthorize("principal.id == #content.createdBy.id")`

# android - Android & 从位图中剪切（删除）形状

> ID：11765802
> 
> 赞同：6
> 
> 时间：2012-08-01T19:03:12.347
> 
> 标签：android, graphics, bitmap

你如何从位图中剪切（删除）一个部分？？？我希望删除那个部分/形状.. 用透明代替部分.. 说形状是圆形或方形..

![在此处输入图像描述](../Images/da8a6498d718d687b105b1598aa8ec52.png)

![在此处输入图像描述](../Images/817423c1fb20d16fe75a43ae0833f43b.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-01T21:00:15.047

~~您应该可以使用 Porter-Duff 滤色器和`Canvas`：~~

 ~~```
public void punchHole(Bitmap bitmap, float cx, float cy, float radius) {
    Canvas c = new Canvas(bitmap);
    Paint paint = new Paint();
    paint.setColorFilter(new PorderDuffColorFilter(0, PorderDuff.Mode.CLEAR));
    c.drawCircle(cx, cy, radius, paint);
} 
```~~  ~~嗯，那是错误的。但是，使用 Porter-Duff 传输模式确实有效：

```
public void punchHole(Bitmap bitmap, float cx, float cy, float radius) {
    Canvas canvas = new Canvas(bitmap);
    Paint paint = new Paint();
    paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
    canvas.drawCircle(cx, cy, radius, paint);
} 
```

（当然，作为 arg 传递的位图需要是可修改的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:37:19.677

使用 Bitmap.setPixel(x,y,Color) 函数将所需像素设置为透明

例如：

```
Bitmap bmp = ...;
bmp.setPixel (100,100,Color.TRANSPARENT); 
```

对于 x/y 偏移 100,100 处的像素。尽管您会发现在许多像素上执行此操作可能会很慢...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T21:34:06.380

您是否尝试使用透明颜色 ARGB = 0,0,0,0 绘制一个圆圈？~~

# javascript - getJSON() - 如何删除数据参数前面的 AND 符号？

> ID：11765804
> 
> 赞同：0
> 
> 时间：2012-08-01T19:03:12.687
> 
> 标签：javascript, jquery, getjson

我正在执行以下 jQuery 调用：

```
$.getJSON(
"http://localhost:9000/user?name=",
"test",
function(data) {
alert(data.aaData[0]);}
); 
```

但它不起作用，因为数据参数“test”在实际调用中将是“&test”（至少这是萤火虫告诉我的）。

我是 JavaScript 和 jQuery 的初学者，谁能告诉我如何删除数据参数前面的 & 符号？这样实际的调用是`http://localhost:9000/user?name=data`而不是`http://localhost:9000/user?name=&data`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:07:50.997

您可以将数据作为对象传递，如下所示：

```
$.getJSON(
    "http://localhost:9000/user",
    { name: "test" },
    function(data) {
        alert(data.aaData[0]);
    }
); 
```

然后，数据对象将在添加到 URL 之前转换为字符串并进行 URL 编码。来自[jQuery 文档`.getJSON()`](http://api.jquery.com/jQuery.getJSON/)：

> 如果 data 参数的值是一个对象（地图），它会在附加到 URL 之前转换为字符串并进行 url 编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T19:08:00.007

您必须设置要以正确方式发送的 get 变量：

```
$.getJSON("http://localhost:9000/user", "name=test", function(data) {
    alert(data.aaData[0]);
}); 
```

# mysql - 如何避免在此代码中将重复项存储在数据库中？

> ID：11765808
> 
> 赞同：0
> 
> 时间：2012-08-01T19:03:29.697
> 
> 标签：mysql, delphi

我有一个用户注册过程，它使用 MYDAC 组件将用户信息存储到我的数据库中。目前它允许重复用户，这不是我的意图。我的代码在下面，但我不知道问题出在哪里。

```
procedure TForm1.Button1Click(Sender: TObject);
begin    
  if (edit1.Text <> '') and (edit2.Text <> '') and (edit3.Text <> '') and 
    (edit4.Text <> '') then
  begin
    MyQuery1.Close;
    MyQuery1.SQL.Text := 'select * from uyeler '+
                         'where nick=:0 and mail=:0 and site=:0';

    MyQuery1.Params[0].AsString:=edit1.text;
    MyQuery1.Params[0].AsString:=edit2.text;
    MyQuery1.Params[0].AsString:=edit3.text;

    MyQuery1.open;

    if MyQuery1.RecordCount = 0 then
      MessageDlg('The same information! Try again.', mtError, [mbOK], 0)
    else
      MyQuery1.Close;

    MyQuery1.SQL.Text := 'INSERT INTO uyeler (nick, mail, site, sifre) VALUES '+
                                            '(:nick, :mail, :site, :sifre)';

    MyQuery1.ParamByName('nick').AsString := Edit1.text;
    MyQuery1.ParamByName('mail').AsString := Edit2.text;
    MyQuery1.ParamByName('site').AsString := Edit3.text;
    MyQuery1.ParamByName('sifre').AsString := Edit4.text;
    MyQuery1.Execute;

    Button1.Enabled := False;
    MessageDlg('Mission complate!', mtInformation, [mbOK], 0);

    Edit1.Clear;
    Edit2.Clear;
    Edit3.clear;
    Edit4.Clear;

    PageControl2.Visible := False;
    PageControl1.Visible := True;
  end
  else
  begin
    MessageDlg('Information is missing! Try again.', mtWarning,[mbOK],0);    
  end;
end; 
```

我怎样才能防止注册相同？在这种情况下我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:07:25.483

我通常会在底层 MySQL 表上使用唯一索引来强制执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:06:27.463

您正在检查错误的结果。您需要将测试更改为

```
if MyQuery1.RecordCount > 0 then // At least one match found already 
```

更好的是，如果`MyDac`支持它，就是使用

```
if not MyQuery1.IsEmpty then  // row already exists. 
```

其实，你有更多的问题，虽然。你有一个不匹配`begin`和`end`阻塞，因为现在你总是在运行方法的插入部分。正如@TLama 所说，您还多次使用相同的参数，分配`nick`,`mail`和`site`所有相同的值。改用命名参数（在 SQL 和参数分配中都显示如下）。

```
procedure TForm1.Button1Click(Sender: TObject);
var
  UserExists: Boolean;
begin
  Button1.Enabled:=false;

  if (edit1.Text <> '') and (edit2.Text <> '') and 
     (edit3.Text <> '') and (edit4.Text <> '') then
  begin
    MyQuery1.Close;
    MyQuery1.SQL.Text :=' select* from uyeler '+
                        'where nick=:nick and mail=:mail and site=:site';

    MyQuery1.ParamByName('nick').AsString:=edit1.text;
    MyQuery1.ParamByName('mail').AsString:=edit2.text;
    MyQuery1.ParamByName('site').AsString:=edit3.text;
    MyQuery1.open;
    try
      UserExists := not MyQuery1.IsEmpty;
    finally
      MyQuery1.Close;
    end;

    if UserExists then
      MessageDlg('The same information! Try again.', mtError,[mbOK],0)
    else
    begin            // <<--- Added begin
      MyQuery1.SQL.Text :=' INSERT INTO uyeler (nick, mail, site, sifre) VALUES '+
                                              '(:nick, :mail, :site, :sifre)';

      MyQuery1.ParamByName('nick').AsString        := Edit1.text;
      MyQuery1.ParamByName('mail').AsString        := Edit2.text;
      MyQuery1.ParamByName('site').AsString        := Edit3.text;
      MyQuery1.ParamByName('sifre').AsString        := Edit4.text;
      try
        MyQuery1.Execute;
      finally
        MyQuery1.Close;
      end;
    end;                      // <------------ Moved end from below where marked

    MessageDlg('Mission complate!', mtInformation,[mbOK],0);

    Edit1.Clear;
    Edit2.Clear;
    Edit3.clear;
    Edit4.Clear;

    PageControl2.Visible:=false;
    PageControl1.Visible:=true;
  end            // <------------- removed extra end caused by addition above
  else
   MessageDlg('Information is missing! Try again.', mtWarning,[mbOK],0);
end; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-03T06:09:35.153

[IMO @Ken White](https://stackoverflow.com/questions/11765808/how-can-i-avoid-storing-duplicates-in-the-database-in-this-code/11765849#11765849)发布的答案应该可以正常工作，但是因为您遇到了麻烦。我建议您尝试使用此代码。它只是执行查询的区别。

*我正在考虑将字段数据类型为 Char 或 VarChar，因此在输入数据值时为“”*

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  Button1.Enabled:=false;

  if (edit1.Text <> '') and (edit2.Text <> '') and 
     (edit3.Text <> '') and (edit4.Text <> '') then
  begin
    MyQuery1.SQL.Clear;
    MyQuery1.SQL.Add(' select* from uyeler where nick="'+edit1.text+'"' +
                      'and mail="'+edit2.text+'" and site="'+edit3.text+'"');
    MyQuery1.Execute;

    if not MyQuery1.IsEmpty then   //--- can also use MyQuery1.RecordCount >0 
      MessageDlg('The same information! Try again.', mtError,[mbOK],0)
    else
    begin            //--- no duplicates present 
      MyQuery1.SQL.Clear;
      MyQuery1.SQL.Add(' INSERT INTO uyeler (nick, mail, site, sifre) VALUES '+
                            '("'+edit1.text+'", "'+edit2.text+'","'+edit3.text+'", "'+edit4.text+'")');

     try
        MyQuery1.Execute;
      finally
        MyQuery1.SQL.Clear;
      end;

     MessageDlg('Mission complate!', mtInformation,[mbOK],0);

     Edit1.Clear;
     Edit2.Clear;
     Edit3.clear;
     Edit4.Clear;

     PageControl2.Visible:=false;
     PageControl1.Visible:=true;
    end;                        
  end;                 
  else
   MessageDlg('Information is missing! Try again.', mtWarning,[mbOK],0);
end; 
```

# javascript - jquery在使用回车键输入文本输入时动态添加具有值的表行

> ID：11765815
> 
> 赞同：0
> 
> 时间：2012-08-01T19:04:06.007
> 
> 标签：javascript, jquery

好的..这是我的第一个问题。javascript 非常新，所以希望我会受到很好的对待（交叉手指）......我在这里有一个 html 代码：

```
<table width="500" border="1">
  <tr>
    <td>No.</td>
    <td>Name</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<br />
Enter Name: 
<input type="text" name="name" id="name" /> 
```

我试图让我在输入“名称”中输入的任何值直接作为 html 表中的新行，并在“编号”中附加一个运行编号（1、2、3 等）。列使用“Enter”键而不是单击按钮。同时“name”中的值会被清空并聚焦，为下一个值入口做准备。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T19:14:26.967

我会在这里向你扔骨头，因为这是非常简单的代码（而且你是新手）。试试这个**[jsFiddle 示例](http://jsfiddle.net/j08691/gfNXu/)**。

**HTML**

```
<table width="500" border="1">
  <tr>
    <td>No.</td>
    <td>Name</td>
  </tr>
</table>
<br />
Enter Name: 
<input type="text" name="name" id="name" />​ 
```

**jQuery**

```
var index = 1;
$('input[name=name]').on('keyup', function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) {
        $('table').append('<tr><td></td><td></td></tr>');
        $('table tr:last td:first').html(index);
        $('table tr:last td:last').html($(this).val());
        $(this).focus().select();
        index++;
    }
});​ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-01T19:45:20.123

吉比森，

作为 javascript 的新手，我将把它作为一个教程而不是确切的答案来表述。

首先要做的事情是要实现这一目标需要采取哪些步骤？

1.  获取输入的值
2.  检测“输入”键按下
3.  插入新行
4.  将行设置为输入的值

好的，现在我们已经将每个问题分解为许多小任务。这使得在问题的每个小节上寻找答案变得更加容易？

Next- 你知道 javascript 框架吗？

在编写 javascript 时，许多浏览器以不同方式处理标准的某些部分，或者根本不支持某些部分。因此，完全手工编写 javascript 不仅麻烦，而且很难跨浏览器编写。框架使开发变得更容易和更简洁，因为它们被构建为在所有浏览器中处理相同的功能。

[http://jquery.com](http://jquery.com) - 是我最喜欢的并且非常易于使用，所以我将给你一些使用它的例子。

好的，进入编码。

首先，我们需要将框架链接到 html 页面。如果它是一个小站点或者你在玩，我喜欢让谷歌为我托管 jQuery。通常你可能只是下载它。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

要实际添加代码并使用 jQuery，我们需要添加一些脚本标签并等待 DOM（文档对象模型）在页面上准备好。

```
<script type="text/javascript">
$(document).ready(function() {
   // do stuff when DOM is ready
});
</script> 
```

现在我们需要选择我们试图从中获取数据的元素。jQuery 选择器非常适合这一点。一个简单的例子是通过它的“id”属性抓取一个元素。

在输入的情况下，我们将使用“名称”。在选择器中引用 ID 时，我们总是在其前面加上 #。

```
$('#name').val() 
```

这将为我们提供输入的值。现在添加另一行。

您的表没有 ID，但让我们给它一个。

```
<table id='numbers'> 
```

为该行添加 html

```
$('#numbers').append('<tr><td></td><td></td></tr>'); 
```

选择我们刚刚添加的行的第一列并添加数字。

```
var rows = $('#numbers tr').length;
$('#numbers tr:last td:first').html(rows); 
```

将输入的值复制到第二列

```
$('#numbers tr:last td:last').html($('#name').val()); 
```

删除空输入

```
$('#name').val(''); 
```

现在为了检测击键，我们将在输入中附加一个侦听器并将所有这些代码放入其中。

```
$('#name').on('keyup', function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) {
        $('#numbers').append('<tr><td></td><td></td></tr>');
        var rowcount = $('#numbers tr').length;
        $('#numbers tr:last td:first').html(rowcount);
        $('#numbers tr:last td:last').html($('#name').val());
        $('#name').val('').focus();
    }
}); 
```

这看起来不错，除了 $('name') 进行额外的选择会减慢您的代码及其附加到该对象的函数内部的冗余。我们可以在监听器中使用 $(this) 而不是 $('#name') 来引用初始选择

```
$('#name').on('keyup', function(e) { 
```

所以我们有 -

```
<script type="text/javascript">
$(document).ready(function() {
   $('#name').on('keyup', function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) {
        $('#numbers').append('<tr><td></td><td></td></tr>');
        var rowcount = $('#numbers tr').length;
        $('#numbers tr:last td:first').html(rowcount);
        $('#numbers tr:last td:last').html($(this).val());
        $(this).val('').focus();
    }
   });
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:16:23.923

欢迎来到 Stackoverflow。

如果您使用 jQuery，请查看[jQuery 的 API](http://api.jquery.com/)以获取有关可用函数的详细信息。您的具体问题似乎与事件有关 - 您可以在[此处](http://api.jquery.com/category/events/)了解更多信息。

简而言之，您需要绑定一个将结果委托给另一个控件的事件。我建议查看[keyup](http://api.jquery.com/keyup/)功能。

我希望这会有所帮助。

**参考：**

*   [http://api.jquery.com/](http://api.jquery.com/)
*   [http://api.jquery.com/category/events/](http://api.jquery.com/category/events/)
*   [http://api.jquery.com/keyup/](http://api.jquery.com/keyup/)

# android - 光传感器调暗屏幕？

> ID：11765817
> 
> 赞同：0
> 
> 时间：2012-08-01T19:04:12.960
> 
> 标签：android, light, ambient

在被指向光传感器之后，我发现自己在这里询问是否有人有一些示例代码用于通过使用周围的环境光来调暗 android 手机的屏幕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:59:21.353

此博客向您展示如何获取光传感器读数， [http://android-coding.blogspot.com/2011/10/using-android-device-build-in-light.html](http://android-coding.blogspot.com/2011/10/using-android-device-build-in-light.html)

这个SO答案告诉你如何调整屏幕的亮度： [Android 2.2：调整屏幕亮度](https://stackoverflow.com/questions/4621490/android-2-2-adjusting-screen-brightness)

确保向您的 Android 清单添加任何必要的权限以读取传感器。

# facebook - 应用和页面的一个 Facebook 帐户，如何？

> ID：11765820
> 
> 赞同：0
> 
> 时间：2012-08-01T19:04:24.043
> 
> 标签：facebook, facebook-graph-api

今天我需要创建一个新的 facebook 应用程序，因为我需要社交插件的 app_id。我之前为我的产品网站创建了一个facebook“page”帐户，但我发现我无法使用“page”帐户创建一个新应用程序：

创建 Facebook 应用程序： [https ://developers.facebook.com/apps](https://developers.facebook.com/apps)

我必须使用普通用户帐户登录才能创建一个新应用程序，所以我现在很困惑......我应该重新创建一个新用户帐户然后创建一个 facebook 应用程序吗？但是如何处理我现有的“页面”帐户呢？

我只想将所有内容绑定在一起，希望一个 facebook 帐户可以绑定“应用程序”和“页面”。

顺便说一句，用户知道谁（帐户）创建了该应用程序吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:16:50.117

您不能将 Facebook 应用程序创建为 Facebook 页面。您不能以 Facebook 页面的形式访问任何其他应用程序。如果您在充当 FB 页面时尝试打开应用程序，系统会要求您切换回常规帐户。

页面标识不是帐户。您甚至不能以页面的形式登录 FB，您必须使用您的用户帐户登录，然后切换到页面模式。这只是您可以用来发表评论或发帖的身份。他们最近才引入了页面消息传递系统，它仍然有很多错误。

您不需要新帐户。您可以使用与创建 FB 页面相同的帐户来创建 FB 应用程序。一切都将绑定到您的普通用户帐户。

**编辑**

由于您在帖子中添加了一个问题：您可以创建应用程序并使用您的用户帐户作为所有者。或者您可以使用公司名称创建应用程序，这样您的用户帐户就不会在应用程序中列出。

# oracle11g - Oracle：执行查询时出错

> ID：11765821
> 
> 赞同：0
> 
> 时间：2012-08-01T19:04:31.327
> 
> 标签：oracle11g, oracle-sqldeveloper, hibernate3

我有一个表`SyncTokenLock`，其中包含`lockName`CLOB 类型的列。当我从 SQLDeveloper 运行以下查询时 -

```
select * from SyncTokenLock where 
lockName='com.vmware.horizon.datastore.impl.ProvisioningStateDataServiceImpl'; 
```

我得到以下异常 -

```
ORA-00932: inconsistent datatypes: expected - got CLOB
00932\. 00000 -  "inconsistent datatypes: expected %s got %s" 
```

当通过 Hibernate (3.6.10) 针对 Oracle 11g 执行此查询时，我得到类似的错误。Hibernate 抛出以下异常 -

```
ORA-00932: inconsistent datatypes: expected - got CLOB 
```

任何想法可能是什么原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T00:21:57.447

正确，您不能在 WHERE 子句中将相等与 CLOB 一起使用。但是你可以这样做：

```
SELECT * FROM SyncTokenLock 
 WHERE dbms_lob.substr(lockName, 100) = 
           'com.vmware.horizon.datastore.impl.ProvisioningStateDataServiceImpl'; 
```

您的专栏*真的*需要成为 CLOB 吗？您是否期望超过 4000 个字符的值？如果没有，请使用 VARCHAR2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-20T12:22:28.207

您可以不使用等号，而是使用`like`：

```
select * from SyncTokenLock where lockName like 'com.vmware.horizon.datastore.impl.ProvisioningStateDataServiceImpl'; 
```

# xml - 在 AS3、FlashPunk 和 Ogmo 中导入 XML，涉及冒号 (":") 的语法

> ID：11765827
> 
> 赞同：0
> 
> 时间：2012-08-01T19:04:48.530
> 
> 标签：xml, actionscript-3

所以，我有一个游戏，它使用了一堆不同大小的瓷砖，我决定编写一个扩展的关卡加载器来适应我的疯狂。

据我所见，保存图层大小和类型的唯一位置是在标记下的 .oep 项目文件中。

```
<LayerDefinitions>
<LayerDefinition xsi:type="GridLayerDefinition">
  <Name>Solids</Name>
  <Grid>
    <Width>24</Width>
    <Height>24</Height>
  </Grid>
  <ScrollFactor>
    <X>1</X>
    <Y>1</Y>
  </ScrollFactor>
  <Color A="255" R="0" G="0" B="0" />
  <ExportMode>Rectangles</ExportMode>
</LayerDefinition> 
```

这很好，很容易提取网格的名称、宽度和高度。我真正需要的是 TYPE，它存储在 LayerDefinition 标签中：

```
<LayerDefinition xsi:type="GridLayerDefinition"> 
```

问题是，如果我尝试获取 @xsi:type 属性，我会因为冒号而收到错误消息。我怎样才能解决这个问题？如何获取 .xsi:type 属性？图层类型是否存储在我没有看到的其他地方？当前导入代码：

```
private function loadProject():void
    {
        var curProject:XML = FP.getXML(TESTPROJECT);
        var entry:XML;
        var counter:uint = 0;
        trace("Loading project");
    //  trace(curProject.*);
        for each (entry in curProject.LayerDefinitions)
        {
            trace ("Grid type is: " + entry.@xsi:type);
            trace ("Grid is: " + entry.LayerDefinition.Name);
        }
    } 
```

这会产生错误：

```
\src\levelLoader.as(51): col: 41 Error: Syntax error: expecting rightparen before colon. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T22:20:16.007

您可以使用该`attribute()`方法获取与 ActionScipt 保留字或语法冲突的属性值。

```
trace("Grid type is: " + entry.attribute("xsi:type")); 
```

这应该有效，并为您提供所需的价值。您可以在[此处查看](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/XML.html#attribute%28%29)`attribute()`AS3 参考中的方法。

# android - android：活动创建xml文件

> ID：11765829
> 
> 赞同：1
> 
> 时间：2012-08-01T19:04:52.960
> 
> 标签：android, xml, service, android-activity

活动是否可以创建 xml 文件并在其中写入？或者只是修改 res 文件夹中的现有 xml 文件？

我正在尝试实现一项活动，用户可以在其中设计动态壁纸，而不是将其保存到某种 xml 文件中，或修改现有文件（可能会更好），壁纸服务将读取该 xml 文件将其应用到屏幕上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:40:49.337

也许[这](http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/)会有所帮助

我没有使用过 XML，但我怀疑这是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T20:01:27.907

在运行时修改代码是一种不好的做法，而且我认为甚至不可能。一种可能的解决方案是创建一个默认布局，然后使用 java 方法对其进行修改，如果没有方法，您应该扩展对象的 View 类（按钮、图像视图...）。以下问题可能对您有帮助

[Android 运行时布局教程](https://stackoverflow.com/questions/2693744/android-runtime-layout-tutorial)

# php - MySQL db中的字符串中的引号，变成�标记（PHP）

> ID：11765830
> 
> 赞同：1
> 
> 时间：2012-08-01T19:05:04.737
> 
> 标签：php, mysql

这是我在 MySQL 数据库中的字符串，(TEXT)，

```
Hello 'muffin' 
```

做时的输出

```
$query = mysql_query("SELECT * FROM articles");
while ($row=mysql_fetch_array($query)) {
<?php echo $row['text']; ?>
} 
```

是

```
Hello �muffin� 
```

我该如何阻止它，我希望它正常输出引号？:( 我已经确定这不是字体的问题，因此它一定是 MySQL 的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T20:17:22.443

# sql-server - TSQL中表名前的“#”是什么意思？

> ID：11765832
> 
> 赞同：42
> 
> 时间：2012-08-01T19:05:16.847
> 
> 标签：sql-server, tsql

TSQL 中的表名“#mytable”和“mytable”有什么区别？我在很多自定义过程中看到表名以“#”开头。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-01T19:08:54.973

这些是创建它们的进程专用的本地临时表。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-08-01T19:07:23.987

#mytable 是一个临时表，而 mytable 是一个具体表。

您可以阅读有关[SQL Server 中的临时表的](http://www.simple-talk.com/sql/t-sql-programming/temporary-tables-in-sql-server/)更多信息。

> 在批处理或过程中处理数据时，它们最常用于为中间结果提供工作空间。它们还用于从表值函数传递表，在存储过程之间传递基于表的数据，或者最近以表值参数的形式，将整个只读表从应用程序发送到 SQL Server 例程，或将只读临时表作为参数传递。一旦完成使用，它们将被自动丢弃。
> 
> 临时表有不同的风格，包括本地临时表（以#开头）、全局临时表（以##开头）、持久临时表（以TempDB..为前缀）和表变量。（以（@开头） )

# matlab - 网格和冲浪

> ID：11765833
> 
> 赞同：1
> 
> 时间：2012-08-01T19:05:21.870
> 
> 标签：matlab

我只是对MatLab 中的`meshgrid`and命令有一个简短的问题。`surf`我输入了以下内容：

```
xx = -2:.2:2;
yy = xx;
[x,y] = meshgrid(xx,yy);
z = exp(-x.^2 - y.^2);
surf(z) 
```

这会生成一个漂亮的 3D 曲面图，但 x 轴和 y 轴显示的值介于 0 到 25 之间。这是为什么呢？值不应该介于 -2 和 2 之间吗？现在，曲面上的最大点大致出现在点 (12.5, 12.5, 1) 处。但这肯定应该是（0,0,1）。这是什么原因造成的？如果有人可以向我解释这一点，我将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:14:44.887

您需要告诉`surf`轴缩放使用的是什么

```
surf(xx, yy, z) 
```

请参阅`surf` [文档](http://www.mathworks.com/help/techdoc/ref/surf.html)。

# c - 如何实现具有惰性传播的段树？

> ID：11765838
> 
> 赞同：23
> 
> 时间：2012-08-01T19:05:42.867
> 
> 标签：c, algorithm, data-structures, tree

我在互联网上搜索了有关段树的实现，但在延迟传播方面一无所获。之前有一些关于堆栈溢出的问题，但他们专注于解决 SPOJ 的一些特定问题。虽然我认为这是使用伪代码对段树的最佳解释，但我需要使用延迟传播来实现它。我发现以下链接：

[http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Segment_Trees](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Segment_Trees)

除了上面的链接，一些博客也在那里，但它们都引用了同一个线程。

### 例子

应用这种数据结构的一个**例子**是，假设我得到了一个从 1 到 n 的数字范围。现在我执行一些操作，例如将一些常数添加到特定范围或从特定范围中减去一些常数。执行操作后，我应该告诉给定数字中的最小和最大数字。

一个**明显的解决方案**是对给定范围内的每个数字一个一个地执行加法或减法。但这在执行的操作都不大的情况下是不可行的。

**更好**的方法是使用带有惰性传播技术的段树。它说不是单独对每个数字执行更新操作，而是跟踪所有操作，直到所有操作完成。然后最后执行更新操作，得到范围内的最小和最大数。

**真实数据示例**

假设我给出了范围 [1,10]，这意味着数字是 1,2,3,4,5,6,7,8,9,10。现在假设我执行一个将 [3,6] 范围内的数字减少 4 的操作，所以现在数字看起来像 1,2,-1,0,1,2,7,8,9,10。现在我执行另一个操作，将 [5,9] 范围内的数字增加 1，因此数字现在看起来像 1,2,-1,0,2,3,8,9,10,10。

现在，如果我要求您告诉我最大和最小数字，那么答案将是：

```
Maximum = 10

Minimum = -1 
```

这只是一个简单的例子。实际的问题可能包含数千个这样的加法/减法运算。我希望现在清楚了。

这是我到目前为止所理解的，但我想互联网上没有统一的链接可以更好地解释概念和实现。

谁能给出一些很好的解释，包括段树中延迟传播的伪代码？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-04T13:08:52.960

惰性传播几乎总是包含某种哨兵机制。您必须验证当前节点不需要传播，并且此检查应该简单快捷。所以有两种可能：

1.  牺牲一点内存在你的节点中保存一个字段，可以很容易地检查
2.  牺牲一点运行时间，以检查节点是否已传播以及是否必须创建其子节点。

我坚持第一个。检查分段树中的节点是否应该有子节点（`node->lower_value != node->upper_value`）非常简单，但是您还必须检查这些子节点是否已经构建（`node->left_child, node->right_child`），所以我引入了一个传播标志`node->propagated`：

```
typedef struct lazy_segment_node{
  int lower_value;
  int upper_value;

  struct lazy_segment_node * left_child;
  struct lazy_segment_node * right_child;

  unsigned char propagated;
} lazy_segment_node; 
```

## 初始化

为了初始化一个节点，我们`initialize`使用指向节点指针（或`NULL`）的指针和所需的`upper_value`/来调用`lower_value`：

```
lazy_segment_node * initialize(
    lazy_segment_node ** mem, 
    int lower_value, 
    int upper_value
){
  lazy_segment_node * tmp = NULL;
  if(mem != NULL)
    tmp = *mem;
  if(tmp == NULL)
    tmp = malloc(sizeof(lazy_segment_node));
  if(tmp == NULL)
    return NULL;
  tmp->lower_value = lower_value;
  tmp->upper_value = upper_value;
  tmp->propagated = 0;
  tmp->left_child = NULL;
  tmp->right_child = NULL;

  if(mem != NULL)
    *mem = tmp;
  return tmp;
} 
```

## 使用权

到目前为止，还没有做任何特别的事情。这看起来像所有其他通用节点创建方法。但是，为了创建实际的子节点并设置传播标志，我们可以使用一个函数，该函数将返回同一节点上的指针，但在需要时传播它：

```
lazy_segment_node * accessErr(lazy_segment_node* node, int * error){
  if(node == NULL){
    if(error != NULL)
      *error = 1;
    return NULL;
  }
  /* if the node has been propagated already return it */
  if(node->propagated)
    return node;

  /* the node doesn't need child nodes, set flag and return */      
  if(node->upper_value == node->lower_value){
    node->propagated = 1;
    return node;
  }

  /* skipping left and right child creation, see code below*/
  return node;
} 
```

如您所见，传播的节点几乎会立即退出该函数。相反，未传播的节点将首先检查它是否实际上应该包含子节点，然后在需要时创建它们。

这实际上是惰性评估。在需要之前不要创建子节点。注意`accessErr`还提供了一个额外的错误接口。如果您不需要它，请`access`改用：

```
lazy_segment_node * access(lazy_segment_node* node){
  return accessErr(node,NULL);
} 
```

## 自由的

为了释放这些元素，您可以使用通用节点释放算法：

```
void free_lazy_segment_tree(lazy_segment_node * root){
  if(root == NULL)
    return;
  free_lazy_segment_tree(root->left_child);
  free_lazy_segment_tree(root->right_child);
  free(root);
} 
```

# 完整示例

以下示例将使用上述函数创建基于区间 [1,10] 的惰性求值段树。可以看到第一次初始化后`test`没有子节点。通过使用`access`，您实际上生成了这些子节点并可以获得它们的值（如果这些子节点通过分段树的逻辑存在）：

## 代码

```
#include <stdlib.h>
#include <stdio.h>

typedef struct lazy_segment_node{
  int lower_value;
  int upper_value;

  unsigned char propagated;

  struct lazy_segment_node * left_child;
  struct lazy_segment_node * right_child;
} lazy_segment_node;

lazy_segment_node * initialize(lazy_segment_node ** mem, int lower_value, int upper_value){
  lazy_segment_node * tmp = NULL;
  if(mem != NULL)
    tmp = *mem;
  if(tmp == NULL)
    tmp = malloc(sizeof(lazy_segment_node));
  if(tmp == NULL)
    return NULL;
  tmp->lower_value = lower_value;
  tmp->upper_value = upper_value;
  tmp->propagated = 0;
  tmp->left_child = NULL;
  tmp->right_child = NULL;

  if(mem != NULL)
    *mem = tmp;
  return tmp;
}

lazy_segment_node * accessErr(lazy_segment_node* node, int * error){
  if(node == NULL){
    if(error != NULL)
      *error = 1;
    return NULL;
  }
  if(node->propagated)
    return node;

  if(node->upper_value == node->lower_value){
    node->propagated = 1;
    return node;
  }
  node->left_child = initialize(NULL,node->lower_value,(node->lower_value + node->upper_value)/2);
  if(node->left_child == NULL){
    if(error != NULL)
      *error = 2;
    return NULL;
  }

  node->right_child = initialize(NULL,(node->lower_value + node->upper_value)/2 + 1,node->upper_value);
  if(node->right_child == NULL){
    free(node->left_child);
    if(error != NULL)
      *error = 3;
    return NULL;
  }  
  node->propagated = 1;
  return node;
}

lazy_segment_node * access(lazy_segment_node* node){
  return accessErr(node,NULL);
}

void free_lazy_segment_tree(lazy_segment_node * root){
  if(root == NULL)
    return;
  free_lazy_segment_tree(root->left_child);
  free_lazy_segment_tree(root->right_child);
  free(root);
}

int main(){
  lazy_segment_node * test = NULL;
  initialize(&test,1,10);
  printf("Lazy evaluation test\n");
  printf("test->lower_value: %i\n",test->lower_value);
  printf("test->upper_value: %i\n",test->upper_value);

  printf("\nNode not propagated\n");
  printf("test->left_child: %p\n",test->left_child);
  printf("test->right_child: %p\n",test->right_child);

  printf("\nNode propagated with access:\n");
  printf("access(test)->left_child: %p\n",access(test)->left_child);
  printf("access(test)->right_child: %p\n",access(test)->right_child);

  printf("\nNode propagated with access, but subchilds are not:\n");
  printf("access(test)->left_child->left_child: %p\n",access(test)->left_child->left_child);
  printf("access(test)->left_child->right_child: %p\n",access(test)->left_child->right_child);

  printf("\nCan use access on subchilds:\n");
  printf("access(test->left_child)->left_child: %p\n",access(test->left_child)->left_child);
  printf("access(test->left_child)->right_child: %p\n",access(test->left_child)->right_child);

  printf("\nIt's possible to chain:\n");
  printf("access(access(access(test)->right_child)->right_child)->lower_value: %i\n",access(access(access(test)->right_child)->right_child)->lower_value);
  printf("access(access(access(test)->right_child)->right_child)->upper_value: %i\n",access(access(access(test)->right_child)->right_child)->upper_value);

  free_lazy_segment_tree(test);

  return 0;
} 
```

## 结果[（ideone）](http://ideone.com/bNVDx)

```
懒惰评估测试
测试->lower_value: 1
测试->upper_value: 10

节点未传播
测试->left_child: (nil)
测试->right_child: (nil)

通过访问传播的节点：
访问（测试）->left_child：0x948e020
访问（测试）->right_child：0x948e038

节点通过访问传播，但子子节点不是：
访问（测试）->left_child->left_child：（无）
访问（测试）->left_child->right_child：（无）

可以在子孩子上使用访问权限：
访问（测试->left_child）->left_child：0x948e050
访问（测试->left_child）->right_child：0x948e068

可以链接：
访问（访问（访问（测试）->right_child）->right_child）->lower_value：9
访问（访问（访问（测试）->right_child）->right_child）->upper_value：10
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-03T14:28:18.623

如果有人在不使用结构的情况下寻找更简单的惰性传播代码：

（代码是不言自明的）

```
/**
 * In this code we have a very large array called arr, and very large set of operations
 * Operation #1: Increment the elements within range [i, j] with value val
 * Operation #2: Get max element within range [i, j]
 * Build tree: build_tree(1, 0, N-1)
 * Update tree: update_tree(1, 0, N-1, i, j, value)
 * Query tree: query_tree(1, 0, N-1, i, j)
 */

#include<iostream>
#include<algorithm>
using namespace std;

#include<string.h>
#include<math.h> 

#define N 20
#define MAX (1+(1<<6)) // Why? :D
#define inf 0x7fffffff

int arr[N];
int tree[MAX];
int lazy[MAX];

/**
 * Build and init tree
 */
void build_tree(int node, int a, int b) {
    if(a > b) return; // Out of range

    if(a == b) { // Leaf node
            tree[node] = arr[a]; // Init value
        return;
    }

    build_tree(node*2, a, (a+b)/2); // Init left child
    build_tree(node*2+1, 1+(a+b)/2, b); // Init right child

    tree[node] = max(tree[node*2], tree[node*2+1]); // Init root value
}

/**
 * Increment elements within range [i, j] with value value
 */
void update_tree(int node, int a, int b, int i, int j, int value) {

    if(lazy[node] != 0) { // This node needs to be updated
        tree[node] += lazy[node]; // Update it

        if(a != b) {
            lazy[node*2] += lazy[node]; // Mark child as lazy
                lazy[node*2+1] += lazy[node]; // Mark child as lazy
        }

        lazy[node] = 0; // Reset it
    }

    if(a > b || a > j || b < i) // Current segment is not within range [i, j]
        return;

    if(a >= i && b <= j) { // Segment is fully within range
            tree[node] += value;

        if(a != b) { // Not leaf node
            lazy[node*2] += value;
            lazy[node*2+1] += value;
        }

            return;
    }

    update_tree(node*2, a, (a+b)/2, i, j, value); // Updating left child
    update_tree(1+node*2, 1+(a+b)/2, b, i, j, value); // Updating right child

    tree[node] = max(tree[node*2], tree[node*2+1]); // Updating root with max value
}

/**
 * Query tree to get max element value within range [i, j]
 */
int query_tree(int node, int a, int b, int i, int j) {

    if(a > b || a > j || b < i) return -inf; // Out of range

    if(lazy[node] != 0) { // This node needs to be updated
        tree[node] += lazy[node]; // Update it

        if(a != b) {
            lazy[node*2] += lazy[node]; // Mark child as lazy
            lazy[node*2+1] += lazy[node]; // Mark child as lazy
        }

        lazy[node] = 0; // Reset it
    }

    if(a >= i && b <= j) // Current segment is totally within range [i, j]
        return tree[node];

    int q1 = query_tree(node*2, a, (a+b)/2, i, j); // Query left child
    int q2 = query_tree(1+node*2, 1+(a+b)/2, b, i, j); // Query right child

    int res = max(q1, q2); // Return final result

    return res;
}

int main() {
    for(int i = 0; i < N; i++) arr[i] = 1;

    build_tree(1, 0, N-1);

    memset(lazy, 0, sizeof lazy);

    update_tree(1, 0, N-1, 0, 6, 5); // Increment range [0, 6] by 5
    update_tree(1, 0, N-1, 7, 10, 12); // Incremenet range [7, 10] by 12
    update_tree(1, 0, N-1, 10, N-1, 100); // Increment range [10, N-1] by 100

    cout << query_tree(1, 0, N-1, 0, N-1) << endl; // Get max element in range [0, N-1]
} 
```

请参阅此链接以获取更多解释[分段树和延迟传播](http://se7so.blogspot.in/2012/12/segment-trees-and-lazy-propagation.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T00:04:50.340

虽然我还没有成功解决，但我相信这个问题比我们想象的要容易得多。您可能甚至不需要使用 Segment Tree/Interval Tree... 事实上，我尝试了两种实现方式`Segment Tree`，一种使用树结构，另一种使用数组，两种解决方案都很快获得了 TLE。我觉得可以使用 Greedy 来完成，但我还不确定。无论如何，如果您想了解如何使用 Segment Tree 完成工作，请随时研究我的解决方案。注意`max_tree[1]`和`min_tree[1]`对应于`max/min`。

```
#include <iostream>
#include <iomanip>
#include <vector>
#include <string>
#include <algorithm>
#include <map>
#include <set>
#include <utility>
#include <stack>
#include <deque>
#include <queue>
#include <fstream>
#include <functional>
#include <numeric>

#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cmath>
#include <cassert>

#ifdef _WIN32 || _WIN64
#define getc_unlocked _fgetc_nolock
#endif

using namespace std;

const int MAX_RANGE = 1000000;
const int NIL = -(1 << 29);
int data[MAX_RANGE] = {0};
int min_tree[3 * MAX_RANGE + 1];
int max_tree[3 * MAX_RANGE + 1];
int added_to_interval[3 * MAX_RANGE + 1];

struct node {
    int max_value;
    int min_value;
    int added;
    node *left;
    node *right;
};

node* build_tree(int l, int r, int values[]) {
    node *root = new node;
    root->added = 0;
    if (l > r) {
        return NULL;
    }
    else if (l == r) {
        root->max_value = l + 1; // or values[l]
        root->min_value = l + 1; // or values[l]
        root->added = 0;
        root->left = NULL;
        root->right = NULL;
        return root;
    }
    else {  
        root->left = build_tree(l, (l + r) / 2, values);
        root->right = build_tree((l + r) / 2 + 1, r, values);
        root->max_value = max(root->left->max_value, root->right->max_value);
        root->min_value = min(root->left->min_value, root->right->min_value);
        root->added = 0;
        return root;
    }
}

node* build_tree(int l, int r) {
    node *root = new node;
    root->added = 0;
    if (l > r) {
        return NULL;
    }
    else if (l == r) {
        root->max_value = l + 1; // or values[l]
        root->min_value = l + 1; // or values[l]
        root->added = 0;
        root->left = NULL;
        root->right = NULL;
        return root;
    }
    else {  
        root->left = build_tree(l, (l + r) / 2);
        root->right = build_tree((l + r) / 2 + 1, r);
        root->max_value = max(root->left->max_value, root->right->max_value);
        root->min_value = min(root->left->min_value, root->right->min_value);
        root->added = 0;
        return root;
    }
}

void update_tree(node* root, int begin, int end, int i, int j, int amount) {
    // out of range
    if (begin > end || begin > j || end < i) {
        return;
    }
    // in update range (i, j)
    else if (i <= begin && end <= j) {
        root->max_value += amount;
        root->min_value += amount;
        root->added += amount;
    }
    else {
        if (root->left == NULL && root->right == NULL) {
            root->max_value = root->max_value + root->added;
            root->min_value = root->min_value + root->added;
        }
        else if (root->right != NULL && root->left == NULL) {
            update_tree(root->right, (begin + end) / 2 + 1, end, i, j, amount);
            root->max_value = root->right->max_value + root->added;
            root->min_value = root->right->min_value + root->added;
        }
        else if (root->left != NULL && root->right == NULL) {
            update_tree(root->left, begin, (begin + end) / 2, i, j, amount);
            root->max_value = root->left->max_value + root->added;
            root->min_value = root->left->min_value + root->added;
        }
        else {
            update_tree(root->right, (begin + end) / 2 + 1, end, i, j, amount);
            update_tree(root->left, begin, (begin + end) / 2, i, j, amount);
            root->max_value = max(root->left->max_value, root->right->max_value) + root->added;
            root->min_value = min(root->left->min_value, root->right->min_value) + root->added;
        }
    }
}

void print_tree(node* root) {
    if (root != NULL) {
        print_tree(root->left);
        cout << "\t(max, min): " << root->max_value << ", " << root->min_value << endl;
        print_tree(root->right);
    }
}

void clean_up(node*& root) {
    if (root != NULL) {
        clean_up(root->left);
        clean_up(root->right);
        delete root;
        root = NULL;
    }
}

void update_bruteforce(int x, int y, int z, int &smallest, int &largest, int data[], int n) {
    for (int i = x; i <= y; ++i) {
        data[i] += z;       
    }

    // update min/max
    smallest = data[0];
    largest = data[0];
    for (int i = 0; i < n; ++i) {
        if (data[i] < smallest) {
            smallest = data[i];
        }

        if (data[i] > largest) {
            largest = data[i];
        }
    }
}

void build_tree_as_array(int position, int left, int right) {
    if (left > right) {
        return;
    }
    else if (left == right) {
        max_tree[position] = left + 1;
        min_tree[position] = left + 1;
        added_to_interval[position] = 0;
        return;
    }
    else {
        build_tree_as_array(position * 2, left, (left + right) / 2);
        build_tree_as_array(position * 2 + 1, (left + right) / 2 + 1, right);
        max_tree[position] = max(max_tree[position * 2], max_tree[position * 2 + 1]);
        min_tree[position] = min(min_tree[position * 2], min_tree[position * 2 + 1]);
    }
}

void update_tree_as_array(int position, int b, int e, int i, int j, int value) {
    if (b > e || b > j || e < i) {
        return;
    }
    else if (i <= b && e <= j) {
        max_tree[position] += value;
        min_tree[position] += value;
        added_to_interval[position] += value;
        return;
    }
    else {
        int left_branch = 2 * position;
        int right_branch = 2 * position + 1;
        // make sure the array is ok
        if (left_branch >= 2 * MAX_RANGE + 1 || right_branch >= 2 * MAX_RANGE + 1) {
            max_tree[position] = max_tree[position] + added_to_interval[position];
            min_tree[position] = min_tree[position] + added_to_interval[position];
            return;
        }
        else if (max_tree[left_branch] == NIL && max_tree[right_branch] == NIL) {
            max_tree[position] = max_tree[position] + added_to_interval[position];
            min_tree[position] = min_tree[position] + added_to_interval[position];
            return;
        }
        else if (max_tree[left_branch] != NIL && max_tree[right_branch] == NIL) {
            update_tree_as_array(left_branch, b , (b + e) / 2 , i, j, value);
            max_tree[position] = max_tree[left_branch] + added_to_interval[position];
            min_tree[position] = min_tree[left_branch] + added_to_interval[position];
        }
        else if (max_tree[right_branch] != NIL && max_tree[left_branch] == NIL) {
            update_tree_as_array(right_branch, (b + e) / 2 + 1 , e , i, j, value);
            max_tree[position] = max_tree[right_branch] + added_to_interval[position];
            min_tree[position] = min_tree[right_branch] + added_to_interval[position];
        }
        else {
            update_tree_as_array(left_branch, b, (b + e) / 2 , i, j, value);
            update_tree_as_array(right_branch, (b + e) / 2 + 1 , e , i, j, value);
            max_tree[position] = max(max_tree[position * 2], max_tree[position * 2 + 1]) + added_to_interval[position]; 
            min_tree[position] = min(min_tree[position * 2], min_tree[position * 2 + 1]) + added_to_interval[position];
        }
    }
}

void show_data(int data[], int n) {
    cout << "[current data]\n";
    for (int i = 0; i < n; ++i) {
        cout << data[i] << ", ";
    }
    cout << endl;
}

inline void input(int* n) {
    char c = 0;
    while (c < 33) {
        c = getc_unlocked(stdin);
    }

    *n = 0;
    while (c > 33) {
        *n = (*n * 10) + c - '0';
        c = getc_unlocked(stdin);
    }
}

void handle_special_case(int m) {
    int type;
    int x;
    int y;
    int added_amount;
    for (int i = 0; i < m; ++i) {
        input(&type);
        input(&x);
        input(&y);
        input(&added_amount);
    }
    printf("0\n");
}

void find_largest_range_use_tree() {
    int n;
    int m;
    int type;
    int x;
    int y;
    int added_amount;

    input(&n);
    input(&m);

    if (n == 1) {
        handle_special_case(m);
        return;
    }

    node *root = build_tree(0, n - 1);
    for (int i = 0; i < m; ++i) {
        input(&type);
        input(&x);
        input(&y);
        input(&added_amount);
        if (type == 1) {    
            added_amount *= 1;
        }
        else {
            added_amount *= -1;
        }

        update_tree(root, 0, n - 1, x - 1, y - 1, added_amount);
    }

    printf("%d\n", root->max_value - root->min_value);
}

void find_largest_range_use_array() {
    int n;
    int m;
    int type;
    int x;
    int y;
    int added_amount;

    input(&n);
    input(&m);

    if (n == 1) {
        handle_special_case(m);
        return;
    }

    memset(min_tree, NIL, 3 * sizeof(int) * n + 1);
    memset(max_tree, NIL, 3 * sizeof(int) * n + 1);
    memset(added_to_interval, 0, 3 * sizeof(int) * n + 1);
    build_tree_as_array(1, 0, n - 1);

    for (int i = 0; i < m; ++i) {
        input(&type);
        input(&x);
        input(&y);
        input(&added_amount);
        if (type == 1) {    
            added_amount *= 1;
        }
        else {
            added_amount *= -1;
        }

        update_tree_as_array(1, 0, n - 1, x - 1, y - 1, added_amount);
    }

    printf("%d\n", max_tree[1] - min_tree[1]);
}

void update_slow(int x, int y, int value) {
    for (int i = x - 1; i < y; ++i) {
        data[i] += value;
    }
}

void find_largest_range_use_common_sense() {
    int n;
    int m;
    int type;
    int x;
    int y;
    int added_amount;

    input(&n);
    input(&m);

    if (n == 1) {
        handle_special_case(m);
        return;
    }

    memset(data, 0, sizeof(int) * n);
    for (int i = 0; i < m; ++i) {
        input(&type);
        input(&x);
        input(&y);
        input(&added_amount);

        if (type == 1) {    
            added_amount *= 1;
        }
        else {
            added_amount *= -1;
        }

        update_slow(x, y, added_amount);
    }

     // update min/max
    int smallest = data[0] + 1;
    int largest = data[0] + 1;
    for (int i = 1; i < n; ++i) {
        if (data[i] + i + 1 < smallest) {
            smallest = data[i] + i + 1;
        }

        if (data[i] + i + 1 > largest) {
            largest = data[i] + i + 1;
        }
    }

    printf("%d\n", largest - smallest); 
}

void inout_range_of_data() {
    int test_cases;
    input(&test_cases);

    while (test_cases--) {
        find_largest_range_use_common_sense();
    }
}

namespace unit_test {
    void test_build_tree() {
        for (int i = 0; i < MAX_RANGE; ++i) {
            data[i] = i + 1;
        }

        node *root = build_tree(0, MAX_RANGE - 1, data);
        print_tree(root);
    }

    void test_against_brute_force() {
          // arrange
        int number_of_operations = 100;
        for (int i = 0; i < MAX_RANGE; ++i) {
            data[i] = i + 1;
        }

        node *root = build_tree(0, MAX_RANGE - 1, data);

        // print_tree(root);
        // act
        int operation;
        int x;
        int y;
        int added_amount;
        int smallest = 1;
        int largest = MAX_RANGE;

        // assert
        while (number_of_operations--) {
            operation = rand() % 2; 
            x = 1 + rand() % MAX_RANGE;
            y = x + (rand() % (MAX_RANGE - x + 1));
            added_amount = 1 + rand() % MAX_RANGE;
            // cin >> operation >> x >> y >> added_amount;
            if (operation == 1) {
                added_amount *= 1;
            }
            else {
                added_amount *= -1;    
            }

            update_bruteforce(x - 1, y - 1, added_amount, smallest, largest, data, MAX_RANGE);
            update_tree(root, 0, MAX_RANGE - 1, x - 1, y - 1, added_amount);
            assert(largest == root->max_value);
            assert(smallest == root->min_value);
            for (int i = 0; i < MAX_RANGE; ++i) {
                cout << data[i] << ", ";
            }
            cout << endl << endl;
            cout << "correct:\n";
            cout << "\t largest = " << largest << endl;
            cout << "\t smallest = " << smallest << endl;
            cout << "testing:\n";
            cout << "\t largest = " << root->max_value << endl;
            cout << "\t smallest = " << root->min_value << endl;
            cout << "testing:\n";
            cout << "\n------------------------------------------------------------\n";
            cout << "final result: " << largest - smallest << endl;
            cin.get();
        }

        clean_up(root);
    }

    void test_automation() {
          // arrange
        int test_cases;
        int number_of_operations = 100;
        int n;

        test_cases = 10000;
        for (int i = 0; i < test_cases; ++i) {
            n = i + 1;

            int operation;
            int x;
            int y;
            int added_amount;
            int smallest = 1;
            int largest = n;

            // initialize data for brute-force
            for (int i = 0; i < n; ++i) {
                data[i] = i + 1;
            }

            // build tree   
            node *root = build_tree(0, n - 1, data);
            for (int i = 0; i < number_of_operations; ++i) {
                operation = rand() % 2; 
                x = 1 + rand() % n;
                y = x + (rand() % (n - x + 1));
                added_amount = 1 + rand() % n;

                if (operation == 1) {
                    added_amount *= 1;
                }
                else {
                    added_amount *= -1;    
                }

                update_bruteforce(x - 1, y - 1, added_amount, smallest, largest, data, n);
                update_tree(root, 0, n - 1, x - 1, y - 1, added_amount);
                assert(largest == root->max_value);
                assert(smallest == root->min_value);

                cout << endl << endl;
                cout << "For n = " << n << endl;
                cout << ", where data is : \n";
                for (int i = 0; i < n; ++i) {
                    cout << data[i] << ", ";
                }
                cout << endl;
                cout << " and query is " << x - 1 << ", " << y - 1 << ", " << added_amount << endl;
                cout << "correct:\n";
                cout << "\t largest = " << largest << endl;
                cout << "\t smallest = " << smallest << endl;
                cout << "testing:\n";
                cout << "\t largest = " << root->max_value << endl;
                cout << "\t smallest = " << root->min_value << endl;
                cout << "\n------------------------------------------------------------\n";
                cout << "final result: " << largest - smallest << endl;
            }

            clean_up(root);
        }

        cout << "DONE............\n";
    }

    void test_tree_as_array() {
          // arrange
        int test_cases;
        int number_of_operations = 100;
        int n;
        test_cases = 1000;
        for (int i = 0; i < test_cases; ++i) {
            n = MAX_RANGE;
            memset(min_tree, NIL, sizeof(min_tree));
            memset(max_tree, NIL, sizeof(max_tree));
            memset(added_to_interval, 0, sizeof(added_to_interval));
            memset(data, 0, sizeof(data));

            int operation;
            int x;
            int y;
            int added_amount;
            int smallest = 1;
            int largest = n;

            // initialize data for brute-force
            for (int i = 0; i < n; ++i) {
                data[i] = i + 1;
            }

            // build tree using array
            build_tree_as_array(1, 0, n - 1);
            for (int i = 0; i < number_of_operations; ++i) {
                operation = rand() % 2; 
                x = 1 + rand() % n;
                y = x + (rand() % (n - x + 1));
                added_amount = 1 + rand() % n;

                if (operation == 1) {
                    added_amount *= 1;
                }
                else {
                    added_amount *= -1;    
                }

                update_bruteforce(x - 1, y - 1, added_amount, smallest, largest, data, n);
                update_tree_as_array(1, 0, n - 1, x - 1, y - 1, added_amount);
                //assert(max_tree[1] == largest);
                //assert(min_tree[1] == smallest);

                cout << endl << endl;
                cout << "For n = " << n << endl;
                // show_data(data, n);
                cout << endl;
                cout << " and query is " << x - 1 << ", " << y - 1 << ", " << added_amount << endl;
                cout << "correct:\n";
                cout << "\t largest = " << largest << endl;
                cout << "\t smallest = " << smallest << endl;
                cout << "testing:\n";
                cout << "\t largest = " << max_tree[1] << endl;
                cout << "\t smallest = " << min_tree[1] << endl;
                cout << "\n------------------------------------------------------------\n";
                cout << "final result: " << largest - smallest << endl;
                cin.get();
            }
        }

        cout << "DONE............\n";
    }
}

int main() {
    // unit_test::test_against_brute_force();
    // unit_test::test_automation();    
    // unit_test::test_tree_as_array();
    inout_range_of_data();

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-11T05:38:01.663

使段树变得懒惰似乎没有任何优势。最终，您将需要查看每个单位坡度段的末端以获得最小值和最大值。因此，您不妨急切地扩展它们。

相反，只需修改标准段树定义。树中的每个区间都将存储一个额外的整数`d`，因此我们将编写`[d; lo,hi]`. 树有以下操作：

```
init(T, hi) // make a segment tree for the interval [0; 1,hi]
split(T, x, d)  // given there exists some interval [e; lo,hi],
                // in T where lo < x <= hi, replace this interval
                // with 2 new ones [e; lo,x-1] and [d; x,hi];
                // if x==lo, then replace with [e+d; lo,hi] 
```

现在在初始化之后，我们使用两个拆分操作来处理添加`d`到子间隔：`[lo,hi]`

```
split(T, lo, d); split(T, hi+1, -d); 
```

这里的想法是我们`d`在位置`lo`和右边添加所有内容，然后再次减去它`hi+1`。

构建树后，从左到右遍历叶子让我们找到整数单位斜率段末端的值。这就是我们计算最小值和最大值所需的全部内容。更正式地说，如果树的叶间隔是`[d_i; lo_i,hi_i]`，`i=1..n`按从左到右的顺序，那么我们要计算运行差`D_i = sum{i=1..n} d_i`，然后`L_i = lo_i + D_i`和`H_i = hi_i + D_i`。在示例中，我们从`[0; 1,10]`d=-4 的 4 和 d=+4 的 7 开始，然后拆分，以获得`[0; 1,2] [-4; 3,6] [4; 7,10]`. 然后`L = [1,-1,7]`和`H = [2, 2, 10]`。所以 min 是 -1 而 max 是 10。这是一个简单的例子，但它通常可以工作。

运行时间为 O( min (k log N, k^2) )，其中 N 是最大初始范围值（示例中为 10），k 是应用的操作数。如果您在拆分排序方面运气不佳，则会出现 k^2 情况。如果将操作列表随机化，则预期时间将为 O(k min (log N, log k))。

如果您有兴趣，我可以为您编写代码。但如果没有兴趣，我不会。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T08:16:31.300

这是链接。它具有延迟传播的分段树的实现和解释。虽然代码是用 Java 编写的，但这并不重要，因为只有两个函数“更新”和“查询”，它们都是基于数组的。所以这些函数也可以在 C 和 C++ 中工作，无需任何修改。

[http://isharemylearning.blogspot.in/2012/08/lazy-propagation-in-segment-tree.html](http://isharemylearning.blogspot.in/2012/08/lazy-propagation-in-segment-tree.html)

# sql - 为什么 SQL 不总是接受表达式来代替整数？

> ID：11765842
> 
> 赞同：3
> 
> 时间：2012-08-01T19:05:58.790
> 
> 标签：sql

在命令式编程语言中，您可以在任何需要整数的地方放置表达式。为什么在 SQL 中不是这样？为什么 SQL 不接受这样的东西：

```
 Create Table Entries (Title Varchar((Select Count(ID) From SomeOtherTable))) 
```

例如，当这有效时：

```
 Select * From Entries Where id = (Select Count(id) From SomeOtherTable) 
```

现在，当然，这些例子是愚蠢的。我真的不在乎是否可以基于动态信息创建表。我想了解为什么 SQL 在这方面与 C 或 C# 或 Delphi 等不同。在这些语言中，我知道什么会根据直观规则起作用。当我编写查询时，我有点不确定是否会接受某些构造：有时会，有时不会（我还是 SQL 新手，所以这可能是主要原因）。

如果这有一些相关性，我正在使用 Interbase 7.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:33:57.917

`CREATE TABLE`是[DDL（数据定义语言）](http://en.wikipedia.org/wiki/Data_Definition_Language)，即定义数据库的模式结构，而`SELECT`DML [（数据操作语言）](http://en.wikipedia.org/wiki/Data_Manipulation_Language)，即处理存储在模式中的数据。

您不能在一个查询中混合和匹配 DDL 和 DML。

# java - 抽象和函数覆盖的区别？

> ID：11765844
> 
> 赞同：0
> 
> 时间：2012-08-01T19:06:01.053
> 
> 标签：java

在 java 中，我们将 body 赋予子类中父类的抽象方法，然后通过子类对象调用该函数，例如：

```
//let the abstract  function be fun  then,     
child c= new child();    
c.fun(); 
```

然后`fun`执行由给出的主体，`child`但是这与在函数覆盖中所做的相同有什么新的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:09:36.170

不同之处在于，不是抽象的子类**必须**实现所有继承的抽象方法。`super.method()`此外，由于抽象类中没有实现，因此无法调用具体实现。

至于为什么，或者更明确地说，为什么选择抽象超类而不是接口：通常只提供接口的*某些*方法的实现是有用的——例如代码共享——并且需要具体的子类来提供特定的实现界面的其他部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:07:53.290

抽象意味着开发人员有（显式）实现该方法。覆盖意味着开发人员实现了一个已经实现的方法。这是根据语言的定义。

# php - 使用 jquery 或 php 从另一个页面加载第一个 div

> ID：11765847
> 
> 赞同：0
> 
> 时间：2012-08-01T19:06:07.907
> 
> 标签：php, jquery

我不确定这是可能的，但我知道你们会知道答案。

我想知道是否可以将页面上的第一个 div 加载到不同的页面中。

例子：

此代码在“list.php”上

```
<div class="message_details">
Some Content 1
</div>
<div class="message_details">
Some Content 2
</div> 
```

我找到了这篇文章，它有效，但它引入了所有 div，但我只想加载第一个 div。

[使用 Ajax/jQuery 将外部页面的内容加载到另一个页面](https://stackoverflow.com/questions/4560183/load-content-from-external-page-into-another-page-using-ajax-jquery)

这是我现在加载所有div的代码

```
$(document).ready(function() {
    $(".loader").load('list.php .message_details');
}); 
```

如何仅加载第一个 div？还有什么方法可以删除所选 div 中的 img 标签？

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:07:22.503

使用`:first-child`选择器

```
$(".loader").load('list.php .message_details:first-child', function() {
    $(this).find("img").remove();
}); 
```

[参考](http://api.jquery.com/first-child-selector/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:08:43.783

只需在第二页中回显 div。给每个 div 一个 id，然后回显它。（除非我误解了你的目标）

# c# - 在 .NET 中寻找用于并发的静态代码分析工具，如 Java 的 CheckThread

> ID：11765854
> 
> 赞同：10
> 
> 时间：2012-08-01T19:06:46.360
> 
> 标签：c#, .net, multithreading, task-parallel-library

我正在 c# 中实现一个并发的 .NET 数据结构（例如`ConcurrentDictionary`，`BlockcingCollection`等等）。这不仅仅是在从不同线程访问时不要忘记锁定对象。它需要复杂的锁定策略来最大化并行执行时间。

我知道有一个工具，一种用于 .NET 系统并发测试的框架，名为[CHESS](http://chesstool.codeplex.com/)。

**问题**：是否还有一个工具可以通过静态代码分析发现并发/线程问题？像[CheckThread 之](http://www.checkthread.org/index.html)类的东西是用于 java 的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-01T19:43:44.893

以下是一组有助于并发编程的资源......它们是静态和基于运行时的工具的混合体。

## 英特尔 Inspector XE/Parallel Studio

英特尔在 Parallel Studio 中提供了一些有助于并发开发的工具，但他们的 Parallel Advisor 仅适用于 C/C++。

但是对于 C#，您可以使用他们的 Inspector XE（以前称为 Intel Thread Checker）进行运行时线程检查

*   [http://software.intel.com/en-us/articles/intel-inspector-xe/](http://software.intel.com/en-us/articles/intel-inspector-xe/)。

* * *

## PRESharp（微软卓越软件中心）

这里似乎提到了一种叫做 PRESharp 的东西：

*   [http://www.microsoft.com/windows/cse/pa_projects.mspx](http://www.microsoft.com/windows/cse/pa_projects.mspx)

现在我以前没有听说过……只有听起来相似的 PREFast，我过去曾用它来静态分析一些 C 驱动程序代码。我怀疑这是一种内部 Microsoft 工具，除非您获得特殊访问权限，否则其他人无法使用。

* * *

## 静态分析工具

这里有大量静态分析工具（例如 FXCop）。

*   [哪些静态分析工具可用于 C#？](https://stackoverflow.com/questions/38635/what-static-analysis-tools-are-available-for-c)

和此处提到的 Typemock Racer：

*   [用于查找竞争条件/死锁的 C#/.NET 分析工具](https://stackoverflow.com/questions/2379610/c-net-analysis-tool-to-find-race-conditions-deadlocks)

值得注意的是 Coverity Prevent，它声称通过静态分析 C/C++、Java 或 C# 代码（由 NASA 评定）来检测并发缺陷。

*   [http://www.verifysoft.com/en_coverity_prevent_concurrency.html](http://www.verifysoft.com/en_coverity_prevent_concurrency.html)

*   [http://www.theregister.co.uk/2012/08/22/mars_rover_software_coverity/](http://www.theregister.co.uk/2012/08/22/mars_rover_software_coverity/)）

* * *

## WinDBG + SOSEX

其他有助于并发编程的工具是 WinDBG（Windows 调试工具的一部分，分布在 Windows SDK 中），它比 Visual Studio 调试器更强大。

*   [http://msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx)

注意：您现在可以在 Visual Studio 2012 中使用功能更强大的用户模式调试器，如果您在系统中安装 Windows 驱动程序工具包 8，它与 WinDBG 相当。

*   [http://msdn.microsoft.com/en-us/library/windows/hardware/gg487428.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/gg487428.aspx)

*   [http://blogs.msdn.com/b/mariohewardt/archive/2012/06/05/visual-studio-2012-and-windbg-integration.aspx](http://blogs.msdn.com/b/mariohewardt/archive/2012/06/05/visual-studio-2012-and-windbg-integration.aspx)

您还可以获取 WinDBG 的插件来扩展它，例如 SOSEX 插件添加`!dlk`可以帮助识别死锁原因的命令。

*   [http://stevestechspot.com/](http://stevestechspot.com/)

*   [http://blog.scriptico.com/04/debugging-with-windbg-deadlocks-in-applications/](http://blog.scriptico.com/04/debugging-with-windbg-deadlocks-in-applications/)

*   [使用 Windbg 的 !clrstack 命令调试死锁](https://stackoverflow.com/questions/3536465/debugging-a-deadlock-with-windbgs-clrstack-command)

*   [http://blogs.msdn.com/b/tess/archive/2008/02/11/hang-caused-by-gc-xml-deadlock.aspx](http://blogs.msdn.com/b/tess/archive/2008/02/11/hang-caused-by-gc-xml-deadlock.aspx)

* * *

## 并发可视化工具（在 Visual Studio 2010+ 中）

Visual Studio 中有并发可视化工具和与之配套的 SDK。

*   [http://msdn.microsoft.com/en-us/library/dd537632.aspx](http://msdn.microsoft.com/en-us/library/dd537632.aspx)

*   [http://blogs.msdn.com/b/visualizeparallel/archive/2011/10/17/introducing-the-concurrency-visualizer-sdk.aspx](http://blogs.msdn.com/b/visualizeparallel/archive/2011/10/17/introducing-the-concurrency-visualizer-sdk.aspx)

*   [http://msdn.microsoft.com/en-us/magazine/ee336027.aspx](http://msdn.microsoft.com/en-us/magazine/ee336027.aspx)

*   [http://msdn.microsoft.com/en-us/magazine/ee410778.aspx](http://msdn.microsoft.com/en-us/magazine/ee410778.aspx)

* * *

## 一般并发编程设计注意事项

*   [http://msdn.microsoft.com/en-us/magazine/cc817398.aspx](http://msdn.microsoft.com/en-us/magazine/cc817398.aspx)

*   [http://msdn.microsoft.com/en-us/library/ff963553.aspx](http://msdn.microsoft.com/en-us/library/ff963553.aspx)

*   [http://msdn.microsoft.com/en-us/magazine/cc872852.aspx](http://msdn.microsoft.com/en-us/magazine/cc872852.aspx)

*   [http://msdn.microsoft.com/en-us/magazine/cc163744.aspx](http://msdn.microsoft.com/en-us/magazine/cc163744.aspx)

*   [http://www.packtpub.com/beginners-guide-for-C-sharp-2008-and-2005-threaded-programming/book](http://www.packtpub.com/beginners-guide-for-C-sharp-2008-and-2005-threaded-programming/book)

* * *

## 视频资源

这是一系列精彩的视频，可为您提供有关调试 .NET 应用程序的一般建议：

*   [http://channel9.msdn.com/Series/-NET-Debugging-Stater-Kit-for-the-Production-Environment/Diagnosing-Application-Issues-01](http://channel9.msdn.com/Series/-NET-Debugging-Stater-Kit-for-the-Production-Environment/Diagnosing-Application-Issues-01)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-27T20:20:18.000

我应该补充：

* * *

## 基于模型的验证

此技术使用应用程序线程原语的正式*模型*，并尝试断言或反驳该模型具有您想要的属性，例如免于死锁。

使用正式语言（例如[Promela](http://en.wikipedia.org/wiki/Promela) ）编写模型，然后使用模型检查器（例如[Spin](http://spinroot.com/spin/whatispin.html) ）证明模型的属性。

*   [￼验证可重入读者-作者。伯纳德·范·加斯特尔。](http://www.ru.nl/publish/pages/578936/bvgastelthesis.pdf)

*   [Reentrant Readers-Writers – 一个将模型检查与定理证明相结合的案例研究 – ICIS 技术报告 R08005。Bernard van Gastel、Leonard Lensink、Sjaak Smetsers 和 Marko van Eekelen。](http://repository.ubn.ru.nl/bitstream/handle/2066/72239/72239.pdf?sequence=1)

# php - PHP 数学函数常数 E

> ID：11765857
> 
> 赞同：-2
> 
> 时间：2012-08-01T19:06:57.327
> 
> 标签：php, math

我必须编写一个转换表作为一个项目。然而，他们给我们的一些数字是 4.014e+9 和 3.861e-7，还有一些包括 e+ 和 e-。如果我想将它乘以输入的数字，PHP 能识别常量 E 吗？

```
$result = "RESULT:" . $num * 4.014e+9; 
```

和

```
$result = "RESULT:" . $num * 3.861e-7; 
```

还是我需要其他东西才能识别它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T19:08:41.570

`e`不是常数；它是[科学记数法 float literal](http://en.wikipedia.org/wiki/Scientific_notation#E_notation)的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:20:49.053

我想到了; 我对常数 e 和科学记数法感到困惑。@nickb 告诉我 PHP 支持科学记数法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:13:20.897

如果它不起作用，您始终可以将函数[pow()](http://php.net/manual/en/function.pow.php)与 pow(10,$X); 一起使用。作为一种解决方法。但首先自己尝试代码，看看它是否有效。

# c++ - 变量类数组

> ID：11765859
> 
> 赞同：0
> 
> 时间：2012-08-01T19:07:04.177
> 
> 标签：c++

我有以下数据包布局：

```
struct PacketLayout
{
  int GateCode;
  BYTE StringLen;
  char String[StringLen];
  BYTE ServerStatus;
  BYTE ServerStorage;
  BYTE ServerNumber;
} 
```

课程是这样的：

```
class ServerInfo
{
  short PacketSize;   //Size of the whole packet
  BYTE TotalServers; //total of PacketLayout structs
  PacketLayout Server[TotalServers];
  int GlobalSecCode;
  short EncryptedPacketSize; //Same as the first member, just xored
} 
```

所以我遇到的问题是在类或结构中创建一个可变大小的数组，其大小取决于**BYTE StringLen**（对于结构）和**BYTE TotalServers**（对于类）指向的最后一个成员。

我不知道解决方案是什么，也许实现一个模板？，如果是这样我可以看到一个例子（我还不熟悉模板）而且我想引用我的成员名称而不自己计算指针位置（就像我现在正在做的那样）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:09:28.180

可以使用模板执行此操作，例如：

```
template <int StringSize>
struct PacketLayout
{
  int GateCode;
  BYTE StringLen;
  char String[StringSize];
  BYTE ServerStatus;
  BYTE ServerStorage;
  BYTE ServerNumber;
}; 
```

让您将其用作：

```
PacketLayout<100> pkt; 
```

通常，您想要做的事情会更简单。例如，如果您重新排序数据包并知道大小的上限，您可以简单地执行以下操作：

```
struct PacketLayout
{
  int GateCode;
  BYTE StringLen;
  BYTE ServerStatus;
  BYTE ServerStorage;
  BYTE ServerNumber;
  char String[MAX_POSSIBLE_SIZE];
}; 
```

或者：

```
struct PacketLayout
{
  int GateCode;
  BYTE StringLen;
  BYTE ServerStatus;
  BYTE ServerStorage;
  BYTE ServerNumber;
  char *String;
}; 
```

`String`并在读取期间分配/设置。

就个人而言，虽然我会跳过所有这些杂乱的低级细节，并使用[protobuf](https://code.google.com/p/protobuf/)之类的东西来为您完成工作，让您可以自由地专注于更重要的更高级别的事情，从而为您的项目增加价值。

有时也会使用一个常见但肮脏的技巧：

```
struct PacketLayout
{
  int GateCode;
  BYTE StringLen;
  BYTE ServerStatus;
  BYTE ServerStorage;
  BYTE ServerNumber;
  char String[1];
}; 
```

人们在末尾将变量部分的大小定义为 1，然后故意分配比结构所需的内存更多的内存，以便他们可以写到结构的末尾。这是邪恶的，但非常不推荐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:10:11.210

使用模板绝对是要走的路：

```
template <size_t TotalServers>
class ServerInfo 
{
    PacketLayout Server[TotalServers];
    int GlobalSecCode;
}; 
```

这样做的缺点是没有一个`ServerInfo`可分配给另一个，因此可能使用 a`std::vector`很重要，如果这对您来说意义重大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:22:44.013

C++ 中没有很好的方法来实现这一点。

这是在 PacketLayout 中创建可变大小数组的方法：

```
struct PacketLayout
{
  int GateCode;
  BYTE StringLen;
  BYTE ServerStatus;
  BYTE ServerStorage;
  BYTE ServerNumber;
  char String[1];
} 
```

然后你分配一个实例：

```
PacketLayout* createPacketLayout(BYTE stringLen)
{
    PacketLayout* packetLayout = (PacketLayout*)new char[sizeof(PacketLayout) - 1 + stringLen];
    packetLayout->StringLen = stringLen;
    return packetLayout;
} 
```

在这种情况下，ServerInfo 可以保存指针数组。

# svn - 重新集成分支时，PREV、BASE 或 COMMITTED 修订关键字对 URL 无效

> ID：11765866
> 
> 赞同：6
> 
> 时间：2012-08-01T19:07:24.143
> 
> 标签：svn, merge

我已经分支了我的主干（在以前的版本中）并实现/提交了一个新特性，并在本地实现了另一个特性的一部分到分支。我现在需要将完成的功能重新集成到后备箱中。

我`svn cp branches/completedfeature branches/uncompletedfeature`在自己的分支中获得部分完成的功能。然后我`svn revert -R .`在第一个分支中的所有内容都是最新的。

现在，当我`svn merge --reintegrate ../../branches/completedfeature`从后备箱中时，我得到了这个神秘的（对我而言）错误：

```
PREV, BASE, or COMMITTED revision keywords are invalid for URL while reintegrating a branch 
```

主干和已完成的功能分支都是最新的，没有本地更改。到底是怎么回事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-29T01:09:53.237

我有这个错误。

你的问题几乎是唯一的谷歌结果（[这里是关键字的描述](http://svn.uni-koblenz.de/svn-manual/#svn.tour.revs.keywords)）。

我有一个长分支，其他分支并入其中......补丁过程将是漫长而困难的。因此，尽管如此，[SVN redbood 的这一部分](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.basicmerging.html#svn.branchemerge.basicmerging.reintegrate)建议您应该合并两个工作副本，我乐观地尝试从 URL 重新集成并且它起作用了！

```
cd myLocalTrunk
svn merge --reintegrate https://svn.blah.blah/blah/blah/branches/myBranch
svn ci -m "reintegrating myBranch into trunk" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T15:34:07.983

看起来我的分支很差/错误。我还没有想出如何以正确的方式解决这个问题，对于处于这种情况的任何人来说，我如何将我的更改放入主干，以保留这个短暂分支的大部分历史：

查找所有更改的文件`diff -ur trunk branch`。确保查看差异，因为不在分支中的主干中的任何更改都将被还原，因此请忽略这些文件，或者如果两个树中的文件中有更改，请确保稍后手动编辑差异。

使用 svn 复制任何新文件以保留其历史记录`svn cp branch/path/file trunk/path/file`

现在您只需要更改未更改的文件。您不能进行两个源合并，因为（至少在 cygwin 中的 svn 1.7 中）它将删除然后添加文件，从而清除历史记录。我选择的选项是构建/应用补丁并提交有关发生的事情的消息。

有[很多](http://linux.byexamples.com/archives/163/how-to-create-patch-file-using-patch-and-diff/) [更好](http://kernelnewbies.org/FAQ/HowToApplyAPatch)的地方可以学习修补，但下面是我所做的。请记住，如果两个树中的文件都已更改，则需要手动修复合并问题。

使用 Do this for each file 构建您的补丁`diff -u trunk/path/file branch/path/file >> patch.patch` ，或者再次传入递归标志并让 diff 完成艰苦的工作。

进行试运行以确保补丁正常工作并修补正确的文件`patch -p0 --dry-run < patch.patch` 然后对其进行修补`patch -p0 < patch.patch`

然后确保项目构建并签入。

留下这个问题，希望有人知道真正的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-04T14:59:57.967

一般来说，这里不需要使用补丁文件——任何“-c x”或“-rx:y”范围实际上是一个变更集，即一种可以应用的补丁。让我们做一个完整的例子，所以最初

```
svn copy trunk/path/file branch/path/file 
```

然后可以在主干上工作。现在您需要知道修订范围以将更改应用到目标 - 因为修订号是全局的，您可以询问这两个文件，例如

```
svn info trunk/path/file 
# 35

svn info branch/path/file
# 27 
```

这是要使用的范围，现在你可以说

```
svn merge -r 27:35 trunk/path/file branch/path/file 
```

您可能会认为它是在内部为应用到目标的 27:35 范围创建补丁文件。只要这只是文件到文件，您甚至都不会发生树冲突（想想目录合并中重命名的文件）。

# c# - 验证 + 中继器 + 提示文本 - 验证问题

> ID：11765870
> 
> 赞同：0
> 
> 时间：2012-08-01T19:07:48.930
> 
> 标签：c#, jquery, asp.net

我有一个中继器，在中继器内部我有一个文本框和按钮（一起在 ASCX 中）。文本框预先填充了提示文本，该文本在焦点上被清除。

我的问题是，如果用户填写了一个文本框，并且用户单击了提交按钮，则提示文本将在其他控件中提交。

我尝试进行自定义验证，但验证器尝试验证中继器内的所有控件，并且其他控件仍然包含提示文本，如果它没有被触及的话。

由于这是 ASCX，因此我不想使用会迫使我更改托管控件的页面的 ItemDataBound 事件的代码的服务器端解决方案。

我仍然可以将任何客户端解决方案或服务器端解决方案封装在我的 ASCX 中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:23:50.070

如果您使用公共属性将数据从 ASCX 传递到父页面进行处理，您可以考虑那里的幻影文本......

```
public property TextValue
{
    get
    {
        if (Textbox.Text != "Ghost Text")
        {
            return Textbox.Text;
        }
    }
} 
```

对于客户端，您可以绑定到按钮的单击事件并清除文本，如果它与幻影文本值匹配...

```
$(function() {
    $('#btnSubmit').click(function() {
        var txt = $(this).siblings('txtValue');
        if (txt.val() == 'Please Enter Your Name')
           txt.val('');
    });
}) 
```

您可以使用 ScriptManager 从您的 ASCX 注册脚本。

# c# - 删除创建的临时文件

> ID：11765875
> 
> 赞同：0
> 
> 时间：2012-08-01T19:07:55.030
> 
> 标签：c#, .net, temporary-files

在 C# 或 Jscript.NET 中是否有必要（或更好地）删除在 System.IO.Path.GetTempPath() 返回的文件夹中创建的文件，或者等待系统删除它们（如果发生这种情况）是否可以接受？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:11:45.970

在我看来，你总是清理你创造的烂摊子。“临时”文件往往会停留很长时间，除非用户足够精通使用 CCleaner 等清理工具。

注意：这确实增加了必须记住您创建的所有临时文件以便清理它们的复杂性（和潜在的错误），但我认为这是值得的。Gravell 先生的[这个回答有一个简单的方法来解决这个问题。](https://stackoverflow.com/a/400391/237942)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:11:47.227

就您的程序将如何工作而言，它没有任何区别。

问题是文件夹中的许多文件使文件系统变得混乱 - 文件夹中的文件越多，读取它的速度就越慢。

如果不删除文件，也有可能耗尽磁盘空间。

一般来说，如果您的软件创建了临时文件，它应该自行清理（即，一旦文件不再使用，就将其删除）。

# c# - fluent nhibernate Cascade 创建新记录而不是更新它们

> ID：11765880
> 
> 赞同：2
> 
> 时间：2012-08-01T19:08:07.337
> 
> 标签：c#, model-view-controller, nhibernate, fluent-nhibernate

因此，对于 n-hibernate 和流利的 n-hibernate 而言，我对映射和级联更改子对象感到有些困惑。

我有一个包含多个集合的对象，当我创建一个新对象时，它会创建子对象并将它们插入各自的表中。这一切都很好。但是，当我用表面上子对象的更改来更新父对象时，它似乎按照我想要的方式流动。更重要的是，当查看数据库时，我看到它没有更新子对象记录，而是插入了新记录并从原始记录中删除了与父对象的关联，而不是仅仅更新它们。

为了添加额外的解释，我们使用 AutoMapping 和 MappingOverrides。所以这里是我正在使用的代码的简要介绍。

```
public class ParentObjectOverride : IAutoMappingOverride<ParentObject>
{
    public void Override(AutoMapping<ParentObject> mapping)
    {

        mapping.HasMany(x => x.Chid1).Cascade.SaveUpdate().Table("chid1Table");
        mapping.HasMany(x => x.Child2).Cascade.SaveUpdate().Table("child2Table");

    }
}
public class Child1Override : IAutoMappingOverride<Child1>
{
    public void Override(AutoMapping<Child1> mapping)
    {
        mapping.References(x => x.ParentObject).Cascade.All();
    }
}

public class Child2Override : IAutoMappingOverride<Child2>
{
    public void Override(AutoMapping<Child2> mapping)
    {
        mapping.References(x => x.ParentObject).Cascade.All();
    }
} 
```

确实没有子对象独立于 ParentObject 保存的情况。我试过 cascade.all() 和 cascade.saveupdate() 都产生相同的结果。

我已经阅读了几篇关于使用 AllDeleteOrphan 的文章，但我不明白为什么它不应该只更新子行而不是创建新行并删除旧行。也许我只是不明白映射概念。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-04T09:28:49.740

如果没有看到相关代码，我将不得不猜测，但这就是它的工作原理。

```
// Case 1
var parent = LoadParentAndChildrenFromDatabase();
parent.Child1 = new Child1();
parent.Child2 = GetChild2OjbectFromSomewhere();
SaveParentAndChildrenToDatabase();

// Case 2
var parent = LoadParentAndChildrenFromDatabase();
parent.Child1.SomeProperty = "new_value";
parent.Child2.AnotherProperty = 15;
SaveParentAndChildrenToDatabase(); 
```

在案例 1 中，您将**始终**插入新行，因为您的`Parent`对象实际上是在丢弃旧`Child`对象并用完全不同的对象替换它们。这就是您需要使用选项的原因——以便在插入新行时从数据库中删除`DeleteOrphan`旧的不再使用的行。`Child`

但是，案例 2 应该更新现有行，因为对象保持不变并且仅更新其属性。

我希望这回答了你的问题。

# sql - 这个实体关系能不能更规范

> ID：11765882
> 
> 赞同：0
> 
> 时间：2012-08-01T19:08:12.033
> 
> 标签：sql, entity-relationship, erd, class-table-inheritance

```
N Artists have M Folders.
1 Folder has N Sketches. 
```

**艺术家**

```
ArtistId (PK) 
```

**艺术家文件夹**

```
ArtistId (PK)(FK)
FolderId (PK)(FK) 
```

**文件夹**

```
FolderId (PK) 
```

**草图**

```
SketchId (PK)
FolderId (FK) 
```

我现在想要的是这样的：

1 位艺术家有 N 个草图。

我将不得不向表 Sketch 添加一个新字段：ArtistId

当我为文件夹插入草图时，此字段将始终为空/null。

你知道更好的设计吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:31:38.450

我不明白为什么会同时给 Sketches 一个 ArtistId 和一个 folderId 但我显然不知道你在创建什么。

在我看来，您有多种类型的草图。一些草图是由艺术家“创建”的，而另一些是由其他实体“创建”的。无论哪种方式，他们都会获得一个文件夹。所以如果你不喜欢空值，你可以做这样的事情。

**草图**

```
SketchId (PK)
FolderId (FK) 
```

然后：

**艺术家素描**

```
SketchId (FK)
ArtistId (FK) 
```

然后，您可以对 ArtistSketch 设置一个禁止重复草图的约束。

要获取给定艺术家的草图，您可以跨两个表进行连接以获得：

```
SketchId
ArtistId
FolderId 
```

否则，只需查询 Sketch 表。

这将是类表继承的一个示例：[http ://martinfowler.com/eaaCatalog/classTableInheritance.html](http://martinfowler.com/eaaCatalog/classTableInheritance.html)

Doctrine 是一个 PHP 的 ORM 库，对此有一个有趣的看法，可与 MySQL 一起使用，以减少在许多设置下使其正常工作所需的大量繁重工作（代码方面）。 [http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html)

# c# - 在 ASP.NET MVC 中，通过 ajax 提交表单时如何返回不同的视图？

> ID：11765883
> 
> 赞同：0
> 
> 时间：2012-08-01T19:08:14.530
> 
> 标签：c#, ajax, asp.net-mvc, razor, asp.net-mvc-partialview

我正在尝试在 ASP.NET MVC 中创建一个留言板。我有两个部分视图，一个显示消息（这是递归的，并且还将显示所有子...消息），一个显示提交新消息的表单。当一条消息被发布时，我希望表单通过 ajax 提交，并返回部分视图以显示一条消息（刚刚发布的消息）。

这是显示表单的部分视图 (NewMessage)

```
@model Intranet.Entities.ForumRepository.Message

<div id="@Html.Raw("formbox" + Model.ParentID)">

@using (Ajax.BeginForm("NewMessage", new AjaxOptions { UpdateTargetId = "formbox" + Model.ParentID })) {    
    @Html.TextAreaFor(m => m.Text, new { @class = "responsebox" })
    @Html.HiddenFor(m => m.ParentID)
    <br /><input type="submit" value="Save Comment" class="savebutton" />
}

</div> 
```

及其提交方法

```
[HttpPost]
public ActionResult NewMessage(ForumRepository.Message message) {
    if (ModelState.IsValid) {

        RouteData.Values.Add("Responses", message);
        //message.SaveMessage();

        return PartialView("DisplayMessage", message);
    } else {
        return PartialView(message);
    }

} 
```

当我尝试提交表单时，表单视图不会被 DisplayMessage 视图替换。它一直显示表格。在调试模式下运行表明正在调用后端代码。

我相当确定这与 ajax 代码用于重新显示的 div 位于 NewMessage 视图内（它不能替换自己的容器）这一事实有关，但我不知道如何设置它这样它就可以工作了。

* * *

根据要求，这是一些呈现的 HTML

```
<div id="formbox0">

<form action="/EventList/NewMessage/Q6UJ9A00T49L" data-ajax="true" data-ajax-mode="replace" data-ajax-update="#formbox0" id="form0" method="post"><textarea class="responsebox" cols="20" data-val="true" data-val-required="The Text field is required." id="Text" name="Text" rows="2">
</textarea><input data-val="true" data-val-number="The field ParentID must be a number." data-val-required="The ParentID field is required." id="ParentID" name="ParentID" type="hidden" value="0" />    <br /><input type="submit" value="Save Comment" class="savebutton" />
</form>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:37:53.983

我更喜欢避免使用 AjaxBeginForm 方法，并且喜欢编写手写和**干净**的jQuery 代码。

我为容器 div 提供了一个 css 类（commentItem），以便稍后我可以在我的 jQuery 选择器中使用它。

```
@model Intranet.Entities.ForumRepository.Message

<h3> Enter your comment</h3>
<div id="formbox@Model.ParentID" class="commentItem">   
  @using(Html.BeginForm())
  {
     @Html.TextAreaFor(m => m.Text, new { @class = "responsebox" })
     @Html.HiddenFor(m => m.ParentID)
     <input type="submit" value="Save Comment" class="savebutton" />
  }     
</div>
<script type="text/javascript">
  $(function(){
    $(".savebutton").click(function(e){
       var item=$(this);
       e.preventDefault();

       $.post("@Url.Action("NewMessage","EventList")",
                         item.closest("form").serialize(),function(data){

                   item.closest("div.commentItem").html(data);

       });

    });

  });

</script> 
```

此代码将使用从您的 Action 方法接收到的内容替换现有表单（或容器 div 内的任何内容）。

# ruby - 对捆绑者小组的工作方式感到困惑

> ID：11765886
> 
> 赞同：0
> 
> 时间：2012-08-01T19:08:25.013
> 
> 标签：ruby, bundler

我正在使用 ruby​​ 1.9.3p194 和 bundler 1.1.4

在我的 Gemfile 我有这个：

```
group :production do
   gem 'thin', '1.4.1'
end 
```

当我运行 $ rails 时，bundler 不断抱怨：

```
Could not find gem 'thin (>= 1.4.1) ruby' in the gems available on this machine.
Run `bundle install` to install missing gems. 
```

我在开发环境下运行，所以它不应该不在乎它是否安装吗？在运行 $ rails s 时，剂量捆绑器会强制您安装所有 gem？

我也尝试了 group:test，同样的事情发生了。这对我来说真的没有意义，有人可以帮忙吗？

## 我的宝石文件：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'
gem 'mysql2'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

group :production do
  gem 'thin', '1.4.1'
end

gem 'devise', '2.1.2'
gem 'cancan', '1.6.8'
gem 'will_paginate', '3.0.3' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T05:32:24.347

可能问题是您正在运行`rails s`，而您需要运行`bundle exec rails s`。如果您在命令前面加上`bundle exec`，它将在包的上下文中执行。然后，捆绑程序可以使用的所有 gem 都可以用于命令。

默认情况下，捆绑包中的 gem 安装在全局 gem 目录中。当您不预先`bundle exec`添加命令时，这可能会产生令人困惑的结果：假设您在全局 gem 中同时拥有 rails 3.1 和 rails 3.2 并且您的 Gemfile 提到了 3.1。然后，当您简单地`rails`在命令行上说时，您仍然会从 rails 3.2 调用可执行文件。

当然`thin`，如果它没有与全局 gem 一起安装，那么它当然会丢失。假设您`--path`至少使用了一次打包选项，您的 gem 已安装到那里指定的路径，而不是全局存储库。使用后`--path`，*必须*指定`bundle exec`，否则根本找不到 gem。

# facebook - CakePHP + Facebook meta ta 无法正确呈现

> ID：11765887
> 
> 赞同：0
> 
> 时间：2012-08-01T19:08:26.920
> 
> 标签：facebook, cakephp-2.0, meta-tags

我的应用程序正在使用数据库记录的信息动态呈现 Facebook meta(og:title, og:title)。

当我从浏览器单击查看源代码时，我看到记录已正确呈现。但是，当我使用 Facebook 调试器 (https://developers.facebook.com/tools/debug) 查看完全相同的页面时，元标记的值为空，这意味着它不会从我的数据库中读取。

以前有人遇到过类似的问题，似乎应用程序速度不够快，无法呈现数据库记录？

**代码** 这是布局文件中的内容：

```
<?php 
// for Facebook
if(!isset($meta_title)) {
    $meta_title = 'Default title';
}
if(!isset($meta_location)) {
    $meta_location = FULL_BASE_URL.$this->here;
}
if(!isset($meta_image)) {
    $meta_image = FULL_BASE_URL.$this->webroot.'img/facebook-icon.gif';
}
if(!isset($meta_type)) {
    $meta_type = 'article';
}
if(!isset($meta_des)){
    $meta_des = 'Default title';
}   
?>

<meta property="og:site_name" content="<?php echo __('SgVoucher'); ?>"/>
<meta property="og:type" content="<?php echo $meta_type; ?>"/>
<meta property="og:title" content="<?php echo $meta_title; ?>"/>   
<meta property="og:url" content="<?php echo $meta_location; ?>"/>
<meta property="og:image" content="<?php echo $meta_image; ?>"/>
<meta property="og:description" content="<?php echo $meta_des; ?>"/> 
```

在控制器中，我重试了数据库记录以给出动态标题。

```
//in the controller
$dynamic = $this->Model->find('first'....);
$this->set('meta_title',$dynamic['Table']['field'] 
```

但它永远不会从数据库中显示正确的，它总是从 Facebook 调试器显示“默认标题”，但是当您单击查看源时它是正确的。

**链接**如果它有助于调试， 该链接位于[http://www.sgvoucher.com/deals/view/free_ipad_with_wi-fi_16gb_3rd_generation_giveaway 。](http://www.sgvoucher.com/deals/view/free_ipad_with_wi-fi_16gb_3rd_generation_giveaway)

# javascript - 有没有办法根据内容的大小（可能会有所不同）扩展 div？

> ID：11765896
> 
> 赞同：0
> 
> 时间：2012-08-01T19:08:59.083
> 
> 标签：javascript, css

我在我们的 SharePoint 网站上创建了一个员工聚光灯 Web 部件，它在每个页面加载时随机选择一名员工。在聚光灯部分是从用户信息列表的“关于我”部分中提取的员工的简历。我正在尝试使其生物可扩展，以便最初可以看到生物的几行，然后用户可以单击“更多”链接以展开文本以阅读其余部分。我有什么作品，但我让它跳到一个固定的高度，我希望它只扩展到文本的数量`<div>`

div部分：

```
<div id=\"expandable\" >" + Employees[randId].aboutMe +
                "</div><a href=\"javascript:Tog()\">more...</a> 
```

样式：

```
#expandable { height:55px; overflow:hidden; } 
```

一个简单的扩展脚本：

```
function Tog() {
    var expandable = document.getElementById('expandable');
    if (expandable.style.height == '400px') {
        expandable.style.height = '55px';
    }
    else {
        expandable.style.height = '400px';
    } 
} 
```

有没有更好的方法来扩展内容，同时在折叠时仍然显示一些文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:22:52.293

不要设置高度以便显示整个内容，而是删除具有最大高度/溢出集的类。

**HTML**

```
<div id="content" class="collapsed">
    <p>1</p>
    <p>2</p>
    <p>3</p>
    <p>4</p>
    <p>5</p>
    <p>6</p>
    <p>7</p>
    <p>8</p>
    <p>9</p>
    <p>10</p>
</div> 
```

**CSS**

```
div#content{ border: 1px solid black; cursor: pointer;}

div.collapsed{
     max-height: 40px;
    overflow:hidden;
} 
```

**JavaScript**

```
var cont = document.getElementById("content");
cont.onclick = function() {
    var newClass = (cont.className==="collapsed") ? "" : "collapsed";
    cont.className = newClass;        
}; 
```

JavaScript 是一个基本示例，最好使用添加/删除类库，这样您就可以拥有多个类。

**例子**

[JSFiddle](http://jsfiddle.net/KJTes/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T19:23:46.210

无需将高度设置为固定值，只需将其设置为`auto`，div 将扩展以适应内容：

```
function Tog() {
    var expandable = document.getElementById('expandable');
    if (expandable.style.height) {
        expandable.style.height = '';
    } else {
        expandable.style.height = 'auto';
    } 
} 
```

（[在 jsfiddle.net 上的演示](http://jsfiddle.net/K7JAd/)）。

**更新**：还可以考虑将您的内联 JS ( `href="javascript:Tog()"`) 替换为适当的事件侦听器，正如[Bergi 所建议的那样](http://jsfiddle.net/TbdgL/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:22:36.877

这是我在评论中所说的一个[工作示例。](http://jsbin.com/okicil/1/)默认情况下，div 占用其内容所需的任何空间。您可以通过将`short`类添加到元素来将其限制为您的尺寸。切换功能只是添加和删除此类。

HTML

```
<div id="expandable" class="short">Content here</div>
<a href="#" onclick="toggle()">more...</a> 
```

CSS

```
.short {
  height: 200px;
  overflow: hidden;
} 
```

JS

```
function toggle() {
  var elem = document.getElementById("expandable");

  if(hasClass(elem, "short"))
    removeClass(elem, "short");
  else
    elem.className = elem.className + " short";
}

//These functions from http://stackoverflow.com/a/2155755/219118
function hasClass(ele,cls) {
    return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
} 
```

# android - 如何动画滑动抽屉？

> ID：11765897
> 
> 赞同：0
> 
> 时间：2012-08-01T19:09:04.030
> 
> 标签：android, slidingdrawer

![我的活动](../Images/2aeafdd43b934c49246288b23795ee39.png)

当我按下按钮开始时，我需要得到这个：

：![在此处输入图像描述](../Images/d79dec08713ce0cbb9c2a174fb341474.png)

所以，我有滑动抽屉，我需要通过单击开始按钮来制作动画。如您所见，滑动抽屉的上下文包含搜索栏和 3 个按钮。当用户单击开始按钮动画应该开始应该隐藏按钮。

我的 xml 文件如下所示：

```
<SlidingDrawer
    android:id="@+id/slidingDrawer1"
    android:layout_width="match_parent"
    android:layout_height="140dp"
    android:layout_alignParentBottom="true"
    android:layout_x="3dp"
    android:layout_y="374dp"
    android:content="@+id/content"
    android:handle="@+id/handle" >

    <Button
        android:id="@+id/handle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Handle" />

    <RelativeLayout
        android:id="@+id/content"
        android:layout_width="match_parent"
        android:layout_height="84dp" >

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="wrap_content"
            android:layout_height="47dp"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:background="@drawable/bcg9" >

            <Button
                android:id="@+id/button1"
                android:layout_width="106.6dp"
                android:layout_height="match_parent"
                android:layout_alignParentBottom="true"
                android:layout_alignParentLeft="true"
                android:layout_marginTop="0dp"
                android:background="@drawable/rev" />

            <Button
                android:id="@+id/button2"
                android:layout_width="106.6dp"
                android:layout_height="match_parent"
                android:layout_marginTop="0dp"
                android:background="@drawable/pause" />

            <Button
                android:id="@+id/button3"
                android:layout_width="106.6dp"
                android:layout_height="match_parent"
                android:layout_alignParentBottom="true"
                android:layout_marginTop="0dp"
                android:layout_toRightOf="@+id/button2"
                android:layout_weight="1"
                android:background="@drawable/forv" />
        </LinearLayout>

        <SeekBar
            android:id="@+id/seekBar1"
            android:layout_width="match_parent"
            android:layout_height="11dp"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"
            android:background="@null"
            android:progressDrawable="@drawable/seekbar_progress"
            android:thumb="@drawable/thumb_drawable" />
    </RelativeLayout>
</SlidingDrawer>

<SeekBar
    android:id="@+id/seekBar2"
    android:layout_width="match_parent"
    android:layout_height="15px"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginTop="62dp"
    android:maxHeight="3dp"
    android:progressDrawable="@drawable/seekbar_progress"
    android:thumb="@drawable/thumb_drawable" />

<Button
    android:id="@+id/animate"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:text="start" />

</RelativeLayout> 
```

我尝试使用翻译动画，但是当我单击开始按钮滑动抽屉下降时，它实际上消失了。

```
int topOfsd = getWindowManager().getDefaultDisplay().getHeight()-sd.getHeight();
                Animation animation = new TranslateAnimation(0,            0,topOfsd,topOfsd-100);
                animation.setDuration(1000);
                animation.setFillAfter(true);
                sd.startAnimation(animation);
                sd.setVisibility(0); 
```

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:13:00.210

如果您使用 findViewById 获得 SlidingDrawer 的句柄，您可以调用 animateOpen 和 animateClose 函数。 [http://developer.android.com/reference/android/widget/SlidingDrawer.html#animateOpen](http://developer.android.com/reference/android/widget/SlidingDrawer.html#animateOpen) ()

如果您不希望滑动抽屉一直打开，只需将高度设置为倾斜即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T09:37:03.770

我设法用属性动画解决了这个问题。

```
Display display = getWindowManager().getDefaultDisplay(); 
        int y = display.getHeight();
android.widget.SlidingDrawer  sd;
sd = (android.widget.SlidingDrawer)findViewById(R.id.slidingDrawer1);
sd.animate().translationY(someValue); 
```

# asp.net - 可能在 html 中读取 webconfig AppSetting？

> ID：11765898
> 
> 赞同：3
> 
> 时间：2012-08-01T19:09:10.833
> 
> 标签：asp.net, html, web-config

我想从我的 webconfig 中的常规 .htm 文件中获取 AppSetting 密钥 - 这可能吗？

通常 id 把它变成一个 aspx 文件，这样我就可以做一些类似的代码隐藏，但是 htm 是在野外，我不认为我可以改变 url

*网络配置*

```
<add key="SomeLocation" value="http://my.ip.address/"/> 
```

*Htm 标记*

```
<a href="<%=MyCodeBehind()%>">Contact Us</a> 
```

*VB.Net 代码隐藏*

```
 Public ReadOnly Property MyCodeBehind() As String
    Get
        Return General.GetAppSetting("SomeLocation")
    End Get
End Property 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:13:40.787

*不是通过任何服务器端处理生成的文件本身*不可能包含任何附加数据。

您确实有几个选择（如果我正确理解您的问题）：

*   您可以重新配置服务器以将“.htm”作为 ASPX 页面处理并在后面使用您的代码。
*   [您可以使用重写规则](http://msdn.microsoft.com/en-us/library/ms972974.aspx)将特定 URL 从 Web 服务器重定向到 ASPX 页面

# batch-file - 命令的语法不正确 TYPE 命令

> ID：11765901
> 
> 赞同：2
> 
> 时间：2012-08-01T19:09:25.403
> 
> 标签：batch-file, cmd

我正在尝试运行失败的脚本。我已将问题隔离为一个简单的 TYPE 命令。这是代码

```
IF NOT [%1]==[] ECHO Appending this log to %1
IF NOT [%1]==[] TYPE C:\test.log >> %1 
```

如您所见，我要做的就是将日志文件复制到指定位置（如果已指定）。如果没有指定额外的日志文件，该脚本也应该运行。

我无法弄清楚，因为它看起来正确并且我尝试了不同的东西。如果传入参数，脚本运行良好。

编辑：我尝试回显该行，它看起来像 IF NOT [] == [] TYPE C:\test.log 1>>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:45:53.393

当 %1 为空时，脚本将失败，因为整个 IF 语句必须具有有效的语法，即使 IF 计算结果为 false 以使主体不会被执行。

您可以通过重定向到`"%~1"`而不是`%1`. `~`需要删除值中可能已经存在的任何封闭引号。重定向到`""`是有效的语法。它会因运行时错误而失败，但不会出现语法错误。但是如果 %1 为空，它不会被执行，所以没关系。

我也会`"%~1"`在 IF 条件下使用，而不是`[%1]`: 它更健壮一些。

我还会重组代码以使用单个 IF，但这更多的是风格问题。

```
if not "%~1"=="" (
  echo Appending this log to %1
  type c:\test.log >>"%~1"
) 
```

# ruby-on-rails - Ruby-On-Rails：查找具有特定数组值的数据库条目

> ID：11765906
> 
> 赞同：0
> 
> 时间：2012-08-01T19:09:43.670
> 
> 标签：ruby-on-rails, find

我有一个模型 TestRun，它有一个数组条目`:machine_ids`，它是一个整数数组。我将如何使用条件调用 find 以便我可以找到其字段`:machine_ids`具有特定数组条目`mid`和`:status`“正在运行”的特定 TestRun 条目。

这是我想要的大致轮廓。我不知道如何格式化查找数组是否包含`mid`.

```
cur_testrun = TestRun.find(:first, :conditions => {:machine_ids => mid, :status => "Running"}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:42:52.153

该数组将序列化为 YAML 以存储在您的数据库中。序列化数据不适合简单或高效的查询。

正如下面的问题和答案中所建议的，您可以尝试对架构进行一些规范化。或者，如果您的匹配变得复杂，您将留下 SQL 'like' 查询，编写起来不会很有趣。

[Rails 活动记录查询，序列化数组](https://stackoverflow.com/questions/9962923/rails-active-record-query-serialized-array)

# codeigniter - CodeIgniter 的 Netbeans 代码完成

> ID：11765908
> 
> 赞同：17
> 
> 时间：2012-08-01T19:09:57.627
> 
> 标签：codeigniter, netbeans-7

我正在使用 Netbeans IDE 进行 PHP 开发。它为我提供了 Kohana 框架的代码完成功能。有没有办法在 Netbeans 中为 CodeIgniter 完成代码？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-01T19:14:07.710

[说明](http://codeigniter.com/forums/viewthread/187949/)：

在 nbproject 中创建一个新目录（我使用了这个，因为在推送到 prod 时它被省略了），使用你选择的名称，我使用`CI_Autocomplete`.

使用您选择的名称创建一个新文件，我使用`CI_Autocomplete_2.0.php`了 ，并将其放在新创建的文件夹中，`nbproject\CI_Autocomplete`.

将以下代码粘贴到新文件中，`CI_Autocomplete_2.0.php`.

```
<?php
    /**
    * @property CI_DB_active_record $db
    * @property CI_DB_forge $dbforge
    * @property CI_Benchmark $benchmark
    * @property CI_Calendar $calendar
    * @property CI_Cart $cart
    * @property CI_Config $config
    * @property CI_Controller $controller
    * @property CI_Email $email
    * @property CI_Encrypt $encrypt
    * @property CI_Exceptions $exceptions
    * @property CI_Form_validation $form_validation
    * @property CI_Ftp $ftp
    * @property CI_Hooks $hooks
    * @property CI_Image_lib $image_lib
    * @property CI_Input $input
    * @property CI_Language $language
    * @property CI_Loader $load
    * @property CI_Log $log
    * @property CI_Model $model
    * @property CI_Output $output
    * @property CI_Pagination $pagination
    * @property CI_Parser $parser
    * @property CI_Profiler $profiler
    * @property CI_Router $router
    * @property CI_Session $session
    * @property CI_Sha1 $sha1
    * @property CI_Table $table
    * @property CI_Trackback $trackback
    * @property CI_Typography $typography
    * @property CI_Unit_test $unit_test
    * @property CI_Upload $upload
    * @property CI_URI $uri
    * @property CI_User_agent $user_agent
    * @property CI_Validation $validation
    * @property CI_Xmlrpc $xmlrpc
    * @property CI_Xmlrpcs $xmlrpcs
    * @property CI_Zip $zip
    */

    class CI_Controller {};

    /**
    * @property CI_DB_active_record $db
    * @property CI_DB_forge $dbforge
    * @property CI_Config $config
    * @property CI_Loader $load
    * @property CI_Session $session
    */

    class CI_Model {};
?> 
```

现在转到（这是针对 OSX，所以不确定它是否与 Windows 相同）`File > Project Properties (projectname) > PHP Include Path`并包含您在上面创建的新文件夹，`nbproject\CI_Autocomplete`.

重新启动您的项目，自动完成功能将起作用。

# visual-studio-2010 - 我无法在 64 位窗口中构建 VSTO 解决方案

> ID：11765909
> 
> 赞同：1
> 
> 时间：2012-08-01T19:09:58.573
> 
> 标签：visual-studio-2010, x86, vsto, 64-bit, anycpu

我正在为 PowerPoint 2010 开发加载项。

如果我尝试使用平台目标构建它，`Any CPU`或者`x64`我得到`HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)`

我的解决方案使用 SDK 及其库之一中提供的硬件 dll。我已经用 regsvr32 注册了它。

我以前遇到过类似的问题，总是用 regsvr32 解决，但现在它不起作用。

我可以避免在 x86 中构建这个问题，但是当我尝试在 x86 中运行调试或发布构建时，我得到给定的程序集名称或代码库无效。`HRESULT: 0x80131047`

我不知道该怎么办。

谢谢

# php - 无法将数据写入数据库

> ID：11765910
> 
> 赞同：1
> 
> 时间：2012-08-01T19:10:02.490
> 
> 标签：php, mysql

我写了以下脚本。我的意图是做以下两件事：

1.  让用户看到 的当前值`$score`。
2.  让用户`$score`通过按“分数！”来增加 1。按钮。

的值`$score`存储在数据库中。

只有一个问题——当我点击“得分！” 按钮， 的值`$score`不会增加一 - 它会重置为零，无论原始值是多少。

```
<?php
    $page_title = "";
    ?>
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title><?php print($page_title) ?></title>
    </head>
    <body>

    <?php // Script number 1.2, filename show_score.php

    // error handling
    ini_set('display errors',1);  // Let me learn from my mistakes!
    error_reporting(E_ALL|E_STRICT); // Show all possible problems! 

    // Set page title. 
    $page_title = "Game Score";

    // Connect to the database:
    $link = mysql_connect('localhost','username','password');
    mysql_select_db('game_scores',$link);

    // Create database query that gets the value of the score_counter cell
    $sql = 'SELECT score_counter FROM scores';
    $result = mysql_query($sql,$link);

    // Create a variable, $score_counter, that holds the array that 
    //is the result of the previous SQL query

    $score_counter = mysql_fetch_array($result);

    // You don't really want the whole array, just score_counter[0],
    // so assign score_counter[0] its own variable, $score

    $scores = $score_counter[0];

    // Now that you've retrieved the current number of scores from the 
    // database, and extracted that number from an array and 
    // put it in its own variable, print it out on the screen.

    echo 'The current number of scores is ' . $scores . ' scores.';

    // Now let users add to the number of scores by clicking the "score" button. 

    if(isset($_POST['score'])){

        // increment the number of scores:
        $scores++;

        // create the SQL query:
        $query='UPDATE scores SET score_counter="$scores" WHERE score_id=1';

        // run the SQL query:
        mysql_query($query) or die("Cannot update");
        }

    ?>

    <H1>Score Counter</H1>

    <p>Click to add one point.</p>

    <form action ="show_score.php" method ="post">
    <input type ="submit" name ="score" value="score">
    </form>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T19:12:05.687

因为您的查询是在单引号中，这使您的变量`$scores`成为文字单词 $scores。结果，您的数字数据类型（prob int）将其转换为零。

将您的查询更改为：

```
$query='UPDATE scores SET score_counter="'.$scores.'" WHERE score_id=1'; 
```

我使用连接来确保`$scores`在查询中使用的值而不是文字 $scores。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:13:07.480

要在 PHP 字符串中使用变量插值，您需要使用双引号：

```
$query="UPDATE scores SET score_counter=$scores WHERE score_id=1"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:13:46.883

代替

```
$query='UPDATE scores SET score_counter="$scores" WHERE score_id=1'; 
```

和

```
$query='UPDATE scores SET score_counter="' .$scores. '" WHERE score_id=1'; 
```

它以 $score 作为单词，在 DB 中不存在

# java - JSF ViewScoped 变量无法重定向到同一页面

> ID：11765913
> 
> 赞同：4
> 
> 时间：2012-08-01T19:10:16.327
> 
> 标签：java, jsf, jsf-2, primefaces

使用下面的代码，我使用 selectOneRadio 上的侦听器重定向到带有 url 中的查询字符串的页面。

问题是，当我被重定向时，`newsTitle`和的值为`selectedNews`空。为什么是这样？是因为我正在使用 FacesContext 进行重定向吗？

新闻.xhtml

```
<h:outputLabel for="title" value="Title" style="font-weight: bold;"/>
<p:inputText id="title" required="true" value="#{contentEditorBacking.newsTitle}" >
    <p:ajax event="blur"/>
</p:inputText>
<h:outputLabel value="Site" style="font-weight: bold;" />
<p:selectOneRadio value="#{contentEditorBacking.selectedNews}" layout="pageDirection">
    <f:selectItem itemLabel="Public" itemValue="Public" />
    <f:selectItem itemLabel="Member" itemValue="Member" />
    <p:ajax event="change" listener="#{contentEditorBacking.addNewsArticle}" update="path"/>
</p:selectOneRadio> 
```

contentEditorBacking.java

```
@ManagedBean
@ViewScoped
public class ContentEditorBacking {
  private String newsTitle = null;
  private String selectedNews = null;

  public String getNewsTitle() {
    return newsTitle;
  }

  public void setNewsTitle(String newsTitle) {
    this.newsTitle = newsTitle;
  }

  public String getSelectedNews() {
    return selectedNews;
  }

  public void setSelectedNews(String selectedNews) {
    this.selectedNews = selectedNews;
  }

  public void addNewsArticle() throws Exception {

    String year = String.valueOf(Calendar.getInstance().get(Calendar.YEAR)).length() < 2 ? "0"+Calendar.getInstance().get(Calendar.YEAR) : String.valueOf(Calendar.getInstance().get(Calendar.YEAR));
    String month = String.valueOf(Calendar.getInstance().get(Calendar.MONTH)).length() < 2 ? "0"+(Calendar.getInstance().get(Calendar.MONTH)+1) : String.valueOf(Calendar.getInstance().get(Calendar.MONTH));
    String day = String.valueOf(Calendar.getInstance().get(Calendar.DAY_OF_MONTH)).length() < 2 ? "0"+Calendar.getInstance().get(Calendar.DAY_OF_MONTH) : String.valueOf(Calendar.getInstance().get(Calendar.DAY_OF_MONTH));
    String newsPath = null;

    newsPath = "/" + selectedNews + "/News/" + year + "/" + month + "/" + day + "/" + newsTitle;

    FacesContext.getCurrentInstance().getExternalContext().redirect("news.xhtml?path="+ newsPath);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T19:15:39.813

重定向基本上指示网络浏览器创建一个新的 GET 请求。这将创建一个新视图，因此也将创建一个关联视图范围 bean 的新实例。只要您返回`null`或`void`（ajax）回发，视图范围的bean通常就会存在（视图范围即由隐藏的请求参数标识/跟踪`javax.faces.ViewState`）。这就是它指定的工作方式。

使用`<f:viewParam>`/`<f:event type="preRenderView">`对新的 GET 请求执行初始化工作。如有必要，您可以将命令链接设置为普通的 GET 链接，以便对 SEO 更友好（搜索机器人根本不索引 POST 表单）。

### 也可以看看：

*   [如何选择合适的bean范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)
*   [<f:metadata>、<f:viewParam> 和 <f:viewAction> 可以用来做什么？](https://stackoverflow.com/questions/6377798/what-can-fmetadata-and-fviewparam-be-used-for)
*   [ViewParam 与 @ManagedProperty(value = "#{param.id}")](https://stackoverflow.com/questions/4888942/viewparam-vs-managedpropertyvalue-param-id)
*   [什么时候应该使用 h:outputLink 而不是 h:commandLink？](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink)

# c# - 将对象的状态保存到历史列表并恢复它的最佳实践是什么？

> ID：11765915
> 
> 赞同：1
> 
> 时间：2012-08-01T19:10:29.147
> 
> 标签：c#, design-patterns, history, snapshot, value-objects

我有以下情况：

我正在设计一个 MVVM 应用程序，它通过串行端口或其他东西与一些计算机外部设备进行通信。每个`Device`都有一些属性，例如 id、名称等，并且还由`Module`具有自己属性的不同 's 组成。我有一种 xml 数据库来保存和加载设备。每个`Device`都有自己的文件。反正：

该应用程序通过一种存储库加载所有文件，并提供一个列表`Devices`以选择实际连接的文件或创建新文件。当我选择 current`Device`时，我会得到一个页面，该页面表示`Modules`基于设备类型的列表。IE：

`Device_Type_A`包括`Module_A`和`Module_B`

`Device_Type_B`包括`Module_A`和`Module_C`

...

的属性`Modules`通过通信填充。现在我想将`Modules`一种模块状态历史的状态保存到当前设备的 xml 文件中。

这样做的最佳做法是什么？`ModuleSnapshot`基于[Fowlers Snapshot](http://martinfowler.com/eaaDev/Snapshot.html)创建一个类并存储它有用吗？还是我必须做一种不可变的值对象并将其存储到文件中？

设备是实体，但模块历史条目感觉像值对象。我也想显示加载的设备文件的历史记录。是否需要一个`Module`类作为通信东西的模型和一个类作为它的不可变值对象副本，比如`ModuleHistory`?

像这样的东西？

```
public class Device_Type_A : DeviceBase
{
    // Some special Type_A properties ...
    public string Type_A_Shape{get; set;}
    // ...       
}

public class DeviceBase
{
    public string Id  { get; private set; }
    public string DeviceName { get; private set; }
    public List<ModuleHistory> History { get; private set; }
    // ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T05:18:43.373

保存对象的状态以备将来使用............备忘录模式

# homebrew - 山狮升级后 curl 的 SSL 证书消失

> ID：11765916
> 
> 赞同：2
> 
> 时间：2012-08-01T19:10:35.767
> 
> 标签：homebrew, osx-mountain-lion

我最近升级到 OS X Mountain Lion，运行时`curl-config --ca`出现空行。卷曲的相关资料：

```
curl 7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
Protocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtsp smtp     smtps telnet tftp 
Features: AsynchDNS GSS-Negotiate IPv6 Largefile NTLM NTLM_WB SSL libz 
```

问题是除非我更新证书，否则我无法运行`brew update`，因为我收到以下错误：

```
Initialized empty Git repository in /usr/local/.git/
error: SSL certificate problem, verify that the CA cert is OK. Details:
error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed while accessing https://github.com/mxcl/homebrew.git/info/refs
fatal: HTTP request failed
Error: Failure while executing: git fetch origin 
```

自制帮助论坛说我需要更新证书。但是，除非我能找到 curl 存储证书的位置，否则我无法更新它。

**编辑：** HeatfanJohn 提出的解决方案如下：

> 我刚刚注意到 curl-ca-bundle 有一个 Macport。很抱歉这个可能很简单的问题，但是您是安装 curl 还是预装了它？您可能需要考虑安装 MacPorts，然后使用 MacPorts 安装 curl-ca-bundle，尽管快速查看该 MacPort 的 Portfile 似乎只是将捆绑包放入 /usr/share 中，您也可以手动执行此操作。

从 MacPorts 安装的命令是`port install curl`. 从 MacPorts 安装可解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:37:11.833

我主要`curl`在 Winodws 上运行，但从 curl 文档中，以下内容应该可以工作：

> 如果您使用 curl 命令行工具，您可以通过将环境变量 CURL_CA_BUNDLE 设置为您选择的路径来指定您自己的 CA 证书路径。

[然后从http://curl.haxx.se/ca/cacert.pem](http://curl.haxx.se/ca/cacert.pem)下载最新`.pem`文件，并将其放在您在环境变量中指定的目录路径中。文档对于环境变量是指向文件还是目录有点含糊。我会尝试将其指向文件。`.pem``CURL_CA_BUNDLE`

在 Windows 上，在可执行文件所在的同一目录中`curl`查找`.pem`文件作为文件。这也可能奏效。我家里有一台旧的 MAC。我将在今晚晚些时候对此进行测试。`curl-ca-bundle.crt``curl`

`curl-config --ca`为我返回`/usr/share/curl/curl-ca-bundle.crt`。

我刚刚注意到[curl-ca-bundle](https://trac.macports.org/browser/trunk/dports/net/curl-ca-bundle/Portfile)有一个 Macport 。很抱歉这个可能很简单的问题，但是您是安装 curl 还是预装了它？您可能需要考虑安装[MacPorts](https://developer.apple.com/library/mac/#featuredarticles/UsingMacPorts/_index.html)，然后使用 MacPorts 安装 curl-ca-bundle，尽管快速查看该[MacPort](https://trac.macports.org/browser/trunk/dports/net/curl-ca-bundle/Portfile)的Portfile 似乎只是将捆绑包放入 /usr/share 中，您也可以手动执行此操作。

我`curl`从 Macports 安装，现在我安装了 7.27.0 版本，它被配置为使用最新的 curl-ca-bundle.crt 文件。见下文：

```
sams-mac:~ sam$ curl --version
curl 7.27.0 (powerpc-apple-darwin8.11.0) libcurl/7.27.0 OpenSSL/1.0.1c zlib/1.2.7 libidn/1.25
Protocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s rtsp smtp smtps telnet tftp 
Features: IDN IPv6 Largefile NTLM NTLM_WB SSL libz TLS-SRP

sams-mac:~ sam$ curl-config --ca
/opt/local/share/curl/curl-ca-bundle.crt

sams-mac:~ sam$ ls -l /opt/local/bin/curl*
-rwxr-xr-x   1 root  admin  147012 Aug  3 11:00 /opt/local/bin/curl
-rwxr-xr-x   1 root  admin    4988 Aug  3 11:00 /opt/local/bin/curl-config
sams-mac:~ sam$ 
```

# ruby-on-rails - 如何在需要引用调用模型的相关模型中检索数据

> ID：11765921
> 
> 赞同：1
> 
> 时间：2012-08-01T19:11:09.353
> 
> 标签：ruby-on-rails, model

我有一个控制器和两个模型，一个用户和一个商店。用户拥有许多商店。在商店里面，我有一个方法 get_items 列出了项目。get_items 本身需要对用户的引用。我现在所做的是以下

```
@items = user.stores.first.get_items(user) 
```

这对我来说看起来很奇怪，因为初始调用者必须将自己作为参数传递给 get_items 方法。你会推荐什么？

最好的，菲尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:18:20.377

如果您在两个方向上定义了关系，

```
class User < ActiveRecord::Base
  has_many :stores
end

class Store < ActiveRecord::Base
  belongs_to :user
end 
```

然后您可以访问实例`user`中商店所属的。`Store`所以你应该可以写

```
def get_items
   do_something_with user
end 
```

它应该使用正确的用户。然后可以调用 get_items

```
@items = user.stores.first.get_items 
```

我个人会重命名`get_items`为`items`.

# objective-c - XCode 显示对焦环

> ID：11765927
> 
> 赞同：1
> 
> 时间：2012-08-01T19:11:56.547
> 
> 标签：objective-c, xcode, cocoa

我的 XCode 项目中有一个 NSButton ，它被启用和禁用。

当它被启用时，用户并没有真正注意到，没有什么特别突出的，文本只是从灰色变为黑色。

我想要发生的是在启用按钮时手动显示按钮的对焦环或任何其他类型的突出显示。我上网查了，什么都找不到，让我觉得做不到？

任何人都可以帮忙吗？

我想它会很简单：

```
[myButton setFocusRing:visible]; 
```

感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:22:29.943

```
[window makeFirstResponder:theButton]; 
```

应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-13T18:41:33.940

更改以下设置。转到系统偏好设置>>键盘>>快捷方式选项卡>>启用左下角的“所有控件”单选按钮。

# c# - 私有属性字段上的 StackOverflow 异常

> ID：11765929
> 
> 赞同：0
> 
> 时间：2012-08-01T19:11:58.183
> 
> 标签：c#, properties, stack-overflow

有人可以告诉我为什么我得到`StackOverflowException`下面的代码吗？

```
 private float _voltageRange
    {
        get { return _voltageRange + ((10F/100F)*_voltageRange); }
        set { _voltageRange = value; }
    } 
```

我该如何解决这个问题？不是编译器会自动创建一个支持字段吗？

我想要实现的是返回`_VoltageRange`自身的 10%。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-01T19:13:37.577

你的 getter 和你的 setter 都递归地调用自己。

不，编译器不会自动为您创建支持字段 - 除非您使用这样的自动实现的属性：

```
public float VoltageRange { get; set; } 
```

每当您提供 getter/setter 主体时，您都必须*自己*完成。

听起来你想要：

```
private float _voltageRange;
private float VoltageRange
{
    get { return _voltageRange + ((10F/100F)*_voltageRange); }
    set { _voltageRange = value; }
} 
```

或者更简单地说：

```
private float _voltageRange;
private float VoltageRange
{
    get { return (_voltageRange * 11) / 10; }
    set { _voltageRange = value; }
} 
```

（或者只是乘以 1.1f，但这会增加数据丢失的可能性。）

请注意，这是一个非常奇怪的属性 - 值集与检索到的值不同。通常是这样的：

```
VoltageRange = VoltageRange; 
```

将是无操作的。这是大多数读者所*期望*的。

拥有两个属性可能会更好，如下所示：

```
private VoltageRange { get; set; }

private EffectiveVoltageRange { get { return VoltageRange * 1.1f; } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T19:15:37.507

将您的代码更改为如下所示，这将解决您的问题

```
private float _voltageRange;

public float VoltageRange
{
  get { return _voltageRange + ((10F/100F)*_voltageRange); }
  set { _voltageRange = value; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:53:18.197

这是执行私有财产时 IL 的样子：

```
get__voltageRange:
IL_0000:  nop         
IL_0001:  call        UserQuery.get__voltageRange
IL_0006:  ldc.r4      CD CC CC 3D 
IL_000B:  call        UserQuery.get__voltageRange
IL_0010:  mul         
IL_0011:  add         
IL_0012:  stloc.0     
IL_0013:  br.s        IL_0015
IL_0015:  ldloc.0     
IL_0016:  ret         

set__voltageRange:
IL_0000:  nop         
IL_0001:  ldarg.0     
IL_0002:  call        UserQuery.set__voltageRange
IL_0007:  nop         
IL_0008:  ret 
```

您现在可以清楚地看到递归在调用中发生的位置

# javascript - 在 Jquery 中控制菜单文本溢出

> ID：11765934
> 
> 赞同：0
> 
> 时间：2012-08-01T19:12:31.567
> 
> 标签：javascript, jquery, css

我是 JQuery 的新手。我正在使用以下链接 [http://tympanus.net/Tutorials/UIElements/LargeDropDown/中显示的菜单栏](http://tympanus.net/Tutorials/UIElements/LargeDropDown/)

源代码可以从这里下载

[http://tympanus.net/codrops/2010/07/14/ui-elements-search-box/](http://tympanus.net/codrops/2010/07/14/ui-elements-search-box/)

我已将代码和文件附加到我的项目中。问题是当我第一次打开页面时，它以正确的方式显示内容，如下图所示

![页面加载时](../Images/c6d8707bc8526ed934bc97b4aaa6a81b.png)

并在鼠标上输入列表项展开并正确显示下面的子详细信息

![鼠标输入](../Images/554e508149ed2ab76a57adf12f9d7998.png)

但是当我将鼠标从项目上移开时，文本会溢出并下降。如果它是一个单词，那么没有问题，但是如果有两个或多个单词，就会发生这种情况。您可以在下图中看到这一点

![文本溢出](../Images/36b0b226d66725b44b47fd364e4183fd.png)

我还提供了 javascript 代码

```
<!-- The JavaScript -->
    <script type="text/javascript" src="Styles/jquery.min.js"></script>
    <script type="text/javascript">
        $(function () {
            /**
            * the menu
            */
            var $menu = $('#ldd_menu');
            /**
            * for each list element,
            * we show the submenu when hovering and
            * expand the span element (title) to 510px
            */
            $menu.children('li').each(function () {
                var $this = $(this);
                var $span = $this.children('span');
                $span.data('width', $span.width());
                $this.bind('mouseenter', function () {
                    $menu.find('.ldd_submenu').stop(true, true).hide();
                    $span.stop().animate({ 'width': '510px' }, 300, function () {
                        $this.find('.ldd_submenu').slideDown(300);
                    });
                }).bind('mouseleave', function () {
                    $this.find('.ldd_submenu').stop(true, true).hide();
                    $span.stop().animate({ 'width': $span.data('width') + 'px' }, 300);
                });
            });
        });
    </script> 
```

你能帮帮我吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T10:59:01.823

您可以尝试通过 CSS 为您的 li ( [W3School min-width](http://www.w3schools.com/cssref/pr_dim_min-width.asp) ) 添加一个 min-width 。以下代码会影响您在 ul 之后使用 id 为 ldd_menu 的所有 li。

```
#ldd_menu li {
  min-width:200px
} 
```

您也可以仅用于一个特定的 li。

```
<li style="min-width:200px"> 
```

或通过每个块中的 jquery ( [jQuery CSS](http://api.jquery.com/css/) )

```
$span.css("min-width", "200px"); 
```

# dynamics-crm-2011 - 我可以在导入数据库后重新映射 CRM 2011 系统用户吗？

> ID：11765935
> 
> 赞同：1
> 
> 时间：2012-08-01T19:12:34.807
> 
> 标签：dynamics-crm-2011

我从外部域导入了一个 CRM 2011 数据库，并将一个管理员用户映射到我本地域上的本地帐户，而未映射所有其他用户。

我可以重新映射任何其他用户，还是我被困在重新导入数据库并正确映射？我想将其他用户之一映射到我的新域上的不同帐户，因为我想以该用户（而不是我最初映射的用户）身份登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T07:06:55.667

我不相信您可以再次执行映射过程（如组织导入工具中所示），但您可以更改系统用户记录上的域/登录名。这应该会达到相同的结果，如果您需要更新 100 条记录，您可能能够通过数据导入来更新记录，或者编写一个小应用程序来完成它。

# javascript - 在 SharePoint 中通过 javascript 打印

> ID：11765937
> 
> 赞同：1
> 
> 时间：2012-08-01T19:12:40.273
> 
> 标签：javascript, sharepoint-2010, printing

我在这里环顾四周，看到了如何通过实例化一个新窗口并在那里移植标记来使用 javascript 打印 div 的内容的绝妙解决方案。
我在 SharePoint 中使用该解决方案的问题是 SP.*.js 库异步加载，它会冻结打印对话框屏幕或浏览器本身。
有人能够解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T04:04:38.753

使用 sharepoint，您可以使用`ExecuteOrDelayUntilScriptLoaded`等到加载 SP.js 以确保没有冻结。

```
<script type="text/javascript">
  function printPage(){
  }
  window.onload = function(){ ExecuteOrDelayUntilScriptLoaded(printPage, "sp.js"); };
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:42:32.970

下面给出的代码适用于 sharepoint、ASPX 页面和任何浏览器。我用 Sharepoint 2010 Visual webparts 测试了代码，它就像一个魅力。

将此 Javascript 代码放在您的 webpart ASCX 文件中

```
 <script type="text/javascript">
       function printPartOfPage(elementId) {
        var printContent = document.getElementById(elementId);
        var windowUrl = '';
        var uniqueName = new Date();
        var windowName = 'Print' ;
        var printWindow = window.open(windowUrl, windowName, 'left=-20,top=-20,width=0,height=0');
        printWindow.document.write('<HTML><Head><Title></Title>');
        printWindow.document.write('</Head><Body style="margin-left:50px;margin-top:50px;font-size:10pt;">');
        printWindow.document.write(printContent.innerHTML);
        printWindow.document.write('</Body></HTML>');
        printWindow.document.close();
        printWindow.focus();
        printWindow.print();
        printWindow.close();
    }

</script> 
```

& 更新打印按钮 ClientClick 事件

```
 <img alt="" src="~/_layouts/images/WebpartCollection/Printer-30X30.jpg" 
onclick="JavaScript:printPartOfPage('YourDivClientID');" /> 
```

我希望这会帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T16:44:23.843

我不具体了解 SharePoint，因此无法提供具体示例。但是，听起来您正在考虑一种技术，例如[另一个 stackoverflow question](https://stackoverflow.com/a/1687435/1002041)中概述的技术。

请注意，这是将顺序执行的所有代码块。所以我们打开一个窗口，设置标记并立即打印。在这些步骤之间无需等待。

我建议您此时不要调用 print，而是打开窗口，设置标记并在新窗口标记中注入更多 javascript。这个新注入的 javascript 将是实际打印发生的地方。

注入的脚本应该有一些逻辑来等待某些脚本资源完成加载，然后它会调用`window.print()`. 显然`window.onload`在所有资源完成加载之前不会触发。（[在加载所有内容或加载失败之前，onload 不会触发](http://www.webmasterworld.com/forum91/5301.htm)）。这是[关于 stackoverflow 的 jquery 示例](https://stackoverflow.com/a/1012156/1002041)。脚本也按照出现在标记中的顺序执行。因此，如果您注入的打印窗口 JavaScript 是最后一个，那么它上面的所有其他脚本都必须已经完成。（因此，SharePoint 在标记中注入的任何内容都应该已经执行）。

对于奖励积分，如果一切顺利，您可以在新的打印窗口上注入一个“加载掩码”，然后在您的 javascript 执行它之前隐藏掩码`window.print()`。

# asp.net-mvc-3 - asp.NET MVC 3 复合模式模型绑定

> ID：11765938
> 
> 赞同：3
> 
> 时间：2012-08-01T19:12:43.143
> 
> 标签：asp.net-mvc-3, ef-code-first, model-binding, composite

我的应用程序有产品和供应商，并且它们在“具有”关系中都有相似的项目......特别是它们有一个“收藏夹”，因此用户可以为它们添加书签。

所以我们有：

```
public class Product
{
    public int ProductId {get;set;}
    public int Name {get;set;}
    public List<Favorite> Favorites {get;set;}
}

public class Vendor
{
    public int VendorId {get;set;}
    public int Name {get;set;}
    public List<Favorite> Favorites {get;set;}
}

public class Favorite
{
    public int FavoriteId {get;set;}
    public string UserName {get;set;}
} 
```

起初这不起作用，所以我补充说：

```
 public int? VendorId {get;set;}
    public int? ProductId {get;set;} 
```

现在我遇到的问题是我的 Vendor.Favorites 和 Product.Favorites 始终为空。

如何绑定这些以便我可以使用这样的对象？我不让它成为一个单独的实体吗？

谢谢！

更新：我应该注意我正在使用 MVC 3 Code-first 和 POCO。

更新：解决方案：

我认为这并不理想，仍在解决我希望它如何工作的问题，因为它将添加冗余代码以添加收藏夹和评论。

```
public class Product
{
    public int ProductId {get;set;}
    public int Name {get;set;}
    public virtual List<Favorite> Favorites {get;set;}
}

public class Vendor
{
    public int VendorId {get;set;}
    public int Name {get;set;}
    public virtual List<Favorite> Favorites {get;set;}
} 
```

在收藏夹类中使用原始的可为空的 int 变量使其工作，但如果我想将收藏夹类与其他对象一起使用，我将不得不使用到对象键的新映射来修改收藏夹属性。出于好奇，在正常处理这些类时，您如何管理这些对象的数据存储？我假设你在 DAL 处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:17:52.357

您可以使用继承，创建一个仅包含收藏夹的基类，然后基于该基类派生其他信息的类。这建立了“是”关系

前任。

```
public class baseClass
{
 public list<Favorite> Favorites { get; set;}
}
public class Product : base
{
 public int ProductID { get; set; }
 public string Name { get; set; }
} 
```

然后一个产品对象将具有所有 3 个属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:48:17.790

基于您使用的是 EF 4.1 的假设：

你的模型看起来不错，除非我会改变

```
 public int? VendorId {get;set;}
    public int? ProductId {get;set;} 
```

至

```
 public virtual Vendor VendorId {get;set;}
    public virtual Product ProductId {get;set;} 
```

然后你的 FK 关系应该已经设置好了。根据我对 EF 的理解，`List<Favorite>`它旨在建立一种关系，实际上并没有填充。您必须自己填充它，方法是调用`.Include()`上下文或引用 EF 在数据库中创建的实际 FK，在您的情况下是`VendorId_FavoriteId`或`ProductId_FavoriteId`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T19:23:44.867

我会保留一个属性来存储 ID（VendorID 或 ProductId）并使用另一个属性来告诉我它是什么类型（`Vendor`或`Product`）

```
public class Favorite
{
    public int FavoriteId {get;set;}
    public string UserName {get;set;}
    public int ItemID { set;get;}    //can use a better generic name
    public FavoriteType Type { set;get;}
} 
```

我有一个`Enum`类型

```
public enum FavoriteType
{
    Vendor, 
    Product
} 
```

并确保在访问它们之前初始化子属性/对它们应用方法，这样它就不会抛出空引用异常！。你可以自己做构造函数

```
public class Product
{
    public int ProductId {get;set;}
    public int Name {get;set;}
    public List<Favorite> Favorites {get;set;}

  public Product()
  {
      if(Favourites==null)
          Favorites=new List<Favorite>();
  }
} 
```

# python - Django 应用程序在 Heroku 中崩溃

> ID：11765945
> 
> 赞同：1
> 
> 时间：2012-08-01T19:13:19.290
> 
> 标签：python, django, heroku

我正在尝试在 heroku 上部署我的第一个 django 应用程序，并且一直在关注[Heroku 网站](https://devcenter.heroku.com/articles/django)上的指南。我一直到检查 Web 进程是否启动的这一步，看起来应用程序正在崩溃：

```
(venv)Jonathans-MacBook-Air-2:myportfolio jonathanschen$ heroku ps
=== web: `python ./manage.py runserver 0.0.0.0:$PORT --noreload`
web.1: crashed for 2m 
```

当我检查我的日志时，有很多东西。我已经阅读了一些关于 stackoverflow 的不同帖子，并且想知道我是否需要在根目录中有一个 proc 文件（似乎有相互冲突的答案）？这可能是导致崩溃的原因吗？一如既往地提前非常感谢堆栈溢出。这是日志：

```
(venv)Jonathans-MacBook-Air-2:myportfolio jonathanschen$ heroku logs
2012-08-01T18:29:55+00:00 app[web.1]:     self.fetch_command(subcommand).run_from_argv(self.argv)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
2012-08-01T18:29:55+00:00 app[web.1]:     self.execute(*args, **options.__dict__)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
2012-08-01T18:29:55+00:00 app[web.1]:     output = self.handle(*args, **options)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 69, in handle
2012-08-01T18:29:55+00:00 app[web.1]:     self.run(*args, **options)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 80, in run
2012-08-01T18:29:55+00:00 app[web.1]:     self.inner_run(*args, **options)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 91, in inner_run
2012-08-01T18:29:55+00:00 app[web.1]:     self.validate(display_num_errors=True)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
2012-08-01T18:29:55+00:00 app[web.1]:     num_errors = get_validation_errors(s, app)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/validation.py", line 23, in get_validation_errors
2012-08-01T18:29:55+00:00 app[web.1]:     from django.db import models, connection
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 40, in <module>
2012-08-01T18:29:55+00:00 app[web.1]:     backend = load_backend(connection.settings_dict['ENGINE'])
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
2012-08-01T18:29:55+00:00 app[web.1]:     return getattr(connections[DEFAULT_DB_ALIAS], item)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 92, in __getitem__
2012-08-01T18:29:55+00:00 app[web.1]:     backend = load_backend(db['ENGINE'])
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 24, in load_backend
2012-08-01T18:29:55+00:00 app[web.1]:     return import_module('.base', backend_name)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 34, in import_module
2012-08-01T18:29:55+00:00 app[web.1]:     name = _resolve_name(name[level:], package, level)
2012-08-01T18:29:55+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 7, in _resolve_name
2012-08-01T18:29:55+00:00 app[web.1]:     raise ValueError("'package' not set to a string")
2012-08-01T18:29:55+00:00 app[web.1]: ValueError: 'package' not set to a string
2012-08-01T18:29:56+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T18:29:56+00:00 heroku[web.1]: State changed from starting to crashed
2012-08-01T18:41:41+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-01T18:41:45+00:00 heroku[web.1]: Starting process with command `python ./manage.py runserver 0.0.0.0:22549 --noreload`
2012-08-01T18:41:46+00:00 app[web.1]: Validating models...
2012-08-01T18:41:46+00:00 app[web.1]: 
2012-08-01T18:41:46+00:00 app[web.1]: Traceback (most recent call last):
2012-08-01T18:41:46+00:00 app[web.1]:   File "./manage.py", line 10, in <module>
2012-08-01T18:41:46+00:00 app[web.1]:     execute_from_command_line(sys.argv)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
2012-08-01T18:41:46+00:00 app[web.1]:     self.fetch_command(subcommand).run_from_argv(self.argv)
2012-08-01T18:41:46+00:00 app[web.1]:     utility.execute()
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
2012-08-01T18:41:46+00:00 app[web.1]:     self.execute(*args, **options.__dict__)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 80, in run
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 69, in handle
2012-08-01T18:41:46+00:00 app[web.1]:     output = self.handle(*args, **options)
2012-08-01T18:41:46+00:00 app[web.1]:     self.run(*args, **options)
2012-08-01T18:41:46+00:00 app[web.1]:     self.validate(display_num_errors=True)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 91, in inner_run
2012-08-01T18:41:46+00:00 app[web.1]:     self.inner_run(*args, **options)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/validation.py", line 23, in get_validation_errors
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 40, in <module>
2012-08-01T18:41:46+00:00 app[web.1]:     num_errors = get_validation_errors(s, app)
2012-08-01T18:41:46+00:00 app[web.1]:     backend = load_backend(connection.settings_dict['ENGINE'])
2012-08-01T18:41:46+00:00 app[web.1]:     from django.db import models, connection
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
2012-08-01T18:41:46+00:00 app[web.1]:     return getattr(connections[DEFAULT_DB_ALIAS], item)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 92, in __getitem__
2012-08-01T18:41:46+00:00 app[web.1]:     backend = load_backend(db['ENGINE'])
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 24, in load_backend
2012-08-01T18:41:46+00:00 app[web.1]:     return import_module('.base', backend_name)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 34, in import_module
2012-08-01T18:41:46+00:00 app[web.1]:     name = _resolve_name(name[level:], package, level)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 7, in _resolve_name
2012-08-01T18:41:46+00:00 app[web.1]:     raise ValueError("'package' not set to a string")
2012-08-01T18:41:46+00:00 app[web.1]: ValueError: 'package' not set to a string
2012-08-01T18:41:47+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T18:41:47+00:00 heroku[web.1]: State changed from starting to crashed
2012-08-01T18:46:00+00:00 heroku[slugc]: Slug compilation started
2012-08-01T18:48:55+00:00 heroku[api]: Release v5 created by jonathanschen@gmail.com
2012-08-01T18:48:55+00:00 heroku[api]: Deploy f097e62 by jonathanschen@gmail.com
2012-08-01T18:48:55+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-01T18:48:56+00:00 heroku[slugc]: Slug compilation finished
2012-08-01T18:48:58+00:00 heroku[web.1]: Starting process with command `python ./manage.py runserver 0.0.0.0:23141 --noreload`
2012-08-01T18:48:59+00:00 app[web.1]: Traceback (most recent call last):
2012-08-01T18:48:59+00:00 app[web.1]:   File "./manage.py", line 10, in <module>
2012-08-01T18:48:59+00:00 app[web.1]:     execute_from_command_line(sys.argv)
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
2012-08-01T18:48:59+00:00 app[web.1]:     utility.execute()
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 252, in fetch_command
2012-08-01T18:48:59+00:00 app[web.1]:     self.fetch_command(subcommand).run_from_argv(self.argv)
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/conf/__init__.py", line 42, in _setup
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 101, in get_commands
2012-08-01T18:48:59+00:00 app[web.1]:     app_name = get_commands()[subcommand]
2012-08-01T18:48:59+00:00 app[web.1]:     apps = settings.INSTALLED_APPS
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/functional.py", line 184, in inner
2012-08-01T18:48:59+00:00 app[web.1]:     mod = importlib.import_module(self.SETTINGS_MODULE)
2012-08-01T18:48:59+00:00 app[web.1]:     self._wrapped = Settings(settings_module)
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
2012-08-01T18:48:59+00:00 app[web.1]:     self._setup()
2012-08-01T18:48:59+00:00 app[web.1]:     ^
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/conf/__init__.py", line 93, in __init__
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/myportfolio/settings.py", line 23
2012-08-01T18:48:59+00:00 app[web.1]: SyntaxError: invalid syntax
2012-08-01T18:48:59+00:00 app[web.1]:     __import__(name)
2012-08-01T18:48:59+00:00 app[web.1]:     }
2012-08-01T18:49:00+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T18:49:00+00:00 heroku[web.1]: State changed from starting to crashed
(venv)Jonathans-MacBook-Air-2:myportfolio jonathanschen$ heroku ps
=== web: `python ./manage.py runserver 0.0.0.0:$PORT --noreload`
web.1: crashed for 1m

(venv)Jonathans-MacBook-Air-2:myportfolio jonathanschen$ heroku ps
=== web: `python ./manage.py runserver 0.0.0.0:$PORT --noreload`
web.1: crashed for 2m

(venv)Jonathans-MacBook-Air-2:myportfolio jonathanschen$ heroku logs
2012-08-01T18:29:55+00:00 app[web.1]: ValueError: 'package' not set to a string
2012-08-01T18:29:56+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T18:29:56+00:00 heroku[web.1]: State changed from starting to crashed
2012-08-01T18:41:41+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-01T18:41:45+00:00 heroku[web.1]: Starting process with command `python ./manage.py runserver 0.0.0.0:22549 --noreload`
2012-08-01T18:41:46+00:00 app[web.1]: Validating models...
2012-08-01T18:41:46+00:00 app[web.1]: 
2012-08-01T18:41:46+00:00 app[web.1]: Traceback (most recent call last):
2012-08-01T18:41:46+00:00 app[web.1]:   File "./manage.py", line 10, in <module>
2012-08-01T18:41:46+00:00 app[web.1]:     execute_from_command_line(sys.argv)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
2012-08-01T18:41:46+00:00 app[web.1]:     self.fetch_command(subcommand).run_from_argv(self.argv)
2012-08-01T18:41:46+00:00 app[web.1]:     utility.execute()
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
2012-08-01T18:41:46+00:00 app[web.1]:     self.execute(*args, **options.__dict__)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 80, in run
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 69, in handle
2012-08-01T18:41:46+00:00 app[web.1]:     output = self.handle(*args, **options)
2012-08-01T18:41:46+00:00 app[web.1]:     self.run(*args, **options)
2012-08-01T18:41:46+00:00 app[web.1]:     self.validate(display_num_errors=True)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py", line 91, in inner_run
2012-08-01T18:41:46+00:00 app[web.1]:     self.inner_run(*args, **options)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/validation.py", line 23, in get_validation_errors
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 40, in <module>
2012-08-01T18:41:46+00:00 app[web.1]:     num_errors = get_validation_errors(s, app)
2012-08-01T18:41:46+00:00 app[web.1]:     backend = load_backend(connection.settings_dict['ENGINE'])
2012-08-01T18:41:46+00:00 app[web.1]:     from django.db import models, connection
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
2012-08-01T18:41:46+00:00 app[web.1]:     return getattr(connections[DEFAULT_DB_ALIAS], item)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 92, in __getitem__
2012-08-01T18:41:46+00:00 app[web.1]:     backend = load_backend(db['ENGINE'])
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 24, in load_backend
2012-08-01T18:41:46+00:00 app[web.1]:     return import_module('.base', backend_name)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 34, in import_module
2012-08-01T18:41:46+00:00 app[web.1]:     name = _resolve_name(name[level:], package, level)
2012-08-01T18:41:46+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 7, in _resolve_name
2012-08-01T18:41:46+00:00 app[web.1]:     raise ValueError("'package' not set to a string")
2012-08-01T18:41:46+00:00 app[web.1]: ValueError: 'package' not set to a string
2012-08-01T18:41:47+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T18:41:47+00:00 heroku[web.1]: State changed from starting to crashed
2012-08-01T18:46:00+00:00 heroku[slugc]: Slug compilation started
2012-08-01T18:48:55+00:00 heroku[api]: Release v5 created by jonathanschen@gmail.com
2012-08-01T18:48:55+00:00 heroku[api]: Deploy f097e62 by jonathanschen@gmail.com
2012-08-01T18:48:55+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-01T18:48:56+00:00 heroku[slugc]: Slug compilation finished
2012-08-01T18:48:58+00:00 heroku[web.1]: Starting process with command `python ./manage.py runserver 0.0.0.0:23141 --noreload`
2012-08-01T18:48:59+00:00 app[web.1]: Traceback (most recent call last):
2012-08-01T18:48:59+00:00 app[web.1]:   File "./manage.py", line 10, in <module>
2012-08-01T18:48:59+00:00 app[web.1]:     execute_from_command_line(sys.argv)
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
2012-08-01T18:48:59+00:00 app[web.1]:     utility.execute()
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 252, in fetch_command
2012-08-01T18:48:59+00:00 app[web.1]:     self.fetch_command(subcommand).run_from_argv(self.argv)
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/conf/__init__.py", line 42, in _setup
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 101, in get_commands
2012-08-01T18:48:59+00:00 app[web.1]:     app_name = get_commands()[subcommand]
2012-08-01T18:48:59+00:00 app[web.1]:     apps = settings.INSTALLED_APPS
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/functional.py", line 184, in inner
2012-08-01T18:48:59+00:00 app[web.1]:     mod = importlib.import_module(self.SETTINGS_MODULE)
2012-08-01T18:48:59+00:00 app[web.1]:     self._wrapped = Settings(settings_module)
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
2012-08-01T18:48:59+00:00 app[web.1]:     self._setup()
2012-08-01T18:48:59+00:00 app[web.1]:     ^
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/conf/__init__.py", line 93, in __init__
2012-08-01T18:48:59+00:00 app[web.1]:   File "/app/myportfolio/settings.py", line 23
2012-08-01T18:48:59+00:00 app[web.1]: SyntaxError: invalid syntax
2012-08-01T18:48:59+00:00 app[web.1]:     __import__(name)
2012-08-01T18:48:59+00:00 app[web.1]:     }
2012-08-01T18:49:00+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T18:49:00+00:00 heroku[web.1]: State changed from starting to crashed
2012-08-01T19:03:18+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-01T19:03:21+00:00 heroku[web.1]: Starting process with command `python ./manage.py runserver 0.0.0.0:20934 --noreload`
2012-08-01T19:03:22+00:00 app[web.1]: Traceback (most recent call last):
2012-08-01T19:03:22+00:00 app[web.1]:   File "./manage.py", line 10, in <module>
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
2012-08-01T19:03:22+00:00 app[web.1]:     execute_from_command_line(sys.argv)
2012-08-01T19:03:22+00:00 app[web.1]:     utility.execute()
2012-08-01T19:03:22+00:00 app[web.1]:     self.fetch_command(subcommand).run_from_argv(self.argv)
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 252, in fetch_command
2012-08-01T19:03:22+00:00 app[web.1]:     app_name = get_commands()[subcommand]
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 101, in get_commands
2012-08-01T19:03:22+00:00 app[web.1]:     apps = settings.INSTALLED_APPS
2012-08-01T19:03:22+00:00 app[web.1]:     self._setup()
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/functional.py", line 184, in inner
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/conf/__init__.py", line 42, in _setup
2012-08-01T19:03:22+00:00 app[web.1]:     self._wrapped = Settings(settings_module)
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/conf/__init__.py", line 93, in __init__
2012-08-01T19:03:22+00:00 app[web.1]:     mod = importlib.import_module(self.SETTINGS_MODULE)
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
2012-08-01T19:03:22+00:00 app[web.1]:   File "/app/myportfolio/settings.py", line 23
2012-08-01T19:03:22+00:00 app[web.1]:     ^
2012-08-01T19:03:22+00:00 app[web.1]: SyntaxError: invalid syntax
2012-08-01T19:03:22+00:00 app[web.1]:     __import__(name)
2012-08-01T19:03:22+00:00 app[web.1]:     }
2012-08-01T19:03:23+00:00 heroku[web.1]: Process exited with status 1
2012-08-01T19:03:24+00:00 heroku[web.1]: State changed from starting to crashed 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T12:37:08.563

有同样的问题，在查看日志（heroku 日志）时发现它找不到模块 psycopg2。

将 psycopg2==2.4.5 添加到 requirements.txt 文件解决了它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T21:52:27.627

我遇到了这个问题，问题是 settings.py 文件中的语法错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-17T20:20:21.147

我只是遇到了同样的问题，并在遇到很多问题后才弄清楚。

我注意到运行 pip freeze > requirements.txt 会从文件中遗漏一些必需的项目。

值得注意的是这两个：

白噪声==1.0.6 wsgiref==0.1.2

你可以去这里找到绝对需要的东西：

[Heroku Django 模板——requirements.txt](https://github.com/heroku/heroku-django-template/blob/master/requirements.txt)

# java - 为什么我的一些 Richfaces 资源在某些页面上丢失，而在其他页面上却没有？

> ID：11765968
> 
> 赞同：1
> 
> 时间：2012-08-01T19:14:31.180
> 
> 标签：java, jsf, richfaces

我有一个`rich:panelMenu`，里面`rich:panelMenuItem`有一堆菜单导航链接。如果我单击这些链接，例如名为`Settings`我的按钮的链接，并且某些资源（如图像和 css 内容）不会显示在我的控制台中。我的侧边栏上有大约 15 个导航链接，资源只加载其中两个。

我被难住了，因为如果我点击页面内的链接，将我带到同一`Settings`页面，所有资源都在加载。

似乎在单击不起作用的导航链接时，我正在获取上一页的资源。

任何见解都会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:45:48.070

你的第一页在WEB-INF里面？也许这个问题是因为您的资源位于 WEB-INF 文件夹中。

# iphone - 管理多个 UIActivityIndi catorView

> ID：11765970
> 
> 赞同：0
> 
> 时间：2012-08-01T19:14:38.823
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我已经定义了 UIActivityIndi​​catorView 的 IBOutletCollection。

```
IBOutletCollection(UIActivityIndicatorView) NSArray *ticker; 
```

在 Interface builder 中建立所需的连接后，我运行以下代码。

```
for (UIActivityIndicatorView *obj in ticker)
 {
            [obj startAnimating];
 } 
```

但我在控制台上收到这条消息：

***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UIActivityIndi​​catorView countByEnumeratingWithState:objects:count:]: unrecognized selector sent to instance 0x2c86a0”

我知道这可能是一个非常小的问题，但真的没有得到它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:31:17.217

我不知道它对你不起作用。我已经完成了以下操作，并且效果很好。

在我的.h

```
@property (strong, nonatomic)IBOutletCollection(UIActivityIndicatorView) NSArray *activityIndicators; 
```

在我的 .m 中（如果不使用 Xcode 4.4）

```
@synthesize activityIndicators 
```

我在 StoryBoard 中添加了 7 多个活动指示器并将它们连接到我的 viewController

在我看来DidLoad 我在打电话

```
for (UIActivityIndicatorView *obj in self.activityIndicators){
        [obj startAnimating];
    } 
```

在此配置中对我来说工作正常，没有问题。

根据您收到的错误消息

```
'NSInvalidArgumentException', reason: '-[UIActivityIndicatorView countByEnumeratingWithState:objects:count:] 
```

听起来有些不对劲，请检查您的 IB 以确保您没有做任何奇怪的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T19:20:27.087

该方法`countByEnumeratingWithState:objects:count:`应该作为`NSFastEnumeration`协议的一部分发送到数组对象。如果存在内存问题，有时消息可能会发送到错误的对象。仔细检查以确保`ticker`正确保留（并且使用 也可能是最佳实践`self.ticker`）。

# google-apps-script - 从多个其他工作表中写入数据以掌握 Google 电子表格；正在覆盖每个进纸器的结果，而不是获取所有结果

> ID：11765974
> 
> 赞同：0
> 
> 时间：2012-08-01T19:15:03.130
> 
> 标签：google-apps-script

**情况：**聚合来自多个馈线 Trix 的信息，并尝试将馈线的结果填充到主 Trix 的一张表中。

**问题：** 我想将每个 feeder trix 的结果（与下面的 get_data_from_feeders() 函数一起收集）写入 Master Trix 中的同一张表。但是，每个馈线阵列都会覆盖之前的馈线结果，因此只有最后一个馈线矩阵结果显示在 Master Trix 中，而不是全部三个（下面的 write_data(data) 函数）。

**问题：**

1）如何使每个馈线结果集附加以前的馈线矩阵结果而不是覆盖它们？[这将每月运行一次，因此每个月都可以覆盖上个月工作表上的内容]

2）如何对所有结果进行排序（我想我使用 .sort() 但不确定在哪里调用它）？

**当前代码：**

```
function get_data_from_feeders() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var feeders = ss.getRangeByName('spokes').getValues();
  for (var i = 0; i <= feeders.length; i++) {
    var feeder_id = feeders[i][0];
    var feeder_open = SpreadsheetApp.openById(feeder_id);
    var dataPull = feeder_open.getRangeByName('dataPull').getValues(); 

  write_data(dataPull); 
  }
}

function write_data(data) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var ws = ss.getSheetByName("Forecast_Aggregation");
  var dataDump = ss.getRangeByName("data_dump");

// I think the next line is where my code is incorrect - each feeder goes back to same cell instead of to the next blank row (hence, overwriting instead of appending)

  ws.getRange(dataDump.getRowIndex(), 2, data.length, 20).setValues(data);
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T22:41:23.017

也许尝试：

```
function write_data(data) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var ws = ss.getSheetByName("Forecast_Aggregation");
  var dataDump = ss.getRangeByName("data_dump").getRow();
  var nextRow = Math.max(dataDump, ws.getLastRow())+1;
  ws.getRange(nextRow, 2, data.length, 20).setValues(data);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T06:41:25.683

您可能还想查看我的博客。 [http://blog.ditoweb.com/2012/01/consolidate-spreadsheet-sheets-with.html](http://blog.ditoweb.com/2012/01/consolidate-spreadsheet-sheets-with.html)

# c# - 为混合大小写创建一个字段

> ID：11765989
> 
> 赞同：0
> 
> 时间：2012-08-01T19:16:02.793
> 
> 标签：c#, wpf, xaml

`Patient.name`的实际数据是大写的。我必须让它混合大小写日期才能更好地观看。我可以在 XAML 上执行此操作吗？我该如何编码？

```
<dxg:GridColumn FieldName="Patient.Name" />
<dxg:GridColumn FieldName="Patient.Room" />
<dxg:GridColumn FieldName="Patient.BirthDate" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T19:18:59.937

您可以添加一个包含 Patient.Room 等的属性，其中包含转换为标题大小写并绑定到该属性的代码。

您的绑定：

```
<dxg:GridColumn FieldName="Patient.RoomTitleCase" /> 
```

在你的课堂上：

```
public string RoomTitleCase
{
    get
    {
        System.Globalization.CultureInfo cultureInfo =     
                 System.Threading.Thread.CurrentThread.CurrentCulture;
        System.Globalization.TextInfo textInfo = cultureInfo.TextInfo;

        string titleCase = textInfo.ToTitleCase(Room.ToLower());
        return titleCase;
    }
} 
```

[http://techiecocktail.blogspot.com/2008/09/convert-given-string-to-mixed-case-or.html](http://techiecocktail.blogspot.com/2008/09/convert-given-string-to-mixed-case-or.html)

# java - AspectJ 切入点表达式匹配任意位置的参数注释

> ID：11765996
> 
> 赞同：17
> 
> 时间：2012-08-01T19:16:26.450
> 
> 标签：java, spring, aop, aspectj, spring-aop

我正在尝试定义一个切入点表达式以匹配包含使用特定注释注释的参数的方法，而不管参数位于什么位置。在我的情况下，我正在寻找`@Constraint`注释。例如：

搭配方法：

```
public void method1(@Constraint Car car)

public void method2(String id, @Constraint Plane plane)

public void method3(Wheel wheel, @Constraint List<Train> trains, @Constraint Plane plane)

public void method4(Motor motor, @Constraint Set<Train> trains, Bicycle bike, Wheel wheel)

public void method5(Wing wing, Motorcycle moto, @Constraint Truck truck, Bicycle bike, Wheel wheel) 
```

到目前为止，我已经尝试了以下表达式，但没有成功：

```
@Before("execution(public * *.*(..)) and @args(com.example.Constraint)") // there can be only one parameter
@Before("execution(public * *.*(..)) and @args(..,com.example.Constraint)") // parameter must be in last position
@Before("execution(public * *.*(..)) and @args(com.example.Constraint,..)") // parameter must be in first position
@Before("execution(public * *.*(..)) and (@args(com.example.Constraint,..) or @args(..,com.example.Constraint))") // parameter must be in first or last position, nothing in between
@Before("execution(public * *.*(..)) and @args(..,com.example.Constraint,..)") // Invalid 
```

有人可以指出正确的解决方案吗？有可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-24T23:28:43.813

您不能通过`args()`AspectJ 在任意位置绑定参数，因为这可能会导致歧义。试想一下，您有两个或多个相同类型的参数（或在这种情况下由相同的注释类型注释）。其中哪一个应该绑定到命名`args()`参数？所以虽然

```
execution(public * *(.., @Deprecated (*), ..)) 
```

可以作为独立表达式（请注意星号周围的括号），不能与 . 组合使用`args()`。因此，如果您不仅想拦截方法执行本身，还想找到带有给定注释的第一个或所有参数，您需要按照我在另一篇文章中展示的内容进行操作。我有点重复自己，但为了避免再次删除答案：

```
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

@Retention(RetentionPolicy.RUNTIME)
public @interface Constraint {} 
```

```
import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class Application {
    public void method1(@Constraint int i) {}
    public void method2(String id, @Constraint float f) {}
    public void method3(int i, @Constraint List<String> strings, @Constraint String s) {}
    public void method4(int i, @Constraint Set<Integer> numbers, float f, boolean b) {}
    public void method5(boolean b, String s, @Constraint String s2, float f, int i) {}
    public void notIntercepted(boolean b, String s, String s2, float f, int i) {}

    public static void main(String[] args) {
        List<String> strings = new ArrayList<String>();
        strings.add("foo");
        strings.add("bar");
        Set<Integer> numbers = new HashSet<Integer>();
        numbers.add(11);
        numbers.add(22);
        numbers.add(33);

        Application app = new Application();
        app.method1(1);
        app.method2("foo", 1f);
        app.method3(1, strings, "foo");
        app.method4(1, numbers, 1f, true);
        app.method5(false, "foo", "bar", 1f, 1);
        app.notIntercepted(false, "foo", "bar", 1f, 1);
    }
} 
```

```
import java.lang.annotation.Annotation;

import org.aspectj.lang.SoftException;
import org.aspectj.lang.reflect.MethodSignature;

public aspect ArgCatcherAspect {
    before() : execution(public * *(.., @Constraint (*), ..)) {
        System.out.println(thisJoinPointStaticPart);
        MethodSignature signature = (MethodSignature) thisJoinPoint.getSignature();
        String methodName = signature.getMethod().getName();
        Class<?>[] parameterTypes = signature.getMethod().getParameterTypes();
        Annotation[][] annotations;
        try {
            annotations = thisJoinPoint.getTarget().getClass().
                getMethod(methodName, parameterTypes).getParameterAnnotations();
        } catch (Exception e) {
            throw new SoftException(e);
        }
        int i = 0;
        for (Object arg : thisJoinPoint.getArgs()) {
            for (Annotation annotation : annotations[i]) {
                if (annotation.annotationType() == Constraint.class)
                    System.out.println("  " + annotation + " -> " + arg);
            }
            i++;
        }
    }
} 
```

正如您所看到的，获取给定参数的注释比仅获取其声明的类型有点棘手，但基本上它的工作方式与我之前的帖子中的相同，即通过迭代参数列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T21:18:55.840

我想你想要`execution(public * *.*(.., @com.example.Constraint *, ..)`，以一些语法为模。

# opencms - 列出 WebDAV '__properties' 文件夹时如何摆脱 CmsVfsResourceNotFoundException 的 opencms？

> ID：11765997
> 
> 赞同：0
> 
> 时间：2012-08-01T19:16:29.230
> 
> 标签：opencms

使用标准的 OpenCms WebDAV 配置，`CmsVfsResourceNotFoundException`通过 WebDAV 访问资源时可能会出错。

这很烦人，因为每当您列出任何`__properties`文件夹的内容时，OpenCms 都会转储该文件夹中每个文件的 36 个堆栈跟踪日志行！如果您在调试期间经常扫描 WebDAV 目录（请参阅注 1），这些日志会让您的生活更加艰难。（当然，您可以将日志级别更改为高于`INFO`，但对我来说这是不可接受的。）

该问题很容易重现：将浏览器指向 opencms 导出的 webdav 路径，然后单击任何`__properties`目录。

我找到了两种解决方法，但我对其中任何一种都不满意。也许有更好的解决方案？

* * *

笔记

¹我正在使用 NetBeans 调试一些 OpenCms 模块。我通过 OpenCms 的 WebDAV 导出它们的源代码，并将它们安装在 linux 中作为`davfs`. 如果我将它们添加到 NetBeans 项目，它会自动扫描这个挂载的文件层次结构，导致 OpenCms 变得“狂暴”，并开始用无用的痕迹溢出我可怜的控制台。情况变得更糟，因为 NetBeans 会定期重新扫描这些目录。

²将`content-encoding`每个可能的文件和目录的属性设置为 UTF-8 并没有帮助（堆栈跟踪声称它丢失了）。

* * *

我的相关环境和设置：

```
INFO OpenCms version      : 8.0.3
INFO System file.encoding : UTF-8
INFO i18n configuration   : the JVM default locale is "en"
INFO Initializing WebDAV servlet
INFO Initialized param "listings" with value "true"
INFO Initialized param "readonly" with value "false"
INFO Using repository with name "standard" 
```

`web.xml`相关配置：

```
<servlet>
    <description>
        Creates an access to OpenCms through WebDAV.
    </description>
    <servlet-name>OpenCmsWebDavServlet</servlet-name>
    <servlet-class>org.opencms.webdav.CmsWebdavServlet</servlet-class>
    <init-param>
      <param-name>listings</param-name>
      <param-value>true</param-value>
    </init-param>
    <init-param>
      <param-name>readonly</param-name>
      <param-value>false</param-value>
    </init-param>
    <init-param>
      <param-name>repository</param-name>
      <param-value>standard</param-value>
    </init-param>
</servlet> 
```

我的`opencms-importexport.xml`相关配置：

```
<repositories>
    <repository name="standard" class="org.opencms.repository.CmsRepository">
        <params>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceExtensionWrapperJsp</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceExtensionWrapperXmlContent</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceExtensionWrapperXmlPage</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceWrapperSystemFolder</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceWrapperPropertyFile</param>
        </params>
        <filter type="include">
            <regex>/</regex>
            <regex>/__properties/.*</regex>
            <regex>/sites/.*</regex>
            <regex>/system/</regex>
            <regex>/system/__properties/.*</regex>
            <regex>/system/galleries/.*</regex>
            <regex>/system/modules/.*</regex>
            <regex>/system/workplace/.*</regex>
        </filter>
    </repository> 
```

我的`opencms-system.xml`相关配置：

```
<opencms>
  <system>
    <internationalization>
      <localehandler class="org.opencms.i18n.CmsDefaultLocaleHandler"/>
      <localesconfigured>
        <locale>en</locale>
        <locale>de</locale>
      </localesconfigured>
      <localesdefault>
        <locale>en</locale>
        <locale>de</locale>
      </localesdefault>
      <timezone>GMT+01:00</timezone>
    </internationalization> 
```

堆栈跟踪：

```
01 Aug 2012 18:09:05,607  INFO [.opencms.i18n.CmsLocaleManager: 311] Could not read encoding property for resource "/sites/default/.content/config/__properties/c_0001.html.properties".
org.opencms.file.CmsVfsResourceNotFoundException: Error reading the property value for property "content-encoding" of resource "/.content/config/__properties/c_0001.html.properties".
    at org.opencms.file.CmsVfsResourceNotFoundException.createException(CmsVfsResourceNotFoundException.java:71)
    at org.opencms.db.CmsDbContext.throwException(CmsDbContext.java:334)
    at org.opencms.db.CmsDbContext.report(CmsDbContext.java:286)
    at org.opencms.db.CmsSecurityManager.readPropertyObject(CmsSecurityManager.java:4405)
    at org.opencms.file.CmsObject.readPropertyObject(CmsObject.java:2681)
    at org.opencms.i18n.CmsLocaleManager.getResourceEncoding(CmsLocaleManager.java:305)
    at org.opencms.file.wrapper.CmsObjectWrapper.needUtf8Marker(CmsObjectWrapper.java:871)
    at org.opencms.file.wrapper.CmsObjectWrapper.getResourcesInFolder(CmsObjectWrapper.java:382)
    at org.opencms.repository.CmsRepositorySession.list(CmsRepositorySession.java:268)
    at org.opencms.webdav.CmsWebdavServlet.renderHtml(CmsWebdavServlet.java:2480)
    at org.opencms.webdav.CmsWebdavServlet.serveResource(CmsWebdavServlet.java:2727)
    at org.opencms.webdav.CmsWebdavServlet.doGet(CmsWebdavServlet.java:1208)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    at org.opencms.webdav.CmsWebdavServlet.service(CmsWebdavServlet.java:2893)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.opencms.file.CmsVfsResourceNotFoundException: Unable to read resource "/.content/config/__properties".
    at org.opencms.db.generic.CmsVfsDriver.readResource(CmsVfsDriver.java:2162)
    at org.opencms.db.CmsDriverManager.readResource(CmsDriverManager.java:7293)
    at org.opencms.db.CmsDriverManager.readPropertyObjects(CmsDriverManager.java:7110)
    at org.opencms.db.CmsDriverManager.readPropertyObject(CmsDriverManager.java:7043)
    at org.opencms.db.CmsSecurityManager.readPropertyObject(CmsSecurityManager.java:4403)
    ... 23 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T19:16:29.230

我找到了两种解决方法：

## 编辑过滤器正则表达式以排除“__properties”目录。

在`opencms-importexport.xml`：

```
 <repository name="webdavrep" class="org.opencms.repository.CmsRepository">
        <params><!-- don't change it --></params>
        <filter type="include">
            <regex>/</regex>
            <regex>/__properties/.*</regex>
            <regex>/sites/((?!__properties).)*</regex>
            <!-- instead of ...
            <regex>/sites/.*</regex>
            -->
            <!-- etc -->
        </filter>
   </repository> 
```

（不要忘记更新您的`web.xml`以更改 webdav 存储库名称。）

## 从存储库中删除“CmsResourceWrapperPropertyFile”。

在`opencms-importexport.xml`：

```
 <repository name="webdavrep" class="org.opencms.repository.CmsRepository">
        <params>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceExtensionWrapperJsp</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceExtensionWrapperXmlContent</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceExtensionWrapperXmlPage</param>
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceWrapperSystemFolder</param>
            <!-- Do not publish properties ...
            <param name="wrapper">org.opencms.file.wrapper.CmsResourceWrapperPropertyFile</param>
            -->
        </params>
        <filter type="include"><!-- don't change it --></filter> 
```

（同样，不要忘记更新您的`web.xml`以更改 webdav 存储库名称。）

# image-processing - 通过 opencv 进行 3D 模板匹配

> ID：11765999
> 
> 赞同：5
> 
> 时间：2012-08-01T19:16:32.317
> 
> 标签：image-processing, opencv, template-matching

我有一个 3D 矩阵（非常大，我们称之为 L）和一个 3D 小矩阵（非常小，我们称之为 S），并且想使用 OpenCV 找到 L 中最接近的模式。

OpenCV 会为我做吗？如果是，我应该如何使用它？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T17:08:13.227

您需要的是[点云库](http://pointclouds.org/)，它是一个用于处理 3D 数据的开源库。我可以根据我的经验告诉你，学习使用这个库与学习 OpenCV 非常相似，因为许多开发人员为OpenCV 的主要赞助商[Willow Garage工作。](http://www.willowgarage.com/pages/software/overview)

如果您访问 PCL[教程](http://pointclouds.org/documentation/tutorials/)，您会发现三个有用的部分来解决您的问题：

1) 在您的 3D 点云中查找[特征](http://pointclouds.org/documentation/tutorials/#features-tutorial)，以后可以用于匹配

2）基于对应分组的3D[物体识别](http://pointclouds.org/documentation/tutorials/#recognition-tutorial)

3）使用迭代最近点和特征匹配等方法进行点云[配准](http://pointclouds.org/documentation/tutorials/#registration-tutorial)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T05:06:16.903

不，OpenCV 对此没有任何帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T10:51:06.643

你有稀疏的点云还是只有 3-dim 矩阵？

对于 3-dim 矩阵，您可以使用 FFT 使用相位相关。好的图书馆是[FFTW](http://www.fftw.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-08T18:55:53.483

OpenCV 添加了一些简洁的工具来完成此类任务

*   表面匹配[https://docs.opencv.org/master/d9/d25/group__surface__matching.html](https://docs.opencv.org/master/d9/d25/group__surface__matching.html)
*   基于剪影的 3D 跟踪[https://docs.opencv.org/master/d4/dc4/group__rapid.html](https://docs.opencv.org/master/d4/dc4/group__rapid.html)
*   卷积神经网络[https://docs.opencv.org/master/d9/d02/group__cnn__3dobj.html](https://docs.opencv.org/master/d9/d02/group__cnn__3dobj.html)