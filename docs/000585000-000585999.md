# StackOverflow 问答 000585000-000585999

# macos - Mac system_profiler 的区别

> ID：585001
> 
> 赞同：0
> 
> 时间：2009-02-25T07:02:59.390
> 
> 标签：macos, usb, system-profiler

我`system_profiler`用来查看连接到 Mac 的 USB 硬件详细信息，但是在 Mac OS X 10.4 和 10.5 上运行它之间存在一些差异。例如，在 10.5 中，各种属性的键都有一个字母前缀。更重要的是，我无法`location_id`在 10.4 中获取属性（在 SPUSBDataType 数据类型中）。关于为什么存在这种差异以及解决方法的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T18:42:38.787

您是否尝试过使用 ioreg？我无权访问 10.4，但由于 ioreg 级别较低，因此对于您要实现的目标来说，这可能是一种更好的方法。

```
ioreg -l -n IOSerialBSDClient 
```

# python - 调查查询系统的数据库设计

> ID：585006
> 
> 赞同：0
> 
> 时间：2009-02-25T07:04:33.817
> 
> 标签：python, database, django, sqlite

我正在开发一个所谓的行为风险因素监测系统 (BRFSS)，这是一个处理每年都会出现的问卷的网络查询系统。

我很难为它想出一个合适的数据库设计。问题是：每份问卷包含大约 80 个问题，包括人口统计信息，例如年龄、教育等，以及调查问题，例如吸烟、健康等。每年，有些问题会发生变化，有些则不会。数据源是一个包含 80 多列的 Excel 文件。系统必须支持以下查询：

```
SELECT [question var], [demo var], count(*) 
FROM survey 
WHERE age in (...) AND educ in (...) [etc] 
GROUP BY <question var> 
```

数据是只读的，即。导入后永不改变。所以它不必被规范化太多。直观地说，类似电子表格的表格会做得很好。速度和空间。但是，这会成为一个问题，因为问题会发生变化，那么我们无法将所有数据保留在此表中，这是跨年度查询所必需的。

我尝试将响应标准化为三个表：问题、响应和 response_values，它们可以支持问题的变化。但随后响应表跨越 98*14268 = 1,398,264 行一年！这真的很大。查询速度很慢！

我应该如何设计数据库？任何帮助表示赞赏！提前致谢！

附言。我正在使用 Python+Django+Sqlite。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T07:06:41.673

您是否检查过[DatabaseAnswers](http://www.databaseanswers.org/data_models/index.htm)以查看是否有可以用作起点的模式？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T07:29:34.333

听起来像是星型模式的案例。

你会有一个像这样的（巨大的）事实表：

question_id、survey_id、age_group_id、health_classifier_id、is_Smoking ...、answer_value

和非规范化维度表：

年龄组：组名，最小年龄，最大年龄，年龄组ID

对于这样的系统来说，140 万行听起来并不多。

一些数据库具有支持对这种模式进行查询的特殊功能：

在 Oracle 上，这些将是：

*   支持沿维度聚合的“维度”
*   用于过滤低基数属性（如 age_group_id 和 is_Smoking）的位图索引
*   位图连接索引，用于过滤连接表中的低基数属性，即从事实表中选择但过滤age_group 表中的min_age。
*   分区表来处理大表
*   用于预先计算聚合结果的物化视图

也有专门用于这种数据的数据库系统，称为多维数据库。

检查您的数据库是否有类似的结构或考虑切换数据库引擎

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T07:29:39.590

你至少需要 3 张桌子：

1)`Questions`其中包含每个问题的文本，带有自动增量 id 键

例如：（123，“你的头发是什么颜色的？”）

2) `Questionaires`，它将 Q# 映射到问题上。

例如）关于问卷#3 的问题#10 映射到问题#123。

3) `Answers`，将每个受访者与他们的问卷和数据联系起来

例如）鲍勃对问卷#3 的问题#10 的回答是“棕色”。

您应该看到使用现有问题添加新问卷和添加新问题是多么容易。是的，会有很大的表，但是一个好的数据库引擎应该能够轻松处理 1M 条目。您可以使用分区来提高效率，例如按年分区。

我将把它作为如何将其转换为 sql 的练习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T15:26:02.410

在我在 stackoverflow 上发帖后，我也一直在思考。这是我如何使用非规范化宽表（80 多列）来支持每年更改问题以及汇总交叉表的方法。请发表评论。谢谢

1.  为每年创建一个新表格，将问题放在列上，例如

    身份证 年龄 性别 教育 收入 ... 吸烟 HIV 饮料 ...

2.  创建两个表：Question 和 Query_Year，一个多对多表 Question_Year。然后我们可以填充指定年份可用的问题列表，反之亦然。

3.  一年内查询很容易。并且查询跨年，我们可以使用一个 UNION 操作符。由于问题应该在所选年份之间兼容，因此 UNION 是合法的。例如

    SELECT * FROM ( SELECT id, , , COUNT( *) FROMsurvey_2001 UNION ALL SELECT id, , , COUNT(* ) FROMsurvey_2003 UNION ALL SELECT id, , , COUNT(*) FROMsurvey_2004 UNION ALL etc etc ) WHERE ( AGE in (. ..) AND EDUC in (...) AND etc etc ) GROUP BY ,

我想 UNION 是一个关系运算符，它不应该降低 RDBMS 的效率。因此，如果我通过联合合并许多表并没有什么坏处。该引擎还可以进行一些查询分析以提高速度。

我认为这个足够简单。请发表评论。谢谢！

# oracle - 如何在 SQL 中的两列之间创建检查约束？

> ID：585020
> 
> 赞同：5
> 
> 时间：2009-02-25T07:12:41.940
> 
> 标签：oracle, check-constraints

我正在尝试创建一个基本工资（BP）表

```
CREATE TABLE bp (
   bpid       VARCHAR(5), 
      FOREIGN KEY (bpid) REFERENCES designation(desigid), 
   upperlimit DECIMAL(10,2) NOT NULL, 
   lowerlimit DECIMAL(10,2) NOT NULL, 
   increment  DECIMAL(10,2) NOT NULL 
      CONSTRAINT llvalid CHECK (upperlimit > lowerlimit)
 ); 
```

正如您在结尾附近看到的那样，我想检查是否`upperlimit`大于`lowerlimit`，我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T07:17:17.577

它可能（可能）取决于您使用的数据库。

与 oracle 语法相比（例如：[http](http://www.techonthenet.com/oracle/check.php) ://www.techonthenet.com/oracle/check.php ），您缺少的可能是 NULL 和 CONSTRAINT 之间的“,”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T07:22:41.713

这是正确的 SQL 查询...

```
CREATE TABLE bp (bpid VARCHAR(5),
FOREIGN KEY (bpid) REFERENCES designation(desigid), 
upperlimit DECIMAL(10,2) NOT NULL,
lowerlimit DECIMAL(10,2) NOT NULL,
increment DECIMAL(10,2) NOT NULL,
CONSTRAINT llvalid CHECK (upperlimit > lowerlimit)); 
```

注意最后一行中 NOT NULL 和 CONSTRAINT 后面的逗号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T07:48:16.567

问题是您已将其定义为列级约束，但它引用了其他列。您必须在表级别定义约束。

```
ALTER TABLE bp
    ADD CONSTRAINT CK_limit CHECK ( upperlimit > lowerlimit) 
```

# jquery - 使用 AJAX 和 ASP.NET MVC 显示进程状态

> ID：585027
> 
> 赞同：1
> 
> 时间：2009-02-25T07:16:38.063
> 
> 标签：jquery, asp.net-mvc, ajax

我的控制器中有一个方法可以在服务器上启动工作。我将使用 Ajax 调用 (jQuery) 通过页面上的链接来启动它。这可能需要一段时间，我需要在页面上显示一些状态。我不一定需要“完成 26% ......”，但更多的是显示“工作”或“完成”的状态。

如何让 jQuery 持续获取工作状态？还是应该以不同的方式解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T07:21:13.107

您将需要某种状态来保存任务和 Javascript 都可以访问的任务状态。例如服务器缓存。假设您使用 TaskComplete 的键。

通过 AJAX 使用 javascript 开始您的任务

当您的任务正在运行时

任务更新服务器缓存项

结束时

***平行线***

使用 Javascript 轮询缓存中的值

通过 AJAX 使用 javascript 开始您的任务

虽然 Ajax 响应未完成任务

等待 2 秒

再次通过ajax调用javascript函数读取Server Cache Item的值

根据其价值执行相关任务

您可能会发现有用的文章在这里：

[http://msdn.microsoft.com/en-us/magazine/cc163393.aspx](http://msdn.microsoft.com/en-us/magazine/cc163393.aspx)

# java - 静态方法使 Java 成为一种伪函数语言？

> ID：585031
> 
> 赞同：7
> 
> 时间：2009-02-25T07:19:46.167
> 
> 标签：java, closures, functional-programming

我一直在考虑Misko Hevery的一篇[文章，即 Java 中的静态方法是](http://googletesting.blogspot.com/2008/12/static-methods-are-death-to-testability.html)*可测试性的死亡*。我不想讨论可测试性问题，而是更多关于静态方法的概念。为什么人们如此讨厌它？

确实，我们没有闭包（但我们有一个有点尴尬的匿名函数）、lambdas 和函数作为第一类对象。在某种程度上，我认为静态方法可以用来模仿函数作为第一类对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T07:25:33.207

静态方法使测试变得困难，因为它们不能被替换，就这么简单。

静态方法如何“模仿”作为第一类对象¹的功能？可以说，他们在这方面比其他任何事情都要糟糕。您可以通过创建单方法接口将函数“模仿”为第一类对象，实际上 Google 的 Java 集合在许多地方（用于谓词、投影等）都做到了这一点。这不能用静态方法来完成——没有办法（除了反射）来传递“当你想应用一个函数时，使用*这个*方法。

不，我看不出静态方法在这里有什么帮助。它们不鼓励状态更改（因为唯一可用的状态是全局状态和通过参数传入的任何可变状态），但它们在“作为第一类对象的功能”方面没有帮助。

C# 对此有*更好*的支持（使用 lambda 表达式和委托），但即使这样也没有想象中的那么普遍。（例如，将其与 F# 进行比较。）

* * *

¹从 Java 8 开始，方法引用将允许将方法转换为适当的单方法接口的实例，这将使所有这些*更加*相关。早在 2009 年，那还很遥远……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T07:31:50.193

功能性！=功能，为了记录，我将声称一个方法！=功能......

Java 是一种静态类型的面向对象的语言。Java 也以这种方式保持了相对的纯度，但它与函数式语言相去甚远。

虽然您确实可以使用命令式编程来模仿函数式编程的行为，但您永远无法获得 lambda 演算所需的整洁语法。在某种程度上，如果该语言不支持适当的 lambda 演算，它就不是一种函数式编程语言。

C++ 有函数，但 C++ 也有类。因此，C++ 有两种类型的函数，成员函数和函数。当您说方法时，您的意思是成员函数。因为该方法是在对象的实例上调用的。但是当您说静态方法时，您的意思只是函数（在 C/C++ 意义上）。这只是一个用于引用代码元素的词汇表。并且在Java 代码中不能存在于一个类之外，一个方法会暗示它属于某个类，即类型。

到目前为止，我所说的一切都与函数式编程无关，但我认为你明白了你错的地方。

我建议您查看纯函数式编程语言，例如 Haskell 或 Erlang。因为函数式编程语言通常也没有关闭器。

您声称可以使用静态方法将函数模仿为一流的对象，这对我来说听起来真的很奇怪。它听起来更像是一种动态编程语言，而不是函数式编程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T14:57:53.430

函数式编程的一个特点是数据的不变性。`static`确实暗示您不需要表示状态的对象（实例），所以这不是一个糟糕的开始。但是，您确实在班级级别上有状态，但是您可以使 this `final`. 由于（静态）方法根本不是一等函数，你仍然需要像匿名类这样丑陋的结构来处理 Java 中某种*风格*的函数式编程。

FP 最好用函数式语言完成，因为它对高阶函数、不变性、引用透明性等具有必要的语言*支持。*

但是，这并不意味着您不能使用 Java 这样的命令式语言以函数式风格进行编程。也可以给出其他示例。不是因为你在用 Java 编程，所以你在做 OOP。`goto`您可以使用C++ 等结构化语言对全局数据和非结构化控制流 ( ) 进行编程。我可以用像 Scheme 这样的函数式语言来做 OOP。等等。

Steve McConnell在 Code Complete（也是一个非常流行的 SO 参考资料）中提到了*用*一种语言编程与*用一种语言编程的区别。*

所以，简而言之，如果你说“静态方法模仿一流的功能”，我不同意。

If, however, and I think that this was more the point you were trying to get across, you would say that "static methods can help for programming in a functional style in Java", I agree.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T07:27:10.503

我对静态方法的最大反对意见是它们不是多态的，并且它们不是以面向对象的方式使用的，相反，你必须使用类（而不是对象）来访问它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T09:41:08.027

如果您只使用静态方法，那么您就是在以程序化、非面向对象的风格进行编程。

但是，我能想到的唯一情况是在引入面向对象之前的第一堂编程课程中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T13:55:17.183

在 Java 中，您不能将一个函数作为另一个函数的参数。

在函数式语言中，如果你有一个函数

```
def addOne(i) = i + 1 
```

您可以将其传递给另一个函数，例如将其应用于列表的所有元素。

在 Java 中，与

```
public static int addOne(int i) { return i + 1; } 
```

没有办法做到这一点。

# php - 如何制作带有垂直滚动条的下拉菜单？

> ID：585032
> 
> 赞同：0
> 
> 时间：2009-02-25T07:20:05.170
> 
> 标签：php, html

嗨，我需要在下拉菜单中放置一个垂直滚动条，这样一开始它只会显示 size=1 但是当我们下拉时它应该有一个垂直滚动条，谁能帮助我，我真的很感激任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T07:43:42.180

如果您使用 html-dropdownbox，Natrium 建议，您可以设置 select 标签的属性“size”，以指定要显示的行数。因此，如果 - 在他的示例中 - 您将大小设置为 3，则下拉框将有 3 行高，并附加一个滚动条以向下滚动到剩余的 3 个项目。

如果你的意思是 CSS，假设你在 div-tag 中显示你的下拉菜单，你可以使用类似的东西：

```
<div style="height:200px; overflow-y:scroll">...</div> 
```

这为您提供了一个具有绝对高度的 div。如果 div 的内容太大，会自动显示一个垂直滚动条。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T08:08:10.590

如果您的意思是要**强制**滚动条始终可见，则无法使用本机选择下拉菜单来执行此操作。本机控件中滚动条的可见性取决于下拉菜单中的条目数，并且浏览器之间在处理控件的方式上也存在差异。例如，IE6 和 IE7 似乎只有在项目数超过 30 时才显示滚动条，而 FF3 和 Chrome 则在项目数超过 20 时才显示滚动条。

如果您真的非常想始终获得滚动条，则必须使用一些非本地实现，例如[jQuery FlexBox](http://www.fairwaytech.com/flexbox/Default.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T07:35:29.873

这不只是您需要的 html-dropdownbox 吗？

```
<select name="cars">
   <option value="volvo">Volvo</option>
   <option value="saab">Saab</option>
   <option value="fiat">Fiat</option>
   <option value="audi">Audi</option>
   <option value="volkswagen">Volkswagen</option>
   <option value="bmw">Bmw</option>
</select> 
```

# email - 是否可以通过电子邮件更新 Lotus Notes 中的条目？

> ID：585033
> 
> 赞同：0
> 
> 时间：2009-02-25T07:20:25.620
> 
> 标签：email, lotus-notes

是否可以像 posterous 一样通过电子邮件更新 Lotus Notes 中的条目？如果可能的话，我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T07:56:14.473

很容易。

您需要做的是在邮件数据库中创建一个代理来处理传入的邮件（这将需要 Domino Designer 和邮件数据库中的适当权限）。

根据您的要求，您可以定期（例如，每小时一次）或在特定事件（例如，当新邮件到达时）触发代理。

我写过的所有代理都是用 LotusScript（一种 VBA）编写的，它们可以扫描数据库中的文档，检查状态、标题等，以决定做什么。

我最近为这里的某个人写的一篇如下。当被调用时，它基本上会通过收件箱检查每个文档是否有包含“qwertyuiop”的主题标题，并创建一封回复电子邮件给发件人，其中包含带有“SUCCESS”的相同主题。

然后它将文档从收件箱移动到垃圾文件夹。由于不需要立即响应，因此该特定代理每 60 分钟运行一次。您应该能够从代码中获取意图。

```
Sub Initialize
    Dim s As New notessession
    Dim db As notesdatabase
    Dim view As NotesView
    Dim doc As NotesDocument
    Dim olddoc As NotesDocument
    Dim subj As String
    Dim newdoc As NotesDocument

    Set db = s.CurrentDatabase
    Set view = db.GetView("($InBox)")
    If Not view Is Nothing Then
        Set doc = view.GetFirstDocument
        While Not doc Is Nothing
            Set olddoc = doc
            Set doc = view.GetNextDocument(doc)
            subj = olddoc.GetFirstItem("subject").Text
            If Instr(subj, "qwertyuiop") > 0 Then
                Set newdoc = New NotesDocument(db)
                newdoc.SendTo = olddoc.GetFirstItem("inetfrom").Text
                newdoc.subject = subj & " SUCCESS"
                newdoc.form = "Memo"
                Call newdoc.send(True,True)
                Call olddoc.RemoveFromFolder( "($InBox)")
                Call olddoc.PutInFolder( "junk")
            End If
        Wend
    End If
End Sub 
```

您可能需要对此稍作修改，这将打开一个不同的数据库并根据邮件文档更改其中的文档。

您真正需要的只是电子邮件中的一个键，它可以识别辅助数据库中的哪个文档应该更改，以及一些可以根据邮件内容应用更改的逻辑。

这留给读者作为练习。我给你的应该足以让你开始（当你玩过这个时再问一个问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-30T13:17:57.843

好简单。在 Notes 中，您可以将任何数据库设置为电子邮件的目标。它有自己的电子邮件 ID（例如 productupdates@acme.com）。然后，您编写一个在“新电子邮件到达时”运行的代理。新文档在`session.currentdatabase.unprocesseddocuments`集合中。您的电子邮件当然必须包含一些内容，以便您确定要更新的文档。Notes 在内部使用 NotesDocumentUniqueID 作为主键，但我想您更愿意选择一个业务领域。使用 NotesMimeEntry，您可以在电子邮件中访问 HTML 格式的内容，以防您通过电子邮件发送表单左右。

# database - 通过 EJB3.0 和 JPA 存储最后修改数据库行的用户名

> ID：585040
> 
> 赞同：0
> 
> 时间：2009-02-25T07:25:07.153
> 
> 标签：database, jpa, ejb-3.0, weblogic

我想将上次修改表行的用户名存储为每个表中的字段。

我有以下设置：用户登录，Web 层调用一些 EJB 3.0 bean。这些 EJB bean 创建和修改一些 JPA 实体。现在，我希望将用户名（来自 weblayer）自动存储到在 EJB 方法调用期间创建或修改的每个 JPA 实体（和数据库行）。

我有这种表，（即：每个表都有字段修饰符）：

```
CREATE TABLE my_table (
  some_data INTEGER,
  modifier VARCHAR(20)
); 
```

自动我的意思是，我不需要为 EJB 方法中的每个实体手动设置用户名。

您可以通过将用户名存储到 ThreadLocal 变量并从 JPA 实体的 EntityListener 中的 ThreadLocal 获取用户名来实现此目的。但是，这只适用于您使用本地 EJB 调用，它不适用于跨 JVM 边界的 EJB 调用。我想通过远程 EJB 方法调用来完成这项工作。

这可能吗？

我正在使用 Weblogic Server 10.3、EJB3.0 和 EclipseLink JPA。我也有兴趣了解这是否适用于其他 JPA 实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T04:14:38.477

您可以在 EJB 类上使用 EJB 拦截器 (@Around) 来获取当前用户（使用标准 EJB api）并将名称存储在 threadlocal 变量中。这对于远程和本地调用是透明的。

# c# - 从 IronRuby 返回 CLR 类型

> ID：585047
> 
> 赞同：4
> 
> 时间：2009-02-25T07:28:17.597
> 
> 标签：c#, ironruby

我正在尝试从 Iron Ruby 返回一个 CLR 对象。

我在 C# 中定义了以下 CLR 类型

```
public class BuildMetaData
{
    public string Description { get; set; }
} 
```

我有以下 IronRuby 文件：

```
$:.unshift(File.dirname(__FILE__) + '/../bin/Debug') 
require 'mscorlib'
require 'Horn.Core.DSL.Domain'

class MetaDataFactory
    def return_meta_data()
        meta = Horn::Core::DSL::Domain::BuildMetaData.new
        meta.Description = "A description of sorts"
        meta
    end
end 
```

我有以下测试失败：

```
[Fact]
public void Then_a_build_metadata_object_is_returned()
{                       
    var engine = Ruby.CreateEngine();

    engine.ExecuteFile("test.rb");

    var code = String.Format("{0}.new.method :{1}", "MetaDataFactory", "return_meta_data");

    var action = engine.CreateScriptSourceFromString(code).Execute();

    var result = (BuildMetaData)engine.Operations.Call(action);

    Assert.Equal(result.Description, "A description of sorts");
} 
```

尝试强制转换从 IronRuby 返回的对象时失败。

我收到以下错误消息：

[A]Horn.Core.DSL.Domain.BuildMetaData 无法转换为 [B]Horn.Core.DSL.Domain.BuildMetaData。类型 A 源自 'Horn.Core.DSL.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 在上下文 'LoadNeither' 的位置 'C:\Projects\horn\branches\rubydsl\src\Horn .Dsl.Specificatioin\bin\Debug\Horn.Core.DSL.Domain.dll'。类型 B 源自 'Horn.Core.DSL.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 在位置'C:\Users\paul.cowan\AppData\Local\Temp 的上下文'Default'中\1vt2usw2.rxf\Horn.Dsl.Specificatioin\assembly\dl3\1d5ed945\7c19e429_1a97c901\Horn.Core.DSL.Domain.DLL'。

是否可以从 Iron Ruby 返回 CLR 类型

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T23:32:23.530

与其使用特制的 Ruby 字符串获取方法，然后使用 C# 调用该方法，不如从 C# 调用 Ruby 代码的首选方法如下：

```
var engine = IronRuby.Ruby.CreateEngine()
engine.ExecuteFile("test.rb")
var klass = engine.Runtime.Globals.GetVariable("MetaDataFactory")
var instance = engine.Operations.CreateInstance(klass)
engine.Operations.InvokeMember(instance, "return_meta_data") 
```

〜吉米

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T07:53:27.213

实际上，这一切都归结为影子复制。

我的代码最终看起来像这样：

```
[Fact]
public void Then_the_object_should_be_accessible_in_csharp()
{                       
    var engine = Ruby.CreateEngine();

    engine.Runtime.LoadAssembly(typeof (BuildMetaData).Assembly);

    engine.ExecuteFile(buildFile);

    var klass = engine.Runtime.Globals.GetVariable("MetaDataFactory");

    var instance = (RubyObject)engine.Operations.CreateInstance(klass);

    //You must have shadow-copying turned off for the next line to run and for the test to pass.
    //E.g. in R# "ReSharper/Options/Unit Testing/Shadow-Copy Assemblies being tested" should be un-checked.
    var metaData = (BuildMetaData)engine.Operations.InvokeMember(instance, "return_meta_data");

    Assert.Equal(metaData.Description, "A description of sorts");

    Assert.Equal(metaData.Dependencies.Count, 1);
} 
```

但是，如果我从 R# 测试运行器中关闭影子复制，那么测试现在通过了。

# web-services - 升级到 JBoss 4.2.3 时 base64 数据的 Web 服务问题

> ID：585049
> 
> 赞同：0
> 
> 时间：2009-02-25T07:28:34.320
> 
> 标签：web-services, jakarta-ee, jboss, xsd

这是一个很长的配置文件...我正在从 JBoss 4.0.5 升级到 4.2.3 我使用的系统有一个旧的 web 服务。它基于 J2EE webservices 1.1。它有一个 SLSB (EJB2) 作为端点。WSDL 文件指出了一个模式（XSD 文件）文件，用于定义 Web 服务的参数。并且有一个映射到架构的映射文件。

问题：对于初学者来说，该服务在 JBoss 4.0.5 中工作。在 4.2.3 中，它工作得非常好，除了附件元素，base64 数据没有正确转换为字节数组。将其更改为字符串可以正常工作，因此拼写错误没有问题，它只是不会转换为字节数组。从 4.0.5 升级到 4.2.3 时有人遇到过类似的问题吗？

如果我从通话中删除附件，它工作正常，但如果我有一个，如果失败：

```
 org.jboss.ws.WSException: org.jboss.ws.core.binding.BindingException: org.jboss.ws.core.jaxrpc.binding.jbossxb.UnmarshalException: Failed to
     parse source: Failed to resolve target property type on org.jboss.xb.binding.sunday.unmarshalling.ElementBinding@1f1804d({http://foo/newsws/types}attachment, type={http://foo/newsws/types}AttachmentElementType)
            at org.jboss.ws.core.soap.XMLContent.unmarshallObjectContents(XMLContent.java:250)
            at org.jboss.ws.core.soap.XMLContent.transitionTo(XMLContent.java:97)
            at org.jboss.ws.core.soap.SOAPContentElement.transitionTo(SOAPContentElement.java:141)
            at org.jboss.ws.core.soap.SOAPBodyElementDoc.transitionTo(SOAPBodyElementDoc.java:85)
            at org.jboss.ws.core.soap.SOAPContentElement.getObjectValue(SOAPContentElement.java:173)
            at org.jboss.ws.core.EndpointInvocation.transformPayloadValue(EndpointInvocation.java:263)
            at org.jboss.ws.core.EndpointInvocation.getRequestParamValue(EndpointInvocation.java:115)
            at org.jboss.ws.core.EndpointInvocation.getRequestPayload(EndpointInvocation.java:135)
            at org.jboss.ws.core.server.DelegatingInvocation.getArgs(DelegatingInvocation.java:82)
            at org.jboss.wsf.container.jboss42.InvocationHandlerEJB21.getMBeanInvocation(InvocationHandlerEJB21.java:169)
            at org.jboss.wsf.container.jboss42.InvocationHandlerEJB21.invoke(InvocationHandlerEJB21.java:144)
            at org.jboss.ws.core.server.ServiceEndpointInvoker.invoke(ServiceEndpointInvoker.java:221)
            at org.jboss.wsf.stack.jbws.RequestHandlerImpl.processRequest(RequestHandlerImpl.java:466)
            at org.jboss.wsf.stack.jbws.RequestHandlerImpl.handleRequest(RequestHandlerImpl.java:284)
            at org.jboss.wsf.stack.jbws.RequestHandlerImpl.doPost(RequestHandlerImpl.java:201)
            at org.jboss.wsf.stack.jbws.RequestHandlerImpl.handleHttpRequest(RequestHandlerImpl.java:134)
            at org.jboss.wsf.stack.jbws.EndpointServlet.service(EndpointServlet.java:84)
            at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
            at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
            at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
            at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)
            at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
            at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
            at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:230)
            at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
            at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:182)
            at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:524)
            at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:84)
            at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
            at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
            at org.apache.catalina.authenticator.SingleSignOn.invoke(SingleSignOn.java:393)
            at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
            at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:262)
            at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
            at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
            at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:446)
            at java.lang.Thread.run(Thread.java:619)
Caused by: org.jboss.ws.core.binding.BindingException: org.jboss.ws.core.jaxrpc.binding.jbossxb.UnmarshalException: Failed to parse source:
Failed to resolve target property type on org.jboss.xb.binding.sunday.unmarshalling.ElementBinding@1369863({http://foo/newsws/t
ypes}attachment, type={http://foo/newsws/types}AttachmentElementType)
        at org.jboss.ws.core.jaxrpc.binding.JBossXBDeserializer.deserialize(JBossXBDeserializer.java:111)
        at org.jboss.ws.core.jaxrpc.binding.JBossXBDeserializer.deserialize(JBossXBDeserializer.java:62)
        at org.jboss.ws.core.binding.DeserializerSupport.deserialize(DeserializerSupport.java:60)
        at org.jboss.ws.core.soap.XMLContent.unmarshallObjectContents(XMLContent.java:180)
        ... 36 more
Caused by: org.jboss.ws.core.jaxrpc.binding.jbossxb.UnmarshalException: Failed to parse source: Failed to resolve target property type on or
g.jboss.xb.binding.sunday.unmarshalling.ElementBinding@1369863({http://foo/newsws/types}attachment, type={http://foo/newsws/types}AttachmentElementType)
        at org.jboss.ws.core.jaxrpc.binding.jbossxb.JBossXBUnmarshallerImpl.unmarshal(JBossXBUnmarshallerImpl.java:65)
        at org.jboss.ws.core.jaxrpc.binding.JBossXBDeserializer.deserialize(JBossXBDeserializer.java:103)
        ... 39 more
Caused by: org.jboss.xb.binding.JBossXBException: Failed to parse source: Failed to resolve target property type on org.jboss.xb.binding.sun
day.unmarshalling.ElementBinding@1369863({http://foo/newsws/types}attachment, type={http://foo/newsws/types}Attach
mentElementType)
        at org.jboss.xb.binding.parser.sax.SaxJBossXBParser.parse(SaxJBossXBParser.java:179)
        at org.jboss.xb.binding.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:126)
        at org.jboss.ws.core.jaxrpc.binding.jbossxb.JBossXBUnmarshallerImpl.unmarshal(JBossXBUnmarshallerImpl.java:61)
        ... 40 more
Caused by: org.jboss.ws.WSException: Failed to resolve target property type on org.jboss.xb.binding.sunday.unmarshalling.ElementBinding@1369
863({http://foo/newsws/types}attachment, type={http://foo/newsws/types}AttachmentElementType)
        at org.jboss.ws.extensions.xop.jaxrpc.JBossXBContentAdapter.beforeSetParent(JBossXBContentAdapter.java:115)
        at org.jboss.xb.binding.sunday.unmarshalling.SundayContentHandler.endElement(SundayContentHandler.java:1005)
        at org.jboss.xb.binding.sunday.unmarshalling.SundayContentHandler.endElement(SundayContentHandler.java:246)
        at org.jboss.xb.binding.parser.sax.SaxJBossXBParser$DelegatingContentHandler.endElement(SaxJBossXBParser.java:296)
        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
        at org.apache.xerces.xinclude.XIncludeHandler.endElement(Unknown Source)
        at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
        at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
        at org.jboss.xb.binding.parser.sax.SaxJBossXBParser.parse(SaxJBossXBParser.java:175)
        ... 42 more 
```

这是 webservices.xml

```
<webservice-description>
    <webservice-description-name>FooService</webservice-description-name>
    <wsdl-file>META-INF/wsdl/FooService.wsdl</wsdl-file>
    <jaxrpc-mapping-file>META-INF/FooService-mapping.xml</jaxrpc-mapping-file>
    <port-component>
        <port-component-name>FooService</port-component-name>
        <wsdl-port>FooServicePort</wsdl-port>
        <service-endpoint-interface>com.foo.FooServiceEndpoint</service-endpoint-interface>
        <service-impl-bean>
                <ejb-link>FooServiceBean</ejb-link>

        </service-impl-bean>
    </port-component>
</webservice-description> 
```

从 foo.xsd

```
<xs:complexType name="AttachmentElementType">
        <xs:annotation>
            <xs:documentation>Attachment data. When submitting, contains the attachment itself.</xs:documentation>
        </xs:annotation>
        <xs:simpleContent>
            <xs:extension base="xs:base64Binary">
                <xs:attribute name="filename" use="required">
                    <xs:annotation>
                        <xs:documentation>The filename of the attachment</xs:documentation>
                    </xs:annotation>
                </xs:attribute>
                <xs:attribute name="href" type="xs:anyURI" use="optional">
                    <xs:annotation>
                        <xs:documentation>The URL from which the attachment can be downloaded. Not used when submitting news.</xs:documentation>
                    </xs:annotation>
                </xs:attribute>
                <xs:attribute name="mimeType" type="xs:string" use="required">
                    <xs:annotation>
                        <xs:documentation>The MIME type of the attached file</xs:documentation>
                    </xs:annotation>
                </xs:attribute>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType> 
```

来自 FooService-mapping.xml

```
<java-xml-type-mapping>
      <java-type>foo.MessageElementType</java-type>
      <root-type-qname xmlns:typeNS='http://foo/newsws/types'>typeNS:MessageElementType</root-type-qname>
      <qname-scope>complexType</qname-scope>
      <variable-mapping>
       <java-variable-name>category</java-variable-name>
       <xml-element-name>category</xml-element-name>
      </variable-mapping>
      <variable-mapping>
       <java-variable-name>type</java-variable-name>
       <xml-element-name>type</xml-element-name>
      </variable-mapping>
      <variable-mapping>
       <java-variable-name>headline</java-variable-name>
       <xml-element-name>headline</xml-element-name>
      </variable-mapping>
      <variable-mapping>
       <java-variable-name>body</java-variable-name>
       <xml-element-name>body</xml-element-name>
      </variable-mapping>
      <variable-mapping>
       <java-variable-name>attachment</java-variable-name>
       <xml-element-name>attachment</xml-element-name>
      </variable-mapping>
      <variable-mapping>
       <java-variable-name>field</java-variable-name>
       <xml-element-name>field</xml-element-name>
      </variable-mapping>
     </java-xml-type-mapping> 
```

Attachment.java 看起来像这样：

```
public class  AttachmentElementType
{

protected java.lang.String filename;

protected java.net.URI href;

protected java.lang.String mimeType;

protected byte[] _value;
public AttachmentElementType(){}

public AttachmentElementType(java.lang.String filename, java.net.URI href, java.lang.String mimeType, byte[] _value){
this.filename=filename;
this.href=href;
this.mimeType=mimeType;
this._value=_value;
}
public java.lang.String getFilename() { return filename ;}

public void setFilename(java.lang.String filename){ this.filename=filename; }

public java.net.URI getHref() { return href ;}

public void setHref(java.net.URI href){ this.href=href; }

public java.lang.String getMimeType() { return mimeType ;}

public void setMimeType(java.lang.String mimeType){ this.mimeType=mimeType; }

public byte[] get_value() { return _value ;}

public void set_value(byte[] _value){ this._value=_value; }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T20:54:28.237

通过将服务重新实现为带有 JAX-WS 注释的 web 服务，遵循相同的结构并使用相同的业务逻辑来解决这个问题。不好玩，但它奏效了。

# smtp - 捕获失败邮件

> ID：585052
> 
> 赞同：0
> 
> 时间：2009-02-25T07:30:15.190
> 
> 标签：smtp

是否可以捕获失败邮件。我创建了一个发送邮件的应用程序，我有一个日志文件来存储发送的邮件。如果发送邮件失败，我只想找出失败邮件并更新日志文件。

是否可以！有没有办法匹配发送的邮件和失败的邮件

请帮助我并指导我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T07:42:06.537

如果您的意思是失败，退回的电子邮件，您可以将电子邮件地址添加到“返回路径”标题。如果电子邮件被退回，它将被退回到返回路径中指定的电子邮件地址。然后，您可以设置服务来分析这些电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T07:42:22.870

您必须指定您使用的是什么客户端，是 Postfix、sendmail 等吗？你所说的“失败”是什么意思。

基本方法是使用 crontab。它可以在失败时将错误消息直接发送到您的电子邮件

```
MAILTO=youremail@foo.net
#
# run five minutes after midnight, every day
5 0 * * $HOME/bin/emailcode 
```

如果您使用 sendmail，您始终可以在以下位置验证日志：

```
/var/log/maillog 
```

# .net - 从 gac 加载 dll 会阻止应用程序

> ID：585057
> 
> 赞同：1
> 
> 时间：2009-02-25T07:37:49.277
> 
> 标签：.net, wpf, gac, xbap

在过去的几个月里，我的申请变得越来越大。目前它可以作为 Wpf .EXE 和 XBAP 运行，两者共享相同的代码。在应用程序的几个点，应用程序锁定。经过调查后，我发现应用程序此时正在从 GAC 加载 dll。

发生的情况是应用程序启动，这需要几秒钟，然后用户会看到一个登录屏幕。目前，用户单击确定按钮登录应用程序锁定，因为它必须为应用程序的其余部分加载各种 dll。因为它们是从 UI 线程加载的，所以所有动画都停止播放，因此 OK 按钮的鼠标悬停没有完成。

它从几秒钟开始，但在某些时候，您必须等待几分钟才能继续应用。我认为这无可厚非。

有没有办法将 dll 的加载从 GAC 移动到另一个线程？那么“请稍候，正在加载应用程序”-动画可以播放吗？或者，更好的是，我可以将加载所需的所有 dll 移至应用程序的启动，因此工作时等待的时间会更少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T07:41:42.463

是的（至少“秒”；不确定它是否缩放到“分钟”）- 在登录屏幕上，只需启动一个工作线程（可能使用`ThreadPool`）来执行需要这些程序集的操作。这将导致他们加载...

```
ThreadPool.QueueUserWorkItem(LoadAssemblies);
...
static void LoadAssemblies(object state)
{
    Widget1 widget = new Widget1(); // but just let it go (perhaps dispose it)
} 
```

您现在离开 UI 线程，在用户键入密码时加载程序集。

# c# - 从 Windows 服务调用 aspx 页面 - 问题

> ID：585064
> 
> 赞同：0
> 
> 时间：2009-02-25T07:43:12.837
> 
> 标签：c#, windows-services, timer

我有一个在一定时间间隔后调用页面的 Windows 服务。该页面反过来创建一些报告。问题是该服务在 2-3 次调用后停止执行任何操作。因为它调用页面 2-3 次，然后没有做任何工作，尽管它显示服务正在运行......我在我的服务中使用计时器..请有人在这里帮助我解决方案谢谢

代码：（其中 t1 是我的计时器）

```
protected override void OnStart(string[] args)
    {
            GetRecords();
            t1.Elapsed += new ElapsedEventHandler(OnElapsedTime);

            t1.Interval = //SomeTimeInterval
            t1.Enabled = true;
            t1.Start();

    }

    private void OnElapsedTime(object source, ElapsedEventArgs e)
    {
        try
        {
            GetRecords();
        }
        catch (Exception ex)
        {
            EventLog.WriteEntry(ex.Message);
        }

    }

    public void GetRecords()
    {

        try
        {
            string ConnectionString = //Connection string from web.config
            WebRequest Request = HttpWebRequest.Create(ConnectionString);
            Request.Timeout = 100000000;
            HttpWebResponse Response = (HttpWebResponse)Request.GetResponse();

        }
        catch (Exception ex)
        {
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T07:47:36.723

那么，代码是什么样的？`WebClient`是查询页面的最简单方法：

```
 string result;
    using (WebClient client = new WebClient()) {
        result = client.DownloadString(address);
    }
    // do something with `result` 
```

如果它停止，计时器代码也可能会出现故障......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T07:21:28.703

HttpWebRequest 可能会将并发 HTTP 请求的数量限制到特定页面或服务器，这通常是正确的 HTTP 客户端实践。

您没有正确处理对象的事实很可能意味着您正在维护到特定页面的 2 或 3 个连接，每个连接都有很大的超时值，并且 HttpWebRequest 正在排队或忽略您的请求，直到前几个完成（死于客户端或服务器超时，在这种情况下很可能是服务器）。

添加“finally”子句并正确处理您的对象！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T07:51:26.530

您请求页面的方式可能会引发未处理的异常，从而使服务处于不可操作状态。

是的，我们需要代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T07:51:38.133

我认为您在处理 StreamReader、WebRequest 等对象时遗漏了一些东西。您应该在使用它们后处理昂贵的对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-09T13:52:13.540

在服务的背景下，马克的建议对我有用

使用 WebClient 工作可靠，其中 WebRequest 超时。

@jscharf 的解释对我来说看起来和任何解释一样好。

# eclipse - 学习 Eclipse RCP 的最佳方式是什么？只有我感觉不一样吗？

> ID：585065
> 
> 赞同：3
> 
> 时间：2009-02-25T07:43:18.123
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我习惯于结构化编程（例如：C）、OO 编程（例如：Java）、脚本（例如：Javascript）、Web（例如：HTML、JSP、Servlets、CSS）等。

现在，当我开始使用 Eclipse RCP 插件开发时，整个事情在编程方面给我一种奇怪的感觉。Eclipse RCP 开发的方式与我上面提到的其他语言完全不同，老实说，我不太喜欢这个事实。

只有我有这种感觉吗？

您还有什么建议可以让我更好地过渡到 Eclipse RCP 生活？（如果感觉更好的话）。

[PS：这个](https://stackoverflow.com/questions/312461/starting-working-with-eclipse-rcp)帖子我已经看过了，教程，就是想知道如果别人的开发背景和我一样，会有什么感受！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T08:02:07.407

它可能感觉不同，因为它严重基于**[OSGI](https://stackoverflow.com/questions/16140/whats-the-best-way-to-get-started-with-osgi)**

这涉及将您的应用程序拆分为组件，这些组件通常应该具有一组职责，这些职责可以通过一组接口和类依赖项与您的应用程序的其余部分隔离开来。

> 纯粹手动识别这些依赖关系的范围可能从相当简单的设计良好的高度内聚但松散耦合的应用程序到您不熟悉的互锁源代码的噩梦。

因此，构建 RCP 应用程序需要尊重构建 OSGi 服务概念的**[白板模式](http://www.osgi.org/wiki/uploads/Links/whiteboard.pdf)**，这可能与传统的 OO 开发完全不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-18T10:55:47.803

构建 RCP 应用程序有两种主要方法
1.) 您将 RCP 用于平台功能 - SWT/启动 exe/自动更新。应用程序代码将尽可能与 RCP 约定和库隔离，以实现实际的应用程序业务功能。
2.) 你的应用完全沉浸在 RCP 中。您尝试尽可能重用 RCP API

我已经尝试过选项1。在这种情况下，体验与Java开发非常相似。您可能想尝试此选项。优点是
—— SWT 很好地集成到 RCP 中。你不需要为了让它工作而陷入困境。我会在任何一天都推荐 SWT 而不是 Swing，因为对于普通程序员来说，创建响应式和原生感觉的 SWT 应用程序非常容易，而需要 Swing 专家来创建一个像样的 Swing 应用程序
——使用客户端应用程序，能够自动-update 非常有用。Eclipse 自动提供此功能。

您还需要学习的 RCP 内容有：
-- Eclipse 类加载器是如何工作的。这是为了确保您可以以正确的方式从 jar 中显式加载资源 [注意：这并不简单]
——您需要将 JVM 与应用程序一起打包。并在启动时使用相对命名约定调用 JVM

# asp.net - ASP.NET 2.0 将样式动态添加到控件中的页面

> ID：585070
> 
> 赞同：6
> 
> 时间：2009-02-25T07:47:54.227
> 
> 标签：asp.net, custom-server-controls

我需要从自定义控件中添加到页面。我不能使用样式表 (.css)，因为我使用的是 url(...) 并且需要解析 url。

现在我正在做：

```
Page.Header.Controls.Add(new LiteralControl("<style type='text/css'>.xyz { color: blue; }</style>")); 
```

但我希望有一些更优雅的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T08:01:42.493

我想这不是解决问题的坏方法。如果你有一个*外部样式表文件*，这段代码就可以完成工作：

```
HtmlLink cssRef = new HtmlLink();
cssRef.Href = "styles/main.css";
cssRef.Attributes["rel"] = "stylesheet";
cssRef.Attributes["type"] = "text/css";
Page.Header.Controls.Add(cssRef); 
```

另一个想法是编写**你自己的 ASP.NET ServerControl** “HtmlInlineStyle”，所以你可以这样调用它（脚本标签将由你的服务器控件完成）：

```
Page.Header.Controls.Add(
   New HtmlInlineStyle(".xyz { width:300px;padding-left:10px }"); 
```

此[博客条目](http://www.west-wind.com/WebLog/posts/158367.aspx)和评论显示了一些替代方案 (ScriptManager.RegisterClientScriptBlock)。但在我看来，你的解决方案是可以的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T09:23:30.690

这是另一种方式......例如：

父 ASPX 部分：

```
<div id="div1" class="xyz" style="width: 40px; height: 40px;">
    <span>abc</span>
</div> 
```

在控制范围内：

```
Dim xyzStyle As New Style()
xyzStyle.CssClass = "xyz"
xyzStyle.BackColor = Drawing.Color.LightBlue
Page.Header.StyleSheet.CreateStyleRule(xyzStyle, Nothing, ".xyz") 
```

请注意，这假定父 ASPX 页面具有为目标控件设置的类属性。如果没有，那么您将需要使用 MergeStyle 方法将样式与控件*合并。*（这要求控制是`runat="server"`）。

此代码呈现以下输出：（为方便起见，显示整个源代码）

```
<html>
<head>
  <title>Untitled Page </title>
  <style type="text/css">
    .xyz { background-color:LightBlue; }
  </style>
</head>
<body>
  <form name="form1" method="post" action="MyPage.aspx" id="form1">
    <div id="div1" class="xyz" style="width: 40px; height: 40px;">
      <span>abc</span>
    </div>
  </form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-07T06:18:20.643

我创建自己的类并继承 Style，并使用我自己的字典来查找默认 Style 类不包含的属性。这是一个简短的例子......

```
 protected override void FillStyleAttributes(CssStyleCollection attributes, IUrlResolutionService urlResolver)
    {
        Dictionary<String, String> _styles = new Dictionary<string, string>();
        _styles.Add("display", "inline-block");
        foreach (String s in _styles.Keys)
        {
            attributes[s] = (String)_styles[s];
        }
        base.FillStyleAttributes(attributes, urlResolver);
    } 
```

# c# - 用户界面设计工具

> ID：585071
> 
> 赞同：10
> 
> 时间：2009-02-25T07:48:16.410
> 
> 标签：c#, java, user-interface

我正在寻找一种用户界面设计工具来可视化文档中可能的 GUI。我*不能*生成代码。我知道 Microsoft Visio 提供了一项功能。但是还有其他选择吗？

**您使用哪种软件来可视化 GUI？**

PS。另一个著名的工具是[铅笔项目](http://www.evolus.vn/Pencil/Home.html)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T07:51:39.570

一个很棒且简单的方法是 balsamiq：[http ://www.balsamiq.com/](http://www.balsamiq.com/)

我也很喜欢Axure。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T07:56:16.593

看看 Firefox [Pencil Extension](https://addons.mozilla.org/en-US/firefox/addon/8487)，它是一个用于 GUI 原型设计和简单草图绘制的基本工具....

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-30T14:16:16.133

我在此发布基于我作为 UX 设计师/信息架构师 10 年经验的建议摘要。原始文章可以在这里找到：

[最好的原型工具？Axure、Justinmind 和其他 UX 工具的评论] ( [http://www.humaneinterface.net/best-prototyping-tools/](http://www.humaneinterface.net/best-prototyping-tools/) )

随着界面变得越来越动态，交互式原型是提供深入、上下文和响应式文档的最佳方式。如果您是专业设计师，我建议您使用Axure **RP Pro**或**Justinmind Prototyper**来制作静态、低保真原型和更复杂的交互式原型。两者都提供相当实惠的许可证。

如果您不是专业设计师，并且您正在寻找一种便宜且允许偶尔创建静态线框的工具，我建议您将**Moqups**作为快速原型制作工具。我更喜欢它而不是**Balsamiq**。**WireframeSketcher**也是一个有趣的替代方案。

如果您正在寻找不像 Axure/Justinmind 那样复杂但比 Moqups/Balsamiq 更强大的东西，您还可以考虑 Infragistics 的**Indigo Studio**（它可以从 Balsamiq 导入静态模型并使其具有交互性）和 Protoshare。他们俩，尤其是 Indigo Studio，都提供了不太方便的价格计划，考虑到功能有限，我不建议将它们作为首选。第三个选项是**UXpin**，它拥有迄今为止我所见过的最优雅、干净和用户友好的界面，在当今可用的 UX 工具的整个领域中。

对于移动原型，如果你想要完全控制，你可以同时使用 Axure 和 Justinmind，在撰写本文时，第二个似乎是更好的选择（尽管我没有直接测试它）。如果您正在寻找一种简单的方法来构建不太复杂的原型，您可以考虑上面提到的 Indigo Studio，或者更实惠的**Proto.io**。

如果您的客户是一个可以负担得起非常昂贵的许可证的组织，您还可以考虑**iRise**，这是一个非常全面的企业设计平台。

如果您需要设计静态图表来表示用户旅程，您可能会考虑使用**Draw.io**或**LucidChart**等工具，但 Axure 仍然提供了可以引用原型部分的不错的图表工具。Justinmind 似乎有点局限。**如果您需要最大的灵活性并想要绘制非常优雅的流程图， Microsoft Visio**（现在作为 Web 应用程序的 Office 365 的一部分，因此也可以在 Mac 上使用）仍然很棒。

密切关注**JQuery UI 组件**，即使您不打算将 javascript 库合并到您的原型中。如果您喜欢直接编码，但不一定需要重用代码，您还可以考虑将 CSS 框架与 Jetstrap 等 WYSIWYG 编辑器结合使用。

用纸玩折纸而不是原型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T08:41:11.073

您可能想查看 Joel 的文章[The Iceberg Secret, Revealed](http://www.joelonsoftware.com/articles/fog0000000356.html)以及[文章讨论](http://discuss.fogcreek.com/joelonsoftware/default.asp?cmd=show&ixPost=3676)。

我不知道这是否与您的任务相关，但自从阅读它后，如果我想将它呈现给客户，我肯定更喜欢使用 UI 的手绘草图。（真正意义上的*“铅笔项目” ;-)*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T07:54:48.127

如果您在 Linux 中，您可能会尝试[Glade](http://glade.gnome.org/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T08:02:01.993

看看这个问题的答案中提到的工具：

[面向非程序员的原型设计工具 - 表达式？](https://stackoverflow.com/questions/517324/prototyping-tools-for-non-programmers-expression)

我仍然推荐[Balsamiq Mockups](http://www.balsamiq.com/products/mockups)。生成的 GUI 模型看起来像草图，使其成为传达这不是最终的 GUI，而仅仅是 GUI 概念的可视化的想法的绝佳工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T07:52:31.893

“不得”似乎很奇怪……如果您使用 IDE 设计器来丢弃一些控件，但不*使用*代码，这就足够了吗？

或者使用“[混合](http://www.microsoft.com/expression/products/Overview.aspx?key=blend)” - 生成 xaml，这*只是*布局 - 没有代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-11T14:24:04.810

[justinmind 原型机](http://www.justinmind.com/)可能适合您。它为您提供了一个 HTML 来检查界面的工作方式。

# .net - LINQ 查询将数据插入数据库

> ID：585080
> 
> 赞同：6
> 
> 时间：2009-02-25T07:52:57.710
> 
> 标签：.net, linq

在我的数据库中，我有一个名为 Student 的表，有 3 列（SNo、SName、Class）。

我只想插入 SName 的值。

谁能告诉我如何为此编写 LINQ 查询。

谢谢，巴拉特。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T07:55:56.330

你的意思是你只想*查询*名字吗？在这种情况下：

```
var names = ctx.Students.Select(s=>s.Name); 
```

或在查询语法中：

```
var names = from s in ctx.Students
            select s.Name; 
```

要*插入*，您需要创建许多`Student`对象 - 设置名称但不设置其他属性，并将它们添加到上下文中（并提交）。LINQ 是一个*查询*工具（因此是 Q）；插入当前是面向对象的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-25T08:08:32.603

你在使用 Linq-to-SQL 吗？是否要在仅指定名称时插入新记录？

如果是这样，这大致是它在 C# 中的完成方式。

```
using (StudentDataContext db = new StudentDataContext())
{
    Student newStudent = new Student();
    newStudent.SName = "Billy-Bob";
    db.Students.InsertOnSubmit(newStudent);
    db.SubmitChanges();
} 
```

# php - 表单提交问题

> ID：585082
> 
> 赞同：0
> 
> 时间：2009-02-25T07:55:32.323
> 
> 标签：php, javascript, ajax, cross-browser

我有一个可以在 mozilla 和 IE 上完美运行的表单，但是在 google chrome 上存在一个小问题，我正在使用 ajax 提交我的表单，即没有提交按钮，在 IE 和 Mozilla 中它工作正常，但在 google chrome 中当我按下输入表单提交并且页面重定向到主页（这是ajax中的另一个问题页面刷新操作）如何在按下输入按钮时停止页面提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T08:11:13.250

每个事件都有其默认操作（单击按钮，超链接会将您带到某个地方），在您的情况下，表单元素上的 ENTER 将提交表单。可以防止此类行为。浏览器与其实现不同，以防止这种默认操作，但 jQuery 或 MooTools 等工具可以帮助您解决这个问题。

可以在此处找到有关如何进行的明确详细信息：

[http://www.quirksmode.org/js/events_early.html#link4](http://www.quirksmode.org/js/events_early.html#link4)

想法是在表单元素上编写一个 onsubmit 处理程序，如下所示：

```
<form id="foo" onsubmit="doYourAjaxThing(); return false"> 
```

或者通过 javascript 将事件侦听器附加到您的表单并执行以下操作（jQuery 语法）：

```
$("foo").submit(function(event){
 doYourAjaxThing()      
 event.preventDefault();
}); 
```

[http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29](http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T07:57:02.257

从提交表单的函数返回 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-16T21:40:38.793

```
$("input").keypress(function (e) {
    if (event.keyCode == 13) {
        //Put whatever you would rather happen here........
        return false;    //this cancels the SUBMIT action
    }
}); 
```

祝你好运，帕特里克

# oracle - 如何在 Oracle 中实现条件更新？

> ID：585090
> 
> 赞同：11
> 
> 时间：2009-02-25T07:57:38.667
> 
> 标签：oracle, oracle10g

我是 oracle 新手，我的一个 SQL 查询有问题。

有 2 个用户：`User1`和`User2`：

```
     选项卡 1 选项卡 2
    -------- --------

    EmpNo EmpNo
    企业名称 企业名称
    联系没有薪水
    地点    

```

User2拥有User1.Tab1中的所有权限，两个表之间没有外键关系。

### 问题：

我想在 tab2 " `NameDesignation`" 中添加一列，并且在检查以下条件后我想在此列中插入值：

```
WHEN User1.Tab1.EmpNo = User2.Tab2.EmpNo THEN
   INSERT INTO Tab2 VALUES (&designation) 
```

我真的不知道该怎么做，希望能得到一点帮助。有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T08:23:06.187

尝试这个：

```
update user2.tab2.empno t2
set NameDesignation= &designation
where exists (select ''
              from user1.tab1 t1
              where t1.empno=t2.empno) 
```

（声明已更新以匹配已编辑的问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T13:45:17.893

你需要一组触发器，

插入或更新后：

```
CREATE OR REPLACE TRIGGER tab1_after_changed
AFTER INSERT OR UPDATE
    ON tab1
    FOR EACH ROW

BEGIN
    DELETE FROM User2.Tab2 WHERE EmpNo=:NEW.EmpNo;
    INSERT INTO User2.Tab2(EmpNo,EmpName,NameDesignation) 
        VALUES (:NEW.EmpNo,:NEW.EmpName, (SELECT DesignationName FROM Designation where DesignationID=:NEW.DesignationID));
END; 
```

我只是想象一个带有 Designation（DesignationID 编号，DesignationName varchar2(xx)）的表，并且 Tab1 具有 DesignationID（编号）。

# msbuild - 使用 xcopy 将文件从多个目录复制到一个目录

> ID：585091
> 
> 赞同：17
> 
> 时间：2009-02-25T07:58:12.003
> 
> 标签：msbuild, exec, xcopy

是否可以使用 xcopy 仅使用一个 xcopy 命令将文件从多个目录复制到一个目录中？

假设我有目录树

根\源\Sub1\Sub2

我想将所有 .xml 文件从目录 root\Source 包括子文件夹复制到 root\Destination。我不想复制文件夹结构，只复制文件。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-25T08:43:12.863

正如 DandDI 所说，您不需要 xcopy。for 语句有很大帮助。但是，您也不需要说明 dir 命令的过程结果，此命令有助于更好

```
for /R c:\source %f in (*.xml) do copy "%f" x:\destination\ 
```

顺便说一句，当您从批处理文件中使用它时，您需要在变量 %f 前面添加备用 % 因此您的命令行应该是；

```
for /R c:\source %%f in (*.xml) do copy %%f x:\destination\ 
```

当您在批次中使用它时

*   应该用双引号括起来 %f 否则它将无法复制带空格的文件名

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T08:10:20.913

你不需要 xcopy 。您可以获得所需的所有文件的列表并以这种方式执行复制。

例如在 windows xp 命令提示符下：

```
for /f "delims==" %k in ('dir c:\source\*.xml /s /b') 复制 "%k" x:\destination\

```

/s 进入所有子目录，而 /b 仅列出文件名和路径。每个文件依次分配给 %k 变量，然后复制命令将文件复制到目标。唯一的技巧是确保目标不是源的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T23:17:39.077

我认为这个问题的答案是“如何将所有小子目录中的所有文件收集到一个目录中”是下载一个名为 XXCOPY 的软件。这可以通过 XXCOPY.COM 免费获得，幸运的是有一个免费的非商业版本。XXCOPY.COM 帮助工具上的常见问题之一实际上是“如何将我的所有文件收集到一个目录中”，它会告诉您使用哪个开关。XXCOPY 是一种万无一失的方法，它包含在一个 .zip 存档中，因此解压缩它可能不是那么简单，但也不是特别困难。ZipGenius.it 网站上有一个名为 ZipGenius 的解压缩程序，所以可能在你下载 XXCOPY 之前下载 ZipGenius 然后它是一个 smallpart smalltime double wammy(!)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-11T07:01:42.157

可能不是确切的答案，但如果有人想在不编码的情况下这样做。

您可以在特定文件夹中搜索项目的名称，然后您可以复制结果并稍后将其粘贴到所需的文件夹中。它会将同一个文件重命名为我认为作为前缀的文件夹，然后是重复的名称。

# linux - 除了 Valgrind 之外，还有什么工具可以监控 Linux 中正在运行的进程的内存使用情况？

> ID：585095
> 
> 赞同：3
> 
> 时间：2009-02-25T07:59:47.960
> 
> 标签：linux, memory-management

[This answer](https://stackoverflow.com/questions/301576/how-do-i-tell-valgrind-to-memcheck-forked-processes/301587#301587) to [this question](https://stackoverflow.com/questions/301576/how-do-i-tell-valgrind-to-memcheck-forked-processes/)表示无法将 Valgrind 附加到已经运行的进程。
是否有任何其他适用于 Linux 的工具可以报告内存使用情况但可以附加到已经运行的进程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T08:16:49.917

您可以使用[ps_mem.py 之](http://www.pixelbeat.org/scripts/ps_mem.py)`pmap`类的工具来获取有关正在运行的进程的内存使用的更多详细信息，而不是从. 您不会从 Valgrind 获得所有花哨的功能，例如检测内存泄漏等。`top`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T08:04:16.403

所有应用数据都应该在

```
/proc/<PID>/ 
```

# .net - 在 n 层应用程序中，我应该将哪种类型的对象绑定到我的 WPF 表单？

> ID：585097
> 
> 赞同：3
> 
> 时间：2009-02-25T08:00:37.520
> 
> 标签：.net, wpf, data-binding, linq-to-entities, n-tier-architecture

我目前正在使用 C# 中的一个小型 N 层应用程序，它使用 Linq-to-Entities（用于 DB 的 SQL Express 2005）和 WPF，我想知道我的业务逻辑层应该向用户界面提供什么类型的数据收集.

将诸如 datagridviews 之类的表单对象绑定到 IQueryable 是否有缺点（性能、验证等）？我应该填充内存中的 DataTable 并将其传递给 UI 吗？DataContext应该在哪一层初始化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T08:13:38.520

要添加到 Marc 的列表中，您可能还想查看`ObservableCollection<T>`。

编辑：ObservableCollections 通常用于 MVVM 模式，请在[此处](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)阅读以查看一些示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T08:10:11.850

你不能正确地绑定到一个`IQueryable<T>`（除了在 ASP.NET 中`IEnumerable<T>`很好的地方）——理想情况下它需要一个可重复的对象列表。使用`DataTable`是违反直觉的。你只需要一个`List<T>`/`BindingList<T>`等；IE

```
var qry = ...;
var list = qry.ToList(); 
```

现在`list`用作绑定源。

IMO，数据上下文将[隐藏在存储库接口后面](http://marcgravell.blogspot.com/2009/02/pragmatic-linq.html)，但您的里程可能会有所不同。

# jquery - jQuery 头部刮刀

> ID：585101
> 
> 赞同：1
> 
> 时间：2009-02-25T08:01:52.853
> 
> 标签：jquery

我有一些 jQuery 代码，通过打开单选输入的父元素（一个 div）的边框来突出显示哪个单选按钮被选中。单选按钮都有 class="colors"，所以我的选择器是“input.colors:checked”。

问题是页面加载时它没有打开边框。为了调试，我将相同的语句放在悬停事件中，它确实有效。

我认为 jQuery ready() 函数会在文档 HTML 完全加载后运行，那么为什么在 read() 运行时似乎未选中单选按钮，但稍后在我执行悬停时会检查单选按钮？

这段代码应该工作，还是我错过了什么？

我正在使用 jQuery 1.3.1 和 Firefox 3.0.6。

（另外：我可以在 Firebug 中调试它吗？？）

这是代码：

```
$(document).ready(function(){
// This one does NOT work.  No red border when the page loads.
$("input.colors:checked").parent().css({border:'2px solid red'});

$("div.color_choice").hover(
      function(){
           // BUT, this one works!  
           // When I hover over an unrelated div, the red border appears
           // (this line is here only for debugging)
           $("input.colors:checked").parent().css({border:'2px solid red'}); 
      },
      function(){
      }
   );

   ... 
```

**更新：** 好的，果然这是一个愚蠢的错误。我在其他地方有另一个 jQuery 语句，它在页面加载时将边框设置回白色。盯着这个烧了几个小时。今天敲键盘的时间太多了。感谢您的回复 - 让我朝着正确的方向前进！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T08:21:13.413

对我有用。我猜你在其他地方有一个错误导致你的脚本中断。Firebug 是你的朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T08:27:31.760

> **试试这个**

```
$(document).ready(function() {
  $("input.colors:checked").parent().css({
    border: '2px solid red'
  });
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div><input class="colors" type="checkbox" checked="checked" /></div>
<div><input class="colors" type="checkbox"></div>
```

# .net - vb.net 中的组合框

> ID：585103
> 
> 赞同：0
> 
> 时间：2009-02-25T08:02:05.457
> 
> 标签：.net, vb.net, data-binding, combobox

如何根据 vb.net 中另一个组合框中的选定项目隐藏或禁用一个组合框中的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T08:05:13.843

在第一个的选定索引更改事件中操作第二个组合框的数据源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T08:14:40.590

正如 gerrie 所说，您必须在第二个组合框选择索引更改事件中创建一个条件，如下所示：

```
Private Sub ComboBox1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ComboBox1.SelectedIndexChanged
    If ComboBox1.SelectedValue = "my Value" Then
        ComboBox2.Visible = False
    End If
End Sub 
```

其中“我的价值”是我在 combobox1 中的价值

编辑 ：

除非您清除它们，否则组合框会保留插入的值。通过使用这行代码

```
ComboBox2.Items.Clear() 
```

或者，您将值放在像 Datatable 这样的列表中，并指向该特定 Datatable 的组合框数据源

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T17:18:44.330

我只是想解决这个问题。事实证明，当我清除 ComboBox 中的项目并将所选索引设置为 -1 时，它抛出了一个无法找到所选索引的异常。我的解决方案如下：

```
using System.Web.UI.WebControls;

namespace AjaxControlToolkit.Extensions
{
    public static class ComboBoxExtension
    {
        public static void ForceClearSelectedIndex(this AjaxControlToolkit.ComboBox comboBox)
        {
            if (comboBox.Items.Count > 0)
                comboBox.Items.Clear();
            comboBox.Items.Add(new ListItem(string.Empty, string.Empty));
            comboBox.Text = string.Empty;
        }
    }
} 
```

然后在第一个组合框的 ItemInserted 事件或选定的索引/文本更改事件中，您可以简单地调用：

```
ComboBoxName.ForceClearSelectedIndex(); 
```

把它们放在一起，你可以这样做：

```
protected void tbxCustomerName_TextChanged(object sender, EventArgs e)
    {
        if (Customers.Count > 0)
        {
            var datasource = Devices.Where(d => d.Customer.FullName == tbxCustomerName.SelectedItem.Text);
            tbxDeviceName.DataSource = datasource;
            tbxDeviceName.DataTextField = "Name";
            tbxDeviceName.DataValueField = "Device_ID";
            tbxDeviceName.DataBind();
        }
        else
        {
            tbxDeviceName.ForceClearSelectedIndex();
        }
    } 
```

不在 VB 中，但您可以轻松转换它。

# c - 提交写入

> ID：585107
> 
> 赞同：0
> 
> 时间：2009-02-25T08:03:18.527
> 
> 标签：c, windows, windows-xp

我在 C 中使用 fopen fread fwrite 对 win32 进行编程。

如何强制 Windows 将数据写入磁盘？比 API 调用吗？

我有一个程序必须绝对确保在将数据保存到另一个索引文件之前将其保存到磁盘，否则如果发生崩溃，索引文件有时可以更新，但另一个文件不会导致严重的不一致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T08:18:53.780

每次 fwrite 后使用[fflush函数](http://www.cplusplus.com/reference/clibrary/cstdio/fflush.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T09:33:15.193

fflush() 做你想做的事。如果您决定使用 Win32 API 来执行文件 IO 而不是 C STDIO 库，则将 FILE_FLAG_WRITE_THROUGH 标志提供给 CreateFile()，这正是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:06:59.813

请参阅[_commit](http://msdn.microsoft.com/en-us/library/17618685(VS.80).aspx)函数。也在[这个其他 MSDN 页面上](http://msdn.microsoft.com/en-us/library/aa246717(VS.60).aspx)。这仅适用于 _open 和其他功能，所以请参阅[这篇文章](http://support.microsoft.com/kb/148505)- 您可以将您的程序链接`commode.obj`到导致`fflush`提交到磁盘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T08:22:14.597

请注意，您使用的任何功能都不会让您免于停电或硬重置。硬盘很聪明，可以报告写入已经完成，即使它们刚刚将数据放入缓存并且没有实际将其写入表面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-18T08:41:46.827

请参阅[此存档的知识库文章。](https://jeffpar.github.io/kbarchive/kb/066/Q66052/)

当您最初使用 fopen 打开文件时，将“c”模式选项作为最后一个选项：

```
fopen( path, "wc") // w - write mode, c - allow immediate commit to disk 
```

然后当你想强制刷新到磁盘时，调用

```
_flushall() 
```

我们在打电话之前打了这个电话

```
fclose() 
```

写入没有持久化到磁盘的问题给我们带来了真正的问题，直到我们发现了这种方法。

从上面的网站：

*“Microsoft C/C++ 7.0 版为 fopen() 函数引入了“c”模式选项。当应用程序打开文件并指定“c”模式时，运行时库将文件缓冲区的内容写入磁盘应用程序调用 fflush() 或 _flushall() 函数。"*

# java - 一次由一位客户访问

> ID：585108
> 
> 赞同：0
> 
> 时间：2009-02-25T08:03:20.073
> 
> 标签：java

我的要求如下。

我有一个用 java 开发的 web 应用程序。

我在 html 页面中有一个链接。当第一个客户端单击 html 页面中的提交按钮时，批处理文件应该运行。

同时，当其他客户端单击提交按钮时，他应该会收到页面繁忙的消息。

如果第一个客户端单击释放按钮，则其他客户端必须能够运行批处理文件。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T08:16:31.430

单击提交按钮时设置一个标志，并在单击释放按钮时清除它。

根据您的架构，标志可以是任何东西，从代码中的布尔变量、数据库中某处的特殊条目到临时文件。

单击提交按钮时，检查标志是否已设置。如果是，则返回一条错误消息，说明该页面正忙。

在伪代码中：

```
if (flagIsSet()) {
  showPageIsBusy();
} else {
  setFlag();
  startBatchFile();
} 
```

请记住在批处理文件完成或单击释放按钮时清除标志并在`finally`块中的某个位置。

您还必须确保只有启动批处理文件的客户端才能释放它并清除标志。

正如 Avi 在评论中指出的那样，您还应该记住同步对标志的访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:52:33.350

那是一个 Singleton 或更好的 Application-Bean。这个 Bean 应该启动您长时间运行的后台任务并提供有关它的信息，例如它是否正在运行，并且可能诸如它何时开始、谁启动它以及您是否可以获得进度等信息，因此您也可以显示进度条。

如果您能告诉我们您使用的 Web 应用程序框架，我认为我们可以提供更好的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:18:54.450

伪算法：

修改批处理文件以在批处理操作之前和之后运行 servlet。

在运行批处理文件之前，设置一个 servlet 或标志来注册我正在执行的文件或数据库或会话变量，并在批处理文件完成时，设置一个 servlet 或标志来注册文件或数据库或会话变量我正在被释放

当用户单击释放按钮时，运行将释放标志的相同 servlet。

当用户提交提交按钮时，检查该标志是执行还是释放，具体取决于您提醒客户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T08:33:28.987

您可以使用 servlet 类中的一个字段（否则是一个大的 nono）作为标志。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T09:12:14.230

如果您的应用程序碰巧在多个负载平衡的服务器上运行，那么您将面临与我相同的问题 :) 我之前提交了一个关于它的问题，但不幸的是我没有得到任何回复。无论如何，您可以在此处查看我对问题的解决方案作为对[我的问题](https://stackoverflow.com/questions/560710/simple-database-based-instance-synchronization)的回答。

# tcp - 非阻塞 TCP write(2) 成功但请求未发送

> ID：585113
> 
> 赞同：1
> 
> 时间：2009-02-25T08:07:44.507
> 
> 标签：tcp, nonblocking

我看到在源接口上看不到使用 write(2) 写入非阻塞 TCP 套接字的一小组消息，也没有被目标接收。

可能是什么问题呢？应用程序有什么方法可以检测到这一点并重试？

```
while (len > 0) {
    res = write (c->sock_fd, tcp_buf, len);
    if (res < 0) {
      switch (errno) {
        case EAGAIN:
        case EINTR:
        <handle case>
        break;
        default:
        <close connection>
      }
    }
    else {
      len -= res;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T08:30:31.940

非阻塞`write(2)`意味着无论遇到什么困难，呼叫都会返回。检测发生了什么的正确方法是检查函数的返回值。

如果它返回 -1 检查`errno`。值`EAGAIN`意味着`write`没有*发生*，你必须再做一次。

它还可能返回一个短写入（即一个小于您传递给它的缓冲区大小的值），在这种情况下，您可能想要重试丢失的部分。

如果这种情况发生在短期套接字上，还请阅读[The Ultimate SO_LINGER 页面，或者：为什么我的 tcp 不可靠](http://blog.netherlabs.nl/articles/2009/01/18/the-ultimate-so_linger-page-or-why-is-my-tcp-not-reliable)。它解释了有关变速器关闭部分的特定问题。

> 当我们天真地使用 TCP 只发送我们需要传输的数据时，它通常无法完成我们想要的 - 最后的千字节或有时兆字节的传输数据永远不会到达。

结论是：

> 最好的建议是发送长度信息，并让远程程序主动确认已收到所有数据。

它还描述了针对 Linux 的 hack。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T20:48:36.757

您想了解[TCP_NODELAY](http://en.wikipedia.org/wiki/Nagle_algorithm)选项和 TCP 发送缓冲区的性质。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T08:17:51.583

write() 返回写入的字节数，这可能小于你发送的字节数，甚至为 0！确保检查并重新传输丢弃的任何内容（由于 NIC 上没有足够的缓冲区空间或其他原因）

# vb.net - 自动加载 linq2entities 中的关系

> ID：585127
> 
> 赞同：0
> 
> 时间：2009-02-25T08:16:54.487
> 
> 标签：vb.net, linq, .net-3.5, linq-to-entities

当我的模型中的两个实体之间存在关系时：

[群组成员] (*) ----- (1) [用户]

并尝试从与 LINQ 的关系中选择项目：

从 _user.GroupMember 中的实体选择实体

除非我首先使用以下语句加载关系，否则我总是得到一个空结果：

_user.GroupMember.Load()

有没有办法避免加载这样的关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:02:05.487

如果您有级联关系，则可以处理它们，`.Include("GroupMember.AnotherTable.YetAnotherTable")`这比必须进行链式 Include 调用要好一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:42:05.140

我刚刚意识到，当我从数据库加载用户时，我可以使用 Include 来加载 GroupMember 和用户，如下所示：

```
Users=from entity in db.User.Include("GroupMember") select entity 
```

但是如果我有几个关系并且可能想要访问关系上的关系，这会变得非常难看。

所以我仍在寻找更好/更好的解决方案来解决我的问题。

# php - ajax问题（页面刷新）

> ID：585128
> 
> 赞同：0
> 
> 时间：2009-02-25T08:17:32.817
> 
> 标签：php, javascript, ajax

嗨，我使用 ajax 将所有页面提取到主页中，但无法控制刷新，如果有人刷新页面返回主页，谁能给我任何解决方案，我真的很感激帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T08:28:26.627

您可以将锚点 (#something) 添加到您的 URL 并将其更改为您可以在每个 ajax 事件上解码为某些特定页面状态的内容。

然后在 body.onload 检查锚点并将其解码为某种状态。

后退按钮（至少在 Firefox 中）也可以正常工作。如果你想让后退按钮在 ie6 中工作，你应该添加一些 iframe 魔法。

检查旨在支持 ajax 环境中的后退按钮或历史记录的各种 javascript 库 - 这可能是您真正需要的。例如，jQuery[历史插件](http://plugins.jquery.com/project/history)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T13:02:25.203

我总是将“当前”状态存储在[PHP session](http://www.php.net/session)中。

所以，用户可以随时刷新，页面还是一样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:20:37.427

您可以重写当前 url，以便它指向用户所在的位置 - 有关此示例，请参阅 Facebook。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T17:11:12.813

> 如果有人刷新页面返回主页，任何人都可以给我任何解决方案

这是一项功能，而不是浏览器中的错误。您需要更改不同页面的 URL。没有什么比在客户端或服务器端使用任何魔法的网站更糟糕的了，这会导致一堆完全不同的页面使用相同的 URL。为什么？我怎么会链接到一个特定的页面？如果我喜欢某样东西并想将 URL 复制并粘贴到 IM 窗口中怎么办？

换句话说，考虑用例。什么是“页面”？例如，如果您有一个股票报价网站——每只股票是否应该有一个唯一的 URL？是的。您是否应该为可以对图形进行的每个变化（即对数与线性等）设置一个唯一的 URL？取决于 - 如果你不这样做，至少像谷歌地图一样提供“分享这个”，这样你就可以拥有某种可以分享的 URL。

话虽如此，我同意将#anchor 弄乱并解析出来的建议。可能是最优雅的解决方案。

# ssl-certificate - 为什么我们信任 SSL 证书？

> ID：585129
> 
> 赞同：22
> 
> 时间：2009-02-25T08:17:34.907
> 
> 标签：ssl-certificate

我的一个朋友问我，如果理论上每个人都可以颁发 SSL 证书，为什么我们要花这么多钱购买 SSL 证书。为什么确实如此？而我们如何判断浏览器中的小锁是否真的值得信赖呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-25T08:21:48.687

证书由称为证书颁发机构 (CA) 的东西进行加密签名，每个浏览器都有一个它隐式信任的 CA 列表。这些 CA 是拥有一组加密密钥的实体，可用于签署任何证书，通常是收费的。任何由受信任列表中的 CA 签名的证书都会锁定浏览器，因为它已被证明是“受信任的”并且属于该域。

您*可以*对证书进行自签名，但浏览器会警告您签名者不受信任，方法是在允许您进入之前显示一个大错误框，或者显示一个损坏的锁图标。

此外，即使是受信任的证书，如果用于错误的域，或者被修改为包含另一个域，也会出错。这是确保的，因为证书包括允许使用的域，并且它还具有确保其完整性的加密校验和/指纹。

目前这不是 100% 安全的，因为有可能伪造使用 MD5 的 CA 证书，请参阅此链接：[http](http://www.phreedom.org/research/rogue-ca/) ://www.phreedom.org/research/rogue-ca/ 。尽管必须指出这非常困难，因为他们利用了现有 CA 中的一个弱点，该 CA 现在可能已经关闭，也可能尚未关闭。

从本质上讲，我们信任证书就像我们信任我们的浏览器提供商知道如何选择“正确”的 CA 一样。这些 CA 仅凭借其声誉而受到信任，因为如果被发现，理论上一个失误将对他们的可信度造成非常沉重的打击。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-25T08:28:58.107

整个 CA 业务令人惊叹。我从 rapidssl.com 购买了几个证书，他们需要的所有“证明”是：

1.  我可以接收到域的邮件。
2.  我可以接电话。

就是这样。请记住，当信任浏览器中的小锁时。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-25T09:15:00.010

首先，SSL 所基于的强公钥/私钥密码学的一些背景知识：

密钥有两个部分，私有部分和公共部分。公钥可用于加密需要私钥解密的材料。这允许使用开放的通信通道进行安全通信。

公钥/私钥加密的一个重要方面是私钥可用于对可以使用公钥验证的消息进行数字签名。这使消息的接收者能够具体验证他们收到的消息是由发送者（密钥的持有者）发送的。

SSL 证书的关键是加密密钥本身可以进行数字签名。

“证书”由私钥/公钥对以及数字签名数据组成。当有人购买 SSL 证书时，他们会生成私钥/公钥并将公钥提交给证书颁发机构 (CA) 以进行签名。CA 对 SSL 证书的购买者执行适当级别的尽职调查，并使用他们的私钥签署证书。SSL 证书将绑定到特定网站或网站集，本质上是 CA，表明他们信任证书私钥的所有者是这些网站的正确所有者。

受信任 CA 的根证书（公钥和其他元数据）默认包含在主要的浏览器和操作系统中（在 Windows 中，在运行提示中键入“certmgr.msc”以查看证书管理器）。当您使用 SSL 连接到 Web 服务器时，服务器将向您发送其 SSL 证书，包括公钥和其他元数据，所有这些都由 CA 签名。您的浏览器能够通过签名和预加载的根证书来验证证书的有效性。这会在 CA 和您要连接的 Web 服务器之间创建一条信任链​​。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T08:20:37.503

因为我们必须相信某人。

受信任的 SSL 证书具有受信任机构的签名。例如，VeriSign 与 Microsoft 达成协议，他们的证书内置在您的浏览器中。因此，您可以使用 VeriSign 可信证书来信任每个页面。

这张图确实抓住了重点：

![公钥基础设施](https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Public-Key-Infrastructure.svg/300px-Public-Key-Infrastructure.svg.png)

*   RA = 注册机构
*   CA = 证书颁发机构
*   VA = 验证机构

> 粗略：用户用他的公钥在注册机构（RA）申请证书。后者向证书颁发机构 (CA) 确认用户的身份，然后颁发证书。然后，用户可以使用他的新证书以数字方式签署合同。然后，缔约方与验证机构 (VA) 核对他的身份，该验证机构再次接收有关由认证机构颁发的证书的信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T08:23:47.247

如果您没有使用一个被接受的 CA，人们在访问该站点时会收到一个消息框，谈论不受信任的证书。这无助于为网站带来流量。

锁定仅意味着站点所有者向 CA 出示了某种证明，证明他确实是他声称的那个人。如果您信任该人/网站，您必须自行判断。

这就像一个陌生人向您展示带照片的身份证。您是否更信任他，因为您确定他的名字是 John Doe？可能不是。

但是当你信任的人告诉你：“John Doe”是个好人。证明你面前的人实际上是“John Doe”，而不是你可能选择相信他。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-25T09:30:44.463

为什么？因为你花钱是为了借别人的名誉……为你担保。

这一切都是关于谁验证了你的主张是你。尽管我最近看过一些纪录片，以及经济衰退，但当他们向我确认你的身份时，我仍然更有可能相信美国企业，而不是我是俄罗斯黑手党。即使两者都可以轻松颁发证书。

您支付的金额基本上只是（他们为确保声誉和/或抑制任何安全漏洞所花费的成本）+（无论他们能够承受多大的利润作为利润百分比）。

现在进入门槛相当高，因为赢得信任真的很昂贵，所以没有太多的竞争。因此，价格可能不会很快下跌......除非索尼或通用电气等公司决定参与其中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T08:36:05.640

您为证书付费，这样当您使用 HTTPS（对于任何有点敏感的事情都应该这样做）时，您的客户不会收到严重警告，并打电话给您的支持人员说您已经感染了他们……</p>

很少有安全性，很多 FUD。

如果您有可能直接向您的客户提供您自己的证书，那就去做吧。但这是一种罕见的情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-11-20T17:42:50.053

# 让我们创建一个攻击场景。

假设**DNS 已损坏**并且[https://facebook.com/](https://facebook.com/)指向攻击者的 IP。

你坐在你的电脑前，打开 Facebook，在无意义的滚动上浪费几分钟。然后 BANG，`Certificate invalid`屏幕上显示错误。攻击者用他自己的证书签署了[https://facebook.com/](https://facebook.com/)，以确保没有人会离开他复制的 Facebook 页面，因为它没有加密，所以看起来很可疑。如果浏览器不检查证书的权限，那么攻击者可以用他的证书签署损坏的页面，你不会知道你正在连接到错误的 IP。

所以攻击者有2个选项可供选择：

1.  用他的证书签署损坏的 Facebook 页面，这样用户会看到一个错误。
2.  不要在他损坏的页面上使用 https。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T08:24:52.813

证书是建立在信任链上的，如果让任何人成为签名机构，我们就会隐含地信任每个人。不过今天有点吓人，因为有超过 200 个所谓的“受信任的权威机构”，它们的证书内置在您的浏览器中！

我知道有一个免费的 CA：[StartCom](http://cert.startcom.org/)。他们颁发免费的 SSL 证书，但它们只在 Firefox 中被接受，而不是 IE。（不确定 Safari 或 Opera）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-09-06T09:55:55.973

其他答案已经解释了 CA 系统。透视项目旨在为 SSL 部署一种新方法，您可以在其中选择信任谁：http: [//perspectives-project.org/](http://perspectives-project.org/)

# google-maps - ColdFusion.navigate 替代方案？

> ID：585133
> 
> 赞同：0
> 
> 时间：2009-02-25T08:19:37.490
> 
> 标签：google-maps, coldfusion

在另一个问题“Using Google Map with ColdFusion”中，我遇到了无法使用 CF 显示谷歌地图的问题。经过多次试验，我发现如果您使用 ColdFusion.navigate 将页面从一个 cflayoutarea 指向另一个 cflayoutarea，则目标 cflayoutarea 中的地图将不会显示。（但是，如果您只是运行页面，无论是单独运行还是在目标 cflayoutarea 内时，地图都会显示）

所以我现在的问题是：是否有另一种方法我不需要使用coldfusion.navigate 从一个cflayoutarea 导航到另一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T14:05:28.557

你的英语不是很好，所以我将转述一个（对我来说）有意义的问题并回答这个问题......

听起来您有 2 `CFLayoutArea`，并且您希望在其中一个中有一个链接（或按钮等），这将改变另一个的内容。

如果您将消除`ColdFusion.navigate`作为一种选择，那么在我看来，您将不得不尝试其他几个基本相同的选择之一。我喜欢 jQuery。如果你不喜欢 jQuery，你可以使用另一个库，或者推出你自己的解决方案，但它们都会做同样的工作。

由于这段代码：

```
<cflayout name="foo" type="hbox">
    <cflayoutarea name="nav">nav</cflayoutarea>
    <cflayoutarea name="content">content</cflayoutarea>
</cflayout> 
```

生成此 HTML：

```
<div  id="foo">
    <div  id="nav" style="overflow:auto;float:left;">
        nav
    </div>
    <div  id="content" style="overflow:auto;float:left;">
        content
    </div> 
</div> 
```

您可以通过 jQuery 使用内容 DIV 的 ID 属性来更改其内容：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $("#goLink").click(function(e){
            $("#content").load("content.cfm");
            e.preventDefault();
        });
    });
</script>
<cflayout name="foo" type="hbox">
    <cflayoutarea name="nav"><a href="#" id="goLink">go</a></cflayoutarea>
    <cflayoutarea name="content">content</cflayoutarea>
</cflayout> 
```

# visual-studio - VisualSVN - 上传多个项目的解决方案

> ID：585135
> 
> 赞同：1
> 
> 时间：2009-02-25T08:20:32.607
> 
> 标签：visual-studio, svn, visualsvn

我正在尝试上传一个包含多个项目的解决方案，但只有第一个项目被上传。当我尝试加载其他任何一个时，我收到错误*“项目无法添加到 Subversion，因为它没有工作副本”*

驱动器上的文件夹结构为：

```
c:\myprojects\thisproject\project1
c:\myprojects\thisproject\project2
c:\myprojects\thisproject\project3 
```

如何通过 VisualSVN 从 SVN 库中删除解决方案？我没有看到删除解决方案，只需添加解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T22:57:16.253

我不相信可以通过 VisualSvn 从 SVN 中删除解决方案。选项是删除或导出，只能删除，但这也会从解决方案中删除文件，在大多数情况下从硬盘驱动器中删除。VisualSvn 提供最少的 SVN 功能：更新、提交、删除和分支命令。

如果您在使用从 TortoiseSVN 导出的 svn 时遇到问题，我建议您这样做。导出会从您的解决方案中删除所有 .SVN 文件夹并将它们复制到新位置。

如果 project1 是您的 subversion 存储库的根，project2 或 project3 将不会添加到您的 subversion 存储库。

# asp.net - 什么会导致 IIS 服务的 ASPX 页面出现虚假的 404？

> ID：585141
> 
> 赞同：1
> 
> 时间：2009-02-25T08:22:06.127
> 
> 标签：asp.net, iis

我有一个相当简单的 ASP.NET 应用程序，在 Visual Studio 中设置为 Web 应用程序项目。IIS 拒绝提供一个名为“invoice.aspx”的特定 aspx 文件。我使用的 URL 绝对正确，并且该目录中的其他 aspx 页面加载并执行得很好。但不是这一页！我在 Page_Load 中设置了一个断点，以确保没有发生任何有趣的事情，但断点永远不会被击中。@Page 指令看起来不错...文件权限与目录中的其他文件相同...在构建过程中没有错误。我在这里想念什么？这让我很困惑。这是 Windows XP 开发盒上的 IIS6。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T10:39:31.007

好吧，我知道如果我发布它，我会自己找到答案...... :)

原来是缺少DLL。无法创建依赖对象，因此出错。为什么它不只是给我一个缺失的组装错误？啊，这是个好问题！使用以下错误代码示例答案：

```
public partial class Invoice : System.Web.UI.Page
{
    DependentObject SomeObject = new DependentObject();
    private void Page_Load(object sender, System.EventArgs e)
    {
        // Put user code to initialize the page here

    }
} 
```

如果缺少 DependentObject 代码的程序集... Invoice 对象，因此要提供的页面，无法初始化...服务器找不到它...我们有一个 404。

我不认为自己是 C# 方面的专家，但我的印象是上面的代码是你永远不应该做的事情。（对吗？）不知道为什么编译器允许它。

将初始对象创建移动到 Page_Load 会产生更有用的缺失程序集异常。

```
public partial class Invoice : System.Web.UI.Page
{
    DependentObject SomeObject;
    private void Page_Load(object sender, System.EventArgs e)
    {
        // Put user code to initialize the page here
        SomeObject = new DependentObject();
    }
} 
```

谢谢各位，谢谢建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T08:23:26.217

发送大量数据、长查询字符串或以其他方式发出内置 IIS7 urlscan 可能会阻止的请求？如果 IIS7 阻止请求，它将发出 404 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:24:57.760

您是否尝试过重命名文件并尝试访问它？

另外，使用记事本将文件的全部内容复制到一个新文件中并保存。

# .net-3.5 - .NET 3.5 Windows 服务的 GC 句柄数 (#) 不断增长的根本原因是什么？

> ID：585149
> 
> 赞同：1
> 
> 时间：2009-02-25T08:24:53.873
> 
> 标签：.net-3.5, windows-services, memory-leaks, windows-server-2003, performance-monitor

我有一个在 .NET Framework 3.5 上运行的 C# Windows 服务，它显示出不断增长的 GC 句柄（使用 Windows Server 2003 上的系统监视器查看）。

我确保所有资源都被正确处理，并且我的代码中没有终结器。

“Large Object Heap size”和“# Bytes in all Heaps”相对而言是静态的，我可以看到“% Time in GC”表明正在发生垃圾收集。

“Private Bytes”计数器也在增加。

这种症状导致我在任务管理器中的“内存使用量”以每天大约 35 MB 的速度增长，这是不可接受的，因为该服务基本上是针对 Oracle 10g 运行一个简单的 SELECT 查询并每 5 秒使用 .NET TraceSources。值得一提的是，TraceSource 使用 .NET 侦听器对象输出到 Windows 事件日志和文本文件。

有谁知道为什么“# GC Handles”不断增加，因为我相信这与我的“内存使用”增加有关？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T09:05:40.983

好的 - 排序它。

在检查 .NET TraceSource 类的源代码后，它似乎在设计上拥有 2 个 WeakReferences 列表 - 1 个用于 TraceSource 对象，1 个用于 Switches。

它这样做是为了支持其 RefreshAll 方法。

我不得不使用反射手动清除这些列表。所以，我不能再安全地使用 RefreshAll 方法，但至少我的 Private Bytes 和 GC Handles 不再增长。

要重现该问题，只需创建一整套 TraceSource 对象并关闭它们 - 您可以看到“泄漏”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T08:38:37.647

您没有释放代码正确引用的非托管资源。

你熟悉固定语句吗？它可以固定内存，以便以不安全的方式访问它。但是，还有另一种方法可以做我们认为可能不安全的事情。

```
var handle = System.Runtime.InteropServices.GCHandle.Alloc(myObject,
        System.Runtime.InteropServices.GCHandleType.Pinned); 
```

上述类型的代码正是可能导致您的问题类型的原因。如果你没有明确地'.Free()'这个固定的内存，你最终不会垃圾收集这个对象，你会有内存泄漏。

我的猜测是，您的 Oracle 10g 提供程序正在发生类似的事情，除非您知道您正在做其他可能会泄漏内存的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T07:17:02.690

对于它的价值，我们已经在 .NET 4.0 中为 TraceSource 和 Switch 修复了这个问题。

我们仍然认为最好的做法是不创建一堆不同的 TraceSource 实例（而是为每个源创建一个静态实例并跨线程共享它们），但在某些情况下，如果您使用第三方库，这是不可能的你无法修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T08:52:09.720

你在使用 ODP.Net 吗？请记住，ODP.Net 不是完全托管的，并且也有一个本地组件。您是否使用任何其他本机资源，例如 ActiveDirectory 等。请记住，即使您有 .Net 程序集，它也是 COM 上的一个薄层，用于 AD 之类的东西。我在我使用的 AD 代码中看到了大量的内存泄漏。不过，我的 ODP.Net 没有内存问题，而且我公司的企业服务使用 ODP.Net 运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-06T12:17:12.800

```
private void TidyWeakReferences(System.Diagnostics.TraceSource source) {

        try {
            // Clear down the Switch's WeakReferences
            TidyList(source, typeof(System.Diagnostics.Switch).GetFields(BindingFlags.NonPublic | BindingFlags.Static));
            // Clear down the Source's WeakReferences
            TidyList(source, typeof(System.Diagnostics.TraceSource).GetFields(BindingFlags.NonPublic | BindingFlags.Static));
        }
        catch { /* Nothing we can do here */ }
    }

private void TidyList(System.Diagnostics.TraceSource source, FieldInfo[] info) {

        List<WeakReference> list = null;

        foreach (FieldInfo fi in info) {

            if (fi.Name == "switches" | fi.Name == "tracesources") {

                list = (List<WeakReference>)fi.GetValue(null);
                lock (list) {
                    for (int i = list.Count - 1; i >= 0; i--) {
                        // Check to see if the GC has already collected these objects
                        if (!list[i].IsAlive) {
                            // It's dead, so remove it from the List (as .NET Framework 4.0 SHOULD fix.)
                            list.RemoveAt(i);
                        }
                    }
                }
            }
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-20T04:08:05.257

这个调试体验的链接应该添加到这个讨论中。它补充了@thehowler 发布的解决方法。

[http://www.wintellect.com/blogs/jrobbins/is-that-a-weakreference-in-your-gen-2-or-are-you-just-glad-to-see-me](http://www.wintellect.com/blogs/jrobbins/is-that-a-weakreference-in-your-gen-2-or-are-you-just-glad-to-see-me)

基本上， TraceSource 的每个新分配都会添加到未进行垃圾收集的 WeakReference 列表中。

# math - 实现脊检测

> ID：585160
> 
> 赞同：7
> 
> 时间：2009-02-25T08:29:58.137
> 
> 标签：math, image-processing, edge-detection

我正在尝试编写一个脊检测算法，我发现的所有来源似乎都将边缘检测与脊检测混为一谈。现在，我已经实现了 Canny 边缘检测算法，但这不是我想要的：例如，给定图像中的一条线，它会有效地将其转换为双线边缘（因为它会记录*两边*该行）-我只想让它读取一行。

[wikipedia article](http://en.wikipedia.org/wiki/Ridge_detection) about ridge detection 有一堆数学，但这对我作为程序员没有帮助（不是我不喜欢数学，但这不是我的领域，我不明白如何翻译他们的微分方程成代码）。是否有一个很好的资源来实际实现这一点？或者，就此而言，是否有一个好的开源实现？

编辑：这是一个简单的例子。我们从一个简单的行开始：

[http://img24.imageshack.us/img24/8112/linez.th.png](http://img24.imageshack.us/my.php?image=linez.png)

并运行 Canny 算法得到：

[http://img12.imageshack.us/img12/1317/canny.th.png](http://img12.imageshack.us/my.php?image=canny.png)

（你可以看到这里比较粗——如果你点击图片，你会看到它确实是两条相邻的线，中间有一个空白）

另外，我正在用 C++ 编写，但这并不重要。但我想对*算法*进行编码，而不仅仅是编写`SomePackage::findRidges()`并完成它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T13:24:52.453

也许您需要考虑清理已有的线条，而不是像 Canny 一样的边缘检测。感觉你应该能够对[**图像形态学**](http://en.wikipedia.org/wiki/Morphological_image_processing)做一些事情，特别是我在考虑骨架化和最终侵蚀点类型的操作。正确使用这些应该从您的图像中删除任何不是“线条”的功能 - 我相信它们是在英特尔的 OpenCV 库中实现的。

您可以从使用 Canny 过滤器生成的双线中恢复单线，使用一个扩张操作，然后是 3 个腐蚀（我在 ImageJ 中尝试过）——这也应该删除任何边缘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T09:13:34.530

我打算像伊恩所说的那样清理你的线条，但如果你不想这样做，你也可以考虑做一些霍夫变换的变体。

[http://en.wikipedia.org/wiki/Hough_transform](http://en.wikipedia.org/wiki/Hough_transform)

您应该能够从中获得该线的实际方程式，因此您可以根据需要使其变细或变粗。唯一棘手的部分是弄清楚线路的结束位置。

这是我几年前用 MATLAB 编写的霍夫变换代码。我不确定它的效果如何，但它应该给你一个大致的想法。它将找到图像中的所有线（不是线段）

```
im = imread('cube.tif');
[bin1,bin2,bin3] = canny(im);

%% define constants
binary = bin1;
distStep = 10; % in pixels
angStep = 6; % in degrees
thresh = 50;

%% vote
maxDist = sqrt((size(binary,1))^2+(size(binary,2))^2);
angLoop = 0:angStep*pi/180:pi;
origin = size(binary)/2;
accum = zeros(ceil(maxDist/distStep)+1,ceil(360/angStep)+1);

for y=1:size(binary,2)
    for x=1:size(binary,1)
    if binary(x,y)
        for t = angLoop
        dx = x-origin(1);
        dy = y-origin(2);
        r = x*cos(t)+y*sin(t);
        if r < 0
            r = -r;
            t = t + pi;
        end
        ri = round(r/distStep)+1;
        ti = round(t*180/pi/angStep)+1;
        accum(ri,ti) = accum(ri,ti)+1;
        end
    end
    end
end
imagesc(accum);

%% find local maxima in accumulator
accumThresh = accum - thresh;
accumThresh(logical(accumThresh<0)) = 0;
accumMax = imregionalmax(accumThresh);
imagesc(accumMax);

%% calculate radius & angle of lines
dist = [];
ang = [];
for t=1:size(accumMax,2)
    for r=1:size(accumMax,1)
    if accumMax(r,t)
        ang = [ang;(t-1)*angStep/180*pi];
        dist = [dist;(r-1)*distStep];
    end
    end
end
scatter(ang,dist); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-26T20:47:06.503

如果有人对此仍然感兴趣，这里是脊/谷算法的实现： [C++ 源代码](https://github.com/PauloCarvalhoRJ/gammaray/blob/EMD/spectral/spectral.cpp)。寻找一个名为`get_ridges_or_valleys()`. 该实现是[Linderhed (2009)](https://www.researchgate.net/publication/220531161_Image_Empirical_Mode_Decomposition_a_New_Tool_for_Image_Processing)提出的算法的 3D 版本。有关脊/谷算法，请参见论文的第 8 页。

# .net - 破坏接口

> ID：585170
> 
> 赞同：2
> 
> 时间：2009-02-25T08:34:32.230
> 
> 标签：.net, language-agnostic, interface

如果您需要破坏 .NET 应用程序中的接口，应遵循哪些最重要的准则？在部署应用程序之前和之后，这些准则有何变化？

我知道还有其他问题在争论何时/何地应该使用接口，但是我不想讨论这个问题。当您需要这样做时，我只想知道一些有效的方法来减轻对应用程序其余部分的影响。

如果我只是向接口添加新方法，是否只有实现者需要修改/重新编译，而所有客户端都可以继续愉快地运行而无需更改？

重命名方法和变量怎么样，这会破坏接口吗？

我过去遇到的一个强烈建议是“永远不要破坏界面”。但这不会产生像 mshtml COM 库中所见的 IDocument、IDocument2、IDocument3、IDocument4、IDocument5、IDocument6 等混乱的设计吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T08:57:37.960

它取决于与您的界面消费者的合同（隐含或显式）。

如果在重建界面时重建了所有消费者，那么**管理**更改很简单，只需更改它并修复所有中断（修复中断本身*可能*很复杂）。

如果您希望消费者在发布新库/应用程序时重新编译，那么您需要向他们提供一些帮助以指示需要哪些更改，您如何管理这取决于在维护旧功能的同时是否会发生更改/特性。如果您可以在至少一个版本中明智地使用 [Obsolete("Use the new Blah method instead", false)]，然后在下一版本中使用 [Obsolete("...", true)] 将提供干净的迁移小路

如果您尝试保持二进制兼容性，则 Obsolete 属性允许这样做，同时仍然阻止人们在重新编译时继续使用已弃用的功能。

如果您的合同暗示要维护二进制和源代码的兼容性，例如 5 年（对于 OS 平台 API 来说是很短的时间），那么您别无选择，只能使用全新的接口，向接口添加方法将会中断实现它的代码（在编译、类型验证或方法调用时，取决于类型加载器的严格性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T08:41:12.557

这当然取决于技术。在 COM 中（当不使用 IDispatch 后期绑定时）您可以安全地在接口末尾添加新方法，但不能在不更改接口 GUID 的情况下删除或交换以前存在的方法。这同样适用于 Microsoft RPC。老客户仍然可以很高兴使用该接口，就像它只有他们知道的方法一样。

# php - 会话管理和cookies--交互机制

> ID：585171
> 
> 赞同：0
> 
> 时间：2009-02-25T08:34:50.527
> 
> 标签：php, session

我有兴趣了解会话管理和 cookie 在 PHP 中的工作方式。我想知道它们的底层机制，比如浏览器如何与 cookie 交互，以及 cookie 如何用于验证服务器中的会话数据。

有什么网络资源可以让我学习吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T08:42:20.290

特别是在 PHP 中，会话工作的标准方式是 PHP 生成一个随机会话 ID，并将其放入 cookie 中。（默认称为 PHPSESSID）该 cookie 由浏览器处理，将其保存在用户的本地计算机上，并与每个请求一起发送到它所属的域。

然后，此会话 ID 用于引用服务器机器上的数据存储，按照标准，位于 /tmp/ 上的 apache 安装在 linux 上。这是 $_SESSION 数组中的所有内容在请求之间存储的地方。

您可能会注意到，这仅与 cookie 一样安全，因为用户和服务器之间没有真正的身份验证，即用户是会话 ID 的“真正”所有者。这意味着通过嗅探cookie并将带有会话ID的cookie插入攻击者的机器上，所谓的“会话劫持”是可能的。这可用于接管网页上的帐户，并像您是原始用户一样浏览它，因为对于服务器而言，您*是*.

PHP 支持还有另一种更不安全的保持会话活动的方法。这是通过将会话 ID 作为 GET 变量与每个链接一起发送来完成的。您可能会注意到，这意味着如果用户只是复制粘贴其中一个链接，他将放弃所有凭据。=)

更多信息可以在[PHP 手册](http://www.php.net/manual/en/intro.session.php)中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T08:39:56.537

来自[PHP 的会话处理](http://www.php.net/manual/en/intro.session.php)手册：

> 访问您的网站的访问者被分配一个唯一的 id，即所谓的会话 id。这要么存储在用户端的 cookie 中，要么在 URL 中传播。

这个唯一的 id 是一个很大的随机数，存储在服务器端，以便下次客户端发出新请求时匹配它。它通常进入 /tmp 目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:42:23.537

cookie 是与 HTTP 地址相关联的一些数据。IE

```
1/ Browser requests www.google.com
2/ www.google.com response includes setting a cookie
3/ From this point on and as long as the cookie is valid (there's an expiry time associated with it), each subsequent request made by the browser to www.google.com/anything includes the cookie above 
```

详情：[http ://en.wikipedia.org/wiki/HTTP_cookie](http://en.wikipedia.org/wiki/HTTP_cookie)

cookie 允许在其他无状态的 HTTP 协议中创建会话，因为它允许客户端-服务器对话与与服务器交互的其他客户端隔离。

# ruby-on-rails - 如何确保我为 Web 应用程序提供的组件不会用于多个域或网站

> ID：585174
> 
> 赞同：0
> 
> 时间：2009-02-25T08:36:51.630
> 
> 标签：ruby-on-rails, deployment, plugins

我是一名 ruby​​ on rails 开发人员，我已经开发了几个插件，可能我会将它们卖给一些网站，他们可以在应用程序中使用我的插件。但我想确保一旦提供给他们的插件代码不会用于任何其他应用程序，如果他们这样做，我必须知道它部署在哪里。

我只需要一种方法来跟踪给定插件的部署数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T08:42:11.273

你不能。Ruby 是经过解释的，因此他们可以简单地从中删除跟踪代码，并在需要的地方使用它。如果您真的想要可转售的组件，您可能想要为 ruby​​ 构建 C 扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T08:56:06.047

你不能保证。您可以通过创建一些混淆代码使其无利可图，这将限制使用。假设分析该代码将花费更多，而不仅仅是向您支付另一个许可证。当然，这并不能保证任何事情。

# pagerank - Google PageRank：是按域计算还是按网页计算

> ID：585175
> 
> 赞同：2
> 
> 时间：2009-02-25T08:37:25.887
> 
> 标签：pagerank

Google PageRank 是作为整个网站（域）的一个值计算的，还是为每个网页计算的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T08:45:20.517

谷歌在多大程度上遵循了众所周知的 PageRank 算法是他们的商业秘密。在通用算法中，页面排名是按*文档*计算的。

编辑：原始的通用 PageRank 解释[http://www.ams.org/featurecolumn/archive/pagerank.html](http://www.ams.org/featurecolumn/archive/pagerank.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T08:49:31.083

谷歌**页面**排名

这是一个片段和指向谷歌自己的解释的链接：

[http://www.google.com/corporate/tech.html](http://www.google.com/corporate/tech.html)

> PageRank 技术：PageRank 通过考虑超过 5 亿个变量和 20 亿个术语，反映了我们对网页重要性的看法。我们认为重要页面的页面会获得更高的 PageRank，并且更有可能出现在搜索结果的顶部。
> 
> PageRank 还考虑投票的每个页面的重要性，因为来自某些页面的投票被认为具有更大的价值，从而赋予链接页面更大的价值。我们一直采取务实的方法来帮助提高搜索质量并创建有用的产品，我们的技术使用网络的集体智慧来确定页面的重要性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T09:12:53.680

每个网页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T08:26:48.497

它应该是每个网页。

# sql-server - SQL Server 系统视图中的 type 和 xtype 有什么区别？

> ID：585193
> 
> 赞同：1
> 
> 时间：2009-02-25T08:45:50.813
> 
> 标签：sql-server

许多系统视图中有几列具有“x”前缀，有人知道这意味着什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T09:03:38.307

很可能只是出于**向后兼容**的目的。

*   type 是为与以前版本兼容而保留的较旧列
*   xtype 比较完整，是应该用的那个

有关差异列表，请参阅[sys.sysobjects (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms177596.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T08:53:45.753

`xtype`对于`UNIQUE CONTRAINT`和`PRIMARY KEY`将分别是`UQ`和`PK`，而`type`如果它们都是`K`。

这是我知道的唯一区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:57:01.113

IIRC 它是 sybase 兼容性

SQL Server 最初是 sybase 的一个分支，它只有“类型”列

当微软扩展类型时，他们添加了一个新列“xtype”

您可以看到某些类型没有“类型”

从 master..systypes 中选择名称、xtype、类型

所以总的来说，我认为你应该使用“xtype”列，而忽略“type”列

# php - 谁能帮我用php发送附件脚本？

> ID：585194
> 
> 赞同：0
> 
> 时间：2009-02-25T08:46:17.037
> 
> 标签：php, file, email, attachment

**重复**：[PHP将图像附加到电子邮件](https://stackoverflow.com/questions/536838/php-attaching-an-image-to-an-email)

我需要 php 中的邮件附件脚本，附件应该是多个文件，任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T15:36:25.520

如果您不使用框架或想要独立产品，[PHPMailer](http://phpmailer.codeworxtech.com/index.php?pg=phpmailer)是一个非常好的类，用于发送带有（多个）附件的邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T09:00:28.173

[http://www.zend.com/zend/spotlight/sendmimeemailpart1.php](http://www.zend.com/zend/spotlight/sendmimeemailpart1.php)

# ruby - 独家或红宝石的关键字？

> ID：585195
> 
> 赞同：17
> 
> 时间：2009-02-25T08:47:32.713
> 
> 标签：ruby, boolean, xor

Ruby 是否有一个简单的英语关键字来表示独占或，就像他们有“and”和“or”一样？如果不是，这是因为排他性还是不允许评估捷径？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-25T08:55:16.500

不，它没有，您只能使用`^`.

不知道为什么没有特别的，可能只是因为它不常用。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-29T14:03:40.917

我遇到了一个问题，因为 '^' 运算符按位对数字起作用，

```
true ^ 1
=> false

1 ^ true
TypeError: can't convert true into Integer
true ^ 1 
```

所以我的解决方法是：

`( !!a ^ !!b )`双爆炸将它们强制转换为布尔值。

```
!!1 ^ !!true
=> false

!!1 ^ !!false
=> true 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-25T12:11:39.990

首先，我认为短路不适用于 XOR：无论第一个操作数的值如何，都需要检查第二个操作数。

其次，and, &&, or and || 在所有情况下都使用短路；“单词”和“符号”版本之间的唯一区别是优先级。我相信`and`并且`or`存在提供与 perl 相同的功能，例如

```
process_without_error or die 
```

我认为没有`xor`命名函数的原因可能是在这种情况下低优先级运算符没有意义，而且它已经是一个足够令人困惑的情况了！

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-25T08:55:53.923

尝试`^`

```
true  ^ false #=> true
true  ^ true  #=> false
false ^ false #=> false 
```

虽然没有简单的英语等效运算符。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-07-15T12:34:02.520

作为 Matt Van Horn 对任意类型使用 XOR 的双重否定技巧的替代方法，您可以链接另一个 XOR 测试，从`nil`. IE：

```
!!foo ^ !!bar 
```

相当于

```
nil ^ foo ^ bar 
```

这在我看来更整洁，我想需要更少的逻辑操作

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-08T13:50:15.380

任何实现`xor`都不允许短路。无论如何，这两个表达式都需要进行评估。

Ruby 确实提供了`^`运算符，但这会阻塞真实值。我已经实现了一个函数来处理我想要一个`xor`更像`and`and的情况`or`：

```
def xor(a,b)
  (a and (not b)) or ((not a) and b)
end 
```

与 不同`^`的是，此函数可用于类似以下情况：

```
xor("hello".match(/llo/), false) # => true
xor(nil, 1239)                   # => true
xor("cupcake", false)            # => false 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-08-06T04:19:44.297

约翰的回答似乎不正确。在 irb 1.9.3 中，xor("cupcake", false) 返回 true，正如您所期望的。

```
1.9.3-p429 :104 > def xor(a,b)
1.9.3-p429 :105?>     (a and (not b)) or ((not a) and b)
1.9.3-p429 :106?>   end
 => nil 
1.9.3-p429 :107 > xor(false, true)
 => true 
1.9.3-p429 :108 > xor("cupcake", false)
 => true 
```

# .net - .NET 中的“异步 IO 操作”是什么？

> ID：585206
> 
> 赞同：1
> 
> 时间：2009-02-25T08:55:13.240
> 
> 标签：.net, asynchronous, io

长话短说 - 先读[这篇文章](http://piers7.blogspot.com/2005/11/threadstatic-callcontext-and_02.html)，然后再读这篇[文章](http://www.lhotka.net/WeBlog/PermaLink,guid,019e3c37-38ed-492e-b769-16e1a57fed0a.aspx)。简而言之 - 这是关于 ASP.NET 和线程之间随机切换的老问题。好吧，实际上并不是那么随机。正如第二篇文章所解释的，这只发生在“当您的线程执行异步 IO 操作时”。那么......在这种情况下，异步 IO 操作到底是什么？我熟悉标准的*Begin...End...IAsyncResult*和异步 IO 的事件模型。但我看不出这如何与线程开关联系在一起。

关键是 - 我只是害怕我的软件可能正在执行的任何“隐藏”异步 IO（然后会引发线程切换）。但是如何识别它们呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T09:03:55.667

异步 IO 操作是指调用线程不阻塞以等待 IO 的情况。示例包括对流、网络连接等的 BeginXXX 操作。

当您使用 BeginXXX 设置调用时，线程池线程将用于执行您的回调，而设备驱动程序通常会处理实际的 IO。因此可能涉及许多不同的线程。

# c# - 我可以使用 LINQ 更优雅地重写它吗？

> ID：585215
> 
> 赞同：3
> 
> 时间：2009-02-25T08:58:00.970
> 
> 标签：c#, linq, linq-to-objects

我有一个`double[][]`要转换为 CSV 字符串格式的文件（即一行中的每一行，行元素用逗号分隔）。我是这样写的：

```
public static string ToCSV(double[][] array)
{
    return String.Join(Environment.NewLine,
                       Array.ConvertAll(array,
                                        row => String.Join(",",
                                                           Array.ConvertAll(row, x => x.ToString())));
} 
```

有没有更优雅的方式来使用 LINQ 编写它？

（我知道，可以使用临时变量来使它看起来更好，但这种代码格式更好地传达了我正在寻找的内容。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T09:01:48.263

你可以，但我个人不会一次完成所有的行——我会使用迭代器块：

```
public static IEnumerable<string> ToCSV(IEnumerable<double[]> source)
{
    return source.Select(row => string.Join(",",
       Array.ConvertAll(row, x=>x.ToString())));        
} 
```

这将返回每一行（然后调用者可以`WriteLine`有效地等，而无需缓冲所有内容）。它现在也可以从任`double[]`何行源（包括但不限于锯齿状数组）调用。

另外 - 使用局部变量，您可以使用`StringBuilder`使每行稍微便宜一些。

* * *

要一次返回整个字符串，我会对其进行优化以使用单个`StringBuilder`来完成所有字符串工作；有点冗长，但效率更高（中间字符串少得多）：

```
public static string ToCSV(IEnumerable<double[]> source) {
    StringBuilder sb = new StringBuilder();
    foreach(var row in source) {
        if (row.Length > 0) {
            sb.Append(row[0]);
            for (int i = 1; i < row.Length; i++) {
                sb.Append(',').Append(row[i]);
            }
        }
    }
    return sb.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T00:47:43.620

你也可以使用聚合

```
public static string ToCSV(double[][] array)
{
  return array.Aggregate(string.Empty, (multiLineStr, arrayDouble) =>
           multiLineStr + System.Environment.NewLine + 
           arrayDouble.Aggregate(string.Empty, (str, dbl) => str + "," + dbl.ToString()));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T09:08:53.673

你可以用 LINQ 做到这一点，但我不确定你是否比你更喜欢这个。恐怕你不会。:)

```
var q = String.Join(Environment.NewLine, (from a in d
                                      select String.Join(", ", (from b in a
                                                                select b.ToString()).ToArray())).ToArray()); 
```

干杯，马蒂亚斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T06:23:07.403

这与任何嵌套的`double`. 它还将`ToString`实现推迟到调用者，允许格式化同时避免混乱的`IFormatProvider`重载：

```
public static string Join(this IEnumerable<string> source, string separator)
{
    return String.Join(separator, source.ToArray());
}

public static string ToCsv<TRow>(this IEnumerable<TRow> rows, Func<double, string> valueToString)
    where TRow : IEnumerable<double>
{
    return rows
        .Select(row => row.Select(valueToString).Join(", "))
        .Join(Environment.NewLine);
} 
```

# programming-languages - 为什么我们没有两个空值？

> ID：585219
> 
> 赞同：31
> 
> 时间：2009-02-25T09:00:09.373
> 
> 标签：programming-languages, null

我经常想知道为什么带有`null`表示*“没有价值”*的语言不区分被动的*“我不知道价值是什么”*和更自信的*“没有价值”。*.

在某些情况下，我希望区分这两者（尤其是在使用用户输入和数据库时）。

我想象以下内容，我们将两个状态命名为`unknown`和`null`：

```
var apple;

while (apple is unknown)
{
    askForApple();
}

if (apple is null)
{
    sulk();
}
else
{
    eatApple(apple);
} 
```

显然，我们可以通过在其他地方手动存储状态来摆脱它，[但我们也可以为 null 做到这一点](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx)。

那么，如果我们可以拥有一个`null`，为什么我们不能拥有两个呢？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-25T09:07:43.117

*我们有一个*空值还不够糟糕吗？

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-25T09:05:31.390

在大多数编程语言中，null 表示“空”或“未定义”。另一方面，“未知”是不同的东西。本质上，“未知”描述了对象的状态。这种状态一定来自你程序中的某个地方。

看看[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)。它可以帮助您实现您想要实现的目标。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-02-25T09:08:11.010

在我的编程中，我最近采用了区分“语言空”和“域空”的做法。

“语言空值”是编程语言提供的特殊值，用于表示变量“没有值”。在数据结构、参数列表和返回值中需要它作为虚拟值。

“域 null”是实现[NullObject](http://en.wikipedia.org/wiki/Null_Object_pattern)设计模式的任意数量的对象。实际上，每个域上下文都有一个不同的域 null。

程序员将语言 null 用作包罗万象的域 null 是相当普遍的，但我发现它往往使代码更加程序化（更少面向对象）并且更难辨别意图。

每次想要一个空值时，问问自己：那是语言空值，还是域空值？

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-25T09:06:01.437

javascript 实际上有 null 和 undefined ( [http://www.w3schools.com/jsref/jsref_undefined.asp](http://www.w3schools.com/jsref/jsref_undefined.asp) )，但许多其他语言没有。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-25T09:09:03.613

在极少数情况下，当你需要这样的东西时，创建一个指示未知的静态常量就很容易了。

```
var apple = Apple.Unknown;
while (apple == Apple.Unknown) {} // etc 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-25T09:16:22.300

存在价值：

*   Python：`vars().has_key('variableName')`
*   PHP：`isset(variable)`
*   JavaScript：`typeof(variable) != 'undefined'`
*   Perl：`(variable != undef)`或者如果您愿意：`(defined variable)`

当然，当变量未定义时，它不是 NULL

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-25T18:04:20.847

为什么要停在两点？

当我在大学学习数据库时，有人告诉我们有人（抱歉，不记得研究人员或论文的名字）查看了一堆数据库模式，发现 null 有 17 种不同的含义：“不要还知道”、“不知道”、“不适用”、“无”、“空”、“未采取行动”、“未使用字段”等。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-25T18:09:48.257

在 haskell 中，您可以定义如下内容：

```
data MaybeEither a b = Object a
                     | Unknown b
                     | Null
                       deriving Eq
main = let x = Object 5 in
       if x == (Unknown [2]) then putStrLn ":-("
       else putStrLn ":-)" 
```

这个想法是 Unknown 值包含一些类型的数据`b`，可以将它们转换为已知值（您将如何做到这一点取决于具体类型`a`和`b`）。

细心的读者会注意到我只是将 Maybe 和 Either 组合成一种数据类型 :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-25T09:02:33.923

在 .net 语言中，您可以使用[可空类型](http://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx)，它解决了值类型的这个问题。

然而，对于引用类型，问题仍然存在。由于 .net 中没有指针之类的东西（至少在“安全”块中），“object?o”不会编译。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-25T09:06:07.940

注意`null`是可接受的，但已知的条件。未知状态是 IMO 的另一回事。我在顶部帖子的评论部分与丹的对话将阐明我的立场。谢谢丹！

您可能想要查询的是对象是否已初始化。

Actionscript 有这样的东西（`null`和`undefined`）。但是有一些限制。

请参阅[文档](http://livedocs.adobe.com/flex/3/html/help.html?content=03_Language_and_Syntax_11.html)：

> **无效数据类型**
> 
> void 数据类型只包含一个值，未定义。在以前版本的 ActionScript 中，undefined 是 Object 类实例的默认值。在 ActionScript 3.0 中，Object 实例的默认值为 null。如果您尝试将 undefined 值分配给 Object 类的实例，Flash Player 或 Adob​​e AIR 会将值转换为 null。您只能将 undefined 值分配给无类型的变量。无类型变量是缺少任何类型注释或使用星号 (*) 符号进行类型注释的变量。您只能将 void 用作返回类型注释。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-25T09:09:34.423

[有些人会争辩说我们应该完全摆脱`null`，](http://thinkoracle.blogspot.com/2009/02/get-rid-of-null.html)这似乎是相当有效的。毕竟，为什么要停在两个零点？为什么不是三个或四个等等，每个代表一个*“无价值”*状态？

想象一下，有`refused`, `null`, `invalid`:

```
var apple;

while (apple is refused)
{
    askForApple();
}

if (apple is null)
{
    sulk();
}
else if(apple is invalid)
{
    discard();
}
else
{
    eatApple(apple);
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-25T09:21:44.767

在 PHP Strict 中，您需要`isset()`检查设置变量（否则会引发警告）

```
if(!isset($apple))
{
    askForApple();
}

if(isset($apple) && empty($apple))
{
    sulk();
}
else
{
    eatApple();
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-25T09:23:38.943

Null 类型是所有引用类型的子类型——您可以使用 null 代替对任何类型对象的引用——这严重削弱了类型系统。它被[其创建者认为是历史上一个糟糕的想法](http://qconlondon.com/london-2009/presentation/Null+References:+The+Billion+Dollar+Mistake)之一，并且仅存在于检查地址是否为零时易于实现。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-25T09:33:18.267

至于*为什么*我们没有两个空值，是不是因为在历史上，在 C 语言中，空值是一个简单`#define`的部分，而不是语言的一个独特部分？

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-28T09:20:48.130

已经尝试过了：Visual Basic 6 有 Nothing、Null 和 Empty。它导致了如此糟糕的代码，它在Dobbs 博士的传奇[13 种厌恶 VB的文章中排名第 12。](http://www.ddj.com/windows/184403996)

正如其他人所建议的那样，请改用[Null Object 模式。](http://en.wikipedia.org/wiki/Null_Object_pattern)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-25T10:38:34.007

问题在于，在强类型语言中，这些额外的空值应该包含有关类型的特定信息。

基本上，您的额外空值是一种元信息，可以取决于类型的元信息。

一些值类型有这个额外的信息，例如许多数字类型有一个 NaN 常量。

在动态类型语言中，您必须考虑没有值（null）的引用与类型可以是任何类型（未知或未定义）的变量之间的区别

因此，例如，在静态类型的 C# 中，类型变量`String`可以为 null，因为它是引用类型。类型的变量`Int32`不能，因为它是值类型，它不能为空。我们总是知道类型。

在动态类型的 Javascript 中，变量的类型可以未定义，在这种情况下，需要区分空引用和未定义值。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-25T17:39:31.857

[有些人](http://thedailywtf.com/Articles/It_0x27_s_Pretty_Null.aspx)已经领先你一步了。;)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-26T18:42:52.710

```
boolean getAnswer() throws Mu 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-03T02:08:26.257

考虑到西方哲学花了多长时间才弄清楚如何谈论“无”的概念……是的，我对这种区别被忽视了一段时间并不感到惊讶。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-25T09:58:26.397

我认为拥有一个 NULL 是处理基本模式的较低公分母

```
if thing is not NULL
  work with it
else
  do something else 
```

在“做其他事情”部分，有很多可能性，从“好吧，算了吧”到试图在其他地方得到“事情”。如果您不简单地忽略某些为 NULL 的内容，您可能需要知道为什么“事物”为 NULL。拥有多种类型的 NULL 可以帮助您回答该问题，但可能的答案很多，正如此处其他答案所暗示的那样。丢失的东西可能只是一个错误，在尝试获取它时可能是一个错误，它可能现在不可用，等等。要决定哪些情况适用于您的代码——这意味着你必须处理它们——它是特定于域的。因此，最好使用应用程序定义的机制来编码这些原因，而不是寻找一种试图处理所有这些原因的语言特性。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-25T17:55:45.827

这是因为 Null 是您正在使用的语言的产物，而不是程序员的便利。它描述了对象在使用它的上下文中自然发生的状态。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-25T18:12:34.023

如果您使用的是 .NET 3.0+ 并且需要其他东西，您可以尝试[Maybe Monad](http://weblogs.asp.net/podwysocki/archive/2009/01/28/much-ado-about-monads-maybe-edition.aspx)。您可以创建所需的任何“可能”类型，并使用 LINQ 语法进行相应处理。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-26T10:10:33.020

```
AppleInformation appleInfo;    
while (appleInfo is null)
{
    askForAppleInfo();
}

Apple apple = appleInfo.apple;
if (apple is null)
{
    sulk();
}
else
{
    eatApple(apple);
} 
```

首先检查是否有苹果信息，然后检查是否有苹果。您不需要为此提供不同的母语支持，只需使用正确的类即可。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-26T19:54:06.563

对我来说，null 代表缺乏价值，我试图用它来代表它。当然，你可以赋予 null 任意多的含义，就像你可以使用 0 或 -1 来表示错误而不是它们的数值一样。但是，给一种表示赋予各种含义可能会模棱两可，所以我不推荐它。

您的示例可以像 apple.isRefused() 或 !apple.isValid() 一样进行编码，而且工作量很小；无论如何，您应该事先定义什么是无效的苹果，所以我看不到拥有更多关键字的好处。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-03-01T19:39:56.603

您始终可以创建一个对象并将其分配给相同的静态字段以获得第二个空值。

例如，这用于允许元素为空的集合中。在内部，他们使用 a`private static final Object UNSET = new Object`作为未设置的值，因此允许您将`null`s 存储在集合中。（我记得，Java 的集合框架调用这个对象 TOMBSTONE 而不是 UNSET。或者这是 Smalltalk 的集合框架？）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-03-03T01:40:24.200

VB6

*   **什么**都没有=>“没有价值。”
*   **Null** = > “我不知道值是什么” - 与 .NET 中的 DBNull.Value 相同

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-03-03T01:54:11.297

两个空值将是最错误的答案。如果一个 null 还不够，您需要无穷多个 null。

空可能意味着：

*   '未初始化'
*   '用户未指定'
*   “这里不适用，汽车涂漆前的颜色”
*   “统一：这个域的信息位为零。”
*   “空：在这种情况下正确地没有数据，例如上次轮胎在新车上旋转的时间”
*   '多个级联空值：例如，当没有指定数量时，数量价格的扩展乘以用户未指定的数量'

而且您的特定域可能需要许多其他类型的“带外”值。实际上，这些值在域中，并且在每种情况下都需要具有明确定义的含义。（所以，无穷大真的是零）

# .net - 用户图像 - 数据库与文件系统存储

> ID：585224
> 
> 赞同：3
> 
> 时间：2009-02-25T09:01:50.773
> 
> 标签：.net, database, image, filesystems, storage

我正在.NET 中为用户配置文件上的演示图像编写上传功能。我正在两种不同的方式之间进行选择，并想就利弊提出建议和意见。

1.  将图像直接存储在文件系统上

2.  将图像存储在数据库中

到目前为止，我主要是第一个选项 - 在用户名之后命名图像，因为每个用户只能有一个演示图像。然后我在指定路径中检查用户是否有图像，如果没有则显示默认的“无图像”-图像。

我喜欢它的另一件事是它节省了数据库中的空间——如果没有额外的二进制负载，数据库将非常沉重。

我敢肯定还有其他方面我没有考虑过，所以我想听听您对此的看法。如果有人对这个问题有完全不同的解决方案，也请分享！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T09:05:26.960

通常，最好将文件存储在文件系统上。文件系统已经针对存储文件进行了调整。但是，这确实有其缺点，特别是在管理、备份、恢复方面，并且它在数据库中的 varchar 文件路径字段和文件系统中的文件之间有些脆弱的联系。你用的是什么数据库系统？我认为如果您使用的是 SQL Server 2008，那么新的 FileStream 类型为在该数据库中存储文件提供了一种非常好的方法。

编辑：注意我真的在谈论更普遍的关于在数据库中存储文件的问题。尝试在数据库中存储要在 HTML 页面上显示的图像会涉及一些额外的复杂性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:07:56.127

文件系统很好，但每个文件夹超过 3000 个图像不实用。最好为每 3000 个图像块编写自动文件夹创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-22T04:36:59.913

数据冗余和不一致 数据访问困难 数据隔离 完整性约束 原子性问题 并发访问和异常（更新安全问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-18T18:07:05.793

对于固定（不变）的内容，例如照片、视频等，文件系统将无法扩展，尤其是当目录中有大量文件并且性能会受到影响时。更好的选择是使用对象存储技术，将图像存储为对象并自动将关联的元数据放入数据库中。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-23T01:53:08.363

如何存储 doc、pdf、xls、jpg 文件？推荐哪一个？

我打算开发一个可能存储 10000 个文件的文档管理系统，但问题是如果我们使用文件系统技术，我非常担心病毒传播。

# ruby-on-rails - 我如何使用 git 在 Rails 项目之间共享基本代码？

> ID：585227
> 
> 赞同：2
> 
> 时间：2009-02-25T09:02:36.780
> 
> 标签：ruby-on-rails, git

我想用 git 在我的 rails 项目之间共享（并保持更新）一些基本代码。我能怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T09:06:11.387

您可以使用[git submodules](http://git-scm.com/docs/git-submodule)，例如像[这样](http://woss.name/2008/04/09/using-git-submodules-to-track-vendorrails/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T09:06:30.687

我见过的最好的描述是这个[截屏视频](http://railscasts.com/episodes/96)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T12:13:36.907

不要使用子模块。它们很丑陋，难以理解和维护。更好的是使用子树。

Git 子树是自 1.7.11 以来 GIT 的一部分，我写了一篇关于在 Rails 应用程序之间共享代码的文章：http: [//igor-alexandrov.github.com/blog/2013/03/28/using-git-subtree-to -share-code-between-rails-applications/](http://igor-alexandrov.github.com/blog/2013/03/28/using-git-subtree-to-share-code-between-rails-applications/)

简而言之：是的 git-subtree 工作得很好！

# css - ie7底部滚动条地狱

> ID：585229
> 
> 赞同：0
> 
> 时间：2009-02-25T09:03:54.543
> 
> 标签：css, internet-explorer

[http://redlineautoleasing.com/beta/](http://redlineautoleasing.com/beta/)

什么可能导致底部滚动条？我想不通。

我试过这个 [http://blog.josh420.com/archives/2007/11/fixing-the-ie-overflow-vertical-scrollbar-bug.aspx](http://blog.josh420.com/archives/2007/11/fixing-the-ie-overflow-vertical-scrollbar-bug.aspx) 但页面有点搞砸了，底部内容被砍掉了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T09:28:52.113

From your CSS:

```
body {
    background-color:black;
    background-image:url(../images/contentbg.jpg);
    background-repeat:repeat-x;
    height:536px;
    background-position:top left;
    color:white;
} 
```

try adding `overflow-x: hidden;` and possibly also `width: 100%;`

or try adding

```
html{
     width:100%;
     overflow-x: hidden;
    } 
```

play around with these, the right combination should make it work OK.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:20:49.747

It looks like your CSS has several things with large widths or margins which could be invisibly going off the side of the page - most likely a positioning difference between IE and other browsers.

In firefox, the firebug addon allows you to inspect all the elements of your page. If there's something like that for IE it should help you identify the offending element. Otherwise, maybe try setting all borders to a width of 1 pixel with various colours to try to highlight which element is sitting out there.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-26T20:36:54.373

有同样的问题，这为我解决了：

```
html
{
    overflow: auto;
} 
```

# javascript - 如何使用 JavaScript 读写文件？

> ID：585234
> 
> 赞同：191
> 
> 时间：2009-02-25T09:05:16.133
> 
> 标签：javascript, file-io

任何人都可以提供一些示例代码来使用 JavaScript 读写文件吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-25T17:26:19.017

为了完整起见，OP 并未声明他希望在浏览器中执行此操作（如果他是，如前所述，通常是不可能的）

但是 javascript 本身确实允许这样做；它可以用服务器端的javascript来完成。

~~[请参阅有关 Javascript File 类的](http://docs.sun.com/source/816-6411-10/misc.htm#1017481)此文档~~

**编辑**：该链接指向现在已由 Oracle 移动的 Sun 文档。

为了跟上时代的步伐，这里是 FileSystem 类的 node.js 文档：[http ://nodejs.org/docs/latest/api/fs.html](http://nodejs.org/docs/latest/api/fs.html)

**编辑（2）**：您现在可以使用 HTML5 在客户端读取文件：http: [//www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-02-25T09:08:14.863

没有。浏览器端 javascript 没有权限写入客户端计算机，而无需禁用许多安全选项

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-08-10T12:55:58.460

未来就在这里！提案接近完成，不再有 ActiveX、flash 或 java。现在我们可以使用：

*   [文件系统 API](https://developer.mozilla.org/en-US/docs/Web/API/File_and_Directory_Entries_API)

*   [本机拖放文件访问](https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API)

您可以使用拖放将文件放入浏览器，或使用简单的上传控件。用户选择文件后，您可以使用 Javascript 阅读它：http: [//www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-25T09:59:45.207

这是 Mozilla 提案

[http://www-archive.mozilla.org/js/js-file-object.html](http://www-archive.mozilla.org/js/js-file-object.html)

这是通过 spidermonkey 和 adobe 的扩展脚本中的编译开关实现的。此外（我认为）您在 Firefox 扩展中获得了 File 对象。

rhino 有一个（相当粗略的）readFile 函数 [https://developer.mozilla.org/en/Rhino_Shell](https://developer.mozilla.org/en/Rhino_Shell)

对于 rhino 中更复杂的文件操作，可以使用 java.io.File 方法。

但是，您不会在浏览器中获得任何这些东西。对于浏览器中的类似功能，您可以使用 HTML5 中的 SQL 数据库函数、客户端持久性、cookie 和闪存对象。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-10-24T08:34:37.887

**这个 Javascript 函数向通过浏览器运行它的用户呈现一个完整的“另存为”对话框。用户按 OK 并保存文件。**

编辑：以下代码仅适用于 IE 浏览器，因为 Firefox 和 Chrome 认为此代码存在安全问题并已阻止其工作。

```
// content is the data you'll write to file<br/>
// filename is the filename<br/>
// what I did is use iFrame as a buffer, fill it up with text
function save_content_to_file(content, filename)
{
    var dlg = false;
    with(document){
     ir=createElement('iframe');
     ir.id='ifr';
     ir.location='about.blank';
     ir.style.display='none';
     body.appendChild(ir);
      with(getElementById('ifr').contentWindow.document){
           open("text/plain", "replace");
           charset = "utf-8";
           write(content);
           close();
           document.charset = "utf-8";
           dlg = execCommand('SaveAs', false, filename+'.txt');
       }
       body.removeChild(ir);
     }
    return dlg;
} 
```

调用函数：

```
save_content_to_file("Hello", "C:\\test"); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-25T09:17:55.883

If you are using JScript (Microsoft's Javascript) to do local scripting using WSH (NOT in a browser!) you can use `Scripting.FileSystemObject` to access the file system.

I think you can access that same object in IE if you turn a lot of security settings off, but that would be a very, very bad idea.

[MSDN here](http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-07-07T00:21:51.577

[目前，可以使用File](https://www.w3.org/TR/FileAPI/)、[FileWriter](https://www.w3.org/TR/2012/WD-file-writer-api-20120417/)和[FileSystem](https://www.w3.org/TR/2012/WD-file-system-api-20120417/) API从浏览器选项卡/窗口的上下文中写入和读取文件，尽管它们的使用有一些注意事项（请参阅此答案的尾部）。

但要回答你的问题：

**使用[烘焙食品](https://github.com/klawson88/Baked-Goods)***

写入文件：

```
bakedGoods.set({
    data: [{key: "testFile", value: "Hello world!", dataFormat: "text/plain"}],
    storageTypes: ["fileSystem"],
    options: {fileSystem:{storageType: Window.PERSISTENT}},
    complete: function(byStorageTypeStoredItemRangeDataObj, byStorageTypeErrorObj){}
}); 
```

读取文件：

```
bakedGoods.get({
        data: ["testFile"],
        storageTypes: ["fileSystem"],
        options: {fileSystem:{storageType: Window.PERSISTENT}},
        complete: function(resultDataObj, byStorageTypeErrorObj){}
}); 
```

**使用原始 File、FileWriter 和 FileSystem API**

写入文件：

```
function onQuotaRequestSuccess(grantedQuota)
{

    function saveFile(directoryEntry)
    {

        function createFileWriter(fileEntry)
        {

            function write(fileWriter)
            {
                var dataBlob = new Blob(["Hello world!"], {type: "text/plain"});
                fileWriter.write(dataBlob);              
            }

            fileEntry.createWriter(write);
        }

        directoryEntry.getFile(
            "testFile", 
            {create: true, exclusive: true},
            createFileWriter
        );
    }

    requestFileSystem(Window.PERSISTENT, grantedQuota, saveFile);
}

var desiredQuota = 1024 * 1024 * 1024;
var quotaManagementObj = navigator.webkitPersistentStorage;
quotaManagementObj.requestQuota(desiredQuota, onQuotaRequestSuccess); 
```

读取文件：

```
function onQuotaRequestSuccess(grantedQuota)
{

    function getfile(directoryEntry)
    {

        function readFile(fileEntry)
        {

            function read(file)
            {
                var fileReader = new FileReader();

                fileReader.onload = function(){var fileData = fileReader.result};
                fileReader.readAsText(file);             
            }

            fileEntry.file(read);
        }

        directoryEntry.getFile(
            "testFile", 
            {create: false},
            readFile
        );
    }

    requestFileSystem(Window.PERSISTENT, grantedQuota, getFile);
}

var desiredQuota = 1024 * 1024 * 1024;
var quotaManagementObj = navigator.webkitPersistentStorage;
quotaManagementObj.requestQuota(desiredQuota, onQuotaRequestSuccess); 
```

正是你要求的对吗？也许，也许不是。后两个 API：

*   目前仅在基于 Chromium 的浏览器（Chrome 和 Opera）中实现
*   已脱离 W3C 标准轨道，目前是专有 API
*   将来可能会从实施浏览器中删除
*   将文件的创建限制在磁盘上的**沙箱**（文件在其之外不会产生影响的位置）

此外，文件系统规范没有定义目录结构在磁盘上的显示方式。例如，在基于 Chromium 的浏览器中，沙箱有一个**虚拟文件系统**（一个目录结构，它不一定以与从浏览器中访问时相同的形式存在于磁盘上），其中使用放置 API。

因此，尽管您可以使用 API 将文件写入系统，但在没有 API（好吧，没有 FileSystem API）的情况下定位文件可能不是一件容易的事。

如果您可以处理这些问题/限制，那么这些 API 几乎是完成您所要求的事情的唯一本地方式。

如果您对非本地解决方案持开放态度，Silverlight 还允许通过[IsolatedStorage](https://msdn.microsoft.com/en-us/library/bdts8hk0(v=vs.95).ASPX)从选项卡/窗口竞赛中进行文件 i/o 。但是，需要[托管代码](https://msdn.microsoft.com/en-us/library/windows/desktop/bb318664(v=vs.85).aspx)才能使用此功能；需要编写此类代码的解决方案超出了此问题的范围。

当然，使用补充托管代码的解决方案，只留下一个 Javascript 来编写，完全在这个问题的范围内；）：

```
//Write file to first of either FileSystem or IsolatedStorage
bakedGoods.set({
    data: [{key: "testFile", value: "Hello world!", dataFormat: "text/plain"}],
    storageTypes: ["fileSystem", "silverlight"],
    options: {fileSystem:{storageType: Window.PERSISTENT}},
    complete: function(byStorageTypeStoredItemRangeDataObj, byStorageTypeErrorObj){}
}); 
```

** BakedGoods 是一个 Javascript 库，它建立了一个统一的接口，可用于在所有原生和一些非原生存储设施中进行常见的存储操作。它是由这个人在这里维护的:)。*

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-02-02T20:28:35.477

对于火狐：

```
var file = Components.classes["@mozilla.org/file/local;1"].
       createInstance(Components.interfaces.nsILocalFile);
file.initWithPath("/home"); 
```

请参阅[https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O](https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O)

对于其他人，请查看[TiddlyWiki](http://www.tiddlywiki.com/)应用程序以了解它是如何做到的。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-05-12T15:20:11.687

在浏览器的上下文中，Javascript 可以读取用户指定的文件。有关使用 File API 读取文件的详细信息，请参阅[Eric Bidelman 的博客](http://www.html5rocks.com/en/tutorials/file/dndfiles/)。但是，基于浏览器的 Javascript 无法在不禁用某些安全设置的情况下写入本地计算机的文件系统，因为任何网站任意更改您的本地文件系统都被视为安全威胁。

话虽如此，有一些方法可以解决它，具体取决于您要执行的操作：

1.  如果是您自己的站点，您可以在网页中嵌入 Java Applet。但是，访问者必须在本地计算机上安装 Java，并且会收到有关安全风险的警报。访问者必须允许加载小程序。Java Applet 就像一个可执行软件，可以完全访问本地计算机。

2.  Chrome 支持的文件系统是本地文件系统的沙盒部分。有关详细信息，请参阅[此页面](http://www.html5rocks.com/en/tutorials/file/filesystem/)。这为您提供了在本地临时保存东西的可能。但是，其他浏览器不支持此功能。

3.  如果你不局限于浏览器，Node.js 有一个完整的文件系统接口。[有关其文件系统文档](https://nodejs.org/api/fs.html)，请参见此处。请注意，Node.js 不仅可以在服务器上运行，还可以在包括 windows 在内的任何客户端计算机上运行。javascript 测试运行器 Karma 基于 Node.js。如果您只是想在本地计算机上使用 javascript 编程，这是一个选项。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-03-31T15:40:08.523

创建文件尝试

```
function makefile(){
  var fso;
  var thefile;

    fso = new ActiveXObject("Scripting.FileSystemObject");
    thefile=fso.CreateTextFile("C:\\tmp\\MyFile.txt",true);

    thefile.close()
    } 
```

在 C 驱动器中创建您的目录，因为 Windows 具有防止从 Web 写入的安全性，例如在 C 驱动器中创建名为“tmp”的文件夹。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-25T17:17:20.413

您将不得不求助于 Flash、Java 或 Silverlight。对于 Silverlight，您将看到[独立存储](http://msdn.microsoft.com/en-us/library/3ak841sy(VS.95).aspx)。这将使您在用户磁盘上自己的操场上写入文件。但它不会让你在操场外写作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-25T09:08:56.233

您不能以任何跨浏览器的方式执行此操作。IE 确实有一些方法可以使“受信任的”应用程序使用 ActiveX 对象来读/写文件，但不幸的是它就是这样。

如果您希望保存用户信息，您很可能需要使用 cookie。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-11-14T15:55:35.623

在 ReactJS 测试中，以下代码成功写入了一个文件：

```
import writeJsonFile from 'write-json-file';

const ans = 42;
writeJsonFile('answer.txt', ans);

const json = {"answer": ans};
writeJsonFile('answer_json.txt', json); 
```

该文件被写入包含测试的目录，因此写入实际的 JSON 文件“*.json”会创建一个循环！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-08-11T20:27:14.750

为想要从 javascript 下载包含特定内容的文件的人编写此答案。我也在为同样的事情而苦苦挣扎。

```
const data = {name: 'Ronn', age: 27};              //sample json
const a = document.createElement('a');
const blob = new Blob([JSON.stringify(data)]);
a.href = URL.createObjectURL(blob);
a.download = 'sample-profile';                     //filename to download
a.click(); 
```

在此处查看 Blob 文档 - [Blob MDN](https://developer.mozilla.org/en-US/docs/Web/API/Blob)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-25T09:09:57.493

您不能使用 javascript 在客户端执行文件 i/o，因为这会带来安全风险。您必须让他们下载并运行 exe，或者如果文件在您的服务器上，请使用 AJAX 和 PHP 等服务器端语言在服务器端执行 i/o

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-11-14T21:40:19.163

> 使用 JavaScript 读取和写入文件有两种方法

1.  使用 JavaScript 扩展

2.  使用网页和 Active X 对象

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-06-11T22:42:25.270

这是 chrome v52+ 的编写解决方案（用户仍然需要选择目标 doe...）
来源：[StreamSaver.js](https://github.com/jimmywarting/StreamSaver.js/)

```
<!-- load StreamSaver.js before streams polyfill to detect support -->
<script src="StreamSaver.js"></script>
<script src="https://wzrd.in/standalone/web-streams-polyfill@latest"></script> 
```

```
const writeStream = streamSaver.createWriteStream('filename.txt')
const encoder = new TextEncoder
let data = 'a'.repeat(1024)
let uint8array = encoder.encode(data + "\n\n")

writeStream.write(uint8array) // must be uInt8array
writeStream.close() 
```

最适合编写在客户端生成的大数据。
否则我建议使用[FileSaver.js](https://github.com/eligrey/FileSaver.js)来保存 Blob/Files

# math - 分数长度

> ID：585237
> 
> 赞同：2
> 
> 时间：2009-02-25T09:05:50.640
> 
> 标签：math, fractions

如何获得分数长度？如果可能，不使用字符串操作或循环

```
should all return length of 3:
5.234
5.23400
5.234000 
```

接受任何编程语言

[编辑]

不是家庭作业，我想以最低限度显示分数。例如，我在数据库中定义了 numeric(18,8)。如果用户只输入 5.234，则数据库中保存的数据为 5.23400000。我只想将其显示为 5.234

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T09:27:11.010

鉴于您关心的是显示而不是内部表示，为什么不直接去掉尾随的 0？

```
#!/use/bin/perl

my @nums = ( '5.234', '5.23400', '5.234000' );
$_ =~ s/0+$// for @nums;  # remove trailing 0s
$_ =~ s/\.$// for @nums;  # remove trailing .

print "@nums\n"; 
```

您可能可以将两者优化为一个正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T10:29:53.543

```
If Int(num) = num Then Return 0
num *= 10
If Int(num) = num Then Return 1
num *= 10
If Int(num) = num Then Return 2
num *= 10
If Int(num) = num Then Return 3
num *= 10
If Int(num) = num Then Return 4
num *= 10
If Int(num) = num Then Return 5
num *= 10
If Int(num) = num Then Return 6
num *= 10
If Int(num) = num Then Return 7
num *= 10
If Int(num) = num Then Return 8
Throw New Exception("Number exceeds expected precision") 
```

没有字符串操作，没有循环。

**编辑：**

顺便说一句，用循环来做到这一点：

```
result = 0
Do While (Int(num) !> num) 
    num *= 10
    result += 1
Loop
Return result 
```

优雅一些

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T09:14:22.150

对于非分数部分，长度为：

```
int((ln(v)/ln(10))+.999) 
```

只要 v > 1，其中 ln() 是自然对数并且 int() 总是向下舍入。对于 v == 1，ln(v) 返回 0，因此您必须在特殊情况下处理此问题。

对于小数部分 ( ) 应该可以实现相同的目标，`v - int(v)`但我的数学让我失败了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T09:21:26.873

只需实现除法算法。当数字计数 > 7 或 8 位时停止（对于 float32）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T09:35:09.743

使用 Java 和 JDBC 时，通过[ResultSet.getBigDecimal()](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/ResultSet.html#getBigDecimal(int))获取值。要获得正确的比例，请使用以下代码（Java 5 及更高版本；Java 1.4 中有一个错误导致“0.0”失败）：

```
int precision = v.stripTrailingZeros().scale(); 
```

对于 Java 1.4，请参阅[此页面](http://forums-beta.sun.com/thread.jspa?threadID=769584&messageID=4385828)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T13:46:30.863

在 Java 中：

```
Double.valueOf("5.34000").toString(); 
```

我假设，您可能希望将字符串转换为双精度。

# c# - 如何在程序执行之间保留项目设置？

> ID：585242
> 
> 赞同：1
> 
> 时间：2009-02-25T09:07:37.953
> 
> 标签：c#, .net, settings

在我的应用程序中，我允许用户选择一个包含一些数据的文件，读取数据并且当用户关闭并再次打开应用程序时它应该可用。我认为可以将值存储在设置中，所以我编写了一个类：

```
public static class SettingsManager
    {
        public static string ComplexValidationsString
        {
            get { return (string)Properties.Settings.Default["ComplexValidations"]; }
            set { Properties.Settings.Default["ComplexValidations"] = value; }
        }

        //some more
    } 
```

设置值并关闭应用程序后，值丢失了。有没有类似的方法可以保留价值？我曾经看过一些代码来替换写入配置文件中的数据，所以我想有一种方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T09:13:32.430

这很容易

```
Properties.Settings.Default.Save(); 
```

你可以把它放在你的`static void Main()`方法中

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T10:32:13.320

除了 ybo 的回答之外，您还应该知道 .NET 将设置文件保存在与您启动应用程序的位置和版本号相关的文件夹中。

这意味着如果您更新版本号（或从不同的地方运行它），您将获得一组新的空白设置。我添加了一个属性，让我可以检测我们何时首次运行新版本，并尝试从以前的设置升级。您可以通过使用检索旧设置。

```
 Settings.Default.GetPreviousVersion("MyPropertyName"); 
```

`SettingsPropertyNotFoundException`如果您从早期版本开始添加了新属性，您确实需要记住捕获。

# html - 如何从打印页面中删除 URL？

> ID：585254
> 
> 赞同：120
> 
> 时间：2009-02-25T09:09:29.930
> 
> 标签：html, printing, footer

我想删除打印在页面底部的 URL。

喜欢：

```
yomari.com/.../main.php?sen_n 
```

如何省略或防止打印？

更具体地说，有什么方法可以在打印网页时阻止页面 URL、日期和页面标题一起打印？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-02-20T09:05:55.960

以下代码示例将为您工作，

```
<style type="text/css" media="print">
@page {
    size: auto;   /* auto is the initial value */
    margin: 0;  /* this affects the margin in the printer settings */
}
</style> 
```

[查看有关从页面禁用浏览器打印选项（页眉、页脚、边距）](https://stackoverflow.com/questions/1960939/disabling-browser-print-options-headers-footers-margins-from-page)的答案？

和[@page 的规范](http://www.w3.org/TR/1998/REC-CSS2-19980512/page.html)

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2016-04-13T12:40:11.820

我在浏览器端本身发现了一些东西。

试试这个步骤。这里我提到了在所有三个主要浏览器中禁用页眉和页脚的步骤。

**Chrome** 单击浏览器右上角的菜单图标。单击打印。取消选中选项部分下的页眉和页脚。

**Firefox** 单击浏览器左上角的 Firefox。将鼠标放在打印上，单击页面设置。单击边距和页眉/页脚选项卡。将页眉和页脚下的每个值更改为 --blank--。

**Internet Explorer** 单击浏览器右上角的齿轮图标。将鼠标放在打印上，然后单击页面设置。将页眉和页脚下的每个值更改为 -Empty-。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-25T09:18:05.103

Having the URL show is a browser client preference, not accessible to scripts running within the page (let's face it, a page can't silently print themselves, either).

To avoid "leaking" information via the query string, you could submit via POST

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-10-16T06:10:38.707

如果您使用下面的代码为页面设置页边距，则打印页面中会省略页眉和页脚。我已经在 FireFox 和 Chrome 中对此进行了测试。

```
<style media="print">
 @page {
  size: auto;
  margin: 0;
       }
</style> 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-12-18T09:41:41.833

这对我有帮助： [打印没有链接的页面](https://processwire.com/talk/topic/9602-printing-page-in-browser-shows-urls-next-to-links/)

```
@media print {
    a[href]:after {
        content: none !important;
    }
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2018-01-25T09:38:35.917

**浏览器问题，但可以通过以下方式解决：**

```
<style type="text/css" media="print">
      @media print
      {
         @page {
           margin-top: 0;
           margin-bottom: 0;
         }
         body  {
           padding-top: 72px;
           padding-bottom: 72px ;
         }
      } 
</style> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-11-19T09:26:35.400

我正在告诉您有关 Mozilla Firefox 的信息（我希望它在其他浏览器中也应该是相同的方式）。

单击**Firefox 菜单**，转到**打印**，从打印的子菜单中选择**页面设置。**屏幕上会弹出一个弹出窗口，转到**“边距和页眉/页脚”** 选项卡。

在打印前根据要求为页眉/页脚选择**“空白” 。**您可以检查预览以进行确认。

我希望这将有所帮助。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-12-15T06:02:26.457

现在，您可以使用`history API`在打印前修改 URL，然后改回：

```
var curURL = window.location.href;
history.replaceState(history.state, '', '/');
window.print();
history.replaceState(history.state, '', curURL); 
```

但是您需要制作一个自定义`PRINT`按钮供用户单击。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-01-18T06:28:19.790

您可以通过浏览器设置删除打印文档上显示的 url。您只需单击文件->页面设置->页眉和页脚将所有内容设置为空白。如果有，您只需从页脚文本框中删除 &U。希望这会帮你

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-25T09:18:15.853

I do not know if you are talking about a footer within your actual graphic or the url the print process within the browser is doing.

If its the url the print process is doing its really up to the browser if he has a feature to turn that off.

If its the footer information i would recommend using a print stylesheet and within that stylesheet to do

```
display: none; 
```

For the particular ID or class of the footer.

To do a print stylesheet, you need to add this to the head.

```
<link rel="stylesheet" type="text/css" href="/css/print.css" media="print" /> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-04-14T02:56:14.793

这对我使用 jquery 来说很好用

```
<style>
  @media print { @page { margin: 0; } 
   body { margin: 1.6cm; } }
</style> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-10-08T13:13:05.317

```
@media print { a[href]:after { content: none !important; } } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-01-14T07:53:44.723

在谷歌浏览器中，这可以通过将边距设置为 0 来完成，或者如果它打印出时髦，然后调整它以将不需要的文本推送到页面的不可打印区域。我试过了，它有效：D

![在此处输入图像描述](https://i.stack.imgur.com/ScREI.png)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-05-03T01:19:26.930

在 Chrome 57 上，如果您可以控制需要打印的 HTML 页面（在我的情况下，我需要打印一个 3x1 英寸的小标签），以下内容对我有用：

*   从标题中删除 HTML 标题元素（如果该页面确实不需要标题，则暂时使用 jquery 或永久）
*   如@Chamika Sandamal 所述，将@page 页边距设置为0

这导致打印的页面仅包含正文，没有 URL，没有页面 #s 等。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-25T11:13:11.287

I would agree with most of the answers saying that its a browser settings but still you can achieve what you want via COM. Keep in mind that most browsers will still have issue with that and even IE will raise the COM security bar to users. So unless its not something you are offering within organisation, don't do it.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-11-25T22:48:42.780

我也有同样的问题。我想知道是否可以通过 jquery 插件创建用于打印的 HTML：[http ://www.recoding.it/?p=138](http://www.recoding.it/?p=138)

然后将 HTML 发送到 php 脚本（使用 ajax 调用），使用[http://www.xhtml2pdf.com/](http://www.xhtml2pdf.com/)或[http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)生成 pdf 。

之后可以显示 pdf（通过设置适当的内容类型和直接渲染）或通过 http-Redirect 显示到生成的 pdf。

pfd_for_printing-folder 中生成的 pdf 文件可以作为缓存，每天被作业删除一次。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-12-30T16:48:56.183

[`--print-to-pdf-no-header`](https://peter.sh/experiments/chromium-command-line-switches/#print-to-pdf-no-header)Chrome headless 现在支持从打印的 PDF 文件中删除页眉和页脚的额外选项

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-07-14T12:42:24.940

```
<style type="text/css" media="print">
  @page {
    size: auto;  
    margin: 0;  
  }
</style>
//now set manual padding to body
<style>
  body{
    padding-left: 1.3cm;
    padding-right: 1.3cm; 
    padding-top: 1.1cm;
  }
</style> 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2011-07-23T05:07:23.330

也许你可以试试 chrome（也可能是 Safari）

当我在 OSX 上使用 Google Chrome 打印到 pdf 时，页眉和页脚中的 url 和页码不可见。

抱歉，不确定这是否适用于 Windows

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2015-01-23T13:52:48.943

我有一个技巧可以将它从 Firefox 的打印页面中删除。用这个：

```
<html moznomarginboxes mozdisallowselectionprint> 
```

在 html 标签中，您必须使用`moznomarginboxes mozdisallowselectionprint`. 我相信它会对你有很大帮助。

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2019-03-08T18:06:39.857

这将是最简单的解决方案。我尝试了互联网上的大多数解决方案，但只有这对我有帮助。

```
@print {
    @page :footer {
        display: none
    }

    @page :header {
        display: none
    }
} 
```

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2018-06-13T04:20:10.220

```
@media print {
    #Header, #Footer { display: none !important; }
} 
```

检查此[链接](https://springmerchant.com/bigcommerce/hide-header-footer-when-printing-bigcommerce/)

# c++ - 有没有更好的方法来反转内存中的字节数组？

> ID：585257
> 
> 赞同：14
> 
> 时间：2009-02-25T09:10:46.183
> 
> 标签：c++, memory, swap, std

```
typedef unsigned char Byte;

...

void ReverseBytes( void *start, int size )
{
    Byte *buffer = (Byte *)(start);

    for( int i = 0; i < size / 2; i++ ) {
        std::swap( buffer[i], buffer[size - i - 1] );
    }
} 
```

这个方法现在所做的是它反转内存中的字节。我想知道的是，有没有更好的方法来获得相同的效果？整个“size / 2”部分似乎是一件坏事，但我不确定。

编辑：我刚刚意识到我给这个问题的标题有多糟糕，所以我[希望]修复了它。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-25T09:16:25.857

标准库有一个[`std::reverse`](http://en.cppreference.com/w/cpp/algorithm/reverse)功能：

```
#include <algorithm>
void ReverseBytes( void *start, int size )
{
    char *istart = start, *iend = istart + size;
    std::reverse(istart, iend);
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-07T14:30:13.847

不使用 STL 的高性能解决方案：

```
void reverseBytes(void *start, int size) {
    unsigned char *lo = start;
    unsigned char *hi = start + size - 1;
    unsigned char swap;
    while (lo < hi) {
        swap = *lo;
        *lo++ = *hi;
        *hi-- = swap;
    }
} 
```

虽然这个问题是 3 ½ 年的问题，但很可能其他人会搜索相同的东西。这就是为什么我仍然发布这个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T10:56:34.383

如果您需要逆向，则有机会改进您的算法并仅使用逆向迭代器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T16:35:28.267

如果您要从具有不同字节顺序的文件中反转二进制数据，您可能应该使用 ntoh* 和 hton* 函数，它们将指定的数据大小从网络顺序转换为主机顺序，反之亦然。例如，ntohl 将 32 位无符号长从大端（网络顺序）转换为主机顺序（x86 机器上的小端）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T16:43:05.410

我会查看 stl::swap 并确保它已优化；在那之后，我会说你非常适合空间。我有理由确定这也是时间最优的。

# mercurial - 如何更改提交时间（尚未推送）？

> ID：585258
> 
> 赞同：20
> 
> 时间：2009-02-25T09:10:51.017
> 
> 标签：mercurial, repository, commit

如何更改在本地存储库中提交的时间？

假设我做了几次提交并注意到我电脑上的日期是错误的。还假设这些提交还没有被推送到任何地方。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-06-06T17:43:41.923

如果它只是一个提交，并且该提交是最近的提交（在您所在的任何分支上），那么执行此操作的快速单线是：

```
hg commit --amend -d now 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-26T04:36:42.777

您可以使用 MQ（Mercurial Queues）轻松完成：

设置错误的日期回购

```
+ hg init
+ echo line
+ hg commit -A -d 12/1 -m first
adding file
+ echo line
+ hg commit -A -d 12/2 -m second
+ echo line
+ hg commit -A -d 12/3 -m third
+ hg log
changeset:   2:81c88de729a8
tag:         tip
user:        Ry4an Brase <ry4an@mini>
date:        Thu Dec 03 00:00:00 2009 -0600
summary:     third

changeset:   1:c1fe70008824
user:        Ry4an Brase <ry4an@mini>
date:        Wed Dec 02 00:00:00 2009 -0600
summary:     second

changeset:   0:abb97adaa541
user:        Ry4an Brase <ry4an@mini>
date:        Tue Dec 01 00:00:00 2009 -0600
summary:     first 
```

将变更集转换为队列中的补丁

```
+ hg qimport -r 2
+ hg qimport -r 1
+ hg qimport -r 0 
```

依次使每个补丁成为qtip并修复日期

```
+ hg qrefresh -D
+ hg qpop
Now at: 1.diff
+ hg qrefresh -D
+ hg qpop
Now at: 0.diff
+ hg qrefresh -D 
```

重新应用补丁

```
+ hg qpush
applying 1.diff
Now at: 1.diff
+ hg qpush
applying 2.diff
Now at: 2.diff 
```

将每个补丁变回真正的变更集

```
+ hg qdel -r 0
+ hg qdel -r 1
+ hg qdel -r 2 
```

一切都好：

```
+ hg log
changeset:   2:6b51e14aadfc
tag:         tip
user:        Ry4an Brase <ry4an@mini>
date:        Wed Feb 25 22:29:01 2009 -0600
summary:     third

changeset:   1:5cbb9fc51bcc
user:        Ry4an Brase <ry4an@mini>
date:        Wed Feb 25 22:29:02 2009 -0600
summary:     second

changeset:   0:ec58d1f24278
user:        Ry4an Brase <ry4an@mini>
date:        Wed Feb 25 22:29:02 2009 -0600
summary:     first 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-25T23:08:37.883

有`--date`标志`hg commit`，这是您覆盖提交时间的方式。问题是如何在没有太多痛苦的情况下重新提交早期的更改。

假设您获得以下本地提交的历史记录：

```
dir1> hg commit # r100, OK
dir1> hg commit # r101, need to fix time
dir1> hg commit # r102, need to fix time 
```

这是我的解决方案：

```
hg diff -r100:101 > 101.diff
hg diff -r101:102 > 102.diff
cd ..
hg clone -r100 dir1 dir2 # create a copy just before changesets than needs to be fixed
cd dir2
patch -i ../dir1/101.diff
hg commit -m "Same commit message" --date="required date"
patch -i ../dir1/102.diff
hg commit -m "Same commit message" --date="required date"
cd ..
rm -rf dir1 &&  mv dir2 dir1 # replace working copy 
```

您可以自动应用`hg patch`我在实践中尚未使用的补丁程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-19T02:33:30.017

使用 hg`graft`和`strip`似乎是使用 MQ/patches/evolve 的更简单替代方案。

使用此方法，您`graft`将提交到第二个重复分支（同时使用 的日期更改功能`graft`）。然后从那里你可以`strip`用错误的日期返回分支。例如，你不小心创建了一些日期错误的提交，你的历史如下图所示：

```
> hg log -GT'{rev}:{desc} ({date|isodatesec})'
@  8:good commit (2018-03-18 20:13:07 2018 -0500)
|
o  7:erroneous commit two (2018-12-01 00:00:00 2018 -0600)
|
o  6:erroneous commit one (2018-12-01 00:00:00 2018 -0600)
|
o  5:commit before you started commiting bad dates 
```

要解决此问题，只需更新到错误提交之前的最后一个良好修订，然后使用以下命令将提交复制到新的（匿名）分支`graft`：

```
> hg up 5
0 files updated, 0 files merged, 1 files removed, 0 files unresolved
> hg graft -D -r6 -r7 -r8
> hg log -GT'{rev}:{desc} ({date|isodatesec})'
@  11:good commit (2018-03-18 20:14:48 2018 -0500)
|
o  10:erroneous commit two (2018-03-18 20:14:48 2018 -0500)
|
o  9:erroneous commit one (2018-03-18 20:14:48 2018 -0500)
|
| o  8:good commit (2018-03-18 20:13:07 2018 -0500)
| |
| o  7:erroneous commit two (2018-12-01 00:00:00 2018 -0600)
| |
| o  6:erroneous commit one (2018-12-01 00:00:00 2018 -0600)
|/
o  5:commit before you started commiting bad dates 
```

现在您有两个相同的分支，具有相同的提交但不同的日期。`strip`所以现在你只需要通过在旧分支上使用来返回你的线性历史：

```
> hg strip -r6 -r7 -r8
saved backup bundle to /home/miles/repo/.hg/strip-backup/ac1973513844-a8f5244e-backup.hg
> hg log -GT'{rev}:{desc} ({date|isodatesec})'
@  8:good commit (2018-03-18 20:14:48 -0500)
|
o  7:erroneous commit two (2018-03-18 20:14:48 -0500)
|
o  6:erroneous commit one (2018-03-18 20:14:48 -0500)
|
o  5:commit before you started commiting bad dates 
```

# msbuild - MSBuild exec 任务与 for

> ID：585260
> 
> 赞同：1
> 
> 时间：2009-02-25T09:10:56.010
> 
> 标签：msbuild, exec, for-loop

我正在尝试将以下命令作为 MSBuild 脚本的一部分运行：

```
for /R . %f in (*.targets) do copy /Y "%f" "C:\Program Files (x86)\MSBuild\Microso
ft\VisualStudio\TeamBuild" 
```

这些命令通过以下方式在 exec 中实现：

```
<Exec WorkingDirectory="$(SolutionRoot)" Command="for /R . %f in (*.targets) do copy /Y &quot;%f&quot; &quot;$(MSBuildExtensionsPath)\Microsoft\VisualStudio\TeamBuild&quot;" /> 
```

该命令在控制台上运行良好，但是当尝试从 MSBuild 运行它时出现错误：

```
Task "Exec"
  Command:
  for /R . %f in (*.targets) do copy /Y "%f" "C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\TeamBuild"
  f" "C:\Program was unexpected at this time.
C:\Users\rd-build\AppData\Local\Temp\OH Test2\Continuous.BuildTargets\BuildType\TFSBuild.proj(98,5): error MSB3073: The command "for /R . %f in (*.targets) do copy /Y "%f" "C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\TeamBuild"" exited with code 255.
Done executing task "Exec" -- FAILED. 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T09:18:03.247

我刚刚在你之前的问题中解释过。在这种情况下，您需要在变量前面添加额外的 % 。FOR命令的帮助说明如下

> 要在批处理程序中使用 FOR 命令，请指定 %%variable 而不是 %variable。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:17:01.987

必须使用 %% 而不是 %。

# xml - 是否有 XSLT 元素名称？

> ID：585261
> 
> 赞同：108
> 
> 时间：2009-02-25T09:11:41.920
> 
> 标签：xml, xslt, xpath

在 XSLT 中有

```
<xsl:value-of select="expression"/> 
```

获取元素的值，但是有什么东西可以选择元素的标签名吗？

在这样的情况下：

```
<person>
  <!-- required stuff -->
  <name>Robert</name>
  <!-- optional stuff, free form for future extension. 
       Using XMLSchema's xsd:any -->
  <profession>programmer</profession>
  <hobby>photography</hobby>
</person>

<xsl:for-each select="person">
   <xsl:tag-of select="."/> : <xsl:value-of select="."/>
</xsl:for-each> 
```

要获得这样的输出：

> ```
> name : Robert
> profession : programmer
> hobby : photography 
> ```

当然，上面的 XSLT 不会编译，因为

```
 <xsl:tag-of select="expression"/> 
```

不存在。但是这怎么可能呢？

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-02-25T09:19:19.423

这将为您提供当前元素名称（标签名称）

```
<xsl:value-of select ="name(.)"/> 
```

**OP-Edit：**这也可以解决问题：

```
<xsl:value-of select ="local-name()"/> 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2009-02-25T14:53:17.123

**没有人指出函数[`name()`](http://www.w3.org/TR/xpath#function-name)和[`local-name()`](http://www.w3.org/TR/xpath#function-local-name).**

*   `name(someNode)`返回节点的全名，如果节点是元素或属性，则包括前缀和冒号。
*   `local-name(someNode)`仅返回节点的本地名称，如果节点是元素或属性，则不包括前缀和冒号。

因此，在一个名称可能属于两个不同名称空间的情况下，必须使用该`name()`函数才能使这些名称仍然可以区分。

**而且，顺便说一句，可以在没有任何参数的情况下指定这两个函数**：

**`name()`** 是的缩写**`name(.)`**

**`local-name()`**是的缩写**`local-name(.)`**

**最后**，请记住，不仅元素和属性有名称，这两个函数也可以在 PI 上使用，并且它们是相同的）。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-25T09:26:08.097

```
<xsl:for-each select="person">
  <xsl:for-each select="*">
    <xsl:value-of select="local-name()"/> : <xsl:value-of select="."/>
  </xsl:for-each>  
</xsl:for-each> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-03-19T04:21:01.080

对于那些感兴趣的人，没有：

```
<xsl:tag-of select="."/> 
```

但是，您可以通过以下方式重新创建标签/元素：

```
<xsl:element name="{local-name()}">
  <xsl:value-of select="substring(.,1,3)"/>
</xsl:element> 
```

这在 xslt 模板中很有用，例如处理许多不同元素的格式化数据值。当您不知道正在处理的元素的名称时，您仍然可以输出相同的元素，并在需要时修改值。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-25T09:20:37.437

```
<xsl:value-of select="name(.)" /> : <xsl:value-of select="."/> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-28T16:54:28.660

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
    <xsl:template match="person">
        <xsl:for-each select="*">
            <xsl:text>
       </xsl:text>
            <xsl:value-of select="local-name()"/> : <xsl:value-of select="."/>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

# entity-framework - 如果可以使用 LINQ，有什么理由使用“Entity SQL”？

> ID：585264
> 
> 赞同：0
> 
> 时间：2009-02-25T09:12:38.503
> 
> 标签：entity-framework

阅读有关实体框架的书，他们说 LINQ 仅适用于 C# 和 VB.NET。但对于其他语言，您可以使用 Entity SQL。

如果你在 C# 中做一个项目，有任何理由使用 Entity SQL 吗？有这方面的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T09:28:46.030

也许它可能是在 Linq 中无法表达的东西？

虽然最好重新考虑你在做什么，因为这通常是臭代码的暗示，而不是因为 Linq 相当完整

有些人可能想将它用于动态过滤器或 orderby，但最好混合使用 Linq 和 Dynamic Linq

看

[有没有办法可以从包含代码的字符串中动态定义谓词主体？](https://stackoverflow.com/questions/566984/is-there-a-way-i-can-dynamically-define-a-predicate-body-from-a-string-containing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:21:18.340

这取决于您的项目的“大小”。

在实体很少的项目中，如果您不怕将 linq2sql 放在表示层中，它可以解决问题。

关于 Entity Framework，缺乏隐式延迟加载让我无法接受。

我会选择 ActiveRecord 或 NHibernate。

最后，你可以看看这篇文章：[是 LINQ to SQL 死了还是活了？](https://stackoverflow.com/questions/252683/is-linq-to-sql-doa)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-27T09:16:32.540

表现 ！

通过使用 Entity SQL，您可以绕过有时可能非常昂贵的 Linq 表达式编译（经常提到 30% 的改进）。

# java - 哪个会使 Class 文件更大？import java.awt.*，还是一堆或单个 import 语句？

> ID：585268
> 
> 赞同：5
> 
> 时间：2009-02-25T09:14:14.583
> 
> 标签：java, class, import, size

好的，所以如果我有一个使用的项目：

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Color;
import java.awt.Polygon; 
```

是否会使 Class 文件更小以使用：

```
import java.awt.* 
```

我正在考虑反对它，因为我正在导入很多我不需要的东西。我正在考虑它，因为它使文件的字符少了很多。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T09:17:58.223

没有不同。这些只是编译时构造。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-25T09:25:35.490

不，根本没有区别。

根据[The Java Virtual Machine Specifications, Second Edition](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html) , [Chapter 5: Loading, Linking and Initializing](http://java.sun.com/docs/books/jvms/second_edition/html/ConstantPool.doc.html)说如下：

> Java 虚拟机动态加载（第 2.17.2 节）、链接（第 2.17.3 节）和初始化（第 2.17.4 节）类和接口。加载是查找具有特定名称的类或接口类型的二进制表示并从该二进制表示创建类或接口的过程。链接是获取类或接口并将其组合到 Java 虚拟机的运行时状态以便可以执行的过程。

在编译时，没有类的链接，因此，使用通配符进行`import`ing 没有区别。其他类不一起包含在结果`class`文件中。

实际上，如果您查看`class`文件的字节码（通过[`javap`](http://java.sun.com/javase/6/docs/technotes/tools/windows/javap.html)或此类反汇编程序），您将找不到任何`import`语句，因此在源代码中包含或多或少的`import`语句数不会影响`class`文件的大小。

这是一个简单的实验：尝试编写一个程序，并`import`使用通配符使用 s 进行编译，另一个使用显式导入进行编译。生成的`class`文件应该是相同的大小。

* * *

在特定类上使用显式`import`语句可能不太可读（而且很麻烦，如果不使用会为您编写它的 Eclipse 之类的 IDE），但允许您处理两个包中类名的重叠。

例如，在和包`List`中都有一个类。通过导入这两个包，名为 的类将发生冲突：[`java.util`](http://java.sun.com/javase/6/docs/api/java/util/List.html)[`java.awt`](http://java.sun.com/javase/6/docs/api/java/awt/List.html)`List`

```
import java.util.*;
import java.awt.*;

// ... snip ... //

List l;    // which "List" are we talking about? 
```

通过仅导入您需要的特定类，可以在一定程度上避免这些冲突：

```
import java.util.Hashmap;
import java.awt.List;

// .. snip ... //
List l;    // Now we know for sure it's java.awt.List 
```

当然，如果您必须同时使用两者`java.util.List`，`java.awt.List`那么您就不走运了；您需要明确使用其完全限定的类名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T09:20:52.163

Java`import`语句不会给类文件增加任何大小。它允许编译器在编译时推断出名称所指的内容。

唯一的区别是线

```
import java.util.*; 
```

使您可以编写：

```
Set<String> set; 
```

而不是：

```
java.util.Set<String> set; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T22:02:55.203

首先，一定要看看我的“Import on Demand is Evil！” 文章：

[http://javadude.com/articles/importondemandisevil.html](http://javadude.com/articles/importondemandisevil.html)

你***永远不***应该使用 * 语法！*当代码添加*到另一个库时，它可能会导致您的程序停止编译！

现在这里是 import 的真正工作原理：

当你说

```
import a.b.c.Foo; 
```

所有这一切都是告诉编译器，当你说“Foo”时，你的意思是“abcFoo”。然后编译器将在生成的字节码中用 abcFoo 替换所有出现的 Foo。

当你说

```
import a.b.c.*; 
```

这告诉编译器“当你看到一个你不认识的符号 XXX 时，检查是否有 abcXXX”如果找到，编译器会将生成的字节码中的 XXX 替换为 abcXXX。

如果多个“*”导入与未知符号匹配，您将因歧义而收到编译器错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T09:16:27.667

我认为Java只包含你真正需要的东西......所以使用一种或另一种方式的最终编译版本不会有任何区别。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T09:16:59.083

老实说，你为什么关心你的类文件的大小？

更好的做法是显式包含所有需要的类，而不是执行“import foo.bar.*”。

这使您的代码更具可读性和可维护性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T09:18:40.860

生成的类文件完全没有变化。

导入只对编译器有影响（如果它必须索引很多目录，这可能需要更长的时间），当然还有源代码（当你可以准确地看到使用了哪些类时，IMO 更易于维护） .

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-25T10:18:35.753

如果你有兴趣使班级规模更小，[游戏制作比赛java4k](http://www.java4k.com/index.php?action=view&page=getstarted)有一些技巧，例如，这个页面[http://www.ahristov.com/tutorial/java4k-tips/java4k-tips.html](http://www.ahristov.com/tutorial/java4k-tips/java4k-tips.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T09:34:06.063

与以前的帖子中所述没有区别，但是作为偏好，我使用严格导入，因为我发现它使代码更易于阅读

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T09:49:22.923

作为对先前答案的补充，您应该看到的唯一区别是编译应该更快*一些*，当您明确告诉您想要什么`import`而不是提供通配符时，它可以包括数千个（成千上万）不必要的包和类.

# ruby-on-rails - 如何在具有 n 个条件的 ActiveRecord 中进行条件验证？

> ID：585270
> 
> 赞同：0
> 
> 时间：2009-02-25T09:14:48.527
> 
> 标签：ruby-on-rails, validation, activerecord

我正在提供由外部公司调用的 Web 服务。所需数据涵盖多个模型，包括人员、地址等。我想根据请求中的某些字段有条件地验证接收到的数据。我最终将拥有许多不同的验证数据集，尽管目前我只有一个并且我即将添加第二个。

我当前的模型看起来像这样

```
class Person < ActiveRecord::Base
    validates_length_of :first_name, :within => 1..32, :allow_blank => true
    ...
    ...
end 
```

从概念上讲，我的模型现在需要做这样的事情。

```
class Person < ActiveRecord::Base
    validate :first_name?  

    def first_name?
        if country == 'UK'
            if company_name == 'ABC'
                validates_length_of :first_name, :within => 1..32
            else if company_name == 'DEF'
                validates_length_of :first_name, :within => 2..20
            end
        else if country == 'DE'
             if company_name == 'ABC'
                validates_length_of :first_name, :within => 1..32
            else if company_name == 'DEF'
                validates_length_of :first_name, :within => 2..20
            end
    end
end 
```

这显然适用于 2 家公司/国家，但随着公司和/或国家数量的增加，效果不佳。我现在正在考虑将验证数据保存在数据库或 YAML 文件中，然后根据模型外部存储的最小、最大格式值手动为每个字段执行验证。

我在想我可以将验证数据存储在类似于以下的结构中

```
国家：英国
    公司名称：ABC  
        字段：名字  
            最小长度：2  
            最大长度：20  
            要求：真  
        字段：中间名  
            最小长度：1  
            最大长度：10  
        字段：电子邮件地址  
            最小长度：10  
            格式：/someregexforemail 地址/

    公司名称：DEF
        场地
           ...
国家：德国
    公司名称：XYZ
       场地：
         ……  

```

等等。

然后我可以加载这个验证数据并在我自己的手动验证器中使用它。

过去有没有人做过类似的事情，你使用了什么方法？我特别想知道您是如何处理以下问题的。

*   您将配置数据存储在哪里，即 DB 或 YAML？
*   您是为每个请求加载和解析配置数据还是在服务器加载时加载和解析一次？
*   您是如何构建进行验证的实际方法的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T09:39:21.433

我对电话号码做了类似的事情。您的方法与我自己的方法非常相似。要回答您的问题：

1.  我将验证配置存储在 YAML 文件中。但是，如果您的数据要在很大程度上增长，您应该考虑使用数据库。
2.  我在每个请求上加载和解析数据。不过，我认为这不是最好的方法，并计划重写这部分。
3.  我写了自己的验证。你可以在[这里](http://marklunds.com/articles/one/312)得到线索。

这对你有帮助吗？

> ID：585272
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# delphi - 销毁 TReader 时出现异常

> ID：585280
> 
> 赞同：3
> 
> 时间：2009-02-25T09:17:18.227
> 
> 标签：delphi, memory-management, file-io

以下代码在任何时候抛出一个 EZDecompressionError 并带有消息“无效的 ZStream 操作”

```
Reader.Free 
```

被执行。有人能告诉我这段代码有什么问题吗？

```
Reader := nil;
Decompressor := nil;
InputFile := TFileStream (FileName, fmOpenRead);
try
  Decompressor := TDecompressionStream.Create (InputFile);
  Reader := TReader.Create (Decompressor, 1024);
  SomeString := Reader.ReadString;
finally
  Reader.Free
  Decompressor.Free;
  InputFile.Free;
end; 
```

我测试了更改内存释放命令的顺序，但这似乎没有帮助。省略 Reader.Free 行当然会导致内存泄漏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T10:10:12.420

粉碎机

TReader 在其析构函数中执行**FStream.Seek(FBufPos - FBufCount, soCurrent)**。

由于向后搜索而引发了错误。如果在释放阅读器之前调用**Reader.FlushBuffer**和**Reader.Position := soFromBeginning**，错误会消失吗？

* * *

来自 TDecompressionstream 的评论。*TDecompressionStream 是只读且单向的；您可以在流中向前搜索，但不能向后搜索。*

问候，
利文

# c# - ASP.NET: Best practice for binding Usercontrols inside a formview

> ID：585303
> 
> 赞同：2
> 
> 时间：2009-02-25T09:23:40.050
> 
> 标签：c#, asp.net, user-controls, formview

I need to edit a complex object with complex properties using a web form. For example, editing a "User Information" record that contains all kinds of information about a user, including complex things like a unique tree for each user. What I did was this:

I created a web form with a Formview control, and set the object I want to bind as the Datasource of the Formview.

In the Formview templates I've put Usercontrols for binding each object property. The only thing I pass to the Usercontrol is the name of the property it's suppose to bind.

Inside the the Usercontrol I created server-side controls according to the type of property the Usercontrol is suppose to display. If it's a simple property like a string, I did something like this:

```
<asp:TextBox ID="textBox1" runat="server" Text='<%# Bind(PassedAttributeName) %>' /> 
```

And this works fine.

My problem is with the complex properties like things that suppose to appear in a treeview. I'm not really sure how am I suppose to bind the treeview inside my Usercontrol with a property of an object which is a Datasource of the containing Formview...

If you have an idea on how can this be done, or if you think I'm doing this whole thing wrong, any help will be appreciated.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-08T19:59:43.140

您可以将服务器控件的数据源绑定到父对象的属性。

此代码可能不是 100% 正确，但类似这样

```
<asp:FormView Id="formView1" runat="server">
    <asp:TextBox ID="textBox1" runat="server" Text='<%# Bind("FirstName")%>'/>
    <asp:Repeater ID="repeater1" runat="server" DataSource='<%# Bind("Addresses")%>'>
    //etc
    </asp:Repeater>
</asp:FormView> 
```

假设您将 FormView 绑定到具有属性地址的对象，该属性地址是更多对象的集合。

# asp.net - .net 日期期间选择器

> ID：585305
> 
> 赞同：0
> 
> 时间：2009-02-25T09:25:06.397
> 
> 标签：asp.net, user-interface

我正在寻找一个 .net 控件，它允许我的 webapp 的用户选择一个时间段。基本上类似于谷歌在其分析应用程序中提供的控件，您可以在其中选择一个日历控件中的开始和结束日期。它甚至不必启用 ajax，因为无论如何使用 ajax 技术都是违反公司准则的。我已经用谷歌搜索过了，但显然我必须使用错误的搜索查询。如果有人能告诉我这种工具的名称，那么我可以谷歌更多，或者知道这样一个很棒的工具。

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T10:04:06.820

使用 jQuery 有几个选项，例如：

*   [eyecon jQuery 日期选择器](http://www.eyecon.ro/datepicker/)
*   [使用 jQuery UI 1.6 和 jQuery UI CSS 框架的日期范围选择器](http://www.filamentgroup.com/lab/date_range_picker_using_jquery_ui_16_and_jquery_ui_css_framework/)

作为客户端小部件，您必须仅使用文本框输入控件与服务器交互（并在服务器端处理格式和解析）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T10:12:14.683

它是否一定需要是 .NET 控件？YUI 日期控件可以做到这一点。我在几个项目中使用过它，它非常可靠。只需输入几个文本框或隐藏字段，即可将您的日期发送回服务器。

# c# - 如何检查当前操作是否在对象范围内？

> ID：585306
> 
> 赞同：1
> 
> 时间：2009-02-25T09:25:29.563
> 
> 标签：c#, .net-2.0

与在 TransactionScope 范围内建立的数据库连接的行为方式类似，我希望能够在我的类内部测试它是否在另一个类的实例中？

**我的情景**

我有一个构建所有数据库对象的类 (EntityBase)，并具有诸如 AddToDatabase、UpdateInDatabase、DeleteFromDatabase 之类的方法。

我想创建一个 BulkLoader 类，它将以批量方式处理插入。这将有一个完整的方法，如 TransactionScope 类，它将数据加载到数据库中。

这将需要更改 EntityBase 类，以便如果它在 BulkLoader 类的范围内被实例化并与该类交互，它的行为会有所不同。

示例代码：

```
using (BulkLoader bulk = new BulkLoader(connection, transaction))
{
    foreach (IToDatabase assignment in assignmentsCollection)
    {
        assignment.WriteToDataBase(connection, transaction);
    }

    bulk.Complete();
}

class ClientAssignment : IToDatabase
{
     public int WriteToDataBase(IDbConnection connection, 
         IDbTransaction transaction)
     {
          foreach (EntityBase account in accountsCollection)
          {
                account.AddToDataBase(connection, transaction);
          }

          foreach (EntityBase person in personsCollection)
          {
                person.AddToDataBase(connection, transaction);
          }
     }
}

class EntityBase
{
    public virtual int AddToDatabase(IDbConnection connection, 
        IDbTransaction transaction)
    {
        // question relates to this bit
        if (inBulkLoaderClass)
        {
            // interact with bulk loader
        }
        else 
        {
            // do existing code
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T09:29:15.093

您可以使用[ThreadStaticAttribute](http://msdn.microsoft.com/en-us/library/system.threadstaticattribute.aspx)：

```
public class BulkLoader : IDisposable
{
    [ThreadStatic]
    private static BulkLoader currentBulkLoader;

    public BulkLoader()
    {
        if (InBulkLoader)
        {
            throw new InvalidOperationException();
        }
        currentBulkLoader = this;
    }

    public void Dispose()
    {
        currentBulkLoader = null;
    }

    public static bool InBulkLoader
    {
         get { return currentBulkLoader != null; }
    }

    public static BulkLoader CurrentBulkLoader
    {
         get { return currentBulkLoader; }
    }
} 
```

我一般不热衷于线程静态，但我认为在这种情况下可能没问题。构造函数中的检查确保您永远不会处于“嵌套”批量加载程序中。如果您*希望*能够嵌套它们，请改为保留一个计数器（在构造函数中递增，在 Dispose 调用中递减）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T09:30:26.307

好吧，您可以使用环境对象（特别是线程静态字段）做一些事情，但这并不漂亮。我认为如果逻辑不同，它首先应该是一个单独的方法。另外，请注意，一种观点是实体对象无论如何都不应该与数据库对话——它们的工作是表示对象的状态；存储库类（或类似的）的工作是担心持久性。然后你的存储库将有两种策略来处理事情。也许有一个 IBulkRepository 接口，repo 可以（可选地）实现，等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T09:46:42.023

I agree with Marc here. We too go with almost the same approach that Marc has shown. I guess that's the standard and optimal way to come to solution of such a problem. Though I am not much acquainted with thread static business here, so can't suggest more in that.

# java - is there a way to share a single variable by all servlet classes in java

> ID：585315
> 
> 赞同：0
> 
> 时间：2009-02-25T09:29:43.157
> 
> 标签：java, servlets

i need to know whether there is a way to change the value of a single variable by two servlet classes. in one servlet i need to make a variable =true and in another servlet i need to make the variable =false

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T09:36:22.440

如果您想要整个 Web 应用程序的全局变量，这就是[ServletContext](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/ServletContext.html)中的属性的用途 - 请务必仔细阅读文档，以便您了解这些属性的“全局”程度。

如果您希望变量是每个用户单独的，但跨 servlet 是全局的，那么这就是[HttpSession](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/http/HttpSession.html)中的属性的用途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T13:29:43.953

将数据粘贴到您的数据库（或其他持久存储）中。

有应用程序上下文，但正如 Michael Borgwardt 在他的回答中指出的那样，这实际上并不是全局的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T09:32:44.727

如果您想存储它，您可以使用 HTTPSession，然后任何 servlet 都可以访问该变量。

```
HttpSession session = request.getSession();
session.setAttribute("hello", "test"); 
```

[http://www.exforsys.com/tutorials/jsp/jsp-session-object-methods.html](http://www.exforsys.com/tutorials/jsp/jsp-session-object-methods.html)

看看那个页面，关于会话的一些基本信息。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-25T09:35:12.927

你到底想要什么？

您可以使用单例并将该变量保留在那里，或者使用会话或请求或其他任何东西......

# wmi - 更新 win32_printer 管理对象需要很长时间

> ID：585317
> 
> 赞同：0
> 
> 时间：2009-02-25T09:30:16.323
> 
> 标签：wmi, performance

我使用以下代码来更改打印机“端口”属性。问题是它执行时间超过一分钟。有没有办法加快速度？我可以不使用 wmi 对象的所有属性来实例化管理对象吗？更重要的是，我怎样才能只更新 1 个属性？也许我应该在没有搜索器的情况下实例化管理对象？

```
ManagementPath mPath = new ManagementPath();
mPath.Server = Server.TrimStart(new char[] {'\\'});
mPath.NamespacePath = "root\\cimv2";
ManagementScope mScope = new ManagementScope();
mScope.Options.Impersonation = ImpersonationLevel.Impersonate;
mScope.Path = mPath;
SelectQuery sQ = new SelectQuery();
sQ.ClassName = "Win32_Printer";

//sQ.SelectedProperties.Add("PortName");
//sQ.SelectedProperties.Add("DeviceID");

sQ.Condition = string.Format("Name=\"{0}\"", Name);

ManagementObjectSearcher s = new ManagementObjectSearcher(mScope, sQ);
foreach (ManagementObject service in s.Get())
{
string oldname = service.Properties["PortName"].Value.ToString();
service.Properties["PortName"].Value  = PortName;
service.Put( );
this.Port = PortName;
return true;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T11:56:30.260

```
 ManagementPath mPath = new ManagementPath() ;
        mPath.NamespacePath = "root\\cimv2";
        mPath.Server = Server.TrimStart(new char[] { '\\' });
        mPath.RelativePath = "Win32_Printer.DeviceID=\"" + Name + "\"";
        ManagementObject Printer = new ManagementObject(mPath);
        string oldname = Printer.Properties["PortName"].Value.ToString();
        Printer.Properties["PortName"].Value = PortName;
        Printer.Put(); 
```

这个工作得更快，虽然我认为它可以进一步改进。

# c# - 试图将密码存储到数据库

> ID：585320
> 
> 赞同：2
> 
> 时间：2009-02-25T09:32:22.637
> 
> 标签：c#, .net, database, linq-to-sql

我正在测试如何使用哈希和盐密码。好吧，我可以将哈希和盐密码添加到数据库中，但我被困在从数据库中存储密码。我有一个简单的数据库：

```
 Table
                               _______

                               ProvaHS
                               --------
                          (PK) LoginID   int 
                               UserName  nvarchar(50)
                               Password  nvarchar(50)
                               Salt      nvarchar(50) 
```

因此，我使用以下代码创建了一个表单以将新记录添加到数据库中：

```
 public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
    }

    #region SALT
    public static class PasswordCrypto
    {
        private static SHA1CryptoServiceProvider Hasher = new SHA1CryptoServiceProvider();
        //Private Hasher As New MD5CryptoServiceProvider()

        static internal string GetSalt(int saltSize)
        {
            byte[] buffer = new byte[saltSize + 1];
            RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
            rng.GetBytes(buffer);
            return Convert.ToBase64String(buffer);
        }

        static internal string HashEncryptString(string s)
        {
            byte[] clearBytes = Encoding.UTF8.GetBytes(s);
            byte[] hashedBytes = Hasher.ComputeHash(clearBytes);
            return Convert.ToBase64String(hashedBytes);
        }

        static internal string HashEncryptStringWithSalt(string s, string salt)
        {
            return HashEncryptString(salt + s);
        }
    }
    #endregion

    private void GetSalt()
    {
        this.textBoxSalt.Text = PasswordCrypto.GetSalt(16);
    }

      private void GetSaltHash()
      {
          // It's how i salt and hash the password before to save it to the Database
          this.textBoxPassword.Text = PasswordCrypto.HashEncryptStringWithSalt(this.textBoxClear.Text, this.textBoxSalt.Text);
      }

    private void GetHash()
    {
        //Demo purposes -- this is an unsalted hash
        this.textBoxClear.Text = PasswordCrypto.HashEncryptString(this.textBoxPassword.Text);
    }

    private void Add(object sender, RoutedEventArgs e)
    {
        DataClasses1DataContext dc = new DataClasses1DataContext();

        try
        {
            if (textBoxUserName.Text.Length > 0)
            {
                ProvaH tab = new ProvaH();
                tab.UserName = textBoxUserName.Text;
                tab.Password = textBoxPassword.Text;
                tab.Salt = textBoxSalt.Text;
                dc.ProvaHs.InsertOnSubmit(tab);
                dc.SubmitChanges();

            }
        }
        catch (Exception ex)
        {

            MessageBox.Show("Error!!!");
        }

    }

    private void HashButton(object sender, RoutedEventArgs e)
    {
        GetHash();
    }

    private void SaltButton(object sender, RoutedEventArgs e)
    {
        GetSalt();
    }

    private void HashSaltButton(object sender, RoutedEventArgs e)
    {
        GetSaltHash();
    }

    private void Close_W(object sender, RoutedEventArgs e)
    {
        this.Close();
    }

} 
```

}

*   使用这种方法，我可以加盐、散列并将密码保存到数据库..（遵循 StackOverflow 成员的建议）谢谢..

现在我正在测试如何从数据库中存储密码，在这里我遇到了麻烦......

```
 public partial class Login : Window
{
    public Login()
    {
        InitializeComponent();
    }
    #region SALT
    public static class PasswordCrypto
    {
        private static SHA1CryptoServiceProvider Hasher = new SHA1CryptoServiceProvider();
        //Private Hasher As New MD5CryptoServiceProvider()

        static internal string GetSalt(int saltSize)
        {
            byte[] buffer = new byte[saltSize + 1];
            RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
            rng.GetBytes(buffer);
            return Convert.ToBase64String(buffer);
        }

        static internal string HashEncryptString(string s)
        {
            byte[] clearBytes = Encoding.UTF8.GetBytes(s);
            byte[] hashedBytes = Hasher.ComputeHash(clearBytes);
            return Convert.ToBase64String(hashedBytes);
        }

        static internal string HashEncryptStringWithSalt(string s, string salt)
        {
            return HashEncryptString(salt + s);
        }
    }
    #endregion

    private void closs(object sender, RoutedEventArgs e)
    {
        this.Close();
    }

      public bool ValidateApplicationUser(string userName, string password)
      {

        bool OK = false;
          DataClasses1DataContext dc = new DataClasses1DataContext();

          object saltValue = from c in dc.ProvaHs where c.UserName == userName  select c.Salt;
          if (!(saltValue == System.DBNull.Value))
          {
              password = PasswordCrypto.HashEncryptStringWithSalt(passwordTextBox.Password, saltValue.ToString());

          }
          var query = from c in dc.ProvaHs where c.UserName == userName && c.Password == password select new { c.LoginID, c.UserName, c.Password };
          if (query.Count() != 0)
          {
              return true;
          }
       return false;
      }

    private void Confirm(object sender, RoutedEventArgs e)
    {
           bool authenticated = true;

        if (usernameTextBox.Text != "" && passwordTextBox.Password.ToString() != "") 
           {
               authenticated = ValidateApplicationUser(usernameTextBox.Text, passwordTextBox.Password.ToString());
           }
           if (!authenticated)
           {
               MessageBox.Show("Invalid login. Try again.");
           }
           else
           {
               MessageBox.Show("Aaaaahhhh.JOB DONE!!!!....");
           }
    }
} 
```

当我调试应用程序时，我总是在此代码行收到一个错误： if (query.Count() != 0) in "query" = Empty :"Enumeration yielded no results" 你有什么建议如何解决这个错误和在我的情况下从数据库存储密码？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T09:36:11.923

尝试：

```
public bool ValidateApplicationUser(string userName, string password)
{
  DataClasses1DataContext dc = new DataClasses1DataContext();

  var saltValue = dc.ProvaHs.Where(c => c.UserName == userName)
                            .Select(c => c.Salt)
                            .SingleOrDefault();

  if (saltValue == null) return false;

  password = PasswordCrypto.HashEncryptStringWithSalt(passwordTextBox.Password, saltValue.ToString());

  return dc.ProvaHs.Any(c => c.UserName == userName && c.Password == password);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T18:54:19.463

不要使用 SHA1。使用 SHA256、真正的随机盐和大量（即 8000）的 SHA256 迭代。因为 SHA 是为速度而设计的，但这意味着字典攻击速度很快。还有更好的方法，比如 scrypt 算法。或 SRP 协议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T09:36:06.107

（没有严格回答你的问题，但我还是会添加它）

您不想对输出进行十六进制编码（而不是 base64）吗？

```
public static string SHA256Hash(string Data)  
{  
    SHA256 sha = new SHA256Managed();  
    byte[] hash = sha.ComputeHash( Encoding.ASCII.GetBytes(Data) );  

    StringBuilder stringBuilder = new StringBuilder();  
    foreach( byte b in hash )   
    {  
        stringBuilder.AppendFormat("{0:x2}", b);  
    }  
    return stringBuilder.ToString();  
} 
```

（即 SHA-2，只需将 SHA256 换成 SHA1，将 SHA256Managed 换成 SHA1Managed）。

[此处的其他片段实现](http://sloppycode.net/code-snippets/cs/mda5-sha.aspx)

# oop - 何时使用记录与对象

> ID：585321
> 
> 赞同：1
> 
> 时间：2009-02-25T09:32:42.417
> 
> 标签：oop, object, records

我使用 Delphi，但我认为这是一个适用于任何面向对象编程语言的问题。

我什么时候应该在对象上使用记录。我曾经认为，当您对一组相关数据有一些简单的定义时，您会使用记录，这些数据要存储在一起，不需要能够自行操作。但是，每次我决定将一条数据与其他数据一起放入记录时，我都会想出为什么它应该是一个完全成熟的对象的原因。

1.  一条数据需要一些属性或方法几乎总是有原因的。
2.  使用对象（至少在 Delphi 中）内存管理（创建和销毁）要简单得多。
3.  就速度和内存而言，使用对象可能不会更昂贵，但更灵活。

事实上，我最近得出的结论是，在现代应用程序中，您应该在对象上使用记录的唯一情况是，如果您正在从磁盘读取可以直接读取到记录数组中的二进制文件。

我继承了一个已有 10 年历史的项目，该项目在对象上广泛使用记录来存储小块数据，我想知道是我自己还是应该将这些概念交给经验的回收站。

讨论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:28:05.763

1.  当没有方法对您的数据采取行动时，大多数时候它是无用的。所以你就在这里。

2.  对象和记录之间最大的区别之一是记录默认在堆栈上，而对象在堆上。要在堆上获取记录，您会遇到您所指的所有麻烦，但是当您可以将它们留在堆栈上时，管理对象的生命周期要容易得多。但让我们面对现实，短期记录几乎没有用处。

3.  当对象被实例化时，发生的不仅仅是保留内存，还有要管理的 VMT，而记录却没有。所以分配对象比记录要贵一点，但我想当你不谈论成千上万的项目时，它是可以忽略的。

要做出选择，您需要考虑如何使用这些对象或记录。如果您要读取大型二进制文件，则可以使用记录（将整个缓冲区读取到记录数组中可能会将它们转换为要使用的对象）。如果您正在处理结构化数据，我们的运行时生成的数据对象似乎更容易使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T18:45:00.623

如果您确实只是在处理数据，那么我认为使用记录很好。

一些典型场景：

*   报告
*   批量更新
*   在构建对象的情况下将名称/值数据绑定到下拉列表只是矫枉过正。
*   内存中的关系数据缓存
*   对大量数据执行操作

但是，正如您所指出的，这些场景在典型的 OO 应用程序中只占少数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-22T14:11:09.817

您可以在所谓的记录对象中一起使用记录和对象，其优点是可以有效地处理数据，例如一个巨大的整数加密盒，通过记录中的这些对象封装，我们获得了更快的速度和事务：

```
TKeyObjAB= record
  ID:string;
  n:TInteger; {the modulus}
  phi:TInteger; {Totient phi=(p-1)*(q-1)}
  e:TInteger; 
  d:TInteger; {private key if e relative to phi,
                which means that d*e mod phi = 1}
  blocksize:integer;    
  keysize:Integer; {bits in modulus}
  benchmark: string; //double;
end; 
```

然后用两个或多个 recobj 实例化它：

```
var
 tAlice:TKeyObjAB;
 tBob:  TKeyObjAB; 
```

构造函数是一个简单的函数来初始化你的成员：

```
function Obj_createAB(newid:string; 
  newkeysize:integer; actor:TKEYObjAB):TKeyObjAB;
begin
  with actor do begin
    id:=newid;
    keysize:=newkeysize;
    n:=TInteger.Create(0);
    phi:=TInteger.Create(0);
    e:=TInteger.create(0);
    d:=Tinteger.create(0);
    benchmark:= '';
  end;
 result:= actor;  
end;

// invoke instances
talice:= Obj_createAB('Alice', 256, talice)
tbob:= Obj_createAB('Bob', 512, tbob) 
```

# asp.net - 使用现有的 cookie 保护网站的一部分并且没有登录控制

> ID：585327
> 
> 赞同：0
> 
> 时间：2009-02-25T09:33:50.043
> 
> 标签：asp.net

我有一个小型网络应用程序，要求只保护网站的一部分。要输入主要内容，用户有两个从默认页面上的两个下拉框中的每一个中选择一个特定值，然后同意一些条款和条件。在此之后，它们被重定向到包含敏感内容的页面。这个包含敏感内容的页面应该是安全的，使用整个网站使用的原始 cookie 来防止未经授权的访问。

我可以使用表单身份验证，但是如何在不使用登录控件之类的东西的情况下保护网站的一部分？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T10:28:43.997

如果您不想使用登录控件，您可以构建自己的 FormsAuthenticationTicket 以响应用户同意您的条款和条件。

一些示例代码在这里：[http ://authors.aspalliance.com/aspxtreme/sys/web/security/FormsAuthenticationTicketClass.aspx](http://authors.aspalliance.com/aspxtreme/sys/web/security/FormsAuthenticationTicketClass.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T09:41:00.337

换句话说，您需要的是在不验证用户身份的情况下保护网站的一部分？如果匿名用户可以访问敏感内容，那么为什么要首先保护它呢？

但是，如果您只需要让用户接受条款和条件以查看敏感内容，那么您只需在用户接受条款和条件后保存 cookie，然后在显示的每个页面中查找它敏感内容的用户。如果用户没有 cookie，则将他们重定向到条款和条件页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T09:41:58.993

例如，创建一个名为 Secure 的文件夹。使用以下内容向其中添加 web.config 以进行授权：

```
<authorization>
<deny users="?"/>
</authorization> 
```

然后在您确定是否允许他们访问的页面中，只需使用：

```
FormsAuthentication.SetAuthCookie(Guid.NewGuid().ToString(),false) 
```

这样，您不必关心他们使用什么用户名，您只关心他们是否由您的站点授权。

确保您网站的主 web.config 中有相关的表单标签。

希望这可以帮助。

安德鲁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T09:49:02.657

您可以管理要在 web.config 中进行身份验证的页面或目录：

```
<location path="MySensitiveDirectory">
  <system.web>
    <authorization>
      <deny users="?" />
    </authorization>
  </system.web>
</location> 
```

有关web.config 中位置元素的[更多信息](http://msdn.microsoft.com/en-us/library/b6x6shw7(VS.71).aspx)

# ruby-on-rails - 将 :locals 参数传递给由 link_to_remote 渲染的部分

> ID：585331
> 
> 赞同：1
> 
> 时间：2009-02-25T09:35:13.660
> 
> 标签：ruby-on-rails

[来自link_to_remote](http://api.rubyonrails.org/classes/ActionView/Helpers/PrototypeHelper.html#M001613)的文档

> 然后可以将该请求的结果插入到 DOM 对象中，其 id 可以使用 options[:update] 指定。通常，结果将是由控制器使用 render :partial 准备的部分。

例如，有人会这样做：

```
<%= link_to_remote( "Some link text", :url => url, :method => method, :update => 'name_of_partial' %> 
```

有没有一种方法可以将 :locals 哈希传递给部分（在上面的示例中，'name_of_partial'），类似于使用“render :partial”渲染它的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T10:01:54.110

你不太明白。`:update`参数是`id`将其内容替换为此 ajax 调用结果的内容的元素的html。

```
<div id="ajax_message"></div>
<%= link_to_remote 'click me',
                   :url => my_ajax_action_path,
                   :update => 'ajax_message' %> 
```

有问题的部分是响应控制器中的 ajax 请求而呈现的。

```
def my_ajax_action
  @my_object = MyOobject.find(params[:id]) #or something
  render :partial => 'my_object',
         :locals => { :my_object => @my_object }
end 
```

`:update`然后通过参数将生成的响应正文推入您先前命名的元素中。

# debugging - 调试无法启动的程序

> ID：585339
> 
> 赞同：4
> 
> 时间：2009-02-25T09:37:55.960
> 
> 标签：debugging, vb6

我将如何确定为什么 VB6（或 5）应用程序无法启动？因此，我无法将调试器附加到它。我有 IDA Pro Freeware 可供我使用，但需要一些关于从哪里开始的指示。

我没有这个程序的源代码，只有.exe。当我说它没有启动时，我双击 .exe，没有任何反应 - 没有进程在运行 - nadda。

在 admin 下运行它会创建三个空文件夹，然后在显示 UI 之前静默退出。OllyDbg 告诉我有一个“不精确的浮点结果”，但我需要花几个小时或几天的时间来学习解释 OllyDbg 给我的所有信息。我关于[高级 Windows 调试](http://www.amazon.co.uk/Advanced-Windows-Debugging-Administering-Addison-Wesley/dp/0321374460)的书也应该在星期一或星期二到达。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T18:54:28.683

您是说程序启动但在附加之前崩溃？如果是这样，请尝试在调试器下启动程序。

在 Visual Studio 中，您可以通过转到

*   文件 -> 打开项目
*   选择有问题的EXE
*   按 F5

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-02T17:25:56.433

似乎我对此进行了很多回答，但请尝试查看 Windows 事件日志。这里通常有一些有用的信息，例如您的程序所依赖的控件或 dll，但未找到。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-13T15:58:58.583

首先，查看[Dependency Walker](http://www.dependencywalker.com/)，它将告诉您是否缺少应用程序所需的任何 DLL。

其次，可执行文件的名称是什么？尝试将其重命名为 MYDUMMY.EXE 并再次运行它。有些名称不起作用，因为它们已经在使用中。我曾经帮助过一个新程序员，他试图让他的第一个应用程序运行两周。它被称为 DISPLAY.EXE，它已经是一个 windows 模块，所以它不会加载。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T09:20:17.823

您是否尝试过在 cmd shell 中运行它以查看它是否将任何数据返回到控制台？是否创建了任何日志文件？

即使由于程序未启动而无法附加调试器，您也可以从调试器中启动它，OllyDbg 将允许您这样做，任何其他值得他们盐分的调试器也是如此。之后，您可以尝试调试为什么代码没有首先启动。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-15T08:27:30.797

我会使用[SysInternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx) Process Monitor，特别是遵循无法解释的研讨会视频[案例中的一些建议。](http://technet.microsoft.com/en-us/sysinternals/bb963887.aspx#)

在您启动它之前开始监控（一切），然后当您觉得它完成错误时停止监控，这应该在几秒钟内。然后，您将获得所有进程中发生的所有事件的详细日志。您可以搜索您的进程名称，并找到不成功的部分，例如可能没有权限，或者从系统收到一些其他投诉，因为您没有在通用错误陷阱中编码，所以它没有向用户报告一个对话框。好吧，即使您拥有它，也可能由于某种原因无法显示对话框。进程监控日志会告诉你。

这就像在一堆日志记录中没有编码的自动日志记录。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-18T00:06:30.750

好吧，就像[dlamblin](https://stackoverflow.com/users/459/dlamblin)提到的那样，我会从 sysinternals 中获取 ProcExp、FileMon 和 RegMon，并将它们设置为监视此过程，然后尝试启动它。您将毫无疑问地获得有关以下其中一项的信息：

*   它试图打开/访问的配置文件
*   它正在寻找的注册表项
*   进程退出时返回的错误级别

如果做不到这一点，请获取免费的 VBDecompiler，并看看这件事在它的启动代码中做了什么，这可能会引导你到某个地方......如果你抛出一个异常，并且他们有一个

```
:Err 
```

键入标签，该标签可能会掉下来，然后在没有警告的情况下退出，或任何...

我使用的 VBDecompiler 名为“setup_free-VBDecompiler.zip”。你可以用谷歌搜索它，现在甚至可能有更好的版本。但是，不要指望它会反编译成原始源代码，它只能使它成为“最好的猜测”，但至少可以方便你克服这个障碍......小心，并注意/尊重任何 EULA，这可能会阻止*任何*逆向工程......

让我知道此信息是否有帮助。如果您仍然无法到达任何地方，请与我联系，并将 .exe 发送给我，我可以在我的 Norman Sandbox 中运行它，这可能会为我们提供有关所进行的函数调用以及应用程序试图做什么的更多信息...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-26T11:46:16.987

如果没有源代码，您可能没有多少运气，但您可以查看[MSDN 上的此提示以](http://msdn.microsoft.com/en-us/library/a329t4ed(vs.71).aspx)自动启动调试器。这有点笨拙，但它适用于任何程序。我相信，表现良好的 C++ 应用程序停止在 main 上。它可以成为早期错误的救星。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-25T09:50:21.063

在你的`Sub Main`你应该确保有一个`On Error Goto`声明。有可能抛出异常但未被捕获。尝试在错误处理程序中写入日志文件，看看你得到了什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-26T12:16:07.150

我会说获取 OllyDbg 的副本，看看应用程序何时/为何决定终止。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-13T09:40:08.400

尝试检查事件日志以获取任何相关消息。

使用 Filemon 检查应用程序是否尝试访问任何文件（没有配置？让我们在没有错误消息的情况下退出..）

[http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)

我相信有类似的程序可以检查应用程序尝试对注册表进行的操作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-13T16:14:20.980

您可以编写一个简单的启动程序，在*dwCreationFlags*参数中使用 CREATE_SUSPENDED 标志调用 CreateProcess()。

它将启动您调试的程序，并且其线程将立即被冻结。然后就可以附加了。

主程序可能会等待半分钟，然后调用 ResumeThread()。到那时您将附加调试器。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-18T18:06:29.843

1.) 如果你有 MS Visual Studio 2005，它允许在命令行上运行它，如下所示：

```
devenv.exe is the executable(mostly in installation path e.g.(C:\Program Files\Microsoft Visual Studio 8\Common7\IDE) 
```

运行 devenv.exe --help 它提供了命令行选项，我为您的案例找到了一些相关选项：

devenv.exe /debugexe
打开指定的要调试的可执行文件。命令行的其余部分作为其参数传递给该可执行文件。

希望有帮助。

-广告

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-13T16:32:57.987

使用 WinDBG，您可以使用“Open Executable”（或者只是执行 windbg {executable name} 在 ntdll 中启动期间立即将调试器连接到进程，并在它获得您的代码并从那里开始运行之前在断点处停止（输入'g') 应该提供有关该问题的一些信息。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-13T20:03:13.457

另一个想法，尝试在 Windows 98 或 Windows 2000 的兼容模式（右键单击、属性、兼容性选项卡）下运行。

还授予“每个人”对程序正在创建此文件夹的文件夹的完全访问权限

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-17T10:48:13.250

“不精确的浮点结果”有时（很少，但发生在我身上）可能会指出（浮动）数字表示的问题 - 比如当程序尝试在内部解析一些硬编码的字符串并假设小数总是由句点或类似的东西分隔时。

尝试更改系统区域设置或仅更改数字或货币格式（十进制和千位分隔符）。

# perl - 使用 foreach 或在 Perl 中迭代文件有什么区别？

> ID：585341
> 
> 赞同：34
> 
> 时间：2009-02-25T09:38:24.867
> 
> 标签：perl, file, for-loop, while-loop

我在 Perl 中有一个文件句柄`FILE`，我想遍历文件中的所有行。以下有区别吗？

```
while (<FILE>) {
    # do something
} 
```

和

```
foreach (<FILE>) {
    # do something
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-25T09:50:32.013

对于大多数用途，您可能不会注意到差异。但是，在逐行遍历之前将`foreach`每一行读入**列表**（[而不是数组](http://perldoc.perl.org/perlfaq4.html#What-is-the-difference-between-a-list-and-an-array%3f)`while`），而一次读取一行。由于`foreach`会使用更多内存并需要预先处理时间，因此通常建议使用`while`遍历文件的行。

编辑（通过 Schwern）：`foreach`循环等效于：

```
my @lines = <$fh>;
for my $line (@lines) {
    ...
} 
```

不幸的是，Perl 没有像使用范围运算符 ( `1..10`) 那样优化这种特殊情况。

例如，如果我使用`for`循环和`while`循环读取 /usr/share/dict/words 并让它们在完成后休眠，我可以使用它`ps`来查看进程消耗了多少内存。作为控件，我包含了一个打开文件但不执行任何操作的程序。

```
USER       PID %CPU %MEM      VSZ    RSS   TT  STAT STARTED      TIME COMMAND
schwern  73019   0.0  1.6   625552  33688 s000  S     2:47PM   0:00.24 perl -wle open my $fh, shift; for(<$fh>) { 1 } print "Done";  sleep 999 /usr/share/dict/words
schwern  73018   0.0  0.1   601096   1236 s000  S     2:46PM   0:00.09 perl -wle open my $fh, shift; while(<$fh>) { 1 } print "Done";  sleep 999 /usr/share/dict/words
schwern  73081   0.0  0.1   601096   1168 s000  S     2:55PM   0:00.00 perl -wle open my $fh, shift; print "Done";  sleep 999 /usr/share/dict/words 
```

该`for`程序消耗了将近 32 兆的实际内存（`RSS`列）来存储我的 2.4 兆 /usr/share/dict/words 的内容。该`while`循环一次只存储一条线，仅消耗 70k 用于线缓冲。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-25T09:46:38.077

在标量上下文中 (ie `while`)`<FILE>`依次返回每一行。

在列表上下文中（即`foreach`）`<FILE>`返回一个由文件中的每一行组成的列表。

您应该使用该`while`构造。

有关更多信息，请参阅[perlop - I/O 运算符](http://perldoc.perl.org/perlop.html#I%2fO-Operators)。

编辑：j_random_hacker 正确地说

```
while (<FILE>) { … } 
```

> 践踏`$_`而 foreach 没有（foreach`$_`首先本地化）。当然，这是*最*重要的行为差异！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-25T15:43:37.033

除了前面的回复，使用的另一个好处`while`是可以使用[`$.`](http://perldoc.perl.org/perlvar.html#%24.)变量。这是最后访问的文件句柄的当前行号（请参阅 参考资料[`perldoc perlvar`](http://perldoc.perl.org/perlvar.html)）。

```
while ( my $line = <FILE> ) {
    if ( $line =~ /some_target/ ) {
        print "Found some_target at line $.\n";
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-02-04T02:38:20.057

[我在下一版Effective Perl Programming](https://rads.stackoverflow.com/amzn/click/com/0321496949)中添加了一个处理这个问题的示例。

使用 a `while`，您可以停止处理`FILE`并仍然获得未处理的行：

```
 while( <FILE> ) {  # scalar context
      last if ...;
      }
 my $line = <FILE>; # still lines left 
```

如果你使用 a ，即使你停止处理它们，你也会`foreach`消耗掉所有的行：`foreach`

```
 foreach( <FILE> ) { # list context
      last if ...;
      }
 my $line = <FILE>; # no lines left! 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T01:06:08.803

*更新：j random hacker 在评论中指出 Perl 在读取文件句柄时会在 while 循环中进行错误测试。我刚刚验证了读取错误值不会终止循环——至少在现代 perls 上。对不起，把你们都搞错了。在编写 Perl 15 年后，我仍然是个菜鸟。;)*

上面的每个人都是对的：使用`while`循环，因为它会更节省内存并为您提供更多控制权。

不过，关于该循环的一个有趣`while`之处在于，当读取为假时它会退出。通常这将是文件结尾，但如果它返回一个空字符串或一个 0 怎么办？哎呀！您的程序退出得太早了。如果文件中的最后一行没有换行符，这可能发生在任何文件句柄上。它也可能发生在具有 read 方法的自定义文件对象上，该方法不像常规 Perl 文件对象那样处理换行符。

这是修复它的方法。检查表示文件结束的未定义值读取：

```
while (defined(my $line = <FILE>)) {
    print $line;
} 
```

顺便说一句，`foreach`循环没有这个问题，即使效率低下也是正确的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-29T11:30:55.793

[*j_random_hacker*](https://stackoverflow.com/users/47984/jrandomhacker "j_random_hacker")[在对这个答案](https://stackoverflow.com/questions/585341/whats-the-difference-between-iterating-over-a-file-with-foreach-or-while-in-perl/588682#588682)的评论中提到了这，但实际上并没有把它放在自己的答案中，尽管这是另一个值得一提的区别。

不同之处在于`while (<FILE>) {}`覆盖`$_`，同时`foreach(<FILE>) {}`本地化它。那是：

```
$_ = 100;
while (<FILE>) {
    # $_ gets each line in turn
    # do something with the file
}
print $_; # yes I know that $_ is unneeded here, but 
          # I'm trying to write clear code for the example 
```

将打印出最后一行`<FILE>`。

然而，

```
$_ = 100;
foreach(<FILE>) {
    # $_ gets each line in turn
    # do something with the file
}
print $_; 
```

将打印出来`100`。要获得相同的`while(<FILE>) {}`构造，您需要执行以下操作：

```
$_ = 100;
{
    local $_;
    while (<FILE>) {
        # $_ gets each line in turn
        # do something with the file
    }
}
print $_; # yes I know that $_ is unneeded here, but 
          # I'm trying to write clear code for the example 
```

现在这将打印`100`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-11T14:08:28.507

这是一个`foreach`不起作用但`while`会完成工作的示例

```
while (<FILE>) {
   $line1 = $_;
   if ($line1 =~ /SOMETHING/) {
      $line2 = <FILE>;
      if (line2 =~ /SOMETHING ELSE/) {
         print "I found SOMETHING and SOMETHING ELSE in consecutive lines\n";
         exit();
      }
   }
} 
```

您根本无法这样做，`foreach`因为它会在进入循环之前将整个文件读入列表中，并且您将无法读取循环内的下一行。我相信即使在 foreach 中也会有解决这个问题的方法（我想到了读入数组），但肯定提供了一个非常直接的解决方案。

第二个示例是当您必须在只有 2GB RAM 的机器上解析一个大（比如 3GB）文件时。`foreach`只会耗尽内存并崩溃。我在 perl 编程生涯的早期就很难学会这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-20T01:52:33.963

foreach 循环比 while （基于条件的）更快。

# c# - 使用 linq 读取 RSS 项目

> ID：585344
> 
> 赞同：0
> 
> 时间：2009-02-25T09:40:16.250
> 
> 标签：c#, linq-to-xml

我有以下 rss 提要，我想查询它以获取具有名为子频道的特定类别的所有项目。到目前为止，我只设法到达第一个元素，但前提是它是列表中的第一个元素。我将如何编写 linq 查询来过滤 rss 提要以仅显示某个“子通道”与特定值匹配的项目，例如。“准确性”？

干杯，克里斯

```
protected void Filter()
{
    var feeds = (from item in doc.Descendants("item")
                 where
                 item.CategoryValue("Channel") == "Accomplishment"

                 select new
                 {
                     Title = item.Element("title").Value,
                     rssGuid = item.Element("guid").Value,
                     description = item.Element("description").Value,
                     link = item.Element("link").Value

                 }).ToList();

    ListView1.DataSource = feeds;
    ListView1.DataBind();

} 
```

扩展方法

```
public static class ccExtensions
{
    public static string CategoryValue(this XElement item, string type)
    {

          var category = item.Elements("category").FirstOrDefault(c => (string)c.Attribute("domain") == type
          && !string.IsNullOrEmpty(c.Value));

        return category == null ? null : category.Value;

    }
} 
```

RSS 提取

```
<item>
            <title>Time Mgmt</title>
            <description>The following is a list of sample values</description>
            <link>http://blah.com/test.aspx</link>
            <category domain="Channel"></category>
            <category domain="Channel">Goals</category>
            <category domain="SubChannel"></category>
            <category domain="SubChannel">Accountability</category>
            <category domain="SubChannel">Accomplishment</category>
            <category domain="SubChannel">Achievement</category>
            <category domain="SubChannel">Accuracy</category>
            <category domain="SubChannel">Agility</category>
            <category domain="SubChannel">Ambition</category>
            <category domain="SubChannel">Anticipation</category>
            <category domain="SubChannel">Appreciation</category>
            <category domain="SubChannel">Assertiveness</category>
            <category domain="SubChannel">Beauty</category>
            <category domain="Type"></category>
            <category domain="Type">Time Management</category>
            <guid>5e993951-da49-400b-b8d4-68b95628b9d5</guid>
</item> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T09:50:45.807

问题是您的 CategoryValue 返回单个字符串，尽管您有多个类别。我建议您将其更改为：

```
public static class ccExtensions
{
    public static IEnumerable<string> Categories(this XElement item,
                                                 string type)
    {
        return from category in item.Elements("category")
               where (string) category.Attribute("domain") == type
                     && !string.IsNullOrEmpty(category.Value)
               select category.Value;
    }
} 
```

然后将您的查询更改为：

```
from item in doc.Descendants("item")
where item.Categories("SubChannel").Contains("Accomplishment")
select ... 
```

# .net - 在没有安装 VS 的情况下运行 msbuild

> ID：585351
> 
> 赞同：9
> 
> 时间：2009-02-25T09:42:53.517
> 
> 标签：.net, c++, msbuild

我正在尝试在其中包含一些 C++ 代码的解决方案上运行 msbuild。我安装了 SDK，但没有安装 Visual Studio。我收到以下错误：

错误 MSB3411：无法加载 Visual C++ 组件“VCBuild.exe”。如果未安装该组件，请 1) 安装适用于 Windows Server 2008 和 .NET Framework 3.5 的 Microsoft Windows SDK，或 2) 安装 Microsoft Visual Studio 2008。

我在 C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcpackages 下有 vcbuild.exe

怎样才能让MSBuild找到呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T09:49:01.660

它可能就像 vcbuild.exe 不在路径中一样简单。IIRC，至少 Visual Studio 安装程序不会自动将命令行工具添加到系统或用户路径，您必须先运行 vcvars32.bat 设置它们，然后才能开始构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T20:57:38.667

您可以在此处下载所需的 Windows SDK：http: [//www.microsoft.com/downloads/thankyou.aspx? familyId=e6e1c3df-a74f-4207-8586-711ebe331cdc&displayLang=en](http://www.microsoft.com/downloads/thankyou.aspx?familyId=e6e1c3df-a74f-4207-8586-711ebe331cdc&displayLang=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T20:37:18.813

如果您没有安装正确版本的 SDK，您可以尝试带有 /toolsversion:2.0 标志的 MSBuild.exe

# .net - 从 Web 服务返回的数据集中提取数据

> ID：585352
> 
> 赞同：-1
> 
> 时间：2009-02-25T09:43:29.927
> 
> 标签：.net, web-services, soap, wsdl

有没有人提供用于提取从 Web 服务返回的数据的查询语言的来源。

我写了一个网络服务返回一个数据集，

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ToolboxItem(false)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
// [System.Web.Script.Services.ScriptService]
public class Service1 : System.Web.Services.WebService
{

    [WebMethod]
    public DataSet GetData()
    {
        AWDS ds = new AWDS();//AWDS is my dataset class name
        SalesPersonTableAdapter ta = new SalesPersonTableAdapter();
        ta.Fill(ds.SalesPerson);
        return ds;
    }
} 
```

我使用了在资源中找到的这个查询

```
<Query>
<Method Namespace="http://tempuri.org/" Name="GetData">
</Method>
<SoapAction>http://tempuri.org/GetData</SoapAction>
</Query> 
```

“这个查询语言名称是什么”

但我得到了数据集的架构（我的表列显示为记录）。

我想了解更多如何获取某个表的架构。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-10-26T18:04:05.747

转到您的 Web 服务的 URL 并将 ?wsdl 添加到它的末尾。

找到**wsdl:definitions**并查看**targetNamespace**属性。该值是**Method**的**Namespace**属性应在您的查询中设置的值。

找到**name**属性等于您要使用的方法的**wsdl:operation**元素，然后查看它下面的**soap:operation**。查看**soapAction**属性的值。该值是您将放置在查询中的**SoapAction**元素中的值。

 ******此外，请参阅以下参考资料：

[Reporting Services：使用 XML 和 Web 服务数据源](http://msdn.microsoft.com/en-us/library/aa964129%28SQL.90%29.aspx)

[用于指定 XML 报告数据 (SSRS) 的 XML 查询语法](http://msdn.microsoft.com/en-us/library/ms345251.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-25T10:07:38.387

请尝试更清楚您的要求。我不知道您发布的这个“查询”XML 是什么。它根本不是查询语言。

此外，您应该避免从 Web 服务返回 DataSet。它不能与非 .NET 平台互操作，有时也不能与 .NET 互操作。

* * *

我在 MSDN 上的 xmlDP 上找到了一些资源。请参阅[xmldp 查询语法](http://social.msdn.microsoft.com/Search/en-US/?Query=xmldp+query+syntax)。

我希望这会有所帮助。

# database - SQL Anywhere 中的表详细信息？

> ID：585355
> 
> 赞同：14
> 
> 时间：2009-02-25T09:46:06.800
> 
> 标签：database, sqlanywhere

我刚刚下载了 SQL Anywhere 的开发人员版。如何获取我连接到的数据库中的表列表？同样对于特定表，我如何获取该表的元数据（列名、类型等）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T09:53:37.827

我已经很多年没有使用 SQL-Anywhere 但是下面的语句应该可以工作

```
select c.column_name
from systabcol c 
   key join systab t on t.table_id=c.table_id 
   where t.table_name='tablename' 
```

这是直接从[较早的问题中抄袭的](https://stackoverflow.com/questions/100504/what-is-the-sql-command-to-return-the-field-names-of-a-table/100513)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T17:29:45.170

```
select * from systable  // lists all tables
select * from syscolumn // lists all tables columns 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T07:56:22.117

对于特定表：

```
describe TableName 
```

将返回表的列，并指示列的类型、是否可为空以及主键

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-14T08:57:47.463

假设 Windows：开始 - 所有程序 - SQL Anywhere 11 - Sybase Central

然后连接 - 使用 SQL Anywhere 11 连接...

选择“ODBC 数据源名称”并选择“SQL Anywhere 11 Demo”

按 OK 以查看数据库中各种对象（表等）的树形视图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-23T22:53:28.000

```
SELECT b.name + '.' + a.name
  FROM sysobjects a, sysusers b
 WHERE a.type IN ('U', 'S')
   AND a.uid = b.uid
 ORDER BY b.name, a.name 
```

这将产生一个表和有权访问它们的用户的列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-20T21:42:26.293

使用此视图：[http ://dcx.sybase.com/1001/en/dbrfen10/rf-syvcol.html](http://dcx.sybase.com/1001/en/dbrfen10/rf-syvcol.html)

尝试

```
select * from sys.syscolumns 
```

或者只是您创建的表：

```
select * from sys.syscolumns where creator=(select current user) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-29T10:58:08.843

System proc, [sa_describe_query](http://dcx.sybase.com/1200/en/dbreference/sa-describe-query-sysproc.html)很有用

`SELECT * FROM sa_describe_query('select * from TableName')`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-09T15:10:10.240

要获取数据库中使用的所有表的列表：

```
select * from systable //without 's' 
```

要获取所有列的列表：

```
select * from syscolumn //without 's' 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-22T18:44:41.143

select t.table_name, c.column_name, c.base_type_str, c.nulls from systabcol c key join systab t on t.table_id = c.table_id

[http://dcx.sap.com/1200/en/dbreference_en12/syscolumn345.html](http://dcx.sap.com/1200/en/dbreference_en12/syscolumn345.html)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-10-29T12:04:29.150

选择一张桌子详情

```
select * from Table_Name; 
```

选择两个不同的表和带有 id 的映射

```
select * from Table_1 t1,Table2 t2 where t2.id=ti.id; 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-11-11T08:49:38.817

从 user_tables 中选择 *；

desc 表名；

# php - strip_tags() 和 mysqli_real_escape_string() 的安全性

> ID：585358
> 
> 赞同：3
> 
> 时间：2009-02-25T09:47:10.480
> 
> 标签：php, security

我在一个关于信息安全的学校项目中，其中一项任务是用 PHP 编写一些安全页面。我小组中没有人知道 PHP，但这不是一个大问题，我们将学到足够的知识来创建所需的简单页面。

学生助理给出的提示之一是使用 和 两个`strip_tags()`功能`mysqli_real_escape_string()`。我认为这些是安全的，但没有深入的知识，我不确定。一些简单的谷歌搜索至少表明过去存在漏洞。由于任务的一部分是尝试破坏其他组的系统，重要的是我们自己的系统是安全的，并在其他组的系统中找到可能的漏洞。而且大部分群体都会盲目地使用这两个功能。所以我的问题是：

1.  中是否有任何已知的漏洞`strip_tags()`？
2.  中是否有任何已知的漏洞`mysqli_real_escape_string()`？
3.  是否有自然的地方可以搜索此类漏洞（除了询问 StackOverflow）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T10:55:43.747

首先，我建议您使用[Mysqli Prepared Statements](http://devzone.zend.com/node/view/id/686)。这些比转义函数[更安全](http://ilia.ws/archives/103-mysql_real_escape_string-versus-Prepared-Statements.html)，因为它将查询结构与查询参数完全分开。

您可以使用[strip_tags](http://shiflett.org/articles/foiling-cross-site-attacks)或 htmlentities 来确保没有恶意代码输出到浏览器。您可能还希望通过某种过滤功能运行[所有动态内容，然后再将其输出到浏览器。](http://joelonsoftware.com/articles/Wrong.html)这是一个组织良好且有凝聚力的 OO 方法可以提供帮助的领域，因为您可以将所有动态内容分配给单个对象，然后该对象负责将输出呈现给浏览器，这样您就可以始终感到安全，因为您知道您的内容是 XSS安全，无需在多个页面中搜索数百个回显语句。

然而，这两个建议实际上只是触及 PHP 安全性的冰山一角。还有许多其他问题也必须处理，例如：

*   [安全会话管理](http://shiflett.org/articles/the-truth-about-sessions)
*   [会话固定](http://shiflett.org/articles/session-fixation)

我建议您查看以下站点，以获取有关 PHP 安全性主题的更多和更全面的处理：

*   [shiflett.org](http://shiflett.org/articles)
*   [phpsecurity.org](http://phpsecurity.org/)（这是另一个 Chris Shiflett 网站，但我不确定他是否有其他内容不在他的个人网站上）
*   [phpsec.org](http://phpsec.org/)没有我想要的那么多内容，但是有一些有用的事情需要知道，例如使某些包含敏感信息（如数据库密码）的配置文件不存储在公开可用的目录中。

在最后一项上，如果可能的话，您将需要考虑使用 .htaccess 文件或它们的 IIS 等效文件，以确保只有您打算访问的文件是公开可用的。否则，您的所有其他安全措施都将付诸东流。

**更新：**我想到了与您项目中的安全性有关的其他几个问题。如果您还记得不久前 Twitter 管理员帐户被黑客入侵的不幸事件，那么它被允许发生有几个原因，这些原因本可以很容易解决。

1) 密码登录尝试不受限制。换句话说，如果用户尝试登录但失败，那么来自其 IP 的重复请求可能需要 2 秒来处理第二次，然后是 4 秒，以此类推。这使得机器人连续尝试登录变得不切实际。
2) 不需要安全密码。由于密码具有更高的要求（所需字符的长度和类型，例如字母数字和特殊字符），因此字典攻击变得完全不切实际，因为在破解密码时扔字典比想出随机的数字字符串要容易得多和信件。此外，随着更多字符的添加，破解密码的时间也会成倍增加。

您可以查看Jeff Atwood 的[这篇文章](http://www.codinghorror.com/blog/archives/001206.html)，了解有关此特定主题的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T09:49:07.853

对于 PHP 错误：[bugs.php.net](http://bugs.php.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T09:58:55.660

漏洞是特定于版本的，您应该指定您应该使用的 PHP 版本。如果您使用的是旧版本，则可以在[bugs.php.net](http://bugs.php.net/)或[Secunia Advisory and Vulnerability Database中轻松找到旧（已修复）漏洞](http://secunia.com/advisories/search)

# c# - 检查对远程机器的访问是否使用无线 LAN

> ID：585367
> 
> 赞同：0
> 
> 时间：2009-02-25T09:49:46.697
> 
> 标签：c#, vpn, wireless

我试图弄清楚如何通过 C# 代码确定我与远程计算机的通信是使用 WLAN 卡还是本地计算机上的有线 NIC。

例如，通过 ODBC 连接到 SQL 数据库或 UNC 文件共享来访问远程机器。如何检测通信是通过 WLAN 还是有线 LAN 进行的？

目的是警告用户该应用程序不喜欢通过 WLAN 与远程机器通信。

我对常规的 C#+.NET Framework 解决方案持开放态度，但如果有帮助，也可以使用 WMI。

下一步是确定访问是否通过 WAN/VPN 连接，但主要问题是第一个问题。

弗罗德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T11:42:57.470

Use the network information types/WMI to get routing information having done a name lookup to get all the IP addresses of the remote machine.

However, this will only ever be a guesstimate. It is quite possible for packets from your machine to go over a wired LAN, and return packets to go across the WLAN. Because it is the routing table on the remote system that determines which interface it uses and this is a local resource.

# tomcat - 配置 LDAP 时出现 Tomcat 错误

> ID：585368
> 
> 赞同：4
> 
> 时间：2009-02-25T09:50:00.080
> 
> 标签：tomcat, ldap

我在 Tomcat server.xml 文件的 Tomcat 安全领域中引用 LDAP。但是我遇到了一个不寻常的错误：Tomcat 没有启动，进入日志我看到它无法连接到 localhost:389 - Tomcat 的默认 LDAP URL。

但是，Tomcat 被配置为指向不同的 URL（不是同一台机器的外部 URL；完全不同），如下所示：

```
<Realm className="org.apache.catalina.realm.JNDIRealm" debug="99" 
        connectionURL="ldap://XXX.XX.XX.XXX:389" 
        userSubtree="true"  
        userPattern="(cn={0},ou=XXXXXXXX,ou=XXXXX,o=XXX)"  
        roleBase="ou=XXXXXXXX,o=XXX"  
        roleName="cn"  
        roleSearch="member={0}"  
        connectionName="cn=XXXXXXXX,ou=XXXXXXXX,o=XXX"  
        connectionPassword="XXXXXXXX"/> 
```

基本上我不知道为什么它还在看 localhost:389。如果有人以前遇到过这种情况，我将不胜感激！我已经用谷歌搜索了一段时间，但是当人们将错误粘贴到页面中时，似乎没有很多答案。如果有人有任何建议，我将不胜感激。

这是日志文件：

```
24-Feb-2009 11:38:45 org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8443
Starting service Tomcat-Standalone
Apache Tomcat/4.1.31
Catalina.start: LifecycleException:  Exception opening directory server connection:      
javax.naming.CommunicationException: localhost:389 
    [Root exception is java.net.ConnectException: Connection refused: connect]
LifecycleException:  Exception opening directory server connection:   
javax.naming.CommunicationException: localhost:389 
    [Root exception is java.net.ConnectException: Connection refused: connect]
at org.apache.catalina.realm.JNDIRealm.start(JNDIRealm.java:1558)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1126)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:316)
at org.apache.catalina.core.StandardService.start(StandardService.java:450)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:2143)
at org.apache.catalina.startup.Catalina.start(Catalina.java:463)
at org.apache.catalina.startup.Catalina.execute(Catalina.java:350)
at org.apache.catalina.startup.Catalina.process(Catalina.java:129)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:324)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:156)
----- Root Cause -----
javax.naming.CommunicationException: localhost:389 
    [Root exception is java.net.ConnectException: Connection refused: connect]
at com.sun.jndi.ldap.Connection.<init>(Connection.java:204)
at com.sun.jndi.ldap.LdapClient.<init>(LdapClient.java:119)
at com.sun.jndi.ldap.LdapClient.getInstance(LdapClient.java:1668)
at com.sun.jndi.ldap.LdapCtx.connect(LdapCtx.java:2599)
at com.sun.jndi.ldap.LdapCtx.<init>(LdapCtx.java:290)
at com.sun.jndi.ldap.LdapCtxFactory.getInitialContext(LdapCtxFactory.java:53)
at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:662)
at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:243)
at javax.naming.InitialContext.init(InitialContext.java:219)
at javax.naming.InitialContext.<init>(InitialContext.java:195)
at javax.naming.directory.InitialDirContext.<init>(InitialDirContext.java:80)
at org.apache.catalina.realm.JNDIRealm.open(JNDIRealm.java:1482)
at org.apache.catalina.realm.JNDIRealm.start(JNDIRealm.java:1556)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1126)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:316)
at org.apache.catalina.core.StandardService.start(StandardService.java:450)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:2143)
at org.apache.catalina.startup.Catalina.start(Catalina.java:463)
at org.apache.catalina.startup.Catalina.execute(Catalina.java:350)
at org.apache.catalina.startup.Catalina.process(Catalina.java:129)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:324)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:156)
Caused by: java.net.ConnectException: Connection refused: connect
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:305)
at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:171)
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:158)
at java.net.Socket.connect(Socket.java:452)
at java.net.Socket.connect(Socket.java:402)
at java.net.Socket.<init>(Socket.java:309)
at java.net.Socket.<init>(Socket.java:124)
at com.sun.jndi.ldap.Connection.createSocket(Connection.java:346)
at com.sun.jndi.ldap.Connection.<init>(Connection.java:181)
... 24 more
Stopping service Tomcat-Standalone
Catalina.stop: LifecycleException:  Coyote connector has not been started
LifecycleException:  Coyote connector has not been started
at org.apache.coyote.tomcat4.CoyoteConnector.stop(CoyoteConnector.java:1296)
at org.apache.catalina.core.StandardService.stop(StandardService.java:499)
at org.apache.catalina.core.StandardServer.stop(StandardServer.java:2178)
at org.apache.catalina.startup.Catalina.start(Catalina.java:494)
at org.apache.catalina.startup.Catalina.execute(Catalina.java:350)
at org.apache.catalina.startup.Catalina.process(Catalina.java:129)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:324)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:156) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-14T14:40:53.013

尝试添加与 connectionURL 具有相同值的“alternateURL”属性。出于某种原因，当我遇到类似问题时，这对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-12T22:04:21.063

我知道这是一篇很老的帖子，但我最近遇到了这个问题，问题在于我将 JNDIRealm 嵌套在 LockoutRealm 中。

通过将 JNDIRealm 作为我的顶级领域，我不再遇到所描述的问题。但是，如果您确实需要锁定领域，则此解决方案没有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T12:25:21.263

*   许多 tomcats 配置元素支持*debug*属性。尝试将*debug="99"*添加到领域配置中。（参见 tomcats [realm-howto](http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html)中的示例，搜索*debug="99"*）
*   额外确保它不是拼写错误，例如在 connectionURL 的大写*中*
*   查看 conf/server.xml 中是否还有其他提及“localhost”（或“127.0”）
*   查看 conf/*/*/*.xml 中是否提到“localhost”（或“127.0”）（尽管这不应该导致 tomcat 无法启动：它只会影响该应用程序）
*   从一个最小的 server.xml 开始——如果你使用 tomcat 5.xa 文件“server-minimal.xml”，它比默认的 server.xml 可读性更好
*   确保您不受 server.xml 中各种 xml 注释的影响——我已经被它们咬过很多次了。

# c# - .NET 的 STEP/EXPRESS 工具

> ID：585370
> 
> 赞同：8
> 
> 时间：2009-02-25T09:50:24.370
> 
> 标签：c#, .net, code-generation, step

有没有人在 .Net 环境中使用过[STEP](http://en.wikipedia.org/wiki/Standard_for_the_Exchange_of_Product_model_data/ "步")和[EXPRESS格式？](http://en.wikipedia.org/wiki/EXPRESS_(data_modeling_language)/ "表示")

我正在寻找一种基于 EXPRESS 模式生成 ac# 类结构的工具。我还想要创建解析器/文件生成器的工具，用于导入和导出到 STEP 文件。

有谁知道这样做的工具？任何能让我更接近自己的实现的工具也会很有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-10-27T22:13:46.370

我知道这是一个老问题，但我想我会为任何偶然发现它的人回答。

如果您需要使用`STEP`并且`EXPRESS`不需要 CAD 库，或者如果您需要不常见的或自定义架构，请查看使用 BSD 许可证的（**无耻插件！**）[STEPcode 。](http://github.com/stepcode/stepcode)

它生成`C++`，而不是`C#`- 但 IMO 修改 SCL 比从头开始要容易得多。

请注意，这以前称为 Step Class Library，与`SCL`上面提到的 @roch 相同。一群人在改进它，NIST 的版本已经很过时了。

**编辑：**新名称，新网址

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-07T15:26:30.203

[PDES 网站](http://www.pdesinc.com/free_STEP.html)上有一个您可能感兴趣的工具列表。例如，其中一些工具允许生成 EXPRESS 模式的 XML 表示。然后从那里实施您的工具可能会更容易。

看起来[Open CASCADE](http://www.opencascade.org/)是开源的，并且是在 .NET 环境中开发的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-31T22:59:32.003

虽然不是 .Net，但如果您对基于开放级联的高级工具感兴趣，您应该看看 pythonocc。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-26T11:42:14.607

[IFC Engine](http://www.ifcbrowser.com/)还可以通过 SDAI（标准数据访问接口）读取 STEP 文件。还有一个 C# 绑定。

# c# - C#输出参数诡计？

> ID：585372
> 
> 赞同：3
> 
> 时间：2009-02-25T09:50:44.540
> 
> 标签：c#, parameters

嗨，我有与此类似的 C# 代码：

```
int someNumber;
Thing someThing;

doStuff(out someNumber);
someThing = new Thing(someNumber); 
```

我想知道的是是否有任何方法可以删除 someNumber 并直接在参数参数中实例化 someThing 。

编辑实际代码给了我 8 个输出参数，但我只是想保持简单，所以它更像：

```
int someNumber1, someNumber2, somNumber3, someNumber4,
someNumber5, someNumber6, someNumber7, someNumber8;

Thing someThing1, someThing2, someThing3, someThing4,
someThing5, someThing6, someThing7, someThing8;

doStuff(out someNumber1, out someNumber2, out someNumber3, out someNumber4,
out someNumber5, out someNumber6, out someNumber7, out someNumber8);

someThing1 = new Thing(someNumber1); etc..................... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T09:59:22.900

好吧，如果您发现自己经常这样做，您*可以*执行以下操作：

```
public delegate void OutAction<T>(out T value);

public TResult UseOut<TIntermediate,TResult>
    (OutAction<TIntermediate> outAction,
     Func<TIntermediate,TResult> selector)
{
    TIntermediate tmp;
    outAction(out tmp);
    return selector(tmp);
} 
```

然后调用它（注意`doStuff`这里是一个方法组——缺少 () 是故意的！）：

```
Thing someThing = UseOut(doStuff, x => new Thing(x)); 
```

我不一定说这是一个好主意，只是需要考虑的事情。

编辑：当您开始获取多个参数时，它变得更加困难 - 因为 out 参数可能是第一个、第二个、第三个、第四个等......

编辑：稍微简单的版本：

```
public TResult ReturnOut<TResult>(OutAction<TResult> outAction)
{
    TResult tmp;
    outAction(out tmp);
    return tmp;
} 
```

用法：

```
Thing someThing = new Thing(ReturnOut(doStuff)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T09:54:21.210

好吧，首先，您有什么理由不能使用常规退货而不是`out`这里？它会更干净（除非有充分的理由）。

然后你可以使用：

```
someThing = new Thing(doStuff()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T09:54:10.273

并不真地。您可以传入`someThing`as `byref`，因此该`doStuff`方法会对其进行初始化，但这很讨厌。你在这里的一切都很好。

您可能应该只从 doStuff 返回一个值，在这种情况下，这是最好的方法：

```
var thing = new Thing(doStuff()); 
```

当您想要实现 TryParse 模式或需要从函数调用返回多个值时，最好使用 Out 参数。老实说，即便如此，最好还是返回一个具有包含您需要的值的属性的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T09:54:19.337

我认为这是不可能的，考虑到`doStuff`不返回值。你为什么要这样做？恕我直言，将这两个函数调用放在单独的行上无论如何都更具可读性，即使有可能，也肯定不会提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T11:54:21.950

在这种特殊情况下，你能不能不只是返回

```
List<Thing> 
```

已经实例化了objectsz？

我知道这不能回答实际问题，但在这种情况下可能很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T12:21:20.013

与 ck 的响应类似，如果所有`someNumber`变量都是整数，则可以`DoStuff()`返回 a `List<int>`or `IEnumerable<int>`，然后遍历返回的列表以设置`Thing`对象。如果您的`someNumber`变量属于不同类型，您可以创建一个返回类型来返回值的集合。但是，如果所有这些值都只是`Thing`对象的构造函数参数，我不得不同意 ck 你真的应该有`DoStuff()`return a `List<Thing>`or `IEnumerable<Thing>`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T11:44:52.753

If you can't alter the called function, and you're unwilling to wrap it, then you're stuck with the code you have.

I'd suggest wrapping it though to clean it up. I'd have it return an int array.

# java - 如何在项目中搜索返回 Collection 接口实现的所有方法？

> ID：585379
> 
> 赞同：9
> 
> 时间：2009-02-25T09:53:12.680
> 
> 标签：java, regex, search, methods, return-type

我一直在阅读 Josh Bloch 的“Effective Java 2nd Edition”。第 43 项声明“返回空数组或集合，而不是空值”。我的问题是如何搜索项目中返回 java.util.Collection 接口实现的所有方法？使用的 IDE 是 Eclipse，但任何找到正确结果的方法都是可以接受的，例如正则表达式或其他一些 IDE。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-13T15:00:01.503

在 Eclipse 帮助中找到了这个：

要搜索具有特定返回类型的方法，请使用“*”，如下所示：

1.  打开搜索对话框并单击 Java 搜索选项卡。
2.  在搜索字符串中键入“*”和返回类型，以空格分隔。
3.  选择区分大小写复选框。
4.  选择方法和声明，然后单击搜索。

它可以帮助查找返回特定类型但不返回某些接口的实现的所有方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-18T13:49:58.913

感谢您提及 SemmleCode。要查找源中返回 java.util.Collection 子类型的所有方法，请编写：

```
import default

class CollectionType extends RefType {
  CollectionType() {
    this.getASupertype*().hasQualifiedName("java.util","Collection")
  }
}

from Method m
where m.getType() instanceof CollectionType
      and
      m.fromSource()
select m 
```

也就是说，我们首先定义 CollectionType 的含义：所有以 java.util.Collection 作为超类型的类型。getASupertype 后面有一颗星，因为我们想应用该操作零次或多次。接下来我们只选择返回类型是这样一个 CollectionType 并且出现在源中的那些方法。

继续，试试看 :-) 这是一个简单的练习，可以将查询进一步细化为那些应该返回 CollectionType 但可能返回 null 的方法。所有这些都可以交互完成，在您开发查询时自动完成，并持续检查以帮助您正确完成。您可以通过多种不同方式查看结果，并轻松在分析结果和代码之间导航。

-Oege [披露：我是 Semmle 的首席执行官]

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-11T15:54:05.160

在 IntelliJ IDEA 调用结构搜索中，选择现有模板“类的方法”。该操作将添加以下模板：

```
类$类$ {
  $ReturnType$ $MethodName$($ParameterType$ $Parameter$);
}

```

将“ReturnType”变量（编辑变量操作）的文本约束设置为 java.util.Collection，指定“在层次结构内应用约束”以搜索后代。对于“MethodName”变量，指定它是搜索的目标。那开始搜索，享受:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T10:25:05.490

我不知道有一种方法可以找到返回类型是java.util.Collection 的任意实现的所有方法（包括您可以自己定义的方法）*。*

如果您可以接受更有限的解决方案，那么会想到一些可能性：

1.  转到任何导入 java.util.Collection 的类，双击“Collection”，右键单击“Collection”，然后选择“References > Project”。

2.  对于任何*特定*的感兴趣的集合类型也是如此。

3.  转到返回集合类型的任何方法，双击其返回类型，然后按上述方法搜索该类型。

4.  转到导入任何 java.util 的任何类。*任何东西*，拖过“java.util”。*省略该包前缀之后的类*，然后右键单击搜索项目引用，如上所述。

对于上述所有内容，“搜索”视图将向您显示项目中出现所选项目的位置的可展开轮廓。您可以遍历该轮廓（使用键盘 - 使用 Enter 选择 - 或鼠标 - 单击选择）以检查这些使用的位置。我看不到将查看的引用限制为“方法返回类型”的方法，但至少您可以快速移动到代码中的相关位置，以关注感兴趣的特定使用类型。

（有了所有这些，您可以单击“搜索”选项卡顶部的小向下三角形并过滤要包含在显示中的使用类型，例如排除导入语句。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T17:09:52.707

插件时间！我做了一个可以完成大部分工作的东西......

抓

[http://javadude.com/misc/collectionmarker.zip](http://javadude.com/misc/collectionmarker.zip)

[http://javadude.com/misc/collectionmarker-source.zip](http://javadude.com/misc/collectionmarker-source.zip)（如果有兴趣）

将collectionmarker.zip 解压缩到你的eclipse 目录中（你的eclipse 目录应该包含一个plugins 目录）

重启日食

工具栏上会有两个小 Eclipse 图标 - 一个清除标记，一个添加标记。

该插件搜索您工作区中的所有内容；它忽略选择。（它又快又脏）

希望这可以帮助！——斯科特

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T10:02:27.710

如果现有的用户界面没有办法做到这一点，您总是可以使用反射来遍历代码。这不是很多工作，几个嵌套循环。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T10:13:49.040

intellij IDEA 具有基于结构/表达式的搜索，因此通过搜索所有返回 Collection 的方法，您至少可以得到一些接近的结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-13T16:28:46.687

如果您的 IDE 不支持结构搜索， [PMD](http://pmd.sourceforge.net/)可以检查这一点，[SemmleCode也可以。](http://semmle.com/)

# iscsi - iSCSI 发起程序错误

> ID：585388
> 
> 赞同：1
> 
> 时间：2009-02-25T09:54:52.800
> 
> 标签：iscsi

使用 starport 连接到 iSCSI 目标时，它显示连接失败检查防火墙，当使用 microsoft iSCSI 启动器连接时，它显示目标错误。但是目标和启动器上的firefall没有问题，因为我可以使用telnet连接到目标端口3260。我尝试了不同的机器，它工作正常，一台机器有这个问题。这机器怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-26T09:33:56.600

您在什么类型的机器上运行目标？什么类型的目标？

根据我对几个 iSCSI 目标的经验，MS 的 iSCSI Initiator 是确定问题位置的一个非常可靠的指标。

出现此类错误的最常见原因是 -

1.  目标正在侦听错误的 IP 地址
2.  在 Fedora 下，默认的 iptables 配置阻止了多种类型的传入 TCP 连接——包括端口 3260

关于 Windows 的内置规则 - 至少 Win7 与其内置的 iSCSI 启动器一起工作，开箱即用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-23T13:50:12.343

你用的是什么目标？关闭使用 iSCSI 的 Windows 内置规则并手动创建规则，允许访问 3260 和 3261 端口。

# javascript - 如何防止按 ENTER 键提交 Web 表单？

> ID：585396
> 
> 赞同：219
> 
> 时间：2009-02-25T09:57:27.380
> 
> 标签：javascript, events

如何防止`ENTER`按键在基于 Web 的应用程序中提交表单？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-02-25T19:55:52.293

[ 2012***版***，无内联处理程序，保留 textarea 输入处理]

```
function checkEnter(e){
 e = e || event;
 var txtArea = /textarea/i.test((e.target || e.srcElement).tagName);
 return txtArea || (e.keyCode || e.which || e.charCode || 0) !== 13;
} 
```

现在您可以在表单上定义按键处理程序：
~~<form [...] onkeypress="return checkEnter(event)">~~

```
document.querySelector('form').onkeypress = checkEnter; 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2010-01-20T21:00:50.357

这是一个 jQuery 处理程序，可用于停止输入提交，也可以停止退格键 -> 后退。“keyStop”对象中的 (keyCode: selectorString) 对用于匹配不应触发其默认操作的节点。

请记住，网络应该是一个可访问的地方，这打破了键盘用户的期望。也就是说，在我的情况下，我正在处理的 Web 应用程序无论如何都不喜欢后退按钮，所以禁用它的快捷键是可以的。“应该输入 -> 提交”的讨论很重要，但与提出的实际问题无关。

这是代码，由您来考虑可访问性以及您实际上想要这样做的原因！

```
$(function(){
 var keyStop = {
   8: ":not(input:text, textarea, input:file, input:password)", // stop backspace = back
   13: "input:text, input:password", // stop enter = submit 

   end: null
 };
 $(document).bind("keydown", function(event){
  var selector = keyStop[event.which];

  if(selector !== undefined && $(event.target).is(selector)) {
      event.preventDefault(); //stop event
  }
  return true;
 });
}); 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-06-28T06:26:48.600

只需从 onsubmit 处理程序返回 false

```
<form onsubmit="return false;"> 
```

或者如果你想在中间有一个处理程序

```
<script>
var submitHandler = function() {
  // do stuff
  return false;
}
</script>
<form onsubmit="return submitHandler()"> 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2012-06-11T14:44:46.353

```
//Turn off submit on "Enter" key

$("form").bind("keypress", function (e) {
    if (e.keyCode == 13) {
        $("#btnSearch").attr('value');
        //add more buttons here
        return false;
    }
}); 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-02-25T11:03:49.547

You will have to call this function whic will just cancel the default submit behaviour of the form. You can attach it to any input field or event.

```
function doNothing() {  
var keyCode = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;
    if( keyCode == 13 ) {

    if(!e) var e = window.event;

    e.cancelBubble = true;
    e.returnValue = false;

    if (e.stopPropagation) {
        e.stopPropagation();
        e.preventDefault();
    }
} 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-02-25T10:29:08.320

ENTER 键仅激活表单的默认提交按钮，这将是第一个

```
<input type="submit" /> 
```

浏览器在表单中找到。

因此没有提交按钮，而是类似

```
<input type="button" value="Submit" onclick="submitform()" /> 
```

* * *

**编辑**：回应评论中的讨论：

如果您只有一个文本字段，这将不起作用 - 但在这种情况下，这可能是所需的行为。

另一个问题是这依赖于 Javascript 来提交表单。从可访问性的角度来看，这可能是一个问题。这可以通过`<input type='button'/>`用 javascript 编写，然后`<input type='submit' />`在`<noscript>`标签中放置一个来解决。这种方法的缺点是，对于禁用 javascript 的浏览器，您将在 ENTER 上提交表单。在这种情况下，由 OP 决定所需的行为是什么。

我根本不知道不调用 javascript 就无法做到这一点。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2016-05-15T18:22:00.203

简而言之，纯 Javascript 的答案是：

```
<script type="text/javascript">
    window.addEventListener('keydown', function(e) {
        if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) {
            if (e.target.nodeName == 'INPUT' && e.target.type == 'text') {
                e.preventDefault();
                return false;
            }
        }
    }, true);
</script> 
```

这只会禁用 input type='text' 的“Enter”按键操作。访问者仍然可以在整个网站上使用“Enter”键。

> 如果您还想为其他操作禁用“Enter”，您可以添加 console.log(e); 出于您的测试目的，并在 chrome 中按 F12，转到“控制台”选项卡并在页面上按“退格键”并查看其内部以查看返回的值，然后您可以定位所有这些参数以进一步增强代码以上以满足您对***"e.target.nodeName"***、***"e.target.type"***等等的需求......

[在此处查看我对类似问题的详细回答](https://stackoverflow.com/questions/5629805/disabling-enter-key-for-form/37241980#37241980)

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2017-04-13T09:06:09.980

过去，我总是使用上述按键处理程序来完成此操作，但今天找到了一个更简单的解决方案。回车键只是触发表单上第一个未禁用的提交按钮，所以实际上所需要的只是拦截试图提交的按钮：

```
<form>
  <div style="display: none;">
    <input type="submit" name="prevent-enter-submit" onclick="return false;">
  </div>
  <!-- rest of your form markup -->
</form> 
```

而已。按键将由浏览器/字段/等照常处理。如果触发了输入-提交逻辑，则浏览器将找到隐藏的提交按钮并触发它。然后 javascript 处理程序将阻止提交。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-02-15T16:49:53.300

我在此主题、此处或其他帖子中找到的所有答案都有一个缺点，那就是它也阻止了表单元素上的实际更改触发器。因此，如果您运行这些解决方案，onchange 事件也不会被触发。为了克服这个问题，我修改了这些代码并为自己开发了以下代码。我希望这对其他人有用。我为我的表单“prevent_auto_submit”提供了一个类，并添加了以下 JavaScript：

```
$(document).ready(function() 
{
    $('form.prevent_auto_submit input,form.prevent_auto_submit select').keypress(function(event) 
    { 
        if (event.keyCode == 13)
        {
            event.preventDefault();
            $(this).trigger("change");
        }
    });
}); 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-10-15T11:02:47.633

我花了一些时间为 IE8、9、10、Opera 9+、Firefox 23、Safari (PC) 和 Safari(MAC) 制作这款跨浏览器

**JSFiddle 示例：http:** [//jsfiddle.net/greatbigmassive/ZyeHe/](http://jsfiddle.net/greatbigmassive/ZyeHe/)

基本代码 - 通过附加到表单的“onkeypress”调用此函数并将“window.event”传递给它。

```
function stopEnterSubmitting(e) {
    if (e.keyCode == 13) {
        var src = e.srcElement || e.target;
        if (src.tagName.toLowerCase() != "textarea") {
            if (e.preventDefault) {
                e.preventDefault();
            } else {
                e.returnValue = false;
            }
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-01-20T21:23:29.523

```
stopSubmitOnEnter (e) {
  var eve = e || window.event;
  var keycode = eve.keyCode || eve.which || eve.charCode;

  if (keycode == 13) {
    eve.cancelBubble = true;
    eve.returnValue = false;

    if (eve.stopPropagation) {   
      eve.stopPropagation();
      eve.preventDefault();
    }

    return false;
  }
} 
```

然后在您的表格上：

```
<form id="foo" onkeypress="stopSubmitOnEnter(e);"> 
```

不过，如果你不使用突兀的 JavaScript 会更好。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-03-01T13:10:51.207

要防止在按下或字段时提交表单`enter`，`textarea`请`input`检查提交事件以查找发送事件的元素类型。

## 示例 1

### HTML

```
<button type="submit" form="my-form">Submit</button>
<form id="my-form">
...
</form> 
```

### jQuery

```
$(document).on('submit', 'form', function(e) {
    if (e.delegateTarget.activeElement.type!=="submit") {
        e.preventDefault();
    }
}); 
```

更好的解决方案是，如果您没有提交按钮并且使用普通按钮触发事件。更好是因为在第一个示例中触发了 2 个提交事件，但在第二个示例中仅触发了 1 个提交事件。

## 示例 2

### HTML

```
<button type="button" onclick="$('#my-form').submit();">Submit</button>
<form id="my-form">
...
</form> 
```

### jQuery

```
$(document).on('submit', 'form', function(e) {
    if (e.delegateTarget.activeElement.localName!=="button") {
        e.preventDefault();
    }
}); 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-10-05T06:52:22.000

阻止“ENTER”提交表单可能会给您的一些用户带来不便。因此，如果您按照以下步骤进行操作会更好：

在表单标签中写入“onSubmit”事件：

```
<form name="formname" id="formId" onSubmit="return testSubmit()" ...>
 ....
 ....
 ....
</form> 
```

编写Javascript函数如下：

```
function testSubmit(){
  if(jQuery("#formId").valid())
      {
        return true;
      }
       return false;

     } 

     (OR) 
```

不管是什么原因，如果你想阻止按 Enter 键提交表单，你可以在 javascript 中编写以下函数：

```
 $(document).ready(function() {
          $(window).keydown(function(event){
          if(event.keyCode == 13) {
               event.preventDefault();
               return false;
              }
           });
         }); 
```

谢谢。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-09-01T22:27:25.853

就我而言，这个 jQuery JavaScript 解决了这个问题

```
jQuery(function() {
            jQuery("form.myform").submit(function(event) {
               event.preventDefault();
               return false;
            });
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-05-12T23:14:02.270

你会发现这更简单和有用：D

```
$(document).on('submit', 'form', function(e){
    /* on form submit find the trigger */
    if( $(e.delegateTarget.activeElement).not('input, textarea').length == 0 ){
        /* if the trigger is not between selectors list, return super false */
        e.preventDefault();
        return false;
    } 
}); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-10-19T15:17:03.293

怎么样：

```
<asp:Button ID="button" UseSubmitBehavior="false"/> 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-07-18T11:11:54.057

将此标签添加到您的表单 -`onsubmit="return false;"` 然后您只能使用一些 JavaScript 函数提交您的表单。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-10-13T09:40:54.363

请查看这篇文章[如何防止按 ENTER 键提交 Web 表单？](https://pranabeshchand.wordpress.com/2015/10/13/how-to-prevent-enter-keypress-to-submit-a-web-form/)

```
$(“.pc_prevent_submit”).ready(function() {
  $(window).keydown(function(event) {
    if (event.keyCode == 13) {
      event.preventDefault();
      return false;
    }
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form class=”pc_prevent_submit” action=”” method=”post”&gt;
  <input type=”text” name=”username”&gt;
  <input type=”password” name=”userpassword”&gt;
  <input type=”submit” value=”submit”&gt;
</form>
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-25T09:59:39.903

我认为，您可以在 javascript 中的表单上捕获 keydown 并防止冒泡。网页上的 ENTER 基本上只是提交当前选择的控件所在的表单。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-04-25T04:03:19.903

此链接提供了一个在 Chrome、FF 和 IE9 以及 IE9 开发人员工具 (F12) 附带的 IE7 和 8 模拟器中对我有用的解决方案。

[http://webcheatsheet.com/javascript/disable_enter_key.php](http://webcheatsheet.com/javascript/disable_enter_key.php)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-11-20T14:22:42.610

另一种方法是仅在应该提交时将提交输入按钮附加到表单，并在表单填写期间将其替换为简单的 div

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2013-03-08T23:33:19.210

只需将此属性添加到您的 FORM 标签：

```
onsubmit="return gbCanSubmit;" 
```

然后，在您的 SCRIPT 标记中，添加以下内容：

```
var gbCanSubmit = false; 
```

然后，当您制作按钮或出于任何其他原因（例如在函数中）您最终允许提交时，只需翻转全局布尔值并执行 .submit() 调用，类似于此示例：

```
function submitClick(){

  // error handler code goes here and return false if bad data

  // okay, proceed...
  gbCanSubmit = true;
  $('#myform').submit(); // jQuery example

} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-02-10T00:56:58.527

怎么样：

```
<script>
function isok(e) {
  var name = e.explicitOriginalTarget.name;
  if (name == "button") {
    return true
  }
  return false;
}
</script>
<form onsubmit="return isok(event);">
<input type="text" name="serial"/>
<input type="submit" name="button" value="Create Thing"/>
</form> 
```

只需将您的按钮命名正确，它仍会提交，但文本字段，即当您按回车键时的explicitOriginalTarget，将没有正确的名称。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-09-21T03:43:56.780

我自己也遇到过这个问题，因为我有多个具有不同“名称”值的提交按钮，因此提交时它们在同一个 php 文件上执行不同的操作。`enter`/按钮打破了这`return`一点，因为这些值没有提交。所以我在想，`enter`/`return`按钮是否激活了表单中的第一个提交按钮？这样，您可以拥有一个隐藏的“香草”提交按钮，或者具有将执行的 php 文件返回到其中包含表单的页面的“名称”值。或者，按键激活的默认（隐藏）“名称”值，并且提交按钮用它们自己的“名称”值覆盖。只是一个想法。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-11-15T19:27:05.200

Here's how I'd do it:

```
window.addEventListener('keydown', function(event)
{
    if (event.key === "Enter" && event.target.tagName !== 'TEXTAREA')
    {
        if(event.target.type !== 'submit')
        {
            event.preventDefault();
            return false;
        }
    }
}); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-09-23T15:23:28.567

如果这些答案都不适合你，试试这个。在实际提交表单的按钮之前添加一个提交按钮，并且对事件不执行任何操作。

HTML

```
<!-- The following button is meant to do nothing. This button will catch the "enter" key press and stop it's propagation. -->
<button type="submit" id="EnterKeyIntercepter" style="cursor: auto; outline: transparent;"></button> 
```

JavaScript

```
$('#EnterKeyIntercepter').click((event) => {
    event.preventDefault(); //The buck stops here.
    /*If you don't know what this if statement does, just delete it.*/
    if (process.env.NODE_ENV !== 'production') {
        console.log("The enter key was pressed and captured by the mighty Enter Key Inceptor (⌐■_■)");
    }
}); 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-09-02T09:16:18.670

这对我有用。
**onkeydown="return !(event.keyCode==13)"**

```
 <form id="form1" runat="server" onkeydown="return !(event.keyCode==13)">

   </form> 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2014-11-13T16:39:02.887

放入javascript外部文件

```
 (function ($) {
 $(window).keydown(function (event) {  

    if (event.keyCode == 13) {

        return false;
    }
});

 })(jQuery); 
```

或身体标签内的某处

```
<script>

$(document).ready(function() {
    $(window).keydown(function(event) {
        alert(1);

        if(event.keyCode == 13) {

            return false;
        }
    });
});

</script> 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2015-03-08T11:02:30.820

我遇到了同样的问题（带有大量文本字段和不熟练用户的表单）。

我以这种方式解决了它：

```
function chkSubmit() {
    if (window.confirm('Do you want to store the data?')) {
        return true;
    } else {
        // some code to focus on a specific field
        return false;
    }
} 
```

在 HTML 代码中使用它：

```
<form
    action="go.php" 
    method="post"
    accept-charset="utf-8"  
    enctype="multipart/form-data"
    onsubmit="return chkSubmit()"
> 
```

通过这种方式，`ENTER`密钥按计划工作，但需要确认（`ENTER`通常是第二次点击）。

`ENTER`如果他决定留在表单上，​​我会留给读者寻找一个脚本，将用户发送到他按下的字段中。

# .net - 如何在发布模式下为 .net 托管项目生成 PDB？

> ID：585397
> 
> 赞同：8
> 
> 时间：2009-02-25T09:58:20.327
> 
> 标签：.net, msbuild, debug-symbols, release-mode

我知道通过为编译器提供 /debug 参数来为 .NET中的*托管*项目生成 PDB 。有没有办法在 VS (2005) GUI 中指定这个？

到目前为止，我可以让它在发布模式下生成 PDB 的唯一方法是手动修改 .csproj 文件并添加：

```
<DebugSymbols>true</DebugSymbols>
<DebugType>full</DebugType> 
```

在“发布”设置下：

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' "> 
```

另一件事：我从 MSDN [here](http://msdn.microsoft.com/en-us/library/bb629394.aspx)`DebugType`了解到，该标签的可能值是：

*   `full`
*   `pdbonly`
*   `none`

这些值如何影响编译器的行为？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T10:03:12.123

在 VS2008 中，您可以使用项目属性`->`Build `->`Advanced... `->`Debug Info 来设置属性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T16:35:31.930

在调试中：

```
<DebugSymbols>true</DebugSymbols>
<DebugType>full</DebugType>
<Optimize>false</Optimize> 
```

在发布中：

```
<DebugSymbols>true</DebugSymbols>
<DebugType>pdbonly</DebugType>
<Optimize>true</Optimize> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T10:01:04.017

我发现[这个 MONO 请求](http://www.mail-archive.com/mono-bugs@lists.ximian.com/msg60086.html)可能会阐明 ' `full`' 和 ' `pdbonly`' 之间的区别。

> csc 有一个“pdbonly”调试类型，可以生成 pdb，同时生成运行时代码，即优化，没有调试器属性等。
> 
> 这对于能够从发布质量代码中获得有用的堆栈跟踪非常重要。

在我看来，2 个标签（DebugSymbols 和 DebugType）的存在是多余的。

# c# - c#代码效率

> ID：585406
> 
> 赞同：1
> 
> 时间：2009-02-25T10:00:53.957
> 
> 标签：c#

我必须计算给定时间段之间的工作日数，这很简单，但是考虑到公共假期会增加复杂性。

我的解决方案不是我所说的优雅或高效，因为它检索公共假期并将它们放入列表中，检查列表中的日期是否与给定时间段内的日期匹配，通过从开始增加日期来检查日期。

虽然这很好用，但我宁愿有一个更有效的算法有没有人有任何提示或推荐不同的数据结构来举行公共假期？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T10:04:02.717

如果您已将公共假期按顺序存储在列表中，您只需进行二分搜索即可查找列表中您的时间段开始的位置，另一个查找列表中时间结束的位置期间下降。然后，您只需要取“正常”差异（除去周末）并减去二进制搜索结果之间的项目数。

请注意公共假期开始或结束的时间段！

([`List<T>.BinarySearch`](http://msdn.microsoft.com/en-us/library/3f90y839.aspx)假设您使用 DateTime 或其他一些自然可比较的时间结构，该方法应该适合您。请注意，如果您要搜索的键实际上不在列表中（它不会是最时间）。请参阅文档中的备注。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:06:57.403

如果您计算两个日期之间的工作日数，那么

```
TimeSpan t1 = Date1 - Date2;
int totalDays = t1.TotalDays; 
```

然后使用您的两个日期，计算列表中介于总天数之间并减去总天数的公共假期数。

我认为这会起作用，除非那里有一些公共假期跨越数天，然后您将不得不调整您的选择逻辑。你能粘贴你到目前为止所做的事情来判断你在哪里以及你正在使用什么方法吗？:-)

谢谢，

安德鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-02T19:38:01.347

以下是如何以最高效率计算工作日：

[http://alecpojidaev.wordpress.com/2009/10/29/work-days-calculation-with-c/](http://alecpojidaev.wordpress.com/2009/10/29/work-days-calculation-with-c/)

# sockets - 网页如何与本地富客户端应用程序通信

> ID：585417
> 
> 赞同：0
> 
> 时间：2009-02-25T10:04:31.357
> 
> 标签：sockets, applet, communication, client-side

我需要实现一个流程，让用户在网页中输入一些细节，并将这些信息作为某种事件触发到同一主机上的 Java 富客户端应用程序 (SWING)。

一个想法可能是实现一个小程序，该小程序将启动与 SWING 应用程序实现的侦听器的套接字通信，但不确定这是否可能。

这种令人费解的整合基本上是一个既定的事实。本质上，Web 应用程序和 SWING 应用程序都已经处于活动状态并正在使用中。唯一缺少的一点是以易于实现的方式在两者之间共享信息。无论多么肮脏。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:08:38.990

如果没有别的，这对用户来说听起来有点混乱。

我会选择两种方式之一。

1.  让您的富客户端通过网络进行通信。并把你要在浏览器中使用的任何形式放在那里。
2.  将您的富客户端放入小程序。
3.  让两者都连接到某个地方（甚至是本地）的服务器，您的富客户端可以轮询该服务器以查看表单是否已填写。

# database-design - 多变量类型数据采集的数据库设计

> ID：585418
> 
> 赞同：1
> 
> 时间：2009-02-25T10:04:35.163
> 
> 标签：database-design, data-acquisition

我将设计和实现用于数据采集的数据库，并开始思考什么是多变量解决方案的最佳关系数据库结构。可以有几十个变量（可配置），不同的类型（布尔，整数，至少浮点数，也许是字符串）。不同变量的值不相关。我需要存储变量、新值和时间戳。存储变量由时钟或值的变化触发。

最简单的解决方案是一张带有变量 FK、新值和时间戳的表，但由于变量可以有不同的类型，新值的类型会导致问题。我认为可能的解决方案很少，都涉及变量定义的单独表和时间序列的一个或多个表，每个变量值时间戳一个记录：

1.  有一些可以存储所有值的通用数据类型（字符串？）
2.  有多个列，每种类型一个
3.  数据值有多个表，每种类型一个表

还有什么？

基本上我正在寻找好的“数据库设计模式”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:08:35.543

尝试[EAV（实体-属性-值）模型](http://en.wikipedia.org/wiki/Entity-attribute-value_model)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:16:23.153

数据库调用的开销超过了从字符串解析数字/布尔值的任何开销。您可能希望为类型（1 = Int、2 = Dbl、3 = String、4 = Bool、5 = date 等）添加一列，以便您的代码可以选择正确的操作来处理数据库。像（在我的脑海中）：

```
create table foo_values (
  -- optional fkey to select which foo this key/value belongs to
  foo_uid number(18,0) not null enable,
  key nvarchar2(64) not null enable,
  -- could be a fkey to a table of types, or an enum, etc, 
  -- depending on database support  
  datatype number(2) not null enable, 
  value nvarchar(256)
  created timestamp default systimestamp not null enable,

  -- Foreign key and index stuff here, etc ...
) 
```

# architecture - 使用无法修改的完全独立的继承树子类化类

> ID：585420
> 
> 赞同：0
> 
> 时间：2009-02-25T10:06:38.373
> 
> 标签：architecture, inheritance, multiple-inheritance

考虑到任何一个类的继承树都不能修改为从另一个继承的限制，有人如何将两个具有独立继承树的类连接起来以桥接上下文边界？

即，如果作为实体的项目保存到数据库中，假设：

```
public class Stockitem : StockItemBase {
...
} 
```

需要使用绘图组件显示，比方说：

```
Public class GraphicNode : BaseNode { ... } 
```

简单地有一个子类会很好，`stockitemgraphicnode`因为有很多常见的成员。

设计解决方案的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T10:15:46.307

作品。

创建一个新类，该类既不继承自其中，又具有要在其中使用的两个类的实例，然后公开要调用的方法。

谷歌“Composition over Inheritence”在这个主题上比我的要好得多

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:14:34.530

使用多重继承是可能的，如果树是完全独立的，你就不会有[菱形问题](http://en.wikipedia.org/wiki/Diamond_problem)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T10:47:19.600

如果语言允许，可以使用多重继承。不过我对此了解不多。

`StockItemNode : GraphicNode`否则，您可以从 a构建a `StockItem`：

```
class ItemNodeFactory
{
  ...
  StockItemNode create(StockItem);
  ...
} 
```

您可以将属性从(set-get)`StockItem`的实例中传输`StockItemNode`，这将完全分离这两种类型。或者你可以包装一个（组合）`StockItemNode`的实例。`StockItem`

反过来做（在a 中包含`NodeStockItem : StockItem`和/或包装 a `GraphicNode`）`StockItem`会导致特别糟糕的设计，因为您不想将耦合硬连接到`GraphicNode`域/业务/数据实体 ( ) 中的特定表示 ( `StockItem`)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T10:14:42.033

您可能在 StockItem 中有一个 GraphicNode 对象的实例。

这个命名组合：[http ://en.wikipedia.org/wiki/Object_composition](http://en.wikipedia.org/wiki/Object_composition)

然后在 StockItem 中创建方法，这些方法将简单地将实际工作[委托](http://en.wikipedia.org/wiki/Delegation_(programming))给封闭的 GraphicNode。

# wpf - 在 DynamicResources 上使用 BasedOn 样式属性

> ID：585429
> 
> 赞同：29
> 
> 时间：2009-02-25T10:10:27.083
> 
> 标签：wpf, xaml

我想知道是否有办法将 wpf 样式的 basedOn 属性与动态资源一起使用。例如

```
<Style BasedOn="{DynamicResource somestyle}">
   <Setter Property="SomeProp" Value="SomeValue"/>
</Style> 
```

这例如抛出一个错误，表明动态资源与 BasedOn 样式结合使用是不可能的。我想知道有人怎么能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-25T14:37:05.883

我认为主要原因是密封的物体。如果您有样式层次结构：

```
 Style A
      /       \
  Style A1  Style A2 
```

这可能不是一个困难的情况。您指的是`StyleA`使用动态资源，因此每当该资源发生更改时，`Style A1`都`Style A2`应该更改其`BasedOn`属性。但是，一旦在您的应用程序中使用 Style，它就会变成一个密封的对象。`Style A`变得不可变。

您可以使用的一种解决方法是：

1.  `Style A`需要改变。
2.  创建一个将成为新`Style A`资源的新 Style 对象。
3.  创建`Style A1`和的新版本`Style A2`。您需要编写一个复制过程来复制所有`Setters`,`Resources`等。将 设置`BasedOn`为`Style A`.
4.  更新资源集合，以便其中包含三种新样式。

`{DynamicResource StyleA1}`现在`{DynamicResource StyleA2}`应该了解这些资源发生变化的事实（从第 4 步开始）并自动更新任何引用。

请注意，这是一个非常简单的场景。现实世界的风格层次结构可能更复杂，尤其是当它们分布在多个文件中并且来自合并的字典时。

希望我了解您的问题并提供帮助。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-02-17T10:19:21.780

我发现，由于您不能`BasedOn`在 a 上使用，您可以通过将持有的“父”资源合并到当前的 Window/UserControl/whatever`DynamicResource`来“转换” `DynamicResource`to 。这样，您现在可以使用. 这样您就可以使用on （通过转换）。`StaticResource``ResourceDictionary``Style``StaticResource``Datatriggers``DynamicResource`

例子：

```
<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/MyProject.Styles;component/ButtonStyles.xaml"/>
        </ResourceDictionary.MergedDictionaries>
        [*Your other resources can be put here*]
    </ResourceDictionary>
</Window.Resources>

...

<Button Command="{Binding MyCommandInViewModel, RelativeSource={RelativeSource AncestorType=Window}}">
    <Button.Style>
        <Style BasedOn="{StaticResource StyleFromButtonStyles}" TargetType="Button">
            <Style.Triggers>
                <DataTrigger Binding="{Binding SomeBool}" Value="True">
                    <Setter Property="Button.Content" Value="{StaticResource SomeImage}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding SomeBool}" Value="False">
                    <Setter Property="Button.Content" Value="{StaticResource SomeOtherImage}"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Button.Style>
</Button> 
```

因此`Datatriggers`应用于在导入的`ResourceDictionary`.

希望这可以帮助！

# sql - 约束 - 唯一或空

> ID：585430
> 
> 赞同：0
> 
> 时间：2009-02-25T10:10:28.847
> 
> 标签：sql, sql-server-2005

表中有一个允许空值的 nvarchar 列。一旦有一个非空值，它就必须是唯一的。

是否可以在没有触发器的情况下定义此规则？

编辑：

[http://decipherinfosys.wordpress.com/2007/11/30/multiple-null-values-in-a-unique-index-in-sql-serverdb2-luw/](http://decipherinfosys.wordpress.com/2007/11/30/multiple-null-values-in-a-unique-index-in-sql-serverdb2-luw/)

是一个很好的解决方法。我看到的唯一问题是主键在某些时候可能与我想要唯一的列中的一个值相同。这就是为什么我添加了一个我知道永远不会出现在受约束列中的固定字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:22:53.763

[http://decipherinfosys.wordpress.com/2007/11/30/multiple-null-values-in-a-unique-index-in-sql](http://decipherinfosys.wordpress.com/2007/11/30/multiple-null-values-in-a-unique-index-in-sql-serverdb2-luw/)中的唯一键列中有多个 NULL 值的解决方法[-serverdb2-luw/](http://decipherinfosys.wordpress.com/2007/11/30/multiple-null-values-in-a-unique-index-in-sql-serverdb2-luw/)

基本上在文章中，他们制作了一个额外的专栏，他们保持独特。如果您的原始列*不*为空，则其内容将复制到唯一列中。只要它为空，就会将主键复制到列中。这是一种解决方法，但它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:32:18.310

tehvan 发布的链接中未提及的一种解决方案是索引视图。（创建一个视图，排除具有空列值的行，并在视图上添加唯一索引）。

如果您不想向基表添加其他列，则可能首选此方法。这两种方法都需要您启用正确的 ANSI 设置。

# php - PHP文件上传问题

> ID：585431
> 
> 赞同：1
> 
> 时间：2009-02-25T10:13:05.283
> 
> 标签：php, apache, file-upload

我在文件上传方面遇到了一个非常烦人的问题。

用户可以在 html 文件字段中选择文件。当他们提交表单时，该文件将被上传。

在服务器端，我只使用标准的 PHP 代码（move_uploaded_file）。我没有做任何奇怪的事情。

一切都很完美。

我可以在服务器上看到文件，我可以再次下载它，...

但是有时这不起作用。我上传文件，处理它，我没有收到任何错误。

但是该文件在服务器上不存在。

每次我上传该特定文件时，我都没有收到任何错误，但它永远不会被保存。

只有当我重命名它（例如 test.file 到 tst.file）我才能上传它并且它实际上会被保存。

我很少遇到这个问题。重命名总是有效的。但我显然不能要求用户重命名他们的文件......

我无法访问 apache tmp 文件目录，也无法访问日志或设置，因此这使得调试更加困难。我只在这个特定的服务器上遇到这个问题（我不管理它；我什至无权访问它），我在许多没有这个问题的服务器上使用完全相同的代码。

如果有人可以在这里帮助我或为我指明正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T10:23:04.743

尝试添加此调试代码：

```
echo '<pre>';
print_r($_FILES);
echo '</pre>'; 
```

您应该会看到一个错误编号。[您可以在http://uk3.php.net/manual/en/features.file-upload.errors.php](http://uk3.php.net/manual/en/features.file-upload.errors.php)查找它的含义

可能还值得检查以确保目标文件不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T11:23:06.707

My first thought was filesize issues. In the php.ini, if the post_max_size or upload_max_filesize are too small, you can end up with similar results - where the file just seems to disappear. You would get an error in the apache logs (which you mention you've no access to).

In those cases, the $_FILES array would simply be empty - as if the file never arrived. Since your responses to [Gumbo](https://stackoverflow.com/questions/585431/php-file-upload-problem/585446#585446) and [James Hall](https://stackoverflow.com/questions/585431/php-file-upload-problem/585449#585449) show that php is reporting a proper upload, I'm led to wonder about the processing you mention.

If, during the process, your memory gets maxed or the script runs too long, the script may be dying out before it gets a chance to move it. You'll want to check these:

memory_limit

max_execution_time

max_input_time

Otherwise, without the apache logs, I'd say it might be a good idea to start outputting to a log file of your own throughout your file processing script. Try a file_exists on the tmp file, see what info you can get from the file (permissions, etc).

Unfortunately PHP doesn't get involved until the upload is finished, which means you won't get much info during - only after the fact. You best option might be to talk to the hosting company and get access to the logs - even if for a short time. In my experience, I've rarely had trouble getting ot the logs - or at least getting a tech to check the logs for me while I run tests (in the case where a shared server doesn't split their logs - seems ridiculous, but I've seen it before).

Edit: I realize you can't change those php settings, but you might want to see what they are in order to find out if they're potential problems for your script. For instance, a low memory limit will kill your processor script if it's less than the size of the uploaded file.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T10:21:00.133

如果上传失败，您不会收到类似 PHP 语法错误等的错误。

但是您可以自己检查[文件上传状态](http://docs.php.net/manual/en/features.file-upload.errors.php)并向用户报告错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-21T19:01:19.577

# sql - 回滚完整数据库一小时

> ID：585441
> 
> 赞同：4
> 
> 时间：2009-02-25T10:16:51.047
> 
> 标签：sql, sql-server, sql-server-2005

今天早上我们遇到了一些问题，需要回滚数据库大约一小时。这可能吗？它是如何完成的？

它是一个 Microsoft SQL 2005 数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T10:40:57.790

1.  查找数据库的先前完整备份 (BF1)。
2.  备份日志文件 (BL1)。
3.  对数据库 (BF2) 进行完整备份。很好，以防以下步骤出错。
4.  使用 NORECOVERY 恢复之前的完整备份 (BF1)
5.  使用 RECOVERY 恢复日志文件备份 (BL1)，并指定要恢复的时间点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-08T08:46:00.933

1.  选择您的数据库。
2.  然后选择任务/恢复/数据库。
3.  在还原数据库对话框中选择时间轴选项
4.  输入您想要恢复数据库的时间。
5.  点击确定
6.  再次确定。
7.  您的数据库已成功更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:40:24.220

进行了一些调查，似乎由于我们的数据库已将 RECOVERYMODEL 设置为 SIMPLE，因此无法进行回滚。

如果数据库设置为完全恢复模式或批量日志恢复模式，它会更容易。

# .net - CLR 如何知道复制参数（准确地说是对象）？

> ID：585443
> 
> 赞同：1
> 
> 时间：2009-02-25T10:17:43.277
> 
> 标签：.net, clr

当我们调用机器边界之外的任何方法**（**远程方法**）**时，CLR 如何知道这一点，然后序列化**（**或复制**）**实际对象而不是内存地址**（**对实际对象的引用**）**以在任何方法被发送时发送所谓的跨越机器边界？

这个问题出现在我的脑海中，意识到在调用方法时总是发送一个引用，而不是它的副本。

* * *

好吧，我说的是任何类型的远程调用，无论是远程处理还是 Web 服务。我的意思是，客户端必须调用一个方法并发送参数，现在如果它是本地的，它只会发送对象的内存地址以使用它们，否则它将复制或以 XML 或类似方式序列化它。那么，它怎么知道该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T11:00:38.727

所有远程交互都基于合同。

*   在原始套接字的情况下，它是一个应用程序级协议。（我会省略这个。）
*   在远程处理的情况下，它主要是基于接口的合同。客户端知道它正在与之交谈的服务器的方法和属性。数据以序列化形式（xml 或二进制）通过网络（或仅跨越 appdomain 边界）发送。正如乔纳森所指出的，这条规则有一个例外：**MarshalByRefObject**。它的继承者没有序列化，而是通过“引用”（封送，“代理”）传递。
*   对于 Web 服务（主要是 WCF），它是基于**WSDL**的合同。客户端知道 XML 模式 - 服务器可以理解的一种语言。数据在 SOAP 中序列化并通过网络发送。

如您所见，那里没有魔法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T13:04:19.180

在远程处理客户端上的实际对象引用时，是一个称为“透明代理”的假对象，当您在该对象上调用方法时，CLR 检测到它是代理，打包所有参数并调用特殊方法。

然后这个特殊方法序列化所有参数，通过网络发送它们，等待回复消息并反序列化返回值。

有关更多详细信息，请参阅 RealProxy 类的文档（您可以为继承自 MarshelByRefObject 的任何对象创建代理，处理幕后调用的特殊对象继承自 RealProxy）

在 Web 服务的情况下，该过程是相似的，但不是使用特殊的 CLR 代理，而是使用由 Visual Studio 创建的代码生成代理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:25:58.513

如果一个对象从 MarshalByRefObject 继承，它将被远程调用。如果不是，则将其序列化并发送。

# nhibernate - (Fluent) NHibernate : 一个由来自不同表的字段组成的实体

> ID：585450
> 
> 赞同：2
> 
> 时间：2009-02-25T10:23:13.030
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

有没有办法编写 NHibernate 映射，以便您可以拥有一个由来自不同数据库表的字段组成的实体？

例如，我有一个人员和地址表，我希望地址字段出现在我的人员对象中。

我想要一个这样的实体：

```
public class person
{
    public virtual Guid Key{get; set;}
    public virtual string Name {get; set;}
    public virtual string Age {get; set;}
    public virtual string Address1 {get; set;} //from address table
    public virtual string Address2 {get; set;} //from address table

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T10:31:03.617

如果您使用的是 Fluent NHibernate，则可以使用 WithTable，如下例所示：

```
public class PersonMap : ClassMap<Person>
{
  public PersonMap()
  {
    Id(x => x.Key, "[Key]"); // Explicitly specify escaped column name to 
                             // avoid problems with reserved words
    Map(x => x.Name);
    Map(x => x.Age);

    WithTable("Address", m =>
    {
      m.Map(x => x.Address1);
      m.Map(x => x.Address2);
    });
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:30:27.940

我想[这](http://www.nhforge.org/doc/nh/en/#mapping-declaration-join)就是你需要的。不确定对 Fluent NHibernate 部分的支持，以及我不确定这个想法的有效性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T01:33:07.037

您还可以考虑在 Person 和 Address 之间使用多对多表。在这种情况下，拥有一个属性“Addresses”可能是有意义的，它可以只保存一个您想要的任意多个地址的列表。

您可以使用映射进行映射（或任何最有效的集合映射）来完成此操作。

# c# - 在 Compact Framework 中选择正确的图像大小

> ID：585451
> 
> 赞同：0
> 
> 时间：2009-02-25T10:23:42.200
> 
> 标签：c#, compact-framework, resolution, dpi

我正在使用 C# 在 CF 3.5 中为 windows Mobile 6 Pro 开发一个应用程序，我有一个小问题需要知道的人的建议。

基本上，我希望我的应用程序能够在多种设备尺寸和分辨率上运行和扩展。一切都正确缩放，但图像。例如 16X16 的一些图像在高分辨率屏幕上看起来非常小，所以我想显示 32X32 图像，但我不知道决定显示哪种图像尺寸的最佳方法是什么。

我可以选择检查 dpi，然后手动选择要显示的图像，但这似乎很脏。

有没有其他方法可以做到这一点，或者最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T10:36:29.487

我建议您在表单和图像之间创建一个图层。创建一个负责返回正确大小的图像的新类。表单中的代码将依赖它来获取图像，并且对尺寸一无所知。例如：

```
mypicturebox.Image = ImageFactory.Image01; 
```

好处是您可以在 ImageFactory 中使用您想要的任何技术，而不会影响其余代码。最简单的做法是检查屏幕的大小（使用 Screen.PrimaryScreen.WorkingArea）并手动决定。

# java - Java 新手：Swing 和显示 ASCII 文件

> ID：585452
> 
> 赞同：2
> 
> 时间：2009-02-25T10:23:48.707
> 
> 标签：java, swing, file, ascii

万事如意，

我有一个应用程序需要在 Swing 组件中显示一个 15 行的 ASCII 文件，用户无法对其进行编辑。

下面是我的代码，它逐字节读取 ASCII 文件。我感谢乐于助人的评论者解释说 JTextArea.setEditable(false) 在 Swing 中是合适的。

但是，当我个人将 ASCII 文件制作成完全不同的东西时，我的代码仅显示一串数字。有谁知道我做错了什么以及如何让ASCII字符本身显示？

```
import java.io.*;
import javax.swing.*;

public class LoadMap extends JFrame {
    public LoadMap() throws IOException {
        FileInputStream fIn = new FileInputStream("map.srn");
        BufferedReader rd = new BufferedReader(new InputStreamReader(fIn, "US-ASCII"));
        String map = "";
        JTextArea mapArea = new JTextArea(15, 50);

        try {
            int c;
            while ((c = rd.read()) != -1) {
                map= map + c;
            }
        } finally {
            if (rd != null) {
                rd.close();
            }
        }
        mapArea.setText(map);
        mapArea.setEditable(false);
        add(mapArea);
        pack();
        setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:26:19.620

使用 JTextArea 并调用

```
setEditable(false); 
```

阻止用户编辑数据

我刚刚阅读了您的代码，并意识到这不是一个足够全面的答案。您不能在标签上添加“+”。您需要做的是先读取文本并将其存储在某处，然后调用

```
setText(yourTextAsString); 
```

在屏幕上的文本组件上（我仍然会使用 JTextArea），并且您需要将文本区域添加到框架中，因此您的代码看起来像：

```
public LoadMap() {
     String data = // read your data
     JTextArea textArea = new JTextArea();
     textArea.setText(data);
     textArea.setEditable(false);
     setLayout(new GridLayout());
     add(textArea);
     pack();
     setVisible(true);
} 
```

我建议阅读[Swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/)以获取有关使用 Swing 组件的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:26:30.353

使用 JTextArea 并调用 setEditable(false)。

[https://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/text/JTextComponent.html#setEditable(boolean)](https://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/text/JTextComponent.html#setEditable(boolean))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T10:27:35.890

您可以在循环内构造一个字符串，然后在完成后将字符串放入 JLabel 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T10:28:15.700

这让我觉得自己像 Captain Obvious，但仍然：只需先加载整个文本，*然后*使用所需的文本构建标签。或者，正如其他海报正确建议的那样，使用 JTextArea 因为它更适合多行内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T10:51:02.820

JLabel 不会显示换行符（除非您使用 HTML）。因此，正如其他人所写，使用文本区域。

但是，您的代码还有一个隐藏的问题：您没有指定文件的编码，这意味着如果文件包含非 ASCII 字符并且其编码与 Java 的平台默认值不匹配，则文件内容可能会出现乱码。要解决此问题，请不要使用`FileReader`. 相反，使用 a`FileInputStream`并将其包装在 a 中`InputStreamReader`，在其构造函数中指定编码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T10:28:50.130

您可以使用 JTextArea 并将其设置为只读：

```
jtextarea.setEditable(false); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-28T07:37:43.510

这里：

```
String map = "";
int c;
while ((c = rd.read()) != -1) {
    map= map + c;
} 
```

你在做什么将 int 附加到字符串中。

您应该将它们转换为 char 。

```
int c;
while ((c = rd.read()) != -1) {
    map= map + ( char ) c;
} 
```

您可以在这些问题中看到更好的模式。

[如何从文件内容创建 Java 字符串？](https://stackoverflow.com/questions/326390/how-to-create-a-java-string-from-the-contents-of-a-file)

[https://stackoverflow.com/questions/181634/simplest-efficient-ways-to-read-binary-and-ascii-files-to-string-or-similar-in-v/324792#324792](https://stackoverflow.com/questions/181634/simplest-efficient-ways-to-read-binary-and-ascii-files-to-string-or-similar-in-v/324792#324792)（见java部分）

# php - PostgreSQL - 树组织

> ID：585453
> 
> 赞同：7
> 
> 时间：2009-02-25T10:24:10.157
> 
> 标签：php, ruby, postgresql, search, tree

我正在做一个项目，它需要一个类别树，组织为 id、parent、title 表。在 Postgres 中检索类别及其子类别（以及完整的树，如果根类别的 parent=0）的最佳方法是什么？我正在寻找一个纯粹的数据库解决方案，但如果有一种适用于 Ruby 和 PHP 的方法 - 它也会很棒。

主要目标是选择子句的速度，因为此表中的数据对于更新/插入/删除速度并不重要。

UPD：还会有路径搜索，我的意思是从当前顶点（类别）到根类别的路径。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T12:43:42.597

> 检索类别及其子类别

如果您只有有限深度的子项，您可以使用自连接来执行此操作，例如。两层深：

```
SELECT *
FROM categories AS child
LEFT JOIN categories AS parent ON parent.id=child.parent
LEFT JOIN categories AS grandparent ON grandparent.id=parent.parent
WHERE child.id=(id) OR parent.id=(id) OR grandparent.id=(id); 
```

您不能使用标准 SQL 在“parent-id-foreign-key”类型架构上对任意深度的层次结构执行此操作。

一些 DBMS 提供了非标准的分层工具，以各种方式允许这样的事情，但如果您想坚持跨 DBMS 兼容的代码，您需要将您的模式重新调整为表示层次结构的更好模型之一。两个流行的是：

*   [嵌套集](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)。在目标表的两列中存储表示树的深度优先搜索的线性排序（如果您的目标具有显式排序，您将已经拥有其中一列）。

*   [邻接关系](http://vadimtropashko.wordpress.com/nested-sets-and-relational-division/)。将每个祖先/后代对存储在单独的连接表中。

每种方法都有优点和缺点，并且有许多变体（例如，稀疏嵌套集编号，AR 中的“距离”）会影响各种类型的添加/删除/移动位置操作的成本。我个人倾向于默认使用简化的嵌套集模型，因为它包含的冗余比 AR 少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T10:33:00.430

看看[“ltree”](http://www.postgresql.org/docs/current/static/ltree.html) contrib 模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T16:44:33.907

我一直在玩**[ltree](http://www.postgresql.org/docs/current/static/ltree.html)**，这是一个 PostgreSQL contrib 模块，看看它是否适合线程注释。您在表中创建一个存储路径的列并在其上创建一个 ltree 索引。然后您可以执行如下查询：

```
 ltreetest=# select path from test where path ~ '*.Astronomy.*';
                     path                      
-----------------------------------------------
 Top.Science.Astronomy
 Top.Science.Astronomy.Astrophysics
 Top.Science.Astronomy.Cosmology
 Top.Collections.Pictures.Astronomy
 Top.Collections.Pictures.Astronomy.Stars
 Top.Collections.Pictures.Astronomy.Galaxies
 Top.Collections.Pictures.Astronomy.Astronauts 
```

我还没有充分利用它来确定它在插入、更新或删除等方面的表现如何。我假设删除看起来像：

```
DELETE FROM test WHERE path ~ '*.Astronomy.*'; 
```

我在想，一个线程化的评论表可能看起来像：

```
CREATE SEQUENCE comment_id_seq
  INCREMENT 1
  MINVALUE 1
  MAXVALUE 9223372036854775807
  START 78616
  CACHE 1;

CREATE TABLE comments (
comment_id int PRIMARY KEY,
path ltree,
comment text
);

CREATE INDEX comments_path_idx ON comments USING gist (path); 
```

插入将粗略（且未经测试）看起来像：

```
CREATE FUNCTION busted_add_comment(text the_comment, int parent_comment_id) RETURNS void AS
$BODY$
DECLARE
    INT _new_comment_id; -- our new comment_id
    TEXT _parent_path;   -- the parent path
BEGIN
    _new_comment_id := nextval('comment_id_seq'::regclass);
    SELECT path INTO _parent_path FROM comments WHERE comment_id = parent_comment_id;

    -- this is probably busted SQL, but you get the idea... this comment's path looks like
    --   the.parent.path.US
    --
    -- eg (if parent_comment_id was 5 and our new comment_id is 43):
    --  3.5.43
    INSERT INTO comments (comment_id, comment, path) VALUES (_new_comment_id, the_comment, CONCAT(_parent_path, '.', _new_comment_id));

END;
$BODY$
LANGUAGE 'plpgsql' VOLATILE; 
```

或者其他的东西。基本上，路径只是由所有主键组成的层次结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T17:36:34.453

对于这种情况，我已经喜欢嵌套集合模型。更新和插入可能有点棘手，但选择通常非常简洁和快速。如果添加对节点父节点的实际引用，性能会更好（在某些情况下会消除连接。它还包括子节点的自然排序。

*   [SQL 中的树](http://www.developersdex.com/gurus/articles/112.asp)

当前节点和所有子节点的典型查询如下所示：

```
select name
from nestedSet c inner join nestedSet p ON c.lft BETWEEN p.lft AND p.rgt
where p.id = 1
order by lft 
```

一些放置得当的`group by`子句还将为您提供有关树的一些快速统计信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T17:26:13.307

Rails有一个`acts_as_tree`插件，过去对我来说效果很好。不过，我有一棵相当小的树 - 大约 15,000 个节点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T01:51:05.543

补充一点，[在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)一文对邻接列表模型和嵌套集模型有很好的解释，包括用于树操作的示例 SQL 等。

RDBMS 中的层次结构是一个困难的话题。我的愿望清单上有[Joe Celko 的 Trees and Hierarchies in SQL for Smarties](https://rads.stackoverflow.com/amzn/click/com/B001C4TELO)，希望有一天可以购买和阅读。

# java - EJB3 和手动层次结构持久性

> ID：585454
> 
> 赞同：1
> 
> 时间：2009-02-25T10:24:58.500
> 
> 标签：java, orm, jpa, persistence, java-ee-5

我有一个遗留数据库，我正在使用 EJB3 对其进行建模。数据库的状态很差，我们对如何插入数据库有一些不寻常的限制。现在我想在适合数据库结构的层次结构中对数据库进行建模，但我希望能够单独手动插入每个实体，而不需要持久性管理器尝试持久化实体子项。

我正在尝试类似以下的东西（样板被遗漏）：

```
@Entity
@Table(name = "PARENT_TABLE")
public class Parent {
    @Id
    @Column(name = "ID")
    int id;

    @OneToMany
    List<Child> children;
}

@Entity
@Table(name = "CHILD_TABLE")
public class Child {
    @Id
    @Column(name = "ID")
    int id;   
} 
```

现在这引发了一个异常：

```
java.lang.IllegalStateException: During synchronization a new object was found through a relationship that was not marked cascade PERSIST 
```

现在我**知道**实体没有被标记为 PERSIST - 我不希望 EntityManager 持久化它！我希望能够先坚持父母，然后是孩子——但不是在一起。想要这样做是有充分理由的，但它似乎不想玩。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T10:35:24.217

嘿，欢迎来到 JPA 配置这个令人毛骨悚然的地方。

在您的情况下，您有两种选择：

1.  手动持久化新对象；或者
2.  自动持久化它。

要自动保留它，您需要注释关系。这是一个常见的一对多习语：

```
@Entity
@Table(name = "PARENT_TABLE")
public class Parent {
  @Id private Long id;

  @OneToMany(mappedBy = "parent", cascade = CascadeType.PERSIST)
  private Collection<Child> children;

  public void addChild(Child child) {
    if (children == null) {
      children = new ArrayList<Child>();
    }
    child.setParent(parent);
    children.add(child);
  }
}

@Entity
@Table(name = "CHILD_TABLE")
public class Child {
  @Id private Long id;

  @ManyToOne
  private Parent parent;

  public void setParent(Parnet parent) {
    this.parent = parent;
  }
}

Parent parent = // build or load parent
Child child = // build child
parent.addChild(child); 
```

由于级联持续存在，这将起作用。

**注意：**您必须自己在 Java 级别管理关系，因此手动设置父级。这个很重要。

没有它，您需要手动持久化对象。您需要一个 EntityManager 来执行此操作，在这种情况下，它很简单：

```
entityManager.persist(child); 
```

在这一点上它会正常工作（假设一切正常）。

对于纯子实体，我倾向于使用注释方法。这更容易。

我将在 JPA 中提到一个问题：

```
Parent parent = new Parent();
entityManager.persist(parent);
Child child = new Child();
parent.addChild(child); 
```

现在我对此有点生疏，但我相信如果你这样做，你可能会遇到问题，因为在添加孩子之前父母已经坚持了下来。无论您做什么，都要小心并检查这种情况。

# ruby - 您希望在 Ruby 语言中改进哪些方面？

> ID：585457
> 
> 赞同：10
> 
> 时间：2009-02-25T10:25:33.880
> 
> 标签：ruby, stability

您希望 Ruby（以及更普遍的 Ruby 社区）能够改进哪些方面？

[我在某处](http://blog.hasmanythrough.com/2008/6/20/recursive-lambda)读到Ruby 是 Smalltalk 和 LISP 的爱子，Perl 小姐是保姆。

我非常尊重 Ruby 的父母，但我不确定我是否喜欢 Perl 小姐对孩子的影响。具体来说，我不喜欢预定义的变量：我需要一张[备忘单](http://grox.net/doc/ruby/ruby_on_rails_cheat_sheet.png)来了解它们的含义。你可以说“只是不要使用它们”。嗯，我没有……但其他人有。当我在网上下载一个插件时，如果我需要去接触源代码，我别无选择，只能获取我的备忘单。我只是希望他们能从语言本身中删除这些。

另外，我认为 Ruby 是一个移动的目标。我的代码在每次新的 Ruby 升级时都会中断，即使在次要版本中也是如此。Ruby on Rails 和我使用过的大多数 Rails 插件也是如此：它们一直在变化，似乎没有人关心这些变化是否会破坏一切。恕我直言，虽然我喜欢 Ruby 中的很多东西，但这种缺乏稳定性几乎是一个障碍。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T10:30:11.110

我希望人们在发布新的语言（或库或框架）版本时将**次要版本之间的向后兼容性视为牢不可破的规则。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T15:15:07.930

我希望标准库中一些较少使用的模块被记录在案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-16T00:20:47.803

使`require`-ing 文件不那么痛苦。不要问我怎么做，但也许有一个文件专门用于了解所涉及的路径，然后从其他所有内容中删除相对路径的残渣。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T15:02:36.087

摆脱模块和类之间的人为区别会很好。

模块和类都是命名空间。模块也是 Mixin，而类不是。类也可以被实例化，而模块则不能。这种区别是不必要的。只需摆脱模块并允许将类用作 Mixins。

可以使用这种语言的一个示例是[Newspeak](http://NewspeakLanguage.Org/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T11:43:00.217

I'd appreciate being able to install ruby 1.9 as an RPM rather than having to use the source.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T15:09:56.070

使 Ruby 完全基于消息发送，摆脱所有不是消息发送的东西：局部变量、全局变量、实例变量、类层次结构变量、常量、魔术全局变量、魔术常量、内置运算符、内置关键字，甚至是文字。参见[Self](http://Research.Sun.Com/self/)、[Ioke](http://Ioke.Org/)或[Newspeak](http://NewspeakLanguage.Org/)以获得令人难以置信的力量和优雅。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T10:27:59.523

我希望他们能摆脱**预定义的变量**：`$!`、、、`$&`等`$+`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T15:14:59.333

用[Traits](http://WWW.IAM.UniBe.Ch/~scg/Research/Traits/)系统替换 Mixin系统。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T14:59:11.307

我想支持静态编译时元编程。[Converge 编程语言](http://ConvergePL.Org/documentation/current/ctmp/)可能是一个很好的起点。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-02-25T15:17:13.960

用 Common Lisp 风格的[条件](http://GigaMonkeys.Com/book/beyond-exception-handling-conditions-and-restarts.html)系统替换异常。

# c# - 如何从 dll 中获取可用的翻译

> ID：585461
> 
> 赞同：1
> 
> 时间：2009-02-25T10:26:56.000
> 
> 标签：c#, localization, resources, translation

有没有办法获得 .net dll 的可用资源翻译？

我们的软件正在被翻译成一些不同的语言，我想让用户选择软件的语言，尽管我只想让他们在已翻译的语言之间进行选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-07T13:22:36.290

我刚遇到类似的问题，仅供参考。

对于我的软件翻译都在程序文件夹中，每个都在以文化名称命名的自己的子文件夹下。代码说明了一切：

```
 private void SettingsForm_Load(object sender, EventArgs e)
    {
   // load default language to the list
        languageList.Add(new Language("English", "en"));
        string fileName = "myProgram.resources.dll";

   // load other languages available in the folder
        DirectoryInfo di = new DirectoryInfo(Application.StartupPath);
        foreach (DirectoryInfo dir in di.GetDirectories())
        {
            if (File.Exists(dir.FullName + "\\" + fileName))
            {
                try
                {
                    CultureInfo ci = new CultureInfo(dir.Name);
                    languageList.Add(new Language(ci.NativeName, ci.Name));
                }
                catch
                {
                    // whatever happens just don't load the language and proceed ;)
                    continue;
                }
            }
        }
    } 
```

它会增加一些异常处理开销，但是有多少用户会在安装目录中创建自定义文件夹，并将假资源完全命名为本地化文件？:P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T11:50:27.267

所以你需要能够得到base dll的culture，然后枚举所有satellite dll？

第一部分很简单（只需获取程序集级别属性）。

对于后者，ResourceManager 类似乎没有帮助器，这意味着您需要模拟其探测机制（可能包括所有可用于属性和 .config 文件的覆盖）。

另一种方法是在构建或安装时构建列表（如果以后可以添加其他语言，后者会更好），为 .config 文件创建一个列表。

# mfc - 如何将 CComboBox 数据复制到另一个 CComboBox？

> ID：585463
> 
> 赞同：0
> 
> 时间：2009-02-25T10:27:30.787
> 
> 标签：mfc, visual-c++-6, ccombobox

如何将 CComboBox 数据复制到另一个 CComboBox？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T18:25:07.503

我认为没有任何提供的方法可以这样做，除了使用常用方法（GetItemData、GetLBText 等）从一个获取数据并将它们插入另一个。

# c - 最后一步：将反面也是素数的所有素数相加

> ID：585465
> 
> 赞同：0
> 
> 时间：2009-02-25T10:27:48.337
> 
> 标签：c, primes

和 17 一样，是质数，反过来，71 也是质数。

我们设法得到了这个代码，但我们无法完成它。

```
#include <stdio.h>
main()
{
    int i = 10, j, c, sum, b, x, d, e, z, f, g;

    printf("\nPrime numbers from 10 to 99 are the follwing:\n");

    while (i <= 99)
    {
        c=0;

        for (j = 1; j <= i; j++)
        {
            if (i % j == 0) c++;
        }

        if (c == 2)
        {
            b = i;
            d = b / 10;
            e = b - (10 * d);
            x = (e * 10) + d;

            {
                z = 0;
                f = x;

                for (j = 1; j <= f; j++)
                {
                    if (f % j == 0) z++;
                }

                if (z == 2)
                {
                    printf("%d %d\n", i, f);
                }
            }
        }

        i++;
    }

    getch();
} 
```

我的问题是如何添加所有的*f* s ..

答案应该是 429。

我怎样才能添加所有的f？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T10:32:38.280

你为什么不把代码分解成一些函数：

*   `bool isPrime(int number)`检查一个数字是否为素数。
*   `int reverse(int number)`反转数字。

那么算法将是：

```
sum = 0;
for (i = 2; i <= 99; ++i)
   if (isPrime(i) && isPrime(reverse(i)))
      sum += i; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:53:06.700

一开始初始化`sum = 0;`. 然后，在您的素数旁边`printf`：`sum += i;`。然后你可以在最后打印它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T11:12:19.527

If this is a basic programming class and you are just interested in the result then this will get you there, however if it is an algorithms class then you may want to look at the [Sieve of Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes).

You may also want to think about what makes a 2 digit number the reverse of another 2 digit number and how you would express that.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T11:13:03.407

There are many problems in your code. None of them will prevent compilation and none of them will cause problems in getting the output. I'll first tell you how to get the result you want and then highlight the problems.

Here is your code, modified to sum fs. You just need to add f to sum every time you print a prime satisfying the condition. Finally, you should print the sum of all fs.

```
#include <stdio.h>

//Use int as the return type explicitly!
int main()
{
         int i=10,j,c,sum,b,x,d,e,z,f,g;
         printf("\nPrime numbers from 10 to 99 are the follwing:\n");
         //Set the sum of all primes whose reverse are also primes to zero
         sum = 0;
         while(i<=99)
         {
            //c is tyhe number of factors.
            c=0;
            for(j=1;j<=i;j++)
            {
                if(i%j==0)
                    c++;
            }
            //If there are only two factors.
            //Two factors (1 and itself) => Prime
            if(c==2) 
            {
                //Reverse i and store it in x
                b=i;
                d=b/10; 
                e=b-(10*d);
                x=(e*10)+d;
                //Curly braces unnecessary
                {
                    //Check if the reverse i.e. x is prime

                    //z is the number of factors
                    z=0;
                    //f is the number being tested for primality.
                    f=x;
                    for(j=1;j<=f;j++)
                    {
                        if(f%j==0)
                            z++;
                    }
                    //If f i.e. x i.e. the reverse has only two factors
                    //Two factors (1 and itself) => Prime
                    if(z==2)
                    {
                        //print the prime number.
                        printf("%d %d  \n",i,f); 
                        //Add f to the sum
                        sum += f;
                    }//if(z==2)                                                         
                }//Unnecessary braces               
            }//if(c==2)
            i++;
        }//end while          

        //print the number of reversed primes!!
        //That is sum of the reversed values of numbers satisfying the 
        //condition!
        printf("\nThe sum is:%d\n", sum); 

        //getch() is non standard and needs conio.h
        //Use getchar() instead.
        //Better solution needed!!
        getchar();

        //Return 0 - Success
        return 0;
} 
```

**Output**

> ```
> ...@...-desktop:~$ gcc -o temp temp.c  
> ...@...-desktop:~$ ./temp
> 
> Prime numbers from 10 to 99 are the follwing:
> 11 11  
> 13 31  
> 17 71  
> 31 13  
> 37 73  
> 71 17  
> 73 37  
> 79 97  
> 97 79  
> 
> The sum is:429
> 
> ...@...desktop:~$
> 
> ```

Do take note of all the comments made in the code (above). In addition, consider doing the following:

1.  Removing the unnecessary braces.
2.  Using one variable for one thing. (x could have been used instead of f).
3.  Using better variable names like number and numberOfFactors.
4.  Breaking up your code into functions as Mehrdad Afshari has suggested.
5.  Consider testing primality by checking if there is a divisor of the number (num) being tested up to sqrt(num) (Square root of the number).
6.  Consider this:
    *   For numbers upto 99, the reversed numbers are also 2 digit numbers.
    *   If the number is in the set of primes already found, you can verify easily.
    *   This will reduce the number of checks for primality. (which are expensive)
    *   To do the above, maintain a list of primes that have been identified (primeList) as well as a list of reversed primes (revList). Any item in revList that is also in primeList satisfies your condition. You can then easily obtain the sum (429) that you need.
7.  Look at sweet61's answer, the use of the Sieve of Eratosthenes with my method will definitely be much more efficient. You can reverse primes at the end of the sieve and populate the revList (at the end).

On a personal level, I try to find the best solution. I hope you will also attempt to do the same. I have tried to help you out without giving it all away.

I hope this helps.

**Note**
I had suggested checking for divisors up to num/2\. I fixed it to sqrt(num) on vartec's suggestion.

# .net - NullRefs 是否应该被捕获？

> ID：585480
> 
> 赞同：4
> 
> 时间：2009-02-25T10:31:09.657
> 
> 标签：.net, exception, nullreferenceexception

我最近向一位同事发表声明：

> NullReferenceExceptions*永远不*应该 被显式捕获

我用了从不……嗯。我自己从未见过合适的用例来捕捉它们，但我想检查是否有其他人有？

毕竟从来没有这么强烈的词......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T10:35:41.733

这取决于为什么；请参阅 Eric Lippert 的[博客条目](http://blogs.msdn.com/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)。如果它们是“愚蠢的异常”，那么不 - 只需修复调用代码。在极少数情况下它们是“令人烦恼的异常”（即您调用的代码具有难以避免的陷阱），那么我想您必须这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T10:32:33.223

好吧，当你调用一个有缺陷的第三方库时，它偶尔会导致 nullrefs，如果你知道如何正确处理它们，捕获它们可能是个好主意。

现实生活中的例子：过去，我广泛使用了第三方编辑器提供的数据网格。他们有（或此时有）一个已确认的错误，该错误会在更新底层数据源中的某些数据时不时抛出一个 nullref（嵌套在他们的调用堆栈深处）。

我已经用这段代码处理了这种情况：

```
 try
            {
                // do the update
            }
            catch (NullReferenceException)
            {
                try
                {
                    // redo the update
                }
                catch (NullReferenceException ex)
                {
                    // properly log the third party lib failure
                }
            } 
```

顺便说一句，我的“日志”代码在 2 年内从未执行过：) 现在第三方编辑器已经解决了这个问题，我可能应该删除这段代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T10:43:53.213

也许正确的报价是

> **如果您拥有引发异常的代码，则**不应显式捕获 NullReferenceExceptions

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T14:17:51.903

你是对的，“从不”是一个强有力的词。

捕获 NullReferenceException（或 Java 的 NPE）将始终取决于代码的目的。

例如，如果您的应用程序要求即使在可能不确定的状态下继续处理（想想生命支持系统），或者如果您的代码不关心引用对象的状态（例如：批量处理数据，字面意思是抛出错误数据）。

不捕获这些类型的异常是一个很好的经验法则，但不是法律。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T10:42:08.567

我不会说永远不会。例如，您可以捕获它以记录异常或将其从一个线程编组到另一个线程。在这两种情况下，都应该再次抛出异常。

正如 Marc Gravell 指出的那样，Eric Lippert 在他的博客上有一篇关于异常的非常好的文章。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T11:00:22.330

我曾经不得不根据大约 15 个变量的值构建一个大字符串。我没有检查每一个是否为空，而是继续创建字符串，取消引用变量并捕获 NRE。老实说，这感觉很糟糕和顽皮，但它让我免于编写大量代码。

# grails - Grails 中的项目集成

> ID：585489
> 
> 赞同：4
> 
> 时间：2009-02-25T10:33:56.450
> 
> 标签：grails, project-management

我正在做一些教程并在 Grails 中完成了一些演示应用程序。

假设我在 Grails 中创建了多个项目，并且我想将所有这些项目集成到一个应用程序中，我该怎么做？

例如：我已经制作了一个“待办事项列表”和“在线考试”，现在我想创建一个新的应用程序，将这两个应用程序结合起来。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-25T16:29:09.327

另一种方法是将您的一个（或两个）项目重新打包[为插件](http://www.grails.org/Creating+Plugins)。如果需要，这将允许您将它们保存在单独的代码库中。

插件是一个常规的 Grails 应用程序（您可以使用 grails run-app 运行它），因此切换应该不难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T14:52:18.063

在 Grails 中创建可重用模块的最佳方法是将它们打包为 Grails 插件。如前所述，Grails 插件是带有附加元数据的常规 Grails Web 应用程序（具有标准布局），因此它有助于 GrailsPluginManager 组件将插件合并到其他应用程序中。

我强烈推荐这[本书](https://rads.stackoverflow.com/amzn/click/com/1590599950)，它很好地涵盖了 Grails 插件系统的大部分方面。它甚至展示了如何将“常规”博客应用程序包装为插件并合并到另一个 Grails 应用程序中的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:43:18.363

将一个项目中的所有文件复制到另一个项目的目录结构中，并合并两个项目中存在的所有文件 - 不应该太多，因为“约定优于配置”意味着您没有很多全局配置文件。

处理目录差异的[差异/合并](http://www.thefreecountry.com/programming/filecomparison.shtml)工具可能会使这更容易。

# c# - 如何在 LINQ 中重新映射属性？

> ID：585494
> 
> 赞同：1
> 
> 时间：2009-02-25T10:35:35.200
> 
> 标签：c#, linq

我正在通过 LINQ 获取正在运行的进程列表。

我想要的两个属性是“ProcessName”和“WorkingSet64”。

但是，在我的 UI 中，我希望将这些属性称为“ProcessName”和“ProcessId”。

如何将名称“WorkingSet64”重新映射为“ProcessId”？

我做了一个我在下面寻找的伪语法：

```
using System.Linq;
using System.Windows;
using System.Diagnostics;

namespace TestLinq22
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            var theProcesses =
                from p in Process.GetProcesses()
                orderby p.WorkingSet64 descending
                select new { p.ProcessName, p.WorkingSet64 alias "ProcessId" };

            foreach (var item in theProcesses)
            {
                TheListBox.Items.Add(item);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T10:37:08.580

```
select new { p.ProcessName, ProcessId = p.WorkingSet64 }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T10:38:15.457

```
var theProcesses = from p in Process.GetProcesses()
                   orderby p.WorkingSet64 descending
                   select new { p.ProcessName, ProcessId = p.WorkingSet64 }; 
```

当您创建匿名对象时，如果您提供属性名称，它将使用该名称，否则它将使用您从中选择的属性名称。

# textbox - vb.net 文本框中的验证

> ID：585499
> 
> 赞同：1
> 
> 时间：2009-02-25T10:36:52.683
> 
> 标签：textbox

我有一个文本框，用户需要在其中输入金额。我想知道在按键事件上进行验证的方法，以便用户输入的小数点不能超过一个，即只允许用户输入像 99.999 这样的值不像 99...22 请建议一些属性或方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:38:00.107

正则表达式是一个很好的方法！

查看：

[http://en.wikipedia.org/wiki/Regular_expression](http://en.wikipedia.org/wiki/Regular_expression)

[http://www.regular-expressions.info/dotnet.html](http://www.regular-expressions.info/dotnet.html)

这可能是您正在寻找的正则表达式：

```
[0-9]+(\.[0-9]*)? 
```

# c# - 如何识别对象何时为空？

> ID：585505
> 
> 赞同：1
> 
> 时间：2009-02-25T10:38:25.893
> 
> 标签：c#

如果我正在调用一个函数：

```
 public User GetUserById(int UserId)
    {
    User someUser = new User();

    //Look up this UserId in the database
     ...
    someUser.Name = dbResult["Name"];

    return someUser;
    } 
```

假设我传入了一个没有与之关联的“用户信息”的 UserId。

突然间，我传回的 'someUser' 被实例化了，但是是空的。检查它是否“空”的最佳方法是什么，所以我不尝试从中显示数据？

我的穴居人想检查 someUser.Name 的长度是否大于零。我知道这很糟糕，所以如果你知道我错过了什么 - 我会很感激你的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T10:41:14.483

真正的问题是，如果 ID 无效，为什么会`GetUserById()`返回一个未初始化的对象？抛出异常或 - 在最坏的情况下 - return 不是更好`null`吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T10:41:29.193

就个人而言，如果 id 不存在，我会返回`null`，或者（不太喜欢）我会抛出一个`ArgumentException`or `KeyNotFoundException`。这避免了整个问题-您只需检查`null`...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T10:42:16.570

**鉴于您在问题中的实施**

实现一个“isEmpty”方法，检查*每个*实例变量是否处于未初始化或默认状态（引用为空，数字为零等）。类应该知道自己的状态；外部代码从实例中提取状态然后对其进行逻辑处理是不好的形式。您还需要处理可能的歧义，例如对于字符串值的实例变量，null 和零长度是否都被视为“空”。

**备择方案**

1.  返回`null`表示“没有这样的用户”。

2.  抛出非法参数异常以指示“没有这样的用户”。

3.  使用*NullObject*模式并返回其子类`User`为.`isNull()``true`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T10:42:06.273

“空”的定义非常不清楚。如果数据库中没有记录，则不返回任何内容是很合乎逻辑的。也就是说，`null`如果不存在记录，则返回。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T10:57:50.387

为什么不直接检查数据库调用的结果，看看是否返回了任何记录？如果有 0 个结果，您将知道没有这样的用户，并且您根本不必创建 User 对象。

# c# - 如何在运行时创建 XmlMappingSource？

> ID：585506
> 
> 赞同：1
> 
> 时间：2009-02-25T10:38:26.813
> 
> 标签：c#, .net, xml, linq-to-sql

（后续问题[如何在运行时更改 LINQ O/RM 表名/源？](https://stackoverflow.com/questions/582221/how-to-change-linq-o-r-m-table-name-source-during-runtime)）

我需要在运行时更改 LINQ 2 SQL O/R-Mapper 表的表源。为此，我需要创建一个[XmlMappingSource](http://msdn.microsoft.com/en-us/library/bb386907.aspx)。在命令行上，我可以使用 SqlMetal 创建此映射文件，但我想在运行时在内存中创建映射文件。XmlMappingSource 是一个简单的 xml 文件，看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<Database Name="MyDatabase" xmlns="http://schemas.microsoft.com/linqtosql/mapping/2007">
  <Table Name="dbo.MyFirstTable" Member="MyFirstTable">
    <Type Name="MyFirstTable">
      <Column Name="ID" Member="ID" Storage="_ID" DbType="UniqueIdentifier NOT NULL" IsPrimaryKey="true" IsDbGenerated="true" AutoSync="OnInsert" />
      <Association Name="WaStaArtArtikel_WaVerPreisanfragen" Member="WaStaArtArtikel" Storage="_WaStaArtArtikel" ThisKey="ArtikelID" OtherKey="ID" IsForeignKey="true" />
    </Type>
  </Table>
  <Table Name="dbo.MySecondTable" Member="MySecondTable">
    <Type Name="MySecondTable">
      <Column Name="ID" Member="ID" Storage="_ID" DbType="UniqueIdentifier NOT NULL" IsPrimaryKey="true" IsDbGenerated="true" AutoSync="OnInsert" />
      <Column Name="FirstTableID" Member="FirstTableID" Storage="_FirstTableID" DbType="UniqueIdentifier NOT NULL" />
      <Association Name="MySecondTable_MyFirstTable" Member="MyFirstTable" Storage="_MyFirstTable" ThisKey="FirstTableID" OtherKey="ID" IsForeignKey="true" />
    </Type>
  </Table>
</Database> 
```

这应该可以使用反射来创建，例如我可以从这样的数据上下文中获取数据库名称：

```
using System.Data.Linq.Mapping;
using System.Xml.Linq;

XDocument mapWriter = new XDocument();
DatabaseAttribute[] catx = (DatabaseAttribute[])typeof(WcfInterface.WaDataClassesDataContext).GetCustomAttributes(typeof(DatabaseAttribute), false);
XElement xDatabase = new XElement("Database");
xDatabase.Add(new XAttribute("Name", catx[0].Name));
mapWriter.Add(xDatabase); 
```

我的问题：我找不到良好的映射文档，因此提取必要的信息很容易出错 - 也许有人可以向我指出良好的映射文档，或者更好的是，指向如何创建的代码示例映射文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T11:38:08.170

您是否考虑过使用 LINQ to Entities，LINQ to Entities 的映射格式已记录在案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T06:45:40.767

使用 Damien Guard 的开源 T4 模板。它们可以做 SQLMetal 可以做的所有事情，甚至更多，您将拥有完整的 T4 引擎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T10:54:36.247

我只是遇到了同样的问题，我也没有选择更改项目的选项，因为这样做太晚了。

我需要在我的解决方案中更新映射文件中的数据库名称。此解决方案有效。

我的数据库映射

```
<?xml version="1.0" encoding="utf-8"?>
<Database Name="DatabaseName" xmlns="http://schemas.microsoft.com/linqtosql/mapping/2007">
  <Table Name="dbo.tblDictionary" Member="TblDictionary">
    <Type Name="TblDictionary">
      <Column Name="lngRecordID" Member="LngRecordID" Storage="_LngRecordID" DbType="Int NOT NULL IDENTITY" IsPrimaryKey="true" IsDbGenerated="true" AutoSync="OnInsert" />
      <Column Name="txtWord" Member="TxtWord" Storage="_TxtWord" DbType="VarChar(50) NOT NULL" CanBeNull="false" />
    </Type>
  </Table>
</Database> 
```

最后是代码：

```
class Program
    {
        static void Main(string[] args)
        {

        // to get embeded file name you have to add namespace of the application
        const string embeddedFilename = "ConsoleApplication3.FrostOrangeMappings.xml";
        // load file into stream
        var embeddedStream = GetEmbeddedFile(embeddedFilename);
        // process stream
        ProcessStreamToXmlMappingSource(embeddedStream);
        Console.ReadKey();

    }

    private static void ProcessStreamToXmlMappingSource(Stream stream)
    {

        const string newDatabaseName = "pavsDatabaseName";      

        var mappingFile = new XmlDocument();
        mappingFile.Load(stream);
        stream.Close();

        // populate collection of attribues
        XmlAttributeCollection collection = mappingFile.DocumentElement.Attributes;

        var attribute = collection["Name"];
        if(attribute==null)
        {
            throw new Exception("Failed to find Name attribute in xml definition");
        }

        // set new database name definition
        collection["Name"].Value = newDatabaseName;

        //display xml to  user
        var stringWriter = new StringWriter();
          using (var xmlTextWriter = XmlWriter.Create(stringWriter))
          {
              mappingFile.WriteTo(xmlTextWriter);
              xmlTextWriter.Flush();
              stringWriter.GetStringBuilder();
          }
        Console.WriteLine(stringWriter.ToString());

    }
    /// <summary>
    /// Loads file into stream
    /// </summary>
    /// <param name="fileName"></param>
    /// <returns></returns>
    private static Stream GetEmbeddedFile(string fileName)
    {
        var assembly = Assembly.GetExecutingAssembly();
        var stream = assembly.GetManifestResourceStream(fileName);

        if (stream == null)
            throw new Exception("Could not locate embedded resource '" + fileName + "' in assembly");

        return stream;
    }` 
```

# c# - 改进获取最后一个分割部分的代码

> ID：585516
> 
> 赞同：0
> 
> 时间：2009-02-25T10:41:28.490
> 
> 标签：c#

也许使用最新的技术，在 3.5 SP1 中，有没有办法缩短这个？

```
// Bruno: add the empty row with column names
// -- select [CRM5].[USERGROUP].[UserGroup_id], [CRM5].[USERGROUP].[name] AS [name]
if (col.ToLower().Contains("] as ["))
{
   // [CRM5].[USERGROUP].[name] AS [name]
   splitColumn.Clear();    // clear the list
   splitColumn.AddRange(col.Trim().Split(' '));
   emptyRow.Append(String.Format(" '' AS {0},", splitColumn[splitColumn.Count - 1]));
}
else
{
   // [CRM5].[USERGROUP].[UserGroup_id]
   splitColumn.Clear();    // clear the list
   splitColumn.AddRange(col.Trim().Split('.'));
   emptyRow.Append(String.Format(" '' AS {0},", splitColumn[splitColumn.Count - 1])); 
```

}

换句话说，有没有办法在拆分时检索字符串的最后一个元素？

也许

```
col.Trim().Split('.').Find(x => x.LastItem); 
```

> col 是一个字符串
> 
> splitColumn 是一个列表<字符串>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T10:47:05.203

假设您已导入 System.Linq：

```
var lastOrNull = "".Split(' ').LastOrDefault(); 
```

要详细说明上面的代码片段......这可以解决问题：

```
col = (col ?? "").Split(new char[] { ' ' }, 
    int.MaxValue, StringSplitOptions.RemoveEmptyEntries)
        .LastOrDefault();

if (col != null)
{ 
    emptyRow.Append(String.Format(" '' AS {0},", col);
} 
```

如果您指定 StringSplitOptions.RemoveEmptyEntries，则不需要 Trim()。如果字符串为空或为空，上述代码将不会抛出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T10:50:05.583

试试这个：

```
string last = col.Split('.').Last(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:59:37.123

如果由于其他原因不需要拆分结果数组，我会考虑将 col.lastindexof('.') 与 substring 方法结合使用。

由于 -1 如果“。”则返回。未找到：

```
col.substring(col.lastindexof('.')+1) 
```

# sharepoint - SharePoint 2007 发布网站开发和部署

> ID：585518
> 
> 赞同：2
> 
> 时间：2009-02-25T10:41:48.380
> 
> 标签：sharepoint, content-management-system, moss

我是 SharePoint 的初学者，在开始一个项目时需要一些帮助。我必须开发将交付给客户的发布网站。我想给客户端部署体验，就像他在部署标准 ASP.NET 应用程序时所获得的一样。我计划将 Visual Studio 2008 与 SharePoint 扩展以及 WSPBuilder 或其他一些工具一起使用。我还需要帮助构建整个项目。

这是我打算做的事情：
1\. 开发最小的站点定义
2\. 从这个定义创建站点。我应该如何从代码中做到这一点？使用 SharePoint 功能？我应该如何激活它？
3\. 为站点（母版页、布局、内容类型等）开发所有需要的基础结构作为 SharePoint 功能。

这是正确的吗？我应该如何开发所有这些部分，以便我可以制作某种安装脚本，以便客户端可以一键创建完整的站点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T15:33:30.037

毫无疑问，站点定义很复杂，但如果您需要部署到不相关的环境，它们非常有用。如果您停留在同一个服务器场上，则站点定义可能是多余的。如果您在域之间进行（即测试和产品，那么也许它们值得研究）。

站点定义的另一个优点，尤其是。如果交付给客户感觉更像是传统的交付物。他们将有一堆文件（希望在源代码控制中）是他们的自定义站点。我认为这给 IT 部门带来了比从 SharePoint UI 创建的 XML 文件更温暖的感觉。

站点定义的另一个好处是您可以更好地控制构成站点的页面。恕我直言，通过该站点模板的站点定义添加母版页和自定义 CSS 更容易。

我很好奇您要交付的网站的“移动部分”是什么？我认为回答这个问题将决定如何定义项目的结构。

一般来说，我认为你是在正确的轨道上。功能和解决方案是必须的。如果您尝试做任何复杂的事情，我会远离 VSeWSS，它的越野车和笨重而且通常很糟糕。它试图变得如此聪明，以至于你无法控制。

也就是说，这实际上取决于您要做什么。如果您打算使用一个程序集构建一个部署到 GAC 的解决方案，并且只构建 vsewss 支持的功能，您可能会很好。

但是，如果您想开发，比如说将计时器作业连接到 VSeWSS 功能框架中会变得很困难。此外，如果您在解决方案中需要多个程序集。YMMV，但我不得不放弃它并找到更灵活的解决方案（你好[NANT](http://nant.sourceforge.net)）。

您最终要做的很多工作是构建、检查和重新检查 XML 配置文件。[将 MSDN 上的Feature Schema](http://msdn.microsoft.com/en-us/library/ms414322.aspx)参考页面添加为书签，您将花费大量时间来浏览它。

最后，是的，如果您将所有部件打包为功能部件，您应该能够开发一个不错的安装脚本。最终，脚本将需要调用创建站点结构、添加和部署解决方案以及激活功能所必需的[STSADM （](http://technet.microsoft.com/en-us/library/cc261956.aspx)[这里](http://stsadm.blogspot.com/)有一些非常好的 STSADM 扩展）命令。你可以从一个批处理文件开始，然后变得像你想要的那样复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T11:10:39.590

就我个人而言，我不认为创建站点定义对于我已经构建的站点真的有用。由于它们的复杂性，它们的设置可能非常棘手。

我所做的是使用标准发布站点，然后使用功能添加我的其他组件（通过 SharePoint 解决方案部署）。

您可以使用功能装订将功能连接到发布站点创建。

我还刚刚写了一篇关于如何以编程方式修改默认创建的工作流的博客文章：[http](http://www.aaron-powell.com/blog/february-2009/programmatically-modifying-sharepoint-workflows.aspx) ://www.aaron-powell.com/blog/february-2009/programmatically-modifying-sharepoint-workflows.aspx （在评论中也有一个链接到功能装订概念）。

然后我结合使用 SharePoint 解决方案安装程序 ( [http://www.codeplex.com/sharepointinstaller](http://www.codeplex.com/sharepointinstaller) ) 和批处理文件来安装组件。所有 SharePoint 数据库级别安装的 SSI 和文件系统内容的批处理文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T16:24:18.807

添加另一个答案，因为我有 300 多个字符要说:(

RE：SharePoint 解决方案生成器，我再说一遍，您的里程可能会有所不同。

SharePoint 开发的最大问题是管理各种配置文件中的所有“魔术字符串”。GUID 和完全合格的程序集名称是将整个事物结合在一起的口水和胶水，尽管这一切都有意义，但很难管理。

当前的工具都试图减轻管理这些事情的复杂性，但它们要求您以某种方式工作，因此该工具知道如何注入适当的管道。

如果您打算使用 SharePoint 进行大量工作，那么您也应该学会自己管理管道。前期很痛苦，但确实有回报。

基本上，我建议你花时间学习平台而不是工具。一旦你了解了平台，使用这些工具就会容易得多。

如果您将其作为一次性参与并且只想完成它，我相信您可以获得您提到的任何工具来解决问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T18:25:08.470

我同意使用开箱即用的发布网站定义，然后使用网站集功能（母版页、页面布局、CSS）和网站功能（创建列表、页面、子网站、定义网站的母版页）对其进行自定义， ETC...）。

当您想要自定义知名站点模板的新站点（允许用户创建新站点）时，功能装订非常有用，例如自定义“我的站点”外观。在这种情况下，我认为它不是很有用。

作为帮助完成这项任务的工具，我个人使用 STSDEV ( [http://www.codeplex.com/stsdev](http://www.codeplex.com/stsdev) ) 来帮助创建、编程、调试和部署我的 Sharepoint 解决方案。

首先，它为 Visual Studio 创建了一个好的项目（干净的，或者带有一些不错的“起点”定义）。然后它包括一些真正有助于在开发机器中安装、部署和升级的“构建配置”。

# php - 使用 AJAX 监听来自服务器的多条消息：JQuery

> ID：585519
> 
> 赞同：0
> 
> 时间：2009-02-25T10:41:56.727
> 
> 标签：php, jquery, ajax, browser, real-time

我对 PHP 脚本进行 AJAX 调用，如下所示：

```
function convertNow(validURL){      
     $.ajax({
       type: "GET",
       url: "main.php",
       data: 'url=' + validURL,
       success: function(msg){
       alert(msg);
       }//function
     });//ajax
}//function convertNow 
```

综上所述，它所做的就是在结束时从 PHP 接收大量文本。实际上，PHP 脚本正在做的是每隔几秒打印一次，持续大约一分钟。我希望它能够实时显示。

我认为问题在于我使用 JQuery 的方式，因为我已经在没有任何 AJAX 的情况下对此进行了测试，并且 PHP 脚本将每个 print_r 实时输出到浏览器！我只需要复制它，但使用 AJAX。

感谢您的任何帮助和指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T11:10:28.547

回到起点。写一个你真正想做的请求。您可能会发现您需要采用诸如轮询之类的方法，或者可能使用 COMET 之类的方法来实现您想要的。

# python - 查找python代码文件中的所有字符串

> ID：585529
> 
> 赞同：9
> 
> 时间：2009-02-25T10:44:02.510
> 
> 标签：python

我想列出我的大型 python 项目中的所有字符串。

想象一下在 python 中创建字符串的不同可能性：

```
mystring = "hello world"

mystring = ("hello "
            "world")

mystring = "hello " \
           "world" 
```

我需要一个为我的项目中的每个字符串输出“文件名、行号、字符串”的工具。使用 "\" 或 "('')" 分布在多行的字符串应显示在一行中。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T12:54:41.493

unwind 在 2.6 中使用 ast 模块的建议是一个很好的建议。（2.5 中还有未记录的 _ast 模块。）这是示例代码

```
code = """a = 'blah'
b = '''multi
line
string'''
c = u"spam"
"""

import ast
root = ast.parse(code)

class ShowStrings(ast.NodeVisitor):
  def visit_Str(self, node):
    print "string at", node.lineno, node.col_offset, repr(node.s)

show_strings = ShowStrings()
show_strings.visit(root) 
```

问题是多行字符串。如果你运行上面你会得到。

```
string at 1 4 'blah'
string at 4 -1 'multi\nline\nstring'
string at 5 4 u'spam' 
```

您会看到它不报告多行字符串的开头，而只报告结尾。使用内置 Python 工具没有很好的解决方案。

另一种选择是您可以使用我的“ [python4ply](http://dalkescientific.com/Python/python4ply.html) ”模块。这是[PLY](http://www.dabeaz.com/ply/)的 Python 语法定义，它是一个解析器生成器。以下是您可以如何使用它：

```
import compiler
import compiler.visitor

# from python4ply; requires the ply parser generator
import python_yacc

code = """a = 'blah'
b = '''multi
line
string'''
c = u"spam"
d = 1
"""

tree = python_yacc.parse(code, "<string>")
#print tree

class ShowStrings(compiler.visitor.ASTVisitor):
    def visitConst(self, node):
        if isinstance(node.value, basestring):
            print "string at", node.lineno, repr(node.value)

visitor = ShowStrings()
compiler.walk(tree, visitor) 
```

这个的输出是

```
string at 1 'blah'
string at 2 'multi\nline\nstring'
string at 5 u'spam' 
```

不支持列信息。（有一些大部分完整的注释掉的代码来支持它，但它没有经过全面测试。）再说一次，我看到你不需要它。这也意味着使用 Python 的“编译器”模块，它比 AST 模块更笨拙。

尽管如此，使用 30-40 行代码，您应该拥有您想要的东西。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-02T19:58:12.980

Python 包含的`tokenize`模块也可以解决问题。

```
from __future__ import with_statement
import sys
import tokenize

for filename in sys.argv[1:]:
    with open(filename) as f:
        for toktype, tokstr, (lineno, _), _, _ in tokenize.generate_tokens(f.readline):
            if toktype == tokenize.STRING:
                strrepr = repr(eval(tokstr))
                print filename, lineno, strrepr 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T10:54:54.293

如果您可以在 Python 中执行此操作，我建议您从查看[ast](http://docs.python.org/library/ast.html#module-ast)（抽象语法树）模块开始，然后从那里开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T12:24:21.553

你也可以考虑用 [pygments 来解析你的代码。](http://pygments.org/)

我不知道其他解决方案，但它确实非常易于使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T11:41:28.847

Are you asking about the I18N utilities in Python?

[http://docs.python.org/library/gettext.html#internationalizing-your-programs-and-modules](http://docs.python.org/library/gettext.html#internationalizing-your-programs-and-modules)

There's a utility called po-utils (formerly xpot) that can help with this.

[http://po-utils.progiciels-bpi.ca/README.html](http://po-utils.progiciels-bpi.ca/README.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T12:00:29.893

[Gettext](http://docs.python.org/library/gettext.html)可能会帮助你。将您的字符串放入`_(`**...**`)`结构中：

```
a = _('Test')
b = a
c = _('Another text') 
```

然后在shell提示符下运行：

```
pygettext test.py 
```

您将获得`messages.pot`包含所需信息的文件：

```
# SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR ORGANIZATION
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2009-02-25 08:48+BRT\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=CHARSET\n"
"Content-Transfer-Encoding: ENCODING\n"
"Generated-By: pygettext.py 1.5\n"

#: teste.py:1
msgid "Test"
msgstr ""

#: teste.py:3
msgid "Another text"
msgstr "" 
```

# java - 在 Java 中查找用户主目录的最佳方法是什么？

> ID：585534
> 
> 赞同：335
> 
> 时间：2009-02-25T10:46:51.897
> 
> 标签：java, cross-platform, home-directory

在 Java 中查找用户主目录的最佳方法是什么？

难点在于解决方案应该是跨平台的；它应该适用于 Windows 2000、XP、Vista、OS X、Linux 和其他 Unix 变体。我正在寻找可以在所有平台上完成此操作的代码片段，以及一种检测平台的方法。

根据 Java 错误[4787931](https://bugs.java.com/bugdatabase/view_bug.do?bug_id=4787931)，系统属性`user.home`在 Windows XP 上无法正常工作，因此使用此系统属性不是可接受的解决方案，因为它不是跨平台的。

* * *

## 回答 #1

> 赞同：429
> 
> 时间：2009-02-25T15:05:43.193

您引用的错误（错误 4787391）已在 Java 8 中修复。即使您使用的是较旧版本的 Java，该`System.getProperty("user.home")`方法可能仍然是最好的。这种`user.home`方法似乎在很多情况下都有效。Windows 上的 100% 防弹解决方案很难，因为 Windows 对主目录的含义有一个不断变化的概念。

如果`user.home`对你来说还不够好，我建议选择`home directory`for windows 的定义并使用它，使用`System.getenv(String)`.

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2014-11-13T14:52:00.223

实际上对于 Java 8，正确的方法是使用：

```
System.getProperty("user.home"); 
```

错误[JDK-6519127已得到修复，](http://bugs.java.com/view_bug.do?bug_id=6519127)[发行说明](http://www.oracle.com/technetwork/java/javase/8-compatibility-guide-2156366.html)的“JDK 8 和 JDK 7 之间的不兼容性”部分指出：

> 区域：核心库/java.lang
> 
> 概要
> 
> 用于在 Windows 上确定用户主目录的步骤已更改为遵循 Microsoft 推荐的方法。在旧版本的 Windows 或注册表设置或环境变量设置为其他目录的情况下，可能会观察到此更改。不兼容的性质
> 
> ```
> behavioral RFE
> 
> 6519127 
> ```

尽管问题很老，但我将其留作将来参考。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-02-25T10:53:15.903

```
System.getProperty("user.home"); 
```

请参阅[JavaDoc](http://java.sun.com/javase/6/docs/api/java/lang/System.html#getProperties())。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-02-25T17:10:09.663

对于 Windows，HOME 目录的概念似乎有点模糊。如果[环境变量](http://java.sun.com/javase/6/docs/api/java/lang/System.html)(HOMEDRIVE/HOMEPATH/USERPROFILE) 不够，您可能不得不通过[JNI](http://java.sun.com/javase/6/docs/technotes/guides/jni/)或[JNA](https://github.com/twall/jna/)使用本机函数。[SHGetFolderPath](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx)允许您检索特殊文件夹，例如*我的文档*(CSIDL_PERSONAL) 或*本地设置\应用程序数据*(CSIDL_LOCAL_APPDATA)。

示例 JNA 代码：

```
public class PrintAppDataDir {

    public static void main(String[] args) {
        if (com.sun.jna.Platform.isWindows()) {
            HWND hwndOwner = null;
            int nFolder = Shell32.CSIDL_LOCAL_APPDATA;
            HANDLE hToken = null;
            int dwFlags = Shell32.SHGFP_TYPE_CURRENT;
            char[] pszPath = new char[Shell32.MAX_PATH];
            int hResult = Shell32.INSTANCE.SHGetFolderPath(hwndOwner, nFolder,
                    hToken, dwFlags, pszPath);
            if (Shell32.S_OK == hResult) {
                String path = new String(pszPath);
                int len = path.indexOf('\0');
                path = path.substring(0, len);
                System.out.println(path);
            } else {
                System.err.println("Error: " + hResult);
            }
        }
    }

    private static Map<String, Object> OPTIONS = new HashMap<String, Object>();
    static {
        OPTIONS.put(Library.OPTION_TYPE_MAPPER, W32APITypeMapper.UNICODE);
        OPTIONS.put(Library.OPTION_FUNCTION_MAPPER,
                W32APIFunctionMapper.UNICODE);
    }

    static class HANDLE extends PointerType implements NativeMapped {
    }

    static class HWND extends HANDLE {
    }

    static interface Shell32 extends Library {

        public static final int MAX_PATH = 260;
        public static final int CSIDL_LOCAL_APPDATA = 0x001c;
        public static final int SHGFP_TYPE_CURRENT = 0;
        public static final int SHGFP_TYPE_DEFAULT = 1;
        public static final int S_OK = 0;

        static Shell32 INSTANCE = (Shell32) Native.loadLibrary("shell32",
                Shell32.class, OPTIONS);

        /**
         * see http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx
         * 
         * HRESULT SHGetFolderPath( HWND hwndOwner, int nFolder, HANDLE hToken,
         * DWORD dwFlags, LPTSTR pszPath);
         */
        public int SHGetFolderPath(HWND hwndOwner, int nFolder, HANDLE hToken,
                int dwFlags, char[] pszPath);

    }

} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-02-25T11:03:01.060

其他人已经回答了我面前的问题，但是打印出所有可用属性的有用程序是：

```
for (Map.Entry<?,?> e : System.getProperties().entrySet()) {
    System.out.println(String.format("%s = %s", e.getKey(), e.getValue())); 
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-10-11T10:36:15.903

替代方法是使用 Apache CommonsIO`FileUtils.getUserDirectory()`而不是`System.getProperty("user.home")`. 它将为您提供相同的结果，并且在指定系统属性时没有机会引入拼写错误。

There is a big chance you already have Apache CommonsIO library in your project. Don't introduce it if you plan to use it only for getting user home directory.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-06-22T13:30:32.797

当我在搜索 Scala 版本时，我只能找到上面 McDowell 的 JNA 代码。我在这里包括了我的 Scala 端口，因为目前没有更合适的地方。

```
import com.sun.jna.platform.win32._
object jna {
    def getHome: java.io.File = {
        if (!com.sun.jna.Platform.isWindows()) {
            new java.io.File(System.getProperty("user.home"))
        }
        else {
            val pszPath: Array[Char] = new Array[Char](WinDef.MAX_PATH)
            new java.io.File(Shell32.INSTANCE.SHGetSpecialFolderPath(null, pszPath, ShlObj.CSIDL_MYDOCUMENTS, false) match {
                case true => new String(pszPath.takeWhile(c => c != '\0'))
                case _    => System.getProperty("user.home")
            })
        }
    }
} 
```

与 Java 版本一样，您需要将[Java Native Access](https://github.com/twall/jna)（包括两个 jar 文件）添加到您引用的库中。

很高兴看到 JNA 现在比发布原始代码时更容易做到这一点。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-26T08:34:43.857

我将使用错误报告中详述的算法，使用 System.getenv(String)，如果没有环境变量指示有效的现有目录，则回退到使用 user.dir 属性。这应该可以跨平台工作。

我认为，在 Windows 下，您真正​​追求的是用户的名义“文档”目录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-05T10:24:33.723

如果你想要一些在 Windows 上运行良好的东西，有一个名为[WinFoldersJava](https://github.com/catnapgames/WinFoldersJava)的包，它包装了本机调用以获取 Windows 上的“特殊”目录。我们经常使用它并且效果很好。

# c# - 这是 .net Monitor/lock 语句中的错误还是 MessageBox.Show 的行为不同？

> ID：585535
> 
> 赞同：4
> 
> 时间：2009-02-25T10:47:01.583
> 
> 标签：c#, .net, locking, monitor

想象一下，您在赢单上有两个按钮。当用户使用以下代码按下“按钮 1”时，您认为应该是什么行为？

它应该一次显示所有 5 个消息框，还是一个一个地显示 - MessageBox.Show 语句在 lock 语句中？

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private static readonly object lockobject = new object();

    private void button1_Click(object sender, EventArgs e)
    {
        var action = new Action(function);
        for(int i = 0; i< 5; i++)
        {
            action.BeginInvoke(null, null);
        }
    }

    private void function()
    {
        if (button2.InvokeRequired)
        {
            var func = new Action(function);
            button2.Invoke(func);
        }
        else
        {
            lock (lockobject)
            {
                MessageBox.Show("Testing");
            }
        }
    }
} 
```

现在，如果我们将 MessageBox.Show 替换为任何其他语句，它将一次只执行一个语句，其他线程将等待，一次一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T10:58:27.313

由于您的 lock 语句在 InvokeRequired 为 false 时执行，因此锁将全部在同一个（主）线程上运行。因此锁不会阻塞。

~~如果要阻止 MessageBox，请改用 ShowDialog。~~

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T12:15:56.643

1.  lock 仅在另一个线程拥有锁的情况下才阻塞，允许从同一个线程多次锁定同一个对象 - 否则这将是一个即时死锁，毕竟它会在等待当前线程时阻塞当前线程。

2.  Control.BeginInvoke 不会在不同的线程中执行代码，它总是会执行线程中的代码，为控件泵送消息，它通过将消息发布到控件的输入队列然后在消息到达时执行代码来执行此操作。

因为 2 你的代码根本不是多线程的，所以一切都在同一个线程中执行 - 这让我们回到 1，当你没有多个线程时 lock 什么都不做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:50:53.117

我怀疑 UI 线程在 MessageBox 生命周期中发送消息。因为锁是可重入的（并且UI线程每次都在运行代码），这会导致上述情况。~~也许尝试将所有者（`this`）传递到消息框？（我会在几秒钟内尝试......）~~。

您可以更有力地阻止它，但这会阻止绘画（“不响应”等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T12:20:46.677

我同意尼尔。将函数更改为以下函数后，您可以测试您是否在同一线程上运行（不足为奇）：

```
private void function()
{
   if (button2.InvokeRequired)
   {
        var func = new Action(function);
        button2.Invoke(func);
   }
   else
   {
        lock (lockobject)
        {
            int threadId = Thread.CurrentThread.ManagedThreadId;
            MessageBox.Show("Testing. Running on thread "+threadId);
        }
    }
} 
```

所以这里因为你的 UI 线程有锁，它不会被阻塞。底线是 STA 线程与正确的多线程编程不兼容。

# .net - 错误记录类中最好的异常处理策略是什么？

> ID：585539
> 
> 赞同：1
> 
> 时间：2009-02-25T10:47:34.857
> 
> 标签：.net, exception-handling, error-handling, error-logging

我正在编写一组错误日志记录类，这些类将记录到文件、事件日志等。应该在这些类中执行哪些异常处理？例如，假设我有一个 LogError 方法，该方法从异常处理程序中调用，并写入文件。如果发生错误，什么被认为是最好的做法？显然，我应该使这些方法尽可能安全，但问题总是会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T10:55:41.750

通常，在这种情况下，我会向 stderr 输出尽可能多的信息，通常是日志代码中的错误/异常以及原始日志/错误/异常。这样就有机会重现或理解问题。

如果写入 stderr 失败，那么是时候放弃了——要么忽略它，要么完全终止应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:57:26.627

为什么不使用现有的日志记录机制，例如 log4j/log4net/log4php/log4*？这些工具可能已经整理了这些细节。

作为旁注，如果您在容器（例如：tomcat）中运行代码，即使您在异常处理程序中抛出异常，容器也会捕获并显示它。就像 Douglas Leeder 所说，您可以在处理程序中捕获所有异常并将其扔给 syserr。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T12:33:20.390

这取决于日志记录的用途，如果是调试日志记录，我将吞下异常并继续，因为我不希望应用程序由于调试辅助而在生产中失败，另一方面，如果我正在记录到审计日志银行应用程序 我猜如果应用程序在没有审计的情况下继续工作，客户会感到不安。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T20:34:09.317

您可以将审计和异常处理实现为服务。应用程序级审计日志需要有关每个业务事务的状态数据。在业务或事务上下文中监视应用程序的能力需要服务中的监视接口来发送详细说明特定于服务调用的事务状态的消息。这要求每个服务在业务事务的关键步骤中发送状态消息。然后，您可以构建一个实时查看器，将状态消息（基于消息的语义——例如事务 ID）与复合应用程序中的服务关联起来。这为 SLA 管理、故障跟踪和问题确定提供了业务事务的端到端视图。

然后可以将审计服务实现为状态机，该状态机可以根据其配置中定义的标准来使用和记录消息。通用异常处理程序还可以使用审计服务来支持企业 SOA 中出现的问题的集中视图 - 以支持基于异常的监视。解决方案中的任何不应该发生的条件都被检测为向[异常处理程序发送异常消息。](http://www.perficient.com/Solutions-and-Services/Business-Integration-SOA/Reusable-Utility-Services)

# iphone - iPhone 开发相关的播客？

> ID：585540
> 
> 赞同：6
> 
> 时间：2009-02-25T10:47:40.893
> 
> 标签：iphone, podcast

任何人对良好的 iPhone 开发相关播客有任何建议吗？

我遇到的只有一个[http://www.mobileorchard.com/](http://www.mobileorchard.com/)并且正在寻找其他一些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-03T14:00:07.597

刚刚看到一个新播客[Build and Analyze](http://itunes.apple.com/podcast/build-and-analyze/id404064215)的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T10:53:08.057

[Mac Developer Network](http://www.mac-developer-network.com/)上的 Late Night Cocoa 和其他节目不时以 iPhone 为主题。

[CocoaCast](http://cocoacast.com/)也有 iPhone 剧集，这往往更实用一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T12:50:11.757

[Pragmatic Programmer](http://www.pragprog.com)有一些视频演员，但每人 5 美元。关于[使用 Xcode的系列分为两部分，关于](http://pragprog.com/screencasts/v-mcxcode/becoming-productive-in-xcode)[编写您的第一个 iPhone 应用程序](http://www.pragprog.com/screencasts/v-bdiphone/writing-your-first-iphone-application)的系列分为五部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-03T14:11:57.520

NSBrief 是新的，技术性更强，但也不过分。

[http://NSBrief.com](http://NSBrief.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-20T17:29:49.470

我意识到这个线程可能有点旧并且有一个明显的答案。然而，当我在谷歌上搜索“iphone podcast”时，这是最好的结果之一，这就是我回复的原因。

斯坦福有一门关于 Iphone Development 的课程，您可以通过在 Itunes 上订阅它来查看它。我一直在看这些课程，它们很适合开始使用 Iphone Dev

有关这方面的更多信息，请访问[podcastingnews.com](http://www.podcastingnews.com/content/2009/04/stanford-podcast-teaches-iphone-app-development/)或[斯坦福大学的 itunes 网站](http://itunes.stanford.edu/)

# c# - 为什么 if 语句中的这个字符串初始化会阻止我打印？

> ID：585543
> 
> 赞同：2
> 
> 时间：2009-02-25T10:50:41.247
> 
> 标签：c#, syntax, language-design, if-statement

如果我有一点问题

```
{
    string nom;
    string ou;
    nom = "1";
    if (nom == "1")
    {
        nom +=1;
        ou = nom;
    }
    Console.Write(ou);
} 
```

但我不能打印你的价值我不知道为什么

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-25T10:53:21.147

尝试这样的事情

```
{
    string nom;
    string ou = String.Empty;
    nom = "1";
    if (nom == "1")
    {
        nom +=1;
        ou = nom;
    }
    Console.Write(ou);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-25T10:52:23.350

C# 编译器要求在使用前明确初始化变量。

确定初始化是编译时的事情，它不考虑变量的运行时值。

但是，如果变量`nom`被显式定义为`const`，编译器将确保它不会在运行时更改并且`if`语句块将运行并且变量`ou`将被明确分配给。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-25T10:56:23.090

这甚至可以编译吗？

`nom`是`string`——你怎么办`nom += 1`？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-25T10:54:26.480

尝试将第二行替换为

```
string ou = null; 
```

问题是如果 nom 结果不等于“1”，变量 ou 将不会被初始化。这里的编译器想要保证 ou 已经被赋值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-25T10:53:31.600

这是因为 ou 在 if 块的范围之外未分配。将声明行更改为`string ou = string.Empty;`它应该可以工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T10:53:51.207

这个片段甚至不会编译，更不用说打印了`ou`。C# 强制在访问之前初始化所有变量，这在您的情况下并不总是如此。从而改变

```
string ou; 
```

说：

```
string ou = ""; 
```

会做得很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T11:24:31.057

另一种选择是在 else 中设置 ou：

```
if (nom == "1")
{
    nom +=1;
    ou = nom;
} else 
{
    ou = "blank value";
} 
```

# windows - 刷新环境变量的命令

> ID：585545
> 
> 赞同：0
> 
> 时间：2009-02-25T10:51:01.387
> 
> 标签：windows, environment-variables

这个问题是 wrt this[是否有从 Windows 的命令提示符刷新环境变量的命令？](https://stackoverflow.com/questions/171588/is-there-a-command-to-refresh-environment-variables-from-the-command-prompt-in)您在哪里发表了我们可以避免使用批处理文件的评论。如果你能展示完整的例子，那真的很有帮助。谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-02-25T15:18:45.550

参见[Win32 api 组](http://news://nntp.aioe.org/fr.comp.os.ms-windows.programmation)

为官方方法（MS）刷新环境变量

# mysql - MySQL 与 PostgreSQL？我应该为我的 Django 项目选择哪个？

> ID：585549
> 
> 赞同：73
> 
> 时间：2009-02-25T10:52:11.650
> 
> 标签：mysql, django, database, postgresql, django-migrations

我的 Django 项目将由一个包含数十万条目的大型数据库支持，并且需要支持搜索（我可能最终会使用 djangosearch 或类似项目。）

哪个数据库后端最适合我的项目，为什么？你能推荐一些好的资源来进一步阅读吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2010-05-11T09:18:44.163

无论如何，Django 的创建者都推荐 PostgreSQL。

> 如果您不受任何遗留系统的束缚并且可以自由选择数据库后端，我们推荐 PostgreSQL，它可以在成本、功能、速度和稳定性之间取得良好的平衡。（*Django 权威指南*，第 15 页）

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-02-25T11:29:19.767

作为最近将项目从 MySQL 切换到 Postgresql 的人，我不后悔切换。

从 Django 的角度来看，主要区别在于 Postgresql 中更严格的约束检查，这是一件好事，而且手动更改模式（又名迁移）也有点乏味。

那里可能有 6 个左右的 Django 数据库迁移应用程序，并且至少有一个不支持 Postgresql。不过，我不认为这是一个缺点，因为您可以使用其中一个或手动执行它们（这是我更喜欢 atm 的）。

*MySQL可能*会更好地支持全文搜索。MySQL 在 Django 中支持内置的全文搜索，但它非常无用（没有词干、短语搜索等）。我使用[django-sphinx](http://code.google.com/p/django-sphinx/)作为在 MySQL 中进行全文搜索的更好选择。

Postgresql 8.3 内置全文搜索（早期版本需要 TSearch 模块）。这是一篇很好的指导性博客文章：[使用 PostgreSQL 和 tsearch2 在 Django 中进行全文搜索](http://www.rossp.org/blog/2009/jan/28/django-postgresql-fulltext/)

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-02-25T11:00:07.010

> 拥有数十万条目的大型数据库，

这不是大型数据库，它非常小。

我会选择 PostgreSQL，因为它有更多的特性。在这种情况下最重要的是：在 PostgreSQL 中，您可以使用 Python 作为过程语言。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-25T10:59:58.230

选择你更熟悉的那个。MySQL 与 PostgreSQL 是一场无休止的战争。它们都是优秀的数据库引擎，并且都被主要站点使用。在实践中真的没关系。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-05-08T10:11:18.220

即使 Postgresql 看起来更好，我发现它与 Django 有一些性能问题：

Postgresql 用于处理“长连接”（连接池、持久连接等）

MySQL 用于处理“短连接”（连接、查询、断开连接、[大量打开的连接存在一些性能问题](http://www.mysqlperformanceblog.com/2010/12/17/impact-of-the-number-of-idle-connections-in-mysql/)）

问题是 Django 不支持连接池或持久连接，它必须在每次视图调用时连接/断开与数据库的连接。

它可以与 Postgresql 一起使用，但连接到 Postgresql 的成本要比连接到 MySQL 数据库高很多（在 Postgresql 上，每个连接都有自己的进程，这比在 MySQL 中弹出一个新线程要慢得多）。

然后你会得到一些在某些情况下非常有用的特性，比如查询缓存。（但你失去了 PostgreSQL 精湛的文本搜索）

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-06-02T18:36:06.157

所有的答案都带来了有趣的信息，但有些有点过时了，所以这是我的一粒盐。

从 1.7 开始，[迁移](https://docs.djangoproject.com/en/dev/topics/migrations/#)现在是 Django 的一个组成部分。因此，他们记录了 Django 开发人员可能事先想知道的主要区别。

> # [后端支持](https://docs.djangoproject.com/en/dev/topics/migrations/#backend-support)
> 
> Django 附带的所有后端以及任何第三方后端都支持迁移，如果它们已编程支持模式更改（通过[SchemaEditor](https://docs.djangoproject.com/en/dev/ref/schema-editor/)类完成）。
> 
> 但是，在模式迁移方面，一些数据库比其他数据库更有能力；下面介绍了一些注意事项。
> 
> ## PostgreSQL
> 
> 就模式支持而言，PostgreSQL 是这里所有数据库中能力最强的；唯一需要注意的是，添加具有默认值的列将导致表的完全重写，时间与其大小成正比。
> 
> 因此，建议您始终使用 null=True 创建新列，因为这样会立即添加它们。
> 
> ## MySQL
> 
> MySQL 不支持围绕模式更改操作的事务，这意味着如果迁移无法应用，您将不得不手动取消选择更改才能重试（不可能回滚到更早的点）。
> 
> 此外，MySQL 会为几乎每个模式操作完全重写表，并且通常需要与表中的行数成正比的时间来添加或删除列。在较慢的硬件上，这可能比每百万行一分钟更糟糕 - 将几列添加到只有几百万行的表中可能会将您的站点锁定超过十分钟。
> 
> 最后，MySQL 对列、表和索引的名称长度有相当小的限制，以及对索引覆盖的所有列的组合大小的限制。这意味着在其他后端可能的索引在 MySQL 下将无法创建。
> 
> ## SQLite
> 
> SQLite 几乎没有内置的模式更改支持，因此 Django 尝试通过以下方式模拟它：
> 
> *   使用新架构创建新表
> *   跨数据复制
> *   删除旧表
> *   重命名新表以匹配原始名称
> 
> 此过程通常运行良好，但它可能会很慢并且偶尔会出现错误。除非您非常了解风险及其局限性，否则不建议您在生产环境中运行和迁移 SQLite；Django 附带的支持旨在允许开发人员在其本地计算机上使用 SQLite 来开发不太复杂的 Django 项目，而无需完整的数据库。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-05T10:28:00.200

当 django-south 中的迁移失败时，开发人员鼓励您不要使用 MySQL：

```
! The South developers regret this has happened, and would
! like to gently persuade you to consider a slightly
! easier-to-deal-with DBMS (one that supports DDL transactions) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-07-15T18:39:58.447

因为我熟悉它而走上了 MySQL 的道路（并且努力寻找合适的安装程序并快速测试 postgreSQL 的慢速网络“工作台”界面让我失望），在项目结束时，经过几次部署几个月后，在研究备份选项时，我发现您必须为 MySQL 的企业备份功能付费。就在最后。

使用 MySql，我不得不在 Django 中编写一些丑陋的怪物原始 SQL 查询，因为没有选择不同的每组来检索最新的每组查询。还查看了 postgreSQL 的全文搜索，并希望我使用过 postgresSQL。

即使您熟悉 MySQL，我也推荐 PostgreSQL，但您的里程可能会有所不同。

更新：`DBeaver`是`MySql Workbench`gui 工具的一个很好的等价物，但可以很好地与 PostgreSQL 一起工作（以及许多其他的通用数据库工具）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-05-08T10:29:00.070

要添加到以前的答案：

*   “MySQL 可能更好地支持全文搜索”

MySQL 中的 FULLTEXT 索引是个笑话。

*   它仅适用于 MyISAM 表，因此您会丢失 ACID、事务、约束、关系、持久性、并发性等。
*   INSERT/UPDATE/DELETE 到较大的 TEXT 列（如论坛帖子）将重建大部分索引。如果它不适合 myisam_key_buffer，则会发生大 IO。我见过一个论坛帖子插入触发 100MB 或更多的 IO ...同时帖子表被排他锁定！
*   我做了一些基准测试（3 年前，可能已经过时了……），这表明在大型数据集上，基本上 postgres 全文比 mysql 快 10-100 倍，而 Xapian 比 postgres 快 10-100 倍（但未集成）。

其他未提及的原因是极其智能的查询优化器、大量的连接类型选择（合并、哈希等）、哈希聚合、数组上的 gist 索引、空间搜索等，这些都可以在非常复杂的查询上产生极快的计划。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T15:27:35.700

此应用程序将托管在您自己的服务器上还是由托管公司托管？确保如果您使用托管公司，他们支持选择的数据库。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-13T11:17:40.580

如果您打算使用 db 分发代码，这两个 db 之间存在主要的许可差异，这将影响您。MySQL 的客户端库是 GPL，而 PostegreSQL 是在类似 BSD 的许可证下，这可能更容易使用。

# lolcode - 什么是“最好的”开源 lolcode 解释器？

> ID：585551
> 
> 赞同：19
> 
> 时间：2009-02-25T10:52:19.510
> 
> 标签：lolcode

我有兴趣研究解释器的工作原理，[LOLCODE](http://lolcode.com/)让我发笑，所以：什么是最好的开源 LOLCODE 解释器？提供体面的[REPL](http://en.wikipedia.org/wiki/Read-eval-print_loop)的奖励积分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T11:03:29.017

取决于你最喜欢/“最容易理解”的语言——例如，这里有一个[Java](http://code.google.com/p/lolcode-java/)和一个[Perl](http://drago.cc/lol/)开源解释器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T11:04:02.650

虽然可能不是“最好的”，但我认为 DLR 团队的某个人实际上创建了一个[基于 DLR 的 LOLCode 解释器](http://www.iunknown.com/2007/11/lolcode-on-dlr.html)非常酷，并且可以完全访问 .NET Framework。

[从Wayback Machine](http://web.archive.org/web/20101017154612/http://www.iunknown.com/2007/11/lolcode-on-dlr.html)添加了链接

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-18T20:45:24.090

我最喜欢的实现是[LOLPython](http://www.dalkescientific.com/writings/diary/archive/2007/06/01/lolpython.html)

因此，如果您是 python 粉丝，那就太好了。:)

如果您想对已定义的内容进行更改，这非常简单。:D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T17:55:44.500

当然，如果没有“最佳”的定义，就几乎没有办法肯定地回答这个问题。我正在编写一个 LOLCODE 解释器（[http://pgfoundry.org/projects/pllolcode/](http://pgfoundry.org/projects/pllolcode/)）来支持 LOLCODE 作为在 PostgreSQL 数据库中编写存储过程的语言。（为什么，你问？因为我想学习如何。）这个解释器是用 C 语言编写的，并使用 Bison 和 Flex 进行解析。在这种情况下，这些似乎是“最佳”选择，因为这就是 PostgreSQL 本身使用的。如果您更熟悉 Perl，那么基于 Perl 的解释器可能会更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-20T20:50:34.073

我知道它不是解释器，但我使用了[Lolcode.net](http://lolcode.com/implementations/lolcode.net)实现，它对我来说效果很好。它遵循[规范](http://lolcode.com/specs/1.2)相对较好，除了一些东西（如数组）。

此外，如果 Linux 兼容性对您很重要，我使用[Mono](http://en.wikipedia.org/wiki/Mono_(software))让它在 Linux 中运行。

# spell-checking - 你如何拼写检查一个网站？

> ID：585583
> 
> 赞同：28
> 
> 时间：2009-02-25T11:01:04.637
> 
> 标签：spell-checking

我知道拼写检查器并不完美，但随着文本数量的增加，它们会变得更加有用。如何拼写检查有数千页的网站？

编辑：由于复杂的服务器端处理，我可以获取页面的唯一方法是通过 HTTP。也不能外包给第三方。

编辑：我有一个我需要检查的网站上所有 URL 的列表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T13:16:38.463

Lynx 似乎擅长获取我需要的文本（正文内容和替代文本）而忽略我不需要的内容（嵌入的 Javascript 和 CSS）。

```
lynx -dump http://www.example.com 
```

它还列出了页面中的所有 URL（转换为它们的绝对形式），可以使用 grep 将其过滤掉：

```
lynx -dump http://www.example.com | grep -v "http" 
```

`file://`如果我使用 wget 镜像站点，URL 也可以是本地的 ( )。

我将编写一个脚本，该脚本将使用此方法处理一组 URL，并将每个页面输出到一个单独的文本文件。然后，我可以使用现有的拼写检查解决方案来检查文件（或结合所有小文件的单个大文件）。

这将忽略标题和元元素中的文本。这些可以单独进行拼写检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-09T18:10:10.003

[就在我发现Spello 网站拼写检查器](http://spello.codeplex.com/)的前几天查看。它使用我的 [NHunspell（Open office Spell Checker for .NET）](http://nhunspell.sourceforge.net/) libaray。你可以试一试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T11:55:15.927

如果您可以以文件的形式访问站点的内容，您可以编写一个小的 Unix shell 脚本来完成这项工作。以下脚本将打印文件名、行号和拼写错误的单词。输出的质量取决于系统字典的质量。

```
#!/bin/sh

# Find HTML files
find $1 -name \*.html -type f |
while read f
do
        # Split file into words
        sed '
# Remove CSS
/<style/,/<\/style/d
# Remove Javascript
/<script/,/<\/script/d
# Remove HTML tags
s/<[^>]*>//g
# Remove non-word characters
s/[^a-zA-Z]/ /g
# Split words into lines
s/[     ][      ]*/\
/g ' "$f" |
        # Remove blank lines
        sed '/^$/d' |
        # Sort the words
        sort -u |
        # Print words not in the dictionary
        comm -23 - /usr/share/dict/words >/tmp/spell.$$.out
        # See if errors were found
        if [ -s /tmp/spell.$$.out ]
        then
                # Print file, number, and matching words
                fgrep -Hno -f /tmp/spell.$$.out "$f"
        fi
done
# Remove temporary file
rm /tmp/spell.$$.out 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-28T14:04:19.020

我强烈推荐[Inspyder InSite](http://www.inspyder.com/products/InSite/)，它是商业软件，但他们有试用版，物有所值。我多年来一直使用它来检查客户网站的拼写。它支持自动化/调度，并且可以与 CMS 自定义单词列表集成。这也是链接检查的好方法，可以生成报告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T11:31:38.823

You could do this with a shell script combining wget with aspell. Did you have a programming environment in mind?

I'd personally use python with Beautiful Soup to extract the text from the tags, and pipe the text through aspell.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T11:40:43.280

If its a one off, and due to the number of pages to check it might be worth considering somthing like spellr.us which would be a quick solution. You can entering in your website url on the homepage to get a feel for how it would report spelling mistakes.

[http://spellr.us/](http://spellr.us/)

but I'm sure there are some free alternatives.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T01:35:09.147

我们在 ASP.NET 应用程序中使用 Telerik RAD Spell 控件。

[Telerik RAD 法术](http://www.telerik.com/products/aspnet-ajax/spell.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T02:07:07.853

You may want to check out a library like jspell.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-09T22:26:19.987

我在这里用 Ruby 制作了一个仅限英语的拼写检查器：[https ://github.com/Vinietskyzilla/fuzzy-wookie](https://github.com/Vinietskyzilla/fuzzy-wookie)

试试看。

它的主要缺陷是缺乏包含每个单词所有形式的完整词典（复数，不仅仅是单数；'has'，而不仅仅是'have'）。替换你自己的字典，如果你能找到或制作更好的字典，那会非常棒。

* * *

除此之外，我认为对单个网页进行拼写检查的最简单方法是按 ctrl+a（或 cmd+a）选择所有文本，然后将其复制并粘贴到网页上的多行文本框中。（例如`<html><head></head><body><textarea></textarea></body></html>`。）您的浏览器应在所有拼写错误的单词下划线。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T11:48:50.857

在您的 web 应用程序中使用模板（以及）（如果您正在对网站进行编程，而不仅仅是编写 html），以及一个包含拼写检查的 html 编辑器。Eclipse 确实如此。

如果由于某种原因这不可能......是的，wget 下载完成的页面，如下所示：

[http://netsw.org/dict/tools/ispell-html-mode.patch](http://netsw.org/dict/tools/ispell-html-mode.patch)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-11-29T02:16:05.897

@Anthony Roy 我已经完成了你所做的。通过 Pyenchant 将页面通过 Aspell 管道传输。我有英文词典（GB、CA、US）在我的网站[https://www.validator.pro/](https://www.validator.pro/)上使用。联系我，我会为你安排一个一次性的工作来检查 1000 页或更多

# javascript - 如何隐藏没有 src 属性的 img 元素，直到添加该属性？

> ID：585586
> 
> 赞同：2
> 
> 时间：2009-02-25T11:02:22.450
> 
> 标签：javascript, image, src

我的 JS 代码包含一些开头为空的图像（完全没有指定 src 属性 + display:none）。

当添加到具有 CSS1 兼容性的站点时，我看到图像应该在的位置损坏，即使**图像不应该显示**（显示：无）。

知道如何隐藏损坏的图像图标吗？

注意：我不想加载空图像。我试过 width 和 height= 1px 或 0px 。没用。指定 src="" 也会给出空图像图标。

编辑：我找到了解决方案：将 style="display:none" 添加到 img 定义（不在 CSS 中）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T11:04:55.783

您是否尝试过将图像包装在 div 中并隐藏 div？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T11:27:38.333

> 我的 JS 代码包含一些开头为空的图像（未指定 src 属性

这不是图像的有效状态。最好使用占位符透明图像或将图像留在 DOM 之外，直到您可以设置“真实”src 属性。

> 即使不应该显示图像（显示：无），我也看到图像应该在的位置损坏的图像图标。

对我来说不会发生，“显示：无”或“可见性：隐藏”会从页面中删除可见图像。演示问题的示例代码，以及哪些浏览器？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T16:54:50.233

解决方案非常简单：

将 style="display:none" 添加到 img 定义（不在 CSS 中）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T11:08:18.740

在显示图像时，仅使用占位符 div 标签并用图像替换它怎么样？任何像样的 ajax 框架（例如 jQuery）都会使这很容易做到，因此它适用于所有主要浏览器

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T11:14:31.953

除了显示：无，也许尝试设置可见性：隐藏

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T11:08:19.223

如果您使用的是 JavaScript 库，则可能值得为所有这些图像应用一个类来命名并让库处理它。使用类名 myImages 的原型示例将是

```
var images = $$('.myImages');

if (image != null)
{
    for (int i = 0; i < images.Length; i++)
    {
        images[i].hide;
    }
} 
```

您仍然需要添加样式属性 style="display: none;" 到图像

# java - Java 原生数组长度

> ID：585587
> 
> 赞同：3
> 
> 时间：2009-02-25T11:02:41.093
> 
> 标签：java, arrays

我在Java中有一个二维数组，它基本上是一个值表，我想找出它有多少行......

它在其他地方声明（并分配），如下所示：

```
double[][] table; 
```

然后传递给一个函数......

```
private void doSomething(double[][] table)
{

} 
```

在我的函数中，我想知道每个维度的长度，而不必将它们作为参数传递。我可以对列数执行此操作，但不知道如何对行执行此操作...

```
int cols = table[0].length;
int rows = ?; 
```

我怎么做？

我只能说...

```
int rows = table.length; 
```

为什么不给行 x 列？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-25T11:08:04.747

在 Java 中，二维数组只不过是一个数组数组。

这意味着您可以像这样轻松获取行数：

```
int rows = array.length; 
```

这也意味着这样一个数组中的每一行*可以*有不同数量的元素（即每行可以有不同数量的列）。

```
int columnsInFirstRow = array[0].length; 
```

这只会为您提供第一行中的列数，但第二行可能有更多或更少的列。

您可以指定您的方法仅采用矩形数组，并*假设*每一行的列数与第一行相同。但在那种情况下，我会将二维数组包装在某个 Matrix 类中（您可能必须编写）。

这种数组称为[锯齿状数组](http://xahlee.org/java-a-day/arrays2.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T11:07:56.743

看看[这个例子](http://leepoint.net/notes-java/data/arrays/arrays-2D-2.html)。他们在那里使用 .length 来获取行数， [].length 来获取列数。

这是因为数组由“行”指针组成，这些指针可以指向任何地方，所以你也必须为每一列使用 .length 来获取这些数组的大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T11:09:06.287

我不太明白你的问题。您必须意识到，在 Java 中，多维数组实际上是数组的数组。

`table.length`实际上会给您二维数组中包含的一维数组的数量（假设没有空条目）。

`table[0].length`会给你第一个一维条目的大小。这可能与其他的大小不同，并且可能抛出 NullPointerException （尽管当它被分配为 时两者都不可能`new double[rows][cols]`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T11:10:36.877

好吧，首先，你为什么不测试一下

```
int rows = table.length; 
```

给出预期的结果？

它确实为您提供了第一维中的元素数量。多维数组实际上没有什么特别的，因为它们只是数组数组的数组......在你的情况下 - 一个二维数组 - 它的组织方式是这样的（在伪代码中）：

```
double[][] foo = { double[] = {...}, double[] = {...}, ... } 
```

所以当访问 foo 时，它指的是“外部”数组，它当然有 length 属性，它包含了它在第二层包含的数组的数量。

您可以将 double[][] 解读为“双数组 (double[]) 的数组 ([])”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T11:09:03.590

不，不会的。你可以只使用 table.length

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T11:12:50.350

或者，您可以将 2d 数组包装到某种 Matrix 或 Grid 类中。在内部，您可以将其表示为一维数组并计算行/列坐标的偏移量。

# tdd - 如何使用硬件进行 TDD

> ID：585593
> 
> 赞同：13
> 
> 时间：2009-02-25T11:04:18.000
> 
> 标签：tdd, hardware

我工作的所有项目都与一个硬件接口，这通常是软件的主要目的。有什么有效的方法可以将 TDD 应用于与硬件一起工作的代码？

**更新：**对不起，我的问题没有更清楚。

我使用的硬件是从相机捕获图像的图像采集卡。然后我处理这些图像，显示它们并将它们保存到磁盘。我可以使用存储在磁盘上的先前捕获的图像来模拟捕获图像后发生的所有处理。

但这是我要测试的与硬件的实际交互。例如，当没有连接相机时，我的软件是否正确处理，它是否正确启动和停止抓取等。但这与硬件紧密相关，我不知道当硬件不存在时如何测试它或如果我什至应该尝试这样做？

**第二次更新：**我也在寻找一些具体的例子来说明人们是如何处理这种情况的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T11:44:41.630

创建一个薄层来控制硬件，并使用完整硬件的系统测试（手动或自动）以确保控制层按预期工作。然后创建控制层的假/模拟实现，它的外部行为类似于真实硬件的接口，并在为程序的其余部分执行 TDD 时使用它。

* * *

几年前，我正在编写使用 SQUID 磁力计进行测量的软件。硬件很大，不可移动且昂贵（[视频](http://hoslab.cs.helsinki.fi/downloads/ikayaki/squid-videos-2005-01-27/video04.avi)），因此不可能始终访问硬件。我们有关于设备通信协议的文档（通过串行端口），但文档不是 100% 准确的。

对我们帮助很大的是创建一个软件，它可以监听来自一个串行端口的数据，记录它并将其重定向到另一个串行端口。然后我们能够找出旧程序（我们正在替换）如何与硬件通信，并对协议进行逆向工程。它们是这样链接的：旧程序 <-> 虚拟环回串行端口 <-> 我们的数据记录器 <-> 真实串行端口 <-> 硬件。

那时我们没有使用 TDD。我们确实考虑过为硬件编写一个模拟器，以便我们可以单独测试程序，但是由于我们不知道硬件应该如何工作，所以很难编写一个准确的模拟器，所以最后我们没有做。如果我们更了解硬件，我们可以为它创建一个仿真器，它会使程序的开发变得更加容易。用真正的硬件进行测试是最有价值的，事后看来，我们应该花更多的时间在硬件上进行测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T12:17:39.167

将您的测试套件分成两部分：

1.  第一部分针对真实硬件运行测试。这部分用于构建模型。通过为此编写自动测试，如果您对模型是否正常工作有任何疑问，可以再次运行它们。

2.  第二部分针对模型运行。这部分自动运行。

在确保硬件连接正确等之后，第 #1 部分将手动运行。一个好主意是创建一套针对工厂返回的内容运行的测试，并运行这些测试两次：一次使用返回真正的“司机”，曾经反对你的模拟对象的工厂。这样，您可以确保您的模拟与真实事物完全一样：

```
class YourTests extends TestCase {
    public IDriver getDriver() { return new MockDriver (); }
    public boolean shouldRun () { return true; }
    public void testSomeMethod() throws Exception {
        if (!shouldRun()) return; // Allows to disable all tests
        assertEquals ("1", getDriver().someMethod());
    }
} 
```

在我的代码中，我通常使用系统属性 (-Dmanual=yes) 来切换手动测试：

```
class HardwareTests extends YourTests {
    public IDriver getDriver() { return new HardwareDriver (); }
    public boolean shouldRun () { return "yes".equals (System.getProperty("manual")); }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T11:41:43.823

如果您正在编写软件来处理来自专用硬件的数据，那么您可以合理地为硬件创建替身来测试软件。

如果硬件接口很简单，比如串行端口，您可以轻松地使用环回电缆让您的程序与模拟硬件通信。几年前，我在编写软件与信用处理器交谈时使用了这种方法。我的测试应用程序被认为我的模拟器是调制解调器和后端处理器。

如果您正在编写 PCI 设备驱动程序或同等级别的软件，那么您可能无法创建软件替身。

将 TDD 应用于此类问题的唯一好方法是，如果您能够使用另一个程序来欺骗硬件的 i/o。例如，我为加油站处理信用卡。在我目前的项目中，我们有一个模拟器，它是连接到一些开关的泵电子设备，以便可以模拟泵的操作（提升手柄、挤压扳机、燃油流量）。可以想象，我们可以构建一个可由软件控制的模拟器。

或者，根据设备，您可以使用标准测试设备（信号发生器等）为其提供“已知输入”。

请注意，这存在您同时测试硬件和设备驱动程序的问题。不幸的是，这确实是您现阶段唯一的好选择 - 任何模拟硬件都可能与真实设备有足够的差异，因此无法进行测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T11:43:58.577

在测试套件中包含访问硬件的测试可能不是一个好主意。这种方法的一个问题是，测试只能在连接到这个特殊硬件的机器上运行，这使得作为（夜间）自动构建过程的一部分运行测试变得很困难。

一种解决方案可能是编写一些软件模块，其行为类似于缺少的硬件模块，至少从接口的角度来看是这样。在运行您的测试套件时，访问这些软件模块而不是真正的硬件。

我也喜欢将测试套件分成两部分的想法：

*   一种访问您手动运行的真实硬件的设备
*   访问软件模块的一种，它作为自动测试的一部分运行

根据我的经验，涉及真实硬件的测试几乎总是需要一些手动交互（例如插入和拔出某些东西以查看是否正确检测到），这使得自动化非常困难。好处往往不值得麻烦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T11:21:14.497

巧妙地嘲讽。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-28T22:03:31.120

当我在机顶盒上工作时，我们有一个工具可以从任何带有 doxygen 注释的 C API 生成模拟。

然后，我们将使用我们希望硬件返回的内容来启动模拟，以便对我们的组件进行单元测试。

因此，在上面的示例中，您将 FrameGrabber_API_IsDeviceAttached 的结果设置为 false，并且当您的代码调用该函数时，它返回 false，您可以对其进行测试。

测试的难易程度取决于您的代码当前的结构。

我们用来生成模拟的工具在内部，所以我无法帮助你。但是有一些有希望的谷歌点击：（免责声明 - 我已经使用过其中的任何一个，但希望它们可以对你有所帮助）

*   [http://code.google.com/p/googlemock/](http://code.google.com/p/googlemock/)
*   [http://www.opensourcetesting.org/unit_c.php](http://www.opensourcetesting.org/unit_c.php)
*   [http://spin.atomicobject.com/2006/12/29/cmock-ruby-based-mock-tools-for-c](http://spin.atomicobject.com/2006/12/29/cmock-ruby-based-mock-tools-for-c)

只是检查-您的代码中是否有直接 ioctl 调用之类的东西？这些总是很难模拟。我们有一个操作系统包装层，我们可以轻松地为其编写模拟程序，因此对我们来说非常容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T11:11:20.293

如果您有模拟器，您可以针对模拟器编写测试并针对硬件运行这些测试。

很难用这么少的细节回答问题:-)

# java - GlassFish 中的 HTTP 连接池

> ID：585595
> 
> 赞同：0
> 
> 时间：2009-02-25T11:05:53.410
> 
> 标签：java, http, jakarta-ee, glassfish

在我的网络服务中，我需要进行一些 HTTP 调用。是否可以做一些连接池，比如我做 JDBC 连接池？

在 GlassFish 的管理控制台中，我看到了配置项`Connector Connection Pool`和`Connector Resources`. 我可以使用这些吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-05T15:46:48.283

doekman 的回答是一种可能的方法。

在我的公司，我们只使用 Apache Commons 的 HTTPClient 库，它有自己的连接池管理器。下面的这个链接应该让你很容易。

[http://hc.apache.org/httpclient-3.x/performance.html](http://hc.apache.org/httpclient-3.x/performance.html)

是否要引入另一个外部依赖项是您自己的价值判断。从 Tomcat 迁移我们的应用程序后，我们选择保留对 HTTPClient 的依赖，因为它易于使用，同时减轻了构建（**和**维护）另一个工厂类的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T21:39:22.373

这篇关于 GlassFish 性能调优[的博文和白皮书可能会有所帮助：](http://blogs.oracle.com/binublog/entry/monitoring_in_glassfish)

John Clingan GlassFish 集团产品经理 Sun Microsystems

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:43:30.277

不。对于 HTTP，您实际上不需要连接池（除非您是浏览器）。HTTP 连接比数据库连接便宜得多。

但是，您可以使用自定义资源，因此可以在 JNDI 中配置连接。[这篇文章](http://blogs.oracle.com/chengfang/entry/how_to_create_custom_resources)帮助了我。[还有](http://blogs.oracle.com/chengfang/entry/how_to_inject_and_look) [三个](http://blogs.oracle.com/chengfang/entry/how_to_parameterize_and_configure) [后续帖子](http://blogs.oracle.com/chengfang/entry/a_generic_beanfactory_class_for)。

# java - 是什么导致我的 java.net.SocketException：连接重置？

> ID：585599
> 
> 赞同：149
> 
> 时间：2009-02-25T11:07:06.323
> 
> 标签：java, sockets, socketexception, connection-reset

我们在日志中看到频繁但间歇性 `java.net.SocketException: Connection reset`的错误。我们不确定`Connection reset`错误实际上来自哪里，以及如何进行调试。

该问题似乎与我们尝试发送的消息无关。请注意，该消息**不是** `connection reset by peer`.

有关此异常的典型原因可能是什么以及我们如何进行的任何建议？

这是一个有代表性的堆栈跟踪（`com.companyname.mtix.sms`是我们的组件）：

```
    java.net.SocketException：连接重置
        在 java.net.SocketInputStream.read(SocketInputStream.java:168)
        在 java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
        在 java.io.BufferedInputStream.read(BufferedInputStream.java:235)
        在 org.apache.commons.httpclient.HttpParser.readRawLine(HttpParser.java:77)
        在 org.apache.commons.httpclient.HttpParser.readLine(HttpParser.java:105)
        在 org.apache.commons.httpclient.HttpConnection.readLine(HttpConnection.java:1115)
        在 org.apache.commons.httpclient.HttpMethodBase.readStatusLine(HttpMethodBase.java:1832)
        在 org.apache.commons.httpclient.HttpMethodBase.readResponse(HttpMethodBase.java:1590)
        在 org.apache.commons.httpclient.HttpMethodBase.execute(HttpMethodBase.java:995)
        在 org.apache.commons.httpclient.HttpMethodDirector.executeWithRetry(HttpMethodDirector.java:397)
        在 org.apache.commons.httpclient.HttpMethodDirector.executeMethod(HttpMethodDirector.java:170)
        在 org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:396)
        在 org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:324)
        在 com.companyname.mtix.sms.services.impl.message.SendTextMessage.sendTextMessage(SendTextMessage.java:127)
        在 com.companyname.mtix.sms.services.MessageServiceImpl.sendTextMessage(MessageServiceImpl.java:125)
        在 com.companyname.mtix.sms.services.remote.MessageServiceRemoteImpl.sendTextMessage(MessageServiceRemoteImpl.java:43)
        在 sun.reflect.GeneratedMethodAccessor203.invoke（未知来源）
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:585)
        在 org.apache.axis.providers.java.RPCProvider.invokeMethod(RPCProvider.java:397)
        在 org.apache.axis.providers.java.RPCProvider.processMessage(RPCProvider.java:186)
        在 org.apache.axis.providers.java.JavaProvider.invoke(JavaProvider.java:323)
        在 org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)
        在 org.apache.axis.SimpleChain.doVisiting（SimpleChain.java:118）
        在 org.apache.axis.SimpleChain.invoke（SimpleChain.java:83）
        在 org.apache.axis.handlers.soap.SOAPService.invoke(SOAPService.java:453)
        在 org.apache.axis.server.AxisServer.invoke（AxisServer.java:281）
        在 org.apache.axis.transport.http.AxisServlet.doPost(AxisServlet.java:699)
        在 javax.servlet.http.HttpServlet.service(HttpServlet.java:709)
        在 org.apache.axis.transport.http.AxisServletBase.service(AxisServletBase.java:327)
        在 javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
        在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)
        在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
        在 com.companyname.mtix.sms.http.filters.NoCacheFilter.doFilter(NoCacheFilter.java:63)
        在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)
        在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
        在 com.companyname.mtix.sms.http.filters.MessageFilter.doFilter(MessageFilter.java:53)
        在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)
        在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
        在 org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:61)
        在 org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:77)
        在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)
        在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
        在 org.ajaxanywhere.AAFilter.doFilter(AAFilter.java:46)
        在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)
        在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
        在 org.apache.catalina.core.StandardWrapperValve.invoke（StandardWrapperValve.java:213）
        在 org.apache.catalina.core.StandardContextValve.invoke（StandardContextValve.java:178）
        在 org.apache.catalina.core.StandardHostValve.invoke（StandardHostValve.java:126）
        在 org.apache.catalina.valves.ErrorReportValve.invoke（ErrorReportValve.java:105）
        在 org.apache.catalina.valves.AccessLogValve.invoke（AccessLogValve.java:541）
        在 org.apache.catalina.core.StandardEngineValve.invoke（StandardEngineValve.java:107）
        在 org.apache.catalina.connector.CoyoteAdapter.service（CoyoteAdapter.java:148）
        在 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
        在 org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
        在 org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)
        在 org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
        在 org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
        在 java.lang.Thread.run(Thread.java:595)

```

* * *

我们的组件是一个 Web 应用程序，在 Tomcat 下运行，它调用发送 SMS 消息的第三方 Web 服务，它就是这样发生的。引发异常的代码行是下面代码片段的最后一行。

```
String aggregatorResponse = null;
HttpClient httpClient = prepareHttpClient( username, password );
PostMethod postMethod = preparePostMethod( textUrl );

try {
  SybaseTextMessageBuilder builder = new SybaseTextMessageBuilder();
  URL notifyUrl = buildNotificationUrl( textMessage, codeSetManager );
  String smsRequestDocument = builder.buildTextMessage( textMessage, notifyUrl );
  LOG.debug( "Sybase MT document created as: \n" + smsRequestDocument );

  postMethod.setRequestEntity( new StringRequestEntity( smsRequestDocument ) );
  LOG.debug( "commiting SMS to aggregator: " + textMessage.toString() );
  int httpStatus = httpClient.executeMethod( postMethod ); 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-02-25T11:30:57.110

SocketException 的 javadoc 声明它是

> 抛出表示底层协议有错误，例如 TCP 错误

在您的情况下，连接的服务器端似乎已关闭连接。这可能是您发送的请求的问题或最终的问题。

为了帮助调试，您可以使用诸如[Wireshark](http://www.wireshark.org)之类的工具来查看实际的网络数据包。此外，是否有可用于测试 Web 服务的 Java 代码的替代客户端？如果此操作成功，则可能表明 Java 代码中存在错误。

当您使用 Commons HTTP Client 时，请查看[Common HTTP Client Logging Guide](http://hc.apache.org/httpclient-3.x/logging.html)。这将告诉您如何在 HTTP 级别记录请求。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-07-29T01:39:01.757

这个错误**发生在你这边**而不是另一边。如果对方重置连接，那么异常消息应该说：

```
java.net.SocketException reset by peer 
```

原因是内部连接`HttpClient`陈旧。检查 SSL 的陈旧连接不能修复此错误。解决方案：转储您的客户端并重新创建。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-10-21T10:41:23.563

如果您在尝试访问部署在 Glassfish3 服务器上的 Web 服务时遇到这种情况，您可能需要调整您的 http-thread-pool 设置。修复了当许多并发线程调用 Web 服务时我们遇到的 SocketExceptions。

1.  转到管理控制台
2.  导航到“配置”->“服务器配置”->“线程池”->“http-thread-pool”。
3.  将设置“最大线程池大小”从 5 更改为 32
4.  将设置“最小线程池大小”从 2 更改为 16
5.  重新启动 Glassfish。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-08-28T12:07:58.707

我也偶然发现了这个错误。就我而言，问题是我使用的是 JRE6，它支持[TLS1.0](https://stackoverflow.com/questions/10500511/how-to-find-what-ssl-tls-version-is-used-in-java)。服务器只支持 TLS1.2，所以抛出了这个错误。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-01-22T19:17:05.710

在我的情况下，这是因为我的 Tomcat 设置不足，无法`maxHttpHeaderSize`满足特别复杂的 SOLR 查询。

希望这可以帮助那里的人！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-06-27T22:36:13.930

我一直收到这个错误并认为它是正常的。

当另一方已经挂断时一方试图阅读时，就会发生这种情况。因此**，根据协议，这可能会或可能不会指定一个问题**。如果我的客户端代码明确向服务器表明它将挂断，那么客户端和服务器都可以同时挂断，并且不会发生此消息。

我实现代码的方式是让客户直接挂断而不说再见。然后服务器可以捕获错误并忽略它。在 HTTP 的上下文中，我相信协议的一个级别允许每个连接一个以上的请求，而另一个不允许。

因此，您可以看到一方有可能继续挂断另一方。我怀疑您收到的错误是否存在任何盗版问题，您可以简单地抓住它以防止它填满您的日志文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-25T11:35:41.730

当客户端在通过套接字返回响应之前关闭套接字连接时，服务器端会发生此错误。在 Web 应用场景中，并非所有这些都是危险的，因为它们可以手动创建。例如，在检索到响应之前退出浏览器。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-25T11:23:53.397

异常意味着套接字从另一端意外关闭。由于您正在调用 Web 服务，因此不应该发生这种情况 - 很可能您发送的请求会触发 Web 服务中的错误。

尝试在这些情况下记录整个请求，看看是否发现任何异常。否则，请与网络服务提供商联系并将您记录的有问题的请求发送给他们。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-14T12:19:58.597

我知道这个线程有点旧，但想加我的 2 美分。在我们发布其中一个版本之后，我们立即遇到了相同的“连接重置”错误。

根本原因是，我们的`apache`服务器因部署而停机。我们所有的第三方流量都通过`apache`，并且由于连接中断，我们遇到了连接重置错误。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-05T03:21:13.167

`java.net.SocketException: Connection reset`这是一个旧线程，但我昨天遇到了。

服务器端应用程序的限制设置已更改为一次只允许 1 个连接！因此，有时电话会通过，有时不会。我通过更改节流设置解决了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-11-05T20:31:07.363

当我尝试读取的文本文件包含与防火墙上的防病毒签名匹配的字符串时，我收到此错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-12T09:04:34.320

FWIW，当我不小心向期望 POST 请求的端点发出 GET 请求时，我收到了这个错误。据推测，这只是处理问题的特定服务器方式。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2011-09-28T14:40:41.790

我也得到了这个错误：`Connection reset by peer`。Spring 的 REST 模板在运行该`postForObject()`方法时引发了异常。对我来说，问题是 HTTP URL 请求太长。所以首先检查生成的 URL 是否是它应该是的，如果你的服务器真的应该能够处理该长度的请求，只需转到服务器的配置并提高 URL 请求的默认允许长度。

这解决了我的问题，但请注意：该应用程序可能无法在某些 Internet 浏览器上运行，尤其是旧浏览器，因为它们具有固定的最大 URL 请求长度。

希望能帮助到你...

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2018-11-28T22:04:34.137

我收到此错误是因为我尝试连接的端口已关闭。

# c# - 使用 LINQ 查询数据库的最快方法是什么？

> ID：585608
> 
> 赞同：2
> 
> 时间：2009-02-25T11:10:25.630
> 
> 标签：c#, linq

我正在阅读关于 LINQ 的 WROX 书，作者正在数据库上执行 LINQ。本质上，他将数据库作为对象访问，如下面的代码所示。

但我不明白他希望如何“将数据库作为对象访问”，即使下载的代码在“db.DirectoryInformation”上出现错误，说“DirectoryInformation”是未知的。

我错过了什么？我想我首先需要创建 LINQ-to-SQL 类或 ADO.NET EDM，或者是否有更直接的方法将 LINQ 连接到数据库，即只需创建一个从 DataContext 继承的数据库类？

```
AdventureWorks db = new AdventureWorks("Integrated Security=sspi");

...

    [Database(Name = "AdventureWorks")]
    public class AdventureWorks : DataContext
    {
        //public Table<DirInfo> DirectoryInformation;
        public AdventureWorks(string connection) : base(connection) { }
        public Table<DirectoryInformation> DirectoryInformation;
    } 
```

**你可以[在这里下载整个代码](http://www.wrox.com/WileyCDA/WroxTitle/Professional-LINQ.productCd-0470041811,descCd-DOWNLOAD.html)，第 1 章，LINQ.sln。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T11:33:00.740

查看 Form1.cs 源文件的末尾，使用属性声明了 LINQ to SQL 数据库：

```
[Database(Name = "AdventureWorks")]
public class AdventureWorks : DataContext
{
    //public Table<DirInfo> DirectoryInformation;
    public AdventureWorks(string connection) : base(connection) { }
    public Table<DirectoryInformation> DirectoryInformation;
}

[Table(Name = "DirectoryInformation")]
public class DirectoryInformation
{
    [Column(DbType="varchar(50)")]
    public string DirectoryName;

    [Column(DbType = "varchar(255)")]
    public string DirectoryDescription;
} 
```

为项目提供设置定义一个连接字符串，这就是将 DirectoryInformation 类型简单映射到 AdventureWorks 数据库中的 DirectoryInformation 表所需的全部内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T11:19:27.247

哦，绝对可以在 LINQ-to-SQL 中使用 vanilla 对象；你甚至不需要子类化`DataContext`——但你确实需要告诉它你的模型。这通常通过成员（对于列）和类型（对于表）的属性来完成，但也可以通过外部映射文件 (xml) 来完成。我想知道他们是否只是为了简单起见而过度缩写......例如，我怀疑表应该是一个属性：

```
public Table<DirectoryInformation> DirectoryInformation {
    get { return GetTable<DirectoryInformation>(); }
} 
```

整个“dbml”只是作为设计工具来帮助您生成类；重要的代码只是修饰的类（在导航属性等方面有一些约定，以使使用起来更简单）。也就是说，对于“最快”：使用设计器。

# sql - 在 Derby 中一次更新多个列

> ID：585620
> 
> 赞同：3
> 
> 时间：2009-02-25T11:15:11.000
> 
> 标签：sql, derby

DB2 支持这种语法：

```
UPDATE DEST D SET (AAA,BBB) = (
    SELECT MAX(Z.AAA), MAX(Z.BBB) FROM OTHER O WHERE O.ID = D.ID
) 
```

即我可以运行一个返回多个列的选择并将结果复制到目标表的各个列（要更新的列）。

Derby 只允许以下语法：

```
UPDATE table-Name [[AS] correlation-Name]
    SET column-Name = Value
    [ , column-Name = Value} ]*
    [WHERE clause] 
```

这意味着当我需要以某种方式对选择的结果进行分组时，我可能会遇到问题。有没有比将更新拆分为两个语句或在 Java 循环中本地执行此操作（即提交数百万个 UPDATE 语句）更好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T06:30:13.407

大概，你可以这样做：

```
UPDATE DEST D
    SET AAA = (SELECT MAX(Z.AAA) FROM OTHER O WHERE O.ID = D.ID),
        BBB = (SELECT MAX(Z.BBB) FROM OTHER O WHERE O.ID = D.ID) 
```

我没有说任何关于效率的事情 - 但它可能比将更新分成两个语句或在本地循环执行更有效。

# svn - 如何使用 VBScript 访问 SVN

> ID：585640
> 
> 赞同：0
> 
> 时间：2009-02-25T11:29:27.503
> 
> 标签：svn, api, vbscript

我们在 SVN 中维护一些用 VBScript 编写的测试脚本，每天早上我们都会获取这些文件的最新副本并运行测试。我们目前正在手动执行此操作。但是，我们希望自动化整个操作。

我们如何使用 VBScript 访问 SVN 将最新的代码复制回测试机？是否有任何 API 可用于访问 SVN 并获取最新文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T11:42:51.153

只要 svn 在你的路径中......

```
Set objShell = WScript.CreateObject("WScript.shell")
objShell.exec ("cmd svn update C:\Projects\Project1 --username buildrobot --password IAmARobot1") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T11:32:44.327

您*可以*只调用系统，然后从 VBScript 运行 svn 命令行客户端。这似乎是最简单的解决方案，除非您对需要做的事情有一些额外的要求。

# eclipse - Eclipse 3.4.1 - 如何在构建项目时在控制台中查看编译器输出

> ID：585642
> 
> 赞同：27
> 
> 时间：2009-02-25T11:30:49.107
> 
> 标签：eclipse

我有一个看起来很烦人的问题。在 Eclipse 中编译项目时，我看不到显示 Java 编译器调用和构建结果的控制台（如在 NetBeans 中）。

例如，如果我将现有项目导入 Eclipse 并调用 Project->Build Project，是否有显示编译结果的视图？虽然我知道我的项目包含许多有错误的文件，但调用 Build Project 不会显示编译的视觉结果/进度。它不显示错误列表，以便我可以快速跳转到它们。

我知道有一个“问题”视图，它显示了所有项目中的问题列表（而不仅仅是编译器错误），而不是我正在使用的特定项目，这使得定位和跳转非常不方便问题的根源。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T13:03:13.673

您可以配置问题视图以仅显示当前项目中的问题：

1.  单击视图最右侧的小三角形。
2.  在弹出菜单中，选择“配置内容...”
3.  选择“配置”列表中的每个项目，然后单击“范围：在同一项目中的任何元素上”

如果你想看到编译器工作，你需要打开“进度”视图。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T12:23:06.703

由于 Eclipse JDT 提供了自己的内置 Java 编译器，因此您通常看不到 Java Compiler 的调用。

内置的 Java 编译器与 Eclipse 和 JDT 紧密集成，并提供了支持强大 IDE 功能（如重构和快速修复）的源索引。

另外，它允许在每次文件修改后在后台增量构建，因此没有可见的“ `java`”调用。

* * *

您可以使用自己的 javac` 调用替换/完成 java 编译器：

例如，**[在 Eclipse JDT 中使用 Alcatel-Lucent nmake](http://www.bell-labs.com/project/nmake/manual/eclipsejdt.html)**就可以做到这一点，并使用配置启动器（您可以指示它显示控制台）：

您需要在项目的“构建器”部分添加该特殊构建器。

![http://nmake.alcatel-lucent.com/manual/eclipse/jdt_lu38/builders.png](https://i.stack.imgur.com/xGzSf.png)

* * *

不要忘记您可以创建许多“问题视图”，并将其中一个设置为仅显示当前项目的问题。

![http://archive.eclipse.org/eclipse/downloads/drops/R-3.4-200806172000/whatsnew3.4/images/configure.png](https://i.stack.imgur.com/2cIAO.png)

选择：“在同一项目中的任何元素上”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T13:18:32.840

转到 Windows->显示视图->控制台或 Alt+Shift+Q,C

控制台出现在带有问题视图的选项卡中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T12:55:57.717

您的问题包含一些您可能需要重新考虑的假设。

> 它不显示错误列表，以便我可以快速跳转到它们。

编辑时会在编辑窗口中标记错误。您可以在现场修复它们，而无需“跳”到任何地方。

如果将整个源文件拖放到项目中，您可能不在该文件的编辑窗口中。（当然，这不是标准的 Eclipse 用法。）我知道的最简单的处理方法就是“刷新”项目并在 Package Explorer 视图中查看是否检测到任何错误（这将立即发生）如果您将文件“刷新”到源文件夹中）。双击任何显示错误图标的文件，然后查看编辑窗口的右侧以查看错误的确切位置。

> 我知道有一个“问题”视图，它显示了所有项目中的问题列表（而不仅仅是编译器错误），而不是我正在处理的特定项目......

除非您使用多个项目，并且具有项目间依赖关系，否则我发现关闭除我正在处理的当前项目之外的所有项目很有用。然后“问题”视图特定于当前上下文。

最后，我建议您查看[Mylin 的“入门”页面](http://www.eclipse.org/mylyn/start/)，了解有关 Eclipse 如何帮助您专注于当前任务的其他提示。

# sql - Calculating different tariff-periods for a call in SQL Server

> ID：585645
> 
> 赞同：2
> 
> 时间：2009-02-25T11:31:56.983
> 
> 标签：sql, sql-server, datetime, time, telephony

For a call-rating system, I'm trying to split a telephone call duration into sub-durations for different tariff-periods. The calls are stored in a SQL Server database and have a starttime and total duration. Rates are different for night (0000 - 0800), peak (0800 - 1900) and offpeak (1900-235959) periods.

For example: A call starts at 18:50:00 and has a duration of 1000 seconds. This would make the call end at 19:06:40, making it 10 minutes / 600 seconds in the peak-tariff and 400 seconds in the off-peak tariff.

Obviously, a call can wrap over an unlimited number of periods (we do not enforce a maximum call duration). A call lasting > 24 h can wrap all 3 periods, starting in peak, going through off-peak, night and back into peak tariff.

Currently, we are calculating the different tariff-periods using recursion in VB. We calculate how much of the call goes in the same tariff-period the call starts in, change the starttime and duration of the call accordingly and repeat this process till the full duration of the call has been reach (peakDuration + offpeakDuration + nightDuration == callDuration).

Regarding this issue, I have 2 questions:

*   Is it possible to do this **effectively** in a SQL Server statement? (I can think of subqueries or lots of coding in stored procedures, but that would not generate any performance improvement)

*   Will SQL Server be able to do such calculations in a way more resource-effective than the current VB scripts are doing it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T10:14:04.233

在我看来，这是一个有两个阶段的操作。

1.  确定电话的哪些部分在何时使用哪些费率。
2.  将每个费率的时间相加。

第 1 阶段比第 2 阶段更棘手。我在 IBM Informix Dynamic Server (IDS) 中处理过这个示例，因为我没有 MS SQL Server。这些想法应该很容易翻译。INTO TEMP 子句创建一个具有适当模式的临时表；该表对会话是私有的，并在会话结束时消失（或者您明确删除它）。在 IDS 中，您还可以使用显式 CREATE TEMP TABLE 语句，然后使用 INSERT INTO temp-table SELECT ... 作为执行与 INTO TEMP 相同工作的更详细的方法。

正如在关于 SO 的 SQL 问题中经常出现的那样，您没有向我们提供模式，因此每个人都必须发明一个可能与您描述的内容匹配或不匹配的模式。

假设您的数据在两个表中。第一个表有通话记录记录，通话的基本信息，如拨打电话的电话、拨打的号码、通话开始的时间和通话时长：

```
CREATE TABLE clr  -- call log record
(
    phone_id      VARCHAR(24) NOT NULL,   -- billing plan
    called_number VARCHAR(24) NOT NULL,   -- needed to validate call
    start_time    TIMESTAMP   NOT NULL,   -- date and time when call started
    duration      INTEGER     NOT NULL    -- duration of call in seconds
                  CHECK(duration > 0),
    PRIMARY KEY(phone_id, start_time)
    -- other complicated range-based constraints omitted!
    -- foreign keys omitted
    -- there would probably be an auto-generated number here too.
);
INSERT INTO clr(phone_id, called_number, start_time, duration)
    VALUES('650-656-3180', '650-794-3714', '2009-02-26 15:17:19', 186234); 
```

为方便起见（主要是为了节省多次写入加法），我想要一份带有实际结束时间的 clr 表的副本：

```
SELECT  phone_id, called_number, start_time AS call_start, duration,
        start_time + duration UNITS SECOND AS call_end
    FROM clr
    INTO TEMP clr_end; 
```

关税数据存储在一个简单的表中：

```
CREATE TABLE tariff
(
    tariff_code   CHAR(1)      NOT NULL   -- code for the tariff
                  CHECK(tariff_code IN ('P','N','O'))
                  PRIMARY KEY,
    rate_start    TIME         NOT NULL,  -- time when rate starts
    rate_end      TIME         NOT NULL,  -- time when rate ends
    rate_charged  DECIMAL(7,4) NOT NULL   -- rate charged (cents per second)
);
INSERT INTO tariff(tariff_code, rate_start, rate_end, rate_charged)
    VALUES('N', '00:00:00', '08:00:00', 0.9876);
INSERT INTO tariff(tariff_code, rate_start, rate_end, rate_charged)
    VALUES('P', '08:00:00', '19:00:00', 2.3456);
INSERT INTO tariff(tariff_code, rate_start, rate_end, rate_charged)
    VALUES('O', '19:00:00', '23:59:59', 1.2345); 
```

我争论关税表应该使用 TIME 还是 INTERVAL 值；在这种情况下，时间与相对于午夜的时间间隔非常相似，但时间间隔可以添加到时间不能添加的时间戳中。我坚持使用 TIME，但它让事情变得一团糟。

此查询的棘手部分是为每个关税生成相关的日期和时间范围，而无需循环。事实上，我最终使用了一个嵌入存储过程的循环来生成一个整数列表。（我还使用了一种特定于 IBM Informix Dynamic Server IDS 的技术，它使用系统目录中的表 ID 号作为 1..N 范围内的连续整数的源，它适用于版本中从 1 到 60 的数字11.50。）

```
CREATE PROCEDURE integers(lo INTEGER DEFAULT 0, hi INTEGER DEFAULT 0)
    RETURNING INT AS number;
    DEFINE i INTEGER;
    FOR i = lo TO hi STEP 1
        RETURN i WITH RESUME;
    END FOR;
END PROCEDURE; 
```

在简单的情况下（也是最常见的情况），通话属于单一关税期；多期电话增加了兴奋。

假设我们可以创建一个与此模式匹配并涵盖我们可能需要的所有时间戳值的表表达式：

```
CREATE TEMP TABLE tariff_date_time
(
     tariff_code   CHAR(1)      NOT NULL,
     rate_start    TIMESTAMP    NOT NULL,
     rate_end      TIMESTAMP    NOT NULL,
     rate_charged  DECIMAL(7,4) NOT NULL
); 
```

幸运的是，您没有提到周末费率，所以您向客户收取相同的费用

周末的价格与一周内的价格相同。但是，答案应该适应这样的

如果可能的话。如果您要变得像给出周末价格一样复杂

公共假期，圣诞节或新年除外，您收取高峰费率而不是

由于需求量大，周末费率，那么您最好将费率存储在永久关税日期时间表中。

填充关税_日期_时间的第一步是生成与呼叫相关的日期列表：

```
SELECT DISTINCT EXTEND(DATE(call_start) + number, YEAR TO SECOND) AS call_date
    FROM clr_end,
         TABLE(integers(0, (SELECT DATE(call_end) - DATE(call_start) FROM clr_end)))
         AS date_list(number)
    INTO TEMP call_dates; 
```

两个日期值之间的差异是整数天数（在 IDS 中）。过程*整数*生成从 0 到调用所涵盖的天数的值，并将结果存储在临时表中。对于多条记录的更一般情况，最好计算最小和最大日期并生成其间的日期，而不是多次生成日期然后使用 DISTINCT 子句消除它们。

现在使用费率表的笛卡尔积和 call_dates 表来生成每天的费率信息。这是关税时间间隔更整齐的地方。

```
SELECT  r.tariff_code,
        d.call_date + (r.rate_start - TIME '00:00:00') AS rate_start,
        d.call_date + (r.rate_end   - TIME '00:00:00') AS rate_end,
        r.rate_charged
    FROM call_dates AS d, tariff AS r
    INTO TEMP tariff_date_time; 
```

现在我们需要将通话记录与适用的资费相匹配。该条件是处理重叠的标准方法 - 如果第一个时间段的结束晚于第二个时间段的开始，并且如果第一个时间段的开始时间在第二个结束之前，则两个时间段重叠：

```
SELECT tdt.*, clr_end.*
FROM tariff_date_time tdt, clr_end
WHERE tdt.rate_end > clr_end.call_start
  AND tdt.rate_start < clr_end.call_end
INTO TEMP call_time_tariff; 
```

然后我们需要确定费率的开始和结束时间。费率的开始时间是资费开始时间和通话开始时间中较晚的时间。费率结束时间是资费结束时间和通话结束时间中较早的时间：

```
SELECT  phone_id, called_number, tariff_code, rate_charged,
        call_start, duration,
        CASE WHEN rate_start < call_start THEN call_start
        ELSE rate_start END AS rate_start,
        CASE WHEN rate_end >= call_end THEN call_end
        ELSE rate_end END AS rate_end
    FROM call_time_tariff
    INTO TEMP call_time_tariff_times; 
```

最后，我们需要将每个关税费率所花费的时间相加，并用该时间（以秒为单位）乘以所收取的费率。由于 SUM(rate_end - rate_start) 的结果是一个 INTERVAL，而不是一个数字，我不得不调用一个转换函数将 INTERVAL 转换为 DECIMAL 秒数，并且该（非标准）函数是 iv_seconds：

```
SELECT phone_id, called_number, tariff_code, rate_charged,
       call_start, duration,
       SUM(rate_end - rate_start) AS tariff_time,
       rate_charged * iv_seconds(SUM(rate_end - rate_start)) AS tariff_cost
   FROM call_time_tariff_times
   GROUP BY phone_id, called_number, tariff_code, rate_charged,
            call_start, duration; 
```

对于示例数据，这产生了数据（为了简洁起见，我没有打印电话号码和被叫号码）：

```
N   0.9876   2009-02-26 15:17:19   186234   0 16:00:00   56885.760000000
O   1.2345   2009-02-26 15:17:19   186234   0 10:01:11   44529.649500000
P   2.3456   2009-02-26 15:17:19   186234   1 01:42:41  217111.081600000 
```

这是一个非常昂贵的电话，但电信公司会很高兴的。您可以查看任何中间结果以查看答案是如何得出的。您可以以一些清晰为代价使用更少的临时表。

对于单个调用，这与在客户端中运行 VB 中的代码没有太大区别。对于很多呼叫，这有可能提高效率。我不相信在VB中递归是必要的——直接迭代就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T19:10:14.877

```
kar_vasile(id,vid,datein,timein,timeout,bikari,tozihat)
{
--- the bikari field is unemployment time  you can delete any where
select
            id,
            vid,
            datein,
            timein,
            timeout,
            bikari,
            hourwork =
            case when 
            timein <= timeout
            then
                SUM 
            (abs(DATEDIFF(mi, timein, timeout)) - bikari)/60 --
            calculate Hour 
        else
            SUM(abs(DATEDIFF(mi, timein, '23:59:00:00') + DATEDIFF(mi, '00:00:00', timeout) + 1) - bikari)/60 --
            calculate
            minute
                end
                ,
                minwork =
            case when 
            timein <= timeout
            then
                SUM 
            (abs(DATEDIFF(MI, timein, timeout)) - bikari)%60  --
            calclate Hour 
            starttime is later
            than endtime 
        else
            SUM(abs(DATEDIFF(mi, timein, '23:59:00:00') + DATEDIFF(mi, '00:00:00', timeout) + 1) - bikari)%60--
            calculate minute 
            starttime is later
            than
            endtime
                end, tozihat 

            from kar_vasile 
            group
            by id, vid, datein, timein, timeout, tozihat, bikari
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T13:10:20.520

前提是您的通话持续时间少于`100`几天：

```
WITH generate_range(item) AS
(
    SELECT  0
    UNION ALL
    SELECT  item + 1
    FROM    generate_range
    WHERE   item < 100
)
SELECT tday, id, span
FROM   (
       SELECT   tday, id,
                DATEDIFF(minute,
                    CASE WHEN tbegin < clbegin THEN clbegin ELSE tbegin END,
                    CASE WHEN tend < clend THEN tend ELSE clend END
                ) AS span
        FROM    (
                SELECT  DATEADD(day, item, DATEDIFF(day, 0, clbegin)) AS tday,
                        ti.id,
                        DATEADD(minute, rangestart, DATEADD(day, item, DATEDIFF(day, 0, clbegin))) AS tbegin,
                        DATEADD(minute, rangeend, DATEADD(day, item, DATEDIFF(day, 0, clbegin))) AS tend
                FROM    calls, generate_range, tariff ti
                WHERE   DATEADD(day, 1, DATEDIFF(day, 0, clend)) > DATEADD(day, item, DATEDIFF(day, 0, clbegin))
                ) t1
        ) t2
WHERE   span > 0 
```

我假设您将关税范围从午夜开始以分钟为单位，并以分钟为单位计算长度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-08T13:51:58.830

在数据库级别执行这种计算的一个大问题是，它会在运行时从数据库中占用资源，无论是在 CPU 方面，还是在通过锁定的行和表的可用性方面。如果您在批处理操作中计算 1,000,000 个关税，那么这可能会在数据库上运行很长时间，在此期间您将无法将数据库用于其他任何事情。

如果您有资源，可以通过一个事务检索您需要的所有数据，并使用您选择的语言在数据库之外进行所有逻辑计算。然后插入所有结果。数据库用于存储和检索数据，它们执行的任何业务逻辑都应始终保持在绝对最低限度。尽管在某些方面表现出色，但 SQL 并不是日期或字符串操作工作的最佳语言。

我怀疑您的 VBA 工作已经走在了正确的轨道上，而且在不了解更多信息的情况下，这对我来说肯定是一个递归的，或者至少是一个迭代的问题。正确完成递归可以成为解决问题的强大而优雅的解决方案。很少占用数据库的资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T11:53:41.890

在 T-SQL 中有效吗？我怀疑不是，使用目前描述的模式。

但是，如果您的费率表存储每个日期的三个关税，则可能是可能的。除了手头的问题之外，您可能会这样做至少有一个原因：在某个时间点，某个时期或另一个时期的汇率可能会发生变化，您可能需要获得历史汇率。

所以说我们有这些表：

```
CREATE TABLE rates (
    from_date_time DATETIME
,   to_date_time DATETIME
,   rate MONEY
)

CREATE TABLE calls (
    id INT
,   started DATETIME
,   ended DATETIME
) 
```

我认为需要考虑三种情况（可能更多，我正在编造这个）：

1.  呼叫完全发生在一个费率周期内
2.  通话在一个费率周期 (a) 开始，在下一个费率周期 (b) 结束
3.  一次通话至少跨越一个完整的费率期

假设速率是每秒，我认为您可能会产生类似以下（完全未经测试）的查询

```
SELECT id, DATEDIFF(ss, started, ended) * rate /* case 1 */
FROM rates JOIN calls ON started > from_date_time AND ended < to_date_time
UNION
SELECT id, DATEDIFF(ss, started, to_date_time) * rate /* case 2a and the start of case 3 */
FROM rates JOIN calls ON started > from_date_time AND ended > to_date_time
UNION
SELECT id, DATEDIFF(ss, from_date_time, ended) * rate /* case 2b and the last part of case 3 */
FROM rates JOIN calls ON started < from_date_time AND ended < to_date_time
UNION
SELECT id, DATEDIFF(ss, from_date_time, to_date_time) * rate /* case 3 for entire rate periods, should pick up all complete periods */
FROM rates JOIN calls ON started < from_date_time AND ended > to_date_time 
```

您可以在 SQL 中应用 SUM..GROUP BY 或在代码中处理它。或者，通过精心构建的逻辑，您可以将 UNIONed 部分合并到一个包含大量 AND 和 OR 的 WHERE 子句中。我认为 UNION 更清楚地表明了意图。

HTH & HIW（希望它有效...）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T12:00:51.170

[这是一个](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=110247)关于我们在 sqlteam.com 上遇到的问题的线程。看一看，因为它包含一些非常巧妙的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T12:11:45.950

继迈克伍德豪斯的回答之后，这*可能*对您有用：

```
SELECT id, SUM(DATEDIFF(ss, started, ended) * rate)
FROM rates 
JOIN calls ON 
     CASE WHEN started < from_date_time 
          THEN DATEADD(ss, 1, from_date_time) 
          ELSE started > from_date_time
   AND 
     CASE WHEN ended > to_date_time 
          THEN DATEADD(ss, -1, to_date_time) 
          ELSE ended END 
     < ended
GROUP BY id 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T12:30:07.607

数据库中相关表的实际架构会非常有帮助。我会采取我最好的猜测。我假设 Rates 表的 start_time 和 end_time 作为午夜过后的分钟数。

使用日历表（大多数数据库中非常有用的表）：

```
SELECT
     C.id,
     R.rate,
     SUM(DATEDIFF(ss,
          CASE
               WHEN C.start_time < R.rate_start_time THEN R.rate_start_time
               ELSE C.start_time
          END,
          CASE
               WHEN C.end_time > R.rate_end_time THEN R.rate_end_time
               ELSE C.end_time
          END)) AS 
FROM
     Calls C
INNER JOIN
     (
     SELECT
          DATEADD(mi, Rates.start_time, CAL.calendar_date) AS rate_start_time,
          DATEADD(mi, Rates.end_time, CAL.calendar_date) AS rate_end_time,
          Rates.rate
     FROM
          Calendar CAL
     INNER JOIN Rates ON
          1 = 1
     WHERE
          CAL.calendar_date >= DATEADD(dy, -1, C.start_time) AND
          CAL.calendar_date <= C.start_time
     ) AS R ON
          R.rate_start_time < C.end_time AND
          R.rate_end_time > C.start_time
GROUP BY
     C.id,
     R.rate 
```

我只是在打字时想出了这个，所以它未经测试，你很可能需要调整它，但希望你能看到大致的想法。

我也刚刚意识到您在通话中使用了 start_time 和持续时间。假设持续时间以秒为单位，您可以将 C.end_time 替换为 DATEADD(ss, C.start_time, C.duration) 。

假设适当的索引等，这应该在任何体面的 RDBMS 中执行得相当快。

# rhino-mocks - What is the Use of Repeat.Any() in Expect.Call while using Rhino Mocks Test framework

> ID：585649
> 
> 赞同：2
> 
> 时间：2009-02-25T11:34:38.443
> 
> 标签：rhino-mocks

When I use Repeat.Any() it doesn't show any error though I don't call GetMood() Method ,but if i don't use n doesn't call GetMood then it shows Excpetion of type ExpectationViolationException.Can somebody tell me what is the use of repeat.any().

```
MockRepository mocks = new MockRepository();

IAnimal animal = mocks.DynamicMock<IAnimal>();

using (mocks.Record())  
{                 
    //Expect.Call(animal.GetMood()).Return("punit");   
    Expect.Call(animal.GetMood()).Return("Punit").Repeat.Any();
}

//animal.GetMood();

mocks.ReplayAll();   
mocks.VerifyAll(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T11:47:54.777

Repeat.Any specifies that GetMood() can be called 0 or more times and that it should return "Punit" if it is called.

The line

```
Expect.Call(animal.GetMood()).Return("punit"); 
```

implies that GetMood must be called exactly once. This is the same as Repat.Once.

You may also use AtLeastOnce, Times, Twice, and Never.

# java - 如何与 JTable 进行一些交互

> ID：585650
> 
> 赞同：0
> 
> 时间：2009-02-25T11:34:43.527
> 
> 标签：java, swing

我有一个 JTable，其中数据模型包含来自 sql 查询的信息。想要通过双击 jtabel 中的一行来获得将我带到新 jpanel 的附加功能。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T11:52:33.220

您可以将 MouseListener 添加到 JTable，然后处理 mouseClicked 事件。

下面的代码显示了一个 mouseClicked 实现，它找出双击了哪一行。然后，您可以使用此信息导航到面板。

```
public void mouseClicked(MouseEvent event)
{
  if (event.getClickCount() == 2)
  {
    JTable source = (JTable)event.getSource();
    int rowIndex = source.rowAtPoint(event.getPoint());
    // get data from table model using row index
    // navigate to panel
  }
} 
```

# sql-server - SQL Server 2005 64bit query blocking

> ID：585651
> 
> 赞同：1
> 
> 时间：2009-02-25T11:35:16.630
> 
> 标签：sql-server, sql-server-2005, performance

We are experiencing some difficulties with SQL Server performance and wanted some help.

Our environment is: -

Windows 2003 Enterprise x64 Edition R2 Intel E5450 Quad Core 3ghz Processor 16GB RAM SQL Server 2005 64bit Enterprise Edition (9.00.3282.00) Database compatibility is 8 (but tested on 9 as well) Hyperthreading is switched off

We have one database with a 1.2 million row table which is being queried (inefficiently), but is resulting in all 4 processors being saturated to the point where all other queries are blocked until the query is finished. This includes queries to separate databases and totally unrelated tables.

If the query is run with option MAXDOP 1 then all 4 cores run at 25% with the query taking 4 times as long, there is no blocking in this instance. In addition to this, we have run the same query on SQL 2000 and the response time is the same, but no CPU saturation.

We have a suspicion that the problem may be around contention over tempdb. In this particular instance we have a stored proc using a temp table and also the parallel query accessing the temp db I assume.

Obviously the standard response will be to re-write the queries. Firstly, this is not really a viable option and secondly this is only treating a symptom of the problem. Essentially the server is unable to process multiple requests, which is of great concern.

Does anyone know of any patches, config changes or known problems that might be causing this? Has anyone seen this before? Is it a 64bit nuance?

Regards

Lee

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T08:28:43.030

听起来该表没有正确索引。具有 120 万行的表不应该进行任何查询。我有 60+ 百万行的表，我在几毫秒内查询该表。

查询是什么样的，表是什么样的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T14:47:27.993

听起来像锁定 tempdb 可以有效地阻止任何其他可能使用 tempdb 的东西运行，直到它完成。特别是 sysobjects 表可能被锁定。

理想的步骤是重新编写查询以停止它在整个持续时间内锁定 tempdb，但是，我猜这并不容易。

您可以尝试设置第二个 SQL 实例来运行此数据库。这样，任何临时锁定只会影响自身，而不影响服务器上的任何其他数据库。

要解决在同一数据库上运行的其他查询的问题，您可以查看临时数据库的多个文件。

但是，一旦您为解决方案走了这么远，您确实需要回到问题查询并尝试使其占用空间更小。正如 Kristen 评论的那样，简单地更改创建临时表的方式可能会对事物的锁定方式产生巨大影响。

# java - 在 Java 5 及更高版本中迭代 java.util.Map 的所有键/值对的最简单方法是什么？

> ID：585654
> 
> 赞同：36
> 
> 时间：2009-02-25T11:36:46.597
> 
> 标签：java, collections, foreach, java-5

在 Java 5 及更高版本中迭代 java.util.Map 的所有键/值对的最简单方法是什么？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-25T11:39:26.277

假设`K`是您的键类型并且`V`是您的值类型：

```
for (Map.Entry<K,V> entry : map.entrySet()) {
  K key = entry.getKey();
  V value = entry.getValue();
  // do stuff
} 
```

# architecture - 您如何看待“不要捕获意外异常”最佳实践？

> ID：585672
> 
> 赞同：7
> 
> 时间：2009-02-25T11:43:22.103
> 
> 标签：architecture, exception-handling

我读过很多次，永远不要盲目地捕获异常。有人说可以将您的 Main() 包装到一个 catch 块中以显示错误而不是仅仅退出（[例如，参见这个 SO 帖子](https://stackoverflow.com/questions/368184/does-it-make-sense-to-catch-exceptions-in-the-main)），但似乎有一个共识，即如果发生意外情况，您永远不应该让您的程序运行，因为它处于未知状态，并且可能会以意想不到的方式行事。

虽然我同意隐藏错误而不是修复它们绝对是一个错误的想法，但请考虑以下情况：

你有一个巨大的服务器。数百万行代码。

启动时，它将所有客户加载到其本地缓存中。

对我来说，写这个很有意义：

```
 foreach (string CustomerID in Customers)
                try
                {
                    LoadCustomer(CustomerID);
                }
                catch (Exception ex) // blind catch of all exceptions
                {
                    // log the exception, and investigate later.

                } 
```

如果没有盲点，无法加载单个客户只会导致所有服务器崩溃。

**我绝对更喜欢让我的服务器对一个客户产生一些未知的副作用，而不是让我的整个服务器停机。**

当然，如果我运行我的 catch 代码，我要做的第一件事就是修复代码中的错误。

有什么我在这里忽略的吗？是否有已知的最佳实践（除了“从不捕获意外异常”策略'？）

在 LoadCustomer() 方法中捕获异常，从那里重新抛出“CustomerLoadException”，并在调用代码中捕获 CustomerLoadException 而不是所有异常是否更好？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T12:10:19.980

这是一个**Robustness**的问题，即使在出现无法解释的错误时也能继续运行，与**Correctness**相比，宁愿完全失败也不愿产生不可靠的结果。

显然，例如，如果您正在研究生命支持系统，您不希望您的系统由于未知的错误情况而简单地关闭。即使您的状态没有明确定义，继续操作也可能比终止更好。

另一方面，如果您的程序是一个购物车，最好完全失败，而不是可能发送错误的物品，或向错误的人收取错误的金额。

介于两者之间的一切都是灰色区域，这是一个判断电话。总的来说，生命支持系统编程似乎比购物车编程更罕见，所以广泛的建议是人们做最常见的事情，即在发生意外错误时失败。据了解，如果您正在处理不合适的情况（例如您的服务器示例），您会更清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T11:52:06.513

“这里有什么我在俯瞰的吗？”

是的。

“是否有已知的最佳实践（除了‘永不捕获意外异常’策略'？）”

是的。封装。责任分配。[SOLID](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)原则。

在 LoadCustomer() 方法中捕获异常，从那里重新抛出“CustomerLoadException”，并在调用代码中捕获 CustomerLoadException 而不是所有异常是否更好？

是的。`loadCustomer`这封装了提供该方法的类定义中可能出错的所有内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T11:58:16.327

我认为这取决于情景，但通常我只捕获我希望通过日常使用应用程序发生的异常，并使用某种未经处理的异常报告/日志记录工具，例如 ASP.Net 的健康监控。但是，如果它是应用程序的关键部分，根本不能有未处理的异常，我会捕获所有异常并再次报告/记录它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T11:48:03.027

这是一个个案。如果您可以保证加载失败不会对其他客户产生任何影响，那么记录和跳过该特定客户似乎是合理的。不过，并非所有例外都以这种方式工作。特别是对于错误情况，例如[VirtualMachineError](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/VirtualMachineError.html)，通常情况下问题已经影响了整个程序的运行，您*应该*中止。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T11:50:41.883

> 我绝对更喜欢让我的服务器对一个客户产生一些未知的副作用，而不是让我的整个服务器停机。

你怎么知道导致 LoadCustomer() 中异常的错误没有破坏其他任何东西？总的来说，我认为我更喜欢“记录异常，将异常重新抛出到更高级别”，然后可能会退出。

不过，在这种特定情况下，我可能会主张两种处理方式，但总的来说，处理您没有明确处理方式的错误并不理想。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T11:50:42.163

我认为您缺少的是桌面应用程序的“最佳实践”不一定与服务器的“最佳实践”相同，服务器与网页的“最佳实践”不同。

如果网页抛出未处理的异常，您会认为“嗯”并点击刷新。如果桌面应用程序抛出一个，您可能会丢失一些数据并且非常恼火。如果服务器抛出一个，您的整个业务可能会停止，直到它被修复。

它还取决于打补丁的难易程度——如果您可以轻松地将补丁推送到所有安装（例如您自己的服务器或内部应用程序），最好不要捕获异常。如果您正在编写无法修补的东西（用于较旧控制台的游戏或嵌入式设备应用程序），那么您可能会更好地吞下异常。

当然，在所有情况下，最好让您的测试发现问题，以便您可以正确处理它，但我们都知道错误会发生......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-26T04:24:21.453

捕获您知道的异常是非常好的。您可能期望在您的示例中出现 NullObjectException。抓住这是完全合理的。

当您捕获通用异常时，您实际上是在说“我不知道出了什么问题，或者服务器是否着火了，*我不在乎*。” 虽然您的服务器可能会继续运行，但无法确定内部状态可能是什么，或者此异常是否会导致崩溃。

此外，通过此时捕获任意异常，如果稍后发生崩溃，您将离“真正”错误发生的位置更远——这将使查找错误变得更加困难。

同样，虽然不捕获通用异常可能会导致立即崩溃，但它更有可能在开发周期的早期被捕获，并且很容易修复（因为您将知道错误实际发生的位置）。

捕捉异常确实没有任何好处。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T11:50:33.070

为了解决真正会损害我的程序稳定性的异常，编写这种代码可能是个好主意：

```
 foreach (string CustomerID in Customers)
            try
            {
                LoadCustomer(CustomerID);
            }
            catch (Exception ex) // blind catch of all exceptions
            {
                if (ex is OutOfMemoryException || ex is StackOverflowException ||...)
                     throw;
                // log the exception, and investigate later.

            } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T11:50:46.330

我在这方面不是很有经验。但是，在我看来： 1\. 几乎所有规则都有一些例外。知道何时打破规则很重要。2\. 在异常处理的情况下，盲目地捕捉异常几乎从来都不是一个好主意。这是因为您可能会遇到一些非常意外的错误。

例如，在 Python（至少 2.5.2）中，盲目地捕捉可以让我捕捉到 ctrl+c 信号（Linux）。这意味着我不能在紧急情况下终止应用程序。

3.  对于您的网络服务器代码，您可能需要执行以下操作之一
    +如果客户无法加载并记录/更正该异常，则使用引发的自定义异常。
    +在更深层次的代码中使用异常处理并在那里处理。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T11:51:45.670

好吧，让我这样说吧.. 说神秘的客户加载失败是因为它不存在，比如说因为有人想出了如何破解您系统的前层。现在想象一下，黑客用不存在的力量做各种恶意的事情，直到他碰巧触发了一些试图从客户的未知值中读取的函数，现在系统无论如何都会崩溃，但黑客本来可以对无效客户进行各种干扰。

真的更好吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-25T12:10:27.187

当您知道哪些对象和资源可能会受到影响并丢弃所有这些对象时，您可以很好地捕获所有异常（虽然不是错误）。

因此，在您的情况下，您**可以**处理将整个过程转换为 noop 的异常。但是您必须确保： - 没有其他共享资源受到影响（例如，在异常之后可能会死的 Hibernate 会话） - 一个完整的（事务）操作被取消，不仅是它的一半。这意味着这样的异常处理可能只出现在特殊的地方，通常直接出现在用户界面的“下方”。示例：用户按下一个按钮，该按钮应该加载客户，更改其地址并再次保存。当其中任何一个出错时，您可能会捕捉到异常，阻止所有剩余步骤的发生，丢弃客户对象并显示一条消息：对不起，没用。

但是，如果您捕获异常（例如在修改地址期间）然后继续工作，则用户的东西他有一个在他控制下更改了地址的客户对象，而实际上他控制了一个地址被破坏的客户对象。不是一个好情况。

所以规则是：定义你控制事务的层。这应该是捕获异常的层。可能是 SwingActions，可能是线程，可能是 public void main，可能在你的示例中的循环内。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-25T12:24:54.000

我之前被一般的“异常”而不是个别类型所吸引。这意味着您丢失了一些关于实际问题的信息。您通常希望以不同的方式处理每种类型的异常。

此外，顶级异常处理仅应用于记录错误并重新启动您的应用程序。如果您不知道是什么类型的异常导致您的程序可能处于无效状态的错误，您可能是内存不足或其他原因。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-25T12:47:04.663

这取决于你站在哪里。如果您处于低级别，则可以预见大多数异常，并且您应该仅明确捕获那些异常，而其余部分则冒泡。当您到达 GUI 或顶级逻辑时，所有已知的异常都将被捕获，您最终只会遇到*意外*的异常。现在您有 2 个选项：

1.  悲观观点：表现异常，放弃。
2.  乐观的观点：你有信心你已经捕获了所有的critic异常，所以你吞下异常并继续（`ON ERROR RESUME NEXT`，有人吗？）

无论哪种方式，您都要记录异常并确保定期检查日志。

最后，这是一个“一切都取决于”的情况。更糟糕的是什么？继续使用不良数据或意外退出？它是一个关键系统吗？它的输出是否被另一个系统使用？等等等等

无论如何，所有关键异常*都应该*在应用程序的更深层次上被捕获。

如果通过日志发现未处理的异常，请更正代码、测试并重新部署。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-16T17:50:39.077

许多语言中异常层次结构的一个主要问题是异常是按类型或调用类组织的，而不是按严重性组织的。很多时候，当一个异常被抛出时，是因为一个方法在做任何事情之前就确定了它的先决条件没有得到满足。抛出异常的第一个例程的调用者可能在那时也可能没有做任何重要的事情。在许多情况下，调用者在调用例程之前所做的任何操作都只会作用于临时变量，当异常冒泡时这些临时变量就会消失。因此，在绝大多数情况下，当诸如 LoadDocument() 例程之类的东西抛出异常时，加载文档的尝试对仍然存在的任何内容的状态都没有影响。如果加载文档失败的尝试没有任何副作用，并且应用程序准备处理文档未加载的事实，那么应用程序没有理由不继续。困难在于知道是否可能有任何副作用。

现有异常处理系统中缺少的一个特性是 Exception 中的虚拟 IsResolved 属性。在处理“catch”块后，系统会检查 IsResolved 是否返回 false。如果它不为 null 并返回 true，则将调用 UnresolvedExceptionException，将先前的异常作为其 InnerException（UnresolvedExceptionException.IsResolved 将调用其 InnerException 的 IsResolved 方法）。

大多数 IsResolved 实现会测试返回布尔值的函数的委托列表是否为空；如果不是，则在任何列出的委托返回 True 时返回 true。如果异常暗示未处置的对象已损坏，则 IsResolved 方法可以返回该对象的处置标志。如果对象已被处置，则其损坏将不再相关。如果对象被包装在 Using 块中，则此类行为将导致异常渗透到对象被处理的位置，但不会进一步。

像 OutOfMemoryException 这样令人讨厌的异常只能通过显式调用 OutOfMemoryException.AcknowledgeOutOfMemoryCondition 之类的东西来使其 IsResolved 方法满意。许多其他抛出异常的例程都会让 IsResolved 方法立即返回 true（例如 Dictionary.GetValue 因为找不到键而抛出，然后就 Dictionary 而言，只要抛出异常就会解决异常） .

不幸的是，我不确定将这样的方案添加到 .net 等现有平台的效果如何。不过，如果将来有人开发类似的系统，它似乎是一个有用的功能。

# asp.net - ASP.NET - 获取 X 和 Y 之间的日期列表并将它们数据绑定到 DropDownList？

> ID：585678
> 
> 赞同：1
> 
> 时间：2009-02-25T11:46:54.903
> 
> 标签：asp.net, data-binding, datetime, drop-down-menu

我希望这是可能且容易的！正如标题所说，我想指定两个日期并通过指定开始和结束日期来获取日期数据集，然后能够将其绑定到我页面上的 DropDownList 控件。

如果不可能（这真是太可惜了），是否有人对此有建议或最佳实践，因为这种功能出现在许多网站上。

提前感谢您的帮助！皮特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T11:57:21.070

试试这个：

```
 DateTime start = new DateTime(2009, 1, 1);
        DateTime end = new DateTime(2009, 3, 1);
        var dates = Enumerable.Range(0, (end - start).Days).Select(x => start.AddDays(x)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T12:05:13.843

我认为这样做的一种简单方法是使用循环遍历日期范围并将每个日期添加到 DropDownList。就像是：

```
while(startDate.Date <= endDate.Date)
{
    myDropDownList.Items.Add(new ListItem(startDate.ToShortDateString()));
    startDate = startDate.AddDays(1);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T11:56:06.410

道歉！从那以后我发现我可以使用 DateTime 跨度.. 感谢访问 asp.net 论坛上的这篇文章：

[http://forums.asp.net/p/944596/1137162.aspx#1137162](http://forums.asp.net/p/944596/1137162.aspx#1137162)

# indexing - DB2 multiple column index issue

> ID：585679
> 
> 赞同：0
> 
> 时间：2009-02-25T11:47:25.137
> 
> 标签：indexing, db2

If I have a multiple column index(a,b,c) and one separate index d then my query is using b,a,c,d order whether both the index will be chosen? Whether index will be choosen or not for this query?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T12:04:07.513

在 DB2 命令行中，试试这个：

```
db2 => explain plan for ...insert-query-here... 
```

在结果中，您将看到何时使用索引以及何时 DB2 将使用全表扫描。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T12:06:49.347

如果将其更改为 a, b, c, d，则将使用 (a, b, c) 索引。
如果将其更改为 d、b、a、c（或以 d 开头的任何内容），则将选择 (d) 索引。
基本上，以与您要使用的索引相同的顺序使用列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T04:18:18.867

基于成本的优化器（例如 DB2 的）将使用表和索引对象的统计信息来确定 (A,B,C) 索引还是 (D) 索引更适合给定查询。索引基数（索引中唯一值的数量）是 RUNSTATS 命令收集的几个数据统计信息之一，可帮助优化器估计每个可能访问路径的相对 I/O 和 CPU 成本。Aaron Digulla 的回答中提到的解释命令以及 db2expln 工具可以帮助您了解将选择哪个索引。

# .net - 等效于字节数组的 Marshal.PtrToString* 方法

> ID：585683
> 
> 赞同：2
> 
> 时间：2009-02-25T11:48:31.950
> 
> 标签：.net, marshalling

如果我有一个非托管指针，并且我想将指定数量的字节从该位置传输到 Byte 数组，那么最好的方法是什么？

即什么是 Marshal.PtrToString* 方法的等价物，但目标是 Byte()

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T12:06:41.767

`Marshal.Copy`具有用于将字节数组复制到/从指针的重载。

这是与VB6`Byte()`风格的 COM 互操作吗？您为什么要使用 OLE-COM 查看器（包含在随 VS 安装的 Windows SDK 工具中）检查底层 COM 类型以打开 VB 创建的 dll 以查看其类型库所说的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T12:10:01.557

试试下面的代码

```
public static byte[] PtrToByteArray(IntPtr ptr, int len) {
  var array = new byte[len];
  for ( int i = 0; i < len; i++ ) { 
    array[i] = (byte)Marshal.PtrToStructure(ptr, typeof(byte));
    ptr = new IntPtr(ptr.ToInt64()+IntPtr.Size);
  }
} 
```

# php - 发送 ByteArray 到 Zend_Amf

> ID：585685
> 
> 赞同：0
> 
> 时间：2009-02-25T11:49:45.503
> 
> 标签：php, actionscript-3, zend-framework, bytearray, amf

我在将 ByteArray 发送到我的 Zend_Amf_server 时遇到问题。我从服务器收到一个 NetConnection.Bad.Call。如果我发送一个具有另一种数据类型的变量，那么 ByteArray 它工作正常。

我之前在 AMFPHP 中使用过相同的脚本，没有任何问题。但是对于这个项目，我真的需要它在 Zend_Amf 中工作。

AS3：

```
var path:String = "/images/picture.jpg";
var ba:ByteArray = jpgencoder.encode(bitmap.bitmapData);

var nc:NetConnection = new NetConnection();
nc.connect(zend_amf_server);

nc.call("Service.saveJPG", new Responder(responseHandler, errorHandler), path, ba); 
```

PHP：

```
class Service{
    public function saveJPG($path, $byteArray){
             return "worked";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:23:39.117

今晚我从 Zend AMF 得到了同样的错误，对以前在 AMF 中工作的代码做了基本相同的事情。这就是我所拥有的。我发现与您的代码唯一不同的是我只是将 ByteArray 传递给 Zend，并且我明确设置了 ObjectEncoding。

我一直在服务器上获得空的 jpg，因为我在其他地方读到了我需要做的 -> 数据以获取 ByteArray 数据。

AS3：

```
_service = new NetConnection();
_service.objectEncoding = ObjectEncoding.AMF3;
_responder = new Responder(this._onSuccess, this._onError);
_service.connect(zend_amf_server);

var myEncoder:JPGEncoder = new JPGEncoder( qualityValue );
var myCapStream:ByteArray = myEncoder.encode ( myBitmapSource ); // myBitmapSource is BitmapData drawn from a Sprite
this._service.call("Remote.savePhotoToServer", this._responder, myCapStream); 
```

PHP：

```
function savePhotoToServer ( $pInfos )
{       
    $bytearray = $pInfos;       
    $idimage = $this->nameImage(".jpg"); // calls a private func for a new name
    return ( $success = file_put_contents("./_photos/".$idimage, $bytearray) ) ? $idimage : $success;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T10:43:00.117

感谢大卫的回复，问题似乎是我向 Zend_Amf 发送了一个字节数组和一个字符串。如果我只发送 ByteArray 它工作正常并且图像被保存。

现在唯一的问题是保存图像的路径应该是可变的，我不能同时将它与 ByteArray 一起发送到我的 Amf_Server。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T08:35:52.443

好的，我发现了问题。我在最新的 'tag' 存储库 v. 1.7.5 中使用 Zend Framework 我将 AMF 的存储库切换到了 'trunk' 存储库，现在它可以工作了。向 Zend_Amf_Server 发送数组时存在错误。

# php - mysql 和 php : 数据提取

> ID：585697
> 
> 赞同：1
> 
> 时间：2009-02-25T11:54:21.610
> 
> 标签：php, mysql

我一直试图找出解决以下问题的方法。这很复杂。所以留在我身边。

我从`user`表中检索了一个字段，该字段具有他朋友的用户 ID，格式为 CSV (3,4,5,6,7)

还有另一个表叫做`transaction`它看起来像这样

```
tid    user1   user2   type_of_trade
1       3        4      barter
2       5        6      share
3       6        7      bargain 
4       4        3      barter
5       3        7      share 
```

现在我需要显示我朋友的交易。

所以我拆分了 CSV，将它们放入一个数组中，并为每个朋友运行查询

```
friends = explode(",","3,4,5,6,7");

for($i=0;$i<=count(friends);$i++)
{
// I execute this--SELECT * FROM transaction WHERE user1 = friends[$i] or user2 = friends[$i]
} 
```

现在同样的情况发生在 3、4、5、6 和 7

当查询执行时`4`，会出现相同的结果，因此我得到了重复。我什么都试过了。但我无法弄清楚这一点。

有人可以建议一个更好的解决方案还是可以对其本身进行修改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T11:58:19.367

在这种特殊情况下，不*要这样做* `explode`。

```
SELECT * FROM transaction WHERE user1 IN (3, 4, 5, 6, 7) OR user2 IN (3, 4, 5, 6, 7) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T11:59:02.597

您应该使用[mysql IN() 函数](http://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#function_in)。这将保证独特的结果。

```
SELECT * FROM transactions WHERE user1 IN (3,4,5,6,7) OR user2 IN (3,4,5,6,7); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T11:59:58.600

你可以做一个`IN`比较：

```
SELECT DISTINCT *
FROM transaction
WHERE user1 IN (3,4,5,6,7) OR user2 IN (3,4,5,6,7) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T12:07:40.407

如果您可以完全更改数据库设计，我建议您为您的用户朋友使用多对多关系。

这将允许您存储用户朋友列表，而无需解析 CSV。

在 PHP 和 mysql 中的实现在这里；[tonymarston.net](http://www.tonymarston.net/php-mysql/many-to-many.html)，只是谷歌的第一个结果：'mysql many to many'。

# linq - 从“LINQ to SQL”到“Azure 表存储”或“SQL 数据服务”

> ID：585717
> 
> 赞同：4
> 
> 时间：2009-02-25T12:03:00.090
> 
> 标签：linq, azure, cloud, azure-table-storage

我有一个 Silverlight 应用程序，我在其中使用 LINQ to SQL 来存储我的数据。现在我已将此应用程序添加到 Azure 云，并希望使用 Azure 方法来存储我的数据。但不知道该用“Azure 表存储”还是“SQL 数据服务”，怎么用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:50:26.007

您应该使用 SQL 数据服务。我想现在你知道了：

> 对于底层 Windows Azure 平台，我们添加了 FastCGI/PHP 支持，以及运行完全信任的 .NET 应用程序的能力；SQL 数据服务是关系型的，允许您在云产品中使用完整的 ADO.NET 堆栈、LINQ to SQL 等；

[通过 Tim Sneath mix09 发布](http://blogs.msdn.com/tims/archive/2009/03/18/mix09-day-1-keynote-pt-2-scott-guthrie-on-advancing-user-experiences.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T22:52:16.643

我没有给你一个好的答案，但我知道 Azure 表存储是用于非关系数据表的，这意味着如果你需要在表之间创建关系连接，这很可能不是要走的路.

至于 SQL 数据服务，有一个名为[PhluffyFotos](http://www.codeplex.com/phluffyfotos)的 CodePlex 项目，它有一个“LINQ to SDS 提供程序”，您可能想从中寻找灵感。

> PhluffyFotos 是一种网络 2.0 图片库服务，用户可以在其中从网络或移动设备上传他们的图片。此示例旨在演示如何使用 SQL Server Data Services (SSDS) 开发多租户应用程序。
> 
> 该演示使用了多种技术，包括：ASP.NET MVC Preview 4、LINQ、Windows Communication Foundation、Silverlight、Windows PowerShell 和 .NET Compact Framework 3.5。

# javascript - 引用全局变量时的奇怪行为。这是javascript中的错误吗？肯定不是！

> ID：585725
> 
> 赞同：2
> 
> 时间：2009-02-25T12:06:15.573
> 
> 标签：javascript, variables

考虑以下代码。

```
<html>
<body>
<script>  
var x = 5; //globally declared
function showX() 
{ 
      alert("x="+x); //trying to display global value

      var x=10; //trying to create and initialize a local x
}
</script>
<input type = "button" value="Show X" onclick="showX()"> 
</body>
</html> 
```

警报语句显示“x=undefined”。并且不会按预期打印 x 的全局值。等效的 java 代码将显示 5！那么，这是一个错误吗？如果不是，那么如何解释这种行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T12:14:44.617

[ECMAScript 规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)在第12.2 节中说：

> 如果变量语句出现在 FunctionDeclaration 中，则在该函数中使用函数局部范围定义变量，如 s10.1.3 中所述。否则，它们使用属性属性 { DontDelete} 在全局范围内定义（即，它们被创建为全局对象的成员，如 10.1.3 中所述）。进入执行范围时会创建变量。Block 没有定义新的执行范围。只有 Program 和 FunctionDeclaration 会产生新的作用域。变量在创建时初始化为未定义。具有 Initialiser 的变量在执行 VariableStatement 时分配其 AssignmentExpression 的值，而不是在创建变量时。

所以这不是错误 - 输入函数时会创建局部变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T12:11:38.010

第二个 var 声明干扰了第一个。您实际上指的是尚未声明的本地 x。但是，引用 javascript 大师 Douglas Crockford 的话：

> JavaScript 最大的问题是它对全局变量的依赖，尤其是隐含的全局变量。如果变量没有显式声明（通常使用 var 语句），则 JavaScript 假定该变量是全局变量。这可以掩盖拼写错误的名称和其他问题。

[http://www.jslint.com/lint.html](http://www.jslint.com/lint.html)

所以建议是尽量避免使用全局变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T12:10:46.797

的范围是声明它`x`的~~块~~函数......虽然我相信 JavaScript 中的范围有时可能有点棘手。在 C# 中，这将是一个编译时错误——它会在声明之前尝试使用局部变量。

不管是什么原因，为了可读性，我会尽量避免这样做。

# ruby - 是否可以使用 watir 在浏览器中导航回来？

> ID：585732
> 
> 赞同：2
> 
> 时间：2009-02-25T12:07:41.670
> 
> 标签：ruby, watir

我正在创建一个应该导航回几个步骤的自动化测试。在Watir可以这样做吗？

我正在导航到一个结果列表页面，并想通过单击返回（Windows 浏览器）返回到我的测试开始。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T16:48:35.490

如果您有一个 Watir::IE 对象，那么 #back 是一种可以满足您的需求的方法：

> [http://wtr.rubyforge.org/rdoc/classes/Watir/IE.html#M000245](http://wtr.rubyforge.org/rdoc/classes/Watir/IE.html#M000245)

你看到什么错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T12:12:26.137

这就是我尝试这样做的方式：

```
@site.ie.wait_until(1200) { |ie| ie.contains_text(/Sort after/) }
  2.times{@site.ie.back
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T16:58:43.110

使用 Watir 的 #back 调用的示例代码（基于[标准 Wikipedia 示例](https://secure.wikimedia.org/wikipedia/en/w/index.php?title=Watir&oldid=271482184#The_google_example)）：

```
 require 'watir'
 test_site = 'http://www.google.com/'
 ie = Watir::IE.new
 ie.goto(test_site)
 ie.text_field(:name, "q").set("pickaxe")
 ie.button(:name, "btnG").click

 if ie.text.include?("Programming Ruby")  
   puts "Test Passed. Found the test string: 'Programming Ruby'."
 else
   puts "Test Failed! Could not find: 'Programming Ruby'." 
 end

 ie.back

 if ie.url == test_site
   puts "Test Passed. Returned to search page."
 else
   puts "Test Failed! URL is now #{ie.url}."
 end

 ie.close 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-02T21:21:52.823

您当然可以使用 Watir执行**JavaScript 。**

```
@browser.execute_script('window.history.back();') 
```

# c# - 努力以编程方式添加用户控件

> ID：585733
> 
> 赞同：0
> 
> 时间：2009-02-25T12:07:50.373
> 
> 标签：c#, asp.net, user-controls

我遇到的问题与[Programmatically added User Control does not create its child controls](https://stackoverflow.com/questions/577353/programmatically-added-user-control-does-not-create-its-child-controls)中的问题相同。

阅读问题和答案后，我更改了我的代码，现在看起来像这样：

```
foreach (ITask task in tasks)
{
    TaskListItem taskListItem = LoadControl(
        typeof(TaskListItem),
        new object[] {task}
    ) as TaskListItem;

    taskListItem.TaskCompleteChanged += taskListItem_TaskCompleteChanged;                        

    taskListItemHolder.Controls.Add(taskListItem);
} 
```

但是，我仍然得到一个子控件尚未实例化的用户控件。

知道我做错了什么吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T12:20:20.673

您可能想改用它：

```
foreach (ITask task in tasks)
{
  TaskListItem taskListItem = LoadControl("~/TaskListItem.ascx") as TaskListItem;

  taskListItem.Task = task;
  taskListItem.TaskCompleteChanged +=
      taskListItem_TaskCompleteChanged;                        

  taskListItemHolder.Controls.Add(taskListItem);
} 
```

This is because TaskListItem is not the type of the real control, but the type of the control's code-behind class. Check [this page in MSDN](http://msdn.microsoft.com/en-us/library/ewtd66a0.aspx) (at the bottom, in the community content).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T12:13:47.193

确保您在 CreateChildControls 方法中添加控件（您可以覆盖它），另外，为控件提供一个 ID（每次添加时都需要相同）。

# c# - C# 语音识别

> ID：585745
> 
> 赞同：6
> 
> 时间：2009-02-25T12:11:55.873
> 
> 标签：c#, speech-recognition

这里有一篇关于那个的帖子......但它对我不起作用。我添加了一个我在互联网上找到的 system.speech.dll 但我不能使用 System.speech ，因为它没有出现。

错误 1 ​​找不到类型或命名空间名称“SpeechRecognizer”（您是否缺少 using 指令或程序集引用？）

错误 2 找不到类型或命名空间名称“SpeechRecognizedEventArgs”（您是否缺少 using 指令或程序集引用？）

我用过这段代码。我正在使用 Windows Vista 64

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using SpeechLib;
using System.Threading;

namespace WindowsFormsApplication13
{
    public partial class Form1 : Form
    {

        SpeechRecognizer rec = new SpeechRecognizer();

        public Form1()
        {
            InitializeComponent();
            rec.SpeechRecognized += rec_SpeechRecognized;
        }

        void rec_SpeechRecognized(object sender, SpeechRecognizedEventArgs e)
        {
            lblLetter.Text = e.Result.Text;
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            var c = new Choices();

            // Doens't work must use English words to add to Choices and
            // populate grammar.
            //
            //for (var i = 0; i <= 100; i++)
            //  c.Add(i.ToString());

            c.Add("one");
            c.Add("two");
            c.Add("three");
            c.Add("four");
            c.Add("Five");
            c.Add("six");
            c.Add("seven");
            c.Add("eight");
            c.Add("nine");
            c.Add("ten");

            // etc...

            var gb = new GrammarBuilder(c);
            var g = new Grammar(gb);
            rec.LoadGrammar(g);
            rec.Enabled = true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T12:15:41.493

1）您需要在项目中添加对 System.Speech 的引用

2）您不必在 Internet 上找到“System.Speech.dll”，它应该在 .Net 3 中（或 3.5，但无论如何都要获得 3.5，除非您有令人信服的理由不这样做）

编辑：

你可能想看这里：

[http://dotnet.org.za/beta/archive/2008/01/06/system-speech-recognition.aspx](http://dotnet.org.za/beta/archive/2008/01/06/system-speech-recognition.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T12:17:13.970

我同意詹姆斯·奥格登的观点。此外，您应该添加一个“使用”语句：

```
using System.Speech.Recognition 
```

或者，完全限定您的班级名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T17:09:53.217

Check that you have a language engine matching the language you have configured in Vista. See [http://support.microsoft.com/kb/934377](http://support.microsoft.com/kb/934377)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T09:23:18.797

虽然不直接适用于上述问题 - 值得注意的是，语音 SDK 不一定在每台客户端机器上都可用。虽然 Vista 包含语音识别器，但 XP 没有。纠正此问题的一种可能方法是让 XP 用户安装语音 SDK，其中包括一个。另一种是将Office 2003（不是2007）添加为依赖项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-18T11:58:13.107

我在 Windows XP 上遇到了 SpeechRecognizer 类的问题。有时它可以工作，但有时它不起作用，需要重新启动电脑。在 Windows 7 上它工作正常。我认为这是语音引擎本身的一些问题，因为当我多次运行我的应用程序时它停止工作。

我使用这段代码：

使用系统；使用 System.Collections.Generic；使用 System.ComponentModel；使用 System.Data；使用 System.Drawing；使用 System.Linq；使用 System.Text；使用 System.Windows.Forms；使用语音库；使用 System.Threading；

命名空间 WindowsFormsApplication13 { 公共部分类 Form1 : Form {

```
 SpeechRecognizer rec = new SpeechRecognizer();

    public Form1()
    {
        InitializeComponent();
        rec.SpeechRecognized += rec_SpeechRecognized;
    }

    void rec_SpeechRecognized(object sender, SpeechRecognizedEventArgs e)
    {
        lblLetter.Text = e.Result.Text;
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        var c = new Choices();

        c.Add("one");
        c.Add("two");
        c.Add("three");
        c.Add("four");
        c.Add("Five");
        c.Add("six");
        c.Add("seven");
        c.Add("eight");
        c.Add("nine");
        c.Add("ten");

        // etc...

        var gb = new GrammarBuilder(c);
        var g = new Grammar(gb);
        rec.LoadGrammar(g);
        rec.Enabled = true;
    }
} 
```

}

# sqlite - 如何在 Trac 中的某个日期创建带有关闭票证的报告

> ID：585752
> 
> 赞同：3
> 
> 时间：2009-02-25T12:14:56.550
> 
> 标签：sqlite, trac, ticket-system

我希望创建一个报告，列出在特定时间段内关闭的所有票证。

伪代码就像

```
SELECT * FROM tickets
WHERE closed AND date_closed = 'january 2009' 
```

我无法解决的部分是`date_closed = 'january 2009'`.

有没有办法在 Trac 中做到这一点？

我对特定的 SQL 语法不感兴趣，我可以自己编写时间限制。我不确定的是 Trac 的数据库结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T12:44:00.880

```
SELECT * FROM ticket
WHERE status='closed' 
  AND date(changetime,'unixepoch') 
      BETWEEN date('YYYY-MM-DD') /* <- here goes your start date */
          AND date('YYYY-MM-DD') /* <- here goes your end date */ 
```

如果你想要一个特定的月份：

```
SELECT * FROM ticket
WHERE status='closed' 
  AND date(changetime,'unixepoch') 
      BETWEEN date('2009-01-01','start of month') 
          AND date('2009-01-01','start of month','+1 month','-1 day') 
```

where`date('2009-01-01','start of month')`是按日期给出的月份的第一天，并且`date('2009-01-01','start of month','+1 month','-1 day')`是该月的最后一天。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T12:54:21.370

```
SELECT DISTINCT ticket.* FROM ticket, ticket_change
 WHERE ticket.id = ticket_change.ticket
   AND ticket_change.field = 'status'
   AND ticket_change.newvalue = 'closed'
   AND strftime('%m', ticket_change.time, 'unixepoch') = '01'; 
```

如果您也知道年份，最好使用 vartec 建议的表达式，而不是 strftime：

```
SELECT DISTINCT ticket.* FROM ticket, ticket_change
 WHERE ticket.id = ticket_change.ticket
   AND ticket_change.field = 'status'
   AND ticket_change.newvalue = 'closed'
   AND date(ticket_change.time,'unixepoch') 
       BETWEEN date('2009-01-01','start of month') 
           AND date('2009-01-01','start of month','+1 month','-1 day') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-04T03:35:56.543

另外，关于表结构，这里你去：

```
CREATE TABLE ticket_change ( 
    ticket   INTEGER,
    time     INTEGER,
    author   TEXT,
    field    TEXT,
    oldvalue TEXT,
    newvalue TEXT,
    UNIQUE ( ticket, time, field ) 
); 
```

# .net - 在为控件中的事件编写代码时，我应该强制转换对象还是显式引用它

> ID：585764
> 
> 赞同：2
> 
> 时间：2009-02-25T12:19:17.990
> 
> 标签：.net

如果我正在编写代码来处理来自表单上的控件的事件，如下所示：

```
 private void btnButton_Click(object sender, EventArgs e)
 {
        Button btn = (Button)sender;
        btn.Text = "Button pressed"
 } 
```

我是否应该始终将 sender 对象转换为正确的类型（就像我在上面所做的那样），还是明确引用控件名称更好，例如：

```
 private void btnButton_Click(object sender, EventArgs e)
 {
        btnButton.Text = "Button pressed"
 } 
```

这里的最佳做法是什么？不过我想我可能是担心太多了……

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T12:22:54.270

我更喜欢直接引用按钮（选项 2），因为更容易搜索引用按钮的位置和更改文本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T12:23:36.873

如果我将相同的方法绑定到多个控件，我个人会使用发件人，例如

```
 private void checkBox_Click(object sender, EventArgs e)
 {
    CheckBox box = (CheckBox)sender;
    myDataObject.SomeOption = box.Value;
 } 
```

我认为如果可以为了可维护性，最好直接引用控件。

请记住，动态创建的控件也需要使用 sender 方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T12:33:44.807

这真的取决于应用程序。在某些情况下（通常是简单的小形式），可以引用控件属性。在某些情况下（任何时候您以编程方式添加控件）绝对有必要使用强制转换方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T12:55:09.183

如果每个控件都有单独的事件处理程序 - 直接使用控件。

如果您有一个用于少数控件的事件处理程序 - 使用强制转换为`sender`.

换句话说，尽可能多地直接使用控制，恕我直言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T13:36:09.773

我会选择 #2 来处理单个控件的事件。为了可维护性，我没有命名处理多个控件的例程_。相反，我创建了一个单独的名称，表明它处理多个控件的事件，例如 MultiShapeButtons_Click 而不是 btnShapeButton1_Click

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T13:24:13.110

如果处理程序仅适用于特定控件，我将使用第一个选项。第二个选项适用于一般处理程序，例如处理页面上或某些控件中的所有 CheckBox（Rob 呈现它的方式）。

# c# - asp.net 3.5 我“得到”这个吗？

> ID：585765
> 
> 赞同：0
> 
> 时间：2009-02-25T12:19:40.923
> 
> 标签：c#, visual-studio-2008, webforms, asp.net-3.5

我正在使用 Visual Studio 2008 学习 ASP.NET 3.5 和 C#。我学到的大部分东西都是通过 MSDN 学习的。我正在尝试开发一个网页，该网页将允许用户创建用于 RPG 游戏的角色。用户应该能够分配属性、购买物品等。当用户完成后，站点将使用用户数据格式化一个可打印的字符表。

现在，我仍然围绕着这些东西，想知道我是否走在正确的轨道上——如果有人想看看我到目前为止所拥有的东西并发表评论，那就太棒了。我对我做错或效率低下的任何事情、糟糕的设计、糟糕的代码以及我可以改进的方法都感兴趣。但大多数情况下，我只想知道我是否走在正确的轨道上，而不是滥用这项技术。

以下是我到目前为止的代码。它允许用户将一定数量的点分配给 4 个统计数据。

主页：

```
<%@ Page Language="C#" 
    AutoEventWireup="true"  
    CodeFile="Default.aspx.cs" 
    Inherits="_Default" 
    enableSessionState="true"
%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <!-- MPCP/Bod/Evasion/Masking/Sensor -->

        <asp:Label ID="MPCP_Rating" runat="server" Text="" ></asp:Label>
        <br /> <br />
        <asp:Label ID="PersonaPool" runat="server" Text="" ></asp:Label>
        <br /> <br />

        <!-- TODO: Format into table -->
        Bod:
        <asp:TextBox ID="Bod" runat="server" ontextchanged="Bod_TextChanged" 
            width="25px">0</asp:TextBox> 
        <asp:Button ID="BodInc" runat="server" Text="+" 
            OnClick="Bod_Inc" />
        <asp:Button ID="BodDec" runat="server" Text="-"
            OnClick="Bod_Dec"/>
        <br /> <br />

        Evasion:
        <asp:TextBox ID="Evasion" runat="server" ontextchanged="Evasion_TextChanged"
            width="25px">0</asp:TextBox>
        <asp:Button ID="EvasionInc" runat="server" Text="+" 
            OnClick="Evasion_Inc" />
        <asp:Button ID="EvasionDec" runat="server" Text="-" 
            OnClick="Evasion_Dec" /> 
        <br /> <br />

        Masking:
        <asp:TextBox ID="Masking" runat="server" ontextchanged="Masking_TextChanged"
            width="25px">0</asp:TextBox>
        <asp:Button ID="MaskingInc" runat="server" Text="+" 
            OnClick="Masking_Inc" />
        <asp:Button ID="MaskingDec" runat="server" Text="-" 
            OnClick="Masking_Dec" /> 
        <br /> <br />

        Sensor:
        <asp:TextBox ID="Sensor" runat="server" ontextchanged="Sensor_TextChanged"
            width="25px">0</asp:TextBox>
        <asp:Button ID="SensorInc" runat="server" Text="+" 
            OnClick="Sensor_Inc" />
        <asp:Button ID="SensorDec" runat="server" Text="-" 
            OnClick="Sensor_Dec" /> 
        <br /> <br />
        <asp:Button ID="Submit" runat="server" Text="Submit" />

    </div>
    </form>
</body>
</html> 
```

代码隐藏：

```
using System;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;

public partial class _Default : System.Web.UI.Page
{
    private DeckData deck;

    public _Default()
    {
    }

    // Page events
    protected void Page_Load(object sender, EventArgs e)
    {
        deck = (DeckData)(System.Web.HttpContext.Current.Session["Deck"]);
        MPCP_Rating.Text = "MPCP Rating: " + deck.MPCP.ToString();
        UpdateAvailPersona();
    }

    protected void Unload(object sender, EventArgs e)
    {
    }

    // Helper functions
    protected void ChangeAttribute(DeckData.Attributes atr, bool inc)
    {
        if (inc == true) 
            deck.IncAttribute(atr); 
        else  
            deck.DecAttribute(atr); 

        UpdateAvailPersona();

        switch (atr)
        {
            case DeckData.Attributes.Bod:
                Bod.Text = deck.Bod.ToString();
                break;
            case DeckData.Attributes.Evasion:
                Evasion.Text = deck.Evasion.ToString();
                break;
            case DeckData.Attributes.Masking:
                Masking.Text = deck.Masking.ToString();
                break;
            case DeckData.Attributes.Sensor:
                Sensor.Text = deck.Sensor.ToString();
                break;
        }
    }

    protected void UpdateAvailPersona()
    {
        PersonaPool.Text = "Persona Pool: " + deck.PersonaMax.ToString() +
            " / " + (deck.CalculateAvailPersona()).ToString();
    }

    // Control Events 
    protected void Bod_Dec(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Bod, false);
    }

    protected void Bod_Inc(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Bod, true);
    }

    protected void Evasion_Dec(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Evasion, false);
    }

    protected void Evasion_Inc(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Evasion, true);
    }

    protected void Masking_Dec(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Masking, false);
    }

    protected void Masking_Inc(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Masking, true);
    }

    protected void Sensor_Dec(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Sensor, false);
    }

    protected void Sensor_Inc(object sender, EventArgs e)
    {
        ChangeAttribute(DeckData.Attributes.Sensor, true);
    } 
```

App-Data（只是 DeckData 类）

```
using System;
using System.Data;
using System.Configuration;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;

/// <summary>
/// Store deck related data and provide methods for adjusting deck data
/// </summary>
public class DeckData
{
    // Set persona multiplier, determines max persona pool
    private const uint _PersonaMultiplier = 3;

    public DeckData(uint MPCP)
    {
        _MPCP = MPCP;
        _Bod = _Evasion = _Masking = _Sensor = 0;

        CalculateMaxPersona();
    }

    // MPCP/Bod/Evasion/Masking/Sensor
    public enum Attributes
    {
        MPCP,
        Bod,
        Evasion,
        Masking,
        Sensor
    }

    private uint _MPCP;
    private uint _Bod;
    private uint _Evasion;
    private uint _Masking;
    private uint _Sensor;

    private uint _PersonaMax;

    /// <summary>
    /// Acessor/Modifiers
    /// </summary>
    public uint MPCP
    {
        get { return _MPCP; }
        set { _MPCP = value; }
    }

    public uint Bod
    {
        get { return _Bod; }
        set { _Bod = value; }
    }

    public uint Evasion
    {
        get { return _Evasion; }
        set { _Evasion = value; }
    }

    public uint Masking
    {
        get { return _Masking; }
        set { _Masking = value; }
    }

    public uint Sensor
    {
        get { return _Sensor; }
        set { _Sensor = value; }
    }

    public uint PersonaMax
    {
        get { return _PersonaMax; }
    }

    /// <summary>
    /// Calculate available persona. Must be called before changing attribs to ensure
    /// persona pool remains valid
    /// </summary>
    /// <returns></returns>
    public uint CalculateAvailPersona()
    {
        // Total deck attribs
        uint attrTotal = _Bod + _Evasion + _Masking + _Sensor;

        return _PersonaMax - attrTotal;
    }

    /// <summary>
    /// Recalculate max persona
    /// </summary>
    private uint CalculateMaxPersona()
    {
        _PersonaMax = _MPCP * _PersonaMultiplier;
        return _PersonaMax;
    }

    /// <summary>
    /// Increment attribute by 1 point 
    /// </summary>
    /// <param name="atr">
    /// The attribute to increment
    /// </param>
    /// <returns>
    /// false if no Persona available
    /// true if attribute successfully incremented
    /// </returns>
    public bool DecAttribute(DeckData.Attributes atr)
    {
        uint availPersona = CalculateAvailPersona();

        if (availPersona == _PersonaMax)
            return false;

        switch (atr)
        {
            case Attributes.MPCP:
                break;
            case Attributes.Bod:
                if (_Bod > 0)               // Check for underflow
                    _Bod -= 1;
                break;
            case Attributes.Evasion:
                if (_Evasion > 0)
                    _Evasion -= 1;
                break;
            case Attributes.Masking:
                if (_Masking > 0)
                    _Masking -= 1;
                break;
            case Attributes.Sensor:
                if (Sensor > 0)
                    _Sensor -= 1;
                break;
        }

        // Check to see if we updated an attribute using cached persona
        if(availPersona != CalculateAvailPersona())
            return true;
        return false;
    }

    public bool IncAttribute(DeckData.Attributes atr)
    {
        uint availPersona = CalculateAvailPersona();

        if (availPersona == 0)
            return false;

        switch (atr)
        {
            case Attributes.MPCP:
                break;
            case Attributes.Bod:
                _Bod += 1;
                break;
            case Attributes.Evasion:
                _Evasion += 1;
                break;
            case Attributes.Masking:
                _Masking += 1;
                break;
            case Attributes.Sensor:
                _Sensor += 1;
                break;
        }

        return true;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T12:29:33.817

如果你擅长 html，放弃 webforms 并使用像[asp.net mvc](http://www.asp.net/mvc/)或[fubu mvc](http://code.google.com/p/fubumvc/)这样的 mvc 框架。

如果你不擅长html，学习html，放弃webforms，使用mvc框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T12:33:55.053

我刚刚快速浏览了您的代码，其中一件事确实是跳跃式的，那就是使用您的 Web 应用程序所涉及的服务器回发数量。对属性的每次更改都会导致页面被提交回服务器，虽然技术上没问题，但不会带来很好的用户体验。

您可能想研究允许用户进行所有修改然后将它们一起提交的技术（例如在客户端使用 javascript 来维护属性点的分布），或者考虑使用 AJAX 异步回发对服务器的修改导致更流畅的用户体验。

编辑：使用您正在使用的模型，您可以使用 Button 控件 Command 事件而不是 Click 事件。这将允许您为可以在后面的代码中恢复的每个按钮分配一个 CommandName 和 CommandArgument 值。这将允许您为每个按钮只有一个事件方法，该方法可以决定要更改哪个属性以及如何更改这些属性：

```
<asp:Button ID="BodInc" runat="server" CommandArgument="Increase" 
        CommandName="Bod" oncommand="AttributeButton_Command" Text="+" />
<asp:Button ID="BodDec" runat="server" CommandArgument="Increase" 
        CommandName="Bod" oncommand="AttributeButton_Command" Text="-" /> 
```

后面的代码：

```
protected void AttributeButton_Command(object sender, CommandEventArgs e)
{
    string attriubuteName = e.CommandName;
    string action = e.CommandArgument;
    // Do stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T12:51:06.747

我提出的一个建议是考虑使用 javascript 来增加/减少标记中的计数器，然后使用表单提交时文本框的值对模型进行更新。正如@Andy 建议的那样，您也可以通过 AJAX 进行更新以减少可见的 UI 闪烁，但鉴于您拥有的简单规则，我认为在客户端执行此操作并回发一次是可行的方法。

除非您希望用户直接输入数值，否则我会选择静态显示所选数字并强制使用向上/向下按钮。你可以让它看起来像一个*组合锁*，如果当前选择的值的总和小于可用的数量，它只允许向上/向下选择。当然，您需要更新代码以验证没有超过最大值。禁止用户直接输入将省去验证是否只输入数值的麻烦。

```
Bod      + [0] =
Evasion  + [0] -
Masking  + [0] -
Sensor   + [0] -
Total       0
Maximum     ? 
```

您还想考虑使用 CSS 类进行样式设置，而不是直接在标记中指定宽度。使用 CSS 将帮助您在整个应用程序中保持一致的外观和感觉，**并**允许您稍后通过（大部分）更改您的 CSS 而不是您的应用程序代码本身快速轻松地更改外观和感觉。

# 3d - 游戏内角色模型推荐的 3D 模型类型，手动加载？

> ID：585769
> 
> 赞同：7
> 
> 时间：2009-02-25T12:20:42.840
> 
> 标签：3d, file-format, jogl, blender

我正在用 JOGL 编写游戏，需要代表游戏中的角色。我打算为角色的动作使用骨骼动画，当然角色会被蒙皮。我似乎无法为 JOGL 找到任何好的模型加载器，所以我计划根据规格或其他东西自己加载文件类型。我还计划使用 Blender 作为我的 3D 建模器，因此最好使用其中存在的某种类型。

你推荐我使用什么文件类型？。混合？.x, .3ds, .md2/3/5, ...?? 请记住，我想要具有明确定义格式的东西，这样我就可以编写加载程序而不必对某些随机文件格式进行反混淆，并且它需要支持上述功能。您可以提供的有关您选择它的原因以及为什么它最好的任何其他信息也将非常有帮助！

谢谢！

编辑：我将编写一个 Blender MS3D 导出​​器。当我完成后，我会在[这里](http://rickyc.org/ms3dexporter/)发布。

同时，请参阅下面我标记的答案；但从那以后发生了更多事情。我不会用我正在做的事情来更新它，但基本上我找到了 jMonkey Engine，它已经有一个 ms3d 导入器和其他我已经开始手写的子系统。尽管有场景图的东西（这就是我避免使用 Java3D 的原因），但我认为加入它是我最好的选择，所以这就是我要做的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T12:33:37.583

如果您可以只使用几何图形，或者准备处理自己的纹理，那么 .obj 可能是最直接且受广泛支持的 3D 文件格式。它基本上是 3D 建模的 ascii。

否则我会倾向于 vrml。它定义明确，至少有一些代码可以帮助您入门。我已经使用免费提供的代码成功地将 vrml 模型加载到 java3D 中。本机文件大小往往很大，但这可以通过使用压缩格式来解决。

我不会推荐 .3ds。我唯一一次处理这种格式的阅读器是在 Delphi Pascal 中，它很混乱，定义不明确，难以处理，并且往往有很多“变化”，尽管我设法让我的阅读器处理模型从3D-MAX 本身很好，它拒绝了许多声称是 3DS 格式但格式不正确的其他包中的模型。

补充：另外，我建议您看一下 Java3D API 和 O'Reilly 的《[Killer Game Programming in Java](http://fivedots.coe.psu.ac.th/~ad/jg/) 》一书，即使您不走 Java3D 路线，它也可能会回答您的很多问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T23:57:18.907

首先感谢另外两位答主。同样 basszero 你对混合文件是正确的，我应该先检查一下维基百科！这是一个几乎无用的 Blender 内存的二进制转储。

写完这个问题后不久，我决定继续写一个 OBJ 加载器，因为 1）它会给我加载 3D 文件格式的体验，以及 2）它看起来不错，常用的格式，但也很容易加载。这最终成为了一个伟大的决定，因为它让我意识到，我实际上并不知道对象和组之间的区别，而且我对材料也不太了解。它帮助我建立了这些 3D 结构的代码。

两个答案都推荐基于 XML 的格式。我不想要 XML 格式。我认为这不是 XML 的正确位置。我相信创建这些格式是因为 XML 灵活、通用且易于为其创建模式，但这不是我想要的。我想要一种可以快速加载的格式（相对而言，XML 不是），它不必是灵活的或人类可读的，并且我可以为它编写一个导入器，而不是依赖于 XML 库。basszero 甚至说，“以成为 XML 为代价”，他完全正确；这是我认为不值得承担的成本。

我的 OBJ 加载器完成了。我将它与实际的模型类分开，并使用 MeshFactory 接口实现它，以便将来我可以根据需要编写不同的加载器......这是计划。过去几天我一直在做更多的研究，并决定使用 ms3d 格式。

ms3d 格式支持骨骼绑定（关节）和关键帧骨骼动画，此外还支持纹理贴图和 alpha 贴图。此外，它是一种易于计算机读取的二进制格式，不会浪费空间（像 XML 和 OBJ 那样），带有人类可读的标签和标签等。

不幸的是，Blender 没有（工作的）ms3d 导出脚本，所以我将自己为它编写一个脚本。幸运的是，这不是一个困难的过程，您可以阅读 Blender 的文档并使用其他导出器作为示例。我将不得不复习我的 Python，但除此之外，从我在其他脚本中看到的情况来看，它似乎非常简单。

Java 方面的东西应该很简单，实际上它比 OBJ 格式更容易，因为 ms3d 更加结构化。我在网上找到了 ms3d 格式的[规范](https://web.archive.org/web/20120404020609/http://local.wasp.uwa.edu.au/~pbourke/dataformats/ms3d/ms3dspec.h)，采用 C 风格（天才！），所以它们非常不言自明，我对格式没有进一步的问题。我将根据这个规范来实现我的实现，尽管我以后可能会实现我自己的变体；这是编写自己的导入器和导出器的好处，我可以根据需要修改格式。

总而言之，我认为这是最好的解决方案。

和 basszero，你是绝对正确的，正如我从我的 OBJ 加载器中看到的那样：“一旦你把它全部读入，数据的组织（显示列表、纹理、顶点数组、顶点缓冲区等）和渲染是完全不同的野兽。”

Cruachan：我没有 Java3D，我坚持使用 JOGL。我确实拥有那本书（尽管目前无法访问）虽然我不记得他是如何加载模型的，但我很确定他使用了自动加载的 Java3D 格式加载器。不是我打算使用的东西......对不起！

-佝偻病

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T12:41:41.090

我相信 .blend 主要是来自搅拌机的内存结构的二进制转储，在搅拌机之外不会对您有太大帮助。使用 Blender 建模，但导出为不同的格式。

它可能有点冗长，但我听说 Collada 很好地封装了 3D 信息（以 XML 为代价）。好处是可能有一个属性模式定义，您可以通过 JAXB 传递它，从而生成一个完整的解析器，而无需您进行任何工作。

.md* 格式也可能是一个不错的选择。它们来自 iD 引擎（q1、q2、q3、q4、doom3），并且已记录在案。它们还包含动画序列。

一旦你把它全部读入，数据的组织（显示列表、纹理、顶点数组、顶点缓冲区等）和渲染是一个完全不同的野兽。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-24T17:11:25.147

有一个开源的 .blend 文件阅读器，可以从 .blend 文件中提取任何信息，包括网格、纹理、骨架和动画。

在此处查看使用 Ogre 和 Irrlicht 的一些示例：http: [//gamekit.googlecode.com](http://gamekit.googlecode.com)

# solaris - 如何将 OpenSolaris x86 引导到单用户模式？

> ID：585771
> 
> 赞同：4
> 
> 时间：2009-02-25T12:21:03.183
> 
> 标签：solaris, sysadmin, root, boot

现代 OpenSolaris 配置为在正常引导期间不允许 root 登录。只有在单用户模式下才有可能。然而，网上的许多指令只是简单地说在默认的 grub 引导参数的末尾添加“-s”，这使得图形引导进度显示处于无限循环中，并且永远不会进入单用户模式控制台。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T12:28:21.963

许多 OpenSolaris 单用户引导指令遗漏的关键点是您必须修改*文本引导*grub 条目，而不是默认的*图形*条目。使用单用户开关以图形模式启动会使启动进度图形永远覆盖在控制台顶部，永远不会让维护控制台可见。

*   重启。
*   在 grub 提示符下，突出显示最近的`text boot`条目并按“ `e`”。
*   `kernel$`突出显示以' '开头的行`e`。
*   将“ `-s`”添加到行尾。

例如改变：

```
kernel$ /platform/i86pc/kernel/$ISADIR/unix -Bv$ZFS-BOOTFS 
```

到

```
kernel$ /platform/i86pc/kernel/$ISADIR/unix -Bv$ZFS-BOOTFS -s 
```

*   按' `enter`'。
*   按' `b`'启动。

系统应该*在没有*图形覆盖的情况下启动，并且应该迅速到达系统维护控制台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T19:37:06.660

OpenIndiana 157的完整解决方案：

1.  重启
2.  在 grub 提示符下，突出显示最近的文本引导条目并按“e”。
3.  删除三行（将光标放在要删除的行上按 d）： splashimage /boot/solaris.xpm foreground d25f00 background 115d93
4.  将光标放在以 kernel$ 开头的行上按 e
5.  从此行中删除部分“,console=graphics”
6.  在此行末尾添加“-s”
7.  按“输入”。
8.  按“b”启动。

# ruby-on-rails - Rails 中最新和公认的 ajax 技术

> ID：585773
> 
> 赞同：2
> 
> 时间：2009-02-25T12:21:21.560
> 
> 标签：ruby-on-rails, ajax, frameworks

Rails Ajax 的现状如何？现在使用 Rails 时应该使用哪些框架和技术？Rails 似乎发展得如此之快，以至于人们可能无法跟上。是原型和 RJS 还是别的什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T12:30:29.697

RJS 的重点是您实际上不需要跟上框架，javascript 函数被抽象成 Ruby 供您使用。

也就是说，prototype 仍然是默认选择，但是有一些插件 ( [http://ennerchi.com/projects/jrails](http://ennerchi.com/projects/jrails) ) 可以在 jQuery 中实现 RJS 功能。当然，您可以完全放弃抽象，并随心所欲地编写 javascript。

就个人而言，我发现自己试图坚持 Rails 的默认方法，如果我需要一种超出 RJS 提供的方法，请确保我正确实施它（即不重复其他人所做的），并且通常会做它在原型中不必加载多个 javascript 框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T17:52:34.057

如前所述，Rails 的默认 javascript 库是（并且可能永远是）Prototype/Scriptaculous。然而，当 Rails 3.0 大约在 5 月初发布时，它应该更能接受其他库，例如 jQuery。

如果您不喜欢 RJS，您可以使用 .js.erb 扩展名并编写将通过 erb 模板引擎发送的 javascript。这是我现在最喜欢的做事方式。您可以在[Railscasts的](http://railscasts.com)[这一集中](http://railscasts.com/episodes/136-jquery)看到一个示例，以及 jQuery 。

# entity-framework - 在实体框架中对可为空的外键字段进行选择的方法是什么？

> ID：585774
> 
> 赞同：0
> 
> 时间：2009-02-25T12:21:49.967
> 
> 标签：entity-framework, linq-to-entities, nullable

我有一个类别表，它有一个可以为空的 parentId 字段的外键。在 Entity-Framework 中创建关系时，生成的实体没有任何关系字段。我的意思是，在我的示例中，当我在 Category 表中创建 parentId-Id 关系时，生成的 Category Entity 将具有一个 int 类型的 Id 属性和一个 Category 类型的 ParentCategory 属性，并且没有 ParentId 属性。这使我的查询更加困难。

所以，当我想选择一个类别的子类别时，我遇到了麻烦。我使用下面的方法；

```
public IEnumerable<ICategory> GetSubCategories(long? categoryId)
{
    var subCategories = this.Repository.Category.Where(c => c.ParentCategory.Id == categoryId)
                .ToList().Cast<ICategory>();

    return subCategories;
} 
```

但这不起作用，当我想选择根类别时。这样做的方法是什么？

顺便说一句，我想知道是否有一种方法可以生成像 Linq to Sql 这样的实体，具有 int 类型的 Id 属性、int 类型的 ParentId 和 Category 类型的 ParentCategory 属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:25:23.170

要选择根类别：

```
var rootCategories = this.Repository.Category.Where(c => c.ParentCategory == null).ToList().Cast<ICategory>(); 
```

概括代码以同时使用子和根类别：

```
var rootCategories = this.Repository.Category.Where(c => categoryId == null ? c.ParentCategory == null : c => c.ParentCategory.Id == categoryId).ToList().Cast<ICategory>(); 
```

# active-directory - 使用 C# 登录和注销 AD

> ID：585779
> 
> 赞同：0
> 
> 时间：2009-02-25T12:24:13.207
> 
> 标签：active-directory, login, logout

如何在不从当前用户注销的情况下使用 C# 登录到另一个 Active Directory 用户。; 1-获取新用户的访问权限 2- 做我的工作，然后以相同的方式使用 c# 注销。

例如，我是 blabla.com 域的用户。我已经登录了高级用户。但我需要管理员权限，所以我需要注销并将用户更改为管理员做我的工作并再次使用高级用户重新登录。我想做它与 C#。

我听说过类似模拟用户的内容，但我认为这不是我想要的。

已编辑：我想与另一个用户登录并获得该用户的权限，而无需从 c# 中的当前用户注销。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T14:33:05.050

你的问题不是很清楚。如果您要做的是查询/修改 AD，那么 t4zsan 的答案是正确的。

如果您只需要其他用户的组/安全权限，那么模拟就是要走的路。 [这篇文章会给你一个很好的基础](http://www.codeproject.com/KB/cs/zetaimpersonator.aspx)。

注意事项：您希望模拟的用户必须能够登录到您正在运行代码的机器。如果该域不受信任，则您不能模拟另一个域中的用户。显然，您也不能在另一台机器上冒充本地用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T12:29:43.647

使用 System.DirectoryServices 中的类连接到 AD 时，您可以选择指定用户凭据。例如，当使用 DirectoryEntry 时，有一个[构造函数重载](http://msdn.microsoft.com/en-us/library/wh2h7eed.aspx)，它采用用户名和密码，让您以不同的用户身份连接。

# vba - 分组状态的条件单元格内容

> ID：585785
> 
> 赞同：0
> 
> 时间：2009-02-25T12:26:30.907
> 
> 标签：vba, excel

如果一组特定的分组单元格是否隐藏，我希望单元格的值发生变化。是否有用于分组和取消分组单元格的工作表更改操作？我似乎无法用宏记录器生成一个；它似乎并不关心单元格在组中是隐藏还是未隐藏。然后，我可以用一个宏来更改相关单元格的值——我认为这比对单元格本身进行编码更容易。

语境：

有 5 行，其中 1 行是总数，另外 4 行是构成总数的帐户。在所有 5 行中都有一个带有标题的合并垂直单元格。我喜欢隐藏这 4 个帐户，但是当我这样做时，合并的标题单元格仅显示足以容纳一行，所以我希望它恢复为缩写（我会提供）。

这有点深奥和毫无意义，但有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T14:25:59.357

解决了。这篇文章提供了我需要的要点：

[http://www.ozgrid.com/forum/showthread.php?t=87457](http://www.ozgrid.com/forum/showthread.php?t=87457)

# c# - C# XML 语言文件

> ID：585787
> 
> 赞同：0
> 
> 时间：2009-02-25T12:28:20.747
> 
> 标签：c#, xml

我想让我的 ASP C# 应用程序成为多语言。我计划使用 XML 文件来执行此操作。问题是，我没有这方面的经验。我的意思是，我该怎么开始？将语言存储在 xml 文件中是个好主意吗？以及如何在代码中设置菜单按钮的值？我想使用 XML，因为我以前从未使用过 XML，我想学习如何处理这样的情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T12:42:27.670

您想查看 RESX 资源文件。这些是可以包含文本（和图像）的 XML 文件，并且它们具有标准化的本地化/翻译处理。

对此的支持直接内置在 ASP.NET 中。有一个关于如何使用和设置的指南：http: [//msdn.microsoft.com/en-us/library/fw69ke6f](http://msdn.microsoft.com/en-us/library/fw69ke6f(VS.80).aspx) (VS.80).aspx 。

该演练非常详细，应该可以帮助您理解这些概念。我的首选方法是在“使用 ASP.NET 进行显式本地化”部分的文档中稍稍描述的方法。使用它，您将获得一组 XML 文件，其中包含完全标准化格式的文本和翻译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T12:35:06.347

您知道 .Net From 自动翻译（基于 .resx）资源吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T12:48:07.877

你很幸运，这种东西直接内置在.Net中

它的完成方式是，对于每个页面，您都有一个特定于语言的 resx 文件。

例如

Homepage.aspx Homepage.aspx.cs Homepage.aspx.en.resx Homepage.aspx.fr.resx

您只需动态地确定要使用的资源文件，例如所有适当的标签都以法语出现。

[有用的教程和视频](http://wiki.asp.net/page.aspx/55/internationalization/)

[一个简单的例子](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/localization/localization.aspx#simpleexample)

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T13:54:20.383

如果.net 中的国际化是您想要认真对待的事情，您可能需要考虑[这一点](https://rads.stackoverflow.com/amzn/click/com/0321341384) （不，我与它无关）

# .net - 在缓存之外生成原生图像

> ID：585792
> 
> 赞同：4
> 
> 时间：2009-02-25T12:29:56.717
> 
> 标签：.net, gac, ngen

在我创建我的安装程序之前，我想使用`NGEN.EXE`它来生成我的程序集的本机图像。我希望这将使我的二进制文件保持不变[`Reflector`](http://www.red-gate.com/products/reflector/)。我对此是否正确？

我刚刚了解到所有本机图像现在都存储在本机图像缓存中。有没有办法获得本机二进制文件，然后我可以用安装程序打包？另一方面，是否可以在生成本机图像后摆脱原始程序集？

**编辑：**我正在使用一个应用程序，它在与服务器交谈时使用硬编码密钥进行加密。使用 .NET，人们很容易就能拿到钥匙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T12:45:38.147

我可以看到你试图实现的几个问题。

1）正如@Mehrdad 所提到的，即使存在本机图像，元数据仍然需要程序集。
2) 本机映像仅在编译它的机器上有效。JIT 编译器执行通常无法完成的优化，因为它确切地知道代码需要在什么硬件上运行。
3) 即使是原生镜像也可以反编译。使用托管 dll 会稍微容易一些。

你介意告诉我们你为什么要隐藏你的源代码吗？

编辑：从每个新版本的 WGA 被黑客入侵的速度来看，我怀疑，如果您的软件远程有用，那么在您的软件的每个新版本发布后的几个小时内，有人会在互联网上（或 p2p 或其他任何东西）获得密钥，他们将是非常乐意拆解原生镜像的人。或者也许只是阅读机器代码:)
我个人的做法是确保您的应用程序运行良好且价格合理。诚实的人不会偷，不诚实的人不管你做什么都会想办法。最终，如果他们要运行您的应用程序，则您无法完全控制他们对它的操作，尽管您可以通过首先使用混淆器使他们使用反射器稍微困难一些，但最终它就像现实生活一样真的，锁只会把诚实的人拒之门外。

当然，如果您可以将应用程序功能的某些重要部分从客户端移到 Web 服务中，那么您就有更多的机会。您可以为客户端创建具有用户名和密码的帐户，应用程序在运行时请求此帐户并使用它对 Web 服务进行身份验证。如果他们对该应用程序的使用已过期，则 Web 服务将拒绝他们的请求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T12:36:15.610

NGEN 和 .net 框架非常不支持这一点，但有 3rd 方工具可以做到这一点，谷歌搜索“.net 链接器”。

我建议不要这样做，MS 有正当理由不支持这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T12:36:58.590

您不能只发送程序集的 ngen 映像。运行时仍然需要实际的程序集存在，即使它具有它的本机映像。原因是程序集元数据未传递到本机映像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-14T11:40:50.233

获取此软件列表：

*   {智能组装}
*   DeployLX CodeVeil
*   Dotfuscator .NET Obfuscator
*   Salamander .NET Obfuscator
*   Semantic Designs: C# Source Code Obfuscator
*   Spices.Net
*   Thinstall
*   Demeanor for .NET
*   .NET Reactor
*   IntelliLock
*   Eazfuscator.NET
*   SecureTeam CliSecure

These are obfuscators+linkers.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T04:39:11.077

没有理由应该使用本机图像。该工具是为开发而设计的，以加快速度。它不是一个应用程序，它是一个图像，所以改变计算机 CPU，点网配置会使你的图像无效，所以它不是真的可用。破解你的软件是可能的，任何软件都被破解了，还有没有的？不要在意盗版，假设它存在:)

# asp.net - 解决按条款限制分组的方法

> ID：585798
> 
> 赞同：0
> 
> 时间：2009-02-25T12:31:52.097
> 
> 标签：asp.net, sql, sql-server, aggregate

我正在开发一个社交网络 Web 应用程序，我遇到了需要向尚未激活电子邮件的用户重新发送提醒电子邮件的情况。

问题是当我调查数据库时，我发现许多电子邮件是重复的（显然没有对电子邮件唯一性进行验证。所以我需要知道的是从数据库中检索这些字段的用户名、电子邮件激活码、电子邮件、这样我就可以重新发送激活电子邮件，对于重复的电子邮件，我只需要返回其中一个（即，如果我的用户 john 的电子邮件为 john@hotmail.com 和用户 john1 的电子邮件为 john@hotmail.com ，我只想检索这些 johns 中的一个，无论 john1 还是两个），所以我想通过（Group By Email）跟踪 SQL 查询。

问题是我无法选择不在 group by 子句中的其他字段。我在这里的解决方案是我不喜欢的；我创建了一个列表，每次需要向用户发送电子邮件时，我都会遍历整个列表以确保该电子邮件不存在，如果不存在，我发送给它，然后将电子邮件添加到列表。
类似于以下内容：

```
if(!EmailIsInList(email)){ 
  SendActivationEmail(email);
  AddEmailToList(email)
}
else { DoNotSend); } 
```

实际上，我以这种方式解决了问题，但我仍然不喜欢我的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:56:32.830

收入测试数据：

```
DECLARE @User TABLE (UserId int, 
UserName varchar(100), Email varchar(40), IsActivated bit)
INSERT INTO @User
SELECT 1, 'John', 'john@hotmail.com', 0 UNION
SELECT 2, 'Ann', 'ann@hotmail.com', 0 UNION
SELECT 3, 'John2', 'john@hotmail.com', 1 UNION
SELECT 4, 'Bill', 'bill@hotmail.com', 0 UNION
SELECT 5, 'Bill', 'john@hotmail.com', 0

DECLARE @Email TABLE (EmailId int, 
UserId int, Date datetime, Message varchar(1000))
INSERT INTO @Email
SELECT 1, 1, GETDATE(), '' UNION
SELECT 2, 2, GETDATE(), '' UNION
SELECT 3, 3, GETDATE(), '' UNION
SELECT 4, 4, GETDATE(), '' UNION
SELECT 5, 5, GETDATE(), ''

SELECT * FROM @User
SELECT * FROM @Email 
```

你看，我们已经激活了一次 john@hotmail.com，所以我们不需要他在结果集中。
现在，使用 RANK OVER 实现：

```
SELECT M.UserID, M.UserName, M.Email, 
    M.IsActivated, M.EmailId, M.Date, M.Message 
FROM (
    SELECT RANK() OVER (PARTITION BY U.Email 
        ORDER BY U.IsActivated Desc, U.UserID ASC) AS N, 
        U.UserID, U.UserName, U.Email, U.IsActivated, 
        E.EmailId, E.Date, E.Message
    FROM @User U INNER JOIN @Email E ON U.UserID = E.UserID
)M WHERE M.N = 1 AND M.IsActivated = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T12:53:04.417

如果我们假设同一个电子邮件地址既可以针对 usera 激​​活，也可以针对 userb 不激活，那么以下查询将为您返回一个从未激活过的电子邮件地址的用户 ID

```
SELECT  MAX(userid),
        email
FROM    users AS u1
WHERE   activated = 'False'
AND NOT EXISTS (
        SELECT 1
        FROM   users AS u2
        WHERE  u2.email = u1.email
        AND    u2.activated = 'True'
        )

GROUP BY email 
```

您确实希望确保对电子邮件字段进行索引，并且如果使用 (email, userid) 的唯一复合键对其进行索引，那么这将是索引扫描，并且应该非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T14:45:45.347

我认为你犯了一个重大的逻辑错误。电子邮件地址不是，也永远不会是唯一的。仅仅因为两个用户拥有相同的电子邮件地址并不意味着他们是同一个人！人们经常共享电子邮件，夫妻可能拥有相同的电子邮件，小型办公室有时只有一封电子邮件（这通常适用于医生办公室。）如果有人放弃，电子邮件也会被重复使用。因此，2007 年在 jsmith@hotmail.com 注册的 John Smith 在您的系统中可能还没有处于活动状态，因此当他访问 jsmith@gmail.com 时也没有费心去更改他的电子邮件。与此同时，Judy Smith 在不同的州注册 jsmith@hotmail.com。您不能假设电子邮件地址永远是唯一的。

# qt - 为什么 Qt 需要在堆中分配子对象？

> ID：585801
> 
> 赞同：6
> 
> 时间：2009-02-25T12:32:34.543
> 
> 标签：qt

```
class MyWidget : public QWidget { public:
    MyWidget( QWidget *parent=0, const char *name=0 ); };

MyWidget::MyWidget( QWidget *parent, const char *name )
        : QWidget( parent, name ) {
    QPushButton *quit = new QPushButton( "Quit", this, "quit" );
    quit->setGeometry( 62, 40, 75, 30 );
    quit->setFont( QFont( "Times", 18, QFont::Bold ) ); 
} 
```

上面的代码`quit`是在堆中分配的，这是必要的，因为它是 MyWidget 的子级

为什么 Qt 需要在堆中分配子对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-28T19:47:15.080

在您的示例中，退出不必进行堆分配。

此代码编译并执行良好：

```
struct MyWidget : QWidget 
{
    QPushButton quit;

    MyWidget()
    {
        quit.setGeometry( 62, 40, 75, 30 );
        quit.setFont( QFont( "Times", 18, QFont::Bold ) );
    }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T23:11:06.520

如果我正确理解您的要求，我认为这主要归结为传统和示例，并带有一点标头依赖性。

当然，另一种方法是声明`quit`为 的成员变量`MyWidget`。如果你这样做，那么你需要在声明的`QPushButton`地方包含头文件`MyWidget`，而不是在实现文件中。您给出的示例还依赖`QObject`s 的父关系来跟踪按钮的内存，并在销毁时将其删除，因此不需要将其指定为类中的成员。

我敢肯定，如果您真的愿意，您可以更改为堆栈分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T12:40:13.480

我认为这里的想法是 Qt 对大多数对象都有自己的内部引用计数，如果你传递它们，使用写时复制等。

你的问题能更具体一点吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-25T13:15:05.893

还有哪些其他选择？从堆栈中？Qt 如何知道何时从堆栈分配以及何时从堆分配？一旦当前函数返回，从堆栈分配的东西就会消失，因此对象的生命周期可能比使用时间短得多。想象一下向树中添加一个节点。该节点将在当前函数返回后很长时间内使用。这将导致访问随机内存、分段错误、核心转储等。

# java - 如何从 Eclipse 插件中获取包资源管理器中的选定节点

> ID：585802
> 
> 赞同：18
> 
> 时间：2009-02-25T12:32:47.680
> 
> 标签：java, eclipse, user-interface, eclipse-rcp, rcp

我正在编写一个 Eclipse 命令插件，并希望在包资源管理器视图中检索当前选定的节点。我希望能够从返回的结果中获取所选节点驻留在文件系统上的绝对文件路径（即 c:\eclipse\test.html）。

我该怎么做呢 ？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-25T13:34:34.473

第一步是获得选择服务，例如从任何视图或编辑器，如下所示：

```
ISelectionService service = getSite().getWorkbenchWindow()
            .getSelectionService(); 
```

或者，[正如 VonC 所写](https://stackoverflow.com/questions/585802/how-to-get-the-selected-node-in-the-package-explorer-from-an-eclipse-plugin/585883#585883)，如果您既不在视图中也不在编辑器中，您可以通过 PlatformUI 获得它。

然后，获取 Package Explorer 的选择并将其转换为 IStructuredSelection：

```
IStructuredSelection structured = (IStructuredSelection) service
            .getSelection("org.eclipse.jdt.ui.PackageExplorer"); 
```

从中，您可以获得您选择的 IFile：

```
IFile file = (IFile) structured.getFirstElement(); 
```

现在要获取完整路径，您必须获取 IFile 的位置：

```
IPath path = file.getLocation(); 
```

然后，您最终可以使用它来获取文件的真实完整路径（除其他外）：

```
System.out.println(path.toPortableString()); 
```

您可以在此处找到有关选择服务的更多信息：[使用选择服务](http://www.eclipse.org/articles/Article-WorkbenchSelections/article.html)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-25T12:54:32.620

代码如下：

```
IWorkbenchWindow window =
    PlatformUI.getWorkbench().getActiveWorkbenchWindow();
ISelection selection = window.getSelectionService().getSelection("org.eclipse.jdt.ui.PackageExplorer"); 
```

[**您可以在类似LuaFileWizardAction 类**](http://svn.assembla.com/svn/Seq/luaeclipse/org.keplerproject.ldt.ui/src/org/keplerproject/ldt/ui/actions/LuaFileWizardAction.java)的 Action 中查看示例。

# java - 访问 Windows 注册表

> ID：585804
> 
> 赞同：7
> 
> 时间：2009-02-25T12:33:12.310
> 
> 标签：java, registry

> **可能重复：**
> [使用 Java 读取/写入 Windows 注册表](https://stackoverflow.com/questions/62289/read-write-to-windows-registry-using-java)

我需要从 Java 访问 Windows 注册表。我还需要复制一些注册表项，并且可能必须使用 Java 输入新的注册表变量。请有人帮助我...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T12:41:05.163

我推荐[Java Native Access (JNA) library](https://github.com/twall/jna/)。它是 JNI 的一个非常好的包装器。根据[这个邮件列表帖子](http://markmail.org/message/nfqaah4awazkgce6)，他们已经为本地 Windows 注册表函数调用提供了一个贡献的包装器。

如果您将 JNA 库添加到您的项目中，[您需要的相关源是 Registry.java 类](https://github.com/twall/jna/source/browse/jna/trunk/jnalib/contrib/ntservice/src/jnacontrib/win32/Registry.java?view=markup)。从那里，只需调用该类的方法来调查 Windows 注册表。

作为旁注，请确保在使用 JNA 时使用 Platform.isXxx() 以确保您的代码实际上可以查询特定平台上的注册表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T12:53:47.830

一个例子是这样的：

```
import com.ice.jni.registry.*;

public class DeleteEnvironmentVar{
public DeleteEnvironmentVar(String variable, String value) throws Exception {

        RegistryKey machine = Registry.getTopLevelKey("HKEY_LOCAL_MACHINE");
        RegistryKey environment = machine.openSubKey("SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment", RegistryKey.ACCESS_WRITE);
        try {
            if ( value == null ) { //Delete the variable in case value is empty
                environment.deleteValue(variable);
            }            
        }
        catch( NoSuchValueException nsve ) {}
        catch( NoSuchKeyException nske ) {}        
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T13:28:12.600

[Preferences](http://java.sun.com/javase/6/docs/api/java/util/prefs/Preferences.html)类是 Java 写入注册表的首选方式。但是，我实际上并没有使用过它，所以我不知道它是否允许访问整个注册表或仅允许访问特定于 JVM 或您的应用程序的部分。如果没有，那么听起来您需要查看其他人在此处提出的 JNI 解决方案。如果它确实有效，那么如果你移植它，你就有一种与平台无关的方法来存储你的设置。

# c# - 在 C# 中使用具有默认命名空间的 Xpath

> ID：585812
> 
> 赞同：64
> 
> 时间：2009-02-25T12:34:57.783
> 
> 标签：c#, xml, xpath, namespaces, xpathnavigator

我有一个带有默认命名空间的 XML 文档。我正在使用 XPathNavigator 使用 Xpath 选择一组节点，如下所示：

```
XmlElement myXML = ...;  
XPathNavigator navigator = myXML.CreateNavigator();
XPathNodeIterator result = navigator.Select("/outerelement/innerelement"); 
```

我没有得到任何结果：我假设这是因为我没有指定命名空间。如何在我的选择中包含命名空间？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-02-25T12:40:05.540

首先 - 你不需要导航器；SelectNodes / SelectSingleNode 就足够了。

但是，您可能需要一个命名空间管理器 - 例如：

```
XmlElement el = ...; //TODO
XmlNamespaceManager nsmgr = new XmlNamespaceManager(
    el.OwnerDocument.NameTable);
nsmgr.AddNamespace("x", el.OwnerDocument.DocumentElement.NamespaceURI);
var nodes = el.SelectNodes(@"/x:outerelement/x:innerelement", nsmgr); 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-12-12T17:17:34.043

您可能想尝试一个 XPath Visualizer 工具来帮助您完成。

[XPathVisualizer](http://xpathvisualizer.codeplex.com)是免费的，易于使用。

[![替代文字](https://i.stack.imgur.com/2iZl8.png)](https://i.stack.imgur.com/2iZl8.png)

重要提示：如果您使用的是 Windows 7/8 并且没有看到文件、编辑和帮助菜单项，请按 ALT 键。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2014-04-18T17:40:57.493

对于任何寻求快速破解解决方案的人，特别是在您**了解**XML 并且不需要担心名称空间等所有情况的情况下，您可以通过简单地将文件读取到字符串和替换攻击属性：

```
XmlDocument doc = new XmlDocument();
string fileData = File.ReadAllText(fileName);
fileData = fileData.Replace(" xmlns=\"", " whocares=\"");
using (StringReader sr = new StringReader(fileData))
{
   doc.Load(sr);
}

XmlNodeList nodeList = doc.SelectNodes("project/property"); 
```

当我处理单个文件时，我发现这比所有其他需要默认命名空间前缀的废话更容易。希望这可以帮助。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-05-26T08:15:34.320

在带有命名空间的 XML 上使用 .NET 中的 XPath（通过导航器或 SelectNodes/SelectSingleNode）时，您需要：

*   提供您自己的 XmlNamespaceManager

*   **并**显式地为 XPath 表达式中的所有元素添加前缀，这些元素位于命名空间中。

后者是（从下面链接的 MS 源解释）：因为 XPath 1.0 忽略了默认命名空间规范 (xmlns="some_namespace")。因此，当您使用不带前缀的元素名称时，它假定为空命名空间。

这就是 XPath 的 .NET 实现忽略 XmlNamespaceManager 中带有前缀 String.Empty 的命名空间并且总是使用空命名空间的原因。

有关详细信息，请参阅[XmlNamespaceManager 和 UndefinedXsltContext 不处理默认命名空间](http://connect.microsoft.com/VisualStudio/feedback/details/277186/xmlnamespacemanager-and-undefinedxsltcontext-dont-handle-default-namespace)。

我发现这个“功能”非常不方便，因为您不能通过简单地添加默认命名空间声明来使旧的 XPath 命名空间感知，但这就是它的工作原理。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-03-14T13:19:20.647

您可以使用 XPath 语句而不使用 XmlNamespaceManager，如下所示：

```
...
navigator.Select("//*[ local-name() = 'innerelement' and namespace-uri() = '' ]")
... 
```

这是在定义了默认命名空间的 XML 中选择元素的简单方法。

重点是使用：

```
namespace-uri() = '' 
```

它将在不使用前缀的情况下找到具有默认命名空间的元素。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-05-04T04:21:09.757

我的回答扩展了 Brandon 之前的回答。我使用他的示例创建了一个扩展方法，如下所示：

```
static public class XmlDocumentExt
{
    static public XmlNamespaceManager GetPopulatedNamespaceMgr(this System.Xml.XmlDocument xd)
    {
        XmlNamespaceManager nmsp = new XmlNamespaceManager(xd.NameTable);
        XPathNavigator nav = xd.DocumentElement.CreateNavigator();
        foreach (KeyValuePair<string,string> kvp in nav.GetNamespacesInScope(XmlNamespaceScope.All))
        {
            string sKey = kvp.Key;
            if (sKey == "")
            {
                sKey = "default";
            }
            nmsp.AddNamespace(sKey, kvp.Value);
        }

        return nmsp;
    }
} 
```

然后在我的 XML 解析代码中，我只添加了一行：

```
XmlDocument xdCandidate = new XmlDocument();
xdCandidate.Load(sCandidateFile);
XmlNamespaceManager nmsp = xdCandidate.GetPopulatedNamespaceMgr();  // 1-line addition
XmlElement xeScoreData = (XmlElement)xdCandidate.SelectSingleNode("default:ScoreData", nmsp); 
```

我真的很喜欢这种方法，因为它在从源 XML 文件加载名称空间方面是完全动态的，并且它并没有完全忽视 XML 名称空间的概念，因此它可以与需要多个名称空间以消除冲突的 XML 一起使用。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-09-27T19:50:15.710

我遇到了空白默认命名空间的类似问题。在这个 XML 示例中，我混合了带有命名空间前缀的元素，以及一个没有：

```
<src:SRCExample xmlns="urn:some:stuff:here" xmlns:src="www.test.com/src" xmlns:a="www.test.com/a" xmlns:b="www.test.com/b">
 <DataBlock>
  <a:DocID>
   <a:IdID>7</a:IdID>
  </a:DocID>
  <b:Supplimental>
   <b:Data1>Value</b:Data1>
   <b:Data2/>
   <b:Extra1>
    <b:More1>Value</b:More1>
   </b:Extra1>
  </b:Supplimental>
 </DataBlock>
</src:SRCExample> 
```

我尝试使用在 XPath Visualizer 中工作的 XPath，但在我的代码中不起作用：

```
 XmlDocument doc = new XmlDocument();
  doc.Load( textBox1.Text );
  XPathNavigator nav = doc.DocumentElement.CreateNavigator();
  XmlNamespaceManager nsman = new XmlNamespaceManager( nav.NameTable );
  foreach ( KeyValuePair<string, string> nskvp in nav.GetNamespacesInScope( XmlNamespaceScope.All ) ) {
    nsman.AddNamespace( nskvp.Key, nskvp.Value );
  }

  XPathNodeIterator nodes;

  XPathExpression failingexpr = XPathExpression.Compile( "/src:SRCExample/DataBlock/a:DocID/a:IdID" );
  failingexpr.SetContext( nsman );
  nodes = nav.Select( failingexpr );
  while ( nodes.MoveNext() ) {
    string testvalue = nodes.Current.Value;
  } 
```

我将其缩小到 XPath 的“DataBlock”元素，但无法使其工作，除非通过简单地通配 DataBlock 元素：

```
 XPathExpression workingexpr = XPathExpression.Compile( "/src:SRCExample/*/a:DocID/a:IdID" );
  failingexpr.SetContext( nsman );
  nodes = nav.Select( failingexpr );
  while ( nodes.MoveNext() ) {
    string testvalue = nodes.Current.Value;
  } 
```

经过多次头疼和谷歌搜索（这让我来到这里），我决定直接在我的 XmlNamespaceManager 加载器中处理默认命名空间，方法是将其更改为：

```
 foreach ( KeyValuePair<string, string> nskvp in nav.GetNamespacesInScope( XmlNamespaceScope.All ) ) {
    nsman.AddNamespace( nskvp.Key, nskvp.Value );
    if ( nskvp.Key == "" ) {
      nsman.AddNamespace( "default", nskvp.Value );
    }
  } 
```

所以现在“default”和“”指向同一个命名空间。一旦我这样做了，XPath "/src:SRCExample/default:DataBlock/a:DocID/a:IdID" 就会像我想要的那样返回我的结果。希望这有助于为其他人澄清这个问题。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-25T12:55:09.247

如果外部元素和内部元素的命名空间不同

```
XmlNamespaceManager manager = new XmlNamespaceManager(myXmlDocument.NameTable);
                            manager.AddNamespace("o", "namespaceforOuterElement");
                            manager.AddNamespace("i", "namespaceforInnerElement");
string xpath = @"/o:outerelement/i:innerelement"
// For single node value selection
XPathExpression xPathExpression = navigator.Compile(xpath );
string reportID = myXmlDocument.SelectSingleNode(xPathExpression.Expression, manager).InnerText;

// For multiple node selection
XmlNodeList myNodeList= myXmlDocument.SelectNodes(xpath, manager); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-01-13T06:30:27.690

在我的情况下，添加前缀是不切实际的。太多的 xml 或 xpath 是在运行时确定的。最终我在 XmlNode 上扩展了方法。这尚未针对性能进行优化，它可能无法处理所有情况，但到目前为止它对我有用。

```
 public static class XmlExtenders
{

    public static XmlNode SelectFirstNode(this XmlNode node, string xPath)
    {
        const string prefix = "pfx";
        XmlNamespaceManager nsmgr = GetNsmgr(node, prefix);
        string prefixedPath = GetPrefixedPath(xPath, prefix);
        return node.SelectSingleNode(prefixedPath, nsmgr);
    }

    public static XmlNodeList SelectAllNodes(this XmlNode node, string xPath)
    {
        const string prefix = "pfx";
        XmlNamespaceManager nsmgr = GetNsmgr(node, prefix);
        string prefixedPath = GetPrefixedPath(xPath, prefix);
        return node.SelectNodes(prefixedPath, nsmgr);
    }

    public static XmlNamespaceManager GetNsmgr(XmlNode node, string prefix)
    {
        string namespaceUri;
        XmlNameTable nameTable;
        if (node is XmlDocument)
        {
            nameTable = ((XmlDocument) node).NameTable;
            namespaceUri = ((XmlDocument) node).DocumentElement.NamespaceURI;
        }
        else
        {
            nameTable = node.OwnerDocument.NameTable;
            namespaceUri = node.NamespaceURI;
        }
        XmlNamespaceManager nsmgr = new XmlNamespaceManager(nameTable);
        nsmgr.AddNamespace(prefix, namespaceUri);
        return nsmgr;
    }

    public static string GetPrefixedPath(string xPath, string prefix)
    {
        char[] validLeadCharacters = "@/".ToCharArray();
        char[] quoteChars = "\'\"".ToCharArray();

        List<string> pathParts = xPath.Split("/".ToCharArray()).ToList();
        string result = string.Join("/",
                                    pathParts.Select(
                                        x =>
                                        (string.IsNullOrEmpty(x) ||
                                         x.IndexOfAny(validLeadCharacters) == 0 ||
                                         (x.IndexOf(':') > 0 &&
                                          (x.IndexOfAny(quoteChars) < 0 || x.IndexOfAny(quoteChars) > x.IndexOf(':'))))
                                            ? x
                                            : prefix + ":" + x).ToArray());
        return result;
    }
} 
```

然后在你的代码中使用类似的东西

```
 XmlDocument document = new XmlDocument();
        document.Load(pathToFile);
        XmlNode node = document.SelectFirstNode("/rootTag/subTag"); 
```

希望这可以帮助

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-20T16:11:13.443

我使用了上面 SpikeDog 描述的 hacky 但有用的方法。它工作得非常好，直到我向它抛出了一个使用管道组合多个路径的 xpath 表达式。

所以我用正则表达式重写了它，并认为我会分享：

```
public string HackXPath(string xpath_, string prefix_)
{
    return System.Text.RegularExpressions.Regex.Replace(xpath_, @"(^(?![A-Za-z0-9\-\.]+::)|[A-Za-z0-9\-\.]+::|[@|/|\[])(?'Expression'[A-Za-z][A-Za-z0-9\-\.]*)", x =>
                {
                    int expressionIndex = x.Groups["Expression"].Index - x.Index;
                    string before = x.Value.Substring(0, expressionIndex);
                    string after = x.Value.Substring(expressionIndex, x.Value.Length - expressionIndex);
                    return String.Format("{0}{1}:{2}", before, prefix_, after);
                });
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-03T13:24:29.017

或者，如果有人应该使用 XPathDocument，比如我：

```
XPathDocument xdoc = new XPathDocument(file);
XPathNavigator nav = xdoc.CreateNavigator();
XmlNamespaceManager nsmgr = new XmlNamespaceManager(nav.NameTable);
nsmgr.AddNamespace("y", "http://schemas.microsoft.com/developer/msbuild/2003");
XPathNodeIterator nodeIter = nav.Select("//y:PropertyGroup", nsmgr); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-01-10T12:39:59.590

1] 如果您有一个在命名空间中没有任何前缀的 XML 文件：

```
<bookstore xmlns="http://www.contoso.com/books">
…
</bookstore> 
```

你有这个解决方法：

```
XmlTextReader reader = new XmlTextReader(@"C:\Temp\books.xml");
// ignore the namespace as there is a single default namespace:
reader.Namespaces = false;
XPathDocument document = new XPathDocument(reader);
XPathNavigator navigator = document.CreateNavigator();
XPathNodeIterator nodes = navigator.Select("//book"); 
```

2] 如果您在命名空间中有一个带有前缀的 XML 文件：

```
<bookstore xmlns:ns="http://www.contoso.com/books">
…
</bookstore> 
```

用这个：

```
XmlTextReader reader = new XmlTextReader(@"C:\Temp\books.xml");
XPathDocument document = new XPathDocument(reader);
XPathNavigator navigator = document.CreateNavigator();
XPathNodeIterator nodes = navigator.Select("//book"); 
```

当然，如果需要，您可以使用命名空间管理：

```
XmlTextReader reader = new XmlTextReader(@"C:\Temp\books.xml");
XPathDocument document = new XPathDocument(reader);
XPathNavigator navigator = document.CreateNavigator();
XmlNamespaceManager nsmgr = new XmlNamespaceManager(reader.NameTable);
nsmgr.AddNamespace("ns", "http://www.contoso.com/book");
XPathNodeIterator nodes = navigator.Select("//book", nsmgr); 
```

我认为这是使代码在大多数情况下工作的最简单方法。

我希望这有助于解决这个 Microsoft 问题……</p>

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-07-15T17:30:44.953

这个一直困扰着我。我现在已经做了一些测试，所以希望我可以帮助你。

[这是来自微软的源码，这是问题的关键](https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xpath-queries-and-namespaces)

重要的段落在这里：

> XPath 将空前缀视为空名称空间。换句话说，只有映射到命名空间的前缀才能在 XPath 查询中使用。这意味着如果您要查询 XML 文档中的命名空间，即使它是默认命名空间，也需要为其定义前缀。

本质上，您必须记住 XPath 解析器使用命名空间 URI - 前缀可互换的设计。就是这样，在编程时，您可以分配我们想要的任何前缀 - 只要 URI 匹配。

为了清楚起见，示例：

**示例 A：**

```
<data xmlns:nsa="http://example.com/ns"><nsa:a>World</nsa:a></data> 
```

这有一个 NULL 默认 URI（`xmlns=`未定义）。因此`/data/nsa:a`返回“世界”。

**示例 B：**

```
<data xmlns:nsa="http://example.com/ns" xmlns="https://standardns/"><nsa:a>World</nsa:a></data> 
```

该文档有一个命名的默认前缀`https://standardns/`。`XPathNavigator.Execute`因此不`/data/nsa:a`返回任何结果。MS 认为 XML*命名空间 uri*`data`应该为 NULL，而命名空间 URI实际上`data`是“https://standardns/”。本质上，XPath 正在寻找`/NULL:data/nsa:a`- 尽管这不起作用，因为您不能将 NULL URI 称为“NULL”作为前缀。NULL 前缀是所有 XPath 中的默认值 - 因此是问题所在。

我们如何解决这个问题？

```
XmlNamespaceManager result = new XmlNamespaceManager(xDoc.NameTable);
result.AddNamespace("DEFAULT", "https://standardns/");
result.AddNamespace("nsa", "http://example.com/ns"); 
```

这样，我们现在可以将 a 称为`/DEFAULT:data/nsa:a`

**示例 C：**

```
<data><a xmlns="https://standardns/">World</a></data> 
```

在这个例子`data`中是在 NULL 命名空间中。`a`位于默认命名空间“https://standardns/”中。`/data/a`根据微软的说法，它应该不起作用，因为`a`它在 NS中`https://standardns/`并且`data`在命名空间 NULL 中。`<a>`因此被隐藏（除非通过奇怪的“忽略名称空间”黑客）并且不能按原样选择。这本质上是根本原因——你不应该选择没有前缀的“a”和“data”，因为这会假设它们在同一个命名空间中，而它们不是！

我们如何解决这个问题？

```
XmlNamespaceManager result = new XmlNamespaceManager(xDoc.NameTable);
result.AddNamespace("DEFAULT", "https://standardns/"); 
```

这样，我们现在可以将 a 称为`/data/DEFAULT:a`as，因为数据是从 NULL 命名空间中选择的，而 a 是从新前缀“DEFAULT”中选择的。在这个例子中重要的是命名空间*前缀*不需要保持不变。在您的代码中引用具有不同前缀的 URI 命名空间是完全可以接受的，这与您正在处理的文档中所写的内容有关。

希望这可以帮助一些人！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-25T12:48:40.620

在这种情况下，问题的原因可能是名称空间解析，但也可能是您的 XPath 表达式本身不正确。您可能想先评估它。

这是使用 XPathNavigator 的代码。

```
//xNav is the created XPathNavigator.
XmlNamespaceManager mgr = New XmlNamespaceManager(xNav.NameTable);
mgr.AddNamespace("prefix", "http://tempuri.org/");

XPathNodeIterator result = xNav.Select("/prefix:outerelement/prefix:innerelement", mgr); 
```

# java - Java 服务器端（Jsp、velocity 等）日历组件？

> ID：585824
> 
> 赞同：0
> 
> 时间：2009-02-25T12:40:49.843
> 
> 标签：java, jsp, calendar, velocity

你知道 Java 服务器端日历组件吗？不是日期选择器，而是一种在谷歌日历中显示月份或星期的方法，其中包含来自我的数据库的事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:42:10.880

快速搜索 sourceforge 会出现[Jwebcalendar](http://sourceforge.net/projects/jcwebcalendar/)。

> “JWebCalendar 是一个多语言 Java JSP/Servlet web 应用程序。它旨在提供一个基于 Web 的组日历，支持多个用户。用户可以管理他们的约会、邀请其他用户、获取电子邮件通知、查看其他用户的日历”

# javascript - ie7中的下拉菜单看起来很奇怪

> ID：585833
> 
> 赞同：0
> 
> 时间：2009-02-25T12:42:03.397
> 
> 标签：javascript, jquery, css

我有一个在 ie7 中不起作用但在其他浏览器中起作用的下拉菜单

[http://redlineautoleasing.com/beta/](http://redlineautoleasing.com/beta/)

它使用jquery，但我不知道如何修复它，有什么线索吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T12:52:35.180

您可以尝试向子菜单 UL 添加宽度，目前 IE8（抱歉没有 IE7）水平显示每个项目。

设置 a `width`，也许`overflow:hidden;`会有所帮助。

（完全未经测试）

# c# - 在 C# 中，如何在接口中声明 EventHandler 的子类？

> ID：585837
> 
> 赞同：22
> 
> 时间：2009-02-25T12:42:47.547
> 
> 标签：c#, event-handling

在接口中声明 EventHandler 的子类（您已定义）的代码语法是什么？

例如，我在委托声明中创建了 EventHandler 子类 MyEventHandler，但您不能在接口中声明委托...

当我要求 Visual Studio 提取一个接口时，它会将 IMyClassName 中的 EventHandler 称为 MyClassName.MyEventHandler，这显然会对类型耦合造成严重破坏。

我假设有一种简单的方法可以做到这一点。我是否必须在单独的文件中明确声明我的事件处理程序？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-25T12:47:33.290

好吧，您需要定义参数并可能在某处委托。您**不需要**第二个文件，但我可能会推荐它......但如果这是最初的问题，那么这些类可能不应该是*嵌套的。*

建议使用标准的“sender, args”模式；有两种常见的方法：

1：单独声明一个event-args类，`EventHandler<T>`在接口上使用：

```
public class MySpecialEventArgs : EventArgs {...}
...
EventHandler<MySpecialEventArgs> MyEvent; 
```

2：分别声明一个事件参数类和委托类型：

```
public class MySpecialEventArgs : EventArgs {...}
public delegate void MySpecialEventHandler(object sender,
    MySpecialEventArgs args);
....
event MySpecialEventHandler MyEvent; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-25T12:49:57.387

假设 C# 2.0 或更高版本...

```
public class MyEventArgs: EventArgs
{
    // ... your event args properties and methods here...
}

public interface IMyInterface
{
    event EventHandler<MyEventArgs> MyEvent;
} 
```

# php - 在支持对象方法作为映射函数的javascript中实现映射？

> ID：585840
> 
> 赞同：3
> 
> 时间：2009-02-25T12:43:13.427
> 
> 标签：php, javascript, functional-programming, scope

我最近尝试在 javascript 中使用 map 的实现来创建一堆项目，然后将它们应用于对象添加方法。

首先是地图的沼泽标准实现。

```
var map = function (fn, a)
{
    for (i = 0; i < a.length; i++)
    {
        a[i] = fn(a[i]);
    }
} 
```

设置。

```
var translateMenu = new Menu;

var languages = [ ['Chinese'   , 'zh-CN']
                , ['German'    , 'de']
                , ['French'    , 'fr']
                , ['Portugese' , 'pt']
                , ['Hindi'     , 'hi']
                ]; 
```

还有我的函数......（不是匿名的，因为它后来在将 translateMenu 添加到 mainMenu 时使用。）

```
var langItem = function (language, subMenu) 
    { 
       return new MenuItem(language[0], 'http://translate.google.com/translate?u=www.example.com&hl=en&ie=UTF-8&tl=en&sl=' + language[1] , "" , subMenu); 

    }

map ( langItem , languages ); 
```

这一切都很好，我现在有一组 MenuItems 可以扔掉。

尝试调用`map( Menu.add , languages )`会导致 Menu 的内部变量未定义，并且调用失败。
现在我确定这与`Menu.add()`方法的范围有关，所以我想如果我也传入对象，它可能会起作用。

我尝试创建一个可以接受对象和函数的新地图函数，但有相同的未定义错误。

```
objMap (fn , obj , a) {
    for (i = 0; i < a.length; i++)
    {
        obj.fn(a);
    }   
}
objMap ( add , translateMenu , languages );   // failed 
```

我通过使用 addAll() 扩展 Menu 来解决这个问题，以获取一个数组，效果很好......

```
Menu.prototype.addAll = function (items){
    for (i = 0; i < items.length; i++)
    {
        this.add(items[i]);
    }
}

translateMenu.addAll( languages ); // yay! but I want a more elegant solution. 
```

无论如何，我的问题是，我**如何实现 map （或类似的通用函数）以实际支持使用对象方法作为我的映射函数？**.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T13:06:27.490

> 尝试调用地图（Menu.add，语言）

在这里，您的问题几乎可以肯定是 JavaScript 缺少绑定方法。

函数的“this”设置仅在调用时通过检查方法的获取方式来确定。如果你说其中之一：

```
obj.method();
obj['method'](); 
```

JavaScript 将获取对“obj”的引用并在方法调用中设置“this=obj”。但如果你说：

```
obj2.method= obj.method;
obj2.method(); 
```

现在函数内的“this”将是 obj2，*而不是*obj！

同样，如果您从其对象中选择方法并将其称为一等对象：

```
var method= obj.method;
method(); 
```

'this' 不会被设置为任何对象，因此 JavaScript 将其设置为全局对象（对于 Web 浏览器而言，也称为“窗口”）。这可能是您的情况发生的情况：“Menu.add”方法丢失了对其所有者“Menu”的所有引用，因此当它被回调时，它很可能在不知不觉中写入“window”对象的成员而不是菜单。

这对于 OO 语言来说当然是非常不寻常的，而且几乎从来都不是你想要的，但是，这就是 JavaScript 的运行方式。导致无声的、难以调试的错误都是该语言的基本原理的一部分。

要解决此问题，您可以将对象引用传递给 map 函数，然后使用 Function.call()/apply() 正确设置“this”引用：

```
function mapMethod(fn, obj, sequence) {
    for (var i= 0; i<sequence.length; i++)
        sequence[i]= fn.call(obj, sequence[i]);
}

mapMethod(Menu.add, Menu, languages) 
```

更通用的方法是使用闭包手动绑定函数引用：

```
function bindMethod(fn, obj) {
    return function() {
        fn.apply(obj, arguments)
    };
}

map(bindMethod(Menu.add, Menu), languages) 
```

此功能将内置到 JavaScript 的未来版本中：

```
map(Menu.add.bind(Menu), languages) 
```

并且可以通过写入 Function.prototype.bind 来将此功能添加到当前浏览器中——事实上，一些 JS 框架已经这样做了。但是请注意：

*   ECMAScript 3.1 承诺您还可以将额外的参数传递给 bind() 以执行部分​​函数应用程序，这需要比上面的 bindMethod() 更多的代码；

*   当您开始在 DOM 对象（如事件处理程序）上留下绑定方法等引用时，IE 喜欢泄漏内存。

# git - How resolve multiple conflicts with "git mergetool" without having to close the editor between files?

> ID：585844
> 
> 赞同：53
> 
> 时间：2009-02-25T12:44:04.720
> 
> 标签：git, diff, mergetool

I've found **git mergetool** to be a handy utility for merging diffs visually, but the way I'm going about it seems really wonky. Essentially, my process looks like this when conflicts are reported:

1.  Execute a **git mergetool**
2.  At the prompt, hit **Enter** to launch my diff tool (Meld or FileMerge, depending on which computer)
3.  Resolve the conflicts
4.  Save the changes
5.  Close the diff tool

If I have more than one conflict, rinse, repeat. Yep, that's me opening and closing my diff viewer once for each conflict in the merge. Since it's launched from the command line, closing it is the only way I know of to tell git mergetool that I've resolved this particular conflict and that it can move on to the next.

Surely there's a better way, but I have no idea. Li'l help, please? This process seems crazy inefficient.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-25T13:31:22.513

At first glance, it does not seem possible to reuse an external diff tool session.

The [`git-mergetool` documentation](http://www.kernel.org/pub/software/scm/git/docs/git-mergetool.html) clearly states:

> If the custom merge tool correctly indicates the success of a merge resolution ***with its exit code***, then the configuration variable `mergetool.<tool>.trustExitCode` can be set to true.
> Otherwise, `git-mergetool` will prompt the user to indicate the success of the resolution after the custom tool has exited.

So the exit code (or the validation of the user *after the exit of the diff tool*) is needed, implying that the user first close the external diff tool.

That seems a great incentive to reduce the number of conflicts on each merge/rebase one attempts ;) (whatever the VCScs tool used)

Note:
Two other git external diff tools settings ("[**Setting up diff and merge tools for Git on Windows**](http://davesquared.blogspot.com/2009/02/setting-up-diff-and-merge-tools-for-git.html)" and "[**Setting up SourceGear DiffMerge with Git**](http://www.therightstuff.de/2009/01/28/Setting-Up-SourceGear-DiffMerge-With-Git.aspx)") do not give more hopes when it come to *not closing* the external diff tool...

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-25T16:26:30.860

If your mergetool of choice supports opening files in an existing instance, you can specify the command in your git config:

```
% git config mergetool.whatever_you_want.cmd 'exec /path/to/merge/tool $LOCAL $MERGED $REMOTE'
% git config merge.tool whatever_you_want 
```

`git mergetool` will then execute your custom command and then prompt you as to whether the file was merged successfully (in lieu of looking at an exit code).

An example I just hacked together for vimdiff:

```
% git config mergetool.persistent.cmd 'gvim --remote-tab-silent "+set buftype=nowrite" "$PWD/$BASE" && sleep 1; gvim --remote-send ":split $PWD/$REMOTE<CR>:set buftype=nowrite<CR>:vertical diffsplit $PWD/$MERGED<CR>:vertical diffsplit $PWD/$LOCAL<CR>:set buftype=nowrite<CR><C-W>l"' 
```

This works well enough, I may start using it myself!

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-25T14:39:23.473

The problem for mergetool is that it deliberately uses a command line interface to initiate a merge session and then waits for the invoked command to return to determine when the user driven merge has completed.

Most merge tools don't provide a command line mechanism for starting a merge session in an already running process with a way for determining when the resolution has been completed and whether successful or not.

It is conceivable that some merge tools could provide this functionality through a separate wrapper command and some sort of IPC, but it would be exceedingly tool specific and difficult to implement in the generic mergetool program.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-03T03:22:04.153

I've been looking for this answer for a very, very, very long time. Now I finally get this simple solution (amazingly):

meld .

This will open meld in version control view. In this way, you can solve conflicts in tabs and mark them as resolved whenever you click the "Marked as resolved" button.

# javascript - jquery/javascript 访问查询字符串/路径

> ID：585852
> 
> 赞同：1
> 
> 时间：2009-02-25T12:46:44.900
> 
> 标签：javascript, jquery

我的页面上有几个标签，我希望它们之间的切换可以返回按钮

我的想法是让选项卡按钮链接到#tab1 和#tab2，然后让jquery 拿起#tabX 并显示/隐藏相关选项卡。

这可能吗？如何从 jquery/javascript 访问 url 中的 #whatever？

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T12:55:23.177

您正在寻找

```
location.hash 
```

通过查看[这个 jquery 历史插件](http://www.mikage.to/jquery/jquery_history.html)，您还可以节省大量时间。祝你好运！

# c# - c#中变量声明和初始化的正则表达式

> ID：585853
> 
> 赞同：1
> 
> 时间：2009-02-25T12:47:03.103
> 
> 标签：c#, regex, variables, declaration

我想编写一个正则表达式来从变量声明语句中提取所有变量值及其名称。说我有

整数 i,k = 10,l=0

我想写一个像 int\s^,?|(^,?)* 这样的正则表达式，但这也将接受 k = 10 即（前面没有 int）基本上的想法是如果字符串以 int 开头，那么将变量列表分开经过 ，

我知道要提取 csv 值，但这里我的字符串也有一些初始值。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T12:56:08.933

开始考虑定义的结构，比如说，

```
(a line can start with some spaces) followed by,

(Type) followed by

(at least one space)
(variable_1)
(optionally
   (comma // next var
    |
    '='number // initialization
    ) ...` 
```

然后尝试转换每个组：

```
^      \s*    \w+           \s+        \w+         ?          (','    |  '=' \d+   ) ...
line  some    type          at least  var          optionally   more  or init some
start spaces  (some chars)  one space (some chars)              vars     val  digits 
```

作为作业留下来删除空格并修复最终的正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-22T08:59:38.257

以下是一些您可以使用的有用信息

[http://compsci.ca/v3/viewtopic.php?t=6712](http://compsci.ca/v3/viewtopic.php?t=6712)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T12:53:07.817

[您可以从 [C# Grammar]( http://msdn.microsoft.com/en-us/library/aa664812(VS.71).aspx)](http://msdn.microsoft.com/en-us/library/aa664812(VS.71).aspx))构建您的正则表达式。但是构建一个解析器肯定会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-22T09:52:18.563

试试这个：

```
 ^(int|[sS]tring)\s+\w+\s*(=\s*[^,]+)?(,\s*\w+\s*(=\s*[^,]+)?)*$ 
```

它将与您的示例代码匹配

```
int i,k = 10,l=0 
```

并对您可能使用或未使用的语言进行一些假设，它也会匹配：

```
int i, j, k=10, l=0
string i=23, j, k=10, l=0 
```

# c# - “受保护”和“受保护内部”有什么区别？

> ID：585859
> 
> 赞同：261
> 
> 时间：2009-02-25T12:49:09.183
> 
> 标签：c#, .net, access-modifiers

`protected`有人可以解释一下 C# 中的和`protected internal`修饰符之间的区别吗？看起来他们的行为是相同的。

* * *

## 回答 #1

> 赞同：426
> 
> 时间：2009-02-25T12:52:07.397

“protected internal”访问修饰符是“protected”和“internal”修饰符的*联合*。

来自[MSDN，访问修饰符（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173121.aspx)：

**[受保护](http://msdn.microsoft.com/en-us/library/bcd5672a.aspx)**：

> 类型或成员只能由同一类或结构中的代码或从该类派生的类中的代码访问。

**[内部](http://msdn.microsoft.com/en-us/library/7c5ka91b.aspx)**：

> 类型或成员可以由同一程序集中的任何代码访问，但不能从另一个程序集中访问。

**受保护的内部**：

> 类型或成员可以被声明它的程序集中的任何代码访问，**或者**从另一个程序集中的派生类中访问。来自另一个程序集的访问必须在派生自声明受保护内部元素的类的类声明中进行，并且必须通过派生类类型的实例进行。

**请注意**:`protected internal`表示“`protected`或`internal`”（同一程序集中的任何类，或任何派生类 - 即使它在不同的程序集中）。

...为了完整性：

**[私人](https://msdn.microsoft.com/en-us/library/st6sy9xe.aspx)**：

> 类型或成员只能由同一类或结构中的代码访问。

**[公开](https://msdn.microsoft.com/en-us/library/yzh058ae.aspx)**：

> 类型或成员可以由同一程序集或引用它的另一个程序集中的任何其他代码访问。

**[私人保护](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/private-protected)**：

> 访问仅限于从当前程序集中的包含类派生的包含类或类型。
> （*自 C# 7.2 起可用*）

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2009-02-25T12:53:04.963

`protected`可以被任何程序集的任何子类使用。

`protected internal`是所有的东西`protected`，加上同一个程序集中的任何东西都可以访问它。

重要的是，它并不意味着“同一个程序集中的子类”——它是两者的结合，而不是交集。

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2018-07-09T09:16:13.550

该表显示了差异。`protected internal`与 相同`protected`，除了它还允许从同一程序集中的其他类进行访问。

[![C#修饰符的比较](https://i.stack.imgur.com/IXnye.png)](https://i.stack.imgur.com/IXnye.png)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-02-25T13:01:26.080

在实践中，关于方法：

**protected** - 可被继承的类访问，否则是私有的。

**internal** - 仅对程序集内的类公开，否则为私有。

**protected internal** - 意味着 protected*或*internal - 方法可以被继承的类*和*程序集中的任何类访问。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-02-24T17:47:26.473

在理解“受保护的内部”访问器的范围方面仍然存在很多混淆，尽管大多数访问器的定义都正确定义。这有助于我理解“受保护”和“受保护内部”之间的混淆：

**public**是真正的公共内部和外部的程序集（**公共内部/公共外部**）

**protected**在程序集内部和外部确实受到保护（**受保护的内部/受保护的外部**）（不允许在顶级类中使用）

**private**在程序集内部和外部确实是私有的（**私有内部/私有外部**）（不允许在顶级课程中使用）

**internal**在程序集内确实是公共的，但在程序集之外被排除在私有（**公共内部/排除外部**）之外

**protected internal**在程序集内部确实是公共的，但在程序集外部是受保护的（**公共内部/受保护外部**）（不允许在顶级类中使用）

如您所见，**受保护的内部**是一种非常奇怪的野兽。不直观。

现在引出了一个问题，为什么微软没有创建（**受保护的内部/排除外部**），或者我猜是某种“私人保护”或“内部保护”？哈哈。似乎不完整？

更令人困惑的是，您可以将公共或受保护的内部嵌套成员嵌套在受保护、内部或私有类型中。为什么要在排除外部程序集访问的内部类中访问嵌套的“受保护的内部”？

微软表示这种嵌套类型受其父类型范围的限制，但这不是编译器所说的。您可以在内部类中编译受保护的内部，这应该将范围限制在程序集中。

对我来说，这感觉像是不完整的设计。它们应该将所有类型的范围简化为一个明确考虑继承以及嵌套类型的安全性和层次结构的系统。这将使对象的共享变得非常直观和精细，而不是基于不完整的范围系统发现类型和成员的可访问性。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-06-14T12:04:09.057

**protected**：变量或方法仅对子类可用（在任何程序集中）

**protected internal**：可用于任何程序集中的子类*以及*同一程序集中的所有类

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-09-28T13:53:06.363

我已经为这些术语读出了非常清晰的定义。

受保护：访问仅限于类定义和从该类继承的任何类。类型或成员只能由同一类或结构中的代码或从该类派生的类中的代码访问。

内部：访问仅限于当前项目程序集中定义的类。类型或成员只能由同一类中的代码访问。

Protected-Internal：访问仅限于当前程序集或从包含类派生的类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-17T11:58:47.353

**public** - 声明为 public 的成员（函数和变量）可以从任何地方访问。

**private** - 不能从类外部访问私有成员。这是成员的默认访问说明符，即如果您没有为成员（变量或函数）指定访问说明符，它将被视为私有的。因此，字符串电话号码；相当于私有字符串PhoneNumber。

**protected** - 受保护的成员只能从子类访问。

**internal** - 它只能在同一个程序集中访问。

**protected internal** - 它可以在同一个程序集中以及在派生类中访问。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-12-29T07:50:06.277

**受保护成员**

类的受保护成员仅在包含的类（已在其中声明）以及程序集内和程序集外的派生类中可用。

表示如果一个位于程序集外部的类只能通过继承该类来使用另一个程序集的受保护成员。

我们可以通过继承该类将受保护的成员暴露在程序集之外，并仅在派生类中使用它。

> 注意：使用派生类中的对象无法访问受保护的成员。

**内部成员**

类的内部成员在程序集中是可用的，或者可以在程序集中创建对象或在派生类中访问，或者您可以说它可以在程序集中的所有类中访问。

> 注意：使用对象创建或在派生类中无法在程序集外部访问内部成员。

**受保护的内部**

Protected Internal 访问修饰符是 Protected 或 Internal 的组合。

受保护的内部成员可以在它声明创建对象或继承该类的整个程序集中可用。并且只能在派生类中的程序集外部访问。

> 注意：受保护的内部成员在同一程序集中作为内部成员工作，在程序集外部作为受保护成员工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-02T18:04:49.157

当您希望在来自另一个程序集的派生类中使用成员或类型同时只想使用父程序集中的成员或类型而不从声明它的类派生时，受保护的内部最佳套件。此外，如果您只想使用成员或类型而不从另一个类派生，则在同一个程序集中您只能使用内部。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-22T07:12:15.370

可以想象在同一个字段、属性或方法上`protected internal`应用两个访问修饰符（`protected`和）。`internal`

在现实世界中，假设我们正在为人们颁发参观博物馆的特权：

> 1.  **城市内**的每个人都可以参观博物馆（内部）。
> 2.  父母住在这里的城市**以外**的每个人都可以参观博物馆（受保护）。

我们可以通过以下方式将它们组合在一起：

> 允许市内（内部）和父母住在这里的市外（受保护）的每个人**参观**博物馆（**受**保护的**内部**）。

编程世界：

**internal**：该字段在程序集（项目）中的任何地方都可用。这就像说它`public`在其项目范围内（但即使是从该类继承的程序集之外的那些类也不能在项目范围之外访问）。**该类型**的每个实例都可以在该程序集（项目范围）中看到它。

**protected**：仅仅意味着所有派生类都可以看到它（在程序集内部或外部）。例如，派生类可以使用以下方法查看其方法和构造函数中的字段或方法：`base.NameOfProtectedInternal`。

因此，将这两个访问修饰符放在一起（**`protected internal`**），您就有了可以在项目中**公开**的内容，并且可以被那些在其范围内从该类继承的人看到。

> 它们可以写在 中`internal protected`，而且**不**改变意思，但写起来很方便`protected internal`。

# .net - String.Join 与 StringBuilder：哪个更快？

> ID：585860
> 
> 赞同：87
> 
> 时间：2009-02-25T12:49:22.147
> 
> 标签：.net, performance, string, stringbuilder

在[上](https://stackoverflow.com/questions/585215/can-i-rewrite-this-more-elegantly-using-linq)一个关于将 a 格式化`double[][]`为 CSV 格式的问题中，[有人建议](https://stackoverflow.com/questions/585215/can-i-rewrite-this-more-elegantly-using-linq/585223#585223)using`StringBuilder`会比`String.Join`. 这是真的？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-02-25T13:00:58.280

简短的回答：这取决于。

长答案：**如果您已经有一个字符串数组要连接在一起（带有分隔符），`String.Join`那么这是最快的方法。**

`String.Join`可以查看所有字符串以计算出所需的确切长度，然后再次复制所有数据。这意味着将*不*涉及额外的复制。*唯一*的缺点是它必须遍历字符串两次，这意味着可能会比必要的次数更多地破坏内存缓存。

如果您事先*没有*将字符串作为数组，则使用起来*可能会*更快`StringBuilder`-但在某些情况下它不是。如果使用一种`StringBuilder`方法进行大量复制，那么构建一个数组然后调用`String.Join`可能会更快。

编辑：这是对单个调用`String.Join`与对`StringBuilder.Append`. 在最初的问题中，我们有两个不同级别的`String.Join`调用，因此每个嵌套调用都会创建一个中间字符串。换句话说，它更复杂，更难猜测。我会惊讶地看到任何一种方式在典型数据中都显着（在复杂性方面）“获胜”。

编辑：当我在家时，我会写一个对`StringBuilder`. 基本上，如果你有一个数组，其中每个元素的大小大约是前一个元素的两倍，并且你得到它恰到好处，你应该能够为每个追加（元素，而不是分隔符，尽管需要也要考虑在内）。在这一点上，它几乎和简单的字符串连接一样糟糕——但`String.Join`不会有任何问题。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-25T13:05:41.517

这是我的测试台，`int[][]`为简单起见；结果第一：

```
Join: 9420ms (chk: 210710000
OneBuilder: 9021ms (chk: 210710000 
```

（`double`结果更新：）

```
Join: 11635ms (chk: 210710000
OneBuilder: 11385ms (chk: 210710000 
```

（更新重新 2048 * 64 * 150）

```
Join: 11620ms (chk: 206409600
OneBuilder: 11132ms (chk: 206409600 
```

并启用 OptimizeForTesting：

```
Join: 11180ms (chk: 206409600
OneBuilder: 10784ms (chk: 206409600 
```

速度如此之快，但规模不大；钻机（在控制台运行，在发布模式等）：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Text;

namespace ConsoleApplication2
{
    class Program
    {
        static void Collect()
        {
            GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced);
            GC.WaitForPendingFinalizers();
            GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced);
            GC.WaitForPendingFinalizers();
        }
        static void Main(string[] args)
        {
            const int ROWS = 500, COLS = 20, LOOPS = 2000;
            int[][] data = new int[ROWS][];
            Random rand = new Random(123456);
            for (int row = 0; row < ROWS; row++)
            {
                int[] cells = new int[COLS];
                for (int col = 0; col < COLS; col++)
                {
                    cells[col] = rand.Next();
                }
                data[row] = cells;
            }
            Collect();
            int chksum = 0;
            Stopwatch watch = Stopwatch.StartNew();
            for (int i = 0; i < LOOPS; i++)
            {
                chksum += Join(data).Length;
            }
            watch.Stop();
            Console.WriteLine("Join: {0}ms (chk: {1}", watch.ElapsedMilliseconds, chksum);

            Collect();
            chksum = 0;
            watch = Stopwatch.StartNew();
            for (int i = 0; i < LOOPS; i++)
            {
                chksum += OneBuilder(data).Length;
            }
            watch.Stop();
            Console.WriteLine("OneBuilder: {0}ms (chk: {1}", watch.ElapsedMilliseconds, chksum);

            Console.WriteLine("done");
            Console.ReadLine();
        }
        public static string Join(int[][] array)
        {
            return String.Join(Environment.NewLine,
                    Array.ConvertAll(array,
                      row => String.Join(",",
                        Array.ConvertAll(row, x => x.ToString()))));
        }
        public static string OneBuilder(IEnumerable<int[]> source)
        {
            StringBuilder sb = new StringBuilder();
            bool firstRow = true;
            foreach (var row in source)
            {
                if (firstRow)
                {
                    firstRow = false;
                }
                else
                {
                    sb.AppendLine();
                }
                if (row.Length > 0)
                {
                    sb.Append(row[0]);
                    for (int i = 1; i < row.Length; i++)
                    {
                        sb.Append(',').Append(row[i]);
                    }
                }
            }
            return sb.ToString();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-02-25T13:03:19.070

我不这么认为。通过 Reflector 看，实现`String.Join`看起来非常优化。它还具有预先知道要创建的字符串的总大小的额外好处，因此它不需要任何重新分配。

我创建了两种测试方法来比较它们：

```
public static string TestStringJoin(double[][] array)
{
    return String.Join(Environment.NewLine,
        Array.ConvertAll(array,
            row => String.Join(",",
                       Array.ConvertAll(row, x => x.ToString()))));
}

public static string TestStringBuilder(double[][] source)
{
    // based on Marc Gravell's code

    StringBuilder sb = new StringBuilder();
    foreach (var row in source)
    {
        if (row.Length > 0)
        {
            sb.Append(row[0]);
            for (int i = 1; i < row.Length; i++)
            {
                sb.Append(',').Append(row[i]);
            }
        }
    }
    return sb.ToString();
} 
```

我运行每个方法 50 次，传入一个 size 数组`[2048][64]`。我为两个数组做了这个；一个用零填充，另一个用随机值填充。我在我的机器上得到了以下结果（P4 3.0 GHz，单核，无 HT，从 CMD 运行 Release 模式）：

```
// with zeros:
TestStringJoin    took 00:00:02.2755280
TestStringBuilder took 00:00:02.3536041

// with random values:
TestStringJoin    took 00:00:05.6412147
TestStringBuilder took 00:00:05.8394650 
```

将数组的大小增加到`[2048][512]`，同时将迭代次数减少到 10，得到以下结果：

```
// with zeros:
TestStringJoin    took 00:00:03.7146628
TestStringBuilder took 00:00:03.8886978

// with random values:
TestStringJoin    took 00:00:09.4991765
TestStringBuilder took 00:00:09.3033365 
```

结果是可重复的（几乎；由不同的随机值引起的小波动）。显然`String.Join`大部分时间都快一点（尽管幅度很小）。

这是我用于测试的代码：

```
const int Iterations = 50;
const int Rows = 2048;
const int Cols = 64; // 512

static void Main()
{
    OptimizeForTesting(); // set process priority to RealTime

    // test 1: zeros
    double[][] array = new double[Rows][];
    for (int i = 0; i < array.Length; ++i)
        array[i] = new double[Cols];

    CompareMethods(array);

    // test 2: random values
    Random random = new Random();
    double[] template = new double[Cols];
    for (int i = 0; i < template.Length; ++i)
        template[i] = random.NextDouble();

    for (int i = 0; i < array.Length; ++i)
        array[i] = template;

    CompareMethods(array);
}

static void CompareMethods(double[][] array)
{
    Stopwatch stopwatch = Stopwatch.StartNew();
    for (int i = 0; i < Iterations; ++i)
        TestStringJoin(array);
    stopwatch.Stop();
    Console.WriteLine("TestStringJoin    took " + stopwatch.Elapsed);

    stopwatch.Reset(); stopwatch.Start();
    for (int i = 0; i < Iterations; ++i)
        TestStringBuilder(array);
    stopwatch.Stop();
    Console.WriteLine("TestStringBuilder took " + stopwatch.Elapsed);

}

static void OptimizeForTesting()
{
    Thread.CurrentThread.Priority = ThreadPriority.Highest;
    Process currentProcess = Process.GetCurrentProcess();
    currentProcess.PriorityClass = ProcessPriorityClass.RealTime;
    if (Environment.ProcessorCount > 1) {
        // use last core only
        currentProcess.ProcessorAffinity
            = new IntPtr(1 << (Environment.ProcessorCount - 1));
    }
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-25T13:18:24.510

除非 1% 的差异在整个程序运行所需的时间方面变得很重要，否则这看起来像是微优化。我会编写最易读/易于理解的代码，而不用担心 1% 的性能差异。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-25T12:53:27.753

是的。如果你做的连接超过几个，它会快*很多。*

当您执行 string.join 时，运行时必须：

1.  为结果字符串分配内存
2.  将第一个字符串的内容复制到输出字符串的开头
3.  将第二个字符串的内容复制到输出字符串的末尾。

如果您进行两次连接，则必须将数据复制两次，依此类推。

StringBuilder 为一个缓冲区分配了空间，因此可以在不复制原始字符串的情况下追加数据。由于缓冲区中还有剩余空间，附加的字符串可以直接写入缓冲区。然后它只需要在最后复制整个字符串一次。

# c# - Silverlight 的音频输出

> ID：585868
> 
> 赞同：2
> 
> 时间：2009-02-25T12:51:41.267
> 
> 标签：c#, silverlight, audio, pcm

我正在寻找一个 Silverlight 应用程序，它将从 Web 服务器获取数据流（不是音频流本身）。

然后将操纵数据流以提供某种格式的音频（例如 G.711 a-Law），然后将其转换为 PCM，以便应用附加效果（例如提高音量）。

到目前为止我还可以。我有我的数据，将 G.711 转换为 PCM，但我的问题是能够将此 PCM 音频输出到声卡。

我的解决方案基于一些用于 .Net 应用程序的 C# 代码，但在 Silverlight 中，尝试获取委托（函数指针）的副本时会出现问题，一旦我生成了一个简单的问题，这将成为单独问题的主题代码示例。

所以，问题是......如何将我在 Silverlight 中的数据结构（当前为数组）中保存的 PCM 音频输出给用户？（请不要说将字节值写入文本框）

如果它是 MP3 或 WMA 文件，我会使用 MediaElement 播放它，但我不想将其制成文件，因为这会影响对音频应用动态效果。

我看过一些帖子，有人说 Silverlight 中的低级音频支持很差/不存在，所以我愿意接受人们可能提出的任何建议/想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T13:00:22.433

简单的答案是版本 2 中的 Silverlight 不支持 PCM 播放。因此，除非您想编写一个完全托管的 PCM 到 MP3 转换器，否则您会被卡住。即使那样，我也不确定您是否可以让 MediaElement 从独立存储中播放。

您是否有机会使用网络服务来执行转换？

另请参阅此问题： [Silverlight 中的声音 API 在哪里？或者，我如何编写一个音乐应用程序以在浏览器中运行？](https://stackoverflow.com/questions/347288/wheres-the-sound-api-in-silverlight-or-how-do-i-write-a-music-app-to-run-in-t)

**更新：** Silverlight 3 支持您的自定义音频源。但是，它不会让您截取样本以在 WMA 或 MP3 上执行效果，大概是出于 DRM 的原因，因此您仍然可能需要编写自己的解码器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T21:33:11.893

简短的回答是使用 MediaElement + MediaStreamSource

看看这些：

[http://blogs.msdn.com/gillesk/archive/2009/03/23/playing-back-wave-files-in-silverlight.aspx](http://blogs.msdn.com/gillesk/archive/2009/03/23/playing-back-wave-files-in-silverlight.aspx)

[http://code.msdn.microsoft.com/wavmss/Release/ProjectReleases.aspx?ReleaseId=2417](http://code.msdn.microsoft.com/wavmss/Release/ProjectReleases.aspx?ReleaseId=2417)

基本上，在托管代码中编写一个解码器以将 G.711 a-Law 转换为 PCM，然后对原始值进行任何修改，然后将它们传递到 MediaStreamSource。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:24:24.490

Mark Heath 的回答是正确的 - 仅支持某些格式 - mp3 和某些风格的 WMA（不幸的是不是 WMA 无损，它会“更接近”PCM）。

要在 Silverlight 中播放 PCM 数据，您可以执行以下操作：
* 将 PCM 转换为 mp3 数据，并将其存储在内存中。[* 使用ManagedMediaHelpers](http://code.msdn.microsoft.com/ManagedMediaHelpers)
介绍的技术播放 mp3 数据。这里的想法涉及一个名为 Mp3MediaStreamSource 的类（派生自 System.Windows.Media.MediaStreamSource），该类将 mp3 块提供给 MediaElement 以进行播放。块需要在流中，但当然可以使用内存流。

我最初以为您可以通过 MediaStreamSource 提供 PCM 块，但这不起作用。真的很遗憾，因为它可以很容易地解决您的问题（以及我面临的问题 - 制作 Speex 音频文件播放器）！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T16:59:03.210

看起来 Silverlight 3 现在支持直接 PCM 输出，或者将在发布时支持。我在文档中还没有看到关于原始 AV 管道的任何内容。

# php - 如何执行 PHP 蜘蛛/爬虫但没有超时

> ID：585871
> 
> 赞同：0
> 
> 时间：2009-02-25T12:52:39.300
> 
> 标签：php, web-crawler

基本上我需要绕过最大执行时间。

我需要以不同的时间间隔抓取页面以获取信息，这意味着以这些时间间隔调用机器人，以从数据库加载链接并废弃链接指向的页面。

问题是，加载机器人。如果我用 javascript 加载它（如 Ajax 调用），浏览器会抛出一个错误，指出页面响应时间过长 yadda yadda yadda，另外我必须保持页面打开。

如果我从 PHP 中执行此操作，我可能会将执行时间延长到所需的时间，但如果它确实引发错误，我无权终止进程，并且浏览器中不会显示任何内容，直到 PHP 执行完成了吧？

我想知道是否有人有任何技巧来解决这个问题？刮板以不同的时间间隔自行执行，而我无需一直观看它。

干杯:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T13:02:39.183

像这样使用[`set_time_limit()`](http://ca2.php.net/manual/en/function.set-time-limit.php)：

```
set_time_limit(0);
// Do Time Consuming Operations Here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T13:12:11.610

看看[Sphider（PHP 搜索引擎）](http://www.sphider.eu/)是如何做到这一点的。

基本上，如果有 continue=true 参数集，您将只处理您需要的部分站点，做您的事情，然后继续下一个请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T13:41:10.527

> “在 PHP 执行完成之前，浏览器中不会显示任何内容”

您可以使用[`flush()`](http://uk.php.net/flush)解决此问题：

> `flush()`
> 
> （PHP 4，PHP 5）
> 
> 刷新 PHP 的输出缓冲区以及 PHP 正在使用的任何后端（CGI、Web 服务器等）。这有效地尝试将所有输出推送到用户的浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T15:20:03.813

通过 CRON 运行并将蜘蛛分成块，因此它一次只会执行几个块。从具有不同参数的 CRON 调用以仅处理几个块。

# graphics - 用低帧率创建漂亮的动画

> ID：585879
> 
> 赞同：0
> 
> 时间：2009-02-25T12:53:48.643
> 
> 标签：graphics, animation, 2d

好的，这听起来像是一个愚蠢的问题，但我想知道当你知道你将有低帧率时，是否有任何关于如何尽可能平滑和快速地为对象设置动画的建议。

我的动画所做的是，我在 x 和 y 上移动了大约 10 个二维矩形（每个都包含一个纹理）大约 500 像素，并且我还将它们从大约 1000*1000 像素缩小到大约 30%。我希望动画在大约 200 毫秒内完成。我估计帧率可能是 20-30fps。

我尝试了不同的时间和运动速度，但它们看起来都像废话。如果你的速度很高，你几乎看不到动画，如果你的速度很慢，它看起来很流畅，但需要很多时间。

有没有研究过如何制作一个看起来仍然运行流畅的快速动画。我在想你可能会在开始时加速很慢，然后在结束时跳跃，或者反过来呢？我自己的实验看起来既跳跃又缓慢：P

我们人类认为看起来不错的像素/帧必须有一些限制。我在哪里可以找到这样的指南？

* * *

为什么我想知道这个？

我制作了一个窗口切换应用程序，它可以制作一些很酷的动画，但问题是当我不运行任何图形密集型应用程序时，我的图形卡会进入某种低功耗模式。这会导致我的应用程序（一次运行时间不超过 3 秒）性能很差，因为 gfx 卡从来没有时间加速。

（如果你有笔记本电脑和vista，你可以自己试试这个：按win+tab，你会看到动画有点断断续续，然后开始播放电影，再次按win+tab，这次动画更流畅）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:02:15.690

如果动作很小，您应该能够以 15 fps 左右的速度获得外观合理的动画。意识到将高带宽图形信息（大量运动和形状/颜色变化）拟合到低带宽介质（低 fps）中存在限制，但运动模糊等技术会有所帮助。

此外，考虑双缓冲或三缓冲，理想情况下与显示器的垂直刷新同步，这将有助于减少可能分散动画注意力的闪烁和撕裂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T13:13:27.330

如果您的动画是纯二维的（例如，窗口内容的刚性移动），那么您可以通过将它们像素锁定到视频帧来提高它们的平滑度。即使在非常低的帧速率下，每帧恰好 N 个像素的运动看起来也很平滑，而如果您有一个像素的一些剩余部分，您会从像素采样中获得明显的混叠。

运动模糊理论上是使运动看起来平滑的方法，但适当的运动模糊很昂贵，所以如果您已经遇到帧率问题，那么运动模糊可能只会让事情变得更糟。但是可能有一些方法可以降低成本，例如，如果运动方向和速度恒定，那么您可以渲染单个模糊图像并使用它。或者可能多次过度绘制运动图像的部分透明副本以获得“轨迹”。

# php - PHP 包含数字

> ID：585891
> 
> 赞同：0
> 
> 时间：2009-02-25T12:58:20.113
> 
> 标签：php, sql-injection

如果我像这样构建我的页面，我是否必须检查 news_id 在 news.php 中是否也是数字？或者这样安全吗？

**索引.php：**

```
 if (ctype_digit($_GET['news_id'])) include('news.php'); 
```

**新闻.php：**

```
 $query = mysql_query("SELECT * FROM news WHERE news_id = $_GET[news_id]");
    $row = mysql_fetch_assoc($query);

    if (!mysql_num_rows($query)) exit('The news you're trying to read do not exist.'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T13:10:04.220

其他答案是绝对正确的，您永远不应该允许任何用户直接输入您的数据库或任何其他敏感区域。

您应该验证/清理来自 $_GET、$_POST 等的所有输入...您可以使用 PHP 的内置[过滤器功能](http://php.net/filter)或使用内置于框架中的过滤器功能，例如 Cake PHP 或 Symphony，它们都可以更轻松地处理用户数据。

jonstjohn 有一个很好的观点，即您以这种方式让自己打开 sql 注入，以及基于将恶意代码输入您的应用程序的其他形式的攻击。

值得阅读 Jeff Atwood 的[25 个最危险的编程错误](https://blog.codinghorror.com/top-25-most-dangerous-programming-mistakes/)，了解这些问题以及其他问题的背景知识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T13:01:53.037

简短的回答：是的，你应该。

有人可能（并且将会）绕过 index.php 请求 news.php。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T13:03:45.577

您确实应该在将数据发送到 MySQL 之前对其进行转义并对其进行清理。不能保证有人不会尝试通过帖子数据发送恶意内容。

```
$news_id = (int)$_GET[news_id];

$query = mysql_query("SELECT * FROM news WHERE news_id = " . 
                      mysql_real_escape_string($news_id));
$row = mysql_fetch_assoc($query);

if (!mysql_num_rows($query)) exit('The news you're trying to read do not exist.'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T13:05:08.520

1.  这**不安全**；
2.  不要检查，使用 intval() 将其转换为整数；
3.  永远不要在没有转义或强制转换的情况下将 GPC 变量放入 SQL 中；

# c++ - C++成员函数虚覆盖和同时重载

> ID：585913
> 
> 赞同：30
> 
> 时间：2009-02-25T13:04:55.480
> 
> 标签：c++, inheritance, polymorphism, virtual

如果我有这样的代码：

```
struct A {
  virtual void f(int) {}
  virtual void f(void*) {}
};

struct B : public A {
  void f(int) {}
};

struct C : public B {
  void f(void*) {}
};

int main() {
  C c;
  c.f(1);

  return 0;
} 
```

我收到一条错误消息，提示我正在尝试进行从 int 到 void* 的无效转换。为什么编译器不能弄清楚他必须调用 B::f，因为这两个函数都被声明为虚拟函数？

* * *

在阅读了 jalf 的答案后，我进一步减少了它。这个也不行。不是很直观。

```
struct A {
  virtual void f(int) {}
};

struct B : public A {
  void f(void*) {}
};

int main() {
  B b;
  b.f(1);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-25T13:11:06.587

简短的回答是“因为这就是 C++ 中重载解析的工作方式”。

编译器在 C 类中搜索函数 F，如果找到，它会停止搜索，并尝试从中挑选一个候选函数。如果在派生类中没有找到匹配的函数，它只会在基类内部查找。

但是，您可以将基类函数显式引入派生类的命名空间：

```
struct C : public B {
  void f(void*) {}
  using B::f; // Add B's f function to C's namespace, allowing it to participate in overload resolution
}; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-01T21:21:56.987

或者你可以这样做：

```
void main()
{
    A *a = new C();
    a->f(1);  //This will call f(int) from B(Polymorphism)
} 
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2009-10-22T06:19:54.297

那么我想首先你不明白什么是虚拟机制或多态。仅通过使用对象指针来实现多态性时。我认为你是 C++ 的新手。如果不使用对象指针，则没有多态性或虚拟关键字使用基类指针并将所需的派生类对象分配给它的意义。然后打电话试试。

# asp.net - asp.net 对来自其他用户的静态请求的安全图像？

> ID：585919
> 
> 赞同：3
> 
> 时间：2009-02-25T13:07:00.403
> 
> 标签：asp.net, security, image

我在一个为每个特定用户生成动态图像的网站上工作。有时这些图像包含对非常敏感数据的描述。最近我们开始看到对属于不同用户的图像的请求，形式为

[http://myapp/images/someuid/image1.jpg](http://myapp/images/someuid/image1.jpg)

显然，有人发现如果他们创建了正确的 URL，他们可以访问其他用户的图像。我们将图像存储到文件系统以帮助减少带宽。

*   我们如何保护这一点 - 某种 http 处理程序？

*   有没有一种方法可以提供图像以利用 o -f 缓存而不必将其写入文件系统并让 IIS 完成脏活？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T13:34:59.260

使用 .ashx：-

```
TimeSpan maxAge = new TimeSpan(0, 15, 0); //!5 minute lifetiem.

context.Response.ContentType = "image/gif";
context.Response.Cache.SetCacheability(HttpCacheability.Private);
context.Response.Cache.SetExpires(DateTime.UtcNow.Add(maxAge));
context.Response.Cache.SetMaxAge(maxAge);
context.Response.Cache.SetLastModified(lastModified); // last modified date time of file
context.Response.WriteFile(filenameofGif); 
```

您可以包含您需要的任何代码检查，以确保正确的用户正在访问图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T13:13:42.853

我认为最好的选择是拒绝直接访问来自网络的图像并创建一个 aspx 来检查用户权限并返回正确的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T13:18:30.360

如果图像对特定用户是私有的，那么您应该将它们存储在主应用程序文件夹之外，或者将 web.config 放在每个图像文件夹中（如*someuid*）并限制配置文件中的访问 - 要么剪切所有人 (deny="*") 或仅允许特定用户访问 (allow="john")。

在这两种情况下，您都可以使用处理程序将图像流式传输给用户，但至少您现在可以检查权限。如果请求用户没有权限，则向他抛出 401，甚至显示另一张图像，如 imagenotfound.gif。

但是，我担心处理程序会产生大量流量，因为每个图像都会有一个调用，我不知道每个用户显示多少图像。

# clickonce - 未使用 ClickOnce 应用程序部署的数据文件

> ID：585920
> 
> 赞同：2
> 
> 时间：2009-02-25T13:07:03.417
> 
> 标签：clickonce

我有一个使用 ClickOnce 部署的 WinForms 应用程序。在应用程序项目中，我有一些文件标记为内容，在发布设置的应用程序文件对话框中也标记为“数据文件”。我还有一些标记为“包含自动”的内容文件。

当我发布时，安装应用程序，然后执行它在启动时立即崩溃，并出现 DirectoryNotFoundException（下面的完整堆栈跟踪）。

查看应用程序文件夹，我可以找到所有标记为“包括自动”的文件，与可执行文件一起整齐地放置。虽然没有安装标记为“数据文件”的文件（我已经检查了可执行文件夹和数据文件夹）。

请注意，发布和安装都是从我本地计算机上的文件夹完成的，而不是通过网站完成的。

如果我在所有内容文件上从“数据文件”更改为标准包含，那么一切都像一个魅力。

我正在运行（喘气）Windows XP SP3 和 .Net 3.5 SP1。

System.IO.DirectoryNotFoundException 未处理 Message="系统找不到指定的路径。（来自 HRESULT 的异常：0x80070003）" Source="mscorlib" StackTrace：在 System.Deployment.Internal.Isolation.IActContext.SetApplicationRunningState(UInt32 dwFlags, UInt32 ulState, UInt32& ulDisposition) 在 System.ActivationContext.SetApplicationState(ApplicationState s) 在 System.AppDomain.SetupDomainForApplication(ActivationContext activationContext, String[] activationData) 在 System.AppDomain.SetupApplicationHelper(Evidence providedSecurityInfo, Evidence creatorsSecurityInfo, ApplicationIdentity appIdentity, ActivationContext activationContext, String [] activationData) 在 System.AppDomain.SetDomainManager(Evidence providedSecurityInfo, Evidence creatorsSecurityInfo,IntPtr parentSecurityDescriptor, Boolean publishAppDomain) at System.AppDomain.SetDefaultDomainManager(String fullName, String[] manifestPaths, String[] activationData) InnerException:

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T22:40:11.510

经过一些反复试验后，我发现当我的数据文件位于子文件夹的子文件夹中时，会发生 DirectoryNotFound 异常。如果数据文件位于项目根目录或第一级子文件夹中，一切都会按预期工作。

问题似乎也与以下事实有关：在其中一些子文件夹中，我有一些文件标记为 Include，一些文件标记为 Data。这可能会在部署过程中导致一些混乱，其中数据文件没有被部署。

最后，我必须做的是卸载任何以前版本的应用程序。接下来，像这样在项目中组织我的数据文件：

```
\Testfiles\Filegroup1\data1.txt
\Testfiles\Filegroup1\data2.txt
\Testfiles\Filegroup2\moredata1.txt
\Testfiles\Filegroup2\moredata2.txt

```

然后我将每个文件夹中的所有文件标记为数据。现在一切都很好地部署了，加载程序在启动时不会崩溃。

# development-environment - 任何人都可以提供有关 SilverStripe 开发环境的任何提示吗？

> ID：585924
> 
> 赞同：1
> 
> 时间：2009-02-25T13:08:20.650
> 
> 标签：development-environment, silverstripe

我对使用 SilverStripe 进行开发非常陌生。目前我正在使用 Firefox / Kate 在新平台上进行开发。

我想知道其他人用什么？有没有人成功使用过 Eclipse？是否有其他与 SilverStripe 配合良好的 IDE/环境/方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T11:13:09.547

尝试使用[Netbeans](http://www.netbeans.org/features/php/index.html)进行 PHP 开发，对我来说非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T19:24:59.623

我正在使用[Aptana](http://www.aptana.com)，一个基于 Eclipse 的 IDE。

我建议在这里搜索 PHP IDE 以获得更好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-04T17:58:50.207

我使用不再分发的 Zend Studio 5.5，因为他们用 Eclipse 变体替换了他们的自定义应用程序。如果您考虑使用 Eclipse 变体，我会使用 Aptana Studio。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-31T23:16:35.440

只需确保您可以使用语法高亮 .ss 文件（如 .php），并且您可以使用任何可以让您看到整个项目的文件，因为您将经常跳转到/从*/mysite*和*/themes文件夹。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-21T18:59:52.010

Silverstripe 文档推荐了用于 Eclipse 的 PHP 开发工具 PDT 等：[http ://doc.silverstripe.org/tools](http://doc.silverstripe.org/tools)

# apache-flex - flex 中的必填字段

> ID：585926
> 
> 赞同：3
> 
> 时间：2009-02-25T13:09:41.973
> 
> 标签：apache-flex, validation, required-field

我有一个关于 flex 的问题。我有一个表格，并且需要电子邮件。我搜索了这个并找到了以下解决方案：

```
<mx:FormItem label="Email" id="emailFormItem"  width="100%" styleName="formEven" required="true">                   
<mx:TextInput id="emailTextInput" width="100%" text="{user.email}"/></mx:FormItem> 
```

问题是当我按下确定时，呼叫仍然存在。我知道您必须自己验证以下内容，但有人知道我如何验证字段吗？

解决方案：

我找到了一个解决方案：

您可以为要验证的每个字段创建一个验证器，然后创建此函数：

```
private function isValid():Boolean {
            var failedValidators:Array = Validator.validateAll([emailValidator, userNameValidator, languageValidator, firstNameValidator, lastNameValidator]);
            return failedValidators.length == 0;
        } 
```

这可以关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T13:17:42.593

我通常做的是创建一个名为 isSubmitEnabled 或 isFormComplete 之类的方法。我在需要的每个字段的 keyUp 上调用它并检查所有字段中的值（以及我想要做的任何其他验证），然后只要所有内容都检查出来，我将提交按钮设置为启用，否则我设置提交按钮被禁用。只要您在开始时禁用该按钮，那么您应该一切顺利。

我已经多次使用这种方法，发现它最容易使用，尤其是维护。我将查看文档，看看是否可以看到您可以使用表单项上的 required 属性做什么。

**更新：**

根据文档：

> 此属性仅控制指标显示。如果需要输入验证，则必须将验证器附加到子级。

What you want is mx.validators.Validator ([http://livedocs.adobe.com/flex/3/langref/mx/validators/Validator.html](http://livedocs.adobe.com/flex/3/langref/mx/validators/Validator.html))

```
 <mx:Validator id="reqValid" required="true"
    source="{fname}" property="text" 
    valid="handleValid(event)" invalid="handleValid(event)"/> 
```

See the code examples on that link to see how to use it. The example is actually exactly what you are looking for I think. HTH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-19T12:03:50.840

```
<fx:Declarations>
        <mx:RadioButtonGroup id="a1" itemClick="usdradio(event);"/>
        <fx:Model id="creditcard">
            <card>  
                <cardType>{cardTypeCombo.selectedItem.data}</cardType>
                <cardNumber>{cardNumberInput.text}</cardNumber>
            </card>
        </fx:Model>
        <mx:CreditCardValidator id="ccV" 

                                cardTypeSource="{creditcard}" cardTypeProperty="cardType"
                                cardNumberSource="{creditcard}" cardNumberProperty="cardNumber"
                                trigger="{myButton}" triggerEvent="click"
                                cardTypeListener="{cardTypeCombo}"
                                cardNumberListener="{cardNumberInput}"
                                valid="Alert.show('Validation Succeeded!')"/>

        <mx:ArrayCollection id="dp">
            <fx:Object label="American Express" data="American Express"/>
            <fx:Object label="Diners Club" data="Diners Club"/>
            <fx:Object label="Discover" data="Discover"/>
            <fx:Object label="MasterCard" data="MasterCard"/>
            <fx:Object label="Visa" data="Visa"/>
        </mx:ArrayCollection>

        <mx:CurrencyValidator source="{priceUS}" property="text" precision="2" 

                              trigger="{myButton2}" triggerEvent="click" 
                              valid="Alert.show('Validation Succeeded!')"/> 
```

# .net - 如何在不使用 Crystal Reports 的情况下以 WYSIWYG 格式表示数据？

> ID：585929
> 
> 赞同：0
> 
> 时间：2009-02-25T13:10:05.077
> 
> 标签：.net, crystal-reports, printing, dataset, reporting

我正在寻找一种以所见即所得、美观且美观的方式在带有文本和图像的表格中打印数据的方法。

到目前为止，我有：标题 + 图像 + 类似网络的装饰 + 阿拉伯标签和值 + 数据集中的数据 (xml) + 我需要为业务分析师提供更改输出布局的方法。

**Crystal Report 完成了所有这些工作。但我不喜欢水晶报表。**

**有没有好的印刷技术？**

有没有人有什么想法可以做：Dataset->xml->html with xslt？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T14:11:31.153

不确定您正在使用的数据库，但始终有 SQL Server Reporting Services。比起水晶报表，我更喜欢它。

编辑：我想补充一点，Reporting Services 实际上有一个完整的 GUI 用于开发（Visual Studio），它允许将报告导出为许多不同的格式，如 Word、Excel、PDF、HTML 等。

# html - 如何将div的内容与底部对齐

> ID：585945
> 
> 赞同：1311
> 
> 时间：2009-02-25T13:15:09.543
> 
> 标签：html, css, vertical-alignment

假设我有以下 CSS 和 HTML 代码：

```
#header {
  height: 150px;
}
```

```
<div id="header">
  <h1>Header title</h1>
  Header content (one or multiple lines)
</div>
```

标题部分的高度是固定的，但标题内容可能会发生变化。

我希望标题的内容与标题部分的底部垂直对齐，因此最后一行文本“粘”到标题部分的底部。

所以如果只有一行文本，它会像：

```
-----------------------------------------
| 标题
|
|
|
| 标题内容（产生一行）
-----------------------------------------

```

如果有三行：

```
-----------------------------------------
| 标题
|
| 标题内容（就是这样
| 很多东西，它完美
| 跨越三行）
-----------------------------------------

```

如何在 CSS 中做到这一点？

* * *

## 回答 #1

> 赞同：1455
> 
> 时间：2009-02-25T13:20:01.573

相对+绝对定位是您最好的选择：

```
#header {
  position: relative;
  min-height: 150px;
}

#header-content {
  position: absolute;
  bottom: 0;
  left: 0;
}

#header, #header * {
  background: rgba(40, 40, 100, 0.25);
}
```

```
<div id="header">
  <h1>Title</h1>
  <div id="header-content">And in the last place, where this might not be the case, they would be of long standing, would have taken deep root, and would not easily be extirpated. The scheme of revising the constitution, in order to correct recent breaches of it, as well as for other purposes, has been actually tried in one of the States.</div>
</div>
```

但是你可能会遇到问题。当我尝试它时，我遇到了出现在内容下方的下拉菜单的问题。它只是不漂亮。

老实说，对于垂直居中问题，以及项目的任何垂直对齐问题都不是固定高度，使用表格更容易。

示例：[您可以在不使用表格的情况下进行此 HTML 布局吗？](https://stackoverflow.com/questions/522928/can-you-do-this-html-layout-without-using-tables)

* * *

## 回答 #2

> 赞同：188
> 
> 时间：2014-08-25T20:46:03.663

如果您不担心旧版浏览器，请使用 flexbox。

父元素需要将其显示类型设置为 flex

```
div.parent {
  display: flex;
  height: 100%;
} 
```

然后将子元素的 align-self 设置为 flex-end。

```
span.child {
  display: inline-block;
  align-self: flex-end;
} 
```

这是我用来学习的资源： http: [//css-tricks.com/snippets/css/a-guide-to-flexbox/](http://css-tricks.com/snippets/css/a-guide-to-flexbox/)

* * *

## 回答 #3

> 赞同：185
> 
> 时间：2009-02-25T13:18:51.937

使用 CSS 定位：

```
/* Creates a new stacking context on the header */
#header {
  position: relative;
}

/* Positions header-content at the bottom of header's context */
#header-content {
  position: absolute;
  bottom: 0;
} 
```

正如[cletus 所指出](https://stackoverflow.com/questions/585945/how-to-align-content-of-a-div-to-the-bottom-with-css/585965#585965)的，您需要确定标头内容才能完成这项工作。

```
<span id="header-content">some header content</span>

<div style="height:100%; position:relative;">
    <div style="height:10%; position:absolute; bottom:0px;">bottom</div>
</div> 
```

* * *

## 回答 #4

> 赞同：136
> 
> 时间：2009-04-25T09:43:38.607

我使用这些属性并且它有效！

```
#header {
  display: table-cell;
  vertical-align: bottom;
} 
```

* * *

## 回答 #5

> 赞同：67
> 
> 时间：2014-07-18T17:11:31.187

在同一个问题苦苦挣扎了一段时间后，我终于找到了一个满足我所有要求的解决方案：

*   不需要我知道容器的高度。
*   与相对+绝对解决方案不同，内容不浮动在自己的层中（即，它通常嵌入到容器 div 中）。
*   跨浏览器（IE8+）工作。
*   实施简单。

解决方案只需要一个`<div>`，我称之为“对齐器”：

**CSS**

```
.bottom_aligner {
    display: inline-block;
    height: 100%;
    vertical-align: bottom;
    width: 0px;
} 
```

**html**

```
<div class="bottom_aligner"></div>
... Your content here ... 
```

这个技巧通过创建一个又高又瘦的 div 来实现，它将文本基线推到容器的底部。

这是一个完整的示例，可以实现 OP 的要求。我将“bottom_aligner”变厚变红，仅用于演示目的。

CSS：

```
.outer-container {
  border: 2px solid black;
  height: 175px;
  width: 300px;
}

.top-section {
  background: lightgreen;
  height: 50%;
}

.bottom-section {
  background: lightblue;
  height: 50%;
  margin: 8px;
}

.bottom-aligner {
  display: inline-block;
  height: 100%;
  vertical-align: bottom;
  width: 3px;
  background: red;
}

.bottom-content {
  display: inline-block;
}

.top-content {
  padding: 8px;
} 
```

HTML：

```
<body>
  <div class="outer-container">
    <div class="top-section">
      This text
      <br> is on top.
    </div>
    <div class="bottom-section">
      <div class="bottom-aligner"></div>
      <div class="bottom-content">
        I like it here
        <br> at the bottom.
      </div>
    </div>
  </div>
</body> 
```

![对齐底部内容](https://i.stack.imgur.com/8Eks6.jpg)

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2016-11-24T02:53:46.587

现代的方法是使用[**flexbox**](http://caniuse.com/#feat=flexbox)。请参见下面的示例。您甚至不需要包装`Some text...`到任何 HTML 标记中，因为直接包含在 flex 容器中的文本被包装在匿名 flex 项中。

```
header {
  border: 1px solid blue;
  height: 150px;
  display: flex;                   /* defines flexbox */
  flex-direction: column;          /* top to bottom */
  justify-content: space-between;  /* first item at start, last at end */
}
h1 {
  margin: 0;
}
```

```
<header>
  <h1>Header title</h1>
  Some text aligns to the bottom
</header>
```

如果只有一些文本并且您想垂直对齐到容器的底部。

```
section {
  border: 1px solid blue;
  height: 150px;
  display: flex;                   /* defines flexbox */
  align-items: flex-end;           /* bottom of the box */
}
```

```
<section>Some text aligns to the bottom</section>
```

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2017-04-24T04:31:32.623

```
display: flex;
align-items: flex-end; 
```

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2012-12-04T22:16:43.653

如果父/块元素的行高大于内联元素的行高，则内联或内联块元素可以与块级元素的底部对齐。*

标记：

```
<h1 class="alignBtm"><span>I'm at the bottom</span></h1> 
```

CSS：

```
h1.alignBtm {
  line-height: 3em;
}
h1.alignBtm span {
  line-height: 1.2em;
  vertical-align: bottom;
} 
```

*确保您处于标准模式

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2018-05-23T06:08:28.607

你可以简单地实现 flex

```
header {
  border: 1px solid blue;
  height: 150px;
  display: flex;                   /* defines flexbox */
  flex-direction: column;          /* top to bottom */
  justify-content: space-between;  /* first item at start, last at end */
}
h1 {
  margin: 0;
}
```

```
<header>
  <h1>Header title</h1>
  Some text aligns to the bottom
</header>
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2020-07-22T11:51:16.273

您可以使用以下方法：

```
.header-parent {
  height: 150px;
  display: grid;
}

.header-content {
  align-self: end;
}
```

```
<div class="header-parent">
  <h1>Header title</h1>
  <div class="header-content">
    Header content
  </div>
</div>
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2017-12-28T22:01:09.080

这是另一种使用 flexbox 但不使用**flex-end**进行底部对齐的解决方案。这个想法是将**h1**设置为`margin-bottom`auto**以**将剩余内容推到底部：

 ****```
#header {
  height: 350px;
  display:flex;
  flex-direction:column;
  border:1px solid;
}

#header h1 {
 margin-bottom:auto;
}
```

```
<div id="header">
  <h1>Header title</h1>
  Header content (one or multiple lines) Header content (one or multiple lines)Header content (one or multiple lines) Header content (one or multiple lines)
</div>
```

我们也可以`margin-top:auto`对文本执行相同的操作，但在这种情况下，我们需要将其包装在 a `div`or中`span`：

```
#header {
  height: 350px;
  display:flex;
  flex-direction:column;
  border:1px solid;
}

#header span {
 margin-top:auto;
}
```

```
<div id="header">
  <h1>Header title</h1>
  <span>Header content (one or multiple lines)</span>
</div>
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2014-02-20T17:55:09.030

如果您有多个动态高度项，请使用表格和表格单元格的 CSS 显示值：

**HTML**

```
<html>
<body>

  <div class="valign bottom">
    <div>

      <div>my bottom aligned div 1</div>
      <div>my bottom aligned div 2</div>
      <div>my bottom aligned div 3</div>

    </div>
  </div>

</body>
</html> 
```

**CSS**

```
html,
body {
  width: 100%;
  height: 100%;
}
.valign {
  display: table;
  width: 100%;
  height: 100%;
}
.valign > div {
  display: table-cell;
  width: 100%;
  height: 100%;
}
.valign.bottom > div {
  vertical-align: bottom;
} 
```

我在这里创建了一个 JSBin 演示：http: [//jsbin.com/INOnAkuF/2/edit](http://jsbin.com/INOnAkuF/2/edit)

该演示还有一个示例，如何使用相同的技术进行垂直居中对齐。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2021-03-23T05:37:29.510

将 div 移动到底部的最佳解决方案如下。基本上，您需要做的是将显示 flex 和 flex-direction 设置为父列，并为其子项添加一个“margin-top：auto”，该子项需要浮动到容器底部注意：我用过引导程序及其类。

```
.box-wrapper {
  height: 400px;
  border: 1px solid #000;
  margin: 20px;
  display: flex; // added for representation purpose only. Bootstrap default class is already added
  flex-direction: column;
}

.link-02 {
  margin-top: auto;
}
```

```
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" rel="stylesheet" />
<div class="box-wrapper d-flex flex-column col-4">
  <div>incidunt blanditiis debitis</div>
    <div class="news-box">
      <img class="d-block" alt="non ipsam nihil" src="https://via.placeholder.com/150">
      <p>Labore consectetur doloribus qui ab et qui aut facere quos.</p>
    </div>
  <a href="https://oscar.com" target="_blank" class="link-02">
    This is moved to bottom with minimal effort
  </a>
</div>
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2019-05-16T14:19:16.943

所有这些答案都对我有用……我不是 flexbox 专家，但这很容易弄清楚，它简单易懂和易于使用。要将某些内容与其余内容分开，请插入一个空 div 并让它增长以填充空间。

[https://jsfiddle.net/8sfeLmgd/1/](https://jsfiddle.net/8sfeLmgd/1/)

```
.myContainer {
  display: flex;
  height: 250px;
  flex-flow: column;
}

.filler {
  flex: 1 1;
} 
```

```
<div class="myContainer">
  <div>Top</div>
  <div class="filler"></div>
  <div>Bottom</div>
</div> 
```

当底部内容的大小不固定时，即使容器大小不固定，这也会按预期做出反应。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2015-02-06T12:49:56.950

为此，您不需要绝对+相对。很有可能使用容器和数据的相对位置。这就是你的做法。

假设您的数据高度将是`x`. 您的容器是相对的，页脚也是相对的。您所要做的就是添加到您的数据中

```
bottom: -webkit-calc(-100% + x); 
```

您的数据将始终位于容器的底部。即使您有具有动态高度的容器也可以使用。

**HTML会是这样的**

```
<div class="container">
  <div class="data"></div>
</div> 
```

**CSS会是这样的**

```
.container{
  height:400px;
  width:600px;
  border:1px solid red;
  margin-top:50px;
  margin-left:50px;
  display:block;
}
.data{
  width:100%;
  height:40px;
  position:relative;
   float:left;
  border:1px solid blue;
  bottom: -webkit-calc(-100% + 40px);
   bottom:calc(-100% + 40px);
} 
```

[现场示例在这里](http://cssdeck.com/labs/i6jrmpv2)

希望这可以帮助。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2016-06-07T20:33:12.933

这是灵活的方法。当然，IE8 不支持它，因为用户在 7 年前就需要它。根据您需要支持的内容，其中一些可以取消。

尽管如此，如果有一种方法可以在没有外部容器的情况下做到这一点，那就太好了，只需让文本在它自己的内部对齐即可。

```
#header {
    -webkit-box-align: end;
    -webkit-align-items: flex-end;
    -ms-flex-align: end;
    align-items: flex-end;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    height: 150px;
} 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2018-02-01T13:17:23.850

一个非常简单的单行解决方案是在 div 中添加 line-heigth，记住所有 div 的文本都会放在底部。

CSS：

```
#layer{width:198px;
       height:48px;
       line-height:72px;
       border:1px #000 solid}
#layer a{text-decoration:none;} 
```

HTML：

```
<div id="layer">
    <a href="#">text at div's bottom.</a>
</div> 
```

请记住，当您只希望 div 中的文本下降时，这是一个实用且快速的解决方案，如果您需要组合图像和内容，则必须编写更复杂和响应式的 CSS

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2021-03-03T15:16:36.630

*除了提到的其他 flex-box 解决方案之外：*

您可以`flex-grow: 1`在第一个 div 上使用。这样，您的第二个 div 将与底部对齐，而第一个 div 将覆盖所有剩余空间。

在父 div 上，您必须使用`display: flex`and `flex-direction: column`。

[![在此处输入图像描述](https://i.stack.imgur.com/cphU7.png)](https://i.stack.imgur.com/cphU7.png)

```
/* parent-wrapper div */
.container {
  display: flex;
  flex-direction: column;
}

/* first-upper div */
.main {
  flex-grow: 1;
} 
```

检查小提琴：[https ://jsfiddle.net/1yj3ve05/](https://jsfiddle.net/1yj3ve05/)

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-07-12T07:28:33.040

如果您可以设置内容的包装div的高度（#header-content如其他回复所示），而不是整个#header，也许您也可以尝试这种方法：

*HTML*

```
<div id="header">
    <h1>some title</h1>
    <div id="header-content">
        <span>
            first line of header text<br>
            second line of header text<br>
            third, last line of header text
        </span>
    </div>
</div> 
```

*CSS*

```
#header-content{
    height:100px;
}

#header-content::before{
  display:inline-block;
  content:'';
  height:100%;
  vertical-align:bottom;
}

#header-content span{
    display:inline-block;
} 
```

[在代码笔上显示](http://codepen.io/codeboyim/pen/pGxcs)

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-08-11T15:33:28.780

我设计了一种比上面提到的方法简单得多的方法。

设置标题 div 的高度。然后在其中设置`H1`标签的样式，如下所示：

```
float: left;
padding: 90px 10px 11px 
```

我正在为客户开发一个网站，设计要求文本位于某个 div 的底部。我已经使用这两行实现了结果，并且效果很好。此外，如果文本确实扩展，填充将保持不变。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-11-09T09:42:44.400

我发现这个解决方案基于默认的引导启动模板

```
/* HTML */

<div class="content_wrapper">
  <div class="content_floating">
    <h2>HIS This is the header<br>
      In Two Rows</h2>
    <p>This is a description at the bottom too</p> 
  </div>
</div>

/* css */

.content_wrapper{
      display: table;
      width: 100%;
      height: 100%; /* For at least Firefox */
      min-height: 100%;
    }

.content_floating{
  display: table-cell;
  vertical-align: bottom;
  padding-bottom:80px;

} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2017-10-22T23:56:59.087

```
#header {
    height: 150px;
    display:flex;
    flex-direction:column;
}

.top{
    flex: 1;
}   

<div id="header">
    <h1 class="top">Header title</h1>
    Header content (one or multiple lines)
</div> 
```

```
#header {
    height: 250px;
    display:flex;
    flex-direction:column;
    background-color:yellow;
}

.top{
    flex: 1;
}
```

```
<div id="header">
    <h1 class="top">Header title</h1>
    Header content (one or multiple lines)
</div>
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-01-21T03:46:31.793

尝试：

```
div.myclass { margin-top: 100%; } 
```

尝试更改 % 来修复它。示例：120% 或 90% ...等。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-10-15T07:35:23.360

我刚刚为客户做的网站要求页脚文本是一个高框，底部的文本我通过简单的填充实现了这一点，应该适用于所有浏览器。

```
<div id="footer">
  some text here
</div> 
```

```
#footer {
  padding: 0 30px;
  padding-top: 60px;
  padding-bottom: 8px;
} 
```

* * *

## 回答 #25

> 赞同：-4
> 
> 时间：2011-08-11T21:12:44.143

一个完美的跨浏览器示例可能是这里：

[http://www.csszengarden.com/?cssfile=/213/213.css&page=0](http://www.csszengarden.com/?cssfile=/213/213.css&page=0)

这个想法是既要在底部显示 div 又要让它粘在那里。通常，简单的方法会使粘性 div 与主要内容一起向上滚动。

以下是一个完全工作的最小示例。请注意，不需要 div 嵌入技巧。许多BR只是为了强制出现滚动条：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #floater {
            background: yellow;
            height: 200px;
            width: 100%;
            position: fixed;
            bottom: 0px;
            z-index: 5;
            border-top: 2px solid gold;
        }

    </style>
</head>

<body>
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>

    <div id="floater"></div>
</body>
</html> 
```

如果您想知道您的代码可能无法在 IE 上运行，请记住在顶部添加 DOCTYPE 标记。这在 IE 上工作是至关重要的。此外，这应该是第一个标签，其上方不应出现任何内容。

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2013-01-04T14:31:56.997

似乎正在工作：

```
#content {
    /* or just insert a number with "px" if you're fighting CSS without lesscss.org :) */
    vertical-align: -@header_height + @content_height;

    /* only need it if your content is <div>,
     * if it is inline (e.g., <a>) will work without it */
    display: inline-block;
} 
```

使用[less](http://lesscss.org)使得解决 CSS 难题更像是编码而不是......我只是喜欢 CSS。当您只需更改一个参数即可更改整个布局（而不破坏它:)，这是一种真正的乐趣。

* * *

## 回答 #27

> 赞同：-7
> 
> 时间：2015-01-10T22:56:34.647

2015年解决方案

```
<div style='width:200px; height:60px; border:1px solid red;'>

    <table width=100% height=100% cellspacing=0 cellpadding=0 border=0>
        <tr><td valign=bottom>{$This_text_at_bottom}</td></tr>
    </table>

</div> 
```

[http://codepen.io/anon/pen/qERMdx](http://codepen.io/anon/pen/qERMdx)

别客气

# ruby-on-rails - 如何在 Ruby on Rails 中实现语义本体？

> ID：585947
> 
> 赞同：1
> 
> 时间：2009-02-25T13:15:20.743
> 
> 标签：ruby-on-rails, ruby, database-design, semantics

我正在开发一个“twitter 过滤器”——更多地学习 ruby​​ on rails 而不是其他任何东西。这个想法是我使用语义本体来查找用户的兴趣。因此，如果用户说他们对“体育”感兴趣，这意味着标记任何讨论“体育”“高尔夫”“足球”等的推文。

不过，我希望能够将其扩展到任何层次的主题。因此，如果您对欧洲感兴趣，请标记欧洲的所有国家。

自然这是相当复杂的，所以也许我们会将其限制为一两个“级别”的查找......

我怎样才能有效地做到这一点？我非常熟悉 Java、C 和 Ruby，并且在 MySQL 方面做了很多工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T13:29:09.010

我会研究 Doug Lenat 的[Cyc](http://www.cyc.com/)。它已经完成并打开了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T04:03:54.337

我不确定你的要求是什么。但似乎[奇异值分解](http://www.igvita.com/2007/01/15/svd-recommendation-system-in-ruby/)(SVD) 或[支持向量机](http://www.igvita.com/2008/01/07/support-vector-machines-svm-in-ruby/)(SVM) 都适合您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T13:33:44.613

我不确定它是否会帮助你，但谷歌有一个叫做谷歌集的东西。您可以在这里查看：http: [//labs.google.com/sets](http://labs.google.com/sets)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:35:59.460

在考虑编程语言和技术之前，请先考虑一下：什么样的数据结构是“语义本体”？

对我来说，这听起来像是某种有[向图](http://en.wikipedia.org/wiki/Directed_graph)。

知道了这一点，您很快就会发现，用您想要的任何语言和技术来实现这样的结构都非常容易，而且许多语言已经实现了某种图形库（例如，用于 Ruby的[RGL ）。](http://rgl.rubyforge.org/rgl/index.html)

对我来说，真正的问题不是如何实现这样的数据结构以及如何有效地做到这一点，而是如何从 twitter 中获取构建它所需的语义信息（例如，谁告诉你的应用程序欧洲不是西班牙的一部分但是那个西班牙是欧洲的一部分？）。

无论如何，玩得开心，听起来是一个很酷的项目！:-)

# sharepoint - 从模板创建网站后与页面布局相关的 SharePoint 错误

> ID：585951
> 
> 赞同：1
> 
> 时间：2009-02-25T13:16:05.063
> 
> 标签：sharepoint, templates

在 SharePoint 内部，我之前通过将 _layouts/savetmpl.aspx 附加到我的网站末尾创建了一个网站模板，并且新网站已正确创建并按预期工作。

我现在又来做同样的事情了，但这次新站点抛出了与页面布局相关的错误。

错误是：

此页面未使用有效的页面布局。要更正此问题，请编辑页面设置并选择有效的页面布局。

当我尝试选择另一个时，只有一个可供选择。此页面布局正在其他站点上使用，并且它们呈现良好。

有没有其他人看到这个问题？

祝一切顺利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T18:59:49.167

首先，如果您将 _layouts/savetmpl.aspx 附加到 url，我想您在站点设置选项中没有它，因此您使用的是发布站点。这是因为 Microsoft 不支持此选项（在发布站点中另存为模板）。他们不支持它，因为它肯定有一些错误。

因此，我建议不要在重要站点中使用此选项，或者如果您计划将来向 Microsoft 寻求支持。

但是，该错误表明页面布局或其关联的内容类型（或父内容类型）未正确安装在网站集中。您是否使用自己的（自定义）内容类型？请确认相关内容类型的 ID（例如 0x0100C6739B7D12DE419aA2F9A2F96CC26818）在工作站点和非工作站点的页面布局中是否完全相同。

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T15:13:46.730

模板工作的网站/网站集是否与模板不工作的网站/网站集启用了所有相同的功能？

你能检查服务器日志吗？<12 配置单元>\LOGS

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T15:36:16.473

您是否添加了自定义页面布局，使用它，然后在保存模板时忘记选中“保存内容”复选框？

# globalization - 如何根据IP地址确定国籍？

> ID：585953
> 
> 赞同：0
> 
> 时间：2009-02-25T13:16:31.410
> 
> 标签：globalization, ip

如何根据客户端 ip 判断我网站用户的国籍？

编辑：就像评论一样，这个问题之前已经回答过：

[https://stackoverflow.com/questions/283016/know-a-good-ip-address-geolocation-service](https://stackoverflow.com/questions/283016/know-a-good-ip-address-geolocation-service)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T13:18:05.510

使用[GeoIP](http://www.maxmind.com/)数据库。有一个免费的。您还可以使用很多 GeoIP 网络服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T13:22:52.457

如果您正在考虑本地化，请让用户选择正确的语言而不是自动进行 - 或者至少为他们提供一种简单的方法来更改它并通过 cookie 使其具有粘性。大多数情况下，您可以使用 GeoIP 进行猜测，但有时您会弄错。即使我们在美国中部，谷歌有时也会将我的妻子发送到他们网站的德文版。使用匿名服务（如 TOR）也可能导致猜测错误。拥有选择权并将选择权保留在计算机上将为您的用户提供更好的体验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T13:53:28.123

除了已经提到的 GeoIP 数据库，您还可以使用[IP2LOCATION](http://www.ip2location.com/)服务。这是一个付费的，但它也可以工作。

请记住，所有这些服务都会为您提供位置估计，但不是非常准确的地理位置。我曾经读过一篇[网络论文，](http://www.cs.washington.edu/homes/jjohn/papers/geoloc.pdf)指出这是一项不可能完成的任务（给出 IP 地址的准确位置）。

# python - 关于 PyS60 中 Canvas 中的可选参数

> ID：585957
> 
> 赞同：0
> 
> 时间：2009-02-25T13:17:59.677
> 
> 标签：python, nokia, pys60

在[Python for Symbian60](http://wiki.opensource.nokia.com/projects/PyS60) blit() 中定义为：

blit(图像 [,target=(0,0), source=((0,0),image.size), mask=None, scale=0 ])

在可选参数source中image.size的意义是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T13:22:22.303

我的猜测是 blit() 将自动使用`image.size`您未指定任何其他内容时的结果（从而将整个图像从 (0,0) 到 (width,height)）。

如果您只想复制图像的较小部分，则可以使用 source 参数定义要复制的不同矩形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T11:18:58.810

认为 source=((0,0)) 是左上角，而 image.size 是右下角。你把这两点之间的任何东西都抹掉了。

顺便说一句，目标类似。

# database - 如何在 EJB 3 中为每个方法设置隔离级别

> ID：585968
> 
> 赞同：3
> 
> 时间：2009-02-25T13:20:25.427
> 
> 标签：database, jakarta-ee, ejb-3.0, isolation-level

是否可以为给定的 EJB 3 方法调用设置数据库隔离级别（即可序列化、可重复读取等）？

我知道这不在 EJB 规范中，因此如何在 JBoss 或 Glassfish 特定方式上执行此操作的详细信息会很棒。

我开始觉得这是不可能的，你只能为每个连接池设置它，这显然不是一个理想的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-03T03:05:15.840

这确实没有包含在规范中，但可以在支持时通过应用程序服务器特定的部署描述符进行配置。WebLogic 例如，您可以在以下方法级别指定事务隔离[`weblogic-ejb-jar.xml`](http://download.oracle.com/docs/cd/E13222_01/wls/docs81/ejb/DDreference-ejb-jar.html#1116259)：

> ## 例子
> 
> ```
> <transaction-isolation>
>   <isolation-level>...</isolation-level>
>   <method>
>       <description>...</description>
>       <ejb-name>...</ejb-name>
>       <method-intf>...</method-intf>
>       <method-name>...</method-name>
>       <method-params>...</method-params>
>   </method>
> </transaction-isolation> 
> ```

我不知道 JBoss 或 GlassFish 是否有等价物（我无法访问[SupportWLDDInContainers](http://wiki.glassfish.java.net/Wiki.jsp?page=SupportWLDDInContainers)页面以找到 GlassFish 的答案）。

作为替代方案，您是否尝试[`Connection#setTransactionIsolation(int)`](http://download-llnw.oracle.com/javase/6/docs/api/java/sql/Connection.html#setTransactionIsolation%28int%29)在给定的 EJB 方法中使用，即以编程方式配置隔离？

# c# - 这是 LINQ-to-SQL 的示例吗？

> ID：585969
> 
> 赞同：1
> 
> 时间：2009-02-25T13:20:56.173
> 
> 标签：c#, linq-to-sql, sql-server-ce

我用 SQL CE 数据库制作了一个小 WPF 应用程序。

我使用 LINQ 构建了以下代码以从数据库中获取数据，这非常容易。所以我想“这一定是 LINQ-to-SQL”。

然后我做了“添加项目”并添加了一个“LINQ-to-SQL 类”.dbml 文件，将我的表拖到对象关系设计器上，但它说，“所选对象使用了不受支持的数据提供程序。”

因此，我质疑以下代码是否真的是 LINQ-to-SQL，因为它确实允许我访问我的 SQL CE 数据库文件中的数据，但 SQL CE 似乎不支持官方的“LINQ-to-SQL”。

那么下面的“LINQ-to-SQL”是不是？

```
using System.Linq;
using System.Data.Linq;
using System.Data.Linq.Mapping;
using System.Windows;

namespace TestLinq22
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            MainDB db = new MainDB(@"Data Source=App_Data\Main.sdf");
            var customers = from c in db.Customers
                            select new {c.FirstName, c.LastName};
            TheListBox.ItemsSource = customers;
        }
    }

    [Database(Name = "MainDB")]
    public class MainDB : DataContext
    {
        public MainDB(string connection) : base(connection) { }
        public Table<Customers> Customers;
    }

    [Table(Name = "Customers")]
    public class Customers
    {
        [Column(DbType = "varchar(100)")]
        public string FirstName;

        [Column(DbType = "varchar(100)")]
        public string LastName;
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T13:25:03.857

是的，这就是 LINQ to SQL。它使用的`System.Data.Linq.DataContext`是 LINQ to SQL。听起来*设计*器不支持您的提供程序，但 LINQ to SQL 本身支持。

（或者设计师对你的连接字符串很挑剔，如果你稍微改变一下就会应付。这听起来很可能......）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T13:25:52.543

[此 msdn 文章](http://msdn.microsoft.com/en-us/library/bb546181.aspx)指出，虽然 LINQ to SQL 运行时支持 sdf，但设计器不支持它。

去引用：

*   LINQ to SQL 运行时和 SQLMetal 命令行工具支持 SQL Server Compact 3.5。
*   对象关系设计器不支持 SQL Server Compact 3.5。

# jquery - Jquery：从单个事件触发多个动作 - 或 -

> ID：585973
> 
> 赞同：0
> 
> 时间：2009-02-25T13:22:57.620
> 
> 标签：jquery, flot

我正在尝试使单个事件更新页面的两个部分。

如果您查看[http://eddowding.com/clients/stack/OverviewLite.php](http://eddowding.com/clients/stack/OverviewLite.php)，您可以通过单击并拖动一个区域来放大顶部图表。在发布时，此更新页面上的图表之一。我希望它能更新所有这些。

我认为这是一个 jquery 问题，而不是 flot 问题，并且怀疑 Fling（[http://www.command-tab.com/2008/12/04/jquery-fling/](http://www.command-tab.com/2008/12/04/jquery-fling/)）可能有答案。但我不太清楚如何应用它。（无论如何，我都不是 js 人..！）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T13:01:52.047

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Graph Hell!</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <script type="text/javascript" src="jquery/jquery-1.3.1.js"></script>
    <!--[if IE]><script language="javascript" type="text/javascript" src="jquery/flot/excanvas.pack.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="jquery/flot/jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="jquery/jquery.fling.js"></script>
</head>
<body>
    <script id="source" language="javascript" type="text/javascript">
        $(function () {
            var d = [
                [1196463600000, 500],
                [1196550000000, 0],
                [1196636400000, 0],
                [1196722800000, 77],
                [1196809200000, 3636],
                [1196895600000, 3575],
                [1196982000000, 2736],
                [1197068400000, 1086],
                [1197154800000, 676],
                [1197241200000, 1205],
                [1197327600000, 906],
                [1197414000000, 710],
                [1197500400000, 639],
                [1197586800000, 540],
                [1197673200000, 435],
                [1197759600000, 301],
                [1197846000000, 575],
                [1197932400000, 481],
                [1198018800000, 591],
                [1198105200000, 608],
                [1198191600000, 459],
                [1198278000000, 234],
                [1198364400000, 1352],
                [1198450800000, 686],
                [1198537200000, 279],
                [1198623600000, 449],
                [1198710000000, 468],
                [1198796400000, 392],
                [1198882800000, 282],
                [1198969200000, 208],
                [1199055600000, 229],
                [1199142000000, 177],
                [1199228400000, 374],
                [1199314800000, 436],
                [1199401200000, 404],
                [1199487600000, 253],
                [1199574000000, 218],
                [1199660400000, 476],
                [1199746800000, 462],
                [1199833200000, 448],
                [1199919600000, 442],
                [1200006000000, 403],
                [1200092400000, 204],
                [1200178800000, 194],
                [1200265200000, 327],
                [1200351600000, 374],
                [1200438000000, 507],
                [1200524400000, 546],
                [1200610800000, 482],
                [1200697200000, 283],
                [1200783600000, 221],
                [1200870000000, 483],
                [1200956400000, 523],
                [1201042800000, 528],
                [1201129200000, 483],
                [1201215600000, 452],
                [1201302000000, 270],
                [1201388400000, 222],
                [1201474800000, 439],
                [1201561200000, 559],
                [1201647600000, 521],
                [1201734000000, 477],
                [1201820400000, 442],
                [1201906800000, 252],
                [1201993200000, 236],
                [1202079600000, 525],
                [1202166000000, 477],
                [1202252400000, 386],
                [1202338800000, 409],
                [1202425200000, 408],
                [1202511600000, 237],
                [1202598000000, 193],
                [1202684400000, 357],
                [1202770800000, 414],
                [1202857200000, 393],
                [1202943600000, 353],
                [1203030000000, 364],
                [1203116400000, 215],
                [1203202800000, 214],
                [1203289200000, 356],
                [1203375600000, 399],
                [1203462000000, 334],
                [1203548400000, 348],
                [1203634800000, 243],
                [1203721200000, 126],
                [1203807600000, 157],
                [1203894000000, 288]
            ];

            var e = [
                [1196463600000, -500],
                [1196550000000, -0],
                [1196636400000, -0],
                [1196722800000, -77],
                [1196809200000, -3636],
                [1196895600000, -3575],
                [1196982000000, -2736],
                [1197068400000, -1086],
                [1197154800000, -676],
                [1197241200000, -1205],
                [1197327600000, -906],
                [1197414000000, -710],
                [1197500400000, -639],
                [1197586800000, -540],
                [1197673200000, -435],
                [1197759600000, -301],
                [1197846000000, -575],
                [1197932400000, -481],
                [1198018800000, -591],
                [1198105200000, -608],
                [1198191600000, -459],
                [1198278000000, -234],
                [1198364400000, -1352],
                [1198450800000, -686],
                [1198537200000, -279],
                [1198623600000, -449],
                [1198710000000, -468],
                [1198796400000, -392],
                [1198882800000, -282],
                [1198969200000, -208],
                [1199055600000, -229],
                [1199142000000, -177],
                [1199228400000, -374],
                [1199314800000, -436],
                [1199401200000, -404],
                [1199487600000, -253],
                [1199574000000, -218],
                [1199660400000, -476],
                [1199746800000, -462],
                [1199833200000, -448],
                [1199919600000, -442],
                [1200006000000, -403],
                [1200092400000, -204],
                [1200178800000, -194],
                [1200265200000, -327],
                [1200351600000, -374],
                [1200438000000, -507],
                [1200524400000, -546],
                [1200610800000, -482],
                [1200697200000, -283],
                [1200783600000, -221],
                [1200870000000, -483],
                [1200956400000, -523],
                [1201042800000, -528],
                [1201129200000, -483],
                [1201215600000, -452],
                [1201302000000, -270],
                [1201388400000, -222],
                [1201474800000, -439],
                [1201561200000, -559],
                [1201647600000, -521],
                [1201734000000, -477],
                [1201820400000, -442],
                [1201906800000, -252],
                [1201993200000, -236],
                [1202079600000, -525],
                [1202166000000, -477],
                [1202252400000, -386],
                [1202338800000, -409],
                [1202425200000, -408],
                [1202511600000, -237],
                [1202598000000, -193],
                [1202684400000, -357],
                [1202770800000, -414],
                [1202857200000, -393],
                [1202943600000, -353],
                [1203030000000, -364],
                [1203116400000, -215],
                [1203202800000, -214],
                [1203289200000, -356],
                [1203375600000, -399],
                [1203462000000, -334],
                [1203548400000, -348],
                [1203634800000, -243],
                [1203721200000, -126],
                [1203807600000, -157],
                [1203894000000, -288]
            ];

            // first correct the timestamps - they are recorded as the daily
            // midnights in UTC+0100, but Flot always displays dates in UTC
            // so we have to add one hour to hit the midnights in the plot
            for (var i = 0; i < d.length; ++i)
                d[i][0] += 60 * 60 * 1000;

            // helper for returning the weekends in a period
            function weekendAreas(axes) {
                var markings = [];
                var d = new Date(axes.xaxis.min);
                // go to the first Saturday
                d.setUTCDate(d.getUTCDate() - ((d.getUTCDay() + 1) % 7))
                d.setUTCSeconds(0);
                d.setUTCMinutes(0);
                d.setUTCHours(0);
                var i = d.getTime();
                do {
                    // when we don't set yaxis the rectangle automatically
                    // extends to infinity upwards and downwards
                    markings.push({
                        xaxis: {
                            from: i,
                            to: i + 2 * 24 * 60 * 60 * 1000
                        }
                    });
                    i += 7 * 24 * 60 * 60 * 1000;
                } while (i < axes.xaxis.max);

                return markings;
            }

            var options1 = {
                colors: ["#00ff00", "#ff0000"],
                xaxis: {
                    ticks: []
                },
                yaxis: {
                    ticks: []
                },
                selection: {
                    mode: "x"
                },
                lines: {
                    show: true,
                    lineWidth: 2
                },
                grid: {
                    markings: weekendAreas,
                    borderWidth: 0
                }
            };

            var options2 = {
                xaxis: {
                    mode: "time"
                },
                bars: {
                    show: true,
                    lineWidth: 5
                },
                yaxis: {
                    ticks: [],
                    min: -4000,
                    max: 5000
                },
                selection: {
                    mode: "x",
                    color: "#45A0DC"
                },
                grid: {
                    markings: weekendAreas,
                    borderWidth: 0
                }
            };

            var options3 = {
                lines: {
                    show: true,
                    lineWidth: 1
                },
                shadowSize: 0,
                xaxis: {
                    ticks: [],
                    mode: "time"
                },
                yaxis: {
                    ticks: [],
                    min: 0,
                    max: 4000
                },
                grid: {
                    markings: weekendAreas,
                    borderWidth: 0
                }
            };

            var plot = $.plot($("#placeholder"), [d, e], options1);

            var overviewMini = $.plot($("#overviewMini"), [d, e], {
                colors: ["#00ff00", "#ff0000"],
                legend: {
                    show: true,
                    container: $("#overviewLegend")
                },
                lines: {
                    show: true,
                    lineWidth: 2
                },
                shadowSize: 0,
                xaxis: {
                    ticks: [],
                    mode: "time"
                },
                yaxis: {
                    ticks: [],
                    min: -4000,
                    max: 4000
                },
                selection: {
                    mode: "x",
                    color: "#45A0DC"
                },
                grid: {
                    markings: weekendAreas,
                    borderWidth: 0
                }
            });

            var datesOnly = $.plot($("#datesOnly"), [d, e], options2);

            var salary = $.plot($("#salary"), [d], options3);

            var plotType = 0;

            // now for the binding between the graphs

            $("#placeholder").bind("plotselected", function (event, ranges) {
                // do the zooming
                // don't fire event on the incomeMini to prevent eternal loop
                overviewMini.setSelection(ranges, true);
                zoomGraphs(ranges);
            });

            $("#datesOnly").bind("plotselected", function (event, ranges) {
                // do the zooming

                // don't fire event on the incomeMini to prevent eternal loop
                overviewMini.setSelection(ranges, true);
                zoomGraphs(ranges);
            });

            $("#salary").bind("plotselected", function (event, ranges) {
                // do the zooming
                // don't fire event on the incomeMini to prevent eternal loop
                overviewMini.setSelection(ranges, true);
                zoomGraphs(ranges);
            });

            $("#overviewMini").bind("plotselected", function (event, ranges) {
                zoomGraphs(ranges);
            });

            function zoomGraphs(ranges) {
                $.plot($("#datesOnly"), [d, e],
                    $.extend(true, {}, options2, {
                        xaxis: {
                            min: ranges.xaxis.from,
                            max: ranges.xaxis.to
                        }
                    }));

                $.plot($("#placeholder"), [d, e],
                    $.extend(true, {}, options1, {
                        xaxis: {
                            min: ranges.xaxis.from,
                            max: ranges.xaxis.to
                        }
                    }));

                $.plot($("#salary"), [d, e],
                    $.extend(true, {}, options3, {
                        xaxis: {
                            min: ranges.xaxis.from,
                            max: ranges.xaxis.to
                        }
                    }));
            }
        });
    </script>
    <div id="overviewMini" style="width:400px;height:50px"></div>
    <div id="datesOnly" style="width:400px;height:100px;"></div>
    <div id="placeholder" style="width:400px;height:100px;"></div>
    <div id="salary" style="width:400px;height:50px;"></div>
</body>
</html> 
```

感谢 YellowLabs.nl 的 Sean 和 #jquery IRC ！！！

# dependencies - gnu make 的依赖问题

> ID：585977
> 
> 赞同：2
> 
> 时间：2009-02-25T13:23:42.237
> 
> 标签：dependencies, makefile, gnu

我面临着一个相当奇怪的问题。我的制作文件包含：

```
all: item1 item2

item1: dep1 dep2
dep1:
    @echo
    cd $(HOME)/apps; /bin/rm -f $(D_ALL_OBJECTS) 
    cd $(SRCHOME)/fusionapps; make -k -f $(SOMEMAKEFILE) $(D_ALL_OBJECTS)
    @echo
dep2:
    @echo
    cd $(HOME)/apps; /bin/rm -f $(D2_ALL_OBJECTS) 
    cd $(SRCHOME)/fusionapps; make -k -f $(SOMEMAKEFILE) $(D2_ALL_OBJECTS)
    @echo
item2: ...
..... 
```

现在，" `make -f Makefile item1`" 有效，但是当我尝试 " `make -f Makefile all`" 时它不起作用。你们看到我的makefile有什么问题吗？

谢谢

* * *

*附录*：

好吧，看起来 make 不允许与当前级别中的某个目录具有相同名称的目标。观察：

*   “all”是一个目录@$(HOME)/apps
*   `all1: item1 item2`作品
*   `all: item1 item2`不工作

因此，任何与目录具有相同名称的目标名称似乎都失败了（例如，没有做任何有用的事情）。

我很确定我在这里做了一些荒谬的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T13:57:02.453

当你写：

```
all: item1 item2 
```

然后请求`make all`，它告诉`make`：

*   找到一个名为的文件系统对象`all`，并确保它所依赖的所有内容 ( `item1`, `item2`) 都是最新的。
*   如果`all`文件系统对象中的任何一个不存在或已过期`item1`，`item2`则执行指定的操作（在此示例中没有），然后考虑`all`更新。
*   如果`all`是目录，则存在。如果它最近被修改过，它将是最新的。

使用建议`.PHONY: all item1 item2`对 GNU Make 有好处；它不适用于`make`.

不要使用作为目录名称的目标名称 - 除非您确定自己知道自己在做什么。并使用`.PHONY`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T13:35:18.667

尝试[虚假声明](http://www.gnu.org/software/make/manual/make.html#Phony-Targets)您的所有目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T13:48:15.127

看起来 make 不允许与当前级别中的某个目录具有相同名称的目标。观察：

-"all" 是一个目录@ $(HOME)/apps -all1/2/3: item1 item2 works -all: item1 item2 不起作用，任何与目录同名的目标名称也是如此。

我很确定我在这里做任何荒谬的错误。

# analytics - 点击日志或分析中的路径？

> ID：585986
> 
> 赞同：0
> 
> 时间：2009-02-25T13:25:22.577
> 
> 标签：analytics, logging, breadcrumbs, click-through

我试图查看我的用户通过我拥有的网络应用程序单击时所采用的路径。我在服务器端有日志、awstats 和 webalizer，我正在寻找安装某种分析产品。我在我的日志文件中看不到任何面包屑/点击路径数据。我错过了吗？除此之外，有哪些分析产品（雅虎、谷歌等）可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:33:51.323

我相信[谷歌分析](http://www.google.com/analytics/)通过网站覆盖来支持这一点，该覆盖显示用户在每个页面上点击了哪些链接。我不认为它会针对每个用户进行跟踪，但是站点覆盖可以让您很好地了解用户通常如何浏览您的站点。

无论如何，我强烈推荐 Google Analytics - 超级容易设置并且非常强大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T15:51:27.363

Woopra 可以在报告中实时显示点击路径。它使用颜色来显示反弹（红色）和弹出链接（绿色）。缺点：仅在 Beta 版中免费，您的订阅请求可能需要一段时间才能获得批准。Google Analytics 会汇总出入口路径和跳出率的报告，但它无法在个人用户层面显示出像 Woopra 这样令人信服的画面。

[![Woopra 点击率](https://i.stack.imgur.com/fHz1B.jpg)](https://i.stack.imgur.com/fHz1B.jpg)
[（来源：[heeroz.com](http://heeroz.com/woopra1.jpg)）]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-03T18:59:44.953

您可以尝试[GAVisual](http://gavisual.info)一个用于 Google Analytics 的小工具，它可以通过波浪（逐页）可视化向您显示用户路径。它使用之前收集的您网站的 GA 数据。

# java - 人们必须编写自己的类加载器的原因是什么

> ID：585991
> 
> 赞同：24
> 
> 时间：2009-02-25T13:27:26.830
> 
> 标签：java, classloader

我最近在一次采访中被问及加载类时调用类加载器的顺序。

不幸的是，我从来不需要编写自己的类加载器，所以当时不熟悉类加载的复杂性。

这让我想知道，他们编写自己的类加载器的原因是什么。

所以这就是我的问题：**人们面临哪些需要编写自己的类加载器的场景？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-25T16:28:44.180

我目前正在开发一个高度模块化的超大型应用程序，即它由数百个 JAR 文件组成。这意味着 classpath 字符串变得*巨大*，导致各种地方出现各种问题，因为各种开发工具无法处理 5KB 的 classpath 字符串。这是通过编写一个从文件中读取其类路径的自定义类加载器来解决的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-25T13:31:43.560

典型的原因是您的应用程序托管了其他应用程序，这些应用程序在同一运行时（例如 Tomcat）中使用不同版本的相同库。因此，您必须确保您的类加载器可以为每个应用程序提供同一类的不同版本。

**编辑**：

为了澄清这一点（见评论中的混淆）：当说“你的类加载器”时，我提到“一个实现`java.lang.ClassLoader`”而不是这样一个类的实例。实际上，这两种含义都是您的类加载器**：** Tomcat 人员实现了不同的`ClassLoader`类，并且在运行时拥有更多实例……有关详细信息，请参阅[相应的文档](http://tomcat.apache.org/tomcat-5.5-doc/class-loader-howto.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T17:05:30.190

当他们不得不维护我的代码时，无聊和折磨我的同事的愿望。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T16:17:10.463

有些地方实际上将类存储在数据库中（曾经有一些地方，不确定是否还有），并使用类加载器在运行时从数据库中获取类。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T13:32:22.980

当我想从 .jar 文件中加载 .jar 文件中的类时，我不得不实现一个 ClassLoader（这是几年前的事，我敢肯定现在有工具可以为你做到这一点）。即，您可以将依赖项 .jar 文件放入一个 .jar 文件中。

但这是唯一一次，根据我的经验，编写自定义 ClassLoader 是一件非常罕见的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T13:14:05.217

我遇到了[一篇文章](http://java.dzone.com/articles/osgi-primer)，它讨论了为什么（非常简短地）OSGI 使用自定义类加载器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T13:36:17.103

看看这个[问题](https://stackoverflow.com/questions/540150/java-class-loaders)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-30T06:31:12.730

您可以在不停机的情况下进行软件发布，就像 24x7 运行系统中的情况一样。
您可以从 JMX 编写自己的类加载器调用，并在运行时替换类文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T17:01:19.810

我们有一个应用程序框架，该框架具有基于它的“静态绑定”应用程序。这意味着您需要为每个要运行的应用程序拥有一个 jvm 实例，这不仅不利于内存使用，而且意味着您无法拥有一个超级应用程序来启动各种应用程序，或者任何简单的（非进程间）正在运行的应用程序之间的通信。

由于整个事情是从 webstart 运行的（即使用一堆 jar 作为类路径），防止系统类加载器找到类的解决方案是偏移包。例如，如果您`a.b.X`在应用程序 foo 中有一个类，那么它将在 jar 文件中作为`foo/a/b/X.class`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T21:57:15.170

在我的上一份工作中，我们实现了一个可以具有“插件逻辑查询定义”的服务器。（客户端可以按名称调用查询，服务器查找该名称的注册查询并运行它）。

查询定义是 jar 中包含的代码和/或元数据。

jar 通过我们的控制台应用程序上传到服务器。

上传时（以及稍后服务器重新启动时），我们的框架将为 jar 创建一个类加载器，以将其加载到正在运行的服务器中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-20T15:38:06.800

我在 [这里](http://ourownjava.com/java/how-to-write-a-custom-class-loader-in-java.)看到了一个很好的帖子。它讨论了不同的类加载器、类加载器层次结构和自定义类加载器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-27T15:39:35.177

我曾经这样做过。我们必须使用第三方供应商提供的 API，而这个 API 使用了一个奇怪的 hibernate3.jar 版本。因此，我们必须使用自定义类加载器加载这个特定的 jar，以避免“串行版本 UID”异常。

# .net - 字典 默认按按键排序？

> ID：585992
> 
> 赞同：11
> 
> 时间：2009-02-25T13:27:47.313
> 
> 标签：.net, dictionary

我正在使用 a[`Dictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/yt2fy5zk.aspx)并且在我的测试中我得到了一些奇怪的，虽然有些可以理解的行为。

无论我在调用时将条目添加到字典中的顺序如何，键都会按照键类型的实现[`Dictionary.Keys`](http://msdn.microsoft.com/en-us/library/yt2fy5zk.aspx)指定的顺序返回。[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)

这对我有好处，因为无论如何我都想按顺序获得它们，但是我找不到任何地方指定它们应该并且将始终以这种方式返回。因此，我不知道是要依赖它总是这样，还是对[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)我正在构建的对象进行（可能是多余的）排序。

我可以依赖这种行为吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-25T13:30:17.510

您不能依赖此行为。这只是一个巧合，可能是由于您的样本大小或 GetHashCode 实现。一旦您将足够的项目添加到表中并强制进行足够的重新散列，则不会订购密钥。

MSDN 明确表示未指定密钥的顺序（[http://msdn.microsoft.com/en-us/library/yt2fy5zk.aspx）](http://msdn.microsoft.com/en-us/library/yt2fy5zk.aspx)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-25T13:31:17.570

您正在寻找[SortedDictionary`<K,V>`](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)。字典`<K,V>`使用散列，对于小集合，散列可能看起来与排序相似。************