# StackOverflow 问答 10504000-10504999

# batch-file - 批处理脚本，重新格式化 cli 应用程序的输出

> ID：10504003
> 
> 赞同：3
> 
> 时间：2012-05-08T18:05:08.280
> 
> 标签：batch-file, formatting

我有一个非常小的批处理脚本，它正在提取大量文件。该脚本旨在与压缩数据一起交付给其他用户。

现在我的问题是这个压缩工具正在将大量数据输出到 cmd 窗口中。我认为这会让很多用户感到困惑，因为输出真的是“正在运行”。它基本上显示了每行的百分比以及它如何以何种速度（CPU 和 HDD）解压缩。很多令人困惑的数据，没有人需要看到。现在我真的不喜欢抑制程序的所有输出，在我看来，向用户提供关于减压已经达到多远的反馈很重要。那么是否可以重定向输出并仅读取该输出的前三位并在一行中将其传递给用户？所以用户只看到一个前进的百分比（一行），而不是每秒有 20 条新行的所有这些数据？

这里是它目前的外观示例：http: [//i.imgur.com/5w5LH.png](http://i.imgur.com/5w5LH.png) 压缩工具是 SREP，我的操作系统 Win 7 x64。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:35:21.327

如果你使用windows批处理，它可以完成，但这并不简单，因为你通常会用FOR/F-Loop来做这件事。

像`for /f "delims=" %%a in (`7z packit ...`) do ...`
问题就在这里，for-loop 将首先收集所有数据并等待结束，`7z`然后再处理任何输出行。

唯一的方法是重定向输出，并同时扫描它。
但要做到这一点，您需要第二个线程（最好在同一个 cmd 窗口中）。

像这样的东西可以完成这项工作

```
@echo off
echo start
setlocal EnableDelayedExpansion
if "%1"=="internal" goto :readThread
start /b cmd /c ""%~f0" internal"

rem *** myPacker pack here and redirect the output
del archive.7z
del output.tmp
start "title" /b /wait cmd /c  "%ProgramFiles%\7-Zip\7z" u  archive \tempx\*.rtf \tempx\*.pdf ^> output.tmp
echo EOF>>output.tmp
echo ENDE
:waitForEnd
(
> lock (
  rem
) || goto :waitForEnd
) 2> nul
exit /b

:readThread

for /f %%a in ('copy /Z "%~dpf0" nul') do set "CR=%%a"
echo ####!cr!x
echo(
<output.tmp ( 
    echo ## before
    call :readData 2> lock
    echo after
)
exit /b

:readData
set "var="
set /p var=
if "!var!"=="EOF" exit /b
if defined var (
  <nul set /p ".=Processing files, currently at !var:~0,4!!CR!"
)
goto :readData 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T19:11:34.187

这是一个简单的混合批处理/JScript 脚本，我认为它可以满足您的需求。

**show3.bat**

```
@if (@X)==(@Y) @end /* harmless hybrid line that begins a JScrpt comment

::: Batch part ::::
@cscript //nologo //e:JScript "%~f0"
@exit /b

*** JScript part ***/
while( !WScript.StdIn.AtEndOfStream ) {
  WScript.StdOut.Write( '\x08\x08\x08' + WScript.StdIn.ReadLine().substr(0,3) );
}
WScript.StdOut.WriteLine(); 
```

*用法：*

```
yourCommand | show3 
```

该脚本可以简化为纯 JScript，但使用起来就不那么方便了：

**show3.js**

```
while( !WScript.StdIn.AtEndOfStream ) {
  WScript.StdOut.Write( '\x08\x08\x08' + WScript.StdIn.ReadLine().substr(0,3) );
}
WScript.StdOut.WriteLine(); 
```

*用法：*

```
yourCommand | cscript //nologo show3.js 
```

* * *

***编辑***正如 jeb 评论的那样，您不需要任何 redist 即可使用此解决方案。

我采用了 jeb 的回答中的一些概念，并将整个过程组合成一个混合脚本。不需要独立的“show3”文件。

```
@if (@X)==(@Y) @end /* harmless hybrid line that begins a JScrpt comment

:: ***** Batch part ******
@echo off

REM whatever batch code you need goes here

yourCommand | cscript //nologo //e:JScript "%~f0"

REM whatever batch code you need goes here

exit /b

****** JScript part ******/
while( !WScript.StdIn.AtEndOfStream ) {
  WScript.StdOut.Write( '\x08\x08\x08' + WScript.StdIn.ReadLine().substr(0,3) );
}
WScript.StdOut.WriteLine(); 
```

`yourCommand`将是您使用的任何压缩命令。`yourCommand 2>&1`根据您的评论，如果您想要的输出打印到标准错误而不是标准输出，听起来您可能必须使用。

我创建了一个“yourCommand.bat”文件用于测试目的。它粗略地模拟了您为压缩程序描述的输出行为。

```
@echo off
for /l %%A in (1 1 100) do (
  echo %%A   "I don't want to see this quoted text"
  for /l %%B in (1 1 50000) do rem
) 
```

最后，如果你真的想要一个纯批处理的解决方案，我大大简化了jeb的解决方案。我删除了临时文件并使用了管道。

```
@echo off
if "%~1"==":show3" goto :show3
REM whatever batch code you need goes here

(yourCommand & echo EOF) | "%~f0" :show3

REM whatever batch code you need goes here
exit /b

:show3
setlocal enableDelayedExpansion
for /f %%a in ('copy /Z "%~dpf0" nul') do set "CR=%%a"
:read
set "ln="
set /p "ln="
if not defined ln goto :read
for /f "tokens=1* delims= " %%A in ("!ln!") do if "%%A%%B" equ "EOF" (
  echo(
  exit /b
)
<nul set /p "=!ln:~0,3!   !cr!"
goto :read 
```

***编辑***-*我修改了 EOF 测试以忽略任何前导或尾随空格。这应该使代码更加健壮。*

# desire2learn - Desire2Learn Valence API 版本参数

> ID：10504006
> 
> 赞同：1
> 
> 时间：2012-05-08T18:05:12.240
> 
> 标签：desire2learn

在发出 Desire2Learn Valence API 请求时，如果我们要支持 LMS 9.4.1 和 10.x，(D2LVERSION: version) 参数需要是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:25:51.410

这些是“API 合同版本”，它们因产品组件（功能区域）而异。有[总结](http://docs.valence.desire2learn.com/about.html#versions-and-migration) ，也有[更详细的解释](http://docs.valence.desire2learn.com/basic/version.html)。

实际上，您将需要一种“最小最大”过程。您应该在您想要支持的最旧的产品组件版本上寻找最新的 API 合同版本。API 合约版本比产品组件版本持续时间更长，一个产品组件可以同时支持多个 API 合约。

# clips - CLIPS：检索事实并获得指向它的指针

> ID：10504009
> 
> 赞同：1
> 
> 时间：2012-05-08T18:05:30.730
> 
> 标签：clips

我正在使用嵌入在 C 程序中的 CLIPS，因此我必须通过 C 函数调用来完成所有操作，并且不能使用 CLIPS 命令行。

假设我已经断言了一些这样的事实：

```
AssertString("(pizza 1)");
AssertString("(cauliflower 7)");
AssertString("(cheesecake 0)"); 
```

显然，此时我没有得到（更不用说保留）任何指向我的事实的指针。当我想稍后通过使用来撤回一个事实时`Retract(factPtr)`，我显然需要指向我想要撤回的事实的指针。那么，在上述几行之后，我将如何`(cauliflower 7)`再次找到事实并获得指向它的指针？

我是否必须通过 获取整个事实列表`GetFactList([...])`，遍历它并比较字符串？如果是这样，我将如何在`DATA_OBJECT`这个函数返回的多字段中做到这一点？或者，还有更好的方法？

我将不胜感激任何想法甚至代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T19:36:07.870

您可以使用事实查询函数来查询事实列表并执行操作。您可以通过 EvalFunction 调用它：

```
DATA_OBJECT result;

Eval("(do-for-all-facts ((?f pizza)) (eq ?f:implied (create$ 1)) (retract ?f))",&result);
Eval("(do-for-all-facts ((?f cauliflower)) TRUE (retract ?f))",&result); 
```

在第一次调用中，只有值为 1 的比萨事实被撤回。在第二次调用中，所有花椰菜事实都被撤回。

# postgresql - 加密 PostgreSQL 数据库并从 Web 应用程序用户获取密钥

> ID：10504011
> 
> 赞同：1
> 
> 时间：2012-05-08T18:05:34.847
> 
> 标签：postgresql, encryption

我想创建一个使用 PostgreSQL 作为数据库的 Web 应用程序。我希望对数据库进行加密，这样即使是对数据库服务器具有 root 访问权限的攻击者也无法解密数据（或者至少他将不得不处理临时内存中的数据，这很*困难*）。我不关心架构，只关心表的内容。

我也不想将解密密钥存储在应用程序服务器上的某个位置（既不在配置文件中，也不在硬编码中）。

相反，我的想法是使用用户通过 Web 应用程序提供并在运行时解密的密钥来加密整个数据库（或者只是表和行？）。

PostgreSQL 是否可以实现这种情况，我有哪些选项可以实现这一点？

*旁注：这是一个基于 .NET 的应用程序 (ASP.NET MVC3)，我使用的是 Npsql 驱动程序。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:43:49.663

使用[pgcrypto](http://www.postgresql.org/docs/current/static/pgcrypto.html)进行加密。但是，超级用户可以控制日志文件并告诉数据库记录所有内容，每次查询。这将包括查询，包括您的密码。

您可能想要使用 SELinux 和[SEPostgreSQL](http://wiki.postgresql.org/wiki/SEPostgreSQL_Documentation)。

# django - 为什么 Django 会阻止同一会话中的同时请求？

> ID：10504012
> 
> 赞同：3
> 
> 时间：2012-05-08T18:05:37.133
> 
> 标签：django, session, concurrency

我试图`sleep(30)`在我的视图的第一行添加。之后，我在两个浏览器选项卡中打开了这个页面。第一个标签页在 30 秒后加载，第二个标签页在 60 秒后加载。与此同时，我能够从另一台电脑打开页面就好了。所以看起来 Django 阻止了来自同一个客户端的并发请求。

这对我的应用程序来说非常好。而且我想确保我的网站将来会以这种方式工作。但是我没有找到任何描述这种 Django 行为的文档或文章。所以我仍然不确定这是一个功能还是只是运气。有人可以解释一下这是如何以及为什么起作用的吗？

我真正需要的是在视图处理时阻止会话。当然我可以使用一些标志或数据库事务。但我不想添加已经在 Django 中实现的功能。

我使用 python 2.6.5、django 1.4、ubuntu 服务器、nginx 和 uwsgi。尝试了 postgresql 和 sqlite。

我的 uwsgi 设置：

```
<uwsgi>
    <pythonpath>/home/admin/app/src</pythonpath>
    <app mountpoint="/">
        <script>deploy.wsgi</script>
    </app>
    <workers>4</workers><!-- Not sure this is needed -->
    <processes>2</processes>
</uwsgi> 
```

我也用 runserver 命令得到了同样的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T12:22:11.270

实际上 Django 不会阻止同时请求。

如果我使用相同的会话运行两个浏览器（例如 chrome 和 firefox）（通过将 sessionid cookie 从第一个浏览器复制到第二个浏览器），则不会发生阻塞。所以，这是一个浏览器功能，无论如何它与 Django 无关。这意味着我仍然需要自己添加一些阻塞功能以确保代码安全。

# image - 使用数据 URI 方案和 img 标签的攻击

> ID：10504016
> 
> 赞同：2
> 
> 时间：2012-05-08T18:05:51.293
> 
> 标签：image, security, data-uri

是否有人知道在用户提供内容的地方使用 <img src="data:xxxxx"> 存在任何安全问题？假设内容已经过验证，因此它适合数据 URI 的格式，因此它不能脱离标签，并且也仅限于图像 mime 类型。

[http://en.wikipedia.org/wiki/Data_URI_scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:09:10.910

肯定会涉及不同的代码，但它可能不会比普通的 img 链接更容易受到攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:40:54.077

我认为这应该是安全的。由于图像的数据 URI 语法非常严格：

```
data:image/<subtype>;base64,<base64-stream> 
```

它很容易验证（参见例如[RegEx 来解析或验证 Base64 数据](https://stackoverflow.com/a/475217/53114)）。

我能想到的唯一漏洞是解析/渲染图像的组件中的一个漏洞。

# css - 如何在这个 CMS 生成的 html 结构中使用 css 创建背景图像？

> ID：10504018
> 
> 赞同：0
> 
> 时间：2012-05-08T18:05:54.567
> 
> 标签：css

我正在使用 Drupal 视图并将其设置为显示内容正文和图像字段。生成的html结构是

```
<div>
     <span>  content body </span>
     <span class='background-image'> <img src= my-image-address > </span> 
```

如果可能的话，我想使用 CSS 将图像作为背景图像放置在 div 中。显示器将图像放置在内容主体的下方。有没有办法将其重新设置为 div 背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:28:35.617

不使用普通的旧 CSS，但是如果您可以将一些 jQuery 混合使用，您可以通过定位来设置它，`$('.background-image').parent('div')`然后使用`.css()`或添加一个类 with `.addClass()`on parent `<div>`。

# backbone.js - 保存后backbone.js不更新模型对象的ID，为什么不呢？

> ID：10504023
> 
> 赞同：9
> 
> 时间：2012-05-08T18:06:47.307
> 
> 标签：backbone.js

我一直在尝试backbone.js，当我创建一个新的模型对象然后调用model.save() 时遇到了困难。我期待backbone.js默认行为使用数据库中的id更新模型对象，但事实并非如此。这不应该发生吗？我已经验证我收到了一个带有 json 格式属性的帖子。我的服务器将 json 保存到一个表中，然后将带有新 id 字段的 json 返回到backbone.js。这个对吗？我的服务器应该返回整个新对象还是只返回 id 或什么？

```
//contents of the POST from backbone.js
  { "text":"this is a test" }

//reply from my server
  { id:"15", text:"this is a test"  } 
```

我的示例代码如下

```
var SQLRow = Backbone.Model.extend({
 table:"",
 urlRoot:'db',
 url:function () {
    return "/" + this.urlRoot + "?table=" + this.table + 
                 "&id=" + this.attributes.id;
   }
});

var Xtra = SQLRow.extend ({
   table:'Xtra'
});

var row = new Xtra({
  text: "this is a test" 
});

alert(row.url());
row.save()
alert("row:" + row.get("id")); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T18:15:21.057

很难从你的帖子中看出。两个想法：

1）来自服务器的响应不成功你的保存调用返回什么？

2）您的“id”属性被命名为 ID 以外的名称。要考虑不同的名称，请将以下内容添加到您的模型中：

```
 idAttribute  : "MyModelsID", 
```

**编辑**

您可能会遇到时间问题，即在 ID 返回之前触发警报。而不是你的最后两行试试这个：

```
row.save( null, 
              { 
                 success : function(model, response) { alert(model.get('id'); } 
               }
         ); 
```

**选择**

正如@mu_is_too_short 提到的，另一种方法是即使在模型上也能监听变化并响应事件。（我只是试图让答案尽可能接近您的代码）。但是像下面的*伪代码*应该让你开始......

```
var myView = Backbone.View.extend({
           ....
           initialize : function () {
                this.collection.bind('change',  this.SOME_LISTENING_FUNC    );

             }
  }); 
```

或者，如果你在一个收集/无视图的世界中，这样的东西会创建一个监听器......

```
row.on('change',  function() {  /* do stuff */ }, this); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-10T21:42:42.973

该答案基于上述答案中Cjolly 的[一条评论。](https://stackoverflow.com/users/1036289/cjolly)

对于`Backbone.Model.save([attributes],[options])`成功地将模型与来自服务器的新生成模型的 id 进行关联至关重要，服务器`id`在 JSON 字符串中返回模型，如下所示`{ "id" : <the id> }`。（注意它是`"id"`而不是`id`）。

本质上，主干正确地期望一个 JSON 字符串，与在没有引用键的 Javascript 中如何定义对象相反，**JSON 需要引用对象键**（请参阅[JSON 规范 - 键是否必须用引号括起来？](https://stackoverflow.com/questions/949449/json-spec-does-the-key-have-to-be-surrounded-with-quotes)）

由于根据 Cjolly 的评论，这是基本问题，我想在第二个答案中强调这个解决方案。部分原因是我遇到了同样的问题，只有通过阅读评论，我才能获得洞察力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T10:17:45.617

我遇到了同样的问题，我发现我`validate`保存的模型的功能实际上使从后端返回的模型无效。这就是为什么我的字段没有正确更新的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-03T12:13:05.530

也许它有点过时了，但今天我有同样的失踪 id。事实证明，服务器只是发送一个包含新 id 的重定向的标头“位置”，但不返回持久对象。将对象添加到响应中是解决方案。看起来，不返回对象是 Roo(Spring) 生成的 Json-Controllers 的标准行为。

# python - Web 编程中的 Python 线程

> ID：10504027
> 
> 赞同：3
> 
> 时间：2012-05-08T18:07:05.453
> 
> 标签：python, thread-safety

我在 Web 应用程序中面临潜在的竞争条件：

```
# get the submissions so far from the cache
submissions = cache.get('user_data')
# add the data from this user to the local dict
submissions[user_id] = submission

# update the cached dict on server
submissions = cache.update('user_data', submissions)

if len(submissions) == some_number:
    ... 
```

逻辑很简单，我们首先获取存储在 web 服务器缓存中的共享字典，将提交（由每个请求传递到服务器）添加到其本地副本，然后我们通过将其替换为更新的本地副本来更新缓存副本复制。最后，如果我们收到一定数量的数据，我们会做其他事情。请注意

```
submissions = cache.update('user_data', submissions) 
```

将从缓存中返回最新的字典副本，即新更新的字典。

因为服务器可能同时服务多个请求（每个请求在自己的线程中），并且所有这些线程都访问缓存中的共享字典，如上所述，从而产生潜在的竞争条件。

我想知道，在 Web 编程的上下文中，我应该如何**有效地**处理线程以防止在这种特殊情况下出现竞争条件，**而不会牺牲太多的性能**。一些代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:24:05.633

我首选的解决方案是拥有一个修改提交字典的线程和一个为该线程提供数据的队列。如果你是偏执狂，你甚至可以在提交的字典上公开一个只读视图。使用队列和消费者模式，您不会遇到锁定问题。

当然，这假设您有一个可以让您创建该线程的 Web 框架。

编辑：多进程不是一个好建议；删除。

编辑：这种东西在 Python 中非常简单：

```
import threading, Queue

Stop = object()

def consumer(real_dict, queue):
    while True:
        try:
            item = queue.get(timeout=100)
            if item == Stop:
                break
            user, submission = item
            real_dict[user] = submission
        except Queue.Empty:
            continue

q = Queue.Queue()
thedict={}

t = threading.Thread(target=consumer, args=(thedict,q,))
t.start() 
```

然后，您可以尝试：

```
>>> thedict
{}
>>> q.put(('foo', 'bar'))
>>> thedict
{'foo': 'bar'}
>>> q.put(Stop)
>>> q.put(('baz', 'bar'))
>>> thedict
{'foo': 'bar'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:26:40.947

您似乎在 Web 应用程序和缓存之间来回传输大量数据。这*已经*是个问题了。你的怀疑也是对的，因为模式*可能*是这样的（记住这`sub`是每个线程的本地）：

```
线程 A 线程 B 缓存
------------------------------------------
                                [A]=P，[B]=Q
子 = 得到（）
   [A]=P，[B]=Q
>>>> 暂停
                子 = 得到（）
                   [A]=P，[B]=Q
                子[B] = Y
                   [A]=P，[B]=Y
                更新（子）
                                [A]=P，[B]=Y
                >>>> 暂停
子[A] = X
   [A]=X，[B]=Q
更新（子）
                                [A]=X, [B]=Q!!!!!!!

```

这种模式可能会真实发生，并导致状态消失。这也是低效的，因为线程 A 通常只需要了解其当前用户，而不是所有内容。

虽然你可以通过大量的锁定来解决这个问题，但这将是非常低效的。因此，您需要重新设计，以便传输更少的数据，这将提高性能并减少您需要的锁定量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:49:16.090

这是更难回答的问题之一，因为它似乎是一个更大的设计问题。

这个问题的一个潜在解决方案是有一个明确定义的地方来更新它。例如，您可能希望设置另一个专门用于更新缓存的服务，而不是其他服务。或者，如果这些更新对时间不敏感，您可能还需要考虑使用任务队列。

另一种解决方案：您可以给每个项目一个单独的密钥，并将密钥列表存储在一个单独的密钥下。这不一定能*解决*问题，但它确实使它更易于管理。您不必担心单独的线程会覆盖整个提交缓存，而只需担心它们会覆盖其中的单个元素。

如果您有时间为您的基础架构添加一个新部分，我强烈建议您查看[Redis](http://redis.io)，更具体地说是[Redis 哈希](http://degizmo.com/2010/03/24/redis-relations-in-a-nosql-world-using-hashes/)[1]。原因是 Redis 开箱即用地处理了这个问题，其速度与使用 memcache 获得的速度大致相同（尽管我绝对鼓励您自己进行基准测试）。

[1] 注意：我只是通过快速谷歌搜索找到了这个链接，还没有验证它。我不保证它的正确性。

# yii - Yii - 如何让 Yii 重新发布到资产文件夹

> ID：10504031
> 
> 赞同：6
> 
> 时间：2012-05-08T18:07:13.847
> 
> 标签：yii, assets

易问。

在我的开发机器上，应用程序所需的 JQuery 文件位于 assets 文件夹下的子文件夹中。但是，当我将应用程序复制到我的测试服务器时，yii 查找的文件夹中缺少 JQuery 文件。我不断收到诸如'../assets/db0e5a94/jquery.ba-bbq.js' 404 not found 等错误。

我清空了资产文件夹，现在我的所有 CSS 文件等都被报告丢失。有什么办法可以让 Yii 重新发布到资产文件夹？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T09:15:15.723

只需删除资产文件夹中的所有子目录并清除浏览器缓存。不要删除资产目录，否则您将不得不再次设置写入权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-28T07:01:04.430

在**components/Controller.php**中添加以下函数：

```
protected function beforeAction($action){
    if(defined('YII_DEBUG') && YII_DEBUG){
        Yii::app()->assetManager->forceCopy = true;
    }
    return parent::beforeAction($action);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T06:04:13.290

要求您的托管服务提供商在 php.ini 中禁用 SAFE_MODE。然后删除 asstes 目录及其子文件和文件夹并重新创建它。确保将刚刚创建的新目录的 CHMOD 设置为 0777。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-26T12:51:05.807

我也有同样的问题。将各自的文件上传到服务器后，我将服务器中的文件权限更改为 755。然后它起作用了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T18:23:57.687

恢复资产的一种简单方法是手动将它们从`framework`目录中复制回来。我知道这不是最好的方法，但是在您找到更好的解决方案时它应该可以帮助您。

# vb.net - 如何在 VB.NET 中将字符串转换为十六进制？

> ID：10504034
> 
> 赞同：4
> 
> 时间：2012-05-08T18:07:29.923
> 
> 标签：vb.net

如何将文本框中的字符串转换为十六进制？

我只在 C# 中找到了方法。VB.NET 有能力做这样的事情吗？如果可以，那么我想知道如何将字符串转换为十六进制和十六进制到字符串。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T18:16:33.203

```
Dim val As String
val = "10"
Dim hexVal As Integer
hexVal = Convert.ToInt32(val, 16) //16 specifies the base
Console.WriteLine(hexVal) 
```

这将显示 16，它是十六进制字符串“10”的整数等价物。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T18:25:52.613

您可以通过执行以下操作轻松地将整数转换为十六进制数：

```
Convert.ToInt32(15, 16) 
```

并将其转换回整数，您可以执行以下操作：

```
Integer.Parse("15f", System.Globalization.NumberStyles.HexNumber) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T18:19:43.887

```
Public Function StrToHex(ByRef Data As String) As String
    Dim sVal As String
    Dim sHex As String = ""
    While Data.Length > 0
        sVal = Conversion.Hex(Strings.Asc(Data.Substring(0, 1).ToString()))
        Data = Data.Substring(1, Data.Length - 1)
        sHex = sHex & sVal
    End While
    Return sHex
End Function 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-02-19T08:45:09.650

**久经考验的代码**

通过复制粘贴来创建此功能。

```
Function StringToHex(ByVal text As String) As String
    Dim hex As String
    For i As Integer = 0 To text.Length - 1
        hex &= Asc(text.Substring(i, 1)).ToString("x").ToUpper
    Next
    Return hex
End Function 
```

像这样使用它

```
Debug.WriteLine(StringToHex("sim0n")) 
```

[来源](https://sim0n.wordpress.com/2009/03/28/vbnet-string-to-hex-conversion/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-08T18:21:29.670

要转换为十六进制，请使用`Convert.ToInt32(val, 16)`. Convert.ToInt32 支持有限的基数，2、8、10 和 16。

要转换为任何基础，请使用：

```
Public Shared Function IntToString(value As Integer, baseChars As Char()) As String
    Dim result As String = String.Empty
    Dim targetBase As Integer = baseChars.Length

    Do
        result = baseChars(value Mod targetBase) + result
        value = value / targetBase
    Loop While value > 0

    Return result
End Function 
```

上述功能来自[this question](https://stackoverflow.com/questions/923771/quickest-way-to-convert-a-base-10-number-to-any-base-in-net)。C# 到 VB 的转换是[使用这个](http://converter.telerik.com/).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-10T07:09:21.073

可以使用 LINQ 编写**以十六进制形式****显示 String 的所有字符的`s`**简短有效的表达式：

```
String.Join(" ", s.Select(Function(c) Conversion.Hex(AscW(c)).PadLeft(4, "0")).ToArray())) 
```

**例子：**

对于 string`► fix`它给出 string `25BA 0020 0066 0069 0078`。

享受！

请记住，这是**启用 Unicode 的**，为每个字符返回 4 位十六进制值，因为旧的普通非 Unicode ASCII 已死，您不应再在任何应用程序中依赖它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-12T13:26:33.667

在我看来，Tilak 的代码看起来不错，但不是。**value / targetBase**
的四舍五入给出了太大的结果。 通过使用**Fix()**得到的整数将是它们应该的样子。 我赞扬 Tilak 为这个问题找到了如此巧妙的解决方案。

 ****在随附的代码中，我将展示如何轻松测试 IntToString 之类的函数。

消息框中的预期消息是：

旧的结果是；
0 1 10 101 100 101 1010 1001 1000 1001 1010
0 1 1X 10 11 1XX 1X0 1X1 10X 100 101
0 1 X 1y 10 11 XX Xy X0 X1 XX
0 1 X 1y 1z X0 11 1X Xy
结果是新的；
0 1 10 11 100 101 110 111 1000 1001 1010
0 1 X 10 11 1X X0 X1 XX 100 101
0 1 X y 10 11 1X 1y X0 X1 XX
0 1 X yz 10 11 1X 1y 1z X0
恕我直言，新结果更好。

```
Public Sub test()
    Dim numberCharacters As String = "01Xyz"
    Dim messageText As String = "The old results are;" & vbNewLine
    For loopCount As Integer = 1 To 2
        If loopCount = 2 Then messageText &= "The new results are;" & vbNewLine
        For baseLength As Integer = 2 To 5
            Dim baseCharacters As Char() = _
                Strings.Left(numberCharacters, baseLength).ToArray
            For integerValue As Integer = 0 To 10
                Dim resultText As String = _
                    Me.IntToString(integerValue, baseCharacters, loopCount = 2)
                messageText &= resultText & " "
            Next
            messageText &= vbNewLine
        Next
    Next
    Call MsgBox(berichtTekst & "The new results are better IMHO.")
End Sub

Public Function IntToString(value As Integer, baseChars As Char(), _
        Optional newCode As Boolean = False) As String
    Dim result As String = String.Empty
    Dim targetBase As Integer = baseChars.Length
    Do
        result = baseChars(value Mod targetBase) & result
        If newCode Then ' Improved code
            value = Fix(value / targetBase)
        Else ' Original code
            value = value / targetBase
        End If
    Loop While value > 0
    Return result
End Function 
```

希望这对其他人有帮助。

我有超过 25 年的程序员经验，主要是 RPG、Cobol、Synon、CL 和 Basic。我也知道一些 Delphi、Pascal 和 C#。我相信我可以为这个社区提供帮助。
我无法对答案发表评论，这让我感到难过。希望有人能给我加分，这样我以后可以更轻松地帮助别人。
因此，我将我的评论添加到 2012 年 5 月 8 日的 Tilak 的答案中，作为答案。这是我第一次也希望是唯一一次这样做。很抱歉，但我不知道其他方法。****

# ios - UIWebView 可以成为 iOS 中的“立即购买”选项还是违反 TOS？

> ID：10504038
> 
> 赞同：0
> 
> 时间：2012-05-08T18:08:01.547
> 
> 标签：ios, xcode, uiwebview, in-app-purchase

我有一个为客户显示产品的应用程序。用户可以选择单击“立即购买”按钮，该按钮会弹出 UIWebView 并加载指向客户端网站的链接，允许用户在不离开应用程序的情况下完成交易，但当我开始考虑这个时，我是好奇这是否违反了 Apple TOS

11.2 应用程序使用除应用内购买 API (IAP) 之外的系统来购买应用程序中的内容、功能或服务将被拒绝

由于用户购买的是产品而不是内容、功能或服务，这是对 UIWebView 的可接受使用，还是会导致应用被拒绝？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:10:02.610

只要您销售实物商品（例如，像亚马逊橱窗购物者应用程序），就允许这样做

# objective-c - Objective c 动画 UIbutton 像 mac os x 上的停靠效果

> ID：10504042
> 
> 赞同：2
> 
> 时间：2012-05-08T18:08:20.307
> 
> 标签：objective-c, ios5, dock, uianimation

我正在开发应用程序，其中显示了一些带有一些按钮的内容列表。当我触摸按钮时，我需要一种停靠类型的动画，然后单击停靠按钮事件应该被触发。当我触摸另一个按钮时，这个按钮应该停靠。我见过以下类似 [http://praastitutki2012.wordpress.com/2009/11/23/mac-osx-dock-like-animation-for-iphone/](http://praastitutki2012.wordpress.com/2009/11/23/mac-osx-dock-like-animation-for-iphone/) 但是，在这里我需要创建一个单独的视图来处理这个。但我只需要一些按钮，而不是整个视图。有什么建议么 ？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:59:44.320

我没有详细检查您链接的代码，但实际上a`UIButton` *是*`UIView`. 您可以考虑子类化`UIButton`并实现这些方法。这样，动画整个视图就意味着动画按钮。

# c++ - 在没有外部库的情况下正确地将 utf-16 文本文件读入字符串？

> ID：10504044
> 
> 赞同：8
> 
> 时间：2012-05-08T18:08:23.237
> 
> 标签：c++, winapi, unicode, utf-16

我从一开始就一直在使用 StackOverflow，并且有时很想发布问题，但我总是自己想出来或者最终找到答案......直到现在。这*感觉*应该相当简单，但我已经在互联网上徘徊了几个小时没有成功，所以我转向这里：

我有一个非常标准的 utf-16 文本文件，混合了英文和中文字符。我希望这些字符以字符串结尾（从技术上讲，是一个 wstring）。我已经看到很多*相关*的问题得到了回答（这里和其他地方），但他们要么正在寻求解决在不知道编码的情况下读取任意文件的更困难的问题，要么在编码之间进行转换，或者只是对“Unicode”感到困惑" 是一系列编码。我知道我要读取的文本文件的来源，它始终是 UTF16，它有一个 BOM 和一切，它可以保持这种状态。

我一直在使用[此处](http://cfc.kizzx2.com/index.php/reading-a-unicode-utf16-file-in-windows-c)描述的解决方案，该解决方案适用于全英文文本文件，但在遇到某些字符后，它停止读取文件。我发现的唯一其他建议是使用[ICU](http://site.icu-project.org/)，这可能会起作用，但我真的不想在分发应用程序中包含整个大型库，而只是在一个地方读取一个文本文件。不过，我不关心系统独立性——我只需要它在 Windows 中编译和工作。不依赖该事实的解决方案会*更漂亮*，当然，但我会很高兴有一个使用 stl 的解决方案，同时依赖于关于 Windows 体系结构的假设，甚至是涉及 win32 函数或 ATL 的解决方案；我只是不想包含另一个像 ICU 这样的大型 3rd 方库。除非我想自己重新实现它，否则我是否仍然完全不走运？

编辑：对于这个特定的项目，我坚持使用 VS2008，所以 C++11 代码很遗憾无济于事。

编辑2：我意识到我之前借用的[代码并没有像我想象的那样在非英文字符上失败。](http://cfc.kizzx2.com/index.php/reading-a-unicode-utf16-file-in-windows-c)相反，它在我的测试文档中的特定字符上失败，其中包括'：'（FULLWIDTH COLON，U+FF1A）和'）'（FULLWIDTH RIGHT PARENTHESIS，U+FF09）。bames53 发布的解决方案也大多有效，但被那些相同的字符难住了吗？

编辑 3（以及答案！）：我一直使用的原始代码 - 大部分都可以工作 - 正如 bames53 帮助我发现的那样，只需要以二进制模式打开 ifstream 就可以工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T18:25:55.680

C++11 解决方案（据我所知，自 2010 年以来，Visual Studio 在您的平台上支持）将是：

```
#include <fstream>
#include <iostream>
#include <locale>
#include <codecvt>
int main()
{
    // open as a byte stream
    std::wifstream fin("text.txt", std::ios::binary);
    // apply BOM-sensitive UTF-16 facet
    fin.imbue(std::locale(fin.getloc(),
       new std::codecvt_utf16<wchar_t, 0x10ffff, std::consume_header>));
    // read     
    for(wchar_t c; fin.get(c); )
            std::cout << std::showbase << std::hex << c << '\n';
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-09T03:30:52.343

当您为 UTF-16 打开文件时，您*必须*以二进制模式打开它。这是因为在文本模式下，某些字符会被特殊解释 - 具体来说，0x0d 被完全过滤掉，0x1a 标志着文件的结尾。有一些 UTF-16 字符将这些字节之一作为字符代码的一半，并且会弄乱文件的读取。这不是一个错误，它是故意的行为，并且是拥有单独的文本和二进制模式的唯一原因。

关于 0x1a 被认为是文件结尾的原因，请参阅[Raymond Chen 的这篇博客文章，](http://blogs.msdn.com/b/oldnewthing/archive/2004/03/16/90448.aspx)追溯 Ctrl-Z 的历史。它基本上是向后兼容运行异常。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-08T20:04:29.737

## 编辑：

因此，问题似乎在于 Windows 在文本模式下将某些魔术字节序列视为文件的结尾。这可以通过使用二进制模式读取文件来解决，`std::ifstream fin("filename", std::ios::binary);`然后像您已经做的那样将数据复制到 wstring 中。

* * *

* * *

最简单的非便携式解决方案是将文件数据复制到 wchar_t 数组中。这取决于 Windows 上的 wchar_t 是 2 个字节并使用 UTF-16 作为其编码的事实。

* * *

以完全可移植的方式将 UTF-16 转换为特定于语言环境的 wchar_t 编码会有些困难。

这是标准 C++ 库中可用的 unicode 转换功能（尽管 VS 10 和 11 只实现了第 3、4 和 5 项）

1.  `codecvt<char32_t,char,mbstate_t>`
2.  `codecvt<char16_t,char,mbstate_t>`
3.  编码cvt_utf8
4.  codecvt_utf16
5.  codecvt_utf8_utf16
6.  c32rtomb/mbrtoc32
7.  c16rtomb/mbrtoc16

以及每个人的作用

1.  始终在 UTF-8 和 UTF-32 之间转换的编解码器方面
2.  在 UTF-8 和 UTF-16 之间转换
3.  根据目标元素的大小在 UTF-8 和 UCS-2 或 UCS-4 之间转换（BMP 之外的字符可能会被截断）
4.  在使用 UTF-16 编码方案和 UCS-2 或 UCS-4 的字符序列之间进行转换
5.  在 UTF-8 和 UTF-16 之间转换
6.  如果定义了宏`__STDC_UTF_32__`，这些函数会在当前语言环境的字符编码和 UTF-32 之间进行转换
7.  如果定义了宏`__STDC_UTF_16__`，这些函数会在当前语言环境的字符编码和 UTF-16 之间进行转换

如果`__STDC_ISO_10646__`已定义，则直接使用转换`codecvt_utf16<wchar_t>`应该没问题，因为该宏指示所有语言环境中的 wchar_t 值对应于 Unicode 宪章的短名称（因此意味着 wchar_t 大到足以容纳任何此类值）。

不幸的是，没有任何定义直接从 UTF-16 到 wchar_t。可以使用 UTF-16 -> UCS-4 -> mb (if `__STDC_UTF_32__`) -> wc，但是您会丢失任何在语言环境的多字节编码中无法表示的内容。当然，无论如何，从 UTF-16 转换为 wchar_t 都会丢失任何在语言环境的 wchar_t 编码中无法表示的内容。

* * *

所以它可能不值得移植，相反，您可以将数据读入 wchar_t 数组，或使用其他一些 Windows 特定工具，例如文件上的 _O_U16TEXT 模式。

这应该可以在任何地方构建和运行，但需要做出一系列假设才能真正起作用：

```
#include <fstream>
#include <sstream>
#include <iostream>

int main ()
{
    std::stringstream ss;
    std::ifstream fin("filename");
    ss << fin.rdbuf(); // dump file contents into a stringstream
    std::string const &s = ss.str();
    if (s.size()%sizeof(wchar_t) != 0)
    {
        std::cerr << "file not the right size\n"; // must be even, two bytes per code unit
        return 1;
    }
    std::wstring ws;
    ws.resize(s.size()/sizeof(wchar_t));
    std::memcpy(&ws[0],s.c_str(),s.size()); // copy data into wstring
} 
```

您可能至少应该添加代码来处理字节序和“BOM”。此外，Windows 换行符不会自动转换，因此您需要手动进行转换。

# python - 使用 PyQt 的带有线程的终端

> ID：10504045
> 
> 赞同：2
> 
> 时间：2012-05-08T18:08:23.723
> 
> 标签：python, pyqt, pyqt4, pyserial

我正在尝试构建一个 PyQt 应用程序，该应用程序（除其他外）能够通过 QTextEdit 框像串行终端程序（HyperTerminal、TeraTerm 等）一样运行。我已经阅读了 PySerial 页面中的一些示例和我想我已经设法让接收数据线程正常工作，但可能效率不高。

我的问题是如何获取 QTextEdit 框中最后输入的字符并将其发送到串行连接？我尝试使用 QTextEdit 发出的 textChanged 信号，但它会发送我输入的所有内容以及它接收到的所有内容。我已经尝试在我的主 GUI 类中设置一个 eventFilter，但我无法弄清楚如何将它传递给另一个文件中的串行函数。我是否想要一个单独的线程来监听从 eventFilter 发出的信号？我怎么做？有没有更优雅的方法来做到这一点？

我确定我只是想多了，解决方案很简单，但我有点挣扎。我将附上相关的代码片段（不是完整的代码集），也许有人可以指出我正确的方向。如果有人还认为我正在做的线程可以以更有效的方式完成，那么也请转发给我！

感谢任何人都可以提供的任何帮助！

主文件：

```
import sys
from PyQt4 import QtGui
from MainGUI import TestGUI
from SerialClasses import *
from SerialMiniterm import *

class StartMainWindow(QtGui.QMainWindow):      
    def __init__(self, parent=None):
        super(StartMainWindow, self).__init__(parent)
        self.ui = TestGUI()
        self.ui.setupUi(self)    
        self.ui.serialTextEditBox.installEventFilter(self)

    def eventFilter(self, source, event):
        if (event.type() == QtCore.QEvent.KeyPress and source is self.ui.serialTextEditBox):
            # print some debug statements to console
            if (event.key() == QtCore.Qt.Key_Tab):
                print ('Tab pressed')
            print ('key pressed: %s' % event.text())
            print ('code pressed: %d' % event.key())
            # do i emit a signal here?  how do i catch it in thread?
            self.emit(QtCore.SIGNAL('transmitSerialData(QString)'), event.key())
            return True
        return QtGui.QTextEdit.eventFilter(self, source, event)   

    def serialConnectCallback(self):
        self.miniterm = SerialMiniterm(self.ui, self.SerialSettings)
        self.miniterm.start()
        temp = self.SerialSettings.Port + 1
        self.ui.serialLabel.setText("<font color = green>Serial Terminal Connected on COM%d" % temp) 

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    app.setStyle("Cleanlooks")
    myapp = StartMainWindow()
    myapp.show()
    sys.exit(app.exec_()) 
```

SerialMiniterm.py：

```
import serial
from PyQt4 import QtGui, QtCore

def character(b):
    return b

class SerialMiniterm(object):
    def __init__(self, ui, SerialSettings):
        self.SerialSettings = SerialSettings
        self.ui = ui
        self.serial = serial.Serial(self.SerialSettings.Port, self.SerialSettings.BaudRate, parity=self.SerialSettings.Parity, rtscts=self.SerialSettings.RTS_CTS, xonxoff=self.SerialSettings.Xon_Xoff, timeout=1)
        self.repr_mode = self.SerialSettings.RxMode
        self.convert_outgoing = self.SerialSettings.NewlineMode
        self.newline = NEWLINE_CONVERISON_MAP[self.convert_outgoing]
        self.dtr_state = True
        self.rts_state = True
        self.break_state = False

    def _start_reader(self):
        """Start reader thread"""
        self._reader_alive = True
        self.receiver_thread = ReaderThread(self.alive, self._reader_alive, self.repr_mode, self.convert_outgoing, self.serial)
        self.receiver_thread.connect(self.receiver_thread, QtCore.SIGNAL("updateSerialTextBox(QString)"), self.updateTextBox)
        self.receiver_thread.start()

    def _stop_reader(self):
        """Stop reader thread only, wait for clean exit of thread"""
        self._reader_alive = False
        self.receiver_thread.join()

    def updateTextBox(self, q):
        self.ui.serialTextEditBox.insertPlainText(q)
        self.ui.serialTextEditBox.moveCursor(QtGui.QTextCursor.End)
        #print "got here with value %s..." % q

    def start(self):
        self.alive = True
        self._start_reader()
        # how do i handle transmitter thread?

    def stop(self):
        self.alive = False

    def join(self, transmit_only=False):
        self.transmitter_thread.join()
        if not transmit_only:
            self.receiver_thread.join()

class ReaderThread(QtCore.QThread):       
    def __init__(self, alive, _reader_alive, repr_mode, convert_outgoing, serial, parent=None):
        QtCore.QThread.__init__(self, parent)
        self.alive = alive
        self._reader_alive = _reader_alive
        self.repr_mode = repr_mode
        self.convert_outgoing = convert_outgoing
        self.serial = serial

    def __del__(self):
        self.wait()

    def run(self):
        """loop and copy serial->console"""
        while self.alive and self._reader_alive:
            data = self.serial.read(self.serial.inWaiting())
            if data:                            #check if not timeout
                q = data
                self.emit(QtCore.SIGNAL('updateSerialTextBox(QString)'), q) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:42:13.717

像这样的东西？

```
from PyQt4 import QtCore, QtGui
app = QtGui.QApplication([])

class Terminal(QtGui.QPlainTextEdit):
    def keyPressEvent(self, event):
        print event.text()
        return QtGui.QPlainTextEdit.keyPressEvent(self, event)

term = Terminal()
term.show() 
```

# android - 在 Android 的 Grid View 中标记所有图像

> ID：10504050
> 
> 赞同：0
> 
> 时间：2012-05-08T18:08:39.947
> 
> 标签：android, gridview

我正在使用教程[http://vikaskanani.wordpress.com/android-custom-gallery-and-instant-upload-project/中提到的代码](http://vikaskanani.wordpress.com/android-custom-gallery-and-instant-upload-project/)

在这个项目中，除了选择按钮，我如何添加标记所有复选框？这样它会标记缩略图中的所有复选框，然后我可以单击选择，这样它将选择所有缩略图......有人可以帮我吗？

我也在帖子下方发表了相同的评论，但看起来作者没有注意到它。所以在这里问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:37:05.993

要在单击一个按钮后自动检查所有图像，您只需将图像数组列表的每个项目的值更改为 true。

```
 **public ArrayList<ImageItem> images = new ArrayList<ImageItem>();** 
```

与适配器的初始化方法一样，您正在从媒体准备整个数组列表，但要选择所有图像复选框，请将数组列表中每个 ImageItem 的选择值更改为 true，然后调用此方法**adapter.notifydatasetchanged()**。这肯定会奏效。

# c# - User32.dll FindWindow 渲染视频 C#

> ID：10504060
> 
> 赞同：0
> 
> 时间：2012-05-08T18:09:19.263
> 
> 标签：c#, .net

我有一个启动视频聊天客户端（Tandberg Movi）的应用程序。加载客户端后，它会通过以下方式将视频输出窗口转储到面板中

```
[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

var hwnd = FindWindow(null, "Video");
SetParent(hwnd, panel4.Handle); 
```

现在窗口出现了，但视频流丢失并被白色背景替换。我错过了什么吗？这行不通吗？还有其他想法吗？

# jquery - 如何使用 JQUERY 在更改事件上启用下拉菜单？

> ID：10504062
> 
> 赞同：-1
> 
> 时间：2012-05-08T18:09:33.223
> 
> 标签：jquery

我的表单由标题中的复选框和下拉列表以及页面主要内容中的几个下拉列表组成。在页面加载时，我希望禁用所有下拉菜单。选中复选框后，我希望启用标题下拉菜单。如果用户在标题下拉列表中选择一个选项，则所有其他下拉列表都应变为可选状态。最后，如果再次单击标题中的复选框，则应再次禁用所有下拉菜单。

这是我尝试过的代码：

**HTML**：

```
Header:
<br /><input type="checkbox" name="approve" />
<select id="myddl" name="myddl">
    <option value="1">One</option>
    <option value="2">Twooo</option>
    <option value="3">Three</option>
</select>
<div class="detail">
    <p>Detail</p>
        <br />
    <select id="Select1" name="myddl"  >
        <option value="1">One</option>
        <option value="2">Twooo</option>
        <option value="3">Three</option>
    </select>
    <br />
    <select id="Select2" name="myddl"  >
        <option value="1">One</option>
        <option value="2">Twooo</option>
        <option value="3">Three</option>
    </select>
    <br />
    <select id="Select3" name="myddl"  >
        <option value="1">One</option>
        <option value="2">Twooo</option>
        <option value="3">Three</option>
    </select>
    <br />
    <select id="Select4" name="myddl"  >
        <option value="1">One</option>
        <option value="2">Twooo</option>
        <option value="3">Three</option>
    </select>
<br />
    <select id="Select5" name="myddl" >
        <option value="1">One</option>
        <option value="2">Twooo</option>
        <option value="3">Three</option>
    </select>    
</div> 
```

**Javascript**：

```
 $('.detail').find('select').attr("disabled"); 

$("#myddl").change(function()
{  $('.detail').find('select').removeAttr("disabled"); 
     $('.detail').find('select').val($(this).val());

}); 
```

**[现场演示](http://jsfiddle.net/abuhamzah/8SpTk/5/)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:12:40.117

```
var drops = $('.detail select');
var $header = $('#myddl');
$('input[name="approve"]').change(function() {
    $header.prop('disabled', !this.checked);

    if (!this.checked) {
        drops.prop('disabled', true);
    }
});

drops.add($header).prop('disabled', true);

$header.change(function() {
    drops.prop('disabled', false);
});​ 
```

[**现场演示**](http://jsfiddle.net/gdoron/8SpTk/18/)

请注意，此代码缓存`select`元素，因此不需要多次查询 dom。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:12:17.973

这就是您要查找的内容：

```
var $ddls = $('select');
var $check = $('#check');
var $ddlHeader = $("#myddl");
var $ddlDetails = $('.detail select');

$ddls.prop("disabled", true); 

$check.click(function() {
    $ddls.prop("disabled", true); 
    $ddlHeader.prop("disabled", !this.checked);
});

$ddlHeader.change(function() {  
    $ddlDetails.removeAttr("disabled"); 
}); 
```

[演示](http://jsfiddle.net/8SpTk/23/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:12:53.403

我不太确定这是否是您想要实现的目标[http://jsfiddle.net/justelnegro/8SpTk/10/](http://jsfiddle.net/justelnegro/8SpTk/10/)

```
$('.detail select').attr('disabled', true);

$("#myddl").change(function()
{  
    $('.detail select').attr('disabled', false).val($(this).val());
}); 
```

# dll - 为 ASP 反编译 dll 文件

> ID：10504063
> 
> 赞同：1
> 
> 时间：2012-05-08T18:09:33.170
> 
> 标签：dll, asp-classic

我有一个问题与 ASP 一起使用的 DLL 文件。需要反编译 DLL 文件以便修改它以满足我的需要。

我需要有人指导我如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:15:25.217

.NET 反编译器

[反射器](http://www.reflector.net/)

[泰勒里克](http://www.telerik.com/products/decompiler.aspx)

我用的是反光板的，效果很好

# javascript - 加载窗口后如何加载图像？

> ID：10504065
> 
> 赞同：3
> 
> 时间：2012-05-08T18:09:38.027
> 
> 标签：javascript, jquery, html, web

我的网站有大量的大图像，这会降低我的网站速度。我想在没有加载网站后加载我网站的所有图像。

最好的解决方案是什么？？？我想要它在 jQuery 中。感谢任何 NICE JQUERY PLUGIN 建议。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T18:10:58.693

我最喜欢的是[http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:36:59.613

我曾经在我的 ASP 页面上执行此操作。

只需像这样创建所有图像标签

```
<img ID="img_1"/> 
```

一旦完成，使用 Jquery ：

```
$(document).ready(function(){
        document.img_1.src="YourImageUrl";
}); 
```

你去吧，一旦你的页面加载完内容，它就会显示你所有的图像。

# shell - 如何从 ksh (korn shell) 上的字符串中提取值

> ID：10504069
> 
> 赞同：1
> 
> 时间：2012-05-08T18:09:59.900
> 
> 标签：shell, ksh

我有以下输入

> 1.  MyComposite[2.1]，partition=default，mode=active，state=on，isDefault=true，deployedTime=2012-05-07T15:35:22.473-07:00
> 2.  MessageManager[1.0]，partition=default，mode=active，state=on，isDefault=true，deployedTime=2012-05-07T15:37:14.137-07:00
> 3.  SimpleApproval[1.0]，partition=default，mode=active，state=on，isDefault=true，deployedTime=2012-05-07T15:28:39.599-07:00

我有一个脚本，可以从文件中逐行解析输入，但我不知道如何将每行中的单个参数提取到局部变量中，以便执行其他过程

到目前为止，我正在尝试以下操作：

```
#!/bin/ksh

file="output"

compositeName="foo" ci=0
# while loop while read line do
        # display line or do somthing on $line
        if echo "$line" | egrep -q '\[[0-9]*\.[0-9]*\].*?(mode=active).*?
           (state=on)'  then compositeName=$( echo "$line" | egrep '[0-9]*' ) 
        echo "$compositeName" 
               #echo "$line"
        fi
         done <"$file" 
```

我很想从这个字符串中只提取两个值，第一个单词和括号之间的浮点数

IE：

> 名称 = MyComposite 版本 = 2.1

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:25:19.620

我不确定这些行号是否在文件中。如果没有，您可以这样做：

```
#!/usr/bin/env ksh

while IFS="," read nameVersion line; do
  name="${nameVersion%%\[*}"
  version="${nameVersion//*\[+([0-9.])\]*/\1}"
  print "name=$name version=$version"
done < "$file" 
```

*如果文件中有*行号，则将上述脚本中的名称分配更改为`name="${nameVersion//+([0-9]).+( )+(*)\[*/\3}"`

# java - 如何将 for 循环转换为 do-while 循环？

> ID：10504073
> 
> 赞同：1
> 
> 时间：2012-05-08T18:10:35.890
> 
> 标签：java, do-while

这是Y Daniel Liang所著*的 Java 简介一书中的一个问题：*

> 将for循环语句转换为while循环和do-while循环？
> 
> ```
> int sum = 0; 
> for (int i = 0; i <= 7; i++) 
>     sum = sum + i; 
> ```

我对如何将其转换为 do-while 循环感到非常困惑。我应该做些什么？请在下面查看我的代码。

```
public class Convert_forLoop_toWhileLoop {

   public static void main(String[] args) {
       int sum = 0;
       int i = 0;
       do {
           sum = sum + i;
           System.out.println(sum);
           i++;
       } while(i <= 7); 
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-01-09T10:26:14.533

根据您想要的谨慎程度，您的-loop 示例的“更多”等效`do`-循环将是：`while``for`

```
int sum1(int n) {
    int sum = 0;
    for (int i = 0; i <= n; i++) {
        sum = sum + i;
    }
    return sum;
}

int sum2(int n) {
    int sum = 0; 
    {
        int i = 0;
        if (i <= n) {
            do {
                sum = sum + i;
                i++;
            } while (i <= n);
        }
    }
    return sum;
} 
```

请注意，我将您的示例包装在其中`sum1`（传递`sum1(7)`等效于您的情况）。

对于那些真正想分叉的人——请注意，Java 不一定将上面的 2 个函数编译成相同的字节码（至少在我测试它时，令我惊讶的是）。2 个额外的字节码指令`sum2`（20 vs. 22）。我注意到了一些有趣的事情。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T18:15:43.370

像这样：

```
int sum = 0;
int i = 0;

do {
   sum += i;
   i++;
} while (i <= 7);

System.out.println("The sum of 0 thru " +i + " is:" + sum); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-08T18:18:38.500

您的答案不支持 i 初始值 >= 循环数的情况。

你需要先检查条件。

```
while (i <= 7) {
    sum+=i;
   // at the last statement increase i
   i++
}

System.out.println(sum); 
```

# maven - 如何强制 lein deps 重新获取本地 jars/libs

> ID：10504076
> 
> 赞同：15
> 
> 时间：2012-05-08T18:10:38.730
> 
> 标签：maven, jar, clojure, leiningen

使用以下说明：

[http://www.pgrs.net/2011/10/30/using-local-jars-with-leiningen/](http://www.pgrs.net/2011/10/30/using-local-jars-with-leiningen/)

我将一些本地 jar 安装到本地存储库中。

当我想更新项目中的 jar 时，我将 jar 重新安装到存储库中，然后运行 ​​lein deps。我发现不知何故，我的项目中的 jar 没有更新。即使我 rm -rf libs 文件夹中的所有内容，也不会拾取新 jar。我能够让它工作的唯一方法是更改​​ jar 的名称。

这有点奇怪，因为即使我删除了旧 jar 的所有痕迹（据我所知），也会发生这种情况——lein 是否隐藏了库的快照/缓存？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-08T18:44:57.537

Leiningen 使用 maven 进行依赖管理。默认情况下，Maven 将其 repo 存储在

```
$HOME/.m2/repository 
```

在 leiningen 版本 2 之前，依赖项将被复制到`<projecthome>/lib`，但版本 2 及更高版本构建了一个直接指向存储库的类路径。

因此，删除本地 maven 存储库中的 jar，您应该强制（重新）下载。

或者，知道对于快照依赖项很有用，maven 每天只会检查一次快照的新版本（默认情况下）。~~在 Maven 中，您可以使用 -U 标志强制它。我不认为莱宁根会暴露这一点，但你可以这样做......~~. （但请参阅 barry-wark 的回答）

```
# force update of snapshots before starting repl
$ lein -U repl 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-08-02T00:43:35.523

2 `lein`、可以使用`-U`flag，eg：

```
lein -U jar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-01T14:44:24.463

删除 .m2 文件夹。它会重新获取。

# html - 将参考 SVG 图像嵌入 HTML 文件

> ID：10504085
> 
> 赞同：2
> 
> 时间：2012-05-08T18:11:29.690
> 
> 标签：html, css, url, svg, background-image

我有一个项目，我想将简单的图形背景放入表格单元格中。背景图像和一个小的 svg 文件效果很好！

但我真的很想将源代码全部保存在一个文件中。也就是说，我希望能够在 HEAD 中定义图像，并在 inline STYLE css 中引用它。

我在css url() 函数中尝试了svg 和哈希引用中ID 属性的各种组合，但没有成功。这似乎是一件可取的事情，但环顾四周，我没有看到任何想法。这告诉我要么无法完成，要么以其他方式完成......

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T21:51:16.217

实际上，在提出问题并考虑之后，我意识到我已经阅读了答案。您需要使用 aa 数据 url 来创建内嵌 svg 图形。您可以将其赋予 css 类的 background-image 属性，如下所示：

{背景图像：url（“数据：图像/svg+xml；utf8，\ ...\”）；}

编码 utf8 将允许您直接输入代码，用反斜杠转义新行并避免双引号（据我所知；-）。现在您只需设置 TD 的 CLASS 就可以了！

现在我所要做的就是弄清楚如何在底部而不是顶部对齐背景......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:02:50.547

您可以将 svg 文件保存在其他地方并将其放在 iframe 中。

```
<iframe src="index.svg" width="100%" height="100%" /> 
```

可能还有其他方法。。

svg 的最佳 tuts 是[MDN](https://developer.mozilla.org/en/SVG)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T09:35:16.460

此代码也可能有效：

```
 <svg>
    <use xlink:href="..." /> 
 </svg> 
```

# c# - Windows 窗体加活动目录

> ID：10504086
> 
> 赞同：2
> 
> 时间：2012-05-08T18:11:32.410
> 
> 标签：c#, sql-server, winforms, active-directory

我必须为应用程序（Windows 窗体）实现我自己的安全性。

该应用程序供内部使用（10 个用户），但由于敏感数据，安全性非常重要。（SQL Server 2008 在后端，.NET 4.0）

我没有登录表单，但在`app.config`. 所以我想这可能`app.config`是实施广告组的好地方？还是借用asp.net会员服务商？

谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:13:23.310

如果您尝试维护数据库权限，请在数据库上设置它们并让您的应用程序`Integrated Security=True`在连接字符串中使用。用户将以自己的身份连接到数据库并拥有数据库指定的任何权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:14:14.457

为什么不只使用活动目录组成员来控制安全性？您与 SQL Server 数据库的连接字符串可以放在配置文件中，但您可能应该在将其发布给客户端之前对其进行“加密”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:48:57.583

如果您决定检查用户的 AD 组并阻止应用程序在启动时继续运行，请查看[此处](https://stackoverflow.com/a/6692790/128217)。

# sencha-touch - ExtJS4 / Sencha Touch 2：在不同的视图中以不同的排序重用数据（加载到存储中）

> ID：10504089
> 
> 赞同：0
> 
> 时间：2012-05-08T18:11:52.363
> 
> 标签：sencha-touch, extjs4, extjs, datastore

我在可以通过 JSON 访问的外部数据库中有数据。现在我想对这些数据集提供不同的视图（例如，不同的排序，..）。是否可以为此使用一个商店，或者我是否需要两个商店访问相同的 URL，除非使用不同的分拣机？

我的示例代码如下所示：

```
Ext.define('MyApp.store.MyStore', {
extend: 'Ext.data.Store',
requires: [
    'MyApp.model.MyModel'
],

config: {
    autoLoad: true,
    model: 'MyApp.model.MyModel',
    storeId: 'MyJsonStore',
    proxy: {
        type: 'ajax',
        url: 'http://localhost/index.php?data=MyData&format=json',
        reader: {
            type: 'json'
        }
    },
    sorters: [
        {
            direction: 'DESC',
            property: 'MyRating'
        },
        {
            direction: 'ASC',
            property: 'MyLabel'
        }
    ] } }); 
```

一个视图现在应该呈现一个按评级排序的列表，第二个视图应该显示一个按标签排序的列表。

有没有办法防止两次查询数据库？

谢谢 - 我刚开始使用 Sencha Touch 和 ExtJS --- 因此请原谅我的简单问题 ;)
不知何故，我无法通过向 Google 询问这项基本任务来找到任何智能解决方案..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:15:37.177

除非您的两个视图同时呈现，否则您不必担心任何事情。只需在本地重新排序同一商店即可。

如果它们同时出现，您将必须创建商店的副本。否则，它们将显示完全相同的信息。

# javascript - show/hide() 改变块级元素的宽度/行为？

> ID：10504091
> 
> 赞同：1
> 
> 时间：2012-05-08T18:11:58.020
> 
> 标签：javascript, jquery

我真的被这个卡住了，不知道如何解决这个问题，我使用 jQuery ~ 通常没有太多问题。但是因为我不写 JS 我确实卡住了:(我已经搜索并搜索了答案并尝试了太多的方法但没有得到任何地方...... :(我敢打赌我错过了一些非常明显或简单的东西，希望有人可能可以帮助...

好的 - 问题：我的网页设计课程有一个网站，它在左栏中显示主导航。对于最小的屏幕（即宽度低于 420 像素） - 我想隐藏菜单，显示一个“查看菜单”链接，而不是使用 jQuery toggle() 函数按需显示/隐藏菜单。

最初，我只通过一个直接的切换来做到这一点 - 一切都很好 - 除了菜单一旦在小屏幕上显示和隐藏一次就会保持隐藏的问题。如果调整窗口大小 - 它将保持隐藏状态。

这就是我要解决的问题，在这里提到它，因为我可能会在这里完全走错路~怀疑我是否以正确的方式这样做:'(

现在 - 我正在使用 JS 隐藏所有屏幕的“查看菜单”链接，仅在小于 420 像素的屏幕上显示。我还添加了 resize() 函数以允许更多动态行为。一切都按预期工作，以显示和隐藏我的菜单 - 但是....

切换链接本身设置为 display:block - 当窗口加载到 420 像素以下时，它会按预期显示：设置为 block（跨越整个宽度以获得很好的实心活动链接），文本居中。但是，当我以更大的窗口大小加载页面时，然后将其调整到 420 像素以下宽度 - 切换链接似乎变成了内联？不再全宽，文本似乎左对齐，因为元素不再是全宽......？！

我已经尝试在 CSS 中设置宽度，尝试通过 resize() 元素重置，通过 JS 分配 100% 宽度......没有任何效果 - 我确定我错过了一些东西......

我真的很感激任何指示或想法〜感觉我在这里遗漏了一些非常基本的东西......

网站：[webeyedea.info](http://webeyedea.info)

这是我的 JS 代码，跟随 jQuery 的链接：

```
// check for window size size on page load and show relevant content only 
$(function() {
    if ($(window).width() > 420) {
        $('#toggle-nav').hide();
        $('nav ul').show();
    }
    else {
        $('#toggle-nav').show();
        $('nav ul').hide();
    }
});
// check for window resize - show nav again for larger screens after hiding
$(window).resize(function() {
    if ($(window).width() > 420) {
        $('#toggle-nav').hide();
        $('nav ul').show();
    }
    else {
        $('#toggle-nav').show();
        $('nav ul').hide();
    }
});

// show menu (smallest screens)
$('nav #toggle-nav').click(function() {
    $('nav ul').slideToggle('slow', function() {
        // Animation complete.  
    });
    $('ul').addClass('view');
}); 
```

更新：见[JSFIDDLE](http://jsfiddle.net/eyedea/HWmp3/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:24:53.710

当您调用`.show()`一个元素时，它会将 display 属性设置为以前的值，如果它不存在，我相信它会采用默认浏览器值，这可能是`inline`您的情况。尝试将其显式设置为`block`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:28:06.217

我不确定这里在做什么，因为我没有手机来测试它，但你能尝试用一个在 display:none 和 display:block 之间切换的 css 函数替换你的 hide/show 吗？

像这样 ：

```
$('#toggle-nav').css('display','none');
$('#toggle-nav').css('display','block'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:33:23.557

请参阅我修改后的小提琴 [http://jsfiddle.net/HWmp3/9/](http://jsfiddle.net/HWmp3/9/) 我在 iphone 模拟器上测试了它，它可以工作。我的测试是将代码复制到本地文件并进行测试。我把所有的js放在document.ready里面

确保标题中有元数据

```
<meta name = "viewport" content = "width=device-width, initial-scale=1.0"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T13:55:20.867

**几乎 ！未解决**

一种解决方案，感谢 Vlad Radulescu（在[Forrst](http://forrst.com/posts/help_stuck_with_jQuery_I_think_show_hide_ch-UGx)上）~ 通过这个[jsfiddle 叉](http://jsfiddle.net/pacMakaveli/HWmp3/4/embedded/result/)

```
$('a#toggle-nav').css('display','none');

// Show the menu if Window width is less than 420
$(window).resize(function() {
    if ( $(window).width() > 420 ) {                    
        $('#toggle-nav').css('display','none');
        $('nav ul').show();                 
    }
    else {
        $('#toggle-nav').css('display','block');
        $('nav ul').hide();
    }            
});

// Slide the Menu on smaller screens
$('nav #toggle-nav').click(function() {
        $('nav ul').slideToggle('slow');                
}); 
```

# php - 将 PHP 脚本中的数据发送回 JQuery AJAX 请求

> ID：10504098
> 
> 赞同：2
> 
> 时间：2012-05-08T18:12:23.573
> 
> 标签：php, jquery, ajax, session, session-variables

我正在创建一个 Web 应用程序并遇到以下问题。

在我的应用程序中，用户在单个页面中工作，他们在画布上绘制。有一个名为“保存”的按钮。这将获取用户 ID 以及他们在画布中创建的任何内容，并将其发送到数据库。这一切都很好。保存功能类似于：

```
$.ajax({
    url: "/database/write.php",
    type: "POST",     
    data: { 
        docName: name,
        docData: document_Data,
        docMode: "new"
    }, 
    success: function(html) {
        alert("Successfully Saved NEW document");
        set_Mode();
    },          
}); 
```

上面的 AJAX 请求确实将这三个值发送到 PHP 脚本，然后成功地在数据库中创建了一个新文档，我现在需要做的是将应用程序模式从保存新文档更改为编辑以前保存的文档。这意味着当用户再次保存时，他们将写入同一行，覆盖文档的先前版本。

当我将数据发送到它时，`write.php`它确实将数据写入数据库并查询数据库以获取该插入的文档并检索其唯一的文档 ID。使用该 ID，应用程序可以选择该文档并覆盖它。要从查询中检索文档 ID，我使用以下代码`write.php`

**写.php**

```
$_SESSION['DOCUMENT_ID'] = $DOCUMENT_ID; 
```

此 $DOCUMENT_ID 是从`SELECT`查询中检索到的文档 ID。然后脚本完成并将控制权转移回主应用程序页面。

回到应用程序页面，我尝试检索该值，但它似乎不起作用。我可以检索`$_SESSION`用户第一次访问应用程序 ( `id`) 时设置的值，但现在是由`write.php`( `DOCUMENT_ID`) 页面设置的值。例如，下面显示了 AJAX 请求成功后调用的函数：

```
function set_Mode()
{
    var PHPvar_01 = <?php echo($_SESSION['id']); ?>;
    alert(PHPvar_01); //WORKS FINE

    var PHPvar_02 = <?php echo($_SESSION['DOCUMENT_ID']); ?>;
    alert(PHPvar_02); //DOES NOT WORK.          
}; 
```

我应该如何将从 PHP 查询脚本检索到的数据发送到应用程序，因为`$_SESSION`这里似乎不起作用。

感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:16:21.547

在您的 write.php 中，您应该在页面末尾回显 $DOCUMENT_ID，然后您的成功函数将在`html`参数中接收它。然后您应该使用传递给成功函数`set_Mode`的`html`变量进行调用。

*在*页面加载完成并且*知道*文档 ID`set_Mode`之后，您才能调用。在初始页面加载时，您正在将文档 ID 写入函数中。**`set_Mode`**

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:18:03.977

那么，您的 PHP 代码只会在页面初始加载时执行**一次。**服务器检测到对您站点的请求，在内部加载 PHP 文档，对其进行解析并将其传递给客户端。

因此，当 AJAX 调用返回时，整个 PHP 脚本**不会**再次执行，因为用户没有请求整个页面，而只是向您的`write.php`.

您的`write.php`脚本必须`$DOCUMENT_ID`以某种方式返回，例如直接回显它，然后 jQuery AJAX 调用中的成功处理程序可以通过处理程序的参数访问它（请参阅 jQuery 文档）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:18:49.053

当页面已经加载到用户浏览器中时，您无法访问服务器上的变量，而不是使用 ajax。

你需要发回一些东西，而在 PHP 中你所要做的就是回显一些东西，并在你的 Ajax 调用的成功函数中捕获它。

在 /database/write.php 的末尾，执行

```
echo $_SESSION['DOCUMENT_ID']; 
```

在 JS 中

```
$.ajax({
    url: "/database/write.php",
    type: "POST",     
    data: { 
        docName: name,
        docData: document_Data,
        docMode: "new"
    }, 
    success: function(data) {
        alert("Successfully Saved NEW document");
        set_Mode();
        if (data == 'something') {
           //do something with the returned DOCUMENT_ID stored in the data variable
        }
    },          
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T18:18:52.027

在 write.php 的末尾：

```
echo json_encode(array('id'=>$_SESSION['id'], 'DOCUMENT_ID'=>$_SESSION['DOCUMENT_ID'])); 
```

在您的 ajax 调用中：

```
success: function(data) {
    data = eval('('+data+')');
    alert("Successfully Saved NEW document");
    set_Mode(data.id, data.DOCUMENT_ID);
}, 
```

这应该可以解决问题！**

# ruby-on-rails - Ruby on Rails - HABTM NoMethodError

> ID：10504099
> 
> 赞同：0
> 
> 时间：2012-05-08T18:12:39.617
> 
> 标签：ruby-on-rails, has-and-belongs-to-many, nomethoderror

我正在使用 rails 3.2.3 并且遇到了 HABTM 关系问题。

基本上，我有一个用户模型，有一个带有角色模型的 HABTM。

一切正常，但是，我现在想在 User 模型和 Hotel 模型之间添加另一个 HABTM 关系。

除了当我尝试运行我的页面时，我得到一个（tail -f log/development.log）：

```
NoMethodError (undefined method `[]' for :hotels:Symbol):
  app/models/user.rb:7
  config/routes.rb:6
  config/routes.rb:1 
```

我的路线：

```
Oops::Application.routes.draw do #this is my line 1
  get "managers/index"

 root :to => "hotels#index"

  devise_for :users #this is my line 6
  resources :roles
  resources :users
  resources :managers
  resources :hotels

  ActiveAdmin.routes(self) 
```

我的用户模型：

```
devise :database_authenticatable, :recoverable, (...)

has_and_belongs_to_many :roles, :hotels #This is my line 7, if I delete :hotels and all its references in this HABTM relationship, everything works

accepts_nested_attributes_for :roles

attr_accessible :username, :email, :password, :password_confirmation, :remember_me, :role_ids, :hotel_attributes 
```

我的酒店型号：

```
has_and_belongs_to_many :facilities, :users
  has_one :address
  accepts_nested_attributes_for :facilities, :address, :users
  attr_accessible <all hotel attributes>, :facility_ids, :address_attributes, :user_ids 
```

在这段新的关系之前，一切都在进行中。我根本无法在项目中运行任何页面。有小费吗？

谢谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:24:19.793

分裂：

```
 has_and_belongs_to_many :roles, :hotels 
```

在两行：

```
 has_and_belongs_to_many :roles
 has_and_belongs_to_many :hotels 
```

# spring - 如何使用 Spring 以编程方式延迟 JMS 主题消息消费

> ID：10504104
> 
> 赞同：0
> 
> 时间：2012-05-08T18:13:11.780
> 
> 标签：spring, jms

我有一个使用来自 JMS 主题的消息的应用程序。作为正常应用程序流程的一部分，它需要定期停止使用消息。当应用程序处于此状态时，新消息存储在主题中（请注意，我的应用程序仍在运行）。稍后，应用程序恢复消息消费，同时接收那些在应用程序未侦听时放置在主题上的消息。

此功能目前是通过从`ConnectionFactory`. 但是，我现在希望将应用程序迁移到 Spring JMS。尽管 Spring 相当巧妙地抽象出大部分 JMS 样板 - 我似乎不再对底层连接进行细粒度控制，因此无法按需停止消息消费。

在我尝试涉足 Spring JMS 内部之前，任何人都可以提出一种简洁的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T14:43:43.963

你能避免从 onMessage() 返回吗？你想停止消费多久？您的问题是否类似于[https://stackoverflow.com/a/628337/20734](https://stackoverflow.com/a/628337/20734)

# mysql - mySQL 内连接查询 - 我如何组合这两个查询？

> ID：10504105
> 
> 赞同：-1
> 
> 时间：2012-05-08T18:13:16.987
> 
> 标签：mysql

这是我当前的查询：

```
SELECT DISTINCT t.* FROM filter AS f
INNER JOIN filter_thread AS ft 
ON ft.filter_id = f.filter_id
INNER JOIN thread AS t 
ON ft.thread_id = t.thread_id
WHERE f.tag LIKE '%test%'
ORDER BY t.replystamp DESC 
```

它返回一堆数据，包括“owner_id”列。

'user_table' 包含一个匹配的 id，标记为 'id'

我以前使用此查询来获取数据：

```
SELECT username FROM users WHERE id='$user_id'" 
```

我需要这些出现在同一个查询中！但是添加一个额外的 INNER JOIN 是行不通的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:17:07.843

也许是这样：

```
SELECT DISTINCT t.*,u.username
FROM filter AS f
INNER JOIN filter_thread AS ft 
ON ft.filter_id = f.filter_id
INNER JOIN thread AS t 
ON ft.thread_id = t.thread_id
INNER JOIN users AS u
ON u.id = t.owner_id
WHERE f.tag LIKE '%test%'
ORDER BY t.replystamp DESC 
```

只是一个猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:17:07.313

尝试以下操作：

```
SELECT DISTINCT t.*, u.username FROM filter AS f
   INNER JOIN filter_thread AS ft 
      ON ft.filter_id = f.filter_id
   INNER JOIN thread AS t 
      ON ft.thread_id = t.thread_id
   INNER JOIN users AS u 
      ON ft.owner_id = u.id
   WHERE f.tag LIKE '%test%'
   ORDER BY t.replystamp DESC 
```

# jstree - 获取所有子节点的子名称

> ID：10504108
> 
> 赞同：0
> 
> 时间：2012-05-08T18:13:30.297
> 
> 标签：jstree

我必须在单击的节点下获取每个子节点的名称。假设我在一个函数中发送点击的节点：

```
getNodes(node){
$(node).children().each(function () {
  //want child nodes name under the sent node(node)
});
} 
```

我如何让这个工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T15:22:14.870

我一直在努力寻找方法。这是我想出的：

我没有使用 jsTree，而是使用了 JQuery 选择器。这很好用，因为每个节点的元数据都存储在 jQuery 数据中。

这是我的做法：

```
 $( "#treeDiv" ).jstree( {
       "json_data":{data:jsTree},
       "themes":{
          "theme":"classic",
          "dots":false,
          "icons":false
       },
       "plugins":[ "themes", "json_data", "ui" ]
    } ).bind( "select_node.jstree",
                function ( e, data ) {
                   $(data.rslt.obj).find("li").each( function( idx, listItem ) {
                      console.log( $(listItem).data("name") );
                   });
                } ); 
```

这将打印控制台中的所有名称。前提是您已将它们添加为元数据。有关元数据的详细信息，请参阅 jsTree 文档：http: [//www.jstree.com/documentation/json_data](http://www.jstree.com/documentation/json_data)

第二种选择是替换`$(listItem).data("name")`by`$(listItem ).find("a" ).text()`

这仅适用于最后一层，因为叶子在标签中有它们的名字，但父母会打印更多。

希望这有帮助。

# perl - 继承和子方法

> ID：10504112
> 
> 赞同：1
> 
> 时间：2012-05-08T18:13:40.167
> 
> 标签：perl

由于某种原因，我无法访问边界对象上的子方法。我希望尽可能详细地给出答案，因为我仍然对 perl 的继承感到有些困惑，尤其是祝福部分。此外，任何建设性的批评都对整体设计很有帮助。

Generic.pm（基类）

```
package AccessList::Generic;
use strict;
use warnings;

sub new {
    my $class = shift;
    my $self = {
        rules => [],
        @_
    };
    bless $self, $class;
    return $self;
}

sub get_line_count {
    my $self = shift;
    return scalar @{$self->{rules}};
}

1; 
```

扩展.pm

```
package AccessList::Extended;
use strict;
use warnings;
use AccessList::Generic;

use base qw(AccessList::Generic);

sub new {
    my ($class, @args) = @_;
    my $self = $class->SUPER::new(@args);
    return $self;
}

1; 
```

边界.pm

```
package AccessList::Extended::Boundary;
use strict;
use warnings;
use AccessList::Extended;

use base qw(AccessList::Extended);

sub new {
    my ($class, @args) = @_;
    my $self = $class->SUPER::new(@args);
    return $self;
}

sub get_acl_information {
    my ($self) = @_;
    return;
}

1; 
```

未通过测试

```
can_ok('AccessList::Extended::Boundary', 'get_acl_information'); 
```

错误信息

```
#   Failed test 'AccessList::Extended::Boundary->can('get_acl_information')'
#   at t/b1.t line 42.
#     AccessList::Extended::Boundary->can('get_acl_information') failed
# Looks like you failed 1 test of 2. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:39:39.050

我在您发布的内容中没有看到任何问题。问题肯定出在您没有发布的内容上。您是否忘记加载 AccessList::Extended::Boundary？

```
$ find -type f
./AccessList/Extended/Boundary.pm
./AccessList/Extended.pm
./AccessList/Generic.pm

$ perl -E'
   use Test::More tests => 1;
   use AccessList::Extended::Boundary;
   can_ok("AccessList::Extended::Boundary", "get_acl_information");
'
1..1
ok 1 - AccessList::Extended::Boundary->can('get_acl_information') 
```

# c++ - 什么时候一个物体足够重以避免复制？

> ID：10504114
> 
> 赞同：5
> 
> 时间：2012-05-08T18:13:52.253
> 
> 标签：c++, memory

好吧，我相信标题很简单。我读过很多次应该避免复制重物，这似乎很合理（谁想成为内存猪？）。问题是，什么时候应该认为一个物体很重？有多少成员？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T18:22:28.297

任何时候您传递的对象大于指针的大小（通常在 32 位上为 4 个字节，在 64 位上为 8 个字节），那么避免复制会更有效。

您是否*应该*通过引用/指针传递它取决于有多少额外的工作，以及您将如何处理数据。如果你通过引用传递它只是为了创建一个副本并在你的函数中修改它，那么你就违背了这个目的。任何时候将它作为 const 引用传递就足够了，那么这样做可能是个好主意。

但是，请注意，大多数编译器都足够聪明，可以在启用优化编译代码时优化只读对象的复制。因此，除非它成为瓶颈并且您可以量化证明它，否则您不必真正担心它。

# sqlite - 组合 GROUP BY 下的 ID？

> ID：10504116
> 
> 赞同：1
> 
> 时间：2012-05-08T18:14:01.310
> 
> 标签：sqlite, group-by

我有一个如下所示的 sqlite 表“日志”：

```
ID     p_id     viewer
----------------------
1      1        100
2      1        200
3      1        300
4      3        550
5      3        230
6      5        420
7      2        320
8      2        203
9      9        10
10     9        55 
```

我想从每个 p_id 中获得平均观众。那将是

```
SELECT avg(viewer) FROM log GROUP BY p_id 
```

**但**我想将 p_id 1 和 5 视为相同，所以我会得到 p_id 1 和 5 的平均观众。我怎么做？请注意，该表要大得多，我需要多次将两个 p_id 视为相同。我仍然可以通过“分组”来实现这一目标，还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:17:01.177

我试过这个，它至少适用于 mySQL。

```
SELECT avg(viewer) FROM log GROUP BY CASE p_id WHEN 5 THEN 1 ELSE p_id END; 
```

**编辑：**当使用名为 'aliases' 的别名表和字段 'alias_from_id' 和 'aliased_as' 时：

```
SELECT
CASE ISNULL((SELECT aliased_as FROM aliases WHERE (alias_from_id = log.pid))) 
WHEN 1 THEN log.pid ELSE aliased_as END AS the_id,
SUM(value) AS value_sum
FROM log
LEFT JOIN aliases ON (alias_from_id = pid)
GROUP BY
CASE ISNULL((SELECT aliased_as FROM aliases WHERE (alias_from_id = log.pid)))
WHEN 1 THEN log.pid ELSE aliased_as END 
```

我已经用 mySQL 对此进行了测试，它就像一个魅力。可能可以稍微简化一下这个 SQL 查询，但这是我目前能做的最好的:)

**Edit2：**将 ISNULL 更改为相应的 SQLite`IFNULL`函数

```
SELECT
IFNULL((SELECT aliased_as FROM aliases WHERE (alias_from_id = log.pid)), log.pid) AS the_id,
SUM(value) AS value_sum
FROM log
LEFT JOIN aliases ON (alias_from_id = pid)
GROUP BY
IFNULL((SELECT aliased_as FROM aliases WHERE (alias_from_id = log.pid)), log.pid) 
```

我不知道 SQLite 是否支持 AS 关键字，如果不支持则删除该关键字 - 功能应该是相同的。

# sql-server - 从 VB6 插入时未保存 Unicode 字符

> ID：10504117
> 
> 赞同：0
> 
> 时间：2012-05-08T18:14:09.960
> 
> 标签：sql-server, unicode, vb6, character-encoding

我有一个 VB6 应用程序，当尝试保存 unicode 字符时，这些字符没有正确保存在 Ms SQL 数据库中。直接在 SSMS 中执行插入语句时，插入正确执行。

`Exec sp_Insert_item 1, 101, N'Ħass'`

我在连接字符串中使用 SQLOLEDB 作为驱动程序，并且我的列设置为 NVarchar

有谁知道如何解决这个问题？

谢谢，艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T03:36:24.073

您是正确的，VB6 将支持 unicode。事实上，VB6 字符串本质上是 unicode，但问题是当从不正确支持它的用户控件显示/检索时，它会在翻译中丢失。

如果您从 UI 获取字符串，请确保使用支持它的文本框控件。例如，添加对 Microsoft Forms 2.0 对象库的引用，并在开箱即用的常规文本框控件上使用这些控件。这样，您可以将字体类型和脚本设置为支持 unicode 的字体类型和脚本。

您可能还希望查看一些用于操作 unicode 字符串的内置函数，例如“StrConv”、“ChrW$”等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T19:40:52.577

我相信您的问题与我们在大多数可用控件中遇到的 VB6 源代码字符串文字中的相同 ANSI 问题有关。

您的：

```
CreateRecordset.Open "Exec sp_Insert_item 1, 101, N'Ħass'", conn, adOpenForwardOnly 
```

实际上是：

```
CreateRecordset.Open "Exec sp_Insert_item 1, 101, N'Hass'", conn, adOpenForwardOnly 
```

...在您将其粘贴到那里之后。

这是一种足够常见的事情，我经常使用我调用的类`EscerLite`来帮助处理这个问题。当然，它在运行时运行，很遗憾，但它通常优于在代码中的字符串文字中连接 ChrW$() 调用的替代方法。

我通常编辑 .CLS 文件，以便生成`Attribute VB_PredeclaredId = True`一个全局的、预先声明的实例（就像 VB6 .FRM 模块所做的那样，这是以模块名称命名的“自由”Form 实例的来源）。但你当然不必这样做。

它定义了一个方法：`UnEscape`而我的完整版本`Escer`也有一个`Escape`“其他方式”的方法 - 对于设置的序列化等很有用。

这使您可以编写：

```
CreateRecordset.Open EscerLite.UnEscape("Exec sp_Insert_item 1, 101, N'^u0126ass'"), _
                     conn, _
                     adOpenForwardOnly 
```

但是您可以制定自己的方案，或者只使用 ChrW$() 调用。

**EscerLite.cls**

```
Option Explicit

Private Enum UnEscStates
    uesNotInEscapeSeq = 0
    uesProcessingEscSeq = 1
    uesProcessingLongEscSeq = 2
    uesProcessingLongEscSeqXEnd = 3
    uesProcessingLongEscSeqUEnd = 5
End Enum

Public Function UnEscape(ByVal EscapedText As String) As String
    'Un-escape a string value.  Escape sequences supported:
    '
    '   ^xhh   7 bit hex               ^r     vbCr
    '   ^uhhhh 16 bit hex ("Unicode")  ^l     vbLf
    '   ^b     vbBack                  ^n     vbNewLine/vbCrLf
    '   ^t     vbTab                   ^q     quote (")
    '   ^v     vbVerticalTab           ^0     vbNullChar
    '   ^f     vbFormFeed              ^^     ^

    Dim Pos As Long
    Dim ChS As String
    Dim ChW As Integer
    Dim UpChW As Integer
    Dim UnEscState As UnEscStates
    Dim UnPos As Long
    Dim Unicode As Boolean
    Dim Accum As Long

    UnEscape = Space$(Len(EscapedText))
    UnPos = 1&
    For Pos = 1& To Len(EscapedText)
        ChS = Mid$(EscapedText, Pos, 1&)
        ChW = AscW(ChS)
        UpChW = AscW(UCase$(ChS))
        Select Case UnEscState
            Case uesNotInEscapeSeq
                If ChW = 94# Then ' "^"
                    UnEscState = uesProcessingEscSeq
                End If
            Case uesProcessingEscSeq
                UnEscState = uesNotInEscapeSeq
                Select Case UpChW
                    Case 88# ' "X"
                        UnEscState = uesProcessingLongEscSeq
                    Case 85# ' "U"
                        Unicode = True
                        UnEscState = uesProcessingLongEscSeq
                    Case 66# ' "B"
                        ChS = vbBack
                    Case 84# ' "T"
                        ChS = vbTab
                    Case 86# ' "V"
                        ChS = vbVerticalTab
                    Case 70# ' "F"
                        ChS = vbFormFeed
                    Case 82# ' "R"
                        ChS = vbCr
                    Case 76# ' "L"
                        ChS = vbLf
                    Case 78# ' "N"
                        Mid$(UnEscape, UnPos, 1&) = vbCr
                        UnPos = UnPos + 1
                        ChS = vbLf
                    Case 81# ' "Q"
                        ChS = """"
                    Case 48# ' "0"
                        ChS = vbNullChar
                    Case 94# ' "^", i.e. ^^
                        '
                    Case Else
                        Err.Raise 5
                End Select
            Case Else
                If (48# <= UpChW And UpChW <= 57#) Then
                    Accum = 16& * Accum + (CLng(UpChW) And &HF&)
                ElseIf (65# <= UpChW And UpChW <= 70#) Then
                    Accum = 16& * Accum + (CLng(UpChW) - 55&)
                Else
                    Err.Raise 5
                End If
                UnEscState = UnEscState + 1&
                If Unicode Then
                    If UnEscState > uesProcessingLongEscSeqUEnd Then
                        ChS = ChrW$(Accum)
                        Accum = 0&
                        UnEscState = uesNotInEscapeSeq
                        Unicode = False
                    End If
                Else
                    If Accum > 127 Then Err.Raise 5
                    If UnEscState > uesProcessingLongEscSeqXEnd Then
                        ChS = ChrW$(Accum)
                        Accum = 0&
                        UnEscState = uesNotInEscapeSeq
                    End If
                End If
        End Select
        If UnEscState = uesNotInEscapeSeq Then
            Mid$(UnEscape, UnPos, 1&) = ChS
            UnPos = UnPos + 1&
        End If
    Next
    If UnEscState <> uesNotInEscapeSeq Then Err.Raise 5
    UnEscape = Left$(UnEscape, UnPos - 1&)
End Function 
```

# ajax - Google Feed API：“不支持 Feed URL 中指定的端口。”

> ID：10504128
> 
> 赞同：0
> 
> 时间：2012-05-08T18:14:42.713
> 
> 标签：ajax, atom-feed, google-feed-api

我正在尝试实现 Google Feed API 以从服务器访问 ATOM 提要，然后在移动 Web 应用程序上显示数据。我收到错误消息“不支持提要 URL 中指定的端口。” 有什么想法或建议吗？

```
 // Google Feed API
//Our callback function, for when a feed is loaded.
function feedLoaded(result) {
  if (!result.error) {
      console.log("no error in loading feed");
    // Grab the container we will put the results into
    var container = document.getElementById("page_contents");
    container.innerHTML = '';

    // Loop through the feeds, putting the titles onto the page.
    // Check out the result object for a list of properties returned in each entry.
    // http://code.google.com/apis/ajaxfeeds/documentation/reference.html#JSON
    for (var i = 0; i < result.feed.entries.length; i++) {
      var entry = result.feed.entries[i];
      var div = document.createElement("div");
      div.appendChild(document.createTextNode(entry.content));
      container.appendChild(div);
    }

    console.log(result.feed.entries.length);
  } else {
      var container = document.getElementById("page_contents");
      container.innerHTML = '';

      var div = document.createElement("div");
      div.appendChild(document.createTextNode(result.error.message));
      container.appendChild(div);

      alert(result.error.message);

  }
}

function OnLoad() {
  // Create a feed instance that will grab Digg's feed.
    var feed = new google.feeds.Feed("http://localhost:8082/frevvo/web/tn/billy.com/api/apps");
    //var feed = new google.feeds.Feed("http://www.digg.com/rss/index.xml");
  if (!feed) {
      alert("feed object not created");
  } 
  console.log("loading feed");
  // Calling load sends the request off.  It requires a callback function.
  feed.load(feedLoaded);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:26:04.393

您似乎设置端口的唯一地方是您指定 URL 的地方`http://localhost:8082/frevvo/web/tn/billy.com/api/apps`。

将该 URL 更改为某个不使用非标准端口的 RSS 提要，这个错误几乎肯定会消失。

为了测试，我经常去新闻网站并获取他们的 RSS 提要 URL，例如`http://rss.cnn.com/rss/cnn_topstories.rss`.

# php - 使用自我、父母、静态以及如何使用时？

> ID：10504129
> 
> 赞同：18
> 
> 时间：2012-05-08T18:14:46.020
> 
> 标签：php, oop, static

如果到现在我在 ststic 中理解了一点现在我意识到我什么都不懂。我很困惑，我很难理解，我不能。有人可以在使用 self、parent、static 时解释这个程序，以及我所做的所有最小的改变如何改变结果，而我无法理解发生了什么。多谢 ..

来自[http://docs.php.net/language.oop5.late-static-bindings的代码](http://docs.php.net/language.oop5.late-static-bindings)

```
<?php
class A {
    public static function foo() {
        static::who();
    }

    public static function who() {
        echo __CLASS__."\n";
    }
}

class B extends A {
    public static function test() {
        A::foo();
        parent::foo();
        self::foo();
    }

    public static function who() {
        echo __CLASS__."\n";
    }
}
class C extends B {
    public static function who() {
        echo __CLASS__."\n";
    }
}

C::test();
?> 
```

输出是：

```
A
C
C 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-08T18:53:31.720

您需要了解[后期静态绑定](http://php.net/manual/en/language.oop5.late-static-bindings.php)的概念，它确定标识符*何时绑定到代码/数据。*您可以告诉 PHP 提前（`self::`）或稍后（`static::`）绑定它。

将示例精简为两个类，我们得到：

```
class A {
    public static function foo() {
        self::who(); // PHP binds this to A::who() right away
        static::who();  // PHP waits to resolve this (hence, late)!
    }

    public static function who() {
        echo __CLASS__."\n";
    }
}

class B extends A {
    public static function test() {
       self::foo();
    }

    public static function who() {
        echo __CLASS__."\n";
    }
}

B::test(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-08T18:25:35.430

查看[http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)。它说：

> 将类属性或方法声明为静态使它们无需实例化即可访问。
> 
> ...
> 
> 因为静态方法可以在没有创建对象实例的情况下调用，所以伪变量 $this 在声明为静态的方法中不可用。

不能使用`$this`，因为在调用静态方法时，`$this`变量中没有实例化的类对象。所以你使用`self::`.

`parent::`是指当前类正在扩展的父类。例如，C 类的父类是 B 类，B 类的父类是 A 类。参见[http://php.net/manual/en/keyword.parent.php](http://php.net/manual/en/keyword.parent.php)。

当您希望函数可以访问而无需实际声明该类的实例时，您可以使用静态方法。

* * *

仔细检查您的问题后，您的链接指向后期静态绑定。该页面中的前两个示例非常清楚地表明了对`static::`语法的需求，但为了澄清您发布的示例：

看一下`foo()`A 类中的方法。它调用`static::who()`. 这意味着该方法`who()`将在调用该函数的类的范围内被调用，而不是在定义该函数的类的范围内。因此，如果您要调用`C::foo()`，它将回显 C。

相反，如果它调用`self::who()`，它将调用`A::who()`。因为在A类中，`self::`指的是A。

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-08T18:53:35.123

答案的关键是**static::who()**，记住 static:: 意味着您使用实际类（在我们的例子中 - C）调用方法。

所以 C::test() 运行如下：

```
A::foo();   -> calls to A::foo() therefor echo A
parent::foo(); -> calls to C parent (which is B), B::foo() inherits A::foo() which calls to static::who(), but our actual class is C, therefor echo C
self::foo(); -> again calls to foo() which calls to static::who() with our actual class C 
```

如果不是 static::who() foo 调用 self::who() 你会得到三个 A 结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-19T20:04:30.270

当一个继承类调用继承类的方法时，哪些方法使用这些关键字；会发生什么！！用这个流程图解释。我认为这会有所帮助。 ![在此处输入图像描述](../Images/15ac55f0439b5ee4a44b328586baca84.png)

# memory-management - cma_alloc 无法创建 10M 的内存块

> ID：10504131
> 
> 赞同：1
> 
> 时间：2012-05-08T18:14:52.140
> 
> 标签：memory-management, linux-kernel, driver

我正在开发相机驱动程序，每当我尝试分配内存时`10M`，它都会失败，但`4-5M`会创建内存。使用内存分配有限制`cma_alloc`吗？如果是，我该如何增加它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T06:44:32.990

乍一看，我会说分配 10M 的连续内存已经很可疑了。为什么需要这么多？

您使用的是 Android，因此表明是嵌入式平台，这使得 10M 的内存更加可疑。

从我在网上找到的文档中，您还需要指定系统在启动时需要多少 cma 内存。您是否指定超过 10M？

# iphone - 当 UITableView 中的行被选中时， UINavigationBar 中的完成按钮出现

> ID：10504132
> 
> 赞同：0
> 
> 时间：2012-05-08T18:14:54.257
> 
> 标签：iphone, objective-c, ios, uitableview

当我的 UITableView 中的任何行被选中并且我希望这个按钮执行一个操作时，我想让一个完成按钮出现 UINavigationBar `performSegueWithIdentifier`。关于如何实施它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:27:21.873

将以下内容添加到您的 tableView:didSelectRowAtIndexPath: 方法中：

```
//add done button to navigation bar
UIBarButtonItem *doneBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(userPressedDone)];
self.navigationItem.rightBarButtonItem = doneBarButtonItem; 
```

然后在您的视图控制器中的某处使用这样的方法：

```
-(void)userPressedDone {
    //perform segue
    [self performSegueWithIdentifier:@"mySegue" sender:nil];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:20:14.023

我想在您的`-didSelectRowAtIndexPath:`方法中，您将在视图控制器`UIBarButtonItem`的右侧或左侧栏按钮项中添加一个。`navigationItem`

# z3 - 为什么Z3在网页和本地（分别为unsat/sat）报告不同的查询状态？

> ID：10504135
> 
> 赞同：1
> 
> 时间：2012-05-08T18:15:04.477
> 
> 标签：z3

[http://rise4fun.com/Z3/MlnZ](http://rise4fun.com/Z3/MlnZ)

正确的结果应该是UNSAT（在线版），但是本地Z3 3.2报告SAT。它还生成了一个有趣的[模型](https://www.dropbox.com/s/r8x85hb4fsyr1yf/model.smt2)，其中包含枚举类型（数据类型）的全域和基数约束。想法？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T02:28:25.867

等待结束。4.0 已发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:32:58.547

这是一个错误。Z3 3.2 不会为您的脚本安装递归数据类型引擎。因此，排序`Q`和`T`被视为未解释的排序。Z3 4.0 修复了这个错误。在线版本已经运行 Z3 4.0。这就是您使用在线版本获得正确结果的原因。您可以在 Z3 3.2 中使用以下解决方法。

> （设置选项：自动配置假）

# javascript - 是否有确定的方法来确定 XHR 请求是否被用户中止

> ID：10504136
> 
> 赞同：0
> 
> 时间：2012-05-08T18:15:07.633
> 
> 标签：javascript, dojo, xmlhttprequest

我正在尝试确定 XHR 请求（通过 Dojo 发送）是否由于用户请求新页面而失败，或者它是否是真正的失败。

[这里](http://ilikestuffblog.com/2009/11/30/how-to-distinguish-a-user-aborted-ajax-call-from-an-error/)有一个很好的尝试，但它也会捕捉到接收请求的服务器由于服务器错误而无法响应的情况。

我想到的一件事是我可以检查页面当前是否正在卸载，但我不知道这是否是可以查询的状态，而无需以某种方式实现它。

有什么想法吗？

# php - Mysql - 查找具有相同ID的字段

> ID：10504139
> 
> 赞同：0
> 
> 时间：2012-05-08T18:15:20.997
> 
> 标签：php, mysql

我需要从用户在文本字段中输入的关键字构建一个查询，它将执行以下操作：获取关键字并在表中搜索，之后汽车具有所有给定的关键字。我的表如下所示：

```
field_id | car_id | keyword |
----------------------------
1        | 5       | 1989   |
-----------------------------
2        | 8       | old    |
-----------------------------
3        | 8       | ford   |
-----------------------------
4        | 2       | audi   |
-----------------------------
5        | 5       | red    |
-----------------------------
6        | 8       | cheap  |
----------------------------- 
```

假设用户搜索“old”、“ford”和“cheap”，则应该返回 car_id 8，因为它包含所有关键字。你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:18:28.850

假设您知道输入的关键字的数量，并且您希望对所有这些关键字进行匹配。此外，它假设关键字 car_id 是唯一的。（car_Id 8 不能便宜两次）

```
Select car_ID from myTable
Where keyword in ('old','ford','cheap')
group by car_ID
having count(*) = 3 
```

# xcode - 如何让 Xcode 在测试代码出现异常时停止？

> ID：10504141
> 
> 赞同：1
> 
> 时间：2012-05-08T18:15:24.483
> 
> 标签：xcode, debugging, testing, breakpoints, ocunit

当我使用 OCUnit 测试我的代码时，它会生成异常日志并使其失败，但在异常引发时永远不会停止。甚至断点也不起作用。

我想跟踪堆栈并查看异常时的状态，但调试器没有弹出。如何像常规代码一样调试测试代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:22:17.783

在项目上设置异常断点。转到 XCode 左侧窗格中的 Breakpoint 选项卡。它看起来像一个指向右的箭头。然后在该屏幕的底部单击`+`和`Add Exception Breakpoint...`

# sql - Matlab：数据库。重写 SQL

> ID：10504147
> 
> 赞同：0
> 
> 时间：2012-05-08T18:15:41.963
> 
> 标签：sql, database, matlab

这是我的 SELECT 查询代码。`SELECT * FROM TableName WHERE (DateField = Date)`

```
 function out = SQL_Simple( DBName, TableName, Date, DateField, SortField, Limits )

 logintimeout(60);
 conurl = ['jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)}; DBQ=' DBName];
 conn = database('','','','sun.jdbc.odbc.JdbcOdbcDriver', conurl);

 Limits = Limits + 1;
 sql = ['SELECT * FROM ' TableName ];
 sql = [sql ' WHERE (' DateField ' = ' Date ')'];

 interest = fetch(exec(conn, sql));

 %sql = [sql ' ORDER BY ' SortField ' DESC' ];
 %sql = [sql ' LIMIT ' Limits];

 close(conn);
 out = interest.Data;
 end 
```

它不起作用。

这个查询有什么问题？

`DateField`有类型`adDate`。 `Date`有格式`dd.mm.yyyy`。

ps：

这是数据库中的表：

```
DBTable.Name = "MyTable"
DBTable.Columns.Append "StrField", adVarWChar, 160
DBTable.Columns.Append "DoubleField", adDouble, 40
DBTable.Columns.Append "IntField", adInteger
DBTable.Columns.Append "CurField", adCurrency
DBTable.Columns.Append "Today", adDate 
```

`DateField='Today'`. （在`matlab`代码中）

我试图写这样的东西：

```
 sql = ['SELECT * FROM ' TableName ];
 sql = [sql ' WHERE (' DateField ' = ''' Date ''');' ]; 
```

它也不起作用:(（在这里`Date = '2010-12-31 00:00:00.0'`，DateField = `'Today'`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:19:14.773

如果您发布实际的错误消息，它会有所帮助。不过，在这种情况下，我认为一个问题是日期比较。您需要在“日期”周围加上引号。尝试：

```
sql = [sql ' WHERE (' DateField ' = ''' Date ''')']; 
```

对于第二个 SQL 行。

# windows - C++/赢。没有收到 FD_CLOSE

> ID：10504152
> 
> 赞同：1
> 
> 时间：2012-05-08T18:15:54.367
> 
> 标签：windows, winapi, sockets

我有一个异步套接字并调用 connect() + GetLastError()，它按预期返回 WSA_WOULD_BLOCK。所以我开始“接收/阅读”线程并将事件订阅到 FD_READ 和 FD_CLOSE。

故事是：连接将依次失败，因为服务器没有启动并运行。我的理解是我的接收线程应该很快得到 FD_CLOSE，我需要跟进清理。

它不会发生。我应该多久收到 FD_CLOSE？这是正确的方法吗？有没有其他方法可以理解 connect() 失败？如果未连接套接字，我应该收到 FD_CLOSE 吗？

在成功调用 DoConnect() 后，我确实开始接收线程并订阅事件，我担心赛车条件会阻止我获得 FD_CLOSE。

这是一些代码：

```
int RecvSocketThread::WaitForData()
{
     int retVal = 0
     while (!retVal)
     {
         // sockets to pool can be added on other threads.
         // please validate that all of them in the pool are connected
         // before doing any reading on them
         retVal = DoWaitForData();
     }
}

int RecvSocketThread::DoWaitForData()
{
    // before waiting for incoming data, check if all sockets are connected
    WaitForPendingConnection_DoForAllSocketsInThePool();

    // other routine to read (FD_READ) or react to FD_CLOSE
    // create array of event (each per socket) and wait
}
void RecvSocketThread::WaitForPendingConnection_DoForAllSocketsInThePool()
{
    // create array and set it for events associated with pending connect sockets
    HANDLE* EventArray = NULL;
    int counter = 0;
    EventArray = new HANDLE[m_RecvSocketInfoPool.size()];

    // add those event whose associated socket is still not connected
    // and wait for FD_WRITE and FD_CLOSE. At the end of this function
    // don't forget to switch them to FD_READ and FD_CLOSE
    while (it != m_RecvSocketInfoPool.end())
    {
         RecvSocketInfo* recvSocketInfo = it->second;
         if (!IsEventSet(recvSocketInfo->m_Connected, &retVal2))
         {
             ::WSAEventSelect(recvSocketInfo->m_WorkerSocket, recvSocketInfo->m_Event, FD_WRITE | FD_CLOSE);
             EventArray[counter++] = recvSocketInfo->m_Event;
         }
         ++it;
    }
    if (counter)
    {
        DWORD indexSignaled = WaitForMultipleObjects(counter, EventArray, WaitAtLeastOneEvent, INFINITE);

        // no matter what is further Wait doen't return for failed to connect socket

        if (WAIT_OBJECT_0 <= indexSignaled &&
                   indexSignaled < (WAIT_OBJECT_0 + counter))
        {
            it = m_RecvSocketInfoPool.begin();
            while (it != m_RecvSocketInfoPool.end())
            {
                RecvSocketInfo* recvSocketInfo = it->second;
                if (IsEventSet(recvSocketInfo->m_Event, NULL))
                {
                  rc = WSAEnumNetworkEvents(recvSocketInfo->m_WorkerSocket,
                  recvSocketInfo->m_Event, &networkEvents);

                   // Check recvSocketInfo->m_Event using WSAEnumnetworkevents
                   // for FD_CLOSE using FD_CLOSE_BIT
                   if ((networkEvents.lNetworkEvents & FD_CLOSE))
                   {
                       recvSocketInfo->m_FD_CLOSE_Recieved = 1;
                       *retVal = networkEvents.iErrorCode[FD_CLOSE_BIT];
                   }
                   if ((networkEvents.lNetworkEvents & FD_WRITE))
                   {
                       WSASetEvent(recvSocketInfo->m_Connected);
                       *retVal = networkEvents.iErrorCode[FD_WRITE_BIT];
                   }
                }
                ++it;
            }
        }

        // if error - DoClean, if FD_WRITE (socket is writable) check if m_Connected
        // before do any sending
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:54:44.063

如果失败，您将不会收到`FD_CLOSE`通知。`connect()`您必须订阅才能`FD_CONNECT`检测到这一点。[这在connect() 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms737625.aspx)中有明确说明：

> 使用非阻塞套接字，连接尝试不能立即完成。在这种情况下，connect 将返回 SOCKET_ERROR，而 WSAGetLastError 将返回 WSAEWOULDBLOCK。在这种情况下，有三种可能的情况：
> 
> • 使用select 函数通过检查套接字是否可写来确定连接请求的完成。
> 
> **• 如果应用程序正在使用 WSAAsyncSelect 来表示对连接事件感兴趣，那么应用程序将收到一个 FD_CONNECT 通知，指示连接操作已完成（成功与否）。**
> 
> • 如果应用程序正在使用 WSAEventSelect 来指示对连接事件的兴趣，则将向关联的事件对象发出信号，指示连接操作已完成（成功与否）。

当 is 时，结果代码`connect()`将在事件的`HIWORD(lParam)`值`LOWORD(lParam)`中`FD_CONNECT`。如果结果代码为 0，`connect()`则表示成功，否则将是 WinSock 错误代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:12:57.227

如果您调用`connect()`并收到阻塞通知，则必须编写更多代码以通过[此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms737625%28v=vs.85%29.aspx)`connect()`描述的三种方法之一来监视完成（成功或失败）。

> 使用非阻塞套接字，连接尝试不能立即完成。在这种情况下，connect 将返回 SOCKET_ERROR，而 WSAGetLastError 将返回 WSAEWOULDBLOCK。在这种情况下，有三种可能的情况：
> 
> • 使用select 函数通过检查套接字是否可写来确定连接请求的完成。
> 
> • 如果应用程序正在使用 WSAAsyncSelect 来表示对连接事件感兴趣，那么应用程序将收到一个 FD_CONNECT 通知，指示连接操作已完成（成功与否）。
> 
> • 如果应用程序正在使用 WSAEventSelect 来指示对连接事件的兴趣，那么将向关联的事件对象发出信号，指示连接操作已完成（成功与否）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T13:51:19.493

我想我需要在创建套接字句柄后开始接收线程，但在调用 connect 之前。在异步套接字上调用 connect 后创建它为时已晚。对于同步套接字，这两个调用 createsocket() 和 connect() 只是两个连续的行。不适用于非阻塞。

在这种情况下，在接收线程开始时，我需要检查 FD_CONNECT 和/或 FD_WRITE 以便了解连接尝试状态。

# asp.net-mvc - EF 代码优先部署

> ID：10504156
> 
> 赞同：1
> 
> 时间：2012-05-08T18:16:17.050
> 
> 标签：asp.net-mvc, entity-framework-4.1, ef-code-first

我有一个基于我的模式创建数据库的 MVC 代码优先应用程序。在生产机器上，我们需要首先创建数据库（空的，没有表），以便我们可以在连接字符串中为我的 dbcontext 分配正确的用户名和密码。考虑到数据库是在生产环境中创建的，我的代码应该做什么？

我不能使用 DropCreateDatabaseIfModelChanges 因为已经创建了没有元数据的数据库..并且不能使用 DropCreateDatabaseAlways 因为我只需要第一次创建它。

我也试过这个：

```
 if (context.Database.Exists() && !context.Database.CompatibleWithModel(false))
                context.Database.Delete();

            if (context.Database.CreateIfNotExists()) 
```

但是由于某种原因，context.Database.CompatibleWithModel(false) 在空数据库上总是返回 TRUE...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:30:35.750

您可能需要通过 SQL 脚本手动部署数据库模式。您可以从生产数据库实例生成脚本。

# python - 左特征向量在 scipy 中没有给出正确的（马尔科夫）平稳概率

> ID：10504158
> 
> 赞同：4
> 
> 时间：2012-05-08T18:16:24.780
> 
> 标签：python, scipy, markov-chains

给定以下马尔可夫矩阵：

```
import numpy, scipy.linalg
A = numpy.array([[0.9, 0.1],[0.15, 0.85]]) 
```

平稳概率存在且等于`[.6, .4]`。这很容易通过矩阵的大幂来验证：

```
B = A.copy()
for _ in xrange(10): B = numpy.dot(B,B) 
```

在这里`B[0] = [0.6, 0.4]`。到现在为止还挺好。根据[维基百科](http://en.wikipedia.org/wiki/Stochastic_matrix)：

> 平稳概率向量被定义为在转移矩阵的应用下不改变的向量；也就是说，它被定义为概率矩阵的左特征向量，与特征值 1 相关联：

所以我应该能够计算特征值为 1 的**左**特征向量`A`，这也应该给我平稳概率。[Scipy 的实现`eig`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.eig.html#scipy.linalg.eig)有一个 left 关键字：

```
scipy.linalg.eig(A,left=True,right=False) 
```

给出：

```
(array([ 1.00+0.j,  0.75+0.j]), array([[ 0.83205029, -0.70710678],
   [ 0.5547002 ,  0.70710678]])) 
```

这说明主要的左特征向量是：`[0.83205029, 0.5547002]`。我读错了吗？如何`[0.6, 0.4]`使用特征值分解获得？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T20:18:20.883

`[0.83205029, 0.5547002]`只是`[0.6, 0.4]`乘以〜1.39 。

尽管从“物理”的角度来看，您需要其分量之和等于 1 的[特征向量，但按某个因子缩放特征向量并不会改变它的“特征”](http://en.wikipedia.org/wiki/Eigenvector)：

如果![\vec{v} A = \lambda \vec{v}](../Images/25b29ee8776791718945232c5a2935a2.png)，那么显然![(\alpha \vec{v}) A = \lambda (\alpha \vec{v})](../Images/dd0ecc11e7d2a7104096c55563a1f20f.png)

所以，要让`[0.6, 0.4]`你应该这样做：

```
>>> v = scipy.linalg.eig(A,left=True,right=False)[1][:,0]
>>> v
array([ 0.83205029,  0.5547002 ])
>>> v / sum(v)
array([ 0.6,  0.4]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-03T21:24:57.570

就特征向量而言，该`eig`函数返回*单位向量。*

所以，如果我们取 `v = [0.6, 0.4]`，它的*长度*是： `l = np.sqrt(np.square(a).sum())`或`l = np.linalg.norm(v)`，所以归一化向量（从 中返回`scipy.linalg.eig`）是：

```
>>> v = np.array([.6, .4])
>>> l = np.sqrt(np.square(a).sum())
>>> v / l
array([0.83205029, 0.5547002 ]) 
```

因此，如果您需要向量是马尔可夫链中的*随机向量*或*概率向量*，只需对其进行缩放，使其总和为 1.0

# java - Hibernate 没有足够快的刷新来捕获数据库异常

> ID：10504159
> 
> 赞同：0
> 
> 时间：2012-05-08T18:16:31.120
> 
> 标签：java, database, hibernate, exception, transactions

我有一个方法，在 Try/Catch 块内，它调用 Hibernate DB Save 操作来插入一行。

即使存在数据库问题（例如，当我将 NULL 插入非 NULL 列时），该方法也会成功完成。然后，在稍后的某个时间点，Hibernates 尝试“刷新”或完成事务，这就是引发错误的时候。

这弄乱了我的代码流程，因为我依赖于我的方法成功完成来做其他事情，例如发送电子邮件。调用我的方法后，我继续发送电子邮件，假设没有发生错误（否则我会被抛出我的代码流并进入我的 Catch 块，但这**不会**发生）。

有谁知道如何处理这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T18:20:03.047

简单的答案是简单地调用`Session.flush()`，任何挂起的 SQL 都会运行，从而导致当时可能潜伏的任何 SQL 异常发生。

在更大的范围内，您可能希望查看在应用程序级别验证数据的选项，而不是依赖 SQL 异常来检测错误。当然，任何一种方式都有优点和缺点。

# opengl - glsl着色器输入/输出变量包装

> ID：10504161
> 
> 赞同：1
> 
> 时间：2012-05-08T18:16:52.937
> 
> 标签：opengl, glsl

着色器输入/输出变量的顺序和/或大小是否会对内存使用或性能产生任何影响？例如，这些是：

```
// vert example:
out vec4 colorRadius;

// tess control example:
out vec4 colorRadius[];

// frag example:
in smooth vec4 colorRadius; 
```

相当于这些：

```
// vert example:
out vec3 color;
out float radius;

// tess control example:
out vec3 color[];
out float radius[];

// frag example:
in smooth vec3 color;
in smooth float radius; 
```

第二种形式是否有任何额外费用，或者编译器会将它们一起打包在内存中并完全相同对待？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T18:24:31.197

编译器*可以*将这些东西打包在一起。但这不是必须的，而且几乎没有证据表明编译器通常会这样做。所以顶版至少不会比底版慢。

同时，这更像是一种微优化。所以除非你知道这是一个瓶颈，否则就让它过去吧。最好在知道问题出在哪里时编写清晰、易于理解的代码并对其进行优化，而不是在不知道是否会成为问题的情况下对其进行优化。

# web-applications - 是否有基于规则的访问控制的简单通用实现？

> ID：10504165
> 
> 赞同：6
> 
> 时间：2012-05-08T18:17:13.747
> 
> 标签：web-applications, architecture, access-control

我正在实现一个 Intranet 站点的访问控制。如果公司没有 200 多名员工并且几乎每个人都没有自定义权限，这将很容易。这很疯狂，我知道，但我无法改变它。

所以，我试图找到一个可以满足我需求的通用实现，但找不到，所以我自己去做。最后，我想出了一个相当通用的解决方案，这让我想到：以前一定有人做过！

我称之为 STOP（主题任务对象权限）访问控制。我有以下关系：

```
.-------.     .-----------.     .-------.
| users |1---*| STOPRules |*---1| tasks |
`-------'     '-----------'     '-------' 
```

STOP 规则具有以下属性

```
STOPRule {
    Subject;
    Task;
    ObjectType;
    Permission;
    Relation;
} 
```

对象关系可以是：所有者、创建者、修订者等。此字段不是必需的，以支持通用任务。当它在那里时，当前用户和对象实例之间的关系由委托计算。然后将当前关系与规则上所需的关系进行比较，以允许或拒绝访问。

如果我不够清楚，请告诉我。

出现两个问题：

1.  有没有像这样的开源实现？

2.  你看到我在这条路上会遇到什么问题吗？

**编辑：**我继续并实际上开始实施这个模型。第一个问题是我需要主客体之间的关系来支持任何用例。现在，我可以存储以下规则：

**如果约翰**（主体）是订单的**创建者**（关系），他**可以**（许可）**编辑**（任务）**订单**（对象） 。

 **拜托，你们能提供一个无法用这个模型表达的真实用例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T00:46:32.653

实际上，让一个表具有按某些角色分组的权限，并使用另一个表来获得可以覆盖一般权限的扩展权限。如果是只让约翰访问某些东西的情况，为什么还要提到彼此不能呢？就像您在上面的评论中提供的最后一个示例一样：是否有一个具有权限的表。一条记录如下所示：1645 edit_some_field。然后 group_permissions 看起来像：`1645 everyone false`最终的异常表将是`1645 (Jane Doe's ID) true`.

如果假设有 50 人有权编辑此字段，那么您只需在组表中添加另一个组，例如：`89 editors_of_field_X`，将人员的 ID 放入表中`group_members`，例如`89 (John Smith's ID) true`。然后在最后一步，您可以覆盖上面提到的具有单人权限的那些。因此，总而言之，您将拥有 3 层方案。每个人-组-人。你走得越深，这个角色的重要性就越高。例如，如果不允许所有人，但允许您所在的组，那么您可以编辑某些内容。

此外，如果不允许您访问第三人称级别，那么您再次成为该组中的例外。这样您就可以在以后重用组，只需添加较小的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T03:33:24.630

John 创建了一个订单并希望让 Bob 查看它。**

# crystal-reports - 为每组选择组标题部分增加一个数字

> ID：10504166
> 
> 赞同：0
> 
> 时间：2012-05-08T18:17:16.353
> 
> 标签：crystal-reports

我有一个独特的问题，我什至不确定是否可能。

我有一份报告，每组有几个组标题。我想做的是让选择组标题（GH1a、GH1p、GH1w...）有一个自动递增的数字，然后我将使用 roman(@function) 将其转换为罗马数字。编号将与实际组的数量无关，仅与组标题无关。可能有 1 到 100,000 条记录（组）返回到报告中，但对于每个记录（组），每个组中的组标题将选择编号相同的组标题

前任：

A组

```
GH1a:  I
GH1b:  
GH1c:  II
GH1d:  III
GH1e:
GH1f:
GH1g:  IV 
```

B组

```
GH1a:  I
GH1b:  
GH1c:  II
GH1d:  III
GH1e:
GH1f:
GH1g:  IV 
```

ETC....

任何帮助，将不胜感激。我尝试在报告标题和我想使用以下代码递增的每个 GH 中使用全局变量 x：

在报告头和/或 GH1a //@iCountreset

```
 Global NumberVar iCount:=1; 
```

在我想要递增的每个 GH 中 //@iCounted

```
 Global Numbervar iCount;
    iCount:= iCount+1; 
```

然后第二个将其罗马化 //@RomanCount

```
 roman(@iCounted); 
```

我目前对它们进行了硬编码，但正在尝试将几个 rpt 文件组合成一个，唯一的区别是某些 GH 部分将被抑制，因此不计入编号。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:22:11.693

```
//{@reset}
WhilePrintingRecords;
Global Numbervar G1:=1;

//{@increment}
WhilePrintingRecords;
Global Numbervar G1:=G1+1;

//{@roman}
Roman({@increment}) 
```

** 编辑 **

瑞恩的评论是正确的。我的新方法使用子报表来增加共享变量，这很有效。

脚步：

添加“主”报告的{@reset} GH1a；压制

```
//{@reset}
WhilePrintingRecords;
Shared Numbervar G1:=0; 
```

创建子报告；将其置于 GH1b 中；将这些公式添加到其中：

添加到详细信息部分；压制：

```
//{@increment}
WhilePrintingRecords;
Shared Numbervar G1:=G1+1; 
```

添加到详细信息部分：

```
//{@roman}
Roman({@increment}) 
```

您需要将此子报表添加到需要罗马数字计算的每个部分。为了让这个过程不那么痛苦，导出子报表（“将子报表另存为”），然后重新插入它。

# python - python中的向量矩阵乘法？

> ID：10504167
> 
> 赞同：1
> 
> 时间：2012-05-08T18:17:21.780
> 
> 标签：python, vector, matrix, multiplication

所以我试图将一个矩阵乘以一个向量。并且python不断抛出错误。这是我正在尝试的代码：

```
def matmult(m, v):
    rows = len(m)
    w = [0]*rows
    irange = range(len(v))
    sum = 0
    for j in range(rows):
        r = m[j]
        for i in irange:
            sum += r[i]*v[i]
    w[j],sum = sum,0
return w 
```

这不是我的，但那是我在生气并删除它之前编码的。错误是这样的：TypeError: +: 'int' and 'list' 不支持的操作数类型

我猜 python 将向量视为一个 int 或一个列表，并且由于类型的不同而不会执行任何基本运算符。有什么办法可以解决这个问题？不幸的是我不能使用 Numpy。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T18:25:19.313

这是纯python矩阵时间向量乘法的另一种更短的方法：

```
 import operator
 import itertools

 def dot(x, y):
     assert len(x) == len(y)
     return sum(itertools.starmap(operator.mul, itertools.izip(x, y)))

 def matmult(m, v):
     return [dot(row, v) for row in m] 
```

（这适用于 python 2 -`itertools.izip`仅`zip`在 python 3 中替换。）

# event-handling - jquery 实时点击事件 stopPropagation

> ID：10504168
> 
> 赞同：0
> 
> 时间：2012-05-08T18:17:21.947
> 
> 标签：event-handling, live, jquery, stoppropagation

我有一个下拉菜单，其中包含一个输入和几个按钮。当我单击其中一个按钮或其他地方时，下拉菜单应该隐藏，但在输入键时不要隐藏。我使用以下代码，它不起作用。虽然它在我使用时有效

```
$('.dropdown input').click(function(e){

}) 
```

而不是`live`.

但我确实需要`live`，所以有什么解决方案吗？

```
/*  dropdown menu   */
$('.dropdown input').live('click', function(e) {
    e.stopPropagation();
});

$(document).click(function(e){
    if(e.isPropagationStopped()) return;  //important, check for it!
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:22:04.210

`e.stopPropagation()`在 中对你没有好处`.live()`，因为处理程序绑定到`document`，所以在调用处理程序时，事件已经冒泡了。

您应该`stopPropagation`从被单击元素的更本地的祖先。

由于您使用的是`.live()`，我假设正在创建一些动态元素。如果是这样，绑定到的正确元素将取决于您的代码的其余部分。

* * *

旁注，但你从不“需要” `.live()`。还有其他方法可以处理动态创建的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:22:35.443

你试过了吗：

```
$('.dropdown').on('click', 'input', function(e) {
    e.stopPropagation();
}); 
```

或者

```
$('.dropdown').delegate('input', 'click', function(e) {
    e.stopPropagation();
}); 
```

**注意：** [e.stopPropagation(); 对直播活动无效](http://api.jquery.com/live/#typefn)

根据你的问题***，我有一个下拉菜单，其中包含一个输入和几个按钮。下拉菜单应该隐藏...***意味着下拉菜单已经存在于您的 DOM 中。如果它已经存在，那么您不需要现场活动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:24:14.117

你用的是什么版本的jQuery？> 1.7 然后：

```
$(document).on({"click":function(e){
  //do your work, only input clicks will fire this
}},".dropdown input",null); 
```

注意：正确注意 event.target 应该有助于使用 .on() 重叠“点击”定义；

# apache - 允许使用 .htaccess 访问（通过地址和身份验证）

> ID：10504171
> 
> 赞同：0
> 
> 时间：2012-05-08T18:17:38.533
> 
> 标签：apache, .htaccess

我有以下内容，但它无法正常工作。

我在本地运行此服务器，但现在已配置为外部访问。我希望它能够工作，如果您不在我的内部网络中，则必须进行身份验证。

身份验证有效，但是无法让 httpd 接受此代码，因此一定有问题。就是想不出来是哪个！

```
Order Deny, Allow
Deny from all    
Satisfy Any

Allow from 127.0.0.1
Allow from 192.168

AuthUserFile "C:/Program Files/wamp/htpasswd.txt"
AuthName "Piss off :-)" 
AuthType Basic 

Require valid-user 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:19:54.903

交换`Order`：

```
Order Allow,Deny 
```

# java - 如何关闭 ExecutorService？

> ID：10504172
> 
> 赞同：50
> 
> 时间：2012-05-08T18:17:50.153
> 
> 标签：java, multithreading, executorservice, shutdown

每当我打电话`shutdownNow()`或`shutdown()`它不会关闭。我读过一些帖子说不能保证关闭 - 有人可以为我提供一个好的方法吗？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-05-08T18:41:03.317

典型的模式是：

```
executorService.shutdownNow();
executorService.awaitTermination(); 
```

调用`shutdownNow`时，执行程序（通常）会尝试中断它管理的线程。要使关闭优雅，您需要在线程中捕获中断的异常或检查中断状态。如果您不这样做，您的线程将永远运行，您的执行程序将永远无法关闭。这是因为Java 中线程的中断是一个协作过程（即被**中断**的代码在被要求停止时必须做某事，而不是**中断**的代码）。

例如，以下代码打印`Exiting normally...`. 但是，如果您注释掉该行`if (Thread.currentThread().isInterrupted()) break;`，它将打印`Still waiting...`，因为执行程序中的线程仍在运行。

```
public static void main(String args[]) throws InterruptedException {
    ExecutorService executor = Executors.newFixedThreadPool(1);
    executor.submit(new Runnable() {

        @Override
        public void run() {
            while (true) {
                if (Thread.currentThread().isInterrupted()) break;
            }
        }
    });

    executor.shutdownNow();
    if (!executor.awaitTermination(100, TimeUnit.MICROSECONDS)) {
        System.out.println("Still waiting...");
        System.exit(0);
    }
    System.out.println("Exiting normally...");
} 
```

或者，它可以这样写`InterruptedException`：

```
public static void main(String args[]) throws InterruptedException {
    ExecutorService executor = Executors.newFixedThreadPool(1);
    executor.submit(new Runnable() {

        @Override
        public void run() {
            try {
                while (true) {Thread.sleep(10);}
            } catch (InterruptedException e) {
                //ok let's get out of here
            }
        }
    });

    executor.shutdownNow();
    if (!executor.awaitTermination(100, TimeUnit.MICROSECONDS)) {
        System.out.println("Still waiting...");
        System.exit(0);
    }
    System.out.println("Exiting normally...");
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-05-25T17:22:46.457

最好的方法是我们在 javadoc 中实际拥有的内容：

> 以下方法分两个阶段关闭**ExecutorService**，首先调用`shutdown`以拒绝传入的任务，然后 `shutdownNow`在必要时调用 取消任何延迟的任务：

```
void shutdownAndAwaitTermination(ExecutorService pool) {
    pool.shutdown(); // Disable new tasks from being submitted
    try {
        // Wait a while for existing tasks to terminate
        if (!pool.awaitTermination(60, TimeUnit.SECONDS)) {
            pool.shutdownNow(); // Cancel currently executing tasks
            // Wait a while for tasks to respond to being cancelled
            if (!pool.awaitTermination(60, TimeUnit.SECONDS))
                System.err.println("Pool did not terminate");
        }
    } catch (InterruptedException ie) {
        // (Re-)Cancel if current thread also interrupted
        pool.shutdownNow();
        // Preserve interrupt status
        Thread.currentThread().interrupt();
    }
} 
```

# android - 如何将布局或 webview 内容发送到另一个活动？

> ID：10504174
> 
> 赞同：-1
> 
> 时间：2012-05-08T18:18:04.107
> 
> 标签：android, android-layout, android-intent, android-webview

我的项目中有 2 项活动。在我的第一个活动中，我有按钮，布局名称是`m_MyWebView`. 在我的布局文件夹中，我有 webviewlayout，我可以`m_MyWebView`在我的代码中的布局中设置它。我想要这样，在我单击按钮后，另一个活动将被打开（这不是问题），而`WebView`我在“撰写”布局中的另一个活动将获得类似 webviewlayout 的内容。但是，我不知道如何有意图地做到这一点。因为我无法发送有意图的内容。

这是我的代码：

我的 ForwardReplyActivity 类：

```
public class ForwardReplyActivity extends Activity {

    private ImageButton m_Reply;
    private WebView webview;
    private LinearLayout m_MyWebView;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        m_MyWebView = (LinearLayout) findViewById(R.id.MyWebViewL);
        View view = getLayoutInflater().inflate(R.layout.webviewlayout,
                m_MyWebView, false);
        WebView wb = (WebView) view.findViewById(R.id.WebViewim);

        //wb.getSettings().setJavaScriptEnabled(true);
        wb.loadDataWithBaseURL(null,
                "bla bla bla", "text/html", "UTF-8",
                null);

        m_MyWebView.addView(view);
        m_Reply = (ImageButton) findViewById(R.id.imageButton1);

        m_Reply.setOnClickListener(new Button.OnClickListener() {
            public void onClick(View view) {
                Intent intent = new Intent(ForwardReplyActivity.this,
                        Compose.class);

            }
        });
    }

} 
```

和我的撰写课程：

```
public class Compose extends Activity {

    private WebView webview;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.compose);

        webview = (WebView) findViewById(R.id.webView1);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:26:07.520

我从您的问题中了解到，您想将一些数据从一项活动用于另一项活动，

所以你需要`putExtras`有你的意图。

# c# - 使用 Microsoft Expression Encoder 和一系列位图在 C# 中生成视频

> ID：10504176
> 
> 赞同：0
> 
> 时间：2012-05-08T18:18:18.493
> 
> 标签：c#, .net, video, video-encoding, expression-encoder-sdk

我需要用 C# 生成视频。我正在使用 Microsoft Expression Encoder，但我拥有的是特定时间索引处的一系列位图。有没有办法使用 Microsoft Expression Encoder 使用我所描述的一系列位图对视频进行编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:26:05.270

它可以完成，但表达式编码器不是正确的方法。

[来自他们论坛中的 Microsoft 员工](http://social.expression.microsoft.com/Forums/en-US/encoder/thread/a6ff6437-8ff6-4698-8791-ab96a4c549ba)：

> 这种技术被称为“延时”或“定格”，不幸的是，Expression Encoder 本身并不是正确的工具。如果您愿意，您可以使用 AVSynth 脚本作为 Encoder 的源，但其他定制的产品这样做只会为您带来更好的结果。

并[远离同一员工](http://social.expression.microsoft.com/Forums/en-US/encoder/thread/6c12be0b-8b7b-4c39-849d-46ea166c761d/)：

> 不幸的是，编码器并不直接支持这种情况。我们的管道不是为处理那么多输入文件而构建的。可能有一种方法可以使用 AVISynth（我们确实支持）来执行此操作，否则您可能需要使用 3rd 方工具来创建我们可以导入的视频文件。除了使用 QTP 之外，看起来尝试这样做的人正在使用 Adob​​e AfterEffects 来执行此操作。其他人则使用免费软件，例如 Photo Lapse 3 或 VirtualDub。

# java - Vector 和 ArrayDeque 类

> ID：10504187
> 
> 赞同：3
> 
> 时间：2012-05-08T18:19:08.737
> 
> 标签：java, arrays, class, vector

Vector 和 ArrayDeque 类之间有什么区别？我昨天读到了 ArrayDeque 类，而我之前使用过 Vector 类。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T18:30:14.410

基本情况是：

`Vector`implements `java.util.List`，它定义了允许基于索引访问元素的容器。它还实现`interface RandomAccess`了 ，它向用户表明底层表示允许快速（通常`O(1)`）访问元素。

`ArrayDeque`implements `java.util.Deque`，它定义了一个容器，该容器支持从容器的开头和结尾快速添加和删除元素。

主要区别：

*   `Vector``List.add(int index, E element)`支持使用or的重载版本将元素添加到容器的中间`List.addAll(int index, Collection<? extends E> c)`。

*   `Vector`支持从容器中间移除元素，使用`remove`方法。

*   `Vector`的`set`和`setElementAt`方法允许您进行就地元素交换（将一个对象替换为另一个对象`Vector`，一个`O(1)`操作）。

*   `add`ing 到 a 的末尾`Vector`是摊销的常数时间。添加到向量的开头或中间的是线性时间操作 ( `O(n)`)。

*   `ArrayDeque`具有摊销常数时间 ( `O(1)`) 在容器前后添加/删除元素。

*   `ArrayDeque`不允许您专门删除容器中某个位置的元素。类的各种`remove`、`removeFirst`和`removeLast`方法允许您稍微有限地删除元素。

*   `ArrayDeque`带有使用类的方法，例如队列（`peek`, `poll`, `add`, `addFirst`）和堆栈（`offer`, `push`, `pop`, `peekLast`, `addLast`），或者两者都喜欢（因此它是[双端队列](http://en.wikipedia.org/wiki/Double_ended_queue)）。

*   `ArrayDeque`不支持将元素添加到双端队列的中间。

*   `Vector`具有特殊`ListIterator`的 s ，它允许您获取从容器中特定位置开始的迭代器，并且还支持添加、删除和设置元素。`ArrayDeque`的迭代器不支持那些额外的方法。

*   `Vector`是一个同步容器，这意味着它已经包含为多线程环境执行同步/锁定的代码。对于`ArrayDeque`，如果您对容器进行多线程访问，则必须提供自己的同步代码。请注意，`ArrayList`它与`Vector`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T18:26:14.573

几个区别：

*   Vector 实现`List`接口，而 ArrayDeque 实现`Queue`接口。这些是不同的接口，提供不同的操作集：Vector 是您的香草容器，而`*Queue`更面向多线程应用程序（生产者/消费者模式），因为它具有诸如`poll`等的方法`offer`；
*   Vector 线程安全（它具有内置同步），ArrayDeque 不是线程安全的；
*   从 1.0 版开始包含在 JDK 中的向量，从 1.6 版开始包含在 ArrayDeque 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-12T14:49:11.570

根据 Oracle 文档 Vector 和 Stack 是遗留类，您应该使用 Arraylist 和 ArrayDeque 代替。 [https://docs.oracle.com/javase/tutorial/collections/implementations/index.html](https://docs.oracle.com/javase/tutorial/collections/implementations/index.html) [https://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html](https://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)说“（这个类大致相当于 Vector，只是它是不同步的。）"

# java - Web服务请求执行时间计算

> ID：10504189
> 
> 赞同：12
> 
> 时间：2012-05-08T18:19:14.913
> 
> 标签：java, cxf

我有一个使用 CXF 在 Java 中实现的工作 SOAP Web 服务。在服务器端计算方法执行的好方法是什么？

我现在所做的是使用拦截器。我已经`public static long start`在我的 InInterceptor(Phase.RECEIVE) 中定义了。在我的 OutInterceptor(Phase.SEND) 我计算响应时间是这样的：

```
 @Override
    public void handleMessage(Message arg0) {
        long stop = System.currentTimeMillis();
        long executionTime = stop - RequestStartInterceptor.start;
        System.out.println("execution time was ~" + executionTime + " ms");
    } 
```

有一个更好的方法吗？我正在阅读有关通过代理执行方法的信息，但我不知道该怎么做。

问题更新：

我用谷歌搜索了更多使用代理的第二种方式，即：

```
@Aspect
public class MyServiceProfiler {

     @Pointcut("execution(* gov.noaa.nhc.*.*(..))")
         public void myServiceMethods() { }

         @Around("myServiceMethods()")
         public Object profile(ProceedingJoinPoint pjp) throws Throwable {
                 long start = System.currentTimeMillis();
                 System.out.println("Going to call the method.");
                 Object output = pjp.proceed();
                 System.out.println("Method execution completed.");
                 long elapsedTime = System.currentTimeMillis() - start;
                 System.out.println("Method execution time: " + elapsedTime + " milliseconds.");
                 return output;
         }
    } 
```

根据到目前为止对这个问题的评论，使用拦截器比使用代理更好。我希望尽可能减慢 Web 服务的速度（这肯定会减慢速度），同时获得精确的性能测量。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-10T22:12:56.473

我不推荐您使用 InInterceptor 和 OutInterceptor 的第一种方法 - 原因是没有干净的方法来存储 starttime - 您有令牌将其存储在静态变量中的方法在线程环境中不起作用。

您使用 AOP 的第二种方法非常好，但是它不会给出在 CXF 堆栈中花费的时间，它只会在调用到达您的服务层时提供时间。

我觉得最好的方法是使用 servlet 过滤器，你可以这样做：

```
public void doFilter(ServletRequest request,  ServletResponse response, FilterChain chain) throws IOException, ServletException {
    long start = System.currentTimeMillis();   
    chain.doFilter(request, response);
    long elapsedTime = System.currentTimeMillis() - start;
    System.out.println("Method execution time: " + elapsedTime + " milliseconds.");
} 
```

并在您为 CXFServlet 提供映射的同一 uri 中提供映射。

这应该更清洁。如果您想要更精细的东西，您可以将这种方法与您的 AOP 方法混合使用，以找出总体响应时间，然后将其分解为各个服务方法时间。

```
<servlet>
    <servlet-name>CXFServlet</servlet-name>
    <servlet-class>org.apache.cxf.transport.servlet.CXFServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>CXFServlet</servlet-name>
    <url-pattern>/webservices/*</url-pattern>
</servlet-mapping> 
<filter-mapping>
    <filter-name>ExecTimeFilter</filter-name>
    <url-pattern>/webservices/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
</filter-mapping> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-24T12:18:47.240

根据[马特的回答](https://stackoverflow.com/a/10554875/1431)，我得出以下结论。关键是在 OutgoingInterceptor 中，您需要获取传入消息并从中获取起始时间戳。

```
public class IncomingInterceptor extends AbstractPhaseInterceptor<Message> {

    public IncomingInterceptor() {
        super(Phase.RECEIVE);
    }

    @Override
    public void handleMessage(Message msg) throws Fault {
        long startTime = System.currentTimeMillis();
        msg.put("my.timing.start", startTime);
    }
}

public class OutgoingInterceptor extends AbstractPhaseInterceptor<Message> {
    Logger log = LoggerFactory.getLogger(AbstractPhaseInterceptor.class);
    public OutgoingInterceptor() {
        super(Phase.SEND);
    }

    @Override
    public void handleMessage(Message msg) throws Fault {
        Long startTime = (Long)msg.getExchange().getInMessage().remove("my.timing.start");
        if (startTime != null) {
            long executionTime = System.currentTimeMillis() - startTime;
            log.info("execution time was ~" + executionTime + " ms");
        } else {
            log.info("timer not found");
        }
    }       
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T16:02:29.327

我认为拦截器可以将任意数据放入`Message`对象中，因此您可以将开始时间存储在那里，然后将其取回以计算经过的时间。

```
// in your receive interceptor
@Override
public void handleMessage(Message message) {
    long startTime = System.currentTimeMillis();
    message.put("my.timing.start", startTime);
} 
```

.

```
// in your send interceptor
@Override
public void handleMessage(Message message) {
    Long startTime = message.remove("my.timing.start");
    if (startTime != null) {
        long executionTime = System.currentTimeMillis() - startTime;
        System.out.println("execution time was ~" + executionTime + " ms");
    }
} 
```

CXF 将一些自己的数据存储在消息映射中，但它的大多数键都以`org.apache.cxf`or开头`javax.xml.ws`，因此您可以通过使用其中一个拦截器的完全限定类名来使映射键唯一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T19:17:19.923

> 计算服务器端的方法执行？

使用`Interceptors`你也在测量`CXF`！
我的意思`Interceptors`是用于预先/后处理与*您的*应用程序逻辑相关的消息。
使用`Interceptor`您的测量包括 CXF 流量链的一部分。
如果这是你想要的，那么好的。
但是如果你想测量你的方法执行，你应该把时间间隔与你的方法联系起来。

# java - 有没有办法在不构建整个项目的情况下运行 JSF 页面？

> ID：10504190
> 
> 赞同：17
> 
> 时间：2012-05-08T18:19:16.253
> 
> 标签：java, jsf, testing

有没有办法只运行一个页面，这样我就可以看到生成的 html（和 css），即使它本质上是非功能性的，用户也会看到它？独立的 JSF 页面。我想回顾一下我是如何设置表单的，以在实际为表单字段编码之前从用户的角度来看它们是否有意义。我正在使用 maven 和 netbeans，但不确定后者是否相关。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-08T19:04:23.227

如果您使用的是 JSF2 Facelets，那么您只需使用纯 HTML 设计表单并使用该`jsfc`属性来指定应在 JSF 运行时使用的相应 JSF 组件。例如

```
<form jsfc="h:form">
    <label jsfc="h:outputLabel" for="input1" />
    <input type="text" jsfc="h:inputText" id="input1" value="#{bean.input1}" required="true" />
    <span jsfc="h:message" for="input1" />
    <input type="submit" jsfc="h:commandButton" value="Submit" action="#{bean.submit}" />
</form> 
```

阅读 Facelets [`<ui:xxx>`taglib 文档](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/ui/tld-summary.html)也应该提供一些见解。例如

```
<span jsfc="ui:remove">
    This is present during design time, but is removed during JSF runtime.
</span>

<div jsfc="ui:repeat" value="#{bean.items}" var="item">#{item}</div>

<table>
    <tr jsfc="ui:repeat" value="#{bean.items}" var="item">
        <td>#{item.id}</td>
        <td>#{item.name}</td>
    </tr>
</table> 
```

并且您可以使用它`<ui:composition>`来指定 Facelet 组合（例如包含文件或标记文件）的开始和结束。运行时外部的任何内容都将被忽略，但您仍然可以在设计时放置一些 HTML，以便您可以轻松预览包含文件或标记文件应该是其中一部分的完整设计。

```
<!DOCTYPE html>
<html lang="en"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
>
    <head>
        ...
    </head>
    <body>
        ...
        <ui:composition>
            Here you can design content of include file or
            tag file as if it's part of the whole design.
        </ui:composition>
        ...
    </body>
</html> 
```

这一切都允许您在不需要 JSF 运行时的情况下预览 HTML/CSS 设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T18:23:28.910

如果不部署构建的应用程序，您将无法直接执行 JSF 页面。您必须部署它，然后才能显示已执行的页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T18:31:38.103

JBoss Tools for Eclipse 在其可视化编辑器中基本支持 JSF-tags。

我简单地玩了一下它，但它不完全支持我们的旧页面，所以我把它留在了那里。从空白页开始可能会更好。

# python - 在 Python 中与密钥库进行 https 握手

> ID：10504195
> 
> 赞同：2
> 
> 时间：2012-05-08T18:19:44.537
> 
> 标签：python, ssl, https, pkcs#12

我设置了一个拒绝没有有效 .p12 证书的连接的 Web 服务器。我需要使用 Python 脚本访问在服务器上运行的 REST API，但我找不到任何有关如何执行此操作的信息。如果有人有关于如何在 Python 中使用 .p12 证书执行 SSL 握手的好教程，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T23:55:27.673

The same methods described in the answers to [this question](https://stackoverflow.com/q/1087227/372643), which asks about verifying a server certificate during the HTTPS connection (this is not done at all by default by `urllib` or `httplib`) should allow you to specify a client-certificate in addition to the CA certificate lists.

*   If you choose the option based on [`ssl.wrap_socket`](http://docs.python.org/library/ssl.html), pass a `cerfile`/`keyfile` parameter as described in the documentation.
*   Using PycURL, you should be able to call `setopt(pycurl.SSLCERT, "/path/to/cert.pem")` and `setopt(pycurl.SSLKEY, "/path/to/key.pem")`. The option names are based on the [*SSL and SECURITY OPTIONS* section of the cURL documentation](http://curl.haxx.se/libcurl/c/curl_easy_setopt.html) (there's an option for the password too).

It's likely that you will have to convert your PKCS#12 (`.p12`) file into PEM format. To do so:

```
# Extract the certificate:
openssl pkcs12 -in filename.p12 -nokeys -out certificate.pem

# Extract the private key:
openssl pkcs12 -in filename.p12 -nocerts -out privkey.pem 
```

# sql-server - 将一个查询中的文件名与另一个查询 sql 进行比较

> ID：10504200
> 
> 赞同：-2
> 
> 时间：2012-05-08T18:20:03.980
> 
> 标签：sql-server

我有一种情况，我想将一个查询中的文档名称与查询进行比较。

我有一个名为 tbl_doc 的表，其中包含 document_name 列。

另一个名为 tbl_content 的表包含 content_name。

我有两个选择查询，例如

```
select document_name from tbl_doc

select content_name from tbl_content. 
```

所以我需要将 document_name 与 content_name 进行比较，如果它们相等则需要进行插入操作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:28:07.373

您可能的意思是检查某个值是否存在...

```
IF EXISTS( 
    SELECT 1 FROM [tbl_doc] 
    JOIN [tbl_content] ON [tbl_doc].[document_name] = [tbl_content].[content_name] 
    WHERE [tbl_doc].[document_name] = @Name )
BEGIN
    INSERT INTO [...]
    (
        ...
    )
    SELECT
        ...   
END 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T18:23:55.457

```
select document_name,content_name
from tbl_doc
join tbl_content on document_name=content_name 
```

# c++ - 使用 QDoubleValidator 验证大于底部的值

> ID：10504207
> 
> 赞同：0
> 
> 时间：2012-05-08T18:20:35.103
> 
> 标签：c++, qt

我有一个`QLineEdit`我想验证双精度值。使用`QDoubleValidator::setBottom(0)`允许 0 作为有效值，但是我想强制该值**严格大于**0，而不是 0。有任何想法吗？

注意：我曾考虑将底部设置为`1E-05`或类似的效果，但这感觉就像我在作弊，我不想将值限制为特定的准确性。

# sencha-touch-2 - 如何将地图标记链接到 Sencha Touch 上的详细视图（建筑师 2）

> ID：10504208
> 
> 赞同：0
> 
> 时间：2012-05-08T18:20:47.003
> 
> 标签：sencha-touch-2, marker, detailview

我有一张带有标记的地图，我想让标记可点击以显示一些基本信息。

我是 Sencha 的新手，我需要建议我应该在侦听器功能中实现什么以获得与单击列表项相同的效果：

例如，这是我的 maprender 函数代码

```
var lat = 37.428607;
var lng = -122.169344;

var latLng = new google.maps.LatLng(lat, lng);

var marker = new google.maps.Marker({
    position: latLng,
    map: gmap,
    draggable: false,
    animation: google.maps.Animation.DROP,
    title: 'cool'
});

var contentString = 'bla bla bla';

var infowindow = new google.maps.InfoWindow({
    content: contentString
});

google.maps.event.addListener(marker, 'click', function() {
      /* here comes something that will make my detail list visible with the marker details*/
}); 
```

我想让它以与我在列表中使用的“itemtap”函数相同的方式工作......像这样：

```
onMyListItemTap: function(dataview, index, target, record, e, options) {
this.setActiveItem('detalji');this.down('#back').show();
this.down('#detalji').setData(record.data);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T20:55:23.567

在 Github 上有一个很棒的 Sencha Touch 1 示例……我相信它叫做 World Map。如果您解压缩它（该应用程序位于多个文件夹之一中），您可以看到带有多个自定义标记的 Google 地图。这个项目对学习非常有用，因为它不仅显示自定义地图标记，而且在标记单击时也会弹出叠加层。

我还没有让它适应 Sencha Touch 2，但应该不会太难......这里有一些示例代码（在添加了多个标记之后）：

```
 google.maps.event.addListener(marker, 'click', function() 
                {
        if (!this.popup) 
                    {
          this.popup = new Ext.Panel(
                            {
            floating: true,
            modal: true,
            centered: true,
            width: 500,
            styleHtmlContent: true,
            scroll: 'vertical',
            items:[{
              xtype:'button', 
              ui:'round',
              text:'See Country Profile',
              handler:goToCountryWrapper,
              scope : this
            },
            (new countryOverlay(country)).overlayPanel
            ],
                layout: {
              type: 'auto',
              padding: '55',
              align: 'left'
            },
            dockedItems: [{
              dock: 'top',
              xtype: 'toolbar',
              title: country.title
              }],
          });
        };
        this.popup.show('pop');
      }); 
```

此外，我认为根据我对 Sencha Touch 2 的了解，您必须在地图控制器中放置一个侦听器（MyApp.map.controller 文件）......阅读有关参考文献的信息，因为参考文献“找到”标记（ s) 您已经定义并添加了一个监听器到该项目。

如果您有任何进展，请发布您的发现:-)

# android - Android 编程风格

> ID：10504213
> 
> 赞同：1
> 
> 时间：2012-05-08T18:21:14.803
> 
> 标签：android

我最近一直在为我的 Android 手机编写代码，我一直在想……这个 Intent 类是否应该勾勒出一种新的编程风格？

我一直怀疑 API 设计不鼓励 MVC：意图是与所有用户相关对象（活动、服务、其他应用程序......）交互的主要方式。

我的思路对吗？是否应该坚持用业务逻辑“污染”活动？

我一直在阅读 android 开发者网站，但不鼓励使用特定的编码风格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:38:05.570

您的问题并不完全清楚，因为您似乎将编码*风格*与程序*架构*混淆了。

在我看来，Android 在编码风格方面确实没有任何改变。您的 Java 编码风格仍然可以正常工作，并且大多数 Android 应用程序看起来与其他应用程序非常相似。概括地说，有些事情你可能想在 Android 中做，而在其他语言中做不到，[请参阅 Android 指南了解详细信息。](http://developer.android.com/guide/practices/design/performance.html) 基本思路是：内存是有限的，没用就不要用。

就整个程序架构而言，是的，Android 风格高度基于消息传递（通过 Intent 对象）风格。*您对 Activity中*的GUI 事件做出反应的方式仍然大致相同：您使用事件处理程序来对按钮按下等事件做出反应……但该平台主要围绕使用不同组件（Activity、Services、BroadcastReceivers）设计应用程序, etc...) 和 Intents 在它们之间进行通信。虽然 Intent 提供了一种在组件之间交换数据的灵活方式，但您仍然不应该在 Intent 中传递大量数据，而应该将这些类型的东西放在 ContentProvider 或类似的东西中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T20:11:36.940

我从这本[OReilly 书中](https://rads.stackoverflow.com/amzn/click/com/1449389694)获得了以下很多想法。这对我来说是最有效的。

就架构而言，它帮助我将 Android 的 UI 视为一种[页面控制器](http://martinfowler.com/eaaCatalog/pageController.html)模式——我发现它实际上类似于 .Net Web 表单。所以是的，它确实适合 MVC（至少是它的页面控制器风格）。Activity 是您的控制器，您通常将视图存储在 XML 中，并且您可以根据自己的喜好构建模型。

你会在 Android 中看到很多类似网络的想法。Intent 很像 HTTP，或者更普遍的 REST。Intent 有一个“名词”来说明它们所关心的内容（可以是明确的类声明，即：转到特定的 Activity，或者可以使用 Intent 过滤器更隐含），Action 很像 HTTP 动词（Get、Post等），Bundle 很像查询字符串参数或有效负载...等的列表。

与网页类似，您希望 Activity 能够自行处理。我的意思是，您不想在活动之间传递一些大的序列化对象，只需将给定记录的 id 传递给下一个活动并让该活动抓住使用数据库中的该 ID 记录（ContentProvider，其他一些持久源......）。活动也意味着松散耦合，您应该能够从各种路径导航到其中一个，这也使它们更易于重用。因此，允许 Activity 的调用者简单地提供一个 recordId 比 Activity 期望它的消费者提供一个大的序列化对象要容易得多。

底线 - 不，您不需要使用业务逻辑污染活动，将这些东西藏在应用层或网关或类似的东西中。至于持久性，ContentProvider 接口设计得非常好——我非常喜欢它。它还延续了 Android RESTful 主题，通过 URL 和动词（查询、删除、更新、插入）访问内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:41:41.283

发送和接收意图很像发送和注册（类似于发布-订阅通道）命令消息（例如在分布式企业应用程序中，这是关于架构，而不是风格）。这种模式有助于设计一个松散耦合的交互应用系统。
我不记得在用于单台计算机上的组件和应用程序交互之前见过类似的架构，但它有助于使用其他应用程序设计应用程序以轻松构建功能/组件生态系统。

# database - 查询最后一天、上周、上个月SQLite

> ID：10504218
> 
> 赞同：21
> 
> 时间：2012-05-08T18:21:48.427
> 
> 标签：database, sqlite, datetime

我的 Android SQLite DB 中有这张表：

```
CREATE TABLE statistics (subject TEXT, hits INTEGER, fails INTEGER, date DATE) 
```

On`date`字段存储`datetime('now', 'localtime')`在每个寄存器中。

现在我必须查询最后一天、上周和上个月的寄存器以显示一些统计数据。我一直在尝试这样的事情

```
 SELECT Timestamp, datetime('now', '-1 week') FROM statistics WHERE TimeStamp < datetime('now', '-1 week') 
```

和这个

```
 SELECT * FROM statistics WHERE date BETWEEN datetime('now', localtime') AND datetime ( 'now', '-1 month') 
```

并且不起作用:(

我该怎么做？

我可以通过在虚拟设备模拟器中简单地转发日期来检查查询是否正常吗？

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-09T11:36:36.777

我找到了这个解决方案。我希望这个对你有用。

最后一天：

```
SELECT * FROM statistics WHERE date BETWEEN datetime('now', 'start of day') AND datetime('now', 'localtime'); 
```

上周：

```
SELECT * FROM statistics WHERE date BETWEEN datetime('now', '-6 days') AND datetime('now', 'localtime'); 
```

上个月：

```
SELECT * FROM statistics WHERE date BETWEEN datetime('now', 'start of month') AND datetime('now', 'localtime'); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-06-28T18:02:51.030

这段代码应该能让你上个月

```
SELECT * 
FROM statistics 
WHERE date >= date('now','start of month','-1 month')
AND date < date('now','start of month') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-09-17T09:14:55.863

```
SELECT * 
FROM statistics 
WHERE date >= date('now','start of month','-1 months')
AND date < date('now','start of month') 
```

在更多的月份，是**“月份”**，而不是像其他人之前所说的**月份。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-29T10:34:07.180

```
SELECT 
max(date(date, 'weekday 0', '-7 day')) WeekStart,
max(date(date, 'weekday 0', '-1 day')) WeekEnd,date 
FROM table; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T06:55:22.577

这段代码有望带来前一周的记录

```
SELECT  * FROM  order_master
WHERE strftime('%Y-%m-%d',om_date) >= date('now','-14 days') AND 
strftime('%Y-%m-%d',om_date)<=date('now') order by om_date LIMIT 6 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-08T17:29:13.867

您可以创建一个日历，然后从中获取时间戳

```
final Calendar todayCalendar = Calendar.getInstance();
final long todayTimestamp = todayCalendar.getTime().getTime();
todayCalendar.add(Calendar.DAY_OF_YEAR, -7);
final long aWeekAgoTimestamp = todayCalendar.getTime().getTime();
final String selection = TABLE_COLUMN_DATE_CREATED + " BETWEEN " + aWeekAgoTimestamp + " AND " + todayTimestamp; 
```

# windows - .aspx 页面的 IIS 限制错误，但 .aspx 不受限制

> ID：10504224
> 
> 赞同：3
> 
> 时间：2012-05-08T18:22:12.807
> 
> 标签：windows, iis, web-config, targetprocess

我最近尝试在我的 Windows 机器上安装 TargetProcess [http://www.targetprocess.com/](http://www.targetprocess.com/)，这涉及安装 IIS 和 SQLEXPRESS 实例。

我以前没有 IIS，所以对我来说最陌生的概念。经过多次挠头和修补后，我设法安装了 TargetProcess。但是，当我尝试在浏览器中运行它时，出现以下错误

> 由于 Web 服务器上的 ISAPI 和 CGI​​ 限制列表设置，无法提供您请求的页面。

我尝试运行的页面是 .aspx 并且我已经运行了 page.aspx 来验证 .aspx 没有按照错误消息的建议受到限制。

任何人对它可能是什么有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T18:01:53.057

凯文，

在 IIS 管理控制台中，请打开托管服务器的 ISAPI 和 CGI​​ 限制功能。ASP.NET v2.0 和 v4.0 限制分别设置。TargetProcess 应用程序从 2.22.9 版本开始使用 .NET v4.0，因此请检查是否安装了 MS .NET framework v4.0 并且允许使用 ASP.NET v4.0。TP 网站 PageHandlerFactory-ISAPI-4.0 的处理程序映射部分也应启用。

如果您需要任何帮助，请通过[http://messenger.providesupport.com/messenger/targetprocess.html](http://messenger.providesupport.com/messenger/targetprocess.html)与我们联系。

问候，亚历克斯 - TargetPro

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T15:06:46.297

要解决：

1.- 转到 IIS 管理器并单击您的服务器名称（当工具提示显示 localhosts 时）

2.- 双击 ASAPI 和 CGI​​ 限制

3.-右键单击将所有项目更改为允许

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-10T14:09:00.807

我的机器上没有“ISAPI 和 CGI​​ 限制”选项。我不得不回到“打开和关闭 Windows 功能”，然后是“Internet 信息服务”/“万维网服务”/“应用程序开发功能”，然后勾选“CGI”选项。完成此操作后，在我关闭并重新打开 IIS 后，会出现“ISAPI 和 CGI​​ 限制”选项。只是在这里提一下，以防其他人有同样的问题。

# jquery-ui - jquery-ui datepicker maxdate - 可以在 onSelect 中重置它吗？

> ID：10504226
> 
> 赞同：0
> 
> 时间：2012-05-08T18:22:27.080
> 
> 标签：jquery-ui, datepicker

可以在 onSelect 委托中重置 maxdate 属性吗？

如果我能做这样的事情就完美了：

```
 $(".date-picker").datepicker({

        maxDate: someDate,

        onSelect: function (date) {

            if(somecondition is true) {
               maxDate = someotherDate;
            }

            //some other functionality goes here, 
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:25:01.040

你应该能够做到这一点：

```
$('.date-picker').datepicker('option', 'maxDate', [value]); 
```

要重置原始值，您需要将该值存储在某处，并在适当的地方简单地使用该原始值重用上述代码。

# javascript - IE8上的javascript多线程WebWorkers

> ID：10504228
> 
> 赞同：0
> 
> 时间：2012-05-08T18:22:28.950
> 
> 标签：javascript, html

HTML5 WebWorkers 看起来很有前途，但目前 IE8 不支持它们。我正在建立一个商业 Saas，我必须至少再支持这个浏览器 2 年。

如果我开始实现一个 Web 工作线程并在 IE8 上运行它会发生什么？它会只在单个线程上运行还是根本不起作用？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T18:47:12.357

你会得到一个错误，因为用于创建 Web Workers 的 API 在 IE 中根本不存在。

例如

```
var worker = new Worker('my_task.js'); 
```

会抛出错误，因为 Worker 未定义。

如果要进行特征检测，可以在创建worker前先检查：

```
if(window.Worker !== undefined){
   var worker = new Worker('my_task.js'); 
} 
```

当然，您委派给 webworker 的任何任务都不会在不受支持的浏览器上发生，这意味着您需要在主（非 worker）上下文上运行逻辑。

由于您向 WebWorkers 发布消息（并侦听来自 WebWorkers 的事件/消息），如果您对工作任务执行相同的方法，您可以在主上下文中运行它，并以与它相同的方式调用它是一名网络工作者。这将需要您做一些额外的工作，但这样您可以在检测到浏览器支持时轻松切换到 WebWorkers。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-09T10:08:21.923

有一个项目为 IE < 10 提供 Web Worker 的虚拟实现：[http](http://code.google.com/p/ie-web-worker/) ://code.google.com/p/ie-web-worker/ API 相同，但执行是单线程的。

它工作正常，但我发现了一个关于这个库的问题。worker 的代码一旦被执行

```
var worker = new Worker('myworker.js'); 
```

叫做。此刻没有

```
worker.onmessage = function {...} 
```

已设置并且消息无法从工作人员发送到主代码。因此，可能有必要在从主代码向工作人员发送消息之前启动您的工作人员代码，例如

```
worker.postMessage('start'); 
```

# c++ - 调用模板化成员函数与模板化全局函数在泛型工厂中创建对象

> ID：10504233
> 
> 赞同：1
> 
> 时间：2012-05-08T18:22:51.963
> 
> 标签：c++, function, templates, pointers

在网上搜索了工厂模式的不同方法后，我实现了自己的版本，我对此非常满意。*Register*成员函数为模板类型创建一个函数指针，使用索引作为键将其存储在*std::map中。*下面的代码可以轻松编译和运行（Windows 7 64 位，带 GCC 的 Code::Blocks 10.05）。

```
#ifndef OBJECT_FACTORY_HPP
#define OBJECT_FACTORY_HPP

#include <map>

namespace internal {
    template<typename BaseType, typename ObjectType>
    BaseType* CreateFunction() {
        return new ObjectType;
    }
}

template<typename BaseType, typename IndexType>
class ObjectFactory {
    public:
        ObjectFactory();

        template<typename ObjectType>
        bool Register(const IndexType& index);

        bool Unregister(const IndexType& index);

        BaseType* Create(const IndexType& index);

    private:
        typedef BaseType* (*creationCallback)();
        typedef std::map<IndexType, creationCallback> Registry;
        Registry registry;

//    private:
//        template<typename ObjectType>
//        BaseType* CreateFunction();
};

template<typename BaseType, typename IndexType>
ObjectFactory<BaseType, IndexType>::ObjectFactory() {
    registry.clear();
}

template<typename BaseType, typename IndexType>
template<typename ObjectType>
bool ObjectFactory<BaseType, IndexType>::Register(const IndexType& index) {
    if (registry.find(index) != registry.end())
        return false;

    registry[index] = &internal::CreateFunction<BaseType, ObjectType>;
    // registry[index] = &CreateFunction<ObjectType>; <-- FAILS!
    return true;
}

template<typename BaseType, typename IndexType>
bool ObjectFactory<BaseType, IndexType>::Unregister(const IndexType& type) {
    if (registry.find(type) == registry.end())
        return false;

    return (registry.erase(type) == 1);
}

template<typename BaseType, typename IndexType>
BaseType* ObjectFactory<BaseType, IndexType>::Create(const IndexType& index) {
    if (registry.find(index) == registry.end())
        return NULL;

    return registry[index]();
}

//template<typename BaseType, typename IndexType>
//template<typename ObjectType>
//BaseType* ObjectFactory<BaseType, IndexType>::CreateFunction() {
//    return new ObjectType();
//}

#endif 
```

我最初的方法是让*CreateFunction*作为私有成员以对用户隐藏它（查看注释部分，注意非成员函数需要一个额外的模板参数）。*但是，这会失败并显示以下错误消息，所有错误消息都指向我在Register*成员函数中存储函数指针的行：

```
In member function 'bool ObjectFactory<BaseType, IndexType>::Register(const IndexType&) [with ObjectType = Triangle, BaseType = Shape, IndexType = std::basic_string<char, std::char_traits<char>, std::allocator<char> >]':|
instantiated from here
error: no matches converting function 'CreateFunction' to type 'class Shape* (*)()'|
error: candidates are: template<class ObjectType> BaseType* ObjectFactory::CreateFunction() [with ObjectType = ObjectType, BaseType = Shape, IndexType = std::basic_string<char, std::char_traits<char>, std::allocator<char> >]| 
```

我写了一个小测试客户端进行测试：

```
#include "ObjectFactory.hpp"
#include <iostream>

class Shape {
    public:
        Shape() {}
        virtual void print() { std::cout << "At heart, I'm a shape"; }
};

class Triangle : public Shape {
    public:
        Triangle() {}
        void print() { Shape::print(); std::cout << ", but I'm truly a triangle" << std::endl; }
};

int main(int argc, char* argv[]) {
    ObjectFactory<Shape, std::string> objectFactory;

    objectFactory.Register<Triangle>("triangle");

    Shape* triangle = objectFactory.Create("triangle");
    triangle->print();

    delete triangle;

    return 0;
} 
```

这甚至可能吗？我觉得应该是，而且我知道我以某种方式调用了不正确的成员函数，但我不明白为什么。在相关说明中，由于有人可能会提到它，我计划使用 *boost::shared_ptr* 进行分配，而不是普通的 new 运算符；）也欢迎任何其他关于实施的建议或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:41:54.750

在我们的文件中，我们*匿名化*我们的命名空间：

```
// namespace internal {  
   namespace          {
    template<typename BaseType, typename ObjectType> 
    BaseType* CreateFunction() { ... }  
} 
```

现在可以按最初编写的方式调用非静态函数，而无需命名空间限定：

```
// registry[index] = &internal::CreateFunction<ObjectType>;  
   registry[index] =           &CreateFunction<ObjectType>; 
```

文件范围的`CreateFunction`函数对翻译单元之外的代码是不可见的，并且仅由 class 调用`ObjectFactory`。

这很好地近似了问题中提出的（来自）的`private`访问说明符。`CreateFunction``ObjectFactory`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:02:14.970

创建函数应该是静态成员：

```
template<typename ObjectType> static BaseType* CreateFunction(); 
```

（上面的代码，没有`static`，在你的例子中被注释掉了）。

现在您的其他注释掉的代码是有效的：

```
registry[index] = &CreateFunction<ObjectType>; 
```

* * *

编辑：清除一些混乱：

这里的问题主要在于语法。模板`private`在这里并不重要，所以让我们简化一下情况：

```
struct ObjectFactory {
    void CreateFunction() {std::cout << "message";}
    void AnotherFunction()
    {
        ... = &CreateFunction; // what's that?
    }
}; 
```

if`CreateFunction`是非静态成员函数，语法`&CreateFunction`不正确；我想 gcc 就是在抱怨这一点。然而，更糟糕的是，MS Visual Studio 试图通过在内部“更正”语法`&ObjectFactory::CreateFunction`并尝试使用它来“帮助”您；但它会因无法理解的错误消息而失败（您拥有模板的事实会使它们更加严重）。

我不确定 Visual Studio 部分（我记得几年前 MSVC 6 遇到过这样的问题；较新版本的 Visual Studio 没有这个问题）。

# java - 设置与受保护方法相关的 Mockery 期望

> ID：10504234
> 
> 赞同：0
> 
> 时间：2012-05-08T18:22:55.737
> 
> 标签：java, methods, protected, jmock, infinitest

我在尝试设置 Mockery 来测试方法调用时遇到了问题。我看到了[如何使用 JUnit 和 JMock 测试抽象类的受保护方法，](https://stackoverflow.com/questions/8375541/how-to-test-protected-methods-of-abstract-class-using-junit-and-jmock)这基本上是同一个问题，但我无法弄清楚克里斯在他的回答中指的是什么。如果可以，请有人以稍微不同的方式或更完整的英语向我解释。我正在使用 JUnit、JMock2、Infinitest（如果重要的话）和一个标准的基于事件的消息系统，如下所示：

```
public Interface MyEventListener {
    void handleMyEvent(MyEvent e);
}

public Class MyEvent extends EventObject {
    public MyEvent(Object source) {
        super(source);
    }
}

public Class MySource {
    protected List<MyEventListener> listeners = new ArrayList<MyEventListeners>();

    public void addListener(MyEventListener listener) {
        listeners.add(listener);
    }

    public void removeListener(MyEventListener listener) {
        listeners.remove(listener);
    }

    // other code...

    protected void raiseEvent() {
        for (MyEventListener listener : listeners) {
            listener.handleMyEvent(new MyEvent(this));
        }
    }
} 
```

现在这是我的测试：

```
@Test
public void sourceShouldThrowEventOnEventOccurrence() {
    // set up
    Mockery context = new Mockery();
    MyEventListener listener = context.mock(MyEventListener.class);
    MySource source = new MySource();
    MyEvent event = new MyEvent(source);
    source.addListener(listener);

    // set expectations
    context.checking(new Expectations() {{
        oneOf(listener).handleMyEvent(event);
    }});

    // execute
    // do stuff to (theoretically) raise event

    // verify
    context.assertIsSatisfied();
} 
```

我在 MySource 中的 raiseEvent() 受保护方法上收到了 ExpectationError（意外调用）。我怎样才能增加它应该调用受保护方法的期望？

另外，我刚刚想到了一个想法——但在我去探索它之前，我仍然会发布这条消息（以防其他人有同样的问题，而我的想法最终是否正确）。该错误可能与我的代码中有两个新关键字有关吗？我在 MySource.raiseEvent() 中有新的 MyEvent(this)，然后在测试中有新的 MyEvent(source)。这会在内存中创建两个不同的事件......错误是否与它期望方法获取一个事件但接收另一个事件的可能性有关？

*****编辑

实际上，具体来说，我在实际引发事件的代码行上得到了一个 ExpectationError（意外调用）。（在我上面的代码中，该`listener.handleMyEvent(new MyEvent(this));`行）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T16:06:53.270

事实证明，我怀疑这与创建两个不同的 MyEvent 实例有关是正确的。不幸的是，这意味着我的问题的标题具有误导性。挖掘后，我发现一旦我将 Expectations() 更改为以下代码，我的代码就可以正常工作。

```
@Test
public void sourceShouldThrowEventOnEventOccurrence() {
    // set up
    Mockery context = new Mockery();
    MyEventListener listener = context.mock(MyEventListener.class);
    MySource source = new MySource();
    // MyEvent event = new MyEvent(source);  <-- NO LONGER NEEDED
    source.addListener(listener);

    // set expectations
    context.checking(new Expectations() {{
        oneOf(listener).handleMyEvent(with(any(MyEvent.class)));  // <-- with any
    }});

    // execute
    // do stuff to (theoretically) raise event

    // verify
    context.assertIsSatisfied();
} 
```

# d3.js - 控制线段

> ID：10504237
> 
> 赞同：5
> 
> 时间：2012-05-08T18:23:27.523
> 
> 标签：d3.js

一个简单的问题......我一直在成功使用 d3.svg.line 生成器，但我现在需要能够对整个生产线中的每个单独段进行更多控制。例如，每个段可能需要用不同的颜色着色。或者每个段甚至可能需要不同的厚度（逐渐变细或逐渐变细，具体取决于相邻段的厚度）。

我想知道实现这一目标的最佳工具是什么。我在想或者也许。或者甚至可能只是继续使用 d3.svg.line ，但让每个段都成为自己的行。

用这种丰富的线条渲染找别人的经验……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:21:45.790

目前 D3 中没有这方面的功能，但是有一个[开放的功能请求](https://github.com/mbostock/d3/issues/122)可以从 Protovis移植[分段线。](http://mbostock.github.com/protovis/docs/line.html)[Protovis 的实现](https://github.com/mbostock/protovis/blob/master/src/scene/SvgLine.js#L44-159)有点复杂，因为它需要计算相邻线段的斜接，但它绝对是可行的。SVG 2.0 可能包含获取描边路径轮廓的工具，这将消除在纯 JavaScript 中实现这一点的需要。

同时，您可以使用 SVG 的线元素或简单的二元素 d3.svg.line 来创建自己的线段。默认的 stroke-linecap 属性会在不同角度的相邻线条之间留下间隙；`stroke-linecap: round;`如果您希望它们重叠，您可以使用。

# google-chrome - 将 Chrome 扩展程序限制为某些 URL？

> ID：10504239
> 
> 赞同：26
> 
> 时间：2012-05-08T18:23:30.747
> 
> 标签：google-chrome, google-chrome-extension

有没有办法将 Chrome 扩展程序限制为仅在某些 url 上运行？

假设我希望扩展仅在域为 Amazon.com 时运行。我意识到您可以在脚本的顶部进行检查，然后仅在检查匹配时才执行脚本的其余部分。

但是，您可以完全阻止扩展程序运行吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-08T18:38:20.187

Welp，它认为我会在发布问题后立即找到答案，即使我已经被困了一段时间......

最初在答案中链接的文档版本存档： [http ://code.google.com/chrome/extensions/content_scripts.html](https://web.archive.org/web/20120503223135/http://code.google.com/chrome/extensions/content_scripts.html)

> Manifest V2 的模拟页面（尽管[另见 V3](https://developer.chrome.com/docs/extensions/mv3/intro/)）： [https ://developer.chrome.com/docs/extensions/mv2/content_scripts/](https://developer.chrome.com/docs/extensions/mv2/content_scripts/)

在 manifest.json 中：

```
 "content_scripts": [
    {
      "matches": ["http://*.nytimes.com/*"],
      "exclude_matches": ["*://*/*business*"],
      "js": ["contentScript.js"]
    }
  ], 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-11-15T08:47:07.353

作为用户，使用带有 chrome://flags/#extension-active-script-permission 的 Chrome 71（甚至可能更早）（您可能需要启用**扩展脚本**标志的用户同意）允许您右键单击扩展图标并选择“这可以读取和更改站点数据”然后您可以选择：

*   当你点击扩展
*   在 current-domain-name.com 上
*   在所有网站上（默认）

[![在此处输入图像描述](../Images/b9df8431a92669491aa68bf06e8e77c0.png)](https://i.stack.imgur.com/0wZYP.png)

这样，您可以将扩展限制为仅在某些域上非常快速地运行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-07-07T16:16:44.770

有一个 Chrome 扩展程序：[扩展自动化](https://chrome.google.com/webstore/detail/extension-automation/ghopjgdkodchjclkkfdekhjfomdbakkb)。我之前已经走过修改清单的路线，但这更容易。

# javascript - 在 IE9 localStorage 中存储某些 Unicode 字符会引发无效参数错误

> ID：10504240
> 
> 赞同：4
> 
> 时间：2012-05-08T18:23:42.260
> 
> 标签：javascript, internet-explorer, local-storage

我在应用程序中使用 localStorage。

我正在使用 XOR 位移运算在数据进入存储之前对其进行屏蔽。

这是屏蔽功能：

```
 encrypt: function (str) {
        var encoded = [];

        if (!App.crypto.key) {
            App.crypto.init();
        }

        for (var i = 0, len = str.length; i < len; i++) {
            var a = str.charCodeAt(i);
            var b = a ^ App.crypto.key.charCodeAt(App.crypto.key % i);
            encoded.push(String.fromCharCode(b));
        }

        return encoded.join("");
    } 
```

在这种情况下，我使用的密钥的值为“MWZ2cyt2N3JwejhxUjA2V3ptRmwxcmVvU09IbFhORHdOcDRiWGh5SGRZMFU4Ym9VY1Y1WXU5c2d6OXhBdU9wTSt1MlpqcmhXOVBRPQ0K”

当我在 IE9 中屏蔽“[]”时，我得到了一些奇怪的字符。当我尝试将其设置为 localStorage 时，它​​给了我一个无效的参数错误。有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:16:22.473

IE（和 Edge，鉴于尚未重写）将 localStorage 存储为 XML，并禁止任何与[XML 1.0 中的 Char 产生](http://www.w3.org/TR/xml/#NT-Char)不匹配的字符；即，您可以存储“任何 Unicode 字符，不包括代理块、FFFE 和 FFFF”。

根据规范，这是一个错误：对于可以存储在 localStorage 中的内容应该没有限制（任何 ECMAScript 字符串都应该是可能的），尽管这个错误自 IE8 以来就存在。（在 IE8 预览版中，可能会通过存储不允许的字符之一来破坏 localStorage 后备存储，因为当它尝试解析 XML 文件时会出现解析错误！）

# php - 在 Prototype 中创建按钮并识别它们

> ID：10504241
> 
> 赞同：0
> 
> 时间：2012-05-08T18:23:43.647
> 
> 标签：php, javascript, prototypejs, scriptaculous

这篇文章是一个多部分的问题，但基本上我正在用我的产品加载一组对象。我想要做的是创建一个这样的按钮列表：

```
<?php foreach($records as $product): ?>

    <div><?php echo $product->name; ?></div>

<?php endforeach;  ?> 
```

在每个按钮上单击我希望信息更改为相应的产品。我的问题是，用 Javascript 访问这个 php 数组的最佳方法是什么？我应该把它转换成json吗？

其次，我在原型中使用什么来使所有这些 div 标签都有点击事件，我将如何识别产品？我应该检索单击的按钮的订单号并从 json 获取信息吗？那么，如果单击数组中的第三个按钮，我会得到 json 中的第三个条目吗？

我正在尝试学习原型，因为我喜欢 scriptaculuous 提供的 jquery 效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:54:39.067

我建议**不要**使用原型。我是 Prototype+Scriptaculous 的早期采用者，并用它做了很多工作。到 2009 年，很明显他们失去了开发社区的注意力，而 jQuery 赢了。我不情愿地转向了 jQuery。

我发现 jQuery 语法更简洁，文档更好，社区更大，可用资源更多，其中包括人们可以回答像你这样的问题。

虽然 Scriptaculous 很棒，但 jQuery 的效果插件也同样多。话虽如此，这是解决您的问题的方法...

是的，我会使用 JSON 来定义事物。

这将创建一个新按钮：

```
var inputId = "myInput";
var elementName = "Price";
var elementValue = "1.99";

$(element).insert(new Element("input", {type:'button', id:inputId, name:elementName, className:'FBButton', value:elementValue })) 
```

这连接了事件：

```
$(inputId).observe('click', function() {...your code ...}); 
```

这是我很久以前编写但从未使用过的基于 JSON/Prototype 的表单生成器的链接。你可以自由地窃取代码。

[http://preview.moveable.com/JM/jameslab/JSONForm/](http://preview.moveable.com/JM/jameslab/JSONForm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:57:15.500

无论您使用哪种 javascript 工具包，要访问 HTML 元素，请使用该`id=`属性来唯一标识它们，`class=`并将它们放入一个公共组中。然后使用您选择的工具包的相应功能来检索它们。

```
<div id="product1" class="product">Product 1</div>
<div id="product2" class="product">Product 2</div>
<div id="product3" class="product">Product 3</div> 
```

例如，对于 jQuery，您可以使用 id 获取元素`product1`：

```
var el = $("#product1"); 
```

等等。在原型中，这很简单

```
var el = $("product1"); 
```

要获得所有产品，您可以按类别获得它们。在 jQuery 中：

```
var all = $(".product"); 
```

和原型：

```
var all = $$(".product"); 
```

有关所有详细信息，请参阅[文档](http://api.prototypejs.org/)。特别是检查[$](http://api.prototypejs.org/dom/dollar/)和[$$](http://api.prototypejs.org/dom/dollar-dollar/)。

# javascript - 当在 css 中识别父类时，BigText 插件不起作用

> ID：10504243
> 
> 赞同：4
> 
> 时间：2012-05-08T18:23:50.137
> 
> 标签：javascript, jquery, css

我一直在使用以下 jquery 插件根据容器 div 的宽度设置字体大小：[http](http://www.zachleat.com/web/bigtext-makes-text-big/) ://www.zachleat.com/web/bigtext-makes-text-big/我已经能够得到它当我将css中的字体定义为时使用不同的字体

```
.bigtext{
    font-family:Arial
} 
```

见[http://jsfiddle.net/pF5bQ/3/](http://jsfiddle.net/pF5bQ/3/)

但是，如果我用父类定义 css

```
.theme .bigtext{
    font-family:Arial
} 
```

它设置的字体太大。

见[http://jsfiddle.net/pF5bQ/4/](http://jsfiddle.net/pF5bQ/4/)

我正在开发的应用程序具有使用不同字体的各种主题，因此我需要能够根据父类为 bigtext 定义不同的样式。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T17:28:37.017

不是一个“真正的”解决方案，但我最终发现的解决方法是，如果我将我的主题类应用于与大文本相同的 div，我会得到想要的结果。

```
.theme.bigtext{
    font-family:Arial
} 
```

感觉真的很hack-y，因为在我正在处理的项目中，我需要进行类切换以及javascript中不需要的操作，但它可以完成工作。

[http://jsfiddle.net/pF5bQ/7/](http://jsfiddle.net/pF5bQ/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:39:46.407

好吧，你可以试试我做过的这个黑客，哈哈

[http://jsfiddle.net/pF5bQ/4/](http://jsfiddle.net/pF5bQ/4/)

```
.bigtext{
    font-family:arial
}

.theme .bigtext{
    font-family:arial;
    color:red;
} 
```

编辑：因此，如果您将 .theme 行放在主题 css 中或以任何方式实现它，我认为只要您拥有原始行，它就可以工作，哈哈这就是我所能提供的，我以前从未使用过 bigtext

# java - 为什么 EnumMap .keySet() 返回一个集合 () 而不是 EnumSet ()?

> ID：10504246
> 
> 赞同：13
> 
> 时间：2012-05-08T18:23:56.690
> 
> 标签：java

我正在编写一个包含大量枚举的程序，并且我不得不返回很多 EnumMap 的键集。但是`EnumMap.keySet()`返回 a `Set()`，所以为了得到`EnumSet`我想要的，我必须使用演员表：

```
EnumMap<SomeEnum, Object> myMap = getMap();
EnumSet<SomeEnum> myEnum = (EnumSet<SomeEnum>) myMap.keySet(); 
```

如果我不强制转换，编译器会抱怨类型不匹配；它不能从 转换`Set<SomeEnum>`为`EnumSet<SomeEnum>`。似乎没有必要强制转换，因为 EnumMap 的键将始终是枚举。有谁知道为什么这个`keySet()`方法是这样构造的？我有时认为它可能与 EnumSet 作为一个抽象类有关，但肯定`EnumMap`可以返回工厂方法`EnumSet`提供的任何内容。

干杯，所有！

编辑：我很抱歉，上面的代码抛出一个`CastClassException`. 您可以使用 EnumSet

```
EnumSet<SomeEnum> myEnum = EnumSet.copyOf(myMap.keySet()); 
```

我真的应该在发帖前检查一下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T18:29:36.453

我认为它是因为`keySet`不是`EnumSet`. ;)

它不是的原因是它是`keySet`底层地图的视图。

```
myMap.keySet().removeAll(keysToRemove); // removes multiple keys. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T18:43:49.237

`EnumSet`是`Set`碰巧使用枚举来表示键空间的一种实现。该类`EnumSet`没有提供额外的非静态方法，因此没有理由只返回`EnumSet`一个普通的`Set`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T18:44:58.660

编辑：我错了，请忽略。

EnumMap 扩展了 AbstractMap，它声明了 keySet。AbstractMap 不能声明 keySet 返回 EnumSet，因为对于 AbstractMap 的其他子类不是这样。因此，它的返回类型是 Set。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T18:34:26.157

如果你去那个类的来源，那么你会更好地理解它为什么返回的场景`Set`。您可以在以下网址找到

[http://www.docjar.com/html/api/java/util/EnumMap.java.html](http://www.docjar.com/html/api/java/util/EnumMap.java.html)

希望这可以帮到你。

享受 ！

# asp.net - ASP.NET - VB.NET - 从 MS-Access 数据库中获取数据，其中用户名 =？

> ID：10504248
> 
> 赞同：0
> 
> 时间：2012-05-08T18:24:04.190
> 
> 标签：asp.net, sql, vb.net, ms-access, data-retrieval

我正在使用 Web Developer 2010、带有 VB.NET 编程语言和 MS-Access 数据库 (.mdb) 的 ASP.NET。

我想要做的是从一个名为 User 的表（即所有列）中获取所有数据，其中 Username = ***_* ___**，然后将字段中的值放入文本框中，以便对其进行编辑。这是为了创建一个“我的帐户”页面，以便查看该网站的用户可以更改他的地址、密码等。

我坚持从每个特定用户名的字段中获取数据。

到目前为止我所做的是这样，但不起作用：

```
Imports System.Data.OleDb
Imports System.Data.SqlClient
Imports System.Data

Partial Class Account
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load

        Dim tUsername As String = Session("Username")
        Dim tPassword As String = Session("Password")

        Dim conn = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Users\Brian\Documents\Visual Studio 2010\WebSites\PetLandia\App_Data\db.mdb")
        Dim cmd As OleDbCommand = New OleDbCommand("SELECT [Email], [CustomerName], [CustomerSurname], [Address], [Country], [TelNo], [Username], [Password] FROM [User] WHERE Username=?", conn)

        DataSet(dst = New DataSet)

        cmd.Parameters.AddWithValue("@Username", tUsername)

        conn.Open()

        Dim reader As OleDbDataReader = cmd.ExecuteReader

        If (reader.Read()) Then

            lblName.Text = reader.GetValue(4).ToString
            lblSurname.Text = reader.GetValue(5).ToString
            lblUsername.Text = reader.GetValue(9).ToString
            txtAddress.Text = reader.GetValue(6).ToString
            txtCountry.Text = reader.GetValue(7).ToString
            txtEmail.Text = reader.GetValue(2).ToString

            conn.Close()

        End If

    End Sub

End Class 
```

错误信息：

```
Parameter ?_1 has no default value. 
```

在

`Dim reader As OleDbDataReader = cmd.ExecuteReader`

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:41:07.597

你需要给参数`@Username`不喜欢`?`

```
 Dim cmd As OleDbCommand = New OleDbCommand("SELECT [Email], [CustomerName], [CustomerSurname], [Address], [Country], [TelNo], [Username], [Password] FROM [User] WHERE Username=@Username", conn) 
```

处理连接时使用`Using`语句如下

```
Dim queryString As String = "SELECT OrderID, CustomerID FROM Orders"
Using connection As New OleDbConnection(connectionString)
    Dim command As New OleDbCommand(queryString, connection)

    connection.Open()

    Dim reader As OleDbDataReader = command.ExecuteReader()
    While reader.Read()
        Console.WriteLine(reader.GetInt32(0).ToString() + ", " _
           + reader.GetString(1))
    End While

    ' always call Close when done reading.
    reader.Close()
End Using 
```

并且还要确保`reader.GetValue(Index)`索引始终低于选择列数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:29:07.980

您的索引号与您的查询语句不一致。

尝试

```
 lblName.Text = reader.GetValue(2).ToString 
        lblSurname.Text = reader.GetValue(3).ToString 
        lblUsername.Text = reader.GetValue(7).ToString 
        txtAddress.Text = reader.GetValue(4).ToString 
        txtCountry.Text = reader.GetValue(5).ToString 
        txtEmail.Text = reader.GetValue(0).ToString 
```

# java - 使用 SwingWorker 更新 Java Gui

> ID：10504257
> 
> 赞同：0
> 
> 时间：2012-05-08T18:24:34.743
> 
> 标签：java, user-interface, jtextarea, swingworker, jprogressbar

下面是一个 SwingWorker 实例，它没有像我预期的那样更新 Java GUI。

SwingWorker 在按钮的动作侦听器中实现。定义循环的`min`and`max`都是动作监听器本地的“final int”。

SwingWorker 应该在每次迭代时调用`NQueens`对象的 go() 方法，该方法递归地找到 n-queens 的所有解决方案。然后调用`NQueens`对象的，然后`toString()`发布字符串，以便 process() 方法将更新`jProgressBar`和`jTextArea`。但是，按下按钮时没有任何反应。这是我应该如何实施结合 GUI 组件更新的密集流程吗？

```
new SwingWorker <Void,String>()
{       
     private int totalPercent;
     @Override
     protected Void doInBackground()
     {
         int diff = max - min + 1;
         int percent = 100;
         if(diff != 0)
         {
              percent = 100/diff;
         }
         totalPercent = 0;
         NQueens queens = new NQueens(min);
         for(int j = min; j <= max; j++)
         {
              queens.go();
              totalPercent += percent;
              String newText = queens.toString();
              publish(newText);
              queens.nextSet();
         }

         isCalced = true;

         return null;
      }

      protected void process(String results)
      {
           jTextArea2.append(results);
           jProgressBar1.setValue(totalPercent);
           jProgressBar1.repaint();
      }                                 
  }.execute(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T06:46:44.547

原因可能是您没有实施正确的流程方法吗？我相信正确的过程签名是

```
process(List<String> results) {
  for(String result : results) {
    jTextArea2.append(result);
  }
} 
```

关于更新进度条；doInBackground 方法在单独的线程中运行，而 process 方法在您调用 worker 的线程上运行。您不应该从 doInBackground 写入 totalPercent 变量并从 process() 读取它。有关更多信息，请参阅[线程可见性](http://jeremymanson.blogspot.dk/2007/08/atomicity-visibility-and-ordering.html)。相反，创建一个名为 ProgressUpdateEvent 的类，它可以保存百分比值和消息。这样，您可以执行以下操作：

```
new SwingWorker <Void,ProgressUpdateEvent>() {

  protected Void doInBackground() {
    for (int i = 0; i <= 100; i++) {
      publish(new ProgressUpdateEvent("At " + i + "% right now", i);
    }
  }

  protected void process(List<ProgressUpdateEvent> events) {
    for (ProgressUpdateEvent event : events) {
      jTextArea2.append(event.getMessage());
      jProgressBar1.setValue(event.getPercent());
    }
  }
} 
```

# objective-c - ld: 找不到 -lidn 的库

> ID：10504260
> 
> 赞同：0
> 
> 时间：2012-05-08T18:24:55.383
> 
> 标签：objective-c, xcode

刚刚发生了一件非常可怕的事情，我整个下午都在归档我的应用程序，没有任何问题，进行临时分发，当我最终将配置文件更改为分发时，它在上传时给了我一些错误，我将分发配置文件更改为新的，并且没有进行任何更改，当我再次存档时，它给出了这个错误

> ld: 找不到 -lidn 的库

我还没有发现有人遇到同样的错误，不同的库，但不是这个，所有的答案都指向没有添加到项目中的库，但我没有添加任何新的库......我发誓，我本可以删除在更改配置文件时意外地从项目或目标设置中获取某些东西，但没有别的，我该如何解决这个问题？任何想法？如何撤消项目和目标设置中的更改？

我很绝望！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:12:06.657

我很幸运没有提交最后的更改，所以我放弃了这些更改并感谢上帝它像以前一样工作。上帝保佑GIT！

# c++ - pthread_cond_t 是一个对象还是什么？

> ID：10504263
> 
> 赞同：0
> 
> 时间：2012-05-08T18:25:03.433
> 
> 标签：c++, pthreads, conditional-statements

我正在使用如下地图：

键 ---> 任务 ID

值 --->`pthread_cond_t`对象

当某项任务完成后，我会使用匹配元素唤醒所有`pthreads`与它相关的`pthread_cond_t`内容。

我的问题很简单——什么是`pthread_cond_t`？它是一个对象吗？因为如果我删除它，地图会调用它的构造函数，这对我不利。如果不是 - 我可以回来吗

```
pthread_cond_t cond = *(_flushCond->operator [](task_id)); //map of conditions
_flushCond->operator [](task_id) = NULL;
return cond; 
```

我想要做的是释放地图中的对象以供以后使用（我重用 ID）并返回`pthread_cond_t`那里的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:37:43.563

正如其他人评论的那样，它是实现定义类型的不透明类型（或句柄，如果你愿意的话）。在某些实现中，它可能是指向实际条件变量结构的指针，是结构本身，只是指向某些实现内部数据结构的指针。POSIX 标准对此不做任何保证或承诺，并且只允许您使用该类型的“对象”执行一组特定的操作。在这方面，它与其他类型的 Pthread 非常相似，例如 pthread_mutex_t 或 pthread_t。

您不能安全地或至少可移植地使用 pthread_cond_t 作为 STL 映射中的值。原因是，对值的要求是可复制构造和可赋值。虽然在技术上这对 pthread_cond_t 是可行的，但[这样做是不合法的](http://books.google.de/books?id=_xvnuFzo7q0C&pg=PA74&lpg=PA74&dq=pthread_cond_t+copying&source=bl&ots=Kn0U_SZ9Zc&sig=vTT58VZQwHxMfssp8F_tMZhWn30&hl=en&sa=X&ei=a3GpT4bfDYSN4gSCm6nBCg&ved=0CFgQ6AEwBA)。

您应该存储一个 pthread_cond_t* （指针），就像您对其他不可复制的类型所做的那样。

# c - 使用纯 C 轻松解析 DSL

> ID：10504271
> 
> 赞同：4
> 
> 时间：2012-05-08T18:25:37.453
> 
> 标签：c, parsing, programming-languages

我正在开发一个简单的 C 应用程序，并且我想创建一个 DSL 来定义应用程序的一些行为。这个想法是创建一种非常干净的语言，类似于 Ruby，但它实际上是在 C 中运行的。所有的函数都在 C 中定义，DSL 只是......好吧，一个“隐藏”C 的冗长语法的别名.

我知道 lex 和 yacc，但我认为它们对于我正在尝试做的事情来说太过分了。没有更简单的吗？我考虑过正则表达式，但这样做我会觉得很脏。也许有更好的东西！

一个例子：

```
if a = b
    myFunctionInC()

get 'mydata' then
    puts 'Hello!' 
```

很容易翻译成：

```
if (a == b) {
    myFunctionInC();
}

void get(string test)
{
    printf('Hello! %s', test);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:09:38.783

> 创建一个 DSL 来定义应用程序的一些行为。这个想法是创建一种非常干净的语言，类似于 Ruby，但它实际上是在 C 中运行的。

C 不是嵌入式语言的好宿主。它是语言运行时的一种很好的实现语言，因此如果您想编写应用程序脚本，请考虑做其他人所做的事情，并将高级语言链接到您的应用程序。

Lua 等语言就是为此目的而设计的——比 C 更容易编写；但是在 C 中简单嵌入。您也可以从 Ruby 或 Python 或 Haskell 或其他任何方式调用 C。

重用现有语言是个好主意，因为其他人已经完成了艰苦的工作。您也可以重用库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:47:36.870

我认为，如果你想创建一种好的语言，你不能只依赖正则表达式，因为它们的表达能力很差。

编写正则表达式来匹配复杂的模式也很困难。

如果你只是想隐藏一些 C 语言的冗长，你可以使用 C MACRO

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T20:12:35.677

定义一个好的 DSL 语法很难；您必须了解您希望它解决哪些问题（以及您不想解决哪些问题，否则最终会出现包括厨房水槽在内的所有问题），并且您必须弄清楚如何将其翻译成目标语言（或即时解释它）。

在这两种情况下，您都需要一个解析器，而有趣的 DSL 语法通常不适用于使用正则表达式进行解析。所以你需要一个真正的解析器生成器。如果你要处理像 Ruby 这样的东西，你需要一个*强大*的解析器生成器！

然后你需要捕获解析的结果，作为一些数据结构，通常是一棵树。然后，您需要分析您的 DSL 代码以了解特殊情况、优化以及如何生成代码。这一切意味着解析器通常是不够的。[请参阅我对解析后](http://www.semanticdesigns.com/Products/DMS/LifeAfterParsing.html)的生活的扩展讨论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T01:13:34.430

> 我正在开发一个简单的 C 应用程序，我想创建一个 DSL 来定义应用程序的一些行为。这个想法是创建一种非常干净的语言……实际上是在 C 中运行的。

你不是第一个有这个想法的人。John Ousterhout 使这个想法在[Tcl/Tk](http://tcl.tk)中流行起来。不幸的是，这种语言不是很干净。

今天最清楚地实现这一想法的是嵌入式语言[Lua](http://www.lua.org)。它的设计非常好，我非常推荐它。构建自己的（而不是使用 Lua）的唯一原因是因为您想学习如何实现嵌入式编程语言。在那种情况下，你*仍然* 可以通过学习 Lua 的设计来学​​到很多东西。

> 我知道 lex 和 yacc，但我认为它们对于我正在尝试做的事情来说太过分了。没有更简单的吗？

手工编写词法分析器几乎总是比使用 lex 更简单。

Yacc 是另一回事——实际上并没有什么从根本上更简单的东西，因为您确实必须处理上下文无关语言的全部功能。但是您可以在其他软件包中找到这种复杂的技术（Lex 和 yacc 是 1970 年代的技术，专为 1970 年代的硬件限制而设计，它们呈现出糟糕的人机界面。）

*   如果您知道如何设计 LL(1) 语法，那么手写递归下降解析器编写起来非常简单，并且不需要额外的技术。但是知识并不是那么容易获得的，用 C 编写这些东西也不是很有趣。

    如果你想学习，Niklaus Wirth 的书中有很好的例子。也可能有 LL(1) 和在线递归下降的教程。

*   您可能会发现使用更现代的解析器生成器更简单，不仅限于 LALR(1) 语法。例如，也许是[Elkhound](http://scottmcpeak.com/elkhound/)解析器生成器。但这也不简单。

# sql - Perl 使用数字变量打印输出文件名

> ID：10504273
> 
> 赞同：0
> 
> 时间：2012-05-08T18:25:44.057
> 
> 标签：sql, perl, variables, fetch, filehandler

我正在尝试从 sql server 中提取 1 周的数据，然后尝试将数据写入具有不同名称的文件中。以下代码不起作用，我找不到使用变量创建文件处理程序的方法。

还有一个问题，如果sql数据量很大（每天1-2G，整张表超过1年），那么这个月取比每天取快吗？

```
 my $sqlGetEid = "select trunc(datetime, 'DD') truncdate, x, y from z
        where DATETIME between TO_DATE('$dt1','YYYY-MM-DD') and TO_DATE('$dt1','YYYY-MM-DD')+7";

    for ($day=1; $day<=7; $day++){
        open('dayfile_$day', "> ./temp/Wireless_$day.csv");  
    }

    while ( my ($tday,$x,$y) = $curSqlEid->fetchrow_array() ) 
    {
        printf {'dayfile_$tday'} ("%s,%d\n", $x,$y);
    }

    for ($day=1; $day<=7; $day++){
        close('dayfile_$day');  
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:38:35.057

您不能像尝试那样使用纯字符串作为变量。

我能想到的最简单的方法是使用哈希来映射文件名和文件句柄。

这是一个如何做到这一点的示例：

```
use strict;
use warnings;

my %files;

foreach my $i (1..7) {
    my $fh;
    open($fh, '>', "day_$i.log") || die "Ooups: $i: $!";
    $files{$i} = $fh;
}

foreach my $i (1..7) {
    my $fh = $files{$i};
    print $fh "hello $i\n";
}

foreach my $i (1..7) {
    my $fh = $files{$i};
    close $fh;
} 
```

# codeigniter - 在 uri 中使用 GET 数据进行分页 - Codeigniter

> ID：10504274
> 
> 赞同：2
> 
> 时间：2012-05-08T18:25:44.550
> 
> 标签：codeigniter, pagination

我试图对 DB 返回的结果进行分页。但是当我尝试从 URI 获取偏移量时：

`questions/search?content=foobar/4`

`/4`应该是偏移量，但它已分配给该`$_GET`值。

这是控制器中的整个方法：

[http://pastebin.com/QFJddMDJ](http://pastebin.com/QFJddMDJ)

```
$results = $this->question->search_results_count($content);
$this->load->library('pagination');
$config['total_rows'] = count($results);
$offset = $this->uri->segment(3);
if ($offset == false) $offset = 0;
$config['full_tag_open'] = '<ul class="pages">';
$config['full_tag_close'] = '</ul>';
$config['num_tag_open'] = '<li>';
$config['num_tag_close'] = '</li>';
$config['cur_tag_open'] = '<li><a  class="active">';
$config['cur_tag_close'] = '</a></li>';
$config['prev_tag_open'] = '<li class="prev">';
$config['prev_tag_close'] = '<li>';
$config['next_tag_open'] = '<li class="next">';
$config['next_tag_close'] = '</li>';
$config['num_tag_open'] = '<li>';
$config['num_tag_close'] = '</li>';
$config['first_link'] = '<<';
$config['first_tag_open'] = '<li>';
$config['first_tag_close'] = '</li>';
$config['last_link'] = '>>';
$config['last_tag_open'] = '<li>';
$config['last_tag_close'] = '</li>';
$config['per_page'] = 1;
$config['uri_segment'] = 2;
$config['page_query_string'] = TRUE;
$config['use_page_numbers'] = TRUE;
$config['suffix'] = '?content='.$content;
$config['base_url'] = base_url().'questions/search/';
$this->pagination->initialize($config); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T19:49:06.747

我相信你知道，URI 不是这样工作的。查询字符串必须位于末尾（或`#`哈希片段之前）。此查询字符串：

```
questions/search?content=foobar/4 
```

方法`$_GET['content'] = 'foobar/4';`

您需要将分页 URL 更改为以下内容：

```
questions/search/4/?content=foobar 
```

4`/`之后还有可选的。

您必须从分页中删除查询字符串`$config['base_url']`，而是将其附加到视图中的链接，这很遗憾涉及破解分页类...

或者试试这个未记录的功能：

```
// After loading the pagination class
$this->pagination->suffix = '{YOUR QUERY STRING}'; 
```

或者更好的是，只需`$config['suffix'] = '{YOUR QUERY STRING}';`在加载类之前添加到您的配置中。这应该会自动将查询字符串添加到每个链接的`href`.

还需要对您的配置区域进行一些调整：

```
// Make sure to encode these
// $config['first_link'] = '<<';
$config['first_link'] = '&lt;&lt;';
// $config['last_link'] = '>>';
$config['last_link'] = '&gt;&gt;';

$offset = $this->uri->segment(3);
// Default URI segment is 3, and it's what you use above. Remove this.
// $config['uri_segment'] = 2;

// This should be FALSE (default). Remove it.
// $config['page_query_string'] = TRUE;

// This should be FALSE (default) if you're
// using the URI segment as your OFFSET. Remove it.
// $config['use_page_numbers'] = TRUE;

// Add your query string
$config['suffix'] = '?content='.$content;
$config['base_url'] = base_url().'questions/search/';
$this->pagination->initialize($config); 
```

# php - ZEND 框架/表单如何使用 ->fetchall 从表中选择所有数据并调整日期时间顺序以查看？

> ID：10504275
> 
> 赞同：0
> 
> 时间：2012-05-08T18:25:50.593
> 
> 标签：php, zend-framework, zend-form, smarty

我刚开始使用 ZEND 框架表单。我想在我的第一个抽象项目中制作一个简单的留言簿。对于我的留言簿，我在“gastenboek”表中使用了 5 个列。还有一个日期时间字段。我想按以下顺序在视图中显示数据：

DATE_FORMAT(gastenboek.date,'%d-%m-%Y %H:%i') AS gastenboek_date

我怎么能在 Zend 框架中做到这一点，我必须在 fetchall 之前在控制器中调整一些东西吗？或者我可以在那之后做点什么，在我将数组分配给视图之前？

我的控制器：

```
 class GastenboekController extends Zend_Controller_Action
    {

        public function init()
        {
            /* Initialize action controller here */
        }

        public function indexAction()
        {
            $entries = new Application_Model_DbTable_Gastenboek();
            $test = $entries->fetchAll();

            $paginator = Zend_Paginator::factory($test);
            $paginator->setItemCountPerPage(3);
            $paginator->setCurrentPageNumber($this->_request->getParam('page'));

            $this->view->assign('entries' ,$paginator);
        }
} 
```

And Smarty Views gastenboek\index.tpl

```
<h2>Gastenboek</h2>

<table>
    {foreach from=$entries item=entry}
    <tr>
        <td><strong>Naam: {$entry.naam} {$entry.date} </strong></th>
    </tr>
    <tr>
        <td>{$entry.bericht}</td>
    </tr>
    {/foreach}
</table> 
```

问候埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:38:31.107

如果您的日期格式是特定于视图的，我会在视图本身中进行：

```
<td><strong>Naam: {$entry.naam} {date('d-m-Y H:i', strtotime($entry.date))} </strong></th> 
```

# c# - C# Stop 等待用户在文本框中输入 NOT CONSOLE APP

> ID：10504282
> 
> 赞同：0
> 
> 时间：2012-05-08T18:26:06.083
> 
> 标签：c#, multithreading, event-listener

我正在写试图写一个 SSH 客户端。我使用的是 Windows 窗体而不是控制台应用程序。我不想使用它，因为我想学习如何让这个工作......无论如何，这个问题。我有一个 while 循环，只要我的外壳打开，它就会运行。但是为了通过我的文本框将输入发送到 Ssh 服务器，我需要它等待输入。我添加了一个监听 ENTER KEY 的事件监听器。并获取然后输入我有一个返回数据的函数。该函数内部是一个while循环，只要变量为真，它就会运行。关于 enter 列表的全部内容是，我将更改保持函数内部 while 运行的变量，以便它退出该变量并在文本框中返回数据。

所以我需要一种方法来覆盖函数内部的while循环并将变量设置为false。我听说过覆盖以及线程方面的事情，但我不确定该怎么做。

这是我的代码！

```
//Variables
public string mHost;
SshShell mShell;
public string mInput;
string pattern = "";
bool mInputHolder = true;

//Initiate form!
public Form1()
{
    InitializeComponent();

    txthost.Text = "sdf.org";
    txtuser.Text = "kalle82";
    txtpass.Text = "XXXX";
    string pattern = "sdf:";
    this.txtInput.KeyPress += new System.Windows.Forms.KeyPressEventHandler(checkforenter);
}

public void button1_Click(object sender, EventArgs e)
{
    try
    {
        mShell = new SshShell(Host, User);
        mShell.Password = Pass;
        //WRITING USER MESSAGE
        txtOutput.AppendText("Connecting...");
        mShell.Connect();
        txtOutput.AppendText("OK");
        //txtOutput.AppendText("Enter a pattern to expect in response [e.g. '#', '$', C:\\\\.*>, etc...]: ");
        //Stop for user input

        mShell.ExpectPattern = pattern;
        mShell.RemoveTerminalEmulationCharacters = true;

        while (mShell.ShellOpened)
        {
            txtOutput.AppendText("\r\n" + "TERMINAL MODE ENGAGED");
            txtOutput.AppendText(mShell.Expect( pattern ));
            string data = userInput();
            if (data == "") break;
            //Data from termninal --> Append to text
            string output = mShell.Expect(Pattern);
            txtOutput.AppendText(output);
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }

}

public void checkforenter(object sender, System.Windows.Forms.KeyPressEventArgs e)
{
    if (e.KeyChar == (char)13)
    {
        mInputHolder = false;
    }
}

public string userInput()
{
    while (mInputHolder == true)
    {

    }
    mInputHolder = true;
    return txtInput.Text;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:33:01.797

您可能会发现创建一个扩展 TextReader 的类然后将 Console.SetIn 设置为该类很有用。在您制作的该类的构造函数中，将您要观看的文本框作为输入参数。从那里使用 TextReader 的重写功能来做你需要做的事情。没有 Whileloops，没有多线程，没有并发问题。不过，这只是我的 2 美分。这是显示如何重定向输出的类似文章。重定向输入的概念相同。

[http://saezndaree.wordpress.com/2009/03/29/how-to-redirect-the-consoles-output-to-a-textbox-in-c/](http://saezndaree.wordpress.com/2009/03/29/how-to-redirect-the-consoles-output-to-a-textbox-in-c/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:39:06.340

本质上你的问题是无法解决的。如果您在按钮单击中阻止代码以等待用户输入，您将冻结 UI，这将阻止任何人提供所述输入；这称为死锁。

您可以通过单击按钮打开外壳，然后在输入后稍后附加到外壳，或者您可以等到已经有输入发送到外壳后再打开它。

由于您要求提供一些代码，因此这是我的“shell 的你好世界”示例。我实际上是在用它来玩 WPF。有一个用于输入的文本框，一个用于显示输出的文本框，以及一个用于将输入文本框中的数据发送到 shell 的按钮。意识到这既不是生产质量示例，也不是专门针对您的问题编写的，但它应该展示解决问题的整体方法。

```
 /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private Process cmd;
        private bool scrollAtBottom = false;
        public MainWindow()
        {
            InitializeComponent();

            Closed+=new EventHandler(MainWindow_Closed);
            textBlock1.Text = "";

            textBox1.Focus();
        }

        private void button1_Click_1(object sender, RoutedEventArgs e)
        {
            if (cmd == null || cmd.HasExited)
            {
                cmd = new Process();
                cmd.StartInfo.CreateNoWindow = false;
                cmd.StartInfo.FileName = "cmd.exe";
                cmd.StartInfo.RedirectStandardInput = true;
                cmd.StartInfo.RedirectStandardOutput = true;
                cmd.StartInfo.UseShellExecute = false;

                cmd.OutputDataReceived += new DataReceivedEventHandler(cmd_OutputDataReceived);

                cmd.Start();
                cmd.BeginOutputReadLine();
            }

            cmd.StandardInput.WriteLine(textBox1.Text);

            textBox1.Text = "";
        }

        private void cmd_OutputDataReceived(object sender, DataReceivedEventArgs e)
        {
            textBlock1.Dispatcher.Invoke(new Action(() =>
            {
                textBlock1.Text += e.Data + Environment.NewLine;
                scrollViewer1.ScrollToEnd();
            }));
        }

        private void MainWindow_Closed(object sender, EventArgs e)
        {
            if (cmd != null && !cmd.HasExited)
            {
                //exit nicely
                cmd.StandardInput.WriteLine("exit");
                if (!cmd.HasExited)
                {
                    //exit not nicely
                    cmd.Kill();
                }
            }
        }
    } 
```

# visual-studio-2010 - Visual Studio 网站构建在 CI 服务器上间歇性失败

> ID：10504285
> 
> 赞同：11
> 
> 时间：2012-05-08T18:26:14.597
> 
> 标签：visual-studio-2010, msbuild, continuous-integration, hudson, build-automation

我们有一个相当复杂的 Visual Studio 解决方案（57 个项目，其中 19 个是网站，几乎每次通过推送代码触发时都无法构建，但随后我们手动触发构建并在重试时构建就好了。

该解决方案包含 57 个项目，其中 19 个是网站项目。（不是 Web 应用程序项目，没有 .csproj 文件。）其余的是类库和后台作业。19 个网站项目在 IIS 虚拟目录中构建成一个大型多功能内容管理系统。

构建服务器是 Hudson v1.395。用于构建的命令是：

```
"C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\devenv.com" "SolutionName.sln" /rebuild Debug 
```

当构建失败时，它总是在完全相同的网站项目上这样做，并带有完全相同的消息：

```
------ Rebuild All started: Project: C:\...\WebsiteName\, Configuration: Debug Any CPU ------
Validating Web Site
: Build (web): The application domain in which the thread was running has been unloaded.

Validation Complete 
```

对此邮件的[Google 搜索](https://www.google.com/search?q=Build%20%28web%29:%20The%20application%20domain%20in%20which%20the%20thread%20was%20running%20has%20been%20unloaded)目前没有多大帮助。[此链接](http://connect.microsoft.com/VisualStudio/feedback/details/110155/build-web-error-the-application-domain-in-which-the-thread-was-running-has-been-unloaded)最接近实际问题，但没有解决方案。显然，我们不会在构建期间更改任何解决方案文件，因为它发生在构建服务器上。

当它失败时，我们手动触发构建，并且我们得到了我们期望的结果（抱歉，已编辑）：

```
------ Rebuild All started: Project: C:\...\News2\, Configuration: Debug Any CPU ------
Validating Web Site
Building directory '/WebsiteName/Dir1/Dir2/'.
Building directory '/WebsiteName/'.
Building directory '/WebsiteName/Dir3/'.
// 22 more but you get the point

// A few warnings caused by our own use of the ObsoleteAttribute, nothing to be concerned about
Validation Complete 
```

什么可能导致此应用程序域卸载消息？

其他一些注意事项：

*   我们认为这可能是 Hudson 内存不足，因为我们确实观察到 java 大量泄漏它。因此，我们添加了一项任务，每天早上 6 点重启 Hudson 服务。即使有了这个以及在构建过程中准备好使用的大量可用内存，它仍然失败了。
*   推送到同一个存储库还会同时构建一个更简单（只有 22 个项目，没有网站项目）的解决方案。那个总是成功的。此外，手动触发它们同时运行成功。
*   我知道我们应该升级 Hudson，但这始终是我们似乎从来没有时间进行的次要项目之一。无论如何，我相当强烈地认为这是 Visual Studio / MSBuild 问题，而不是 Hudson 问题。

**编辑 1：MSBuild**

MSBuild 的问题在于有很多与 Visual Studio 中的构建不同的小怪癖。解决方案在开发人员机器上的 Visual Studio 中编译然后在构建服务器上失败是非常令人沮丧的。甚至 msbuild 的输出也与我们的开发人员在他们的构建输出窗口中看到的完全不同（一方面更冗长）。是否有其他命令行标志使 MSBuild 输出更符合您在 Visual Studio 构建窗口中获得的内容？

还有其他尴尬的事情。如果您碰巧有一个与项目同名的解决方案文件夹，MSBuild 会引发错误，但 Visual Studio 可以很好地处理它。这些是真正让你拔头发的怪癖。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-10T10:35:41.357

我在 Hudson/Jenkins 上构建 C++ 时遇到了问题，这可能是相关的，如果您同时进行两个构建，那么可能会发生不好的事情。

这是因为 Hudson/Jenkins 将在构建结束时运行进程树杀手来清理进程，而 MsBuild/VisualStudio 将在构建之间共享一些公共进程。

我在 C++ 构建中遇到的实际问题表现为另一个错误：

```
fatal error C1090: PDB API call failed, 
error code '23' : '( 
```

问题在这里提出：

[https://issues.jenkins-ci.org/browse/JENKINS-9104](https://issues.jenkins-ci.org/browse/JENKINS-9104)

关闭进程树杀手可能会解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T02:01:35.690

我对 Hudson 或网站项目（我使用 TeamCity 和 Web 应用程序项目）不太熟悉，但我想我会抛出一些东西来看看它是否有帮助。

您是否尝试过直接使用 MSBuild 而不是使用 Visual Studio 来构建解决方案？该命令看起来像这样：

```
 %windir%\Microsoft.NET\Framework\<version>\MSBuild SolutionName.sln /t:Rebuild /p:configuration=debug 
```

我注意到您没有在构建完成后将命令行开关传递给 Visual Studio 以关闭 /RunExit [MSDN Link](http://msdn.microsoft.com/en-us/library/xee0c8y7%28v=vs.100%29.aspx) 那么 Visual Studio IDE 是否会在您的构建服务器上为每个构建打开而不是关闭？我可以看到 IDE 的多个实例打开了相同的解决方案，导致出现问题。

我建议尽可能使用 MSBuild 而不是 Visual Studio 来执行构建，除非您依赖 IDE 中的某些内容。您至少应该获得更快的构建时间，因为您不必加载 Visual Studio，它消除了构建过程中的一层复杂性。

希望这有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T05:28:54.583

由于相同的签入而运行的另一个并发构建感觉它们是相关的。一个资源在我的构建过程中消失，而相关构建运行使我怀疑相关构建。

我知道你说过你可以手动同时运行它们，一切都很好。不过，对我来说，这闻起来像是一种比赛条件。尝试在较小的项目上禁用自动触发器并提交作为最终的健全性检查，以确保它不会把你弄乱。

我想如果你根本不怀疑，你就不会在你的帖子中提到它。排除这种情况。

# sql - 存储过程输出参数上的合并/IsNull

> ID：10504290
> 
> 赞同：2
> 
> 时间：2012-05-08T18:26:43.193
> 
> 标签：sql, sql-server, tsql

我有一个存储过程：

```
[checkCultureCode]
@InputCulture varchar(5) = 'en-US',
@ValidCulture varchar(5) OUTPUT
AS
BEGIN
SELECT @ValidCulture = CultureName FROM Culture 
    WHERE CultureName = @InputCulture 
SELECT @ValidCulture = COALESCE(@ValidCulture, 'en-US') 
    -- or ISNULL(@ValidCulture, 'en-US')
END 
```

我希望得到以下之一：

*   `@InputCulture`返回给我的值（如果它存在于`Culture`表中）
*   'en-US' 如果`@InputCulture`为空
*   'en-US' 如果`@InputCulture`不是 null 但也不是现有值，例如。'邪恶的'

但是`null`当我这样做时，我得到了：

```
DECLARE @v varchar(5)
    EXEC checkCultureCode 'evil', @v
SELECT @v; 
```

这有效，我得到'en-US'作为答案：

```
DECLARE @v varchar(5)
    SELECT @v = CultureName FROM Culture WHERE CultureName = 'evil' 
    SELECT @v = COALESCE(@v, 'en-US')
SELECT @v; 
```

我曾希望写下所有这些能帮助我看到不同之处，但我仍然做不到。我想使用存储过程和输出参数，以便我可以从另一个存储过程执行此检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:35:35.637

您需要在对 SP 的调用中将参数指定为 OUTPUT。

```
DECLARE @v varchar(5)
EXEC checkCultureCode 'evil', @v OUTPUT
SELECT @v; 
```

# events - Firefox XHR 没有触发上传进度事件

> ID：10504292
> 
> 赞同：0
> 
> 时间：2012-05-08T18:26:56.817
> 
> 标签：events, firefox, upload, xmlhttprequest, progress

非常简单的 HTML/JS：

*   采用 Base64 编码的 PNG
*   将其转换为 blob
*   设置一个 img.src 来验证它是一个有效的 PNG
*   设置事件处理程序后通过 XHR 上传

在 Firefox 12 中，我得到“ *loadstart* ”和“ *loadend* ”事件，但没有“ *progress* ”事件。

在 Chrome 20 中一切正常。

该文件名为“image.html”，因此它只是上传到自身进行测试。

我还尝试设置 content-legnth 标头，但这并没有改变 Firefox 中的结果，所以我将其注释掉。

**任何人都可以验证相同的结果吗？我错过了什么吗？**

谢谢

```
<!DOCTYPE html>
<html>
<head>
<title>Test</title>
<script>

var testPng64 = 'iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAXUlEQVR42rVTgQkAIAjz+P4uggKjTU0pEGLopkxFWu9SepMgS3LUMRImAHEN7r+OUNeowMKfW3bVEUloBCuJdWQDztz/CZClYYKIInTC89m0EW0ei9JBXbnZa1x1A1Sh2i/qfsVWAAAAAElFTkSuQmCC';

function receiveImage(pngBase64) {
    console.log("receiveImage");

    var img = document.getElementById("webImg1");

    var BlobBuilder = window.MozBlobBuilder || window.WebKitBlobBuilder || window.MSBlobBuilder || window.BlobBuilder;
    var bb = new BlobBuilder();

    var byteString = window.atob(pngBase64);
    var ab = new ArrayBuffer(byteString.length); 
    var ia = new Uint8Array(ab); 
    for (var i = 0; i < byteString.length; i++) { 
        ia[i] = byteString.charCodeAt(i); 
    }

    bb.append(ab);

    var blob = bb.getBlob("image/png");

    var URL = window.URL || window.webkitURL;
    var imgUrl = URL.createObjectURL(blob);
    img.src = imgUrl;

    upload(blob);
}

function upload(blob) {
    console.log("upload");

    var xhr = new XMLHttpRequest();

    xhr.addEventListener("load", function(e) {
        console.log("xhr load");
    });

    xhr.upload.addEventListener("loadstart", function(e) {
       console.log("xhr upload loadstart");
       console.log(e); 
    }, false);

    xhr.upload.addEventListener("progress", function(e) {
       console.log("xhr upload progress");
       console.log(e); 
    }, false);

    xhr.upload.addEventListener("loadend", function(e) {
       console.log("xhr upload loadend");
       console.log(e); 
    }, false);

    xhr.open("POST", "image.html", true);
    //xhr.setRequestHeader("Content-Length", blob.size);

    xhr.send(blob);
}
</script>
</head>
<body>
    <div>
        <img id="webImg1" src="about:blank" width="64" height="auto"/>
        <progress id="progress1" min="0" max="100" value="0" style="width: 64px;">0%</progress>
    </div>
    <div><button onclick="receiveImage(testPng64)">Load</button></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T01:45:15.753

Firefox 使用的网络库不会向消费者公开上传进度（例如 Firefox），因此 Firefox 目前无法触发上传进度事件。

**编辑：**看起来我错了；显然，我正在记住前一段时间存在的代码。所以然后我尝试了上面的测试用例......在 Firefox 12 中它的行为与描述的一样，但在当前的每晚它会触发一个上传进度事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T09:54:36.213

是的，我有同样的问题，当上传文件大小小于 100Kb 时，我重写了加载事件以更改进度条。你可以[在这里](http://blog.webnotes.cn/html5-can-not-trigger-progress-event-when-upload-small-size-file-with-firefox)看到它。

# machine-learning - 神经网络权重和成本变化，但不是它的准确性

> ID：10504298
> 
> 赞同：1
> 
> 时间：2012-05-08T18:27:26.460
> 
> 标签：machine-learning, neural-network

我正在训练一个神经网络，并从随机权重开始。训练后，权重发生了变化，但神经网络的准确性与起始权重相同。不管我如何改变网络的架构。隐藏层中的节点数、迭代次数和特征数（使用 PCA 进行降维）得出的精度与开始时相同。这可能是因为相对于特征数量的示例数量较少吗？（我有 675 个示例和 9000 个特征）。还是因为其他原因？我还用逻辑回归尝试了相同的数据集，它能够达到 64% 的准确率，但并不好，它比我在使用神经网络训练前后得到的 50% 好得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:41:53.540

一般来说，您的训练示例应该比您的特征多几个数量级，而不是相反。这会伤害到你，除非你的 PCA 让事情变得非常糟糕。

你确实记得标准化你的特征，对吧？这通常在 PCA 中得到解决，但有时您必须先进行标准化，具体取决于您使用的软件。

除此之外，你没有提到改变学习率、使用自适应学习率或使用动量项，所以我建议你研究一下。此外，除了普通的旧反向传播之外，还有更多的权重更新算法。[Levenberg-Marquardt 算法](http://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm)可能值得一试。你的实现可能已经有了这个，假设你不是自己写的。

某种形式的提前停止也可能有用。

您没有提到您是要进行分类还是回归。如果您正在进行分类，请确保输出节点上的激活函数与您使用的类标签类型相匹配。Logsig 的范围是 0 到 1，而 Tansig 是 -1 到 1。如果您在进行回归，请确保输出具有线性激活，或者至少可能输出的范围与您的训练示例匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-26T14:22:41.387

首先，分类精度，取决于数据集。所有人工智能方法都试图在向量空间中分离数据。但是，数据可能一开始就不可分离，在某些情况下，64% 可能非常接近可能的最佳结果。您使用的是哪种数据集（它是众所周知的基准之一，还是您要解决的某些特定问题？？）

其次，权重变化并不一定意味着网络正在接受训练。训练后，您不应该检查权重是否发生变化，而是检查总平方误差是否减少。如果它没有显着减少，则您的网络可能根本没有经过训练。在您的情况下，如果训练后准确率保持在 50%（我想您是在谈论一个二分类问题），那么该方法很可能根本不起作用。您应该首先在一个更简单的数据集上尝试它，以检查它是否有效。

而且：

*   如果你想训练一个多层感知器，9000 个特征太多了。您可能需要 SVM 来解决如此复杂的问题。
*   对于这样的问题，实例的数量很可能太少（但是，如果两个类之间的模式在问题空间中太远）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-26T09:41:36.057

如果您正在进行分类，问题可能出在您的标签上。

我在 Octave 中训练神经网络时遇到了类似的问题。准确度约为 50%。我有两个标签 0 和 1。我的准确度很低，因为 octave 从 1 而不是 0 开始索引。您可能需要查看标签。

# iphone - UIImageView 没有正确旋转？

> ID：10504300
> 
> 赞同：2
> 
> 时间：2012-05-08T18:27:40.633
> 
> 标签：iphone, objective-c, ios, uiimageview

我在 UIViewController 中有一个 UIScrollView。它启用了滚动和缩放。它包含一个 UIImageView ，当用户旋转设备时，这个想法是图像保持居中。问题是，当设备旋转时，它实际上出现在左边而不是中心，它应该停留在哪里。这是我正在使用的代码。当 UIScrollView 旋转时调用 Set frame：

```
-(void)setFrame:(CGRect)frame {

    float previousWidth = self.frame.size.width;
    float newWidth = frame.size.width;

    [super setFrame:frame];
    self.imageView.center = CGPointMake(self.bounds.size.width / 2, self.bounds.size.height / 2);

    [self setupScales];

    self.zoomScale = self.zoomScale * (newWidth / previousWidth);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:52:35.297

我在 uiscrollview 的子类中使用以下 layoutsubviews 方法：

```
- (void)layoutSubviews {
    [super layoutSubviews];

    if ([[self subviews] count] == 0) {
        return;
    }

    // center the image as it becomes smaller than the size of the screen
    CGSize boundsSize = self.bounds.size;
    CGRect frameToCenter = ((UIView*)[[self subviews] objectAtIndex:0]).frame;

    // center horizontally
    if (frameToCenter.size.width < boundsSize.width)
        frameToCenter.origin.x = (boundsSize.width - frameToCenter.size.width) / 2;
    else
        frameToCenter.origin.x = 0;

    // center vertically
    if (frameToCenter.size.height < boundsSize.height)
        frameToCenter.origin.y = ((boundsSize.height - frameToCenter.size.height) / 2);
    else
        frameToCenter.origin.y = 0;

    ((UIView*)[[self subviews] objectAtIndex:0]).frame = frameToCenter;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:30:15.217

您可能还需要设置`contentOffset`滚动视图的属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:45:52.763

如果滚动视图随着方向变化而调整大小，试试这个

```
self.imageView.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleTopMargin; 
```

# xml - 玩 1.2.4：处理 POST 请求，body 中带有 XML

> ID：10504301
> 
> 赞同：1
> 
> 时间：2012-05-08T18:27:46.357
> 
> 标签：xml, apache-flex, post, jaxb, playframework

我搜索了处理以 XML 为主体的 POST 请求的文档/示例，但似乎找不到 play 1.2.4 的最新示例（虽然有一个很好的注释可以用于 play 2.0 ）。

我有一个像这样发布 XML 的 Flex 应用程序：

```
public function post( url:String, xml:XML ):void
{
    var service:HTTPService = new HTTPService();
    var responder:Responder = new Responder( postResult, postFault );
    var token:AsyncToken;
    service.method = "POST";
    service.contentType = "application/xml";
    service.resultFormat = "e4x";
    service.url = url;
    token = service.send( xml );
    token.addResponder( responder );
} 
```

如何以 XML 形式访问正文，以便可以使用 JAXB 处理它？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T05:21:19.540

我知道有两种方法。

1.  您可以使用`request.body`，它返回一个 InputStream。对于习惯了 Play 简单性的人来说，可能有点啰嗦。

2.  只需调用`params.get("body")`. 这将返回整个身体。

显然，您最有可能使用选项 2，但对于某些用例，选项 1 可能是首选。

# .net - 如何在 VB.NET 中将字符串转换为八进制？

> ID：10504302
> 
> 赞同：0
> 
> 时间：2012-05-08T18:27:47.887
> 
> 标签：.net, vb.net, octal

是否可以将文本框中的文本字符串转换为八进制数字？如果是这样，我如何将八进制转换为文本和将文本转换为八进制？

哦，现在我明白它是如何工作的了。我认为十六进制和八进制是两个不同的东西，但实际上它是两个不同的基础。对不起第二个帖子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T18:34:43.943

您可以使用[`Convert.ToInt32(String, Int32) Method`](http://msdn.microsoft.com/en-us/library/1k20k614.aspx)并传递 8 作为基础。

```
Dim octal As Int32 = Convert.ToInt32(TxtOctalNumber.Text, 8) 
```

第二个参数`fromBase`

```
Type: System.Int32
The base of the number in value, which must be 2, 8, 10, or 16\. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:42:46.147

要转换为八进制，请使用[Convert.ToInt32](http://msdn.microsoft.com/en-us/library/system.convert.toint32%28v=vs.110%29.aspx) (val, 8)。Convert.ToInt32 支持有限的基数，2、8、10 和 16。

要转换为任何基础，

```
Public Shared Function IntToString(value As Integer, baseChars As Char()) As String
    Dim result As String = String.Empty
    Dim targetBase As Integer = baseChars.Length

    Do
        result = baseChars(value Mod targetBase) + result
        value = value / targetBase
    Loop While value > 0

    Return result
End Function 
```

上述功能来自[this question](https://stackoverflow.com/questions/923771/quickest-way-to-convert-a-base-10-number-to-any-base-in-net)。C# 到 VB 的转换是使用[这个](http://converter.telerik.com/). （我已经粘贴了我对[类似问题的回答](https://stackoverflow.com/questions/10504034/how-do-you-convert-a-string-into-hexadecimal-in-vb-net/10504215#10504215)。）

# c# - 在 C# 中使用 Matrix 在 XMPP 流中加入 MUC

> ID：10504303
> 
> 赞同：0
> 
> 时间：2012-05-08T18:27:51.773
> 
> 标签：c#, matrix, xmpp

所以我想写一个小机器人来加入一个 jabber 服务器（使用 Matrix XMPP SDK），并做出响应。它可以在服务器上正常运行（OnBind 被触发）。

所以我用

```
MucManager.EnterRoom(new Jid("*channel*@*domain*"), "MyTest")); 
```

加入其中一个房间，但它似乎执行了语句，并继续。当我检查我的普通客户端时，它从不显示机器人已加入。

我也尝试向我的一个朋友发送消息。同样的事情也会发生。该语句被执行，没有任何反应。

```
xmppClient.Send(new Message(new Jid("*name*@*domain*"), new Jid(userName + "@" + domain), "did you get a message now?")); 
```

我究竟做错了什么？

# c++ - C++ 警告——应使用标识符而不是“}”

> ID：10504307
> 
> 赞同：3
> 
> 时间：2012-05-08T18:28:14.773
> 
> 标签：c++, enums

我在声明一个枚举时收到此警告

```
enum Mask {
  NONE = 0,
  L = 1,
  H =2,
  U =4,
  V =8,
  D = 0X10,
  E = 0X20,
  P = 0X40,
  Q = 0X80,
};

typedef std::vector<Mask> MaskVec; 
```

我认为这个警告来自枚举声明。你能帮我指出问题吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T18:30:25.677

您的代码包含一个额外的逗号。

```
enum Mask {
  NONE = 0,
  L = 1,
  H =2,
  U =4,
  V =8,
  D = 0X10,
  E = 0X20,
  P = 0X40,
  Q = 0X80 //You placed an extra comma here
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-08T18:30:02.293

尝试删除最后一个成员后的逗号`enum`。

# php - 如何在 PHP 中处理 TeeChart

> ID：10504309
> 
> 赞同：0
> 
> 时间：2012-05-08T18:28:33.387
> 
> 标签：php, teechart

如何处理 Tchart？因为，在 for 中的一些图表之后，新的 Tchart 因内存不足而挂起。

提前致谢

```
while (...)
{
            $chart1 = new TChart(400,250);
...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T09:36:52.253

我们修改了一些类，添加了一些 __destruct() 函数来释放内存。它仍然不完美，但正在改进。

您能否写信给“steema dot com 上的信息”引用此线程，以便我们可以将修改后的文件发送给您？

# javascript - 在 Zepto 中将 onClick 方法转换为 tap 方法

> ID：10504314
> 
> 赞同：2
> 
> 时间：2012-05-08T18:28:56.613
> 
> 标签：javascript, jquery, mobile, webkit, zepto

是否有一个简单的在移动网络应用程序上重写链接从 onclick 到使用 Zepto 的点击？目前我想为每个 onclick 实例触发 $.tap 命令。

例如

```
<a href="#" tap="doSomething(); return false;">Link</a> 
```

这是否可能，或者有没有办法阻止 onclick 触发，但采用 onclick 方法并在 $.tap 方法中调用它？

使用 Zepto 制作快速按钮有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T08:33:00.017

一种更优雅的方法是将您的点击触发器存储在一个变量中，然后在您处理触摸屏设备时将该变量从“click”重新映射到“touchstart”。

在这里，我使用一个全局对象变量 myUtils 来存储我的点击事件，它的值默认为“点击”：

```
var myUtils = myUtils || {};
myUtils.events = myUtils.events || {
  click : "click"
}; 
```

如果检测到触摸屏，则将 myUtils.events.click 属性更改为“touchstart”值：

```
if (typeof document.body.ontouchstart !== "undefined") {
  myUtils.events.click = "touchstart";
} 
```

现在，当我将点击事件绑定到我的元素时，我使用 myUtils.events.click 属性作为事件名称：

```
$(function() {
   $("#link").bind(myUtils.events.click, function(e) {
     alert("I'm a " + e.type);
     e.preventDefault();
   });
});​ 
```

这样我只需要做“它是触摸屏吗？” 在我的应用程序中测试一次，之后我将根据需要绑定到“touchstart”或“click”。我不必担心取消移动设备上不需要的点击事件，因为该事件从一开始就没有绑定。

e.preventDefault() 调用将阻止链接被跟踪（假设#link 是一个href 链接）。

JSFiddle 版本：http: [//jsfiddle.net/BrownieBoy/Vsakw/](http://jsfiddle.net/BrownieBoy/Vsakw/)

请注意，此代码假定触摸屏设备*只是*触摸屏设备；即手机或平板电脑。如果您使用的是触摸屏 PC，那么您将无法使用鼠标使用它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T18:22:48.793

好的，所以我理解您的方式是您希望在移动设备和台式机上具有不同的行为，但使用相同的代码。如果是这样，那么您需要确定您所在的平台，然后定义您的代码

```
if(MOBILE) {
    $('element').click(function(){
        return false;
    });

    $('element').on('touchstart', function(){
        // functionality of the onclick written here
    });
}
else {
// desktop event listeners
} 
```

# javascript - 由于 javascript 挂断，Like 按钮不起作用

> ID：10504320
> 
> 赞同：0
> 
> 时间：2012-05-08T18:29:19.577
> 
> 标签：javascript, button, iframe, facebook-like

我有一个问题，我使用的是 iframe 版本的 Like 按钮，但我似乎不起作用。当我按赞时，它会显示计数计时器，但它不会根据我的兴趣出现在我的 Facebook 上。

这是调试器的链接：http: [//developers.facebook.com/tools/debug/og/object ?q=http%253A%252F%252Fwww.softib.lv%252Flv%252Fkrustvardu-miklas%252F](http://developers.facebook.com/tools/debug/og/object?q=http%253A%252F%252Fwww.softib.lv%252Flv%252Fkrustvardu-miklas%252F)

还有什么我应该提供的吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T18:39:41.067

首先，您需要在页面顶部打开图形元标记。但是，我没有在您的页面上看到“赞”按钮。如果我们能看到并测试它会有所帮助。

# c# - 从控制台中删除特殊字符 - c#

> ID：10504322
> 
> 赞同：2
> 
> 时间：2012-05-08T18:29:30.867
> 
> 标签：c#, console

我试图编写一个从控制台中删除特殊字符的函数。例如，如果我写：

```
Console.WriteLine("Hello World"); 
```

在我用字符 'o' 调用函数后，控制台将如下所示：

```
"Hell Wrld" 
```

我想过在整个控制台上运行

```
Console.SetCursorPosition(i,j); 
```

但我无法获得“CursorPosition”的值..

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:43:31.597

您可以**读取**已写入控制台的内容！

在 .NET 中没有读取控制台缓冲区的方法，但是您可以调用几个 WinAPI 函数来完成工作。

查看[GetStdHandle()](http://www.pinvoke.net/default.aspx/kernel32/GetStdHandle.html)、[GetConsoleScreenBufferInfo()](http://www.pinvoke.net/default.aspx/kernel32.getconsolescreenbufferinfo)和[ReadConsoleOutput()](http://www.pinvoke.net/default.aspx/kernel32/ReadConsoleOutput.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:45:14.510

您无法读取已写入控制台的内容。但是，您可以做的一件事是提供您自己的输出流。您可以制作自己的`TextWriter`实现，将原始输出流与过滤器字符一起提供。然后您可以将控制台的输出流设置为新的，之后任何人写入您的程序输出流时，它都会过滤您选择的字符。

我已经使用以下代码行运行了一些简单的测试，它似乎工作得很好。让我知道它是否不涵盖任何更复杂的情况。

```
public class FilteringTextWriter : TextWriter
{
    private HashSet<char> invalidChars;
    private TextWriter destinationStream;
    public FilteringTextWriter(IEnumerable<char> invalidChars, TextWriter destinationStream)
        : base()
    {
        this.invalidChars = new HashSet<char>(invalidChars);
        this.destinationStream = destinationStream;
    }
    public override void Write(char value)
    {
        if (!invalidChars.Contains(value))
        {
            destinationStream.Write(value);
        }
    }
} 
```

在 Main 的其他地方或某处：

```
Console.SetOut(new FilteringTextWriter(new[] { 'o' }, Console.Out)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:33:07.027

[`Console.CursorLeft`](http://msdn.microsoft.com/en-us/library/system.console.cursorleft.aspx)并且[`Console.CursorTop`](http://msdn.microsoft.com/en-us/library/system.console.cursortop.aspx)是光标位置的“get”方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T18:43:06.943

您无法从控制台缓冲区读取，即您无法获取已写入控制台的内容。（直接在 C# 中，但您可以使用本机 Windows API 或使用互操作）。

因此，也许您最好将 Console 类包装在您自己的类中，并在将字符串写入屏幕之前对其进行过滤，

```
 public MyConsole
 {
     // expose the neede methods:
     public void WriteLine(string text)
     {
         Console.WriteLine(text.Replace(...)); // filter out the special chars
     }
 } 
```

然后使用`MyConsole`而不是`Console`.

# database - 我的服务器使用 node.js，需要设置用户帐户，我应该使用哪个数据库程序？

> ID：10504324
> 
> 赞同：3
> 
> 时间：2012-05-08T18:29:45.327
> 
> 标签：database, node.js, user-accounts

我对整个 node.js 东西（以及服务器、javascript 和一般的互联网）都很陌生。我正在设置一个 node.js 服务器，我希望能够创建用户帐户。

假设 1：这需要使用某种数据库。

起初我打算使用 mySQL，因为它是我能想到的第一个 DBMS，它是开源的，并且有一个 node.js 模块。但是翻阅stackoverflow等网站，大家都在谈论使用mongoose、redis等东西。

我应该使用什么？我为什么要使用它？我离理解还有多远？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:42:34.403

Redis 是一个快速的键值存储，非常适合会话之类的东西。我在社区中看到很多带有 Mongoose 的 MongoDB，但我自己更像是一个 CouchDB 人。

如果你喜欢学习新东西，你可以尝试其中的一些，看看你喜欢哪一个。如果你有最后期限并且你知道 MySql，我现在会坚持下去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:47:22.537

MongoDB 是一个不错的选择。[我本人是Redis](http://redis.io)的忠实粉丝（即使对于小型的日常数据库也是如此）。

如果您的数据不需要 ORM 类型建模，我建议[使用 MongoJS](https://github.com/gett/mongojs)或[Mongoskin](https://github.com/kissjs/node-mongoskin)。它们都使得用很少的代码与 MongoDB 交互变得非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:06:01.300

如果这是针对您只是在本地机器上构建以进行学习的项目，那么带有[mongoose](http://mongoosejs.com/)和[mongoose-auth 的](https://github.com/bnoguchi/mongoose-auth)[mongodb](http://www.mongodb.org/)可以让您快速入门。

如果您打算将其部署到某个地方的生产中，您应该了解您的托管服务提供商提供的服务。如果您还没有选择托管服务提供商，请查看[Heroku](http://www.heroku.com/)。他们提供[PostgreSQL](http://www.postgresql.org/)，它们使部署您的应用程序变得非常容易，而不必担心服务器设置和配置等。

# java - C++/Java/Python 中的 PHP imagettftext() 等效函数

> ID：10504325
> 
> 赞同：0
> 
> 时间：2012-05-08T18:29:50.187
> 
> 标签：java, php, c++, python, imagettftext

在 C++/Java/Python 库中是否有 PHP 函数 imagettftext() 的简单等价物？

[http://php.net/manual/en/function.imagettftext.php](http://php.net/manual/en/function.imagettftext.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:01:49.257

在python中你可以使用`PIL`：

```
from PIL import Image, ImageDraw, ImageFont
font = ImageFont.truetype("/usr/share/fonts/truetype/ttf-bitstream-vera/Vera.ttf", 18)
img = Image.open("test.jpg")
draw = ImageDraw.Draw(img)
draw.text((40, 40), "...sample text...", font=font, fill="red")
img.show() 
```

在 java 中，您可以简单地绘制任何`java.awt.Image`实例：

```
import javax.imageio.*;
import java.awt.*;
import java.awt.image.*;
import java.io.*;
import javax.swing.*;

public class ImageTest {
   public static void main(String args[]) throws Exception {
      BufferedImage img = ImageIO.read(new File("test.jpg"));
      Graphics2D g = img.createGraphics();
      Font f = Font.createFont(
            Font.TRUETYPE_FONT,
            new File("/usr/share/fonts/truetype/ttf-bitstream-vera/Vera.ttf")
      ).deriveFont(18f);
      g.setFont(f);
      g.setColor(Color.RED);
      g.drawString("test string", 40, 40);
      JFrame jf = new JFrame("test");
      jf.add(new JLabel(new ImageIcon(img)));
      jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      jf.setVisible(true);
      jf.pack();

   }
} 
```

对于 c++ 有很多图像库（[imagemagick-bindings](http://www.imagemagick.org/Magick++/)，[CImg](http://cimg.sourceforge.net/)，...）

# php - 如何以编程方式编辑购物车价格（或在添加商品时应用折扣）

> ID：10504327
> 
> 赞同：0
> 
> 时间：2012-05-08T18:29:51.663
> 
> 标签：php, magento, checkout, discount

我正在定制一个 POS 扩展，以准备在场外活动中自动售货。

以前，我们只是简单地手动收取销售费用，然后再回去手动添加订单。这个 POS 扩展将让我们使用我们的实时网站来销售商品，然后正确记录销售情况（并且现有的支付方式也可以使用）。

现在，我正在尝试对添加到购物车的商品应用特殊定价。扩展程序的代码这样做是为了将商品添加到购物车：

```
$product_model  = Mage::getModel('catalog/product')->setStoreId(Mage::app()->getStore()->getId());
$session        = Mage::getSingleton('checkout/session');
$cart           = Mage::getSingleton('checkout/cart');
$product_model = Mage::getModel('catalog/product')
    ->setStoreId(Mage::app()->getStore()->getId())
    ->load($pr_id);

if(!$product_model)
    throw new Exception("Product id {$pr_id} not found");

$cart->addProduct($product_model, array('qty' => $qty));
$cart->save();
$session->setLastAddedProductId($last_pr_id);
$this->getPos()->getQuote()->collectTotals()->save(); 
```

我发现的关于应用定价的一切都是在购物车级别完成的，`$item`而不是在购物车级别。在其他代码中，我已经尝试过，`$product_model->setCustomPrice($price);`但是那些都不起作用。我觉得我非常接近解决方案。`setPrice()``setOriginalPrice()`

有经验的人会帮助我在上下文中获取项目或找到在上述代码段中应用折扣的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:01:32.633

您需要参加一个活动，看看我在这里提供的答案，如果您有任何问题或遇到问题，请告诉我：

[在将产品添加到购物车时更改报价中的价格：magento](https://stackoverflow.com/questions/9721583/changing-the-price-in-quote-while-adding-product-to-cart-magento/9723026#9723026)

# android - Android Phonegap 越来越不幸 已经停止

> ID：10504335
> 
> 赞同：0
> 
> 时间：2012-05-08T18:30:22.923
> 
> 标签：android, cordova

如果我在 Phonegap 应用程序中更改项目构建目标，我会得到“不幸的是已意外停止”

我制作了目标构建路径为 4.0.3 的应用程序，并将 min-sdk 设置为 7。该应用程序一开始可以正常运行，但 Google 不允许平板电脑下载它。

如果我在收到相同消息后做任何事情来更改构建目标和/或将构建目标更改为原始版本。届时，该应用程序将不会在任何设备上加载。

我不确定是什么原因造成的，但即使我有一个应用程序已经很好地安装了 beeb 并且运行良好，如果我修改一个文件，它也会给我一个错误。

还有一件事，我注意到如果我将文件推送到 bitbucket，它也会开始这样做，但并非一直如此。这是我从游戏市场收到的错误消息。

任何帮助表示赞赏。

java.lang.RuntimeException: 无法实例化活动 ComponentInfo{your.abSmallBusinessMarketing.hapmen/your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity}: java.lang.ClassNotFoundException: your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity in loader dalvik.system.PathClassLoader[/data /app/your.abSmallBusinessMarketing.hapmen-1.apk] 在 android.app.ActivityThread 的 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1618) 的 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1716)。在 android.os.Handler.dispatchMessage(Handler.java:99) 在 android.os.Looper.loop( Looper.java:130) 在 android.app.ActivityThread.main(ActivityThread.java:3806) 在 java.lang.reflect.Method。在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 在 com.android.internal 的 java.lang.reflect.Method.invoke(Method.java:507) 的 invokeNative(Native Method)。 os.ZygoteInit.main(ZygoteInit.java:597) at dalvik.system.NativeStart.main(Native Method) 引起：java.lang.ClassNotFoundException: your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity in loader dalvik.system.PathClassLoader[/data /app/your.abSmallBusinessMarketing.hapmen-1.apk] 在 dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:551) 在 java.lang.ClassLoader。 loadClass(ClassLoader.java:511) 在 android.app.Instrumentation.newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)在 dalvik 的 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 的 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 调用(Method.java:507) .system.NativeStart.main(Native Method) 引起：java.lang.ClassNotFoundException: your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity in loader dalvik.system.PathClassLoader[/data/app/your.abSmallBusinessMarketing.hapmen-1.apk] at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:551) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:511) 在 android.app.Instrumentation .newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)在 dalvik 的 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 的 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 调用(Method.java:507) .system.NativeStart.main(Native Method) 引起：java.lang.ClassNotFoundException: your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity in loader dalvik.system.PathClassLoader[/data/app/your.abSmallBusinessMarketing.hapmen-1.apk] at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:551) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:511) 在 android.app.Instrumentation .newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)dalvik.system.NativeStart.main(Native Method) 处的 android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 原因：java.lang.ClassNotFoundException：加载程序 dalvik.system 中的 your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity。 PathClassLoader[/data/app/your.abSmallBusinessMarketing.hapmen-1.apk] at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) at java.lang.ClassLoader.loadClass(ClassLoader.java:551) at java。 lang.ClassLoader.loadClass(ClassLoader.java:511) 在 android.app.Instrumentation.newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)dalvik.system.NativeStart.main(Native Method) 处的 android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 原因：java.lang.ClassNotFoundException：加载程序 dalvik.system 中的 your.abSmallBusinessMarketing.hapmen.FlowChartbyHapmanActivity。 PathClassLoader[/data/app/your.abSmallBusinessMarketing.hapmen-1.apk] at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) at java.lang.ClassLoader.loadClass(ClassLoader.java:551) at java。 lang.ClassLoader.loadClass(ClassLoader.java:511) 在 android.app.Instrumentation.newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)FlowChartbyHapmanActivity in dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) at java.lang.ClassLoader.loadClass(ClassLoader. java:551) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:511) 在 android.app.Instrumentation.newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)FlowChartbyHapmanActivity in dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240) at java.lang.ClassLoader.loadClass(ClassLoader. java:551) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:511) 在 android.app.Instrumentation.newActivity(Instrumentation.java:1021) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1610)1610)1610)

这里是maifest

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="your.abSmallBusinessMarketing.hapmen"
    android:versionCode="7"
    android:versionName="1.3" >

    <supports-screens
        android:anyDensity="true"
        android:largeScreens="true"
        android:normalScreens="true"
        android:resizeable="true"
        android:smallScreens="true"
         android:xlargeScreens="true" />

    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />

    <uses-sdk android:minSdkVersion="7" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".FlowChartByHapmanActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="org.apache.cordova.DroidGap"
            android:configChanges="orientation|screenSize|keyboardHidden"
            android:label="@string/app_name"
            android:screenOrientation="portrait" >
            <intent-filter>
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:00:36.490

您在 java 和清单之间的活动名称中的“by”大小写不一致。

# sql - T-SQL 使用不存在的地方

> ID：10504339
> 
> 赞同：0
> 
> 时间：2012-05-08T18:30:25.720
> 
> 标签：sql, tsql

![在此处输入图像描述](../Images/c81cd9083d5d5465e7fe8f435ef00457.png)

我在 tblVisits 中有一个名为“tobacco”的属性。tblICD 是医疗代码列表，icd_jxn 是连接表。tblICD.Descript 是医疗代码 (ICD_ID) 的文本描述。我正在尝试查看是否有人`NOT`在其医疗代码列表中确实具有字符串“烟草”的人将其`bit`“烟草”属性设置为 1。下面的查询是我最好的猜测，但它不正确。

```
SELECT tblVisits.kha_id, tblVisits.tobacco from tblvisits
WHERE NOT EXISTS (SELECT icd_jxn.kha_id, icd_jxn.icd_fk, tblICD.icd_id, tblICD.Descrip
                   FROM icd_jxn inner join 
                        tblICD on icd_jxn.icd_fk = tblicd.icd_id
                       WHERE (tblicd.descrip like N'%tobacco%') AND (tblVisits.kha_id = icd_jxn.kha_id) and (tblvisits.tobacco=1)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:36:59.007

没有保证的情况

```
select v.kha_id, v.tobacco
from tblvisits v
where v.tobacco = 1
and not exists (select null from icd_jxn j
     inner join tblICD i on j.icd_ICD_FK= i.IDC_ID
     where j.KHA_ID = v.KHA_ID
     and i.Descrip like N'%tobacco%'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:42:11.777

如果您将其视为对患者的总结，则此查询似乎更简单。患者是否设置了烟草属性？专利的描述中是否包含烟草？

以下查询使用此逻辑：

```
select *
from (select tv.kha_id, tv.tobacco,
             MAX(case when charindex(N'tobacco', ticd.descrip) > 1 then 1 else 0 end) as tobacco_description,
      from tblvisits tv join
           icd_jxn jxn
           on tv.kha_id = jxn.kha_id join
           tblICD ticd
           on jxn.icd_fk = ticd.icd_fx
      group by tv.kha_id, tv.tobacco
     ) t
where tobacco_description = 1 and tobacco_description = 0 
```

子查询汇总患者级别的数据。您可以通过添加适当的“有”子句来消除它。但是，我发现子查询更具可读性，并且应该具有相同的性能。此外，它还可以计算烟草、钻头和烟草描述的所有不同组合。

最后，我将“like”替换为“charindex”，因为后者效率更高。

# maven - 如何可靠地判断哪个 Maven 插件使 Jenkins 构建失败？

> ID：10504341
> 
> 赞同：0
> 
> 时间：2012-05-08T18:30:37.840
> 
> 标签：maven, jenkins

因此，在 Jenkins 中，我使用了各种有用的插件，例如 Cobertura、Emma 等，所有这些都可能由于各种原因而失败。

一般来说，这些插件的错误报告很糟糕，因此通常无法轻松判断哪个插件未能通过构建。通常我会看到来自另一个插件的后续消息，说它不会做任何事情，因为该构建之前已被其他插件标记为 FAILED，但通常没有迹象表明其他插件是谁。

当插件本身没有这样做时，有没有办法让 maven 真正识别出哪个插件失败了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:52:34.903

您可以使用带有 mvn 命令的 -X 标志和 -e 标志打开 Maven 调试输出，以启用完整的执行错误消息。

# vb.net - 在 ComboBox VB.net 中更改索引时自动触发函数调用

> ID：10504344
> 
> 赞同：0
> 
> 时间：2012-05-08T18:30:50.257
> 
> 标签：vb.net, combobox, indexing

好吧，所以我正在开发一个失败的大型程序，我想添加一个新功能，但我什至无法开始。我在 Visual Basic .net 中的 Windows 窗体中，基本上，我在下拉菜单中有一个包含 3 个项目的组合框。我想在选择组合框中的一个项目的那一刻，程序识别索引的变化并自动调用我选择的函数。我只需要这个概念的帮助和正确的方向，而不是一个精确的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:33:33.723

您正在寻找的是表单的“背后代码”中的类似内容：

```
Private Sub ComboBox1SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles ComboBox1.SelectedIndexChanged
    ' DO STUFF HERE
End Sub 
```

# css - CSS字体选择器使用

> ID：10504345
> 
> 赞同：0
> 
> 时间：2012-05-08T18:30:50.903
> 
> 标签：css, font-face

我们已经实现了一个字体工具包，但仍然遇到字体如何呈现数字的问题。出于某种原因，这些数字似乎在其基线上方和下方浮动，使它们看起来“有弹性”。我们实现了 webfont 工具包，下面是 CSS 示例：

```
@font-face {
    font-family: "interval_semi_bold";
    font-style: normal;
    font-weight: normal;
    src: url("/common/fonts/interval_semi_bold-webfont.eot?#iefix") format("embedded-opentype"), url("/common/fonts/interval_semi_bold-webfont.woff") format("woff"), url("/common/fonts/interval_semi_bold-webfont.ttf") format("truetype"), url("/common/fonts/interval_semi_bold-webfont.svg#IntervalSansProBold") format("svg");
}
@font-face {
    font-family: "interval_regular";
    font-style: normal;
    font-weight: normal;
    src: url("/common/fonts/interval_regular-webfont.eot?#iefix") format("embedded-opentype"), url("/common/fonts/interval_regular-webfont.woff") format("woff"), url("/common/fonts/interval_regular-webfont.ttf") format("truetype"), url("/common/fonts/interval_regular-webfont.svg#IntervalSansProBold") format("svg");
} 
```

问题：在浏览器如何解释@font-face 声明方面，"" 选择器的行为是否与 '' 选择器不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T11:43:59.753

“弹性”基线实际上是一种特定类型的印刷数字，用于在段落文本中设置数字。它们通常被称为“老式”数字，因为它们模仿小写字母的升序和降序行为，从而减少对沉浸式阅读的干扰。与小写字母一样，它们也具有可变宽度。因此，如果您将数字用于段落设置，这是一种很好的排版做法。

另一方面，不“反弹”的数字称为“衬里”数字。它们有一个固定的、相等的宽度，这使得它们对于设置数字的垂直列很有用。

CSS3 属性`font-variant-numeric`允许您选择旧样式或衬里图形，只要字体在其字符集中具有这两种变体。

更多信息：http: [//dev.w3.org/csswg/css3-fonts/#font-variant-numeric-prop](http://dev.w3.org/csswg/css3-fonts/#font-variant-numeric-prop)

您使用的是[Interval Sans Pro](http://myfonts.us/td-D7kCMi)吗？该字体确实包含两种类型的数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T18:44:24.437

单引号或双引号在 CSS 中可以互换并且具有完全相同的含义，并且它们所使用的属性值将在每个浏览器中以完全相同的方式呈现。您使用哪种引号并不重要。故事结局。

如果您的字体*正常*工作，但只是数字看起来对您不利，则该字体中的数字很可能是故意的。例如，`Georgia`某些数字的基线非常低：

![在此处输入图像描述](../Images/ae790a64e1b1899c6a3094dac7ca5689.png)

我无法找到您要测试的确切字体，但您可能需要选择另一种以您可以接受的方式呈现数字的字体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:45:53.030

双引号`"`和单引号`'`可以在选择器中互换使用。它与浏览器如何解释它无关。

有关 URI 值的更多信息，请访问[W3](http://www.w3.org/TR/CSS2/syndata.html#value-def-uri)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T17:29:25.817

关于 Interval Regular 与 Light，Pro 版本的字体包含带有衬里和旧式图形的扩展 OpenType 字符集。标准版字体只有衬里数字；您的 Light 字体可能不是 Pro 版本。

# php - 试图将 IP 地址存储在数据库中。SQL 错误

> ID：10504346
> 
> 赞同：1
> 
> 时间：2012-05-08T18:30:51.200
> 
> 标签：php, mysql, sql

这是我试图用来存储客户端 IP 地址的代码。我试图通过尝试做一些在这个问题中看到的事情来将 IP 地址存储到一个 unsigned int 中：[Which MySQL datatype to use for an IP address?](https://stackoverflow.com/questions/5133580/which-mysql-datatype-for-an-ip-address)

这是我的代码：

```
$client_ip = $_SERVER['REMOTE_ADDR'];

$ip_insert = "SELECT INET_ATON('$client_ip')";

$sql = "INSERT INTO rtv_sign_cispa (name_cispa,ip_cispa,email_cispa,message_cispa) VALUES ('$name','$ip_insert','$email','$message')"; 
```

该语句中还有其他内容被存储，但忽略那些内容，它们有效，它是 IP 地址不是。

错误：

> 错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '192.168.2.1')​​','email@email.com','Hmmmm')' 附近使用正确的语法

near 之后的 ip 地址实际上显示了正确的 IP，当然出于安全原因，我只是将其切换为本地 ip。email@email.com 和 Hmmm 来自一个为激活它而填写的表格，所以不要介意。

有谁知道我做错了什么？我对 SQL 有点陌生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T18:36:47.593

你正在这样做：

```
$sql = "INSERT INTO rtv_sign_cispa (name_cispa,ip_cispa,email_cispa,message_cispa) VALUES ('$name',SELECT INET_ATON('$client_ip'),'$email','$message')"; 
```

因为您正在设置：

```
$ip_insert = "SELECT INET_ATON('$client_ip')"; 
```

它必须是：

```
$ip_insert = "INET_ATON('$client_ip')"; 
```

这是这样做的方法：

```
$sql = "INSERT INTO rtv_sign_cispa (name_cispa,ip_cispa,email_cispa,message_cispa) VALUES ('$name',INET_ATON('$client_ip'),'$email','$message')"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T18:37:35.043

```
$ip_insert = "SELECT INET_ATON('$client_ip')"; 
```

只是一个字符串，您必须将此字符串查询到数据库然后获取结果或

```
$sql = "INSERT INTO rtv_sign_cispa (name_cispa,ip_cispa,email_cispa,message_cispa) VALUES ('$name',INET_ATON('$client_ip'),'$email','$message')"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:40:59.263

我想你想要：

```
$ip_insert = ip2long($client_ip);
$sql = "INSERT INTO rtv_sign_cispa (name_cispa,ip_cispa,email_cispa,message_cispa) VALUES ('$name','$ip_insert','$email','$message')"; 
```

但你会更好地使用：

```
$sth = $dbh->prepare("INSERT INTO rtv_sign_cispa (name_cispa,ip_cispa,email_cispa,message_cispa) VALUES (?,?,?,?)");
$sth->bindParam(1, $name, PDO::PARAM_STR);
$sth->bindParam(2, $ip_insert, PDO::PARAM_INT);
$sth->bindParam(3, $email, PDO::PARAM_STR);
$sth->bindParam(4, $message, PDO::PARAM_STR);
$sth->execute(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T18:36:28.053

你运行的是什么版本的mysql？尝试`inet_aton('192.168.1.1')`在您的 sql 命令行上运行该命令，看看它是否有效。它应该输出如下内容：

```
mysql> select inet_aton('192.168.1.1');
+--------------------------+
| inet_aton('192.168.1.1') |
+--------------------------+
|               3232235777 |
+--------------------------+
1 row in set (0.00 sec) 
```

您的 inet_aton() 函数似乎不起作用，这就是您在 sql 错误中看到 IP 地址的原因

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T18:39:26.287

使用`INET_ATON`代替`"SELECT INET_ATON"`（因为这会从数据库返回一条记录）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T18:45:39.650

您的 sql 语句中似乎有一个额外的 ) 很难说它为什么在那里。似乎您转换为 unsigned int 出错了。您还可以在插入数字时将单引号放在 $ip_insert 周围，并且该错误表明您正在插入字符串。

'192.168.2.1')​​' 看起来不正确，因为您尝试插入数字而不是字符串。您应该记录整个语句以查看正在执行的确切内容。谷歌日志记录 SQL 语句 mysql 并设置日志记录。为它运行查询检查日志，然后尝试调试它。

这似乎是一个简单的语法错误。但是我可能是非常错误的，因为我已经 7 年多没有接触 PHP 了。

# eclipse-rcp - DialogCellEditor：如何在更改时触发事件/将属性标记为已更改？

> ID：10504350
> 
> 赞同：0
> 
> 时间：2012-05-08T18:31:29.947
> 
> 标签：eclipse-rcp, jface

我有一个扩展*PropertyDescriptor*的类，它会打开一个小对话框进行值输入。
到目前为止它工作正常，显示对话框，我可以输入所有值。但是系统没有显示该文件已被编辑。

该对话框是*InputDialog*的副本。

我曾尝试使用`fireApplyEditorValue`,`fireEditorValueChanged`和`valueChanged`. 但这没有什么区别。
我检查了可以在 fire 方法中找到的侦听器，它们是*TextCellEditor*使用的相同侦听器。

我想不通，我错过了什么。

感谢您的任何建议。

这是我的`createPropertyEditor`方法：

```
public CellEditor createPropertyEditor(Composite parent) {
    CellEditor editor = new DialogCellEditor(parent) {
        @Override
        protected Object openDialogBox(Control cellEditorWindow) {
            SimpleDialog dialog = new SimpleDialog(cellEditorWindow.getShell(), (SomeValue) doGetValue());
            dialog.open();
            return dialog.getValue();
        }
    };
    if (getValidator() != null)
        editor.setValidator(getValidator());
    return editor;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T15:36:53.337

我发现了我的错误。
我必须覆盖`equals`我的类*SomeValue*中的方法。

# android - Android SDK 降级 如何

> ID：10504351
> 
> 赞同：1
> 
> 时间：2012-05-08T18:31:31.737
> 
> 标签：android

我安装了 Android SDK 4.0.3，我想安装一个以前的版本（例如 2.2）所以我应该卸载 4.0.3 版本吗？

怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:03:51.630

只需在 Android SDK 管理器 [http://developer.android.com/sdk/adding-components.html中安装所需的 SDK](http://developer.android.com/sdk/adding-components.html)

然后在创建新项目时只需在eclipse中选择所需的SDK，或者在Eclipse中项目首选项的“Android”选项卡中更改SDK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:25:41.263

不，你不应该降级。

它是这样工作的：Android SDK 由几个组件组成。一种是SDK工具，平台版本通用，只需要升级即可。这些是主机系统工具（它们在您的工作站上工作），例如 Emulator、android（又名 Android SDK 管理器）、adb（又名 Android 调试桥）、构建工具等。此外，您需要安装一个或多个平台 SDK。Platform SDK 主要是特定于所选 Android 版本的 jar 集合（请注意使用内部 API 级别），因此您可以针对它编译代码。可以同时安装多个版本。您应该使用“android”工具安装选定的 android SDK 平台。

当您编写 Android 应用程序时，您指定最低 API 级别（Android 的最低版本，在哪个应用程序上运行）和目标 API 级别，这是您编译的 Android 版本（因此这里不会使用更新的 API）。您可以设置最低 API 级别，而无需安装具有该级别的 SDK，但您需要在构建之前安装具有目标 API 级别的平台 SDK。

# android - android应用程序中的adapter.clear

> ID：10504353
> 
> 赞同：1
> 
> 时间：2012-05-08T18:31:33.133
> 
> 标签：android, crash, android-arrayadapter

我试图让几个微调器根据他们之前的微调器选择动态更改。我可以更新列表，但是当我使用 adapter.clear() 时它会崩溃。这是我的代码：

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.TextView;

public class CarKitsAct extends Activity{

    ArrayAdapter<String> adMod, adEd;
    String[] models, edition;
    Boolean initSpMan = true;
    Boolean initSpMod = true;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.carkitslayout);

    // Construct TextViews
        TextView textMan = (TextView) findViewById(R.id.textMan);
        textMan.setText(R.string.selectmanufacturer);
        TextView textMod = (TextView) findViewById(R.id.textMod);
        textMod.setText(R.string.selectmodel);
        TextView textEd = (TextView) findViewById(R.id.textEd);
        textEd.setText(R.string.selectedition);

    // Construct Spinners
        Spinner spMan = (Spinner) findViewById(R.id.spMan);
        Spinner spMod = (Spinner) findViewById(R.id.spMod);
        Spinner  spEd = (Spinner) findViewById(R.id.spEd);

    // Construct Manufacturer Spinner Adapter
        ArrayAdapter<CharSequence> adMan;
        adMan = ArrayAdapter.createFromResource(this, R.array.cars, android.R.layout.simple_spinner_item);
        adMan.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spMan.setAdapter(adMan);

    // Set initial values for model and edition spinners
        models = getResources().getStringArray(R.array.AC);
        edition = getResources().getStringArray(R.array.ACAcceca);

    //Construct adapters for models and editions
        adMod = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, models);
        adMod.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        adMod.setNotifyOnChange(true);
        spMod.setAdapter(adMod);

        adEd = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, edition);
        adEd.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        adEd.setNotifyOnChange(true);
        spEd.setAdapter(adEd);

    // Set up listeners for item selection
        spMan.setOnItemSelectedListener(new ManItemSelectedListener());
    }

    public class ManItemSelectedListener implements OnItemSelectedListener {
        public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
            if (initSpMan ==  true) {
                initSpMan = false;
            } else {
                models = getResources().getStringArray(2130968577 + pos);
                adMod.clear();
                adMod.addAll(models);
                adMod.notifyDataSetChanged();               
            }
    }
        public void onNothingSelected(AdapterView<?> parent) {}
    }
} 
```

如您所见，我尝试使用布尔标志来确定微调器是否刚刚创建，但是当我更改选择时，它会死掉。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:47:21.827

你可能会得到一个`UnsupportedOperationException`，对吧？这是因为适配器使用对象数组进行初始化，它会在内部将其转换为`AbstractList`无法修改的 。

要解决您的问题，您只需要将实现`List<?>`接口的东西提供给适配器。例子：

```
String[] strings = getResources().getStringArray(R.array.cars);
List<String> items = new ArrayList<String>(Arrays.asList(strings));
ArrayAdapter<String> adMan = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, items); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:52:08.080

呵呵，不敢相信你遇到了和我几个小时前一样的问题。我已经报告了一个关于此的错误：[错误报告](http://code.google.com/p/android/issues/detail?id=30498&q=ArrayAdapter&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars)

问题在于，当您将数组传递给构造函数时，它实际上调用了另一个构造函数重载，该重载采用 List 而不是 Array with `Arrays.asList(array)`。但是，此方法仅返回支持数组的**视图**，因此不允许在列表中添加和删除元素。如果您愿意，可以在 android 问题跟踪器中为错误报告加注星标。

例如，您还可以在[此处](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.1_r1/android/widget/ArrayAdapter.java#ArrayAdapter)查看ArrayAdapter 类的代码

# jquery - JQuery：复选框作为单选按钮，没有默认选择

> ID：10504354
> 
> 赞同：0
> 
> 时间：2012-05-08T18:31:34.987
> 
> 标签：jquery

我有一个动态生成的列表，从零个项目开始随机长度，其中每个项目都包含一个复选框。与单选按钮不同，可以取消选中所有复选框，但与单选按钮一样，只能*选中*一个。为了强制执行此操作，我正在使用 JQuery（基于此处给出的答案：[jQuery - checkboxes like radiobuttons](https://stackoverflow.com/questions/881166/jquery-checkboxes-like-radiobuttons)）

我目前的代码是：

```
var $radiocheck = $('input.radiocheck');
$radiocheck.click(function() {
    if($(this).is(':checked')) {
        $(this).attr('checked', false);
    }
    else if($(this).not(':checked')) {
        $radiocheck.removeAttr('checked');
        $(this).attr('checked', true);
    }
}); 
```

...但它不起作用（单击时复选框保持未选中状态）。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T18:35:12.057

```
var $radiocheck = $('input.radiocheck');

$radiocheck.on('click', function() {
    $radiocheck.not(this).prop('checked', false);
    this.checked = this.checked===true ? true:false; // to toggle, otherwise just set to true
});​ 
```

[小提琴](http://jsfiddle.net/adeneo/gYR4a/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:41:34.023

**一：**

```
 var $radiocheck = $('input.radiocheck');

    $radiocheck.on('click', function() {
        $radiocheck.not(this).attr('checked', false);
        this.checked = this.checked;
    }); 
```

**[演示：一个](http://jsfiddle.net/xTFXT/4/)**

**二：**

```
 var $radiocheck = $('input.radiocheck');

   $radiocheck.on('click', function() {
     $radiocheck.not(this).attr('checked', false).find(this).attr('checked', this.checked);
   }); 
```

[**演示：两个**](http://jsfiddle.net/xTFXT/5/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-28T07:38:38.363

使用 adeneo 的方法但不使用 css 类进行选择的另一个答案：

```
$(document).ready(function() {
   var $radiocheck = $(":checkbox");
   $radiocheck.on('click', function() {
     $radiocheck.not(this).attr('checked', false);
     this.checked = this.checked === true ? true : false;
   });
 }); 
```

[小提琴](https://jsfiddle.net/petersk8/uf63csqr/)

# amazon-web-services - 亚马逊网络服务节流

> ID：10504356
> 
> 赞同：1
> 
> 时间：2012-05-08T18:31:43.937
> 
> 标签：amazon-web-services

目前我有两个应用程序查询亚马逊网络服务。

应用程序“A”已被列入白名单，我仍然可以使用 AWS 查询旧的产品广告 API。

应用程序“B”使用 MWS 系统。

应用程序“A”查询似乎适用于应用程序“B”油门限制。这是准确的吗？

如果我访问不同的 API，它们之间会共享限制限制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T19:50:54.963

答案是产品广告 api 有自己的限制，不会反映在 MWS 限制系统上。

随着产品广告 API 被删除，这个问题现在没有实际意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-02T18:03:43.227

看看下面的链接： [http ://docs.aws.amazon.com/kms/latest/developerguide/limits.html](http://docs.aws.amazon.com/kms/latest/developerguide/limits.html)

目前尚不清楚您的 API 正在使用哪种 AWS 服务。但一般来说，例如，如果您使用 KMS 集成，那么您帐户的某个区域的并发连接数是有限制的。如果您超出已发布的限制，它将被限制。

# c# - 组合框下拉菜单显示在错误的位置

> ID：10504357
> 
> 赞同：2
> 
> 时间：2012-05-08T18:31:49.850
> 
> 标签：c#, asp.net, .net, ajaxcontroltoolkit

![组合框](../Images/8bb60762d05b0ec9567d846d08212ca8.png)

有一个 ajaxcontroltoolkit 组合框。不知何故，下拉菜单没有显示在左侧（见图）。

.Net 代码

```
<ajaxToolkit:ComboBox ID="cbState" runat="server" AutoPostBack="true" DropDownStyle="Dropdownlist" AutoCompleteMode="None" ItemInsertLocation="Append" CssClass="searchcontentCombobox" /> 
```

CSS

```
.searchcontentCombobox .ajax__combobox_inputcontainer {}
.searchcontentCombobox .ajax__combobox_textboxcontainer input {border:0;width:160px;height:22px;padding:3px 10px 3px 7px;background:#1f1f1f;color:#fff;}
.searchcontentCombobox .ajax__combobox_buttoncontainer button {border:0;background:url(../img/menu_searchcontent.gif) no-repeat center right;}
.searchcontentCombobox .ajax__combobox_itemlist {} 
```

任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T23:03:48.733

这个 css 对我有用，可以让下拉列表对齐。

```
.ajax__combobox_itemlist
{
    position:fixed !important;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T16:20:23.943

我把组合框放在一个div中。div 没有设置定位。

然后我把它放在我的样式表中：

```
.ajax__combobox_itemlist
{
    position:relative !important; 
    height: 100px !important;
    overflow: auto !important;
    top: 0px !important;
    left: 0px !important;
} 
```

然后将弹出的下拉列表绑定到 div 的左上角。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T00:18:40.410

我也有类似的事情发生在我身上。我必须添加一个元标记以确保 ie8 在 doctype 声明中。您可以使用开发人员工具栏或萤火虫查看您是否遇到同样的问题。一旦我更改了文档类型以模拟 ie8，一切都很好。

# codeigniter - Codeigniter/Pyrocms 中的基本路由

> ID：10504358
> 
> 赞同：0
> 
> 时间：2012-05-08T18:32:01.717
> 
> 标签：codeigniter, routing, pyrocms

我在 pyrocms 中有一个模块，它被称为事件，因为由于已经存在的事件类，我不能将它称为事件

我想让 localhost/events url 指向事件模块，所以我尝试在 event/config/routes.php 中设置路由

用这条线

```
$route['events/(:any)?']        = 'event/$1'; 
```

但这不起作用 - 我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T20:07:37.513

您需要指向类/方法，即：

```
$route['events/(:any)'] = 'class/method/$1'; 
```

`(:any)`并且`(:num)`是通配符。您可以使用自己的模式。

举这个例子（用于演示目的）：

```
// www.mysite.com/search/price/1.00-10.00
$route['search/price/(:any)'] = 'search/price/$1'; 
```

`$1`等于通配符`(:any)`

所以你可以说

```
public function price($range){
     if(preg_match('/(\d.+)-(\d.+)/', $range, $matches)){
         //$matches[0] = '1.00-10.00'
         //$matches[1] = '1.00'
         //$matches[2] = '10.00'
     }

     //this step is not needed however, we can simply pass our pattern into the route.
     //by grouping () our pattern into $1 and $2 we have a much cleaner controller

     //Pattern: (\d.+)-(\d.+) says group anything that is a digit and fullstop before/after the hypen( - ) in the segment 
} 
```

所以现在路线变成了

```
$route['search/price/(\d.+)-(\d.+)'] = 'search/price/$1/$2'; 
```

控制器

```
public function price($start_range, $end_range){} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:28:52.867

我认为问号可能会干扰路由，所以应该是：

```
$route['events/(:any)'] = 'event/$1'; 
```

# c# - 添加自定义 SOAP 标头

> ID：10504361
> 
> 赞同：0
> 
> 时间：2012-05-08T18:32:14.540
> 
> 标签：c#, web-services, soap, wsdl

我有一个不公开 SOAP 标头的 WSDL，但我需要在标头中添加以下内容：

```
 <soapenv:Header>
    <UsernameToken xmlns="http://siebel.com/webservices">ANONYMOUS</UsernameToken>
    <PasswordText xmlns="http://siebel.com/webservices">ANONYMOUS</PasswordText>
    <SessionType xmlns="http://siebel.com/webservices">None</SessionType>
   </soapenv:Header> 
```

如果没有公开这些标头值，是否可以在 C# 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:03:07.853

使用[MessageContract](http://msdn.microsoft.com/en-us/library/ms730255.aspx)控制 Soap 标头/正文

[如何在 wcf 中添加自定义肥皂标题？](https://stackoverflow.com/questions/1976217/how-to-add-custom-soap-headers-in-wcf)

# drag-and-drop - 从 PyQt 4.x 拖放到 OSX 文件系统

> ID：10504363
> 
> 赞同：2
> 
> 时间：2012-05-08T18:32:44.187
> 
> 标签：drag-and-drop, qt4, pyqt, osx-snow-leopard

[与这个问题](https://stackoverflow.com/questions/5854546/how-to-implement-a-dragn-drop-from-a-qt-application-to-a-file-system-folder)非常相似，我希望能够将图像从 PyQt 应用程序拖放到 OSX 文件系统。

但是，当我使用以下代码时，放置位置不会出现任何内容。

看来我很接近了。如果我更改`mimeData.setData(mimeType, byteArray)`为`mimeData.setData("text/plain", selectedImagePath)`，我会在放置目标处获得一个“无标题剪辑”文件，因此至少我可以确定拖放操作正在工作。

```
def startDrag(self, event):     

    selectedImagePath = "/sample/specified/file.jpg"

    ## convert to  a bytestream
    #
    mimeData = QtCore.QMimeData()
    image = QtGui.QImage(selectedImagePath)
    extension = os.path.splitext(selectedImagePath)[1].strip(".")
    mimeType = "image/jpeg" if extension in ["jpeg", "jpg"] else "image/png"

    byteArray = QtCore.QByteArray()
    bufferTime = QtCore.QBuffer(byteArray)
    bufferTime.open(QtCore.QIODevice.WriteOnly)
    image.save(bufferTime, extension.upper())

    mimeData.setData(mimeType, selectedImagePath)

    drag = QtGui.QDrag(self)
    drag.setMimeData(mimeData)

    result = drag.start(QtCore.Qt.CopyAction)

    event.accept() 
```

我哪里错了？

我意识到我还需要设置被删除媒体的名称，因此任何有关这方面的指导也将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T23:18:46.570

您可以通过不使用图像 mimetypes 和设置缓冲区来简化此过程。如果您使用网址，这将是一种更通用的方法......

自定义 QLabel 的示例：

```
class Label(QtGui.QLabel):

    ...

    def mousePressEvent(self, event): 

        event.accept()

        selectedImagePath = "/Users/justin/Downloads/smile.png"

        # a pixmap from the label, or could be a custom
        # one to represent the drag preview 
        pixmap = self.pixmap()

        # make sure the thumbnail isn't too big during the drag
        if pixmap.width() > 320 or pixmap.height() > 640:
                pixmap = pixmap.scaledToWidth(128)

        mimeData = QtCore.QMimeData()
        mimeData.setUrls([QtCore.QUrl(selectedImagePath)])

        drag = QtGui.QDrag(self)
        drag.setMimeData(mimeData)
        drag.setPixmap(pixmap)
        # center the hotspot image over the mouse click pos
        drag.setHotSpot(QtCore.QPoint(
            pixmap.width() / 2, 
            pixmap.height() / 2))

        dropAction = drag.exec_(QtCore.Qt.CopyAction, QtCore.Qt.CopyAction) 
```

现在桌面只会解释 url，命名是自动的。享受！

# desire2learn - Desire2Learn SOAP 和 Valence API 中的“组织单位 ID”

> ID：10504364
> 
> 赞同：1
> 
> 时间：2012-05-08T18:32:46.690
> 
> 标签：desire2learn

在 Desire2Learn 中，创建成绩对象时使用的“组织单位 ID”在 SOAP 和 Valence API 中是否具有相同的值？如果不是，那么检索此值以与 Valence API 一起使用的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T12:00:36.133

是的，组织单位 ID 是后端 LMS 用于唯一标识组织单位（部门、课程等）的唯一标识符。在同一个后端服务上，您可以通过旧版 Web 服务 (SOAP) API 和较新的 Valence REST-ful API 使用其组织单位标识符来识别同一个组织单位。

# php - 二维数组 PHP->JSON->jQuery

> ID：10504370
> 
> 赞同：0
> 
> 时间：2012-05-08T18:33:07.650
> 
> 标签：php, jquery, json

我有一个二维数组（ $array = array(array()) ），我通过 json_encode 在 php 中输入，并得到类似...

```
[["209","2008-03-06","Technical Writing 1","009"],["210","2008-03-06","Technical Writing 2","005"]] 
```

当我去使用`$.parseJSON()`这个字符串时，它没有给我任何东西。有什么想法吗？

编辑我的 jQuery 看起来像：

```
 $.ajax({
    type: 'POST',
    url: "stat_fetch.php",
    data: { },
    dataType: 'html',
    success: function(data) {
        $parsed = $.parseJSON(data);
    },
    async: false
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:45:00.797

尝试索引您返回的数据 - 例如

```
$.getJSON("/myprog/php",function (data) { alert(data[0][0]; }); 
```

将从上面的数组示例中弹出一个值为“209”的警报框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:04:47.527

有时`$.parseJSON`不像我预期的那样工作，我过去遇到过这个问题。我认为您可以使用简单的 javascript，但该功能`JSON.parse`也有问题。

阅读以下内容`JSON.parse`：[http ://caniuse.com/json](http://caniuse.com/json)

我建议你使用这样的库： [https ://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

尝试**json2.js**或**json_parse.js**，它们工作得很好并且是跨浏览器。

# python - commands.getstatusoutput 失败说 sh: Syntax error: ";" 意外

> ID：10504371
> 
> 赞同：1
> 
> 时间：2012-05-08T18:33:11.007
> 
> 标签：python

我正在使用 python 命令模块运行 mongoimport 命令

```
status = utilities.execute(mongoimport) 
```

在**实用程序.py**

```
def execute(command):
    if not command:
        return (-1, 'command can not be empty or null')
    return commands.getstatusoutput(command) 
```

当我运行它时，我看到错误为

```
sh: Syntax error: ";" unexpected 
```

我看到[文档](http://docs.python.org/library/commands.html)说：

```
commands.getstatusoutput(cmd)
Execute the string cmd in a shell with os.popen() and return a 2-tuple (status, output). cmd is actually run as { cmd ; } 2>&1, so that the returned output will contain output or error messages 
```

我该如何解决这个问题才能运行这个命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:36:17.533

使用[子流程模块](http://docs.python.org/library/subprocess.htm)

```
from subprocess import check_output
output = check_output(["ls", "-l"]) 
```

如果命令失败，这将引发错误 - 无需检查空字符串。如果您真的确定要通过外壳传递东西，那么像这样调用

```
output = check_output("ls -l", shell=True) 
```

请注意，通过 shell 传递内容是解决安全问题的绝佳媒介。

# c++ - 限制 C++ 变量的范围

> ID：10504373
> 
> 赞同：2
> 
> 时间：2012-05-08T18:33:22.250
> 
> 标签：c++, scope

我有一个具有以下形式的 C++ 程序：

```
int main(){
    int answer;

    ...

    MEMORY_CONSUMING_DATA_ARRAY temp;
    a few operations on the above;
    answer=result of these operations;

    ... //More code
} 
```

也就是说，我有一小段代码似乎并不保证它自己的功能，但它使用了大量的内存。

我想在有限的范围内使内存消耗变量（一个类）存在以产生结果，然后将其销毁。辅助函数可以很容易地做到这一点，但在我工作的场景中它似乎有点过头了。

关于如何做到这一点的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-08T18:35:31.150

如果破坏是你需要的：

```
int main() {
    int answer;

    ...
    { // << added braces
      MEMORY_CONSUMING_DATA_ARRAY temp;
      a few operations on the above;
      answer=result of these operations;
    }
    ... //More code
} 
```

因此这适用于由动态分配支持的集合/对象，例如`std::vector`.

但是对于大堆栈分配......你在编译器的摆布。编译器可能会决定最好在函数返回后清理堆栈，或者它可能会在函数内逐步执行清理。当我说清理时，我指的是您的函数所需的堆栈分配——而不是破坏。

要对此进行扩展：

动态分配的破坏：

```
int main() {
    int answer;
    ...
    { // << added braces
      std::vector<char> temp(BigNumber);
      a few operations on the above;
      answer=result of these operations;
      // temp's destructor is called, and the allocation
      // required for its elements returned
    }
    ... //More code
} 
```

与堆栈分配相比：

```
int main() {
    int answer;
    ...
    {
      char temp[BigNumber];
      a few operations on the above;
      answer=result of these operations;
    }

    // whether the region used by `temp` is reused
    // before the function returns is not specified
    // by the language. it may or may not, depending
    // on the compiler, targeted architecture or
    // optimization level.

    ... //More code
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T18:40:02.180

贾斯汀的回答很好，但如果你一次又一次地执行这个操作，那么你可能想要重用这个内存。

**编辑**

正如所指出的那样，静态会使内存不在堆栈上分配，这可能对您有利，如果您每次都需要将内存归零，如果您每次都复制相同的数量并且不读取，这也是可选的过了这一点，您可以保存对 zeromemory 或其他初始化调用的调用。

```
int main(){
    int answer;

    ...

    {
      static MEMORY_CONSUMING_DATA_ARRAY temp; // make this static or a member perhaps
      temp = 0; // initialise it every time to clear the memory or zeromemory or other op
      a few operations on the above;
      answer=result of these operations;
    }
    ... //More code
} 
```

# java - 使用 Objectify 在 Appengine 上批量存储父/子

> ID：10504374
> 
> 赞同：0
> 
> 时间：2012-05-08T18:33:24.547
> 
> 标签：java, google-app-engine, objectify

我想批量存储 2 个新实体。但是，一个实体是另一个实体的父实体。如果我在子对象中有一个字段，如下所示：

@Parent 私钥父

如果尚未存储父对象（因此还没有键），我如何在子对象中填写此字段的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T02:25:13.260

提前分配parent的id。然后，您可以将父项和子项（使用父键引用）保存在一个批次中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T22:18:02.120

哟不能那样做（作为一批）。

如果您的问题更关心数据完整性，那么您可以使用事务。例子：

```
from google.appengine.ext import db
from app.models import ParentModel, ChildModel

class ARequestHandler(BaseHandler):
    def get(self):
        def create_parent_and_child():
            parent_entity = ParentModel(...)
            parent_entity.put()

            child_entity = ChildModel(Parent=parent_entity, ...)
            child_entity.put()

        db.run_in_transaction(create_parent_and_child) 
```

# visual-studio - 在 VisualStudio 中添加和删除文件 - 编译错误

> ID：10504377
> 
> 赞同：2
> 
> 时间：2012-05-08T18:33:34.973
> 
> 标签：visual-studio, visual-studio-2010, qt, cmake

我的主要问题是：我从 ProjectMappen-Explorer（项目资源管理器）中删除了文件，然后再次添加它们。现在项目不再编译，我不知道为什么。

我怎样才能让它再次编译？

该项目是由 cmake 生成的，这也是一些很大的开销。

并且：我想自己添加文件，这会导致同样的问题。所以重新生成是没有用的。

谢谢您的帮助！

### 错误 1

```
Fehler  1   error MSB3073: Der Befehl "setlocal
"C:\Program Files (x86)\CMake 2.8\bin\ctest.exe" --force-new-ctest-process -C Debug
if %errorlevel% neq 0 goto :cmEnd
:cmEnd
endlocal & call :cmErrorLevel %errorlevel% & goto :cmDone
:cmErrorLevel
exit /b %1
:cmDone
if %errorlevel% neq 0 goto :VCEnd
:VCEnd" wurde mit dem Code 8 beendet.   C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppCommon.targets   113 6   RUN_TESTS 
```

### 错误 3

```
Fehler  3   error LNK2019: Verweis auf nicht aufgelöstes externes Symbol ""public: bool __cdecl SolidMesh::PointInPolygonAlgorithm::pointInPolygon(class osg::Vec3f)" (?pointInPolygon@PointInPolygonAlgorithm@SolidMesh@@QEAA_NVVec3f@osg@@@Z)" in Funktion ""public: static bool __cdecl DomAdapter::PointInPolygon(class osg::Vec3f const &,class osg::ref_ptr<class osg::TemplateArray<class osg::Vec3f,10,3,5126> > const &)" (?PointInPolygon@DomAdapter@@SA_NAEBVVec3f@osg@@AEBV?$ref_ptr@V?$TemplateArray@VVec3f@osg@@$09$02$0BEAG@@osg@@@3@@Z)".   C:\Users\wollknaeul\Documents\HPI\algorithmische geometrie\algogeometrie\trunk\build\algorithmtest\PointInPolygonTest.obj   test_Algorithm 
```

### 错误 4

```
Fehler  2   error MSB6006: "cmd.exe" wurde mit dem Code 9009 beendet.   C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppCommon.targets   151 6   run 
```

### 回答问题

```
in>"C:\Program Files (x86)\CMake 2.8\bin\ctest.exe" --force-new-ctest-process -C
 Debug
Test project C:/Users/wollknaeul/Documents/HPI/algorithmische geometrie/algogeom
etrie/trunk/bin
    Start 1: test_Algorithm
Could not find executable test_Algorithm
Looked in the following places:
test_Algorithm
test_Algorithm.exe
Debug/test_Algorithm
Debug/test_Algorithm.exe
Debug/test_Algorithm
Debug/test_Algorithm.exe
Unable to find executable: test_Algorithm
1/1 Test #1: test_Algorithm ...................***Not Run   0.00 sec

0% tests passed, 1 tests failed out of 1

Total Test time (real) =   0.11 sec

The following tests FAILED:
          1 - test_Algorithm (Not Run)
Errors while running CTest 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-19T16:32:09.060

以管理员权限运行 Visual Studio。错误基本上是 CMake 无法访问 C:/Program Files (x86) 目录来创建/添加必要的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:43:58.097

## 解决方案

右键单击*Project* -> *Rebuild* or *Build again*。《新厄斯特伦》

* * *

**错误 1**

您的第一个错误是 MSB3073，听起来像是构建前或构建后问题，特别是在构建前或构建后事件上运行的脚本的某种错误。

（通过 translate.google.com 从德语翻译）：

> 命令 "setlocal "C:\Program Files (x86)\CMake 2.8\bin\ctest.exe" --force-new-ctest-process -C Debug if %errorlevel% neq 0 goto :cmEnd :cmEnd endlocal & call : cmErrorLevel %errorlevel% & goto :cmDone :cmErrorLevel exit /b %1 :cmDone if %errorlevel% neq 0 goto :VCEnd :VCEnd" exited with Code 8\. C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4 .0\Microsoft.CppCommon.targets 113 6 RUN_TESTS

你能从批处理文件中运行这些脚本吗？

**错误 3 (2?)**

您的第二个（第三个？）错误是 [LNK2019](http://msdn.microsoft.com/en-us/library/799kze2z%28v=vs.100%29.aspx)

**错误 4**

谷歌有一堆关于你最后一个错误[MSB6006的东西](https://encrypted.google.com/search?hl=en&q=MSB6006)

# ruby-on-rails - RoR Capistano 部署：迁移未初始化的常量

> ID：10504378
> 
> 赞同：0
> 
> 时间：2012-05-08T18:33:40.077
> 
> 标签：ruby-on-rails, capistrano

我在 EC2 上运行 Ubuntu 并使用 Capistrano 部署我的应用程序。Capistrano 不允许我运行“rake db:schema:load”，所以我使用 rails 创建了一个名为 CreateTables 的新迁移。然后我从 schema.rb 复制了 create_tables 并运行“cap deploy:migrate”。

但是，我收到此错误：未初始化的常量 CreateTables

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T14:51:41.130

出于某种原因，当我尝试 $ cap deploy:cold 时，我能够获得通过迁移创建的表。

# c++ - 未找到 ld 符号

> ID：10504379
> 
> 赞同：1
> 
> 时间：2012-05-08T18:33:44.340
> 
> 标签：c++, compiler-construction, linker

环顾四周，发现了一些类似的问题，但没有一个是相同的。大多数与构造函数或析构函数有关。这个问题很可能是由于我生锈的 C++ 链接器内存（几年后将其恢复）造成的。

我会保持简单，因为这可能是对链接器的基本误解：

数据.h

```
#pragma once

namespace test {
   class Data_V1 {
   public:
      // some getters/setters
      int getData() { return _d; }
      void setData( int d ) { _d = d; }
   private:
      // some data
      int _d;
   };
} 
```

建造者.h

```
#pragma once

namespace test {
   template <class V>
   class Builder {
   public:
      void build();
   };
} 
```

建造者.cpp

```
#include <iostream>
#include "builder.h"

namespace test {
   template<class V>
   void Builder<V>::build() {
      std::cout << "Insert building logic" << std::endl;
   }
} 
```

主文件

```
#include "builder.h"
#include "data.h"

using namespace test;

int main(int argc, char* argv[]) {
    Builder<Data_V1> b;
    b.build();
} 
```

编译：

```
g++ -Wall -ansi -pedantic -c builder.cpp
g++ -Wall -ansi -pedantic -c main.cpp
g++ -Wall -ansi -pedantic -o main main.o builder.o 
```

链接错误：

```
Undefined symbols for architecture x86_64:
   "test::Builder<test::Data_V1>::build()", referenced from: 
       _main in main.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T18:36:41.360

模板定义需要对所有翻译单元可见。将定义从 移动`cpp`到标题。

生成器.h

```
#pragma once

namespace test {
   template <class V>
   class Builder {
   public:
      void build();
   };

   template<class V>
   void Builder<V>::build() {
      std::cout << "Insert building logic" << std::endl;
   }
} 
```

在你问之前，不，除非你事先知道所有可能的专业化，否则没有办法隐藏实现。

模板代表了创建新类的通用形式。如果实现不可见，当您尝试专门化模板时，编译器无法知道要生成什么代码。

# android - Android ListActivity 新意图问题（添加空间）

> ID：10504384
> 
> 赞同：0
> 
> 时间：2012-05-08T18:34:26.497
> 
> 标签：android, android-intent, android-manifest

当数组中有空格时如何打开新意图（例如“Hello World”）我试图访问的类称为startingPoint。

它给了我一个错误，因为 -> android:name="" 中不能有任何空格

有什么解决方法吗？

提前致谢

根.java

```
public class Root extends ListActivity {

String classes[] = { "Hello World", "Another Item", "Email"};

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    setListAdapter(new ArrayAdapter<String>(Root.this,
            R.layout.root, classes));
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    // TODO Auto-generated method stub
    super.onListItemClick(l, v, position, id);
    String MENU_CHOICE = classes[position];
    try {
        Class ourClass = Class.forName("se.hello.visboken." + MENU_CHOICE);
        Intent ourIntent = new Intent(Root.this, ourClass);
        startActivity(ourIntent);
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }
}
} 
```

我的清单看起来像这样

```
 <activity
        android:name=".Splash"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Root"
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="se.hello.visboken.ROOT" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".startingPoint"
        android:label="Hello World" >
        <intent-filter>
            <action android:name="se.hello.visboken.startingPoint" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:37:27.117

在您的情况下，您需要启动的 Activity 是`startingPoint`，**而不是** `Hello World`。*Hello World*是该活动的标题。

* * *

**更新：**

创建另一个相同大小的字符串数组（必须），但其中包含类的名称，而不是标题。

```
String tmp[] = { "startingPoint", "anotherClass1", "anotherClass2"}; 
```

在*onListItemClick*中，阅读如下：

```
String MENU_CHOICE = tmp[position]; 
```

# objective-c - 如何获取多维数组的值

> ID：10504387
> 
> 赞同：0
> 
> 时间：2012-05-08T18:34:36.347
> 
> 标签：objective-c, arrays, multidimensional-array

尝试从数组中检索值时遇到问题。我想从这个数组中获取所有值，以便在 IUTableView 中显示它们。

我应该使用双精度函数吗？

```
{
1 =     {
    dishId = 1;
    dishName = "Tomato Salades";
    dishPrice = 13;
    dishTypeId = 1;
    dishTypeName = Starter;
};
2 =     {
    dishId = 2;
    dishName = "Leeks Salades";
    dishPrice = 12;
    dishTypeId = 1;
    dishTypeName = Starter;
};
3 =     {
    dishId = 3;
    dishName = Fries;
    dishPrice = 14;
    dishTypeId = 2;
    dishTypeName = "Main Course";
};
4 =     {
    dishId = 4;
    dishName = Beef;
    dishPrice = 15;
    dishTypeId = 2;
    dishTypeName = "Main Course";
};
7 =     {
    dishId = 7;
    dishName = "Cheese Cake";
    dishPrice = 8;
    dishTypeId = 3;
    dishTypeName = Dessert;
};
menuCountry = France;
menuDescription = "un menu pas comme les autres pour une region pas comme les autres";
menuId = 1;
menuName = "Autour de l\\Alsace";
menuState = 1;
} 
```

这是我的 Python 代码，它在 Array 中创建一个 Dictionary ：

```
def getDishOfTheWeek():
menuArray = []
menuDic = Ddict(dict)
    for menu in Menus.select().where(state=True):

        menuDic['menuId']=menu.id
        menuDic['menuName']=menu.name
        menuDic['menuCountry']=menu.country.name
        menuDic['menuDescription']=menu.description
        menuDic['menuState']=menu.state
        for d in  DishMenuRels.select().where(menu = menu.id).join(Dishes).join(DishTypes).order_by((DishTypes,'name')):
            menuDic[str(d.dish.id)] = {}
            menuDic[str(d.dish.id)]['dishTypeName'] = d.dish.dishType.name
            menuDic[str(d.dish.id)]['dishTypeId'] = d.dish.dishType.id
            menuDic[str(d.dish.id)]['dishId'] = d.dish.id
            menuDic[str(d.dish.id)]['dishName'] = d.dish.name
            menuDic[str(d.dish.id)]['dishPrice'] = d.dish.price
menuArray.append(menuDic)
return json.dumps(menuArray) 
```

这是我的 Objectiv-C 代码，用于获取 DataJson 并将其放入数组中：

```
- (void)stream:(NSStream *)theStream handleEvent:(NSStreamEvent)streamEvent {

switch (streamEvent) {

    case NSStreamEventOpenCompleted:
        [[ConnectionSingleton getInstance] setConnectionMade:YES];
        NSLog(@"Stream opened");
        break;

    case NSStreamEventHasBytesAvailable:
        if (theStream == inputStream) {

            uint8_t buffer[1024];
            int len;

            while ([inputStream hasBytesAvailable]) {

                len = [inputStream read:buffer maxLength:sizeof(buffer)];

                if (len > 0) {

                    NSString *output = [[NSString alloc] initWithBytes:buffer length:len encoding:NSASCIIStringEncoding];

                    output = [output substringToIndex:[output length] - 2];

                    if (nil != output) {
                        NSError* error;     // Obligatoir pour le JSON

                        menu = [NSJSONSerialization JSONObjectWithData:[output dataUsingEncoding:NSUTF8StringEncoding] options:
                                  NSJSONReadingMutableContainers error:&error];   // Put Json in the Array

                        [[self tableView] reloadData];  // Reload Array to populate it
                    }
                }
            }
        }
        break;      

    case NSStreamEventErrorOccurred:
        NSLog(@"Can not connect to the host!");
        break;

    case NSStreamEventEndEncountered:
        break;

    default:
        NSLog(@"Unknown event");
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:04:33.927

我认为这应该可以解决问题

```
NSArray *firstArray = [NSArray arrayWithObjects:[NSArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",nil], [NSArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",nil],[NSArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",nil],[NSArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",nil],[NSArray arrayWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",nil],@"String",@"String",@"String",@"String",@"String",nil];

NSInteger count_i = firstArray.count;
NSInteger count_j;
id val;
for (NSInteger i = 0; i < count_i; i++) {
    if ([[firstArray objectAtIndex:i] isKindOfClass:[NSArray class]]) {
        count_j = [[firstArray objectAtIndex:i] count];
        for (NSUInteger j = 0; j < count_j; j++) {
            val = [[firstArray objectAtIndex:i] objectAtIndex:j]; 
            NSLog(@"%@",val);
        }
    }else{
        val = [firstArray objectAtIndex:i];
        NSLog(@"%@",val);
    }
} 
```

但是你的值是不同类型的，所以你必须根据 j 的值以不同的方式处理它们。

# wcf - WCF REST 服务中的异常处理程序

> ID：10504388
> 
> 赞同：0
> 
> 时间：2012-05-08T18:34:37.787
> 
> 标签：wcf, rest, c#-4.0

我想在 WCF REST 服务中创建一个异常处理程序。对于客户端以简单的方式隐藏此异常。我发现许多使用 SOAP IErrorHandler 的 WCF 实现，但没有一个用于 REST。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:39:14.527

异常信息在响应消息中提供。通常（在用于 REST 的 HTTP GET 中），结果应为 XML/JSON。如果出现任何错误，则错误消息是位置而不是 REST URI 结果。

[http://www.robbagby.com/rest/effective-error-handling-with-wcf-rest/](http://www.robbagby.com/rest/effective-error-handling-with-wcf-rest/)

[WCF 休息错误处理](https://stackoverflow.com/questions/5626334/wcf-rest-error-handling)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:41:02.430

您是否尝试使用[WebFaultException](http://msdn.microsoft.com/en-us/library/dd989924.aspx)？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T21:20:33.207

`IErrorHandler`也适用于 WCF REST 服务，尽管您可能需要了解如何在 WCF`Message`对象内映射非 SOAP（例如 JSON）消息。[http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/07/wcf-extensibility-ierrorhandler.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/07/wcf-extensibility-ierrorhandler.aspx)中的示例显示了一个错误处理程序，用于格式化对 JS 客户端的响应（以 JSON 格式）。

# django - Django 对 web/http 缓存的默认行为

> ID：10504392
> 
> 赞同：1
> 
> 时间：2012-05-08T18:35:21.363
> 
> 标签：django, http-caching

我的问题是指django 文档的[这一部分](https://docs.djangoproject.com/en/dev/topics/cache/#upstream-caches)。

其中，有一段文字如下：

> 请注意，缓存中间件已经使用 CACHE_MIDDLEWARE_SECONDS 设置的值设置了缓存标头的 max-age。如果您在 cache_control 装饰器中使用自定义 max_age，则装饰器将优先，并且标头值将正确合并。

我的解释是，默认情况下，来自 django 服务器端的响应在其 http 标头部分中会包含“Cache-Control:max-age=600”，除非使用一些与 http-cache 相关的装饰器来修改“Cache-Control” “标题。

我做了一个快速实验来验证我上面的解释。令人惊讶的是，当视图上没有使用与 http-cache 相关的内容时，生成的响应根本**没有“Cache-Control”标头**。

为什么我看到的结果与官方文档描述的不同？我误解了概述的段落吗？

此外，当响应中没有“Cache-Control”标头时，我可以安全地假设不涉及 http 缓存（即不会使用缓存响应）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:28:39.723

这不会“默认”发生。Django 附加标头必须满足两个条件`Cache-Control`：

1.  您必须使用`CACHES`(Django 1.3+) 或`BACKEND`(Django <1.3) 设置缓存后端。

2.  您必须将缓存中间件添加到`MIDDLEWARE_CLASSES`.

有关详细信息，请参阅[文档](https://docs.djangoproject.com/en/dev/topics/cache/)。

至于在没有`Cache-Control`标头的情况下进行缓存，这通常成为 Web 浏览器或客户端的决定。`Cache-Control`给出了*必须*遵循的指令，但浏览器通常已经自行缓存，因此它的真正目的通常是在某些情况下*防止*缓存，而不是启用它。

# c# - 将带有描述和操作链接的视频文件上传到 Facebook

> ID：10504394
> 
> 赞同：1
> 
> 时间：2012-05-08T18:35:31.633
> 
> 标签：c#, facebook, video, upload

在 C# 中，我使用以下方法将视频文件从服务器上传到 Facebook：

```
 string fullurl = "https://graph-video.facebook.com/me/videos?" + "title=" + title + "&access_token=" + accessToken;
        WebClient client = new WebClient();
        byte[] returnBytes = client.UploadFile(fullurl, path); 
```

path 是服务器上视频文件的路径。这有效，并在用户个人资料上显示上传的视频帖子。如何向该帖子添加文本描述（带链接）和操作链接？

请保留 C# 中的答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:11:32.180

您应该通过嵌入的 URL传递额外的查询字符串参数 -**描述。**像这样的东西：

```
var description = "Bring your conversations to life on Facebook. With face-to-face video calling, now you can watch your friends smile, wink and LOL.\n\nTo get started, visit http://www.facebook.com/videocalling"; 

string fullurl = string.Format("https://graph-video.facebook.com/me/videos?title={0}&description={1}&access_token={2}", HttpUtility.UrlEncode(title), HttpUtility.UrlEncode(description ), accessToken); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-05T07:31:18.987

我做的。以下是我的代码：

```
string a = "User_Access_Token";
string fullurl = string.Format("https://graph-video.facebook.com/me/videos?title={0}&description={1}&access_token={2}", HttpUtility.UrlEncode("Dulha"), HttpUtility.UrlEncode("hello"), a);
WebClient client = new WebClient();
byte[] returnBytes = client.UploadFile(fullurl, @"C:\Users\Users\Downloads\Dulha.mp4"); 
```

# tridion - 跨环境导出和导入安全权限的最佳方式是什么？

> ID：10504396
> 
> 赞同：6
> 
> 时间：2012-05-08T18:35:32.377
> 
> 标签：tridion

我们有大量的出版物，目前我们在多个环境（主要是 UAT 和 PROD）中手动应用 CMS 权限。这是乏味的，而且经常容易出错。

我们正在尝试跨多个环境导出和导入 CMS 权限，因此可以手动完成一次并使用某种工具移植到其他环境。

环境：Tridion 2011 SP1 + IIS 7.5 + SQL Server 2008 r2

在旧的 PowerTools (VBScript) 中曾经有一些工具来管理访问管理，它可能很方便，但仍然容易出错。出于显而易见的原因，我们对使用 OLD powertools 不感兴趣，它是重复操作功能，因此也排除了 DB 选项。

我们正在考虑使用核心服务构建一个可以导出和导入权限的工具。我们在这些环境中具有相同的组、出版物和文件夹结构。

有没有人试过这个？其他 Tridioneers 在大型实施中使用的经验或做法是什么？

非常感谢任何观点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T19:33:11.857

我曾经写过一个工具，允许您将所需的权限设置描述为 JSON，并通过 API 应用它们。老实说，如果您要编写一个 DTAP 安全工具，我会采用类似的方法。首先能够以开放的、基于文本的格式表达您想要的设置，然后编写一个导入它们的工具。一旦你有了这个，你就可以轻松地构建一个导出它们的工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T07:14:39.767

I created a security migration tool in Tridion 5.2 but the solution approach will still apply to current versions of Tridion

**Summary**

The solution used a set of simple vbscript export page templates to extract the security information as xml and store it in a set of components.

I then used Tridion Content Porter to move these security components, page templates and tbbs's to the target CMS's

Using set of simple import page templates to open the security xml components to apply the security setting to the target cms.

The tcmid's will be different in the target cms so the import functions must use webdav urls and build dictionaries of tcmid's for trustees etc

**Details**

**Export Security Groups**

*   iterate selected Groups

*   append group xml

*   save xml in component

**Export Publication Rights**

*   getlistpublications

*   iterate list of publications

*   get each publication xml

*   remove "//tcm:CategoriesXSD" node

*   appendChild publication xml

*   remove unwanted "//tcm:Trustee" nodes

*   save xml in component

**Export Folder Permissions**

*   recursively iterate folders

*   append Folder XML

*   remove trustee nodes that are inherited ("IsInheritanceRoot")

*   save xml in component

**Export Structure Group Permissions**

*   recursively iterate Structure groups

*   append structure group XML

*   remove metadata node "//tcm:Metadata"

*   filter out unwanted Trustees

*   save xml in component

**Import Security Groups**

*   load xml from security component

*   iterate group nodes

*   create groups if they don't already exist

**Import Publication rights**

*   load xml from security component

*   update xml tcmid's

*   iterate publications

*   load publication xml

*   build xml updategram

*   update publication xml

**Import Folder Permissions**

*   load xml from security component

*   update xml tcmid's

*   for each folder node

*   build updategram xml

*   open folder

*   update folder xml

**Import Structure Group Permissions**

*   load xml from security component

*   update xml tcmid's

*   for each structure group node

*   build updategram xml

*   open structure group

*   update structure group

# java - 提取字符串

> ID：10504399
> 
> 赞同：0
> 
> 时间：2012-05-08T18:35:37.353
> 
> 标签：java, regex

`Mfr Part#: MBRB1045G Technologie ...`我有一个总是像or一样构建的字符串`Mfr Part#: MBRB1545CTT4G Mounting`，所以总是`Mfr Part#:`有`partnumber`我想要提取的，然后它后面跟着或者`Technologie`其他`Mounting`字符。

您将如何从中提取该零件编号`MBRB1045G`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:43:05.900

这应该可以解决问题：

```
 final Pattern pattern = Pattern
            .compile("Mfr Part#: ([^ ]+) (Technologie|Mounting).*");
    final Matcher matcher = pattern
            .matcher("Mfr Part#: MBRB1045G Mounting");
    matcher.matches();
    System.out.println(matcher.group(1)); 
```

但是，如果检查字符串是否具有特定模式对您来说并不重要，您也可以使用更简单的表达式：`Mfr Part#: ([^ ]+) .*`

另请注意，您可以存储模式对象并将其重用于后续使用。这会给你更好的表现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:45:57.817

可能带有分组的正则表达式是最好的。（谷歌perlre）

```
String input = "Mfr Part#: MBRB1045G Technologie";
String regexpression = "Mfr Part#: (\\w+) (\\w+)";
Pattern p = Pattern.compile(regexpression);
Matcher m = p.matcher(input);
if (m.matches()) {
    String part = m.group(1);
    String desc = m.group(2);

    System.out.println(part);
    System.out.println(desc);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:46:13.760

我看到了两种方法（可能还有其他方法）：正则表达式和组，或 indexOf 和子字符串

1) 正则表达式和组

```
String input = "Mfr Part#: MBRB1045G Technologie";
Pattern p = Patter.compile("Mfr Part#: ([A-Z0-9]+) (Technologie|Mounting)");
Matcher m = p.matcher(input);
while(m.find()) {
    System.err.println("Part number: "+m.group(1)+ "Second part is "+m.group(2);
} 
```

2) indexOf 和子字符串

```
String prefix = "Mfr Part#: ";
String input = "Mfr Part#: MBRB1045G Technologie";
for (int i=  0;i<input.length();i++) {
    int index1 = input.indexOf(prefix);
    int index2 = index1+prefix.length();
    int index3 = input.indexOf(" ", );
    int index4 = input.indexOf(" ", index3+1);
    System.err.println("Part number: "+input.substring(index2, index3)
          + "Second part is "+input.substring(index3, index4);
    index = index4;

} 
```

警告：我没有运行它，所以你可能需要修正错别字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T18:45:10.680

我可能会使用`java.util.Scanner`. 这可能不是这样做的最佳方式，但在我看来是最舒服的。
它会这样工作：

```
import java.util.Scaner;

String s = "Mfr Part#: MBRB1045G Technologie RZ137GA";
Scanner scn = new Scanner(s);
scn.next();
scn.next();
String partnumber = scn.next();
scn.next();
String technologie = scn.next();
scn.close(); 
```

该变量`partnumber`将包含`MBRB1045G`和`technologie`包含`RZ137GA`。

# c++ - 为什么 GetSystemTimes #if'd 不在 winbase.h 中？

> ID：10504402
> 
> 赞同：1
> 
> 时间：2012-05-08T18:35:43.043
> 
> 标签：c++, c, winapi

所以，in 的声明`GetSystemTimes`（`winbase.h`在我的机器上，Windows 7 VS2005）

```
#if _WIN32_WINNT >= 0x0501

BOOL
WINAPI
GetSystemTimes(
    __out_opt LPFILETIME lpIdleTime,
    __out_opt LPFILETIME lpKernelTime,
    __out_opt LPFILETIME lpUserTime
    );

#endif 
```

当然，我可以`#define _WIN32_WINNT 0x0501`，但这似乎不对，我找不到解释为什么会这样以及我的替代方案是什么。有人在这里有一些见解吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T18:49:16.783

它`#if`被淘汰是因为它直到 Windows NT v5.01，AKA Windows XP 才被添加到 API 中。您的程序应将`#define`符号`_WIN32_WINNT`转换为您的最低目标 Windows 版本的十六进制值：请参阅[使用 Windows 标头](http://msdn.microsoft.com/en-us/library/aa383745%28v=vs.85%29.aspx)。

如果您不定义`_WIN32_WINNT`，则假定您针对的是最低公分母，并且它不提供更新的 API 功能。因此，如果您想使用它们，您需要定义`_WIN32_WINNT`一个适当的值并了解您的代码不会在旧版本的 Windows 上运行，这通常很好——没有人会抱怨您的代码不能在 Windows 上运行98.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T18:44:30.953

根据[MSDN 文档，](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383745%28v=vs.85%29.aspx#setting_winver_or__win32_winnt)您提到的可能性是预期用途。尽管我同意您的看法，这看起来很奇怪，但这种处理方式可以让您构建针对具有不同最低操作系统版本的平台的项目，因此当目标计算机上没有 Windows API 功能时，您不会感到惊讶。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-25T08:38:04.650

`GetSystemTimes()`宣布于`Winbase.h`

```
#if _WIN32_WINNT >= 0x0501           // look at this

BOOL
WINAPI
GetSystemTimes(
    LPFILETIME lpIdleTime,
    LPFILETIME lpKernelTime,
    LPFILETIME lpUserTime
    );

#endif // (_WIN32_WINNT >= 0x0501) 
```

像这样使用包含：

```
#define _WIN32_WINNT 0x0501
#include <Windows.h> 
```

# ruby-on-rails - class.save 错误 ruby on rails

> ID：10504408
> 
> 赞同：1
> 
> 时间：2012-05-08T18:36:10.313
> 
> 标签：ruby-on-rails, ruby, macos, console, save

我正在按照 Sitepoint 的 Patrick Lenz 的书学习 ruby​​ on rails。我知道它有点过时了，所以我正在适应。

我已经到了一个地方，我在我的 rails 控制台中，准备开始创建/保存到我的数据库，当我创建一个类时，然后输入 story.save，我收到了这个错误：

```
1.9.3p194 :007 > story.save
   (0.1ms)  begin transaction
  SQL (0.5ms)  INSERT INTO "stories" ("link", "name") VALUES (?, ?)  [["link", nil], ["name", nil]]
SQLite3::ConstraintException: constraint failed: INSERT INTO "stories" ("link", "name") VALUES (?, ?)
   (0.1ms)  rollback transaction
ActiveRecord::StatementInvalid: SQLite3::ConstraintException: constraint failed: INSERT INTO "stories" ("link", "name") VALUES (?, ?)
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6/lib/sqlite3/statement.rb:108:in `step'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6/lib/sqlite3/statement.rb:108:in `block in each'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6/lib/sqlite3/statement.rb:107:in `loop'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6/lib/sqlite3/statement.rb:107:in `each'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/sqlite_adapter.rb:263:in `to_a'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/sqlite_adapter.rb:263:in `block in exec_query'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/sqlite_adapter.rb:242:in `exec_query'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/database_statements.rb:63:in `exec_insert'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/database_statements.rb:90:in `insert'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/query_cache.rb:14:in `insert'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/relation.rb:66:in `insert'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/persistence.rb:363:in `create'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/timestamp.rb:57:in `create'
... 14 levels...
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/validations.rb:50:in `save'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/attribute_methods/dirty.rb:22:in `save'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:241:in `block (2 levels) in save'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:208:in `transaction'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:241:in `block in save'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.3/lib/active_record/transactions.rb:240:in `save'
    from (irb):7
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
    from /Users/ideogram/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'1.9.3p194 :008 > 
```

我不知道这是什么意思。有任何想法吗？非常感谢您的帮助。:)

我在 Macbook Pro OSX Lion 10.7.3、Ruby 1.9.3-194、Rails 3.2.3 上运行。已经安装了 homebrew、rvm，然后是几个包，包括 readlines、sqlite3 和 git。

谢谢你！

附录：这是我的架构：

```
ActiveRecord::Schema.define(:version => 0) do

  create_table "stories", :force => true do |t|
    t.string "name"
    t.string "link"
  end

  add_index "stories", ["id"], :name => "sqlite_autoindex_stories_1", :unique => true

end 
```

这是我用来创建表的 sqlite 命令：

```
CREATE TABLE `stories` (
  `id` int(11) NOT NULL,
  `name` varchar(255) default NULL,
  `link` varchar(255) default NULL,
  PRIMARY KEY (`id`)
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T07:40:59.417

非常感谢大家帮助我。

在您的评论之间，我发现了问题所在。问题出在我的数据库中——它没有正确创建，所以一旦我删除了原始文件，然后再次重新编译文件（确保我所有的逗号都在正确的位置），它终于起作用了！

感谢您的所有帮助，所以再次感谢您。我从你的回答中学到了很多。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:10:49.950

从您的架构的外观来看，您没有`stories`表。~~Patrick Lenz 教程使用 MySQL 作为数据库，但您使用的是 SQLite3。~~（我在看他的一篇旧文章。看来他在 2011 年更新了这篇文章）因为你有一个模式文件，我猜你正在使用迁移文件来生成你的数据库表。如果是这样，您的`link`and`name`字段将默认为`:null => true`，因此对持有`nil`值没有疑虑。

`rake db:migrate`为您的表创建迁移文件后，您是否可能忘记了`stories`？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:44:07.500

Nil 值是问题——如果你需要允许 nil，你可以在迁移中改变它。

很多方法可以从控制台验证详细信息

```
> story.valid?
> story.errors (after a save) 
```

等等等等

迁移（或您的 db/schema.rb）也会有所帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:08:12.320

故事表不在您的迁移中。也许您是手动（sql）创建的，没有空约束。由于 Rails 对这些约束一无所知，因此它会从您的数据库中引发错误

# django - Django 从 django.contrib.auth.models 用户获取 foreignId 的值

> ID：10504410
> 
> 赞同：0
> 
> 时间：2012-05-08T18:36:33.953
> 
> 标签：django, django-models

我创建了一个具有模型外键的`django.contrib.auth.models` `User`模型。我需要检索外键所指的值。但是怎么做呢？

例如我的模型是

```
from django.contrib.auth.models import User
def FooModel(models.Model):
      user = models.ForeignKey(User) 
```

然后我知道我可以使用：

`FooModel.objects.get()`或者`FooModel.objects.filter()`但据我所知，他们只会从 FooModel 返回条目。那么如何从`User`模型中检索呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:43:02.487

```
m = FooModel.objects.get(id=123434)
m.user.username 
```

您可以使用`.`.that wxample 将返回相关用户的用户名。您也可以在查询过滤上创建`joins`使用。`__`喜欢：

```
FooModel.objects.get(user__username='Foo') 
```

但是，由于您是在 上构建查询`FooModel`，因此您总会得到`FooModel`结果。因此，您可以`.`使用外键关系来获取所需的`User`字段。

编辑：

Django 还允许您在查询集上使用`reverse relations`，因此即使`User`模型在其模型结构上没有外键`FooModel`，您也可以使用外键的反向关系，`Foomodel.user`例如：

```
def FooModel(models.Model):
    user = models.ForeignKey(User)
    foofield = Models.CharField(...)

User.objects.get(foomodel__foofield='Beatles') 
```

将向您返回具有`FooModel`外键记录的用户，该用户的记录和*披头士乐队*`User`的 foofield 值

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:38:55.720

您可以通过引用属性名称 + 来访问外键 ID `_id`。例如：`yourmodel.user_id`*

# google-chrome - 有没有办法自动生成har文件？

> ID：10504414
> 
> 赞同：7
> 
> 时间：2012-05-08T18:36:46.887
> 
> 标签：google-chrome, page-load-time, har

我正在尝试自动化页面加载时间测试。我想象每隔几个小时运行一次 cron 作业，它将从我的网站加载各种页面，检索相关的 har 文件并处理数据。我不知道的部分是如何以编程方式生成 har 文件......我现在知道的唯一方法是通过 chrome 开发人员工具手动进行。有谁知道这是否可以做到，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-08T17:09:15.287

我们最近刚刚用 Firebug 和 NetExport 做到了这一点：

[http://www.softwareishard.com/blog/netexport/](http://www.softwareishard.com/blog/netexport/)

您可以将 NetExport 配置为自动将 HAR 文件导出到指定目录（压缩可选）。这对我们获取特定 Web 应用程序的资源加载数据样本很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T21:30:47.540

查看[BrowserMob 代理](http://opensource.webmetrics.com/browsermob-proxy/)或运行 WebPageTest 的私有实例并使用 WPT Monitor

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-08T12:38:58.877

PhantomJS（Node.js 上的无头 Webkit 浏览器）可以直接[导出 .har 文件](http://phantomjs.org/network-monitoring.html)。

这样，您应该能够构建一个返回给定 URL 的 .har 文件的工具......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-12T17:23:45.183

在您选择的语言绑定（java、python、c#）中使用 Selenium Server、Browsermob-Proxy 和 Chromedriver（如果您希望使用 Chrome 进行测试）的组合是以编程方式生成 HAR 文件的最佳方式，恕我直言.

我编写[了这个](https://github.com/parasdahal/speedprofile)小 Python 工具，它使用 Browsermob 代理使用 Chrome 或 Firefox 无头生成 HAR 文件。它还生成 NavigationTimingAPI 数据，让您可以了解页面加载时间的微小细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-25T16:46:43.940

如果您无法按照 Davies 先生的建议运行自己的实例，您可以使用 REST API。

Marcel Duran 为 nodejs 编写了一个 WebPageTest API 包装器。它可以从结果测试中返回 HAR。[https://github.com/marcelduran/webpagetest-api](https://github.com/marcelduran/webpagetest-api)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-21T18:16:41.263

har 文件阅读器 API 也可用，它将帮助您解析 har 文件，基本上是 JSON 格式。

您还可以获取每个 http/https 请求/响应等的详细信息，以准备指标。

# macos - CMake 项目使用本地 g++ 版本

> ID：10504419
> 
> 赞同：3
> 
> 时间：2012-05-08T18:37:01.500
> 
> 标签：macos, g++, cmake

我正在使用带有 XCode 4.2.1 的 MacOS X Lion。我需要 gcc 2.4.6。编译一个 CMake 项目。因此我构建了 gcc 2.4.6。在我自己的本地目录`$HOME/mygcc/bin`中。有没有办法影响 CMake 使用的编译器的路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T18:39:49.557

您可以使用 GUI 设置这些变量：

```
CMAKE_C_COMPILER=$HOME/mygcc/bingcc
CMAKE_CXX_COMPILER=$HOME/mygcc/bing++ 
```

或者您可以从命令行运行`cmake`：

```
cmake ../path/to/source -DCMAKE_C_COMPILER=$HOME/mygcc/bin/gcc -DCMAKE_CXX_COMPILER=$HOME/mygcc/bin/g++ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:40:29.910

您可以`$PATH`在运行之前将本地 gcc bin 目录设置为`cmake`：

```
$ export PATH=$HOME/mygcc/bin:$PATH
$ cmake 
```

# c++ - 多次调用动态分配数组的函数时出现 malloc 错误？

> ID：10504421
> 
> 赞同：1
> 
> 时间：2012-05-08T18:37:13.473
> 
> 标签：c++, arrays, heap-memory

我有一个生成价格格子的函数和一个使用该格子为相关选项定价的函数。该`generate_lattice`函数为数组动态分配空间，并返回指向该数组的指针。这个指针就是传递给`price_from_tree`. 这是代码：

```
#include <iostream>
#include <math.h>

using std::cout;
using std::endl;
using std::max;
using std::nothrow;

double* generate_lattice(double asset_price, double u, double d, int periods)
{
    int nodes = (periods * (periods + 1)) / 2; //Number of nodes = sum(1, # of periods)
    double * lattice; 

    lattice = new (nothrow) double[nodes]; 
    double up, down;
    int price_index = 0;
    for (int period = 0; period < periods + 1; period++) {
        for (int exp = 0; exp < period + 1; exp++) {
            up = pow(1 + u, exp);
            down = pow(1 - d, period - exp);
            lattice[price_index] = asset_price * up * down;
            price_index++;
        }
    }
    return lattice;
}

double price_from_tree(double* lattice, int periods, double strike, double risk_free, double period_len_years, bool euro = true, bool call = true)
{
    int num_prices = ((periods + 1) * (periods + 2)) / 2;
    double asset_max = lattice[num_prices - 1];
    double asset_min = lattice[num_prices - (periods + 1)];
    double asset_t0 = lattice[0];
    double u = pow(asset_max / asset_t0, pow(periods, -1));
    double d = pow(asset_min / asset_t0, pow(periods, -1));
    double p = (exp(risk_free * period_len_years) - d) / (u - d);
    double p_minus1 = 1 - p;
    int start_node;
    if (euro == true) { start_node = num_prices - periods - 1; }
    else { start_node = 0; }
    int sign;
    if (call == true) { sign = 1; }
    else { sign = -1; }
    for (int node = start_node; node < num_prices; node++) {
        lattice[node] = max(sign * (lattice[node] - strike), 0.0);
    }
    int price_index = num_prices - 1;
    double pv_mult = exp(-risk_free * period_len_years);
    double down_payoff, up_payoff, prev_payoff;
    for (int period = periods + 1; period > 0; period--) {
        for (int node = 0; node < period - 1; node++) {
            down_payoff = lattice[price_index - (node + 1)];
            up_payoff = lattice[price_index - node];
            prev_payoff = pv_mult * (p * up_payoff + p_minus1 * down_payoff);
            if (euro == false) {
                prev_payoff = max(lattice[price_index - (node + 1) - (period - 1)], prev_payoff);
            }
            lattice[price_index - (node + 1) - (period - 1)] = prev_payoff;
        }
        price_index -= period;
    }
    return lattice[0];
}

int main(int argc, char** argv)
{
    double* lattice = generate_lattice(100, 0.10, 0.10, 2);
    double option1 = price_from_tree(lattice, 2, 105, 0.05, 1, true, true);
    cout<<"option 1: "<<option1<<endl;
    double* lattice2 = generate_lattice(100, 0.10, 0.10, 2);
    return 0;
} 
```

当我运行代码时，我得到这个输出：

> 选项 1: 8.28214 测试: malloc.c:3096: sYSMALLOc: Assertion `(old_top == (((mbinptr) (((char *) &((av)->bins[((1) - 1) * 2]) )) - __builtin_offsetof (struct malloc_chunk, fd)))) && old_size == 0) || ((unsigned long) (old_size)
> 
> > = (unsigned long)((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))+((2 * (sizeof(size_t))) - 1)) & ~((2 * (sizeof(size_t))) - 1)) ) && ((old_top)->size & 0x1) && ((unsigned long)old_end & pagemask) == 0)' 失败。中止
> 
> ```
> ------------------
> (program exited with code: 134) 
> ```

我可以在错误 134 上找到的所有描述都是`The job is killed with an abort signal.`按照代码返回正确的值`price_from_tree`在我尝试过的每种情况下，但是如果我包含对它的多次调用，`generate_lattice`则会失败并显示所述错误。我的`price_from_tree`函数是否存在导致内存混乱的问题？在这种情况下我最好使用向量吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:48:39.827

你正在严重破坏你的堆。如果您使用 valgrind（假设您在 Linux 机器上）运行，则会出现大量错误。

```
==23357== Invalid write of size 8
==23357==    at 0x400B9E: generate_lattice(double, double, double, int) (so.cpp:21)
==23357==    by 0x400FC4: main (so.cpp:68)
==23357==  Address 0x595b058 is 0 bytes after a block of size 24 alloc'd
==23357==    at 0x4C27FFB: operator new[](unsigned long, std::nothrow_t const&) (vg_replace_malloc.c:325)
==23357==    by 0x400B1A: generate_lattice(double, double, double, int) (so.cpp:14)
==23357==    by 0x400FC4: main (so.cpp:68) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:48:31.437

`generate_lattice`创建一个大小为 n*(n+1)/2 的数组，然后初始化该数组的 (n+1)*(n+1) 个元素，对吧？这可能会破坏堆或类似的奇怪东西。

我没有看，`price_from_tree`但是如果您只是将`lattice`其用作数组，我怀疑它会导致问题（除非您走到最后）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:46:46.500

你的数学是关闭的。在`generate_lattice`，`price_index`超越`(periods * (periods + 1)) / 2`。尝试：

```
int nodes = ((periods+1) * (periods + 2)) / 2; //Number of nodes = sum(1, # of periods + 1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T18:47:50.873

共享一维数组的索引计算`lattice`在两个函数之间是不一致的：

```
(periods * (periods + 1)) / 2;       // generate_lattice
((periods + 1) * (periods + 2)) / 2; // price_from_tree 
```

这可能是相关 malloc 错误的来源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T18:50:27.990

您计算的节点数不正确，因此您正在运行数组的末尾。尝试使用句点 = 2。因为你正在做 < 句点+1，所以你必须将节点计算为 (句点+1)*(句点+2)/2

# iphone - 试图了解 AVAudioPlayer 和音频电平表

> ID：10504428
> 
> 赞同：7
> 
> 时间：2012-05-08T18:37:35.400
> 
> 标签：iphone, objective-c, xcode, ipad, avaudioplayer

我正在尝试了解 AVAudioPlayer 和音频电平表。下面是一个正在播放短音频的对象“AudioPlayer”。现在我想输出这个声音的力量（分贝）。不知何故，我不认为我这样做是正确的。

```
 audioPlayer.meteringEnabled = YES;
        [audioPlayer play];
        int channels = audioPlayer.numberOfChannels;
        [audioPlayer updateMeters];
        for (int i=0; i<channels; i++) {
            //Log the peak and average power
            NSLog(@"%d %0.2f %0.2f", i, [audioPlayer peakPowerForChannel:0],[audioPlayer averagePowerForChannel:0]); 
```

NSLog 输出为 0 -160.00 -160.00 1 -160.00 -160.00

现在根据Apple“0 dB的返回值表示满量程或最大功率；-160 dB的返回值表示最小功率”那么这是否意味着这个声音处于最小功率？我认为这不是真的，因为音频片段是相当响亮的声音。我想我在这里遗漏了一些东西，任何澄清将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T12:09:19.317

您的代码有几个问题 - Jacques 已经指出了其中的大部分。

在读取值之前，您必须`[audioPlayer updateMeters];`每次调用。你可能最好实例化一个`NSTimer`.

`NSTimer *playerTimer;`在你的类中声明一个 iVar `@interface`。

此外，在您的班级中采用也没有什么坏处，`<AVAudioPlayerDelegate>`因此您可以在玩家完成游戏后使计时器无效。

然后将您的代码更改为：

```
audioPlayer.meteringEnabled = YES;
audioPlayer.delegate = self;

if (!playerTimer)
{
    playerTimer = [NSTimer scheduledTimerWithTimeInterval:0.001
                  target:self selector:@selector(monitorAudioPlayer)
                userInfo:nil
                 repeats:YES];
}

[audioPlayer play]; 
```

将这两种方法添加到您的类中：

```
-(void) monitorAudioPlayer
{   
    [audioPlayer updateMeters];

    for (int i=0; i<audioPlayer.numberOfChannels; i++)
    {
        //Log the peak and average power
         NSLog(@"%d %0.2f %0.2f", i, [audioPlayer peakPowerForChannel:i],[audioPlayer averagePowerForChannel:i]);
    }
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{   
    NSLog (@"audioPlayerDidFinishPlaying:");
    [playerTimer invalidate];
    playerTimer = nil;
} 
```

你应该很高兴。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T18:47:40.953

您正在更新，然后在声音开始后几乎立即询问仪表的值 - 这`updateMeters`可能在您发送后运行几十毫秒`play`。因此，如果剪辑开头有任何沉默，您很可能会得到正确的读数。您应该尝试延迟检查，并且您可能还需要在检查值之前在循环`updateMeters` *内发送。*

您也永远不会真正获得通道 > 0 的仪表值，因为无论`i`循环中的值是什么，您都会传递 0。我认为您打算这样做：

```
for (int currChan = 0; currChan < channels; currChan++) {
    //Log the peak and average power
    NSLog(@"%d %0.2f %0.2f", currChan, [audioPlayer peakPowerForChannel:currChan], [audioPlayer averagePowerForChannel:currChan]);
} 
```

# ios - 我们如何在 iOS 设备上在运行时处理启用/禁用背景音频功能？

> ID：10504432
> 
> 赞同：0
> 
> 时间：2012-05-08T18:37:54.707
> 
> 标签：ios, audio, background, runtime, plist

我知道如何使用 plist 设置我的 iOS 应用程序以使其在后台播放音频（= 在 iOS 设备上使用另一个应用程序时）。

一些应用程序，例如： - BLOOM - 一些收音机播放器

提供了一个基本的 UISwitch 来启用或禁用此行为。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:24:40.513

在处理音频播放代码的主类中有一个 UIBackgroundTaskIdentifier 类型的 iVar，在启动音频播放器之前使用 beginBackgroundTaskWithExpirationHandler.... 方法初始化它，并在音频播放器完成时使用 endBackgroundTask。

代码：

```
@inerface AudioPlayerController : NSObject
{
    UIBackgroundTaskIdentifier bgTaskID;
}
@end

@implementation AudioPlayerController

- (void) startPlayer
{

    bgTaskID = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:NULL];

   // Write code to start the audio player
}

// Call this when your program receives message of audio playing complete

- (void) audioPlayComplete
{

    // Do the audio playing finish

    if (bgTaskID != UIBackgroundTaskInvalid)
      [[UIApplication sharedApplication] endBackgroundTask:bgTaskID];
} 

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-14T04:10:24.400

在您的 AppDeletate 中：

```
- (void)applicationDidEnterBackground:(UIApplication *)application {
    [[YouPlayerClass sharedInstance] stop];
} 
```

因此，音频在应用程序进入后台时停止。

# hiddenfield - 在 mvc @Html.TextBox 中获取隐藏字段值

> ID：10504433
> 
> 赞同：0
> 
> 时间：2012-05-08T18:37:58.780
> 
> 标签：hiddenfield, html.textbox

我通过调用控制器方法在文本框中显示与 id 关联的值列表，在 asp.net mvc3 中为文本框使用自动完成选项。

```
 @Html.TextBox("tbxSearch", null,
 new { data_url = Url.Action("GetSearchData"), data_maxValues = 10, data_valueHiddenId = "#Id", @class = "searchTextbox" }) 
```

现在我想使用 Jquery 在警报中获取 data_valueHiddenId 值

```
$(document).ready(function () {
    ConfigureAutoComplete("#tbxSearch");
    $("#btnSearchPerson").click(function () {
        alert($("#data_valueHiddenId").val());
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:40:43.430

`data-maxValues`是一个*属性*，而不是一个元素。

你可以写`$('#tbxSearch').data('maxValues')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:40:56.680

```
$(document).ready(function () {
    ConfigureAutoComplete("#tbxSearch");
    $("#btnSearchPerson").click(function () {
        alert($($(this).attr("data_valueHiddenId")).val());
    });
}); 
```

# mysql - 推特喜欢关系数据库？

> ID：10504439
> 
> 赞同：0
> 
> 时间：2012-05-08T18:38:25.830
> 
> 标签：mysql, sql, database, select, relational-database

我目前正在尝试制作一个小型网络服务，只是为了好玩和学习。（我最近开始实际学习编程。）服务就像 twitter。用户关注他们的朋友并获取他们的状态。

我有一个关于关系数据库的问题。

有3个表，分别是'user'、'friendship'和'status'。以下是描述这些表格外观的代码。

```
 create table user (
    id int unsigned auto_increment primary key,
    username varchar(16) not null,
    password varchar(255) not null,
    created datetime default null
    );

    create table friendship (
    id int unsigned auto_increment primary key,
    userid int not null,
    friend int not null,
    created datetime default null
    );

    create table status (
    id int unsigned auto_increment primary key,
    userid int not null,
    current_status int not null,
    created datetime default null
    ); 
```

'user.id' 等于 'friendship.userid' 和 'status.userid'。

・情况是；

1、用户登录，会得到好友的状态号码。

2、php获取用户id，查找好友的userid、username、status和created(of status)。

我尝试了一些 sql 语句，但没有工作。

任何超级 sql 作家都可以告诉我正确的 sql 吗？

干杯!

编辑 1;

我试过这样的sql；

```
 select userid, username, current_status, created
    from status
    join users u1
    on u1.id = status.userid
    join friendship
    on friendship.friend = u1.id
    join user u2
    on u2.id =friendship.userid
    where u2.id = "the user's id from php"; 
```

和 mysql 抛出这个“#1146 - 表'Application.user'不存在。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:50:47.760

您的第一个联接语句具有“用户”，而您的表名是“用户”。这是一个常见的新手错误。您应该选择标准并遵循它。我看到的大多数数据库都使用单数形式，因此您的表名是“朋友”还是“朋友”都不会混淆。

不过不用担心，我认为几乎每个人在开始时都会犯这个错误。可能还有其他错误，但这个错误会立即弹出。

尝试修复它并让我们知道它是如何进行的。

哦，在表选择中声明我从哪个表中选择：即从 user.userid 中选择，...</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:20:35.773

像这样的东西应该工作：

```
select u1.userid, username, current_status, created
from status
    inner join [user] u1 on u1.id = status.userid
    inner join friendship on friendship.friend = u1.id
    inner join [user] u2 on u2.id = friendship.userid
    where u2.id = @User2Id 
```

就像评论中提到的那样：表'Application.user'不存在

在 SQL Server 中，用户是一个保留字，所以我们在它周围加上方括号。（见代码）。或者您将表名更改为其他名称（IE 客户端、TwitterUser 等...）

# php - 双 Jquery Slider UI 在第一次输入后输出整数

> ID：10504441
> 
> 赞同：0
> 
> 时间：2012-05-08T18:38:32.140
> 
> 标签：php, jquery

希望我能清楚地解释这一点。

我希望有两个滑块，第二个滑块的输出取决于第一个滑块的输出。

首先，用户在第一个滑块上设置价格，然后用户使用第二个滑块设置允许购买的客户数量和项目，第二个滑块应该只输出计算中的整数。

例如。价格定为 50 英镑。然后第二个滑块应输出 1,2,5,10,25,50，因为这些是计算中唯一的整数。

我难住了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:21:50.493

```
 $("#slider1, #slider2").on("slidechange", function() {
       var value1 = $('#slider1').slider('value');
       var value2 = $('#slider2').slider('value');

       // your computation here = outputVar

       $('#output').text(outputVar);
 }); 
```

像这样的东西应该适合你。基本上听用户更改滑块的值，获取您的值，并将它们输出到页面上的某个位置。

# java - 如何禁用前景视图以在背景上进行投掷

> ID：10504444
> 
> 赞同：1
> 
> 时间：2012-05-08T18:38:38.057
> 
> 标签：java, android, touch

我有 LinearLayout，它有 1) 视图和 2) 有一个手势检测器。我的问题是，当我想在线性布局上做一个投掷手势时，如果我的手指碰到任何视图，它会抛出一个 MotionEvent.ACTION_CANCEL 这将阻止 onFling() 回调触发。

我不能真正禁用对这些前景视图的触摸，因为它们是启动 Intents 导航的一部分。

谢谢，-毫升

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:52:25.163

听起来好像您没有将 GestureOverlayView 作为布局中的根元素？

简短的例子：

```
<android.gesture.GestureOverlayView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/gestures"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

    android:gestureStrokeType="multiple"
    android:eventsInterceptionEnabled="true"
    android:orientation="vertical">

    <ListView
        android:id="@android:id/list"  
        android:layout_width="fill_parent" 
        android:layout_height="fill_parent"  />

</android.gesture.GestureOverlayView> 
```

见这里：http: [//developer.android.com/resources/articles/gestures.html](http://developer.android.com/resources/articles/gestures.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:57:56.190

试着看看 ViewPager 里面是怎么做的。 [http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/support/v4/view/ViewPager.java#ViewPager.onInterceptTouchEvent%28android。 view.MotionEvent%29](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/support/v4/view/ViewPager.java#ViewPager.onInterceptTouchEvent%28android.view.MotionEvent%29)

您需要创建您的 LinearLayout（通过简单地扩展 Android 的 LinearLayout）并覆盖 onInterceptTouchEvent。这在孩子之前被调用，如果它返回真正的父母窃取孩子的触摸。 [http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent(android.view.MotionEvent](http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent(android.view.MotionEvent) )

# c - 赛格。哈希表 ADT 中的故障 - C

> ID：10504446
> 
> 赞同：2
> 
> 时间：2012-05-08T18:38:39.503
> 
> 标签：c, hash, adt

# 编辑：

Hash.c 已根据评论的修订进行了更新，但我仍然遇到 Seg 错误。我一定在这里遗漏了你们所说的一些东西

我使用 C 创建了一个哈希表 ADT，但是当我尝试在 ADT 中调用函数 (find_hash) 时遇到分段错误。

我已经发布了我创建的 parse.c、hash.c 和 hash.h 的所有 3 个文件，因此您可以看到所有变量。我们正在从文件 gettysburg.txt 中读取，该文件也附在文件中

当我调用 find_hash 时，parse.c 中发生了段错误。我一生都无法弄清楚这里发生了什么。如果您需要更多信息，我当然可以提供。

很抱歉，我刚刚在这个问题上完全难倒了一个星期的大量代码。提前致谢

我运行程序的方式是先：gcc -o parse parse.c hash.c 然后：cat gettysburg.txt | 解析

# 解析.c

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
#include "hash.h"

#define WORD_SIZE 40
#define DICTIONARY_SIZE 1000

#define TRUE 1
#define FALSE 0

void lower_case_word(char *);
void dump_dictionary(Phash_table ); 

/*Hash and compare functions*/
int hash_func(char *);
int cmp_func(void *, void *);

typedef struct user_data_ {   
    char word[WORD_SIZE];
    int freq_counter;
} user_data, *Puser_data;

int main(void)
{
   char c, word1[WORD_SIZE];
   int char_index = 0, dictionary_size = 0, num_words = 0, i;
   int total=0, largest=0;
   float average = 0.0;

   Phash_table t;                  //Pointer to main hash_table
   int (*Phash_func)(char *)=NULL;         //Function Pointers
   int (*Pcmp_func)(void *, void *)=NULL;
   Puser_data data_node;                   //pointer to hash table above
   user_data * find;

   printf("Parsing input ...\n");

   Phash_func = hash_func;   //Assigning Function pointers
   Pcmp_func = cmp_func;
   t = new_hash(1000,Phash_func,Pcmp_func);

  // Read in characters until end is reached 
  while ((c = getchar()) != EOF) {
    if ((c == ' ') || (c == ',') || (c == '.') || (c == '!') || (c == '"') ||
        (c == ':') || (c == '\n')) {
          // End of a word 
      if (char_index) {
          // Word is not empty 
        word1[char_index] = '\0';
        lower_case_word(word1);

        data_node = (Puser_data)malloc(sizeof(user_data));  
        strcpy(data_node->word,word1);
        printf("%s\n", data_node->word);

    //!!!!!!SEG FAULT HERE!!!!!!

        if (!((user_data *)find_hash(t, data_node->word))){   //SEG FAULT!!!!
         insert_hash(t,word1,(void *)data_node); 
        }

        char_index = 0;
        num_words++;
      }
    } else {
      // Continue assembling word 
      word1[char_index++] = c;
    }
  }

  printf("There were %d words; %d unique words.\n", num_words,
     dictionary_size);
  dump_dictionary(t);  //???

  }

void lower_case_word(char *w){
  int i = 0;

  while (w[i] != '\0') {
    w[i] = tolower(w[i]);
    i++;
  }
}

void dump_dictionary(Phash_table t){  //???
  int i;
  user_data *cur, *cur2;

  stat_hash(t, &(t->total), &(t->largest), &(t->average));   //Call to stat hash
    printf("Number of unique words:  %d\n", t->total);
    printf("Largest Bucket:  %d\n", t->largest);
    printf("Average Bucket:  %f\n", t->average);  

  cur = start_hash_walk(t);
  printf("%s:  %d\n", cur->word, cur->freq_counter);

  for (i = 0; i < t->total; i++)
     cur2 = next_hash_walk(t);
     printf("%s:  %d\n", cur2->word, cur2->freq_counter);
}

int hash_func(char *string){
    int i, sum=0, temp, index;

    for(i=0; i < strlen(string);i++){
        sum += (int)string[i];  
    }
    index = sum % 1000;
return (index); 
}

/*array1 and array2 point to the user defined data struct defined above*/
int cmp_func(void *array1, void *array2){

user_data *cur1= array1;
user_data *cur2= array2;//(user_data *)array2;

    if(cur1->freq_counter < cur2->freq_counter){
        return(-1);}
        else{ if(cur1->freq_counter > cur2->freq_counter){
                return(1);}
                else return(0);}
} 
```

# 哈希.c

```
#include "hash.h"

Phash_table new_hash (int size, int(*hash_func)(char*), int(*cmp_func)(void*, void*)){
    int i;
    Phash_table t;

    t = (Phash_table)malloc(sizeof(hash_table));   //creates the main hash table
    t->buckets = (hash_entry **)malloc(sizeof(hash_entry *)*size);  //creates the hash table of "size" buckets
    t->size = size;   //Holds the number of buckets
    t->hash_func = hash_func;   //assigning the pointer to the function in the user's program
    t->cmp_func = cmp_func;     // "  "  
    t->total=0;
    t->largest=0;
    t->average=0;
    t->sorted_array = NULL;
    t->index=0;
    t->sort_num=0;

    for(i=0;i<size;i++){   //Sets all buckets in hash table to NULL
        t->buckets[i] = NULL;}

    return(t);
}

void free_hash(Phash_table table){
    int i;
    hash_entry *cur;

    for(i = 0; i<(table->size);i++){
        if(table->buckets[i] != NULL){
            for(cur=table->buckets[i]; cur->next != NULL; cur=cur->next){
                free(cur->key);  //Freeing memory for key and data
                free(cur->data);
            }
      free(table->buckets[i]);    //free the whole bucket
    }}
    free(table->sorted_array);
    free(table);
}

void insert_hash(Phash_table table, char *key, void *data){
    Phash_entry new_node;   //pointer to a new node of type hash_entry
    int index;

    new_node = (Phash_entry)malloc(sizeof(hash_entry));
    new_node->key = (char *)malloc(sizeof(char)*(strlen(key)+1)); //creates the key array based on the length of the string-based key
    new_node->data = data;       //stores the user's data into the node
    strcpy(new_node->key,key);   //copies the key into the node

                                //calling the hash function in the user's program
    index = table->hash_func(key);    //index will hold the hash table value for where the new node will be placed
    table->buckets[index] = new_node; //Assigns the pointer at the index value to the new node
    table->total++;   //increment the total (total # of buckets)
}

void *find_hash(Phash_table table, char *key){
    int i;
    hash_entry *cur;
   printf("Inside find_hash\n"); //REMOVE

    for(i = 0;i<table->size;i++){
        if(table->buckets[i]!=NULL){            
            for(cur = table->buckets[i]; cur->next != NULL; cur = cur->next){
                if(strcmp(table->buckets[i]->key, key) == 0)
                return((table->buckets[i]->data));}  //returns the data to the user if the key values match
        }    //otherwise return NULL, if no match was found.
    }   
    return NULL;
}
void stat_hash(Phash_table table, int *total, int *largest, float *average){

    int node_num[table->size];  //creates an array, same size as table->size(# of buckets)
    int i,j, count = 0;
    int largest_buck = 0;
    hash_entry *cur;

    for(i = 0; i < table->size; i ++){
        if(table->buckets[i] != NULL){
            for(cur=table->buckets[i]; cur->next!=NULL; cur = cur->next){
                count ++;}
            node_num[i] = count;
            count = 0;}
        }

    for(j = 0; j < table->size; j ++){      
        if(node_num[j] > largest_buck)
            largest_buck = node_num[j];}

    *total = table->total;
    *largest = largest_buck;
    *average = (table->total) / (table->size);
}

void *start_hash_walk(Phash_table table){
    Phash_table temp = table;
    int i, j, k;
    hash_entry *cur;  //CHANGE IF NEEDED to HASH_TABLE *

    if(table->sorted_array != NULL) free(table->sorted_array);

    table->sorted_array = (void**)malloc(sizeof(void*)*(table->total));

    for(i = 0; i < table->total; i++){
        if(table->buckets[i]!=NULL){
            for(cur=table->buckets[i]; cur->next != NULL; cur=cur->next){
                table->sorted_array[i] = table->buckets[i]->data;
        }}
    }

    for(j = (table->total) - 1; j > 0; j --)    {
        for(k = 1; k <= j; k ++){
            if(table->cmp_func(table->sorted_array[k-1], table->sorted_array[k]) == 1){
                temp -> buckets[0]-> data = table->sorted_array[k-1];
                table->sorted_array[k-1] = table->sorted_array[k];
                table->sorted_array[k] = temp->buckets[0] -> data;
            }
        }
    }
    return table->sorted_array[table->sort_num];
}

void *next_hash_walk(Phash_table table){ 

    table->sort_num ++;
    return table->sorted_array[table->sort_num];
} 
```

# 哈希.h

```
#include <stdio.h> 
#include <stdlib.h>
#include <string.h>

typedef struct hash_entry_ {    //Linked List
    void *data;                 //Generic pointer
    char *key;                  //String-based key value
    struct hash_entry_ *next;   //Self-Referencing pointer
} hash_entry, *Phash_entry;

typedef struct hash_table_ {
    hash_entry **buckets;           //Pointer to a pointer to a Linked List of type hash_entry
    int (*hash_func)(char *);
    int (*cmp_func)(void *, void *);
    int size;
    void **sorted_array;         //Array used to sort each hash entry
    int index;
    int total;
    int largest;
    float average;  
    int sort_num;
} hash_table, *Phash_table;

Phash_table new_hash(int size, int (*hash_func)(char *), int (*cmp_func)(void *, void *));
void free_hash(Phash_table table);
void insert_hash(Phash_table table, char *key, void *data);
void *find_hash(Phash_table table, char *key);
void stat_hash(Phash_table table, int *total, int *largest, float *average);
void *start_hash_walk(Phash_table table);
void *next_hash_walk(Phash_table table); 
```

# 葛底斯堡.txt

```
Four score and seven years ago, our fathers brought forth upon this continent a new nation: conceived in liberty, and dedicated to the proposition that all men are created equal.

Now we are engaged in a great civil war. . .testing whether that nation, or any nation so conceived and so dedicated. . . can long endure. We are met on a great battlefield of that war.

We have come to dedicate a portion of that field as a final resting place for those who here gave their lives that that nation might live. It is altogether fitting and proper that we should do this.

But, in a larger sense, we cannot dedicate. . .we cannot consecrate. . . we cannot hallow this ground. The brave men, living and dead, who struggled here have consecrated it, far above our poor power to add or detract. The world will little note, nor long remember, what we say here, but it can never forget what they did here.

It is for us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly advanced. It is rather for us to be here dedicated to the great task remaining before us. . .that from these honored dead we take increased devotion to that cause for which they gave the last full measure of devotion. . . that we here highly resolve that these dead shall not have died in vain. . . that this nation, under God, shall have a new birth of freedom. . . and that government of the people. . .by the people. . .for the people. . . shall not perish from the earth. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:10:07.273

此代码的几个问题之一可能是循环，例如：

```
for(table->buckets[i]; 
    table->buckets[i]->next != NULL; 
    table->buckets[i] = table->buckets[i]->next)
  ... 
```

for 循环 ( ) 的初始化部分`table->buckets[i]`无效。如果`i`是 0 和`table->buckets[0] == NULL`，则此循环 ( `table->buckets[i]->next != NULL`) 上的条件将取消引用空指针并崩溃。

至少，这就是您的代码似乎在我的盒子上崩溃的地方。当我将您的几个循环更改为：

```
if (table->buckets[i] != NULL) {
  for(; 
      table->buckets[i]->next != NULL; 
      table->buckets[i] = table->buckets[i]->next)
    ...
} 
```

...它一直在崩溃，但在不同的地方。也许这会帮助你摆脱困境？

* * *

**编辑**：另一个潜在的问题是那些 for 循环是破坏性的。当您调用`find_hash`时，您真的希望修改所有这些存储桶吗？

我建议使用类似的东西：

```
hash_entry *cur;
// ...
if (table->buckets[i] != NULL) {
  for (cur = table->buckets[i]; cur->next != NULL; cur = cur->next) {
    // ...
  }
} 
```

当我这样做并注释掉你的`dump_dictionary`函数时，你的代码会运行而不会崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T00:56:15.923

唔，

这是哈希.c

```
#include "hash.h"

Phash_table new_hash (int size, int(*hash_func)(char*), int(*cmp_func)(void*, void*)){
    int i;
    Phash_table t;

    t = (Phash_table)calloc(1, sizeof(hash_table));   //creates the main hash table
    t->buckets = (hash_entry **)calloc(size, sizeof(hash_entry *));  //creates the hash table of "size" buckets
    t->size = size;   //Holds the number of buckets
    t->hash_func = hash_func;   //assigning the pointer to the function in the user's program
    t->cmp_func = cmp_func;     // "  "  
    t->total=0;
    t->largest=0;
    t->average=0;

    for(i=0;t->buckets[i] != NULL;i++){   //Sets all buckets in hash table to NULL
        t->buckets[i] = NULL;}

    return(t);
}

void free_hash(Phash_table table){
    int i;

    for(i = 0; i<(table->size);i++){
        if(table->buckets[i]!=NULL)
            for(table->buckets[i]; table->buckets[i]->next != NULL; table->buckets[i] = table->buckets[i]->next){
                free(table->buckets[i]->key);  //Freeing memory for key and data
                free(table->buckets[i]->data);
            }
      free(table->buckets[i]);    //free the whole bucket
    }
    free(table->sorted_array);
    free(table);
}

void insert_hash(Phash_table table, char *key, void *data){
    Phash_entry new_node;   //pointer to a new node of type hash_entry
    int index;

    new_node = (Phash_entry)calloc(1,sizeof(hash_entry));
    new_node->key = (char *)malloc(sizeof(char)*(strlen(key)+1)); //creates the key array based on the length of the string-based key
    new_node->data = data;       //stores the user's data into the node
    strcpy(new_node->key,key);   //copies the key into the node

                                //calling the hash function in the user's program
    index = table->hash_func(key);    //index will hold the hash table value for where the new node will be placed
    table->buckets[index] = new_node; //Assigns the pointer at the index value to the new node
    table->total++;   //increment the total (total # of buckets)
}

void *find_hash(Phash_table table, char *key){
    int i;
hash_entry *cur;

   printf("Inside find_hash\n"); //REMOVE

    for(i = 0;i<table->size;i++){
        if(table->buckets[i]!=NULL){
            for (cur = table->buckets[i]; cur != NULL; cur = cur->next){
            //for(table->buckets[i]; table->buckets[i]->next != NULL; table->buckets[i] = table->buckets[i]->next){
                if(strcmp(cur->key, key) == 0)
                   return((cur->data));}  //returns the data to the user if the key values match
        }    //otherwise return NULL, if no match was found.
    }   
    return NULL;
}
void stat_hash(Phash_table table, int *total, int *largest, float *average){

    int node_num[table->size];    
    int i,j, count = 0;
    int largest_buck = 0;
    hash_entry *cur;

    for(i = 0; i < table->size; i ++)
    {
        if(table->buckets[i]!=NULL)            
            for (cur = table->buckets[i]; cur != NULL; cur = cur->next){
            //for(table->buckets[i]; table->buckets[i]->next != NULL; table->buckets[i] = table->buckets[i]->next){
                count ++;}

        node_num[i] = count;
        count = 0;
    }

    for(j = 0; j < table->size; j ++){
        if(node_num[j] > largest_buck)
            largest_buck = node_num[j];}

    *total = table->total;
    *largest = largest_buck;
    *average = (table->total) /(float) (table->size); //oook: i think you want a fp average
}

void *start_hash_walk(Phash_table table){
    void* temp = 0; //oook: this was another way of overwriting your input table 
    int i, j, k; 
    int l=0; //oook: new counter for elements in your sorted_array
    hash_entry *cur;

    if(table->sorted_array !=NULL) free(table->sorted_array);

    table->sorted_array = (void**)calloc((table->total), sizeof(void*));

    for(i = 0; i < table->size; i ++){
    //for(i = 0; i < table->total; i++){  //oook: i don't think you meant total ;)
        if(table->buckets[i]!=NULL)
            for (cur = table->buckets[i]; cur != NULL; cur = cur->next){
            //for(table->buckets[i]; table->buckets[i]->next != NULL; table->buckets[i] = table->buckets[i]->next){
                table->sorted_array[l++] = cur->data;
            }
    }

    //oook: sanity check/assert on expected values
    if (l != table->total)
    {
        printf("oook: l[%d] != table->total[%d]\n",l,table->total);
    }

    for(j = (l) - 1; j > 0; j --)    {
        for(k = 1; k <= j; k ++){
            if (table->sorted_array[k-1] && table->sorted_array[k])
            {
                if(table->cmp_func(table->sorted_array[k-1], table->sorted_array[k]) == 1){
                    temp = table->sorted_array[k-1]; //ook. changed temp to void* see assignment
                    table->sorted_array[k-1] = table->sorted_array[k];
                    table->sorted_array[k] = temp;
                }
            }
            else
                printf("if (table->sorted_array[k-1] && table->sorted_array[k])\n");
        }
    }
    return table->sorted_array[table->sort_num];
}

void *next_hash_walk(Phash_table table){ 

    /*oook: this was blowing up since you were incrementing past the size of sorted_array..
    NB: *you **need** to implement some bounds checking here or you will endup with more seg-faults!!*/
    //table->sort_num++
    return table->sorted_array[table->sort_num++];
} 
```

这是 parse.c

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
#include <assert.h>  //oook: added so you can assert ;)
#include "hash.h"

#define WORD_SIZE 40
#define DICTIONARY_SIZE 1000

#define TRUE 1
#define FALSE 0

void lower_case_word(char *);
void dump_dictionary(Phash_table ); 

/*Hash and compare functions*/
int hash_func(char *);
int cmp_func(void *, void *);

typedef struct user_data_ {   
    char word[WORD_SIZE];
    int freq_counter;
} user_data, *Puser_data;

int main(void)
{
   char c, word1[WORD_SIZE];
   int char_index = 0, dictionary_size = 0, num_words = 0, i;
   int total=0, largest=0;
   float average = 0.0;

   Phash_table t;                  //Pointer to main hash_table
   int (*Phash_func)(char *)=NULL;         //Function Pointers
   int (*Pcmp_func)(void *, void *)=NULL;
   Puser_data data_node;                   //pointer to hash table above
   user_data * find;

   printf("Parsing input ...\n");

   Phash_func = hash_func;   //Assigning Function pointers
   Pcmp_func = cmp_func;
   t = new_hash(1000,Phash_func,Pcmp_func);

  // Read in characters until end is reached 
  while ((c = getchar()) != EOF) {
    if ((c == ' ') || (c == ',') || (c == '.') || (c == '!') || (c == '"') ||
        (c == ':') || (c == '\n')) {
          // End of a word 
      if (char_index) {
          // Word is not empty 
        word1[char_index] = '\0';
        lower_case_word(word1);

        data_node = (Puser_data)calloc(1,sizeof(user_data));  
        strcpy(data_node->word,word1);
        printf("%s\n", data_node->word);

    //!!!!!!SEG FAULT HERE!!!!!!

        if (!((user_data *)find_hash(t, data_node->word))){   //SEG FAULT!!!!
        dictionary_size++;
         insert_hash(t,word1,(void *)data_node); 
        }

        char_index = 0;
        num_words++;
      }
    } else {
      // Continue assembling word 
      word1[char_index++] = c;
    }
  }

  printf("There were %d words; %d unique words.\n", num_words,
     dictionary_size);
  dump_dictionary(t);  //???

  }

void lower_case_word(char *w){
  int i = 0;

  while (w[i] != '\0') {
    w[i] = tolower(w[i]);
    i++;
  }
}

void dump_dictionary(Phash_table t){  //???
  int i;
  user_data *cur, *cur2;

  stat_hash(t, &(t->total), &(t->largest), &(t->average));   //Call to stat hash
    printf("Number of unique words:  %d\n", t->total);
    printf("Largest Bucket:  %d\n", t->largest);
    printf("Average Bucket:  %f\n", t->average);  

  cur = start_hash_walk(t);
  if (!cur) //ook: do test or assert for null values
  {
    printf("oook: null== (cur = start_hash_walk)\n");
    exit(-1);
  }
  printf("%s:  %d\n", cur->word, cur->freq_counter);
  for (i = 0; i < t->total; i++)
  {//oook: i think you needed these braces
      cur2 = next_hash_walk(t);
      if (!cur2) //ook: do test or assert for null values
      {
        printf("oook: null== (cur2 = next_hash_walk(t) at i[%d])\n",i);
      }
      else
        printf("%s:  %d\n", cur2->word, cur2->freq_counter);
  }//oook: i think you needed these braces
}

int hash_func(char *string){
    int i, sum=0, temp, index;

    for(i=0; i < strlen(string);i++){
        sum += (int)string[i];  
    }
    index = sum % 1000;
return (index); 
}

/*array1 and array2 point to the user defined data struct defined above*/
int cmp_func(void *array1, void *array2){

user_data *cur1= array1;
user_data *cur2= array2;//(user_data *)array2;

    /* ooook: do assert on programmatic errors. 
    this function *requires non-null inputs.  */
    assert(cur1 && cur2);  
    if(cur1->freq_counter < cur2->freq_counter){
        return(-1);}
        else{ if(cur1->freq_counter > cur2->freq_counter){
                return(1);}
                else return(0);}
} 
```

跟着`//ooks`

**说明：**

有一两个地方会爆炸。
快速修复和回答您的问题在`parse.c`，大约*L100*：

```
 cur = start_hash_walk(t);
  printf("%s:  %d\n", cur->word, cur->freq_counter); 
```

..在调用之前检查`cur`是否可以修复您的直接段错误。`null``printf`

但为什么会`cur`呢`null`？〜因为这个坏男孩：
`void *start_hash_walk(Phash_table table)`

你`hash_func(char *string)`可以（&确实）返回非唯一值。这当然没问题，只是你还没有实现你的链表链。因此，您最终会`table->sorted_array`包含少​​于`table->total`元素〜或者如果您遍历所有`table->size`存储桶，您会这样做；）

还有一两个其他问题。现在我进一步黑[了 Nate Kohl](https://stackoverflow.com/users/98654/nate-kohl) `for(cur=table->buckets[i]; cur->next != NULL; cur=cur->next)`，`for(cur=table->buckets[i]; cur != NULL; cur=cur->next)`因为你没有锁链。但这是*您的 TODO，对此已经说得够多了。

最后。请注意，`next_hash_walk(Phash_table table)`您有：

```
table->sort_num++
return table->sorted_array[table->sort_num]; 
```

哎哟! *请*检查那些数组边界！

**注释**

1）如果您的功能不是为了更改输入而设计的，那么请输入`const`。这样，编译器很可能会在您无意中丢弃某些东西时告诉您。

2) 对数组索引进行边界检查。

3) 在尝试使用 Null 指针之前对其进行测试/断言。

4）对您的每个功能进行单元测试；在编译和测试之前不要写太多代码。

5) 使用最少的测试数据；精心制作它，以便对您的代码进行限制测试并尝试以狡猾的方式破坏它。

6）初始化你的数据结构！

7)*切勿使用埃及牙套！*{
只是开玩笑 ;)
}

**PS** *到目前为止做得很好〜>指针是棘手的小东西！& 一个包含所有必要细节的好问题，所以 +1 和 gl ;)*

(//oook: 也许添加一个*作业*标签)

# ruby-on-rails - 用于电子邮件的 Rails assign_multiparameter_attributes

> ID：10504456
> 
> 赞同：1
> 
> 时间：2012-05-08T18:39:30.403
> 
> 标签：ruby-on-rails

我正在开发一个 rails 3.0 应用程序。我的客户希望我在视图中将电子邮件信息拆分为用户名 + @ + 域名。我不想将电子邮件字段一分为二。我只想制作像 datetime_select 这样的虚拟属性。

示例：用户 = User.new 属性 => {"email(1s)" => "sam", "email(2s)" => "domain.com"}

当然，这个伪代码不起作用。我能做些什么呢？

谢谢。

山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:05:03.943

这是在 Rails 辅助方法中使用相同方式的方法。 [http://apidock.com/rails/ActiveRecord/AttributeAssignment/assign_multiparameter_attributes](http://apidock.com/rails/ActiveRecord/AttributeAssignment/assign_multiparameter_attributes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:13:27.887

我认为最简单的事情是

```
 #user.rb
 before_save :update_email
 attr_accessor :email_name, :email_domain
 def update_email
   self.email = "#{self.email_name}@#{self.email_domain}"
 end 
```

# android - 如何获取已安装的即时通讯应用程序列表？

> ID：10504459
> 
> 赞同：0
> 
> 时间：2012-05-08T18:39:39.193
> 
> 标签：android, email, sms, android-package-managers

我的应用程序应该能够通过 WhatsApp、电子邮件、SMS 等在 TextView 中发送文本。为此，我需要一个已安装的消息应用程序列表。我用 PackageManger 试过，但我得到了所有应用程序。我怎样才能只获得即时消息应用程序？

这是我列出已安装应用程序的代码：

```
PackageManager packageManager=this.getPackageManager(); 
    List<PackageInfo> applist=packageManager.getInstalledPackages(0);
    Iterator<PackageInfo> it=applist.iterator();
    while(it.hasNext()){
    PackageInfo pk=(PackageInfo)it.next();
    if(PackageManager.PERMISSION_GRANTED==(packageManager.checkPermission(Manifest.permission.INTERNET, pk.packageName)& packageManager.checkPermission(Manifest.permission.RECEIVE_SMS, pk.packageName))) //checking if the package is having INTERNET permission
    {
    myList.add(""+pk.applicationInfo.loadLabel(packageManager));
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:44:15.950

假设您设法获得了您想要的应用程序列表，那么您将如何处理它们？我认为您需要让 android 向您的用户显示应用程序列表，以便他们根据执行的操作选择他们想要处理文本的应用程序。幸运的是，这是 Android 中的内置功能。这是我发送电子邮件的功能：

```
public static void StartEmailIntent (Context cx, String EmailAddress){
    Intent email = new Intent(Intent.ACTION_SEND);

    email.setType("plain/text");
    email.putExtra(Intent.EXTRA_EMAIL, new String[]{EmailAddress});

    cx.startActivity(Intent.createChooser(email, cx.getString(R.string.dlg_sendmail_selectortitle)));
} 
```

如您所见，我将 Intent.ACTION_SEND 设置为操作，然后使用 Intent.createChooser android 创建一个能够根据 Intent 的类型和附加内容处理该操作的应用程序列表。调整短信、电话等其他操作应该不难。您可以在此处阅读更多相关信息 将[内容发送到其他应用程序](http://developer.android.com/training/sharing/send.html)

希望这可以帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:45:35.047

如果您的目标是冰淇淋三明治，您应该使用[ShareActionProvider](http://developer.android.com/reference/android/widget/ShareActionProvider.html)。在那里，您可以获得所需的分享方式列表。

您还可以阅读这篇[android-developer-blogpost](http://android-developers.blogspot.de/2012/02/share-with-intents.html)，其中解释了如何通过 Intent 进行共享。例如，对于您的电子邮件共享：

```
Intent intent=new Intent(android.content.Intent.ACTION_SEND);
intent.setType("text/plain");
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);

// Add data to the intent, the receiving app will decide what to do with it.
intent.putExtra(Intent.EXTRA_SUBJECT, “Some Subject Line”);
intent.putExtra(Intent.EXTRA_TEXT, “Body of the message, woot!”); 
```

# html - 使 html 页面的区域成为链接

> ID：10504462
> 
> 赞同：0
> 
> 时间：2012-05-08T18:39:43.227
> 
> 标签：html, hyperlink

我正在开发一个顶部有导航的网页。我想知道如何使 html 页面的某个区域可点击。这样，人们不仅可以单击导航栏中的文本，还可以单击文本周围的一般区域，以便从一个页面导航到另一个页面。当我继续尝试这样做时，它通常会弄乱我已经在页面上拥有的 div。

任何帮助，将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:44:28.020

只有一小部分 HTML 元素可以放在`<a>`. 例如，一个 div 不能放在一个`<a>`.

在这种情况下，您可以使用 javascript 或 jQuery 来侦听页面上某个定义区域（例如 div）的点击，并通过更改地址（例如通过更改`window.location.href`）来响应它。这将具有您正在寻找的相同效果。

请注意，可用性和设计伦理要求您网站的用户知道某个区域是一个链接，并在他们点击之前将您带到其他地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:47:27.043

如果我正确理解了您的问题：

尝试设置`display: block;`菜单文本链接，+ 添加它们`padding`。也可以使用`width`和`height`

因此，活动链接不仅是文本，还包括它周围的区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:43:50.047

我假设你的意思是整个div？我们可以使用 javascript (jQuery) 来做到这一点：

```
$("#mydiv").click(function() {
   window.location = 'http://www.google.com'; // redirect here on click
});
<div id="mydiv">
   <!-- this area we can click -->
</div> 
```

# javascript - 当您有集合时，调用接收单个对象作为参数的函数的最佳方法是什么？

> ID：10504489
> 
> 赞同：0
> 
> 时间：2012-05-08T18:41:13.487
> 
> 标签：javascript

有时，您有一个适用于平面参数的函数。例如：

```
send(player,message) 
```

但是，如果相反，你有玩家/消息的集合呢？

```
message = ['Welcome!','Check our site for events.']
players = [Player1,Player2,Player3] 
```

编写 for 循环会降低可读性，并且如果您不知道静态参数是集合还是对象，则将不起作用。重写函数有时不可行或太费力，并且会导致重复代码。什么是更简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:50:54.713

您可以编写一个[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)，将您的函数转换为一个函数，该函数将采用它自己的参数的[笛卡尔积](http://en.wikipedia.org/wiki/Cartesian_product)并在其上调用原始函数。

```
function send(player,message) {
    console.log('To ',player,': ',message);
}
cartesian(send)(['Player1','Player2','Player3'],['Welcome!','Check our site.']);
//Output:
//To Player1 : Welcome!
//To Player1 : Check our site.
//To Player2 : Welcome!
//To Player2 : Check our site.
//To Player3 : Welcome!
//To Player3 : Check our site. 
```

这在 Javascript 上实现了装饰器（“*笛卡尔”）：*

```
function cartesian_product(arr){
    //cartesian_product( [[1,2],[3,4]] ) = [[1,3],[1,3],[2,3],[2,4]]

    function partial_product(arr,i){
        //partial_product([[1,2],3],0) = [[1,3],[2,3]]
        var result = []
        for (j=0; j<arr[i].length; ++j){
            arr_changed = arr.slice();
            arr_changed.splice(i,1,arr[i][j]);
            result.push(arr_changed);
        };
        return result;
    };

    var result = [arr.slice()];
    for (var x=0; x<arr.length; ++x){
        for (var y=0; y<result.length; ++y){
            if (result[y][x] instanceof Array) {
                result.splice.apply(result,[y,1].concat(partial_product(result[y],x)));
            }
        }
    }
    return result;
};

function cartesian(func){
    //cartesian(func)([1,2],[3,4]) = [func([1,3]),func([1,4]),func([2,3]),func([2,4])]
    _this = this;
    return function(){
        var args_list = cartesian_product(Array.prototype.slice.call(arguments));
        var return_values = []
        for (var i=0; i<args_list.length; ++i){
            return_values.push(func.apply(_this,args_list[i]))
        }
        return return_values;
    }
} 
```

# java - 词法分析器

> ID：10504498
> 
> 赞同：2
> 
> 时间：2012-05-08T18:41:59.413
> 
> 标签：java, string, lexical-analysis

大家好，我是java的初学者:)所以我正在做的是我试图使用java构建一个词法分析器但我坚持试图读取字符串中的下一个字符我试图使用查找函数来检查但我不知道如何主要使用它。这是代码

```
 import java.util.*;
 import java.util.Scanner;

 public class LAnalyze{

public static int i;

public static void main(String[] args) {

    String s = "(3+4)*5";
    System.out.println("s = " + s);

    char[] chars = s.toCharArray();

    for (char i = 0; i < 8; i++) {
        if (i == 0) {
            i = s.charAt(0);
            lookup();

        }
    }
}

public int lookup() {

    switch (i) {
    case '(':
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 25");
        break;
    case ')':
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 26");
        break;
    case '+':
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 21");
        break;
    case '-':
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 22");
        break;
    case '*':
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 23");
        break;
    case '/':
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 24");
    default:
        System.out.println("Next Token = " + "'" + i + "'"
                + " Next lexeme = 20");
    }
    return 0;
}
 }

   /* the output is suppose to be something like this:

    Next Token = "(" Next lexeme = 25
    Next Token = "3" Next lexeme = 20
    Next Token = "+" Next lexeme = 21
    .
    .
    .
    Next Token = ")" Next lexeme = 26
     */ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:51:26.913

您可以通过以下代码进行操作。

```
public static void main(String[] args) {

        String s = "(3+4)*5";
        System.out.println("s = " + s);

        char[] chars = s.toCharArray();

        for (int i = 0; i < chars.length ; i++) {
            //System.out.println("s = " + s);
            lookup(chars[i]);
        }
    }

    public static int lookup(int i) {

        switch (i) {
        case '(':
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 25");
            break;
        case ')':
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 26");
            break;
        case '+':
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 21");
            break;
        case '-':
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 22");
            break;
        case '*':
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 23");
            break;
        case '/':
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 24");
        default:
            System.out.println("Next Token = " + "'" + (char)i + "'"
                    + " Next lexeme = 20");
        }
        return 0;
    } 
```

**输出**

```
s = (3+4)*5
Next Token = '(' Next lexeme = 25
Next Token = '3' Next lexeme = 20
Next Token = '+' Next lexeme = 21
Next Token = '4' Next lexeme = 20
Next Token = ')' Next lexeme = 26
Next Token = '*' Next lexeme = 23
Next Token = '5' Next lexeme = 20 
```

希望这会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:53:10.083

我想您需要更改循环以实际推进数组的单元格（目前您不断查看第 0 个索引处的第一个元素）：

```
public static void main(String[] args) {

    String s = "(3+4)*5";
    System.out.println("s = " + s);

    for (int i = 0; i < s.length(); i++) {
        char ch = s.charAt(i);
        lookup(ch);
    }
}

public static void lookup(char ch) {

    switch (ch) {
        case '(':
            // ...
    }
} 
```

# python - 将 tzinfo 设置为 datetime 对象的最佳实践或快捷方式

> ID：10504499
> 
> 赞同：1
> 
> 时间：2012-05-08T18:42:00.617
> 
> 标签：python, datetime, timezone

下面描述的代码段是否有快捷方式：

```
if value.tzinfo is None:
    value = default_tzinfo.localize(value)
    new_value = value.astimezone(default_tzinfo)
else:
    new_value = value 
```

当我使用美国/太平洋时区时，我尝试使用`datetime.replace()`但返回 GMT -8 而不是 -7。

见：[http ://wwp.greenwichmeantime.com/time-zone/usa/pacific-time/pacific-daylight-time.htm](http://wwp.greenwichmeantime.com/time-zone/usa/pacific-time/pacific-daylight-time.htm)

```
value = value.replace(tzinfo=default_tzinfo) 
```

示例输出：

```
2012-05-06 13:12:45-08:00
US/Pacific
---
2012-05-07 00:12:45+03:00
Europe/Istanbul 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:08:51.137

答案在 pytz 文档中给出：http: [//pytz.sourceforge.net/#localized-times-and-date-arithmetic](http://pytz.sourceforge.net/#localized-times-and-date-arithmetic)

使用`localize`后，您应该有一个具有正确时区的日期时间。调用`astimezone`是多余的，可能会搞砸你。

时区需要知道日期和时间，以便它可以根据夏令时转换自行调整。这就是为什么`replace`不起作用。

# jsf - 在 JSF 中使用嵌套数据表通过 Arraylist 显示字母

> ID：10504501
> 
> 赞同：0
> 
> 时间：2012-05-08T18:42:07.010
> 
> 标签：jsf, datatable, nested-datalist

如何显示使用嵌套数据表动态附加相应字母和记录的列表？
显示如下：
A
---ArrayList 显示以 A 作为第一个字符--
。
.
.
B
---ArrayList 显示以 B 作为第一个字符-
。
.
.
C
---ArrayList 以 C 作为第一个字符-- 显示
。
.
.
依此类推，直到 Z。

到目前为止为上述显示完成的嵌套数据表的代码是：

```
<h:dataTable value="#{bean.outerlist}" var="loc">
<h:column>
<h:outputTxt value="#{loc.alphabet}">
<h:dataTable value="#{bean.innerlist}" var="loc2">
<h:column>
<h:outputText value="#{loc2.firstName}">
</h:column>
</h:dataTable>
</h:column>
</h:dataTable> 
```

# iphone - 使用 RESTKit 解析深层 XML 结构

> ID：10504502
> 
> 赞同：4
> 
> 时间：2012-05-08T18:42:10.720
> 
> 标签：iphone, objective-c, ios, xml, restkit

我被 RESTKit 的潜力所吸引——听起来很棒。

不幸的是，我能找到的所有示例都围绕解析 JSON，以及解析相对“扁平”的 JSON。世界上不幸的现实是，有很多 XML，而且很多都是丑陋的。

特别是，我似乎找不到任何解析深度嵌套 XML 结构的好例子。

我认为我的失败在于理解关键路径，我希望这个问题的答案将成为其他面临这个问题的人的典型例子。

让我们举一个人为的例子。考虑以下 XML：

```
<?xml version="1.0"?> 
<old_lady fate="perhaps she'll die!"> 
  <bird reason = "to catch the spider"> 
    <spider reason="to catch the fly"> 
      <fly reason="why oh why?" action="swallowed" name="Al"/> 
      <fly reason="why oh why?" action="swallowed" name="Bob"/> 
      <fly reason="why oh why?" action="swallowed" name="Cory"/> 
      <fly reason="why oh why?" action="swallowed" name="Dan"/> 
      <fly reason="why oh why?" action="swallowed" name="Edgar"/> 
    </spider> 
  </bird> 
</old_lady> 
```

假设我想从中得到一个 Fly 对象列表：

```
@interface Fly : NSObject 
@property (retain) NSString *reason; 
@property (retain) NSString *action; 
@property (retain) NSString *name; 
@end 
```

所以我以为我会做这样的事情：

```
[RKObjectManager objectManagerWithBaseURL:[NSURL 
URLWithString:@"http://some.server.com"]];

RKObjectMapping *mapping = [RKObjectMapping mappingForClass:[Fly class]]; 
[mapping mapKeyPath:@"reason" toAttribute:@"reason"]; 
[mapping mapKeyPath:@"action" toAttribute:@"action"]; 
[mapping mapKeyPath:@"name" toAttribute:@"name"];

[RKObjectManager.sharedManager.mappingProvider setMapping:mapping
forKeyPath:@"//old_lady/bird/spider/fly"]; 

[[RKObjectManager sharedManager] loadObjectsAtResourcePath:@"/path/to/rhyme.xml" 
                                                  delegate:self]; 
```

然而，这让我：

```
Encountered errors during mapping: Could not find an object mapping for keyPath: '' 
```

我确定问题出在我的“//old_lady/bird/spider/fly”关键路径上，但我找不到任何类似的示例来模拟解决方案。哈普？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T19:13:52.430

我觉得自己像个傻瓜。在被困在这个问题上一天多之后，我在发布到 stackoverflow 后不久才发现了解决方案。

我的问题是我将 XPath 的概念与 Objective-C 的键值编码键路径的概念混淆了。

事实上，使用这个：

```
[RKObjectManager.sharedManager.mappingProvider setMapping:mapping 
forKeyPath:@"old_lady.bird.spider.fly"]; 
```

并因此记录结果：

```
- (void)objectLoader:(RKObjectLoader *)objectLoader didLoadObjects: 
(NSArray *)objects 
{ 
    for (Fly *fly in objects) 
    { 
        NSLog(@"%@, %@, %@", fly.reason, fly.action, fly.name); 
    } 
} 
```

正如预期的那样，我在控制台中看到了这一点：

```
2012-05-08 14:08:50.173 Foo[26922:207] why oh why?, swallowed, Al 
2012-05-08 14:08:50.173 Foo[26922:207] why oh why?, swallowed, Bob 
2012-05-08 14:08:50.175 Foo[26922:207] why oh why?, swallowed, Cory 
2012-05-08 14:08:50.176 Foo[26922:207] why oh why?, swallowed, Dan 
2012-05-08 14:08:50.176 Foo[26922:207] why oh why?, swallowed, Edgar 
```

# ruby-on-rails - 使用 RSpec 测试 Datamapper 模型

> ID：10504505
> 
> 赞同：0
> 
> 时间：2012-05-08T18:42:16.513
> 
> 标签：ruby-on-rails, ruby, rspec, sinatra, datamapper

我正在使用 RSpec 测试一个使用 DataMapper 的 Sinatra 应用程序。

以下代码：

```
it "should update the item's title" do
  lambda do
    post "/hello/edit", :params => {
      :title => 'goodbye',
      :body  => 'goodbye world'
    }
  end.should change(Snippet, :title).from('hello').to('goodbye')
end 
```

导致此错误：

> 标题最初应该是“hello”，但是是 #<DataMapper::Property::String @model=Snippet @name=:title>

我当然可以通过删除*lambda*并仅检查是否：

```
Snippet.first.title.should == 'goodbye' 
```

但这不可能是一个长期的解决方案，因为*.first* Snippet 在未来可能会不一样。

有人可以告诉我正确的语法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:01:44.830

您所写的规范暗示 lambda 实际上应该更改*类*属性的值`Snippet.title`；我认为你想要的是这样的：

```
it "should update the item's title" do
  snippet = Snippet.first(:title => "hello")
  lambda do
    post "/#{snippet.title}/edit", :params => {
      :title => 'goodbye',
      :body  => 'goodbye world'
    }
  end.should change(snippet, :title).from('hello').to('goodbye')
end 
```

对？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:49:16.223

我终于使用以下方法修复了它：

```
it "should update the item's title" do
  snippet = Snippet.first(:title => "hello")
  post "/hello/edit", :params => {
    :title => 'goodbye',
    :body  => 'goodbye world'
  }
  snippet.reload.title.should == 'goodbye'
end 
```

感谢@Dan Tao，他的回答帮助了我。

# ruby-on-rails - 在 Rails 中进行测试时，我是使用种子还是工厂女孩，还是两者都使用？

> ID：10504510
> 
> 赞同：1
> 
> 时间：2012-05-08T18:42:28.723
> 
> 标签：ruby-on-rails, ruby, factory-bot

我有一个带有几个外键的 Store 模型。我有 state_id、country_id、currency_id、timezone_id 等...我应该为其中的每一个创建一个工厂吗？然后在 Store 的工厂中执行以下操作：

```
a.state State.where(:abbreviation => "MA").first || Factory(:state, :abbreviation => "MA") 
```

还是我应该只播种这些数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:06:46.377

如果您使用 rake seed 任务，它只会将其添加到数据库中。但是，很多事情，比如 db:test:prepare 任务，会从数据库中删除所有记录，所以种子任务不会生效。

您的工厂方法看起来不错，但我建议您将代码放在一对大括号中。

```
a.state { State.where(:abbreviation => "MA").first || Factory(:state, :abbreviation => "MA") } 
```

这将在每次调用工厂时重新运行，并防止在数据库中创建重复项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:14:08.600

使用工厂女孩，它已经完成了耙子的工作。

如果您问我，对于这种特殊情况（暗示您已经在使用工厂女孩），您应该使用 rake seed。我给你一个更大的NO。这会破坏您的组织与您的测试。

# ruby-on-rails - Rails 3.2 - 尝试编辑新数据库条目时收到一个奇怪的错误

> ID：10504514
> 
> 赞同：2
> 
> 时间：2012-05-08T18:42:40.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, relationship

我有一个名为的对象`Job`，它属于另一个`client`在多关系中调用的对象。

这是我的工作模式

```
class Job < ActiveRecord::Base
  belongs_to :client
end 
```

这是我的客户模型

```
class Client < ActiveRecord::Base 
  has_many :jobs
end 
```

对于新工作，我只想在创建过程中将其分配给客户。

但是，当我尝试创建新工作时。在我看来，我所看到的只是工作的 id 而不是名称，并且创建的模型的内部也是空的。

当我尝试编辑作业并再次保存时，我收到以下错误。

```
Client(#2157214400) expected, got String(#2151988620)

Application Trace | Framework Trace | Full Trace
app/controllers/jobs_controller.rb:61:in `block in update'
app/controllers/jobs_controller.rb:60:in `update' 
```

我想这可能是因为我的控制器在某种程度上是错误的，但这是我的第一个应用程序，所以我不太确定去哪里看。

这是我的控制器。

类 JobsController < ApplicationController

```
 def index
      @job = Job.all

      respond_to do |format|
        format.html # index.html.erb
        format.json { render json: @job }
      end
    end

    def show
      @job = Job.find(params[:id])

      respond_to do |format|
        format.html # show.html.erb
        format.json { render json: @job }
      end
    end

    def new
      @job = Job.new(params[:id])

      respond_to do |format|
        format.html # new.html.erb
        format.json { render json: @job }
      end
    end

    def edit
      @job = Job.find(params[:id])
    end

    def create
      @job = Job.new(params[:jobs])

      respond_to do |format|
        if @job.save
          format.html { redirect_to @job, notice: 'job was successfully created.' }
          format.json { render json: @job, status: :created, location: @job }
        else
          format.html { render action: "new" }
          format.json { render json: @job.errors, status: :unprocessable_entity }
        end
      end
    end

    def update
      @job = Job.find(params[:id])

      respond_to do |format|
        if @job.update_attributes(params[:job])
          format.html { redirect_to @job, notice: 'job was successfully updated.' }
          format.json { head :no_content }
        else
          format.html { render action: "edit" }
          format.json { render json: @job.errors, status: :unprocessable_entity }
        end
      end
    end

    def destroy
      @job = Job.find(params[:id])
      @job.destroy

      respond_to do |format|
        format.html { redirect_to :jobs }
        format.json { head :no_content }
      end
    end
  end 
```

任何指向正确方向的指针或点头将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:13:00.457

问题是因为 Activerecord 需要一个 Client 对象的实例，并且它有方法 client= （因为 belogs_to 关联）当您从请求绑定 AR 对象时，您应该使用 client_id 参数而不是 client

你可以阅读[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to)

如果客户端数量很短，您可以使用带有 client_id 作为名称的 select 示例[http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html)

所以你可以做这样的事情

```
select("job", "client_id", Client.all.collect {|c| [ c.name, c.id ] }, {:include_blank => 'None'}) 
```

代替

```
 f.text_field :client, :class => 'text_field' 
```

# oracle - Oracle 身份分析 (OIA) - 它是如何工作的以及公司如何使用它？

> ID：10504515
> 
> 赞同：0
> 
> 时间：2012-05-08T18:42:44.833
> 
> 标签：oracle

我希望进一步了解 Oracle 身份分析 (OIA) 以及它如何与其他 Oracle 身份管理 (OIM) 产品结合使用。例如，它在身份/访问管理中的作用是什么？公司通常如何使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:30:53.087

您可以将 OIA 视为帐户和权利仓库，当 OIM 更倾向于提供管理自动化（授予和撤销访问权限）时，您可以在其中找出谁有权访问什么。

在我工作的地方，我们主要将它用于身份审计。它涵盖了对违反职责分离的预防和反应。（例如，开发人员不应该拥有对生产环境的直接、高权限访问——这将是一种违规行为）。它是通过针对一组员工设计和执行身份审计策略和规则来完成的。

不幸的是，该工具有很多不足之处，因此需要在做出最终决定之前对其进行彻底测试。其中一些您可以通过编写一些小脚本来解决，但其中一些完全基于 Oracle（扩展、性能、WebUI），因此您可能需要等待了解有关 OIG（Oracle 身份治理套件）的更多详细信息他们在 2012 年 10 月宣布 ( [http://www.oracle.com/us/corporate/press/1859216](http://www.oracle.com/us/corporate/press/1859216) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-26T10:29:18.537

Oracle Identity Analytics (OIA) 允许您运行审计策略和角色管理，从而增强了 OIM 的供应、重新认证和特权访问组件。

OIM 允许您定义角色以自动化和简化配置，但它没有角色挖掘功能来根据谁已经访问了什么来建议角色。因此，在 OIM 中，您必须手动定义用户的角色。OIA 可以通过自下而上地查看数据以找到共性，从而部分自动化该过程。Oracle 建议采用混合方法，将两者结合起来。

审计政策旨在职责分离（或有害组合），允许您防止在存在利益冲突的情况下授予访问权限。一个典型的例子是在某些软件中提出支付请求的权限和批准支付请求的权限。这在高度监管的环境中尤其重要，例如银行和卫生部门。

在 OIM for Privileged Access 中，您通常不会使用 SoD 约束来让用户同时拥有非特权帐户和特权帐户。事实上，您可能希望用户默认使用标准帐户，然后通过紧急情况逐步升级以获取他们的密码并使用特权访问管理器来维护审计跟踪。比起 OIM 中包含的 Oracle 产品，我更熟悉 Cyber​​Ark。

在 Oracle Identity Governance 11g PS 2 下，许可协议应为您提供套件中的所有产品。随着时间的推移，甲骨文正在进一步整合这两种产品。

# php - 简单的照片共享站点：如何为多个用户及其照片构建 MySQL 数据库

> ID：10504517
> 
> 赞同：1
> 
> 时间：2012-05-08T18:42:54.620
> 
> 标签：php, mysql, database-schema, photos

我是一名学习 PHP 和 MySQL 的高中生。我正在尝试创建一个简单的照片共享网站，允许用户注册并开始上传图片。每个用户都有一个显示他们所有照片的个人资料。

我目前只有一张表，称为“用户”：用户名、电子邮件、密码

我应该如何为图片设置表格？以及如何链接到每张图片的文件路径？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:07:08.670

在您的用户表上创建一个名为 Id 的列（这永远不会改变）您通常为此使用类似 INT AUTOINCREMENT 编号的内容，因此数据库会自动分配它，并且应将其标记为 PRIMARY KEY

创建一个名为 photos 的表

```
Table photos
Id = autoincrement primary key
UserID = int (you can set this up as a foreign key, but to keep it simple, just make it indexed)
Title = varchar
Info = varchar
Filename = varchar

Table Photos
Id      |  UserId  | Title    | info | Filename  | (add other columns to suit)
------------------------------------------------------------
1       |  1       | Duck     | xyz  | duck.jpg  | 
2       |  1       | Cat      | xyz  | cat.jpg   | 
3       |  2       | Mouse    | xyz  | mouse.jpg | 
```

从上面的数据可以看出，照片 1 和 2 属于用户 1，照片 3 属于用户 2

要为用户名“bob”选择所有照片，您可以执行以下操作

```
SELECT Photos.Id, Photos.Filename 
FROM Photos 
JOIN Users ON Photos.UserId=Users.Id
WHERE Users.username = 'bob' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:50:07.367

第一个问题是您将用户的照片存储在哪里？我会推荐这个：

```
Table (User's):
Username | Password | Email
---------------------------
user1    | fdgfdg   | fdfgdf
user2    | ffdgfd   | fgdfgf
user3    | dgfdgg   | fgdgdd 
```

然后，每当用户注册时，使用该用户的姓名和标题为照片的子目录创建一个文件夹。

为每个用户创建一个表。

```
Table user1
Photo     | Title    | info
----------------------------
duck.jpg  | My Duck! | fgdf
cat.png   | Le Cat   | dfgd 
```

然后，当用户登录时，列出所有标题并将它们动态链接到照片。

所以我会

```
My Duck --> http://mysite.com/user1/photos/myduck.jpg 
```

其中 user1 是登录用户名，照片将自动添加，myduck.jpg 将从数据库中提取。

但是，这会带来两个漏洞： - 盗链 - 如果有人知道用户名和照片标题，他们可以在未经许可的情况下访问照片。

# python - 将代理模型实例分配给外键

> ID：10504521
> 
> 赞同：3
> 
> 时间：2012-05-08T18:43:03.957
> 
> 标签：python, django

我有一个 django auth 用户代理模型，它附加了一些额外的权限，如下所示：

```
class User(User):
    class Meta:
        proxy = True
        permissions = (
            ("write_messages","May add new messages to front page"),
            ("view_maps","Can view the maps section"),
        ) 
```

在模型的其他地方，我有一个以 User 作为外键的对象：

```
class Project(models.Model):
    creation_date   = models.DateTimeField(auto_now_add=True)
    modify_date     = models.DateTimeField(auto_now=True)
    owner           = models.ForeignKey(User) 
```

在我的一个观点中，我尝试使用当前用户作为所有者来创建一个新项目

```
@login_required
def new_project(request):
    project = Project.objects.create(owner=request.user) 
```

但是，这会返回错误：

```
Cannot assign "<User: mwetter>": "Project.owner" must be a "User" instance. 
```

我假设项目对象中的外键所有者是指 Django User 的基类而不是我的代理类。有没有办法将我的代理用户称为外键？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T19:12:49.807

除了@DavidRobinson 所说的之外，您还需要小心为代理模型创建外键。代理模型仍然是它所代理的模型的子类，尽管其所有意图和目的都与模型相同。如果您有代理的外键，它将不接受基类，但是基类的外键*将*接受代理。以以下为例。

鉴于：

```
class UserProxy(User):
    class Meta:
        proxy = True
    ...

class User(models.Model):
    ... 
```

以下将引发异常：

```
class SomeModel(models.Model):
    user = models.ForeignKey(UserProxy)

user = User.objects.get(username='some_user')
instance = SomeModel.objects.create(user=user) 
```

但是，以下将正常工作：

```
class SomeModel(models.Model):
    user = models.ForeignKey(User)

user = UserProxy.objects.get(username='some_user')
instance = SomeModel.objects.create(user=user) 
```

这是由于关系的方向性。`UserProxy` *is-a* *，*`User`但`User`不是a 。*`UserProxy`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:45:54.483

你为什么要调用你的代理类`User`，这肯定会导致和之间的混淆`django.contrib.auth.models.User`？为什么不`UserProxy`，或者`MyUser`？那么无论何时使用它都可以区分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:09:08.297

尝试分配 id 而不是 object

```
project = Project.objects.create(owner_id=request.user.pk) 
```*

# objective-c - NSSavePanel 不工作？

> ID：10504524
> 
> 赞同：0
> 
> 时间：2012-05-08T18:43:18.380
> 
> 标签：objective-c, cocoa, nssavepanel

如果我尝试使用不允许的扩展名，我无法让它显示任何警报。当我说“不允许”时，我的意思是我写了

```
setAllowsOtherFileTypes:FALSE 
```

但它不起作用。`@"jpg"`如果我将允许的文件类型设置为和`@"png"`（例如）的数组，然后我尝试保存“ `file.tif`”，我没有收到任何警报，结果文件名是“ `file.tif.jpg`”发生了什么？我在 MacOS 10.6.8，Xcode 3.2.6

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:19:32.217

```
NSSavePanel* savepanel = [NSSavePanel savePanel];
 // set the save panel to only do jpg and png file
    [savepanel setAllowedFileTypes:[NSArray initWithObjects:@"jpg", @"png",nil]];
    [savepanel setAllowsOtherFileTypes:YES];
 // run the panel
if ([savepanel runModal] != NSFileHandlingPanelOKButton)
  return NO; 
```

# python - 用 USB 控制电子元件？

> ID：10504527
> 
> 赞同：1
> 
> 时间：2012-05-08T18:43:30.533
> 
> 标签：python, usb, libusb

我想尝试一些我认为有点简单的东西。我想要一根带有 LED 的 USB 电缆，以及一个带有 2 个可能参数的 python 脚本：“on”和“off”。这将打开和关闭 LED（显然）。所以，任何了解软件的人都知道要使用哪些库（如果不是 libusb）以及如何使用它们，以及硬件人员，知道我如何制作所述电路吗？我不想关闭 USB 的电源，我只想更改电路中的某些内容以禁用 LED。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:14:51.047

USB是一种串行协议；您不能像以前设置并行端口引脚那样将其设置为“开”或“关”。

远端需要一些东西（即嵌入式微处理器）；计算机与驱动 LED 的微处理器对话。

看看[Arduino](http://www.arduino.cc/)；它们便宜、容易获得且易于使用。

**编辑：**试试[Teensy——](http://www.pjrc.com/teensy/)完全兼容 Arduino，16 美元，刚好超过 1 平方英寸，有一个 USB 端口和 25 个 I/O 引脚。

# php - 使用正则表达式查找 ID 中的大小

> ID：10504534
> 
> 赞同：0
> 
> 时间：2012-05-08T18:43:50.150
> 
> 标签：php, regex

我目前对 PHP 中的以下正则表达式有一个小问题：

```
preg_match_all('/(.*)(XS|S|M|XL|XXL|L)(.*)/i', '00236XL00', $arr, PREG_PATTERN_ORDER); 
```

在这种情况下，它会返回`L`我想要的大小。`XL`

如果我提供一个只有`L`（例如 002465L00）的 ID，它工作正常。

你能告诉我我做错了什么吗？

我尝试将`L`移到组的末尾，但没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:47:40.127

第一组 ,`(.*)`是贪婪的，会尽可能匹配。由于如果第一组“接受” `00236X`，第二组仍然会匹配，这就是将会发生的事情。如果上面提供的数据是典型的，最简单的解决方法是`.`将`[0-9]`. 这仍然与您的数据匹配吗？如果不是，请举出更多例子。

为避免贪婪，您可以使用`?`运算符使其他组变得懒惰。所以，类似的东西`/(.*?)(XS|S|M|XL|XXL|L)(.*)/i`应该可以工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T18:50:19.990

似乎您的 ID 只是尺寸代码周围的数字。
那么如何寻找`non-digit`角色呢？

```
preg_match_all('/([^0-9]+)/i', '00236XL00', $arr, PREG_PATTERN_ORDER); 
```

在作者评论后编辑：

```
preg_match_all('/[A-Z][A-Z]\-\d+([A-Z]+)\d+/i', 'XX-00236XL00', $arr, PREG_PATTERN_ORDER); 
```

# mysql - 可以将“in”与子查询（如任何/全部）一起使用吗？

> ID：10504536
> 
> 赞同：-1
> 
> 时间：2012-05-08T18:43:54.113
> 
> 标签：mysql, sql, postgresql

您可以使用 IN 而不是 ANY 来获取子查询的结果吗？我的意思是这样的：

`SELECT nazwisko FROM studenci WHERE rok_urodz > IN (SELECT rok_urodz FROM studenci WHERE miasto = "Warszawa");`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T18:47:39.087

不，这不是正确的语法，比较运算符仅对 ANY、SOME 和 ALL 有效。

如果将 'IN' 替换为 'ALL'，这也是可以的语法。要使用“IN”，您不能包含比较运算符。

```
SELECT nazwisko 
FROM studenci 
WHERE rok_urodz IN (SELECT rok_urodz FROM studenci WHERE miasto = 'Warszawa'); 
```

也是可接受的语法，但给出的结果不同于

```
SELECT nazwisko 
FROM studenci 
WHERE rok_urodz > ALL (SELECT rok_urodz FROM studenci WHERE miasto = 'Warszawa'); 
```

IN 等价于 = ANY

来源：[http ://dev.mysql.com/doc/refman/5.0/en/any-in-some-subqueries.html](http://dev.mysql.com/doc/refman/5.0/en/any-in-some-subqueries.html)

# matlab - 将分布拟合到数据 - MATLAB

> ID：10504539
> 
> 赞同：5
> 
> 时间：2012-05-08T18:44:03.903
> 
> 标签：matlab, statistics, distribution

我正在尝试将分布拟合到我从显微镜图像中收集的一些数据中。我们知道大约 152 处的峰值是由泊松过程引起的。我想将分布拟合到图像中心的大密度，同时忽略高强度数据。我知道如何将正态分布拟合到数据（红色曲线），但它不能很好地捕捉右侧的重尾。虽然泊松分布应该能够将尾部建模到右侧，但它也做得不是很好（绿色曲线），因为分布的众数为 152。

```
PD = fitdist(data, 'poisson'); 
```

lambda = 152 的泊松分布看起来非常像高斯分布。

有谁知道如何拟合能够很好地捕获数据右尾的分布？

![在此处输入图像描述](../Images/ad730541dfdfc76bb7214bcf625d8583.png)

[链接到显示数据的图像以及我在分布拟合方面的尝试。](https://imgur.com/E398u)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T20:06:49.233

该分布看起来有点像[前高斯](http://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution)分布（参见第一个维基百科图中的绿线），即正态随机变量和指数随机变量的混合模型。

在旁注中，您是否知道，虽然泊松过程的事件是泊松分布的，但事件之间的等待时间是指数分布的？鉴于在您的测量中添加了高斯噪声，理论上可能存在前高斯分布。（当然这并不意味着这也是有道理的。）

可以在 MatLab 中找到有关使用 MatLab 拟合前高斯的教程

> Lacouture Y, Cousineau D. (2008) 如何使用 MATLAB 将前高斯和其他概率函数拟合到响应时间的分布。心理学定量方法教程 4 (1), p。35-45。 [http://www.tqmp.org/Content/vol04-1/p035/p035.pdf](http://www.tqmp.org/Content/vol04-1/p035/p035.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T18:53:57.927

看看这个：http: [//blogs.mathworks.com/pick/2012/02/10/finding-the-best/](http://blogs.mathworks.com/pick/2012/02/10/finding-the-best/)

它审查了以下关于拟合分布的 FEX 提交：http: [//www.mathworks.com/matlabcentral/fileexchange/34943](http://www.mathworks.com/matlabcentral/fileexchange/34943)

# facebook - Facebook opengraph中的奇怪错误

> ID：10504542
> 
> 赞同：1
> 
> 时间：2012-05-08T18:44:11.157
> 
> 标签：facebook, facebook-opengraph

我正在尝试使用 js sdk 发布一个动作。

我的行动代码是

```
 function watchvid()
  {
      FB.api(
        '/me/video.watches?video=http://watchvideoz.in/watch.php?v=34',
        'post',
        function(response) {
           if (!response || response.error) {

              alert(JSON.stringify(response.error)); 
           } else {
var a = response.id;
    MyApp.color = a;

           }
        });
  } 
```

我的元标签是

```
<meta property="og:url" content="http://watchvideoz.in/watch.php?v=34"/>    
<meta property="fb:app_id" content="288976161189701"/>  
<meta property="og:title" content="Buckys C++ Programming Tutorials - 9 - Functions"/> 
<meta property="og:type" content="video.other" />
<meta property="og:image" content="http://img.youtube.com/vi/bsWWHo4KDHE/hqdefault.jpg"/>   
<meta property="og:description" content="For all of our videos, visit http://thenewboston.com"/>
<meta property="og:site_name" content="YourVidz"/> 
```

但我收到以下错误

```
{"message":"(#3502) Object at URL http://watchvideoz.in/watch.php?v has og:type of 'website'. The property 'video' requires an object of og:type 'video.other'. ","type":"OAuthException","code":3502} 
```

在上面的错误中，它忽略了**=**之后的值，即 它只检索**http://watchvideoz.in/watch.php?v**

尽管 fb 调试器工具正在检索正确的值

[http://watchvideoz.in/watch.php?v=34](http://watchvideoz.in/watch.php?v=34)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:59:17.933

如果您将 url 作为查询字符串参数传递，则需要对其进行“url 编码”，以便 '?' 并且您自己的查询字符串中的 '&' 不会与“父”网址中的那个混淆。试试[http://watchvideoz.in/watch.phpp%3Fv%3D34](http://watchvideoz.in/watch.phpp%3Fv%3D34)

# python - 从python编写fortran有序二进制文件

> ID：10504543
> 
> 赞同：3
> 
> 时间：2012-05-08T18:44:11.157
> 
> 标签：python, numpy, fortran, scipy

我有一些 python 代码生成一个 256^3 numpy 数据数组，我想用不同的 fortran 代码读取这些数据。

如果 numpy ndarray 函数 tofile() 具有写入 fortran 有序数据的选项，这将相对容易，但它不会并且将始终写入 C 有序数据。是否有等效的功能（可能在 scipy 中？）可以满足我的要求？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T18:55:38.683

您可以[`transpose`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.transpose.html)在将其写出之前创建数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-25T10:12:25.607

`numpy.asfortranarray()`可以帮助您实现目标。

假设`data`是一个256^3的numpy数组，代码片段如下所示

```
import numpy as np

np.asfortranarray(data).tofile('.../.../fortran_unformatted_data.dat') 
```

# html - 可以有一个空的锚标签吗？

> ID：10504544
> 
> 赞同：12
> 
> 时间：2012-05-08T18:44:12.397
> 
> 标签：html, css

我知道如果我想将图像变成可点击的链接，我可以执行以下操作：

```
<a href="http://twitter.com/username"><img src="icons/twitter.png" /></a> 
```

但我更喜欢使用 CSS 背景图像，这样我就可以有一个悬停状态：

```
<a class="twitter" href="http://twitter.com/username"></a>

# css
.twitter{display:block; width:16px; height:16px; background:url("twitter.png")} 
```

这很好用，但我不确定拥有一个不包含任何内容的锚链接是否完全有效。Chrome 渲染得很好，FF 也一样，但我不确定其他人是否相同。

我意识到我可以在链接中放一些文本，然后用 隐藏它，但由于[各种](http://luigimontanez.com/2010/stop-using-text-indent-css-trick/)[原因](http://maileohye.com/html-text-indent-not-messing-up-your-rankings/)`text-indent: -9999px`，我从不喜欢这种方法。我上面的代码是否跨浏览器兼容？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T18:47:31.187

这是有效的，但最好是你确实在里面放了一些东西并使用了类似的东西

```
font-size: 0; 
```

把它藏起来。这样，如果某人没有 CSS（例如屏幕阅读器），他仍然能够大致了解链接的内容。

**[这是一篇关于这个主题的好文章](http://css-tricks.com/css-image-replacement/ "CSS 图像替换 @ CSS-Tricks.com")**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-08T19:35:39.670

这根本不行，因为它违反了基本的可访问性原则。无法为背景图像指定替代文本，就像您可以并且应该使用内容图像`alt`的标签中的属性来指定它一样。`img`请参阅 WCAG 2.0[指南 1.1](http://www.w3.org/TR/WCAG/#text-equiv)。

如果您希望在鼠标悬停时更改图像，可以使用 CSS 和 JavaScript 技术。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-08T18:45:53.137

这是完全有效的，但如果你愿意，你可以在里面放一个空格：`&nbsp`;

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-08T20:02:22.273

使用   作为文本，你很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-05T23:01:24.503

在 Markup.tips，我们最近在 iOS 8 中进行了一些可访问性测试，发现 VoiceOver 不会导航到空链接。至少必须有一个不间断的空间。我们不确定这是否应该被视为 iOS 错误。

# iis-7.5 - 无法创建网站“http://www.example.com”。成立

> ID：10504546
> 
> 赞同：1
> 
> 时间：2012-05-08T18:44:17.793
> 
> 标签：iis-7.5

每当我尝试在*Visual Web Developer Express 2008*或*2010*`File/New Website`中使用 HTTP 的 Web 位置时。我得到错误：

 **> 无法创建网站“http://www.example.com”。成立

我尝试了*MS Visual Express Developer 2008*和*2010*并获得了相同的结果。我尝试了三台不同的机器并得到相同的错误。我已经为*IIS 7.5安装了**Front Page Server*扩展并且得到了同样的错误。

 *看来这可能是某种设置问题，但我找不到。

有人知道我缺少什么吗？***

# git - 您如何保留不起作用的代码？

> ID：10504547
> 
> 赞同：6
> 
> 时间：2012-05-08T18:44:21.687
> 
> 标签：git, version-control

在开发过程中，我有时会尝试一种不会立即成功的技术或方法。一旦我决定继续执行另一项任务或为同一任务尝试另一种技术，我永远不确定如何处理非工作代码。我想把它作为我尝试过的东西的记录，所以我知道什么没用，甚至可以作为尝试让它再次工作的起点。

通常我只是将代码留在原处，注释掉并且未提交给 VCS 一段时间。然而，这变得很痛苦，因为它使代码混乱，并且必须在 VCS 提交时回避。我碰巧正在使用 git，它具有用于临时存储的“stash”功能，但我不确定这是否合适。

您如何处理想要为后代保存但又不想成为主流代码库的一部分的代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T18:49:21.357

树枝！

1.  自由使用分支（jQuery_slider_nivo、jQuery_slider_zurb 等）
2.  没错，stash 不是长时间存储此代码的地方
3.  如果您想检查代码，只需切换到该分支
4.  如果你想要它回来简单地合并分支

您还可以执行存档操作（ $ = console ）：

1.  归档它： $ git checkout -b archive/<branchname> <branchname>
2.  删除它： $ git branch -d <branchname>
3.  恢复它： $ git checkout -b <branchname> archive/<branchname>

其中 <branchname> == TotallyAwesomeBranchName

...或任何你命名的分支=]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-08T18:47:57.713

每次启动“任务”时，都会创建一个分支。您可以稍后保留您在该分支上尝试的所有内容，并将工作代码提交给 master。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:49:38.610

您可能已经为您的功能创建了一个单独的分支，例如`feature/doSomethingCool`. 您现在可以将这个（不太酷的）分支移开，例如

```
git branch -m feature/doSomethingCool archive/doSomethingCool-try1 
```

`feature/doSomethingCool`并从中创建一个新分支`develop`。使用`archive/doSomethingCool-try1`-branch，您可以做任何您想做的事，甚至可以忽略或删除。

*   [手册页`git-branch`](http://linux.die.net/man/1/git-branch)
*   [`git-branch`在酷炫的新 git-scm.com 主页上](http://git-scm.com/docs/git-branch)

# java - 如何将 GoogleSpellChecker 与 SpringMVC 与 ServletWrappingController 集成

> ID：10504548
> 
> 赞同：0
> 
> 时间：2012-05-08T18:44:21.937
> 
> 标签：java, servlets, spring-mvc

目前，我的应用程序对我的所有控制器映射都使用 SpringMVC。**我正在尝试实现 tinyMCE 拼写检查，它包含一个 Servlet，我不确定如何在不修改此文件本身**的情况下正确集成。我想避免修改，这样如果我们以后有新版本就可以了。

Servlet 看起来像...

```
public abstract class TinyMCESpellCheckerServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    private static Logger logger = Logger.getLogger(TinyMCESpellCheckerServlet.class.getName());

    private static final String MAX_SUGGESTIONS_COUNT_PARAM = "maxSuggestionsCount";
    private static final String PRELOADED_LANGUAGES_PARAM = "preloadedLanguages";

    private static final String DEFAULT_LANGUAGE = "en";
    private static final String GET_METHOD_RESPONSE_ERROR = "This servlet expects a JSON encoded body, POSTed to this URL";

    private static String DEFAULT_PRELOADED_LANGUAGES = "en-us";

    private enum methods {
        checkWords, getSuggestions
    }

    private int maxSuggestionsCount = 25;

    @Override
    public void init() throws ServletException {
        super.init();
        preloadSpellcheckers();
        readMaxSuggestionsCount();
    }

    private void preloadSpellcheckers() throws ServletException {
        String preloaded = getServletConfig().getInitParameter(PRELOADED_LANGUAGES_PARAM);
        if (preloaded == null || preloaded.trim().length() == 0) {
            preloaded = DEFAULT_PRELOADED_LANGUAGES;
        }

        String[] preloadedLanguages = preloaded.split(";");
        for (String preloadedLanguage : preloadedLanguages) {
            try {
                preloadLanguageChecker(preloadedLanguage);
            } catch (SpellCheckException e) {
                //wrong servlet configuration
                throw new ServletException(e);
            }
        }
    }

    protected abstract void preloadLanguageChecker(String preloadedLanguage) throws SpellCheckException;

    /**
     * This method look for the already created SpellChecker object in the cache, if it is not present in the cache then
     * it try to load it and put newly created object in the cache. SpellChecker loading is quite expensive operation
     * to do it for every spell-checking request, so in-memory-caching here is almost a "MUST to have"
     *
     * @param lang the language code like "en" or "en-us"
     * @return instance of SpellChecker for particular implementation
     * @throws SpellCheckException if method failed to load the SpellChecker for lang (it happens if there is no
     *                             dictionaries for that language was found in the classpath
     */
    protected abstract Object getChecker(String lang) throws SpellCheckException;

    private void readMaxSuggestionsCount() throws ServletException {
        String suggestionsCountParam = getServletConfig().getInitParameter(MAX_SUGGESTIONS_COUNT_PARAM);
        if (suggestionsCountParam != null && suggestionsCountParam.trim().length() > 0) {
            try {
                maxSuggestionsCount = Integer.parseInt(suggestionsCountParam.trim());
            } catch (NumberFormatException ex) {
                //wrong servlet configuration, possibly a typo
                throw new ServletException(ex);
            }
        }
    }

    /**
     * @see javax.servlet.Servlet#destroy()
     */
    public void destroy() {
        super.destroy();
        //remove unused objects from memory
        clearSpellcheckerCache();
    }

    protected abstract void clearSpellcheckerCache();

    /**
     * GET method is not supported
     * @see HttpServlet#doGet(javax.servlet.http.HttpServletRequest request, javax.servlet.http.HttpServletResponse
     *      response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        setResponeHeaders(response);
        PrintWriter pw = response.getWriter();
        pw.println(GET_METHOD_RESPONSE_ERROR);
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse
     *      response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        setResponeHeaders(response);
        try {
            JSONObject jsonInput = readRequest(request);

            String methodName = jsonInput.optString("method");
            if (methodName == null || methodName.trim().equals("")) {
                throw new SpellCheckException("Wrong spellchecker-method-name:" + methodName);
            }

            JSONObject jsonOutput = new JSONObject("{'id':null,'result':[],'error':null}");
            switch (methods.valueOf(methodName.trim())) {
                case checkWords:
                    jsonOutput.put("result", checkWords(jsonInput.optJSONArray("params")));
                    break;
                case getSuggestions:
                    jsonOutput.put("result", getSuggestions(jsonInput.optJSONArray("params")));
                    break;
                default:
                    throw new SpellCheckException("Unimplemented spellchecker method {" + methodName + "}");
            }

            PrintWriter pw = response.getWriter();
            pw.println(jsonOutput.toString());

        } catch (SpellCheckException se) {
            logger.log(Level.WARNING, se.getMessage(), se);
            returnError(response, se.getMessage());
        } catch (Exception e) {
            logger.log(Level.WARNING, e.getMessage(), e);
            returnError(response, e.getMessage());
        }

        response.getWriter().flush();
    }
..... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:59:30.493

看看`ServletWrappingController`（[javadoc](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/servlet/mvc/ServletWrappingController.html)）

> `Controller`包装了它在内部管理的 servlet 实例的Spring实现。这种包装的 servlet 在此控制器之外是未知的；此处涵盖了它的整个生命周期（与 相比`ServletForwardingController`）。
> 
> 通过 Spring 的调度基础设施调用现有的 servlet 很有用，例如将 Spring HandlerInterceptors 应用于其请求。

在您的 Spring 上下文中配置其中之一，使用您的 TinyMCE servlet 类名称对其进行配置，并使用`SimpleUrlHandlerMapping`.

`ServletForwardingController`也有用，但略有不同。

# css - 响应标签的css下拉菜单

> ID：10504555
> 
> 赞同：0
> 
> 时间：2012-05-08T18:44:33.470
> 
> 标签：css, drop-down-menu

是否可以创建一个响应选项卡的纯 CSS 下拉菜单？我已经能够创建一个仅响应 CSS 的下拉菜单，`:hover`但我还没有成功`:focus`开始工作。`li`当我专注于其中嵌套的一个时，我可以显示我的下拉菜单`ul`，但我不确定如何能够仅使用 CSS 来标记这些元素。

是否可以在仅 CSS 的下拉菜单中允许选项卡，还是仅限于使用鼠标？

# mediaelement.js - mediaelement.js 中控件的大小如何

> ID：10504557
> 
> 赞同：5
> 
> 时间：2012-05-08T18:44:41.393
> 
> 标签：mediaelement.js

我将 mediaelement.js 用于可用空间有限的音频播放器。我需要为控件添加自定义样式，并完成大部分 CSS。我遇到麻烦的地方是 mediaelement.js 脚本将 CSS 宽度应用于某些控制元素。我愿意修改我的 CSS 来弥补这一点，但我不确定 mediaelement.js 为达到其计算宽度所经历的过程。

那么 mediaelement.js 计算其控件大小的步骤是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T17:04:12.687

找到了解决问题所需的东西：网站上没有记录，但 mediaelement.js 允许将选项设置为“autosizeProgress”，默认为 true。将此设置为 false 允许将进度条设置为特定大小，这使得我的实例中的控件样式*更加*容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-01T16:14:01.650

# 问题：

我想用这个适用于 IPAD 的控件替换我所有客户的教堂和事工网站上的旧的仅 Flash 控件，但旧控件在只有 180 像素宽度时工作正常，而这个没有，当然不适用于更长的剪辑。***（MediaElement.js 版本：2.13.1）***

## 初步测试：

![180px 和 240px 宽的原始控件](../Images/f1ea5f0ed809c83bd9cd49b191bca07b.png)

* * *

# 解决方案：

如果渲染控件的大小被计算为太小而无法容纳它们， 您可以以**编程**方式使音频播放器自动**调整音量控件**的大小并**隐藏持续时间。**

进行这些更改后，控件仍然可以在低至**160px**的宽度下使用（如果有点紧）

* * *

## 音量控制宽度的 CSS 设置：

初始水平音量控制宽度（用于音频模式）在**mediaelementplayer.css**中设置：

```
/* horizontal version */
.mejs-controls div.mejs-horizontal-volume-slider {
    height: 26px;
    width: 60px;         /* <== this line */
    position: relative;
} 
```

... 和这里：

```
.mejs-controls .mejs-horizontal-volume-slider .mejs-horizontal-volume-total {
    position: absolute;
    left: 0;
    top: 11px;
    width: 50px;        /* <== and this line */ 
```

...**但不要管这些**以自动设置它们 - 我会在一分钟内向您展示。

* * *

## 怎么做：

首先，如果显示小于 260 像素，要让持续时间控件自动隐藏，请对**mediaelement-and-player.js**进行以下更改：

```
buildduration: function(player, controls, layers, media) {
    var t = this;
    if (parseInt(t.width)<260){ return; } // Add this to hide duration if width < 260px 
```

如果总宽度小于 220 像素，现在要将音频的音量控制从 60 像素减少到 30 像素，请对**mediaelement-and-player.js**进行以下两项更改：

改变这个：

```
'<div class="mejs-horizontal-volume-slider">'+ // outer background
    '<div class="mejs-horizontal-volume-total"'></div>'+ // line background 
```

...对此：

```
'<div class="mejs-horizontal-volume-slider"'+
  (parseInt(t.width)<220 ? ' style="width:30px"' : '')+
  '>'+ // outer background
    '<div class="mejs-horizontal-volume-total"'+
      (parseInt(t.width)<220 ? ' style="width:20px"' : '')+
      '></div>'+ // line background 
```

* * *

## 代码修改后的测试描述：

以下是不同大小的长声音片段（大于 1 小时）的外观，全部暂停在 30 分钟，因此您可以查看它们的比较：

![mediaelement.js 控制自动调整大小测试](../Images/5ba3bd109e8f21d00e1f429ee41c7201.png)

我希望这是有用的，并真诚地感谢 John Dyer 提供了这个令人惊叹的系统，并让我们所有人都可以使用它。

# sitecore - Sitecore Axes.IsDescendantOf / Axes.IsAncestorOf - 包含？

> ID：10504570
> 
> 赞同：4
> 
> 时间：2012-05-08T18:45:36.600
> 
> 标签：sitecore, sitecore6, items

是否有我遗漏的原因或某些东西使 Sitecore`true`对`Item.Axes.IsDescendantOf()`和都返回`Item.Axes.IsAncestorOf()`？

```
var test =
Sitecore.Context.Database.GetItem("{862B466A-079B-40E7-8661-FC064EC28574}");  
Response.Write(test.Axes.IsAncestorOf(test));  
Response.Write(test.Axes.IsDes(test)); 
```

> //真
> //真

**编辑**：任何可能偶然发现此答案的人寻找非包容性`IsAncestorOf`或`IsDescendantOf`，下面是几个示例，我需要在新闻类别的多选字段中找到最高级别的元素。

```
newsCategories
   .Where(x => newsCategories
                       .Any(y => x != y && !x.Axes.IsDescendantOf(y))) 
```

和

```
newsCategories
   .Where(x => newsCategories
                       .Any(y => x != y && !x.Axes.IsDescendantOf(y))) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T20:24:02.047

我不得不相信 Sitecore 中的方法**不**应该命名`IsAncestorOf`为`IsDescendantOf`. 根据您的发现并快速查看 Sitecore 代码，这些方法实际上应该命名`IsAncestorOrSelf`为`IsDescendantOrSelf`.

对于这个例子，

```
Sitecore.Data.Items.Item x = //some item;
Sitecore.Data.Items.Item y = //some item;
x.Axes.IsAncestorOf(y)
x.Axes.IsDescendantOf(y) 
```

`IsAncestorOf`方法是比较`x.ID == y.ID`。然后它将继续与`x.ID`y`ID`的父母进行比较，这就是为什么它应该被命名为`IsAncestorOrSelf`。

该`IsDescendantOf`方法是比较 的路径是否与的`LongID`路径`x`开始。由于字符串总是以相同的字符串开头，我们再次看到该方法应该命名为.`LongID``y``IsDescendantOrSelf`

仅供参考，`LongID`路径看起来像这样`/{11111111-1111-1111-1111-111111111111}/{0DE95AE4-41AB-4D01-9EB0-67441B7C2450}/{110D559F-DEA5-42EA-9C1C-8A5DF7E70EF9}`，我怀疑它被使用，而不是`/sitecore/content/home`为了绕过 sitecore 允许兄弟姐妹具有相同名称的事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:00:00.123

您在 Sitecore 逻辑中遇到了“故障保险”。这是因为您正在对照它自己检查相同的项目。您需要使用 2 个不同的项目执行此操作才能产生任何结果。

# scala - 有没有办法在 scala 中使用变量之间的两个标识符创建无点 dsl？

> ID：10504574
> 
> 赞同：8
> 
> 时间：2012-05-08T18:45:46.100
> 
> 标签：scala

有没有办法定义一个 dsl，这将允许以下形式？

```
variable identifier identifier variable 
```

例如：

```
1 equals to 2 
```

我知道如何创建一个更简单的表单：`1 equals to (2)`，但我想避免使用括号。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-08T19:21:22.340

你可以问解析器：

```
$ scala -Xprint:parser
Welcome to Scala version 2.9.2 ... blah

scala> variable1 identifier1 identifier2 variable2
// lots of stuff and inside:
val res0 = variable1.identifier1(identifier2).variable2
// this is how the parser sees it.
// if you can make that work (dynamic classes…?), you’re good to go. 
```

但是，有一个问题：这只适用于`variable2`标识符（以便它可以用作方法名称）。和

```
scala> 1 equals to 2 
```

解析器已经失败：

```
<console>:1: error: ';' expected but integer literal found.
       1 equals to 2
                   ^ 
```

括号确实是您唯一的解决方法（*）：

```
scala> 1 equals to (2)
// ...
val res1 = 1.equals(to(2)) 
```

* * *

(*) 除非您`2`通过将其与反引号一起使用来创建标识符

```
scala> 1 equals to `2`
// ...
val res2 = 1.equals(to).2 
```

……不，也许不是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:42:17.400

据我所知，目前不可能按照您的意愿实施（我很高兴被证明是错误的）。当我创建用于注入的小型 DSL 时，我也遇到了这个问题。但是我已经意识到，即使两个标识符之间不能有 2 个变量，它们之间仍然可以有三个标识符。它看起来像这样：

```
variable1 method constant method variable2 
```

这与以下内容相同：

```
variable1.method(constant).method(variable2) 
```

有了这个，我能够想出看起来像这样的非常好的 DSL：

```
by default defaultDb and identified by 'remote
'remote is by default defaultDb 
```

您可以在此规范中找到更多使用示例：

[https://github.com/OlegIlyenko/scaldi/blob/48f7e4186cf7eb441116087003d7f45f16e0ac6c/src/test/scala/scaldi/InjectableSpec.scala#L47](https://github.com/OlegIlyenko/scaldi/blob/48f7e4186cf7eb441116087003d7f45f16e0ac6c/src/test/scala/scaldi/InjectableSpec.scala#L47)

它的实现可以在这里找到：

[https://github.com/OlegIlyenko/scaldi/blob/master/src/main/scala/scaldi/Injectable.scala](https://github.com/OlegIlyenko/scaldi/blob/master/src/main/scala/scaldi/Injectable.scala)

我使用`ByWord`和`IdentifiedWord`类类型作为方法参数。例如：

```
def is(by: ByWord) = and(by) 
```

这留下了可能性，图书馆的用户将扩展`ByWorld`类并且通常可以提供他们自己的`ByWorld`实现。现在回想起来，我觉得这不是很好。更好的解决方案是为常量词创建单例对象，然后像这样使用它们的类型：

```
object by
def is(byWord: by.type) = and(by) 
```

这通常将参数限制为仅一个可能的`by`单词实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-21T14:52:20.917

### [一元运算符](https://stackoverflow.com/a/1014972/1287856)

好吧，如果最后一个是一元运算符，您可以有两个连续的标识符：

```
a identifier1 - d 
```

被解析为

```
a.identifier1(d.unary_-) 
```

请注意，一元函数只能是 ! 〜和 -

### [动态方法](https://stackoverflow.com/questions/15799811/how-does-type-dynamic-work-and-how-to-use-it)

如果您不介意将您的最后一个变量名称视为字符串（例如，您可以稍后从映射或[解释器本身](https://stackoverflow.com/a/14223796/1287856)检索其值），您可以使用动态进行以下操作：

```
import scala.Dynamic
import scala.language.dynamics

class I2
class Res(i: I2) extends Dynamic {
  def selectDynamic(obj: String): Unit = {
      println(obj)
    }
}
class V1 { def i1(i2: I2): Res= new Res(i2) }
val v1 = new V1
val i2 = new I2

v1 i1 i2 v2 
```

结果为字符串“v2”。

# java - BeyondCompare 用于 .properties

> ID：10504579
> 
> 赞同：2
> 
> 时间：2012-05-08T18:45:55.747
> 
> 标签：java, file, configuration, editor, beyondcompare

我正在使用 BeyondCompare 来比较文件，对此我非常满意。但是，我也想比较和交叉编辑两个 .properties 文件。具体很明显 - 我不关心名称/值对的顺序，但我关心重复等。有人知道（或还需要）这样的应用程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:18:43.963

保存时有一个技巧可以[按键名对属性进行排序](http://www.rgagnon.com/javadetails/java-0614.html)。

或者在比较它们之前对两个文件进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-23T16:44:26.840

我找到了一种对我非常有效的方法。

据我所知，这种方法的唯一问题是，当您保存使用 Beyond Compare 所做的任何更改时，属性文件会变得一团糟；因此您需要在保存或在 Beyond Compare 之外进行更改之前选择文件格式“<default>”。

基于[消息 #2](http://www.scootersoftware.com/vbulletin/showthread.php?13877-compare-text-to-first-character)及其[包含](http://www.scootersoftware.com/support.php?zz=kb_unimportantv3)的链接。我正在使用 BC v3.3.13

诀窍是创建一种特殊的文件格式：

1.  前往菜单`Tools / File Formats...`
    *   创建（单击左下角`new`按钮）或...
    *   修改一个（选择它）
2.  为其设置一个正确的名称：`Properties`
3.  在`General`选项卡中设置掩码：`*.properties`
4.  在`Conversion`选项卡集中`Sorting`
5.  在`Gramar`选项卡 中
    *   键=值
        1.  点击`New`按钮
        2.  设置正确的名称：`Equal sign to the end`
        3.  单击名为的单选按钮`Delimited`
        4.  在字段中输入等号 ( `=`)`Text from:`
        5.  设置复选框命名`Stop at end of line`
    *   注释
        1.  点击`New`按钮
        2.  设置正确的名称：`Comments`
        3.  单击名为的单选按钮`Delimited`
        4.  在该字段中放置一个尖号 ( `#`)`Text from:`
        5.  设置复选框命名`Stop at end of line`
6.  点击`Save`按钮或按下`Alt-S`
7.  关闭显示的对话框
8.  按重新加载工具栏图标，或手动选择新文件格式

[![比较示例](../Images/0bdc7d691f8d76e476aac1e2ecc5dcb6.png)](https://i.stack.imgur.com/0hVzz.png)

9.  您可以告诉 Beyond 比较等号后和尖号后的文本并不重要：
    1.  单击`rules`工具栏图标（戴帽子的人）（在上图中的蓝色椭圆内显示）
    2.  转到`Importance`选项卡
    3.  删除两个语法元素中的检查：

[![在此处输入图像描述](../Images/88f2a127356edc859f03ab7711a8e445.png)](https://i.stack.imgur.com/FG7YZ.png)

```
4\. Press the `Ok` button 
```

*   Note Beyond Compare 在我添加到第一张图像的两个红色椭圆中显示了文件格式
*   注意 Beyond Compare 告诉您文件未按文件系统中的方式显示，但如果您看到显示的椭圆右侧的文本，它们将被转换（排序）。

希望它可以帮助某人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T15:21:23.340

尝试使用`Sorted`格式进行比较。

![BC 排序格式](../Images/112b7340efc5d2ac4d208a3535f8e158.png)

# python - 为什么我不能将文件目录存储在一个变量中以供 csv.reader(file()) 使用？

> ID：10504584
> 
> 赞同：1
> 
> 时间：2012-05-08T18:46:12.153
> 
> 标签：python, variables, filepath

我需要将文件目录存储在一个变量中，因为它将在以后使用。在下面的脚本中，我想打印出内容，但我得到了一个`TypeError: 'file' object is not callable`.

剧本：

```
posfile = 'C:/Users/name/Desktop/textfile.txt'
csv_data=csv.reader(file(posfile))
count_test = 0
for row in csv_data:
    count_test = count_test + 1
    print count_test, row 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T18:50:32.003

尝试：

```
posfile = 'C:/Users/name/Desktop/textfile.txt'
csv_data=csv.reader(open(posfile, 'rb'))
count_test = 0
for row in csv_data:
    count_test = count_test + 1
    print count_test, row 
```

您可能还想检查您是否没有在代码中的其他位置更改文件的值。

```
file(posfile) 
```

应该管用。

如果你做了类似 file = somefile. 在代码的前面，您可能会遇到问题。因为 file 不再是一个文件对象。

# c - 表达式的确切类型是什么：添加两个 unsigned char 类型的值

> ID：10504590
> 
> 赞同：2
> 
> 时间：2012-05-08T18:46:43.237
> 
> 标签：c, visual-c++

```
unsigned char c0=255,c1=1;
char c2=c0+c1;   //(1) 
```

没有任何警告（/W4），c2 为 0

```
int i=c0+c1;    //(2) 
```

没有任何警告（/W4），我是 256

表达式（c0+c1）的类型是什么？如果是 unsigned char，为什么不是 (2) 中的 0。如果是 int，为什么 (1) 中没有警告。

它似乎与“整数提升”有关。

帮助！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:18:17.090

```
unsigned char c0=255,c1=1;
char c2=c0+c1; 
```

`c0 + c1`是类型`int`，它的计算结果为`256`. 此`int`值`char`在分配给 时转换为`c2`。不需要警告，因为您始终可以分配任何不同算术类型的操作数。（从技术上讲，这是一个初始化，但相同的类型和转换约束适用于赋值和初始化）。

```
int i=c0+c1; 
```

`c0 + c1`仍然是类型`int`，并且在分配期间没有发生转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:00:00.030

在情况 1 中，类型是*unsigned char*，因为您已将 c2 的类型指定为 unsigned char，而在情况 2 中，类型是*int*，因为您已将 i 的类型指定为 int。

# android - openOrCreateDatabase 错误

> ID：10504596
> 
> 赞同：0
> 
> 时间：2012-05-08T18:47:15.730
> 
> 标签：android

```
public class DBActivities {
    private final String tableName = "Table_SMS";
    private final String CREATE_TABLE_SMS = "CREATE TABLE " + tableName + "(" + "db_date TEXT " + "db_sms_count INTEGER);";
    private SQLiteDatabase db;

    public DBActivities() {
        DoDBInitialization();
    }

    private void DoDBInitialization() {
        db = openOrCreateDatabase(tableName, 0, null);
        db.setVersion(1);
        db.setLocale(Locale.getDefault());
        db.setLockingEnabled(true);
    } 
```

我收到错误消息“未为 DBActivities 类型定义方法 openOrCreateDatabase(String, int, null)”。这里有什么问题？DBActivities 类被主类用于所有与数据库相关的活动。

我做了一些研究，并尝试使用：

```
db = openOrCreateDatabase(tableName, null, Context.MODE_PRIVATE); 
```

结果还是一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:56:44.790

这是一个基本的 java 错误。您正在尝试调用一个不存在的函数。

openOrCreateDatabase(...) 未在您的代码中定义。

请参阅本教程：[http ://www.vogella.com/articles/AndroidSQLite/article.html](http://www.vogella.com/articles/AndroidSQLite/article.html)

您可能希望使用以下内容扩展 SQLiteOpenHelper：

```
private static class DbHelper extends SQLiteOpenHelper {

    public DbHelper(Context context, String name,
            CursorFactory factory, int version) {
        super(context, name, factory, version);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(DATABASE_CREATE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        //called when the version of the existing db is less than the current
        Log.w(this.getClass().getName(), "Upgrading db from "+oldVersion+" to "+newVersion);
        db.execSQL("DROP TABLE IF EXISTS "+DATABASE_TABLE);
        onCreate(db);
    }

} 
```

# javascript - Javascript 显示/隐藏无法在 Safari 中正确隐藏

> ID：10504597
> 
> 赞同：0
> 
> 时间：2012-05-08T18:47:20.320
> 
> 标签：javascript, show-hide

在 Safari 中显示/隐藏似乎是一个问题。该网站看起来不错新加载。但是，如果您单击左上角的第一个链接而不是返回，则显示/隐藏功能不再那么好用，并且您会得到彼此叠加的图层。注意：此问题仅在 Safari 中出现。

我使用过 jQuery，这是我的显示隐藏代码：

```
 <script type="text/javascript">
  function show(id) {
    document.getElementById(id).style.visibility = "visible";
  }
  function hide(id) {
    document.getElementById(id).style.visibility = "hidden";
  }
 </script> 
```

网站链接：[http ://www.smudesign2012.co.uk/](http://www.smudesign2012.co.uk/)

![在此处输入图像描述](../Images/2338bd9ec491bae9822a6bf705f38193.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:51:32.237

我建议你使用 jquery 来显示/隐藏元素。

```
function show(id){
    $('.student').hide(); // hide all students
    $('#'+id).show(); // show the student with applied ID
}

function hide(id){
    $('#'+id).hide(); // is this needed? Why not do the next one and skip the parameter to the function?
    $('.student').hide();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:52:01.517

试试这个并注意**.style.display的区别**

```
 <script type="text/javascript">
  function show(id) {
    document.getElementById(id).style.display= "";
  }
  function hide(id) {
    document.getElementById(id).style.display= "none";
  }
 </script> 
```

# php - 从文件中读取数组键，不包括文件

> ID：10504599
> 
> 赞同：1
> 
> 时间：2012-05-08T18:47:27.823
> 
> 标签：php, arrays, include

我有一个包含数组的 php 文件`$myArray`。

```
<?php 
$myArray = array(
  'key1'=>'value1',
  'key2'=>'value2',
);
?> 
```

我需要`key1`从该数组中读取 的值。有没有办法直接读取`key1`，而不包括整个文件？现在我正在使用这样的包含。

```
$includedArray = include('/path/to/myArray.php'); 
```

但这对我来说是个问题，因为即使我将它包含在一个新名称下，它仍然会识别导致命名冲突`$includedArray`的旧名称。`$myArray`

为了解决这个问题，我将包含的数组从命名数组 ($myArray) 更改为未命名的数组，但我无法更改包含的文件。那么有没有办法：

*   包含包含命名数组的文件，但让它完全忘记原始名称（`$myArray`），并让它只使用我给它的新名称（`$includedArray`）？

*   或者有没有办法简单地从数组中读取 1 个键而不包括整个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:01:18.077

然后将数组复制到另一个变量并取消设置原始数组？

**路径/到/myNewArray.php**：

```
return call_user_func(function() {
  include "/path/to/myArray.php";
  return $myArray;
});

/*
if (isset($myArray)) {
  $tmpMyArray = $myArray; // storing the $myArray if defined
}

$includedArray = $myArray;
unset($myArray);
if (isset($tmpMyArray)) {
  $myArray = $tmpMyArray; // restoring the previous $myArray
}
*/ 
```

用法：

```
$whatEver = include("/path/to/myNewArray.php"); // no interference now 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:09:23.327

如果您需要共享值，但又不想使用与公共包含的 php 配置文件共享的全局变量，那么将这些值存储在 xml 或 json 文件中怎么样？

* * *

使用 Json，您可以将文件中的“数组”加载到您选择的变量中。

[http://www.php.net/manual/en/function.json-decode.php](http://www.php.net/manual/en/function.json-decode.php)

* * *

或者您可以使用输出缓冲区，但这不适用于您当前的用例。

```
 function ob_include_to_string($filename)
    {
        ob_start();                                         // Starts the 'output buffer'
        include($filename);                                 // Includes the file
        $return_variable = ob_get_contents();               // Sets an variable to keep the content of the echo'ed out content
        ob_end_clean();                                     // Ends and deletes the 'output buffer'; "cleans it up"
        return $return_variable;                            // Returns the variable with the content
    } 
```

* * *

将您的配置文件更改为：

```
<?php 
$myArray = array(
  'key1'=>'value1',
  'key2'=>'value2',
);

echo json_encode($myArray);
?> 
```

然后你可以这样做：

```
$newArray = json_decode(ob_include_to_string('config.php')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:04:51.677

## 方法一

利用`function scope`

```
$myArray = arrayInclude("myArray.php");
var_dump($myArray);

function arrayInclude($file)
{
    include $file;
    return $myArray;    
} 
```

输出

```
array
  'key1' => string 'foo1' (length=4)
  'key2' => string 'foo2' (length=4) 
```

**myArray.php**

```
$myArray = array (

                'key1' => 'foo1',
                'key2' => 'foo2'
        ); 
```

## 方法二

使用 `function`&`namespace`

**一个.php**

```
include 'b.php';
include 'c.php';

$myArray = call_user_func ( 'b\myArray' );

var_dump ( $myArray );

$myArray = call_user_func ( 'c\myArray' );

var_dump ( $myArray ); 
```

输出

```
array
  'key1' => string 'foo1' (length=4)
  'key2' => string 'foo2' (length=4)
array
  'key1' => string 'bar1' (length=4)
  'key2' => string 'bar2' (length=4) 
```

**b.php**

```
namespace b;

    function myArray() {
        return array (

                'key1' => 'foo1',
                'key2' => 'foo2'
        );

    } 
```

**c.php**

```
namespace c;

function myArray() {
    return array (

            'key1' => 'bar1',
            'key2' => 'bar2' 
    );

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:34:54.990

数组.php

```
<?php
    class MyArray {
        public static $myArray = array('key1' => value1, 'key2' => value2);
    }
?> 
```

其他.php

```
<?php
    include('array.php');

    //Access the value as
    MyArray::$myArray['key1'];
?> 
```

# c# - 在 C# 中调整 DataGridView 的大小

> ID：10504608
> 
> 赞同：0
> 
> 时间：2012-05-08T18:48:00.367
> 
> 标签：c#, winforms

我有一个以 DataGridView 作为主要组件的表单。当用户最大化表单时，我需要调整 DGV 的大小。

正如我在网上阅读的那样，这不能以编程方式完成。

该程序用 C# 编写并使用 WinForms。你会怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T18:51:48.223

使用 Anshor 属性，并设置为所有四个边（顶部、右侧、底部和左侧）。这样，datagridview 将与表单一起调整大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:02:01.023

另一种选择是使用停靠属性，

# node.js - 在网络上使用 cloud9-ide

> ID：10504609
> 
> 赞同：1
> 
> 时间：2012-05-08T18:48:05.683
> 
> 标签：node.js, cloud9-ide

我已经使用今天来自 github 的最新代码和 node.js 0.6.17 在我的 ubuntu 机器上启动并运行了 cloud9 IDE。似乎我可以在 localhost:3131 或 127.0.0.1:3131 上很好地查看它，但是如果我尝试使用机器的实际 IP 地址查看它，无论是从不同的机器还是在同一台机器上，我都会得到一个“不是发现”错误。有没有办法让它在网络上工作？

（我读到[有一个“-l”命令行参数](http://gratdevel.blogspot.com/2011/11/setting-up-cloud9-on-ubuntu-1110.html)可以让你这样做，但现在它似乎没有效果。这个功能是否被删除？何时以及为什么？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:48:15.860

该`-l`命令确实已被删除，但只是暂时的。您可以通过修补来解决此问题`configs\default.js`。那里有一些对 localhost 的引用。可能将 localhost 的所有实例更改为`0.0.0.0`可以让应用程序在任何主机上侦听。

编辑：已修复

# javascript - 使用 Javascript/C 发送/接收换行符

> ID：10504610
> 
> 赞同：0
> 
> 时间：2012-05-08T18:48:10.217
> 
> 标签：javascript, c, websocket

```
char newline = '\n'; 
for ( i = 5 ; i < payload_length && payload[i] != newline ; i++ )
{
    username[i-5] = payload[i];
    username[i-4] = '\0';
} 
```

这是我无法修改的一些服务器代码的一部分。我正在写客户端。我试过以下

```
websocket.send("SEND "+name+"\n"+message);
websocket.send("SEND "+name+"\\n"+message);
websocket.send("SEND "+name+"\r\n"+message); 
```

没有工作。它不会停在换行符处。如果我将换行符设置为 '|' 然后输入'|' 在 websocket.send 然后一切正常。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:12:39.877

您可以在您的 c 代码中通过放置

```
printf ("chr arrived: %i %c \n", payload[i], payload[i]); 
```

在您的循环中，它会打印当前 chr 和 chr 本身的数值。

如果您检查换行符 chr：

```
char newline = '\n';
printf ("chr arrived: %i %c \n", newline, newline); 
```

输出将是：

```
> ./test
chr arrived: 10

> 
```

我猜您在示例中发送的是字符`\`(92) 和`n`(110)，所以我建议您尝试以下方法在 JS 中指定换行符：

```
var newline = String.fromCharCode(10);
websocket.send("SEND "+name+newline+message); 
```

# ckeditor - CKeditor PHP 文件，而不是 asp

> ID：10504611
> 
> 赞同：0
> 
> 时间：2012-05-08T18:48:15.467
> 
> 标签：ckeditor

我下载了CKeditor，当我解压缩文件时，有一个名为CKeditor.asp 的文件。我试图找到它的 php 版本，但找不到。谁能帮我？

富文本编辑器还有其他更好的选择吗，我想将它用于我的 blob。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T09:15:55.567

标准下载包含 ASP 和 PHP，您可以简单地获取您想要的文件并将其余文件装箱。PHP4 和 PHP5 甚至还有不同的示例文件，因此请查看它们以选择您想要的。

至于文件夹，我建议保留除 _samples 之外的所有文件夹。尽管检查它们并决定是否也保留它们可能会有所帮助，但其中包含一些您可能需要的不错的提示和技巧。

# solr - 重构为函数查询

> ID：10504613
> 
> 赞同：1
> 
> 时间：2012-05-08T18:48:23.190
> 
> 标签：solr

使用 Solr 4.0 我有以下查询：

```
(family_name:(Brown) OR maiden_name:(Brown)^0.5) AND (
    source:HIGHQUALITY^3000 OR source:SVC1^2000 OR 
    source:SVC2 OR source:SVC3 OR 
    source:SVC4 OR source:SVC5) 
```

其中 HIGHQUALITY 和 SVC1..SVC5 不是“源”字段值的真实名称。我们不能完全假设它们是 alpha 有序的，或者可能永远是......

我正在寻找的是一个基于源索引字段的值返回提升的函数，而不是对该字段进行一堆查询。在 solr-hybrid-pseudocode 中：

```
{!boost 
    switch (source) {
    case "HIGHQUALITY": return 3
    case "SVC1": return 2
    default: return 1
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T15:25:58.693

If your boost weightings are generally static (ie: don't change for every request) then the most straight forward way to do something like this is with external file field...

lucene.apache.org/solr/api/org/apache/solr/schema/ExternalFileField.html

It's common use case is to contain a mapping of "id=value" pairs for each doc, but there is no requirement that the lookup field be the id / uniqueKey. You could (in your specific case) have a simple file listing the 5 mappings for each of The known values in your "source" field, as well as a default mapping, and then that numerical value can be used in a function.

If you really need to specify a switch using arbitrary values at query time, then there are some new functions available in trunk that *should* make this possible using nested "if" functions (but I haven't personally tested this)...

wiki.apache.org/solr/FunctionQuery#if

wiki.apache.org/solr/FunctionQuery#termfreq

```
if(termfreq(source,'HIGHQLTY'),3,if(termfreq(source,'SVC1'),2,1)) 
```

# php - 嵌入在 Codeigniter 页面上的 Flash 依赖项

> ID：10504617
> 
> 赞同：0
> 
> 时间：2012-05-08T18:48:53.030
> 
> 标签：php, flash, codeigniter, dependencies, embed

我目前正在为我的软件工程课程做我的顶点项目。我们正在创建一个网站，以便我大学的游戏设计学生可以上传他们制作的游戏，这实际上是为游戏设计系创建一个“展示”。

不幸的是，许多在 Flash 中创建的游戏都有需要加载的依赖项。由于使用 plupload 将文件上传到 /uploads/flash 并且所有内容都通过 index.php 浏览，因此当需要嵌入的依赖项时，它不会被加载（通常 flash 游戏会停止）

有没有人遇到过这个问题？应该采取什么措施来补救或“绕过”这个问题？显然将所有文件上传到根目录不是一个很好的选择。

谢谢！

编辑：我还想指出，我已尝试将以下内容添加到嵌入中，但无济于事。

```
 <param name="base" value="<?php echo base_url("uploads/flash/"); ?>/"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:02:26.897

什么依赖？图片？

您可以制定一个 htaccess 规则，使 /* 重定向到 index.php/file/?url=$url

文件控制器只会从 /uploads/flash 回显文件

编辑

```
<param name='movie' value='<?php echo base_url("uploads/flash/"); ?>player.swf'> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:44:56.227

您需要编辑 .htaccess 文件以不包含任何资产文件类型。所以它应该看起来像：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  !(\.mp3|\.swf|\.gif|\.jpeg|\.bmp)$
RewriteRule ^(.*)$ index.php?/$1 [L] 
```

这意味着任何带有 .mp3、.swf、.gif、.jpeg 或 .bmp 的请求都不会通过 index.php 进行路由。

上面的代码完全未经测试，但我认为这是正确的方法。

从这里：[如何将所有请求重定向到文件，除了使用 Apache 的图像？](https://stackoverflow.com/questions/7060932/apache-htaccess-redirect-all-request-to-a-file-except-images)

# css - CSS3 变换和 iFrame (webkit) - 当用户切换到新选项卡并返回时动画停止

> ID：10504618
> 
> 赞同：2
> 
> 时间：2012-05-08T18:48:55.183
> 
> 标签：css, webkit, cross-browser, css-transitions

我需要在 iframe 中显示 CSS3 动画内容。似乎当用户切换到不同的选项卡并返回时 - 主要是 Safari，但有些人也报告了 Chrome 中的问题 - 动画返回到起点并且转换永远不会播放。

其他一些注意事项：这似乎只是偶尔发生。此外，在某些情况下，多次切换选项卡会导致转换在用户第一次模糊选项卡焦点时恢复到应该停止的位置。

已知的浏览器缺陷或我忽略的东西？为了彻底，我尝试过应用变换原点和背面可见性，但这些都没有帮助。

# eclipse - 将新的 Maven 运行配置添加到 Eclipse 中的菜单

> ID：10504620
> 
> 赞同：13
> 
> 时间：2012-05-08T18:48:59.427
> 
> 标签：eclipse, maven

是否有一些方法可以添加到“运行配置菜单”中的现有 Maven 配置，在 Eclipse 的“运行 - > 运行方式”中可用？我想将我常用的目标（如“集成测试”）添加到现有目标中，如“maven build”等。

我使用变量“${project_loc}”作为基本目录，但是如何将新配置放置在 maven 运行配置菜单中？我在首选项或任何地方都看不到该选项。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-08T18:59:26.003

简短的回答是你不能。Eclipse 通常鼓励不要弄乱上下文菜单。

但是，当使用[m2eclipse](http://eclipse.org/m2e/)时，您可以使用`Run As... / Maven Build...`菜单为您的 Maven 构建创建启动配置。之后，您可以使用`Run As... / Maven Build`（或 Alt-Shift-X、M 快捷键）调用先前创建的配置，因此如果创建了多个配置，您将看到一个选择对话框。

# jquery - link_to 和 remote => true + jquery ajax:success

> ID：10504625
> 
> 赞同：0
> 
> 时间：2012-05-08T18:49:28.413
> 
> 标签：jquery, ruby-on-rails, coffeescript

我在一个页面上有许多链接进行远程调用以更新页面上的内容。一切都完美无缺，所以我决定为具有内容加载的元素添加一个叠加层，这样它就可以为客户提供一些视觉参考，以了解正在发生的事情。

因此，在我想要显示叠加层的每个链接上，我通过我想要叠加层的 div 中传递的数据属性添加一个类。这是一些示例代码。

```
<div id="content">Old Content</div>
<%= link_to "Update Content", some_path, :class => 'ajax_trigger', :remote => true, 'data-target' => 'content' %> 
```

好的，所以当单击它时，它会运行并使用respond_to 块format.js 加载数据，我在其中替换内容，即，

```
$("#content").html("<%= escape_javascript(render(:partial => '/shared/content')) %>") 
```

就像我说的那样，一切都很好。好的，所以我有一个全局的 JS（咖啡脚本）来做覆盖，即。

```
 $(".ajax_trigger").live("ajax:beforeSend", (evt, data, status, xhr) ->

    # Get target div to add overlay
    target = $(this).data('target')
    $t = $("#"+target)

    # Update CSS for Overlay
    $("#overlay").css
      opacity: 0.7
      top: $t.offset().top
      left: $t.offset().left
      width: $t.outerWidth()
      height: $t.outerHeight()

    # Update Image for Overlay
    $("#img-load").css
      top: ($t.height() / 2)
      left: ($t.width() / 2)

    # Show Overlay
    $("#overlay").fadeIn()

  ).live("ajax:success", (evt, data, status, xhr) ->
    $("#overlay").fadeOut()
  ).live "ajax:error", (evt, data, status, xhr) ->
    alert "Failed!" 
```

这适用于页面上的 2 个项目，但对于其中一个项目，它显示覆盖但不隐藏它。我没有收到任何错误，当然 ajax:alert 会给我一个警告。内容在叠加层上完美加载，所以一切都很好。

我看不出有什么不同，为什么即使我得到了很好的回应并替换了内容，它也不会隐藏。

有什么建议可以调试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:31:44.870

仅从描述中我无法判断您的问题是什么。您是否使用过诸如 Firebug 或 Chrome 开发者工具中的 JavaScript 调试器？找到你的脚本，设置一个断点，点击麻烦的链接，然后单步执行代码。

# jquery - jQuery - 由于边距而无法单击 DOM 中的项目

> ID：10504626
> 
> 赞同：1
> 
> 时间：2012-05-08T18:49:30.070
> 
> 标签：jquery, html, css

`margin: -107px 0 0 0;`由于应用于页脚的样式，我无法让 jQuery 单击页脚中的图像。我不明白为什么这会导致问题，因为当我检查网站时仍然可以看到 DOM 中的图像。我还注意到在页脚中突出显示“Grilled Chicken Pesto Sandwich”字样时遇到问题，我相信这也是因为`margin: -107px 0 0 0;`应用于页脚的样式。

[链接到网站](http://www.sfu.ca/~jca41/stuph/la1/template.html)

```
//jQuery
$("footer #thumbs ul li figure img").click(function() {
  var id = $(this).attr('id');
  $.backstretch(images[id]);
  $('html').css('background-size', 'cover');    
});

//css
footer {
  margin: -107px 0 0 0; //The -107px is causing the problem
  width: 100%;
  height: 107px;
  background: url(../img/bottom.png) repeat-x;
}

//html
<footer>
  <div id="thumbsDesc">Grilled Chicken Pesto Sandwich</div>
  <div id="thumbs">
    <ul>
      <li><figure><img id="0" src="img/01.jpg"></figure></li>
      <li><figure><img id="1" src="img/02.jpg"></figure></li>
      <li><figure><img id="2" src="img/03.jpg"></figure></li>
      <li><figure><img id="3" src="img/04.jpg"></figure></li>
    </ul>   
  </div>
</footer> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:03:13.617

对于标记的 div，`id="thumbs"`将其 css 设置为

```
position: absolute;
z-index: 1;
left: 120px; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:55:52.077

它看起来像`div class="wrapper"`覆盖*页脚*。*（尝试更改`z-index`页脚。） - 不起作用，抱歉。*尝试将页脚放在包装器内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:01:36.270

您需要减少包装类的 z-index，我在 firebug 上尝试过这个，我能够选择文本并单击图像。无需增加脚 z-index 我使用 -10 作为包装器

编辑：另外，如果你删除包装器上的相对位置，它也可以工作，所以你可以做任何你认为最适合所有浏览器的事情，我只在 FF 上玩过这个

# php - 如何从 MySQL 表中对大型多维数组进行排序

> ID：10504627
> 
> 赞同：0
> 
> 时间：2012-05-08T18:49:30.247
> 
> 标签：php, mysql, arrays, multidimensional-array, pdo

我有一个 MySQL 表，其中包含客户可以订购的所有可能产品的列表。该表的（非常）简化版本如下所示：

```
ID  |  productid    |    price    |   age_min   |   age_max   |   type
=======================================================================
1   |   baseball_1  |    12.34    |    18       |    21       |    1
2   |   baseball_2  |    15.99    |    22       |    30       |    1
3   |   baseball_3  |    18.99    |    18       |    99       |    1
4   |   golf_1      |    4.99     |    18       |    24       |    2
5   |   golf_2      |    5.99     |    25       |    44       |    2
6   |   tennis_1    |    9.99     |    18       |    50       |    3
7   |   tennis_2    |    14.99    |    51       |    99       |    3 
```

在这家商店，所有产品都有年龄限制，这意味着客户只有在他/她的年龄符合该范围的情况下才能选择要购买的商品。即使每个产品“类型”存在多个选项，定制也只能选择一种“类型”。在上面的示例表中，24 岁的客户只能选择：

> 棒球_2、棒球_3 高尔夫_1 和网球_1

我正在尝试按已知产品类型组织潜在客户的选项。因此，就我而言，商店可能会向客户展示：

## 棒球选项

*   棒球_2 - 15.99 美元
*   棒球 3 - 18.99 美元

## 高尔夫选项

*   Golf_1 - 4.99 美元

## 网球选项

*   网球_1 - 9.99 美元

我想使用 age 变量对数据库进行一次（如果可能）MySQL 调用，并返回所有可能的产品，然后如上所述相应地显示这些产品。SQL 语句很简单，我已经完成了这项工作，但我不确定如何循环或构建一个适当的数组，该数组可以列出成员的可用选项。

可能会提出建议，但这比显示的要详细得多，并且由于与该问题无关的其他几个因素，因此不能选择使用任何类型的第三方软件或购物车。看来这是如何处理多维数组的问题。以前有人遇到过类似的问题吗？

* * *

## 更新

虽然 Travesty 和 tdammer 下面提供的解决方案在某些情况下是有效的，但我希望能够对我的数据做更多的事情，然后将其从我的数据库中显示出来。页面的布局和设计不应取决于它在数据库中的存储方式/时间/等。有时我想先显示一组“类型”的最高价格，而先显示另一组“类型”的最低价格。

通过使用 fetchAll 语句，我能够从查询中收集我需要的所有必要数据，但我真的不确定如何使用它。例如，我的数组当前是：

```
Array (
    [0] => Array ( [productid] => 394, [price] => 6.20,  [type] => 16 ),
    [1] => Array ( [productid] => 395, [price] => 12.40, [type] => 16 ),
    [2] => Array ( [productid] => 396, [price] => 18.60, [type] => 16 ),
    [3] => Array ( [productid] => 397, [price] => 24.80, [type] => 16 ),
    [4] => Array ( [productid] => 398, [price] => 31.00, [type] => 16 ),
    [5] => Array ( [productid] => 449, [price] => 4.20,  [type] => 17 ),
    [6] => Array ( [productid] => 450, [price] => 8.40,  [type] => 17 ),
    [7] => Array ( [productid] => 451, [price] => 12.60, [type] => 17 ),
    [8] => Array ( [productid] => 452, [price] => 16.80, [type] => 17 ),
    [9] => Array ( [productid] => 453, [price] => 21.00, [type] => 17 )
) 
```

有没有一种好方法来构建我自己的数组，我以后基本上可以说“向我展示所有类型为 17 的项目的产品 ID 和价格”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:02:17.967

为此，您不需要多维数组。

只需按类型对查询结果进行排序，然后在数组中循环。这样做时，在第一个项目之前插入一个标题，然后在类型更改的每个项目之前插入一个标题。

如果您有一个适当规范化的数据库，您还应该有一个`product_types`包含产品类型 ID 和名称的表；在这种情况下，考虑一个`JOIN`. 然后你的 SQL 看起来有点像这样：

```
SELECT p.id, p.name, p.price, t.id AS type_id, t.name AS type_name FROM products AS p LEFT JOIN product_types t ON t.id = p.type WHERE :age BETWEEN p.min_age AND p.max_age; 
```

然后，您逐步检查结果集，如下所示：

```
$current_type = 'not_a_string';
while ($row = get_next_row_from_database) {
    if ($current_type !== $row['type_id']) {
        echo '<h3>' . htmlspecialchars($row['type_name']) . '</h3>';
        $current_type = $row['type_id'];
    }
    printf('<p>%s - $%2.2f</p>', htmlspecialchars($row['name']), $row['price']);
} 
```

这种方法使用恒定内存（在 Web 服务器上，显然不在数据库上）和线性时间。

您还应该考虑数据的分页：不要一次查询所有行，而是运行`COUNT(*)`查询以获取总行数，然后用于`LIMIT`仅获取当前页面的行（您可能还想指定一个`ORDER BY`子句以使您的页面有意义）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:10:57.593

我认为您不需要为此使用多维数组。我认为当你来到一个新组时，你只需要遍历你的行并更改你的标题。

我对这个答案使用了一些不同的方法，将每一行粘贴到一个数组中，然后将它们内爆，以便保留格式。

```
//USING PDO - assume connection already made
/* added ORDER BY in the query to ensure that we get the rows sequentially, by type */
$stmt = $db->prepare("SELECT * FROM table WHERE age_min >= :age AND age_max <= :age ORDER BY type");
$stmt->bindParam(":age", $customer_age);
$stmt->execute();

$type = -1;
$lines = array();
while ($data = $stmt->fetch(PDO::FETCH_ASSOC))
{
    $data = array_map("htmlspecialchars", $data); /* sanitize data for HTML output */

    if ($type != $data["type"])
    {
        $type = $data["type"];
        list($typeName) = explode("_", $data["productid"]); /* this assumes that you don't have a column with the actual product name. If you do, use that instead. */
        $lines[] = (count($lines) > 0 ? "</ul>\n" : "") ."<h2>". ucfirst($typeName) ." Option</h2>\n<ul>";
    }

    $lines[] = "\t<li>{$data["productid"]} - {$data["price"]}</li>";
}

echo implode("\n", $lines) ."\n</ul>"; 
```

* * *

**对问题更新的回应：**

> 有没有一种好方法来构建我自己的数组，我以后基本上可以说“向我展示所有类型为 17 的商品的产品 ID 和价格”？

那是一个查询。我仍然认为没有理由将其存储在数组中。如果您想获取类型为 17 的所有商品的 productid 和 price，那么您应该在数据库上执行该查询。如果您想以不同的方式对结果进行排序，那么您应该更改您的`ORDER BY`子句。

也许您需要调整您的查询，使其更加灵活：

```
if (!isset($_POST["columns"]))
    $_POST["columns"] = "productid, price";
if (!isset($_POST["whereClause"]))
    $_POST["whereClause"] = "TRUE";
if (!isset($_POST["orderby"]))
    $_POST["orderby"] = "type ASC, price DESC";

$stmt = $db->prepare("SELECT :columns FROM table WHERE age_min >= :age AND age_max <= :age AND :whereClause ORDER BY :orderby");
$stmt->bindParam(":columns", $_POST["columns"]);
$stmt->bindParam(":age", $customer_age);
$stmt->bindParam(":whereClause", $_POST["whereClause"]);
$stmt->bindParam(":orderby", $_POST["orderby"]);
$stmt->execute(); 
```

您可以使用 HTML 表单提交（导致页面重新加载）调用它，也可以通过 AJAX 调用它。但无论哪种方式，我都看不出做 a`fetchAll`并将结果存储在数组中对你有什么好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:57:38.903

根据数据库的大小，此解决方案可能不起作用，但通常我在较小规模上的工作方式是：

将数据库结果循环到我的设计数组中

所以我可能有

```
Array['baseball'][0]['price'] = 15.99
Array['baseball'][1]['price'] = 18.99 
```

循环遍历我创建的数组以解析结果。

在更大的数据库中，您将需要不同的解决方案，因为这会使您多次循环结果结果......

# wpf - 实体框架代码优先 WPF - 取消更改

> ID：10504628
> 
> 赞同：1
> 
> 时间：2012-05-08T18:49:33.230
> 
> 标签：wpf, entity-framework

我有一个使用 EF4.3.1 连接到数据库的 WPF 应用程序。我以用户可以编辑值并点击保存或取消的形式显示实体。问题是，当用户点击取消时，更改不会回滚，实体仍会被上下文跟踪，并在其他操作调用 saveChanges() 时将其保存到数据库中。我想知道您是否可以指出我实现 EF/WPf 客户端服务器应用程序的良好来源。

另一个副作用是，如果用户打开了两个表单并点击保存一个..另一个也被保存..显然我没有正确使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:37:20.390

在这种情况下，我一直在做的是制作实体的副本并将副本提供给用户进行编辑。当用户点击取消时，我只是将副本丢弃。保存时，我用副本中的值（现在由用户修改）覆盖原始实体的属性，保存原始实体并将副本丢弃。

# javascript - 检查 Cookie 是否存在？

> ID：10504633
> 
> 赞同：0
> 
> 时间：2012-05-08T18:49:44.797
> 
> 标签：javascript, html, cookies

我试图找出一个 cookie 是否存在，如果它不存在，我想创建它。我在 Internet Explorer 中执行此操作，并在下面代码的 if(readCookie(count) == null) 处停止。

```
if(readCookie("count") == null)
{
    createCookie("count", 0, 10);
}

function readCookie(name) 
{
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) 
    {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:52:04.147

```
if( $.cookie('query') == null ) { 
    createCookie("count", 0, 10);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:00:29.203

尝试使用`undefined`而不是`null`

请参阅以下链接：

[http://jsfiddle.net/sssonline2/D38WM/1/](http://jsfiddle.net/sssonline2/D38WM/1/)

在 IE 和 FireFox 上测试

这是 Stack Overflow 链接以获取更多信息：

[typeof !== "未定义" vs. != null](https://stackoverflow.com/questions/2703102/typeof-undefined-vs-null)

# checkout - 在 Paypal 上销售数字商品

> ID：10504634
> 
> 赞同：2
> 
> 时间：2012-05-08T18:50:04.933
> 
> 标签：checkout, paypal

我正在尝试将 Paypal Express 结帐集成到我的网站中。在沙盒上一切正常，但是当我切换到 live 时，我不断收到以下错误：

```
TIMESTAMP=2012-05-08T18:15:32Z
CORRELATIONID=e5550e81918f5
ACK=Failure
VERSION=72.0
BUILD=2860716
L_ERRORCODE0=10004
L_SHORTMESSAGE0=Transaction refused because of an invalid argument. See additional error messages for details.
L_LONGMESSAGE0=You are not signed up to accept payment for digitally delivered goods.
L_SEVERITYCODE0=Error 
```

我需要特殊权限才能销售数字商品吗？我找不到与此相关的任何信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:11:26.043

沙盒让您可以访问所有 PayPal 产品。某些产品（例如销售数字商品）需要企业帐户。

这是 PayPal 关于销售[数字商品](https://merchant.paypal.com/cgi-bin/marketingweb?cmd=_render-content&content_ID=merchant/digital_goods)的页面：

> [使用PayPal for Digital Goods](https://merchant.paypal.com/cgi-bin/marketingweb?cmd=_render-content&content_ID=merchant/digital_goods)销售更多数字内容并建立更有利可图的客户关系。

# android - 在 Android 的 ScrollView 中使用 TextView.postDelayed 的打字机效果

> ID：10504636
> 
> 赞同：0
> 
> 时间：2012-05-08T18:50:13.077
> 
> 标签：android

我正在使用滚动视图中的文本视图创建可运行的打字机效果。

这就是我所做的......

```
 final ScrollView sv = new ScrollView(this);
    sv.setLayoutParams(new LinearLayout.LayoutParams((int)display.getWidth()/2, (int)((display.getHeight()/4))*3));
    sv.setPadding(0, px2DP(10), px2DP(10), px2DP(10));

    final CharSequence text = getResources().getText(R.string.longstring);

    final TextView content = new TextView(this);
    content.setBackgroundColor(getResources().getColor(R.color.Black));
    content.setTextColor(getResources().getColor(R.color.White));
    content.setTextSize(TypedValue.COMPLEX_UNIT_SP,20);
    content.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT));

    sv.addView(content);

    content.postDelayed(new Runnable(){
        @Override
        public void run() {
            content.append(text.subSequence(0, index++));
            sv.fullScroll(View.FOCUS_DOWN);     
        }

    },70); 
```

我只得到一个黑匣子，没有文字。

我究竟做错了什么？请帮忙。

PS。我已经找到了解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T04:33:13.853

找到解决方案。我使用错误的处理程序可运行概念。根据 Jonas 所指出的，Runnable 只运行一次。因此需要一个循环。

正如此链接所建议的那样： [如何在 Android 中运行 Runnable 线程？](https://stackoverflow.com/questions/1921514/how-to-run-a-runnable-thread-in-android)

答案类似于递归。

总之谢谢各位！安卓太酷了。

# xcode - presentPopoverFromRect 导致一个空视图，但使用 segue 它工作正常

> ID：10504637
> 
> 赞同：0
> 
> 时间：2012-05-08T18:50:15.307
> 
> 标签：xcode, ipad, ios5, xcode4, uipopovercontroller

我正在制作一个 iPad 应用程序，我在其中以编程方式将 UIButtons 放在 UIScrollView 内的 UIImageView 上。

当有人按下其中一个按钮时，我想展示一个 UIPopover。由于按钮是通过编程方式添加的，因此我还必须以编程方式呈现弹出框。

这是我展示弹出框的代码：

```
- (void)buttonHandler:(UIButton *)sender
{
    PushButtonViewController *controller = [[PushButtonViewController alloc] initWithButtonID:@"hej"];
    _pushButtonPopover = [[UIPopoverController alloc] initWithContentViewController:controller];

    _pushButtonPopover.delegate = self;

    if(![_pushButtonPopover isPopoverVisible]) {
       [_pushButtonPopover presentPopoverFromRect:sender.bounds inView:sender permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
    } else {
        [_pushButtonPopover dismissPopoverAnimated:YES];
    }
} 
```

这是弹出视图控制器的初始化程序：

```
- (id)initWithButtonID:(NSString *)buttonID
{
    self = [super init];
    self.buttonID = buttonID;
    return self;
} 
```

问题是当我这样做时，**我得到一个空的弹出窗口：**

[屏幕截图 1 - 不工作](https://www.dropbox.com/s/q0k1idd5c0roymn/screenshot1.png)

然而，当我使用一个预先插入的按钮，连接到故事板中的一个 segue 时，**一切正常：**

[屏幕截图 2 - 工作正常](https://www.dropbox.com/s/mbuxs6dm2hcewfr/screenshot2.png)

我真的希望您对我可能做错的事情有一些建议。先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T16:47:29.513

我好像自己找到了答案。出于某种原因，您必须像这样从情节提要中实例化您的 ViewController：

```
PushButtonViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"Push Button Popover"]; 
```

这样视图就可以正确显示。

# xcode - 如何使用 Xcode 将 Facebook 链接到 Iphone App

> ID：10504643
> 
> 赞同：0
> 
> 时间：2012-05-08T18:50:44.103
> 
> 标签：xcode, facebook, xcode4.3, xcodebuild

我正在使用版本 Xcode 4.3 。在这个阶段我有一个非常基本的应用程序，所以我没有元素的冲突特性。

我想知道是否有人知道如何使用 Xcode 将 facebook 链接到 Iphone 应用程序。我想要一个通过使用 facebook 的简单登录功能。但是一直未能找到更新的教程，并且对断开的链接越来越恼火。

任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:43:22.070

为什么不将 Facebook 的文档作为起点？ [https://developers.facebook.com/docs/mobile/ios/build/](https://developers.facebook.com/docs/mobile/ios/build/)

# django - 为什么我不能使用“dumpdata”管理命令进入调试器？

> ID：10504646
> 
> 赞同：2
> 
> 时间：2012-05-08T18:50:57.657
> 
> 标签：django, pdb, dumpdata

我试图确定为什么我在调用时不能使用调试器：

```
python manage.py dumpdata --indent=2  > forum/fixtures/initial_data.json' 
```

我在管理命令代码中添加了以下语句：

```
import pdb; pdb.set_trace()
# I also tried 
import ipdb; ipdb.set_trace() 
```

调用该命令时，该命令会挂起，必须使用 ctl-C 停止：

```
$ python manage.py dumpdata --indent=2 > forum/fixtures/initial_data.json  

^CERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid  
The error message is: ('EOF in multi-line statement', (55, 0))  
ERROR: An unexpected error occurred while tokenizing input  
The following traceback may be corrupted or invalid  
The error message is: ('EOF in multi-line statement', (101, 0)) 
```

为什么调试器不工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:04:32.823

您正在将输出重定向到文件。

如果你查看 forum/fixtures/initial_data.json 的比赛，你会看到 pdb 在那里要求输入。如果要调试转储数据，请不要重定向输出。

# c# - 删除正在使用的文件

> ID：10504647
> 
> 赞同：24
> 
> 时间：2012-05-08T18:51:25.183
> 
> 标签：c#

我创建了一个简单的程序来删除 C# 中的临时文件（为了好玩，不是主要项目）并且遇到了锁定文件（使用中）的问题。您通常如何排除这些文件？作为参考，我收到错误：

该进程无法访问文件“ExchangePerflog_8484fa31c65c7a31cfcccd43.dat”，因为它正被另一个进程使用。

代码：

```
static void Main(string[] args)
    {
        string folderPath = string.Empty;
        folderPath = System.Environment.GetEnvironmentVariable("temp");
        deleteFilesInDirectory(folderPath);
    }

    public static void deleteFilesInDirectory(string folderPath) 
    {

        try
        {
            var dir = new DirectoryInfo(folderPath);
            dir.Attributes = dir.Attributes & ~FileAttributes.ReadOnly;
            dir.Delete(true);
            MessageBox.Show(folderPath + " has been cleaned.");
        }
        catch (System.IO.IOException ex)
        {
            MessageBox.Show(ex.Message); 
            return;

        } 
    } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-08T18:58:53.427

### 描述

无法删除另一个进程当前正在使用的文件。但是您可以等到文件未锁定。

签入 while 循环，直到使用此方法解锁文件

```
protected virtual bool IsFileLocked(FileInfo file)
{
    FileStream stream = null;

    try
    {
        stream = file.Open(FileMode.Open, FileAccess.ReadWrite, FileShare.None);
    }
    catch (IOException)
    {
        //the file is unavailable because it is:
        //still being written to
        //or being processed by another thread
        //or does not exist (has already been processed)
        return true;
    }
    finally
    {
        if (stream != null)
            stream.Close();
    }

    //file is not locked
    return false;
} 
```

### 样本

```
FileInfo file = new FileInfo("PathToTheFile");
while (IsFileLocked(file))
    Thread.Sleep(1000);
file.Delete(); 
```

## 更新

如果你想跳过锁定的文件，你可以这样做。

```
//
var dir = new DirectoryInfo(folderPath);
foreach(var file in dir.GetFiles()) {
    try
    {
        file.Delete();
    }
    catch (IOException)
    {
        //file is currently locked
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-02-04T08:01:09.637

试试下面的代码。只需在文件删除前添加两行：

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-09-27T14:17:41.607

好吧，我遇到了类似的问题。当您在删除文件后不久尝试删除目录时，您必须强制 GC 从当前线程释放文件句柄

```
public void DisposeAfterTest(string filePath)
    {

        if (File.Exists(filePath))
        {
            File.Delete(filePath);
        }

        GC.Collect();
        GC.WaitForPendingFinalizers();

        if (Directory.Exists(this.TempTestFolderPath))
        {
            Directory.Delete(this.TempTestFolderPath, true);
        }

    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T18:57:43.977

我不相信有任何方法可以提前知道文件是否正在使用。您可以尝试获取文件的排他锁；但是你只会用一个例外换另一个例外。

如果这些是您正在打开的文件，请查看是否无法更好地关闭它们。如果它比这更复杂 - 您可以维护一个“删除列表”并继续重试删除，直到它成功（可能在另一个具有并发集合的线程上）。

我也不相信无论如何都可以强制删除正在使用的文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-15T00:53:18.740

使用 dknaack 的代码。这在我的情况下有效。

```
FileInfo file = new FileInfo("xyz.txt");
try
{
    for (int tries = 0; IsFileLocked(file) && tries < 5; tries++)
        Thread.Sleep(1000);
    file.Delete();
}
catch (IOException exception)
{
    Console.WriteLine(string.Format("File locked: {0}", exception);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-04T08:43:12.203

以下代码将从目录及其所有子目录中删除文件，不包括锁定文件，并获取未删除文件的列表。如果只考虑当前目录，则可以将 SearchOption 更改为 TopDirectoryOnly。

```
string []files = Directory.GetFiles(dirPath,"*.*", SearchOption.AllDirectories); //this gets the files in all subdirectories as well
List<string> lockedFiles = new List<string>();
foreach(string file in files) 
{    
    try    
    {        
        file.Delete();    
    }    
    catch (IOException)    
    {        
        lockedFiles.Add(file);    
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-27T14:21:09.430

您只需调用一个方法，即 WipeFile，代码如下所示。因此，您真正需要做的就是调用 WipeFile 并提供要删除的文件的完整路径，以及您想要覆盖它的次数。

```
public void WipeFile(string filename, int timesToWrite)
{
    try
    {
        if (File.Exists(filename))
        {
            // Set the files attributes to normal in case it's read-only.

            File.SetAttributes(filename, FileAttributes.Normal);

            // Calculate the total number of sectors in the file.
            double sectors = Math.Ceiling(new FileInfo(filename).Length/512.0);

            // Create a dummy-buffer the size of a sector.

            byte[] dummyBuffer = new byte[512];

            // Create a cryptographic Random Number Generator.
            // This is what I use to create the garbage data.

            RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();

            // Open a FileStream to the file.
            FileStream inputStream = new FileStream(filename, FileMode.Open);
            for (int currentPass = 0; currentPass < timesToWrite; currentPass++)
            {
                UpdatePassInfo(currentPass + 1, timesToWrite);

                // Go to the beginning of the stream

                inputStream.Position = 0;

                // Loop all sectors
                for (int sectorsWritten = 0; sectorsWritten < sectors; sectorsWritten++)
                {
                    UpdateSectorInfo(sectorsWritten + 1, (int) sectors);

                    // Fill the dummy-buffer with random data

                    rng.GetBytes(dummyBuffer);

                    // Write it to the stream
                    inputStream.Write(dummyBuffer, 0, dummyBuffer.Length);
                }
            }

            // Truncate the file to 0 bytes.
            // This will hide the original file-length if you try to recover the file.

            inputStream.SetLength(0);

            // Close the stream.
            inputStream.Close();

            // As an extra precaution I change the dates of the file so the
            // original dates are hidden if you try to recover the file.

            DateTime dt = new DateTime(2037, 1, 1, 0, 0, 0);
            File.SetCreationTime(filename, dt);
            File.SetLastAccessTime(filename, dt);
            File.SetLastWriteTime(filename, dt);

            // Finally, delete the file

            File.Delete(filename);

            WipeDone();
        }
    }
    catch(Exception e)
    {
        WipeError(e);
    }
} 
```

我添加了一些事件只是为了能够跟踪过程中发生的事情。

*   PassInfoEvent - 返回正在运行的通道以及要运行的通道总数。
*   SectorInfoEvent - 返回正在写入的扇区以及要写入的扇区总数。
*   WipeDoneEvent - 擦除过程完成的指示器。
*   WipeErrorEvent - 如果出现任何问题，则返回异常。

[使用 .NET 安全删除文件](http://www.codeproject.com/Articles/22736/Securely-Delete-a-File-using-NET)

# c# - asp.net ListView 或 Repeater 按三分组

> ID：10504651
> 
> 赞同：1
> 
> 时间：2012-05-08T18:51:34.743
> 
> 标签：c#, asp.net, vb.net

我正在使用我在网上找到的一个不错的购物车。我想将此代码翻译为使用转发器或列表视图并动态检索我的数据，但我似乎找不到正确分组数据的方法。

我知道 ListView 可以按一定数量的项目分组，但我还没有找到一种方法来处理这种情况。

购物车的工作原理是有一个 ul 项目列表，然后在下面的 div 中显示它们的详细信息。这个过程再次开始，获得三个更多的 ul 项目，然后是三个更多的细节。我如何使用 ListView 或中继器来做到这一点？我还没有找到一种方法可以在一组三组中重复我需要的这两组数据。有什么想法吗？

```
 <ul>
        <li id="1">  
            <div>Red Grocery Bag</div>
        </li>

        <li id="2">
            <div>Reusable Grocery Bag</div>
        </li>

        <li id="3">
            <div>White Grocery Bag</div>
        </li>
    </ul>
    <div class="detail-view" id="detail-1">             

        <div class="detail_info">                   
            <label class='item_name'>Red Grocery Bag</label>

            <p>
                shopping bag, shopping, bag, merchandise, consumerism, gift:                    
                <br /><br/>
                $<span class="price">80.00</span>                       
            </p>                    
        </div>              
    </div>
    <div class="detail-view" id="detail-2">

        <div class="detail_info">                   
            <label class='item_name'>Reusable Grocery Bag</label>
            <p>
                shopping bag, shopping, bag, merchandise, consumerism, gift:                    
                <br /><br />
                $<span class="price">70.00</span>                       
            </p>                    
        </div>

    </div>
    <div class="detail-view" id="detail-3">

        <div class="detail_info">                   
            <label class='item_name'>White Grocery Bag</label>

            <p>
                shopping bag, shopping, bag, merchandise, consumerism, gift:
                <br /><br />
                $<span class="price">50.00</span>                       
            </p>
        </div>              
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:58:18.770

## **`Mark Up for Repeater and Datalist will behave in the following way only`**

```
<asp:datalist id="rpt" runat="server">
    <ItemTemplate>
    <ul>
        <li>  
            <div><%# Eval("Bag") %></div>
        </li>
    </ul>
    <div class="detail-view">             
        <div class="detail_info">                   
            <label class='item_name'><%# Eval("Bag") %></label>
            <p>
                <%# Eval("YourColumn") %>
                <br /><br/>
                $<span class="price"><%# Eval("Price") %></span>                       
            </p>                    
        </div>              
    </div>
    </ItemTemplate>
</asp:datalist> 
```

* * *

或者，使用两个`Repeaters`first 用于 ul 和 next 用于 div

# serialization - 打开客户端状态保存时，ViewScoped bean 是否序列化到页面？

> ID：10504652
> 
> 赞同：8
> 
> 时间：2012-05-08T18:51:40.980
> 
> 标签：serialization, jsf-2, view-scope

我们打开了客户端状态保存并使用 ViewScoped 支持 bean。当打开客户端状态保存并且我们使用 ViewScoped bean 时，ViewScoped bean 是序列化到页面还是说存储在会话中，带有序列化到页面的令牌/密钥（以便页面可以调用如果页面回发到自身，则来自会话的 bean）

这里的一个问题可能是，如果它被序列化，那么我们可能想要担心在 ViewScoped bean 上不存储大型实例变量，因为它被序列化到页面并通过线路来回。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T23:54:53.773

> *当打开客户端状态保存并且我们使用 ViewScoped bean 时，ViewScoped bean 是序列化到页面还是说存储在会话中，带有序列化到页面的令牌/密钥？*

Mojarra 2.x 将视图范围的 bean 存储在 HTTP 会话中。有一个未记录的设置，会话中默认最多有 25 个视图范围 bean。另见[问题 4015](https://java.net/jira/browse/JAVASERVERFACES-4015)。换句话说，物理视图范围的 bean 实例永远不会存储在 JSF 视图状态中。它们仅由 UUID 引用，而 UUID 又存储在 JSF 视图状态中。因此，无论客户端/服务器状态保存方法如何，它们都不会在 JSF 视图状态中序列化。

* * *

> *这里的一个问题可能是，如果它被序列化，那么我们可能想要担心在 ViewScoped bean 上不存储大型实例变量，因为它被序列化到页面并通过线路来回。*

这是一个合理的担忧。即使这是真的，但我们谈论的是相当极端的情况。具有每 10 个平均属性的 100 个平均实体的集合在视图状态大小上应该已经不超过额外的 ~5KB。请注意，您可以通过在网络服务器上启用 gzip 压缩来获得大量带宽，甚至每个基于文本的资源高达 70%。

但是，如果您正在处理大数据，那么 HTTP 会话存储大小可能会成为一个问题。另请参阅[JSF 2.2 内存消耗：为什么 Mojarra 将最后 25 个视图的 ViewScoped Beans 保留在内存中？](https://stackoverflow.com/questions/31959982/jsf-2-2-memory-consumption-why-does-mojarra-keep-the-viewscoped-beans-of-the-la)理想情况下，视图范围的 bean 应该在它所引用的页面被 GET 导航或浏览器选项卡关闭后立即销毁。默认的 JSF 视图范围 bean 不这样做。它仅在回发到不同视图或会话到期时被销毁。

如果您碰巧使用了 JSF 实用程序库[OmniFaces](http://omnifaces.org)，从 2.2 版开始，[`@org.omnifaces.cdi.ViewScoped`](http://showcase.omnifaces.org/cdi/ViewScoped)支持在卸载期间被破坏。这应该对 HTTP 会话存储大小产生积极影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-16T20:46:14.410

请注意，BalusC 的回答不适用于 JSF 的最新版本：对于最新版本，`javax.faces.view.ViewScoped`bean 的数据保存在服务器上。请参阅[JAVASERVERFACES-3090](https://java.net/jira/browse/JAVASERVERFACES-3090)

# java - Jersey 为空列表提供“null”元素

> ID：10504653
> 
> 赞同：0
> 
> 时间：2012-05-08T18:51:45.037
> 
> 标签：java, jersey

我有一个使用 Jersey 的端点，它接受一个对象。该对象有一个列表作为成员之一。但是，当我发送一个空数组时，它会在列表中给我一个空元素。通过“空元素”，我的意思是那里有一个对象并且所有字段都是空的。

```
@XMLRootElement
public class myContainer {
  public List<myObject> list;
  // etc
}

@XMLRootElement
public class myObject {
  public String data1;
  public String data2;
  // etc
}

// I hit the following with "{\"list\":[]}"    

@POST
@Consumes(MediaType.APPLICATION_JSON)
public Response post(final myContainer x) {
  for (myObject obj : x.list) {
    // why do I hit this?
    // debugging, I actually have an object here with all null fields
    obj.data1 == null; // true
    obj.data2 == null; // true
  }
} 
```

有人知道泽西岛为什么会这样做吗？

我将 WRITE_NULL_PROPERTIES 设置为 false，但我不知道这会如何影响这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T10:10:43.360

我不确定，但也许设置

```
@XmlElemet(nillable=true)
public List<myObject> list; 
```

你在找什么？

# prolog - Prolog中的树后序遍历

> ID：10504656
> 
> 赞同：4
> 
> 时间：2012-05-08T18:51:49.067
> 
> 标签：prolog, dcg

树遍历是指系统地访问树数据结构中的每个节点的过程。下图中的`postorder`遍历

[排序二进制树](http://en.wikipedia.org/wiki/File%3aSorted_binary_tree.svg)

返回`A, C, E, D, B, H, I, G, F (left, right, root)`。`PREORDER`遍历的 Prolog 代码是

```
preorder(tree(X,L,R),Xs) :-
    preorder(L,Ls),
    preorder(R,Rs),
    append([X|Ls],Rs,Xs).

preorder(void,[]). 
```

我想修改上面的代码来实现后序遍历。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:24:03.170

伙计们，在描述列表时请考虑使用 DCG，例如：

```
preorder(void) --> [].
preorder(tree(X, L, R)) -->
        [X],
        preorder(L),
        preorder(R). 
```

用法：

```
?- phrase(preorder(Tree), List). 
```

您只需决定将 [X] 放在序列中的哪个位置即可获得不同的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:14:49.317

在后序的情况下，您必须遍历左分支并获取节点值列表`Left`，然后遍历右分支并获取节点值列表`Right`，最后返回 Left、Right 和`node value`.

因此，修改代码将重新排列实例化结果列表的方式：

```
postorder(tree(X, L, R), Xs):-
  postorder(L, Ls),
  postorder(R, Rs),
  append(Ls, Rs, Xs1),
  append(Xs1, [X], Xs).
postorder(void, []). 
```

但是请注意，从它不是尾递归的意义上说，此代码是次优的。您应该考虑在累加器的帮助下实现它。

# c# - 记录函数调用层次结构

> ID：10504659
> 
> 赞同：1
> 
> 时间：2012-05-08T18:52:06.893
> 
> 标签：c#, .net, documentation

我正在开发一个广泛的包装库。由于包装器不会一对一地映射到底层函数，因此记录函数调用层次结构将是有益的。

实现这一目标的最佳方法是什么？理想情况下，可以集成到 XML 注释中并用于生成可读/可搜索的文档。但欢迎任何实际的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:12:38.610

[Doxygen 可以生成调用图。 ![在此处输入图像描述](../Images/3e29b934158609c653a01d338a74f3c0.png)](http://www-scf.usc.edu/~peterchd/doxygen/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T18:44:53.213

Sandcastle 概念主题具有可以嵌入到 XML 注释中的块元素，例如表格、列表。您需要使用这些元素枚举流序列。

或者，您可以使用 VS2010 中的架构工具或 NDepend 等其他工具生成调用图、序列图，并使用 html 标签将这些图像嵌入到文档中。

# c# - 设计一个sqlite服务器客户端程序

> ID：10504661
> 
> 赞同：0
> 
> 时间：2012-05-08T18:52:15.803
> 
> 标签：c#, database, sqlite, sockets

我正在考虑使用 sqlite 作为数据库来实现测试，但 sqlite 不支持服务器 - 客户端架构。由于它，我在实现 sqlite 服务器 - 客户端时使用谷歌搜索并找到一些文章和源代码。

我首先发现它[http://www.sqlitening.com/](http://www.sqlitening.com/)是开源的，但在 PowerBasic 中编码。后来在谷歌代码页[http://code.google.com/p/sqlite3-server-cs/source/browse/#svn%2Ftrunk](http://code.google.com/p/sqlite3-server-cs/source/browse/#svn%2Ftrunk)中找到， 但他没有提供任何有关使用的文档。

由于它，我认为使用套接字编写我自己的简单实现，但我担心浪费我的时间编码没有好的或没有安全的替代方案。

我的问题是，写一个 sqlite 服务器 - 客户端但使用线程是个好主意吗？我担心插入数据的锁定问题，sqlite允许读取许多连接但只能插入一个。

我正在等待您的反馈。

城堡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T17:59:46.383

我解决了它编写自己的服务器实现。但插入的sqlite确实很慢。

10 个用户同时写入 50 个寄存器，同时占用 10 段或更多段，具体取决于网络流量。

我使用无线网络进行了测试。

我切换到 CUBRID 数据库。但我正在测试如何使用存储过程仅支持 java 应用程序，并且 ado.net 驱动程序不适用于 CUBRID 函数/存储过程（可能是一个错误）。

# java - 我可以在 GXT 中的鼠标单击事件中将 ContentPanel 添加到 ContentPanel 中吗

> ID：10504671
> 
> 赞同：0
> 
> 时间：2012-05-08T18:52:56.047
> 
> 标签：java, gwt, gxt

我想在鼠标单击事件中从 ContentPanel 中删除所有元素并添加新元素。使用 removeAll() 方法可以正常工作，这会删除所有现有组件。但是当我想添加一个新组件时，它不会被添加。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T09:45:01.120

也许像这样的事情我省略了点击处理程序，但你应该从中得到想法。

```
private ContentPanel contentPanel;

public SwapScreen() {
 contentPanel = new ContentPanel();
 add(contentPanel);
}

public void swap1() {

   /*This should be split into a separate
    method and called only once to avoid recreating them.*/
   field1 = new TextField<String>();
   contentPanel.add(field1);

   field2 = new TextField<String>();
   contentPanel.add(field2);

  this.layout(true);
}

public void swap2() {

   /*This should be split into a separate
    method and called only once to avoid recreating them.*/
   anotherField1 = new TextField<String>();
   contentPanel.add(anotherField1);

   anotherField2 = new TextField<String>();
   contentPanel.add(anotherField2);

   this.layout(true);
} 
```

最重要的部分是`this.layout(true)`强制它刷新你的布局，

# c# - 在桌面上选择区域矩形

> ID：10504672
> 
> 赞同：7
> 
> 时间：2012-05-08T18:53:05.900
> 
> 标签：c#, .net, graphics, screenshot

我正在尝试在 C#.NET 中创建一个模仿 Windows 7 截图工具功能的应用程序，当应用程序运行时（或通过特定的击键或我选择启动它），用户可以绘制一个矩形在屏幕上无论哪个窗口都有焦点，以捕捉桌面的矩形快照。

我已经知道如何使用 Graphics.CopyFromScreen() 方法来保存给定特定矩形的快照，但我难过的是实际的矩形选择以及如何从中获取边界。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:31:49.510

TeboScreen [: Basic C# Screen Capture Application](http://www.codeproject.com/Articles/21913/TeboScreen-Basic-C-Screen-Capture-Application) on Code Project 正是这样做的。

> 按住鼠标左键，用户绘制一个矩形，指定他们希望捕获的屏幕部分。... mouse_Move 事件用于决定用户是在绘制、拖动（移动）还是调整选择区域的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:34:21.830

用户实际上并没有在屏幕上绘制矩形，而是在捕获的图像上绘制。当用户调用您的工具时需要发生的一系列事件是：

1.  捕获整个桌面
2.  创建一个屏幕大小的无边框窗口（或跨越所有屏幕的窗口，可能[在这里](https://stackoverflow.com/questions/445893/create-window-larger-than-desktop-display-resolution)使用此方法），并将映射到屏幕位置/尺寸的单独图像设置为各自的屏幕截图。
3.  允许用户使用[此处](https://stackoverflow.com/questions/9374806/winforms-a-draggable-transparent-rectangle)的代码在您的表单上进行橡皮筋选择。
4.  一旦用户完成选择区域，创建一个与用户选择一样大的位图。
5.  找到用户矩形与图像的交点
6.  将这些区域一一复制到您在步骤 4 中创建的图像。
7.  保存此图像。
8.  喜极而泣。

# php - 如何使用php获取当前页面的url

> ID：10504674
> 
> 赞同：3
> 
> 时间：2012-05-08T18:53:18.110
> 
> 标签：php, url, get

> **可能重复：**
> [如何在 PHP 中获取当前页面的完整 URL](https://stackoverflow.com/questions/189113/how-do-i-get-current-page-full-url-in-php)

如何使用 php 获取当前页面的 url？有没有这样的php函数？

我想要实现的是：

1.  以某种方式获取当前页面的 url
2.  检查 url 是否等于某个预设值
3.  如果相等，则回显其他内容 回显其他内容

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T18:54:44.983

```
<?php
    $url="http://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];
    echo $url;
?> 
```

# kendo-ui - 剑道数据源和网格内联编辑，添加一个新项目，总是创建一个 id 为 0 的新行

> ID：10504675
> 
> 赞同：0
> 
> 时间：2012-05-08T18:53:29.207
> 
> 标签：kendo-ui

我正在使用带有剑道网格的剑道数据源进行内联编辑。当我添加/创建新行时，新行将发布到我的创建 URL（我正在使用帖子）。我的问题出在查询参数中，id 字段的值为零，有没有办法在某些 js 事件中将其设为空或将其从查询字符串中删除。在将其发布到创建 url 之前。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T15:20:34.193

听起来 ID 应该是一个自动增量字段，在这种情况下，您不会将 id 插入数据库。然后，您的数据源应该有这样的东西（未记录的方法）在创建后刷新网格，这将使用数据库分配的 ID 填充您的 ID 字段：

```
create: {
    url: "[your create url]",
    complete: function(e){
        $('#grid').data('kendoGrid').dataSource.read();
    }
} 
```

那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T03:08:36.380

不，最新的 KendoUI 的[数据源](http://docs.kendoui.com/api/framework/datasource)传输方法没有名为“完成”的参数。您必须使用 jquery ajax 请求。此外，您只能使用 KendoUI 的 trasnport 方法或 jquery ajax。结合是行不通的。例如：

```
create:function (options) {
    $.ajax({
        url:base + entityName + "/create",
        data:"models=" + kendo.stringify(options.data.models),
        type:"POST",
        dataType:"json",
        async:false,
        global:false,
        success:function (result) {
            if (result.errors == null) {
                //GridHandlers.refreshGrid(gridId);
                options.success(result);
            } else {
                GridHandlers.accounceAndResume(gridId, result.errors);
            }
        },
        error:function (xhr, textStatus, errorThrown) {
            console.log("Error: " + (errorThrown ? errorThrown : xhr.status));
            GridHandlers.accounceAndResume(gridId, "Could not create new record. Connection problem!");
        }
    });
}, 
```

对你来说重要的是你在成功方法中所做的事情。快乐编码！

# ssl - 基于 SSL 的 ActiveMQ：“acceptInvalidBrokerCert=true”不起作用

> ID：10504676
> 
> 赞同：1
> 
> 时间：2012-05-08T18:53:30.437
> 
> 标签：ssl, jms, ssl-certificate, activemq

我发布了一个不同的问题，现在我正在编辑它，因为我设法完成了我最初取得的成就。使用“[我如何使用 SSL](http://activemq.apache.org/how-do-i-use-ssl.html) ”我设置了我的 ActiveMQ 代理接受 SSL 连接，并且我试图实现一个客户端来测试通信。我发现我可以通过设置系统属性来做到这一点：

```
static {
    System.setProperty("javax.net.ssl.keyStore", "/home/amq/SSL/client.ks");
    System.setProperty("javax.net.ssl.keyStorePassword", "password");
    System.setProperty("javax.net.ssl.trustStore", "/home/amq/SSL/client.ts");
} 
```

我遇到的问题是创建密钥库/信任库和导出代理证书。[当我删除 .ks 和 .ts 文件并按照“如何使用 SSL](http://activemq.apache.org/how-do-i-use-ssl.html) ”中的说明重新执行所有操作时，它起作用了。

**我的新问题是：**如何在不需要为客户端创建密钥库和导入代理证书的情况下建立连接？

我正在寻找一种方法来接受经纪人发送给我的任何证书。在[此链接](http://timbish.blogspot.com.br/2010/04/ussing-ssl-in-nmsactivemq.html)中，我找到了一种设置 URI 选项的方法：

```
ssl://localhost:61617?transport.acceptInvalidBrokerCert=true 
```

但这对我不起作用。从我在我的 URI 或 URL 字符串中附加“？transport.acceptInvalidBrokerCert=true”的那一刻起，该方法停止工作，并且我不再可以建立连接。

谁能为我提供一个使用 SSL 连接到 ActiveMQ 代理的 java 或 c++ 客户端示例，而无需导入代理的证书，或者换句话说，接受任何无效证书？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:23:48.667

您引用的 URI 标志仅对使用 NMS.ActiveMQ 的 .NET 客户端有效，C++ 和 Java 客户端没有此设置。在 C++ 客户端中有一种方法可以做到这一点，您必须在创建连接之前按如下方式设置系统属性。

```
System::getProperty("decaf.net.ssl.disablePeerVerification", "false" ); 
```

在没有这些测试选项的情况下让 ssl 证书正常工作的最简单方法是创建一个根证书，然后使用您的根证书创建代理证书，并将根证书添加到客户端的信任库中，这样任何具有您的根签名证书的代理证书将被信任。

# .htaccess - 具有相同名称的子文件夹的 Htaccess 域重定向失败

> ID：10504678
> 
> 赞同：0
> 
> 时间：2012-05-08T18:53:34.340
> 
> 标签：.htaccess

我正在设置一个多站点，我将 site2.com 重定向到 site1.com 中的子文件夹，但是我在使用 htaccess 重定向时遇到了很多麻烦。Site2.com 由 DNS 指向 Site1.com，其中一个 htaccess 文件负责服务器上的重定向。基本设置是这样的：

```
Site 1:
/public_html/

Site 2:
/public_html/site2/ 
```

我目前在 /public_html/ (site1.com) 中使用的 htaccess 重定向方法是这样的：

```
RewriteCond %{HTTP_HOST} ^(www.)?site2.com$ [NC]
RewriteCond %{REQUEST_URI} !^/site2/
RewriteRule ^(.*)$ /site2/$1
RewriteCond %{HTTP_HOST} ^(www.)?site2.com$ [NC]
RewriteRule ^(/)?$ site2/index.html [L] 
```

基本重定向工作正常，即使对于 site2 下的子文件夹也是如此。但是，如果我在每个站点下都有一个同名的子文件夹，则重定向失败，如下所示：

```
/public_html/subfolder/
/public_html/site2/subfolder/ 
```

如果我尝试访问 www.site2.com/subfolder/ 这会呈现 /public_html/subfolder/ 而不是 /public_html/site2/subfolder/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T16:32:51.563

你应该禁用多视图`Options -MultiViews`

# wcf - 简单的 WCF 示例失败

> ID：10504680
> 
> 赞同：0
> 
> 时间：2012-05-08T18:53:40.073
> 
> 标签：wcf

这是一个非常简单的 WCF 示例，我找不到失败的原因。

这是在 WCF 类库项目中定义的

这是定义合约的接口：

```
<ServiceContract()> _
Public Interface IService1

    <OperationContract()> _
    Function GetData(ByVal value As Integer) As String

    <OperationContract()> _
    Function Ping() As Boolean

End Interface 
```

这是接口的实现：

```
<ServiceBehavior(IncludeExceptionDetailInFaults:=True)> _
Public Class Service1
    Implements IService1

    Public Function GetData(ByVal value As Integer) As String Implements IService1.GetData
        Return String.Format("You entered: {0}", value)
    End Function

    Public Function Ping() As Boolean Implements IService1.Ping
        Return True
    End Function
End Class 
```

然后，在一个名为 Server 的控制台应用程序中，我添加了对上面定义的服务的服务引用。我创建服务主机如下：

```
static void Main(string[] args)
{
   try
   {
      ServiceHost serviceHost = new ServiceHost(typeof(ServiceReference.Service1Client));
      NetTcpBinding netTcpBinding = new NetTcpBinding();

      serviceHost.AddServiceEndpoint(typeof(ServiceReference.IService1), netTcpBinding, "net.tcp://localhost:9007/Service/");

      Console.WriteLine("Service started at net.tcp://localhost:9700/Service");

      serviceHost.Open();

      Console.WriteLine("Host opened");
      Console.ReadLine();
   }
   catch (Exception ex)
   {
      Console.WriteLine(ex.Message);
      Console.Read();
   }
   finally
   {
       Console.WriteLine("Service closed");
   }
} 
```

然后，在另一个名为 Client 的控制台应用程序中，我向该服务添加了一个服务引用并创建了一个代理客户端，如下所示：

```
static void Main(string[] args)
{
   NetTcpBinding netTcpBinding = new NetTcpBinding();

   try
   {
       var serviceClient = new Client.ServiceReference1.Service1Client(netTcpBinding, new EndpointAddress("net.tcp://localhost:9007/Service/"));
       serviceClient.InnerChannel.OperationTimeout = TimeSpan.FromMinutes(10);

       Console.WriteLine("Pinging server");               

       if (serviceClient.Ping())
       {
          Console.WriteLine("Getting Data");

          var result = serviceClient.GetData(1);

          Console.WriteLine("Result is " + result);
       }
       else
       {
          Console.WriteLine("Server is not responding");
       }
   }
   catch (Exception ex)
   {
       Console.WriteLine(ex.Message);
   }

   Console.ReadLine();
} 
```

当我运行`Server.exe`它显示*服务在 net.tcp://localhost:9700/Service*

当我运行`Client.exe`它显示*Ping 服务器*

然后我在 WCF 类库项目中得到一个我无法调试的错误，最后一个异常`Client.exe`说

> *这个发送到 net.tcp://localhost:9007/Service/ 的请求操作在配置的超时 (00:01:00) 内没有收到回复。分配给此操作的时间可能是较长超时的一部分。这可能是因为服务仍在处理操作，或者因为服务无法发送回复消息。请考虑增加操作超时（通过将通道/代理转换为 IContextChannel 并设置 OperationTimeout 属性）并确保服务能够连接到客户端。*

在我的笔记本电脑中如此简单并在本地运行，我认为超时或类似的东西没有问题。

谁能解释一下...我会很感激的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:56:36.533

您的代码在打开服务器之前打印一个静态字符串，然后在打开服务器后打印一个字符串：

```
Console.WriteLine("Service started at net.tcp://localhost:9700/Service");

serviceHost.Open();

Console.WriteLine("Host opened"); 
```

您说您看到了第一条消息，但您**从未说过您看到了第二条消息**。在没有看到该消息的情况下，我认为您对 serviceHost.Open(); 的调用可能有问题；

[这是在 WCF http://www.dotnetfunda.com/articles/article704-using-nettcpbinding-in-wcf-.aspx](http://www.dotnetfunda.com/articles/article704-using-nettcpbinding-in-wcf-.aspx)中使用 NetTcpBingings 的示例

有时从别人的代码开始，然后从那里修改它会有所帮助。

# java - 关于对象超类和强制转换的问题

> ID：10504681
> 
> 赞同：3
> 
> 时间：2012-05-08T18:53:41.210
> 
> 标签：java, oop

我正在准备java考试。我遇到了以下问题

```
String s = new String ("hello");
Object o = (object) s; 
```

既然`o`和`s`都是指向同一个对象的引用，那么通过引用而不是引用访问对象有什么区别`s`吗`o`？

我是否正确地说所有对象（例如被 s 引用的对象）都是`Object`Java 中的子类，因此使用引用`s`您将能够调用超类`Object`like已知的方法和like`clone()`已知的方法。然而，超类对象引用只能调用它自己的方法，而不能调用子类的方法？谢谢。`String``length()``o`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:03:03.267

不同之处在于，使用 o 将无法调用特定于字符串的方法，除非将其转换回 String。

但是，您在 o 上调用的任何在 String 类上定义的方法都将调用该方法的更高版本。例如，o.toString() 将返回“hello”，而不是 Object.toString() 通常返回的描述符。这称为多态性。

# regex - 如果包含字符串，则排除正则表达式匹配

> ID：10504683
> 
> 赞同：1
> 
> 时间：2012-05-08T18:53:52.307
> 
> 标签：regex, url

我还在学习正则表达式，我似乎被卡住了。

我想编写一个匹配包含“bulk”的 URL 路径的 reg exp：

```
/bulk-category_one/product
/another-category/bulk-product 
```

只获取产品页面，而不是类别页面，例如：

```
/bulk-category_one/
/another-category/ 
```

所以我想出了：

```
[/].*(bulk).*[/].+|[/].*[/].*(bulk).* 
```

但是有分页，所以当我将 reg exp 放入 Google Analytics 时，我发现如下内容：

```
/bulk-category/_/showAll/1/ 
```

他们都有

```
/_/ 
```

而且我不想要任何包含的 URL 路径

```
/_/ 
```

我不知道如何排除它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:57:08.233

我会这样做：

```
/[^/\s]*bulk[^/]*/[^/\s]+(?!/)|/[^/\s]+/[^/]*bulk[^/\s]*(?!/) 
```

第一部分：

*   `/`- 匹配斜线
*   `[^/\s]*`- 匹配所有不是斜线而不是空格的东西
*   `bulk`- 从字面上匹配批量
*   `[^/]*`- 匹配所有不是斜线的东西
*   `/`- 匹配斜线
*   `[^/\s]+`- 匹配所有不是斜线而不是空格的东西
*   `(?!/)`- 确保之后没有斜线（即 url 有两个部分）

第二部分大致相同，但这次 'bulk' 应该出现在 URL 的第二部分而不是第一部分。

如果您在 url 的第二部分特别需要“产品”一词，则需要另一种选择：

```
/[^/\s]*bulk[^/]*/[^/\s]*product[^/\s]*(?!/)|/[^/\s]+/[^/]*bulk[^/\s]*product[^/\s]*(?!/)|/[^/\s]+/[^/]*product[^/\s]*bulk[^/\s]*(?!/) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T22:17:49.267

如果我将那个简单的正则表达式应用于文件 FILE

```
egrep ".*bulk.*product" FILE 
```

其中包含您上面的示例，它仅与 2 行匹配`bulk`and `product`。此外，我们还可以排除 '/_/'：

```
egrep ".*bulk.*product" FILE | egrep -v "/_/" 
```

两次调用通常比一个万能的调用更容易定义和理解。

# java - 如何通过 WSS4J 使用 Eclipse 生成的代理（轴 1.4）对 SOAP 请求进行数字签名？

> ID：10504686
> 
> 赞同：3
> 
> 时间：2012-05-08T18:54:06.457
> 
> 标签：java, ws-security, axis, wss4j

我已经获得了一个 Web 服务的 WSDL。我现在需要对该请求进行数字签名。以前的开发人员利用 Eclipse 特性来生成代理类。将 WSDL 添加到项目中，然后右键单击它，单击“Web Service”，然后单击“Generate Client”。

在我们被要求对请求进行数字签名之前，这一直很好。我做了一些挖掘，看起来 Axis 1.4 不允许您签署请求。您可以使用 WSS4J 来做到这一点。我在 WSS4j 1.5 中加入了我的项目。

我不知道如何对请求进行数字签名。这是我现有的使用代理类的代码：

```
XiSecureWSServiceLocator service = new XiSecureWSServiceLocator();
service.setXiSecureWSServicePortEndpointAddress(paymetricPortAddress);
XiSecureWSPortType proxy = service.getXiSecureWSServicePort();
((Stub) proxy).setTimeout(paymetricTimeOutinMillisec);

SDecrypt_InputType sdi = new SDecrypt_InputType();
sdi.setStrToken(ccNumber);
sdi.setStrUserID(user);

SDecrypt_OutputType sdo = null;
sdo = proxy.pm_SingleDecrypt(sdi); 
```

我想做的是类似于[这篇文章](http://www.devx.com/Java/Article/28816/1763/page/4)的事情。这是他们使用的一个函数：

```
public Message signSOAPEnvelope(SOAPEnvelope
unsignedEnvelope) throws Exception
{
  WSSignEnvelope signer = new WSSignEnvelope();
  String alias = "16c73ab6-b892-458f-abf5-2f875f74882e";
  String password = "security";
  signer.setUserInfo(alias, password);
  Document doc = unsignedEnvelope.getAsDocument();
  Document signedDoc = signer.build(doc, crypto);
  // Convert the signed document into a SOAP message.
  Message signedSOAPMsg =
  (org.apache.axis.Message)AxisUtil.toSOAPMessage(signedDoc);
  return signedSOAPMsg;
} 
```

当创建它的所有代码都隐藏在生成的代理类中时，我如何才能对 Soap Envelope 进行签名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T17:21:09.880

[这个 JavaRanch 线程](http://www.coderanch.com/t/520488/Web-Services/java/Configuring-SOAP-Header-client)解释了使用 Axis 处理程序使用 WSS4J 实现安全性和加密。

看起来你必须做很多事情：

1.  配置/编写 wsdd
2.  使用指向您的 wsdd 文件的 EngineConfiguration 调用 Web 服务
3.  编写密码回调类
4.  编写一个 crypto.properties 文件
5.  确保 crypto.properties 文件和包含证书的密钥库位于应用程序的类路径中。

在 JavaRanch 论坛上向 John Farrel 表示支持，以解决所有这些问题。

总而言之，有点蛋疼。如果有办法从 Axis 代理类获取底层 SOAP 消息本身，那可能是一种更快的方法，但我对 Axis 1 没有太多经验。

顺便说一下，来自 /r/java 的您好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:04:19.307

发现这个：

> > > 任何人都可以向我推荐或指出我在某个地方描述了一种简单、直接的方式来使用 Axis 框架内的数字签名对 SOAP 请求进行签名吗？

“看看 WSS4J 项目。它们提供 Axis 处理程序用于签名和加密，如 WS 安全中所述。”

[http://mail-archives.apache.org/mod_mbox/axis-java-user/200403.mbox/%3CCGEOIPKACAGJDDPKCDIHEEKACCAA.abhinavm@contata.co.in%3E](http://mail-archives.apache.org/mod_mbox/axis-java-user/200403.mbox/%3CCGEOIPKACAGJDDPKCDIHEEKACCAA.abhinavm@contata.co.in%3E) -

这有帮助吗？

# asp.net-mvc - 如何为下拉列表添加自定义查询并保留视图模型模式？

> ID：10504688
> 
> 赞同：0
> 
> 时间：2012-05-08T18:54:14.497
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, view-model-pattern

我读过很多文章，他们说查询不应该放在控制器中，但我似乎看不出我还能把它放在哪里。

我当前的代码：

```
public class AddUserViewModel 
{        
    public UserRoleType UserRoleType { get; set; }
    public IEnumerable<SelectListItem> UserRoleTypes { get; set; }

}

public ActionResult AddUser()
    {
        AddUserViewModel model = new AddUserViewModel()
        {

            UserRoleTypes = db.UserRoleTypes.Select(userRoleType => new SelectListItem
            {
                Value = SqlFunctions.StringConvert((double)userRoleType.UserRoleTypeID).Trim(),
                Text = userRoleType.UserRoleTypeName
            })
        };
        return View(model);  
    } 
```

风景：

```
<li>@Html.Label("User Role")@Html.DropDownListFor(x => Model.UserRoleType.UserRoleTypeID, Model.UserRoleTypes)</li> 
```

如何保留视图模型和查询并排除不应显示的用户类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:02:34.570

我认为你做得很好。

无论如何...从控制器中删除查询逻辑所能做的就是拥有一个 ServiceLayer，您可以在其中进行查询并返回结果。

这里的 MVC 模式使用正确......您缺少的是其他 2 层（BusinessLayer 和 DataAccessLayer）......因为 ASP.NET MVC 是 UI 层。

**更新，由于评论：**

使用`var userroletypes = db.UserRoleTypes.Where(u=> u.UserRoleType != 1);` 就OK了，它会返回一个满足查询的UserRoleType列表。

然后，只需使用 userroletypes 集合创建一个新的 SelectList 对象...并将其分配给相应的 viewmodel 属性。然后将该 ViewModel 传递给 View。

*顺便说一句，我以前从未使用过该`db.XXXX.Select()`方法，不确定它的作用......我总是使用`Where`子句。*

**第二次更新：** 从作为 SelectItem 集合的 SelectList 加载 DropDownList。因此，您需要将查询结果的集合转换为 SelectList 对象。

```
var userroletypes = new SelectList(db.UserRoleTypes.Where(u=> u.UserRoleType != 1), "idRoleType", "Name"); 
```

然后你创建你的 ViewModel

```
var addUserVM = new AddUserViewModel();
addUserVM.UserRoleTypes = userroletypes; 
```

并传递`addUserVM`给您的视图：

```
return View(addUserVM ); 
```

*注意：*我假设您的 ViewModel 具有 type 的属性`SelectList`...但是您的属性是这样的`public IEnumerable<SelectListItem> UserRoleTypes { get; set; }`，因此您可以更改它或调整我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T18:59:25.207

除了这个实例之外，我认为您的代码没有任何问题`db`，我认为这是您在控制器中硬编码的一些具体 EF 上下文，因此无法单独进行单元测试。您的控制器操作与常见的 GET 控制器操作完全相同：

1.  查询 DAL 以获取域模型
2.  将域模型映射到视图模型
3.  将视图模型传递给视图

进一步的改进是从您的视图模型中摆脱`UserRoleType`域模型类型，使其成为真正的视图模型：

```
public class AddUserViewModel 
{
    [DisplayName("User Role")]
    public string UserRoleTypeId { get; set; }

    public IEnumerable<SelectListItem> UserRoleTypes { get; set; }
} 
```

接着：

```
public ActionResult AddUser()
{
    var model = new AddUserViewModel()
    {
        UserRoleTypes = db.UserRoleTypes.Select(userRoleType => new SelectListItem
        {
            Value = SqlFunctions.StringConvert((double)userRoleType.UserRoleTypeID).Trim(),
            Text = userRoleType.UserRoleTypeName
        })
    };
    return View(model);  
} 
```

在视图中：

```
@model AddUserViewModel 
<li>
    @Html.LabelFor(x => x.UserRoleTypeId)
    @Html.DropDownListFor(x => x.UserRoleTypeId, Model.UserRoleTypes)
</li> 
```

# python - 如何格式化具有最大小数位数且没有额外零填充的浮点数？

> ID：10504697
> 
> 赞同：27
> 
> 时间：2012-05-08T18:55:00.263
> 
> 标签：python, string-formatting, padding

我需要在 python 中做一些小数位格式。优选地，浮点值应始终显示至少一个起始 0 和一个小数位。例子：

```
Input: 0
Output: 0.0 
```

具有更多小数位的值应继续显示它们，直到它得到 4。所以：

```
Input: 65.53
Output: 65.53

Input: 40.355435
Output: 40.3554 
```

我知道我可以使用 {0.4f} 让它打印到小数点后四位，但它会用不需要的 0 填充。是否有格式代码告诉它打印出一定数量的小数，但如果没有数据则将它们留空？我相信 C# 可以通过以下方式实现这一点：

```
floatValue.ToString("0.0###") 
```

其中 # 符号表示可以留空的地方。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-08T20:07:04.353

你所要求的应该通过像内置[`round`](https://docs.python.org/3/library/functions.html#round)函数这样的舍入方法来解决。然后让`float`数字以其`string`表示形式自然显示。

```
>>> round(65.53, 4)  # num decimal <= precision, do nothing
'65.53'
>>> round(40.355435, 4)  # num decimal > precision, round
'40.3554'
>>> round(0, 4)  # note: converts int to float
'0.0' 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-08T19:24:56.317

对不起，我能做的最好的：

```
' {:0.4f}'.format(1./2.).rstrip('0') 
```

更正：

```
ff=1./2.
' {:0.4f}'.format(ff).rstrip('0')+'0'[0:(ff%1==0)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-07-30T21:44:47.597

通过反复试验，我认为`:.15g`这就是您想要的：

```
In: f"{3/4:.15g}"
Out: '0.75'

In f"{355/113:.15g}"
Out: '3.14159292035398' 
```

（同时`f"{3/4:.15f}" == '0.750000000000000'`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:45:41.227

```
>>> def pad(float, front = 0, end = 4):
    s = '%%%s.%sf' % (front, end) % float
    i = len(s)
    while i > 0 and s[i - 1] == '0':
        i-= 1
    if s[i - 1] == '.' and len(s) > i:
        i+= 1 # for 0.0
    return s[:i] + ' ' * (len(s) - i)

>>> pad(0, 3, 4)
'0.0   '
>>> pad(65.53, 3, 4)
'65.53  '
>>> pad(40.355435, 3, 4)
'40.3554' 
```

# c# - Action 动态生成的弱事件失败 来电

> ID：10504700
> 
> 赞同：0
> 
> 时间：2012-05-08T18:55:27.007
> 
> 标签：c#, linq, delegates, weak-references

我正在使用[SharpObservation](http://sharpobservation.codeplex.com/)框架来动态生成弱事件引用。当我从委托中引用一个操作时，我得到一个 TypeAccessException。

尝试通过方法“DynamicClass.Construct(System.EventHandler `1<XYZ>, System.Action`11<XYZ>>, System.Delegate)”访问类型“System.Action3c__DisplayClass6,System.Object,XYZ>”失败。

如果我删除该操作，那么一切正常。我什至尝试注释掉整个动作，但它仍然失败。我相信这与编译器从操作创建的方法是私有的或内部的或某些东西有关，因此无法从外部访问它。我将如何解决这个问题？

```
 Action eventCompleted = () =>
    {
        SomeMethod();
    };

  EventHandler<XYZ> eventDelegate = delegate
    {          
      System.Windows.Application.Current.Dispatcher.BeginInvoke(eventCompleted);
    };

  newItem.Event += eventDelegate.MakeWeak(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:01:34.827

我不得不修改源以不进行 JIT 访问检查。这存在一些安全问题。（添加了 true 参数）

```
var dynamicMethod = new DynamicMethod("Construct", typeof(TDelegate), args, true); 
```

# android - ListAdapter - 获取即将出现在屏幕上的下一行？（用于位图预加载）

> ID：10504702
> 
> 赞同：4
> 
> 时间：2012-05-08T18:55:41.463
> 
> 标签：android

我有一个列表适配器，它在每一行中显示一张大照片。我在 ListAdapter.getView() 方法的线程中从磁盘上获取位图。这很好用，但有点烦人的是，当用户滚动时，他们会看到新行的顶部出现在屏幕上，ImageView 为空。从磁盘读取位图的线程很快完成，然后发生重绘。

ListAdapter 世界中是否有一个好的模式来表明“下一个”行有瞬间出现在屏幕上的危险？理想情况下，我想启动一个线程来加载这个不可见行的位图并将位图放入我的内存缓存中，这样如果用户滚动到这个单元格，位图就已经被加载了。

我想我需要知道（1）用户正在向下滚动并且（2）下一个不可见行的顶部边缘大约是 20 像素或距离可见的某个值。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:08:56.433

注册一个`AbsListView.OnScrollListener`；您将被通知列表的滚动状态，并且您还将获得当前可见的项目。结合这两个参数，您应该很容易决定是否需要加载“下一个”位图。

# android - 如何从 Android Facebook SSO 中的 webview 获取回调？

> ID：10504707
> 
> 赞同：0
> 
> 时间：2012-05-08T18:56:25.673
> 
> 标签：android, facebook, oauth

我正在构建一个使用 Facebook SSO 的 Android 应用程序，如标准教程示例中所述：[https](https://developers.facebook.com/docs/mobile/android/build/) ://developers.facebook.com/docs/mobile/android/build/ 。

具体来说，我的代码在用户按下这样的按钮后调用 facebook.authorize() ：

```
View.OnClickListener handler = new View.OnClickListener() {
    public void onClick(View v) {

    if (v == btnFB) {

        if(!facebook.isSessionValid()) {
            facebook.authorize(this, new String[] {}, new DialogListener() {

                @Override
                public void onComplete(Bundle values) {
                    SharedPreferences.Editor editor = mPrefs.edit();
                    editor.putString("access_token", facebook.getAccessToken());
                    editor.putLong("access_expires", facebook.getAccessExpires());
                    editor.commit();
                }

                @Override
                public void onFacebookError(FacebookError error) {}

                @Override
                public void onError(DialogError e) {}

                @Override
                public void onCancel() {}
            });
        }
        else {
            // already have a valid access token, so use it
            String status = "FB access token is: " + facebook.getAccessToken();
            Log.i(status);

            // and fire off an intent service to do something on my server ...
        }
    }
} 
```

回调定义为：

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    facebook.authorizeCallback(requestCode, resultCode, data);

    // fire off the same intent as above ...
} 
```

如果设备上安装了 Facebook 应用程序，则对 facebook.authorize() 的调用可以正常工作，并且 onActivityResult() 回调也可以正常工作。但是，当设备上未安装 Facebook 应用程序时，该示例不会显示如何从 web 视图设置我需要的回调（尽管授权调用最终会设置访问令牌）。

Facebook 教程说“如果手机上没有安装 Facebook 应用程序，SSO 将回退到基于 webview 的 oauth dialg”，但我不知道在这种情况下如何设置回调。

我的应用程序的结果是用户必须按两次按钮。第一次调用授权并创建一个有效的会话。但由于没有回调，用户必须再次点击按钮，应用程序才能继续使用有效的访问密钥 - 显然不是一个好的体验。

我将不胜感激任何关于如何处理上述情况的建议或见解，即当设备上未安装 Facebook 应用程序时。非常感谢！

# wcf - 将我的 Web 服务重新发布到同一位置后，如何恢复 .cs 文件？

> ID：10504710
> 
> 赞同：1
> 
> 时间：2012-05-08T18:56:39.470
> 
> 标签：wcf, publish, file-recovery

我尝试在 Visual Studio 中重新发布我的 WCF 解决方案并取消选中“在目标上保留额外文件（不要删除）”复选框。现在我的整个解决方案都变坏了。Visual Studio 找不到我的任何文件。有人知道我这种愚蠢的解决方案吗？任何帮助将非常感激！！

我找到了解决方案。这些文件也存储在“/Libraries/Documents/IIShosted”中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:11:08.820

请参阅[创建发布配置文件下的 MSDN 上的 #7](http://msdn.microsoft.com/en-us/library/dd465337.aspx)。

> **在以下情况下，发布过程会删除目标服务器上的文件：**
> 
> 1.  您清除在目标上保留额外文件选项。
>     
>     
> 2.  这些文件已存在于目标服务器上的发布位置或任何子文件夹中。
>     
>     
> 3.  Web 应用程序项目的相同文件夹中不存在相同的文件。

# desire2learn - Desire2Learn SOAP 和 Valence API 中的课程信息

> ID：10504711
> 
> 赞同：1
> 
> 时间：2012-05-08T18:56:41.983
> 
> 标签：desire2learn

在 Desire2Learn 中，给定课程的 ID 和名称/描述在 SOAP 和 Valence API 中是否具有相同的值？此外，是否有用于检索用户可用课程列表的 Valence API 调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:19:03.473

[就您问题的建议调用部分而言：您可以使用myenrollments 调用](http://docs.valence.desire2learn.com/res/enroll.html#get--d2l-api-lp-%28D2LVERSION-version%29-enrollments-myenrollments-)获取注册列表（课程和部门以及您学校的任何其他结构）

要按组织单位类型过滤，您可以先[检索类型](http://docs.valence.desire2learn.com/res/orgunit#get--d2l-api-lp-%28D2LVERSION-version%29-outypes-)

# c++ - 运行发布构建的应用程序时出现访问冲突异常

> ID：10504714
> 
> 赞同：0
> 
> 时间：2012-05-08T18:56:45.927
> 
> 标签：c++, release, access-violation

最近我一直在开发一个小的 OpenGL 游戏。其中的所有内容在调试版本中运行良好，但是当我构建版本时，我得到了一个奇怪的访问冲突异常。

我搜索了代码，似乎在我尝试打开文件时出现了问题。这是我认为问题出在的函数：

```
#define LOCAL_FILE_DIR "data\\"
#define GLOBAL_FILE_DIR "..\\data\\"

std::string FindFile(const std::string &baseName)
{
    std::string fileName = LOCAL_FILE_DIR + baseName;
    std::ifstream testFile(fileName.c_str()); // The code breaks here
    if(testFile.is_open())
        return fileName;

    fileName = GLOBAL_FILE_DIR + baseName;
    testFile.open(fileName.c_str());
    if(testFile.is_open())
        return fileName;

    throw std::runtime_error("Could not find the file " + baseName);
} 
```

此代码与加载 GLSL 着色器相关联。一个函数获取着色器的文件名，然后将其传递给 FindFile 以查找所需的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T20:57:04.023

正如个人（和教学）经验的一般规则：> 90% 的调试工作正常和发布崩溃的情况是由于未初始化的变量。这在 C++ 中比在 C 中更难做到，但这是一个非常常见的问题。确保所有变量（如`baseName`）在使用之前都已初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T14:51:36.153

我解决了这个问题。

一切都在发生，因为我使用 glsdk 的 Debug 构建库进行了 Release 构建。更改为 Release 构建库解决了该问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:44:28.567

检查 baseName 是否有效。尝试打印出来。您可能会得到一个损坏的 baseName 副本，或者您的堆栈可能在此之前已被丢弃（相同的结果）。

# c# - WebService 作为 Presenter

> ID：10504717
> 
> 赞同：2
> 
> 时间：2012-05-08T18:57:06.020
> 
> 标签：c#, asp.net, ajax, web-services, mvp

我正在开发一个 ASP.NET Web 应用程序，我想使用 MVP 创建清晰的体系结构。由于应用程序类型，存在从视图到网站后端的 AJAX 请求。我想知道如果我向 WebService（它将充当 Presenter）发出 AJAX 请求，它将使用模型控制业务逻辑并将结果作为序列化数据返回给视图，这是否是合法的 MVP？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:20:01.177

AJAX 不是在充当演示者吗？

如果我错了，请纠正我，但我曾经认为 Presenter 持有对 a 的引用`Display`（这是视图的接口），因此会填充视图。然而，Web 服务被查询并返回一个结果，这在我看来就像一个 MVP 模型......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:14:58.907

在 AJAX 的帮助下从您的网页调用 Web 服务没有任何违法行为。但是，我不确定是什么阻止您借助经典的 ASP.NET WebForms 应用程序设计出清晰的 MVP 架构？您可以构建非常轻量级的视图（例如，仅具有客户端 JavaScript / html 代码）并为您的视图创建一个 Presenter 类。

我的意见是：除非这是唯一可能的方法，否则我会尽量避免设计和托管 Web 服务来提供网页服务。当涉及到应用程序的部署和配置时，可能会出现问题。还要考虑身份验证等...另一个问题是：如何将您的功能拆分为服务以及您需要多少服务。

# google-drive-api - 谷歌驱动器示例

> ID：10504718
> 
> 赞同：0
> 
> 时间：2012-05-08T18:57:14.507
> 
> 标签：google-drive-api

我无法运行 PHP 的 dredit 示例，如您在此处看到的，我无法授予对应用程序的访问权限，始终重定向到 auth：

[http://drivecrypt.sofistic.net](http://drivecrypt.sofistic.net)

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:02:54.503

[您是否遵循https://developers.google.com/drive/examples/php#setting_up_this_sample_application](https://developers.google.com/drive/examples/php#setting_up_this_sample_application)中列出的所有设置步骤？

更具体地说，您是否注册了您的应用（第 2 步）并在 Chrome 网上商店中为其创建了列表（第 3 步）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:03:16.280

我将 access_type=online 更改为 access_type=offline 并再次工作。

# r - 更改 ggplot 中的默认调色板

> ID：10504724
> 
> 赞同：34
> 
> 时间：2012-05-08T18:57:33.200
> 
> 标签：r, ggplot2

我编写了一个返回颜色名称向量的函数：

```
custom.colors <- function(n) {
  palette <- c("dodgerblue1", "skyblue4", "chocolate1", "seagreen4",
               "bisque3", "red4", "purple4", "mediumpurple3",
               "maroon", "dodgerblue4", "skyblue2", "darkcyan",
               "darkslategray3", "lightgreen", "bisque",
               "palevioletred1", "black", "gray79", "lightsalmon4",
               "darkgoldenrod1")
  if (n > length(palette))
    warning('palette has duplicated colours')
  rep(palette, length.out=n)
} 
```

我希望 ggplot 默认使用上述函数生成调色板。也许只适用于离散尺度。每次使用`scale_manual()`都太累了。可能吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-05-08T09:54:13.287

要重新定义默认色标，您也可以重新定义`ggplot`函数：

```
ggplot <- function(...) ggplot2::ggplot(...) + scale_color_brewer(palette="Spectral") 
```

这同样适用于填充比例。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2020-06-05T13:28:55.617

17 天前 (2020-05-19) [Carson Sievert 的工作已合并](https://github.com/tidyverse/ggplot2/pull/3833)`ggplot2.discrete.fill`到 ggplot2 的开发版本中，允许使用选项 ( & )指定默认的离散调色板`ggplot2.discrete.color`：

```
options(ggplot2.discrete.color = c("red", "#af01ef")) 
```

它还允许指定几个不同大小的托盘（使用最小的足够的调色板）：

```
options(ggplot2.discrete.color = list(c("red", "#af01ef"), custom.colors(99))) 
```

不幸的是，它不采用调色板功能（如您的`custom.colors`），但它确实采用了缩放功能（因此您可以按照[@ernestA 的答案](https://stackoverflow.com/a/10508569/1870254)中概述的方式构建一个以产生您想要的警告）。

来自[新闻](https://github.com/tidyverse/ggplot2/blob/master/NEWS.md)：

> `options()`现在可以通过of `ggplot2.discrete.colour`和配置默认的离散色阶`ggplot2.discrete.fill`。当设置为具有足够长度的颜色代码字符向量（或字符向量列表）时，这些颜色用于默认比例。有关`help(scale_colour_discrete)` 更多详细信息和示例，请参阅 (@cpsievert, #3833)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-09T01:02:04.110

@baptiste 将我指向一个留言板帖子，其中提到了`set_default_scale`可用于设置默认调色板的功能。不过，以下解决方案仅适用于旧版本的 ggplot2。

首先，我们需要一个生成颜色名称或代码的函数。我打电话给我的`magazine.colours`：

```
magazine.colours <- function(n, set=NULL) {
  set <- match.arg(set, c('1', '2'))
  palette <- c("red4", "darkslategray3", "dodgerblue1", "darkcyan",
               "gray79", "black", "skyblue2", "dodgerblue4",
               "purple4", "maroon", "chocolate1", "bisque3", "bisque",
               "seagreen4", "lightgreen", "skyblue4", "mediumpurple3",
               "palevioletred1", "lightsalmon4", "darkgoldenrod1")
  if (set == 2)
    palette <- rev(palette)
  if (n > length(palette))
    warning('generated palette has duplicated colours')
  rep(palette, length.out=n)
} 
```

（它接受一个可选`set`参数，只是为了表明您不限于单个调色板。）好的，现在我们创建一个“比例”，我称之为`magazine`. 它基于 ggplot 的 brewer scale 并且代码非常难看：

```
ScaleMagazine <- proto(ScaleColour, expr={
  objname <- 'magazine'
  new <- function(., name=NULL, set=NULL, na.colour='yellowgreen',
                  limits=NULL, breaks = NULL, labels=NULL,
                  formatter = identity, variable, legend = TRUE) {
    b_and_l <- check_breaks_and_labels(breaks, labels)
    .$proto(name=name, set=set, .input=variable, .output=variable,
            .labels = b_and_l$labels, breaks = b_and_l$breaks,
            limits= limits, formatter = formatter, legend = legend,
            na.colour = na.colour)
  }
  output_set <- function(.) {
    missing <- is.na(.$input_set())
    n <- sum(!missing)
    palette <- magazine.colours(n, .$set)
    missing_colour(palette, missing, .$na.colour)
  }
  max_levels <- function(.) Inf
})
scale_colour_magazine <- ScaleMagazine$build_accessor(list(variable = '"colour"'))
scale_fill_magazine <- ScaleMagazine$build_accessor(list(variable = '"fill"')) 
```

这里重要的是定义`output_set`ggplot 调用哪个函数来获取颜色名称/代码。此外，如果您需要额外的参数，则必须包含这些参数，`new`并且以后可以作为`.$argument_name`. 在上面的示例中，`output_set`只需调用`magazine.colours`.

现在，检查新比例是否真的有效：

```
qplot(mpg, wt, data=mtcars, shape=21,
      colour=factor(carb), fill=factor(carb)) +
  scale_colour_magazine(set='1') +
  scale_fill_magazine(set='1') 
```

要将其设为默认值，只需使用`set_default_scale`.

```
set_default_scale("colour", "discrete", "magazine") 
set_default_scale("fill", "discrete", "magazine") 
```

就是这样。

```
> qplot(mpg, wt, data=mtcars, colour=factor(carb), fill=factor(carb)) 
```

![显示新调色板的图](../Images/44a5f581e9309adbd83686d58882667f.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-06-01T12:09:57.993

只需使用所需比例的名称分配一个变量：

```
scale_colour_discrete <- function(...)
  scale_colour_manual(..., values = c('dodgerblue1', *)) 
```

这是可行的，因为 ggplot 将尽可能从全局环境中获取其默认比例，类似于：

```
get('scale_colour_discrete', envir = globalenv()) 
```

# c# - 公用文件夹上的 Windows 窗体 app.config

> ID：10504730
> 
> 赞同：1
> 
> 时间：2012-05-08T18:58:03.400
> 
> 标签：c#, .net, winforms, app-config

我有一个在 app.config 文件中存储单个用户名和密码的应用程序。我目前有 app.config 在运行时可写，以便用户能够更改它。

问题从使用安装项目安装时开始，app.config 安装在任何用户都不可写的程序文件上。

因此，我在安装时将 app.config 位置更改为公共文件夹，以便所有用户都可以读取和写入。

现在，在安装时，存储在那里的数据似乎根本无法访问，例如使用 ConfigurationManager.AppSettings["networkPath"] 返回空字符串。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:44:24.467

你可以通过两种方式做到这一点：

1.  由您的安装程序授予程序文件中的应用程序配置文件的特殊权限。我们使用 innosetup 来完成。如果您无能为力，请从程序启动开始：

    ```
    static void Main()
    {
        GrantAccess()
    }

    private static bool GrantAccess()
    {
        FileInfo fInfo = new FileInfo(Assembly.GetEntryAssembly().Location + ".config");
        FileSecurity dSecurity = fInfo .GetAccessControl();
        fSecurity.AddAccessRule(new FileSystemAccessRule("everyone", 
                                                         FileSystemRights.FullControl, 
                                                         AccessControlType.Allow));
        fInfo .SetAccessControl(fSecurity);
        return true;
    } 
    ```

2.  否则，您可以选择另一个位置来放置您的 appconfig 文件，然后像这样读取它：

    ```
    ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
    fileMap.ExeConfigFilename = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData), Assembly.GetEntryAssembly().GetName().Name) + ".exe.config";
    Configuration config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, 
                                                                           ConfigurationUserLevel.None);
    return config.AppSettings.Settings["Key"].Value); 
    ```

在我看来，这是一个糟糕的选择。

# php - 使用包含添加条件

> ID：10504731
> 
> 赞同：0
> 
> 时间：2012-05-08T18:58:12.660
> 
> 标签：php, cakephp

我有以下情况：

模型 1
模型 2

```
$this->Model1->find('all', 
      array('contain' => array('Model2' => array('conditions' => array('Model1.field > Model2.field'))); 
```

上面的代码行不工作，谁能帮我找到问题。请忽略语法，只看情况，然后告诉我如何处理第二个模型的数据取决于第一个模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:18:25.540

尝试这个：

```
$this->Model1->find('all', array(
    'contain' => array(
        'Model2' => array(
            'conditions' => array('Model1.field >' => 'Model2.field')
)); 
```

`'Model1.field >'`（注意将和分开`'Model2.field'`。

另外，请确保您的模型 (Model1) 具有`$actsAs = array('Containable');`

最后一个小提示 - 在询问您的问题时最好使用实际的模型/字段名称 - 它有助于解决您的问题，并允许在有更简单/更好的方法时提供建议。

# iphone - 从 UITableViewCell 拨打电话

> ID：10504733
> 
> 赞同：0
> 
> 时间：2012-05-08T18:58:20.047
> 
> 标签：iphone, objective-c, ios, uitableview, didselectrowatindexpath

我遇到了一个问题。在我的 tableView 中，我有一个带有电话号码的单元格。我想点击电话号码并拨打电话。

我在 didSelectRowAtIndexPath 中实现了以下内容：

```
NSString *cifra=@"tel://123456789";
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:cifra]];
NSLog(@"after call %@",cifra); 
```

不幸的是它没有做任何事情。在我的日志中，它显示了我的“通话后......”，但它没有打电话。没有错误，没有日志，没有操作:(它适用于我打开网站或googleMaps，但不适用于打电话。

有什么我可以做的吗？也许这是一个简单的答案，但我真的不知道该怎么做。是否有其他方式拨打电话？

* * *

我正在使用 iPhone 模拟器。这是问题吗？但它应该做一件事，不是吗？:)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T07:17:10.087

尝试使用此代码拨打电话

```
 NSString *prefix = (@"tel://(972)818-32432");
           UIApplication *app = [UIApplication sharedApplication];
            NSString *dialThis = [NSString stringWithFormat:@"%@", prefix];
            NSURL *url = [NSURL URLWithString:dialThis];
            [app openURL:url]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:01:31.650

## 您无法从模拟器拨打电话。

如果您想测试拨打电话，请在您的设备上运行该应用程序，然后按下手机在您的实际设备上拨打电话。

您可以模拟通话状态栏，但在实际通话时并没有实际发生任何事情。

> 硬件 > 切换通话状态栏

*请注意，使用`[[UIApplication sharedApplication] openURL:SOMEPHONENUMBER];`不会触发此事件。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:03:26.373

除了提到您无法从模拟器拨打电话的答案之外，cifra 应该是@“tel:123456789”，不需要双斜杠。

# asp.net-mvc - 控制器搜索视图而不是返回不同的视图方法

> ID：10504737
> 
> 赞同：0
> 
> 时间：2012-05-08T18:58:52.997
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有以下两个控制器操作：

```
public ViewResult TitleStorylines(int id)
    {
        var vm = Service.Get(id);
        vm.IsEditable = User.HasPermission(SecurityPermissionType.ManageStorylines);
        return View(vm);
    }

public ViewResult TitleStorylinesCreate(TitleStorylineModel model)
    {
        var created = Service.Create(model);
        return TitleStorylines(created.TitleId);
    } 
```

我的项目中只有一个视图，称为`TitleStorylines`，第一个控制器操作处理得很好。`TitleStorylinesCreate`但是当我调用第二种方法时，它给了我一个错误，说即使我明确地调用了前一种方法，它也找不到调用的视图。是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:08:04.660

你试过了吗 ？

```
return View("TitleStorylines",created.TitleId); 
```

**编辑：根据您的更新**：我猜您将表单发回 TitleStorylinesCreate。所以可能在保存之后，您不想将用户重定向回相同的 Get 操作吗？

```
[HttpPost]
public ViewResult TitleStorylinesCreate(TitleStorylineModel model)
{
    var created = Service.Create(model);
    return RedirectToAction("TitleStorylines",new { @id=created.TitleId});
} 
```

在上面的例子中，我们正在做[PRG](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式。**Post -> Redirect -> Get** 保存后，我们将它们重定向回第一个方法。这将是一种`HTTP GET`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:48:30.080

```
 public ActionResult TitleStorylinesCreate(TitleStorylineModel model)
{
    var created = Service.Create(model);
    return RedirectToAction("TitleStorylines",new { @id=created.TitleId});
} 
```

# php - Yii 框架 - 相同关系的两个实例

> ID：10504738
> 
> 赞同：0
> 
> 时间：2012-05-08T18:58:53.010
> 
> 标签：php, yii, relation

我`Animal`在 Yii 中有一个模型，它有两个关系，`mainRace`并且`secondaryRace`，它们都是`Race`模型的一个实例。

如何将其转换为模型的关系数组以及`Animal`模型中的关系数组`Race`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T04:40:34.730

看起来你需要一个多对多的关系，所以你需要多一张表（animal_race）。

有关如何设置 MANY_MANY 的更多信息，请参阅[Yii 关系页面](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#declaring-relationship)

编辑：如果您只想将动物限制为两个种族，那么您可能希望在 Animal 模型中有一个 main_race_id / secondary_race_id （假设动物只能参加两个种族，如果输入动物怎么办在多个事件中？）。

然后您将使用 BELONGS_TO 设置。这样，您可以使用 HAS_MANY 关系轻松找到给定种族的所有动物。

# dynamic - 动态画布高度上的基本 div 高度

> ID：10504741
> 
> 赞同：0
> 
> 时间：2012-05-08T18:59:00.280
> 
> 标签：dynamic, html, canvas, height, listener

我有一个画布元素，在一些用户交互后高度会发生变化。画布包含在一个 div 中。当画布的高度发生变化时，它当前会垂直溢出 div。

我可以在画布的高度上添加一个（javascript 或 jquery）监听器（或类似的东西），根据画布高度动态改变 div 的高度吗？或者有没有一种css方式让div自动放大（比如在表格行中）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:02:17.810

您是否尝试过将这种样式添加到 div 中：height:auto;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T06:49:47.743

作为一种解决方法，我将画布放在一张桌子上。有点难看，但它的工作原理。

# sql - 修改没有 DateAdd 或 DateDiff 的日期

> ID：10504742
> 
> 赞同：0
> 
> 时间：2012-05-08T18:59:00.637
> 
> 标签：sql, sql-server, tsql

是否可以在不必使用 DateAdd 或不必计算日期差的情况下修改日期的日期部分？

```
SET @ReturnDate = '5/16/2012'

SET @ModifyDay = 20 
```

只修改`16`为`20`

结果应该是`5/20/2012`

这样做的原因是我正在将 vb 代码转换为存储过程：

```
 Dim InvDate_Day_of_Month As Integer = CInt(Day(InvDate))
    PaymentDate = DateAdd(DateInterval.Month, 1, InvDate)
    PaymentDate = New Date(PaymentDate.Year, PaymentDate.Month, DayofTheMonth) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:01:36.080

```
SET @ReturnDate = @ReturnDate + (@ModifyDay - DATEPART(day, @ReturnDate)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:12:05.370

如果您只是想在日期上添加 4 天，您可以直接添加 4：

```
DECLARE @ReturnDate DATETIME;
SET @ReturnDate = '5/16/2012'

SELECT @ReturnDate, @ReturnDate + 4 
```

这将选择 **2012-05-16** 00:00:00.000 和**2012-05-20** 00:00:00.000

# javascript - 可过滤的投资组合标签

> ID：10504745
> 
> 赞同：0
> 
> 时间：2012-05-08T18:59:15.540
> 
> 标签：javascript, jquery, portfolio

我正在使用可过滤的投资组合。我对过滤投资组合的链接有一点问题。

当我单击按钮时，它会正确过滤投资组合，但之后它会自动连接到 xy.com/#myfilter 之类的站点并尝试打开它。

也许您知道如何禁用它？

**链接示例：**

```
<a href="#design" rel="design">Design</a> 
```

**JS 文件如下：**

```
(function($) {
  $.fn.filterable = function(settings) {
    settings = $.extend({
      useHash          : true,
      animationSpeed   : 500,
      show             : { width: 'show', opacity: 'show' },
      hide             : { width: 'hide', opacity: 'hide' },
      useTags          : true,
      tagSelector      : '#portfolio-filter a',
      selectedTagClass : 'current',
      allTag           : 'all'
    }, settings);

    return $(this).each(function(){

      /* FILTER: select a tag and filter */
      $(this).bind("filter", function( e, tagToShow ){
        if(settings.useTags){
          $(settings.tagSelector)
            .removeClass(settings.selectedTagClass);
          $(settings.tagSelector + '[href=' + tagToShow + ']')
            .addClass(settings.selectedTagClass);
        }

        $(this).trigger("filterportfolio", [ tagToShow.substr(1) ]);
      });

      /* FILTERPORTFOLIO: pass in a class to show, all others will be hidden */
      $(this).bind("filterportfolio", function( e, classToShow ){
        if(classToShow == settings.allTag){
          $(this).trigger("show");
        }else{
          $(this).trigger("show", [ '.' + classToShow ] );
          $(this).trigger("hide", [ ':not(.' + classToShow + ')' ] );
        }

        if(settings.useHash){
          location.hash = '#' + classToShow;
        }
      });

      /* SHOW: show a single class*/
      $(this).bind("show", function( e, selectorToShow ){  
        $(this)
          .children(selectorToShow)
          .animate(settings.show, settings.animationSpeed);
      });

      /* SHOW: hide a single class*/
      $(this).bind("hide", function( e, selectorToHide ){
        $(this)
          .children(selectorToHide)
          .animate(settings.hide, settings.animationSpeed); 
      });

      /* ============ Check URL Hash ====================*/
      if(settings.useHash){
        if(location.hash != '') {
          $(this).trigger("filter", [ location.hash ]);
        }else{
          $(this).trigger("filter", [ '#' + settings.allTag ]);
        }

        /* ============ Setup Tags ====================*/
        if(settings.useTags){
          $(settings.tagSelector).click(function(){
            $('#portfolio-list').trigger("filter", [ $(this).attr('href') ]);
            $(settings.tagSelector).removeClass('current');
            $(this).addClass('current');
          });
        }
      });
    }
})(jQuery);

$(document).ready(function(){

    $('#portfolio-list').filterable();

}); 
```

也可能是我的搜索友好 URL 有问题吗？非常感谢您的每一次帮助。

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:29:10.187

你需要对点击事件做一些调整：

**在您当前的点击功能：**

```
$(settings.tagSelector).click(function(){
  $('#portfolio-list').trigger("filter", [ $(this).attr('href') ]);

  $(settings.tagSelector).removeClass('current');
  $(this).addClass('current');
}); 
```

**将其更改为：**

```
$(settings.tagSelector).click(function(event){
  $('#portfolio-list').trigger("filter", [ $(this).attr('href') ]);

  $(settings.tagSelector).removeClass('current');
  $(this).addClass('current');

  // push the hash into the url
  location.hash = $(this).attr('href');

  // stop the regular href
  event.preventDefault();
}); 
```

这允许您将哈希值放入 URL，但防止浏览器在用户单击链接时实际使用该哈希重新加载页面！

* * *

**阅读更多相关信息：**

[event.preventDefault()](http://api.jquery.com/event.preventDefault/) | [位置.hash](https://developer.mozilla.org/en/DOM/window.location)

# iphone - iOS在uiwebview goBack之前获取目标url

> ID：10504752
> 
> 赞同：0
> 
> 时间：2012-05-08T18:59:33.947
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我设置了一个执行 uiwebview 的 goBack 方法的自定义按钮。但是，当按下此按钮时，我需要获取目标 URL。我怎样才能访问导航历史的第一个位置？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:17:12.363

在实例变量中实现`-(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType` 和存储来自 NSURLRequest 的 URL。然后只需在您的 goBack 方法中访问此变量。如果您有多个导航步骤，请使用一个数组来存储每个后续请求，然后只需访问索引 0 处的对象即可获取原始 URL。

# php - 如何在 php 脚本完成之前导致重定向发生？

> ID：10504753
> 
> 赞同：10
> 
> 时间：2012-05-08T18:59:48.510
> 
> 标签：php, redirect, header

我想运行一个 php 脚本，它会发送一堆电子邮件（通讯），但由于它可能需要一段时间才能运行，我希望用户立即被重定向到一个页面，其中包含类似“您的通讯已排队等待”的消息送出。”
到目前为止，标头重定向有效，但直到所有电子邮件都发送完毕后才会导致重定向。我可以在发送重定向后关闭连接，以便浏览器立即执行重定向吗？我试过这样的东西

```
 ob_start();
ignore_user_abort(true);
header( "refresh:1;url=waitforit.php?msg=Newsletters queued up, will send soon.");
header("Connection: close");
header("Content-Length: " . mb_strlen($resp));
echo $resp;
//@ob_end_clean();
ob_end_flush();
flush(); 

```

各种排列组合，但无济于事。我怀疑它不能这么简单，但在我开始搞乱 cron 作业或自定义守护进程之前，我想我会研究这种方法。谢谢

例如，就像下面的笨蛋建议的那样，但没有运气

```
ob_start();
ignore_user_abort(true);
header( "refresh:1;url=mailing_done.php?msg=Newsletters queued for sending.");
header("Connection: close");
header("Content-Length: 0" );
//echo $resp;
ob_end_flush();
flush(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-08T19:09:03.867

如果你想连续运行脚本并且仍然想显示一些输出，为什么不使用 ajax 请求到服务器，它可以排队邮件并仍然让用户继续浏览该页面。

**如果您不想使用它；相反，您可以使用，** 即使用户将被重定向到`show_usermessage.php`页面，脚本也会在后台运行

```
<?PHP
    //Redirect to another file that shows that mail queued
    header("Location: show_usermessage.php");

    //Erase the output buffer
    ob_end_clean();

    //Tell the browser that the connection's closed
    header("Connection: close");

    //Ignore the user's abort (which we caused with the redirect).
    ignore_user_abort(true);
    //Extend time limit to 30 minutes
    set_time_limit(1800);
    //Extend memory limit to 10MB
    ini_set("memory_limit","10M");
    //Start output buffering again
    ob_start();

    //Tell the browser we're serious... there's really
    //nothing else to receive from this page.
    header("Content-Length: 0");

    //Send the output buffer and turn output buffering off.
    ob_end_flush();
    flush();
    //Close the session.
    session_write_close();

    //Do some of your work, like the queue can be ran here,
    //.......
    //.......
?> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-08T19:37:38.727

我会试试这个：

```
<?php
header("Location: waitforit.php?msg=Newsletters queued up, will send soon.");
header("Content-Length: 0");
header("Connection: close");
flush();
//Do work here
?> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T00:06:10.987

这是正确的方法...... Sonia Desbiens 的代码，又名：fataqui 07/01/2005

```
<?php

set_time_limit ( 0 );

/* start the forced redirect */

header ( 'Connection: close' );

ob_start ();

/* close out the server process, release to the client */

header ( 'Content-Length: 0' );

header ( 'Location: /page_to_redirect_to.php' );

ob_end_flush ();

flush ();

/* end the forced redirect and continue with this script process */

ignore_user_abort ( true );

/* the rest of your script here */

/*
 * this example will redirect the user to '/page_to_redirect_to.php'
 * then this script will continue by sleeping for '10' seconds, then
 * this script will write a file, and then this script will exit...
*/

sleep ( 10 );

file_put_contents ( './out.txt', '' );

exit ();

?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T14:23:29.930

要让它在 IIS7 上工作，您需要`responseBufferLimit="0"`在 web.config 中使用 isapi 并在 php.ini 中使用 output_buffering=Off，然后这样的东西应该可以工作......

```
 session_write_close();
  header( "Location: ".$sURL ) ;
    // try to allow continued processing
  if(ob_get_length())
    ob_end_clean();
  header("Connection: close");
  ignore_user_abort(); // optional
  ob_start();
  header("Content-Length: 0");
  ob_end_flush(); // Strange behaviour, will not work
  flush(); // Unless both are called ! 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-24T19:19:40.667

接受的答案对我不起作用，但确实如此。请注意，ignore_user_abort() 必须在 php.ini 中开启

```
ignore_user_abort(true);
    session_write_close(); // optional, this will close the session.
    header("Location: $url");
    header("Content-Length: 0");
    ob_end_flush();
    flush();
    //do_function_that_takes_five_mins(); 
```

[http://waynepan.com/2007/10/11/how-to-use-ignore_user_abort-to-do-process-out-of-band/](http://waynepan.com/2007/10/11/how-to-use-ignore_user_abort-to-do-process-out-of-band/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-08T19:01:34.407

尝试设置`Content-Length`为 0

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-08T20:24:07.167

基本上，您希望异步执行这项工作。我会让 php 脚本创建另一个异步发送电子邮件的线程（或进程）。这样，运行请求的线程就不会与电子邮件的处理相关联。处理请求并返回结果的线程可以完全独立于发送电子邮件的线程运行。

这个线程似乎正在触及这种方法，也许它对实现细节会更有帮助：[Run PHP Task Asynchronously](https://stackoverflow.com/questions/858883/run-php-task-asynchronously)

# java - 如何不时查看线程中的值？

> ID：10504759
> 
> 赞同：0
> 
> 时间：2012-05-08T19:00:14.697
> 
> 标签：java, multithreading, procfs

我正在用 Java 投影一个监控客户端，它将从`/proc`. 我有一个主班`MonitoringClient`和`ProcParser`班。我的`ProcParser`扩展`Thread`。

我认为这是实例化许多（四个：cpu、内存、磁盘和网络）`ProcParser`对象的好方法，传递我想在构造函数中测量的组件之一。然后，在 run 方法中，我在 then 之间切换 - 每个对象都会解析其中一个。代码将类似于：

```
ProcParser pp_Cpu = new ProcParser(UsageType.CPU, 1000, Pid.getPid());
ProcParser pp_Memory = new ProcParser(UsageType.MEMORY, 1000, Pid.getPid());
ProcParser pp_Disk = new ProcParser(UsageType.DISK, 1000, Pid.getPid());
ProcParser pp_Network = new ProcParser(UsageType.NETWORK, 1000, Pid.getPid());

ArrayList<String> cpuData = null;
ArrayList<String> memoryData = null;
ArrayList<String> diskData = null;
ArrayList<String> networkData = null;

pp_Cpu.start();
pp_Memory.start();
pp_Disk.start();
pp_Network.start();

for (;;) {
    if (pp_Cpu.isReady() && pp_Memory.isReady()
&& pp_Disk.isReady() && pp_Network.isReady()) {

        cpuData = pp_Cpu.getUsageData();
        memoryData = pp_Memory.getUsageData();
        diskData = pp_Disk.getUsageData();
        networkData = pp_Network.getUsageData();
    } else {
        sleep(1000); //this does not work. I have to extend to Thread also the main class?
    }
} 
```

我如何不时查看收集的值？另外，从 Java 线程的角度来看，我创建线程（每个主要组件一个）的方式是一种好方法吗？提前致谢。

在 ProcParser 中运行方法。

```
@Override
    public void run() {
        if ((this.usageType == null) || (this.sleepTime < 0) || (this.processPid < 0)) {
            throw new IllegalArgumentException();
        }

        //Forever sleep and gather the usage values
        for (;;) {
            this.ready = false;
            switch (this.usageType) {
                case CPU:
                    this.gatherCpuUsage();
                    this.ready = true;
                    break;
                case MEMORY:
                    this.gatherMemoryUsage(this.processPid);
                    this.ready = true;
                    break;
                case DISK:
                    this.gatherDiskUsage();
                    break;
                case NETWORK:
                    this.gatherNetworkUsage();
                    break;
                case PARTITION:
                    this.gatherPartitionUsage();
                    break;
                default:
                    break;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:20:45.197

> 我如何不时查看收集的值？

我假设您的`ProcParser`线程在后台运行，从 读取 CPU 数据（例如）`/proc`，然后休眠。您可能要考虑使用[`AtomicReference`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/atomic/AtomicReference.html). 类似于以下内容：

```
 private final AtomicReference<List<String>> cpuDataReference =
     new AtomicReference<List<String>>();
 ...

 ProcParser pp_Cpu =
     new ProcParser(UsageType.CPU, 1000, Pid.getPid(), cpuDataReference);
 ...

 // in your `ProcParser`
 List<String> cpuDataList = new ArrayList<String>();
 // read in the /proc files into the list
 ...
 // save it in the AtomicReference passed into the constructor
 dataReference.set(cpuDataList);

 // other threads could then get the latest list
 List<String> cpuDataList = cpuDataReference.get(); 
```

`set()`如果您担心消费者更改列表，您可能想要一个不可修改的列表。

> 从 Java 线程的角度来看，我创建线程（每个主要组件一个）的方式是一种好方法吗？

如果这不是一个练习，我会说你不需要线程复杂性——它不会给你带来太多好处。选择哪些任务需要一个线程、创建多少个线程等是在这些情况下需要做出的关键决策。

通常，您应该考虑制作`ProcParser`实现`Runnable`而不是扩展`Thread`，然后说`new Thread(new ProcParser(...))`. 这是推荐的模式。您还应该始终考虑使用`ExecutorService`类返回的`Executors`类。这些线程池接管线程的管理并使您的代码更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:04:31.723

代替轮询`is_ready`，查看`Object.wait`and `Object.notifyAll`。您可以编写一个`ProcParser.waitUntilReady`方法 using`Object.wait`和 use`Object.notifyAll`在工作线程产生结果时唤醒任何等待直到其准备就绪的线程。

或者，由于您的解析器正在生成项目列表，因此请查看`java.util.concurrent`.

# xml - 在 xslt 内部生成的元素上调用 xslt 模板

> ID：10504766
> 
> 赞同：0
> 
> 时间：2012-05-08T19:00:30.163
> 
> 标签：xml, xslt, identity, apply-templates

所以我使用 XSLT 的标识设计模式：

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()[not(@visible='false')]"/>
  </xsl:copy>
</xsl:template> 
```

而且我确实有很多模板匹配不同的节点。现在我想做的是在一个 xsl:template 中生成一些代码，并让另一个 xsl:template 匹配新生成的代码。有谁知道如何做到这一点？

* * *

我想做的例子：

```
<xsl:template match="button">
     <a href="@url" class="button"> <xsl:value-of select="@name" /> </a>
</xsl:template>

<xsl:template match="stuff">
    <!-- do some stuff -->
    <!-- get this following line parsed by the template over! -->
    <button url="something" name="a button" />
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:42:24.207

您不能以您尝试的方式完全按照您想要的方式做，但是如果打算重用代码并避免重复模板，则将匹配的模板称为命名模板是完全可以接受的，参数也。

```
<xsl:template match="button" name="button"> 
   <xsl:param name="url" select="@url" />
   <xsl:param name="name" select="@name" />
   <a href="{$url}" class="button"> <xsl:value-of select="$name" /> </a> 
</xsl:template> 
```

所以，这里如果匹配一个**按钮**元素，它会使用**url**和**name**属性作为默认值，但是如果你调用它作为named-template，你可以传入你自己的参数

```
<xsl:template match="stuff"> 
   <!-- do some stuff --> 
   <!-- get this following line parsed by the template over! --> 
   <xsl:call-template name="button">
    <xsl:with-param name="url" select="'something'" /> 
    <xsl:with-param name="name" select="'A button'" /> 
   </xsl:call-template> 
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:06:19.563

您应该能够使用`node-set()`扩展功能进行一些多遍处理。

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

  <xsl:template match="/*">
    <xsl:variable name="first_pass">
      <xsl:apply-templates select="button" />
    </xsl:variable>

    <xsl:apply-templates mode="second_pass" select="ext:node-set($first_pass)/*" />
  </xsl:template>

  <xsl:template match="button">
    <a href="@url" class="button"> <xsl:value-of select="@name" /> </a>
  </xsl:template>

  <xsl:template match="stuff" mode="second_pass">
    <!-- do some stuff -->
    <!-- get this following line parsed by the template over! -->
    <button url="something" name="a button" />
  </xsl:template>
</xsl:stylesheet> 
```

您可以在 XSLT 的第一个答案中获得更多详细信息[- apply a template to call-template result](https://stackoverflow.com/questions/8548024/xslt-apply-a-template-to-call-template-result)。

# c - 测量 CPU 频率 (x86 / x64)

> ID：10504769
> 
> 赞同：6
> 
> 时间：2012-05-08T19:00:39.557
> 
> 标签：c, windows, x86, 64-bit, cpu-speed

我正在寻找某种库，它可以在 Intel 和 AMD 处理器、32 位和 64 位 Windows 上定期为我提供准确的 CPU 频率值。

这样做的目的是准确测量给定计算机上的 CPU 负载。问题是调用`QueryPerformanceCounter()`返回时钟滴答（用于测量活动的持续时间），但由于 SpeedStep 或 TurboBoost，底层 CPU 频率不是恒定的。我发现有几台计算机在 BIOS 中关闭 SpeedStep / TurboBoost 并且不会阻止基于负载的 CPU 频率缩放。

我正在尝试查看是否有任何可用的库可用于检测 CPU 频率变化（很像Windows 7`Throttlestop`中`CPU-Z`的“概览”选项卡`Resource Monitor`），以便我可以查询并保存这些信息以及我的其他测量值. 性能计数器似乎没有返回可靠的信息，因为我的计算机总是返回 100% CPU 频率，即使其他工具显示动态频率变化也是如此。

我搜索了此类库，但大多数结果都带有无用的小工具等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:09:02.687

您可以将高分辨率计时器与时钟周期计数器结合起来计算当前时钟速率。在现代 CPU 上，可以使用以下函数读取周期计数器：

```
static inline uint64_t get_cycles()
{
  uint64_t t;
  asm volatile ("rdtsc" : "=A"(t));
  return t;
} 
```

请注意，这是每个 CPU 的，因此如果您的程序在 CPU 周围移动，您就有麻烦了。如果您了解平台上的 CPU 固定技术，您可能想尝试一下。

对于高分辨率时间测量，您可以使用中的工具`<chrono>`；[这是我](https://stackoverflow.com/a/7056662/596781)关于该主题的半有用的帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:23:45.030

试着专注于你正在尝试做的事情，而不是如何去做。

你的最终目标是什么？

如果，如您所说，您正在尝试“测量给定计算机上的 CPU 负载”，那么在 Windows 上，使用“PdhOpenQuery”和“Pdh*”系列函数可能是一个好习惯。

另请参阅此 SO 答案：

[如何从进程内部确定 CPU 和内存消耗？](https://stackoverflow.com/questions/63166/how-to-determine-cpu-and-memory-consumption-from-inside-a-process)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T08:47:01.670

考虑查看 __rdtsc 内在函数（Visual Studio 中的#include "intrin.h"）。

这会通过 x86/x64 函数 RDTSC（读取时间戳）直接从处理器产生时钟计数。

# cordova - PhoneGap 构建的本地版本

> ID：10504771
> 
> 赞同：2
> 
> 时间：2012-05-08T19:00:55.350
> 
> 标签：cordova

PhoneGap Build 的一大优点是我可以上传我的代码，它会自动生成为所有设备构建所需的文件。我目前正在尝试构建一个我想快速尝试的应用程序，但宁愿在本地构建而不是通过 PhoneGap 构建，但不想经历设置相关 SDK 等的乏味。

有没有其他可用的 Build 替代品？我下载大量下载没有问题，但我正在寻找一个简洁的部署解决方案，无论是命令行，还是使用 maven 或 ant 来生成部署包？有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:05:05.750

至少，您需要针对您计划构建的每个平台的所有 SDK，并且由于您必须拥有 Mac 才能构建 iOS 应用程序，因此您需要确保您使用的是 Mac，或者如果您正在构建 Windows Phone或您需要在 Windows 上运行的黑莓应用程序。我认为简短的回答是没有办法在单个本地系统上执行 PhoneGap build 所做的事情。

# scala - Scala - 将整数列表映射到接收 java.lang.Object 的方法

> ID：10504772
> 
> 赞同：4
> 
> 时间：2012-05-08T19:00:58.980
> 
> 标签：scala

在 Scala-IDE 中工作，我有一个 Java 库，其中一种方法接收`java.lang.Object`. 我想将一个`Int`值列表映射到它。唯一有效的解决方案是：

```
val listOfInts = groupOfObjects.map(_.getNeededInt)

for(int <- listOfInts) libraryObject.libraryMethod(int) 
```

而以下一个：

```
groupOfObjects.map(_.getNeededInt).map(libraryMethod(_) 
```

乃至

```
val listOfInts = groupOfObjects.map(_.getNeededInt)

val result = listOfInts.map(libraryObject.libraryMethod(_)) 
```

说

> 类型不匹配; found : Int required: java.lang.Object 注意：隐式存在于 scala.Int => java.lang.Integer，但从 Object 继承的方法被渲染为模棱两可。这是为了避免将任何 scala.Int 转换为任何 AnyRef 的一揽子隐式。您可能希望使用类型归属：`x: java.lang.Integer`.

和类似的东西

```
val result = listOfInts.map(libraryObject.libraryMethod(x => x.toInt)) 
```

或者

```
val result = listOfInts.map(libraryObject.libraryMethod(_.toInt)) 
```

也不起作用。

1）为什么会这样？据我所知，`for`和`map`例程没有太大区别！

2）另外：什么意思`You may wish to use a type ascription: x: java.lang.Integer`？我该怎么做？我尝试明确指定类型，例如`x: Int => x.toInt`，但这太错误了。那么什么是“类型归属”呢？

**更新：**

T.Grottker 提出的解决方案增加了它。我得到的错误是这样的：

> *   缺少扩展函数的参数类型 ((x$3) => x$3.asInstanceOf[java.lang.Object])
> *   扩展函数缺少参数类型 ((x$3) => x$3.asInstanceOf{#null#}[java.lang.Object]{#null#}) {#null#}

我想，天哪，它只是在增长！谁能解释所有这些`<null>`东西在这里意味着什么？我只是想知道真相。（注意：我不得不用 # 替换 <> 刹车，因为 SO 引擎当时会切断整个东西，所以用你的想象力将它们替换回来）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T20:41:26.967

类型不匹配准确地告诉您问题：您可以转换为`java.lang.Integer`但*不能*转换为`java.lang.Object`. 所以告诉它你想`Integer`在路上找一个地方。例如：

```
groupOfObjects.map(_.getNeededInt: java.lang.Integer).map(libraryObject.libraryMethod(_)) 
```

（符号——当在or或参数方法`value: Type`的声明之外使用时——意味着如果可能，将其视为该类型；要么需要是 的子类，要么需要有一个可以转换为某物的隐式转换适当的类型。）`val``var``value``value``Type``value`

# sql - SQL 如何将日期 DD-MM-YYYY 转换为 MM-YYYY 并检索最近的记录？

> ID：10504775
> 
> 赞同：0
> 
> 时间：2012-05-08T19:01:13.567
> 
> 标签：sql, sql-server, date, format

嗨，我必须从我的表中检索与给定 MM-YYYY 匹配的最新记录，但表中的日期字段是 DD-MM-YYYY，我该如何完成？

非常感谢你

最好的问候伊格纳西奥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:21:40.343

您需要多少最近的记录？

你能不能查询相关月份的所有日期，按日期排序，然后只从列表顶部选择你需要的结果。

例如：

```
SELECT TOP(1) * 
FROM your_table 
WHERE date_time_field >= '20120101' 
  AND date_time_field < '20120201' 
ORDER BY date_time_field DESC 
```

这将选择今年 1 月以来的最新记录。更改`TOP()`语句中的数字以更改返回的结果数，或者完全不使用它，并放心您的结果是有序的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:10:36.540

以下作品：

```
right(select convert(varchar, <date field>, 110), 7) 
```

完整的查询看起来像这样：

```
select *
from table
where right(select convert(varchar, <date field>, 110), 7) = 'MM-YYYY' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:13:28.617

```
SELECT * FROM `your`.`schemaTableNames` WHERE your_coulumn_name LIKE "%-MM-YYYY"; 
```

应该给你匹配的记录，就像你写的那样，你想检索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:26:45.430

您是否尝试过`DateDiff(month, date1, date2) == 0`在 where 子句中使用？

这假定您可以将这两个值都转换为 DATETIME。如果您只有年和月，则每个月都有第 01 天。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T19:30:15.003

要将日期转换为所需格式，您可以使用样式来检索记录[日期格式](http://www.w3schools.com/sql/func_convert.asp)

# php - 以二进制设置权限

> ID：10504778
> 
> 赞同：5
> 
> 时间：2012-05-08T19:01:15.127
> 
> 标签：php

我在学校看到一个使用二进制字符串设置权限的系统。

假设 101001 = 41

所以 ：

*   1 可以是第 1 页的权限
*   2 可以是第 2 页的权限
*   4可以是第3页的权限
*   8可以是第4页的权限
*   16可以是第5页的权限
*   32可以是第6页的权限

所以假设我得到了上面的二进制字符串（101001）。我可以访问第 1、4 和 6 页。

我怎样才能在 PHP 中做到这一点？假设我在 MySQL 中有一个名为`perms`存储在 dec 中的字段，因此 101001 将是 41。**我怎么知道 41 在 PHP 中等于 1、8 和 32？**

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-08T19:07:59.133

听起来您在谈论位和位运算符。最简单的设置方法是为每个权限定义常量

```
const POST   = 1;
const DELETE = 2;
const UPDATE = 4;
const READ   = 8; 
```

一旦你定义了这些，就很容易使用按位运算符进行比较：

```
$userValue = '1101';

if ($userValue & self::POST) {
  echo 'Can Post';
}

if ($userValue & self::DELETE) {
  echo 'Can Delete';
}

if ($userValue & self::UPDATE) {
  echo 'Can Update';
}

if ($userValue & self::READ) {
  echo 'Can Read';
} 
```

这就是 PHP 自己的常量的工作量。如果您曾经使用类似于`E_ALL & E_DEPRECATED`实际使用二进制数的方法设置错误报告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:03:55.393

您可以使用`& operator`并检查这些标志。

```
$READ = 8;
$WRITE = 1;
$EXECUTE = 32;
$permissions = 41;
if ($permissions & $READ) {
   // do smth
}
if ($permissions & $WRITE ) {
   // do smth
}
if ($permissions & $EXECUTE ) {
   // do smth
} 
```

让我解释一下。如果您有位 1001 (9)。您只需检查位 (1000) 和 1001。您只需将 $permissions 变量的每一位与位数相乘。结果将是 1000。它可以转换为`true`值。所以你在这里有旗帜。如果检查第三位（0100），它将导致 0000 和它的`false`值。所以你在这里没有权限。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T19:04:10.793

这是一个很好的片段。取自这里[http://www.litfuel.net/tutorials/bitwise.htm](http://www.litfuel.net/tutorials/bitwise.htm)

```
<?php
$read = 1;
$write = 2;
$readwrite = 16;
$local_admin = 32;
$global_admin = 64;

$jim = 96;
$mike = 16;

echo "Is Mike Allowed to edit? he has an access level of 16<BR>";
if ($mike & 32) {
    echo 'YES MIKE CAN EDIT';
} else {
    echo 'NO HE CANNOT';
}

echo "<BR><BR>Is Jim Allowed to edit? he has an access level of 96<BR>";
if ($jim & 32) {
    echo 'YES JIM CAN EDIT';
} else {
    echo 'NO HE CANNOT';
}
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:03:47.120

这就是二进制的本质——每个数字只有一个 1 和 0 的组合。

PHP 注释中的一个函数[`decbin`](http://php.net/manual/en/function.decbin.php)：

```
function bindecValues($decimal, $reverse=false, $inverse=false) {
/*
1\. This function takes a decimal, converts it to binary and returns the
     decimal values of each individual binary value (a 1) in the binary string.
     You can use larger decimal values if you pass them to the function as a string!
2\. The second optional parameter reverses the output.
3\. The third optional parameter inverses the binary string, eg 101 becomes 010.
-- darkshad3 at yahoo dot com
*/

    $bin = decbin($decimal);
    if ($inverse) {
        $bin = str_replace("0", "x", $bin);
        $bin = str_replace("1", "0", $bin);
        $bin = str_replace("x", "1", $bin);
    }
    $total = strlen($bin);

    $stock = array();

    for ($i = 0; $i < $total; $i++) {
        if ($bin{$i} != 0) {
            $bin_2 = str_pad($bin{$i}, $total - $i, 0);
            array_push($stock, bindec($bin_2));
        }
    }

    $reverse ? rsort($stock):sort($stock);
    return implode(", ", $stock);
} 
```

用法

```
$binary_array = bindecValues(41); 
```

这将使`binary_array`：

```
array(1, 8, 32); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T19:05:15.787

[`decbin`](http://www.php.net/manual/en/function.decbin.php)由于它是二进制和十进制，您可以使用and来回转换它[`bindec`](http://www.php.net/manual/en/function.bindec.php)。这只是一个不同的基础来计算......

**编辑：**按位是甜蜜的，这样做^_^

# django - Django 应用程序作为基于 REST 的服务

> ID：10504781
> 
> 赞同：2
> 
> 时间：2012-05-08T19:01:27.880
> 
> 标签：django, api, rest

根据文档，应用程序是处理定义明确的操作的模块。

将应用程序视为基于 REST 的服务是否正确？还是必须使用诸如活塞或美味派之类的框架来围绕应用程序创建 RESTful Web 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:22:20.453

一般来说，没有。Django 应用程序实际上只是一个 python 模块，具有一些 django 内部接口，如模型、url、管理员发现等。

要实现 REST，您仍然需要通过视图来管理网络通信，您可以在此处编写自己的代码，或者使用 tastepie/piston/etc 的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T14:09:35.580

请看一下 django-rest-framework，我刚从 sweetpie 跨到这个新框架，效果很好！

[http://django-rest-framework.org/](http://django-rest-framework.org/)

尤其是基于类的视图和可浏览的 api！可能还有其他优势（例如上传图片）

并回答您的问题：rest-base 服务是您的 web 应用程序的一个额外入口。我使用 django-rest-framework 为一些项目制作了一些 api，大多数项目成员都很惊讶他们得到了一个额外的 webapp，而实际上恰恰相反。您制作了一个 django 应用程序（带有视图模型和 url），最重要的是您制作了 api。

# css - CSS - LESS 类继承

> ID：10504787
> 
> 赞同：15
> 
> 时间：2012-05-08T19:01:40.337
> 
> 标签：css, less

我正在使用来自[twitter bootstrap](http://twitter.github.com/bootstrap/components.html#labels)的样式，并且对继承有疑问。

我想制作两个从 bootstrap 继承标签样式的标签类。

```
.label-new {
    .label; .label-important;
}
.label-updated {
    .label; .label-warning;
} 
```

但是，上述情况会导致 LESS 解析错误“NameError: .label-important is undefined”，因为 .label-important 和 .label-warning 是在引导程序中使用以下内容定义的：

```
.label,
.badge {
  // Important (red)
  &-important         { background-color: @errorText; }
  &-important[href]   { background-color: darken(@errorText, 10%); }
  // Warnings (orange)
  &-warning           { background-color: @orange; }
  &-warning[href]     { background-color: darken(@orange, 10%); }
} 
```

是否有任何特殊语法可以继承 .label-important/warning？

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T19:32:44.860

我认为你只能继承`.label`which 应该给出`.label-new-important`and `.label-new-warning`（和等价于`updated`）。如果这是不可取的，并且您想要新添加的扩展，您可能需要直接再次定义颜色`.label`以隔离和定义您想要的。像这样：

```
.label { 
  // New (red) 
  &-new           { background-color: @errorText; } 
  &-new[href]     { background-color: darken(@errorText, 10%); } 
  // Updated (orange) 
  &-updated       { background-color: @orange; } 
  &-updated[href] { background-color: darken(@orange, 10%); } 
} 
```

**编辑（如果您不想重新定义颜色但使用 mixin）**

为避免重新定义颜色，您需要更改原始定义，并执行以下操作：

首先，删除原始`.label`和`.badge`定义，然后，更明确地定义它们，如下所示：

```
.label-important,
.badge-important {
  // Important (red)
  { background-color: @errorText; }
  { background-color: darken(@errorText, 10%); }
}

.label-warning,
.badge-warning {
  // Warnings (orange)
  { background-color: @orange; }
  { background-color: darken(@orange, 10%); }
}

.label-new {
    .label-important;
}

.label-updated {
    .label-warning;
} 
```

# c# - 用 C# 生成完全随机的偶数

> ID：10504791
> 
> 赞同：2
> 
> 时间：2012-05-08T19:01:51.913
> 
> 标签：c#, winforms, random, numbers

有什么好的方法可以用 C#生成**随机偶数吗？**我想出了这段代码：

```
 Random RandString = new Random(0); 
```

代码：

```
 private void button6_Click(object sender, EventArgs e)
    {
        int min = 0;
        int max = 50;

        int rand = RandString.Next(min, max-1);
        while (rand % 2 == 1) // odd
        {
            rand = RandString.Next(min, max-1);
        }

        textBox4.Text = "" + rand;
    } 
```

这段代码的问题：

*   我目前的解决方案可能不是最快的
*   很多时候，这种方法生成的数字会以相同的顺序重复！例如，经过 5 次迭代后，我可以得到：8、10、20、30、16。更多点击（大约 15 秒）后，我可以连续得到 **10、30、20**或 30、20、10 .. 我是不确定，但这不是我所说的“随机”。

那么有什么方法可以解决我所描述的问题，还是有其他方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T19:03:53.817

```
textBox4.Text = (2 * rand.Next(min / 2, max / 2)).ToString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:04:04.457

更容易的是把你的结果乘以 2

```
private void button6_Click(object sender, EventArgs e)
{
    int min = 0;
    int max = 25;

    int rand = RandString.Next(min, max-1)*2;

    textBox4.Text = rand.ToString();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T19:04:27.463

```
Random random = new Random();

int nextnum = random.Next(min/2,max/2) * 2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T19:14:03.777

你的方法有很多缺陷。

首先，`Random`来自 .NET 在密码学意义上的 AFAIK 并不是完全随机的，但它应该比您报告的结果要好得多。`Random`最有可能的是，您在循环的每次迭代中都创建了一个新对象；由于当前系统时间用于播种 RNG，因此如果您一个接一个地运行很短，您将获得相同的伪随机数序列。相反，在启动时创建一个实例`Random`，并尽可能长时间地保留它。

然后，从一个随机整数创建一个偶数比循环直到找到一个恰好是偶数要容易得多：只需生成一个随机数并清除最低有效位：`myRand.Next(min, max-1) & ~1;`. 一个体面的 RNG 在其所有位上具有均匀分布，因此清除任何位不应使熵减少超过一位。

回到“完全随机”部分：`Random`提供一个伪随机数生成器。它被播种一次，基于一个有点随机的值（当前系统时间中最不重要的部分），但给定相同的种子，RNG 将在每次运行时可靠且确定地产生相同的数字。如果您想要真正的随机性（又名“熵”），您会惊讶于在为确定性计算而构建的机器上生成它是多么困难。UNIX 和类 Unix 系统通常通过一个特殊的内核生成文件（`/dev/random`)，使用诸如硬盘访问时间、网络噪声以及他们可以找到的任何其他实际随机性来源，并使用相当复杂的计算将它们提炼成均匀分布。Windows 可能也可以这样做，但我不知道 .NET 或经典 win32 API 中有任何 API。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T19:08:56.573

您可以使用[RNGCryptoServiceProvider](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)来获得“更随机”（我承认这是一个愚蠢的术语）数字。MSDN 的文档页面上有一个很好的示例。

正如其他人建议的那样，您只需将结果乘以 2 即可得到偶数。

# python - 底图和 Matplotlib - 提高速度

> ID：10504792
> 
> 赞同：4
> 
> 时间：2012-05-08T19:01:59.213
> 
> 标签：python, matplotlib, matplotlib-basemap

我正在使用`Matplotlib`和创建一个用于经济数据地理空间可视化的工具`Basemap`。

但是，现在，我想到的唯一给我足够灵活性的方法是每次我想更改数据时创建一个新的底图。

以下是我正在使用的代码的相关部分：

```
class WorldMapCanvas(FigureCanvas):

def __init__(self,data,country_data):
    self.text_objects = {}
    self.figure = Figure()
    self.canvas = FigureCanvas(self.figure)
    self.axes = self.figure.add_subplot(111)
    self.data = data
    self.country_data = country_data
    #this draws the graph
    super(WorldMapCanvas, self).__init__(Figure())
    self.map = Basemap(projection='robin',lon_0=0,resolution='c', ax=self.axes)
    self.country_info = self.map.readshapefile(
        'shapefiles/world_country_admin_boundary_shapefile_with_fips_codes', 'world', drawbounds=True,linewidth=.3)

    self.map.drawmapboundary(fill_color = '#85A6D9')
    self.map.fillcontinents(color='white',lake_color='#85A6D9')
    self.map.drawcoastlines(color='#6D5F47', linewidth=.3)
    self.map.drawcountries(color='#6D5F47', linewidth=.3)
    self.countrynames = []
    for shapedict in self.map.world_info:
        self.countrynames.append(shapedict['CNTRY_NAME'])

    min_key = min(data, key=data.get)
    max_key = max(data, key=data.get)
    minv = data[min_key]
    maxv = data[max_key]

    for key in self.data.keys():
        self.ColorCountry(key,self.GetCountryColor(data[key],minv,maxv))
    self.canvas.draw() 
```

如何更快地创建这些图？

我想不出每次运行代码时都避免创建地图的解决方案。我尝试在课堂之外创建画布/图形，但并没有太大的不同。最慢的调用是创建底图并加载形状数据的调用。其他一切都运行得很快。

此外，我尝试保存底图以供将来使用，但由于我需要新轴，我无法让它工作。也许您可以为我指明如何做到这一点的正确方向。

我想让你知道我正在使用画布作为 PySide QWidget 并且我正在根据数据绘制不同类型的地图，这只是其中之一（例如，另一个是欧洲地图，或美国）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T21:30:27.970

您可以腌制和取消腌制底图实例（[在底图源中有一个这样做的示例](https://github.com/matplotlib/basemap/blob/master/examples/hires.py)），这可能会为您节省大量的绘图创建时间。

此外，可能值得看看 shapefile 读取需要多长时间（您可能也想腌制它）。

最后，我会认真考虑研究更新数据国家颜色的选项，而不是每次都制作一个新数字。

高温下，

# c# - 具有许多 Web 项目输出到同一目录的 MSBuild 解决方案

> ID：10504794
> 
> 赞同：3
> 
> 时间：2012-05-08T19:02:13.103
> 
> 标签：c#, asp.net, asp.net-mvc-3, msbuild

我想构建许多 Web 项目并将它们输出到一个目录，例如 ./output/Project1 ./output/Project2 等。这些文件夹中的每一个基本上都包含输出到 _PublishedWebsites 的内容。我试过这个：

```
msbuild support.sln /p:configuration=Release;DeployOnBuild=true;DeployTarget=Package;_PackageTempDir=c:/ws/code/supportsite/output/ /t:package 
```

但它似乎用构建的每个项目覆盖了输出目录的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T11:18:35.987

为什么不制作目标文件。

XCopyWebDeploy.targets

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">$(MSBuildProjectDirectory)\..\</SolutionDir>

        <XCopyDeployWebPackage Condition="  '$(XCopyDeployWebPackage)' == '' ">false</XCopyDeployWebPackage>
    </PropertyGroup>

    <ItemGroup>
        <ProjectFileItem Include="$(ProjectPath)"/>
    </ItemGroup>

    <PropertyGroup>
        <!-- Make the build depend on web deploy packages -->
        <BuildDependsOn Condition="$(XCopyDeployWebPackage) == 'true'">
            $(BuildDependsOn);
            Package;
            XCopyDeployWebPackage;
        </BuildDependsOn>
    </PropertyGroup>

    <Target Name="XCopyDeployWebPackage">
        <CreateItem Include="$(ProjectDir)obj\$(Configuration)\Package\PackageTmp\**\*.*">
            <Output ItemName="XCopyWebDeployPackageOutputFiles" TaskParameter="Include"/>
        </CreateItem>
        <CreateProperty Value="c:\ws\code\supportsite\output\%(ProjectFileItem.Filename)">
            <Output PropertyName="XCopyWebDeployOutput" TaskParameter="Value"/>
        </CreateProperty>
        <Copy 
            SourceFiles="@(XCopyWebDeployPackageOutputFiles)"
            DestinationFiles="@(XCopyWebDeployPackageOutputFiles->'$(XCopyWebDeployOutput)\%(RecursiveDir)%(Filename)%(Extension)')"/>
    </Target>
</Project> 
```

并导入 web 项目文件。

```
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
    <PropertyGroup>
        <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
        <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
        <ProductVersion>
        </ProductVersion>
        <SchemaVersion>2.0</SchemaVersion>
        <ProjectGuid>{BF6B6392-1398-42D3-AA90-ED87D02D351A}</ProjectGuid>
        <ProjectTypeGuids>{E3E379DF-F4C6-4180-9B81-6769533ABE47};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}</ProjectTypeGuids>
        <OutputType>Library</OutputType>
        <AppDesignerFolder>Properties</AppDesignerFolder>
        <RootNamespace>MvcApplication1</RootNamespace>
        <AssemblyName>MvcApplication1</AssemblyName>
        <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
        <MvcBuildViews>false</MvcBuildViews>
        <UseIISExpress>true</UseIISExpress>
        <IISExpressSSLPort />
        <IISExpressAnonymousAuthentication />
        <IISExpressWindowsAuthentication />
        <IISExpressUseClassicPipelineMode />
        <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\</SolutionDir>
        <RestorePackages>true</RestorePackages>
        <!--!!!-->
        <XCopyDeployWebPackage>true</XCopyDeployWebPackage>
        <!--!!!-->
    </PropertyGroup>

    <!-- Some lines omitted -->

    <Import Project="$(SolutionDir)\.nuget\nuget.targets" />

    <!--!!!-->
    <Import Project="$(SolutionDir)\XCopyWebDeploy.targets" />
    <!--!!!-->

    <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
        Other similar extension points exist, see Microsoft.Common.targets.
    <Target Name="BeforeBuild">
    </Target>
    <Target Name="AfterBuild">
    </Target> -->
</Project> 
```

# r - 在直方图的 Y 轴上打断

> ID：10504804
> 
> 赞同：13
> 
> 时间：2012-05-08T19:02:40.167
> 
> 标签：r, plotrix

我不确定到底该怎么称呼它，但我正在尝试实现一种“破碎直方图”或“轴间隙”效果： http: [//gnuplot-tricks.blogspot.com/2009/11/broken- histograms.html](http://gnuplot-tricks.blogspot.com/2009/11/broken-histograms.html)（示例在 gnuplot 中）与 R。

看起来我应该使用包中的`gap.plot()`函数`plotrix`，但我只看到了使用散点图和线图执行此操作的示例。我已经能够在我的情节周围的框中添加一个中断并在那里放置一个之字形，但我无法弄清楚如何重新调整我的轴以放大中断下方的部分。

重点是能够在我的直方图中显示一个非常大的条的最高值，同时放大我的大部分明显更短的箱。（是的，我知道这可能会产生误导，但如果可能的话，我仍然想这样做）

有什么建议么？

**更新 2012 年 5 月 10 日 1040 EST：**

如果我使用数据制作常规直方图并使用 <- 将其保存到变量 ( `hdata <- hist(...)`) 中，我会得到以下变量的以下值：

```
hdata$breaks
 [1] 0.00 0.20 0.21 0.22 0.23 0.24 0.25 0.26 0.27 0.28 0.29 0.30 0.31 0.32 0.33
[16] 0.34 0.35 0.36 0.37 0.38 0.39 0.40 0.41 0.42 0.43 0.44 0.45 0.46 0.47 0.48
[31] 0.49 0.50 0.51 0.52 0.53 0.54 0.55 0.56 0.57 0.58 0.59 0.60 0.61 0.62 0.63
[46] 0.64 0.65 0.66 0.67 0.68 0.69 0.70 0.71 0.72 0.73 0.74 0.75 0.76 0.77 0.78
[61] 0.79 0.80 0.81 0.82 0.83 0.84 0.85 0.86 0.87 0.88 0.89 0.90 0.91 0.92 0.93
[76] 0.94 0.95 0.96 0.97 0.98 0.99 1.00

hdata$counts
 [1]    675      1      0      1      2      2      0      1      0      2
[11]      1      1      1      2      5      2      1      0      2      0
[21]      2      1      2      2      1      2      2      2      6      1
[31]      0      2      2      2      2      3      5      4      0      1
[41]      5      8      6      4     10      3      7      7      4      3
[51]      7      6     16     11     15     15     16     25     20     22
[61]     31     42     48     62     57     45     69     70     98    104
[71]     79    155    214    277    389    333    626    937   1629   3471
[81] 175786 
```

我相信我想`$breaks`用作我的 x 轴和`$counts`我的 y 轴。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-09T00:37:01.997

您可以使用`gap.barplot`plotrix 包中的 。

```
# install.packages('plotrix', dependencies = TRUE)
require(plotrix)

   example(gap.barplot) 
```

或者

```
twogrp<-c(rnorm(10)+4,rnorm(10)+20)
gap.barplot(twogrp,gap=c(8,16),xlab="Index",ytics=c(3,6,17,20),
ylab="Group values",main="Barplot with gap") 
```

会给你这个， ![示例（gap.barplot）](../Images/67f7daa2b5e7d1d5aeff7512063fda48.png)

### 更新 2012-05-09 19:15:42 PDT

是否可以`facet_wrap`与`"free"`(or `"free_y"`)一起使用`scales`？这样您就可以并排比较数据，但有不同的 y 比例

这是我的快速示例，

```
library('ggplot2')

source("http://www.ling.upenn.edu/~joseff/rstudy/data/coins.R")
coins$foo <- ifelse(coins$Mass.g >= 10,  c("Low"), c("hight")) 
m <- ggplot(coins, aes(x = Mass.g)) 
m + geom_histogram(binwidth = 2) + facet_wrap(~ foo, scales = "free") 
```

以上会给你这个， ![在此处输入图像描述](../Images/84d67c517e9a3d8913dfb759fe0d92e3.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-06T13:36:00.597

这似乎有效：

```
gap.barplot(hdata$counts,gap=c(4000,175000),xlab="Counts",ytics=c(0,3500,175000),
    ylab="Frequency",main="Barplot with gap",xtics=hdata$counts) 
```

# c# - 数据错误对话框

> ID：10504807
> 
> 赞同：1
> 
> 时间：2012-05-08T19:02:52.040
> 
> 标签：c#, winforms

我得到一个 datagridview 默认错误对话框。那里说处理 dataerror 事件。我正在从数据表中加载 myy DGV 中的数据。当我尝试添加新行时，我单击带有 (*) 的空行。当我开始在新行单元格中输入一些值时，会显示 dataerror 并进入无限循环。

```
DataGridViewDataError.context = display. 
Error: Index 3 does not have a value. 
```

我的网格有 3 行，这里新行的索引为 3。

这是加载 DGV 的代码

```
 private void frmPlant_Load(object sender, EventArgs e)
    {
        Program.fMain = this;
        Program.LoadAllForms();
        string selectCommand = "select * from T1";
        FillData(selectCommand);

    }
    private void FillData(string selectCommand)
    {
        using (SQLiteConnection conn = new SQLiteConnection(connString))
        {
            conn.Open();
            dataGridView1.AutoGenerateColumns = true;

            da = new SQLiteDataAdapter("selectCommand", connString);
            ds = new DataSet();

            commandBuilder = new SQLiteCommandBuilder(da);

            da.Fill(ds, "T1");
            dt = ds.Tables[0];
            dataGridView1.DataSource = ds.Tables[0];
            dataGridView1.DataMember = "T1";
            dataGridView1.Columns["TID"].ReadOnly = true;
        }

    } 
```

我不知道这到底是在代码中发生的。处理了 DataError 事件。不确定 UserAddedRows, RowsValidating 是否有用

```
private void dataGridView1_DataError(object sender, DataGridViewDataErrorEventArgs e)
        {
            MessageBox.Show(e.Context.ToString());
            e.Cancel = true;
        } 
```

谢谢孙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:59:08.263

MSDN 是这样说的：

> 与此事件关联的 DataGridViewDataErrorEventArgs 对象的 ColumnIndex 和 RowIndex 属性通常指示发生数据错误的单元格。但是，当外部数据源中发生错误时，数据源可能不会提供发生错误的列。在这种情况下，ColumnIndex 属性通常指示错误发生时当前单元格的列。

使用这些属性找出错误发生在哪一列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:53:44.133

没有把握。尝试用 System.Diagnostics.Debug.WriteLine 替换 MessageBox.Show 语句，并在 RowsValidating 事件中执行相同操作。在这种情况下，MessageBox 可能会导致问题，因为它“暂停”了处理。

```
private void dataGridView1_DataError(object sender, DataGridViewDataErrorEventArgs e) 
{ 
    System.Diagnostics.Debug.WriteLine(e.Context.ToString()); 
    e.Cancel = true; 
} 
```

# objective-c - 如何检查 UITextField 在 iPad 应用程序中是否有数字、字母或字母数字条目？

> ID：10504808
> 
> 赞同：0
> 
> 时间：2012-05-08T19:02:53.650
> 
> 标签：objective-c, ipad, ios5, uitextfield

在我的 iPad 应用程序中，我有一个 UITextField。用户只能键入数字。如果用户键入字母或字母数字文本，则应该有一条警告消息说“仅输入数字”。我应该应用什么条件才能发现输入的文本是数字、字母或字母数字？任何帮助将不胜感激。

谢谢并恭祝安康

个人电脑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:15:05.660

实现`UITextFieldDelegate`方法

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string' 
```

然后，您可以拒绝该方法中的某些字符。

或者，将键盘样式设置为： `.keyboardType = UIKeyboardTypePhonePad;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:16:35.140

与其发出警报，不如阻止你不想要的角色？

如果您实施`textField:shouldChangeCharactersInRange:replacementString:`，您可以使用它来检测结果是否可接受，并允许或禁止编辑。

# qt - QScrollArea：自动滚动到新添加的小部件

> ID：10504810
> 
> 赞同：1
> 
> 时间：2012-05-08T19:02:56.687
> 
> 标签：qt, scrollview, qwidget

这不是我第一次想要一个行为如下的滚动区域（想象一个日志或聊天窗口，但太复杂而无法使用简单的 QTextBrowser）：

*   我想添加多个小部件，它们出现在另一个下方（例如放置在 QVBoxLayout 中时）
*   此布局中的每个小部件都应具有固定大小或宽度换高（如简单标签）
*   滚动区域应自动滚动到最近添加的区域
*   （可选）当有剩余空间时（滚动条尚未启用），内容应底部对齐

**使用 QScrollArea：**

我过去的尝试是在内部使用 QScrollArea 和 QVBoxLayout。但这似乎并没有我想的那么简单：每当我在布局中添加一个小部件时，布局并不会立即调整滚动区域内容小部件的大小，从而导致内容调整延迟。在短时间内，布局中包含的小部件会调整大小，以使总大小等于添加操作之前的总大小，从而导致每个小部件的大小过小。此外，在布局将其大小更正为小部件的新总大小之前，滚动到新添加的小部件是不可能的，因此即使是 QTimer::singleShot(0, ...) 也无济于事。即使超时时间为 20 左右，在某些情况下布局需要更多时间来调整大小。它不是确定性的，因此远离一个好的解决方案。

为了获得底部对齐行为，我最初在布局中放置了一个间隔项。只要没有剩余空间并启用滚动，它就不需要任何空间。

**使用 QListView：**

由于我的项目太复杂，它们需要是 QWidgets。他们无法获得焦点，无法选择，因此基于项目的解决方案似乎只是“错误的方式”。此外，这个解决方案听起来太“沉重”了。

我简直不敢相信没有简单的方法，所以我想我还没有看到它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:32:12.140

`QListView`应该没事。您声称您的项目是静态的，与它们没有交互：没有焦点，没有选择。`QWidget`对于此类物品，似乎 a是一种矫枉过正。您只需要具有固定大小并且可以自行绘制的东西。这正是 Qt 模型视图系统中的委托的用途。只需`QAbstractItemDelegate`为您的项目实现一个或多个 s，并为它们将呈现的数据提供模型的实现。这`QAbstractItemView`已经是一个`QAbstractScrollArea`！

如果你想在委托中绘制 HTML，这很容易——同样，QWidget 对静态显示来说太过分了！使用 QWidget 来“很难”是有原因的——API 会引导您找到正确的解决方案。假设您的模型包含每个项目的 html，以下是绘制它的方法。当然，您可以使用 sizeHint，并且应该缓存文本文档，理想情况下将其存储在我认为的模型中。

```
void MyDelegate::paint(QPainter* p, const QStyleOptionViewItem & opt, const QModelIndex & index) const
{
   QTextDocument doc;
   doc.setHtml(index.data().toString());
   doc.drawContents(p, QRect(QPoint(0,0), sizeHint(opt, index)));
}

QSize MyDelegate::sizeHint(const QStyleOptionViewItem &, const QModelIndex &) const
{
   return QSize(100, 200);
} 
```

# qt - 样式表布局和 SeekSlider？

> ID：10504823
> 
> 赞同：0
> 
> 时间：2012-05-08T19:03:55.997
> 
> 标签：qt, layout, qtstylesheets

我需要一些帮助，我有两个关于 Qt 的样式表定制的问题

我知道我可以将背景图像设置为小部件，但我可以使用 Qt 样式表将背景图像设置为布局吗？我可以使用样式表自定义 SeekSlider 吗？

* * *

我发现我可以像 QSlider 一样自定义 SeekSlider。现在布局仍然存在。

* * *

我使用 setLayout 将布局添加到小部件，并使用样式表到该小部件放置背景图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T15:00:46.977

布局没有视觉表示。它们只是控制子小部件的大小和位置。您将为布局所附加到的小部件设置样式。

# c# - 出口清单 进入excel文件

> ID：10504826
> 
> 赞同：2
> 
> 时间：2012-05-08T19:04:13.890
> 
> 标签：c#, excel, c#-4.0, ms-office

我有一个包含所有浮点值的列表（可以说 List< *float* > avgDifClosedLoop; ）

现在要做更多的过程，我想将它们导出到 excel 中。我怎样才能通过 c# 做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:25:38.453

您可以使用 COM 互操作服务以非常复杂的方式执行此操作，并直接写入 Excel 实例。使用这种方法，您可以像在 Excel 本身中一样调用工作表函数并在 VBA 中编码（但更好）。

快速简便的方法是，根据您还需要做什么以及需要执行多少次，将您的列表写成 CSV 文件

```
using (StreamWriter sw = new StreamWriter(outputFile))
{
    List<float> f = new List<float>();
    StringBuilder sb = new StringBuilder();
    foreach (var item in f)
    {
        sb.AppendLine(item.ToString());
    }
    string linetoWrite = String.Join(",", sb);
    sw.WriteLine(linetoWrite);
} 
```

然后在 Excel 中打开它，继续你的生活

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:20:44.867

将某些内容写入 excel 的最快、最简单的方法是将其写为 CSV 文件。

如果您需要的不仅仅是原始数字（例如，您还想格式化它们），那么当然可以使用 interop 或 system.io.packaging 直接编写 xls 或 xlsx 文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T19:20:22.277

在我看来，您有两种选择：

1.  使用[Excel 互操作](http://www.dotnetperls.com/excel)。

    这使您可以准确控制值的输出位置和方式，但它需要在执行代码的系统上安装 Excel，并且需要更多的编码技能。

2.  将值写入[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)文件。

    Excel 默认可以读取 CSV 文件。这种方法不需要比编写文本文件更复杂的东西，**也不**需要在生成系统上安装 Excel。但是，您对如何将文件输出到工作表中失去了一些控制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-08T19:34:38.190

是的，但您需要一个外部库来执行此操作（或需要安装 Office 的[互操作类）。](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel%28v=office.11%29.aspx)[但是您可以使用NPOI](http://npoi.codeplex.com)来执行此操作（无需互操作）。

例子：

```
using System.Collections.Generic;
using System.IO;
using System.Windows;
using System.Windows.Documents;
using NPOI.HSSF.UserModel;

namespace listFloatToExcel
{

    [...]

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            //list of floats
            List<float> f = new List<float>();
            f.Add(4.323F);
            f.Add(34.54F);
            f.Add(12.4F);
            f.Add(454F);
            f.Add(0987.32F);

            // Create a new workbook and a sheet named "Floats"
            var workbook = new HSSFWorkbook();
            var sheet = workbook.CreateSheet("Floats");

            var rowIndex = 0;
            foreach (var n in f)
            {
                var row = sheet.CreateRow(rowIndex);
                row.CreateCell(0).SetCellValue(n);
                rowIndex++;
            }

            using (var fileData = new FileStream(@"C:\temp\listFloatToExcel\floats.xls", FileMode.Create))
            {
                workbook.Write(fileData);
            }

       }

    [...]
} 
```

# mysql - MySQL - 分成更多表？

> ID：10504827
> 
> 赞同：0
> 
> 时间：2012-05-08T19:04:14.503
> 
> 标签：mysql, relational-database, normalization

我正在创建一个订单系统来跟踪订单。大约有60种左右的产品，每种都有自己的价格。该系统虽然不是很复杂，但只需要能够提交该人订购的每种产品的数量即可。

我的问题是，拥有一个“订单”表是否更有效，其中的列代表每个产品，而数值代表他们订购的每个产品的数量......例如：

```
orders
    id
    product_a
    product_b
    product_c
    etc... 
```

或者

我应该把它分成不同的表，用一个多对多的表来加入它们。可能是这样的：

```
customers
     id
     name
     email

orders
     id
     customer_id

products
     id
     product

orders_products
     order_id
     product_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:06:31.620

我会像你在第二个样本中展示的那样把它分开。这将使您的应用程序更具可扩展性，并且仍然非常有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:18:16.510

如果您选择第一种情况，您将如何跟踪您为每种产品提供给客户的价格和折扣？即使您现在没有计划跟踪它，这也是很常见的事情，因此可能会要求进行此类更改。

使用规范化模式，您所要做的就是添加几个字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:03:23.323

始终为未来的功能和扩展而构建。当您必须重新架构和重构整个事物时，这里或那里的捷径似乎总是会咬到您。查找规范化以及为什么要分离关系数据库中的每个独立元素。

我经常被问到“为什么要让它成为一个单独的表格，这种方式更简单？” 然后提醒他们他们的“哦，我们不会使用其他这种类型的东西”然后让他们要求一个需要多对多的功能，没有意识到他们没有考虑未来的功能而把你逼到了角落. 不了解数据结构的人往往无法意识到这一点，并且不善于指定系统要求。这通常发生在数据库开始变大并且他们意识到他们希望能够只查看数据的子集时。扁平数据库意味着添加列来处理大量不同的需求，而多对多连接表只需几行代码即可完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:08:12.787

我也会使用第二种方式。如果数据库像你说的那样简单，那么在速度等方面可能差别不大。但是第二种方式更有效，更容易重用/增强，以防您获得新想法并添加到您的应用程序中。

# javascript - Framey API - “Uncaught SyntaxError: Unexpected token :”当我请求 json

> ID：10504834
> 
> 赞同：0
> 
> 时间：2012-05-08T19:04:33.457
> 
> 标签：javascript, json, format, response

我正在使用 Framey API 进行视频录制。当我发出请求时，我得到了我期望的 json 响应，但出现了错误：

```
Uncaught SyntaxError: Unexpected token : 
```

这是javascript

```
var url = "http://framey.com/api/videos/ba9bd910-549d-012e-32f4-549a20bdfc52?
api_key=7VNKGLJZLKSASZ0FXN2TVSZQU&signature=41B08D68E0A4AC2DD91107BBD6AD08B8&time_stamp=1304447242";

$("button").click(function() {
     $.ajax({
          url: url,
      dataType: 'json',
      crossDomain: true

    }).done(function() { 
       $(".video").html("here it is babyF!");
     });
}); 
```

该网址只是 Framey 网站的示例网址，我不知道它是否有效。通过阅读这个问题[Uncaught SyntaxError: Unexpected token :](https://stackoverflow.com/questions/3143698/uncaught-syntaxerror-unexpected-token)，我认为我可能遇到了同样的问题。该问题的选定答案是

> 对于可能有同样问题的人来说，仅供参考——我只需要让我的服务器将 JSON 作为 application/json 发回，默认的 jQuery 处理程序就可以正常工作。

我认为我无法影响 Framey 向我发回数据的方式，所以我不确定如何解决这个问题。也许它是别的东西？提前致谢，如果您需要更多信息，请告诉我。

=========编辑============

这是 Framey 的回复，它给了我错误：

```
{"success":true,"video":{"name":"6d235a90-7b4b-012f-f97e-12313d297e67","filesize":1335504,"duration":20.48,"state":"uploaded","views":1,"data":{},"flv_url":"http://framey.com/videos/source/6d235a90-7b4b-012f-f97e-12313d297e67.flv","mp4_url":"http://framey.com/videos/source/6d235a90-7b4b-012f-f97e-12313d297e67.mp4","large_thumbnail_url":"http://framey.com/thumbnails/large/6d235a90-7b4b-012f-f97e-12313d297e67.jpg","medium_thumbnail_url":"http://framey.com/thumbnails/medium/6d235a90-7b4b-012f-f97e-12313d297e67.jpg","small_thumbnail_url":"http://framey.com/thumbnails/small/6d235a90-7b4b-012f-f97e-12313d297e67.jpg"}} 
```

我认为这是关于 Framey 将“application/javascript”放在应该说“application/json”的地方

============ 编辑2 =================

这是响应的标题，我通过查看 Chrome 中控制台的“网络”部分得到了这些标题。

```
Request URL:http://www.framey.com/api/videos/32a7aaf0-7c3a-012f-37bd-12313b093125?api_key=00000000&signature=624643a3481b2a2c2bdb6c7cc29c506e&time_stamp=1536494436&callback=jQuery17202607689620926976_1336594235235&_=1336594483714
Request Method:GET
Status Code:200 OK
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Cookie:__utma=229279307.404664337.1336485291.1336573199.1336589854.6; __utmc=229279307; __utmz=229279307.1336485291.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); _video-recorder_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFRiIlN2VjODBiYWM1NDk2MDlkYTg2ZTY0NzEzNDA5Zjg3ZGJJIhBfY3NyZl90b2tlbgY7AEZJIjE4aW5KVktxakhyVTRvVGY0RXZlNkVkMU9lV0p1NUEzR01rVzlNK1hRWEJ3PQY7AEY%3D--b9a5f6cf08d7539d2bf9ebebc83ce96b0d070615
Host:www.framey.com
Referer:http://localhost:3000/questions/1
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19
Query String Parametersview URL encoded
api_key:000000000000
signature:624643a3481b2a2c2bdb6c7cc29c506e
time_stamp:1536494436
callback:jQuery17202607689620926976_1336594235235
_:1336594483714
Response Headersview source
Cache-Control:max-age=0, private, must-revalidate
Connection:keep-alive
Content-Length:709
Content-Type:text/javascript; charset=utf-8
ETag:"5e8393861da01fa2effd911365a90e6b"
Server:nginx/1.0.10 + Phusion Passenger 3.0.11 (mod_rails/mod_rack)
Set-Cookie:_video-recorder_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFRiIlN2VjODBiYWM1NDk2MDlkYTg2ZTY0NzEzNDA5Zjg3ZGJJIhBfY3NyZl90b2tlbgY7AEZJIjE4aW5KVktxakhyVTRvVGY0RXZlNkVkMU9lV0p1NUEzR01rVzlNK1hRWEJ3PQY7AEY%3D--b9a5f6cf08d7539d2bf9ebebc83ce96b0d070615; path=/; HttpOnly
Status:200
X-Powered-By:Phusion Passenger (mod_rails/mod_rack) 3.0.11
X-Runtime:0.060476
X-UA-Compatible:IE=Edge,chrome=1 
```

特别感兴趣的是内容类型标头：它是 text/javascript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:23:25.790

您在哪里找到该演示代码（我在 Framey 网站上找不到）？我怀疑您在尝试从客户端使用 Framey REST API 时会遇到跨域问题。您的代码是否在我们可以查看的可公开访问的服务器上？

# javascript - 如何等到效果结束？（我看了重复）

> ID：10504836
> 
> 赞同：0
> 
> 时间：2012-05-08T19:04:43.300
> 
> 标签：javascript, jquery, html, css

所以我有这个网站：[http](http://webzilla-il.com/contactus.php) ://webzilla-il.com/contactus.php ，现在我知道它不是英文的，但文字并不重要，重要的是 jquery，尝试单击紫色区域上的每个图像，正如你可以看到一个 div 幻灯片与一些文本一样，现在尝试一个接一个地快速单击图像，div 在向上滑动完成之前就显示出来，让它看起来很糟糕......

到目前为止，我的代码是：

```
//Contact us
$(document).ready(function(){
    $(".box").click(function(){
        var name = $(this).attr("name");
        $(".sform").slideUp().promise().done(function() {                   
            switch(name){
                case "skype":
                    $('.sform[name="'+name+'"]').next().promise().done(function() {$(this).css("margin-left","4px")});
                    $('.sform[name="'+name+'"]').slideDown();
                    break;
                case "form":
                    $('.sform[name="skype"]').next().promise().done(function() {$(this).css("margin-left","60px")});
                    $('.sform[name="'+name+'"]').slideDown();
                    break;
                case "email":
                    $('.sform[name="skype"]').next().promise().done(function() {$(this).css("margin-left","60px")});
                    $('.sform[name="'+name+'"]').slideDown();
                    break;
            }
        });             
    });
}); 
```

我的html：

```
 <div id="contact_forms">
        <div class="cform sform" style="margin-left: 60px; display: none;" name="skype"> <!--Skype-->
            <div class="skypes">
            <h5><a class="cf" href="skype:londneramit">londneramit</a></h5>
                עמית לונדנר
            </div>
            <br />
            <div class="skypes" name="skype">
                <h5><a class="cf" href="skype:dan_barzilay">dan_barzilay</a></h5>
                דן ברזילי   
            </div>
        </div>
        <div class="cform" style="margin-left: 60px; visibility: hidden;"></div> 

        <div class="cform sform" name="form"> <!--Form-->
            <div id="webzilla_contact_us" style="border: none;">
                <form method="POST" onsubmit="return contactUs(this)">
                    <input type="text" name="name" />
                    <input type="email" name="email" />
                    <input type="text" name="title" />
                    <br style="clear: both;" />
                    <textarea name="content"></textarea>
                    <input type="submit" name="contactsub" value="שלח!"/>
                </form>
            </div>
        </div>
        <div class="cform" style="visibility: hidden;"></div> 

        <div class="cform sform" style="display: none;" name="email"> <!--Email-->
            <h6><a class="cf" href="mailto:webzilla-il@gmail.com">webzilla-il@gmail.com</a></h6>
            <div id="breaker"><img src="img/Contact/shadow_breaker.png" alt="breaker" /></div>
            <div class="emails">
                <h5><a class="cf" href="mailto:londner.amit@gmail.com">londner.amit@gmail.com</a></h5>
                עמית לונדנר
            </div>
            <br />
            <div class="emails">
                <h5><a class="cf" href="mailto:barzilaydn@gmail.com">barzilaydn@gmail.com</a></h5>
                דן ברזילי                   
            </div>
        </div>
    </div> 
```

如您所见，我尝试过 promise().done()...

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:06:47.213

**编辑：**

```
 $('.sform').not(":visible").slideUp(function() {
            // will be called when the element finishes fading out
            // if selector matches multiple elements it will be called once for each
            switch(name){
                    case "skype":
                        $('.sform[name="'+name+'"]').next().promise().done(function() {$(this).css("margin-left","4px")});
                        $('.sform[name="'+name+'"]').slideDown();
                        break;
                    case "form":
                        $('.sform[name="skype"]').next().promise().done(function() {$(this).css("margin-left","60px")});
                        $('.sform[name="'+name+'"]').slideDown();
                        break;
                    case "email":
                        $('.sform[name="skype"]').next().promise().done(function() {$(this).css("margin-left","60px")});
                        $('.sform[name="'+name+'"]').slideDown();
                        break;
                }

        }); 
```

[文档](http://api.jquery.com/fadeOut/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:11:38.880

试试这个

```
$(".sform").stop(true, true).slideUp().promise().done(..) 
```

这可能会带来一些运气：

```
$(".sform:animated").slideUp(100).promise().done(..) 
```

或者

```
$(".sform:animated").slideUp(100, function() {
  switch(name) {...}
}) 
```

你可以检查一下`duration`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:12:14.920

由于某种原因，我的工作防火墙不允许我查看您的网站，但是查看您的代码，您可能可以尝试使用以下回调：

```
$(".sform").slideUp(function() {                   
    switch(name){
        case "skype":
            $('.sform[name="'+name+'"]').next().promise().done(function() {$(this).css("margin-left","4px")});
            $('.sform[name="'+name+'"]').slideDown();
            break;
        case "form":
            $('.sform[name="skype"]').next().promise().done(function() {$(this).css("margin-left","60px")});
            $('.sform[name="'+name+'"]').slideDown();
            break;
        case "email":
            $('.sform[name="skype"]').next().promise().done(function() {$(this).css("margin-left","60px")});
            $('.sform[name="'+name+'"]').slideDown();
            break;
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:13:17.327

这是因为每次单击其中任何一个时，您都会将 SlideUp 调用到所有框。

```
$(".sform").not(":visible").slideUp().promise().done(function() {      

... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T19:45:26.547

更简单的东西，

这是你想要达到的目标吗？

[**演示**](http://jsfiddle.net/d96JQ/20/)

# c# - Texture2D 作为类构造函数的参数

> ID：10504839
> 
> 赞同：-1
> 
> 时间：2012-05-08T19:05:01.290
> 
> 标签：c#, xna-4.0

我正在制作一个 Level.cs 类，它应该将背景图像 (texture2d) 作为 Level 类构造函数的参数。但它不会接受变量'back'..我该怎么办？

```
 public Level(Texture2D back ,ContentManager content, EventHandler ScreenEvent, Microsoft.Xna.Framework.Game game) : base(ScreenEvent)
    {
        background = content.Load<Texture2D>(back);
        backgroundVector = new Vector2(-1150, 0);
        velocity = 5.0f;
        ground = 508;
        graphics = new GraphicsDeviceManager(game);   
    } 
```

最好的问候丹尼。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:08:26.200

您正在尝试从纹理加载纹理？

您可以将“Texture2D”重命名为字符串

```
 public Level(String back ,ContentManager content, EventHandler ScreenEvent, Microsoft.Xna.Framework.Game game) : base(ScreenEvent)
{
    background = content.Load<Texture2D>(back);
    backgroundVector = new Vector2(-1150, 0);
    velocity = 5.0f;
    ground = 508;
    graphics = new GraphicsDeviceManager(game);   
} 
```

或者只是做

```
 public Level(Texture2D back ,ContentManager content, EventHandler ScreenEvent, Microsoft.Xna.Framework.Game game) : base(ScreenEvent)
{
    background = back;
    backgroundVector = new Vector2(-1150, 0);
    velocity = 5.0f;
    ground = 508;
    graphics = new GraphicsDeviceManager(game);   
} 
```

# java - Java 执行 .bat 文件

> ID：10504844
> 
> 赞同：-1
> 
> 时间：2012-05-08T19:05:29.653
> 
> 标签：java, batch-file, cmd, command

我在 Netbeans 平台上使用 Windows 7 和程序。我写了这一行：

```
Runtime.getRuntime().exec("cmd /c start make.bat"); 
```

当我运行 bat 时，它运行良好，但是 java 调用它，这就是我得到的：

> ```
> C:\Users\RB\Documents\NetBeansProjects\BinaryTree>dot -T png -o tree.png tree.dot
> 
> 'dot' is not recognized as an internal or external command,
> operable program or batch file.
> 
> C:\Users\RB\Documents\NetBeansProjects\BinaryTree>cmd
> Microsoft Windows [Version 6.1.7601]
> Copyright (c) 2009 Microsoft Corporation.  All rights reserved. 
> ```

浴文件的内容是：

```
dot -T png -o tree.png tree.dot 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:14:25.430

尝试在您的 bat 文件中指定“点”程序的完整路径。Runtime.getRuntime().exec() 和您的操作系统中的 PATH 等环境变量可能不一样。

# python - Python 帮助，If 和 Else

> ID：10504845
> 
> 赞同：0
> 
> 时间：2012-05-08T19:05:40.603
> 
> 标签：python

我正在为一个小项目在 python 中制作一个基本的回文检查器。我四处寻找，没有找到答案。

我在脚本末尾附近使用以下代码：

```
if String1 == String2:
               print("Yes")
else:
               print("No") 
```

运行此代码时收到语法错误。String1 是用户输入的文本，String2 是我之前开发的反向文本。我正在运行 Python 3.2.3

提前致谢

我正在使用 String2 == String1[::-1] 进行回文检查，我收到的错误是 SyntaxError: invalid syntax

编辑：这是我的确切代码，但是我不确定在哪里放置其他内容：我在新行和之前的行上都尝试过多次，但没有成功。在这种情况下，String1 是“racecar”

```
Python 3.2.3 (default, Apr 11 2012, 07:15:24) [MSC v.1500 32 bit (Intel)] on win32
Type "copyright", "credits" or "license()" for more information.
>>> import easygui as eg
>>> String1 = eg.enterbox(msg="Enter a Word")
>>> String2 = String1[::-1]
>>> if String1 == String2:
    print("Yes")

Yes
>>> else:

SyntaxError: invalid syntax
>>> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:21:46.750

`[::-1]`用于检查回文应该像一个魅力：

```
>>> s1 = "This is a string."
>>> s2 = "racecar"
>>> s1 == s1[::-1]
False
>>> s2 == s2[::-1]
True 
```

你的代码中有一些东西你没有向我们展示。您需要粘贴更大的代码片段，或者您收到的*实际回溯。*

而且，现在要说明您粘贴的回溯 - 您没有在语句`print`之后缩进命令。`if`因为`if`子句立即结束，所以提供 else 是没有意义的（语法错误）。缩进是 Python 中的语法。你需要它看起来像这样：

```
if String1 == String1[::-1]:
  print("Yes")
else:
  print("No") 
```

间距是*强制性*的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:27:27.907

```
print(["No", "Yes"][string1 == string1[::-1]]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T19:38:36.467

您的基本问题是您试图在交互式提示下执行所有这些操作。你可以这样做，但你需要特别注意确保 Python 将所有语句解释为同一块的一部分。空行在这里很重要；因为你在前面放了一个空行`else:`，Python 认为你已经结束了你的`if:`并且你试图`else:`在一个块的开头使用，这确实是一个语法错误。

因此，在您了解其中的原理之前，如果您只是将代码放在一个文件中并从那里运行它，将会简单得多。您可以使用 IDLE（文件 > 新建，然后按 F5 来运行您的代码）来执行此操作，或者您可以使用任何文本编辑器并从命令窗口运行您的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:39:36.500

线后

```
if String1 == String2:
    print("Yes") 
```

按 Enter ，然后**按 Backspace**，然后写：

```
else: 
```

按 Enter agian，然后写：

```
print("no") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T21:03:32.480

您已经接受了答案，但我会这样写：

```
print 'Yes' if String1 == String2 else 'No' 
```

它将单个概念（在两个可能的答案之间进行选择）封装到一行中。

# c++ - 什么是多重虚拟继承？

> ID：10504847
> 
> 赞同：4
> 
> 时间：2012-05-08T19:05:45.297
> 
> 标签：c++, virtual-inheritance

```
class foo : public virtual bar, public virtual kung
{
  // implementation of the method of the above inherited class
}; 
```

bar 和 kung 类是一个抽象类，它包含在 foo 类内部实现的纯虚方法。

这个有什么用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:10:54.973

在您的情况下，如果 bar 和 kung 是派生最多的基类，只要 bar 和 kung 中没有任何方法发生冲突，那么您就会知道它是否发生冲突，即编译器在不明确的定义中出现错误。

在 c++ 常见问题解答中了解更多信息：http: [//www.parashift.com/c++-faq-lite/multiple-inheritance.html#faq-25.9](http://www.parashift.com/c++-faq-lite/multiple-inheritance.html#faq-25.9)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T21:20:28.497

通过这样做，foo 类是 bar 和 isa kung。

如果您有一个接受 bar 对象的函数或方法，则 foo 类的实例化将符合条件。由于 bar 类具有纯虚方法，如果对象被实例化，编译器将需要 foo（或从 foo 派生的类）来定义方法。然后，获取 bar 对象的代码可以依赖于知道传递给它的 bar 对象实现了该方法，即使该对象是 foo 类的实例（或从 foo 派生的类）。

功课也是如此。

因此，如果 foo 类实现了 bar an kung 中的所有纯虚方法（编译器将需要这些方法来实例化 foo 对象），那么 foo 对象可以传递给任何需要 bar、kung 或 foo 对象的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:11:48.310

如果其他未来的类`foo`以不止一种方式派生，那么最派生的类将只包含*一个*虚拟基类`bar`和`kung`：

```
struct A : foo { };
struct B : foo { };

class Gizmo : public A, public B { }; // only *one* bar and kung base class. 
```

type 的对象`Gizmo`具有唯一的 type 基础子对象，`bar`对于 , 也是如此`kung`，而不是每个派生路径都有两个不同的子对象。

请注意，如果一个类*只有*纯虚拟函数，没有非静态成员，只有相同性质的基类，那么虚拟继承和非虚拟继承之间没有实际区别，因为类是空的。其他较小的语言将此类类称为“接口”，这意味着可以*从*它们乘以继承，即使此类语言不支持通用类的多重继承。

# php - 等级价格不显示 Magento

> ID：10504849
> 
> 赞同：1
> 
> 时间：2012-05-08T19:05:52.847
> 
> 标签：php, magento

我是 magento 的新手。我有一种产品的等级价格如下：

```
a) 500 and above -> $46 
b) 1000 and above -> $43  
c) 1500 and above -> $39 
```

产品价格（实际）为 46 美元。所以在产品详情页面上，
它没有显示第一层价格（a）。见下文：

```
Buy 1000 for $43 each and save 7% 
Buy 2500 for $39 each and save 16% 
```

虽然实际价格和最低等级价格相同，但如何在上面的列表中显示最低等级价格。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T21:41:58.140

确保您的基本产品价格高于 46 美元...如果您的基本产品价格低于等级价格，则等级价格不会显示。

# magento - Magento - 按类别属性过滤类别列表

> ID：10504852
> 
> 赞同：0
> 
> 时间：2012-05-08T19:06:08.310
> 
> 标签：magento, attributes, filter, categories

我有一个商店类别列表，除了一件事之外，一切都运行良好。我希望类别列表省略任何设置为“包含在导航菜单中 = 否”。

我现在可以说这个属性没有被加载，但我很难弄清楚过滤器的放置位置。目前，我通过以下方式获取我的类别列表：

```
<?php $_helper = Mage::helper('catalog/category') ?>
<?php $_categories = $_helper->getStoreCategories() ?> 
```

其次是：

```
<?php foreach ($_categories as $_category) : ?>
<?php $_category = Mage::getModel('catalog/category')->load($_category->getId()) ?>
...
... 
```

在这一点上，我有我想要的类别对象。但是，如果我对这些对象运行调试，则不会列出“include_in_menu”属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T20:04:07.900

所以出于某种原因：

```
<?php $_subCategory->getIncludeInMenu() ?> 
```

跑步后没有为我工作：

```
<?php foreach($_parentCategory->getChildrenCategories() as $_subCategory) : ?> 
```

该对象仍然是相同的模型，但 ['include_in_menu'] 不再是该对象的一部分。我不喜欢这个解决方案，但我只是将对象重新转换回来：

```
<?php $_subCategory = Mage::getModel('catalog/category')->load($_subCategory->getId()) ?> 
```

然后它工作得很好。不知道为什么让孩子们会剥离物体，但确实如此。

# api - Redis Booksleeve - 如何正确使用 Hash API

> ID：10504853
> 
> 赞同：2
> 
> 时间：2012-05-08T19:06:08.390
> 
> 标签：api, redis, hash, booksleeve

我正在为 Redis 使用 Booksleeve 哈希 API。我正在执行以下操作：

```
 CurrentConnection.Hashes.Set(0, "item:1", "priority", task.priority.ToString());

  var taskResult = CurrentConnection.Hashes.GetString(0, "item:1", "priority");

  taskResult.Wait();

  var priority = Int32.Parse(taskResult.Result) 
```

但是我得到一个聚合异常：“针对持有错误值的键的 ERR 操作”

我不确定我在这里做错了什么（除了阻止任务:)）。

注意：CurrentConnection 是 BookSleeve.RedisConnection 的一个实例

请帮忙！

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T06:56:44.150

这不是 Booksleeve 问题 - 这是一个 redis 错误；实际上，您应该看到的*完整错误消息是：*

> Redis 服务器：针对持有错误类型值的键的 ERR 操作

（我试图澄清这个错误来自redis，而不是Booksleeve）

至于是什么原因造成的：redis中的每个key都有一个指定的类型；字符串、散列、列表等。您不能对非散列的东西使用散列操作。

那么，我的猜测是“item:1”*已经存在*，但不是散列。我有单元测试可以从 Booksleeve 确认这一点（即有/没有预先存在的非哈希值）。

您可以使用 redis-cli 或任何其他客户端（telnet 工作，在推送时）在 redis 中调查此问题，使用以下命令：

```
type item:1 
```

（感谢@Sripathi）

# .htaccess - 使用完整的 post/get 参数从子目录重定向到子域

> ID：10504856
> 
> 赞同：1
> 
> 时间：2012-05-08T19:06:25.550
> 
> 标签：.htaccess

我已经设置了一个 .htaccess 文件，它将请求重定向到子目录`example.com/app/`到子域`app.example.com`

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule (.*) http://app.example.com/$1 [R=301,L] 
```

这是可行的，但是当带有 post 参数的请求被发送到`example.com/app/mcp.php`url 时，会被重定向到`app.example.com/mcp.php`没有 post 参数的位置。

我的问题是

*   如何使用 post/get 参数将请求从子目录重定向到子域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:53:26.113

这是不可能的。HTTP 规范阻止了它。可以在此评论中找到问题的完整描述 [https://stackoverflow.com/a/1562986/58456](https://stackoverflow.com/a/1562986/58456)

# vb.net - 错误：“查询生成器失败。无法打开用户默认数据库。登录失败。用户登录失败 "

> ID：10504863
> 
> 赞同：1
> 
> 时间：2012-05-08T19:06:53.053
> 
> 标签：vb.net, sql-server-express

我在 Windows XP 中使用 Visual Basic Express 2010 和 SQL Express 2008。

起初我无法添加数据源（数据库的 .mdf 文件），因为“操作系统错误 32”我似乎已经通过授予自己 .mdf 文件的完全权限（通过右键单击文件和进入属性，然后进入安全性）并重新启动 SQL SERVER (SQLEXPRESS) 服务。

数据库的数据集在我的解决方案资源管理器中，但是当我右键单击表适配器以添加查询并尝试打开查询生成器时，我得到了上面标题中的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:23:47.687

1.  确保启用了通过 TCP/IP 和命名管道的 SQL Express 远程连接。如果您不确定如何操作，可以参考这篇文章：[如何：配置 Express 以接受远程连接](http://blogs.msdn.com/b/sqlexpress/archive/2005/05/05/415084.aspx)

2.  打开 SQL Server Management Studio 并确保您可以连接到数据库。

3.  尝试使用相同的凭据从 Visual Studio（服务器资源管理器窗口）重新连接。

# powershell - Powershell“插件”系统

> ID：10504867
> 
> 赞同：4
> 
> 时间：2012-05-08T19:07:52.317
> 
> 标签：powershell

我们编写了一个 powershell 脚本，它处理来自内部系统的图像并将它们发送到另一个系统。现在，业务的另一部分希望与此挂钩并自己处理数据并将其推送到另一个系统。四处打听，公司周围有几个感兴趣的各方，所以我想让添加这些新系统变得简单。

第一个原型简单地打开`.ps1`一个文件夹中的所有文件，并在其中运行一个特别命名的函数，并希望基本上是最好的。但是，这似乎可以改进。是否有一些既定的 powershell 最佳实践来做一些类似插件的系统？如果没有，考虑到这是在一个非常安全的环境中执行的，并且管理员将签入新模块，我的上述方法有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T06:41:21.953

你为什么不为你的主脚本使用一个配置文件，明确地告诉你要调用什么脚本和函数？像这样的东西（警告：这是从我写的东西中复制/粘贴和改编的代码。可能包含一些小故障，但这会给你一个大致的想法）：

```
<?xml version="1.0"?>
<configuration>
  <Plugins>
    <Plugin Path="c:\blah\plugin1.ps1" PowerShellFunction="My-Plugin-Function" />
  </Plugins>
</configuration> 
```

在您的主脚本中：

```
function Load-Plugins
{
    param (
        [parameter(Mandatory = $true)][xml] $config,
        [parameter(Mandatory = $true)][string] $nodeType
    )

    $plugins = @{}

    foreach ($pluginNode in $config.SelectNodes($nodeType))
    {
        if ($pluginNode)
        {
            $Path = $pluginNode.Path
            $powerShellFunction = $pluginNode.PowerShellFunction

            $plugin = New-Object Object |
                Add-Member -MemberType NoteProperty -Name "Path" -Value $Path -PassThru |
                Add-Member -MemberType NoteProperty -Name "PowerShellFunction" -Value $powerShellFunction -PassThru

            $plugins[$Path] = $plugin
        }
    }

    return $plugins
}

function Execute-Plugins
{
    param (
        [parameter(Mandatory = $true)][hashtable] $plugins
    )

    $Error.Clear()

    if (!$plugins.Values)
        { return }

    foreach ($plugin in $plugins.Values)
    {
        & .\$plugin.Path
        Invoke-Expression "$($plugin.PowerShellFunction)"
    }
}

function Load-Script-Config  
{
    param (
        [parameter(Mandatory = $false)][string] $configFile
    )

    if (!$configFile)
        { $configFile = (Get-PSCallStack)[1].Location.Split(':')[0].Replace(".ps1", ".config") }

        return [xml](Get-Content $configFile)
}

$pluginConfig = Load-Script-Config
$plugins = Load-Plugins $config "configuration/Plugins/Plugin"
Execute-Plugins $plugins 
```

# android - 停止 ContentProvider 请求

> ID：10504873
> 
> 赞同：0
> 
> 时间：2012-05-08T19:08:10.803
> 
> 标签：android, multithreading, android-contentprovider, android-contentresolver

我有一个长期运行的内容提供程序，基本上它在云中进行一些搜索并返回带有结果的光标。我的问题是取决于服务器的连接和负载。结果可能需要 5-7 秒才能返回。

似乎如果我使用 Content Provider 进行预测搜索，它会阻止其他查询（来自同一活动），直到前一个查询返回。

有关如何取消提供者查询的任何建议？

我曾尝试使用 asyncTask & Thread，但无济于事。看来我仍然在提供程序（解析器）上被阻止

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T22:01:07.893

也许您应该仅将内容提供程序用于访问本地 SQLite DB 并在服务中执行长时间操作。

观看此视频：[Google I/O 2010 - Android REST 客户端应用程序](http://youtu.be/xHXn3Kg2IQE)。它是关于构建一个 REST 客户端应用程序，但您可以将类似的体系结构用于背景内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T13:16:34.697

看起来在 JellyBean 中，有一个新选项可以取消（）内容提供程序查询。

实际上，我最终接受了您的建议，并重写了内容提供程序以将光标移至 sqlitedb，并使用意图服务来更新数据库 .. 工作得非常好..

我确实遇到了一个问题，如果提供者被杀死，客户端似乎没有收到通知，并且可以继续发送服务意图而没有响应。有几种方法来处理这个问题（在提供者中，我可以改变它来做带有原始 uri 的广播事件，光标已断开连接，但这有点慢）..

我最终只是回答了我自己的问题，如果在您连接时提供者被杀死，这可能会对某人有所帮助......

[带光标的内容提供者 - 被杀死（如何通知客户端）](https://stackoverflow.com/questions/12353322/content-provider-w-cursor-gets-killed-how-to-notify-client/12388863#12388863)

# asp.net-mvc-3 - MVC3 应用程序并跟踪用户最初输入的页面

> ID：10504880
> 
> 赞同：2
> 
> 时间：2012-05-08T19:08:29.967
> 
> 标签：asp.net-mvc-3, url, cookies, login, registration

并感谢您花时间阅读我的问题。我们将有可能到达另一个用户的个人资料页面的网站访问者。然后，我们将鼓励他们登录该网站，或者如果他们当前不是会员，则注册为新会员。这些操作使他们远离他们声明的初始页面/URL，但我们希望能够在完成登录/注册后通过“跟踪”他们开始的位置将他们“跳转”回该页面。（注意：如果重要的话，我们使用的是标准的 Microsoft 会员提供程序类。）“跳回”部分看起来很简单，但问题在于“跟踪”部分。

插图/示例：

访问者点击后到达站点：www.mysite.com/profiles/ID=108

然后访问者离开该页面进行登录。我们如何才能以某种方式最好地捕获 ID=108，以便（已登录）用户返回该配置文件页面有一个很好的选择？我从阅读中了解到 cookie 不是最佳选择，但由于用户尚未登录等，其他一些选项似乎让我的思维变得混乱。

我可以采取什么具体步骤以最好的 MVC3 方式解决这个问题？

编辑：

```
 public ViewResult MyProfile(int? id)
    { 
    HttpCookie cookie = new HttpCookie("MySiteCookie");
    cookie.Value = id.ToString();
    cookie.Expires = DateTime.Now.AddYears(1); //or whatever time is appropriate
    System.Web.HttpContext.Current.Response.Cookies.Add(cookie);

    //do some other stuff
    } 
```

在另一端，为了使用 cookie，我将它（暂时）放入菜单中，方式如下：

```
 var MyProfileId = "";
    if (Request.Cookies["MySiteCookie"] != null)
    {HttpCookie cookie = request.Cookies["MySiteCookie"];
    MyProfileId = Server.HtmlEncode(cookie.Value);} 
```

然后你把它放到你的链接中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:15:54.063

你有几个选择：

1）您可以在控制器中使用 Session 来存储值：

```
Session.Remove("ID");
Session.Add("ID", "108") 
```

并在被调用的Controller中检索。

```
ID = Session["ID"]; 
```

2）您可以在登录控制器的查询字符串上传递 ID=108：

```
return RedirectToAction("Edit", "Profile", new { ID = "108" }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:13:49.490

> 我从阅读中了解到 cookie 不是最佳的

恕我直言 cookie 是解决此问题的最佳方法。当匿名用户登陆个人资料页面时，只需发出一个包含`id`他当前正在查看的个人资料的 cookie。然后稍后当他成功登录时读取此cookie值以获取`id`并构造重定向链接并将他重定向到此链接。

另一种可能性是使用服务器端会话，但我提到这只是作为 cookie 的替代品，而不是我推荐的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:14:35.813

您可以重定向到登录操作，将 Url 添加到查询字符串参数。

让我们说： `www.mysite.com/login?ReturnUrl='www.mysite.com/profiles/ID=108'`

我认为这是默认的会员提供者行为，但您可以让 ReferrerUrl 自行将其放置在查询字符串中。

# algorithm - Paxos 的真实示例

> ID：10504881
> 
> 赞同：14
> 
> 时间：2012-05-08T19:08:32.210
> 
> 标签：algorithm, distributed, paxos, consensus

有人可以给我一个真实的例子，说明 Paxos 算法是如何在分布式数据库中使用的吗？我已经阅读了很多关于 Paxos 的论文来解释该算法，但没有一篇真正用一个实际的例子来解释。

一个简单的例子可以是一个银行应用程序，其中一个帐户正在通过多个会话进行修改（即在柜员处存款、借记操作等）。Paxos 是用来决定哪个操作先发生的吗？另外，Paxos 协议的多个实例是什么意思？这个什么时候用？基本上，我试图通过一个具体的例子而不是抽象的术语来理解这一切。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:14:55.407

例如，我们有一个 MapReduce 系统，其中 master 由 3 个主机组成。一个是主人，另一个是奴隶。选择master的过程使用Paxos算法。

Google Big Table 的 Chubby 也使用 Paxos：[The Chubby Lock Service for Loosely-Coupled Distributed Systems](http://research.google.com/archive/chubby.html) , [Bigtable: A Distributed Storage System for Structured Data](http://research.google.com/archive/bigtable.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T16:53:16.970

Clustrix数据库是在事务管理器中使用 Paxos 的分布式数据库[。](http://www.clustrix.com)数据库内部使用 Paxos 来协调消息并维护分布式系统中的事务原子性。

*   Coordinator 是交易发起的节点
*   参与者是代表修改数据库的节点
*   交易阅读器是代表交易执行代码但未修改任何状态的节点
*   接受者是记录事务状态的节点。

执行事务提交时会采取以下步骤：

1.  Coordinator 向每个 Participant 发送一条 PREPARE 消息。
2.  参与者锁定事务状态。他们将 PREPARED 消息发送回 Coordinator。
3.  Coordinator 向 Acceptor 发送 ACCEPT 消息。
4.  接受者记录成员身份 ID、事务、提交 ID 和参与者。他们将 ACCEPTED 消息发送回 Coordinator。
5.  协调器告诉用户提交成功。
6.  Coordinator 向每个 Participant 和 Reader 发送 COMMIT 消息。
7.  参与者和读者提交事务并相应地更新事务状态。他们将 COMMITTED 消息发送回 Coordinator。
8.  协调器删除内部状态，现在完成。

这对应用程序是透明的，并在数据库内部实现。因此，对于您的银行应用程序，应用程序级别需要做的就是针对死锁冲突执行异常处理。大规模实现数据库的另一个关键是并发性，这通常通过 MVCC（多版本并发控制）来帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-24T21:42:10.517

> 有人可以给我一个真实的例子，说明 Paxos 算法是如何在分布式数据库中使用的吗？

MySQL[使用 Paxos](https://mysqlhighavailability.com/the-king-is-dead-long-live-the-king-our-homegrown-paxos-based-consensus/)。这就是高可用性 MySQL 设置需要三台服务器的原因。相比之下，典型的 Postgres 设置是不运行 Paxos 的主从两节点配置。

> 我已经阅读了很多关于 Paxos 的论文来解释该算法，但没有一篇真正用一个实际的例子来解释。

[这是对事务日志复制](https://simbo1905.blog/2014/10/28/transaction-log-replication-with-paxos/)的 Paxos 的相当详细的解释。[这是在 Scala](https://github.com/trex-paxos/trex)中实现它的源代码。[Paxos（又名多 Paxos）](https://simbo1905.blog/2016/01/02/paxos-uses-leaders-multi-paxos-is-paxos/)在消息方面效率最高，因为在三节点集群中，在稳定状态下，领导者接受它自己的下一个值，传输到其他两个节点，并且知道该值是固定的得到一个回应。然后它可以将提交消息（学习消息）放在它发送的下一个值的前面。

> 一个简单的例子可以是一个银行应用程序，其中一个帐户正在通过多个会话进行修改（即在柜员处存款、借记操作等）。Paxos 是用来决定哪个操作先发生的吗？

是的，如果您使用 MySQL 数据库集群来保存银行账户，那么 Paxos 将用于确保副本与主服务器就交易应用于客户银行账户的顺序达成一致。如果所有节点都同意交易的顺序，他们将持有相同的余额。

如果不提出可能违反不超过您的信用的业务规则的不同余额，则无法对银行帐户的操作进行重新排序。确保订单的简单方法是仅使用一个服务器进程，该进程仅根据接收到的消息的顺序来决定正式订单。然后它可以跟踪每个银行账户的余额并执行业务规则。但是，您不希望只有一个服务器，因为它可能会崩溃。您希望副本服务器也接收贷记和借记命令并与主​​服务器达成一致。

拥有应该保持相同余额的副本的挑战是消息可能会丢失和重新发送，并且消息被可能延迟传递一些消息的交换机缓冲。最终结果是，如果网络不稳定，很难证明快速复制协议永远不会导致不同的服务器看到消息以不同的顺序到达。您最终将在同一集群中使用不同的服务器持有不同的余额。

您不必使用 Paxos 来解决银行账户问题。你可以做简单的主从复制。你有一个master，一个或多个slave，master会等到它得到slave的确认，然后再告诉任何客户端命令的结果。那里的挑战是丢失和重新排序的消息。在 Paxos 发明之前，数据库供应商只是创建了昂贵的硬件，旨在具有非常高的冗余和可靠性以运行主从。Paxos 的革命性在于它可以与商品网络一起工作，而无需专业硬件。

由于银行应用程序可以通过昂贵的定制硬件获利，因此许多现实世界的银行系统可能仍在以这种方式运行。在这种情况下，数据库供应商为专业硬件提供内置的可靠网络，数据库软件在该网络上运行。这是非常昂贵的，不是小公司想要的。注重成本的公司可以在任何具有正常网络的公共云中的 VM 上建立 MySQL 集群，Paxos 将使其可靠，而不是使用专业硬件。

> 另外，Paxos 协议的多个实例是什么意思？这个什么时候用？

我写了一篇关于多 Paxos 是[原始 Paxos 协议](https://simbo1905.blog/2016/01/02/paxos-uses-leaders-multi-paxos-is-paxos/)的博客。简而言之，在选择集群中事务的顺序的情况下，您希望将事务作为值流进行流式传输。每个值都固定在协议的单独逻辑实例中。正如我在关于[用于集群复制的 Paxos 的](https://simbo1905.blog/2014/10/28/transaction-log-replication-with-paxos/)博客中所描述的那样，该算法在稳定状态下非常有效，只需要在主节点和足够多的节点之间进行一次往返即可获得多数，即三节点集群中的另一个节点。当出现崩溃或网络问题时，算法始终是安全的，但需要更多消息。因此，要回答您的问题，典型应用程序需要多轮 Paxos 来建立集群中客户端命令的顺序。

我应该注意到，Raft 是专门发明的，用于详细描述如何执行集群复制。最初的 Paxos 论文要求您弄清楚进行集群复制的许多细节。所以我们可以期待那些专门尝试实现集群复制的人会使用 Raft，因为它没有给实现者留下任何需要自己解决的问题。

那么什么时候可以使用 Paxos？它可用于更改基于不同协议写入值的集群的集群成员资格，只有在您知道确切的集群成员资格时才能正确。[Corfu](https://simbo1905.blog/2017/05/19/scaling-log-replication-with-corfu-part-1/)就是一个很好的例子，它通过让客户端同时写入服务器的分片来消除通过单个主机写入的瓶颈。然而，只有当所有客户端都准确了解当前集群成员和分片布局时，它才能准确地做到这一点。当节点崩溃或您需要扩展集群时，您可以提出新的集群成员资格和分片布局，并通过 Paxos 运行它以在整个集群中达成共识。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-13T08:40:37.540

`Raft`是一种旨在易于理解的共识算法。它相当于`Paxos`容错和性能。不同之处在于它被分解为相对独立的子问题，并且清晰地解决了实际系统所需的所有主要部分。`Raft`旨在比`Paxos`通过逻辑分离更易于理解，但它也被正式证明是安全的，并提供了一些附加功能。Raft 提供了一种在计算系统集群中分布状态机的通用方法，确保集群中的每个节点都同意相同的一系列状态转换

> 筏上的实际用途

`etcd`是一种强一致性，`distributed key-value store`它提供了一种可靠的方式来存储分布式系统或机器集群需要访问的数据。它在网络分区期间优雅地处理领导者选举，并且可以容忍机器故障，即使在领导者节点中也是如此。任何复杂的应用程序，从简单的 Web 应用程序到`Kubernetes`，都可以从 etcd 读取数据并将数据写入 etcd。

etcd 是用 Go 编写的，它具有出色的跨平台支持、小型二进制文件和强大的社区。etcd 机器之间的通信是通过 Raft 共识算法处理的。

# c# - C# - 非静态字段、方法或属性需要对象引用

> ID：10504882
> 
> 赞同：1
> 
> 时间：2012-05-08T19:08:40.557
> 
> 标签：c#, asp.net, inheritance, object, include

所以我有两个功能，我遇到了一个有趣的问题。本质上，我的目标是让我的代码在一个易于包含的 cs 文件中更具可移植性。

这是说cs文件：

```
namespace basicFunctions {
public partial class phpPort : System.Web.UI.Page {
    public string includer(string filename) {
        string path = Server.MapPath("./" + filename);
        string content = System.IO.File.ReadAllText(path);
        return content;
    }
    public void returnError() {
        Response.Write("<h2>An error has occurred!</h2>");
        Response.Write("<p>You have followed an incorrect link. Please double check and try again.</p>");
        Response.Write(includer("footer.html"));
        Response.End();
    }
}
} 
```

这是引用它的页面：

```
<% @Page Language="C#" Debug="true" Inherits="basicFunctions.phpPort" CodeFile="basicfunctions.cs" %>
<% @Import Namespace="System.Web.Configuration" %>

<script language="C#" runat="server">
void Page_Load(object sender,EventArgs e) {
    Response.Write(basicFunctions.phpPort.includer("header.html"));
    //irrelevant code
    if ('stuff happens') {
        basicFunctions.phpPort.returnError();
    }
    Response.Write(basicFunctions.phpPort.includer("footer.html"));
}
</script> 
```

我得到的错误是上面列出的错误，即：

```
Compiler Error Message: CS0120: An object reference is required for the non-static field, method, or property 'basicFunctions.phpPort.includer(string)' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:11:58.893

您需要一个`phpPort`类的实例，因为它和您在其上定义的所有方法都不是静态的。

由于您位于从此类*继承*`aspx`的页面上，因此在加载时它已经*是*该类的实例，您可以直接调用其上的方法。

 **您需要修改代码以直接使用这些功能：

```
void Page_Load(object sender,EventArgs e) {
    Response.Write(includer("header.html"));
    //irrelevant code
    if ('stuff happens') {
        returnError();
    }
    Response.Write(includer("footer.html"));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:12:40.253

如果要将 basicFunctions.phpPort.includer 作为静态方法调用，则需要在其上加上 static 关键字，如下所示：

```
public static void returnError
public static string includer 
```

如果您不进行静态调用，则您的基本页面需要从“this”调用

```
if ('stuff happens') {
    this.returnError();
} 
```**

# c# - DialogResult 上的应用程序关闭

> ID：10504887
> 
> 赞同：2
> 
> 时间：2012-05-08T19:09:00.473
> 
> 标签：c#, visual-studio, user-interface, messagebox, dialogresult

我有一个 C# GUI 应用程序。当用户单击红色的“X”（用于关闭应用程序）时，我想显示一条消息并询问他是否真的想关闭它。

我找到了一个解决方案：

```
 DialogResult dialog = MessageBox.Show("Do you really want to close the program?", "SomeTitle", MessageBoxButtons.YesNo);
        if (dialog == DialogResult.Yes)
        {
            Application.Exit();
        }else if (dialog == DialogResult.No)
        {
          //don't do anything
        } 
```

当用户单击“是”时，应用程序应完全终止。（Application.Exit() 是否适用于此目的？）

当用户单击“否”时，DialogResult/MessageBox 应该关闭，但应用程序应该保持打开状态。但是，它关闭了！

我怎样才能避免这种情况？

顺便说一句：我使用 Visual Studio 2010 和 Winforms。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T19:14:51.507

使用 Form 中的**FormClosing**事件和[FormClosingEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.formclosingeventargs.aspx)取消该过程。

例子：

```
 private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        DialogResult dialog = dialog = MessageBox.Show("Do you really want to close the program?", "SomeTitle", MessageBoxButtons.YesNo);
        if (dialog == DialogResult.No)
        {
            e.Cancel = true;
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T19:13:12.177

使用`FormClosing`程序窗口的窗体事件。然后，您可以设置`e.Cancel`为`true`如果用户单击*no*：

```
this.FormClosing += (s, e) => {
  DialogResult dialog = dialog = MessageBox.Show("Really close?", "SomeTitle",
    MessageBoxButtons.YesNo);
  if (dialog == DialogResult.No)
  {
    e.Cancel = true;
  }
}; 
```

我猜你正在使用`FormClosed`. 你是？那么为时已晚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:21:30.920

参考木都的回答。

基本上，除非您指定其他参数，否则您`MessageBox.Show()`无法获得除`DialogResult.Ok`默认值之外的任何结果`MessageBox`。

您发布的代码（减去您的小错字`dialog = dialog =`）完全符合我的预期。

另外：`Application.Exit()` **是**关闭应用程序的正确方法:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T19:14:44.277

尝试这个

```
 this.FormClosing += new FormClosingEventHandler(delegate(object sender, FormClosingEventArgs e)
        {
            if (MessageBox.Show("Do you really want to exit this application?", MessageBoxButtons:=MessageBoxButtons.YesNo) == DialogResult.No)
            {
                e.Cancel = true;
            }
        }); 
```

# ruby-on-rails - 更正时间戳

> ID：10504891
> 
> 赞同：0
> 
> 时间：2012-05-08T19:09:16.103
> 
> 标签：ruby-on-rails

我生成了一个脚手架。在那里我注意到 published_at 组件落后了 1 小时。该组件显示为 2012 年 5 月 8 日 13-34，而应该提前一个小时。

在 sqlite 中，published_at 时间显示为 2012-05-08 19:34:00.000000。created_at 和 up_dated_at 也关闭了。created_at: 2012-05-08 18:34:02.795241 updated_at: 2012-05-08 18:34:02.795241

我一直在寻找，但我没有找到任何可靠的解决方案。如何更正这些问题以便正确输入值？

请帮忙

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T19:17:43.440

Rails 始终将 UTC 时区存储在数据库中。每当您在应用程序中显示这些时间之一时，它们都会在显示之前相对于您的时区进行转换。也许您的时区配置不正确。

确保您已`config.time_zone`正确设置。您可以使用它`rake time:zones:local`来查找可以在配置中使用的时区值。

# php - $_ENV 、 $_SESSION 和 $_COOKIE 有什么区别

> ID：10504893
> 
> 赞同：5
> 
> 时间：2012-05-08T19:09:35.207
> 
> 标签：php, session, cookies, environment-variables

大多数情况下我使用过**$_SESSION**，但是在阅读 Session 时我得到了一些术语

**$_ENV** &

**$_COOKIE**。

我不清楚何时使用哪个，我对可以使用它们的情况感到困惑。那么这些术语有什么不同呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:10:37.687

您可以阅读： http: [//php.net/manual/en/language.variables.superglobals.php](http://php.net/manual/en/language.variables.superglobals.php)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T19:25:14.743

这三个都是超全局的，这意味着您的应用程序中的任何脚本都可以访问它，但是虽然 $_SESSION 和 $_COOKIE**对于每个用户**来说都是不同的（并且是私有的），但 $_ENV 超全局并不是特定于用户的。$_SESSION 和 $_COOKIE 之间的区别在于 $_COOKIE 可以在当前用户访问之后继续存在，而会话将在用户离开您的站点（或关闭他的浏览器）时结束。

你可以在这里找到更多关于会话的好信息[http://www.php.net/manual/en/intro.session.php](http://www.php.net/manual/en/intro.session.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T19:19:11.400

$_ENV 包含环境变量，主要包含你的服务器、路径等信息。 $_COOKIE 包含通过客户端请求传输的cookie信息

# ios - 核心图散点不可见，我做错了什么？

> ID：10504896
> 
> 赞同：1
> 
> 时间：2012-05-08T19:09:58.577
> 
> 标签：ios, xcode, core-plot

委托`numberForPlot`被正确调用，返回的值为 NSNumbers，例如 40。（Y 轴范围为 0-100 -> 百分比。）

如您在下面的屏幕截图中所见，x 轴工作正常。

![在此处输入图像描述](../Images/f15062742d15545e174468e3065e74a2.png)

**编码**

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    NSLog(@"Schedule: %@", self.schedule.name);

    self.plotData = [NSMutableArray array];
    NSSet *logs = self.schedule.logs;

    NSSortDescriptor *sortDescriptor;
    sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"dateTimeOriginal" ascending:YES];
    NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

    NSArray *sortedLogsByDate = [logs sortedArrayUsingDescriptors:sortDescriptors];

    NSDate *oldestDate = ((LogEntry *)[sortedLogsByDate objectAtIndex:0]).dateTimeOriginal;
    NSDate *newestDate = ((LogEntry *)[sortedLogsByDate lastObject]).dateTimeOriginal;

    NSLog(@"First: %@", oldestDate);
    NSLog(@"Last: %@", newestDate);

    NSInteger intervalInSeconds = 60*60*24*7; //One Week

    NSInteger oldestDateInSeconds = [oldestDate timeIntervalSince1970];
    NSInteger newestDateInSeconds = [newestDate timeIntervalSince1970];

    NSInteger numberOfWeeks = (newestDateInSeconds - oldestDateInSeconds + intervalInSeconds - 1)/intervalInSeconds; //Integer division and round up (faster then converting to floats and round()

    NSLog(@"Number of weeks: %d", numberOfWeeks);

    NSDate *previousDate = oldestDate;
    for (int i = 1; i < numberOfWeeks+1; i++) {
        NSDate *nextDate = [previousDate dateByAddingTimeInterval:i*intervalInSeconds]; //Add one week

        NSPredicate *datePredicate = [NSPredicate predicateWithFormat:@"(dateTimeOriginal >= %@) AND (dateTimeOriginal <= %@)", previousDate, nextDate];
        NSSet *logsInThisPeriod = [logs filteredSetUsingPredicate:datePredicate];

        if (logsInThisPeriod.count > 0) {
            //Get logs between previous and next date
            NSPredicate *onTimePredicate = [NSPredicate predicateWithFormat:@"status == %@", @"onTime"];
            NSSet *onTime = [logs filteredSetUsingPredicate:onTimePredicate];

            NSPredicate *postponedPredicate = [NSPredicate predicateWithFormat:@"status == %@", @"postPoned"];
            NSSet *postponed = [logs filteredSetUsingPredicate:postponedPredicate];

            NSPredicate *missedPredicate = [NSPredicate predicateWithFormat:@"status == %@", @"missed"];
            NSSet *missed = [logs filteredSetUsingPredicate:missedPredicate];

            NSInteger onTimeCount = onTime.count;
            NSInteger postponedCount = postponed.count;
            NSInteger missedCount = missed.count;
            NSInteger total = onTimeCount + postponedCount + missedCount;

            NSInteger onTimePercentage = onTimeCount*100/total;
            NSInteger postponedPercentage = postponedCount*100/total;
            NSInteger missedPercentage = missedCount*100/total;

            NSDictionary *dataPoint = [[NSDictionary alloc] initWithObjectsAndKeys:[NSNumber numberWithInteger:onTimePercentage], @"onTime", [NSNumber numberWithInteger:postponedPercentage], @"postponed", [NSNumber numberWithInteger:missedPercentage], @"missed", nextDate, @"date", nil];
            [self.plotData addObject:dataPoint];
        }
        else {
            NSMutableDictionary *previousDictionary = [[self.plotData lastObject] mutableCopy];
            [previousDictionary setObject:nextDate forKey:@"date"];
            [self.plotData addObject:previousDictionary];
        }

        previousDate = nextDate;
    }

    //Create host view
    self.hostingView = [[CPTGraphHostingView alloc] initWithFrame:[[UIScreen mainScreen]bounds]];
    [self.view addSubview:self.hostingView];

    // Create graph from theme
    graph = [(CPTXYGraph *)[CPTXYGraph alloc] initWithFrame:CGRectZero];
    CPTTheme *theme = [CPTTheme themeNamed:kCPTDarkGradientTheme];
    [graph applyTheme:theme];
    [self.hostingView setHostedGraph:self.graph];

    // Setup scatter plot space
    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;
    NSTimeInterval xLow       = 0.0f;
    plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(xLow) length:CPTDecimalFromFloat((newestDateInSeconds - oldestDateInSeconds))];
    plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(100.0)];
    plotSpace.allowsUserInteraction = YES;

    // Axes
    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)graph.axisSet;
    CPTXYAxis *x          = axisSet.xAxis;
    x.majorIntervalLength         = CPTDecimalFromFloat((float)intervalInSeconds);
    x.minorTicksPerInterval       = 0;
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    dateFormatter.dateStyle = kCFDateFormatterShortStyle;
    CPTTimeFormatter *timeFormatter = [[CPTTimeFormatter alloc] initWithDateFormatter:dateFormatter];
    timeFormatter.referenceDate = oldestDate;
    x.labelFormatter            = timeFormatter;

    CPTXYAxis *y = axisSet.yAxis;
    y.majorIntervalLength         = CPTDecimalFromString(@"10.0");
    y.minorTicksPerInterval       = 1;

    //Ontime plot
    CPTScatterPlot *onTimePlot = [[CPTScatterPlot alloc] init];
    onTimePlot.identifier = @"onTimePlot";

    CPTMutableLineStyle *onTimeLineStyle = [onTimePlot.dataLineStyle mutableCopy];
    onTimeLineStyle.lineWidth                = 3.f;
    onTimeLineStyle.lineColor                = [CPTColor greenColor];
    onTimePlot.dataLineStyle = onTimeLineStyle;

    onTimePlot.dataSource = self;
    [graph addPlot:onTimePlot];

    // Put an area gradient under the plot above
    CPTColor *areaColor = [CPTColor colorWithComponentRed:0.3 green:1.0 blue:0.3 alpha:0.3];
    CPTGradient *areaGradient = [CPTGradient gradientWithBeginningColor:areaColor endingColor:[CPTColor clearColor]];
    areaGradient.angle = -90.0f;
    CPTFill *areaGradientFill = [CPTFill fillWithGradient:areaGradient];
    onTimePlot.areaFill = areaGradientFill;
    onTimePlot.areaBaseValue = CPTDecimalFromString(@"1.75");

    //Postponed plot
    CPTScatterPlot *postponedPlot = [[CPTScatterPlot alloc] init];
    postponedPlot.identifier = @"postponedPlot";

    CPTMutableLineStyle *postponedLineStyle = [postponedPlot.dataLineStyle mutableCopy];
    postponedLineStyle.lineWidth                 = 3.f;
    postponedLineStyle.lineColor                 = [CPTColor orangeColor];
    postponedPlot.dataLineStyle = postponedLineStyle;

    postponedPlot.dataSource = self;
    [graph addPlot:postponedPlot];

    //Missed plot
    CPTScatterPlot *missedPlot = [[CPTScatterPlot alloc] init];
    missedPlot.identifier = @"missedPlot";

    CPTMutableLineStyle *missedLineStyle = [missedPlot.dataLineStyle mutableCopy];
    missedLineStyle.lineWidth                = 3.f;
    missedLineStyle.lineColor                = [CPTColor redColor];
    missedPlot.dataLineStyle = missedLineStyle;

    missedPlot.dataSource = self;
    [graph addPlot:missedPlot];
}

-(NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot
{
    return self.plotData.count;
}

-(NSNumber *)numberForPlot:(CPTPlot *)plot field:(NSUInteger)fieldEnum recordIndex:(NSUInteger)index
{
    NSDictionary *plotPoint = [self.plotData objectAtIndex:index];

    if (plot.identifier == @"onTimePlot") {
        NSNumber *onTime = [plotPoint valueForKey:@"onTime"];
        return onTime;
    }
    else if (plot.identifier == @"postponedPlot") {
        NSNumber *postponed = [plotPoint valueForKey:@"postponed"];
        return postponed;
    }
    else if (plot.identifier == @"missedPlot") {
        NSNumber *missed =  [plotPoint valueForKey:@"missed"];
        return missed;
    }
    else {
        return nil;
    }
} 
```

**更新** 这并没有改变任何事情：

```
-(NSNumber *)numberForPlot:(CPTPlot *)plot field:(NSUInteger)fieldEnum recordIndex:(NSUInteger)index
{
    NSDictionary *plotPoint = [self.plotData objectAtIndex:index];

    NSNumber *num = nil;

    // FieldEnum determines if we return an X or Y value.
    if ( fieldEnum == CPTScatterPlotFieldX )
    {
        return [NSNumber numberWithFloat:[[plotPoint valueForKey:@"date"] timeIntervalSince1970]];
    }
    else    // Y-Axis
    {
        if (plot.identifier == @"onTimePlot") {
            num = [plotPoint valueForKey:@"onTime"];
        }
        else if (plot.identifier == @"postponedPlot") {
            num = [plotPoint valueForKey:@"postponed"];
        }
        else if (plot.identifier == @"missedPlot") {
            num =  [plotPoint valueForKey:@"missed"];
        }

        return [NSNumber numberWithFloat:[num floatValue]];
    }
} 
```

Bonusquestion：如何使轴标签静态并让绘图区域可滚动？如何更改 y 轴标签的“视口”？（我希望在启动时可见 0-100，现在是 20-80 或类似的东西......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:54:00.730

我认为你在 numberForPlot:field:recordIndex 中需要这样的东西：

```
if (plot.identifier == @"onTimePlot")
{
    // FieldEnum determines if we return an X or Y value.
    if ( fieldEnum == CPTScatterPlotFieldX )
    {
        return [NSNumber numberWithFloat:point.x];
    }
    else    // Y-Axis
    {
        return [NSNumber numberWithFloat:point.y];
    }
} 
```

您必须通过该方法返回一次 X 值，下一次返回 Y 值。

# c4 - 我正在尝试获取 C4 图像的像素颜色，如何访问图像颜色矩阵？c4框架

> ID：10504897
> 
> 赞同：4
> 
> 时间：2012-05-08T19:09:59.903
> 
> 标签：c4

在颜色 colorMatrix:bias 的讨论中，它写道：

> 该过滤器执行矩阵乘法，如下所示，以变换颜色向量：
> 
> sr = dot(s, redVector) sg = dot(s, greenVector) sb = dot(s, blueVector) sa = dot(s, alphaVector) s = s + bias

有什么方法可以访问各种颜色向量的数据值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:05:22.310

您在 C4 文档中所指的讨论是指过滤器用于计算矩阵乘法的过程。这实际上只是对过滤器在应用时对图像中的颜色所做的操作的描述。

实际上，幕后发生的事情是该`colorMatrix:`方法设置了一个`CIFilter`被调用`CIColorMatrix`并将其应用于`C4Image`. `CIColorMatrix`不幸的是，Apple 没有提供过滤器的源代码。

因此，对您的问题的冗长回答是：

您无法`C4Image`通过`CIColorMatrix`过滤器访问 a 中像素的颜色分量。但是，`C4Image`该类有一个名为`CGImage`(eg `yourC4Image.CGImage`) 的属性，您可以使用它来获取像素数据。

可以在[这里找到一个好的、简单的技术](https://stackoverflow.com/a/448758/1218605)

编辑：我昨晚对这个问题很着迷，并将这两种方法添加到 C4Image 类中：

加载像素数据的方法：

```
-(void)loadPixelData {
    NSUInteger width = CGImageGetWidth(self.CGImage);
    NSUInteger height = CGImageGetHeight(self.CGImage);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    bytesPerPixel = 4;
    bytesPerRow = bytesPerPixel * width;
    rawData = malloc(height * bytesPerRow);

    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height, bitsPerComponent, bytesPerRow, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);
    CGContextDrawImage(context, CGRectMake(0, 0, width, height), self.CGImage);
    CGContextRelease(context);
} 
```

还有一种访问像素颜色的方法：

```
-(UIColor *)colorAt:(CGPoint)point {
    if(rawData == nil) {
        [self loadPixelData];
    }
    NSUInteger byteIndex = bytesPerPixel * point.x + bytesPerRow * point.y;
    CGFloat r, g, b, a;
    r = rawData[byteIndex];
    g = rawData[byteIndex + 1];
    b = rawData[byteIndex + 2];
    a = rawData[byteIndex + 3];

    return [UIColor colorWithRed:RGBToFloat(r) green:RGBToFloat(g) blue:RGBToFloat(b) alpha:RGBToFloat(a)];
} 
```

这就是我将如何应用我提到的另一篇文章中的技术。

# c++ - 我如何获得 xcode 分析工具来显示 c++ 对象

> ID：10504898
> 
> 赞同：2
> 
> 时间：2012-05-08T19:10:06.860
> 
> 标签：c++, xcode, profiling, instruments

我目前正在开始用 xcode 为 ios 编写游戏。出于可移植性的原因，我想用 C++ 编写主游戏引擎。

当我分析应用程序时，我的问题就开始了。Xcode Instruments 是一组很棒的分析工具，但是由于我的大部分对象是 c++ 而不是 Objective-C，因此几乎不可能使用分配工具，因为这些对象都以 < non-object > 的形式出现。

我注意到有一个名为“识别 c++ 对象”的复选框，但它似乎可以做任何事情..

会很高兴知道你们在编写 c++ iphone 应用程序时如何描述您的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T18:45:32.000

当您使用 Allocations 工具时，Instruments 最初会显示内存分配统计信息。统计数据告诉您您的应用程序正在使用多少内存。在了解了您的应用程序使用了多少内存之后，您很可能想知道分配内存的代码区域以及它们分配了多少内存。切换到调用树视图（您可以从跳转栏执行此操作）可以更轻松地确定您在代码中分配内存的位置。以下文章提供了更多详细信息：

[Instruments：查找分配内存的位置](http://meandmark.com/blog/2011/12/instruments-finding-where-you-allocate-memory/)

# ios - 应用程序的新版本及其推送通知

> ID：10504904
> 
> 赞同：0
> 
> 时间：2012-05-08T19:10:21.337
> 
> 标签：ios, apple-push-notifications

我即将上传我的应用程序，但上传者抱怨捆绑版本，它说它应该是比前一个更高的版本。

问题是我的应用程序使用推送通知，所以当我创建应用程序 ID 以获取通知时，我输入了我的应用程序的捆绑版本，从那里我创建了分发配置文件，然后到 xcode 对它们进行签名。.p12 也存储在我的服务器中，以便 Apple 验证我的通知是否正常。因此，如果我做对了，每次我更新我的应用程序时，我都必须重新执行整个过程，并保留旧的 .p12 以便使用旧版本应用程序的用户仍会收到通知？这是正确的吗？

所有这些官僚主义让我发疯，也许我不太了解它。所以请帮我一把。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T20:21:44.347

在您的 info.plist 中检查捆绑包版本是否与 iTunes Connect 中的新应用程序版本相同

# facebook - 订阅插件不起作用

> ID：10504905
> 
> 赞同：0
> 
> 时间：2012-05-08T19:10:23.563
> 
> 标签：facebook, plugins, subscribe

所以我有一个网站，我想在其中放置订阅按钮，这是代码

```
<!--FB SUBSCRIBE!-->
<div class="fb-subscribe" data-href="http://www.facebook.com/Entendu.info" data-layout="box_count" data-show-faces="true" data-font="arial" data-width="50"></div> 
```

但是当我访问网页（www.entendu.info/moderate）时，在右侧的订阅按钮应该放在鞋子上时，我得到了：错误，当我点击它时：

> 该`href`参数必须引用有效的 Facebook 用户配置文件，但“http://www.facebook.com/Entendu.info”不是有效的 Facebook 用户配置文件。 [错误的链接](https://www.facebook.com/plugins/error/api?code=3701&message=The%20%60href%60%20parameter%20must%20reference%20a%20valid%20Facebook%20user%20profile,%20but%20%22http://www.facebook.com/Entendu.info%22%20is%20not%20a%20valid%20Facebook%20user%20profile.&hash=AQCw4k1BLi8FBUTQ)

但问题是我的网址完全有效！ [https://www.facebook.com/Entendu.info](https://www.facebook.com/Entendu.info)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:15:46.497

那么答案就在错误本身 -

> href 参数必须引用有效的 Facebook**用户配置文件**，但“http://www.facebook.com/Entendu.info”不是有效的 Facebook 用户配置文件。

您必须使用有效的**用户**配置文件，而不是页面的 URL。

一个人不能订阅一个页面，就像一个人不能*喜欢*一个人一样。

如果您想将粉丝添加到页面，您应该在您的应用中使用“赞”按钮或“赞”框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T13:13:21.383

PAGES 和 USERS 有不同的 facebook 嵌入代码

订阅粉丝专页（通常是 cocacola、nike 等组织，我用它来参与参与）

[http://developers.facebook.com/docs/reference/plugins/like-box/](http://developers.facebook.com/docs/reference/plugins/like-box/)

订阅用户

[http://developers.facebook.com/docs/reference/plugins/subscribe/](http://developers.facebook.com/docs/reference/plugins/subscribe/)

all the other social plugins are here (just read the description carefully):

[http://developers.facebook.com/docs/plugins/](http://developers.facebook.com/docs/plugins/)

# android - 是否有 facebook api 用于查找通过我的应用注册的所有用户

> ID：10504910
> 
> 赞同：2
> 
> 时间：2012-05-08T19:10:39.137
> 
> 标签：android, facebook

我在 android 中编写了一个应用程序，我想知道指定用户通过我的应用程序提交的他的 facebook 朋友列表是什么。喜欢画一些东西的清单。
有那个api吗？我该如何使用它？我知道如何获取朋友的 ID、照片、姓名......但我只想要使用我的应用程序的朋友。

```
Bundle bundle = new Bundle();    
bundle.putString("fields", "name, picture");
String response = facebook.request("me/friends", bundle); 
```

任何人都可以帮助我吗？我将非常感激。谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:18:22.793

很简单，只需将“已安装”字段添加到您的查询中：

```
Bundle bundle = new Bundle();    
bundle.putString("fields", "name, picture, installed");
String response = facebook.request("me/friends", bundle); 
```

如果用户安装了您的应用，您将拥有：

```
{
    "installed": true, 
    "id": "USER_ID",
    "name": "USER_NAME",
    "picture": "USER_PIC_URL"
} 
```

否则：

```
{
    "id": "USER_ID",
    "name": "USER_NAME",
    "picture": "USER_PIC_URL"
} 
```

# python - Django“全局登录”中间件导致重复的 GET 请求

> ID：10504911
> 
> 赞同：0
> 
> 时间：2012-05-08T19:10:43.550
> 
> 标签：python, django, middleware

我有一个 Django 网站，要求用户登录才能查看任何页面。我根据[此页面](http://webcache.googleusercontent.com/search?q=cache%3ahMQ1XNLtAxsJ%3aonecreativeblog.com/post/59051248/django-login-required-middleware%20&cd=1&hl=en&ct=clnk&gl=us)上的说明添加了一些中间件。中间件确实按预期将用户重定向到登录页面，但是每次都重复 GET 请求。为什么请求发送两次？（或者可能两次输出到 Django 控制台？）这是导航到 Django 控制台后的输出`127.0.0.1/reservations/`：

```
[08/May/2012 15:08:41] "GET /reservations/ HTTP/1.1" 302 0
[08/May/2012 15:08:42] "GET /login/ HTTP/1.1" 200 575
[08/May/2012 15:08:42] "GET /login/ HTTP/1.1" 200 575 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:11:13.930

我遇到了同样的问题，这是我使用的一个 Firefox 扩展，导致了这个奇怪的问题。尝试使用其他浏览器查看问题是否消失。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:20:01.240

Firefox 上的 Yslow 扩展导致我的开发系统出现此错误。

# tomcat - 如何在两个同时的 tomcat 实例上设置远程调试？

> ID：10504912
> 
> 赞同：1
> 
> 时间：2012-05-08T19:10:44.700
> 
> 标签：tomcat

在过去的几周里，我一直在调试两个 tomcat 服务器的交互问题。每个 tomcat 服务器运行一个单独的应用程序，具有自己的代码库，并通过 Web 服务相互交互。通常，我在单独的服务器上运行每个应用程序，并在一个服务器上更改端口，以免它们发生冲突。

当然，调试时这里有一个非常令人头疼的问题。我只知道如何使用以下命令以调试模式启动 Tomcat：

```
 catalina.sh jpda start 
```

我运行此命令的服务器将在端口 8000 处打开一个调试端口，但如果我在调试模式下启动这两个端口，则端口会发生冲突。因此，在调试时，我总是将两者都关闭以在正常模式下启动一个，在调试中启动一个，然后在我通过线路跟踪问题时再次反转它们。只需在不同端口上以调试模式启动它们，并根据需要将调试器连接到每个端口，这将节省大量时间。

有没有一种简单的方法可以告诉 Tomcat 服务器在 8000 以外的端口上运行其调试端口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:12:20.347

将以下内容放入

```
$CATALINA_BASE/setenv.sh 
```

（如果文件不存在则创建并添加以下内容）。

```
JPDA_ADDRESS=8001;export JPDA_ADDRESS 
```

# backbone.js - 简单的自指关系模型失败

> ID：10504913
> 
> 赞同：2
> 
> 时间：2012-05-08T19:10:48.523
> 
> 标签：backbone.js, backbone-relational

我正在评估用于建模树的 Backbone-Relational 插件。我有以下示例代码

```
var SurveyTreeNode = Backbone.RelationalModel.extend({
    relations: [{
        type: Backbone.HasMany,
        key: 'questions',
        relatedModel: 'SurveyTreeNode'
    }]
});

var survey = {
    id: 1,
    questions: [
        { 
            id: 2, 
            text: 'What is your name?' 
        },
        { 
            id: 3, 
            text: 'What hours do you work?', 
            questions: [
                {
                    id: 3,
                    text: 'On Monday?'
                },
                {
                    id: 4,
                    text: 'On Tuesday?'
                }
            ]                
        }
    ]
};

var questionTree = new SurveyTreeNode(survey); 
```

产生（在 Google Chrome 控制台中）：

```
no model, key or relatedModel (function (){ parent.apply(this, arguments); }, "questions", undefined) 
```

我已将此代码加载到 jsfiddle 中，因为错误没有完全如上显示（显示可以扩展的*子元素）：http:* [//jsfiddle.net/hoffmanc/XsDQu/](http://jsfiddle.net/hoffmanc/XsDQu/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T20:32:24.940

Backbone Relational 期望能够在相关模型属性中给出的路径上找到全局范围内相关模型的构造函数。

问题是它没有找到 SurveyTreeNode 的构造函数

我不确定您是如何在本地环境中执行上述代码的，或者不确定 jsFiddle 究竟做了什么来包装代码（可能将其包装在一些 DOMReady 事件中），但在这两种情况下，SurveyTreeNode 都不在全局范围内。

如果您删除`var`SurveyTreeNode 之前的关键字，它将在全局范围内可用，并且后续代码可以正常工作。

看到这个jsFiddle：http: [//jsfiddle.net/edwardmsmith/qTA83/](http://jsfiddle.net/edwardmsmith/qTA83/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T12:18:42.653

如果您不想污染全局命名空间，另一种解决方法：

```
var MenuNode = function () {
    Backbone.RelationalModel.apply(this, arguments);
};
MenuNode = Backbone.RelationalModel.extend({
    constructor: MenuNode,
    relations: [
        {
            type: Backbone.HasMany,
            key: "children",
            relatedModel: MenuNode,
            reverseRelation: {
                key: "parent"
            }
        }
    ]
}); 
```

我建议添加一个 Backbone.selfRelated（或类似的）标志以避免像这样的黑客攻击。[https://github.com/PaulUithol/Backbone-relational/issues/347](https://github.com/PaulUithol/Backbone-relational/issues/347)

# bash - 在 bash 我如何使用 ls 列出单个文件夹

> ID：10504916
> 
> 赞同：10
> 
> 时间：2012-05-08T19:10:52.343
> 
> 标签：bash, ls

我经常使用`ls`（长格式：）`ll`列出单个文件，只是为了查看属性。如何在*不*扩展内容的情况下列出单个文件夹。

**例子**

```
hpek@melda:~/temp/test$ ls
file.txt folder
hpek@melda:~/temp/test$ ls file.txt 
file.txt
hpek@melda:~/temp/test$ ls folder/
content.txt
hpek@melda:~/temp/test$ ls folder
content.txt
hpek@melda:~/temp/test$ 
```

**编辑：**

答案很清楚地写在`man ls`：使用`-d`选项。但为什么`ls folder`不工作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T19:11:45.567

> 如何在不扩展内容的情况下列出单个文件夹。

尝试通过`-d`开关。

```
cnicutar@lemon:~$ ls -ld /etc
drwxr-xr-x 144 root root 12288 May  8 18:50 /etc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:22:49.290

要查看文件夹的属性，请使用`--directory`标志。

```
$ ls -lad /etc
drwxr-xr-x 191 root root 12288 2012-05-08 13:07 /etc 
```

-a 标志并不是真正必要的，但它不会造成伤害，并且通过拼写一个单词使命令对我来说更具助记性。这种事情对于记住某些调用非常有帮助。

# excel - 将两个列表合二为一，并显示重复项

> ID：10504920
> 
> 赞同：0
> 
> 时间：2012-05-08T19:11:04.550
> 
> 标签：excel

我知道可以引用列表并显示答案，但是是否可以使用重复项并显示所述重复项？

附件是一个文件，我需要做的就是参考 ID，并显示所述重复项及其所在位置。

我可以使用这样的东西：

```
=IFERROR(INDEX('Jobs List'!$F:$F,MATCH(1,INDEX(('Jobs List'!$B:$B=$AG$3)*('Jobs List'!$B:$B=$AG$3),0),0)),IFERROR(INDEX(Archive!$F:$F,MATCH(1,INDEX((Archive!$B:$B=$AG$3)*(Archive!$B:$B=$AG$3),0),0)),"")) 
```

但问题是它应该只显示第一个副本而忽略其余部分。

我知道这是可能的，我只是没有这样做的技能。如果有人可以帮助它不胜感激。

[http://dl.dropbox.com/u/3327208/Excel/Multiple%20answers%20one%20chart.xlsx](http://dl.dropbox.com/u/3327208/Excel/Multiple%20answers%20one%20chart.xlsx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T09:59:41.863

公式将是：

B7（数组）：**=IFERROR(INDEX($G$4:$G$7, SMALL(IF($H$4:$H$7=$C$2, ROW($G$4:$G$7)-3, "") , ROW(A1))), 索引($J$4:$J$7, 小(IF($K$4:$K$7=$C$2, ROW($J$4:$J$7)-3, "") , ROW(A1)-COUNTIF($H$4:$H$7, $C$2))))**

C7: **=IF(B7="", "", $C$2)**

D7：**=IF(B7="","",IF(ROW(A1)>COUNTIF($H$4:$H$7,$C$2),$J$2,$G$2))**

向下复制这 3 个单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T13:02:36.453

好的，在一些帮助下解决了它......还有一个旧脚本：

**B7**：`=IFERROR(INDEX(F$8:F$11,MATCH(ROWS(B$7:B7),$H$8:$H$11,0)),IFERROR(INDEX(J$8:J$11,MATCH(ROWS(B$7:B7),$L$8:$L$11,0)),""))`

**C7**`=IF(B7="","",$C$2)`

**F7**`=IF(ISNUMBER(MATCH(ROWS(D$7:D7),$H$8:$H$11,0)),$F$6,IF(ISNUMBER(MATCH(ROWS(D$7:D7),$L$8:$L$11,0)),$J$6,""))`

拖累。这行得通。我在论坛上得到了一些帮助，但杰里的回应也有帮助。再次感谢。:)

# arrays - AS3棋盘游戏如何画15x15方板

> ID：10504922
> 
> 赞同：-3
> 
> 时间：2012-05-08T19:11:07.947
> 
> 标签：arrays, actionscript-3

我正在为 Uni 项目在 AS3 中创建棋盘游戏。我想知道是否有人可以告诉我在舞台上创建 15x15 方格板的最佳方法？我希望能够在方块上添加鼠标悬停效果。此外，当玩家点击棋盘时，他们的计数器将放置在该方格上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:59:51.267

这是一个非常基本的问题。二维板 = 您将需要使用两个环，一个内环。

```
var myArrayOfTiles:Array = new Array();

var distanceX:Number = 0;
var distanceY:Number = 0;
for(var i:Number = 0; i < 15; i++) {
    myArrayOfTiles[i] = new Array();
    for(var j:Number = 0; j < 15; j++) {
        myArrayOfTiles[i][j] = new mySquare();
        myArrayOfTiles[i][j].x = distanceX;
        myArrayOfTiles[i][j].y = distanceY;
        distanceX += myArrayOfTiles[i][j].width;
    }
    distanceX = 0;
    distanceY += myArrayOfTiles[i][j].height;
} 
```

这样，您将定位瓷砖和二维数组，您可以在其中访问它们。您可以在创建侦听器后添加侦听器。

**编辑：** Flash 专业版：

```
var myArrayOfTiles:Array = [];

var distanceX:Number = 0;
var distanceY:Number = 0;
for(var i:Number = 0; i < 15; i++) {
    myArrayOfTiles[i] = new Array();
    for(var j:Number = 0; j < 15; j++) {
    var mySquare:Symbol1 = new Symbol1();
        addChild(mySquare);
        myArrayOfTiles[i][j] = mySquare;
        myArrayOfTiles[i][j].x = distanceX;
        myArrayOfTiles[i][j].y = distanceY;
        distanceX += mySquare.width + 1;
    }
    distanceX = 0;
    distanceY += mySquare.height + 1;
} 
```

这应该适用于 FP，我检查了这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T09:54:09.633

您的错误可能是因为您没有使用正确的语法来创建变量。它应该是：

```
var mySquare:BoardTile = new BoardTile(); 
```

此外，您可以在创建板时直接添加 mouseEventListener，以及使图块对鼠标做出反应，就像它们是按钮一样。你这样做：

```
var myArrayOfTiles:Array = [];

var distanceX:Number = 0;
var distanceY:Number = 0;
for(var i:Number = 0; i < 15; i++) {
    myArrayOfTiles[i] = new Array();
    for(var j:Number = 0; j < 15; j++) {
    var mySquare:Symbol1 = new Symbol1();
        mySquare.addEventListener(MouseEvent.CLICK, fnClick); //adding the eventlistener
        mySquare.buttonMode = true; //now the cursor changes when you mouse over the square, to indicate you can interact with it
        addChild(mySquare);
        myArrayOfTiles[i][j] = mySquare;
        myArrayOfTiles[i][j].x = distanceX;
        myArrayOfTiles[i][j].y = distanceY;
        distanceX += mySquare.width + 1;
    }
    distanceX = 0;
    distanceY += mySquare.height + 1;
} 
```

# html - IE 8“alt”标签在鼠标悬停时不会呈现？

> ID：10504924
> 
> 赞同：0
> 
> 时间：2012-05-08T19:11:25.137
> 
> 标签：html, internet-explorer, internet-explorer-8

行。我有一个字段集菜单。如果我对最后一项进行硬编码，则 alt 有效：

```
<td>
                        <a href="show.hotpartslist?clearFilters=true">
                            <img class="icon" title="Clear All Filters" alt="Clear All Filters" src="../images/clear_all.gif"/>
                        </a>
                    </td> 
```

但是这个是用一些逻辑构建的，它呈现如下：

```
<td>
                        <ul id="hp-sor-menu" style="display:none;"><li><img alt="Filter by Source of Repair" src="../images/sor.gif" /><ul><li><a href="show.hotpartslist?sor=ALL">&#8594;&nbsp;&nbsp;ALL</a></li><li><a href="show.hotpartslist?sor=A">&nbsp;&nbsp;&nbsp;MCA</a></li><li><a href="show.hotpartslist?sor=B">&nbsp;&nbsp;&nbsp;MCB</a></li><li><a href="show.hotpartslist?sor=E">&nbsp;&nbsp;&nbsp;BIC</a></li><li><a href="show.hotpartslist?sor=O">&nbsp;&nbsp;&nbsp;OTHER</a></li></ul></li></ul><script type="text/javascript"> 
$(function()
{
    try
    {

        DynarchMenu.setup('hp-sor-menu', {  });

    }
    catch(exception)
    {
        alert("Failed to render other menu: " + exception.description);
    }
}); 
```

并且鼠标悬停时不显示alt

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:13:56.827

它是导致鼠标悬停效果的标题属性。您没有填充该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:15:19.223

您需要设置`title`属性`mouseover`以显示工具提示。该`alt`标签仅用于在图像未加载时显示文本，尽管 SEO 公司经常使用它来提高页面排名。

# algorithm - 以 DD/MM HH:MM:SS 格式仅使用数字 0-9 查找最早日期一次

> ID：10504932
> 
> 赞同：2
> 
> 时间：2012-05-08T19:11:53.507
> 
> 标签：algorithm, date

需要一种算法来仅使用数字 0-9 以 DD/MM HH:MM:SS 格式查找最早的日期。实际答案是：26/03 17:48:59

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:20:51.897

最简单的方法 - 生成 [0...9] 的所有排列并检查它们是否是有效日期。

10！= 3 628 800

如果你想提高效率，回溯会有所帮助。在这种情况下，它只是一个简单的约束满足问题，有效日期的数量远少于排列的数量。此外，您可以按最低月份、最低日等顺序考虑它们。

例如

01 不起作用，因为时间的第一个数字（10 小时）需要为 0 或 1 02 不起作用，因为时间的第一个数字现在必须为 1，日期只能是 0,1,2 in二月。

等等。

FWIW - 只有 769 个有效日期

```
import datetime
import itertools

count = 1
for perm in itertools.permutations( range(10) ):

    i = 0;
    day = perm[i]+perm[i+1]*10
    i+=2
    month = perm[i]+perm[i+1]*10
    i+=2
    hour =  perm[i]+perm[i+1]*10
    i+=2
    minute =  perm[i]+perm[i+1]*10
    i+=2
    second =  perm[i]+perm[i+1]*10
    try:
        print datetime.datetime( 2012, month, day, hour, minute, second)
        count+=1
    except:
        pass

print count 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T13:33:33.083

这是一个[约束满足问题](http://en.wikipedia.org/wiki/Constraint_satisfaction_problem)。您可能希望先使用日期格式 MM/DD HH:MM:SS，然后再转换您的答案。在这种格式中，字典上最小的有效日期字符串将是您寻找的答案，因此如果您系统地搜索，您找到的第一个有效日期将是解决方案。

本质上，您的搜索空间有 12 x 31 x 24 x 60 x 60 的大部分有效日期。因此，您的约束包括：

```
month < 13
day   < 32
hour  < 24
minutes < 60
seconds < 60
occurrence(date, i) == 1 for each i = 0 to 9 
```

然后，您可以使用[回溯搜索算法](http://en.wikipedia.org/wiki/Backtracking)系统地在搜索空间中进行。

# caching - 在提交之前不会通过查询检索持久化实体

> ID：10504934
> 
> 赞同：0
> 
> 时间：2012-05-08T19:11:57.490
> 
> 标签：caching, jpa, ejb

我正在使用带有扩展持久性上下文的有状态会话 bean，以及以下 @TransactionAttribute 设置：

```
@Stateful(...)
@TransactionAttribute(TransactionAttributeType.NOT_SUPPORTED)
public class StatefulExtendedEJBBea {
    @PersistenceContext(unitName = "JPAModel", type = PersistenceContextType.EXTENDED)
    private EntityManager em;

    ...

    /**
     * With the REQUIRED txn attribute, we can ensure that each time
     * this method is called a new transaction is created and any
     * pending changes in the persistence context are committed.
     */
    @TransactionAttribute(TransactionAttributeType.REQUIRED)
    public void commitTransaction() {
    }

    /** <code>select o from Departments o</code> */
    public List<Departments> getDepartmentsFindAll() {
        return em.createNamedQuery("Departments.findAll").getResultList();
    }

    public <T> T persistEntity(T entity) {
        em.persist(entity);
        return entity;
    }
 } 
```

在此示例中需要指出的一些重要事项：

1.  由于 bean 级别的 @TransactionAttribute(NOT_SUPPORTED) 设置，调用 persistEntity() 方法时不会开始 txn。
2.  一个 txn 仅在调用 commitTransaction() 方法时才开始和完成，因为它被注释为 @TransactionAttribute(REQUIRED)。

这种方法允许持久化新实体（以及它们的 ID 由 JPA 生成和自动分配，使用 @GeneratedValue），而无需 JPA 在数据库中急切地发出 INSERT stmt。因此，我可以在分配任何属性值之前立即保留实体，因为 NOT NULL 列约束尚未验证。只有在调用 commitTransaction() 方法时，JPA 才会执行 INSERT stmt 并执行 COMMIT。

现在，这似乎正如我预期的那样奏效，并具有上面列出的好处。我遇到的问题是，在调用 commitTransaction() 之前，我无法通过 JPQL 查询检索新持久的实体。新持久化的实体似乎由持久化上下文管理，因为我可以在调用persistEntity() 后继续更新它们，并且当我调用commitTransaction() 时，所有后续更改都会正确保存到数据库中。但是，在我发出提交之前，它们似乎并不在查询缓存中。

我猜我在提交时间之前抑制 txn 的策略正在以某种方式影响查询结果。

是否有查询提示可用于强制持久化（在事务之外）但未提交的实体包含在 JPQL 查询中？

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T15:01:26.227

您可以调用 flush() 在提交之前将更改写入数据库。

见，[http ://en.wikibooks.org/wiki/Java_Persistence/Persisting#Flush](http://en.wikibooks.org/wiki/Java_Persistence/Persisting#Flush)

EntityManager 上还有一个刷新模式，它将在每次查询之前触发刷新，默认为自动，所以很奇怪你看不到新对象。也许您正在为查询使用不同的事务？在这种情况下，不同的事务将永远不会看到另一个事务的未提交更改，即事务的那种点。

# java - Eclipse IDE 中的 Java 手册或参考

> ID：10504936
> 
> 赞同：0
> 
> 时间：2012-05-08T19:11:59.277
> 
> 标签：java, eclipse

有没有办法在 Eclipse IDE 中显示 javaSE 手册或参考？例如查找“列表对象”文档。在某些 IDE 中，可以选择一个单词并按 F1。我认为它被称为Javadoc。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T19:31:35.413

不确定这是否是您要查找的内容，但是如果您将鼠标悬停在 eclipse 中的标识符上，它会在窗口中为您提供 javadocs（看起来像一个工具提示。）您可以转到您的首选项/Java/Editor/Hovers 和调整悬停时要显示的内容，甚至可以根据需要使用键修饰符。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:46:33.707

如果您已附加 JDK 的源代码，则在编辑器中按 F2 将打开一个工具提示，其中包含光标下的方法或类的 javadoc，而按 F3 将带您进入该元素的源代码。

如果您将 JDK 添加到构建路径（JRE 可能不包含源代码），则会自动附加源代码。如果我没记错的话，如果您没有源代码，按 F3 会提示您输入源代码的位置（对于 JDK，它位于 src.zip 中）。

# jquery - 使用 jQuery 和 .NET Framework 4 访问 HiddenField 值

> ID：10504940
> 
> 赞同：0
> 
> 时间：2012-05-08T19:12:07.647
> 
> 标签：jquery, .net, visual-studio-2010

我很难访问一些动态创建的包含图像、标签和隐藏字段的控件的值。

这就是我正在做的事情：

```
HTML
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="ReportIcon.ascx.cs" Inherits="ReportIcon" %>
<div class="report-icons" style="background:white; color:#014886; border-radius:5px 10px 5px 10px / 10px 5px 10px 5px; width:255px; position:relative; text-align:Left; visibility:visible; padding:5px; margin:5px; overflow: hidden">
    <asp:Image ID="PDFImage" runat="server" ImageUrl="~/Images/pdfIcon.png"/> 
    <div style="position:absolute; left:64px; top:27px; max-width:196px; overflow: auto">              
        <asp:Label ID="ReportNameLabel" style="font-size:12pt; padding-left:15px" runat="server" Text="Report"></asp:Label>
        <br />            
        <asp:HiddenField ID="FilePathHiddenField" runat="server" />
    </div>
</div>

Code Behind
public partial class ReportIcon : System.Web.UI.UserControl
{
    public string reportName { get; set; }
    public string filePath { get; set; }

    protected void Page_Load(object sender, EventArgs e)
    {
        ReportNameLabel.Text = this.reportName;
        FilePathHiddenField.Value = this.filePath;
    }
}

JQuery
function setupMouseEvents() {
    $('.report-icons').hover(
        function () { $(this).css({ 'background': '#B8B8B8' }) },
        function () { $(this).css({'background': 'white' })}
    );

    $('.report-icons').click(
        function () {
            $(this).siblings().removeClass("selected");
            $(this).addClass("selected");
            alert($('#<%=FilePathHiddenField.ClientID%>').val());
        }
    );
};

function init() {
    setupMouseEvents();
};

$(document).ready(function () {
    init();
}); 
```

我认为问题在于我的 html 包含在内容占位符中，因为我正在使用母版页。

当我在浏览器中查看 HTML 时，隐藏字段的 ID 为： ContentPlaceHolder1_ReportListView_ctl00_FilePathHiddenField ContentPlaceHolder1_ReportListView_ctl01_FilePathHiddenField ContentPlaceHolder1_ReportListView_ctl02_FilePathHiddenField ContentPlaceHolder1_ReportListView_ctl03_FilePathHiddenField

任何人都知道如何在 jQuery 中访问这些属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:14:44.267

您需要为 jquery 的 id 选择器添加 # 符号

```
 alert($('#' + '<%=FilePathHiddenField.ClientID%>').val()); 
```

或者

```
 var id = '<%=FilePathHiddenField.ClientID%>';
 alert($('#' + id).val()); 
```

## 对于 Asp.net 4.0

如果您使用的是 Asp.net 4.0 版本，请查看以下内容：[ASP.NET 4.0 Client ID Feature](http://www.codeproject.com/Articles/34151/ASP-NET-4-0-Client-ID-Feature)

**Control.ClientIDMode 属性**- 获取或设置用于生成 ClientID 属性值的算法。

**AutoID** ClientID 值是通过将每个父命名容器的 ID 值与控件的 ID 值连接起来生成的。在呈现控件的多个实例的数据绑定方案中，将在控件的 ID 值前面插入一个递增值。每个段由下划线字符 (_) 分隔。此算法在早于 ASP.NET 4 的 ASP.NET 版本中使用。

**静态** ClientID 值设置为 ID 属性的值。如果控件是命名容器，则该控件用作它所包含的任何控件的命名容器层次结构的顶部。

**可预测** 此算法用于数据绑定控件中的控件。ClientID 值是通过将父命名容器的 ClientID 值与控件的 ID 值连接起来生成的。如果控件是生成多行的数据绑定控件，则在末尾添加 ClientIDRowSuffix 属性中指定的数据字段的值。对于 GridView 控件，可以指定多个数据字段。如果 ClientIDRowSuffix 属性为空，则在末尾添加序号，而不是数据字段值。这个数字从零开始，每行加 1。每个段由下划线字符 (_) 分隔。

**Inherit** 控件继承其 NamingContainer 控件的 ClientIDMode 设置。

# javascript - JavaScript 异常：未捕获的 TypeError：将循环结构转换为 JSON

> ID：10504945
> 
> 赞同：6
> 
> 时间：2012-05-08T19:12:17.340
> 
> 标签：javascript, json

我有 JSON 对象：

```
[#1={id:"2012-05-04", title:"Scheduled", start:(new Date(1336096800000)), source:{events:[#1#], className:[]}, _id:"2012-05-04", _start:(new Date(1336089600000)), end:null, _end:null, allDay:true, className:[]}] 
```

我尝试对其进行字符串化：

```
var test = JSON.stringify(resourceVacation, censor(resourceVacation));

function censor(censor) {
    return (function() {
        var i = 0;
        return function(key, value) {
            if (i !== 0 && typeof(censor) === 'object' && typeof(value) == 'object' && censor == value)
                return '[Circular]';

            ++i; // so we know we aren't using the original object anymore

            return value;
        }
    })(censor);
} 
```

我使用这里提到的审查器：[Chrome sendrequest error: TypeError: Converting circular structure to JSON](https://stackoverflow.com/questions/4816099/chrome-sendrequest-error-typeerror-converting-circular-structure-to-jso) n

但是我在浏览器上得到以下异常：

> 未捕获的 TypeError：将循环结构转换为 JSON

这是 Java Script 对象： ![在此处输入图像描述](../Images/015c74b4b286aea7121a2fd0ede9f524.png)

我在 Mozilla 浏览器中使用 toSource() 获得了之前的 JSON 对象。任何想法如何解决它！

=============================更新===================== ===

实际上，我需要从一开始就与您分享 scnerio： 1 -最初：我有一个表单，最后我构建了 java 脚本对象，它是：

```
#1=[{id:"2012-05-03", title:"Scheduled", start:(new Date(1336010400000)), source:{events:#1#, className:[]}, _id:"2012-05-03", _start:(new Date(1336003200000)), end:null, _end:null, allDay:true, className:[]}] 
```

**该对象通常是字符串化的……请注意，对于稍后会触发异常的对象来说，它是典型的**。

2-然后我使用以下方法从该数组中删除对象：

```
function deleteVacation(day) {
    for (var index = 0; index < resourceVacation.length; index++) {
        if (resourceVacation[index].id == day)

            resourceVacation.splice(index,1);
    } 
```

3-当我在删除单个对象后尝试对该数组进行字符串化时，我得到了提到的异常。所以.. anu 想为什么它第一次通过而第二次失败！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T19:22:53.250

您不能对日期对象进行 JSON 编码。

来自[json.org](http://www.json.org/)：“值可以是双引号中的字符串、数字、true 或 false 或 null，或者对象或数组。这些结构可以嵌套。”

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-23T11:02:41.717

问题是源[对象是循环引用](https://softwareengineering.stackexchange.com/questions/11856/whats-wrong-with-circular-references)。

您应该创建一个没有源对象的对象副本。

**这就是我在 FullCalendar 中解决问题的方法。**

# ios - 每次应用启动时显示初始视图

> ID：10504960
> 
> 赞同：3
> 
> 时间：2012-05-08T19:13:11.113
> 
> 标签：ios, ios5, uiapplicationdelegate

出于安全原因，每次打开我的应用程序时，我都需要用户登录。我想做的是当应用程序即将关闭时将其重置为初始视图。我从视图控制器知道我可以使用以下代码：

```
[[self navigationController] popToRootViewControllerAnimated:NO]; 
```

我不确定如何使其适应应用程序委托的工作。

在初始视图中，我将其设置为在 viewDidLoad 上显示登录模式。这似乎只是第一次触发，而不是在使用后退按钮时在应用程序中触发，所以我希望我可以安全地使用这种方法来显示登录屏幕。

为了澄清起见，我知道我将在应用程序委托中执行此操作，我正在寻找可用于告诉应用程序重置视图的特定代码位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T19:53:44.943

一个简单的解决方案可能是阻止您的应用程序在后台运行。当用户关闭它时，这将完全关闭您的应用程序。

我相信要做到这一点，您只需转到项目的 info.plist 并检查“应用程序不在后台运行”为“是”。

祝你好运！希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:16:24.843

在您的 AppDelegate.m 中，您可以使用以下委托方法：

```
-(void)applicationWillResignActive: (UIApplication*)application 
```

看看`UIApplicationDelegate`这里的其他方法，找出最适合您的应用程序的方法：

[http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html)

* * *

编辑：

我完成此操作的一种方法是使用委托方法`-(void)applicationDidBecomeActive:(UIApplication *)application`来显示您的登录界面，这在其他地方尚未完成。

当用户从头开始打开应用程序时，或者如果从后台恢复，或者如果在 iOS5 上，如果他们在您的应用程序中并且他们与可拖动状态栏交互然后再次关闭它，则始终会调用此方法，这个方法会被击中。我认为这可能是要求他们登录的最佳时机。

我不确定您是否希望用户能够在他们所在的屏幕上恢复，因此您需要决定是否在应用程序进入后台时将其注销。（再次查看应用程序委托类参考，或查看您的应用程序委托方法文件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:17:41.373

您可以将其设置为在您的`AppDelegate`.

看着`applicationDidBecomeActive:`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-19T17:02:18.103

```
 - (void)applicationDidBecomeActive:(UIApplication *)application
    {
        UINavigationController *navController = (UINavigationController *)self.window.rootViewController;
        [navController popToRootViewControllerAnimated:NO];
    } 
```

# ios - 如何从 UINavigationBar 中删除背景图像

> ID：10504966
> 
> 赞同：4
> 
> 时间：2012-05-08T19:13:27.867
> 
> 标签：ios, xamarin.ios, background-image, navigationbar, setbackground

我`UINavigationBar`在根视图控制器中设置了背景图像，但我需要在详细视图控制器中删除背景图像。

使用 Obj-C，我使用以下代码：

```
if ([[UINavigationBar class] respondsToSelector:@selector(appearance)])  
{
    [self.navigationController.navigationBar setBackgroundImage:nil forBarMetrics:UIBarMetricsDefault];
} 
```

所以当我在 MonoTouch 中使用这段代码时：

```
this.NavigationController.NavigationBar.SetBackgroundImage(null, UIBarMetrics.Default); 
```

我收到此错误：

```
System.ArgumentNullExeption  
Argument cannot be null  
Parameter name: backgroundImage 
```

如何删除背景图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T19:51:49.407

这看起来像一个错误。`null`在这种方法中应该允许AFAICT去除背景。

我将尽快为 MonoTouch 的下一个稳定版本修复此问题。如果这阻止了您只需在[http://bugzilla.xamarin.com](http://bugzilla.xamarin.com)填写错误报告，我们将为您提供解决此问题的修补程序。

**编辑**：这是固定的，将在下一个版本中可用（例如 5.2.12 稳定版）

# bash - 如何将一组命令传递给bash中的shell脚本

> ID：10504969
> 
> 赞同：3
> 
> 时间：2012-05-08T19:13:36.457
> 
> 标签：bash

我正在尝试编写一个脚本，该脚本在命令行上接受一组命令（类似于使用“time”命令的方式），让它执行该组命令，然后根据返回的错误代码做某事（如果你好奇，我会让它回叫我桌面上的语音守护程序以回显命令，如果它失败或成功 - 将它用于一些长时间运行的构建过程）

使用 unix time 命令，如果我有可以运行的命令列表

```
> time (do_build && deploy_build) 
```

`tellme`当我尝试这个时，使用我的命令（我称之为）

```
> tellme (do_build && deploy_build)
bash: syntax error near unexpected token `do_build' 
```

它似乎不喜欢将命令组作为参数，即使对于 time 命令来说完全相同的东西也能正常工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:21:55.490

我猜你将不得不做类似的事情

```
tellme 'do_build && deploy_build' 
```

在里面告诉我

```
eval "$*" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:22:24.280

`time`实际上是在执行它的`(do_build && deploy_build)`参数并等待它。

```
$ time (sleep 1; echo hello world;);
mundo

real    0m1.098s
user    0m0.030s
sys     0m0.000s

$ echo asd (sleep 1; echo hello world;);
bash: syntax error near unexpected token `('

$ (sleep 1; echo hello world;);
mundo 
```

您不能在任何地方使用子shell。

在您的情况下，您需要使用类似的东西

```
$ (sleep 1; echo hello world) && tellme && echo done; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T19:33:21.293

你可以做

```
tellme "$(do_build && deploy_build)" 
```

time 是内置的 bash，如果您使用 /usr/bin/time 而不是 time，您将看到同样的问题。

# c# - 无法从实体框架中的模型代码生成数据库

> ID：10504974
> 
> 赞同：1
> 
> 时间：2012-05-08T19:13:56.837
> 
> 标签：c#, database, asp.net-mvc, asp.net-mvc-3, entity-framework

我正在学习 EF。我有一些从 DbContext 继承的模型和类。我有`Initializer : DropCreateDatabaseIfModelChanges`带有空方法 Seed 的初始化程序。我调用

```
 Database.SetInitializer<...Context>(new ...Initializer()); 
```

我已经为连接字符串设置了新的添加

```
<add name="...Context" connectionString="Data Source=|DataDirectory|Temp.sdf" providerName="System.Data.SqlServerCe.4.0"/> 
```

但我无法从此生成数据库。应用程序数据为空。请帮帮我！可能我忘记了什么？我留下的方法种子是空的，但我不认为这是一个麻烦谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:18:46.227

设置一个初始化器是不够的。您至少需要启动一个查询。

在您尝试从上下文中获取数据的那一刻，该过程将开始，如果您的数据库不存在，则将被创建。

```
MyDbContext myDbContext = new MyDbContext();
var firstItemOfSomething = myDbContext.FirstItemOfSomething.FirstOrDefault(); 
```

# c - 为什么 GCC 内联汇编器需要破坏信息，而 MSVC 不需要

> ID：10504984
> 
> 赞同：9
> 
> 时间：2012-05-08T19:14:39.577
> 
> 标签：c, visual-c++, gcc, inline-assembly

我不明白这应该如何工作。

GCC 内联汇编器很难做到正确，但非常具体地标记破坏信息，以便编译器知道你在做什么。

Microsoft Visual C++ 的内联汇编器真的很容易使用（它似乎总是 Just Work），但我不知道它对你的代码有什么样的保证或假设。

VC++ 是否尝试“自动检测”哪些寄存器被破坏？它如何知道寄存器和堆栈指针将如何更改？它会做任何假设吗？如果是这样，你如何绕过这些假设？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T20:02:17.470

至于为什么 GCC 不像 MSVC 那样做，有几个原因：

1.  GCC 是一个可重定向的编译器，但汇编语法只是原始文本。为了使破坏检测是自动的，GCC 必须解析汇编语言以了解正在破坏的寄存器（包括由操作码未命名寄存器的指令隐式破坏的寄存器）。这必须适用于所有架构。目前，GCC 不解析汇编语言；`%`它只是在执行替换后将其粘贴到程序集输出中。这个想法是生成并避免解析。

2.  在 GCC 内联汇编语言中，**破坏寄存器是例外而不是规则**。原因是它是一种比 MSVC 更复杂的语言。GCC 的内联汇编语言为您分配寄存器。所以你通常不`%eax`直接使用类似的东西，而是使用`%0`GCC 替换可用寄存器的代码。（要做到这一点，编译器不必理解汇编语言！您表达了确保 GCC 替换`%0`适合使用的适当寄存器的约束。） **如果您的汇编代码覆盖硬编码，您只需要 clobber寄存器，而不是覆盖 GCC 为您分配的输出操作数**。

Note that with GCC inline assembly, you don't have to write the code which loads your assembly language operands from the C expressions that produce their initial values, or which stores your result operands into the C destinations. For instance you just express that there is to be an input operand of type `"r"` (register) which is derived from the expression `foo->bar + 1`. GCC allocates the register and generates the code to load it from `foo->bar + 1`, and then replaces occurences of `%0` in your assembly template with the name of that register.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-08T19:20:37.433

[从文档中](http://msdn.microsoft.com/en-us/library/k1a8ss06(v=vs.80).aspx)引用：

> 使用 __asm 在 C/C++ 函数中编写汇编语言时，不需要保留 EAX、EBX、ECX、EDX、ESI 或 EDI 寄存器。例如，在[使用内联汇编编写函数](http://msdn.microsoft.com/en-us/library/5sds75we(v=vs.80).aspx)的 POWER2.C 示例中，power2 函数不保留 EAX 寄存器中的值。但是，使用这些寄存器会影响代码质量，因为寄存器分配器不能使用它们来跨 __asm 块存储值。此外，通过在内联汇编代码中使用 EBX、ESI 或 EDI，您可以强制编译器在函数序言和结尾处保存和恢复这些寄存器。
> 
> 您应该为 __asm 块的范围保留您使用的其他寄存器（例如 DS、SS、SP、BP 和标志寄存器）。您应该保留 ESP 和 EBP 寄存器，除非您有理由更改它们（例如，切换堆栈）。另请参阅[优化内联汇编](http://msdn.microsoft.com/en-us/library/5hd5ywk0(v=vs.80).aspx)。

# symfony - 与 Symfony 2 一起投入生产

> ID：10504990
> 
> 赞同：1
> 
> 时间：2012-05-08T19:14:50.903
> 
> 标签：symfony

在使用 Symfony 2 投入生产之前，我注意到 AppKernel.php 中的框架加载了很多包。默认值为：

```
$bundles = array(
        new Symfony\Bundle\FrameworkBundle\FrameworkBundle(),
        new Symfony\Bundle\SecurityBundle\SecurityBundle(),
        new Symfony\Bundle\TwigBundle\TwigBundle(),
        new Symfony\Bundle\MonologBundle\MonologBundle(),
        new Symfony\Bundle\SwiftmailerBundle\SwiftmailerBundle(),
        new Symfony\Bundle\DoctrineBundle\DoctrineBundle(),
        new Symfony\Bundle\AsseticBundle\AsseticBundle(),
        new Sensio\Bundle\FrameworkExtraBundle\SensioFrameworkExtraBundle(),
        new JMS\SecurityExtraBundle\JMSSecurityExtraBundle(),
    ); 
```

我使用资产、学说、树枝、框架、独白包。我可以安全地移除其他人以便提高加载速度吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T19:38:58.170

您可以安全地删除 SwiftmailerBundle。

其他的（SecurityBundle、SensioFrameworkExtraBundle、JMSSecurityExtraBundle）可能更难，因为它们有关系，而且你的包也可能有依赖关系。

我会继续删除一个包，运行我的测试（或者手动测试，如果你没有的话）然后看看发生了什么。如果一切正常，您可以删除下一个。

确保在每次删除后删除缓存（为了安全起见）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T02:14:21.227

我认为您不需要删除这些捆绑包，因为我认为加载速度不会受到很大影响。原因是因为 Symfony2 使用了依赖注入，所以一个类只有在你使用的时候才会被初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T07:24:10.597

如果我是你，我不会删除任何东西

如果您想在最少的基础上工作，请尝试使用[symfony2 组件](http://symfony.com/components)，因为您需要它们还有 Fabien，symfony 的主要编码员，关于[如何构建自己的自定义框架](http://fabien.potencier.org/)的好帖子，也许你想去那个路径，如果您非常重视极简主义和优化代码

# scroll - FancyBox 在页面上打开过低

> ID：10504999
> 
> 赞同：3
> 
> 时间：2012-05-08T19:15:23.283
> 
> 标签：scroll, fancybox, position, css-position

我在我的页面上使用 FancyBox，偶尔（但并非总是），灯箱在页面下方打开得太远，在底部被截断，让您向下滚动以查看其余部分。通常，它将位于页面的死点。

当我调用它时，我将它的位置设置为`fixed`在`onStart`方法中，并且大多数时候它*确实*像它应该的那样在中心打开 - 所以我不知道是什么导致它被抛出，但只是有时。

该站点是[Raditaz.com](http://www.raditaz.com)：播放现有电台（或创建自己的电台 - 您不需要帐户），然后单击中间的专辑封面以打开灯箱。

对此的任何线索将不胜感激 - 谢谢！

编辑：一些更新......

*   如果我在打开 FancyBox 后调整窗口大小，它会在中心正确地重新定位（但只有在我关闭并重新打开它之前，它会再次移动得太低）
*   WebKit 浏览器（Safari 和 Chrome）中似乎最常出现错误定位

编辑 2：我应该指出我们使用的 Fancybox 版本是 1.3.4，而不是较新的 2.0。我们的 jQuery 版本是 1.6.4。使用 Fancybox 2.0 可能会解决问题，但是（我认为）需要 jQuery 1.7，它与我们正在使用的其他一些插件不兼容。所以我更喜欢一个适用于 Fancybox 1.3.4 的修复程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T10:04:44.270

我访问了您的网页，并且在发现错误后能够**反复重现该问题**，那是使用 Firefox。

首先，这是该问题的参考照片： ![在此处输入图像描述](../Images/b6324b39f5470bd81cb797ce570bfc13.png)

请注意，上图中的**Fancybox**不在浏览器中居中，艺术家照片的顶部位于您正在使用的**Totem Ticker Plugin下方。**

下一张参考照片是红框部分的特写，显示**Totem Ticker**正在覆盖对象：
![在此处输入图像描述](../Images/5ffc41b535bd6d6ead3307bde48f0453.png)

这**两个问题**是相关的。要重现**FancyBox 在页面问题上打开过低的**问题，您需要单击居中的较大图像旁边的**迷你艺术家图像，该图像之前播放了几首歌曲，并且 Totem Ticker 插件正在*****制作***动画。

这些参考图像显示了时机合适时会发生什么。如果时机不对或滑块正在使用缓存中尚未清除的图像，则需要重试。通常您会开始看到 Totem Ticker 与其他对象重叠。

既然已经发现了这个错误，这里有一个**工作解决方案**来处理它。您将使用 Fancybox 插件中的回调在 Fancybox 即将动画时关闭 Totem Ticker，并在 Fancybox 关闭时重新打开 Totem Ticker。

由于 Totem Ticker 没有任何 API 与之交互，因此您必须使用该插件概述的过程通过锚定按钮使用启动和停止选项。好消息是您不需要与它相关联的文本链接，因此它不会被看到。这是要查看的代码：

```
jQuery Totem Ticker jQuery Before:

    $('#trending ul').totemticker({
        direction: 'up',
        interval: 5000,
        mousestop: true,
        row_height: '74px'
    });

jQuery Totem Ticker jQuery After:

    $('#trending ul').totemticker({
        direction: 'up',
        interval: 5000,
        mousestop: true,
        row_height: '74px',
        start: '#totemStart',
        stop: '#totemStop'
    });

jQuery Totem Ticker HTML Before:

        <div id="trending" class="column aside">
            <div class="section title"><span>Top Trending Stations</span></div>
            <div class="fadeout"></div>
            <ul></ul>
        </div>

jQuery Totem Ticker HTML After:

        <div id="trending" class="column aside">
            <div class="section title"><span>Top Trending Stations</span></div>
            <div class="fadeout"></div>
            <ul></ul>
            <a id="totemStart" href="#"></a>
            <a id="totemStop" href="#"></a>
        </div>

Imported raditaz.min.build File Before:

    $("#album-art-anchor").fancybox({
        scrolling: "auto",
        autoscale: true,
        autoDimensions: true,
        width: 455,
        height: 495,
        titlePosition: "outside",
        onStart: function () {
            $("#fancybox-overlay").css({
                position: "fixed",
                overflow: "scroll"
            });
        },
        onClosed: onTrackLightboxClosed
    });

Imported raditaz.min.build File After:

    $("#album-art-anchor").fancybox({
        scrolling: "auto",
        autoscale: true,
        autoDimensions: true,
        width: 455,
        height: 495,
        titlePosition: "outside",
        onStart: function () {
            $("#fancybox-overlay").css({
                position: "fixed",
                overflow: "scroll"
            });
        },
        onClosed: onTrackLightboxClosed,

        // Below is added above is original.
        //
        beforeShow: function(){
            $('#totemStop').click();
        },
        afterClose: function(){
            $('#totemStart').click();
        },
        onComplete: function(){
           $.fancybox.center;
        }
    }); 
```

内容显示后立即触发，该`onComplete`函数使用 Fancybox API 将内容集中在视口中......但恕我直言，现在没有必要，因为我们正在处理导致它的问题。我把它包括在内是为了确定，因为我最终无法重现失败的情况，但是这两个插件一起进行了测试，以确保这个答案有助于解决您的问题。

可以肯定的是，你总是可以运行**$.fancybox.center;** 在 setTimeout 中，以便在 Fancybox 稳定后触发：

```
setTimeout("$.fancybox.center;", 1000); 
```

`onStart`的使用`overflow: "scroll"`会导致 Chrome 右侧出现空的垂直条。

附带说明一下，由于该站点正在开发中，除了带有 Firebug 插件的 Firefox 之外，我还使用了用于 Firefox 的[HTML Validator Plugin](https://addons.mozilla.org/en-US/firefox/addon/html-validator/)。它在查看源 html 页面时突出显示错误并提供解决方案。例如，在主页上的第 389 行是未封闭的类名称。第 587/589 行是重复的 ID。有些错误不是错误，例如插件将其唯一标签注入标记时。

**编辑：**根据您最近的 SO 问题编辑：请将 Fancybox 更新到与您正在使用的 jQuery v1.6.4 兼容的 v2.0。Fancybox v2.0 源文件说 jQuery v1.6.0 是最低要求版本。

如果有任何不清楚的地方，请告诉我，我会尝试以不同的方式解释。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T09:44:34.217

我也看不到你的网站。但是你可能可以删除所有 fancbox 的东西，重新下载并安装它。这将消除幻想箱中的问题。

否则，请检查您是否有一些并非针对fancybox 的代码，但无论如何。

但首先，升级到更新的 jquery。您当前使用的是 1.6。现在有 1.7.2 可用。他们已经修复了新版本中的一些错误。