# StackOverflow 问答 000189000-000189999

# c# - NHibernate DetachedCriteria.SetFirstResult？

> ID：189019
> 
> 赞同：0
> 
> 时间：2008-10-09T20:14:47.983
> 
> 标签：c#, .net, nhibernate

我在网络上找到了一个在 NHibernate 中实现存储库模式的示例，其中一个方法使用此代码来获取查询的第一个结果：

```
public IEnumerable<T> FindAll(DetachedCriteria criteria, int firstResult, int numberOfResults, params Order[] orders)

{
    criteria.SetFirstResult(firstResult).SetMaxResults(numberOfResults);
    return FindAll(criteria, orders);
} 
```

但是 VS intellisense 并没有从 DetachedCriteria 中采用这种方法。有谁知道 DetachedCriteria 是否可行？我正在使用 NHibernate 1.2.1 版。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-09T20:27:33.260

没关系，我想我明白了：

```
criteria.GetExecutableCriteria(_session).SetFirstResult(firstResult).SetMaxResults(numberOfResults); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T20:29:22.710

在绑定 ISession 之前，它似乎不可用。例如，它不在 DetachedCriteria 上，但在从**GetExecutableCriteria**方法返回的 ICriteria 上可用。

# c# - 为我的所有表单设置相同的图标

> ID：189031
> 
> 赞同：35
> 
> 时间：2008-10-09T20:16:56.137
> 
> 标签：c#, .net, winforms, icons

有什么方法可以为我的所有表单设置相同的图标而不必一一更改？就像您`GlobalAssemblyInfo`在解决方案中为所有项目设置时一样。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-05-15T07:36:42.860

1.  在项目属性 > 应用程序 > 图标和清单 > 浏览 *.ico 文件并将其添加到那里。

2.  在 Form 的构造函数或`_Load`事件中，只需添加：

    ```
    this.Icon = Icon.ExtractAssociatedIcon(Application.ExecutablePath); 
    ```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-09T20:21:50.683

一种选择是从在构造函数中设置 Icon 的通用基本表单继承（可能来自 resx）。另一个选项可能是[PostSharp](http://www.postsharp.org/) - 似乎应该可以通过 AOP 执行此操作（设置 .Icon）；不过，这不是微不足道的。最后，您可以使用简单的实用程序方法（可能是扩展方法）来做同样的事情。

最重要的是，使用第一个选项，您可能会冒险从或到的`Ctrl`+ `H`（全部替换）。`: Form``: System.Windows.Forms.Form``: MyCustomForm`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-09T23:44:23.550

除了 Marc 的建议之外，您可能希望表单自动继承包含/调用它们的执行程序集的图标。
这可以通过将以下代码添加到继承的表单来完成：

```
public MyCustomForm()
{
    Icon = GetExecutableIcon();
}

public Icon GetExecutableIcon()
{
    IntPtr large;
    IntPtr small;
    ExtractIconEx(Application.ExecutablePath, 0, out large, out small, 1);
    return Icon.FromHandle(small);
}

[DllImport("Shell32")]
public static extern int ExtractIconEx(
    string sFile,
    int iIndex,
    out IntPtr piLargeVersion,
    out IntPtr piSmallVersion,
    int amountIcons); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-03-06T15:58:46.653

这是为所有表单设置相同图标而无需一一更改的方法。这是我在我的应用程序中编码的。

```
FormUtils.SetDefaultIcon(); 
```

这是一个可以使用的完整示例。

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main(string[] args)
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        //Here it is.
        FormUtils.SetDefaultIcon();

        Application.Run(new Form());
    }
} 
```

这是 FormUtils 类：

```
using System.Drawing;
using System.Windows.Forms;

public static class FormUtils
{
    public static void SetDefaultIcon()
    {
        var icon = Icon.ExtractAssociatedIcon(EntryAssemblyInfo.ExecutablePath);
        typeof(Form)
            .GetField("defaultIcon", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Static)
            .SetValue(null, icon);
    }
} 
```

这里是 EntryAssemblyInfo 类。对于本示例，这将被截断。这是我从 System.Winforms.Application 中获取的自定义编码类。

```
using System.Security;
using System.Security.Permissions;
using System.Reflection;
using System.Diagnostics;

public static class EntryAssemblyInfo
{
    private static string _executablePath;

    public static string ExecutablePath
    {
        get
        {
            if (_executablePath == null)
            {
                PermissionSet permissionSets = new PermissionSet(PermissionState.None);
                permissionSets.AddPermission(new FileIOPermission(PermissionState.Unrestricted));
                permissionSets.AddPermission(new SecurityPermission(SecurityPermissionFlag.UnmanagedCode));
                permissionSets.Assert();

                string uriString = null;
                var entryAssembly = Assembly.GetEntryAssembly();

                if (entryAssembly == null)
                    uriString = Process.GetCurrentProcess().MainModule.FileName;
                else
                    uriString = entryAssembly.CodeBase;

                PermissionSet.RevertAssert();

                if (string.IsNullOrWhiteSpace(uriString))
                    throw new Exception("Can not Get EntryAssembly or Process MainModule FileName");
                else
                {
                    var uri = new Uri(uriString);
                    if (uri.IsFile)
                        _executablePath = string.Concat(uri.LocalPath, Uri.UnescapeDataString(uri.Fragment));
                    else
                        _executablePath = uri.ToString();
                }
            }

            return _executablePath;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-01T14:52:17.173

我不确定我是否想在这里使用继承，所以我使用了扩展方法：

```
public static class MyExtensionMethods
{
    public static void SetAppIcon(this Form form)
    {
        form.Icon = Icon.ExtractAssociatedIcon(Application.ExecutablePath);
    }
} 
```

然后在任何形式的构造函数中：

```
this.SetAppIcon(); 
```

注意：如果您尝试从网络位置运行应用程序，这将导致崩溃

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-04T10:36:15.883

在构造函数中设置的替代方法是覆盖`Owner`属性，并采用所有者表单的图标。

```
public new Form Owner {
    set {
        this.Icon = (value == null ? null : value.Icon);
        base.Owner = value;
    }

    get {
        return base.Owner;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-12-24T09:05:58.867

这是一个老问题，但这种方法对我来说可以在所有表​​单中获得相同的图标，而无需在每个表单的属性中添加它。

首先，我在“属性”下的“资源”节点中添加了一个新图标（添加资源 => 新图标）。

默认情况下，会创建一些图标并将其存储在您的资源位置（在图标上查找“文件名”属性）。

假设您已准备好 .ico 文件，您可以将其复制到该文件夹​​。

删除在该文件夹中创建的 Visual Studio 并将您自己的重命名为完全相同的名称。

Visual Studio 将提示您是否要重新加载资源，因为它已被修改。（点击“是”）

这样，您就可以在资源下使用您的徽标。

现在我做了一个通用方法来将表单标题更改为我的默认值并设置表单图标并在 InitializeComponent() 之后的每个表单中调用它；

以 cs 的形式看起来如何（m 是包含通用方法的类）：

```
m.set_form_defaults(this, "Title here"); 
```

这就是方法本身：

```
 public void set_form_defaults(Form frm,string frmTitle)
    {

        frm.Icon = ((System.Drawing.Icon)(Properties.Resources.Logo_V2));
        frm.Text = frmTitle + " " + show_current_server();

    } 
```

当然这里不需要添加表单标题，但这只是因为我想向用户（当前服务器）显示一些存储的属性

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-14T03:54:00.287

我不确定 MS VS 设计器是否可以处理不直接从表单派生的表单。如果没有，那么您可以尝试将主表单的图标复制到所有其他表单：对于 Forms 集合中的每个表单

```
form.icon = MainFrom.Icon 
```

或者也许在每个表单的 _Loaded 事件中：

```
Icon = MainFrom.Icon 
```

# xml - 在 AS3 中使用 insertChildBefore 和 insertChildAfter 时遇到问题

> ID：189033
> 
> 赞同：3
> 
> 时间：2008-10-09T20:16:59.320
> 
> 标签：xml, actionscript-3

我有一个 XML 文档：

```
var xml:XML = new XML(<rootNode>            
                <head> 
                    <meta name="template" content="Default" />
                </head>
                <mainSection>
                    <itemList>
                        <item>
                            <video src={this.videoURL}  />
                            <img  src={this.src}></img>
                        </item>
                    </itemList>
                </mainSection>
            </rootNode>); 
```

我想做的是，当某些条件是我时，在 itemList 的开头插入另一个。

```
var newNode:XMLList = new XMLList("<item><video src=\"" + _videoSource + "\"></video></item>"); 
```

我能够很好地生成和跟踪 newNode，但是每当我尝试使用添加它时`insertChildBefore`，它总是返回 undefined。

```
var contentNode:XML = new XML(xml.mainSection.itemList.item);
xml.insertChildBefore(contentNode ,newNode) 
```

`contentNode`总是可以很好地跟踪，但在尝试`insertChildBefore`或时总是失败`insertChildAfter`。奇怪的是，如果我`contentNode`不那么具体（如`xml.mainSection`），那么它会按预期工作。

感谢您的帮助，这让我发疯了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T20:28:48.017

这里有两个问题（我现在已经测试了这段代码——它应该适合你）：

1.  该变量`xml`不是`item`您要插入的节点的直接父级。您正在调用`insertChildBefore`该`xml`节点，但您`contentNode`不是它的直接子节点。

2.  `contentNode`您尝试插入的变量是您想要的节点的*副本*；您不应该创建一个全新的 XML 对象。

试试这个：

```
var contentNode:XML = xml.mainSection.itemList.item[0];
var parentNode:XML = xml.mainSection.itemList[0];
parentNode.insertChildBefore( contentNode, newNode[0] ); 
```

# visual-studio - 在 Visual Studio 中更改解决方案资源管理器的背景颜色

> ID：189043
> 
> 赞同：58
> 
> 时间：2008-10-09T20:20:36.613
> 
> 标签：visual-studio

有没有办法使用主题更改 Visual Studio 中解决方案资源管理器的背景颜色？- 或任何其他方式？

我可以通过更改窗口范围的颜色设置来更改它，但显然影响太大了。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2011-10-25T22:16:06.017

不到一个小时就为它创建了 VS 扩展，在扩展管理器中搜索“SExColor”。享受 ;）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-02-07T20:42:10.427

@aloneguid ...应该很久以前就看过了..谢谢先生！

@ver（关于解决方案的 vs 2008 解决方案；） - 一种 B52 类型的方法，对 devenv.exe 中的任何 SysTreeView32 进行地毯式轰炸。所需颜色的可能额外参数，否则 RGB(220,220,220) - 最适合我

```
#include <windows.h>
#include "psapi.h"
#include "shlwapi.h"
#include "commctrl.h"

COLORREF clr = RGB(220,220,220);

BOOL CALLBACK wenum( HWND hwnd, LPARAM lParam)
{
   const UINT cb = 261;
   static wchar_t    name[] = L"SysTreeView32",
                     tmp[cb] = {0};
   if( ::GetClassNameW( hwnd, tmp, 260 ) && 0 == _wcsicmp( name, tmp ) )
   {
      ::SendMessageW( hwnd, TVM_SETBKCOLOR, 0, (LPARAM)clr );
   }

   return TRUE;
}

BOOL CALLBACK EnumTops(HWND hwnd, LPARAM lParam) 
{
    DWORD             dwThreadId  = 0, 
                     dwProcessId = 0;
    HINSTANCE         hInstance;
   static wchar_t derVS[]     = L"devenv.exe";
   wchar_t  name[_MAX_PATH]   = {0},
            *exe              = 0;

    HANDLE hProcess;
   if (!hwnd)  return TRUE;     // Not a window
   if (!::IsWindowVisible(hwnd)) return TRUE;       // Not visible

   if (!SendMessage(hwnd, WM_GETTEXT, sizeof(name), (LPARAM)name))
      return TRUE;      // No window title
   dwThreadId = GetWindowThreadProcessId(hwnd, &dwProcessId);
   hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwProcessId);
   if( !GetModuleFileNameEx(hProcess, 0, name, sizeof(name))) goto exit;

   exe = ::PathFindFileNameW( name );
   if( (void*)exe == (void*)name ) goto exit; // mhm? maybe not exit?

   if( _wcsicmp( derVS, exe ) ) goto exit;

   EnumChildWindows( hwnd, wenum, (LPARAM)hProcess );

exit:
   CloseHandle(hProcess);
   int res = GetLastError();
   return res;
}

int wmain(int argc, wchar_t * argv[]) 
{
   if( argc >= 2 )
   {
      wchar_t *end = 0;
      long l = wcstol( argv[1], &end, 16 );
      clr = (DWORD)l;
   }
   ::EnumWindows(EnumTops, NULL);
   return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T20:30:38.433

不是通过 Visual Studio 本身的任何配置方式。

但是，您可能可以从 Win32 API 中“破解”窗口对象（查找“窗口枚举”）。一旦你有了窗口句柄，你就可以设置你想要的所有特性。

问候

/罗伯特

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-29T15:37:51.153

即使更改标准 Windows 背景颜色也不适用于解决方案资源管理器。这个 Visual Studio[错误报告](http://connect.microsoft.com/VisualStudio/feedback/details/534052/solution-explorer-background-color-is-white-instead-of-using-windows-color)提到了这个问题。Microsoft 已将此标记为“已关闭 - 无法修复”。

这很烦人！使用深色主题并在屏幕一侧悬挂亮白色的解决方案资源管理器非常烦人。

一种可能的解决方案是根本不使用解决方案资源管理器。[Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/en-us/d0d33361-18e2-46c0-8ff2-4adea1e34fef)提供了一个解决方案资源管理器替代品，称为“解决方案导航器”。它目前也被硬编码为白色。但我认为让该工具的开发人员添加对修改颜色的支持可能比让微软在 Visual Studio 中做这件事的机会更大。（尽管微软创建了 PPT。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-30T07:14:13.770

你可以使用其他扩展，你有很大的可能性让你的 Visual Studio 看起来更漂亮；）（但我不确定你是否可以更改解决方案资源管理器背景）

[http://visualstudiogallery.msdn.microsoft.com/20cd93a2-c435-4d00-a797-499f16402378](http://visualstudiogallery.msdn.microsoft.com/20cd93a2-c435-4d00-a797-499f16402378)

# c++ - 循环内的迭代器初始化是否被认为是不好的风格，为什么？

> ID：189055
> 
> 赞同：12
> 
> 时间：2008-10-09T20:23:50.537
> 
> 标签：c++, stl, coding-style, iteration, iterator

通常你会发现这样的 STL 代码：

```
for (SomeClass::SomeContainer::iterator Iter = m_SomeMemberContainerVar.begin(); Iter != m_SomeMemberContainerVar.end(); ++Iter)
{
} 
```

但我们实际上有这样的建议：

```
SomeClass::SomeContainer::iterator Iter = m_SomeMemberContainerVar.begin();
SomeClass::SomeContainer::iterator IterEnd = m_SomeMemberContainerVar.end();
for (; Iter != IterEnd; ++Iter)
{
} 
```

如果您担心范围，请添加括号：

```
{
    SomeClass::SomeContainer::iterator Iter = m_SomeMemberContainerVar.begin();
    SomeClass::SomeContainer::iterator IterEnd = m_SomeMemberContainerVar.end();
    for (; Iter != IterEnd; ++Iter)
    {
    }
} 
```

这应该可以提高速度和效率，尤其是在您对控制台进行编程时，因为在循环的每次迭代中都不会调用 .end() 函数。我只是认为性能改进是理所当然的，这听起来很合理，但我不知道有多少，这当然取决于容器的类型和实际使用的 STL 实现。但是在使用这种风格几个月后，我实际上比第一种更喜欢它。

原因是可读性：for 行整洁。在实际生产代码中使用限定符和成员变量，如果您使用第一个示例中的样式，很容易使行**很长。**这就是为什么我在这个例子中故意让它有一个水平滚动条，只是为了让你明白我在说什么。;)

另一方面，您突然将 Iter 变量引入 for 循环的外部范围。但是，至少在我工作的环境中，即使在第一个示例中，Iter 也可以在外部范围内访问。

你对此有什么看法？除了可能限制Iter的范围之外，第一种风格是否有任何专业人士？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-09T20:29:28.123

如果您将代码正确地包装成行，则内联表单将同样具有可读性。此外，您应该始终将其`iterEnd = container.end()`作为优化：

```
for (SomeClass::SomeContainer::iterator Iter = m_SomeMemberContainerVar.begin(),
    IterEnd = m_SomeMemberContainerVar.end();
    Iter != IterEnd;
    ++Iter)
{
} 
```

*更新：根据 paercebal 的建议修复了代码。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-09T20:43:50.827

另一种选择是使用 foreach 宏，例如[boost foreach](http://www.boost.org/doc/libs/1_36_0/doc/html/foreach.html)：

```
BOOST_FOREACH( ContainedType item, m_SomeMemberContainerVar )
{
   mangle( item );
} 
```

我知道在现代 c++ 中不鼓励使用宏，但是在 auto 关键字广泛使用之前，这是我发现的获得简洁易读的东西的最佳方式，并且仍然是完全类型安全和快速的。您可以使用任何一种初始化样式来实现您的宏，以获得更好的性能。

链接页面上还有一条关于将 BOOST_FOREACH 重新定义为 foreach 以避免烦人的全部大写的注释。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T20:25:40.083

如果在 for 循环之后不需要迭代器，则第一种形式（在 for 循环内）更好。它将其范围限制为 for 循环。

我严重怀疑无论哪种方式都可以提高效率。也可以使用 typedef 使其更具可读性。

```
typedef SomeClass::SomeContainer::iterator MyIter;

for (MyIter Iter = m_SomeMemberContainerVar.begin(); Iter != m_SomeMemberContainerVar.end(); ++Iter)
{
} 
```

我会推荐更短的名字;-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-11T16:02:01.130

`iter.end()`不，在循环开始之前暂停是个坏主意。如果您的循环更改了容器，那么结束迭代器可能会失效。此外，该`end()`方法保证为 O(1)。

过早的优化是万恶之源。

此外，编译器可能比你想象的更聪明。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-11T16:10:48.227

在 -O2 优化的 g++ 中看过这个（只是为了具体一点）

std::vector、std::list 和 std::map（和朋友）的生成代码没有区别。std::deque 的开销很小。

所以总的来说，从性能的角度来看，它几乎没有什么区别。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T20:30:44.953

尽管迭代器生命周期会使我倾向于 for-scoped 版本，但我对此并没有特别强烈的意见。

但是，可读性可能是一个问题。这可以通过使用 typedef 来帮助，因此迭代器类型更易于管理：

```
typedef SomeClass::SomeContainer::iterator sc_iter_t;

for (sc_iter_t Iter = m_SomeMemberContainerVar.begin(); Iter != m_SomeMemberContainerVar.end(); ++Iter)
{
} 
```

不是很大的改进，但有点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T20:43:20.670

我没有任何控制台经验，但在大多数现代 C++ 编译器中，除了范围问题之外，任何一个选项最终都是等效的。Visual Studio 编译器几乎总是在调试代码中将条件比较放在隐式临时变量（通常是寄存器）中。因此，虽然从逻辑上看，end() 调用似乎是通过每次迭代进行的，但优化后的编译代码实际上只调用一次，并且比较是在循环中每次后续时间完成的唯一事情。

在控制台上可能不是这种情况，但您可以拆开循环来检查优化是否正在发生。如果是，那么您可以选择您喜欢的任何风格或组织中的标准风格。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T21:19:32.283

它可能会导致代码脱节，但我也喜欢将其拉出到一个单独的函数中，并将两个迭代器都传递给它。

```
doStuff(coll.begin(), coll.end()) 
```

并且有..

```
template<typename InIt>
void doStuff(InIt first, InIt last)
{
   for (InIt curr = first; curr!= last; ++curr)
   {
       // Do stuff
   }
 } 
```

喜欢的东西：

*   永远不必提及丑陋的迭代器类型（或考虑它是 const 还是非 const）
*   如果每次迭代都没有调用 end() 有好处，我明白了

不喜欢的事情：

*   分解代码
*   附加函数调用的开销。

但是有一天，我们会有 lambdas！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-12T04:17:45.390

我不认为这是一种糟糕的风格。只需使用 typedefs 即可避免 STL 冗长和冗长的行。

```
typedef set<Apple> AppleSet;
typedef AppleSet::iterator  AppleIter;
AppleSet  apples;

for (AppleIter it = apples.begin (); it != apples.end (); ++it)
{
   ...
} 
```

[Spartan Programming](http://www.codinghorror.com/blog/archives/001148.html)是减轻风格问题的一种方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T20:27:35.053

如果您担心范围，可以在初始化和循环周围加上大括号。通常我要做的是在函数的开头声明迭代器并在整个程序中重用它们。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T20:27:55.257

我发现第二个选项更具可读性，因为您最终不会得到一条大线。然而，费鲁乔提出了一个关于范围的好观点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-09T20:28:07.533

我同意费鲁乔的观点。有些人可能更喜欢第一种样式，以便将 end() 调用拉出循环。

我还可以补充一点，C++0x 实际上会使两个版本都更干净：

```
for (auto iter = container.begin(); iter != container.end(); ++iter)
{
   ...
}

auto iter = container.begin();
auto endIter = container.end();
for (; iter != endIter; ++iter)
{
   ...
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-09T20:29:08.420

我通常会写：

```
SomeClass::SomeContainer::iterator Iter = m_SomeMemberContainerVar.begin(),
                                   IterEnd = m_SomeMemberContainerVar.end();

for(...) 
```

# asp.net - MasterPage 是否知道正在显示的页面？

> ID：189062
> 
> 赞同：8
> 
> 时间：2008-10-09T20:26:58.473
> 
> 标签：asp.net, navigation, master-pages

当我在使用 MasterPages 的网站上导航时，应用程序是否知道我在哪个页面上？如果是这样，它是否将其存储在我可以访问的对象中？

我问的原因是我可以替换它：

```
//masterpage 
<div id="nav_main">
   <ul><asp:ContentPlaceHolder ID="navigation" runat="server">                    
   </asp:ContentPlaceHolder></ul>
</div>

//content page(s)
<asp:Content ContentPlaceHolderID="navigation" ID="theNav" runat="server">
   <li><a href="default.aspx">Home</a></li>
   <li id="current"><a href="faq.aspx">FAQ</a></li>
   <li><a href="videos.aspx">Videos</a></li>
   <li><a href="#">Button 4</a></li>
   <li><a href="#">Button 5</a></li>
</asp:Content> 
```

使用更优雅的导航解决方案，通过将列表项的 ID 设置为“当前”来突出显示页面链接。目前，每个页面都重新创建导航，并将其各自链接的 ID 设置为当前。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T21:19:43.623

我同意 Chris：使用控件来处理此菜单的显示，并使其知道应该突出显示哪些链接。这是我经常使用的一种方法。如果您有多个页面需要不同样式的相同链接，它可能会变得更加复杂，但您明白了。

```
Dim thisURL As String = Request.Url.Segments(Request.Url.Segments.Count - 1)
Select Cast thisUrl
   Case "MenuItem1.aspx"
       lnkMenu1.CssClass = "Current"
   Case "MenuItem2.aspx"
       lnkMenu2.CssClass = "Current"
End Select 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-09T20:55:26.683

要从母版页中获取当前请求 URL，您将执行以下操作：

```
string s = this.Page.Request.FilePath; // "/Default.aspx" 
```

我还建议将您的导航移动到母版页而不是内容页。这将使维护/访问变得更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-08T11:56:57.593

是的，在您的主文件中使用以下代码。它将为您提供内容页面名称。

```
Page.ToString().Replace("ASP.","").Replace("_",".") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-03T10:06:09.383

或者，如果您为子页面设置了特定标题而不是母版页，则可以搜索页面标题尝试：

```
this.Page.Title 
```

希望能帮助到你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-07T12:59:58.313

这是在 C# 中

```
string thisURL = Request.Url.Segments[Request.Url.Segments.Length - 1];
        if (thisURL.ToLower()== "default.aspx") li1.Attributes.Add("class","yekan active");
        if (thisURL.ToLower() == "experts.aspx") li2.Attributes.Add("class", "yekan active"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T20:31:56.217

您应该能够通过访问 Page 属性来获取该页面。IE：

```
string type = this.Page.GetType().Name.ToString(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T21:07:22.930

您可能只使用母版页中的[请求路径之一来设置当前路径。](http://www.west-wind.com/weblog/posts/269.aspx)我可能还会在母版页上有一个属性来覆盖它，以便没有链接或其他内容的页面可以将其设置为合理的值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-06T11:32:15.867

它以这种方式对我有用-谢谢贾里德

这就是我所做的让我们的导航菜单突出显示我们正在查看的页面的当前菜单项。代码在母版页中。你基本上得到了文件路径（Jared 的方式） 我们在链接中使用“~”，所以我不得不把它去掉。迭代 Menu 控件的 menuItems 集合。比较 navigateUrl 属性。

（我不是最好的编码员，而且在解释方面更差——但它确实有效，我对此非常满意！）

```
protected void HighlightSelectedMenuItem()
    {
        string s = this.Page.Request.FilePath; // "/Default.aspx"
        string nav;
        if (s.Contains("~"))
        {
            s = s.Remove(s.IndexOf("~"), 1);
        }

        foreach (MenuItem item in navMenu.Items)
        {
            if (item.NavigateUrl.Contains("~"))
            {
                nav = item.NavigateUrl.Remove(item.NavigateUrl.IndexOf("~"), 1);
                if (s == nav)
                {
                    item.Selected = true;
                }
            }

        }
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-04T05:54:45.787

```
string s = this.Page.GetType().FullName;
string[] array = s.Split('_');
int count = array.Count<String>();
string currentPage = array[count - 2]; 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-09T20:56:38.617

导航控件，而不是母版页，应该负责当前突出显示的页面。

加载的页面应该通知导航项它是谁，或者导航控件本身应该跟踪它。

关键是母版页应该只是显示内容的持有者。它们不应该控制任何东西。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-04-17T13:44:48.997

尝试

```
this.Page.Master 
```

它将为您提供当前页面的母版页。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2008-10-09T20:51:36.363

还有 Request.RawURL

# oop - 度量和面向对象的编程

> ID：189064
> 
> 赞同：4
> 
> 时间：2008-10-09T20:27:32.293
> 
> 标签：oop, metrics

我想知道是否有人经常使用指标来验证其代码/设计。例如，我想我会使用：

*   每个方法的行数（< 20）
*   每个方法的变量数 (< 7)
*   每个方法的参数数量 (< 8)
*   每个类的方法数（< 20）
*   每个类的字段数（< 20）
*   继承树深度 (< 6)。
*   方法缺乏凝聚力

这些指标中的大多数都非常简单。

您对这种措施有什么政策？您是否使用工具来检查他们的（例如 NDepend）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T20:48:30.550

在我看来，对这些值施加数值限制（正如你似乎暗示的那样）不是一个好主意。如果有重要的 switch 语句，方法中的行数可能非常多，但方法仍然简单正确。如果字段很简单，则类中的字段数可以适当地非常大。有时，五级继承可能太多了。

我认为最好分析类内聚（越多越好）和耦合（越少越好），但即便如此，我还是怀疑这些指标的效用。经验通常是一个更好的指南（尽管无可否认，这很昂贵）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T00:53:44.440

我在您的列表中没有看到的一个指标是 McCabe 的圈复杂度。它衡量给定功能的复杂性，并与错误相关。例如，一个函数的高复杂度分数表明：1）它*可能*是一个有问题的函数，2）它*可能*很难正确修复（例如修复会引入它们自己的错误）。

最终，指标最好在总体水平上使用——比如控制图。您寻找控制限上下的点以识别*可能*的特殊情况，然后查看详细信息。例如，具有高圈复杂度的函数可能会导致您查看它，只是发现它是合适的，因为它是具有多种情况的调度程序方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T20:55:06.263

指标管理不适用于人员或代码；没有任何指标或绝对值将始终有效。请不要让对指标的迷恋分散了对代码质量的真正评估。指标似乎可以告诉您有关代码的重要信息，但它们能做的最好的事情就是提示要调查的区域。

这并不是说指标没有用。*指标在变化时*最有用，可用于寻找可能以意想不到的方式变化的区域。例如，如果您突然从 3 级继承变为 15，或者每个方法的 4 个参数变为 12，请深入挖掘并找出原因。

示例：更新数据库表的存储过程可能具有与表中的列一样多的参数；此过程的对象接口可能具有相同的接口，或者如果存在表示数据实体的对象，则它可能具有一个接口。但是数据实体的构造函数可能具有所有这些参数。那么这个指标会告诉你什么？不多！而且，如果您在代码库中有足够多的此类情况，那么目标平均值将被吹得水泄不通。

所以不要依赖指标作为*任何事物*的绝对指标；没有什么可以替代阅读/审查代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T20:48:53.467

就我个人而言，我认为很难遵守这些类型的要求（即，有时你真的需要一个超过 20 行的方法），但本着你的问题的精神，我会提到一篇名为*Object的文章中使用的一些指导方针健美操*（如果您有兴趣，请参阅[Thoughtworks Anthology](https://rads.stackoverflow.com/amzn/click/com/193435614X)的一部分）。

*   每种方法的缩进级别 (<2)
*   每行的“点”数（<2）
*   每类的行数（<50）
*   每个包的类数（<10）
*   每个类的实例方差数 (<3)

他还主张不要使用“else”关键字，也不要使用任何 getter 或 setter，但我认为这有点过火了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T20:43:39.717

OO Metrics 对我来说有点像一个宠物项目（这是我硕士论文的主题）。所以是的，我正在使用这些，我使用自己的工具。

多年来，Mark Lorenz 的《面向对象的软件度量》一书是 OO 度量的最佳资源。但是最近我看到了更多的资源。

不幸的是，我还有其他截止日期，所以没有时间使用该工具。但最终我会添加新的指标（和新的语言结构）。

**更新** 我们现在正在使用该工具来检测源中可能存在的问题。我们添加的几个指标（并非都是纯 OO）：

*   断言的使用
*   魔术常数的使用
*   评论的使用，与方法的复杂性有关
*   语句嵌套级别
*   类依赖
*   一个类中的公共字段数
*   被覆盖方法的相对数量
*   goto 语句的使用

还有更多。我们保留那些能够很好地反映代码中的痛点的那些。因此，如果这些问题得到纠正，我们会有直接的反馈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T20:46:03.147

硬数字并不适用于所有解决方案。有些解决方案比其他解决方案更复杂。我会从这些作为你的指导方针开始，看看你的项目最终会在哪里结束。

但是，具体就这些数字而言，这些数字似乎很高。我通常会发现我通常拥有的特定编码风格：

*   每个方法不超过 3 个参数
*   每个方法签名约 5-10 行
*   不超过3级继承

这并不是说我从不复习这些一般性，但我通常会在这样做时更多地考虑代码，因为大多数时候我可以将事情分解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T20:54:22.800

正如其他人所说，保持严格的标准将很困难。我认为这些指标最有价值的用途之一是观察它们如何随着应用程序的发展而变化。这有助于让您了解在添加功能时完成必要的重构方面做得有多好，并有助于防止造成大混乱:)

# performance - Web 服务与常规 Http 请求

> ID：189078
> 
> 赞同：2
> 
> 时间：2008-10-09T20:29:34.333
> 
> 标签：performance, web-services

大约 5000 台计算机将调用中央服务器，并将 GUID 传递给中央服务器。

然后，服务器将 True/False 返回给客户端。

Web 服务和对服务器上 URL 的常规 Http 请求之间的**性能**有很大差异吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T21:05:44.963

是的，一个 SOAP 信封比较重。我建议使用基于 REST 的服务，它将被编组的数据大小保持在最低限度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T20:58:01.250

我假设 Web 服务是指 SOAP。我在不同平台（Java、.NET、Ruby、PHP）上使用各种 SOAP 堆栈的经验是，在这种情况下，您可能会看到处理如此简单消息的数量级差异。使用 SOAP 通常会产生大量开销，如果您要传递大消息，这可以忽略不计，但对于小消息来说却是多余的。为此使用 SOAP 就像携带一分钱的大象。在这种情况下，我只推荐一个简单的 HTTP 处理程序。

是否所有 5000 个客户端都将同时访问服务器？是否需要保证一定的响应时间？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T20:47:32.160

REST Web 服务**是**HTTP。

因此，我不明白这个问题。也许您应该提供有关协议、消息、RPC 样式还是文档样式、文档大小等方面的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T20:30:50.320

我不能 100% 确定响应时间的性能优势，但是 WebService 请求只返回真假，而不是常规的 http 请求，然后解析我猜想的响应总体上会更有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T20:43:18.113

我有一个应用程序，目前有大约 7000 台机器使用 WCF 调用 .net Web 服务。
每台机器每 15 分钟拨打一次电话。该服务获取数据并将其推送到 SQL 服务器；它安装在同一个盒子上。

现在它每天收集大约 350MB 的数据。

负载几乎没有注册，我们正在将其推广到 25,000 个客户。

我想我的观点是，除非 Web 服务器是 5 年前的 POS，否则将带有 true/false 值的 guid 传递给服务器并不是需要担心的大量负载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T20:45:14.643

我认为差异不会太大，如果有任何差异。HttpRequest 实际上可能更快，因为它在堆栈中使用了更少的层。如果您看到自己在未来扩展服务，您可能会继续使用 WebSerivce，这不是因为性能（同样，性能差异可能可以忽略不计），而是因为随着服务变得越来越复杂，WebService 将更易于维护。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T21:25:54.000

实际上它不会有太大的不同。在可能会在此请求中引入延迟的事情中，您有：

*   编译代码执行
*   网络往返
*   数据库访问（大概这就是您要检查的内容？）

即使你有一个令人眼花缭乱的网络和数据库服务器，花费在网络往返和数据库访问上的时间（可能涉及另一个网络往返）也会导致执行任何 Web 服务框架的编译代码的开销你用微不足道的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-09T21:14:53.557

SOAP 和 REST Web 服务意味着一些开销，但如果您认为需要扩展以返回除 true/false 之外的其他信息，那么肯定是可行的方法。

只有 1/0 或 true/false 的 HTTP 响应会小得多，因此理论上更快。

# javascript - jQuery动画

> ID：189079
> 
> 赞同：1
> 
> 时间：2008-10-09T20:29:56.423
> 
> 标签：javascript, jquery, animation, user-interface

我正在尝试设置的一些动画存在一些小问题。我有几个像这样堆叠在一起的 div。

```
<div id="div1">
   Stuff...
</div>
<div id="div2">
   More Stuff...
</div> 
```

这些 div 中的每一个都有一个通过 jQuery 插件 (jquery.dropshadow.js) 应用到它的阴影。

当我使用某种动画扩展其中一个 div 时，就会出现问题。阴影不会随着 div 的大小而更新。我可以在动画的回调中重绘阴影，但看起来仍然很慢。

有没有办法可以在整个动画过程中定期更新我的阴影状态，或者任何人都可以推荐一个更好的阴影库来解决这个问题？它不一定是 jQuery 插件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T04:48:16.167

我认为做到这一点的唯一方法（至少使用那个特定的阴影插件）将在你的动画中同时定位你想要的元素**和**所有的阴影“幻影”元素。因此，例如：

```
 <style type="text/css">
            #div1 { width: 50px; }
    </style>

    <div id="div1">
            <p>Here is a lot of stuff. Stuff stuff stuff.</p>
</div>

<script type="text/javascript">
    $(document).ready(function() {
            $("#div1").dropShadow();
            $("#div1").click(function() {
                    $("#div1, #div1 + .dropShadow .dropShadow").animate({ width: "400px" }, 1500);
            });
    });
    </script> 
```

这是基于阴影插件生成的渲染代码的结构......原始元素的所有模糊副本都得到一个*.dropShadow*类并被分组到一个容器元素中，该容器元素也有一个*.dropShadow*类和在原始元素之后立即卡在文档中（因此是*+*选择器）。

只要你对所有这些阴影元素应用你正在做的任何动画，它们都会被动画化（但是，从所有的处理来看，它*有点*生涩...... uffda）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T13:27:55.140

我建议您使用**CSS**作为阴影，而**不是 JS**。

I have dealt with this exact problem in the past and I have completely stopped using JS for drop shadows. I have never seen animations with JS shadows look as smooth as pure CSS. Also, using too much JS to alter the page elements can cause performance issues.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T23:03:40.230

尝试对阴影元素应用相同的动画效果。我不知道 jquery.dropshadow.js 中使用的确切技术，但我怀疑它会创建阴影投射元素的副本并设置它们的样式以实现类似阴影的外观。这些副本可能是其源元素的兄弟，因此不要“跟随”动画（就像子元素那样）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T22:27:02.973

好吧，我还是不知道你是怎么做动画的，但我再举一个例子：

```
$('#foo').slideToggle().ready(function(){
  $('#foo').dropShadow(options); 
}); 
```

所以，而不是，只*使用*你得到的`slideToggle`任何动画。

 *希望有帮助。

# python - 我如何在 python 中一次干净地迭代多个 2d 列表？

> ID：189087
> 
> 赞同：23
> 
> 时间：2008-10-09T20:32:13.657
> 
> 标签：python

例如，如果我正在制作一个简单的基于网格的游戏，我可能会有一些 2d 列表。一个可能用于地形，另一个可能用于对象等。不幸的是，当我需要遍历列表并让一个列表中的正方形的内容影响另一个列表的一部分时，我必须做这样的事情。

```
for i in range(len(alist)):
    for j in range(len(alist[i])):
        if alist[i][j].isWhatever:
            blist[i][j].doSomething() 
```

有没有更好的方法来做这样的事情？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-09T22:49:19.700

如果有人对上述解决方案的性能感兴趣，这里它们适用于 4000x4000 网格，从最快到最慢：

*   [布赖恩](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189111)：1.08s（修改，用`izip`代替`zip`）
*   [约翰](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189270)：2.33s
*   [DzinX](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189234) : 2.36s
*   [ΤZΩΤZΙΟΥ](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189348)：2.41s（但对象初始化花了 62s）
*   [尤金](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly)：3.17s
*   [罗伯特](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189165)：4.56s
*   [布赖恩](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189111)：27.24s（原始，带`zip`）

**编辑**：通过修改添加了布赖恩的分数，`izip`它赢了很多！

John 的解决方案也非常快，尽管它使用索引（看到这一点我真的很惊讶！），而 Robert 和 Brian 的（带`zip`）比问题创建者的初始解决方案慢。

因此，让我们介绍[Brian](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189111)的获胜函数，因为它在此线程中的任何地方都没有以正确的形式显示：

```
from itertools import izip
for a_row,b_row in izip(alist, blist):
    for a_item, b_item in izip(a_row,b_row):
        if a_item.isWhatever:
            b_item.doSomething() 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-09T20:51:33.320

我将从编写生成器方法开始：

```
def grid_objects(alist, blist):
    for i in range(len(alist)):
        for j in range(len(alist[i])):
            yield(alist[i][j], blist[i][j]) 
```

然后，每当您需要遍历列表时，您的代码如下所示：

```
for (a, b) in grid_objects(alist, blist):
    if a.is_whatever():
        b.do_something() 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-09T20:39:29.540

你可以把它们拉上拉链。IE：

```
for a_row,b_row in zip(alist, blist):
    for a_item, b_item in zip(a_row,b_row):
        if a_item.isWhatever:
            b_item.doSomething() 
```

但是，如果您很少实际使用 b_item（即 a_item.isWhatever 通常为 False），则压缩和迭代项目的开销可能会高于您的原始方法。您可以使用 itertools.izip 而不是 zip 来减少对内存的影响，但它仍然可能会稍微慢一些，除非您总是需要 b_item。

或者，考虑使用 3D 列表，因此单元格 i,j 的地形位于 l[i][j][0]，对象位于 l[i][j][1] 等，或者甚至组合对象以便您可以做 a[i][j].terrain、a[i][j].object 等。

[编辑] [DzinX 的计时](https://stackoverflow.com/questions/189087/how-can-i-in-python-iterate-over-multiple-2d-lists-at-once-cleanly#189497)实际上表明，对 b_item 进行额外检查的影响并不显着，仅次于按索引重新查找的性能损失，因此上述（使用 izip）似乎是最快的。

我现在也对 3d 方法进行了快速测试，而且它似乎更快，所以如果你可以以这种形式存储数据，它可以更简单、更快速地访问。这是一个使用它的例子：

```
# Initialise 3d list:
alist = [ [[A(a_args), B(b_args)] for i in xrange(WIDTH)] for j in xrange(HEIGHT)]

# Process it:
for row in xlist:
    for a,b in row:
        if a.isWhatever(): 
            b.doSomething() 
```

这是我使用 1000x1000 数组进行 10 次循环的时间安排，isWhatever 的不同比例为：

```
 ( Chance isWhatever is True )
Method      100%     50%      10%      1%

3d          3.422    2.151    1.067    0.824
izip        3.647    2.383    1.282    0.985
original    5.422    3.426    1.891    1.534 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-10T11:30:37.337

当您使用数字网格并想要非常好的性能时，您应该考虑使用[Numpy](http://numpy.scipy.org)。它使用起来非常简单，让您可以考虑使用网格而不是网格上的循环来进行操作。性能来自这样一个事实，即这些操作随后使用优化的 SSE 代码在整个网格上运行。

例如，这里有一些 numpy 使用我编写的代码，它对通过弹簧连接的带电粒子进行蛮力数值模拟。此代码在 31 毫秒内计算具有 100 个节点和 99 条边的 3d 系统的时间步长。这比我能想到的最好的纯 python 代码快 10 倍以上。

```
from numpy import array, sqrt, float32, newaxis
def evolve(points, velocities, edges, timestep=0.01, charge=0.1, mass=1., edgelen=0.5, dampen=0.95):
    """Evolve a n body system of electrostatically repulsive nodes connected by
       springs by one timestep."""
    velocities *= dampen

    # calculate matrix of distance vectors between all points and their lengths squared
    dists = array([[p2 - p1 for p2 in points] for p1 in points])
    l_2 = (dists*dists).sum(axis=2)

    # make the diagonal 1's to avoid division by zero
    for i in xrange(points.shape[0]):
        l_2[i,i] = 1

    l_2_inv = 1/l_2
    l_3_inv = l_2_inv*sqrt(l_2_inv)

    # repulsive force: distance vectors divided by length cubed, summed and multiplied by scale
    scale = timestep*charge*charge/mass
    velocities -= scale*(l_3_inv[:,:,newaxis].repeat(points.shape[1], axis=2)*dists).sum(axis=1)

    # calculate spring contributions for each point
    for idx, (point, outedges) in enumerate(izip(points, edges)):
        edgevecs = point - points.take(outedges, axis=0)
        edgevec_lens = sqrt((edgevecs*edgevecs).sum(axis=1))
        scale = timestep/mass
        velocities[idx] += (edgevecs*((((edgelen*scale)/edgevec_lens - scale))[:,newaxis].repeat(points.shape[1],axis=1))).sum(axis=0)

    # move points to new positions
    points += velocities*timestep 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T21:12:10.020

[生成器表达式](http://www.python.org/doc/2.5.2/ref/genexpr.html)和`izip`来自[itertools 模块](http://www.python.org/doc/2.5.2/lib/itertools-functions.html)将在这里做得很好：

```
from itertools import izip
for a, b in (pair for (aline, bline) in izip(alist, blist) 
             for pair in izip(aline, bline)):
    if a.isWhatever:
        b.doSomething() 
```

上面语句中的行`for`表示：

*   从组合网格中取出每一行，`alist`并`blist`从中制作一个元组`(aline, bline)`
*   现在将这些列表与`izip`再次组合并从中获取每个元素（`pair`）。

这种方法有两个优点：

*   任何地方都没有使用索引
*   您不必创建列表`zip`并使用更高效的生成器来`izip`代替。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-09T21:24:17.903

作为一个轻微的风格变化，你可以使用枚举：

```
for i, arow in enumerate(alist):
    for j, aval in enumerate(arow):
        if aval.isWhatever():
            blist[i][j].doSomething() 
```

我认为除非您按照 Federico 的建议重新排列数据结构，否则您不会得到任何简单得多的东西。这样你就可以把最后一行变成像“aval.b.doSomething()”这样的东西。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T20:39:35.640

您确定您正在并行迭代的两个矩阵中的对象是概念上不同类的实例吗？如果合并两个类，最终得到一个包含 isWhatever() 和 doSomething() 的对象矩阵，该*怎么*办？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T21:53:23.820

如果两个 2D 列表在游戏的生命周期中保持不变，*并且*您无法享受 Python 的多重继承来加入 alist[i][j] 和 blist[i][j] 对象类（正如其他人所建议的那样），创建列表后，您可以在每个*a*项中添加一个指向相应*b*项的指针，如下所示：

 *```
for a_row, b_row  in itertools.izip(alist, blist):
    for a_item, b_item in itertools.izip(a_row, b_row):
        a_item.b_item= b_item 
```

各种优化可以在这里应用，比如你的类已经`__slots__`定义，或者上面的初始化代码可以与你自己的初始化代码合并等等之后，你的循环将变成：

```
for a_row in alist:
    for a_item in a_row:
        if a_item.isWhatever():
            a_item.b_item.doSomething() 
```

那应该更有效率。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-11T07:49:43.713

如果`a.isWhatever`很少是真的，你可以建立一个“索引”一次：

```
a_index = set((i,j) 
              for i,arow in enumerate(a) 
              for j,a in enumerate(arow) 
              if a.IsWhatever()) 
```

每次你想做某事时：

```
for (i,j) in a_index:
    b[i][j].doSomething() 
```

如果随着时间的推移发生变化，那么您将需要使索引保持最新。这就是我使用集合的原因，因此可以快速添加和删除项目。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2008-10-09T20:35:28.113

```
for d1 in alist
   for d2 in d1
      if d2 = "whatever"
          do_my_thing() 
```

# java - 如何扫描Java中的文件夹？

> ID：189094
> 
> 赞同：62
> 
> 时间：2008-10-09T20:34:40.750
> 
> 标签：java, file, directory

如何在Java中递归地列出文件夹中的所有文件？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-10T00:45:14.347

不确定要如何表示树？无论如何，这是一个使用递归扫描整个子树的示例。文件和目录被同等对待。请注意，[File.listFiles()](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#listFiles%28%29)为非目录返回 null。

```
public static void main(String[] args) {
    Collection<File> all = new ArrayList<File>();
    addTree(new File("."), all);
    System.out.println(all);
}

static void addTree(File file, Collection<File> all) {
    File[] children = file.listFiles();
    if (children != null) {
        for (File child : children) {
            all.add(child);
            addTree(child, all);
        }
    }
} 
```

Java 7 提供了一些改进。例如，[DirectoryStream](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#newDirectoryStream%28java.nio.file.Path%29)一次提供一个结果 - 调用者不再需要等待所有 I/O 操作完成后再执行操作。这允许增量 GUI 更新、提前取消等。

```
static void addTree(Path directory, Collection<Path> all)
        throws IOException {
    try (DirectoryStream<Path> ds = Files.newDirectoryStream(directory)) {
        for (Path child : ds) {
            all.add(child);
            if (Files.isDirectory(child)) {
                addTree(child, all);
            }
        }
    }
} 
```

请注意，可怕的 null 返回值已被 IOException 取代。

Java 7 还提供了一个[tree walker](http://docs.oracle.com/javase/tutorial/essential/io/walk.html)：

```
static void addTree(Path directory, final Collection<Path> all)
        throws IOException {
    Files.walkFileTree(directory, new SimpleFileVisitor<Path>() {
        @Override
        public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
                throws IOException {
            all.add(file);
            return FileVisitResult.CONTINUE;
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-09T20:38:21.367

```
import java.io.File;
public class Test {
    public static void main( String [] args ) {
        File actual = new File(".");
        for( File f : actual.listFiles()){
            System.out.println( f.getName() );
        }
    }
} 
```

它模糊地显示文件和文件夹。

请参阅 File 类中的方法对它们进行排序或避免目录打印等。

[http://java.sun.com/javase/6/docs/api/java/io/File.html](http://java.sun.com/javase/6/docs/api/java/io/File.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-10T15:54:32.597

您还可以使用该[`FileFilter`](http://java.sun.com/javase/6/docs/api/java/io/FileFilter.html "http://java.sun.com/javase/6/docs/api/java/io/FileFilter.html")界面过滤掉您想要的内容。当您创建实现它的匿名类时最好使用它：

```
import java.io.File;
import java.io.FileFilter;

public class ListFiles {
    public File[] findDirectories(File root) { 
        return root.listFiles(new FileFilter() {
            public boolean accept(File f) {
                return f.isDirectory();
            }});
    }

    public File[] findFiles(File root) {
        return root.listFiles(new FileFilter() {
            public boolean accept(File f) {
                return f.isFile();
            }});
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-27T11:21:05.983

```
public static void directory(File dir) {
    File[] files = dir.listFiles();
    for (File file : files) {
        System.out.println(file.getAbsolutePath());
        if (file.listFiles() != null)
            directory(file);        
    }
} 
```

这`dir`是要扫描的目录。例如`c:\`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T10:06:43.620

可视化树结构对我来说是最方便的方法：

```
public static void main(String[] args) throws IOException {
    printTree(0, new File("START/FROM/DIR"));
}

static void printTree(int depth, File file) throws IOException { 
    StringBuilder indent = new StringBuilder();
    String name = file.getName();

    for (int i = 0; i < depth; i++) {
        indent.append(".");
    }

    //Pretty print for directories
    if (file.isDirectory()) { 
        System.out.println(indent.toString() + "|");
        if(isPrintName(name)){
            System.out.println(indent.toString() + "*" + file.getName() + "*");
        }
    }
    //Print file name
    else if(isPrintName(name)) {
        System.out.println(indent.toString() + file.getName()); 
    }
    //Recurse children
    if (file.isDirectory()) { 
        File[] files = file.listFiles(); 
        for (int i = 0; i < files.length; i++){
            printTree(depth + 4, files[i]);
        } 
    }
}

//Exclude some file names
static boolean isPrintName(String name){
    if (name.charAt(0) == '.') {
        return false;
    }
    if (name.contains("svn")) {
        return false;
    }
    //.
    //. Some more exclusions
    //.
    return true;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T08:13:16.987

在 JDK7 中，“更多 NIO 特性”应该具有将访问者模式应用于文件树或仅目录的直接内容的方法 - 无需在迭代之前在潜在的巨大目录中查找所有文件。

# json - 如何从 Flickr API 获取照片 ID？

> ID：189110
> 
> 赞同：1
> 
> 时间：2008-10-09T20:39:19.710
> 
> 标签：json, jsonp, flickr

我正在尝试使用 JQUERY 从 Flickr 组中获取照片。我可以取回有效的 JSON，但不知道如何访问实际照片。返回的 JSON 包含一个空列表，我希望在其中有照片。

因此，当我将其插入浏览器时：

```
http://api.flickr.com/services/rest?method=flickr.groups.pools.getPhotos&api_key=2c4df0060561b03151cda6a1xxxx&format=json&group_id=919043@N22&jsoncallback=? 
```

我回来的json是这样的：

```
 jsonFlickrApi({"photos":{"page":1, "pages":1, "perpage":100, "total":"6", "photo":[]}, "stat":"ok"}) 
```

它似乎知道有六张照片，但照片列表是空的。我假设我错过了一步。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T05:16:26.503

我刚刚将相同的 url 粘贴到 Firefox 中（使用我自己的 Flickr api 密钥），它运行良好，我得到（匿名）：

```
jsonFlickrApi(
  {"photos": {"page":1, "pages":1, "perpage":100, "total":"6", "photo":
   [{"id": "292744xxxx", "owner":"11363xxx@xxx", "secret":"f084efxxxx",
     "server":"3xxx", "farm":4, "title":"Pink Floyd", "ispublic":1,
     "isfriend":0, "isfamily":0, "ownername":"moexxxxx", "dateadded":"122358xxxx"},
   {"id":
    ...
   }
    ...
  },
  "stat":"ok"}) 
```

# php - 如何在 Windows/IIS 服务器上获取当前页面的完整 URL？

> ID：189113
> 
> 赞同：137
> 
> 时间：2008-10-09T20:39:49.960
> 
> 标签：php, iis

我将[WordPress](http://en.wikipedia.org/wiki/WordPress)安装移动到 Windows/ [IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)服务器上的新文件夹中。我在 PHP 中设置了 301 重定向，但它似乎不起作用。我的帖子 URL 具有以下格式：

```
http:://www.example.com/OLD_FOLDER/index.php/post-title/ 
```

我不知道如何获取`/post-title/`URL 的一部分。

`$_SERVER["REQUEST_URI"]`- 每个人似乎都推荐 - 返回一个空字符串。`$_SERVER["PHP_SELF"]`刚回来`index.php`。为什么会这样，我该如何解决？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-10-09T20:42:19.533

也许，因为你在 IIS 下，

```
$_SERVER['PATH_INFO'] 
```

是你想要的，基于你用来解释的 URL。

对于 Apache，您将使用`$_SERVER['REQUEST_URI']`.

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-08-04T21:01:03.097

```
$pageURL = (@$_SERVER["HTTPS"] == "on") ? "https://" : "http://";
if ($_SERVER["SERVER_PORT"] != "80")
{
    $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
} 
else 
{
    $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
}
return $pageURL; 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2012-04-13T00:00:41.287

## 对于阿帕奇：

```
'http'.(empty($_SERVER['HTTPS'])?'':'s').'://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'] 
```

您也可以使用`HTTP_HOST`而不是`SERVER_NAME`Herman 评论的那样。有关完整讨论，请参阅[此相关问题](https://stackoverflow.com/questions/1459739/php-serverhttp-host-vs-serverserver-name-am-i-understanding-the-ma)。简而言之，您可能都可以使用其中任何一个。这是“主机”版本：

```
'http'.(empty($_SERVER['HTTPS'])?'':'s').'://'.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'] 
```

### 对于偏执狂/为什么重要

通常，我设置`ServerName`为`VirtualHost`因为我希望*它*成为网站的[规范](http://en.wikipedia.org/wiki/Canonical_link_element)形式。是根据`$_SERVER['HTTP_HOST']`请求标头设置的。如果服务器响应该 IP 地址上的任何/所有域名，用户可能会欺骗标头，或者更糟糕的是，有人可能会将 DNS 记录指向您的 IP 地址，然后您的服务器/网站将提供一个动态的网站建立在错误 URL 上的链接。如果您使用后一种方法，您还应该配置`vhost`或设置`.htaccess`规则以强制执行您要提供的域，例如：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !(^stackoverflow.com*)$
RewriteRule (.*) https://stackoverflow.com/$1 [R=301,L]
#sometimes u may need to omit this slash ^ depending on your server 
```

希望有帮助。这个答案的真正意义只是为那些在寻找使用 apache 获取完整 URL 的方法时最终来到这里的人提供第一行代码:)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-09T20:42:05.430

`$_SERVER['REQUEST_URI']`在 IIS 上不起作用，但我确实发现了这个：[http://neosmart.net/blog/2006/100-apache-compliant-request_uri-for-iis-and-windows/](http://neosmart.net/blog/2006/100-apache-compliant-request_uri-for-iis-and-windows/)这听起来很有希望。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-12-19T17:07:54.807

使用此类来获取 URL 工作。

```
class VirtualDirectory
{
    var $protocol;
    var $site;
    var $thisfile;
    var $real_directories;
    var $num_of_real_directories;
    var $virtual_directories = array();
    var $num_of_virtual_directories = array();
    var $baseURL;
    var $thisURL;

    function VirtualDirectory()
    {
        $this->protocol = $_SERVER['HTTPS'] == 'on' ? 'https' : 'http';
        $this->site = $this->protocol . '://' . $_SERVER['HTTP_HOST'];
        $this->thisfile = basename($_SERVER['SCRIPT_FILENAME']);
        $this->real_directories = $this->cleanUp(explode("/", str_replace($this->thisfile, "", $_SERVER['PHP_SELF'])));
        $this->num_of_real_directories = count($this->real_directories);
        $this->virtual_directories = array_diff($this->cleanUp(explode("/", str_replace($this->thisfile, "", $_SERVER['REQUEST_URI']))),$this->real_directories);
        $this->num_of_virtual_directories = count($this->virtual_directories);
        $this->baseURL = $this->site . "/" . implode("/", $this->real_directories) . "/";
        $this->thisURL = $this->baseURL . implode("/", $this->virtual_directories) . "/";
    }

    function cleanUp($array)
    {
        $cleaned_array = array();
        foreach($array as $key => $value)
        {
            $qpos = strpos($value, "?");
            if($qpos !== false)
            {
                break;
            }
            if($key != "" && $value != "")
            {
                $cleaned_array[] = $value;
            }
        }
        return $cleaned_array;
    }
}

$virdir = new VirtualDirectory();
echo $virdir->thisURL; 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-10-10T14:25:07.427

添加：

```
function my_url(){
    $url = (!empty($_SERVER['HTTPS'])) ?
               "https://".$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'] :
               "http://".$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];
    echo $url;
} 
```

然后只需调用该`my_url`函数。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-08-04T20:41:45.177

我使用以下函数来获取当前的完整 URL。这应该适用于 IIS 和 Apache。

```
function get_current_url() {

  $protocol = 'http';
  if ($_SERVER['SERVER_PORT'] == 443 || (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] == 'on')) {
    $protocol .= 's';
    $protocol_port = $_SERVER['SERVER_PORT'];
  } else {
    $protocol_port = 80;
  }

  $host = $_SERVER['HTTP_HOST'];
  $port = $_SERVER['SERVER_PORT'];
  $request = $_SERVER['PHP_SELF'];
  $query = isset($_SERVER['argv']) ? substr($_SERVER['argv'][0], strpos($_SERVER['argv'][0], ';') + 1) : '';

  $toret = $protocol . '://' . $host . ($port == $protocol_port ? '' : ':' . $port) . $request . (empty($query) ? '' : '?' . $query);

  return $toret;
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-09T20:48:15.013

REQUEST_URI 由 Apache 设置，因此您不会通过 IIS 获得它。尝试在 $_SERVER 上执行 var_dump 或 print_r 并查看可以使用的值。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-10T10:41:37.997

[URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)的 posttitle 部分位于您的`index.php`文件之后，这是一种无需使用 mod_rewrite 即可提供友好 URL 的常用方法。因此，posttitle 实际上是查询字符串的一部分，因此您应该能够使用 $_SERVER['QUERY_STRING']

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-05-14T07:10:18.517

在您正在使用的 PHP 页面顶部使用以下行`$_SERVER['REQUEST_URI']`。这将解决您的问题。

```
$_SERVER['REQUEST_URI'] = $_SERVER['PHP_SELF'] . '?' . $_SERVER['argv'][0]; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-11-21T14:33:25.310

哦，片段的乐趣！

```
if (!function_exists('base_url')) {
    function base_url($atRoot=FALSE, $atCore=FALSE, $parse=FALSE){
        if (isset($_SERVER['HTTP_HOST'])) {
            $http = isset($_SERVER['HTTPS']) && strtolower($_SERVER['HTTPS']) !== 'off' ? 'https' : 'http';
            $hostname = $_SERVER['HTTP_HOST'];
            $dir =  str_replace(basename($_SERVER['SCRIPT_NAME']), '', $_SERVER['SCRIPT_NAME']);

            $core = preg_split('@/@', str_replace($_SERVER['DOCUMENT_ROOT'], '', realpath(dirname(__FILE__))), NULL, PREG_SPLIT_NO_EMPTY);
            $core = $core[0];

            $tmplt = $atRoot ? ($atCore ? "%s://%s/%s/" : "%s://%s/") : ($atCore ? "%s://%s/%s/" : "%s://%s%s");
            $end = $atRoot ? ($atCore ? $core : $hostname) : ($atCore ? $core : $dir);
            $base_url = sprintf( $tmplt, $http, $hostname, $end );
        }
        else $base_url = 'http://localhost/';

        if ($parse) {
            $base_url = parse_url($base_url);
            if (isset($base_url['path'])) if ($base_url['path'] == '/') $base_url['path'] = '';
        }

        return $base_url;
    }
} 
```

它有美丽的回报，如：

```
// A URL like http://stackoverflow.com/questions/189113/how-do-i-get-current-page-full-url-in-php-on-a-windows-iis-server:

echo base_url();    // Will produce something like: http://stackoverflow.com/questions/189113/
echo base_url(TRUE);    // Will produce something like: http://stackoverflow.com/
echo base_url(TRUE, TRUE); || echo base_url(NULL, TRUE); //Will produce something like: http://stackoverflow.com/questions/

// And finally:
echo base_url(NULL, NULL, TRUE);
// Will produce something like:
//      array(3) {
//          ["scheme"]=>
//          string(4) "http"
//          ["host"]=>
//          string(12) "stackoverflow.com"
//          ["path"]=>
//          string(35) "/questions/189113/"
//      } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-18T08:22:07.800

我使用了以下代码，并且得到了正确的结果...

```
<?php
    function currentPageURL() {
        $curpageURL = 'http';
        if ($_SERVER["HTTPS"] == "on") {
            $curpageURL.= "s";
        }
        $curpageURL.= "://";
        if ($_SERVER["SERVER_PORT"] != "80") {
            $curpageURL.= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
        } 
        else {
            $curpageURL.= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
        }
        return $curpageURL;
    }
    echo currentPageURL();
?> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-20T21:26:50.737

每个人都忘记了[http_build_url](http://uk3.php.net/manual/en/function.http-build-url.php)吗？

```
http_build_url($_SERVER['REQUEST_URI']); 
```

当没有参数传递给`http_build_url`它时，它将自动假定当前 URL。我也希望`REQUEST_URI`包含在内，尽管似乎需要包含 GET 参数。

上面的示例将返回完整的 URL。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-12-21T01:15:40.820

在我的 apache 服务器中，这为我提供了您正在寻找的确切格式的完整 URL：

```
$_SERVER["SCRIPT_URI"] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-08-30T15:42:31.017

# 反向代理支持！

一些更强大的东西。**注意**它只适用于`5.3`或更高版本。

```
/*
 * Compatibility with multiple host headers.
 * Support of "Reverse Proxy" configurations.
 *
 * Michael Jett <mjett@mitre.org>
 */

function base_url() {

    $protocol = @$_SERVER['HTTP_X_FORWARDED_PROTO'] 
              ?: @$_SERVER['REQUEST_SCHEME']
              ?: ((isset($_SERVER["HTTPS"]) && $_SERVER["HTTPS"] == "on") ? "https" : "http");

    $port = @intval($_SERVER['HTTP_X_FORWARDED_PORT'])
          ?: @intval($_SERVER["SERVER_PORT"])
          ?: (($protocol === 'https') ? 443 : 80);

    $host = @explode(":", $_SERVER['HTTP_HOST'])[0]
          ?: @$_SERVER['SERVER_NAME']
          ?: @$_SERVER['SERVER_ADDR'];

    // Don't include port if it's 80 or 443 and the protocol matches
    $port = ($protocol === 'https' && $port === 443) || ($protocol === 'http' && $port === 80) ? '' : ':' . $port;

    return sprintf('%s://%s%s/%s', $protocol, $host, $port, @trim(reset(explode("?", $_SERVER['REQUEST_URI'])), '/'));
} 
```

# visual-studio - 您最推荐的 Visual Studio 首选项是什么？

> ID：189118
> 
> 赞同：39
> 
> 时间：2008-10-09T20:41:20.050
> 
> 标签：visual-studio, visual-studio-2008

Microsoft Visual Studio 中有很多小选项和设置。您向其他人推荐哪些调整？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-09T20:41:42.453

**行号**

*   工具 > 选项
*   文本编辑器 > 所有语言 > 常规
*   显示：行号

![Visual Studio 行号](https://i.stack.imgur.com/urAYz.png)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-03T20:32:35.337

环境->常规->动画环境工具=>关闭。

将 UI 响应速度提高 82%。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-09T20:51:23.977

我从来没有发现动态帮助是动态的或有用的，而且只会减慢视觉工作室的速度，所以使用 regedit：

```
注册表项：
    HKEY_CURRENT_USER\Software\Microsoft\Visual Studio\xx\Dynamic 帮助
价值：
    从不在 F1 上显示 DH = 是

```

我也热衷于在 Options->Projects and Solutions 中设置以下内容：

*   构建开始时显示输出窗口 - 检查（恕我直言，发现构建错误的最简单方法）
*   在解决方案资源管理器中跟踪活动项目 - 未选中（停止每个项目最终在解决方案资源管理器中完全展开） ![Visual Studio 首选项](https://i.stack.imgur.com/EoPIC.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-09T20:44:24.910

工具 -> 选项 -> 环境 -> 键盘

设置关闭活动文档的快捷方式。`Ctrl`+ `Alt`+`W`在我的情况下。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-03T21:33:06.853

**选项严格开启**

工具 > 选项

项目和解决方案 > VB 默认值

默认项目设置：选项严格：开

![期权严格](https://i.stack.imgur.com/tbY2T.gif)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-28T21:02:28.200

必须正确设置制表符缩进。

此外，Consolas 和颜色主题 - 白色背景伤害了我的眼睛

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-09T20:47:25.560

我个人讨厌当您在 C# 中开发时 VS 默认为“Tab to Spaces”。这太尴尬了，而且没有必要。

是的，我知道 Tabs 存在问题，但老实说，你们中的任何人是否曾经在 Windows 上使用 C# 编码遇到过它们？

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-28T20:53:50.713

一些人提到了自定义键绑定。以下是方便的默认键绑定参考海报……

**[Microsoft Visual Basic 默认键绑定参考海报](http://www.microsoft.com/downloads/details.aspx?familyid=255b8cf1-f6bd-4b55-bb42-dd1a69315833&displaylang=en)**

> 一个高质量、可打印的 PDF，包含有用的键绑定，供在 Visual Studio 2008 中选择 Visual Basic 开发人员配置文件或使用 Visual Basic Express 的开发人员使用。

**[Microsoft Visual C# 默认键绑定参考海报](http://www.microsoft.com/downloads/details.aspx?familyid=E5F902A8-5BB5-4CC6-907E-472809749973&displaylang=en)**

> Visual Studio 2008 和 Visual C# 2008 Express Edition 中的 Visual C# 挂图显示了 Visual C# 编程语言的有用键盘快捷键。

我喜欢微软的**说明**：

> 1.  下载并提取 PDF
> 2.  发送到最喜欢的全彩打印机/复印机
> 3.  挂在墙上
> 4.  代码
> 5.  微笑

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-27T18:23:38.677

可见的空白区域。（编辑->高级->查看空白）

[![由 FreeImageHosting.net 提供的免费图像托管](https://i.stack.imgur.com/S8bsi.jpg)](https://www.freeimagehosting.net/)

默认颜色太浓。我立即将其更改为银色。（工具 -> 选项 -> 字体和颜色 -> 可见空白）。

[![银色可见白色空间](https://i.stack.imgur.com/8LheF.jpg)](https://www.freeimagehosting.net/)

在某些显示器上，即使是银色也太强了，我创造了一种“浅银色”。

[![由 FreeImageHosting.net 提供的免费图像托管](https://i.stack.imgur.com/waxPw.jpg)](https://www.freeimagehosting.net/)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-27T18:32:53.230

**窗口布局**

这真的不是一个设置，但我总是通过**Tools > Import and Export Settings**备份我的设置。

我确保为单个和多个监视器备份我的窗口布局。当从我的多显示器设置转移到单个显示器进行演示时，它可以避免沮丧。

更不用说，它使在新 PC 上启动和运行变得容易。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-27T17:47:12.213

防止 Visual Studio 重命名粘贴的控件

[如何防止 Visual Studio 重命名我的控件？](https://stackoverflow.com/questions/484327/how-do-i-prevent-visual-studio-from-renaming-my-controls#484344)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-11-03T20:38:42.220

环境 => 常规 => 最近的文件

窗口菜单中显示 24 项

最近使用列表中显示 24 项

环境 => 一般

打开状态栏

动画环境工具关闭

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-28T21:16:54.957

将您正在处理的活动文档设置为在解决方案资源管理器中显示。如果项目太大，我见过很多人在寻找他们当前的文档。

工具 -> 选项。 **确保选中显示所有设置。**

单击项目和解决方案。
启用在资源管理器中跟踪活动项目复选框。

[替代文字 http://img370.imageshack.us/img370/4821/trackactivedocumentqv2.gif](http://img370.imageshack.us/img370/4821/trackactivedocumentqv2.gif)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-09T20:43:46.630

**Fixedsys 字体**

工具 > 选项

环境 > 字体和颜色

字体：Fixedsys

![Visual Studio 字体](https://i.stack.imgur.com/AC1z1.gif)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-01-27T18:00:18.147

我有点惊讶地成为第一个推荐[Visual Studio Hacks](http://visualstudiohacks.com/)的人，因为有很多这样的建议

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-11-03T20:12:17.640

**始终显示解决方案**

工具 > 选项

项目和解决方案

始终显示解决方案

![始终显示解决方案](https://i.stack.imgur.com/IZTtm.gif)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-09T20:42:58.580

**源视图**

工具 > 选项

HTML 设计器 > 常规

起始页：源视图

![源视图中的 Visual Studio 起始页](https://i.stack.imgur.com/Qg8Pt.gif)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-09T20:43:32.013

查看此线程以了解 Visual Studio 的颜色主题选项 [https://stackoverflow.com/questions/141371/which-visual-studio-color-theme](https://stackoverflow.com/questions/141371/which-visual-studio-color-theme)

consolas 是我最喜欢的字体

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-11-03T21:42:34.167

这适用于 winform 项目。

不用默认在设计模式下打开表单，您可以配置 VS 改为打开代码编辑器。这是通过右键单击解决方案资源管理器中的表单并选择“打开方式”选项来配置的。这为您提供了一个对话框，允许您在双击文件时指定默认选项。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-03-27T15:42:13.597

在控件的属性中，将不需要的项目（标签等）的**GenerateMembers 设置为 false 。**它不是专门针对 Visual-Studio 的东西，与平台更相关，但与对象和函数的上下文列表混合在一起，它只是清除了很多混乱。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2010-04-22T13:27:27.897

设计表格时：

视图 > 标签顺序

允许您轻松指定和控制您的 TabIndexes（比手动设置它们更重要！）

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-27T18:53:37.930

查找和替换窗口的“搜索隐藏文本”复选框。

这不是一个真正的偏好，但它是必不可少的。当您没有注意到它“神奇地”未经检查时，这确实令人沮丧。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-27T17:54:38.190

**非粗体大括号匹配**

工具 > 选项

环境 > 字体和颜色

显示项目：大括号匹配（高亮）

取消选中粗体

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-11-03T20:18:02.683

这都是关于[Resharper](http://www.jetbrains.com/resharper/)的；) 为您提供了大量的快捷方式，这些快捷方式非常有用，没有它们我将无法工作。不过，我不使用智能感知，所以我把它关掉了。

[这](http://blog.jpboodhoo.com/BDDAutoHotKeyScriptUpdateTake2.aspx)非常有用，允许您在编写长测试方法名称时使用空格键编写下划线。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-09T20:54:15.873

此外，行号，我总是在新安装的 IDE 中做的第一件事就是设置**`Edit.GoToDefinition`**键盘快捷键。

工具 > 选项 > 键盘

# c# - MVP依赖注入

> ID：189121
> 
> 赞同：13
> 
> 时间：2008-10-09T20:41:52.873
> 
> 标签：c#, winforms, mvp

使用MVP，构造和依赖注入的正常顺序是什么。

通常，您为每个视图创建一个演示者，并将视图传递给构造函数的演示者。但是如果你有：

1.  多个视图需要监听事件的服务。
2.  多个视图都指向同一个数据模型缓存。

有人可以显示从用户点击到从服务器返回服务的数据的正常信息流吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-10T13:09:09.093

这是我所做的：

首先，我定义了这些接口：

```
public interface IView<TPresenter>
{
    TPresenter Presenter { get; set; }
}

public interface IPresenter<TView, TPresenter>
    where TView : IView<TPresenter>
    where TPresenter : IPresenter<TView, TPresenter>
{
    TView View { get; set; }
} 
```

然后这个抽象演示者类：

```
public abstract class AbstractPresenter<TView, TPresenter> : IPresenter<TView, TPresenter>
    where TView : IView<TPresenter>
    where TPresenter : class, IPresenter<TView, TPresenter>
{
    protected TView view;

    public TView View
    {
        get { return this.view; }
        set
        {
            this.view = value;
            this.view.Presenter = this as TPresenter;
        }
    }
} 
```

视图是通过属性而不是构造函数注入的，以允许设置器中的双向影响。请注意，需要一个安全的演员表...

然后，我的具体演示者是这样的：

```
public class MyPresenter : AbstractPresenter<IMyView, MyPresenter>
{
    //...
} 
```

在哪里`IMyView`实现`IView`。必须存在一个具体的视图类型（例如`MyView`），但它是解决它的容器：

1.  我`MyPresenter`在容器中将类型注册为自身，具有瞬态行为。
2.  我在具有瞬态行为的容器中注册`MyView`为一个。`IMyView`
3.  然后我要求一个`MyPresenter`容器。
4.  容器实例化一个 MyView
5.  它实例化了一个`MyPresenter`
6.  `AbstractPresenter.View`它通过属性将视图注入到演示者中。
7.  setter代码完成双向关联
8.  容器返回一对 Presenter/View

**它允许您将其他依赖项（服务、repos）注入您的视图和演示者。**但是在您描述的场景中，我建议您将服务和缓存注入到**Presenter**中，而不是视图中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-10T17:55:10.280

在 WinForms 中，我更喜欢一种简单的方法。通常你在设计表面上处理一些用户控件——让这些成为你的视图类。.NET 为您创建控制层次结构（通过 InitializeComponent）。如果您使用[被动视图](http://martinfowler.com/eaaDev/PassiveScreen.html)模式，则每个视图都会实例化它的演示者。（您可以直接执行此操作，也可以通过询问 IOC 容器来执行此操作。）使用构造函数注入将对视图接口的引用传递给演示者的构造函数。然后，演示者可以自行连接以查看事件。对模型重复这个过程：演示者实例化一个模型并连接到它的事件。（在这种情况下，您不需要构造函数注入，因为 Passive View 表示演示者保留对模型的引用，反之亦然。）

我发现这种方法的唯一缺点是正确管理模型和演示者的生命周期。您希望使视图尽可能简单，因此您可能不希望它保持对演示者的引用。但是，这意味着您已经让这个演示者对象与绑定到您的视图的事件处理程序一起徘徊。此设置可防止您的视图被垃圾收集。一种解决方案是让您的视图发布一个表明它正在关闭的事件。演示者将收到该事件并删除其模型和视图订阅。Web 中的对象现在已正确取消引用，垃圾收集器可以继续其工作。

您最终会得到以下内容：

```
public interface IView
{
   ...
   event Action SomeEvent;
   event EventHandler Disposed;
   ...
}

// Note that the IView.Disposed event is implemented by the 
// UserControl.Disposed event. 
public class View : UserControl, IView
{
   public event Action SomeEvent;

   public View()
   {
      var presenter = new Presenter(this);
   }
}

public interface IModel
{
   ...
   event Action ModelChanged;
   ...
}

public class Model : IModel
{
   ...
   public event Action ModelChanged;
   ...
}

public class Presenter
{
   private IView MyView;
   private IModel MyModel;

   public Presenter(View view)
   {
      MyView = view;
      MyView.SomeEvent += RespondToSomeEvent;
      MyView.Disposed += ViewDisposed;

      MyModel = new Model();
      MyModel.ModelChanged += RespondToModelChanged;
   }

   // You could take this a step further by implementing IDisposable on the
   // presenter and having View.Dispose() trigger Presenter.Dispose().
   private void ViewDisposed(object sender, EventArgs e)
   {
      MyView.SomeEvent -= RespondToSomeEvent;
      MyView.Disposed -= ViewDisposed;
      MyView = null;

      MyModel.Modelchanged -= RespondToModelChanged;
      MyModel = null;
   }
} 
```

您可以通过使用 IOC 并询问您的 IOC 容器以实现 IModel（在 Presenter 类中）和 IPresenter（在 View 类中）来进一步解耦这个示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-28T23:18:53.873

```
interface IEmployee
{
    int EmployeeId {get;}
    string FirstName {get;}
    string LastName {get;}
}
interface IEmployeeRepository
{
    void SaveEmployee(IEmployee employee);
    IEmployee GetEmployeeById(int employeeId);
    IEmployee[] Employees { get; }
}
interface IEmployeeView
{
    event Action<IEmployee> OnEmployeeSaved;
}

interface IEmployeeController
{
    IEmployeeView View {get;}
    IEmployeeRepository Repository {get;}
    IEmployee[] Employees {get;}        
}

partial class EmployeeView: UserControl, IEmployeeView
{
    public EmployeeView()
    {
        InitComponent();
    }
}
class EmployeeController:IEmployeeController
{
    private IEmployeeView view;
    private IEmployeeRepository repository;
    public EmployeeController(IEmployeeView view, IEmployeeRepository repository)
    {
        this.repository = repository;
        this.view = view;
        this.view.OnEmployeeSaved+=new Action<IEmployee>(view_OnEmployeeSaved);
    }

    void  view_OnEmployeeSaved(IEmployee employee)
    {
        repository.SaveEmployee(employee);
    }
    public IEmployeeView View 
    {
        get
        { 
            return view;
        }
    }
    public IEmployeeRepository Repository
    {
        get
        {
            return repository;
        }
    }

    public IEmployee[] Employees
    {
        get 
        {
            return repository.Employees;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-24T16:44:56.233

WinformsMVP 是一个非常好的 Windows 窗体 MVP 框架。使用此框架，您可以轻松地跨多个视图轻松地注入服务。[这](https://www.codeproject.com/Articles/522809/WinForms-MVP-An-MVP-Framework-for-WinForms)是一篇很好的文章，带有示例源代码，解释了如何使用该框架。

# cross-platform - 跨平台（windows和mac）桌面应用程序的良好语言和框架

> ID：189140
> 
> 赞同：1
> 
> 时间：2008-10-09T20:45:14.613
> 
> 标签：cross-platform, desktop-application

我做的最后一个跨平台桌面开发是 Java/Swing。弹性呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T21:04:24.090

不要这样做。如果您需要跨平台，请将应用程序的主要内容编写在不依赖任何 GUI 框架的业务逻辑层中，然后使用本机平台 API 来完成每个应用程序。

您的用户会感谢您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T21:44:44.277

我会选择一个开放的替代方案，我会尽量避免供应商锁定。正如 Richard 所说，“如果你已经掌握了 Java/Swing，为什么不再次使用它呢？”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T20:49:34.683

我已经使用[RealSoftware 的 RealBasic](http://www.realsoftware.com/products/realbasic/)做了一些事情，只是为了玩它。如果您需要专业版，它可能会变得昂贵。它将允许您为 Linux、MacOS X 或 Windows 构建独立的二进制文件。我更像是一个服务器端的人，但创建一些我想尝试用它制作的工具非常简单。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T21:39:44.143

[Qt](http://www.trolltech.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T20:54:27.277

[我是wxWidgets](http://www.wxwidgets.org/)的忠实粉丝。我唯一的经验是使用 C++。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-09T21:00:07.220

Python、[wxPython](http://wxpython.org/)、[py2exe](http://www.py2exe.org/)和[py2app](http://undefined.org/python/py2app.html)的组合是我通常依赖的。我最近使用 AIR 进行了一次跑步，它还不错……所以 Flex 可能适合你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T20:53:27.593

Flex/AIR 是一个具有很大潜力的平台。它也比 Java 或 .NET 更漂亮。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T20:59:58.157

我个人使用 Tcl/Tk，因为它非常强大，而且部署不是问题（使用starkits 和starpacks，您可以将所有程序资源——图像、声音、dll/.so 文件等——打包到一个可执行文件中） ）。

不过 Tcl 并不适合所有人——有些人发现它的简单性有点难以理解。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T21:01:26.500

忽略 Flex，它不是在编程 IMO。如果您可以编写 Java 代码，我敢肯定 Flex 会令人失望。Flex 有一席之地，我真的不认为它是一个合适的编程环境。

如果您已经掌握了 Java/Swing，为什么不再次使用它呢？我会。

.NET 可以移植——但 IME 并不像使用 Java 那样容易移动（尽管它比以前更好）。

此外，它是否必须是桌面 - 我会认真考虑（一个适当架构的）基于行的桌面应用程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-09T21:06:34.400

Eclipse RCP 有效。结果在 Windows 上是不错的，在 Mac 上是可以接受的。由于内存要求高，它在 Mac 上往往很慢。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T20:50:48.410

带有 Framework .Net 的 C# 不仅适用于 Windows，而且适用于[带有 Mono 的 Linux](http://www.mono-project.com/Main_Page)。

Microsoft 有一个[适用于 MAC OSX10.2 的 CLI](http://www.microsoft.com/downloads/details.aspx?familyid=3a1c93fa-7462-47d0-8e56-8dd34c6292f0&displaylang=en)。

# servlets - 如果我愿意关闭连接，如何在分块的 http 响应中报告错误？

> ID：189148
> 
> 赞同：1
> 
> 时间：2008-10-09T20:47:55.543
> 
> 标签：servlets

（请参阅相关问题：[如何在不关闭连接的情况下通过分块 http 响应中途报告错误？](https://stackoverflow.com/questions/162917/how-do-i-report-an-error-midway-through-a-chunked-http-repsonse-without-closing)）

就我而言，#1 的愿望是让浏览器显示错误消息。无论多么缺乏信息。

关闭 ServletResponse outputStream 显然不起作用。即使我没有先关闭（在 Tomcat 6.0.16 上测试），也不会引发异常。我认为我想要的是 RST 数据包、块中间的 FIN 或格式错误的块标头。

之后，我可以担心各种浏览器的响应方式。

为澄清而编辑：这是用于文件下载，可能是几千兆字节的二进制数据。在我必须开始发送一些数据之前，我无法确定是否可以成功读取或解密所有数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T20:07:57.327

我自己的答案，经过研究。

第一部分：似乎没有办法说服我测试的应用程序服务器在“提交”阶段之后将错误放到线路上。以下 Servlet 代码会在套接字上生成合法的 HTTP 块传输标头。有趣的是，在 WebSphere 的情况下，一条错误消息被附加到流的末尾，位于结束标记之前。

```
public class Servlet extends HttpServlet {
    public static final int ARRAY_SIZE = 65536;
    private static final int SEND_COUNT = 100000;

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, java.io.IOException {

        String testData = "This is a fairly long piece of test text, running on and on and on, over and over.";

        final ServletOutputStream outputStream = response.getOutputStream();
        for (int i = 0; i < SEND_COUNT; ++i) {
            outputStream.println(testData);
        }
        throw new ServletException("Break it now");
    }
} 
```

第二部分：即使应用程序服务器愿意将虚假数据写入线路或关闭套接字而不关闭零长度块，普通客户端也不会报告错误。IE7、FF3 和 cURL 不会报告块编码错误。这使得 HTTP 下载本质上是不可靠的，如果不是 HTTP 1.1 RFC 的文字，这也违背了精神。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T21:29:04.137

我认为你的做法是错误的。在您确定是成功还是失败之前，似乎不实际开始发送数据会更简单。这样，如果需要，您可以在开始时发送错误消息，而不是发送无效的部分数据。

如果你真的需要，你也许可以用 JavaScript 解决一些问题。当您遇到错误时，在关闭连接之前输出如下内容：

```
<script type="text/javascript"> alert("Processing failed!"); </script> 
```

您可能想要扩展脚本，但您会得到大致的想法。这是假设发送回浏览器的是 HTML 页面，您没有在问题中指定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T20:18:07.553

servlet API 不允许这样做。提交响应后，响应代码已发送。您能做的最好的事情就是关闭连接并记录错误。

# unit-testing - Visual Studio MSTest 运行甚至无法启动

> ID：189149
> 
> 赞同：1
> 
> 时间：2008-10-09T20:48:04.763
> 
> 标签：unit-testing, visual-studio-2005, mstest

我使用 Visual Studio 2005 的内置单元测试功能构建了一堆单元测试。*在过去的一段时间里，开始测试绝对*要花很长时间......一切都只是在“待定”处停留两分钟或更长时间。现在 Visual Studio 决定将事情提升到一个新的水平，甚至从不开始测试。两到三分钟后，它会中止运行并将错误消息输入日志：

无法将 ID 为 {bfba05b1-afe5-499e-b452-29167f414f0f} 的测试运行“（blahblahblah）”排队：Microsoft.VisualStudio.TestTools.TestManagement.ExecutionException：无法为本地运行建立通信环境。

有人有想法么？从中期来看，我们计划切换到 NUnit，但现在我更愿意坚持使用 Visual Studio，因为团队的其他成员已经安装了它，这样更容易说服他们实际运行测试。 . ;-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T09:56:56.567

我遇到过这个问题。但是，对我来说，答案是将我的机器名称从全部小写更改为全部大写。

对此的一些参考... [http://teamfoundation.blogspot.com/2008/12/case-of-never-ending-unit-tests.html](http://teamfoundation.blogspot.com/2008/12/case-of-never-ending-unit-tests.html) [http://social.msdn.microsoft.com/Forums/en-美国/vststest/thread/fd6f2128-e248-4336-b8be-1eb5480e3de8/](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/fd6f2128-e248-4336-b8be-1eb5480e3de8/)

请注意，如果您只是更改机器名称的大小写，那么您将需要使用更改名称的注册表方法，因为当对话框看到看起来相同的名称时，“确定”按钮将变灰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T14:40:03.807

您的计算机名称是大写的吗？将其更改为小写，然后重试。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2008-10-09T20:59:20.187

让我说这个 MS TEST 不是专业产品，应该尽可能避免。如果你想使用一个好的测试框架，那么将 MBUnit 与 TestDriven.NET 一起使用。MBUnit 带有许多新属性，包括 RollBack 和 RowTest ，Row。

此外，TestDriven.NET 将允许您调试单元测试（这太酷了）。您还可以从 TestDriven.NET 运行代码覆盖率，它会显示测试覆盖了多少代码。

试一试，我相信你会喜欢的。

PS：它是免费的

# video - 我在哪里可以找到面部检测软件、算法等？

> ID：189155
> 
> 赞同：9
> 
> 时间：2008-10-09T20:48:59.957
> 
> 标签：video, image-processing, computer-vision, pattern-recognition

我对编写依赖于能够识别图片（或视频帧）中的人脸的软件感兴趣。它不必识别人脸 - 所以除了以下指标之外没有其他指标：

*   图片中是否有人脸（或不止一张）
*   大约在哪里，眼睛、嘴巴或鼻尖（不管它在什么地方。）

它现在出现在廉价数码相机中，所以我希望有开源软件包可以做到这一点，或者在推出自己的产品时很容易遵循的研究。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T20:35:37.623

查看 OpenCV 库，这里有一个[关于它的好 wiki](http://opencv.willowgarage.com/wiki/)的链接。

[在这里](http://opencv.willowgarage.com/wiki/FaceDetection)您可以看到一个实现人脸识别应用程序的示例程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T21:18:52.753

人脸识别被定义为将给定的未知人脸图像与一组已知人脸图像进行匹配的问题。你正在寻找的是人脸检测，谷歌它，你应该找到很多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T20:58:34.180

这不是一个完整的答案，但它可能会有所帮助。特征向量也用于人脸识别：[eigenfaces](http://en.wikipedia.org/wiki/Eigenface)。

# design-patterns - 耦合度太高——如何更好地设计这个类？

> ID：189156
> 
> 赞同：8
> 
> 时间：2008-10-09T20:49:24.620
> 
> 标签：design-patterns, coupling

在我的代码上运行 FxCop，我收到以下警告：

> Microsoft.Maintainability : 'FooBar.ctor 与来自 9 个不同命名空间的 99 种不同类型相结合。重写或重构方法以减少其类耦合，或考虑将方法移至与其紧密耦合的其他类型之一。40 以上的类耦合表示可维护性差，40 到 30 之间的类耦合表示可维护性中等，低于 30 的类耦合表示可维护性好。

我的班级是来自服务器的所有消息的登陆区。服务器可以向我们发送不同 EventArgs 类型的消息：

```
public FooBar()
{
    var messageHandlers = new Dictionary<Type, Action<EventArgs>>();
    messageHandlers.Add(typeof(YouHaveBeenLoggedOutEventArgs), HandleSignOut);
    messageHandlers.Add(typeof(TestConnectionEventArgs), HandleConnectionTest);
    // ... etc for 90 other types
} 
```

“HandleSignOut”和“HandleConnectionTest”方法中的代码很少；他们通常将工作交给另一个类的函数。

如何以较低的耦合使这个类更好？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-09T21:02:31.723

让为他们感兴趣的事件注册工作的类……一个[事件代理](http://msforge.net/blogs/paki/archive/2007/11/20/EventBroker-implementation-in-C_2300_-full-source-code.aspx)模式。

```
class EventBroker {
   private Dictionary<Type, Action<EventArgs>> messageHandlers;

   void Register<T>(Action<EventArgs> subscriber) where T:EventArgs {
      // may have to combine delegates if more than 1 listener
      messageHandlers[typeof(T)] = subscriber; 
   }

   void Send<T>(T e) where T:EventArgs {
      var d = messageHandlers[typeof(T)];
      if (d != null) {
         d(e);
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T21:00:33.770

您还可以使用某种 IoC 框架（如 Spring.NET）来注入字典。这样，如果你得到一个新的消息类型，你就不必重新编译这个中央集线器——只需更改一个配置文件。

* * *

期待已久的例子：

创建一个名为 Example 的新控制台应用程序，并添加以下内容：

```
using System;
using System.Collections.Generic;
using Spring.Context.Support;

namespace Example
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            MessageBroker broker = (MessageBroker) ContextRegistry.GetContext()["messageBroker"];
            broker.Dispatch(null, new Type1EventArgs());
            broker.Dispatch(null, new Type2EventArgs());
            broker.Dispatch(null, new EventArgs());
        }
    }

    public class MessageBroker
    {
        private Dictionary<Type, object> handlers;

        public Dictionary<Type, object> Handlers
        {
            get { return handlers; }
            set { handlers = value; }
        }

        public void Dispatch<T>(object sender, T e) where T : EventArgs
        {
            object entry;
            if (Handlers.TryGetValue(e.GetType(), out entry))
            {
                MessageHandler<T> handler = entry as MessageHandler<T>;
                if (handler != null)
                {
                    handler.HandleMessage(sender, e);
                }
                else
                {
                    //I'd log an error here
                    Console.WriteLine("The handler defined for event type '" + e.GetType().Name + "' doesn't implement the correct interface!");
                }
            }
            else
            {
                //I'd log a warning here
                Console.WriteLine("No handler defined for event type: " + e.GetType().Name);
            }
        }
    }

    public interface MessageHandler<T> where T : EventArgs
    {
        void HandleMessage(object sender, T message);
    }

    public class Type1MessageHandler : MessageHandler<Type1EventArgs>
    {
        public void HandleMessage(object sender, Type1EventArgs args)
        {
            Console.WriteLine("Type 1, " + args.ToString());
        }
    }

    public class Type2MessageHandler : MessageHandler<Type2EventArgs>
    {
        public void HandleMessage(object sender, Type2EventArgs args)
        {
            Console.WriteLine("Type 2, " + args.ToString());
        }
    }

    public class Type1EventArgs : EventArgs {}

    public class Type2EventArgs : EventArgs {}
} 
```

还有一个 app.config 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <sectionGroup name="spring">
      <section name="context" type="Spring.Context.Support.ContextHandler, Spring.Core"/>
      <section name="objects" type="Spring.Context.Support.DefaultSectionHandler, Spring.Core"/>
    </sectionGroup>
  </configSections>

  <spring>
    <context>
      <resource uri="config://spring/objects"/>
    </context>
    <objects xmlns="http://www.springframework.net">

      <object id="messageBroker" type="Example.MessageBroker, Example">
        <property name="handlers">
          <dictionary key-type="System.Type" value-type="object">
            <entry key="Example.Type1EventArgs, Example" value-ref="type1Handler"/>
            <entry key="Example.Type2EventArgs, Example" value-ref="type2Handler"/>
          </dictionary>
        </property>
      </object>
      <object id="type1Handler" type="Example.Type1MessageHandler, Example"/>
      <object id="type2Handler" type="Example.Type2MessageHandler, Example"/>
    </objects>
  </spring>
</configuration> 
```

输出：

```
类型 1，Example.Type1EventArgs
类型 2，Example.Type2EventArgs
没有为事件类型定义处理程序：EventArgs

```

如您所见，`MessageBroker`不知道任何处理程序，处理程序也不知道`MessageBroker`. 所有的映射都在 app.config 文件中完成，因此如果您需要处理新的事件类型，可以将其添加到配置文件中。如果其他团队正在定义事件类型和处理程序，这尤其好 - 他们可以在 dll 中编译他们的东西，您将其放入您的部署中并简单地添加一个映射。

Dictionary 具有 object 类型的值，而不是`MessageHandler<>`因为实际的处理程序不能强制转换为`MessageHandler<EventArgs>`，所以我不得不稍微修改一下。我认为该解决方案仍然很干净，并且可以很好地处理映射错误。请注意，您还需要在此项目中引用 Spring.Core.dll。[您可以在此处](http://downloads.sourceforge.net/springnet/Spring.NET-1.1.2.zip?modtime=1210044370&big_mirror=0)找到库，并在[此处](http://springframework.net/docs/1.1.2/reference/html/index.html)找到文档。[依赖注入章节](http://springframework.net/docs/1.1.2/reference/html/objects.html#objects-dependencies)与此相关。另请注意，您没有理由为此需要使用 Spring.NET - 这里的重要思想是依赖注入。不知何故，需要告诉代理向 x 发送类型 a 的消息，并且使用 IoC 容器进行依赖注入是让代理不知道 x 的好方法，反之亦然。

与 IoC 和 DI 相关的其他一些 SO 问题：

*   [依赖注入 (DI) 和控制反转 (IOC) 之间的区别](https://stackoverflow.com/questions/139299/difference-between-dependency-injection-di-inversion-of-control-ioc)
*   [哪些 C#/.net 依赖注入框架值得研究？](https://stackoverflow.com/questions/21288/which-cnet-dependency-injection-frameworks-are-worth-looking-into)
*   [我应该使用哪个依赖注入工具？](https://stackoverflow.com/questions/148908/which-dependency-injection-tool-should-i-use)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T20:51:30.483

也许不是为每条消息使用不同的类，而是使用标识消息的标志。

这将大大减少您拥有的消息数量并提高可维护性。我的猜测是大多数消息类的差异几乎为零。

很难选择另一种攻击方式，因为架构的其余部分（对我来说）是未知的。

例如，如果您查看 Windows，它本身并不知道如何处理可能被抛出的每条消息。相反，底层消息处理程序向主线程注册回调函数。

您可能会采取类似的方法。每个消息类都需要知道如何处理自己，并且可以将自己注册到更大的应用程序中。这应该会大大简化代码并摆脱紧耦合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T21:01:21.367

我看不到您的其余代码，但我会尝试创建数量少得多的 Event arg 类。相反，创建一些在包含的数据和/或您以后处理它们的方式方面彼此相似的字段，并添加一个字段来告诉您发生的确切类型的事件（可能您应该使用枚举）。

理想情况下，您不仅要使此构造函数更具可读性，而且还要使消息的处理方式（在单个事件处理程序中以类似方式处理的分组消息）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T21:14:39.063

显然，您需要一种调度机制：根据您收到的事件，您希望执行不同的代码。

您似乎正在使用类型系统来识别事件，而它实际上是为了支持多态性。正如 Chris Lively 所建议的那样，您也可以（不滥用类型系统）使用枚举来识别消息。

或者，您可以拥抱类型系统的强大功能，并创建一个 Registry 对象，在其中注册每种类型的事件（通过静态实例、配置文件或其他方式）。然后你可以使用责任链模式来找到合适的处理程序。处理程序自己进行处理，或者它可能是一个工厂，创建一个处理事件的对象。

后一种方法看起来有点未指定和过度设计，但在 99 种事件类型（已经）的情况下，这对我来说似乎很合适。

# c++ - C++ 模板图灵完备？

> ID：189172
> 
> 赞同：125
> 
> 时间：2008-10-09T20:53:46.563
> 
> 标签：c++, templates, template-meta-programming, turing-complete

有人告诉我，C++ 中的模板系统在编译时是图灵完备的。[这篇文章](https://stackoverflow.com/questions/75538/hidden-features-of-c#75627)和[维基百科](http://en.wikipedia.org/wiki/C%2B%2B)都提到了这一点。

您能否提供一个利用此属性的计算的重要示例？

这个事实在实践中有用吗？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-11-08T22:18:51.533

我用 C++11 做了一个图灵机。C++11 添加的特性对于图灵机来说确实并不重要。它只是使用可变参数模板提供任意长度的规则列表，而不是使用不正当的宏元编程:)。条件名称用于在标准输出上输出图表。我已删除该代码以保持示例简短。

```
#include <iostream>

template<bool C, typename A, typename B>
struct Conditional {
    typedef A type;
};

template<typename A, typename B>
struct Conditional<false, A, B> {
    typedef B type;
};

template<typename...>
struct ParameterPack;

template<bool C, typename = void>
struct EnableIf { };

template<typename Type>
struct EnableIf<true, Type> {
    typedef Type type;
};

template<typename T>
struct Identity {
    typedef T type;
};

// define a type list 
template<typename...>
struct TypeList;

template<typename T, typename... TT>
struct TypeList<T, TT...>  {
    typedef T type;
    typedef TypeList<TT...> tail;
};

template<>
struct TypeList<> {

};

template<typename List>
struct GetSize;

template<typename... Items>
struct GetSize<TypeList<Items...>> {
    enum { value = sizeof...(Items) };
};

template<typename... T>
struct ConcatList;

template<typename... First, typename... Second, typename... Tail>
struct ConcatList<TypeList<First...>, TypeList<Second...>, Tail...> {
    typedef typename ConcatList<TypeList<First..., Second...>, 
                                Tail...>::type type;
};

template<typename T>
struct ConcatList<T> {
    typedef T type;
};

template<typename NewItem, typename List>
struct AppendItem;

template<typename NewItem, typename...Items>
struct AppendItem<NewItem, TypeList<Items...>> {
    typedef TypeList<Items..., NewItem> type;
};

template<typename NewItem, typename List>
struct PrependItem;

template<typename NewItem, typename...Items>
struct PrependItem<NewItem, TypeList<Items...>> {
    typedef TypeList<NewItem, Items...> type;
};

template<typename List, int N, typename = void>
struct GetItem {
    static_assert(N > 0, "index cannot be negative");
    static_assert(GetSize<List>::value > 0, "index too high");
    typedef typename GetItem<typename List::tail, N-1>::type type;
};

template<typename List>
struct GetItem<List, 0> {
    static_assert(GetSize<List>::value > 0, "index too high");
    typedef typename List::type type;
};

template<typename List, template<typename, typename...> class Matcher, typename... Keys>
struct FindItem {
    static_assert(GetSize<List>::value > 0, "Could not match any item.");
    typedef typename List::type current_type;
    typedef typename Conditional<Matcher<current_type, Keys...>::value, 
                                 Identity<current_type>, // found!
                                 FindItem<typename List::tail, Matcher, Keys...>>
        ::type::type type;
};

template<typename List, int I, typename NewItem>
struct ReplaceItem {
    static_assert(I > 0, "index cannot be negative");
    static_assert(GetSize<List>::value > 0, "index too high");
    typedef typename PrependItem<typename List::type, 
                             typename ReplaceItem<typename List::tail, I-1,
                                                  NewItem>::type>
        ::type type;
};

template<typename NewItem, typename Type, typename... T>
struct ReplaceItem<TypeList<Type, T...>, 0, NewItem> {
    typedef TypeList<NewItem, T...> type;
};

enum Direction {
    Left = -1,
    Right = 1
};

template<typename OldState, typename Input, typename NewState, 
         typename Output, Direction Move>
struct Rule {
    typedef OldState old_state;
    typedef Input input;
    typedef NewState new_state;
    typedef Output output;
    static Direction const direction = Move;
};

template<typename A, typename B>
struct IsSame {
    enum { value = false }; 
};

template<typename A>
struct IsSame<A, A> {
    enum { value = true };
};

template<typename Input, typename State, int Position>
struct Configuration {
    typedef Input input;
    typedef State state;
    enum { position = Position };
};

template<int A, int B>
struct Max {
    enum { value = A > B ? A : B };
};

template<int n>
struct State {
    enum { value = n };
    static char const * name;
};

template<int n>
char const* State<n>::name = "unnamed";

struct QAccept {
    enum { value = -1 };
    static char const* name;
};

struct QReject {
    enum { value = -2 };
    static char const* name; 
};

#define DEF_STATE(ID, NAME) \
    typedef State<ID> NAME ; \
    NAME :: name = #NAME ;

template<int n>
struct Input {
    enum { value = n };
    static char const * name;

    template<int... I>
    struct Generate {
        typedef TypeList<Input<I>...> type;
    };
};

template<int n>
char const* Input<n>::name = "unnamed";

typedef Input<-1> InputBlank;

#define DEF_INPUT(ID, NAME) \
    typedef Input<ID> NAME ; \
    NAME :: name = #NAME ;

template<typename Config, typename Transitions, typename = void> 
struct Controller {
    typedef Config config;
    enum { position = config::position };

    typedef typename Conditional<
        static_cast<int>(GetSize<typename config::input>::value) 
            <= static_cast<int>(position),
        AppendItem<InputBlank, typename config::input>,
        Identity<typename config::input>>::type::type input;
    typedef typename config::state state;

    typedef typename GetItem<input, position>::type cell;

    template<typename Item, typename State, typename Cell>
    struct Matcher {
        typedef typename Item::old_state checking_state;
        typedef typename Item::input checking_input;
        enum { value = IsSame<State, checking_state>::value && 
                       IsSame<Cell,  checking_input>::value
        };
    };
    typedef typename FindItem<Transitions, Matcher, state, cell>::type rule;

    typedef typename ReplaceItem<input, position, typename rule::output>::type new_input;
    typedef typename rule::new_state new_state;
    typedef Configuration<new_input, 
                          new_state, 
                          Max<position + rule::direction, 0>::value> new_config;

    typedef Controller<new_config, Transitions> next_step;
    typedef typename next_step::end_config end_config;
    typedef typename next_step::end_input end_input;
    typedef typename next_step::end_state end_state;
    enum { end_position = next_step::position };
};

template<typename Input, typename State, int Position, typename Transitions>
struct Controller<Configuration<Input, State, Position>, Transitions, 
                  typename EnableIf<IsSame<State, QAccept>::value || 
                                    IsSame<State, QReject>::value>::type> {
    typedef Configuration<Input, State, Position> config;
    enum { position = config::position };
    typedef typename Conditional<
        static_cast<int>(GetSize<typename config::input>::value) 
            <= static_cast<int>(position),
        AppendItem<InputBlank, typename config::input>,
        Identity<typename config::input>>::type::type input;
    typedef typename config::state state;

    typedef config end_config;
    typedef input end_input;
    typedef state end_state;
    enum { end_position = position };
};

template<typename Input, typename Transitions, typename StartState>
struct TuringMachine {
    typedef Input input;
    typedef Transitions transitions;
    typedef StartState start_state;

    typedef Controller<Configuration<Input, StartState, 0>, Transitions> controller;
    typedef typename controller::end_config end_config;
    typedef typename controller::end_input end_input;
    typedef typename controller::end_state end_state;
    enum { end_position = controller::end_position };
};

#include <ostream>

template<>
char const* Input<-1>::name = "_";

char const* QAccept::name = "qaccept";
char const* QReject::name = "qreject";

int main() {
    DEF_INPUT(1, x);
    DEF_INPUT(2, x_mark);
    DEF_INPUT(3, split);

    DEF_STATE(0, start);
    DEF_STATE(1, find_blank);
    DEF_STATE(2, go_back);

    /* syntax:  State, Input, NewState, Output, Move */
    typedef TypeList< 
        Rule<start, x, find_blank, x_mark, Right>,
        Rule<find_blank, x, find_blank, x, Right>,
        Rule<find_blank, split, find_blank, split, Right>,
        Rule<find_blank, InputBlank, go_back, x, Left>,
        Rule<go_back, x, go_back, x, Left>,
        Rule<go_back, split, go_back, split, Left>,
        Rule<go_back, x_mark, start, x, Right>,
        Rule<start, split, QAccept, split, Left>> rules;

    /* syntax: initial input, rules, start state */
    typedef TuringMachine<TypeList<x, x, x, x, split>, rules, start> double_it;
    static_assert(IsSame<double_it::end_input, 
                         TypeList<x, x, x, x, split, x, x, x, x>>::value, 
                "Hmm... This is borky!");
} 
```

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2008-10-09T22:28:43.187

例子

```
#include <iostream>

template <int N> struct Factorial
{
    enum { val = Factorial<N-1>::val * N };
};

template<>
struct Factorial<0>
{
    enum { val = 1 };
};

int main()
{
    // Note this value is generated at compile time.
    // Also note that most compilers have a limit on the depth of the recursion available.
    std::cout << Factorial<4>::val << "\n";
} 
```

这有点有趣，但不是很实用。

回答问题的第二部分：
**这个事实在实践中有用吗？**

简短的回答：有点。

长答案：是的，但前提是您是模板守护进程。

使用对其他人使用非常有用的模板元编程（即库）来产生良好的编程确实非常困难（尽管可行）。To Help boost 甚至还有[MPL](http://www.boost.org/doc/libs/1_36_0/libs/mpl/doc/index.html) aka（元编程库）。但是尝试在你的模板代码中调试一个编译器错误，你将会经历一段漫长的艰难旅程。

但是一个很好的实际例子，它被用于有用的东西：

Scott Meyers 一直在使用模板工具对 C++ 语言进行扩展（我使用这个术语是松散的）。您可以在此处阅读他的工作“[强制执行代码功能](http://www.artima.com/cppsource/codefeaturesP.html)”

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-10-09T20:57:43.857

“ [C++ Templates Are Turing Complete](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.14.3670) ”在模板中给出了图灵机的实现......这很重要，并且以非常直接的方式证明了这一点。当然，它也不是很有用！

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-09T21:01:29.870

我的 C++ 有点生疏，所以可能并不完美，但已经很接近了。

```
template <int N> struct Factorial
{
    enum { val = Factorial<N-1>::val * N };
};

template <> struct Factorial<0>
{
    enum { val = 1 };
}

const int num = Factorial<10>::val;    // num set to 10! at compile time. 
```

关键是要证明编译器正在完全评估递归定义，直到它得到答案。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-02-08T15:45:01.747

举一个重要的例子：[https](https://github.com/phresnel/metatrace) ://github.com/phresnel/metatrace ，一个 C++ 编译时光线追踪器。

请注意，C++0x 将以以下形式添加非模板、编译时、图灵完备设施`constexpr`：

```
constexpr unsigned int fac (unsigned int u) {
        return (u<=1) ? (1) : (u*fac(u-1));
} 
```

您可以`constexpr`在需要编译时常量的任何地方使用 -expression，但也可以`constexpr`使用非常量参数调用 -functions。

一件很酷的事情是，这最终将启用编译时浮点数学，尽管标准明确指出编译时浮点运算不必匹配运行时浮点运算：

> ```
> bool f(){
>     char array[1+int(1+0.2-0.1-0.1)]; //Must be evaluated during translation
>     int  size=1+int(1+0.2-0.1-0.1); //May be evaluated at runtime
>     return sizeof(array)==size;
> } 
> ```
> 
> 未指定 f() 的值是真还是假。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-09T23:34:12.633

[Andrei Alexandrescu 所著的Modern C++ Design - Generic Programming and Design Pattern](https://rads.stackoverflow.com/amzn/click/com/0201704315)一书是亲身体验有用且强大的通用编程模式的最佳场所。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-04-29T09:56:43.877

阶乘示例实际上并没有表明模板是图灵完备的，而是表明它们支持原始递归。显示模板图灵完备的最简单方法是通过 Church-Turing 论文，即通过实现图灵机（混乱且有点无意义）或无类型 lambda 演算的三个规则（app、abs var）。后者更简单，也更有趣。

当您了解 C++ 模板允许在编译时进行纯函数式编程时，正在讨论的是一个非常有用的功能，这种形式主义具有表现力、强大和优雅，但如果您没有经验，编写起来也非常复杂。还要注意有多少人发现，仅仅获得大量模板化的代码通常需要付出很大的努力：（纯）函数式语言就是这种情况，这使得编译更加困难，但出人意料地产生了不需要调试的代码。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-09T21:01:29.010

我认为它被称为[模板元编程](http://en.wikipedia.org/wiki/Template_metaprogramming)。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-03-20T11:40:27.010

好吧，这是一个运行 4 状态 2 符号繁忙海狸的编译时图灵机实现

```
#include <iostream>

#pragma mark - Tape

constexpr int Blank = -1;

template<int... xs>
class Tape {
public:
    using type = Tape<xs...>;
    constexpr static int length = sizeof...(xs);
};

#pragma mark - Print

template<class T>
void print(T);

template<>
void print(Tape<>) {
    std::cout << std::endl;
}

template<int x, int... xs>
void print(Tape<x, xs...>) {
    if (x == Blank) {
        std::cout << "_ ";
    } else {
        std::cout << x << " ";
    }
    print(Tape<xs...>());
}

#pragma mark - Concatenate

template<class, class>
class Concatenate;

template<int... xs, int... ys>
class Concatenate<Tape<xs...>, Tape<ys...>> {
public:
    using type = Tape<xs..., ys...>;
};

#pragma mark - Invert

template<class>
class Invert;

template<>
class Invert<Tape<>> {
public:
    using type = Tape<>;
};

template<int x, int... xs>
class Invert<Tape<x, xs...>> {
public:
    using type = typename Concatenate<
        typename Invert<Tape<xs...>>::type,
        Tape<x>
    >::type;
};

#pragma mark - Read

template<int, class>
class Read;

template<int n, int x, int... xs>
class Read<n, Tape<x, xs...>> {
public:
    using type = typename std::conditional<
        (n == 0),
        std::integral_constant<int, x>,
        Read<n - 1, Tape<xs...>>
    >::type::type;
};

#pragma mark - N first and N last

template<int, class>
class NLast;

template<int n, int x, int... xs>
class NLast<n, Tape<x, xs...>> {
public:
    using type = typename std::conditional<
        (n == sizeof...(xs)),
        Tape<xs...>,
        NLast<n, Tape<xs...>>
    >::type::type;
};

template<int, class>
class NFirst;

template<int n, int... xs>
class NFirst<n, Tape<xs...>> {
public:
    using type = typename Invert<
        typename NLast<
            n, typename Invert<Tape<xs...>>::type
        >::type
    >::type;
};

#pragma mark - Write

template<int, int, class>
class Write;

template<int pos, int x, int... xs>
class Write<pos, x, Tape<xs...>> {
public:
    using type = typename Concatenate<
        typename Concatenate<
            typename NFirst<pos, Tape<xs...>>::type,
            Tape<x>
        >::type,
        typename NLast<(sizeof...(xs) - pos - 1), Tape<xs...>>::type
    >::type;
};

#pragma mark - Move

template<int, class>
class Hold;

template<int pos, int... xs>
class Hold<pos, Tape<xs...>> {
public:
    constexpr static int position = pos;
    using tape = Tape<xs...>;
};

template<int, class>
class Left;

template<int pos, int... xs>
class Left<pos, Tape<xs...>> {
public:
    constexpr static int position = typename std::conditional<
        (pos > 0),
        std::integral_constant<int, pos - 1>,
        std::integral_constant<int, 0>
    >::type();

    using tape = typename std::conditional<
        (pos > 0),
        Tape<xs...>,
        Tape<Blank, xs...>
    >::type;
};

template<int, class>
class Right;

template<int pos, int... xs>
class Right<pos, Tape<xs...>> {
public:
    constexpr static int position = pos + 1;

    using tape = typename std::conditional<
        (pos < sizeof...(xs) - 1),
        Tape<xs...>,
        Tape<xs..., Blank>
    >::type;
};

#pragma mark - States

template <int>
class Stop {
public:
    constexpr static int write = -1;
    template<int pos, class tape> using move = Hold<pos, tape>;
    template<int x> using next = Stop<x>;
};

#define ADD_STATE(_state_)      \
template<int>                   \
class _state_ { };

#define ADD_RULE(_state_, _read_, _write_, _move_, _next_)          \
template<>                                                          \
class _state_<_read_> {                                             \
public:                                                             \
    constexpr static int write = _write_;                           \
    template<int pos, class tape> using move = _move_<pos, tape>;   \
    template<int x> using next = _next_<x>;                         \
};

#pragma mark - Machine

template<template<int> class, int, class>
class Machine;

template<template<int> class State, int pos, int... xs>
class Machine<State, pos, Tape<xs...>> {
    constexpr static int symbol = typename Read<pos, Tape<xs...>>::type();
    using state = State<symbol>;

    template<int x>
    using nextState = typename State<symbol>::template next<x>;

    using modifiedTape = typename Write<pos, state::write, Tape<xs...>>::type;
    using move = typename state::template move<pos, modifiedTape>;

    constexpr static int nextPos = move::position;
    using nextTape = typename move::tape;

public:
    using step = Machine<nextState, nextPos, nextTape>;
};

#pragma mark - Run

template<class>
class Run;

template<template<int> class State, int pos, int... xs>
class Run<Machine<State, pos, Tape<xs...>>> {
    using step = typename Machine<State, pos, Tape<xs...>>::step;

public:
    using type = typename std::conditional<
        std::is_same<State<0>, Stop<0>>::value,
        Tape<xs...>,
        Run<step>
    >::type::type;
};

ADD_STATE(A);
ADD_STATE(B);
ADD_STATE(C);
ADD_STATE(D);

ADD_RULE(A, Blank, 1, Right, B);
ADD_RULE(A, 1, 1, Left, B);

ADD_RULE(B, Blank, 1, Left, A);
ADD_RULE(B, 1, Blank, Left, C);

ADD_RULE(C, Blank, 1, Right, Stop);
ADD_RULE(C, 1, 1, Left, D);

ADD_RULE(D, Blank, 1, Right, D);
ADD_RULE(D, 1, Blank, Right, A);

using tape = Tape<Blank>;
using machine = Machine<A, 0, tape>;
using result = Run<machine>::type;

int main() {
    print(result());
    return 0;
} 
```

Ideone 证明运行：[https ://ideone.com/MvBU3Z](https://ideone.com/MvBU3Z)

说明：http: [//victorkomarov.blogspot.ru/2016/03/compile-time-turing-machine.html](http://victorkomarov.blogspot.ru/2016/03/compile-time-turing-machine.html)

Github 有更多示例：[https ://github.com/fnz/CTTM](https://github.com/fnz/CTTM)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-10T12:53:38.033

您可以查看 Dobbs 博士的这篇文章，了解使用模板的 FFT 实现，我认为这不是那么简单。要点是允许编译器执行比非模板实现更好的优化，因为 FFT 算法使用大量常量（例如 sin 表）

[第一部分](http://www.ddj.com/cpp/199500857)

[第二部分](http://www.ddj.com/hpc-high-performance-computing/199702312)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-09T21:00:13.960

如果您想在编译时计算常量，它可能会很有用，至少在理论上是这样。查看[模板元编程](http://en.wikipedia.org/wiki/Template_metaprogramming)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-09T21:35:25.917

指出它是一种纯粹的函数式语言也很有趣，尽管几乎不可能调试。如果您查看[James](https://stackoverflow.com/questions/189172/c-templates-turing-complete#189204)的帖子，您会明白我所说的功能性是什么意思。一般来说，它不是 C++ 最有用的特性。它不是为此而设计的。这是被发现的东西。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-10T14:29:56.060

一个相当有用的例子是比率类。周围有一些变体。通过部分重载，捕获 D==0 的情况相当简单。真正的计算是在计算 N 和 D 的 GCD 和编译时间。当您在编译时计算中使用这些比率时，这是必不可少的。

示例：当您计算厘米（5）*公里（5）时，在编译时您将乘以 ratio<1,100> 和 ratio<1000,1>。为了防止溢出，您需要一个 ratio<10,1> 而不是 ratio<1000,100>。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T13:24:39.390

[图灵机](http://en.wikipedia.org/wiki/Turing_machine)是图灵完备的，但这并不意味着您应该将其用于生产代码。

根据我的经验，尝试用模板做任何不重要的事情都是混乱、丑陋和毫无意义的。您无法“调试”您的“代码”，编译时错误消息将是神秘的并且通常在最不可能的地方，并且您可以通过不同的方式获得相同的性能优势。（提示：4！= 24）。更糟糕的是，您的代码对于普通的 C++ 程序员来说是不可理解的，并且由于当前编译器的广泛支持水平，您的代码可能是不可移植的。

模板非常适合通用代码生成（容器类、类包装器、混入），但不是——在我看来，模板的图灵完整性在实践 中**没有用。**

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-22T13:26:20.933

只是另一个如何不编程的例子：

```
模板<int 深度，int A，类型名 B>
结构 K17 {
    静态常量 int x =
    K17 <深度+1, 0, K17<深度,A,B> >::x
    + K17 <深度+1, 1, K17<深度,A,B> >::x
    + K17 <深度+1, 2, K17<深度,A,B> >::x
    + K17 <深度+1, 3, K17<深度,A,B> >::x
    + K17 <深度+1, 4, K17<深度,A,B> >::x;
};
模板 <int A, typename B>
结构 K17 <16,A,B> { 静态常量 int x = 1; };
静态常量 int z = K17 <0,0,int>::x;
无效的主要（无效）{}

```

发表在[C++ 模板即将完成](http://cpptruths.blogspot.com/2005/11/c-templates-are-turing-complete.html)

# sharepoint - Sharepoint 中的 InfoPath 表单上的“未找到所选文件”

> ID：189184
> 
> 赞同：1
> 
> 时间：2008-10-09T20:56:45.900
> 
> 标签：sharepoint, infopath

在将 InfoPath 表单上的文件附件控件用作 SharePoint 工作流的一部分时，我收到错误“未找到所选文件”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T21:03:18.540

在某处在线找到此内容，但无法再次找到链接。您需要修改以下文件：

C:\Program Files\Common Files\Microsoft Shared\web 服务器扩展\12\TEMPLATE\LAYOUTS\WrkTaskIP.aspx

添加：

```
<script type="text/javascript">aspnetForm.encoding = "multipart/form-data";</script> 
```

在第一个表开始标记之前的文件中。iisreset 然后表单的附件控件在工作流中托管时应该可以工作。

# c - C中图形的线性代数

> ID：189186
> 
> 赞同：3
> 
> 时间：2008-10-09T20:57:28.053
> 
> 标签：c, graphics, 3d, vector-graphics

我正在开发写入微型 LCD 屏幕（小于 1" x 1"）的软件。

我有所有常见的嫌疑人——线条、填充的多边形、字体等。

然而，我记得很多个月前学习如何在线性代数中进行有趣的矢量操作，并创建旋转线框对象。

我想再做一次，但认为必须有一个快速而肮脏的教程和/或 C 中的简单向量库来完成所有繁重的工作，这样我就可以跳过实现并直接进入眼睛糖果。

任何指针？

-亚当

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T21:27:45.713

*   我曾经使用 LAPACK++ ( [http://math.nist.gov/lapack++/](http://math.nist.gov/lapack++/) )，但我看到它现在被 TNT ( [http://math.nist.gov/tnt/](http://math.nist.gov/tnt/) )取代

*   对于简单的旋转，您可能只是编写矩阵类型并实现矩阵乘法

# search - 在多个文件中替换 - Linux 的图形工具

> ID：189190
> 
> 赞同：22
> 
> 时间：2008-10-09T20:58:31.873
> 
> 标签：search, replace, text-editor

它需要是图形的。没有 sed、awk、grep、perl 等等。我知道如何使用它们，我现在确实使用它们，但我需要在 300 多个文件中挑选每个替换。

我想要一个工具，我可以：

*   输入搜索字符串
*   键入替换字符串
*   选择目录和文件扩展名

它将递归地进入该目录及其子目录中的每个文件，打开它并滚动到搜索字符串所在的位置并提供两个选项：

*   替换（并找到下一个）
*   找下一个

而已。正则表达式 支持是加分项，但不是必需的。

已解决：Regexxer 正是我所需要的。如果有人在 Slackware 上需要它，[这](http://swoes.blogspot.com/2008/10/regexxer-on-slackware-121.html)是您需要下载的内容以及如何编译它（选择每个依赖项的正确版本可以是 PITA）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-09T21:22:01.403

我认为[regexxer](http://regexxer.sourceforge.net/)正是您正在寻找的：

### [正则表达式](http://regexxer.sourceforge.net/)

> regexxer 是一个漂亮的 GUI 搜索/替换工具，具有 Perl 风格的正则表达式。如果您需要项目范围的替换并且您厌倦了一起破解 sed 命令行，那么您绝对应该尝试一下。

另请参阅屏幕截图，看起来很像您所描述的：

[![截屏](https://i.stack.imgur.com/5h0ZG.jpg)](http://regexxer.sourceforge.net/images/regexxer-screenshot.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-09T21:01:36.780

Emacs + dired + 查询替换正则表达式

要获得完整的配方，请[点击此链接](http://xahlee.org/emacs/find_replace_inter.html)（它相当长，涵盖了所有可能的替代方案），

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-09T21:54:39.200

jEdit 完全符合您的需要。它是用 Java 编写的，在 Linux、Windows 和 OS X（可能还有其他操作系统）中运行良好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-17T08:36:33.580

最近 Kate（如果您使用 KDE）可以做到，但方式非常棘手。转到“编辑>在文件中搜索”，然后选择文件所在的文件夹。

**诀窍是，只有在搜索结果出现后，您才会找到一个文本框和一个名为“替换选中”的按钮。这个按钮会做你想做的事。**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T22:15:36.257

我一直使用 gVim 来完成这项任务。我一次打开所有文件，然后使用命令对每个文件执行替换，要求确认。通常我使用 < 20 个文件，所以我将它们作为选项卡打开并使用：

```
:tabdo %s/foo/bar/gc 
```

gVim 在 Windows 上运行良好 :) 我的同事经常使用 Textpad 来做同样的事情，但我想说 gVim 在这方面效率更高。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-28T07:44:13.330

如果您是 KDE 用户，还有[kfilereplace](http://kfilereplace.kdewebdev.org/)。

# apache-flex - Flex / Actionscript 中的文本动画库？

> ID：189207
> 
> 赞同：0
> 
> 时间：2008-10-09T21:02:17.420
> 
> 标签：apache-flex, flash, actionscript, animation, banner

是否有任何用于在 Actionscript 中使用的酷文本动画效果的好库（用于介绍屏幕或横幅）。

我已经放弃尝试使用 Flash 本身，因为这需要很长时间，而且我不知道从众多 Flash 文本动画工具中选择哪一个。

我希望能够用不同的消息动态地产生很酷的文本效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T22:07:59.593

有[http://www.txeff.com/](http://www.txeff.com/)虽然有点贵，但非常棒。它甚至还有一个[效果编辑器](http://www.txeff.com/#/edit/null/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T11:39:05.517

[AS3 代码库](http://www.adrianparr.com/?p=83)中的广泛的 AS3 补间库列表（除其他外）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-08T19:49:00.863

嘿！查看 TextAnim 库。[AS3](http://flupie.net/textanim/maker/)中的动态文本动画类，基于事件，独立于补间引擎，当然，它是免费的！

=)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T14:32:30.437

[Degrafa](http://www.degrafa.org/)是一个强大的基于 MXML 的动画库。它使得创建可以由设计师更新或由外部数据驱动的动态动画变得非常容易，因为它利用了 Flex 框架和 MXML。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T19:02:34.900

txeff 绝对是最好的东西。

10 月，他们推出了新版本的促销活动，价格仅为 99 美元，并且具有一些很棒的新功能。您可以在 actionscript 或 flash 中使用它。

当然，我昨天花了 179 美元买的！啊

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-03T23:10:11.380

从伟大的 TweenMax 的创建者那里尝试[SplitTextField 。](http://blog.greensock.com/splittextfield/)[另一种选择是使用bannersnack](http://www.bannersnack.com)创建横幅并将其加载到您的应用程序中。付费版本并不昂贵，而且效果很酷。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-07T09:02:17.710

试试 WaveText MXP。或者，如果您需要快速简单的东西，请尝试[http://www.flash-banner-maker-online.com](http://www.flash-banner-maker-online.com)。它完全免费，可以创建没有水印的横幅。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-08T20:57:13.380

我只能推荐 Guindex 的[TextAnim 类](http://code.google.com/p/textanim/)。在 AS3 中很容易设置，而且功能非常强大！

# java - 你真的在java中使用你的反向域来命名包吗？

> ID：189209
> 
> 赞同：24
> 
> 时间：2008-10-09T21:02:55.857
> 
> 标签：java, namespaces

很久以前，我一直认为，在 java 中，将您拥有的域反转为包命名是愚蠢和尴尬的。

您在项目中使用哪个包命名？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-10-09T21:23:50.370

一旦你理解了约定存在的原因，它至少不应该感到愚蠢或尴尬。

这个方案做了两个重要的事情：

*   您的所有代码都包含在其他人不会与之发生冲突的包中。您拥有自己的域名，因此它是孤立的。如果我们没有这个约定，许多公司都会有一个“实用程序”包，其中包含“StringUtil”、“MessageUtil”等类。如果你试图使用其他人的代码，它们会很快发生冲突。

*   它的“反向”特性使得顶层的类目录布局非常狭窄。如果您展开一个 jar，您会看到“com”、“org”、“net”等目录，然后在每个目录下显示组织/公司名称。

（于 2021 年添加）如今，当这种类型的包命名用于第三方库时，这一点变得更加重要，这些库在构建过程中被传递引入，如果名称不是唯一的，则很容易发生冲突。如果每个人都遵守相同的约定，就不会有意外的碰撞。

（2021 年添加）相同的命名约定可用于应用商店上的应用程序 ID，以确保唯一性。

我们通常不会扩展 jar，但在早期的 java 开发中，这很重要，因为人们使用扩展的 dir 结构来进行小程序。

但是，现在这很好，因为源代码目录结构具有非常“自上而下”的感觉。您从最通用的（com、org、net...）到不太通用的（公司名称）再到更具体的（项目/产品/lib 名称）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-09T21:05:14.637

我实际上认为反向域名包命名是 Java 中更出色的约定之一。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T21:08:34.613

如果它只是一个内部项目，并且代码不太可能被重用，那么我通常会使用简短的描述性名称。

但是，如果代码要在外部使用或在另一个项目中重用，那么我倾向于使用反向域方案。它确保不会有任何包名冲突。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-09T21:17:23.987

我自己觉得很傻。com。部分实际上只添加了 4 个额外字符。另外，我认为在程序集/项目名称中使用公司名称也是错误的。我曾在太多与另一家公司合并或简单改名的地方工作过。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-11T00:23:28.887

我认为这在很大程度上取决于正在编写的软件类型。比如我为一家小公司开发内部系统，所以我选择：

```
[company].[project].[sub].xyz(.abc) 
```

哪里`sub`通常是`client`和`common`之一`server`。如果我在一家（商业）软件公司工作，我会更不愿意使用这个`project`位，因为项目开始时调用的应用程序和完成时调用的应用程序很可能是两个完全不同的东西！这是为了：

```
oak.lang.Object 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T21:05:44.417

是的，我使用反向域作为包的开头，然后是其他管理信息（项目、部门等）。域的使用最大限度地减少了供应商/公司/FOSS 项目之间发生冲突的机会。由于域，我的“数据”包不会与另一家公司的数据包发生冲突。

我还使用了删除 tld 的惯例，用于内部工作或不适合外部使用的类（可能是未记录的支持库等）。这通常会让其他开发人员清楚不同的规则或策略可能适用于代码块。

使用反向域比不遵循任何规则或既定模式的任意命名空间要少得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T21:10:21.817

我为我的所有项目都这样做，我什至把它带到我的命名空间的 .NET 应用程序中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T21:20:33.090

是的，我什至设计了一个使用反向域命名约定在 JavaScript 中创建命名空间的方案，它使查找特定资产及其负责的内容变得更加容易，并且有助于防止名称冲突。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T22:16:51.480

它非常有用并被其他人复制（例如 XML Schema）。

它在“大”（鉴于 WWW）中很有用，但在跨部门（即在小）中可能更有用。对于较小的项目，它可能看起来很臃肿，但它就像保险一样：当你以后需要它时它就在那里。

# sql - SQL 按最近日期选择具有两个唯一列的行

> ID：189213
> 
> 赞同：109
> 
> 时间：2008-10-09T21:05:02.280
> 
> 标签：sql, oracle

使用以下查询和结果，我正在查找 ChargeId 和 ChargeType 唯一的最新条目。

```
select chargeId, chargeType, serviceMonth from invoice

    CHARGEID    CHARGETYPE  SERVICEMONTH
1   101         R           8/1/2008
2   161         N           2/1/2008
3   101         R           2/1/2008
4   101         R           3/1/2008
5   101         R           4/1/2008
6   101         R           5/1/2008
7   101         R           6/1/2008
8   101         R           7/1/2008 
```

期望：

```
 CHARGEID    CHARGETYPE  SERVICEMONTH
1   101         R           8/1/2008
2   161         N           2/1/2008 
```

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2008-10-09T21:07:29.890

您可以使用**GROUP BY**按类型和 id 对项目进行分组。然后您可以使用**MAX()**聚合函数来获取最近的服务月份。下面返回一个带有 ChargeId、ChargeType 和 MostRecentServiceMonth 的结果集

```
SELECT
  CHARGEID,
  CHARGETYPE,
  MAX(SERVICEMONTH) AS "MostRecentServiceMonth"
FROM INVOICE
GROUP BY CHARGEID, CHARGETYPE 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-10-09T21:22:00.950

所以这不是请求者所要求的，而是“SQL 按最近日期选择行”的答案。

修改自[http://wiki.lessthandot.com/index.php/Returning_The_Maximum_Value_For_A_Row](http://wiki.lessthandot.com/index.php/Returning_The_Maximum_Value_For_A_Row)

```
SELECT t.chargeId, t.chargeType, t.serviceMonth FROM( 
    SELECT chargeId,MAX(serviceMonth) AS serviceMonth
    FROM invoice
    GROUP BY chargeId) x 
    JOIN invoice t ON x.chargeId =t.chargeId
    AND x.serviceMonth = t.serviceMonth 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-09T21:09:20.103

```
SELECT chargeId, chargeType, MAX(serviceMonth) AS serviceMonth 
FROM invoice
GROUP BY chargeId, chargeType 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-08-18T11:10:17.823

我看到大多数开发人员都使用内联查询，而没有注意它对海量数据的影响。

简单来说，您可以通过以下方式实现：

```
select a.chargeId, a.chargeType, a.serviceMonth 
from invoice a
left outer join invoice b
on a.chargeId=b.chargeId and a.serviceMonth <b.serviceMonth 
where b.chargeId is null
order by a.serviceMonth desc 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-30T12:15:29.510

```
select to.chargeid,t0.po,i.chargetype from invoice i
inner join
(select chargeid,max(servicemonth)po from invoice 
group by chargeid)t0
on i.chargeid=t0.chargeid 
```

如果不同的费用 id 具有不同的费用类型组合，则上述查询将起作用。希望这个简单的查询有助于考虑很少的性能时间......

# c# - 使用部分类型信息结束异步委托调用

> ID：189228
> 
> 赞同：4
> 
> 时间：2008-10-09T21:10:14.440
> 
> 标签：c#, asynchronous, delegates

当使用 BeginInvoke/EndInvoke 模式编写异步方法实现时，代码可能如下所示（为了避免您猜测这是一个围绕缓存的异步包装器）：

```
IAsyncResult BeginPut(string key, object value)
{
    Action<string, object> put = this.cache.Put;
    return put.BeginInvoke(key, value, null, null);
}

void EndPut(IAsyncResult asyncResult)
{
    var put = (Action<string, object>)((AsyncResult)asyncResult).AsyncDelegate;
    put.EndInvoke(asyncResult);
} 
```

这非常有效，因为它知道委托的类型是什么，因此可以强制转换。但是，当您有两个方法时，它开始变得混乱`Put`，因为尽管该方法返回 void 您似乎必须将其强制转换为强类型委托以结束调用，例如

```
IAsyncResult BeginPut(string key, object value)
{
    Action<string, object> put = this.cache.Put;
    return put.BeginInvoke(key, value, null, null);
}

IAsyncResult BeginPut(string region, string key, object value)
{
    Action<string, string, object> put = this.cache.Put;
    return put.BeginInvoke(region, key, value, null, null);
}

void EndPut(IAsyncResult asyncResult)
{
    var put = ((AsyncResult)asyncResult).AsyncDelegate;

    var put1 = put as Action<string, object>;
    if (put1 != null) 
    {
        put1.EndInvoke(asyncResult);
        return;
    }

    var put2 = put as Action<string, string, object>;
    if (put2 != null) 
    {
        put2.EndInvoke(asyncResult);
        return;
    }

    throw new ArgumentException("Invalid async result", "asyncResult");
} 
```

我希望有一种更简洁的方法来做到这一点，因为我唯一关心委托的是返回类型（在本例中为 void），而不是提供给它的参数。但我绞尽脑汁问办公室里的其他人，谁也想不出答案。

我知道一个解决方案是编写一个 custom `IAsyncResult`，但这是一项艰巨的任务，因为潜在的线程问题围绕着诸如延迟实例化之类的事情`WaitHandle`，我宁愿拥有这个看起来有点 hacky 的代码而不是沿着这条路线走。

关于如何在没有级联`is`检查的情况下结束调用的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T21:42:08.603

我错了，有更清洁的方法。

在您已经知道委托的特定类型的同一上下文中`Action( IAsyncResult )`为特定方法创建委托，并将其作为 AsyncState 传递。`EndInvoke()`为方便起见，我`EndPut()`作为回调传递。

```
IAsyncResult BeginPut( string key, object value ) {
    Action<string, object> put = this.Put;
    return put.BeginInvoke( key, value, EndPut,
        new Action<IAsyncResult>( put.EndInvoke ) );
}

IAsyncResult BeginPut( string region, string key, object value ) {
    Action<string, string, object> put = this.Put;
    return put.BeginInvoke( region, key, value, EndPut,
        new Action<IAsyncResult>( put.EndInvoke ) );
} 
```

然后你完成它。

```
void EndPut( IAsyncResult asyncResult ) {
    var del = asyncResult.AsyncState as Action<IAsyncResult>;
    del( asyncResult );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T21:22:04.353

为什么不通过回到更一般的重载来避免这个问题：

```
IAsyncResult BeginPut(string key, object value) {
   return this.BeginPut(null, key, value);
}

IAsyncResult BeginPut(string region, string key, object value) {
   Action<string, string, object> put = this.Put;
   return put.BeginInvoke(region, key, value, null, null);
}

void EndPut(IAsyncResult asyncResult) {
   var put = (Action<string, string, object>)((AsyncResult)asyncResult).AsyncDelegate;
   put.EndInvoke(asyncResult);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T21:31:37.593

**编辑：**请参阅我的其他答案。它*可以*更清洁。

我不认为有办法让这个更清洁。通过使用相同的`EndPut`方法来结束不止一种类型的异步调用，您基本上使这不可避免。您也可以通过`EndPut`将`put`委托作为最后两个参数传递给`BeginInvoke()`（回调和异步状态）来遵循正常模式，并且您仍然必须测试委托是什么类型才能调用`EndInvoke()`。

将它们投射到`Delegate`根本没有帮助。

我喜欢 Mark Brackett 的想法。我认为这归结为以下选项：

*   通过让一个重载呼叫另一个来完全加入他们。一个委托，一个回调。
*   通过调用两个回调将它们完全分开`EndInvoke()`。

除此之外，唯一的事情就是让你的代码更简洁一些，并使用一个`switch`或查找字典 using `asyncResult.AsyncState.GetType()`，将`put`委托作为该状态对象传递。

# math - 程序员的统计工具

> ID：189237
> 
> 赞同：5
> 
> 时间：2008-10-09T21:13:53.387
> 
> 标签：math, statistics

我正在尝试评估购买统计工具。这将部分由非编程用户（进行临床研究）和部分程序员使用，所以我试图在可用性和自动化之间找到一个很好的折衷方案。当然，成本是一个问题，但如果我能打造一个坚固的外壳，我们可能会购买一个商业包装，所以我们并不完全限于免费选项。

到目前为止，我们的选择是：

*   Statistica（一些非程序员已经知道）
*   Matlab 统计工具箱（程序员已经使用 matlab）
*   R 语言（需要非程序员的 UI）
*   将某些东西破解到 Excel 中（不好玩，但这就是非程序员现在所做的）
*   ?...

还有什么？行业标准是什么？我应该寻找什么样的显着特征？你会推荐什么，为什么？

理想情况下，我们想要一个可以在 Linux 和 Windows 机器上运行的工具。

（我从事医学成像工作，所以我们同时做生物统计学和软件工程统计学）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T22:02:53.023

放下它是[R](http://www.r-project.org/)。R 对程序员非常友好。它具有功能方面，它是 GNU。

S-PLUS 和 R 都基于 S 语言。两者相似，在大多数情况下，您可以在 R 中作为 S-PLUS 程序运行，反之亦然。

[SAS](http://www.sas.com/)是另一种选择，尽管更适合 BI 和企业。SAS 的语法比 R 更简单，我认为对于非程序员来说更容易上手。

其他选项包括 SPSS、Matlab 甚至 Excel。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T21:32:48.403

我个人推荐R。我听说，它被生物信息学家和心理学家使用。不知道你的领域是什么，所以也许这是一个糟糕的选择。它相当容易使用和学习。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T21:38:25.083

[Stata](http://www.stata.com/)和[SPSS](http://www.spss.com/)往往是临床研究中最常用的软件包。对于没有技术头脑的人来说，两者都很容易上手和使用，但通常都足够灵活。我使用 Stata 比其他任何人都多，并且对它的选项非常满意（支持基于菜单和命令行的操作，足够体面的插件系统来获得新的用户创建的模块，良好的图形支持）。

[R](http://www.r-project.org/)对于新手用户来说有点令人生畏，尽管它在生物统计学家中很受欢迎。因为它是免费的，所以这是另一个有利于它的好点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T05:51:00.907

对于非技术用户可以使用的带有 GUI 的统计包，我建议您使用“SAS Enterprise Guide”。您将获得通用和高级 SAS 程序、出色的图形工具以及为技术用户编程的能力。我建议您从“SAS 学习版”（[http://support.sas.com/learn/le/](http://support.sas.com/learn/le/)）开始，它是企业指南的全功能版本，但一次只能处理 1000 行。它不到500美元，这使它成为一笔不错的交易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T21:21:31.420

我会看看[S-Plus](http://www.insightful.com/products/splus/featurelist.asp)。

您将获得一个强大的编程环境（S-Plus Workbench，基于 Eclipse 平台）、一个面向非程序员的直观 GUI，以及一个广泛的用户社区（包括基于原始 S 的 R 用户）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T21:57:23.250

[视觉数字](http://www.vni.com)是另一种选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T13:45:08.223

听起来您正在尝试最大化多个目标。你说“这将部分由非编程用户（进行临床研究）和部分程序员使用，所以我试图在可用性和自动化之间找到一个很好的折衷方案”，并隐含假设这将是在这两种情况下使用**相同**的工具，而这可能不现实。例如，Word 和 LaTeX 的折衷方案是什么？

关于要求的一些不同问题：

*   它应该对程序员可扩展吗
    *   能够使用C扩展
    *   易于制作新的程序和方法
*   非程序员想要使用什么分析？
*   图形？
*   便于不同群体使用

所以我读到这个：

易于扩展：R/S-plus、Matlab/Octave（我碰巧更喜欢 R，但我做更多的统计数据和更少的矩阵事情） 易于普通人使用：Excel、自定义包装的 R、SPSS

此外，Windows 上的 R 具有有限的 GUI，它可能会或可能不会帮助您的用户。

如果是我，我会选择混合解决方案。使用 R，并为非程序员提供常见任务的备忘单，说明常见任务，或者更好的是，编写一些名称为“image_summary”的包装函数，以自动化他们的探索工作。

对于为 R 编写前端脚本，RPy python 包装器也可能会有所帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T13:55:59.130

SAS Enterprise Guide 对非程序员有很好的可用性。此外，它有很好的连接到 Excel 的选项。对于程序员来说，它是最强大的选择。sas 服务器可以在任何东西上运行，但企业指南仅适用于 Windows。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T21:49:00.787

再考虑一下 Excel。它是众所周知的，并且可以广泛使用。参考这[本书](http://books.slashdot.org/books/08/10/01/1329243.shtml)或这[本书](https://rads.stackoverflow.com/amzn/click/com/0471387347)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-15T21:08:01.650

这个[维基百科页面](http://en.wikipedia.org/wiki/Comparison_of_statistical_packages)比较了几个统计包的可用特性，以及它们的操作系统兼容性和定价信息（这似乎有点过时，但它给出了一个整体的想法）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-14T14:28:28.133

我们最终得到了 Matlab Statistics 工具箱（主要是因为我们在团队中已经有一些使用 Matlab 的经验，并且无论如何都需要这个工具）

到目前为止，它正在做我们需要做的事情，并且很容易扩展。用法将显示非程序员是否真的使用它，但到目前为止它看起来不错。

# c# - 如何使用 FileStream 在没有排他锁的情况下附加到文件？

> ID：189239
> 
> 赞同：3
> 
> 时间：2008-10-09T21:14:06.147
> 
> 标签：c#, .net, file, stream, filestream

我`FileStream`在 C#/.NET 中尝试做的是打开两个流：一个附加到文件，另一个异步读取这些写入（用于单元测试一些网络连接处理代码）。我不知道如何让编写*器*流以非独占锁定模式打开文件，因此代码总是抛出异常：

> 该进程无法访问文件“C:\test.txt”，因为它正被另一个进程使用。

这是演示该问题的少量代码：

```
FileStream fwriter = new FileStream("C:\\test.txt", FileMode.Append,
    FileAccess.Write, FileShare.Read);
FileStream freader = new FileStream("C:\\test.txt", FileMode.Open,
    FileAccess.Read, FileShare.Read); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T21:15:34.910

看到这个问题：[C#文件读/写文件共享似乎不起作用](https://stackoverflow.com/questions/124946/c-file-readwrite-fileshare-doesnt-appear-to-work)

简而言之，您的 freader 必须指定 FileShare.Write 以允许文件上已经有一个 writer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T21:18:30.960

我不确定它是否有帮助，但是如果您只是进行单元测试，那么使用内存流而不是文件会更容易吗？

# vista64 - 分享您的 Vista 64 位体验

> ID：189252
> 
> 赞同：1
> 
> 时间：2008-10-09T21:17:21.927
> 
> 标签：vista64

我有一台戴尔 XPS M1330，它配备 2.2ghz 处理器、4gig 内存、GeForce 8400M 和 64GB SSD 磁盘。

我主要从事网络开发、共享点开发、集成（Microsoft BI 工具）和 biztalk。我将虚拟机用于这些目的。到目前为止，我一直在使用 Vista 32 位，但我正在考虑迁移到 64 位，以便开箱即用地挤出那一点额外的内存。

我想知道是否有人在相同的情况下使用过 64 位 vista，以及是否有什么让我望而却步。请记住，这是我在工作中使用的笔记本电脑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T21:21:31.420

我最近从 Vista 32 位开发机器切换到 Vista 64 位开发机器，配备四核英特尔处理器和 6gb 内存。性能改进令人印象深刻，到目前为止，我使用的任何开发工具都没有“问题”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T21:32:30.010

跳过 Vista x64 并直接迁移到具有 8gb RAM 和少量磁盘的 Win2k8。更小的内存占用，预装的垃圾更少。这些天 RAM 也很便宜——它运行得越快，你越能解决问题。

Hyper-V 也很不错 - 使用它托管 Win2k8 和 Win2k3 的实例，一些带有工具的较大 VM（>3Gb RAM），一些带有服务的较小（1Gb RAM）的 VM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T21:25:08.357

我有一台装有 Vista 64 的满载 Thinkpad W500，它运行完美，尤其是因为 VMWare Workstation 现在支持 32 位和 64 位主机工作站。我遇到的唯一问题是 Python。我根本无法让 64 位版本工作，最终在 WOW 下使用 32 位版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T21:35:11.020

我正在运行一个定制的 Intel(R) Core(TM)2 CPU 6600 @ 2.40GHz，8.00 GB，NVIDIA GeForce 7800 GT，在 Vista 64 上具有 300gb raid 0 和 15mb 缓存。只使用了一个月，但它快速稳定，没有兼容性问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T21:43:14.497

我正在运行带有 Vista 64（4GB 内存，2x512Mb 显卡）的戴尔 XPS 1730。运行 Vista64 非常好！我可以安装 4 或 5 个 VS2005 实例，并且没有发现性能下降。我对 64 位驱动程序也没有任何问题。就个人而言，如果您的硬件是新的，我想不出在开发机器上不使用 Vista64 的理由......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T21:46:01.793

Vista x64 SP1，HP 四核，4GB RAM。完美运行。任何在 64 位当然不可用的应用程序在 WoW64 下都可以正常工作。我唯一的抱怨是 IE 必须以 32 位运行，因为缺少 64 位 Flash 插件。如果您是开发人员，您应该知道 Visual Studio 也没有 64 位版本。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2008-10-09T21:34:12.050

[http://www.basicinstructions.net/images/basic081009.gif http://www.basicinstructions.net/images/basic081009.gif](http://www.basicinstructions.net/images/basic081009.gif)

对于那个很抱歉。

# c# - Problem using SQLite :memory: with NHibernate

> ID：189280
> 
> 赞同：33
> 
> 时间：2008-10-09T21:27:24.497
> 
> 标签：c#, nhibernate, sqlite, orm, integration-testing

I use NHibernate for my dataacess, and for awhile not I've been using SQLite for local integration tests. I've been using a file, but I thought I would out the :memory: option. When I fire up any of the integration tests, the database seems to be created (NHibernate spits out the table creation sql) but interfacting with the database causes an error.

Has anyone every gotten NHibernate working with an in memory database? Is it even possible? The connection string I'm using is this:

```
Data Source=:memory:;Version=3;New=True 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-10T23:54:10.180

A SQLite memory database only exists as long as the connection to it remains open. To use it in unit tests with NHibernate:
1\. Open an ISession at the beginning of your test (maybe in a [SetUp] method).
2\. Use the connection from that session in your SchemaExport call.
3\. Use that same session in your tests.
4\. Close the session at the end of your test (maybe in a [TearDown] method).

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-22T15:36:24.717

I was able to use a SQLite in-memory database and avoid having to rebuild the schema for each test by using SQLite's [support for 'Shared Cache'](http://www.sqlite.org/inmemorydb.html#sharedmemdb), which allows an in-memory database to be shared across connections.

I did the following in *AssemblyInitialize* (I'm using MSTest):

*   Configure NHibernate (Fluently) to use SQLite with the following connection string:

    ```
    FullUri=file:memorydb.db?mode=memory&cache=shared 
    ```

*   Use that configuration to create a hbm2ddl.**SchemaExport** object, and execute it on a separate connection (but with that same connection string again).

*   Leave that connection open, and referenced by a static field, until *AssemblyCleanup*, at which point it is closed and disposed of. This is because SQLite needs at least one active connection to be held on the in-memory database to know it's still required and avoid tidying up.

Before each test runs, a new session is created, and the test runs in a transaction which is rolled back at the end.

Here is an example of the test assembly-level code:

```
[TestClass]
public static class SampleAssemblySetup
{
    private const string ConnectionString = "FullUri=file:memorydb.db?mode=memory&cache=shared";
    private static SQLiteConnection _connection;

    [AssemblyInitialize]
    public static void AssemblyInit(TestContext context)
    {
        var configuration = Fluently.Configure()
                                       .Database(SQLiteConfiguration.Standard.ConnectionString(ConnectionString))
                                       .Mappings(m => m.FluentMappings.AddFromAssembly(Assembly.Load("MyMappingsAssembly")))
                                       .ExposeConfiguration(x => x.SetProperty("current_session_context_class", "call"))
                                       .BuildConfiguration();

        // Create the schema in the database
        // Because it's an in-memory database, we hold this connection open until all the tests are finished
        var schemaExport = new SchemaExport(configuration);
        _connection = new SQLiteConnection(ConnectionString);
        _connection.Open();
        schemaExport.Execute(false, true, false, _connection, null);
    }

    [AssemblyCleanup]
    public static void AssemblyTearDown()
    {
        if (_connection != null)
        {
            _connection.Dispose();
            _connection = null;
        }
    }
} 
```

And a base class for each unit test class/fixture:

```
public class TestBase
{
    [TestInitialize]
    public virtual void Initialize()
    {
        NHibernateBootstrapper.InitializeSession();
        var transaction = SessionFactory.Current.GetCurrentSession().BeginTransaction();
    }

    [TestCleanup]
    public virtual void Cleanup()
    {
        var currentSession = SessionFactory.Current.GetCurrentSession();
        if (currentSession.Transaction != null)
        {
            currentSession.Transaction.Rollback();
            currentSession.Close();
        }

        NHibernateBootstrapper.CleanupSession();
    }
} 
```

Resource management could improve, I admit, but these are unit tests after all (suggested improvements welcome!).

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-13T08:09:42.113

We are using SQLite in memory for all our database tests. We are using a single ADO connection for the tests that is reused for all NH sessions opened by the same test.

1.  Before every test: create connection
2.  Create schema on this connection
3.  Run test. The same connection is used for all sessions
4.  After test: close connection

This allows also running tests with several sessions included. The SessionFactory is also created once for all tests, because the reading of the mapping files takes quite some time.

* * *

Edit

## Use of the Shared Cache

Since System.Data.Sqlite 1.0.82 (or [Sqlite 3.7.13](http://www.sqlite.org/releaselog/3_7_13.html)), there is a [Shared Cache](http://www.sqlite.org/sharedcache.html), which allows several connections to share the same data, also for [In-Memory databases](http://www.sqlite.org/inmemorydb.html). This allows creation of the in-memory-database in one connection, and use it in another. (I didn't try it yet, but in theory, this should work):

*   Change the connection string to `file::memory:?cache=shared`
*   Open a connection and create the schema
*   Keep this connection open until the end of the test
*   Let NH create other connections (normal behavior) during the test.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-12-21T16:51:01.463

I had similar problems that lasted even after opening the ISession as stated above, and adding "Pooling=True;Max Pool Size=1" to my connection string. It helped, but I still had some cases where the connection would close during a test (usually right after committing a transaction).

What finally worked for me was setting the property "connection.release_mode" to "on_close" in my SessionFactory configuration.

My configuration in the app.config file now look likes this:

```
 <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <reflection-optimizer use="true" />
    <session-factory>
      <property name="connection.connection_string_name">testSqlLiteDB</property>
      <property name="connection.driver_class">NHibernate.Driver.SQLite20Driver</property>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="connection.release_mode">on_close</property>
      <property name="dialect">NHibernate.Dialect.SQLiteDialect</property>
      <property name="proxyfactory.factory_class">NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>
      <property name="query.substitutions">true=1;false=0</property>
    </session-factory>
  </hibernate-configuration> 
```

Hope it helps!

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T16:13:45.843

I hade alot off problems with SQLite memory database. So now we are using SQLite working with files on a ramdrive disk.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T16:13:51.810

Just a wild guess, but is the sql output by NHibernate using a command unsupported by sqlite?

Also, What happens if you use a file instead of memory? (System.IO.Path.GetTempFileName() would work i think...)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T03:23:20.687

I am doing it with [Rhino Commons](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/rhino-commons/). If you don't want to use Rhino Commons you can study the source do see how it does it. The only problem I have had is that SQLite does not support nested transactions. This forced me to change my code to support integration testing. Integration testing with in memory database is so awesome, I decided it was a fair compromise.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-09T17:01:31.150

Just want to thank decates. Been trying to solve this for a couple of months now and all I had to do was add

```
FullUri=file:memorydb.db?mode=memory&cache=shared 
```

to the connection string in my nhibernate config file. Also using just NHibernate with *.hbm.xml and not FNH and didn't really have to modify my code at all!

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-11T13:20:18.323

I got the same error, when I forgot to import the SQLite Nuget package.

# eclipse - 在 Valgrind 下运行 Eclipse

> ID：189284
> 
> 赞同：4
> 
> 时间：2008-10-09T21:28:43.807
> 
> 标签：eclipse, valgrind

这里有人在[Valgrind](http://valgrind.org/)下成功运行 Eclipse吗？我正在与涉及 JNI 代码的特别毛茸茸的崩溃作斗争，并希望 Valgrind 可能（再次）证明它的卓越性，但是当我在 Valgrind 下运行 Eclipse 时，JVM 以无法创建初始对象的错误消息终止堆（我目前无法访问确切的错误消息；我会尽快编辑这篇文章。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T17:41:49.587

如果您[使用 --smc-check=all 运行 valgrind](http://valgrind.org/docs/manual/faq.html#faq.java)是否有效？

此外——valgrind 极大地增加了程序的内存需求。对于像 Eclipse 这样大的东西，有很多麻烦的地方；希望你是 64 位原生的（因此有足够的地址空间）并且有大量的 RAM 和/或交换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T18:02:37.917

如果本机代码发生崩溃，那么 gdb 可能是更好的选择。它甚至应该在崩溃时自动停止执行，并可能向您显示堆栈跟踪（命令*bt*）。

# winforms - 用于窗体设计和提高可用性的资源

> ID：189286
> 
> 赞同：5
> 
> 时间：2008-10-09T21:29:21.187
> 
> 标签：winforms, user-interface

我拥有的用于 UI 设计的大部分资源都与网络世界有关。由于表示层的动态特性，那里有许多优点。

但是，我想设计更好的 Windows 窗体程序。我想要一个专业的流程到我的应用程序。现在它们使用 WPF 看起来很漂亮，但事件似乎脱节（即几乎不自然的进展），我真的不知道如何设计一个好的（可用性方面）界面。有没有人写关于这种事情的博客？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T21:34:37.353

尝试将 WPF 视为开发 Windows 应用程序的技术，然后您可以使用大量矢量图形 (XAML)，比使用 Windows 窗体可以做的更多。有一个很棒的博客比较了[http://joshsmithonwpf.wordpress.com/2007/09/05/wpf-vs-windows-forms/](http://joshsmithonwpf.wordpress.com/2007/09/05/wpf-vs-windows-forms/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T21:34:58.367

[http://windowsclient.net/](http://windowsclient.net/)是一个 Microsoft 的 windows 窗体站点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T20:39:03.813

您可能还想查看[http://msdn.microsoft.com/en-us/library/aa511258.aspx](http://msdn.microsoft.com/en-us/library/aa511258.aspx)或[PDF](http://download.microsoft.com/download/e/1/9/e191fd8c-bce8-4dba-a9d5-2d4e3f3ec1d3/ux%20guide.pdf)中的“Windows 用户体验交互指南”或 UX 指南。以下是网站上列出的目标：

> *   为所有基于 Windows 的应用程序建立高质量和一致性基线。
> *   回答您的特定用户体验问题。
> *   让您的工作更轻松！

# php - 自动从网页获取报告

> ID：189288
> 
> 赞同：0
> 
> 时间：2008-10-09T21:30:47.157
> 
> 标签：php, post, automation, scripting, greasemonkey

我是一名 Java 开发人员，我有一个关于自动执行给我的任务的问题。

我每天必须登录 3 次，登录我们工作中的这个网站，选择一些表单元素，然后单击提交以打印出报告。

我想知道如何编写某种脚本来自动执行此任务？我应该从哪里开始？我应该用什么语言来做？我在想PHP可能能够做到这一点，甚至可能是一个greasemonkey脚本？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T21:57:03.643

查看PHP 中的[cURL](http://php.net/curl)。它允许您使用代码执行 Web 浏览器的所有正常功能（除了移动鼠标）。是的，您需要进行屏幕抓取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T21:50:03.750

我认为尚未触及的潜在症结是您的短语“登录到该网站”......根据您需要登录的方式，您可能需要通过后门进入以访问报告。

过去，当我不得不从第三方网站下载报告时，我遇到过此类问题。问题是我无法通过身份验证访问报告参数，因为我需要以硬编码且对脚本不太友好的方式登录该站点。但是，我认为您的网站在您的组织内部，因此可能会绕过/修改安全要求以访问数据。如果是这种情况，那么您应该能够使用上述屏幕抓取方法之一。

如果没有，您可能需要将实际登录过程合并到您的脚本或应用程序中，下载并捕获可能设置的任何 cookie 并将它们合并到您的数据请求中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T21:33:55.577

它被称为“网络抓取”或“屏幕抓取”，并且有很多库可以做到这一点。但是，我无法使用特定于 Java 的工具：我是一个 .Net 人（.Net 方式是 System.Net.WebClient 或 System.Net.HttpWebRequest/System.Net.HttpWebResponse）。但我敢肯定有什么东西。

同时，第一步是进入您输入表单值的页面并查看页面的来源。查找您要填写的特定 <form> 元素，并查看它发布到的位置（它是*action*）。然后，找到您使用的任何 <input> <select>、<textarea> 元素，包括表单的任何隐藏输入，并找出您需要获取的值。一旦你找到一个可以让你发送请求的库，这将告诉你如何构建你的请求。

如果您需要先登录网站才能访问该页面，事情可能会更复杂。您可能需要检索和解析会话值，或者能够将某些 cookie 发送到服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T21:34:39.507

我不知道你的表格是用什么语言写的，但你可以做的是：

*   将表单重写为调用时生成报告的脚本
*   使用[cron](http://en.wikipedia.org/wiki/Cron)条目来安排此任务每天完成并将输出邮寄给您

cron 基本上是 Unix 系统上的计划任务。基于 Windows 的服务器可以使用任务计划程序来达到同样的目的。

以上假设您现在可以访问生成报告的脚本，并且可以对其进行修改/将其复制到一个新文件中，该文件将通过电子邮件将输出发送给您。如果没有，那么您可能需要查看屏幕抓取。作为一名 Java 开发人员，您可能会发现[这个 Java 屏幕抓取实用程序列表](http://www.manageability.org/blog/stuff/screen-scraping-tools-written-in-java)可以方便地帮助您入门。

# emacs - Emacs - Ubuntu 初始化

> ID：189291
> 
> 赞同：8
> 
> 时间：2008-10-09T21:31:17.127
> 
> 标签：emacs, ubuntu

在 ubuntu 上加载 emacs 的奇怪行为，似乎有一些初始化不在 .emacs 中，也不在 emacs 通过“emacs --debug-init”报告加载的任何文件中。我发现了一些与字体相关的调整大小的参考，但这种行为似乎并不局限于此（例如，重新出现菜单和工具栏）。

有没有人有任何关于 emacs 初始化过程的额外信息？它是否在 .emacs 之前或之后加载 /etc/emacs/site-start.d 文件，默认情况下是否加载其他位置？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T00:15:02.630

Emacs 初始化的顺序如下（至少，对于 Emacs 22）：

1.  *加载在加载路径*中找到的文件*debian-startup*（.el 或 .elc）（通常是*/usr/share/emacs/site-lisp/debian-startup.el*或*/usr/share/emacs22/site-lisp/debian -startup.elc* ) 并调用此文件中定义的函数*debian-startup 。*此函数加载*/etc/emacs/site-start.d/*和*/etc/emacs22/site-start.d/*中的所有文件。
****   加载在*load-path中找到的**site-start*（.el 或 .elc）。**   加载您的初始化文件*.emacs*、*.emacs.el*或*~/.emacs.d/init.el*。*   加载默认初始化文件*default.el*或*default.elc*。****

 **我还建议您阅读*/usr/share/doc/emacsen-common/debian-emacs-policy.gz中的“* **Emacs 启动策略**”部分以获取更多 Ubuntu/Debian 特定信息。要查找异常行为的原因，您可以使用参数*--no-site-file*启动 emacs 并逐个加载这些 init 文件，直到找到导致此行为的文件。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-29T13:29:52.713

我找到了介绍 emacs 初始化步骤的官方文档： [http ://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html)

> 当 Emacs 启动时，它通常会尝试从初始化文件或简称为 init 文件中加载 Lisp 程序。该文件（如果存在）指定如何为您初始化 Emacs。Emacs 使用文件名 ~/.emacs、~/.emacs.el 或 ~/.emacs.d/init.el 查找您的 init 文件；您可以选择使用这三个名称中的任何一个（请参阅[Find Init](http://www.gnu.org/software/emacs/manual/html_node/emacs/Find-Init.html#Find-Init)）。在这里，~/ 代表你的主目录。

# perl - 如何从命令行获取文件句柄？

> ID：189293
> 
> 赞同：3
> 
> 时间：2008-10-09T21:32:27.747
> 
> 标签：perl, filehandle

我有一个将文件句柄作为参数的子例程。如何从命令行上指定的文件路径创建文件句柄？我不想自己对这个文件进行任何处理，我只想将它传递给另一个子程序，它返回一个包含文件中所有已解析数据的哈希数组。

这是我正在使用的命令行输入的样子：

`$ ./getfile.pl /path/to/some/file.csv`

这是我正在调用的子程序的开头部分：

```
sub parse {
    my $handle = shift;
    my @data   = <$handle>;
    while (my $line = shift(@data)) {
      # do stuff
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T21:39:00.310

命令行参数在预定义`@ARGV`数组中可用。您可以从那里获取文件名并用于`open`打开它的文件句柄。假设您想要对该文件进行只读访问，您可以这样做：

```
my $file = shift @ARGV;
open(my $fh, '<', $file) or die "Can't read file '$file' [$!]\n";
parse($fh); 
```

请注意，`or die...`检查调用`open`是否成功，如果不是，则会显示错误消息。内置变量`$!`将包含（取决于操作系统的）失败错误消息，告诉您调用不成功的原因。例如“权限被拒绝”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T01:42:53.997

`parse(*ARGV)`是最简单的解决方案：解释有点长，但是学习如何有效使用 Perl 的一个重要部分是学习 Perl。

当您使用空文件句柄 ( `<>`) 时，它实际上是从`ARGV`具有特殊语义的神奇文件句柄中读取的：它从名为 in 的所有文件中读取`@ARGV`，或者`STDIN`如果`@ARGV`为空。

来自`perldoc perlop`：

> 空文件句柄`<>`很特殊：它可以用来模拟 sed 和 awk 的行为。输入来自`<>`标准输入或命令行中列出的每个文件。它是这样工作的：第一次`<>`求值，`@ARGV`检查数组，如果它为空，`$ARGV[0]`则设置为`"-"`，打开时为您提供标准输入。然后将该`@ARGV`数组作为文件名列表进行处理。循环
> 
> ```
> while (<>) {
>     ...                     # code for each line
> } 
> ```
> 
> 等效于以下类似 Perl 的伪代码：
> 
> ```
> unshift(@ARGV, '-') unless @ARGV;
> while ($ARGV = shift) {
>     open(ARGV, $ARGV);
>     while (<ARGV>) {
>         ...         # code for each line
>     }
> } 
> ```
> 
> 除了说起来不那么麻烦，而且实际上会起作用。它确实移动了`@ARGV`数组并将当前文件名放入 `$ARGV`变量中。它还在`ARGV`内部使用文件句柄`<>`——只是 的同义词`<ARGV>`，这很神奇。（上面的伪代码不起作用，因为它被视为`<ARGV>`非魔法。）

您不必`<>`在`while`循环中使用——`my $data = <>`将从第一个非空文件中读取一行，一次`my @data = <>;`将其全部吞下，您可以`*ARGV`像普通文件句柄一样传递。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T20:14:57.017

这就是 -n 开关的用途！

采用您的 parse 方法，然后执行以下操作：

```
#!/usr/bin/perl -n

#do stuff 
```

每行都存储在 $_ 中。所以你跑

./getfile.pl /path/to.csv

它做到了这一点。

有关这些的更多信息，请参见[此处](http://www.perl.com/pub/a/2004/08/09/commandline.html?page=2 "这里")和[此处。](http://perldoc.perl.org/perlrun.html)我也喜欢 -p，并且发现 -a 和 -F 的组合非常有用。

此外，如果您想做一些额外的处理，请添加 BEGIN 和 end 块。

```
#!/usr/bin/perl -n

BEGIN {
  my $accumulator;
}

# do stuff

END {
  print process_total($accumulator);
} 
```

管他呢。这是非常非常有用的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-09T21:36:16.837

我错过了什么还是你只是在寻找 open() 电话？

```
open($fh, "<$ARGV[0]") or die "couldn't open $ARGV[0]: $!";
do_something_with_fh($fh);
close($fh); 
```

# process-management - 帮助管理企业环境中的应用程序升级过程的工具

> ID：189303
> 
> 赞同：1
> 
> 时间：2008-10-09T21:34:36.620
> 
> 标签：process-management

我很好奇其他人如何在企业内管理从 DEV 到 TEST 到 PROD 的代码提升。

您使用什么工具或流程来管理“繁文缛节”、进入/退出标准方面？

我目前的组织在一些自定义在线表单类型功能和基于纸张的依赖项之间陷入了一半的困境，以提交文件、收集批准和审查。

所有这一切都留给项目经理来跟踪已提交、通过审查、批准的内容，并在应用程序升级到下一个环境之前，如果有任何需要批准才能“忽略”的障碍，则向管理层提出建议。

基于浏览器的应用程序将是理想的......那么那里有什么？请告诉我你的googlefu比我的好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T22:50:25.920

通过 google 很难找到一个好的。有大量用于问题管理的工具，所以我会提到我们使用什么以及我们想使用什么。

我们目前使用的是 serena 产品。他们在过去为我们工作得很好。Team Track 是我们的问题管理，处理我们处理的任何问题的生命周期。Version Manager 是我们的源代码控制，具有实施 DEV TEST 和 PROD 等促销组的功能。我们使用 DEV、TSTAGE、TEST、PSTAGE 和 PROD 来表示从一个到另一个的移动，但它们大致相同。这两个产品很好地集成在一起，因此与问题相关的源是链接的，但是我们在这个环境中没有构建过程设置。它很贵，但效果很好。

我们正在寻找一个更通用的系统，使用 Jira 进行问题管理，Subversion 进行源代码控制，Fisheye 将两者联系在一起，Cruise Control 进行构建管理。这更便宜，企业许可总共需要几千美元，并提供所有相同的功能，但还有 SVN 的额外好处，这是一个非常好的代码版本管理器。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T23:11:33.570

这些年来，我经历了几种不同的情况：

开发 -> 测试：通常有一个代码冻结日期，该日期停止新功能的工作并获得一个测试环境，该测试环境已经构建了已标记/标记/存档的代码。然后将其复制到机器上，测试顺利进行。这通常也是所有推送中最不详细的。

Test->Prod ：这需要对生产进行较小的更改，这可能意味着“钓鱼”页面上升或 IIS 没有任何站点正在运行并且代码被再次复制。在某些特殊情况下，负载均衡器可以充当交换机，以便进行促销，并且没有客户遇到任何停机时间，因为旧服务器上的客户将在会话结束后移动。

为了详细说明切换的想法，设置是有 2 个可能处于活动状态的服务器，其中只有一个服务器接受请求，负载均衡器只将所有流量发送到一台机器，当另一台服务器有更新的代码上线时可以切换.

还可以有一个介于测试和生产之间的暂存环境，其中的过程是相似的，因为促销发生的日期是固定的。

在我以前工作的地方会有合并日，开发人员在 Perforce 中花费大部分时间合并代码，以便可以将其从一个环境提升到另一个环境。

现在有几种情况不使用它：

“修补程序”或“热补丁”会出现在我以前工作的地方，在这种情况下，特定文件会自行复制到登台和生产环境中，因为代码更改必须尽快进入生产环境，因为生产中出现问题或一些必须完成的新事物需要 2 分钟才能完成。在这种情况下，被推送的代码更改必须在退出前经过审查和批准。

这些是我见过的不同方法，通常可能需要更改时间表和时间表，或者引入额外的资源来确定一个艰难的日期，例如会议是否在某个特定的周末举行，而某某已为此做好了准备。

当然，在一些地方出现了“哦，那是坏的吗？让我看看……”，几分钟后，“不，看它对我来说没有坏”，有人在没有问的情况下改变了事情许可或任何公司仍然拥有他们所谓的“牛仔编程”的东西。

另一点是发布的规模： 1) Tiny - 这是一个网页上升以便用户 X 可以做 Y 的情况。

2) 小 - 少量的文件，这些文件并不复杂，但也不是微不足道的。

3) 中等 - 从一个环境转移到另一个环境需要更改一堆文件，并且通常需要移动脚本。

4) 大 - 有预定的促销活动，并且当实时推送完成时，会询问各种开发人员谁在轮班。除了发布一些新的电子商务网站外，我还需要进行数据迁移。

5) 猛犸象 - 一切都是全新的，包括如何使用它。我认为我从未见过这种尺寸的产品，但我想微软或谷歌会发布这种尺寸的产品。

在这个范围内的某个地方，大多数版本都会下降，因此多少计划和准备可能会有很大差异，我们不要忘记，监管合规性可能是完成某些事情的痛苦。

# networking - 在 PowerShell 中检查网络服务器上的 IP 地址开关的好方法是什么？

> ID：189308
> 
> 赞同：4
> 
> 时间：2008-10-09T21:35:12.797
> 
> 标签：networking, powershell

## 问题

我们的网络主机提供商正在更改我们所在的其中一台服务器的 IP 地址。我们已经获得了切换何时发生的时间框架，但没有确切的细节。因此，我们目前*的穷人*检查需要在浏览器上定期刷新页面以查看我们的网站是否仍然存在。

## 问题

我们都是这里的程序员，这让我很生气，需要任何手动检查。我会知道如何用其他语言做到这一点，但想知道是否有办法在**PowerShell**中编写脚本来解决这个问题。有谁知道我会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T01:16:56.907

如果您可以在页面消失或没有预期值时发出警报，您可以使用类似的脚本

```
$ip = 192.168.1.1
$webclient = new-object System.Net.WebClient
$regex = 'regular expression to match something on your page'
$ping = new-object System.Net.NetworkInformation.Ping

do 
{
  $result = $ping.Send($ip)
  if ($result.status -ne 'TimedOut' )
  {
    $page = $webclient.downloadstring("http://$ip")
    if (($page -notmatch $regex) -or ($page -match '404') -or ($page -eq $null))
    { break}
  }
} while ($true)

write-host "The website has moved" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T00:05:29.827

这将列出系统中每个网络适配器的 IP 地址。

```
Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter IPEnabled=TRUE -ComputerName . | Select-Object -Property IPAddress 
```

# java - 在客户端站点上没有为 NullPointerException 生成堆栈跟踪？

> ID：189318
> 
> 赞同：1
> 
> 时间：2008-10-09T21:39:24.787
> 
> 标签：java, client, stack-trace, nullpointerexception

我已经学习 Java 大约一个月了，对这样的客户端/服务器情况还不是很熟悉。

基本上我遇到了这样一种情况，我们的客户端 Java 软件 (GUI) 显示了一个 nullpointerexception 弹出窗口，但在客户端没有堆栈跟踪。有人不得不去检查服务器端的堆栈跟踪。

我的问题是，客户端不应该也收到这些宝贵的信息吗？这样的情况可以吗，理由是只需要一份堆栈跟踪副本吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T21:46:49.607

并不真地。不建议向客户端展示您的应用程序的工作方式。主要是出于安全原因。您的堆栈跟踪显示所有被调用的对象、方法以及是否使用调试信息编译，甚至是行。这对客户端来说信息太多了，放在服务器上就可以了。

这在 SQL 注入、跨端脚本和其他我不记得的情况中，不正确的异常处理是一个安全漏洞。

编辑：这里有其他漏洞（虽然我没有看到这个：（）

[http://en.wikipedia.org/wiki/Vulnerability_（计算）](http://en.wikipedia.org/wiki/Vulnerability_(computing))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T06:30:23.497

客户只需要知道它需要知道的帽子。在很多情况下，在您的客户端上不显示任何堆栈跟踪是完全可以的。您的用户应该得到明确的错误消息，但不关心堆栈跟踪。

出于调试目的，堆栈跟踪通常会丢失，应用程序给出错误，用户重新启动它并消失是任何异常，因此如果您需要知道错误，请使用日志框架。

# emacs - Emacs 中是否有适用于 Visual Basic (VB6) 的模式？

> ID：189323
> 
> 赞同：9
> 
> 时间：2008-10-09T21:41:41.643
> 
> 标签：emacs, vb6

我想使用 Emacs 编辑一些 VB6 文件，但 Emacs 似乎没有任何其他语言的内置细节，例如语法突出显示等。

任何插件/扩展？我还能做些什么来使 Emacs 成为 VB 的可接受且舒适的 IDE？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T21:48:54.343

Visual Basic 模式

[http://www.emacswiki.org/cgi-bin/wiki/visual-basic-mode.el](http://www.emacswiki.org/cgi-bin/wiki/visual-basic-mode.el)

编辑：安装此脚本后（请参阅脚本以获取说明）可以通过选项菜单切换语法突出显示——emacs 将其称为“font-lock”:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-15T13:38:19.510

[http://xahlee.org/visual_basic/emacs_visualbasic_mode.html](http://xahlee.org/visual_basic/emacs_visualbasic_mode.html)

[http://www.emacswiki.org/emacs/VisualBasicMode](http://www.emacswiki.org/emacs/VisualBasicMode)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T08:50:52.427

对于 VB.NET，还有一个[VBNET 模式](http://www.emacswiki.org/emacs/VbDotNetMode)。

# silverlight - 如何在 ItemsControl 中获取可视元素

> ID：189335
> 
> 赞同：0
> 
> 时间：2008-10-09T21:48:43.160
> 
> 标签：silverlight, silverlight-2.0

我在 ItemsControl 中有一个状态列表，DataTemplate 是一个 CheckBox。我想添加一个函数来选择（检查）所有状态。但是，我需要遍历 CheckBoxs 而不是数据项，因为选中状态存储在单独的数据结构中，然后是 ItemsControl 的 ItemSource 绑定到的状态列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T07:25:06.617

在 DataObject 中有一个名为 IsChecked 的属性，并将其绑定到 DataTemplate 中的复选框（默认为 TwoWay）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T16:23:57.087

在数据模板中，我订阅了复选框的 onload 事件。在事件处理程序中，我将复选框引用添加到复选框的通用列表。

# css - 如何修复 Drupal CSS URL 错误？

> ID：189339
> 
> 赞同：0
> 
> 时间：2008-10-09T21:49:34.873
> 
> 标签：css, drupal

我刚刚安装了新的 Drupal 6。CSS没有工作。然后我意识到附加了一个“？U”，而Drupal找不到它。有谁知道在哪里取消这个？

```
<link type="text/css" rel="stylesheet" media="all" href="/modules/node/node.css?U" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/admin.css?U" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/defaults.css?U" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system.css?U" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system-menus.css?U" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/user/user.css?U" />
<link type="text/css" rel="stylesheet" media="all" href="/themes/bluemarine/style.css?U" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T22:11:23.253

?U（或实际上任何字母表）只是 drupal 用于缓存信息的一种方法。它与文件的位置无关（即node.css 和node.css？U 与drupal 位于同一位置）。

听起来你可能有不同的问题。也许您启用了缓存并移动了东西？您可能需要清除缓存。或者，如果您修改了安装变量，则可能您选择了错误的基本路径或其他东西。根据所提供的有限信息，很难说出确切的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T23:10:09.080

你是对的。是因为缓存。我将 nginx 配置为直接提供 css 文件。但是在我修改配置后，它现在可以正常工作了。谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T22:17:14.240

您是否将 Drupal 安装到子目录中？喜欢：

```
http://domain.com/drupal 
```

这肯定会导致您所说的问题，尽管 Drupal 应该对此进行适当的调整。

# c++ - 检测二进制文件的 GCC 编译时标志

> ID：189350
> 
> 赞同：25
> 
> 时间：2008-10-09T21:53:44.803
> 
> 标签：c++, c, gcc

有没有办法找出特定二进制文件编译时使用的 gcc 标志？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-09T22:58:46.403

快速浏览一下 GCC 文档并没有发现任何问题。

Boost 家伙是一些最聪明的 C++ 开发人员，他们[采用](http://www.boost.org/doc/libs/1_36_0/more/getting_started/unix-variants.html#library-naming)命名[约定](http://www.boost.org/doc/libs/1_36_0/more/getting_started/windows.html#library-naming)，因为这通常是任何其他方式都不可能的（毕竟，可执行文件可以由任意数量的编译器版本以任意数量的语言创建）。

* * *

（后来添加）： [如果在编译代码时要求，GCC 在 4.3 中具有此功能](http://dberkholz.wordpress.com/2007/10/12/new-gcc-hotness/?referer=sphere_related_content/)：

> 一个新的命令行开关 -frecord-gcc-switches ... 导致用于调用编译器的命令行被记录到正在创建的目标文件中。此录音的确切格式取决于目标和二进制文件格式，但通常采用包含 ASCII 文本的注释部分的形式。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-04T14:51:43.247

实验证明：

```
diciu$ gcc -O2 /tmp/tt.c -o /tmp/a.out.o2
diciu$ gcc -O3 /tmp/tt.c -o /tmp/a.out.o3
diciu$ diff /tmp/a.out.o3 /tmp/a.out.o2 
diciu$ 
```

我认为这是一个不，因为二进制文件是相同的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T15:29:22.507

我是最初要求 Brian 发布此内容的人。我的问题与 samba 二进制文件有关。我发现您可以运行`smb -b`以获取有关其构建方式的信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T22:01:37.330

我不这么认为。

您可以查看它是否具有调试符号，这意味着使用了 -g ;) 但是我想不出任何方法可以找出哪些目录已用于搜索包含标题。

如果您只针对特定标志，也许会有更好的答案；例如，如果您只想知道在编译此二进制文件时是否设置了标志“...”。在那种情况下，这将是什么标志？

# .net - 什么是 IL 编织？

> ID：189359
> 
> 赞同：62
> 
> 时间：2008-10-09T21:57:14.250
> 
> 标签：.net, postsharp

我今天刚看到[Ayende](http://ayende.com/Blog/archive/2008/10/09/first-steps-with-post-sharp.aspx)关于 PostSharp 的帖子。我下载了代码并试用了一下，我认为这是我见过的最酷、最容易使用的 AOP 处理方式。

Ayende 在他的帖子中说 PostSharp 通过**IL Weaving**实现了它的魔力。现在，在某个抽象层面上，我可以推断出这意味着什么，但我想看看是否有更详细的答案。不幸的是，很长一段时间以来第一次，谷歌对我来说是空的。所以我认为这对于 StackOverflow 来说是一个很好的问题（因为我已经订阅 Jeff 的博客几年了，并且知道这个网站正在做它的事情）。

那么 IL Weaving 究竟是什么以及它是如何实现的呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-09T22:04:42.783

编织是指将功能注入现有程序的过程。这可以在概念上在多个级别上完成：

*   源代码编织会在代码编译之前注入源代码行
*   IL weaving（用于 .NET）将代码作为 IL 指令添加到程序集中
*   ByteCode weaving (for Java) 适用于类文件，请参阅这些注释 wrt [AspectJ](http://www.eclipse.org/aspectj/doc/released/devguide/bytecode-concepts.html)

从理论上讲，您可以更深入地使用编译为本机指令的可执行文件进行编织，但这会增加很多复杂性，而且我不知道有什么这样做的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-09T22:00:17.037

IL Weaving 类似于 ByteCode Weaving。.Net 编译为由 .NET clr 运行的中间语言。IL Weaving 基本上是在分析和改变中间语言。因为它是在那个级别完成的，所以它可以为所有 .NET 语言完成。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T22:02:27.423

如果您改为使用 Google MSIL Injection 可能会有所帮助。这个链接来自[PostSharp](http://www.sharpcrafters.com/aop.net/msil-injection)，它解释得很好。

我的公司最近购买了一款名为 dynaTrace 的产品，用于性能诊断。它使用 MSIL 注入来检测方法。基本上它会在你的方法之前和之后添加 IL 代码（我相信它还有很多）。

这是一个相当[复杂](http://download.microsoft.com/download/3/a/7/3a7fa450-1f33-41f7-9e6d-3aa95b5a6aea/MSDNMagazineSeptember2003en-us.chm)但很好的过程解释。

# asp.net - 连接强制关闭错误

> ID：189362
> 
> 赞同：3
> 
> 时间：2008-10-09T21:58:02.890
> 
> 标签：asp.net, download, connection, webclient

我正在使用 ASP.NET WebClient.DownloadFile(url) 从我们几个客户端的图像服务器获取图像。“url”通常很简单，例如“ [http://somewhere.com/images/image01.jpg](http://somewhere.com/images/image01.jpg) ”。

这对我们 99% 的客户都很有效。但一个是给我一个“现有的连接被远程主机强行关闭”。每次。

我尝试使用 DownloadData() 代替，同样的问题。我可以通过浏览器获取图像，但不能使用 WebClient。

有人有什么建议吗？

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T12:27:10.127

一些服务器会寻找特定的用户代理字符串，以防止机器人和其他窃取站点下载图像。查看您在 webclient 中设置的用户代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T05:30:38.860

当您请求该文件时，可能值得使用诸如 HttpFox FireFox 插件之类的东西来准确查看服务器在做什么，因为它可能正在做一些“奇怪”的事情，比如在下载之前设置/读取跟踪 cookie（只是一个随机示例） .

它不会解决问题，但它可能会让您了解 WebClient 不处理它的原因。

# regex - 正则表达式查找包含序列但不包含不同序列的行

> ID：189363
> 
> 赞同：3
> 
> 时间：2008-10-09T21:58:45.620
> 
> 标签：regex, string, search, notepad++

如何编写正则表达式来查找所有包含 665 且没有 .pdf 的行

我似乎无法在正则表达式中找到如何做。如果重要，这适用于 Notepad++ 语法。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T04:02:43.187

如果`.pdf`仅在 之后发生`665`，则负前瞻断言`665(?!.*\.pdf)`应该可以正常工作。否则，我更喜欢使用两个正则表达式，一个匹配，一个失败。在 Perl 语法中，这将是：

```
/665/ && !/\.pdf/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T22:05:45.373

您正在寻找的功能是前瞻模式

```
665(?!.*\.pdf) 
```

# php-gtk - 单击php-gtk上的关闭按钮时如何更改调用的函数？

> ID：189365
> 
> 赞同：0
> 
> 时间：2008-10-09T21:59:50.813
> 
> 标签：php-gtk

我在php-gtk上加载了一个窗口的单个实例，我有一个名为“取消”的按钮，它隐藏（）；窗口，所以当再次需要窗口时，我只需要显示（）；。

但是当我点击关闭按钮而不是取消按钮时，窗口被破坏了。即使我重定向事件（我不确定我是否做对了），它也会调用第一个（只是 hide() 函数），然后调用 destroy 方法。

任何的想法？

PD：我不想破坏和重新创建窗口，因为 php 的垃圾收集器很糟糕，并且能够维护以前的数据而不必重新填充整个窗口（毕竟应该是桌面应用程序）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-09T22:22:41.483

遵循此处的建议：[delete-event](http://gtk.php.net/manual1/en/gtk.gtkwidget.signal.delete-event.php)。

我更改了代码以返回 TRUE：

```
function on_multipleCancelButton_activate()
{
  global $GladeMultiple;

  $MultipleWindow = $GladeMultiple->get_widget('multipleWindow');
  $MultipleWindow->hide();

  return TRUE;
} 
```

在 GTK 设计器上，我将删除事件链接到此函数。

# lucene - Lucene.Net 搜索结果突出显示搜索关键字

> ID：189366
> 
> 赞同：17
> 
> 时间：2008-10-09T22:00:00.640
> 
> 标签：lucene, lucene.net

我使用 Lucene.Net 来索引一些文档。我想向用户展示几行关于为什么该文档在结果集中的原因。就像您使用谷歌搜索时一样，它会显示链接，然后链接后面有几行突出显示了关键字。有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-09T22:38:44.587

当您有结果时，您可以通过类似于以下的方法将索引文本与查询一起传递：

```
public string GeneratePreviewText(Query q, string text)
{
    QueryScorer scorer = new QueryScorer(q);
    Formatter formatter = new SimpleHTMLFormatter(highlightStartTag, highlightEndTag);
    Highlighter highlighter = new Highlighter(formatter, scorer);
    highlighter.SetTextFragmenter(new SimpleFragmenter(fragmentLength));
    TokenStream stream = new StandardAnalyzer().TokenStream(new StringReader(text));
    return highlighter.GetBestFragments(stream, text, fragmentCount, fragmentSeparator);
} 
```

# php - 创建图像而不将其存储为本地文件

> ID：189368
> 
> 赞同：12
> 
> 时间：2008-10-09T22:00:14.883
> 
> 标签：php, image, jpeg, gd

这是我的情况 - 我想从用户上传的图像创建一个调整大小的 jpeg 图像，然后将其发送到 S3 进行存储，但我希望避免将调整大小的 jpeg 写入磁盘，然后为 S3 请求重新加载它。

有没有办法在内存中完全做到这一点，图像数据 JPEG 格式，保存在变量中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-01T01:00:06.977

大多数使用 PHP 的人选择[ImageMagick](http://www.php.net/manual/en/book.imagick.php) 或[Gd2](http://www.php.net/manual/en/ref.image.php)

我从未使用过 Imagemagick；Gd2方法：

```
<?php

// assuming your uploaded file was 'userFileName'

if ( ! is_uploaded_file(validateFilePath($_FILES[$userFileName]['tmp_name'])) ) {
    trigger_error('not an uploaded file', E_USER_ERROR);
}
$srcImage = imagecreatefromjpeg( $_FILES[$userFileName]['tmp_name'] );

// Resize your image (copy from srcImage to dstImage)
imagecopyresampled($dstImage, $srcImage, 0, 0, 0, 0, RESIZED_IMAGE_WIDTH, RESIZED_IMAGE_HEIGHT, imagesx($srcImage), imagesy($srcImage));

// Storing your resized image in a variable
ob_start(); // start a new output buffer
  imagejpeg( $dstImage, NULL, JPEG_QUALITY);
  $resizedJpegData = ob_get_contents();
ob_end_clean(); // stop this output buffer

// free up unused memmory (if images are expected to be large)
unset($srcImage);
unset($dstImage);

// your resized jpeg data is now in $resizedJpegData
// Use your Undesigned method calls to store the data.

// (Many people want to send it as a Hex stream to the DB:)
$dbHandle->storeResizedImage( $resizedJpegData );
?> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-01T00:38:56.443

这可以使用 GD 库和输出缓冲来完成。我不知道这与其他方法相比效率如何，但它不需要显式创建文件。

```
//$image contains the GD image resource you want to store

ob_start();
imagejpeg($image);
$jpeg_file_contents = ob_get_contents();
ob_end_clean();

//now send $jpeg_file_contents to S3 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-09T22:15:47.503

在内存中获得 JPEG 后（使用[ImageMagick](http://ie.php.net/imagick)、[GD](http://ie.php.net/gd)或您选择的图形库），您需要将对象从内存上传到 S3。

许多 PHP S3 类似乎只支持文件上传，但[Undesign](http://undesigned.org.za/2007/10/22/amazon-s3-php-class)中的类似乎做了我们在这里所追求的 -

```
// Manipulate image - assume ImageMagick, so $im is image object
$im = new Imagick();
// Get image source data
$im->readimageblob($image_source);

// Upload an object from a resource (requires size):
$s3->putObject($s3->inputResource($im->getimageblob(), $im->getSize()), 
                  $bucketName, $uploadName, S3::ACL_PUBLIC_READ); 
```

如果您改用 GD，则可以使用 [imagecreatefromstring](http://ie2.php.net/manual/en/function.imagecreatefromstring.php)从流中读取图像，但我不确定您是否可以按照`s3->inputResource`上面的要求获取结果对象的大小 - [getimagesize](http://ie2.php.net/manual/en/function.getimagesize.php)返回高度、宽度、等，但不是图像资源的大小。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-27T02:21:13.863

这个游戏已经很晚了，但是如果您使用 ConroyP 和 Imagick 提到的 S3 库，您应该使用 putObjectString() 方法而不是 putObject()，因为 getImageBlob 返回一个字符串。最终对我有用的示例：

```
$headers = array(
    'Content-Type' => 'image/jpeg'
);
$s3->putObjectString($im->getImageBlob(), $bucket, $file_name, S3::ACL_PUBLIC_READ, array(), $headers); 
```

我在这方面有点挣扎，希望它可以帮助别人！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-10-12T14:11:04.237

意识到这是一个旧线程，但我今天花了一些时间把头撞在墙上，并认为我会在这里为下一个人提供我的解决方案。

此方法使用[AWS SDK for PHP 2](http://aws.amazon.com/sdkforphp/)和 GD 来调整图像大小（也可以轻松使用 Imagick）。

```
require_once('vendor/aws/aws-autoloader.php');

use Aws\Common\Aws;

define('AWS_BUCKET', 'your-bucket-name-here');

// Configure AWS factory 
$aws = Aws::factory(array(
    'key' => 'your-key-here',
    'secret' => 'your-secret-here',
    'region' => 'your-region-here'
));

// Create reference to S3
$s3 = $aws->get('S3');
$s3->createBucket(array('Bucket' => AWS_BUCKET));
$s3->waitUntilBucketExists(array('Bucket' => AWS_BUCKET));
$s3->registerStreamWrapper();

// Do your GD resizing here (omitted for brevity)

// Capture image stream in output buffer
ob_start();
imagejpeg($imageRes);
$imageFileContents = ob_get_contents();
ob_end_clean();

// Send stream to S3
$context = stream_context_create(
  array(
    's3' => array(
      'ContentType'=> 'image/jpeg'
    )
  )
);
$s3Stream = fopen('s3://'.AWS_BUCKET.'/'.$filename, 'w', false, $context);
fwrite($s3Stream, $imageFileContents);
fclose($s3Stream);

unset($context, $imageFileContents, $s3Stream); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-09T22:05:25.480

Imagemagick 库可以让你做到这一点。有很多像[这样](http://uk.php.net/imagick)的 PHP 包装器（甚至还有你想要在该页面上执行的[示例代码；））](http://uk.php.net/manual/en/book.imagick.php#78717)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-01T21:58:01.850

我遇到了同样的问题，使用 openstack 对象存储和[php-opencloud](https://github.com/php-opencloud/openstack)库。

这是我的解决方案，它不**使用**and`ob_start`函数`ob_end_clean`，而是将图像存储在内存和临时文件中。[内存和临时文件的大小可以在运行时进行调整](http://php.net/manual/en/wrappers.php.php)。

```
// $image is a resource created by gd2
var_dump($image); // resource(2) of type (gd)

// we create a resource in memory + temp file 
$tmp = fopen('php://temp', '$r+');

// we write the image into our resource
\imagejpeg($image, $tmp);

// the image is now in $tmp, and you can handle it as a stream
// you can, then, upload it as a stream (not tested but mentioned in doc http://docs.aws.amazon.com/aws-sdk-php/v2/guide/service-s3.html#uploading-from-a-stream)
$s3->putObject(array(
   'Bucket' => $bucket,
   'Key'    => 'data_from_stream.txt',
   'Body'   => $tmp
));

// or, for the ones who prefers php-opencloud :
$container->createObject([
    'name'  => 'data_from_stream.txt',
    'stream' => \Guzzle\Psr7\stream_for($tmp),
    'contentType' => 'image/jpeg'
]); 
```

* * *

关于`php://temp`（[来自php的官方文档](http://php.net/manual/en/wrappers.php.php)）：

> php://memory 和 php://temp 是读写流，允许将临时数据存储在类似文件的包装器中。两者之间的唯一区别是 php://memory 将始终将其数据存储在内存中，而 php://temp 将在存储的数据量达到预定义限制（默认为 2 MB）时使用临时文件。此临时文件的位置的确定方式与 sys_get_temp_dir() 函数相同。
> 
> php://temp 的内存限制可以通过附加 /maxmemory:NN 来控制，其中 NN 是在使用临时文件之前要保留在内存中的最大数据量，以字节为单位。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-09T22:09:33.913

Maye 通过使用[GD 库](http://www.php.net/manual/en/book.image.php)。

有一个功能可以复制图像的一部分并调整其大小。当然，这部分可以是整个图像，这样你就只能调整它的大小。

见[图像复制重新采样](http://www.php.net/manual/en/function.imagecopyresampled.php)

# wpf - 如何将 WPF 选项卡控制选项卡放在一边

> ID：189370
> 
> 赞同：30
> 
> 时间：2008-10-09T22:00:35.897
> 
> 标签：wpf, xaml, tabcontrol

我正在尝试在 WPF 中创建一个选项卡控件，该控件的选项卡排列在控件的右侧，文本旋转 90 度。外观类似于您可以在笔记本中购买和使用的塑料选项卡。我尝试将 TabStripPlacement 更改为 Right，但它只是将选项卡堆叠在控件的右上角 - 完全不是我的想法。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-09T23:50:33.303

我相信您正在寻求的效果是通过为您的 Tab 集合中的 TabItem 提供 HeaderTemplate 来实现的。

```
<TabControl TabStripPlacement="Right">
  <TabControl.Resources>
    <Style TargetType="{x:Type TabItem}">
      <Setter Property="Padding" Value="4" />
      <Setter Property="HeaderTemplate">
        <Setter.Value>
          <DataTemplate>
            <ContentPresenter Content="{TemplateBinding Content}">
              <ContentPresenter.LayoutTransform>
                <RotateTransform Angle="90" />
              </ContentPresenter.LayoutTransform>
            </ContentPresenter>
          </DataTemplate>
        </Setter.Value>
      </Setter>
    </Style>
  </TabControl.Resources>
  <TabItem Header="Tab Item 1" />
  <TabItem Header="Tab Item 2" />
  <TabItem Header="Tab Item 3" />
  <TabItem Header="Tab Item 4" />
</TabControl> 
```

希望这可以帮助！

# vb6 - 从 vb6 迁移之前替换控制数组

> ID：189375
> 
> 赞同：0
> 
> 时间：2008-10-09T22:02:52.740
> 
> 标签：vb6, vb6-migration

为了避免构建进一步的迁移障碍，同时增强现有的 vb6 程序。有没有办法在不使用它们的情况下实现与 vb6 中的控制数组相同的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T14:00:02.157

在 .NET 中，您有一个标记属性。您还可以拥有由多个控件引发的相同委托句柄事件。将新控件的 Tag 属性设置为 Index。

```
Private Sub MyButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click,Button2.Click

        Dim Btn As Button = CType(sender, Button)
        Dim Index As Integer = CType(Btn.Tag, Integer)
' Do whatever you were doing in VB6 with the Index property

End Sub 
```

您还应该查看从 VB6.Compatibility 中的 BaseControlArray 继承的类，它可以自动执行一些工作。我发现在转换过程中使用 Tag 比依赖控件名称更不容易出错。但是，不要绝对地感谢这一点。您必须决定是控件名称方法还是标签作为索引方法是最好的。

无论哪种情况，您都可以轻松设置 .NET 以将多个控件引发的事件集中到一个处理程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T07:43:26.360

好吧，您总是可以在代码中创建自己的控件数组 :) 不过，也许更好的容器是 Collection 或 Dictionary 对象。根据您想要做的事情，您也许可以使用自定义集合类为控件创建一个包装类......但是在 .NET 中使用泛型创建对象模型要好得多，所以现在最好在 VB6 中保持简单.

VBA 用户窗体缺乏对控件数组的支持，所以为什么不 Google 寻求有关如何使用 VBA、用户窗体、Excel 等模拟控件数组的建议呢？

顺便说一句，您是否尝试过将控件数组从 VB6 迁移到 VB.NET？只是一个猜测，但考虑到它们在 VB 中很常用，我想它们处理得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T20:06:03.180

在过去的几天里，我做了一些阅读和实验，似乎在 vb6 中没有其他方法可以完成控制数组所做的事情。如果您已经知道将在运行时、设计时创建的控件的数量，那么您可以声明私有控件对象变量“带有事件”并在运行时动态地实例化这些。如果您需要创建更多内容，则可以这样做，但这些内容不会触发任何代码来响应事件。据我所知，这是问题的关键。在 vb6 中，无法将代码与动态创建的控件的事件动态关联。

# lucene - 如何在 Lucene.Net 中拥有同义词

> ID：189384
> 
> 赞同：0
> 
> 时间：2008-10-09T22:05:48.803
> 
> 标签：lucene, lucene.net

我需要 lucene 来搜索同义词以及实际的关键字。也就是说，如果我搜索“CI”，我希望它搜索 CI 或“继续集成”。目前，我搜索具有同义词的关键字并将其替换为“OR-ed”版本，但我怀疑应该有更好的方法来做到这一点。我的方法不适用于具有“x AND y OR NOT z”之类的复杂查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T18:48:58.590

这几乎就是我计划实现此功能的方式。我正计划构建我自己的版本，但后来我遇到了这个站点[WordNet.Net](https://www.ebswift.com/wordnetnet.html)，它似乎试图解决构建同义词的问题。Lucene.Net 有一个 wordnet 扩展，它重写了查询，所以我猜这确实是处理这个问题的标准方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T23:28:18.773

至少在 Lucene 的 Java 版本中，您可以自己编写一个递归函数来挖掘 QueryParser 将构建的 BooleanQuery Query 对象；每次它找到一个 TermQuery 时，它都可以用一个 BooleanQuery 替换它，它是原始术语与您想要添加到查询中的新术语。

# process - 最有用的软件开发指标是什么？

> ID：189388
> 
> 赞同：27
> 
> 时间：2008-10-09T22:08:36.020
> 
> 标签：process, metrics

我想跟踪可用于改进我团队的软件开发过程、改进时间估计和检测在项目执行期间需要解决的特殊情况变化的指标。

请将每个答案限制为一个指标，描述如何使用它，并对好的答案进行投票。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-20T08:04:55.337

[![在此处输入图像描述](https://i.stack.imgur.com/oHHM4.jpg)](https://i.stack.imgur.com/oHHM4.jpg)        

[（来源：[osnews.com](http://www.osnews.com/images/comics/wtfm.jpg)）]

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-19T22:51:21.967

**投资回报率。**

软件带来的总收入减去生产软件的总成本。按总成本的百分比细分成本，并根据投资回报率隔离表现最差和最昂贵的领域。如果可能，改进、自动化或消除该问题区域。相反，找到您的最高投资回报领域，并找到进一步扩大其影响的方法。如果 80% 的 ROI 来自 20% 的成本或努力，那么扩大该特定区域并通过比较将其余部分最小化。

成本将包括工资、许可证、法律费用、硬件、办公设备、营销、生产、分销和支持。这可以在整个公司的宏观层面上完成，也可以在团队或个人的微观层面上完成。除了收入之外，它还可以应用于时间、任务和方法。

这并不意味着忽略所有细节，而是找到一种方法来量化一切，然后专注于产生最佳（客观）结果的领域。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-09T22:19:29.040

逆代码覆盖率

获取测试期间未执行的代码百分比。这与沙法所说的类似，但用法不同。如果在测试期间运行了一行代码，那么我们知道它可能会被测试。但是如果一行代码没有运行，那么我们肯定知道它没有经过测试。针对这些领域进行单元测试将提高质量，并且比审核已涵盖的代码花费更少的时间。理想情况下，你可以两者都做，但这永远不会发生。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-10T14:34:26.567

“改进我团队的软件开发过程”：缺陷查找和修复率

这与针对已提交或验证的修复数量而引发的缺陷或错误的数量有关。

我不得不说这是非常重要的指标之一，因为它为您提供了两件事：

*   1\. 代码流失。每天/每周更改多少代码（这在您尝试稳定发布时很重要），并且，
    *   2\. 显示缺陷是否在修复之前，反之亦然。这向您展示了开发团队对 QA/测试人员提出的缺陷的响应情况。

低修复率表明团队正忙于其他事情（也许是功能）。如果错误数量很高，您可能需要让开发人员解决一些缺陷。
低找到率表明您的解决方案非常出色且几乎没有错误，或者 QA 团队已被阻止或有其他关注点。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-09T22:13:30.287

跟踪完成一项有估计的任务需要多长时间。如果他们的情况很好，请问为什么。如果他们已经结束了，问为什么。

不要让它成为一件消极的事情，如果任务爆发或被低估了也没关系。您的目标是不断改进您的估算过程。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-09T22:13:36.837

速度：每给定单位时间的特征数量。

由您决定如何定义特征，但它们应该大致相同数量级，否则速度不太有用。例如，您可以按故事或用例对功能进行分类。这些应该被分解，以便它们的大小大致相同。每次迭代，弄清楚有多少故事（用例）被实现（完成）。特征/迭代的平均数量就是你的速度。一旦您根据您的功能单元了解您的速度，您就可以使用它来帮助估计基于其功能完成新项目需要多长时间。

[编辑] 或者，您可以为每个故事分配一个权重，如功能点或故事点，作为复杂性的衡量标准，然后将每个已完成功能的点相加并以点/迭代计算速度。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-10T01:15:09.187

跟踪您发现的错误的来源和类型。

错误源代表引入错误的开发阶段。（例如规范、设计、实施等）

错误类型是错误的广义样式。例如。内存分配，不正确的条件。

这应该允许您更改在该开发阶段遵循的程序并调整您的编码风格指南以尝试消除过度表示的错误类型。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-20T07:55:11.053

跟踪源代码中的克隆数量（类似的代码片段）。

一旦发现克隆，就通过重构代码来摆脱克隆。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-09T22:17:44.787

平均函数长度，或者可能是函数长度的直方图，以获得更好的感觉。

函数越长，其正确性越不明显。如果代码包含许多长函数，那么可以肯定的是其中隐藏了一些错误。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-10T10:21:55.853

如果您使用的是 Scrum，则为积压。每次冲刺后有多大？它是否以一致的速度收缩？或者是因为（a）一开始没有想到的东西（“我们需要另一个没有人想到的审计报告用例，我将它添加到积压中。 ”）或（b）没有完成工作并将其推入积压工作以满足日期而不是承诺的功能。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-10T10:37:37.397

[http://cccc.sourceforge.net/](http://cccc.sourceforge.net/)

Fan in and Fan out are my favorites.

Fan in: How many other modules/classes use/know this module

Fan out: How many other modules does this module use/know

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-09T23:36:03.880

类之间的相互依赖。您的代码耦合的紧密程度。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-09T22:15:32.263

每次提交失败的测试或损坏的构建数。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-01-06T20:44:48.867

我特别喜欢和使用 Mary Poppendieck[推荐](http://groups.yahoo.com/group/scrumdevelopment/message/13433)的系统。该系统基于必须作为一个包进行的三个整体测量（所以不，我不会提供 3 个答案）：

1.  周期
    *   从产品概念到首次发布或
    *   从功能请求到功能部署或
    *   从错误检测到解决
2.  商业案例实现（没有这个，其他一切都无关紧要）
    *   损益或
    *   投资回报率或
    *   投资目标
3.  顾客满意度
    *   例如[净推荐值](http://en.wikipedia.org/wiki/Net_Promoter)

我不需要更多地知道我们是否与最终目标同步：为用户提供价值，而且速度快。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-10T01:18:46.217

跟踪一个来源是否经过审查，如果是，是什么类型。然后，跟踪在已审核与未审核代码中发现的错误数量。

这将允许您确定您的代码审查过程在发现错误方面的运行效率。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-19T22:20:23.463

> 改进时间估计

虽然 Joel Spolsky 的 Evidence-based Scheduling 本身并不是一个*度量标准*，但听起来正是您想要的。见[http://www.joelonsoftware.com/items/2007/10/26.html](http://www.joelonsoftware.com/items/2007/10/26.html)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-10T14:25:05.617

改进我团队的软件开发流程

重要的是要了解指标对改进团队的软件开发过程没有任何作用。它们只能用于衡量您在改进您正在使用的特定指标方面的开发过程的进展情况。也许我在争论语义，但你表达它的方式是大多数开发人员讨厌它的原因。听起来您正在尝试使用指标来驱动结果，而不是使用指标来衡量结果。

换句话说，你宁愿拥有 100% 的代码覆盖率和糟糕的单元测试还是出色的单元测试和 < 80% 的覆盖率？

你的答案应该是后者。你甚至可以想要一个完美的世界并拥有两者，但你最好先专注于单元测试，然后让覆盖率到达那里。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-09T22:14:09.083

相似行数。（复制/粘贴代码）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-06-28T06:52:31.677

上述大多数指标都很有趣，但不会帮助您提高团队绩效。问题是您在开发论坛中提出管理问题。

以下是一些指标：项目进度级别和个人级别的估计值/vs/实际值（请参阅 Joel 的基于证据的方法的先前链接），发布时删除的缺陷百分比（请参阅我的博客：[http://redrockresearch.org/? p=58](http://redrockresearch.org/?p=58) )、范围蔓延/月和总体生产力评级（普特南生产力指数）。此外，开发人员的带宽很好衡量。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2011-09-19T12:02:51.643

很长一段时间以来，在 QA 中跟踪指标一直是一项基本活动。但通常，开发团队并没有充分考虑这些指标与业务各个方面的相关性。例如，缺陷率、有效性、测试效率、代码覆盖率等典型的跟踪指标通常根据软件的功能方面进行评估，但很少有人关注它们对软件业务方面的重要性。

还有其他指标可以为软件的业务方面增加很多价值，这在查看软件的整体质量视图时非常重要。这些可以大致分为：

1.  业务分析师、营销和销售人员捕获的测试版用户的需求
2.  产品管理团队定义的最终用户要求
3.  确保软件在峰值负载下的可用性以及软件与企业 IT 系统集成的能力
4.  支持大批量交易
5.  安全方面取决于软件服务的行业
6.  与竞争对手相比，必备功能和必备功能的可用性
7.  还有一些……

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-06-28T13:19:21.130

每次 QA 团队报告错误时 - 分析为什么该缺陷逃脱了开发人员的单元测试。

将此视为一种永久的自我改进练习。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-06-13T15:38:37.673

我喜欢缺陷解决效率指标。DRE 是在软件发布之前解决的缺陷与发现的所有缺陷的比率。我建议将您的软件的每个版本都跟踪到生产中。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-10T10:18:45.313

如果您使用 Scrum，您想知道每天的 Scrum 进展如何。人们是否完成了他们说他们会完成的事情？

就个人而言，我不擅长。我经常在我的日报上跑来跑去。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2010-01-06T20:36:30.950

也许你可以测试[CodeHealer](http://www.codehealer.com/codehealer.php)

CodeHealer 对源代码进行深入分析，寻找以下方面的问题：

*   **审核** 质量控制规则，例如未使用或无法访问的代码、使用指令名称和关键字作为标识符、在更高范围内隐藏其他同名的标识符等等。
*   **检查** 潜在错误，例如未初始化或未引用的标识符、危险的类型转换、自动类型转换、未定义的函数返回值、未使用的分配值等。
*   **Metrics** 量化代码属性，例如圈复杂度、对象之间的耦合（数据抽象耦合）、注释比率、类数、代码行数等。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-09T22:12:32.440

代码覆盖率

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2008-10-10T14:36:28.263

源代码控制提交的大小和频率。

# php - PHP中的自动图像格式检测

> ID：189391
> 
> 赞同：22
> 
> 时间：2008-10-09T22:09:52.133
> 
> 标签：php, image, format, jpeg

我正在寻找一种方法来获取当前放置在临时位置的用户上传的图像，例如：/tmp/jkhjkh78，并从中创建一个 php 图像，自动检测格式。

有没有比使用 imagefromjpeg、imagefrompng 等进行尝试/捕捉更聪明的方法？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-09T22:13:59.067

[这是getimagesize](http://www.php.net/manual/en/function.getimagesize.php)的功能之一。他们可能应该称它为“getimageinfo”，但那是你的 PHP。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-15T15:06:52.123

```
 //Image Processing
    $cover = $_FILES['cover']['name'];
    $cover_tmp_name = $_FILES['cover']['tmp_name'];
    $cover_img_path = '/images/';
    $type = exif_imagetype($cover_tmp_name);

if ($type == (IMAGETYPE_PNG || IMAGETYPE_JPEG || IMAGETYPE_GIF || IMAGETYPE_BMP)) {
        $cover_pre_name = md5($cover);  //Just to make a image name random and cool :D
/**
 * @description : possible exif_imagetype() return values in $type
 * 1 - gif image
 * 2 - jpg image
 * 3 - png image
 * 6 - bmp image
 */
        switch ($type) {    #There are more type you can choose. Take a look in php manual -> http://www.php.net/manual/en/function.exif-imagetype.php
            case '1' :
                $cover_format = 'gif';
                break;
            case '2' :
                $cover_format = 'jpg';
                break;
            case '3' :
                $cover_format = 'png';
                break;
            case '6' :
                $cover_format = 'bmp';
                break;

            default :
                die('There is an error processing the image -> please try again with a new image');
                break;
        }
    $cover_name = $cover_pre_name . '.' . $cover_format;
      //Checks whether the uploaded file exist or not
            if (file_exists($cover_img_path . $cover_name)) {
                $extra = 1;
                while (file_exists($cover_img_path . $cover_name)) {
        $cover_name = md5($cover) . $extra . '.' . $cover_format;
                    $extra++;
                }
            }
     //Image Processing Ends 
```

这将使图像名称看起来很酷且独特

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-28T14:39:13.693

`exif_imagetype()`如果可用，请使用.. ：

[http://www.php.net/manual/en/function.exif-imagetype.php](http://www.php.net/manual/en/function.exif-imagetype.php)

我很确定 exif 函数在安装 php 时默认可用（即您必须专门排除它们而不是专门包含它们）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T22:17:09.357

你可以试试[`finfo_file()`](http://www.php.net/finfo_file)，显然是[`mime_content_type()`](http://www.php.net/mime_content_type).

编辑：好的，`getimagesize()`更好..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T22:13:18.307

如果您愿意，可以调用系统命令（如果您在 linux/unix 下）`file`：

```
kender@eira:~$ file a
a: JPEG image data, EXIF standard 2.2 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-02T09:23:23.547

这将帮助您了解扩展以及基于条件的结果

> $image_file = ' [http://foo.com/images.gif](http://foo.com/images.gif) ';
> $extension = substr($image_file, -4);
> if($extension == ".jpg"){ echo '这是一张 JPG 图片。'; } else { echo '它不是 JPG 图片。'; }

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-23T17:06:11.680

人们推荐使用[`getimagesize()`，但文档](http://php.net/manual/en/function.getimagesize.php)内容如下：

> **注意**此函数要求文件名是有效的图像文件。如果提供了非图像文件，它可能会被错误地检测为图像并且函数将成功返回，但数组可能包含无意义的值。
> 
> 不要`getimagesize()`用于检查给定文件是否为有效图像。请改用专门构建的解决方案，例如[Fileinfo](http://php.net/manual/en/book.fileinfo.php)扩展。

Fileinfo 扩展中的相关功能是[`finfo_file()`](http://php.net/manual/en/function.finfo-file.php)：

```
string finfo_file ( resource $finfo , string $file_name = NULL 
    [, int $options = FILEINFO_NONE [, resource $context = NULL ]] ) 
```

> `file_name` 返回参数内容的文本描述，如果发生错误，则返回**FALSE 。**

给出的示例返回值是：`text/html`, `image/gif`,`application/vnd.ms-excel`

但是，官方文档页面上的评论警告说，也不应该依赖它来进行验证。

# asp.net - 如何使用 System.Drawing 绘制透明图像？

> ID：189392
> 
> 赞同：11
> 
> 时间：2008-10-09T22:10:04.397
> 
> 标签：asp.net, transparency, gif, system.drawing

我正在尝试从 .aspx 页面返回一个透明的 GIF，以便在网页中显示。我试图让图像具有透明度，但我只是让黑色成为图像应该透明的地方。

有谁知道我做错了什么？

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) _
  Handles Me.Load
    '' Change the response headers to output a GIF image.
    Response.Clear()
    Response.ContentType = "image/gif"

    Dim width = 110
    Dim height = width

    '' Create a new 32-bit bitmap image
    Dim b = New Bitmap(width, height)

    '' Create Grahpics object for drawing
    Dim g = Graphics.FromImage(b)

    Dim rect = New Rectangle(0, 0, width - 1, height - 1)

    '' Fill in with Transparent
    Dim tbrush = New System.Drawing.SolidBrush(Color.Transparent)
    g.FillRectangle(tbrush, rect)

    '' Draw Circle Border
    Dim bPen = Pens.Red
    g.DrawPie(bPen, rect, 0, 365)

    '' Fill in Circle
    Dim cbrush = New SolidBrush(Color.LightBlue)
    g.FillPie(cbrush, rect, 0, 365)

    '' Clean up
    g.Flush()
    g.Dispose()

    '' Make Transparent
    b.MakeTransparent()

    b.Save(Response.OutputStream, Imaging.ImageFormat.Gif)
    Response.Flush()
    Response.End()
End Sub 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T22:41:07.297

是的，正如 Jerome 所说，无论如何都无法使用 Bitmap 对象创建透明 GIF。废话！

好吧，无论如何，我更改了我的代码以生成 PNG，并且所有工作都按预期工作。

我确实需要做一项小工作，因为您不能将 PNG 直接写入 OutputStream。我需要将 PNG 写入 MemoryStream，然后将其写入 OutputStream。

这是我的实现的最终代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) _
  Handles Me.Load
    '' Change the response headers to output a JPEG image.
    Response.Clear()
    Response.ContentType = "image/png"

    Dim width = 11
    Dim height = width

    '' Create a new 32-bit bitmap image
    Dim b = New Bitmap(width, height)

    '' Create Grahpics object for drawing
    Dim g = Graphics.FromImage(b)

    '' Fill the image with a color to be made Transparent after drawing is finished.
    g.Clear(Color.Gray)

    '' Get rectangle where the Circle will be drawn
    Dim rect = New Rectangle(0, 0, width - 1, height - 1)

    '' Draw Circle Border
    Dim bPen = Pens.Black
    g.DrawPie(bPen, rect, 0, 365)

    '' Fill in Circle
    Dim cbrush = New SolidBrush(Color.Red)
    g.FillPie(cbrush, rect, 0, 365)

    '' Clean up
    g.Flush()
    g.Dispose()

    '' Make Transparent
    b.MakeTransparent(Color.Gray)

    '' Write PNG to Memory Stream then write to OutputStream
    Dim ms = New MemoryStream()
    b.Save(ms, Imaging.ImageFormat.Png)
    ms.WriteTo(Response.OutputStream)

    Response.Flush()
    Response.End()
End Sub 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T22:29:13.063

不幸的是，没有简单的方法可以使用 Bitmap 对象创建透明 Gif。（请参阅[此知识库文章](http://support.microsoft.com/default.aspx?scid=kb%3bEN-US%3bQ319061)）

您也可以将支持透明度的 PNG 格式与您正在使用的代码一起使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T23:11:26.520

这是*可能的*，但*并不容易*。

如果你能够在你的项目中使用不安全的代码，有一些方法可以使用指针来翻阅颜色表并使透明度工作。

Bob Powell 的示例表单应用程序可在[https://web.archive.org/web/20141227173018/http://bobpowell.net/giftransparency.aspx](https://web.archive.org/web/20141227173018/http://bobpowell.net/giftransparency.aspx)获得。我在 web 处理程序中使用了这种方法的变体，它似乎工作正常。

如果您只使用有限的调色板，您可以将颜色表处理减少到您需要的颜色（不记得我是如何做到的......）。

话虽这么说，png要容易得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-26T16:26:11.407

这是一些代码，可以在位图中转换（假设你想调整它的大小）的 gif（其中已经有透明度），然后可以用它的透明度正确显示。

```
imagePath = System.Web.HttpContext.Current.Request.MapPath(libraryPath + reqImageFile);
System.Drawing.Image image = null;
Bitmap resizedImage = null;

if (reqWidth == 0) { reqWidth = image.Width; }
if (reqHeight == 0) { reqHeight = image.Height; }
image = System.Drawing.Image.FromFile(imagePath);
reqWidth = image.Width;
reqHeight = image.Height;

//here is the transparency 'special' treatment
resizedImage = new Bitmap(reqWidth, reqHeight, PixelFormat.Format8bppIndexed);
ColorPalette pal = resizedImage.Palette;
for (int i = 0; i < pal.Entries.Length; i++)
{
       Color col = pal.Entries[i];
       pal.Entries[i] = Color.FromArgb(0, col.R, col.G, col.B);
}
resizedImage.Palette = pal;
BitmapData src = ((Bitmap)image).LockBits(new Rectangle(0, 0, reqWidth, reqHeight),  ImageLockMode.ReadOnly, image.PixelFormat);
BitmapData dst = resizedImage.LockBits(new Rectangle(0, 0, resizedImage.Width, resizedImage.Height),
ImageLockMode.WriteOnly, resizedImage.PixelFormat);
((Bitmap)image).UnlockBits(src);
resizedImage.UnlockBits(dst); 
```

祝你好运 ！

Grégoire Lafortune

# database-design - 客户档案设计

> ID：189405
> 
> 赞同：1
> 
> 时间：2008-10-09T22:14:08.943
> 
> 标签：database-design, business-logic

您如何为您的客户地址数据建模以及您使用什么技术来确保数据质量？

诸如重复数据删除算法、重复匹配、确保包裹和发票实际上可以交付等等之类的东西？尤其是在处理多个国家客户的系统中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T22:20:06.637

有许多供应商提供地址验证和规范化（将多个等效地址转换为标准形式）作为服务。其中一些供应商还提供在该地址计算税款以用于发票目的的能力。一旦有了地址的规范化形式，查找重复项只是比较条目的问题（您可能希望使用散列来提高速度）。我犹豫要不要在 Stackoverflow 上支持这个软件的特定供应商，甚至列出一些......

# regex - 使用 Perl 正则表达式替换星号 (*)

> ID：189415
> 
> 赞同：0
> 
> 时间：2008-10-09T22:17:44.910
> 
> 标签：regex, perl

我有以下字符串：

`$_='364*84252';`

问题是：如何`*`用其他东西替换字符串？我试过`s/\*/$i/`了，但是有一个错误： `Quantifier follows nothing in regex`。另一方面`s/'*'/$i/`不会导致任何错误，但它似乎也没有任何影响。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T22:23:02.263

这里还有一些奇怪的东西......

```
~> cat test.pl
$a = "234*343";
$i = "FOO";

$a =~ s/\*/$i/;
print $a;

~> perl test.pl
234FOO343 
```

发现了一些东西：

```
~> cat test.pl
$a = "234*343";
$i = "*4";

$a =~ m/$i/;
print $a;

~> perl test.pl
Quantifier follows nothing in regex; marked by <-- HERE in m/* <-- HERE 4/ at test.pl line 4. 
```

`\Q`解决方案，使用and转义变量中的特殊字符`\E`，例如 (TIMTOWTDI)

```
~> cat test.pl
$a = "234*343";
$i = "*4";

$a =~ m/\Q$i\E/;
print $a;

~> perl test.pl
234*343 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T22:27:32.207

```
$ perl -le '$_="364*84252";s/\*/xx/;print'
364xx84252 
```

绝对有效。也许您在单行中使用双引号而不是单引号？我不确定 - 我根本无法重现您的结果。您需要为您的问题提供更多背景知识，最好使用我们可以运行的代码来重现您的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T22:45:44.543

*那一定是psh的问题。使用 perl xx.pl 运行脚本不会引发任何错误。感谢帮助 ;）*

字符串会自行转义反斜杠。在这种情况下，您可能应该将反斜杠加倍以`s/\\*/$i/`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-01T23:15:08.000

更好的是使用

```
$InputLine =~ s/\Q*\E//g; 
```

这应该删除变量字符串中任何位置的星号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-01T23:10:11.370

尝试

```
$VARIABLE =~ s/\Q*\E//; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T22:27:46.483

错误必须来自`$i`. `s/\*/foo/`工作正常。

# sql - 如何在 SQL Server 中创建和查询链接数据库服务器？

> ID：189422
> 
> 赞同：18
> 
> 时间：2008-10-09T22:21:29.070
> 
> 标签：sql, sql-server, database

我需要跨两个不同的数据库服务器（IP 10.0.0.50 和 10.0.0.51）进行连接。最好的方法是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-09T22:24:05.367

我找到的解决方案：

1）运行[存储过程](http://msdn.microsoft.com/en-us/library/aa259589(SQL.80).aspx)

```
exec sp_addlinkedserver    @server='10.0.0.51' 
```

2）验证服务器是否已链接（列出链接的服务器）

```
exec sp_linkedservers 
```

3) 使用格式运行查询

```
 [10.0.0.51].DatabaseName.dbo.TableName 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-09T22:23:54.837

您需要使用 sp_linkedserver 创建链接服务器。

```
sp_addlinkedserver [ @server= ] 'server' [ , [ @srvproduct= ] 'product_name' ] 
 [ , [ @provider= ] 'provider_name' ]
 [ , [ @datasrc= ] 'data_source' ] 
 [ , [ @location= ] 'location' ] 
 [ , [ @provstr= ] 'provider_string' ] 
 [ , [ @catalog= ] 'catalog' ] 
```

更多信息可在[MSDN](http://msdn.microsoft.com/en-us/library/ms190479.aspx)上找到。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-08-07T17:20:07.853

我知道上面的答案很好，但想分享一些细节，希望其他人会觉得有帮助。值得一提的是用户访问部分，我认为人们需要帮助。

**设置链接：**

`exec sp_addlinkedserver @server='10.10.0.10\MyDS';`

**设置远程用户的访问权限，示例如下：**

`exec sp_addlinkedsrvlogin '10.10.0.10\MyDS', 'false', null, 'adm', 'pwd';`

**查看链接的服务器和用户登录：**

`exec sp_linkedservers;`

`select * from sys.servers;`

`select * from sys.linked_logins;`

**运行远程查询：**

`select * from [10.10.0.10\MyDS].MyDB.dbo.TestTable;`

**删除链接服务器和创建的登录用户 (adm/pwd)**

`exec sp_dropserver '10.10.0.10\MyDS', 'droplogins'; -- drops server and logins`

**资源：**

[sp_addlinkedserver](https://msdn.microsoft.com/en-us/library/ms190479.aspx)

[sp_dropserver](https://msdn.microsoft.com/en-us/library/ms174310.aspx)

[sp_addlinkedsrvlogin](https://msdn.microsoft.com/en-us/library/ms189811.aspx)

[sp_droplinkedsrvlogin](https://msdn.microsoft.com/en-us/library/ms186218.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-09T23:23:52.390

如前所述，您可以使用 sp_addlinkedserver。但是，您也可以通过 Enterprise Manager (2000) 或 SQL Server Management Studio (2005) 执行此操作。在“安全”节点下，有一个“链接服务器”节点，您可以使用它来添加和配置链接服务器。您可以指定安全设置、模拟等。

请参阅 SQL Server 2000 的这些：

[配置链接服务器](http://msdn.microsoft.com/en-us/library/aa213778(SQL.80).aspx)

[为链接服务器建立安全性](http://msdn.microsoft.com/en-us/library/aa213768(SQL.80).aspx)

[为分布式查询配置 OLEDB 提供程序](http://msdn.microsoft.com/en-us/library/aa213787(SQL.80).aspx)

请参阅 SQL Server 2005 的这些：

[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279(SQL.90).aspx)

[链接服务器的安全性](http://msdn.microsoft.com/en-us/library/ms175537(SQL.90).aspx)

[为委派配置链接服务器](http://msdn.microsoft.com/en-us/library/ms189580(SQL.90).aspx)

[为分布式查询配置 OLEDB 提供程序](http://msdn.microsoft.com/en-us/library/ms190918(SQL.90).aspx)

# php - Serena Mariner 的 SOAP API 可以在 UpdateInvestment() 中触及哪些“属性”？

> ID：189425
> 
> 赞同：1
> 
> 时间：2008-10-09T22:22:02.080
> 
> 标签：php, soap

我正在尝试编写一个本土项目管理系统和 Serena Mariner 之间的接口。（大佬们喜欢读《水手》，工蜂喜欢写给本土系统。）

我如何（以编程方式？）找出可用的属性键？

我实际上是在用 PHP 编写界面，但任何建议都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T07:05:26.767

Mariner 似乎有一个用于使用该系统[的 API 。](http://community.serena.com/posts/3c42b2a8fe)否则，最好在[水手支持论坛](http://community.serena.com/hives/1eb332f6b9/summary)上提问。

更新：我对 API 进行了更多查看，但它没有指定属性，这就是您的问题所在。我想支持论坛是更好的选择。

# javascript - 检测到互联网连接是否离线？

> ID：189430
> 
> 赞同：314
> 
> 时间：2008-10-09T22:23:49.767
> 
> 标签：javascript, ajax, offline, connectivity, internet-connection

如何在 JavaScript 中检测 Internet 连接是否脱机？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2018-12-17T17:25:28.603

[现在几乎所有主流浏览器](https://caniuse.com/#feat=online-status)都支持该[`window.navigator.onLine`](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine.onLine)属性，以及相应的`online`和`offline`窗口事件。运行以下代码片段来测试它：

```
console.log('Initially ' + (window.navigator.onLine ? 'on' : 'off') + 'line');

window.addEventListener('online', () => console.log('Became online'));
window.addEventListener('offline', () => console.log('Became offline'));

document.getElementById('statusCheck').addEventListener('click', () => console.log('window.navigator.onLine is ' + window.navigator.onLine));
```

```
<button id="statusCheck">Click to check the <tt>window.navigator.onLine</tt> property</button><br /><br />
Check the console below for results:
```

尝试将您的系统或浏览器设置为离线/在线模式，并检查日志或`window.navigator.onLine`属性中的值更改。

但是请注意[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine.onLine)中的这句话：

> 在 Chrome 和 Safari 中，如果浏览器无法连接到局域网 (LAN) 或路由器，则它处于离线状态；所有其他条件返回`true`。因此，虽然**您可以假定浏览器在返回`false`值**时处于脱机状态，但**您不能假定该`true`值必然意味着浏览器可以访问互联网**。您可能会得到误报，例如在计算机运行具有始终“连接”的虚拟以太网适配器的虚拟化软件的情况下。因此，如果你真的想确定浏览器的在线状态，你应该开发额外的检查手段。
> 
> 在 Firefox 和 Internet Explorer 中，将浏览器切换到离线模式会发送一个`false`值。在 Firefox 41 之前，所有其他条件都返回一个`true`值；从 Firefox 41 开始，在 OS X 和 Windows 上，该值将遵循实际的网络连接。

（重点是我自己的）

这意味着如果`window.navigator.onLine`是`false`（或您收到`offline`事件），则保证您没有 Internet 连接。

但是，如果是`true`（或您收到`online`事件），则最多仅意味着系统已连接到某个网络。例如，这并不意味着您可以访问 Internet。要检查这一点，您仍然需要使用其他答案中描述的解决方案之一。

[我最初打算将其发布为对[格兰特瓦格纳答案](https://stackoverflow.com/a/189457/525036)的更新，但它似乎太多的编辑，特别是考虑到 2014 年的更新已经[不是他](https://stackoverflow.com/posts/189457/revisions)的。]

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2008-10-09T22:28:01.693

**您可以通过发出失败的 XHR 请求**来确定连接已丢失。

标准方法是**重试请求**几次。如果没有通过，**提醒用户**检查连接，并**优雅地失败**。

**旁注：**将整个应用程序置于“离线”状态可能会导致很多容易出错的状态处理工作。无线连接可能来来去去，等等。所以你最好的选择可能是优雅地失败，保留数据，并提醒用户。如果存在连接问题，允许他们最终解决连接问题，并在相当宽恕的情况下继续使用您的应用程序。

**旁注：**您可以检查像 google 这样的可靠站点的连接性，但这可能并不完全有用，因为只是尝试提出您自己的请求，因为虽然 Google 可能可用，但您自己的应用程序可能不可用，而且您仍然会必须处理自己的连接问题。尝试向 google 发送 ping 将是确认 Internet 连接本身已关闭的好方法，因此如果该信息对您有用，那么它可能是值得的。

**旁注**：*发送 Ping*的方式与发出任何双向 ajax 请求的方式相同，但在这种情况下，向 google 发送 ping 会带来一些挑战。首先，我们会遇到在进行 Ajax 通信时通常会遇到的相同的跨域问题。一种选择是设置服务器端代理，我们实际上在其中`ping`搜索（或任何网站），并将 ping 的结果返回给应用程序。这是**第 22 条**因为如果互联网连接确实是问题，我们将无法访问服务器，如果连接问题仅在我们自己的域上，我们将无法区分。可以尝试其他跨域技术，例如，在指向 google.com 的页面中嵌入 iframe，然后轮询 iframe 以了解成功/失败（检查内容等）。嵌入图像可能并不能真正告诉我们任何事情，因为我们需要来自通信机制的有用响应，以便对正在发生的事情得出一个好的结论。同样，确定整个互联网连接的状态可能比它的价值更麻烦。您必须为您的特定应用权衡这些选项。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2008-10-09T22:33:40.777

IE 8 将支持[window.navigator.onLine](https://msdn.microsoft.com/en-us/library/cc304129%28VS.85%29.aspx#status_improvements%29)属性。

但这当然对其他浏览器或操作系统没有帮助。鉴于了解 Ajax 应用程序中在线/离线状态的重要性，我预测其他浏览器供应商也将决定提供该属性。

在此之前，XHR 或`Image()`or`<img>`请求都可以提供接近您想要的功能的东西。

**更新 (2014/11/16)**

现在主流浏览器都支持这个属性，但是你的结果会有所不同。

引自[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine.onLine)：

> 在 Chrome 和 Safari 中，如果浏览器无法连接到局域网 (LAN) 或路由器，则它处于离线状态；所有其他条件返回`true`。因此，虽然您可以假设浏览器在返回`false`值时处于脱机状态，但您不能假设真正的值必然意味着浏览器可以访问互联网。您可能会得到误报，例如在计算机运行具有始终“连接”的虚拟以太网适配器的虚拟化软件的情况下。因此，如果你真的想确定浏览器的在线状态，你应该开发额外的检查手段。
> 
> 在 Firefox 和 Internet Explorer 中，将浏览器切换到离线模式会发送一个`false`值。所有其他条件都返回一个`true`值。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-10-09T22:32:14.787

有多种方法可以做到这一点：

*   AJAX 请求到您自己的网站。如果该请求失败，则很有可能是连接有问题。[JQuery](http://www.jquery.com)文档有一节处理失败的[AJAX 请求](http://docs.jquery.com/Ajax/ajaxError#callback)。执行此操作时请注意同源[策略](http://en.wikipedia.org/wiki/Same_origin_policy)，这可能会阻止您访问域外的站点。
*   你可以把一个`onerror`，`img`像`<img src="http://www.example.com/singlepixel.gif" onerror="alert('Connection dead');" />`。

如果源图像被移动/重命名，此方法也可能失败，并且通常是 ajax 选项的次要选择。

所以有几种不同的方法可以尝试检测这一点，没有一个是完美的，但是在没有能够跳出浏览器沙箱并直接访问用户的网络连接状态的情况下，它们似乎是最好的选择。

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2011-04-06T17:54:02.993

```
 if(navigator.onLine){
  alert('online');
 } else {
  alert('offline');
 } 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-08-20T21:54:08.003

正如 olliej 所说，使用`navigator.onLine`浏览器属性比发送网络请求更可取，因此对于[developer.mozilla.org/En/Online_and_offline_events](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/Online_and_offline_events)，旧版本的 Firefox 和 IE 甚至都支持它。

最近，WHATWG 已指定添加`online`和`offline`事件，以防您需要对`navigator.onLine`更改做出反应。

还请注意 Daniel Silveira 发布的链接，该链接指出依赖这些信号/属性与服务器同步并不总是一个好主意。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-06-14T12:12:13.797

您可以使用[$.ajax()](http://docs.jquery.com/Ajax/jQuery.ajax#options)的`error`回调，它会在请求失败时触发。如果`textStatus`等于字符串“timeout”，则可能意味着连接断开：

```
function (XMLHttpRequest, textStatus, errorThrown) {
  // typically only one of textStatus or errorThrown 
  // will have info
  this; // the options for this ajax request
} 
```

从[文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)：

> **错误**：请求失败时调用的函数。该函数被传递三个参数：XMLHttpRequest 对象，一个描述发生的错误类型的字符串和一个可选的异常对象（如果发生了）。第二个参数（除了 null）的可能值是“timeout”、“error”、“notmodified”和“parsererror”。这是一个 Ajax 事件

例如：

```
 $.ajax({
   type: "GET",
   url: "keepalive.php",
   success: function(msg){
     alert("Connection active!")
   },
   error: function(XMLHttpRequest, textStatus, errorThrown) {
       if(textStatus == 'timeout') {
           alert('Connection seems dead!');
       }
   }
 }); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2019-10-31T07:24:14.130

```
window.navigator.onLine 
```

是您要查找的内容，但这里要添加的内容很少，首先，如果它是您想要继续检查的应用程序上的某些内容（例如查看用户是否突然离线，在这种情况下大多数情况下都是正确的，那么您还需要收听更改），为此您将事件侦听器添加到窗口以检测任何更改，以检查用户是否下线，您可以执行以下操作：

```
window.addEventListener("offline", 
  ()=> console.log("No Internet")
); 
```

并检查是否在线：

```
window.addEventListener("online", 
  ()=> console.log("Connected Internet")
); 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-10-09T23:24:05.900

HTML5 应用程序缓存 API 指定了 navigator.onLine，它目前在 IE8 测试版、WebKit（例如 Safari）nightlies 中可用，并且已在 Firefox 3 中得到支持

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-04-12T19:05:37.323

我必须为一个经常与学校合作的客户制作一个网络应用程序（基于 ajax），这些学校的互联网连接通常很差，我使用这个简单的功能来检测是否有连接，效果很好！

我使用 CodeIgniter 和 Jquery：

```
function checkOnline() {
    setTimeout("doOnlineCheck()", 20000);
}

function doOnlineCheck() {
    //if the server can be reached it returns 1, other wise it times out
    var submitURL = $("#base_path").val() + "index.php/menu/online";

    $.ajax({
        url : submitURL,
        type : "post",
        dataType : "msg",
        timeout : 5000,
        success : function(msg) {
            if(msg==1) {
                $("#online").addClass("online");
                $("#online").removeClass("offline");
            } else {
                $("#online").addClass("offline");
                $("#online").removeClass("online");
            }
            checkOnline();
        },
        error : function() {
            $("#online").addClass("offline");
            $("#online").removeClass("online");
            checkOnline();
        }
    });
} 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2015-04-22T09:31:58.483

对您的域进行 ajax 调用是检测您是否离线的最简单方法

```
$.ajax({
      type: "HEAD",
      url: document.location.pathname + "?param=" + new Date(),
      error: function() { return false; },
      success: function() { return true; }
   }); 
```

这只是给你的概念，应该改进。

eg error=404 应该仍然意味着你在线

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-10-03T10:56:14.477

我认为这是一个非常简单的方法。

```
var x = confirm("Are you sure you want to submit?");
if (x) {
  if (navigator.onLine == true) {
    return true;
  }
  alert('Internet connection is lost');
  return false;
}
return false; 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2020-09-28T00:10:19.520

我知道这个问题已经得到解答，但我想加我的 10 美分，解释什么更好，什么不是。

## Window.navigator.onLine

我注意到一些答案谈到了这个选项，但他们从来没有提到任何关于警告的事情。

此选项涉及使用“ [window.navigator.onLine](https://developer.mozilla.org/en-US/docs/Web/API/NavigatorOnLine/onLine) ”，这是大多数现代浏览器上可用的 Browser Navigator Interface 下的一个属性。这确实不是检查互联网可用性的可行选择，因为首先`it is browser centric`和其次`most browsers implement this property differently`。

> **在 Firefox 中：**该属性返回一个布尔值，具有`true`在线`false`含义和离线含义，但这里需要注意的是“ `the value is only updated when the user follows links or when a script requests a remote page.`”因此，如果用户离线并且您从 js 函数或脚本查询该属性，该属性将始终返回`true`，直到用户跟随一个链接。
> 
> **在 Chrome 和 Safari**中：如果浏览器无法连接到局域网 (LAN) 或路由器，则它处于脱机状态；所有其他条件都返回 true。因此，虽然您可以假设浏览器在返回 false 值时处于脱机状态，但您不能假设 true 值必然意味着浏览器可以访问互联网。您可能会得到误报，例如在计算机运行具有始终“连接”的虚拟以太网适配器的虚拟化软件的情况下。

上面的陈述只是想让您知道仅凭浏览器无法分辨。所以基本上这个选项是不可靠的。

## 向自己的服务器资源发送请求

这涉及向您自己的服务器资源发出 HTTP 请求，如果可以访问，则假定 Internet 可用性，否则用户处于脱机状态。此选项有一些注意事项。

1.  没有服务器可用性是 100% 依赖的，因此如果由于某种原因您的服务器无法访问，则会错误地假定用户在连接到 Internet 时处于离线状态。
2.  对同一资源的多个请求可能会返回缓存的响应，从而使 http 响应结果不可靠。

如果您同意您的服务器始终在线，那么您可以使用此选项。

这是一个获取自己资源的简单片段：

```
// This fetches your website's favicon, so replace path with favicon url
// Notice the appended date param which helps prevent browser caching.
fetch('/favicon.ico?d='+Date.now())
  .then(response => {
    if (!response.ok)
      throw new Error('Network response was not ok');

   // At this point we can safely assume the user has connection to the internet
        console.log("Internet connection available"); 
  })
  .catch(error => {
  // The resource could not be reached
        console.log("No Internet connection", error);
  }); 
```

## 向第三方服务器资源发送请求

我们都知道 CORS 是一回事。

此选项涉及向外部服务器资源发出 HTTP 请求，如果可以访问，则假定 Internet 可用性，否则用户处于脱机状态。对此的主要警告是作为限制的[跨域资源共享。](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)大多数信誉良好的网站都会阻止 CORS 请求，但对于某些网站，您可以随心所欲。

下面是一个获取外部资源的简单片段，与上面相同，但带有外部资源 url：

```
// Firstly you trigger a resource available from a reputable site
// For demo purpose you can use the favicon from MSN website
// Also notice the appended date param which helps skip browser caching.
fetch('https://static-global-s-msn-com.akamaized.net/hp-neu/sc/2b/a5ea21.ico?d='+Date.now())
  .then(response => {
  // Check if the response is successful
    if (!response.ok)
      throw new Error('Network response was not ok');

// At this point we can safely say the user has connection to the internet
        console.log("Internet available"); 
  })
  .catch(error => {
  // The resource could not be reached
        console.log("No Internet connection", error);
  }); 
```

所以，最后对于我的个人项目，我选择了第二个选项，它涉及请求自己的服务器资源，因为基本上有很多因素可以判断用户设备上是否存在“Internet 连接”，而不仅仅是来自您的网站容器，也不是来自有限的浏览器 API。

请记住，您的用户也可能处于某些网站或资源被阻止、禁止且无法访问的环境中，这反过来会影响连接检查的逻辑。最好的选择是：

*   尝试访问您自己服务器上的资源，因为这是您的用户环境（通常我使用网站的图标，因为响应非常轻且不经常更新）。
*   如果没有与资源的连接，只需在需要通知用户时说“连接错误”或“连接丢失”，而不是假设一个广泛的“没有互联网连接”，这取决于许多因素。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-11-01T09:21:52.017

我的方式。

```
<!-- the file named "tt.jpg" should exist in the same directory -->

<script>
function testConnection(callBack)
{
    document.getElementsByTagName('body')[0].innerHTML +=
        '<img id="testImage" style="display: none;" ' +
        'src="tt.jpg?' + Math.random() + '" ' +
        'onerror="testConnectionCallback(false);" ' +
        'onload="testConnectionCallback(true);">';

    testConnectionCallback = function(result){
        callBack(result);

        var element = document.getElementById('testImage');
        element.parentNode.removeChild(element);
    }    
}
</script>

<!-- usage example -->

<script>
function myCallBack(result)
{
    alert(result);
}
</script>

<a href=# onclick=testConnection(myCallBack);>Am I online?</a> 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-03-12T00:39:40.450

我正在寻找一种客户端解决方案来检测互联网是否已关闭或我的服务器是否已关闭。我发现的其他解决方案似乎总是依赖于第 3 方脚本文件或图像，在我看来，这似乎经不起时间的考验。外部托管脚本或图像将来可能会更改并导致检测代码失败。

我找到了一种通过查找带有 404 代码的 xhrStatus 来检测它的方法。另外，我使用 JSONP 来绕过 CORS 限制。404 以外的状态代码表示互联网连接不工作。

```
$.ajax({
    url:      'https://www.bing.com/aJyfYidjSlA' + new Date().getTime() + '.html',
    dataType: 'jsonp',
    timeout:  5000,

    error: function(xhr) {
        if (xhr.status == 404) {
            //internet connection working
        }
        else {
            //internet is down (xhr.status == 0)
        }
    }
}); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-04-28T09:40:23.570

如何使用 no-cors 向 google.com 发送不透明的 http 请求？

```
 fetch('https://google.com', {
        method: 'GET', // *GET, POST, PUT, DELETE, etc.
        mode: 'no-cors',
    }).then((result) => {
        console.log(result)
    }).catch(e => {
        console.error(e)
    }) 
```

设置 no-cors 的原因是即使在我的电脑上禁用网络连接时我也收到了 cors 错误。所以无论有没有互联网连接，我都会被阻止。添加 no-cors 会使请求变得不透明，这似乎绕过了 cors，让我只需检查我是否可以连接到 Google。

仅供参考：我在这里使用 fetch 来发出 http 请求。 [https://www.npmjs.com/package/fetch](https://www.npmjs.com/package/fetch)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-11-23T08:05:01.143

只需使用`navigator.onLine`if this is `true`then you're online else offline

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-02-21T06:26:11.800

如果网络连接，您可以尝试这将返回 true

```
function isInternetConnected(){return navigator.onLine;} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-05-28T22:22:56.250

请求错误中的请求头

```
$.ajax({
    url: /your_url,
    type: "POST or GET",
    data: your_data,
    success: function(result){
      //do stuff
    },
    error: function(xhr, status, error) {

      //detect if user is online and avoid the use of async
        $.ajax({
            type: "HEAD",
            url: document.location.pathname,
            error: function() { 
              //user is offline, do stuff
              console.log("you are offline"); 
              }
         });
    }   
}); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-07-19T21:18:41.793

一些方法的问题`navigator.onLine`是它们与某些浏览器和移动版本不兼容，一个对我有很大帮助的选项是使用经典`XMLHttpRequest`方法，并且还预见到文件存储在缓存中且响应`XMLHttpRequest.status`大于的可能情况200 和小于 304。

**这是我的代码：**

```
 var xhr = new XMLHttpRequest();
 //index.php is in my web
 xhr.open('HEAD', 'index.php', true);
 xhr.send();

 xhr.addEventListener("readystatechange", processRequest, false);

 function processRequest(e) {
     if (xhr.readyState == 4) {
         //If you use a cache storage manager (service worker), it is likely that the
         //index.php file will be available even without internet, so do the following validation
         if (xhr.status >= 200 && xhr.status < 304) {
             console.log('On line!');
         } else {
             console.log('Offline :(');
         }
     }
} 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2009-10-29T12:38:23.480

这是我拥有的辅助实用程序的片段。这是命名空间的 javascript：

```
network: function() {
    var state = navigator.onLine ? "online" : "offline";
    return state;
} 
```

您应该将此与方法检测一起使用，否则会触发一种“替代”方式来执行此操作。时间很快就要到了，这将是我们所需要的一切。其他方法是黑客。

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2018-04-23T08:32:14.880

对于两个不同的场景，有 2 个答案：-

1.  如果您在网站上使用 JavaScript（即；或任何前端部分），最简单的方法是：

    ```
    <h2>The Navigator Object</h2>

    <p>The onLine property returns true if the browser is online:</p>

    <p id="demo"></p>

    <script>
      document.getElementById("demo").innerHTML = "navigator.onLine is " + navigator.onLine;
    </script> 
    ```

2.  但是，如果您在服务器端（即节点等）使用 js，您可以通过发出失败的 XHR 请求来确定连接丢失。

    标准方法是重试请求几次。如果它没有通过，提醒用户检查连接，并优雅地失败。

# visual-studio-2008 - ASP.NET 3.5 版网站：文件“vwd.webinfo”究竟做了什么？臃肿的 web.config 文件是怎么回事？

> ID：189433
> 
> 赞同：6
> 
> 时间：2008-10-09T22:24:20.687
> 
> 标签：visual-studio-2008, asp.net-3.5

我正在运行 Visual Studio Team Edition 2008。

当我创建一个新网站时，我得到了一个我以前从未见过的新文件：*vwd.webinfo*。

该文件的内容如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<VisualWebDeveloper>
    <!-- Visual Studio global web project settings. -->
    <StartupServices>
        <Service ID="{3259AA49-8AA1-44D3-9025-A0B520596A8C}"/>
    </StartupServices>
</VisualWebDeveloper> 
```

我需要一个“全局 Web 项目设置”文件来做什么？它到底有什么作用？

还; 臃肿的*web.config*文件是怎么回事？在标准的 ASP.NET 2.0 版网站项目中，*web.config*文件包含大约 10 行代码。但是在一个 ASP.NET 3.5 版本的网站项目中，它充满了各种奇怪的设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T22:37:10.613

创建它是因为您使用的是文件系统网站。在此处阅读有关它的更多信息：http: [//msdn.microsoft.com/en-us/library/e5x4xz73.aspx](http://msdn.microsoft.com/en-us/library/e5x4xz73.aspx)

“臃肿”是什么意思？你能粘贴膨胀吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T22:39:23.043

看起来该文件是基于[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/e5x4xz73.aspx)的文件系统 Web 项目的一部分。似乎他们将一些功能从项目文件中移到了该文件中（这是有道理的，因为项目文件现在不在文件系统项目中）。

“臃肿”的 web.config 文件是由于 ASP.Net 3.5 中的所有新功能（例如 AJAX）造成的。如果您不使用这些功能，您可以删除很多这些项目。

# .net - 在 .NET 中读取 YAML 响应的最佳方法？

> ID：189435
> 
> 赞同：2
> 
> 时间：2008-10-09T22:25:40.510
> 
> 标签：.net, yaml, pandastream

我们最近一直在尝试开发一个使用 pandastream 对我们的视频进行编码的应用程序，我们正在成功发送视频，我们得到的响应是 YAML，但是我们能找到的唯一工具（.NET 的 YAML）是不解析文件。有没有其他人遇到过这个问题，或者对在 .NET 中解析 YAML 文件的最佳实践有任何见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T14:19:59.997

只是为了更新，我发现了一个相当有用但还不太优雅的解决方案来解决我的问题。

[yamldotnet](http://sourceforge.net/project/showfiles.php?group_id=235362)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-25T04:23:28.223

你试过吗，[http://www.codeplex.com/yaml](http://www.codeplex.com/yaml)？

# wcf - 使用 WCFTestClient 测试简单 WCF Web 服务的 WCF 错误

> ID：189436
> 
> 赞同：13
> 
> 时间：2008-10-09T22:26:07.547
> 
> 标签：wcf, using, wcftestclient

当我尝试使用“wcftestclient”测试 AutoLotWCFService 时，出现以下错误。我究竟做错了什么？任何见解都会有所帮助。这是一个简单的 Web 服务，它具有 wshttpbinding 和接口契约以及服务中的实现。这是长错误消息：Web.Config 文件有 2 个端点 - 一个用于 Web 服务本身，另一个用于 metaDataExchange。它几乎都是默认的东西。如果需要，我可以包含代码 - 似乎我无法在此处附加文件。

* * *

```
Error: Cannot obtain Metadata from http://localhost/AutoLotWCFService/Service.svc
If this is a Windows (R) Communication Foundation service to which you have access, please check that you have enabled metadata publishing at the specified address.  
For help enabling metadata publishing, please refer to the MSDN documentation at http://go.microsoft.com/fwlink/?LinkId=65455.
WS-Metadata Exchange Error
    URI: http://localhost/AutoLotWCFService/Service.svc
    Metadata contains a reference that cannot be resolved: 'http://localhost/AutoLotWCFService/Service.svc'.
    The remote server returned an unexpected response: (405) Method not allowed.
    The remote server returned an error: (405) Method Not Allowed.
    HTTP GET Error    URI: http://localhost/AutoLotWCFService/Service.svc
    The document at the url http://localhost/AutoLotWCFService/Service.svc was not recognized as a known document type.The error message from each known type may help you fix the problem:
    - Report from 'DISCO Document' is 'Name cannot begin with the '%' character, hexadecimal value 0x25\. Line 1, position 2.'.
    - Report from 'WSDL Document' is 'There is an error in XML document (1, 2).' -Name cannot begin with the '%' character, hexadecimal value 0x25\. Line 1, position 2.
    - Report from 'XML Schema' is 'Name cannot begin with the '%' character, hexadecimal value 0x25\. Line 1, position 2.'. 
```

* * *

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T15:51:00.580

我最近在尝试在 IIS7 下的 Windows Vista 笔记本电脑上托管 WCF 时遇到了这个问题。

我首先收到以下错误：“HTTP 错误 404.3 - 未找到”，建议的解决方案之一是“确保映射当前页面的预期处理程序”。

所以我手动为 .svc 文件添加了一个处理程序，并将其定义为 DiscoveryRequestHandler，认为这可能会有所帮助。这导致了您上面描述的问题。

实际的解决方案是删除我添加的处理程序，并运行以下命令：

```
CD c:\windows\Microsoft.Net\Framework\v3.0\Windows Communication Foundation\
ServiceModelReg -i 
```

这解决了我的问题，服务运行良好。我希望这可能有助于阐明您的问题。我不能确定，但​​这可能是因为我在开发笔记本电脑上安装各种软件包的顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-19T10:55:24.500

If installing compenonts doesnt work try a repair, this uninstalls and then installs.

```
"%WINDIR%\Microsoft.Net\Framework\v3.0\Windows Communication Foundation\ServiceModelReg.exe" -r 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-15T09:02:23.087

尝试检查服务标记中的 service(name)（右键单击 servicename.svc）是否与 web.config 文件中的 service(name) 匹配。

干杯!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T22:34:48.090

您需要确保服务行为配置启用具有 httpGetEnabled="true" 的元数据标记

```
<serviceBehaviors>
  <behavior name="serviceBehavior">
    <serviceMetadata httpGetEnabled="true">
  </behavior>
</serviceBehaviors> 
```

此外，请确保您的服务引用该行为。

```
 <service name="blah" behaviorConfiguration="serviceBehavior"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T15:52:40.027

谢谢; 信不信由你，当我使用 aspnet-regiis 在 IIS 中重新注册 ASPNET 时，至少通过 wcftestclient 加载服务的问题得到了解决。

下一个问题是能够通过 wcftestclient 调用服务公开的方法。我必须处理哪些安全问题？我必须使用 Windows auth 启用匿名登录。并且仍然调用生成的异常指向与访问冲突相关的内容。在搜索某些东西时，指向安装证书以能够调用..如果可能，请赐教。

# apache - Apache - Reverse Proxy and HTTP 302 status message

> ID：189451
> 
> 赞同：12
> 
> 时间：2008-10-09T22:30:15.557
> 
> 标签：apache, redirect, reverse-proxy, http-status-code-302

My team is trying to setup an Apache reverse proxy from a customer's site into one of our web applications.

[http://www.example.com/app1/some-path](http://www.example.com/app1/some-path) maps to [http://internal1.example.com/some-path](http://internal1.example.com/some-path)

Inside our application we use struts and have redirect = true set on certain actions in order to provide certain functionality. The 302 status messages from these re-directs cause the user to break out of the proxy resulting in an error page for the end user.

HTTP/1.1 302 Found Location: [http://internal.example.com/some-path/redirect](http://internal.example.com/some-path/redirect)

Is there any way to setup the reverse proxy in apache so that the redirects work correctly?

[http://www.example.com/app1/some-path/redirect](http://www.example.com/app1/some-path/redirect)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T00:42:19.127

There is an article titled [Running a Reverse Proxy in Apache](http://www.askapache.com/htaccess/reverse-proxy-apache.html) that seems to address your problem. It even uses the same example.com and /app1 that you have in your example. Go to the "Configuring the Proxy" section for examples on how to use [ProxyPassReverse](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html#proxypassreverse).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-23T16:50:42.713

The [AskApache article](http://www.askapache.com/htaccess/reverse-proxy-apache.html "Running a Reverse Proxy in Apache") is quite helpful, but in practice I found a combination of Rewrite rules and ProxyPassReverse to be more flexible. So in your case I'd do something like this:

```
 <VirtualHost example>
       ServerName www.example.com

       ProxyPassReverse /app1/some-path/ http://internal1.example.com/some-path/
       RewriteEngine On
       RewriteRule /app1/(.*)   http://internal1.example.com/some-path$1 [P]

       ...
    </VirtualHost> 
```

I like this better because it gives you finer-grained control over the paths you're proxying for the internal server. In our case we wanted to expose only part of third-party application. Note that this doesn't address hard-coded links in HTML, which the AskApache article covers.

Also, note that you can have multiple ProxyPassReverse lines:

```
 ProxyPassReverse / http://internal1.example.com/some-path
    ProxyPassReverse / http://internal2.example.com/some-path 
```

I mention this only because another third-party app we were proxying was sending out redirects that didn't include their internal host name, just a different port.

As a final note, keep in mind that [Firebug](http://getfirebug.com/ "Firebug -- Web Development Evolved") is extremely useful when debugging the redirects.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-09T17:54:18.133

Basically, `ProxyPassReverse` should take care of rewriting the Location header for you, as Kevin Hakanson pointed out.

One pitfall I have encountered is missing the trailing slash in the url argument. Make sure to use:

```
ProxyPassReverse / http://internal1.example.com/some-path/ 
```

(note the trailing slash!)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T22:40:40.403

Try using the AJP connector instead of reverse proxy. Certainly not a trivial change, but I've found that a lot of the URL nightmares go away when using AJP instead of reverse proxy.

# estimation - 你如何改进你的估计过程？

> ID：189467
> 
> 赞同：6
> 
> 时间：2008-10-09T22:37:17.413
> 
> 标签：estimation

估计任何给定任务需要多长时间似乎是软件开发中最困难的部分之一。在我目前的商店，我们在迭代开始时以小时为单位估计任务，但是一旦任务完成，我们就不会用它来帮助我们进行未来的估计。

您如何使用从过去估计中收集的信息来改进未来的估计？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T22:43:45.450

到目前为止，我见过的最有趣的实际调度方法之一是[基于证据的调度](http://www.joelonsoftware.com/items/2007/10/26.html)，它是 FogCreek FogBugz 6.0 版本的一部分。有关概要和一些示例，请参阅上面链接的 Joel 博客文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T22:40:29.780

如果估算结果超出预期，请尝试确定它是否只是随机的（环境破坏，一些曾经出现过棘手的错误等），或者是否存在您没有识别的东西。

如果估算值太大，请确定您认为会花费这么长时间的原因，并找出为什么没有。

做到这一点有望帮助开发人员进行估算。

例如，如果开发人员认为为控制器编写测试需要很长时间，然后最终花费的时间比他想象的要少，那么您对类似范围的控制器所做的下一次估计可以记住这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T22:42:04.707

我和我的队友反复估计，直到我们达成共识。当然，我们会犯错误，但我们不会明确计算“速度”因子，而是在新的估计辩论中使用收集到的经验。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T22:43:21.333

我发现估计时间会让你走这么远。与其他任务、不可预见的情况或项目影响的中断将不可避免地改变你的时间框架，如果你不断地重新评估你会浪费很多时间来管理你可以开发的时间。

所以对我们来说，我们根据经验对时间解决方案进行初步估计（我们不使用模型，我还没有找到在我们的环境中运行得足够好的模型），但不要根据它来判断我们的 KPI，也不我们是否向企业保证这个截止日期会被击中。我们这里的开发方法很大程度上是被动的，它似乎很好地满足了我们的业务需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-15T15:26:03.527

当估计不正确时，几乎总是有一个明显的原因，这会导致吸取教训。最近记忆中的：

*   用户界面假定 .NET 功能不存在（插入新行并在 GridView 中内联编辑它的能力）；经验教训是在进行估算之前验证所选类的功能。这个错误花了一周的时间。

*   ftp 进程假设 FtpWebRequest 可以与银行的安全 ftp 服务器通信；事实证明，如果 ftp 服务器返回当前目录的反斜杠以外的任何内容，则此类存在已知错误；吸取的教训是用类名搜索“错误”和“问题”，而不仅仅是“教程”和“示例”，以确保没有“陷阱”潜伏。这个错误花了三天时间。

这些经验教训进入项目评估和开发“清单”文档，因此下一个项目不会忘记它们

# java - 使用 Java 从日期中识别季节

> ID：189468
> 
> 赞同：2
> 
> 时间：2008-10-09T22:37:41.423
> 
> 标签：java, date

我从 SO 那里得到的只是好运，所以为什么不再试一次呢？

我有一个应用程序需要根据一年中的季节（春季、夏季、冬季、秋季）显示不同的图像。我对这些季节有非常具体的开始和结束日期。

我希望各位天才们提供一种名为 GetSeason 的方法，该方法将日期作为输入并返回 Spring、Summer、Winter 或 Fall 的 String 值。以下是日期范围及其相关季节：

春季：3/1-4/30
夏季：5/1-8/31
秋季：9/1-10/31
冬季：11/1-2/28

有人可以提供一种工作方法来恢复适当的季节吗？谢谢大家！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T22:57:50.727

似乎只检查月份就可以了：

```
private static final String seasons[] = {
  "Winter", "Winter", "Spring", "Spring", "Summer", "Summer", 
  "Summer", "Summer", "Fall", "Fall", "Winter", "Winter"
};
public String getSeason( Date date ) {
   return seasons[ date.getMonth() ];
}

// As stated above, getMonth() is deprecated, but if you start with a Date, 
// you'd have to convert to Calendar before continuing with new Java, 
// and that's not fast. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-25T21:53:47.423

这里有一些很好的答案，但它们已经过时了。java.time 类使这项工作更容易。

# java.time

Java 8 及更高版本中内置的[java.time](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)类已取代了与最早版本的 Java 捆绑在一起的麻烦的旧类。请参阅[Oracle 教程](http://docs.oracle.com/javase/tutorial/datetime/TOC.html)。大部分功能已在 ThreeTen-Backport 中向后移植到 Java 6 和 7，并在[ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP)[中](http://www.threeten.org/threetenbp/)进一步适应 Android 。

## `Month`

鉴于此处使用整月定义季节，我们可以使用方便的[enum](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)。这样的枚举值比单纯的整数值 (1-12) 要好，因为它们是类型安全的，并且可以保证您得到有效值。[`Month`](http://docs.oracle.com/javase/8/docs/api/java/time/Month.html)

## `EnumSet`

An[`EnumSet`](http://docs.oracle.com/javase/8/docs/api/java/util/EnumSet.html)是一种跟踪枚举值子集的快速执行且内存紧凑的方法。

```
EnumSet<Month> spring = EnumSet.of( Month.MARCH , Month.APRIL );
EnumSet<Month> summer = EnumSet.of( Month.MAY , Month.JUNE , Month.JULY , Month.AUGUST );
EnumSet<Month> fall = EnumSet.of( Month.SEPTEMBER , Month.OCTOBER );
EnumSet<Month> winter = EnumSet.of( Month.NOVEMBER , Month.DECEMBER , Month.JANUARY , Month.FEBRUARY ); 
```

例如，我们获取特定时区的当前时刻。

```
ZoneId zoneId = ZoneId.of( "America/Montreal" );
ZonedDateTime zdt = ZonedDateTime.now( zoneId ); 
```

询问它的日期时间值`Month`。

```
Month month = Month.from( zdt ); 
```

通过调用查找哪个季节`EnumSet`具有该特定月份值[`contains`](http://docs.oracle.com/javase/8/docs/api/java/util/Set.html#contains-java.lang.Object-)。

```
if ( spring.contains( month ) ) {
    …
} else if ( summer.contains( month ) ) {
    …
} else if ( fall.contains( month ) ) {
    …
} else if ( winter.contains( month ) ) {
    …
} else {
    // FIXME: Handle reaching impossible point as error condition.
} 
```

## 定义你自己的“季节”枚举

如果你在你的代码库中使用这个季节的想法，我建议定义你自己的枚举，“季节”。

基本枚举很简单：`public enum Season { SPRING, SUMMER, FALL, WINTER; }`. 但是我们还添加了一个静态方法`of`来查找哪个月份映射到哪个季节。

```
package work.basil.example;

import java.time.Month;

public enum Season {
    SPRING, SUMMER, FALL, WINTER;

    static public Season of ( final Month month ) {
        switch ( month ) {

            // Spring.
            case MARCH:  // Java quirk: An enum switch case label must be the unqualified name of an enum. So cannot use `Month.MARCH` here, only `MARCH`.
                return Season.SPRING;

            case APRIL:
                return Season.SPRING;

            // Summer.
            case MAY:
                return Season.SUMMER;

            case JUNE:
                return Season.SUMMER;

            case JULY:
                return Season.SUMMER;

            case AUGUST:
                return Season.SUMMER;

            // Fall.
            case SEPTEMBER:
                return Season.FALL;

            case OCTOBER:
                return Season.FALL;

            // Winter.
            case NOVEMBER:
                return Season.WINTER;

            case DECEMBER:
                return Season.WINTER;

            case JANUARY:
                return Season.WINTER;

            case FEBRUARY:
                return Season.WINTER;

            default:
                System.out.println ( "ERROR." );  // FIXME: Handle reaching impossible point as error condition.
                return null;
        }
    }

} 
```

或者使用 Java 14 的 switch 表达式功能 ( [JEP 361](https://openjdk.java.net/jeps/361) )。

```
package work.basil.example;

import java.time.Month;
import java.util.Objects;

public enum Season
{
    SPRING, SUMMER, FALL, WINTER;

    static public Season of ( final Month month )
    {
        Objects.requireNonNull( month , "ERROR - Received null where a `Month` is expected. Message # 0ac03df9-1c5a-4c2d-a22d-14c40e25c58b." );
        return
                switch ( Objects.requireNonNull( month ) )
                        {
                            // Spring.
                            case MARCH , APRIL -> Season.SPRING;

                            // Summer.
                            case MAY , JUNE , JULY , AUGUST -> Season.SUMMER;

                            // Fall.
                            case SEPTEMBER , OCTOBER -> Season.FALL;

                            // Winter.
                            case NOVEMBER , DECEMBER , JANUARY , FEBRUARY -> Season.WINTER;
                        }
                ;
    }
} 
```

以下是如何使用该枚举。

```
ZoneId zoneId = ZoneId.of ( "America/Montreal" );
ZonedDateTime zdt = ZonedDateTime.now ( zoneId );
Month month = Month.from ( zdt );
Season season = Season.of ( month ); 
```

转储到控制台。

```
System.out.println ( "zdt: " + zdt + " |  month: " + month + " | season: " + season ); 
```

> zdt: 2016-06-25T18:23:14.695-04:00[美国/蒙特利尔] | 月份：六月 | 季节：夏季

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T22:51:44.313

好吧，它可能很简单

```
String getSeason(int month) {
    switch(month) {
          case 11:
          case 12:
          case 1:
          case 2:
                return "winter";
          case 3:
          case 4:
                return "spring";
          case 5:
          case 6:
          case 7:
          case 8:
                return "summer";
          default:
                return "autumn";
      }
} 
```

我在评论中被指责为更好的解决方案：枚举：

```
public static Enum Season {
    WINTER(Arrays.asList(11,12,1,2)),
    SPRING(Arrays.asList(3,4)),
    SUMMER(Arrays.asList(5,6,7,8)),
    AUTUMN(Arrays.asList(9,10));

    Season(List<Integer> months) {
        this.monthlist = months;
    }
    private List<Integer> monthlist;
    public boolean inSeason(int month) {
        return this.monthlist.contains(month);  // if months are 0 based, then insert +1 before the )
    }

    public static Season seasonForMonth(int month) {
        for(Season s: Season.values()) {
            if (s.inSeason(month))
                 return s;
        }
        throw new IllegalArgumentException("Unknown month");
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T23:13:56.980

我感到受宠若惊，但受宠若惊。所以我会做的。

这不仅检查月份，而且检查月份中的某一天。

```
import java.util.*

public String getSeason(Date today, int year){

    // the months are one less because GC is 0-based for the months, but not days.
    // i.e. 0 = January.
    String returnMe = "";

    GregorianCalender dateToday = new GregorianCalender(year, today.get(Calender.MONTH_OF_YEAR), today.get(Calender.DAY_OF_MONTH);
    GregorianCalender springstart = new GregorianCalender(year, 2, 1);
    GregorianCalender springend = new GregorianCalender(year, 3, 30);
    GregorianCalender summerstart = new GregorianCalender(year, 4, 1);
    GregorianCalender summerend = new GregorianCalender(year, 7, 31);
    GregorianCalender fallstart = new GregorianCalender(year, 8, 1);
    GregorianCalender fallend = new GregorianCalender(year, 9, 31);
    GregorianCalender winterstart = new GregorianCalender(year, 10, 1);
    GregorianCalender winterend = new GregorianCalender(year, 1, 28);

    if ((dateToday.after(springstart) && dateToday.before(springend)) || dateToday.equals(springstart) || dateToday.equals(springend)){
        returnMe = "Spring";

    else if ((dateToday.after(summerstart) && dateToday.before(summerend)) || dateToday.equals(summerstart) || dateToday.equals(summerend)){
        returnMe = "Summer";

    else if ((dateToday.after(fallstart) && dateToday.before(fallend)) || dateToday.equals(fallstart) || dateToday.equals(fallend)){
        returnMe = "Fall";

    else if ((dateToday.after(winterstart) && dateToday.before(winterend)) || dateToday.equals(winterstart) || dateToday.equals(winterend)){
        returnMe = "Winter";

    else {
        returnMe = "Invalid";
    }
    return returnMe;
} 
```

我敢肯定这很可怕，并且可以改进。在评论中告诉我。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-27T19:34:57.460

```
public class lab6project1 {
    public static void main(String[] args) {
        Scanner keyboard = new Scanner(System.in);

        System.out.println("This program reports the season for a given day and month");
        System.out.println("Please enter the month and day as integers with a space between the month and day");

        int month = keyboard.nextInt();
        int day = keyboard.nextInt();

        if ((month == 1) || (month == 2)) {
            System.out.println("The season is Winter");
        } else if ((month == 4) || (month == 5)) {
            System.out.println("The season is Spring");
        } else if ((month == 7) || (month == 8)) {
            System.out.println("The season is Summer");
        } else if ((month == 10) || (month == 11)) {
            System.out.println("The season is Fall");
        } else if ((month == 3) && (day <= 19)) {
            System.out.println("The season is Winter");
        } else if (month == 3) {
            System.out.println("The season is Spring");
        } else if ((month == 6) && (day <= 20)) {
            System.out.println("The season is Spring");
        } else if (month == 6) {
            System.out.println("The season is Summer");
        } else if ((month == 9) && (day <= 20)) {
            System.out.println("The season is Summer");
        } else if (month == 9) {
            System.out.println("The season is Autumn");
        } else if ((month == 12) && (day <= 21)) {
            System.out.println("The season is Autumn");
        } else if (month == 12) {
            System.out.println("The season is Winter");
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-24T05:09:38.597

尝试使用哈希表或枚举。您可以将日期转换为某个值（jan 1 为 1，...），然后为某个字段创建 bin。或者您可以对月份进行枚举。{一月：冬天，二月：冬天，...七月：夏天，等等}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T22:52:43.687

由于在此范围内所有季节都是整月，因此您可以使用日期的月份进行切换：

```
switch (date.getMonth()) {
    case Calendar.JANUARY:
    case Calendar.FEBRUARY:
         return "winter";
    case Calendar.MARCH:
         return "spring";
    //etc
} 
```

我建议使用所有 12 个日历常量来完成整个切换，而不是最后一个的默认值。然后，您可以确保您的输入是正确的，例如

```
default:
 throw new IllegalArgumentException(); 
```

在末尾。

根据您的用例，您可能还希望在季节中使用 Enum，而不是简单的字符串。

请注意 Date.getMonth() 方法已弃用，您应该改用 java.util.Calendar.get(Calendar.MONTH) 。（只需使用 calendar.setDate(yourDate) 将日期转换为日历）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-01T08:45:54.783

简单的解决方案

```
 Calendar calendar = Calendar.getInstance();
 calendar.setTimeInMillis(timeInMills);
 int month = calendar.get(Calendar.MONTH);
 CurrentSeason = month == 11 ? 0 : (month + 1) / 3; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-07T02:37:33.850

您的问题的标题非常笼统，因此大多数用户首先会想到天文季节。即使您的问题的详细内容仅限于自定义的日期范围，但这种限制可能只是由于无法计算天文情况造成的，所以我也敢于针对天文场景发布这个老问题的答案。

这里的大多数答案仅基于整月。我在这里举两个例子来解决天文季节和基于任意日期范围的季节。

## a) 将任意日期范围映射到季节

在这里**，我们肯定需要额外的信息，具体的时区**或偏移量，否则我们无法`java.util.Date`使用月份和日期的组合将瞬间（如您输入的老式实例）转换为本地表示。为简单起见，我假设系统时区。

```
 // your input
    java.util.Date d = new java.util.Date();
    ZoneId tz = ZoneId.systemDefault();

    // extract the relevant month-day
    ZonedDateTime zdt = d.toInstant().atZone(tz);
    MonthDay md = MonthDay.of(zdt.getMonth(), zdt.getDayOfMonth());

    // a definition with day-of-month other than first is possible here
    MonthDay beginOfSpring = MonthDay.of(3, 1);
    MonthDay beginOfSummer = MonthDay.of(5, 1);
    MonthDay beginOfAutumn = MonthDay.of(9, 1);
    MonthDay beginOfWinter = MonthDay.of(11, 1);

    // determine the season
    Season result;

    if (md.isBefore(beginOfSpring)) {
        result = Season.WINTER;
    } else if (md.isBefore(beginOfSummer)) {
        result = Season.SPRING;
    } else if (md.isBefore(beginOfAutumn)) {
        result = Season.SUMMER;
    } else if (md.isBefore(beginOfWinter)) {
        result = Season.FALL;
    } else {
        result = Season.WINTER;
    }

    System.out.println(result); 
```

我使用了一个简单的帮助枚举，例如`public enum Season { SPRING, SUMMER, FALL, WINTER; }`.

## b) 天文季节

在这里，我们还需要一个额外的信息，即季节是在北半球还是在南半球。我的库[Time4J](https://github.com/MenoData/Time4J)基于使用 v5.2 版本的预定义枚举[AstronomicalSeason提供以下解决方案：](http://time4j.net/javadoc-en/net/time4j/calendar/astro/AstronomicalSeason.html)

```
 // your input
    java.util.Date d = new java.util.Date();
    boolean isSouthern = false;

    Moment m = TemporalType.JAVA_UTIL_DATE.translate(d);
    AstronomicalSeason result = AstronomicalSeason.of(m);

    if (isSouthern) { // switch to southern equivalent if necessary
        result = result.onSouthernHemisphere();
    }

    System.out.println(result); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-26T00:32:10.950

如果只需要北半球的季节编号：

```
/**
 * @return 1 - winter, 2 - spring, 3 - summer, 4 - autumn
 */
private static int getDateSeason(LocalDate date) {
    return date.plus(1, MONTHS).get(IsoFields.QUARTER_OF_YEAR);
} 
```

通过[如何发现给定日期的季度？](https://stackoverflow.com/questions/302658/how-do-i-discover-the-quarter-of-a-given-date/36765477#comment81156879_36765477).

* * *

以下是如何计算给定日期的季节界限：

```
private static LocalDate atStartOfSeason(LocalDate date) {
    return date.plus(1, MONTHS).with(IsoFields.DAY_OF_QUARTER, 1).minus(1, MONTHS);
}

private static LocalDate afterEndOfSeason(LocalDate date) {
    return atStartOfSeason(date).plus(3, MONTHS);
} 
```

通过[如何在 java.util.Date 中获取当前季度的第一个日期和最后一个日期](https://stackoverflow.com/questions/36493649/how-to-get-the-first-date-and-last-date-of-current-quarter-in-java-util-date?rq=1#comment95686234_50702885)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-05T07:49:24.197

```
import java.util.Scanner;

public class Season {

public static void main (String[] args) {

    Scanner sc = new Scanner(System.in);

    System.out.println("Enter the month:");

        int mon=sc.nextInt();

        if(mon>12||mon<1)
        {
            System.out.println("Invalid month");
        }

        else if(mon>=3&&mon<=5)
        {
            System.out.println("Season:Spring");
        }

        else if(mon>=6&&mon<=8)
        {
            System.out.println("Season:Summer");
        }

        else if(mon>=9&&mon<=11)
        {
            System.out.println("Season:Autumn");
        }

        else if(mon==12||mon==1||mon==2)
        {
            System.out.println("Season:Winter");
        }
}
} 
```

# php - 从 WCF 调用时是否必须以某种方式配置 NuSoap？

> ID：189471
> 
> 赞同：0
> 
> 时间：2008-10-09T22:38:36.850
> 
> 标签：php, wcf

我正在尝试使用 WCF 调用 php webservice。我搜索了一些公共 php 服务，看看我是否可以复制我收到的错误，并创建了 2 个不同的单元测试来演示。

失败的测试我收到以下错误： System.ServiceModel.ProtocolException: The content type text/xml; 响应消息的 charset=ISO-8859-1 与绑定的内容类型不匹配 (text/xml; charset=utf-8)。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 601 个字节是：'

以下是单元测试：

```
[TestMethod]
public void WCF_Call_To_SiteInspect() {
    //This service doesn't work. It gets the same communication error as our own servers
    var soapClien = new SiteInspect.SiteInspectPortClient();

    var response = soapClien.doSiteInspect("Any", "Any", "www.google.com");
    Assert.IsTrue(response.serverTime.Length > 0);
}

[TestMethod]
public void WCF_Call_To_FinnService() {
    //This service works.... in looking at the wsdl it appears that it references a separate wsdl file. Is this the reason?
    var soapClient = new NuSoapFinnService.finnwordsPortTypeClient();

    var finnLyric = soapClient.getRandomNeilFinnLyric("text");
    Assert.IsTrue(finnLyric.Length > 0);
} 
```

底部的测试用例（Finn 服务）通过以下 URL：[http ://www.nickhodge.com/nhodge/finnwords/finnwords.wsdl](http://www.nickhodge.com/nhodge/finnwords/finnwords.wsdl)

给定以下 URL，第一个测试用例失败：http: [//www.flash-db.com/services/ws/siteInspect.wsdl](http://www.flash-db.com/services/ws/siteInspect.wsdl)

我在 wsdl 中看到的唯一区别是 Finn 服务引用了一个无关文件。xmlns:tns="http://www.nickhodge.com/nhodge/finnwords/finnwords.wsdl 。WCF 的这个错误是否需要特定格式的 wsdl？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T22:49:38.590

确保在 PHP 代码中使用*soap_defencoding设置 UTF-8 编码。*

如果您想了解更多相关信息，请参阅[此博客文章。](http://www.jaylee.org/post/2007/01/Playing-with-WCF-and-NuSOAP-072.aspx)

# c# - FormField DropDownList 高度

> ID：189475
> 
> 赞同：0
> 
> 时间：2008-10-09T22:39:42.340
> 
> 标签：c#, html, html-select

我想知道如何`<select>`在代码中为 HTML 设置 height 属性。

我尝试设置`.Attribute.Add("Style","Height:120px")`只是为了看看我是否可以改变它，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T22:56:19.683

更好的是，给它一个 CssClass。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T22:55:04.103

样式已经是一个属性...

```
DropDownList myDropDown;
myDropDown.Style["height"] = "120px"; 
```

# offline - 离线 Web 应用程序：成功案例、技巧和资源

> ID：189478
> 
> 赞同：13
> 
> 时间：2008-10-09T22:40:41.103
> 
> 标签：offline

我们@ [medicware.com.br](http://www.medicware.com.br)正在考虑使用[Gears使我们的](http://gears.google.com/)**Web 应用程序具有离线功能**。我们的主要目标是在互联网**连接中断时****保持基本功能的运行**。

 ****所以，我想听听关于您在该领域（与[Gears](http://gears.google.com/)相关与否）的真实经历的**成功案例**、**技巧**和**资源。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T05:29:11.453

Do you have to use Gears? I've used their AdWords API extensively, as well as Google Data, and the experiences left me lacking. Sure, things are reasonably well documented, but when it comes to support, there's no one you can call and real Google developer postings in forums are rare. They also are known for announcing cataclysmic changes with little notices, and, this is on **paid** products like AdWords.

I'd seriously look at Adobe Air. Adobe has worked with 3rd parties for years and they're pouring tons of money into doing Air right.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T17:38:42.170

[请记住，Milk](http://www.rememberthemilk.com)在使用 Gears 方面做得很好——您可能会看到有关其实现的信息。我将从[http://code.google.com/apis/gears/articles/take_app_offline.html](http://code.google.com/apis/gears/articles/take_app_offline.html)开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T19:24:36.713

我对 Adob​​e Air 有很好的体验。它不是齿轮，只是看看它是如何工作的，但它是如此简单，以至于我认为移植任何大型应用程序都很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-14T10:03:18.783

有几个视频资源可用：

Dion Almaers 50 分钟的演示从概述/商业案例到实际代码：对于理解概念和获取实际实现代码的示例非常有帮助。 [使用 Google Gears 的离线网络应用程序](http://codinginparadise.org/projects/dojo_offline/screencast_02_26_2007/screencast_02_26_2007.html)

我最近看到了[“Google I/O 2008 - 使大型应用程序脱机”](http://www.youtube.com/watch?v=cePFlJ8sGj4)。有利于掌握这个概念，但也非常复杂——谷歌的问题很可能不是典型的缩放问题。而且没有具体的代码。只有一些架构策略。

此外，如果您需要代码示例，也可以尝试“离线道场”。尽管它是 Dojos 离线包装器的截屏，但我认为它非常有用（并且只有 8 分钟短） [Dojo 离线截屏，（](http://codinginparadise.org/projects/dojo_offline/screencast_02_26_2007/screencast_02_26_2007.html) [dojo 离线主页](http://www.dojotoolkit.org/offline)上的概述）

为了回答您的问题，我偶然发现了[Google I/O 2009 - HTML5 Databases/Gears & Offline Web Apps](http://www.youtube.com/watch?v=aQ9w--W4J6U)，我将在午餐时看到它。对此有反馈，有人吗？

# asp.net - 将在 VS2008 上编写的代码部署到运行 .NET Framework 2.0 的服务器时遇到问题

> ID：189479
> 
> 赞同：0
> 
> 时间：2008-10-09T22:41:06.113
> 
> 标签：asp.net, visual-studio-2008, .net-3.5, deployment, .net-2.0

当我创建我尝试部署的项目时，我选择了我想要以 .NET Framework 2.0 为目标的项目。部署项目后，我尝试浏览它并获取并显示错误页面：

```
<compilation debug="true">
    <assemblies>
        <add assembly="System.Web.Entity, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    </assemblies>
</compilation> 
```

VS2008 的卖点之一是您可以开发和部署到运行.NET2.0 的服务器上我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T22:54:30.907

右键单击您的项目并选择“属性”。从那里，选择“编译”选项卡，然后单击左下方的“高级编译选项”按钮。最后一个下拉列表项应该是“目标框架”，您可以从那里选择 2.0。如上所述，前提是您没有使用任何 3.5 相关技术，例如 LINQ。

保存、重新编译和部署。设置好所有内容后，您可以返回并选择 3.5 选项以再次针对 3.5 框架。

希望这可以帮助！

哦，还有一件事要注意。如果您在 3.5 应用程序中使用 AJAX Toolkit 控件（日历扩展器、自动完成扩展器等），则需要确保从 codeplex 站点下载 1.0 Toolkit，因为 3.5 Toolkit 与2.0 框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T22:45:17.600

从您的项目中删除这些引用并重新部署。如果您的项目从 3.5 开始，它仍然会引用其中一些程序集

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T22:46:44.807

如果您使用的是 3.5 框架中的功能，那么您必须部署到 3.5 机器。

对于这个问题，您可能需要的大多数信息都在此处的问题和答案中： [问题-执行-编译-35-code-on-a-server-which-only-has-the-20-framework](https://stackoverflow.com/questions/167569/problems-executing-compiled-35-code-on-a-server-which-only-has-the-20-framework)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T22:48:13.493

您正在引用 .NET Framework 3.5 的程序集，您使用的是 EntityDataSources 吗？

删除那些 3.5 引用...

您还需要服务器上用于 .NET 2.0 的 AJAX 扩展 (System.Web.Extensions)。

# windows - 在哪里可以找到在 Windows 上运行的 Emacs 的 .emacs 文件？

> ID：189490
> 
> 赞同：123
> 
> 时间：2008-10-09T22:46:39.347
> 
> 标签：windows, emacs, winapi, path, customization

我尝试为 Emacs 的 Windows 安装寻找 .emacs 文件，但我找不到它。它在 Windows 下是否与 Unix 下具有相同的文件名？

我必须自己创建吗？如果是这样，它在哪个特定目录下？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2008-10-09T22:53:45.510

从 Emacs 常见问题解答中复制并粘贴，[http](http://www.gnu.org/software/emacs/windows/) ://www.gnu.org/software/emacs/windows/ ：

### [我在哪里把我的初始化文件？](http://www.gnu.org/software/emacs/manual/html_node/efaq-w32/Location-of-init-file.html#Location-of-init-file)

在 Windows 上，为了向后兼容文件名不能以点开头的 DOS 和 FAT 文件系统，`.emacs`可能会调用该文件。`_emacs`一些用户更喜欢继续使用这样的名称，因为 Windows 资源管理器无法创建名称以点开头的文件，即使文件系统和大多数其他程序可以处理它。在 Emacs 22 及更高版本中，也可以调用 init 文件`.emacs.d/init.el`。许多由 Lisp 包创建的其他文件现在也存储在该`.emacs.d`目录中，因此这将所有与 Emacs 相关的文件保存在一个地方。

上面提到的所有文件都应该放在你的 HOME 目录中。HOME 目录通过以下步骤确定：

1.  如果设置了环境变量 HOME，则使用它指示的目录。
2.  如果设置了注册表项 HKCU\SOFTWARE\GNU\Emacs\HOME，请使用它指示的目录。
3.  如果设置了注册表项 HKLM\SOFTWARE\GNU\Emacs\HOME，请使用它指示的目录。不推荐，因为它会导致用户共享同一个 HOME 目录。
4.  如果`C:\.emacs`存在，则使用`C:/`. 这是为了向后兼容，因为以前的版本默认为`C:/`如果未设置 HOME。
5.  使用用户的 AppData 目录，通常是用户配置文件目录下名为 Application Data 的目录，该目录的位置根据 Windows 版本和计算机是否属于域而有所不同。

在 Emacs 中，`~`文件名的开头扩展为您的 HOME 目录，因此您始终可以找到带有 .emacs 的 .emacs 文件`C-x C-f ~/.emacs`。

[在HOME 和 MS-Windows 上的启动目录中](http://www.gnu.org/software/emacs/manual/html_node/emacs/Windows-HOME.html#Windows-HOME)有更多信息。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2008-10-10T16:16:33.410

它应该存储在变量 user-init-file 中。用来`C-H v user-init-file RET`检查。您也可以使用直接打开它`M-x eval-expression RET (find-file user-init-file) RET`

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-10-09T23:38:38.337

在 Emacs for Windows 中像这样打开文件：

```
C-x C-f ~/.emacs 
```

[Emacs Wiki](http://www.emacswiki.org/cgi-bin/wiki/MsWindowsDotEmacs)中的更多信息

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-10-09T22:57:37.327

在我的 Vista 盒子里`C:\Users\<USER>\AppData\Roaming\`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-11-22T04:09:05.670

`Ctrl-x Ctrl-f ~/.emacs`请注意，仅键入和创建文件可能还不够。

可能是您的 Emacs 应用程序使用不同的位置来存储您的 init 文件，如果是这样，那么创建文件 ~/.emacs 只会创建一个您的 Emacs 应用程序*忽略的无用文件。*

此外，您可能想要做的不仅仅是*访问*.emacs 初始化文件，而是您可能想知道它在哪里，即它的路径名。

要做到这一点，有两种方法：

简单的方法：类型`Ctrl`+`H` `V`用户初始化文件`Return`

稍微棘手的方法：您可以通过以下方式找出系统存储自己的 .emacs 文件的位置：

1.  单击选项并向下滚动到“设置默认字体...”
2.  更改字体设置并单击确定
3.  在选项菜单上，转到“保存选项”
4.  保存选项后，系统会保存其 .emacs 文件，您可以在 Emacs 屏幕底部的 minibuffer 中*读取文件路径*

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-01-02T11:28:06.967

在 Windows 22 以上的 Emacs 版本上，它似乎已移至

```
~/.emacs.d/init.el 
```

，`~`是您的环境变量 HOME 的值（请参阅控制面板 →*系统*→*高级*→*环境变量*）。

文件本身可能不存在。在这种情况下，只需创建它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-07-17T06:40:56.970

在 Windows 7 中，将您的`init.el`文件放入 中 `C:\Users\user-name\AppData\Roaming\.emacs.d\`，其中**user-name**是您的用户/登录文件夹。

`init.el`注意不要将您的文件命名为`init.el.txt`. 如果您使用记事本等编辑器创建文件，Windows 就会这样做。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-11-02T21:44:23.490

您必须创建一个 emacs 初始化文件。一个不是自动创建的。我有一个类似的问题，这个答案追踪了我所做的事情。

我的问题是我的`~/.emacs.el`文件没有加载。奇怪，因为这一直对我有用。

这个问题/答案对我有帮助，但我不得不将我的 init 文件放入其中，`%USERPROFILE%\AppData\Roaming\.emacs.d\init.el`因为这显然是 Windows 上的默认行为。

为了解决这个问题，我在 emacs **scratch**缓冲区中运行了以下命令。

```
user-emacs-directory
"~/.emacs.d/" 
```

当我看到is`user-emacs-directory`时`~/.emacs.d`，我只是将我的 .emacs.el 文件移动到`%USERPROFILE%\.emacs.d\init.el`. 但这仍然不起作用。我继续`expand-file-name`如下所示：

```
(expand-file-name user-emacs-directory)
"c:/Users/pats/AppData/Roaming/.emacs.d/" 
```

必须爱上 Windows 的工作方式。（不）所以我把我的`emacs.el`文件移到了`%USERPROFILE%\AppData\Roaming\.emacs.d\init.el`，这有效。现在正在读取该文件。但我得到了其他错误，因为我的初始化文件加载了其他（个人 emacs）文件（在`~/myenv/emacs/*.el`.

```
Warning (initialization): An error occurred while loading ‘c:/Users/pats/AppData/Roaming/.emacs.d/init.el’: 
```

嗯...似乎我所有的文件`~/myenv/emacs/*.el`都需要移动才能使其正常工作，但我不想这样做。然后我意识到，因为没有设置 HOME 环境变量，*emacs 正在执行它的默认行为*。

**解决方案**

一旦我将我的 windows`HOME`环境变量设置为`%USERPROFILE%`一切都开始像过去 25 年一样工作。:-)

要设置 HOME 环境变量，我键入 WindowsKey+“为您的帐户编辑环境变量”打开*环境变量*对话框，然后输入`HOME=%USERPROFILE%`.

**现在我的 emacs 初始化文件 .emacs.el 回到了它应有的位置`$HOME/.emacs.el`，而不是在`%USERPROFILE%\AppData\Roaming\.emacs.d\init.el`**

公平地说，如果 Windows 只有一个地方来放置用户安装的软件包的文件，那么制作 HOME= 的解决方案`%USERPROFILE\AppData\Roaming`可能是可以接受的，但是因为一些应用程序使用`%USERPROFILE%`，一些使用`%USERPROFILE\AppData\Roaming`和其他使用`%USERPROFILE\AppData\Local`它只会让您很难知道在哪里可以找到您的配置文件。

我更喜欢将所有内容都放在我的 %USERPROFILE% 或 $HOME 目录中。

另一个类似的问题在这里：

*   [Emacs init.el 文件不加载](https://stackoverflow.com/questions/12224575/emacs-init-el-file-doesnt-load)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-07T17:00:18.617

在 Emacs 23 和 Windows 7 上，它仅在您设置时才有效：

```
HKCU\SOFTWARE\GNU\Emacs\HOME 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-06-16T03:28:47.747

正如 kanja 回答的那样，该文件的路径存储在`user-init-file`变量中（或者如果不存在 init 文件，则该变量包含创建位置的默认值）。

因此，*无论*您使用哪个可能的 init 文件名，以及它位于哪个目录，您都应该能够通过以下方式访问您的 init 文件：

`M-:` `(find-file user-init-file)` `RET`

或者在回声区域显示其完整路径：

`M-:` `(expand-file-name user-init-file)` `RET`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-09T23:04:56.080

在 Windows XP 上是：

```
C:\Documents and Settings\yourusernamehere\Application Data\ 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-27T00:31:55.420

我发现 Emacs 22 偶尔会在我的 XP 机器上打开“C:\Documents and Settings\username\Application Data\.emacs”，或者只打开“C:\Documents and Settings\username\.emacs”。我还没有找到解释为什么它偶尔会改变主意。

~ 将始终指向当前 emacs 实例认为是 HOME 的任何内容，但 kanja 的提示（Ch v user-init-file）将始终告诉您 ~/.emacs 实际映射到什么。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-07-03T15:00:04.357

在 Windows 8.1 上，如果 Emacs 从*Windows Explorer*、快捷方式或从*cmd*控制台启动，它使用*C:\Users\<USER>\AppData\Roaming.emacs*初始化文件。当我从 PowerShell 启动 Emacs 时，Emacs 在*C:\Users\<USER>*文件夹中查找它的 init 文件。解决此问题的方法是将**HOME**用户环境变量（控制面板\系统和安全\系统->高级系统设置->高级->环境变量）设置为*C:\Users\<USER>*。在此更改之后，无论我如何启动 Emacs，它都使用相同的 init 文件（请参阅此[问题](https://stackoverflow.com/questions/10112663/home-directory-and-emacs-file-in-windows-7)的已接受答案）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-09-20T12:26:41.463

在[Emacs 27.1](https://lists.gnu.org/archive/html/emacs-devel/2020-08/msg00237.html)之后，emacs[开始尊重](http://ergoemacs.org/emacs/emacs27_features.html). `$XDG_CONFIG_HOME`init 文件或 init 目录现在可以在`$XDG_CONFIG_HOME/emacs/init.el`.

在 Windows`$XDG_CONFIG_HOME`中可以[转换](https://stackoverflow.com/questions/43853548/xdg-basedir-directories-for-windows)为`%LOCALAPPDATA%`.

在任何情况下，您都可以使用以下 emacs 变量来找出初始化文件的位置`M-x eval-expression`

```
user-init-file 
```

或 emacs 配置目录

```
user-emacs-directory 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-30T16:21:30.520

有一个基于您的 Windows 版本和额外信息的目录列表： [http ://www.gnu.org/software/emacs/manual/html_node/emacs/Windows-HOME.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Windows-HOME.html)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-03-27T06:55:14.363

# c# - 错误消息：“访问路径 c:\windows\microsoft.net\framework\(version)\Temporary ASP.NET Files\(blah) 被拒绝。” - 是什么原因造成的？

> ID：189493
> 
> 赞同：4
> 
> 时间：2008-10-09T22:47:48.237
> 
> 标签：c#, .net, asp.net, visual-studio-2003

每隔一段时间，当我调试时，我会在 ASP.NET 错误页面上以漂亮的棕色文本收到此消息：

> *拒绝访问路径“c:\windows\microsoft.net\framework\(version)\Temporary ASP.NET Files\(blah)”。*

我一直无法弄清楚是什么原因造成的，是什么真正解决了它，以及它为什么会发生。

“临时 ASP.NET 文件”部分（“（blah）”）之后的路径通常不存在，所以我不确定它为什么会出现在那里。

有时 IISRESET 会修复它，有时则不会。

有时 aspnet_regiis 会修复它，有时则不会。

有时重启会修复它，有时它不会。

值得一提的是，我今天用一些 .NET 1.1 代码遇到了这个问题（是的，仍在维护一些 - 希望尽快升级它），我不确定我是否见过 .NET 2.0 及更高版本的代码。

有谁知道是什么原因造成的，应该怎么解决？我认为它有多种可能的原因，但我只是好奇是否有人可以对此有所了解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T22:49:00.650

据我了解，这可能是由机器上运行的防病毒软件和间歇性锁定文件引起的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T21:48:56.517

如果为临时目录打开了 Windows 索引服务，则可能会发生这种情况。有关详细信息，请参阅[本文](http://blogs.msdn.com/junfeng/archive/2004/10/09/240355.aspx)。运行文件监视器（可在[sysinternals.com](http://www.sysinternals.com)获得）并在临时目录上放置一个过滤器。当您收到访问错误时，请查看导致问题的应用程序。很可能是病毒扫描 - 从扫描中排除此目录，看看问题是否已解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T22:00:47.797

默认情况下，ASP.NET 应用程序在 ASPNET 帐户 (IIS 5) 或 NETWORK_SERVICE 帐户 (IIS 6/7) 下运行。如果您为该站点启用了匿名，他们还会使用 IUSR_MACHINENAME 帐户。授予这些帐户对您遇到访问问题的临时目录的完全权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T02:02:01.837

当 IIS 用户没有访问 \Temporary ASP.NET Files 目录的权限时，也会发生这种情况

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T21:41:23.187

将用户“everyone”添加到 Temporary ASP.NET Files 文件夹的权限

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-31T18:02:11.790

我通过`IIS_IUSRS`在`C:\Windows\Temp`运行进程监视器和过滤`Result is ACCESS DENIED`.

`csc.exe`试图在其中创建一个文件，`C:\Windows\Temp`但没有这样做的权限。

# .net - "Directory.Delete("path", false)" 有什么作用？

> ID：189499
> 
> 赞同：2
> 
> 时间：2008-10-09T22:49:48.887
> 
> 标签：.net

根据“Directory.Delete( "path", true )" 的文档，它会删除路径中的目录、子目录和文件。

Directory.Delete("path", false) 有什么作用？根据文档，它确实“否则”。

我的意思是如何在不删除目录、子目录和文件的情况下删除目录？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T22:53:49.580

比尔詹姆斯是对的。根据[MSDN](http://msdn.microsoft.com/en-us/library/fxeahc5f.aspx)，如果*递归*参数为 false 且目录不为空，则会抛出 IOException。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T22:50:55.110

只是一个快速的猜测，因为我不做.Net，但我会说它只会删除空目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T22:53:28.223

第二个参数告诉您是否想要递归删除。如果为 false，则如果目录不为空，该方法将抛出 IOException。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T23:00:10.020

假设代码的目的是仅在目录为空时删除目录。将第二个参数设置为`false`强制执行该策略/意图。

# php - 自动生成 PHP 文档？

> ID：189516
> 
> 赞同：42
> 
> 时间：2008-10-09T22:55:42.540
> 
> 标签：php, documentation, documentation-generation

对于 ActionScript 2，我使用[了 NaturalDocs](http://www.naturaldocs.org/)。但是它对 PHP 的支持很差。到目前为止，我已经看过[doxygen](http://www.doxygen.nl/)和[phpDocumentor](http://www.phpdoc.org/)，但在我看来它们的输出非常丑陋。有人对 PHP 的自动文档生成有任何经验吗？我更喜欢能够使用 javadoc 风格的标签，它们写起来很短，而且很容易记住。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-12-31T19:35:53.893

## ApiGen

[http://apigen.org/](http://apigen.org/)

ApiGen 支持 PHP 5.3 命名空间、包、文档之间的链接、对 PHP 标准类和通用文档的交叉引用、突出显示的源代码的创建以及对 PHP 5.4 特征的实验性支持。

## DocBlox

[http://www.docblox-project.org/](http://www.docblox-project.org/)

PHP 5.3 兼容 API 文档生成器，针对各种规模和持续集成的项目。

能够完全解析和转换 Zend Framework 2

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-12-18T05:38:41.153

有两个众所周知且常用的工具可以从 docblocks 生成 API 文档：

*   [phpDocumentor](http://www.phpdoc.org/)，它是特定于 PHP 的，可能是 PHP 项目中最常用的工具之一
*   和[Doxygen](http://www.doxygen.nl/)，它更多地用于 C，但被某些人用于 PHP。

关于“指南”：我会说这取决于您的项目，但是，至少，我希望看到：

*   描述方法/函数的作用
*   参数，与`@param type name description of the parameter`
*   返回值，与`@return type description of the return value`
*   例外，与`@throws type description of the exception that can be thrown`

一个很棒的事情是最近的 IDE *（例如[Eclipse PDT](http://eclipse.org/pdt/)）*可以读取和解释这些标记，以便在您编码时提供提示；-)

此外，越来越多的 PHP 工具将 php docblocks 用于文档以外的其他目的。

例如，PHPUnit 允许您使用一些特定的标签来指定一些与测试相关的东西——请参阅[Annotations](http://www.phpunit.de/manual/3.4/en/appendixes.annotations.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-12-18T05:39:39.467

在 Javadoc 样式的内联注释方面，PHPDoc 可能与您将获得的一样好。您可能还想查看[PHPXRef](http://phpxref.sourceforge.net/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-12-18T05:56:51.213

是的，phpDocumentor ( [http://www.phpdoc.org/](http://www.phpdoc.org/) ) 是 PHP 自动文档可接受的标准工具。这是事实上的标准。

在编写 PHP 代码文档时，遵循通用的 JavaDoc 代码指南是可以接受的。但是，您会遇到这样的情况，因为 PHP 和 Java 是不同的语言。

例如，PHP 函数没有返回类型，并且函数不可避免地（有时是可取的）返回具有一个上下文的一种类型，以及具有第二个上下文的另一种类型。JavaDoc 指南不会对此有所帮助，因为在 Java 中是不可能做到的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-12-30T23:22:29.620

查看 PHPDoctor [http://peej.github.com/phpdoctor/](http://peej.github.com/phpdoctor/)，这是一个简单但功能齐全的 PHP 的 Javadoc 克隆。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-09T23:11:03.460

phpDocumentor 可以以类似于 php.net 文档的样式输出（并且它内置了 smarty 和非 smarty 布局）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-12-18T05:41:38.243

Wordpress 代码库是使用 phpdoc 标记记录的（请参阅[this](http://codex.wordpress.org/Inline_Documentation)），它通常非常好 - 它[在这里](http://phpdoc.wordpress.org/trunk/)使用[phpDocumentor](http://www.phpdoc.org/)呈现。

我编写的大部分代码都足够重要，以至于我需要考虑自动生成文档是在 .Net 中完成的，所以我不能给出太多文档作者的观点

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T23:01:15.027

如果丑陋是一个问题，我只需将样式表切换为自定义样式表。如果您不想覆盖生成的，可以使用 Firefox 插件，例如[Stylish](https://addons.mozilla.org/en-US/firefox/addon/2108)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T23:23:23.220

您可以编辑模板文件以添加您自己的样式表来覆盖现有的样式表。

# c++ - C++ std::string 构造函数

> ID：189522
> 
> 赞同：3
> 
> 时间：2008-10-09T22:58:08.260
> 
> 标签：c++, hp-ux, stdstring

对此的任何想法将不胜感激：

```
std::string s1 = "hello";
std::string s2 = std::string(s1); 
```

我现在希望这两个字符串是独立的，即我可以将“, world”附加到 s2 并且 s1 仍然会读取“hello”。这是我在 windows 和 linux 上找到的，但在 HP_UX 机器上运行代码似乎 s2 和 s1 是同一个字符串，所以修改 s2 会更改 s1。

这听起来绝对疯狂吗，有人见过类似的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T15:02:34.573

虽然我无法重现 OP 的确切错误，但我在 HP-UX aCC 编译器中遇到了类似的错误。我把它贴在了[惠普的板上](http://forums12.itrc.hp.com/service/forums/questionanswer.do?admit=109447627+1223649583692+28353475&threadId=1108413)，最终得到了惠普的回应。基本上，他们的 aCC 版本 3.xx（3.70、3.73、3.67 等）搞砸了 std::string 的构造。我们不得不迁移到编译器的 6.xx 版本。我们当时遇到的问题是，没有可用于 PA-RISC 机器的 6.xx 编译器，只有 Itanium。我相信 2007 年 9 月发布了用于 PA-RISC 的 6.xx 编译器。

给出问题的代码是：

```
#include <iostream>
#include <string>

class S : public std::string  // An extension of std::string
{
public:
  explicit S(const char* s)
    : std::string(s)
  {
  }
};

class N     // Wraps an int
{
public:
  explicit N(int n)
    : _n(n)
  {}
  operator S() const   // Converts to a string extension
  {
    return _n == 0 ? S("zero") : (_n == 1 ? S("one") : S("other"));
  }
private:
  int _n;
};

int main(int, char**)
{
  N n0 = N(0);
  N n1 = N(1);

  std::string zero = n0;
  std::cout << "zero = " << zero << std::endl;
  std::string one = n1;
  std::cout << "zero = " << zero
            << ", one = " << one << std::endl;

  return 0;
} 
```

这是打印：
零 = 零零
***= 一***，一 = 一

换句话说，从 n1 构造字符串 1 完全破坏了另一个字符串（字符串 0）。

注意：
要查看编译器的版本，请键入“aCC -V”
要查看机器类型，请键入“uname -m”（9000/800 ==> PA-RISC，ia64 ==> Itanium）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T23:04:38.980

这一定是个bug。std::string 可以将引用计数字符串作为其实现，但是一旦它被更改，它应该“分叉”字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T23:04:51.087

这对我来说听起来确实是个错误。可以访问 HP/UX 的其他任何人都可以复制吗？

你是说这个程序在两行显示相同的文本？

```
#include <stdio.h>
#include <string>

int main () 
{
    std::string s1 = "hello"; 
    std::string s2 = std::string(s1);   // note: std::string s2( s1); would reduce the number of copy ctor calls

    s2.append( ", world");

    printf( "%s\n", s1.c_str());
    printf( "%s\n", s2.c_str());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T23:16:22.547

这两个字符串的实际变化是否不同，或者您是否使用了其他比较（例如 c_str() 返回的地址）？

字符串的某些实现在进行复制时不会复制整个字符串，以加快复制长字符串的速度。如果您尝试对其中任何一个进行更改，则实现应该复制字符串并进行适当的更改（理想情况下作为同一操作的一部分）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T23:29:12.333

这肯定是一个缺陷。此示例逐字地来自 C++ 标准：

```
string s1("abc");
string::iterator i = s1.begin();
string s2 = s1;
*i = ’a’;  // Must modify only s1 
```

# xml - 如何使用 shell 脚本提取 xml 属性？

> ID：189523
> 
> 赞同：2
> 
> 时间：2008-10-09T22:58:25.920
> 
> 标签：xml, bash, shell

我已经使用 grep 从源文档中提取了标签，但是现在我似乎无法弄清楚如何轻松地从字符串中提取属性。此外，我想避免使用标准安装中通常不存在的任何程序。

```
$tag='<img src="http://imgs.xkcd.com/comics/barrel_cropped_(1).jpg" title="Don't we all." alt="Barrel - Part 1" />' 
```

我需要以以下变量结束

```
$src="http://imgs.xkcd.com/comics/barrel_cropped_(1).jpg"
$title="Don't we all."
$alt="Barrel - Part 1" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T02:16:00.873

您可以使用[xmlstarlet](http://xmlstar.sourceforge.net/)。然后，您甚至不必自己提取元素：

```
$ echo $tag|xmlstarlet sel -t --value-of '//img/@src'
http://imgs.xkcd.com/comics/barrel_cropped_(1).jpg 
```

你甚至可以把它变成一个函数

```
$ get_attribute() {
  echo $1 | xmlstarlet sel -t -o "&quot;" -v $2 -o "&quot;"
  }
$ src=get_attribute $tag '//img/@src' 
```

如果您不想多次重新解析文档，您也可以这样做：

```
$ get_values() {
   eval file=\${$#}
   eval $#=    
   cmd="xmlstarlet sel "
   for arg in $@
   do
      if [ -n $arg ]
      then
        var=${arg%%\=*}
        expr=${arg#*=}
        cmd+=" -t -o \"$var=&quot;\" -v $expr -o \"&quot;\" -n"
      fi
   done
   eval $cmd $file
  }
$ eval $(get_values src='//img/@src' title='//img/@title' your_file.xml)
$ echo $src
http://imgs.xkcd.com/comics/barrel_cropped_(1).jpg
$ echo $title
Don't we all. 
```

我确信有更好的方法来删除 shell 函数的最后一个参数，但我不知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T00:43:51.887

我接受了 dacracot 关于使用 sed 的建议，尽管如果他给我一些示例代码我会更喜欢

```
src=`echo $tag | sed 's/.*src=["]\(.*\)["] title=["]\(.*\)["] alt=["]\(.*\)["].*/\1/'`    
title=`echo $tag | sed 's/.*src=["]\(.*\)["] title=["]\(.*\)["] alt=["]\(.*\)["].*/\2/'`  
alt=`echo $tag | sed 's/.*src=["]\(.*\)["] title=["]\(.*\)["] alt=["]\(.*\)["].*/\3/'` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-04T09:48:32.380

如果 xmlstarlet 在标准安装中可用并且 src-title-alt 的顺序没有改变，您也可以使用以下代码：

```
tag='<img src="http://imgs.xkcd.com/comics/barrel_cropped_(1).jpg" title="Don'"'"'t we all." alt="Barrel - Part 1" />'
xmlstarlet sel -T -t -m "/img" -m "@*" -v '.' -n <<< "$tag"
IFS=$'\n'
array=( $(xmlstarlet sel -T -t -m "/img" -m "@*" -v '.' -n <<< "$tag") )
src="${array[0]}"
title="${array[1]}"
alt="${array[2]}"

printf "%s\n" "src: $src" "title: $title" "alt: $alt" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-08T11:00:06.113

由于这再次冒泡，现在我的[Xidel](http://videlibri.sourceforge.net/xidel.html)有 2 个功能使这项任务变得微不足道：

*   xml上的模式匹配

*   将所有匹配的变量导出到 shell

所以它变成了一行：

```
eval $(xidel "$tag" -e '<img src="{$src}" title="{$title}" alt="{$alt}"/>' --output-format bash) 
```

# .net - .NET TransactionScope 类和 T-SQL TRAN COMMIT 和 ROLLBACK

> ID：189534
> 
> 赞同：5
> 
> 时间：2008-10-09T23:02:42.620
> 
> 标签：.net, database, tsql, transactions

我目前正在编写一个应用程序，该应用程序需要对我的业务实体进行多次插入、更新和删除。我使用 TransactionScope 类来保证所有存储过程都可以作为单个工作单元提交或回滚。

我的问题是，如果我在 .NET 类库中使用 TransactionScope 类，我还需要使用 COMMIT TRAN 和 ROLLBACK TRAN 是我的每个存储过程吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T06:39:31.233

不，如果将 TransactionScope 用于您的事务，则不需要显式事务 - 但是：**重要**的是，您可能应该`Transaction Binding=Explicit Unbind;`在连接字符串中设置。完整的细节在[这里](http://weblogs.asp.net/ryangaraygay/archive/2008/04/14/issue-with-system-transactions-sqlconnection-and-timeout.aspx)，但否则你最终可能会回滚前几个操作，最后几个提交（或者更确切地说，在任何事务之外运行）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T23:25:22.857

在 2005 年没有必要，在 2000 年我会，另外，我通常将事务范围放在“使用”块中。

在 2000 和更早版本与 2005 上使用它时存在一些性能问题。

看[这里](http://blogs.msdn.com/jmeier/archive/2006/10/12/use-promotable-transactions-while-working-with-sql-server-2005.aspx)

谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-20T00:38:19.080

如果您参加了`TransactionScope`or`CommittableTransaction`那么我强烈建议您不要**使用**`begin transaction`or明确创建自己的本地事务`SqlConnection.BeginTransaction`。

`TransactionScope`/是一个不同的“家庭”，并且与/`CommittableTransaction`互斥`begin transaction``SqlTransaction`

因此，我不同意赛义夫汗。System.Transactions 在 Sql 2000 上确实存在性能问题，因此使用 SqlTransaction 或`begin transaction`代替可能会更好。但是，如果你这样做了，那么你不应该也使用 TransactionScope/CommittableTransaction。

顺便说一句，Marc Gravell 描述的行为在 .Net 4.0 中已经改变。即使您不使用 Explicit Unbind，也不再可能回滚一些命令并提交一些命令。（但是他是正确的，在旧版本中您应该使用 Explicit Unbind）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T23:20:37.250

您不需要 - 它应该在 TransactionScope 内处理。它确实有点取决于您正在做什么以及您如何处理事务（显式或隐式）更多在[这里](http://msdn.microsoft.com/en-us/library/ms229973.aspx)

# java - Java 中的 NFS 服务器

> ID：189537
> 
> 赞同：7
> 
> 时间：2008-10-09T23:04:38.140
> 
> 标签：java, filesystems

我搜索网络（或分布式）文件系统的实现，如 Java 中的 NFS。目标是扩展它并用它做一些研究。在网上我找到了一些实现，例如[DJ NFS](http://users.csc.calpoly.edu/~jbergami/projects/djnfs/)，但悬而未决的问题是它们有多成熟和快速。

任何人都可以有一个好的起点，有没有人经历过这样的事情？

PS 我知道 Hadoop DFS，我将它用于一些项目，但 Hadoop 不适合我想在这里做的事情。

--EDIT-- Hadoop 真正专注于高度可扩展、高吞吐量的计算，而不会覆盖文件的某些部分等等。目标是您可以将文件系统用于用户主目录。

--EDIT-- 更多细节：想法是修改这样的实现，使文件不直接存储在本地文件系统上，而是应用重复数据删除。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-04-23T11:30:28.993

看看[dcache.org](http://www.dcache.org)。他们用 Java 实现了 NFSv4.1 服务器。

*   [白皮书](https://www.dcache.org/manuals/dcache-whitepaper-light.pdf)
*   [github](https://github.com/dCache/nfs4j)
*   [手动的](https://www.dcache.org/manuals/book.shtml)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T11:02:42.947

您可能想看看[Alfresco JLAN](http://www.alfresco.com/products/aifs/)：

> Alfresco JLAN 使用虚拟文件系统接口，允许您插入自己的文件系统实现，核心服务器处理客户端和服务器之间的所有网络协议交换。除了支持 NFS 和 FTP，JLAN 也是 Window 的 CIFS（通用 Internet 文件系统）的唯一 Java 实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T02:16:22.700

我不能说我实际上玩过 HDFS 以外的任何东西，但这里有一些链接可能会对你有所帮助。

*   [http://www.hirednetwork.com/?p=61](http://www.hirednetwork.com/?p=61)
*   [http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?arnumber=1266109](http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?arnumber=1266109)
*   [http://wiki.apache.org/nutch/NutchDistributedFileSystem](http://wiki.apache.org/nutch/NutchDistributedFileSystem)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-03T19:40:45.023

结帐[YANFS](http://blogs.oracle.com/shepler/entry/yanfs_is_the_new_webnfs) 我没有使用它，但它可能值得一看。项目页面 [在java.net 上，您必须使用](https://yanfs.dev.java.net/)[CVS](https://yanfs.dev.java.net/source/browse/yanfs/)获取源代码

# jsp - Wicket 和 JSP

> ID：189546
> 
> 赞同：6
> 
> 时间：2008-10-09T23:11:16.083
> 
> 标签：jsp, wicket

使用`add(new Include())`语法，我能够包含顶层的 jsps。

但是不能引用“WEB-INF”中存在的那些，有什么办法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T17:52:05.870

I think the Include class makes an external request instead of including/forwarding current one, which makes your case impossible. WEB-INF is not available to external requests, only include/forward if I remember correctly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-18T06:56:25.777

您为什么要尝试将两者都包含在一个应用程序中？如果我是您，并且您实际上正在尝试从 JSP 迁移到 Wicket，我将创建一个新的 Wicket 应用程序，您可以将其安装在服务器上的单独上下文路径下，并让 Wicket 自行运行。然后，您还可以直接包含来自其他应用程序的 css 和 js 等资源，避免任何重复。

# c# - 在已编译的可执行文件中嵌入 DLL

> ID：189549
> 
> 赞同：694
> 
> 时间：2008-10-09T23:11:54.007
> 
> 标签：c#, .net, dll, merge, linker

是否可以将预先存在的 DLL 嵌入到已编译的 C# 可执行文件中（这样您只有一个要分发的文件）？如果有可能，人们将如何去做呢？

通常，我很乐意将 DLL 留在外面并让安装程序处理所有事情，但是有几个工作人员问过我这个问题，我真的不知道。

* * *

## 回答 #1

> 赞同：816
> 
> 时间：2013-11-30T21:53:21.077

我强烈推荐使用[Costura.Fody](https://github.com/Fody/Costura) - 迄今为止在您的程序集中嵌入资源的最佳和最简单的方法。它以 NuGet 包的形式提供。

```
Install-Package Costura.Fody 
```

将其添加到项目后，它会自动将复制到输出目录的所有引用嵌入到*主程序*集中。您可能希望通过向项目添加目标来清理嵌入文件：

```
Install-CleanReferencesTarget 
```

您还可以指定是否包括 pdb、排除某些程序集或动态提取程序集。据我所知，也支持非托管程序集。

**更新**

目前，有些人正在尝试添加[对 DNX 的支持](https://github.com/Fody/Fody/issues/206)。

**更新 2**

对于最新的 Fody 版本，您需要拥有 MSBuild 16（即 Visual Studio 2019）。Fody 版本 4.2.1 将执行 MSBuild 15。（参考：[Fody 仅支持 MSBuild 16 及更高版本。当前版本：15](https://stackoverflow.com/questions/55795625/fody-is-only-supported-on-msbuild-16-and-above-current-version-15)）

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2011-06-15T18:20:12.667

只需在 Visual Studio 中右键单击您的项目，选择 Project Properties -> Resources -> Add Resource -> Add Existing File... 并将以下代码包含到您的 App.xaml.cs 或等效项中。

```
public App()
{
    AppDomain.CurrentDomain.AssemblyResolve +=new ResolveEventHandler(CurrentDomain_AssemblyResolve);
}

System.Reflection.Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
{
    string dllName = args.Name.Contains(',') ? args.Name.Substring(0, args.Name.IndexOf(',')) : args.Name.Replace(".dll","");

    dllName = dllName.Replace(".", "_");

    if (dllName.EndsWith("_resources")) return null;

    System.Resources.ResourceManager rm = new System.Resources.ResourceManager(GetType().Namespace + ".Properties.Resources", System.Reflection.Assembly.GetExecutingAssembly());

    byte[] bytes = (byte[])rm.GetObject(dllName);

    return System.Reflection.Assembly.Load(bytes);
} 
```

这是我的原始博客文章： [http ://codeblog.larsholm.net/2011/06/embed-dlls-easily-in-a-net-assembly/](http://codeblog.larsholm.net/2011/06/embed-dlls-easily-in-a-net-assembly/)

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2008-10-09T23:17:15.273

如果它们实际上是托管程序集，则可以使用[ILMerge](https://github.com/dotnet/ILMerge)。对于本机 DLL，您需要做更多的工作。

**另请参阅：** [如何将 C++ windows dll 合并到 C# 应用程序 exe 中？](https://stackoverflow.com/questions/72264/how-can-a-c-windows-dll-be-merged-into-a-c-application-exe)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2010-10-28T14:06:14.660

是的，可以将 .NET 可执行文件与库合并。有多种工具可用于完成工作：

*   [ILMerge](http://www.microsoft.com/downloads/en/details.aspx?familyid=22914587-b4ad-4eae-87cf-b14ae6a939b0&displaylang=en)是一个实用程序，可用于将多个 .NET 程序集合并为一个程序集。
*   [Mono mkbundle](http://www.mono-project.com/Command-Line_Tools#Project_converstion_.26_deployment)将一个 exe 和所有带有 libmono 的程序集打包到一个二进制包中。
*   [IL-Repack](https://github.com/gluck/il-repack)是 ILMerge 的 FLOSS 替代品，具有一些附加功能。

此外，这可以与[Mono Linker](http://www.mono-project.com/Linker)结合使用，它确实删除了未使用的代码，因此使生成的程序集更小。

另一种可能性是使用[.NETZ](https://github.com/madebits/msnet-netz-compressor)，它不仅允许压缩程序集，还可以将 dll 直接打包到 exe 中。与上述解决方案的不同之处在于 .NETZ 不会合并它们，它们保持独立的程序集，但被打包到一个包中。

> .NETZ 是一个开源工具，它压缩和打包 Microsoft .NET Framework 可执行文件（EXE、DLL）以使它们更小。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2012-05-15T11:46:30.127

[如果程序集只有托管代码， ILMerge](http://www.microsoft.com/en-us/download/details.aspx?id=17630)可以将程序集组合成一个程序集。您可以使用命令行应用程序，或添加对 exe 的引用并以编程方式合并。对于 GUI 版本，有[Eazfuscator](http://www.foss.kharkov.ua/g1/projects/eazfuscator/dotnet/Default.aspx#downloads)和[.Netz](http://madebits.com/netz/) ，两者都是免费的。付费应用程序包括[BoxedApp](http://boxedapp.com/)和[SmartAssembly](http://www.red-gate.com/products/dotnet-development/smartassembly/)。

如果您必须将程序集与非托管代码合并，我建议您使用[SmartAssembly](http://www.red-gate.com/products/dotnet-development/smartassembly/)。我从来没有遇到过[SmartAssembly](http://www.red-gate.com/products/dotnet-development/smartassembly/)的问题，但其他所有问题。在这里，它可以将所需的依赖项作为资源嵌入到您的主 exe 中。

您可以手动完成所有这些操作，而无需担心程序集是托管还是混合模式，方法是将 dll 嵌入到您的资源中，然后依赖 AppDomain 的 Assembly `ResolveHandler`。这是采用最坏情况的一站式解决方案，即带有非托管代码的程序集。

```
static void Main()
{
    AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =>
    {
        string assemblyName = new AssemblyName(args.Name).Name;
        if (assemblyName.EndsWith(".resources"))
            return null;

        string dllName = assemblyName + ".dll";
        string dllFullPath = Path.Combine(GetMyApplicationSpecificPath(), dllName);

        using (Stream s = Assembly.GetEntryAssembly().GetManifestResourceStream(typeof(Program).Namespace + ".Resources." + dllName))
        {
            byte[] data = new byte[stream.Length];
            s.Read(data, 0, data.Length);

            //or just byte[] data = new BinaryReader(s).ReadBytes((int)s.Length);

            File.WriteAllBytes(dllFullPath, data);
        }

        return Assembly.LoadFrom(dllFullPath);
    };
} 
```

这里的关键是将字节写入文件并从其位置加载。为了避免先有鸡还是先有蛋的问题，您必须确保在访问程序集之前声明处理程序，并且不要在加载（程序集解析）部分中访问程序集成员（或实例化任何必须处理程序集的东西）。还要注意确保`GetMyApplicationSpecificPath()`不是任何临时目录，因为临时文件可能会被其他程序或您自己尝试删除（不是说它会在您的程序访问 dll 时被删除，但至少它很麻烦。AppData 很好地点）。另请注意，您每次都必须写入字节，您不能从位置加载，因为 dll 已经存在于那里。

对于托管 dll，您不需要写入字节，而是直接从 dll 的位置加载，或者只需读取字节并从内存加载程序集。像这样左右：

```
 using (Stream s = Assembly.GetEntryAssembly().GetManifestResourceStream(typeof(Program).Namespace + ".Resources." + dllName))
    {
        byte[] data = new byte[stream.Length];
        s.Read(data, 0, data.Length);
        return Assembly.Load(data);
    }

    //or just

    return Assembly.LoadFrom(dllFullPath); //if location is known. 
```

如果程序集完全不受管理，您可以查看此[链接](https://stackoverflow.com/questions/666799/embedding-unmanaged-dll-into-a-managed-c-sharp-dll)或[此](http://bsmadhu.wordpress.com/2012/03/19/embedding-c-libraryexe-inside-net-assembly/)链接以了解如何加载此类 dll。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2013-11-06T07:04:50.247

Jeffrey Richter的[摘录](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)非常好。简而言之，将库添加为嵌入式资源并在其他任何内容之前添加回调。这是我在控制台应用程序的 Main 方法开头放置的代码版本（在他的页面的评论中找到）（只需确保使用该库的任何调用与 Main 的方法不同）。

```
AppDomain.CurrentDomain.AssemblyResolve += (sender, bargs) =>
        {
            String dllName = new AssemblyName(bargs.Name).Name + ".dll";
            var assem = Assembly.GetExecutingAssembly();
            String resourceName = assem.GetManifestResourceNames().FirstOrDefault(rn => rn.EndsWith(dllName));
            if (resourceName == null) return null; // Not found, maybe another handler will find it
            using (var stream = assem.GetManifestResourceStream(resourceName))
            {
                Byte[] assemblyData = new Byte[stream.Length];
                stream.Read(assemblyData, 0, assemblyData.Length);
                return Assembly.Load(assemblyData);
            }
        }; 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2015-03-07T20:40:24.917

扩展上面[的@Bobby 的回答](https://stackoverflow.com/a/4043653/1480854)。您可以编辑 .csproj 以在构建时使用[IL-Repack](https://github.com/peters/ILRepack.MSBuild.Task)自动将所有文件打包到单个程序集中。

1.  安装 nuget ILRepack.MSBuild.Task 包`Install-Package ILRepack.MSBuild.Task`
2.  编辑 .csproj 的 AfterBuild 部分

这是一个简单的示例，它将 ExampleAssemblyToMerge.dll 合并到您的项目输出中。

```
<!-- ILRepack -->
<Target Name="AfterBuild" Condition="'$(Configuration)' == 'Release'">

   <ItemGroup>
    <InputAssemblies Include="$(OutputPath)\$(AssemblyName).exe" />
    <InputAssemblies Include="$(OutputPath)\ExampleAssemblyToMerge.dll" />
   </ItemGroup>

   <ILRepack 
    Parallel="true"
    Internalize="true"
    InputAssemblies="@(InputAssemblies)"
    TargetKind="Exe"
    OutputFile="$(OutputPath)\$(AssemblyName).exe"
   />
</Target> 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2019-09-01T19:57:26.020

## .NET Core 3.0 原生支持编译为单个 .exe

该功能通过在项目文件 (.csproj) 中使用以下属性来启用：

```
 <PropertyGroup>
        <PublishSingleFile>true</PublishSingleFile>
    </PropertyGroup> 
```

这是在没有任何外部工具的情况下完成的。

有关更多详细信息，请参阅我[对这个问题](https://stackoverflow.com/a/56092826/10614791)的回答。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-10-09T23:14:15.233

您可以将 DLL 作为嵌入式资源添加，然后让您的程序在启动时将它们解压缩到应用程序目录中（在检查它们是否已经存在之后）。

但是，设置文件很容易制作，我认为这不值得。

编辑：这种技术对于 .NET 程序集很容易。使用非 .NET DLL 会做更多的工作（您必须弄清楚在哪里解压文件并注册它们等等）。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-10-09T23:40:23.200

另一个可以优雅地处理这个问题的产品是 SmartAssembly，位于[SmartAssembly.com](http://www.smartassembly.com/)。除了将所有依赖项合并到一个 DLL 之外，该产品还将（可选地）混淆您的代码，删除额外的元数据以减小生成的文件大小，并且实际上还可以优化 IL 以提高运行时性能。

它还向您的软件（如果需要）添加了某种可能有用的全局异常处理/报告功能。我相信它还有一个命令行 API，因此您可以将其作为构建过程的一部分。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-10-09T10:55:37.083

ILMerge 方法和 Lars Holm Jensen 处理 AssemblyResolve 事件都不适用于插件主机。假设可执行程序*H*动态加载程序集*P*并通过在单独程序集中定义的接口*IP*访问它。要将*IP*嵌入到*H*中，需要对 Lars 的代码稍作修改：

```
Dictionary<string, Assembly> loaded = new Dictionary<string,Assembly>();
AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =>
{   Assembly resAssembly;
    string dllName = args.Name.Contains(",") ? args.Name.Substring(0, args.Name.IndexOf(',')) : args.Name.Replace(".dll","");
    dllName = dllName.Replace(".", "_");
    if ( !loaded.ContainsKey( dllName ) )
    {   if (dllName.EndsWith("_resources")) return null;
        System.Resources.ResourceManager rm = new System.Resources.ResourceManager(GetType().Namespace + ".Properties.Resources", System.Reflection.Assembly.GetExecutingAssembly());
        byte[] bytes = (byte[])rm.GetObject(dllName);
        resAssembly = System.Reflection.Assembly.Load(bytes);
        loaded.Add(dllName, resAssembly);
    }
    else
    {   resAssembly = loaded[dllName];  }
    return resAssembly;
}; 
```

处理重复尝试解析相同程序集并返回现有程序集而不是创建新实例的技巧。

**编辑：** 以免破坏 .NET 的序列化，确保为所有未嵌入您的程序集返回 null，从而默认为标准行为。您可以通过以下方式获取这些库的列表：

```
static HashSet<string> IncludedAssemblies = new HashSet<string>();
string[] resources = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceNames();
for(int i = 0; i < resources.Length; i++)
{   IncludedAssemblies.Add(resources[i]);  } 
```

如果传递的程序集不属于，则返回 null `IncludedAssemblies`。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2020-07-16T06:50:03.120

以下方法**不要使用外部工具**，并**自动包含所有需要的 DLL**（无需手动操作，一切都在编译时完成）

我在这里阅读了很多答案，说要使用*ILMerge*、*ILRepack*或*Jeffrey Ritcher*方法，但这些方法都不适用于*WPF 应用程序*，也不容易使用。

当您有很多 DLL 时，可能很难在 exe 中手动包含您需要的那个。Wegged[在 StackOverflow 上解释了我发现的最佳方法](https://stackoverflow.com/a/4995039/2576706)

为了清楚起见，复制粘贴了他的答案（所有功劳[归于 Wegged](https://stackoverflow.com/users/428702/wegged)）

* * *

## 1）将此添加到您的`.csproj`文件中：

```
<Target Name="AfterResolveReferences">
  <ItemGroup>
    <EmbeddedResource Include="@(ReferenceCopyLocalPaths)" Condition="'%(ReferenceCopyLocalPaths.Extension)' == '.dll'">
      <LogicalName>%(ReferenceCopyLocalPaths.DestinationSubDirectory)%(ReferenceCopyLocalPaths.Filename)%(ReferenceCopyLocalPaths.Extension)</LogicalName>
    </EmbeddedResource>
  </ItemGroup>
</Target> 
```

## 2）让你的主要`Program.cs`看起来像这样：

```
[STAThreadAttribute]
public static void Main()
{
    AppDomain.CurrentDomain.AssemblyResolve += OnResolveAssembly;
    App.Main();
} 
```

## 3）添加`OnResolveAssembly`方法：

```
private static Assembly OnResolveAssembly(object sender, ResolveEventArgs args)
{
    Assembly executingAssembly = Assembly.GetExecutingAssembly();
    AssemblyName assemblyName = new AssemblyName(args.Name);

    var path = assemblyName.Name + ".dll";
    if (assemblyName.CultureInfo.Equals(CultureInfo.InvariantCulture) == false) path = String.Format(@"{0}\{1}", assemblyName.CultureInfo, path);

    using (Stream stream = executingAssembly.GetManifestResourceStream(path))
    {
        if (stream == null) return null;

        var assemblyRawBytes = new byte[stream.Length];
        stream.Read(assemblyRawBytes, 0, assemblyRawBytes.Length);
        return Assembly.Load(assemblyRawBytes);
    }
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-01-20T09:03:26.697

这听起来可能很简单，但 WinRar 提供了将一堆文件压缩为自解压可执行文件的选项。
它有许多可配置的选项：最终图标、提取文件到给定路径、提取后要执行的文件、提取期间显示的自定义徽标/弹出窗口文本、根本没有弹出窗口、许可协议文本等。
在某些情况下可能很有用.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-04-28T13:58:30.293

我使用从 .vbs 脚本调用的 csc.exe 编译器。

在您的 xyz.cs 脚本中，在指令之后添加以下行（我的示例是 Renci SSH）：

```
using System;
using Renci;//FOR THE SSH
using System.Net;//FOR THE ADDRESS TRANSLATION
using System.Reflection;//FOR THE Assembly

//+ref>"C:\Program Files (x86)\Microsoft\ILMerge\Renci.SshNet.dll"
//+res>"C:\Program Files (x86)\Microsoft\ILMerge\Renci.SshNet.dll"
//+ico>"C:\Program Files (x86)\Microsoft CAPICOM 2.1.0.2 SDK\Samples\c_sharp\xmldsig\resources\Traffic.ico" 
```

ref、res 和 ico 标签将被下面的 .vbs 脚本拾取以形成 csc 命令。

然后在 Main 中添加程序集解析器调用程序：

```
public static void Main(string[] args)
{
    AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(CurrentDomain_AssemblyResolve);
    . 
```

...并将解析器本身添加到类中的某个位置：

```
    静态程序集 CurrentDomain_AssemblyResolve（对象发送者，ResolveEventArgs args）
    {
        String resourceName = new AssemblyName(args.Name).Name + ".dll";

        使用 (var stream = Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceName))
        {
            字节[] 组装数据 = 新字节[流.长度];
            流.Read(assemblyData, 0, assemblyData.Length);
            返回 Assembly.Load(assemblyData);
        }

    }

```

我命名 vbs 脚本以匹配 .cs 文件名（例如 ssh.vbs 查找 ssh.cs）；这使得多次运行脚本变得容易得多，但如果你不是像我这样的白痴，那么通用脚本可以从拖放中获取目标 .cs 文件：

```
    暗淡名称_,oShell,fso
    设置 oShell = CreateObject("Shell.Application")
    设置 fso = CreateObject("Scripting.fileSystemObject")

    '将 VBS 脚本名作为目标文件名
    '###############################################
    name_ = Split(wscript.ScriptName, ".")(0)

    '从 .CS 文件中获取外部 DLL 和图标名称
    '################################################ ######
    常量 OPEN_FILE_FOR_READING = 1
    设置 objInputFile = fso.OpenTextFile(name_ & ".cs", 1)

    '将所有内容读入数组
    '#############################
    inputData = Split(objInputFile.ReadAll, vbNewline)

    对于每个 strData 中的 inputData

        如果 left(strData,7)="//+ref>" 那么
            csc_references = csc_references & " /reference:" & trim(replace(strData,"//+ref>","")) & " "
        万一

        如果 left(strData,7)="//+res>" 那么
            csc_resources = csc_resources & " /resource:" & trim(replace(strData,"//+res>","")) & " "
        万一

        如果 left(strData,7)="//+ico>" 那么
            csc_icon = " /win32icon:" & trim(replace(strData,"//+ico>","")) & " "
        万一
    下一个

    objInputFile.Close

    '编译文件
    '################
    oShell.ShellExecute "c:\windows\microsoft.net\framework\v3.5\csc.exe", "/warn:1 /target:exe " & csc_references & csc_resources & csc_icon & " " & name_ & ".cs" , "", "runas", 2

    WScript.Quit(0)

```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-09T23:19:44.943

在 C# 中创建混合本机/托管程序集是可能的，但并非那么容易。如果您使用 C++，它会容易得多，因为 Visual C++ 编译器可以像其他任何东西一样轻松地创建混合程序集。

除非您对生成混合程序集有严格的要求，否则我同意 MusiGenesis 的观点，即这不值得用 C# 来做这件事。如果您需要这样做，或许可以考虑改用 C++/CLI。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-10-28T14:00:53.190

通常，您需要某种形式的后期构建工具来执行您所描述的程序集合并。有一个名为 Eazfuscator (eazfuscator.blogspot.com/) 的免费工具，它专为字节码处理而设计，也可以处理程序集合并。您可以使用 Visual Studio 将其添加到构建后的命令行中以合并您的程序集，但是由于在任何非平凡的程序集合并方案中会出现问题，您的工作量会有所不同。

您还可以检查 build make untility NANT 是否能够在构建后合并程序集，但我自己对 NANT 还不够熟悉，无法说出该功能是否内置。

还有许多 Visual Studio 插件将执行程序集合并作为构建应用程序的一部分。

或者，如果您不需要自动完成此操作，有许多工具（如 ILMerge）会将 .net 程序集合并到单个文件中。

我在合并程序集时遇到的最大问题是它们是否使用任何类似的命名空间。或者更糟糕的是，引用同一个 dll 的不同版本（我的问题通常与 NUnit dll 文件有关）。

# subdomain - 不同主机上的子域

> ID：189552
> 
> 赞同：120
> 
> 时间：2008-10-09T23:13:31.053
> 
> 标签：subdomain, hosting

我正在尝试使用不同的托管公司为我的网站托管一个子域，但我遇到了如何设置它的问题。

以下是详细信息： - 域已在 GoDaddy 注册。- 名称服务器指向 DiscountASP.net，其中 ASP.NET 应用程序已经愉快地运行了几年。- 希望 blog.mydomain.com 指向我在 DreamHost.com 的帐户，以利用他们的 LAMP 堆栈。

我已经通过他们的控制面板将 blog.mydomain.com 添加到 DreamHost（添加 mydomain.com 之后）。我以为我可以在 GoDaddy 上添加一个子域条目以指向 DreamHost，但他们只允许 blog.mydomain.com = new url。

从理论上讲，我可以只使用我们的 .biz 或 .net 域并将其托管在 DreamHost 上，但希望我可以使用子域来完成这一切。

所以，总而言之，我想知道我想做的事情是否可行，如果可行，我该怎么做（考虑到 GoDaddy、DiscountASP 和 DreamHost 的限制）。

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2008-10-09T23:19:02.557

子域是域的一部分，就像转租公寓的房间一样。必须在域的 dns 上设置记录，例如

mydomain.com 的 IP 为 123.456.789.999，由 Godaddy 托管。现在获取子域

anothersite.mydomain.com

其中该站点实际上位于另一台服务器上

登录 Godaddy 并添加一条**A 记录** ^([dnsimple anothersite.mydomain.com](https://support.dnsimple.com/articles/a-record/))并将 IP 指向另一台服务器 98.22.11.11

就是这样。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-09T23:18:20.310

您只需要在 Godaddy 的 DNS 管理器中添加一条“A”记录。在那条“A”记录中，将您的 IP 从dreamhost 中输入。

我知道这很有效，因为我正在做同样的事情。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-10T01:42:59.553

更新 - 我没有在 GoDaddy 启用 Total DNS，因为该域托管在 DiscountASP。因此，我无法添加 A 记录，这就是为什么 GoDaddy 只提供将我的子域转发到不同站点的原因。我终于意识到我必须去DiscountASP添加A记录指向DreamHost。现在等着看是否一切正常！

当然，使用臭IP！我不确定为什么没有为我注册。我猜他们指向另一个网址的帮助文本示例让我失望。

感谢两位的回复。我一读到科比的回应，我就“明白了”，这是第一个，但赛义夫把它提高了一个档次，并添加了更多细节。

谢谢！

# python - 如何使用 Python 登录网页并检索 cookie 以供以后使用？

> ID：189555
> 
> 赞同：148
> 
> 时间：2008-10-09T23:14:43.830
> 
> 标签：python, http, authentication, cookies

我想使用 python 下载和解析网页，但要访问它，我需要设置几个 cookie。因此，我需要先通过 https 登录网页。登录时刻包括向 /login.php 发送两个 POST 参数（用户名、密码）。在登录请求期间，我想从响应标头中检索 cookie 并存储它们，以便我可以在请求中使用它们来下载网页 /data.php。

我将如何在 python 中执行此操作（最好是 2.6）？如果可能的话，我只想使用内置模块。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-08-24T06:07:36.350

这是使用优秀[请求](http://docs.python-requests.org/en/latest/index.html)库的版本：

```
from requests import session

payload = {
    'action': 'login',
    'username': USERNAME,
    'password': PASSWORD
}

with session() as c:
    c.post('http://example.com/login.php', data=payload)
    response = c.get('http://example.com/protected_page.php')
    print(response.headers)
    print(response.text) 
```

* * *

## 回答 #2

> 赞同：147
> 
> 时间：2008-10-09T23:24:39.690

```
import urllib, urllib2, cookielib

username = 'myuser'
password = 'mypassword'

cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
login_data = urllib.urlencode({'username' : username, 'j_password' : password})
opener.open('http://www.example.com/login.php', login_data)
resp = opener.open('http://www.example.com/hiddenpage.php')
print resp.read() 
```

`resp.read()`是您要打开的页面的直接 html，您可以使用`opener`会话 cookie 来查看任何页面。

# java - ORA-00942: 表或视图不存在: 我如何找到它正在谈论的表或视图

> ID：189557
> 
> 赞同：9
> 
> 时间：2008-10-09T23:16:23.967
> 
> 标签：java, sql, oracle, hibernate, ora-00942

在测试中，我们正在运行一个针对 ORACLE 10g 的 java/hibernate 应用程序。有时，我们会看到此错误：

> ORA-00942: 表或视图不存在

有没有办法找出 ORACLE 正在谈论的表/视图？

我知道我可以在 hibernate 中添加额外的日志记录级别，这将显示它在 ORACLE 上执行的所有 SQL，然后运行该 SQL 以确定哪个 TABLE/VIEW 缺少或缺少权限。但鉴于它处于 TESTING/STAGING 中，这会降低性能。

有没有一种简单的方法来缩小表/视图名称的范围？

## 更新 ：

如您所知，我无法控制 Oracle 数据库服务器环境。
我启用了 Hibernate 跟踪/日志记录并找到了一个有效的 SQL。我什至放了 Wireshark（它是一个 TCP 数据包过滤器）来查看 hibernate 实际发送的内容，这是一个有效的 SQL。那么，为什么甲骨文会偶尔抱怨它，而不是总是抱怨。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T09:13:26.367

这就是我所做的，向最初来自的人致歉，我知道我是从某个网站上拿的，但现在不记得在哪里了。

在预生产中，我有这个

```
create table caught_errors (
  dt        date,               
  username  varchar2( 30), -- value from ora_login_user
  msg       varchar2(2000),
  stmt      varchar2(2000)
);

create or replace trigger catch_errors
   after servererror on database
declare
   sql_text ora_name_list_t;
   msg_     varchar2(2000) := null;
   stmt_    varchar2(2000) := null;
begin

  for depth in 1 .. ora_server_error_depth loop
    msg_ := msg_ || ora_server_error_msg(depth);
  end loop;

  for i in 1 .. ora_sql_txt(sql_text) loop
     stmt_ := stmt_ || sql_text(i);
  end loop;

  insert into 
    caught_errors (dt     , username      ,msg ,stmt )
           values (sysdate, ora_login_user,msg_,stmt_);
end;
/ 
```

任何时候抛出 servererror，它被捕获并记录到一个表中，然后我可以检查该表以找到有问题的查询，并根据需要退还它们以查看丢失的表（当您在 sqlplus 中运行查询时，它会告诉您桌子）

请注意，是的，这是有问题的，例如，如果 catch_errors 被丢弃，或者本身引发错误，您可能会得到递归循环，因此为什么这只存在于预生产中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T00:07:43.910

当为 Oracle 启用审计时，查看 DBA_AUDIT_EXISTS 表。我相信 Oracle 可以提供非常详细的审计，您可以在需要时通过 DB 命令简单地打开和关闭，尽管我不记得它们是什么。

请参阅： [http ://docs.oracle.com/cd/B19306_01/network.102/b14266/cfgaudit.htm](http://docs.oracle.com/cd/B19306_01/network.102/b14266/cfgaudit.htm)

对于一些想法（我只是快速搜索了一下）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T06:46:12.823

您应该检查帐户，该帐户是否具有访问目标表的权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T00:06:49.183

我不认为这里有灵丹妙药。它可能是缺少表，或者查询中的表名拼写错误。这可能是一个特权问题。如果不执行查询，你真的无法判断

我建议您继续以可以打开和关闭它的方式检测您的代码。运行它，提取查询，然后将其发送给您的 DBA 来解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T10:06:00.040

如果您在导入数据库时​​遇到此问题，请检查表空间名称是否正确。

# java - 如何在 Java 中加入两个列表？

> ID：189559
> 
> 赞同：928
> 
> 时间：2008-10-09T23:17:43.260
> 
> 标签：java, list, jdk1.5

条件：不修改原名单；只有 JDK，没有外部库。单行或 JDK 1.3 版本的奖励积分。

有没有比以下更简单的方法：

```
List<String> newList = new ArrayList<String>();
newList.addAll(listOne);
newList.addAll(listTwo); 
```

* * *

## 回答 #1

> 赞同：809
> 
> 时间：2013-09-08T19:31:49.730

在 Java 8 中：

```
List<String> newList = Stream.concat(listOne.stream(), listTwo.stream())
                             .collect(Collectors.toList()); 
```

* * *

## 回答 #2

> 赞同：659
> 
> 时间：2008-10-09T23:21:09.777

在我的脑海中，我可以将它缩短一行：

```
List<String> newList = new ArrayList<String>(listOne);
newList.addAll(listTwo); 
```

* * *

## 回答 #3

> 赞同：382
> 
> 时间：2010-08-27T03:28:00.207

您可以使用[Apache commons-collections](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/ListUtils.html)库：

```
List<String> newList = ListUtils.union(list1, list2); 
```

* * *

## 回答 #4

> 赞同：191
> 
> 时间：2014-04-03T22:51:03.553

另一个 Java 8 单线：

```
List<String> newList = Stream.of(listOne, listTwo)
                            .flatMap(Collection::stream)
                            .collect(Collectors.toList()); 
```

作为奖励，由于`Stream.of()`是可变参数，您可以连接任意数量的列表。

```
List<String> newList = Stream.of(listOne, listTwo, listThree)
                            .flatMap(Collection::stream)
                            .collect(Collectors.toList()); 
```

* * *

## 回答 #5

> 赞同：98
> 
> 时间：2012-12-13T20:54:12.000

您的要求之一是保留原始列表。如果您创建一个新列表并使用`addAll()`，那么您实际上将列表中对象的引用数量增加了一倍。如果您的列表非常大，这可能会导致内存问题。

如果您不需要修改连接结果，则可以使用自定义列表实现来避免这种情况。自定义实现类不止一行，显然……但使用它又短又甜。

CompositeUnmodifiableList.java：

```
public class CompositeUnmodifiableList<E> extends AbstractList<E> {

    private final List<? extends E> list1;
    private final List<? extends E> list2;

    public CompositeUnmodifiableList(List<? extends E> list1, List<? extends E> list2) {
        this.list1 = list1;
        this.list2 = list2;
    }

    @Override
    public E get(int index) {
        if (index < list1.size()) {
            return list1.get(index);
        }
        return list2.get(index-list1.size());
    }

    @Override
    public int size() {
        return list1.size() + list2.size();
    }
} 
```

用法：

```
List<String> newList = new CompositeUnmodifiableList<String>(listOne,listTwo); 
```

* * *

## 回答 #6

> 赞同：97
> 
> 时间：2008-10-10T00:30:15.690

可能并不简单，但有趣且丑陋：

```
List<String> newList = new ArrayList<String>() { { addAll(listOne); addAll(listTwo); } }; 
```

不要在生产代码中使用它... ;)

* * *

## 回答 #7

> 赞同：83
> 
> 时间：2012-12-13T20:35:54.373

不简单，但无需调整开销：

```
List<String> newList = new ArrayList<>(listOne.size() + listTwo.size());
newList.addAll(listOne);
newList.addAll(listTwo); 
```

* * *

## 回答 #8

> 赞同：57
> 
> 时间：2011-07-29T13:46:36.307

发现这个问题希望连接任意数量的列表，而不是在意外部库。所以，也许它会帮助别人：

```
com.google.common.collect.Iterables#concat() 
```

如果您想在一个 for() 中将相同的逻辑应用于多个不同的集合，这很有用。

* * *

## 回答 #9

> 赞同：53
> 
> 时间：2016-05-23T09:04:22.310

> Java 8（`Stream.of`和`Stream.concat`）

建议的解决方案适用于三个列表，尽管它也可以应用于两个列表。在 Java 8 中，我们可以将[Stream.of](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#of-T...-)或[Stream.concat](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#concat-java.util.stream.Stream-java.util.stream.Stream-)用作：

```
List<String> result1 = Stream.concat(Stream.concat(list1.stream(),list2.stream()),list3.stream()).collect(Collectors.toList());
List<String> result2 = Stream.of(list1,list2,list3).flatMap(Collection::stream).collect(Collectors.toList()); 
```

`Stream.concat`将两个流作为输入并创建一个惰性连接流，其元素是第一个流的所有元素，然后是第二个流的所有元素。由于我们有三个列表，我们已经使用了这个方法 ( `Stream.concat`) 两次。

我们还可以编写一个实用程序类，其方法采用任意数量的列表（使用[varargs](https://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html)）并返回一个串联列表：

```
public static <T> List<T> concatenateLists(List<T>... collections) {
        return Arrays.stream(collections).flatMap(Collection::stream).collect(Collectors.toList()); 
} 
```

然后我们可以使用这个方法：

```
List<String> result3 = Utils.concatenateLists(list1,list2,list3); 
```

* * *

## 回答 #10

> 赞同：51
> 
> 时间：2015-12-04T14:27:51.770

这是使用两行的 java 8 解决方案：

```
List<Object> newList = new ArrayList<>();
Stream.of(list1, list2).forEach(newList::addAll); 
```

请注意，如果出现以下情况，则不应使用此方法

*   的来源`newList`未知，可能已经与其他线程共享
*   修改的流`newList`是并行流，并且访问 `newList`不是同步的或线程安全的

出于副作用考虑。

上述两个条件都不适用于上述加入两个列表的情况，所以这是安全的。

基于[这个回答](https://stackoverflow.com/a/18290985/1466267)另一个问题。

* * *

## 回答 #11

> 赞同：38
> 
> 时间：2013-09-08T22:50:19.707

这很简单，只有一行，但会将 listTwo 的内容添加到 listOne。您真的需要将内容放在第三个列表中吗？

```
Collections.addAll(listOne, listTwo.toArray()); 
```

* * *

## 回答 #12

> 赞同：33
> 
> 时间：2008-10-09T23:21:09.463

稍微简单一点：

```
List<String> newList = new ArrayList<String>(listOne);
newList.addAll(listTwo); 
```

* * *

## 回答 #13

> 赞同：21
> 
> 时间：2008-10-09T23:22:50.990

更短一点是：

```
List<String> newList = new ArrayList<String>(listOne);
newList.addAll(listTwo); 
```

* * *

## 回答 #14

> 赞同：20
> 
> 时间：2018-05-18T20:33:05.163

您可以创建通用**Java 8**实用程序方法来连接**任意数量的列表**。

```
@SafeVarargs
public static <T> List<T> concat(List<T>... lists) {
    return Stream.of(lists).flatMap(List::stream).collect(Collectors.toList());
} 
```

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2008-10-10T00:46:50.493

如果预先声明了目标列表，您可以执行 oneliner。

```
(newList = new ArrayList<String>(list1)).addAll(list2); 
```

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2017-03-24T02:58:27.853

在**Java 8**中（另一种方式）：

```
List<?> newList = 
Stream.of(list1, list2).flatMap(List::stream).collect(Collectors.toList()); 
```

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2016-11-12T04:38:17.820

另一个使用`Java8`流的衬垫解决方案，因为`flatMap`解决方案已经发布，这里是一个没有的解决方案`flatMap`

```
List<E> li = lol.stream().collect(ArrayList::new, List::addAll, List::addAll); 
```

或者

```
List<E> ints = Stream.of(list1, list2).collect(ArrayList::new, List::addAll, List::addAll); 
```

代码

```
 List<List<Integer>> lol = Arrays.asList(Arrays.asList(1, 2, 3), Arrays.asList(4, 5, 6));
    List<Integer> li = lol.stream().collect(ArrayList::new, List::addAll, List::addAll);
    System.out.println(lol);
    System.out.println(li); 
```

输出

```
[[1, 2, 3], [4, 5, 6]]
[1, 2, 3, 4, 5, 6] 
```

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2020-03-25T17:37:58.243

我们可以使用 java8 和 2 种方法加入 2 个列表。

```
 List<String> list1 = Arrays.asList("S", "T");
    List<String> list2 = Arrays.asList("U", "V"); 
```

1）使用 concat ：

```
 List<String> collect2 = Stream.concat(list1.stream(), list2.stream()).collect(toList());
    System.out.println("collect2 = " + collect2); // collect2 = [S, T, U, V] 
```

2）使用 flatMap ：

```
 List<String> collect3 = Stream.of(list1, list2).flatMap(Collection::stream).collect(toList());
    System.out.println("collect3 = " + collect3); // collect3 = [S, T, U, V] 
```

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2012-07-26T09:25:40.403

我认为最聪明的：

```
/**
 * @param smallLists
 * @return one big list containing all elements of the small ones, in the same order.
 */
public static <E> List<E> concatenate (final List<E> ... smallLists)
{
    final ArrayList<E> bigList = new ArrayList<E>();
    for (final List<E> list: smallLists)
    {
        bigList.addAll(list);
    }
    return bigList;
} 
```

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2020-04-07T14:58:14.953

Almost of answers suggest to use an ArrayList.

```
List<String> newList = new LinkedList<>(listOne);
newList.addAll(listTwo); 
```

Prefer to use a LinkedList for efficient add operations.

ArrayList add is O(1) amortized, but O(n) worst-case since the array must be resized and copied. While LinkedList add is always constant O(1).

more infos [https://stackoverflow.com/a/322742/311420](https://stackoverflow.com/a/322742/311420)

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2008-10-10T00:51:43.120

您可以使用静态导入和辅助类来完成

*注意这个类的泛化*可能会得到改进

```
public class Lists {

   private Lists() { } // can't be instantiated

   public static List<T> join(List<T>... lists) {
      List<T> result = new ArrayList<T>();
      for(List<T> list : lists) {
         result.addAll(list);
      }
      return results;
   }

} 
```

然后你可以做类似的事情

```
import static Lists.join;
List<T> result = join(list1, list2, list3, list4); 
```

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2016-11-29T15:49:17.153

支持按对象键加入的 Java 8 版本：

```
public List<SomeClass> mergeLists(final List<SomeClass> left, final List<SomeClass> right, String primaryKey) {
    final Map<Object, SomeClass> mergedList = new LinkedHashMap<>();

    Stream.concat(left.stream(), right.stream())
        .map(someObject -> new Pair<Object, SomeClass>(someObject.getSomeKey(), someObject))
        .forEach(pair-> mergedList.put(pair.getKey(), pair.getValue()));

    return new ArrayList<>(mergedList.values());
} 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2008-10-10T11:36:59.463

使用 Helper 类。

我建议：

```
public static <E> Collection<E> addAll(Collection<E> dest, Collection<? extends E>... src) {
    for(Collection<? extends E> c : src) {
        dest.addAll(c);
    }

    return dest;
}

public static void main(String[] args) {
    System.out.println(addAll(new ArrayList<Object>(), Arrays.asList(1,2,3), Arrays.asList("a", "b", "c")));

    // does not compile
    // System.out.println(addAll(new ArrayList<Integer>(), Arrays.asList(1,2,3), Arrays.asList("a", "b", "c")));

    System.out.println(addAll(new ArrayList<Integer>(), Arrays.asList(1,2,3), Arrays.asList(4, 5, 6)));
} 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2014-07-12T17:12:52.240

```
public static <T> List<T> merge(List<T>... args) {
    final List<T> result = new ArrayList<>();

    for (List<T> list : args) {
        result.addAll(list);
    }

    return result;
} 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2018-02-21T11:11:36.237

```
public static <T> List<T> merge(@Nonnull final List<T>... list) {
    // calculate length first
    int mergedLength = 0;
    for (List<T> ts : list) {
      mergedLength += ts.size();
    }

    final List<T> mergedList = new ArrayList<>(mergedLength);

    for (List<T> ts : list) {
      mergedList.addAll(ts);
    }

    return mergedList;
  } 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2021-11-24T21:01:16.600

我最喜欢的方式，使用 fluent api 和 Guava：

```
List<String> combined = ImmutableList.<String>builder().addAll(list1).addAll(list2).build() 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-10-10T10:17:23.693

我并不是说这很简单，但你提到了单线的奖金;-)

```
Collection mergedList = Collections.list(new sun.misc.CompoundEnumeration(new Enumeration[] {
    new Vector(list1).elements(),
    new Vector(list2).elements(),
    ...
})) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-09-06T09:14:03.523

没有办法接近单线，但我认为这是最简单的：

```
List<String> newList = new ArrayList<String>(l1);
newList.addAll(l2);

for(String w:newList)
        System.out.printf("%s ", w); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-11-23T14:12:11.773

如果您想静态地执行此操作，您可以执行以下操作。

这些示例以自然顺序（==枚举顺序）使用 2 个 EnumSet，`A, B`然后将其连接到一个`ALL`列表中。

```
public static final EnumSet<MyType> CATEGORY_A = EnumSet.of(A_1, A_2);
public static final EnumSet<MyType> CATEGORY_B = EnumSet.of(B_1, B_2, B_3);

public static final List<MyType> ALL = 
              Collections.unmodifiableList(
                  new ArrayList<MyType>(CATEGORY_A.size() + CATEGORY_B.size())
                  {{
                      addAll(CATEGORY_A);
                      addAll(CATEGORY_B);
                  }}
              ); 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-10-18T22:28:23.480

如果您的列表具有不同的类型并且您想将它们组合到另一种类型的列表中，这是一种使用流和 java 8 的方法。

```
public static void main(String[] args) {
    List<String> list2 = new ArrayList<>();
    List<Pair<Integer, String>> list1 = new ArrayList<>();

    list2.add("asd");
    list2.add("asdaf");
    list1.add(new Pair<>(1, "werwe"));
    list1.add(new Pair<>(2, "tyutyu"));

    Stream stream = Stream.concat(list1.stream(), list2.stream());

    List<Pair<Integer, String>> res = (List<Pair<Integer, String>>) stream
            .map(item -> {
                if (item instanceof String) {
                    return new Pair<>(0, item);
                }
                else {
                    return new Pair<>(((Pair<Integer, String>)item).getKey(), ((Pair<Integer, String>)item).getValue());
                }
            })
            .collect(Collectors.toList());
} 
```

* * *

## 回答 #31

> 赞同：-3
> 
> 时间：2019-04-04T13:53:03.963

```
import java.util.AbstractList;
import java.util.List;

/**
 * The {@code ConcatList} is a lightweight view of two {@code List}s.
 * <p>
 * This implementation is <em>not</em> thread-safe even though the underlying lists can be.
 * 
 * @param <E>
 *            the type of elements in this list
 */
public class ConcatList<E> extends AbstractList<E> {

    /** The first underlying list. */
    private final List<E> list1;
    /** The second underlying list. */
    private final List<E> list2;

    /**
     * Constructs a new {@code ConcatList} from the given two lists.
     * 
     * @param list1
     *            the first list
     * @param list2
     *            the second list
     */
    public ConcatList(final List<E> list1, final List<E> list2) {
        this.list1 = list1;
        this.list2 = list2;
    }

    @Override
    public E get(final int index) {
        return getList(index).get(getListIndex(index));
    }

    @Override
    public E set(final int index, final E element) {
        return getList(index).set(getListIndex(index), element);
    }

    @Override
    public void add(final int index, final E element) {
        getList(index).add(getListIndex(index), element);
    }

    @Override
    public E remove(final int index) {
        return getList(index).remove(getListIndex(index));
    }

    @Override
    public int size() {
        return list1.size() + list2.size();
    }

    @Override
    public boolean contains(final Object o) {
        return list1.contains(o) || list2.contains(o);
    }

    @Override
    public void clear() {
        list1.clear();
        list2.clear();
    }

    /**
     * Returns the index within the corresponding list related to the given index.
     * 
     * @param index
     *            the index in this list
     * 
     * @return the index of the underlying list
     */
    private int getListIndex(final int index) {
        final int size1 = list1.size();
        return index >= size1 ? index - size1 : index;
    }

    /**
     * Returns the list that corresponds to the given index.
     * 
     * @param index
     *            the index in this list
     * 
     * @return the underlying list that corresponds to that index
     */
    private List<E> getList(final int index) {
        return index >= list1.size() ? list2 : list1;
    }

} 
```

* * *

## 回答 #32

> 赞同：-6
> 
> 时间：2008-10-10T04:52:07.610

在一般情况下，如果不引入您自己的实用程序方法，我无法改进两行，但是如果您确实有字符串列表并且您愿意假设这些字符串不包含逗号，您可以拉长一个-衬垫：

```
List<String> newList = new ArrayList<String>(Arrays.asList((listOne.toString().subString(1, listOne.length() - 1) + ", " + listTwo.toString().subString(1, listTwo.length() - 1)).split(", "))); 
```

如果你放弃泛型，这应该是 JDK 1.4 兼容的（虽然我没有测试过）。也不推荐用于生产代码;-)

* * *

## 回答 #33

> 赞同：-7
> 
> 时间：2012-12-21T12:37:40.950

```
public class TestApp {

/**
 * @param args
 */
public static void main(String[] args) {
    System.out.println("Hi");
    Set<List<String>> bcOwnersList = new HashSet<List<String>>();
    List<String> bclist = new ArrayList<String>();
    List<String> bclist1 = new ArrayList<String>();
    List<String> object = new ArrayList<String>();
    object.add("BC11");
    object.add("C2");
    bclist.add("BC1");
    bclist.add("BC2");
    bclist.add("BC3");
    bclist.add("BC4");
    bclist.add("BC5");
    bcOwnersList.add(bclist);
    bcOwnersList.add(object);

    bclist1.add("BC11");
    bclist1.add("BC21");
    bclist1.add("BC31");
    bclist1.add("BC4");
    bclist1.add("BC5");

    List<String> listList= new ArrayList<String>();
    for(List<String> ll : bcOwnersList){
        listList = (List<String>) CollectionUtils.union(listList,CollectionUtils.intersection(ll, bclist1));
    }
    /*for(List<String> lists : listList){
        test = (List<String>) CollectionUtils.union(test, listList);
    }*/
    for(Object l : listList){
        System.out.println(l.toString());
    }
    System.out.println(bclist.contains("BC"));

}

} 
```

# debugging - 通过添加“打印”语句进行调试的正确名称是什么

> ID：189562
> 
> 赞同：40
> 
> 时间：2008-10-09T23:19:00.637
> 
> 标签：debugging, printf-debugging

进行调试的方法有很多种，使用调试器就是其中一种，但对于谦虚、懒惰的程序员来说，最简单的方法就是在代码中添加一堆打印语句。

IE

```
 def foo(x):
     print 'Hey wow, we got to foo!', x

     ...

     print 'foo is returning:', bar
     return bar 
```

这种调试方式有合适的名称吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-09T23:21:55.420

是的 - 它被称为**`printf()`调试**，以无处不在的 C 函数命名：

> 用于描述通过在程序流的关键点插入输出或多或少精心选择的状态信息的命令完成的调试工作，观察该信息并根据该信息推断出什么错误。

-- [printf() 调试@everything2](http://everything2.com/title/printf%2528%2529%2520debugging)

毫无疑问，其他语言的本地用户通过他们选择的编码平台可用的默认打印/日志/跟踪命令来引用它，但我听说过在许多其他语言中用于引用这种技术的“printf()”名称可能是因为它的历史：虽然 BASIC 和 FORTRAN 有基本但可用`PRINT`的命令，但 C 通常需要更多的工作来格式化各种数据类型：`printf()`是（并且通常仍然是）*迄今为止*最方便的方法达到此目的，提供了许多内置的格式化选项。它的表亲，`fprintf()`，采用另一个参数，要写入的流：这允许仔细的“调试器”将诊断信息定向到`stderr`（可能自身重定向到日志文件），同时保持程序的输出不受破坏。

尽管现代调试软件的用户经常看不起 printf() 调试，但它继续证明自己不可或缺：用于 Firefox Web 浏览器的广受欢迎的 FireBug 工具（以及现在可用于其他浏览器的类似工具）是围绕控制台窗口构建的网页脚本可以记录错误或包含格式化数据的诊断消息。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-10-09T23:58:09.887

我听说它叫做**Caveman Debugging**

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-10-26T21:47:37.627

我认为下面的引用是恰当的：

> “最有效的调试工具仍然是仔细考虑，再加上明智地放置打印语句。”
> 
> — Brian Kernighan，“Unix 初学者”（1979 年）

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-10-09T23:31:33.873

我称之为追踪。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-09T23:25:38.330

我和我的队友称之为“Oldschool Debuging”。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-10T05:07:49.030

*你的裤子调试*:)

当您在嵌入式系统上时，当您处于最前沿并且您正在编码的语言还没有调试器时，当您的调试器行为异常并且您想要恢复一些理智时，您想要了解重入是如何在多线程代码中工作的，......

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-10T04:35:52.057

我称之为“嗨，妈妈”编程。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-09T23:42:33.913

我还从 VB 人群中听到了**“MessageBox 调试”**一词来指代这种“调试”的“风格”。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-09T23:46:28.663

[在与探索性编程](http://en.wikipedia.org/wiki/Exploratory_programming)相同的意义上，我喜欢称它为*探索性调试*。当调试器不足以检查程序中的复杂类型或单独调用辅助函数时，或者您对错误了解不足而无法直接使用所述功能时，就会出现这种情况。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-10T00:07:06.813

我嵌入式系统通常是检测代码的唯一方法。不幸的是，打印需要时间并影响系统的实时流程。因此，我们还通过“跟踪”进行检测，其中有关系统状态的信息（函数入口退出等）被写入内部缓冲区，以便稍后转储和解析。真正的嵌入式程序员可以通过闪烁 LED 进行调试；）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-08-20T09:47:09.833

我听说有人使用“**古腾堡调试**”来纪念[印刷机的发明者](http://en.wikipedia.org/wiki/Johannes_Gutenberg)。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-11-29T13:29:25.500

我将其简称为“**日志记录**”。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-09T23:51:31.697

我通常将其称为跟踪。

请注意，在 Visual Studio 中，您可以设置仅添加跟踪的断点。右键单击断点，选择“当命中...”并选中“打印消息”选项。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-10T00:04:44.367

此外，在 .Net 中，您可以添加调试语句（我认为它实际上是 Debug.WriteLine）以输出到控制台。这些语句仅包含在调试版本中 - 当您进行发布版本时，编译器会自动将它们排除在外。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-10T00:31:40.133

经典调试

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-10T04:42:22.903

详细调试！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-10T05:09:47.747

（良好的日志记录对于在运行的生产系统中调试问题非常有价值。许多无用的冗长打印语句不是，但是当重要或意外发生时记录一些有趣的事情非常重要。如果您知道如何调试问题的唯一方法就是使用作为调试器，当您构建的服务对您的某些用户而言已损坏但您无法在本地重现问题时，您会发现自己处于非常紧张的境地。）

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-09T23:34:12.633

手动断言？调试器恐惧症？

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-10T05:17:25.673

我一直以“快速和肮脏的调试”这个术语来了解它，或者简称为“肮脏的调试”。

# performance - T-SQL 中 SELECT 与 SET 的速度

> ID：189588
> 
> 赞同：5
> 
> 时间：2008-10-09T23:29:48.120
> 
> 标签：performance, tsql

我一直相信，对于 T-SQL 中的单变量赋值，`set`是最好的处理方式，原因有两个：

*   这是变量赋值的 ANSI 标准
*   它实际上比执行 SELECT 更快（对于单个变量）

所以...

```
SELECT @thingy = 'turnip shaped' 
```

变成

```
SET @thingy  = 'turnip shaped' 
```

但是有多快，有多*快*？我真的会注意到差异吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T00:40:07.400

SET 在单次运行时更快。你可以很容易地证明这一点。是否有所不同取决于您，但我更喜欢 SET，因为如果所有代码都在做一个赋值，我看不到 SELECT 的意义。我更喜欢将 SELECT 限制在来自表、视图等的 SELECT 语句中。

这是一个示例脚本，运行次数设置为 1：

```
SET NOCOUNT ON

DECLARE @runs int
DECLARE @i int, @j int
SET @runs = 1
SET @i = 0
SET @j = 0

DECLARE @dtStartDate datetime, @dtEndDate datetime

WHILE @runs > 0
    BEGIN
        SET @j = 0
        SET @dtStartDate = CURRENT_TIMESTAMP
        WHILE @j < 1000000
            BEGIN
                SET @i = @j
                SET @j = @j + 1
            END
        SELECT @dtEndDate = CURRENT_TIMESTAMP
        SELECT DATEDIFF(millisecond, @dtStartDate, @dtEndDate) AS SET_MILLISECONDS

        SET @j = 0
        SET @dtStartDate = CURRENT_TIMESTAMP
        WHILE @j < 1000000
            BEGIN
                SELECT @i = @j
                SET @j = @j + 1
            END
        SELECT @dtEndDate = CURRENT_TIMESTAMP
        SELECT DATEDIFF(millisecond, @dtStartDate, @dtEndDate) AS SELECT_MILLISECONDS

        SET @runs = @runs - 1
    END 
```

结果：

运行#1：

SET_MILLISECONDS

5093

SELECT_MILLISECONDS

5186

运行#2：

SET_MILLISECONDS

4876

SELECT_MILLISECONDS

5466

运行#3：

SET_MILLISECONDS

4936

SELECT_MILLISECONDS

5453

运行#4：

SET_MILLISECONDS

4920

SELECT_MILLISECONDS

5250

运行#5：

SET_MILLISECONDS

4860

SELECT_MILLISECONDS

5093

**奇怪的是，如果您将跑步次数增加到 10 次，则 SET 开始落后。**

这是 10 次运行的结果：

SET_MILLISECONDS

5140

SELECT_MILLISECONDS

5266

SET_MILLISECONDS

5250

SELECT_MILLISECONDS

5466

SET_MILLISECONDS

5220

SELECT_MILLISECONDS

5280

SET_MILLISECONDS

5376

SELECT_MILLISECONDS

5280

SET_MILLISECONDS

5233

SELECT_MILLISECONDS

5453

SET_MILLISECONDS

5343

SELECT_MILLISECONDS

5423

SET_MILLISECONDS

5360

SELECT_MILLISECONDS

5156

SET_MILLISECONDS

5686

SELECT_MILLISECONDS

5233

SET_MILLISECONDS

5436

SELECT_MILLISECONDS

5500

SET_MILLISECONDS

5610

SELECT_MILLISECONDS

5266

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T23:36:22.473

我不认为速度是一个问题，它与分配功能集有关。前段时间我遇到了[这个](http://vyaskn.tripod.com/differences_between_set_and_select.htm)问题，SQL Server 2008 中有一些新东西......我听说，尝试用谷歌搜索 SQL Set vs Select SQL SERVER 2008

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T23:34:41.853

看一下“执行计划”，它应该告诉你每行语句的成本

# java - Eclipse 作为 IDE + Mercurial 用于版本控制 + ? 错误跟踪 = 好主意？

> ID：189601
> 
> 赞同：2
> 
> 时间：2008-10-09T23:37:08.353
> 
> 标签：java, eclipse, mercurial, hudson, bug-tracking

对于一个新的 Java Web 项目，我考虑过使用：

*   Eclipse 作为 IDE
*   Mercurial 用于版本控制
*   某种错误跟踪软件

我听说过错误跟踪软件，您可以在签入时将更改与未解决的错误联系起来。我自己没有使用过任何这样的解决方案，但听起来不错。是否有任何可以与 Eclipse 和 Mercurial 结合使用并让您将更改与未解决的错误联系起来的优秀错误跟踪应用程序？如果没有，至少有 Eclipse 使用 Mercurial 进行版本控制的好插件吗？它会支持`hg rename`和`hg copy`吗？

如果我可以使用上述三个组件的组合来获得良好的工作效果，我也计划将 Hudson 加入其中。能够跟踪代码库中的更改如何影响我们的单元测试。

首先，我想要对上述问题的反馈。但我会很感激有关处理版本控制、错误跟踪以及将它们集成到 Eclipse 中的任何想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T23:55:13.373

Vectrace 提供[Mercurial Eclipse](http://www.vectrace.com/mercurialeclipse/)。但是，听起来还没有结束。

对于错误跟踪，您可以尝试使用[Trac](http://trac.edgewall.org/)和[TracMercurial](http://trac.edgewall.org/wiki/TracMercurial)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T00:21:42.103

我无法与 Mercurial 交谈，但[Mylyn](http://www.eclipse.org/mylyn)是集成 Eclipse 和各种错误跟踪器的无可争议的王者。无论您的问题跟踪器的 Web 界面有多好，Mylyn 都可以*更*轻松地创建、组织和（最重要的是）处理传入的问题。它对 Bugzilla 和 Trac 都有很好的支持。它的 Jira 支持有点落后，但还不错。此外，还有[一小部分第三方插件](http://wiki.eclipse.org/index.php/Mylyn_Extensions)为各种问题跟踪器（例如 Mingle）添加了 Mylyn 支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T12:26:59.703

以我的经验，MercurialEclipse 插件运行良好——据我了解，这里没有人实际使用过它，所以不要仅仅根据这些意见做出决定。你最好自己测试一下。正如我之前所说 - 它对我有用。

免责声明：我参与了插件的开发...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T00:06:57.670

Trac 有时设置起来很麻烦。看看[Redmine](http://www.redmine.org/)。我也推荐安装[TortoiseHg](http://tortoisehg.sourceforge.net/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-21T22:30:23.700

以防万一有人遇到这个线程，当我发现它是 Netbeans 中的 3 个集成版本控制系统之一时，我开始使用 Mercurial。

我知道这是一个 Eclipse 线程，但对于尚未适应 Eclipse 并查看 Mercurial 以对 Netbeans 中的集成进行版本控制的任何人来说，这确实令人印象深刻。

它包括诸如项目级覆盖（更改了什么，您是否已提交等）之类的内容，但通过在代码视图中添加直接突出显示更进一步（因此我可以逐行查看已修改的内容和未修改的内容）。

如果您还没有开始使用 Eclipse，那么绝对值得一看（这也很棒，但我不认为版本控制集成具有可比性/无论如何）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T13:26:17.937

关于 Netbeans，我不能说太多，但我想我可以对 Eclipse 说点什么。CVS 之类的版本控制在 Eclipse 中很棒，但我认为在其他类型的版本控制中支持有点滞后。

至于更改，Eclipse 还突出显示了您在源代码中的新更改，它甚至为您提供正在编辑的文件的本地历史记录。Ecipse 中有项目级别的覆盖，但您需要为此使用某种版本控制系统（CVS、Subversion 等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-29T20:38:46.720

我在网上搜索了一些你正在寻找的东西，然后遇到了 codeBeamer，这是一个基于 Web 的问题跟踪器和项目管理工具，它通过一个名为 codeBeamer studio 的插件与 eclipse 任务完全兼容。

[CodeBeamer 网站](http://www.codebeamer.com)

我刚刚将它安装在我的专用服务器上，我必须说我印象深刻。

只是想我会把它放在这里，可能会节省一些时间。

# java - 在两个 Netbeans 项目之间共享源代码

> ID：189608
> 
> 赞同：2
> 
> 时间：2008-10-09T23:39:51.640
> 
> 标签：java, netbeans

我在 Netbeans（一个 JSF Web 应用程序）中有一个现有的 Java 项目。我想在一个单独的项目中试验 GWT - 从原始项目中提取源代码。有没有办法在两个 Netbeans 项目之间共享源代码。

当我尝试将原始项目中的源目录添加到新项目中时，IDE 抱怨源已经是另一个项目的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T08:38:51.380

如果您只是在试验，则将现有项目的必要部分复制到不同的目录。当然，更改不会在以后同步。

如果您想保持两个项目都处于活动状态，请使用公共代码创建一个单独的项目，并将其用作库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T14:56:10.203

使用源代码管理。对于 CVS，使用模块。对于 Subversion，使用 svn:externals。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T14:58:07.390

或者，尝试将源文件夹移到两个项目文件夹之外。然后将源添加到每个项目。不要同时打开两个项目。

# performance - T-SQL中多变量赋值的速度

> ID：189610
> 
> 赞同：0
> 
> 时间：2008-10-09T23:40:41.310
> 
> 标签：performance, tsql, variables, variable-assignment

想象一下，我在存储过程的顶部有一段初始化代码，其中包含许多变量赋值：

```
SET @proc = 'sp_madeupname'
SET @magic_number = 42
SET @tomorrows_date = DATEADD(dd, 1, GETDATE())
... 
```

显然，将上述所有操作作为一个 SELECT 会更快：

```
SELECT
     @proc = 'sp_madeupname'
    ,@magic_number = 42
    ,@tomorrows_date = DATEADD(dd, 1, GETDATE())
... 
```

但是快多少呢*？*假设这个存储过程作为循环的一部分被执行了几千次，它会对性能产生重大影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T05:15:21.743

在这种情况下，SELECT 在执行多个分配时在性能方面获胜。

以下是有关它的更多信息：

[SELECT 与 SET：优化循环](http://www.sqlmag.com/Articles/ArticleID/94555/94555.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T23:51:17.903

我考虑过但从未测试过。

根据我的经验，优化器非常好，所以我认为它没有区别，但如果你认为它真的有用，我会运行一些测试。

我认为从维护的角度来看，做多个分配可能很有用，如果你想要一些应该始终一起完成的事情，而不是通过剪切和粘贴或重构来分解。

出于同样的原因，相对模块化的代码可以从单独的初始化中受益，因为这更容易在维护期间剪切和粘贴以进行重构。

# css - CSS 的 !important 声明何时不起作用？

> ID：189621
> 
> 赞同：24
> 
> 时间：2008-10-09T23:47:33.840
> 
> 标签：css

我想知道是否有人可以在 CSS 中的 !important 声明**无法**覆盖内联样式时提供一些权威参考摘要。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-09T23:54:06.463

确定哪些样式相互替代涉及许多因素。样式声明在**cascade中出现的****越**低，它针对元素的针对性越强，它对其他样式的影响就越大。

这是样式继承的[CSS2 标准：](http://www.w3.org/TR/CSS2/cascade.html)

> 1.  如果级联产生一个值，请使用它。
> 2.  否则，如果属性是继承的，则使用父元素的值，通常是计算值。
> 3.  否则使用属性的初始值。每个属性的初始值在属性的定义中指明。

在内部，浏览器将根据标准[计算规则的特异性](http://www.w3.org/TR/CSS2/cascade.html#specificity)。!important 声明将增加规则的权重，但动态分配样式属性通常会优先，因为它通常被更高度指定..

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-10T00:09:28.743

到目前为止，研究似乎表明：

*   IE7 支持!important。
*   FireFox 2 和 3 支持 !important。
*   IE6 在标准兼容模式下支持!important。

但是，IE6（可能是 IE7）不支持 !important 在[这种情况下](http://www.maratz.com/blog/archives/2005/06/16/essentials-of-css-hacking-for-internet-explorer/#comment-655)：

```
someselector {
  property: value !important;
  same-property: another-value;
} 
```

它将使用第二个值（最后列出的）。

[此页面](http://reference.sitepoint.com/css/importantdeclarations)证实了这一点：

> 在 Internet Explorer 6 和更早版本中，如果重要声明出现在同一声明块中相同属性的普通声明之前，则普通声明将覆盖重要声明。
> 
> 当使用非法标识符代替关键字重要时，Internet Explorer 6 和 7 会重视声明，而不是按应有的方式忽略声明。

Gizmo 的评论指出 Safari 和 Opera 支持 !important。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T23:53:39.133

我很确定并非所有浏览器都识别 !important 声明。但不记得哪些是我脑海中浮现的。将检查并回复您。

[编辑] 我可以确认 IE6 及更早版本无法识别 !important （除非浏览器处于标准兼容模式 - 不是默认模式）。

您可以使用 !important 覆盖内联规则。但也要记住，内联规则也可以标记为 !important。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-17T16:28:13.113

没有任何答案提到`!important`会使不与级联交互的任何属性无效（[请参阅 W3C 文档](https://www.w3.org/TR/css-animations-1/#keyframes)）。例如，考虑以下 HTML：

```
<div id="bad-div" style="margin-left: 5px"></div> 
```

由以下 CSS 设置样式：

```
#bad-div {
    width: 100px;
    height: 100px;
    animation: marginLeftInvalid 4s infinite ease-in 1s
}

@keyframes marginLeftInvalid {
    0% {
        margin-left: 100px!important
    }
    100% {
        margin-left: 500px
    }
} 
```

由于`@keyframes`规则不与级联交互，因此[<keyframe-selector>](https://www.w3.org/TR/css-animations-1/#typedef-keyframe-selector)中的值不会覆盖的`margin-left`样式。`<div>``0%`

但是，当 HTML 和 CSS 更新为此：

```
<div id="good-div" style="margin-left: 5px"></div>

#good-div {
    width: 100px;
    height: 100px;
    animation: marginLeftValid 4s infinite ease-in 1s
}

@keyframes marginLeftValid {
    0% {
        margin-left: 100px
    }
    100% {
        margin-left: 500px
    }
} 
```

`margin-left`at`0%` *被*强制执行，动画将从 100px 开始循环`margin-left`。

您可以在[此 JSFiddle](https://jsfiddle.net/CSSBurner/okfsygLv/)中看到一个演示。

其他不级联的规则（因此`!important`将使这些声明中的属性无效）包括：

1.  @字体脸
2.  @视口
3.  @counter 风格
4.  @财产
5.  @页
6.  @颜色配置文件
7.  @滚动时间线

[使用此 CodePen](https://codepen.io/vaibhav_neo/pen/WNNqRyX)`@font-face`可以看到对级联的演示及其缺乏参与。进行这些 CSS 更新：

1.  `style="font-family: moderna"`为 DOM 中的第一个`h1`标签添加属性；`h1`从CSS 中删除相同的规则。
2.  在您在 CSS 中看到`!important`的第一个之后添加（第一个中的描述符） - 标题的字体呈现将中断。`'moderna'``font-family``@font-face`
3.  `src`重新加载页面并为第二个描述符重复#2 （在 之后添加）...用于中断`format()`的字体渲染。`h1`
4.  恢复它，然后到`h1 {...}`CSS 中的第一个声明，添加样式 ---> `font-family: 'arsenalregular'`...您会注意到“moderna”没有被覆盖。
5.  恢复这个，然后在你看到`!important`的第一个之后添加（第二个中的描述符） - 标题的字体渲染不会改变。`'arsenalregular'``font-family``@font-face`
6.  重新加载页面并`'moderna'`在第一个`h1`声明中找到 - 添加`!important`之后- DOES`'moderna'`的字体渲染呈现为因为 - 在 CSS 中 - 此声明*是*级联的一部分。`h1``arsenalregular``h1 {...}`

 *[在这个 JSFiddle](https://jsfiddle.net/CSSBurner/4r3k0tex/)`@counter-style`上可以看到（在 Firefox 中）不参与CSS 级联的演示。请注意，列表字形渲染在附加到描述符的声明值时中断，而列表字形渲染在附加到描述符时中断。`!important``symbols``suffix``!important``suffix`

注意：其他规则 DO 级联。这是一个[JSFiddle](https://jsfiddle.net/CSSBurner/6trxmpyg/)，它显示`!important`在`@supports`和中应用`@layer`。截至 2022 年 2 月，由于缺乏对`@layer`( [0.02%](https://caniuse.com/?search=%40layer) ) 的支持，请为此 JSFiddle 使用 Firefox 97 或更高版本。

# c++ - Win32API 结构中 cbSize 成员的用途是什么

> ID：189622
> 
> 赞同：9
> 
> 时间：2008-10-09T23:48:51.497
> 
> 标签：c++, winapi, api

我经常遇到一些 Win32API 结构的定义（但不限于它），它们具有`cbSize`以下示例中的成员。

```
typedef struct _TEST {
    int cbSize;
    // other members follow
} TEST, *PTEST; 
```

然后我们像这样使用它：

```
TEST t = { sizeof(TEST) };
... 
```

或者

```
TEST t;
t.cbSize = sizeof(TEST);
... 
```

我最初的猜测是，这可能会用于版本控制。接收此类结构指针的 DLL 可以检查该`cbSize`成员是否具有编译 DLL 时使用的预期值。或者检查结构是否正确打包。但我想从你这里。

**`cbSize`Win32API 上某些 C++ 结构中成员的用途是什么？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-10T00:12:55.257

它用于版本控制。一个很好的例子是[GetVersionEx](http://msdn.microsoft.com/en-us/library/ms724451(VS.85).aspx)调用。您可以传入[OSVERSIONINFO](http://msdn.microsoft.com/en-us/library/ms724834(VS.85).aspx)或[OSVERSIONINFOEX](http://msdn.microsoft.com/en-us/library/ms724833(VS.85).aspx)。OSVERSIONINFOEX 是 OSVERSIONINFO 的超集，操作系统知道您传入的唯一方法是通过 dwOSVersionInfoSize 成员。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-09T23:51:26.437

> 我最初的猜测是，这可能会用于版本控制。

这是原因之一。我认为这是更常见的一种。

另一个用于具有可变长度数据的结构。

我不认为检查调用者中的正确打包或错误是其背后的特殊原因，但它会产生这种效果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T00:43:51.137

它还允许**WIN32 API**对传入的数据进行最少量的完整性检查。

例如，一个常见的错误是传入一个*不正确*或未*初始化的***cbSize的****WIN32**结构，当这种情况发生时，**WIN32 API**通常只返回一个失败的结果，而不是尝试处理看似损坏的数据。

 ******* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T23:56:44.993

部分版本控制，主要是安全性......以防止被调用的函数插入不属于传入结构的内存。

# wcf - 没有身份验证的 WCF 传输安全性

> ID：189623
> 
> 赞同：6
> 
> 时间：2008-10-09T23:50:03.867
> 
> 标签：wcf, security, authentication

是否可以在没有身份验证的情况下获得传输安全性？我很清楚它的缺陷，但 atm 我无法在客户端安装证书。看来我可以将 WSHttpBinding.SecurityMode 设置为 Transport 并将 ClientCredentialType 设置为 HttpClientCredentialType.None，但是当我尝试调用该服务时，我得到了这个异常：

[向https://[MyService]](https://[MyService])发出 HTTP 请求时出错。这可能是由于在 HTTPS 情况下未使用 HTTP.SYS 正确配置服务器证书。这也可能是由于客户端和服务器之间的安全绑定不匹配造成的。

我不认为这是客户端和服务器之间的安全绑定不匹配，因为我使用的是 svcutil 生成的代理。

如果我将 ClientCredentialType 设置为 None，为什么还要寻找服务器证书？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T15:08:36.823

您可以在没有身份验证的情况下进行 HTTPS 通信，但您不能在没有证书的情况下进行 HTTPS 通信，因为 HTTPS 加密使用证书。

有几件事需要检查：

1.  您可以在浏览器中通过 HTTPS 访问站点上的 WSDL 或其他资源吗？
2.  这样做时，您是否收到有关证书的任何警告？

如果您无法通过 HTTPS 访问站点上的 WSDL 或其他资源，则说明服务器上未配置 HTTPS。

如果您收到有关证书的警告，那么您没有客户端会信任的证书。这里有三个选项；[一种是从像Verisign](http://en.wikipedia.org/wiki/Verisign)这样的受信任的地方获取有效证书，另一种是将证书安装在用户商店的受信任部分（您不能像您提到的那样做），最后是关闭客户端的 WCF 配置中的证书吊销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T00:30:56.017

您设置的内容看起来与您想要的内容相符。

我认为问题与确保传输级安全 (HTTPS) 所需的证书与身份验证所需的任何证书之间的差异有关。

要执行传输级别的安全性，您需要为 IIS 服务器配置一个证书以用于其加密。这绝不用于识别 WCF 通信中的各方，只是为了保护通信。（用于此 HTTPS 传输的证书也用于标识服务器，但与 WCF 身份无关）

这是一篇[博客文章](http://geeks.netindonesia.net/blogs/kasim.wirama/archive/2007/12/18/securing-message-with-https-in-wcf.aspx)的链接，该文章解释了如何为此目的在 IIS 中设置证书。不一定是最好的谷歌，只是我发现的第一个涵盖了所有重要点。MSDN 也应该详细介绍这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T12:02:13.017

即使安全模式设置为传输并且客户端凭据类型设置为无，我也遇到了您描述的错误。

这是因为我的 Web 服务 URL 已由 Visual Studio 2010 服务引用创建者创建为*[http://www.myservice.com:80/myservice.asmx](http://www.myservice.com:80/myservice.asmx)*并具有特定端口 80。当我将其更改为*[http ://www.myservice.com/myservice.asmx](http://www.myservice.com/myservice.asmx)*绑定工作正常。

# .net - 应该使用 Visual Studio GUI 编辑器吗？

> ID：189631
> 
> 赞同：2
> 
> 时间：2008-10-09T23:53:35.467
> 
> 标签：.net, visual-studio, user-interface

来自背景，我熟悉在生成代码方面做得很差的 GUI 编辑器。但是，我从未使用 .NET 编写过 GUI。Visual Studio 中的 GUI 编辑器是否有相同的问题？源文件和输出 GUI 都好吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T23:57:57.127

Visual Studio 中的 GUI 编辑器可能是我用过的最好的。此外，由于 C# 支持[部分类](http://msdn.microsoft.com/en-us/library/wa80x488(VS.80).aspx)，因此 IDE 生成的代码和您自己的代码之间有一个清晰的分离。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T23:59:13.113

是的，在大多数情况下，您应该使用 GUI 编辑器。并不是说您不必时不时地解决它。

这也取决于您是在谈论 WPF 还是 Winforms。

Winforms 我几乎大部分时间都在使用它。WPF，我会手动滚动很多，偶尔使用混合或其他东西来做一些更棘手的布局事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T23:59:30.477

如果您正在使用 WinForms，那么 VS2005 和 2008 就可以了 - 事实上，使用其他任何东西都没有意义，因为它在部分类中创建类/代码，这会占用您大量的手动编码。

如果您正在使用 ASP.NET，那么输出的一些 HTML 可能会有点古怪，但有一些方法可以解决这个问题 - 例如 CSSControlAdapters。

如果你正在做 WPF，那么记事本就是，除非你有 VS2008，我相信它有一个内置的 WPF GUI 编辑器 - 但不要做 WPF 所以不确定......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T02:31:23.540

设计师是要走的路。如果您非常关心生成的代码的质量，我会给您一个提示，即确保您只设置您需要的值。

在属性窗口中显示为**粗体**的任何内容都将被序列化到 InitComponent 例程。因此，如果您想要尽可能**干净**的代码，您将需要确保仅序列化从默认值更改的内容。如果要重置为默认值，只需右键单击属性并选择“重置”。

Also keep in mind that most components (buttons, labels, etc) will inherit many properties (Fonts, Colors, etc) from their parent. Thus if you want to say have a default font of "Tahoma" on your form you should only set it for the form and not for each individual control.

# html - MS Office 超链接更改代码页？

> ID：189640
> 
> 赞同：0
> 
> 时间：2008-10-09T23:58:55.300
> 
> 标签：html, unicode, ms-office, character-encoding

当您将以下 URL 粘贴到 IE 中时：[http ://technet.microsoft.com/en-us/sysinternals/bb897434.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897434.aspx)，页面右侧的链接清楚地显示“下载 Zoomit (77 KB)”。如果将链接粘贴到 Office 文档（Word、Excel、PowerPoint - 使用 Office 2003 测试）中，并从文档中激活链接，则相同的文本会拾取几个 A-circumflex 符号。这是因为源 HTML 包含“ ” 被翻译成 Unicode 00A0 的实体（不间断空格）。在 UTF-8 中，这表示为 X'C2A0'，然后 X'C2' 显示为 A-circumflex。我不完全理解代码页是如何像这样混在一起的，但我真的很想找到一个 HTML 元 http-equiv 字符集值，它会导致我的包含 nbsp-entity 的页面即使在从办公文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T20:10:05.203

我找到了一个似乎有效的答案。首先，我添加了一个警报来显示 document.charset。直接调用时显示“utf-8”，从 MS Office 文档中的超链接调用时显示“windows-1252”。因此，我插入了以下元标记，即使从 Office 文档调用，页面似乎也能正确显示：

```
<meta http-equiv="content-type" content="text/html; charset=utf-8" /> 
```

# c# - 开发要销售的基于 Web 的应用程序时需要考虑哪些常见事项

> ID：189644
> 
> 赞同：13
> 
> 时间：2008-10-10T00:01:53.407
> 
> 标签：c#, asp.net, architecture, web-applications, product

我正在为内部客户开发应用程序。要求之一是它的开发方式可能会出售给其他组织。该应用程序是一个筹款组织的跟踪应用程序，该组织将管理他们的捐赠、捐赠者、参与者和活动。我已经知道我需要开发一个用于身份验证的插件架构（授权将在内部处理）并从外部目录中获取人口统计数据。

该应用程序将在 ASP.NET/C#/Linq/SQL Server 上构建。在这一点上，我并不是真的愿意支持替代数据库，但我想如果有必要，我可以在未来通过不同的 Linq 驱动程序来做到这一点。

迄今为止，我构建的所有 Web 应用程序都是自定义实现，所以我想知道是否还有其他需要通过插件和/或配置项解决的问题。任何输入都会有所帮助。

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-10T02:57:34.097

我想提醒您不要尝试制作“无所不能”的框架。这是许多开发人员在尝试构建他们最初的几个大众市场软件应用程序时常犯的错误。

您已经有一个客户，他们可能正在为应用程序的初始版本提供资金。您需要尽可能快地满足客户的需求，否则在您开始考虑大众市场之前它就会失败。

帮自己一个忙，并期望这是唯一会使用或购买该应用程序的客户。设计您的应用程序几乎与您过去设计任何其他自定义应用程序的方式完全相同。

为了以后将其扩展到其他客户，您需要做的就是尽可能地坚持现有的 asp.net 特性和功能，使其尽可能简单和精简，并从其中削减尽可能多的“高级”特性版本 1.x，你可以逃脱。

1.x 将是您的试验场。确保您交付的应用程序能够满足您最初客户的需求，并且做得非常好。

如果您成功了，并且 1.x 确实满足了大多数初始客户的要求，那么您就会知道您还有一个应用程序可以满足任何客户的大部分需求。恭喜，您已经朝着拥有可行的商业市场应用的方向迈进了一大步！

需要注意的事项：

1.  你真的需要支持多个数据库平台吗？当然，您可能有“一些”客户可能“更喜欢”MySql 而不是 SQL Server。您会很想尝试编写一些可以支持 Oracle、MySQL、VistaDB、SQL Server 等的神奇 DAL，只需更改一些配置选项或在安装程序中做出正确的选择。但事实是，这种“平台”中立性给您的设计增加了巨大的复杂性，并对您利用的功能施加了严重的限制。提供者设计模式之类的东西可能会让你误以为这种设计并不难……但你错了。务实并设计您的应用程序，使其能够为 90% 的潜在市场所接受。特别是在数据访问方面，通常可以肯定地说，90% 或更多愿意安装和运行 ASP.NET 应用程序的市场也能够并愿意使用 SQLExpress 或 SQL Server。在大多数情况下，与支持多个数据库的额外销售相比，仅针对 SQL 服务器进行设计可以节省更多的金钱和时间。

2.  尽量避免通过在线管理工具使“一切”都可配置。例如，您会很想将应用程序中的所有文本都通过管理工具进行配置。这很棒，但也很昂贵。开发需要更长的时间，需要您扩大应用程序的范围以包含一大堆您本来不需要的管理工具，并且它会使应用程序更加复杂，并且难以为 90% 的客户使用不介意默认文本。

3.  仔细考虑本地化。如果你不认为你会拥有一个庞大的国际市场，那就坚持一种语言。本地化并不太难，但它确实使您的代码的各个方面都稍微复杂化了……这在任何规模的任何应用程序中都会增加很多。我的经验法则是只针对我最初市场的语言。如果该应用程序对其他市场感兴趣，那么在我从 1.0 版中收回一些现金并首先证明该应用程序具有可行的市场后，我会返回并在 2.x 版中进行本地化。但是，如果您知道您将使用一种以上的语言或文化，请从一开始就支持本地化。

4.  对于 1.0 版，不要太担心插入式模块或花哨的服务 API。如果您已经在可重用框架方面有很多经验，那么您可以在 1.0 版本中拥有这些东西，但是如果您缺乏这种架构的经验，您将在 1.x 版本中浪费太多时间在这些功能上，而您可能仍然会出错，并且无论如何都必须在版本 2.x 中重新架构。

5.  确保应用程序具有非常好的报告。对于您正在谈论的那种应用程序，这将决定该应用程序是否有市场。您需要漂亮的报告，这些报告不仅可以在屏幕上排序/过滤，而且还可以打印。把你的金钱和时间投入其中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T00:27:42.807

最重要的是以完全通用的方式设计它，即没有硬编码或嵌入的客户特定信息。

任何特定于客户端的内容都必须可以通过元数据进行配置。如何执行此操作完全取决于您，但主要方法是通过 XML、数据库或属性文件。

如果您以这种方式设计它，它可以出售给任何数量的客户，每个客户都有自己的配置文件或数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T00:43:58.343

Abarax 给出了一个很好的答案，我强调您应该考虑本地化 - 包括口语（英语、法语、德语等）和组织的语言，例如有些地方可能将其称为时间表、案卷或工作单，并且每一个如果一切都与他们一直称之为的东西不符，他们会发牢骚、发牢骚、发牢骚。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-02T01:15:08.623

如果您使用的是开源技术，请花一点时间将所有许可证信息保存在一个地方。

# python - 如何打破多个循环？

> ID：189645
> 
> 赞同：642
> 
> 时间：2008-10-10T00:02:01.690
> 
> 标签：python, nested-loops, break, control-flow

给定以下代码（不起作用）：

```
while True:
    #snip: print out current state
    while True:
        ok = get_input("Is this ok? (y/n)")
        if ok.lower() == "y": break 2 #this doesn't work :(
        if ok.lower() == "n": break
    #do more processing with menus and stuff 
```

有没有办法使这项工作？或者我是否需要进行一次检查以跳出输入循环，然后进行另一项更有限的检查，以在用户满意的情况下一起跳出外部循环？

* * *

## 回答 #1

> 赞同：655
> 
> 时间：2008-10-10T00:25:05.480

我的第一直觉是将嵌套循环重构为一个函数并用于`return`中断。

* * *

## 回答 #2

> 赞同：400
> 
> 时间：2010-06-30T14:15:59.533

这是另一种简短的方法。缺点是你只能打破外循环，但有时它正是你想要的。

```
for a in xrange(10):
    for b in xrange(20):
        if something(a, b):
            # Break the inner loop...
            break
    else:
        # Continue if the inner loop wasn't broken.
        continue
    # Inner loop was broken, break the outer.
    break 
```

这使用了 for / else 构造解释：[为什么 python 在 for 和 while 循环之后使用 'else'？](https://stackoverflow.com/questions/9979970/why-does-python-use-else-after-for-and-while-loops)

关键见解：*似乎*外循环似乎总是中断。**但是如果内循环没有中断，外循环也不会。**

该`continue`声明是这里的魔力。它在 for-else 子句中。[根据定义](https://stackoverflow.com/a/9980752/673991)，如果没有内部中断，就会发生这种情况。在那种情况下`continue`巧妙地规避了外部中断。

* * *

## 回答 #3

> 赞同：170
> 
> 时间：2008-10-10T03:50:44.317

[PEP 3136](http://www.python.org/dev/peps/pep-3136/)建议标记中断/继续。Guido[拒绝了它，](http://mail.python.org/pipermail/python-3000/2007-July/008663.html)因为“需要此功能的复杂代码非常罕见”。PEP 确实提到了一些解决方法（例如异常技术），而 Guido 认为在大多数情况下使用 return 重构会更简单。

* * *

## 回答 #4

> 赞同：145
> 
> 时间：2008-10-10T00:11:37.910

首先，普通逻辑是有帮助的。

如果由于某种原因无法确定终止条件，则例外是一种备用计划。

```
class GetOutOfLoop( Exception ):
    pass

try:
    done= False
    while not done:
        isok= False
        while not (done or isok):
            ok = get_input("Is this ok? (y/n)")
            if ok in ("y", "Y") or ok in ("n", "N") : 
                done= True # probably better
                raise GetOutOfLoop
        # other stuff
except GetOutOfLoop:
    pass 
```

对于此特定示例，可能不需要例外。

另一方面，我们在字符模式应用程序中经常有“Y”、“N”和“Q”选项。对于“Q”选项，我们希望立即退出。那更不寻常。

* * *

## 回答 #5

> 赞同：60
> 
> 时间：2010-07-03T15:50:53.507

我倾向于同意重构为函数通常是这种情况的最佳方法，但是当你*真的*需要打破嵌套循环时，这是@S.Lott 描述的异常引发方法的一个有趣变体。它使用 Python 的`with`语句使异常引发看起来更好一些。使用以下命令定义一个新的上下文管理器（您只需执行一次）：

```
from contextlib import contextmanager
@contextmanager
def nested_break():
    class NestedBreakException(Exception):
        pass
    try:
        yield NestedBreakException
    except NestedBreakException:
        pass 
```

现在您可以按如下方式使用此上下文管理器：

```
with nested_break() as mylabel:
    while True:
        print "current state"
        while True:
            ok = raw_input("Is this ok? (y/n)")
            if ok == "y" or ok == "Y": raise mylabel
            if ok == "n" or ok == "N": break
        print "more processing" 
```

`Exception`优点：（1）它更简洁（没有显式的 try-except 块），以及（2）每次使用`nested_break`;你都会得到一个定制的子类。无需`Exception`每次都声明自己的子类。

* * *

## 回答 #6

> 赞同：55
> 
> 时间：2011-07-03T18:15:55.093

引入一个您将用作“循环断路器”的新变量。首先为它分配一些东西（False，0，等等），然后在外部循环中，在你从中中断之前，将值更改为其他东西（True，1，...）。一旦循环退出，让“父”循环检查该值。让我演示一下：

```
breaker = False #our mighty loop exiter!
while True:
    while True:
        if conditionMet:
            #insert code here...
            breaker = True 
            break
    if breaker: # the interesting part!
        break   # <--- ! 
```

如果你有一个无限循环，这是唯一的出路；对于其他循环的执行确实要快得多。如果您有许多嵌套循环，这也适用。您可以全部退出，也可以只退出几个。无限可能！希望这有帮助！

* * *

## 回答 #7

> 赞同：46
> 
> 时间：2008-10-10T00:12:38.533

首先，您还可以考虑将获取和验证输入的过程变成一个函数；在该函数中，如果它正确，您可以只返回该值，如果不正确，则继续在*while*循环中旋转。这基本上消除了您解决的问题，并且通常可以应用于更一般的情况（打破多个循环）。如果您绝对必须在代码中保留此结构，并且真的不想处理簿记布尔值...

您也可以通过以下方式使用*goto （使用*[此处](http://entrian.com/goto/)的愚人节模块）：

```
#import the stuff
from goto import goto, label

while True:
    #snip: print out current state
    while True:
        ok = get_input("Is this ok? (y/n)")
        if ok == "y" or ok == "Y": goto .breakall
        if ok == "n" or ok == "N": break
    #do more processing with menus and stuff
label .breakall 
```

我知道，我知道，“你不能使用 goto”等等，但它在像这样的奇怪情况下效果很好。

* * *

## 回答 #8

> 赞同：35
> 
> 时间：2017-10-28T00:52:41.437

要打破多个嵌套循环，而不重构为函数，请使用带有内置[StopIteration 异常](https://docs.python.org/2/library/exceptions.html#exceptions.StopIteration)的“模拟 goto 语句” ：

```
try:
    for outer in range(100):
        for inner in range(100):
            if break_early():
                raise StopIteration

except StopIteration: pass 
```

请参阅[有关](https://stackoverflow.com/questions/1257744/can-i-use-break-to-exit-multiple-nested-for-loops)使用 goto 语句打破嵌套循环的讨论。

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2008-10-10T00:29:37.640

```
保持循环=真
同时保持循环：
    ＃做东西
    同时保持循环：
          #做一些其他的事情
          如果完成了doingstuff()：
              保持循环=假

```

或类似的东西。您可以在内循环中设置一个变量，并在内循环退出后立即在外循环中检查它，如果合适则中断。我有点喜欢 GOTO 方法，前提是你不介意使用愚人节的笑话模块——它不是 Pythonic，但它确实有意义。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2008-10-10T01:41:42.643

这不是最漂亮的方法，但在我看来，这是最好的方法。

```
def loop():
    while True:
    #snip: print out current state
        while True:
            ok = get_input("Is this ok? (y/n)")
            if ok == "y" or ok == "Y": return
            if ok == "n" or ok == "N": break
        #do more processing with menus and stuff 
```

我很确定您也可以在这里使用递归来解决问题，但我不知道这对您来说是否是一个不错的选择。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2012-11-06T14:02:32.670

如果两个条件都为真，为什么不继续循环呢？我认为这是一种更 Pythonic 的方式：

```
dejaVu = True

while dejaVu:
    while True:
        ok = raw_input("Is this ok? (y/n)")
        if ok == "y" or ok == "Y" or ok == "n" or ok == "N":
            dejaVu = False
            break 
```

不是吗？

祝一切顺利。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2010-04-12T11:33:15.763

将您的循环逻辑分解为一个迭代器，该迭代器产生循环变量并在完成后返回——这是一个简单的迭代器，它以行/列的形式排列图像，直到我们没有图像或无法放置它们：

```
def it(rows, cols, images):
    i = 0
    for r in xrange(rows):
        for c in xrange(cols):
            if i >= len(images):
                return
            yield r, c, images[i]
            i += 1 

for r, c, image in it(rows=4, cols=4, images=['a.jpg', 'b.jpg', 'c.jpg']):
    ... do something with r, c, image ... 
```

这样做的好处是将复杂的循环逻辑和处理...

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2020-05-22T05:38:20.853

> 没有办法从语言层面做到这一点。有些语言有一个 goto 其他语言有一个带参数的中断，python 没有。
> 
> 最好的选择是：
> 
> 1.  设置由外循环检查的标志，或设置外循环条件。
>     
>     
> 2.  将循环放在一个函数中，并使用 return 一次跳出所有循环。
>     
>     
> 3.  重新制定你的逻辑。

[归功于自 1987 年以来的程序员 Vivek Nagarajan](https://www.quora.com/How-do-I-break-out-of-a-specific-inner-or-outer-loop-in-python)

* * *

**使用功能**

```
def doMywork(data):
    for i in data:
       for e in i:
         return 
```

**使用标志**

```
is_break = False
for i in data:
   if is_break:
      break # outer loop break
   for e in i:
      is_break = True
      break # inner loop break 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-10-14T09:29:41.420

Python`while ... else`结构中有一个隐藏的技巧，可以用来模拟双重中断，而无需太多代码更改/添加。实质上，如果`while`条件为假，`else`则触发块。既不异常，`continue`也不`break`触发`else`阻塞。有关更多信息，请参阅“ [Python while 语句上的 Else 子句](https://stackoverflow.com/q/3295938/1548472)”或[Python 文档 on while (v2.7) 的](//docs.python.org/2.7/reference/compound_stmts.html#the-while-statement)答案。

```
while True:
    #snip: print out current state
    ok = ""
    while ok != "y" and ok != "n":
        ok = get_input("Is this ok? (y/n)")
        if ok == "n" or ok == "N":
            break    # Breaks out of inner loop, skipping else

    else:
        break        # Breaks out of outer loop

    #do more processing with menus and stuff 
```

唯一的缺点是您需要将双重中断条件移动到`while`条件中（或添加标志变量）。`for`循环也存在这种变化，`else`循环完成后触发块。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-05-12T19:55:43.807

将多个循环变成一个可破坏循环的简单方法是使用`numpy.ndindex`

```
for i in range(n):
  for j in range(n):
    val = x[i, j]
    break # still inside the outer loop!

for i, j in np.ndindex(n, n):
  val = x[i, j]
  break # you left the only loop there was! 
```

您确实必须索引到您的对象，而不是能够显式地遍历这些值，但至少在简单的情况下，它似乎比大多数建议的答案简单 2-20 倍。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-08-15T08:42:47.873

在这种情况下，正如其他人所指出的那样，功能分解是要走的路。Python 3 中的代码：

```
def user_confirms():
    while True:
        answer = input("Is this OK? (y/n) ").strip().lower()
        if answer in "yn":
            return answer == "y"

def main():
    while True:
        # do stuff
        if user_confirms():
            break 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-12-01T18:10:03.337

将迭代减少到单级循环的另一种方法是使用生成器，这也在[python 参考中指定](https://docs.python.org/3/library/itertools.html#itertools.product)

```
for i, j in ((i, j) for i in A for j in B):
    print(i , j)
    if (some_condition):
        break 
```

您可以将其扩展到循环的任意数量的级别

缺点是你不能再只打破一个级别。要么全有，要么全无。

另一个缺点是它不适用于 while 循环。我最初想在[Python 上发布这个答案 - `break` out of all loops](https://stackoverflow.com/questions/21293336/python-break-out-of-all-loops)但不幸的是，它作为这个的副本关闭了

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-06-13T09:26:52.737

我想提醒您，Python 中的函数可以在代码中间创建，并且可以透明地访问周围的变量以进行读取和 with`nonlocal`或`global`声明以进行写入。

所以你可以使用一个函数作为一个“可破坏的控制结构”，定义一个你想要返回的地方：

```
def is_prime(number):

    foo = bar = number

    def return_here():
        nonlocal foo, bar
        init_bar = bar
        while foo > 0:
            bar = init_bar
            while bar >= foo:
                if foo*bar == number:
                    return
                bar -= 1
            foo -= 1

    return_here()

    if foo == 1:
        print(number, 'is prime')
    else:
        print(number, '=', bar, '*', foo) 
```

* * *

```
>>> is_prime(67)
67 is prime
>>> is_prime(117)
117 = 13 * 9
>>> is_prime(16)
16 = 4 * 4 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-04-05T03:59:37.563

**通过使用函数：**

```
def myloop():
    for i in range(1,6,1):  # 1st loop
        print('i:',i)
        for j in range(1,11,2):  # 2nd loop
            print('   i, j:' ,i, j)
            for k in range(1,21,4):  # 3rd loop
                print('      i,j,k:', i,j,k)
                if i%3==0 and j%3==0 and k%3==0:
                    return  # getting out of all loops

myloop() 
```

尝试通过注释掉上面的代码来运行`return`。

**不使用任何功能：**

```
done = False
for i in range(1,6,1):  # 1st loop
    print('i:', i)
    for j in range(1,11,2):  # 2nd loop
        print('   i, j:' ,i, j)
        for k in range(1,21,4):  # 3rd loop
            print('      i,j,k:', i,j,k)
            if i%3==0 and j%3==0 and k%3==0:
                done = True
                break  # breaking from 3rd loop
        if done: break # breaking from 2nd loop
    if done: break     # breaking from 1st loop 
```

现在，首先按原样运行上述代码，然后尝试通过注释掉`break`从底部开始一次包含一个的每一行来运行。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2012-08-15T18:12:49.110

我来这里的原因是我有一个外循环和一个内循环，如下所示：

```
for x in array:
  for y in dont_use_these_values:
    if x.value==y:
      array.remove(x)  # fixed, was array.pop(x) in my original answer
      continue

  do some other stuff with x 
```

如您所见，它实际上不会转到下一个 x，而是会转到下一个 y。

我发现解决这个问题的方法只是遍历数组两次：

```
for x in array:
  for y in dont_use_these_values:
    if x.value==y:
      array.remove(x)  # fixed, was array.pop(x) in my original answer
      continue

for x in array:
  do some other stuff with x 
```

我知道这是 OP 问题的一个具体案例，但我发布它是希望它能帮助人们以不同的方式思考他们的问题，同时保持简单。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-03-21T22:45:58.040

尝试使用无限生成器。

```
from itertools import repeat
inputs = (get_input("Is this ok? (y/n)") for _ in repeat(None))
response = (i.lower()=="y" for i in inputs if i.lower() in ("y", "n"))

while True:
    #snip: print out current state
    if next(response):
        break
    #do more processing with menus and stuff 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2013-06-13T16:53:56.533

```
# this version uses a level counter to choose how far to break out

break_levels = 0
while True:
    # snip: print out current state
    while True:
        ok = get_input("Is this ok? (y/n)")
        if ok == "y" or ok == "Y":
            break_levels = 1        # how far nested, excluding this break
            break
        if ok == "n" or ok == "N":
            break                   # normal break
    if break_levels:
        break_levels -= 1
        break                       # pop another level
if break_levels:
    break_levels -= 1
    break

# ...and so on 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2013-06-13T17:15:18.810

```
# this version breaks up to a certain label

break_label = None
while True:
    # snip: print out current state
    while True:
        ok = get_input("Is this ok? (y/n)")
        if ok == "y" or ok == "Y":
            break_label = "outer"   # specify label to break to
            break
        if ok == "n" or ok == "N":
            break
    if break_label:
        if break_label != "inner":
            break                   # propagate up
        break_label = None          # we have arrived!
if break_label:
    if break_label != "outer":
        break                       # propagate up
    break_label = None              # we have arrived!

#do more processing with menus and stuff 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-05-02T15:58:52.613

这是一个似乎可行的实现：

```
break_ = False
for i in range(10):
    if break_:
        break
    for j in range(10):
        if j == 3:
            break_ = True
            break
        else:
            print(i, j) 
```

唯一的缺点是您必须`break_`在循环之前定义。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-10-19T01:44:36.907

如果不喜欢重构为函数，可能像下面这样的小技巧会做

添加了 1 个 break_level 变量来控制 while 循环条件

```
break_level = 0
# while break_level < 3: # if we have another level of nested loop here
while break_level < 2:
    #snip: print out current state
    while break_level < 1:
        ok = get_input("Is this ok? (y/n)")
        if ok == "y" or ok == "Y": break_level = 2 # break 2 level
        if ok == "n" or ok == "N": break_level = 1 # break 1 level 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-03-22T08:56:44.930

您可以定义一个变量（例如*break_statement*），然后在发生两次中断条件时将其更改为不同的值，并在 if 语句中使用它来中断第二个循环。

```
while True:
    break_statement=0
    while True:
        ok = raw_input("Is this ok? (y/n)")
        if ok == "n" or ok == "N": 
            break
        if ok == "y" or ok == "Y": 
            break_statement=1
            break
    if break_statement==1:
        break 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2019-03-05T11:44:35.987

# 两种方式的解决方案

举个例子：这两个矩阵是否相等/相同？
matrix1 和 matrix2 是相同大小、n、2 维矩阵。

**第一个解决方案**，*没有功能*

```
same_matrices = True
inner_loop_broken_once = False
n = len(matrix1)

for i in range(n):
    for j in range(n):

        if matrix1[i][j] != matrix2[i][j]:
            same_matrices = False
            inner_loop_broken_once = True
            break

    if inner_loop_broken_once:
        break 
```

* * *

**第二个解决方案**，*有一个功能*
这是我的案例的最终解决方案

```
def are_two_matrices_the_same (matrix1, matrix2):
    n = len(matrix1)
    for i in range(n):
        for j in range(n):
            if matrix1[i][j] != matrix2[i][j]:
                return False
    return True 
```

祝你今天过得愉快！

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2021-03-11T17:25:37.713

我个人会做的是使用一个布尔值，当我准备好打破外循环时切换。例如

```
while True:
    #snip: print out current state
    quit = False
    while True:
        ok = input("Is this ok? (y/n)")
        if ok.lower() == "y":
            quit = True
            break # this should work now :-)
        if ok.lower() == "n":
            quit = True
            break # This should work too :-)
    if quit:
        break
    #do more processing with menus and stuff 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-07-26T13:14:33.007

希望这会有所帮助：

```
x = True
y = True
while x == True:
    while y == True:
         ok = get_input("Is this ok? (y/n)") 
         if ok == "y" or ok == "Y":
             x,y = False,False #breaks from both loops
         if ok == "n" or ok == "N": 
             break #breaks from just one 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2022-01-08T20:43:22.837

对 OP 问题的改动很小。

```
break_2 = False
while True:
    #snip: print out current state
    if break_2: break
    while True:
        ok = get_input("Is this ok? (y/n)")
        if ok.lower() == "y": break_2 = True
        if break_2: break
        if ok.lower() == "n": break
    #do more processing with menus and stuff 
```

* * *

## 回答 #31

> 赞同：-3
> 
> 时间：2012-06-07T11:12:22.363

与之前的类似，但更紧凑。（布尔值只是数字）

```
breaker = False #our mighty loop exiter!
while True:
    while True:
        ok = get_input("Is this ok? (y/n)")
        breaker+= (ok.lower() == "y")
        break

    if breaker: # the interesting part!
        break   # <--- ! 
```

* * *

## 回答 #32

> 赞同：-3
> 
> 时间：2017-10-23T12:26:51.033

由于这个问题已成为进入特定循环的标准问题，因此我想以使用`Exception`.

尽管在多重循环结构中不存在名为“循环中断”的标签，但我们可以利用[用户定义的异常](https://docs.python.org/3/tutorial/errors.html#user-defined-exceptions)来中断我们选择的特定循环。考虑以下示例，让我们在 base-6 编号系统中打印最多 4 位的所有数字：

```
class BreakLoop(Exception):
    def __init__(self, counter):
        Exception.__init__(self, 'Exception 1')
        self.counter = counter

for counter1 in range(6):   # Make it 1000
    try:
        thousand = counter1 * 1000
        for counter2 in range(6):  # Make it 100
            try:
                hundred = counter2 * 100
                for counter3 in range(6): # Make it 10
                    try:
                        ten = counter3 * 10
                        for counter4 in range(6):
                            try:
                                unit = counter4
                                value = thousand + hundred + ten + unit
                                if unit == 4 :
                                    raise BreakLoop(4) # Don't break from loop
                                if ten == 30: 
                                    raise BreakLoop(3) # Break into loop 3
                                if hundred == 500:
                                    raise BreakLoop(2) # Break into loop 2
                                if thousand == 2000:
                                    raise BreakLoop(1) # Break into loop 1

                                print('{:04d}'.format(value))
                            except BreakLoop as bl:
                                if bl.counter != 4:
                                    raise bl
                    except BreakLoop as bl:
                        if bl.counter != 3:
                            raise bl
            except BreakLoop as bl:
                if bl.counter != 2:
                    raise bl
    except BreakLoop as bl:
        pass 
```

当我们打印输出时，我们永远不会得到任何单位位为 4 的值。在这种情况下，我们不会从任何循环中中断，因为`BreakLoop(4)`在同一个循环中引发并捕获。类似地，每当十位有 3 时，我们使用 . 进入第三个循环`BreakLoop(3)`。每当百位有 5 时，我们使用 进入第二个循环`BreakLoop(2)`，而当千位有 2 时，我们使用 进入第一个循环`BreakLoop(1)`。

简而言之，在内部循环中引发您的异常（内置或用户定义），并在您想要恢复控制的循环中捕获它。如果要中断所有循环，请在所有循环之外捕获异常。（我没有在示例中展示这种情况）。

* * *

## 回答 #33

> 赞同：-4
> 
> 时间：2018-03-06T17:12:51.307

我解决这个问题的方法是定义一个引用的变量来确定你是否突破到下一个级别。在此示例中，此变量称为“shouldbreak”。

```
Variable_That_Counts_To_Three=1
while 1==1:
    shouldbreak='no'
    Variable_That_Counts_To_Five=0
    while 2==2:
        Variable_That_Counts_To_Five+=1
        print(Variable_That_Counts_To_Five)
        if Variable_That_Counts_To_Five == 5:
            if Variable_That_Counts_To_Three == 3:
                shouldbreak='yes'
            break
    print('Three Counter = ' + str(Variable_That_Counts_To_Three))
    Variable_That_Counts_To_Three+=1
    if shouldbreak == 'yes':
        break

print('''
This breaks out of two loops!''') 
```

这可以很好地控制您希望程序中断的准确程度，允许您选择何时中断以及下降多少级别。

# asp.net - 允许用户在我的网络应用程序上创建自己的表单的最简单方法是什么？

> ID：189654
> 
> 赞同：3
> 
> 时间：2008-10-10T00:05:40.387
> 
> 标签：asp.net

我的 ASP.NET Web 应用程序需要支持用户创建自己的表单的能力，包括文本框、下拉菜单、带有某些逻辑的单选按钮（必填字段等）。是否有一些第三方工具已经针对这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T00:50:20.627

[DotNetNuke](http://www.dotnetnuke.com/)具有此功能，但是，您必须将您的站点设为 DNN 站点才能直接使用它。

不过，他们的系统非常适合您描述的场景，因为您通过将现有模块（想想用户控件）放置在页面的特定区域（中心、左侧、右侧）来构建页面，然后可以在这些区域内重新排列它们. 当然值得一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T00:25:32.343

我不知道它与您的系统集成的效果如何（如果有的话），但请查看[http://www.formassembly.com/](http://www.formassembly.com/) - 如果您需要，它可能会让您了解所涉及的内容自己做一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T01:26:54.920

可能不适合您想要做的事情，但以防万一您可能想查看[Wufoo](http://wufoo.com/)

它是一个在线表单构建器服务，但它是一个托管应用程序而不是一个库，因此可能不适合您的目的。虽然我认为我会发布它，但它很有帮助，因为它会生成一些非常好的表格。

# com - 来自 x86 程序集的 COM？

> ID：189669
> 
> 赞同：0
> 
> 时间：2008-10-10T00:16:16.013
> 
> 标签：com, x86, assembly

是否可以通过 x86 汇编语言调用 COM 对象？如果是这样，怎么做？

我为什么要这样做？假设我有两个没有源代码的程序——我只有二进制文件。其中一个实现了 COM 接口，另一个没有。我想将代码注入第一个程序以使用此 COM 接口调用第二个程序，这需要我使用 x86 程序集。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T00:18:05.837

当然这是可能的——实际上这就是 C/C++ 编译器所做的。

但是，看在上帝的份上，你为什么要这样做呢？如果它是为了教育价值，那么在直接 C 中手工完成 COM 的东西肯定会奏效。

* * *

鉴于更新的问题，我建议您将 COM 内容写入 DLL 并将该 DLL 注入您要修补的程序中，然后将简单的 x86 代码修补到程序中以调用执行繁重工作的 DLL。我不记得将 DLL 注入进程地址空间的技术，但至少有几个。AppInit 注册表设置（或类似的设置）就是其中之一。

但是，我认为将代码注入进程的大多数途径都被认为是安全漏洞（并且经常被恶意软件使用），因此我怀疑微软可能已经从更新的服务包中删除了许多（如果不是大部分（或全部））或操作系统版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T00:31:34.750

做你想做的最简单的方法可能是创建一个执行 COM 通信的 DLL，然后注入将强制其他应用程序加载 DLL 的代码。您可以使用 DLL 注入技术，也可以只编辑应用程序本身的程序集以调用 LoadLibrary/GetProcAddress 等。

编辑：顺便说一句，我发现[OllyDbg](http://www.ollydbg.de/)是编辑现有应用程序程序集的好工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T00:31:46.467

我必须同意 Mike B 的观点。这听起来像是你不想做的事情，但是......

为了扩展 Mike B 所说的可能，最低级别的 COM 是 ABI（应用程序二进制接口）；即它定义了COM对象在内存中的布局，所有的COM对象都必须遵循这个布局。COM 对象（在 x86 平台上）碰巧在内存中布局，就像 Visual C++ 编译器（和大多数其他编译器）在内存中布局对象一样。这使得 C++（以及 C，需要付出一些额外的努力）成为使用 COM 的便捷选择。也就是说，我从未见过有人在汇编中尝试过这个，但是 CodeProject 上有一个关于在 C 中做 COM 的教程。那里的概念应该很容易转化为汇编：

[CodeProject：普通 C 语言中的 COM](http://www.codeproject.com/KB/COM/com_in_c1.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T00:23:51.863

是的——COM 主要被设计为**二进制 API**，尽管它可以通过 C/C++ 轻松实现。但是，该规范不是针对 C 或 C++ 的。

你可以参考原始的 COM 规范，这里有一份副本[，](http://www.daimi.au.dk/~datpete/COT/COM_SPEC/html/com_spec.html)它也必须埋在微软网站的某个地方。

**更新**：您的用例似乎不需要直接使用程序集，可以使用任何代码注入技术。如何编译要注入的代码与注入它的方式不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T00:53:51.243

您可以经历[艰难的道路](http://en.wikipedia.org/wiki/DLL_injection)，也可以寻找[经过测试的真实](http://research.microsoft.com/sn/detours/)解决方案。
它们都不需要汇编语言。

# sql - 数据库本地化

> ID：189680
> 
> 赞同：10
> 
> 时间：2008-10-10T00:21:54.397
> 
> 标签：sql, database, localization

如果以下问题可能有更好/不同/常见的解决方案，我正在寻找意见：

* * *

我有一个产品数据库，其中包含英文（此应用程序的默认语言）产品名称，如果可用，我需要名称的翻译。

目前我有这个设置：

产品表

```
CREATE TABLE products
(
  id serial NOT NULL,
  "name" character varying(255) NOT NULL,
  CONSTRAINT products_pkey PRIMARY KEY (id)
) 
```

和产品本地化表

```
CREATE TABLE products_l10n
(
  product_id serial NOT NULL,
  "language" character(2) NOT NULL,
  "name" character varying(255) NOT NULL,
  CONSTRAINT products_l10n_pkey PRIMARY KEY (product_id, language),
  CONSTRAINT products_l10n_product_id_fkey FOREIGN KEY (product_id)
      REFERENCES products (id) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE
) 
```

我使用以下查询检索本地化产品列表（在本例中为德语），并回退到默认英文名称：

```
SELECT p.id, COALESCE(pl.name, p.name) 
from products p LEFT 
JOIN products_l10n pl ON p.id = pl.product_id AND language = 'de'; 
```

SQL 代码是 postgres 方言。数据存储为 UTF-8。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T00:28:51.497

对我来说看上去很好。我可能会改变的一件事是您处理语言的方式：这可能应该是一个单独的表格。因此，您将拥有：

```
CREATE TABLE products_l10n
(
  product_id serial NOT NULL,
  language_id int NOT NULL,
  "name" character varying(255) NOT NULL,
  CONSTRAINT products_l10n_pkey PRIMARY KEY (product_id, language),
  CONSTRAINT products_l10n_product_id_fkey FOREIGN KEY (product_id)
      REFERENCES products (id) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE
  CONSTRAINT products_l10n_language_id_fkey FOREIGN KEY (language_id)
      REFERENCES languages (id) MATCH SIMPLE
      ON UPDATE CASCADE ON DELETE CASCADE
)

CREATE TABLE languages
)
  id serial not null
  "language" character(2) NOT NULL
) 
```

除此之外，我认为您已经找到了最好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T00:34:38.427

看起来不错 - 类似于我首选的本地化技术 - 宽字符（日语）呢？我们总是使用 nvarchar 来处理它。

然而，在我们的国际采购业务中，我们实际上发现，产品的国际边界并没有一致性，因为每个国家的供应商不同，所以我们将界面国际化/本地化，但数据库完全不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T00:57:49.707

我可以提供的唯一变化是您可能还想包括国家/方言的可能性；例如，不要只使用英语 (en)，而是使用英语 US (en-US)。这样你就可以解释所有的变化（例如，英国的拼写，法裔加拿大人可能与在法国说的法语有差异，等等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T00:33:55.387

在我看来很体面。

显然，您应该将本地化名称放入 Unicode 列，您可以选择将英语默认值放入 ASCII 字段（假设数据库支持）。最好只做 Unicode 并“忘记”它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T21:40:46.470

其他人没有提到的唯一复杂因素是代码集——你能处理希伯来语、阿拉伯语、俄语、汉语、日语吗？如果一切都是Unicode，你只需要担心GB18030（中文），它是（IIUC）Unicode的超集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-04T07:55:16.570

在处理这类事情时，我使用构建一个根本不包含名称的产品表，以及一个只包含名称的 product_translation 表（显然还有更多）。

然后我结束了这种查询：

```
选择
    i.id,
    i.价格，
    它.标签
从
    我的项目
    LEFT JOIN items_trans 它
        ON i.id=it.item_id AND it.lang_id=(
            选择 lang_id
            FROM items_trans
            WHERE item_id=i.id
            订购方式
                (lang_id=1) DESC,
                (lang_id=0) DESC
            限制 1
        )

```

你怎么看 ？

# sql-server - 如何使用 SqlBulkCopy 保持行顺序？

> ID：189694
> 
> 赞同：3
> 
> 时间：2008-10-10T00:28:55.537
> 
> 标签：sql-server, excel, import, export, sqlbulkcopy

我正在使用 SqlBulkCopy 以编程方式将数据从 Excel 导出到 SQL Server 2005。它很好用，我唯一的问题是它没有保留我在 Excel 文件中的行序列。我没有要排序的列，我只想按照它们在 Excel 电子表格中出现的顺序插入记录。

我无法修改 Excel 文件，必须使用我所拥有的。按任何现有列排序将破坏序列。

请帮忙。

PS 最终将 ID 列插入电子表格，看起来在导出/导入期间无法保持订单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T00:44:24.227

我不认为 SQL 指定或保证行排序，除非您使用“ORDER BY”子句。

来自 Bill Vaughn 的一篇文章（[http://betav.com/blog/billva/2008/08/sql_server_indexing_tips_and_t.html](http://betav.com/blog/billva/2008/08/sql_server_indexing_tips_and_t.html)）：

> 使用 Order By：即使表具有聚集索引（以物理顺序存储数据），SQL Server 也不保证行将按该（或任何特定）顺序返回，除非使用 ORDER BY 子句。

另一个信息链接：

[http://sqlblogcasts.com/blogs/simons/archive/2007/08/21/What-is-the-position-of-a-row--.aspx](http://sqlblogcasts.com/blogs/simons/archive/2007/08/21/What-is-the-position-of-a-row--.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-28T22:31:19.983

经过大量研究后，显然没有办法使用 Microsoft 提供的 Bulk Insert 命令来保留行顺序。您必须自己将 ID 列直接添加到导入文件中，使用 shell 或其他外部脚本，或者不这样做。微软似乎需要（而且很容易）添加一个功能，但是在他们十多年没有任何东西之后，它不会发生。

然而，我需要在导入后保留导入文件中的实际记录顺序，因为如果一组列具有相同的值，较高的记录将取代较低的记录。

于是我走了一条不同的路。我的限制是：

*   我根本无法更改源文件。（并开创了一个不好的先例！）
*   我无法使用外部脚本。太复杂。它必须是一个简单的基于 T-Sql 的解决方案，没有 CMD 执行。这需要进入一个单一的程序，以便它可以自动化。

我喜欢使用 Powershell 为每一行创建有序插入语句，然后在 Sql 中运行的逻辑。它本质上是将每条记录排队等待单独插入而不是批量插入。是的，它会起作用，但它也会很慢。我经常有包含 500K+ 行的文件。我需要快速的东西。

所以我遇到了 XML。将文件直接批量上传到单个 XML 变量中。这将保留记录的顺序，因为每个记录都添加到 XML。然后解析 XML 变量并将结果插入到表中，同时添加一个标识列。

*假设导入文件是标准文本文件，每条记录以换行符结尾 (Char(13)+Char(10))*

我的方法有两个步骤：

1.  执行 IMPORT SQL 语句（使用 OPENROWSET），用 XML 标记封装每条记录。将结果捕获到 XML 变量中。

2.  通过 XML 标记将变量解析为表，添加递增的 [ID] 列。

    ```
    ---------------------------------
    Declare @X xml;
    ---------------------------------
    SELECT @X=Cast('<X>'+Replace([BulkColumn],Char(13)+Char(10),'</X><X>')+'</X>' as XML)
    FROM OPENROWSET (BULK N'\\FileServer\ImportFolder\ImportFile_20170120.csv',SINGLE_CLOB) T
    ---------------------------------
    SELECT [Record].[X].query('.').value('.','varchar(max)') [Record]
    ,ROW_NUMBER() OVER (ORDER BY (SELECT 100)) [ID]
    --Into #TEMP 
    FROM @X.nodes('X') [Record](X);
    --------------------------------- 
    ```

    *   XML 标记替换每个换行符。

    *   如果文件以换行结尾，这将导致在末尾添加一个空白行。只需删除最后一行。

我使用动态 sql 将其写入我的过程中，因此我可以传入 FileName 并将 ID 设置为从 1 或 0 开始（以防有标题行）。

我能够在大约 5 秒内针对 300K 记录的文件运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T00:41:15.980

如果您可以将 excel 电子表格保存为 CSV，则很容易使用任何脚本语言生成一个 INSERT 语句列表，这些语句将以与电子表格完全相同的顺序执行。这是 Groovy 中的一个简单示例，但任何脚本语言都可以轻松地做到这一点，如果不是更容易的话：

```
def file1 = new File('c:\\temp\\yourSpreadsheet.csv')
def file2 = new File('c:\\temp\\yourInsertScript.sql')

def reader = new FileReader(file1)
def writer = new FileWriter(file2)

reader.transformLine(writer) { line ->
    fields =  line.split(',')

    text = """INSERT INTO table1 (col1, col2, col3) VALUES ('${fields[0]}', '${fields[1]}', '${fields[2]}');"""

} 
```

然后，您可以针对您的数据库执行“yourInsertScript.sql”，您的订单将与您的电子表格相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T00:44:58.780

您还可以在表中定义一个在数据加载期间自动递增的标识列。这样，当您希望记录再次以相同顺序排列时，您可以对其进行排序。

# tsql - 在多 tempdb 环境中测试临时表是否存在？

> ID：189708
> 
> 赞同：0
> 
> 时间：2008-10-10T00:32:11.503
> 
> 标签：tsql, sybase, temp-tables

是否有任何方法可以确定是否在会话中创建了特定的临时表而不引用创建它的 tempdb 数据库？用户在登录时被分配到特定的 tempdb，所以我不知道他们将使用哪个 tempdb。

我不需要指定一个 tempdb 来从临时表中选择数据，所以我肯定可以看到该表是否存在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T14:13:20.200

您可以使用 object_id 检查是否存在临时对象：

```
SELECT object_id('#tmpTable') 
```

如果需要，您可以指定要使用的 tempdb，但您不必：

```
SELECT object_id('tempdb..#tmpTable') 
```

值得注意的是，这也适用于全局临时表：

```
SELECT object_id('##tmpTable') 
```

为了使脚本可以重新运行而不必在最后执行 DROP TABLE，我总是在创建临时表之前进行检查和删除。我经常在开发 SQL 代码时留下创建的表。

```
IF NULLIF(object_id('#tmpTable'), 0) IS NOT NULL DROP TABLE #tmpTable
CREATE TABLE #tmpTable (
    id int,
    col1 varchar(100)
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T08:00:28.963

在我看来，您不应该在这里使用临时表......这些看起来更像是常规表（可能带有用户标识符）。这里的场景是什么？

请注意，以这种方式使用临时表可能会对优化器/查询缓存造成严重破坏——它必须进行大量的重新编译，因为 #FOO 的含义在每次调用时都会发生很大变化。

# c - 什么是蹦床功能？

> ID：189725
> 
> 赞同：113
> 
> 时间：2008-10-10T00:39:37.480
> 
> 标签：c, language-agnostic, programming-languages, trampolines

在最近的工作讨论中，有人提到了蹦床功能。

我已阅读[Wikipedia](http://en.wikipedia.org/wiki/Trampoline_(computers))上的描述。给出功能的一般概念就足够了，但我想要更具体的东西。

你有一个简单的代码片段来说明蹦床吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-01-28T23:20:01.010

如维基百科所述，还有 LISP 的“蹦床”感觉：

> 在某些 LISP 实现中使用的蹦床是一个循环，它迭代地调用 thunk-returning 函数。一个蹦床就足以表达一个程序的所有控制转移；如此表达的节目是蹦床式或“蹦床式”；将程序转换为蹦床风格就是蹦床。Trampolined 函数可用于在面向堆栈的语言中实现尾递归函数调用

假设我们正在使用 Javascript，并且想要以连续传递样式编写简单的斐波那契函数。我们这样做的原因无关紧要——例如将 Scheme 移植到 JS，或者使用 CPS，无论如何我们都必须使用它来调用服务器端函数。

所以，第一次尝试是

```
function fibcps(n, c) {
    if (n <= 1) {
        c(n);
    } else {
        fibcps(n - 1, function (x) {
            fibcps(n - 2, function (y) {
                c(x + y)
            })
        });
    }
} 
```

但是，`n = 25`在 Firefox 中运行它会出现错误“递归过多！”。现在这正是蹦床解决的问题（Javascript 中缺少尾调用优化）。与其对函数进行（递归）调用，不如让我们`return`使用指令（thunk）来调用该函数，并在循环中进行解释。

```
function fibt(n, c) {
    function trampoline(x) {
        while (x && x.func) {
            x = x.func.apply(null, x.args);
        }
    }

    function fibtramp(n, c) {
        if (n <= 1) {
            return {func: c, args: [n]};
        } else {
            return {
                func: fibtramp,
                args: [n - 1,
                    function (x) {
                        return {
                            func: fibtramp,
                            args: [n - 2, function (y) {
                                return {func: c, args: [x + y]}
                            }]
                        }
                    }
                ]
            }
        }
    }

    trampoline({func: fibtramp, args: [n, c]});
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-08-12T10:29:49.510

让我添加几个使用不同语言的蹦床实现的阶乘函数示例：

斯卡拉：

```
sealed trait Bounce[A]
case class Done[A](result: A) extends Bounce[A]
case class Call[A](thunk: () => Bounce[A]) extends Bounce[A]

def trampoline[A](bounce: Bounce[A]): A = bounce match {
  case Call(thunk) => trampoline(thunk())
  case Done(x) => x
}

def factorial(n: Int, product: BigInt): Bounce[BigInt] = {
    if (n <= 2) Done(product)
    else Call(() => factorial(n - 1, n * product))
}

object Factorial extends Application {
    println(trampoline(factorial(100000, 1)))
} 
```

爪哇：

```
import java.math.BigInteger;

class Trampoline<T> 
{
    public T get() { return null; }
    public Trampoline<T>  run() { return null; }

    T execute() {
        Trampoline<T>  trampoline = this;

        while (trampoline.get() == null) {
            trampoline = trampoline.run();
        }

        return trampoline.get();
    }
}

public class Factorial
{
    public static Trampoline<BigInteger> factorial(final int n, final BigInteger product)
    {
        if(n <= 1) {
            return new Trampoline<BigInteger>() { public BigInteger get() { return product; } };
        }   
        else {
            return new Trampoline<BigInteger>() { 
                public Trampoline<BigInteger> run() { 
                    return factorial(n - 1, product.multiply(BigInteger.valueOf(n)));
                } 
            };
        }
    }

    public static void main( String [ ] args )
    {
        System.out.println(factorial(100000, BigInteger.ONE).execute());
    }
} 
```

C（不幸没有大数字实现）：

```
#include <stdio.h>

typedef struct _trampoline_data {
  void(*callback)(struct _trampoline_data*);
  void* parameters;
} trampoline_data;

void trampoline(trampoline_data* data) {
  while(data->callback != NULL)
    data->callback(data);
}

//-----------------------------------------

typedef struct _factorialParameters {
  int n;
  int product;
} factorialParameters;

void factorial(trampoline_data* data) {
  factorialParameters* parameters = (factorialParameters*) data->parameters;

  if (parameters->n <= 1) {
    data->callback = NULL;
  }
  else {
    parameters->product *= parameters->n;
    parameters->n--;
  }
}

int main() {
  factorialParameters params = {5, 1};
  trampoline_data t = {&factorial, &params};

  trampoline(&t);
  printf("\n%d\n", params.product);

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-10-10T00:50:32.420

我将举一个我在在线游戏的反作弊补丁中使用的示例。

我需要能够扫描游戏加载的所有文件以进行修改。因此，我发现最可靠的方法是对 CreateFileA 使用蹦床。所以当游戏启动时，我会使用 GetProcAddress 找到 CreateFileA 的地址，然后我会修改函数的前几个字节并插入汇编代码，这些代码会跳转到我自己的“蹦床”函数，在那里我会做一些事情，并且然后我会在我的 jmp 代码之后跳回到 CreateFile 中的下一个位置。能够可靠地做到这一点比这要复杂一些，但基本概念只是挂钩一个函数，强制它重定向到另一个函数，然后跳回原始函数。

编辑：微软有一个你可以查看的此类事物的框架。所谓[的弯路](http://research.microsoft.com/sn/detours/)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-07-10T21:11:15.317

我目前正在尝试为 Scheme 解释器实现尾调用优化的方法，所以目前我正试图弄清楚蹦床对我来说是否可行。

据我了解，它基本上只是蹦床函数执行的一系列函数调用。每个函数称为 thunk 并返回计算的下一步，直到程序终止（空继续）。

这是我为提高对蹦床的理解而编写的第一段代码：

```
#include <stdio.h>

typedef void *(*CONTINUATION)(int);

void trampoline(CONTINUATION cont)
{
  int counter = 0;
  CONTINUATION currentCont = cont;
  while (currentCont != NULL) {
    currentCont = (CONTINUATION) currentCont(counter);
    counter++;
  }
  printf("got off the trampoline - happy happy joy joy !\n");
}

void *thunk3(int param)
{
  printf("*boing* last thunk\n");
  return NULL;
}

void *thunk2(int param)
{
  printf("*boing* thunk 2\n");
  return thunk3;
}

void *thunk1(int param)
{
  printf("*boing* thunk 1\n");
  return thunk2;
}

int main(int argc, char **argv)
{
  trampoline(thunk1);
} 
```

结果是：

```
meincompi $ ./trampoline 
*boing* thunk 1
*boing* thunk 2
*boing* last thunk
got off the trampoline - happy happy joy joy ! 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-10T01:22:22.777

这是嵌套函数的示例：

```
#include <stdlib.h>
#include <string.h>
/* sort an array, starting at address `base`,
 * containing `nmemb` members, separated by `size`,
 * comparing on the first `nbytes` only. */
void sort_bytes(void *base,  size_t nmemb, size_t size, size_t nbytes) {
    int compar(const void *a, const void *b) {
        return memcmp(a, b, nbytes);
    }
    qsort(base, nmemb, size, compar);
} 
```

`compar`不能是外部函数，因为它使用`nbytes`，仅在`sort_bytes`调用期间存在。在某些架构上，一个小的存根函数——蹦床——是在运行时生成的，它包含*当前*调用`sort_bytes`. 调用时，它会跳转到`compar`代码，并传递该地址。

PowerPC 等架构不需要这种混乱，其中 ABI 指定函数指针实际上是一个“胖指针”，一个包含指向可执行代码的指针和另一个指向数据的指针的结构。但是，在 x86 上，函数指针只是一个指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T23:31:08.150

对于 C，蹦床将是一个函数指针：

```
size_t (*trampoline_example)(const char *, const char *);
trampoline_example= strcspn;
size_t result_1= trampoline_example("xyzbxz", "abc");

trampoline_example= strspn;
size_t result_2= trampoline_example("xyzbxz", "abc"); 
```

编辑：编译器会隐式生成更深奥的蹦床。一种这样的用途是跳转表。（虽然你开始尝试生成复杂的代码，但显然有更复杂的代码。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-02T18:32:46.713

既然 C# 有[Local Functions](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/local-functions)，[保龄球游戏编码 kata](http://butunclebob.com/ArticleS.UncleBob.TheBowlingGameKata)可以用蹦床优雅地解决：

```
using System.Collections.Generic;
using System.Linq;

class Game
{
    internal static int RollMany(params int[] rs) 
    {
        return Trampoline(1, 0, rs.ToList());

        int Trampoline(int frame, int rsf, IEnumerable<int> rs) =>
              frame == 11             ? rsf
            : rs.Count() == 0         ? rsf
            : rs.First() == 10        ? Trampoline(frame + 1, rsf + rs.Take(3).Sum(), rs.Skip(1))
            : rs.Take(2).Sum() == 10  ? Trampoline(frame + 1, rsf + rs.Take(3).Sum(), rs.Skip(2))
            :                           Trampoline(frame + 1, rsf + rs.Take(2).Sum(), rs.Skip(2));
    }
} 
```

该方法`Game.RollMany`通过多次滚动调用：如果没有备用或罢工，通常为 20 次滚动。

第一行立即调用蹦床函数：`return Trampoline(1, 0, rs.ToList());`. 这个局部函数递归地遍历 rolls 数组。本地函数（蹦床）允许以两个附加值开始遍历：以`frame`1 和`rsf`（到目前为止的结果）0 开始。

在本地函数中，有一个处理五种情况的三元运算符：

*   游戏在第 11 帧结束：返回到目前为止的结果
*   如果没有更多的掷骰，游戏结束：返回到目前为止的结果
*   Strike：计算frame score，继续遍历
*   Spare：计算frame score，继续遍历
*   正常分数：计算帧分数并继续遍历

通过再次调用蹦床来继续遍历，但现在使用更新的值。

更多信息，请搜索：“[尾递归累加器](https://duckduckgo.com/?q=tail%20recursion%20accumulator&atb=v189-6&ia=web)”。请记住，编译器不会优化尾递归。因此，尽管这个解决方案可能很优雅，但它可能不会是禁食的。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-11-08T04:23:44.020

```
typedef void* (*state_type)(void);
void* state1();
void* state2();
void* state1() {
  return state2;
}
void* state2() {
  return state1;
}
// ...
state_type state = state1;
while (1) {
  state = state();
}
// ... 
```

# multithreading - 了解更多关于命令式并发编程的最佳方式是什么？

> ID：189726
> 
> 赞同：5
> 
> 时间：2008-10-10T00:40:04.983
> 
> 标签：multithreading, concurrency

最近不得不编写我的第一个“正确的”多线程代码，并意识到我对“命令式”（即 C++/C#/Java 等使用的并发模型）并发编程技术知之甚少。

有什么资源（书籍和在线教程等）可以更多地了解这个编程领域？

注意：我不是在询问可以说更好的并发模型（Erlang 的消息传递或 Clojure 的 STM），只是命令式语言中使用的范例。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T12:11:03.563

[Patterns for Parallel Porgramming](http://www.justsoftwaresolutions.co.uk/reviews/patterns_for_parallel_programming_review.html)是一本关于并发编程技术的好书。它使用 Java 线程、C 中的 OpenMP 和 C 中的 MPI 作为示例。

几乎所有关于多线程编程的好书都应该涵盖您提到的任何语言的一般原则。例如，我在[C++ Concurrency in Action](http://www.manning.com/williams/)中介绍了这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-20T03:24:02.390

[Java Concurrency in Practice](http://www.javaconcurrencyinpractice.com/)是本主题最平易近人、最全面的概述之一，尤其是在您使用 Java 的情况下（尽管我认为即使您不使用它也很有用）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T00:46:49.273

Doug Lea 的[Concurrent Programming in Java](https://rads.stackoverflow.com/amzn/click/com/0201310090)是一本关于该主题的优秀书籍（尽管它当然是特定于 Java 的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-07T15:18:59.693

您可能会发现我的[Java Concurrency refcard](http://refcardz.dzone.com/refcardz/core-java-concurrency)是针对 Java 特定问题的有用简短参考。

# c# - 工厂类 - 我应该在这里用数据填充我的对象吗？

> ID：189733
> 
> 赞同：0
> 
> 时间：2008-10-10T00:43:46.427
> 
> 标签：c#, .net, factory

我正在创建一个将构造并返回一个对象的工厂类。我通常会在数据访问层做所有的数据工作，但我认为我无法达到我的目标并且仍然这样做。我想要做的是使用 SQLDataReader 快速读取数据信息并填充要从工厂返回的对象。这是一个愚蠢的想法吗？有更好的方法吗？如果可能的话，我宁愿不只从 DAL 返回一个 DataSet，还是性能与可维护性的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T01:13:44.493

在大多数情况下，这是一个好主意，因为这种方式提供了两个主要好处：

1.  这样您就可以将数据访问和业务逻辑分开，这意味着如果您更改数据库设计，则不需要更改上层算法。

2.  从 OO 的角度来看，您正在将一些纯数据转换为对象，并且还可能向对象添加行为，这使得代码更易于维护和重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T00:48:02.563

如果您确定要使用从 SQLDataReader 加载的所有数据，那么是的，您可以在工厂施工时进行。但是，如果数据集有很多字段，而只会使用其中的一小部分，那么在调用访问器时按需加载数据会更好地利用资源。

就是说，我建议您在手头有所有“零件”时将其装入工厂，如果不完全正确，您就会知道需要修复什么。始终从可能可行的最简单的事情开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T01:20:35.463

我会说这取决于您对工厂的预期用途。如果这是您的数据访问层上的工厂，它将用于使用数据库中的数据填充业务对象，那么是的，这就是这样做的地方。（[IRepository](http://mikehadlow.blogspot.com/2008/03/using-irepository-pattern-with-linq-to.html)模式是这样的......有点）。

如果您的工厂不打算住在您的数据访问代码附近，我会将它们分开。记住[单一职责原则](http://davidhayden.com/blog/dave/archive/2005/05/29/1066.aspx)：对象应该只有一个改变的理由。如果工厂只是用数据填充对象，那么这是一个合适的用途，但是如果它除了做其他事情之外还用数据填充对象，那么最好不要添加数据东西。

无论您采用哪种方式，都需要权衡取舍，所以通常我喜欢尽可能长时间地保持对象尽可能简单。

# python - Google App Engine 和 404 错误

> ID：189751
> 
> 赞同：38
> 
> 时间：2008-10-10T00:51:00.140
> 
> 标签：python, google-app-engine, http-status-code-404

我已经使用在其他地方找到的提示在 GAE 上设置了一个静态网站，但无法弄清楚如何返回 404 错误。我的 app.yaml 文件看起来像

```
- url: (.*)/
  static_files: static\1/index.html
  upload: static/index.html

- url: /
  static_dir: static 
```

将所有静态 html/jpg 文件存储在静态目录下。以上适用于存在的文件，但如果不存在则返回空长度文件。答案可能是编写一个 python 脚本来返回一个 404 错误，但是你如何设置东西来为存在的静态文件提供服务，但为不存在的文件运行脚本呢？

以下是在开发应用程序服务器上获取不存在的文件 (nosuch.html) 的日志：

```
ERROR    2008-11-25 20:08:34,084 dev_appserver.py] Error encountered reading file "/usr/home/ctuffli/www/tufflinet/static/nosuch.html":
[Errno 2] No such file or directory: '/usr/home/ctuffli/www/tufflinet/static/nosuch.html'
INFO     2008-11-25 20:08:34,088 dev_appserver.py] "GET /nosuch.html HTTP/1.1" 404 - 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-10T02:36:02.923

您需要注册一个包罗万象的脚本处理程序。将此附加到 app.yaml 的末尾：

```
- url: /.*
  script: main.py 
```

在 main.py 中，您需要输入以下代码：

```
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app

class NotFoundPageHandler(webapp.RequestHandler):
    def get(self):
        self.error(404)
        self.response.out.write('<Your 404 error html page>')

application = webapp.WSGIApplication([('/.*', NotFoundPageHandler)],
                                     debug=True)

def main():
    run_wsgi_app(application)

if __name__ == "__main__":
    main() 
```

换成`<Your 404 error html page>`有意义的东西。或者更好地使用模板，您可以在此处阅读如何执行[此](http://code.google.com/appengine/docs/gettingstarted/templates.html)操作。

如果您在设置时遇到问题，请告诉我。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-09-15T21:50:05.000

谷歌应用引擎现在有[自定义错误响应](https://cloud.google.com/appengine/docs/python/config/appconfig?csw=1#Python_app_yaml_Custom_error_responses)

所以你现在可以在你的 app.yaml 中添加一个 error_handlers 部分，如下例所示：

```
error_handlers:

- file: default_error.html

- error_code: over_quota
    file: over_quota.html 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T03:08:55.270

在不需要任何 CPU 周期的情况下执行此操作的一种非常简单的方法是将此处理程序放在 app.yaml 的底部

```
- url: /.*
    static_files: views/404.html
    upload: views/404.html 
```

然后，这允许您将静态 404.html 文件放置在您的视图目录中。不需要 python 处理程序。您的 app.yaml 中未处理的任何内容都会受到影响。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-02T11:37:26.043

您可以创建一个函数来处理任何状态代码的错误。你的情况是 404，定义一个这样的函数：

```
def Handle404(request, response, exception):
     response.out.write("Your error message") 
     response.set_status(404)` 
```

您可以在函数中传递任何内容 - HTML / 纯文本 / 模板`response.out.write`。现在，在您的声明之后添加以下`app`声明。

`app.error_handlers[404] = Handle404`

这对我有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-03T15:38:51.897

`webapp2`提供`error_handlers`可用于提供自定义错误页面的字典。下面的例子：

```
def handle_404(request, response, exception):
    logging.warn(str(exception))
    response.set_status(404)
    h = YourAppBaseHandler(request, response)
    h.render_template('notfound')

def handle_500(request, response, exception):
    logging.error(str(exception))
    response.set_status(500)
    h = YourAppBaseHandler(request, response)
    h.render_template('servererror')

app = webapp2.WSGIApplication([
    webapp2.Route('/', MainHandler, name='home')
    ], debug=True)
app.error_handlers[404] = handle_404
app.error_handlers[500] = handle_500 
```

更多详细信息请参见`webapp2`的文档页面：[http ://webapp-improved.appspot.com/guide/app.html#error-handlers](http://webapp-improved.appspot.com/guide/app.html#error-handlers)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-28T09:56:02.043

dev_appserver 已经为与映射不匹配或匹配映射但不存在的任何内容返回 404 响应。404 响应本身没有正文，但它仍然是 404：

```
$ wget -O - http://127.0.0.1:8080/foo
--2010-10-28 10:54:51--  http://127.0.0.1:8080/foo
Connecting to 127.0.0.1:8080... connected.
HTTP request sent, awaiting response... 404 
2010-10-28 10:54:51 ERROR 404: (no description).

$ wget -O - http://127.0.0.1:8080/foo/
--2010-10-28 10:54:54--  http://127.0.0.1:8080/foo/
Connecting to 127.0.0.1:8080... connected.
HTTP request sent, awaiting response... 404 
2010-10-28 10:54:54 ERROR 404: (no description). 
```

如果您想返回一个更用户友好的错误页面，请遵循 jonmiddleton 的建议并指定自定义 404 页面。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-04T01:06:44.697

我已经查看了上述所有给出的答案，并在最后使用以下作为最通用的 404 解决方案：

在末尾添加此链接`app.yaml`

```
- url: /(.*) 
  script: 404.app 
```

并`404.py`使用以下内容创建

```
import webapp2
from google.appengine.ext.webapp import template

class NotFound(webapp2.RequestHandler):
  def get(self):
    self.error(404)
    self.response.out.write(template.render('404.html', {}))

app = webapp2.WSGIApplication([
    ('/.*', NotFound)
], debug=True) 
```

这将显示`404.html`带有 404 错误代码的文件内容。

该解决方案的优点是简单、行为的正确性和灵活性，因为它允许使用静态`404.html`文件作为错误页面内容。

我还想对上面建议的一些解决方案提出警告。

*   `Custom Error Responses`不适用于 404 错误
*   也不要使用静态文件，因为它们会返回 200 而不是 404 错误。这可能会导致很多头痛。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-01T21:47:10.990

我无法评论 jonmiddleton 的回答，但从外观上看，自定义错误响应是针对 App 引擎特定错误的。我看不到指定自定义 404 页面的方法。

Django让你[指定](http://docs.djangoproject.com/en/dev/topics/http/urls/#handler404)一个。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-13T08:13:53.567

我的方法是在我放在最后一个处理程序中处理 404 和永久重定向。当我重新设计和应用程序并重命名/替换 url 时，这很有用：

```
app = webapp2.WSGIApplication([
    ...
    ...
    ('/.*', ErrorsHandler)
], debug=True)

class ErrorsHandler(webapp2.RequestHandler):
    def get(self):
        p = self.request.path_qs
        if p in ['/index.html', 'resources-that-I-removed']:  
            return self.redirect('/and-substituted-with-this', permanent=True)
        else: 
            self.error(404)
            template = jinja_environment.get_template('404.html')
            context =  {
                'page_title': '404',
            }
            self.response.out.write(template.render(context)) 
```

# .net - .NET 应用程序可以编译为本机吗？

> ID：189757
> 
> 赞同：8
> 
> 时间：2008-10-10T00:55:13.767
> 
> 标签：.net, native, compilation, machine-code

只是想知道 .NET 应用程序是否可以提前编译为本机代码？即使可以，我也不打算这样做；我只是好奇。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T00:57:19.393

您可以使用 NGen 提前编译它，但这仍然取决于 .NET 框架。Remotesoft 的 Salamander（一个商业应用程序）可以制作一个无框架的应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T01:12:48.910

您可以将 IL 编译为本机二进制文件。有些产品可以做到这一点。

更大的问题是你应该...

**如果要删除所有 dot net 依赖项以在没有 dot net 的情况下运行**

基本上，这些产品正在做的是预编译到机器级别（通常是 x86），然后在您的 exe 中静态包含所有必需的库。这通常会导致一个巨大的 exe。而且，更重要的是，您现在的目标机器上并没有真正的运行时。您拥有本机编译器选择合并的运行时的一部分。

**如果您只想获得更快的 JIT 时间**

您也可以使用 NGen 将其编译为本机二进制文件，但您仍然拥有 dot net 上的所有依赖项。目标机器仍然需要框架等。

但是，当你 ngen 你失去了应用程序自动升级到 64 位的能力。如果您的应用程序是预编译的，您必须强制使用一种模式。如果用户在 64 位机器上运行，则您的 IL 代码将被提升（除非您将其标记为不提升）。

JIT 时间并不是大多数应用程序的最大瓶颈。它是框架库和其他相关需求的加载。

如果你真的需要它，你可以在安装应用程序中获取当前用户的目标机器。

我最近还了解到，您不能对应用程序进行 NGEN 并期望它像使用 JIT 一样利用 CPU。当您运行 NGEN 时，出于某种原因，总是会优化 PentiumPro 的输出，并且不会利用 SSE、SSE2 等内容。所以我会说将 NGEN 删除为一个合理的用例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T00:57:46.257

[ngen](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)可用于“pre-JIT”图像，因此它以原生形式在磁盘上可用，以减少应用程序启动时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-19T07:33:01.460

Mono 有一个可以发出本机代码的 Ahead of Time (AOT)[编译器。](http://www.mono-project.com/AOT)

# sql-server - 7645 Null 或空全文谓词

> ID：189765
> 
> 赞同：39
> 
> 时间：2008-10-10T00:58:07.503
> 
> 标签：sql-server, full-text-search

我有一个在 SQL2005 上运行良好的查询，但是将数据库移动到 SQL2008 给了我标题中的错误。

出现问题的代码是使用空参数调用 CONTAINS、CONTAINSTABLE 或 FREETEXT。但是我试图只在有这样的值时打电话或加入

```
where (@search_term = '' or (FREETEXT(lst.search_text, @search_term))) 
```

或者

```
left join containstable (listing_search_text, search_text,  @search_term) ftb on l.listing_id = ftb.[key] 
    and len(@search_term) > 0 
```

但是我找不到任何解决方法可以在 SQL2008 上运行。有任何想法吗？

我知道我可以执行动态 SQL 或使用两种不同情况的 if 语句（使用 FT 连接选择，选择没有 FT 连接。有什么更好的解决方法不需要这样做吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-12-07T04:38:48.583

我今天在将自己的数据库从 SQL 2005 转换为 SQL 2008 时找到了答案。

通过`""`您的搜索词并将 @search_term = `''`test 更改为`@search_term = '""'` SQL 服务器将忽略双引号并且不会引发错误。

例如，以下内容实际上会返回 Users 表中的所有记录：

```
declare  @SearchTerm nvarchar(250)

SET @SearchTerm = '""'

select UserId, U.Description, U.UserName
from dbo.Users U
WHERE ((@SearchTerm = '""') OR CONTAINS( (U.Description, U.UserName), @SearchTerm)) 
```

如果您使用的是 .Net，您可能会获取一份 EW Bachtal 的 FullTextSearch 类的副本。他的网站信息量很大：[http ://ewbi.blogs.com/develops/](http://ewbi.blogs.com/develops/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-03-06T08:58:49.600

这个解决方案在 SQL 2008 上对我不起作用。答案似乎很清楚，被认为很有用，但我会在有 2M 记录的表上超时。事实上，它锁定了一个在 SSMS 中运行查询的服务器。

它似乎不喜欢 where 子句中的 OR，但我可以很好地运行查询来分隔条件。

我最终成功地使用了 UNION 作为解决方法。

```
declare  @SearchTerm nvarchar(250)

SET @SearchTerm = '""'

select UserId, U.Description, U.UserName
from dbo.Users U
WHERE ((@SearchTerm = '""') 

UNION 

select UserId, U.Description, U.UserName
from dbo.Users U
WHERE CONTAINS( (U.Description, U.UserName), @SearchTerm)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-09T10:27:14.100

**只需添加双引号。** 您可以检查空字符串，然后在其中添加双引号。

```
Set @search_term = case when @search_term = '' then '""' else @Address End 
```

干得好 -

```
where (@search_term = '""' or (FREETEXT(lst.search_text, @search_term))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-10T19:51:19.750

FTS 和 OR 操作数的问题已在 SP2 CU4 中修复。如果您处于该级别或更高级别，则 OR 条件应该运行正常而无需 UNION。我们尝试了 SP2 CU8 的最新更新，FTS 现在可以与 OR 一起使用。此外，以前会失败的搜索（例如 3.12）现在工作得很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-19T22:51:10.450

我发现如果 SQL-Server[配置为忽略“干扰词”，则使用“a”作为默认值。](https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/transform-noise-words-server-configuration-option?view=sql-server-ver15)

```
SET @SearchPhrase = coalesce(@SearchPhrase, 'a'); /* replace with 'a' if null parameter */ 
SELECT ... WHERE 
    (@SearchPhrase = 'a' OR contains(Search_Text, @SearchPhrase)) 
```

# sql - 从 SQLDataAdaptor.Update 检索新 ID

> ID：189770
> 
> 赞同：0
> 
> 时间：2008-10-10T01:02:42.410
> 
> 标签：sql, ado.net

当对表执行 SQLDataAdapater.Update 时，您将如何检索每一行的 @@IDENTITY 值？

例如。是否可以修改/拦截由 SQLCommandBuilder 生成的 InsertCommand，例如添加一个输出参数，然后在 da.RowUpdated 事件中检索其值？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T02:55:44.087

比尔·沃恩对此略知一二。他们的关键是调整您的 InsertCommand。

请参阅[“管理@@IDENTITY 危机”](http://www.betav.com/Files/Content/Articles/Managing%20and%20Identity%20Crisis.pdf)。

注意：实际的解决方案使用 SCOPE_IDENTITY() 以保证触发安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-01T21:48:09.637

这是一篇被证明非常有用的文章，其中解释了“调整 InsertCommand”的技巧，以及将查询设置为“Scalar”的技巧

[MSDN 文章（在 VB.Net 中）](http://msdn.microsoft.com/en-us/library/aa581778.aspx#aspnet_tutorial01_dataaccesslayer_vb_topic5)

再见！

彼得

# reporting-services - SSRS Reports - 参数查询

> ID：189771
> 
> 赞同：1
> 
> 时间：2008-10-10T01:02:48.337
> 
> 标签：reporting-services

我有一个 SQL 报告服务器报告，它有 5 个允许可为空值的参数。用户可以为任何字段输入值。我需要强制要求用户必须输入至少五分之一的参数值（任何一个都是必需的）。

****注意**：我需要在 SQL Server 报告本身中执行此操作。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T01:51:12.577

如果您检测到他们没有输入任何值，您会怎么做？

您为报告编写一些代码（报告菜单 -> 属性 -> 代码）。该代码将检查您的至少一个参数是否不为空。然后您可以使用该代码显示或隐藏文本框以显示消息。

相同的代码：

```
Public Function CheckForNoParameters(Param1 As String, Param2 As String, Param3 As String) As Boolean
    CheckForNoParameters = (Param1 = Nothing)  AND (Param2 = Nothing) AND (Param3 = Nothing)
End Function 
```

然后在你的盒子的隐藏表达式中：

```
=Not Code.CheckForNoParameters(Parameters!Report_Parameter_0.Value, Parameters!Report_Parameter_1.Value, Parameters!Report_Parameter_2.Value) 
```

# php - 为什么 Apache 将 .php.html 文件作为 PHP 执行？

> ID：189780
> 
> 赞同：4
> 
> 时间：2008-10-10T01:10:28.963
> 
> 标签：php, html, apache

我有一个奇怪的问题...我正在使用一个文档生成器，它会生成大量的输出，例如 docs/foo.php.html。它是 XHTML，因此`<?xml...>`在文件的开头包含标签。问题是，Apache 以某种方式决定通过 PHP 解释器运行它，即使“.php”出现在文件名的中间，而不是最后。反过来，这会触发 PHP 错误，因为它将“ `<?`”视为开始执行 PHP 代码的命令，并立即被`xml...`后面的“”弄糊涂了。

如何将 Apache 配置为仅执行 .php 文件而不执行 .php.html 文件？字符串“php.html”没有显式出现在我的 Apache 配置文件中的任何位置。有一行“ `AddHandler php5-script .php`”，但我看不出它还包括“.php.html”文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T05:27:18.413

问题似乎出在[mod_mime](http://httpd.apache.org/docs/2.2/mod/mod_mime.html)中。

从 Apache mod_mime 文档页面引用：

> 如果您希望仅将文件名的最后一个以点分隔的部分映射到特定的元数据，则不要使用 Add* 指令。例如，如果您希望将文件 foo.html.cgi 处理为 CGI 脚本，而不是文件 bar.cgi.html，则不要使用 AddHandler cgi-script .cgi，而是使用
> 
> `<FilesMatch \.cgi$>`
> 
> `SetHandler cgi-script`
> 
> `</FilesMatch>`

另外，你可以谷歌搜索`apache mod_mime "multiple extensions"`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T01:20:15.837

您可以禁用 PHP 的短标签——这是混合 PHP 和 XML 的推荐方式。

[http://us.php.net/ini.core](http://us.php.net/ini.core)

```
short_open_tag = 0 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-10T01:43:15.353

.html 文件是否被列为允许被解析为 PHP？我已经看到一些共享主机将 .html 文件设置为可用作有效的 PHP 扩展名，这也可能会捕获您的 .php.html 文件。

# svn - 每当有人提交一些代码时，有什么理由要通知你们吗？

> ID：189786
> 
> 赞同：6
> 
> 时间：2008-10-10T01:13:47.770
> 
> 标签：svn, development-process

我知道有一些事情，比如进行手动检查，以确保提交的代码基本上是正确的。但除此之外呢？我问的原因是因为一个大项目每天都有很多提交。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T01:18:22.487

一般来说，提交通知很有用，因此您可以了解代码中每天发生的事情。例如，我知道何时实现了一项新功能，或者签入了一个错误修复。如果提交太多以至于这在噪音中丢失了，那么可能值得过滤或减少您看到的提交消息的数量（也许例如，您可以将其仅限于您工作的特定模块）。

话虽如此，除了让其他开发人员有机会至少粗略地审查代码之外，它还可以通知人们：

*   现在是从源代码管理运行更新并在需要时合并任何新更改的好时机
*   嘿，有人在 Foo 中发现了一个正则表达式解析错误，但忘记用它更新 Bar
*   哦，Bob 正在开发 Baz 模块，我应该让他也看看这个

你明白了。基本上，它的目的是帮助提高整个团队的透明度，不仅仅是让更多人关注提交，而是改善整个团队的开发周期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T01:25:23.580

如果有人对您自己可能正在处理的一个或多个程序进行更改，这可能会很有用。如果您愿意，请注意，您可能需要解决一些可能需要进一步沟通的冲突。

我见过程序员 A 提交了一些更改然后几天后去度假的情况。程序员 B 也在开发相同的程序，并且在程序员 B 提交更改时发生了一些冲突。通常这没什么大不了的，而且团队成员之间应该始终保持开放的沟通。在这种情况下，程序员 B 对程序员 A 所做的更改有一些疑问，但不得不等待一周，直到该程序员回来。在这种情况下，一封提醒电子邮件，甚至是自动生成的电子邮件，都会有所帮助。

只是我的两分钱。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T01:50:30.003

在收到签到通知时，上面提到的许多事情都很有用。我通常将它用于几件事：

*   如果项目以某种方式中断，有时我可以更快地解决问题，因为我已经知道已经进入系统的签入。它可能会更快地为我指出解决方案
*   它提供了一组易于搜索的签到（至少因为我在电子邮件中收到它们）。是的，您的源代码控制系统拥有所有这些信息，但搜索整个签入注释可能并不容易。使用电子邮件，我很容易返回并搜索用户、模块、关键字等，然后让 Outlook 提取相关电子邮件。
*   我可以轻松地跟踪年轻的开发人员以及他们在做什么。它让我有机会了解他们何时签入代码以及他们对代码做了什么。它提供了在代码审查等其他定期安排的事情之外进行指导的持续机会。
*   它为团队提供了一种跟踪进度并记录他们何时可能签入冲突的方法。

即使有很多通知，我也不觉得必须完整阅读它们。我略读了一堆，但这足以让我在需要更多信息时回到适当的提交。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T01:16:05.097

当然，您想观察一下被放入的代码，这样您就知道团队中的其他人在做什么，而且您不会仅仅在编写代码时陷入困境。

即使您没有监控代码的质量，您也可以了解其他人在做什么。

它有助于建立团队。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T01:15:33.803

我发现它主要用于跟踪。通常，此类自动通知会被过滤到我的邮件中的存储桶中，以及“smoketest pass，smoketest failed”类型的电子邮件......然后当出现故障时，您可以相当直接地将其追溯到签入集。

请注意，人们也可以通过签入曲线的形状来直观地了解项目的成熟度——每天更改的代码行数是代码库总大小的函数。它实际上确实给出了一个合理的想法，告诉你什么时候“完成”......

希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T01:18:06.683

通常我们有更新让每个人都知道有些东西已经更新并且需要同行评审。如果您不必分配一个用户，您可以得到它并在有时间时处理它。

我看到有人发布了一个系统，当他们在代码样式注释日志中提交快速简单的“发生了什么变化”时，该系统会向 Yammer 发送 twitter 样式消息。整洁的。不过现在找不到链接了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T02:35:13.643

在许多公司中，代码审查是强制性的，但在荣誉系统中完成。电子邮件提交通知为这些环境实施“信任但验证”机制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T02:57:23.020

我主要用它来衡量项目的心跳。每个提交消息都是一个脉冲。随着时间的推移，您会对“正常”脉冲“听起来”的样子有所了解。

在正常的一天，我们会收到 4 到 6 条提交消息。随着迭代日期的到来并在迭代发布前几天停止，这会减慢到 1 或 2。迭代后一两天，它又开始恢复，如果发现错误，我们可以每小时收到 1 条提交消息，因为错误已得到修复。提交数量很少的常规日子可能意味着开发人员在某些功能上遇到困难，或者在 stackoverflow 上花费了太多时间。

我还发现信息丰富的提交消息非常有用。有时，经理或测试人员甚至不必询问开发人员功能或错误的状态 - 只需查看提交消息，看看是否有任何工作完成。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T04:52:49.683

我的理解是，向开发人员抄送提交报告的主要原因是为了避免冲突：您会在正在使用的文件上看到提交，因此您甚至在提交之前就知道自己遇到了麻烦。但是，这会让人分心，因此有一些工具（例如，Palantir、旧的 IBM Jazz）可以实际向您显示正在同时编辑的文件。

# java - 如何格式化具有大参数列表的方法

> ID：189787
> 
> 赞同：23
> 
> 时间：2008-10-10T01:14:41.480
> 
> 标签：java, formatting, methods

我从来没有见过一种很好地做到这一点的方法，我很想看看其他人是如何做到的。目前我像这样格式化它：

```
public Booking createVehicleBooking(Long officeId, 
                                    Long start, 
                                    Long end,
                                    String origin, 
                                    String destination, 
                                    String purpose,         
                                    String requirements, 
                                    Integer numberOfPassengers) throws ServiceException {
/*..Code..*/
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-10T01:35:09.037

像这样的大量参数通常（但不总是）指示您可以使用对象来表示参数集。在以下情况下尤其如此：

*   有几种方法具有相似的大参数集，可以用带参数对象的单个方法替换。

*   该方法被称为`create...`

所以你上面的代码可能会变成（请原谅我的 C++，我是 Java 开发人员）：

```
class BuildVehicleBooking {
    Long officeId;
    Long start;
    Long end;
    String origin;
    String destination;
    String purpose;             
    String requirements;
    Integer numberOfPassengers;

    Booking createVehicleBooking () throws ServiceException { ... }
} 
```

这是**建造者模式**。这种模式的优点是您可以分段构建一组复杂的参数，包括参数如何相互关联的多种变体，甚至在新信息可用时覆盖参数，然后最终调用该`create`方法。

另一个潜在的优势是您可以添加一个`verifyParameters`方法来检查它们的一致性，然后再到达`creating`最终对象。这适用于创建对象涉及不可逆步骤的情况，例如写入文件或数据库。

请注意，与所有模式一样，这并不适用于所有情况，也可能不适用于您的情况。如果您的代码足够简单，那么这种模式可能会过度设计它。如果代码变得混乱，重构为这种模式可能是简化它的好方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-10T01:16:47.013

```
public Booking createVehicleBooking(
    Long officeId, 
    Long start, 
    Long end,
    String origin, 
    String destination, 
    String purpose,                 
    String requirements, 
    Integer numberOfPassengers)

throws ServiceException {
/*..Code..*/
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T02:49:04.130

我倾向于用几个对象而不是一个对象来解决这个问题。

所以它变成

```
public Booking createVehicleBooking(Long officeId, DateRange dates, TripDetails trip) 
```

而 DateRange 和 Trip 详细信息仅包含数据的相关部分。虽然可以说 dateRange 可能是行程的一部分，而 Requirements 和 Number of Passengers 可以从 TripDetails 中删除并成为请求的一部分。

事实上，有几种方法可以对数据进行切分，但我不得不说将您的大列表分成相关参数组并为它们构建一个对象将允许更清晰的编程风格并增加可能的重用。

请记住，始终可以将对象嵌入对象中，从而使您拥有

```
public Booking createVehicleBooking(BookingParameters parameters) 
```

而 BookingParameters 包含 TripDetails 和 DateRange 对象以及其他参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-12T22:00:05.850

在调用端，我喜欢使用如下注释来模拟命名参数：

```
booking.createVehicleBooking(
    getOfficeId(),      // Long officeId 
    startVariable,      // Long start 
    42,                 // Long end
    getOrigin(),        // String origin 
    "destination",      // String destination 
    "purpose",          // String purpose       
    "requirements",     // String requirements
    3                   // Integer numberOfPassengers
); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-18T08:54:38.867

[Google Java Style Guide](https://google.github.io/styleguide/javaguide.html)没有直接解决这个问题，但我同意他们在 Guava 中的格式化方式，即

在[com.google.common.collect.Collections2.transform](https://github.com/google/guava/blob/3a053c298ce800315a92365fbc8f62a08babc09d/guava/src/com/google/common/collect/Collections2.java#L268)：

```
public static <F, T> Collection<T> transform(
    Collection<F> fromCollection, Function<? super F, T> function) {
  return new TransformedCollection<>(fromCollection, function);
} 
```

在[com.google.common.collect.ImmutableRangeMap.toImmutableRangeMap](https://github.com/google/guava/blob/3a053c298ce800315a92365fbc8f62a08babc09d/guava/src/com/google/common/collect/ImmutableRangeMap.java#L56)

```
public static <T, K extends Comparable<? super K>, V>
    Collector<T, ?, ImmutableRangeMap<K, V>> toImmutableRangeMap(
        Function<? super T, Range<K>> keyFunction,
        Function<? super T, ? extends V> valueFunction) {
  return CollectCollectors.toImmutableRangeMap(keyFunction, valueFunction);
} 
```

我认为规则是：

*   （如果可能，尽量保持在一条线上）
*   在方法名称和大括号之后中断
*   将参数缩进一级以将它们与正文区分开来

就个人而言，如果我必须打破，我更喜欢在每个参数之后打破，即

```
public static Foo makeFoo(
    Foo foo,
    Bar bar,
    Baz baz)
      throws FooException {
  f();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-24T00:48:01.713

我喜欢您展示的每行一个参数的方法。我发现很容易目视扫描它并查看存在的内容。

我发现当人们使用像 Guice 这样的东西时，你通常会得到大量的参数，这使得它更容易阅读。

# language-agnostic - 不要忽视小细节

> ID：189791
> 
> 赞同：13
> 
> 时间：2008-10-10T01:16:00.013
> 
> 标签：language-agnostic

与这个网站上的大多数人相比，我无疑是个新手。我想从专业人士那里获得一些关于如何避免在代码中犯愚蠢错误的建议。

是否还有其他人在刚开始时因为遗漏了一些导致大问题的细节而遇到了问题？是否有任何习惯或行为可以帮助您克服这种情况。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-10T01:17:22.397

以下是常见陷阱的列表，和/或避免它们的建议：

1.  经验，避免错误的最好方法是已经让它们发生在你身上。
2.  查看其他人的代码
3.  让其他人检查您的代码
4.  使用源代码管理，即使您是唯一的开发人员
5.  在提交源代码控制之前检查所有更改
6.  考虑使用更现代的语言，让你更难犯错误
7.  广泛地评论您的代码
8.  尽早并经常重构您的代码
9.  在添加功能之前修复错误
10.  创建广泛的测试用例，因为了解您的错误可以帮助您更快地避免未来的错误。
11.  学习和使用设计模式。
12.  不惜一切代价避免代码重复，尽量不要复制/粘贴代码块
13.  阅读您正在使用的编程语言中的特定常见缺陷

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-10T01:18:26.870

在开始编码之前，我发现在纸上或至少在我的脑海中编写代码或算法。它使您的头脑中的问题更加清晰，并且当您可能会因过于急切而犯愚蠢的错误时，您不只是启动并开始编码。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-10T01:20:14.683

我发现如果我在将代码提交到版本控制之前**通读**所有代码的差异，我几乎*可以保证*找到一些错误。如果我让其他人检查代码预检，那么（至少）这种效果会加倍。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T01:18:11.613

同行代码审查和单元测试。只有经验才能帮助你停止犯错，但这些东西会帮助你了解你早早犯的错误。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-10T01:19:54.043

就像你在生活中所做的一切一样。从在当地快餐店的油炸锅上烧死自己，到成为第三次创业的企业家。

**犯错误**，**从中吸取教训**，让**自己****变得更好** ——*不要忽视它们*。

 **** * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-10T01:18:30.740

像大多数其他获得的技能一样，熟能生巧。继续训练。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-10T01:21:08.957

我将对“熟能生巧”再投一票，但稍作修改：

*完美*的实践使完美 - 一个相关的说法是“实践使永久”所以换句话说，确保你正在练习的是减少错误的良好编码习惯：

*   单元测试
*   可读的代码格式
*   有用的变量名
*   修订历史的源代码控制

等等。我还强烈建议您查看优秀的开源项目并了解它们是如何组织和管理代码的。好的例子比看到别人的错误更重要:-)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-10T01:37:12.607

我发现，如果我在尝试修复错误或思考问题时遇到任何特殊问题，我会休息 5 分钟。当我喝点东西或只是放松并回到问题上时，我往往会更专注，压力更小。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-10T01:21:12.623

好的判断来自经验。

经验来自于错误的判断。

这听起来可能过于简单，但我尝试遵循这个口头禅。我尽量不犯我以前犯过的同样的错误。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-10T01:25:39.260

您正在取得良好的开端 - 认识到您还没有完全弄清楚。我们都没有。

确保您了解域 - 这将立即消除一些错误。知道你在解决什么，然后开始尝试开发解决方案。

有一个发展的方法。我使用测试优先的方法，但这不是唯一的方法。这为我提供了一个我仍在使用的内置检查器。我利用我的同龄人来汲取灵感，我以前使用过结对编程并从中发现了价值。

如果你开发了一个系统来最小化“愚蠢”的错误，你会发现它们会消失。也许清单会起作用。个人软件过程鼓励这种方法。试试看它是否有效。

我喜欢在将我的想法提交给代码之前将它们写在白板上。我喜欢我的同龄人首先告诉我为什么我的想法不对。如果他们不能，我有理由确定我已经消除了一些可能的障碍。

其中很多将来自经验，基本上来自于做你所做的事情并从你的错误中吸取教训！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-10T01:48:24.893

永远保持“保持简单”的态度！！如果你保持简单，你犯错的机会就会减少。

[温迪](http://www.rwendi.com)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-10T01:54:40.340

避免在完全理解问题之前就开始编写代码的冲动。如果您只了解问题的一部分，您可能会在以后花时间重新设计设计。将大局清晰地记在脑海中或在纸上，然后开始编码。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-10T21:47:38.187

模式 - 在您的工作中开发或借用和使用模式。一些示例模式：变量名称的一致使用、递增计数器的一致位置、错误报告的一致放置等。

有效使用模式的一个重要方面是它们的视觉外观。一个让我惊讶的不好的做法是在一行的末尾而不是在下一行的开头放置左大括号。例如，这是一个很好的做法：

```
void MyMethod(String some_input)
{
   if (some_input == null)
   {
      some_input = "";
   }
} 
```

使用常见但不好的做法编写的相同方法如下所示：

```
void MyMethod(String some_input) {
  if (some_input == null) {
    some_input = "";
  }
} 
```

如果某处缺少支架，找到它非常耗时！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-10T01:19:46.587

好好评论。

很好地隔开你的代码。

有有意义的变量名。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-10T01:46:01.497

通常，大错误来自于在考虑之前潜入并编写软件。我雇佣了 2 名程序员，这就是我坚持要他们做的事情。它有很大的不同。

在纸上画出你正在设计的屏幕，并在编码之前尽可能多地确定事情是如何工作的。把它展示给你的老板/客户/其他人。向他们解释。让他们批评它。

在您将其视为 UML 之前，切勿开始编写代码。您不需要成为 UML 专家，但类图显示：

1.  遗产
2.  聚合（例如这个网站由用户组成，用户发布多个帖子，帖子可以有其他用户的多个评论）

根本不考虑它会产生巨大的变化。

保持你的函数小——不要超过 30 行，通常更少。这将帮助您构建代码。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-10T02:01:39.093

对我来说，当我盯着代码看时，我习惯于在方法中放置一种“待办事项”列表，详细说明我在每个阶段必须做什么才能完成工作。例如，如果我有一个获取客户姓名的方法，我会写类似..

公共字符串GetName（int custID）{

```
 // Create local variables

        // Get the connection string from the config file

        // Create Try Catch Finally block

        // Create SQL parameters 

        .... etc

    } 
```

我不会将这些作为评论留下，但会在我完成任务时删除它们。老实说，我不再这样做了，我怀疑您是否需要这样做太久。

另外，我建议如果你想学习新的东西，你应该做一个“真正的”项目，而不仅仅是书本或网站上的例子（即使它只是你自己的一个小应用程序，也要让它发挥作用）。阅读一本关于代码的书并不能代替陷入困境。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-10T02:07:58.130

1.  不要害怕错误——这是学习新事物的最佳方式
2.  每周进行一次代码审查非常重要 - 与专业人士一起
3.  在家编写代码 - 它将帮助您更快地提高自己
4.  阅读其他代码 - 开源代码是学习新事物的最佳方式

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-10T03:31:52.500

我唯一没有提到的建议是：在我进行任何重大更改之前，无论是代码还是文档，我都会在实际完成之前休息 10-15 分钟。改变。通常休息一下会让我回来时精神焕发，而且——更重要的是——不会像投入改变那样投入，而且我的大部分事情都因此变得非常明显。当您是唯一一个在做某事的人时，这通常会更有帮助，否则您可以获得通常更好的同行评审。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-04-16T19:07:27.400

如果您有不明白的地方，不要害怕提问。我见过的大多数最大错误都是由于某人没有彻底理解需求并且没有提出进一步的问题来确保程序正在执行预期的操作。或者有人使用他们不理解的代码，不要求解释，然后不明白为什么它在他们的特定情况下不起作用。然后有些人对他们的数据模型了解得不够好，无法确定他们的查询是否返回了正确的答案，这还不足以让它运行，它需要返回正确的数据。同样，他们没有提出问题来获得更好的理解。一世' 我坐在会议上，看着人们点头同意某件事，并且知道他们只会从他们的肢体语言做错事。但是很难帮助一个不承认自己不理解的人。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-10T01:19:18.897

我们都会犯愚蠢的错误，因为我们是人。

我是一个新手，但我曾与许多经验丰富的专业人士一起工作，他们犯的愚蠢错误跟我一样。这些是您将从中学习并几乎可以立即纠正的错误。

除此之外，我可以推荐的最好的事情是在您编写的每一小段代码之后检查错误。每小时可以编写数百行代码感觉很棒，但是当您有一千个错误和一千行要检查时，您很快就会崩溃。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-10T01:24:39.323

练习——你写的代码越多，你获得的经验就越多

重用代码——被大量使用的代码最不可能包含缺陷

防御性编码 - 最大限度地减少风险代码的创建，避免边缘条件效应

测试 - 查看 TDD 单元测试（不是传统的单元测试） - 这意味着记录预期的代码行为并创建测试它的代码。更多的代码意味着更多的经验、更多的自动化、更高的信心

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-10T02:04:23.363

我们都会犯错。天才是那些简单地将他们留在砧板上的人。

练习，进行频繁的代码审查（我的意思是，*频繁*的），保持广泛的版本历史，并确保你知道在哪里可以找到已经学会如何更好地隐藏错误的人。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-10T09:03:07.870

静态分析工具非常有用。 [Findbugs](http://findbugs.sourceforge.net/)还提供有关为什么特定做法对您的程序有害的信息。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-10T22:10:11.280

这里的大多数答案都是相当笼统的，但是在开发代码时可以做一些实际的事情来减少出错的可能性。确切地说，它们在语言之间会有所不同，但是例如，如果语句是挂起的错误的常见来源-许多语言不坚持将代码括起来，如果它是单行的话-例如

```
if fred==bill dosomethingtofred() else dosomethingtobill();

```

这通常会产生错误——尤其是在以后编辑代码时。我也没有在此处将测试括起来，因为这在某些语言中是允许的，并且是潜在的错误生成器。我自己将*永远*无一例外地构建一个完整的 if 语句，并在整个 linage 例如

```
如果（弗雷德==比尔）{
  dosomethingtobill();
}
别的 {
  dosomethingtofred();
}

```

（请注意，我个人更喜欢 line end {。有些人对此不以为然，在合作环境中，使用新的 line 样式可能会更好，但是我作为顾问工作主要是编写由我自己维护的代码，我严格遵守缩进标准，因此代码的额外紧凑性得到了回报）

类似的技术可以应用于大多数语言的各种代码结构。我建议你仔细检查你在哪里犯了愚蠢的错误，然后考虑什么代码结构会阻止你这样做，然后每次都使用它们。我自己多年来建立了相当广泛的这些结构（另一个例子，我所有的 sql 都以相同的方式布局）。除了减少愚蠢的错误之外，这还有一个额外的优势，那就是我可以在几年后重新编写代码并快速掌握功能。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-10T22:17:16.647

尽你所能去理解你的错误。写下出了什么问题，您尝试修复错误的所有内容，以及最终奏效的内容。我用这种方法强迫自己放慢速度，停止盲目猜测。如果你这样做的时间足够长，你会养成一种注重细节的工作习惯，从而减少你的错误。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-10T22:22:59.770

我相信一个简单的事情。

编码一次，编码正确。

为了得到那个（无论如何对我来说），我需要在做任何事情之前在心理上完全想象这个问题。如果我不完全理解一个问题，我会很犹豫是否继续。

也就是说，有时你必须越过界限，只是在不知不觉中看到另一边的东西。

# xml - 茧2.2？这是值得的还是坏消息？

> ID：189796
> 
> 赞同：0
> 
> 时间：2008-10-10T01:17:34.207
> 
> 标签：xml, pdf, frameworks, xslt, apache-cocoon

我希望将 Cocoon 用于我正在创建的几个网站。我将在网站上大量使用 xml、xsl 和转换为 html、pdf 和 excel。我被 coccon 所吸引，因为它很好地实现了这些功能。

我想我只是想知道是否有人使用过它并喜欢它，或者他们是否发现它比它的价值更麻烦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T22:57:24.453

Cocoon 是一个非常强大的框架。但要理解它的所有方面并不容易。（见尤利西斯的回答）。一旦您理解了基本概念，尽管在 XML 空间中几乎没有可比的东西。

它已经集成了很多东西，你真的需要把它分解成你真正需要的东西。最初的站点地图很大。那是大多数新手已经失败了。（见米丹代尔的回答）

所以它真的归结为你真正想用它做什么。今天，我不再将它用于 Web 应用程序。还有其他框架具有该重点并在这方面做得更好。您可能仍然可以将它们与 Coocoon 集成。好吧，它可能已经由某人完成了；）

如果你真的大量使用 xml/xsl 并且需要不同的输出格式，那么可能没有什么比 Cocoon 更好的了。经过适当调整，它甚至可以为几个非常大的网站提供服务。

如果您有任何疑问，它拥有最受欢迎的开源社区之一。只要确保它是正确工作的正确工具。但是从你的描述来看是这样的。即使您只是将其用于渲染。

它有一点学习曲线 - 但不要感到沮丧。

免责声明：我是开发人员之一:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-12T21:46:39.017

只是快速查看了您可以查看的替代方案：

*   [茧比较](http://wiki.apache.org/cocoon/CocoonCompared)
*   [工作流程比较](http://wiki.apache.org/cocoon/WorkflowImplementationComparison)
*   [Apache AxKit](http://axkit.org/)
*   [象](http://xml.apache.org/xang/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T18:43:25.250

我使用 cocoon 为移动设备（基于设备功能）生成目标内容（例如 DHTML、XML、SVG）。

最大的问题是示例配置中默认启用的所有默认组件。要启动和运行应用程序，需要做很多工作。

但是，一旦您配置了所有内容，它就是一个非常强大的框架。

# c# - 工厂类 - 保存对象

> ID：189799
> 
> 赞同：5
> 
> 时间：2008-10-10T01:18:09.273
> 
> 标签：c#, factory

我有一个用数据填充对象的工厂类。我想从对象实现保存，但不想用 db 填充对象 - 让创建类的工厂也保存数据是愚蠢的吗？

即：在我的对象上的 .Save() 方法中，我将调用 Factory.Save(myObject);

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T01:24:57.233

工厂类是一种有助于创建新对象的创建模式。

有多种模式可以处理持久对象，其中一种是数据映射器 [http://martinfowler.com/eaaCatalog/dataMapper.html](http://martinfowler.com/eaaCatalog/dataMapper.html)

这通常与 Repository [http://martinfowler.com/eaaCatalog/repository.html一起使用](http://martinfowler.com/eaaCatalog/repository.html)

您可以使用这些模式将数据库从您的域/业务对象中抽象出来，并从您的应用程序中访问它们以查询和保存对象。

所以数据映射器/存储库负责持久性的两个方面（从数据库填充，并保存回数据库）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T01:26:14.670

如果您担心类中的数据库内容 - 您是否考虑过使用 O/R 映射器？

这将使数据库内容完全不受您的代码影响，并且您的域对象也很干净。

也许看看[NHibernate](http://www.hibernate.org/343.html)或[Active Record](http://www.castleproject.org/activerecord/index.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T01:21:56.303

不，这根本不傻，事实上，每个人都应该这样做。业务对象不应包含任何持久性逻辑。

顺便说一句，如果您使用的是 C# 3.0，那么您甚至可能不会打扰 Factory 类。只需创建扩展方法。这样，您仍然可以将持久性代码与业务对象隔离，并且仍然可以调用 myObject.Save()。

# proxy - 如何在 Solaris 服务器中设置代理连接？

> ID：189816
> 
> 赞同：5
> 
> 时间：2008-10-10T01:22:08.737
> 
> 标签：proxy, solaris

我需要设置代理连接才能访问互联网。我正在使用 Solaris 服务器。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T01:33:58.277

将此设置为环境变量：

```
> export http_proxy="http://domain_url\\username:password@proxy_url" 
```

# c# - .NET 有什么好的分布式代理/服务模型吗？

> ID：189817
> 
> 赞同：20
> 
> 时间：2008-10-10T01:22:16.113
> 
> 标签：c#, .net, grid, cloud, agent

我正在寻找实现分布式代理/服务模型的工具......我想我们也可以称之为网格或云计算，但我不确定这个术语是否完全类似。分布式代理模型将是一种开发人员构建代理的模型，这些代理被分派到框架，框架在分布式环境中的某处执行代理。

具体来说，我正在寻找一个支持跨网格/云的动态分布的框架，但用更持久的服务替换瞬态代理。这里的目标是最大限度地减少将服务部署到网格/云容器中所需的时间和精力。

FWIW，我认为 Digipede 非常接近这一点，但我对那里的其他东西很感兴趣。我的印象是，必须考虑装配分布才能使解决方案可行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T02:27:03.410

微软有一个名为 Dryad 的项目。这是一个包含更多信息的好播客：http: [//www.dotnetrocks.com/default.aspx?](http://www.dotnetrocks.com/default.aspx?showNum=378) showNum= 378 它使用 LINQ，应该很容易使用。微软让它为微软的 AdCenter 做一些生产工作。这是研究页面。 [http://research.microsoft.com/research/sv/Dryad/](http://research.microsoft.com/research/sv/Dryad/)

*Dryad 很有表现力。它完全包含其他计算框架，例如 Google 的 map-reduce 或关系代数。此外，Dryad 还处理作业创建和管理、资源管理、作业监控和可视化、容错、重新执行、调度和会计。*

PS我没有看到下载，但如果你联系他们并且你是认真的，你可能会得到它。

更新：现在可以在这里下载： [http ://research.microsoft.com/en-us/downloads/03960cab-bb92-4c5c-be23-ce51aee0792c/default.aspx](http://research.microsoft.com/en-us/downloads/03960cab-bb92-4c5c-be23-ce51aee0792c/default.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-09T05:50:27.617

这对聚会来说可能有点晚了——但我们是 Alchemi 的开发者。我们开发了一个更好的框架版本来解决它的局限性。

您可能想查看 Utilify 平台 (www.utilify.com) - 它在概念上类似于 Alchemi - 具有更灵活的模型。

您确实需要一个网格管理器和一个数据库 - 但是，您可以使用免费的 SQL Server Express 版本，它经过测试可以在 Windows Vista、XP、2003 上运行。

我们很乐意帮助您将 Utilify 用于您的应用程序。

问候，克里希纳

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-04T04:38:02.480

MySpace 使用 Qizmt 进行分布式 MapReduce 操作。它类似于 Java 世界中的 Hadoop。这两个项目都基于谷歌的 MapReduce。它在普通的 Windows 机器上运行，不像 Dryad 需要 Windows Server 高性能计算 (HPC)

另外它是开源的。这很好。[http://code.google.com/p/qizmt/](http://code.google.com/p/qizmt/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T15:59:13.540

[Recursion Software的](http://recursionsw.com/)[Voyager](http://recursionsw.com/Products/voyager.html)为多种风格的分布式架构提供了成熟的框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T05:18:17.073

我一直在为自己的工作寻找类似的东西。到目前为止，我已经找到了 Digipede、[Alchemi](http://www.alchemi.net/)和[NGrid](http://ngrid.sourceforge.net/)，但它们都需要一个 SQL 数据库作为网格管理器，除了不成熟的 NGrid。

# java - 从 Java 应用程序导出时，IE6 生成了奇怪的工作表名称

> ID：189830
> 
> 赞同：0
> 
> 时间：2008-10-10T01:32:55.920
> 
> 标签：java, windows, internet-explorer, csv, httpresponse

我遇到了类似的错误

```
test(10)[1].csv file cannot be found at 
C:\Documents and Settings\Ron\Local Settings\Temporary Internet Files\Content.IE5\PQ0STUVW 
```

尝试使用以下代码导出 CSV 文件时。有人知道可能出了什么问题吗？此问题在 IE7 / Firefox 中不会发生，仅特定于 IE6。

```
response.setContentType("application/vnd.ms-excel");
response.setHeader("Content-Disposition", "attachment;filename=" + fileFullName); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T08:57:31.647

我已经遇到了这个问题，并提出了这个[问题作为正确答案](https://stackoverflow.com/questions/120497/how-to-work-around-the-1-ie-bug-while-saving-an-excel-file-from-a-web-server)（或者，我应该说，IE 的一个很好的解决方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T03:19:42.673

我不确定为什么文件名会被修改，但 IE 中的“未找到”通常意味着您还设置了无缓存标头，或者缓存时间为零秒。

如果我没记错的话，IE 不能直接打开文件——它必须先缓存它，然后再从缓存中打开它。所以你必须允许它被缓存。

这意味着： 1\. 为了使事情正常工作，文件名每次都需要是唯一的——我通常将时间戳（到毫秒）添加到文件名中。

2.  为了防止客户端的缓存不必要地增长，您可能应该将缓存时间设置为较短（1 或 2 秒左右），但绝对不是 0；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T11:48:22.717

您的“fileFullName”中有“特殊”字符吗？你冷也试着检查你的文件名的长度，当文件名太长时，我曾经遇到过IE6的问题。

只是为了安全起见：您的“fileFullName”仅包含文件名而不包含路径，对吗？

# sql-server - 我们应该升级到 SQL Server 2005 还是 2008？

> ID：189831
> 
> 赞同：4
> 
> 时间：2008-10-10T01:33:25.670
> 
> 标签：sql-server, ssis

我们公司正在考虑升级我们的 SQL 服务器。

此时，升级到2005还是2008会更好？

以下是我的一些考虑：

*   特征
*   许可费用
*   学习曲线

请记住，我们的员工已经使用 SQL Server 2000 多年。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T01:38:29.653

2005 已经与 2000 大不相同，至少在最佳实践方面是这样，因为错误处理等许多方面都得到了极大的改进。就学习曲线而言，如果你无论如何都要向他们扔学习曲线球，他们可能最好学习新技术而不是已经有几年历史的技术。
但除此之外，如果您不提供有关贵公司从事何种工作的任何信息，就很难对新功能发表评论。在 SQL 2008 中让我非常兴奋的一件事是我希望在几个月前（也许是最初计划的发布日期）推出的地理空间数据类型，因为它们会使我们庞大的地图应用程序变得更加容易......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T10:58:48.790

如果您将 SQL Server 2000 代码库移植到 SQL Server 2005 或 2008，那么到 2008 年的工作量不会显着增加。虽然 2008 年与 2005 年相比有一些功能，但差异并不像从 2000 年到 2005 年的跳跃那么大。我建议直接使用 SQL Server 2008，该决定具有以下主要优点和缺点：

**去 2008 年的优点**

*   您的系统基本上可以免费获得 3 年的使用寿命。SQL Server 2008 的支持时间将比 SQL Server 2005 更长。这为您提供了更长的时间，然后您将不得不迁移到新版本。IMO 这可能是直接使用 SQL Server 2008 的最有力论据。

*   您可以获得一些 SQL Server 2005 中不可用的功能，例如地理空间索引。虽然您的 SQL Server 2000 应用程序最初不会使用这些功能，但您将来可以获得更多选择，而无需进行另一个平台转换。对于您的移植练习，这无关紧要，但您几乎可以免费为自己购买一点灵活性。

**使用 SQL Server 2005 的优点**

*   与 SQL Server 2008 相比，它的“前沿”更少，因此实施路径可能会稍微容易一些。

*   招聘熟练掌握 SQL Server 2005 的人员比招聘有经验的 SQL Server 2008 人员容易。但是，大概您将主要对现有员工进行再培训，因此这不太可能成为主要问题。

YMMV 关于其中一些问题，因此您可能希望对潜在问题进行更详细的调查，看看是否有任何针对您的具体情况的真正好处或障碍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T01:46:22.570

我会直接进入 2008 年，因为已经存在足够的差异，您需要针对 2005 年或 2008 年重新测试您的软件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-15T21:47:02.870

毫无疑问，我会选择 2008 年。

看看[MS SQL Server 2008 的新功能](http://www.microsoft.com/sqlserver/2008/en/us/whats-new.aspx)- 其中一些很棒。我发现最重要的是性能。在我的场景中，SQL2008 表现更好。

# c# - 如何调试 C# 类库中的堆错误？

> ID：189848
> 
> 赞同：1
> 
> 时间：2008-10-10T01:47:41.663
> 
> 标签：c#, visual-studio, debugging, memory, interop

我在 C++ 应用程序中通过 COM 调用的 C# 库模块中出现堆损坏错误。具体错误是：

> HEAP: Free Heap block 4b61bb8 在被释放后修改为 4b61be8
> ...
> 这可能是由于堆损坏，并表明 [app].exe 或它已加载的任何 DLL 中的错误。

调用堆栈的顶部是：

```
CustomMarshalers.dll!System.Runtime.InteropServices.CustomMarshalers.EnumeratorViewOfEnumVariant.MoveNext() + 0x168 bytes 
```

现在我的理解是 .NET 应该缓解内存问题，而不是让更多的内存问题无法修复。然而，我想不出我可能会做什么来导致内存错误，或者我可能会如何尝试修复它。特定模块使用 Microsoft.VisualStudio.VCProjectEngine .NET 组件通过非常简单的迭代器来迭代 VC 项目文件。在成功完成之前的大约 100 次调用之后，它在迭代 VCProject 过滤器（文件夹）中的文件时中断了 foreach 语句。正在破坏的实际代码是：

```
 IVCCollection CollectionFiles = (IVCCollection)FolderInProject.Files;
    foreach (VCFile File in CollectionFiles)
    {
        [...]
    } 
```

我怎么可能去调试呢？

更新：

当我从纯 C# 控制台应用程序（不涉及 COM 或本机代码）调用 if 时，我得到：

> [component].dll 中出现“System.AccessViolationException”类型的未处理异常
> 
> 附加信息：尝试读取或写入受保护的内存。这通常表明其他内存已损坏。

仍然不知道如何进行调试。显然某处发生了内存错误......但是我如何在内存模型甚至没有暴露的纯托管代码中追踪它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T02:42:26.607

看起来您的 COM 接口没有正确封送参数/返回变量，导致托管内存被 GC 意外释放或非托管内存由于某些不正确的封送处理而被丢弃。[您可以通过为 COM 组件构建自己的主互操作程序集](http://msdn.microsoft.com/en-us/library/aax7sdch(VS.80).aspx)来对创建的 COM 接口进行更精细的控制。通过一些工作，您可以检查 COM 对象上的违规方法，并确保其所有参数都具有正确的元数据，以确保它们被正确编组。

现在，另一种可能性是您正在正确地编组所有内容，但您并没有完全正确地调用接口，这表明自己对参数的不正确使用最终会破坏非托管内存。追踪这些内容就不那么有趣了，尤其是在您无法访问 COM 源代码的情况下。

一个技巧是让程序在您的调试器之外崩溃，单击“调试”，这会打开选择 JIT 调试器窗口。然后检查“选择调试引擎”（或类似的东西）并确保选中托管和本机复选框。出现的 VS 实例应该在实际死亡的代码中被破坏，而不是最接近死亡的托管代码。

# javascript - 脚本标签的 type 属性的 javascript MIME 类型是什么？

> ID：189850
> 
> 赞同：123
> 
> 时间：2008-10-10T01:48:40.930
> 
> 标签：javascript, mime-types

javascript的[MIME类型是什么？](http://en.wikipedia.org/wiki/MIME)

更具体地说，在脚本标签的“类型”属性中放入什么是正确的？`application/x-javascript`并且`text/javascript`似乎是主要的竞争者。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2008-10-10T02:08:38.313

这是一个常见的错误。多年来，javascript 的 MIME 类型没有标准化。它现在是[正式](http://www.rfc-editor.org/rfc/rfc4329.txt)的：“ **application/javascript** ”。

这里真正的问题是大多数浏览器无论如何都不会使用该属性，至少在 script 标签的情况下不会。他们实际上在数据包内部窥视并为自己确定类型。

所以底线是 type="text/javascript" 就 javascript 而言没有任何作用，但它是**HTML 4**和**XHTML 1.0**规范的一部分。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-01-04T09:26:41.460

很远，这是我在该主题上找到的第一页，对此有任何意义。

我的集体研究表明：

1.  `text/javascript`正如 Keparo 所说，如果你想让它验证，必须在 html4 和 xhtml1 中使用。尽管浏览器会忽略它。
2.  `application/javascript`如果每个人都同意并且一切都赶上来，预计将成为新的官方 MIME 类型。
3.  `application/x-javascript`（x 表示非官方）是 javascript 的当前服务器端 MIME 参考。
4.  每个人都希望像往常一样，微软将决定做一些完全不同的事情来进一步混淆和解决问题。

摘要：目前，如果您希望您的 html/xhtml 在 MSIE 中工作并通过 W3C 进行验证，请声明`type="text/javascript"`. 如果您希望您的网络服务器知道您的意思是 javascript，请使用`application/x-javascript`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T01:58:39.537

文本/javascript

我相信 IE 不接受 application/x-javascript

[指定脚本语言](http://www.w3.org/TR/WD-html40-970708/interact/scripts.html#h-9.2.1.2)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-10T01:52:13.713

在脚本标签中，我会使用 text/javascript。无论如何，这出现在 HTML 4.0 规范中。

[http://www.w3.org/TR/REC-html40/interact/scripts.html](http://www.w3.org/TR/REC-html40/interact/scripts.html)

[编辑] 有趣的是，标准化 application/javascript 的[RFC](http://ftp://ftp.rfc-editor.org/in-notes/rfc4329.txt)已有 2 年历史，但 text/javascript 仍然更常见。这是定制战胜标准的又一个案例吗？它也出现在[HTML5](http://www.w3.org/html/wg/html5/#scripting-1)中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-04-12T07:53:23.170

定义 Javascript MIME 类型的官方 RFC 是[RFC4329](http://www.rfc-editor.org/rfc/rfc4329.txt)。

```

7\. JavaScript 媒体类型

7.1。文本/javascript（已过时）

   类型名称：文本
   子类型名称：javascript
   必需参数：无
   可选参数：charset，见4.1节。
   编码注意事项：
      与 [RFC3023] 的第 3.1 节中的注意事项相同。

   安全注意事项：见第 5 节。
   互操作性考虑：
      无，除非在本文档的其他部分中注明。

   已发布规范：[JS15]
   使用此媒体类型的应用程序：
      本文档中讨论的脚本解释器。

   附加信息：

      幻数：不适用
      文件扩展名：.js
      Macintosh 文件类型代码：TEXT

   个人和电子邮件地址联系以获取更多信息：
      请参阅作者地址部分。

   预期用途：已过时
   使用限制：不适用
   作者：见作者地址部分。
   变更控制人：IESG。

7.2\. 应用程序/javascript

   类型名称：应用程序
   子类型名称：javascript
   必需参数：无
   可选参数：charset，见4.1节。
   编码注意事项：
      与 [RFC3023] 的第 3.2 节中的注意事项相同。

   安全注意事项：见第 5 节。
   互操作性考虑：
      无，除非在本文档的其他部分中注明。

   已发布规范：[JS15]
   使用此媒体类型的应用程序：
      本文档中讨论的脚本解释器。

   附加信息：

      幻数：不适用
      文件扩展名：.js
      Macintosh 文件类型代码：TEXT

   个人和电子邮件地址联系以获取更多信息：
      请参阅作者地址部分。

   预期用途：常见
   使用限制：不适用
   作者：见作者地址部分。
   变更控制人：IESG。

```

# asp.net - 在 Visual Basic 中将类库转换为 webapp？

> ID：189851
> 
> 赞同：1
> 
> 时间：2008-10-10T01:48:44.983
> 
> 标签：asp.net, vb.net

我收到了数百个原始用经典 ASP 编写的 Web 应用程序的源文件，但在某种程度上移植到 VisualBasic.NET 和 ASP.NET

它没有附带任何形式的项目或解决方案文件。

我正在尝试将其设置为构建，但我正在苦苦挣扎。如果我尝试将它作为网站打开（ala 网站而不是 Web 项目），我会收到数百个错误，主要是由于缺少参考...

所以，我尝试创建一个新的类库项目并添加所有文件，现在错误更少，但仍然有数百个。

有没有办法告诉 VB 将这个类库项目转换为 Web 项目？我认为这可以解决很多错误。

我是 C# 人，从 VB6 开始我就没有在 VB 中工作过。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T02:02:26.453

您可以在 Visual Studio 中创建一个新的 ASP.NET Web 应用程序项目，删除创建的默认文件，然后将所有现有文件添加到项目中。这似乎是我首先尝试的最简单的入门方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T02:10:09.670

如果你只是想将一个 web 项目迁移到一个 web 应用程序项目中，2005 年左右还有一堆文章，也许有一些技巧可以适用于你的情况：

[http://webproject.scottgu.com/CSharp/Migration2/Migration2.aspx](http://webproject.scottgu.com/CSharp/Migration2/Migration2.aspx)

# database - 具有非常大数据集的关联表的合理查询时间是多少？

> ID：189853
> 
> 赞同：-1
> 
> 时间：2008-10-10T01:50:43.623
> 
> 标签：database, architecture, query-optimization, multi-tenant

在*StackOverflow 播客中没有。在19 日*，Joe 描述了 Fogcreek 的决定，即**每个客户端都拥有一个数据库**，而不是**所有客户**端都拥有一个数据库。这让我想到了以下几点。

1.  假设我有**1000 个用户**。
2.  每个用户有**100 个客户**。
3.  每个客户有**1000 种产品**。

所以这意味着我将有**1000 x 100 x 1000 = 100,000,000 个**产品与用户相关联。现在，如果我对一个用户及其所有客户的产品进行连接表查询，那么如果我为此目的只使用一个数据库，那么合理的查询时间应该是多少？

**更新**

也许我的问题不够清楚。假设我需要对上面描述的数据集进行各种时髦的查询（最小、最大、组等），是否会很慢（或没有）到拥有多个数据库策略更有意义的地步，例如. 1 DB/客户端、数据库分片等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T12:43:45.120

我想答案取决于您选择的 DBMS。以 Oracle 为例，1 个大数据库肯定更可取，实际上 1000 个相同的数据库会被认为是荒谬且难以管理的。

此外，您永远不需要跨用户运行查询吗？例如，找到拥有最多产品的用户。或者这些真的是 1000 个离散的“私有”数据库，没有人可以全面访问数据？即便如此，Oracle 例如提供“虚拟专用数据库”来满足单个数据库中的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T14:56:05.023

每个客户端一个数据库策略的主要原因是安全性和可管理性。虽然在单个数据库而不是 100 个特定于客户端的数据库上进行备份/恢复的概念确实让您获胜，但它也有一些缺点。共享数据库的一些问题是：

*   如果没有一些额外的安全措施（例如视图），用户不能直接从数据库报告，以防止他们看到彼此的数据。在敏感数据的情况下，这也成为合规问题。

*   整个应用程序必须了解安全模型，这增加了一定程度的复杂性。同样，对于敏感数据，这具有合规性影响。

*   涉及一位客户数据的系统维护或支持工单任务存在错误会影响其他客户数据的风险。

多个数据库的固有分区简化了应用程序并消除了整个类别的错误、错误配置和安全问题。如果您构建应用程序，使其能够进行自动化配置管理和部署到多个环境，那么即使在多个实例上，您也可以获得相当容易维护的东西。

此外，根据您所描述的数据量和报告类型，您最好构建某种报告子系统或数据集市，将报告移出生产服务器。这种类型的分析报告在星型模式上比在事务数据库上使用的规范化模式类型更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T02:11:38.387

在大多数情况下，您应该将用户和/或客户端作为 PK 的一部分，因此您在多租户场景中的性能不会受到与单租户情况有太大​​不同的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T02:38:27.757

如果你想得到所有这些，所有的列和行，而不过滤或聚合，那么你将不得不等待很长时间。我认为这里没有任何合理的时间可以用作基准。你只需要等待:)

但是这些类型的查询很少发生（除非您正在迁移数据 - 仍然有替代方案）。通常发生的情况是您返回子集行、行页、列选择或聚合。在这种情况下，“合理的数量”取决于查询的类型和所涉及的计算。

# c - C中的N叉树

> ID：189855
> 
> 赞同：17
> 
> 时间：2008-10-10T01:52:09.423
> 
> 标签：c, struct, n-ary-tree, abstract-data-type

哪一个是 C 语言中 N-ary 树的简洁实现？

特别是，我想实现一个 n-ary 树，而不是自平衡树，每个节点中的子节点数量不限，其中每个节点都包含一个已经定义的结构，例如：

```
struct task {
  char command[MAX_LENGTH];
  int required_time;
}; 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-10T16:15:10.137

任何 n 叉树都可以表示为二叉树，其中每个节点的左指针指向第一个孩子，右指针指向下一个兄弟。

```
             RR
           / | \ |
          BCDB -- C -- D
         / \ | | |
        EFGE--FG

```

所以，你的情况是：

```
struct task {
  char command[MAX_LENGTH];
  int required_time;
};

struct node {
  struct task taskinfo;
  struct node *firstchild;
  struct node *nextsibling;
}; 
```

这种技术的优点是许多算法更容易编写，因为它们可以在二叉树而不是更复杂的数据结构上表达。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-10T02:21:00.880

作为第一遍，您可以简单地创建一个*结构*（我们称之为*TreeNode*），其中包含一个*task*以及一组指向*TreeNode*的指针。这个集合可以是一个数组（如果**N**是固定的）或链表（如果**N**是可变的）。链表将要求您声明一个附加*结构*（我们称之为*ListNode*），其中包含指向实际子节点（树的一部分）的*TreeNode*指针，以及指向列表中下一个*ListNode*的指针（如果在末尾则为**null**列表）。

它可能看起来像这样：

```
struct task {
  char command[MAX_LENGTH];
  int required_time;
};

struct TreeNode;

struct ListNode {
  struct TreeNode * child;
  struct ListNode * next;
};

struct TreeNode {
  struct task myTask;
  struct ListNode myChildList;
}; 
```

# sql-server - 升级到 64 位后出现奇怪的 SQL Server 内存错误

> ID：189856
> 
> 赞同：0
> 
> 时间：2008-10-10T01:52:12.480
> 
> 标签：sql-server, memory

我们刚刚将生产数据库服务器从 32 位“升级”到了 64 位。它在 Windows Server 2003 上运行 SQL Server 2005 Standard。在升级后的晚上，服务器近一个小时不可用 - 客户端请求超时。然后问题似乎自行解决了。我对这个问题的唯一线索是 SQL 服务器日志中的内容：

LazyWriter：警告，未找到可用缓冲区。

内存管理器 VM 保留 = 8470288 KB VM 已提交 = 2167672 KB AWE 分配 = 0 KB 保留内存 = 1024 KB 使用中的保留内存 = 0 KB

消息内存节点 ID = 0 VM Reserved = 8464528 KB VM Committed = 2162000 KB AWE Allocated = 0 KB SinglePage Allocator = 103960 KB MultiPage Allocator = 31832 KB

MEMORYCLERK_SQLGENERAL (Total) VM Reserved = 0 KB VM Committed = 0 KB AWE Allocated = 0 KB SM Reserved = 0 KB SM Committed = 0 KB SinglePage Allocator = 4352 KB

然后还有更多以 MEMORYCLERK 开头的类似消息。

有谁知道发生了什么？似乎它的内存已经用完了，而且，当然，服务器只有 2GB 的物理 RAM，这不是今天的标准，但它肯定不应该完全停止工作吗？我应该将SQL允许使用的最大内存设置为1.6GB左右吗？我还能做些什么（显然，除了安装更多 RAM）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T02:34:48.213

2GB肯定不是很多。事实上，我相信微软建议你有 2GB 的内存来运行操作系统和其他任务。

[查看此博客帖子](http://blogs.msdn.com/slavao/archive/2006/11/13/q-a-does-sql-server-always-respond-to-memory-pressure.aspx)和[此 microsoft 论坛帖子](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1739998&SiteID=1)以获取更多信息。

内存很便宜，如果可以的话添加更多。

[![替代文字](https://i.stack.imgur.com/goN9f.jpg)](https://i.stack.imgur.com/goN9f.jpg)
[（来源：[wordpress.com](http://icanhascheezburger.files.wordpress.com/2008/03/funny-pictures-computer-more-rams-field.jpg)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T00:01:50.960

有一些关于 MSSQL 分配足够内存导致磁盘[1](http://support.microsoft.com/kb/918483/en-us)出现页面错误的零星报告——当然，这会导致性能急剧下降。

虽然我没有看到任何来自 MS 的官方消息，但有报告称将最大内存设置为比物理 RAM 少 512M 到 1G 之间的某个位置应该会有所帮助。

企业版允许您防止 MSSQL 页面被分页，这也应该可以解决问题。而且，显然，更多的 RAM 会有所帮助 - 但可能不会缓解它。

[1](http://support.microsoft.com/kb/918483/en-us)关于 MSSQL 是否试图分配过多 RAM、操作系统是否将其分页或 MSSQL 只是分配到错误的池，存在一些争论。无论如何，max mem 应该可以帮助案例 1 和 2，SP2 应该可以解决案例 3。

编辑：一位同事向我指出了一篇相关的[知识库文章](http://support.microsoft.com/kb/918483/en-us)，其中列出了一些修补程序。它引用了不同的错误消息（您是否正在运行 SP2？），但症状和行为似乎适合您的情况。

# python - 调用 re.compile 时，什么属性返回正则表达式？

> ID：189861
> 
> 赞同：1
> 
> 时间：2008-10-10T01:55:27.530
> 
> 标签：python, regex

```
def foo ():
   x = re.compile('^abc')

   foo2(x)

def foo2(x): 
```

我如何让 x 返回`'^abc'`？在以下代码中

```
logging.info('x is ' + x.???) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T02:03:04.737

[图案](http://www.python.org/doc/2.5.2/lib/re-objects.html)

# sqlite - 远程管理 Sqlite DB 的最佳方法是什么？

> ID：189873
> 
> 赞同：0
> 
> 时间：2008-10-10T02:06:42.280
> 
> 标签：sqlite, remote-administration

我们的 Linux/PHP 生产网络服务器上有一个 Sqlite DB。远程管理它的最佳方法是什么？我发现一些服务器包装器可用，并且一些应用程序声称提供远程访问方法。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T11:39:11.003

[Gindi](http://www.codeproject.com/KB/database/SQLite_Server.aspx)在 Codeproject 上的 SQLITE 客户端/服务器看起来像是对包装器的一次有趣而认真的尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T02:09:30.480

SSH 进入并使用 SQLite 命令行客户端。

*但是……你为什么在生产*网络服务器上使用 SQLite ！？甚至 SQLite 网站也建议不要这样做！

# windows - 使用 Microsoft SMS Sender 批量发送短信？

> ID：189876
> 
> 赞同：0
> 
> 时间：2008-10-10T02:08:24.743
> 
> 标签：windows, sms

我知道我们可以在命令行模式下使用 SMS Sender。但我得到的这个错误和这篇文章一样[http://www.oreillynet.com/pub/a/wireless/2003/10/10/sms.html](http://www.oreillynet.com/pub/a/wireless/2003/10/10/sms.html)

smssender.exe 将使用最后一个成功用于在 Windows 版本的 SMS Sender 中发送消息的设备。但是我试了很多次，smssender.exe总是抱怨没有使用最后一个设备。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-09T21:38:32.787

不是您问题的直接答案，但可能会有所帮助..

看看那里的一些短信网关服务。我使用 Kapow 取得了很大的成功。

[http://www.kapow.co.uk/](http://www.kapow.co.uk/)

这是一家英国公司，但我敢肯定你会在你的国家找到一家。

大多数服务都提供了一个很好的易于使用的 web api，并为您提供了良好的交付报告等。它们通常不是免费的，但与您的低容量标准移动费率相当，而对于高容量则相当便宜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-13T21:58:50.857

Just discovered the answer to your question nad it is really easy.... just use the first time the GUI version of SMSSENDER.EXE and in the Options menu, select enable logging... after thar you can start using the command line with success.

# regex - 正则表达式验证网站与特定页面的索引

> ID：189878
> 
> 赞同：1
> 
> 时间：2008-10-10T02:08:44.163
> 
> 标签：regex, url

我正在寻找一个正则表达式，它允许我验证字符串是否是对网站地址或该网站中特定页面的引用。

所以它会匹配：

```
http://google.com
ftp://google.com
http://google.com/
http://lots.of.subdomains.google.com 
```

但不是：

```
http://google.com/search.whatever
ftp://google.com/search.whatever
http://lots.of.subdomains.google.com/search.whatever 
```

有任何想法吗？我不太清楚如何处理允许`/`URL 末尾的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T02:38:28.737

试试这个：

```
(http|ftp|https)://([a-zA-Z0-9\-\.]+)/? 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T06:44:35.013

这是我的完整 URI 验证模式的缩短版本，基于[规范](http://www.ietf.org/rfc/rfc2396.txt)。我写这个是因为规范允许许多字符从未包含在我在网络上找到的任何验证模式中。您会看到用户/密码（以及在第二种模式中，路径和查询字符串）比您想象的要宽松得多。

```
/^(https?|ftp):\/\/(?#                                      protocol
)(([a-z0-9$_\.\+!\*\'\(\),;\?&=-]|%[0-9a-f]{2})+(?#         username
)(:([a-z0-9$_\.\+!\*\'\(\),;\?&=-]|%[0-9a-f]{2})+)?(?#      password
)@)?(?#                                                     auth requires @
)((([a-z0-9][a-z0-9-]*[a-z0-9]\.)*(?#                       domain segments AND
)[a-z]{2}[a-z0-9-]*[a-z0-9](?#                              top level domain OR
)|(\d|[1-9]\d|1\d{2}|2[0-4][0-9]|25[0-5]\.){3}(?#
    )(\d|[1-9]\d|1\d{2}|2[0-4][0-9]|25[0-5])(?#             IP address
))(:\d+)?(?#                                                port
))\/?$/i 
```

而且由于我花时间将其分解为更具可读性，因此这是完整的模式：

```
/^(https?|ftp):\/\/(?#                                      protocol
)(([a-z0-9$_\.\+!\*\'\(\),;\?&=-]|%[0-9a-f]{2})+(?#         username
)(:([a-z0-9$_\.\+!\*\'\(\),;\?&=-]|%[0-9a-f]{2})+)?(?#      password
)@)?(?#                                                     auth requires @
)((([a-z0-9][a-z0-9-]*[a-z0-9]\.)*(?#                       domain segments AND
)[a-z]{2}[a-z0-9-]*[a-z0-9](?#                              top level domain OR
)|(\d|[1-9]\d|1\d{2}|2[0-4][0-9]|25[0-5]\.){3}(?#
    )(\d|[1-9]\d|1\d{2}|2[0-4][0-9]|25[0-5])(?#             IP address
))(:\d+)?(?#                                                port
))(((\/+([a-z0-9$_\.\+!\*\'\(\),;:@&=-]|%[0-9a-f]{2})*)*(?# path
)(\?([a-z0-9$_\.\+!\*\'\(\),;:@&=-]|%[0-9a-f]{2})*)(?#      query string
)?)?)?(?#                                                   path and query string optional
)(#([a-z0-9$_\.\+!\*\'\(\),;:@&=-]|%[0-9a-f]{2})*)?(?#      fragment
)$/i 
```

请注意，某些（全部？）javascript 实现不支持正则表达式中的注释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T03:45:12.440

杰里米的回答很好。根据您要匹配的正则表达式方言，您可能希望用锚点包装整个表达式（以避免匹配 URL，例如`http://example.com/bin/cgi?returnUrl=http://google.com`），并可能概括有效的协议和域名字符：

```
^\w+://(\w+\.)+\w+/?$ 
```

# php - mysql中的if语句？

> ID：189887
> 
> 赞同：0
> 
> 时间：2008-10-10T02:13:28.477
> 
> 标签：php, mysql

当涉及到 mysql 查询语句时，是否有 if 语句？

当我更新表记录时，我只想更新某些列，如果它们有要更新的值。

例如，我想要一个更新表格功能，有一个供志愿者使用的表格，还有一个供只需要电子邮件更新的人使用的表格。

我想使用相同的功能（将有一个只处理upd查询的功能）并且理论上可以做到这一点......

如果您正在更新志愿者表，则仅更新这些列，如果是 mailing_list，则更新这些

我知道这可以通过使用带有两个查询语句的 if 语句来完成，具体取决于您要更新的表，但我想知道是否可以只使用一个带有条件的查询语句来更新其中的适当列桌子。

这听起来像是你梦寐以求的事情，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T03:25:06.740

我认为这应该有效：

```
UPDATE volunteer, people
SET volunteer.email = 'me@email.com',
    people.email = 'other@gmail.com',
    people.first_name = 'first',
WHERE people.id = 2 AND volunteer.id = 5; 
```

我从MySQL 网站上的[更新语法中得到了这个。](http://dev.mysql.com/doc/refman/5.1/en/update.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T04:41:29.177

您*可以*在一个查询中执行此操作，但对我来说，您为什么想要这样做是没有意义的。也许描述你想要的函数的参数以及它们会产生什么影响？

您可以有条件地更新如下内容：

```
update tablereferences
    set foo.bar = if( somebooleanexpression, newbarvalue, foo.bar ),
        baz.quux = if( somebooleanexpression, newbazvalue, baz.quux )
    where ... 
```

允许您使用相同的查询，但控制哪些表被更新。

# java - Java MessageFormat - 如何在单引号之间插入值？

> ID：189889
> 
> 赞同：67
> 
> 时间：2008-10-10T02:15:16.710
> 
> 标签：java

我在使用 java.text.MessageFormat 对象时遇到问题。

我正在尝试创建 SQL 插入语句。问题是，当我做这样的事情时：

```
MessageFormat messageFormat = "insert into {0} values ( '{1}', '{2}', '{3}', {4} )";
Object[] args = { str0, str1, str2, str3, str4 };
String result = messageFormat.format(args); 
```

我得到这个的价值`result`：

```
"insert into <str0> values ( {1}, {2}, {3}, <str4> )" 
```

如您所见，问题在于单引号括起来的任何目标位置都不会被参数替换。我尝试过使用这样的双单引号：`''{1}''`和这样的转义字符：`\'{1}\'`但它仍然给出相同的结果。

编辑：我忘了提我也试过了`'''{1}'''`。结果是：`"insert into <str0> values ( '{1}', '{2}', '{3}', <str4> )"`。它保留了原始引号，但仍未插入值。

我该如何解决这个问题？作为记录，我使用的是 JDK 6u7。

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2008-10-10T02:44:06.340

我刚刚尝试了双引号，对我来说效果很好：

```
MessageFormat messageFormat = new MessageFormat("insert into {0} values ( ''{1}'', ''{2}'', ''{3}'', {4} )");
Object[] args = {"000", "111", "222","333","444","555"};
String result = messageFormat.format(args); 
```

结果是：

```
insert into 000 values ( '111', '222', '333', 444 ) 
```

这是你需要的吗？

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-10T03:44:29.527

抱歉，如果这不在一边，但看起来您正在尝试复制已经在 J​​DBC 中的 PreparedStatement。

如果您尝试创建 SQL 以针对数据库运行，那么我建议您查看 PreparedStatement，它已经完成了您正在尝试执行的操作（语法略有不同）。

对不起，如果这不是你在做什么，我只是想我会指出来。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-10T02:18:20.387

> 在*String*中，一对单引号可用于引用除单引号之外的任意字符。例如，模式字符串`"'{0}'"`表示 string `"{0}"`，而不是*FormatElement*。单引号本身必须由`''`整个 a中的双单引号表示`String`。例如，模式字符串`"'{''}'"`被解释为`'{`（引号开头和左大括号）、`''`（单引号）和`}'`（右大括号和引号结尾）的序列，**而不是** `'{'`和`'}'`（带引号的左右大括号） : 代表字符串`"{'}"`，**不是** `"{}"`。

来自：[MessageFormat（Java 平台 SE 8）](https://docs.oracle.com/javase/8/docs/api/java/text/MessageFormat.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T02:19:01.570

使用三重单引号字符：

```
MessageFormat messageFormat = "insert into {0} values ( '''{1}''', '''{2}''', '''{3}''', '''{4}''' )"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T02:18:07.517

首先想到的是更改 str1、str2、str3 以在它们周围加上单引号。

```
对象[] args = { str0, "'" + str1 + "'", "'" + str2 + "'", "'" + str3 + "'", str4 };

```

然后，当然，从查询字符串中删除单引号。

# c++ - 在 C/C++ 中处理可变大小数组的最佳实践？

> ID：189892
> 
> 赞同：4
> 
> 时间：2008-10-10T02:16:26.520
> 
> 标签：c++, c, arrays

如果我有一个固定大小的数组，具体取决于它的定义和使用方式，我通常使用两种方法之一来引用它。

数组类型 1：由于它是基于定义的固定大小，因此我只在所有引用它的循环中使用该定义。

```
#define MAXPLAYERS 4

int playerscores[MAXPLAYERS];

for(i=0;i<MAXPLAYERS;++i)
{
.... do something with each player
} 
```

数组类型 2：由于这个数组可以随着添加项目而增长，所以我使用 sizeof 来计算其中的条目数。大小将由编译器转换为常量，因此这样做不应该有任何运行时损失。

```
typedef struct
{
    fields....
}MYSTRUCT_DEF;

MYSTRUCT_DEF mystruct[]={
   {entry 1},
   {entry 2},
   {entry 3...n}
   };

 for(i=0;i<(sizeof(mystruct)/sizeof(MYSTRUCT_DEF));++i)
 {
 ..... do something with each entry
 } 
```

是否有更优雅的解决方案来处理数组处理而不会超过结尾或过早停止。想法？评论？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T02:23:45.647

无论数组元素类型如何，这都适用于您的两种情况：

```
#define ARRAY_COUNT(x) (sizeof(x)/sizeof((x)[0]))

...

struct foo arr[100];
...

for (i = 0; i < ARRAY_COUNT(arr); ++i) {
    /* do stuff to arr[i] */
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T02:25:22.070

在 C++ 中，只需使用向量类。

如果由于某种原因你不能，那么有你想要的宏实现。请参阅此答案以获取 winnt.h 中在 C 中工作并且在 C++ 中更安全的一组宏：

[这个宏可以转换成函数吗？](https://stackoverflow.com/questions/95500/can-this-macro-be-converted-to-a-function#95714)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T02:32:57.110

使用 stdlib.h 的 _countof 宏

[从这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms175773(VS.80).aspx)：

```
// crt_countof.cpp
#define _UNICODE
#include <stdio.h>
#include <stdlib.h>
#include <tchar.h>
int main( void )
{
   _TCHAR arr[20], *p;
   printf( "sizeof(arr) = %d bytes\n", sizeof(arr) );
   printf( "_countof(arr) = %d elements\n", _countof(arr) );
   // In C++, the following line would generate a compile-time error:
   // printf( "%d\n", _countof(p) ); // error C2784 (because p is a pointer)

   _tcscpy_s( arr, _countof(arr), _T("a string") );
   // unlike sizeof, _countof works here for both narrow- and wide-character strings
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T03:03:11.527

看到像这样的 C 代码是很常见的

```
struct foo {
    ...  /* fields */
};
struct foo array[] = {
    { ... }, /* item 1 */
    { ... }, /* item 2 */
    ...,
    { 0 } /* terminator */
};
for (i = 0; array[i].some_field; i++) {
    ...
} 
```

通常你可以找到至少一个对于普通元素从不`0`/的字段`NULL`，如果不是，你可以使用其他一些特殊的 END 值。

在我编写的代码中，涉及编译时大小的数组的任何事情都是使用`ARRAY_COUNT`Checkers 的答案中的宏完成的，并且运行时大小的数组总是带有一个大小计数器，在一个带有数组的结构中。

```
struct array_of_stuff {
    struct stuff *array;
    int count;   /* number of used elements */
    int length;  /* number of elements allocated */
}; 
```

该`length`字段允许轻松批量调整大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T02:34:21.087

对于 C，我建议 realloc 动态引入新变量。如果您正在静态地做某事，我建议您使用#define。我不确定我是否会称之为最佳实践，但是，今天，我就是这样实践的。

C++ 最佳实践是使用 stl::vector。[参考这里](http://www.cplusplus.com/reference/stl/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T02:34:32.647

我几乎总是使用包装类（MFC CArray、stl 向量等），除非有特殊原因。没有太多开销，你会得到很多调试检查，你可以动态调整大小，获取大小很容易，等等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T08:27:01.513

## 对于 C++，使用 std::vector

使用 C 数组没有实际意义。std::vector 具有（几乎）与 C 数组相同的性能，它将：

*   根据需要增长
*   知道它的大小
*   验证您是否真的在访问正确的内存（即，如果您超出其界限，它可能会引发异常）

这甚至没有考虑与 std::vector 相关的通用算法。

## 现在，使用 C

你至少可以通过两种方式写得更好一些。首先，用真正的常量变量替换定义：

```
// #define MAXPLAYERS 4
const unsigned int MAXPLAYERS = 4 ;

int playerscores[MAXPLAYERS];

for(i=0;i<MAXPLAYERS;++i)
{
.... do something with each player
} 
```

使用真正的变量将为您提供更多的类型安全性，并且不会污染全局范围。为了最小化依赖性，您甚至可以在标头中声明变量，并在源中定义它们：

```
/* header.h */
extern const unsigned int MAXPLAYERS ;
extern int playerscores[] ;

/* source.c */
const unsigned int MAXPLAYERS = 4
int playerscores[MAXPLAYERS];

/* another_source.c */
#include "header.h"

for(i=0;i<MAXPLAYERS;++i)
{
.... do something with each player
} 
```

这样，您将能够在一个源中更改数组的大小，而无需重新编译使用它的所有源。缺点是 MAXPLAYERS 在编译时不再为人所知（但是，这真的是缺点吗？）

请注意，您的第二种类型的数组不能动态增长。sizeof（至少在 C++ 中）在编译时进行评估。对于不断增长的数组， malloc/realloc/free 是 C 中的方式，而 std::vector（或任何其他通用 STL 容器）是 C++ 中的方式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-10T09:28:53.573

确保还阅读[了这个问题的答案](https://stackoverflow.com/questions/95500/can-this-macro-be-converted-to-a-function)- 数组大小问题的许多解决方案*都是*可移植的。

我特别喜欢`_countof`（cfr. Brian R. Bondy 的回答）——普利策这个名字的发明者！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T14:48:23.247

除了到目前为止的答案之外，如果您在 C++ 中使用 T[] 数组：使用模板参数推导来推导数组大小。它更安全：

`template<int N> void for_all_objects(MYSTRUCT_DEF[N] myobjects)`

`sizeof(mystruct)/sizeof(MYSTRUCT_DEF)`如果您将 mystruct 更改为 malloc'ed/new'ed ，您的表达式会非常安静地失败`MYSTRUCT_DEF*`。`sizeof(mystruct)`然后变成`sizeof(MYSTRUCT_DEF*)`，它通常小于`sizeof(MYSTRUCT_DEF)`，并且您的循环计数为 0。看起来代码根本没有执行，这可能非常令人困惑。上面的模板声明会给你一个明确的编译器错误（“mystruct is not an array”）

# delphi - 有没有办法在 Delphi 7 中获得代码折叠？

> ID：189893
> 
> 赞同：2
> 
> 时间：2008-10-10T02:16:41.963
> 
> 标签：delphi, delphi-7, code-folding

我知道这是一个很长的镜头——但有没有办法让代码折叠到 Delphi 7 中？

我正在研究一些 .. “次优” .. 代码。有时我真的需要折叠一些东西来理解一个愚蠢的长程序。目前，我正在将代码粘贴到 Notepad++ 中，它可以工作，但将它放在 IDE 中会很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T02:33:50.993

[在这个FAQ](http://www.gexperts.org/faq.html) （针对GExperts）上寻找“方法折叠” ，你会发现即使是这个为Delphi添加了许多增强功能的团队，也不认为这在Delphi 7中。我已经寻找解决方案并没有看到他们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T09:16:45.720

我不知道如何在 Delphi 7 中进行代码折叠，但是有一些 Delphi 插件可以让查看代码变得更好

德尔福的 Castalia [http://www.twodesks.com/castalia/](http://www.twodesks.com/castalia/)

还有一个免费的cnPack [http://www.cnpack.org/index.php?lang=en](http://www.cnpack.org/index.php?lang=en)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T04:16:34.313

不完全相同，但您可以将“折叠”代码放入单独的文件中，然后使用**{$I filename.inc}**编译器指令包含该文件。自从我使用 Delphi 7 以来已经有一段时间了，但我相信如果您将光标放在文件名上并按住控件并单击文件名，则会在 ide 中打开。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T08:45:48.870

{$i filename.inc} 是正确的方法。我有类似的次优代码，并且在主窗体之外放置了 8.000 行“死”数据库更新代码（将其降低到 12.000 行次优代码）。包含文件有助于隔离功能，因此简化了将其放入类的最终任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T17:58:02.160

如前所述，您可以使用包含文件。但就个人而言，我不喜欢将部分代码删除到另一个文件的想法，尤其是过程的一部分（如果我以正确的方式解释你的问题）。我更喜欢使用书签来快速浏览过程，跳过不相关的部分，并使用 Ctrl+Shift+Up/Down 组合键在方法的实现和定义之间交替。

# mysql - MySQL 的扩展解决方案（复制、集群）

> ID：189903
> 
> 赞同：85
> 
> 时间：2008-10-10T02:21:52.657
> 
> 标签：mysql, replication, scaling, cluster-computing, database-cluster

在我工作的[初创公司，我们现在正在考虑为我们的数据库扩展解决方案。](http://www.binpress.com)事情变得有点混乱（至少对我来说）MySQL，它有[MySQL 集群](http://dev.mysql.com/doc/refman/5.0/en/faqs-mysql-cluster.html)、[复制](http://dev.mysql.com/doc/refman/5.0/en/replication.html)和[MySQL 集群复制](http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-replication.html)（从版本 5.1.6 开始），这是 MySQL 集群的异步版本。[MySQL 手册在其集群常见问题解答](http://dev.mysql.com/doc/refman/5.0/en/faqs-mysql-cluster.html#qandaitem-22-10-3)中解释了一些差异，但很难从中确定何时使用其中一种。

如果熟悉这些解决方案之间的差异以及利弊，以及您何时建议使用每种解决方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-10-12T05:23:19.140

我一直在阅读有关可用选项的大量内容。我还获得了我强烈推荐的高性能 MySQL 第 2 版。

这是我设法拼凑起来的：

## 聚类

一般意义上的集群是在许多服务器上分配负载，这些服务器在外部应用程序中表现为一台服务器。

### MySQL NDB 集群

MySQL NDB Cluster 是一个分布式的、内存中的、无共享的存储引擎，具有同步复制和自动数据分区（对不起，我从《高性能》一书中借用了字面意思，但他们把它放在那里很好）。对于某些应用程序来说，它可能是一个高性能的解决方案，但 Web 应用程序通常不能很好地在它上面运行。

主要问题是，除了非常简单的查询（仅涉及一张表）之外，集群通常必须在多个节点上搜索数据，从而导致网络延迟蔓延并显着减慢查询的完成时间。由于应用程序将集群视为一台计算机，它无法告诉它从哪个节点获取数据。

此外，对于许多大型数据库来说，内存中的要求是不可行的。

### 连续红杉

这是 MySQL 的另一个集群解决方案，它充当 MySQL 服务器之上的中间件。它提供同步复制、负载平衡和故障转移。它还确保请求始终从最新副本中获取数据，自动选择具有新数据的节点。

我已经阅读了一些关于它的[好东西](http://www.oreillynet.com/onlamp/blog/2005/10/continuent_clustering_software.html)，总的来说它听起来很有希望。

### 联邦

联邦类似于集群，所以我也把它拖到这里。MySQL 通过联合存储引擎提供联合。与 NDB 集群解决方案类似，它仅适用于简单查询 - 但对于复杂查询的集群更糟糕（因为网络延迟要高得多）。

## 复制和负载平衡

MySQL 具有在不同服务器上创建数据库复制的内置能力。这可以用于许多事情——在服务器之间分配负载、热备份、创建测试服务器和故障转移。

复制的基本设置包括一台主服务器处理主要是写入，而一台或多台从服务器只处理读取。一个更高级的变体是[master-master](http://en.wikipedia.org/wiki/Multi-master_replication)配置，它允许通过同时写入多个服务器来扩展写入。

每种配置都有其优点和缺点，但它们都有一个共同的问题是复制滞后——由于 MySQL 复制是异步的，并非所有节点都始终拥有最新的数据。这要求应用程序知道复制并结合复制感知查询以按预期工作。对于某些应用程序，这可能不是问题，但如果您总是需要最新的数据，事情就会变得有些复杂。

复制需要一些负载平衡来分配节点之间的负载。这可以像对应用程序代码的一些修改一样简单，或者使用专用的软件和硬件解决方案。

## 分片和分区

分片是扩展数据库解决方案的常用方法。您将数据拆分为更小的碎片，并将它们分布在不同的服务器节点上。这要求应用程序意识到对数据存储的修改才能有效地工作，因为它需要知道在哪里可以找到所需的信息。

有一些抽象框架可用于帮助处理数据分片，例如[Hibernate Shards](http://www.hibernate.org/414.html)，它是 Hibernate ORM 的扩展（不幸的是，它在 Java 中。我正在使用 PHP）。[HiveDB](http://www.hivedb.org)是另一个这样的解决方案，它也支持分片重新平衡。

## 其他

### 狮身人面像

[Sphinx](http://www.sphinxsearch.com/)是一个全文搜索引擎，它不仅可以用于测试搜索。对于许多查询，它比 MySQL 快得多（尤其是对于分组和排序），并且可以并行查询远程系统并聚合结果——这使得它在使用分片时非常有用。

一般来说，sphinx 应该与其他扩展解决方案一起使用，以获得更多可用的硬件和基础设施。缺点是您需要应用程序代码再次了解 sphinx 才能明智地使用它。

## 概括

扩展解决方案根据需要它的应用程序的需求而有所不同。对于我们和大多数 Web 应用程序，我相信复制（可能是多主机）是使用负载均衡器分配负载的方式。特定问题区域（巨大的表）的分片也是能够水平扩展的必要条件。

我还将试一试Continuent Sequoia，看看它是否真的能做到它所承诺的，因为它将涉及对应用程序代码的最少更改。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-10T04:03:00.283

免责声明：我没有使用过 MySQL Cluster，所以我只是根据我所听到的。

MySQL Cluster 是一种 HA（高可用性）解决方案。它很快，因为它都在内存中，但它的真正卖点是可用性。没有单点故障。另一方面，如果使用复制，如果主服务器宕机，您必须实际切换到副本，并且可能会有少量宕机时间。（虽然 DRBD 解决方案是另一种具有高可用性的替代方案）

集群要求您的整个数据库适合内存。这意味着集群中的每台机器都需要有足够的内存来存储整个数据库。所以这对于非常大的数据库来说不是一个可行的解决方案（或者至少它是一个非常昂贵的解决方案）。

我认为除非 HA 非常重要（阅读：可能不是），否则它比它的价值更麻烦（和金钱）。复制通常是更好的方法。

**编辑：**我也忘了提到集群不允许外键，并且范围扫描比其他引擎慢。这是一个关于[MySQL 集群的已知限制的链接](http://mysql2.mirrors-r-us.net/doc/refman/5.1/en/mysql-cluster-limitations.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T03:54:14.793

关于维护 drupal.org 的人如何构建他们的数据库服务器，有一些很好的讨论：

*   [Dries Buytaert 的博客](http://buytaert.net/scaling-with-mysql-replication)
*   [工作习惯博客](http://www.workhabit.com/labs/database-scalability-and-drupal)

两者都是从 2007 年开始的，所以现在集群支持可能更强，但当时他们选择了复制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-21T18:04:01.270

进行复制的酷之处在于它很容易。只需设置 2 个 mysql 框，更改第二个框上的 serverID，然后使用 change master to 命令将第二个框指向第一个框。

这是相关的示例从机 my.cnf 配置

```
#
#       Log names
#

log-bin=binlog
relay-log=relaylog
log-error=errors.log

#
#       Log tuning
#

sync_binlog = 1
binlog_cache_size = 1M

#
#       Replication rules (what are we interested in listening for...)
#
#       In our replicants, we are interested in ANYTHING that isn't a permission table thing
#

replicate-ignore-db =      mysql
replicate-wild-ignore-table=mysql.%

#
#       Replication server ID
#

server-id      =        2 
```

因此，请确保每个从站都获得一个加 1 的 serverID（因此下一个从站是服务器 3）

设置slave可以连接的用户名和密码，然后运行change master to MASTER_HOST = 'xxxx'; 将 master 更改为 MASTER_PASSWORD = "xxxxx";

等等。

最后，运行“start slave;”

你的奴隶出现并开始复制。甜啊！

这假设您从 2 个空服务器开始。然后你可以将你的数据库转储到主服务器，当它在那里加载时，它也会加载到从服务器上。

您可以通过运行检查从站状态：

显示从属状态 \G

玩得开心..太容易了...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-27T17:34:57.100

在进行高可用性研究时，我遇到了许多解决方案，在我们的案例中可能是写入密集型系统，我发现 DRBD 集群比 NDB 集群更好，因为它每秒提供更多的事务数。

Mysql Replication 可以为您提供一个备份机器，它既可以用作读取从机，也可以用于灾难恢复。

通过 DRBD 提供的不同事务管理模式，您可以降低网络上设备级数据复制对性能的影响。对于在失败的情况下不应该丢失任何事务的可靠系统，使用 C 模式，否则使用 B。

[我试图在http://www.techiegyan.com/?p=132](http://www.techiegyan.com/?p=132)上列出我在设置 DRBD 集群期间所做的一些学习

它在用于复制的专用连接上非常有效，即在两台机器上保留单独的高速接口仅用于 drbd 复制。Heartbeat 可以很好的控制集群的所有服务，IP 地址、分区、drbd 和mysql。

我还没有发现 DRBD 上的 Master-Master 配置。当我在这方面取得成功时会更新。

谢谢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-03T16:43:04.263

在我看来，这里的混乱只会让我回到 Mnesia。具有碎片化、声明式和实用的索引处理方式、数据库副本的位置透明性等

在我们的设置中，我们同时运行 MySQL Cluster 和 Mnesia。我们的数据有点季节性。所以会发生什么，在某个时间之后，我们解除不再使用的数据的记忆错误并将其放入 MYSQL 集群中。这使我们的记忆保持高效。此外，我们还有使用直接来自 MySQL 的数据的主流语言（Python、Clojure 等）实现的应用程序。

简而言之，我们在 MySQL Cluster 之上运行 mnesia。MySQL Cluster 可以处理大型数据集，一个数据库可以增长到 50GB 以上。我们有 mnesia 为**Erlang/OTP**应用程序提供动力。**Java**和**PHP**通过使用 JSON 和 XML 作为交换格式的定制**REST**（最近称为**Thrift** ）API从 mnesia 访问数据。

如果需要，数据访问层已经抽象了对 Mnesia 中的数据和 MySQL Cluster 中的旧数据的访问。Mnesia 本质上是为 Erlang/OTP 应用程序提供动力。一旦它被数据占用，我们将其放入 MYSQL 集群中。数据访问层可以代表所有应用程序以抽象的 API 访问 mnesia 和 MySQL 中的数据。

我在这里可以说的是，Mnesia 一直是我们的最佳选择。这些表是高度碎片化和索引的，查询执行得非常好，并且数据库在 2 个位置复制，通过隧道连接。

早些时候，我们担心由于表大小的限制，mnesia 可能无法处理尽可能多的记录。但我们发现这个说法是错误的。通过良好的调整（碎片化），我们的 mnesia 数据库确实每年平均保存约 2.5 亿条记录。

我们受益于 Erlang 复杂的数据结构以及 Mnesia 可以原封不动地吞并它的事实。Erlang /OTP 应用程序是传统语言中所有其他应用程序中效率最高的，我们计划通过我们的系统将其全部迁移到 Erlang/OTP 技术。从Erlang我们可以无缝地访问MySQL Cluster的数据，并非常奇妙地在其服务器上执行查询，事实上，我们推断出它的Erlang/OTP可以充分利用MySQL服务器资源，因为它的（Erlang）海量并发。

Mnesia 非常适合我们。Mnesia 因其令人兴奋的性能而彻底改变了我们看待数据库的方式。我们的 Solaris 服务器 CPU 内核在高峰时段保持繁忙，平均使用率约为 48%。

我建议您查看 mnesia，谁知道呢，它可能会满足您的许多分发或复制需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T03:25:23.090

我没有使用它们，但是从文档中我会说如果最大的负载是从数据库中读取，那么复制是首选的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T04:21:27.547

“内存中”的限制使我们无法使用 MySQL 集群来处理近 50Gb 的数据，因此我们使用**DRBD 和 linux Heartbeat**。

这有点像两个（或更多）盒子之间的RAID阵列，它使数据库/日志/配置保持同步（但一次只能“活”一个服务器）。故障转移是自动的，使用相同的 IP 地址，并且与 mysql 重启一样快，所以这对我们来说是一个很好的解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-21T21:51:07.297

MySQL 集群是一个奇怪的野兽，每次我们评估它时，要么性能很差，要么不可靠。

设置起来非常复杂（您至少需要三个节点，可能更多）。此外，没有规定让客户端进行故障转移，因此您必须自己做（或使用其他东西充当代理等）。

它非常聪明，因为它在主键上进行自动哈希分区，允许您扩展写入，还因为它没有单点故障。

但我真的认为它更适合它设计的非常特殊的用途。在大多数情况下，它在性能或功能方面都无法替代另一个数据库引擎（例如 InnoDB）。

# linux - 在 Debian 上将 Subversion 1.4.3 升级到 1.5.2（托管帐户）

> ID：189906
> 
> 赞同：3
> 
> 时间：2008-10-10T02:22:49.643
> 
> 标签：linux, svn, version-control, debian, dreamhost

我正在尝试升级我的颠覆服务器（我使用 Dreamhost 托管）

这就是我运行的：

*   wget [http://subversion.tigris.org/downloads/subversion-1.5.2.tar.bz2](http://subversion.tigris.org/downloads/subversion-1.5.2.tar.bz2)
*   wget [http://subversion.tigris.org/downloads/subversion-deps-1.5.2.tar.bz2](http://subversion.tigris.org/downloads/subversion-deps-1.5.2.tar.bz2)
*   tar -xjf subversion-1.5.2.tar.bz2
*   tar -xjf 颠覆-deps-1.5.2.tar.bz2
*   cd subversion-1.5.2
*   ./configure --prefix=/usr/bin --with-libs=/usr/bin/openssl --with-ssl

但由于此错误，我无法继续：

*   检查 C 编译器默认输出文件名...
*   **配置：错误：C 编译器无法创建可执行文件**
*   更多细节参见` [config.log](http://cid-e67e25d636aab24c.skydrive.live.com/self.aspx/Public/config.log) '。
*   霓虹灯配置失败

由于我不是 Linux 专家，因此我不确定如何继续。

所以问题是：什么是最好的升级方式（考虑到与这个托管提供商的限制）。

**更新：**

config.log的内容[可以在这里看到](http://cid-e67e25d636aab24c.skydrive.live.com/self.aspx/Public/config.log)（不知道在 SO 上显示文件的最佳方式）

**更新：**

我似乎一直在查看错误的 config.log 文件。
我可能应该一直在看**[subversion.1.5.2/neon/config.log](http://cid-e67e25d636aab24c.skydrive.live.com/self.aspx/Public/neon-config.log)**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T02:41:23.787

您需要在自己的帐户下构建自己的副本。

```
mkdir ~/src
cd ~/src
wget http://subversion.tigris.org/downloads/subversion-1.5.2.tar.bz2
wget http://subversion.tigris.org/downloads/subversion-deps-1.5.2.tar.bz2
tar -xjf subversion-1.5.2.tar.bz2
tar -xjf subversion-deps-1.5.2.tar.bz2
cd subversion-1.5.2
./configure --prefix=/home/$USER --with-ssl
make
make install 
```

如果您还没有，您还需要更改您的路径才能使其正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T12:17:41.717

使用时

```
./configure --prefix=/usr/bin --with-libs=/usr/bin/openssl --with-ssl 
```

然后你可以在 neon/config.log 中看到它搜索 /usr/bin/openssl/include 中的包含...虽然这当然只是一个二进制文件。因此，跳过这个“--with-libs”选项，只需确保使用安装了 ssl 开发包

```
apt-get install libssl-dev 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-01T04:44:33.350

如果您将 openssl 与 SVN 一起使用，那么您需要配置 SVN

```
./configure .... --with-openssl=/path/to/openssl 
```

当我过去这样做时，如果我没有指定`-fPIC`标志，我在构建使用此库的其他二进制文件时遇到了问题。因此，最好使用该参数运行 make（如果您有这个问题）。您可能还必须将 make 指向您的构建二进制文件。所以您的 make 调用将如下所示：

```
make CC="gcc -fPIC" LDFLAGS="/path/to/openssl/lib" 
```

不要忘记构建 openssl `CC="gcc -fPIC"`！

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T14:21:20.787

这可能是一种安全措施，如果系统受到威胁，理论上恶意用户将更难在系统上构建更多攻击代码以获得更多访问权限。

解决方案是在本地机器上交叉编译代码，然后将其传输到服务器。如果您无法按照 Aupajo 的建议安装到系统，请将可执行文件放在您的 $HOME/bin 目录中。请记住，这可能意味着您将无权运行 svn 服务器，只有客户端应用程序。

[这是一个使用 debian 进行交叉编译的链接，一些谷歌搜索应该为您提供更多信息。](http://people.debian.org/~debacle/cross/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T11:16:56.393

我也遇到了这个错误：

```
configure: error: C compiler cannot create executables 
```

就我而言，我有一个干净的 Debian Etch 安装，没有 C 编译器。我已经通过`apt-get install gcc`. 一些谷歌搜索导致我通过安装 g++

```
apt-get install g++ 
```

之后它起作用了。不确定这是否对您有帮助，但确实对我有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-11T13:22:50.097

在 ubuntu 上安装 pkg-config libtool libssl-dev ( `sudo apt install -y pkg-config libtool libssl-dev`) 为我解决了这个问题......

# c++ - 移植旧代码时如何处理类名冲突？

> ID：189921
> 
> 赞同：5
> 
> 时间：2008-10-10T02:32:50.340
> 
> 标签：c++, namespaces, ambiguity

我正在尝试将旧库（据我所知不使用名称空间）移植到现代编译器。我的目标之一无法区分 System::TObject 和 ::TObject （没有命名空间）。System::TObject 是编译器原生的。

我尝试了一个 using 指令，即 using ::TObject;

但这并没有。

显而易见的解决方案是将所有原始库包装在名称空间中，然后按名称调用它——这应该避免歧义。但这是最明智的解决方案吗？还有其他解决方案吗？添加命名空间需要更改一堆文件，我不知道以后是否会产生不必要的影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T04:57:09.830

您可以按照 Dib 的建议进行操作，稍作修改：

```
// In a wrapper header, eg: include_oldlib.h...

namespace oldlib
{
   #include "oldlib.h"
};

#ifndef DONT_AUTO_INCLUDE_OLD_NAMESPACE
using namespace oldlib;
#endif 
```

这允许您仅在遇到冲突的文件中#define 排除，否则将所有符号用作全局符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T03:03:04.820

您可以为所有旧函数制作一个包装器，并将它们打包到一个 DLL 或静态库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T02:44:53.780

如果您有库的源代码，则可能在每个源代码的顶部包含一个头文件，其中该头文件只有：

```
#define TObject TMadeUpNameObject 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T02:58:30.680

尝试这个：

```
namespace oldlib
{
   #inclcude "oldlib.h"
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T04:13:47.657

我过去在封装包含与代码冲突的类的第三方头文件时使用了以下内容：

```
#ifdef Symbol
#undef Symbol
#define Symbol ThirdPartySymbol
#endif
#include <third_party_header.h>
#undef Symbol 
```

这样，标题中的“符号”以 ThirdParty 为前缀，这与我的代码没有冲突。

# iphone - iPhone应用程序中的密码加密

> ID：189925
> 
> 赞同：8
> 
> 时间：2008-10-10T02:34:01.743
> 
> 标签：iphone, encryption

我需要将用户的密码存储在我的 iphone 应用程序中。

将应用程序发布到应用程序商店时，我必须告诉 Apple 应用程序中是否存在用于导出目的的加密。

我不希望我的应用程序仅限于美国，但我也不希望以明文形式通过网络存储或发送密码。

所以基本上问题是，我可以以一种不会限制我的应用程序的方式加密密码吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T05:57:41.257

只需将密码存储在钥匙串中即可。它是苹果提供的系统API，你不必知道任何关于加密的事情。Apple 发布它，是他们确保系统框架的出口合规性的责任。如果他们在禁止的任何地方出售设备，他们可能会使用较弱（或不使用）加密，但如果您使用可用的 API，您将不会在二进制文件中发送任何出口限制加密代码，并且您可以被解释的唯一方式因为这样做意味着苹果将随每部 iPhone 一起发货。

话虽如此，我不是律师，如果您担心，我建议您咨询。没有多少其他程序员的建议与根本上的法律问题特别相关。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T02:40:35.677

首先，如果用户名和密码在手机上加解密，那么解密密钥显然也在手机上，几乎一文不值。我不会担心在手机上存储加密的用户名和密码。

为了安全通信，您应该使用 SSL，它可能在电话上已经存在的库中。如果您使用的库是手机操作系统的一部分，我认为这并不意味着您的应用程序“包含加密”。

当然，我不是律师。谁知道——法律可能会认为“猪拉丁语”是一种有效的加密技术。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T02:46:13.293

看起来提供的 crypt() 函数可用于密码：

> 该库 (FreeSec 1.0) 是在美国以外开发的，作为 USonly libcrypt 加密库的无阻碍替代品。链接到 crypt() 接口的程序只能从美国导出，前提是它们仅将 crypt() 用于身份验证目的，并避免使用上面列出的其他程序员接口。库中已特别注意仅使用 crypt() 接口的程序不会引入其他组件。

（来自 crypt(3) 的 iphone 文档）

# c# - C# .Net 2005 中的 VB6 中的 XMLHTTP 等价物是什么？

> ID：189934
> 
> 赞同：2
> 
> 时间：2008-10-10T02:35:32.597
> 
> 标签：c#, xml, http, vb6

我正在尝试转换一些在 VB 中运行良好的代码，但我无法弄清楚要在 .Net 中使用哪些对象。

```
 Dim oXMLHttp As XMLHTTP
    oXMLHttp = New XMLHTTP
    oXMLHttp.open "POST", "https://www.server.com/path", False
    oXMLHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
    oXMLHttp.send requestString 
```

基本上，我想将 XML 文件发送到服务器，然后存储它返回的响应。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T09:39:03.443

答案是使用`WebClient`类：-

```
WebClient webClient = new WebClient();

NameValueCollection values = new NameValueCollection();

values.add("firstname", "Slarti");
values.add("lastname", "Bart-fast");

byte[] response = webClient.UploadValues("http://server/path", values); 
```

UploadValues 方法使用内容类型构建一个 POST 请求，`application/x-www-form-urlencoded`并正确编码`NameValueCollection`传递给它的一组值。

The response is a byte array that you can then do something appropriate with.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T02:47:45.660

有关执行此操作的示例，请参见以下内容：http: [//www.codeproject.com/KB/dotnet/NET_Interact_j2EE.aspx](http://www.codeproject.com/KB/dotnet/NET_Interact_j2EE.aspx) 我已将示例放在下面。对不起，我知道它很大，但你永远不知道这样的链接会保持多久。注意：问题的第一个版本没有在 C# .NET 中说 - 它只是说“在 .NET 中”。（也许它被标记为 C# 而我没有看到它） 从 VB.NET 转换为 C# 非常容易（尽管没有必要）。'该类表示 MSXML.XMLHTTP 中 xmlHTTP 对象的相同功能。

```
Imports System.Net
Imports System.Web.HttpUtility

Public Class XMLHTTP
'Makes an internet connection to specified URL 
   Public Overridable Sub open(ByVal bstrMethod As String, _
     ByVal bstrUrl As String, Optional ByVal varAsync As _
     Object = False, Optional ByVal bstrUser _
     As Object = "", Optional ByVal bstrPassword As Object = "")
       Try
           strUrl = bstrUrl
           strMethod = bstrMethod

           'Checking if proxy configuration 
           'is required...(blnIsProxy value 
           'from config file)
           If blnIsProxy Then
           'Set the proxy object
               proxyObject = WebProxy.GetDefaultProxy()

               'Finding if proxy exists and if so set 
               'the proxy configuration parameters...
               If Not (IsNothing(proxyObject.Address)) Then
                   uriAddress = proxyObject.Address
                   If Not (IsNothing(uriAddress)) Then
                       _ProxyName = uriAddress.Host
                       _ProxyPort = uriAddress.Port
                   End If
                   UpdateProxy()
               End If
               urlWebRequest.Proxy = proxyObject
           End If

           'Make the webRequest...
           urlWebRequest = System.Net.HttpWebRequest.Create(strUrl)
           urlWebRequest.Method = strMethod

           If (strMethod = "POST") Then
               setRequestHeader("Content-Type", _
                   "application/x-www-form-urlencoded")
           End If

           'Add the cookie values of jessionid of weblogic 
           'and PH-Session value of webseal 
           'for retaining the same session
           urlWebRequest.Headers.Add("Cookie", str_g_cookieval)

       Catch exp As Exception
           SetErrStatusText("Error opening method level url connection")
       End Try
   End Sub
   'Sends the request with post parameters...
   Public Overridable Sub Send(Optional ByVal objBody As Object = "")
       Try
           Dim rspResult As System.Net.HttpWebResponse
           Dim strmRequestStream As System.IO.Stream
           Dim strmReceiveStream As System.IO.Stream
           Dim encode As System.Text.Encoding
           Dim sr As System.IO.StreamReader
           Dim bytBytes() As Byte
           Dim UrlEncoded As New System.Text.StringBuilder
           Dim reserved() As Char = {ChrW(63), ChrW(61), ChrW(38)}
           urlWebRequest.Expect = Nothing
           If (strMethod = "POST") Then
               If objBody <> Nothing Then
                   Dim intICounter As Integer = 0
                   Dim intJCounter As Integer = 0
                   While intICounter < objBody.Length
                     intJCounter = _
                       objBody.IndexOfAny(reserved, intICounter)
                     If intJCounter = -1 Then
UrlEncoded.Append(System.Web.HttpUtility.UrlEncode(objBody.Substring(intICounter, _
                                                    objBody.Length - intICounter)))
                       Exit While
                     End If
UrlEncoded.Append(System.Web.HttpUtility.UrlEncode(objBody.Substring(intICounter, _
                                                        intJCounter - intICounter)))
                     UrlEncoded.Append(objBody.Substring(intJCounter, 1))
                     intICounter = intJCounter + 1
                   End While

                   bytBytes = _
                     System.Text.Encoding.UTF8.GetBytes(UrlEncoded.ToString())
                   urlWebRequest.ContentLength = bytBytes.Length
                   strmRequestStream = urlWebRequest.GetRequestStream
                   strmRequestStream.Write(bytBytes, 0, bytBytes.Length)
                   strmRequestStream.Close()
                Else
                    urlWebRequest.ContentLength = 0
               End If
           End If
           rspResult = urlWebRequest.GetResponse()
           strmReceiveStream = rspResult.GetResponseStream()
           encode = System.Text.Encoding.GetEncoding("utf-8")
           sr = New System.IO.StreamReader(strmReceiveStream, encode)

           Dim read(256) As Char
           Dim count As Integer = sr.Read(read, 0, 256)
           Do While count > 0
               Dim str As String = New String(read, 0, count)
               strResponseText = strResponseText & str
               count = sr.Read(read, 0, 256)
           Loop
       Catch exp As Exception
           SetErrStatusText("Error while sending parameters")
           WritetoLog(exp.ToString)
       End Try
   End Sub
   'Setting header values...
   Public Overridable Sub setRequestHeader(ByVal bstrHeader _
                         As String, ByVal bstrValue As String)
       Select Case bstrHeader
            Case "Referer"
                urlWebRequest.Referer = bstrValue
            Case "User-Agent"
                urlWebRequest.UserAgent = bstrValue
            Case "Content-Type"
                urlWebRequest.ContentType = bstrValue
            Case Else
                urlWebRequest.Headers(bstrHeader) = bstrValue
       End Select
   End Sub

   Private Function UpdateProxy()
       Try
           If Not (IsNothing(uriAddress)) Then
               If ((Not IsNothing(_ProxyName)) And _
                 (_ProxyName.Length > 0) And (_ProxyPort > 0)) Then
                   proxyObject = New WebProxy(_ProxyName, _ProxyPort)
                   Dim strByPass() As String = Split(strByPassList, "|")
                   If strByPass.Length > 0 Then
                       proxyObject.BypassList = strByPass
                   End If
                   proxyObject.BypassProxyOnLocal = True
                   If blnNetworkCredentials Then
                       If strDomain <> "" Then
                           proxyObject.Credentials = New _
                             NetworkCredential(strUserName, _
                             strPwd, strDomain)
                       Else
                            proxyObject.Credentials = New _
                              NetworkCredential(strUserName, _
                              strPwd)
                       End If
                   End If
               End If
           End If
       Catch exp As Exception
           SetErrStatusText("Error while updating proxy configurations")
           WritetoLog(exp.ToString)
       End Try
   End Function
   'Property for setting the Responsetext
   Public Overridable ReadOnly Property ResponseText() As String
       Get
           ResponseText = strResponseText
       End Get
   End Property

   Private urlWebRequest As System.Net.HttpWebRequest
   Private urlWebResponse As System.Net.HttpWebResponse
   Private strResponseText As String
   Private strUrl As String
   Private strMethod As String
   Private proxyObject As WebProxy
   Private intCount As Integer
   Private uriAddress As Uri
   Private _ProxyName As String
   Private _ProxyPort As Integer
End Class 
```

# python - 如何量化两个图像之间的差异？

> ID：189943
> 
> 赞同：209
> 
> 时间：2008-10-10T02:39:33.650
> 
> 标签：python, image-processing, background-subtraction, image-comparison, timelapse

这是我想做的事情：

我定期用网络摄像头拍照。有点像时间流逝的东西。但是，如果没有真正改变，即图片*看起来*几乎相同，我不想存储最新的快照。

我想有一些方法可以量化差异，我必须凭经验确定一个阈值。

我在寻找简单而不是完美。我正在使用python。

* * *

## 回答 #1

> 赞同：291
> 
> 时间：2010-10-14T15:43:55.083

## 大概的概念

选项 1：将两个图像加载为数组 ( `scipy.misc.imread`) 并计算逐个元素（逐个像素）的差异。计算差异的范数。

选项 2：加载两个图像。为它们中的每一个计算一些特征向量（如直方图）。计算特征向量而不是图像之间的距离。

但是，首先要做出一些决定。

## 问题

你应该首先回答这些问题：

*   图像的形状和尺寸是否相同？

    如果没有，您可能需要调整它们的大小或裁剪它们。PIL 库将有助于在 Python 中完成它。

    如果它们采用相同的设置和相同的设备，它们可能是相同的。

*   图像是否对齐？

    如果没有，您可能需要先运行互相关，以首先找到最佳对齐方式。SciPy 具有执行此操作的功能。

    如果相机和场景静止，图像很可能对齐良好。

*   图像的曝光总是一样的吗？（亮度/对比度是否相同？）

    如果没有，您可能需要[标准化](http://en.wikipedia.org/wiki/Normalization_(image_processing))图像。

    但要小心，在某些情况下，这可能弊大于利。例如，深色背景上的单个明亮像素会使归一化图像非常不同。

*   颜色信息重要吗？

    如果您想注意颜色变化，您将拥有每个点的颜色值向量，而不是灰度图像中的标量值。编写此类代码时需要多加注意。

*   图像中是否有明显的边缘？他们有可能搬家吗？

    如果是，您可以先应用边缘检测算法（例如，使用 Sobel 或 Prewitt 变换计算梯度，应用一些阈值），然后将第一张图像的边缘与第二张图像的边缘进行比较。

*   图像中有噪点吗？

    所有传感器都会用一定量的噪声污染图像。低成本传感器的噪音更大。在比较图像之前，您可能希望应用一些降噪。模糊是这里最简单（但不是最好）的方法。

*   你想注意到什么样的变化？

    这可能会影响用于图像之间差异的规范的选择。

    考虑使用曼哈顿范数（绝对值的总和）或零范数（不等于零的元素数量）来衡量图像发生了多少变化。前者会告诉你图像偏离了多少，后者只会告诉你有多少像素不同。

## 例子

我假设您的图像对齐良好，大小和形状相同，可能曝光不同。为简单起见，即使它们是彩色 (RGB) 图像，我也会将它们转换为灰度。

您将需要这些导入：

```
import sys

from scipy.misc import imread
from scipy.linalg import norm
from scipy import sum, average 
```

主要功能，读取两张图像，转换为灰度，比较并打印结果：

```
def main():
    file1, file2 = sys.argv[1:1+2]
    # read images as 2D arrays (convert to grayscale for simplicity)
    img1 = to_grayscale(imread(file1).astype(float))
    img2 = to_grayscale(imread(file2).astype(float))
    # compare
    n_m, n_0 = compare_images(img1, img2)
    print "Manhattan norm:", n_m, "/ per pixel:", n_m/img1.size
    print "Zero norm:", n_0, "/ per pixel:", n_0*1.0/img1.size 
```

如何比较。`img1`这里`img2`是 2D SciPy 数组：

```
def compare_images(img1, img2):
    # normalize to compensate for exposure difference, this may be unnecessary
    # consider disabling it
    img1 = normalize(img1)
    img2 = normalize(img2)
    # calculate the difference and its norms
    diff = img1 - img2  # elementwise for scipy arrays
    m_norm = sum(abs(diff))  # Manhattan norm
    z_norm = norm(diff.ravel(), 0)  # Zero norm
    return (m_norm, z_norm) 
```

如果文件是彩色图像，则`imread`返回一个 3D 数组，平均 RGB 通道（最后一个数组轴）以获得强度。无需为灰度图像执行此操作（例如`.pgm`）：

```
def to_grayscale(arr):
    "If arr is a color image (3D array), convert it to grayscale (2D array)."
    if len(arr.shape) == 3:
        return average(arr, -1)  # average over the last axis (color channels)
    else:
        return arr 
```

归一化很简单，您可以选择归一化为 [0,1] 而不是 [0,255]。`arr`这里是一个 SciPy 数组，所以所有操作都是元素方面的：

```
def normalize(arr):
    rng = arr.max()-arr.min()
    amin = arr.min()
    return (arr-amin)*255/rng 
```

运行`main`函数：

```
if __name__ == "__main__":
    main() 
```

现在您可以将这一切都放在一个脚本中并针对两个图像运行。如果我们将图像与自身进行比较，则没有区别：

```
$ python compare.py one.jpg one.jpg
Manhattan norm: 0.0 / per pixel: 0.0
Zero norm: 0 / per pixel: 0.0 
```

如果我们将图像模糊并与原始图像进行比较，则存在一些差异：

```
$ python compare.py one.jpg one-blurred.jpg 
Manhattan norm: 92605183.67 / per pixel: 13.4210411116
Zero norm: 6900000 / per pixel: 1.0 
```

PS 整个[compare.py](http://gist.github.com/626356)脚本。

## 更新：相关技术

由于问题是关于视频序列，其中帧可能几乎相同，并且您寻找不寻常的东西，我想提一些可能相关的替代方法：

*   背景减法和分割（检测前景物体）
*   稀疏光流（检测运动）
*   比较直方图或其他一些统计数据而不是图像

我强烈建议看一下“Learning OpenCV”一书，第 9 章（图像部分和分割）和第 10 章（跟踪和运动）。前者教导使用背景减法方法，后者提供一些关于光流方法的信息。所有方法都在 OpenCV 库中实现。如果你使用 Python，我建议使用 OpenCV ≥ 2.3，以及它的`cv2`Python 模块。

背景减法最简单的版本：

*   学习背景每个像素的平均值 μ 和标准偏差 σ
*   将当前像素值与 (μ-2σ,μ+2σ) 或 (μ-σ,μ+σ) 的范围进行比较

更高级的版本会考虑每个像素的时间序列并处理非静态场景（如移动的树木或草）。

光流的想法是取两个或更多帧，并将速度矢量分配给每个像素（密集光流）或其中的一些（稀疏光流）。要估计稀疏光流，您可以使用[Lucas-Kanade 方法](http://en.wikipedia.org/wiki/Lucas%E2%80%93Kanade_method)（它也在 OpenCV 中实现）。显然，如果有很多流（速度场的最大值高于平均值），那么帧中的某些东西正在移动，随后的图像会更加不同。

比较直方图可能有助于检测连续帧之间的突然变化。[Courbon et al, 2010](http://www.sciencedirect.com/science/article/pii/S0967066110000808)中使用了这种方法：

> *连续帧的相似性。*测量两个连续帧之间的距离。如果它太高，则意味着第二帧被破坏，因此图像被消除。两帧直方图上的[Kullback-Leibler 距离](https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence)或互熵：
> 
> ![$$ d(p,q) = \sum_i p(i) \log (p(i)/q(i)) $$](https://i.imgur.com/hdeh8ni.gif)
> 
> 其中*p*和*q*是使用帧的直方图。阈值固定为 0.2。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-10-10T02:46:02.733

**一个简单的解决方案：**

将图像编码为**jpeg并查找****文件大小**的实质性变化。

我已经用视频缩略图实现了类似的东西，并且取得了很大的成功和可扩展性。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2008-10-13T06:50:17.437

您可以使用[PIL](http://www.pythonware.com/products/pil/)中的函数比较两个图像。

```
import Image
import ImageChops

im1 = Image.open("splash.png")
im2 = Image.open("splash2.png")

diff = ImageChops.difference(im2, im1) 
```

diff 对象是一幅图像，其中每个像素都是从第一幅图像中减去第二幅图像中该像素的颜色值的结果。使用差异图像，您可以做几件事。最简单的是`diff.getbbox()`函数。它会告诉你包含两个图像之间所有变化的最小矩形。

您也可以使用 PIL 中的函数来实现此处提到的其他内容的近似值。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-10-10T03:47:44.010

两种流行且相对简单的方法是：（a）已经提出的欧几里得距离，或（b）归一化互相关。与简单的互相关相比，归一化互相关对光照变化的鲁棒性明显更强。维基百科给出了[归一化互相关](http://en.wikipedia.org/wiki/Cross-correlation#Normalized_cross-correlation)的公式。也存在更复杂的方法，但它们需要更多的工作。

使用类似 numpy 的语法，

```
dist_euclidean = sqrt(sum((i1 - i2)^2)) / i1.size

dist_manhattan = sum(abs(i1 - i2)) / i1.size

dist_ncc = sum( (i1 - mean(i1)) * (i2 - mean(i2)) ) / (
  (i1.size - 1) * stdev(i1) * stdev(i2) )

```

假设`i1`和`i2`是二维灰度图像数组。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-10T03:37:57.073

一个微不足道的尝试：

将两个图像重新采样为小缩略图（例如 64 x 64），并将缩略图与某个阈值逐个像素进行比较。如果原始图像几乎相同，则重新采样的缩略图将非常相似甚至完全相同。这种方法可以处理尤其是在低光场景中可能出现的噪点。如果你去灰度可能会更好。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-03-30T13:00:09.200

另一种测量两个图像之间相似度的简单方法：

```
import sys
from skimage.measure import compare_ssim
from skimage.transform import resize
from scipy.ndimage import imread

# get two images - resize both to 1024 x 1024
img_a = resize(imread(sys.argv[1]), (2**10, 2**10))
img_b = resize(imread(sys.argv[2]), (2**10, 2**10))

# score: {-1:1} measure of the structural similarity between the images
score, diff = compare_ssim(img_a, img_b, full=True)
print(score) 
```

如果其他人对比较图像相似度的更强大方法感兴趣，我会整理一个[教程](http://douglasduhaime.com/posts/identifying-similar-images-with-tensorflow.html)和 Web[应用程序](https://github.com/YaleDHLab/pix-plot)，用于使用 Tensorflow 测量和可视化相似图像。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-10-14T16:04:18.180

我正在专门解决如何计算它们是否“足够不同”的问题。我假设您可以弄清楚如何逐个减去像素。

首先，我会拍摄一堆*没有任何*变化的图像，并找出任何像素变化的最大量，这仅仅是因为捕捉的变化、成像系统中的噪声、JPEG 压缩伪影和照明的瞬间变化. 也许您会发现即使没有任何移动，也会出现 1 或 2 位差异。

然后对于“真实”测试，您需要这样的标准：

*   如果最多 P 个像素相差不超过 E，则相同。

因此，也许，如果 E = 0.02，P = 1000，这将意味着（大约）如果任何单个像素的变化超过约 5 个单位（假设为 8 位图像）或超过 1000，它将是“不同的”像素根本没有任何错误。

这主要是作为一种很好的“分类”技术来快速识别足够接近而不需要进一步检查的图像。然后，“失败”的图像可能会更多地使用更精细/更昂贵的技术，例如，如果相机晃动一点，或者对照明变化更稳健，就不会出现误报。

我运行了一个开源项目[OpenImageIO](http://www.openimageio.org)，其中包含一个名为“idiff”的实用程序，该实用程序将差异与这样的阈值进行比较（实际上更精细）。即使您不想使用此软件，您也可能需要查看源代码以了解我们是如何做到的。它在商业上使用了很多，并且开发了这种阈值技术，以便我们可以拥有一个用于渲染和图像处理软件的测试套件，其中的“参考图像”可能会因平台而异，或者我们对tha 算法，所以我们想要一个“容差范围内的匹配”操作。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-05-27T15:27:49.393

我在工作中遇到了类似的问题，我正在重写我们的图像转换端点，我想检查新版本是否产生与旧版本相同或几乎相同的输出。所以我写了这个：

[https://github.com/nicolashahn/diffimg](https://github.com/nicolashahn/diffimg)

它在相同大小的图像上运行，并且在每个像素级别上测量每个通道的值差异：R，G，B（，A），取这些通道的平均差异，然后平均差异所有像素，并返回一个比率。

例如，对于白色像素的 10x10 图像，相同的图像但一个像素已变为红色，则该像素处的差异为 1/3 或 0.33...（RGB 0,0,0 vs 255,0,0 ) 并且所有其他像素为 0。总共 100 个像素，0.33.../100 = 图像差异约为 0.33%。

我相信这对于 OP 的项目非常有效（我意识到这是一个非常古老的帖子，但是为未来的 StackOverflowers 发布，他们也想在 python 中比较图像）。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-10T03:55:20.063

给出的大多数答案都不会涉及照明水平。

在进行比较之前，我会首先将图像标准化为标准光照水平。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-10T03:13:42.363

你见过[寻找相似图像的算法](https://stackoverflow.com/questions/75891/algorithm-for-finding-similar-images)问题吗？查看它以查看建议。

我建议对您的帧进行小波变换（我已经使用 Haar 变换为此编写了 C 扩展）；然后，比较两张图片之间最大（按比例）小波因子的索引，您应该得到一个数值相似性近似值。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-11-21T00:23:54.613

我遇到了同样的问题，并编写了一个简单的 python 模块，该模块使用枕头的 ImageChops 比较两个相同大小的图像以创建黑白差异图像并总结直方图值。

您可以直接获得此分数，也可以与全黑与全白差异相比的百分比值。

它还包含一个简单的 is_equal 函数，可以在（包括）图像通过时提供模糊阈值。

该方法不是很精细，但可能对其他在同一问题上苦苦挣扎的人有用。

[https://pypi.python.org/pypi/imgcompare/](https://pypi.python.org/pypi/imgcompare/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-06-15T16:08:16.707

如果现在回复太晚了，我深表歉意，但由于我一直在做类似的事情，我想我可以以某种方式做出贡献。

也许使用 OpenCV，您可以使用模板匹配。假设您使用的是网络摄像头，如您所说：

1.  简化图像（可能是阈值？）
2.  应用模板匹配并使用 minMaxLoc 检查 max_val

提示： max_val （或 min_val 取决于使用的方法）会给你数字，大数字。要获得百分比差异，请使用与相同图像匹配的模板——结果将是您的 100%。

伪代码举例说明：

```
previous_screenshot = ...
current_screenshot = ...

# simplify both images somehow

# get the 100% corresponding value
res = matchTemplate(previous_screenshot, previous_screenshot, TM_CCOEFF)
_, hundred_p_val, _, _ = minMaxLoc(res)

# hundred_p_val is now the 100%

res = matchTemplate(previous_screenshot, current_screenshot, TM_CCOEFF)
_, max_val, _, _ = minMaxLoc(res)

difference_percentage = max_val / hundred_p_val

# the tolerance is now up to you 
```

希望能帮助到你。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-05-22T07:04:31.633

```
import os
from PIL import Image
from PIL import ImageFile
import imagehash

#just use to the size diferent picture
def compare_image(img_file1, img_file2):
    if img_file1 == img_file2:
        return True
    fp1 = open(img_file1, 'rb')
    fp2 = open(img_file2, 'rb')

    img1 = Image.open(fp1)
    img2 = Image.open(fp2)

    ImageFile.LOAD_TRUNCATED_IMAGES = True
    b = img1 == img2

    fp1.close()
    fp2.close()

    return b

#through picturu hash to compare
def get_hash_dict(dir):
    hash_dict = {}
    image_quantity = 0
    for _, _, files in os.walk(dir):
        for i, fileName in enumerate(files):
            with open(dir + fileName, 'rb') as fp:
                hash_dict[dir + fileName] = imagehash.average_hash(Image.open(fp))
                image_quantity += 1

    return hash_dict, image_quantity

def compare_image_with_hash(image_file_name_1, image_file_name_2, max_dif=0):
    """
    max_dif: The maximum hash difference is allowed, the smaller and more accurate, the minimum is 0.
    recommend to use
    """
    ImageFile.LOAD_TRUNCATED_IMAGES = True
    hash_1 = None
    hash_2 = None
    with open(image_file_name_1, 'rb') as fp:
        hash_1 = imagehash.average_hash(Image.open(fp))
    with open(image_file_name_2, 'rb') as fp:
        hash_2 = imagehash.average_hash(Image.open(fp))
    dif = hash_1 - hash_2
    if dif < 0:
        dif = -dif
    if dif <= max_dif:
        return True
    else:
        return False

def compare_image_dir_with_hash(dir_1, dir_2, max_dif=0):
    """
    max_dif: The maximum hash difference is allowed, the smaller and more accurate, the minimum is 0.

    """
    ImageFile.LOAD_TRUNCATED_IMAGES = True
    hash_dict_1, image_quantity_1 = get_hash_dict(dir_1)
    hash_dict_2, image_quantity_2 = get_hash_dict(dir_2)

    if image_quantity_1 > image_quantity_2:
        tmp = image_quantity_1
        image_quantity_1 = image_quantity_2
        image_quantity_2 = tmp

        tmp = hash_dict_1
        hash_dict_1 = hash_dict_2
        hash_dict_2 = tmp

    result_dict = {}

    for k in hash_dict_1.keys():
        result_dict[k] = None

    for dif_i in range(0, max_dif + 1):
        have_none = False

        for k_1 in result_dict.keys():
            if result_dict.get(k_1) is None:
                have_none = True

        if not have_none:
            return result_dict

        for k_1, v_1 in hash_dict_1.items():
            for k_2, v_2 in hash_dict_2.items():
                sub = (v_1 - v_2)
                if sub < 0:
                    sub = -sub
                if sub == dif_i and result_dict.get(k_1) is None:
                    result_dict[k_1] = k_2
                    break
    return result_dict

def main():
    print(compare_image('image1\\815.jpg', 'image2\\5.jpg'))
    print(compare_image_with_hash('image1\\815.jpg', 'image2\\5.jpg', 7))
    r = compare_image_dir_with_hash('image1\\', 'image2\\', 10)
    for k in r.keys():
        print(k, r.get(k))

if __name__ == '__main__':
    main() 
```

*   输出：

    假
    真
    image2\5.jpg image1\815.jpg
    image2\6.jpg image1\819.jpg
    image2\7.jpg image1\900.jpg
    image2\8.jpg image1\998.jpg
    image2\9.jpg image1\1012 .jpg

*   示例图片：

    *   815.jpg
        [![815.jpg](https://i.stack.imgur.com/xVGI8.jpg)](https://i.stack.imgur.com/xVGI8.jpg)

    *   5.jpg
        [![5.jpg](https://i.stack.imgur.com/py9j1.jpg)](https://i.stack.imgur.com/py9j1.jpg)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-10T02:48:35.567

[地球移动距离](http://www.google.ca/search?hl=en&safe=off&client=firefox-a&rls=org.mozilla:en-US:official&hs=HD8&pwst=1&sa=X&oi=spell&resnum=0&ct=result&cd=1&q=earth+mover%27s+distance+image&spell=1)可能正是您所需要的。不过，实时实施可能*有点繁重。*

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-10T02:53:30.610

计算两幅图像的[曼哈顿距离怎么样。](http://en.wikipedia.org/wiki/Manhattan_distance)这给了你 n*n 个值。然后你可以做一些像行平均这样的事情来减少到 n 个值，然后用一个函数来获得一个单一的值。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-02-19T21:28:00.693

我对在三脚架上使用同一台相机拍摄的 jpg 图像非常幸运，方法是（1）大大简化（比如从 3000 像素宽到 100 像素宽甚至更少）（2）将每个 jpg 数组扁平化为一个向量 (3) 使用简单的相关算法成对关联序列图像以获得相关系数 (4) 平方相关系数以获得 r 平方（即一个图像中的可变性分数由下一个图像的变化解释） (5) 通常在我的应用程序中如果 r-square < 0.9，我说这两个图像是不同的，并且在两者之间发生了一些事情。

这在我的实现中既健壮又快速（Mathematica 7）

值得玩转您感兴趣的图像部分，并通过将所有图像裁剪到那个小区域来专注于该部分，否则将错过远离相机但重要的变化。

我不知道如何使用 Python，但我确信它也有相关性，不是吗？

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-02-24T06:00:48.360

您可以计算两个图像的直方图，然后计算[Bhattacharyya 系数](http://en.wikipedia.org/wiki/Bhattacharyya_distance#Bhattacharyya_coefficient)，这是一个非常快速的算法，我用它来检测板球视频中的镜头变化（在 C 中使用 openCV）

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-01-16T21:11:08.810

查看[isk-daemon](http://server.imgseek.net/)如何实现 Haar Wavelets 。您可以使用它的 imgdb C++ 代码即时计算图像之间的差异：

> isk-daemon 是一个开源数据库服务器，能够将基于内容的（视觉）图像搜索添加到任何与图像相关的网站或软件中。
> 
> 该技术允许任何与图像相关的网站或软件的用户在小部件上绘制他们想要查找的图像，并让网站回复他们最相似的图像，或者在每个图像详细信息页面上简单地请求更多相似的照片。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-11-29T00:53:36.650

一种更有原则的方法是使用全局描述符来比较图像，例如 GIST 或 CENTRIST。[如此处所述的](https://www.pyimagesearch.com/2017/11/27/image-hashing-opencv-python/)散列函数也提供了类似的解决方案。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-07-18T16:26:12.413

通过计算均方误差，有一个使用 numpy 的简单快速的解决方案：

```
before = np.array(get_picture())
while True:
    now = np.array(get_picture())
    MSE = np.mean((now - before)**2)

    if  MSE > threshold:
        break

    before = now 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-02-27T19:19:16.033

这是我编写的一个函数，它以 2 个图像（文件路径）作为参数，并返回两个图像的像素组件之间的平均差异。这对我来说非常有效，可以确定视觉上“相等”的图像（当它们不`==`相等时）。

*（我发现 8 是确定图像是否基本相同的一个很好的限制。）*

*（如果不添加预处理，图像必须具有相同的尺寸。）*

```
from PIL import Image

def imagesDifference( imageA, imageB ):
    A = list(Image.open(imageA, r'r').convert(r'RGB').getdata())
    B = list(Image.open(imageB, r'r').convert(r'RGB').getdata())
    if (len(A) != len(B)): return -1
    diff = []
    for i in range(0, len(A)):
        diff += [abs(A[i][0] - B[i][0]), abs(A[i][1] - B[i][1]), abs(A[i][2] - B[i][2])]
    return (sum(diff) / len(diff)) 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-10T02:48:15.910

我认为您可以简单地计算两个图像的亮度之间的欧几里德距离（即 sqrt（差异平方和，逐个像素）），如果这低于某个经验阈值，则认为它们相等。你最好包装一个 C 函数。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-05-07T15:57:16.883

有许多指标可用于评估两个图像是否看起来像/看起来像多少。

我不会在这里深入任何代码，因为我认为这应该是一个科学问题，而不是技术问题。

通常，这个问题与人类对图像的感知有关，因此每种算法都有其对人类视觉系统特征的支持。

经典方法是：

可见差异预测器：用于评估图像保真度的算法（[https://www.spiedigitallibrary.org/conference-proceedings-of-spie/1666/0000/Visible-differences-predictor--an-algorithm-for-the-评估/10.1117/12.135952.short?SSO=1](https://www.spiedigitallibrary.org/conference-proceedings-of-spie/1666/0000/Visible-differences-predictor--an-algorithm-for-the-assessment-of/10.1117/12.135952.short?SSO=1) )

图像质量评估：从错误可见性到结构相似性 ( [http://www.cns.nyu.edu/pub/lcv/wang03-reprint.pdf](http://www.cns.nyu.edu/pub/lcv/wang03-reprint.pdf) )

FSIM：图像质量评估的特征相似度指数（[https://www4.comp.polyu.edu.hk/~cslzhang/IQA/TIP_IQA_FSIM.pdf](https://www4.comp.polyu.edu.hk/~cslzhang/IQA/TIP_IQA_FSIM.pdf)）

其中，SSIM（Image Quality Assessment: From Error Visibility to Structural Similarity）最容易计算，开销也很小，另一篇论文《基于梯度相似度的图像质量评估》（[https://www.semanticscholar .org/paper/Image-Quality-Assessment-Based-on-Gradient-Liu-Lin/2b819bef80c02d5d4cb56f27b202535e119df988](https://www.semanticscholar.org/paper/Image-Quality-Assessment-Based-on-Gradient-Liu-Lin/2b819bef80c02d5d4cb56f27b202535e119df988)）。

还有更多其他方法。如果您对艺术感兴趣/真正关心艺术，请查看 Google Scholar 并搜索“视觉差异”、“图像质量评估”等内容。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-09-09T12:43:45.847

使用 SSIM 测量 2 个图像之间的结构相似性指数度量。

# java - 如何检测 Web 应用程序中的间歇性超时问题？

> ID：189947
> 
> 赞同：0
> 
> 时间：2008-10-10T02:40:47.767
> 
> 标签：java, web-services

拥有一个 n-tire Web 应用程序，搜索经常在 30 秒后超时。如何检测问题的根本原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T02:51:51.753

您可以添加跟踪代码来记录其活动，然后查看每个操作以了解哪些部分超时以及原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T04:37:13.490

使用工具[Wireshark](http://www.wireshark.org/download.html)。

在每一层上安装此工具并观察 http 流量和数据包。在调试超时问题时，这对我有用，实际上结果是空 SOAP 信封的问题。

这样做至少会告诉你问题出在哪一层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T07:04:58.200

在关注点分离处记录，在这种情况下，在每一层的边界处。当您说搜索时，我假设这是一个用户正在搜索某些文本的网络应用程序。

是否涉及数据库搜索？您的垃圾收集器是否有可能启动并且搜索超时？尝试使用 java 命令行开关记录您的垃圾收集暂停。稍后，您可以分析您的 JVM 何时执行 GC。或者，您可以使用 JConsole 或 JvisualVM 之类的工具。

BR，
~A

# c# - VB.NET 泛型到 C# 语法

> ID：189954
> 
> 赞同：6
> 
> 时间：2008-10-10T02:43:38.540
> 
> 标签：c#, asp.net-mvc, vb.net, generics

您能否给我看一下这个 VB.NET 代码的 C# 等效项：

```
Public Partial Class Index
    Inherits System.Web.Mvc.Viewpage(Of List(Of Task))

End Class 
```

我不确定在哪里/如何在 C# 中添加它：

```
public partial class DirList : System.Web.Mvc.ViewPage
{

} 
```

该代码假设告诉类期望来自控制器的任务列表......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T02:46:39.923

```
public partial class DirList : System.Web.Mvc.ViewPage<List<Task>>
{

} 
```

# c - C/Unix 的参数解析助手

> ID：189972
> 
> 赞同：40
> 
> 时间：2008-10-10T02:51:08.430
> 
> 标签：c, command-line, parsing

我知道以下内容：

*   可敬的`getopt(3)`
*   扩展的`getopt_long`
*   glibc 的[`argp`](http://www.gnu.org/software/libtool/manual/libc/Argp.html)Unix 风格参数向量解析器
*   来自 GNOME 项目（或其在[Glib](http://library.gnome.org/devel/glib/stable/glib-Commandline-option-parser.html)中的精神继承者）的[popt](http://developer.gnome.org/arch/misc/popt.html)

我敢肯定还有更多我没用过甚至没听说过的东西；快速的 Google 搜索显示[Gopt](http://www.purposeful.co.uk/software/gopt/)、[argtable](http://argtable.sourceforge.net/)和[Optlist](http://michael.dipperstein.com/optlist/)。

就个人而言，我最喜欢，并且我使用/`argp`编写的每个程序（超出一定的复杂性基线）都已转换为使用. 它比 更广泛可用，比 更强大，有据可查，与所有 GNU 风格的约定一致，并且非常灵活。不利的一面是，它远非最容易使用（由于非常灵活），并且支持它的代码非常冗长（就像 C 中的许多东西一样）。`getopt``getopt_long``argp``popt``getopt_long`

你用什么，为什么？

是的，我的意思是 C 而不是 C++。有很多 C++ 解析器，但我不使用 C++。

John Millikin 指出`popt`不再维护。我列出它是因为许多程序仍然在使用它——包括 AbiWord、rpm、rsync 和 samba——尽管 Gnome 努力[迁移出去](http://live.gnome.org/ProjectRidley)。但我现在也添加了指向 Glib 参数解析器的链接。

* * *

对于 C++ 参数解析，请参阅问题*[What parameter parser library are there for C++？](https://stackoverflow.com/questions/253556/what-parameter-parser-libraries-are-there-for-c)*

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-10T15:17:52.047

GNU 有[gengetopt](http://www.gnu.org/software/gengetopt/)，它为选项数据结构生成代码，以及`getopt_long`解析命令行和填充结构的代码。它很容易学习并且运行良好。

作为奖励，您可以在代码周围传递选项结构，并在需要时避免全局存储。

它提供了 GNU 风格的语义（显然），并且如果您不确定您的受众的构建环境，它足够小，可以简单地包含在项目中以进行分发。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T19:05:10.200

俗话说，“标准胜于好”。所以我总是使用 getopt_long() 和任何非 GNOME/glibby 的东西，以及 glib 的任何东西。

出于同样的原因，我总是在 Python 应用程序中使用 optparse，即使它相对于 getopt_long() 有很多缺失的功能......但这是 Python 标准。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-16T07:56:36.837

由于我在寻找同样的东西，所以我阅读了这个老话题的答案。最后我选择*[了 C++ 中有哪些参数解析器库中](https://stackoverflow.com/questions/253556/what-parameter-parser-libraries-are-there-for-c)*提到的[dropt ？](http://www.taenarum.com/software/dropt/). 实际上它是用 C 实现的，所以我认为这里也值得一提。我没有使用包装 C 实现的 C++ 助手。

关于 dropt 的有趣事实：

*   轻的
*   仅依赖于标准库
*   没有陡峭的学习曲线
*   足以进行基本的 arg 解析，以及一些强大的功能
*   易于扩展
*   非限制性许可证 (zlib-ish)

虽然它*是*有限的。例如，我必须稍微调整一下我的参数语法规范；在这种情况下这是可以接受的，但当然有时规格是一成不变的。

作为结论，我建议至少在快速原型设计、工具开发和内部项目中使用 dropt。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T02:55:09.500

`popt`已经被放弃了*很长时间*`glib`——参数解析从三年前的 2.6 版本开始合并。

我使用`glib`' 解析器，或 Python 的`getopt`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-18T18:31:24.430

我也不太喜欢 getopt （尽管它很标准）。我提出的一种解决方案是函数 argopt()。它与 C 兼容，可用于测试是否设置了标志以及读取带有值的选项。它只支持短选项（例如 -h），尽管为长选项（例如 --help）编写类似的函数应该不会太困难。参见示例：

```
int main(int argc, char **argv){

    if(argopt(argc, argv, 'p')) printf("-p is set\n");
    if(argopt(argc, argv, 'q')) printf("-q is set\n");

    const char *f = argopt(argc, argv, 'f');
    if(f) printf("-f is %s\n",f);

    return 0;
} 
```

命令行示例：

```
$./main -f input.txt -rq
-q is set
-f is input.txt 
```

免责声明：我制作这个函数是为了好玩，目的是让它简短、C 兼容、易于使用并且没有依赖项。这里是：

```
const char* argopt(int argc, const char *const *argv, char key){

    for(int i=1; i<argc; i++){
        const char *c = argv[i];
        if(*c!='-') continue;
        while(*++c) if(*c==key) return argv[(i+1)%argc];
    }

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T02:55:21.667

我真的很喜欢[TCLAP](http://tclap.sourceforge.net/)库，因为它非常灵活且易于使用。它也是完全基于模板的，所以它是一个只有头文件的库。

我的错误：你说 C 而我发布了一个 C++ 库......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-20T11:30:13.007

我一直在开发和使用[libparamset](https://github.com/guardtime/libparamset)，它是一个用纯 C 语言编写的命令行参数解析库。它提供：

*   跨平台功能（Linux、OS X、Windows）。
*   可配置的解析器，其中每个参数都可以采取不同的方式（强大而灵活的功能）。
*   自动生成的拼写错误、未知参数或无效参数的消息。
*   设计命令行用户界面的额外功能。
*   好的文档。

# c# - 业务对象更改时自动刷新 UI

> ID：189976
> 
> 赞同：2
> 
> 时间：2008-10-10T02:53:08.053
> 
> 标签：c#, winforms, user-interface, refresh

这更像是一个设计问题。

我正在构建一个以各种方式显示业务对象的工具（即树节点、列表视图项、组合框、文本字段等）。每当用户更改其中任何一个时，都会引发一个事件，表明该业务对象已更改或它所属的集合已更改。由于此业务对象或它可能属于的集合可能显示在多个位置，因此每个 UI 元素都需要更新以反映此更改。是否有一个优雅的解决方案可以在发生更改时正确更新每种类型的 UI 元素？

我对如何做到这一点有一些想法，但我想看看是否有人遇到过这个问题并对他们的解决方案感到满意。这是一个 C# WinForm，但解决方案可以是任何语言。

我目前对这个问题的想法和可能的解决方案：

当您的业务对象成为 TreeNodeCollection/ListViewITemCollection/ComboBoxItemCollection 的一部分并且在集合上调用 Clear() 时，当您想要清理事件绑定（即 businessObject.Changed -= ObjectChanged）时，它会变得更加复杂。

那么“服务”呢，每个对象及其 ui 元素都可以在其中注册，可以在一个位置侦听业务对象的事件，并且每个 UI 元素都会在引发事件时更新？当所有 UI 元素都自行注销时，将删除对该对象事件的订阅。

此解决方案的问题在于，每个控件都必须负责在每次创建时注册 UI 组件和对象——这可能会变得混乱。

你的意见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T03:02:29.780

您可能想尝试观察者模式。[http://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T02:58:39.320

使用消息系统。像这样创建一个委托：

```
public delegate void ObjectRefresh(BusinessObject obj); 
```

然后，在您的 BusinessObject 类中：

```
public event ObjectRefresh; 
```

当属性发生变化时：

```
if (ObjectRefresh)
    ObjectRefresh(this); 
```

在你所有的用户界面上：

```
BusinessObject obj = GetBusinessObject();
obj.ObjectRefresh += this.ObjectRefresh;
...
private void ObjectRefresh(BusinessObject obj)
{
    // update UI
} 
```

:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T03:13:51.520

看看 Bindable Linq ... Paul Stovell 对这个问题的解决方案。

[http://www.codeplex.com/bindablelinq](http://www.codeplex.com/bindablelinq)

如果它不能为您的问题提供解决方案，它会给您一些现场自己编写的内容。

也可以阅读他的博客。

[http://www.paulstovell.com/blog/](http://www.paulstovell.com/blog/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T03:43:41.837

确保你真的需要这个，即它还没有发生。例如，如果您的 GUI 对象绑定到数据集，并且您的业务对象将更改合并到数据集中，则数据集将自动通知 gui 对象数据已更改；数据库 gui 对象将自动更新自身

如果不是，那么上面提到的观察者模式就是你想要的

# iphone - iPhone 应用程序中奇怪的 OpenGL ES 行为

> ID：189981
> 
> 赞同：3
> 
> 时间：2008-10-10T02:55:15.413
> 
> 标签：iphone, opengl-es

我正在为 iPhone 制作一个简单的 2D 游戏。它基于 CrashLanding。所以它基本上是一个背景纹理和一些移动的矩形纹理。

我有这个奇怪的小图形问题：一些小的 2d 项目（可以假设只是矩形）在它们上面有这个闪烁的小黑条（背景纹理几乎完全是白色的，所以小条很明显）。

我使用的纹理是小（~1Kb）png。

有没有其他人遇到过这个？这是一个常见的openGL问题吗？

顺便说一句，这发生在模拟器和实际设备上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T10:05:36.293

你的纹理中有像那个小黑条这样的东西吗？

当我做错事时，我也遇到过类似的问题。这是一个小清单：

*   您是否已经对纹理进行了 mipmap 处理，并检查它有哪些参数。
*   glTex 参数。（WRAP_S、WRAP_T、MAG_FILTER、MIN_FILTER...）
*   纹理的尺寸。（如果允许使用非二次幂纹理，则可能会导致图形故障，具体取决于您加载纹理的方式）
*   您是在矩形顶部绘制闪烁的条吗？
*   在您的纹理中是否有导致黑条的原因。
*   动画帧的对齐。
*   混合和阿尔法混合。

如果列表中的某些内容对您来说含糊不清，那么阅读它们是一个很好的练习。

我也做了一个很好的猜测：我相信你没有在任何方向包装你的纹理，并且动画帧有点错位，所以你的应用程序在你正在绘制的四边形中的纹理坐标/高度有点错误。

我希望我的建议是有意义的。我只有通常的 opengl 经验，而不是 OpenGL ES，它的图形管道已被修剪以使其更紧凑、更干净、更优雅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T15:22:43.593

由于这是一个 2D 游戏，这些小的矩形精灵是否包含在同一个纹理表中？另一个可能的罪魁祸首可能是纹理过滤。

如果您尝试操纵纹理坐标来绘制纹理的子区域，则可以检查是否以大于 1:1 的比例绘制精灵。如果您启用了线性纹理过滤（而不是最近），如果您尝试将精灵缩放到 1:1 以上，OpenGL 可能会从相邻精灵中抓取一些像素。

如果是这种情况，您可以尝试在纹理表中的精灵之间放置一个 1 像素的缓冲区。

# windows - 使用 apache 2.x 前端 Weblogic 9.2 的最简单方法

> ID：189985
> 
> 赞同：0
> 
> 时间：2008-10-10T02:56:26.440
> 
> 标签：windows, apache, proxy, weblogic

我想将 Apache 2.2.9 放在 Windows XP 上的 Weblogic 9.2 服务器前面。这样做需要什么？

我可能在 apache 端需要 mod_proxy 吗？

就 Weblogic 和 apache 而言，有没有类似于 mod_jk 的东西？

我想要这个设置，以便稍后我可以引入一些过滤。但目前，目标是允许其他计算机访问 weblogic appserver，以便 Apache 将所有到达它的请求（在某个 URL）转发到 Weblogic。

我之前做过几次，但忘记了我是怎么做的。

感谢您的任何指点，

* * *

我想[http://e-docs.bea.com/wls/docs81/plugins/apache.html](http://e-docs.bea.com/wls/docs81/plugins/apache.html)回答了大多数基本的fundas。如果我有更多意见，将更新论坛。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-23T23:39:08.560

正确的做法是使用BEA/Oracle 提供并与 Weblogic 捆绑的*Apache HTTP Server 插件。*

有关详细信息，请参阅旧版[BEA WebLogic Server 9.2 文档](http://download.oracle.com/docs/cd/E13222_01/wls/docs92/index.html)，更准确地说是：

*   [安装和配置 Apache HTTP 服务器插件](http://download.oracle.com/docs/cd/E13222_01/wls/docs92/plugins/apache.html)
*   [Web 服务器插件的参数](http://download.oracle.com/docs/cd/E13222_01/wls/docs92/plugins/plugin_params.html)

**注意**：这些链接是最新的链接，因为[http://edocs.bea.com/](http://edocs.bea.com/)现已关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-03T06:01:37.667

同意 Pascal 关于 weblogic 插件的看法——这是首选，我仍然可以为您列出两个选择

***1> 用于 weblogic 的 Apache 插件：***

这不仅将请求从 Apache 转发到 weblogic，还可以作为 weblogic 设置的 HTTP 负载平衡器。

```
update httpd.conf to load weblogic_module   --> mod_wl_20.so

<IfModule mod_weblogic.c>  
  WebLogicCluster w1s1.com:7001,w1s2.com:7001,w1s3.com:7001
  MatchExpression *.jsp  
  MatchExpression *.xyz
</IfModule> 
```

***2> Apache 代理通行证***

如果您正在寻找来自 Apache 的简单重定向，请使用此

```
update httpd.conf to load proxy_module --> mod_proxy.so

<Location /service>
 ProxyPass         http://wls1.com:7001/service
 ProxyPassReverse  http://wls1.com:7001/service
</Location> 
```

使用适合您需要的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T14:16:10.087

我们使用 WebLogic 插件来负载平衡和前端我们的应用程序，使用虚拟主机和位置。

例如：

服务器名称 www.domain.com

WebLogicCluster 10.20.30.41:7002,10.20.30.42:7002 SetHandler weblogic-handler

此配置将对[http://www.domain.com/PathToApplication](http://www.domain.com/PathToApplication)的请求平衡 到 10.20.30.41:7002 和 10.20.30.42:7002。

# php - PHP中的“内联”类实例化？（为了便于方法链接）

> ID：189988
> 
> 赞同：9
> 
> 时间：2008-10-10T02:57:57.543
> 
> 标签：php, oop, static-methods

在 Python 和 Ruby 等 OO 语言中常用的一个习惯用法是实例化一个对象并链接返回对对象本身的引用的方法，例如：

```
s = User.new.login.get_db_data.get_session_data 
```

在 PHP 中，可以像这样复制这种行为：

```
$u = new User();
$s = $u->login()->get_db_data()->get_session_data(); 
```

尝试以下结果`syntax error, unexpected T_OBJECT_OPERATOR`：

```
$s = new User()->login()->get_db_data()->get_session_data(); 
```

似乎这可以使用静态方法来完成，这可能是我最终要做的，但我想检查一下lazyweb：**实际上是否有一种干净、简单的方法来“内联”实例化 PHP 类（如上面的片段）**为此目的？

如果我决定使用静态方法，**让类的静态方法返回类本身的实例化是否太神奇了**？（有效地编写我自己的构造函数——那不是构造函数？）感觉有点脏，但如果没有太多可怕的副作用，我可能会这样做。

我想我也可以使用 get_user() 方法预先实例化一个 UserFactory，但我很好奇我上面所问的解决方案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-10T03:44:55.577

所有这些提议的解决方案都会使您的代码复杂化，以便让 PHP 实现一些语法上的精确性。想要 PHP 成为它不（好）的东西是疯狂的道路。

我只会使用：

```
$u = new User();
$s = $u->login()->get_db_data()->get_session_data(); 
```

它很清楚，相对简洁，并且不涉及可能引入错误的*黑魔法。*

当然，你总是可以转向 Ruby 或 Python。它会改变你的生活。

*   是的，我对 PHP 很苛刻。我每天都使用它。多年来一直在使用它。现实是，它是被**创造出来**的，而不是被设计出来的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-10T03:27:10.183

```
<?php

    class User
    {
        function __construct()
        {
        }

        function Login()
        {
            return $this;
        }

        function GetDbData()
        {
            return $this;
        }

        function GetSession()
        {
            return array("hello" => "world");
        }
    }

    function Create($name)
    {
        return new $name();
    }

    $s = Create("User")->Login()->GetDbData()->GetSession();

    var_dump($s);
?> 
```

这是一个可能的解决方案 :) 当然，您应该为函数选择一个更好的名称...

或者，如果您不介意一点开销：

```
<?php

    class User
    {
        function __construct($test)
        {
            echo $test;
        }
...
    }

    function CreateArgs($name)
    {
        $ref = new ReflectionClass($name);
        return $ref->newInstanceArgs(array_slice(func_get_args(), 1));
    }

    $s = CreateArgs("User", "hi")->Login()->GetDbData()->GetSession();

    var_dump($s);
?> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-09-15T21:43:16.117

没有理由将 hack（解决语法问题）和对象创建代码本身结合在一起。

由于 new-expression 不能用作对象运算符的左成员，但函数调用表达式可以，因此您只需将对象包装在对返回其自己的参数的函数的调用中：

```
function hack($obj) { return $obj; }

$mail = hack(new Zend_Mail())
  -> setBodyText('This is the text of the mail.')
  -> setFrom('somebody@example.com', 'Some Sender')
  -> addTo('somebody_else@example.com', 'Some Recipient')
  -> setSubject('TestSubject'); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-03-14T09:04:31.737

一个简单的快捷方式

```
$Obj = new ClassName();
$result = $Obj->memberFunction(); 
```

是

```
$result = (new ClassName())->memberFunction(); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-10T03:33:18.613

获得类似结果的唯一方法是使用工厂或单例静态方法。例如：

```
class User
{
    //...
    /**
     *
     * @return User
     */
    public static function instance()
    {
        $args = func_get_args();
        $class = new ReflectionClass(__CLASS__);
        return $class->newInstanceArgs($args);
    }
    //...
} 
```

它使用 PHP5 反射 API 创建一个新实例（使用发送到 ::instance() 的任何参数）并返回它，以便您进行链接：

```
$s = User::instance()->login()->get_db_data()->get_session_data(); 
```

顺便说一句，代码足够灵活，复制该静态方法时唯一需要更改的是 PHPDoc 注释的 @return。

* * *

如果您想像我们的朋友 Nelson 一样过早地优化您的代码，您可以将 User::instance() 的内容替换为：

```
return new self(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-27T20:41:38.610

```
<?php 
//PHP 5.4+ class member access on instantiation support.
$s = (new User())->login()->get_db_data()->get_session_data(); 
```

# apache - 如何使用 ApacheBench 修复“ssl 握手失败”？

> ID：189993
> 
> 赞同：32
> 
> 时间：2008-10-10T03:00:58.973
> 
> 标签：apache, https, apachebench

当我使用 ApacheBench 测试 https 时，返回错误“ssl 握手失败”。

如何使用 ApacheBench 测试 https？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-11-10T22:01:37.133

ApacheBench 似乎无法忽略证书问题（至少其中一些问题），所以我编写了这个脚本：

```
#!/bin/bash
K=200;    
HTTPSA='https://192.168.1.103:443/'    
date +%M-%S-%N>wgetres.txt
for (( c=1; c<=$K; c++ ))
do
    wget --no-check-certificate --secure-protocol=SSLv3 --spider $HTTPSA
done
date +%M-%S-%N>>wgetres.txt 
```

它不如 AB 精确，但给出了想法。在对比测试中表现良好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-01T03:44:14.077

[httperf](https://github.com/httperf/httperf)也是单线程的，但截至今天（2012 年 8 月 31 日），它可以正确处理 SSL，甚至还有一些围绕 SSL 的有用附加功能：

> ```
>  --ssl  Specifies that all communication between httperf and the server
>       should  utilize  the  Secure Sockets Layer (SSL) protocol.  This
>       option is available only if httperf was compiled with  SSL  supâ€
>       port enabled.
> 
>   --ssl-ciphers=L
>       This  option  is  only  meaningful  if  SSL is in use (see --ssl
>       option).  This option specifies the list L of cipher suites that
>       httperf  may  use  in  negotiating  a secure connection with the
>       server.  If the list contains more than one  cipher  suite,  the
>       ciphers  must  be  separated by a colon.  If the server does not
>       accept any of the listed cipher suites,  the  connection  estabâ€
>       lishment  will  fail and httperf will exit immediately.  If this
>       option is not specified when the --ssl option  is  present  then
>       httperf  will use all of the SSLv3 cipher suites provided by the
>       underlying SSL library.
> 
>  --ssl-no-reuse
>       This option is only meaningful if SSL and sessions  are  in  use
>       (see  --ssl,  --wsess,  --wsesslog).   When an SSL connection is
>       established the client receives a  session  identifier  (session
>       id)  from the server.  On subsequent SSL connections, the client
>       normally reuses this session id in order to avoid the expense of
>       repeating  the  (slow) SSL handshake to establish a new SSL sesâ€
>       sion and obtain another session id (even if the client  attempts
>       to re-use a session id, the server may force the client to reneâ€
>       gotiate a session).  By default httperf reuses  the  session  id
>       across  all  connections  in  a  session.  If the --ssl-no-reuse
>       option is in effect, then httperf will not reuse the session id,
>       and the entire SSL handshake will be performed for each new conâ€
>       nection in a session. 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-21T09:35:06.517

我最近遇到了这个问题。作为一种解决方法，我使用了 loadtest npm 包，它具有与 ab 类似的选项：

[https://www.npmjs.com/package/loadtest](https://www.npmjs.com/package/loadtest)********************