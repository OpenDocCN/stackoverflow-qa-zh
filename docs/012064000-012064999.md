# StackOverflow 问答 12064000-12064999

# django - Django：在 forms.py clean 函数中访问请求

> ID：12064000
> 
> 赞同：13
> 
> 时间：2012-08-21T22:31:26.777
> 
> 标签：django, django-forms, request, django-class-based-views

嗨 Stackoverflow 人，

在 forms.py 中的 clean 函数中，我想在会话变量中自动保存一些信息。但是，我似乎无法访问请求变量。

移交请求变量的所有示例都基于基于函数的视图，但这里我使用的是基于类的视图。

**我的forms.py：**

```
from django import forms
from item.models import Item

class CreateItemForm(forms.ModelForm):
    class Meta:
        model = Item
        fields = ('name', 'description')

    def __init__(self, request, *args, **kwargs):
        self.request = request
        super(CreateItemForm, self).__init__(*args, **kwargs)

    def clean(self):
        cleaned_data = super(CreateItemForm, self).clean()
        if cleaned_data.get("address"):
            self.request.session['name'] = cleaned_data.get("name") 
        else:
            raise forms.ValidationError(_('Oops, can\'t find location.'))
        return self.cleaned_data 
```

**我的意见.py：**

```
from django.views.generic.edit import FormView
from item.forms import CreateItemForm

class ItemCreate(FormView):
    form_class = CreateItemForm 
    template_name = 'item/item_create.html' 
    success_url = 'http://www.google.com' 
```

**`request`将变量从 views.py 移交给 forms.py的最佳方法是什么？**

谢谢您的回答。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-21T22:36:32.267

您可以覆盖`FormMixin`'s[`get_form_kwargs`方法](https://github.com/django/django/blob/master/django/views/generic/edit.py#L36)以将请求添加到表单的 init 参数中：

```
class ItemCreate(FormView):
     def get_form_kwargs(self):
         kwargs = super(ItemCreate, self).get_form_kwargs()
         kwargs.update({
             'request' : self.request
         })
         return kwargs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-11T17:54:38.407

覆盖 form.get_initial() 对我有用

```
class ItemCreate(FormView):
    def get_initial(self):
        init = super(ItemCreate, self).get_initial()
        init.update({'request':self.request})
        return init 
```

在 clean 中，我们可以使用 form.initial dict 访问它

```
class sampleForm(forms.Form):
    ...
    ...
    def clean(self):
    user_request = self.initial['request'] 
```

顺便说一句，我们不需要像上面建议的那样弹出额外的参数。

# clojure - Leiningen 中是否有独立的 Clojure 包？

> ID：12064001
> 
> 赞同：5
> 
> 时间：2012-08-21T22:31:28.093
> 
> 标签：clojure, leiningen

[使用此脚本https://raw.github.com/technomancy/leiningen/preview/bin/lein](https://raw.github.com/technomancy/leiningen/preview/bin/lein)安装 leiningen 后，我可以通过键入来使用**repl**`lein repl`，所以我认为**clojure**已经由**leiningen**安装了。

我需要从官方网站再次下载clojure的JAR吗？

如果不需要的话，**leiningten**依赖的**clojure的jar 文件在哪里呢？**

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T22:54:46.580

leiningen 从 maven 存储库下载依赖项并将它们（默认情况下）存储在

```
${HOME}/.m2/repository 
```

leiningen 将它自己的罐子存放在

```
${HOME}/.lein/self-installs 
```

leiningen 搜索的默认 maven 存储库是

*   maven central（您可以在[http://search.maven.org](http://search.maven.org)浏览）
*   clojars（您可以在[http://clojars.org](http://clojars.org)浏览）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-21T22:56:54.697

我在 lein 中发现的是安装它，然后根据 Clojure 的特定版本导致该版本被获取，并且 .jar 文件在 maven 存储库中结束。

```
(defproject repl-test "0.0.1-SNAPSHOT"
  :description "TODO: add summary of your project"
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [org.clojure/clojure-contrib "1.2.0"]
                 [clojure-csv/clojure-csv "1.3.2"]
                 [org.clojure/tools.cli "0.1.0"]
                 [util "1.0.2-SNAPSHOT"]
                 [clj-http "0.1.3"]]
   :aot [repl-test.core]
   :main repl-test.core) 
```

我不确定 Clojure 是如何与 lein 打包的，但我确实通过观看 lein 构建知道它会导致`:dependencies`获取（下载）Clojure 的版本。

lein 太好了，以至于我实际上卸载了默认的 Clojure，因为当 Clojure 进入新版本时，拥有 lein 就不那么痛苦了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T17:07:54.987

Leiningen 是一个为您管理 Clojure（和 Java）库的工具 --- 包括 Clojure 本身（它只是另一个 Java 库（一个 jar））。

使用 lein 时无需手动下载任何 jar。

Leiningen 由两部分组成：`lein`脚本和它保存在 ~/.lein 中的实现 jar --- 但你不必担心那个 jar；该`lein`脚本负责为您获取它。

我写了一个[Brief Beginner's Guide](http://www.unexpected-vortices.com/clojure/brief-beginners-guide/)，你可能会觉得它有用。**

# wcf - WCF Web服务中的延迟调用方法-第一次

> ID：12064006
> 
> 赞同：0
> 
> 时间：2012-08-21T22:31:52.367
> 
> 标签：wcf, networking, delay, basichttpbinding

我有一个 WCF Web 服务框架 4，它在**BasicHttpBinding中公开了一种非常简单的身份验证方法**

没什么特别的：

```
[ServiceContract]
public interface IAutorizedUser
{
   [OperationContract
   GetAuthentication bool (string UserName, string Password
} 
```

问题是，当我从远程 pc 调用该方法时，在响应之前我有 20 秒的延迟，这是第一次。原因不是方法内的代码：即使我完全注释了该代码，我也会有同样的延迟。从第二次开始，该方法被正常快速地调用。

该服务器中托管的其他 html 页面很快。

如果该方法的调用从托管 Web 服务的服务器开始，则没有问题。对于我们办公室局域网中的其他远程电脑，问题总是会出现，唯一的例外是另一台服务器，延迟限制为 5 秒。

我意识到问题的术语非常笼统，但本能地我认为问题可能存在于某些 WCF 设置中。你怎么看？你可以帮帮我吗？

提前谢谢你， Pileggi

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T14:06:03.127

问题是客户端 web.config 中的 useDefaultWebProxy，我必须将其设置为 false：

```
<basicHttpBinding>
    <binding name="pippo" ... useDefaultWebProxy="false">
        ... 
```

现在我的问题在这里：

[Visual Studio“添加服务引用” - 未获取所有服务设置](https://stackoverflow.com/questions/12246892/visual-studio-add-service-reference-not-gets-all-service-settings)

和这里：

[使用 Web 引用在 WCF 客户端上设置 useDefaultWebProxy=false](https://stackoverflow.com/questions/12247129/set-usedefaultwebproxy-false-on-wcf-client-with-the-web-references)

皮莱吉

# r - 使用ggplot2在多面点图中的因子顺序

> ID：12064007
> 
> 赞同：8
> 
> 时间：2012-08-21T22:31:52.507
> 
> 标签：r, ggplot2

我正在尝试更改 ggplot2 中多面点图的方面内的绘图顺序，但我无法让它工作。这是我融化的数据集：

```
> London.melt
                      country medal.type count
1                 South Korea       gold    13
2                       Italy       gold     8 
3                      France       gold    11
4                   Australia       gold     7
5                       Japan       gold     7
6                     Germany       gold    11
7  Great Britain & N. Ireland       gold    29
8          Russian Federation       gold    24
9                       China       gold    38
10              United States       gold    46
11                South Korea     silver     8
12                      Italy     silver     9
13                     France     silver    11
14                  Australia     silver    16
15                      Japan     silver    14
16                    Germany     silver    19
17 Great Britain & N. Ireland     silver    17
18         Russian Federation     silver    26
19                      China     silver    27
20              United States     silver    29
21                South Korea     bronze     7
22                      Italy     bronze    11
23                     France     bronze    12
24                  Australia     bronze    12
25                      Japan     bronze    17
26                    Germany     bronze    14
27 Great Britain & N. Ireland     bronze    19
28         Russian Federation     bronze    32
29                      China     bronze    23
30              United States     bronze    29 
```

这是我的情节命令：

```
qplot(x = count, y = country, data = London.melt, geom = "point", facets = medal.type ~.) 
```

我得到的结果如下：

![R图](../Images/c577b33538449978ef271fde863196cf.png)

方面本身按我想要的顺序出现在这个情节中。然而，在每个方面，我想按数量排序。也就是说，对于每种类型的奖牌，我希望获得最多奖牌的国家排在首位，依此类推。我在没有方面时成功使用的过程（比如我们只看金牌）是使用 `reorder`factor 上的函数`country`，排序，`count`但这在本示例中不起作用。

我非常感谢您提出的任何建议。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-22T00:54:47.087

这是使用粘贴、自由秤和一些重新标记的解决方案

```
library(ggplot2)
London.melt$medal.type<-factor(London.melt$medal.type, levels = c("gold","silver","bronze"))
# Make every country unique
London.melt$country_l <- with(London.melt, paste(country, medal.type, sep = "_"))
#Reorder the unique countrys
q <- qplot(x = count, y = reorder(country_l, count), data = London.melt, geom = "point") +   facet_grid(medal.type ~., scales = "free_y")
# Rename the countries using the original names
q + scale_y_discrete("Country", breaks = London.melt$country_l, label = London.melt$country) 
```

![在此处输入图像描述](../Images/f49144a589368afc65a110ba3f5b5fb2.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-26T15:26:34.010

这显然已经很晚了，我正在做的一些事情可能在 6 年前还没有，但我在做类似任务时遇到了这个问题。我总是不愿意用向量设置刻度标签——使用可以对原始标签进行操作的函数感觉更安全。

为此，我正在创建一个基于国家和奖牌的因素 ID 列，其中包含一些尚未出现在这些列中的分隔符 - 在这种情况下，`_`有效。然后`forcats::fct_reorder`，我可以按 . 排序该列`count`。此列的最后几个级别如下，应对应于计数最高的国家+奖牌组合。

```
library(tidyverse)

London_ordered <- London.melt %>%
  mutate(id = paste(country, medal.type, sep = "_") %>%
           as_factor() %>%
           fct_reorder(count, .fun = min))

levels(London_ordered$id) %>% tail()
#> [1] "Great Britain & N. Ireland_gold" "United States_silver"           
#> [3] "United States_bronze"            "Russian Federation_bronze"      
#> [5] "China_gold"                      "United States_gold" 
```

然后将此 ID 用作您的 y 轴。就其本身而言，您将拥有包含奖牌类型的很长的标签。由于唯一的分隔符，您可以为 y 轴标签编写一个内联函数，该函数将删除分隔符及其后面的任何单词字符，只剩下国家。将构面规范移至`facet_wrap`函数可让您设置自由 y 比例。

```
qplot(x = count, y = id, data = London_ordered, geom = "point") +
  scale_y_discrete(labels = function(x) str_remove(x, "_\\w+$")) +
  facet_wrap(~ medal.type, scales = "free_y", ncol = 1) 
```

![](../Images/9fb6ab7904f89156a12a5118570f27c6.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:51:44.270

这是我能用 qplot 做的最好的事情。不完全是你要求的，但更接近。OOOPs 我看到你已经想通了。

```
q <- qplot(x = count, y = reorder(country, count), data = London.melt, geom = "point", facets = medal.type ~.) 
```

这是一个`dput`版本，以便其他人可以改进：

```
dput(London.melt)
structure(list(country = structure(c(9L, 6L, 3L, 1L, 7L, 4L, 
5L, 8L, 2L, 10L, 9L, 6L, 3L, 1L, 7L, 4L, 5L, 8L, 2L, 10L, 9L, 
6L, 3L, 1L, 7L, 4L, 5L, 8L, 2L, 10L), .Label = c("Australia", 
"China", "France", "Germany", "Great Britain & N. Ireland", "Italy", 
"Japan", "Russian Federation", "South Korea", "United States"
), class = "factor"), medal.type = structure(c(2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("bronze", 
"gold", "silver"), class = "factor"), count = c(13L, 8L, 11L, 
7L, 7L, 11L, 29L, 24L, 38L, 46L, 8L, 9L, 11L, 16L, 14L, 19L, 
17L, 26L, 27L, 29L, 7L, 11L, 12L, 12L, 17L, 14L, 19L, 32L, 23L, 
29L)), .Names = c("country", "medal.type", "count"), class = "data.frame", row.names = c("1", 
"2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", 
"14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", 
"25", "26", "27", "28", "29", "30")) 
```

# c# - XPath 用于选择特定节点下的节点，其间有零个或多个节点

> ID：12064010
> 
> 赞同：2
> 
> 时间：2012-08-21T22:31:58.367
> 
> 标签：c#, xpath, xml-parsing, xpathnavigator

我的 Xml 看起来像这样

```
 <root>
       <parent name="Iam">
          <child1 name="123">
              <toy name="wii">
              </toy>
          </child>
       </parent>
       <parent name="Iam">
          <toy name="wii">
          </toy>
       </parent>
       <parent name="Sam">
          <child1 name="999">
             <toy name="xbox">
             </toy>
           </child>
        </parent>
      </root> 
```

我需要选择名称为“Iam”的 <parent> 下所有名称为“wii”的 <toy> 节点。请注意，<toy> 可以是 <parent> 的直接子代，也可以是 <parent> 的孙子代（在 <child> 下）

<child>节点可以有 0 个或多个基数。

我尝试将此 xpath **/parent[@name='Iam']/*/toy[@name='wii']**与 XPathNavigator 一起使用。

```
`XPathNodeIterator nodeIter = schemaNavigator.Select(schemaXPath, namespaceMgr);` 
```

这显然是错误的，因为它失败了。

我需要 xpath 来选择 <parent> 和 <toy> 之间具有 0 或更多基数的所有节点。

我无法更改 XML 的格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:24:09.333

这似乎对我有用：

```
 string schemaXPath = "//parent[@name='Iam']//toy[@name='wii']";
        XPathNavigator schemaNavigator  = oXmlDocument.CreateNavigator();
        XPathNodeIterator nodeIter = schemaNavigator.Select(schemaXPath, namespaceMgr);

        while (nodeIter.MoveNext() == true)
        {
            Console.WriteLine(nodeIter.Current.Name);
        } 
```

希望这是您正在寻找的。

干杯!

# javascript - Photoshop 脚本：将图像移动到位置 x,y

> ID：12064015
> 
> 赞同：9
> 
> 时间：2012-08-21T22:32:28.950
> 
> 标签：javascript, photoshop, flash-cs5, photoshop-script

我有一个由我想移动到画布中的绝对位置 x,y`ArtLayer`的变量引用的活动。`NewLayer`

我已经用谷歌搜索了几个小时没有任何结果。有人可以举个例子吗？

// 谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-21T23:27:39.810

经过更多的 API 阅读和搜索后，我得出结论，只能使用 delta move 移动层。

我编写了这个小函数来将图层定位在绝对位置。希望这对下一个有同样问题的读者有所帮助......

```
//******************************************
// MOVE LAYER TO
// Author: Max Kielland
//
// Moves layer fLayer to the absolute
// position fX,fY. The unit of fX and fY are
// the same as the ruler setting. 

function MoveLayerTo(fLayer,fX,fY) {

  var Position = fLayer.bounds;
  Position[0] = fX - Position[0];
  Position[1] = fY - Position[1];

  fLayer.translate(-Position[0],-Position[1]);
} 
```

# c# - 关于是什么导致我的瓷砖不适合在一起的任何想法？

> ID：12064017
> 
> 赞同：0
> 
> 时间：2012-08-21T22:32:32.703
> 
> 标签：c#, xna, double

我有一个用 XNA 编写的瓦片系统，但瓦片装配在一起存在问题。

我的意思是，有时图块被 1 个像素分隔（也许是 2 个像素？不能说），并且它们应该完美地组合在一起。我确信我为将它们组合在一起所做的数学运算是正确的，我不知道是什么导致了这个问题。

令人惊讶的是，当我将图块的大小（双倍）提高到 1000 时，这个问题得到了解决。大小仅与我的相机变焦有关，所以这根本不会影响游戏玩法，但它困扰着我，我必须这样做。

关于可能导致这种情况的任何想法？

编辑：事实上，任何低于 995 的瓷砖尺寸都有问题，但任何高于 995 的东西都很好，这是某种奇怪的精度问题。双倍数学对高数字或其他东西更准确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:36:13.107

好吧，像素是整数，如果你的图块的大小是双倍的，这意味着你必须进行某种转换才能得到像素，这反过来可能是你得到分离的地方。

例如，如果图块 A 从 0 开始，长度为 9.9，那么您将下一个图块放在哪里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T13:37:22.177

如果不了解您如何处理瓷砖放置，则很难诊断。您的瓷砖是固定宽度和高度还是可变的？

这是我如何布置由大小为 32x32 的图块组成的关卡。

*   瓦片类包含瓦片的纹理和瓦片的网格位置。
*   遍历 Tile 集合并将它们绘制在：
    *   X = gridPosition.X * textureWidth
    *   Y = gridPosition.Y * textureHeight

因此，如果您在网格位置 (0, 0) 有一个 32x32 的图块，那么它将在 (0, 0) 处绘制。如果您在网格位置 (0, 1) 有一个 32x32 的图块，那么它将在 (0, 32) 处绘制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T09:29:26.103

如果您在这种情况下进行四舍五入，您将使用`Math.Round(value, 0, MidpointRounding.AwayFromZero)`因为`Math.Round(value)`不会返回您在数学上被教导为“四舍五入”的内容。

我不记得具体细节，但它会出现`Math.Round(0.5) = 0`和`Math.Round(1.5) = 2`！

# matlab - 最小化具有大向量变量的函数的最佳方法？

> ID：12064018
> 
> 赞同：2
> 
> 时间：2012-08-21T22:32:59.513
> 
> 标签：matlab, mathematical-optimization

我试图最小化一个函数，它是一个 1x25 向量（weights_vector）的函数。换句话说，我试图在向量中找到使函数最小化的值。

函数定义为：

```
 function weights_correct = Moo(weights_vector)

    corr_matrix = evalin('base', 'corr_matrix');
    tolerance = evalin('base', 'tolerance');
    returns = evalin('base', 'returns');

    weights_correct = weights_vector'*corr_matrix*weights_vector - tolerance*returns'*weights_vector; 

    end 
```

在此功能上，我正在调用：

```
 weights_correct = fminsearch(@Moo, weights_vector); 
```

这会迭代，直到我看到错误

```
 "Exiting: Maximum number of function evaluations has been exceeded
         - increase MaxFunEvals option." 
```

这让我相信我没有正确地最小化。这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:45:20.107

在这里使用 evalin 是愚蠢的。多次调用 evalin 将无缘无故地低效。如果您将努力学习将 evalin 用于错误的目的，那么请努力学习如何使用函数句柄。

您甚至不需要定义 m 文件，尽管您可以这样做。一个简单的函数句柄就足够了。

```
Moo = @(w_v) w_v'*corr_matrix*w_v-tolerance*returns'*w_v; 
```

然后调用更好的优化器。在 25 个变量的问题上使用 fminsearch 是很疯狂的。如果你会做很多优化，优化工具箱是值得投资的。

```
weights_correct = fminunc(@Moo, weights_vector); 
```

或者，您可以在一行中完成所有操作。

```
weights_correct = fminunc(@(w_v) w_v'*corr_matrix*w_v-tolerance*returns'*w_v, weights_vector); 
```

请注意，当您在此处创建函数句柄时，MATLAB 会传入这些数组的值。

最后，max function evals 的问题是您正在做的事情的症状。25 个变量对于 fminsearch 在任何合理的时间内都无法收敛。您当然可以更改限制，但最好是使用正确的工具开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T22:50:34.017

您超出了默认的函数评估次数。你可以改变它使用

```
weights_correct = fminsearch(@Moo, weights_vector, optimset('MaxFunEvals', num); 
```

`num`您指定的数字在哪里。默认值为[`200*numberOfVariables`](http://www.mathworks.com/help/toolbox/optim/ug/fminsearch.html).

我当然不是专家，请有人纠正我，但是 25 个变量对于优化例程来说似乎很多。

# login - 如何让谷歌网站页面显示特定于当前登录用户的内容

> ID：12064019
> 
> 赞同：4
> 
> 时间：2012-08-21T22:33:08.433
> 
> 标签：login, google-apps-script, google-sites

我一直想知道是否可以让谷歌网站页面显示特定于当前登录用户的内容。我一直在谷歌上寻找解决方案，但从未提出任何结论。

基本上，我将 Google 网站用于我的大学课程网站。如果我可以显示特定于个别学生的内容，我会很高兴，例如，你已经完成了作业 1,2 和 3 - 现在是时候处理第 4 号作业了

提前谢谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T17:28:05.820

我在谷歌搜索并发现了这个：

> 您可以使用页面级权限向某些用户显示某些页面。您也可以使用 Google Apps 脚本来检测登录用户，但您可以在 Google Apps 脚本中显示的内容是有限的。我会去页面级权限。

（[链接到](http://productforums.google.com/forum/#!topic/sites/lOCVf1aJZNo)Google 社区支持网站上的该帖子。）

我认为这对你来说是一个好的开始。

# c# - 使用 IntermediateSerializer，如何反序列化对象中的列表？

> ID：12064021
> 
> 赞同：0
> 
> 时间：2012-08-21T22:33:12.750
> 
> 标签：c#, xml, xna

比方说，例如，这是我的课......

```
public class DoodadData
{
    public List<Color> colorVariations;
} 
```

...这是我正在反序列化的 XML 数据...

```
<?xml version="1.0" encoding="utf-8" ?>
<XnaContent>
    <Asset Type="Data.DoodadData">
        <colorVariations>
            <Item>
                <R>0</R>
                <G>0</G>
                <B>0</B>
                <A>0</A>
            </Item>
        </colorVariations>
    </Asset>
</XnaContent> 
```

我需要改变什么才能让它工作吗？MSVC 给我的错误说...

*“反序列化中间 XML 时出错。'Element' 是无效的 XmlNodeType。第 20 行，位置 5。”*

这将我指向 colorVariations 列表中的第一个“项目”标签。我在 Google 上找到的所有内容都告诉我，使用 IntermediateSerializer 时将元素命名为“Item”是正确的。我也尝试将它们命名为“元素”和“颜色”，但无济于事。（我还尝试了其他方法，例如重命名 RGBA 属性，但也没有用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:23:47.803

在弄乱它之后，我发现似乎需要以无标签和十六进制格式输入颜色，如下所示：

```
<colorVariations>
    FFFFFFFF
    FFFFFFFF
    FFFFFFFF
</colorVariations> 
```

# ruby-on-rails - 如何在 Ruby on Rails 中解析翻译日期？

> ID：12064029
> 
> 赞同：2
> 
> 时间：2012-08-21T22:33:53.953
> 
> 标签：ruby-on-rails, internationalization

我已经在 Ruby on Rails 中配置了一个带有西班牙语翻译的应用程序。

现在我需要解析一个翻译后的日期，例如：

> Jueves，2012 年 11 月 22 日

我正在尝试这样做：

```
Date.strptime('Jueves, 22 de Noviembre, 2012', '%A, %e de %B, %Y') 
```

但它会引发`invalid date`错误。

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T00:54:51.027

`Date::parse`应该懂西班牙语。但是，这`de`似乎使解析器关闭。如果你能把它变成这种格式，这将起作用

```
Date.parse "Jueves, 22 Noviembre, 2012"
=> Thu, 22 Nov 2012 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-07-29T14:42:11.477

我有一个非常相似的问题，我写了一个 gem 专门用于解析任何非英语文本日期（使用公历），它叫做[Quando](https://github.com/kinkou/quando)。gem 自述文件内容丰富，并包含代码示例，但简而言之，它是这样工作的：

```
require 'quando'

Quando.configure do |c|
  # First, tell the library how to identify Spanish months in your dates:
  c.jan = /enero/i
  c.feb = /febrero/i
  c.mar = /marzo/i
  c.apr = /abril/i
  c.may = /mayo/i
  c.jun = /junio/i
  c.jul = /julio/i
  c.aug = /agosto/i
  c.sep = /septiembre/i
  c.oct = /octubre/i
  c.nov = /noviembre/i
  c.dec = /diciembre/i

  # Then, define pattern matchers for different date variations that you need to parse.
  # c.day is a predefined regexp that matches numbers from 1 to 31;
  # c.month_txt is a regexp that combines all month names that you previously defined;
  # c.year is a predefined regexp that matches 4-digit numbers;
  # c.dlm matches date parts separators, like . , - / etc. See readme for more information.
  c.formats = [
    /#{c.day} \s #{c.month_txt} ,\s #{c.year} $/xi, # matches "22 Mayo, 2012" or similar
    /#{c.year} - #{c.month_txt} - #{c.day}/xi, # matches "2012-Mayo-22" or similar
    # Add more matchers as needed. The higher in the order take preference.
  ]
end

# Then parse the date:
Quando.parse('Jueves, 22 Noviembre, 2012') # => #<Date: 2012-11-22 …&gt; 
```

您可以部分或全部重新定义日期部分和格式的匹配器，全局或仅针对单个解析器实例（以保留您的全局设置），并使用正则表达式的所有功能。自述文件和源代码中有更多示例。希望你会发现这个库很有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-16T15:01:34.577

所以，答案是：至少现在是不可能的。

让它工作的唯一方法是在客户端使用 javascript，并在将字段发送到服务器之前将格式转换为另一种格式。然后 Rails 解析它不会有任何问题。

# database - 有什么理由不应该在生产中使用 h2 数据库？

> ID：12064030
> 
> 赞同：29
> 
> 时间：2012-08-21T22:34:01.113
> 
> 标签：database, jboss, h2

我最近正在考虑制作一个使用 h2 数据库作为其主数据库的应用程序（因为它带有 JBoss），但我有点担心。我在几个地方（主要是讨论板）读到不应在生产中使用 h2。有没有具体的原因？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-22T04:52:22.473

不使用 H2（或 HSQLDB，或 Derby）进行生产的主要原因是：

*   严重错误的概率：与“大型”数据库 Oracle、IBM DB 2、MS SQL Server、MySQL、PostgreSQL 相比，Java 数据库相对较新，因此可能不太稳定（有错误）。请注意，这适用于所有较新的产品，包括 NoSQL 数据库和“大型”数据库的新版本。通常，产品测试的次数越多，出现错误的可能性就越小。当然，这取决于您的用例是否有必要为这个优势支付（可能是很多钱）。在任何情况下，您都需要备份数据，例如在硬件故障的情况下。

*   缺少功能和优化：“大”数据库具有更多针对特殊用例的功能和优化。是否需要这些功能取决于您。

*   商业支持：更容易获得对更大数据库的支持。请注意[，商业支持也可用于 H2](http://h2database.com/html/links.html#commercial_support)。HSQLDB 也提供商业支持。IBM 曾经为 Apache Derby（嗯，IBM Cloudscape）提供支持，但我相信他们停止了。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-04T12:29:26.983

以我个人的经验，H2 版本 1.2.147 似乎非常可靠，在大约 60 次安装中 100% 成功，但我的客户只有相对较小的数据库（400 MB 是更大的大小）而且我的程序只使用一个连接（大声笑），只有最近我开始使用多个连接但使用`multi_threaded`错误。我对一些以前的版本有损坏，我害怕尝试更新的版本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-06-05T09:30:42.210

对我来说，没有理由不在生产中使用 H2DB 进行中型项目。我们为大约 15 个使用 H2DB 的客户部署了一个生产系统，我们经历了非常简单的安装和备份，而且数据库方面的问题为零。

# php - 如何为视图助手设置不同的路径？

> ID：12064034
> 
> 赞同：0
> 
> 时间：2012-08-21T22:34:33.733
> 
> 标签：php, zend-framework

我正在使用 Zend Framework 开发一个模块化应用程序，我发现我使用了很多在我的所有模块中通用的视图助手，我希望有以下结构工作，我有一个视图助手的中心位置可以使用在任何模块加上每个模块都有自己的视图助手，这可能吗？

```
APPLICATION_PATH
    /modules/module1/views/helpers
    /modules/module2/views/helpers
    /modules/module3/views/helpers
    /views/helpers <-- central location for all modules 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:11:32.767

感谢 joellord 的帮助，根据 joellord 提供的信息，我能够从中心位置加载视图助手以及位于每个模块中的视图助手。我将以下内容添加到我的主应用程序引导文件中：

```
public function _initView(){
    $view = new Zend_View($this->getOptions());

    $view->setEncoding('UTF-8');
    $view->addHelperPath(APPLICATION_PATH.'/helpers/', 'Application_Helpers_');
     $viewRenderer = Zend_Controller_Action_HelperBroker::getStaticHelper(
        'ViewRenderer'
    );
    $viewRenderer->setView($view);
    return $view;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:37:16.943

在我的引导程序中，我具有以下功能：

```
protected function _initView() {
  $view->addHelperPath(APPLICATION_PATH."/../library/Myapp/View/Helper/", 'Myapp_View_Helper_');
  } 
```

这有助于我实现我认为你想要的。我的通用助手都位于 /library/Myapp/View/Helper

# ruby-on-rails - Rails 规范：模板错误

> ID：12064035
> 
> 赞同：0
> 
> 时间：2012-08-21T22:34:39.757
> 
> 标签：ruby-on-rails, templates, rspec

我正在尝试根据 Michael Hartl 在他的教程中的用户模型创建一个订单模型来接收订单。

我在 View 的 Orders 目录中创建了一个基本的订单页面和确认页面。我为内容创建了测试，当我运行它们时，它们会显示各种错误，大多数与此有关：

```
Failure/Error: before { visit root_path }
  ActionView::Template::Error:
      No route matches {:action=>"show", :controller=>"orders"} 
```

我认为这与缺少视图（“模板”的原因）有关，但正如我所说，我有这些文件。在我的 routes.rb 文件中，我有以下内容：

```
resources :orders

root to: 'alpha#welcome'

match '/order', to: 'orders#new'

match '/about', to: 'alpha#about'
match '/contact', to: 'alpha#contact'
match '/confirmation', to: 'orders#show' 
```

我的订单控制器这样说：

```
class OrdersController < ApplicationController
  def show
    @order = Order.find(params[:id])
  end

  def new
    @order = Order.new
  end
end 
```

我一直在梳理他的教程，试图找出我做错了什么，但还没有任何效果。帮助？我对此很陌生。

哦。另外令人困惑的是，rspec 声称它在规范文档中存在此问题，而该规范文档根本不尝试遵循这些路线中的任何一条。（我有三个规范：一个用于静态页面，一个用于订单模型，一个用于订单页面。静态页面一是抱怨订单模型控制器中的操作。）

谢谢，根据要求，这是我的订单页面规范：

```
require 'spec_helper'

describe "Order Pages" do 

    subject { page }

    describe "order page" do
        before {visit order_path}

        it { should have_selector('h1', text: 'Order Below') }
        it { should have_selector('title', text: 'Order') }

    end

    describe "confirmation page" do
        let(:order) { FactoryGirl.create(:order) }
        before { visit confirmation_path(order) }

        it { should have_selector('h1',    text: 'Your order:') }
        it { should have_selector('title', text: 'Order') }
    end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:47:46.170

从你得到的错误来看，`:id`你的路线中缺少一个，所以我怀疑你在调用你的规范时没有将订单作为参数包括在内`order_path`（如果你包含规范代码会很有帮助）。

您应该在您的规范中调用任何成员操作 ( `show`, `update`, ) 的路径，如下所示：`destroy`

```
visit order_path(@order) 
```

（一旦您发布规范代码，我将在此答案中添加更多内容。）

# c# - 我应该插入 MemoryBarrier 吗？

> ID：12064036
> 
> 赞同：0
> 
> 时间：2012-08-21T12:14:58.300
> 
> 标签：c#, multithreading

我有这样的代码：

```
.....
private volatile bool _connSharedDisposed;
......

    // Thread 1
    while (!_connSharedDisposed)
    {
        Thread.Sleep(1);
    }
    CGate.Close();

    ......
    // Thread 2
    _connShared.Close();
    _listenerFutInfo.Close();
    _listenerFutInfo.Dispose();
    _listenerFutCommon.Close();
    _listenerFutCommon.Dispose();
    _connShared.Dispose();
    // insert Thread.MemoryBarrier here?
    _connSharedDisposed = true; 
```

恐怕在打电话之前`_connSharedDisposed = true`可能会重新安排和接收。可能吗？如果我的代码不起作用如何修复它？我想我可能应该插入 MemoryBarrier 来阻止“重新排列”`true``_connShared.Dispose()`

也可能我应该使用`AutoResetEvent`而不是`bool volatile`变量...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T22:54:02.757

如果您已声明`_connSharedDisposed`with `volatile`，则无需使用`MemoryBarrier`.

`volatile`使对字段的每次写入都是易失性写入，对字段的每次读取都是易失性读取。这意味着编译器无法对指令重新排序，以使对该字段的访问顺序相对于彼此保持相同。

在 x86 以外的处理器上，`volatile`还会导致任何 CPU 缓存写入刷新到 RAM。如果您为 x86 编译，则`volatile`仅适用于编译器优化。

如果您要做的是使单个线程进入等待状态，直到发生某些事情，那么您可以使用自动重置事件来代替。 `AutoResetEvent`是模拟这个的类。如果您想允许多个线程停止等待，手动重置事件可能是更好的选择。 `ManualResetEvent`或`ManualResetEventSlim`（在 .NET 4.0 或更高版本中）是为其建模的类。

# c# - 属性具有某些属性时的自定义编辑器模板

> ID：12064037
> 
> 赞同：0
> 
> 时间：2012-08-21T22:35:01.130
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework, asp.net-mvc-4

这就是实现的样子

```
public class Product
{
    public integer id {get;set;}
    [MultiLangual]
    public string name {get;set;}
} 
```

在数据库中，名称将包含以下内容：

```
{en:Pataoto, nl: Aardappel, de: Patat, fr: pommes de terre} 
```

这将包含客户提供给他自己的产品的所有翻译字段。（在这种情况下：patato）。

在前端，这将显示为多个 html 元素，我（以某种方式）在提交表单时检测到它是哪种语言。

我的问题是，我该怎么做？我总是坚持创建属性，不知道从哪里继续......

在我的属性中，我不应该做很多事情，就像这样（我认为）：

```
public class MultiLangualAttribute : Attribute
{
    public MultiLangualAttribute() : base()
    { 
    }

    public override string ToString()
    {
        return base.ToString();
    }
} 
```

但是我将如何检测视图中的所有内容并为其创建自定义布局（这应该与 and 一起使用。它只包含文本。

上面的任何想法或更好的实现都会非常有用:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:13:33.080

我认为更好的（可以说）实现是应用程序本地化的标准方式。`App_GlobalResources`您在必须创建的文件夹下定义资源和字符串。例如，您将创建文件`Fruits.resx`，其中包含要翻译成系统语言的所有水果。之后，您将使用您希望在您的网站中使用的所有语言来创建等`Fruits.de.resx`。`Fruits.es.resx`也可以在运行时更新资源。在这个答案中描述所有方法太多了，我宁愿提供一个或两个链接，其中包含有关 MVC 应用程序本地化的详细教程：

*   这是经典的 ASP.NET MVC 本地化解释： [Globalization And Localization With Razor Web Pages](http://www.mikesdotnetting.com/Article/183/Globalization-And-Localization-With-Razor-Web-Pages)

*   对同一件事的另一种解释，更详细一点在这里： [ASP.NET MVC 本地化：使用自定义模板生成资源文件和本地化视图](http://ruijarimba.wordpress.com/2011/05/16/asp-net-mvc-localization-generate-resource-files-and-localized-views-using-custom-templates/) 这应该足以让您以标准方式本地化您的应用程序。

*   当他们使用语言作为您访问的 URL 的一部分时，这是一种更高级的方法。 `es.yourdomain.com`将是西班牙语，`fr.yourdomain.com`将是法语： [ASP.NET MVC 中的本地化 - 3 天调查，1 天工作](http://geekswithblogs.net/shaunxu/archive/2010/05/06/localization-in-asp.net-mvc-ndash-3-days-investigation-1-day.aspx)

*   关于您的方法（在数据库中存储不同的语言），这里是微软方法的链接。它更加复杂和复杂，我不确定它的复杂性是否会使您受益，因为您最终使用数据库来获取应用程序中的每个字符串。不是最有效但也是可能的方法： [Extended the ASP.NET Resource-Provider Model](http://msdn.microsoft.com/en-us/library/aa905797.aspx)

希望这一切对你有帮助，祝你好运

# javascript - JavaScript - 创建可链接函数时最好的方法是什么？

> ID：12064040
> 
> 赞同：13
> 
> 时间：2012-08-21T22:35:25.683
> 
> 标签：javascript, return, return-value

**编辑**
这是使我的问题更简单的尝试。

```
return this.someFunc(); == return { XXX:this.someFunc() }; 
```

**我必须为 XXX 输入什么才能使此声明成立？**

* * *

我正在尝试创建一个可以链接的函数。让我写一些假设的代码。（任何语法错误都会忽略，我打字速度很快，这只是概念代码。）假设所有函数都是在本地或全局定义的。:)

```
test = function(){
  this.someFunc = function(){
    this.retest = function(){
      //...code
    }
    //...code
  }
  this.someFunc2 = function(){
    //...code
  }
  return this.someFunc();
} 
```

这个函数允许我链接：`test().retest();`
但我想做的是返回多个项目。

```
test = function(){
  this.someFunc = function(){
    this.retest = function(){
      //...code
    }
    //...code
  }
  this.someFunc2 = function(){
    //...code
  }
  return { XXX:this.someFunc(), //What do I put for XXX
           next:this };
} 
```

我想这样做以访问 test() 提供的另一个功能：`test().next.someFunc2();`

**所以我的问题是：**
我仍然希望能够像这样链接：`test().retest();`
但我必须这样做：`test().XXX.retest();`

在我的代码中，我可以用什么名字代替 XXX 来完成这个？这甚至可能吗？我已经尝试过`0`了`default`。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-21T23:04:25.433

你可以像这样创建一个可链接的函数：

```
var test = function(){

    var self = {};
    console.log('test called')

    function someFunc() {
        console.log('someFunc')
        return self;
    }

    function someOtherFunc() {
        console.log('someOtherFunc')
        return self;
    }   

    self.someFunc = someFunc;
    self.someOtherFunc = someOtherFunc;
    return self;

}

test().someFunc().someOtherFunc(); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T07:31:13.070

```
function test() {
   // when test() is called as a regular function
   // it's `this` will be `undefined` (in strict mode) or will refer to a global object
   // when test() is called with `new` operator
   // it's `this` will be an instance of `test` object
   if(!(this instanceof test)) {
      // create a new object
      return new test();
   }
   else {
      // this is a `new object` creation              
      console.log('new Test created');
   }
}

// declare functions which will be accessible on test object
test.prototype.someFunc = function() {
    console.log('someFunc');
    return this;
};

test.prototype.someFunc2 = function() {
    console.log('someFunc2');
    return this;
};

// declare a `chaining` function - will create a new `test` object
test.prototype.test = function() {
    return new test(); // new instance will be created
}; 
```

使用此代码，您现在可以运行以下代码

```
test().someFunc().someFunc2().test().someFunc().someFunc().test().test() 
```

以下字符串将写入控制台

```
new Test created
someFunc
someFunc2
new Test created
someFunc
someFunc
new Test created
new Test created 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T16:21:19.997

你有一个范围问题——你不能在函数中引用**_NAME** “测试”，因为你不知道它是如何被调用的。

如果你静态地这样做，你可以这样做：

```
test = function(){

    this.someFunc = function(){ // blaaa
    };

    //...code 
    return { 
        OUTPUT: this.someFunc(), //What do I put for XXX
        test: this
    };
} 
```

将导致：

```
test().test().test().test().OUTPUT (or something like this) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-06T06:55:48.057

好的，所以我想我理解你的问题，但我不确定（这里已经很晚了，所以请给我一些信任）。我认为您希望有这样的行为：

```
test(); //is ["result1"]
test().retest(); //is ["result1", "result2"]
test().retest().retest(); //is ["result1", "result2", "result3"] 
```

您可能希望返回对象而不是字符串，但总体思路相同。代码变得非常简单：

```
var test = (function() {
    var results = ["result1"], 
        i = 1;

    results.retest = (function() {
        results.push("result" + (++i));
        return results;
    });

    return results;
});

test(); //is ["result1"]
test().retest(); //is ["result1", "result2"]
test().retest().retest(); //is ["result1", "result2", "result3"] 
```

不确定这是否是您正在寻找的东西，但也许它会让您走上正确的道路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T22:37:42.047

```
test = function(){

  var someFunc = function(){
      //...code
  }

  return {
      someFunc:someFunc,
      next:this
  }
} 
```

*编辑*- 为清楚起见，更新以反映您的问题更新。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-30T17:00:57.043

做这个

```
test = function(){
  this.someFunc = function(){
    this.retest = function(){
      //...code
    }
    //...code
  }
  this.someFunc2 = function(){
    //...code
  }

  var ret = this.somefunc();
  ret.next = this;

  return ret;
} 
```

编辑：这是一个更好的功能版本

```
test = function(){
  var ret;

  var func = function() {
    console.log("test func");
  }

  ret = function(){
    func();
    return ret;
  }

  ret.test = ret;
  ret.next = ret; // You can define an arbitrary number of members here
  ret.XXX = func(); // Like this, and you can still chain it like your question

  return ret;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-01T10:13:50.870

不确定您的意图是什么，但这将是一个可链接的`Test`功能：

```
function Test(){
  Test.retest = Test.retest || function(){console.log('retested'); return Test;}
  return Test;
}
Test().retest().retest().retest().retest();
/* => result
 retested
 retested
 retested 
 retested
*/
// and
log(Test() === Test); //=> true 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-06T10:14:14.940

由于您的示例与您发布的方式不同，我想您的意思如下：

```
test = function(){
  this.someFunc = function(){
    this.retest = function(){
      //...code
    }
    //...code
  }
  this.someFunc2 = function(){
    //...code
  }
  return new this.someFunc();
} 
```

在返回时注意**新的。**现在，为了仍然能够链接你的函数，你必须返回这个：

```
return {retest: new this.someFunc().retest, next:this}; 
```

这样做可以让你打电话`test().retest();` ，我希望这会有所帮助。

# java - 线程获得级别

> ID：12064041
> 
> 赞同：1
> 
> 时间：2012-08-21T22:35:43.520
> 
> 标签：java, multithreading, synchronization, synchronized

我不清楚的概念

> Java线程进入实例同步java方法时获取**对象级锁**，进入静态同步java方法时获取**类级锁。**

当它说对象级锁和类级锁是什么意思？

**例如：**

```
 public class Counter{
      private static int count = 0;
      private int count2 = 0;

      public static synchronized int getCount(){
           return count;
      }
      public synchronized setCount(int count2){
           this.count2 = count2;
      }
 } 
```

此处的 getCount() 将锁定 Counter.class 对象，而 setCount() 将锁定当前对象(this)。***这***是什么意思？这是否意味着当 getCount() 被调用时，另一个线程由于整个类被锁定而无法访问 setCount() ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:40:58.737

`static`成员与类相关联，而不是与特定实例相关联。结果，`static`成员上的同步有效地同步整个类，因为静态是类成员

实例成员与类的实例相关联（例如，内在`this`锁），因此如果您在成员字段（非静态）上同步，`this`那么您就有一个与实例对象相关联的锁。

在您的示例`getCount`中，同步类的 intrinsik 锁。实际上你正在做：

```
public setCount(int count){
    synchronized(this){
        this.count = count;
    }  
} 
```

如果您这样做，您将在班级级别同步：

```
static Object count = new Object();  
synchronized(count){  

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T22:45:39.657

Java 中的每个对象都有一个[互斥体](http://en.wikipedia.org/wiki/Mutual_exclusion)。由于 a`class`由 type 的对象表示`java.lang.Class`，因此每个类也有一个互斥体。 `synchronized`实例方法锁定实例的互斥锁，而`synchronized static`方法锁定对应`java.lang.Class`实例的互斥锁。

```
class C {
  synchronized T myMethod() { ... }

  static synchronized T myStaticMethod() { ... }
} 
```

相当于

```
class C {
  T myMethod() {
    synchronized (this) { ... }  // An object level lock.
  }

  static T myStaticMethod() {
    synchronized (C.class) { ... }  // A class level lock
    // is really just an object level lock an a Class.
  }
} 
```

* * *

一旦您知道要在哪个对象上进行同步，您就可以`synchronized`通过分解关键字来理解它。

```
synchronized (x) {
  body();
} 
```

表现得像

```
monitorenter(x);  // locks x or throws NullPointerException if x is null.
try {
  body();
} finally {
  monitorexit(x);  // unlocks x
} 
```

其中`monitorenter`和`monitorexit`是[Java 字节码指令](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)，它们分别阻塞直到它们获得互斥体，然后释放互斥体。

由于`synchronized`引入了“受保护区域”，例如`try ... finally`，即使抛出异常，锁也会被释放，但[杀死线程](http://docs.oracle.com/javase/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)会使锁未释放，可能导致[死锁](http://en.wikipedia.org/wiki/Deadlock)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T22:37:51.240

在 Java 中，每个类和一个类的每个实例都被赋予了它们的内在锁。这些是在进入和退出`synchronized`方法时获取和释放的锁。

像往常一样`this`是指`setCount()`被调用的实例，并且因为每个实例都有自己的内在锁，`setCount()`所以只要在您的类的另一个实例上调用它，第二次调用就不会阻塞，而是尝试调用`setCount()`另一个实例`setCount()`通话进行中会阻塞。

类锁和实例锁是不同的，因此`getCount()`永远`setCount()`不会互相妨碍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T14:36:27.583

> 当它说对象级锁和类级锁是什么意思？

当您锁定一个`static`方法时，您将锁定`Class`对象本身，并且每个`ClassLoader`. 在你的例子中，

```
public static synchronized int getCount(){ 
```

这是锁定`Counter.class`对象，与以下内容相同：

```
public static int getCount() {
    synchronized (Counter.class) {
    } 
```

如果您锁定的是非方法，*那么* `static`您锁定的是拥有该方法的对象的实例。在您的示例中：

```
public synchronized void setCount(int count){ 
```

这与锁定特定`Counter`实例相同，等效于：

```
public void setCount(int count){
    synchronized (this) {
       ... 
```

因此，如果您有 2 个`Counter`对象，`counter1`并且`counter2`, 和 1 个线程正在调用`counter1.getCount()`，而另一个正在`counter2.getCount()`同时调用，那么它们都将锁定同一个`Class`对象，一个将阻塞另一个。

但是，如果 2 个线程改为调用`counter1.setCount(...)`，`counter2.setCount()`它们将分别锁定不同的`counter1`对象`counter2`。他们不会互相阻挡。

如前所述，在您的 setter 和 getter 上具有不对称性是非常糟糕的形式，并且两者中的任何一个都是不寻常的`static`。

> 这是否意味着当 getCount() 被调用时，另一个线程由于整个类被锁定而无法访问 setCount() ？

不。如果`getCount()`被调用，`Counter.class`则被锁定，而何时`setCount(...)`被调用`counter1`或被`counter2`锁定。唯一一次锁阻塞线程是当*同一个对象*被另一个线程锁定时。仅仅因为有一个锁`Counter.class`并不*意味着*有某种超级锁。唯一会阻塞另一个线程的时间是它太锁定了`Counter.class`。

我会花点时间阅读 Sun[关于如何`synchronized`工作](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)的精彩文档。

# jquery - 将图像插入与复选框分开的 Jquery Checkbox 元素？

> ID：12064042
> 
> 赞同：0
> 
> 时间：2012-08-21T22:35:55.637
> 
> 标签：jquery, jquery-mobile

我最近看到一个问题非常有帮助...

[将附加图像插入复选框元素 JQuery Mobile](https://stackoverflow.com/questions/11904518/insert-additional-image-into-checkbox-element-jquery-mobile)

我想看看是否有可能更进一步。

![http://i.stack.imgur.com/clhO9.png](../Images/d59e32ece4893235cf74b763c3083327.png)

在上面引用的帖子中（我也偷了图像），一个图像被添加到复选框中，该复选框会弹出一个对话框或链接到其他地方。这很好，但是该图像有一个副作用，当单击图像本身时，它也会选中或取消选中该复选框。它切换了复选框设置，就好像它根本不存在一样。

我想知道的是，有没有办法在复选框上包含一个图像，并让它与复选框完全分开，这样它就不会选中或取消选中该框。

基本上我有一个待办事项列表，它们是复选框，我正在尝试添加一个附加的注释功能，您可以通过单击图像来获得该功能......如果它切换了复选框，那将不起作用应用。

如果有任何可以使用的 jQuery / javascript 魔法，请指出我正确的方向。

此外，我更愿意将其保留在原始帖子中，但我所能看到的只是回答的方法，如果我搞砸了，对不起......我是新来的。

谢谢！-j

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T22:53:27.210

您需要使用`.stopPropagation()`，它会阻止事件冒泡到`label`.

由于您要在 内添加锚点`label`，因此可以使用：

```
$("label a").click(function(e){
    e.stopPropagation();    
}); 
```

# ruby-on-rails - Rails 应用程序设计：Queueing、Resque、Background Services 和 Redis

> ID：12064043
> 
> 赞同：1
> 
> 时间：2012-08-21T22:36:09.333
> 
> 标签：ruby-on-rails, ruby-on-rails-3, resque

我正在设计一个 Rails 应用程序，它接收请求，使用请求中的数据来调用第 3 方 Web 服务，处理回复，然后向原始请求者发送响应，并向另一个服务发出 PUT 请求。

我正在努力思考如何设计这个 Rails 应用程序，因为它与规范的 Rails 结构不同。

对象是列表和任务。每个List都有很多Task，每个Task都属于一个List。

我会得到的请求是这样的：

[http://myrailsapp.heroku.com/v1/lists?id=1&from=2012-02-12&to=2012-02-14&priority=high](http://myrailsapp.heroku.com/v1/lists?id=1&from=2012-02-12&to=2012-02-14&priority=high)

在此示例中，我请求从 2012 年 2 月 12 日到 2012 年 2 月 14 日的任务，在列表 #1 中具有高优先级

然后我会发出这样的第 3 方 Web 服务调用：

[http://thirdpartywebservice.com/v1/lists?id=4128&from=2012-02-12&to=2012-02-14&priority=high](http://thirdpartywebservice.com/v1/lists?id=4128&from=2012-02-12&to=2012-02-14&priority=high) 如您所见，对数据进行了一些处理（在这种情况下，id 已更改）

然后将结果发送回请求者并通过 PUT 发送到另一个 Web 服务。

我的问题是，如何设置 Rails 应用程序来处理这些类型的行为？控制器结构如何变化？这看起来像是队列的一个很好的用例，我如何在队列之间分配多个并发请求？

一方面我不需要数据持久性（数据可以在响应发出后丢弃），并且数据结构设计也得到了简化。（我认为我不需要 ruby​​ 对象，只是表示这些对象的字典或哈希值会更轻，实现起来也更快）

## **编辑**

所以我将应用程序的工作流程分解为这些组件

*   解析传入请求
*   构建第 3 部分 Web 服务请求
*   发送第 3 方请求
*   将工作人员排入队列以处理预期的响应
*   响应到达后处理
*   将解析结果作为响应发回

哪个标准 ruby​​ 控制器处理这些步骤中的每一个？除了 Lists 和 Tasks 还需要哪些模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:52:59.390

您仍然应该使用数据库，因为将数据传递给 Resque 很麻烦。相反，您应该将其存储在数据库中，然后将 id 传递给工作人员、获取数据、提交任何新数据或删除记录。这真的取决于你，但这种方法更清洁。您还可以使用 faye 之类的推送服务来让用户知道处理何时完成。

如果您希望有许多并发请求，我会推荐 Sidekiq，因为它不太占用内存。拥有 4-5 个 resque worker 已经可以吸收大约 512 MB。控制器结构不应改变。请评论您需要澄清的任何内容，我很乐意更新我的答案。

**编辑**

您可能希望使用单独的数据库存储，例如 Postgres。不确定您需要什么模型是否重要，但本质上这是应该发生的事情。

1.  在您的控制器中，创建一个`Request`对象，其中包含您要用来查询此第 3 方服务的查询参数。然后将要由 Sidekiq/Resque 处理的作业排入队列，让我们调用它`ThirdPartyRequest`并传入您刚刚创建的对象的 id`Request`作为参数。然后在此处渲染一个显示该`Request`对象的视图。假设它`Request#response`仍然是空的，因为它还没有被处理，所以让用户知道它还在处理中。
2.  然后一个工人处理你的工作`ThirdPartyRequest`。`ThirdPartyRequest`然后应该获取`Request`对象并获取联系第三方服务所需的查询参数。它这样做然后得到一个请求。`Request`使用此请求更新对象，然后保存它。

    ```
    class ThirdPartyRequest
      def self.perform(request_id)
        request = Request.find(request_id)

        # contact third party service

        request.response = ...
        request.save
      end
    end 
    ```

3.  用户可以不断刷新他的页面以检查他/她的`Request`对象。一旦响应更新，他们就会知道它已完成。如果您希望页面自动刷新，请查看 faye/juggernaut/private_pub 或 Pusher 等 SaaS 解决方案。

# jsp - JDBC 安全领域 - GLASSFISH - NetBeans - 永远无法进行身份验证？为什么？

> ID：12064045
> 
> 赞同：1
> 
> 时间：2012-08-21T22:36:16.323
> 
> 标签：jsp, servlets, jdbc, glassfish, jdbcrealm

我尝试如下设置 JDBC Authentication Realm

1-我配置了一个JDBC连接池，命名为 **mysql_acme_rootPool**

2-通过单击 PING 测试上述池并成功。

3-然后我转到配置>>服务器配置>>安全>>领域并创建了一个名为 myRealm 的新领域

下面是一些配置截图

![在此处输入图像描述](../Images/d6b3f69f2efd647665fdc3cdbe52d447.png)

向下滚动后

![在此处输入图像描述](../Images/670f1e321c09fd9dc936fe87448560a2.png)

现在的问题是，即使我输入了正确的密码，我也会再次弹出登录屏幕，就好像我的密码无效一样。任何方式我都可以看到正在生成什么查询？如何缩小问题范围？它在我的 netbeans 配置中吗？或 web.xml ?? 在哪里 ？？

这是我的 web.xml 部分

```
 <security-constraint>
        <display-name>SecurePlace</display-name>
        <web-resource-collection>
            <web-resource-name>Secure Place</web-resource-name>
            <description>Description here</description>
            <url-pattern>/Secure/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <description>descrition here</description>
            <role-name>Regular-Group</role-name>
        </auth-constraint>
        <user-data-constraint>
            <description/>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name>myRealm</realm-name>
    </login-config>
    <security-role>
        <role-name>Regular-Group</role-name>
    </security-role> 
```

我正在使用 SSH 会不会导致问题？有什么建议么 ？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T12:36:23.190

首先，你的日志输出是什么？将安全日志级别更改为最好并共享输出。

现在快速思考：

*   您不能在 jdbcRealm 中为 Glassfish 提供规范化表。

你必须有一张桌子

```
"username" "pasword" "role" 
```

或两张桌子

```
"username" "password" 
```

和

```
"username" "role" 
```

并且两个表中的“用户名”列名称和内容必须相同

*   您是否以纯文本或 MD5 或 SHA-1 SHA-2 存储密码？记得指定正确的密码哈希方法。如您所见，默认值为 SHA-256

总而言之，对于正确的数据库连接和错误的通行证，它可能是“未经授权的错误”，也可能是某种配置错误，即“未找到登录模块”。我们需要日志详细信息。

# vim - Putty 中的 Vim 颜色方案一步一步的过程

> ID：12064047
> 
> 赞同：3
> 
> 时间：2012-08-21T22:36:21.980
> 
> 标签：vim, putty

我怎么能`Vim Color Schemes`进去`Putty`。我最近开始工作`Putty`，我在想有没有办法做到这一点？谁能提供我一步一步的过程如何做到这一点？我在互联网上看到了各种文章，但无法弄清楚一步一步的过程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:22:08.793

要在 PuTTY 中启用 256 色，请转到窗口->颜色->允许终端使用 xterm 256 色模式。当然，服务器也将`$TERM`设置为`xterm-256color`，您的 vim 将需要使用 256 色方案。

# google-places-api - 带图片的 Google Places API

> ID：12064050
> 
> 赞同：1
> 
> 时间：2012-08-21T22:36:47.353
> 
> 标签：google-places-api

当您访问 Google+ Local 并搜索餐厅时，您可以看到照片和用户评论。

请让这些 API 可用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:50:26.863

**编辑：** Places API 现在支持返回一张地方照片（如果可用于[地方搜索请求](https://developers.google.com/places/documentation/search)）和最多十张地方照片用于[地方详情请求](https://developers.google.com/places/documentation/details)。

如果您的请求返回了照片数组，您可以将`photo_reference`包含的照片对象中的和/或,和参数传递给[放置照片请求：](https://developers.google.com/places/documentation/photos)`maxheight``maxwidth``sensor``key`

```
https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=CnRvAAAAwMpdHeWlXl-lH0vp7lez4znKPIWSWvgvZFISdKx45AwJVP1Qp37YOrH7sqHMJ8C-vBDC546decipPHchJhHZL94RcTUfPa1jWzo-rSHaTlbNtjh-N68RkcToUCuY9v2HNpo5mziqkir37WU8FJEqVBIQ4k938TI3e7bf8xq-uwDZcxoUbO_ZJzPxremiQurAYzCTwRhE_V0&sensor=false&key=AddYourOwnKeyHere 
```

有关详细信息，请参阅[文档。](https://developers.google.com/places/documentation/photos)

# android - 带有 proguard 的 Android ant build.xml 未在发行版中构建

> ID：12064052
> 
> 赞同：4
> 
> 时间：2012-08-21T22:37:05.353
> 
> 标签：android, ant, build, release, proguard

我有以下项目设置： 两个库“commoncomponents”和“libs”都定义了一些活动，例如使用 webview 和对话框助手类。然后是我的“应用程序库”，其中包含应用程序代码，而应用程序“免费”和“完整”应用程序又引用了该代码。

我使用以下附加条目启用了 proguard

```
-keepclassmembers class **.R$* {
    public static <fields>;
} 
```

但是，使用发布目标启动 ant 时构建过程失败，并且 proguard 抱怨缺少 R$string 类

如果我在“commoncomponents”、“libs”或“应用程序库”项目上调用“ant release”，proguard 会成功，但是当我在“app free”或“app full”上启动它时，会出现以下错误消息：

```
 [echo] ----------
     [echo] Creating output directories if needed...
    [mkdir] Created dir: ~/Workspace/Workspaces/workspace-indigo/MyApp/bin/classes
     [echo] ----------
     [echo] Resolving Dependencies for bin...
[dependency] Library dependencies:
[dependency] ------------------
[dependency] Ordered libraries:
[dependency] ------------------
[dependency] API<=15: Adding annotations.jar to the classpath.
-pre-build:
-code-gen:
[mergemanifest] No changes in the AndroidManifest files.
     [echo] Handling aidl files...
     [aidl] Found 2 AIDL files.
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] No RenderScript files to compile.
     [echo] ----------
     [echo] Handling Resources...
     [aapt] No changed resources. R.java and Manifest.java untouched.
     [echo] ----------
     [echo] Handling BuildConfig class...
[buildconfig] Build type changed: Generating new BuildConfig class.
-pre-compile:
-compile:
    [javac] Compiling 12 source files to ~/Workspace/Workspaces/workspace-indigo/MyApp/bin/classes
     [echo] Creating library output jar file...
      [jar] Building jar: ~/Workspace/Workspaces/workspace-indigo/MyApp/bin/classes.jar
-post-compile:
-obfuscate:
   [delete] Deleting: ~/Workspace/Workspaces/workspace-indigo/MyApp/bin/proguard/original.jar
      [jar] Building jar: ~/Workspace/Workspaces/workspace-indigo/MyApp/bin/proguard/original.jar
 [proguard] ProGuard, version 4.7
 [proguard] Reading input...
 [proguard] Reading program jar [~/Workspace/Workspaces/workspace-indigo/MyApp/bin/proguard/original.jar]
 [proguard] Reading program jar [~/Workspace/Workspaces/workspace-indigo/CommonComponents/bin/classes.jar]
 [proguard] Reading program jar [~/Workspace/Workspaces/workspace-indigo/exampleLib/bin/classes.jar]
 [proguard] Reading program jar [~/Workspace/Workspaces/workspace-indigo/Bfw/bin/classes.jar]
 [proguard] Reading program jar [/Developer/Java/android-sdk-macosx/tools/support/annotations.jar]
 [proguard] Reading program jar [~/Workspace/Workspaces/workspace-indigo/MyApp/libs/android-support-v4.jar]
 [proguard] Reading library jar [/Developer/Java/android-sdk-macosx/platforms/android-10/android.jar]
 [proguard] Reading library jar [/Developer/Java/android-sdk-macosx/add-ons/addon-real3d-lge-10/libs/real3d.jar]
 [proguard] Initializing...
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R$string
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R$string
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R$string
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R$string
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R$string
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R$string
 [proguard] Warning: com.example.ApplicationBase: can't find referenced class com.example.lib.R
 [proguard] Warning: com.example.common.HelpDialog: can't find referenced class com.example.common.R$string
 [proguard] Warning: com.example.common.HelpDialog: can't find referenced class com.example.common.R$string
 [proguard] Warning: com.example.common.HelpDialog: can't find referenced class com.example.common.R
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R$layout
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R$id
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R$string
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R$layout
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R$id
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R$string
 [proguard] Warning: com.example.common.WebDialog: can't find referenced class com.example.common.R
 [proguard] Warning: com.example.common.WebDialog$1: can't find referenced class com.example.common.R$string
 [proguard] Warning: com.example.common.WebDialog$1: can't find referenced class com.example.common.R$string
 [proguard] Warning: com.example.common.WebDialog$1: can't find referenced class com.example.common.R
 [proguard] Warning: com.example.dlg.InfoDialogActivity: can't find referenced class com.example.lib.R$layout
 [proguard] Warning: com.example.dlg.InfoDialogActivity: can't find referenced class com.example.lib.R$layout
 [proguard] Warning: com.example.dlg.InfoDialogActivity: can't find referenced class com.example.lib.R
 [proguard] Note: the configuration refers to the unknown class 'com.google.vending.licensing.ILicensingService'
 [proguard] Note: the configuration refers to the unknown class 'com.android.vending.licensing.ILicensingService'
 [proguard] Note: there were 2 references to unknown classes.
 [proguard]       You should check your configuration for typos.
 [proguard] Warning: there were 23 unresolved references to classes or interfaces.
 [proguard]          You may need to specify additional library jars (using '-libraryjars').

BUILD FAILED
/Developer/Java/android-sdk-macosx/tools/ant/build.xml:570: The following error occurred while executing this line:
/Developer/Java/android-sdk-macosx/tools/ant/build.xml:834: Please correct the above warnings first. 
```

项目设置对我来说似乎没问题，因为“ant debug”编译时没有错误。包名称更改为 com.example ，我的用户目录更改为 ~/xy 在上面的列表中

我已经在网上搜索了这个问题，我发现了很多帖子，尤其是在 stackoverflow 上，但没有一个帮助我解决这个问题，希望有人能提供帮助，尽管这是我的第一个问题。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T06:39:05.417

事实证明，应用程序库构建文件打开了 proguard 混淆，通过将其关闭，在构建免费和完整的应用程序存根时找到了所有符号。

# boost - boost::number::ublas 中的项目和子范围函数有什么区别？

> ID：12064054
> 
> 赞同：0
> 
> 时间：2012-08-21T22:37:30.587
> 
> 标签：boost, project, numeric, ublas

即，两者之间有什么区别

```
subrange(V, 0, 3); 
```

和

```
project(V, range(0,3)); 
```

?

我问是因为我正在研究一些似乎同时使用两种形式的代码（一种与另一种没有明显的押韵/原因），但我看不出两者之间有任何区别......只是想检查一下确保我没有遗漏任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:35:42.693

Looked into it, and I've confirmed there is no difference - subrange is simply an easy wrapper for a common-case of project, and in these cases:

```
subrange(V, 0, 3);
project(V, range(0,3)); 
```

...they end up identical. So using either should be fine, as long as you're consistent!

For the more curious... subrange does:

```
template<class V>
vector_range<V> subrange (V &data, typename V::size_type start, typename V::size_type stop) {
        typedef basic_range<typename V::size_type, typename V::difference_type> range_type;
        return vector_range<V> (data, range_type (start, stop));
    } 
```

while project does:

```
template<class V>
vector_range<V> project (V &data, typename vector_range<V>::range_type const &r) {
    return vector_range<V> (data, r);
} 
```

..and since vector_range::range_type is defined to be

```
typedef basic_range<size_type, difference_type> range_type; 
```

...ie, exactly what is used in subrange, the two forms are identical.

# jboss - 多台机器上的 Jboss ESB 服务

> ID：12064056
> 
> 赞同：0
> 
> 时间：2012-08-21T22:37:40.607
> 
> 标签：jboss, jms, soa, esb

我对 jboss esb 很陌生，正在尝试学习和配置一个新的启动项目。

该项目处理使用 ESB 作为主干和多个连接到它的 Intg 应用程序。

我已经浏览了提供的每个示例，并且能够达到一定的水平，但对其他一些东西几乎没有困惑。

1）使用 ESB 托管在 machine1（消费者）上并处理此消息（它有效）。

2) 现在发送者和 ESB 消费者在两台不同的机器上。发件人无法定位/加载 esb 消费者。

我相信你可能有足够的经验来解决这个问题，所以你知道我该如何解决这个问题。

您可以通过 hitjain_83@hotmail.com 与我联系

您的帮助将不胜感激！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T13:05:11.490

这可能会有所帮助：

[https://community.jboss.org/thread/146623](https://community.jboss.org/thread/146623)

# css - 动画 div 问题中的链接

> ID：12064063
> 
> 赞同：0
> 
> 时间：2012-08-21T22:38:49.067
> 
> 标签：css, html, animation

出于某种原因，我无法单击动画 div 中的链接。它们是一些四处移动的云。

html:

```
<div class="container">
  <div id="clouds">
    <div class="cloud1"><a href="/pages/porfolio.html"><img src="../images/cloud_portfolio.png"/></a></div>
    <div class="cloud2"><img src="../images/clouds_customer.png"/></div>
  </div>
</div> 
```

CSS：

```
.container {
  width: 1100px;
  position: absolute;
  top: 80px;
  height: 200px;
  overflow: hidden;
  margin: 0 auto;
  z-index:1;
}
#clouds {
  top: 50px;
  position: relative;
  -webkit-animation: move 40s infinite linear;  
  -moz-animation: move 40s infinite linear;  
  -ms-animation: move 40s infinite linear;
  z-index: 2;

}
#clouds a{
  cursor:pointer;
    text-decoration: none;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T22:49:34.420

我从未使用过 CSS 动画，但您是否可以将图像移动到另一个元素下，从而使链接无法点击？您是否在每个浏览器中都看到了这一点，并且删除动画真的有影响吗？

# c# - C# 检测是否有 Iphone 插件

> ID：12064064
> 
> 赞同：2
> 
> 时间：2012-08-21T22:38:55.167
> 
> 标签：c#, iphone, windows, detect

我正在开发 VS2010/C#.. 谁能帮我弄清楚如何检测 Iphone 何时插入？

我试过这个

```
System.IO.DriveInfo[] drives = System.IO.DriveInfo.GetDrives();
        try
        {

            foreach (System.IO.DriveInfo drive in drives)
            {
                if (drive.DriveType == DriveType.Removable)
                {
                    do something
                }
            } 
```

但是 DriveType.Removable 不包括 Iphone 设备，似乎 Iphone 是“内部存储”而不是可移动设备......

谢谢大家的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T08:49:09.210

也许这会帮助你
[http://blogs.technet.com/b/heyscriptingguy/archive/2005/03/15/how-can-i-determine-which-usb-devices-are-connected-to-a-computer .aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2005/03/15/how-can-i-determine-which-usb-devices-are-connected-to-a-computer.aspx)

# tsqlt - tSQLt AssertEqualsTable 对 Geography 数据类型的支持

> ID：12064066
> 
> 赞同：1
> 
> 时间：2012-08-21T22:39:10.377
> 
> 标签：tsqlt

当我创建两个包含地理列并使用 tSQlt.AssertEqualsTable 的表时，测试失败并显示：

> 失败：数据类型的运算符无效。运算符等于等于，类型等于地理。{,1}

有谁知道 tSQLt 是否支持用于表比较的地理数据类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-20T16:34:03.820

tSQLt 已经更新为包含不兼容数据类型的更详细的错误消息。如果您使用其中一种不兼容的数据类型，您应该会看到以下消息：

```
(Error) The table contains a datatype that is not supported for 
tSQLt.AssertEqualsTable. Please refer to http://tsqlt.org/user-
guide/assertions/assertequalstable/ for a list of unsupported datatypes. 
```

不兼容类型的列表是：

*   XML
*   文本
*   文本
*   图片
*   地理
*   几何学
*   行版本
*   任何未标记为 Comparable 和 Byte Ordered 的 CLR 数据类型

但是，几乎总是有解决方法。您可以在比较之前将该值转换为兼容的数据类型，如下例所示：

```
EXEC tSQLt.NewTestClass 'DeliveryTests';
GO

CREATE PROCEDURE DeliveryTests.[test Order is matched to Customer location]
AS
BEGIN
  EXEC tSQLt.FakeTable 'Sales.Customers';
  EXEC tSQLt.FakeTable 'Sales.Orders';

  INSERT INTO Sales.Customers (CustomerId, Location) 
       VALUES (1, geography::Point(47.65100, -122.34900, 4326));
  INSERT INTO Sales.Orders (OrderId, CustomerId) 
    VALUES (5, 1);

  SELECT OrderId, Location.ToString() AS Location
    INTO DeliveryTests.Actual
    FROM Delivery.OrderDestinations;

  SELECT TOP(0) *
    INTO DeliveryTests.Expected
    FROM DeliveryTests.Actual;

  INSERT INTO DeliveryTests.Expected (OrderId, Location) 
     VALUES (5, geography::Point(47.65100, -122.34900, 4326).ToString());

  EXEC tSQLt.AssertEqualsTable 'DeliveryTests.Expected', 
                               'DeliveryTests.Actual';
END;
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T07:58:15.367

它目前不受支持，但将包含在下一个/未来版本中。

# ruby-on-rails - Rails - Accepts_nested_attributes_for 批量分配错误

> ID：12064068
> 
> 赞同：3
> 
> 时间：2012-08-21T22:39:12.217
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mass-assignment

我目前正在尝试在 belongs_to 关系上设置一个包含嵌套字段的表单，但我遇到了批量分配错误。到目前为止，我的代码如下（删除了一些 html）：

销售型号：

```
class Sale < ActiveRecord::Base
  attr_accessible :customer_attributes
  belongs_to :customer
  accepts_nested_attributes_for :customer
end 
```

新的.html.erb：

```
<div class="container">
  <%= form_for :sale, :url => sales_path do |sale| -%>
    <%= sale.fields_for :customer do |customer_builder| %>
      <%= render :partial => "customers/form", :locals => {:customer => customer_builder, :form_actions_visible => false} %>
    <% end -%>
  <% end -%> 
```

客户/_form.html.erb

```
<fieldset>
  <label class="control-label">Customer Type</label>
  <%= collection_select(:customer, :customer_type_id, CustomerType.all, :id, :value, {}, {:class => "chzn-select"}) %>
</fieldset> 
```

我相信这应该允许我创建一个 Sale 对象和一个嵌套的 Customer 对象。发送的参数是（注意一些不相关的参数包括在内）：

```
{"utf8"=>"✓",
"authenticity_token"=>"qCjHoU9lO8VS060dXFHak+OMoE/GkTMZckO0c5SZLUU=",
"customer"=>{"customer_type_id"=>"1"},
"sale"=>{"customer"=>{"features_attributes"=>{"feature_type_id"=>"1",
"value"=>"jimmy"}}},
"vehicle"=>{"trim_id"=>"1",
"model_year_id"=>"1"}} 
```

我得到的错误是：

```
Can't mass-assign protected attributes: customer 
```

我明白为什么会出现这种情况，因为 :customer 不在销售的 attr_accessible 列表中——尽管表单不应该发送 customer_attributes 而不是 customer？

任何帮助/建议表示赞赏。

编辑 1：据我所知，销售模型中的 attr_accessible 应该包含 :customer_attributes - 如果有人说不同，请告诉我。

编辑 2：我尝试了各种排列，但我似乎无法获得参数来发送 customer_attributes 而不是简单的客户 - 也许我错过了一个标签或在上面的表格中某处使用了不正确的标签？

编辑 3：我在 SO 上发现了另一个问题，表明`:url =>`form_for 标记上的部分存在问题 - 该问题指的是 formtastic 设置，但我想知道这是否是导致问题的原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T22:44:18.697

这可能是问题......来自API docs：

> **与 attr_accessible 一起使用**
> 
> 如果您不小心，使用 attr_accessible 可能会干扰嵌套属性。例如，如果上面的 Member 模型像这样使用 attr_accessible：
> 
> `attr_accessible :name`
> 
> 您需要将其修改为如下所示：
> 
> `attr_accessible :name, :posts_attributes`

[http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#label-Using+with+attr_accessible](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#label-Using+with+attr_accessible)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T09:42:12.227

我最终在这里得到了答案。关键是这一行：

```
<%= collection_select(:customer, :customer_type_id, CustomerType.all, :id, :value, {}, {:class => "chzn-select"}) %> 
```

需要更改为：

```
<%= customer.collection_select(:customer_type_id, CustomerType.all, :id, :value, {}, {:class => "chzn-select"}) %> 
```

一旦改变了这一点，一切就都到位了。

# excel - 如何将按钮用作 spinButton

> ID：12064071
> 
> 赞同：0
> 
> 时间：2012-08-21T22:40:11.237
> 
> 标签：excel, vba

```
Private Sub spin01_Change()
lab01.Caption = spin01.Value 
```

如果我一直按旋转按钮，标签会以非常高的速度继续变化。
是否可以通过单击常见按钮来创建相同的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:10:27.153

您可以尝试将 SpinButton 的 Delay 属性设置为 1000 之类的值。这似乎有效地将其更改为一次单击一次控件。

# c# - 如何在 C# 中从包含 XML 的字符串中读取数据？

> ID：12064075
> 
> 赞同：1
> 
> 时间：2012-08-21T22:40:22.380
> 
> 标签：c#, xml, visual-studio-2010, xml-parsing

我在这个问题上找到了很多答案，但他们都试图先将字符串转换为文件，然后尝试使用解析它`XmlDocument doc = new XmlDocument();`

我是新手`c#`。我的字符串格式是：

```
<a header = '0'> < row dc = '123' al = '45' msg = '1-st line'/> < row dc = '678' al = '8' msg = 'second-line'/> </a> 
```

我正在尝试编写伪代码来解析它：

```
IF <a header> == 0
Then read from the second line to last line i.e. dc = 678 , al = 8, msg = second-line
ELSE read from the first line to last line i.e.  
  dc = 123 , al = 45, msg = 1-st line
 dc = 678 , al = 8, msg = second-line 
```

在此之后我必须插入数据库。在应用上述条件时，什么是合适的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T22:56:27.540

您不必保存到文件来解析 XML。

```
var xml = "<a header='0'> <row dc='123' al='45' msg='1-st line'/> <row dc='678' al='8' msg='second-line'/> </a>";
var doc = XElement.Parse(xml);
var list = from x in doc.Descendants("row")
            select new 
            {
                dc = (int)x.Attribute("dc"),
                al = (int)x.Attribute("al"),
                msg = (string)x.Attribute("msg")
            }; 
```

这个简单的示例将为您提供一个匿名对象列表，然后您可以轻松地将其插入数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T22:57:58.147

入门代码：

```
 XmlNode xmlNode = doc.SelectNode("/a");
   int value = xmlNode.Attributes["header"].Value;
   XmlNodes xmlNodes = xmlNode.SelectNodes("./row");
   foreach (XmlNode rowNode in XmlNodes) 
```

# javascript - Ember.js - 模型 find() 方法中的异步调用

> ID：12064076
> 
> 赞同：6
> 
> 时间：2012-08-21T22:40:24.250
> 
> 标签：javascript, ember.js

我已经在我的属性模型上实现`find()`和方法。`findAll()`这两种方法都对 API 进行异步调用。 `findAll()`在连接我的家庭路线的插座时被调用，并且工作正常。 `find()`在连接我的属性路由的插座时由 Ember.js 调用。请注意，`find()`在通过操作导航到属性路由时不会调用，但是当您通过 URL 直接转到路由时会调用。

这是我的路由器：

```
App.Router = Ember.Router.extend({
    root: Ember.Route.extend({
        showProperty: Ember.Route.transitionTo('property'),
        home: Ember.Route.extend({
            route: '/',
            connectOutlets: function(router) {
                router.get('applicationController').connectOutlet('home', App.Property.findAll());
            }        
        }),
        property: Ember.Route.extend({
            route: '/property/:property_id',
            connectOutlets: function(router, property) {
                router.get('applicationController').connectOutlet('property', property);
            }
        }),
    })
}); 
```

这是我的`findAll()`和`find()`方法：

```
App.Property.reopenClass({
    find: function(id) {
        var property = {};
        $.getJSON('/api/v1/property/' + id, function(data) {
            property = App.Property.create(data.property);
        });
        return property;
    },
    findAll: function() {
        var properties = [];
        $.getJSON('/api/v1/properties', function(data) {
            data.properties.forEach(function(item) {
                properties.pushObject(App.Property.create(item));
            });
        });
        return properties;
    }
}); 
```

例如，当我转到 index 以外`http://app.tld/#/property/1`的路线时，路线会被重写为`http://app.tld/#/property/undefined`. 没有任何东西被传递给`content`属性控制器的属性。如何在`find()`方法中进行异步调用？除非我弄错了，否则异步调用在`findAll()`方法中可以正常工作，这是我困惑的根源。

这个问题类似于[Deserialize with an async callback](https://stackoverflow.com/questions/11244938/deserialize-with-an-async-callback)，但我使用的是该`find()`方法而不是覆盖该`deserialize()`方法。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-08T05:21:23.513

I found that setting the `id` property explicitly solves this problem. In your case this would look like this.

```
find: function(id) {
  var user = App.User.create();

  $.getJSON('/api/v1/property/' + id, function(data) {
    user.setProperties(data.user)
  });

  user.set("id",id); // <-- THIS

  return user;
} 
```

Once your `user` gets its properties set the view updates as normal. Ember just need the `id` part before in order to update the URL.

Hope this helps :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T16:05:40.090

这就是你想做的事情。我将模型更改为 User 以使事情更清晰。

在 的情况下`find()`，您返回一个空白模型实例，该实例在 AJAX 请求返回时填充其属性。Ember 数据绑定的好处是您可以立即在视图中显示此模型，并且当 AJAX 请求返回并更新模型实例时，视图将更新。

在 的情况下`findAll()`，您返回一个空白数组，当 AJAX 请求返回时填充该数组。与 一样`find()`，您可以在视图中显示此模型列表（最初为空白），当 AJAX 请求返回并填充数组时，视图将更新。

```
App.User.reopenClass({

  find: function(id) {
    var user = App.User.create();

    $.getJSON('/api/v1/property/' + id, function(data) {
      user.setProperties(data.user)
    });

    return user;
  },

  findAll: function() {
    var userList = [];

    $.getJSON('/api/v1/properties', function(data) {
      var users = data.users.map(function(userData) {
        return App.User.create(userData);
      });
      userList.pushObjects(users);
    });

    return userList;
  }

}); 
```

# asp.net-mvc-3 - Orchard cms - 用户在另一个数据库中的自定义登录模块

> ID：12064079
> 
> 赞同：3
> 
> 时间：2012-08-21T22:40:53.683
> 
> 标签：asp.net-mvc-3, content-management-system, orchardcms, custom-membershipprovider

我正在为我的雇主评估果园 cms，只是想问一个有关登录和会员资格的问题。

我们的用户和他们的角色在另一个通过 API 公开的数据库中，如果可以在果园解决这个问题，我需要指出正确的方向。

用户必须能够登录果园网站，并且会根据他们的角色显示不同的内容。管理员和编辑将使用内置用户 db。

解决这个问题的正确方法是什么？某种模块或自定义会员提供者？

此外，是否可以根据来自其他外部数据库的角色在果园管理员中为内容设置可见性规则？

如果您发现我的问题中的某些内容令人困惑，请务必询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:21:10.747

果园画廊中没有那么多模块，但一直在玩一些，所以我现在回答我的问题，希望它可以帮助其他希望建立自己的自定义登录的人。

对我帮助最大的一个是 Windows 身份验证模块，它很容易重写以针对外部服务工作。

编辑：错字

# magento - Magento 搜索布局损坏

> ID：12064080
> 
> 赞同：0
> 
> 时间：2012-08-21T22:40:55.417
> 
> 标签：magento, search, layout

在我的商店中搜索产品时出现此错误：

致命错误：在 /var/www/vhosts/pipetto.co.uk/httpdocs/app/design/frontend/default/pipetto/template/catalog/product/list 中的非对象上调用成员函数 getIsAnchor()。第 41 行的 phtml

[http://www.pipetto.co.uk/catalogsearch/result/?q=iphone](http://www.pipetto.co.uk/catalogsearch/result/?q=iphone)

我认为 list.phtml 没有指向正确的块。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:48:28.993

所以我认为您已经对模板文件进行了一些更改。其中一些要求用户在类别列表页面上。

getIsAchor() 必须从一个对象调用，特别是一个类别对象......

但当然 list.phtml 模板也用于搜索结果页面，在这里您没有访问任何类别对象的权限（我认为是 Mage::registry('current_category')）。

所以只需设置一个条件：

```
if(!is_null(Mage::registry('current_category'))) 
```

快速解决，但我认为这更像是一个概念问题。

真挚地，

乔纳森

# c - 检查给定的字符串序列是回文还是不使用堆栈

> ID：12064082
> 
> 赞同：0
> 
> 时间：2012-08-21T22:40:58.680
> 
> 标签：c, palindrome, stack

我想知道如何存储从堆栈中弹出要存储的字符或整数，以便我可以将它与原始字符串或 int 值进行比较。

例如 ：

```
n = 1221;
n = n / 1000; // so that i get the last digit in this case 1 and dividing the remainder 
              // further each time by 100, 10 and 1 
```

如果我将得到的每个数字存储在一个变量中——例如，假设我将从上述除法得到的 1 存储在一个名为 s 的变量中，然后将其压入堆栈。在此之后，我将值弹出；当我这样做时，如何检查天气是否等于原始数字？我可以用 if 条件检查它，例如如果我有 3 个

```
(i == p && check for other two numbers) 
```

但我不想检查任何尺码。

请不要发送有关如何执行此操作的源代码，只需给我一些片段或一些提示，谢谢。另外请让我知道您是如何提出解决方案的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T22:49:44.257

> 不要发送有关如何操作的源代码

好的 ;）

> 给我一些片段或提示

*[递归](https://stackoverflow.com/questions/12064082/to-check-wether-a-given-string-seqence-is-palindrome-or-not-using-stacks)*

> 当你给出解决方案时，让我知道你是如何提出解决方案的，当你​​看到问题时，你已经看过这样的程序或知道算法或想出了解决方案。谢谢

我做这个太久了，不记得我第一次看到它的地方=\

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:38:52.723

您可以使用递归来解决问题，就像 Justin 提到的那样。开始递归后，您将用适当的除数除数（1000,100,10,1），将商存储在堆栈中。你这样做到最后。到达“单位”位置后，存储单位数字，然后开始从堆栈中弹出。有一个 if-else 阶梯从递归函数返回一个整数。梯子会有左移后返回int和返回移位后的变量的条件。您可以在主要功能中进行检查。

```
1             ->1221(left shift 122 OR with 1)
  2          ->122(left shift 12 OR with 2)
    2       ->12(left shift 1 OR with 2)
      1---->1 
```

希望这可以帮助。谢谢阿迪亚

# python - Web2py - 尝试从没有“for”语句的行对象中获取值

> ID：12064086
> 
> 赞同：2
> 
> 时间：2012-08-21T22:41:00.170
> 
> 标签：python, web2py

我正在尝试编辑用户的组成员身份，我的控制器中有：

```
def change_membership():

if request.vars.id:

    row = db(db.auth_membership.user_id == request.vars.id).select()
    id = row[0].id  
    form = SQLFORM(db.auth_membership,
                               id,
                               fields=['group_id'],
                               _action=URL()
                               )
if form.process().accepted:
    ...redirect back to user list

if form.errors:
    response.flash = 'form has errors'

return dict(form=form) 
```

但它不起作用，我得到一个 : list index out of range

我知道只有一排，但我不明白为什么它看起来是空的..

在此先感谢
基督教

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T17:10:02.953

优秀的！

非常感谢安东尼和马西莫。

它节省了我的时间，现在一切都在使用 request.get_vars.id 而不是 request.vars.id

参考：

2012/8/22 安东尼写道：是的。注意，web2py 将 GET 变量存储在 request.get_vars 中，将 POST 变量存储在 request.post_vars 中。它将 GET 和 POST 变量存储在 request.vars 中。如果 get_vars 和 post_vars 都有同名的变量，它会将它们的值放在 request.vars 中的列表中。只需将您的代码更改为使用 request.get_vars.id 而不是 request.vars.id。

2012/8/22 Massimo Di Pierro 写道: 你有两个 id 字段。request.get_vars.id 中的一个（来自 url）和 request.post_vars.id 中的一个（来自表单提交）。

# vb.net - VB 从集合中挑选出一个图片框

> ID：12064089
> 
> 赞同：0
> 
> 时间：2012-08-21T22:41:16.383
> 
> 标签：vb.net, collections, picturebox

我正在尝试从集合中的图片框中获取信息。例如，我在一个集合中有 100 个图片框，当我单击一个时，它会加载一个包含所有信息的新表单（它是什么图像，大小等）。我将如何做到这一点？甚至可以在集合中执行此操作吗？

编辑：我正在尝试制作一个为视频游戏构建地图的程序（如 NES 版本的塞尔达传说）。所以这些图片框将成为游戏中所有图块的概述。所以我想要做的是当你点击图片框时，我想要一个新的表单打开，这样艺术家就可以编辑这个图块的内容。我已经完成了编辑部分，但是如果没有 100 个点击事件（我不想这样做），我就无法从一种形式转到另一种形式。有人知道吗？

谢谢！利亚姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:15:05.537

如果您使用`System.Collections.Dictionary(Of String, PictureBox)`or `System.Collections.Dictionary(Of Integer, PictureBox)`并跟踪您要添加的图片框的名称或编号，您可以执行以下操作

```
Console.WriteLine myPictureBoxCollection["pictureBoxName"].Width 
```

或者

```
For Each pBox As PictureBox in myPictureBoxCollection
   Console.WriteLine pBox.Width
Next pBox 
```

这假设您已执行以下操作以将 PictureBoxed 添加到集合中：

```
Dim myPictureBoxCollection As System.Collections.Dictionary(Of String, PictureBox)
myPictureBoxCollection.Add(PictureBox.Name, PictureBox) 
```

# sql - 在 SQL Server 中删除重复项

> ID：12064091
> 
> 赞同：2
> 
> 时间：2012-08-21T22:41:27.587
> 
> 标签：sql, sql-server

> **可能重复：**
> [SQL - 如何删除重复行？](https://stackoverflow.com/questions/18932/sql-how-can-i-remove-duplicate-rows)

我有一个结构如下的表：

```
create table MnA
(id         int PRIMARY KEY IDENTITY    not null,
symbol      nvarchar(4)                 not null,
direction   nvarchar(4)                 not null,
start_dt    nvarchar(5)                 not null,
end_dt      nvarchar(5)                 not null,
start_doy   int                         not null,
end_doy     int                         not null,
avg_price   int                         not null,
min_price   int                         not null,
max_price   int                         not null,
avg_percent int                         not null,
min_percent int                         not null,
max_percent int                         not null,
history     text                        not null,
percent_hit int                         not null,
aw_length   int                         not null,
diff        int                         not null,
date_change int                         not null) 
```

我想删除有相似之处的行。

如果该行相同`symbol, direction, start_doy`，`diff`那么我想保留最高的那一行`avg_percent`。

我将如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T22:47:17.113

```
DELETE target 
FROM MnA target INNER JOIN MnA temp 
     ON (target.symbol = temp.symbol 
         AND target.direction = temp.symbol
         AND target.start_doy = temp.start_doy
         AND target.diff = temp.diff
         AND target.id != temp.id 
         AND temp.avg_percent > target.avg_percent); 
```

**[演示](http://sqlfiddle.com/#!3/e4cc5/1)**（sqlfiddle）。

# ruby-on-rails - ruby on rails 如何使用 FormOptionHelpers 创建动态下拉列表

> ID：12064092
> 
> 赞同：0
> 
> 时间：2012-08-21T22:41:27.227
> 
> 标签：ruby-on-rails, ruby

我检查了一些教程，但我对此方法中的参数感到困惑

collection_select（对象、属性、集合、value_method、text_method、options = {}、html_options ={}）

我有一个地图模型包括：：区域，：系统，：文件

我想从数据库中读取**:area**到下拉列表，然后让用户选择一个

我已经在视图中做了@map = Map.all

方法应该是什么？

特别是参数“属性”。在很多教程中，人们把“id”放在这里。但我不知道“id”是什么，在我的情况下，我不需要任何其他值，只需要“区域”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:37:04.953

从您的问题中不清楚该区域所填充的模型是什么。

通常，collection_select 用于相关模型之间。

例如。

```
class Category < ActiveRecord::Base
  has_many :products
end

class Product < ActiveRecord::Base
  belongs_to :category
end 
```

为产品选择“类别”时，您的视图将具有以下内容：

```
<%= f.collection_select(:category_id, :id, Category.all, :name, include_blank: true) %> 
```

这样做是将 Product.category_id 指定为使用 Category.id 值填充的属性。这些值来自 Category.all 集合，并且 Category.name 是选择中显示的项目。最后一个（可选）参数表示包含一个空白条目。

您可能需要以下内容：

```
<%= f.collection_select(:map_id, :id, @map, :area) %> 
```

但是，如果您尝试填充的模型具有区域属性（而不是链接到地图的 ID），您可能需要使用：

```
<%= f.collection_select(:area, :area, @map, :area) %> 
```

这指定接收表的 area 属性将填充 Map 的 area 属性，该属性也用作 select 中的“描述”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:09:07.140

我不完全确定你在这里问什么，但如果你试图在 html 表单中使用下拉选择，这个例子对你有帮助吗？

```
<% nations = {'United States of America' => 'USA', 'Canada' => 'Canada', 'Mexico' => 'Mexico', 'United Kingdom'=> 'UK'} %>
<% list = nations.sort %>
<%= f.select :country, list, %> 
```

这里的国家是国家/地区的哈希，然后列表成为该哈希的排序副本。然后创建一个 html 下拉列表作为“f”表单的一部分。":country" 是模型中连接数据的部分，而 list 是填充下拉列表的选项

# php - PHP 从包含 HTML 标签的 ANSI 编码 CSV 生成 UTF-8 XML

> ID：12064094
> 
> 赞同：0
> 
> 时间：2012-08-21T22:42:01.280
> 
> 标签：php, xml, csv

我有一个 csv 文件，我想将其转换为 xml，但 CSV 被编码为 ANSI，当生成 xml 文件时，所有特殊的字符都像：áéőúűóüöí 看起来像这样：Ã³ ÃzÅ±

还有一些 html 标签会弄乱整个 XML。我尝试添加strip_tags，但没有用现在我在产品之间有空节点，HTML代码遍布XML而不是节点之间哦，由于CSV我不得不放一个array_pop（）来删除额外的每行末尾的分号。

我的 CSV 看起来像这样：

```
title;seller_product_id;status;price;discount_price;warranty;manufacturer;weight;category;disable_shipping;photo_url_1;photo_url_2;photo_url_3;photo_url_4;seller_category;video_link;isbn13;gtin;product_code;warehouse_code;page_link;availability_237;shipping_fee_4_1;shipping_fee_4_2;description;
"tea csipkebogyó ízű 20*1,5g..";"5999881069013";1;"121";;1;;"60";8510;0;"http://mydomain/00003125_mid.jpg";"http://mydomain/00001634_mid.jpg";;;"Élelmiszer; Tea";;;;"5999881069013";"000000019231";" http://mydomain/producturl";"1744";;;<table width="975" cellspacing="0" cellpadding="0"><tbody><tr><td height="151" valign="top" style="background: url('http://mydomain/vlshop.PNG') no-repeat" colspan="2"></td></tr><tr><td style="font-family: Arial,Helvetica,sans-serif" colspan="2"><div style="text-align: justify"><div style="text-align: center"><span style="color: rgb(255, 0, 0)"><span style="font-size: large"><strong>Több termék vásárlása esetén használja a kosaras vásárlást!</strong></span></span></div><span style="color: rgb(255, 0, 0)"><span style="font-size: medium"><strong><br /><br />tea csipkebogyó ízű 20*1,5g..<br /><br />Cikkszám: 000000019231<br /><br />STAMFORD tea csipkebogyó ízű 20*1,5g..<br /><br />Csak új és garanciális termékeket árusítunk!<br />Csere és beszámítás nem lehetséges!<br /><br /><span style="font-size: large">Szállítási és fizetési információk:<br /></span><br />Lehetőség van a termékeket személyesen is átvenni:<br />- Munkanapokon 8-16 óráig: Szada, (Pest Megye)! </strong></span></span><span style="color: rgb(255, 0, 0)"><span style="font-size: medium"><strong><br /><br />Legalacsonyabb szállítás díjunk 660 Ft, ajánlott postázásra nincs lehetőség!<br /><br />Futárszolgálati díjaink előreutalás esetén:<br />- 0kg-2kg: 660 Ft<br />- 2kg-5kg: 800 Ft<br />- 5kg-30kg: 1200 Ft<br />- Utánvét +:  150 Ft<br /><br />A reggel 8 óráig beérkezett rendeléseket tudjuk aznap feldolgozni!<br />A fizetéssel és az átvétellel kapcsolatos igényeit kérjük tüntesse fel a megjegyzés rovatban!<br /><br /><br /></strong></span></span></div></td></tr></tbody></table>; 
```

我正在使用它来创建 XML：

```
<?php

error_reporting(E_ALL ^ E_NOTICE);
ini_set("display_errors", true);
function csv2xml($file, $container = 'data', $rows = 'row')
{
$r = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n";
$r .= "<{$container}>\n";
$row = 0;
$cols = 0;
$titles = array();
$handle = @fopen($file, 'r');
if (!$handle) return $handle;
while (($data = fgetcsv($handle, 1000, ';')) !== FALSE)
{
array_pop($data);
if ($row > 0) $r .= "\t<{$rows}>\n";
if (!$cols) $cols = count($data);
for ($i = 0; $i < $cols; $i++)
{
if ($row == 0)
{
$titles[$i] = $data[$i];
continue;
}
//print_r($data[$i]);
$r .= "\t\t<{$titles[$i]}>";
$r .= strip_tags(str_replace('; ', '/', $data[$i]));
$r .= "</{$titles[$i]}>\n";
}
if ($row > 0) $r .= "\t</{$rows}>\n";
$row++;
}
fclose($handle);
$r .= "</{$container}>";
return $r;
}
$xml = csv2xml('feed.csv', 'products', 'product');
$xmlfile = @fopen('test.xml', 'wb') or die('Could not open XML file for writing');
fwrite($xmlfile, $xml) or die('Could not write string to XML file');
fclose($xmlfile);
echo "Successfully wrote the XML file";

?> 
```

哦，无法编辑原始 CSV，因为我从外部 url 获取文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:38:39.523

我解决了 :) 我不得不增加长度参数，因为线条长于 1000。所以我的解决方案是这样

```
while (($data = fgetcsv($handle, 4000, ';')) !== FALSE) {...} 
```

不知何故，这也解决了字符编码问题。

# html - R htmlParse XML中的编码问题

> ID：12064096
> 
> 赞同：2
> 
> 时间：2012-08-21T22:42:12.360
> 
> 标签：html, r, character-encoding

我尝试抓取一个网站，但无法处理此编码问题：

```
# putting together the url:
search_str <- "allintitle:amphibian richness OR diversity"
url <- paste("http://scholar.google.at/scholar?q=",
             search_str, "&hl=en&num=100&as_sdt=1,5&as_vis=1", sep = "")

# get content and parse it:
doc <- htmlParse(url)

# encoding isssue, like here..
xpathSApply(doc, '//div[@class="gs_a"]', xmlValue)

  [1] "M Vences, M Thomasâ€¦ - â€¦  of the Royal  â€¦, 2005 - rstb.royalsocietypublishing.org"             
  [2] "PB Pearman - Conservation Biology, 1997 - Wiley Online Library"                                     
  [3] "D Vallan - Biological Conservation, 2000 - Elsevier"                                                
  [4] "LB Buckley, W Jetz - Proceedings of the Royal  â€¦, 2007 - rspb.royalsocietypublishing.org"         
  [5] "MÃ RodrÃ­guez, JA Belmontes, BA Hawkins - Acta Oecologica, 2005 - Elsevier"                        
  [6] "TJC Beebee - Biological Conservation, 1997 - Elsevier"                                              
  [7] "D Vallan - Journal of Tropical Ecology, 2002 - Cambridge Univ Press"                                
  [8] "MO RÃ¶del, R Ernst - Ecotropica, 2004 - gtoe.de" 
# ... 
```

任何指针？

```
> sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Austria.1252  LC_CTYPE=German_Austria.1252   
[3] LC_MONETARY=German_Austria.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Austria.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] RCurl_1.91-1.1 bitops_1.0-4.1 XML_3.9-4.1   

loaded via a namespace (and not attached):
[1] tools_2.15.1

> getOption("encoding")
[1] "native.enc" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:56:18.440

这在某种程度上对我有用

```
doc <- htmlParse(url,encoding="UTF-8")
head(xpathSApply(doc, '//div[@class="gs_a"]', xmlValue))
#[1] "M Vences, M Thomas… - …  of the Royal  …, 2005 - rstb.royalsocietypublishing.org"        
#[2] "PB Pearman - Conservation Biology, 1997 - Wiley Online Library"                          
#[3] "D Vallan - Biological Conservation, 2000 - Elsevier"                                     
#[4] "LB Buckley, W Jetz - Proceedings of the Royal  …, 2007 - rspb.royalsocietypublishing.org"
#[5] "MÁ Rodríguez, JA Belmontes, BA Hawkins - Acta Oecologica, 2005 - Elsevier"               
#[6] "TJC Beebee - Biological Conservation, 1997 - Elsevier" 
```

你

```
xpathSApply(doc, '//div[@class="gs_a"]', xmlValue)[[81]] 
```

例如，在我的 Windows 框中显示不正确。

使用 GUI 首选项切换到字体`DotumChe`但显示它显示正确，因此它可能只是显示问题而不是解析问题。

# c - C 的 HTML 解析器

> ID：12064099
> 
> 赞同：0
> 
> 时间：2012-08-21T22:43:05.520
> 
> 标签：c, xml-parsing, libxml2

我正在寻找一个易于使用的 html 解析器库。目前我正在尝试设置 libxml2，但遇到了令人沮丧的问题。我使用的 IDE 是 Pelles C，我为 libxml2 获取了 windows 文件并将它们放在适当的文件夹中（正确的标题区域中的标题、bin 中的二进制文件、库中的库等），但每当我尝试编译程序时仍然如此编译器只是告诉我我调用的每个 libxml2 函数都是未定义的。例如：

链接器标志：

`-subsystem:console -machine:amd64 kernel32.lib advapi32.lib delayimp64.lib Ws2_32.lib libxml2.lib`

代码：

```
static void print_element_names(xmlNode * a_node)
{
xmlNode *cur_node = NULL;

for(cur_node = a_node; cur_node; cur_node = cur_node->next) 
{
    if (cur_node->type == XML_ELEMENT_NODE) 
    {
        printf("node type: Element, name: %s\n", cur_node->name);
    }
    print_element_names(cur_node->children);
}
}

int main(void)
{
xmlDoc *doc = NULL;
xmlNode *root_element = NULL;

LIBXML_TEST_VERSION
doc = xmlReadFile("XMLFILE"/*XML_FILE PUT HERE*/, NULL, 0);
if (doc != NULL) printf("error: could not parse file");
root_element = xmlDocGetRootElement(doc);
print_element_names(root_element);
xmlFreeDoc(doc);
xmlCleanupParser();

return 0;
} 
```

尝试编译时只给我以下错误：

```
POLINK: error: Unresolved external symbol 'xmlCheckVersion'.
POLINK: error: Unresolved external symbol 'xmlReadFile'.
POLINK: error: Unresolved external symbol 'xmlDocGetRootElement'.
POLINK: error: Unresolved external symbol 'xmlFreeDoc'.
POLINK: error: Unresolved external symbol 'xmlCleanupParser'.
POLINK: fatal error: 5 unresolved external(s). 
```

这整个情况让我发疯，如果有人可以帮助我解决这个问题或者建议一个更容易设置的 html 解析器，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:51:29.073

这些错误与链接阶段有关：您使用的任何库都会给您带来相同的问题。

除非您确实安装了错误的软件包（例如 64 位库而不是 32 位库，反之亦然）。

对于 XML 解析，libxml2 是一个非常有用的工具，它非常快速且非常强大。鉴于您已经开始这样做，我会尝试解决链接器问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T22:52:52.507

我曾经使用过 Mini-XML。它使用 ANSI C 编译器编译。 [http://www.minixml.org/](http://www.minixml.org/)

但是您应该小心，因为解析 HTML 与解析 XML 不同。例如，在 HTML 中，您可以拥有标签而不关闭它们。例如：

```
<img src="foo.jpg"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:33:01.513

我尝试了一个名为 html2cxx 的工具可以解析 html。它可以很好地解析 html 和 css1.0，但已经有几年没有更新了。

# c# - 如何从服务器端代码获取控件的完整 ClientID

> ID：12064100
> 
> 赞同：1
> 
> 时间：2012-08-21T22:43:08.383
> 
> 标签：c#, asp.net

我有一个 a 的`TextBox`内部`ItemTemplate`，`Repeater`它也在 a 的内部`ItemTemplate`。

服务器端我有：

```
protected void txtValorMaterialAsign_TextChanged(object sender, EventArgs e)
{
    string controlId = ((TextBox)sender).ClientID;
} 
```

这导致：

`rptFilasDeUnMaterial_ctl04_txtValorMaterialAsign`

但是该控件的客户端 ID 是（根据 Chrome 的 F12）：

```
ctl00_contenido_wucMateriales_rptMateriales_ctl00_rptFilasDeUnMaterial_ctl01_txtValorMaterialAsign 
```

如何从服务器端代码获取完整的 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:03:30.053

这对我有用：

```
var myResult1 = FindControl("ctl00").FindControl("MainContent")
                                    .FindControl("text1").UniqueID; 
```

返回：

> ctl00$MainContent$text1

试试`UniqueID`你的简单 findControl。如果这不起作用，请嵌套 findControls。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T22:58:14.057

也许这会给你一个想法：

HTML：

```
<%@ Page Title="Home Page" Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true"
    CodeFile="Default.aspx.cs" Inherits="_Default" %>
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
  <asp:Repeater ID="repPeople" runat="server">
        <ItemTemplate>
            <asp:TextBox runat="server" ID="txtName" OnDataBinding="text_databinding" Text='<%# Eval("Name")%>'></asp:TextBox>
        </ItemTemplate>
  </asp:Repeater>
</asp:Content> 
```

代码背后：

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        List<Person> tmp = new List<Person>();
        tmp.Add(new Person() { LastName = "Escano", Name = "Hanlet" });
        tmp.Add(new Person() { LastName = "Escano", Name = "Hanlet" });
        tmp.Add(new Person() { LastName = "Escano", Name = "Hanlet" });
        tmp.Add(new Person() { LastName = "Escano", Name = "Hanlet" });
        tmp.Add(new Person() { LastName = "Escano", Name = "Hanlet" });
        this.repPeople.DataSource = tmp;
        this.repPeople.DataBind();
    }
    public void text_databinding(object sender, EventArgs e)
    { 
        Response.Write(((TextBox)sender).ClientID + "<br />") ;
    }
}

public class Person
{
    public string Name { get; set; }
    public string LastName { get; set; }
} 
```

输出：

```
MainContent_repPeople_txtName_0
MainContent_repPeople_txtName_1
MainContent_repPeople_txtName_2
MainContent_repPeople_txtName_3
MainContent_repPeople_txtName_4 
```

所以几乎使用文本框的 OnDataBinding，然后将发送者转换为`TextBox`，你甚至不需要使用`FindControl()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T22:50:54.803

你可以试试这样的..

在**标题**中查找控件：

```
textcontrol = repeater1.Controls[0].Controls[0].FindControl("txtValorMaterialAsign"); 
```

要在**页脚**中查找控件：

```
textcontrol = repeater1.Controls[repeater1.Controls.Count - 1].Controls[0].FindControl("txtValorMaterialAsign"); 
```

* * *

## 使用扩展方法

```
public static class RepeaterExtensionMethods
{
    public static Control FindControlInHeader(this Repeater repeater, string controlName)
    {
        return repeater.Controls[0].Controls[0].FindControl(controlName);
    }

    public static Control FindControlInFooter(this Repeater repeater, string controlName)
    {
        return repeater.Controls[repeater.Controls.Count - 1].Controls[0].FindControl(controlName);
    }
} 
```

# php - PHP DateTime 修改为月份中的特定日期

> ID：12064101
> 
> 赞同：0
> 
> 时间：2012-08-21T22:43:49.820
> 
> 标签：php

我正在尝试使用 php DateTime objects modify 函数将日期修改为当月的特定日期，即 10 日或 20 日等。

我已经尝试了以下所有方法，但都不起作用：

```
$d = new DateTime();

$d->modify('10th day');
$d->modify('10th');
$d->modify('10th of this month');
$d->modify('10th of the month'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T22:47:05.570

你想使用[DateTime::setDate](http://www.php.net/manual/en/datetime.setdate.php)

```
$date = new DateTime();
$date->setDate(2001, 2, 10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T22:57:23.847

假设您不知道年份和月份（如果知道，请使用[`DateTime::setDate()`](http://us3.php.net/manual/en/datetime.setdate.php)），一种方法如下：

```
$day = 10; // 10th of the month
$dt = new DateTime('first day of this month');
$dt->modify('+' . ($day - 1) . ' days'); 
```

我有一种感觉，也有一种方法可以严格通过构造函数来完成，但是像你一样，我无法弄清楚魔术字符串。奇怪的是“每月的第一天”有效，但“每月的第十天”无效。

**编辑：**显然[不可能通过构造函数来做到这一点](https://bugs.php.net/bug.php?id=50249)。甚至拉斯穆斯也建议这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T22:56:22.617

尝试这个：

```
$d = new DateTime('first day of this month');
$d->modify('+9 day'); 
```

PS：不过，我想一个更好的使用方式

```
$cMonth = date('n');
$cYear = date('Y');
...
$d->setDate($cYear, $cMonth, 10); 
```

# iphone - iPhone iOS 是否有类似代数计算器的应用程序的表达式解析器？

> ID：12064103
> 
> 赞同：2
> 
> 时间：2012-08-21T22:44:00.187
> 
> 标签：iphone, objective-c, ios, parsing, expression

我正在构建一个应用程序，可以通过加速度计和陀螺仪输出分析手机的运动。我很可能会将这个动作捕捉为应用程序内部跟踪的一组变量。

我试图包括一种方法来绘制这些变量和涉及这些变量的方程。我想为用户提供调整应用程序如何显示这些变量方程的能力，方法是键入 a + b - c = d 等方程，其中 a、b、c 变量由我的应用程序计算。用户可以在现场编写方程和图形变量。自从我用任何语言编写代数解析器以来已经有很长时间了，**如果在 Objective-c 中有一个表达式解析器，我可以很容易地插入到我的应用程序中，我正在徘徊**，用户会在其中输入类似 a + b - c = d 到文本字段中，应用程序将标记并替换我提供的变量来代替用户输入的占位符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T23:52:39.660

几个开源选项：

GCMathParser [http://www.apptree.net/parser.htm](http://www.apptree.net/parser.htm)

DDMathParser [https://github.com/davedelong/DDMathParser](https://github.com/davedelong/DDMathParser)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-10T15:48:40.410

有一种更简单的方法可以做到这一点:) 查看 NSExpression 基础类。它与您在聚光灯下键入表达式时使用的类相同。

[NSExpression 类参考](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSExpression_Class/Reference/NSExpression.html#//apple_ref/occ/clm/NSExpression/expressionWithFormat:argumentArray:)

在 Objective-C 中

```
NSExpression *expression = [NSExpression expressionWithFormat:@"2*4*3" argumentArray:nil];
NSNumber *result = [expression expressionValueWithObject:nil context:nil]; 
```

在斯威夫特

```
var expression:NSExpression = NSExpression(format: "4 + (3 * 2)", argumentArray: [])
var result = expression.expressionValueWithObject(nil, context: nil) 
```

# javascript - Javascript 中的原型关键字

> ID：12064104
> 
> 赞同：53
> 
> 时间：2012-08-21T22:44:10.130
> 
> 标签：javascript, html

什么是`prototype`财产，为什么它是必要的？到目前为止，我了解到这提供了对更多内在和私有`prototype`对象的公共访问；那是对的吗？

另外，以下陈述之间有什么区别？

```
MyConstructor.age = 30;
MyConstructor.prototype.age = 30; 
```

简而言之，我需要更好地理解关键字`prototype`。

谢谢

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-08-21T23:07:17.577

“原型”是在对象中发挥作用的东西。

在 Javascript 中，一切都是对象。每个对象都有一个种类，因此继承了`prototype`那个种类的。

例如，采用一个简单的数组：`var a = []`. 您可以使用它进行操作，例如`a.push(10)`. 这种`push`方法从何而来？从`Array`对象的原型，也`a`就是。

`Array`只需在对象中定义它们，您就可以将自己的方法添加到对象中`prototype`。例如：

```
Array.prototype.sortNum = function() {this.sort(function(a, b) {return a - b});}; 
```

这样，您可以对`a.sortNum()`所有*数组*执行类似操作，甚至是在定义方法之前创建的数组`sortNum`。

（注意：出于兼容性的原因，通常不建议扩展像`Array`s 这样的原生对象的原型。但是这个特定的例子通常是一个受欢迎的补充，以及像`map`和`forEach`对于旧浏览器的规范化方法。）

（**永远不要**扩展`Object.prototype`！除非您不想弄乱`for...in`语句、`in`运算符和这类情况。）

如果你想定义自己的类，就像名字`MyConstructor`所暗示的那样，你必须定义它`prototype`来定义该类的所有实例的方法：

```
function MyConstructor(name) {this.name = name};
MyConstructor.prototype = {
    print: function() {return this.name;}
};

var mc = new MyConstructor("foo");
alert(mc.print()); // alerts "foo" 
```

你也可以在 s 中定义更多的函数`prototype`：

```
MyConstructor.prototype.age = 30;

alert(mc.age); // alerts 30 
```

当您这样做来定义“默认”对象值时要小心，因为更改它可能会导致该类的*所有实例发生更改。*

但这很方便`Object.defineProperty`：

```
Object.defineProperty(MyConstructor.prototype, "wholeString", {
    get: function() {return this.name + "=" + this.age;},
    set: function(v) {this.name = v.substring(3);}
});

alert(mc.wholeString); // alerts "foo = 30" 
```

（不幸的是，IE<9 只允许对 DOM 对象这样做......）

相反，当您定义时`MyConstructor.age = 30`，您实际上在做的是定义*函数* `MyConstructor`的成员，因此`mc.age`未定义。的每个实例都`MyConstructor`继承 中定义的方法和成员`MyConstructor.prototype`，而不是函数的那些`MyConstructor`。

其实还有很多话要说。对象可以是另一个类的子类，因此也可以继承`prototype`超类的子类。例如，`document.body`是 的一个实例`HTMLBodyElement`，它是 的子类`HTMLElement`，是 的子类，`Element`以此类推，直到您`Object`成为最上面的超类。因此，`document.body`继承了 、 和 的原型中定义`HTMLBodyElement`的所有`HTMLElement`方法。这称为原型链。`Element``Object`

对自定义对象做同样的事情有点棘手：

```
function Class() {};
Class.prototype.foo = function() {alert("foo");};

function Subclass() {};
Subclass.prototype = new Class();
Subclass.prototype.bar = function() {alert("bar");};

var a = new Class(), b = new Subclass();
a.foo(); // alerts"foo"
a.bar(); // throws an error
b.foo(); // alerts "foo"
b.bar(); // alerts "bar"

a instanceof Class;    // true
a instanceof Subclass; // false
b instanceof Class;    // true
b instanceof Subclass; // true 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-21T22:50:22.353

在 JavaScript 中，函数对象具有内置`.prototype`属性。此属性的值是一个对象。如果该函数用作构造函数，则生成的实例继承自该“原型”对象。

例子：

```
var Dog = function () {}; // the constructor function

Dog.prototype.bark = function () {}; // adding a method to Dog.prototype

var dog1 = new Dog; // creating a new instance

dog1.bark(); // the instance inherits the "bark" method from Dog.prototype 
```

请注意，`.prototype`（函数对象的）属性与`[[Prototype]]`内部属性不同。所有对象都包含后者。它是对对象原型的内部引用。（在上面的示例中，`dog1`对象的`[[Prototype]]`引用是`Dog.prototype`。）另一方面，只有函数对象具有内置`.prototype`属性（这是有道理的，因为只有函数对象可以用作构造函数）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-21T22:56:15.347

```
var foo = function () {};
foo.bar = 5;
foo.prototype.foobar = 10;

var x = new foo();
x.bar; // undefined
x.foobar; // 10 
```

编辑：另外，你可以这样做

```
foo.prototype.foobar = 20;
x.foobar; // 20 
```

# java - 使用java将gson转换为对象

> ID：12064106
> 
> 赞同：2
> 
> 时间：2012-08-21T22:44:24.777
> 
> 标签：java, json, gson

我试图弄清楚如何使用 gson 将 reddit 的 api 响应转换为我可以使用的形式。在我使用一些代码之后

```
System.out.println(response.toString()); 
```

获得输出（稍作编辑）

```
{"json": {"errors": [], "data": {"modhash": "dosiom5o6abbbb758729039f04762a05778db4aeeeacd8eb4a", "cookie": "14756159,2012-08-21T12:05:05,0971bdec35d71af4073cf56ad82fb0ae7c5fe2d1"}}} 
```

谷歌搜索后，我建立了以下课程

```
class GSONClass {

    private Response jsonresponse;

    public Response getJsonresponse() {
        return jsonresponse;
    }

    public void setJsonresponse(Response jsonresponse) {
        this.jsonresponse = jsonresponse;
    }

    public static class Response {
        private String[] errors;
        private Data data;

        public Data getData() {
            return data;
        }

        public void setData(Data data) {
            this.data = data;
        }

        public String[] getErrors() {
            return errors;
        }

        public void setErrors(String[] errors) {
            this.errors = errors;
        }
    }

    public static class Data {
        private String modhash = "hi";
        private String cookie;

        public String getCookie() {
            return cookie;
        }

        public void setCookie(String cookie) {
            this.cookie = cookie;
        }

        public String getModhash() {
            return modhash;
        }

        public void setModhash(String modhash) {
            this.modhash = modhash;
        }
    }
} 
```

然后我使用：

```
GSONClass target = new GSONClass();
String json = gson.toJson(response.toString());
GSONClass target = gson.fromJson(json, GSONClass.class); 
```

我做错了什么，因为我收到“java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:40:12.600

你很亲密。您的对象需要有一个名为 json 的属性，该属性包含一个数组（错误）和一个名为 data 的对象，该对象包含属性 modhash 和 cookie。您调用 jsonResponse 的属性需要称为 json。

```
public class GSONClass {
    private Response json;

    public static class Response {
        private String[] errors;
        private Data data;
    }

    public static class Data {
        private String modhash = "hi";
        private String cookie;
    }
} 
```

和一个存根/跑步者。

```
import com.google.gson.Gson;

public class Main {

    public static void main(String[] args) {
        String response = "{\"json\": {\"errors\": [], \"data\": {\"modhash\": \"dosiom5o6abbbb758729039f04762a05778db4aeeeacd8eb4a\", \"cookie\": \"14756159,2012-08-21T12:05:05,0971bdec35d71af4073cf56ad82fb0ae7c5fe2d1\"}}}";
        GSONClass target = new Gson().fromJson(response, GSONClass.class);
        System.out.println(target);
    }
} 
```

# r - 在R中将字符串编码为数字

> ID：12064109
> 
> 赞同：1
> 
> 时间：2012-08-21T22:45:00.283
> 
> 标签：r, statistics

我在 R 中有一个数据集，其中有一列包含 0-1 个月、8-9 个月等。我想将此列编码为带有月数的数字变量。例如，而不是 8-9 个月，只放 9。感谢您的帮助和评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T22:50:58.410

一口气

```
a <- c("0-1 month", "8-9 months")
as.integer(gsub("^[[:digit:]]+-([[:digit:]]+) month[s]*", "\\1", a)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T23:41:09.363

使用包中的`recode`功能`car`。它不如`gsub`解决方案简洁，但更灵活，可能更容易阅读：

```
library(car)
a <- c("0-1 month", "8-9 months")
recode(a, '"0-1 month" = 1; "8-9 months" = 2') 
```

# function - plpgsql：创建具有动态 setof 返回类型的函数

> ID：12064111
> 
> 赞同：0
> 
> 时间：2012-08-21T22:45:19.273
> 
> 标签：function, return, plpgsql

我正在尝试创建一个返回动态数据类型集的函数。数据类型都是预先创建的，可以称为第四个变量。

```
CREATE OR REPLACE FUNCTION gethistoryrecord(text, text, text, text)
RETURNS setof $4 AS
$BODY$
declare
    r record;
begin
    for r in EXECUTE 'SELECT * FROM ' || $1 || ' where ref_id = ' || $2 || ' and create_date < ' || quote_literal($3) || '::timestamp and (archive_date is null or archive_date >= ' || quote_literal($3) || '::timestamp)' loop
        return next r;
    end loop;
    return;
end
$BODY$
  LANGUAGE plpgsql; 
```

我将调用该函数

```
select * from gethistoryrecord('view_all_history','3540','2012-08-21 17:43:39.855852','holder_name') 
```

是否有可能我不必声明输出并且没有收到错误

> 返回“记录”的函数需要列定义列表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:57:22.287

您可以指定输出记录，但这可能是您想要的。PostgreSQL 具有相对严格的类型系统，不可能编写过于通用的 SRF 函数。

# c# - 控制器中无法识别 URL 参数

> ID：12064113
> 
> 赞同：2
> 
> 时间：2012-08-21T22:45:25.163
> 
> 标签：c#, asp.net-mvc

我正在学习 MVC 4，据我了解，转到此 URL 应该将 44 的 int 传递给控制器​​的 Edit() 方法。确实，当我去这里时：

```
http://localhost:51921/TrackerJob/Edit/44 
```

...这个方法被调用：

```
public ActionResult Edit(int trackerJobId = -1)
{
    Debug.WriteLine(trackerJobId);
} 
```

...但参数始终为-1。我在另一个项目中工作过，但由于某种原因，在这个项目中它总是-1。我看不出两个项目之间的区别会导致一个工作而这个失败。如果我将方法签名更改为：

```
public ActionResult Edit(int trackerJobId)
{
    Debug.WriteLine(trackerJobId);
} 
```

我收到一个错误：

`The parameters dictionary contains a null entry for parameter 'trackerJobId' of non-nullable type 'System.Int32'`

有任何想法吗？我不确定要检查什么...

**编辑 - 包括路线，按要求***

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:03:49.320

如果您想使用默认路由，那么只需确保您的参数被调用`id`。

否则，您可以像这样添加新路线：

```
routes.MapRoute(
    name: "TrackerJob",
    url: "{controller}/{action}/{jobtrackerid}",
    defaults: new { controller = "TrackerJob", action = "Index", id = UrlParameter.Optional }
); 
```

确保在默认路由之前添加此路由。路线的顺序很重要！

只有您知道是否`trackerJobId`可选。

请注意，如果您想要更花哨的东西，您可以调整路线以产生您想要的东西。

例如，如果您想要`http://localhost:51921/TJ-E-44`编辑 URL，那么您的路线将如下所示：

```
routes.MapRoute(
    name: "TrackerJobEdit",
    url: "TJ-E-{jobtrackerid}",
    defaults: new { controller = "TrackerJob", action = "Edit", id = UrlParameter.Optional }
); 
```

我相信你明白了。

# php - 我可以使用参数化 SQL 动态选择数据库中的字段吗？

> ID：12064118
> 
> 赞同：2
> 
> 时间：2012-08-21T22:45:43.760
> 
> 标签：php, mysql, database, sqlbindparameter

我有一个数据库表 USER_OPTIONS，其中包含应用程序中各种选项中的每一个的字段，它看起来有效如下：

```
USER_ID | OPTION_1 | OPTION_2 | OPTION_3 | ... | OPTION 20
----------------------------------------------------------
 100    | true     | true     | false    | ... | false 
 101    | true     | true     | false    | ... | false 
 102    | false    | false    | false    | ... | true 
 ... etc etc 
```

然后我的应用程序想要触发一个 AJAX 请求来调整这个表。

通过 AJAX 发送的信息是一组已更改的数据库字段及其新值（JSON 格式），例如

```
$my_new_settings === {
    'OPTION_1' : 'false',
    'OPTION_2' : 'false'
    'OPTION_20' : 'true'
} 
```

然后我的计划是使用参数化的 SQL 查询，如下所示

```
$query_string = "UPDATE `USER_OPTIONS` 
               SET ? = ? 
               WHERE  
               `USER_ID` = ? 
               LIMIT 1 ;";

$my_user_id = 100;
$my_field_for_updating = "OPTION_1";
$my_new_field_value = "false";

if ( $query = $mysqli->prepare($query_string) ) {

    $query->bind_param("sss", $my_field_for_updating, $my_new_field_value, $my_user_id);
    $query->execute();
    $query->close();

} 
```

然后遍历关联数组以获取彼此的一对`$my_field_for_updating`和`$my_new_field_value`from `$my_new_settings`。

然而。

我随后[在 php.net 手册中发现了以下内容](http://php.net/manual/en/mysqli.prepare.php)：

（“标记”是用于参数化 SQL 查询中“？”变量的术语）

> 笔记：
> 
> 标记仅在 SQL 语句中的某些位置是合法的。例如，它们可以在 INSERT 语句的 VALUES() 列表中使用（以指定行的列值），或者在与 WHERE 子句中的列进行比较以指定比较值时。
> 
> **但是，它们不允许用于标识符（例如表名或列名）**，在命名要由 SELECT 语句返回的列的选择列表中，或指定二元运算符（例如 = 等号）的两个操作数。后一个限制是必要的，因为不可能确定参数类型。不允许将标记与 NULL 进行比较？也为空。通常，参数仅在数据操作语言 (DML) 语句中合法，在数据定义语言 (DDL) 语句中不合法。

因此，这破坏了我提出的解决方案。

我的下一个想法是有一个 SQL 查询来更新数据库中的所有字段，但只包含新更新的字段值。但是我发现这需要一个神奇的“什么都不做”变量来分配给我没有数据的字段的“标记”。

```
$query_string = "UPDATE `USER_OPTIONS` 
                   SET `OPTION_1` = ?,
                   SET `OPTION_2` = ?,
                   SET `OPTION_3` = ?,
                   ...
                   SET `OPTION_20` = ?
                   WHERE  
                   `USER_ID` = ? 
                   LIMIT 1 ;";

$my_user_id = 100;
$my_new_OPTION_1_value = 'false';
$my_new_OPTION_2_value = 'false';
$my_new_OPTION_20_value = 'true';
$magic_do_nothing_value = ????;

if ( $query = $mysqli->prepare($query_string) ) {

    $query->bind_param("sssssssssssssssssssss", 
       $my_new_OPTION_1_value, 
       $my_new_OPTION_2_value,
       $magic_do_nothing_value,
       $magic_do_nothing_value,
       ...
       $magic_do_nothing_value,
       $my_new_OPTION_20_value,
       $my_user_id
    );
    $query->execute();
    $query->close();

} 
```

但是，我不知道`$magic_do_nothing_value`实际可能是什么（并且发现很难用谷歌搜索）。我尝试的一切要么抛出错误，要么被解释为“错误”。

所以我的第一个问题是：MYSQL 数据库是否接受一个值作为*“什么都不做”*的信号？

假设没有并继续前进，我的下一个想法是将所有当前值从数据库中拖出给定的`USER_ID`，使用更改修改这些值`$my_new_settings`，然后使用所有字段相应地更新数据库。

然而，这似乎是很多不必要的工作，尤其是与我的第一个解决方案相比。

这导致我在这里要求一个更好的！

非常感谢您的任何想法，我真的很想听听他们的意见。这是在 PHP 5.2 和一个基本的 MySQL 5.0.92 数据库上运行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:55:36.503

我将简单地动态构建 SQL，然后像您已经完成的那样绑定参数值。这是一个使用类来处理动态数量的参数的示例（取自 PHP 文档的类）。请注意我没有测试过代码，但是逻辑应该是清楚的。

```
// This class will store the value for each query parameter
class BindParam {
  private $values = array(), $types = '';

  public function add($type, &$value) {
    $this->values[] = $value; 
    $this->types .= $type; 
  } 

  public function get() {
    return array_merge(array($this->types), $this->values); 
  } 
}

$my_new_settings = array(
    'OPTION_1' => 'false',
    'OPTION_2' => 'false',
    'OPTION_20' => 'true',
)

$bind_param = new BindParam();

$query_arr = array("UPDATE `USER_OPTIONS`");

// This loop will build the query and store each parameter value in bin_param instance
foreach($my_new_settings as $field_name => $field_value) {
  $query_arr[] = sprintf('`%s` = ?', $field_name);
  $bind_param->add('s', $field_value);
}

$query_arr[] = 'WHERE `USER_ID` = ?';
$query_arr[] = 'LIMIT 1 ;";

// Put all pieces together, forming an SQL command
$query_string = implode(' ', $query_arr);

$my_user_id = 100;
$my_field_for_updating = "OPTION_1";
$my_new_field_value = "false";

if($query = $mysqli->prepare($query_string)) {
  // Bind all parameter values saved earlier
  call_user_func_array(array($query, 'bind_param'), $bind_param->get())

  $query->execute();
  $query->close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:06:32.790

抱歉，我还没有开始使用 mysli 或 PDO（懒惰我 :)）但是当我需要插入或更新 mysql 表时，我会实现这个函数。由于基于 mysqli 的使用，您可能不会直接使用，但可能会给您一个想法。查找表的字段名并将它们与给定的数组键名匹配（即使具有指定的前缀），您还需要在 $sql_condition 和 $exceptions 中指示更新的键字段以过滤要插入的不需要的数据。

在我的使用中，键名以“the_”开头，如果以“t_”开头，则自动忽略。

```
 function q_put2($data_array=array() ,$table, $exceptions = '', $sql_type = 'insert', $sql_condition = NULL) {
      if($sql_condition!=NULL) $table_columns_filter=$sql_condition;
else $table_columns_filter="";
$table_columns_qs="SHOW COLUMNS FROM $table ;";
$table_columns_rs=mysql_query($table_columns_qs);

while ($row=mysql_fetch_row($table_columns_rs)){
   $table_columns[]=$row[0];
} 

$fields = '';$values = '';
foreach ($data_array as $field => $value) {
if(substr($field,0,4)=="the_")$field=substr($field,4);
    if(substr($field,0,2)!="t_" && !strstr($exceptions,$field) &&  in_array($field,$table_columns)){
        $value = mysql_real_escape_string($value);
        if ($sql_type == 'insert') {
        $fields .= "$field, ";
        $values .= "'$value', ";
        }
        else {
            $fields .= "$field = '$value', ";
        }
    }
}
$fields = preg_replace('/, $/', '', $fields);
$values = preg_replace('/, $/', '', $values);

if ($sql_type == 'insert') {
 $sql = "INSERT INTO $table ($fields) VALUES ($values)";
}
elseif ($sql_type == 'update') {
 if (!isset($sql_condition)) {
   echo 'ERROR: You must enter a sql condition!';
   exit;
 }
 $sql = "UPDATE $table SET $fields WHERE $sql_condition";}
else {
 echo 'ERROR: Invalid input for argument $sql_type: must be "insert" or "update"';
 exit;
}
if ($q_select_rs=mysql_query($sql)) {
return true;
} 
else 
{
return false;
}
} 
```

# php - 如何从四个不同的 div 中的数据库中获取数据？

> ID：12064124
> 
> 赞同：-3
> 
> 时间：2012-08-21T22:46:05.543
> 
> 标签：php, mysql, sql, phpmyadmin

我想从数据库中取出 4 个不同的 id 行。并显示在四个 div 中。每个 div 都包含一个字符基唯一 ID。我这样做是为了一次又一次地编写相同的查询。我想减少查询。我的代码如下。

```
<?php
$query = mysql_query("select * from acms_pages where id = 40");
$sql = mysql_fetch_array($query);
?>
           <li id="pgAbout">
         <section class="content">
            <div class="one_half_last"><?php echo $sql['text'];  ?></div>
            </section>
        </li>

<section class="content">
            <?php
$query = mysql_query("select * from acms_pages where id = 41");
$sql1 = mysql_fetch_array($query);
?>
        <li id="pgPortfolio">
            <div class="fullwidth"><?php echo $sql1['text'];  ?></div>
           </section>
        </li>

<?php
$query = mysql_query("select * from acms_pages where id = 42");
$sql2 = mysql_fetch_array($query);
?>
        <li id="pgServices">
                 <section class="content">                
                <div class="one_half_last"><?php echo $sql2['text'];  ?></div>
            </section>
        </li>
<?php
$query = mysql_query("select * from acms_pages where id = 43");
$sql3 = mysql_fetch_array($query);
?>
        <li id="pgPrices">
             <section class="content">
                <div class="one_half"><?php echo $sql3['text'];  ?></div>
             </section>
        </li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T22:55:26.903

这可能属于programmers.stackexchange.com，但一般方法是将您的查询重写为单个查询，其中 where 子句包括所有四个条件 OR'd 一起。

然后您可以独立访问每一行并呈现 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T22:55:54.290

要回答您的问题（我认为...），您可以在查询中使用 OR：

```
mysql_query("select * from acms_pages where id = 40 OR id = 41 OR id = 42"); 
```

但是，您应该改用 mysqli：

```
$link = mysqli_connect("localhost", "my_user", "my_password", "mydb");
if ($result = mysqli_query($link, "select * from acms_pages where id = 40 OR id = 41 OR id = 42")) 
{
    printf("Select returned %d rows.\n", mysqli_num_rows($result));

    while ($row = mysqli_fetch_row($result)) {
        printf ("%s", $row[0]); //first column value here
    }

    /* free result set */
    mysqli_free_result($result);
} 
```

# assembly - MIPS 中的操作系统如何访问外围设备？

> ID：12064129
> 
> 赞同：2
> 
> 时间：2012-08-21T22:47:01.067
> 
> 标签：assembly, kernel, mips

我已经阅读了一段时间的 MIPS 汇编语言，只是为了学习。我现在知道用户代码中的系统调用和异常使处理器跳转到内核和异常处理所在的内存中的某个位置。

我很好奇操作系统如何访问外围设备，因为我看不到任何其他相关说明。处理器是导出自己的一组基本系统调用，还是外围设备以某种方式映射到内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:14:50.647

MIPS 没有特殊的 IO 指令。外设通过一些内存总线接口映射到平面物理地址空间，然后使用标准加载/存储指令进行访问。MIPS 确实有协处理器控制指令，可用于操作某些外围设备（主要是 MMU 或高速缓存控制器），但这些指令通常不用于通用设备接口。

# python - 有什么方法可以使用 Python 检查 Twitch 流是否正在直播？

> ID：12064130
> 
> 赞同：9
> 
> 时间：2012-08-21T22:47:03.230
> 
> 标签：python, twitch

我只是想知道是否有任何方法可以编写 python 脚本来检查 twitch.tv 流是否直播？

我不确定为什么我的应用引擎标签被删除，但这将使用应用引擎。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2020-02-05T12:14:51.740

Since all answers are actually outdated as of 2020-05-02, i'll give it a shot. You now are required to register a developer application (I believe), and now you must use an endpoint that requires a user-id instead of a username (as they can change).

See [https://dev.twitch.tv/docs/v5/reference/users](https://dev.twitch.tv/docs/v5/reference/users)

and [https://dev.twitch.tv/docs/v5/reference/streams](https://dev.twitch.tv/docs/v5/reference/streams)

First you'll need to [Register an application](https://dev.twitch.tv/console/apps/create)

From that you'll need to get your `Client-ID`.

The one in this example is not a real

```
TWITCH_STREAM_API_ENDPOINT_V5 = "https://api.twitch.tv/kraken/streams/{}"

API_HEADERS = {
    'Client-ID' : 'tqanfnani3tygk9a9esl8conhnaz6wj',
    'Accept' : 'application/vnd.twitchtv.v5+json',
}

reqSession = requests.Session()

def checkUser(userID): #returns true if online, false if not
    url = TWITCH_STREAM_API_ENDPOINT_V5.format(userID)

    try:
        req = reqSession.get(url, headers=API_HEADERS)
        jsondata = req.json()
        if 'stream' in jsondata:
            if jsondata['stream'] is not None: #stream is online
                return True
            else:
                return False
    except Exception as e:
        print("Error checking user: ", e)
        return False 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-13T01:42:41.537

RocketDonkey 的好答案现在似乎已经过时了，所以我为像我这样偶然发现谷歌这个 SO-question 的人发布了一个更新的答案。您可以通过解析检查用户EXAMPLEUSER的状态

```
https://api.twitch.tv/kraken/streams/EXAMPLEUSER 
```

条目 "stream":null 将告诉您该用户是否离线，如果该用户存在。这是一个可以在命令行上使用的小型 Python 脚本，它将为在线用户打印 0，为离线用户打印 1，为未找到用户打印 2。

```
#!/usr/bin/env python3

# checks whether a twitch.tv userstream is live

import argparse
from urllib.request import urlopen
from urllib.error import URLError
import json

def parse_args():
    """ parses commandline, returns args namespace object """
    desc = ('Check online status of twitch.tv user.\n'
            'Exit prints are 0: online, 1: offline, 2: not found, 3: error.')
    parser = argparse.ArgumentParser(description = desc,
             formatter_class = argparse.RawTextHelpFormatter)
    parser.add_argument('USER', nargs = 1, help = 'twitch.tv username')
    args = parser.parse_args()
    return args

def check_user(user):
    """ returns 0: online, 1: offline, 2: not found, 3: error """
    url = 'https://api.twitch.tv/kraken/streams/' + user
    try:
        info = json.loads(urlopen(url, timeout = 15).read().decode('utf-8'))
        if info['stream'] == None:
            status = 1
        else:
            status = 0
    except URLError as e:
        if e.reason == 'Not Found' or e.reason == 'Unprocessable Entity':
            status = 2
        else:
            status = 3
    return status

# main
try:
    user = parse_args().USER[0]
    print(check_user(user))
except KeyboardInterrupt:
    pass 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-21T22:57:09.053

看起来 Twitch 提供了一个 API（[此处](http://apiwiki.justin.tv/mediawiki/index.php/Stream/list)的文档），它提供了一种获取该信息的方法。获取提要的一个非常简单的示例是：

```
import urllib2

url = 'http://api.justin.tv/api/stream/list.json?channel=FollowGrubby'
contents = urllib2.urlopen(url)

print contents.read() 
```

这将转储所有信息，然后您可以使用[JSON 库](http://docs.python.org/library/json.html)对其进行解析（XML 看起来也可用）。如果流不存在，看起来值返回空（根本没有测试这么多，我也没有读过任何东西:)）。希望这可以帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-24T23:36:33.447

### 使用带有您的 client_id 作为参数的 twitch api，然后解析 json：

```
https://api.twitch.tv/kraken/streams/massansc?client_id=XXXXXXX 
```

Twitch Client Id is explained here: [https://dev.twitch.tv/docs#client-id](https://dev.twitch.tv/docs#client-id), you need to register a developer application: [https://www.twitch.tv/kraken/oauth2/clients/new](https://www.twitch.tv/kraken/oauth2/clients/new)

Example:

```
import requests
import json

def is_live_stream(streamer_name, client_id):

    twitch_api_stream_url = "https://api.twitch.tv/kraken/streams/" \
                    + streamer_name + "?client_id=" + client_id

    streamer_html = requests.get(twitch_api_stream_url)
    streamer = json.loads(streamer_html.content)

    return streamer["stream"] is not None 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-10-20T10:12:05.047

I'll try to shoot my shot, just in case someone still needs an answer to this, so here it goes

```
import requests
import time
from twitchAPI.twitch import Twitch

client_id = ""
client_secret = ""

twitch = Twitch(client_id, client_secret)
twitch.authenticate_app([])

TWITCH_STREAM_API_ENDPOINT_V5 = "https://api.twitch.tv/kraken/streams/{}"

API_HEADERS = {
    'Client-ID' : client_id,
    'Accept' : 'application/vnd.twitchtv.v5+json',
}

def checkUser(user): #returns true if online, false if not
    userid = twitch.get_users(logins=[user])['data'][0]['id']
    url = TWITCH_STREAM_API_ENDPOINT_V5.format(userid)
    try:
        req = requests.Session().get(url, headers=API_HEADERS)
        jsondata = req.json()
        if 'stream' in jsondata:
            if jsondata['stream'] is not None: 
                return True
            else:
                return False
    except Exception as e:
        print("Error checking user: ", e)
        return False

print(checkUser('michaelreeves')) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-03-08T20:02:09.947

Here is a more up to date answer using the latest version of the Twitch API (helix). (kraken is deprecated and you shouldn't use GQL since it's not documented for third party use).

It works but you should store the token and reuse the token rather than generate a new token every time you run the script.

```
 import requests

client_id = ''
client_secret = ''
streamer_name = ''

body = {
    'client_id': client_id,
    'client_secret': client_secret,
    "grant_type": 'client_credentials'
}
r = requests.post('https://id.twitch.tv/oauth2/token', body)

#data output
keys = r.json();

print(keys)

headers = {
    'Client-ID': client_id,
    'Authorization': 'Bearer ' + keys['access_token']
}

print(headers)

stream = requests.get('https://api.twitch.tv/helix/streams?user_login=' + streamer_name, headers=headers)

stream_data = stream.json();

print(stream_data);

if len(stream_data['data']) == 1:
    print(streamer_name + ' is live: ' + stream_data['data'][0]['title'] + ' playing ' + stream_data['data'][0]['game_name']);
else:
    print(streamer_name + ' is not live'); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-06-14T11:39:52.177

I hated having to go through the process of making an api key and all those things just to check if a channel was live, so i tried to find a workaround:

As of june 2021 if you send a http get request to a url like `https://www.twitch.tv/CHANNEL_NAME`, in the response there will be a `"isLiveBroadcast": true` if the stream is live, and if the stream is not live, there will be nothing like that.

So i wrote this code as an example in nodejs:

```
const fetch = require('node-fetch');
const channelName = '39daph';

async function main(){
    let a = await fetch(`https://www.twitch.tv/${channelName}`);
    if( (await a.text()).includes('isLiveBroadcast') )
        console.log(`${channelName} is live`);
    else
        console.log(`${channelName} is not live`);
}

main(); 
```

here is also an example in python:

```
import requests
channelName = '39daph'

contents = requests.get('https://www.twitch.tv/' +channelName).content.decode('utf-8')

if 'isLiveBroadcast' in contents: 
    print(channelName + ' is live')
else:
    print(channelName + ' is not live') 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-11-23T19:52:03.830

This solution doesn't require registering an application

```
import requests

HEADERS = { 'client-id' : 'kimne78kx3ncx6brgo4mv6wki5h1ko' }
GQL_QUERY = """
query($login: String) {
    user(login: $login) {
        stream {
            id
        }
    }
}
"""

def isLive(username):
    QUERY = {
        'query': GQL_QUERY,
        'variables': {
            'login': username
        }
    }

    response = requests.post('https://gql.twitch.tv/gql',
                             json=QUERY, headers=HEADERS)
    dict_response = response.json()
    return True if dict_response['data']['user']['stream'] is not None else False

if __name__ == '__main__':
    USERS = ['forsen', 'offineandy', 'dyrus']
    for user in USERS:
        IS_LIVE = isLive(user)
        print(f'User {user} live: {IS_LIVE}') 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-14T11:35:12.900

是的。您可以使用 Twitch API 调用**`https://api.twitch.tv/kraken/streams/YOUR_CHANNEL_NAME`**和解析结果来检查它是否处于活动状态。

如果频道是实时的，则下面的函数返回一个**streamID**，否则返回**-1**。

```
import urllib2, json, sys
TwitchChannel = 'A_Channel_Name'
def IsTwitchLive(): # return the stream Id is streaming else returns -1
    url = str('https://api.twitch.tv/kraken/streams/'+TwitchChannel)
    streamID = -1
    respose = urllib2.urlopen(url)
    html = respose.read()
    data = json.loads(html)
    try:
       streamID = data['stream']['_id']
    except:
       streamID = -1
    return int(streamID) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-17T14:05:57.550

[https://dev.twitch.tv/docs/api/reference#get-streams](https://dev.twitch.tv/docs/api/reference#get-streams)

```
import requests
# ================================================================
# your twitch client id
client_id = '' 
# your twitch secret       
client_secret = ''
# twitch username you want to check if it is streaming online
twitch_user = ''                           
# ================================================================
#getting auth token
url = 'https://id.twitch.tv/oauth2/token'
params = {
    'client_id':client_id,
    'client_secret':client_secret,
    'grant_type':'client_credentials'}
req = requests.post(url=url,params=params)
token = req.json()['access_token']
print(f'{token=}')
# ================================================================
#getting user data (user id for example)
url = f'https://api.twitch.tv/helix/users?login={twitch_user}'
headers = {
    'Authorization':f'Bearer {token}',
    'Client-Id':f'{client_id}'}
req = requests.get(url=url,headers=headers)
userdata = req.json()
userid = userdata['data'][0]['id']
print(f'{userid=}')
# ================================================================
#getting stream info (by user id for example)
url = f'https://api.twitch.tv/helix/streams?user_id={userid}'
headers = {
    'Authorization':f'Bearer {token}',
    'Client-Id':f'{client_id}'}
req = requests.get(url=url,headers=headers)
streaminfo = req.json()
print(f'{streaminfo=}')
# ================================================================ 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-27T23:44:17.600

# Explanation

Now, the Twitch API v5 is deperecated. The `helix` API is in place, where a `OAuth Authorization Bearer` AND `client-id` is needed. All of the previous answers now don't function, so I created my own method. This is pretty annoying, so I went on a search for a viable workaround, and found one.

# GraphQL

Once inspecting Twitch's network requests, I realized it used GraphQL. GraphQL is essentially a **query language for APIs**.

```
query($login: String) {
  user(login: $login) {
    stream {
      id
    }
  }
} 
```

In the graphql query above, we are querying a user by their `login name`. If they are streaming, the stream's `id` will be given. If not, None will be returned.

# The Final Code

The finished python code, in a function, is below. The `client-id` is taken from Twitch's website. Twitch uses the `client-id`, in the code below, to fetch information for anonymous users (people who aren't logged in). It will always work, without the need of getting your own `client-id`.

```
import requests
# ...
def checkIfUserIsStreaming(username):
  url = "https://gql.twitch.tv/gql"
  query = """query($login: String) {
  user(login: $login) {
    stream {
      id
    }
  }
}"""
  return True if requests.post(url, json={"query": query, "variables": {"login": username}}, headers={"client-id": "kimne78kx3ncx6brgo4mv6wki5h1ko"}).json()['data']['user']['stream'] else False 
```

###### I've created a [website](https://twitch-graphql-playground.epiccodewizard.repl.co/) where you can play with Twitch's GraphQL API. Refer to the [GraphQL Docs](https://graphql.org/learn/) for help on creating queries and mutations!

# c# - COLLADA 混合：基于纹理的透明度

> ID：12064132
> 
> 赞同：0
> 
> 时间：2012-08-21T22:47:07.597
> 
> 标签：c#, opengl, opengl-3, collada

我现在要做的是让我的 COLLADA 进口商在一些透明的 COLLADA 模型上工作。模型混合由[COLLADA 规范](http://www.khronos.org/files/collada_spec_1_4.pdf)在第 7 章“渲染/确定透明度”段落中指定。

简而言之，混合方程有两个输入：*Trasparent*和*Trasparency*；前者可以是 RGBA 颜色或纹理，后者只能是浮点值。此外，*Transparent*可以指定两个混合方程（*ColladaFxOpaqueType.AlphaOne*和*ColladaFxOpaqueType.RgbZero*）：

这是两个混合方程：

```
// AlphaOne 
//
// result.r = fb.r * (1.0f - transparent.a * transparency) + mat.r * (transparent.a * transparency)
// result.g = fb.g * (1.0f - transparent.a * transparency) + mat.g * (transparent.a * transparency)
// result.b = fb.b * (1.0f - transparent.a * transparency) + mat.b * (transparent.a * transparency)
// result.a = fb.a * (1.0f - transparent.a * transparency) + mat.a * (transparent.a * transparency)

// RgbZero
//
// result.r = fb.r * (transparent.r * transparency) + mat.r * (1.0f -transparent.r * transparency)
// result.g = fb.g * (transparent.g * transparency) + mat.g * (1.0f -transparent.g * transparency)
// result.b = fb.b * (transparent.b * transparency) + mat.b * (1.0f -transparent.b * transparency)
// result.a = fb.a * (luminance(transparent.rgb) * transparency) + mat.a * (1.0f - luminance(transparent.rgb) * transparency)

where
- result: draw framebuffer
- fb: destination blend color
- mat: source blend color
- transparent: COLLADA parameter described above
- transparency: COLLADA parameter described above
- luminance: function to average color following ITU-R Recommendation BT.709-4 
```

我现在实现的是在*透明*表示颜色（以及两个混合方程）的情况下混合几何。下面是实现此功能的特殊代码：

```
internal void CompileBlendStateParameters(ColladaShaderParameters shaderParameters, ColladaFxCommonContext commonContext)
{
    if (shaderParameters == null)
        throw new ArgumentNullException("shaderParameters");
    if (commonContext == null)
        throw new ArgumentNullException("commonContext");

    // Apply alpha blending, if required
    if ((Transparent != null) || (Transparency != null)) {
        BlendState blendState = null;
        ColorRGBAF blendFactors = new ColorRGBAF(1.0f); // No effect value
        float trasparency = 1.0f;                       // No effect value

        if (Transparency != null)
            trasparency = Transparency.GetValue(commonContext);

        if ((Transparent != null) && (Transparent.IsFixedColor(commonContext) == true)) {
            switch (Transparent.Opaque) {
                case ColladaFxOpaqueType.AlphaOne:

                    // Equation from COLLADA specification:
                    //
                    // result.r = fb.r * (1.0f - transparent.a * transparency) + mat.r * (transparent.a * transparency)
                    // result.g = fb.g * (1.0f - transparent.a * transparency) + mat.g * (transparent.a * transparency)
                    // result.b = fb.b * (1.0f - transparent.a * transparency) + mat.b * (transparent.a * transparency)
                    // result.a = fb.a * (1.0f - transparent.a * transparency) + mat.a * (transparent.a * transparency)

                    // Determine blend factor constant color
                    blendFactors = new ColorRGBAF(Transparent.GetFixedColor(commonContext).Alpha);
                    // Modulate constant color
                    blendFactors = blendFactors * trasparency;
                    // Create blend state
                    blendState = new BlendState(BlendState.BlendEquation.Add, BlendState.BlendFactor.ConstColor, BlendState.BlendFactor.ConstColorComplement, blendFactors);
                    break;
                case ColladaFxOpaqueType.RgbZero:

                    // Equation from COLLADA specification:
                    //
                    // result.r = fb.r * (transparent.r * transparency) + mat.r * (1.0f -transparent.r * transparency)
                    // result.g = fb.g * (transparent.g * transparency) + mat.g * (1.0f -transparent.g * transparency)
                    // result.b = fb.b * (transparent.b * transparency) + mat.b * (1.0f -transparent.b * transparency)
                    // result.a = fb.a * (luminance(transparent.rgb) * transparency) + mat.a * (1.0f - luminance(transparent.rgb) * transparency)

                    // Determine blend factor constant color
                    blendFactors = new ColorRGBAF(Transparent.GetFixedColor(commonContext));
                    // Define alpha blend factor as luminance
                    blendFactors.Alpha = blendFactors.Red * 0.212671f + blendFactors.Green * 0.715160f + blendFactors.Blue * 0.072169f;
                    // Modulate constant color
                    blendFactors = blendFactors * trasparency;
                    // Create blend state
                    blendState = new BlendState(BlendState.BlendEquation.Add, BlendState.BlendFactor.ConstColorComplement, BlendState.BlendFactor.ConstColor, blendFactors);
                    break;
            }
        } else if ((Transparent != null) && (Transparent.IsTextureColor(commonContext) == true)) {

            throw new NotSupportedException();

        } else {
            // Modulate constant color
            blendFactors = blendFactors * trasparency;
            // Create blend state
            blendState = new BlendState(BlendState.BlendEquation.Add, BlendState.BlendFactor.ConstColor, BlendState.BlendFactor.ConstColorComplement, blendFactors);
        }

        if (blendState != null)
            shaderParameters.RenderState.DefineState(blendState);
    }
} 
```

粗略地说，上面的代码抽象了 OpenGL 层，相当于：

```
 // AlphaOne equation
 glEnable(GL_BLEND);
 glBlendEquation(GL_FUNC_ADD);
 glBlendFunc(GL_CONSTANT_COLOR, GL_ONE_MINUS_CONSTANT_COLOR);
 glBlendColor(blendFactors.Red, blendFactors.Green, blendFactors.Blue, blendFactors.Alpha);

 // RgbZero equation
 glEnable(GL_BLEND);
 glBlendEquation(GL_FUNC_ADD);
 glBlendFunc(GL_ONE_MINUS_CONSTANT_COLOR, GL_CONSTANT_COLOR);
 glBlendColor(blendFactors.Red, blendFactors.Green, blendFactors.Blue, blendFactors.Alpha);

 // Having calculated blendFactor appropriately!! 
```

我想要的是支持基于纹理的透明度（确实删除了那个可怕的*NotSupportedException*）。通常，这可以通过将纹理附加到输出的片段 alpha 分量，并像往常一样设置混合（Alpha 和 OneMinusAlpha 混合因子）来实现，但遗憾的是，上述方程无法实现这一点（不会混合 alpha 分量，不是是吗？）。

PS您可以注意到我已经使用简单的解决方案实现了混合，但基于恒定的混合颜色（`blendFactors`代码中的变量）（实际上使用 GL_EXT_blend_color 扩展）。如何通过使用正常的混合功能来消除这种依赖关系？我认为最后一个问题的解决方案可以帮助我了解基于纹理的混合......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:18:17.013

我*不太*确定我理解你的目的，但我会尝试一下（请随时在评论中跟进）。

您希望使用标准的 opengl 混合实现 AlphaOne 和 RgbZero 方程，而不是使用恒定颜色，您希望针对图像的每个纹素评估混合函数。透明度的典型混合函数（SRC_ALPHA，ONE_MINUS_SRC_ALPHA）使用传入片段的 alpha 值，并评估为：

```
result = dst * (1-src_alpha) + src * src_alpha 
```

一次查看您要实现的两个方程（为简洁起见，仅使用红色和 alpha）：

阿尔法一：

```
result.r = fb.r * (1.0f - transparent.a * transparency) + mat.r * (transparent.a * transparency);
result.a = fb.a * (1.0f - transparent.a * transparency) + mat.a * (transparent.a * transparency); 
```

如果我们查看这个方程，我们会发现它看起来与发布的初始方程非常相似。我们所要做的就是`transparent.a*transparency`替代`src_alpha`.

这意味着如果您使用像素着色器，其值`transparent.a`来自纹理样本，并且`transparency`作为统一浮点数，它将实现 AlphaOne 函数：

```
sampler2D tex;
uniform transparency;

main() {
   vec4 texel = texture2D(tex,uv);
   vec3 out_rgb = texel.rgb;
   float out_alpha = texel.a * transparency;
   gl_FragColor = vec4(out_rgb, out_alpha);
} 
```

此着色器`transparent.a * transparency`作为 src_alpha 值提交以用于混合方程。

我相信这表明您可以使用典型的 opengl 混合轻松实现该算法。

但是 RGBZero 函数对我来说看起来更难，我不相信有任何混合函数可以实现这一点。我只有一个奇怪的想法是一次绘制四个颜色通道（锁定 G、B、A 进行编辑，然后只绘制 R，输出 alpha 作为 R 混合因子，然后重复其他 3 个颜色通道。对我来说，这看起来有点奇怪的混合功能，但我想不出它会用来做什么。

# django - 在 Django 中扩展 Auth 用户和组模型

> ID：12064140
> 
> 赞同：2
> 
> 时间：2012-08-21T22:48:22.360
> 
> 标签：django, django-models, extending-classes

我最初只扩展了 Group 模型，虽然我让额外的字段正常工作，但当我切换回 auth-user 模型时，我最终得到了不一致的结果：

```
group1 = MyGroup(..)
user = group1.user_set.all()[0]
group2 = user.groups.all()[0]
group1 == group2 #(False!)
type(group1) #MyGroup..
type(group2) #Group.. 
```

我的下一个想法是扩展 auth.User 和 auth.Group 模型。

示例结构：

```
from django.contrib.auth.models import User As DjangoUser
from django.contrib.auth.models import Group As DjangoGroup

class MyGroup(DjangoGroup):
    extra1 = models.CharField(..)

class MyUser(DjangoUser):
    extra1 = models.CharField(..) 
```

这可能吗？[我看到了一个错误报告，说明它已在此处修复。](https://code.djangoproject.com/ticket/6032)但是，我没有看到实现此目的的正确方法的示例，也不清楚这部分是否在错误修复后是必要的：

```
manager = UserManager()
class MyUser(DjangoUser):
    signature = forms.CharField()
    post_count = forms.IntegerField()
    objects = manager
    _default_manager = manager 
```

这种行为的任何想法/例子？我试图在用户模型中重新定义“组”链接，但这导致了验证错误。理想情况下，我希望能够运行上面的示例并拥有 group1 == group2 和 type(group2) == type(MyGroup())

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T14:41:21.830

您可以动态地将新字段添加到 django 用户/组模型，这样就不会创建新的类类型。如需参考，请参阅：[http ://code.google.com/p/comaie-django-groups/source/browse/trunk/src/comaie/django/groups/models.py?r=5](http://code.google.com/p/comaie-django-groups/source/browse/trunk/src/comaie/django/groups/models.py?r=5)

```
模型.外键（
    团体，
    空=真，
    空白=真，
    related_name = '孩子'，
    详细名称 = _('父'),
    help_text = _('组的父组。无，如果是根节点。')
).contribute_to_class(组，'父')

def get_all_groups(self):
    """
    返回用户所属的所有组以及这些组的所有父组
    团体。
    """
    direct_groups = self.groups.all()
    组 = 设置（）

    对于 direct_groups 中的组：
        祖先 = group.get_ancestors().all()
        对于祖先的anc：
            groups.add(anc)
        组。添加（组）

    返回组

setattr（用户，'get_all_groups'，get_all_groups）

```

# mysql - 异常 ActiveRecord::StatementInvalid 不起作用

> ID：12064143
> 
> 赞同：0
> 
> 时间：2012-08-21T22:48:35.163
> 
> 标签：mysql, ruby-on-rails, postgresql, activerecord, exception-handling

我对 Rails 比较陌生，所以我不知道我解决问题的方法是否正确，但它存在一些问题

我已经在我的 PC 上安装了 MySQL，但 Heroku 使用的是 PostgreSQL，所以我正在设计一个解决方案，以便在某些问题上同时使用这两种 DBMS。

我有下一个代码：

```
begin
   @products_with_valid_offers = Product.joins(:variants).active.discount_valid.discount_date_valid_mySQL

   rescue ActiveRecord::StatementInvalid
      @products_with_valid_offers = Product.joins(:variants).active.discount_valid.discount_date_valid_postgreSQL
end 
```

范围是：

```
scope :active,  includes([:assets, :store]).where(:active => true, :deleted_at => nil, :stores => { :deleted_at => nil, :active => true }).order("products.created_at DESC")
scope :discount_date_valid_mySQL, where('DATE_FORMAT(NOW(),"%Y-%m-%d 23:59:59") + '" BETWEEN discount_from AND discount_to')
scope :discount_date_valid_postgreSQL, where('now()::date BETWEEN discount_from AND discount_to') 
```

如您所见，我需要两种不同的表单来管理日期格式，每个 DBMS 都有一个。问题是流程永远不会进入异常。如果@products_with_valid_offers 是 MySQL 中的 SQL 错误，则永远不要进入救援块执行 PostgreSQL 行，它会返回错误。

一些帮助，请？:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:24:50.197

你的引号搞砸了`discount_date_valid_mySQL`，你想说这个：

```
scope :discount_date_valid_mySQL, where("DATE_FORMAT(NOW(),'%Y-%m-%d 23:59:59') BETWEEN discount_from AND discount_to") 
```

这至少是有效的 Ruby 代码。

也就是说，您当前的方法在各个方面都很糟糕：

*   你确保你在生产中总是有例外。
*   您在一个数据库之上进行开发，但在另一个数据库之上进行部署，仅此一项就会给您带来各种问题。
*   您应该只`date_format(now(), '%Y-%m-%d')`在您的 MySQL 版本中使用。

可能还有其他问题，但无需花费更多时间来分解代码：有更好的方法。MySQL 和 PostgreSQL（甚至 SQLite）都支持`current_date`，所以你可以只使用一件事：

```
scope :discount_date_valid, where('current_date between discount_from and discount_to') 
```

当然，假设您希望一切都假定为 UTC。如果你想让事情使用其他时区，那么：

1.  将您的`discount_from`和存储`discount_to`为日期列，日期在 SQL 中没有时区。大概你已经这样做了，但我只是想确定一下。
2.  调整您的范围以从您的客户端代码中获取当前日期（大概配置为使用正确的时区）：

    ```
    def self.discount_date_valid
        where(':current_date between discount_from and discount_to', :current_date => Date.today)
    end 
    ```

您必须对作用域使用类方法以确保`Date.today`在正确的时间对其进行评估（即在使用作用域时而不是在加载类时）。

如果您在 PostgreSQL 之上进行部署，那么您真的应该在 PostgreSQL 之上进行开发。您甚至应该确保在相同版本的 PostgreSQL 上进行开发和部署。在一个堆栈上进行开发并在另一个堆栈上进行部署会导致各种毫无意义的挫败感和困惑。

# language-agnostic - 评论魔法

> ID：12064147
> 
> 赞同：3
> 
> 时间：2012-08-21T22:49:06.653
> 
> 标签：language-agnostic, comments

我还不是 60 级的巫师，所以我根据维基百科关于[魔法](http://en.wikipedia.org/wiki/Magic_%28programming%29#Non-orthogonality)的文章中的以下句子提出了一个问题：

> 任何对代码有影响的注释都是神奇的。

那个怎么样？这样的事情在哪些语言中是可能的？更具体地说，注释对代码有什么影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T23:19:00.327

魔术评论有多种形式。在 Ruby 中，可以在文件顶部放置注释，指定解释器在读取文件时将使用的编码：

```
# -*- coding: UTF-8 -*- 
```

[更多的](http://blog.grayproductions.net/articles/ruby_19s_three_default_encodings)

* * *

在 Unix 系统中，第一行可以是 shebang。在任何带有 octothorpes 注释的语言中，这相当于操作系统读取以决定如何解释文件的注释

```
#!/bin/bash
echo hello from bash 
```

[更多的](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)

* * *

在 Haskell 中，某些类型的注释（称为 pragma）可用于打开（或关闭）语言功能。

```
{-# LANGUAGE OverlappingInstances, NoTypeFamilies #-} 
```

[更多的](http://www.haskell.org/ghc/docs/7.2.2/html/users_guide/pragmas.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T23:15:46.020

我不会太担心维基百科中的那句话。我认为其意图只是说评论“不应该”影响行为（因为这就是评论的意思），所以如果它确实是某种特殊情况，因此根据使用的定义是“神奇的”文章的那个部分。这篇文章那一行的作者并不一定有任何特定的语言。

如果你喜欢学究气，那么注释很容易影响 C 中的程序行为（在本例中，通过包含多个换行符）：

```
#include <stdio.h>

int main() {
    /* If this multi-line comment were deleted, then
       the line-numbers in the remainder of the file
       would be smaller. Boring magic.
    */
    printf("%d\n", __LINE__);
} 
```

我很确定这*不是*该评论的作者的本意，因此该评论并不准确。注释语法的特殊情况是“神奇的”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T13:51:34.873

你也会得到那些“神奇”的评论......如果你把这些评论留在里面，那一切都会正常工作。你删除它们，然后*噗*，没有任何效果。（这些通常是由于注释部分中间的一行未注释引起的）

（评论很神奇）

# matlab - 在 Matlab 中绘制二维图后面的数据

> ID：12064149
> 
> 赞同：0
> 
> 时间：2012-08-21T22:49:31.797
> 
> 标签：matlab, plot

我有一个相当复杂的绘图问题，我认为找到解决方案会很有趣。假设我有两个地块，编号 1：

该图是使用 plotyy 创建的。

和 2 号：

该图是使用 plot3(x, y, z, '.') 创建的

现在，复杂的部分是我想获取第 2 号情节，给它加水印并将其放在第 1 号情节后面。这将导致如下结果：

实际上，我想展示的是情节 1 是由看起来像情节 2 的数据制成的。现在我无法找到如何做到这一点，所以它甚至可能不可能，但如果可以做到，那么它会成为一个很好的堆栈溢出教程！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T03:29:47.850

您可以这样做，但需要一些工作才能将轴格式化，以便它们看起来不错。

您需要做的是将一个`axes`对象放在另一个对象之上`axes`；但是，为了防止顶部`axes`遮挡底部，您需要将`'Color'`顶部`axes`对象的属性设置为`'none'`.

这是一个示例脚本，它生成类似于您正在寻找的内容

```
f = figure;
axes();
x = rand(100,3)*3 + 3;
plot3(x(:,1), x(:,2), x(:,3),'.');

axes('Color', 'none');
x = -5:5;
y = x.^2;
line(x,y, 'Color', 'r', 'LineWidth', 2); 
```

这是结果图： ![在此处输入图像描述](../Images/953f2718f7d9e2be75d9e0ac1a989a7a.png)

如果您不喜欢这个结果，您可以尝试将 3D 数据投影到 2D 中，然后将该投影绘制为线条后面的图像。这是一个关于如何创建 2D 投影[的讨论的链接。](http://www.mathworks.com/matlabcentral/newsreader/view_thread/169417)

# java - “isProbablePrime”真的需要花费大部分时间阅读文件吗？

> ID：12064153
> 
> 赞同：1
> 
> 时间：2012-08-21T22:49:45.977
> 
> 标签：java, random

我刚刚解决[了 Project Euler Problem 60](http://projecteuler.net/problem=60)，但我的程序还是有点太慢了。我发现大部分时间都花在读取文件上......

它看起来像是一直从 Linux 设备读取的`BigInteger.isProbablePrime`用途。`SecureRandom`我的问题是：

*   真的有必要使用`SecureRandom`吗？
*   `/dev/random`习惯了还是`/dev/urandom`习惯了？
*   从操作系统中读取它们真的是生成良好随机数的最佳方式吗？

AFAIK，java曾经从操作系统中获取几个字节，这些字节被用作基于SHA1的PRNG的种子，恕我直言，这应该更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:01:14.857

> 从操作系统中读取它们真的是生成良好随机数的最佳方式吗？

我不知道，`isProbablePrime`但`SecureRandom`试图通过相应的操作系统函数获得一个随机数，该函数对随机函数具有非常好的特性。
在 Linux 中，这由两个虚拟设备发生`/dev/random`，`/dev/urandom`当您从文件中读取时，这些位是不可预测的随机位，并且是根据系统发生的事件生成的。

> /dev/random 或 /dev/urandom 是否被使用？

实际上这是可配置的，您可以看到这一点。在您的 JRE中
打开该`security.properties`文件。`lib\security`那里有一个配置条目。在我的安装`/dev/urandom`中是指定的。

`/dev/random`和之间的区别在于，如果新的随机位不可用`/dev/urandom`，则`/dev/random` *阻塞*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T13:27:11.833

BigInteger 和 SecureRandom 对于 Euler 60 来说都是过度杀伤（而且速度很慢）。对于这类问题，您不需要 SecureRandom 的加密属性；普通的 Random 会非常好用。

答案中的最大数字远低于您需要使用 BigInteger 的范围。对于我的解决方案，我使用 Eratosthenes 预先计算素数，直至达到极限。这给了我足够快的主要测试。

# android - Android：SMB 文件访问崩溃

> ID：12064156
> 
> 赞同：1
> 
> 时间：2012-08-21T22:50:06.787
> 
> 标签：android, eclipse, jcifs

我正在尝试登录到我的 Windows 服务器以使用 jcifs 下载文件。该应用程序在我的 android 2.2 手机和旧的 2.3 平板电脑上运行良好。我刚刚购买了一台 Le Pan II，我升级到了 4.0.3。当我尝试运行我的应用程序时，它在尝试访问服务器时崩溃。我需要为 4.0.3 做些什么新的事情吗？我尝试注释掉与输出流有关的所有内容，以确保它是导致问题的输入端。如果我注释掉最里面的所有内容，try block 其他所有内容都可以正常工作，所以它就在里面。一旦我取消注释**InputStream in = file.getInputStream();** 然后它崩溃了。

清单文件中的权限。

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_MEDIA_STORAGE"/> 
```

下载功能

```
public static String DlFile() {
    SmbFile file = null;
    try {
        file = new SmbFile("smb://NAME:PASSWORD@10.0.0.4/jws/Data/Inspection Reports/forms/0990125.txt");

        Log.v(TAG, "smbFile: " + file.toString());
        try {
                InputStream in = file.getInputStream();
                FileOutputStream out = new FileOutputStream(cfgSDFolder + myFile);
                byte[] b = new byte[8192];
                int n;
                while(( n = in.read( b )) > 0 ) {
                    out.write( b, 0, n );
                }
                in.close();
                out.close();    
        } catch (Exception e) {
            e.printStackTrace(); 
            Log.v(TAG, "DSZerror: " + e.getMessage().toString());
            return "error: " + e.getMessage().toString();
        }
    } catch (MalformedURLException e) {
        e.printStackTrace();
        Log.v(TAG, "DSZerror:" + e.getMessage().toString());
        return "error: " + e.getMessage().toString();
    } // note the different format  
    return "ok";

} 
```

错误

```
08-21 18:39:50.548: W/dalvikvm(4604): Exception Landroid/os/NetworkOnMainThreadException; thrown while initializing Ljcifs/netbios/NbtAddress;
08-21 18:39:50.548: W/dalvikvm(4604): Exception Ljava/lang/ExceptionInInitializerError; thrown while initializing Ljcifs/UniAddress;
08-21 18:39:50.548: W/dalvikvm(4604): threadid=1: thread exiting with uncaught exception (group=0x40a871f8)
08-21 18:39:50.578: E/AndroidRuntime(4604): FATAL EXCEPTION: main
08-21 18:39:50.578: E/AndroidRuntime(4604): java.lang.ExceptionInInitializerError
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFile.getFirstAddress(SmbFile.java:864)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFile.connect(SmbFile.java:951)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFile.connect0(SmbFile.java:880)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFile.open0(SmbFile.java:972)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFile.open(SmbFile.java:1006)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFileInputStream.<init>(SmbFileInputStream.java:73)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFileInputStream.<init>(SmbFileInputStream.java:65)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.smb.SmbFile.getInputStream(SmbFile.java:2844)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.thedsz.jws.qc.DSZ.DlFile(DSZ.java:58)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.thedsz.jws.qc.Splash$2.afterTextChanged(Splash.java:99)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.widget.TextView.sendAfterTextChanged(TextView.java:7655)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.widget.TextView$ChangeWatcher.afterTextChanged(TextView.java:8057)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.SpannableStringBuilder.sendTextHasChanged(SpannableStringBuilder.java:900)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.SpannableStringBuilder.change(SpannableStringBuilder.java:353)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.SpannableStringBuilder.change(SpannableStringBuilder.java:266)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:443)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:420)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.SpannableStringBuilder.replace(SpannableStringBuilder.java:29)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.text.method.NumberKeyListener.onKeyDown(NumberKeyListener.java:117)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.widget.TextView.doKeyDown(TextView.java:5445)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.widget.TextView.onKeyDown(TextView.java:5267)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.KeyEvent.dispatch(KeyEvent.java:2566)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.View.dispatchKeyEvent(View.java:5500)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchKeyEvent(PhoneWindow.java:1879)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.android.internal.policy.impl.PhoneWindow.superDispatchKeyEvent(PhoneWindow.java:1361)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.app.Activity.dispatchKeyEvent(Activity.java:2324)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1806)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewRootImpl.deliverKeyEventPostIme(ViewRootImpl.java:3327)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2597)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.os.Looper.loop(Looper.java:137)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.app.ActivityThread.main(ActivityThread.java:4424)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at java.lang.reflect.Method.invokeNative(Native Method)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at java.lang.reflect.Method.invoke(Method.java:511)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at dalvik.system.NativeStart.main(Native Method)
08-21 18:39:50.578: E/AndroidRuntime(4604): Caused by: java.lang.ExceptionInInitializerError
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.UniAddress.<clinit>(UniAddress.java:62)
08-21 18:39:50.578: E/AndroidRuntime(4604):     ... 43 more
08-21 18:39:50.578: E/AndroidRuntime(4604): Caused by: android.os.NetworkOnMainThreadException
08-21 18:39:50.578: E/AndroidRuntime(4604):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at java.net.InetAddress.lookupHostByName(InetAddress.java:391)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at java.net.InetAddress.getLocalHost(InetAddress.java:371)
08-21 18:39:50.578: E/AndroidRuntime(4604):     at jcifs.netbios.NbtAddress.<clinit>(NbtAddress.java:187)
08-21 18:39:50.578: E/AndroidRuntime(4604):     ... 44 more 
```

# collections - 如何获取具有额外属性的集合中的项目

> ID：12064161
> 
> 赞同：0
> 
> 时间：2012-08-21T22:50:56.050
> 
> 标签：collections, backbone.js, backbone-views

我目前在集合中为用户获取一个项目，如下所示：

```
me.user = Backbone.Collection.Users.collection().get(id); 
```

这将返回应用程序所需的默认属性集。在用户个人资料页面上，我想显示其他任何地方都不需要的其他属性。

如何使用我可以指定的其他属性获取集合（查询服务器）中的项目？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T07:35:33.523

集合是否已经是一个实例，我假设是这样？如果是这样，你应该只做：

```
me.user = Backbone.Collection.Users.collection.get(id); 
```

即收集后删除括号（）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T07:16:08.050

因此，根据评论，我认为您想要的是生成额外的模型，而不是创建两个用户模型，一个具有冗余 + 额外数据。

你可以做到这一点的一种方法是给出不同模型之间的关系。

假设`user`模型仅包含名称和电子邮件。这很好，但您还想在页面上呈现用户配置文件（或您想要的任何“额外”。）这似乎是创建一个代表您想要的额外数据的单独模型的好机会。

你可以通过几种方式做到这一点。例如，如果每个用户都有一个配置文件，您可以将其烘焙到您的用户模型中。比如当你创建一个用户模型时：

```
user.profile = new Profile();  // model 
```

我见过一些人将其他模型放入模型的属性中`user.set('profile', new Profile())`，但我不确定这是否是个好主意。我喜欢将我的模型属性与该模型隔离。

每个配置文件模型都有一个对应于 model.id 的 url。

因此，您可以只使用 user.profile.fetch() 并使用该配置文件属性来填充视图中的数据。也许它会做类似 /user/1/profile 的事情

关于您的问题，我认为您可能会提到的另一个方面是在您获取集合时一次性从服务器发送数据。也许您的服务器会回复如下数据：

```
[{"name":"Jake", "email":"j@stack.com", "profile":"{"aboutme":"Some story"}"}, ... ] 
```

并且配置文件数据仅适用于拥有它的人等。在这种情况下，您可以使用该`parse()`功能提取额外的数据并在将名称和电子邮件属性发送到模型集方法之前做一些事情。

虽然，最近我认为我读到使用解析来处理额外数据是不好的形式。[覆盖集](https://stackoverflow.com/questions/7607921/backbone-js-collection-create-and-overridden-model-set)因此，您可能只想将其保存为命名空间，然后在覆盖的 set 方法中执行以下操作，而不是解析：

```
set: function(attributes, options) {

    if (!_.isUndefined(this.profile) && attributes.profile) {
        this.profile = new Profile();
        this.profile.set(attributes.profile);
    } else if (attributes.profile) {
        this.profile.set(attributes.profile);
    }

    delete attributes.profile;

    return Backbone.Model.prototype.set.call(this, attributes, options);
} 
```

您可以为真正独特的用户（例如使用您的应用程序的主要用户）做类似的事情。当我为我的应用程序（代表用户他/她自己的用户模型）实例化一个用户模型时，我还初始化了一些其他只有用户才会拥有的特殊模型（例如用于获取身份验证数据的身份验证模型等）

我不确定我是否击中了你的要求，但我希望我击中了一些东西。

# jquery - e.preventDefault 防止点击

> ID：12064164
> 
> 赞同：3
> 
> 时间：2012-08-21T22:51:17.750
> 
> 标签：jquery

我有以下代码来测试 e.preventDefault() 的工作原理。我认为它会阻止点击事件的发生。

```
 $(document).ready(function( )
     {

       $("button").click(function(e)
       {

         e.preventDefault();  

          alert('button clicked');

       });

      }); 
```

我有一个按钮。e.preventDefault() 的目的是什么。从我读到的内容来看，它将阻止在这种情况下是点击的动作。

请注意，在上面的示例中，警报消息仍然显示。e.preventDefault() 如何为按钮单击工作。我知道如果它是一个超链接，它会阻止超链接指向它的目标。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T22:54:52.360

preventDefault 是防止默认的浏览器动作。因此，如果您要输入以下内容：

```
$("a").click(function(e){e.preventDefault();}) 
```

单击链接将无济于事。或在提交按钮上 - 不会提交表单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T22:53:50.307

它阻止的是接收“点击”的 DOM 对象。因此，如果您的按钮是提交表单，则现在不会提交。`alert()`不管你说什么，之后都会被执行，嘿！停止点击，然后执行此操作！

**更多阅读**

*   [http://www.quirksmode.org/js/introevents.html](http://www.quirksmode.org/js/introevents.html)
*   [https://developer.mozilla.org/en-US/docs/DOM/event.preventDefault](https://developer.mozilla.org/en-US/docs/DOM/event.preventDefault)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T22:55:18.317

它无法阻止点击的发生，因为您设置了一个在事件触发*后执行的事件处理程序。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T22:56:29.347

`$.preventDefault();`将阻止“默认”操作的发生。例如，如果您使用已经`href`分配了一个锚链接，然后将其添加`preventDefault();`到所述锚，它将不再链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T22:57:29.027

You need to remember that without adding your own Click callback function there is still an Event that will fire in the browser - e.g. for an "a" tag this would be to load the URL in the href attribute, for a submit button it would be to Post/Get to the URL in the Form "Action" attribute - in both cases e.preventDefault() would stop this happening

# c# - 如何在 ASP.Net MVC 控制器中正确使用 ServiceStack 身份验证

> ID：12064166
> 
> 赞同：14
> 
> 时间：2012-08-21T22:51:23.583
> 
> 标签：c#, authentication, forms-authentication, asp.net-mvc-4, servicestack

我在获取 ServiceStack [Authentication] 属性以在 ASP.Net MVC4 控制器中工作时遇到问题，即使正确提交了登录详细信息，具有该属性的页面/操作方法也会将用户重定向到登录页面。

我遵循了 SocialBootstrapApi 示例，不同之处在于所有身份验证 Web 服务调用都是从控制器进行的：

```
this.CreateRestClient().Post<RegistrationResponse>("/register", model); 
```

到目前为止我做过的其他事情：

*   使用我自己的用户会话实现子类化 AuthUserSession（与示例没有太大区别，但使用我自己的 User 表实现）
*   在我的 BaseController 上继承 ServiceStackController，覆盖默认登录 URL
*   使用我的用户会话实现在 AppHost 中启用身份验证功能

注册确实有效，用户身份验证逻辑有效（即使会话不存在），我可以在请求中看到`ss-id`和`ss-pid`cookie。

所以我的完整问题清单：

1.  如何使 [Authenticate] 属性起作用（或者，我做错了什么）？
2.  如何在 MVC 控制器中保存和重用用户会话？目前`this.UserSession`始终为空。
3.  如何注销用户？`this.CreateRestClient().Get<AuthResponse>("/auth/logout");`似乎不起作用。

* * *

**更新 1：**在提交任何凭据之前，当我尝试加载受保护的页面（具有 [Authenticate] 属性的页面）时，会创建
会话 cookie（`ss-id`和）。`ss-pid`这是预期的行为吗？

**更新 2：**
我可以看到会话保存在 中`MemoryCacheClient`，但是尝试通过`this.Cache.Get<CustomUserSession>(SessionKey)`返回 null 在基本控制器中检索它（其中 SessionKey 就像`urn:iauthsession:1`：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T04:06:47.453

经过一番摆弄，显然挂钩 ServiceStack 身份验证的方法是通过以下方式调用 AuthService：

```
try {
    authResponse = AuthService.Authenticate(new Auth{ UserName = model.UserName, Continue = returnUrl, Password = model.Password });
} catch (Exception ex) {
    // Cut for brevity...
} 
```

而**不是** `authResponse = this.CreateRestClient().Post<AuthResponse>("/auth/credentials", model);`！

在`AuthService`基本控制器中定义为：

```
public AuthService AuthService
{
    get
    {
        var authService = ServiceStack.WebHost.Endpoints.AppHostBase.Instance.Container.Resolve<AuthService>();
        authService.RequestContext = new HttpRequestContext(
            System.Web.HttpContext.Current.Request.ToRequest(),
            System.Web.HttpContext.Current.Response.ToResponse(),
            null);

        return authService;
    }
} 
```

其他一切（包括会话）现在都可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T11:47:55.743

您可以在[ServiceStack 用例](https://github.com/ServiceStack/ServiceStack.UseCases)存储库中找到它是如何完成的。以下示例基于 MVC4，但也适用于 MVC3：[CustomAuthenticationMvc](https://github.com/ServiceStack/ServiceStack.UseCases/tree/master/CustomAuthenticationMvc)。

# ruby-on-rails - 元搜索多列排序不起作用

> ID：12064167
> 
> 赞同：0
> 
> 时间：2012-08-21T22:51:26.320
> 
> 标签：ruby-on-rails, sorting, meta-search

我正在尝试使用元搜索 gem 进行多列排序，但它不起作用。

我是通过一些 AJAX 来做的，所以我`Model.search()`直接打电话。我认为我做得对，但我不是 100% 确定，因为我似乎找不到关于“meta_sort”参数应该是什么的好文档。

这就是我实际上所说的，我的模型是“贸易”：

```
Trade.search("meta_sort"=>"exch.asc,fcondt.asc") 
```

它应该是一个数组而不是一个 csv 字符串吗？

我知道这适用于单列排序，例如

```
Trade.search("meta_sort"=>"exch.asc") 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T14:44:38.840

您可以按多列排序，但单方向，“asc”方向是默认值：

同一张表的字段语法：

`{"meta_sort"=>"exch_and_fcondt.desc"}`

来自不同表的字段的语法应该是：

`{"meta_sort"=>"table1_exch_and_table2_fcondt.desc"}`

# java - java.net.socket 实现

> ID：12064170
> 
> 赞同：0
> 
> 时间：2012-08-21T22:51:53.357
> 
> 标签：java, sockets, io

在 linux 上，我假设 Java 套接字最终调用 glibc 套接字。

这两层之间的交互是如何发生的？它类似于 JNI 调用还是有一些特殊的更快的方法可以从 Java 访问 glibc 函数？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:46:39.273

套接字由内核实现，系统调用函数包装器由 JVM 实现者碰巧使用的任何 C 库提供。Java 通过 JNI 调用 C 库，C 库通过系统调用软件中断调用内核。尽管实现细节可能有所不同，但 JDK 之间的此过程在概念上没有区别。

> glibc 套接字

真的没有这样的事情。套接字函数是系统调用。glibc 所做的只是提供 C 包装器。

# node.js - nodejs使用setuid从root降级，日志文件所有权呢？

> ID：12064171
> 
> 赞同：4
> 
> 时间：2012-08-21T22:51:59.690
> 
> 标签：node.js

我大致遵循了[http://onteria.wordpress.com/2011/05/31/dropping-privileges-using-process-setuid-in-node-js/](http://onteria.wordpress.com/2011/05/31/dropping-privileges-using-process-setuid-in-node-js/)中描述的方案，我以 root 身份启动节点，然后降级用户。这样我就可以在不需要代理的情况下收听 80。很标准的东西。我有一个新贵脚本来管理进程（Ubuntu 服务器）。

upstart 脚本将 stdout/err 重定向到日志文件（由 root 拥有）。在内部，我使用 winston 登录到控制台和一个文件（该文件也归 root 所有）。

在我完美而快乐的世界中，我将能够透明地将日志文件（重定向的 stdout/err 和 winston 制作的）透明地发送给降级的用户。当我从节点应用程序内部进行设置时，我尝试（天真地）咀嚼它们，这有效，但意味着它们再也不会被写入。

我怎样才能做到这一点？这是可能的还是我应该尝试使用（至少一些）root 拥有的日志文件？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:09:09.577

我最终得到的是 Peter Lyons 解决方案的一个版本（我已经从几个地方剪切了以下内容，所以它可能实际上并没有运行；这个想法虽然有效）：

```
var logger = new (winston.Logger)();
logger.add(winston.transports.Console, {
  timestamp: true
});

// start server and downgrade user
httpsServer.listen(443, function() {
  logger.info('Ready on port 443');
  fs.stat(__filename, function(err, stats) {
    fs.chownSync('stdouterr.log',stats.uid,stats.gid);
    process.setgid(stats.gid);
    process.setuid(stats.uid);
    logger.add(winston.transports.File, { 
      filename: 'mylogfile.log',
      handleExceptions: true
    });
    logger.info('downgraded to non-root uid', {"uid":stats.uid});
  });
}); 
```

当我成功绑定到端口 443 时，我会记录下来。`logger`是一个仅配置了控制台输出的 winston 记录器（通过使用启动节点将其重定向到 stdouterr.log 文件`node app.js >> stdouterr.log 2>&1`）。所以这个日志信息只出现在`stdouterr.log`.

然后我确定当前文件的所有者并 chown stdouterr.log 由该用户拥有。然后我设置当前进程的gid和uid（删除权限部分）。

然后我将我的文件日志添加到winston logger。

最后，我登录说我已经降级了用户。此消息同时出现在`stdouterr.log`和`mylogfile.log`中。

不像我希望的那么漂亮（进程以 root 身份运行时没有文件日志记录），但这意味着日志文件易于保护和管理。

# javascript - 绕过我自己计算机上的浏览器安全限制

> ID：12064182
> 
> 赞同：0
> 
> 时间：2012-08-21T22:53:41.917
> 
> 标签：javascript, security, code-access-security

我正在尝试通过它们在维基百科中的前缀（en，fr，es，...）创建语言方向列表（从左到右或从右到左。维基百科中不存在其他方向）。为此，我编写了一个可以在[此页面](http://meta.wikimedia.org/wiki/List_of_Wikipedias)上执行的 JS 代码，并将数据存储在一个变量中。该代码打开每个 Wikipedia 的主页，并尝试根据其`<html>`元素的 'dir' 属性检查语言的方向。但是，由于每个 Wikipedia 都有不同的域，出于安全原因，浏览器不会让我访问这些数据。有没有这样的浏览器？是否可以更改我的偏好以启用它？

PS 代码：

```
var as = document.querySelectorAll('a.extiw'), pre, win, dirByPre = {};
for each (var a in as)
   if (pre = /^http:\/\/(\w+)\.wikipedia\.org\/wiki\/$/.exec(a.href)) {
      win = open(pre[0]);
      win.onload = function () {
         opener.dirByPre[pre[1]] = document.documentElement.dir;
         close();
      };
   } 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:12:54.693

这可能是一个奇怪的解决方案，但您可以编写一个浏览器扩展来允许您发出跨域请求。有一些简单的方法可以开发扩展，例如 Crossrider，它有一个[X-Domain 插件](http://crossrider.com/apps/11605/ide)，允许您通过 Javascript 发出跨域请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:07:51.477

现代浏览器通常不允许这样做是有原因的。当允许任意 JavaScript 访问其他域时，存在许多安全问题。一个例子是[XSS（跨站点脚本）](http://en.wikipedia.org/wiki/Cross-site_scripting)。

如果您不尝试在浏览器中运行脚本，那么您尝试做的事情会容易*得多*。Python、Ruby 或任何其他脚本语言确实可以使用单独的 HTTP 请求轻松完成此操作。如果您了解 JavaScript，那么[Node.JS](https://stackoverflow.com/questions/4294939/http-request-with-node)怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:17:15.290

您遇到的是访问控制允许来源错误。阅读它，[访问控制允许来源不允许](https://stackoverflow.com/questions/9327218/access-control-allow-origin-not-allowed-by)。

一般来说，如果你想访问另一个页面的数据以在 JS 中使用，你需要在你自己的服务器上这样做并将其传递给 Javascript。

但是，在这种情况下，最好的解决方案是通过其 API 访问 Wikipedia 并请求 JSONP 响应。请记住，维基百科是建立在 MediaWiki 之上的，因此请参阅其 API 文档[http://www.mediawiki.org/wiki/API:Main_page](http://www.mediawiki.org/wiki/API:Main_page)。

```
title = "List_of_Wikipedias"; 

$.getJSON("http://en.wikipedia.org/w/api.php?action=query&prop=revisions&rvprop=content&titles="+title+"&format=json&callback=?", function(data) {
    console.log(data);
}) 
```

注意“format=json”和“callback=?”

这种 JSONP 方法适用于所有现代浏览器。

# c++ - 谁能告诉我为什么结果是 7 7 7 而不是 7 7 10？

> ID：12064185
> 
> 赞同：-1
> 
> 时间：2012-08-21T22:53:54.550
> 
> 标签：c++

```
#include <iostream>
using namespace std;
int *wedgic(int foo)
{
    cout<<foo;
    return (&foo);
}

int main()
{
    int fo=7;
    int *blah;
    blah=wedgic(fo);
    (*blah)+=3;
    wedgic(fo);
} 
```

谁能告诉我为什么结果是 7 7 7 而不是 7 7 10？

请帮忙，我想我不明白 Blah=wedgic(fo); 是什么意思 做...

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T22:58:33.410

首先，您的函数`wedgic`返回一个指向其局部变量的指针`foo`。`wedgic`函数终止后指针立即变为无效。任何使用返回的指针值的尝试都会导致未定义的行为。换句话说，您的程序不会产生有意义的结果。行为未定义。无论您在那里看到什么（`7 7 7`或其他任何东西）都只是一个没有有意义的解释的意外。

其次，您的程序只尝试*两次输出任何内容。*然而你声称它以某种方式输出*了三个*数字。这是极不可能的，即使对于具有未定义行为的程序也是如此。要么是您对输出的声明是错误的，要么是您发布了假代码。当您询问有关某些代码产生的结果的问题时，请发布真实代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T22:58:18.953

问题是它`wedgic()`返回一个指向它自己的局部变量的指针，而不是`fo`你在`main()`.

变量`foo`in`wedgic()`是一个非静态局部变量，这意味着它的生命周期不会超出对该函数的调用。返回指向这样一个变量的指针是完全错误的，因为一旦在函数外部使用指针，它指向的东西就不再存在。

因此

```
(*blah)+=3; 
```

是无效的，实际上是危险的。

# c# - C#在返回对象列表时运行函数

> ID：12064188
> 
> 赞同：0
> 
> 时间：2012-08-21T22:54:11.047
> 
> 标签：c#, function, while-loop

我的 C# 函数一次返回 100 个列表对象。我想填写一个列表，直到这个函数不返回任何列表。

我正在尝试做这样的事情：

```
int lastSelectedId = 0;
while(ReturnListOfCustomers(lastSelectedId).Count > 0)
{
    List<Customers> newCustomers = ReturnListOfCustomers(lastSelectedId);
    CustomerList.Append(newCustomers);
    lastSelectedId  = newCustomers.Last().rowid;
} 
```

...但在这种情况下，我将不得不在`ReturnListOfCustomers`每个循环中调用两次函数，我可以通过一次调用一个来使其更好吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T22:57:00.400

你可以使用 do/while

```
int lastSelectedId = 0;
int count;
do 
{
    List<Customers> newCustomers = ReturnListOfCustomers(lastSelectedId);
    count = newCustomers.Count;
    if (count > 0)
    {
        CustomerList.Append(newCustomers);
        lastSelectedId  = newCustomers.Last().rowid;
    }
} while (count > 0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T22:59:05.500

为了删除每个循环的两个调用，您必须将结果存储在一个变量中。我也会像这样重构你的代码：

```
int lastSelectedId = 0;
List<Customers> newCustomers;

while ((newCustomers = ReturnListOfCustomers(lastSelectedId)).Count > 0)
{
    CustomerList.Append(newCustomers);
    lastSelectedId  = newCustomers.Last().rowid;
} 
```

至少在我看来，我认为它看起来比 do-while 循环更好。另一方面，do-while 循环可能更易于阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T22:58:23.737

将第一次调用的结果存储在变量中。

```
int lastSelectedId = 0;
var a = ReturnListOfCustomers(lastSelectedId);
while(a.Count > 0)
{
    List<Customers> newCustomers = a;
    CustomerList.Append(newCustomers);
    lastSelectedId  = newCustomers.Last().rowid;
    a = ReturnListOfCustomers(lastSelectedId);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T22:58:57.310

您可以通过将`newCustomers`列表移到循环之外来减少命中，然后在完成附加后在每个循环中更新一次列表。

```
int lastSelectedId = 0;
List<Customers> newCustomers = ReturnListOfCustomers(lastSelectedId);
while (newCustomer.Count > 0)
{
    CustomerList.Append(newCustomers);
    lastSelectedId = newCustomers.Last().rowid;
    newCustomers = ReturnListOfCustomers(lastSelectedId);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T23:18:36.473

只需检查*您的*列表是否增长：

```
 // Assuming CustomerList is a List<Customers> defined and initialized somewhere
 int prevCount = -1;
 int lastSelectedId = 0;
 while (prevCount < CustomerList.Count) {
  prevCount = CustomerList.Count;
  CustomerList.Append(ReturnListOfCustomers(lastSelectedId));

  // Need to check for null return condition
  if (CustomerList.Count > 0) {
    lastSelectedId = CustomerList.Last().rowId;
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T23:15:49.243

一个简单的`for`循环有什么问题？

```
for ( List<Customer> buffer = ReturnListOfCustomers(highWaterID) ; buffer.Count > 0 ; buffer = ReturnListOfCustomers( buffer[buffer.Count-1].rowid ) )
{
  CustomerList.Append(buffer);
} 
```

# linux - 如果在 Linux (Ubuntu) 中安装或卸载了任何其他程序，如何获取程序事件？

> ID：12064194
> 
> 赞同：1
> 
> 时间：2012-08-21T22:55:03.943
> 
> 标签：linux, events, gtk

如果在 Linux (Ubuntu) 中安装或卸载了任何其他程序，如何获取程序事件？有这方面的 GTK 服务吗？我的程序永久驻留在内存中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T08:26:09.797

据我所知，这是不存在的。在像 Ubuntu 这样的 Debian 衍生产品上，安装是`dpkg`使用`apt-get`. 您可以尝试的一种解决方案是轮询`/var/log/dpkg.log`. 这会列出（未）安装的软件包，以及日期和时间。如果您每分钟醒来都这样做，那么您将不会落后于变化数英里。该文件归根用户所有，在我的系统上的权限为 0644。也许偏执的管理员会在 0600 拥有它，在这种情况下，我唯一能想到的就是反复运行`dpkg -l`并寻找更改。在我的系统上，每次运行大约需要 0.1 秒，所以这也不是完全疯狂的。

# ios - Box2D 缩放说明

> ID：12064195
> 
> 赞同：0
> 
> 时间：2012-08-21T22:55:18.043
> 
> 标签：ios, cocos2d-iphone, box2d, scale, ccsprite

我在我的应用程序中使用 Box2D 形状顶点，我已经实现了它，如下所示：

```
b2Vec2 verts[] = {
            b2Vec2(-25.6f / PTM_RATIO) *scale, (50.7f / PTM_RATIO) *scale),
            b2Vec2(-20.6f / PTM_RATIO) *scale, (-48.0f / PTM_RATIO) *scale),
            b2Vec2(27.3f / PTM_RATIO) *scale, (-48.0f / PTM_RATIO) *scale),
            b2Vec2(21.5f / PTM_RATIO) *scale, (51.5f / PTM_RATIO) *scale),
            b2Vec2(-26.8f / PTM_RATIO) *scale, (49.8f / PTM_RATIO) *scale) };
        spriteShape.Set(verts, num); 
```

现在显然我的顶点被缩放到“比例”，即我的 CCSprite 的比例。现在我是否还必须缩放 b2Body 或其他东西？目前，我不是，我认为这就是为什么当我使用调试绘图时，我的尺寸是倾斜的。我不需要任何复杂的答案，它只是一个是或否的问题。:)

另外作为一个快速的附带问题，如果我有一个包含我的一个图像的顶点值的 PLIST，我是否需要一个仅用于 iPhone 或 iPhone 和 iPad 的 PLIST，或者所有 4 种可能性，视网膜和非视网膜两者设备？

任何人都可以澄清这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T08:08:13.363

是的。如果你缩放你的精灵（例如通过 scale 属性），你也必须缩放 Box2D 形状。

由于 Retina 设备以点为单位使用相同的屏幕尺寸（即 Retina iPhone 上的 480x320 点），因此 Retina 和非 Retina 设备只需要一种形状。事实上，除非您缩放 iPad 游戏的资产，否则您也可以在 iPad 和 iPad Retina 上使用相同的形状。

# sql - 在 SQL 查询中将 24 小时格式转换为 12 小时 AM/PM 格式

> ID：12064197
> 
> 赞同：1
> 
> 时间：2012-08-21T22:55:19.667
> 
> 标签：sql, ms-query

我知道有几个问题与我的类似，但我需要具体细节。在 Microsoft Query 中使用 SQL，我有一个生成类似结果的时间列，`1900-01-01 13:30:00:0000000`我需要将其转换为只生成一个`1:30PM`结果。

现在，我的专栏是`ODS_COURSE_SECTION_MTG.CSM_START_TIME`，所以我需要知道，当我在“编辑列”中时，“字段”中要输入的内容和确切的内容。

我已经做好了

```
CONVERT(TIME, ODS_COURSE_SECTION_MTG.CSM_START_TIME) 
```

但这只会产生`13:30:00:0000000`结果。

请帮忙！请准确告诉我如何编辑该列以获得`1:30PM`结果。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:15:19.707

数据是否存储为[TIME](http://msdn.microsoft.com/en-us/library/bb677243.aspx)字段？如果是这样，那么这应该可以工作（完整的例子，你可以明白我的意思）：

```
DECLARE @t TIME
SET @t = GETDATE()
SELECT CONVERT(VARCHAR, @t, 100) 
```

所以你的代码应该是：

```
SELECT CONVERT(VARCHAR, ODS_COURSE_SECTION_MTG.CSM_START_TIME, 100) 
```

# c++ - 反对按位运算进行 int 强制转换

> ID：12064200
> 
> 赞同：1
> 
> 时间：2012-08-21T22:55:36.050
> 
> 标签：c++, casting, bit-manipulation, xor

大家好，这是我第二次尝试解释 C++ 代码（我是一个非常新手），我只想确定以下 C++ 代码的含义：

```
//| Get other endpoint of an edge  |  
//+--------------------------------+    
inline Node *Node::NextNode( Edge *next)  
   {  
   return (Node *) ((!next) ? NULL : ( (int)next->node[0] ^ (int)next->node[1] ^ (int)this ) );  
   } 
```

代码是否意味着将对象转换/转换为 int，`next->node[0]`并将`next->node[1]`XOR 运算符应用于它们的位值？并使用结果作为参考作为`Node*`回报？提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:00:20.397

是的。（虽然你也忽略了三元和这个的演员表）

请记住，除非您非常小心，否则此类代码可能具有未定义的行为并且不可移植（例如，在 x86-64 上，指针大于整数。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T23:08:08.070

我最好的猜测是它`Edge`代表两个`Node`s 之间的边缘，定义如下

```
struct Edge {
    Node *node[2];
    // perhaps other fields
} 
```

`node`必须填写其中的两个元素。它们可能指向不同的节点，或者至关重要的是，可能指向同一个节点。

更重要的是，`Node::NextNode()`必须只传递一个`Edge`对象，该对象包含节点本身作为`node`边缘上的两个元素之一（或者可以传递 NULL）。

鉴于此，这个函数基本上相当于

```
if (next) {
    if (next->node[0] == next->node[1]) return this;
    if (next->node[0] == this) return next->node[1];
    return next->node[0];
}
return NULL; 
```

尽管正如 Antimony 所指出的那样，它实际上是有问题的，因为它`int`在指针大于 int 的任何架构上都将表现不正确。当然，如果您不满足不变量（例如，您传入一个`Edge`不包含节点作为其两个`node`s 中的任何一个的节点），该函数的行为当然会不正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:01:24.047

你的解释是正确的。这是非常奇怪的代码。通常不会将某些整数异或在一起并将结果视为指针。

查看声明附近的头文件`node`，看看该字段编码的内容。如果没有这样的注释，请尽快远离此代码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T00:14:50.970

```
(int)next->node[0] ^ (int)next->node[1] ^ (int)this 
```

鉴于 next->node[0] 和 [1] 显然是指针，在隔离中看到它们的 XOR 提供了一个无意义的值（除了在它们相等的平凡情况下），但是考虑到 XORing`this`产生有意义的东西的期望，我假设已知 node[] 值之一是`this`，这样我们就剩下不是 的`this`。换句话说，对于这种情况，代码可能等同于：

```
next->node[next->node[0] == this] 
```

（或者如果这有点神秘，您可能更喜欢`next->node[next->node[0] == this ? 1 : 0]`; 在 C++中，当需要一个数字时`true`转换为 1 和`false`0）

源代码*“获取边缘的其他端点”*中的注释似乎支持这一点：显然知道这`this`是一个端点，并且代码找到了“其他”端点......

另一种会产生有效指针的情况是当两者`node[0]`和`node[1]`相同时，在这种情况下`this`返回。如果打算支持这种情况（而不仅仅是实现的巧合），那么上面建议的简化将失败。你可以试试：

```
next->node[0] == next->node[1] ? this : next->node[next->node[0] == this] 
```

如果对运行时数据是否可以包含两个相同的节点值有任何疑问，那么这种替换会更安全。

正如其他人指出的那样，代码假定指针的大小与 相同`int`，这非常讨厌！我不会讨论它，因为它在其他地方已经死了，但请记住它。

# r - 一次调用按组对多个变量应用多个汇总函数

> ID：12064202
> 
> 赞同：99
> 
> 时间：2012-08-21T22:55:50.790
> 
> 标签：r, aggregate, r-faq

我有以下数据框

```
x <- read.table(text = "  id1 id2 val1 val2
1   a   x    1    9
2   a   x    2    4
3   a   y    3    5
4   a   y    4    9
5   b   x    1    7
6   b   y    4    4
7   b   x    3    9
8   b   y    2    8", header = TRUE) 
```

我想计算按 id1 和 id2 分组的 val1 和 val2 的平均值，并同时计算每个 id1-id2 组合的行数。我可以分别执行每个计算：

```
# calculate mean
aggregate(. ~ id1 + id2, data = x, FUN = mean)

# count rows
aggregate(. ~ id1 + id2, data = x, FUN = length) 
```

为了在一次通话中完成这两项计算，我尝试了

```
do.call("rbind", aggregate(. ~ id1 + id2, data = x, FUN = function(x) data.frame(m = mean(x), n = length(x)))) 
```

但是，我得到一个乱码输出和一个警告：

```
#     m   n
# id1 1   2
# id2 1   1
#     1.5 2
#     2   2
#     3.5 2
#     3   2
#     6.5 2
#     8   2
#     7   2
#     6   2
# Warning message:
#   In rbind(id1 = c(1L, 2L, 1L, 2L), id2 = c(1L, 1L, 2L, 2L), val1 = list( :
#   number of columns of result is not a multiple of vector length (arg 1) 
```

我可以使用 plyr 包，但我的数据集非常大，当数据集的大小增加时，plyr 非常慢（几乎无法使用）。

如何使用`aggregate`或其他函数在一次调用中执行多个计算？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2012-08-21T23:07:16.970

您可以一步完成所有操作并获得正确的标签：

```
> aggregate(. ~ id1+id2, data = x, FUN = function(x) c(mn = mean(x), n = length(x) ) )
#   id1 id2 val1.mn val1.n val2.mn val2.n
# 1   a   x     1.5    2.0     6.5    2.0
# 2   b   x     2.0    2.0     8.0    2.0
# 3   a   y     3.5    2.0     7.0    2.0
# 4   b   y     3.0    2.0     6.0    2.0 
```

这将创建一个具有两个 id 列和两个矩阵列的数据框：

```
str( aggregate(. ~ id1+id2, data = x, FUN = function(x) c(mn = mean(x), n = length(x) ) ) )
'data.frame':   4 obs. of  4 variables:
 $ id1 : Factor w/ 2 levels "a","b": 1 2 1 2
 $ id2 : Factor w/ 2 levels "x","y": 1 1 2 2
 $ val1: num [1:4, 1:2] 1.5 2 3.5 3 2 2 2 2
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : NULL
  .. ..$ : chr  "mn" "n"
 $ val2: num [1:4, 1:2] 6.5 8 7 6 2 2 2 2
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : NULL
  .. ..$ : chr  "mn" "n" 
```

正如下面@lord.garbage 所指出的，这可以通过使用转换为具有“简单”列的数据框`do.call(data.frame, ...)`

```
str( do.call(data.frame, aggregate(. ~ id1+id2, data = x, FUN = function(x) c(mn = mean(x), n = length(x) ) ) ) 
    )
'data.frame':   4 obs. of  6 variables:
 $ id1    : Factor w/ 2 levels "a","b": 1 2 1 2
 $ id2    : Factor w/ 2 levels "x","y": 1 1 2 2
 $ val1.mn: num  1.5 2 3.5 3
 $ val1.n : num  2 2 2 2
 $ val2.mn: num  6.5 8 7 6
 $ val2.n : num  2 2 2 2 
```

这是 LHS 上多个变量的语法：

```
aggregate(cbind(val1, val2) ~ id1 + id2, data = x, FUN = function(x) c(mn = mean(x), n = length(x) ) ) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-08-22T08:49:54.170

鉴于问题中的这一点：

> 我可以使用 plyr 包，但我的数据集非常大，当数据集的大小增加时，plyr 非常慢（几乎无法使用）。

然后在[`data.table`](https://github.com/Rdatatable/data.table/wiki)( `1.9.4+`) 你可以尝试：

```
> DT
   id1 id2 val1 val2
1:   a   x    1    9
2:   a   x    2    4
3:   a   y    3    5
4:   a   y    4    9
5:   b   x    1    7
6:   b   y    4    4
7:   b   x    3    9
8:   b   y    2    8

> DT[ , .(mean(val1), mean(val2), .N), by = .(id1, id2)]   # simplest
   id1 id2  V1  V2 N
1:   a   x 1.5 6.5 2
2:   a   y 3.5 7.0 2
3:   b   x 2.0 8.0 2
4:   b   y 3.0 6.0 2

> DT[ , .(val1.m = mean(val1), val2.m = mean(val2), count = .N), by = .(id1, id2)]  # named
   id1 id2 val1.m val2.m count
1:   a   x    1.5    6.5     2
2:   a   y    3.5    7.0     2
3:   b   x    2.0    8.0     2
4:   b   y    3.0    6.0     2

> DT[ , c(lapply(.SD, mean), count = .N), by = .(id1, id2)]   # mean over all columns
   id1 id2 val1 val2 count
1:   a   x  1.5  6.5     2
2:   a   y  3.5  7.0     2
3:   b   x  2.0  8.0     2
4:   b   y  3.0  6.0     2 
```

对于时间比较`aggregate`（用于问题和所有其他 3 个答案）以`data.table`查看 [此基准](https://stackoverflow.com/questions/11533438/why-is-plyr-so-slow)（`agg`和`agg.x`案例）。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-12-12T14:20:54.880

使用该`dplyr`包，您可以通过使用`summarise_all`. 使用此汇总函数，您可以将其他函数（在本例中为`mean`和`n()`）应用于每个非分组列：

```
x %>%
  group_by(id1, id2) %>%
  summarise_all(funs(mean, n())) 
```

这使：

```
 id1    id2 val1_mean val2_mean val1_n val2_n
1      a      x       1.5       6.5      2      2
2      a      y       3.5       7.0      2      2
3      b      x       2.0       8.0      2      2
4      b      y       3.0       6.0      2      2 
```

如果您不想将函数应用于所有非分组列，请指定应应用它们的列，或者使用该`summarise_at()`函数用减号排除不需要的列：

```
# inclusion
x %>%
  group_by(id1, id2) %>%
  summarise_at(vars(val1, val2), funs(mean, n()))

# exclusion
x %>%
  group_by(id1, id2) %>%
  summarise_at(vars(-val2), funs(mean, n())) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-08-21T23:13:13.370

您可以添加一`count`列，与 聚合`sum`，然后缩小以获取`mean`：

```
x$count <- 1
agg <- aggregate(. ~ id1 + id2, data = x,FUN = sum)
agg
#   id1 id2 val1 val2 count
# 1   a   x    3   13     2
# 2   b   x    4   16     2
# 3   a   y    7   14     2
# 4   b   y    6   12     2

agg[c("val1", "val2")] <- agg[c("val1", "val2")] / agg$count
agg
#   id1 id2 val1 val2 count
# 1   a   x  1.5  6.5     2
# 2   b   x  2.0  8.0     2
# 3   a   y  3.5  7.0     2
# 4   b   y  3.0  6.0     2 
```

它具有保留列名和创建单个`count`列的优点。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-08-21T23:06:26.783

也许你想*合并*？

```
x.mean <- aggregate(. ~ id1+id2, p, mean)
x.len  <- aggregate(. ~ id1+id2, p, length)

merge(x.mean, x.len, by = c("id1", "id2"))

  id1 id2 val1.x val2.x val1.y val2.y
1   a   x    1.5    6.5      2      2
2   a   y    3.5    7.0      2      2
3   b   x    2.0    8.0      2      2
4   b   y    3.0    6.0      2      2 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-07-07T11:35:15.630

您还可以使用`plyr::each()`来引入多个功能：

```
aggregate(cbind(val1, val2) ~ id1 + id2, data = x, FUN = plyr::each(avg = mean, n = length)) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-12-30T20:53:05.637

另一个`dplyr`选项是`across`当前开发版本的一部分

```
#devtools::install_github("tidyverse/dplyr")
library(dplyr)

x %>% 
  group_by(id1, id2) %>% 
  summarise(across(starts_with("val"), list(mean = mean, n = length))) 
```

结果

```
# A tibble: 4 x 4
# Groups:   id1 [2]
  id1   id2   mean$val1 $val2 n$val1 $val2
  <fct> <fct>     <dbl> <dbl>  <int> <int>
1 a     x           1.5   6.5      2     2
2 a     y           3.5   7        2     2
3 b     x           2     8        2     2
4 b     y           3     6        2     2 
```

* * *

```
packageVersion("dplyr")
[1] ‘0.8.99.9000’ 
```

# jquery - 跟随曲线的滑块

> ID：12064203
> 
> 赞同：1
> 
> 时间：2012-08-21T22:55:52.647
> 
> 标签：jquery, html, animation

我正在尝试制作一个遵循曲线的滑块，并且我可以像普通滑块一样进行控制。

我在谷歌上搜索了几天，询问了一些程序员朋友，但没有人知道我该怎么做。我会在不使用 Flash 的情况下制作这个动画，我正在寻找 html5、jquery 或 javascript 中的东西。

有任何想法吗？有可能做这样的事情吗？

谢谢

# r - 删除 XML 包中 readHTMLTable 中的标记

> ID：12064210
> 
> 赞同：6
> 
> 时间：2012-08-21T22:56:52.757
> 
> 标签：r

我正在尝试从以下 url 的表中抓取数据：

```
http://www.nfpa.org/itemDetail.asp?categoryID=953&itemID=23033 
```

问题是包含在

```
<sup> </sup> 
```

标签。当我使用以下代码时（诚然不是很优雅）

```
url.overview <- "http://www.nfpa.org/itemDetail.asp?categoryID=953&itemID=23033"
overview <- readHTMLTable(overview)
overview <- overview[[2]]
overview <- overview[-1,]

f <- function(x){
  out <- iconv(x, "latin1", "ASCII", sub="")
  out <- gsub('[\\$,]', '', out) 
  out <- as.numeric(out)
  return(out)
}

overview <- matrix(f(as.character(unlist(overview))), ncol = ncol(overview))
overview <- as.data.frame(overview)
names(overview) <- c('year', 'fires', 'civ.deaths', 'civ.injuries', 'ff.deaths',
                     'ff.injuries', 'damage.reported', 'damage.2010dollars') 
```

我得到了我想要的，*除了*上标中的值被附加到表格单元格中值的末尾。例如，（使用上面给出的 url 中的行和列名称）2001 年的平民死亡数存储为 61963，而应为 6196，因为上标 3 被解释为额外的数字。表格中缺少上标的任何单元格都完全正确。

在文档中苦苦挣扎了几个小时后，我能够使用这些函数`parseHTML`并`getNodeSet`从 XML 包中识别所有包含`<sup>`标签的节点，但无法从那里弄清楚该怎么做：

```
overview <- htmlParse(url.overview)
getNodeSet(overview, "//sup") 
```

我认为我需要以某种方式删除 XML 树的这些部分，然后将结果传递回 readHTMLTable 以进行进一步处理，但我不知道该怎么做。

我会非常感谢你的想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T00:37:11.493

尝试

```
require(XML)
url.overview <- "http://www.nfpa.org/itemDetail.asp?categoryID=953&itemID=23033"
overview <- htmlParse(url.overview,encoding="UTF-8")
temp<-getNodeSet(overview, "/*//span[@class=\"small\"]/sup")
removeNodes(temp)
app.data<-readHTMLTable(overview)[[2]] 
```

所以在这里我们只删除我们不想要的节点并将剩余的节点反馈给`readHTMLTable`第二个表。我在这个 windows 盒子上的编码有问题。您可能希望将编码保留在 中，`htmlParse`否则它可能会在没有您的情况下正常工作。

# email - 当我通过 Dynamics CRM 发送电子邮件时，如何添加邮件标题

> ID：12064213
> 
> 赞同：2
> 
> 时间：2012-08-21T22:56:56.080
> 
> 标签：email, dynamics-crm-2011, email-headers

我想在我的 Dynamics CRM 2011 解决方案中编辑电子邮件模板。

我将在表单中添加一个组合框，允许用户决定电子邮件应该是什么分类，例如。“A”、“B”或“C”

这有助于我们的电子邮件网关知道在归档等方面如何处理某些邮件。此外，设置标题将使用户（收件人）更难解密（降低分类），如果我们只是推动分类，这很容易做到在主题行中（是的，我知道我们仍然容易被复制和粘贴，但请尝试告诉我的客户）。

就在发送电子邮件之前，有一个事件可以让我获取邮件项目并添加邮件标题，还可以操作主题行或其他一些可编辑字段等内容。

我编写了一个 Outlook 加载项，它在发送时运行此代码，并且基本上想知道我应该将类似代码放在 Dynamics 中的什么位置。

```
 private Dictionary<string, List<string>> _classifications;

    private const string ProtectiveMarkingSchemaName = "http://schemas.microsoft.com/mapi/string/{00020386-0000-0000-C000-000000000046}/X-Protective-Marking";

    private const string Version = "0.1";
    private const string Namespace = "xyz.com";

void ApplicationItemSend(object item, ref bool cancel)
    {
        // GUARD
        if (!(item is MailItem)) return;

        if (ClassificationDropDown.SelectedItem == null ||
            String.IsNullOrEmpty(ClassificationDropDown.SelectedItem.Label))
        {
            cancel = true;
            return;
        }

        // CURRENT ITEM
        var mailItem = (MailItem)Globals.ThisAddIn.Application.ActiveInspector().CurrentItem;

        // PREPARE MARKING
        var origin =
            Globals.ThisAddIn.Application.Session.CurrentUser.AddressEntry.GetExchangeUser().PrimarySmtpAddress;

        var classification = new StringBuilder();
        classification.AppendFormat("SEC={0}", ClassificationDropDown.SelectedItem.Label);
        if (DisseminationDropDown.SelectedItem != null)
        {
            if (!String.IsNullOrEmpty(DisseminationDropDown.SelectedItem.Label))
            {
                var cat = DisseminationDropDown.SelectedItem.Label;
                classification.AppendFormat(", CAVEAT={0}", cat);
            }
        }

        // FILTHY HACK
        if (mailItem.Subject == null)
        {
            mailItem.Subject = " ";
        }

        // FIND OLD MARKINGS
        var start = mailItem.Subject.IndexOf('[');
        var end = mailItem.Subject.LastIndexOf(']');
        if (end - start > 0)
            mailItem.Subject = mailItem.Subject.Remove(start, (end - start) + 1);

        // APPLY MARKING
        mailItem.Subject = String.Format("{0} [{1}]", mailItem.Subject.TrimEnd(), classification);
        mailItem.PropertyAccessor.SetProperty(
            ProtectiveMarkingSchemaName,
            String.Format("[VER={0}, NS={1}, {2}, ORIGIN={3}]", Version, Namespace, classification, origin));
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:12:01.367

这不是我有任何直接经验的领域，但我可以告诉您的是，`email`在 CRM SDK 中（通常）使用的对象是底层电子邮件消息的抽象。

尽管如此，SDK 暴露了一个可能有用的区域。查看 SDK 中称为[Microsoft Dynamics CRM 的自定义电子邮件提供程序](http://msdn.microsoft.com/en-us/library/gg309308.aspx)的部分，该部分旨在按照您想要的方向公开某些内容：

> 电子邮件提供程序是与 Microsoft Dynamics CRM 电子邮件路由器服务集成的可插入组件。提供商负责专门的电子邮件处理和与电子邮件协议的接口。

也就是说，我看不到任何暴露邮件标题的对象，但我看起来并不难。

（请注意，它会重定向到[CRM 4.0“电子邮件提供商”SDK 主题](http://msdn.microsoft.com/en-us/library/cc905766.aspx)以获取有用的内容，但这仍然有效且受支持）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T22:56:11.800

我目前有一张 Microsoft 的票，但他们最初的反应是这无法完成。

他们建议的解决方案是使用邮件网关上的规则来添加标题信息，如果我只想编写相同的标题信息，则可以解决该问题，但如果我想要标题中的变量值会变得更加复杂。

我看了一下 Greg 的建议，虽然它们对我来说是一个很好的学习练习，但我在那里找不到解决方案。

可以编写一个执行此操作的工作流，但是我必须考虑 CRM 在发送邮件时所做的所有其他垃圾，坦率地说，文档对于我需要做的事情有点粗略，但我最好的猜测是像这样。

*   使用功能区编辑器隐藏原始发送按钮
*   使用选项向电子邮件表单添加下拉列表
*   使用 javascript 添加一个新的发送按钮以启动工作流
*   编写一个工作流程，让电子邮件查找标题值字段并将其塞入标题中
*   然后发送它。

我不知道这是否会自动关闭活动，或者它是否会保留其上下文，例如（案例中的活动、帐户等），或者这种方法是否会影响审计，因此可能必须考虑这些事情

# c# - 如何设置也是类的成员的属性？

> ID：12064216
> 
> 赞同：1
> 
> 时间：2012-08-21T22:57:05.080
> 
> 标签：c#, reflection

这是我想做的，我不知道是否有可能，或者我一直在以不正确的方式解决问题：

我有一个对象，其成员具有自定义属性，我正在使用该属性中的信息来搜索集合中的值，然后通过反射设置该给定属性的值。但是我的类型有一些更复杂的成员，成员不是简单的字符串或 int，而是类也具有带有设置其值的信息的属性。

因此，要使用反射设置值，我需要我正在更改的对象的实例，所以我的问题是：

如何获取实际成员，以便我可以使用他们拥有的属性检查并获取他们的值？

这里有一些我所拥有的和我想要的示例代码：

```
public class MyEntity
{
    [CustomAttribute("Info to Set Values")]
    public string SimpleProperty {get;set;}

    public MyOtherClass ComplexProperty {get;set;}

    public static bool SetSimpleValueTypes(object instance, IEnumerable<Value> values){
        var mappedProperties = instance.GetType()
                                   .GetProperties()
                                   .Where(type => type.GetCustomAttributes(typeof(CustomAttribute), true).Length > 0);

        foreach (PropertyInfo property in mappedProperties)
        {
           /*...and then some code to get the Value to set in the property*/
           var value = GetValue(values);
           property.SetValue(instance, value, null);
        }
    }

}

public class MyOtherClass
{
    [CustomAttribute("Info to Set Values")]
    public string SimpleInnerProperty {get;set;}
} 
```

在上面的代码中，在方法 SetSimpleValueTypes 中，我获取了具有 CustomAttribute 属性的给定实例的所有属性，然后我迭代这些 PropertyInfo 并使用我传递给它的实例设置值；我会按如下方式使用它：

```
MyEntity entity = new MyEntity();
MyEntity.SetSimpleValueTypes(entity, valuesFromSomeWhere); 
```

这将正确设置所有简单类型属性的值：string、int 等；但是现在，我还需要在 ComplexProperty 中设置值，因此，使用一种不太灵活的方法，我可以这样做：

```
MyEntity entity = new MyEntity();
MyEntity.SetSimpleValueTypes(entity, valuesFromSomeWhere);
MyEntity.SetSimpleValueTypes(entity.ComplexProperty, valuesFromSomeWhere); 
```

所以，我真正想做的是，而不是显式调用 ComplexProperty 将其传递给 SetSimpleValueTypes 方法，我想迭代抛出 MyEntity 的属性，当找到复杂值时，传递复杂的实际实例键入方法，以便它可以迭代其属性并在该实例中设置它们的值。

希望这可以进一步澄清这个问题。:)

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:01:31.760

正如它所写的那样，当您的方法运行时，您的 MyEntity 对象可能不会`ComplexProperty`填充，对吧？它只是空的。因此，您必须创建一个新实例`MyOtherClass`（`Activator.CreateInstance()`例如，使用 DI 框架），然后在该对象上递归调用您的方法。

```
public static bool SetValueTypes(object instance, IEnumerable<Value> values){
    var mappedProperties = instance.GetType()
                               .GetProperties()
                               .Where(type => type.GetCustomAttributes(typeof(CustomAttribute), true).Length > 0);

    foreach (PropertyInfo property in mappedProperties)
    {
       /*...and then some code to get the Value to set in the property*/
       var value = GetValue(values);
       property.SetValue(instance, value, null);
    }

    var complexProperties = instance.GetType()
                               .GetProperties()
    // Either assume that unmapped properties are all complex,
    // or use your own criteria. Maybe anything whose type is
    // a class and not a string?
                               .Where(type => type.GetCustomAttributes(typeof(CustomAttribute), true).Length == 0);
    foreach (PropertyInfo property in mappedProperties)
    {
       var value = Activator.CreateInstance(property.PropertyType);
       SetValueTypes(value, values);
       property.SetValue(instance, value, null);
    }

} 
```

# c# - IEnumerable Where 子句

> ID：12064217
> 
> 赞同：1
> 
> 时间：2012-08-21T22:57:06.943
> 
> 标签：c#, ienumerable

```
Line 1 - A 01/01/2012 01/05/2012  
Line 2 - B 01/01/2012 01/05/2012  
Line 3 - A 01/06/2012 01/07/2012  
Line 4 - A 01/01/2012 01/05/2012  
Line 5 - A 01/06/2012 01/07/2012 
```

我用以下方法捆绑这个列表

```
public IEnumerable<IEnumerable<Line>> Bundle(IEnumerable<Line> Lines)
    {
        yield return Lines
        .Where(x => x.PropertyOne = "A" )
    } 
```

我也想比较`Propertytwo`和`Propertythree`是否相等，我想要如下结果

```
Lines  
----Line 1 - A 01/01/2012 01/05/2012  
----Line 4 - A 01/01/2012 01/05/2012  
Lines  
----Line 3 - A 01/06/2012 01/07/2012            
----Line 5 - A 01/06/2012 01/07/2012 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:11:00.650

您可能想要使用 GroupBy，而不是收益回报。像这样的东西：

```
public IEnumerable<IEnumerable<Line>> Bundle(IEnumerable<Line> Lines)
{
    return Lines
        .Where(x => x.PropertyOne == "A" )
        .GroupBy(x => new {x.PropertyTwo, x.PropertyThree});
} 
```

# knockout.js - 使用 Knockout 绑定依赖项选择列表，其中第一个下拉列表是动态填充的

> ID：12064222
> 
> 赞同：0
> 
> 时间：2012-08-21T22:57:39.747
> 
> 标签：knockout.js, dependencies, selectlist

```
<select data-bind="options: $parent.Data().filter(function(item){             
            return item.Name()==$data;
        }),optionsText: 'FieldName' "></select> 
```

我有我的第一个选择列表，如上所示

Data 是映射到 JSON 的对象。上述 observable 有一个计算函数，用于获取 modeoftransport 的不同菜单项。

我应该如何进行第二个选择列表以将状态 CA、NC、AZ 显示为列表项，一旦用户将 FieldName 选择为 ABCD，就会填充这些状态。

返回的 JSON 是这样的

字段名称：ABCD AllowedStates：CA、NC、AZ 传输模式：Air

字段名称：EFGH AllowedStates：OH、NC、MO、PA 运输模式：道路

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:32:24.647

您可以查看购物车编辑器示例。它实现了级联下拉菜单。

[http://knockoutjs.com/examples/cartEditor.html](http://knockoutjs.com/examples/cartEditor.html)

# java - Java DOM setAttribute 不起作用

> ID：12064223
> 
> 赞同：2
> 
> 时间：2012-08-21T22:57:53.083
> 
> 标签：java, xml, dom, setattribute

有人能告诉我为什么这不起作用吗？这让我疯狂。

我的文件.xml

```
<?xml version="1.0" encoding="UTF-8" ?>
<root date="oldValue" /> 
```

Java 代码

```
try {
    Document doc = builder.parse(new File("myFile.xml"));
    Element root = doc.getDocumentElement();
    System.out.println("date: " + root.getAttribute("date") + "\n");
    root.setAttribute("date", "test");
    System.out.println("date: " + root.getAttribute("date"));
}  catch (Exception e)  {
    System.out.println("Something went wrong.");
} 
```

输出

```
oldValue
oldValue 
```

无论我做什么，我都无法让我的代码写入 XML 文件...我尝试在根的子节点上执行 setAttribute() 函数。我试过只是删除根......没有任何效果。我非常沮丧，所以任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:16:22.767

您是否遵循与以下相同的代码？这对我有用（在 myFile.xml 中具有相同的内容）：

```
public static void main(String... args) throws Exception {
    DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();

    try{
        Document doc = builder.parse(new File("myFile.xml"));
        Element root = doc.getDocumentElement();
        System.out.println("date: " + root.getAttribute("date") + "\n");
        root.setAttribute("date", "test");
        System.out.println("date: " + root.getAttribute("date"));
    } catch (Exception e) {
        System.out.println("Something went wrong.");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-03T11:21:21.380

您的代码只是写入 Element 对象，而不是 .xml 文件（但是，当我运行您的代码时，我的输出是：

```
 date: oldValue

             date: test 
```

要写入 .xml 文件，请使用以下命令。

```
try
      {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = factory.newDocumentBuilder();
        Document doc = builder.parse(new File("myFile.xml"));

        Element root = doc.getDocumentElement();
        System.out.println("date: " + root.getAttribute("date") + "\n");
        root.setAttribute("date", "test");

        // write the content into xml file
        TransformerFactory transformerFactory = TransformerFactory.newInstance();
        Transformer transformer = transformerFactory.newTransformer();
        DOMSource source = new DOMSource(doc);
        StreamResult result = new StreamResult(new File("myFile.xml"));
        transformer.transform(source, result);

        System.out.println("date: " + root.getAttribute("date"));

      }
    catch (TransformerException | SAXException | ParserConfigurationException | IOException e )
      {
        System.out.println("Something went wrong");
        e.printStackTrace();
      } 
```

# opengl - 为什么程序员在OpenGL中使用常量和静态变量？

> ID：12064249
> 
> 赞同：4
> 
> 时间：2012-08-21T23:00:43.197
> 
> 标签：opengl, static, constants

我注意到程序员制作变量`const`和`static`. 我了解这些关键字的作用，但我不知道他们为什么使用它们。

* * *

**^([*OpenGL 学习官方指南 1.1 版*](http://glprogramming.com/red/chapter02.html))^([第 2 章](http://glprogramming.com/red/chapter02.html))^([中](http://glprogramming.com/red/chapter02.html))**的示例 1**
^([](http://glprogramming.com/red/chapter02.html))**

 ***```
 static GLint vertices[] = {25, 25,
                              100, 325,
                              175, 25,
                              175, 325,
                              250, 25,
                              325, 325};

    static GLfloat colors[] = {1.0, 0.2, 0.2,
                              0.2, 0.2, 1.0,
                              0.8, 1.0, 0.2,
                              0.75, 0.75, 0.75,
                              0.35, 0.35, 0.35,
                              0.5, 0.5, 0.5};

    glEnableClientState (GL_COLOR_ARRAY);
    glEnableClientState (GL_VERTEX_ARRAY);

    glColorPointer (3, GL_FLOAT, 0, colors);
    glVertexPointer (2, GL_INT, 0, vertices); 
```

如果这些数组仅用于单个对象实例，为什么它们必须是静态的？

**^([Wikibooks 教程 1 上](http://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Introduction))^([的](http://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Introduction))^([*OpenGL 编程*](http://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Introduction))**示例 2**
^([](http://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Introduction))**

 ***```
 GLuint fs = glCreateShader(GL_FRAGMENT_SHADER);

    const char *fs_source =
    "#version 120           \n"
    "void main(void) {        "
    "  gl_FragColor[0] = 0.0; "
    "  gl_FragColor[1] = 0.0; "
    "  gl_FragColor[2] = 1.0; "
    "}";

    glShaderSource(fs, 1, &fs_source, NULL); 
```

fs_source char 数组在设置后不会更改。但是绝对有必要让它保持不变吗？它会提高性能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T23:04:26.510

是的，通常情况下，它*确实会*提高性能，尽管*不一定*以您想象的方式。

通过这些提示，编译器可以自由选择不同的优化（空间和时间），从而使代码在此过程中更高效。

例如，静态存储持续时间变量^((a))在程序启动时初始化*一次*，并且永远不必再次初始化。

标记为`const`允许编译器生成更高效的代码，充分了解数据不会改变。作为一个极端的例子，它可以将值加载到专用的 CPU 寄存器中，并且不再查看内存中的数据。

所以是的，它*可以*提高性能，不是因为相同的指令可能运行得更快，而是因为编译器可以根据您提供的额外知识自由使用不同的指令。

* * *

^((a))：假设这就是你的意思`static`。关键字还用于限制其可见性范围，这是一种很好的编程习惯。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-21T23:36:16.980

> 我了解这些关键字的作用，

你？

> 但我不知道他们为什么使用它们。

你？！

> 如果这些数组只用于这个单一的***对象实例***，为什么在世界上它们必须是静态的？

什么对象？什么实例？你引用这个例子的书是用 C 语言而不是 C++ 编写的，虽然用 C 语言实现对象和实例是完全可能的，但语言本身并没有内置的定义。因此，我认为你对什么是*静态*的非常了解在这种情况下确实是错误的。

~~在给定的示例中，~~如果*静态*应用于模块级别，则应用于全局变量。这样做的效果是，该变量仅对已在其中定义的编译单元可见。在 C 程序中，将所有不被引用到当前编译单元之外的东西声明为静态是一种常见且推荐的做法。

在函数范围内对常量数据使用静态可以节省每次调用函数时对变量进行完全初始化的开销。

> fs_source char 数组在设置后不会更改。

而你实际上不能。C 语言规定，不属于*char*数组初始化的字符串文字属于类型`const char *`，并且驻留在程序映像的专用只读段中。由于非初始化字符串文字的类型是`const char *`将这样的指针变量分配给`char *`调用未定义的行为。

> 但是绝对有必要让它保持不变吗？

试试如果你去掉*const*并用`-Werr`. 这实际上是语言正确性的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T23:39:19.863

在我们正在讨论的文件中，varray.c（示例 1）：

示例中的静态变量未在模块级别声明，它们的可见性仅在函数内部。关键字可以在不同的时间表示不同的`static`东西，但在这种情况下，它不是要限制它们从其他代码文件的可访问性（而是通过将它们的范围限制为仅发生这种情况）。

这些数组在程序运行期间仅声明/生成一次。在这些声明之前添加 static 关键字（比如在 setupPointers 中）意味着那些代码行（59-64、65-70）只执行一次，指针本身不会改变，这些数字也不必“再次流过管道”（参见上面的回答重新性能），因为它们已经在那里。

这是因为当用户单击鼠标按钮时，程序会在两个绘图例程之间切换。`setupPointers`只初始化一次数组而不是每次调用函数时才有意义。

所以是的，这是`static`关键字的工作方式之一，它告诉编译器只初始化这个变量一次。`const`是相似的，但它的意思更像是“只写一次这个内存”。

你可能会说，为什么不把它们设为 const 呢？我知道，对吧？

也许这些链接会帮助人们：

[可变数组](http://www.cosc.brocku.ca/Offerings/3P98/course/OpenGL/RedBookExamples/varray.c)

[关于静态关键字的博客文章](http://www.cprogramming.com/tutorial/statickeyword.html)******

# javascript - 经典方法的目的 | 与对象状态的关系

> ID：12064251
> 
> 赞同：1
> 
> 时间：2012-08-21T23:00:59.007
> 
> 标签：javascript

有一个纯粹使用对象字面量编写的库来对类似项目进行分组。这与拥有公共静态类有关。例如

```
var public_statics = {
    var1 : 'hello',
    func1 : function(){//stuff}
}; 
```

我看到人们通过模拟类或简单地在 JavaScript 函数对象上使用 new 来编写 OO（或类似）JavaScript。

在网络上（我在 SO 上听说过并体验过），似乎没有太多的状态。我的意思是，你似乎从来没有来自同一个“类”的 2 个不同的对象。

例如，我有一个 UserNew 模型“类”，其中在任何给定时间只能有一个模型。事实上，我所有的模型都是这样的，在任何给定时间只有一个实例。

是否有状态完整应用程序的示例（您在其中实例化多个对象）？

如果所有模型都是使用对象文字的公共静态集合，我可能会错误地构建这个库吗？

我可以发布任何可能相关的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:08:13.300

这是个好问题。我可以想到这种方法的两个优点。

1）以防万一您确实需要多个对象：也许邮件应用程序可以将屏幕上可见的每个用户表示为用户对象，或者将每封邮件表示为邮件对象。

2) 命名空间区分 - 一种将函数和数据组织和分组到相关命名空间的好方法。

# iphone - 在 uiview 中插入自定义 uitableviewcell 子视图

> ID：12064252
> 
> 赞同：2
> 
> 时间：2012-08-21T23:01:00.373
> 
> 标签：iphone, ios, uitableview

我有一个包含 UITableView 的 UIView，但是 UITableView 在顶部有一个 30 pxl 的间隙，我想以编程方式在其中添加一个静态 UITableViewCell。

我曾尝试这样做，但似乎无法让它出现，这是我正在使用的代码显示。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

[selectAllCell setFrame:CGRectMake(0.0, 20.0, 320.0, 80.0)];
[selectAllCell.textLabel.text isEqualToString:@"all"];
[self.view insertSubview:selectAllCell aboveSubview:subModelTableView];

//.. other stuff
} 
```

此视图中的其他所有内容都可以正常工作..所以只是想知道如何让这个 uitableviewcell 显示。

编辑，我已经更新了我的 viewDidLoad 方法中的代码，但我仍然对这个 dran 的东西没有任何运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:15:24.510

为什么要在表格视图之外使用表格视图单元格？只需在空白区域上打一个带有嵌入式按钮的 UIView。如果由于某种原因这不能满足您的需求，那么一个相当简单的 UIView 或 UIControl 子类应该可以完成工作。

# jquery - jquery facebook 喜欢 autosuggest

> ID：12064253
> 
> 赞同：0
> 
> 时间：2012-08-21T23:01:08.860
> 
> 标签：jquery, autocomplete, autosuggest

我正在尝试实现类似于下图的自动建议，因为它有*多个类别*（例如国家、城市）。

我理想的解决方案是一个自动建议框，它使用两个不同的 API 端点通过*n 个不同的 ajax 调用填充其**n 个*不同的类别。

 *我看到的唯一地方是 Facebook 的主搜索框“搜索人物、地点和事物”。

我从这个网站上抓取了下面的图片 - [http://www.web2ajax.fr/examples/facebook_searchengine/](http://www.web2ajax.fr/examples/facebook_searchengine/) - 但是没有它的文档，在尝试重新发明/逆向工程轮子之前，我想我会看看是否有人知道一个现有的插件。

![自动建议示例](../Images/ae9f646dd0b54f5933b63e75f3e8579c.png)

谢谢！DJ22

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:00:22.933

对于自动完成类别，请访问[http://jqueryui.com/demos/autocomplete/#categories](http://jqueryui.com/demos/autocomplete/#categories)（点击演示下方的“查看源代码”）。还要确保将 themeroller 用于自定义主题：http: [//jqueryui.com/themeroller](http://jqueryui.com/themeroller)。*

# django - 带有 postgis 的 geodjango 不起作用

> ID：12064255
> 
> 赞同：3
> 
> 时间：2012-08-21T23:01:21.003
> 
> 标签：django, postgresql, postgis, geodjango

我是geodjango的新手，我有以下设置：

```
DATABASES = {
    "default" : {
        'ENGINE': 'django.contrib.gis.db.backends.postgis', # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'dbname',                      # Or path to database file if using sqlite3.
        'USER': 'django',                      # Not used with sqlite3.
        'PASSWORD': 'somepass',                  # Not used with sqlite3.
        'HOST': '127.0.0.1',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
}

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.gis',
    'django.contrib.admin',
    'django.contrib.admindocs',
    'django.contrib.gis',
    "app.core",
) 
```

我已经使用以下命令创建了数据库：

```
postgres@rewitaqia:~$ createdb -U postgres -T template_postgis -O django dbname 
```

但是当我尝试同步数据库时，它说：

```
django.core.exceptions.ImproperlyConfigured: Cannot determine PostGIS version for database "dbname". GeoDjango requires at least PostGIS version 1.3\. Was the database created from a spatial database template? 
```

另外，当我在 psql 中尝试此操作时，似乎 db 不是真正从 postgis 模板创建的：

```
db_name=# select postgis_lib_version();
ERROR:  no existe la función postgis_lib_version()
ŘÁDKA 1: select postgis_lib_version();
                ^
DOPORUČENÍ:  Ninguna función coincide en el nombre y tipos de argumentos. Puede desear agregar conversión explícita de tipos. 
```

无论如何感谢您的阅读。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T03:47:42.910

维斯金，

第一次设置 PostGIS 时，我和你有很多相同的问题，所以我创建了一篇详细介绍 PostGIS 设置的文章。很抱歉插入我自己的文章，但我创建它是为了帮助记录设置过程。 [http://www.chicagodjango.com/blog/geo-django-quickstart/](http://www.chicagodjango.com/blog/geo-django-quickstart/)

看看你上面的问题，很难确切地说出问题是什么。但是，您可能会检查会产生列出的 PostGIS 错误的事情：

*   是否安装了所有 apt 系统依赖项？请参阅文章中的第 1 步。
*   当您创建 postgis_template 模式时，是否运行了创建地理空间数据库对象的命令（请参阅附加链接的第 2 步）？
*   是否安装了相当新版本的 PostGIS？检查最低要求：[https ://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#spatial-database](https://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#spatial-database)

无论如何，希望这会有所帮助。乔

# php - PHP unlink() 会破坏 file_exists、header 和 echo 函数吗？

> ID：12064258
> 
> 赞同：2
> 
> 时间：2012-08-21T23:01:33.893
> 
> 标签：php

我有以下代码：

```
$tmpfile = $tempDirectory . $file ;

if (file_exists($tmpfile)) {

   header('Location: <some location>');

} 
```

它工作完美，文件存在，我被重定向到我的新页面。

所以，现在我知道该文件存在并且有效。所以，我进入 FTP，确保文件在那里。

然后我运行这段代码：

```
$tmpfile = $tempDirectory . $file ;

if (file_exists($tmpfile)) {

   unlink($tmpfile);
   header('Location: <some location>');

} 
```

重定向停止工作。PHP 什么也不输出。该文件将从 FTP 目录中删除。但是重定向完全失败。

如果我`echo`在存在取消链接的情况下在 if 语句中放置一个（在 if 语句中的任何其他代码行之前或之后，它不会输出任何内容。

没有 unlink 错误，而且我检查 FTP 时文件明显被删除，所以这是怎么回事？

它在代码运行时被删除，所以这显然不是权限问题。如果它没有权限这样做，它将无法删除该文件。

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:15:58.020

解决方案可能很简单：

```
[blank space] - this breaks redirect
<?php

// code 
```

PHP 也可能在取消链接时崩溃。确保您的[error_reporint 设置](http://php.net/manual/en/function.error-reporting.php)设置为 E_ALL。

# ruby-on-rails - 仅为特定的 Major 加载 Emacs Minor

> ID：12064262
> 
> 赞同：0
> 
> 时间：2012-08-21T23:02:34.850
> 
> 标签：ruby-on-rails, emacs, ruby-mode

我对 emacs 很陌生，我已经为 Ruby on Rails 安装了一个“入门工具包”，它运行良好。但是，我也在使用 PHP 进行开发，并且启动器会带来一些问题。

在编辑除 ruby​​ 文件之外的所有文件时，我想关闭一些次要模式。

在我的 .emacs 文件中，我有：

```
(add-to-list 'load-path "~/.emacs.d/plugins/ruby-block")
(require 'ruby-block) 
```

如果我将此注释掉，那么所有文件的次要都会消失，所以我尝试添加一个钩子（尽管我是一个完整的初学者，所以这可能是错误的方法），如下所示：

```
(add-hook 'ruby-mode-hook (lambda () (add-to-list 'load-path "~/.emacs.d/plugins/ruby-block")))
(add-hook 'ruby-mode-hook (lambda () (require 'ruby-block))) 
```

我还尝试使用事件挂钩来调用一个函数并将上面的行移动到一个函数中，但仍然无法让它工作。

我非常感谢从 .rb 以外的所有文件中删除 ruby​​-block 次要的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:07:28.797

即使您提到的两行对于次要模式（顺便说一句：哪个？）工作是必要的，但它们不负责打开次要模式。第一个：

```
(add-to-list 'load-path "~/.emacs.d/plugins/ruby-block") 
```

只是扩展了一个路径变量，即 Emacs 将在其中查找要加载的代码，而第二个：

```
(require 'ruby-block) 
```

读取一些库代码，即主要是函数定义。

实际的模式调用可能看起来更像这样：

```
(ruby-block-mode t) 
```

您在使用 时走在正确的道路上，`'ruby-mode-hook`但您不必担心`load-path`或`(require...)`. 它们可以保持原样，即无需将它们注释掉。相反，找到次要模式的实际调用并将其放入您的`(lambda ()...)`声明中，您应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T08:54:13.807

我曾经使用过`ruby-block-mode`，但我已经删除了它。

这是我设置的`ruby-block-mode`，试一试：

```
(eval-after-load 'ruby-mode
  '(progn
    (require 'ruby-block)
    (ruby-block-mode t)
    (setq ruby-block-highlight-toggle t))) 
```

# php - 使用 PHP 输出 JavaScript 时出现神秘的换行符。

> ID：12064265
> 
> 赞同：0
> 
> 时间：2012-08-21T23:03:01.740
> 
> 标签：php, javascript, wordpress, shadowbox

我正在使用 PHP 为 WordPress 短代码输出一些 JavaScript。我的 php 看起来像这样：

```
$output="<script type='text/javascript' >
jQuery(document).ready(function() {
    jQuery('#photo{$photo_id}').on('click', function(){ 
      Shadowbox.open({
        content: '<div id=\'popup{$photo_id}\' class=\'popup\'>{$content}</div>',
        player:     'html',
        height:     500,
        width:      1200,
        handleOversize: 'drag'
        }); 
    });
});       
</script>";

return $output; 
```

但是输出在 Shadowbox 的内容争论中的第一个引号之后有一个换行符。

像这样：

```
jQuery(document).ready(function() {
    jQuery('#stylistphoto1').on('click', function(){    
      Shadowbox.open({
        content: '
<div> id=\'popup1\' class=\'popup\'> . . . 
```

这给了我一个“未终止的字符串文字”错误并使我的脚本失败。

到底是怎么回事？

备注：一。这是在没有 BOM 的 UTF-8 中编码的。湾。这在某一时刻确实奏效了。C。如果我传递一个空字符串作为内容争论，它就可以正常工作，当然，这对我没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:10:40.173

首先，我不会在 php 变量中定义 javascript 功能，然后在某处回显，这是一种非常糟糕的做法。

这里的问题可能是您的样式上的某些东西打破了那条线，因为它很长。你可以做些什么来解决这个问题：

```
$output="<script type='text/javascript' >
jQuery(document).ready(function() {
    jQuery('#photo{$photo_id}').on('click', function(){ 
      Shadowbox.open({
        content: '<div id=\'popup{$photo_id}\' ' +
                 'class=\'popup\'>{$content}</div>',
        player:     'html',
        height:     500,
        width:      1200,
        handleOversize: 'drag'
        }); 
    });
});       
</script>";

return $output; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:15:44.603

在我看来这`content: '<div id=\'popup{$photo_id}\' class=\'popup\'>{$content}</div>'`是一个问题，因为参数的值`content`被解释为`'<div id=\'`. 它停在下一个引号处。如果您的 PHP 版本不喜欢这个（看起来），您应该通过连接来分隔这部分变量。

```
 $output="<script type='text/javascript' >
jQuery(document).ready(function() {
    jQuery('#photo{$photo_id}').on('click', function(){ 
      Shadowbox.open({";

$output .= "
        content: '<div id=\"popup{$photo_id}\" class=\"popup\">{$content}</div>,'";

$output .= "
        player:     'html',
        height:     500,
        width:      1200,
        handleOversize: 'drag'
        }); 
    });
});       
</script>";

return $output; 
```

如果可能的话，最好将 ' 用于您的 echo 语句，并将 " 用于内部的所有内容，以避免处理引号转义，例如`echo 'My friend says "hello", Tom.';`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T23:33:17.373

WordPress 的自动格式化功能之一，wpautop 过滤器导致了问题。

我已经在使用 Chris Coyer 的“原始”短代码（http://css-tricks.com/snippets/wordpress/disable-automatic-formatting-using-a-shortcode/）所以答案就像将脚本包装在[raw][/raw] 短代码在将其输出回内容区域之前。

哈哈哈！

# php - 插入语句推过一列并丢失数据

> ID：12064269
> 
> 赞同：0
> 
> 时间：2012-08-21T23:03:53.850
> 
> 标签：php, mysql, sql

我正在尝试将用户信息从用户输入表单添加到数据库中。表单中的数据正在被识别，如果我为所有输入的变量测试打印语句，则会显示信息。但是，当它通过插入语句时，它会丢失第一列数据（姓氏）并将所有其他数据推入错误的列。

姓氏以名字结尾，名字以联系人类型结尾，联系类型以联系信息结尾，联系信息以城市结尾，评论不显示在任何地方，并且添加的日期是正确的。

我添加了最相关的本地代码，但如果您需要常用功能，我也可以添加。底部还有表格结构。

谢谢！

```
 <html>
<head>
<title>Submitted Guestbook Info</title>
<link rel="stylesheet" type="text/css" href="css/king.css" />
</head>

<body>
<img src="images/KingLogo.jpg"><br>

<div id="guestlist">

<?php

include "king_common_functions.php";

//*******************************************************
//Variables for Guestbook Submissions
//*******************************************************

//*******************************************************
//Call Functions
//*******************************************************

setUserInfo();

?>

<?php

function setUserInfo()
{

//******************************************************
//Validate Input Fields, Define Variables
//******************************************************
$mycontact_type = $_POST['mycontact'];
$mycity = $_POST['city'];

    if (isset($_POST['mylastname']))
    {
        $mylastname = trim($_POST['mylastname']);
    } else {
        $mylastname ='';
    }

    if (isset($_POST['myfirstname']))
    {
        $myfirstname = trim($_POST['myfirstname']);
    } else {
        $myfirstname ='';
    }

    if (isset($_POST['mycontactinfo']))
    {
        $mycontactinfo = trim($_POST['mycontactinfo']);
    } else {
        $mycontactinfo ='';
    }

    if (isset($_POST['comments']))
    {
        $mycomments = trim($_POST['comments']);
    } else {
        $mycomments ='';
    }

    $rtnmsg = doGuestValidation($myfirstname, $mylastname, $mycontactinfo, $mycity);

        if ($rtnmsg == '')
        {
            $rtncode = insertData($db, $mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments);
        } else {
            $rtncode = '';
            print $rtnmsg;
            print '<br />Go <a href ="assignment_6_guest_calc.php">BACK</a> and try again!';
        }

}

function insertData($mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments)
{
    $mydate = date("Y-m-d");

    $db = connectDatabase();

    $statement = "insert into u1585_guestbook (lastname, firstname, contact_type, contact_info, city, comments, date_added)
    values ('".$mylastname."', '".$myfirstname."', '".$mycontact_type."', '".$mycontactinfo."', '".$mycity."', '".$mycomments."', '".$mydate."')";

    $result = mysql_query($statement);

    print "TEST: $mylastname"
                if ($result)
                {
                    print "<h4>Thank You! A representative will contact you soon.</h4>";
                    print "Information Submitted for: ".$myfirstname." ".$mylastname;
                    print "<br/><br/>Your name ".$mycontact_type. " is " .$mycontact_info;
                    print "<br/>and you are interested in living in ".$mycity;
                    print "<br/><br/>Our representative will review your comments below:";
                    print "<br/><br/><textarea name='comments' rows='7' cols='60' disabled='disabled' class='textdisabled'>";
                    print $mycomments;
                    print "</textarea>";
                } else {
                        $errno = mysql_errno($db);

                        if ($errno == '1062') {
                            echo "<br>User is already in Guestbook: <br />".$mylastname.", ".$myfirstname;
                        } else {
                            echo("<h4>MySQL No: ".mysql_errno($result)."</h4>");
                            echo("<h4>MySQL Error: ".mysql_error($result)."</h4>");
                            echo("<h4>SQL: ".$statement."</h4>");
                            echo("<h4>MySQL Affected Rows: ".mysql_affected_rows($result)."</h4>");
                        }
                        return 'NotAdded';
                    }
}

?>

</div>

</body>
</html> 
```

表结构：

```
CREATE TABLE u1585_Guestbook (
  guest_id int(11) NOT NULL AUTO_INCREMENT,
  lastname varchar(40) NOT NULL,
  firstname varchar(30) NOT NULL,
  contact_type varchar(30) NOT NULL,
  contact_info varchar(40) NOT NULL,
  city varchar(40) NOT NULL,
  comments varchar(200) NOT NULL,
  date_added date NOT NULL,
  PRIMARY KEY (guest_id)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:09:33.177

您对该方法`insertData()`的调用错误地传递了参数：

```
$rtncode = insertData($db, $mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments);
...
function insertData($mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments) { 
```

您`$db`作为第一个参数传递，但函数的第一个参数应该是姓氏。只需更新要删除的调用`$db`，您应该会很好：

```
$rtncode = insertData($mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:09:47.633

我认为很明显电话之间存在不匹配：

```
 insertData($db, $mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments); 
```

和实际签名：

```
 function insertData($mylastname, $myfirstname, $mycontact_type, $mycontactinfo, $mycity, $mycomments) 
```

`$db`从调用中删除第一个参数。

# python - 如何将字符串转换为具有相关时区的 python 日期时间对象？

> ID：12064270
> 
> 赞同：1
> 
> 时间：2012-08-21T23:03:55.533
> 
> 标签：python, datetime

我有一个类似于“2012-06-14 20:38:24.213-7:00”的字符串，并且想将其转换为 python 日期时间对象，时区保持不变，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:14:47.653

[固定偏移量不足以找出时区名称。](https://stackoverflow.com/q/1274743/4279)

否则[`pytz`](http://pytz.sourceforge.net/)和/或[`dateutil`](http://labix.org/python-dateutil/#head-8d03c6c25ead6f9cab0cde83e6f672b52480ab90)库可能会有所帮助：

```
>>> from dateutil import parser
>>> parser.parse('2012-06-14 20:38:24.213-7:00')
datetime.datetime(2012, 6, 14, 20, 38, 24, 213000, tzinfo=tzoffset(None, -25200)) 
```

# javascript - 通过 Javascript 或批处理文件的 ADB 脚本

> ID：12064271
> 
> 赞同：0
> 
> 时间：2012-08-21T23:04:08.083
> 
> 标签：javascript, android, batch-file, command, adb

我正在寻找一个批处理 / JS 文件来执行下面提到的 Android 操作系统的 ABD 命令。

任何帮助是极大的赞赏。

```
CD C:\Documents and Settings\tech\desktop\pattern\
adb shell
cd /data/data/com.android.providers.settings/databasessqlite3 settings.db
update system set value=0 where name='lock_pattern_autolock';
update system set value=0 where name='lockscreen.lockedoutpermanently';
.quit 
```

我被挂断了，它不会超出 adb shell

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:08:00.193

也许它不适用于 Windows，但试一试（适用于 Linux 和 Mac OS X）：

```
$ echo 'sqlite3 /data/data/com.android.providers.settings/databases/settings.db <<EOF
update system set value=0 where name="lock_pattern_autolock";
EOF
exit' | adb shell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:07:48.803

尝试：

```
CD C:\Documents and Settings\tech\desktop\pattern\
adb shell "cd /data/data/com.android.providers.settings/databasessqlite3 settings.db; update system set value=0 where name='lock_pattern_autolock'; update system set value=0 where name='lockscreen.lockedoutpermanently';" 
```

# objective-c - 是否可以将字形设计器与 Xcode 故事板一起使用？

> ID：12064272
> 
> 赞同：0
> 
> 时间：2012-08-21T23:04:20.730
> 
> 标签：objective-c, xcode, cocos2d-iphone, designer, glyph

我想知道你是否可以使用 Glyph Designer 创建一个很酷的字体，然后在 Xcode Storyboard 中使用它。我知道你可以将它与 cocos2d 一起使用，但我想在我的 TableViewCells 和导航栏中使用它，因为我不喜欢默认字体。

如果不可能是他们的另一个程序，我可以用来制作我自己的自定义字体吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T08:05:06.017

不可以。iOS SDK 没有对位图字体的原生支持。如果你想使用自定义字体，你需要有一个 truetype 字体 (ttf)。

# javascript - 从类内部获取对象名称 (JavaScript)

> ID：12064273
> 
> 赞同：1
> 
> 时间：2012-08-21T23:04:21.930
> 
> 标签：javascript

我有一个类，我想从类内部使用该类将对象的名称保存为类变量：

```
var xxx = new MyClass(); // on the constructor this.name should be init to "xxx" 
```

我已经尝试过这种方法：

> [如何在Javascript中将类对象的名称作为字符串获取？](https://stackoverflow.com/questions/789675/how-to-get-class-objects-name-as-a-string-in-javascript)

但我无法从类构造函数本身获得它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:14:44.870

`xxx`只是一个持有对`Object`内存中的引用的变量。如果您想为该对象提供名称属性，则应将其作为参数传递。

```
var xxx = new MyClass( 'xxx' );

var MyClass = function( name ) {
    this.name = name || undefined;
}; 
```

您可以保留对象的哈希值以避免每次创建不同的变量：

```
var myHash = {};

var MyClass = function( name ) {
    if( !name ) throw 'name is required';
    this.name = name;
    myHash[ name ] = this;
    return this;
};
//add static helper
MyClass.create = function( name ) {
    new MyClass( name );
};    

//create a new MyClass
MyClass.create( 'xxx' );

//access it
console.log( myHash.xxx )​; 
```

这是一个小提琴：http: [//jsfiddle.net/x9uCe/](http://jsfiddle.net/x9uCe/)

# git - 为什么 git-svn 应该积极搜索旧历史？

> ID：12064290
> 
> 赞同：10
> 
> 时间：2012-08-21T23:05:56.267
> 
> 标签：git, svn, git-svn

当我运行 git svn clone -s 时发生了一些奇怪的事情，虽然下面的信息告诉我们不要惊慌，我想知道为什么这是一种 svn 错误？

为什么这条路径不存在，是不是被别人删除了？

如果是，为什么 git svn 应该积极搜索旧历史？

```
Initializing parent: refs/remotes/tags/sequentialInformationalBottleneckClusterer-1.0.1@8400
W: Ignoring error from SVN, path probably does not exist: (160013): Filesystem has no item: File not found: revision 101, path '/trunk/packages/internal/sequentialInformationalBottleneckClusterer'
W: Do not be alarmed at the above message git-svn is just searching aggressively for old history.
This may take a while on large repositories
Checked through r1501 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T01:06:37.233

This was a fun one. Do not be alarmed.

The `W:` signifies "warning", and all this warning tells you is that `/trunk/packages/internal/sequentialInformationalBottleneckClusterer` doesn't have a revision between r0 and r100 in your SVN repository. The warning was introduced in early 2008.

```
commit eee8a1742bf51df33f0f6004774035f57253f944
Author: Eric Wong <normalperson@yhbt.net>
Date:   Mon Jan 7 02:40:40 2008 -0800

    git-svn: clarify the "Ignoring error from SVN" piece

    I've heard of several users puzzled by this, and it sometimes it
    appears as if git-svn is doing nothing on slower connections and
    larger repositories.

    Signed-off-by: Eric Wong <normalperson@yhbt.net>
    Signed-off-by: Junio C Hamano <gitster@pobox.com> 
```

You can read the [original thread here](https://groups.google.com/d/msg/git-version-control/CZCX76DzWPY/4GYhb_KEmB0J) if you're interested. In the meantime, just ignore the warning. The subroutine in question, [`skip_unknown_revs`](https://github.com/git/git/blob/master/perl/Git/SVN/Ra.pm#L595-625) (warning, this link will age if the file in github changes) would kill the process if it caught an unexpected error.

# google-fusion-tables - 找到融合表几何的中心

> ID：12064291
> 
> 赞同：0
> 
> 时间：2012-08-21T23:06:04.250
> 
> 标签：google-fusion-tables

我有一个包含几何列的融合表。我希望能够缩放到那个特定的几何图形，但我没有纬度/经度。有什么办法可以找到几何的中心？另一种方法是在融合表的单独列中硬编码一个中心，但我希望能够动态地执行此操作。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:35:00.257

我有一些示例使用geoxml3 来解析存储在FusionTables 几何列中的kml（它是kml 的片段）。完成后，您可以使用 google.maps.Map fitBounds 方法缩放到该几何体。

*   [从表格缩放到单行几何图形](http://www.geocodezip.com/geoxml3_test/www_advocacy_ucla_edu_Assembly_MapC.html)
*   [缩放到表格中的多种类型/多行几何图形](http://www.geocodezip.com/geoxml3_test/indianatrails_com_fusiontables_map.html)

这些示例使用 GViz（Google 可视化库），可能有更好的方法使用新的[Fusion Tables API v1.0](https://developers.google.com/fusiontables/)

# java - 动态 JTable UI 问题

> ID：12064292
> 
> 赞同：0
> 
> 时间：2012-08-21T23:06:08.087
> 
> 标签：java, swing, jtable

我想创建一个具有类似于此的 UI 的 JTable：

![在此处输入图像描述](../Images/1681af6bdc62dde35da740119fb03f55.png)

其中“+”和“-”表示添加或删除相关行或列的按钮。为了确保按钮与现有的行和列很好地对齐，将表格扩展到数据部分之外以包括按钮似乎是最简单的。因此，上面的表格将有 5 行和 6 列。

问题：

1.  我可以在 JTable 的列标题上方放置按钮吗？
2.  我的理解是，我无法在单元格级别删除按钮和空白单元格（请参见[此处](https://stackoverflow.com/questions/3167112/remove-cells-border-in-a-jtable)）的单元格边框。那么，是否有其他方法可以使按钮与列或行对齐？
3.  您是否见过或使用过允许所需行为的类似 UI 样式？有图书馆吗？我知道这可以通过例如用于选择要删除的特定行或列的组合框来完成。但是，我更喜欢将添加/删除行/列的选项放在行/列旁边的样式。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:14:17.317

简短的回答是（大部分）是的，长的回答是有点工作。

我会利用`JScrollPane`的行标题，请参阅[setRowHeader](http://docs.oracle.com/javase/7/docs/api/javax/swing/JScrollPane.html#setRowHeader%28javax.swing.JViewport%29)了解更多详细信息。

![在此处输入图像描述](../Images/afb2c43f5e22cc122da371cdd8d40739.png)

（图片来自JavaDocs）

这将要求您布局组件以匹配每行的高度。

表头有点复杂，归结为这是否是自定义表实现。

如果您打算扩展`JTable`（或其子组件），您应该考虑替换[configureEnclosureScrollPane](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#configureEnclosingScrollPane%28%29)（和相应的[unconfigureEnclosureScrollPane](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#unconfigureEnclosingScrollPane%28%29)）方法的功能。这将允许您将其包装`JTableHeader`在自定义组件中并将其设置为滚动窗格的列标题位置。

如果没有，您将需要自己调整滚动窗格的列标题。无论哪种方式，基本方法都是相同的。

您需要一个组件，它可以使用`JTableHeader`并为您提供布局所需组件的方法。我会使用类似 a`BorderLayout`的位置和你`JTableHeader`的`South`控件`North`

恕我直言

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T05:58:26.000

如果您对替代 UI 持开放态度：项目中`JXTable`的`SwingX`一个 UI 允许隐藏某些列，或者之后将它们带回来。这当然只有在您只想隐藏/显示现有列时才有用。如果要添加全新的栏目，恐怕`SwingX`UI不够用。

对于添加/删除行，我会考虑使用包含此类操作的弹出菜单。有点类似于 Microsoft Excel 提供的功能。那里也没有 + 或 - 号，但可以通过右键单击行号来找到这些操作。

# mysql - 多条件的 PDO 查询更新？

> ID：12064295
> 
> 赞同：1
> 
> 时间：2012-08-21T23:07:05.787
> 
> 标签：mysql, database, pdo, sql-update

我需要你的帮助来解决一个小问题，这导致我在那个项目上卡住了 2 天。

我有一个这样的查询：

```
UPDATE table SET name='$name', surname='$surname'
WHERE cid=$cid AND counter=$count"; 
```

我需要用 PDO 语法编写它。现在，我知道如何在一个条件下做到这一点，但我无法让它在多个条件下工作（比如`WHERE cid=$cid AND counter=$count`）

如果我在查询中有多个条件，有人可以帮我解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T18:29:38.830

试试这个，我认为它应该工作：

```
$query = "UPDATE table SET name='$name', surname='$surname' WHERE cid = :cid AND counter = :counter";
$stmt = $db->prepare($query);
$stmt->BindValue(':cid', $cid, PDO::PARAM_STR);
$stmt->BindValue(':counter', $counter, PDO::PARAM_STR);
$stmt->execute(); 
```

编辑： $db 是您调用函数以连接到数据库的位置。

# ios - 核心数据和多对多关系

> ID：12064301
> 
> 赞同：0
> 
> 时间：2012-08-21T23:07:45.583
> 
> 标签：ios, core-data

我有以下核心数据模型：

![核心数据模型](../Images/ea30b22147d491ec688fc82f91eaa172.png)

也就是说，每个 ItemCategory 都属于`project`(reverse: `categories`)，并且可以选择属于父 ItemCategory ( `category`, reverse `subcategories`) — 请忽略其余部分。

问题是，显然我不能同时为 ItemCategory 设置项目和父类别。每次我设置一个关系时，另一个关系设置为零。我已经尝试了删除规则的所有组合，但似乎没有任何效果。

是否存在我不知道的基本核心数据限制，或者我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:03:42.663

您可以在两个实体之间建立多对多关系。重要的是，每种关系都有自己的逆向关系。假设我们有实体**A**和**B**，我们希望它们之间存在两个对多的关系。你可以这样做。

我们将从

```
A <<----->> B 
```

您**的 A**实体将具有我们称为**bs的关系和我们称为****as**的逆关系。到目前为止一切正常。

但是，没有什么能阻止您添加另一个关系：

```
 <<----->>
A           B
  <<----->> 
```

对于第二个关系，我们将从**A**到**B**的关系命名为**otherBs**，并将其命名为**otherAs**。

现在**A与****B**有两个关系，即**bs**和**otherBs**。反过来，关系也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:49:01.243

我会投票赞成“做错事”。:) 我只是尝试了一个项目的最简单形式，一个 ItemCategory，没有属性，没有其他实体，他们自己的关系......它没有显示出这种症状。这个...

```
 Project *p = [NSEntityDescription insertNewObjectForEntityForName:@"Project" inManagedObjectContext:self.managedObjectContext];
   ItemCategory *c1 = [NSEntityDescription insertNewObjectForEntityForName:@"ItemCategory" inManagedObjectContext:self.managedObjectContext];
   ItemCategory *c2 = [NSEntityDescription insertNewObjectForEntityForName:@"ItemCategory" inManagedObjectContext:self.managedObjectContext];
   c1.category = c2;
   c1.project = p; 
```

...给...

```
(lldb) po c1.category (ItemCategory *) $2 = 0x06b98bd0 <ItemCategory: 0x6b98bd0> (entity: ItemCategory; id: 0x6b98ee0 <x-coredata:///ItemCategory/tB2F1219F-4FA5-48DA-871E-D9F9DC8E33E34> ; data: {
    category = nil;
    project = nil;
    subcategories =     (
        "0x6b82280 <x-coredata:///ItemCategory/tB2F1219F-4FA5-48DA-871E-D9F9DC8E33E33>"
    ); })
(lldb) po c1.project (Project *) $3 = 0x06b97a20 <Project: 0x6b97a20> (entity: Project; id: 0x6b97a70 <x-coredata:///Project/tB2F1219F-4FA5-48DA-871E-D9F9DC8E33E32> ; data: {
    categories =     (
        "0x6b82280 <x-coredata:///ItemCategory/tB2F1219F-4FA5-48DA-871E-D9F9DC8E33E33>"
    ); }) 
```

不幸的是，这并没有说明**什么**可能是错误的，但它似乎并不是天生的限制。

# ruby-on-rails - 用户上传文件到 Heroku

> ID：12064305
> 
> 赞同：0
> 
> 时间：2012-08-21T23:08:01.010
> 
> 标签：ruby-on-rails, heroku, nginx, carrierwave

在我的应用程序中，用户可以上传他们的徽标以显示在他们的个人资料页面上（使用 Carrierwave + s3）。

在我的本地应用程序上，图像路径是这样的：[https ://s3.amazonaws.com/iemarkt/uploads/user/logo/squaredeye_336x336.jpg](https://s3.amazonaws.com/iemarkt/uploads/user/logo/squaredeye_336x336.jpg)

但是在我的 Heroku 部署的应用程序上，图像路径是“/assets/”，这会导致错误并且不允许用户上传图像。

每当我尝试在我的 Heroku 应用程序上使用 Carrierwave + s3 上传文件时，我都会收到此错误“我们很抱歉，但出了点问题。”，查看我的日志，我看到了这个错误：

```
 2012-08-20T21:18:56+00:00 app[web.1]: Started GET "/assets/" for 24.90.124.181 at 2012-08-20 21:18:56 +00002012-08-20T21:18:56+00:00 app[web.1]:2012-08-20T21:18:56+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] "/assets"): 
```

我的 store_dir

```
 "uploads/#{model.class.to_s.underscore}/#{mounted_as}/" 
```

我在我的 production.rb 中取消了这条线（我读到 Heroku 使用 Nginx，我不知道我是否需要做其他事情才能让 Nginx 工作。）

```
 config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' 
```

我真的不知道为什么路径不通向我的 s3 帐户。

这是我的[应用](https://github.com/chrisbedoya/markt)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:16:42.083

我刚刚尝试部署您的应用程序，它工作正常，看到我的用户上传了一张图片

[http://young-reaches-9187.herokuapp.com/deals/1](http://young-reaches-9187.herokuapp.com/deals/1)

我唯一更改的是载波设置，区域名称错误：您正在尝试使用该区域

`'eu-east-1'` 这不存在，所以我将其更改为： `'us-east-1'`

完整的地区列表可在此处获得： http: [//docs.amazonwebservices.com/general/latest/gr/rande.html](http://docs.amazonwebservices.com/general/latest/gr/rande.html)

顺便说一句，您不应该在您的应用程序中写入您的 AWS 凭证。例如，我刚刚上传到您的存储桶，但我本可以销毁您的文件。您应该使用环境变量。

你还应该在你的 .gitignore 中添加你的 database.yml。

# ember.js - 点击操作模型属性

> ID：12064311
> 
> 赞同：3
> 
> 时间：2012-08-21T23:08:19.457
> 
> 标签：ember.js

我最近才开始学习 Ember（到目前为止遇到了很多麻烦）。我正在尝试显示提要列表。单击提要时，我想在其标题上附加一个“x”。这应该立即在列表中更新。

这就是我所拥有的（ember 1.0 pre）。

```
var App = Em.Application.create();

App.set('Feed', Em.Object.extend({
  title: null,
  url: null,
  style: 'default',
  entries: []
}));

App.set('FeedItemView', Em.View.extend({
  tagName: 'li',
  click: function (event) {
    var feed = this.get('feed');
    feed.set('title', feed.get('title') + 'x');
    console.log(feed);
  }
}));

App.set('feedsController', Em.ArrayController.create({
  content: [],

  init: function () {
    this._super(); // IMPORTANT

    this.pushObject(App.Feed.create({
      title: 'DR - Alle nyheder 1',
      url: 'http://www.dr.dk/nyheder/service/feeds/allenyheder'
    }));
    this.pushObject(App.Feed.create({
      title: 'DR - Alle nyheder 2',
      url: 'http://www.dr.dk/nyheder/service/feeds/allenyheder'
    }));
    this.pushObject(App.Feed.create({
      title: 'DR - Alle nyheder 3',
      url: 'http://www.dr.dk/nyheder/service/feeds/allenyheder'
    }));
  }
}));

App.initialize(); 
```

以及我的 HTML 中的以下内容。

```
<script type="text/x-handlebars">
  <h1>Feeds</h1>
  <ul>
    {{#each App.feedsController}}
      {{#view App.FeedItemView feedBinding="this"}}
        {{title}}
      {{/view}}
    {{/each}}
  </ul>
</script> 
```

单击提要正确地将“x”添加到标题，但我第一次单击会出现此错误：

```
Uncaught Error: Cannot perform operations on a Metamorph that is not in the DOM. 
```

单击多次然后会产生此错误：

```
Something you did caused a view to re-render after it rendered but before it was inserted into the DOM. Because this is avoidable and the cause of significant performance issues in applications, this behavior is deprecated. If you want to use the debugger to find out what caused this, you can set ENV.RAISE_ON_DEPRECATION to true. 
```

我仔细查看了这两个，但无法弄清楚任何事情。通常产生这些错误的示例都不像我的代码。我还尝试以各种方式设置 ENV.RAISE_ON_DEPRECATION，但错误消息仍然显示。

任何帮助，将不胜感激。谢谢！:-)

**解决方案：**

显然，这是使示例工作所需要的。

```
App.ApplicationController = Em.Controller.extend();
App.ApplicationView = Em.View.extend({
  templateName: 'application'
});

App.Router = Em.Router.extend({ 
  root: Em.Route.extend()
});

App.initialize(); 
```

并且模板应该定义应该有一个名字。

```
<script type="text/x-handlebars" data-template-name="application"> 
```

在 Github 上查看[这个问题](https://github.com/emberjs/ember.js/issues/1309)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T11:25:18.053

显然，这是使示例工作所需要的。

```
App.ApplicationController = Em.Controller.extend();
App.ApplicationView = Em.View.extend({
  templateName: 'application'
});

App.Router = Em.Router.extend({ 
  root: Em.Route.extend()
});

App.initialize(); 
```

并且模板定义应该有一个名字。

```
<script type="text/x-handlebars" data-template-name="application"> 
```

在 Github 上查看[这个问题](https://github.com/emberjs/ember.js/issues/1309)。

# oracle - Oracle 日期计算 trunc(sysdate)

> ID：12064312
> 
> 赞同：3
> 
> 时间：2012-08-21T23:08:28.807
> 
> 标签：oracle, datetime, truncate, date-arithmetic

我需要从 Oracle 数据库中对基于特定日期范围的报告的查询进行限定

第一次查询

5pm-7am（昨天5pm和今天7am之间）

第二次查询

早上 7 点到下午 5 点（（昨天下午 5 点之间，今天早上 7 点）

我该怎么做？？？我需要知道 Oracle 语法才能指定这些日期标准

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T23:28:08.047

我可能会做类似的事情

```
WHERE some_date_col BETWEEN trunc(sysdate-1) + interval '17' hour -- 5pm yesterday
                        AND trunc(sysdate) + interval '7' hour -- 7am today 
```

和

```
WHERE some_date_col BETWEEN trunc(sysdate) + interval '7' hour -- 7am today
                        AND trunc(sysdate) + interval '17' hour -- 5pm today 
```

还有另一个关于[向日期添加小时和分钟的](https://stackoverflow.com/questions/257324/oracle-how-to-add-minutes-to-a-timestamp/257399#257399)线程，其中更详细地介绍了指定日期偏移的不同方法。

# php - 这个 PHP 广告收益分享逻辑有效吗？

> ID：12064314
> 
> 赞同：2
> 
> 时间：2012-08-21T23:08:40.397
> 
> 标签：php, algorithm, math

我在我的网站中添加了一个广告收入共享系统，我构建了所有内容，用于广告共享逻辑

```
$random_number = mt_rand(1,10);

if (($random_number >= 1) && ($random_number < 8)) { //gets 1-7 for 70%
$ads = "USER-ADS";
}

if (($random_number >= 8) && ($random_number < 11)) { //gets 8,9, and 10 for 30%
$ads = "ADMIN-ADS";
} 
```

这个逻辑有效吗？

我想在 70% 的浏览量中向用户展示广告，并在剩下的 30% 中展示我的广告

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T23:28:33.273

逻辑看起来不错。你可以使用

```
if ($random_number < 8) {
$ads = 'USER-ADS';
} elseif ($random_number >= 8) {
$ads = 'ADMIN-ADS';
} 
```

因为它更紧凑并且（微不足道）更快。

# c++ - _bstr_t for Linux 的极简实现

> ID：12064316
> 
> 赞同：1
> 
> 时间：2012-08-21T23:09:05.957
> 
> 标签：c++, visual-c++, porting

我有一个我想移植到 linux 的 windows 代码。在一个地方它使用_bstr_t。我想知道是否有可用的最小 _bstr_t 端口。我四处寻找 - 但找不到。

我要移植的 Windows 代码是这样的 -

```
char **p;
// Malloc and assign some value to *p
_bstr_t str((wchar_t *)*p);
memcpy((char *)*p, (char *)str, len); 
```

我四处搜索，发现 _bstr_t 对象有一个 (char*) 运算符，它将字符串作为单字节字符串返回。所以我本质上要寻找的是一个构造函数和重载的 (char *) 运算符。

关于在哪里可以找到 _bstr_t 的任何可用端口的任何建议？或者关于我应该如何继续实施这个最小的_bstr_t的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:12:49.027

如果您只需要为您处理内存管理的字符串，请使用`std::string`(for `char`-based strings) 或`std::wstring`(for `wchar_t`-based strings。)

是否有特定于`BSTR`您在 Linux 中需要的类型的东西？也许是您想要一个等价的特定 API 函数？

# redis - Redis 设置默认顺序

> ID：12064317
> 
> 赞同：4
> 
> 时间：2012-08-21T23:09:06.153
> 
> 标签：redis

在 Redis 集（未排序集）中。我注意到这些值是按照它们添加的顺序排列的，最新的是在前。如果该集合将始终保持此顺序，我没有在文档中找到。所以我的问题是，我可以相信他们会一直这样订购吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T02:58:22.640

通常，您不能相信元素的顺序。如果您希望它按特定顺序排列，您可以使用列表或排序集。

Set 是使用 HashTable 构建的。绝对不能保证元素的顺序。

但是，如果您的 set 仅包含整数，并且元素的数量小于指令`set-max-intset-entries`（默认为 512） - 那么该 set 建立在称为 IntSet 或 Integer Set 的结构上。整数集是一个排序的整数数组。这种集合的迭代器将按升序返回元素。

因此，更具体地说，如果您可以对整数集进行编程，则可以假设元素将按排序顺序排列。

# resteasy - Resteasy - 从 C# 登录

> ID：12064320
> 
> 赞同：1
> 
> 时间：2012-08-21T23:09:14.160
> 
> 标签：resteasy

我有一个需要从 C# 应用程序调用的 Resteasy 服务；保护我想从服务中获得的内容的最佳方式是什么？我正在寻找一个教程，因为我不熟悉 Java 中的 Web 服务，但我找不到任何东西......

谢谢你的帮助！

# javascript - jQuery Mobile 站点中所有页面共有的弹出窗口

> ID：12064321
> 
> 赞同：4
> 
> 时间：2012-08-21T23:09:21.943
> 
> 标签：javascript, jquery, html, jquery-mobile

我正在尝试使用 jQuery Mobile 制作网站。它由 HTML 文件中的许多页面组成，其中一些只有一页，而另一些则有多个页面（使用它们的[多页功能](http://jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/page-anatomy.html)）。

该站点将有一些通知弹出窗口，并且它们在所有页面上看起来都相同。我正在使用他们似乎为此目的设计的[新弹出功能来实现弹出窗口。](http://jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/popup/index.html)我可以通过在每个页面上放置弹出窗口的副本来轻松实现这一点，但这会产生大量可能难以维护的冗余代码。我可能可以让我的服务器在适当的地方为我插入代码，但这看起来既复杂又低效。

[我尝试将弹出窗口放在页面之外，但它们不能可靠地工作（您可以在此处](http://eliasz.net/jQueryMobilePopupTest/jQueryMobilePopupTest1.html)查看示例）。

我尝试使用模板系统（内置于 underscore.js 中的系统）动态生成它们，但这看起来可能会导致问题——我必须在每个弹出窗口关闭时销毁它以避免内存泄漏。

我不确定这是否是弹出窗口小部件中的错误，这似乎是因为弹出窗口小部件仅在 jQuery Mobile 的 alpha 版本中。

这里有没有人知道如何在几个 html 文件中创建一个包含许多页面的网站，以及所有页面共有的一些弹出窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T13:15:57.187

我在 jQuery Mobile github 上看到了您的请求，并发布了我在我的 Web 应用程序上使用的解决方案。查看[http://ghita.org/jquery/dynamic-mobile-popup](http://ghita.org/jquery/dynamic-mobile-popup)这是一个小插件，可以让您拥有动态弹出窗口，它可以让您专注于弹出窗口**的内容**和**事件**。

包含插件（有**1.8kb**），然后调用：

```
$.dynamicPopup({content: 'This is the dynamic content of the popup.'}); 
```

**content** - 可以是字符串或 jQuery html 对象。

查看[https://github.com/serbanghita/jQM-dynamic-popup](https://github.com/serbanghita/jQM-dynamic-popup)以获取完整的选项列表，其中一些选项继承自 jQuery 的移动 popup() 函数。

这个问题对我来说是一个阻碍，因为我有动态网页，我不关心手动注入 HTML 内容以使 popup() 处于活动状态。希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T13:48:32.493

参加聚会可能很晚，但可能对遇到的人有用。

如果您使用最新的 JQM（我使用的是 JQM 1.4.2），现在您可以使用 Global Popups。您只需要在所有数据角色页面之外的 body div 下直接声明弹出窗口。

最好通过这个[JQM 文档](http://demos.jquerymobile.com/1.4.2/popup-outside-multipage/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:23:24.103

您必须尝试像 jqm 加载器一样设置它，它也位于 div.page 之外（否则您将在 dom 内的每个页面都有一个加载器），所以我认为正确的方法是不包括弹出窗口在一个页面内，但在 div.page 之外。

因为 jqm 只会拉入 div.pages 而之前/之后什么都没有，你应该能够在每个页面上包含一个通用的弹出框，并且只能在 dom 中使用一次。不确定这在 div.page 之外是否有效。

# mysql - 如何将 ID 列表传递给 MySQL 存储过程？

> ID：12064322
> 
> 赞同：27
> 
> 时间：2012-08-21T23:09:30.433
> 
> 标签：mysql, stored-procedures

我正在编写一个存储过程，它应该将其参数传递给`IN (..)`过程主体中的部分查询，如下所示：

```
DELIMITER //

CREATE PROCEDURE `get_users_per_app` (id_list TEXT)
BEGIN
    SELECT app_id, GROUP_CONCAT(user_id) FROM app_users WHERE app_id IN (id_list) GROUP BY app_id;
END//

DELIMITER ; 
```

显然，这不起作用，因为当我传递一个文本值时，`id_list`它被插入为一个整数，并且在条件内部只考虑和使用第一个 ID `IN()`。

我意识到这种特殊类型的过程可以被包含的查询代替，但我认为我的问题仍然存在——如果我需要传递这种数据怎么办？

*我也意识到这种查询方法可能不被认为是最佳实践，但在我的用例中，它实际上比返回 ID-ID 对的平面列表更好。*

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-08-21T23:18:43.463

您应该能够使用 MySQL[`FIND_IN_SET()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)来使用 id 列表：

```
CREATE PROCEDURE `get_users_per_app` (id_list TEXT)
BEGIN
    SELECT
        app_id, GROUP_CONCAT(user_id)
    FROM
        app_users
    WHERE
        FIND_IN_SET(app_id, id_list) > 0
    GROUP BY app_id;
    ... 
```

# html - C 语言的 HTML 解析器库

> ID：12064324
> 
> 赞同：0
> 
> 时间：2012-08-21T23:09:41.303
> 
> 标签：html, c, parsing

我只需要一个建议。我有一个接受有效 html 并将其保存到文件的程序，我需要一种方法来解析此 html 文件以检索该 html 文件中记录的每个图像。（例如 /foo/bar.jpg）。是否有我可以用来实现此目的的 html 解析库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T02:54:00.453

如果您只需要提到的 .jpg 文件，那么您应该只使用文件阅读器和正则表达式匹配器来寻找 .jpg 文件名之类的字符串，从而获得非常好的结果（例如，很少的误报）。

即使你有一个完美的 HTML 解析器，你也不会得到所有的 .jpg 文件，因为一些文件名可能由你无法解释的 JavaScript 文本组合而成，所以不完美似乎并不重要亏损。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T02:48:32.410

半个答案：有一个名为[Tagsoup的](http://mercury.ccil.org/~cowan/XML/tagsoup/)*Java*解析器，它将“Just Keep On Truckin'”，解析带有尖括号的任何内容，并始终为应用程序生成一组有效的事件。

我之所以提到这一点，是因为我知道这个想法*以及*至关重要的名称已被其他语言中具有相同意图的图书馆采用。我现在找不到 C 版本，但是如果您尝试以该起点进行一些创造性的搜索，您可能会更幸运（关键是位于解析器之上的应用程序不必关心原始源，但可以假装它是格式良好的 XML，并对它做 XMLish 的事情）。

**编辑：**哦，还有……我们去[Taggle](http://www.jezuk.co.uk/cgi-bin/view/arabica/log?id=3591)（C++，但可能足够接近，并且该帖子表明从 Java 移植它并不难）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T23:15:46.943

有[libXml2](http://www.xmlsoft.org/%20libXml2) 。但这可能要求文件是 XHTML，而不是 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-25T14:52:23.560

[Gumbo 解析器](https://github.com/google/gumbo-parser)，由 Google 提供。它是一个纯 C 语言的 HTML5 解析器，没有依赖项

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-26T21:53:42.443

我想你可以使用libcurl，我以前用它来解析HTML网站中的常规排泄物，以检索图片和电子邮件。如果我找到代码，我可以为您提供一些提示。

# javascript - 如何在页面加载时只打开一次灯箱

> ID：12064330
> 
> 赞同：0
> 
> 时间：2012-08-21T23:10:11.823
> 
> 标签：javascript, html

我只想在页面加载时在我的主页上显示一个灯箱，而不是在我刷新页面时再次显示。我是新手 javascript

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:16:56.137

我会设置一个cookie，无论是会话还是更长的范围。互联网上有大量关于如何访问/设置 cookie 值的示例：[例如](http://www.cookiecentral.com/demomain.htm).

# java - 使用 Java 捕获和显示图像

> ID：12064331
> 
> 赞同：1
> 
> 时间：2012-08-21T23:10:16.280
> 
> 标签：java, image, swing, jlabel

我想创建一个捕获屏幕（1280x720 res）然后显示它的应用程序。这个代码在一个while循环中，所以它正在进行中。这是我所拥有的：

```
import javax.swing.*;

import java.awt.Rectangle;
import java.awt.Robot;
import java.awt.image.BufferedImage;

public class SV1 {

    public static void main(String[] args) throws Exception {
        JFrame theGUI = new JFrame();
        theGUI.setTitle("TestApp");
        theGUI.setSize(1280, 720);
        theGUI.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        theGUI.setVisible(true);

        Robot robot = new Robot();

        while (true) {
            BufferedImage screenShot = robot.createScreenCapture(new Rectangle(1280,720));

            JLabel picLabel = new JLabel(new ImageIcon( screenShot ));
            theGUI.add(picLabel);
        }
    }
} 
```

我从[这个答案](https://stackoverflow.com/a/2706730/303221)中发现了这一点，但它并不适合我想要的。首先，由于某种我不确定的原因，它会导致 java 耗尽内存“Java 堆空间”。其次，由于显示的图像未更新，因此无法正常工作。

我读过有关使用 Graphics (java.awt.Graphics) 绘制图像的信息。谁能给我看一个例子？或者，如果有更好的方法，也许可以为我指明正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:31:31.367

> 它导致java内存不足“Java堆空间”

您将永远循环并不断将新的 JLabels 添加到您的`JFrame`. 您可以尝试而不是每次都重新创建 JLabel，而只需设置一个新的 ImageIcon：

```
JLabel picLabel = new JLabel();
theGUI.add(picLabel);
while (true) 
{
    BufferedImage screenShot = robot.createScreenCapture(new Rectangle(1280,720));
    picLabel.setIcon(new ImageIcon(screenShot));   

} 
```

如果你想使用绘画`Graphics`（在这种情况下它可能是一个更好的主意），你可以扩展一个`JLabel`和覆盖`paintComponent`方法，在其中绘制图像：

```
public class ScreenShotPanel extends JLabel
{

    @override
    public void paintComponent(Graphics g) {
        BufferedImage screenShot = robot.createScreenCapture(new Rectangle(1280,720));
        g.drawImage(screenShot,0,0,this);
    }
} 
```

# c++ - 将派生类数组分配给基类指针

> ID：12064333
> 
> 赞同：3
> 
> 时间：2012-08-21T23:10:22.317
> 
> 标签：c++

```
#include <iostream> 
class B { 
public: 
 B () : b(bCounter++) {} 
int b; 
static int bCounter;  
}; 
int B::bCounter = 0; 
class D : public B { 
public: 
D () : d(bCounter) {} 
int d; 
}; 
const int N = 10; 
B arrB[N]; 
D arrD[N]; 
int sum1 (B* arr) { 
    int s = 0; 
    for (int i=0; i<N; i++) 
         s+=arr[i].b; 
    return s; 
} 
int sum2 (D* arr) { 
     int s = 0; 
     for (int i=0; i<N; i++) s+=arr[i].b+arr[i].d; 
     return s; 
} 
int main() { 
    std::cout << sum1(arrB) << std::endl; 
    std::cout << sum1(arrD) << std::endl; 
    std::cout << sum2(arrD) << std::endl; 
    return 0; 
} 
```

问题出在 main 函数的第 2 行。我希望当 sum1() 函数使用参数 arrD（它是派生类对象的数组）调用时，它会简单地“切断”D::d，但在这种情况下，它会重新排列 arrD 中的顺序，并且求和是这样的： 10+11+11+12+12+13+13+14+14+15 它似乎在 arrD[i] 的 b 和 d 字段之间交替，它应该只总结 b 字段. 有人可以解释为什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T00:46:40.707

您很不幸地碰到了允许编译完全无效代码的类型系统的最佳位置之一。

该函数根据签名将指向对象`int sum1 (B* arr)`的指针作为参数，但从语义上讲，它实际上需要指向对象*数组*的指针。当您调用时，您通过传递的不是对象*数组*而是对象*数组*而违反了该合同。它们有何不同？指针运算是根据指针类型的大小来做的，一个对象和一个对象有不同的大小。`B`*`B``sum1(arrD)`*`B`*`D``B``D`***

 ****一个数组`D`不是一个数组`B`*

通常，派生类型的容器**不是**基类型的容器。如果您考虑一下，容器的契约`D`是它包含`D`对象，但是如果容器`D`是 的容器`B`，那么您将能够添加`B`对象（如果参数是扩展的，您甚至可以考虑添加`D1`对象——也派生自`B`！）。

如果您使用的是高阶构造而不是原始数组，例如`std::vector`编译器会阻止您传递 a`std::vector<D>`代替 a `std::vector<B>`，但是为什么在数组的情况下它没有阻止您呢？

*如果数组 of`D`不是 数组`B`，那么程序为什么会编译？*

这个问题的答案早于 C++。在 C 中，函数的所有参数都是按值传递的。有些人认为您也可以*按指针传递*，但这只是*按值*传递指针。但是数组*很大*，按值传递数组会非常昂贵。同时，当您动态分配内存时，您使用*指针*，尽管从概念上讲，当您 malloc 10 s 时，`int`您正在分配一个*数组*`int`. C 语言的设计者考虑到了这一点，并对按值传递规则做了一个例外：如果您尝试按值传递数组，则会获得指向第一个元素的指针，并且传递的是该指针而不是数组（类似函数存在规则，您不能*复制*函数，因此传递函数隐式获取指向函数的指针并传递它）。从一开始，相同的规则就出现在 C++ 中。

现在，下一个问题是类型系统并没有区分指向元素的指针（当它是所有元素时）和指向作为数组一部分的元素的指针。这会产生后果。指向`D`对象的指针可以隐式转换为指向 的指针`B`，因为`B`它是 的基础`D`，并且 OO 编程的整个对象能够使用派生类型代替基础对象（嗯，为了多态性）。

现在回到你的原始代码，当你写的时候`sum1( arrD )`， ,`arrD`被用作一个*右值*，这意味着数组衰减到一个指向第一个元素的指针，所以它实际上被转换为`sum1( &arrD[0] )`。子表达式`&arrD[0]`是一个指针，而一个指针只是一个指针...`sum1`接受一个指向 a 的指针`B`，而指向的指针可以`D`隐式转换为指向 的指针`B`，因此编译器很乐意为您进行转换`sum1( static_cast<B*>(&arrD[0]) )`：如果函数只是获取指针并将其用作单个元素，那很好，因为您可以传递 a`D`代替 a `B`，但数组 of`D`不是`B`... 即使编译器允许您传递它就这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T23:17:40.453

a 的大小`B`小于 a 的大小`D`。所以当`sum1`迭代指针时`arr`，`arr[1]`它指向的是它认为是`B`数组中的第二个元素，它实际上是在第一个`D`元素的中间。

所以（假设没有填充），`arrD`有这样的布局：

```
arrD: | 2 ints    | 2 ints    | 2 ints    | ... 
```

但是，你`B *arr`给它设置了一个，让它`sum1`认为它是一个 B 的数组。所以`sum1`会认为参数有这样的布局：

```
arr:  | int | int | int | int | int | int | ... 
```

所以，`arr[1]`实际上是 的`d`成员`arrD[0]`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-21T23:25:11.453

你`arr`是 type `B*`，这意味着`arr[i]`或者会在内存中`(arr + i)`前进。`sizeof(B) * i`内存看起来像这样：

> **10 11 11 12 12 13 13 14 14 15** 15 16 16 17 17 18 18 19 19 20

而 for 循环添加

> 10 11 11 12 12 13 13 14 14 15

这正是内存中的第一个元素，而不是`sizeof(D) * i`像你想要的那样前进。***

# c# - 来自 Web 服务的数据类型渗入 COM TypeLib

> ID：12064336
> 
> 赞同：0
> 
> 时间：2012-08-21T23:10:34.437
> 
> 标签：c#, .net, service, web, typelib

我有一个小的 .NET 组件，将 COM 接口暴露给旧版客户端。接口本身非常简单（4 个方法），参数都是简单类型（字符串、整数等）。该组件在内部使用一个 Web 服务——作为服务引用添加——它公开了大量的类。当我从我的组件生成 COM 类型库时，Web 服务中的所有类型都会将其放入 - 即使不需要它。我需要做些什么来防止这种情况发生？我可以以某种方式将我正在使用的 Web 服务中的所有内容标记为私有吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:44:51.330

暴露 COM 组件很痛苦，你的整个项目是可共享的吗？我建议不要将其标记为可可见，然后使用可可见（true）属性显式标记要公开的每个类。我相信第一个链接是您的确切问题。

您可以查看一些参考资料：

[如何优雅地防止 Web 服务代理暴露给 COM？](https://stackoverflow.com/questions/1649752/how-to-elegantly-prevent-a-webservice-proxy-from-being-exposed-to-com/1649768#1649768)

[为什么不鼓励将程序集标记为 ComVisible(true)？](https://stackoverflow.com/questions/3309764/why-is-marking-an-assembly-comvisibletrue-discouraged)

# clojure - 如何使用 leningen 将 .clj 文件作为脚本运行？

> ID：12064339
> 
> 赞同：38
> 
> 时间：2012-08-21T23:10:39.620
> 
> 标签：clojure, leiningen

[这是在 Leiningen 中是否有独立的 Clojure 包](https://stackoverflow.com/questions/12064001/is-there-a-standalone-clojure-package-within-leiningen/12064211#12064211)之后的第二个问题？

例如，我有一个文件`hello_world.clj`，我可以使用

`java -cp clojure.jar clojure.main hello_world.clj`.

由于**lein**已经包含**Clojure**（因为我可以`lein repl`直接运行），有没有办法做同样的事情

`lein script hello_world.clj`莱因？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2015-01-29T11:23:28.860

有几种方法`lein repl`：

*   非常慢：`cat your_file.clj | lein repl`
*   慢的：`echo '(load-file "your_file.clj")' | lein repl`
*   快速地：
    1.  `lein repl`
    2.  `(load-file "your_file.clj")`
    3.  重复`2`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-08-22T00:45:48.150

使用[lein-exec](https://github.com/kumarshantanu/lein-exec)插件，来自 readme.md 的示例（更新为“lein”而不是“lein2”）

```
cat foo.clj | lein exec
lein exec -e '(println "foo" (+ 20 30))'
lein exec -ep "(use 'foo.bar) (pprint (map baz (range 200)))"
lein exec -p script/run-server.clj -p 8088
lein exec ~/common/delete-logs.clj 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-21T23:12:57.150

leiningen 可以为您创建一个包含所有依赖项的“uberjar”....

```
lein uberjar 
```

将在目标子目录中为您创建一个 jar。该 jar 将包含您列出的所有依赖项`project.clj`，因此您无需担心构建复杂的类路径来调用您的代码。

您可以以正常方式将此 uberjar 作为 Java 类路径中的单个条目引用，或者在`project.clj`调用它时指定一个主类作为可执行 jar。

例如`project.clj`这样的：

```
(defproject clj-scratch "1.0.0-SNAPSHOT"
 :description "FIXME: write description"
 :dependencies [[org.clojure/clojure "1.4.0"]                     
 :main clj-scratch.core) 
```

将调用`-main`函数`clj-scratch.core namespace`

如果你运行：

```
java -jar target/clj-scratch-1.0.0-SNAPSHOT-standalone.jar 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-05T11:03:57.070

我喜欢为此使用[inlein](https://github.com/hypirion/inlein)。

```
#!/usr/bin/env inlein

'{:dependencies [[org.clojure/clojure "1.8.0"]
                 [com.hypirion/primes "0.2.1"]]}

(require '[com.hypirion.primes :as p])

(when-not (first *command-line-args*)
  (println "Usage:" (System/getProperty "$0") "prime-number")
  (System/exit 1))

(-> (first *command-line-args*)
    (Long/parseLong)
    (p/get)
    println) 
```

然后`chmod +x script.clj`运行它！

或者，您也可以`inlein script.clj my args here`。

# c# - 对两个有关系的列表进行排序

> ID：12064343
> 
> 赞同：-2
> 
> 时间：2012-08-21T23:11:22.313
> 
> 标签：c#, list, sorting

因为我可以对两个列表或两个向量进行排序，即我对一个列表（距离）进行排序，并根据她的顺序，因为我订购了另一个保留索引的列表。谢谢。

钯。我正在研究网络框架 2.0

```
List1          List2
[0]=125        [0]=1
[1]=130        [1]=2
[2]=124        [2]=3
[3]=128        [3]=4 
```

排序 List1 后我想要这个

```
List1          List2
[0]=124        [0]=3
[1]=125        [1]=1
[2]=128        [2]=4
[3]=130        [3]=2 
```

钯。我的列表有2000条记录...

我能做到吗？谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:18:23.387

```
List<decimal> scores = GetScores();
List<Fruit> fruit = GetFruit();

List<Tuple<decimal, Fruit>> sortedPairs = scores
  .Zip(fruit, (s, f) => Tuple.Create(s, f))
  .OrderBy(x => x.Item1)
  .ToList();

scores = sortedPairs.Select(x => x.Item1).ToList();
fruit = sortedPairs.Select(x => x.Item2).ToList(); 
```

现在您所要做的就是实现 Zip、OrderBy、Select、ToList 和 Tuple。

# php - 邮件（）无法正常工作

> ID：12064344
> 
> 赞同：2
> 
> 时间：2012-08-21T23:11:55.493
> 
> 标签：php, email

我正在尝试在发送表单但没有任何事情发生时发送电子邮件。我使用 winHost 作为提供者。我试过制作一个单独的 .php 文件来测试 mail() 函数但没有雪茄 - `mail('myemail','dfd','dsaf','dasfda');`

这是我的邮寄设置-

```
 $to = $agentemail;
$subject = "";
$message = "";
$from = "";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers); 
```

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T08:25:22.203

正如@alfasin 所指出的，您需要遵循他提供给[WinHost 知识库](http://support.winhost.com/KB/a826/how-to-send-email-from-a-php-application.aspx)的第一个链接上的示例代码：

您需要将主机和用户名替换为您已设置的实际电子邮件帐户的详细信息。

```
<?php 
require_once "Mail.php"; 
$from = "Sender <postmaster@HostingAccountDomain.com>"; 
$to = "Recipient <user@HostingAccountDomain.com>"; 
$subject = "This is a test email sent via php"; 
$body = "This is a test email"; 

$host = "mail.HostingAccountDomain.com"; 
$username = "postmaster@HostingAccountDomain.com"; 
$password = "email_password"; 

$headers = array ('From' => $from, 
                  'To' => $to, 
                  'Subject' => $subject); 

$smtp = Mail::factory('smtp', 
                      array ('host' => $host, 
                             'auth' => true, 
                             'username' => $username, 
                             'password' => $password)
                      ); 
$mail = $smtp->send($to, $headers, $body); 
?> 
```

# c - c中for循环的测试计数器中的s [i]

> ID：12064348
> 
> 赞同：0
> 
> 时间：2012-08-21T23:12:16.887
> 
> 标签：c

```
 main()
{
char s[ ]="man";
int i;
for(i=0;s[ i ];i++)
printf("\n%c%c%c%c",s[ i ],*(s+i),*(i+s),i[s]);
} 
```

for 循环中的 s[i] 是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:13:36.683

一旦`i`达到3，`s[i]`将`\0`因此结束循环。

请记住，这`char s[]="man";`会产生以下数组：

```
char s[] = {'m', 'a', 'n', '\0'}; 
```

这就是为什么`s[3]`评估为`'\0'`导致控制语句终止循环的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:14:45.840

这是 foo 循环的谓词，并自动转换为布尔值。就像写作一样`s[i] != '\0'`。C 字符串以零结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:14:54.777

循环继续直到`s[i]`计算为非零值。由于 C 字符串以空（=零）终止，因此`for`循环将增加`i`，直到`s`检查完所有字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T23:21:13.910

好吧，在任何 for 循环中，中间语句是循环的条件，而循环将继续循环自身。与您的陈述相反（例如）将`for(i=0;!s[ i ];i++)`意味着循环只会在`s[i]`错误时重复自身。另一个例子：

`for(i = 0; i <= 10; i++);` 只要`i`小于或等于 10，此循环就会不断重复，从而使计数到 10 并在每次 i 递增时执行一个动作变得很简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T23:15:19.423

这是for循环的条件。

在 C 中，任何不同于 NULL,'\0',0 的值都被评估为真。因此，只要 s[i] 不采用 '\0' ，它就会被评估为真。

# javascript - 仅在需要时加载 javascript 函数

> ID：12064349
> 
> 赞同：1
> 
> 时间：2012-08-21T23:12:28.270
> 
> 标签：javascript, function, load

我有一个包含很多 javscript 功能的网页。这项工作要求拥有一个 html 文件并调用同一页面内的所有部分，并在不离开页面的情况下用新内容替换“旧内容”。（请不要告诉我这是不是一个好主意。）

因此，所有这些都是站点工作所必需的，但不必在开始时加载它们。单击按钮时是否有任何表单可以加载和调用函数？

我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:51:22.490

我建议您将 javascript 放在两个文件中。

在文件 1 中放置最低限度，在文件 2 中放置其余部分。您可以通过执行以下操作在需要时加载文件 2：

```
var script = document.createElement('script');
script.type = 'application/javascript';
script.src = 'name_of_script_2.js';
document.head.appendChild(script); 
```

您还应该研究缩小和压缩。例如[谷歌的闭包编译器](https://developers.google.com/closure/compiler/)。（从空白优化开始，然后尝试简单的优化。高级优化需要特殊的东西才能工作）并确保您压缩文件以使其尽可能小。

# python - pyGTK 和 Builder XML 文件的最佳实践

> ID：12064350
> 
> 赞同：1
> 
> 时间：2012-03-27T15:34:22.927
> 
> 标签：python

我通常使用 Glade 设计 GUI，从而生成一系列 Builder XML 文件（每个应用程序窗口都有一个这样的文件）。

现在我的想法是定义一个类，例如 MainWindow，它继承自 gtk.Window 并实现应用程序主窗口的所有信号处理程序。问题是当我从包含的 XML 文件中检索主窗口时，它作为 gtk.Window 实例返回。

到目前为止我采用的解决方案如下：

我通过以下方式定义了一个类“Window”

```
class Window():
def __init__(self, win_name):
    builder = gtk.Builder()
    self.builder = builder
    builder.add_from_file("%s.glade" % win_name)
    self.window = builder.get_object(win_name)
    builder.connect_signals(self)

def run(self):
    return self.window.run()

def show_all(self):
    return self.window.show_all()

def destroy(self):
    return self.window.destroy()

def child(self, name):
    return self.builder.get_object(name) 
```

在实际的应用程序代码中，我定义了一个新类，比如 MainWindow，它继承了 frow Window，看起来像

```
class Main(Window):
def __init__(self):
    Window.__init__(self, "main")

### Signal handlers #####################################################

def on_mnu_file_quit_activated(self, widget, data = None):
    ... 
```

字符串“main”指的是主窗口，称为“main”，它驻留在 XML Builder 文件“main.glade”中（这是我决定采用的一种约定）。

所以问题是：如何通过定义类 Foo(gtk.Window) 直接从 gtk.Window 继承，并将 builder.get_object(win_name) 的返回值重铸为 Foo？

# jquery - 为什么我的 JQuery .Ajax 将数据加载到新页面而不是替换指定元素？

> ID：12064355
> 
> 赞同：0
> 
> 时间：2012-08-21T23:13:06.030
> 
> 标签：jquery

使用 JQuery .ajax 时，我的内容被放入一个新页面，而不是替换指定的元素。我在同一个站点中使用了非常相似的东西，没有问题，但是这一节不喜欢某些东西并抛出此错误：

Microsoft JScript 运行时错误：预期对象

选择 Continue 后，它将数据加载到新页面而不是指定的选择器中。

我在 _Layout 页面中包含以下内容：

*   < script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"/>
*   < script src="@Url.Content("~/Scripts/jquery-ui-1.8.11.min.js")" type="text/javascript"/>
*   < script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"/>

页面代码如下：

```
<link href="../../Content/themes/base/jquery.ui.autocomplete.css" rel="stylesheet" type="text/css" />
<link href="../../Content/Tasks.css" rel="stylesheet" type="text/css" />

<script type="text/javascript">
$(document).ready(function () {
    $('#btnSaveNewTicket').hide();
    $('#frmTaskDetail').one('submit', function (e) {
        e.preventDefault();
        alert('tru dat');
        $.ajax(
        {
            cache: false,
            async: true,
            type: "POST",
            url: $(this).attr('action'),
            data: $(this).serialize(),
            success: function (data) {
                $('#divTaskDetail').empty();                
                $('#divTaskDetail').html(data);
            },
            complete: function () {
                $('#hidTdAccId').val('');
                $('#hidTdUserId').val('');
                $('#hidTdTicketId').val('');
            }
        });
        return false;
    });

});
</script>

<div id="divTaskDetail">
@using (Html.BeginForm("DetermineTicketAction", "Dispatch", FormMethod.Post, new { id = "frmTaskDetail" }))
{
<div style="background-color: #2C6B87; width: 99%; border: 1px black solid; text-align: left; text-indent: 5px; margin: 1% 0 0 0; padding: 5px 0 5px 0; font-size: 12px; color: white; font-weight: bold">
    Task Details
</div>
<div style="width: 99%; border: 1px black solid;">

    @Html.Hidden("AccountId")       
    @Html.Hidden("ContactId")
    @Html.Hidden("CompanyId")
    @Html.Hidden("TicketId")
    @Html.Hidden("TicketCreated")
    @Html.Hidden("Created")
    @Html.Hidden("TicketClosed")
    @Html.Hidden("isActive")

    <table id="tblTaskDetail" style="width: 100%; text-indent: 5px; color: White; margin: 0 auto; font-size: 12px; top: 0; left: 0;">                    
                <tr>
                    <td>Ticket ID</td>
                    <td>@Html.TextBox("TicketId" ,null, new { @disabled = true })</td>
                    <td>Address</td>
                    <td>@Html.TextBox("Address", null, new {@disabled = true })</td>

                </tr>
                <tr>
                    <td>Date Created</td>
                    <td>@Html.TextBox("Created",null, new { disabled = true })</td>
                    <td>City</td>
                    <td>@Html.TextBox("City",null, new { disabled = true })</td>
                </tr>
                <tr>
                    <td>Company Name</td>
                     <td>@Html.TextBox("CompanyName")<input type="button" id="addCompany" value="+" /></td>
                    <td>State</td>
                    <td>@Html.TextBox("State",null, new { disabled = true })</td>
                </tr>
                <tr>
                    <td>Customer Name</td>                    
                    <td>@Html.TextBox("ContactName")<input type="button" id="addContact" value="+" /></td>
                    <td>Zip Code</td>
                    <td>@Html.TextBox("ZipCode", null, new { disabled = true })</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>@Html.DropDownList("CategoryId")</td>
                    <td>Phone Number</td>
                    <td>@Html.TextBox("Phone", null, new { disabled = true })</td>
                </tr>
                <tr>
                    <td>Status</td>
                    <td>@Html.DropDownList("StatusId")</td>
                    <td>E-mail</td>
                    <td>@Html.TextBox("Email", null, new { disabled = true })</td>
                </tr>
                <tr>
                    <td>Priority</td>
                    <td>@Html.DropDownList("PriorityId")</td>
                    <td>Paid</td>
                    <td>@Html.DropDownList("Paid")</td>
                </tr>
                <tr>
                    <td>Task Description</td>
                    <td>@Html.Editor("Description")</td>
                    <td>Assign To</td>
                    <td>@Html.DropDownList("UserId")</td>
                </tr>       
    </table>
    <table style="width: 100%; text-indent: 5px; color: White; margin: 0 auto; font-size: 12px; top: 0; left: 0;">
        <tr>
            <td>Comments @Html.TextBox("Comments", "", new { style = "width: 15%" })</td>
         </tr>
        <tr>
            <td> 
                @Html.ListBox("CommentList", @ViewBag.CommentList as IEnumerable<SelectListItem>, new { id="CommentList", style = "font-size: 10px" })
            </td>
        </tr>
    </table>

    <input type="hidden" id="hidTdAccId" name="hidTdAccId" value="" />
    <input type="hidden" id="hidTdUserId" name="hidTdUserId" value="" />
    <input type="hidden" id="hidTdTicketId" name="hidTdTicketId" value="" />
    <input type="hidden" id="hidSubType" name="hidSubType" value="" />
</div>

<input type="submit" id="btnSave" name="btnSave" value="Save" />
<input type="button" id="btnClearTicket" name="btnClearTicket" value="New Ticket"/>
<input type="submit" id="btnSaveNewTicket" name="btnNewTicket" value="Save New Ticket" />
<input type="submit" id="btnGetDetail" name="btnGetDetail"  style="visibility: hidden"  />
}
</div> 
```

任何帮助/想法表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:52:24.177

出于某种原因，Jquery ajax 在 chrome/safari 中运行良好，但不适用于 IE。用 Ajax 助手替换 JQuery Ajax 为我解决了问题。

感谢您的帮助和建议。为您的时间和智能方法+1。

# php - 将 Div ID 传递给 jquery/ajax 以显示每个特定用户的消息

> ID：12064356
> 
> 赞同：1
> 
> 时间：2012-08-21T23:13:11.627
> 
> 标签：php, jquery, ajax

我有一个页面，可以在其中检索和显示每个客户的详细信息。
用户可以选择更新每个客户端的状态。

目前我`ajax`用来更新每个客户端的状态，所以页面不会被刷新。

唯一的问题是我有一个状态列，其中显示了客户端的状态，并且由于页面没有刷新，客户端的状态在数据库中发生了更改，但这不会反映/显示在页面上。

我试图克服这个问题但没有成功。

有谁知道我怎么能做到这一点？

我当前的脚本：

```
function processForm(formId) {
    $.ajax({
        type: 'POST',
        url: 'form_process.php',
        data: $("#" + formId).serialize(),
        success: function(data) {

            var $row = $(this).closest("tr");
            var $div = $row.find("div.msg");
            $div.css("background", "#f00");
            $div.html(data);
        }
    });
}​;​ 
```

和 HTML：

```
<table width="787" border="1">
    <tr>
      <td>FORM 1</td>

      <td>
        <div id='msg' class='msg'></div>
      </td>

      <td>
        <form action="" name="form1" id="form1" method="post" onsubmit=
        "processForm('form1');return false;">
          <input type="text" name="user_name" id="user_name" value="" /> <input type=
          "text" name="surname" id="surname" value="" /> <input type="submit" name=
          "submit" value="submit" />
        </form>
      </td>
    </tr>

    <tr>
      <td>FORM2</td>

      <td>
        <div id='msg' class='msg'></div>
      </td>

      <td>
        <form action="" name="form2" id="form2" method="post" onsubmit=
        "processForm('form2');return false;">
          <input type="text" name="user_name" id="user_name" value="" /> <input type=
          "text" name="surname" id="surname" value="" /> <input type="submit" name=
          "submit" value="submit" />
        </form>
      </td>
    </tr>

    <tr>
      <td>&nbsp;</td>

      <td>&nbsp;</td>

      <td>&nbsp;</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:07:17.090

尝试像这样构建 HTML：

```
<table id="clientDetails" width="787" border="1">
<tr>
<td>FORM 1</td>
<td class='msg'></td>
<td><form>
<input type="text" name="user_name" value="" />
<input type="text" name="surname" value="" />
<input type="submit" name="submit" value="submit"/>
</form></td>
</tr>
<tr>
<td>FORM2</td>
<td class='msg'></td>
<td><form>
<input type="text" name="user_name" value="" />
<input type="text" name="surname" value="" />
<input type="submit" name="submit" value="submit"/>
</form></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</table> 
```

像这样的javascript：

```
$(function() {
    $("#clientDetails").on('submit', 'form', function() {
        var $form = $(this);
        $.ajax({
            type: 'POST',
            url: 'form_process.php',
            data: $form.serialize(),
            success: function(data) {
                $form.closest("tr").find(".msg").css("background", "#f00").html(data);
            }
        });
        return false;
    });
}); 
```

这至少有一个工作的机会，但也更有效，因为提交事件处理被委托给表，总共只有一个事件处理程序，而不是每个表单一个......加上相关的 HTML 简化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T04:58:23.063

保持原样..您只需在文档就绪事件上调用您的函数..

像这样..

```
<script>
    $(document).ready(function() {
    //pass formid
    processForm(clientDetails)

});
</script> 
```

希望这会有所帮助...

否则 Beetroot-Beetroot 帮助也是有效的。

# css - 显示：使用图像时的表格单元对齐问题

> ID：12064359
> 
> 赞同：8
> 
> 时间：2012-08-21T23:13:24.533
> 
> 标签：css, css-tables

天哪，这让我发疯。我有一个包含两个表格单元格的表格行。如果两个单元格都只包含文本，它就可以正常工作，但是当我将图像放在一个“单元格”上时，另一个单元格会跳转到基线对齐......即使它们位于不同的 div 中。

[jsfiddle在这里](http://jsfiddle.net/dWgjk/)

停！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-21T23:16:56.647

指定垂直对齐..

```
.table-cell { 
    display: table-cell;
    vertical-align:top;
    }
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:18:24.930

但默认情况下，图像也按基线对齐！只需使用`display: table-cell;`（或任何其他）*表格单元格*样式。

# php - 联系表格提交两次到电子邮件

> ID：12064361
> 
> 赞同：1
> 
> 时间：2012-08-21T23:13:36.200
> 
> 标签：php, html, forms, header, double-submit-problem

我有一个基本的联系表格，它将用户的消息两次发送给显示该表格的公司：一次包含所有正确的信息，一次包含空白的文本字段，即列出了姓名、电子邮件、电话、消息但不包含信息。我已经研究了几个小时，但无法弄清楚。

在我页面的最顶部，我有这个标题：

```
 <?php
 ob_start();
 session_start();
 if( isset($_POST['submit'])) {
 if( $_SESSION['security_code'] == $_POST['security_code'] &&  !empty($_SESSION['security_code'] ) ) {
  // Processing
 header("Location:http://www.berrieswebdesign.com/business1 /thankyou.php?happymessage=thanks");
 unset($_SESSION['security_code']);

 } else {
 // Error Message
 header("Location:http://www.berrieswebdesign.com/business1 /thankyou.php?sadmessage=securitybreach");
    unset($_POST['submit']);

  }

  } else  {

  }
ob_flush();
 ?> 
```

Javascript：

```
 $(function(){
 $('#contact').validate({
 submitHandler: function(form) {
 $(form).ajaxSubmit({
 url: 'process.php',
 success: function() {
 $('#contact').hide();
 $('#contact-form').append("<p class='thanks'>Thanks! Your request has been sent.</p>")
 }
 });
 }
 });         
 }); 
```

和 process.php

```
 function GetHeaders()
 {
    $headers  = 'MIME-Version: 1.0' . "\r\n";
    $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
    // Additional headers
    $headers .= 'From: Company Name<info@companyname.com>' . "\r\n";
    return $headers;
 }
 // Get Data    
 $name = strip_tags($_POST['name']);
 $email = strip_tags($_POST['email']);
 $phone = strip_tags($_POST['phone']);
 $message = strip_tags($_POST['message']);

 // Send Message
    $headers = GetHeaders();
    $intro = "\"Thank you for contacting company name. We are very interested in assessing your situation and will be in touch as soon possible.\" <br />
    <br/>
    Best Regards,<br/>
    <br/>
    Company<br/>
    ";
 mail($email, "RE: Contact Form Submission", $intro, $headers);
 mail("me@yahoo.com", "Inquiry", "Name: {$name}\n Email: {$email}\n Phone: {$phone}\n Message: {$message}\n");

 ?> 
```

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:17:57.113

编辑：根据您添加到问题中的附加 javascript 代码...

问题*可能*是表单是由javascript 和 html提交**的。**如果您删除了 javascript，表单可能仍会提交。这表明不需要 javascript 来提交表单。但是，如果打开了 javascript，则 ajaxSubmit 将运行，但这也不会阻止表单正常提交。如果你想阻止表单提交，你需要这样说：

`return false;`在提交处理程序上。

* * *

无论表单是否已提交，您都可以让 PHP 代码运行，并且代码与表单位于同一网页上。

这意味着每当用户第一次显示表单时以及用户提交表单后都会发送一封电子邮件。

要阻止这种情况，您可以：

*   使表单提交到不同的网页，并将发送电子邮件的 PHP 代码移动到该网页。
*   或者你可以设置一个 if 守卫，例如。`if ($name + $email + $phone + $message != "") { /* send mail here */}`. `if (...)`条件检查是否输入了任何数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:18:45.857

你有两次调用你的`mail`函数。它应该只被调用一次，看起来类似于：

```
mail($to, $subject, $message, $headers); 
```

# select - 使用 Kinetic 或 Easel.js 在 Canvas 中的下拉菜单

> ID：12064370
> 
> 赞同：0
> 
> 时间：2012-08-21T23:14:55.543
> 
> 标签：select, canvas, kineticjs, easeljs

我需要创建一个完全独立的 Web 应用程序，允许用户在选择下拉菜单中选择不同的选项以及输入文本。

我的计划是在 Canvas 中创建整个应用程序。但是，作为 Canvas 编码的新手，不确定什么是可能的。

如果所有画布元素都包含在画布元素中，任何画布专家都可以告诉我是否可以创建下拉选择菜单、文本输入和提交按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:17:11.653

什么 ？

听起来像是有史以来最糟糕的主意。您想在画布中创建一个图形工具包，这需要大量工作，并且您在 DOM 中，这是可用的最佳图形工具包之一。

无论您的小部件多么复杂，如果您有一些非常复杂的小部件需求，使用 DOM 甚至 SVG 总是会更容易。但是画布是用于位图绘制的。

只需使用绝对定位将 DOM 元素放在画布上。

# c++ - 没有数组的多个项目

> ID：12064377
> 
> 赞同：0
> 
> 时间：2012-08-21T23:15:43.683
> 
> 标签：c++

我使用 mmorpg，我正在创建一个名为 chatlink 的系统。在这个系统上，当玩家在物品上按 ctrl 时，该物品会在聊天中链接，因此当它发送时，所有收到聊天消息的玩家都可以点击句子的那部分，并且会出现一个带有物品规格的窗口向上。

考虑以下情况：

玩家：嘿，我在卖`<ItemA>`和`<Scale Boots>`。

我必须在一个类上存储以下内容，（`<`位置开始），（`>`位置结束），项目名称颜色，项目，（项目通过 void* 指针存储）。我有以下课程：

```
class chatitem
{
public:
    chatitem();
    ~chatitem();

    u_long m_uStartPos;
    u_long m_uEndPos;
    DWORD m_dwColor;
    void* m_pItemElem;
}; 
```

我想将它存储在地图上： `map<unsigned int, chatitem*>m_chatItem`哪个 unsigned 是输入它的聊天行的 id。问题是每个句子最多可以存储 3 个项目。我考虑了以下几点：

```
class CChatItem
{
public:
    CChatItem();
    ~CChatItem();

    u_long m_uStartPos[3];
    u_long m_uEndPos[3];
    DWORD m_dwColor[3];
    void* m_pItemElem[3];
}; 
```

或复制如下：

```
u_long m_uStartPos, u_long m_uStartPos2, u_long m_uStartPos3; 
```

但我不想同时使用它们，所以有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:22:36.897

```
std::map<unsigned, std::array<chatitem*, 3>> 
```

看起来账单适合我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:22:35.200

您可以制作地图键类型`std::tuple<unsigned int, unsigned int>`。然后将元组的第二项设置为聊天行中的位置。或者你可以定义一个自定义结构来做同样的事情。

这种方法相对于数组的优势在于您对每条聊天行的项目数量没有硬编码限制。（您以后可能总是想扩展它）。

# c# - EF 4.1 通用多对多关系

> ID：12064383
> 
> 赞同：1
> 
> 时间：2012-08-21T23:15:57.883
> 
> 标签：c#, .net, generics, entity-framework-4, ef-code-first

需要在 EF 4.1 中构建各种标记系统，允许查询每个标签的所有实体，或每个实体的所有标签。这是我的模型的简短快照：

```
public abstract class BaseEntity {

    [Required]
    [Key]
    public Guid ID { get; set; }
}

public class Tag : BaseEntity {
    // tag subscribers
    public List<King> Kings { get; set; }
    public List<Knight> Knights { get; set; }
    public List<Peasant> Peasants { get; set; }
}

public class King : BaseEntity {
    public string Title { get; set; }
    public List<Tag> Tags { get; set; }
}

public class Knight : BaseEntity {
    public string Title { get; set; }
    public List<Tag> Tags { get; set; }
}

public class Peasant : BaseEntity {
    public string Title { get; set; }
    public List<Tag> Tags { get; set; }
} 
```

（是的，我知道国王、骑士和农民在这里是一样的。但正如信使在巨蟒与圣杯中所说：“这只是一个模型。”）

所以无论如何，这个模型工作得很好，但我更喜欢 T 通用列表，而不是特定的演员表。数据库中的表更少，从标签到实体查询时的开销更少。如何将 Tag 中的所有 List<Entity> 属性转换为单个通用 List<T> ，其中 T : BaseEntity，这是否会导致我可以查询特定衍生物的单个查找表？就像是：

```
 List<Knight> knightsByTag = Tags.Where(t => t.GetType() == typeof (Knight)).ToList(); 
```

编辑：是的。抱歉，里面还有一些实际的代码。

@达斯维德：

*   希望 Tag 使用一个 List 属性，而不是当前的三个 List 属性。
*   希望能够查询与骑士关联的所有标签，或与标签关联的所有农民等。
*   希望确保 EF CodeFirst 能够准确解析通用列表，最好使用查找表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T08:00:15.350

如果您想拥有单个列表，`BaseEntity`您还必须将列表放入子实体中。你会以类似的方式结束：

```
public abstract class BaseEntity {
    ...

    // tags
    public List<Tag> Tags { get; set; }
}

public class Tag : BaseEntity {
    ...

    // tag subscribers
    public List<BaseEntity> Entities { get; set; }
} 
```

如果您有任何特定约束，您必须在实体和标签之间建立关系之前在应用程序中检查它们。任何其他方式都会导致您将每个实体的导航属性和每个此类关系的连接表分开。

与骑士相关的所有标签 - 这应该有效：

```
var tags = from k in context.Knights // or context.BaseEntities.OfType<Knight>()
           from t in k.Tags
           select t; 
```

与标签关联的所有农民 - 这应该有效：

```
var peasants = from t in context.Tags
               from p in t.Entities.OfType<Peasant>()
               select p; 
```

请注意，映射继承对查询性能有负面影响。

# azure - azure dev storage tableclient listtables with prefix not return entries

> ID：12064384
> 
> 赞同：0
> 
> 时间：2012-08-21T23:16:01.640
> 
> 标签：azure, azure-storage, azure-storage-emulator

在开发存储下，我创建了许多表，它们的表名中都有“myprefix”前缀。当我执行以下代码时， listtables("myprefix") 永远不会返回条目：

```
 [ClassCleanup]
     public static void ClassCleanup()
     {
         var tableClient = _account.CreateCloudTableClient();
         foreach (var table in tableClient.ListTables("myprefix"))
         {
             tableClient.DeleteTableIfExist(table);
         }
     } 
```

如果我使用 listtables()，它确实会返回所有表，但不确定为什么前缀重载不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:49:28.687

我相信这是开发存储中的一个错误。我查看了 ListTables(prefix) 的代码，这就是我发现的（仅粘贴 ListTablesSegmentedImplCore() 方法的一部分）：

```
if (prefix != string.Empty)
            {                       
                // Append Max char to end  '{' is 1 + 'z' in AsciiTable
                string uppperBound = prefix + '{';

                query = query.Where((table) => table.TableName.CompareTo(prefix) >= 0 && table.TableName.CompareTo(uppperBound) < 0);
            } 
```

所以发生的事情是构造了一个查询，它类似于：

http://[您的开发存储表端点]/devstoreaccount1/Tables()?$filter=(TableName ge 'a') and (TableName lt 'a{')

现在我们知道开发存储在后台使用 SQL Server 进行数据存储。如果我接受这个查询并针对那个 SQL Server 数据库执行它，我没有得到任何结果：

```
SELECT TOP 1000 [AccountName]
  ,[TableName]
  ,[LastModificationTime]
  ,[ServiceMetadata]
  ,[Metadata]
  ,[SchemaXml] FROM [DevelopmentStorageDb201206].[dbo].[TableContainer]   Where [TableName] >= 'a' and [TableName] < 'a{' 
```

我想，在此期间，您需要最终进行过滤。另外请注意，我们在很久以前就在开发存储中发现了另一个错误，它与表的延续令牌有关。当您列出表并且您的存储帐户中有超过 1000 个表时，在开发存储中获取表时您不会取回继续令牌。

希望这可以帮助。

# python - 当我尝试在函数中调用 vars() 时，为什么不能使用它？

> ID：12064386
> 
> 赞同：0
> 
> 时间：2012-08-21T23:16:12.330
> 
> 标签：python, function, built-in

我有一个字符串字典，这些字符串对应于函数名。我正在尝试使用 vars() 将这些字符串分配给我可以用于函数调用的变量。我可以让 vars() 在函数之外工作，但是当我尝试在函数中调用它时，我得到一个 KeyError。下面的代码显然不是我遇到问题的实际代码，但问题是一样的：我可以在 vars() 字典中找到键，但我不能从函数中调用它。

vars() 工作：

```
In [1]: def brian():
   ...:     print "this is the brian function"
   ...:     

In [2]: name = 'brian'

In [3]: x = vars()[name]

In [4]: x()
this is the brian function 
```

vars() 不起作用（在函数内）：

```
In [20]: def brian():
   ....:     print "this is the brian function"
   ....:     

In [21]: def run_it():
   ....:     name = 'brian'
   ....:     x = vars()[name]
   ....:     x() 
   ....:     

In [22]: run_it()
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-22-15adf33a5fea> in <module>()
----> 1 run_it()

<ipython-input-21-5663ac30227d> in run_it()
      1 def run_it():
      2     name = 'brian'
----> 3     x = vars()[name]
      4     x()
      5 

KeyError: 'brian' 
```

最后，这里是 vars() （其中*确实*包括键 'brian'）：

```
In [4]: vars()
Out[4]: 
{'In': ['',
  u'def brian():\n    print "this is the brian function"\n    ',
  u"def run_it():\n    name = 'brian'\n    x = vars()[name]\n    x()\n    ",
  u'run_it()',
  u'vars()'],
 'Out': {},
 '_': '',
 '__': '',
 '___': '',
 '__builtin__': <module '__builtin__' (built-in)>,
 '__builtins__': <module '__builtin__' (built-in)>,
 '__doc__': 'Automatically created module for IPython interactive environment',
 '__name__': '__main__',
 '_dh': [u'/Users/brian'],
 '_i': u'run_it()',
 '_i1': u'def brian():\n    print "this is the brian function"\n    ',
 '_i2': u"def run_it():\n    name = 'brian'\n    x = vars()[name]\n    x()\n    ",
 '_i3': u'run_it()',
 '_i4': u'vars()',
 '_ih': ['',
  u'def brian():\n    print "this is the brian function"\n    ',
  u"def run_it():\n    name = 'brian'\n    x = vars()[name]\n    x()\n    ",
  u'run_it()',
  u'vars()'],
 '_ii': u"def run_it():\n    name = 'brian'\n    x = vars()[name]\n    x()\n    ",
 '_iii': u'def brian():\n    print "this is the brian function"\n    ',
 '_oh': {},
 '_sh': <module 'IPython.core.shadowns' from '/Library/Frameworks/Python.framework/Versions    
/2.7/lib/python2.7/site-packages/IPython/core/shadowns.pyc'>,
 'brian': <function __main__.brian>,
 'exit': <IPython.core.autocall.ExitAutocall at 0x1598cb0>,
 'get_ipython': <bound method TerminalInteractiveShell.get_ipython of     
<IPython.frontend.terminal.interactiveshell.TerminalInteractiveShell object at 0x1589f70>>,
 'help': Type help() for interactive help, or help(object) for help about object.,
 'quit': <IPython.core.autocall.ExitAutocall at 0x1598cb0>,
 'run_it': <function __main__.run_it>} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:18:45.913

在函数内部，`vars()`与`locals()`. 因此不允许函数范围之外的函数。

您可能想要使用`globals()`（`vars()`外部函数的行为）

# javascript - 什么是英国电话号码验证表达式和语法？

> ID：12064387
> 
> 赞同：0
> 
> 时间：2012-08-21T23:16:15.617
> 
> 标签：javascript, forms, validation, phone-number

```
function validateForm()
{
    var x=document.forms["pageFeedbackSurvey"]["emailAddr"].value;
    var atpos=x.indexOf("@");
    var dotpos=x.lastIndexOf(".");
        if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length)
            {
            alert("Please enter a valid e-mail address");
            return false;
            }

    var x=document.forms["pageFeedbackSurvey"]["comments"].value;
        if (x==null || x=="")
            {
            alert("Please enter your feedback into the textbox before pressing 'Submit'");
            return false;
            }

    var phone = document.getElementById("phone").value;
    var pattern = /^([0-9]){7,15}$/;
        if (pattern.test(phone)) 
        {
        alert("Your phone number : "+phone);
        return true;
        } 
        alert("It is not valid phone number!");
        return false;
        } 
```

然后是html

```
<form action="demo_form.asp" onsubmit="return validateForm()" method="post" name="pageFeedbackSurvey" id="pageFeedbackSurvey">
                            <div class="pod pageFeedback">
                                <h2>Feedback</h2>
                                <div class="body">                                  
                                    <fieldset>
                                        <div class="surveyrow">
                                            <p id="q1Wording">Did you find the information you were looking for on this page?</p>
                                            <ul>
                                                <li> <!-- input uses class, name and value for jquery -->
                                                    <input name="showdiv2" id="survey1_1" value="Yes" type="radio" class="showsubmit"/><label for="survey1_1">Yes</label>         
                                                </li>
                                                <li>
                                                    <input name="showdiv" id="survey1_2" value="No" type="radio" class="showform"/><label for="survey1_2">Partially</label>
                                                </li>
                                                <li>
                                                    <input name="showdiv" id="survey1_3" value="No" type="radio" class="showform"/><label for="survey1_3">No</label>
                                                </li>
                                            </ul>
                                        </div>

                                        <div id="extraFields">
                                            <div class="commentRow">
                                            <div id="hiddentextarea"> <!-- hidden div -->
                                                <label for="comments">How can we improve this page?</label>
                                                <textarea name="limitedtextarea" onKeyDown="limitText(this.form.limitedtextarea,this.form.countdown,300);" 
                                                onKeyUp="limitText(this.form.limitedtextarea,this.form.countdown,300);" id="comments" rows="8" cols="19"></textarea>
                                                <p>Character limit: <input readonly="readonly" type="text" name="countdown" id="countdown" size="3" value="300"></input></p>
                                            </div>
                                            </div> <!-- end hidden div -->
                                            <div id="hiddenfields"> <!-- hidden div -->
                                            <div class="emailContainer">
                                                <div class="email" id="email">
                                                    <input type="text" name="emailAddr" id="emailAddr" size="22" value="Enter email address"/>
                                                </div>                                                  
                                            </div>
                                            <div class="phoneContainer">
                                                <div class="phone" id="phone">
                                                    <input type="text" name="phone" id="phone" type="phone" size="22" value="" />
                                                </div>                                                  
                                            </div>

                                            <div id="pageFeedbackSubmit" class="button primary right">
                                                <input class="arrow" onclick="validate();" value="Submit" type="submit" id="surveySubmit"/>
                                            </div><!-- button -->
                                            </div> <!-- end hidden div -->
                                            <div class="clearBoth"></div>
                                        </div>

                                    </fieldset>
                                    <div id="errormsg" class="errorMessage" style="display: none"></div>
                                    <div id="thankYou" style="display:none">                                        
                                        <h3>Thank you</h3>                                      
                                        <p>We appreciate you taking the time to help us.</p>                                                                    
                                    </div> 
```

我一直在努力寻找在类型或提交时验证电话输入的解决方案。在选择单选按钮之前，我一直隐藏表单，按下单选按钮后显示电子邮件和电话以及文本区域，然后我让它验证文本区域的输入和电子邮件的语法，现在我需要验证电话为一个英国号码，我设法让电话字段至少显示一个不正确的弹出警报，但我无法让它接受当前设置中的任何号码。

有人可以建议我在提交时执行 validateForm 功能的同时验证手机以及电子邮件和文本区域的正确方法吗？

* * *

## 以下所有内容添加/编辑 23/08/2012

嘿伙计们感谢所有的回复，但我仍然无法让它工作，我已经更改了 id，所以`phone`不再有 2 个 id，我将 showdiv2 更改为 showdiv，我在插入 javascript telnumber 检查之前将输入类型更改为 tel

我将 braemoor.co.uk/software/telnumbers.shtml 中的脚本添加到标题中的 javascript 文件中，然后尝试将该 javascript 绑定到 html，该示例中没有 html，所以我一直在猜测...

已为电子邮件和文本区域设置的验证功能由

```
<form action="demo_form.asp" onsubmit="return validateForm()" 
```

这很好用，我想要的是电话功能也可以在提交时或之前运行？我尝试将其添加到提交按钮

```
<input class="arrow" onclick="checkUKTelephone();" value="Submit" type="submit" id="surveySubmit"/> 
```

但它不会验证手机，它只是在验证电子邮件和文本区域后忽略电话号码，然后转发到演示页面，显然我没有做正确的事情，我没有大量的 JavaScript 经验，你可能已经注意到了:)

有人好心告诉我我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:56:03.670

您的 HTML 有问题：

```
<div class="phoneContainer">
    <div class="phone" id="phone">
       <input type="text" name="phone" id="phone" type="phone" size="22" value="" />
    </div>                                                  
</div> 
```

如您所见，DIV 和 INPUT 的 ID“电话”出现了两次。

因此，当您尝试获取要验证的电话号码时，它会返回“未定义”，这就是您验证实际电话号码的内容。

```
<div class="phoneContainer">
    <div class="phone" id="phoneDiv"> <!-- change the name here -->
       <input type="text" name="phone" id="phone" type="phone" size="22" value="" />
    </div>                                                  
</div> 
```

在 HTML 文档中，两个元素可以具有相同的名称，但 id 应该是 uniq。

有关基于您的代码的完整示例，请查看：[https ://docs.google.com/open?id=0B31oh4Omo6z0YjFmNHc2bjJCMk0](https://docs.google.com/open?id=0B31oh4Omo6z0YjFmNHc2bjJCMk0)

# ios - 绘制动画是否比动画图像数组更有效？

> ID：12064392
> 
> 赞同：0
> 
> 时间：2012-08-21T23:17:05.540
> 
> 标签：ios, animation, user-interface

对于像过渡和介绍加载器这样的基本动画，什么更有效？使用 CG 绘图或为一组图像设置动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:32:42.583

取决于图像的大小，但通常这是更好的选择。Core Graphics 并不是真正用于实时绘图。Core Animation 可以处理很多，这取决于你的动画的复杂性；这有点取决于你想要做什么。

# linux - 远程保存在 gedit

> ID：12064401
> 
> 赞同：4
> 
> 时间：2012-08-21T23:17:43.890
> 
> 标签：linux, ubuntu, ssh, save, gedit

在我没有物理访问权限的机器上，我打开 gedit 并打开了一个我忘记保存的文本文件。我可以 ssh 到那台机器。在那里运行的操作系统是 Ubuntu。

有什么办法可以远程保存该文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T03:23:49.480

查看[xdotool](http://www.semicomplete.com/projects/xdotool/)，它可以以编程方式激活/移动/调整窗口大小，并模拟键盘输入和鼠标活动。

```
xdotool search --classname gedit key ctrl+s 
```

这将搜索 gedit 的所有窗口并在其中按 ctrl+s。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T03:17:11.650

是的！我可以想到两种简单的方法。

1.  如果您具有 SSH 访问权限和 root 权限，则可以通过隧道进入并安装和配置远程桌面查看器（或使用默认的 VNC，[`vinagre`](https://help.ubuntu.com/community/Vinagre)）。然后您可以连接到您的桌面，找到 gedit 窗口并按字面意思按“保存”。

2.  您可以通过 SSH 使用 X 转发将`gedit`窗口转发到您的本地计算机，您也可以在其中按“保存”。请注意，您必须更改 gedit 实例的 X 显示，以便转发它。这可能有点棘手，但您可以尝试一下。您可以通过简单的搜索找到许多 X 转发指南。

`gedit`将内容保存在内存中并将它们写入文件肯定有一种骇人听闻的方法，但我认为使用 VNC 客户端是一个非常简单的选择。

# c++ - clock_gettime 在使用 CLOCK_PROCESS_CPUTIME_ID 的 chrooted Debian 蚀刻中失败

> ID：12064404
> 
> 赞同：1
> 
> 时间：2012-08-21T23:17:49.033
> 
> 标签：c++, ubuntu, debian, clock, chroot

我已经在 Ubuntu 12.04（64 位）下设置了一个 chrooted Debian Etch（32 位），并且似乎 clock_gettime() 与 CLOCK_MONOTONIC 一起工作，但在 CLOCK_PROCESS_CPUTIME_ID 和 CLOCK_THREAD_CPUTIME_ID 上都失败了。errno 设置为 EINVAL，根据手册页，这意味着“此系统不支持指定的 clk_id”。

所有三个时钟在 chrooted Debian 之外和 64 位 chrooted Debian etch 中都可以正常工作。

有人可以向我解释为什么会这样以及如何解决吗？

非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:31:47.400

我还不知道原因，但我有一些不适合评论框的想法。

首先，您可以通过将测试程序编译为 C 而不是 C++ 并且不将其链接到 libpthread 来简化测试程序。`-lrt`应该够好得到`clock_gettime`。此外，编译它`-static`可以使跟踪更容易，因为动态链接器启动的东西不会在那里。

静态链接甚至可能改变clock_gettime 的行为。值得一试的是找出它是否可以解决这个错误。

我想看到的另一件事是这个绕过 vdso 的测试程序的输出：

```
#define _GNU_SOURCE
#include <stdio.h>
#include <time.h>
#include <unistd.h>
#include <sys/syscall.h>

int main(void)
{
    struct timespec ts;
    if(syscall(SYS_clock_gettime, CLOCK_PROCESS_CPUTIME_ID, &ts)) {
        perror("clock_gettime");
        return 1;
    }
    printf("CLOCK_PROCESS_CPUTIME_ID: %lu.%09ld\n",
           (unsigned long)ts.tv_sec, ts.tv_nsec);
    return 0;
} 
```

有和没有`-static`，如果失败，添加`strace`.

## 更新（其实跳过这个。去第二次更新）

几个更简单的测试想法：

1.  `-m32`通过添加到 gcc 命令，在 Ubuntu 主机系统中编译并运行一个 32 位测试程序。可能是内核的 32 位兼容模式导致了该错误。如果是这种情况，那么无论链接到哪个 libc，32 位版本都会失败。
2.  将您在 Debian 下编译的非静态测试程序复制到 Ubuntu 主机系统并尝试在那里运行它们。行为变化将指向 libc 作为原因。

然后是艰难的事情的时候了。查看反汇编代码，并可能在 gdb 中单步执行。我不想让你自己做，而是想要一份你正在运行的代码的副本。在我能得到的地方上传一个静态编译的失败测试程序。您的内核提供的 32 位 vdso 的副本也可能很有趣。要提取 vdso，请运行以下程序（在 32 位 chroot 中编译），该程序将创建一个名为 的文件`vdso.dump`，并将其上传。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

static int getvseg(const char *which, const char *outfn)
{
  FILE *maps, *outfile;
  char buf[1024];
  void *start, *end;
  size_t sz;
  void *copy;
  int ret;
  char search[strlen(which)+4];

  maps = fopen("/proc/self/maps", "r");
  if(!maps) {
    perror("/proc/self/maps");
    return 1;
  }
  outfile = fopen(outfn, "w");
  if(!outfile) {
    perror(outfn);
    fclose(maps);
    return 1;
  }

  sprintf(search, "[%s]\n", which);
  while(fgets(buf, sizeof buf, maps)) {
    if(strlen(buf)<strlen(search) ||
       strcmp(buf+strlen(buf)-strlen(search),search))
      continue;
    if(sscanf(buf, "%p-%p", &start, &end)!=2) {
      fprintf(stderr, "weird line in /proc/self/maps: %s", buf);
      continue;
    }
    sz = (char *)end - (char *)start;
    /* copy because I got an EFAULT trying to write directly from vsyscall */
    copy = malloc(sz);
    if(!copy) {
      perror("malloc");
      goto fail;
    }
    memcpy(copy, start, sz);
    if(fwrite(copy, 1, sz, outfile)!=sz) {
      if(ferror(outfile))
        perror(outfn);
      else
        fprintf(stderr, "%s: short write", outfn);
      free(copy);
      goto fail;
    }
    free(copy);
    goto success;
  }
  fprintf(stderr, "%s not found\n", which);

fail:
  ret = 1;
  goto out;
success:
  ret = 0;
out:
  fclose(maps);
  fclose(outfile);
  return ret;
}

int main(void)
{
  int ret = 1;
  if(!getvseg("vdso", "vdso.dump")) {
    printf("vdso dumped to vdso.dump\n");
    ret = 0;
  }
  if(!getvseg("vsyscall", "vsyscall.dump")) {
    printf("vsyscall dumped to vsyscall.dump\n");
    ret = 0;
  }
  return ret;
} 
```

## 更新 2

我通过下载 etch libc 复制了这一点。这绝对是 glibc 愚蠢造成的。它不是一个简单的用于clock_gettime 的系统调用包装器，而是一大堆预处理器意大利面条，最终导致“你不能使用我们没有预先批准的clockid”。你不会让它与那个旧的 glibc 一起工作。这让我们想到了一个我不想问的问题：你为什么还要尝试使用过时的 Debian 版本？

# jquery - Django 模板 + jQuery + 更好的方法

> ID：12064407
> 
> 赞同：0
> 
> 时间：2012-08-21T23:17:54.837
> 
> 标签：jquery, django, templates

我想做一个流行图片游戏之类的东西，当你有一个相册并且必须回答图片的标题时，所以我使用 Django + Kickstrap + jQuery 来做这个（对于逻辑代码）

这是我的模板。

```
 <ul class="thumbnails" >
        <li class="span12" id="pops">
        {% for photo in pops.photos.all %}
            <div class="thumbnail span3" id="pop_picture">
              <img src="{{MEDIA_URL}}{{photo.original_image}}"alt="{{photo.name}}">
              <br>
              <p id="answer">{{photo.name}}</p>
              <input id="txt_pop" type="text"  value=""/>
              <button id="pops_button" type="submit"  class="btn">confere</button>
            </div>
        {% endfor %}

        </li>
    </ul> 
```

--myscript.js

```
function myCallback() {
    //do things!;
    if( $("#txt_pop").val() === $("#answer").text())
    {
        $("#pops_button").addClass("btn-success");
        $("#pops_button").text("CORRETO");  
    }else{
       $("#pops_button").text("ERRADO");
       $("#pops_button").addClass("btn-danger");
   }
}

$(document).ready(function() {

    //and then change this code so that your callback gets run
    //when the button gets clicked instead of mine.
    // **by the way, this is jQuery!
    $('#pops').find("#pops_button").click(myCallback); 
}); 
```

发生了两件事，第一件事：如何传递 {{photo.name}}，这就是答案，用于我在 js 上的函数。

第二个奇怪的行为是：只有我的第一个 id="pop_picture" 的 div 类工作正常，任何其他图片都响应良好。

这个问题是混合的：jQuery 和模板的新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:23:47.750

不要`id`用于多次出现的元素。这可能就是为什么只有你的第一个有效而其他无效的原因。同样的问题`id="answer"`- 使用一个类，并通过 jQuery 找到它。

```
{% for photo in pops.photos.all %}
        <div class="thumbnail span3" id="pop_picture">
          <img src="{{MEDIA_URL}}{{photo.original_image}}"alt="{{photo.name}}">
          <br>
          <p class="answer">{{photo.name}}</p>
          <input class="txt_pop" type="text"  value=""/>
          <button class="btn pops_button" type="submit">confere</button>
        </div>
{% endfor %}

$(document).ready(function() {
    $('#pops .pops_button').click(function() {
       alert($(this).parent().find('.answer').html());
    }); 

}); 
```

# android - 在 PhoneGap 中播放音乐时录制声音

> ID：12064411
> 
> 赞同：1
> 
> 时间：2012-08-21T23:17:59.923
> 
> 标签：android, cordova, audio-recording

我想知道是否可以在设备播放音乐时录制声音，这个想法是尝试开发“卡拉 OK”并保存您的声音。

我正在使用 PhoneGap，操作系统是 Android。目前我不想要代码，我只想知道这是否可能并自己尝试。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:31:33.493

是的，是的，你可以。查看 PhoneGap[媒体 API](http://docs.phonegap.com/en/2.0.0/cordova_media_media.md.html#Media)。您将需要两个媒体对象。一个用于记录，一个用于播放。

# javascript - 在 JavaScript 中，Object Literal Notation 不就是字典的另一个名称吗？

> ID：12064422
> 
> 赞同：4
> 
> 时间：2012-08-21T23:18:54.143
> 
> 标签：javascript, object, literals, notation

JavaScript“对象”不只是一个字典吗？为什么 Object Literal Notation 有一个花哨的名字？对于 JavaScript Object Literal Notation，您只能使用`Object.property`而不是引用对象的属性值`Object[property]`（就像在 Python 中所做的那样）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-21T23:52:03.260

Javascript 的“Object Literal Notation”只是 javascript 接受的静态声明数据结构的语法。虽然 javascript 对象的使用类似于其他语言中所谓的字典，但“对象文字表示法”只是一种静态声明语法。它通常看起来像这样：

```
var myObject = {
    name: "Peter Foti",
    'course': 'JavaScript',
    grade: 'A',
    level: 3
}; 
```

术语“对象文字表示法”并不是指您可以使用 javscript 代码寻址对象的所有可能方式。您不使用`Object.property`or`Object[property]`语法在静态对象声明中定义属性，除非作为声明的值部分，其中 Object 是某个其他对象。

[本文在标题](http://www.dyn-web.com/tutorials/obj_lit.php)*基本*语法下对 Object Literal 语法有很好的参考。

# sql-server - 使用立即/本地窗口查看表变量的内容

> ID：12064426
> 
> 赞同：2
> 
> 时间：2012-08-21T23:19:19.997
> 
> 标签：sql-server, ssms, sql-server-2008

在 SSMS 及其即时或本地窗口中，有没有办法查看表变量的内容？我可以选择和查看标量的值，但我似乎找不到查询表内容甚至运行的方法

```
SELECT * FROM @someTableVarInMySproc 
```

在即时窗口中。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:25:47.723

不，抱歉，这在当前版本的 Management Studio 中是不可能的。它已被要求，并且据说他们正在考虑在未来版本中使用类似的东西。您可以对以下项目进行投票并添加建设性意见，但不能保证他们会真正做到：

[http://connect.microsoft.com/SQL/feedback/details/623353](http://connect.microsoft.com/SQL/feedback/details/623353)

[http://connect.microsoft.com/SQL/feedback/details/582167](http://connect.microsoft.com/SQL/feedback/details/582167)

[http://connect.microsoft.com/SQL/feedback/details/454870](http://connect.microsoft.com/SQL/feedback/details/454870)

[http://connect.microsoft.com/SQL/feedback/details/363054](http://connect.microsoft.com/SQL/feedback/details/363054)

* * *

该列表中的第一项有一个有趣的解决方法：

![在此处输入图像描述](../Images/06bb42690c5159d37f9c1883e02fddbb.png)

除了明显的警告，您可能无法注入额外的代码来捕获 XML 变量中的数据（因为毕竟，如果您能做到这一点，您还可以添加老式的调试技术`SELECT * FROM @table`，如由于尝试从 XML 读取此信息的性质，Management Studio 2012 在我第一次尝试执行此操作时崩溃了 - 因此，如果您要尝试它，请确保在一个孤立的实例中执行此操作。

# oracle11g - 输入 = 1.00 的 oracle 无效数字异常

> ID：12064429
> 
> 赞同：0
> 
> 时间：2012-08-21T23:19:50.453
> 
> 标签：oracle11g

当我传入 1.00 时，这个检查字符串是否为数字的特定函数会引发异常：

```
create or replace function my_to_number( p_num in 
varchar2 ) return number
   as
      x number;
       num_val_error exception;
       pragma exception_init( num_val_error, -6502 );
 begin
       x := to_number( p_num );
         return 1;
  exception
         when num_val_error then 
         return 0;
  end my_to_number; 
```

1.00 是一个完全有效的数字。对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:46:05.543

[`TO_NUMBER`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions211.htm#SQLRF06140)最多需要三个参数，第一个是要转换的表达式，第二个是要使用的数字格式，第三个定义小数和组分隔符是什么。只有第一个是必需的。如果没有第三个*nlsparam*元素，Oracle 会为您的会话使用默认值。看起来您的语言环境的默认小数分隔符是“，”。

尝试`TO_NUMBER(p_num, '9G999D99', 'NLS_NUMERIC_CHARACTERS = ''.,''')`

# coldfusion - 如何在两个 ColdFusion CFC 之间共享查询数据？

> ID：12064430
> 
> 赞同：0
> 
> 时间：2012-08-21T23:19:52.370
> 
> 标签：coldfusion, coldfusion-8, cfc

我正在创建一个名为“core_appdata”的 CFC。此 CFC 将保存应用程序的核心存储过程。例子....

```
 <cfcomponent displayname="core_appdata" hint="I Return Core App Data" output="no">
    <cffunction name="getprogram_list">

  <cfargument name="getstoredproc_input_campaignid" type="string" required="false">
   <cfargument name="getstoredproc_input_filtertestrecs" type="string" required="false">
    <cfargument name="getstoredproc_input_startdate" type="date" required="false">
    <cfargument name="getstoredproc_input_enddate" type="date" required="false">
    <cfargument name="getstoredproc_input_listtypeid" type="string" required="false">
    <cfargument name="getstoredproc_input_listid" type="string" required="false">
    <cfargument name="getstoredproc_input_appenvr" type="string" required="false">

    <cfset var rst_getprogram_list ="">
     ---  stored proc ---            
         <cfstoredproc procedure  = "p_adb_getprogram_list">
         </cfstoredproc>

    <cfreturn rst_getprogram_list />
   </cffunction>
    </cfcomponent> 
```

我还想创建一个名为“core_appdata_grids”的 CFC。此 CFC 将用于绑定到 cfgrid 并允许分页等。在理想情况下，此 CFC 将从上述 CFC“core_appdata”中的方法/函数“getprogram_list”获取其数据。例子...

```
 <cfcomponent displayname="core_appdata_grids" hint="I Return Core App Data For CFGrids " output="no">

    <cffunction name="getprogram_list_grid">

               <cfargument name="page" required="no" />
        <cfargument name="pageSize" required="no" />
        <cfargument name="gridsortcolumn" required="no" />
        <cfargument name="gridsortdirection" required="no" />   
        <cfargument name="getstoredproc_input_campaignid" type="string" required="false">
               <cfargument name="getstoredproc_input_filtertestrecs" type="string" required="false">
               <cfargument name="getstoredproc_input_startdate" type="date" required="false">
               <cfargument name="getstoredproc_input_enddate" type="date" required="false">
               <cfargument name="getstoredproc_input_listtypeid" type="string" required="false">
               <cfargument name="getstoredproc_input_listid" type="string" required="false">
                <cfargument name="getstoredproc_input_appenvr" type="string" required="false">

        <cfset var rst_getprogram_list_grid ="">
         ---  get data ---           

        <cfreturn queryconvertforgrid(rst_getprogram_list_grid, page, pagesize) />
    </cffunction>

     </cfcomponent> 
```

**问题：**

*   这可能吗？如果是这样，它是如何完成的？
*   如果是这样，这是使用 CFC 时的最佳做法吗？
*   如果不是，在 CFC 之间共享数据的最佳方式是什么

提前感谢您花时间帮助我解决这个问题。

超频

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:01:04.817

我看不到生成网格的 cfc 的名称，而只是扩展了将继承所有方法的基本 cfc。

```
<cfcomponent extends="core_appdata">

<cffunction name="getprogram_list_grid">
    <cfargument name="page" required="no" />
    <cfargument name="pageSize" required="no" />
    <cfargument name="gridsortcolumn" required="no" />
    <cfargument name="gridsortdirection" required="no" />   
    <cfargument name="getstoredproc_input_campaignid" type="string" required="false">
    <cfargument name="getstoredproc_input_filtertestrecs" type="string" required="false">
    <cfargument name="getstoredproc_input_startdate" type="date" required="false">
    <cfargument name="getstoredproc_input_enddate" type="date" required="false">
    <cfargument name="getstoredproc_input_listtypeid" type="string" required="false">
    <cfargument name="getstoredproc_input_listid" type="string" required="false">
    <cfargument name="getstoredproc_input_appenvr" type="string" required="false">

    <cfset var rst_getprogram_list_grid = super.getprogram_list() />

    <cfreturn queryconvertforgrid(rst_getprogram_list_grid, page, pagesize) />
</cffunction>

</cfcomponent> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:59:36.123

如果您不想扩展 CFC，特别是如果这对您的模型不适用，则可以调用另一个 CFC：

```
<cfset var rst_getprogram_list_grid = createObject("component","core_appdata").getprogram_list() /> 
```

或者在这一切之上的某个地方甚至更好：

```
<cfset request.core_appdata=createObject("component","core_appdata")> 
```

然后在你的 CFC 中：

```
<cfset var rst_getprogram_list_grid = request.core_appdata.getprogram_list() /> 
```

只是几个选项。

# symfony - 推动 ORM 行为来定义父子关系？

> ID：12064432
> 
> 赞同：1
> 
> 时间：2012-08-21T23:20:47.380
> 
> 标签：symfony, propel

我正在使用带有 PropelBundle 的 Symfony2，假设我有以下架构：

```
<table name="person">
  <column name="id" type="INTEGER" primaryKey="true" autoIncrement="true" required="true"/>
  <column name="name" type="VARCHAR" size="100" required="true"/>
</table>
<table name="person_parent">
  <column name="person_id" type="INTEGER" primaryKey="true" required="true"/>
  <column name="parent_id" type="INTEGER" primaryKey="true" required="true"/>
</table> 
```

考虑一个人可以有很多“父母”，就像父母可以有很多孩子“人”一样。“person_parent”表中的两列都是“person”表的外键。不像 Book/Author 这样的关系，可以在表“book_author”的模式中设置 isCrossRef="true" 以让 Propel 生成用于直接从作者类获取/设置/添加书籍对象的方法，反之亦然，用于父/子关系无法设置 isCrossRef="true"，因此无法直接从“Person”对象获取/设置/添加父 Person 对象。换句话说，不可能做到：

```
$person = new Person();
$person->setPersonParents($personCollection); 
```

设置任何给定人员的所有父“Person”对象的方法“setPersonParents()”不可用。但是，对于不引用同一个表（如 author_book）的交叉表，设置 isCrossRef="true" 允许以下操作：

```
$author = new Author();
$author->setBooks($bookCollection); 
```

考虑到这一点，也不可能在“新人”表单中直接选择一个人的“父母”......

对于像朋友一样的关系，有[EqualNestBehavior](https://github.com/CraftyShadow/EqualNestBehavior)，它允许：

```
$person = new Person();
$person->setFriends($personCollection); 
```

但是，该行为似乎不适用于父/子关系，因为它不关心层次结构（如果尝试获取任何给定“人”的“父母”，则将获得该“人”的所有“孩子”除了它的“父母”......）。这是人们对“朋友喜欢”的关系所期望的行为，其中一个人的朋友也是那个人的朋友。

有没有办法将[EqualNestBehavior](https://github.com/CraftyShadow/EqualNestBehavior)用于父/子案例？还是有任何其他推进行为或方法来处理这种关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T05:37:33.473

我不确定，`EqualNestBehavior`但您可以按以下方式设置工作流程。

在您的架构中，将 FK 定义为`Person`表：

```
<table name="person">
    <column name="id" type="INTEGER" primaryKey="true" autoIncrement="true" required="true"/>
    <column name="name" type="VARCHAR" size="100" required="true"/>
</table>
<table name="person_parent">
    <column name="person_id" type="INTEGER" primaryKey="true" required="true"/>
    <column name="parent_id" type="INTEGER" primaryKey="true" required="true"/>
    <foreign-key foreignTable="person" name="p1" onDelete="CASCADE" onUpdate="CASCADE">
        <reference local="person_id" foreign="id"/>
    </foreign-key>
    <foreign-key foreignTable="person" name="p2" onDelete="CASCADE" onUpdate="CASCADE">
        <reference local="parent_id" foreign="id"/>
    </foreign-key>
</table> 
```

之后，当您生成模型时 - 您将获得以下方法：

```
$person = new Person();
$person->getPersonParentsRelatedByParentId();
$person->setPersonParentsRelatedByParentId($personCollection);

$person->getPersonParentsRelatedByPersonId();
$person->setPersonParentsRelatedByPersonId($personCollection); 
```

设置者接受`PropelCollection`作为参数。

您只需要考虑这种情况，而不是像“获得父母”或“获得孩子”，而是考虑相关元素。

# ruby - 索引一个红宝石数组以省略一个元素或元素范围？

> ID：12064433
> 
> 赞同：2
> 
> 时间：2012-08-21T23:20:53.017
> 
> 标签：ruby, arrays

我有一个包含 10 个元素的 ruby​​ 数组，我想返回除第 5 个元素之外的所有元素。

```
a = *(1..10) 
```

我希望能够做类似的事情

```
a[0..3 + 5..9] 
```

甚至更好的东西（借用 R 语法），

```
a[-4] 
```

这样做，但这不起作用。（我也没有尝试过任何更聪明的方法，比如获取元素索引数组）。在红宝石中做到这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T23:29:56.427

您可以使用`values_at`：[http ://www.ruby-doc.org/core-1.9.3/Array.html#method-i-values_at](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-values_at)

所以你可以用它作为

```
a.values_at(0..3, 5..9) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-21T23:25:18.167

不需要黑魔法：

```
a[0..3] + a[5..9] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T23:29:54.057

查看下面的文档`Array#delete_at`

例如，`myarray.delete_at(5)`导致数组缺少元素 5（当然从 0 开始计数）。

例子：

```
class Array
  def without(n)
    self.delete_at(n)
    return self
  end
end
arr = [1, 2, 3, 4]
p arr.without(1) #=> [1, 3, 4] 
```

但是，正如评论者指出的那样，这会改变原始数组，这可能不是 OP 想要的！如果这是一个问题，请这样写：

```
class Array
  def without(n)
    arr2 = Array.new(self)
    arr2.delete_at(n)
    return arr2
  end
end 
```

这将返回所需的数组（一个缺少原始数组的第 n 个元素的数组），同时保持原始数组不变。

# vba - 通过编辑检测单元格值是否实际更改

> ID：12064439
> 
> 赞同：11
> 
> 时间：2012-08-21T23:21:53.973
> 
> 标签：vba, excel

`Worksheet_Change`当单元格值更改时触发（这是我想要的），但它也会在您输入单元格时触发，好像要编辑它但实际上并没有更改单元格的值（这是我不希望发生的事情） ）。

假设我想为值已更改的单元格添加阴影。所以我编码：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Target.Interior.ColorIndex = 36
End Sub 
```

现在测试我的工作：更改单元格 A1 并突出显示该单元格。这是期望的行为。到目前为止，一切都很好。然后，双击 B1 但不要更改那里的值，然后单击 C1。您会注意到 B1 被突出显示！这不是理想的行为。

我是否必须通过此处讨论的捕获旧值的方法，然后在突出显示单元格之前将旧值与新值进行比较？我当然希望我缺少一些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T07:52:44.087

我建议在另一张工作表中自动维护工作表的“镜像副本”，以便与更改后的单元格的值进行比较。

@brettdj 和 @JohnLBevan 本质上建议做同样的事情，但它们分别将单元格值存储在注释或字典中（确实为这些想法 +1）。不过，我的感觉是，在单元格中备份单元格比在其他对象中备份单元格在概念上要简单得多（尤其是注释，您或用户可能希望将其用于其他目的）。

所以，假设我有`Sheet1`用户可以更改的单元格。我创建了另一个名为的工作表`Sheet1_Mirror`（如果你愿意，你可以创建它`Workbook_Open`并且可以设置为隐藏 - 由你决定）。首先， 的内容与 的内容`Sheet1_Mirror`相同`Sheet1`（同样，您可以在 处强制执行此操作`Workbook_Open`）。

每次触发`Sheet1`'s时`Worksheet_Change`，代码都会检查“已更改”单元格中的值`Sheet1`是否实际上与中的不同`Sheet1_Mirror`。如果是这样，它会执行您想要的操作并更新镜像表。如果没有，那就什么都没有。

这应该使您走上正确的轨道：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim r As Range
    For Each r In Target.Cells
        'Has the value actually changed?
        If r.Value <> Sheet1_Mirror.Range(r.Address).Value Then
            'Yes it has. Do whatever needs to be done.
            MsgBox "Value of cell " & r.Address & " was changed. " & vbCrLf _
                & "Was: " & vbTab & Sheet1_Mirror.Range(r.Address).Value & vbCrLf _
                & "Is now: " & vbTab & r.Value
            'Mirror this new value.
            Sheet1_Mirror.Range(r.Address).Value = r.Value
        Else
            'It hasn't really changed. Do nothing.
        End If
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T00:07:33.550

试试这个代码。当您输入范围时，它将原始单元格值存储在字典对象中。当触发工作表更改时，它会将存储的值与实际值进行比较并突出显示任何更改。
注意：为了提高效率，请参考 microsoft 脚本运行时并将**As Object**替换为**As Scripting.Dictionary**并将**CreateObject("Scripting.Dictionary")**替换为**New Scripting.Dictionary**。

```
Option Explicit

Private previousRange As Object 'reference microsoft scripting runtime & use scripting.dictionary for better performance
                                'I've gone with late binding to avoid references from confusing the example

Private Sub Worksheet_Change(ByVal Target As Range)

    Dim cell As Variant

    For Each cell In Target
        If previousRange.Exists(cell.Address) Then
            If previousRange.Item(cell.Address) <> cell.FormulaR1C1 Then
                cell.Interior.ColorIndex = 36
            End If
        End If
    Next

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

    Dim cell As Variant

    Set previousRange = Nothing 'not really needed but I like to kill off old references
    Set previousRange = CreateObject("Scripting.Dictionary")

    For Each cell In Target.Cells
        previousRange.Add cell.Address, cell.FormulaR1C1
    Next

End Sub 
```

附言。任何更新单元格的 vba 代码（甚至只是颜色）都会阻止 excel 的撤消功能工作！要解决这个问题，您可以重新编程撤消功能，但它可能会占用大量内存。示例解决方案：[http](http://www.jkp-ads.com/Articles/UndoWithVBA00.asp) ://www.jkp-ads.com/Articles/UndoWithVBA00.asp/http : [//www.j-walk.com/ss/excel/tips/tip23.htm](http://www.j-walk.com/ss/excel/tips/tip23.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T00:08:54.390

此代码使用注释来存储先前的值（请注意，如果您确实需要将注释用于其他目的，此方法将删除它们）

1.  没有值的单元格将颜色重置为`xlNone`
2.  输入到单元格中的初始值是蓝色 (ColorIndex 34)
3.  如果值更改，则单元格从蓝色变为黄色

![在此处输入图像描述](../Images/66dd26ecb7c2443920b575424abefd95.png)

**普通模块 - 关闭评论显示**

```
 Sub SetCom()
      Application.DisplayCommentIndicator = xlNoIndicator
    End Sub 
```

**用于捕获更改的工作表代码**

```
 Private Sub Worksheet_Change(ByVal Target As Range)
    Dim rng1 As Range
    Dim shCmt As Comment
    For Each rng1 In Target.Cells

    If Len(rng1.Value) = 0 Then
    rng1.Interior.ColorIndex = xlNone
    On Error Resume Next
    rng1.Comment.Delete
    On Error GoTo 0
    Else

    On Error Resume Next
    Set shCmt = rng1.Comment
    On Error GoTo 0

    If shCmt Is Nothing Then
        Set shCmt = rng1.AddComment
        shCmt.Text Text:=CStr(rng1.Value)
         rng1.Interior.ColorIndex = 34
    Else
        If shCmt.Text <> rng1.Value Then
            rng1.Interior.ColorIndex = 36
            shCmt.Text Text:=CStr(rng1.Value)
        End If
    End If
    End If
    Next
    End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-03T14:38:51.143

我知道这是一个旧线程，但我遇到了完全相同的问题，例如“更改单元格 A1 并且单元格被突出显示。这就是我所期望的。双击 B1 但不要更改那里的值，然后单击 C1。您会注意到 B1 被突出显示！”

我不想突出显示一个单元格，如果它只是被双击而里面没有值。

我以简单的方式解决了。也许它会在未来帮助某人。

我刚刚在活动开始时添加了这个：

```
 If Target.Value = "" Then
      Exit Sub
 End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-31T15:02:59.883

我发现这个其他线程提供了捕获旧值的方法，因此您可以将它与“新”值进行比较，如果它们是那么简单地让它什么都不做。

[如何在 Excel VBA 中获取已更改单元格的旧值？](https://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba)

# sencha-touch - Sencha Touch 自定义返回键

> ID：12064444
> 
> 赞同：0
> 
> 时间：2012-08-21T23:22:38.210
> 
> 标签：sencha-touch, sencha-touch-2

我需要为嵌套列表创建一个自定义后退按钮。在我的控制器中，我创建了一个监听器来捕获按钮点击事件，如下所示：

```
onCustomButtonBackTap: function(button, e, options) {
        this.getMyList().setDepth(node.data.depth-1); <-- seudo code, does not work
    }, 
```

我的问题是如何在每次单击自定义按钮时将我的嵌套列表的当前级别设置回一？另外，如果这种方法不正确，请告诉我

感谢您的帮助和建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T16:07:38.157

首先，您需要获取当前活动项以设置新项...您需要使用下面示例代码中的方法来完成您要查找的内容：

```
var newIndex = this.getMyList().getActiveItem();
this.getMyList().setActiveItem(newIndex-1);

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:15:26.580

@Jeff，谢谢您的回答，但我发现以下方法在我的情况下效果更好

```
onCustomButtonBackTap: function(button, e, options) {
        if (this.getMyList().items.indexOf(this.getMyList().getActiveItem()) > 0) {
        this.getMyList().onBackTap();
        }
    }, 
```

# c++ - 在 QWidgets 中显示 QActions

> ID：12064446
> 
> 赞同：3
> 
> 时间：2012-08-21T23:22:58.770
> 
> 标签：c++, qt, qt-creator, qt-designer

QAction 很棒，因为可以在一个地方设计和管理，然后在 QMenus、QToolBars 以及理论上任何 QWidget 中显示和交互（毕竟每个 QWidget 都有一个 addAction() 函数）。此外，它们很方便，因为它们可以在设计器中进行操作（我需要将大部分界面保留在设计器中，以便人们可以调整它）。

但是我遇到了问题：\

我想要做的只是在一个组中显示一些动作（可能带有图标和文本等）。有几种方法可以做到这一点。

1.  使用 QToolBar：这可能是完美的，因为 QToolBar 已经有一堆配置选项（图标、文本等）。不幸的是，我似乎无法将 QToolBars 添加到主窗口以外的东西（使用设计器时）。我可以以编程方式完成，但是工具栏也必须在代码中填充（不好）。

2.  使用常规的 QWidget：我已经尝试了一段时间，但完全没有成功。我不仅在设计器中向 QWidgets 添加操作时遇到问题，而且即使我以编程方式添加它们也无法显示它们（我尝试将 contextMenuPolicy 设置为 ActionsContextMenu）。

有没有人对这些路径中的哪一个可能导致一些灵活的东西（有用的调整选项）但也可以从设计师那里获得任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:53:32.863

所以，事情的真相是 QToolBar 类并没有作为一个小部件暴露给设计师。加载后，您可以完全访问它。您的问题有 2 个相对简单的解决方案 - 取决于您需要多久执行一次。

**1：破解 UI 文件**

1.  如果您创建一个 UI 文件，请将一个新的空白 QWidget 拖入其中。
2.  将文件保存到磁盘
3.  使用文本编辑器打开它并将 QWidget 类更改为 QToolBar
4.  在设计器中重新打开，您现在在 UI 文件中有一个 QToolBar 可以使用。

如果您只是偶尔这样做 - 这不是一个糟糕的方法。

**2：制作一个QToolBar Designer插件**

稍微长一点的方法（但如果你经常使用它会更好）是自己将 QToolBar 暴露给设计器。唯一有点烦人的是你不能通过拖放来移动它......但无论如何，你仍然可以使用它并放入布局和所有东西。

我主要处理 PyQt，所以这就是插件在 PyQt 中的样子——但您可以阅读标准文档以了解如何在 C++ 中执行此操作。

```
#!/usr/bin/python

''' Auto-generated ui widget plugin '''

from PyQt4.QtDesigner import QPyDesignerCustomWidgetPlugin
from PyQt4.QtGui import QIcon
from PyQt4.QtGui import QToolBar as WidgetClass

class QToolBarPlugin( QPyDesignerCustomWidgetPlugin ):
    def __init__( self, parent = None ):
        super(QToolBarPlugin, self).__init__( parent )

        self.initialized = False

    def initialize( self, core ):
        if ( self.initialized ):
            return

        self.initialized = True

    def isInitialized( self ):
        return self.initialized

    def createWidget( self, parent ):
        return WidgetClass(parent)

    def name( self ):
        if ( hasattr( WidgetClass, '__designer_name__' ) ):
            return WidgetClass.__designer_name__
        return WidgetClass.__name__

    def group( self ):
        if ( hasattr( WidgetClass, '__designer_group__' ) ):
            return WidgetClass.__designer_group__
        return 'ProjexUI'

    def icon( self ):
        if ( hasattr( WidgetClass, '__designer_icon__' ) ):
            return QIcon(WidgetClass.__designer_icon__)
        return QIcon()

    def toolTip( self ):
        if ( hasattr( WidgetClass, '__designer_tooltip__' ) ):
            return WidgetClass.__designer_tooltip__
        elif ( hasattr( WidgetClass, '__doc__' ) ):
            return str(WidgetClass.__doc__)
        return ''

    def whatsThis( self ):
        return ''

    def isContainer( self ):
        if ( hasattr( WidgetClass, '__designer_container__' ) ):
            return WidgetClass.__designer_container__
        return False

    def includeFile( self ):
        return 'PyQt4.QtGui'

    def domXml( self ):
        if ( hasattr( WidgetClass, '__designer_xml__' ) ):
            return WidgetClass.__designer_xml__

        return '<widget class="QToolBar" name="toolbar"/>' 
```

# javascript - 使用javascript获取多个图像的位置

> ID：12064448
> 
> 赞同：0
> 
> 时间：2012-08-21T23:23:18.597
> 
> 标签：javascript

我想要实现的是当用户停止滚动时，我想将最接近中心的图像定位到中心。我认为，这将涉及我运行一系列`if`语句来确定哪个图像最接近中心。我将能够做到这一点，但在此之前我得到的偏移量是错误的。我正在努力解决图像定位问题，我知道这与偏移有关，但我需要一些指导，因为偏移值不正确。看看这个链接[http://bit.ly/PDz2JD](http://bit.ly/PDz2JD)看看`setupHscroll`里面的函数，`getImageOffset`我认为这就是问题所在。

```
function getImageOffset() {
   var arr = new Array;
   var images = document.getElementById("container").getElementsByTagName("img");
   for (var i = 0, l = images.length; i < l; i++) {
       arr.push(images[i].offsetLeft);
       console.log(images[i].offsetLeft - rect.left);
   }
   return arr;
} 
```

请帮助，如果可能的话，帮助我理解。谢谢，我是否使用正确的方法来获取图像的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:33:34.647

见[http://www.w3.org/TR/cssom-view/#offset-attributes](http://www.w3.org/TR/cssom-view/#offset-attributes)

offsetLeft 将检索相对于 offsetParent 的偏移量。

如果可以的话，我会建议为该`$.offset()`功能引入 jQuery。

否则，试试这个：[http ://www.quirksmode.org/js/findpos.html](http://www.quirksmode.org/js/findpos.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:34:47.033

在您的简单情况下，您可以执行以下操作：对于每个图像（或者更好的`<div>`是，包含它的每个图像），取它`offsetLeft`并添加它的一半`offsetWidth`。然后取`offsetWidth`of`#container`并将其除以 2，然后减去其`marginLeft`style 属性的数量。

找到其值最接近此图像的图像，然后您就完成了。

# javascript - 基于时间的不均匀计数计时器Jquery

> ID：12064449
> 
> 赞同：0
> 
> 时间：2012-08-21T23:23:18.387
> 
> 标签：javascript, jquery, countdown

我一直在寻找一个基于一天中时间的 jquery 计数计时器，但我很难找到一个，所以在这里我只写了我自己的。这是给任何正在寻找的人。

目标是获取一天中的时间，计算当前时间当天的百分比，将其乘以目标总和并开始添加以创建现实的时间场景。我的计时器正在触发以创建不稳定数据流的模拟，但您可以轻松地将其更改为稳定增加。

带数字的元素是`#counter`，物镜总和是3.5mm。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:23:18.387

```
var currentNumber;

$(document).ready(function (e) {
    var currDate = new Date();
    var mins = currDate.getMinutes();
    var hours = currDate.getHours();
    var seconds = currDate.getSeconds();
    var combined = (hours * 60 * 60) + (mins * 60) + seconds;
    var percentage = (combined / 90000);
    var startingPoint = Math.round(3500000 * percentage);
    currentNumber = startingPoint;

    $('#counter').html(formatNumber(startingPoint));

    setTimeout(function () {
        updateNumber(currentNumber)
    }, 100);
});

function updateNumber(startingPoint) {
    if (startingPoint % 58 === 0) {
        startingPoint += 5;
        currentNumber = startingPoint;
        $('#counter').html(formatNumber(currentNumber));
        setTimeout(function () {
            updateNumber(currentNumber)
        }, 850);
    } else if (startingPoint % 22 === 0) {
        startingPoint += 4;
        currentNumber = startingPoint;
        $('#counter').html(formatNumber(currentNumber));
        setTimeout(function () {
            updateNumber(currentNumber)
        }, 500);
    } else if (startingPoint % 6 === 0) {
        startingPoint += 1;
        currentNumber = startingPoint;
        $('#counter').html(formatNumber(currentNumber));
        setTimeout(function () {
            updateNumber(currentNumber)
        }, 75); 
    } else {        
        startingPoint += 5;
        currentNumber = startingPoint;
        $('#counter').html(formatNumber(currentNumber));
        setTimeout(function () {
            updateNumber(currentNumber)
        }, 250);
    }
}

function formatNumber(number) {
    return addCommas((number).toFixed(0));
}

function addCommas(nStr) {
    nStr += '';
    x = nStr.split('.');
    x1 = x[0];
    x2 = x.length > 1 ? '.' + x[1] : '';
    var rgx = /(\d+)(\d{3})/;
    while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
    }
    return x1 + x2;
} 
```

# c# - 创建动态属性/关系

> ID：12064458
> 
> 赞同：0
> 
> 时间：2012-08-21T23:24:45.830
> 
> 标签：c#, asp.net, asp.net-mvc, linq-to-sql

我正在使用 C# ASP.NET MVC 进行企业 Web 开发项目，他们的一个要求是具有动态属性以及实体之间的动态关系。因此，他们希望能够更改属性/关系，而无需经历更改 SQL 模式/ORM 类的麻烦。我们正在使用 LINQ-to-SQL。

所以我的问题是；实现它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:42:14.837

```
void Main()
{
    var db =      @"<root>
                        <entities>
                            <entity id='1' name='tim'/>
                            <entity id='2' name='Gaui'/>
                        </entities>
                        <properties>
                            <property id='1' entityid='1' name='Age' value='46'/>
                            <property id='2' entityid='1' name='Country' value='Australia'/>
                            <property id='3' entityid='2' name='StackoverflowRep' value='17'/>
                        </properties>
                    </root>";
    var doc = XElement.Parse(db);
    var ents = from e in doc.Descendants("entity")
                select new Entity()
                {
                    id = (int)e.Attribute("id"),
                    name = (string)e.Attribute("name"),
                    Properties = doc.Descendants("property")
                                    .Where(p => (int)p.Attribute("entityid") == (int)e.Attribute("id"))
                                    .Select( p => new { name = (string)p.Attribute("name") , value = (string)p.Attribute("value")})
                                    .ToDictionary(k => k.name, v => v.value)
                };
    ents.Dump();                
}

public class Entity
{
    public int id {get;set;}
    public string name {get;set;}
    public IDictionary<string, string> Properties {get;set;}
}

// You can run this spike in LinqPad (language c# Program)

// In this example I just have a simple master detail, and the assumtion is that the name/value pairs are strings. 
// In a real app you probably would have another table with property types, something like...

//<propertytypes>
//  <propertytype id='1' Name='Country' type='string'>
//  ....etc
//  </propertytype>
//</propertytypes>

// and in the properties table you would join to this instead.

// This would give you the data types, plus the ability to 
// populate a list of allowed properties etc. 
```

# macos - Apple gcc：/usr/bin/gcc-4.2 和 /usr/bin/i686-apple-darwin11-llvm-gcc-4.2 有什么区别？

> ID：12064464
> 
> 赞同：2
> 
> 时间：2012-08-21T23:25:33.133
> 
> 标签：macos, gcc, llvm-gcc

我正在运行狮子。我有这两个版本`gcc`都声称是同一件事，但`diff`声称二进制文件不同。我试图了解`gcc`OS X 上的情况。它们之间有什么区别？

```
$ /usr/bin/gcc-4.2 --version
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.9.00)
Copyright (C) 2007 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

$ /usr/bin/i686-apple-darwin11-llvm-gcc-4.2 --version
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.9.00)
Copyright (C) 2007 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

$ diff /usr/bin/gcc-4.2 /usr/bin/i686-apple-darwin11-llvm-gcc-4.2
Binary files /usr/bin/gcc-4.2 and /usr/bin/i686-apple-darwin11-llvm-gcc-4.2 differ 
```

# c# - 最终 png 中某些像素的 WBMP 到 PNG 错误

> ID：12064469
> 
> 赞同：1
> 
> 时间：2012-08-21T23:26:09.767
> 
> 标签：c#, png, bmp

我的代码有问题。读取 wbmp 数据后，得到宽度和高度，我根据转换成双数组的数据设置像素。但是我的最终 png 文件包含一张看起来像假定图片但某些像素位置不正确的图片。（请假设宽度始终是 8 的倍数，即精确的 x 字节，因此可以忽略填充零）

我的猜测是我的代码错误或读取/转换数据时发生了一些错误。

我花了几个小时寻找原因，但不能这样做。你们可以帮帮我。

以下是我的代码：

```
using System;
using System.Drawing;
using System.IO;
using System.Collections;

class Program
{
    static void Main(string[] args)
    {

    BinaryReader binReader = new BinaryReader(File.Open(args[0], FileMode.Open));
    byte[] aa = new byte[1000];

    int width, height;

    try
    {
        //read the bytes until the end of stream
        for (int i = 0; i<aa.Length; i++)
        {
            aa[i] = binReader.ReadByte();
        }

    }
    catch (EndOfStreamException)
    {
        Console.WriteLine("End of the Stream");
    }
    //once end is reached,
    finally
    {
        width = aa[2];
        height = aa[3];

        Console.Write("Width: " + width);
        Console.Write(" Height: " + height + "\n");

        //Conversion
        BitArray bits = new BitArray(aa); //convert bytes array to bit array
        //Conversion Ends

        Bitmap image = new Bitmap(width, height);

        int index = 32;

        for (int r = 0; r < height; r++)
        {
            for (int c = 0; c < width; c++)
            {
                if (bits[index] == false)
                {
                    image.SetPixel(c, r, Color.Black);
                    index++;

                }
                else
                {
                    image.SetPixel(c, r, Color.White);
                    index++;
                }

            }
        }
        String n = "aa";
        image.Save(n + ".png", System.Drawing.Imaging.ImageFormat.Png);

    }

    Console.Write("\nPress any key to continue . . .");
    Console.ReadKey(true);
    }

} 
```

# php - php 从 Dropbox 获取 url

> ID：12064470
> 
> 赞同：0
> 
> 时间：2012-08-21T23:26:52.030
> 
> 标签：php, json, dropbox

我使用的是推荐的 php script dropbox [https://github.com/BenTheDesigner](https://github.com/BenTheDesigner)，可以得到 json 响应，也可以列出文件。

即这是我的开发者帐户中来自test.php 的文件的输出。

```
This is a list of all files in your [APP] Dropbox.

 api_upload_test.txt45 bytes
 dsdsdsdsdsdsd0 bytes
  ghhhhhhhhhhhh0 bytes
If I Fell - The Beatles.mp31 MB
 Koala.jpg762.5 KB
 test_download_api_upload_test.txt45 bytes 
```

但我需要这些文件的绝对网址。即http : ***//something/sandbox/folder/Koala.jpg***

或 http://***某事***/fileget/http://***某事***/koala.jpg

我找不到有关指定 url 或是否使用 Dropbox url 的任何信息。可能是一个愚蠢而简单的答案。

```
This is an example of the array;
    array(3) {
       ["code"]=>
      string(3) "200"
      ["body"]=>
     object(stdClass)#8 (9) {
        ["hash"]=>
    string(32) "df98863d80aa0c89f5e359a4f3e10b5a"
    ["thumb_exists"]=>
    bool(false)
    ["bytes"]=>
    int(0)
    ["path"]=>
    string(1) "/"
    ["is_dir"]=>
    bool(true)
    ["size"]=>
    string(7) "0 bytes"
    ["root"]=>
    string(10) "app_folder"
    ["contents"]=>
    array(6) {
      [0]=>
      object(stdClass)#9 (12) {
        ["revision"]=>
        int(1)
        ["rev"]=>
        string(9) "109a31b3c"
        ["thumb_exists"]=>
        bool(false)
        ["bytes"]=>
        int(45)
        ["modified"]=>
        string(31) "Tue, 21 Aug 2012 12:26:04 +0000"
        ["client_mtime"]=>
        string(31) "Tue, 21 Aug 2012 12:26:04 +0000"
        ["path"]=>
        string(20) "/api_upload_test.txt"
        ["is_dir"]=>
        bool(false)
        ["icon"]=>
        string(15) "page_white_text"
        ["root"]=>
        string(7) "dropbox"
        ["mime_type"]=>
        string(10) "text/plain"
        ["size"]=>
        string(8) "45 bytes"
      }
      [1]=>
      object(stdClass)#10 (10) {
        ["revision"]=>
        int(3)
        ["rev"]=>
        string(9) "309a31b3c"
        ["thumb_exists"]=>
        bool(false)
        ["bytes"]=>
        int(0)
        ["modified"]=>
        string(31) "Tue, 21 Aug 2012 14:09:26 +0000"
        ["path"]=>
        string(14) "/dsdsdsdsdsdsd"
        ["is_dir"]=>
        bool(true)
        ["icon"]=>
        string(6) "folder"
        ["root"]=>
        string(7) "dropbox"
        ["size"]=>
        string(7) "0 bytes"
      }
      [2]=>
      object(stdClass)#11 (10) {
        ["revision"]=>
        int(4)
        ["rev"]=>
        string(9) "409a31b3c"
        ["thumb_exists"]=>
        bool(false)
        ["bytes"]=>
        int(0)
        ["modified"]=>
        string(31) "Tue, 21 Aug 2012 15:29:22 +0000"
        ["path"]=>
        string(14) "/ghhhhhhhhhhhh"
        ["is_dir"]=>
        bool(true)
        ["icon"]=>
        string(6) "folder"
        ["root"]=>
        string(7) "dropbox"
        ["size"]=>
        string(7) "0 bytes"
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T08:18:55.187

Found a way of getting the url. The full path is not given in the array from dropbox. You have to specify media in the request, and the full path is given, which expires every 4 hours.

ie

```
$media = $dropbox->media($path); 
```

# javascript - 在灯箱中的图像上添加热点链接

> ID：12064472
> 
> 赞同：0
> 
> 时间：2012-08-21T23:27:16.487
> 
> 标签：javascript, jquery, lightbox

我已经偶然发现了一段时间，经过几周的研究，我觉得在这里寻求帮助是安全的。

我要做的是：用户单击图像>灯箱显示更大的图像>更大的图像有一个热点，其中包含指向另一个页面的链接。

这可能吗？它看起来很简单，但我似乎无法让它工作。这是供参考的代码。

```
<a href="images/createaccount_img.jpg" rel="lightbox" usemap="#Map" map name="Map" id="Map"><area shape="rect" coords="323,205,567,361" href="URL LINK 1" target="_blank" /><area shape="rect" coords="995,613,1191,668" href="URL LINK 2" target="_blank" > <img src="images/panel_login_11.jpg" width="152" height="27" alt="" /> 
```

解决方案：最好的选择是使用[http://fancybox.net/](http://fancybox.net/) ，它允许您在框内添加许多额外元素，包括：Divs、iframe、html 等等！再次感谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:14:01.917

这是一个简单的 HTML 页面，上面有一张企鹅的图片，企鹅头上有一个热点，链接到 www.google.com

```
 <!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>

    <div id="hotspot_image" style=""><img alt="Image with Hot Spot that links to www.google.com" src="http://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Pygoscelis_papua.jpg/250px-Pygoscelis_papua.jpg" />
        <a href="https://www.google.com" style="position:absolute; width: 60px; height: 60px; left:100px; top: 40px; z-index:1; " ></a></div>

</body>
</html> 
```

现在您只需要`<div>`在您的灯箱中显示包含图像和链接的内容。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:40:09.467

首先：map 是一个单独的标签。所以你的代码永远不会工作。
这是您通常使用地图的方式：

```
<a href="images/createaccount_img.jpg" rel="lightbox">
  <img src="images/panel_login_11.jpg" width="152" height="27" alt="" usemap="#map" />
</a>

<map name="map" id="map">
    <area shape="rect" coords="323,205,567,361" href="URL LINK 1" target="_blank" />
    <area shape="rect" coords="995,613,1191,668" href="URL LINK 2" target="_blank" > 
</map> 
```

话虽如此，然后我想在链接上放置一个属性`data-usemap`，该链接包含指向全尺寸图像的 url。像这样：

```
<a href="http://lokeshdhakar.com/projects/lightbox2/images/examples/image-1.jpg" rel="lightbox" data-usemap="#map"><img src="http://lokeshdhakar.com/projects/lightbox2/images/examples/thumb-1.jpg" alt=""></a> 
```

然后我修改`lightbox.js`为读取此属性`usemap: $link.attr('data-usemap')`并设置该属性`$image.attr('usemap', _this.album[imageNumber].usemap);`

*现在全尺寸图像具有正确的 usemap 集*。
但是**还是不行**！！我认为这是因为 div 覆盖在这张图片上。
这是我工作过的[小提琴。](http://jsfiddle.net/fKM7r/)搜索`//xxx added`以找到我添加的 2 行。也许其他人可以做更多的工作。

换句话说，我认为在未修改的 lightbox.js 上创建一个 mod 并不容易。

A 还想指出，像灯箱这样的很多脚本也会调整全尺寸图像的大小以适应屏幕（据我所知，灯箱不会这样做）：那么你还需要 javascript 来重新计算坐标我猜的地图。

# visual-studio-2010 - 使用 File* 对象时出现错误指针错误

> ID：12064475
> 
> 赞同：2
> 
> 时间：2012-08-21T23:27:41.373
> 
> 标签：visual-studio-2010, pointers, file-io

我只需要一些关于我使用 MS Visual Studio 2010 遇到的错误指针错误的建议。

```
FILE *rawDataFile = fopen("C:\\Data.txt", "rb"); 
```

当我在执行上述内容后使用发布/调试模式单步执行我的代码时，当我查看变量时，我总是最终得到一个 < Bad Ptr > 声明。

我真的不知道为什么会发生这种情况，据我所知内存已正确分配，之前似乎没有发生内存损坏。

我真的很感激任何可以帮助我进一步挖掘的指针？

![在此处输入图像描述](../Images/44184e82eb56392602956a55cb1f1f63.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:32:47.560

`<Bad Ptr>`不一定表示内存损坏，也不一定表示错误。在这种情况下，它只是意味着指针为空，因此调试器无法提供有关指向对象的任何信息（由于指针为空，因此不存在这样的对象）。

结构的数据成员的值`FILE`是实现定义的。在 Visual C++ 实现中，这些成员有时为空。这很正常。

# javascript - Chrome 扩展程序和 RSS 源

> ID：12064476
> 
> 赞同：0
> 
> 时间：2012-08-21T23:27:48.577
> 
> 标签：javascript, html, google-chrome-extension

我正在尝试为一个显示最新 RSS 提要项目的网站创建一个 chrome 扩展。我尝试了各种库，但它们都依赖于远程脚本。我想知道是否：

A）有一种方法可以绕过扩展中的安全性。

或者

B) 有任何选择。

# eclipse - Eclipse 和 m2e - 测试类路径

> ID：12064484
> 
> 赞同：0
> 
> 时间：2012-08-21T23:28:53.520
> 
> 标签：eclipse, testing, maven, classpath, m2e

我有 maven 支持的 Spring 项目，我正在使用 m2e 插件。现在，我的一些文件在`/src/main/webapp/WEB-INF/`文件夹中。现在，问题是当我运行测试时，一些带有配置的 .xml 文件不起作用，因为资源的路径正在中断。

首先，提问。当我在 project 上做时`Run As -> JUnit test`，剂量 eclipse 通过做来备份`mvn test`，还是以这种方式与 maven 无关？如果是这样，这将解释为什么添加后

```
<plugin> 
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-plugin</artifactId>
  <configuration>
    <additionalClasspathElements>
      <additionalClasspathElement>/src/main/webapp/</additionalClasspathElement>
    </additionalClasspathElements>
  </configuration>
</plugin> 
```

当我`pom.xml`使用`Run As -> JUnit test`和打印类路径运行测试时，我没有看到我添加的位置，但是这样做`mvn test`我可以看到这个位置添加到类路径中。

那么，是否可以让 eclipse/maven 将一些附加文件复制到`target/classes`或`target/test-classes`

或者

只需在测试应用程序时将一些文件夹添加到运行时类路径。

此外，是否可以在一个地方做这样的事情，所以无论我是使用 Eclipse gui 还是仅从`mvn test`控制台运行测试都没有关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:33:07.000

除非这最近发生了变化，否则您在 Eclipse 中的类路径仍然是从您的 .classpath 文件构建的。m2e 注入了一些元素，尤其是依赖项，但源/资源路径仍然需要一个条目。

将您需要的内容添加到 .classpath 应该可以解决问题。

# asp.net-mvc-4 - MVC Web Api 返回序列化响应而不是 css

> ID：12064491
> 
> 赞同：0
> 
> 时间：2012-08-21T23:30:07.110
> 
> 标签：asp.net-mvc-4, asp.net-web-api, mediatypeformatter

我在从 web api 控制器返回 css 时遇到问题。该代码接受一个 css 文件的请求，并在从数据库中读取它后返回它。

问题是 web api 代码似乎正在序列化响应并返回它而不是 css 本身。

在这里，您可以看到浏览器发送到服务器的链接标签，该标签应该返回 css。您还可以看到响应看起来像是我的 css 的序列化，而不仅仅是 css 字符串。

![在此处输入图像描述](../Images/c98da95ed55af5277d357d5192379da9.png)

我的请求和响应标头：

![在此处输入图像描述](../Images/464260c536445b3911cad5095abd0df6.png)

我的控制器如下所示：

```
public HttpResponseMessage Get(string fileName, string siteId, int id)
{
    var fileData = ReadSomeCssFromTheDatabase();

    var result = new HttpResponseMessage(HttpStatusCode.OK);
    result.Content = new ByteArrayContent(fileData);
    result.Content.Headers.ContentType = new MediaTypeHeaderValue("text/css");

    result.Headers.CacheControl = new CacheControlHeaderValue();
    result.Headers.CacheControl.MaxAge = TimeSpan.FromHours(0);
    result.Headers.CacheControl.MustRevalidate = true;

    return result;
} 
```

安装了一个“text/css”格式化程序，正在创建但由于某种原因没有被命中。

```
public class CssFormatter : MediaTypeFormatter
{
    public CssFormatter()
    {
        SupportedMediaTypes.Add(new MediaTypeHeaderValue("text/css"));
    }

    public override Task<object> ReadFromStreamAsync(Type type, Stream readStream, HttpContent content, IFormatterLogger formatterLogger)
    {
        var taskCompletionSource = new TaskCompletionSource<object>();
        try
        {
            var memoryStream = new MemoryStream();
            readStream.CopyTo(memoryStream);
            var s = System.Text.Encoding.UTF8.GetString(memoryStream.ToArray());
            taskCompletionSource.SetResult(s);
        }
        catch (Exception e)
        {
            taskCompletionSource.SetException(e);
        }
        return taskCompletionSource.Task;
    }

    public override bool CanReadType(Type type)
    {
        return type == typeof(string);
    }

    public override bool CanWriteType(Type type)
    {
        return false;
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:20:09.037

*   您的格式化程序不会受到打击，因为您没有经历内容协商过程（因为您在操作中返回 HttpResponseMessage ......您可以使用 Request.CreateResponse<> 使 conneg 过程运行）

*   您正在尝试“写入”css 内容，对吗？...但我看到 CanWriteType 正在返回“false”，而且您似乎正在覆盖 ReadFromStreamAsync 而不是 WriteToStreamAsync？

你可以如何做的一个例子（根据我对上述场景的理解）：

```
public class DownloadFileInfo
{
    public string FileName { get; set; }
    public string SiteId { get; set; }
    public int Id { get; set; }

}

public HttpResponseMessage Get([FromUri]DownloadFileInfo info)
    {
        // validate the input

        //Request.CreateResponse<> would run content negotiation and get the appropriate formatter
        //if you are asking for text/css in Accept header OR if your uri ends with .css extension, you should see your css formatter getting picked up.
        HttpResponseMessage response = Request.CreateResponse<DownloadFileInfo>(HttpStatusCode.OK, info);

        response.Headers.CacheControl = new CacheControlHeaderValue();
        response.Headers.CacheControl.MaxAge = TimeSpan.FromHours(0);
        response.Headers.CacheControl.MustRevalidate = true;

        return response;
    }

public class CssFormatter : MediaTypeFormatter
{
    public CssFormatter()
    {
        SupportedMediaTypes.Add(new MediaTypeHeaderValue("text/css"));
    }

    public override bool CanReadType(Type type)
    {
        return false;
    }

    public override bool CanWriteType(Type type)
    {
        return type == typeof(DownloadFileInfo);
    }

    public override Task WriteToStreamAsync(Type type, object value, Stream writeStream, HttpContent content, TransportContext transportContext)
    {
        //use the 'value' having DownloadFileInfo object to get the details from the database.
        // Fead from database and if you can get it as a Stream, then you just need to copy it to the 'writeStream'
    }
} 
```

# php - 如果字段为空，则阻止执行表单

> ID：12064496
> 
> 赞同：-1
> 
> 时间：2012-08-21T23:30:35.020
> 
> 标签：php, jquery

如果搜索字段为空白，我试图阻止表单执行。

html

```
<form id="form" action="">
<input type="text" id="lookup"><input type="submit" id="find" value="Look Up">

</form> 
```

jQuery

```
$('#find').click(function(){
var s = ('#lookup').attr('value');
if(s!=""){
$.ajax({
url: result/,
type:'POST',
data: s
success: function(){ //empty }
});
}
}); 
```

也试过

```
action="result" //form the form

$('#find').click(function(){
var s = ('#lookup').attr('value');
if(s!=""){
$("#form").submit();
}
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T23:32:29.530

绑定[`submit`](http://api.jquery.com/submit/)事件，`false`当搜索栏为空时返回，`true`如果不是则返回。返回`false`将阻止表单提交。

```
$("form").submit(function() {
    var s = $.trim($('#lookup').val());
    if (s) {
        $.ajax();
        return true;
    }
    return false;
}); 
```

**[演示](http://jsfiddle.net/wAhQs/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T23:34:03.713

```
 $('#find').click(function(e){
    var s = ('#lookup').attr('value');
    if(s!=""){
    $.ajax({
    url: result/,
    type:'POST',
    data: s
    success: function(){ //empty }
    });
    } 
      e.preventDefault();
    }); 
```

e.preventDefault() 将阻止提交按钮实际提交表单。或者您可以使用 return false。

但是假设在您的情况下，执行以下操作就足够了：

```
 $('#find').click(function(e){
var s = ('#lookup').attr('value');
if(s==""){
    e.preventDefault();
}
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T00:10:59.600

你可以简单地添加这样做

```
$('#find').click(function(){ 
var s = ('#lookup').attr('value'); 
if(s==""){ 
return false; 
} 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T23:35:19.267

尝试

```
$('#find').click(function(){
    var s = ('#lookup').val();
    if(s!="" && s != undefined && s!=null){
       //do your business here
    }
}); 
```

# c# - 我对课程感到困惑

> ID：12064497
> 
> 赞同：2
> 
> 时间：2012-08-21T23:30:46.733
> 
> 标签：c#, java, class, instantiation

我敢打赌，这是任何人都可能问过的最愚蠢的问题，但我似乎无法围绕这个话题展开思考。我知道一个类用于创建一个对象（当你实例化它时），但令我困惑的是，“你什么时候知道在程序中创建一个类是否可行？”。

假设您创建了一个程序，该程序从用户那里收集输入（无论是名称、数字还是任何其他详细信息），使用这些详细信息进行一些计算，然后将所有信息存储在本地。它是基本的，但是您是否需要使用一个类来使程序更流畅/更快或更易于维护？

我在混淆自己吗？

**编辑：我主要使用 Visual Studio 和 NetBeans IDE 等程序。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:37:54.473

正如您所说，类是一种允许您描述类型的构造，该类型具有属性方法和事件。

在简单的情况下，您可以轻松摆脱不使用类的情况，但在更大、更复杂的项目中，拥有经过深思熟虑的对象模型会使事情变得容易得多。更易于维护、扩展、重用和阅读。

当时可能感觉需要做更多的工作（在大多数情况下可能是这样），但如果您正在创建需要支持的东西，这绝对不是浪费精力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T23:42:27.340

在 Java 中，您别无选择：您不能编写类之外的代码。

类是实例的模板。它将状态和行为一起封装到单个软件组件中。您通过创建类的实例来编写程序，这些实例相互作用以实现您的目标。

> 您是否需要使用一个类来使程序更流畅/更快或更易于维护？

我不能代表 C#，但在 Java 中你别无选择。您要么创建一个在主类中完成所有这些工作的类，要么将其分解为几个类来处理问题的不同部分（例如 I/O、计算、持久性等）。您必须拥有一个或多个类.

您编写类并从中创建对象，因为它们很好地映射到您想要解决的问题类型。它们要么是模拟世界上物理事物的真实对象（例如 Person、Car、Bank 等），要么是思想的具体化（例如 PersonFactory、Account 等）。您选择编写面向对象的代码是因为对象对问题进行建模你想很好地解决。

有些问题适合函数式编程。编写程序来解决问题的方法不止一种。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:35:26.183

这是一个非常简单/易于理解的教程，它将帮助您学习/理解 C#，尤其是类也可以查看 Structs

[C# 类教程](http://www.csharp-station.com/Tutorial/CSharp/lesson07)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T23:43:13.643

类主要是供我们人类帮助我们组织代码的。它们不一定会使软件在计算机上运行得更快。当我第一次了解类时，我发现对“真实世界”对象建模很有帮助。例如，如果我想编写一个程序来计算几何形状的面积和周长，我会创建一个简单的`Shape`类来定义进行计算的抽象方法。然后我扩展这个类来创建不同类型的形状，比如`Circle`、`Square`和`Triangle`。从类的简单应用入手，通过更多的编程经验，我已经能够逐渐看到其他地方使用类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T23:44:32.103

**1.你什么时候知道在程序中创建类是否可行？**

我想几乎每个回答这个问题的人都会有稍微不同的反应，但通常情况下，您应该使用类来模块化程序的功能。在您的示例中，您说您的程序可能会从用户那里获取输入，使用输入来执行一些计算，并将用户数据和计算结果保存在某处。你可以有以下三个类：

`UserInput`- 处理键盘输入并将其转换为一些更易于处理的格式

`Calculator`- 转换后处理所有输入

`DataPersistence`- 处理从/向磁盘、数据库或任何您需要的读/写。

通过这种方式，您的所有代码不会只是堆积在大量 Java/C# main() 调用中，您可以彼此独立地专注于较小的部分。这些组件之间的交互决定了程序的行为。

**2\. 它是基本的，但您是否需要使用一个类来使程序更流畅/更快或更易于维护？**

由于对象在 Java 或 C# 等语言中的引用方式，类实际上可能最终会增加程序的开销，但与将程序编写在一个巨大的函数中相比，它们使您的代码更容易阅读和修改。这有点类似于将数学教科书分成章节。如果将代数、微积分和微分方程都浓缩到教科书的一章中，那么教科书对于那些想跳到微积分部分的人来说就不是很有用了。添加章节标题的开销可以忽略不计，因为它允许作者/读者专注于书的某些部分。

同样，类可以帮助您划分工作，以便以后更容易维护。速度/性能通常不受你如何将程序划分为类的影响，只要你聪明地做到这一点——这就是面向对象设计的真正艺术表现自己的地方:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T23:46:14.277

对于像您的示例这样的简单程序，要从用户那里收集输入（姓名、号码、评论），您可以轻松地做到这一点，而无需创建新类，不包括 C# 和 Java 等语言需要静态类来放置您的里面的主要功能。如果您使用像 C 这样的非面向对象语言，则无需类即可轻松完成。

实际上，对于您描述的简单类，创建该类似乎需要做一些额外的工作（尽管它可能可以忽略不计）。但是，这只是因为您指的是一小组数据。

创建类变得有用的地方是当您拥有许多数据时。该类充当将这些数据组合在一起的一种方式，并可能将其作为一个存储在本地。您还可以将其他相关方法添加到与类成员直接相关的每个类上。

当您的应用程序变得更加复杂时，假设您需要跟踪客户、产品、账单信息（信用卡、PayPal 等）、地址（运送到和账单），这时类在保留每一位方面变得非常有价值将信息组合在一起，以及将每个更大的信息“束”（类别）相互关联起来。

您可能有一个客户，他有一个订单，他有一个账单和一个送货地址。这些类中的每一个本身都有许多字段。但是你可以通过类更容易地将客户的更大概念与目标送货地址联系起来。

至于“你什么时候知道在程序中创建一个类是否可行？”，答案并不总是那么容易，但任何时候你看到自然组合在一起的数据字段（比如地址或产品）描述或帐单信息）。我希望我有一个更具体的答案，但这实际上取决于您正在构建什么，以及您正在使用什么类型的数据。

不，这不是任何人都可以问的最愚蠢的问题！我希望这有助于你的理解。

# servicestack - 我如何配置 servicestack 来处理 text/x-json 像 application/json

> ID：12064498
> 
> 赞同：1
> 
> 时间：2012-08-21T23:31:08.333
> 
> 标签：servicestack

对 microsoft 服务总线客户端中的某种类型的错误执行操作必须向我的服务器发送 text/x-json，因为 application/json 会导致服务总线崩溃或不响应。因此，我希望将 ServiceStack 配置为将 accept : text/x-json 和 content-type : text/x-json 与设置为 application/json 时的处理方式相同？我查看了 ContentTypeFilter.Regiser 但不清楚我需要设置哪些序列化程序选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:56:13.080

您无法更改[ServiceStack](http://www.servicestack.net)中现有的 JSON ContentType，但可以使用以下内容注册新的 ContentType：

```
appHost.ContentTypeFilters.Register(ContentType.Json,
    (r, o, s) => JsonDataContractSerializer.Instance.SerializeToStream(o, s), 
    JsonDataContractDeserializer.Instance.DeserializeFromStream); 
```

注意：这与内置[CsvFormat](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.EndPoints/Formats/CsvFormat.cs#L13)和[HtmlFormat](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.EndPoints/Formats/HtmlFormat.cs#L28)使用的 API 相同。

# apache - apache .htaccess 文件是用什么语言编写的？

> ID：12064504
> 
> 赞同：35
> 
> 时间：2012-08-21T23:31:37.337
> 
> 标签：apache, .htaccess

我知道一些语法等，但是整个编写重定向规则和被阻止的 IP 地址是否有一个名称？或者它只是被称为“Apache .htaccess 代码”？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-21T23:33:24.553

整个语法没有特定的名称，但它们被称为[**Directives**](http://httpd.apache.org/docs/2.2/mod/directives.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-02-16T05:16:27.603

根据 Wikipedia's page about [`.htaccess`](https://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions)，该语言的名称是该问题的先前答案/评论的组合。

> ## [格式和语言](https://en.wikipedia.org/wiki/.htaccess)
> 
> **`.htaccess`**文件是用[Perl 兼容正则表达式](https://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions)(PCRE) 语言的**[Apache Directives](https://alvinalexander.com/unix/edu/UnixSysAdmin/node170.shtml)**变体编写的。学习基本的 PCRE 本身可以帮助掌握这些文件的工作。
> 
> 由于历史原因，文件格式是**[Apache HTTP 服务器](https://en.wikipedia.org/wiki/Apache_HTTP_server)****全局配置文件**( )`.htaccess`的一个有限子集，即使与 Web 服务器（如[Oracle iPlanet Web Server](https://en.wikipedia.org/wiki/Oracle_iPlanet_Web_Server)和[Zeus Web Server](https://en.wikipedia.org/wiki/Zeus_Web_Server) ）一起使用时，它们的本地全局配置文件也大不相同。[`httpd.conf`](https://en.wikipedia.org/wiki/Httpd.conf)

顺便提一下，“ **htaccess** ”是*“[超文本](https://en.wikipedia.org/wiki/Hypertext)访问”*的缩写，`.`点号使它成为[Unix](https://en.wikipedia.org/wiki/Unix)环境中的隐藏文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-04T18:02:03.883

.htaccess 是用**Apache 语言**编写的。

指令只是 Apache 在其自己的配置文件中用于命令的术语。

脚注：[https ://code.tutsplus.com/tutorials/the-ultimate-guide-to-htaccess-files--net-4757](https://code.tutsplus.com/tutorials/the-ultimate-guide-to-htaccess-files--net-4757)

# genetic-algorithm - 如何在多项式中表示股票的价值？

> ID：12064514
> 
> 赞同：0
> 
> 时间：2012-08-21T23:33:06.533
> 
> 标签：genetic-algorithm, genetic-programming

我正在做一个遗传算法项目，我们需要构建一个软件，根据它们的历史选择一组股票。我们需要在遗传编程上做这件事，这意味着我们需要一个适应度函数和一个染色体。是的，我通过股票的平均历史与其实际价值之间的正差异来考虑适应度函数。（因此，如果匹配，它将为 0 ）。有人知道如何表达染色体吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T12:47:27.883

这个问题似乎没有很好的定义。如果您知道股票的实际价值，您提到的适应度函数将为您提供价格在其实际价值附近徘徊的股票的选择。其他可能性：

第一种情况：您试图根据其历史表现选择一组最有前途的股票，即最大化预期收益和/或最小化方差/风险。如果可供选择的股票数量不多，最简单的选择是使用二进制字符串：0 表示没有选择，1 表示选择。该位置对应于股票的指数。如果您有大量可能的股票可供选择，您可以将股票的标签/索引编码为您的染色体。如果您对要选择的股票数量没有最大上限，这可能意味着可变长度的染色体，并且编码会更加困难。

适应度函数（要最大化）将是所选股票的（预期收益 - 标准差）之和。预期回报可以通过两种方式制定：预期未来价格 - 当前价格，或当前价格 - 基础价值（如果你知道基础价值，那就是）。可以根据历史数据估计预期的未来价格（例如，拟合您选择的简单曲线，或应用 ARIMA 并扩展到下一个时间点）。标准偏差可以直接从历史数据中估算出来。

如果您的染色体是二进制的（值为 0/1），一旦您获得预期回报和标准偏差，一个简单的点积就可以完成所需的计算。我想可能对所选股票的数量也有限制，在这种情况下，您有一个受约束的优化问题。您可以将约束表示为适应度中的惩罚。

该问题本质上是一个二进制整数线性程序 (BILP)，您可以将 GA 与其他 bilp 求解器进行基准测试。使用一个不错的混合整数线性规划求解器（例如 symphony、gurobi、ibm cplex 等），您通常可以比使用 GA 更快地解决大问题。

第二种情况：您试图找出以当前价格购买多少股票以最大化预期收益。除非您想表示短路，否则您的染色体将是非负整数。适应度仍与第 (1) 项相同，即选定股票的价格总和，随时间的平均值减去选定股票随时间的历史价格的标准差。该问题变为整数线性规划问题。其他一切与第 (1) 项相同。同样，如果您可以选择的股票数量很大，您会发现 MILP 求解器会比 GA 更好地为您服务。

此外，GP（遗传编程）与 GA 有很大不同。如果您正在尝试发展一种选股策略，或者一种预测未来股价的表达式，那么您实际上就是一个 GP。对于选股问题，a ga wld b 就足够了。

# database - 可为空的外键违反什么范式？

> ID：12064516
> 
> 赞同：2
> 
> 时间：2012-08-21T23:33:13.087
> 
> 标签：database, database-design, normalization

一位同事向我解释说，可空外键在数据库设计中被认为是不好的做法，因为它违反了早期的正常形式之一。虽然我在学校上过基本的数据库课程，但我不认为范式被作为一个话题来讨论。讨论此主题的维基百科和其他网站使用学术术语，但我想更好地理解范式的这方面，而不必上一堂课。

我认识到[并不是每个人都觉得可空外键不好](https://stackoverflow.com/questions/1723808/nullable-foreign-key-bad-practice)：这个问题并没有引发关于这个问题的辩论。相反，我想具体了解它们与范式主题的关系。可空外键违反了哪些范式，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:45:38.837

我认为[Erwin Smout](https://stackoverflow.com/a/1724420/562459)在您链接的问答中回答了这个问题。

日期在第 7 版中写道。*数据库系统简介*的。

> 第一范式：当且仅当在该 relvar 的每个合法值中，每个元组中的每个属性都恰好包含一个值时，一个 relvar 是 1NF。（第 357 页）

并且

> 关于空值的全部要点恰恰是它们不是值——重复一遍，它们是标记或标志。（第 584 页）

因此，在 Date 看来，允许在任何列中使用空值的 relvar 不在 1NF 中。

他的“缺失信息”一章有很多关于这个主题的内容。

# php - mysql获取行内存错误

> ID：12064522
> 
> 赞同：1
> 
> 时间：2012-08-21T23:34:37.170
> 
> 标签：php, mysql, memory

我正在使用我在网上找到的修改后的 php mysql 备份脚本来备份我的 sql 数据库，但我一直遇到 mysql_fetch_row 的问题，我想知道是否有办法修复它。

我用内存错误评论了这一行。

```
<?php
ini_set('memory_limit','4000M');
$ho = "host";
$us = "username";
$pa = "password";
$da='dbname';

backup_tables($ho,$us,$pa,$da);

/* backup the db OR just a table */
function backup_tables($host,$user,$pass,$name,$tables = '*')
{
    $link = mysql_connect($host,$user,$pass);
    mysql_select_db($name,$link);

    //get all of the tables
    if($tables == '*')
    {
        $tables = array();
        $result = mysql_query('SHOW TABLES');
        while($row = mysql_fetch_row($result))
        {
            $tables[] = $row[0];
        }
    }
    else
    {
        $tables = is_array($tables) ? $tables : explode(',',$tables);
    }

    $filename = 'db-backup-'.time().'-'.(md5(implode(',',$tables))).'.sql';
    $handle = fopen($filename,'w');

    //cycle through
    foreach($tables as $table)
    {
        $result = mysql_query('SELECT * FROM '.$table);
        $num_fields = mysql_num_fields($result);

        fwrite( $handle, 'DROP TABLE '.$table.';' );

        $row2 = mysql_fetch_row(mysql_query('SHOW CREATE TABLE '.$table));
        fwrite( $handle, "\n\n".$row2[1].";\n\n" );

        for ($i = 0; $i < $num_fields; $i++)
        {
            //this is the line with the error******
            while($row = mysql_fetch_row($result))
            {
                fwrite( $handle, 'INSERT INTO '.$table.' VALUES(' );
                for($j=0; $j<$num_fields; $j++)
                {
                    $row[$j] = addslashes($row[$j]);
                    $row[$j] = ereg_replace("\n","\\n",$row[$j]);
                    if (isset($row[$j])) { fwrite( $handle, '"'.$row[$j].'"' ) ; } 
                    else { fwrite( $handle, '""' ); }

                    if ($j<($num_fields-1)) { fwrite( $handle, ',' ); }
            }
            fwrite( $handle, ");\n" );
       }
     }
    fwrite( $handle, "\n\n\n" );
}

    //save file

    fclose($handle);
}
?> 
```

这是错误：

```
Fatal error: Out of memory (allocated 1338507264) (tried to allocate 35 bytes) in /home/user/backupSQL/backupmodified.php on line 47 
```

我知道有更好的方法来进行备份，但这满足了我对系统的所有要求，而且我只遇到了我可笑的庞大数据库的内存问题。

谢谢您的帮助。

-PHP/MySQL 新手

附言。这是我使用的链接[http://www.htmlcenter.com/blog/back-up-your-mysql-database-with-php/](http://www.htmlcenter.com/blog/back-up-your-mysql-database-with-php/)

编辑：mysqldump 在备份这些大型数据库时工作正常，但大型数据库是修改最多的数据库，当有人需要处理它们时，我不能在转储时锁定我的 dbs。这就是我使用这个脚本的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:11:24.863

正如其他海报所提到的，您最好使用现成的工具，但现在让我们谈谈您的脚本。

如果你有一个大得离谱的表，那么就没有办法分配那么多内存。您必须将数据集拆分为多个块。使用如下查询：

```
$result = mysql_query('SELECT * FROM '.$table.' LIMIT '.$start.', 10000'); 
```

然后只需迭代`$start`或执行`while`循环以检查您是否仍然获得结果。像这样，您将获得 10000 条记录的数据块，因此它肯定适合您的记忆。

但是，仍然存在一个问题——一致性。如果您仍在获取块时某些行发生了变化怎么办？好吧，您可以将`SELECT`循环包装在事务中并在获取数据时锁定表。我知道您正在尝试避免锁定，但是锁定表比锁定整个数据库要好。这仍然不能确保表间的一致性，但这是在您设置的条件下可以做到的最好的。

编辑：这是循环的代码。我实施了`while`解决方案。有一个等效`for`循环，但两者之间的比较超出了本文的范围。

```
foreach($tables as $table)
{
    fwrite( $handle, 'DROP TABLE '.$table.';' );

    $row2 = mysql_fetch_row(mysql_query('SHOW CREATE TABLE '.$table));
    fwrite( $handle, "\n\n".$row2[1].";\n\n" );

    $start = 0;
    do {
        $result = mysql_query( 'SELECT * FROM '.$table.' LIMIT '.$start.', 10000' );
        $start += 10000;
        $num_rows = mysql_num_rows( $result );

        while( $row = mysql_fetch_row( $result ) ) {
            $line = 'INSERT INTO '.$table.' VALUES(';
            foreach( $row as $value ) {
                $value = addslashes( $value );
                $value = ereg_replace( "\n","\\n", $value );
                $line .= '"'.$value.'",';
            }
            $line = substr( $line, 0, -1 ); // cut the final ','
            $line .= ');\n';
            fwrite( $handle, $line );
        }
    } while( $num_rows !== 0 );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-16T12:01:51.050

*mysql*扩展具有[`mysql_unbuffered_query`](http://php.net/manual/en/function.mysql-unbuffered-query.php)专门为大型数据库查询而设计的功能。

*mysqli*中的等价物利用 的第二个参数[`mysqli_query`](http://php.net/manual/en/mysqli.query.php)，例如：

```
$res = $mysqli->query('SELECT * FROM large_database', MYSQLI_USE_RESULT);
while ($row = $res->fetch_assoc()) {
    ...
} 
```

但是这种方法有一些缺点，例如您无法知道其中的行数，并且在被释放`$res`之前您无法执行其他查询。`$res`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T23:43:56.317

这是一个非常典型的问题，转储以某种方式分配与表大小成正比的内存量。您应该在脚本中实现类似于 mysqldump 中的“--opt”选项，并查看如何转储大型数据库，例如这里[https://dba.stackexchange.com/questions/20/how-can-i-optimize-a-大型数据库的 mysqldump](https://dba.stackexchange.com/questions/20/how-can-i-optimize-a-mysqldump-of-a-large-database)

为什么不只使用**mysqldump**将输出记录到某个文件？

# ruby - 做脚注的红宝石降价处理器？

> ID：12064526
> 
> 赞同：1
> 
> 时间：2012-08-21T23:35:02.350
> 
> 标签：ruby, markdown, footnotes

是否有任何维护得当的 ruby​​ markdown 处理器对脚注进行扩展？我知道其他语言的一些降价处理器可以（尽管我不确定哪些）。

ruby 不太擅长记录它们可能支持的降价扩展。（哎呀，其他语言也不是）。

有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:36:59.953

我使用过[kramdown](http://kramdown.rubyforge.org/syntax.html)，它是我选择的降价库。它实际上提供了 Markdown 语法的超集，借用了其他库的附加功能。例如，脚注功能是从[PHP Markdown Extra](http://michelf.ca/projects/php-markdown/extra/#footnotes)包中借用的。

示例语法：

```
That's some text with a footnote.[^1]

[^1]: And that's the footnote. 
```

# php - 下载按钮在登录但未注销时有效

> ID：12064528
> 
> 赞同：2
> 
> 时间：2012-08-21T23:35:21.740
> 
> 标签：php, joomla, joomla2.5

**Joomla 版本 = 2.5.6**

**PHP 版本 = 5.3**

我们将[DButton](http://www.etepoc.com)模块用作文章中的下载按钮并 `{loadposition xxx}`用于显示它。

大约 5 天前，该按钮运行良好，但从那时起，发生了一些事情，现在它仅在用户登录时才有效。如果他们没有登录，则该按钮只会刷新页面。（但确实显示）。

同样在测试期间，我们取消了模块的发布 - 模块在未登录时“消失”了 5 到 10 分钟。登录后，它立即“消失”，实际上，在注销时，尽管未发布，它又重新出现了！

在过去两周左右的时间里，我们没有编辑任何模块文件，也没有在网站上更改任何内容/安装任何新扩展。

我们使用 JDump 并没有在模块中发现错误，因此我真的不确定问题可能是什么。

我们还与开发人员取得了联系，他们说他们以前从未遇到或听说过这样的问题，他们会看一看，但从那以后我们就没有收到他们的消息。

重新安装模块也没有帮助。

有没有人遇到过这样的事情或有想法或解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:06:15.613

警告：我从未使用过 DButton，但看起来很方便。

您是否使用自定义级别？他们打算做什么？这听起来与权限设置为仅注册而不是在某处公开有关。

尝试禁用所有其他扩展以防万一。

您是否链接到服务器上的 URL 或文件？

也许用 Akeeba 备份并安装一个本地版本，看看它是否做同样的事情。然后可以尝试用核心模板替换您的模板，并卸载除 DButton 之外的所有内容。

# c# - 如何以其他用户身份启动 Internet Explorer 进程，例如 /netonly？

> ID：12064530
> 
> 赞同：2
> 
> 时间：2012-08-21T23:35:27.200
> 
> 标签：c#, internet-explorer, winapi, pinvoke, ntlm

我正在尝试从我们的 WPF 应用程序以另一个用户身份启动 Internet Explorer，这样当我们的用户访问（内部）网站时，他们会通过集成 Windows 身份验证静默进行身份验证。

我们不想以其他用户身份启动 iexplore.exe，因为当您在计算机上首次启动进程并且它首次尝试设置 IE7/8 时会出现奇怪的部署/环境问题。不过，如果您有一个解决方案来解决如何将每台机器上的每个 IE 安装程序静音，我很想听听。

回到我的预期问题。我可以使用命令提示符获得我想要的确切 IE 模拟行为* `runas`（感谢[https://serverfault.com/questions/70376/runas-domain-account-still-asks-for-password](https://serverfault.com/questions/70376/runas-domain-account-still-asks-for-password)）：

```
c:\> runas /noprofile /netonly /user:MyDomain\MyUser iexplore.exe 
```

`runas`*注意：由于多种原因，我不能用于我们的 WPF 应用程序，但*最终结果*是我想要的。

无论如何，我想要执行`runas /noprofile /netonly iexplore.exe`.

我已经完成了 P/Invoke 的一半`CreateProcessWithLogonW`。这就是我所拥有的：

```
uint LOGON_NETCREDENTIALS_ONLY = 2;
var lpStartupInfo = new CreateProcessWithLogonW_PInvoke.STARTUPINFO();
CreateProcessWithLogonW_PInvoke.PROCESS_INFORMATION processInformation;

CreateProcessWithLogonW_PInvoke.CreateProcessWithLogonW(
                userName,
                domain,
                pw,
                LOGON_NETCREDENTIALS_ONLY,
                null,
                commandLine,
                0,
                null,
                null,
                ref lpStartupInfo,
                out processInformation); 
```

这成功启动了 Internet Explorer，但似乎根本没有模拟用户。我可以通过 runas 命令模拟用户，所以我 98% 确定身份验证失败不是 IE/区域/密码/IIS 设置，这只是我在调用`CreateProcessWithLogonW()`.

我注意到的一件事是，该`runas /netonly`命令仅在我添加`/noprofile`开关时才有效，这让我很困惑。我不知道如何通过 C# 中的 P/Invoke 设置此开关的等效项。

任何一种解决方案都可以提供帮助（解决“我第一次启动 IE 时运行向导”的问题，或者找到我缺少的怪异 P/Invoke 设置）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T21:06:23.757

好的，我非常非常接近。神奇的修复是添加`-noframemerging`到 iexplore.exe 调用，它......老实说，我不确定它做了什么，它使用了“进程框架”这个短语，这很棒，也许对你来说意味着什么。

无论如何，这似乎得到了解决。

```
var arguments = "-noframemerging " + url;
var pathToIExploreExe = GetFullPathToIExploreExe();
var commandLine = string.Format("\"{0}\" {1}", pathToIExploreExe, arguments);

uint LOGON_NETCREDENTIALS_ONLY = 2;
var lpStartupInfo = new CreateProcessWithLogonW_PInvoke.STARTUPINFO();
CreateProcessWithLogonW_PInvoke.PROCESS_INFORMATION processInformation;

CreateProcessWithLogonW_PInvoke.CreateProcessWithLogonW(
            userName,
            domain,
            pw,
            LOGON_NETCREDENTIALS_ONLY,
            null,
            commandLine,
            0,
            null,
            null,
            ref lpStartupInfo,
            out processInformation); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:48:03.690

[CreateProcessWithLogonW](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682429%28v=vs.85%29.aspx)要求必须允许指定的用户帐户以交互方式登录。会不会是个问题？如果可行，请尝试[CreateProcessAsUser 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682429%28v=vs.85%29.aspx)。

# payment-gateway - iTransact，我在哪里可以找到用于创建 HTML 订阅表单的 api_username、xid 和 payload_signature 值？

> ID：12064532
> 
> 赞同：0
> 
> 时间：2012-08-21T23:35:32.533
> 
> 标签：payment-gateway, payment

在为 iTransact 创建 HTML 订阅表单时，在哪里可以找到以下必填表单字段的值：

a) api_username
b) xid

文档不清楚（[http://www.itransact.com/downloads/PCRecurGuide.pdf](http://www.itransact.com/downloads/PCRecurGuide.pdf)），当我登录 iTransact.com 时，我在帐户控制面板中找不到任何名为“api_username”或“xid”的信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T17:35:47.593

好的，我想通了：

a) api_username 与文档中其他地方称为“网关 ID 号”、“订单 UID”和“供应商 ID”的内容相同。

和

b) xid 表示“事务 id”

# c - WM_MOUSELEAVE 和父子窗口

> ID：12064534
> 
> 赞同：0
> 
> 时间：2012-08-21T23:35:41.673
> 
> 标签：c, winapi

在一个主窗口`hwndFrame`中，它有一个`hwndChild`有一个孩子的孩子`hwndDescendant`。这两个孩子没有非客户区。`hwndDescendant`占据了 的大部分区域`hwndChild`，所以`hwndChild`看起来只是 的一个“边界” `hwndDescendant`。这个“边界”的宽度只有 4 个像素。（但大小`hwndChild`比这大得多）。

我想跟踪`WM_MOUSELEAVE`“hwndChild”。如果我慢慢移动鼠标，这很好。`hwndFrame`但是，如果我从to快速移动鼠标，`hwndDescendant`反之亦然，`hwndChild`没有收到`WM_MOUSEMOVE`，因此也没有`WM_MOUSELEAVE`。

此外，当鼠标移动`hwndChild`到其中一个`hwndFrame`或`hwndDescendant`将生成 WM_MOUSELEAVE。但我希望当从移动`hwndChild`到`hwndDescendant`不生成`WM_MOUSELEAVE`.

我不想通过子类化的窗口过程来解决这个问题`hwndDescendant`，因为如果`hwndChild`有很多孩子，这不是一个好方法。

`SetCapture`方法不可取。在这种情况下，我可以处理这个问题的最佳方法是什么？

# c# - 如何关闭线程'Win32 Thread'（0x1bfc）已退出代码0（0x0）的日志？

> ID：12064535
> 
> 赞同：6
> 
> 时间：2012-08-21T23:35:57.733
> 
> 标签：c#, visual-studio-2010

这些信息日志在 Visual Studio 输出中非常烦人。在 java 中，我可以只为该类提高日志记录级别，但是如何在 C# 中将其关闭，因为正常的 Win32 线程正在终止。我的程序中有 log4net，所以我似乎可以配置所有其他日志。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-21T23:42:11.623

假设您正在谈论出现在 Visual Studio 的输出窗口中的消息...如果您右键单击该窗口，您将看到一个如下所示的菜单：

![在此处输入图像描述](../Images/03104d734fb8ecd7f55df87da7acbf03.png)

您可以关闭进程退出消息、线程退出消息以及您不想看到的任何其他内容。

# django - 在 django 中上传图像：出现“未定义全局名称上下文”错误

> ID：12064540
> 
> 赞同：3
> 
> 时间：2012-08-21T23:36:35.357
> 
> 标签：django, image

我正在尝试使用 django 并按照网站上的教程上传图像。在`views.py`我有：

```
def picture_upload(request):
    """
    form to upload an image together with a caption.
    saves it as a Picture in the database on POST.
    shows the last uploaded picture and let's you upload another.
    """
    picture = None
    if request.method != 'POST':
        form = PictureUploadForm()
    else:
        form = PictureUploadForm(request.POST, request.FILES)
        if form.is_valid():
            # an UploadedFile object
            uploadedImage = form.cleaned_data['image']
            caption = form.cleaned_data['caption']

            # limit to one database record and image file.
            picture, created = Picture.objects.get_or_create(picture_id=1)
            if not created and picture.get_image_filename():
                try:
                    os.remove( picture.get_image_filename() )
                except OSError:
                    pass

            # save the image to the filesystem and set picture.image
            picture.save_image_file(
                uploadedImage.filename, 
                uploadedImage.content
            )

            # set the other fields and save it to the database
            picture.caption = caption
            picture.save()

            # finally, create a new, empty form so the 
            # user can upload another picture.
            form = PictureUploadForm()

    return render_to_response(
        'example/picture_upload.html',
        Context(dict( form=form, last_picture=picture) ) ) 
```

错误说：

> 全局名称'上下文'未定义”在我的代码的最后一行。“views.py in picture_upload, line 111”。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T23:47:34.233

如果未定义，则未定义。您必须从 django.template 导入 Context。

在文件顶部，输入

```
from django.template import Context 
```

你不能神奇地希望所有变量都被定义......`PictureUploadForm`如果你没有导入它或以其他方式定义它，你认为你可以使用它吗？

# ios - “无法支持开发”xCode 4.4.1 到 iTouch 3rd Gen (4.2.1)

> ID：12064542
> 
> 赞同：0
> 
> 时间：2012-08-21T23:36:50.257
> 
> 标签：ios, xcode, ios-4.2, xcode4.4

我正在尝试使用旧的第 3 代 iTouch（运行 iOS 4.2.1）作为使用最新 xCode 的开发设备。

我为 Apple Dev Program 注册/付费，并在 iTouch 上获得了有效的配置文件。

但是，xCode Organizer 固执地声明“无法支持开发”。iOS 部署目标设置为 4.2。

arm6 和 arm7 都列在有效架构下。

我在网上爬行了一下，但大多数修复似乎只是让我重新启动/关闭/重新打开 xcode/itunes/my mbp 或这些的任何组合。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T18:43:36.663

折腾了几天，终于弄明白了。必须安装 4.0 设备调试支持包。

这给我带来了另一个错误（“找不到目录 xxx ... x002”）。在网络上徘徊，不得不进入 Library/Development/iOS/... 并将一些配置文件添加到“/Users//Library/Developer/Xcode/iOS DeviceSupport/4.2.1 (8C148)/Symbols/System/Library /缓存”。

这样做了，重新启动了 xCode，我的 iTouch 终于变成了绿色。

现在我只需要弄清楚如何让它出现在 Run>Scheme 下...得到有效的配置文件，部署目标设置为 4.2，Base SDK 是最新的 iOS ......是时候进行更多的网络爬行了。

*叹*

# java - Spring MVC Flash 属性

> ID：12064547
> 
> 赞同：1
> 
> 时间：2012-08-21T23:37:27.387
> 
> 标签：java, spring, spring-mvc

如何增强下面的控制器以利用 Spring MVC 的 Flash 属性？用例是一个复制功能。

POST/REQUEST/GET 实现：

1.  客户端单击 UI 中的“复制”按钮
2.  服务器设置响应“位置”标头
3.  客户端重定向到“路径/到/页面？复制”
4.  服务器提供 ModelAndView
5.  客户端（jQuery成功函数）设置window.location

FooController 重定向方法：

```
@RequestMapping(value = "{fooId}", method = POST, params = { "copy" })
@Transactional
@ResponseStatus(CREATED)
public void getCopyfoo(@PathVariable String fooId, 
HttpServletResponse response, RedirectAttributes redirectAttrs) {
    response.setHeader("Location", uriPath);
    //no worky?!:
    redirectAttrs.addFlashAttribute("barKey", "barValue");
} 
```

FooController 获取方法：

```
@RequestMapping(value = "{fooId}", method = GET)
@Transactional(readOnly = true)
public ModelAndView findFooById(@PathVariable String fooId, 
HttpServletRequest request){ 
    Map<String, ?> map = RequestContextUtils.getInputFlashMap(request);
    // map is empty...
    return modelAndViewFromHelperMethod();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:25:42.557

我很害怕`RedirectAttributes`它只适用于`RedirectView`，所以你的控制器应该返回例如：

```
1\. String: "redirect:/[uriPath]"
2\. new RedirectView([uriPath]) 
```

如果你真的需要用 JS 处理服务器响应，那么处理 HTTP 状态 302 可能会有所帮助。

# sql-server - SQL Server 大型日志文件

> ID：12064555
> 
> 赞同：2
> 
> 时间：2012-08-21T23:38:41.417
> 
> 标签：sql-server, sql-server-2008, sql-server-2012

我的数据库表日志文件很大。表本身是 60 mb，但日志文件是 2gb。有没有办法阻止这个日志文件像暂停它一样增加。我知道我在表格上写了很多，所以日志很大。此外，当我查看数据库的大小时，大小就像 2.9gb，因为它包括日志文件。

有没有办法我可以说停止写入日志文件以管理系统中的空间？我是否应该考虑停止日志写入？这是一个好主意吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T23:46:46.637

您不能完全停止日志写入，即使可以，也不应该这样做。您可以做的是确定您是否希望能够恢复到某个时间点。如果这对您很重要，那么您应该保持完全恢复模式并开始运行定期事务日志备份。

如果时间点恢复对您来说不重要，那么您可以切换到简单恢复模式：

```
ALTER DATABASE dbname SET RECOVERY SIMPLE; 
```

一旦您（a）执行了完整备份和至少一个日志备份或（b）切换到简单恢复模式，您应该能够将日志文件缩小到合理的程度（关于什么没有真正好的答案在没有更多信息的情况下是“合理的”）：

```
USE dbname;
GO
DBCC SHRINKFILE(dbname_log, 100); -- 100 MB 
```

[这个关于数据库管理员的问题](https://dba.stackexchange.com/questions/29829/why-does-the-transaction-log-keep-growing-or-run-out-of-space)也很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T23:46:38.290

事务日志是 SQL Server 的基本组成部分——没有它就无法工作。

如果这是一台开发机器（不是生产机器！），您可以将恢复模式设置为简单：ALTER DATABASE MyDB SET RECOVERY SIMPLE；

或者，查看使用[DBCC SHRINKFILE](http://support.microsoft.com/kb/907511)定期收缩文件。

# sql - 如何在sql中的选择查询期间覆盖值？

> ID：12064556
> 
> 赞同：1
> 
> 时间：2012-08-21T23:38:41.000
> 
> 标签：sql, select

假设我有一个带有模式（名称，年龄）的表 foo。所以表格看起来像：

```
NAME | AGE
John | 20
Jane | 50
Jason | 30 
```

现在假设我想从此表中进行选择，但我想通过选择查询将他们的所有年龄更改为 20 岁。也就是说，我不想更新原始表 foo，但我想选择，例如：

```
SELECT name, 20 as age from foo 
```

换句话说，我想操作 select 上的数据。当然，我在现实生活中的例子比这要复杂得多，但知道答案就可以了。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T23:43:31.377

你基本上只是做你提出的问题：

```
SELECT name, newValue as age
from yourTable 
```

这将为`name`您提供表中的值，然后为您为另一列指定的值。

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/6c1ea/1)

# html - 页面中有多个表单标签还是一个表单标签？

> ID：12064557
> 
> 赞同：24
> 
> 时间：2012-08-21T23:38:47.260
> 
> 标签：html, xhtml

我刚刚开始使用 HTML5，并且想知道我们是否应该**在**`<form>`每个网页上使用一个标签或多个表单标签。

也许这取决于情况，但这里有两种不同的情况：

1.  一份注册表单
2.  具有多个子表单的主页：登录、加入邮件列表等。

在另一个里面有一个表单标签是不好的还是按照标准可以？

谢谢

**编辑** 您能否以简单的方式解释表单标签的目的是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-21T23:43:51.140

我觉得你已经回答了你的问题。

1.  一份注册表单 = 一份表格标签。
2.  多个表单 = 许多表单标签。

只是不要嵌套它们。

**编辑**

[表单标签](https://developer.mozilla.org/en-US/docs/HTML/Element/form)用于保存各种字段（即输入标签），您最终将使用 GET 或 POST 请求将这些字段传递给目标 URL。

以这个登录表单为例：

```
<form action="login.php">
  <input id="name" type="text" name="name">
  <input id="passwd" type="password" name="passwd">
  <input type="submit" value="Login">
</form> 
```

这有一个登录名、一个密码和一个提交按钮。当按下“登录”按钮（type = “submit”）时，表单将获取该信息并将其发送到另一个 URL（在本例中为“login.php”，该 URL 将相应地处理信息（例如验证，登录，显示验证码）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-21T23:50:32.080

没有理由在一个页面上不能有多个表单。您只是不能嵌套表单，因为这样表单就无法识别哪些字段用于什么。

从概念上讲，如果您需要让两个表单的信息占据您网站上的同一部分或区域（例如，如果您将注册和电子邮件列表表单或其他内容结合起来），您将使用一个表单并整理来自另一端 POST 变量的信息。只要您以有意义的方式命名事物，您甚至不应该希望嵌套表单来完成此操作。

**编辑：**

为了进一步回答您的问题，在其最基本的用例中，表单标签用于将数据提交到 URL。您选择提交表单的 URL 通常会接收该数据并在对该数据采取操作之前以某种方式对其进行处理，例如将数据存储在数据库中，或根据给定的用户名和密码创建新用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-21T23:43:40.300

将表单放入表单中没有意义，您现在如何区分每个表单中的字段？它们是主窗体的一部分吗？子形式？两个都？

最佳做法是为您需要从中读取输入的每个区域单独填写表格。如果您有登录区域，请为其创建一个表单。如果您在该页面上也有评论区，则应使用单独的表单来处理该事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-24T11:08:56.037

是的，我们可以在一个 HTML 页面中使用多个标签。有时我们需要从一个 HTML 页面提交两个不同的数据。为此，我们需要使用多个标签。我们使用标签将数据发送到特定的 servlet 或 JSP（在 JAVA 的情况下）。我们通过 . 标签内有一个名为 action="#" 的属性。我们定义了特定的 servlet 名称，其中的数据必须放在其中。因此，我们将数据从客户端 (HTML) 提供给 servlet（服务器）。然后 servlet 操作提供的数据，就像将数据插入数据库一样。下面的代码可以帮助理解。这里两个标签用于两个不同的任务，它们也将由两个不同的 servlet 处理。

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Registration | Badhon</title>
<link rel="stylesheet" type="text/css" href="registration.css">
</head>

<body background="images/registration.jpg">

	<div class="title">
		<h1>Registration</h1>
	</div>

	<div class="container">

		<div class="left">
       <div><h1>Choose an image (300*300)</h1></div>

   /* First Form tag ---------------------*/
      <form name="fileform" method="post" action="uploadImage" enctype="multipart/form-data">

				<br> <label for="photo"> Portrait Photo: </label> <input
					type="file" name="photo" size="50" placeholder="Upload Your Image"
					required /><br>
				<br> <input type="submit" value="Save">
			</form>

 /* End of First Form Tag---------------------*/

   </div>

		<div class="right">
			<div class="formbox">

  /* Second Form tag------------------ */      
        <form action="DonarRegister">
					<p>Name</p>
					<input type="text" name="name" placeholder="Name">

					<p>Username</p>
					<input type="text" name="username" placeholder="User_name">

					<p>Password</p>
					<input type="Password" name="password" placeholder="..........">

					<p>Blood Group</p>
					<input type="text" name="bloodgroup" placeholder="O positive">

					<p>Age</p>
					<input type="number" name="age">

					<p>Mobile Number</p>
					<input type="text" name="mobilenumber" placeholder="......">

					<p>email</p>
					<input type="text" name="email" placeholder="......">

					<p>Address</p>
					<input type="text" name="address" placeholder="Village/Thana/District"> 
					<input type="submit" name="" value="Register">

				   <p> <h5>Have already an account !! Then <a href="login.jsp">just login</a></h5></p>

</form>
/* End of Second form tag ----------------- */ 

			</div>
		</div>
	</div>
</body>
</html>
```

数据库等等。

# javascript - FB 连接点击事件

> ID：12064558
> 
> 赞同：0
> 
> 时间：2012-08-21T23:38:52.277
> 
> 标签：javascript, facebook, asp.net-mvc-3

我需要确保我的 Facebook Connect 代码在点击事件上运行，但无论我如何尝试，我都无法让它工作。它必须很简单，但我就是想不通。这是我最近的尝试，但是如果我在 FB.Event.subscribe 之后将警报放入代码中，它永远不会到达它。该代码确实从 document.ready 中运行，但我需要它在单击事件上运行。实时 URL 是 lovelyjubbly.info/en-GB/Gameplan。

```
 <div class="facebookconnect">
            <div id="fb-root"></div>

            <script language="javascript" type="text/javascript" src="http://connect.facebook.net/@Thread.CurrentThread.CurrentUICulture.Name.Replace('-', '_')/all.js"></script>

            <script type="text/javascript">

                $(document).ready(function () {

                    window.FB.init({ appId: 'abc', status: true, cookie: true, xfbml: true });

                });

                function fbclick()
                {
                    FB.Event.subscribe('auth.login', function (response) {
                        alert("loggedin");
                        var isUserAuthenticated = @User.Identity.IsAuthenticated.ToString().ToLower();

                        if ((response.status == 'connected') && (isUserAuthenticated == false)){
                            window.location.href = '@Account.Urls.FacebookConnect()';
                        }
                    });
                }

            </script>

            <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/" + @Thread.CurrentThread.CurrentUICulture.Name.Replace('-', '_') + "/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

           <fb:login-button onclick="fbclick()" autologoutlink="false" perms="email" id="fbLogin">

           </fb:login-button>

        </div><br /> 
```

编辑：使用 live() 方法，似乎仍然不起作用：

```
 <div class="facebookconnect">
            <div id="fb-root"></div>

            <script language="javascript" type="text/javascript" src="http://connect.facebook.net/@Thread.CurrentThread.CurrentUICulture.Name.Replace('-', '_')/all.js"></script>

            <script type="text/javascript">

                $(document).ready(function () {

                    window.FB.init({ appId: 'abc', status: true, cookie: true, xfbml: true });

                });

                $("#fbLogin").live("click", function(){ 
                    FB.Event.subscribe('auth.login', function (response) {
                        alert("loggedin");
                        var isUserAuthenticated = @User.Identity.IsAuthenticated.ToString().ToLower();

                        if ((response.status == 'connected') && (isUserAuthenticated == false)){
                            window.location.href = '@Account.Urls.FacebookConnect()';
                        }
                    });
                }); 

            </script>

            <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/" + @Thread.CurrentThread.CurrentUICulture.Name.Replace('-', '_') + "/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

           <fb:login-button autologoutlink="false" perms="email" id="fbLogin">

           </fb:login-button>

        </div><br /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:43:33.983

利用

```
$(yourselector).live('click', function() {
   //fb stuff
}); 
```

我不太记得为什么会这样，但似乎确实如此。

# c# - Bitmap.LockBits 使用导致 AccessViolation？

> ID：12064560
> 
> 赞同：0
> 
> 时间：2012-08-21T23:39:43.070
> 
> 标签：c#, gdi+, system.drawing

我有一些代码可以将 a 复制`Bitmap`到 Direct3D`Texture`中以呈现视频。当系统负载过重时，我偶尔会`AccessViolationException`接到`Bitmap.LockBits`.

这是一个非常简单的例子：

```
// Get a PixelFormat.Format24bppRgb image
Bitmap bitmap24 = getVideoFrame();

// Copy into a 32bpp ARGB texture
BitmapData bitmapData = null;
try
{
    // Why am I allowed to do this?
    bitmapData = this.bitmap24.LockBits(new Rectangle(0, 0, bitmap.Width, bitmap.Height),
                                        ImageLockMode.ReadOnly, 
                                        PixelFormat.Format32bppArgb);

    // Blit from bitmapData to texture32
    Texture texture32 = convertBitmapToTexture(bitmapData);
}
finally
{
    if (bitmapData != null)
        this.bitmap.UnlockBits(bitmapData);
} 
```

为什么我知道位图格式是可以调用`Bitmap.LockBits`和传入？我假设它必须自动从每像素 3 个字节扩展到 4 个。`PixelFormat.Format32bppArgb``PixelFormat.Format24bppRgb``LockBits`

`LockBits`扩展会导致这些异常吗？为什么它只是偶尔发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T23:57:03.353

LockBits 将以您指定的任何格式将位图存储在内存中。

`AccessViolationException`当您访问您不应该访问的内存时发生。我可以想到两种情况会发生这种情况：

1）您正在使用`ImageLockMode.ReadOnly`.. 是否有任何实际尝试更改像素值的地方？也许尝试将其更改为`ImageLockMode.ReadWrite`，看看是否有帮助。

2）您对缓冲区必须有多大感到困惑，并且您的函数中有一个`Marshal.Copy`试图`convertBitmapToTexture`复制超出缓冲区末尾的函数。

当您使用 32bppArgb 时，用`int`'s 而不是s来思考可能更容易。`byte`这样你就不太可能遇到任何混乱。

# c++ - 匹配非ASCII字符的switch语句

> ID：12064561
> 
> 赞同：7
> 
> 时间：2012-08-21T23:40:20.410
> 
> 标签：c++, character-encoding

我在源代码中添加了重音字符，并尝试将它们替换为等效的 unicode。如果我使用实际的非 ascii 字符，程序可以编译并正常工作，但我担心这可能会影响可移植性。当我尝试使用 unicode 等效项时，我收到*警告：大小写标签值超出类型的最大值*或*警告：字符常量对于其类型而言太长，*并且在我运行程序时大小写永远不会匹配。

```
for(int i = 0; i < ent->d_namlen; i++)
{
    switch(ent->d_name[i])
    {
        case 'á' : //0x00E1
        ...
    }
 } 
```

ent 是`struct dirent *ent`从调用函数传递的。

代替`case 'á' :`我已经尝试过`case '0x00E1' :`, `case L 'u00E1 :`，`case \U000000E9 :`并且`case '\u00E1' :`我已经尝试了所有没有单引号的情况，在这种情况下它不会编译（例如说 \u00E1 没有在这个范围内声明）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T14:25:43.143

`á`是一个非 ASCII 字符，在您的源代码、`struct dirent`或两者中都表示为多个字节。

如果您打开，`-Wmultichar`您可能会收到警告

```
warning: multi-character character constant 
```

表示字符常量`'á'`由一个以上的字节组成，在这种情况下它可能是 UTF-8，但请检查（例如使用`file`）。您还需要找出`dirent`条目的编码。

为了匹配字符串中的非 ASCII 字符，您需要：

*   确保字符串和字符以相同的编码表示，并且要么
    *   使用固定长度编码（即 UCS-4）和足够宽的类型以存储每个代码点（例如`int`），或
    *   使用可重新启动的可变长度编码（即 UTF-8）并使用子字符串匹配。

查看[http://en.cppreference.com/w/cpp/locale/codecvt_utf8](http://en.cppreference.com/w/cpp/locale/codecvt_utf8)了解如何进行转换的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T12:09:08.740

我认为将 switch 表达式转换为无符号类型就可以了。

```
switch((unsigned char)ent->d_name[i])
{
...
} 
```

# python - pyglet中的标签不批量绘制

> ID：12064564
> 
> 赞同：0
> 
> 时间：2012-08-21T23:41:17.867
> 
> 标签：python, python-2.7, pyglet

我正在尝试在 pyglet 中使用批处理来绘制标签。目前，这批用于绘制我创建的每个实体，并且一切都绘制得很好。我可以向其中添加数百个 Sprite，它们都会被绘制出来，但我创建和添加的任何标签都不会。我正在使用源存储库中最新版本的 pyglet，这是我正在使用的代码：

```
def _text(self, command):
    uid, x, y, chars, font, size, level = command[1:]
    print 'Text - uid=%s, x=%s, y=%s chars=%s, font=%s, size=%s, level=%s' % (uid, x, y, chars, font, size, level)
    self._ents[uid] = (pyglet.text.Label(chars,
        color=(0, 0, 0, 0),
        font_name=font,
        font_size=size,
        batch=self._batch,
        group=self._get_level_group(level)), level)
    print self._ents[uid][0].batch 
```

对于我创建的每个标签，打印的批次具有相同的内存地址，并且与我创建的任何 Sprite 的内存地址相同。我试图深入研究源代码并尝试找出问题所在，但在我打印出批次的每一点，内存地址都是相同的。奇怪的是，当我将打印语句放在标签将自己绘制的位置时，如果它拥有自己的批次，或者如果给它一个批次，它只会在它拥有它的分支下打印东西自己的批次。如果我当时打印出批次的内存地址，则它与其他时间不同。不知何故，它似​​乎看到它应该拥有自己的批次，并且正在创建一个新批次，而不是我提供的批次。

编辑：我觉得很愚蠢。这段代码可以正常工作...一旦我在标签创建代码中添加 x=x, y=y 。它默认在屏幕的左下角，我试图绘制的字符是下划线，所以我看不到它们。一旦 SO 允许我添加这个问题的答案，或者其他人可以为 x/y 事物提供答案，我会接受它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:40:33.573

我觉得很笨。这段代码可以正常工作...一旦我在标签创建代码中添加 x=x, y=y 。它默认在屏幕的左下角，我试图绘制的字符是下划线，所以我看不到它们。我解决了这个问题，现在一切都很好。

# iphone - iPhone - 带有两个音频通道的 MOV 视频

> ID：12064565
> 
> 赞同：0
> 
> 时间：2012-08-21T23:41:36.810
> 
> 标签：iphone, ios, ipad

我有一个视频，我想在具有本地化版本的应用程序上使用。视频是一样的，但音频发生了变化。我真正想做的是创建一个带有两个音频通道的 MOV，然后根据用户语言设置选择我想要播放的音频通道语言。是否可以在 iPhone/iPad 上做到这一点？

好的，我知道我可以添加两个视频，但是视频很大，我不想让应用程序膨胀。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:00:24.537

如果您使用的是[AVFoundation](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/00_Introduction.html)，您可以获得[`AVPlayerItem`](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayerItem_Class/Reference/Reference.html)电影的。然后您可以访问`tracks`这是一个[`AVPlayerItemTrack`](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVPlayerItemTrack_Class/Reference/Reference.html)s 数组。这些具有`enabled`您可以设置的属性。

现在要确定要设置的项目，您需要查看`AVPlayerItemTrack`' 的`assetTrack`属性是[`AVAssetTrack`](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAssetTrack_Class/Reference/Reference.html). 这可能会为您保存信息，以确定它是否是您要启用的轨道。

# windows-services - Log4net 在 Windows 服务中不起作用

> ID：12064566
> 
> 赞同：1
> 
> 时间：2012-08-21T23:41:36.857
> 
> 标签：windows-services, log4net

我正在尝试为我的 Windows 服务创建一个简单的文件记录器，但没有写入该文件。这是我的 app.config 文件：

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>
  <connectionStrings>
    <add name="MyAppConnectionString" connectionString="Data Source=.;Initial Catalog=MyApp;Integrated Security=True;MultipleActiveResultSets=True" />
    <add name="MyAppEntities" connectionString="metadata=res://*/MyAppModel.csdl|res://*/MyAppModel.ssdl|res://*/MyAppModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=.;Initial Catalog=MyApp;Integrated Security=True;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
  <startup>
<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
  <system.web>
    <roleManager enabled="true" defaultProvider="MyAppSqlRoleProvider">
      <providers>
        <add name="MyAppSqlRoleProvider"
             type="System.Web.Security.SqlRoleProvider"
             applicationName="MyApp"
             connectionStringName="MyAppConnectionString"/>
      </providers>
    </roleManager>
  </system.web>
  <log4net>
    <appender name="FileAppender" type="log4net.Appender.FileAppender">
      <file value="C:/logfiles/MyAppAlarms.txt" />
      <appendToFile value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %message%newline" />
      </layout>
    </appender>
    <root>
      <level value="ALL" />
      <appender-ref ref="FileAppender" />
    </root>
  </log4net>
</configuration> 
```

我知道还有其他类似的帖子，但我已经阅读了它们并尝试了其中的所有内容，但我无法到达任何地方。我尝试将上面相同的标签放在控制台应用程序中并且有效。我尝试将我的 app.config 复制并粘贴到 C:\ 驱动器并在我的 AssemblyInfo.cs 中使用它来引用它：

[程序集：log4net.Config.XmlConfigurator(Watch = true, ConfigFile = @"C:\app.config")]

但这没有用。我能够使用调试器附加到服务，但我不确定如何在这里利用它来发挥我的优势。没有什么是抛出异常。我尝试使用 StreamWriter 写入同一个文件并且有效，所以我知道这不是写权限问题。

我不知道下一步该尝试什么。有没有办法获得一些调试信息，以便找出问题所在？我尝试启用内部调试并运行 DebugView，但除了低级网络消息外，我什么也没看到。我也尝试设置 log4net debug=true，但我认为这会写入控制台，这对服务没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-01T09:56:59.997

我也面临同样的问题，当我的服务运行配置记录器时，我使用了下面的语句。

**XmlConfigurator.Configure();**

它奏效了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T13:39:06.220

如果您正在调试服务，请确保在 DbgView 中启用了**Capture Global Win32 。**当您设置 log4net debug=true 时，您应该会在控制台和 dbgview 中看到**消息**。

如果您在调用 ServiceBase.Run(..) 命令之前在程序开始时调用**log.Debug**，那么您应该能够直接从命令提示符运行您的 exe，它应该初始化日志记录，因此初始化任何内部在显示无法从命令行启动服务的错误消息之前记录消息。这可能会说明它是什么问题。（当然你必须知道，这样做你可能会在不同的凭据下运行程序。）

此外，如果您想从命令行在非服务程序中运行整个程序，通常可以通过更改几行来实现。

您的服务可能会开始使用类似的东西

```
static void Main()
{
     log.Debug("Start Up");
     ServiceBase.Run(new MainService());         
} 
```

你可以把它改成类似

```
static void Main()
{
     log.Debug("Start Up");
     MainService ms = new MainService();
     ms.OnStart(null);
} 
```

或者如果您希望能够在不重新编译的情况下进行切换，那么类似

```
 // The main entry point for the process
    static void Main(string[] args)
    {
       log.Debug("Start Up");

        string cmdLine = args.Length == 0 ? "" : args[0].ToLower().Substring(1);

        // If we are debugging or if we have been passed the /NonService 
        // commandline, then start the program in non-service mode.

        if (System.Diagnostics.Debugger.IsAttached 
             || string.Equals(cmdLine, "NonService" , System.StringComparison.CurrentCultureIgnoreCase))
        {
            MainService ms = new MainService();
            ms.OnStart(null);
        }
        else
        {
            ServiceBase.Run(new MainService());
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T02:03:53.120

写入日志的服务需要具有管理员权限才能访问事件查看器中的安全日志。您可以通过使用具有管理员访问权限的帐户启动服务来测试这一点。不要在您的生产环境中使用具有管理员访问权限的帐户，而只是作为临时测试。

要修复它，请创建自定义事件日志。它将绕过访问安全日志的需要。

```
<appender name="EventLogAppender" type="log4net.Appender.EventLogAppender" >
      <logName value="System" />
      <applicationName value="AppName" />
      ...
</appender> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T20:25:39.243

检查 app.config 文件的名称是否正确。如果您的服务可执行文件是 MyService.exe，则配置文件应命名为 MyService.exe.config。

我已经被这个咬过好几次了，现在这是我检查的第一件事。

另请参阅：[App.Config 与 AppName.exe.Config](https://stackoverflow.com/questions/2916023/app-config-vs-appname-exe-config)

# grails - 域名更改的 Grails 重定向问题

> ID：12064567
> 
> 赞同：0
> 
> 时间：2012-08-21T23:41:37.913
> 
> 标签：grails, redirect

我有一个 Grails 应用程序正在运行，比方说：`www.mysite.com`

在`Config.groovy`我有我的`grails.serverURL`设置`www.mysite.com`

我使用该`redirect`方法重定向到某个方法，但它总是使用该`grails.serverURL`值构建 url，而不是从用户的实际 URL 构建。当有人访问该站点时，我遇到了一个问题`mysite.com`，而忽略了`www`. 然后，当他们单击导致重定向的链接时，他们会被转发到`www.mysite.com`这使他们失去会话。我应该做些什么不同的事情？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T10:23:45.763

您使用什么网络服务器来托管该网站？

一般来说，根据经验，我总是配置 Apache 以确保任何非 www。呼叫被重定向到 www。相等的。

Apache config 或 .htaccess 中的两行就足够了，例如

```
RewriteCond %{HTTP_HOST} ^exampledomain\.co\.uk$ [NC]
RewriteRule ^(.*)$ http://www.exampledomain.co.uk$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T23:54:39.693

根据您使用的 Grails 版本，通常，从配置中完全删除 grails.serverURL 将解决该问题。

# apache-pig - 在 pig 中使用 avro 加载和存储多个文件时的运行时异常

> ID：12064568
> 
> 赞同：2
> 
> 时间：2012-08-21T23:41:57.847
> 
> 标签：apache-pig, avro

当我尝试加载多个文本格式的文件并使用 pig 将它们转换为 avro 格式时，我遇到了这个奇怪的问题。但是，如果我在分开的运行中一次读取和转换一个文件，一切都很好。错误消息如下

2012-08-21 19:15:32,964 [main] 错误 org.apache.pig.tools.grunt.GruntParser - 错误 2997：无法从支持的错误重新创建异常：org.apache.avro.file.DataFileWriter$AppendWriteException：java .lang.RuntimeException: Datum 1980-01-01 00:00:00.000 不在 org.apache.avro.file.DataFileWriter.append(DataFileWriter.java:263) 的联合 ["null","long"] 中.apache.pig.piggybank.storage.avro.PigAvroRecordWriter.write(PigAvroRecordWriter.java:49) 在 org.apache.pig.piggybank.storage.avro.AvroStorage.putNext(AvroStorage.java:612) 在 org.apache.pig .backend.hadoop.executionengine.mapReduceLayer.PigOutputFormat$PigRecordWriter.write(PigOutputFormat.java:139) 在 org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigOutputFormat$PigRecordWriter。write(PigOutputFormat.java:98) at org.apache.hadoop.mapred.MapTask$NewDirectOutputCollector.write(MapTask.java:531) at org.apache.hadoop.mapreduce.TaskInputOutputContext.write(TaskInputOutputContext.java:80) at org .apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapOnly$Map.collect(PigMapOnly.java:48) 在 org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBbackend.hadoop.executionengine.mapReduceLayer.PigGenericMapBbackend.hadoop.executionengine.mapReduceLayer.PigGenericMapB

我的代码是

```
set1 = load '$input_dir/set1.txt' using PigStorage('|') as (
   id:long,
   f1:long,
   f2:chararray,
   f3:float,
   f4:float,
   f5:float,
   f6:float,
   f7:float,
   f8:float,
   f9:float,
   f10:float,
   f11:float,
   f12:float);
store set1 into '$output_dir/set1.avro'
using org.apache.pig.piggybank.storage.avro.AvroStorage();

set2 = load '$input_dir/set2.txt' using PigStorage('|') as (
   id : int,
   date : chararray);
store set2 into '$output_dir/set2.avro'
using org.apache.pig.piggybank.storage.avro.AvroStorage(); 
```

第一个文件转换得很好，但第二个文件失败了。错误来自第二个文件中的第二个字段，但奇怪的是我的架构中甚至没有“long”，而错误消息显示 ["null","long"]。

我使用猪 0.10.0 和 avro-1.7.1.jar。

我想知道这是一个错误还是我错过了什么。

谢谢。担

这是set1.txt

```
827352|740214|Long|26|0.08731795012183759|1661335.541733333|0|0|0.001057865808239878|0.001059541098077884|0.001059541098077821|0.0514156486228232|0.001043980181757539
827353|740214|Short|12|-0.05967910581502997|-1135471.22271|0|0|-0.001185620143839061|-0.001187497751909232|-0.001187497751909183|-0.0747641932858414|-0.0001307449002148424
827354|740214|Total|38|0.02763884430680765|19026277.40819863|0|0|-0.0001277543355991829|-0.0001279566538313473|-0.0001279566538313626|-0.02334854466301821|0.0009132352815426966
827193|739576|Long|26|0.08731795012183759|1661335.541733333|0|0|0.001057865808239878|0.001059541098077884|0.001059541098077821|0.0514156486228232|0.001043980181757539
827194|739576|Short|12|-0.05967910581502997|-1135471.22271|0|0|-0.001185620143839061|-0.001187497751909232|-0.001187497751909183|-0.0747641932858414|-0.0001307449002148424
827195|739576|Total|38|0.02763884430680765|19026277.40819863|0|0|-0.0001277543355991829|-0.0001279566538313473|-0.0001279566538313626|-0.02334854466301821|0.0009132352815426966
827355|740215|Long|51|1.776868012839072|113652088.7063555|0|0|0.01952547658695701|0.0195703176808393|0.01957031768083928|1.164818333642054|0
827356|740215|Short|34|-2.360589090333165|-150988074.9471841|0|0|-0.00868330219442376|-0.008616238065508337|-0.008616238065508375|-0.5943698959308671|-0.02690679230502523
827357|740215|Total|85|-0.5837210774940929|63962032.00527128|0|0|0.01084217439253325|0.01095407961533095|0.0109540796153309|0.5704484377111866|-0.02690679230502523
827202|739590|Long|53|1.777568428360522|113696888.7063555|0|0|0.01952547658695701|0.0195703176808393|0.01957031768083928|1.156653489849146|0 
```

这是 set2.txt

```
1|1980-01-01 00:00:00.000
2|1980-01-02 00:00:00.000
3|1980-01-03 00:00:00.000
4|1980-01-04 00:00:00.000
5|1980-01-07 00:00:00.000
6|1980-01-08 00:00:00.000
7|1980-01-09 00:00:00.000
8|1980-01-10 00:00:00.000
9|1980-01-11 00:00:00.000
10|1980-01-14 00:00:00.000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T08:45:10.097

看来猪需要先加载，请尝试

```
set1 = load '$input_dir/set1.txt' using PigStorage('|');
set1 = load '$input_dir/set1.txt' using PigStorage('|');

--other logic 
```

# python - 在python中浏览文本文件

> ID：12064569
> 
> 赞同：0
> 
> 时间：2012-08-21T23:42:09.267
> 
> 标签：python, text, line

我有一个包含以下内容的文本文件：

```
NUM,123
FRUIT
DRINK
FOOD,BACON
CAR
NUM,456
FRUIT
DRINK
FOOD,BURGER
CAR
NUM,789
FRUIT
DRINK
FOOD,SAUSAGE
CAR 
```

我正在尝试改变`BURGER`，但如何做到这一点？

```
file = open('input.txt', 'r')
while True:
    line = file.readline()
    if '456' in line:
        print line
        break 
```

使用上面的代码，我想使用 之后的不同数字来精确定位它`NUM`，但我只能读取`456`出现的行。如何阅读下面的 3 行`456`然后访问该`BURGER`部分？

谢谢！

使用 Levon 的解决方案进行更新：

```
with open('input.txt','r') as f:
    data = f.readlines()
    for i, line in enumerate(data):
        if '456' in line:
            field = ','.join(data[i+3].split(',')[1])
            field = field.replace(field,'PIZZA') 
```

现在如何将所有内容写回新文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:45:24.017

**根据以下评论**更新：****

 **如果所有文件都可以放入内存（一次读取*所有*文件），请使用此代码：

```
with open("data.txt") as f:
    data = f.readlines()
    for i, line in enumerate(data):
        if "456" in line:
            print data[i+3].split(',')[1], 
```

我们将整个文件读入一个列表 ( `data`)，然后使用[enumerate()](http://docs.python.org/library/functions.html#enumerate)访问索引 ( `i`) 和给定索引处的元素（即`line`）。由于我们拥有列表中的所有数据，一旦我们找到带有“456”的行，我们可以`i + 3`很容易地在列表中查找行并使用[split()](http://docs.python.org/library/stdtypes.html?highlight=split#str.split)分离出我们感兴趣的单词。

--

如果文件可能非常大（*逐行*处理文件），请使用此代码：

```
with open("data.txt") as f:
    count = -1
    for line in f:
        if "456" in line:
            count = 4

        count -= 1
        if count == 0:
            print line.split(',')[1], 
```

将打印“汉堡”

这将查找字符串“456”后 3 行的第二个单词。它假定单词用逗号 ( `,`)分隔

请注意，使用该`with`构造还可以在我们完成时（或者如果我们遇到异常）关闭文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:23:02.967

您的文本文件具有结构。我认为您确实在寻求一种读取该结构的方法，例如，以便某人能够将他们的订单更改为比萨饼。

您的 input.txt 有一些命令。每个订单都以订单号（NUM,456 等）开头，然后是一些项目，然后`CAR`好像表明开车经过的人已经完成了他们的订单。

所以，第 1 步。

```
# changes order 456's food to a pizza, from whatever it was
file = open('input.txt', 'r')

bad_order = 'NUM,%d' % 456
new_food = 'FOOD,%s' % 'Pizza'

change = False
for line in file:
  line = line.strip()
  msg = ''
  if line.startswith('NUM,'):
    msg = 'Ignoring order: '
  if line == bad_order:
    msg = 'Changing order: '
    change = True
  if change and line.startswith('FOOD,'):
    line = new_food
  if line == 'CAR':
    change = False
  print '%s%s' % (msg, line) 

```

进一步的步骤可能是更正式地识别结构（例如，将订单添加到集合中以供稍后处理）；或将其重构为一个函数，以便您可以测试更改不同的订单号和不同的食物类型，而不仅仅是`FOOD`.

*编辑*

我已经编辑了代码，以明确它当前如何读取您的文件。现在的输出是：

```
忽略顺序：NUM,123
水果
喝
食物，培根
车
更改顺序：NUM,456
水果
喝
食品、比萨
车
忽略顺序：NUM,789
水果
喝
食品、香肠
车

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:44:31.547

尝试：

```
file = open('input.txt', 'r')
for line in file.readlines():
    if '456' in line:
        stored_line = line
    if 'BURGER' in line:
        print stored_line 
```

这将为您提供文件中的正确行，您将可以访问它前面的数字。要就地编辑文件，请寻找这样的解决[方案](https://stackoverflow.com/questions/1325905/inserting-line-at-specified-position-of-a-text-file-in-python/1325927#1325927)。

如果您只是对文本流感兴趣。您可以`line.replace('BURGER', 'FOO')`在打印后添加。**

# ruby-on-rails - 如何获取 json POST 并按用户名搜索 user_id？

> ID：12064572
> 
> 赞同：1
> 
> 时间：2012-08-21T23:42:19.647
> 
> 标签：ruby-on-rails, ruby, json

当我传递 JSON Parameters:`{"friend"=>{"username"=>"example"}, "auth_token"=>"n2A1Sk85MZSupXEiE1nG"}`时，我收到以下错误：

```
ActiveModel::MassAssignmentSecurity::Error (Can't mass-assign protected attributes: username) 
```

* * *

```
FriendsController
def create
    @user = User.find(current_user)
    @friend = Friend.new(params[:friend])
    @friend.user_id = current_user.id
    @friend.friend_id = User.find(user.username)
    respond_to do |format|
        if @friend.save
            #flash[:notice] = 'Game was successfully created.'
            #format.html { redirect_to(@game) }
            format.json  { render :json => @friend }
        else
            #format.html { render :action => "new" }
            format.json  { render :json => @friend.errors, :status => :unprocessable_entity }
        end
    end
end 
```

* * *

```
Friend Model
class Friend < ActiveRecord::Base
   attr_accessible :friend_id, :user_id
     belongs_to :user
     validates_presence_of :friend_id
     validates_presence_of :user_id
end 
```

* * *

```
User Model
  class User < ActiveRecord::Base
 # Include default devise modules. Others available are:
 # :token_authenticatable, :confirmable,
 # :lockable, :timeoutable and :omniauthable
 devise :database_authenticatable, :registerable,
        :recoverable, :rememberable, :trackable, :validatable, :token_authenticatable

 before_save :ensure_authentication_token

 # Setup accessible (or protected) attributes for your model
 attr_accessible :email, :password, :password_confirmation, :remember_me, :username, :friends_attributes, :friends
 # attr_accessible :title, :body

 has_many :games#, :dependent => :destroy
 has_many :friends, :dependent => :destroy

 validates_presence_of :username
 validates_uniqueness_of :username
end 
```

* * *

如何接受来自 JSON 的用户名，然后找到相应的用户名`user_id`？我试图通过搜索用户名来允许用户与另一个用户成为朋友。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:50:34.250

您需要添加`username`到`Friend`模型上可访问的属性列表中。所以改变：

```
attr_accessible :friend_id, :user_id 
```

到

```
attr_accessible :friend_id, :user_id, :username 
```

我相信应该这样做。

# asp.net-mvc - 按内容类型 BlogPost 和某些 BlogId 过滤的果园查询

> ID：12064573
> 
> 赞同：4
> 
> 时间：2012-08-21T23:42:20.383
> 
> 标签：asp.net-mvc, orchardcms

我有一个带有两个博客的 Orchard 安装，其中一个用于公司新闻，另一个用于成员出版物。

我想创建一个小部件来显示来自公司新闻博客的帖子子集。

是否可以在 Orchard 中创建一个按 ContentType BlogPost 和 BlogId 过滤的查询？我找到了按内容类型的过滤器，但没有找到按 BlogId 的过滤器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:58:09.933

这将是一个在模块中添加的非常简单的过滤器。这是一个按 id 过滤的硬编码示例...

```
public class ContentIdFilter : IFilterProvider {
    private const int HardCodedId = 99;

    public ContentIdFilter() {            
        T = NullLocalizer.Instance;
    }

    public Localizer T { get; set; }

    public void Describe(DescribeFilterContext describe) {
        describe.For("Content", T("Content"), T("Content"))
            .Element("ContentId", T("Content Id"), T("Content w/ Id: " + HardCodedId.ToString()), 
            ApplyFilter, 
            DisplayFilter, 
            null);
    }

    public void ApplyFilter(dynamic context) {
        var query = (IHqlQuery)context.Query;
        context.Query = query.Where(x => x.ContentItem(), x => x.Eq("Id", HardCodedId));
    }

    public LocalizedString DisplayFilter(dynamic context) {
        return T("Content w/ Id: " + HardCodedId.ToString());
    }
} 
```

要使 ID 号可配置，还有更多工作要做，但这应该让您走上正确的轨道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-16T16:59:42.900

I have played a bit with filter and this is what I did. This filter allows you to filter BlogPost based on one of the Blog you have in the site. It is useful if you have more than one blog and you want to show recent posts from just one or two.

It works for me.

Any comment will be appreciated.

```
using System;
using System.Linq;
using System.Web.Mvc;
using Orchard.Blogs.Models;
using Orchard.ContentManagement;
using Orchard.Core.Common.Models;
using Orchard.DisplayManagement;
using Orchard.Forms.Services;
using Orchard.Localization;
using Orchard.Projections.Descriptors.Filter;
using IFilterProvider = Orchard.Projections.Services.IFilterProvider;

namespace Orchard.Projections.Providers.Filters
{
    public class BlogPostFilter : IFilterProvider
    {
        private readonly IContentManager _contentManager;
        public BlogPostFilter(
            IContentManager contentManager)
        {
            _contentManager = contentManager;
            T = NullLocalizer.Instance;
        }

        public Localizer T { get; set; }

        public void Describe(DescribeFilterContext describe)
        {
            describe.For("Blogs", T("Blogs"), T("Blogs"))
                .Element("Blogs", T("Blogs"), T("Posts in blogs"),
                ApplyFilter,
                DisplayFilter,
                "BlogPostFilter");
        }

        public void ApplyFilter(dynamic context)
        {
            var blogIds = (string)context.State.Blogs;
            if (!String.IsNullOrEmpty(blogIds)) {
                var ids = blogIds.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
                var query = (IHqlQuery)context.Query;
                context.Query = query.Where(x => x.ContentPartRecord<CommonPartRecord>(), x => x.In("Container.Id", ids));
            }
        }

        public LocalizedString DisplayFilter(dynamic context)
        {
            var blogIds = (string)context.State.Blogs;
            if (!String.IsNullOrEmpty(blogIds)) {
                var ids = Array.ConvertAll(blogIds.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries), s => int.Parse(s));;
                var names = _contentManager.GetMany<BlogPart>(ids, VersionOptions.Published, QueryHints.Empty);
                return T("Posts in blogs: " + string.Join(", ", names.Select(x => x.Name)));
            }
            return T("Posts in blogs");
        }
    }

    public class BlogPostFilterForms : IFormProvider
    {
        private readonly IContentManager _contentManager;
        protected dynamic Shape { get; set; }
        public Localizer T { get; set; }

        public BlogPostFilterForms(
            IShapeFactory shapeFactory,
            IContentManager contentManager)
        {
            _contentManager = contentManager;
            Shape = shapeFactory;
            T = NullLocalizer.Instance;
        }

        public void Describe(DescribeContext context)
        {
            Func<IShapeFactory, object> form =
                shape => {

                    var f = Shape.Form(
                        Id: "AnyOfBlogPart",
                        _Parts: Shape.SelectList(
                            Id: "blogs", Name: "Blogs",
                            Title: T("Blogs"),
                            Description: T("Select some blogs."),
                            Size: 10,
                            Multiple: true
                            )
                        );

                    f._Parts.Add(new SelectListItem { Value = "", Text = T("Any").Text });

                    foreach (var blog in _contentManager.Query<BlogPart>().List().OrderBy(x => x.Name)) {
                        f._Parts.Add(new SelectListItem { Value = blog.Id.ToString(), Text = blog.Name });
                    }

                    return f;
                };

            context.Form("BlogPostFilter", form);

        }
    }
} 
```

# php - 从 PHP 查询数据库时出错

> ID：12064576
> 
> 赞同：0
> 
> 时间：2012-08-21T23:42:33.300
> 
> 标签：php, sql, mysqli, insert

我正在尝试从 PHP 将一行数据插入到表中。但是我从下面的代码中收到一条错误消息，说：

> “mysqli_query() 期望参数 1 为 mysqli”

```
$myServer = "mysql.x90x.net";
$myUser = "u1908429**_*****";
$myPass = "***************";
$myDB = "u1908429**_*****";
$dbhandle = mysqli_connect($myServer, $myUser, $myPass, $myDB)
    or die("Couldn't connect to SQL server on $myServer.");
$query = "INSERT INTO student_data VALUES ('$fname', '$lname', '$gpaP', '$agP', '$awardP', '$awardTP', '$rigorP', '$APP')"; 
$result = mysqli_query($query, $dbhandle)
    or die(mysql_error().'<br>SQL:'.$query);
mysqli_close($dbhandle); 
```

我认为它说的有问题，`mysqli_query`但我不知道有什么问题？...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:44:50.030

您将查询传递给第一个参数并在它应该相反时处理第二个参数。

```
$result = mysqli_query($dbhandle, $query); 
```

* * *

我建议您在遇到类似问题时查阅文档。这并不难。

```
mixed mysqli_query ( mysqli $link , string $query [, int $resultmode = MYSQLI_STORE_RESULT ] ) 
```

该[文档](http://php.net/mysqli_query)实际上非常好，并为您提供了函数期望的所有参数的很好的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:47:56.547

mysqli_select_db($link, "dbname"); 怎么样？? AFAIK mysqli 需要这个，所以 dbhandle 应该是这个函数的返回。

# ruby - 在 Mongoid 文档中保存和获取哈希

> ID：12064583
> 
> 赞同：2
> 
> 时间：2012-08-21T23:43:38.860
> 
> 标签：ruby, ruby-on-rails-3, hash, mongoid

我正在使用以下内容创建指标哈希：

```
@metrics = Hash.new

...

@metrics[:users][:year][:male] = ...
@metrics[:users][:today][:male] = ...

...

Metrics.new(:metrics => @metrics).save 
```

我有以下课程：

```
class Metrics
  include Mongoid::Document
  include Mongoid::Timestamps

  field :metrics, :type => Hash

  attr_accessible :metrics

  ...

end 
```

要获取此文档，我有：

```
@metrics = Metrics.find(params[:id])
@metrics = @metrics[:metrics] 
```

为了访问这些元素，我需要做：

```
@metrics['users']['year']['male'] 
```

有没有一种方法可以使我在访问哈希值的方式上保持一致，但仍将数据存储在 mongo 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:23:45.063

您使用的是哪个版本的 Ruby 和 Mongoid？通过符号访问 Mongoid 对象中的哈希值在 Mongoid 3.0.4 和 Ruby 1.9.3 中可以正常工作。所以我可以做类似的事情：

```
@metrics = Metrics.find(params[:id])[:metrics]
@metrics[:users][:year][:male] 
```

甚至：

```
Metrics.find(params[:id])[:metrics][:users][:year][:male] 
```

另外，为什么不直接忽略该`metrics`字段，然后将`Metrics`类的实例视为 的实例`Hash`？使用 Mongoid，您可以使用标准 Ruby 哈希符号语法动态设置和获取属性，而无需“声明”字段。删除该`metrics`字段后：

```
m = Metric.new
m[:users] = {}
m[:users][:year] = {}
m[:users][:year][:male] = "data" 
```

此外，如果您需要自动初始化嵌套哈希的方法，那么您可以执行以下操作：

```
m = Metric.new
m[:users][:year][:male] = "data" 
```

您可以将所有这些逻辑放入`Metrics`类中。要开始使用，您可以尝试修改[此处](https://stackoverflow.com/questions/3148747/is-auto-initialization-of-multi-dimensional-hash-array-possible-in-ruby-as-it-i)解释的 AutoHash 类中的`[]`和方法。这会给你我认为最干净的界面。`[]=`

# java - 在 JDBC 中使用 Calendar 对象

> ID：12064586
> 
> 赞同：3
> 
> 时间：2012-08-21T23:43:44.600
> 
> 标签：java, sql, jdbc, calendar, derby

我正在使用 Netbeans 和 Derby 数据库。我想插入带有日期字段的表记录，所以我被告知要使用`Calendar`对象，因为它包含我需要的内容：日期（日、月和年）、小时和分钟。

正如您在下面的代码中看到的，表格字段的类型为`DATE`。当我尝试将`Calendar`对象作为字符串插入时（在下面的代码中使用逗号），我得到：

> 日期时间值的字符串表示形式的语法不正确。

当我尝试在不带逗号的情况下插入它时，我得到：

> 语法错误：在第 1 行第 159 列遇到“[”

可能与 Calendar 对象有关。我在这里想念什么？

```
String from = fromForm.getText();
String to = toForm.getText();
String []date = dateForm.getText().split("/");
String []time = timeForm.getText().split(":");
int places = Integer.parseInt(placesForm.getText());
int closinghours=Integer.parseInt(closingHoursForm.getText());
Calendar calendar = Calendar.getInstance();
calendar.clear();
calendar.set(Integer.parseInt(date[2]),Integer.parseInt(date[1]),Integer.parseInt(date[0]),Integer.parseInt(time[0]),Integer.parseInt(time[1]));

String query="INSERT INTO APP.TRUMPS (TRUMPID,DEPART,ARRIVE,START,PLACES,PROPOSING_USER_LOGIN,CLOSING_HOURS)"+
        "VALUES ('"+newTrampTrumpistClient.login+dateForm.getText()+timeForm.getText()+"','"+from+"','"+to+
                "','"+calendar+"',"+places+",'"+newTrampTrumpistClient.login+"',"+closinghours+")";
String result=newTrampTrumpistClient.WritingReading("sql_insert", query); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T00:03:15.063

您应该使用[`PreparedStatement#setTimestamp()`](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setTimestamp%28int,%20java.sql.Timestamp%29)设置`TIMESTAMP/DATETIME`字段（或[`setDate()`](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setDate%28int,%20java.sql.Date%29)设置`DATE`字段，但这不包括小时和分钟......）。

```
String sql = "INSERT INTO"
    + " APP.TRUMPS (TRUMPID, DEPART, ARRIVE, START, PLACES, PROPOSING_USER_LOGIN, CLOSING_HOURS)"
    + " VALUES (?, ?, ?, ?, ?, ?, ?)";
// ...

PreparedStatement preparedStatement = null;
// ...

try {
    // ...
    preparedStatement = connection.prepareStatement(sql);
    preparedStatement.setString(1, newTrampTrumpistClient.login+dateForm.getText()+timeForm.getText());
    preparedStatement.setString(2, from);
    preparedStatement.setString(3, to);
    preparedStatement.setTimestamp(4, new Timestamp(calendar.getTimeInMillis()));
    preparedStatement.setInt(5, places);
    preparedStatement.setString(6, newTrampTrumpistClient.login);
    preparedStatement.setInt(7, closinghours);
    preparedStatement.executeUpdate();
    // ...
} finally {
    // ...
} 
```

额外的好处是使用准备好的语句可以保护您的应用程序免受[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)。

### 也可以看看：

*   [JDBC 教程 - 使用准备好的语句](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

* * *

**与具体问题**无关**`String`，从to转换`Calendar`非常笨拙。考虑使用[`SimpleDateFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)to 转换为`String`to `Date`。然后，您可以将其保留为`new Timestamp(date.getTime())`.**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T09:33:33.160

只是为了添加一些额外的信息......

您是否考虑过使用[Java.utils.Date](http://docs.oracle.com/javase/7/docs/api/)对象？

您可以根据需要使用尽可能多或少量的粒度来构建它，例如。从“日期”（年：月：日）一直到包括毫秒时间精度。

然后，您可以使用各种 getXXX() 方法捕获您想要的部分。

[您必须通过将您的日期对象传递给日历对象（可能通过GregorianCalendar](http://docs.oracle.com/javase/7/docs/api/)的方式，点击链接，Java doc 页面上有一个很好的示例）来做一些小动作。

或者，您可以使用 Java.util.Date 并通过 java.util.date 的 getTime() 方法将其传递给 Java.sql.date。

你可以对 java.sql.time 做同样的事情（即，传入同一个对象，你最终会得到 java.util.date 对象的时间部分）。如果您将相同的方法传递给 sql.timestamp，它将给出完整的时间戳。

您还可以使用相同的过程（sql.timestamp - to- util.date -t​​o- sql.date（或）sql.time）从时间戳转换回日期或时间部分，尽管大多数数据库允许从一个对另一个本地。

当您将 getTime() 方法传递给您的 java.util.date 对象时，它会返回一个“长”值（即自 1970 年 1 月 1 日的 Unix 纪元以来的时间！）我不知道它如何处理在此之前的时间和日期（我认为它们只是一个“负”值？）。

如果您想混淆您的客户并混淆您的代码，您甚至可以将您的日期作为长值存储在您的数据库中；）

大卫

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-21T23:50:35.307

尝试从日历实例中检索时间。即，calendar.getTime()。（它返回 Date 对象）您可能还需要将其转换为 sql 日期。**

# objective-c - Uncrustify：函数名和行尾大括号之间的空格

> ID：12064589
> 
> 赞同：2
> 
> 时间：2012-08-21T23:43:56.010
> 
> 标签：objective-c, formatting, uncrustify

如果我有这样的功能：

```
- (id)init {
    self = [super init];
    if(self){

    }
    return self;
} 
```

我想 uncrustify 输出这个：

```
- (id)init{
    self = [super init];
    if(self){

    }
    return self;
} 
```

我需要设置哪些选项？我似乎找不到函数名称末尾的大括号选项。我注意到它会在那里添加一个空格，但我找不到这样做的选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T15:29:30.627

看起来像

`sp_fparen_brace remove`

应该按照这个来做： http: [//uncrustify.sourceforge.net/config.txt](http://uncrustify.sourceforge.net/config.txt)

# c++ - 从 C++ 代码运行 Octave 函数

> ID：12064591
> 
> 赞同：2
> 
> 时间：2012-08-21T23:44:09.993
> 
> 标签：c++, linux, shared-libraries, octave

我试图在 linux 机器上从 c++ 代码运行 octave .m 函数，如

[这个链接](https://mailman.cae.wisc.edu/pipermail/help-octave/2009-April/034429.html)

但是，当我尝试在最后一步运行代码 ./how-to-call-octave 时，我遇到了这个错误：

```
./how-to-call-octave: error while loading shared libraries: liboctave.so: 
cannot open shared object file: No such file or directory 
```

我该如何纠正这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:38:17.367

许多事情都可能导致这个问题。最常见的有以下几种：

1.  该文件确实不存在。如果您通过包管理器安装，Octave 通常分为 2 个包。确保您还安装了相应的 -dev、-devel 或 -headers 软件包。如果您自己编译 Octave，您确定在运行配置时没有禁用共享库吗？再次构建它，这次确保你设置了`--enable-shared`标志。

2.  您需要更新共享库的缓存。出于安全和性能原因，Linux 会维护安装在“已批准”位置的共享库的缓存。要更新它，只需运行`ldconfig`（您需要 root 权限才能这样做）。

# objective-c - Facebook 邀请与 facebook SDK 3 for iOS

> ID：12064598
> 
> 赞同：1
> 
> 时间：2012-08-21T23:44:50.097
> 
> 标签：objective-c, ios, facebook, sdk

由于适用于 iOS 的 Facebook SDK 发生了变化，我想知道邀请朋友加入应用程序的最佳方式是什么。他们开发者网站上的文档似乎有点旧。

我已经在我的应用程序上运行了一个自定义的friendPicker，只需要在用户点击他/她的朋友时设置一个动作。

有什么想法或例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T14:28:14.193

我不得不使用 facebook 旧 SDK 和新 SDK，并按照他们的教程进行邀请。

请注意，您不能在同一个 .m 上使用同一个 SDK，所以要小心。

# javascript - 如何防止 jQuery 插件更改我的 DOM？

> ID：12064599
> 
> 赞同：0
> 
> 时间：2012-08-21T23:44:50.337
> 
> 标签：javascript, jquery

我正在使用第三方评论插件并使用简单的 jQuery 自定义几个元素。但是，在某些情况下，插件会自行刷新并清除我对其所做的所有更改。没有将处理程序附加到与此刷新调用关联的事件，并且我并不总是可以控制它何时发生。

有什么方法可以防止更改某些元素吗？或者可能是一种检测某些（非表单）元素是否已更改以便我可以将它们更改回来的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T23:47:41.483

没有办法阻止页面中的一段 javascript 更改您的 DOM 元素。

您的选择是：

1.  研究有问题的 javascript 并将其停用（渲染它使其无法运行）。您如何做到这一点将取决于该 javascript 的工作方式。您可能会用更无害的函数替换一些函数，或者在它初始化自身或杀死它拥有的计时器之后取消注册事件处理程序，等等......

2.  更改 DOM 以使插件不会针对您希望它单独保留的元素。同样，这将取决于插件如何识别它将更改哪些元素。

3.  定期查询受影响的对象并在插件弄乱后恢复它们的状态。

4.  卸载插件。

如果不研究插件代码，我们很难比这更具体。

# matlab - MatLab，我如何在彼此之上绘制多个波？

> ID：12064604
> 
> 赞同：1
> 
> 时间：2012-08-21T23:45:53.590
> 
> 标签：matlab, plot, wave

我有这张来自用户 Li-aung Yip 的图片，在他的回复中：[有没有办法在矩阵中多次进行线性最佳拟合，以消除一系列趋势，MatLab？](https://stackoverflow.com/questions/10322606/is-there-a-way-to-do-a-linear-best-fit-from-one-point-to-another-in-a-matrix-mul)

![在此处输入图像描述](../Images/1c17f8c0faf2f90639b67889dc2e352a.png)

我想知道给定几个时间序列 MatLab 如何做到这一点。

最好的，阿比德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T00:16:22.100

假设原始图（红色、绿色、黑色、蓝色）是变量`a,b,c,d`，每个变量都有一个点`t`：

```
figure;
hold on
plot(t,c,'-k'); %# black line
plot(t,c+b,'-g'); %# green line added to previous
plot(t,c+b+a,'-r'); %# red line added to previous
plot(t,c+b+a+d,'-b'); %# blue line added to previous 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:21:13.513

如果`x`你的日期向量是哪里，`B`你的黑线是哪里，

```
plot(x,A) % the NR plot
hold on
plot(x,B,'k')
plot(x,C+B,'g')
plot(x,D+B,'r')    
hline(1.2)
hline(1.0) 
```

# jquery - 内联日期选择器中的 jQuery UI beforeShowDay 崩溃

> ID：12064606
> 
> 赞同：1
> 
> 时间：2012-08-21T23:46:31.303
> 
> 标签：jquery, jquery-ui, jquery-ui-datepicker

相当直接的问题：

如果我有一个内联日期选择器（在 div 上调用 .datepicker() 而不是输入）并使用 beforeShowDay 函数，一切都会中断。

我在这里创建了一个 jsFiddle，因此您可以对其进行测试：http: [//jsfiddle.net/MBwSe/1/](http://jsfiddle.net/MBwSe/1/)

beforeShowDay 函数在前 4 天对我有效（2012 年 7 月 29 日至 2012 年 8 月 1 日），然后在 2012 年 8 月 2 日中断，出现以下错误：

```
TypeError: daySettings is undefined
[Break On This Error]   
line 8827

var unselectable = (otherMonth && !selectOtherMonths) || !daySettings[0] || 
```

有什么想法吗？使我抓狂！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:49:49.350

您必须从`beforeShowDay`. 从文档：

> 该函数将日期作为参数，并且**必须返回一个数组**，其中 [0] 等于 true/false 指示此日期是否可选，[1] 等于 CSS 类名称或默认表示为 "" , 和 [2] 此日期的可选弹出工具提示。在显示之前，它会在日期选择器中的每一天被调用。

**修改过的小提琴：http:** [//jsfiddle.net/MBwSe/2/](http://jsfiddle.net/MBwSe/2/)

# c# - SlimDX 加载预编译着色器

> ID：12064607
> 
> 赞同：2
> 
> 时间：2012-08-21T23:46:36.057
> 
> 标签：c#, .net-4.0, shader, slimdx

我正在尝试在 SlimDX(Direct3D11) 中加载预编译着色器，但我不知道该怎么做。

我搜索了这个主题，只找到了 DirectX 的 C++ 本机版本的解决方案。似乎 /Gch 编译选项和 device->CreatePixelShader(data,ps)。

问题是，我在 SlimDX 中找不到这个功能。SlimDX 中的函数在运行时编译着色器。

如何在 SlimDX 中加载预编译的着色器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T01:12:08.750

考虑到您的着色器二进制文件保存在 byte[] 字节码中（因为我不确定您从哪里加载它，但它只是保存后的二进制数据）

```
DataStream ds = new DataStream(bytecode.Length, true, true);
ds.Write(bytecode, 0, bytecode.Length);
ShaderBytecode bc = new ShaderBytecode(ds); 
```

然后加载 dx11 效果：

```
Effect effect = new Effect(device,bc); 
```

# c# - 将 SQL 表合并到常用的 datagridview 中

> ID：12064614
> 
> 赞同：0
> 
> 时间：2012-08-21T23:47:42.840
> 
> 标签：c#, sql

您好，我有 2 个 SQL 表，我想合并它们以在`datagridview`. 我已经可以通过将其绑定到数据集来将其设置为查看一个，但是如何根据两个表都包含的公共 ID 号（例如）合并这两个？

当前 datagridview 填充代码（该函数被提供一个空的新 DataTable）：

```
public void populateSingleDataGridView(DataTable dt,  DataGridView dg, string SN_DB_Name)
{
     string selectProgramString = "select * from " + SN_DB_Name;
     SqlDataAdapter sqlDataAdaptor = new SqlDataAdapter(selectProgramString,connectionString);
     dt.Locale = System.Globalization.CultureInfo.InvariantCulture;
     sqlDataAdaptor.Fill(dt);
     dg.DataSource = dt;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:53:36.387

您可以将两个表连接在一起：

```
select table1.Field1 as GridColumn1, table2.Field2 as GridColumn2
from table1
    inner join table2
    on table1.CommonId = table2.CommonId 
```

如果您想保持当前代码不变，那么一种选择是创建一个视图，例如

```
create view GridData
as
    select table1.Field1 as GridColumn1, table2.Field2 as GridColumn2
    from table1
        inner join table2
        on table1.CommonId = table2.CommonId 
```

然后您可以将视图名称传递给 SN_DB_Name。

注意：此选项将强制您为任何带有连接的查询创建视图。恕我直言，更好的选择是传递整个 sql 字符串。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T07:02:44.670

//尝试在查询中使用别名 //像这样

从 YourTable1 a,YourTable2 b 中选择 a.ID_number,b.Column1,b.Column2 其中 a.ID_number=b.ID_Number

# windows - Windows 2003 服务器限制文件访问权限只允许一个用户

> ID：12064617
> 
> 赞同：0
> 
> 时间：2012-08-21T23:47:58.913
> 
> 标签：windows, permissions, file-access

我们在 Windows 2003 服务器上运行了一个旧版 DOS 应用程序。它经常使用一个文件，并且如果该文件被另一个进程“触摸”，则非常敏感（即会破坏）。例如，如果文件正在被病毒扫描软件扫描，或者文件在 Windows 资源管理器中通过鼠标单击突出显示。

为了使其更稳定，我想使用 Windows 文件权限限制对文件的访问。我将授予用户启动 DOS 应用程序的访问权限，但不授予其他用户，包括 SYSTEM 帐户和系统管理员。

我能做到吗，我的方法会奏效吗（即防止其他进程“接触”文件）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:14:54.033

是的，你的方法会奏效......主要是。这甚至不难。但是您可能无法停止所有防病毒软件，因为它们中的大多数使用可以覆盖安全设置的内核模式组件。显然他们必须这样做，否则恶意软件作者可以简单地使用安全设置来防止他们的文件被扫描。另一个问题区域可能是备份实用程序，但这种情况很少发生，通常每天最多不超过一次。我会继续快速实施您的方法，并使用尽可能多的防病毒软件包对其进行测试。我希望你能消除所有问题的 95%，但不是 100%。

# php - php比较时间

> ID：12064619
> 
> 赞同：1
> 
> 时间：2012-08-21T23:48:22.033
> 
> 标签：php, datetime

我有下面的 php 代码，使用 strtotime 将当前时间与当前时间进行了两次比较：

```
 $timingsfirstTime[0] = date("H:i:s", strtotime(trim($showTimings[0])));
 $timingslastTime[2] = date("H:i:s", strtotime(trim($showTimings[2]))); 
```

// 确认第一个节目的开始时间大于频道上最后一个节目的最后时间

```
 $current_time = date("H:i:s",strtotime('now'));

        $this->assertTrue(($current_time > $timingsfirstTime[0] && $current_time < $timingslastTime[2]),"current time ".$current_time. " is not greater than current show start time ". $timingsfirstTime[0] . " or current time is not less than current show end time ".$timingslastTime[2]); 
```

但是我的断言以某种方式失败并输出：

当前时间 00:38:45 不大于当前演出开始时间 23:50:00 或当前时间不小于当前演出结束时间 00:50:00

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:02:39.777

您正在进行字符串比较，而不是日期比较，这就是它“失败”的原因。

改为使用[`DateTime`](http://php.net/manual/en/class.datetime.php)，因为它更易于阅读，代码更少，并且可以在本地进行比较。我还将您的断言分成两个断言，以便更容易判断哪种情况失败：

```
$now = new DateTime();
$start = new DateTime($showTimings[0]);
$end = new DateTime($showTimings[2]);

$this->assertTrue(
    $now > $start,
    'current time ' . $now->format('H:i:s')
        . ' is not greater than current show start time '
        . $start->format('H:i:s')
);

$this->assertTrue(
    $now < $end,
    'current time ' . $now->format('H:i:s')
        . ' is not less than current show end time '
        . $end->format('H:i:s')
); 
```

# c# - 我如何监视整个计算机的任何文件更改？

> ID：12064621
> 
> 赞同：0
> 
> 时间：2012-08-21T23:48:25.950
> 
> 标签：c#, file, find, monitor, filesystemwatcher

我想监视我的整个计算机文件是否有任何更改。例如，文件创建、删除、修改、属性更改等。我知道有一个名为 filesystemwatcher 的控件，但我知道的几乎就是这些。我想做这个应用程序，希望每当我得到一个病毒时都能在计算机上找到病毒。感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T06:51:54.820

病毒的问题在于它们的活动很难与合法使用区分开来。此外，FileSystemWatcher 是异步的，即您可以收到通知但不能阻止操作。

为了防止该操作发生，您需要使用文件系统过滤器驱动程序，就像所有防病毒软件一样。您可以自己编写（至少 6 个人工月的工作）或为此使用我们的 CallbackFilter 产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:53:21.513

你可以看看 FileWatcher 类这里有几个链接

[如何在 C# 中实现一个简单的 filewatcher Windows 服务](http://www.codeproject.com/Articles/18521/How-to-implement-a-simple-filewatcher-Windows-serv)

[MSDN FileSystemWatcher 类](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

# grails - Grails 堆空间间歇性溢出

> ID：12064622
> 
> 赞同：1
> 
> 时间：2012-08-21T23:48:43.630
> 
> 标签：grails

我遇到了一个间歇性且难以复制的快乐问题。

在运行几分钟或几天后，我的测试服务器上的 grails 应用程序失败。我无法在 Dev 或我的本地复制。

这里的堆栈跟踪模式示例从中间剪掉了 1000 行（这将继续像这样转储，直到我重新启动 Tomcat）：

```
at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
Caused by: javax.servlet.ServletException: javax.servlet.ServletException: org.springframework.web.util.NestedServletException: Handler processing failed; nested exception is java.lang.OutOfMemoryError: Java heap space
    at net.sf.ehcache.constructs.web.filter.Filter.logThrowable(Filter.java:143)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:91)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
......
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
Caused by: javax.servlet.ServletException: org.springframework.web.util.NestedServletException: Handler processing failed; nested exception is java.lang.OutOfMemoryError: Java heap space
    at grails.plugin.cache.web.filter.AbstractFilter.logThrowable(AbstractFilter.java:116)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:70)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)

..................
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    at grails.plugin.springcache.web.GrailsFragmentCachingFilter.doFilter(GrailsFragmentCachingFilter.groovy:66)
    at net.sf.ehcache.constructs.web.filter.Filter.doFilter(Filter.java:86)
    at net.bull.javamelody.JspWrapper.invoke(JspWrapper.java:117)
    at net.bull.javamelody.JdbcWrapper$DelegatingInvocationHandler.invoke(JdbcWrapper.java:231)
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
Caused by: org.springframework.web.util.NestedServletException: Handler processing failed; nested exception is java.lang.OutOfMemoryError: Java heap space
    at grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)
    at grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)
    ... 132 more
Caused by: java.lang.OutOfMemoryError: Java heap space 
```

这看起来可能发生了应用程序错误，调用了 errorHandler 并不断调用自身...kaboom！

**环境**：

*   圣杯：2.0.4
*   Tomcat：apache-tomcat-7.0.28
*   操作系统：红帽企业 Linux 服务器版本 5.8 (Tikanga)

**爪哇**：

```
java version "1.6.0_22"
OpenJDK Runtime Environment (IcedTea6 1.10.8) (rhel-1.27.1.10.8.el5_8-x86_64)
OpenJDK 64-Bit Server VM (build 20.0-b11, mixed mode) 
```

在 Dev Java 中（这可能是我试图让 SA 在测试系统中更改的主要问题）

```
java version "1.6.0_30"
Java(TM) SE Runtime Environment (build 1.6.0_30-b12)
Java HotSpot(TM) 64-Bit Server VM (build 20.5-b03, mixed mode) 
```

该服务器目前只有 0-5 名用户登录，但这会在 24 小时内起起落落。

分配的堆空间为 5g，通常使用 <20%。

在测试中发生了另外两件奇怪的事情，而不是在开发中：

*   最初几乎没有日志记录但由于问题而导致的日志已在 50 日打开到 DEBUG 和 RollingFile 100Meg 文件。日志很好，记录应用程序特定的东西，直到堆栈爆炸，然后它们中唯一的东西就是堆栈，tomcat 日志记录也是如此。即使我在第 50 个日志滚出之前关闭服务器也是如此。所以我不知道是否有一些应用程序特定的不祥之物会触发这种情况。

*   JavaMelody 插件：图表上的标签不可读，就像我 3 岁的孩子写的那样。我相信所有操作系统字体都已加载，但可能指向 Java 版本。

**调度程序：** 是的，有 2 个正在运行，运行它们没有问题

**数据库配置：** 遗留数据库有 8 个数据源，每个当前可能设置得有点饿，例如：

```
def connectionPropertiesMedium = [
        maxActive: 100,
        maxIdle: 30,
        minIdle: 5,
        initialSize: 30,
        testOnBorrow: true,
        testWhileIdle: false,
        testOnReturn: false,
        validationQuery: "SELECT 1",
        minEvictableIdleTimeMillis: 600000,
        timeBetweenEvictionRunsMillis: 600000,
        numTestsPerEvictionRun: 3,
        maxWait: 10000,
        defaultTransactionIsolation: java.sql.Connection.TRANSACTION_READ_UNCOMMITTED
] 
```

**HeapDump:** Running with `-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=heapdump.hprof` Reading with VisualVM 这几乎没有显示（无论如何对我来说） 70%+ 是 char[] 充满了上面的堆栈跟踪。Eclipse MAT 不会加载它。

**JVM参数：**

```
CATALINA_OPTS="-server -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=heapdump.hprof -XX:MaxPermSize=1024m -XX:MaxNewSize=256m -XX:NewSize=256m -Xms768m -Xmx1024m -XX:SurvivorRatio=128 -XX:MaxTenuringThreshold=0 -XX:+UseTLAB -XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled -XX:+CMSIncrementalMode -XX:-UseGCOverheadLimit -XX:+ExplicitGCInvokesConcurrent 
```

**压力测试：** 应用程序可以运行几个激烈的查询，这些查询被多达 200 名模拟 JMeter 用户多次点击，没有问题......实际上数据库确实有点慢;）但内存问题是没有在许多运行中复制。

因此，如果有人读到这里，我有 2 条线索（向更多人开放）：

*   Java 版本 - 旨在摆脱 OpenJDK 并进入标准版本
*   发生错误时，我的 Grails 设置中的某些内容会导致无限/递归处理。

直到我找到能摧毁这些机器中的幽灵的质子包，这个应用程序才会上线。

有任何想法吗？

干杯...

**更新#1**

安装了 Java 1.7 并删除了 OpenJDK，这肯定解决了 JavaMelody 显示问题。现在它正在等待游戏，看看这是否解决了主要问题。有趣的是，该网站似乎明显更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:02:26.113

如果用户多次重新提交登录表单（到 j_spring_security_check），这会导致在自定义 UserDetailsS​​ervice 中调用 User.save()（例如更新上次登录时间），Hibernate 会话在每个用户的后续调用中关闭。

将 User.save() 移动到 AuthenticationEventListener.onApplicationEvent(AuthenticationSuccessEvent event) 并且工作正常。

基本设置来自[Spring security core plugin - events](http://grails-plugins.github.io/grails-spring-security-core/guide/events.html#registeringEventListener)的文档，我的就像：

在您的配置中添加：`grails.plugin.springsecurity.useSecurityEventListener = true`

在 resources.groovy 中：

```
import security.AuthenticationEventListener
....
authenticationEventListener(AuthenticationEventListener) 
```

AuthenticationEventListener.groovy：

```
class AuthenticationEventListener implements ApplicationListener<AuthenticationSuccessEvent> {

    void onApplicationEvent(AuthenticationSuccessEvent event) {
        if (event instanceof AuthenticationSuccessEvent) {
            UserDetails userDetails = (UserDetails) event.getAuthentication().getPrincipal()
            def httpSession = SecurityRequestHolder.request.session

            if (!httpSession.loggedIn) {
                httpSession.loggedIn = true
                synchronized (httpSession.loggedIn) {
                    httpSession.timeZone = userDetails.timeZone
                    User.withSession { session ->
                        if (session.isOpen()) {
                            User user = User.findByUsername(userDetails.username, [fetch: [roles: 'eager']])
                            user.lastLoggedIn = new Date()
                            user.save(flush: true)
                        }
                    }
                }
            }
        }
    }
} 
```

# mysql - MySQL group 记录相似的，然后给 group total

> ID：12064624
> 
> 赞同：0
> 
> 时间：2012-08-21T23:49:08.037
> 
> 标签：mysql

我有一组数据，我试图操纵这些数据以获得一些结果。在一张表中，我存储了不同的废物类型，如下所示：

```
-----------------------------
| id  | wastetype | percent |
|-----|-----------|---------|
|  1  |    12     |   30    |
|  2  |    12     |   20    |
|  3  |    12     |   10    |
----------------------------- 
```

基本上，我想要做的是在表格中显示所有废物类型的累积，给定一个特定的废物类型 ID。我想使用数据库来完成此操作，以便我拥有的 PHP 代码可以在任何进一步的计算中使用查询的结果或打印结果。我知道如果我使用`COUNT`它不会计算字段中包含的值，但它会计算它们出现在表中的次数。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:32:19.130

Use `SUM` instead of `COUNT`. Try,

```
SELECT SUM(percent) totalPercentage
FROM tableName
WHERE wasteType = 1 
```

OR

```
SELECT wastetype, SUM(percent) totalPercentage
FROM tableName
GROUP BY wasteType
WHERE wasteType = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:52:42.927

`SELECT COUNT(*) AS num, SUM(percent) AS sum_percent FROM table GROUP BY wastetype;`

`GROUP BY`将给定字段的具有相同值的记录组合在一起。使用[分组功能](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)可以收集有关分组数据的信息。

# java - 方法未返回所需值

> ID：12064625
> 
> 赞同：1
> 
> 时间：2012-08-21T23:49:09.067
> 
> 标签：java

我正在尝试编写一种方法，该方法采用输入字符串，并在指定位置添加一个字符。inputString 有 42 个字符长，分为 7 个“列”，当用户给出输入时，该方法应该接受该输入并将“X”放在适当的位置。这是代码：

```
private String enterToken(String tokenSymbol, String inputString, int column){
   String columnEdit = inputString.substring(column*6-6,column*6); 

   String columnEdit1 = columnEdit.trim();
   String columnEdit2 = columnEdit1+tokenSymbol+"                 ";
   String columnEdit3 = columnEdit2.substring(0,6);
   String start = inputString.replace(inputString.substring(column*6-6,column*6),columnEdit3);
   System.out.println(start);
   return start;

 } 
```

例如，当我给它一个 42 个空格的输入并给它一个第 2 列时，它给我一个输出

```
"X     X     X     X     X     X     X     " 
```

而它应该给我一个喜欢

```
"      X                                   " 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:03:30.820

您正在调用`replace`整个字符串，而不仅仅是要对其执行操作的子字符串。IE`inputString.replace(...)`

您需要拆分字符串，调用`replace`子字符串，然后将字符串连接在一起以返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:16:35.090

这是一个解决方案：

```
private String enterToken(String tokenSymbol, String inputString, int column) {
    int colWidth = inputString.length() / 7;
    int tokenPos = (column-1) * colWidth;
    String inputStart = inputString.substring(0, tokenPos);
    String inputEnd = inputString.substring(tokenPos+1);
    return inputStart + tokenSymbol+inputEnd;
} 
```

# c# - 在 XElement 中解析 CDATA

> ID：12064636
> 
> 赞同：1
> 
> 时间：2012-08-21T23:50:40.903
> 
> 标签：c#, xml, xml-parsing, xmlreader, xelement

我正在尝试使用 CDATA 元素解析 XML...如果 CDATA 中的内容是 xml 编码的，我下面的代码会爆炸...有什么方法可以在解析之前解码所有 xml。

---要解析的代码

`if (formText.FirstNode.NodeType == XmlNodeType.CDATA) { return formText.Value; }
else { throw new applicatinException("ERROR")}`

如果 formText 有，则此代码有效

```
 "<Text><![CDATA[Sample Text<b>BoldText </b>]]></m:FormText>" 
```

但是如果 formText 有（编码值）就会爆炸

```
 "<Text>&lt;[CDATA[Sample Text &lt;b&gt;BoldText&lt;/b&gt; ]]&gt;</m:FormText>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:01:56.663

```
"<Text>&lt;[CDATA[Sample Text &lt;b&gt;BoldText&lt;/b&gt; ]]&gt;</m:FormText>" 
```

这不是 CDATA 段，而是文本段。您必须将其作为基本文本处理并自己处理提取 CDATA 信息。通过对 CDATA 信息进行编码，您使其不再匹配该格式。

# javascript - Onclick：在重定向到另一个页面时在新窗口中打开 .exe

> ID：12064637
> 
> 赞同：0
> 
> 时间：2012-08-21T23:51:14.280
> 
> 标签：javascript, jquery, safari, cross-browser

我正在尝试构建一个下载按钮，单击该按钮时，会在新窗口中开始下载文件，同时重定向到原始窗口中的“您当前正在下载”页面。为什么我需要它以这种方式工作而不是从“您当前正在下载”页面重定向到下载文件有多种原因。

我的代码在 IE、Chrome 和 Firefox 中运行良好，但无法在 Safari 中启动 setup.exe。

```
jQuery(window).load(function() {
    var link = $j('#slider_download_link a')[0];
    link.href = 'setup.exe'; // This link is dependent on the browser and OS. For example, on Mac I'd link to the Mac App Store
    link.target = "_blank";
    link.onclick = RedirectToDownloadingPage;
});

function RedirectToDownloadingPage()
{
    location.href="/downloading";
    return true;
} 
```

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:19:06.470

一旦点击处理程序被触发，页面导航就会开始，并且 Safari 显然会停止对当前页面执行任何其他操作，包括让您的链接触发。因此，延迟点击处理程序，直到链接被激活后`setTimeout()`：

```
function RedirectToDownloadingPage()
{
    setTimeout(function()
    {
        location.href="/downloading";
    }, 100);
    return true;
} 
```

在我的实验中，超时值`0`足够了，但为了安全起见，稍微增加一点可能是个好主意。类似的东西`100`应该足够了。

# macos - 无法让 Phusion Passenger 与 Mac OS X Mountain Lion 和 Apache 一起工作

> ID：12064639
> 
> 赞同：3
> 
> 时间：2012-08-21T23:51:24.627
> 
> 标签：macos, apache2, osx-mountain-lion, osx-server

我刚刚购买了安装了 Lion Server 的新 Mac mini，并立即升级到 Mountain Lion Server。然后我像往常一样继续安装 rvm、rails、Passenger 等（好吧，我上次安装Passenger 时我在Snow Leopard 上）。

我按照此处的说明进行操作：http: [//jasoncodes.com/posts/mac-os-rails-server#ruby](http://jasoncodes.com/posts/mac-os-rails-server#ruby)

启动/重新启动 Apache 时我没有收到任何错误，但乘客模块似乎根本没有加载。

Mountain Lion apache 的信息非常稀少，但看起来一堆配置文件已从 /etc/apache2/ 移动到 /Library/Server/Web/Config/apache2，但我不知道我在做什么需要更改才能有载客量。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-06T11:01:09.627

我在尝试在 Mountain Lion Server 上安装 Redmine 时遇到了同样的问题。

就我而言，解决方案非常简单：

1.  安装`Xcode`从 AppStore
2.  打开`Terminal`
3.  `sudo gem install passenger`
4.  `sudo passenger-install-apache2-module`
5.  `sudo nano /private/etc/apache2/httpd.conf`
6.  粘贴`passenger_module`安装程序吐出的行`/private/etc/apache2/httpd.conf`到：

    LoadModule 乘客模块 /Library/Ruby/Gems/1.8/gems/passenger-3.0.18/ext/apache2/mod_passenger.so

    乘客根 /Library/Ruby/Gems/1.8/gems/passenger-3.0.18

    PassengerRuby /System/Library/Frameworks/Ruby.framework/Version/1.8/usr/bin/ruby

（确保您的安装版本号正确 - 我的是 3.0.18）

关键是在 Mountain Lion Server 中，Server.app 有它的 httpd 配置文件

```
/Library/Server/Web/Config/apache2/httpd_server_app.conf 
```

但是，您对此文件所做的更改无法识别，要使其永久化，您必须编辑`/private/etc/apache2/httpd.conf`

如果你想使用Passenger Preference Pane，你必须编译它，因为预编译的版本与Mountain Lion 不兼容。

我使用了以下说明`redmine.org`：

```
cd ~/Downloads

git clone https://github.com/Fingertips/passengerpane/

cd passengerpane

xcodebuild 
```

（如果找不到`xcodebuild`，可能在`/usr/bin/xcodebuild`）

安装首选项窗格。查看`~/Downloads/passengerpane/build/Release`，然后双击 P`assenger.prefPane`进行安装。

希望这可以帮助..

干杯!

# python - Python dict.keys 列出重复的结果

> ID：12064645
> 
> 赞同：0
> 
> 时间：2012-08-21T23:52:11.890
> 
> 标签：python, list, key

我有一个字典，`.keys()`用来转换成一个键列表，然后小写键并对列表进行排序，如下所示：

```
dictionary = list()
# covert all to lower case
for word in self._dict.keys():
  dictionary.append(word.lower())
dictionary.sort()
print dictionary[:5] 
```

印刷`[u'a', u'a', u'aa', u'aa', u'aaa']`

为什么元素是重复的？

更新：愚蠢的我，没想到原始字典中可能有小写字母......纯粹的尴尬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:57:21.183

因为您已将键转换为小写。例如：

```
'AAA'.lower() == 'aaa'
True
'Aa'.lower() == 'aA'.lower()
True 
```

所以，如果你有一个这样定义的类：

```
class C:
    def __init__(self):
        self.a = None
        self.A = None
        self.aA = None
        self.Aa = None
        self.AAA = None
        self.aAa = None 
```

然后是它的一个实例：

```
>>> c = C()
>>> c.__dict__
{'a': None, 'A': None, 'aA': None, 'AAA': None, 'Aa': None, 'aAa': None}
>>> c.__dict__.keys()
['a', 'A', 'aA', 'AAA', 'Aa', 'aAa'] 
```

将键转换为小写会导致重复：

```
>>> sorted(key.lower() for key in c.__dict__.keys())
['a', 'a', 'aa', 'aa', 'aaa', 'aaa'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T23:59:33.220

字符串区分大小写：

```
>>> 'AA' == 'aa'
False 
```

字典键也区分大小写，因此将它们全部转换为小写可能会给您重复。要摆脱重复项，请使用一个`set`对象：

```
>>> list(set(['AAA', 'aaa', 'AAA', 'aaa']))
['aaa', 'AAA'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T23:57:33.637

例如，如果其中一个键是`u'A'`，另一个键是`u'a'`，那么您`u'a'`将从第一个和`u'a'`第二个中获得。

# php - 是否有现成的会话劫持保护 API？

> ID：12064647
> 
> 赞同：6
> 
> 时间：2012-08-21T23:52:24.757
> 
> 标签：php, security

我查看了许多讨论防止会话劫持和固定的线程，但我觉得总是有一些细节我错过了。

我正在寻找的是与 HTML Purifier 针对 XSS 所做的原理相同的东西，但在这种情况下针对会话劫持和固定。

是否有任何人制作的 API 或 PHP 类涵盖了可以采取的所有措施来防止会话劫持和修复？

还是我自己做比较好？

提前致谢。问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:45:00.033

会话劫持是指攻击者能够读取用户会话 cookie，并使用该会话 cookie 作为访问您的应用程序的手段。防止攻击者这样做的唯一方法是对所有内容使用 HTTPS。没有 API 可供使用，因为如果有人可以在中间情况下设置 man，则应用程序无法做任何其他事情来防止有人窃取会话 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T10:16:53.303

我确定您正在搜索等于`session.cookie_httponly`设置为 1 的解决方案。

也许`session.use_only_cookies`另外（但不是相反！）。

在这种情况下，您的会话 cookie 将始终对 JS 隐藏。

*更新：*阅读 Billy ONeal 的回答并评论 HTTPS

*是：* Billy ONeal 提到的 HTTPS 是一个额外的东西，然后是有这个问题的基础。中间人是一种“昂贵”的攻击，所以如果你有一些数据需要保护访问者的 ISP，那么我认为你的网站已经落后于 HTTPS。虽然被盗会话是一个常见问题。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-08-22T01:12:25.733

自己做一个总是更好。这可能会更难，最终不会做太多，但是那些将要进行劫持的人可以访问框架和 API。

尝试加密您的会话并以这种方式工作。安全需要对平台架构及其数据库进行重大更改

# ruby - Ruby：将嵌套的 Ruby 哈希转换为未嵌套的哈希

> ID：12064648
> 
> 赞同：6
> 
> 时间：2012-08-21T23:52:35.197
> 
> 标签：ruby, hash, nested-attributes

现在，我有一个服务器调用来回退以下 Ruby 哈希：

```
{
  "id"=>"-ct",
  "factualId"=>"",
  "outOfBusiness"=>false,
  "publishedAt"=>"2012-03-09 11:02:01",
  "general"=>{
    "name"=>"A Cote",
    "timeZone"=>"EST",
    "desc"=>"Ã€ CÃ´tÃ© is a small-plates restaurant in Oakland's charming
            Rockridge district. Cozy tables surround large communal tables in both
            the main dining room and on the sunny patio to create a festive atmosphere.
              Small plates reflecting the best of seasonal Mediterranean cuisine are served
            family-style by a friendly and knowledgeable staff.\nMenu items are paired with
            a carefully chosen selection of over 40 wines by the glass as well as a highly
            diverse bottled wine menu. Specialty drinks featuring fresh fruits, rare
            botaniques and fine liqueurs are featured at the bar.",
    "website"=>"http://acoterestaurant.com/"
  },
  "location"=>{
    "address1"=>"5478 College Ave",
    "address2"=>"",
    "city"=>"Oakland",
    "region"=>"CA",
    "country"=>"US",
    "postcode"=>"94618",
    "longitude"=>37.84235,
    "latitude"=>-122.25222
  },
  "phones"=>{
    "main"=>"510-655-6469",
    "fax"=>nil
  },
  "hours"=>{
    "mon"=>{"start"=>"", "end"=>""},
    "tue"=>{"start"=>"", "end"=>""},
    "wed"=>{"start"=>"", "end"=>""},
    "thu"=>{"start"=>"", "end"=>""},
    "fri"=>{"start"=>"", "end"=>""},
    "sat"=>{"start"=>"", "end"=>""},
    "sun"=>{"start"=>"", "end"=>""},
    "holidaySchedule"=>""
  },
  "businessType"=>"Restaurant"
} 
```

它有几个嵌套的属性，例如：

```
"wed"=>{"start"=>"", "end"=>""} 
```

我需要将此对象转换为 Ruby 中的未嵌套哈希。理想情况下，我想检测一个属性是否嵌套，并做出相应的响应，当 IE 确定属性“ `wed`”是嵌套的时，它会提取其数据并存储在“ `wed-start`”和“ `wed-end`”字段或类似的字段中。

有人对如何开始有任何提示吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T00:24:11.433

***编辑：[sparseify gem](https://rubygems.org/gems/sparsify)是作为这个问题的一般解决方案发布的。***

* * *

这是我几个月前完成的一个实现。您需要将 JSON 解析为散列，然后使用 Sparsify 来稀疏散列。

```
# Extend into a hash to provide sparse and unsparse methods. 
# 
# {'foo'=>{'bar'=>'bingo'}}.sparse #=> {'foo.bar'=>'bingo'}
# {'foo.bar'=>'bingo'}.unsparse => {'foo'=>{'bar'=>'bingo'}}
# 
module Sparsify
  def sparse(options={})
    self.map do |k,v|
      prefix = (options.fetch(:prefix,[])+[k])
      next Sparsify::sparse( v, options.merge(:prefix => prefix ) ) if v.is_a? Hash
      { prefix.join(options.fetch( :separator, '.') ) => v}
    end.reduce(:merge) || Hash.new
  end
  def sparse!
    self.replace(sparse)
  end

  def unsparse(options={})
    ret = Hash.new
    sparse.each do |k,v|
      current = ret
      key = k.to_s.split( options.fetch( :separator, '.') )
      current = (current[key.shift] ||= Hash.new) until (key.size<=1)
      current[key.first] = v
    end
    return ret
  end
  def unsparse!(options={})
    self.replace(unsparse)
  end

  def self.sparse(hsh,options={})
    hsh.dup.extend(self).sparse(options)
  end

  def self.unsparse(hsh,options={})
    hsh.dup.extend(self).unsparse(options)
  end

  def self.extended(base)
    raise ArgumentError, "<#{base.inspect}> must be a Hash" unless base.is_a? Hash
  end
end 
```

用法：

```
external_data = JSON.decode( external_json )
flattened = Sparsify.sparse( external_data, :separator => '-' ) 
```

这最初是因为我们在 Mongo 中存储一组东西而创建的，这允许我们在更新时使用稀疏键（点分隔）来更新嵌套哈希的某些内容，而不会覆盖不相关的键。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-22T00:14:41.430

这是完整解决方案的第一步。我相信你可以写得更优雅，但这似乎很清楚。如果您将其保存在 Ruby 文件中并运行它，您将获得我在下面显示的输出。

```
class Hash
  def unnest
    new_hash = {}
    each do |key,val|
      if val.is_a?(Hash)
        new_hash.merge!(val.prefix_keys("#{key}-"))
      else
        new_hash[key] = val
      end
    end
    new_hash
  end

  def prefix_keys(prefix)
    Hash[map{|key,val| [prefix + key, val]}].unnest
  end
end

p ({"a" => 2, "f" => 5}).unnest
p ({"a" => {"b" => 3}, "f" => 5}).unnest
p ({"a" => {"b" => {"c" => 4}, "f" => 5}}).unnest 
```

输出：

```
{"a"=>2, "f"=>5}
{"a-b"=>3, "f"=>5}
{"a-b-c"=>4, "a-f"=>5} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-22T05:42:41.467

另一种选择：

```
class Hash
  def smash(prefix = nil)
    inject({}) do |acc, (k, v)|
      key = prefix.to_s + k
      if Hash === v
        acc.merge(v.smash(key + '-'))
      else
        acc.merge(key => v)
      end
    end
  end
end

hash = {
  'f' => 100,
  'z' => {'j' => 25},
  'a' => {'b' => {'c' => 1}}
}

puts hash.smash # => {"f"=>100, "z-j"=>25, "a-b-c"=>1} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T00:51:28.527

解决这个问题的另一种方法不是将散列变平，而是像平展一样访问它。例如，给定这个哈希：

```
h = {
  'a' => 1,
  'b' => {
    'c' => 2,
    'd' => 3,
  },
} 
```

那么这个函数：

```
NESTED_KEY_SEPARATOR = '-'
NESTED_KEY_REGEX = /^(.*?)(?:#{NESTED_KEY_SEPARATOR}(.*))?$/

def nested_fetch(key, hash)
  return hash if key.empty?
  first_part_of_key, rest_of_key = NESTED_KEY_REGEX.match(key).captures
  value = hash[first_part_of_key]
  if value.is_a?(Hash)
    nested_hash_fetch(value, rest_of_key || '')
  elsif rest_of_key
    nil
  else
    value
  end
end 
```

将允许您通过将各个哈希键与 KEY_SEPARATOR 连接在一起来检索嵌套的哈希元素（在此处设置为破折号，但可以是任何在您需要搜索的哈希中从未作为键出现的字符）：

```
p nested_fetch('a', h)      # => 1
p nested_fetch('b-c', h)    # => 2 
```

如果您提供部分限定的密钥，您将获得在该点匹配的哈希：

```
p nested_fetch('b', h)      # => {"c"=>2, "d"=>3} 
```

如果你给出一个不存在的密钥，你会得到 nil：

```
p nested_fetch('b-x', h)    # => nil 
```

如果需要，可以通过简单地将上述代码包含在类 Hash 中，并将 self 作为参数散列的默认值，将其猴子修补到散列上：

```
class Hash
  NESTED_KEY_SEPARATOR = '-'
  NESTED_KEY_REGEX = /^(.*?)(?:#{KEY_SEPARATOR}(.*))?$/

  def nested_fetch(key, hash = self)
  ...
end 
```

# c# - 是否有一种可单元测试的方式将文件上传到 ASP.NET WebAPI？

> ID：12064653
> 
> 赞同：18
> 
> 时间：2012-08-21T23:53:12.100
> 
> 标签：c#, file-upload, tdd, asp.net-web-api

我正在使用新的 ASP.NET WebAPI 的项目中工作。我目前的任务是接受上传的文件。到目前为止，我已经使用 TDD 来驱动 WebAPI 代码，但是我在上传时遇到了麻烦。我目前正在遵循[http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2)上的建议，但似乎没有完全可以将其排除在单元测试之外。为了获取文件和表单数据，我必须使用`MultipartFormDataStreamProvider`，这是无法模拟和/或覆盖的。如果没有放弃我的 TDD 方法，我该怎么办？

这是示例中的代码：

```
public Task<HttpResponseMessage> PostFormData()
{
    // Check if the request contains multipart/form-data.
    if (!Request.Content.IsMimeMultipartContent())
    {
        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
    }

    string root = HttpContext.Current.Server.MapPath("~/App_Data");
    var provider = new MultipartFormDataStreamProvider(root);

    // Read the form data and return an async task.
    var task = Request.Content.ReadAsMultipartAsync(provider).
        ContinueWith<HttpResponseMessage>(t =>
        {
            if (t.IsFaulted || t.IsCanceled)
            {
                Request.CreateErrorResponse(HttpStatusCode.InternalServerError, t.Exception);
            }

            // This illustrates how to get the file names.
            foreach (MultipartFileData file in provider.FileData)
            {
                Trace.WriteLine(file.Headers.ContentDisposition.FileName);
                Trace.WriteLine("Server file path: " + file.LocalFileName);
            }
            return Request.CreateResponse(HttpStatusCode.OK);
        });

    return task;
} 
```

第一个问题是这一行：

```
var provider = new MultipartFormDataStreamProvider(root); 
```

对于初学者，要对这段代码进行单元测试，我需要能够注入这样的提供程序。在那个简单的构造函数调用中，它确实太多了，以至于“更新它”。一定有别的办法。（如果不是，WebAPI 失败）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T13:38:23.097

我抽象出了一个提供者包装器，这样我就可以模拟那些移动的部分，比如

```
 public interface IMultiPartFormDataStreamProviderWrapper : IDependency
    {
        string LocalFileName { get; }
        MultipartFormDataStreamProvider Provider { get; }
    }

    public class MultiPartFormDataStreamProviderWrapper : IMultiPartFormDataStreamProviderWrapper
    {
        public const string UploadPath = "~/Media/Default/Vocabulary/";
        private MultipartFormDataStreamProvider provider;

        public MultiPartFormDataStreamProviderWrapper(IHttpContextAccessor httpContextAccessor)
        {
            provider = new CustomMultipartFormDataStreamProvider(httpContextAccessor.Current().Server.MapPath(UploadPath));
        }

        public string LocalFileName
        {
            get { return provider.FileData[0].LocalFileName; }
        }

        public MultipartFormDataStreamProvider Provider
        {
            get { return provider; }
        }
    } 
```

所以我可以做类似的事情

```
 if (Request.Content.IsMimeMultipartContent())
    {
        return Request.Content.ReadAsMultipartAsync(provider.Provider).ContinueWith(t => 
                    {
                        if (t.IsCanceled || t.IsFaulted)
                            return (object)new { success = false }; 
```

不理想，但给人一些印象。你怎么看？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T16:41:16.807

如果您还没有放弃 Web API，您可以尝试[System.Net.Http.TestableMultipartStreamProviders](https://github.com/ladenedge/TestableMultipartStreamProviders)，这是对 Microsoft 流提供程序的直接重写。它们的好处是它们依赖[SystemWrapper](http://systemwrapper.codeplex.com/)进行文件操作，这意味着可以在单元测试中模拟文件操作。[wiki](https://github.com/ladenedge/TestableMultipartStreamProviders/wiki)提供了一些关于利用 DI 使测试控制器不那么痛苦的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-24T06:58:32.437

如果您使用[自托管](http://code.msdn.microsoft.com/ASPNET-Web-API-Self-Host-30abca12)功能，您可以编写一个单元测试：

*   启动控制器（以及各种其他格式化程序/过滤器/等）
*   使用 HttpClient （或个人，我会使用[RestSharp](http://restsharp.org/)）将文件提交到该控制器（使用 RestSharp，您可以使用该`AddFile`函数来执行此操作）
*   验证您想要的输入流（例如，通过覆盖提供程序或仅检查传递给测试控制器或其他东西的值）

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-12T19:21:13.900

答案是不”。ASP.NET 是一个基于继承的框架。如果您尝试编写基于组合的应用程序，您将在某些时候发现摩擦和障碍。是时候切换到像[Nancy](http://nancyfx.org)这样的东西了。

# python - 在 Python 中跨多个文件连接到 MySQL 的最有效方法是什么？

> ID：12064654
> 
> 赞同：4
> 
> 时间：2012-08-21T23:53:14.683
> 
> 标签：python, mysql

我有一个跨多个文件的 Python 应用程序，一个主应用程序和（我们称之为 main.py）和几个由 main.py 导入的模块（我们称之为 module_a.py 和 module_b.py）

跨所有这些文件连接到 MySQL 数据库的最有效方法是什么？

我应该单独创建一个模块*database.py*，连接到该模块中的数据库，然后将该模块导入每个文件，然后使用：

```
//database.py
db=MySQLdb.connect(host="localhost",user="xxx",passwd="yyy",db="zzz")

//main.py
import database
cur = database.db.cursor()

//module_a.py
import database
cur = database.db.cursor() 
```

或者我应该分别连接到每个文件中的数据库吗？

或者也许还有其他选择，甚至更适合这个目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:00:12.197

在我看来，database.py 可以通过连接池来解决问题（您可能唯一要寻找的东西是什么？Amirite？）

# memcached - spymemcached 客户端：如何提高 get 方法的速度

> ID：12064661
> 
> 赞同：0
> 
> 时间：2012-08-21T23:54:16.817
> 
> 标签：memcached

我正在使用 spymemcached 客户端并遵循以下教程

[http://code.google.com/p/spymemcached/wiki/SpringIntegration](http://code.google.com/p/spymemcached/wiki/SpringIntegration)

在下面的代码中，我在缓存中设置了 10 个对象

```
 for (int i = 0; i <  10; i++) 
        memcache.set(Integer.toString(i), 86400, "this is a test " + i); 
```

但是当我试图用

```
 for (int i = 0; i <  10; i++) {
        memcache.get(Integer.toString(i)); 
```

令我惊讶的是，这需要相当长的时间。我想知道如何优化我想从缓存中检索的对象的速度。

我也尝试过[http://code.google.com/p/spymemcached/wiki/Examples](http://code.google.com/p/spymemcached/wiki/Examples)但它没有帮助。

我有四个盒子用作 memcached 服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:29:20.830

您可以使用 bulkGet() 函数一次发送多个键的请求。还有 asyncGet 和 asyncBulkGet() 调用允许您异步执行这些调用。在您可以发出 get、做一些其他事情，然后检查 get 调用的结果的情况下，异步调用会有所帮助。

# php - 会话变量的问题

> ID：12064664
> 
> 赞同：0
> 
> 时间：2012-08-21T23:54:59.507
> 
> 标签：php, mysql, session

```
<?php
session_name('MYSESSION');
session_set_cookie_params(0, '/~cgreenheld/');
session_start();
?>              

<?php
    if($_SESSION['authorisation'] == 'knownuser') {
       echo '<ul class="log">';
       echo '<li><h4>You are logged in "'.$_SESSION['user'].'"</h4></li>';
       echo '<li><a href="logout.php">Logout</a></li>';
       echo "</ul>";
     } else {
        echo "<h4>You are not logged in</h4>";
     }

     if($_SESSION['authorisation'] == 'knownuser') {
        echo "<ul>";
        echo "<li><h4>You are logged in and already have an account</h4></li>";
        echo '<li><a href="index.php">Return Home</a></li>';
        echo "</ul>";
       } else {

        echo "<form method='post' action='".$_SERVER['PHP_SELF']."'>";
        echo '<fieldset class="login">';
        echo "<h2>Login</h2>";
        echo "<ul>";
        echo '<li><label for="Username"> Username: </label> <input type="text" name="Username" id="Username"></li>';
        echo '<li><label for="Password"> Password: </label> <input type="password" name="Password" id="Password"></li>';
        echo '<li><input type="submit" value="Login"><li>';
        echo "</ul>";
        echo "</fieldset>";
        echo "</form>";
       }
       if ((isset($_POST['Password'])) && $_POST['Password'] != "") {                   
         $conn= new mysqli("localhost", "my_user", "my_password", "world"); //changed for the sake of this question

         $match_Username = '%';
         $match_Password ='';

         if(isset($_POST['Password'])) {
            $clean_Password = mysqli_real_escape_string($conn, $_POST['Password']);
            $match_Password =  sha1($clean_Password);
         }

        if (isset($_POST['Username'])) {
            $clean_Username = mysqli_real_escape_string($conn, $_POST['Username']);
            $match_Username = $clean_Username;
        }

        echo $query = "select * from User WHERE Username = '$match_Username' and Password = '$match_Password';";
        $result = $conn->query($query);

        if ($result->num_rows==1) {
            $_SESSION['authorisation'] = 'knownuser';
            $_SESSION['user'] = $_POST['Username'];
            header("Location: index.php");
            exit;
        } else {
            $_SESSION['authorisation'] = 'unknownuser';
            header("Location: error.php");
            exit;
            }               
        } 
```

这两个 php 选项卡将在此版本中显示它们来自不同的文件。我已经让一个用户登录，当用户登录时，我希望它重定向到首页，并且我希望它显示“您已登录在*此处插入用户名*。Atm 我只得到一个空字符串，并且我不知道为什么。帮助任何人吗？我也知道我没有清理我的输入等等。而且我不断收到关于授权会话变量的错误 [22-Aug-2012 11:32:02] PHP 注意：未定义索引：/devel/cgreenheld/projects/Asgn1/login.php 第 23 行 [22-Aug-2012 11:32:02] PHP 注意：未定义索引：/devel/cgreenheld/projects/Asgn1/login 中的授权第 46 行的 .php 我不太确定那是什么，但如果有人可以为我澄清一下，那就太好了。

23 和 46 出错的行是：

```
if($_SESSION['authorisation'] == 'knownuser') { 
```

这段代码在这里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:26:02.930

好的，我发现了要问的问题。我没有会话用户的 isset，所以它没有检查它。当我开始检查它时，它显示了用户名。感谢大家的帮助，以及对我遇到的授权错误的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:10:38.027

看起来您在会话开始方面有问题。我会假设`session_set_cookie_params(0, '/~cgreenheld/');` 第二个参数有问题。你的页面必须有一个像 www.example.com/~cgreenheld/ 这样的 URL，并且设置和你的一样。或者您可能不包含会话开始所在的 index.php。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T00:17:09.773

那么您的错误来自 $_SESSION['authorisation'] 未设置因此不存在的事实。由于它不存在并且您在第 23 行和第 46 行调用它，因此您会收到这些错误。请注意，最好在调用这些变量之前测试这些变量是否已设置，这样如果它们为空或未设置，您将不会收到这些错误。

`if(!empty($_SESSION['authorisation']))`

所以问题是没有在 login.php 中设置会话变量。我相信您的部分问题可能来自您的 sql 查询后条件中的 header() 调用。需要在编写任何 html 之前发送标头，因此当您在顶部编写表单然后发送标头时，标头将不起作用。尝试将表单的操作更改为单独的页面（例如“authenticate.php”）并将您的 sql 查询和会话设置移动到那里。不要忘记 session_start() 在顶部，并确保你的 header()s 之前没有 html。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T00:03:17.463

正如穆萨指出的那样，你是使命`session_start()`职能。您的通知表明`authorisation`key 中不存在`$_SESSION`，这也表明会话未初始化。

# ios - Ios：当应用程序处于非活动状态时，如何让我的应用程序返回根视图

> ID：12064667
> 
> 赞同：3
> 
> 时间：2012-08-21T23:55:18.060
> 
> 标签：ios, view, uinavigationcontroller, switching, appdelegate

我希望我的应用程序在处于非活动状态时返回登录屏幕（这是导航控制器中的根视图）。

我在 applicationWillResignActive 并且 appdelegate.m 无法识别 self.navigationController

我试图在情节提要中使用 ctrl 拖动在 appdelegate.h 中制作一个插座或导航控制器，但它不会让我这样做。

那么有谁知道如何让它在不活动时切换到特定视图？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T00:00:13.007

当您的应用程序返回时，您可以通过在 applicationWillEnterForeground 或 applicationDidBecomeActive 方法中执行该代码来显示原始 uiviewcontroller

快速代码

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{
    // Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.
    UINavigationController *navigationController = (UINavigationController *)self.window.rootViewController;
    [navigationController popToRootViewControllerAnimated:YES];
} 
```

我确信这不是唯一或最好的方法，但它在技术上是有效的

# c# - “res://*/”中的 * 是什么意思？

> ID：12064672
> 
> 赞同：3
> 
> 时间：2012-08-21T23:55:49.473
> 
> 标签：c#, entity-framework

当我看到类似的东西

`res://*/Some.Name.Space.csdl|res://*/Some.Name.Space.ssdl|res://*/Some.Name.Space.msl`

在实体框架连接字符串中，是什么`*`意思`res://*/`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:58:24.910

它是嵌入式资源的 assemblyFullName 部分的通配符：http: [//msdn.microsoft.com/en-us/library/cc716756.aspx](http://msdn.microsoft.com/en-us/library/cc716756.aspx)

> 如果为 assemblyFullName 指定通配符 (*)，实体框架运行时将按以下顺序在以下位置搜索资源： 调用程序集。
> 
> 引用的程序集。
> 
> 应用程序的 bin 目录中的程序集。
> 
> 如果文件不在这些位置之一，则会引发异常。
> 
> 注意：当您使用通配符 (*) 时，实体框架必须在所有程序集中查找具有正确名称的资源。要提高性能，请指定程序集名称而不是通配符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:01:16.983

请参阅[实体框架连接字符串](http://msdn.microsoft.com/en-us/library/cc716756.aspx)

如果为 assemblyFullName 指定通配符 (*)，实体框架运行时将按以下顺序在以下位置搜索资源：

1.  调用程序集。

2.  引用的程序集。

3.  应用程序的 bin 目录中的程序集。

# java - GWT - 单元格列表框动态内容

> ID：12064673
> 
> 赞同：0
> 
> 时间：2012-08-21T23:55:55.567
> 
> 标签：java, gwt, drop-down-menu, listbox, celltable

我有一个包含 2 列、名称和他拥有的汽车的单元格表。其中一列（汽车）必须是列表框。person 对象将在 celltable 中呈现为一行。列表框将显示该人拥有的汽车的名称。可以说，

```
人杰克有 3 辆车（Merc、BMW、Honda）
人吉尔有 2 辆车（Mini Cooper、Toyota Rav4）

```

我看过这个展示，它实现了一个带有固定类别的下拉菜单。但我所拥有的是一个下拉列表，其内容将取决于 Person 对象的内容。

我还想捕捉用户在下拉菜单中选择其中一辆车时的事件。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T15:16:37.627

AFAIK`CellWidgets`不提供支持开箱即用的动态列表的单元格类型。
但是，您可以通过自己派生`AbstractCell`和实现功能来实现自己的自定义单元。[有关更多信息](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCustomCells)，请参阅 GWT 文档。

我会尽量避免从自定义单元格内部进行后端调用。如果可能，请尝试在 DTO 中添加可用类型的列表，然后从`render`方法中访问该属性。这些方面的东西：

```
public class DynamicSelectionCell extends AbstractCell<MyDTO> {

    @Override
    public void render(Context context, MyDTO value, SafeHtmlBuilder sb) {

      if (value == null) {
        return;
      }
       // render a selectionbox and dynamically add options by accessing the value.getAvailablOptions() 
    }
  } 
```

向您的对象添加一个 getter，`MyDTO`该对象返回特定记录的可用类型（Honda 等），并且在渲染方法中您只需创建一个选择框。
您可以查看[SelectionCell](http://code.google.com/p/google-web-toolkit/source/search?q=SelectionCell&origq=SelectionCell&btnG=Search%20Trunk)如何正确呈现它的代码。

关于您必须实施的事件处理`onBrowserEvent`。有关更多详细信息，请参见[此处](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCustomCells#cell-onBrowserEvent)。

# java - 附加 zip 存档调试

> ID：12064676
> 
> 赞同：0
> 
> 时间：2012-08-21T23:56:56.440
> 
> 标签：java, file, exception, zip, append

所以我对将文件附加到 zip 存档很感兴趣，我遇到了一些以前问过这个问题的用户，另一个用户给出了这个代码片段作为该问题的解决方案：

```
 public static void updateZip(File source, File[] files, String path){
    try{
        File tmpZip = File.createTempFile(source.getName(), null);
        tmpZip.delete();
        if(!source.renameTo(tmpZip)){
            throw new Exception("Could not make temp file (" + source.getName() + ")");
        }
        byte[] buffer = new byte[4096];
        ZipInputStream zin = new ZipInputStream(new FileInputStream(tmpZip));
        ZipOutputStream out = new ZipOutputStream(new FileOutputStream(source));
        for(int i = 0; i < files.length; i++){
            System.out.println(files[i].getName()+"being read");
            InputStream in = new FileInputStream(files[i]);
            out.putNextEntry(new ZipEntry(path + files[i].getName()));
            for(int read = in.read(buffer); read > -1; read = in.read(buffer)){
                out.write(buffer, 0, read);
            }
            out.closeEntry();
            in.close();
        }
        for(ZipEntry ze = zin.getNextEntry(); ze != null; ze = zin.getNextEntry()){
            if(!zipEntryMatch(ze.getName(), files, path)){
                out.putNextEntry(ze);
                for(int read = zin.read(buffer); read > -1; read = zin.read(buffer)){
                    out.write(buffer, 0, read);
                }
                out.closeEntry();
            }
        }
        out.close();
        tmpZip.delete();
    }catch(Exception e){
        e.printStackTrace();
    }
}

private static boolean zipEntryMatch(String zeName, File[] files, String path){
    for(int i = 0; i < files.length; i++){
        if((path + files[i].getName()).equals(zeName)){
            return true;
        }
    }
    return false;
} 
```

我创建了一个小程序来测试这个方法，这是完成所有工作的方法：

```
 private static void appendArchive() {
    String filename = "foo";
    File[] filelist = new File[10];
    int i = 0;
    String temp = "";
    while (!filename.trim().equals("")) {
        System.out
                .println("Enter file names to add, then enter an empty line");
        filename = getInput();
        filelist[i] = new File(filename, filename);
        System.out.println("Adding " + filelist[i].getName());

    }
    System.out
            .println("What is the name of the zip archive you want to append");
    File zipSource = new File(getInput() + ".zip", "testZip.zip");
    try {
        Archiver.updateZip(zipSource, filelist, "");
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

每当我尝试运行该程序时，都会出现此错误，然后是下一个错误：

```
java.lang.Exception: Could not make temp file (testZip.zip)

at Archiver.updateZip(Archiver.java:68)
at main.appendArchive(main.java:62)
at main.main(main.java:29) 
```

我怀疑我传递的 zip 文件由于某种原因被认为是打开的，因此 rename 方法在 Windows 上不起作用，所以我尝试使用您现在看到的 zip 文件的构造函数。我到底在做什么错在这里。我的测试输入是文件 2 和 2（附加到 2.zip ）。它不应该是任何与目录相关的问题，因为文件是由程序生成的。![文件](../Images/019d30fbf110dea8bb012014d8cd2c16.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:55:39.607

为我找工作。我怀疑您可能想检查`tmpZip.delete()`.

```
if (!tmpZip.exists() || tmpZip.delete()) {
    // ... Continue
} else {
    // ... File is locked
} 
```

**更新**

我一直在玩代码，还有一些额外的缺陷......

将旧条目添加到新文件时，您使用的是现有`ZipEntry`条目。如果结果压缩不同，这将失败。您应该创建一个新的`ZipEntry`添加使用，而不是

```
ZipEntry ne = new ZipEntry(ze.getName());
out.putNextEntry(ne);
// Write bytes to file...
out.closeEntry(); 
```

你永远不会关闭`ZipInputStream`这意味着`tmpZip.delete()`最终会失败。

您的错误处理几乎不存在...

```
ZipInputStream zin = null;
ZipOutputStream out = null;
try {
    // Append zip ...
} finally {
    try {
        zin.close();
    } catch (Exception exp) {
    }
    try {
        out.close();
    } catch (Exception exp) {
    }
} 
```

将防止将来的文件锁定（我故意没有抓住它，`IOException`因为我个人认为它应该被扔回被调用者）

在完成之前，您不应覆盖现有的 zip 文件。您应该为新的 zip 文件创建一个临时文件，将所有文件写入其中，附加现有文件，完成后，将现有文件替换为临时文件。

这意味着，如果出现问题，您并没有破坏现有的 zip 文件。

恕我直言

# wpf - 不同的修饰符在 WPF 输入绑定上触发不同的命令

> ID：12064682
> 
> 赞同：1
> 
> 时间：2012-08-21T23:57:50.880
> 
> 标签：wpf, xaml, inputbinding

我在尝试弄清楚如何在 WPF 中的同一鼠标操作上为不同的修饰键触发不同的命令时遇到了麻烦。我开发了一组图形类，我试图让用户在其中选择点。图形对象维护一个选定点的列表，当将点作为参数传递时，命令应该只选择给定的点(SelectPointCommand) 或将点添加到当前选择 (AddPointToSelectionCommand)。

我知道我可以在执行命令时运行的代码中检查 Keyboard.Modifiers 但是我更愿意在相当高的级别提供功能，而不是将其限制为图形对象本身中的某些修饰键，以便可以通过其他方法轻松触发相同的功能，例如。单击一个按钮。

我原以为以下 XAML 会起作用（边框只是实际数据模板的简化，检测鼠标手势没有问题）

```
<Border DataContext="{Binding Point}">
    <Border.InputBindings>
        <MouseBinding Gesture="Ctrl+LeftClick" Command="{Binding Line.Graph.AddPointToSelectionCommand, Mode=Onetime}" CommandParameter="{Binding}" />
        <MouseBinding Gesture="Shift+LeftClick" Command="{Binding Line.Graph.AddPointToSelectionCommand, Mode=Onetime}" CommandParameter="{Binding}" />
        <MouseBinding Gesture="LeftClick" Command="{Binding Line.Graph.SelectPointCommand, Mode=Onetime}" CommandParameter="{Binding}" />
    </Border.InputBindings>
</Border> 
```

使用此 XAML，LeftClick 的 MouseBinding 大部分时间都会被触发，无论按下哪个修饰键。Ctrl+LeftClick 或 Shift+LeftClick 似乎偶尔触发，但没有任何特定模式。我已经尝试在更高级别（和更低级别）定义 LeftClick 鼠标绑定，假设 LeftClick MouseBinding 只会在带有修饰符的更具体的绑定没有触发但它似乎不起作用的情况下才会触发。

从更一般的意义上说，实际上是否可以将具有不同修饰键的相同鼠标操作绑定到不同的命令？我原以为会触发更具体的绑定或在 XAML 中较早定义的绑定，而不是更广泛/后来定义的绑定。

# c# - 纹理出现在侧 面

> ID：12064686
> 
> 赞同：0
> 
> 时间：2012-08-21T23:58:54.657
> 
> 标签：c#, xna

我正在尝试使用类构建一个 Asteroid 类型的 remake，我在这里有一个用于制作船的类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;

namespace AsteroidsTest {
    class Character {
        KeyboardState inputKeyboard;
        Texture2D texture;
        Rectangle rectangle;
        Vector2 position;
        Vector2 origin;
        Vector2 speed;
        const float tangentialVelocity = 5f;
        public float rotation;

        public Character(Texture2D newTexture, int positionX, int positionY) {
            texture = newTexture;
            position = new Vector2(positionX, positionY);

    }
    public void Update(GameTime gametime, Keys KeyUp, Keys KeyRight, Keys KeyLeft) {
        inputKeyboard = Keyboard.GetState();
        rectangle = new Rectangle((int)position.X, (int)position.Y, texture.Width, texture.Height);
        position += speed;
        origin = new Vector2(rectangle.Width / 2, rectangle.Height / 2);
        if (inputKeyboard.IsKeyDown(KeyRight)) {
            rotation += 0.1f;
        } 
        else if (inputKeyboard.IsKeyDown(KeyLeft)) {
            rotation -= 0.1f;
        }
        if (inputKeyboard.IsKeyDown(KeyUp)) {
            speed.X = (float)Math.Cos(rotation) * tangentialVelocity;
            speed.Y = (float)Math.Sin(rotation) * tangentialVelocity;
        } else if (speed != Vector2.Zero) {
            speed = Vector2.Zero;
        }
    }
        public void Draw(SpriteBatch spriteBatch) {
                spriteBatch.Draw(texture, position, null, Color.White, rotation, origin, 1.0f, SpriteEffects.None, 0);
    }
} 
```

}

但是当它使用我的 Main 类在精灵上的纹理下方绘制时，它是正常绘制的，但是当我按下 w 向前移动时，它会将我移动到右侧。当我旋转它时，就好像我的船的顶部在一边，这怎么可能？

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace AsteroidsTest {
    public class Asteroids : Microsoft.Xna.Framework.Game {
        GraphicsDeviceManager graphics;
        SpriteBatch spriteBatch;
        Character Ship;
        Texture2D playerTexture;

        public Asteroids() {
            graphics = new GraphicsDeviceManager(this);
            Content.RootDirectory = "Content";
        }
        protected override void Initialize() {

                base.Initialize();
        }

        protected override void LoadContent() {
            spriteBatch = new SpriteBatch(GraphicsDevice);
            playerTexture = Content.Load<Texture2D>("Actors//Ship");
            Ship = new Character(playerTexture, 16, 16); 
        }

        protected override void UnloadContent() {

        }

        protected override void Update(GameTime gameTime) {

            if (Keyboard.GetState().IsKeyDown(Keys.Escape))
                this.Exit();

            Ship.Update(gameTime, Keys.Up, Keys.Right, Keys.Left);
            base.Update(gameTime);
        }

        protected override void Draw(GameTime gameTime) {
            GraphicsDevice.Clear(Color.Black);
            spriteBatch.Begin();
            Ship.Draw(spriteBatch);
            spriteBatch.End();
            base.Draw(gameTime);
        }
    }
} 
```

编辑：似乎只需将图像顺时针旋转 90 度即可修复它，但不幸的是它默认为该角度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:57:30.137

我想它正在按预期工作-默认情况下（0 Rotation）意味着对象向右而不是向上（相对于您的显示器/屏幕）。

# php - 在本地主机上从 php 发送电子邮件

> ID：12064687
> 
> 赞同：1
> 
> 时间：2012-08-21T23:58:54.890
> 
> 标签：php, email

我正在将 XAMPP 与 Mercury 和 Thunderbird 一起使用。当我通过 Mercury 发送消息时，消息工作正常，并且我在 Thunderbird 上收到了电子邮件。当我尝试使用 PHP 脚本时，它没有。

我确定它与 php 有关，但我无法找到解决它为什么不发送的解决方案。

我也没有收到任何错误，它表示消息已发送。

邮件测试.php：

```
$to = "patrick@localhost";
$subject = "hi";
$body="text".PHP_EOL;
$body.="this message was sent".PHP_EOL;
$headers = "From: postmaster@localhost";

if (mail($to, $subject, $body, $headers)) {
    echo "message sent!";
    } 
    else {
        echo "failed";
    }   
?> 
```

php.ini：

```
[mail function]

; XAMPP: Comment out this if you want to work with an SMTP Server like Mercury
SMTP = localhost
smtp_port = 25

; I am on Windows 7 64bit
; For Win32 only.
; http://php.net/sendmail-from
; sendmail_from = localhost 
```

发送邮件.ini

```
smtp_server=localhost
smtp_port=25 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T00:11:34.380

使用此 sendmail 程序与 SMTP 帐户（如 gmail 帐户）一起使用。这是主要项目站点[http://glob.com.au/sendmail/](http://glob.com.au/sendmail/)，这是来自 SO [https://stackoverflow.com/a/11210090/209067另一个答案的快速方法](https://stackoverflow.com/a/11210090/209067)

这就是我在本地 Windows 环境中使用的东西，我只是找不到我了解它的完整文章教程。

# javascript - Impress js 自动播放幻灯片然后以 ID 结束

> ID：12064689
> 
> 赞同：0
> 
> 时间：2012-08-21T23:59:22.543
> 
> 标签：javascript

我有一个自动播放 Impress JS 的脚本，但我不知道如何在某个 ID 上结束幻灯片，也不知道如何在幻灯片结束后停止循环播放。任何帮助表示赞赏。

```
<script>
  var impress = impress();
  impress.init();
  document.addEventListener('impress:stepenter', function(e){
    if (typeof timing !== 'undefined') clearInterval(timing);
    var duration = (e.target.getAttribute('data-transition-duration') ? e.target.getAttribute('data-transition-duration') : 2000); // use the set duration or fallback to 2000ms
    timing = setInterval(impress.next, duration);
  });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T20:40:43.627

改变

```
timing = setInterval(impress.next, duration); 
```

和

```
if (e.target.id !== 'your_id') {
  timing = setInterval(impress.next, duration);  
} 
```

主持人停下来`your_id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T12:02:17.033

setInterval() 返回一个间隔 ID，您可以将其传递给 clearInterval()。clearInterval 用于停止 setInterval。

这应该工作：

```
 if (currentSlide === 'the_ID_where_you_want_to_end') {
    clearInterval(timing);
    } 
```

# iphone - 警报视图和游戏中心选项出错

> ID：12064693
> 
> 赞同：0
> 
> 时间：2012-08-21T23:59:57.603
> 
> 标签：iphone, gamekit

我正在制作和应用程序并遇到此代码错误：

```
NSString *timemessage = [NSString stringWithFormat:@"Unlucky! You survived for %i seconds!", timenumber];
UIAlertView *alert1 = [[UIAlertView alloc] initWithTitle:@"You've Been Caught!" message:timemessage delegate:nil cancelButtonTitle:@"Try Again" otherButtonTitles:@"Show Leaderboard", @"Submit To Game Center",nil];
[alert1 show];

-(void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)ButtonIndex {
    NSString *buttonTitle = [alertView buttonTitleAtIndex:ButtonIndex];
    if ([buttonTitle isEqualToString:@"Submit To Game Center"]) {
        - (void) reportScore: (int64_t) score forCategory: (NSString*) category
        {
            GKScore *scoreReporter = [[[GKScore alloc] initWithCategory:@"*****"] autorelease];
            scoreReporter.value = score;
            [scoreReporter reportScoreWithCompletionHandler:^(NSError *error) {
                if (error != nil)
                {
                    // handle the reporting error
                }
            }];
        }
    }
    else if ([buttonTitle isEqualToString:@"Show Leaderboard"]){
        - (void) showLeaderboard:
        {
            GKLeaderboardViewController *leaderboardController = [[GKLeaderboardViewController alloc] init];
            if (leaderboardController != nil)
            {
                leaderboardController.leaderboardDelegate = self;
                [self presentModalViewController: leaderboardController animated: YES];
            }
        }
    }
}
-(void) leaderboardViewControllerDidFinish:(GKLeaderboardViewController *)viewController{
    [self dismissModalViewControllerAnimated:YES];
} 
```

所以我面临的问题是：

1.  这些按钮不适用于警报，它们根本不做任何事情。
2.  存在错误“一元表达式的参数类型“无效”无效”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:29:44.543

我确信第一个问题是关于警报代表的。

```
UIAlertView *alert1 = [[UIAlertView alloc] initWithTitle:@"You've Been Caught!" message:timemessage delegate:self cancelButtonTitle:@"Try Again" otherButtonTitles:@"Show Leaderboard", @"Submit To Game Center",nil];
[alert1 show]; 
```

见**代表：自己**

# java - 手动编码 Swing 组件

> ID：12064695
> 
> 赞同：3
> 
> 时间：2012-08-22T00:00:08.287
> 
> 标签：java, swing, user-interface

好的，显然我最近因为使用 NetBeans GUI Builder 而变得懒惰。当我将 JLabel 和 JTextField 添加到我的窗口时，JFrame 不会自行调整大小。我写了一个[SSCCE](http://www.sscce.org)来演示：

```
package swingdemo;

import java.awt.Container;
import java.awt.FlowLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JTextField;

public class SwingDemo {

    public static void main(String[] args) {
        JFrame frame = new JFrame("Swing Demo");
        Container contentPane = frame.getContentPane();
        JLabel label = new JLabel("Demo Label");
        JTextField textField = new JTextField();

        contentPane.setLayout(new FlowLayout());
        contentPane.add(label);
        contentPane.add(textField);

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
    }
} 
```

我在这里想念什么？我知道这很简单。我需要在我的 JLabel 和 JTextField 上调用 setPreferredSize() 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T00:03:38.980

`frame.pack()`在代码末尾调用

javadoc 说：

“导致此窗口的大小调整为适合其子组件的首选大小和布局......”

# facebook-c#-sdk - Facebook C# SDK 是否支持 Windows Phone 7.5 上的异步/等待？

> ID：12064697
> 
> 赞同：0
> 
> 时间：2012-08-22T00:00:13.723
> 
> 标签：facebook-c#-sdk, async-await

所以我正在编写一个 Windows Phone 7.5 应用程序。

我使用 nuget 获得了 Facebook C# SDK 的 6.0.10.0 版本。

从我在网上阅读的内容看来，我应该能够做到以下几点......

```
var fb = new FacebookClient();
dynamic r = await fb.GetTaskAsync("4"); 
```

但是，我不认为**GetTaskAsync**是 FacebookClient 的一种方法。我只是得到通常的**GetAsync**方法。

在 Windows Phone 7.5 上使用 Facebook C# SDK 时 async/await 是否不起作用？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:17:20.963

简短的回答：

[http://csharpsdk.org/docs/known-issues](http://csharpsdk.org/docs/known-issues)

> 您不能在 Windows Phone 上使用 TPL，因此 Facebook C# SDK 在 Windows Phone 构建中不包含依赖于 TPL 的方法。

更长的答案：

源代码在 github 上，因此我们可以更具体地研究为什么该方法没有出现。

[https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/tree/master/Source/Facebook](https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/tree/master/Source/Facebook)

列出的 csproj 文件仅显示 WP7 的目标（不是 WP75 或 WP8），因此，它似乎不能使用 TPL。

*TaskAsync 方法在 FacebookClient.Async.Tasks.cs 的部分类中实现，因此，它在 WP7 版本中不受支持，因为该源文件不包含在 csproj 中。

[https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/blob/master/Source/Facebook/FacebookClient.Async.Tasks.cs](https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/blob/master/Source/Facebook/FacebookClient.Async.Tasks.cs)

也就是说，如果您愿意自己构建 facebook SDK，您可以只为[PortableTPL安装](http://portabletpl.codeplex.com/)[nuget 包](http://www.nuget.org/packages/PortableTPL)，然后在 csproj 中包含该部分类（不知道，没试过它）

# javascript - Onchange 事件未触发到任何 JS 函数

> ID：12064698
> 
> 赞同：0
> 
> 时间：2012-08-22T00:00:16.860
> 
> 标签：javascript, ajax, drop-down-menu, dom-events, onchange

我正在尝试将下拉菜单中的一个选项发送到 Javascript 函数，以便我可以通过调用 PHP 函数来使用 AJAX 查询数据库。不幸的是，似乎我的`onchange`事件根本没有触发。我试图将`onchange`事件重定向到一个简单的 Javascript 函数只是为了测试，但这也不起作用。我这辈子都想不通。下面附上我的示例代码（HTML 和示例测试 Javascript 函数）：

HTML：

```
 <div id="Category_and_Food">
            <form>
                <select id="categories" onchange="tested()">
                    <option value = "">Please select a category</option>
                    <option value="Appetizers">Appetizers</option>
                    <option value="Entree">Entree</option>
                    <option value="Specials">Specials</option>
                    <option value="Drink">Drinks</option> 
                    <option value="Meat">Meat</option>
                    <option value="Soup">Soup</option>
                </select>
            </form>
        <br />
        <div id="cat_display"><b>Please select a category above</b></div>   
    </div> 
```

Javascript：

```
<script type = "text/javascript">
function tested()
{
var x = document.getElementById("categories").value;
document.getElementById("cat_display").innerHTML = x;
{
</script> 
```

之前，我还使用反映更改输入的函数测试了这个`onchange`函数。`onchange="tested(this.value)"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:02:45.997

你有一个倒退`}`：

```
function tested()
{
    var x = document.getElementById("categories").value;
    document.getElementById("cat_display").innerHTML = x;
} // <---- 
```

**示例：http:** [//jsfiddle.net/L2abu/1/](http://jsfiddle.net/L2abu/1/)

请务必通过[JSHint 之](http://www.jshint.com/)类的工具运行代码以检查语法错误。

# php - 使用多个字符串的 if 语句 PHP

> ID：12064704
> 
> 赞同：1
> 
> 时间：2012-08-22T00:01:18.783
> 
> 标签：php, string, if-statement

如何使用两个或多个字符串？

这就是我用来做一个字符串的方法。

```
if ($input == "test")
{
    echo "$imput is equal to test.";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T00:05:28.667

如果我对您的理解正确，那么如果您有很多要比较的字符串，这样的方法可能效果最好。

```
$string = array("foo", "bar", "hello", "world");
foreach ($string as $s) {
    if ($input == $s) {
        echo "$input is equal to $s";
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T00:05:25.183

我想这就是你要找的：

```
if ($input == "test" && $input2 == "hello")
{
    echo "$input is equal to test and input2 is equal to hello.";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T00:05:20.837

您的意思是如何检查两个字符串是否包含某个值？

如果是这样，只需使用 &&：

```
if($input == "test" && $input2 == "test") { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T11:28:53.843

然后你可以使用

```
foreach ($dataarray as $string) {
   if ($input == $string) {
       echo "Match Found";
       break;
    }
 } 
```

如果在数组 $dataarray() 中找到字符串，则返回 Match Found；

# html - 未完全实现时如何使用新的 HTML5 标签？

> ID：12064705
> 
> 赞同：0
> 
> 时间：2012-08-22T00:01:20.883
> 
> 标签：html

我已经对新的 HTML5 标签进行了一些尝试，并在 W3cschools 等处阅读了所有新标签，我有点困惑。

如果我创建一个使用“区域”、“部分”、“旁白”等的 HTML 页面。什么也没有发生？我必须手动设置它们的样式 - 这很好，但我错过了什么吗？如果我必须将标签声明为“旁白”（常见的 css：float:right;width:30%，sorta thing），那么将它声明为“旁白”有什么意义？
为什么不只保留 DIV 标签并为其设置样式？

我还注意到新属性，例如“可拖动”，但是，令人惊讶的是，它不会拖动！我也必须对其进行编码以拖动（javascript/jquery??）？声明它可拖动有什么意义？我可以创建一个 div 标签并使用 JQuery 拖动它，所以有人请告诉我什么是关于 html5 的“whoopty doo”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T00:13:27.100

这就是 Web 相对于 HTML 的变化方式。

1.  浏览器制造商创建了第一个新标签，供高级用户试用。

2.  然后将它们添加到标准中

3.  然后它们实际上在各种浏览器和设备中实现。

4.  然后它们变得广泛而有用。

5.  然后它们变得通用并被 99.9% 的设备实现。

对于提到的标签，它们可能在第 2 步和第 3 步之间

它可能不是“whoopty doo”，但这就是这个系统发生变化的方式

接受、拥抱和使用这种演变模式的开发人员有助于推动这一过程。
有点禅意。

此外，正如 Aaron 在上面的评论 (+1) 中指出的那样，这些特定标签是用于组织/大纲和搜索引擎、屏幕阅读器等的语义标签。所以你自己可能看不到他们的太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:49:53.857

可能不是这样，但至少我知道我不时犯这个错误。不要忘记包括在顶部`<!DOCTYPE html>`。此外，并非所有浏览器都支持 HTML5，但我相信因此请确保您使用的浏览器版本支持它（尽管现在大多数浏览器都应该支持它）。

# eclipse - 无法在 Eclipse 中安装 SVN 连接器

> ID：12064706
> 
> 赞同：4
> 
> 时间：2012-08-22T00:01:23.627
> 
> 标签：eclipse, svn, eclipse-plugin, eclipse-juno

我正在运行 Eclipe Juno 并尝试安装 SVN，我包含了[http://www.eclipse.org/subversive/latest-releases.php](http://www.eclipse.org/subversive/latest-releases.php)提供的所有 svn jar 。
当我尝试安装时，在选择连接器安装屏幕时出现错误。

`Problms occured while performing installation: HTTP Server Unknown HTTP Response Code (-1):http://community.polarion.com/projects/subversive/download/eclipse/3.0/juno-site/context.xml`

已解决：
问题是我无法更改的互联网阻止例外规则，因此我现在使用的是 subclipse 而不是颠覆。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:16:09.420

我的解决方案是不使用 Subversive，而是使用[Subclipse](http://subclipse.tigris.org/)。工作正常。

因此，我建议任何其他面临此问题的人检查您的防火墙规则/传出异常规则。对我来说，我无法更改这些，因为我无法控制防火墙。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-01T07:11:58.363

您提到的更新 [http://download.eclipse.org/technology/subversive/1.1/update-site](http://download.eclipse.org/technology/subversive/1.1/update-site) 对我来说很好。谢谢，我可以安装插件。

[http://download.eclipse.org/technology/subversive/0.7/update-site/](http://download.eclipse.org/technology/subversive/0.7/update-site/) 这实际上不起作用。

# hadoop - HBase 中的压缩

> ID：12064709
> 
> 赞同：4
> 
> 时间：2012-08-22T00:01:56.877
> 
> 标签：hadoop, hbase

我正在使用 HBase 存储大量传感器数据。

我尝试使用 txt 文件来存储我的传感器数据，对于 20MB 的文件，如果我压缩它，它会在磁盘上减少到 1MB。

我的问题是：将数据存储到磁盘时，HBase 本身是否会自动进行压缩？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:25:38.113

您可以使用 lzo、gzip 或 snappy 进行 hbase 压缩。如果您希望将它们用于 hbase 压缩（包括 gzip），您需要自己设置 lzo/snappy。

通常 - lzo 比 gzip 压缩快，尽管 gzip 压缩比通常更好。Snappy 在压缩方面很强大，但压缩比通常更差。

创建表时 - 您可以指定压缩/压缩库 - 如果使用压缩，则 hfiles 在写入磁盘时会被压缩（并且在读取时需要解压缩）。

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T06:15:09.010

您还可以稍后更改表以添加压缩支持。然后你的数据将在下一次压缩时被真正压缩（正如阿里所说，因为一个新的 HFile 将被写入磁盘）。据我了解，压缩算法用于块级，而不是整个 HFile。这意味着在读取数据时，它不必解压缩几个 GB 的 HFile，而只需解压缩几个 KB 的数据块。

# html - IE9 忽略 inline-block 属性

> ID：12064712
> 
> 赞同：0
> 
> 时间：2012-08-22T00:02:40.273
> 
> 标签：html, internet-explorer-9

IE9 完全忽略了 inline-block 属性。包括 IE8 在内的所有其他浏览器都可以正常工作。我一无所知。

万一有人问起我正在使用的 DOCTYPE，它看起来像`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">`

但我试过了`<"-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">`

以及相同的结果

[网站](http://www.webintelligence.ie)

# c++ - 用向量插入地图的值

> ID：12064717
> 
> 赞同：1
> 
> 时间：2012-08-22T00:03:14.533
> 
> 标签：c++, map, vector

我有以下地图：

`std::map<u_long, std::vector<CChatContainer*> >m_Container;`

```
class CChatContainer
{
public:
    CChatContainer()
    {
        m_uStartPos = 0;
        m_uEndPos = 0;
        m_dwColor = NULL;
        m_pItemElem = NULL;
    }
    ~CChatContainer(){};

    u_long m_uStartPos;
    u_long m_uEndPos;
    DWORD m_dwColor;
    void* m_pItemElem;
}; 
```

如何在其中插入值，向量部分对我来说似乎很复杂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:19:43.450

例子：

```
u_long j = 2; // get index in the map - where to insert
std::vector<CChatContainer*> conts; // create container to insert
for( int i = 0; i < N; i++ ) { // fill the container
  CChatContainer* new_cont = new CChatContainer;
  cont.push_back(new_cont);
}

m_Container[j] = conts; // insert 
```

# php - php: preg_match 返回 false

> ID：12064719
> 
> 赞同：0
> 
> 时间：2012-08-22T00:03:15.767
> 
> 标签：php

那是我的`preg_match`代码：

```
 if (strlen($str) > 0)
        if (!preg_match('/(http:\/\/www.vbox7.com[^\"]*)/', $str))
            return false;

    return true;

$str = 'http://vbox7.com/play:5ee7f7f6bf'; 
```

但为什么总是返回假？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:11:22.723

首先，您的正则表达式不会检测到您的 URL，因为它会显式查找“www”字符串。或者，您可以尝试：

```
preg_match('/(http:\/\/[www.]{0,1}vbox7.com[^\"]*)/', $str) 
```

此外，您可能希望将 $str 设置在顶部，而不是底部。

# css - IE7中的DIV，不知何故忽略了宽度占用剩余空间

> ID：12064722
> 
> 赞同：-1
> 
> 时间：2012-08-22T00:03:35.660
> 
> 标签：css, internet-explorer, html, internet-explorer-7

让我为大家快速介绍一下：

在 Internet Explorer 7 中访问[http://chetanreddy.com/chat/ 。](http://chetanreddy.com/chat/)

请注意，单个单词后面有很多空格。除了 IE7 之外的所有版本都可以正常工作。感谢您的帮助。

如果你想编辑它：http: [//jsbin.com/eribuf/3/edit](http://jsbin.com/eribuf/3/edit)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T06:09:51.740

好的，对于初学者来说，您需要在其中一个背景框上设置一个最小高度，因为它会破坏您的渐变：

```
.wBoxTall .right, .gBoxTall .right {min-height: 29px;}
.wBoxTall .bottom .right, .gBoxTall .bottom .right {min-height: 0;} 
```

每当您在 IE7 中遇到问题时，您应该尝试的第一件事是赋予元素 hasLayout - 这是一个奇怪的小错误，这意味着有时您的样式无法正常工作。指定定位通常也很有用。试试这个：

```
.wBoxTall, .gBoxTall {zoom:1; position:relative} 
```

# html - .htaccess 移除扩展

> ID：12064724
> 
> 赞同：0
> 
> 时间：2012-08-22T00:03:41.430
> 
> 标签：html, .htaccess

我的 .htaccess 文件有一些问题，我在其中放置了删除文件扩展名的代码，所以它看起来像这样：www.foo.com/x，它适用于我的所有页面。但是，当我使用导航栏时，它不起作用。我已经将每个页面上的 URL 更改为 www.foo.com/x，所以我对我的问题可能是什么感到困惑。这是我的 .htaccess 文件中的代码：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)\.html$ /$1 [L,R=301] 
```

这是我的导航条码：

```
 <ul id="menu">
            <li><a href="http://www.foo.com/" class="active">Home</a></li>
            <li><a href="http://www.foo.com/projects">Projects</a></li>
            <li><a href="http://www.foo.com/about">About</a></li>
            <li><a href="http://www.foo.com/contact">Contact</a></li>
 </ul> 
```

我可能会添加 www.foo.com/projects 等工作正常并转到正确的页面，如果这不明显，我的 .htaccess 文件也在根文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:36:04.907

Your original rules are going to cause a loop if you try to internally rewrite them back. For example, if you start off with the URI `/some/file.html`

1.  Browser requests `/some/file.html`
2.  `RewriteRule ^(.*)\.html$ /$1 [L,R=301]` matches, browser is redirected to `/some/file`
3.  Browser requests `/some/file`
4.  Internal rewrite to `/some/file.html`
5.  Rewrite engine loops, first rule matches again, browser is redirected to `/some/file`
6.  repeat from #3

So you need to match against the actual request for your first rule:

```
RewriteEngine On
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^\ ]+)\.html
RewriteRule ^ /%1 [L,R=301] 
```

This does the redirect, in case you have links that still go to the .html files, now you need to internally rewrite them back to html files:

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+)$ /$1.html [L] 
```

If all of your links already have the .html part removed, then you won't need the first rule at all.

# macos - dyld：DYLD_ 环境变量被忽略，因为主可执行文件 (/usr/bin/sudo) 是 setuid 或 setgid

> ID：12064725
> 
> 赞同：48
> 
> 时间：2012-08-22T00:03:43.593
> 
> 标签：macos, command-line, sudo, osx-mountain-lion, dyld

自从更新到 10.8 后，在尝试执行 sudo 命令时出现以下错误，这很烦人。

```
dyld: DYLD_ environment variables being ignored because main executable (/usr/bin/sudo) is setuid or setgid 
```

那是什么意思？我希望任何人都可以提供帮助。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-08-22T12:39:53.190

这似乎是 10.8 中引入的错误，请参阅[此报告](http://openradar.appspot.com/11894054)。据我所知，唯一的解决方法不是默认设置 DYLD_LIBRARY_PATH 或 LD_LIBRARY_PATH，而是仅在需要时设置。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-26T15:49:03.533

在 zsh 中：

```
sudo () { ( unset LD_LIBRARY_PATH DYLD_LIBRARY_PATH; exec command sudo $* ) } 
```

这会生成一个子 shell，其中 sudo 抱怨的环境变量未设置，然后执行 sudo（通过 exec 以便现在不需要的父 shell 立即退出）。

我将把它作为练习留给读者移植到 bash 等。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-17T02:00:19.257

不知道官方的解决方案在哪里，但我用这个 bashrc hack 解决了它，因为我无法再看到那个该死的警告。

# 把它放在 /etc/bashrc 或者你住的任何地方。

```
# set DYLD_* for my normal programs
DYLD_LIBRARY_PATH='..'

# set an alternative sudo
thesudo()
{
# back up the DYLD_* variables
local BACK=$DYLD_LIBRARY_PATH
# unset DYLD_*
unset DYLD_LIBRARY_PATH
# calling sudo
/usr/bin/sudo "$@"
# restore DYLD_* after sudo finished
export DYLD_LIBRARY_PATH=$BACK
}

# redirect sudo
alias sudo=thesudo 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-22T09:21:24.737

那些使用 django（python for web），通过 MySQLdb（Mysql-Python 模块）使用 mysql 的人需要该变量集。所以我现在只保留警告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-23T18:31:08.593

这个问题最终在 OS X Mavericks (10.9) 上得到修复，该消息不再出现在 sudo 上。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-09T23:07:52.787

似乎已经提到的“修复”只是可能不适用于所有用户的变通方法。这是Apple（至少）知道的一个已知错误：http: [//openradar.appspot.com/11894054](http://openradar.appspot.com/11894054)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-01-04T20:22:42.977

不确定这是否是一个真正的修复，但是当我运行 Clean Build Folder 时这个错误消失了

# java - 如何更新 JavaFX LineChart 数据

> ID：12064727
> 
> 赞同：2
> 
> 时间：2012-08-22T00:03:51.040
> 
> 标签：java, javafx-2

我使用 JavaFX LineChart 来显示服务器性能，我希望使用从服务器获取的数据动态更新图表。

如何在图表中添加新数据并在图表中始终保持相同的时间范围（在我的情况下，时间是 X 轴），Y 轴是每秒的请求数。

编辑：我使用最新的 JavaFX JDK7u6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T06:48:09.673

获取系列：

```
XYChart.Series<Number, Number> s = lineChart.getData().get(0); 
```

通过删除第一个元素并添加新元素来移动时间范围/范围：

```
s.getData().remove(0);
s.getData().add(new LineChart.Data<Number,Number>(time_from_server, data_from_server)); 
```

# java - alfresco 和 java 应用程序之间的集成

> ID：12064728
> 
> 赞同：0
> 
> 时间：2012-08-22T00:04:08.960
> 
> 标签：java, report, integration, alfresco

我有一个 Java 应用程序，我需要获取位于 Alfresco 的 Jasper 报告。获得报告后，我需要添加一些参数，然后对其进行编译并生成 PDF。

我知道这是可能的，使用 alfresco API 和 Jasper Report API。我在[Java-backed Web Scripts Samples](http://wiki.alfresco.com/wiki/Java-backed_Web_Scripts_Samples#SimpleWebScript.java)中进行了搜索，但我不理解这些示例，因为我是 Alfresco 和 Java 的新手，所以任何线索都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T15:59:30.110

您可能对 Benjamin Rodriguez 的[Jasper Reports Dashlet 感兴趣](http://code.google.com/p/jasperreports-dashlet/)，他在去年的 Dashlet 挑战赛中提交了该文件。dashlet 使得从 Share UI 中配置和运行 Jasper 报告成为可能。这并不完全是您想要做的，但它可能是示例代码的良好来源。

# cocoa - Mountain Lion 通知中心 - 应用程序图标未显示

> ID：12064729
> 
> 赞同：2
> 
> 时间：2012-08-22T00:04:20.663
> 
> 标签：cocoa, icons, nsnotificationcenter

我有一个发送通知的应用程序。应用程序包有一个图标，但该图标未显示在通知中；相反，它显示空白的应用程序图标。我找不到其他人解决这个问题。有任何想法吗？

谢谢

# excel - Excel VBA - 选择动态单元格范围

> ID：12064731
> 
> 赞同：11
> 
> 时间：2012-08-22T00:04:37.813
> 
> 标签：excel, range, vba

我希望能够动态选择一系列单元格（标题行），其中行为 1，但列为 1 到最后一列，其中“A”是第一列，“M”是最后一列柱子。我知道如何找到最后一列，但我不知道如何修改以下范围以将第一列和最后一列输入为“A”和“M”。

```
 Range("A1:M1").Select 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-22T00:23:00.380

如果要选择包含所有标题单元格的变量范围：

```
Dim sht as WorkSheet
Set sht = This Workbook.Sheets("Data")

'Range(Cells(1,1),Cells(1,Columns.Count).End(xlToLeft)).Select '<<< NOT ROBUST

sht.Range(sht.Cells(1,1),sht.Cells(1,Columns.Count).End(xlToLeft)).Select 
```

...只要该行上没有其他内容。

编辑：更新以强调在使用它时使用`Range(Cells(...), Cells(...))`它来限定两者`Range`并`Cells`使用工作表参考是一种很好的做法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-02T08:18:33.810

```
sub selectVar ()
    dim x,y as integer
    let srange = "A" & x & ":" & "m" & y
    range(srange).select
end sub 
```

我认为这是最简单的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-22T00:14:01.663

所以这取决于你想如何选择增量器，但这应该有效：

```
Range("A1:" & Cells(1, i).Address).Select 
```

`i`代表您要选择的列的变量在哪里（1=A、2=B 等）。您想改为按列字母执行此操作吗？如果是这样，我们可以调整:)

如果您也希望开始是动态的，您可以试试这个：

```
Sub SelectCols()

    Dim Col1 As Integer
    Dim Col2 As Integer

    Col1 = 2
    Col2 = 4

    Range(Cells(1, Col1), Cells(1, Col2)).Select

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-16T08:03:05.973

我最喜欢使用这种方法，它会自动选择第一列到最后一列正在使用。但是，如果第一行的最后一个单元格或第一列的最后一个单元格为空，则此代码将无法正确计算。检查[链接](https://www.thespreadsheetguru.com/blog/5-ways-to-create-a-dynamic-auto-adjusting-vba-range)以获取其他方法以动态选择单元格范围。

```
Sub DynamicRange()
'Best used when first column has value on last row and first row has a value in the last column

Dim sht As Worksheet
Dim LastRow As Long
Dim LastColumn As Long
Dim StartCell As Range

Set sht = Worksheets("Sheet1")
Set StartCell = Range("A1")

'Find Last Row and Column
  LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row
  LastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column

'Select Range
  sht.Range(StartCell, sht.Cells(LastRow, LastColumn)).Select

End Sub 
```

# asp.net - 以编程方式处理 Elmah 电子邮件 onMailing

> ID：12064733
> 
> 赞同：0
> 
> 时间：2012-08-22T00:04:42.743
> 
> 标签：asp.net, asp.net-mvc, elmah

我对 Elmah 有疑问，我已经覆盖了 Mailing 方法。我希望它在我的应用程序不处于实时模式时处理邮件（基本上不发送）。问题是当我这样做时，当我的 ErrorHandler（在我的 ASP.NET MVC 应用程序中）尝试使用 Elmah 引发异常时，我收到错误：无法访问已处置的对象。对象名称：'System.Net.Mail.MailMessage'。所以我需要想办法解决这个问题。下面的代码：

发邮件方式：

```
public static void ErrorMail_Mailing(object sender, ErrorMailEventArgs e)
        {
            if (!GlobalHelper.IsLiveMode)
            {

                //e.Mail.Dispose();
            }
            else
            {
                MailAddressCollection MAC = new MailAddressCollection();
                foreach (string a in EmailRecipients.Split(','))
                {
                    MAC.Add(a);
                }

                string b = "errors@" + GlobalHelper.AppName + ".com";
                e.Mail.From = new MailAddress(b);
                e.Mail.To.Clear(); // Clears existing mail addresses
                e.Mail.To.Add(MAC.ToString());
                e.Mail.Subject = GlobalHelper.AppName+ " Error: ("+e.Error.Type.Substring(0,10)+") Deployment Level:"+GlobalHelper.DeploymentMode;

            } 
```

错误处理方法：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = true, Inherited = true)]
    public class CustomHandleErrorAttribute : HandleErrorAttribute
    {

        public override void OnException(ExceptionContext context)
        {
            // Bail if we can't do anything; app will crash.
            if (context == null)
                return;
            var ex = context.Exception ?? new Exception("No further information exists.");

            // Can show Data on view page /w this code
            // var data = new ErrorPresentation
            //{
            //  ErrorMessage = HttpUtility.HtmlEncode(ex.Message),
            //  TheException = ex,
            //  ShowMessage = !(filterContext.Exception == null),
            //  ShowLink = false
            //};
            //filterContext.Result = View("ErrorPage", data);

            context.ExceptionHandled = true;

            //Log to Elmah
            ErrorSignal.FromCurrentContext().Raise(ex);

            //Show Custom view page
            context.Result = new ViewResult { ViewName = "Error" };
        }
    } 
```

堆栈跟踪：

```
System.Net.Mail.SmtpException: Failure sending mail. ---> System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'System.Net.Mail.MailMessage'.
   at System.Net.Mail.MailMessage.get_AlternateViews()
   at System.Net.Mail.MailMessage.SetContent()
   at System.Net.Mail.SmtpClient.Send(MailMessage message)
   --- End of inner exception stack trace ---
   at System.Net.Mail.SmtpClient.Send(MailMessage message)
   at Elmah.ErrorMailModule.SendMail(MailMessage mail)
   at Elmah.ErrorMailModule.ReportError(Error error)
   at Elmah.ErrorMailModule.OnError(Exception e, HttpContext context)
   at Elmah.ErrorMailModule.OnErrorSignaled(Object sender, ErrorSignalEventArgs args)
   at Elmah.ErrorSignalEventHandler.Invoke(Object sender, ErrorSignalEventArgs args)
   at Elmah.ErrorSignal.Raise(Exception e, HttpContext context)
   at Elmah.ErrorSignal.Raise(Exception e)
   at MusingMonkey.Utilities.Filters.CustomHandleErrorAttribute.OnException(ExceptionContext context) in C:\Users\William-Business\Desktop\TWB\TWB Central\Projects\MusingMonkey\MusingMonkey\Utilities\Filters\ErrorHandler.cs:line 34
   at System.Web.Mvc.ControllerActionInvoker.InvokeExceptionFilters(ControllerContext controllerContext, IList`1 filters, Exception exception)
   at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__1e(AsyncCallback asyncCallback, Object asyncState)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.Async.AsyncControllerActionInvoker.BeginInvokeAction(ControllerContext controllerContext, String actionName, AsyncCallback callback, Object state)
   at System.Web.Mvc.Controller.<>c__DisplayClass1d.<BeginExecuteCore>b__17(AsyncCallback asyncCallback, Object asyncState)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.Controller.BeginExecuteCore(AsyncCallback callback, Object state)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.Controller.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.<BeginProcessRequest>b__3(AsyncCallback asyncCallback, Object asyncState)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<BeginProcessRequest>b__2()
   at System.Web.Mvc.SecurityUtil.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a()
   at System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f)
   at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action)
   at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust[TResult](Func`1 func)
   at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T07:44:04.883

问题是 ELMAH 正在尝试使用`MailMessage`来发送它，但您已经处理了该对象。对您来说最好的解决方案是不要通过事件来执行此操作，而是通过继承[`ErrorMailModule`](http://code.google.com/p/elmah/source/browse/src/Elmah/ErrorMailModule.cs?repo=1x&name=v1.2-sp2)并覆盖它的[`SendMail`](http://code.google.com/p/elmah/source/browse/src/Elmah/ErrorMailModule.cs?repo=1x&name=v1.2-sp2#655)方法，如下所示：

```
protected override void SendMail(MailMessage mail)
{
    if (!GlobalHelper.IsLiveMode) 
        base.SendMail(mail);
} 
```

然后，您可以继续在`Mailing`事件处理程序中完成其余的工作。

# linux - Linux中的以太网+串口

> ID：12064735
> 
> 赞同：1
> 
> 时间：2012-08-22T00:05:15.830
> 
> 标签：linux, serial-port, linux-device-driver, ethernet

我想在 Linux 中实现一个驱动程序，它有一个以太网堆栈，但在硬件上输出的数据将是一个串行端口。基本上，我想将我的串口注册为以太网驱动程序。有谁知道这是否可能？我希望能够将 IPv6 和/或 UDP 数据包推出串行端口，并以类似的方式通过串行端口接收数据包并将其传递到以太网堆栈。

我不想使用串行到以太网转换器（将串行端口转换为以太网端口的外部硬件）的解决方案，但在我的 PC 本身中有它。

我在串口上尝试了 PPP，它运行良好。我还被告知我可以使用 PPP 进行 FTP、HTTP 等。参考这个 - [http://www.faqs.org/docs/Linux-HOWTO/Serial-Laplink-HOWTO.html](http://www.faqs.org/docs/Linux-HOWTO/Serial-Laplink-HOWTO.html)

我曾尝试使用串行驱动程序从 RealTek 以太网驱动程序中破解代码，但未能获得很大成功。相反，我不知道任何一个堆栈实际上可以做任何有意义的事情。任何建议、指导或教程都会有所帮助。

谢谢阿迪亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T06:25:17.373

您需要回到网络基础知识，我理解您的问题的方式是：“我有一个串行端口，我想使用的是以太网链路”。很抱歉粉碎了你的梦想，但你没有真正的硬件来做到这一点，我会详细说明。

串行连接是需要 3 根线（至少）tx、rx 和接地的物理连接。在逻辑方面，您有一个将二进制数据转换为由离散电压范围表示的信号的 IC。

以太网是第 2 层协议，第 1 层由用于传输信号的技术（同轴电缆、上行、光纤等）提供。正如您现在可能看到的，您需要一组不同的硬件来将逻辑以太网帧转换为一串数字数字，实际上这是呼叫帧。

由于以太网是一种易于使用的协议，因此它已被许多网络运营商实施为首选协议，当然其中最大的协议之一是 PPPoE，您可以通过以太网链路进行 PPP 会话。当然，这也不适用于您的示例，因为您正在尝试相反的方法。

如果您只是在学习并且拥有大量时间，您可以尝试通过串行线路编写自己的以太网成帧器。这意味着您需要在驱动程序中实现 IEEE802.3，然后您需要序列化数据以将其作为位流推送到串行线路上。当然要注意以下缺点：

*   您的驱动程序将无法完全支持以太网，您需要硬件级别的一些支持来实现一些信号（例如，自动协商、CSMA/CD 等）
*   除非您及时回到 115.2kbps 是数据传输的最高速度，否则您的驱动程序将毫无用处

恕我直言，您可以在网络领域为设备驱动程序选择更多令人兴奋的项目。例如，您可以尝试购买 NIC 并从头开始为其开发设备驱动程序，并且您可以优化某些区域。最后，请记住，大多数以太网实现现在都是在硬件中完成的，因此您无需做任何事情，只需在 MAC 上填写一些寄存器，瞧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-11T15:48:48.493

[SLIP](https://en.wikipedia.org/wiki/Serial_Line_Internet_Protocol)和[PPP](https://en.wikipedia.org/wiki/Point-to-Point_Protocol)已经可以满足您的需求。

# c - recv() 函数未接收

> ID：12064740
> 
> 赞同：0
> 
> 时间：2012-08-22T00:05:44.367
> 
> 标签：c, linux, sockets, recv

南非，

我正在尝试创建套接字并从接入点接收数据和日志，当我从 shell 运行代码时，代码工作正常。但是，当我尝试使用运行命令的 execvp 从代码连接到 AP 时

```
sudo iwconfig wlan0 essid "access point name" 
```

recv 函数不再从代码或 shell 中工作，当我运行此命令时似乎某些设置已更改，但我不确定到底发生了什么变化

这就是我创建套接字的方式

```
memset(&proc_addr, 0, sizeof(struct sockaddr_nl));
proc_addr.nl_family = AF_NETLINK;
proc_addr.nl_pid = getpid();            
proc_addr.nl_groups = CN_IDX_IWLAGN;

if (bind(sock_fd, (struct sockaddr *)&proc_addr, sizeof(struct sockaddr_nl)) == -1)
    exit_program_err(-1, "bind");

{
    int on = proc_addr.nl_groups;
    ret = setsockopt(sock_fd, 270, NETLINK_ADD_MEMBERSHIP, &on, sizeof(on));
    if (ret)
        exit_program_err(-1, "setsockopt");
}

while (1)
{
    /* Receive from socket with infinite timeout */
    printf("trying to receive");
    ret = recv(sock_fd, buf, sizeof(buf), 0);
    printf("received");
} 
```

因此，尽管我可以从 AP ping 数据，但只打印了尝试接收然后什么也没有打印

执行代码：

```
string cmd1_connect = "sudo iwconfig wlan0 essid ciscosb_3"; 
string cmd_check = "sudo dhclient wlan0";
 string cmd2_connect = "sudo iwconfig wlan0 essid Cisco13-guest"; 
while(true) { 
if(stream1) { 
shell->runcmd(&m, &cmd1_connect); 
shell->runcmd(&m, &cmd_check); 
} else { 
shell->runcmd(&m, &cmd2_connect); 
shell->runcmd(&m, &cmd_check); } 
```

# c# - 在开发机器上运行 Azure Web 应用程序时出现数据库访问错误

> ID：12064743
> 
> 赞同：4
> 
> 时间：2012-08-22T00:06:45.080
> 
> 标签：c#, sql-server, asp.net-mvc, azure, ef-code-first

我在 Visual Studio 2012 中有一个解决方案，其中包含一个 azure 项目和一个 MVC Web 项目等。Web 项目首先使用实体​​框架代码。数据库是localdb。如果我将 web 项目设置为启动项目，它在本地运行良好。Code First 更改会传播到数据库，并且应用程序在调试时运行良好。如果我将 azure 项目设置为启动项目以在应用程序结构下本地运行，则在登录应用程序并首次访问数据库时出现以下错误。该应用程序在部署到 azure 时运行良好。我可以通过 SQL Server Management Studio 在本地访问数据库。当 Web 应用程序设置为启动项目时，该应用程序可以正常访问数据库。我以为可能是数据库权限，所以我将 localdb 的连接字符串更改为不使用受信任的连接，并在本地数据库中创建了一个具有系统管理员权限的新登录名。同样的错误。

这是连接字符串：

```
connectionString="Data Source=(localdb)\v11.0;Initial Catalog=[Database Name];User ID=[User Name];Password=[Password];Integrated Security=False; MultipleActiveResultSets=True;" 
```

这是错误：

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：50 - 发生本地数据库运行时错误。无法创建自动实例。有关错误详细信息，请参阅 Windows 应用程序事件日志。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T17:36:19.157

我有一个类似的错误。查看应用程序事件日志，我可以看到重复出现两个不同的错误。我用谷歌搜索了他们，发现[这篇博客文章](http://blogs.msdn.com/b/sqlexpress/archive/2011/12/09/using-localdb-with-full-iis-part-1-user-profile.aspx)描述了一个解决方案。显然在 Windows 7 SP1 中，您必须编辑在 %windir%\system32\inetsrv\config\ 中找到的*applicationHost.config并更改*

```
<add name="ASP.NET v4.0" managedRuntimeVersion="v4.0" /> 
```

至

```
<add name="ASP.NET v4.0" autoStart="true" managedRuntimeVersion="v4.0" managedPipelineMode="Integrated">
<processModel identityType="ApplicationPoolIdentity" loadUserProfile="true" setProfileEnvironment="true" />
</add> 
```

我这样做了，但它仍然无法正常工作。我看到我有使用 GUIDS 命名的网络服务，我向它们添加了相同的属性。在我回收所有应用程序池后，问题就解决了。

希望这可以帮助。也许有更多知识的人可以解释这一切背后的原因。

# php - $(this).next() 的问题

> ID：12064747
> 
> 赞同：0
> 
> 时间：2012-08-22T00:06:59.930
> 
> 标签：php, javascript, jquery, html, ajax

出于某种原因，只有保存按钮显示在编辑单击上...不知道为什么我的取消按钮有问题...？下面是我的代码

```
$(".editlink").on("click", function(e){
    e.preventDefault();
      var dataset = $(this).prev(".datainfo");
      var savebtn = $(this).next(".savebtn");
      var cancelbtn = $(this).next(".cancelbtn");

      $(this).css("display", "none");
      cancelbtn.css("display", "block");
      savebtn.css("display", "block");     
}); 
```

这是我的整个 HTML 页面：

```
<div id="wrapper">
  <section id="core">
      <div class="profileinfo">

          <div class="gear">
              <label>Primary E-Mail:</label>
              <span id="email_address" class="datainfo"><?php echo $row['email_address'] ?></span>
              <a href="#" class="editlink">Edit Info</a>
              <a class="savebtn">Save</a>
              <a class="cancelbtn">Cancel</a>
          </div>

          <div class="gear">
              <label>First Name:</label>
              <span id="first_name" class="datainfo"><?php echo $row['first_name'] ?></span>
              <a href="#" class="editlink">Edit Info</a>
              <a class="savebtn">Save</a>
              <a class="cancelbtn">Cancel</a>
          </div>

          <div class="gear">
              <label>Last Name:</label>
              <span id="last_name" class="datainfo"><?php echo $row['last_name'] ?></span>
              <a href="#" class="editlink">Edit Info</a>
              <a class="savebtn">Save</a>
              <a class="cancelbtn">Cancel</a>
          </div>

          <div class="gear">
              <label>About Me:</label>
              <span id="about_me" class="datainfo"><?php echo $row['about_me'] ?></span>
              <a href="#" class="editlink">Edit Info</a>
              <a class="savebtn">Save</a>
              <a class="cancelbtn">Cancel</a>
          </div>

          <div class="gear">
              <label>Interests:</label>
              <span id="interests" class="datainfo"><?php echo $row['interests'] ?></span>
              <a href="#" class="editlink">Edit Info</a>
              <a class="savebtn">Save</a>
              <a class="cancelbtn">Cancel</a>
          </div>
      </div>
  </section> 
```

由于某种原因，我尝试过的一切都没有奏效。我可以让一个标签/字段工作，但是当我的 html 中有多个类似上面的内容时，会显示取消按钮。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T00:11:55.093

`next()`如 jQuery Docs 中所述：

> 获取匹配元素集中每个元素的**紧随其后的兄弟**。如果提供了选择器，则仅当它与该选择器匹配时，它才会检索下一个兄弟。

尝试使用[`siblings()`](http://api.jquery.com/siblings/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:02:07.957

你可以尝试这样的事情：

```
var cancelbtn = $(this).parent().find('a.cancelbtn'); 
```

[查看工作示例](http://jsfiddle.net/EdrEw/7/)

# c# - MVC3 路由奇怪的行为

> ID：12064752
> 
> 赞同：2
> 
> 时间：2012-08-22T00:07:38.890
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我发现路由有些奇怪...

我正在 Visual Studio Web Express 2012 中测试 MVC3 应用程序

*   我创建了一个新的 MVC3 应用程序来隔离问题
*   我在默认路由之前添加了以下路由：

    ```
     routes.MapRoute(
            "default_localization",
            "{language}/{country}/{controller}/{action}/{id}",
            new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        ); 
    ```

*   然后没有任何其他更改（创建项目后没有任何区域，只有初始文件），我运行了应用程序，乍一看一切正常。由于它是一个新应用程序，因此页面顶部有两个链接：

    *   家
    *   关于

操作链接如下所示：

```
<li>@Html.ActionLink("Home", "Index", "Home")</li>
<li>@Html.ActionLink("About", "About", "Home")</li> 
```

然后这就是正在发生的事情：

*   当浏览器 URL 为：`http://localhost:54870/`

    *   主页链接是：`http://localhost:54870/`
    *   关于链接是：`http://localhost:54870/Home/About`

    HTML

    ```
    <li><a href="/">Home</a></li>
    <li><a href="/Home/About">About</a></li> 
    ```

    哪个没问题

*   **但点击 About 链接后**，浏览器 URL 为：`http://localhost:54870/Home/About`

    *   主页链接变为：`http://localhost:54870/Home/About`
    *   关于链接变为：`http://localhost:54870/Home/About/Home/About`

    即使链接混乱，他们仍然会执行正确的操作。

    HTML

    ```
    <li><a href="/Home/About">Home</a></li>
    <li><a href="/Home/About/Home/About">About</a></li> 
    ```

如果我删除我的自定义路由，一切都会按预期工作

*   为什么会这样？

*   我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T08:38:25.637

我刚发现问题

**基本上我阅读了几篇路由文章，最后我明白了，我的问题是我的自定义路由总是在我点击 About 链接后被**拾取

 **为什么？

让我们考虑一下：

当我的 URL 为 时`http://localhost:54870/`，我的自定义路由没有被选中，因为我没有 {language} 和 {country} 的默认值，因此我的路由不匹配

但是，当我的 URL 是`http://localhost:54870/Home/About`我的自定义路由时，我的自定义路由**总是被选中，**因为路由引擎*假设 Home/About 是 {language} 和 {country} 段*，并且因为我有 {controller} 和 {action} 的默认值，所以路由只是一个匹配

好吧，我吸取了教训，我学到了更多关于路由的知识。将来我计划[在定义路线时遵循 KISS 原则](http://odetocode.com/blogs/scott/archive/2010/01/25/kiss-your-asp-net-mvc-routes.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:43:15.427

尝试用以下内容替换您的路线：

```
routes.MapRoute(
    "default_localization",
    "{language}/{country}/{controller}/{action}/{id}",
    new { language = "en", country = "US", controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

看看这是否有效。

希望这对您有所帮助。**

# iphone - 获取时间间隔并在目标 C 中播放声音

> ID：12064754
> 
> 赞同：0
> 
> 时间：2012-08-22T00:08:06.093
> 
> 标签：iphone, objective-c, ios, xcode

我是对象 C 的新手，我有两个问题，但在 stackoverflow 上找不到答案。

我的 iOS 应用程序很简单，屏幕上只有一个按钮，如果用户点击它，它将：

1.  播放声音

2.  以毫秒为单位获取 2 次点击之间的时间间隔。

感谢 Owl，现在获取间隔的代码如下所示：

（长时间编码，因为我不明白什么是“UNIX 时间戳”，而且我不知道在哪里/如何使用第二个代码。）

```
double dt1;
double dt2;

-(IBAction)Beated:(id)sender{
   If (FB == 1) {
      FB = 2;
      NSDate *date = [NSDate date];
      NSTimeInterval ti = [date timeIntervalSince1970];
      dt1 = ti;
   } else {
      FB = 1
      NSDate *date = [NSDate date];
      NSTimeInterval ti = [date timeIntervalSince1970];
      dt2 = ti;
      double progress;
      progress = dt2 - dt1;
      int timeInMs = trunc(progress * 1000);
      NSLog(@"Interval %d", timeInMs);
   }
} 
```

启动应用程序后，第一次播放声音有延迟，但第一次点击后效果很好。如何停止这种滞后？

我播放声音的代码：

在.h

```
#import <AVFoundation/AVFoundation.h> 
```

和

```
AVAudioPlayer *audioPlayer; 
```

米

```
 -(IBAction)Beated:(id)sender {
       NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/ssn.wav",     [[NSBundle mainBundle] resourcePath]]];
       NSError*error;
       audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url  error:$error];
       audioPlayer.numberOfLoops = 0;
       [audioPlayer play];
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:22:50.407

**第一次点击，**

```
NSDate *date = [NSDate date];
NSTimeInterval ti = [date timeIntervalSince1970]; 
```

获取 UNIX 时间戳，

**第二次点击，**

```
NSDate *date = [NSDate date];
NSTimeInterval ti = [date timeIntervalSince1970]; 
```

获取另一个 UNIX 时间戳，然后从第二个时间戳中减去第一个。减法的结果就是你的进步。

然后使用此代码获取小时：分钟：秒

```
double progress;

 int minutes = floor(progress/60);
 int seconds = trunc(progress - minutes * 60); 
```

代码礼貌：[如何将 NSTimeInterval（秒）转换为分钟](https://stackoverflow.com/questions/1189252/how-to-convert-an-nstimeinterval-seconds-into-minutes)

## 更轻松

两次点击获取两个NSDate然后使用，然后不需要减法，只需使用以下方法获取时间间隔。然后计算分钟和秒，如上所示。

```
- (NSTimeInterval)timeIntervalSinceDate:(NSDate *)anotherDate 
```

* * *

**或者**

使用类中的`components:fromDate:toDate:options:`方法`NSCalender`。请参阅：[Apple 文档](http://developer.apple.com/library/mac/#documentation/cocoa/reference/foundation/Classes/NSCalendar_Class/Reference/NSCalendar.html)。

# 编辑 ：

Jus 做了一个快速测试，它对我来说非常有效。

## 测试代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.

    NSDate *date = [NSDate date];
    NSTimeInterval ti = [date timeIntervalSince1970];

    NSLog(@"%f",ti);

    return YES;
} 
```

### NSLog 输出：

```
2012-08-22 10:46:09.123 Test[778:c07] 1345596369.123665 
```

# ruby-on-rails - 在 Rails 中对 Globalize3 表进行简单搜索

> ID：12064756
> 
> 赞同：6
> 
> 时间：2012-08-22T00:08:15.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, search, globalize3

我希望在使用 Ruby on Rails 的 globalize3 gem 时实现一个简单的搜索功能。由于模型的翻译存储在单独的表中，因此下面的代码不起作用，因为 products 表中不再有 :name 字段。如何调整下面的代码以使搜索功能正确？

**products_controller.rb**

```
 @products = Product.search(params[:search]).all 
```

**index.html.erb**

```
 <%= form_tag products_path, method: :get do %>   
   <%= text_field_tag :search, params[:search] %>
   <%= submit_tag "Search", name: nil %>      
 <% end %> 
```

**模型**

```
class Product < ActiveRecord::Base
  translates :name
  attr_accessible :name, :price, :released_at

  def self.search(search)
    if search
      where('name LIKE ?', "%#{search}%")
    else
      scoped
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-22T00:39:30.663

你很幸运，我最近解决了完全相同的问题！

幸运的是，答案很简单。您可以使用类方法[`with_translations`](https://github.com/svenfuchs/globalize3/blob/master/lib/globalize/active_record/class_methods.rb#L10)来包含给定语言环境集的翻译。

这是代码：

```
def with_translations(*locales)
  locales = translated_locales if locales.empty?
  includes(:translations).with_locales(locales).with_required_attributes
end 
```

将其包含在您的`search`方法中：

```
def self.search(search)
  if search
    with_translations.where('name LIKE ?', "%#{search}%")
  else
    with_translations
  end
end 
```

那应该这样做。

作为补充说明：您可以`locales`向搜索方法添加一个可选参数并将其传递给以`with_translations`选择性地将搜索范围缩小到特定语言的术语，例如在当前语言环境中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-11T12:11:06.257

解决了 ...

```
 def index
        if params[:search]
          @at = []
          @at = Array.new
          Article.translation_class.where("title LIKE ? OR description LIKE ?","%#{params[:search]}%","%#{params[:search]}%").all.each do |t|
            @at.push t.article_id
          end
          @articles = Article.where(id: @at).recent_first.paginate(page: params[:page], per_page: 5)
        else
          @articles = Article.all.recent_first.paginate(page: params[:page], per_page: 5)
        end
      end 
```

# internet-explorer-9 - IE9 不显示内容，除非启用 F12。会不会是缓存？

> ID：12064757
> 
> 赞同：0
> 
> 时间：2012-08-22T00:08:18.190
> 
> 标签：internet-explorer-9, ie-developer-tools

我有一个场景，除非我打开/启用了 F12 开发环境，否则 W7/IE9 上不会显示内容。我在其他浏览器（FF、Chrome）上没有这个问题。

我没有使用 F12 输出来监控流量，并且确实看到了带有内容负载的响应。什么都没有显示。我点击了浏览器的刷新按钮，没有任何反应。我打开 F12 并点击刷新并显示内容。

我看到[IE9 只在 F12 时正确地进行 ajax 调用，](https://stackoverflow.com/questions/11147553/ie9-makes-ajax-call-correctly-only-ofter-hitting-f12) 但我在 JavaScript 中没有任何 console.log 调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:04:34.530

事实上，问题的本质是对console.log 的挥之不去的调用。通过删除呼叫，它的行为符合预期。

# android - Android WebView 无法正确呈现网页

> ID：12064758
> 
> 赞同：2
> 
> 时间：2012-08-22T00:08:19.570
> 
> 标签：android, webview

我的 webview 有一个奇怪的问题。我有一个用于显示网页的基本 web 视图。这在大多数情况下都有效，但特别是有一个站点不会呈现。我不知道如何开始调试这个问题。这是我的 webview 初始化代码：

```
 webView = (WebView) findViewById(R.id.rss_webView);
    webView.setWebViewClient(new WebViewClient() {

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);
            return true;
        }
    });

    webView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress)
        {

            pb.setProgress(progress);

            if (progress == 100)
                pb.setVisibility(View.GONE);
            else
                pb.setVisibility(View.VISIBLE);

        }

    });

    webView.getSettings().setJavaScriptEnabled(true);
    webView.getSettings().setBuiltInZoomControls(true);
    webView.getSettings().setSupportZoom(true);

    webView.loadUrl(URL); 
```

有问题的 URL 是：http: [//twitter.com/AdamSchefter/statuses/236553635608285184](http://twitter.com/AdamSchefter/statuses/236553635608285184)

此页面（和其他 twitter 页面）在屏幕上呈现为一个空白的灰色方块，没有任何内容。

我注意到，如果我使用普通的 Android 浏览器打开 url，它会被重定向到移动版本。据我所知，webview 并没有这样做。在 shouldOverrideUrlLoading() 方法中设置断点时，我没有收到任何重定向 url。

我已经扫描了 logcat 是否有任何错误迹象。我认为 webview 根本不执行任何日志记录来记录 cat （除了没有加载 webview 之外），因为那里什么都没有。

我不知道如何追踪这个问题。有什么想法吗？

我有很多需要显示的 Twitter 资源，但我无法控制 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:16:28.227

> 好的，通过在我的代码中添加以下行来完成
> 
> ```
> webView.getSettings().setUserAgentString("Mozilla/5.0 (Linux; U;`
> Android 2.0; en-us; Droid Build/ESD20) AppleWebKit/530.17 (KHTML, like
> Gecko) Version/4.0 Mobile Safari/530.17"); 
> ```
> 
> 我是从 stackoverflow Problems loading mobile.twitter in webview 的这篇文章中得到的。

[webview中的android移动twitter页面没有打开？](https://stackoverflow.com/questions/8056063/android-mobile-twitter-page-in-webview-not-opening)

此外，如果它没有将您重定向到 twitter 的移动版本，您可以将 mobile 附加到它，即 mobile.twitter.com

# sql-server - sql server 连接表和翻译表

> ID：12064763
> 
> 赞同：1
> 
> 时间：2012-08-22T00:09:28.127
> 
> 标签：sql-server

我有两个这样的表：

```
ID   Name    indicator_1   indicator_2
1    text         1               1
2    text         1               1
3    text         1               1
4    text         2               1
5    text         2               1
6    text         2               2
7    text         2               2
8    text         3               2

FieldName    Value    Description
indicator_1    1         good
indicator_1    2         medium
indicator_1    3         bad
indicator_2    1         yes
indicator_2    2         no 
```

有什么办法可以加入两张桌子并到达：

```
ID   Name    indicator_1   indicator_2
1    text         good               yes
2    text         good               yes
3    text         good               yes
4    text         medium             yes
5    text         medium             yes
6    text         medium             no
7    text         medium             no
8    text         bad                no 
```

这只是一个示例，实际表格有大约 70 个指标...非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T00:14:08.410

```
SELECT t1.ID, t1.Name, t2a.Description, t2b.Description
FROM Table1 t1
INNER JOIN Table2 t2a ON t2a.FieldName = 'indicator_1' AND t2a.Value = t1.indicator_1
INNER JOIN Table2 t2b ON t2b.FieldName = 'indicator_2' AND t2b.Value = t1.indicator_2 
```

根据您的实际数据，您可能希望将“INNER”更改为“LEFT”，但 INNER JOIN 可能就在此处。

# python - Pymongo，查询列表字段，和/或

> ID：12064764
> 
> 赞同：24
> 
> 时间：2012-08-22T00:09:42.393
> 
> 标签：python, mongodb, pymongo

我有一个包含一些文档的集合，例如：

```
{
    _id: 5,
    vals: [100, 1100, 1500]
},
{
    _id: 10,
    vals: [1100, 1700]
} 
```

如何查询具有以下`vals`字段的文档：

*   1100
*   1700 或 100
*   100 和 1100

我可以使用一些理解魔法，例如：

```
g = lambda codes: (
    d for d in collection.find() if any(code in d["vals"] for code in codes)
)
g([100, 1700]).next() 
```

或者，对于 AND：

```
g = lambda codes: (
    d for d in collection.find() if all(code in d["vals"] for code in codes)
)
g([100, 1100]).next() 
```

这似乎有点笨拙，但如果有一些发现魔法可以用驱动程序完成。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-08-22T00:29:56.947

```
yourmongocoll.find({"vals":1100})
yourmongocoll.find({"$or":[ {"vals":1700}, {"vals":100}]})
yourmongocoll.find({"$and":[ {"vals":100}, {"vals":1100}]}) 
```

我建议阅读[Mongodb 高级查询](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-$in)

你还会发现[$in](http://docs.mongodb.org/manual/reference/operator/query/in/#op._S_in) ...很有用

# routing - 使用序列化/反序列化 ember.js 进行初始化

> ID：12064765
> 
> 赞同：2
> 
> 时间：2012-08-22T00:10:21.153
> 
> 标签：routing, ember.js

我正在使用`Router`没有 ember-data 的新版本，所以我必须为动态 url 段实现我自己的`serialize`/ `deserialize`。

我有一个`ArrayController`填充了`Application#ready`.

为简单起见，假设我有 2 条路线：`item > '/item/:item_id'`& `items > '/items'`。

`item`路线中的反序列化方法看起来像这样

```
 deserialze: function(router, params){ 
     return router.get('myController')
                  .findProperty('id', params['item_id']);
 } 
```

如果我在路线上初始化我的应用程序并通过一切正常`items`导航到`item`特定项目的路线。`{{action}}`此外，在此之后，我可以手动将 url 更改为特定`id`的，而不会出现问题。

但是，如果我尝试在`item`路线（即`/item/2`）中启动我的应用程序，则`deserialize`返回未定义。我假设这是因为`Application#ready`尚未完成填充控制器。

我该如何解决这个问题？

**编辑：**我认为[这](http://emberjs.com/guides/outlets/#toc_asynchrony)回答了我的问题。使用 ember 数据。

> # 异步
> 
> 最后一点：您可能会问自己，如果应用程序在调用时尚未加载 Post 1 >，该系统将如何工作`App.Post.find(1)`。
> 
> 这样做的原因是它`ember-data`总是立即返回一个对象，即使它需要启动一个查询。该对象以空`data`哈希开始。当服务器返回数据时，ember-data 会更新对象的`data`，这也会触发对所有已定义属性（使用 定义的属性`DS.attr`）的绑定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T10:40:42.890

`ember-data`我不知道如何纠正您的初始化问题，但如果您不想使用，您绝对不必使用。

就个人而言，我有：

*   覆盖`deserialize`所有的方法`Ember.Route`，
*   定义了一个`App.ModelFetcher`具有类方法的类：
    *   `find(id, doneRequestCallback, failRequestCallback)`
    *   `all(doneRequestCallback, failRequestCallback)`
*   `App.ModelFetcher.find(id, function() {}, function() {})`直接调用`deserialize`

这两个方法`ember-data`也一样，分别返回一个空`App.Model`对象和一个空数组。当请求完成时，这些对象会被请求值膨胀。

可能有更好的解决方案，但它对我来说很好，而且看起来并不那么糟糕。

您也可以不覆盖该`deserialize`方法，而只需定义经典`App.Model.find(id)`函数（返回一个空`App.Model`实例），然后为您的对象设置一个状态，就像这样`ember-data`做（参见[http://goo.gl/3otkt](http://goo.gl/3otkt)）。

`model_id`如果动态段具有格式（参见[http://goo.gl/y86KE](http://goo.gl/y86KE)），则 ember 将自动调用该方法。

无论如何，我可能是错的，但我不喜欢你试图在你的控制器中获取对象的事实，但除了上面描述的那些之外，我没有其他解决方案。

# lucene - Lucene.net - 索引期间崩溃

> ID：12064766
> 
> 赞同：7
> 
> 时间：2012-08-22T00:10:35.170
> 
> 标签：lucene, lucene.net, luke

我使用 Lucene 的索引器在编写了大约 16GB 大小的索引文件后，在索引操作期间似乎崩溃了。

由于我不知道的原因，写入控制台的堆栈跟踪重复了三遍。为简洁起见，我只提供了重复的单个部分。这是 Lucene 写入控制台的堆栈跟踪：

```
Lucene.Net.Index.MergePolicy+MergeException: Exception of type 'Lucene.Net.Index.MergePolicy+MergeException' was thrown. --->

System.IO.FileNotFoundException: Could not find file 'PATH_TO_MY_INDEX_DIRECTORY\_xx.cfs'.

File name: 'PATH_TO_MY_INDEX_DIRECTORY\_xx.cfs'
at Lucene.Net.Index.IndexWriter.HandleMergeException(Exception t, OneMerge merge)
at Lucene.Net.Index.IndexWriter.Merge(OneMerge merge)
at Lucene.Net.Index.ConcurrentMergeScheduler.MergeThread.Run()
--- End of inner exception stack trace ---
at Lucene.Net.Index.ConcurrentMergeScheduler.HandleMergeException(Exception exc)
at Lucene.Net.Index.ConcurrentMergeScheduler.MergeThread.Run()
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
at System.Threading.ThreadHelper.ThreadStart() 
```

当我使用 Luke 的 Java 版本打开生成的日志时，索引被删除（可能是因为它已损坏，例如“write.lock”文件仍然存在），尽管这可能是 Luke 的错误或配置错误。

创建这个索引大约需要 36 小时，我不想第三次再做一次（这不是第一次发生）。

我不知道是什么原因造成的。我能做些什么？

我使用的是 Lucene.net 2.9.2，因为它是为 .NET 3.5 构建的最后一个版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:47:57.570

我意识到这是由于在没有调用`Commit`. 我修改了我的代码以`Commit`在写入大约 10MB 的数据后调用。从那以后我就没有出现过异常——当它崩溃时，这意味着我不需要重建整个 36GB 索引，只需要重建最后的 10MB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-25T17:20:49.537

花了一段时间才找到，但事实证明（在我的情况下）这是由本地硬盘已满引起的。更有用的异常消息会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-14T09:25:46.230

是的，聚会很晚，但我遇到了与此例外相同的问题：

```
Exception Info: Lucene.Net.Index.CorruptIndexException
   at Lucene.Net.Index.IndexWriter.HandleMergeException(System.Exception, 
OneMerge)
   at Lucene.Net.Index.IndexWriter.Merge(OneMerge)
   at Lucene.Net.Index.ConcurrentMergeScheduler+MergeThread.Run()

Exception Info: Lucene.Net.Index.MergePolicy+MergeException
   at Lucene.Net.Index.ConcurrentMergeScheduler.HandleMergeException(System.Exception)

    at Lucene.Net.Index.ConcurrentMergeScheduler+MergeThread.Run()
    at System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
    at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
    at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)
    at System.Threading.ThreadHelper.ThreadStart() 
```

我通过删除所有索引并重建它们来解决这个问题。

# file - 如何在 Python 3 中找到“当前”源文件？

> ID：12064771
> 
> 赞同：6
> 
> 时间：2012-08-22T00:10:55.100
> 
> 标签：file, python-3.x

找到我正在“执行”某些代码的文件的路径的最简单方法是什么？我的意思是，如果我有一个`foo.py`包含以下内容的文件：

```
print(here()) 
```

我想看看`/some/path/foo.py`（我意识到实际上“正在执行”的文件很复杂，但我认为上面的定义很好 - 一个源文件包含一些函数，在执行时会给出所述文件的路径）。

过去我需要它来进行自包含的测试（需要一些外部文件），我目前想知道它是否是一种有用的方法来定位程序所需的一些支持文件。但我从来没有找到这样做的好方法。检查模块听起来应该可以工作，但您似乎需要在该模块中定义的类或函数。

特别是，模块实例包含`__file__`属性，但我看不到如何获取“当前”模块。对象有一个`__module__`属性，但这是模块*名称*，而不是模块实例。

我想一种方法是抛出并捕获异常并检查内容，但这似乎很辛苦。当然，我错过了一种简单易行的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T00:14:50.090

获取当前文件的绝对路径：

```
import os
os.path.abspath(__file__) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T01:05:39.057

要获取与您的包一起分发的外部文件的内容，您可以使用`pkg_util.get_data()`(stdlib) 或`pkg_resources.resouce_string()`(setuptools) 来支持从 zip-archives 或由 py2exe、PyInstaller 或类似文件创建的独立可执行文件执行，[例如](https://stackoverflow.com/a/5356563/4279).

# python - itertools：排列的笛卡尔积

> ID：12064780
> 
> 赞同：3
> 
> 时间：2012-08-22T00:11:51.377
> 
> 标签：python, permutation, itertools, cartesian-product

使用 pythons `itertools`，我想在一堆列表的所有排列的外积上创建一个迭代器。一个明确的例子：

```
import itertools
A = [1,2,3]
B = [4,5]
C = [6,7]

for x in itertools.product(itertools.permutations(A),itertools.permutations(B),itertools.permutations(C)):
    print x 
```

虽然这可行，但我想将其推广到任意列表列表。我试过：

```
for x in itertools.product(map(itertools.permutations,[A,B,C])):
    print x 
```

但它没有达到我的预期。预期的输出是：

```
((1, 2, 3), (4, 5), (6, 7))
((1, 2, 3), (4, 5), (7, 6))
((1, 2, 3), (5, 4), (6, 7))
((1, 2, 3), (5, 4), (7, 6))
((1, 3, 2), (4, 5), (6, 7))
((1, 3, 2), (4, 5), (7, 6))
((1, 3, 2), (5, 4), (6, 7))
((1, 3, 2), (5, 4), (7, 6))
((2, 1, 3), (4, 5), (6, 7))
((2, 1, 3), (4, 5), (7, 6))
((2, 1, 3), (5, 4), (6, 7))
((2, 1, 3), (5, 4), (7, 6))
((2, 3, 1), (4, 5), (6, 7))
((2, 3, 1), (4, 5), (7, 6))
((2, 3, 1), (5, 4), (6, 7))
((2, 3, 1), (5, 4), (7, 6))
((3, 1, 2), (4, 5), (6, 7))
((3, 1, 2), (4, 5), (7, 6))
((3, 1, 2), (5, 4), (6, 7))
((3, 1, 2), (5, 4), (7, 6))
((3, 2, 1), (4, 5), (6, 7))
((3, 2, 1), (4, 5), (7, 6))
((3, 2, 1), (5, 4), (6, 7))
((3, 2, 1), (5, 4), (7, 6)) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T00:17:11.563

您错过了`*`将列表解压缩为 3 个参数的方法

```
itertools.product(*map(itertools.permutations,[A,B,C])) 
```

# ruby-on-rails - 如何将设计用户分成两部分？

> ID：12064783
> 
> 赞同：0
> 
> 时间：2012-08-22T00:12:57.797
> 
> 标签：ruby-on-rails, devise, sti

我有一个非常胖的用户模型。我想将某些方法从中分离出来，并将它们放入我将创建的新模型中，称为 Manager，它将从具有 STI 的 User 继承。

```
class User < ActiveRecord::Base
 ..
 def user_method
 end
end

class Manager < ActiveRecord::Base
 ..
 def manager_method
 end
end 
```

我很好奇 Devise 是如何处理这个问题的。假设我已经有一个用户，并且假设该用户是经理。但是当他登录时， current_user 对象将从 User 类中实例化，对吗？我假设以真正的面向对象的方式，Rails 不允许我们从父类的实例访问子类的方法......对吗？

那么我需要做些什么来确保 current_user 对象是 type 列中指定的类的实例，Rails 中的 STI 就是这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:44:38.347

您可以像这样轻松地做到这一点：

```
class User < ActiveRecord::Base
  ROLES = ['Admin', 'RoleX', 'RoleY']
  devise :database_authenticatable, :blah
  attr_accessible :email, :blah
  validates :something

  def method
  end
end 
```

例如，为 admin 定义类，该类将从用户继承，但在设计中将保持单独的角色。

```
class Admin < User
  def some_method

  end
end 
```

# php - 使用 PHP 从函数中检索单个提取值

> ID：12064788
> 
> 赞同：0
> 
> 时间：2012-08-22T00:13:34.737
> 
> 标签：php, mysql, function, pdo, session-variables

```
 //This is my function in retrieving the id of the user base from its email and pass. this is for functions.php 
       function getID($email,$pass)
        {
                $pdo = new PDO(connection here);
            $stmt = $pdo->prepare('SELECT id user where email = :email and pass = :pass LIMIT 1');
            $stmt->execute(array(':email'=>$email, ':pass'=>md5($pass)));
            $result = $stmt->fetch();
            return $result['id'];//Is this the right way of returning a value from a fetch value?
        }
//this is for user.php. 
include 'function.php';
session_start();
$_SESSION['id'] = getID($_POST['email'],$_POST['pass']); 
```

这是检索它的正确方法吗？但我没有从中得到任何价值。需要帮助谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:35:34.570

您的查询缺少`FROM`.

`SELECT id FROM user WHERE email = :email AND pass = :pass LIMIT 1`

# javascript - javascript中的简单财务利率函数

> ID：12064793
> 
> 赞同：4
> 
> 时间：2012-08-22T00:14:12.860
> 
> 标签：javascript, function, financial, rate

我正在寻找一个简单的 javascript 财务 RATE 函数，我找到了这个。但这似乎太难理解了。我想简化这个功能，我需要你的帮助。如果有人有最简单的功能，请回答。（这是一个 excel RATE 函数等价物。）

```
var rate = function(nper, pmt, pv, fv, type, guess) {
  if (guess == null) guess = 0.01;
  if (fv == null) fv = 0;
  if (type == null) type = 0;

  var FINANCIAL_MAX_ITERATIONS = 128;//Bet accuracy with 128
  var FINANCIAL_PRECISION = 0.0000001;//1.0e-8

  var y, y0, y1, x0, x1 = 0, f = 0, i = 0;
  var rate = guess;
  if (Math.abs(rate) < FINANCIAL_PRECISION) {
     y = pv * (1 + nper * rate) + pmt * (1 + rate * type) * nper + fv;
  } else {
     f = Math.exp(nper * Math.log(1 + rate));
     y = pv * f + pmt * (1 / rate + type) * (f - 1) + fv;
  }
  y0 = pv + pmt * nper + fv;
  y1 = pv * f + pmt * (1 / rate + type) * (f - 1) + fv;

  // find root by Newton secant method
  i = x0 = 0.0;
  x1 = rate;
  while ((Math.abs(y0 - y1) > FINANCIAL_PRECISION) && (i < FINANCIAL_MAX_ITERATIONS)) {
     rate = (y1 * x0 - y0 * x1) / (y1 - y0);
     x0 = x1;
     x1 = rate;

     if (Math.abs(rate) < FINANCIAL_PRECISION) {
        y = pv * (1 + nper * rate) + pmt * (1 + rate * type) * nper + fv;
     } else {
        f = Math.exp(nper * Math.log(1 + rate));
        y = pv * f + pmt * (1 / rate + type) * (f - 1) + fv;
     }

     y0 = y1;
     y1 = y;
     ++i;
  }
  return rate;} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:37:41.840

数学太复杂了，我无法理解，但这对您来说可能更容易阅读。一些变量已被重命名以更有意义，并且它的格式更容易让您看到

```
function rate(paymentsPerYear, paymentAmount, presentValue, futureValue, dueEndOrBeginning, interest)
{
    //If interest, futureValue, dueEndorBeginning was not set, set now
    if (interest == null)
        interest = 0.01;

    if (futureValue == null)
        futureValue = 0;

    if (dueEndOrBeginning == null)
        dueEndOrBeginning = 0;

    var FINANCIAL_MAX_ITERATIONS = 128;//Bet accuracy with 128
    var FINANCIAL_PRECISION = 0.0000001;//1.0e-8

    var y, y0, y1, x0, x1 = 0, f = 0, i = 0;
    var rate = interest;
    if (Math.abs(rate) < FINANCIAL_PRECISION)
    {
        y = presentValue * (1 + paymentsPerYear * rate) + paymentAmount * (1 + rate * dueEndOrBeginning) * paymentsPerYear + futureValue;
    }
    else
    {
        f = Math.exp(paymentsPerYear * Math.log(1 + rate));
        y = presentValue * f + paymentAmount * (1 / rate + dueEndOrBeginning) * (f - 1) + futureValue;
    }
    y0 = presentValue + paymentAmount * paymentsPerYear + futureValue;
    y1 = presentValue * f + paymentAmount * (1 / rate + dueEndOrBeginning) * (f - 1) + futureValue;

    // find root by Newton secant method
    i = x0 = 0.0;
    x1 = rate;
    while ((Math.abs(y0 - y1) > FINANCIAL_PRECISION)
        && (i < FINANCIAL_MAX_ITERATIONS))
    {
        rate = (y1 * x0 - y0 * x1) / (y1 - y0);
        x0 = x1;
        x1 = rate;

        if (Math.abs(rate) < FINANCIAL_PRECISION)
        {
            y = presentValue * (1 + paymentsPerYear * rate) + paymentAmount * (1 + rate * dueEndOrBeginning) * paymentsPerYear + futureValue;
        }
        else
        {
            f = Math.exp(paymentsPerYear * Math.log(1 + rate));
            y = presentValue * f + paymentAmount * (1 / rate + dueEndOrBeginning) * (f - 1) + futureValue;
        }

        y0 = y1;
        y1 = y;
        ++i;
    }
    return rate;
} 
```

# rabbitmq - 当 RabbitMQ 持久队列用完 RAM 时，预期的行为是什么？

> ID：12064802
> 
> 赞同：2
> 
> 时间：2012-08-22T00:15:14.550
> 
> 标签：rabbitmq, message-queue, task-queue

我对 RabbitMQ 持久队列（即 delivery_mode = 2）的理解是它们在 RAM 中运行，但是消息会刷新到磁盘，以便在进程重新启动或机器重新启动时可以恢复它们。

我不清楚当机器内存不足时预期的行为是什么。如果队列超载、死亡并需要恢复，那么简单地从磁盘支持的存储中加载消息将消耗所有可用的 RAM。

在这种情况下，持久队列是否仅将部分消息加载到 RAM 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-18T23:47:16.717

当内存填满时，RabbitMQ 会将消息分页到磁盘。请参阅[https://www.rabbitmq.com/memory.html](https://www.rabbitmq.com/memory.html)部分“配置寻呼阈值”。

# popup - Google Apps 脚本中的简单弹出窗口或对话框

> ID：12064805
> 
> 赞同：7
> 
> 时间：2012-08-22T00:15:52.053
> 
> 标签：popup, google-apps-script, popupwindow

我正在寻找在我的 Google Apps Script Ui 中添加一个弹出窗口的简单代码，当我点击提交按钮时会出现该弹出窗口。弹出框将显示一条消息，并有一个关闭弹出框的按钮。

我到处看了看——一切看起来都那么复杂，而且做得比我需要做的要多。

这是我用于提交按钮的当前代码。

```
 function doGet() {
       var app = UiApp.createApplication();
       app.setTitle("My Logbook");

       var hPanel_01 = app.createHorizontalPanel();
       var vPanel_01 = app.createVerticalPanel();
       var vPanel_02 = app.createVerticalPanel();
       var vPanel_03 = app.createVerticalPanel();

       var submitButton = app.createButton("Submit");

       //Create click handler
       var clickHandler = app.createServerHandler("submitData");
       submitButton.addClickHandler(clickHandler);
       clickHandler.addCallbackElement(hPanel_01);

       ////Test PopUp Panel
       var app = UiApp.getActiveApplication();
       var app = UiApp.createApplication;
       var dialog = app.createDialogBox();
       var closeHandler = app.createClientHandler().forTargets(dialog).setVisible(false);
       submitButton.addClickHandler(closeHandler);

       var button= app.createButton('Close').addClickHandler(closeHandler);

       dialog.add(button);
       app.add(dialog);
       //////

       return app;
     } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-16T13:53:57.817

由于[UiApp](https://developers.google.com/apps-script/reference/ui/ui-app)已贬值，因此应使用[HTMLService来创建自定义用户界面。](https://developers.google.com/apps-script/guides/html/)

提示简单的弹窗显示消息，使用[Ui 类](https://developers.google.com/apps-script/reference/base/ui)`alert`的方法

```
var ui = DocumentApp.getUi();
ui.alert('Hello world'); 
```

将提示带有 hello world 和 ok 按钮的简单弹出窗口。

要在 Dialog 中显示自定义的 html 模板，请使用 HTMLService 创建模板，然后将其传递给`showModalDialog`Ui 类的方法

```
var html = HtmlService.createHtmlOutput("<div>Hello world</div>").setSandboxMode(HtmlService.SandboxMode.IFRAME);
DocumentApp.getUi().showModalDialog(html, "My Dialog"); 
```

`HtmlService.createHtmlOutputFromFile`允许您显示位于单独文件中的 html。见[文档](https://developers.google.com/apps-script/reference/html/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T07:43:02.377

您可以使用一个**对话框**来弹出。在对话框中添加一个按钮。添加一个**客户端处理程序**，一旦您单击按钮，该处理程序将设置对话框不可见。

```
var app = UiApp.createApplication;
var dialog = app.createDialogBox();
var closeHandler = app.createClientHandler().forTargets(dialog).setVisible(false);

var button= app.createButton('Close').addClickHandler(closeHandler);

dialog.add(button);
app.add(dialog); 
```

这应该会有所帮助。

**编辑**

在 .createClientHandler 之后添加了“()”。这应该消除与 **TypeError 相关的问题：Cannot find function createDialogBox in object function createApplication() {/* */}**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T03:30:54.130

您是否尝试过使用 zIndex？它将面板置于所有其他面板之上...

```
var popupPanel = app.createVerticalPanel().setId('popupPanel')
    .setVisible(false)      
    .setStyleAttribute('left', x)  
    .setStyleAttribute('top', y)        
    .setStyleAttribute('zIndex', '1')
    .setStyleAttribute('position', 'fixed'); 
```

x = 应用左侧的面板位置 y = 应用顶部的面板位置 zIndex = 面板将出现的“层”。您可以使用“1”、“2”、“3”等来堆叠面板。位置 = 您的面板将位于由 (x,y) 表示的固定位置

Visibility 设置为 false，直到您单击提交，然后让您的提交按钮的客户端处理程序使 popupPanel 可见。当您单击 popupPanel 上的按钮时，让客户端处理程序再次将可见性设置为 false，它将消失。

还有一件事，我注意到您获得了活动应用程序，然后创建了一个新应用程序。您无需创建新应用……只需在应用内创建新面板即可。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T03:42:03.420

弹出窗口 - 使用这样的东西：

```
 var table = app.createFlexTable();
      table.setStyleAttribute("position", "absolute");
      table.setStyleAttribute("background", "white"); 
```

将项目添加到表格并根据需要隐藏和显示。

# jquery - 使用 clearTimeout 为下拉菜单设置延迟

> ID：12064811
> 
> 赞同：0
> 
> 时间：2012-08-22T00:17:32.080
> 
> 标签：jquery, drop-down-menu, delay

我对 Javascript 很陌生，我正在尝试在某些下拉菜单上设置延迟。我已经加载了 jQuery，目前正在使用延迟方法。但是，我环顾四周，似乎无法延迟取消计时器，这意味着我最终得到了一堆未折叠的下拉菜单。

如何设置它以便我可以设置延迟并在鼠标悬停时取消它？

这是我的代码（注意 $$ 用于 jQuery noconflict）：

```
$$(function(){
    $$('#custommenu>div.menu').mouseover(function(){
    $$('#custommenu>div.menu').removeClass('active');               
    $$('#popup'+$$(this).attr('id').replace('menu','')).delay(500).slideDown(100);
    });

    $$('#custommenu>div.menu').mouseout(function(){
    $$('#custommenu .wp-custom-menu-popup').hide();

    });

    $$('#custommenu .wp-custom-menu-popup').mouseout(function(){
    $$('#custommenu>div.menu').removeClass('active');
    $$('#custommenu .wp-custom-menu-popup').hide();
    });

    $$('#custommenu .wp-custom-menu-popup').mouseover(function(){
    $$('#menu'+$$(this).attr('id').replace('popup','')).addClass('active');
    $$(this).show();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:21:09.627

`$('#custommenu .wp-custom-menu-popup').stop(true, true)`在调用 .hide() 之前尝试添加mouseout。这应该清除动画的活动队列，并希望跳过所有延迟。

# objective-c - NSEvent charactersIgnoringModifiers 随机抛出“TSMProcessRawKeyCode failed”异常

> ID：12064813
> 
> 赞同：5
> 
> 时间：2012-08-22T00:17:54.590
> 
> 标签：objective-c, macos, cocos2d-iphone

我们的 Mac cocos2d 应用程序（http://deepworldgame.com）已经随机抛出“TSMProcessRawKeyCode failed”异常有一段时间了，我想知道是否有人遇到过这个错误或知道如何防止它。

它总是通过 ccKeysDown 或 ccKeysUp 中的 [NSEvent charactersIgnoringModifiers] 调用发生（它也发生在没有修饰符的 [NSEvent characters] 上）。我不认为它与特定的键有关。有时它只发生一次，然后应用程序继续运行（如果捕获到异常），但有时它基本上无限期地锁定键盘输入并继续导致所有未来的按键异常（再次，当这些异常被捕获时）。

不幸的是，我在互联网上几乎没有找到关于这个问题的信息。我确实找到的一个地方是在 Adium 源代码 (https://bitbucket.org/adium/adium/src/6d1f9b903525/Source/AIExceptionController.m) 中，它通过注释捕获了这个异常：

```
//Ignore various known harmless or unavoidable exceptions (From the system or system hacks) 
...
// [TSMProcessRawKeyCode] May be raised by -[NSEvent charactersIgnoringModifiers] 
```

扔一次确实是无害的，但是当它发生连续发射的时候，这是一个真正的问题——尤其是当你处于全屏模式并且无法使用 cmd-F 逃生时！

因此，如果有人有任何想法或经验，我将不胜感激。这几乎是我们应用程序中仅存的一个超级细菌，我很想将其粉碎。

谢谢！

这是典型的堆栈跟踪（MacManager.m 是我们实现 cocos2d 键盘委托协议的对象）：

```
Crashed Thread:  7  CVDisplayLink

Exception Type:  EXC_BREAKPOINT (SIGTRAP)
Exception Codes: 0x0000000000000002, 0x0000000000000000

Application Specific Information:
objc[28871]: garbage collection is OFF
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'TSMProcessRawKeyCode failed (-192)'
*** Call stack at first throw:
(
0   CoreFoundation                      0x95b27d87 __raiseError + 231
1   libobjc.A.dylib                     0x9315a149 objc_exception_throw + 155
2   CoreFoundation                      0x95a8f619 +[NSException raise:format:arguments:] + 137
3   CoreFoundation                      0x95a8f589 +[NSException raise:format:] + 57
4   AppKit                              0x9ac01c1f _convertEventRefToString + 300
5   AppKit                              0x9ab23b5e -[NSEvent charactersIgnoringModifiers] + 880
6   Deepworld                           0x0001fd8a -[MacManager ccKeyDown:] + 65
7   CoreFoundation                      0x95a7d091 -[NSObject performSelector:withObject:] + 65
8   Deepworld                           0x0006bc95 -[CCEventDispatcher keyDown:] + 80
9   CoreFoundation                      0x95a7d091 -[NSObject performSelector:withObject:] + 65
10  Deepworld                           0x0006c014 -[CCEventDispatcher dispatchQueuedEvents] + 143
11  Deepworld                           0x0006a9a4 -[CCDirectorDisplayLink getFrameForTime:] + 155
12  Deepworld                           0x0006aaf1 MyDisplayLinkCallback + 40
13  CoreVideo                           0x9b44a5e1 _ZN13CVDisplayLink9performIOEP11CVTimeStamp + 489
14  CoreVideo                           0x9b4494e4 _ZN13CVDisplayLink11runIOThreadEv + 876
15  CoreVideo                           0x9b449161 _ZL13startIOThreadPv + 160
16  libsystem_c.dylib                   0x968a4ed9 _pthread_start + 335
17  libsystem_c.dylib                   0x968a86de thread_start + 34
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:46:57.170

我不认为发送事件通常是线程安全的，更不用说从不在 +[NSThread detachNewThreadSelector:toTarget:withObject:] 内创建的线程（使用 Objective-C 运行时创建的线程具有 __NSThread__main__在回溯中）。

我猜你的应用程序是 Deepworld 二进制部分 - 调度事件时，尝试使用 -[NSObject performSelectorOnMainThread:waitUntilDone:] 代替，在主线程上调度事件。

# sql-server - 复杂的 WHERE 条件来整理数据

> ID：12064816
> 
> 赞同：0
> 
> 时间：2012-08-21T23:53:18.110
> 
> 标签：sql-server, sql, sql-server-2008

我有一个 SQL 表，其中包含有关 clint 的数据（比如 ClientId）和他们为服务付费的日期以及他们的服务开始的日期：

```
Headings: ClientId, PurchaseDate, StartDate
Line 1: 1; 1/07/2012; 15/07/2012
Line 2: 2; 21/06/2012; 01/07/2012
Line 3: 3; 31/07/2012; 02/08/2012
Line 4: 4; 04/08/2012; 15/08/2012
Line 5: 5; 15/08/2012; 2/09/2012 
```

我创建了一个查询，它只选择那些在上个月开始服务的客户。条件语句如下：

```
WHERE StartDate >= DATEADD(month, -1, dateadd(month, datediff(month,0,getdate()),0)) 
and StartDate < dateadd(month, 1, dateadd(month, -1, dateadd(month, datediff(month,0,getdate()) 
```

现在我需要一个查询，其中还包括那些在上个月支付服务费的客户。我认为可以有以下说法：

```
WHERE PurchaseDate >= DATEADD(month, -1, dateadd(month, datediff(month,0,getdate()),0)) 
and PurchaseDate < dateadd(month, 1, dateadd(month, -1, dateadd(month, datediff(month,0,getdate()) 
```

问题是那些在一个月内具有 PurchaseDate 和在下个月具有 StartDate 的客户将出现在这两个月的报告中。因此，据我了解，应该有以下含义的复杂条件：

```
WHERE StartDate >= DATEADD(...)
 & StartDate < DATEADD(...) 
 & (PurchaseDate >= DATEADD(...)
 & PurchaseDate < DATEADD(...) 
 & PurchaseDate happened a month earlier than StartDate 
```

请帮助找到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:46:48.560

我想你的意思是这样的：

```
WHERE StartDate >= DATEADD(...) & StartDate < DATEADD(...) 
& NOT (PurchaseDate >= DATEADD(...) & PurchaseDate < DATEADD(...)) 
```

如果客户上个月购买，则添加一个`NOT`以从本月的开始总数中*排除客户*

# objective-c - 通过带有 NSSelectorFromString 的 performSelector 导致泄漏？

> ID：12064819
> 
> 赞同：2
> 
> 时间：2012-08-22T00:18:17.133
> 
> 标签：objective-c, ios

我正在尝试为我的游戏的关卡类提供一个相当动态的 api……基本上，我只有一堆类方法 optionsForLevel1、optionsForLevel2、……等等，它们都返回一个字典对象，其中包含多少时间关卡应该有多少奖励积分，关卡名称等...

在我的实际游戏对象中，当需要升级关卡时，它会调用关卡对象上的一个方法，该方法执行以下操作：

```
+(NSDictionary*)performClassSelectorForLevel:(int)identifier {
    SEL sel = NSSelectorFromString([NSString stringWithFormat:@"optionsForLevel%d", identifier]);
    return [self performSelector:sel];
} 
```

这给了我一个警告： PerformSelector 可能会导致泄漏，因为它的选择器是未知的。

...

如何解决此警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:20:35.697

这很有趣。你不能。不是我的经验。简单地说，这是一个警告，而不是错误，这“可能”导致泄漏。

使用`performSelector:`时确保它不会泄漏是您的责任，当然编译器不知道 中的选择器`NSString`，它在编译时是未知的，因为它将在运行时分配它的值。

您可以禁止显示此警告，但可以忽略

查看此答案以获取更多详细信息：[PerformSelector 警告](https://stackoverflow.com/questions/8773226/performselector-warning)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-23T15:39:51.823

警告是由编译器生成的，因为 ARC 需要知道该方法可能返回什么样的对象，以确保内存没有被错误管理。

此处有更多详细信息：[performSelector 可能会导致泄漏，因为它的选择器是 unknown](https://stackoverflow.com/questions/7017281/performselector-may-cause-a-leak-because-its-selector-is-unknown)。

# python - Django将上传的.doc文件保存为.zip文件？

> ID：12064820
> 
> 赞同：1
> 
> 时间：2012-08-22T00:18:28.193
> 
> 标签：python, django, file, upload, docx

所以我使用标准的上传文件代码在我的网站上制作了上传功能。我测试过的所有文件类型（pdf、gif、jpg）似乎都可以正常工作，但是当我尝试上传 docx 文件时，Django 将文件存储为 .zip 文件。显然这与“内容嗅探”有关？这是代码 -

```
def upload_form(request):
  if request.method == 'POST':

    # Gets the information about the file
    uploaded_file = request.FILES['file']
    file_size, file_name = uploaded_file.size, "ID" + str(File.objects.all().count()) + "%" + request.POST['name']

    # Stops the processing if the file size is too large
    if(file_size > 5242880):
      return render_to_response('upload_form.html', { 'large_file' : '1' }, context_instance=RequestContext(request))

    file_path, file_course = '/home/simon/Centum/static/notes/' + file_name, request.POST['course']

    # Reads and writes the chunks
    with open(file_path, 'wb+') as destination:
      for chunk in request.FILES['file'].chunks():
        destination.write(chunk)     

    # Saves the file
    upload = File(
      name = file_name,
      real_name = file_name[file_name.find('%') + 1:],
      user = request.user,
      path = file_path,
      size = int(file_size),
      course = file_course.upper(),
      date_uploaded = datetime.datetime.now()
    )
    upload.save()
    return render_to_response('upload_form.html', {'success' : '1'}, context_instance=RequestContext(request)) 
```

无论如何让它在上传时保持为.docx？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-28T19:19:34.060

docx 文件*是*一个 zip 文件。django 是否使用 zip 扩展名保存它并不重要，这不会改变内容，您可以使用任何您喜欢的文件名来提供它。您面临的实际问题是什么？

# objective-c - 应用程序因“无法在对象 1 上进行正则表达式匹配”而冻结

> ID：12064821
> 
> 赞同：2
> 
> 时间：2012-08-22T00:18:41.703
> 
> 标签：objective-c, ios, core-data

我的 iPad 应用程序只是冻结，然后在调试器中引发以下错误。

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Can't do regex matching on object 1.' 
```

在涉及核心数据的答案中执行谷歌搜索结果，但没有一个真正说明如何找出此错误发生的原因。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T16:03:05.150

问题是 BOOL 上的谓词。

```
@"(thing LIKE [c] %@)  OR (thing == nil)" 
```

固定与

```
@"(synced == 0) OR (synced == nil)" 
```

现在完美运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-22T00:58:32.457

您正在尝试执行一个谓词，该谓词对不是一个属性`NSString`（可能是一个带有 value 的数字`1`）进行正则表达式匹配。

尝试调试您的应用程序并中断异常（请参阅[http://developer.apple.com/library/mac/#recipes/xcode_help-breakpoint_navigator/articles/adding_an_exception_breakpoint.html](http://developer.apple.com/library/mac/#recipes/xcode_help-breakpoint_navigator/articles/adding_an_exception_breakpoint.html)），它会在遇到异常时停止您的应用程序。

# javascript - 调用drupal服务模块时，JQuery不会传递标记为sessid的数据

> ID：12064825
> 
> 赞同：0
> 
> 时间：2012-08-22T00:19:41.937
> 
> 标签：javascript, jquery, drupal

嘿，我正在处理一个 json 调用，它将用 json 实现 Drupal 的服务模块。我正在使用 jquery 的 ajax 函数来调用该函数，但我收到一条错误消息，指出没有传递任何参数。当我查看发布的查询字符串时，我注意到 sessid 没有被传递，即使它带有参数。下面是我正在运行的。

```
// JavaScript Document
$(document).ready(function() {

    function drupalConnect(src) {
        $.ajax({
            url: src,
            type: 'POST',
            data: {
                method: 'system.connect'
            },
            success: function(data) {
                return data["result"]["sessid"];
            }
        });
    }

    function getTimestamp() {
        return Math.round((new Date).getTime() / 1000);
    }

    function randString(length) {
        var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";
        var randomstring = '';
        for (var i = 0; i < length; i++) {
            var rnum = Math.floor(Math.random() * chars.length);
            randomstring += chars.substring(rnum, rnum + 1);
        }
        return randomstring;
    }

    var session_id = drupalConnect('http://localhost/drupal/services/json-rpc');
    var nonce = randString(10);
    var timestamp = getTimestamp();
    var username = "markusgray";
    var password = "Markus1990";
    var key = '2ae0392e0aebbfeeddefcc962ea1924f';
    var domain = 'localhost';

    var hashObj = new jsSHA(timestamp + ";" + domain + ";" + nonce + ";user.login", "TEXT");
    var hash = hashObj.getHMAC(key, "TEXT", "SHA-256", "HEX");

    var parameters = {
        hash: hash,
        domain_name: domain,
        domain_time_stamp: timestamp,
        nonce: nonce,
        sessid: session_id,
        username: username,
        password: password
    };

    var par = JSON.stringify(parameters);

    $.ajax({
        url: 'http://localhost/drupal/services/json-rpc',
        type: 'POST',
        dataType: 'json',
        data: {
            method: 'user.login',
            params: par
        },
        success: function() {

        }
    });
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:41:51.813

`drupalConnect`不返回任何东西，`success`回调的返回也被丢弃。使用从 ajax 调用返回的数据的最佳方法是在回调本身中使用它。

```
function drupalConnect(src){
    $.ajax({
        url: src,
        type: 'POST',
        data:{method:'system.connect'},
        success: function(data){
            var session_id = data["result"]["sessid"]; 
            //use session_id here
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T08:14:54.813

这是因为`Asynchronous`ajax，让我详细说明，让`session_id`您进行 ajax 调用。目前它将发送请求，但它不会确保此时`session_id`将被分配。因此，当您进行第二次 ajax 调用时，`session_id`可能不会为值分配 。

有两种解决方法，

一个是，使用选项进行第一个 ajax 调用`async:false`并在成功调用中分配值，例如

```
var session_id;

function drupalConnect(src) {
    $.ajax({
        url: src,
        type: 'post',
        async : false,
        data: {
            method: 'system.connect'
        },
        success: function(data) {
            session_id = data["result"]["sessid"];
        }
    });
}; 
```

**[演示](http://jsfiddle.net/thujeevan/8TKmq/1/)**

第二种也是首选方式是使用[延迟对象](http://api.jquery.com/category/deferred-object/)，例如

```
$.when(
    // make your first ajax request
).then(function(data) {
    session_id = data["result"]["sessid"];
    // make your second ajax call
});​ 
```

**[演示](http://jsfiddle.net/thujeevan/8TKmq/2/)**

# c++ - 基类和派生类构造函数的内存分配

> ID：12064828
> 
> 赞同：2
> 
> 时间：2012-08-22T00:19:59.860
> 
> 标签：c++, inheritance, space

创建派生类对象时首先为哪个分配空间？

是基类构造函数还是派生类构造函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T00:45:06.100

第一的，

*   *allocation*，您要询问的内存预留，与初始化不同并且在*初始化*之前（执行基本上在该内存中设置合适值的构造函数），并且

*   形式（我们的神圣标准）和实践中的差异在于*最派生对象的内存是否需要是连续*的，形式将“内存区域”定义为可能不连续，主要是为了支持多重虚拟继承.

也就是说，实际上，最派生的对象是单个连续的内存块，其中包括所有基类子对象和数据成员子对象的空间，并且这个块必须一次全部*分配。*

初始化（构造函数的调用）在分配之后进行。如果`new`初始化因抛出异常而失败，则表达式保证释放。但是，如果使用的分配函数具有额外的自定义参数（所谓的“新放置”）并且没有相应的释放函数可用，则此保证无效，例如 Microsoft 的 MFC 类框架的早期版本中的调试构建（这很讽刺：一个初始化失败的程序只会在调试版本中泄漏内存……）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:36:33.040

派生对象的空间包含所有派生成员和所有基础成员。派生对象只有一次分配，分配的内存保存对象的所有部分。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-22T00:34:56.407

如评论中所述，它是 Base 类。从逻辑上讲，由于您可以访问派生类（包括构造函数）中的基本公共和受保护成员，因此需要首先分配它。尝试从以下代码开始并尝试一下。

```
#include <iostream>

class Base
{
    public:
    Base() {std::cout<<"Base CTOR" << std::endl;}
};

class Derived : public Base
{
    public:
    Derived():Base() {std::cout<<"Derived CTOR"<<std::endl;}
};

int main(int argc, char* argv[])
{
    Derived d;
} 
```

# css - 不能让 div 一直向右浮动

> ID：12064829
> 
> 赞同：0
> 
> 时间：2012-08-22T00:20:07.227
> 
> 标签：css, html

为什么当我将#main div 向右浮动时，右边框与标题 div 的右边框不对齐？

```
* {
     margin: 0;
     padding: 0;
}

html, body {
     height: 100%;
}

#wrapper {
     width: 960px;
     height: 100%;
     margin: 0 auto;
}

#header {
     width: 960px;
     height: 70px;
     border: 1px solid black;         
     margin-bottom: 20px;
     margin-top: 20px;
}

#leftcol {
     width: 250px;
     height: 500px;
     border: 1px solid black; 
     float: left;
     margin-right: 20px;          
 }

 #main {  
    width: 686px;
    height: 500px;
    border: 1px solid black;
    float:right;
 } 
```

HTML

```
<html>
  <body>
    <div id="wrapper">
      <div id="header">
      </div>
      <div id="leftcol">
      </div>  
      <div id="main">
      </div>
    </div><!--end wrapper-->
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:36:15.330

正如@alfonso 指出的那样，边框正在增加 div 的实际大小。

最好`box-sizing: border-box`在所有带边框的元素上使用，以便边框进入内部。对齐变得容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:33:40.183

您忘记考虑标题的边框宽度。总的来说，你的标题的宽度是`960px`+`2px`从边框 = `962px`，而主要内容加上侧边栏的宽度是`960px`.

如果将标题的宽度设置为`958px`，则两个 div 对齐。

这是对 CSS 盒模型的参考，可帮助您进行数学计算：[CSS 盒模型](http://www.w3schools.com/css/css_boxmodel.asp)

# php - 在网站上存储列排序顺序的最佳方法是什么？

> ID：12064831
> 
> 赞同：0
> 
> 时间：2012-08-22T00:20:15.700
> 
> 标签：php, sql, sorting, pdo

这是我的表的样子：http: [//jsfiddle.net/Draven/kGtx7/14/](http://jsfiddle.net/Draven/kGtx7/14/)

每个标题单元格都是可点击的，以便能够按该字段和 ASC / DESC 进行排序。我希望能够将该排序选项存储在某处，以便记住它，但不确定最好的方法。

这是我在想的选项...

1.  表中的制作`sort_field`和`sort_order`字段`users`
2.  制作一个新表，其中`userid`包含`sort_field`和`sort_order`字段
3.  或 Cookie，但我认为这是最糟糕的选择

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:29:15.977

这留待解释，但每个案例都有自己的用途。

1）向表中添加两个字段`users`将使检索这些值的调用更容易，但它比解决问题的方法更丑陋。

..2) 建立关系数据库就是为了这样使用。我不确定性能，但我知道使用关系数据库的强大功能可以使您的数据库更易于导航和理解/操作。虽然您可能需要一些更复杂的调用（即加入等），但我相信这种权衡是值得的。

3) Cookies 是一个非常好的解决方案。它们可以在临时情况下使用，但如果您试图保存信息以备后用，cookie 可以很容易地被删除甚至不启用，此时您的网站可能会受到严重影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:34:13.693

我认为我们不清楚你想要什么，但我认为你想要这样的东西：

第 1 步：运行查询，然后将排序值填充到 2 个会话变量中。第 2 步：执行类似此代码的操作。

```
$sortHeadClicked = $_SESSION['headClicked']
$sortReturnDirection = $_SESSION['returnDirection']

//TODO: validate data before query

if ($result = $mysqli->query("SELECT * FROM table ORDER BY $sortHeadClicked $sortReturnDirection)) 
{
    //TODO: Get results
} 
```

第 3 步：像你的真棒一样微笑

或者，您可以使用某种子选择查询。

注意：这是简单的逻辑，因此在此示例中不会记住它们。但是，如果您只想暂时记住它们，则可以将 get 放入会话变量中

但是，如果您希望永久记住这些内容，则需要用户表中的两列，您可以将它们放入会话中或使用子选择查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T00:27:41.377

实际上，使用 cookie 存储用户会话 ID，然后将会话数据保存在数据库、平面文件或 memcached 中是解决此问题的常见方法。这将有助于为此建立一个可重用的机制，例如各种注册表，您可以随意检索每个用户的值。当然，这仅在您拥有用户登录名时才有效。否则，存储该数据毫无意义，因为一旦用户结束会话（关闭浏览器窗口），用户身份就会丢失。大多数网络应用程序将使用 cookie 来识别您的身份。如果您删除该 cookie，它会忘记您并退出。

如果您想为每个用户添加另一个“首选项”，那么您的第一个解决方案将会受到影响，因为您需要修改基础表。

如果您使用 PHP，请查看[Zend Session以获取想法。](http://framework.zend.com/manual/en/zend.session.html)如果不是，这些概念仍然适用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T00:27:56.567

恐怕这取决于您的需求。我如何看待这个问题：

1.  如果您必须在浏览器、PC 之间共享此设置，那很好，
    以防用户删除浏览器中的 cookie。但它不灵活 - 如果您需要添加另一个表，您还将添加两个额外的字段
2.  在计算机、浏览器等之间共享的方式与 1 相同，但更灵活。您可以轻松添加具有表名的列。
3.  如果此设置不是那么重要，并且在某些情况下您可以允许松散设置。此解决方案最简单，但可能对您不起作用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T00:30:19.627

要将排序顺序保存到他们的配置文件中，请在表单中制作表格并将可排序的字段名称设为`input`s。当他们单击其中一个字段名称（例如，按位置排序）时，让表单`action`运行一个 PHP 片段，以更新他们在数据库中的配置文件中的一个字段。

或者，如果能够使用 ajax，您可以简单地将数据库更新添加到 ajax 调用并跳过表单。

# php - 如何从我的根目录以外的不同目录上传文件，为什么我需要附加文件？

> ID：12064836
> 
> 赞同：0
> 
> 时间：2012-08-22T00:20:55.307
> 
> 标签：php, attachment, swiftmailer

我正在使用 PHP 和 Swiftmailer 开发一个邮件系统：看看我的脚本：

// **HTML 表单**

```
<form method="POST" action="mailer.php">

<label>Sender's Email:</label>
<input type="text" name="email" tabindex="1" placeholder="Sender's Email" required/>

<label>Subject:</label>
<input type="text" name="subject" tabindex="2" placeholder="Enter Email Subject" required />

<label>Attach File:</label>
<input type="file" name="attach" tabindex="3" value=" " />

<label for="Message">Message:</label><br />
<textarea name="message" tabindex="4" placeholder="Enter Message" rows="20" cols="20"></textarea>

<input type="submit" name="submit" value="Send" class="submit-button" />

</form> 
```

// **Mailer.php --> 邮件的消息部分**

```
$message = Swift_Message::newInstance()

->setSubject($_POST['subject'])

->setFrom($_POST['email'])

->setBody('<em>' . $_POST['message'] . '!</em>', 'text/html')

->addPart('Here is the message in plain text!', 'text/plain');

$message->attach(Swift_Attachment::fromPath($_POST['attach']));

$mailer->batchSend($message);` 
```

///////////////////////////////////////// ////////////////////////////////

我的两个问题是：

**1.当我从我的根目录以外的不同目录上传文件时，它给了我这个错误：**

> 警告：fopen(.open child's locket.jpg): failed to open stream: No such file or directory in C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php on line 125 致命错误：在 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php:126跟踪：#0 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php(75): Swift_ByteStream_FileByteStream->_getReadHandle() #1 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib \classes\Swift\Mime\ContentEncoder\Base64ContentEncoder.php(34): Swift_ByteStream_FileByteStream->read(8190) #2 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\SimpleMimeEntity.php(500): Swift_Mime_ContentEncoder_Base64ContentEncoder->encodeByteStream(Object(Swift_ByteStream_FileByteStream), Object(Swift_Transport_StreamBuffer), 0, 78) #3 C:\xampp\ htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\SimpleMimeEntity.php(517): Swift_Mime_SimpleMimeEntity->toByteStream(Object(Swift_Transport_StreamBuffer)) '#4 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\ 在 C:\xampp \htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php 在第 126 行\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\SimpleMimeEntity.php(517): Swift_Mime_SimpleMimeEntity->toByteStream(Object(Swift_Transport_StreamBuffer)) '#4 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\ in C :\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php 在第 126 行\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\SimpleMimeEntity.php(517): Swift_Mime_SimpleMimeEntity->toByteStream(Object(Swift_Transport_StreamBuffer)) '#4 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\ in C :\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php 在第 126 行

**2.当我不附加文件时（我应该允许用户这样做），它给了我这个错误：**

> 警告：fopen()：C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php 中的文件名不能为空，第 125 行致命错误：未捕获异常 'Swift_IoException' 并带有消息'无法打开用于在 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\FileByteStream.php:126 中读取 []' 的文件 堆栈跟踪：#0 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes \Swift\ByteStream\FileByteStream.php(75): Swift_ByteStream_FileByteStream->_getReadHandle() #1 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\ContentEncoder\Base64ContentEncoder.php(34): Swift_ByteStream_FileByteStream- >read(8190) #2 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\SimpleMimeEntity.php(500)：Swift_Mime_ContentEncoder_Base64ContentEncoder->encodeByteStream(Object(Swift_ByteStream_FileByteStream), Object(Swift_Transport_StreamBuffer), 0, 78) #3 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\SimpleMimeEntity.php(517): Swift_Mime_SimpleMimeEntity-> toByteStream(Object(Swift_Transport_StreamBuffer)) '#4 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\S 在 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\第 126 行的 FileByteStream.phptoByteStream(Object(Swift_Transport_StreamBuffer)) '#4 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\S 在 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\第 126 行的 FileByteStream.phptoByteStream(Object(Swift_Transport_StreamBuffer)) '#4 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\Mime\S 在 C:\xampp\htdocs\MailerProject_Test\SwiftMailer\lib\classes\Swift\ByteStream\第 126 行的 FileByteStream.php

# eclipse - 在 Eclipse 中使用搜索和替换，如何用多行字符串替换字符串

> ID：12064839
> 
> 赞同：0
> 
> 时间：2012-08-22T00:21:29.200
> 
> 标签：eclipse, sts-springsourcetoolsuite

![Eclipse 查找和替换](../Images/d6b645e8e5ad9ffc7e2dd1a32bff7f02.png)

使用 eclipse 搜索和替换功能，我将搜索单行字符串并将其替换为多行字符串。我已经尝试使用 \n 和 /n 插入新行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:27:12.790

![在此处输入图像描述](../Images/e5810c0a4d559e799dd0a609ba7aecc7.png)

您只需确保在执行搜索之前选中“正则表达式”框。然后在替换对话框中，您还将有一个必须选中的“正则表达式”框。然后在替换字符串中用换行符“\n”分隔每个新行。

例子：

```
<!-- Google Analytics -->\n     <script type="text/javascript">\n code\n 
```

# ruby-on-rails - ruby 创建文件中用户创建的对象使用什么数据类型

> ID：12064840
> 
> 赞同：0
> 
> 时间：2012-08-22T00:21:37.073
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我按照教程建立了一个简单的博客。但后来我想尝试一些更大的东西。所以我想做一个有评论和用户的博客。这意味着现在我的帖子需要一个用户和一系列评论。我的评论需要属于一个帖子，我的用户有很多帖子和评论。所以问题是在我的创建文件中我该如何处理。我只是使用字符串、文本和整数。但是对于数组和用户创建的模型它们是什么？这是一个[链接](https://gist.github.com/3420711)看代码的要点另外，如果我没有做任何看起来像潜在的坑洼的事情，请告诉我。其次，之前当我向模型添加一个新变量时，我发现如果我想更新架构，我必须 rake db:rollback 然后再次迁移。因为只是试图迁移到顶部并没有更新我的架构。有没有更好的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:38:30.303

不确定您正在遵循什么教程，但最好的博客应用教程可以在[官方文档](http://guides.rubyonrails.org/getting_started.html)中找到。

通读之后，您会发现您缺少模型对象的主要概念。

您将拥有三个模型：用户、帖子、评论。

模型看起来像这样：

用户

```
has_many :posts
has_many :comments 
```

邮政

```
belongs_to :user
has_many :comments 
```

评论

```
belongs_to :user
belongs_to :post 
```

在您的迁移中，您将简单地使用一个整数来定义belongs_to 关系。

在 Post 迁移中：（这将根据您进行迁移的方式而有所不同，但概念是相同的）

```
t.integer :user_id 
```

评论：

```
t.integer :user_id
t.integer :post_id 
```

通读指南，你会没事的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:38:10.127

`Post`应该`belong_to :user`而不是`has_one :user`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T00:41:12.817

您需要对数据库模式设计进行一些研究，但基本上您需要向表中添加外键并设置它们之间的关系。

例如，您的评论表将需要一个`user_id`整数。这将允许特定评论“指向”用户，因此您的应用程序知道谁写了评论。

然后在您的用户模型中，您应该添加以下内容：

```
has_many :comments 
```

在您的评论模型中：

```
belongs_to :user 
```

相同的基本思想可以应用于帖子。

# java - Java Play 框架解析 JSON 错误

> ID：12064844
> 
> 赞同：3
> 
> 时间：2012-08-22T00:22:07.007
> 
> 标签：java, json, google-app-engine, playframework, janrain

我想为我的 Play设置[Janrain身份验证！](http://rpxnow.com)托管在 GAE 上并使用 GAE 模块的项目。但是我在尝试登录时收到以下错误：

```
RuntimeException occured : Cannot parse JSON (check logs) 
```

Play 将以下行突出显示为错误：

```
JsonElement rpxJson = rpxRequest.get().getJson(); 
```

这是我用于令牌回调的方法：

```
public static void tokenCallback(String token) {
    Properties p = Play.configuration;
    // Try the driver
    String rpxApi = p.getProperty("login.rpx.apiKey");

    WSRequest rpxRequest = WS.url("http://rpxnow.com/api/v2/auth_info");
    // get RPX
    rpxRequest.setParameter("token", token);
    rpxRequest.setParameter("apiKey", rpxApi);

    JsonElement rpxJson = rpxRequest.get().getJson();
    JsonElement profile = rpxJson.getAsJsonObject().get("profile");
    String identifier = profile.getAsJsonObject().getAsJsonPrimitive("identifier").getAsString();

    welcome(identifier);

} 
```

这是我从终端得到的错误：

```
Internal Server Error (500) for request POST /login/tokencallback

Execution exception (In /app/controllers/Login.java around line 27)
RuntimeException occured : Cannot parse JSON (check logs)

play.exceptions.JavaExecutionException: Cannot parse JSON (check logs)
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:237)
    at Invocation.HTTP Request(Play!)
Caused by: java.lang.RuntimeException: Cannot parse JSON (check logs)
    at play.libs.WS$HttpResponse.getJson(WS.java:668)
    at controllers.Login.tokenCallback(Login.java:27)
    at play.mvc.ActionInvoker.invokeWithContinuation(ActionInvoker.java:557)
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:508)
    at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:484)
    at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:479)
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:161)
    ... 1 more
Caused by: com.google.gson.JsonSyntaxException: com.google.gson.stream.MalformedJsonException: Expected EOF at line 2 column 1
    at com.google.gson.JsonParser.parse(JsonParser.java:65)
    at com.google.gson.JsonParser.parse(JsonParser.java:45)
    at play.libs.WS$HttpResponse.getJson(WS.java:665)
    ... 7 more
Caused by: com.google.gson.stream.MalformedJsonException: Expected EOF at line 2 column 1
    at com.google.gson.stream.JsonReader.syntaxError(JsonReader.java:1310)
    at com.google.gson.stream.JsonReader.peek(JsonReader.java:390)
    at com.google.gson.JsonParser.parse(JsonParser.java:60)
    ... 9 more 
```

我能做些什么？请帮我解决这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T16:05:57.820

好的，这是我的第一个建议。尝试对 URL 使用 HTTPS 连接。我遇到了 HTTP 连接的一些问题。这是我进行 Janrain 连接的方法：

```
 WSRequest rpxRequest = WS.url("https://rpxnow.com/api/v2/auth_info");
        // get RPX
        rpxRequest.setParameter("token", token);
        rpxRequest.setParameter("apiKey", rpxApi);

        HttpResponse res = null;
        try {
            res = rpxRequest.post();
        } catch (JavaExecutionException ex) {
            Log.error("unknown error ", ex);
            Validation.addError("", "Unknown Error: please try again");
            Validation.keep();
            Secure.login();
        } catch (Exception ex) {
            Log.error("Most likely SSL error", ex);
            Validation.addError("", "SSL Error: please try again");
            Validation.keep();
            Secure.login();
        }
        if (res.getStatus() != 200) {
            Log.error("status 200 error");
            Validation.addError("", "Status 200 error: please try again");
            Validation.keep();
            Secure.login();
        }
        JsonElement rpxJson = res.getJson();
        JsonElement profile = rpxJson.getAsJsonObject().get("profile");
        JsonObject profileJson = profile.getAsJsonObject(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T06:53:30.263

调用 URL [http://rpxnow.com/api/v2/auth_info](http://rpxnow.com/api/v2/auth_info)后，它立即重定向到[https://rpxnow.com/api/v2/auth_info](https://rpxnow.com/api/v2/auth_info) (http **s** )。我怀疑您没有得到 JSON 答案，而是在您对 Web 服务的调用中得到了一个 http 重定向代码。

两种可能：

1）将网络服务调用更改为[https://rpxnow.com/api/v2/auth_info](https://rpxnow.com/api/v2/auth_info)，这可能会解决您的问题，但失败了；

2）将行更改`JsonElement rpxJson = rpxRequest.get().getJson();`为类似

```
HttpResponse httpResponse = rpxRequest.get();
Logger.log ( httpResponse.getString() ); 
if ( httpResponse.success() ) {
    JsonElement rpxJson = httpResponse.getJson();
} else {
    // fail gracefully
} 
```

并报告在第二行中记录的答案内容。

# mysql - 如何创建此查询？

> ID：12064845
> 
> 赞同：1
> 
> 时间：2012-08-22T00:22:29.860
> 
> 标签：mysql, sql, join

我有以下表格：

```
actions(id, name)
orders(refno, po)
order_actions(order, action) 
```

我想获取尚未执行特定操作的所有订单。订单可能包含或不包含操作。

假设我想获取所有尚未应用 action 的订单，`13`到目前为止我有这样的东西：

```
SELECT o.po, oa.action, 
    FROM orders AS `o`
    LEFT JOIN order_actions AS `oa` ON o.refno = oa.order
WHERE oa.action <> 13 
```

这适用于没有操作的订单，但如果订单的操作与`13`我得到误报不同，我是否错过了另一个涉及`actions`表的连接，可能是`GROUP BY`用于 po 或额外的`WHERE`子句？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:29:27.953

```
SELECT o.po, oa.action
FROM orders AS `o`
     LEFT JOIN order_actions AS `oa` ON o.refno = oa.order
WHERE NOT EXISTS (
  SELECT 1 
  FROM order_actions tmp 
  WHERE oa.order = tmp.order 
    AND tmp.action = '13'
) 
```

**[演示](http://sqlfiddle.com/#!3/6f5d1/2)**（sqlfiddle）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:59:08.743

您还可以使用 group by 和 having 子句解决此问题：

```
SELECT o.refno, o.po
FROM orders AS `o` LEFT JOIN
     order_actions `oa`
     ON o.refno = oa.order
group by o.refno, o.po
having max(case when oa.action = 13 then 1 else 0 end) = 0 
```

如果要跟踪此类订单的所有操作，可以使用 group_concat：

```
SELECT o.refno, o.po,
       group_concat(cast(ao.action) separator ', ') as AllOtherActions
FROM orders AS `o` LEFT JOIN
     order_actions `oa`
     ON o.refno = oa.order
group by o.refno, o.po
having max(case when oa.action = 13 then 1 else 0 end) = 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T02:07:06.523

另一种选择是：

```
select o.po
from orders as 'o'
    left join (
        select order from order_actions where [action] = @Action
        ) AS `oa` on o.refno = oa.order
where oa.order is null 
```

这不会返回您选择的订单的操作编号，但您已声明您只是在寻找尚未执行操作的订单，我在此将其称为 @Action

# php - 初级 PHP：Mail() 函数不起作用

> ID：12064846
> 
> 赞同：0
> 
> 时间：2012-08-22T00:22:46.853
> 
> 标签：php, email, smtp, gmail

我是 php 新手，所以请多多包涵。我已经为我正在创建的测试网站创建了一个注册。该网站收集用户信息，然后发送确认电子邮件。到目前为止，经过多次尝试，还没有收到任何电子邮件。我已经尝试过垃圾邮件文件夹，但无济于事。

这是我的代码：

```
$to = "$email";
    // Change this to your site admin email
    $from = "someperson@gmail.com";
    $subject = "Complete your registration";
    //Begin HTML Email Message where you need to change the activation URL inside
    $message = '<html>
    <body bgcolor="#FFFFFF">
    Hi ' . $username . ',
    <br /><br />
    You must complete this step to activate your account with us.
    <br /><br />
    Please click here to activate now &gt;&gt;
    <a href="http://testw.freevar.com/activation.php?id=' . $id . '">
    ACTIVATE NOW</a>
    <br /><br />
    Your Login Data is as follows: 
    <br /><br />
    E-mail Address: ' . $email . ' <br />
    Password: ' . $password . ' 
    <br /><br /> 
    Thanks! 
    </body>
    </html>';
    // end of message
    $headers = "From: $from\r\n";
    $headers .= "Content-type: text/html\r\n";
    $to = "$to";
    // Finally send the activation email to the member
    mail($to, $subject, $message, $headers,-f $from); 
```

提前致谢！

PS 我已经在网上阅读了关于 php.ini 文件夹的信息。我正在从头开始创建一个网站，但不知道这是什么或是否有必要。另外，我正在使用没有电子邮件地址的免费托管服务。我不确定这是否会影响它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:37:10.853

编辑：正如评论指出的那样，您的代码没有`$to`正确定义并且有语法错误。

* * *

确保您的 SMTP 服务器配置正确。这是用于发送（和接收但不适用）电子邮件的服务器，它的位置可能会写在托管服务的帮助/常见问题部分中的某个地方，如果他们提供的话。

php.ini*文件*用于为 PHP 服务器定义环境变量，例如 SMTP 服务器的位置。这些设置也可以在 PHP 中配置

```
ini_set('SMTP', 'smtp.example.com');
ini_set('sendmail_from', 'user@example.com');
ini_set('smtp_port','25'); 
```

按照您的主机提供商的说明修改域名、用户电子邮件和端口号。

# ruby-on-rails - 所有对象使用的方法在哪里？

> ID：12064852
> 
> 赞同：0
> 
> 时间：2012-08-22T00:23:32.190
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在开发一个 Rails 应用程序，我希望我的所有对象都有某种处理它们的方法。现在，虽然我意识到我可以在每个对象的模型中编写该方法，但我宁愿坚持 DRY（不要重复自己）理论并将该方法放在一个地方。

有没有一个地方我可以放置一个我所有的对象都可以访问的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:38:18.870

Ruby 和 rails 提供了许多选项，具体取决于您希望访问方法的对象。

ChiuBaka 的答案是一种选择，但 rails 尤其提供了许多更具可读性的选项。

如果您正在寻找控制器/视图级别的内容。您可以简单地将其放在 `app/helpers/application_helper.rb`文件中。如果您想限制访问，您可以在同一目录中创建特定于控制器的帮助文件。

如果你在看模型。您可以简单地创建一个从 继承的基础模型，在那里`activerecord::base`实现您的方法，然后让您的模型从那里继承。

```
class MyBase < ActiveModel::Base
  def myinstancemethod
  end

  def myclassmethod
  end
end 
```

然后

```
class MyModel < MyBase

end 
```

然后你可以这样打电话

```
instance = MyModel.new
instance.myinstancemethod 
```

或者

```
MyModel.myclassmethod 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:26:16.723

将所有模型中所需的代码放在 /lib 文件夹中的模块中，并在模型中使用它。

# android - android中JNI调用的命名约定是什么

> ID：12064854
> 
> 赞同：3
> 
> 时间：2012-08-22T00:23:51.283
> 
> 标签：android

例如，在 android Java 代码中，它调用了一个本地方法：

```
private native final String native_getParameters(); 
```

我应该在哪里/如何 grep C++ 方法在哪里定义`native_getParameters();`？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T00:36:40.370

C++ 方法还将包含您的命名空间（例如 com.domain.your）和类名（例如 YourActivity），它看起来像

```
JNIEXPORT jstring JNICALL Java_com_domain_your_YourActivity_native_1getParameters(JNIEnv * env, jclass clazz) 
```

注意 C++ _1 等同于 Java 方法中的 _

# spring - 我们应该使用 TDD 自动测试 spring 上下文吗？

> ID：12064857
> 
> 赞同：3
> 
> 时间：2012-08-22T00:24:07.063
> 
> 标签：spring, testing, spring-mvc, tdd

我在个人项目中使用 TDD。

因为我不应该在没有失败测试的情况下编写任何东西（代码、XML 配置、SQL 等等），所以我想知道如果我想设置 spring，我可以编写什么样的“单元”测试（它可能更像是一个集成测试） MVC。

假设我*想*在 spring-context.xml 文件中编写类似的内容：

```
<context:component-scan base-package="com.abc.controllers" />

<bean id="viewResolver"
    class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass"
        value="org.springframework.web.servlet.view.JstlView" />
    <property name="prefix" value="/WEB-INF/jsp/" />
    <property name="suffix" value=".jsp" />
</bean> 
```

你可以为“context:component-scan”添加一个测试吗？

您应该/可以在 bean“viewResolver”上测试什么？

这是我为测试编写的一些代码：

```
package com.abc.test.integration;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.web.servlet.view.UrlBasedViewResolver;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({ "file:web/WEB-INF/spring-servlet.xml" })
public class SpringServletContextConfigurationTest {

    @Autowired
    private ApplicationContext applicationContext;

    @Test
    public void TestControllerContextConfigurationIsNotNull() {
        assertNotNull(applicationContext);
    }

    @Test
    public void TestViewBeanResolverExists() {
        assertEquals(true, applicationContext.containsBean("viewResolver"));
    }

} 
```

关于这个“设置”还有什么我可以测试的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T14:55:30.680

请，每当你听到有人说：

> “永远不要在没有失败测试的情况下编写**任何**生产代码”

要么*忽略*他们，要么做我所做的，想象他们（正确地）说：

> “永远不要在没有失败测试的情况下编写任何**域逻辑”。**

请不要担心您的 Spring 配置。如果你猜错了，你猜怎么着？当您尝试使用它时，您的应用程序将无法运行。如果发生这种情况，您只需进行修复并继续前进。世界上没有任何测试可以拯救你。你已经标记了这个关于 TDD 的问题。这是一个秘密，TDD*与测试几乎没有什么关系*。您获得一套自动化测试来捕获回归的事实是一个奖励。TDD 更像是一个设计过程。无论您进行多少自动化，**仍然需要手动测试**。

如果你有一些端到端的测试，它们只是作为[冒烟测试](http://en.wikipedia.org/wiki/Smoke_testing)，你会在你破坏 Spring 配置时立即注意到。只需比较您的源代码控制，您就会立即看到您所做的更改。

# java - 图深度优先搜索有时有效，有时无效

> ID：12064872
> 
> 赞同：2
> 
> 时间：2012-08-22T00:27:55.323
> 
> 标签：java, data-structures, graph, depth-first-search

所以我写了一个 Graph 类，我似乎无法根据节点的顺序正确地对其进行深度优先搜索。这就是我的意思：

如果我的图表如下所示：

```
A-B-D
|/
C 
```

DFS 返回：“ABC”

但是当它看起来像这样时：

```
A-B
| |
D C
|
E 
```

它将正确打印 ABCDE。

我发现的问题在于我的 getUnvisitedAdjacentNode() 函数。这是功能：

```
 public int getUnvisitedAdjacentNode(int n) {
    for (int i = 0; i < this.nodeList.size(); i++) {
        if (this.edges[n][i] == 1 && this.nodeList.get(i).wasVisited == false) {
            return i;
        }
    }
    return -1;
} 
```

我发现的问题是因为它按“顺序”进行（只是一个 for 循环），在第一种情况下它永远不会遍历 D，因为 B 被访问并且在 C 被访问后，B 只是从堆栈中弹出. 也许这不是问题。

这是我实际的 DFS 遍历的代码。

```
 public void depthFirstTraverse() {
    Stack<Node> stack = new Stack<Node>();

    nodeList.get(0).wasVisited = true;
    System.out.println(nodeList.get(0).item);
    stack.push(nodeList.get(0));

    while (!stack.isEmpty()) {
        int nextNode = this.getUnvisitedAdjacentNode(stack.peek().index);

        if (nextNode == -1) {
            stack.pop();
        } else {
            nodeList.get(nextNode).wasVisited = true;
            System.out.println(nodeList.get(nextNode).item);
            stack.push(nodeList.get(nextNode));
        }
    }
    for (int i = 0; i < nodeList.size(); i++) {
        nodeList.get(i).wasVisited = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:51:05.223

幸运的是我发现了自己的错误，上面的代码都是正确的，只是在我没有粘贴的代码中。

万一有人关心，问题在于我完全无视 ArrayLists 有一个“IndexOf()”方法这一事实（我知道这很愚蠢）并决定将我自己的“索引”字段破解到我的 Node 类中。在处理我自己的索引时，我遇到了一个小错误，它搞砸了遍历。

所以我的 DFS 算法中的旧行如下所示：

```
int nextNode = this.getUnvisitedAdjacentNode(stack.peek().index); 
```

但它应该是：

```
int nextNode = this.getUnvisitedAdjacentNode(this.nodeList.indexOf(stack.peek())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:41:27.383

你说的。如果你从堆栈中弹出一个节点，你需要确保它**所有**未访问的邻居都在堆栈上。否则，不能保证每个人都会被访问。

例如，在您给出的第一张图中，如果首先访问节点 A，然后访问节点 B，则接下来将访问节点 C 或 D。但是，如果您只将其中一个压入堆栈，然后移除 B，则无法到达最后一个。

因此，您可能想要编写一个函数 getAllUnvisitedAdjacentNodes 并在弹出之前将它们**全部压入堆栈。**

# html - 流体宽度/ CSS问题

> ID：12064874
> 
> 赞同：1
> 
> 时间：2012-08-22T00:28:05.630
> 
> 标签：html, css, xhtml

我正在尝试布局一个站点：

[http://kenzshop.com/Brandon/index](http://kenzshop.com/Brandon/index)

我无法正确对齐主要内容区域（蓝色）。

标题（红色）有一个流体，侧边栏（黄色）有一个流体高度，主要内容区域应该是流体宽度和高度，但我不知道如何让它正确对齐。

它应该与标题在宽度上对齐。

谁能看到我的问题是什么？

HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>Title of document</title>
<meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8"></meta>
<meta http-equiv="Content-Type" content="text/css; charset=utf-8"></meta>
<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>
   <div id="header"></div>
   <div id="main"><!--<iframe src="http://www.cnn.com/"/> --></div>
   <div id="sidebar"></div>
</body>

</html> 
```

CSS：

```
body {
   margin:0;
   padding:0;
   height:100%; 
}

#header{
   height: 80px;
   border: 1px solid black;
   padding: 5px;
   margin-top: 5px;
   margin-left: 5px;
   margin-right: 5px;
   background-color:red;
}

#main{
   position:absolute;
   left:0;
   top:90px;
   right: 263px;
   padding:0;
   margin-top: 12px;
   margin-left: 5px;
   margin-bottom:5px;
   height:99% !important; /* works only if parent container is assigned a height value */
   width:100%;
   border:1px solid black;
   background-color:blue;
}

iframe{
   margin: 5px;
   display:block; 
   width:100%!important; 
   height:100%!important;
}

#sidebar{
   position:absolute;
   right:0;
   top:102px;
   padding:0;
   margin-right:5px;
   margin-bottom:5px;
   width:250px;
   height:99%; /* works only if parent container is assigned a height value */
   border:1px solid black;
   background-color:yellow;
} 
```

![指示](../Images/1979124f0d847948b1c72ca5d33452ae.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:47:51.113

像这样的东西？

HTML：

```
<div id="header"></div>
<div id="main"></div>
<div id="sidebar"></div>​ 
```

CSS：

```
​#header {
    height: 60px;
    background: red;
    margin-bottom: 10px
}
#main {
    width: 68%;
    background: blue;
    float: left;
    height: 800px;
}
#sidebar {
    width: 30%;
    background:yellow;
    float: right;
    height: 800px;
}​ 
```

和[小提琴](http://jsfiddle.net/jHnWp/)

PS 不确定是基于您当前的网站还是您发布的图片，因为两者似乎都遵循不同的概念。暂时做了图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T02:30:40.440

由于它们几乎没有变量，这很容易通过依赖来解决`position: absolute`，而不会影响灵活性。

的HTML：

```
<header class="header"></header>

<div class="content">
    <iframe src="http://www.cnn.com/"></iframe>
</div>

<div class="sidebar"></div> 
```

CSS：

```
* {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

.header,
.content,
.sidebar {
  position: absolute;
  border: 1px solid black;
}

.header {
    top: 5px;
    right: 5px; 
    left: 5px; 
    height: 80px;
    background: red;
}

.content,
.sidebar {
    top: 90px;
    bottom: 5px;
}

.content {
    left: 5px;
    right: 260px;
}

.content iframe {
    width: 100%;
    height: 100%;
}

.sidebar {
    right: 5px;
    width: 250px; 
    background: green;
} 
```

看看这里：http: [//jsfiddle.net/joplomacedo/WBRCj/](http://jsfiddle.net/joplomacedo/WBRCj/) ​</p>

# email - 如何配置 php.ini 以便我可以使用 mail() 函数

> ID：12064876
> 
> 赞同：1
> 
> 时间：2012-08-22T00:28:23.837
> 
> 标签：email, php

所以我可以尝试通过自动系统发送电子邮件，但我需要设置我的 php.ini 文件才能这样做。我真的不知道该怎么做，所以如果你能帮忙那就太棒了！我必须创建一个新的 php.ini 文件，因为我是从 winhost 租用的。如果您需要任何东西，请告诉我，非常感谢！

更新 - - - -

我已经设置了 SMTP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:41:08.140

嘿，我想通了，所以对于使用 WinHost 有同样问题的任何人，只需使用此代码

```
$from = "Sender <postmaster@HostingAccountDomain.com>"; 
$to = "Recipient <user@HostingAccountDomain.com>"; 
$subject = "This is a test email sent via php"; 
$body = "This is a test email"; 
$host = "mail.HostingAccountDomain.com"; 
$username = "postmaster@HostingAccountDomain.com"; 
$password = "email_password"; 
$headers = array ('From' => $from, 
  'To' => $to, 
  'Subject' => $subject); 
$smtp = Mail::factory('smtp', 
  array ('host' => $host, 
  'auth' => true, 
  'username' => $username, 
  'password' => $password)); 
$mail = $smtp->send($to, $headers, $body); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:46:59.333

例如，我从中获取网络托管服务的服务器（即[MediaTemple](http://mediatemple.net/)）需要将**sendmail_from**设置为该域中的现有电子邮件地址。所以我在我的脚本中使用下面的代码和我的地址。

```
ini_set('sendmail_from', 'mail@yourdomain.com'); 
```

无论如何，如果没有这个，它就不会发送任何电子邮件。检查您的问题是否与此有关。

# c# - 使用 lambda 表达式调用字典键对象的方法

> ID：12064878
> 
> 赞同：2
> 
> 时间：2012-08-22T00:28:36.870
> 
> 标签：c#, linq, lambda

如果我有类似的东西：

```
Dictionary<SomeObject, SomeOtherObject> _mydictionary 
```

并`SomeObject`有一个方法：`SomeMethod()`

如何在`SomeMethod()`不将键转换为列表并执行 ForEach 的情况下使用 lambda 表达式调用该方法。这`ToList()`使得它太贵了。或者，在 lambda 中等效于：

```
foreach(SomeObject o in _mydictionary.Keys)
  o.SomeMethod(); 
```

？？？

我试过了：

```
_mydictionary.ToList().ForEach(x => x.SomeMethod()); 
```

但这似乎太贵了`ToList();`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:58:45.427

使用[反应式扩展（Rx）](http://msdn.microsoft.com/en-us/data/gg577609)：

```
var keys = _mydictionary.Keys;
// convert the enumerable sequence of keys to an observable sequence
var observableKeys = keys.ToObservable ();
// invoke SomeMethod for each key
await observableKeys.ForEachAsync (obj =>
    obj.SomeMethod ()); 
```

在调用第一个 SomeMethod 之前，此代码将在不阻塞枚举序列的调用的情况下执行，并且不会分配另一个集合。

不幸的是[，我们正在等待](http://social.msdn.microsoft.com/Forums/en-US/rx/thread/651edc24-452a-44ba-8f5a-46129bcea559)交互式扩展 (Ix) 的新版本，它具有完全相同的功能，而无需从可枚举序列转换为可观察序列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:33:56.693

没有内置的扩展方法来调用`void`方法集合，无论是委托还是对象集合的成员。

但是，您可以相对轻松地创建一个：

```
public static void ForEach<T>(this IEnumerable<T> items, Action<T> action)
{
  foreach (var item in items) action(item);
} 
```

现在您可以以 LINQish 方式调用所有这些方法：

```
_mydictionary.Keys.ForEach(x => x.SomeMethod()); 
```

您已经可以访问 ; 上的`.Keys`集合属性`IDictionary<TKey,TValue>`。你不需要在`.ToList()`任何地方打电话。

* * *

如果`SomeMethod()`是一个函数，并且你想创建一个结果集，那么你可以使用内置的扩展方法`Select()`：

```
var results = _mydictionary.Keys.Select(x => x.SomeMethod()); 
```

正如乔治正确指出的那样，`SomeMethod()`除非需要，否则不会被调用 - 也就是说，除非您通过迭代它们来实际使用结果。这可以避免创建新集合的开销，但应注意避免多次枚举。

# c++ - 跨多个 Cpp 文件使用变量

> ID：12064879
> 
> 赞同：0
> 
> 时间：2012-08-22T00:28:48.130
> 
> 标签：c++, scope, header-files, ld, extern

已经搜索了足够的答案，但没有一个解决方案对我有用。

场景：我试图包含一个 .h 文件，其中声明了一些函数（未定义）和一些变量。

如果我在实际使用函数和变量的源文件（准确地说是 2）中包含这个头文件，那么最后一个编译的文件会出现链接器错误，指出

> 未定义对 `abc::myfun(char const*, char const*, char*)' 的引用

头文件中的所有函数和变量都已声明为 extern 并且存在包含保护。

我希望有一个 cpp 文件在 .h 文件中定义的变量中放入一个值，另一个 cpp 文件能够读取它。

此外，如果有帮助，我的每一段代码都在我定义的命名空间中 ( `namespace abc{ //all my code, in all the files }`)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:35:25.320

您`.h`文件中的声明正是这样做的 - 让编译器知道您计划*声明*“某处”*的对象。***该“某处”将是定义**该变量的编译单元（一个或文件） 。*`.c``.cpp`*

 ***这是一个示例（为简单起见，跳过守卫）：

`foo.h`：

```
extern int global_foo; 
```

`foo.c`：

```
#include "foo.h"
int global_foo; // optionally you can initialize like this: int global_foo = 123; 
```

`main.c`：

```
#include "foo.h"
void bar()
{
  global_foo = 0; // accessing that variable which is "outside" of this file 
```

正如上面提到的稻田 - 确保您不会意外嵌套命名空间，因为`abc::something`它与`abc::abc::something`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:11:51.243

您的错误似乎与`abc::myfun(char const*, char const*, char*)`. 我能够重现并确认这一点。如果没有第二部分，您将收到错误消息。

我猜你有一个类似的头文件

```
namespace abc 
{
    void myfun(char const* p1, char const* p2, char* p3);
} 
```

和一个 .cpp 源文件需要

```
namespace abc
{
    void myfun(char const* p1, char const* p2, char* p3)
    {
        // do fun stuff
    }
} 
```***

# php - 什么会阻止 WordPress 向非本地电子邮件地址发送电子邮件？

> ID：12064881
> 
> 赞同：0
> 
> 时间：2012-08-22T00:29:00.780
> 
> 标签：php, wordpress, iis, exchange-server

我已经使用**PHP5.3/FastCGI 和 MySQL（Windows 7/IIS 7.5）**在我的本地机器上设置了我们的博客...（仅供参考 - 我是 Windows 服务器和 IIS 的新手）

我收到此消息： *无法发送电子邮件。可能的原因：您的主机可能禁用了 mail() 功能...*当同事单击“wp-login”页面上的“丢失密码”链接时。

我通过“php.ini”定义了我们网络的邮件服务器，瞧！- 丢失密码的电子邮件有效。——至少我是这么想的。

事实证明，诸如丢失密码和新用户（密码）之类的电子邮件只会成功发送给使用我们邮件服务器的 url 地址 (johndoe@horsepowerfreaks.com) 的用户

**所以我的问题是：为什么 WordPress 不能将电子邮件发送到我们域之外的电子邮件地址？我知道人们首先会猜测（正如我所知道的）这与我们的邮件服务器（Microsoft Exchange Server）有关......**

这可能与WP的配置有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:34:44.300

这几乎可以肯定是 Exchange SMTP 服务器的安全配置问题，而不是 WordPress。看看这个：

[http://terenceluk.blogspot.com/2011/10/unable-to-relay-mail-to-external-domain.html](http://terenceluk.blogspot.com/2011/10/unable-to-relay-mail-to-external-domain.html)

# apache - 使用 WebSockets 的后端服务器的 Apache 重定向规则

> ID：12064882
> 
> 赞同：2
> 
> 时间：2012-08-22T00:29:11.410
> 
> 标签：apache, mod-rewrite, redirect, websocket, cherrypy

我试图弄清楚如何为实现 websocket 的后端 CherryPy 服务器正确设置 apache 重定向规则（通过 ws4py 模块完成）。问题是，如果您使用重写引擎或 proxypass，它会在重定向请求中剥离**Upgrade**标头，因此 CherryPy 服务器会抱怨它并在握手步骤失败。

我的情况如下。我有带有 ws4py 模块的 CherryPy 服务器，它设置了 WebSockets。它在 localhost:9000 上运行。我想要一个 apache 前端，它只是将传入的请求重定向到后端服务器（它做的不止这些，但为简单起见，它应该这样做）。

我的 apache 规则很简单

```
RewriteRule ^(/websocket(/.*)?)$ http://some_host:9000$1 [P,L] 
```

所以对于所有以 /websocket 开头的请求，它会将它们重定向到在端口 9000 上运行的后端服务器。P 标志代表代理，L 停止重写过程（参见[http://borkweb.com/story/apache-rewrite-cheatsheet](http://borkweb.com/story/apache-rewrite-cheatsheet) )

如果客户端发送带有 HTTP 标头**Upgrade:websocket**的请求，Apache 引擎（重写模块）会将其剥离，这会导致 WebSocket 握手失败。

有没有办法修复重写规则以允许**升级**标头的存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T16:31:15.863

不幸的是，Apache 还没有能力反向代理 WebSocket 连接（它绝对应该！）。但是有一个解决方案允许使用 Apache 和 WebSocket 连接来处理 Web 请求，并由其他东西来处理。该解决方案涉及使用 HAProxy 作为 apache 和 WebSocket 服务器的前端。

这里有几个相关链接可以帮助您入门：

*   [http://lheurt.blogspot.com/2011/12/reverse-proxy-nodejs-websockets-with.html](http://lheurt.blogspot.com/2011/12/reverse-proxy-nodejs-websockets-with.html)
*   [HAProxy + WebSocket 断开连接](https://stackoverflow.com/questions/4360221/haproxy-websocket-disconnection)

# python - 尝试使用 smtplib 发送 excel 附件时出错

> ID：12064883
> 
> 赞同：1
> 
> 时间：2012-08-22T00:29:15.200
> 
> 标签：python, email-attachments, smtplib

我正在尝试使用 python 中的 smtplib 发送一封带有 excel 文件的电子邮件。我收到一条错误消息： `TypeError: 'str' object is not callable`

这是我的代码：

```
email_message = email.MIMEMultipart.MIMEMultipart('mixed')
excel_attach = email.mime.base.MIMEBase('application','vnd.ms-excel')

# Gives error "TypeError: 'str' object is not callable"
excel_attach.set_payload(file(absolute_file_location).read())

email.encoders.encode_base64(excel_attach)
excel_attach.add_header('Content-Disposition','attachment;filename={0}'.format(file))
email_message.attach(excel_attach) 
```

为什么这不起作用？

**编辑**：这似乎是错误的根源`file(absolute_file_location).read()`...... 我已经通过将它放在不同的行来确定这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:58:20.810

有问题`file(absolute_file_location).read()`

我不知道问题出在哪里，但是通过执行以下操作来获取内容...

```
content = None
with open(file, 'r') as f:
  content = f.read()
  f.close()

excel_attach.set_payload(content) 
```

按预期工作。

# c++ - C++ 使用类从多维向量中输出一个字符数组

> ID：12064891
> 
> 赞同：2
> 
> 时间：2012-08-22T00:30:43.577
> 
> 标签：c++, stl, stdvector

这是我第一次在 Stackoverflow 上提问。

当我使用 char 数组和类时，我无法获得多维向量来输出数据。

下面的代码输出了意外的字符，如“「”和“[B”，尽管我希望它打印“234987 NAME MESSAGE1?1030”。

有谁能够帮助我？谢谢。

```
#include <iostream>
#include <vector>

using namespace std;

class test{
public:
  test();
  void output();
private:
  std::vector< std::vector<char*>>  Message_detail;
};

test::test(){
  int i = 0;
  int j = 0;
  char input[] ="USERID=234987+USERNAME=NAME+MESSAGE=MESSAGE1?+TIME=1030&USERID=12304234+USERNAME=NAME2UKI+MESSAGE=HIII+TIME=1330&USERID=1376321+USERNAME=JONES12+MESSAGE=GENKI DAYO+TIME=1025";
  char * pch;
  pch = strtok (input,"+=&");
  Message_detail.push_back( vector<char*>() );
  while (pch != NULL)
  {
    if((int)Message_detail[j].size() == 4){
      Message_detail.push_back( vector<char*>() );
      j++;
    }
    if(strlen(pch) < 1){
      Message_detail.pop_back();
    }
    if(i % 2 != 0){
      Message_detail[j].push_back(pch);
    }
    i++;
    pch = strtok (NULL, "+=&");
  } 
}

void test::output(){
  for(vector<char*>::size_type i = 0; i < Message_detail.size(); i++){
    for(vector<char*>::size_type j = 0; j < Message_detail[i].size();    j++){  
      std::cout << Message_detail[i][j] << endl;
    }
  }
}

void main(){
  test hello;
  hello.output();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:41:13.367

`char input[]`是一个**局部变量**，这意味着它在`}`构造函数的末尾过期。向量中的所有指针都指向该局部变量的位置。如果您将代码更改为`static char input[]`或使用全局数组等，代码应该可以正常工作，因为您现在已确保该数组在程序的生命周期内存在。

其他注意事项：

*   更改`void main()`为`int main()`符合 C++ 的程序。
*   我没有看到`#include <cstring>`for`strtok`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:24:52.783

以下输出：

> 命名信息 1？1030 12304234 NAME2UKI HIII 1330 1376321 JONES12 GENKI DAYO 1025

正在使用以下程序生成：

```
#include <cstdio>
#include <cstring>

int main ()
{
    char * pch;
    char input[] ="USERID=234987+USERNAME=NAME+MESSAGE=MESSAGE1?+TIME=1030&USERID=12304234+USERNAME=NAME2UKI+MESSAGE=HIII+TIME=1330&USERID=1376321+USERNAME=JONES12+MESSAGE=GENKI DAYO+TIME=1025";
    pch = strtok (input,"U");
    while (pch != NULL)
    {
        pch = strtok (NULL, "=");      
        if ( pch == NULL ) break;
        pch = strtok (NULL, "+&");      
        printf ("%s\n",pch);
    }
    getchar();
    return 0;
} 
```

它虽然不使用多维向量。

# lotus-domino - 如何在 Lotus Domino DB 中归档数据并将附件保存在 DAOS 中

> ID：12064894
> 
> 赞同：0
> 
> 时间：2012-08-22T00:31:20.100
> 
> 标签：lotus-domino, archiving

我在服务器故障中记录了[以下问题](https://serverfault.com/questions/419846/daos-estimator-run-on-large-lotus-notes-database#comment446626_419846)，建议我记录与该问题相关的开发问题，所以在这里。

我有一个使用 LS 方法 CopyToDatabase 归档的 Lotus Domino DB。我即将在数据库上实施 DAOS，并且需要确保在将附件复制到存档时保留附件。

回答第一个问题的人建议这样不行，我会丢失附件。谁能建议如何对存档进行编码（我只能想到使用 CopyToDatabase）以确保附件不会丢失？

我曾假设 Domino 会：

*   运行 CopyToDatabase 时将附件数据从 DOAS 移动到 Domino。
*   如果将附件数据复制到的数据库也启用了 DAOS，则将附件数据移回 DOAS。

谢谢，

一种

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T06:09:31.550

这确实是一个管理问题，但推理确实涉及从开发人员的角度理解事物，所以在这里问是非常合理的。

DAOS 对所有级别的 Notes 代码都是 100% 不可见的。不管是 LotusScript、Java 还是 Notes C API。代码 100% 不知道 DAOS。您实际上无法编写直接处理 DAOS 对象的特殊代码。

所以，你的假设基本上是正确的。您只是没有提及删除附件的实际部分，以及其他一些杂项细节。

即，如果您要复制到的存档数据库与源数据库存在于同一台服务器上，并且两者都启用了 DAOS，那么即使您从源数据库中删除附件，该附件仍将保留在 DAOS 中。

但是，如果您要复制到的存档数据库在不同的服务器上，或者如果它在用户的本地硬盘驱动器上，并且如果附件也不存在于服务器上其他启用 DAOS 的数据库中，那么附件将从 DAOS 中删除。这将在您从源数据库中删除文档（或仅附件）之后的下一次 DAOS 清除中发生。

# jquery - Yii jQuery ajax 成功在正常响应之前返回“数据”变量中的巨大链接

> ID：12064896
> 
> 赞同：1
> 
> 时间：2012-08-22T00:31:42.687
> 
> 标签：jquery, ajax, amazon-web-services, yii

在我的 Yii 网站中，我使用 jQuery ajax 从 Amazon AWS 服务中提取一些数据。除了 ajax 响应外，一切正常。在我的控制器操作中，我从亚马逊获取数据，如下所示：

```
$jdata = $this->amazonProxyRequest(); 
```

之后，`$jdata`包含我需要的所有数据的关联数组行。

例如，我现在需要提取第一行并将其“回显”为 ajax json 响应。我愿意：

```
$jt_data = CJSON::encode($jdata[0]); 
```

该`$jt_vata`变量现在包含一个有效的 JSON，根据调试器，我正在粘贴，它是

```
"{"id":"1","author":"Leo Tolstoy","title":"War and Peace (Cambridge World Classics) Critical Edition (Annotated) (Complete Works of Leo Tolstoy \/ Complete Works of Leo Tolstoi)","publisher":"Cambridge World Classics","isbn":"","year_published":"2010-11-30"}" 
```

到目前为止，一切都很好。然后在我看来，我想使用这些数据。`data`仅出于测试目的，我要求“成功”选项使用我已传递给该方法的变量触发警报。

```
'onblur'=> CHtml::ajax(array(
     'url'=>Yii::app()->createUrl('book/searchAmazon'),
     'type'=>'post',                                                        
     //'dataType'=>'json',
     'data'=>array('title' => 'js:this.value'),
     'success' => "js:function(data)
                {
                   alert(data);
                }",
     'error' => "function(data, status){ alert(status); }",
 )) 
```

如果我取消注释，`'dataType'=>'json'`我会得到一个`parsererror`，我知道为什么。函数中的`data`变量**确实**包含我的 JSON 数据，但之前附加的亚马逊网络服务还有一个非常巨大的 GET 请求字符串。所以显示包含的警报`success`**`alert(data)`**

 **```
http://ecs.amazonaws.com/onca/xml?AWSAccessKeyId=MyAccessKey&AssoSignature=
... etc ...
DrJzWb73c08V5yffKUkFOu63Y4w%2FtIEc%2FtlVVjBKrUY%3D{"id":"1","author":
"Leo Tolstoy","title":"War and Peace (Cambridge World Classics) 
Critical Edition (Annotated) (Complete Works of Leo Tolstoy \/ Complete Works of Leo
Tolstoi)","publisher":"Cambridge World Classics","isbn":"","year_published":
"2010-11- 30"} 
```

即使我不做

```
echo CJSON::encode($jdata[0]); 
```

在控制器中，我仍然在警报中获得 GET 字符串，但没有附加任何 JSON。摆脱长字符串的唯一方法是评论

```
$jdata = $this->amazonProxyRequest(); 
```

这当然是不可接受的。

**问题：**

如果您告诉我此链接来自哪里，我将不胜感激？

我试图自己解决这个问题，但我没有成功。**

# java - 活动之间的Android 4.1 NullPointerException

> ID：12064900
> 
> 赞同：-1
> 
> 时间：2012-08-22T00:32:03.027
> 
> 标签：java, android, mobile, null, android-activity

在活动之间切换时，我不断在 Android 4.1 中抛出 NullPointer 异常。关于为什么的任何想法？

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_launch);

    Button login = (Button)findViewById(R.id.login_button);
    Button join = (Button)findViewById(R.id.join_button);  

    login.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
        Intent i = new Intent(LaunchActivity.this, LoginActivity.class);    
        startActivity(i);   
        }});//END OF CLICK

    join.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
        Intent i = new Intent(LaunchActivity.this, JoinActivity.class); 
        startActivity(i);   
        }});//END OF CLICK

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:08:56.573

根据您的问题描述，我假设您收到此错误，因为您没有将 LoginActivity 和 JoinActivity 这两个活动添加到您的 AndroidManifest.xml 中。只需将它们添加到 AndroidManifest.xml 中，如下所示，

```
<activity android:name=".LoginActivity"></activity>
<activity android:name=".JoinActivity"></activity> 
```

# core-plot - 如何将 Core-Plot X 标签转移到刻度之间？

> ID：12064901
> 
> 赞同：1
> 
> 时间：2012-08-22T00:32:07.833
> 
> 标签：core-plot

如何将 X 轴标签的文本向右移动（水平）？我希望能够在两个 x-tick 之间显示一个字符串（例如，| Jan | Feb |...），而不是默认情况下跨越 x-tick。

我尝试了以下方法：

```
newLabel = [[CPTAxisLabel alloc] initWithText:item.month textStyle:x.labelTextStyle];
newLabel.tickLocation = [[NSDecimalNumber numberWithInt:index] decimalValue];

CGPoint myPoint = newLabel.contentLayer.position;
CGFloat x = myPoint.x;
CGPoint yourPoint = myPoint;
yourPoint.x += 16.0;

[newLabel positionBetweenViewPoint:myPoint andViewPoint:yourPoint forCoordinate:CPTCoordinateX inDirection:CPTSignPositive]; 
```

...但我收到一个 SIGABRT 错误（崩溃）。
一个例子值一千字。

问候， 里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:16:19.990

目前没有简单的方法可以做到这一点。您需要使用自定义标签。将轴标签策略设置为`CPTAxisLabelingPolicyNone`并设置所需的刻度位置和标签。有关一些示例代码，请参阅 Plot Gallery 应用程序中的[标签策略演示](http://code.google.com/p/core-plot/source/browse/examples/CorePlotGallery/src/plots/LabelingPolicyDemo.m#75)。

# php - 使用 PHP 中的复选框链接多个文件上传

> ID：12064903
> 
> 赞同：-1
> 
> 时间：2012-08-22T00:32:18.690
> 
> 标签：php, file-upload, checkbox

我想将多个文件上传与 php.ini 中的复选框链接起来。

这就是我所拥有的：

```
<input type="file" name="file_upload[]"  /> <input type="checkbox" name="checkbox[]" value="1"> linked to file-upload 1 <br/>
<input type="file" name="file_upload[]"  /> <input type="checkbox" name="checkbox[]" value="1"> linked to file-upload 2 <br/>
<input type="file" name="file_upload[]"  /> <input type="checkbox" name="checkbox[]" value="2"> linked to file-upload 3 <br/>
<input type="file" name="file_upload[]"  /> <input type="checkbox" name="checkbox[]" value="3"> linked to file-upload 4 <br/> 
```

我想在上传文件并在 PHP 中选中相关复选框时做一些事情，如何将文件输入类型与复选框链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:45:33.210

您可以将它们组合在一个名称数组下。

```
<input type='file' name='combined[1][file]'/>
<input type='checkbox' name='combined[1][check]'/> 
```

可以通过以下方式在 php 中访问：

`$_REQUEST['combined'][1]['file']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:50:37.367

为上传元素和复选框分配相同的名称作为数组

```
<input type='file' name="element_one" />
<input type=checkbox' name='checkbox[]' value='element_one'/>
//then is the submitted script you might have 
$checkboxes = $_POST['checkbox'];
if(in_array('element_one',$checkboxes)){

   //elementone checkbox was selected so expect that some has been uploaded through  element_one file input box
} 
```

# java - 在 Java 中处理 Python IO

> ID：12064904
> 
> 赞同：2
> 
> 时间：2012-08-22T00:32:22.447
> 
> 标签：java, python, command-line, io

我目前正在开发一个 Java 项目，该项目允许我进行文本编辑、保存，然后执行 Python 代码。但是，我在执行此代码时遇到了障碍。

为了执行代码，我一直在执行以下操作：

```
Process p = Runtime.getRuntime().exec("python someFileName.py",null,new File("someFilePath"); 
```

从这里，我有一个接受这个过程的类，并尝试从这个过程中获取输入和输出流。我有一个带有动作监听器的计时器集，它将每 0.01 秒刷新一次。

然而，这不是问题。如果我的程序仅包含 python 中的打印语句，我可以很好地接收输入。

如果我的程序包含任何需要阻止的内容，无论是 raw_input 还是 time.sleep，都不会显示任何内容。

我的 actionPerformed 方法如下：

```
public void actionPerformed(ActionEvent e)
{
    try
    {
        while(inStream.available() > 0)
        {
            System.out.print((char)inStream.read());
        }
        while(errStream.available() > 0)
        {
            System.out.print((char)errStream.read());
        }
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
} 
```

为了处理输出，我在 JTextArea 上有一个 KeyListener，它将将该区域的内容发送到输出流。

每当我的 Python 程序中有任何需要阻塞的东西时，**无论在程序中的哪个位置，**整个东西都会被锁定。

例如，我有这个 python 程序：

```
import time

print "Welcome to my Program!"
print "Performing calculations"
time.sleep(5)
num = 5
print "Adding 5 to your number"
for x in range(5):
    num+=1
    print num
print "Finished!" 
```

在它休眠的时间内什么都不会显示。我会假设我在 Java 程序中收到的内容是：

欢迎来到我的节目！执行计算...然后五秒钟内什么都没有...然后将 5 添加到您的数字 6 7 8 9 10 完成！

但是直到 5 秒后才显示任何内容。所以我可以执行程序，等待 5 秒钟，然后出现大量文本。

或者对于使用 raw_input，同样的事情也会发生。所以换句话说，我不能用它来提示用户输入。

我希望我能在这个阻塞问题上得到一些帮助，这样我的文本就会逐渐显示，而不是不得不等待一切都通过计时器或输入来让路。

任何帮助或资源表示赞赏。我当前的操作系统是 Mac，但我希望任何解决方案也能在 Windows 上运行（如果可能的话）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:50:49.810

默认情况下，python 脚本以缓冲输出运行。这意味着在脚本退出并刷新之前，您可能看不到任何标准输出。您所要做的就是使用 -u 启动 python 来请求无缓冲的输出。然后你会看到你所期待的。

```
python -u someFileName.py 
```

# entity-framework - EF Code First 强制急切加载

> ID：12064905
> 
> 赞同：8
> 
> 时间：2012-08-22T00:32:34.473
> 
> 标签：entity-framework, ef-code-first, code-first

我将 EF 5 与 Code First 一起使用。我有一个类，我想总是渴望加载一些属性。我删除了**virtual**关键字，但它不是急切加载：

```
public class Person
{
   public ICollection<Email> Emails { get; set; } 
   public Profile Profile {get;set;}
} 
```

所以通过关闭延迟加载，它不会自动急切加载吗？如果是这样，我如何在不使用 Include() 的情况下将其存档？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-22T00:35:54.847

不，通过删除关键字关闭延迟加载`virtual`不会自动启用急切加载。您必须`Include`相关`Entity`或`Collection`类似：

```
var personWithProfile = ctx.People.Include(x => x.Profile).First();
var personWithProfileAndEmails = ctx.People.
                                           .Include(x => x.Profile)
                                           .Include(x => x.Emails)
                                           .First(); 
```

这是 ADO.NET 团队博客的精彩读物：http: [//blogs.msdn.com/b/adonet/archive/2011/01/31/using-dbcontext-in-ef-feature-ctp5-part-6 -loading-related-entities.aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/31/using-dbcontext-in-ef-feature-ctp5-part-6-loading-related-entities.aspx)

# django - 将 MongoDB runCommand 与 Django MongoDb-engine 一起使用

> ID：12064909
> 
> 赞同：3
> 
> 时间：2012-08-22T00:34:28.860
> 
> 标签：django, mongodb, geolocation, django-mongodb-engine

我正在使用[mongodb-engine](http://django-mongodb.org/)从 Django 项目访问 MongoDB。正常的获取、插入和更新工作得很好，但现在我想使用 geoNear 功能。我只是想不出一种从 Django 调用它的方法。

我也试过`MyModel.objects.raw(...)`了`MyModel.objects.raw_query(...)`，但结果并不像预期的那样。

查询将是这样的（它在 Mongo shell 中工作）

```
db.runCommand({ geoNear : "mymodel", near : [3, 0], spherical : true, maxDistance : 10 }) 
```

该模型使用 MongoDBManager

```
class MyModel(model.Model):
    objects = MongoDBManager()
    ... 
```

有人成功尝试过吗？

谢谢西蒙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T06:35:12.510

我猜想使用`db.runCommand()`geoNear 查询所需的 MongoDB 在当前版本的 mongodb-enginge 中是不可能的。我现在使用具有正常近语法的 raw_query 并将 2 lat/lon 点之间的距离转换为英里（反之亦然）。

```
lat_lon_dist = distance_to_lat_long(dist_in_miles)
l = Listing.objects.raw_query({
                       'geo_location' : {
                                     '$maxDistance': lat_lon_dist,
                                     '$near' : { 'latitude': lat, 'longitude': lon },
                                     }
                       })
...
EARTH_RADIUS = { 
                'km': 6371, 
                'mi': 3959 
                }

''' returns the distance between two lat/lon points in miles or kilometers '''
def lat_lon_to_distance(lat1, lon1, lat2, lon2, unit='mi'):
    lat1 = math.radians(lat1)
    lon1 = math.radians(lon1)
    lat2 = math.radians(lat2)
    lon2 = math.radians(lon2)
    return math.acos(math.sin(lat1)*math.sin(lat2) + 
                  math.cos(lat1)*math.cos(lat2) *
                  math.cos(lon2-lon1)) * EARTH_RADIUS[unit];

'''
converts a distance in miles or kilometer to a difference between two lat/lon points
the result is just approximately!
'''
def distance_to_lat_long(distance, unit='mi'):
    return distance / math.radians(EARTH_RADIUS[unit]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T06:48:19.080

您可以按此处所述获取 PyMongo 对象[http://django-mongodb.org/topics/lowerlevel.html#pymongo-level](http://django-mongodb.org/topics/lowerlevel.html#pymongo-level)

# c++ - 延迟加载DLL

> ID：12064910
> 
> 赞同：3
> 
> 时间：2012-08-22T00:34:37.547
> 
> 标签：c++, visual-studio-2010, templates, dll

为简单起见，我将 DLL_TUTORIAL.dll 和头文件 MathFuncsDll.h 都放在了根文件夹 C:\ 中。

然后，创建空项目，设置

> Configuration Properties->Linker->Input->Delay Loaded Dll's

至

> > C:\DLL_TUTORIAL.dll;%(DelayLoadDLLs)

和

> 配置属性->VC++ 目录->包含目录

至

> C:\;$(包含路径)

编译器命令：

> /Zi /nologo /W3 /WX- /O2 /Oi /Oy- /GL /D "_MBCS" /Gm- /EHsc /MT /GS /Gy /fp:precise /Zc:wchar_t /Zc:forScope /Fp"Release \clean_rough_draft.pch" /Fa"Release\" /Fo"Release\" /Fd"Release\vc100.pdb" /Gd /analyze- /errorReport:queue

该项目仅包含带有 main 的文件。

主文件

```
#include <Windows.h>
#include <iostream>
#include "MathFuncsDll.h"

using namespace MathFuncs;
using namespace std;

int main()
{
    std::cout<< MyMathFuncs<int>::Add(5,10)<<endl;

    system("Pause");
    return 0;
} 
```

DLL 已在不同的解决方案中成功编译。

MathFuncsDll.h

```
namespace MathFuncs
{
    template <typename Type>  
    class MyMathFuncs   
    {
    public:
        static __declspec(dllexport) Type Add(Type a, Type b);

        static __declspec(dllexport) Type Subtract(Type a, Type b);

        static __declspec(dllexport) Type Multiply(Type a, Type b);

        static __declspec(dllexport) Type Divide(Type a, Type b);

    };

} 
```

这些函数的定义：

```
#include "MathFuncsDll.h"

#include <stdexcept>

using namespace std;

namespace MathFuncs
{
    template <typename Type>
    Type MyMathFuncs<Type>::Add(Type a,Type b)
    { return a+b; }

    template <typename Type>
    Type MyMathFuncs<Type>::Subtract(Type a,Type b)
    { return a-b; }

    template <typename Type>
    Type MyMathFuncs<Type>::Multiply(Type a,Type b)
    { return a*b; }

    template <typename Type>
    Type MyMathFuncs<Type>::Divide(Type a,Type b)
    { 
        if(b == 0) throw new invalid_argument("Denominator cannot be zero!");
        return a/b; 
    }
} 
```

运行此程序失败：

> 1>main.obj : 错误 LNK2001: 无法解析的外部符号 "public: static int __cdecl MathFuncs::MyMathFuncs::Add(int,int)" (?Add@?$MyMathFuncs@H@MathFuncs@@SAHHH@Z) 1> C:\Users\Tomek\Documents\Visual Studio 2010\Projects\clean_rough_draft\Release\clean_rough_draft.exe : 致命错误 LNK1120: 1 unresolved externals

你能指出我的错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T05:54:43.553

该问题与是否延迟加载 DLL 无关。我可以在这里看到两个问题：

1.  您正在导出模板化函数。这不会那样工作，因为 Visual C++ 编译器不支持模板导出，但是已经从标准中删除了。为此，您有两种可能的解决方案：

    *   将方法的实现移到 .h 文件中，因此根本不再需要 DLL，因为所有代码都在头文件中；
    *   使用您将在客户端应用程序中使用的类型来实例化模板。这是通过将具有确切类型的实例化代码放入您的 cpp 文件中，`extern template`在标头中进行一些声明等来完成的。您可以在 Google 中查找更多信息，只需搜索“extern template DLL”或类似的东西。
2.  您只在创建 DLL 时导出方法，但从不导入它们（或者至少这是我从代码中看到的）。`__declspec(dllexport)`在每个方法前面使用，它告诉编译器将这些方法放入 DLL 中。当您想从客户端应用程序中使用这些方法时，您必须从 DLL 中导入它们。这是通过将`__declspec(dllimport)`每个方法放在前面来完成的。由于您不能将两个前缀都放在方法上，因此您要么必须创建两个几乎相同的头文件，只是在该方法前缀方面有所不同，要么根据这是 DLL 构建代码还是客户端应用程序使用一些宏替换。再一次，你可以在谷歌中查看它是如何完成的。

我希望这会有所帮助。

# javascript - 你能提交一个带有文本输入数组的表单吗？

> ID：12064920
> 
> 赞同：0
> 
> 时间：2012-08-22T00:36:11.150
> 
> 标签：javascript, jquery

我正在动态构建一个页面。此页面需要从输入标签中读取信息，但它是动态的。我应该将东西设置为数组，因为我正在查看

我想保留数据集。

```
<script>
   function adjustPilots(){
var pilots = $("#numPilots").val();
var info = '<td><table>'+
    '<tr><td>Minumum Collateral</td><td colspan="2"><input type = "text" size = "10" maxLength = "6" /> to <input type = "text" size = "10" maxLength = "6" /></td></tr>'+
    '<tr><td>Reward</td><td colspan="2"><input type = "text" size = "10" maxLength = "6" /> to <input type = "text" size = "10" maxLength = "6" /></td></tr>'+
    '<tr><td>Volume</td><td colspan="2"><input type = "text" size = "10" maxLength = "7" /> to <input type = "text" size = "10" maxLength = "7" /></td></tr>'+
    '<tr><td>Start: </td><td><input type = "text" name = "s" id = "s" class = "s" value autocomplete = "off"></td></tr>'+
    '<tr><td>End: </td><td><input type = "text" name = "e" id = "e" class = "e" value autocomplete = "off"></td></tr>'+
    '</table></td>';

for(var i = 0; i < Number(pilots); i++){
    $("#pilotrow").append(info);
}
}
</script>
<body>
<form>
<table>
<tr><td>Number of Pilots</td><td colspan="2"><input id = "numPilots" type = "text" size="3" maxLength="3" onchange = 'adjustPilots()' /></td></tr>
<tr id = "pilotrow"></tr>

<tr><td><input type = "submit" name = "submit"></td></tr>
</table>
</form>
</body> 
```

我正在考虑的一个选项是不使用表单，而是使用 javascript 构建它。然后制作一个 JSON 对象并使用 AJAX 将其发送到服务器。这是一种可靠的方法，还是有更好的主意？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:30:14.920

There are at least 2 way to do that.

Without javascript, you cate a form with array of element like this

```
<input type="text" name="input[]"/>
<input type="text" name="input[]"/>
<input type="text" name="input[]"/>
<input type="text" name="input[]"/> 
```

in php

```
$inputs = $_POST['input'];
for($inputs as $inp){

} 
```

With ajax and jquery, you can just simply serialize your form and post to backend

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T01:41:11.533

您可以通过使用`name`输入中的属性来实现。像这样：

```
<input type="text" name="pilots[]" /> 
```

然后，您可能希望跟踪您添加的飞行员数量，这样您就可以发送索引数组。像这样：

```
<input type="text" name="pilots[0][minumumCollatural]" />
<input type="text" name="pilots[0][reward]" />
<input type="text" name="pilots[0][volume]" /> 
```

这样，当您将表单提交到服务器时，您的飞行员数组将如下所示：

```
$pilots = $_POST['pilots'];

// Which looks like
array(
   [0] => array
          (
             [minumumCollatural] => // Some number
             [reward] => // Some number
          )
    [1] => array
          (
             [minumumCollatural] => // Some number
             [reward] => // Some number
          )
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:38:24.027

尝试利用隐藏的输入标签以您喜欢的任何方式发送数据。例如：

```
<input type="hidden" name="myinput" id="myinput" /> 
```

现在在 JS 中：

```
$("form").submit(function() {
    $("input").not("#myinput").each(function() {
        $("#myinput").val($("#myinput").val()+$(this).val());
        // you can format anyway you want this is just an example
    });
}); 
```

希望这可以帮助！

# ios5 - 使用 SHK 或 Twitter 框架使用自定义视图在 Twitter 上共享

> ID：12064921
> 
> 赞同：0
> 
> 时间：2012-08-22T00:36:11.870
> 
> 标签：ios5, twitter, sharekit

我正在尝试使用 ShareKit 或 iOS5 Twitter 框架进行分享。但是，我需要有一个自定义的 Twitter 视图。如果用户登录或提示授权，视图将接受用户输入 - 要共享的消息并直接发布。

我不确定如何自定义共享视图。任何人都可以帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T05:39:02.733

至于 shareKit：对于 iOS 4 设备，这很容易——您只需继承 SHKFormControllerLargeTextView 并使用您的图形。

如果您只想使用 twitter.framework，最好不要使用 ShareKit - 直接使用框架。重要信息在 WWDC 2011 视频和 Apple 的示例应用程序中。

# eclipse - Eclipse glassfish插件没有将maven依赖jar发布到ear lib文件夹

> ID：12064924
> 
> 赞同：0
> 
> 时间：2012-08-22T00:36:27.030
> 
> 标签：eclipse, maven, glassfish, m2eclipse, m2e

我正在使用带有 Eclipse Glassfish 插件 ( [http://download.java.net/glassfish/eclipse/juno](http://download.java.net/glassfish/eclipse/juno) ) 的 Eclipse“Internal Glassfish 3.1.2.2”服务器。我还将 Maven 与 m2e Eclipse 插件一起使用。Glassfish 插件正确地将我的 EAR 模块部署到内部 Glassfish，但它没有部署我的依赖 jar，我认为它应该最终位于一个名为“lib”的文件夹中。

[我在这里](https://stackoverflow.com/questions/12005101/missing-jars-when-publishing-a-web-app-to-glassfish-with-eclipse-juno-and-maven)找到了一个部分解决方案，就是将我的maven目标lib文件夹添加到EAR Deployment Assembly（在Deploy Path框中双击进行编辑）。这可行，但是当我执行 Maven > Update Project 时，m2e（或 m2e-wtp）会撤消配置更改。

应该有一个更清洁的解决方案。Eclipse Ear Module Assembly 对话框有一个字段来命名“EAR 库目录”，因此它知道 lib 文件夹。Eclipse EAR 程序集（没有 Maven）在哪里寻找要放入 lib 文件夹的 jar？我假设 Glassfish 插件在同一个地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:52:08.443

您可以使用以下步骤来查找问题的根源：

1.  将 Eclipse 排除在外，并使用 Maven 在命令行上构建 EAR，结果可以吗？如果没有，请在 pom.xml 中寻找解决方案。

2.  如果到目前为止一切正常，请打开 Eclipse 并执行 Maven -> Update Project。然后使用 Eclipse 导出 EAR（在 File -> Export 下查找 EAR 导出向导）。导出的 EAR 是否正常？如果没有，请提交 m2e-wtp 插件的错误报告。它仍然很原始，所以如果它在某些情况下没有正确设置 Eclipse 元数据也就不足为奇了。

3.  如果到目前为止一切正常，那么是时候在 Glassfish 插件中查找问题了。我怀疑你能做到这一点，但如果你做到了，我会帮助你跟进。

# dynamics-crm-2011 - Dynamics 2011 CRM - Visual Studio 开发人员工具/组织不匹配

> ID：12064928
> 
> 赞同：2
> 
> 时间：2012-08-22T00:36:45.903
> 
> 标签：dynamics-crm-2011

我正在创建一个 CRM 2011 插件。我使用适用于 Dynamics 2011 的 Visual Studio 解决方案模板创建它，并将其创作为 CRM 2011 插件库。在 CRM 中完成初始实现和测试后，我现在需要将插件与不同的实体/属性/SDK 消息相关联。所以...我重新打开 VS 以尝试创建另一个插件或以其他方式对其进行编辑。

奇怪的是，当我重新启动一个*以前可以工作*的现有 SLN 时，我从 Visual Studio 的 IDE 中得到一个 WCF 错误。具体来说，当我在 VS 中启动 CRM Explorer 时出现错误。错误很笼统-

> 由于内部错误，服务器无法处理请求。等等等等

CRM Explorer 树在错误后显示 0 个实体和 0 个选项集，但其他树节点似乎具有正确的内容。我觉得我的 Org 或 CRM 服务器中的某些东西破坏了 VS 集成，但不知道那可能是什么。我的意思是我在一周左右的时间里根本没有对 Org 进行任何更改（尽管我确实应用了 8 月的 Windows 更新！）。我现在在 Cum Update 8 上。

当我删除隐藏的 blah.SUO 和 blah.docstates.suo 文件并重新启动 VS 时……CRM Explorer 按预期提示输入我的服务器/凭据/组织以进行初始启动。但是，我再次收到上述 WCF 错误，并且 CRM Explorer 在此“重置”之后没有正确填充。我也尝试过卸载 CRM Developer Toolkit，但运气不佳。

有人以前见过这种行为，或者有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T10:06:31.653

我有一个类似的问题：尝试通过 VS 的开发工具包插件连接到 CRM 服务器。

**解决方案**：将用户添加到 CRM 组织并分配角色“系统管理员”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:11:17.623

当重新配置 WCF 端点（CRM 部署管理器）时，我已经看到类似的情况发生。您可以在设置 - 自定义 - 开发人员资源中查看端点是什么

# django - Django，为模型的每个实例执行操作的最佳实践

> ID：12064929
> 
> 赞同：0
> 
> 时间：2012-08-22T00:36:54.057
> 
> 标签：django, performance, models

这是我的问题。

我有一个这样的模型

```
class ActionQueue(models.Model):
    action_type = models.CharField(max_length=30, choices=ACTION_QUEQUE_TYPE)

    def execute(self):
        if self.action_type == 'exam':
                ... do something ... 
```

为每个 ActionQueue 实例执行“执行”函数的最佳方法是什么？目前我正在使用 for..in：

```
 for action in ActionQueue.objects.all():
     action.execute() 
```

也许有更好的方法（在性能方面）来达到相同的结果..

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:45:43.890

我想你想要的是

```
actions = ActionQueue.objects.filter(action_type='exam') 
```

然后

```
actions.update(...) 
```

或者

```
action_list = list(actions)
# do something with action_list
[do_something(action) for action in action_list] 
```

# asp.net-mvc-3 - 如何调试 jqGrid 不加载 IE9？

> ID：12064932
> 
> 赞同：1
> 
> 时间：2012-08-22T00:37:03.357
> 
> 标签：asp.net-mvc-3, jqgrid

我已经构建了一个 asp.net mvc 3 应用程序/iis6/WCF。当我有时（每天一次）使用带有 IE9 的 jqGrid 访问页面时，它会挂起并说：“正在加载……”。但是，当我执行 CTRL + F5 时，它可以工作吗？

使用 Chrome 和 Firefox 时没有问题。

我的问题是如何调试这个问题，或者在使用 jqGrid 之前有人见过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:57:38.563

很可能是浏览器缓存问题。您需要检查 HTTP 响应标头并确保有`Cache-Control: no-cache`.

# php - 对数据进行排名，然后对所有排名进行平均，然后对这些排名进行排名

> ID：12064937
> 
> 赞同：1
> 
> 时间：2012-08-22T00:37:29.033
> 
> 标签：php, mysql, ranking

这基本上就是我想要做的。假设您正在建立一个网站，对在视频游戏中获得高分的人进行排名。您有一个用户，他在级别 1、2 和 3 上分别获得 100、150 和 200 分。然后，您有另一个用户获得了 200、100 和 100 的分数。如果您正在查看用户 1，您将获得如下表格：

```
         | 分数 | 排名 |
1级：| 100 | 2 |
2级：| 150 | 1 |
3级：| 200 | 1 |

```

我已经知道如何将分数存储在 MySQL 表中，然后对数据进行排名。这是它变得有点棘手的地方。假设您想平均用户的所有排名。对于用户 1，您将获得 1.333。对于用户 2，您将获得 1.666。所以如果你对这些数据进行排名，你会得到一个像这样的表格：

```
        | 平均排名 | 排名 |
用户 1：| 1.333 | 1 |
用户 2：| 1.666 | 2 |

```

基本上，最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:51:42.067

好吧，假设您的表类似于

```
LevelID (int)
UserID (int)
Score (int) 
```

你可能会做类似的事情

```
SET @rank = 0;
SELECT *, AVG(Score) as AverageScore, @row_num := @row_num + 1 as Rank FROM scores
GROUP BY UserID
ORDER BY `AverageScore` DESC 
```

我使用平均分数和排名而不是平均排名的原因是，谁使用平均排名？这很奇怪，也更难计算。如果你显示你的 SQL 来获取排名，那么它会更容易。如果您实际上将排名存储在表中（这不是好的做法），那么您可以按 UserID 和 AVG(Rank) 排序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:47:52.740

```
 "SELECT level, AVG(Rank) FROM (YOUR TABLE NAME HERE) GROUP BY level" 
```

将为您提供一张表的排名列的平均值。我假设每张桌子代表一个玩家。如果是这种情况，您必须在每个用户表上运行此查询。另请注意，我假设 1 级 - 3 级是您的唯一 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T00:42:57.483

最有效的方法可能是在提取数据时在 MySQL 查询中使用聚合函数。

[http://www.mysqltutorial.org/mysql-aggregate-functions.aspx](http://www.mysqltutorial.org/mysql-aggregate-functions.aspx)

# c# - 如何使用 IList 上的 LINQ 扩展来查询嵌套对象中的值？

> ID：12064939
> 
> 赞同：1
> 
> 时间：2012-08-22T00:38:01.763
> 
> 标签：c#, .net

是的，我在询问之前浏览了提供的链接:-)

我有一个 List<foo> ，其中 foo 是一个带有嵌套对象栏的对象，它有一个名为 Data 的字段。

我无法弄清楚使用 IList LINQ 扩展包含<> 来查询 foo1.bar.Data 中的值的正确语法。

Intellisense 没有帮助，MSDN 无法理解我的要求。

我在这里想念什么？我希望包含基本上说，“在这个 foo 列表中，告诉我一个或多个 foo 是否包含一个嵌套对象栏，其数据字段中带有字符串“hello”。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T00:41:17.123

您可以使用`Any`：

```
List<Foo> foos = ...
if (foos.Any(f => f.Bar.data == "hello"))
{
    ...
} 
```

# bash - Bash Shell 参数扩展 ${ }

> ID：12064944
> 
> 赞同：2
> 
> 时间：2012-08-22T00:38:39.993
> 
> 标签：bash, shell, scripting

我不太清楚如何理解这一点-

```
$ var='  '
$ echo "|${var}|"
|  |
$ echo "|${var// /}|"
|| 
```

比。

```
$ set -- '' '' ''
$ echo "|${*}|"
|  |
$ echo "|${*// /}|"
|  | 
```

但是，当我在上面添加这个时

```
$ IFS=
$echo "|${*// /}|"
|| 
```

第二组命令出了什么问题？这是预期的结果吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:55:31.797

# 示例 1

```
$ var='  '
$ echo "|${var}|"
|  |
$ echo "|${var// /}|"
|| 
```

这里有一个由两个空格组成的简单字符串。当您在两个竖线字符之间展开它时，您会看到竖线之间有两个空格。当您使用模式替换从变量的扩展中删除所有空格时，您会看到两个管道之间的空字符串。

# 示例 2

```
$ set -- '' '' '' 
```

首先，您已将前三个位置参数中的每一个都设置为空字符串。您可以通过比较`${1-foo}`with的结果来观察这一点`{$4-foo}`（如果设置了参数，则显示参数，如果未设置，则显示 'foo'）。

```
$ echo ${1-foo}

$ echo ${4-foo}
foo 
```

所以我们可以看到它`$1`是设置的，但为空，而`$4`它是未设置的。

```
$ echo "|${*}|"
|  | 
```

接下来，我们看到扩展`$*`引号内的特殊参数的结果，这是一个由设置的位置参数组成的单个字符串，由参数的第一个字符分隔`IFS`。`IFS`默认情况下，它的第一个参数是空格，所以我们看到的是一个由 3 个空字符串组成的字符串，每个空字符串用空格分隔，这只是一个由 2 个空格组成的字符串。

```
$ echo "|${*// /}|"
|  | 
```

当您将模式替换应用于 时`$*`，替换将分别应用于每个位置参数，然后使用 连接结果参数`IFS`。由于位置参数已经为空，因此从它们中删除空格会使它们保持不变。所以你得到的结果与你自己扩展时的结果相同`$*`。

# 示例 3

```
$ IFS=
$ echo "|${*// /}|"
|| 
```

此处的过程与示例 2 中的过程相同，但重要的区别是现在`IFS`是空字符串，而不是其默认值 ''。再一次，模式替换并没有真正做任何事情，因为没有空格可以从任何位置参数中删除。但是现在，扩展`$*`会产生一个由位置参数组成的字符串，没有中间字符。而不是`$1 $2 $3`，你得到`$1$2$3`。由于这三个本身都是空字符串，因此结果是空字符串。

# objective-c - 如何在同一类中的另一个方法中使用 CGPoint 值

> ID：12064948
> 
> 赞同：0
> 
> 时间：2012-08-22T00:39:07.393
> 
> 标签：objective-c, ios, cocos2d-iphone

对不起，如果这听起来很简单。我是 Cocos2d 和 Obj-C 的新手。我想将一种方法中精灵的 CGPoint 值与另一种方法中计算的值进行比较。如何在同一类中从一种方法访问此值到另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:48:28.693

将其传递给方法或声明一个私有属性来保存该值：

```
@property (nonatomic, assign) CGPoint myCGPoint; 
```

然后在实现文件中合成：

```
@synthesize myCGPoint; 
```

# css - CSS3 覆盖属性——它是否保持纵横比？

> ID：12064949
> 
> 赞同：0
> 
> 时间：2012-08-22T00:39:10.970
> 
> 标签：css

我正在创建一个使用 CSS3 全屏画廊的网站。这是我第一次将 CSS3 用于全屏图像，而不是 JS。

问题是我正在使用的 background-size:cover 属性没有做我认为应该做的事情。我认为通过使用封面，图像由浏览器调整大小，但它保持原始纵横比，因此没有任何内容被剪裁，但这没有发生。

例如，如果我在 1366x768 分辨率上使用 1500x900 图像，则图像未正确缩放，它覆盖了所有内容，但它会切断其中的一部分，因为提供的图像大于分辨率。

这是我用于 bg 图像的代码：

```
 .image{
background-repeat:no-repeat;
background-position:center center;
background-attachment:fixed;
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover; 
 } 
```

此外，这里是网站测试页面： http: [//www.madebym.net/test/index.html](http://www.madebym.net/test/index.html) 只需比较缩略图和更大的图像。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:49:26.993

你可能想要**包含**

> 包含，它指定背景图像应该被缩放到尽可能大，同时确保它的两个尺寸都小于或等于背景定位区域的相应尺寸。
> 
> cover，它指定背景图像在保证两个尺寸都大于或等于背景定位区域对应尺寸的情况下，应尽可能缩小。

来自[MDN](https://developer.mozilla.org/en-US/docs/CSS/background-size)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T11:53:49.617

**contains**和**cover**保持图像的纵横比正确，这意味着它的一部分可能会丢失或部分区域将未被覆盖（如果块的纵横比恰好与图像的纵横比不匹配）。如果您希望图像完全填充块而不考虑纵横比，您想要的只是：

```
image-size: 100% 100% 
```

# java - 我可以将 WindowListener 添加到 MenuItem 吗？

> ID：12064950
> 
> 赞同：0
> 
> 时间：2012-08-22T00:39:13.450
> 
> 标签：java, awt, frame, menuitem, windowlistener

我有一个用 AWT 编写的程序，所以我使用的是 Frame（不是 JFrame/Swing）。我正在使用 MenuItem 对象通过 ActionListeners 进行一些操作。

但是，在我的最后一个 MenuItem 上，我想使用 WindowListener 来关闭框架（打算在不完全终止程序的情况下关闭框架）。

我知道 MenuItem 文档没有 addWindowListener() 方法。但是有没有办法解决这个问题？

```
f.addWindowListener(new WindowAdapter() {
public void windowClosing(WindowEvent e) {
    f.dispose();
}}); 
```

这几乎是我想要做的，但来自一个 MenuItem。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:42:59.507

窗口侦听器不是要*关闭*窗口——它是一组在窗口执行特定操作时发生的回调。从[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/awt/event/WindowListener.html)：

> 当窗口的状态因打开、关闭、激活或停用、图标化或去图标化而发生变化时，将调用侦听器对象中的相关方法，并将 WindowEvent 传递给它。

`windowClosing`具有以下 Javadoc：

> **`void windowClosing(WindowEvent e)`**
> 当用户尝试从窗口的系统菜单关闭窗口时调用。

如果您想在有人单击菜单项时以编程方式关闭窗口，则只需添加一个带有以下内容的操作侦听器：

```
f.setVisible(false);
f.dispose(); 
```

# svn - 大型变更集对 Subversion 有什么影响？

> ID：12064954
> 
> 赞同：8
> 
> 时间：2012-08-22T00:39:49.603
> 
> 标签：svn, fsfs

我最近向我的 svn 存储库提交了一个大型变更集（约 7,000 个文件）。这 7,000 个文件仅占使用 FSFS 后端并使用 svnserve 1.7 提供服务的存储库总大小的 5%。从那时起，在这个大型提交之后检查修订需要 20 倍的时间。

Subversion 在内部做了什么导致速度变慢，有没有办法解决这个问题？

## 更新

1.  在手动检查错误修订时，我可以*看到*结帐开始变慢的点。结帐开始非常快速地将文件添加到工作副本（您无法足够快地读取 tty 输出）。一旦结帐到达某个目录（错误的修订版本将 2,000 个文件添加到该目录（其中已经包含 17,000 个文件）），文件被添加到工作副本的速度明显变慢（例如每秒 5 个文件），以便结帐的其余部分。坏版本之前的修订版在整个过程中非常快速地将文件添加到工作副本中。此目录中的文件每个大约 1KB。

2.  我为版本 1.6 和 1.7 --with-debuging 和 --with-gprof 编译了我自己的版本，`svnserve`以便我们可以深入了解正在发生的事情。一些进一步的研究表明，在 svnadmin 1.7 中与内存缓存相关的一些增强实际上在这个版本中扼杀了它。**即，使用 svnserve 1.6 为存储库提供服务可以解决这个问题**。我猜这是在[http://subversion.apache.org/docs/release-notes/1.7.html#server-performance-tuning](http://subversion.apache.org/docs/release-notes/1.7.html#server-performance-tuning)讨论的内存缓存，基于 gprof 配置文件在错误修订时的结帐时间（以及它之前的那个）。在 rBAD 中，某些 svn fsfs 到内存缓存函数的调用次数大约是 rGOOD 中的 2,000,000,000 倍。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-23T06:54:00.770

是的，SVN v1.7 版本推出了许多性能增强功能。但是有一些一般性的假设。对于极端情况，例如单个提交中的大量文件或具有巨大大小的文件，需要按照版本说明中指定的方式调整预设参数。

# objective-c - XCode 4 Connection Inspector 在源代码中的新 IBOutlet 后未刷新

> ID：12064955
> 
> 赞同：2
> 
> 时间：2012-08-22T00:39:59.253
> 
> 标签：objective-c, xcode, cocoa, iboutlet

每当我`IBOulet`在源代码中添加新的/重命名现有的时，文件中关联的文件所有者连接检查器`.xib`不再刷新。

如果我关闭并重新打开项目，就会出现新的网点，但只要我保持打开状态，就无法访​​问它们。它发生在每个`.xib`文件中，这与正确的自定义类名无关 - 它始终是关联`ViewController`的。

**自Xcode 4.4.1**更新以来，此问题开始发生- 有人遇到相同的行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T03:56:18.857

尝试将您的网点定义为属性，而不是在实例变量中使用“IBOutlet”。我遇到了一个更糟糕的问题，Xcode 从未显示我添加为 ivars 的网点。我正在更新使用 ivar 方法的 xib。它从未说过我的出口存在，甚至重新启动 Xcode，并声称标题中缺少所有现有的出口（“你的班级”没有出口“foo”）。

这是属性样式的插座（在 OS X 项目中）：

```
@property (nonatomic, weak) IBOutlet NSButton *okButton; 
```

编辑添加：问题出在一个框架项目中，作为一个应用程序项目的依赖项包含在工作区中，我仍然遇到与基于@property 的插座不一致的问题。当我关闭工作区并单独打开框架项目时，问题就消失了。在工作区的上下文中，它仍然更喜欢@property 插座。

# scala - Scala：访问 Either 的公共子类型

> ID：12064956
> 
> 赞同：3
> 
> 时间：2012-08-22T00:40:28.250
> 
> 标签：scala

CSplit 和 MapCanvT 都是 Scala Swing 组件的子类型。所以 CanvNode 类型始终是 Component 的子类型。我还没有掌握 Scala 集合的功能性东西，比如折叠。有没有办法减少这段代码（除了把匹配放在一个函数中）并摆脱那些匹配？

```
type CanvNode = Either[CSplit, MapCanvT]   

class CSplit(var s1: CanvNode, var s2: CanvNode) extends SplitPane
{         
  topComponent =  s1 match { case Left (s) => s; case Right (s) => s} 
  bottomComponent = s2 match { case Left (s) => s; case Right (s) => s} 
```

以上编译。理想情况下，我会写：

```
type CanvNode = Either[CSplit, MapCanvT]   

class CSplit(var s1: CanvNode, var s2: CanvNode) extends SplitPane
{         
  topComponent =  s1
  bottomComponent = s2 
```

但这不会编译。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T01:04:43.910

`fold`实际上会在这里做你想做的事。你可以重写这个：

```
topComponent = s1 match { case Left (s) => s; case Right (s) => s} 
```

像这样：

```
topComponent = s1.fold(identity, identity) 
```

`CSplit`并且推断的类型将是和的最小上限`MapCanvT`。

`Either`还提供了一种更紧凑的编写方式：

```
topComponent = s1.merge 
```

通过隐式转换为[`MergeableEither`](http://www.scala-lang.org/api/current/scala/Either$$MergeableEither.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T10:44:58.517

为什么不以不同的方式将其建模为特征呢？

```
sealed trait CanvNode
class MapCanvT extends Component with CanvNode
class CSplit extends SplitPane with CanvNode(var s1: CanvNode,
                                             var s2: CanvNode) {
    topComponent = s1
    bottomCompoenent = s2
} 
```

# ruby-on-rails - 引擎的 CanCan 能力和附加规则

> ID：12064958
> 
> 赞同：0
> 
> 时间：2012-08-22T00:41:05.827
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

我有应用程序和引擎（宝石，Rails::Engine）。CanCan 用于授权，我想在引擎上使用它。使用命名空间隔离的引擎，例如：

```
module MyEngine
  class ApplicationController < ::ApplicationController
  end
end 
```

所以，我可以在控制器上使用 load_and_authorize_resource（必须指定模型类名）和“can”助手。我必须在主应用程序中写入能力的所有能力（来自引擎的模型必须命名空间）。这不是很好的方式。我想在这个引擎上指定引擎的能力，但不创建新的能力对象。我怎样才能做到这一点？任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:56:01.270

它不是超级漂亮，但我对我目前正在编写的 Rails 应用程序做了类似的事情。我在这个名为 FormX 的应用程序中编写了自己的引擎，它是一种表单 CMS 引擎。我希望用户能够仅编辑对表单的某些响应，并且只有某些用户能够创建表单。

鉴于我`Form`在命名空间中有一个模型，我可以通过使用语法`Formx`在我的 MainApp 文件中定义能力。`ability.rb``Formx::Form`

前任。

```
can :manage, Formx::Form 
```

然后在我的控制器中，我不得不手动将`authorize!`调用放入每个操作中，因为我无法`load_and_authorize_resource`在引擎的命名空间中工作。

# c# - LINQ 关联 - 实体框架

> ID：12064959
> 
> 赞同：1
> 
> 时间：2012-08-22T00:41:09.687
> 
> 标签：c#, linq, entity-framework

我有三个表，我使用 edmx 设计器在它们之间添加关联。以下是它们的链接方式。

（表1）贷款-（表2）投资者：多对一关系（表2）投资者-（表3）InvestorInfo：一对多关系

我想获得 [1] 向一位投资者出售的总贷款数量，[2] 投资者姓名和 [3] 投资者服务费，存储在表 3 中，每个投资者的 idx = 2005（“投资者 id 和 idx”是表 3 - InvestorInfo 表）。

我该如何在下面的查询中做到这一点？我被迫选择“FirstOrDefault()”来访问 Table3 中的任何列（参见注释行）。如果我使用 FirstOrDefualt，我会得到一个 idx = 1 而不是 2005 的记录。

```
 var loanPurchaseData = (from cd in entity.Table1
                        //where cd.Table2.Table3.Select(x => x.IDX == 2005)
                        //where cd.ULDD_SET_POOLS.ULDD_SET_POOLDT.FirstOrDefault().SORT_ID == 2005
                        group cd by new { cd.Table4.PurchaseDate, cd.Number } into grp
                        select new
                        {
                            investor = grp.FirstOrDefault().Investor,
                            no_of_loans = grp.Count(),                                               
                            sort_id = grp.FirstOrDefault().Table2.Table3.FirstOrDefault().SORT_ID,
                            service_fee_rate = grp.FirstOrDefault().Table2.Table3.FirstOrDefault().DT_REAL_PERC_VALUE
                        }).ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T04:08:40.953

你的问题不是很清楚 - 我不明白 idx 是在 Table3 还是 Table1 中，以及你想选择什么，但我会假设你有一个多对多模式，其中 an`Investor`有零或更多`Loans`& 零或更多`InvestorInfos`。例如，您想获得与投资者信息相关的所有贷款`idx = 2005`。如果我错了，请纠正我，如果我是对的，请纠正你的问题！

从您的`InvestorInfo`对象开始，您知道只有一个`Investor`，但会有零个或多个`Loans`。

```
// only one InvestorInfo for idx, but this isn't clear in your question
var investorInfo = context.InvestorInfos.SingleOrDefault(i => i.idx == 2005);

var loans = investorInfo.Investor.Loans; 
```

您的问题的症结在于您无法获得投资者信息的“贷款服务费”。为什么不？因为那个投资者有5笔贷款。你想要哪一个？

```
-- we can get the maximum, minimum, sum, etc...
var max = loans.Max(l => l.DT_REAL_PERC_VALUE);
var min = loans.Min(l => l.DT_REAL_PERC_VALUE);
var min = loans.Sum(l => l.DT_REAL_PERC_VALUE); 
```

同样，不清楚您要做什么，也不清楚您的数据实际上是什么样子，但是在一对多的关系中，对于“一”方的每一方，您必然有多个“多”方。

* * *

要获得最大值，请使用`Max`运算符。

```
service_fee = grp.Max(l => l.Table2.Table3.Max(t => t.DT_REAL_PERC_VALUE)) 
```

# asp.net-mvc - 将自定义 ViewModel 对象传递给 ActionMethod 与作为 FormCollection 传递

> ID：12064966
> 
> 赞同：0
> 
> 时间：2012-08-22T00:41:47.840
> 
> 标签：asp.net-mvc, model-view-controller, formcollection

显然，现实生活中的应用程序要复杂得多，但对于这个例子，假设我有以下简单视图，我需要保存用户：

```
@model UserViewModel

@Html.TextBoxFor(model=>model.FirstName)
</br>
@Html.TextBoxFor(model=>model.MiddleName)
</br>
@Html.TextBoxFor(model=>model.LastName) 
```

提交后，我可以通过两种方式在控制器级别接收它：

```
1)

public ActionResult(UserViewModel user)
{
 var myUser = new User();
 myUser = user.FirstName;
 myUser = user.MiddleName;
 myUser = user.LastName;
} 
```

和

```
2)

public ActionResult(FormCollection collection)
{
 var myUser = new User();
 myUser = collection.Get("FirstName");
 myUser = collection.Get("MiddleName");
 myUser = collection.Get("LastName");
} 
```

问题：有理由使用一种方法而不是另一种方法吗？还有一些开发人员告诉我，首选第二种方法。像第一个示例中显示的那样传递整个对象并不是一个好主意。为什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:47:23.820

简短的回答：两者都在工作并且都是有效的。

固执己见的回答：我确实更喜欢第一个，

1.  它比第二个*更面向对象。*
2.  您在第二种方法中隐含了魔术字符串。当然，您可以将它们外部化等，但同样，强类型总是比逐个字符串好。
3.  您在选项 1 中定义了一次验证，您必须在选项 2 中一遍又一遍地进行。
4.  你*可以使用 AutoMapper*。它将为您映射具有相似名称的大部分字段，并要求您定义其余字段。在这里，您根本不必逐个字段移动（见下文）。但是，您必须在第二种方法中一一进行。当您完成映射时，它看起来像这样（这也很简单）：

    ```
    public ActionResult(UserViewModel user)
    {
       var myUser = Mapper.Map<User, UserViewModel>(user);
    } 
    ```

不是美女吗？

我真的不明白为什么选项 2 比 1 更受欢迎……我想他们有他们的理由。它就像 COBOL 与 C++。:))

但这确实是*个人决定和风格*。*没有正确的答案*。

希望这是有帮助的。

# jquery - getJSON 在 IE 上不起作用

> ID：12064969
> 
> 赞同：1
> 
> 时间：2012-08-22T00:42:17.413
> 
> 标签：jquery, json

```
$(document).ready(function(){
  var timezone = "GMT";
  var num1 = Math.random();
  $.getJSON("http://178.79.191.15/json.php?num="+num1,
    function(data){
        console.log(data.hour);
      if (data.hour == 0 || data.hour == 1 || data.hour == 2 || data.hour == 3) {
        $('#pokerform').show();     
      } else {
        $('#wrongtime').show(); 
      }
    })
}); 
```

以上是我的功能，它适用于 Chrome/FF 但不适用于 IE。

`header('Access-Control-Allow-Origin: *');`我已经设置`http://178.79.191.15/json.php`

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:27:06.683

你有几个问题：

对于 JavaScript，您应该使用`===`而不是`==`，尤其是在检查 0 的值时。您还缺少一个分号来结束您的`$.getJSON();`.

这是修改后的代码：

```
$(document).ready(function() {
    var timezone = "GMT",
        num1 = Math.random()
    ;
    $.getJSON("http://178.79.191.15/json.php?num=" + num1, function(data) {
        console.log(data.hour);
        if (data.hour === 0 || data.hour === 1 || data.hour === 2 || data.hour === 3) {
            $('#pokerform').show();
        } else {
            $('#wrongtime').show();
        }
    });
});​ 
```

# google-apps-script - 我可以使用 Google Apps 脚本为 Google 文档中的某些单词着色吗？

> ID：12064972
> 
> 赞同：19
> 
> 时间：2012-08-22T00:42:47.623
> 
> 标签：google-apps-script, google-docs

我正在尝试突出显示我的 Google 文档中的某些字词。我知道我可以使用 document.replace 替换文本，但它只替换字符串本身，而不是格式。有没有办法使用 Google Apps 脚本用彩色字符串替换字符串？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-04T17:59:26.113

随着文档绑定脚本的引入，现在可以制作从自定义菜单调用的文本突出显示功能。

***这***肯定是现在最好的答案！8^)

此脚本是根据[此答案](https://stackoverflow.com/questions/15581090/how-to-find-a-word-in-a-document-and-insert-a-url/16922406#16922406)中的脚本修改的，可以从 UI（不带参数）或脚本调用。

```
/**
 * Find all matches of target text in current document, and highlight them.
 *
 * @param {String} target     (Optional) The text or regex to search for. 
 *                            See Body.findText() for details.
 * @param {String} background (Optional) The desired highlight color.
 *                            A default orange is provided.
 */
function highlightText(target,background) {
  // If no search parameter was provided, ask for one
  if (arguments.length == 0) {
    var ui = DocumentApp.getUi();
    var result = ui.prompt('Text Highlighter',
      'Enter text to highlight:', ui.ButtonSet.OK_CANCEL);
    // Exit if user hit Cancel.
    if (result.getSelectedButton() !== ui.Button.OK) return;
    // else
    target = result.getResponseText();
  }
  var background = background || '#F3E2A9';  // default color is light orangish.
  var doc = DocumentApp.getActiveDocument();
  var bodyElement = DocumentApp.getActiveDocument().getBody();
  var searchResult = bodyElement.findText(target);

  while (searchResult !== null) {
    var thisElement = searchResult.getElement();
    var thisElementText = thisElement.asText();

    //Logger.log(url);
    thisElementText.setBackgroundColor(searchResult.getStartOffset(), searchResult.getEndOffsetInclusive(),background);

    // search for next match
    searchResult = bodyElement.findText(target, searchResult);
  }
}

/**
 * Create custom menu when document is opened.
 */
function onOpen() {
  DocumentApp.getUi().createMenu('Custom')
      .addItem('Text Highlighter', 'highlightText')

      .addToUi();
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-22T11:33:42.203

这是一个更好的解决方案：

```
function highlightTextTwo() {
  var doc  = DocumentApp.openById('<your document id');
  var textToHighlight = 'dusty death';
  var highlightStyle = {};
  highlightStyle[DocumentApp.Attribute.FOREGROUND_COLOR] = '#FF0000';
  var paras = doc.getParagraphs();
  var textLocation = {};
  var i;

  for (i=0; i<paras.length; ++i) {
    textLocation = paras[i].findText(textToHighlight);
    if (textLocation != null && textLocation.getStartOffset() != -1) {
      textLocation.getElement().setAttributes(textLocation.getStartOffset(),textLocation.getEndOffsetInclusive(), highlightStyle);
    }
  }
} 
```

**上一个答案：**

关键是能够仅引用您想要着色的单词。

我的解决方案是：

获取包含您要着色的单词的段落文本，删除原始段落，然后将文本的每个部分添加回来。当您添加每个部分时，appendText 返回一个对添加文本的引用，然后您可以使用 setForegroundColor() 指定其颜色：

```
function highlightText() {
  var doc = DocumentApp.openById('<your document id>');
  var textToHighlight = 'dusty death';
  var textLength = textToHighlight.length;
  var paras = doc.getParagraphs();
  var paraText = '';
  var start;
  for (var i=0; i<paras.length; ++i) {
    paraText = paras[i].getText();
    start = paraText.indexOf(textToHighlight);
    if (start >= 0) {
      var preText = paraText.substr(0, start);
      var text = paraText.substr(start, textLength);
      var postText = paraText.substr(start + textLength, paraText.length);
      doc.removeChild(paras[i]);
      var newPara = doc.insertParagraph(i, preText);
      newPara.appendText(text).setForegroundColor('#FF0000');
      newPara.appendText(postText).setForegroundColor('#000000');
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T07:58:26.363

我认为可以使用 DocumentApp 中类 Text 的 setBackgroundColor 方法：[https ://developers.google.com/apps-script/class_text#setBackgroundColor](https://developers.google.com/apps-script/class_text#setBackgroundColor)

您必须将您的单词检索为 Text 元素。为此，您可以使用对象 Document 的 find 方法，然后遍历搜索结果并使用[getElement](https://developers.google.com/apps-script/class_searchresult#getElement)。最后，要将 Element 对象转换为 Text 对象，您可以使用`asText()`.

希望它会工作！;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-05T19:12:37.093

这可作为名为 Multi-instance Text Highlighting 的 Google 文档插件提供。提示：起初它似乎不起作用，但我关闭了我的文档并重新打开它，然后它就起作用了。然后它似乎有时不起作用，但我发现你的文本字符串中的特殊字符会破坏它；我想我的字符串中有一个 + ，但它什么也没做。但是没有特殊字符，它的效果很好。真的帮了我大忙。

# c++ - OpenGL/GLSL/GLM - Skybox 像第三人称一样旋转

> ID：12064978
> 
> 赞同：4
> 
> 时间：2012-08-22T00:44:09.730
> 
> 标签：c++, opengl, glsl, glm-math

我刚刚开始实现天空盒，并且正在使用 OpenGL/GLSL 和 GLM 作为我的数学库。我认为问题与矩阵有关，并且我无法找到利用 GLM 库的实现：

天空盒的模型加载得很好，但是相机会绕着它旋转，就好像它在 3d 第三人称相机中围绕它旋转一样。

对于我的天空盒矩阵，每次我的相机更新时我都会更新它。因为我使用 glm::lookAt，所以它的创建方式基本上与我的视图矩阵相同，只是我使用 0、0、0 作为方向。

这是我的视图矩阵创建。它在渲染对象和几何图形时效果很好：

```
direction = glm::vec3(cos(anglePitch) * sin(angleYaw), sin(anglePitch), cos(anglePitch) * cos(angleYaw));
right = glm::vec3(sin(angleYaw - 3.14f/2.0f), 0, cos(angleYaw - 3.14f/2.0f));
up = glm::cross(right, direction);
glm::mat4 viewMatrix = glm::lookAt(position, position+direction, up); 
```

同样，我的天空矩阵也是以同样的方式创建的，只有一个变化：

```
glm::vec3 position = glm::vec3(0.0f, 0.0f, 0.0f);
glm::mat4 skyView = glm::lookAt(position, position + direction, up); 
```

我知道天空盒不应用平移，只考虑旋转，所以我不确定问题是什么。有没有更简单的方法来做到这一点？

视觉辅助：

还没有任何动静直接上路 ![当我第一次启动程序时直接](../Images/174c06baf06b39c8a392720a14cf9b21.png)

当我旋转相机时： ![在此处输入图像描述](../Images/2722daa6a587984cdfc01806a5908acf.png)

**我的问题是：如何设置正确的矩阵来使用 glm:lookAt 渲染天空盒？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-05T15:09:50.277

Esthete 是对的 skybox/skydome 是唯一的对象，这意味着您不会更改投影矩阵！

你的渲染应该是这样的：

1.  清除屏幕/缓冲区
2.  设置相机
3.  将模型视图设置为标识，然后将其转换为相机的位置，您可以直接从投影矩阵获取位置（如果我的内存服务于数组位置 12、13、14）以获取矩阵，请参阅此[https://stackoverflow.com/a /18039707/2521214](https://stackoverflow.com/a/18039707/2521214)
4.  绘制天空盒/天空穹顶（不要越过你的 z_far 平面，或禁用深度测试）
5.  可选清除 Z 缓冲区或重新启用深度测试
6.  绘制你的场景 stuf ....（不要忘记为每个绘制的模型设置模型视图矩阵）

当然，您可以临时将您的相机位置（投影矩阵）设置为（0,0,0）并保留模型视图矩阵的身份，有时这是更精确的方法，但不要忘记在天空盒绘制后将相机位置设置回来。

希望能帮助到你。

# url - 在主站点导航中使用页面锚点

> ID：12064981
> 
> 赞同：0
> 
> 时间：2012-08-22T00:44:33.703
> 
> 标签：url, anchor

所以我有一个基本的（由 Wordpress 支持的）投资组合网站，其中大部分内容都位于主页上，然后我为特色项目使用自定义帖子类别，因此用户可以点击并在其上获取有关该项目的更多信息类别-single.php 页面。所以我们的想法是，就结构而言，它是一个非常平坦的网站。

事实上，如此扁平，标题中的站点导航只是链接到主页上的所有内容（关于、工作、什么、联系都是主页上的所有部分，当您单击时会向下滚动到）。

我想要发生的是当用户在主页上并单击顶部导航链接之一时，页面向下滚动到该部分（这里没问题 - 我的这部分工作得很好），然后当如果用户单击标题导航链接，则用户位于该站点的另一页面（想想一个深度，一个自定义帖子页面），它会将它们返回到主页并将它们向下滚动到该部分。我正在考虑基本的 url 锚结构，例如[http://somesite.com/page#specific_section](http://somesite.com/page#specific_section)，该链接将用户带到 somesite.com/page 上的特定部分。

然而，我似乎遇到的麻烦是正确创建这些 url。我将它们写为 mysite.com#about、mysite.com#work、mysite.com#contact、mysite.com#page-top，但浏览器不会触发用户转到主页，而是解释这些链接作为在当前页面上查找这些部分的说明。

我做错了什么，实现这一目标的正确方法是什么？

我要另外考虑的事情是，我是否需要创建 PHP 逻辑，在主页上以一种方式显示链接，在网站的其余部分以另一种方式显示链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:06:24.597

What you need to do is use the actual filenames of the pages in question, like:

`mysite.com/aboutme.html#qualifications` `mysite.com/portfolio.html#ZirTech

For links to the homepage, try either using the root relative path or fully qualifying the link like so:

`http://www.mysite.com/#section` *fully qualified*

`/#section` *relative path*

You shouldn't need to implement them a different way on the homepage - just implement them properly throughout the site.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:09:27.440

当您将 URL 写为 mysite.com#work、mysite.com#contact、mysite.com#page-top 时，浏览器会查找相关页面，因为没有指示它转到另一个页面（您需要添加“ /" 来重定向它）。

如果您希望它们指向主页，请将它们设置为

```
mysite.com/index.php#work, mysite.com/index.php#contact, mysite.com/index.php#page-top 
```

也许没有它是可能的`index.php`，但我现在有点懒得测试：

```
mysite.com/#work, mysite.com/#contact, mysite.com/#page-top 
```

# java - 如何将方法的输入分配给该方法的输出？

> ID：12064989
> 
> 赞同：-2
> 
> 时间：2012-08-22T00:45:44.543
> 
> 标签：java

我正在尝试重复更改字符串的方法，以便该方法的输入是已运行的同一方法的输出。这将被循环。

这是代码摘录：

```
public void start() {
    String inputString = "                                          ";
    boolean gameOver = false;

    while (!gameOver) {
        int column = columnResult();

        String tokens = enterToken("X", inputString,column);   
        System.out.println(tokens);

        enterToken("X", tokens, column);
        System.out.println(tokens);
    }
}

private int columnResult() {
    System.out.println("Enter column for X:");
    String keyInput = Keyboard.readInput();
    int column1 = Integer.parseInt(keyInput);
    return column1;
}

private String enterToken(String tokenSymbol, String inputString, int column){
    String columnEdit = inputString.substring(column*6-6,column*6); 

    String columnEdit1 = columnEdit.trim();
    String columnEdit2 = columnEdit1+tokenSymbol+"                 ";
    String columnEdit3 = columnEdit2.substring(0,6);
    String start = inputString.substring(0,column*6-6);
    String end = inputString.substring(column*6);

    System.out.println(start);
    return start+tokenSymbol+end;
} 
```

所以我试图为 NEXT enterToken 方法提供从 PREVIOUS 返回的值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T00:57:45.667

我看到了问题...

您的 String 变量仅在循环内具有范围，因此当循环迭代时，它是一个新变量。*在循环之外*定义您的 String 变量，因此它的范围在循环迭代中持续存在：

```
String tokens = inputString; // initialize the input
while (!gameOver) {
    int column = columnResult();
    // the result will be feed back in next iteration
    tokens = enterToken("X", tokens, column);   
    System.out.println(tokens);
} 
```

# jquery - 从单独的页面链接到隐藏的 jquery 锚点

> ID：12064994
> 
> 赞同：0
> 
> 时间：2012-08-22T00:46:40.790
> 
> 标签：jquery, anchor, hidden

我使用下面的代码在我的网站上设置了一些对锚点的滚动，但我遇到了一个问题，我想从另一个页面上的链接到隐藏的特定锚点（第 2 节）。我从其他一些问题/回答者中拼凑出这个

```
var sectionhash = window.location.hash.substring(1)
jQuery(document).ready(function(){
jQuery.scrollTo('a[name=' + '#section2' + ']')

}); 
```

但我无法让它工作。如果有人对如何实现它有任何想法，我很想知道。

```
var currentSection = '#section1';
var currentPos = 0;
jQuery(document).ready(function(){
  jQuery('.drop_down').find('a').bind('click', function(e) {
    e.preventDefault();
    var slidingSection = this.getAttribute('href');
    if(slidingSection == currentSection) return false;
    var slidingPos = jQuery(this).parent().index();
    var targetSlide = jQuery('#scroller').children().eq(slidingPos);

    jQuery('#scroller').children().not(currentSection).hide();
    targetSlide.show();
    var offset = 820;
    if(slidingPos < currentPos) offset = -820;
    targetSlide.css({top: offset});

    jQuery(slidingSection).animate({top: 0});
    jQuery(currentSection).animate({top: -offset});

    currentSection = slidingSection;
    currentPos = slidingPos;
  });
});

 <div id="scroller">
 <div id="section 1"> content</div>
 <div id="section 2"> different content</div>
  </div> 
```

# opengl - 如何从 .stl 文件生成缩略图

> ID：12064996
> 
> 赞同：1
> 
> 时间：2012-08-22T00:46:47.710
> 
> 标签：opengl, 3d-modelling, stereoscopy, 3ds

我的任务是创建一个应用程序，该应用程序将扫描包含 .stl 文件的目录并生成模型的 jpgs 缩略图，无需查看器或操作。有没有可用的解决方案，或者我应该创建自己的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T00:53:54.703

[Assimp](http://assimp.sourceforge.net/)声称能够读取`.stl`文件，也许您可​​以在 API 周围准备一个小包装器来加载模型、捕获帧缓冲区并保存图像。

# javascript - nodejs快速登录失败

> ID：12064998
> 
> 赞同：1
> 
> 时间：2012-08-22T00:47:14.403
> 
> 标签：javascript, node.js, session, express

我正在使用快速会话登录用户。

## 中间件：

```
var requireLogin = function (req, res, next) {
    if (req.session.user) {
        next();
    } else {
        res.redirect('/'); 
    }
} 
```

## 路线：

```
app.post('/login', requireLogin, routes.login);

exports.login = function (req, res) {
    var query = {username:req.body.username, password:req.body.password};

    User.find(query, function (err, data) {
        if (data) {
            req.session.user = data;
            console.log(data);
            res.redirect('/home');
        } else {
            console.log(err);
            res.redirect('/');
        }
    });
}; 
```

当我输入错误的用户名和密码时，它仍然会重定向到主页，但数据是`null`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:49:09.710

`find`返回匹配结果数组并`findOne`返回匹配文档。

我想`findOne`适合这种情况。

```
app.post('/login', requireLogin, routes.login);

exports.login = function (req, res) {
    var query = {username:req.body.username, password:req.body.password}; 
    User.findOne(query, function (err, data) {
        if (data && !err) {
            req.session.user = data;
            console.log(data);
            res.redirect('/home');
        } else {
            console.log(err);
            res.redirect('/');
        }
    });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T05:26:30.477

因为`find`返回一个结果数组，即使它是空的，`if (data)`仍然会评估为。`true`

`findOne`会更合适，因为您正在寻找具有该唯一用户名/密码组合的唯一用户。这种方式`if (data)`只会评估是否找到`true`匹配`User`项。

```
User.findOne(query, function (err, data) {
    if (err) {   
        // the username/password could be valid (or not), 
        // but there's no way to tell because there was some server error
        console.log(err);
        res.redirect('/');
    } else if (data) {
        // a user was found that matched the query
        req.session.user = data;
        console.log(data);
        res.redirect('/home');
    } else { 
        // there is no User that matches the query
        res.redirect('/');
    }
}); 
```