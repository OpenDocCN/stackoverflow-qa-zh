# StackOverflow 问答 000414000-000414999

# java - Java中的变量命名约定？

> ID：414001
> 
> 赞同：22
> 
> 时间：2009-01-05T18:15:31.930
> 
> 标签：java, naming-conventions, oop

在 PHP 中，我们（至少是优秀的程序员）总是以小写字母开头通用变量名，但以大写字母开头的类变量/对象来区分它们。以同样的方式，我们以小写字母开头一般文件名，但包含大写字母的类的文件。

例如：

```
<?php
$number=123;
$string="a string";
$colors_array=array('red','blue','red');
$Cat=New Cat();
?> 
```

java中的约定是否相同，即对象以大写开头但其余部分以小写开头，或者我在其他地方读到的所有内容都以小写开头？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-05T18:20:27.503

[您可以在Java 代码约定](http://java.sun.com/docs/codeconv/html/CodeConventions.doc8.html#367)中找到命名。

快速总结：

*   对于类，使用`UpperCamelCase`.
*   对于类成员和局部变量，请使用`lowerCamelCase`
*   对于包，使用反向 URI，例如`org.acme.project.subsystem`
*   对于常量，使用`ALL_CAPS`.

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-05T18:21:21.183

通常，所有变量都以小写字母开头：

```
int count = 32;
double conversionFactor = 1.5d; 
```

有些人喜欢在所有情况下都放置静态常量：

```
public static final double KILOGRAM_TO_POUND = 2.20462262; 
```

当您处理首字母缩略词时，事情会变得更加烦人，并且对于您是否应该使用没有真正的标准：

```
HTMLHandler myHtmlHandler; 
```

或者

```
HTMLHandler myHTMLHandler. 
```

现在，无论哪种方式，请注意类名（Object、String、HTMLHandler）总是以大写字母开头，但各个对象变量以小写字母开头。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-05T18:21:17.830

*   variablesAndMethodsLikeThis
*   像这样的类
*   CONSTANTS_LIKE_THIS

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-05T18:18:16.433

约定是类名以大写字母开头。变量名是驼峰式。即使变量引用了一个对象，它仍然以小写字母开头。

这个[页面](http://java.sun.com/docs/codeconv/html/CodeConventions.doc8.html)应该有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-03T14:36:42.140

您如何看待将 camelCase 用于实例方法并将 PascalCase 用于静态方法？我认为这可能会很有帮助，因为在验证哪种方法是静态的时不会有任何问题。这是我的提议

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T18:18:52.563

约定实际上取决于您编码的各个地方。

一般来说，从我所看到的类是 CamelCased（大写在前），方法以小写开头，以及我在各处看到的变量（一些 CamelCased，一些首字母小写的 camelCase（编辑：如前所述以上，这是规范），有些甚至使用匈牙利符号）。这取决于您的风格以及您正在从事的项目所采用的风格。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T19:02:54.847

有些人（不是我）喜欢通过在实例变量前面加上“this”来区分方法变量和实例变量。这也解决了将参数分配给同名实例变量时出现的问题：

```
public ConstructorMethod(MyVar variable) {
    this.variable=variable;
} 
```

但是有些人觉得你应该总是使用这种模式——但我并不喜欢它——我认为如果你保持你的方法和类很小，那就有点过头了。

此外，有些人对参数使用命名模式。当您从构造函数分配给实例变量时，这（再次）派上用场：

```
public ConstructorMethod(MyVar pVariable) {
    variable=pVariable;
} 
```

通常模式是`pVariable`或`_variable`。我偶尔会使用它，因为我发现它比这更具可读性，但它的缺点是使您的 Javadocs 可读性降低。

在任何情况下，我都不喜欢总是使用这些模式中的任何一个的想法，很高兴知道它们，但是如果您真的需要帮助在整个代码中区分它们，请告诉 Eclipse 以不同的颜色显示它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-06T18:10:17.110

java中变量的命名约定有一些规则

1.  Java 变量名区分大小写。变量名salary 与Salary 或SALARY 不同。
2.  Java 变量名称必须以字母（A 到 Z 或 a 到 z）、货币字符 ($) 或下划线 (_) 开头。
3.  在第一个字符之后，标识符可以有任意字符组合。
4.  保留关键字不能用作变量。

因此，所有实例、静态和方法参数变量名称都应采用驼峰式表示法。像 userName ，salary 等。常量名称为

```
pulic Static final String USER_NUMBER = 10 
```

参考 - [Java 变量命名约定](https://www.javavogue.com/2015/11/variables-in-java/#naming-conventions)

# asp.net - 基础设施培训

> ID：414008
> 
> 赞同：1
> 
> 时间：2009-01-05T18:16:49.807
> 
> 标签：asp.net, infragistics

我们是这项技术的高级用户，但必须通过反复试验来学习它。我们正在寻找物有所值的在线或讲师指导的正规培训。供应商的报价如何？还有其他建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T18:31:21.210

作为一名在世界知名培训机构工作的前技术培训师（我不会提及他们的名字，因为我即将解雇他们），我建议你直接去 Infragistics。如果您去知名的培训提供商之一，他们可能会向您推销这方面的培训。他们会找一位技术讲师，然后就该主题进行培训，然后那个人会出来培训你。所以你得到的导师不会是主题专家。总有一个在Infragistics方面经验丰富的讲师的机会，但我真的很怀疑。

我工作的公司经常要求我教授我不熟悉的科目。我是一名 .Net 开发人员，但是当他们没有预订 .Net 课程时，我不得不教授疯狂的科目来为公司赚钱。例如，有一次我不得不在课堂上教授高级 Excel。当我到达现场时，我了解到他们真正想知道的是 Excel 数据透视表，而我的公司刚刚向他们出售了高级 Excel 课程。我以前从未使用过数据透视表，也不知道它们是如何工作的。我有没有像工具一样脱落！更重要的是，客户在我的时间里没有得到任何有用的东西。你知道我使用 Excel 的频率吗？一个月一两个小时。但是由于我是一名高级技术培训师，我应该在一周内了解有关 Excel 的所有知识。我的意思是你会得到像我这样的人；*一些*技术，但可能不是基础设施。

说了这么多，我也会对接受 Infragistics 的培训持谨慎态度。如果您是高级用户组，您可能已经比被派去指导的培训师更有能力。我会确保您详细说明您希望学习的特定主题，这些主题的重要性，并确保您签署的培训合同包含有关此的措辞（IANAL）。确保他们了解您想要什么，并且您不会对任何不满意的东西感到满意。这可能会让您花费更多，但这可能意味着您会得到一位高级培训师，至少可以在您需要帮助的主题到达之前对其进行研究。

编辑：

需要明确的是，除了在过去的项目中使用他们的一些控制之外，我根本没有任何经验，在 Infragistics 培训或公司方面。他们可能拥有世界上最好的训练。我正在对供应商培训进行概括。正如我所提到的，几年前我在一个 WinForms 项目中使用了 Infragistics 控件，并认为它们非常好。

# vba - 使用 VBA (Microsoft Word 2003) 将文本段落设为只读

> ID：414012
> 
> 赞同：0
> 
> 时间：2009-01-05T18:17:53.500
> 
> 标签：vba, ms-word

有没有办法使用 VBA 使 Microsoft Word 2003 文档中的段落只读？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:01:11.463

我认为您只能通过选择**不受**保护的段落来做到这一点。

下面是一个示例宏，它选择一段文本，启用它进行编辑，然后锁定文档的其余部分。您可以使用 IRM 或密码保护，下面的宏使用后者。您应该用更优雅的方法替换下面的选择方法

```
Selection.MoveLeft Unit:=wdCharacter, Count:=11, Extend:=wdExtend 
Selection.Editors.Add wdEditorEveryone
ActiveDocument.protect Password:="password", NoReset:=False, Type:= _
wdAllowOnlyReading, UseIRM:=False, EnforceStyleLock:=False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T19:18:13.363

您可以通过将要保护的文本放入文本表单并对其进行保护来做到这一点。显然有点恶心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-18T06:55:45.883

上面的答案将在可编辑区域留下黄色突出显示。

一种替代方法是添加此 AutoOpen 代码 [http://answers.microsoft.com/en-us/office/forum/office_2010-word/remove-highlighting-in-editable-areas-of-protected/bfe22585-c5d3-4c19-997f -092fc4aaaa7a](http://answers.microsoft.com/en-us/office/forum/office_2010-word/remove-highlighting-in-editable-areas-of-protected/bfe22585-c5d3-4c19-997f-092fc4aaaa7a)

```
Sub AutoOpen()
   ActiveWindow.View.ShadeEditableRanges = False
End Sub 
```

在 Word 2007（已测试）中，更直接的方法是创建富文本内容控件并设置属性。这将很容易地使段落成为只读而不会突出显示。

```
Sub LockContent()

Dim objCC As ContentControl
Set objCC = ActiveDocument.ContentControls.Add(Type:=wdContentControlRichText)

With objCC
    .Range.Text = "123123" 'Your text
    .LockContentControl = True
    .LockContents = True
End With

End Sub 
```

[https://msdn.microsoft.com/en-us/library/office/ff835775.aspx](https://msdn.microsoft.com/en-us/library/office/ff835775.aspx)上的更多 ContentControl.LockContentControl 属性

希望这可以帮助任何有同样头痛的人！:D

# sql-server - 在 MS SQL Server 2005 中使用 Pivot 转换时出错

> ID：414016
> 
> 赞同：1
> 
> 时间：2009-01-05T18:18:56.540
> 
> 标签：sql-server, ssis, pivot

我有下表，我正在旋转：

（ID、名称、值）

1, '任务 ID', 123

1、“语言”、“Java”

2, '任务 ID', 456

我已将 PivotKey 设置为 Name 列，并将 PivotedValue 设置为 Value 列。对于我的每个新列（任务 ID 和语言），我已将它们的 PivotKeyValue 分别设置为“任务 ID”和“语言”。我的包在上面的数据下运行良好，pivot 操作的结果是：

（ID、任务 ID、语言）

1, 123, '爪哇'

2, 456, 空

但是，当我在以下源数据上运行包时，我遇到了问题：

（ID、名称、值）

1、空、空

2、空、空

我得到的错误信息是：

**[枢轴 [4511]] 错误：枢轴键值“（无法转换为字符串）”无效。[DTS.Pipeline] 错误：SSIS 错误代码 DTS_E_PROCESSINPUTFAILED。组件“Pivot”(4511) 上的 ProcessInput 方法失败，错误代码为 0xC0202090。已识别的组件从 ProcessInput 方法返回错误。该错误是特定于组件的，但该错误是致命的，将导致数据流任务停止运行。在此之前可能会发布错误消息，其中包含有关失败的更多信息。**

我认为这意味着数据透视操作无法处理 PivotKey 列“名称”中的 NULL 值，因为它尚未配置为处理该值。问题是我不知道该怎么做。如何检测和处理输出列的 PivotKeyValue 属性中的 NULL 值（“输入和输出属性”表单）？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T04:37:58.793

NULL 会导致问题，因为您无法将表或结果集的列名设置为 NULL，而 PIVOT 运算符正在尝试这样做。您必须在预透视（或未透视）数据上使用 ISNULL 运算符。

一片空白 （，

通常你会做类似 ISNULL(value, 0) 的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T17:45:13.100

我可以使用以下脚本重新创建您的初始位置：

创建表数据表（Id INT，名称 Nvarchar（40），值 Nvarchar（40））

插入数据表值（1，'TaskID'，'123'）插入数据表值（1，'语言'，'Java'）插入数据表值（2，'TaskID'，'456'）

SELECT id,[TaskID],[Language] FROM (SELECT ID,[Name],[Value] FROM DataTable) AS s PIVOT (MAX(Value) FOR [Name] IN ([TaskID],[Language])) AS p

DROP TABLE 数据表

结果：

id TaskID 语言 1 123 Java 2 456 NULL

但是，当我运行时：

创建表数据表（Id INT，名称 Nvarchar（40），值 Nvarchar（40））

插入数据表值（1，NULL，NULL） 插入数据表值（2，NULL，NULL）

SELECT id,[TaskID],[Language] FROM (SELECT ID,[Name],[Value] FROM DataTable) AS s PIVOT (MAX(Value) FOR [Name] IN ([TaskID],[Language])) AS p

DROP TABLE 数据表

结果：

id TaskID 语言 1 NULL NULL 2 NULL NULL

这执行得很好。

我想我一定错过了你正在做的事情？

# java - 有没有好的 Java 网络库？

> ID：414020
> 
> 赞同：10
> 
> 时间：2009-01-05T18:19:50.063
> 
> 标签：java, networking, serialization

我目前正在寻找一个 Java 网络库。我想要做的是将 XML、JSON 或其他序列化消息从客户端发送到另一个客户端和/或客户端到服务器。

我的第一次尝试是为每条消息创建一个 POJO，加上一个用于发送的 MessageWriter 和一个用于接收它的 MessageReader。加上套接字和错误处理。这是很多容易出错的工作。

我正在寻找的是一个从套接字中抽象出来的更高级别的库。此外，它应该支持消息的代码生成之类的东西。

Google 的协议缓冲区 ( [http://code.google.com/apis/protocolbuffers/](http://code.google.com/apis/protocolbuffers/) ) 看起来很有希望。但是有替代品吗？重点不是速度或安全性（目前），它只是应该可靠地工作并且实施时间短。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-05T18:42:10.333

您有多种选择，具体取决于您想要从原始套接字中抽象的程度。一旦你离开套接字级编程，你就进入了*远程*领域，

*   Java 的标准远程处理选项：RMI 或 JMS
*   在每个客户端和服务器中实现 JMX Mbean，并使用 JMX 远程处理来调用消息传递操作。
*   如果您认为您可能想要使用多播，我肯定会检查[JGroups](http://www.jgroups.org/javagroupsnew/docs/index.html)。
*   如果您希望创建自己的协议但想使用一些现有的构建块，请查看[Jakarta Commons Net](http://commons.apache.org/proper/commons-net/)。答案 #1 中引用的**HttpClient**已合并到此包中。
*   还有一些有趣的专有消息传递系统具有支持多种平台/语言的附加优点，例如[Spread](http://www.spread.org)和[DBus](http://www.freedesktop.org/wiki/Software/dbus)。
*   如果不提及 WebServices 就无法枚举远程处理选项......但是......但是...... **blech！**

我不完全确定*消息的代码生成是*什么意思。你能详细说明一下吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T19:01:29.497

啊……明白了。但不是使用代码生成。编组和解组，如果两端都有 Java，可以使用简单的对象序列化吗？如果性能和/或消息大小是一个问题，您可以使您的 Message 类可外部化。

我以前没有看过 Protobuf。看起来还不错。使用它，您只需要一种传输方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T18:25:33.470

从 apache尝试[HttpClient 。](http://hc.apache.org/httpclient-3.x/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T18:33:33.813

如果您还没有使用 Spring，那么这可能比您想要的要多。但是 HttpInvoker 是发送消息的一个相当高级的抽象。所有[远程信息](http://static.springframework.org/spring/docs/2.0.x/reference/remoting.html)都可以在线获得，HTTP Invoker 部分位于 17.4。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T19:10:46.890

如果您喜欢这些功能，您可能还想查看[JBossCache](http://www.jboss.org/jbosscache/)。它是使用 JGroups 实现的，虽然您的要求不是缓存解决方案，但它确实通过基本上实现带有事件通知等的分布式哈希映射很好地抽象了 JGroups 的一些显着功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T00:53:45.823

基于语言中性（某种）网络库/框架的 IDL（接口描述语言的变体）：

*   [Thrift](http://incubator.apache.org/thrift/) - Apache 许可证。
*   [Ice](http://zeroc.com/ice.html) - GPL 和商业许可证。
*   [CORBA](http://www.corba.org/) - 如果您想要更多选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-08T06:41:01.497

我建议您查看 ActiveMQ 来传递消息。它简单、灵活、快速。它支持 Serializable 对象，还支持 Map 消息和其他 JMS 消息类型，因此您不需要自己的序列化格式，除非效率很重要。如果性能很重要，我建议使用 Hessian，它非常快，无需代码生成。

# python - 是否有 Python 库可以模拟来自不同地址的网络流量

> ID：414025
> 
> 赞同：20
> 
> 时间：2009-01-05T18:20:39.987
> 
> 标签：python, networking

是否有一个 python 库可以让我从不同的源地址和端口向机器发送 UDP 数据包（发送到本地主机是可以的）？我记得有一个，但现在找不到了。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-05T18:44:27.783

[您可以使用Scapy](http://www.secdev.org/projects/scapy/)库来欺骗 IP 地址。

以下是 Packet Wizardry 中的一个示例[：使用 Python 统治网络](http://web.archive.org/web/20120401161821/http://packetstorm.linuxsecurity.com/papers/general/blackmagic.txt)：

```
#!/usr/bin/env python
import sys
from scapy import *
conf.verb=0

if len(sys.argv) != 4:
    print "Usage: ./spoof.py <target> <spoofed_ip> <port>"
    sys.exit(1)

target = sys.argv[1]
spoofed_ip = sys.argv[2]
port = int(sys.argv[3])

p1=IP(dst=target,src=spoofed_ip)/TCP(dport=port,sport=5000,flags='S')
send(p1)
print "Okay, SYN sent. Enter the sniffed sequence number now: "

seq=sys.stdin.readline()
print "Okay, using sequence number " + seq

seq=int(seq[:-1])
p2=IP(dst=target,src=spoofed_ip)/TCP(dport=port,sport=5000,flags='A',
                                     ack=seq+1,seq=1)
send(p2)

print "Okay, final ACK sent. Check netstat on your target :-)" 
```

# php - 积极维护用于用户身份验证的 PHP 库？

> ID：414034
> 
> 赞同：15
> 
> 时间：2009-01-05T18:23:19.073
> 
> 标签：php, security, authentication

我知道滚动您自己的用户身份验证脚本的风险，但我也对使用似乎没有得到积极维护的软件包保持警惕：[当前版本的 PEAR LiveUser](http://pear.php.net/package/LiveUser/download/)已经快一年了。

请推荐（并论证）一个积极维护的用户身份验证库，它可以集成到现有的 Web 项目中。理想情况下，它应该支持各种角色——匿名用户、注册用户和不同级别的管理员。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T18:32:38.290

听起来您想要的是用户控件库，而不是身份验证库。

例如，在[Zend 框架](http://framework.zend.com)中有两个类：（[`Zend_Auth`](http://framework.zend.com/manual/en/zend.auth.html)处理用户身份验证：登录（例如对[OpenID的](http://framework.zend.com/manual/en/zend.auth.adapter.openid.html)[简单数据库表](http://framework.zend.com/manual/en/zend.auth.adapter.dbtable.html)））和（处理事物的用户访问方面）。[`Zend_Acl`](http://framework.zend.com/manual/en/zend.acl.html)

我非常喜欢 ZF 类 - 我没有尝试在 ZF 项目之外使用它们，但他们的大多数类都可以尝试一下。即使您决定自己构建它们，它们也可以作为参考。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T18:31:30.603

在我看来，PEAR 没有太大变化，因为它很稳定。我不会害怕使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-27T12:44:04.680

[http://ulogin.sourceforge.net/](http://ulogin.sourceforge.net/)

非常安全且经过深思熟虑。它也非常可配置。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-07-25T04:06:53.047

使用 md5() 时；将密码存储在 mysql 数据库中的表上。

请记住，从登录表单检查输入的密码时，将需要相同的过程，与数据库中的密码相反。

哈希生成函数的另一个例子是

沙1（）；

你总是可以包装这两个函数并创建一个简单的哈希生成方法

$string = md5(sha1($string));

返回$字符串；// 返回的哈希值

也可以使用 salt() 函数，它在一定程度上允许您自己的“公钥”。

盐（“mystring123”，“jz”）；

# sms - 如何实现 SMS 服务？

> ID：414047
> 
> 赞同：13
> 
> 时间：2009-01-05T18:29:57.690
> 
> 标签：sms

我有一个客户希望应用程序能够向订阅该服务的人发送 SMS 文本消息警报。我已经在很多网站上看到过这样做，但我不知道设置它涉及什么。有没有人有这样做的经验？涉及什么？

谢谢，布伦特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T18:34:24.090

每部手机都有一个[用于发送 SMS 的电子邮件地址](http://en.wikipedia.org/wiki/SMS_gateways#Carrier-provided_email_or_web_to_SMS_gateways)，但据说这并不可靠。您的另一个选择是[SMS 网关](http://en.wikipedia.org/wiki/SMS_gateways)Web 服务 API（有很多）或[Twilio 之](http://twilio.com)类的服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T18:47:29.090

此处讨论的类似内容可能会有所帮助：

[程序化短信](https://stackoverflow.com/questions/4269/programmatic-sms)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T18:35:08.787

他们通常通过 SMS 网关（参与在电话网络上发送实际消息的公司）发送 SMS，该网关为他们提供 SOAP 端点。它与 Web 服务调用一样简单，但实际代码将取决于您正在使用的公司。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T18:36:26.053

第一步是获得 SMS 提供商——取决于您的规模/预算，取决于您是否会安装直接连接到所选移动网络的千流链接 / 使用 USB 移动数据卡 / 使用第三方的服务派对。

每一个都有很大的不同，并且大多数都会附带一个记录在案的 API 用于连接到

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T18:39:16.080

有许多提供 SMS 网关的服务。您针对哪些国家/地区？在美国似乎可以免费发送消息（因为接收者付费），在大多数其他国家，发送者必须付费。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T18:41:14.547

您还可以尝试直接连接到移动运营商的 SMSC（短消息服务中心）作为外部实体。他们为您提供电话号码、用户名和密码，您可以使用它们与 SMPP 协议（​​版本 3.3 或 3.4）进行连接。您当然必须为此与运营商交谈，这并不容易，但这是最好的方式，因为这是他们网关使用的本机协议。SourceForge 有一个 SMPP java 库。

其他提供商提供网络服务来发送消息，但您无法接收消息；使用 SMPP，它是双向的，以防您需要接收来自客户的 SMS。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T18:48:19.570

最可靠的方法是使用像[Clickatell](http://www.clickatell.com/)这样的 SMS 网关提供商。如果您想要免费和基于广告的，请使用[TextMarks](http://www.textmarks.com/)（尽管他们确实有基于收费的解决方案）。TextMarks 还具有能够接受传入文本消息的额外好处。

您可以通过 HTTP 提交到其中任何一个地方，这样您就不必自己处理细节。自己动手并直接与运营商打交道……嗯……介于烧伤自己和砍断手臂之间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-15T14:14:33.317

您甚至可以使用[txtWeb](https://www.txtweb.com)短信平台来完成任务。

txtWeb 平台公开了一些易于使用的 API，允许您从 Web 应用程序向美国/加拿大和印度的用户发送 PUSH 消息。

它基本上是一个基于 PULL 的平台，但具有按需推送消息的能力。

# vb6 - 是否有 Visual Basic 6 反编译器？

> ID：414068
> 
> 赞同：51
> 
> 时间：2009-01-05T18:38:52.600
> 
> 标签：vb6, decompiling

我丢失了在我工作的公司所做的一个项目的源代码，并且找不到 Visual Basic 6 反编译器；那甚至存在吗？

我只有从用户机器上救出的 EXE。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-05T18:44:38.017

对于应用程序的最终编译代码，简短的回答是“否”。不同的工具能够从代码中提取不同的信息（例如表单设置），并且有 P 代码反编译器（请参阅 Edgar 的此类工具的优秀链接）。然而，直到今天，还没有原生代码的反编译器。我也不知道其他高级语言有什么类似的东西。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-05T18:40:18.307

[http://www.program-transformation.org/Transform/VisualBasicDecompilers](http://www.program-transformation.org/Transform/VisualBasicDecompilers)

此链接为 VB6 反编译提供了很多资源，但它似乎在很大程度上取决于您所拥有的（您是否还有预链接对象代码 [编辑：呃...我的意思是 p 代码]，或者只是EXE？）无论哪种方式，它看起来都有一些东西，看看那里。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-08-02T17:06:13.657

我以前用过 VB Decompiler Lite ( [http://www.vb-decompiler.org/](http://www.vb-decompiler.org/) )，虽然它没有给你原始源代码，但它确实给了你很多信息，比如方法名，一些变量字符串等。有了更多的知识（或完整的版本），可能会得到更多。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-12-31T13:04:28.680

您是否尝试过名为**VBReFormer** ( [http://www.decompiler-vb.net/](http://www.decompiler-vb.net/) ) 的工具？在过去的一年中，我们经常使用它来找回我们应用程序的源代码（我们在 6 年前丢失的源代码）并且它运行良好。我们还能够直接从 vbreformer 进行一些用户界面更改并将它们保存到 exe 文件中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-14T21:59:45.650

根据我自己的经验，我需要尝试找出一些旧的 VB6 程序在做什么，我求助于[Process Explorer (Sysinternals)](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer)。我做了以下事情：

1.  运行进程资源管理器
2.  运行 VB6 .exe
3.  在进程资源管理器中找到 exe
4.  右键单击进程
5.  检查“字符串”选项卡

这并没有显示实际的功能，但它列出了它们的名称、文件从哪里复制到哪里的文件夹，如果它访问数据库，它也会显示连接字符串。足以帮助您获得一个想法，但对于复杂的程序可能无用。我正在查看的程序非常基本（没有双关语）。

YMMV。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-09T07:46:05.657

是的，我认为您可以从以下位置下载它并将其帮助文件分开：vbdecompiler.org 站点。YouTube 上有一个视频，它解释了如何使用它从 exe 文件中获取代码并保存它。我希望我有所帮助。

# performance - 包内带绑定的动态 SQL 与普通 SQL 的性能

> ID：414072
> 
> 赞同：1
> 
> 时间：2009-01-05T18:39:39.620
> 
> 标签：performance, oracle

在 Oracle 10g 环境中，我有一条语句需要根据游标的结果执行几百万次。为了灵活性，当前代码在包体中将语句作为常量。这是代码的简化版本。请记住，这都在同一个包中：

```
c_Stmt  CONSTANT VARCHAR2(128) := 'DELETE FROM t WHERE fldA = :b1';

...

PROCEDURE p1(vSomeNumber NUMBER(10)) IS
BEGIN
  EXECUTE IMMEDIATE c_Stmt USING vSomeNumber;
END;

...

FOR i IN 1 .. 9999999
  LOOP
     p1(i);
  END LOOP; 
```

由于动态 SQL 已经使用绑定变量，重写此代码以使用常规 DML 语句替换动态 SQL 是否有任何性能优势，如下所示：

```
PROCEDURE p1(vSomeNumber NUMBER(10)) IS
BEGIN
  /* EXECUTE IMMEDIATE c_Stmt USING vSomeNumber; */
  DELETE FROM t WHERE fldA = vSomeNumber;
END; 
```

我认为影响可能是解析次数，但我不清楚这是否仍然是 10g 中的一个问题。

谢谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T18:46:48.840

常规 SQL 比动态 SQL（立即执行...）要快，但为什么要一一删除行呢？为什么不是一个删除行的大删除语句？以集合为基础，而不是逐行思考！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T19:17:33.927

通常，在循环之前准备语句并在循环期间执行语句句柄（当时提供参数）会更有效。这样，您就可以避免每次通过循环解析和准备语句的开销。

使用静态 SQL 将避免解析步骤，因为这应该在您定义过程时完成。但这并不能避免准备步骤的开销。

无论如何，互联网上的人们几乎总是无法确定哪种方式会表现更好。这部分取决于您的数据库和数据。您应该尝试两种方式并自己衡量性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T20:30:10.020

第二种方法（使用 Delete 语句）比第一种方法（使用 Execute Immediate）更快的原因之一是上下文切换。如果您执行立即执行，PL/SQL 进程必须停止，Oracle 需要加载解析进程，解析您的语句（或从语句缓存中检索它），然后再次切换到执行进程。使用后者，上下文切换更少。

这些上下文切换（如多线程程序中的线程切换）非常耗时。这就是为什么 Oracle 花费大量时间使批量处理语句（批量插入、批量选择）在 PL/SQL 中正确工作的原因。

如上所述，尝试让 PL/SQL 一次性完成所有删除，例如通过在 PL/SQL 表中创建要删除的 ID 列表并在 FORALL 循环中执行删除。更少的上下文切换意味着更多的工作可以快速完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T22:11:15.213

根据具体需求，您有多种方法可以提高删除速度。

首先，将一堆 ID 存储在 PL/SQL 数组中，并定期（并在最后）执行 FORALL 数组 DELETE 或 DELETE FROM table WHERE ID in (:arr(1), :arr(2)... )

其次，将 ID 存储在 GLOBAL TEMPORARY TABLE 中并定期/在最后，执行 DELETE FROM table WHERE id IN (SELECT id FROM global_temp_tbl)

这两个选项显然会延迟删除步骤，因此可能会影响使用这些表的循环内的 SQL。

第三，切换到静态 SQL。我在这里看不到动态 SQL 的好处（但您可能已经简化了示例，从而隐藏了好处）。切换到静态将减少软解析的数量（Oracle 散列语句并在其语句缓存中找到匹配项）。在您的情况下，这种节省可能会或可能不会很重要。它主要是 CPU 时间，但如果您有其他进程同时运行，则可能是一些锁定等待时间。

第四，如果软解析开销很大，但有理由不想切换到静态 SQL，则可以使用 DBMS_SQL。在那里，DBMS_SQL.PARSE 将在循环之外，并且只有 BIND_VARIABLE 和 EXECUTE 组件将在循环内。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-05T20:10:22.167

由于您陷入 pl/sql 地狱，另一种选择是更新该行，以指示它应该被删除。

您当前的查询可以忽略这些“软删除”行。

在未来的某个维护时段，您可以使用简单的删除语句删除“软删除”行。

# wpf - ListBox.SelectedItems 的双向手动绑定实现？

> ID：414074
> 
> 赞同：17
> 
> 时间：2009-01-05T18:41:14.217
> 
> 标签：wpf, data-binding, listbox

我一直在尝试查看是否有一种简单/聪明的方法来实现与 ListBox.SelectedItems 的绑定。如果您自己尝试过，您就会知道，使用 BindingExtension 的标记绑定将不起作用——该属性不支持它。因此，您需要为 SelectionChanged 连接一个处理程序并尝试该路线。我得到的最接近的是这篇文章：

~~[http://alexshed.spaces.live.com/blog/cns!71C72270309CE838!149.entry](http://alexshed.spaces.live.com/blog/cns!71C72270309CE838!149.entry)~~

*更新：上面提到的博客不再可用，该作者当前的博客[在这里](http://blogs.ugidotnet.org/SoaringCode/Default.aspx)，我能找到的最接近引用的博客文章的是[这个 StackOverflow 答案](https://stackoverflow.com/a/1584718/109702)。*

它在一个方便的附加属性中实现了所有必要的 C#。但它将“绑定”实现为单向、目标到源。我想要双向绑定。

有任何想法吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-12T12:47:12.987

我找到了一个优雅的解决方案，我刚刚抽出时间写了[一篇关于它的博客文章](http://blog.functionalfun.net/2009/02/how-to-databind-to-selecteditems.html)。

我所做的是创建一个附加属性 SynchronizedSelectedItems，您可以在 ListBox（实际上是 DataGrid）上设置它。您将它数据绑定到一个集合，然后，通过一点魔术，ListBox 上的 SelectedItems 属性和您的集合保持同步。您可以从我的博客文章中下载所有代码。

“魔术”是一个类，它侦听任一集合中的 CollectionChanged 事件，并将更改传播到另一个集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-05T21:11:19.283

我一直在为此寻找解决方案，但提议似乎过于复杂。因此，这是一个新的双向绑定解决方案，它仅限于附加属性，并使用弱事件处理来观察定义的依赖属性的变化。我没有花时间做这个防弹，但它确实有效。

* * *

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Windows;
using System.Windows.Controls;

namespace WpfApplication2
{
    public class ListBoxHelper
    {
        private static Dictionary<int, bool> SynchToDPInProcessDictionary = new Dictionary<int, bool>();
        private static Dictionary<int, bool> SynchToLBInProcessDictionary = new Dictionary<int, bool>();

        public static readonly DependencyProperty SelectedItemsProperty =
            DependencyProperty.RegisterAttached("SelectedItems", typeof(IList), typeof(ListBoxHelper),
                new FrameworkPropertyMetadata((IList)null,
                    new PropertyChangedCallback(OnSelectedItemsChanged)));

        public static IList GetSelectedItems(DependencyObject d)
        {
            return (IList)d.GetValue(SelectedItemsProperty);
        }

        public static void SetSelectedItems(DependencyObject d, IList value)
        {
            d.SetValue(SelectedItemsProperty, value);
        }

        private static void OnSelectedItemsChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var listBox = d as ListBox;
            if (listBox == null) 
                throw new InvalidOperationException("ListBoxHelper should only be used with ListBox or ListBox derived classes (like ListView).");

            int hashcode = listBox.GetHashCode();

            // Gets set on the initial binding.
            if (!SynchToDPInProcessDictionary.ContainsKey(hashcode))
            {
                SynchToDPInProcessDictionary[hashcode] = false;
                SynchToLBInProcessDictionary[hashcode] = false;

                var observableCollection = GetSelectedItems(listBox) as INotifyCollectionChanged;
                if (observableCollection != null)
                {
                    // Create a weak CollectionChanged event handler on the SelectedItems property
                    // that synchronizes the collection back to the listbox.
                    CollectionChangedEventManager.AddHandler(observableCollection,
                        delegate(object sender, NotifyCollectionChangedEventArgs e2)
                        {
                            SyncToLBSelectedItems(GetSelectedItems(d), (ListBox)d);
                        });
                }
            }

            SynchToDPSelectedItems(listBox);
            listBox.SelectionChanged += delegate
            {
                SynchToDPSelectedItems(listBox);
            };
        }

        private static void SynchToDPSelectedItems(ListBox listBox)
        {
            int hashcode = listBox.GetHashCode();
            if (SynchToLBInProcessDictionary[hashcode]) return;

            SynchToDPInProcessDictionary[hashcode] = true;
            try
            {
                IList dpSelectedItems = GetSelectedItems(listBox);
                dpSelectedItems.Clear();
                if (listBox.SelectedItems != null)
                {
                    foreach (var item in listBox.SelectedItems)
                        dpSelectedItems.Add(item);
                }
            }
            finally
            {
                SynchToDPInProcessDictionary[hashcode] = false;
            }
        }

        private static void SyncToLBSelectedItems(IList dpSelectedItems, ListBox listBox)
        {
            int hashcode = listBox.GetHashCode();
            if (SynchToDPInProcessDictionary[hashcode]) return;

            SynchToLBInProcessDictionary[hashcode] = true;
            try
            {
                listBox.SelectedItems.Clear();
                if (dpSelectedItems != null)
                {
                    foreach (var item in dpSelectedItems)
                        listBox.SelectedItems.Add(item);
                }
            }
            finally
            {
                SynchToLBInProcessDictionary[hashcode] = false;
            }
        }
    }
} 
```

# .net - 检测代码是否作为服务运行

> ID：414098
> 
> 赞同：9
> 
> 时间：2009-01-05T18:55:52.690
> 
> 标签：.net, windows-services

.NET 库有没有办法检测它是否作为服务运行？

我的图书馆可以以任何一种方式运行。但是当它作为服务运行时，开发人员需要调用一个额外的方法来指示事实或某些功能将无法正常工作。我希望处理日志记录的库在未调用该方法的情况下在服务中使用时写入警告。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-10-07T00:39:49.677

在通过智能感知、调试器和文档进行大量搜索之后，我们无法找到任何严格可靠的东西。获取当前进程 ID 并尝试确定该进程是否已向 SCM 注册是可能的，但是虽然 .NET 提供了一种获取所有服务集合的方法，但它们的进程 ID 不在可用信息中。将进程名称与服务名称进行比较是可能的，但不一定可靠。

但是，有两件事相对容易检查，可能足以满足您的需要，如果不完全是“此代码作为服务运行吗？”

`[System.Environment.UserInteractive](http://msdn.microsoft.com/en-us/library/system.environment.userinteractive.aspx)`：（正如斯蒂芬马丁所指出的）如果这是真的，那它就不可能是一项服务。大多数不是服务（也不是设备驱动程序）的进程都会说是真的。某些控制台应用程序在非交互式环境（例如构建过程的一部分）中运行时可能会显示为 false。

`[System.Diagnostics.Process.GetCurrentProcess](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getcurrentprocess.aspx)().[SessionId](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.sessionid.aspx)`: （我认为这与 Pierre 得到的相同）如果这不是 0，则它不是作为服务启动的。大多数正常的应用程序不会在会话 0 中（如 Pierre 和 Stephen 所述，有一些不那么正常的例外情况）。最大的问题是它在 XP 或更早版本等旧操作系统下的表现如何。XP 和 Windows 2000 显然在会话 0 中运行服务，但普通应用程序也将在会话 0 中运行。XP 的某些配置（例如，不在域中）允许同时多个用户会话，并且它们每个都获得不同的会话 id，但第一个获得会话 0。因此，在 Vista 之前进行检查并不有效。

因此，根据您实际需要区分的内容，这些检查中的一项或两项可能对您有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T19:13:24.497

尽管您可以使用 Environment.UserInteractive 进行猜测，但实际上没有任何方法可以判断您的库是否在服务的上下文中运行。

但通常一个库不应该依赖于它的应用程序上下文。一个库应该为应用程序提供服务，如果它需要不同的参数，这取决于它的调用方式，它应该要求应用程序提供这些参数。

您的图书馆可能不会严格根据它是否托管在服务中而采取不同的行动，而是您的图书馆需要了解一些有关服务环境或用户的信息。应用程序应将必要的条件或信息告知图书馆，图书馆不应自行猜测。

编辑：如果可以的话，我会赞成对你的问题的评论。如有必要，使用重载方法和/或如果未提供所有必要信息，则简单地失败。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-02-17T14:57:05.080

您可以添加[Microsoft.Extensions.Hosting.WindowsServices](https://www.nuget.org/packages/Microsoft.Extensions.Hosting.WindowsServices) NuGet 包并使用`WindowsServiceHelpers.IsWindowsService()`帮助程序方法。

对于 Linux，您可以使用[Microsoft.Extensions.Hosting.Systemd](https://www.nuget.org/packages/Microsoft.Extensions.Hosting.Systemd/)和`SystemdHelpers.IsSystemdService()`方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T19:11:44.797

您可能应该检查您是否在会话零中运行（至少如果您的目标是 Vista）。您可以使用`WTSRegisterSessionNotification`，就像在这个示例中一样：

```
 [DllImport("kernel32.dll")]
  private static extern int WTSGetActiveConsoleSessionId(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-08T23:37:09.070

一种快速而肮脏的方法是将命令行开关应用于注册表中*HKLM\System\CurrentControlSet\services\MyService\ImagePath*下的条目，然后在主函数中检查该开关。

然后您就知道您是否是由 services.exe 启动的。是的，这是一个黑客。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-25T14:29:47.290

聚会有点晚了，但是如何使用 ServiceController.GetServices 获取服务列表并对照这些检查您的进程 ID？

（“如何获得正在运行的 Windows 服务进程 ID？”：[http](http://social.msdn.microsoft.com/Forums/en/netfxbcl/thread/a979351c-800f-41e7-b153-2d53ff6aac29) ://social.msdn.microsoft.com/Forums/en/netfxbcl/thread/a979351c-800f-41e7-b153-2d53ff6aac29 ）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T22:36:07.677

一种方法是查看应用程序的用户上下文。如果您看到它以“SYSTEM”用户身份运行，那么您正在作为服务运行（或至少具有服务级别权限）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-24T16:32:48.770

0xA3 对[这个问题](https://stackoverflow.com/questions/1974828/how-do-we-tell-if-a-c-application-is-launched-as-a-windows-service)的回答实际上包含用于查询 SCM 的 C# 代码，就像 Rob Parker 在他的回答中描述的那样。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-02-11T18:08:14.757

似乎我参加聚会有点晚了，但话题似乎很受欢迎。作为服务运行时的有趣区别在于，在应用程序启动时，当前文件夹指向系统目录（`C:\windows\system32`默认情况下）。在任何现实生活中，用户应用程序几乎不可能从系统文件夹开始。

所以，我使用以下技巧（c#）：

```
protected static bool IsRunAsService()
{
    string CurDir = Directory.GetCurrentDirectory();
    if (CurDir.Equals(Environment.SystemDirectory, StringComparison.CurrentCultureIgnoreCase))
    { 
         return true; 
    }

    return (false);
} 
```

更多详情请访问：[https ://stackoverflow.com/a/60174944/8494004](https://stackoverflow.com/a/60174944/8494004)

# sql-server - 我应该如何将高度格式化的数据从 Excel 导入数据库？

> ID：414100
> 
> 赞同：1
> 
> 时间：2009-01-05T18:56:08.697
> 
> 标签：sql-server, excel, ssis

将高度格式化的数据从 Excel 导入 SQL Server 的最佳方法是什么。基本上，我有 250 多个 Excel 文件，它们以我们的业务用户喜欢的格式从报告工具中导出。这是无法以任何其他格式导出数据的第 3 方工具。我需要每月“清理”这些文件并将它们导入数据库。我想使用 SQL Server 2005

文件格式如下所示：

```
 Report Name

                                                     Report Description

                                    MTH/DEC/2003 MTH/JAN/2004 MTH/FEB/2004 
                                    Data Type  Data Type    Data Type

Grouping 1                           1900         1700         2800

  Grouping 2                         1500         900          1300

    Detail                           300          500          1000

    Detail                           1100         200          200

    Detail                           100          200          100 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:00:22.977

您可以编写一个简单的解析器应用程序。有许多 api 可以处理读取 excel 文件。

我用java写了一个，只用了一两天。

[这](http://jexcelapi.sourceforge.net/)是一个api。

祝你好运

编辑：忘了提到我们还需要一个 sql api，例如[JDBC](http://www.microsoft.com/sqlserver/2005/en/us/java-database-connectivity.aspx)。再次，我们将 JDBC 用于我们的大多数应用程序并且效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T19:17:45.127

就我个人而言，我会使用 SSIS 来完成。由于文件格式看起来相对复杂，因此设置起来可能并不简单（但我怀疑无论您使用什么工具都可能是真的），但只要它保持一致，它每个月都会快速运行，并且 SSIS 包很容易置于源头控制之下。由于 SSIS 是 SQL Server 的一部分，因此很容易确保所有服务器都可用。关键是要很好地理解该格式与您在数据库中存储数据的方式之间的关系。无论您使用什么工具，这都是困难的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T19:05:22.907

假设你有 Microsoft Excel，你也可以使用 Excel 自己暴露的 ActiveX 界面。更多信息在这里：

[http://msdn.microsoft.com/en-us/library/wss56bz7(VS.80).aspx](http://msdn.microsoft.com/en-us/library/wss56bz7(VS.80).aspx)

您也可以在任何可以使用 ActiveX（C++、VB6、VB.NET 等）的东西中使用它来创建解析器，以跟进 Berek 所说的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T19:06:10.597

我以前用 perl 和 MYSQL 做过这个。我编写了一个简单的 perl 脚本，它解析文件并将内容输出到 .sql 文件。然后，这可以手动完成或包含在 perl 脚本中，打开 MYSQL 并使用 .sql 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T19:24:53.693

您可能想查看 SQL Server 中的 CLR 过程和函数。使用 CLR 过程，您可以在 VB 或 C# .NET 应用程序中完成所有清理工作，但仍像任何其他存储过程或 UDF 一样从 SQL Server 运行作业。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T20:20:36.357

对于基于 java 的应用程序，POI ( [http://poi.apache.org/](http://poi.apache.org/) ) 非常适合 Excel 集成应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T19:53:04.230

这可能看起来有点简单，但您可以简单地将数据转储为 csv 格式，并对输出进行一些解析以转换为 SQL 的插入语句。

# iphone - 有谁看过Interface Builder构建Cocoa Touch插件的教程

> ID：414103
> 
> 赞同：6
> 
> 时间：2009-01-05T18:57:10.770
> 
> 标签：iphone, cocoa-touch, plugins, interface-builder

有谁知道我在哪里可以找到为 Interface Builder 构建 Cocoa Touch 插件的示例或教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T20:07:54.107

不幸的是，你不能制作 Cocoa Touch IB 插件。不支持制作 Cocoa Touch 框架，这是制作 IB 插件所必需的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-01T15:55:43.680

这个功能似乎也没有出现在 XCode 4 beta 上......这有点令人失望......

# database - Linq 与数据库视图

> ID：414106
> 
> 赞同：2
> 
> 时间：2009-01-05T18:57:31.877
> 
> 标签：database, linq, performance, views

这是一个有趣的问题。假设我们在数据库中有相关的表，例如 Instrument 和 Currency。Instrument 表有一个 currency_id 字段，该字段映射到 Currency 表中的条目。在 Linq 土地上有什么更好的方法：

a) 在 DataContext 中创建 Instrument 和 Currency 实体，然后创建关联或简单地在 Linq 查询中使用 join 或

b）在数据库中创建一个视图，将 Instrument 和 Currency 连接起来（从而将 currency_id 解析为货币代码）并将其用作 Linq 上下文中的实体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:04:45.653

你会独立使用它们吗？如果是这样，您将需要为每个将独立使用的实体。我怀疑您将独立使用货币（例如，允许您在创建工具时选择货币的下拉菜单）。既然如此，我认为将它们分开并建立关联会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:43:57.613

*   If you load in Instrument and later use the Currencies property to load in related Currencies, there will be two queries.

*   If you issue a linq query with a join, linq will convert that to sql with a join and you get all the data at once.

*   If you set up a DataLoadOptions, you get all the data in one query and you do not have to write the join.

[http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.aspx) [http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.loadwith.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.loadwith.aspx)

```
DataLoadOptions dlo = new DataLoadOptions();
dlo.LoadWith<Instrument>(i => i.Currencies)
myDataContext.LoadOptions = dlo; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T19:17:31.930

随着 ORM 现在抽象了数据访问逻辑，不再需要特定的视图功能。最好将其留给 ORM，因为这是其功能的一部分。

然而，视图对于简化存储过程代码甚至对于创建有用的索引可能仍然有用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-11-30T04:54:39.853

我发现 LINQ 是喜怒无常的。我可以间隔 1 分钟运行相同的查询并得到不同的结果。注意我正在使用本地数据库，所以我知道数据没有改变。在我的选择中，使用带有数据集的视图要可靠得多，尤其是在连接时。

# .net - .NET 通用字典是否应该初始化为容量等于它将包含的项目数？

> ID：414109
> 
> 赞同：13
> 
> 时间：2009-01-05T18:57:56.790
> 
> 标签：.net, dictionary, hash, capacity

如果我有 100 个项目将存储在字典中，我应该这样初始化它吗？

```
var myDictionary = new Dictionary<Key, Value>(100); 
```

我的理解是 .NET 字典在达到给定负载时会在内部调整自身大小，并且负载阈值被定义为容量的比率。

这表明如果将 100 项添加到上述字典中，那么当添加其中一项时，它会自行调整大小。调整字典大小是我想避免的，因为它会影响性能并且浪费内存。

散列冲突的概率与字典中的加载成正比。因此，即使字典不调整自身大小（并使用其所有插槽），性能也会因这些冲突而降低。

假设您知道字典中有多少项，应该如何最好地决定将字典初始化到什么容量？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T19:10:21.680

### 改进的基准：

*   硬件：Intel Core i7-10700K x64，.NET 5，优化构建。运行 .NET 5 的 LINQPad 6 和运行 .NET Fx 4.8 的 LINQPad 5。
*   时间以毫秒为单位，保留 3 个小数位。
    *   `0.001ms`是 1 微秒。
    *   我不确定`Stopwatch`它的实际分辨率，因为它取决于系统，所以不要强调微秒级的差异。
*   基准测试被重新运行了数十次，结果一致。显示的时间是所有运行的平均值。
*   结论：通过**在****构造函数中****进行设置，整体加速始终保持 10-20%`capacity``Dictionary<String,String>`**。

* * *

| 。网： | .NET 框架 4.8 | .NET 5 |
| --- | --- | --- |
| **初始容量为 1,000,000** |  |  |
| 构造函数 | 1.170ms | 0.003ms |
| 填写循环 | 353.420 毫秒 | 181.846 毫秒 |
| 总时间 | 354.590 毫秒 | 181.880 毫秒 |
| **无初始容量** |  |  |
| 构造函数 | 0.001ms | 0.001ms |
| 填写循环 | 400.158ms | 228.687 毫秒 |
| 总时间 | 400.159 毫秒 | 228.688ms |
| **从设置初始容量加速** |  |  |
| 时间 | 45.569 毫秒 | 46.8ms |
| 加速 ％ | 11% | 20% |

*   `10`我确实对较小的初始大小（ 、`100`、`1000`、`10000`和）重复了基准测试，并且`100000`在这些大小上也观察到了 10-20% 的加速，但绝对而言，在需要几分之一毫秒的操作上加速了 20%
*   虽然我看到了一致的结果（显示的数字是平均值），但有一些警告：
    *   这个基准测试是在 1,000,000 个项目的相当*大*的规模上执行的，但有紧密的循环（即循环体内没有太多其他事情发生），这不是一个现实的场景。因此**，请始终对您自己的代码进行剖析和基准测试以确保知道，**而不是相信您在 Internet 上找到的随机基准[（就像这个）]。
    *   基准测试不会隔离生成数百万个左右`String`实例所花费的时间（由`i.ToString()`.
    *   引用类型`String`（值类型（例如 a `ValueTuple`）。还有[其他类型大小的因素](https://theburningmonk.com/2015/07/smallest-net-ref-type-is-12-bytes-or-why-you-should-consider-using-value-types/)需要考虑。
    *   随着从 .NET Framework 4.8 到 .NET 5 的大幅改进，这意味着如果您在 .NET 6 或更高版本上运行，则不应相信这些数字。
        *   此外，不要假设较新的 .NET 版本会_总是）使事情变得更快：有时 .NET 更新[和操作系统安全补丁](https://www.microsoft.com/security/blog/2018/01/09/understanding-the-performance-impact-of-spectre-and-meltdown-mitigations-on-windows-systems/)的性能实际上会恶化。

```
// Warmup:
{
    var foo1 = new Dictionary<string, string>();
    var foo2 = new Dictionary<string, string>( capacity: 10_000 );
    foo1.Add( "foo", "bar" );
    foo2.Add( "foo", "bar" );
}

Stopwatch sw = Stopwatch.StartNew();

// Pre-set capacity:
TimeSpan pp_initTime;
TimeSpan pp_populateTime;
{
    var dict1 = new Dictionary<string, string>(1000000);

    pp_initTime = sw.GetElapsedAndRestart();

    for (int i = 0; i < 1000000; i++)
    {
        dict1.Add(i.ToString(), i.ToString());
    }
}
pp_populateTime = sw.GetElapsedAndRestart();

//
TimeSpan empty_initTime;
TimeSpan empty_populateTime;
{
    var dict2 = new Dictionary<string, string>();

    empty_initTime = sw.GetElapsedAndRestart();

    for (int i = 0; i < 1000000; i++)
    {
        dict2.Add(i.ToString(), i.ToString());
    }
}
empty_populateTime = sw.GetElapsedAndRestart();

//

Console.WriteLine("Pre-set capacity. Init time: {0:N3}ms, Fill time: {1:N3}ms, Total time: {2:N3}ms.", pp_initTime.TotalMilliseconds, pp_populateTime.TotalMilliseconds, ( pp_initTime + pp_populateTime ).TotalMilliseconds );
Console.WriteLine("Empty capacity. Init time: {0:N3}ms, Fill time: {1:N3}ms, Total time: {2:N3}ms.", empty_initTime.TotalMilliseconds, empty_populateTime.TotalMilliseconds, ( empty_initTime + empty_populateTime ).TotalMilliseconds );

// Extension methods:

[MethodImpl( MethodImplOptions.AggressiveInlining | MethodImplOptions.AggressiveOptimization )]
public static TimeSpan GetElapsedAndRestart( this Stopwatch stopwatch )
{
    TimeSpan elapsed = stopwatch.Elapsed;
    stopwatch.Restart();
    return elapsed;
} 
```

* * *

### 原始基准：

原始基准，没有冷启动预热阶段和较低精度的`DateTime`时序：

*   与容量 ( `dict1`) 的总时间是`1220.778ms`（建设和人口）。
*   没有能力（`dict2`）总时间是`1502.490ms`（建设和人口）。
*   因此，与不设置容量相比，容量节省了 320 毫秒（~20%）。

```
static void Main(string[] args)
{
    const int ONE_MILLION = 1000000;

    DateTime start1 = DateTime.Now;

    {
        var dict1 = new Dictionary<string, string>( capacity: ONE_MILLION  );

        for (int i = 0; i < ONE_MILLION; i++)
        {
            dict1.Add(i.ToString(), i.ToString());
        }
    }

    DateTime stop1 = DateTime.Now;

    DateTime start2 = DateTime.Now;

    {
        var dict2 = new Dictionary<string, string>();

        for (int i = 0; i < ONE_MILLION; i++)
        {
            dict2.Add(i.ToString(), i.ToString());
        }
    }

    DateTime stop2 = DateTime.Now;

    Console.WriteLine("Time with size initialized: " + (stop1.Subtract(start1)) + "\nTime without size initialized: " + (stop2.Subtract(start2)));
    Console.ReadLine();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-04T01:08:55.237

您应该将字典容量初始化为什么取决于两个因素：(1) gethashcode 函数的分布，以及 (2) 您必须插入多少项。

您的哈希函数应该是随机分布的，或者应该为您的输入集专门制定。让我们假设第一个，但如果您对第二个感兴趣，请查找完美的哈希函数。

如果您有 100 个项目要插入到字典中，一个随机分布的哈希函数，并且您将容量设置为 100，那么当您将第 i 个项目插入到哈希表中时，您有 (i-1) / 100 的概率插入时项目将与另一个项目发生冲突。如果您想降低这种碰撞概率，请增加容量。将预期容量加倍会使碰撞的机会减半。

此外，如果您知道访问字典中每个项目的频率，您可能希望按频率递减的顺序插入这些项目，因为您首先插入的项目平均访问速度更快。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-05T19:03:17.340

我认为你把事情复杂化了。如果您知道字典中有多少项目，那么一定要在构造时指定。这将有助于字典在其内部数据结构中分配必要的空间，以避免重新分配和重新洗牌数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T19:09:04.910

为构造函数指定初始容量会`Dictionary`提高性能，因为在 ADD 操作期间存储字典值的内部结构的大小调整次数将减少。

考虑到您将 k 的初始容量指定给`Dictionary`构造函数，则：

1.  将`Dictionary`保留存储 k 个元素所需的内存量；
2.  对字典的查询性能不受影响，不会更快或更慢；
3.  ADD 操作不需要更多的内存分配（可能很昂贵），因此会更快。

来自[MSDN](http://msdn.microsoft.com/en-us/library/tk84bxf4.aspx)：

> Dictionary(TKey, TValue) 的容量是在需要调整大小之前可以添加到 Dictionary(TKey, TValue) 中的元素数。随着元素被添加到 Dictionary(TKey, TValue) 中，容量会根据需要通过重新分配内部数组来自动增加。
> 
> **如果可以估计集合的大小，则指定初始容量消除了在向 Dictionary(TKey, TValue) 添加元素时执行许多调整大小操作的需要。**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T19:08:14.350

是的，与`HashTable`使用重新散列作为解决冲突的方法相反，`Dictionary`将使用链接。所以是的，使用计数很好。对于`HashTable`您可能想要使用的`count * (1/fillfactor)`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-05T19:10:42.910

初始大小只是一个建议。例如，大多数哈希表喜欢具有素数或 2 的幂的大小。

# linux - qt4.4.3 上的 QVariant/QTreeWidgetItem/iterator 问题

> ID：414115
> 
> 赞同：2
> 
> 时间：2009-01-05T19:00:04.710
> 
> 标签：linux, qt, kde, qtreewidget, qvariant

在我的 qt 应用程序中，我有这个对象，在设置我的 QTreeWidget 的内容之前填充：

```
QList<QTreeWidgetItem*> items; 
```

我通过这种方式填充 QList：

```
QVariant qv; // I need this for "attaching" to the item my linuxPackage object
qv.setValue(linuxPackage);
packRow->setData(1, Qt::UserRole,qv); // packRow is my own object inherited from QTreeWidgetItem, I "put" the QVariant into it
items.append(packRow); // then I put my item into the QList 
```

在工作结束时，我的 QList 有近 1000 个项目。

我需要遍历它们，并且对于每个项目，我需要通过这种（经过测试和工作）方式获取“linuxPackage”数据：

```
Pkg linuxPackage = this->data(1,Qt::UserRole).value<Pkg>(); // Pkg is my own class for the linuxPackage object 
```

所以，我一直在尝试通过这种方式提取所需的数据：

```
QList<QTreeWidgetItem*>::iterator iter; 
for (iter = items.begin(); iter != items.end(); ++iter){
    Pkg pack = iter->data(1,Qt::UserRole).value<Pkg>();
} 
```

但没有任何效果，我什至无法编译程序。帮助！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T06:27:32.920

也许：

```
(*iter)->data(1,Qt::UserRole).value<Pkg>(); 
```

顺便说一句，使用 Qt4 执行此操作的更简单方法：

```
foreach (const QTreeWidgetItem *item, items) {
    Pkg pack = item->data(1,Qt::UserRole).value<Pkg>();
} 
```

至少，你应该使用`const_iterators`=)

```
QList<QTreeWidgetItem*>::const_iterator iter; 
for (iter = items.constBegin(); iter != items.constEnd(); ++iter){
    ...
} 
```

# reporting-services - SSRS 中的 XY 散点图不会显示点

> ID：414137
> 
> 赞同：0
> 
> 时间：2009-01-05T19:05:26.150
> 
> 标签：reporting-services, charts, reporting, graphing

我对这个有点困惑。

我有一个带有 BackupDate 和 BackupTime 以及 BackupType 的数据集。BackupDate 由表中日期时间字符串左侧的 12 个字符组成。BackupTime 由同一日期时间字符串右侧的 8 个字符组成。例如：BackupDate 为“2008 年 12 月 12 日”，BackupTime 为“12:53PM”。

我在报告中添加了一个 XY 散点图。我为 BackupType 添加了一个“系列”值（因此可以区分 Full/Incr/Log 备份）。我添加了 BackupDate 的类别值，并将 X 轴的比例设置为从 BackupDate 的最小值到 BackupDate 的最大值。然后，我向 Values 添加了一个项目，其中 Y 变量设置为 BackupTime，X 变量设置为 BackupDate。Y 轴的时间间隔为上午 12:00 到晚上 11:59，标签的格式为“hh:mmtt”。

BackupTime 与 Y 轴的格式相匹配。BackupDate 与 X 轴的格式匹配。我的数据集检索了 10 个条目，并且由 BackupType 字段正确填充了图例。

图形上没有绘制任何点，并且如果启用了标记/指针，则不会显示它们。图表上应该有一个点，每天的每个时间点都有特定类型的备份。

我错过了什么吗？有谁知道专门处理 XY 散点图并以我想要的方式使用它们的好教程？

我使用的是 2005 版的 SSRS，而不是 2008 版。

我的图表当前的屏幕截图：

![](https://img.photobucket.com/albums/v376/MythOpus/chart.jpg)

如果它可能与数据集相关：

```
SELECT     TOP (10) backup_type, LTRIM(RTRIM(LEFT(backup_finish_date, 
                  12))) AS BackupDate, LTRIM(RTRIM(RIGHT(backup_finish_date, 8))) AS BackupTime
 FROM         DBARepository.Backup_History 
```

根据要求，以下是此查询的结果。有一个 Where 子句将结果限制在特定服务器的特定数据库中，该特定服务器未包含在上述 SQL 查询中。

```
日志 2008 年 12 月 26 日 12:00PM
日志 2008 年 12 月 27 日凌晨 4:00
日志 2008 年 12 月 27 日上午 8:00
日志 2008 年 12 月 27 日 12:00PM
日志 2008 年 12 月 27 日下午 4:00
日志 2008 年 12 月 27 日晚上 8:00
数据库 2008 年 12 月 27 日晚上 10:01
日志 2008 年 12 月 28 日上午 12:00
日志 2008 年 12 月 28 日凌晨 4:00
日志 2008 年 12 月 28 日上午 8:00
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-24T11:16:15.063

随着数据的增长，散点图在扩展（浮动/数字）限制时会避免 X 轴值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-24T11:20:19.547

打开图表属性-> X 轴选项卡-> 次刻度线-> 数字或时间刻度值...它应该可以解决您的问题。

# sql - 使用 SQL Server 过滤多选框

> ID：414138
> 
> 赞同：2
> 
> 时间：2009-01-05T19:05:26.213
> 
> 标签：sql, sql-server, listbox

我需要根据多选列表框中的选择过滤来自 sql server 的结果集。我已经考虑过使用 instring 来确定所选过滤器值中是否存在行值，但这很容易出现部分匹配（例如 Car 匹配 Carpet）。

我还经历了将字符串拆分成一个表并基于此加入/匹配，但我对它的执行方式持保留态度。

鉴于这是一项看似常见的任务，我正在向 Stack Overflow 社区寻求一些反馈，并可能就解决此问题的最常用方法提出一些建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T19:31:40.107

我通过编写一个表值函数（我们使用的是 2005）解决了这个问题，该函数接受一个分隔字符串并返回一个表。然后你可以加入到那个或使用 WHERE EXISTS 或 WHERE x IN。我们还没有进行全面的压力测试，但是由于使用有限和相当小的项目集，我认为性能应该还可以。

以下是作为您起点的功能之一。我还写了一个专门接受查找表中 ID 值的分隔 INT 列表等。

另一种可能性是将 LIKE 与分隔符一起使用以确保忽略部分匹配，但您不能使用索引，因此对于任何大表来说性能都会很差。例如：

```
SELECT
     my_column
FROM
     My_Table
WHERE
     @my_string LIKE '%|' + my_column + '|%' 
```

.

```
/*
    Name:       GetTableFromStringList
    Description:    Returns a table of values extracted from a delimited list
    Parameters:
            @StringList - A delimited list of strings
            @Delimiter - The delimiter used in the delimited list

    History:
    Date        Name            Comments
    ----------  -------------   ----------------------------------------------------
    2008-12-03  T. Hummel   Initial Creation
*/
CREATE FUNCTION dbo.GetTableFromStringList
(
    @StringList VARCHAR(1000),
    @Delimiter  CHAR(1) = ','
)
RETURNS @Results TABLE
(
    String  VARCHAR(1000)   NOT NULL
)
AS
BEGIN
    DECLARE
        @string     VARCHAR(1000),
        @position   SMALLINT

    SET @StringList = LTRIM(RTRIM(@StringList)) + @Delimiter
    SET @position = CHARINDEX(@Delimiter, @StringList)

    WHILE (@position > 0)
    BEGIN
        SET @string = LTRIM(RTRIM(LEFT(@StringList, @position - 1)))

        IF (@string <> '')
        BEGIN
            INSERT INTO @Results (String) VALUES (@string)
        END

        SET @StringList = RIGHT(@StringList, LEN(@StringList) - @position)
        SET @position = CHARINDEX(@Delimiter, @StringList, 1)
    END

    RETURN
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T20:10:33.803

> 我已经考虑过使用 instring 来确定所选过滤器值中是否存在行值，但这很容易出现部分匹配（例如 Car 匹配 Carpet）

在我看来，您没有包含唯一 ID，或者可能没有将主键作为列表框中值的一部分。理想情况下，每个选项都有一个唯一标识符，该标识符与您正在搜索的表中的列相匹配。如果您的列表框如下所示，那么您将能够专门针对汽车进行过滤，因为您将获得唯一值 3。

```
<option value="3">Car</option>
<option value="4">Carpret</option> 
```

然后，您只需构建一个 where 子句，该子句将允许您找到所需的值。

* * *

更新，回答评论。

> 考虑到用户可以从列表框中选择任意数量的选项，我将如何进行相关连接？SELECT * FROM tblTable 加入 tblOptions ON tblTable.FK = ? 这里的问题是我需要加入多个值。

[我在这里](https://stackoverflow.com/questions/327274/mysql-prepared-statements-with-a-variable-size-variable-list#327384)回答了一个类似的问题。

一种方法是构建一个临时表并将每个选定的选项作为一行添加到临时表中。然后，您只需连接到您的临时表。

如果你想简单地动态创建你的 sql，你可以做这样的事情。

```
SELECT * FROM tblTable WHERE option IN (selected_option_1, selected_option_2, selected_option_n) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T21:32:02.517

我发现一个 CLR 表值函数接受你的分隔字符串并在字符串上调用 Split（将数组作为 IEnumerable 返回）比用 T-SQL 编写的任何东西都更高效（当你有它时它开始崩溃分隔列表中有 100 万个项目，但这比 T-SQL 解决方案要远得多）。

然后，您可以加入表或检查 EXISTS。

# sharepoint - 面向开发人员的生产环境中的 SharePoint 权限级别

> ID：414147
> 
> 赞同：3
> 
> 时间：2009-01-05T19:09:04.020
> 
> 标签：sharepoint, permissions, moss, sharepoint-2007

我们正在尝试清理我们的 SharePoint (MOSS 2007) 环境。

截至目前，我们的开发人员、系统管理员和内容管理员都对我们生产环境中的根站点（以及它下面的所有内容）拥有“完全访问”权限。我认为这是一种糟糕的做法，并且确信我们的内容管理员不需要任何比“设计”更大的权利，甚至可能是“贡献”权利。

我的问题是，**开发人员在生产 SharePoint 环境中应该拥有什么权限级别？**

我有点相信开发人员不应该比其他任何人在生产中拥有更高级别的访问权限。毕竟，他们不应该自己改变生产中的任何东西，对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T21:03:00.953

谈到 SharePoint 开发，Best Practice 说：让每个开发者都有自己的开发服务器。我相信开发人员也应该可以访问集成环境，但仅此而已。我认为开发人员不应该有任何访问生产环境的权限，尤其是他们自己的用户。正如 Øyvind Skaar 所说，如果需要任何访问权限，则应将其授予不同的用户帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T19:57:27.090

我的观点是正确的——开发人员应该拥有与普通用户相同的访问权限——他们不可能在生产中改变事情。在这一点上，他们也应该在测试环境中拥有“用户”访问权限，以确保他们的代码中没有任何需要提升权限的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T20:33:25.707

如果确实需要，拥有第二个具有更高权限的帐户通常是明智的。这样，开发人员/测试人员可以像其他人一样使用他们的普通帐户，但有时可能需要他们的第二个管理员帐户来阅读日志等。

# ablecommerce - Able Commerce POS 数据合并

> ID：414160
> 
> 赞同：3
> 
> 时间：2009-01-05T19:11:53.080
> 
> 标签：ablecommerce

我们正在构建一个 AbleCommerce 7 网络商店，并尝试将其与现有的销售点系统集成。产品库存将在实体商店和网上商店之间共享，因此我们需要定期更新每种产品的现有数量，以使 POS 和网上商店尽可能保持同步，以避免在任一位置过度销售产品. POS 系统确实有一个每小时运行一次的预定导出。

我的问题是，有没有人有过将数据与 Able Commerce 7 网络商店同步的经验，您对方法有什么建议吗？

以下是我们目前正在考虑的方法：

1.  从 POS 系统获取导出的产品数据并确定需要更新哪些产品。使用 AbleCommerce 调用驻留在服务器上的定制 Web 服务，以调用 AbleCommerce API 并适当地更新 Web 商店。
2.  Able Commerce 确实有一个数据端口实用程序，可以通过 Able Commerce XML 格式导入/导出网络商店数据。这将提供所有合并逻辑，但似乎没有办法以编程方式启动合并过程。他们的实用程序是一个已编译的 Windows 应用程序。没有我们知道的命令行界面。数据端口实用程序调用服务器上的 ASHX 处理程序。
3.  采用类似于上面 #1 的方法，但尝试使用数据端口 ASHX 处理程序来更新产品，而不是使用我们自己的自定义 Web 服务。目前没有我们知道的与 ASHX 处理程序接口的文档。

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:22:58.127

我已经用 POS 软件做到了这一点。这不是 AbleCommerce，但零售销售和 POS 软件足够通用（没有供应商愿意告诉潜在客户“你需要以不同的方式运营”）它可能会起作用。

销售 -> 库存

弄清楚如何利用数据端口获取近乎实时的销售信息。我将它提供给 Message-Queue-By-DBMS-Table 机制，该机制每 30 秒轮询和刷新一次以更新库存。这里有几个线程通过 dbms 表讨论 MQ。

库存 -> 销售

通常这里会有更多的松懈——否则你会遇到一些有趣的问题，比如 QC 检验失败、在途、收货时的数量验证等。但是不管它完成了，你将有一个机制来处理作为新的现有库存发生的事件变得可用。只需与第一个过程相反即可。QOH 更改事件会导致消息排队等待近实时轮询应用程序更新 POS。

我实际上在 MSSQL 中使用了一个队列表，其中有一列用于消息类型，而 XML 用于消息负载。

它最终比描述听起来更简单。如果您想离线获取信息，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T17:38:05.577

我们已经在 AbleCommerce 和 MAS 系统之间进行了设置。我们将产品输入 AbleCommerce 系统，然后创建一个流程，将 MAS 系统中的库存、价格和成本信息推送到 ProductVariants 表中。

我们遇到的一个问题是，在您对变体数据进行更改之前，ProductVariants 表中不存在任何记录。因此，我们必须编写一个存储过程来自动填充 ProductVariants 表，以便我们可以进行同步。

# bash - 如何从 bash 的目录中选择随机文件？

> ID：414164
> 
> 赞同：184
> 
> 时间：2009-01-05T19:15:35.193
> 
> 标签：bash, random

我有一个包含大约 2000 个文件的目录。如何`N`通过使用 bash 脚本或管道命令列表来随机选择文件样本？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-01-05T20:01:13.697

这是一个使用 GNU sort 的随机选项的脚本：

```
ls |sort -R |tail -$N |while read file; do
    # Something involving $file, or you can leave
    # off the while to just get the filenames
done 
```

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2013-09-04T14:59:38.457

您可以使用`shuf`（来自 GNU coreutils 包）。只需给它一个文件名列表并要求它从随机排列中返回第一行：

```
ls dirname | shuf -n 1
# probably faster and more flexible:
find dirname -type f | shuf -n 1
# etc.. 
```

调整该`-n, --head-count=COUNT`值以返回所需行数。例如，要返回 5 个随机文件名，您将使用：

```
find dirname -type f | shuf -n 5 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-07-01T18:08:49.860

以下是一些不解析输出的可能性，`ls`并且对于名称中带有空格和有趣符号的文件是 100% 安全的。所有这些都将使用随机文件列表填充一个数组`randf`。`printf '%s\n' "${randf[@]}"`如果需要，这个数组很容易打印。

*   这个可能会多次输出同一个文件，`N`需要提前知道。这里我选择了 N=42。

    ```
    a=( * )
    randf=( "${a[RANDOM%${#a[@]}]"{1..42}"}" ) 
    ```

    此功能没有很好的文档记录。

*   如果 N 事先不知道，但你真的很喜欢前面的可能性，你可以使用`eval`. 但它是邪恶的，你必须确保`N`它不是直接来自用户输入而没有经过彻底检查！

    ```
    N=42
    a=( * )
    eval randf=( \"\${a[RANDOM%\${#a[@]}]\"\{1..$N\}\"}\" ) 
    ```

    *我个人不喜欢`eval`，因此这个答案！*

*   同样使用更直接的方法（循环）：

    ```
    N=42
    a=( * )
    randf=()
    for((i=0;i<N;++i)); do
        randf+=( "${a[RANDOM%${#a[@]}]}" )
    done 
    ```

*   如果您不想拥有多次相同的文件：

    ```
    N=42
    a=( * )
    randf=()
    for((i=0;i<N && ${#a[@]};++i)); do
        ((j=RANDOM%${#a[@]}))
        randf+=( "${a[j]}" )
        a=( "${a[@]:0:j}" "${a[@]:j+1}" )
    done 
    ```

*注意*。[这是对旧帖子的较晚答案，但接受的答案链接到显示糟糕bash](/questions/tagged/bash "显示标记为“bash”的问题")实践的外部页面，而另一个答案也好不到哪里去，因为它也解析`ls`. 对已接受答案的评论指出了 Lhunath 的出色答案，这显然表明了良好的做法，但并没有完全回答 OP。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-09-15T07:55:05.060

```
ls | shuf -n 10 # ten random files 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-08-30T08:16:24.390

[在避免解析 ls](http://mywiki.wooledge.org/ParsingLs)的同时选择`5`随机文件的简单解决方案。它也适用于包含空格、换行符和其他特殊字符的文件：

```
shuf -ezn 5 * | xargs -0 -n1 echo 
```

替换`echo`为您要为文件执行的命令。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-08-01T23:49:58.407

这是对@gniourf_gniourf 迟到的答案的更晚回应，我只是赞成，因为它是迄今为止最好的答案，两次。（一次用于避免`eval`，一次用于安全文件名处理。）

但是我花了几分钟来解开这个答案使用的“没有很好记录”的功能。如果您的 Bash 技能足够扎实，可以立即看到它的工作原理，请跳过此评论。但我没有，解开它我认为值得解释。

**功能 #1**是 shell 自己的文件通配符。`a=(*)`创建一个数组 ，`$a`其成员是当前目录中的文件。Bash 了解文件名的所有奇怪之处，因此可以保证列表正确、保证转义等。无需担心正确解析`ls`.

**功能 #2**是[数组](http://wiki.bash-hackers.org/syntax/arrays)的 Bash[参数扩展](http://wiki.bash-hackers.org/syntax/pe)，一个嵌套在另一个中。这从 开始，扩展到 的长度。`${#ARRAY[@]}``$ARRAY`

然后使用该扩展为数组下标。找到介于 1 和 N 之间的随机数的标准方法是取随机数模 N 的值。我们想要一个介于 0 和数组长度之间的随机数。这是方法，为了清楚起见分为两行：

```
LENGTH=${#ARRAY[@]}
RANDOM=${a[RANDOM%$LENGTH]} 
```

但是这个解决方案在一行中完成，删除了不必要的变量分配。

**功能 #3**是[Bash 大括号扩展](http://wiki.bash-hackers.org/syntax/expansion/brace)，尽管我不得不承认我并不完全理解它。例如，大括号扩展用于生成 25 个名为`filename1.txt`,`filename2.txt`等的文件的列表：`echo "filename"{1..25}".txt"`.

上面的子shell 中的表达式`"${a[RANDOM%${#a[@]}]"{1..42}"}"`使用该技巧产生 42 个单独的扩展。`]`大括号扩展在和之间放置一个数字，`}`起初我认为它是数组的下标，但如果是这样，它前面会加上一个冒号。（它还会从数组中的一个随机点返回 42 个连续项，这与从数组中返回 42 个随机项完全不同。）我认为这只是让 shell 运行扩展 42 次，从而返回数组中的 42 个随机项。（但如果有人能更全面地解释它，我很想听听。）

N 必须硬编码（到 42）的原因是大括号扩展发生在变量扩展之前。

最后，如果您想为目录层次结构递归地执行此操作，这里是**Feature #4 ：**

```
shopt -s globstar
a=( ** ) 
```

这将打开一个导致递归匹配的[shell 选项。](https://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html)`**`现在您的`$a`数组包含整个层次结构中的每个文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-11-03T21:14:58.867

如果您安装了 Python（适用于 Python 2 或 Python 3）：

要选择一个文件（或任意命令中的行），请使用

```
ls -1 | python -c "import sys; import random; print(random.choice(sys.stdin.readlines()).rstrip())" 
```

要选择`N`文件/行，请使用（注意`N`在命令末尾，将其替换为数字）

```
ls -1 | python -c "import sys; import random; print(''.join(random.sample(sys.stdin.readlines(), int(sys.argv[1]))).rstrip())" N 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-28T12:45:12.490

如果您的文件夹中有更多文件，您可以使用我在 unix [stackexchange](https://unix.stackexchange.com/a/411400)中找到的以下管道命令。

```
find /some/dir/ -type f -print0 | xargs -0 shuf -e -n 8 -z | xargs -0 cp -vt /target/dir/ 
```

在这里我想复制文件，但如果你想移动文件或做其他事情，只需更改我使用的最后一个命令`cp`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-10-02T12:28:59.813

这是我可以在 MacOS 上很好地使用 bash 的唯一脚本。我结合并编辑了以下两个链接的片段：

[ls 命令：如何获得递归完整路径列表，每个文件一行？](https://stackoverflow.com/questions/1767384/ls-command-how-can-i-get-a-recursive-full-path-listing-one-line-per-file)

[http://www.linuxquestions.org/questions/linux-general-1/is-there-a-bash-command-for-picking-a-random-file-678687/](http://www.linuxquestions.org/questions/linux-general-1/is-there-a-bash-command-for-picking-a-random-file-678687/)

```
#!/bin/bash

# Reads a given directory and picks a random file.

# The directory you want to use. You could use "$1" instead if you
# wanted to parametrize it.
DIR="/path/to/"
# DIR="$1"

# Internal Field Separator set to newline, so file names with
# spaces do not break our script.
IFS='
'

if [[ -d "${DIR}" ]]
then
  # Runs ls on the given dir, and dumps the output into a matrix,
  # it uses the new lines character as a field delimiter, as explained above.
  #  file_matrix=($(ls -LR "${DIR}"))

  file_matrix=($(ls -R $DIR | awk '; /:$/&&f{s=$0;f=0}; /:$/&&!f{sub(/:$/,"");s=$0;f=1;next}; NF&&f{ print s"/"$0 }'))
  num_files=${#file_matrix[*]}

  # This is the command you want to run on a random file.
  # Change "ls -l" by anything you want, it's just an example.
  ls -l "${file_matrix[$((RANDOM%num_files))]}"
fi

exit 0 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-12-17T11:13:00.937

MacOS 没有*sort -R*和*shuf*命令，所以我需要一个仅 bash 的解决方案，它可以随机化所有文件**而不重复**，但在这里没有找到。此解决方案类似于 gniourf_gniourf 的解决方案 #4，但希望添加更好的评论。

脚本应该很容易修改，以便在使用带有 if 的计数器或带有 N 的 gniourf_gniourf 的 for 循环的 N 个样本后停止。$RANDOM 限制为 ~32000 个文件，但在大多数情况下应该这样做。

```
#!/bin/bash

array=(*)  # this is the array of files to shuffle
# echo ${array[@]}
for dummy in "${array[@]}"; do  # do loop length(array) times; once for each file
    length=${#array[@]}
    randomi=$(( $RANDOM % $length ))  # select a random index

    filename=${array[$randomi]}
    echo "Processing: '$filename'"  # do something with the file

    unset -v "array[$randomi]"  # set the element at index $randomi to NULL
    array=("${array[@]}")  # remove NULL elements introduced by unset; copy array
done 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-04-28T12:04:16.803

我使用这个：它使用临时文件，但深入到一个目录中，直到找到一个常规文件并返回它。

```
# find for a quasi-random file in a directory tree:

# directory to start search from:
ROOT="/";  

tmp=/tmp/mytempfile    
TARGET="$ROOT"
FILE=""; 
n=
r=
while [ -e "$TARGET" ]; do 
    TARGET="$(readlink -f "${TARGET}/$FILE")" ; 
    if [ -d "$TARGET" ]; then
      ls -1 "$TARGET" 2> /dev/null > $tmp || break;
      n=$(cat $tmp | wc -l); 
      if [ $n != 0 ]; then
        FILE=$(shuf -n 1 $tmp)
# or if you dont have/want to use shuf:
#       r=$(($RANDOM % $n)) ; 
#       FILE=$(tail -n +$(( $r + 1 ))  $tmp | head -n 1); 
      fi ; 
    else
      if [ -f "$TARGET"  ] ; then
        rm -f $tmp
        echo $TARGET
        break;
      else 
        # is not a regular file, restart:
        TARGET="$ROOT"
        FILE=""
      fi
    fi
done; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-03-04T00:13:08.853

如果要将这些文件的样本复制到另一个文件夹：

```
ls | shuf -n 100 | xargs -I % cp % ../samples/ 
```

显然首先制作示例目录。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-06-06T02:11:37.980

从康先生那里稍微修改一下 Perl 解决方案怎么样：
[如何在 Unix 命令行或 shell 脚本中打乱文本文件的行？](https://stackoverflow.com/questions/2153882/how-can-i-shuffle-the-lines-of-a-text-file-on-the-unix-command-line-or-in-a-shel)

> $ ls | perl -MList::Util=shuffle -e '@lines = shuffle(<>); 打印@lines[0..4]'

# javascript - 他们如何在以下网站上进行手风琴风格的下拉菜单？

> ID：414166
> 
> 赞同：3
> 
> 时间：2009-01-05T19:17:14.287
> 
> 标签：javascript, css

我正在查看[http://www.zenfolio.com/zf/features.aspx](http://www.zenfolio.com/zf/features.aspx)，当您单击橙色链接时，我无法弄清楚他们是如何进行手风琴风格展开和折叠的。我一直在为 firefox 使用 Web Developer Toolbar 插件，但我无法在页面源代码中找到任何可以执行以下操作的内容，例如 JavaScript。如果有人知道他们是如何做到的，那将非常有帮助。

这实际上是无关的，但如果你的答案都很好，我也给谁答案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T19:24:26.563

他们正在将内部 DIV 上的 .display CSS 属性从“无”设置为“”，从而呈现它。

这有点棘手，因为 JS 似乎就在这里：

[http://www.zenfolio.com/zf/script/en-US/mozilla5/windows/5AN2EHZJSZSGS/sitehome.js](http://www.zenfolio.com/zf/script/en-US/mozilla5/windows/5AN2EHZJSZSGS/sitehome.js)

但基本上每个人都是这样做的。它就在那里，某处。

编辑：在这里，它看起来像：

```
//... (bunch of junk)
 zf_Features.prototype._entry_onclick = function(e, index) 
{
    var cellNode = this.dom().getElementsByTagName("H3")[index].parentNode;
    while (cellNode.tagName != "TD") cellNode = cellNode.parentNode; 
    if (this._current != null) this.dom(this._current).className = "desc";
    if ("i" + index != this._current) 
    {
        cellNode.className = "desc open";
        cellNode.id = this.id + "-i" + index;
        this._current = "i" + index;
    } 
    else this._current = null;
    zf_frame.recalcLayout();
    return false;
}; 
```

基本上，他们正在做的是一种非常迂回和令人困惑的方式，将 TD 内部的 div 与“desc”类更改为“desc open”类，从而揭示其内容。所以这是一个非常笨拙的迂回方式来做每个人都做的同样的事情（即处理 onclick 以将隐藏的 div 的显示属性更改为非隐藏）。

编辑2：

大声笑，当我试图格式化它时，其他人也发现了它。=) 你比我快 ;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T19:28:50.800

它是用 JavaScript 完成的。

当您单击链接时，父 td 的类从“desc”更改为“desc open”。基本上，扩展文本总是存在但隐藏（显示：无；）。当它获得'open'的css类时，文本不再被隐藏（显示：块；）。

如果您查看 sitehome.js 和 sitehome.css 文件，您可以了解他们是如何做到的。

顺便说一句，我使用 FireBug 来获取该信息。尽管 Web Developer Toolbar 有一些功能重复，但还是值得安装的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T19:32:29.623

使用[jQuery可以](http://jquery.com/)[*很*容易地](http://docs.jquery.com/Effects/toggle)构建这个效果：

```
$('.titleToggle').click(function() {
    $(this).next().toggle();
}); 
```

如果您在加载页面时执行此代码，那么它将与如下所示的任何标记一起使用：

```
<span class="titleToggle">Show me</span>
<div style="display:none">This is hidden</div> 
```

请注意，此代码适用于任意数量的元素，因此即使对于包含这些项目的整个表格/列表，也*无需*以任何方式重复或调整 JavaScript 代码。标签名称（此处`span`和`div`）也无关紧要。使用最适合您的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T19:29:23.043

他们正在使用javascript。你也可以这样做：

```
<div id="feature">
    <a href="javascript:toggle();">Feature Name</a>

    <div id="desc" style=="display:none;">
     description here...
    </div>
</div>

<script type="text/javascript">
function toggle()
{
   var el=document.getElementById('desc');
   if (el.style.display=='none')
      el.style.display='block'; //show if currently hidden
   else
      el.style.display='none'; //Hide if currently displayed
}
</script> 
```

上面的函数可以使用[Jquery](http://jquery.com)编写，以便在显示/展开描述时平滑淡入/淡出动画。它还具有 SlideUp 和 Slidedown 效果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T19:24:50.247

他们的主 JS 包含很多混淆/缩小的 JS。看起来他们正在抓取 DOM 以寻找 H3 并检查具有类 desc 的表格单元格，然后处理 A 标记。（或其他顺序，可能），然后动态添加 onclick 处理程序。

```
if (this._current != null) this.dom(this._current).className
= "desc"; if ("i" + index != this._current) { cellNode.className = "desc open"; cellNode.id = this.id
+ "-i" + index; this._current = "i" + index; } 
```

[http://www.zenfolio.com/zf/script/en-US/safari3/windows/5AN2EHZJSZSGS/sitehome.js](http://www.zenfolio.com/zf/script/en-US/safari3/windows/5AN2EHZJSZSGS/sitehome.js)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T19:25:53.147

脚本在[这里](http://www.zenfolio.com/zf/script/en-US/mozilla5/windows/4RNFJHZJSZSGS/sitehome.js)。

相关部分似乎是（重新布局）：

```
// This script seems over-complicated... I wouldn't recommend it!

zf_Features.prototype._init = function()
{
    // Get a list of the H3 elements
    var nodeList = this.dom().getElementsByTagName("H3");

    // For each one... 
    for (var i = 0; i < nodeList.length; i++)
    {
        // ... set the onclick to be the function below
        var onclick = this.eventHandler(this._entry_onclick, i);

        // Get the first <a> within the H3 and do the same
        var node = nodeList[i].getElementsByTagName("A")[0];
        node.href = "#";
        node.onclick = onclick;

        // And again for the first <span>
        node = nodeList[i].getElementsByTagName("SPAN")[0];
        node.onclick = onclick;
    }
};

zf_Features.prototype._entry_onclick = function(e, index)
{
    // Get the parent node of the cell that was clicked on
    var cellNode = this.dom().getElementsByTagName("H3")[index].parentNode;

    // Keep going up the DOM tree until we find a <td>
    while (cellNode.tagName != "TD")
        cellNode = cellNode.parentNode;

    // Collapse the currently open section if there is one
    if (this._current != null)
        this.dom(this._current).className = "desc";

    if ("i" + index != this._current)
    {
        // Open the section we clicked on by changing its class
        cellNode.className = "desc open";
        cellNode.id = this.id + "-i" + index;

        // Record this as the current one so we can close it later
        this._current = "i" + index;
    }
    else
        this._current = null;

    // ???
    zf_frame.recalcLayout();

    return false;
}; 
```

编辑：添加了一些评论

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T19:32:23.710

不幸的是，他们的代码是内联的并且难以阅读（[http://www.zenfolio.com/zf/script/en-US/mozilla5/windows/5AN2EHZJSZSGS/sitehome.js](http://www.zenfolio.com/zf/script/en-US/mozilla5/windows/5AN2EHZJSZSGS/sitehome.js)），但这看起来很容易实现.. . 一些类似的东西（使用prototypejs）：

```
<script>
var showHide = {
    cachedExpandable: null
    ,init: function() {
        var containers = $$(".container"); 
        for(var i=0, clickable; i<containers.length; i++) {
            clickable = containers[i].getElementsByClassName("clickable")[0];
            Event.observe(clickable, "click", function(e) {
                Event.stop(e);
                showHide.doIt(containers[i]);
            });
        }
    }
    ,doIt: function(container) {
        if(this.cachedExpandable) this.cachedExpandable.hide();
        var expandable = container.getElementsByClassName("expandable")[0];
        if(expandable.style.display == "none") {
            expandable.show();
        } else {
            expandable.hide();
        }
        this.cachedExpandable = expandable;
    }

};

window.onload = function() {
    showHide.init();
};
</script>

<div class="container">
    <div class="clickable">
        Storage Space
    </div>
    <div class="expandable" style="display: none;">
        Description for storage space
    </div>
</div>

<div class="container">
    <div class="clickable">
        Galleries
    </div>
    <div class="expandable" style="display: none;">
        Description for galleries
    </div>
</div> 
```

它还缓存早期的可扩展元素，因此当您单击新元素时它会隐藏它。

# c#-3.0 - C# lambda 表达式和惰性求值

> ID：414176
> 
> 赞同：8
> 
> 时间：2009-01-05T19:18:39.727
> 
> 标签：c#-3.0, lambda, lazy-evaluation

lambda 表达式的一个优点是您必须仅在需要函数结果时才对函数求值。

在以下（简单）示例中，仅在编写者存在时才评估文本函数：

```
public static void PrintLine(Func<string> text, TextWriter writer)
{
    if (writer != null)
    {
        writer.WriteLine(text());
    }
} 
```

不幸的是，这使得使用代码有点难看。你不能用常量或变量来调用它

```
PrintLine("Some text", Console.Out); 
```

并且必须这样称呼它：

```
PrintLine(() => "Some text", Console.Out); 
```

编译器无法从传递的常量中“推断”出无参数函数。有没有计划在未来的 C# 版本中改进这一点，或者我错过了什么？

更新：

我自己发现了一个肮脏的黑客：

```
 public class F<T>
    {
       private readonly T value;
       private readonly Func<T> func;

       public F(T value) { this.value = value; }
       public F(Func<T> func) {this.func = func; }

       public static implicit operator F<T>(T value)
       {
            return new F<T>(value);
       }

       public static implicit operator F<T>(Func<T> func)
       {
           return new F<T>(func);
       }

       public T Eval()
       {
           return this.func != null ? this.func() : this.value;
       }
} 
```

现在我可以将函数定义为：

```
public static void PrintLine(F<string> text, TextWriter writer)
{
    if (writer != null)
    {
        writer.WriteLine(text.Eval());
    }
} 
```

并用函数或值调用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T20:19:00.807

我怀疑 C# 会得到这个特性，但[D](http://www.digitalmars.com/d/index.html)有。您所概述的是在 C# 中实现惰性参数评估的合适方法，并且可能与[`lazy`](http://www.digitalmars.com/d/2.0/lazy-evaluation.html)D 中的编译非常相似，并且使用更纯的函数式语言。

考虑到所有因素，四个额外的字符，加上可选的空格，对于正在成为一种多范式强类型语言的清晰的重载分辨率和表现力来说并不是一个特别大的代价。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T19:41:51.180

编译器非常擅长推断*类型*，但不擅长推断*意图*。C# 3 中所有新语法糖的一个棘手问题是，它们可能会导致编译器对它们究竟做了什么感到困惑。

考虑你的例子：

```
() => "SomeText" 
```

编译器看到这一点并理解您打算创建一个不带参数并返回 System.String 类型的匿名函数。这一切都是从你给它的 lambda 表达式推断出来的。实际上，您的 lambda 被编译为：

```
delegate {
    return "SomeText";
}; 
```

它是您发送`PrintLine`执行的这个匿名函数的委托。

它在过去一直很重要，但现在对于 LINQ、lambda、迭代器块、自动实现的属性等，使用[.NET Reflector](http://www.red-gate.com/products/reflector/)之类的工具在编译后查看代码至关重要看看是什么让这些功能真正起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-13T13:49:13.943

不幸的是，丑陋的语法是你在 C# 中所拥有的。

更新中的“肮脏黑客”不起作用，因为它不会延迟对字符串参数的评估：它们在传递给`operator F<T>(T value)`.

比较`PrintLine(() => string.Join(", ", names), myWriter)`在`PrintLine(string.Join(", ", names), myWriter)`第一种情况下，字符串仅在打印时才被连接；在第二种情况下，无论如何都会连接字符串：只有打印是有条件的。换句话说，评估一点也不懒惰。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T19:22:46.023

那么这两种说法是完全不同的。一个是定义函数，另一个是语句。混淆语法会更棘手。

```
() => "SomeText" //this is a function

"SomeText" //this is a string 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T19:23:02.480

您可以使用重载：-

```
public static void PrintLine(string text, TextWriter writer)
{
    PrintLine(() => text, writer);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T19:23:19.517

您可以在 String 上编写一个扩展方法以将其粘贴。您应该能够编写“Some text”.PrintLine(Console.Out); 并让它为您完成工作。

奇怪的是，几周前我对 lambda 表达式进行了一些惰性求值，并[在此处发表了博客](http://www.atalasoft.com/cs/blogs/stevehawley/archive/2008/12/17/being-lazy.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-19T17:43:24.490

老实说，我并不完全理解你的问题，但你的解决方案对我来说似乎有点复杂。

我认为我使用 lambda 调用解决的一个问题是类似的，也许你可以以此为灵感：我想看看字典中是否存在一个键，如果不存在，我需要执行一个（昂贵的）加载操作。

```
public static class DictionaryHelper
{
    public static TValue GetValueOrLambdaDefault<TKey, TValue> (this IDictionary<TKey, TValue> dictionary, TKey key, Func<TValue> func)
    {
        if (dictionary.ContainsKey(key))
            return dictionary[key];
        else
            return func.Invoke();
    }
}

[TestClass]
public class DictionaryHelperTest
{
    [TestMethod]
    public void GetValueOrLambdaDefaultTest()
    {
        var dict = new Dictionary<int, string>();
        try
        {
            var res1 = dict.GetValueOrLambdaDefault(1, () => LoadObject());
            Assert.Fail("Exception should be thrown");
        }
        catch { /*Exception should be thrown*/ }

        dict.Add(1, "");
        try
        {
            var res1 = dict.GetValueOrLambdaDefault(1, () => LoadObject());
        }
        catch { Assert.Fail("Exception should not be thrown"); }
    }

    public static string LoadObject()
    {
        throw new Exception();
    }
} 
```

# pdf - pdflatex的相对优点是什么？

> ID：414179
> 
> 赞同：28
> 
> 时间：2009-01-05T19:20:12.783
> 
> 标签：pdf, latex, tex, pdflatex

不确定这是一个编程问题，但我们所有的 API 文档和用户文档都使用 LaTeX，所以我希望它能通过。

`pdflatex`有人可以解释一下与“经典”技术相比，使用的相对优点是什么

```
latex foo
dvips -Ppdf foo
ps2pdf foo.ps 
```

有时我会遇到一些人因为事情不起作用而遇到困难`pdflatex`，而且我知道使用`pdflatex`会放弃我已经成长为重视的两件事：

*   无法使用非常快速的`xdvi`查看器
*   无法使用 PStricks 包

我应该补充一点，我通常使用以下顺序获取带有超链接的 PDF

```
\usepackage[ps2pdf,colorlinks=true]{hyperref} 
```

所以没有必要使用`pdflatex`来获得好的PDF。

所以

1.  `pdflatex`我不知道的优点是什么？
2.  我忽略的旧工具的缺点是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-05T19:43:59.380

我最喜欢的 pdflatex 功能是[microtype 包](http://www.ctan.org/tex-archive/macros/latex/contrib/microtype/)，它只有在使用 pdflatex 直接转至 PDF 时才可用，并且我毫不费力地真正产生了惊人的结果。除此之外，我遇到的唯一警告是图像格式：

*   pdflatex 支持 PDF、PNG 和 JPG 图像。
*   后记驱动程序支持（至少）EPS。

此外，如果您想安装字体，则根据驱动程序支持的字体，过程会略有不同。（提示：使用[XeTeX](http://scripts.sil.org/xetex)立即启用 OpenType 字体。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-16T22:59:39.920

事实证明，我最近阅读了一篇直接显示差异的[帖子。](http://texblog.net/latex-archive/layout/pdflatex-microtype/)任何使用表格或窄列的文档都将自动得到改进。我还发现单词间距更令人愉悦`pdflatex`。

比`xdvi`快得多？`xpdf`我发现编辑、、`TeX`查看周期非常快`pdflatex`。

您是否尝试过 MetaPost 或 MetaFun 的图形？我倾向于将图形创建交给有能力的人，但 MetaFun 可能是我会使用的包。只是阅读[手册](http://www.pragma-ade.com/general/manuals/mchart.pdf)是一种享受。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T22:37:29.380

pdftex 也是正在开发（面向 luatex）和维护的引擎。我不确定 DVI 对应物是否得到积极维护。

PStricks 被 Tikz 取代。

我已经好几年没用 xdvi 了，所以请原谅那些流氓式的反问：xdvi 是否显示矢量字体？它是否支持synctex（跳转到代码和从代码跳转）？它是否具有使用像 Skim 这样的 PDF 阅读器的舒适性？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-12T13:33:46.730

Taco Hoekwater 正在开发[Escrito](http://escrito.luatex.org/)，这是一个用 Lua 编写的 Postscript 解释器，它允许你在 Luatex 中使用 pstricks。他有一个令人印象深刻的项目完成记录：也许我应该在上一句中使用“will”而不是“would”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T11:17:00.380

我使用 pdflatex 为我的 ICFP 2009 论文生成 PDF。（我仍然需要使用标准乳胶来生成 PostScript 文件。）我这样做有两个原因：

1.  无论我使用什么命令行选项，我似乎都无法让 ps2pdf 生成 Letter，而不是 A4 输出。

2.  对于打印机，我需要生成 1.3 版的 PDF 文件，而不是 1.4 版。pdflatex 使这很容易做到。我在使用时设置了 PDF 作者和标题信息。

这两个问题都可以通过某种方式解决，但作为第一次使用 Latex 的用户，我没有找到任何明显的解决方案，我询问过的更有经验的用户也没有。

# java - Eclipse 插件中是否包含 Apache Ant Javadocs？

> ID：414180
> 
> 赞同：2
> 
> 时间：2009-01-05T19:20:13.780
> 
> 标签：java, eclipse, ant, javadoc

我试图将 Ant 库添加到 Eclipse 中的项目中，并且我使用了属于 Eclipse 插件文件夹的那些库。当我尝试将它们与 Javadocs 相关联时，我无法在插件文件夹中找到它们。我在网上搜索了它们，发现[了这个页面](http://ant.apache.org/manual/api/index.html)，他们说这些文档不是在线提供的，因为它们是每个发行版的一部分。那么我在哪里可以找到捆绑在 Eclipse 中的发行版中的文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T19:47:55.067

ant javadocs 可能包含也可能不包含在 Eclipse 中，这取决于您拥有的版本。 **编辑：无论如何，最好不要依赖与 IDE 捆绑的版本。** 否则，从事该项目的每个人都必须使用相同版本的 IDE，而 Eclipse 自动更新可能会破坏您的项目。

*   下载[ant二进制发行版](http://ant.apache.org/bindownload.cgi)和[ant源码发行版](http://ant.apache.org/srcdownload.cgi)
*   从您的项目中取出 eclipse ant 发行版并将其替换为二进制 jar（从 zip 中提取）。
*   在 eclipse java build path 窗口中，将源 zip 附加到二进制 jar 中。（单击加号，双击“源附件”并选择源 zip。如果需要，您将能够查看源，并且 javadoc 将出现在适当的视图中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T20:08:05.087

我不完全同意[Motlin 的回答](https://stackoverflow.com/questions/414180/are-apache-ant-javadocs-included-in-the-eclipse-plugin#414262)：
描述的过程是正确的（“将源 zip 附加到二进制 jars”），除了**所有 ant 组件的源代码都随 eclipse 分发提供**。

如果 ant 是 eclipse 的插件， in`[eclipsePath]\eclipse\plugin\org.apache.ant_1.7.1`中`[eclipsePath]\eclipse\plugin`还包含**org.apache.ant.source_1.7.1.jar**，其中包括所有源代码。

* * *

我确认`[eclipsePath]\eclipse\plugin\org.apache.ant_1.7.1`存在，但仅在 Eclipse 的 SDK 发行版中，其中包含以下来源：

*   SDK eclipse（或“经典 eclipse”）
*   造型
*   用于插件开发的 RCP。

此[表总结了包含源的 Eclipse 发行版](http://www.eclipse.org/downloads/packages/compare-packages)。

因此，如果您无法访问任何其他 ant 独立交付，您可以使用此 eclipse 发行版之一进行编程*并*在其中找到完整的 ant 发行版。

但是，正如[Motlin](https://stackoverflow.com/questions/414180/are-apache-ant-javadocs-included-in-the-eclipse-plugin#414262)所指出的，这不是最安全的考虑途径。

# exception - 何时对域类中的异常使用断言

> ID：414182
> 
> 赞同：3
> 
> 时间：2009-01-05T19:20:24.980
> 
> 标签：exception, exception-handling, error-handling

在任何情况下，您会在域类中使用断言而不是异常处理...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T19:44:37.617

使用异常进行参数验证和其他检查，以验证您的类的用户是否按预期使用它们。

使用断言进行内部一致性检查，即表明*你*搞砸了，而不是你班级的用户。

因此，如果您的类的用户看到断言失败，他们知道这（可能）是您的代码中的内部错误，而不是他们使用您的代码的错误。另一方面，如果获取参数验证异常，他们知道这是他们的错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T19:34:28.167

绝不。断言不是错误处理的有效形式。使用它们来帮助识别测试期间的程序错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T21:29:55.593

断言反映了一种不应该发生且未预料到的状态，其中应用程序由于某种原因无法继续执行，而异常表示一种不被认为是“正常”但并非意外的状态，并且从该状态有可能恢复。

举个例子，如果我在堆上分配空间，而这个分配失败，那么我就不能继续工作，所以我断言返回的地址是有效的；在它无效的地方，断言失败，程序也随之失败。

另一方面，如果我打开一个文件进行读取，但它不存在，那么可能会从这种情况中恢复，在这种情况下会抛出异常（并尽可能地捕获和处理）。

通常，断言在调试阶段最有用，而异常被认为是常规程序流程和错误处理的一部分。普遍的共识是，应该在生产代码中禁用断言（以保护用户免受明显的崩溃），而我读过一个学派认为这是适得其反的，并且用户应该看到断言失败，以便他们可以正确报告问题。

就个人而言，我有时将这两种技术结合起来；通常，如果我发现了一个我认为不会被抛出的异常。以上面的例子为例，如果我在尝试打开文件之前检查文件是否存在，那么我不希望抛出异常，如果是，那么我倾向于通过在相关的 catch 块中提出断言来处理这个问题。我发现这在 Java 中是一种特别有用的技术，在这种技术中，此类异常得到了全面检查。

# latex - 使用 \verbatim 作为宏参数的一部分？

> ID：414191
> 
> 赞同：5
> 
> 时间：2009-01-05T19:24:07.300
> 
> 标签：latex

我想在 LaTeX 中做的大多数事情要么是直截了当的，要么是在网上很容易找到的，但这件事一直困扰着我。

我有一个宏“解决方案”：对每个解决方案应用一些通用格式：

```
\newcommand\solution[1]{{\\ \\* \bf Solution.}#1\qed \newpage} 
```

到目前为止效果很好，但现在我想包含一张我使用“ASCII Art”快速完成的绘图，所以我想使用 \verbatim。但它不起作用，它会产生以下错误：

> ```
> Runaway argument?
> ...
> ! File ended while scanning use of \@xverbatim. 
> ```

从我在“LaTeX 的不那么简短的介绍”中读到的内容，\verbatim 不能以这种方式使用。我认为有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T20:29:23.937

这是一个[常见问题解答](http://www.tex.ac.uk/cgi-bin/texfaq2html?label=verbwithin)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T22:28:38.027

您可以尝试更改`\newcommand`为`\newenvironment`然后使用类似的东西

```
\begin{solution}
  \begin{verbatim}
    [ascii art here]
  \end{verbatim}
\end{solution} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-30T20:00:59.117

使用包 cprotect

例如（使用 tcolorbox，但它与大多数创建的新命令一起使用）

```
\usepackage{tcolorbox}
\usepackage{cprotect}

\newcommand{\tcb}[1] {
 \begin{tcolorbox}   [arc=0mm,colback=bginf,coltitle=black!70!black,colframe=black!30!white,width=\linewidth,fontupper=\bfseries\small,halign title=flush center,halign upper=center]
#1
\end{tcolorbox}
}

\cprotect\tcb{\scriptsize
     \begin{verbatim}
...
     \end{verbatim}
} 
```

# language-agnostic - 实时服务器中的致命错误

> ID：414199
> 
> 赞同：1
> 
> 时间：2009-01-05T19:26:58.043
> 
> 标签：language-agnostic, error-handling, client-server

我正在编写一些客户端/服务器软件，并且面临以下设计问题。通常，我非常随意地使用 VERIFY 宏 - 如果用户的机器出现问题，我希望软件失败并记录错误以便修复。我从不喜欢忽略任何类型的错误。

但是，我现在正在编写一个服务器。如果服务器死了，很多客户端就会宕机，所以服务器应该尽可能少地死掉。因此，我不知道如何处理一些我认为是致命异常的情况。

例如，我从一个没有登录的用户那里得到一个网络数据包。即使它不应该发生，我有足够的经验知道“不可能”的错误确实会不时发生。所以我很确定如果我在这些情况下犯了致命错误，服务器最终会崩溃。另一方面，我可以记录并忽略错误并继续，但我担心一些错误可能会以这种方式未被检测到。

在这种情况下你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T19:33:54.050

如果您可以从错误中恢复，那么显然它不是致命的。如果您可以记录错误并继续执行，我看不到失败的好处 - 最重要的是您已经在日志中捕获了错误。如果您能恢复并继续正常运作，那是最好的课程。

您还应该实施一个通知系统（[服务器监控](http://en.wikipedia.org/wiki/Internet_Server_Monitoring)），该系统会根据错误级别以不同程度的紧急程度通知您，以便您尽快处理时间紧迫的事情。有类似服务器的通用系统，例如[Nagios](http://www.nagios.org/)和[Munin](http://munin.projects.linpro.no/)。您应该看看他们做了什么，看看您是否可以从他们那里获取一些东西并将其实施/集成到您的系统中。

无论如何，您应该尽量确保客户端实例尽可能沙盒化。关闭的客户端线程不应该关闭整个服务器 - 永远（至少在理论上）。

# .net - Best practices re sharing IDbConnection or connection string/factory in your .Net code

> ID：414207
> 
> 赞同：18
> 
> 时间：2009-01-05T19:29:01.500
> 
> 标签：.net, database, connection-string

I'm wondering what would be the best prectice regarding mainataining connections to the database in .Net application (ADO.NET but I guess the practice should be the same for any data layer). Should I create a database connection and propagate it throughout my application, or would it be better to just pass connection strings/factories and create a connection ad-hoc, when it is needed.

As I understand perfomance hit is not signifcant with pooling and it allows me to recover from broken connections quite easily (just a new connection will be created) but then again a connection object is a nice, relatively high-level abstraction and creating a new connection for every operation (not SQL command, but application operation) generates additional, duplicated code and feels like a waste of time/resources(?).

What do you think about these 2 cases, what are their cons/pros and which approach are you using in your real-life applications?

Thanks

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-05T20:07:42.047

I found myself needing to pass around a connection object so I could allow several business objects to save themselves to the database inside a single transaction.

If each business object had to create its own SQLConnection to the database, the transaction would escalate to a distributed transaction and I wanted to avoid that.

I did not like having to pass the SQLConnection object as a parameter to save an object, so I created a ConnectionManager that handles creating the SQLConnection object for me, tracking the use of the SQLConnection object, and disconnecting the SQLConnection object when not in use.

Here is some code as an example of the ConnectionManager:

```
public class ConnectionManager: IDisposable
{
    private ConnectionManager instance;

    [ThreadStatic]
    private static object lockObject; 
    private static Object LockObject
    {
        get
        {
            if (lockObject == null)
                lockObject = new object();
            return lockObject;
        }
    }

    [ThreadStatic]
    private static Dictionary<string, ConnectionManager> managers;
    private static Dictionary<string, ConnectionManager> Managers
    {
        get
        {
            if (managers == null)
                managers = new Dictionary<string, ConnectionManager>();
            return managers;
        }
    }

    private SqlConnection connection = null;
    private int referenceCount;
    private string name;

    public static ConnectionManager GetManager(string connectionName)
    {
        lock (LockObject)
        {
            ConnectionManager mgr;
            if (Managers.ContainsKey(connectionName))
            {
                mgr = Managers[connectionName];
            }
            else
            {
                mgr = new ConnectionManager(connectionName);
                Managers.Add(connectionName, mgr);
            }

            mgr.AddRef();
            return mgr;
        }
    }

    private ConnectionManager(string connectionName)
    {
        name = connectionName;
        connection = new SqlConnection(GetConnectionString(connectionName));
        connection.Open();
    }

    private string GetConnectionString(string connectionName)
    {
        string conString = Configuration.ConnectionString;
        return conString; 
    }

    public SqlConnection Connection
    {
        get { return connection; }
    }

    private void AddRef()
    {
        referenceCount += 1;
    }

    private void DeRef()
    {
        lock (LockObject)
        {
            referenceCount -= 1;
            if (referenceCount == 0)
            {
                connection.Dispose();
                Managers.Remove(name);
            }
        }
    }

#region IDisposable Members

    public void Dispose()
    {
        Dispose(true);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
        {
            DeRef();
        }
    }

    ~ConnectionManager()
    {
        Dispose(false);
    }

#endregion

} 
```

Here is how I would use it from a business object:

```
public void Save()
{   
    using (ConnectionManager mrg = ConnectionManager.GetManager("SQLConnectionString")
    {
        using (SQLCommand cmd = new SQLCommand)
        {
            cmd.connection = mgr.Connection
            // More ADO Code Here
        }

        _childObject.Save(); //this child object follows the same pattern with a using ConnectionManager.
    }
} 
```

I save a business object and all of its children are saved as well using the same connection object. When the scope falls away from original parent, the using statement closes the connection.

This is a pattern I learned from Rocky Lhotka in his CSLA framework.

Keith

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T19:32:21.947

ADO.NET SQL Server provider does the connection pooling itself. You can control the pool size by `MinPoolSize` and `MaxPoolSize` in the connection string.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T19:32:55.457

You really shouldn't be handling this problem yourself, as there are countless tools out there that can do it for you.

If you really want to do it yourself, then look into the [Unit of Work](http://martinfowler.com/eaaCatalog/unitOfWork.html) pattern where you can manage connection/transaction lifecycle. You certainly don't want to try to navigate the messy waters where there are connections being opened/closed in different places.

If you decide to let your components directly open db connections then it is likely that the connection lifecycle will be too fine-grained and result in many open/closed connections for a single user operation.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-22T17:27:15.170

One thing to be wary of in your example is that ASP.NET apps should not use ThreadStatic storage, as a thread can be re-used, and if you do not clean up all your objects you end up with a connection hanging around.

In an ASP.NET app I'd use the HttpContext.Items collection instead. You are implementing IDisposable, but I've seen scenarios where devs forget to call Dispose or place the code in a using block.

# powershell - exchange powershell：解析数组布尔值

> ID：414210
> 
> 赞同：0
> 
> 时间：2009-01-05T19:30:39.843
> 
> 标签：powershell, exchange-server, exchange-server-2007

在我的输出中，我得到

@{ActiveSyncEnabled=假}

我如何解析它，使它只说“假”？

输出来自这行代码：

```
 $pda = get-casmailbox -Anr $user.displayname | select activesyncenabled 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T21:35:07.987

要直接访问该值：

(get-casmailbox -Anr $user.displayname).activesyncenabled

您可以跳过 anr 并使用身份成员：

获取 CASMailbox $user.Identity

要获取所有启用了 activesyncenabled 的邮箱：

get-casmailbox -resultSize 无限制 -filter {activesyncenabled -eq $true}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T20:12:36.310

我现在无权访问交换箱，但信息现在应该存在给可以访问的人。这是有效的：

$pda = get-casmailbox -Anr $user.displayname | 选择 activesyncenabled $pda.ActiveSyncEnabled | 写主机

# .net - .NET Shell 控件库

> ID：414215
> 
> 赞同：1
> 
> 时间：2009-01-05T19:32:14.443
> 
> 标签：.net, controls

寻找提供外壳功能的优质 .NET 控件库，例如文件夹树、项目列表、右键单击、文件上下文菜单和 OLE 拖放。

**更新：（**我问别人这个）特别想提供可能来自许多位置的“文件”列表（搜索结果）。然后让探索者喜欢这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T19:52:10.237

LogicNPSoftware 的 ShellMegaPack

[http://www.ssware.com/megapack.htm](http://www.ssware.com/megapack.htm) 我以前使用过它们，它们为您提供了实现 Windows 资源管理器功能所需的一切。也非常可定制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-09T23:15:05.723

您看过[龚解决方案外壳库](http://gong-shell.sourceforge.net/index.php)吗？

它是开源的 (GPL)，因此您应该能够以您认为合适的方式对其进行扩展。

# sql - 在两列之间选择最近的日期

> ID：414222
> 
> 赞同：34
> 
> 时间：2009-01-05T19:33:00.277
> 
> 标签：sql, database, sql-server-2005

如果我有一个表（在其他列中）有两个 DATETIME 列，我将如何从这两个列中选择**最近的日期。**

例子：

```
ID     Date1     Date2

1      1/1/2008   2/1/2008

2      2/1/2008   1/1/2008

3      1/10/2008  1/10/2008 
```

如果我希望我的结果看起来像

```
ID     MostRecentDate

1      2/1/2008

2      2/1/2008

3      1/10/2008 
```

有没有一种我显然忽略的简单方法？我知道我可以做子查询和 case 语句，甚至可以在 sql server 中编写一个函数来处理它，但我脑子里有一个 max-compare 类型的函数已经内置，我只是忘记了。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-05T19:36:17.243

案例是恕我直言您的最佳选择：

```
SELECT ID,
       CASE WHEN Date1 > Date2 THEN Date1
            ELSE Date2
       END AS MostRecentDate
FROM Table 
```

* * *

如果其中一列可以为空，则只需包含在[`COALESCE`](https://docs.microsoft.com/en-us/sql/t-sql/language-elements/coalesce-transact-sql)：

```
.. COALESCE(Date1, '1/1/1973') > COALESCE(Date2, '1/1/1973') 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-09-05T20:40:38.977

从**SQL Server 2012**开始，可以使用表达式的快捷方式[`IIF`](https://docs.microsoft.com/en-us/sql/t-sql/functions/logical-functions-iif-transact-sql)，`CASE`尽管后者是 SQL 标准：

```
SELECT ID,
       IIF(DateColA > DateColB, DateColA, DateColB) AS MostRecentDate
  FROM theTable 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-05T19:36:30.393

```
select ID, 
case
when Date1 > Date2 then Date1
else Date2
end as MostRecentDate
from MyTable 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-05T19:41:21.587

您可以将其放入标量函数中，这使得处理空值更容易一些。显然它不会比内联 case 语句快。

```
ALTER FUNCTION [fnGetMaxDateTime] (
    @dtDate1        DATETIME,
    @dtDate2        DATETIME
) RETURNS DATETIME AS
BEGIN
    DECLARE @dtReturn DATETIME;

    -- If either are NULL, then return NULL as cannot be determined.
    IF (@dtDate1 IS NULL) OR (@dtDate2 IS NULL)
        SET @dtReturn = NULL;

    IF (@dtDate1 > @dtDate2)
        SET @dtReturn = @dtDate1;
    ELSE
        SET @dtReturn = @dtDate2;

    RETURN @dtReturn;
END 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-05-06T19:44:49.390

我认为公认的答案是最简单的。但是，我会注意日期中的空值......

```
SELECT ID,
       CASE WHEN ISNULL(Date1,'01-01-1753') > ISNULL(Date2,'01-01-1753') THEN Date1
            ELSE Date2
       END AS MostRecentDate
FROM Table 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-05T19:36:26.073

除了案例陈述，我不相信...

```
 Select Case When DateColA > DateColB Then DateColA 
              Else DateColB End MostRecent
  From Table ... 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-05T20:08:49.563

尽可能使用内联函数，因为它们不会遇到通常与 UDF 相关的性能问题......

```
Create FUNCTION MaximumDate 
(   
@DateTime1 DateTime,
@DateTime2 DateTime
)
RETURNS TABLE 
AS
RETURN 
(
    Select Case When @DateTime1 > @DateTime2 Then @DateTime1
                Else @DateTime2 End MaxDate
)
GO 
```

有关使用指南，请参阅 [此处](http://www.sqlmag.com/Article/ArticleID/101104/sql_server_101104.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-05T20:11:32.647

AFAIK，没有内置函数可以获取两个值的最大值，但您可以轻松编写自己的函数：

```
CREATE FUNCTION dbo.GetMaximumDate(@date1 DATETIME, @date2 DATETIME)
RETURNS DATETIME
AS
BEGIN
    IF (@date1 > @date2)
        RETURN @date1
    RETURN @date2
END 
```

并将其称为

```
SELECT Id, dbo.GetMaximumDate(Date1, Date2)
FROM tableName 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-11-28T16:54:26.340

为什么不能使用 GREATEST 功能？

```
select id, date1, date2, GREATEST( nvl(date1,date2) , nvl(date2, date1) )
from table1; 
```

我包含了一个 NVL 以确保正确评估 NULL，否则如果 Date1 或 Date2 为 null，则 Greatest 返回 NULL。

```
ID  Date1       Date2       MostRecentDate
1   1/1/2008    2/1/2008    2/1/2008
2   2/1/2008    1/1/2008    2/1/2008
3   1/10/2008   1/10/2008   1/10/2008
4   -null-      2/10/2008   2/10/2008
5   2/10/2008   -null-      2/10/2008 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-13T03:15:58.987

已发布的所有其他正确答案。

但是，如果您仍然真的在寻找 MAX 关键字，那么这里有一种方法：

```
select ID , MAX(dt) from 
(  select Id , Date1 as dt from table1
   union  
   select ID , Date2 from table2
) d
group by d.Id 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-12T18:06:23.120

[这个线程](https://stackoverflow.com/questions/71022/sql-max-of-multiple-columns)有几个解决方案。如果您有超过 2 个日期要比较，“unpivot”可能比编写一系列案例陈述更可取。以下是从[Niikola](https://stackoverflow.com/users/130904/niikola)公然窃取的：

```
select id, max(dDate) MostRecentDate
  from YourTable
    unpivot (dDate for nDate in (Date1, Date2, Date3)) as u
  group by id 
```

然后你可以`order by dDate`，如果这有帮助的话。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-23T09:20:33.347

```
select max(d) ChangeDate
from (values(@d), (@d2)) as t(d) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-12-25T09:17:32.483

```
select ID,(select max(d) from (select Date1 d uninon select Date2 d) as t) as MaxDate
from MyTable 
```

# visual-studio - Visual Studio 解决方案 - 如何确保共享项目属性？

> ID：414224
> 
> 赞同：5
> 
> 时间：2009-01-05T19:33:17.013
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, projects-and-solutions

如果您使用 Visual Studio 2008 并且解决方案中有许多项目文件，您如何使它们保持同步？换句话说，如果你在一个项目中更改了一个属性，你如何确保这个属性在其他项目中自动更改？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-09T14:57:58.247

鉴于有足够多的贡献者对嵌套解决方案的概念感到困惑，我将假设您的意思是“具有多个项目的解决方案”。您可以使用项目属性表为它们提供通用设置。从 View + Other Windows + Property Manager 开始。打开其中一个节点，右键单击配置并选择添加新的。选择对解决方案有意义的位置，例如解决方案目录。以您想要的方式配置设置。

对解决方案中的所有其他项目重复此过程，现在使用添加现有项目。每个项目都将继承您在工作表中配置的设置，除非它明确覆盖它们。您可能必须返回项目属性并将覆盖更改回“继承”。

IDE 对项目属性表的支持有点不稳定，请务必在进行更改时明确保存它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T09:04:51.073

我不得不说，我还没有听说过“嵌套解决方案”，而且我需要一个非常有说服力的理由来做这种事情。特别是考虑到您的问题实际上集中在“我如何保持重复？” 既然您说解决方案将共享属性。这是编程中的一条基本规则“不要复制你自己”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T06:14:30.937

您可以将所需的选项放入编译器响应文件中，并在每个 .vcproj 文件中使用相同的响应文件。

见这里： http: [//msdn.microsoft.com/en-us/library/3te4xt0y (VS.71).aspx](http://msdn.microsoft.com/en-us/library/3te4xt0y(VS.71).aspx)

基本上，您创建一个像 SharedOptions.rsp 这样的文本文件，并在文件的每一行上指定一个不同的命令行编译器选项。像 /I.\include 或 /DDEFINE 或其他什么。

然后在每个项目的 c++ 命令行属性页中，将其添加到附加选项框中：@"SharedOptions.rsp"。

然后，当您编辑文本文件中的选项时，它们将被所有项目拾取。nobugz 提供的属性管理器解决方案可能只是一个 gui - 我不知道，我更像是一个命令行人。

我猜你在过去的 2 个月里已经对此做了一些事情，但这个答案更适合谷歌人......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T22:29:59.740

我最终使用了 Visual Studio 中可用的全局变量。这些是 $ProjectName 之类的变量。VS 中已经有很多可用的，它们也可以是用户定义的。

# c# - 有什么方法可以从浏览器内部保存 PDF？

> ID：414225
> 
> 赞同：2
> 
> 时间：2009-01-05T19:33:45.860
> 
> 标签：c#, pdf

我有一个可以通过 UNC \mypath\myfile 访问的文件。我用 c# 检索路径并将其分配给链接。浏览器在自身内部打开文件（即在浏览器中显示）没有问题。但是，当我尝试保存到 \mypath\myfile 时，系统会提示我将其保存在本地。如果我在浏览器 (IE 7) 之外查看文件，我可以再次通过 UNC 按预期进行编辑和保存。

我试图做的是使用 iframe 显示来自我的 UNC (file:///\mypath\myfile) 的文件，这确实有效，但现在我无法编辑它。在浏览器之外我可以。

在浏览器中显示 PDF 时是否有保存 PDF 的方法？我还尝试了一个按钮来使用 pdf 上的保存方法，但它不起作用。

谢谢你。

我正在使用 IE 7 和 Adob​​e Professional 7.1.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T19:36:19.067

当您通过 Web 浏览器打开文件时，Web 浏览器会在本地下载文件，然后将本地文件路径发送到打开它的应用程序。即使您在 href 中使用 UNC，Adobe 也没有获得该 UNC 路径来保存，它正在获得一个本地机器路径。请记住，即使 UNC 是本地机器路径，浏览器也会做同样的事情。

我不认为你想要的行为是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T19:52:06.650

```
<body>
    <div style="height:80px">
        <p><a href="downloadpdf.aspx" target="_blank">Save</a>
    </div>
    <div>
         <iframe width="100%" height="100%" src="pdfname.pdf" />
    </div>
</body> 
```

在downloadpdf.aspx的页面加载事件中，添加：

```
Response.AddHeader("content-disposition","attachment; filename=pdfname.pdf")
Response.ContentType = "application/pdf"
Server.Transfer("pdfname.pdf") 
```

未经测试，但应该给你一个想法......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T22:46:19.263

在浏览器中保存 PDF（通过 IE 中的文件-另存为等）或在 Adob​​e 系统中保存副本将始终提示您将其保存在本地。您可以手动导航到您的 UNC 路径，但这是浏览器行为，而不是服务器行为。

# python - python“'NoneType'对象没有属性'encode'”

> ID：414230
> 
> 赞同：6
> 
> 时间：2009-01-05T19:35:09.163
> 
> 标签：python, urlencode

我编写了这个小小的 Python 片段，它可以抓取提要并将其打印出来。当我运行代码时，提要中的某些内容会触发您在此处看到的错误消息作为我的问题。这是错误时的完整控制台输出：

```
> Traceback (most recent call last):  
> File "/home/vijay/ffour/ffour5.py",
> line 20, in <module>
>     myfeed()   File "/home/vijay/ffour/ffour5.py", line
> 15, in myfeed
>     sys.stdout.write(entry["title"]).encode('utf-8')
> AttributeError: 'NoneType' object has
> no attribute 'encode' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T19:39:27.657

> ```
> > sys.stdout.write(entry["title"]).encode('utf-8') 
> ```

这是罪魁祸首。你可能的意思是：

```
sys.stdout.write(entry["title"].encode('utf-8')) 
```

（注意最后一个右括号的位置。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T19:50:07.450

让我们尝试清除异常消息中的一些混淆。

函数调用

```
sys.stdout.write(entry["title"]) 
```

返回无。“.encode('utf-8')”是对上述函数返回内容的编码函数的调用。

问题是 None 没有编码函数（或编码属性），因此您会收到一个属性错误，该错误命名您尝试获取属性的类型和您尝试获取的属性。

# java - 控制台应用程序中的 Java 键盘输入解析

> ID：414237
> 
> 赞同：9
> 
> 时间：2009-01-05T19:38:40.967
> 
> 标签：java, keyboard, jline

我刚刚开始使用[JLine](http://jline.sourceforge.net/)来解析控制台模式下的字符输入。它似乎运作良好，但我想知道：

JLine 中是否有一种非阻塞方式来确定字符是否可用？（即像[`kbhit()`](http://msdn.microsoft.com/en-us/library/58w7c94c(VS.80).aspx)在 Windows 中一样。）

我想我总是可以将键盘输入包装在它自己的线程中，然后将线程安全队列中的键盘字符提供给主线程，但这似乎是不必要的。

**编辑**：这是逐个字符的解析。我不会使用 GUI。Java 中控制台模式下通常的 InputStream I/O 要求您先按 Enter 键（例如，它只是缓冲输入）。请不要告诉我在控制台模式下逐个字符输入在 Java 中是不可能的；不是。JLine 使用具有平台相关实现的可移植接口来实现。

**编辑更新**：我能够组合一个帮助类来在工作线程中执行阻塞 I/O（使用 JLine 进行每个字符的 I/O，警告：您必须自己解析 Ctrl-C！）然后进行通信通过带有 isempty() 例程的同步队列。对于我现在正在做的事情，这很好，但我真的很想知道在未来做这件事的好方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T20:25:13.423

你似乎走在正确的轨道上。

我认为做到这一点的“正确”方法是一个工作线程，它将所有阻塞 I/O 倒入一个非阻塞队列中。看看[java.util.concurrent 中](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)的[ConcurrentLinkedQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T19:48:36.063

如果没有本机库，您将无法使用控制台获取非阻塞输入。

您必须编写一个 Swing 应用程序并编写一个[KeyListener](http://java.sun.com/javase/6/docs/api/java/awt/event/KeyListener.html)

阅读本教程：http: [//java.sun.com/docs/books/tutorial/uiswing/events/keylistener.html](http://java.sun.com/docs/books/tutorial/uiswing/events/keylistener.html)

# c++ - C++ 中的惰性求值

> ID：414243
> 
> 赞同：75
> 
> 时间：2009-01-05T19:40:19.340
> 
> 标签：c++, lazy-evaluation

C++ 没有对惰性求值的本机支持（就像 Haskell 一样）。

我想知道是否有可能以合理的方式在 C++ 中实现惰性求值。如果是，你会怎么做？

编辑：我喜欢康拉德鲁道夫的回答。

我想知道是否有可能以更通用的方式实现它，例如通过使用参数化类lazy，它基本上适用于T，就像matrix_add 适用于矩阵一样。

对 T 的任何操作都会返回惰性。唯一的问题是将参数和操作代码存储在惰性本身中。谁能看到如何改善这一点？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-01-05T19:47:42.227

> 我想知道是否有可能以合理的方式在 C++ 中实现惰性求值。如果是，你会怎么做？

是的，这是可能的并且经常这样做，例如用于矩阵计算。促进这一点的主要机制是运算符重载。考虑矩阵加法的情况。函数的签名通常如下所示：

```
matrix operator +(matrix const& a, matrix const& b); 
```

现在，为了让这个函数变得懒惰，返回一个代理而不是实际结果就足够了：

```
struct matrix_add;

matrix_add operator +(matrix const& a, matrix const& b) {
    return matrix_add(a, b);
} 
```

现在需要做的就是编写这个代理：

```
struct matrix_add {
    matrix_add(matrix const& a, matrix const& b) : a(a), b(b) { }

    operator matrix() const {
        matrix result;
        // Do the addition.
        return result;
    }
private:
    matrix const& a, b;
}; 
```

神奇之处在于`operator matrix()`隐式转换运算符 from`matrix_add`到 plain的方法`matrix`。这样，您可以链接多个操作（当然通过提供适当的重载）。仅当将最终结果分配给`matrix`实例时才会进行评估。

**编辑**我应该更明确。实际上，代码没有意义，因为尽管评估是延迟发生的，但它仍然发生在同一个表达式中。特别是，除非`matrix_add`更改结构以允许链式添加，否则另一个添加将评估此代码。C++0x 通过允许可变参数模板（即可变长度的模板列表）极大地促进了这一点。

然而，一个非常简单的例子是，这段代码实际上会产生真正的直接好处：

```
int value = (A + B)(2, 3); 
```

在这里，假设`A`和`B`是二维矩阵，并且取消引用是用 Fortran 表示法完成的，即上面从矩阵和中计算*一个*元素。添加整个矩阵当然是浪费的。`matrix_add`救援：

```
struct matrix_add {
    // … yadda, yadda, yadda …

    int operator ()(unsigned int x, unsigned int y) {
        // Calculate *just one* element:
        return a(x, y) + b(x, y);
    }
}; 
```

其他例子比比皆是。我只记得不久前我实现了一些相关的东西。基本上，我必须实现一个字符串类，它应该遵守一个固定的、预定义的接口。但是，我的特定字符串类处理实际上并未存储在内存中的巨大字符串。通常，用户只需使用函数访问原始字符串中的小子字符串`infix`。我为我的字符串类型重载了这个函数，以返回一个包含对我的字符串的引用的代理，以及所需的开始和结束位置。只有当这个子字符串被实际使用时，它才会查询 C API 来检索字符串的这一部分。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-08T06:55:16.483

Boost.Lambda 非常好，但[Boost.Proto](http://boost-sandbox.sourceforge.net/libs/proto/doc/html/index.html)正是您正在寻找的*。*它已经拥有*所有*C++ 运算符的重载，默认情况下，它们在`proto::eval()`被调用时执行它们的常用功能，但可以更改。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-01-05T20:37:06.183

Konrad 已经解释过的内容可以进一步支持运算符的嵌套调用，所有这些都是惰性执行的。在 Konrad 的示例中，他有一个表达式对象，可以恰好存储两个参数，用于一个操作的两个操作数。问题是它只会懒惰地执行*一个*子表达式，这很好地解释了懒惰评估中的概念，简单地说，但并没有显着提高性能。另一个示例也很好地展示了如何`operator()`使用该表达式对象仅添加一些元素。但是要评估任意复杂的表达式，我们也需要一些可以*存储*其结构的机制。我们无法绕过模板来做到这一点。它的名字是`expression templates`. 这个想法是一个模板化的表达式对象可以递归地存储一些任意子表达式的结构，就像一棵树，其中操作是节点，操作数是子节点。对于我今天刚刚找到的一个*很好*的解释（在我编写以下代码几天后），请参见[此处](https://web.archive.org/web/20090421155750/http://ubiety.uwaterloo.ca/~tveldhui/papers/Expression-Templates/exprtmpl.html)。

```
template<typename Lhs, typename Rhs>
struct AddOp {
    Lhs const& lhs;
    Rhs const& rhs;

    AddOp(Lhs const& lhs, Rhs const& rhs):lhs(lhs), rhs(rhs) {
        // empty body
    }

    Lhs const& get_lhs() const { return lhs; }
    Rhs const& get_rhs() const { return rhs; }
}; 
```

这将存储任何加法运算，甚至是嵌套的，如以下简单点类型的 operator+ 定义所示：

```
struct Point { int x, y; };

// add expression template with point at the right
template<typename Lhs, typename Rhs> AddOp<AddOp<Lhs, Rhs>, Point> 
operator+(AddOp<Lhs, Rhs> const& lhs, Point const& p) {
    return AddOp<AddOp<Lhs, Rhs>, Point>(lhs, p);
} 

// add expression template with point at the left
template<typename Lhs, typename Rhs> AddOp< Point, AddOp<Lhs, Rhs> > 
operator+(Point const& p, AddOp<Lhs, Rhs> const& rhs) {
    return AddOp< Point, AddOp<Lhs, Rhs> >(p, rhs);
}

// add two points, yield a expression template    
AddOp< Point, Point > 
operator+(Point const& lhs, Point const& rhs) {
    return AddOp<Point, Point>(lhs, rhs);
} 
```

现在，如果你有

```
Point p1 = { 1, 2 }, p2 = { 3, 4 }, p3 = { 5, 6 };
p1 + (p2 + p3); // returns AddOp< Point, AddOp<Point, Point> > 
```

您现在只需要重载 operator= 并为 Point 类型添加合适的构造函数并接受 AddOp。将其定义更改为：

```
struct Point { 
    int x, y; 

    Point(int x = 0, int y = 0):x(x), y(y) { }

    template<typename Lhs, typename Rhs>
    Point(AddOp<Lhs, Rhs> const& op) {
        x = op.get_x();
        y = op.get_y();
    }

    template<typename Lhs, typename Rhs>
    Point& operator=(AddOp<Lhs, Rhs> const& op) {
        x = op.get_x();
        y = op.get_y();
        return *this;
    }

    int get_x() const { return x; }
    int get_y() const { return y; }
}; 
```

并将适当的 get_x 和 get_y 作为成员函数添加到 AddOp 中：

```
int get_x() const {
    return lhs.get_x() + rhs.get_x();
}

int get_y() const {
    return lhs.get_y() + rhs.get_y();
} 
```

注意我们没有创建任何 Point 类型的临时对象。它可能是一个包含许多领域的大矩阵。但是在需要结果的时候，我们就*懒惰地*计算了。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-05T21:14:23.583

我对 Konrad 的帖子没有什么要补充的，但是您可以查看[Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page) ，了解在现实世界的应用程序中正确完成惰性评估的示例。这是相当令人敬畏的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-07-18T10:19:50.777

我正在考虑实现一个模板类，它使用`std::function`. 这个类或多或少应该是这样的：

```
template <typename Value>
class Lazy
{
public:
    Lazy(std::function<Value()> function) : _function(function), _evaluated(false) {}

    Value &operator*()  { Evaluate(); return  _value; }
    Value *operator->() { Evaluate(); return &_value; }

private:
    void Evaluate()
    {
        if (!_evaluated)
        {
            _value = _function();
            _evaluated = true;
        }
    }

    std::function<Value()> _function;
    Value _value;
    bool _evaluated;
}; 
```

例如用法：

```
class Noisy
{
public:
    Noisy(int i = 0) : _i(i)
    {
        std::cout << "Noisy(" << _i << ")"  << std::endl;
    }
    Noisy(const Noisy &that) : _i(that._i)
    {
        std::cout << "Noisy(const Noisy &)" << std::endl;
    }
    ~Noisy()
    {
        std::cout << "~Noisy(" << _i << ")" << std::endl;
    }

    void MakeNoise()
    {
        std::cout << "MakeNoise(" << _i << ")" << std::endl;
    }
private:
    int _i;
};  

int main()
{
    Lazy<Noisy> n = [] () { return Noisy(10); };

    std::cout << "about to make noise" << std::endl;

    n->MakeNoise();
    (*n).MakeNoise();
    auto &nn = *n;
    nn.MakeNoise();
} 
```

上面的代码应该在控制台上产生以下消息：

```
Noisy(0)
about to make noise
Noisy(10)
~Noisy(10)
MakeNoise(10)
MakeNoise(10)
MakeNoise(10)
~Noisy(10) 
```

请注意，在`Noisy(10)`访问变量之前不会调用构造函数打印。

不过，这门课远非完美。第一件事是`Value`必须在成员初始化时调用的默认构造函数（`Noisy(0)`在这种情况下是打印）。我们可以使用指针来`_value`代替，但我不确定它是否会影响性能。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-12-08T07:56:22.143

约翰内斯的回答有效。但是当涉及到更多括号时，它并不如愿。这是一个例子。

```
Point p1 = { 1, 2 }, p2 = { 3, 4 }, p3 = { 5, 6 }, p4 = { 7, 8 };
(p1 + p2) + (p3+p4)// it works ,but not lazy enough 
```

因为三个重载的 + 运算符没有覆盖案例

```
AddOp<Llhs,Lrhs>+AddOp<Rlhs,Rrhs> 
```

所以编译器必须将 (p1+p2) 或 (p3+p4) 转换为 Point ，这还不够懒惰。当编译器决定转换哪个时，它会抱怨。因为没有一个比另一个更好。这是我的扩展：添加另一个重载运算符 +

```
 template <typename LLhs, typename LRhs, typename RLhs, typename RRhs>
AddOp<AddOp<LLhs, LRhs>, AddOp<RLhs, RRhs>> operator+(const AddOp<LLhs, LRhs> & leftOperandconst, const AddOp<RLhs, RRhs> & rightOperand)
{
    return  AddOp<AddOp<LLhs, LRhs>, AddOp<RLhs, RRhs>>(leftOperandconst, rightOperand);

} 
```

现在，编译器可以正确处理上述情况，并且没有隐式转换，volia！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-05T19:42:40.507

正如它将在[C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)中通过 lambda 表达式完成的那样。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-05T19:43:47.557

一切皆有可能。

这取决于你的意思：

```
class X
{
     public: static X& getObjectA()
     {
          static X instanceA;

          return instanceA;
     }
}; 
```

在这里，我们有一个全局变量的影响，该变量在首次使用时被延迟评估。

正如问题中新要求的那样。
并窃取 Konrad Rudolph 的设计并对其进行扩展。

懒惰的对象：

```
template<typename O,typename T1,typename T2>
struct Lazy
{
    Lazy(T1 const& l,T2 const& r)
        :lhs(l),rhs(r) {}

    typedef typename O::Result  Result;
    operator Result() const
    {
        O   op;
        return op(lhs,rhs);
    }
    private:
        T1 const&   lhs;
        T2 const&   rhs;
}; 
```

如何使用它：

```
namespace M
{
    class Matrix
    {
    };
    struct MatrixAdd
    {
        typedef Matrix  Result;
        Result operator()(Matrix const& lhs,Matrix const& rhs) const
        {
            Result  r;
            return r;
        }
    };
    struct MatrixSub
    {
        typedef Matrix  Result;
        Result operator()(Matrix const& lhs,Matrix const& rhs) const
        {
            Result  r;
            return r;
        }
    };
    template<typename T1,typename T2>
    Lazy<MatrixAdd,T1,T2> operator+(T1 const& lhs,T2 const& rhs)
    {
        return Lazy<MatrixAdd,T1,T2>(lhs,rhs);
    }
    template<typename T1,typename T2>
    Lazy<MatrixSub,T1,T2> operator-(T1 const& lhs,T2 const& rhs)
    {
        return Lazy<MatrixSub,T1,T2>(lhs,rhs);
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-12-01T20:33:44.993

在 C++11 中，类似于 hiapay 的答案的惰性评估可以使用 std::shared_future 来实现。您仍然必须将计算封装在 lambda 中，但要注意记忆：

```
std::shared_future<int> a = std::async(std::launch::deferred, [](){ return 1+1; }); 
```

这是一个完整的例子：

```
#include <iostream>
#include <future>

#define LAZY(EXPR, ...) std::async(std::launch::deferred, [__VA_ARGS__](){ std::cout << "evaluating "#EXPR << std::endl; return EXPR; })

int main() {
    std::shared_future<int> f1 = LAZY(8);
    std::shared_future<int> f2 = LAZY(2);
    std::shared_future<int> f3 = LAZY(f1.get() * f2.get(), f1, f2);

    std::cout << "f3 = " << f3.get() << std::endl;
    std::cout << "f2 = " << f2.get() << std::endl;
    std::cout << "f1 = " << f1.get() << std::endl;
    return 0;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-05T20:36:16.810

C++0x 很不错……但是对于我们这些活在当下的人来说，你有 Boost lambda 库和 Boost Phoenix。两者都是为了将​​大量函数式编程引入 C++。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-09-21T16:46:34.217

让我们以 Haskell 为灵感——它从本质上来说是懒惰的。另外，让我们记住 C# 中的 Linq 如何以单子（呃 - 这里是单词 - 抱歉）的方式使用枚举器。最后同样重要的是，让我们记住，协程应该为程序员提供什么。即计算步骤（例如生产者消费者）彼此解耦。让我们试着想想协程如何与惰性求值相关联。

以上所有似乎都在某种程度上相关。

接下来，让我们尝试提取我们对“懒惰”归结为什么的个人定义。

一种解释是：我们希望在执行*之前*以可组合的方式声明我们的计算。我们用来组成完整解决方案的部分部分可能很好地利用了巨大的（有时是无限的）数据源，而我们的完整计算也可以产生有限或无限的结果。

让我们具体一些代码。我们需要一个例子！在这里，我选择 fizzbuzz“问题”作为示例，只是因为它有一些不错的、懒惰的解决方案。

在 Haskell 中，它看起来像这样：

```
module FizzBuzz
( fb
)
where
fb n =
    fmap merge fizzBuzzAndNumbers
    where
        fizz = cycle ["","","fizz"]
        buzz = cycle ["","","","","buzz"]
        fizzBuzz = zipWith (++) fizz buzz
        fizzBuzzAndNumbers = zip [1..n] fizzBuzz
        merge (x,s) = if length s == 0 then show x else s 
```

Haskell 函数`cycle`通过简单地永远重复有限列表中的值来从有限列表创建一个无限列表（当然是懒惰的！）。在急切的编程风格中，编写类似的东西会敲响警钟（内存溢出，无限循环！）。但在懒惰的语言中并非如此。诀窍是，惰性列表不会立即计算。也许永远不会。通常只有后续代码需要它。

上面块中的第三行`where`创建了另一个懒惰！列表，通过组合无限列表`fizz`和`buzz`单个两个元素配方“将来自任一输入列表的字符串元素连接成单个字符串”。同样，如果要立即对此进行评估，我们将不得不等待我们的计算机耗尽资源。

`[1..n]`在第 4 行，我们使用无限惰性列表创建有限惰性列表成员的元组`fizzbuzz`。结果还是懒惰。

即使在我们函数的主体中`fb`，也不需要急于求成。整个函数返回一个包含解决方案的列表，它本身又是惰性的。您也可以将 的结果`fb 50`视为您可以（部分）稍后评估的计算。或者与其他东西结合，导致更大的（懒惰的）评估。

因此，为了开始使用我们的 C++ 版本的“fizzbuzz”，我们需要考虑如何将计算的部分步骤组合成更大的计算位，每个计算都根据需要从前面的步骤中提取数据。

[您可以在我的要点中](https://gist.github.com/ruffianeo/b95e7ebfaa1e5ce09c2e55943e6201c9)看到完整的故事。

这里是代码背后的基本思想：

借用 C# 和 Linq，我们“发明”了一个有状态的泛型类型`Enumerator`，它持有
- 部分计算的当前值 - 部分计算
的状态（因此我们可以产生后续值）
- 工作函数，它产生下一个状态，下一个值和一个布尔值，它说明是否有更多数据或枚举是否已经结束。

为了能够`Enumerator<T,S>`通过（点）的力量组成实例`.`，这个类还包含从 Haskell 类型类中借用的函数，例如`Functor`和`Applicative`。

枚举器的工作函数始终采用以下形式：`S -> std::tuple<bool,S,T`其中`S`是表示状态`T`的泛型类型变量，而 是表示值的泛型类型变量 - 计算步骤的结果。

`Enumerator`所有这些在类定义的第一行中已经可见。

```
template <class T, class S>
class Enumerator
{
public:
    typedef typename S State_t;
    typedef typename T Value_t;
    typedef std::function<
        std::tuple<bool, State_t, Value_t>
        (const State_t&
            )
    > Worker_t;

    Enumerator(Worker_t worker, State_t s0)
        : m_worker(worker)
        , m_state(s0)
        , m_value{}
    {
    }
    // ...
}; 
```

所以，我们只需要创建一个特定的枚举器实例，我们需要创建一个工作函数，拥有初始状态并`Enumerator`使用这两个参数创建一个实例。

这里有一个例子 - 函数`range(first,last)`创建一个有限范围的值。这对应于 Haskell 世界中的惰性列表。

```
template <class T>
Enumerator<T, T> range(const T& first, const T& last)
{
    auto finiteRange =
        [first, last](const T& state)
    {
        T v = state;
        T s1 = (state < last) ? (state + 1) : state;
        bool active = state != s1;
        return std::make_tuple(active, s1, v);
    };
    return Enumerator<T,T>(finiteRange, first);
} 
```

我们可以利用这个函数，例如：`auto r1 = range(size_t{1},10);`- 我们创建了一个包含 10 个元素的惰性列表！

现在，我们“哇”的体验所缺少的就是看看我们如何组成枚举器。回到 Haskells`cycle`函数，这很酷。它在我们的 C++ 世界中会是什么样子？这里是：

```
template <class T, class S>
auto
cycle
( Enumerator<T, S> values
) -> Enumerator<T, S>
{
    auto eternally =
        [values](const S& state) -> std::tuple<bool, S, T>
    {
        auto[active, s1, v] = values.step(state);
        if (active)
        {
            return std::make_tuple(active, s1, v);
        }
        else
        {
            return std::make_tuple(true, values.state(), v);
        }
    };
    return Enumerator<T, S>(eternally, values.state());
} 
```

它接受一个枚举器作为输入并返回一个枚举器。本地（lambda）函数`eternally`只要输入枚举值用完就会简单地将输入枚举重置为其起始值，瞧——我们有一个无限的、不断重复的列表版本作为参数::`auto foo = cycle(range(size_t{1},3));`我们已经可以无耻地组成我们的懒惰“计算”。

`zip`是一个很好的例子，表明我们也可以从两个输入枚举器中创建一个新的枚举器。生成的枚举器产生的值与输入枚举器中的较小者一样多（具有 2 个元素的元组，每个输入枚举器一个）。我已经`zip`在内部实现`class Enumerator`了。这是它的样子：

```
// member function of class Enumerator<S,T> 
template <class T1, class S1>
auto
zip
( Enumerator<T1, S1> other
) -> Enumerator<std::tuple<T, T1>, std::tuple<S, S1> >
{
    auto worker0 = this->m_worker;
    auto worker1 = other.worker();
    auto combine =
        [worker0,worker1](std::tuple<S, S1> state) ->
        std::tuple<bool, std::tuple<S, S1>, std::tuple<T, T1> >
    {
        auto[s0, s1] = state;
        auto[active0, newS0, v0] = worker0(s0);
        auto[active1, newS1, v1] = worker1(s1);
        return std::make_tuple
            ( active0 && active1
            , std::make_tuple(newS0, newS1)
            , std::make_tuple(v0, v1)
            );
    };
    return Enumerator<std::tuple<T, T1>, std::tuple<S, S1> >
        ( combine
        , std::make_tuple(m_state, other.state())
        );
} 
```

请注意，“组合”最终如何结合两个源的状态和两个源的值。

因为这篇文章已经是 TL；DR；对于许多人来说，这里...

**概括**

是的，惰性求值可以在 C++ 中实现。在这里，我借用了 haskell 的函数名和 C# 枚举器和 Linq 的范例。顺便说一句，pythons itertools 可能有相似之处。我认为他们采用了类似的方法。

我的实现（见上面的要点链接）只是一个原型 - 不是生产代码，顺便说一句。所以我这边没有任何保证。不过，它可以很好地用作演示代码，以了解总体思路。

如果没有最终的 C++ 版本的 fizzbuz，这个答案会是什么，嗯？这里是：

```
std::string fizzbuzz(size_t n)
{
    typedef std::vector<std::string> SVec;
    // merge (x,s) = if length s == 0 then show x else s
    auto merge =
        [](const std::tuple<size_t, std::string> & value)
        -> std::string
    {
        auto[x, s] = value;
        if (s.length() > 0) return s; 
        else return std::to_string(x);
    };

    SVec fizzes{ "","","fizz" };
    SVec buzzes{ "","","","","buzz" };

    return
    range(size_t{ 1 }, n)
    .zip
        ( cycle(iterRange(fizzes.cbegin(), fizzes.cend()))
          .zipWith
            ( std::function(concatStrings)
            , cycle(iterRange(buzzes.cbegin(), buzzes.cend()))
            )
        )
    .map<std::string>(merge)
    .statefulFold<std::ostringstream&>
    (
        [](std::ostringstream& oss, const std::string& s) 
        {
            if (0 == oss.tellp())
            {
                oss << s;
            }
            else
            {
                oss << "," << s;
            }
        }
        , std::ostringstream()
    )
    .str();
} 
```

并且......为了进一步推动这一点 - 这里是 fizzbuzz 的一个变体，它向调用者返回一个“无限列表”：

```
typedef std::vector<std::string> SVec;
static const SVec fizzes{ "","","fizz" };
static const SVec buzzes{ "","","","","buzz" };

auto fizzbuzzInfinite() -> decltype(auto)
{
    // merge (x,s) = if length s == 0 then show x else s
    auto merge =
        [](const std::tuple<size_t, std::string> & value)
        -> std::string
    {
        auto[x, s] = value;
        if (s.length() > 0) return s;
        else return std::to_string(x);
    };

    auto result =
        range(size_t{ 1 })
        .zip
        (cycle(iterRange(fizzes.cbegin(), fizzes.cend()))
            .zipWith
            (std::function(concatStrings)
                , cycle(iterRange(buzzes.cbegin(), buzzes.cend()))
            )
        )
        .map<std::string>(merge)
        ;
    return result;
} 
```

值得展示，因为您可以从中学习如何回避该函数的确切返回类型是什么的问题（因为它仅取决于函数的实现，即代码如何组合枚举器）。

它还表明我们必须将向量移动到`fizzes`函数`buzzes`范围之外，以便它们最终在外部时仍然存在，惰性机制产生值。如果我们没有这样做，`iterRange(..)`代码会将迭代器存储到早已不复存在的向量中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-21T16:32:51.153

使用惰性评估的一个非常简单的定义，即在需要时才评估值，我想说可以通过使用指针和宏（用于语法糖）来实现这一点。

```
#include <stdatomic.h>

#define lazy(var_type) lazy_ ## var_type

#define def_lazy_type( var_type ) \
    typedef _Atomic var_type _atomic_ ## var_type; \
    typedef _atomic_ ## var_type * lazy(var_type);  //pointer to atomic type

#define def_lazy_variable(var_type, var_name ) \
    _atomic_ ## var_type _ ## var_name; \
    lazy_ ## var_type var_name = & _ ## var_name;

#define assign_lazy( var_name, val ) atomic_store( & _ ## var_name, val )
#define eval_lazy(var_name) atomic_load( &(*var_name) )

#include <stdio.h>

def_lazy_type(int)

void print_power2 ( lazy(int) i )
{
      printf( "%d\n", eval_lazy(i) * eval_lazy(i) );
}

typedef struct {
    int a;
} simple;

def_lazy_type(simple)

void print_simple ( lazy(simple) s )
{
    simple temp = eval_lazy(s);
    printf("%d\n", temp.a );
}

#define def_lazy_array1( var_type, nElements, var_name ) \
    _atomic_ ## var_type  _ ## var_name [ nElements ]; \
    lazy(var_type) var_name = _ ## var_name; 

int main ( )
{
    //declarations
    def_lazy_variable( int, X )
    def_lazy_variable( simple, Y)
    def_lazy_array1(int,10,Z)
    simple new_simple;

    //first the lazy int
    assign_lazy(X,111);
    print_power2(X);

    //second the lazy struct
    new_simple.a = 555;
    assign_lazy(Y,new_simple);
    print_simple ( Y );

    //third the array of lazy ints
    for(int i=0; i < 10; i++)
    {
        assign_lazy( Z[i], i );
    }

    for(int i=0; i < 10; i++)
    {
        int r = eval_lazy( &Z[i] ); //must pass with &
        printf("%d\n", r );
    }

    return 0;
} 
```

您会注意到在函数`print_power2`中调用了一个宏`eval_lazy`，它只是取消引用指针以在实际需要之前获取值。惰性类型是原子访问的，因此它是完全线程安全的。

# design-patterns - 为什么将装饰器设计模式命名为“装饰器”？

> ID：414251
> 
> 赞同：2
> 
> 时间：2009-01-05T19:43:53.657
> 
> 标签：design-patterns, terminology, decorator

任何人都可以解释为什么选择“装饰器”这个名称来表示装饰器设计模式所传达的功能吗？

我一直觉得这个名字很有误导性，因为装饰器和标记界面的用途听起来与我非常相似。然而，虽然标记并没有真正“做任何事情”，但装饰器确实可以。但对我来说，装饰一词意味着被动，而这种用于添加功能的模式并非如此。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T19:49:09.010

我相信该术语的起源来自使用不同组件（例如滚动条、关闭按钮等）装饰用户界面的示例使用。

**编辑：**参考 Steven John Metsker 在“C# 中的设计模式”中的第 308 页：

> DECORATOR 的原始应用之一（大概也是 DECORATOR 得名的应用）在于 GUI 组件的构造。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T19:53:48.597

我认为类比是，当你装饰房子时，你并没有真正打破任何墙壁或类似的东西，你只是在周围放置一些东西（随心所欲），以改变它的外观（及其功能） . 我认为选择这个词是为了暗示非侵入性，也是可选的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T19:48:43.880

装饰器通过向现有方法添加额外功能来“装饰”接口，但实际上并未添加任何自己的功能。装饰对于基本功能来说不是必不可少的；否则它将被内置到基类中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T19:48:00.823

因为您正在向现有对象添加新功能。本质上，您是在用新功能“装饰”对象。

嘿，留给极客来编名吧。

# exception - 哪种合同（按合同设计）更好？

> ID：414264
> 
> 赞同：8
> 
> 时间：2009-01-05T19:48:03.397
> 
> 标签：exception, exception-handling, error-handling

假设我有一个方法

```
public Patient(int id)
{
    ----
} 
```

返回给定 id 的 Patient 对象。我可以通过 2 种方式定义合同

1.  如果患者不存在，方法将返回 null
2.  如果患者不存在，方法将抛出异常。在这种情况下，我还将定义一个查询方法，如果患者存在于数据库中则返回 true，否则返回 false...

我应该使用哪个合约？还有其他建议吗？

更新：请也对此案例发表评论...如果它不是数据库分配的 Id 并且它是用户在 UI 中输入的内容 .. 像 SSN .. 那么哪个更好..

我认为来自 Steve 的关于 Null 模式的评论是有效的：这里可能不是一个好主意，因为当 ID 不存在时立即知道会非常有用。

而且我也认为这里的 Null 模式会有点重

Rob Wells 关于抛出异常的评论，因为它的 ID 错误：我不认为患者姓名中的拼写错误是一种特殊情况”恕我直言

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-05T20:03:22.757

请记住，“通过网络”到另一层（无论是数据库还是应用程序服务器）是您可以做的最昂贵的活动之一 - 通常网络调用将比内存调用长几个数量级。

因此，构建 API 以避免冗余调用是值得的。

考虑一下，如果您的 API 是这样的：

```
// Check to see if a given patient exists
public bool PatientExists(int id);

// Load the specified patient; throws exception if not found
public Patient GetPatient(int id); 
```

然后您可能会两次访问数据库 - 或者依赖良好的缓存来避免这种情况。

另一个考虑因素是：在某些地方，您的代码可能具有“已知良好”的 id，而在其他地方则没有。每个位置都需要不同的*策略*来确定是否应引发异常。

这是我过去使用过的良好效果的模式 - 有两种方法：

```
// Load the specified patient; throws exception if not found
public Patient GetExistingPatient(int id);

// Search for the specified patient; returns null if not found
public Patient FindPatient(int id); 
```

显然，GetExistingPatient() 可以通过调用 FindPatient() 来构建。

这允许您的调用代码获得适当的行为，如果出现问题则抛出异常，并在不需要的情况下避免异常处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T19:52:41.530

另一种选择是[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T19:53:09.143

你可能应该抛出一个异常。如果您有一个`id`不指向有效患者的数据，它是从哪里来的？很可能发生了非常糟糕的事情。这是一种特殊情况。

**编辑：**如果你做的不是基于整数的检索，比如基于文本的搜索，那么返回`null`就可以了。特别是因为在这种情况下，您要返回一组结果，这些结果可能不止一个（不止一个具有相同姓名、相同出生日期或任何您的标准的患者）。

搜索功能应该与检索功能具有不同的合同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T19:55:36.313

对于这种情况，我会让该方法为不存在的患者返回 null。

当系统本身出现问题时，我倾向于使用异常来协助严重降级。

在这种情况下，它可能是 mosdt：

1.  如果在搜索表单中输入了患者 ID，则会出现拼写错误，
2.  数据输入错误，或
3.  尚未输入患者记录的工作流程问题。

因此，返回 null 而不是异常。

如果在联系数据库时出现问题，那么我会让该方法引发异常。

**编辑：**刚刚看到签名中的患者 ID 是一个整数，感谢 Steven Lowe，所以我更正了我的原因列表。

我关于描述何时使用异常（针对系统错误）与其他返回错误的方法（针对简单的数据输入错误）的基本观点仍然有效。恕我直言。

高温高压

干杯，

抢

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T20:03:20.747

这取决于：

如果您认为正常操作会导致一个 pation number 与 DB 中的文件不匹配，则应返回一个空 (NULL) 记录。

但是，如果您希望给定的 ID 应该总是命中记录，那么当找不到记录时（这应该很少见），然后使用异常。

其他诸如数据库连接错误之类的事情应该会产生异常。
正如您在正常情况下所期望的那样，对数据库的查询始终有效（尽管它可能返回 0 条记录或不返回）。

**PS**我不会返回一个指针。（谁拥有指针？？）
我会返回一个可能有也可能没有记录的对象。但是您可以询问其中记录的存在。可能是智能指针或比理解上下文的智能指针更智能的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T19:54:10.640

在像这样的简单情况下 1\. 似乎绰绰有余。您可能希望实现类似于客户端调用的回调方法，以了解它返回 null 的原因。只是一个建议。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T19:56:08.653

从表面上看你的描述，你可能需要两者：

*   正如亚当指出的那样，错误的 ID 是错误/异常，但是
*   如果您在其他地方获得了可能已经消失的 ID，您将需要查询方法来检查它们

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T20:00:24.183

假设我没看错……当您调用 Patient(100) 时，它将返回一个 id 为 100 的 Patient 的对象引用。如果不存在 id 为 100 的患者，我认为它应该返回 null。异常被过度使用 IMO，这种情况不需要它。该函数只是返回了一个空值。它没有创建一些可能导致您的应用程序崩溃的错误案例（当然，除非您最终没有处理该 null 并将其传递给应用程序的其他部分）。

我肯定会让该函数返回“null”，特别是如果它是某些搜索的一部分，用户将搜索具有特定 ID 的患者，并且如果对象引用最终为 null，它只会声明没有患者该id存在。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T20:07:16.167

抛出异常。

如果返回 null，代码如下：

```
Console.WriteLine(Patient(id).Name); 
```

如果 id 不存在，则会失败并返回 NullReferenceException，这不如 PatientNotFoundException(id) 有用。在这个例子中，它仍然相对容易追踪，但请考虑：

```
somePatient = Patient(id)

// much later, in a different function:

Console.WriteLine(somePatient); 
```

关于添加检查患者是否存在的函数：请注意，这不会完全阻止 PatientNotFoundExceptions。例如：

```
if (PatientExists(id))
    Console.WriteLine(Patient(id).Name); 
```

-- 另一个线程或另一个进程可以在调用 PatientExists 和 Patient 之间删除患者。此外，这将意味着两个数据库查询而不是一个。通常，最好只尝试调用并处理异常。

请注意，对于返回多个值（例如作为列表）的查询，情况有所不同；在这里，如果没有匹配项，则返回一个空列表是合适的。

# c# - C#：在程序的设置对话框上按确定后，您在哪里调用自己的保存方法？

> ID：414267
> 
> 赞同：4
> 
> 时间：2009-01-05T19:48:44.673
> 
> 标签：c#

当用户在程序的“设置”对话框中编辑完任何设置后，您会将 SaveSettings 方法放在项目中的什么位置？

它应该在回报中，如：

```
 using (frmSettings frmSettings = new frmSettings())
        {
            if (frmSettings.ShowDialog() == DialogResult.OK)
            {
                // clicked OK, should I call SaveSettings() here? 

            }
            else
            {
                // clicked cancel.
            }
        } 
```

或者我应该把它放在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T20:12:37.090

在我看来，将保存代码放在调用表单中是把它放在不正确的地方。是的，它可以在这种情况下工作，但这意味着设置表单不可重复使用，并且保存代码中的任何错误都会导致设置表单在您知道任何错误之前卸载。

此外，如果添加新设置，则需要在两个源位置进行更改，一次是在设置表单中添加控件（并初始化它们），一次是在调用表单中保存值。

I'd attach the code to the OK button of the Settings form. If any errors are experienced in the saving, you can inform the user while their changes are visible and repairable. The form will be able to be called from different locations, as needed, or moved with nothing more than moving the ShowDialog() call. Your handling of DialogResult.OK should be used to update the calling form as the changes in settings apply to it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T19:50:08.573

```
// clicked OK, should I call SaveSettings() here? 
```

那似乎是个好地方。=)

编辑：我想这取决于应用程序的框架，但是把它放在那里并没有错。这是一个合乎逻辑的（根据所有逻辑定义）放置它的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T19:59:24.543

这取决于表单设置在做什么。如果它只是让用户好或取消然后

```
// clicked OK, should I call SaveSettings() here? 
```

是个好地方。

但是，如果您在对话框表单上获取设置信息，那么我会将保存逻辑放在该表单中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T19:58:31.537

我绝对认为将保存功能放在您建议的位置在逻辑上没有任何问题。或者，至少在某些情况下，我认为调用该函数以在“设置”表单中保存设置会更合适；但这在很大程度上取决于您的应用程序的整体架构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T20:28:44.267

If frmSettings form has the settings you need to save, I would store the settings from within that form -and in Isolated Storage or external XML file depending on your design.

# fluent-nhibernate - Fluent-NHibernate 存储库中可能存在的错误？

> ID：414272
> 
> 赞同：1
> 
> 时间：2009-01-05T19:50:14.203
> 
> 标签：fluent-nhibernate

我想我可能发现了一个错误，但我不确定。这可能是我的语法错误，但编译器没有捕捉到。无论如何，这就是我想要做的。基本上我已经编写了自己的存储库类，它基本上只是包装了 Fluent Repository 类。所以这里是相关的代码：

```
Public Class GenericRepository(Of T As IHasIntId) 
    Private _fluentRepos As FluentNHibernate.Framework.IRepository 
    Public Sub New(ByVal FluentRepository As 
FluentNHibernate.Framework.IRepository) 
        _fluentRepos = FluentRepository 
    End Sub 
    Private Sub New() 
    End Sub 
    Public Function GetById(ByVal Id As Integer) As T 
        Return Query(Function(x As T) (x.Id = Id)).FirstOrDefault 
    End Function 
    Public Function Query(ByVal w As Expression(Of System.Func(Of T, 
Boolean))) As IList(Of T) 
        Return _fluentRepos.Query(Of T)(w).ToList() 
    End Function 
End Class 
```

然后我编写了两个单元测试，一个将传递 InMemoryRepository，另一个将使用实际的 NHibernate 会话来访问真实的数据库。他们来了：

```
 <TestMethod()> Public Sub InMemoryTest() 
        Dim inmemRepos As New InMemoryRepository() 
        Dim p As New Product() 
        Dim id As Integer = 5 
        p.Id = id 
        p.Title = "my product" 
        inmemRepos.Save(p) 
        Dim genRepos As New GenericRepository(Of Product)(inmemRepos) 
        Dim foundP = genRepos.GetById(id) 
        Assert.AreEqual(p.Title, foundP.Title) 
    End Sub 

   <TestMethod()> Public Sub DatabaseTest() 
        Dim session = NHibernateSessionManager.Instance.GetSession() 
        Dim flRepos As New Repository(session) 
        Dim genRepos As New GenericRepository(Of Product)(flRepos) 
        Dim id As Integer = 1 
        Dim p = genRepos.GetById(id) 
        Assert.IsNotNull(p) 
        Assert.AreEqual(id, p.Id) 
    End Sub 
```

InMemoryTest 通过，DatabaseTest 失败。DatabaseTest 的例外是类型转换，从 int 到 product（或者可能相反）。不过，我能够“修复”它。在 Fluent NHibernate 代码中，我将 Repository 类的 Query 方法从：

```
return _session.Linq<T>().Where(where).ToArray(); 
```

到

```
return _session.Linq<T>().Where(where.Compile()).ToArray(); 
```

现在两个测试都通过了。Fluent NHibernate 项目中的所有单元测试都通过了任何一种方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T08:39:21.220

您在 Fluent NHibernate 邮件列表中收到的[答案很可能是正确的。](http://groups.google.com/group/fluent-nhibernate/browse_thread/thread/a8401d74cafc5e07?hl=en)也就是说，这是 Linq to NHibernate 而不是 Fluent NHibernate 中的一个错误，这是由 VB 编译器为 C# 生成不同的表达式树引起的。

# sql-server - MS-SQL Express 2005/2008 多实例 CPU 和内存利用率

> ID：414273
> 
> 赞同：1
> 
> 时间：2009-01-05T19:50:16.340
> 
> 标签：sql-server, memory, cpu

对于 SQL Express（2005 或 2008 版），可以使用 1GB 内存和 1 个 CPU 的限制。我想知道的是，如果两个实例安装在同一台机器上，它们会使用相同的 CPU 和相同的 1GB 内存吗？或者，他们会使用两个不同的 CPU 和 2GB 内存吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T20:11:50.447

限制是针对每个实例的。每个实例仅限于其自己的 1 个 CPU 和 1GB RAM。

一个系统上最多可以有 16 个 SQL Server Express Edition 实例。

同样在 MSDE（SQL Server Express 的前身）中，限制是针对每个实例的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T19:56:24.627

我不能肯定地说，但他们很可能能够使用单独的 CPU 和内存。像这样协调共享内存对他们来说是相当棘手的。我的怀疑是，无论是否存在其他实例（至少在您所谈论的方面），每个实例都会运行相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-17T04:53:47.130

假设您的系统有 4 个 CPU 和 4 GB 内存，以及 2 个 sql express 实例，那么每个 express 将使用一个 CPU 和 1 GB 内存。希望能帮助到你

# c++ - 最新版gcc使用libstdc++.so.5

> ID：414274
> 
> 赞同：6
> 
> 时间：2009-01-05T19:50:17.120
> 
> 标签：c++, gcc, libstdc++

仍然使用 libstdc++.so.5（而不是 libstdc++.so.6）的最新版本的 gcc 是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-02-24T12:39:13.263

在[Gnu ABI policy](http://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html "Gnu ABI 政策")中，您可以找到：

*   ...
*   gcc-3.3.3：libstdc++.so.5.0.5
*   gcc-3.4.0：libstdc++.so.6.0.0（与以前不兼容）
*   ...

因此，除非他们没有列出版本，否则 gcc-3.3.3 就是您想要的版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T21:19:19.577

在到处寻找答案之后，并没有找到它。我编译了几个不同的版本，最后一个使用 libstdc++.so.5 的版本是 3.3 版（更具体地说是 3.3.6）。版本 3.4.X 使用 libstdc++.so.6。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-05T20:42:18.810

我相信 libstdc++.so.5 用于所有 GCC 版本 3.X，而 libstdc++.so.6 用于 GCC 4.X。我不确定这一点，但我知道 libstdc++2 一直使用到 3.0，它使用 libstdc++5，而 4.0 使用 libstdc++6。

# sql - 在 MS SQL / SQL Server 2005 中精确限制日期范围

> ID：414276
> 
> 赞同：1
> 
> 时间：2009-01-05T19:50:37.167
> 
> 标签：sql, datetime, rounding, date-range

我想限制报告从日期 A 到日期 B 返回记录。这就是我一直在做的事情：

```
declare @startDate varchar(20)
declare @endDate varchar(20)
set @startDate = '01/01/2008'
set @endDate = '04/01/2008'
-- test what are the start and end dates
select min(date),max(date) from view_Inspections 
where date between @startDate and @endDate 
```

... 我被告知从 1 月 1 日上午 12 点到 3 月 31 日晚上 11:59 之间返回的记录（当没有指示时间时，午夜是默认值）。但我注意到一个差异，即如果记录的时间为 00:00:00，它将成为该集合的一部分。

是否有更准确的方法来执行此操作，以便准确返回我想要的日期范围？*

我尝试使用时间：

```
declare @startDate varchar(20)
declare @endDate varchar(20)
set @startDate = '01/01/2008 00:00:00'
set @endDate = '04/01/2008 11:59:59'
-- test what are the start and end dates
select min(date),max(date) from view_Inspections 
where date between @startDate and @endDate 
```

...但我注意到一些奇怪的事情：SQL Server 将把百分之一秒提高一半。因此，如果我使用晚于 11:59:29 的任何时间，我就会得到 4 月 1 日的记录（哈哈！愚人节的记录！grr）。这是为什么？

*   （我确信有。我是新手。感谢您的帮助！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T19:53:16.007

总是有简单的选择：

```
declare @startDate varchar(20)
declare @endDate varchar(20)
set @startDate = '01/01/2008'
set @endDate = '04/01/2008'

-- test what are the start and end dates
select min(date),max(date) from view_Inspections 
where date >= @startDate 
and   date < @endDate 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T20:14:29.850

我怀疑 view_Inspections 中的日期列是 SmallDateTime 数据类型。此数据类型的精度为 1 分钟，这可以解释您的意外结果（将秒数四舍五入到最接近的分钟数）。

Roland Shaw 建议的方法是修改查询以适应您的要求的最佳方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T20:25:30.950

BETWEEN 运算符具有包容性，这就是您在第一个查询中看到结果的原因。您在第二个查询中看到的舍入将取决于您在表中使用的确切日期时间数据类型。（顺便说一句，我认为您将秒数与百分之一秒混淆了）。看起来您可能在表中使用了 smalldatetime，在这种情况下，时间会四舍五入到最接近的分钟。

如果您的表使用日期时间，请尝试将您的 @startDate 和 @endDate 显式转换为 DATETIME 值 (CAST(@endDate AS DATETIME))。

快速说明...即使对于 DATETIME 值，SQL Server 也只能精确到 3/100 秒，因此 11:59:59.999 将四舍五入到 12:00:00.000。

你基本上有三个选择：

1) 在 CAST('01/01/2008 00:00:00.000' AS DATETIME) 和 CAST('03/31/2008 12:59:59.997' AS DATETIME) 之间

2) YEAR(my_date) = 2008 AND MONTH(my_date) BETWEEN 1 和 3

3) my_date >= CAST('01/01/2008 00:00:00.000' AS DATETIME) AND my_date < CAST('04/01/2008 00:00:00.000' AS DATETIME)

第一种方法不是很直观，在我看来很容易出错。第二种方法会降低性能，因为无法使用索引，如果您可以进行跨越数年的搜索或在几个月的中间开始/结束，它会变得更加复杂。Rowland 建议的第三种方法是我认为最好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-01T20:48:11.180

只需尝试从日期字段中删除时间，如下所示：

```
declare @startDate varchar(20)
declare @endDate varchar(20)
set @startDate = '01/01/2008'
set @endDate = '04/01/2008'

SELECT min(date),max(date) FROM view_Inspections 
WHERE CAST(FLOOR(CAST(date AS FLOAT)) AS DATETIME) BETWEEN CAST(@startDate AS DATETIME) And CAST(@startDate AS DATETIME)) 
```

这会将所有内容从`01/01/2008 00:00:00`to返回`04/01/2008 11:59:59.999`。如果您不想`04/01`包括在内，请将结束日期更改为`03/31/2008`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T19:25:41.143

您最好的解决方案是创建一个名为“julian”的 BIGINT(10) 字段，并将其存储在 YYYYMMDD 中。

然后查询 where julian >= '20120103' AND julian <= '20120203'

# c# - 如何处理从 LINQ to SQL 中的存储过程返回的 NULLable Int 列

> ID：414283
> 
> 赞同：7
> 
> 时间：2009-01-05T19:53:02.077
> 
> 标签：c#, asp.net, linq-to-sql, stored-procedures

我有一个返回两个 int 值的存储过程。第一个不能为空，但第二个实际上可以返回一个空值。当我尝试使用 LINQ to SQL 执行我的存储过程时，它会失败并显示以下语句：

> 不能将 null 值分配给 System.Int32 类型的成员，该类型是不可为 null 的值类型。

我试图在我的 DBML 中更改我的设计器文件并将：添加 `CanBeNull= true` 到存储过程结果的列映射中。

我似乎想出了处理这个问题的正确方法，不确定我是否可以更改我的 LINQ/C# 代码来解释 null（这将是更可取的），或者我是否必须以某种方式更新我的存储过程.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T20:01:10.500

您需要将变量声明为可为空。在设计器中，单击模型中需要可为空的属性，然后在“**属性**”窗口中，将“可空”属性设置为**True**。这将告诉生成器将您的属性创建为`Nullable<int> or int?`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T19:58:12.533

尝试将 int 变量声明为可为空。IE

```
int? myInt; 
```

这样您就可以检查它们是否为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-27T07:52:57.757

我也遇到了这个错误，原因是我已经更改了一个字段以允许在表中为空，但我没有在 .dbml 文件中删除该表。此问题通过删除并再次删除 .dbml 文件中的表来解决。

希望这对其他一些用户有所帮助。

谢谢。

# c# - LINQ排序匿名类型？

> ID：414290
> 
> 赞同：8
> 
> 时间：2009-01-05T19:54:04.803
> 
> 标签：c#, linq-to-sql

在 linq to sql 中生成匿名类型时如何进行排序？

前任：

```
from e in linq0
order by User descending /* ??? */
select new
{
   Id = e.Id,
   CommentText = e.CommentText,
   UserId = e.UserId,
   User = (e.User.FirstName + " " + e.User.LastName).Trim()),
   Date = string.Format("{0:d}", e.Date)
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-05T20:01:12.527

如果您使用 LINQ to Objects，我会这样做：

```
var query = from e in linq0
            select new
            {
                Id = e.Id,
                CommentText = e.CommentText,
                UserId = e.UserId,
                User = (e.User.FirstName + " " + e.User.LastName).Trim()),
                Date = e.Date.ToString("d")
            } into anon
            orderby anon.User descending
            select anon; 
```

这样，字符串连接只需执行一次。

我不知道在 LINQ to SQL 中会做什么......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T19:56:28.480

如果我正确理解了你的问题，你想这样做：

```
from e in linq0
order by (e.User.FirstName + " " + e.User.LastName).Trim()) descending 
select new
{
   Id = e.Id,
   CommentText = e.CommentText,
   UserId = e.UserId,
   User = (e.User.FirstName + " " + e.User.LastName).Trim()),
   Date = string.Format("{0:d}", e.Date)
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T00:08:19.907

作为避免乔恩选择...进入的一种方式，这会起作用吗？

```
from e in linq0
let comment = new
    {
       Id = e.Id,
       CommentText = e.CommentText,
       UserId = e.UserId,
       User = (e.User.FirstName + " " + e.User.LastName).Trim()),
       Date = string.Format("{0:d}", e.Date)
    }
orderby comment.User descending
select comment 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-19T04:32:51.963

我将为这个答案获得一个死灵法师徽章，但我仍然认为值得展示这个片段。

```
var records = await (from s in db.S
  join l in db.L on s.LId equals l.Id
  where (...)
  select new { S = s, Type = l.MyType }
  ).ToListAsync();

//Data is retrieved from database by now. 
//OrderBy below is LINQ to Objects, not LINQ to SQL

if (sortbyABC)
{
  //Sort A->B->C
  records.OrderBy(sl => sl.Type, new ABC());
}
else
{
   //Sort B->A->C
   records.OrderBy(sl => sl.Type, new BAC());
} 
```

ABC 和 BAC 实施`IComparer<MyType>`。

# jquery - 如何使用 jquery tablesorter 对格式为 mm/yy 的日期进行排序？

> ID：414294
> 
> 赞同：0
> 
> 时间：2009-01-05T19:56:06.097
> 
> 标签：jquery, tablesorter

我有一个表格，其中一列以 mm/yy 格式显示日期，即。12/08、01/09、02/08 等

如何使用 jQuery 表排序器 ( [http://tablesorter.com](http://tablesorter.com) ) 在此列上实现排序，以便对日期进行适当排序？

使用默认日期格式不起作用，因为它需要三个元素的日期（mm/dd/yy，例如 01/06/09）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T20:28:43.847

有关自定义解析器的信息，请参阅[http://tablesorter.com/docs/example-parsers.html](http://tablesorter.com/docs/example-parsers.html)。

您需要进行文本排序，但要切换年份和月份。您可以使用类似于以下的格式函数：

```
format: function(s) {
    date = s.split(/\//);
    return date[1] + date[0];
}, 
```

可能有一种更简单的方法，但这就是我在快速搜索文档时能够找到的方法。

# php - IIS6 上的 PHP

> ID：414302
> 
> 赞同：2
> 
> 时间：2009-01-05T19:58:07.293
> 
> 标签：php, iis, windows-server-2003

我在尝试在 Windows 2003/IIS6 上运行 .php 文件时遇到 401.1 错误我已经在网上到处都是，因为每个人都对包含该文件的文件夹以及该文件具有完全权限...什么都没有。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T20:08:22.483

这是在 IIS 6 上运行 PHP的分步[指南。](http://www.boyzoid.com/blog/index.cfm/2005/3/21/Running-PHP5-on-IIS-6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T20:27:01.430

1.  你能在试图为 PHP 提供服务的文件夹中提供 HTML 吗？

2.  如果是，PHP 目录和 PHP DLL（例如 php5isapi.dll）的权限是什么？IUSR 将需要执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T08:27:18.777

查看 IIS 生成的日志（在 C:\WINDOWS\system32\LogFiles\W3SVC1 中的某个位置找到），这可能会给您一些额外的信息。

# optimization - PostgreSQL 查询优化和 Postmaster 进程'

> ID：414307
> 
> 赞同：1
> 
> 时间：2009-01-05T19:59:16.293
> 
> 标签：optimization, postgresql, indexing, rdbms

我目前正在使用更大的 wikipedia-dump 派生 PostgreSQL 数据库；它包含大约 40 GB 的数据。该数据库在装有 Suse Linux Enterprise Server 10 的 HP Proliant ML370 G5 服务器上运行；我通过一个简单的 D-Link 路由器管理的专用网络从我的笔记本电脑查询它。我为笔记本电脑和服务器分配了静态 DHCP（私有）IP。

无论如何，从我的笔记本电脑上，使用 pgAdmin III，我发送了一些 SQL 命令/查询；其中一些是 CREATE INDEX、DROP INDEX、DELETE、SELECT 等。有时我发送一个命令（如 CREATE INDEX），它返回，告诉我查询已完美执行等。但是，分配给这样一个命令似乎仍然在服务器上休眠。现在，我真的不介意这一点，因为我对自己说 PostgreSQL 维护着一个准备处理查询的 postmaster 池。然而，如果这个过程占用了 6 GB 的 9.4 GB 分配的 RAM，我会担心（目前确实如此）。现在也许这是保存在[共享]内存中的数据缓存，以防另一个查询碰巧需要使用相同的数据，但我不知道。

另一件事困扰着我。

我有 2 张桌子。一是*页*表；我在其*page_id*列上有一个索引。另一个是具有 pl_from 列的*pagelinks**表*，该列在*page.page_id*列中没有引用任何内容或变量；与*page_id*列不同，*pl_from*还没有索引。为了让您了解表的规模以及我找到可行解决方案的必要性，*页*表有 1340 万行（在我删除了我不需要的行之后），而*pagelinks*表有 2.93 亿行。

 ***我需要执行以下命令来清理*pagelinks*表中一些无用的行：

```
DELETE FROM pagelinks USING page WHERE pl_from NOT IN (page_id); 
```

所以基本上，我希望摆脱来自不在页表中的*页面的所有链接的**pagelinks*表。即使在禁用嵌套循环和/或顺序扫描之后，查询优化器也总是给我以下“解决方案”：

 *```
Nested Loop  (cost=494640.60..112115531252189.59 rows=3953377028232000 width=6)
  Join Filter: ("outer".pl_from <> "inner".page_id)"
  ->  Seq Scan on pagelinks  (cost=0.00..5889791.00 rows=293392800 width=17)
  ->  Materialize  (cost=494640.60..708341.51 rows=13474691 width=11)
        ->  Seq Scan on page  (cost=0.00..402211.91 rows=13474691 width=11) 
```

似乎这样的任务需要几个星期才能完成；显然，这是不可接受的。在我看来，我宁愿它使用*page_id*索引来做它的事情......但它是一个顽固的优化器，我可能错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T21:14:22.473

关于你的第二个问题；您可以尝试使用 CREATE TABLE AS 语句创建仅包含所需记录的新表；如果新表足够小，它可能会更快——但它也可能无济于事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T00:48:45.223

事实上，我决定创建一个临时表来加速查询执行：

```
CREATE TABLE temp_to_delete AS(
    (SELECT DISTINCT pl_from FROM pagelinks) 
        EXCEPT 
    (SELECT page_id FROM page));
DELETE FROM pagelinks USING temp_to_delete 
    WHERE pagelinks.pl_from IN (temp_to_delete.pl_from); 
```

令人惊讶的是，这个查询在大约 4 小时内完成，而最初的查询在我决定杀死它之前保持活跃了大约 14 小时。更具体地说，删除返回：

```
Query returned successfully: 31340904 rows affected, 4415166 ms execution time. 
```

至于我的问题的第一部分，似乎 postmaster 进程确实在缓存中保留了一些信息；当另一个查询需要不在缓存和一些内存 (RAM) 中的信息时，缓存将被清空。邮政局长确实只是一个流程池'。

我还想到*gnome-system-monitor*是一个神话，因为它提供不完整的信息并且在信息价值方面毫无价值。主要是因为这个应用程序，我最近一直很困惑；例如，它不考虑其他用户（如 postgres 用户！）的内存使用情况，甚至告诉我我还有 12 GB 的 RAM，但事实并非如此。因此，我尝试了几个系统监视器，因为我想知道 postgreSQL 是如何使用它的资源的，而且*xosview*似乎确实是一个有效的工具。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-27T23:25:30.210

只要与客户端的连接打开，您的 postmaster 进程就会一直存在。pgadmin 是否关闭连接？我不知道。

使用的内存可以是 shared_buffers （检查您的配置设置），也可以不是。

现在，查询。对于像这样的大型维护操作，请随意将 work_mem 设置为像几 GB 这样的大值。你看起来有很多内存，所以使用它。

将 work_mem 设置为“4GB”；EXPLAIN DELETE FROM pagelinks WHERE pl_from NOT IN (SELECT page_id FROM page);

它应该 seq 扫描页面，对其进行散列，并 seq 扫描页面链接，查看散列以检查 page_ids。它应该很快（比 4 小时快得多！）但是你需要一个大的 work_mem 来存储哈希。

但是由于您删除了表的很大一部分，因此这样做可能会更快：

CREATE TABLE pagelinks2 AS SELECT a.* FROM pagelinks a JOIN pages b ON a.pl_from = b.page_id;

（您可以使用简单的 JOIN 而不是 IN）

您还可以在此查询上添加 ORDER BY，您的新表将在磁盘上很好地排序，以便以后进行最佳访问。

# c# - 从 CSProj 列表生成解决方案文件

> ID：414309
> 
> 赞同：13
> 
> 时间：2009-01-05T20:00:17.600
> 
> 标签：c#, visual-studio-2008

我有很多项目，但我没有一个包含所有内容的主解决方案。我想要一个的原因是为了重构。

所以我想知道是否有人知道构建解决方案文件的自动方法。手动添加所有项目是不可行的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2018-12-11T11:49:11.197

在 2018 年，您可以使用[`dotnet sln`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-sln)命令将项目添加到现有解决方案并[`dotnet new sln`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-new)创建新解决方案。

要从当前文件夹添加所有项目，请在 PowerShell 中使用这些命令

```
dotnet new sln
Get-ChildItem -Recurse *.csproj | ForEach { dotnet sln add $_.FullName } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-12-03T10:07:04.253

我现在更新了我的实用程序（上面提到过）以支持创建解决方案文件夹： [http ://bloggingabout.net/blogs/vagif/archive/2009/12/03/utility-to-generate-solution-files-can-现在创建解决方案文件夹.aspx](http://bloggingabout.net/blogs/vagif/archive/2009/12/03/utility-to-generate-solution-files-can-now-create-solution-folders.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-15T14:57:24.017

Vagif Abilov 编写了一个很棒的实用程序，可以从项目文件中生成解决方案文件。如果您为不“相信”解决方案文件的人工作，那就太棒了。啊。

生成解决方案文件.exe

用法：GenerateSolutionFile /p /s [/i includeFilter] [/e excludeFilter]

[http://bloggingabout.net/blogs/vagif/archive/2009/08/04/utility-to-generate-visual-studio-solution-file-for-a-group-of-projects.aspx](http://bloggingabout.net/blogs/vagif/archive/2009/08/04/utility-to-generate-visual-studio-solution-file-for-a-group-of-projects.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T20:21:33.687

你可以试试[这个](http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_23600576.html)（下面的代码来自这个站点，所有站点..）

但是，如果它不起作用并且调试需要花费太多时间，我建议您尝试手动添加一次。放一些好听的音乐就可以了... :)

@oefe 我不认为 VS.NET 允许您将项目开发成解决方案，我已经尝试过一次。

```
Imports EnvDTE
Imports EnvDTE80
-----------------------------------------------------------------------------------
    Private Shared Sub DoStuff()

        Dim filePath As String = "c:\temp"

        Dim fileName As String = "bld_TestApp.sln"

        Dim fullName As String = Path.Combine(filePath, fileName)

        Dim objType As Type

        Dim objDTE As EnvDTE.DTE

        objType = Type.GetTypeFromProgID("VisualStudio.DTE.8.0")

        objDTE = DirectCast(System.Activator.CreateInstance(objType), EnvDTE.DTE)

        Console.WriteLine(objDTE.Name + ":" + objDTE.Version)

        objDTE.Solution.Create(filePath, fileName)

        objDTE.Solution.AddFromFile("C:\Common.vbproj")

        objDTE.Solution.SaveAs(fullName)

    End Sub 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-28T13:41:40.263

我以编程方式使用文本操作为 .vcproj 文件创建了解决方案文件（但 cs/vb 的工作原理相同）。如果您在记事本或其他任何东西中打开解决方案文件，并不难弄清楚如何做到这一点。

不幸的是，我无法提供代码，因为它是专有的。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-01-05T20:14:40.537

创建一个空的解决方案，然后一次将所有项目拖放到其中？

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-05T20:44:32.393

查看 nAnt，Ant 的 .NET 端口。它有能力做这样的事情，或者在没有它的情况下构建。

# wpf - WPF DataGrid 同步列宽

> ID：414310
> 
> 赞同：13
> 
> 时间：2009-01-05T20:00:17.867
> 
> 标签：wpf, binding, datagrid, width, datagridcolumn

我有两个 WPF Toolkit `DataGrids`，我希望当用户调整第一个网格中第一列的大小时，它会调整第二个网格中第一列的大小。我尝试`DataGridColumn`将第二个网格中的宽度绑定到第一个网格中的相应列，但它不起作用。我更喜欢使用所有 xaml，但我也可以使用后面的代码。

```
<tk:DataGrid Width="100" Height="100">
    <tk:DataGrid.Columns>
        <tk:DataGridTextColumn x:Name="Column1" Width="50"/>
    </tk:DataGrid.Columns>
</tk:DataGrid>
<tk:DataGrid Width="100" Height="100">
    <tk:DataGrid.Columns>
        <tk:DataGridTextColumn x:Name="Column1Copy" Width="{Binding Path=ActualWidth, ElementName=Column1}"/>
    </tk:DataGrid.Columns>
</tk:DataGrid> 
```

我也尝试绑定到`Width`而不是`ActualWidth`，但都不起作用。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T16:58:05.820

好吧，我认为直接使用 XAML 是不可能的，但我仍然觉得应该这样做，因为`DataGridColumn`它确实派生自`DependencyObject`. 不过，我确实找到了一种以编程方式进行的方法。我对此并不感到兴奋，但它确实有效：

```
DataGridColumn.WidthProperty.AddValueChanged(upperCol, delegate
{
    if (changing) return;
    changing = true;
    mainCol.Width = upperCol.Width;
    changing = false;
});
DataGridColumn.WidthProperty.AddValueChanged(mainCol, delegate 
{ 
    if (changing) return;
    changing = true;
    upperCol.Width = mainCol.Width; 
    changing = false; 
});

public static void AddValueChanged(this DependencyProperty property, object sourceObject, EventHandler handler)
{
    DependencyPropertyDescriptor dpd = DependencyPropertyDescriptor.FromProperty(property, property.OwnerType);
    dpd.AddValueChanged(sourceObject, handler);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-11-27T04:10:16.753

您可以使用该`DataGrid` `LayoutUpdated`方法来操作有关列宽的其他对象。

```
private void dataGrid1_LayoutUpdated(object sender, EventArgs e)
{
    for(int i = 0 ; i < dataGrid1.Columns.Count && i < dataGrid2.Columns.Count ; ++i)
        dataGrid2.Columns[i].Width = dataGrid1.Columns[i].ActualWidth;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-08T10:42:25.330

受上述艾哈迈德回答的启发，我使用附加行为快速解决了这个问题。

```
public class DataGridWidthSyncronizerBehavior
{
    public static readonly DependencyProperty SyncronizeWidthWithProperty =
        DependencyProperty.RegisterAttached("SyncronizeWidthWith",
            typeof(DataGrid),
            typeof(DataGridWidthSyncronizerBehavior),
            new UIPropertyMetadata(null, SyncronizeWidthWithChanged));

    public static void SetSyncronizeWidthWith(DependencyObject target, DataGrid value)
    {
        target.SetValue(SyncronizeWidthWithProperty, value);
    }

    public static DataGrid GetSyncronizeWidthWith(DependencyObject target)
    {
        return (DataGrid)target.GetValue(SyncronizeWidthWithProperty);
    }

    private static void SyncronizeWidthWithChanged(DependencyObject obj, DependencyPropertyChangedEventArgs dpargs)
    {
        if (!(obj is DataGrid sourceDataGrid))
            return;

        if (!(sourceDataGrid.GetValue(SyncronizeWidthWithProperty) is DataGrid targetDataGrid))
            return;

        void Handler(object sender, EventArgs e)
        {
            for (var i = 0; i < sourceDataGrid.Columns.Count && i < targetDataGrid.Columns.Count; ++i)
                targetDataGrid.Columns[i].Width = sourceDataGrid.Columns[i].ActualWidth;
        }

        sourceDataGrid.LayoutUpdated -= Handler;
        sourceDataGrid.LayoutUpdated += Handler;
    }
} 
```

XAML：

```
<DataGrid local:DataGridWidthSyncronizerBehavior.SyncronizeWidthWith="{Binding ElementName=SyncronizedHeaderGrid}">
    <DataGrid.Columns>
        <DataGridTextColumn Header="Header 1" 
                            Binding="{Binding Item1}" />
        <DataGridTextColumn Header="Header 2" 
                            Binding="{Binding Item2}"/>
        <DataGridTextColumn Header="Header 3" 
                            Binding="{Binding Item3}"/>
    </DataGrid.Columns>
</DataGrid>

<DataGrid x:Name="SyncronizedHeaderGrid">
    <DataGrid.Columns>
        <DataGridTextColumn Header="Header 1" 
                            Binding="{Binding Item1}" />
        <DataGridTextColumn Header="Header 2" 
                            Binding="{Binding Item2}"/>
        <DataGridTextColumn Header="Header 3" 
                            Binding="{Binding Item3}"/>
    </DataGrid.Columns>
</DataGrid> 
```

第二个 DataGrids，标题和单元格宽度，现在与第一个网格标题宽度同步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T23:19:36.170

我试过这个：

```
<tk:DataGrid Width="100" Height="100" x:Name="Grid1" Grid.Column="0">
   <tk:DataGrid.Columns>
      <tk:DataGridTextColumn x:Name="Column1" Width="50"/>
   </tk:DataGrid.Columns>
</tk:DataGrid>
<tk:DataGrid Width="100" Height="100" x:Name="Grid2" Grid.Column="1">
   <tk:DataGrid.Columns>
     <tk:DataGridTextColumn x:Name="Column1Copy" Width="{Binding Mode=TwoWay, Path=Columns[0].ActualWidth, ElementName=Grid1}"/>
     </tk:DataGrid.Columns>
</tk:DataGrid> 
```

但是，看起来由于`DataGridColumn`s 不是从 s 派生`FrameworkElement`而是从 s 派生的`DependencyObject`，因此这种方式的绑定不可用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-21T08:55:18.817

如果要在 XAML 中绑定列 Width 属性，`DataGrid`则必须在 2 中执行以下操作。

在`DataGrid`名字中`DataGridTextColumn`：

```
<DataGrid>
    <DataGrid.Columns>
        <DataGridTextColumn x:Name="Col1"/>
    </DataGrid.Columns>
</DataGrid> 
```

在第二个中`DataGrid`添加一个`DiscreteObjectKeyFrame`指向上述列作为资源，并使用以下属性对`Binding`您想要“链接”：`Width``DataGridTextColumn`

```
<DataGrid>
    <DataGrid.Resources>
        <DiscreteObjectKeyFrame x:Key="proxyCol1" Value="{Binding ElementName=Col1}"/>
    </DataGrid.Resources>
    <DataGrid.Columns>
        <DataGridTextColumn  Width="{Binding Path=Value.Width, Mode=TwoWay, Source={StaticResource proxyCol1}}"/>
    </DataGrid.Columns>
</DataGrid> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2011-06-16T23:12:57.567

我找到了这个问题的解决方案，以及一个非常酷的解决方案 :-) 您可以下载 WPF 工具包并获取 DataGrid 的代码。获得代码后，您只需将 DataGridColumn 类更改为继承 FrameworkElement 而不是 DependencyObject。一旦你这样做了 - 你只剩下一个问题，列的 DataContext 不会被初始化，因为列不是逻辑树的一部分，将它添加到逻辑树将解决这个问题。你可以这样做： OnColumnInitialization 在哪里： private void OnColumnInitialization(object sender, EventArgs e) {
AddLogicalChild（发件人）；现在它是逻辑树的一部分，您拥有相同的数据上下文，您可以在 Width 属性上使用绑定。如果所有都绑定到相同的宽度 - 你有你的列的宽度的完整同步。这对我有用:-)吉利

# configuration - 在 0.7.8 之前的 Nginx 中如何访问 HTTP GET 参数？

> ID：414324
> 
> 赞同：3
> 
> 时间：2009-01-05T20:04:17.030
> 
> 标签：configuration, nginx

[变更日志](http://nginx.net/CHANGES)将0.7.8 版列为引入符号以从内部`$arg_X`访问 HTTP GET 参数的版本。`X``nginx.conf`

不幸的是，wiki 是最新的。`nginx.conf`在此版本之前，您如何从内部访问 HTTP GET 参数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T20:15:13.357

目前，我最好的方法是匹配`$args`.

例如，`if ($arg_user = "jim")`您可以说，而不是说`if ($args = "user=jim")`。此特定示例仅适用于单个参数，因为多个参数可以以任何顺序出现；这种情况应该用正则表达式处理。

# mysql - 我将如何使用“myisam_ftdump -c”的结果创建一个新的 MySQL 表？

> ID：414327
> 
> 赞同：1
> 
> 时间：2009-01-05T20:06:19.880
> 
> 标签：mysql, database

我`myisam_ftdump -c`用来转储全文列中出现的单词。将该信息插入新的 MySQL 表的最简单方法是什么？

感谢您的帮助，不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T05:38:16.107

将结果 > 转储到文件并使用[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)查询将内容导入回新表。

笔记：

> 出于安全原因，在读取位于服务器上的文本文件时，这些文件必须位于数据库目录中或可供所有人读取。此外，要对服务器文件使用 LOAD DATA INFILE，您必须具有 FILE 权限。

# c# - 使用静态 Regex.IsMatch 与创建 Regex 实例

> ID：414328
> 
> 赞同：46
> 
> 时间：2009-01-05T20:06:30.257
> 
> 标签：c#, regex, optimization

在 C# 中，你应该有如下代码：

```
public static string importantRegex = "magic!";

public void F1(){
  //code
  if(Regex.IsMatch(importantRegex)){
    //codez in here.
  }
  //more code
}
public void main(){
  F1();
/*
  some stuff happens......
*/
  F1();
} 
```

还是应该保留一个包含重要模式的正则表达式实例？使用 Regex.IsMatch 的成本是多少？我想在每个 Regex 实例中都创建了一个 NFA。据我了解，这种 NFA 创作并非易事。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-05T20:33:38.953

罕见地背离了我典型的自负主义，我在这个答案上有点颠倒了自己。

我的原始答案（保留在下面）是基于对.NET 框架*1.1版的检查。*这是相当可耻的，因为在我回答时 .NET 2.0 已经发布了三年多，并且它包含对`Regex`类的更改，这些更改显着影响了静态方法和实例方法之间的差异。

在 .NET 2.0（和 4.0）中，静态`IsMatch`函数定义如下：

```
public static bool IsMatch(string input, string pattern){
    return new Regex(pattern, RegexOptions.None, true).IsMatch(input);
} 
```

这里的显着区别在于`true`第三个论点。这对应于一个名为“useCache”的参数。如果是这样，则在第二次和后续使用时从缓存中检索解析的树。

这种缓存消耗了静态方法和实例方法之间的大部分（但不是全部）性能差异。在我的测试中，静态`IsMatch`方法仍然比实例方法慢大约 20%，但是当在一组 10,000 个输入字符串（总共 100 万次操作）上运行 100 次时，这仅增加了大约半秒。

在某些情况下，这 20% 的放缓仍然很重要。如果您发现自己正在对数亿个字符串进行正则表达式，您可能会想尽一切可能提高效率。但我敢打赌，在 99% 的情况下，您使用特定正则表达式的次数不会超过几次，而且您在静态方法中损失的额外毫秒数甚至不会接近明显。

对[devgeezer](https://stackoverflow.com/a/10838615/36388)的支持，他在差不多一年前就指出了这一点，尽管似乎没有人注意到。

我的旧答案如下：

* * *

静态`IsMatch`函数定义如下：

```
public static bool IsMatch(string input, string pattern){
    return new Regex(pattern).IsMatch(input);
} 
```

而且，是的，`Regex`对象的初始化并非易事。您应该使用静态`IsMatch`（或任何其他静态`Regex`函数）作为您将只使用一次的模式的快速快捷方式。`Regex`如果您将重用该模式，那么重用一个对象也是值得的。

至于您是否应该`RegexOptions.Compiled`按照 Jon Skeet 的建议指定 ，那是另一回事。答案是：视情况而定。对于简单的模式或只使用几次的模式，使用非编译实例可能会更快。在决定之前，您绝对应该进行分析。编译正则表达式对象的成本确实很大，而且可能不值得。

* * *

以以下为例：

```
const int count = 10000;

string pattern = "^[a-z]+[0-9]+$";
string input   = "abc123";

Stopwatch sw = Stopwatch.StartNew();
for(int i = 0; i < count; i++)
    Regex.IsMatch(input, pattern);
Console.WriteLine("static took {0} seconds.", sw.Elapsed.TotalSeconds);

sw.Reset();
sw.Start();
Regex rx = new Regex(pattern);
for(int i = 0; i < count; i++)
    rx.IsMatch(input);
Console.WriteLine("instance took {0} seconds.", sw.Elapsed.TotalSeconds);

sw.Reset();
sw.Start();
rx = new Regex(pattern, RegexOptions.Compiled);
for(int i = 0; i < count; i++)
    rx.IsMatch(input);
Console.WriteLine("compiled took {0} seconds.", sw.Elapsed.TotalSeconds); 
```

在`count = 10000`，如所列，第二个输出是最快的。增加到`count`，`100000`编译版本胜出。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-05T20:09:04.727

如果您要多次重用正则表达式，我会创建它`RegexOptions.Compiled`并缓存它。让框架在您每次需要时都解析正则表达式模式是没有意义的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-31T17:46:36.333

对于我机器上的 .NET 版本，这个答案不再正确。4.0.30319 和 2.0.50727 对于 IsMatch 都有以下内容：

```
public static bool IsMatch(string input, string pattern)
{
  return new Regex(pattern, RegexOptions.None, true).IsMatch(input);
} 
```

'true' 值用于名为“useCache”的构造函数参数。所有的 Regex 构造函数最终都通过这个链接，静态直接调用这个 - 传入“true”。

您可以在 BCL 博客文章中阅读更多关于优化正则表达式性能的信息，并[在此处](http://blogs.msdn.com/b/bclteam/archive/2010/06/25/optimizing-regular-expression-performance-part-i-working-with-the-regex-class-and-regex-objects.aspx)突出显示静态方法的缓存使用。此博客文章还引用了性能测量。阅读有关优化正则表达式性能的系列博客文章是一个很好的起点。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-05T20:17:23.633

我同意乔恩的观点，只是为了澄清它看起来像这样：

```
static Regex regex = new Regex("regex", RegexOptions.Compiled); 
```

有时也值得查看`RegexOptions`枚举中的其他标志，这些标志有时会有所帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-08-02T12:16:31.913

有很多事情会影响使用正则表达式的性能。最终，找出在你的情况下表现最好的唯一方法是测量，尽可能使用现实的情况。

MSDN 上关于正则表达式对象的[编译和重用](http://msdn.microsoft.com/en-us/library/8zbs0h2f.aspx)的页面涵盖了这一点。总之，它说

1.  已编译的正则表达式需要时间来编译，并且一旦编译，它们的内存只会在`AppDomain`卸载时释放。您是否应该使用编译将取决于您使用的模式数量以及它们的使用频率。

2.  静态`Regex`方法缓存最后 15 个（默认情况下）模式的已解析正则表达式表示。*因此，如果您没有在应用程序中使用许多不同的模式，或者您的使用已足够集群化，那么*缓存实例或缓存实例的框架之间不会有太大区别。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-05T20:54:04.420

我建议您阅读[Jeff](http://www.codinghorror.com/blog/archives/000228.html "编译还是不编译")关于编译 Regex 的帖子。

至于问题，如果您问这个问题，则意味着您将只使用一次。因此，Reflector 对 Regex.IsMatch 的反汇编并不重要：

```
public static bool IsMatch(string input, string pattern, RegexOptions options)
{
    return new Regex(pattern, options, true).IsMatch(input);
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-06T00:06:59.943

对于我正在开发的 WinForm 应用程序，我们可以在有效字符上定义一个正则表达式，它会在每次击键时运行，并对任何文本框（数据输入应用程序）的文本进行验证，所以我使用了缓存或编译的正则表达式，例如

```
 private static Dictionary<string, Regex> regexCache = new Dictionary<string, Regex>(20); 
```

正则表达式是关键所在。

然后我有一个可以在验证数据时调用的静态函数：

```
public static bool RegExValidate(string text, string regex)
{
  if (!regexCache.ContainsKey(regex))
  {
    Regex compiledRegex = new Regex(regex,RegexOptions.Compiled);
    regexCache.Add(regex, compiledRegex);
  }
  return regexCache[regex].IsMatch(text);
} 
```

# sql - 为什么 SqlServer 优化器会与参数混淆？

> ID：414336
> 
> 赞同：7
> 
> 时间：2009-01-05T20:09:49.563
> 
> 标签：sql, sql-server, optimization

我知道这与参数嗅探有关，但我只是对以下示例之类的事情甚至可能使用一项可以很好地完成许多复杂事情的技术感到困惑。

我们中的许多人都遇到过存储过程，它间歇性地运行比平时慢几个数量级，然后如果你从过程中复制出 sql 并在单独的查询窗口中使用相同的参数值，它的运行速度和往常一样快。

我只是通过转换这个来修复这样的过程：

```
alter procedure p_MyProc
(
    @param1 int
) as -- do a complex query with @param1 
```

对此：

```
alter procedure p_MyProc
(
    @param1 int
)
as

declare @param1Copy int;
set @param1Copy = @param1;

-- Do the query using @param1Copy 
```

它从运行超过一分钟回到不到一秒，就像它通常运行的那样。这种行为似乎完全随机。对于 10 个 @param1 输入中的 9 个，查询速度很快，无论最终需要处理多少数据，或者结果集有多大。但是对于十分之一的人来说，它只是迷路了。解决方法是在查询中用相同的 int 替换一个 int？

这没有道理。

[编辑]

@gbn 链接到这个问题，它详细说明了一个类似的问题：

[已知问题？：SQL Server 2005 存储过程无法通过参数完成](https://stackoverflow.com/questions/379007/known-issue-sql-server-2005-stored-procedure-fails-to-complete-with-a-parameter)

我犹豫着要喊“虫子！” 因为这通常是一种逃避，但这对我来说确实是一个错误。当我使用相同的输入运行存储过程的两个版本时，我看到了相同的查询计划。唯一的区别是原版运行需要一分钟以上，而带有愚蠢参数复制的版本会立即运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T20:23:01.983

十分之一的人给出了错误的缓存计划。

RECOMPILE 增加了开销，屏蔽允许根据其自身的优点评估每个参数（非常简单）。

通过错误的计划，如果 10 中的 1 个在索引 1 上生成扫描，而其他 9 个在索引 2 上生成查找怎么办？例如，10 中的 1 是，比如说，50% 的行？

编辑：其他问题

*   [已知问题？：SQL Server 2005 存储过程无法通过参数完成](https://stackoverflow.com/questions/379007/known-issue-sql-server-2005-stored-procedure-fails-to-complete-with-a-parameter)
*   [存储过程在特定用户上失败](https://stackoverflow.com/questions/272726/stored-procedure-failing-on-a-specific-user)

编辑2：

重新编译不起作用，因为参数在编译时被嗅探。
从其他链接（粘贴）：

这篇[文章](http://www.microsoft.com/technet/prodtechnol/sql/2005/recomp.mspx#E6TAE)解释...

```
...parameter values are sniffed during compilation or recompilation... 
```

最后（编辑3）：

参数嗅探在当时可能是一个好主意，并且可能大部分时间都很好用。我们将它全面用于将在 WHERE 子句中结束的任何参数。我们不需要使用它，因为我们知道只有少数（更复杂的，例如报告或许多参数）可能会导致问题，但我们使用它是为了保持一致性。

事实上，当用户抱怨时它会回来咬我们，我们应该使用掩蔽......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T04:31:58.567

在将我的代码从测试服务器移动到生产服务器时，我[在 SQL Server 2005 的两个不同版本上](https://stackoverflow.com/questions/379007/known-issue-sql-server-2005-stored-procedure-fails-to-complete-with-a-parameter)反复遇到过这个问题。我认为在 SQL Server 2005 的某些版本中，参数嗅探存在一些大问题。我在开发服务器或两个本地开发人员版本盒上从未遇到过这个问题。我从未见过它在 SQL Server 2000 或任何可以追溯到 6.5 的版本上出现如此大的问题。

在我发现它的情况下，唯一的解决方法是使用参数屏蔽，我仍然希望 DBA 将生产服务器修补到 SP3，这样它可能会消失。不起作用的事情：

*   在 EXEC 或 SP 本身中使用 WITH RECOMPILE 提示。
*   删除和重新创建 SP
*   使用 sp_recompile

请注意，在我正在处理的情况下，自之前的调用以来数据并没有改变——我只是将代码编写到已经加载数据的生产框中。自 SP 存在以来，所有调用都没有对数据进行任何更改。

哦，如果 SQL Server 不能在没有掩码的情况下处理这个问题，他们需要添加一个参数修饰符 NOSNIFF 或其他东西。如果你屏蔽了所有参数会发生什么，所以你有@Something_parm 和@Something_var 并且有人更改了代码以使用错误的代码，突然你又遇到了嗅探问题？另外，您正在污染 SP 中的命名空间。我正在“修复”的所有这些 SP 让我抓狂，因为我知道对于经验不足的 satff 来说，它们将是一场维护噩梦，我将把这个项目交给一天。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T21:27:08.237

您能否在 SQL Profiler 上检查快速和慢速时的读取次数和执行时间？它可能与获取的行数有关，具体取决于参数值。这听起来不像是缓存计划问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T20:19:26.640

这可能是由于 SQL Server 编译存储过程并为它们**缓存**执行计划，而缓存的执行计划可能不适合这组新参数。您可以尝试`WITH RECOMPILE`选项以查看是否是原因。

```
EXECUTE MyProcedure [parameters] WITH RECOMPILE 
```

`WITH RECOMPILE`选项将强制 SQL Server 忽略缓存的计划。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-25T22:20:31.840

我知道这是一个 2 岁的线程，但它可能会帮助某人。

一旦您分析了查询执行计划并知道这两个计划之间的区别（查询本身和在存储过程中执行有缺陷计划的查询），您就可以使用查询提示修改存储过程中的查询来解决问题。这适用于查询在存储过程中执行时使用不正确索引的情况。您可以在程序的适当位置的表格之后添加以下内容：

```
SELECT col1, col2, col3
FROM YourTableHere WITH (INDEX (PK_YourIndexHere)) 
```

这将强制查询计划使用应该解决问题的正确索引。这并不能回答为什么会发生这种情况，但它确实提供了一种解决问题的方法，而无需担心复制参数以避免参数嗅探。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T21:02:01.190

是否有可能提供的参数值有时不是int？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T21:33:45.057

这是计划缓存的一个问题，它并不总是与参数相关，就像在您的场景中那样。

（参数嗅探问题发生在 proc 在第一次运行时使用异常参数调用，因此缓存计划适用于那些奇数值，但在大多数其他时候调用 proc 时很糟糕。）

当应用程序团队从生产服务器上的高使用日志表中删除所有旧记录时，我们遇到了类似的情况。删除记录可以提高性能，对吗？不，性能立即下降。

结果发现，一个经常使用的存储过程在表几乎为空时被重新编译，并且它缓存了一个非常糟糕的执行计划（“嘿，这里只有 50 条记录，还不如做一个表扫描！”）。无论初始参数如何，都会发生。

我们的解决方法是使用 sp_recompile 强制重新编译。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T21:54:41.987

是否每个查询引用都将其与 int 值进行比较，没有函数且没有强制转换？

您是否可以使用该参数增加任何表达式的特异性，从而更有可能使用多字段索引？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T20:25:51.213

如前所述，这是一个编译问题。如果您恢复程序，此问题是否仍然存在？如果再次发生这种情况以强制重新编译，您可以尝试的一件事是使用：

sp_recompile [ @objname = ] '对象'

就@objname 参数而言，来自 BOL：

是当前数据库中存储过程、触发器、表或视图的限定或非限定名称。对象是 nvarchar(776)，没有默认值。如果 object 是存储过程或触发器的名称，则存储过程或触发器将在下次运行时重新编译。如果 object 是表或视图的名称，则所有引用表或视图的存储过程将在下次运行时重新编译。

如果您删除并重新创建该过程，您可能会导致客户端在尝试执行该过程时失败。您还需要重新应用安全设置。

# java - 同步eclipse保存动作规则

> ID：414339
> 
> 赞同：18
> 
> 时间：2009-01-05T20:11:07.483
> 
> 标签：java, eclipse, eclipse-3.4

我的团队有一套相当丰富的格式化规则和保存操作，这些规则正在不断发展。我们正在寻找一种机制来集中定义并自动传播它们。我们不想重新格式化代码库，但我们希望格式化会随着时间的推移逐步改进。我们使用 Subversion 进行源代码控制，但我们希望将存储的配置限制为规则和操作。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-05T21:32:23.063

如果您选中“启用项目特定设置”框，将创建一个文件，其中包含您可以签入的设置。仅此而已。然后，您只需确保团队知道您只能在团队同意的情况下更改该文件。这适用于多个设置窗口，包括清理、格式化程序和保存操作。

eclipse 文件将位于 .settings/ 目录中，名称类似于 org.eclipse.jdt.core.prefs。

**编辑**：您需要在作为项目签出的每个目录的根目录中都有一份 .settings 副本。通过 IDE 创建一个副本后，您可以在其他项目中签入一份副本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-04T16:29:37.037

从 Eclipse 4.4.1 开始，没有用于导入/导出“保存操作设置”的本机功能。

您可以做的是手动复制包含“保存操作设置”的文件。

看到这个问题：[eclipse save actions in source control](https://stackoverflow.com/questions/9236906/eclipse-save-actions-in-source-control)

我试过了，它对我有用，但我不确定我是否想将我的首选项置于源代码控制之下。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-05T20:30:23.873

您是否尝试过导出您的偏好？`File --> Export --> Preferences`.

您还应该能够导出/导入格式化程序 ( `Window --> Preferences --> Java --> Code Style --> Formatter --> Edit button --> Export button`) 的设置。

然后，您可以拥有一组标准的保存操作/首选项/格式规则，可以方便地从文件中导入。

# sql-server - 如何使 Sql Server Management Studio 中的选项卡下拉显示更多文件名

> ID：414343
> 
> 赞同：2
> 
> 时间：2009-01-05T20:12:07.013
> 
> 标签：sql-server, ssms

只有我对此感到恼火吗？如果文件名具有相同的前缀，或者比上下文窗口宽度长，我什至不知道我正在单击什么 proc。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T04:32:18.160

我发现选项卡下拉列表以及选项卡名称本身很烦人。你不能扩大它们中的任何一个。

它有助于将每个脚本保存到文件中，即使只是暂时的。我在需要保存我编写的每个脚本的环境中工作。如果我将鼠标悬停在每个选项卡上，我可以看到文件名。不完美，但它有帮助。

如果您正在运行 SSMS 2008（甚至只是 SSMS Express 2008），您可以更改某些属性设置，以便每个选项卡中仅显示某些内容：当前服务器、当前数据库、文件名等。如果您只工作例如，在单个数据库中，您可以关闭除文件名之外的所有内容。

但是，除非这些建议中的任何一个有帮助，否则这些愚蠢的标签实际上是没有办法的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-21T13:17:49.510

连接是垃圾，他们什么都不做

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T08:03:08.157

没有办法让它变得更大。

我也觉得这很烦人。有几个关于此的连接项打开。

# project-management - 对敏捷环境中的大型项目进行估算

> ID：414346
> 
> 赞同：54
> 
> 时间：2009-01-05T20:12:41.240
> 
> 标签：project-management, agile, estimation

我的公司刚刚收到了第一个大型开发项目的询盘，我想使用敏捷过程。客户对应用程序有远见，但公开承认要求很少，并承认我们将不得不按小时收费。正因为如此，我几乎把敏捷方法卖给了他。

问题是他想要一个数字来预算。我读过很多文章，它们几乎都主张不要放弃估算，因为客户会为这个数字做预算，即使需求发生变化，他们头脑中和书中的数字也不会改变。

我读过有很多方法可以在合同中考虑定价，但几乎所有方法（除了一个）都包含一个预先编号。这似乎违反了敏捷开发的整套原则。

所以我的问题是，如果您是敏捷开发者，您如何设法规避敏捷开发的 Catch-22？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-05T20:24:03.200

这是基本问题。

**客户什么时候会认为他们已经完成了？**

如果他们认为他们会在 6 月份完成，那么你就可以组建一个敏捷团队。那是4-6人6个月。这就是预算。本质上，您为它们进行乘法运算。团队 * 费率 * 6 个月。

如果他们认为他们将在 6 月份完成大部分工作，但在那之后会有更多的工作，那么你可能会看到 9 个月的工作。同样，你只是在做一个他们可以为自己做的乘法。团队 * 费率 * 9 个月。

如果他们认为您将在可预见的未来成为他们的开发团队，请给他们一个价格，以使项目能够持续到年底。团队 * 费率 * 12 个月。

*由于每个版本都是重新确定优先级的机会，因此您应该根据您将*在该版本中完成的工作将每个版本定价为单独的工作。由于这是他们的优先计划，他们控制着你建造的东西，他们控制着预算，分阶段进行。

通常，您的客户真的想知道特定功能集的成本是多少。他们没有问这个，而是询问总体预算（这很愚蠢）。在第一个版本上花费大量时间来展示他们得到了什么以及第一个版本的成本。

最终，他们会看到根本的真相。

**他们购买的功能从最重要到最不重要**。如果他们正确地优先考虑，他们可以随时停止花钱并拥有一些有用的东西。

完成是一个相对的术语。有些项目“完成”了，因为没有钱了。其他的已经完成了，因为没有更多的时间了。很少（至少在软件开发中）是一个项目曾经完成，因为我们没有事情可做。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-05T20:21:15.857

对于这种情况，我们提供了第一块工作的估算，然后让客户根据需要购买更多的 sprint，以将工作完成到所需的水平。

随着您开发更多系统，并将来自客户的反馈纳入 sprint 可交付成果，您将对所涉及的工作量以及所涉及的成本都有更好的感觉。

**编辑：**酷。太棒了！从您以敏捷方法出售它们的事实来看，顺便说一句，这很好！，您很可能能够从敏捷的角度在要实现的功能方面看到它们。或许可以收听这个“ [Intro to Scrum](http://itc.conversationsnetwork.org/shows/detail350.html#) ”播客。您可能可以出售他们，因为他们可能不需要拥有他们认为现在需要的所有花里胡哨。

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-05T20:43:14.987

看，这里有一个核心事实。您将被要求估算成本、签订特定交付日期的合同，并承诺交付一整套功能。

***你不能同时做这三个。***

不是“你不应该”或“最好不要”；你（出于所有实际目的）不能。我的意思是成功完成这三个方面的可能性非常小。

最好的答案是承诺成本和进度，以及具有快速迭代和定期反馈的迭代过程，然后编写协议，以便在固定成本和进度下*完成的工作就是交付的内容。*也就是说，您不断提供新功能（和修改），直到时间和金钱用完为止。

事实是，即使您*确实*注册了所有三个，您所能做的最好的事情就是三分之二。不妨对此持开放态度。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-05T22:30:18.077

最近我认识的一位脾气暴躁的老政府承包商是这样说的：“正如妓女所说，首先你得把她们弄上楼。”

这并不能回答你的问题，但值得记住。如果他们不会在前面没有号码的情况下上楼（他们不会），你必须给他们一个号码。

任何赞助软件项目的人都需要了解他们将从投资中获得什么样的回报，以便他们能够评估投资是否值得。如果一个项目花费 100 万美元并需要 12 个月，那么它可能是值得做的。如果它花费 200 万美元并且需要 24 个月，那么它可能不值得做。

真正的问题是：你能否在一个时间框架和预算内完成这个项目，使客户有可能获得适当的投资回报？如果你对这个问题的回答不是“是”，那么他们不应该雇佣你来做这个项目。否则，他们只是在花钱和掷骰子。

如果你目前对该问题的回答是“我们还不知道”，那么他们不应该雇佣你来做这个项目。但这并不意味着他们不应该雇用您来确定该项目是否值得做。一个很好的咨询公司流行语是“初步范围界定练习”。

敏捷开发是关于管理三个维度的曲线：花费的金钱、日历时间和功能集。如果预算和时间表是固定的，那么功能集必须是可变的，这是一个假设。*鉴于这些限制，*您无法知道最终的功能集是什么。但是您*可以*知道您能够在这些限制内生成*的*功能集是否在您的客户认为可以接受的范围内。

你可以知道这一点，你可以找到它。找出这一点是您的公司可以做而您的客户做不到的事情。这是您可以提供给他们的服务，他们应该为您付费。避免免费这样做的诱惑，并将其称为销售成本。项目范围界定与软件开发一样是专业服务的一部分。您这样做不是为了完成销售；您这样做是为了帮助您的客户做出他们还没有足够信息可以做出的商业决策。

但首先你得让他们上楼。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-05T22:28:12.123

这些答案真的很棒。我没有太多经验可以分享，但我想到了一个比喻：

去年，我和妻子改造了我们的厨房。承包商建议按时间和材料计费，而不是给出估计，因为我们不知道我们会发现与管道、底层地板损坏等有关的情况。我们同意了，因为我在家工作，而且我可以不断地回答问题。承包商和我关系很好，所以当有事情发生时，他可以随意敲我办公室的门，我们会讨论一下。很快就做出了决定，并按照我想要的方式完成了工作。这似乎类似于**频繁客户审查**的敏捷优先级。

相比之下，我妻子的表弟也在改造他的房子。他是一名急诊室医生，在改造期间他*不在*现场。所以他描述了承包商在没有咨询他的情况下做出重大决定时经常感到惊讶（“什么？我不希望那扇窗户被挡住！把墙拆掉，把窗户改成原来的样子！”）。这当然是非常昂贵的，并且会破坏时间表。绝对不是敏捷。

因此，让客户相信时间和材料模式会起作用的一种方法可能是向他们保证，您会经常进行进度报告以获取他们的反馈。我相信这已经是大多数敏捷方法的核心建议。首先，这当然需要客户信任顾问。

作为一个单独的资源，我搜索并找到了一本关于这个主题的书：Mike Cohn 的“[敏捷估计和规划](https://rads.stackoverflow.com/amzn/click/com/0131479415)”。阅读该页面上来自一群令人印象深刻的敏捷专家的赞美语。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-05T20:20:57.667

首先，我想说我认为你向他推销了一种敏捷方法和按小时定价，这很棒。这很难做到。

关于您的困境，我认为您应该向他提供一个粗略的定价估计及其包含的功能/范围。在开发过程中，如果你看到一些重要的东西会改变范围/成本，你对客户说“停止——这很好，但要理解它改变了我们讨论的原始范围。”

在这一点上，客户有权同意，意识到他将支付比他最初想象的更多的钱，或者暂时停止新的开发。许多敏捷项目是在许多小阶段构建的——您可以为此给出非常准确的价格/时间估计。在任何新的小阶段开始之前，重要的是您和客户要就接下来发生的事情以及将花费多少时间/成本达成一致意见，这一点很重要。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-05T20:21:37.620

与往常一样，质量、功能和时间（=资源）是您的主要参数。我们不再搞质量问题，所以只剩下功能和资源了。通常，您可以说服一定数量的资源至少会达到某个功能集而侥幸逃脱。因此，只要您能找到大量资源来提供合理的功能集，我相信这对于相当多的客户来说已经足够了。好处是他们可以在移动时控制进度，并且总是可以选择退出。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-05T20:23:29.893

我这样做的方法是使用我当前的速度并根据对复杂性（故事数量）的粗略估计来估计一个范围。您将在开始规划应用程序时对其进行更新，以便范围估计逐渐变得越来越好。

例如，给出 6mos 到 2 年的估计（如果你确定它需要的时间少于 2 年。当你把它分解成特征，然后为这些特征做计划时，你会提出越来越好的估计，所以6mos 后你可以可靠地说（没有任何其他变化），我们将在另外 2-3 个月内完成（总共 8-9 个月）。最终，你可以说，我们会在下一次迭代后完成（2 周到 1 个月）。

您需要将此与让客户知道添加功能会增加完成时间相结合，然后让他们决定如何继续 - 要么放弃功能，要么增加时间。对于任何给定的项目，范围和时间确实是您可以有效改变的唯一变量。质量和资源几乎是固定的。实际上，您可以添加资源，但通常您最初会看到时间增加而质量下降，因此这仅在您的时间范围很长时才有效。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-05T20:26:33.727

这是一个非常棘手的问题。看看 Robert Glass 在他的“[软件工程的事实和谬误](https://rads.stackoverflow.com/amzn/click/com/0321117425)”一书中对这个主题的看法。（*请注意，亚马逊的新书价格低于二​​手书！[截至 2009-01-05 12:20 -08:00]；谷歌图书也有。*）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-05T20:28:01.523

您可以采取的一种方法是给客户一个您认为相对接近的一般估计。也给个百分比。由于需求的变化，该百分比将是预算中的增加或减少分配。

示例：一般估计为 10,000 美元，但由于要求不明确且项目可以轻松改变路线，因此可以选择 +/- 30% 的价格调整选项。

通过这种方式，客户可以大致了解预算内容，并且您可以灵活地为项目收费。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-11T18:01:14.460

如果您已经成功地向客户推销了敏捷方法，并按小时计费，**不要给他们估计完成项目的成本！**. 即使他们说他们只想要它用于预算目的，**也不要这样做！**.

原因是任何成本估算都将被视为明确的承诺；不管你说多少次不明白，客户说多少次他们明白这一点，都将被视为一种承诺。即使客户明白，他们的老板也不会明白，虽然他们不能合法地强迫你按你说的价格交货，但你会被称为一家没有兑现承诺的公司。提供估计首先会放弃敏捷的所有优势。

我的建议是告诉他们，在财政年度结束之前（或客户感兴趣的任何其他计费期），您将花费不超过某某金额。这应该足以让他们进行财务计划，而无需以任何方式说该项目将在那时完成。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-03-06T00:02:43.037

> 这是我对与故事点相关的[封闭问题的](https://stackoverflow.com/questions/2097557/how-to-change-to-use-story-points-for-estimations-in-scrum)[回答。](https://stackoverflow.com/questions/2097557/how-to-change-to-use-story-points-for-estimations-in-scrum/3764060#3764060)我一直用它来进行宏观估计。

当我切换到积分时，我决定只有满足以下两点；1）找到并论证证明转换的合理性并说服团队 2）找到一个简单的方法来使用它。

**令人信服**

我花了很多时间阅读这个主题，但最终找到了让我和我的团队信服的论点：几乎不可能找到两个程序员会同意一项任务所需的时间，但同样的两个程序员几乎总是会同意当显示两个不同的任务时，哪个任务最大。

这是您“估计”积压工作所需的唯一技能。在这里我使用了“估计”这个词，但在这个早期阶段，它更像是把积压工作从难到容易排序。

**在积压工作中加分**

这一步是在整个 Scrum 团队的参与下完成的。

开始在新的电子表格中一一删除故事，同时保持以下顺序：顶部最大的故事和底部的最小故事。这样做直到所有故事都在列表中。

现在是时候为这些故事加分了。我个人使用扑克计划量表 (1/2,1,2,3,5,8,13,20,40,100)，所以这就是我将用于此示例的内容。在该列表的底部，您可能会有微任务（需要 4 小时或更短时间完成的事情）。给每个微任务 1/2 的值。然后通过将值 1（在比例中的下一个）赋予故事继续列表，直到很明显故事更大（2 而不是 1，所以大两倍）。现在使用值“2”，继续往上看，直到找到一个显然应该是 3 而不是 2 的故事。继续这个过程直到列表的顶部。

注意：尽量将绝大多数分数保持在 1 到 13 之间。第一次你可能有一堆大故事（20、40 和 100），你必须将它们分解成小于或等于 13 的块.

这就是积分和原始积压。如果您有一个新故事，请将其与该列表进行比较，以查看它适合的位置（更大/更小的过程）并赋予其邻居的价值。

**速度与估计（宏观规划）**

要估计完成该积压工作需要多长时间，请进行第一个 sprint 计划。将附加到团队选择的故事和VOILA！的总点数相加，这是您的第一个速度度量。然后，您可以将积压中的总点数除以该速度，以了解需要多少 sprint。

该速度将在前 2-3 个 sprint 中发生变化并稳定下来，因此密切关注该值总是好的

# installation - 通过 SMS 将 MSI 推送到安装了 Windows XP SP3 的主机时出现问题

> ID：414357
> 
> 赞同：0
> 
> 时间：2009-01-05T20:17:35.863
> 
> 标签：installation, windows-installer, sms, windows-xp-sp3

我创建了一个安装我们的应用程序的 MSI。如果您在装有 Windows XP SP2 或 SP3 的机器上本地运行它，它可以正常安装。如果您通过 SMS 将它运行到装有 Windows XP SP2 的机器上，它可以正常安装。但是，如果您尝试通过 SMS 将它运行到装有 Windows XP SP3 的机器上，它似乎会停止并需要几个小时。（通过其他方法运行只需几分钟。）

有没有人知道为什么它在 SMS 和 XP SP3 上表现得这样？

**更新**

我们的 SMS 人员认为他们找到了问题所在。我们曾要求他们在安装前重新启动。他们说在 SP3 上，一些服务在安装程序运行之前没有启动。他们认为这是造成问题的原因。他们将尝试在安装开始之前重新启动后添加延迟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T22:17:13.143

Might you be able to turn on [windows installer logging](http://www.pctools.com/guides/registry/detail/1127) and see where things are getting held up? I'm not sure where the `%TEMP%` folder would be for the SMS/SYSTEM account tho...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T21:52:19.713

尝试检查系统的事件日志，因为您可能会在那里看到任何远程错误。如果没有任何显示似乎相关，请检查 SMS 生成的任何日志，看看您是否可以确定什么是滞留。

# asp.net - HTML 清理 - 错误的标记？

> ID：414366
> 
> 赞同：4
> 
> 时间：2009-01-05T20:21:49.960
> 
> 标签：asp.net, html

我一直在浏览一些关于清理 HTML 标记字符串以便在页面上重新显示的讨论（例如博客评论）。在过去，我只是单方面逃避了重新显示的标记。

有谁知道除了删除“不安全”标签之外是否有任何解决方案？

如果标记无效怎么办？例如，您如何防止和未关闭的 <b> 标签在页面上以粗体显示紧随其后的所有文本？

似乎 Stackoverflow 处理了这个问题。

未闭合的“b”标签示例

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T20:26:03.540

Stackoverflow 要么使用[纺织品](http://www.textism.com/tools/textile/)，要么使用非常类似的东西。

Textile 或多或少可以保证吐出有效的 (x)html，从而改善了清理用户输入的许多典型问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T21:16:46.900

检查此代码：

[清理 HTML](http://refactormycode.com/codes/333-sanitize-html)，我认为 StackOverflow 在某处使用它......

> 一种使用基于白名单的方法从提供的原始 HTML 输入中清理任何潜在危险标签的方法，留下“安全”的 HTML 标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-25T12:18:31.240

[Html Agility Pack](https://www.nuget.org/packages/HtmlAgilityPack)可能是一个很好的起点，因为它声称对格式错误和格式错误的 HTML 非常宽容。最重要的是，您可能需要制定一些规则来进行进一步的清理。最后，您将获得的 DOM 序列化回纯 HTML 代码。

我遇到了同样的问题，并在 Html Agility Pack 之上构建了这样一个基于规则的 HTML sanitizer。它允许您展平或删除标签，转换标签，例如用强标签替换b**并****限制**属性使用。[查看HtmlRuleSanitizer](https://github.com/Vereyon/HtmlRuleSanitizer)的源代码以获得想法，或者如果您想快速完成，只需获取[NuGet 包。](https://www.nuget.org/packages/Vereyon.Web.HtmlSanitizer/)

 **# php - php shell_exec() 通过 cygwin

> ID：414369
> 
> 赞同：2
> 
> 时间：2009-01-05T20:23:15.043
> 
> 标签：php, latex, cygwin, pdflatex, shell-exec

我编写了一个脚本，通过`pdftex`. 问题是`pdftex`只能在linux上运行。

我正在使用`shell_exec()`.

我真的没有能力将 linux 机器设置为 Web 服务器。我有我的客户端计算机，但它位于我无法控制的防火墙后面。我确实可以控制我的工作服务器，它运行 SBS 2003 和运行 apache 和 php 的 Windows 2000 虚拟机。据我所知，您无法`pdftex`在 Windows 中安装，如果可以，它也无法与`shell_exec()`.

有没有办法用cygwin解决这个问题？我可以在 cygwin 中安装 pdftex，然后配置 php 在 cygwin 中运行`shell_exec()`命令。如果这是可能的，有人能指出我正确的方向吗？

另外，我想知道是否有其他行动方案。我不介意购买主机，但任何共享主机计划都不支持该应用程序。它必须是虚拟或专用托管计划；我买不起的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-13T02:42:59.433

对于任何想通过 Cygwin 运行*的*`shell_exec()`人，请查看 PHP 手册中评论的链接：

[http://us.php.net/manual/en/function.shell-exec.php#68647](http://us.php.net/manual/en/function.shell-exec.php#68647)

```
 $result = shell_exec("C:\cygwin\bin\bash.exe --login  -c '/cygdrive/c/cygwin/bin/convert.exe --version'"); 
```

> 关键是“--login”选项，它将所有必需的通用 cygwin 二进制文件和库路径附加到 $PATH。如果没有此选项，某些链接到其他库的 cygwin 二进制文件（如链接到 X11 的 ImageMagick 二进制文件）将无法工作，您可能会看到诸如“找不到 cygX11-6.dll，无法启动 convert.exe”之类的错误

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T20:32:25.633

pdfTeX 在 Windows 上运行得很好，不需要 Cygwin。试试[MiKTeX](http://miktex.org/)。

# .net - Nhibernate外键到外键集合映射？

> ID：414377
> 
> 赞同：1
> 
> 时间：2009-01-05T20:24:42.807
> 
> 标签：.net, nhibernate, nhibernate-mapping

我有一个 Staff 和 e SecuredPage 实体，属性如下

## 职员

id Name LastName Level // SecuredPage.RoleId

## 安全页面

id PageId RoleId // Staff.Level

我想在 Staff 实体中有一个 SecuredPage 的集合，所以它是一对多的，但我不知道如何在映射中处理它。

员工.hbm.xml

```
<bag name="SecuredPages"  lazy="true" inverse="false" cascade="none">
      <key column="RoleId" />
      <many-to-many class="RealEstate.Core.Domain.SecuredPage,RealEstate.Core" />
</bag> 
```

使用上面的代码 Nhibernate 从 SecuredPage 表中获取所有记录，其中

```
SecuredPage.RoleId = Staff.id 
```

但我希望它是

```
SecurePage.RoleId = Staff.StaffLevel 
```

由于某些原因，我没有创建角色实体，这就是为什么我直接尝试根据其级别（角色）为员工获取安全页面

我希望我能告诉你我的问题。我检查了 Nhibernate 指南，阅读了有关集合映射的所有内容，但我无法弄清楚。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T20:32:24.120

我认为问题在于它并不是*真正*的一对多。实际上，这是多对多关系的一种表达方式。

我知道这听起来不像你想听到的（正如你所说你没有创建角色实体），但你可能想考虑这样做是为了你自己。

是否有一个“角色”表可以作为您提供的这两个表之间的交叉引用？

如果没有，您应该制作一个，这将有助于解决问题。如果是这样，您可能希望将员工和角色之间的关系视为直接关系，而将员工和 SecuredPages 视为间接关系（通过角色，确实如此）。

编辑：你能告诉我们为什么你没有创建一个“角色”实体吗？这可能有助于我们澄清。

# java - 错误对话框未被破坏

> ID：414388
> 
> 赞同：2
> 
> 时间：2009-01-05T20:27:39.247
> 
> 标签：java, validation, garbage-collection, jdialog, tablecelleditor

我正在开发一个项目，该项目使用 JTable 来显示日期列等。我们需要验证用户输入的日期，所以我实现了格式验证的掩码和实际日期验证的解析的组合。我已经使用日期列的自定义 CellEditor 完成了此操作。

在我的 MaskedCellEditor 中，我有一个 JFormattedTextField。我为日期设置了掩蔽。然后我添加一个 InputVerifier 以允许实际验证。我的 InputVerifier 实现 verify() 来检查： 1\. textField.isEditValid() 2\. DateValidator.ValidDate()。如果任一无效，则验证返回 false 并且 InputVerifier 将焦点锁定在文本字段（单元格编辑器）中，并显示一个小消息对话框，提醒用户注意日期格式。

错误消息是一个小的、未修饰的、非模态的、不可聚焦的 JDialog，它会在正在编辑的单元格下方弹出。它会在按键或成功的日期验证时消失。除了一个小的边缘情况外，它工作得很好。

如果用户在弹出对话框时选择了应用程序顶部的菜单按钮，则会切换屏幕，破坏当前屏幕上的所有内容（包括表格）。但是，由于正在显示对话框并且没有发生按键/成功编辑，因此该对话框永远不会隐藏。它在不同屏幕上的完全不相关的上下文中仍然可见。一旦用户关闭了带有表格的屏幕，用户就无法摆脱对话框。

我曾讨论过在对话框本身上抛出 Timer 和/或 MouseListener 会导致它消失，但我觉得我忽略了实际问题。该对话框永远不会被丢弃，我很确定它是因为它仍然设置为可见并且它阻止垃圾收集器摆脱它。

我在持有 JTable 的面板上有一个 Cleanup 方法，但我找不到一个好方法来引用对话框（InputVerifier 的一个组件）以摆脱它。该对话框与表格的父面板相距甚远。（面板 -> JTable -> CellEditor -> JFormattedTextField -> InputVerifier -> JDialog）

关于如何在表格被销毁时强制隐藏对话框的任何想法？如果您需要更多详细信息，请告诉我。我试图不让你们陷入细节中，但还有很多事情要做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T13:15:02.067

作为第一个想法，你能不能不去听听者的方法。如果您有一个 closeErrorDialog() 类型的方法，该方法在成功验证时被调用，那么您也可以在选择菜单操作时调用它。

作为替代方案，也许您可​​以以某种方式控制从菜单到菜单的转换，并创建一个“清理”方法，该方法将关闭任何现有的错误对话框。这将允许在更改菜单时需要执行的任何其他操作在同一位置发生。

只是我脑海中的一些快速想法。希望他们符合你的意思

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T20:33:13.027

很多人会因为我这样说而投票反对我，但听起来你的对话框应该是模态的，这样用户就不能在不先关闭它的情况下离开它。或者至少禁用允许人们在显示此对话框时切换的菜单。

# sql - 是否有免费的 SQL Server Mgmt Studio 自动完成插件？

> ID：414404
> 
> 赞同：10
> 
> 时间：2009-01-05T20:32:22.560
> 
> 标签：sql, sql-server, autocomplete, ssms

我知道 Red Gate 有这样的产品，但我宁愿不必为在我看来应该内置到 SSMS 中的东西付费。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-14T09:12:06.187

我正在使用[ApexSQL Complete](http://www.apexsql.com/sql_tools_complete.aspx)。它对于免费加载项来说非常好，但我发现它在使用链接服务器时存在一些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T20:41:24.820

我完全同意你的看法。可悲的是，我从未找到您所说的任何插件。因此，我从 EMS SQL Server Manager 和 TOAD for SQL Server 转向工具。我认为 SQL Server 2008 Studio 具有智能感知功能，但在 express 版本中，我发现它严重缺乏。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T20:59:05.970

如果您为开源开发，[Aqua Data Studio是免费的。](http://www.aquafold.com/)它适用于大多数数据库并具有智能感知功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-22T16:18:24.290

我的一位开发人员对 Simego 的[Sql Admin Studio](http://www.simego.com/products/Sql-Admin-Studio)发誓，当她提到它时，我正要从 RedGate 购买 SQLPrompt（非常好但价格昂贵）。它不是免费的，但价格为 29.95 美元，它还可以在两台服务器之间进行模式和数据差异。

当我有机会时，我会尝试一下。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-25T17:44:24.907

看看我们的[dbForge SQL Complete](http://www.devart.com/dbforge/sql/sqlcomplete/)。最近我们发布了 2.0 版本，现在有两个版本 - 免费 Express 和共享软件 Standard。

免费版具有足够的功能来完成与 T-SQL 格式化和自动完成相关的大多数任务，并支持 MS SQL Server 2000、2005 和 2008。

# java - 是否可以在 Java 中使用原始类型（int）作为泛型类型？

> ID：414408
> 
> 赞同：24
> 
> 时间：2009-01-05T20:33:20.107
> 
> 标签：java, generics, types, primitive

具体来说，我得到“此 ( ) 标记`SortedMap<Vector<String>, int>`之后的预期尺寸”。`int`帮助！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-05T20:34:41.900

不，这是不可能的。改为使用`Integer`。自动装箱负责其余的工作（即，在大多数情况下，您可以像实际使用过一样进行编程，`int`因为 Java 会`Integer`自动为您转换）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T20:54:48.130

康拉德是正确的。或者，您可以使用 trove 类 TObjectIntHashMap 将对象映射到原始整数。

# arrays - 在 J2ME 中从 txt 文件中解析数据

> ID：414409
> 
> 赞同：1
> 
> 时间：2009-01-05T20:33:22.090
> 
> 标签：arrays, parsing, text, java-me, tokenize

基本上我在 J2ME 中创建了一个室内导航系统。我已将位置详细信息放在 .txt 文件中，即

*   地点名称及其坐标。*   具有各自起始节点和结束节点的边以及权重（节点的长度）。

    我将这两个详细信息放在同一个文件中，这样用户就不必下载多个文件来让他们的地图工作（这可能会变得耗时并且看起来很复杂）。所以我所做的是通过首先输入位置名称和坐标来分隔不同的细节，然后我通过绘制一条带有多个下划线的线将该部分与下一部分分开，即边缘。

    现在我遇到的问题是通过设置命令（同时手动标记输入流）将不同的细节解析为单独的数组，以检查下一个标记是否是下划线。

    *   如果是，（在伪代码术语中），移动到流中的下一行，创建一个新数组并用下一组细节填充它。

    [我在这里](http://discussion.forum.nokia.com/forum/archive/index.php/t-60657.html)找到了一些解释/代码，它做了类似的事情，但仍然解析成一个数组，尽管它手动标记了输入。关于做什么的任何想法？谢谢

    ***文本文件说明***
    文本具有以下格式...

    <--1stSection-->
     /**
      * 第一节的格式如下
      * xCoordinate;yCoordinate;LocationName
      */

    12;13;纽约市
    40;12;华盛顿特区
    ...等

    ```
    _________________________ <--（下划线分隔符）
    ```

    <--2ndSection-->
     /**
      * 它实际上是一个邻接列表，但间接提供了“边缘”细节。
      * 它的形式
      * StartNode/MainReferencePoint;Endnode1;distance2endNode1;Endnode2;distance2endNode2;...等
      */

    费城;华盛顿特区;7;纽约市;2
    纽约市;佛罗里达;24;伊利诺伊州;71
    ...等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T05:40:13.760

```
package filereader;

import java.io.IOException;
import java.io.InputStream;
import java.util.Hashtable;
import java.util.Vector;

public class FileReader {
    String locationSection;
    String edgeSection;
    Vector locations;
    Vector edges;

    public FileReader(String fileName) {
        // read the contents into the string
        InputStream is = getClass().getResourceAsStream(fileName);
        StringBuffer sb = new StringBuffer();
        int ch;
        try {
            while ((ch = is.read()) != -1) {
                sb.append((char) ch);
            }
        } catch (IOException e2) {
            e2.printStackTrace();
        }
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
        String text = sb.toString();

        // separate locations and edges
        String separator = "_________________________";

        // read location section, without last end-of-line char
        int endLocationSection = text.indexOf(separator) - 1;
        locationSection = text.substring(0, endLocationSection);

        // read edges section, without end-of-line char after separator
        int startEdgeSection = endLocationSection + separator.length() + 3;
        edgeSection = text.substring(startEdgeSection, text.length());

        // parse locations and edges
        locations = getLocationsVector(locationSection);
        edges = getEdgesVector(edgeSection);
    }

    // parse locations section
    public Vector getLocationsVector(String section) {
        Vector result = new Vector();
        int startLine = 0;
        int endLine = section.indexOf('\n');
        while (endLine != -1) {
            String line = section.substring(startLine, endLine);
            result.addElement(parseLocationsLine(line, ';'));
            startLine = endLine + 1;
            if (endLine == section.length() - 1)
                break;
            endLine = section.indexOf('\n', startLine);
            // if no new line found, read to the end of string
            endLine = (-1 == endLine) ? section.length() - 1 : endLine;
        }
        return result;
    }

    // parse edges section
    public Vector getEdgesVector(String section) {
        Vector result = new Vector();
        int startLine = 0;
        int endLine = section.indexOf('\n');
        while (endLine != -1) {
            String line = section.substring(startLine, endLine - 1);
            result.addElement(parseEdgesLine(line, ';'));
            startLine = endLine + 1;
            if (endLine == section.length() + 1)
                break;
            endLine = section.indexOf('\n', startLine);
            // if no new line found, read to the end of string
            endLine = (-1 == endLine) ? section.length() + 1 : endLine;
        }
        return result;
    }

    // parse locations line
    public Hashtable parseLocationsLine(String value, char splitBy) {
        Hashtable result = new Hashtable();
        int xCEnd = value.indexOf(splitBy);
        int yCEnd = value.indexOf(splitBy, xCEnd + 1);
        result.put("x", value.substring(0, xCEnd));
        result.put("y", value.substring(xCEnd + 1, yCEnd));
        result.put("location", value.substring(yCEnd + 1, 
            value.length() - 1));
        return result;
    }

    // parse edges line
    public Hashtable parseEdgesLine(String value, char splitBy) {
        Hashtable result = new Hashtable();
        int snEnd = value.indexOf(splitBy);
        result.put("startnode", value.substring(0, snEnd));
        int n = 1;
        int start = snEnd + 1;
        int enEnd = value.indexOf(splitBy, snEnd + 1);
        int dstEnd = value.indexOf(splitBy, enEnd + 1);
        while (enEnd != -1 && dstEnd != -1) {
            result.put("endnode" + String.valueOf(n), 
                    value.substring(start, enEnd));
            result.put("distance" + String.valueOf(n), value.substring(
                    enEnd + 1, dstEnd));
            start = dstEnd + 1;
            enEnd = value.indexOf(splitBy, start);
            if (dstEnd == value.length())
                break;
            dstEnd = value.indexOf(splitBy, enEnd + 1);
            // if last endnode-distance pair, read to the end of line
            dstEnd = (-1 == dstEnd) ? value.length() : dstEnd;
            n++;
        }
        return result;
    }

    // getters for locations and edges
    public Vector getLocations() {
        return locations;
    }

    public Vector getEdges() {
        return edges;
    }

} 
```

在应用程序屏幕的某处：

```
fr = new FileReader("/map.txt");
Vector vct1 = fr.getLocations();
for (int i = 0; i < vct1.size(); i++) {
    Hashtable location = (Hashtable) vct1.elementAt(i);
    Enumeration en = location.keys();
    String fv = "";
    while (en.hasMoreElements()) {
        String key = (String) en.nextElement();
        String value = (String)location.get(key);
        fv = fv + value + "-";
    }
    this.add(new LabelField(fv));       

}
Vector vct2 = fr.getEdges();
for (int i = 0; i < vct2.size(); i++) {
    Hashtable location = (Hashtable) vct2.elementAt(i);
    Enumeration en = location.keys();
    String fv = "";
    while (en.hasMoreElements()) {
        String key = (String) en.nextElement();
        String value = (String)location.get(key);
        fv = fv + value + "-";
    }
    this.add(new LabelField(fv));       

} 
```

通过键从哈希表中获取值将很容易：

```
(String)location.get("x")  
(String)location.get("y")  
(String)location.get("location")  
(String)edge.get("startnode")  
(String)edge.get("endnode1")  
(String)edge.get("distance1")  
(String)edge.get("endnode2")  
(String)edge.get("distance2")  
... 
```

# nhibernate - 如何在 nhibernate 中映射更深层次的层次结构

> ID：414427
> 
> 赞同：2
> 
> 时间：2009-01-05T20:38:34.653
> 
> 标签：nhibernate, inheritance, nhibernate-mapping

我有这个对象图，我想映射：

*   抽象帐户（用户名，密码，...）
    *   抽象客户（购物车、订单、角色）
        *   个人客户（用户数据）
        *   CorporateCustomer（不同的用户数据、公司数据）
    *   管理员（管理员角色）

如何将其映射到一张表？（我知道如何使用只有 1 级深度的实体层次结构来做到这一点，就像在文档中一样，但这是不同的）。

有人有想法吗？我在 [http://groups.google.com/group/nhusers/browse_frm/thread/7a85cba0048c18d8?hl=en](http://groups.google.com/group/nhusers/browse_frm/thread/7a85cba0048c18d8?hl=en)中提出了同样的问题，但到目前为止还没有收到有用的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T21:31:48.243

据我所知，它应该与一层深层次结构没有什么不同。试试这个：

```
<hibernate-mapping> 
<class                                                     
    name="Account" 
    table="..." > 
    <property .../> 
        ... 
    <subclass                                              
        name="Customer" > 
        <property ... "/> 
        ... 
    </subclass> 

    <subclass                                              
        name="IndividualCustomer" > 
        <property ... "/> 
        ... 
    </subclass> 
    ... 
</class> 
```

我这里没有 NHibernate 来检查它，但它看起来应该可以工作。如果没有，您可能还想尝试嵌套子类元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T23:59:49.940

嵌套子类违反了 xml 模式，所以我的猜测是，它不会起作用。我可能还必须嵌套鉴别器声明，这似乎也很骇人听闻。

并将其映射出来...我传递了一个抽象类的鉴别器，因为抽象类无法实例化，所以它永远无法使用。似乎也错了。

但你是对的，我会尝试一段时间。*现在对我来说，让客户拥有*一个帐户而不是一个帐户似乎是一个更好的主意。

谢谢！

# database - 有人告诉我为什么我的数据库设计很愚蠢，以及如何修复它

> ID：414428
> 
> 赞同：2
> 
> 时间：2009-01-05T20:38:46.837
> 
> 标签：database, rdbms

所以我有这些车辆，它们有很多不同的类型。每种类型都有自己的表，具有许多属性。然后我有一个“车辆”表，其中包含每个表中所有车辆的 ID 和类型。车辆可以有照片，所以我有一个“照片”表，带有一个 vehicle_id，将照片链接到它所属的车辆。

现在每辆车都有一个设备列表，我将其作为 JSON 数组存储在单个“设备”列中。

像这样的东西：http: [//pastie.org/353195](http://pastie.org/353195)

我怎样才能更好地做到这一点，尤其是设备栏？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T20:45:29.723

我将有一个设备表，然后在车辆表和设备表之间建立一个连接表，其中包含设备 ID 和车辆 ID。

这为您提供了车辆和设备之间的多对多关系。

这将使查询和搜索具有特定设备的车辆变得更加容易，并且您的设备数据不会在您的 JSON 数据包中重复。您还可以更改设备类型，而无需更新大量 JSON 数据包。

将 JSON（或 XML）存储在数据库中通常是不好的，除非应用程序有一些固有的东西，例如需要可扩展的数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T20:48:27.707

除了装备栏，你的设计还不错。我建议有一个带有 id 和 name 的新表，然后是一个将车辆链接到它拥有的设备的表。

```
vehicles:
id | type
---------
1  | tank
2  | car
3  | boat
4  | car

equipment:
id | name
---------
1  | radio
2  | abs

vehicles_ equipment:
vehicles_id | equipment_id
2           | 1
2           | 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T20:45:40.270

您的设备表应该看起来更像您的照片表。vehile_id 列和设备列。然后您的客户端代码可以将设备放入 JSON 数组（或其他任何需要的内容）。您通常不应该在数据库中以 JSON 数组（或任何其他格式）存储内容。

如果您更进一步，您可以制作一个设备表，然后在车辆和设备之间创建多对多关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T20:47:37.363

为什么不让设备像其他人一样成为桌子？查询设备本身会很困难，你不能单独使用 SQL 来完成，总是需要一些客户端应用程序来反序列化它。

# sql - SQL - WHERE 中的 CASE 表达式

> ID：414431
> 
> 赞同：7
> 
> 时间：2009-01-05T20:39:12.547
> 
> 标签：sql, where-clause

我在这里阅读了有关在 WHERE 子句中使用 CASE 表达式的信息：

[http://scottelkin.com/sql/using-a-case-statement-in-a-sql-where-clause/](http://scottelkin.com/sql/using-a-case-statement-in-a-sql-where-clause/)

我正在尝试使用它来过滤我的 select 语句中的结果，基于将由用户应用程序传入的合同号。无论传入什么，我的代码当前都会引发“无效参数”错误。我验证 SELECT/FROM 工作正常，就像没有 CASE 表达式的 WHERE 子句一样。这是我的代码。

```
WHERE     (CASE WHEN @ContractNo = 0 THEN @ContractNo ELSE @ContractNo END =
tblContracts.ContractNo) 
```

代码的冗余是出于故障排除的目的，我计划稍后在 CASE 上使用通配符过滤。我现在专注于降低语法。我相信这应该返回参数与存储在表中的合同编号匹配的所有记录。任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-05T20:47:18.630

你确定你要这么做吗？您的案例陈述总是返回`@ContractNo`。我认为您正在寻找的是：

```
where 
    case @ContractNo 
        when 0 then tblContracts.ContractNo 
        else @ContractNo 
    end = tblContracts.ContractNo 
```

上面的过滤器说“给我一个`ContractNo`等于参数的合同，或者如果参数为0，则给我所有合同。

前面的过滤器只过滤合约编号字段与参数完全相等的地方。

无论如何，您应该这样做：

```
where @ContractNo = 0 or @ContractNo = tblContracts.ContractNo 
```

逻辑更容易理解，除此之外（不要引用我的话），优化器可能会在 case 语句之外更好地工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T21:15:27.713

阅读您的解释后，有一种更好的方法可以做到这一点`CASE`：

```
WHERE @ContractNo = 0 OR tblContracts.ContractNo = @ContractNo 
```

这将仅返回匹配的合同编号，除非`@ContractNo`为 0，在这种情况下它将返回所有记录。

**编辑：**我刚刚注意到[casperOne 提出了同样的事情](https://stackoverflow.com/questions/414431/sql-case-expression-inside-where/414454#414454)。我没看到。自己做大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T20:44:22.003

无论如何，请尝试忽略位于错误位置的括号 - 正确的括号应该在“END”之后。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T20:48:18.907

也许你忘了声明@ContractNo？它可以与 0 和 tblContracts.ContractNo 相媲美吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T20:44:58.587

将右括号移到 = 之前，如下所示：

```
WHERE     (CASE WHEN @ContractNo = 0 THEN @ContractNo ELSE @ContractNo END)=tblContracts.ContractNo 
```

我看不到这个case语句会做什么......如果@ContractNo = 0或者不是......你会返回同样的东西......

正确的语法是：

```
 Select...
  ...
  Where(
    Case
      When <Condition>
        Then <Return if true>
        Else <Return if false>
      End
 ) = <Whatever is being matched to the output of the case statement> 
```

不管语法如何，您的示例没有多大意义，如果您要查找所有匹配或合同编号为 0 的项目，那么您会这样做：

```
Select...
...
Where (
  @ContractNo = 0 Or
  @ContractNo = tblContracts.ContractNo
) 
```

这似乎比您尝试使用 case 语句更有意义。

**编辑：**我一定是稍微误读了这个问题 - 缺少的参数通常意味着参数（在本例中为 @ContractNo）未在您的查询/程序范围内声明。但是有人已经指出了这一点，所以我不能对此表示赞赏。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T21:05:58.700

case语句的原因，包括整个“如果为0，则给出参数，否则，只给出参数”是为了测试它以尝试使语法正确。最初，我曾尝试说“如果它是 0，则传入 '%'，以返回每个值。我在那里发布的代码是因为我不断收到 'Invalid Parameter' 并认为我的语法一定有问题。当我把它分成基本参数匹配，像这样，

```
WHERE @ContractNo = tblContracts.ContractNo 
```

它返回记录很好。让我再解释一下。

我从一堆不同的表中提取，并使用未包含在 select 语句中的信息过滤内容（即 tblContracts 没有由 Select 从中提取的信息，它仅在 Where 中使用）。用户将从具有不同合同编号以及默认值“全部”的组合框中进行选择。

当组合框的索引更改时，我将举办一个活动。如果是“全部”，0 将作为参数传入，我不希望进行过滤。否则，我只想要该合同号的信息（Else @ContractNo 的原因）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T21:22:28.120

Recursive 的帖子准确地解决了我的问题。

我看到有人抱怨我的原始帖子的清晰度。将来，我可以做些什么来使我所说的更直接？我不习惯用措辞表达有关代码的问题，并为它所拥有的任何混乱的事情道歉。我是否只需要像我的第二篇文章那样提供详细信息？

再次感谢所有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T20:46:17.990

你说的不是这样的吗？

```
SELECT * 
    FROM tblContracts
    WHERE     
    CASE 
       WHEN tblContracts.ContractNo = 0 THEN @ContractNo 
       ELSE tblContracts.ContractNo
    END = tblContracts.ContractNo 
```

其中@ContractNo 是与 tblContracts.ContractNo 具有相同数据类型的变量

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T20:47:28.050

为什么你甚至需要一个案例陈述？

WHen @ContractNo = 0 然后 ( 0 = tblContracts.ContractNo) 否则 @ContractNo 然后 (@ContractNo = tblContracts.ContractNo)

这是没有意义的，因为您可以简单地将其写为

其中@contractNo = tblContracts.contractNo

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-05T21:00:51.987

合同编号实际上是数字还是总是恰好是数字的字符串。检查表和参数以及 CASE 语句之间的数据类型（例如，“= 0”或“= '0'”）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-05T21:23:24.327

这种语法应该有效（它在 Oracle 中有效）

```
WHERE CASE WHEN tblContracts.ContractNo = 0 
           THEN @ContractNo 
           ELSE tblContracts.ContractNo
      END = tblContracts.ContractNo 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-05T21:38:26.840

当你说：

> 我从一堆不同的表中提取，并使用未包含在 select 语句中的信息过滤内容（即 tblContracts 没有由 Select 从中提取的信息，它仅在 Where 中使用）。用户将从具有不同合同编号以及默认值“全部”的组合框中进行选择。

然后在我看来应该有一个“在哪里存在”子句。因为你没有从那张桌子上拉出任何信息？！

# c# - 我是否在一个类中包含更多引用和命名空间有关系吗

> ID：414449
> 
> 赞同：3
> 
> 时间：2009-01-05T20:45:30.270
> 
> 标签：c#

例如：

```
using System;
using System.Web;
using System.Collections;
using System.Web.Services;
using System.Web.Services.Protocols;
using System.Web.Script.Serialization;
using System.Web.Script.Services;
using System.Web.Security;
using System.Data;
using System.IO;
using System.Net;
using System.Text;
using System.Xml;
using System.Xml.XPath;

using System.Web.Configuration;
using System.Collections.Generic; 
```

我继承的一个类中有类似的东西。我可以一一删除每个命名空间以查看类是否构建，但这有关系吗？

如果我不确定是否需要 System.Xml，我应该删除它吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-05T20:51:03.223

**一般来说**，他们所做的只是增加混乱。

但是，*在某些特定情况下*，它们可能会导致范围内重复名称或重复扩展方法的问题。例如，如果有类`Foo.SomeType`and `Bar.SomeType`，而你有`using Foo;`and `using Bar;`，那么对的引用`SomeType`就需要消除歧义。扩展方法的工作方式类似，不同命名空间中的静态类提供了冲突的扩展方法。

VS2008 工具（包括 express）包括删除不必要`using`语句的选项，这对于整理代码非常有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T20:56:34.647

一般来说，我喜欢删除未使用的 using 语句，因为它们会使代码变得混乱。

[ReSharper](https://www.jetbrains.com/resharper/)使未使用的 using 语句变灰。

[![替代文字](https://web.archive.org/web/20061025220507/http://codebetter.com:80/photos/jeffrey.palermo/images/147903/original.aspx)](https://web.archive.org/web/20061025220507/http://codebetter.com:80/photos/jeffrey.palermo/images/147903/original.aspx)

它还有一个右键菜单，用于“删除未使用的 using 语句”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T20:48:01.717

using 语句仅由编译器用于类型解析，因此如果不需要它们，请随意删除它们。拥有额外不会损害性能，删除它们只会稍微改善编译时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T20:50:59.447

如果具有类似名称的类存在于不同的命名空间中，则可能会使代码更难遵循。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T20:48:04.900

代码工具会告诉你它们是否是多余的。我会离开他们。他们不会造成任何伤害。（例如 Resharper）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T20:50:02.290

未使用的将在编译时删除，因此没有区别，不用担心。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T20:50:09.137

这可能是关于 using 语句性能的权威文章：[Do namespace using directives affect Assembly Loading?](http://www.hanselman.com/blog/BackToBasicsDoNamespaceUsingDirectivesAffectAssemblyLoading.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T20:50:19.807

它可能造成的唯一危害是，如果其中两个命名空间碰巧有一个同名的类：但此时，IDE 会警告您。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T21:14:12.567

过去，当我手动删除未使用的 INCLUDE 时，它对内存或速度没有影响。

正如其他人在这里提到的那样，可能存在冲突问题，但如果它们都是 .NET 类，我不会太担心。

# javascript - Google Analytics 如何将数据发送回 Google？

> ID：414451
> 
> 赞同：26
> 
> 时间：2009-01-05T20:45:40.363
> 
> 标签：javascript, google-analytics

也许我错过了一些东西，但我只是在学习 javascript。

我对单一来源政策的理解是谷歌分析不应该能够将数据发送回谷歌。

它如何能够在不违反政策的情况下向 Google 传输发送数据？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-05T20:59:21.600

据我所知，网页包含来自 Google 的 JavaScript 文件，然后该脚本会动态地将图像添加到包含日志记录所需信息的页面 ( [http://www.google-analytics.com/__utm.gif )。](http://www.google-analytics.com/__utm.gif)

SOP 不适用于动态添加到页面的脚本、图像或 CSS 文件。这就是为什么您非常信任您在网页中包含的任何 JavaScript 文件，因为它们将完全控制页面。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T19:32:25.760

瑞恩·多尔蒂是正确的。Google Analytics javascript 代码在您的页面上绘制一个透明的 1px×1px gif 图像名称 __utm.gif。当对该图像发出请求（位于 Google 的服务器上）时，信息将作为 GET 参数附加。Google 会捕获这些数据并开始处理它。通常在 3-6 小时内，您会看到数据显示在您的 GA 报告中。

# html - 如何在 Eclipse 中扩展颜色以着色语法

> ID：414466
> 
> 赞同：2
> 
> 时间：2009-01-05T20:48:19.860
> 
> 标签：html, syntax, highlighting

在 Eclipse 菜单中，我转到 Window -> Preference。然后，在首选项对话框中，我转到 Web -> HTML 文件 -> 编辑器 -> 语法着色。我有一些元素。对于这些元素，我可以定义我最喜欢的颜色和样式。但我只能为所有标签名称定义一种颜色。

有没有办法为不同的标签定义不同的颜色？例如，为`<script>`、`<a>`等分开颜色`<table>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T03:44:21.943

Triptych 是正确的，如果不编辑 Eclipse 的核心文件，就无法做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T20:55:05.680

我很确定你不能这样做，而且我必须说，这个想法冒犯了我的感受。

# ruby-on-rails - Rails：使用变量创建 HTML 片段？

> ID：414470
> 
> 赞同：2
> 
> 时间：2009-01-05T20:49:58.110
> 
> 标签：ruby-on-rails

我有一个提交按钮，它是一个 HTML 代码块，因为样式和图像使它看起来更好。（我从 Wufoo 那里偷了大部分）。

这是应用程序中的每一种形式，我想知道是否有更清洁的方法来做到这一点。像局部或助手之类的东西？

“提交”或“添加联系人”按钮的名称需要是一个变量。

# 片段

![](/images/icons/tick.png)添加联系人 #variable text ![](/images/icons/cross.png)返回

* 必填

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T21:08:14.467

考虑部分（[http://api.rubyonrails.org/classes/ActionView/Partials.html](http://api.rubyonrails.org/classes/ActionView/Partials.html)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T21:18:36.693

您可以为此使用应用程序范围的帮助程序。助手是包含由多个视图共享的方法的模块。您可以轻松定义自己的帮助器，其工作方式类似于生成按钮的[“submit_tag”帮助器方法。](http://rails.rubyonrails.com/classes/ActionView/Helpers/FormTagHelper.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T21:08:48.990

似乎是为某些东西而发明的。

# .net - ASP.NET MVC Globalization of Views

> ID：414477
> 
> 赞同：7
> 
> 时间：2009-01-05T20:50:45.550
> 
> 标签：.net, asp.net-mvc, globalization

I am looking at globalizing an application that I have developed in asp.net mvc.

I am currently using resource files to store messages that I present to the user (i.e., when I save something to the database, and the user is shown the message "The whatever was correctly saved", that text is stored in a resource file so that I can easily localize the message for another language.

The question I have is how to do this in a view as a whole? Right now, I've got some views that are mostly HTML with some small amount of presentation logic.

What is the best practice for localizing a view? I've taken a look here:

*   [http://damieng.com/blog/2008/04/27/localizing-mvc-for-aspnet-views-and-master-pages](http://damieng.com/blog/2008/04/27/localizing-mvc-for-aspnet-views-and-master-pages)

The approach in that post seems like an interesting way to go, but I wonder how easy it will be to maintain separate views for every language.

NOTE: I have not done much globalization or localization in asp.net generally, so there may be some best practices from the non-mvc world that I am missing.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T22:01:57.247

We ran into the same problem with our new MVC application [and our solution is here](http://oddiandeveloper.blogspot.com/2008/11/localization-with-aspnet-mvc.html). Maintaining separate views could be hard work, but maintaining the same view with different languages appears to be just as difficult, we decided that maintaining the whole view would give us more power, which would be required to make a release for Asian countries.

Hopefully it helps you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:25:14.647

Use an App_LocalResources for each view folder and place resources for each view in the folder and each culture.

More info [here](http://msdn.microsoft.com/en-us/library/ms247246(VS.80).aspx).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T13:47:34.217

You could try setting up your routes to be something like:

```
 RouteTable.Routes.MapRoute(
        "Globalization",
        "{localization}/{controller}/{action}/{id}",
        new { localization = "en-us", controller = "Globalization", action = "Index", id = "" }
        ); 
```

and then have localization as a parameter to your actions, just as id is a parameter.

# .net - .Net 1.1 中 AJAX 调用的最佳实践

> ID：414483
> 
> 赞同：4
> 
> 时间：2009-01-05T20:52:11.537
> 
> 标签：.net, jquery, ajax, .net-1.1

好吧，我的最新合同迫使我进入 .Net 1.1 的古老世界。

由于我已经使用 jQuery 和 Rails 很长一段时间了，所以 AJAX 之类的问题解决方案不断涌入我的脑海，我忍不住要写它们。

所以我相当直截了当的问题是我需要对记录执行 3 个操作（插入、更新和删除），我可以使用 ASP.Net 控件和 javascript 处理索引和显示。

我对我所有的 AJAX 东西都使用 jQuery。

我想这样做的方法是引入一个简单的 ASPX 页面，该页面充当这三个操作的控制器，为其提供一个贫乏的视图并使用字符串连接处理所有返回数据的呈现。这里有更好的模式吗？您是如何将 ajax 破解到 ASP.Net 1.1 中的？

我在[ajaxprojects](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=12)上看到了这篇文章，它使用了一种有点相似的技术，除了每个 ajax 操作只做 1 页。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T20:57:45.720

我们过去在经典 ASP 中使用 ajax，只需将 XML 消息发布到 ASP 页面，该页面将从请求正文加载 xml。

您可以使用 ASHX 页面（ASP.Net 处理程序）来执行此操作，您不会有任何页面对象的额外开销。因此，您基本上可以创建一个 Xml 有效负载（或 json 或您想要的任何内容）将其发布到 ashx 页面，该页面具有一个方法，该方法将检查请求执行您需要的内容并返回您需要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T01:35:30.030

离开 Web 控制范式越多，使用的视图状态越少，它就会变得越简单，这很神奇，但也是事实。但是，ASP.NET 开发使我们免受 HTML、CSS 和 JavaScript 的影响，而且很少有 ASP.NET 开发人员准备好立即直接处理它们，因此首先采取中间立场可能是最好的。

好消息是，ASP.NET 1.1 与 jQuery 配合得非常好，你可以做任何你想做的事情，从完全避免使用 web 控件和只使用带有 jQ​​uery 的原始 HTML，到充分利用 ASP.NET 并使用一点 jQuery例如，在客户端上进行验证，从而避免回发。

采取中间路线的一个示例可能是创建一个普通的数据网格，理想情况下在单独的页面上关闭，仅由一个表单元素（删除 runat=server）包围，或者可能只是一个 div 元素，并通过 jQuery 提供它ajax加载方法。

我个人不使用任何 Microsoft Ajax 库。每次我看到人们在示例中使用它们时，它们似乎只会使 jQuery 已经做的更简单、更快、更好的事情复杂化。这些东西很简单，不要在没有一些非常好的理由的情况下通过引入不必要的 MS 库和使用庞大的 XML 来使其变得丑陋和缓慢。我还亲自从所有页面中删除了所有 ViewState，并且还没有发现 ViewState 对我做任何有用的事情，而不仅仅是直接处理更简单和更有效。事实证明我们从来不需要它，但 Ajax 达成了交易。页面大小的减少与速度的相应增加是一个启示。更充分地生活在实际的 Web 范式中比生活在泄漏的 ASP.NET 魔法中要简单得多，也更好。

HTH。

麦克风

PS 哇，每个人都加入了更简单、更好的 Web 开发：[Controlling HTML in ASP.NET WebForms](http://polymorphicpodcast.com/shows/controlhtml)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T21:09:56.070

继续使用 jquery 滚动你自己不是一个坏主意，但显然你必须“重新发明轮子”在现有控件中创建基本的 ajax 支持。完成该项目的最快方法是追踪支持 .NET 1.1 的 Infragistic 控件的最新版本。

如果他们在 2007 年的软件包中仍然有 1.1 版本，我不会感到惊讶，因为它们的兼容性非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T22:34:14.153

我将[AjaxPro](http://www.ajaxpro.info/)用于我的 1.1 项目并取得了很大的成功。我使用的模型是建立用户控件来表示“视图”，然后在 ajax 请求中动态加载用户控件并调用控件上的 Render() 方法。

当您调用 Render() 时，它会将控件的 HTML 写入文本编写器，然后您可以通过 ajax 调用返回到客户端并插入占位符 div。

# c# - asp.net：在 Internet Explorer 中工作时，会话中的数据可用，但在 Opera 中不可用

> ID：414488
> 
> 赞同：1
> 
> 时间：2009-01-05T20:54:18.910
> 
> 标签：c#, asp.net, session, opera

这是一件非常奇怪的事情——我有一个在 maxthon（基于 Internet Explorer 的浏览器）中完美运行的网站。我在opera中启动它，发现放在一个站点上的Session字典中的数据在另一个站点上不可用......我的意思是我有Welcome.aspx，当您单击下一步时，将执行以下代码：

```
Session["sessionData"] = sessionData;
Response.Redirect("~/Models.aspx"); 
```

在调试时，我可以看到在 Opera 中执行时，models.aspx 会话为空，但在 maxthon 中执行时一切正常。有没有人知道什么是错的？因为我一无所知..这是一些歌剧偏好的东西还是代码中的东西？

编辑：我检查了 Session.IsNewSession 并在 maxthon 中执行时 isnewsession 设置为 false 但在歌剧中它是真的。似乎在歌剧中移动到新页面时它会以某种方式创建新会话......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T20:56:30.840

ASP.NET 会话由在浏览器中保存为 cookie 的密钥存储。检查 Opera 以查看它是否接受 cookie - 它需要以使 ASP.NET 会话正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T20:58:00.777

也许您在 Opera 中禁用了 cookie。会话通过在 cookie 中存储标识符来工作（除非在 web.config 中指定为 cookieless）。如果浏览器不允许访问，服务器将无法定位数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T21:06:02.803

如果您在第一次点击时编写会话，那么您应该这样做

```
Response.Redirect("nextpage.asp", false); 
```

否则它不会写入整个响应流，并且 cookie 可能还没有被写入。相反，您可以选择进行无烹饪会话。但是随后您对会话劫持持开放态度。

# javascript - 我从哪里开始学习所有不同的 JavaScript 技术/库？

> ID：414494
> 
> 赞同：12
> 
> 时间：2009-01-05T20:56:35.770
> 
> 标签：javascript

我正在构建一个介于 StackOverflow 和 Digg 之间的网站（只是不同的类型）。通常，在过去，我只是使用 ASP.Net Web 表单构建它。但是我想用这个项目作为学习新技术的一种方式。我正在使用非常棒的 ASP.Net Mvc，但我需要学习/使用某种 javascript 库。

例如，当有人对帖子投票时，我希望它立即更新投票计数，或者如果有人在“标签”文本框中输入文本，我希望它提供当前使用的标签等的下拉列表。基本上我想为我的网站提供很多 AJAXy 的东西。

所以我的问题是我从哪里开始？我感到被如此多的选择轰炸，我不知道从哪里开始，甚至不知道它们是什么。有人可以理顺我并提供一些解释和方向吗？

*   JSON
*   jQuery
*   微软AJAX

我敢肯定，我现在还记得很多其他人。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-05T21:14:13.770

您绝对应该从 Javascript 的基础知识开始。从在页面上打印“Hello World”之类的东西开始。继续学习基本的语言特性，如变量、循环、条件和函数。我推荐[W3Schools Introduction to Javascript](http://www.w3schools.com/jS/js_intro.asp "W3Schools Javascript 简介")。不要太着迷于尝试用 Javascript 进行面向对象的编程。即使对于一些经验丰富的 Javascript 程序员来说，这也是痛苦和困惑的。

接下来，我强​​烈建议学习使用跨浏览器 Javascript 库，而不是尝试手动完成所有事情（特别是：与[DOM](http://en.wikipedia.org/wiki/Document_Object_Model "DOM")交互、执行[XmlHttpRequests](http://en.wikipedia.org/wiki/XHR "XmlHttpRequests") aka AJAX 调用等）。我推荐[jQuery 库](http://www.jquery.com "jQuery 库")。它为您想要做的所有很酷的 AJAX-y 事情提供了坚实的基础，并且有大量可用的[插件](http://plugins.jquery.com/ "jQuery 插件")。

**jQuery 是一个 Javascript 框架，它允许与文档对象模型(DOM)**进行简单可靠的交互。**简单来说，DOM 是网页中所有 HTML 元素的表示。DOM 因浏览器而异，“手动”与它交互既乏味又容易出错。jQuery 基本上通过在幕后完成所有艰苦的工作来解决这个问题。实际上，它比这更强大，但这是主要功能。它还提供对页面事件、自定义事件、插件、CSS 操作等的支持。**

 **[JSON](http://www.json.org/ "JSON")是您提到的另一个术语。它代表 JavaScript 对象表示法。**JSON 只是一种在 Javascript**（实际上也包括其他语言）中表示结构的轻量级方式。老实说，[Wikipedia JSON 文章](http://en.wikipedia.org/wiki/JSON "维基百科 JSON 页面")对 JSON 如何与 AJAX 一起使用提供了比我以往任何时候都更好的总结，因此您可能想[阅读一下](http://en.wikipedia.org/wiki/JSON "维基百科 JSON 页面")。

以下是事件的基本顺序：

1.  您的 Javascript 代码对网页进行 AJAX 调用。您可以使用 jQuery 中的 AJAX 函数来执行此操作。
2.  该网页生成的结果是一个 JSON 对象。例如，它可能会生成一个如下所示的字符串：`{ 'firstname':'Robert', 'lastname':'Smith' }`
3.  结果由您的 AJAX 调用接收并使用特殊的 Javascript“eval”函数进行评估。
4.  您留下了一个可以在代码中使用的本机 Javascript 对象。然后，您可以执行以下操作：`document.write('Hello ' + result.firstname + ' ' + result.lastname)`

以下是我在过去一年左右收集的一些有用的链接，它们对我有所帮助。我希望他们也能帮助你！

*   [jQuery 是如何工作的](http://docs.jquery.com/How_jQuery_Works "jQuery 是如何工作的")
*   [jQuery 插件](http://plugins.jquery.com/ "jQuery 插件")
*   [20 个惊人的 jQuery 插件和 65 个优秀的 jQuery 资源](http://speckyboy.com/2008/07/21/20-amazing-jquery-plugins-and-65-excellent-jquery-resources/ "20 个惊人的 jQuery 插件和 65 个优秀的 jQuery 资源")
*   [75 个（真的）有用的 JavaScript 技术](http://www.smashingmagazine.com/2008/09/11/75-really-useful-javascript-techniques/ "75 个（真的）有用的 JavaScript 技术")
*   [自动完成教程](http://nodstrum.com/2007/09/19/autocompleter/ "自动完成教程")

要记住的最重要的事情是：**边做边学**。实验。尝试新事物。制作一堆概念证明页面。使用 Javascript，这确实是让您的脚湿透的最佳方式。祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T21:08:17.353

首先学习 Javascript 的基础知识。在深入了解更深层次的抽象之前，了解如何使用它的内部结构非常重要。Mozila 有[一个很棒](http://developer.mozilla.org/en/JavaScript)的 Javascript 资源，包括[概述指南](http://developer.mozilla.org/en/Core_JavaScript_1.5_Guide)。

接下来，选择一个好的框架，它将帮助您执行大量的 DOM 操作，这正是 Javascript 的常用用途。框架将在跨浏览器实现差异上节省大量时间，并为开发提供良好的基础。这里有很多选择，您可以选择任何一种流行的选择。就个人而言，我选择[jQuery](http://jquery.com/)是因为它简洁的 API 和出色的插件库。

在此过程中，您将了解不同特征/符号的定义，例如[JSON](http://www.json.org/)（表示 Javascript 对象符号，用于在 Javascript 中定义可移植数据结构）。对于您有任何具体问题，您可以随时 google 或回到 SO ;)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T21:05:31.883

在使用 javascript 时，我一直发现[rhino book](http://oreilly.com/catalog/9780596101992/?CMP=AFC-ak_book&ATT=JavaScript%3A+The+Definitive+Guide)是我的朋友。尽管它没有涵盖华而不实的框架，但感觉就像它始终作为骨干教程/参考资料存在，并且涵盖了所有内容。最新版本还涵盖了 ajax 的内容。

这本书我有不少于 3 个版本，而且它们看起来都很破旧而且很好用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T21:06:09.200

简短的回答：我认为你从 jQuery 开始。

长答案：JSON 不是一个库，它是一种数据格式，而且很简单。如果您完全熟悉 javascript，它应该是自然而然的 - 学习是*必不可少*的，但不会花很长时间。jQuery 正在成为事实上的标准库，包括 MS 和其他大玩家。上手非常简单，您会发现大量的社区支持，尤其是在这里。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T21:33:41.047

JSON

JSON 是一种数据格式，类似于 XML，但它是 Javascript 的原生格式。您可以 eval() 它，它成为一个实际的对象（更确切地说，是一个哈希表）。它是 XML 在页面上来回异步发送数据的理想替代品，因为它不需要解析器并且占用空间更小。对于服务器端，有许多 JSON 库，例如 JsonFx Serializer，可帮助您在服务器上序列化/反序列化 JSON。更多信息，包括[http://www.json.org/](http://www.json.org/)上多个 JSON 库的链接。请注意，还有一些可选的 Javascript 库用于处理 JSON，也在 json.org。

jQuery

jQuery 正迅速成为终极的 Javascript 工具库。它实际上是第一个，如果不是第一个，微软已经采用并作为核心组件纳入其开发产品线的第三方开源软件（用于 Visual Studio 2010 和 ASP.NET AJAX 4.0）。这绝对是您想要学习的库，但在您首先完全掌握 Javascript 的基础知识之前。

微软AJAX

Microsoft ASP.NET AJAX 基本上是一组对 ASP.NET Web 窗体的扩展，它们通过执行回发到服务器而不刷新整个页面来促进 AJAX 功能。不止于此；它还有一个扩展的 Javascript 库（Microsoft AJAX 库，我相信它被称为“MS-AJAX”），它为 Javascript 提供了许多类似 .NET 的 OOP 功能，并且它不需要 ASP.NET要使用的 AJAX。Microsoft AJAX 库（Javascript 库）不是一件坏事，但也不是必须的。然而，ASP.NET AJAX 基于 ASP.NET Web 窗体，因此它与 ASP.NET MVC 不兼容。您可以使用 Javascript 库，但不能完全使用；再说一遍，没必要

简而言之，学习 Javascript 本身（如果你还没有的话），学习 DOM 操作/DHTML 基础知识，然后学习 jQuery，我想你会准备好的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-05T23:21:30.673

不要错过这个： [http ://ajaxpatterns.org/](http://ajaxpatterns.org/)

它全面涵盖了您可能在*任何*库中的 AJAX 开发中使用的所有概念和设计模式。它还包括对所有 AJAX 库的回顾。该站点将为您提供全局，而不仅仅是教您一个特定的库。

我个人喜欢 ExtJS AJAX Lib [http://extjs.com](http://extjs.com)。在审查了市场后，我在一个研究项目上使用了 6 个月。我特别喜欢它出色的 UI 小部件套件。查看他们的演示。这个库最初基于 Yahoo UI，但现在有更多。他们现在已经将它与谷歌网络工具包集成（我几乎选择了它，但缺少像样的小部件）。

像 jQuery 这样的库在这个旁边看起来很小而且不完整。Dojo 有一些很棒的东西，但集成度不高，代码质量也不高（恕我直言）。对某些人来说，不利的一面可能是 GPL / 商业许可条款（最初是 LGPL，转向 GPL 引起了一些争议）。

[在http://delicious.com/tohagan/ajax](http://delicious.com/tohagan/ajax)查看我的 AJAX 资源链接的其余部分 ......享受吧！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T21:18:30.330

首先学习基础知识，然后选择一个框架来学习 Ajax 的东西 - 有这么多，没有理由再手动做。我第二（第三？第五？）学习jQuery；它看起来真的很甜。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T21:39:40.473

我想向[Yahoo 用户界面库](http://developer.yahoo.com/yui/)添加一个大喊大叫，它提供了 jQuery 等库所做的许多基本“标准化”层（例如 DOM 操作、事件处理等）以及相当不错的小部件集合。

它可能没有如此简洁的语法，但它有很好的文档记录——包括许多其他值得一读的优秀材料——并且有大量的例子。

我觉得值得指出，以便人们考虑多种选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T21:03:05.210

我会选择 jQuery，最近它越来越受到关注，你会发现更好的起点/教程/已经完成的事情。

但是如果你更渴望学习 Javascript，那么你不应该担心框架并首先学习语言基础......然后使用框架来帮助你更快更好地做事。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-05T21:05:33.273

JSON 不是库，所以不用担心。

MS-AJAX 是一个非常特殊的工具，所以我也不会打扰，除非您已经是 ASP.NET 专家。

我建议你从纯 Javascript 开始，当你对它感到满意时，试试 jQuery 之类的东西，这很棒，还有 John Resig 的“Pro Javascript Techniques”，它会很好地扭曲你的想法。当我阅读这本书时，我在每 2 页都说“哇，这真的很酷”。

*但重要的是首先获得基础知识*，所以前往 w3schools 或在商店购买一本不错的 JavaScript 书籍。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-05T21:08:35.403

jQuery 有一个明显的好处，它得到了 Microsoft 的支持，所以如果您使用 SO 技术，那将是一个很好的起点（使用 jquery 站点教程）。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-05T22:08:55.267

如果您这样做“只是为了好玩”，您可能应该在这里阅读其他答案。如果您专注于结果，最好从现有的代码库开始，例如[Stacked](http://code.google.com/p/stacked/)可以为您提供。Stacked 是 StackOverflow 的开源实现，为了更“灵活”而创建了一些差异。例如支持多个数据库、大量配置等...

顺便说一句，我确实使用 Stacked ...

# c# - 为什么在 ListView 中保存（OnItemUpdating 事件）第一个编辑项时出现空对象引用错误？

> ID：414502
> 
> 赞同：1
> 
> 时间：2009-01-05T20:58:03.257
> 
> 标签：c#, asp.net, listview, asp.net-3.5

我收到错误“对象引用未设置为对象的实例”。在 ListView 中触发 Update 事件后，在 OnItemUpdating 事件期间尝试从 EditItem 引用 HiddenField（lvEditProjectSteps_hdnStepStatusId 以供将来参考）时。这只发生在 ListView 中的第一个项目上。我检查了源代码，并且 HTML 正在正确呈现。

任何见解都值得赞赏！提前致谢...

源错误：

```
var lvEditProjectSteps_hdnStepStatusId = (HiddenField) lvEditProjectSteps.EditItem.FindControl("lvEditProjectSteps_hdnStepStatusId"); 
```

这是 ListView 的 aspx 端：

```
<asp:ListView ID="lvEditProjectSteps" runat="server"
  OnItemDataBound="lvEditProjectSteps_OnItemDataBound" 
  OnItemUpdating="lvEditProjectSteps_OnItemUpdating" 
  DataSourceID="odsEditProjectStep" 
  DataKeyNames="Id">
  <LayoutTemplate>
    <table class="standard-box-style" style="width:800px">
      <thead>
        <tr>
          <th>&nbsp;</th>
          <th>&nbsp;</th>
          <th>Created</th>
          <th>Updated</th>
        </tr>
      </thead>
      <tbody>
        <asp:PlaceHolder ID="itemPlaceHolder" runat="server" />
      </tbody>
    </table>
  </LayoutTemplate>
  <ItemTemplate>
    <tr>
      <td style="width:50px"<%# (Container.DisplayIndex % 2 == 0)?"":" class=\"row-alternating\"" %>>
        <asp:ImageButton ID="lvEditProjectSteps_btnEdit" runat="server" 
          ImageUrl="~/admin/images/icons/edit.gif" 
          AlternateText="Edit" 
          SkinID="interfaceButton"
          CommandName="Edit" />
        <asp:HiddenField ID="lvEditProjectSteps_hdnId" runat="server" Value='<%# Bind("Id")%>' />
        <asp:HiddenField ID="lvEditProjectSteps_hdnStepStatusId" runat="server" Value='<%# Bind("StepStatusId")%>' />
        <asp:HiddenField ID="lvEditProjectSteps_hdnStepStatusStepId" runat="server" Value='<%# Bind("StepStatus_StepId")%>' />
      </td>
      <td style="width:30px"<%# (Container.DisplayIndex % 2 == 0)?"":" class=\"row-alternating\"" %>><asp:Image ID="imgStatus" runat="server" /></td>
      <td style="width:75px"<%# (Container.DisplayIndex % 2 == 0)?"":" class=\"row-alternating\"" %>><asp:Literal ID="litTsCreated" runat="server" /></td>
      <td style="width:75px"<%# (Container.DisplayIndex % 2 == 0)?"":" class=\"row-alternating\"" %>><asp:Literal ID="litTsUpdated" runat="server" /></td>
    </tr>
  </ItemTemplate>
  <EditItemTemplate>
    <tr>
      <td style="width:50px"<%# (Container.DisplayIndex % 2 == 0)?"":" class=\"row-alternating\"" %>>
        <asp:ImageButton ID="lvEditProjectSteps_btnUpdate" runat="server" 
          ImageUrl="~/admin/images/icons/save.png" 
          AlternateText="Save" 
          SkinID="interfaceButton"
          CommandName="Update" 
          ValidationGroup="EditProjectStepsSave" />
        <asp:ImageButton ID="lvEditProjectSteps_btnCancel" runat="server" 
          ImageUrl="~/admin/images/icons/cancel.png" 
          AlternateText="Cancel" 
          SkinID="interfaceButton"
          CommandName="Cancel" />
        <asp:HiddenField ID="lvEditProjectSteps_hdnId" runat="server" Value='<%# Bind("Id")%>' />
        <asp:HiddenField ID="lvEditProjectSteps_hdnStepStatusId" runat="server" Value='<%# Bind("StepStatusId")%>' />
        <asp:HiddenField ID="lvEditProjectSteps_hdnStepStatusStepId" runat="server" Value='<%# Bind("StepStatus_StepId")%>' />
      </td>
      <td style="width:180px" colspan="3"<%# (Container.DisplayIndex % 2 == 0)?"":" class=\"row-alternating\"" %>>
        <div><strong>Status</strong></div>
        <div class="radiobuttonlist-status">
          <asp:RadioButtonList ID="lvEditProjectSteps_rblStatus" runat="server"     
            RepeatDirection="Horizontal"    
            AutoPostBack="true"
            OnSelectedIndexChanged="lvEditProjectSteps_rblStatus_OnSelectedIndexChanged">
            <asp:ListItem Value="1"><img src="/images/icon/project-status/1.png" alt="Error" /></asp:ListItem>
            <asp:ListItem Value="2"><img src="/images/icon/project-status/2.png" alt="In Progress" /></asp:ListItem>
            <asp:ListItem Value="3"><img src="/images/icon/project-status/3.png" alt="Complete" /></asp:ListItem>
          </asp:RadioButtonList>
          <asp:RequiredFieldValidator ID="valRequired_lvEditProjectSteps_rblStatus" runat="server" 
            ControlToValidate="lvEditProjectSteps_rblStatus" 
            SetFocusOnError="true"
            Display="Dynamic" 
            ErrorMessage="<br />^ required ^" 
            ValidationGroup="EditProjectStepsSave" />
        </div>
      </td>
    </tr>
  </EditItemTemplate>
</asp:ListView> 
```

和代码隐藏：

```
protected void lvEditProjectSteps_OnItemDataBound(object sender, ListViewItemEventArgs e)
{
  if (e.Item.ItemType == ListViewItemType.DataItem)
  {
    var info = (ProjectStepInfo)DataBinder.GetDataItem(e.Item);

    // View Item
    var litTsCreated = (Literal)e.Item.FindControl("litTsCreated");
    var litTsUpdated = (Literal)e.Item.FindControl("litTsUpdated");
    var imgStatus = (Image) e.Item.FindControl("imgStatus");

    if (litTsCreated != null) litTsCreated.Text = String.Format("{0:d}", info.TsCreated);
    if (litTsUpdated != null) litTsUpdated.Text = String.Format("{0:d}", info.TsCreated);
    if (imgStatus != null) imgStatus.ImageUrl = String.Format("/images/icon/project-status/{0}.png", info.StepStatus_StatusId);

    // Edit Item
    var lvEditProjectSteps_rblStatus = (RadioButtonList) e.Item.FindControl("lvEditProjectSteps_rblStatus");
    if (lvEditProjectSteps_rblStatus != null) lvEditProjectSteps_rblStatus.SelectedValue = info.StepStatus_StatusId.ToString();
  }
}
protected void lvEditProjectSteps_OnItemUpdating(object sender, ListViewUpdateEventArgs e)
{
  if (IsValid)
  {
    var oController = new Controller();
    var lvEditProjectSteps_hdnStepStatusId = (HiddenField) lvEditProjectSteps.EditItem.FindControl("lvEditProjectSteps_hdnStepStatusId");
    var lvEditProjectSteps_hdnStepStatusStepId = (HiddenField) lvEditProjectSteps.EditItem.FindControl("lvEditProjectSteps_hdnStepStatusStepId");
    var lvEditProjectSteps_rblStatus = (RadioButtonList) lvEditProjectSteps.EditItem.FindControl("lvEditProjectSteps_rblStatus");
    var infoStepStatus = oController.StepStatus_SelectOne_StepId_StatusId(Convert.ToInt32(lvEditProjectSteps_hdnStepStatusStepId.Value), Convert.ToInt32(lvEditProjectSteps_rblStatus.SelectedValue));
    if (lvEditProjectSteps_hdnStepStatusId != null)
    {
      e.NewValues["ProjectId"] = Convert.ToInt32(lvEditProjectSteps_hdnProjectId.Value);
      e.NewValues["StepStatusId"] = infoStepStatus.Id;
    }
    else
    {
      Response.Write("cancel");
      e.Cancel = true;
    }
  }
  else
  {
    Response.Write("cancel, not valid");
    e.Cancel = true;
  }
}
protected void lvEditProjectSteps_rblStatus_OnSelectedIndexChanged(object sender, EventArgs e)
{
  var oController = new Controller();
  var rbl = (RadioButtonList)sender;
  var lvEditProjectSteps_txtText = (TextBox) rbl.NamingContainer.FindControl("lvEditProjectSteps_txtText");
  var lvEditProjectSteps_txtComment = (TextBox)rbl.NamingContainer.FindControl("lvEditProjectSteps_txtComment");
  var lvEditProjectSteps_hdnStepStatusStepId = (HiddenField) rbl.NamingContainer.FindControl("lvEditProjectSteps_hdnStepStatusStepId");
  if (!String.IsNullOrEmpty(lvEditProjectSteps_hdnStepStatusStepId.Value) && lvEditProjectSteps_txtText != null && lvEditProjectSteps_txtComment != null)
  {
    var infoStep = oController.Step_SelectOne(Convert.ToInt32(lvEditProjectSteps_hdnStepStatusStepId.Value));
    var infoStepStatus = oController.StepStatus_SelectOne_StepId_StatusId(Convert.ToInt32(lvEditProjectSteps_hdnStepStatusStepId.Value), Convert.ToInt32(rbl.SelectedValue));

    lvEditProjectSteps_txtText.Text = infoStep.Name;
    lvEditProjectSteps_txtComment.Text = infoStepStatus.Text;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T03:16:01.963

我解决了我自己的问题。选择这样的编辑 ListViewItem 时似乎存在错误（使用上面的示例）：

```
lvEditProjectSteps.EditItem 
```

但不是当您使用此方法时：

```
lvEditProjectSteps.Items[lvEditProjectSteps.EditIndex] 
```

希望这对其他人有帮助。

# javascript - 如何设置 Dojo Objective Harness 测试用例结构来测试自定义代码？

> ID：414527
> 
> 赞同：7
> 
> 时间：2009-01-05T21:06:39.807
> 
> 标签：javascript, tdd, dojo

我正在考虑使用 Dojo Objective Harness (DOH) 来测试一些自定义 JavaScript 代码。为此，我阅读了以下文章：

[http://www.ibm.com/developerworks/web/library/wa-aj-doh/index.html](http://www.ibm.com/developerworks/web/library/wa-aj-doh/index.html)

我对测试用例结构有疑问。该示例显示您的测试用例模块与 dojo 位于同一父目录中。这对我们来说有点问题，因为我们想在多个项目中使用 DOH，而不必在每个项目中都包含 dojo。

有谁知道设置 DOH 以使用以下结构的方法：

*   dojotoolkit
    *   道场
    *   迪吉特
    *   dojox
    *   实用程序
*   项目1
    *   源代码
    *   测试
*   项目2
    *   源代码
    *   测试

谢谢...

西蒙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T07:44:46.743

首先让我参考[我之前的答案](https://stackoverflow.com/questions/300855/looking-for-a-better-unit-test-tool-for-javascript#300915)——它包含一些你想先阅读的有用链接。

DOH 可以与 Dojo 分开使用，您所需要的只是 DOH 所在的“util”项目。它具有零 Dojo 依赖项。为了为您自己的代码设置它，只需看看 Dojo 是如何做到的。通常主文件称为runTests.html。它几乎是一个样板，我只是将它复制过来，并修改其中的 URL 以指向我自己的测试模块。例如，[Dojo Core 测试的 runTests.html](http://bugs.dojotoolkit.org/browser/dojo/trunk/tests/runTests.html)使用“dojo.tests.module”⇒ [dojo/tests/module.js](http://bugs.dojotoolkit.org/browser/dojo/trunk/tests/module.js)。通常我的目录是 Dojo 的对等目录，所以它类似于位于 my/tests/module.js 中的“my.tests.module”或我决定命名的任何内容。

查看 Dojo 的 module.js — 它包含使用的其他 JavaScript 文件`dojo.require()`（您可以在没有 Dojo 的情况下使用 DOH 包含和注册您的文件）。可以包含来自不同级别的文件，或者您可以包含包含更多文件的文件（如[dojo.tests._base](http://bugs.dojotoolkit.org/browser/dojo/trunk/tests/_base.js)）。这是进行模块化单元测试的方法。

也可以包含 HTML 文件。例如，[dojo.tests._base.html 就是](http://bugs.dojotoolkit.org/browser/dojo/trunk/tests/_base/html.js)这样做的。

简而言之：很简单，只需阅读文档，并使用现有的 Dojo 测试作为备忘单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T13:57:21.777

This article Unit Testing Custom Code with the Dojo Objective Harness [http://www.sitepen.com/blog/2008/04/15/unit-testing-custom-code-with-the-dojo-objective-harness/](http://www.sitepen.com/blog/2008/04/15/unit-testing-custom-code-with-the-dojo-objective-harness/) should give you what you need. It describes how to write unit tests for custom code in custom places.

# c# - 如何使用 RegEx 匹配 C# 中的字符串列表？

> ID：414528
> 
> 赞同：1
> 
> 时间：2009-01-05T21:06:49.103
> 
> 标签：c#, regex

我需要从字符串列表中找到所有正则表达式匹配项。例如，我需要能够获取字符串“This foo is a foobar”并匹配“foo”或“bar”的任何实例。正确的模式是什么？另外，我需要做些什么输入卫生来防止输入的文本破坏模式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T21:25:53.653

我有点不确定你的实际问题是什么。要匹配“foo”或“bar”，你只需要`"foo|bar"`你的模式。如果您想对字符串列表执行此操作，您可能希望单独检查每个字符串 - 您可以先*连接*字符串并检查*，*但我不确定这会有多大用处。如果您想获得与您的模式匹配的确切文本，您应该将模式括在括号中——例如`"([fg]oo|[bt]ar)"`，将匹配“foo”、“goo”、“bar”或“tar”——然后`Groups`使用`Match`对象来检索这些捕获，因此您可以准确地确定匹配的单词。 `Groups[1]`是第一个捕获的值（即 `Groups[0]`是整场比赛。您还可以命名您的捕获—<code>"(?<word>[fg]oo|[bt]ar)"—并通过名称引用它们—<code>Groups["word"]。我建议通读有关[正则表达式语言元素](http://msdn.microsoft.com/en-us/library/az24scfc.aspx.)的文档。

至于清理输入，没有输入会“破坏”正则表达式。它可能会阻止匹配，但这确实是正则表达式的全部内容，不是吗？

# javascript - Ext RadioGroup - 如何访问选定单选按钮的值？

> ID：414529
> 
> 赞同：7
> 
> 时间：2009-01-05T21:07:07.997
> 
> 标签：javascript, extjs

我在访问单选组中选定单选按钮的值时遇到了一些困难。根据论坛和网络上其他帖子的讨论，我尝试了许多不同的方法。不幸的是，还没有足够幸运（或熟练）让它工作。基于以下 FormPanel 配置，我希望有人可以向我展示如何获取“mainPhone”组中选定收音机的值。

谢谢！

**想要更新以表明我能够从 stackoverflow 获得响应，而 EXT-JS 论坛没有为我提供任何帮助。方法去stackoverflow！**

马特

```
function createForm(elem) {
var myForm2 = new Ext.form.FormPanel({
  renderTo:elem,
  width:425,
  frame:true,
  style:"margin: 10px auto 10px auto;",
  items: [{xtype:'fieldset',
            title: 'Contact Info',
            autoHeight:true,
            items :[new Ext.form.RadioGroup({
                        fieldLabel: 'Main Phone',
                        vertical: false,
                        id:"mainPhone",
                        items: [
                            {boxLabel: 'Home', name: 'id-1', inputValue: 'H', checked:true},
                            {boxLabel: 'Work', name: 'id-1', inputValue: 'W'},
                            {boxLabel: 'Other', name: 'id-1', inputValue: 'O'}
                        ]    

                    }),
                  new Ext.form.TextField({
                    id:"frm_CreateCustomerHomePhone",
                    fieldLabel:"Home Phone",
                    width:275,
                    allowBlank:true
                 }),
                 new Ext.form.TextField({
                    id:"frm_CreateCustomerWorkPhone",
                    fieldLabel:"Work Phone",
                    width:275,
                    allowBlank:true
                 })
                  new Ext.form.TextField({
                    id:"frm_CreateCustomerOtherPhone",
                    fieldLabel:"Other Phone",
                    width:275,
                    allowBlank:true
                 })
    ]}]});              
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T21:59:06.800

这是一个疯狂的猜测，但是这个怎么样：

```
myForm2.getForm().getValues()['id-1']; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-14T15:28:46.413

单选组本身的方法`getValue()`将返回被检查的对象（如果有），否则返回未定义的。

（顺便说一下，我为我的盒子设置了 value 而不是 inputValue，虽然我认为它没有太大的区别，也许它在最后一个“getValue”上确实如此），我使用的是 extjs 3.0，我的 radiogroup 配置是与你的略有不同。

```
var checkedItem = Ext.getCmp('mainPhone').getValue();

if (checkedItem == undefined) return '';

return checkedItem.getGroupValue();
// The getGroupValue will return the value of the checked option in a group,
// unfortunately, it only seems to work on the items and not the radiogroup 
// itself 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-19T18:32:14.140

我知道这个问题很老，但我将其添加以供参考。以下 snipit 适用于 Ext 2.2 afaik。

```
Ext.getCmp("mainPhone").items.get(0).getGroupValue(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-19T12:40:26.983

Lo-Tan 的回答对我有用。我也在使用 extjs 2.2.1 像我一样，您可能没有 ext.Form.Formpanel，而只有一个搜索框和一个无线电组。我使用此代码从无线电组中获取值。

我的广播组：

```
var begrens_sok = new Ext.form.RadioGroup({  
fieldLabel: 'Begrens søket',  
columns: 1,
name: 'sokspecs',
id:'sokspecs',
 items: [  
      {boxLabel: 'Scientific name', name: 'sokspec', inputVale:'SN'},
      {boxLabel: 'Norsk navngruppe', name: 'sokspec', inputValue:'NNG'},
      {boxLabel: 'Norsk navnart', name: 'sokspec', inputValue:'NNA'},
      {boxLabel: 'Prosjektsøk', name: 'sokspec', inputValue:'PROJ'},
      {boxLabel: 'Fritekst søk', name: 'sokspec', inputValue:'FSOK', 'id':'sokspec', checked: true}
 ]  
    }); 
```

要获得选中的单选按钮值，我使用以下命令：

```
var radiovalue=  Ext.getCmp('sokspecs').items.get(0).getGroupValue() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-14T16:22:47.810

如果要获取字段的特定值，请使用

```
myForm2.getForm().findField('id-1').getGroupValue(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-27T15:21:53.603

不确定这是否太简单，但我能够使用“inputValue”属性访问该值（在 Ext 3.3.1 中）。

```
var radio = ...;
var value = radio.inputValue; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-27T13:18:36.627

如果您使用的是 MVC，则可能您尝试忽略使用 id。因此，在变更事件中获得价值的解决方案之一是

```
change : function(radioButton, newValue, oldValue, eOpts){
        console.log(newValue.individual);
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-05T22:02:03.377

```
function get_radio_value()
{
    for( var i=0; i < document.myForm.mainPhone.length; i++ )
    {
       if( document.myForm.mainPhone[ i ].checked )
       {
           return document.myForm.mainPhone[ i ].value;
       }
    }
} 
```

# registration - 创建注册表单

> ID：414531
> 
> 赞同：5
> 
> 时间：2009-01-05T21:07:28.197
> 
> 标签：registration

好吧，我先说明一下我的情况：

我是“举办”活动的组织的一员。例如，我们有一年一度的训练营、滑冰、曲棍球/足球锦标赛、晚宴等等。

现在他们要我设计他们的网站。我的习惯通常是先把它写在纸上，所以我正在尝试这样做。但问题就在这里：

他们需要一份注册表。但是对于每个事件/活动，提出的问题都是不同的。例如对于年度训练营，有一个问题“你有什么过敏症？”。对于曲棍球锦标赛，有一个问题“你最喜欢的球衣颜色是什么”和“说出你团队中的其他 5 人的名字”。*

*注意：有一些通用问题，例如姓名/年龄/位置/电话/电子邮件。

另外请记住，这些人对 Web 开发以及如何使用它一无所知。我知道这一点是因为我已经为他们制作了一个带有管理面板的网站，但他们仍然觉得它太混乱了（也是我必须创建“自定义”注册表单的部分）。

我现在正在考虑如何整合它。理想情况下，我希望所有这些信息都进入数据库。

我的选择 1) 使用在线注册表来获取通用信息。传递 PDF 链接，但在浏览器中打开 PDF 并能够在其上书写。提交后，新保存的 PDF 可以转到电子邮件。

2) .. 这就是我现在所拥有的一切，哈哈。

有人有建议/解决方案吗？

多谢！

使用的技术：c#/vb.net ASP.NET！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T21:11:26.240

这种应用程序已经完成了 1000 倍以上。使用其中之一。如果必须的话，请Evite。

或者这些[Evite 替代品](http://www.evitealternatives.com/)之一。

或者，使用[Google App Form](https://drive.googleblog.com/2008/02/stop-sharing-spreadsheets-start.html)。为小型活动创造奇迹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T21:09:16.400

存储哪些问题与哪些类型的表单相关的数据库。用于显示给定事件的适当表单的 Web 界面。第二个 Web 界面供管理员轻松查看/添加/删除每种表单的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T21:12:14.787

如果您想先绘制这样的设计图表，您可能会喜欢[Product Planner](http://productplanner.com/)。他们在那里也有大量现有的注册模式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-05T21:12:27.673

存储问题列表和输入类型：textbox、textarea等。然后在构建表单时获取带有表单id的问题列表，根据问题类型插入HTML。然后当用户通过表单 id 和问题 id 提交表单时将数据存储回数据库。

# oracle - Postgresql存储过程中基于会话的全局变量？

> ID：414541
> 
> 赞同：9
> 
> 时间：2009-01-05T21:09:59.457
> 
> 标签：oracle, postgresql, plsql, plpgsql

在 Oracle 的 PL/SQL 中，我可以使用包定义创建一个基于会话的全局变量。使用 Postgresql 的 PLpg/SQL，这似乎是不可能的，因为没有包，只有独立的过程和函数。

这是 PL/SQL 将 g_spool_key 声明为全局的语法...

```
CREATE OR REPLACE PACKAGE tox IS
        g_spool_key spool.key%TYPE := NULL;
        TYPE t_spool IS REF CURSOR RETURN spool%ROWTYPE;
        PROCEDURE begin_spool;
        PROCEDURE into_spool
            (
            in_txt IN spool.txt%TYPE
            );
        PROCEDURE reset_spool;
        FUNCTION end_spool
            RETURN t_spool;
        FUNCTION timestamp
            RETURN VARCHAR2;
    END tox; 
```

如何使用 PLpg/SQL 实现基于会话的全局变量？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T16:59:07.357

您可以在 postgresql.conf 中定义一些自定义变量类，并将其用作存储过程中的连接变量。请参阅[文档](http://www.postgresql.org/docs/8.1/static/runtime-config-custom.html)。

自定义变量类“imos”的用法示例：

```
imos=> set imos.testvar to 'foobar';
SET
Time: 0.379 ms
imos=> show imos.testvar;
 imos.testvar
--------------
 foobar
(1 row)

Time: 0.333 ms
imos=> set imos.testvar to 'bazbar';
SET
Time: 0.144 ms
imos=> show imos.testvar;
 imos.testvar
--------------
 bazbar
(1 row) 
```

在存储过程中，您可以使用内置函数[current_setting('imos.testvar')](http://www.postgresql.org/docs/8.3/interactive/functions-admin.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-02T23:32:50.177

另一种选择是创建一个临时表，并使用它来存储所有临时变量

```
CREATE TEMPORARY TABLE tmp_vars( 
    name varchar(64),
    value varchar(64),
    PRIMARY KEY (name)
); 
```

您甚至可以创建一个存储过程来管理所有内容，如果该表尚不存在，则创建该表。一个用于检索，一个用于存储。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T07:03:09.900

PostgreSQL 不支持全局（会话）变量，但你应该使用一些技巧

[http://www.pgsql.cz/index.php/PostgreSQL_SQL_Tricks_II#Any_other_session_variables](http://www.pgsql.cz/index.php/PostgreSQL_SQL_Tricks_II#Any_other_session_variables) [http://www.postgresql.org/docs/8.3/static/plperl-global.html](http://www.postgresql.org/docs/8.3/static/plperl-global.html)

关于 Pavel Stehule

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-05T03:56:36.703

不幸的是，PL/pgSQL 中没有全局变量，尽管您可以在 PostgreSQL 附带的其他 PL 语言中找到全局变量，特别是在[PL/Perl](http://www.postgresql.org/docs/8.4/interactive/plperl-global.html)、PL/Python 和 PL/Tcl

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-11T08:19:20.793

从表中存储和检索全局变量的示例`PL/pgsql`脚本：

```
CREATE TABLE global_vars (name TEXT PRIMARY KEY, value TEXT);

CREATE FUNCTION put_var(key TEXT, data TEXT) RETURNS VOID AS '
  BEGIN
    LOOP
        UPDATE global_vars SET value = data WHERE name = key;
        IF found THEN
            RETURN;
        END IF;
        BEGIN
            INSERT INTO global_vars(name,value) VALUES (key, data);
            RETURN;
        EXCEPTION WHEN unique_violation THEN
            -- do nothing, and loop to try the UPDATE again
        END;
    END LOOP;
  END;
' LANGUAGE plpgsql;

CREATE FUNCTION get_var(key TEXT) RETURNS TEXT AS '
  DECLARE
    result TEXT;
  BEGIN
    SELECT value FROM global_vars where name = key INTO result;
    RETURN result;
  END;
' LANGUAGE plpgsql;

CREATE FUNCTION del_var(key TEXT) RETURNS VOID AS '
  BEGIN
    DELETE FROM global_vars WHERE name = key;
  END;
' LANGUAGE plpgsql; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T21:44:06.517

从[Postgresql 论坛](http://archives.postgresql.org/pgsql-sql/2006-04/msg00079.php)...

> 所以，有几个问题......
> 
> 1.  你可以从 plpgsql 声明全局值吗？
> 2.  如果是这样，有没有办法避免命名空间污染？（或许相当于Oracle使用plsql包变量）

plpgsql 没有全局变量。

# python - Django 序列化为 JSON

> ID：414543
> 
> 赞同：15
> 
> 时间：2009-01-05T21:10:09.643
> 
> 标签：python, django, json

我有一个带有实体类的 Django 模型（计划），即 的父级`Activity`，即 .的父级`Event`。

```
class Entity(models.Model):
    <...>

class Activity(models.Model):
    <...>
    team_entity = models.ForeignKey(Entity)
    <...>   

class Event(models.Model):
    <...>
    activity = models.ForeignKey(Activity)
    <...> 
```

如何序列化并获取子对象和大子对象作为 JSON 文件的一部分？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-05T22:11:28.257

在进行序列化之前，在检索对象时，为了保留关系，请使用 select_related() 来获取子、孙等

见[http://docs.djangoproject.com/en/dev/ref/models/querysets/](http://docs.djangoproject.com/en/dev/ref/models/querysets/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T21:05:55.643

我现在使用 django-piston。这可以解决问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T04:07:53.950

在我看来，张贴者提出的问题最终会得到如下结果：

例如，从这些模型开始：

```
class Entity(models.Model):
    name = models.CharField(...)

class Activity(models.Model):
    name = models.CharField(...)
    team_entity = models.ForeignKey(Entity)

class Event(models.Model):
    name = models.CharField(...)
    activity = models.ForeignKey(Activity) 
```

结果为 JSON：

```
{
    "model": "Entity",
    "name":  "Dallas Cowboys",
    "activities": [
        {
            "model": "Activity",
            "name": "Practice"
        },

        {
            "model": "Activity",
            "name": "Game"
            "events": [
                {
                    "model": "Event",
                    "name": "vs Washington Redskins"
                },

                {
                    "model": "Event",
                    "name": "vs Green Bay Packers"
                }
            ]
        }
    ]
} 
```

从而保持父子孙子（不是继承，而是一对多的关系遍历）。如果这不是最初的发帖人的意图，我很抱歉……但如果是这样，我也想知道这个问题的答案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T21:20:21.993

查看[http://docs.djangoproject.com/en/dev/topics/serialization/?from=olddocs#inherited-models提供的 Django 文档中的序列化继承模型和对象](http://docs.djangoproject.com/en/dev/topics/serialization/?from=olddocs#inherited-models)

那应该可以解决您的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-05T22:01:47.193

我相信你可以在这里找到你的答案：http: [//code.djangoproject.com/ticket/4656](http://code.djangoproject.com/ticket/4656)

这将在某个阶段成为 django 序列化程序的一部分。现在它应该能够用它替换标准的 django 序列化程序并工作。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-04T07:14:35.807

你可以用简单的两行代码做到这一点：

```
from django.core import serializers
data = serializers.serialize("json", SomeModel.objects.all()) 
```

# model-view-controller - 您是否尝试过将 MVC 用于 GWT 客户端代码？

> ID：414544
> 
> 赞同：11
> 
> 时间：2009-01-05T21:10:20.610
> 
> 标签：model-view-controller, gwt

您是否尝试过为 GWT 客户端代码使用 MVC 或任何其他 UI 模式。您在不同的方法中面临哪些陷阱/优势？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T23:37:31.903

我认为您需要像对待任何其他 UI 框架（如 Swing、Cocoa 等）一样对待 GWT。就 MVC（或其他范式）而言，在这些框架中有意义的所有内容在 GWT 中也有意义。我认为有时人们对 MVC 的理解太过分了，比起大多数框架，我更喜欢它在 Cocoa 中的工作方式。你创建了一个视图，你有一个 ViewController 来控制视图的所有行为，然后你有一个包含所有数据的模型对象。我认为您不需要对所有业务逻辑的位置持教条主义的态度，它只需要在有意义的地方即可。

就陷阱而言，您将遇到的主要问题是 GWT 纯粹是一种前端技术，因此从技术上讲，后端位于某处的服务器上。我不认为这与编写客户端服务器摆动应用程序有什么不同，后者将其数据存储在云中的某个地方。不同之处在于 GWT 被编译成 javascript，并且具有 javascript Web 应用程序的所有限制，所以会有一些你在前端根本无法做的事情。例如，假设您想创建一个 PDF 并向用户展示，您无法在 GWT 中执行此操作，您需要调用后端为您执行此操作。另一方面，在 Swing 应用程序中，您可能可以使用 itext 并在客户端执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T23:17:09.997

[此问题](https://stackoverflow.com/questions/411257/what-is-the-best-way-to-test-gwt-code)中讨论了 GWT 的 MVC 模式，该问题也有指向此深入[博客文章](http://robvanmaris.jteam.nl/2008/03/09/test-driven-development-for-gwt-ui-code/)的链接。

我唯一要补充的是，整个客户端代码可以被认为是“MVC”中的“V”，这可能会改变你看待它的方式。将客户端代码视为它自己的嵌套 MVC 组件，嗯，它是 Java，它是面向对象的，所以它可以像 Swing 应用程序一样设计。我认为从视图中提取尽可能多的控制器代码来处理 GWT RPC 内容对您有利。模型有时更成问题，因为您可能必须决定是否要在服务器而不是客户端上使用它。或者创建一个模型代理等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T15:04:27.833

[http://code.google.com/p/gwt-mvc/](http://code.google.com/p/gwt-mvc/)可以帮助你。

优点是：

*   易于阅读的控制器
*   历史代币管理
*   控制器可通过 JMock 测试（但不是 GwtTestCase）
*   分层 MVC
*   简单的继承来开始编写你的视图、控制器和模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T09:02:27.513

您是否尝试过 GWTruts ( [http://sourceforge.net/projects/gwtruts/](http://sourceforge.net/projects/gwtruts/) )？它也是一个开源的 GWT MVC 框架，将 GWT 中的 View 和 Controller 分开

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-04T10:21:04.747

当 GWT 应用程序超出最小项目时，使用某种 MVC/MVP 类型模式非常重要，否则您将失去对正在发生的事情的控制。

除了已经提到的还有 GXT 的 MVC 实现，我在这里看过：[http ://www.bristol-gtug.org/?p=45](http://www.bristol-gtug.org/?p=45)

去年在 Google IO 上的这个演讲让很多人开始思考 GWT 上的 MVC/MVP：[http](http://code.google.com/events/io/2009/sessions/GoogleWebToolkitBestPractices.html) ://code.google.com/events/io/2009/sessions/GoogleWebToolkitBestPractices.html 。

我最近注意到 GWT 文档中现在还有一个关于 MVP 架构的教程，这是一个好的开始：[http ://code.google.com/webtoolkit/doc/latest/tutorial/mvp-architecture.html](http://code.google.com/webtoolkit/doc/latest/tutorial/mvp-architecture.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-14T11:27:08.533

您可以查看 JetPad-Mappers，这是一个由 JetBrains 开发的简约 MVC 框架，并用于多个（当前未发布的）产品中。

*   [https://github.com/JetBrains/jetpad-mapper](https://github.com/JetBrains/jetpad-mapper)

免责声明，我参与了这个框架的开发。

# data-structures - 应该使用什么技术来修剪 2d 碰撞检查？

> ID：414553
> 
> 赞同：15
> 
> 时间：2009-01-05T21:14:12.567
> 
> 标签：data-structures, collision-detection, spatial, broad-phase

从一开始，碰撞检测就好像是一个 O(n^2) 问题。

您有一堆对象，您需要检查每个对象是否与任何其他对象发生碰撞。但是，我知道将每个对象与所有其他对象进行检查是非常低效的。如果两个球甚至彼此不靠近，为什么要在两个球之间进行相对昂贵的碰撞检查？

这是我正在处理的简单程序的示例：

![替代文字](https://i.stack.imgur.com/H7T2o.jpg)

如果您有 1000 个球，那么如果您使用简单的碰撞检测，您将有 1000^2 次收集检查（一百万）！这种碰撞检查很快成为我的应用程序的瓶颈。我*需要*实施一些广泛的阶段修剪。

使用 2d 圆形对象时，应该使用哪些技术来修剪碰撞检查？我读过关于 QuadTrees、BSP、空间散列等的信息，但很难找出最适合这个用例的方法。

有没有人知道什么可能最有效？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T21:31:09.820

空间散列。请参阅[Hugo Elias 的相关页面](https://web.archive.org/web/20160529013225/http://freespace.virgin.net/hugo.elias/models/m_colide.htm)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T21:32:18.023

我不会使用 QuadTrees 或任何复杂的东西，因为当球在它们之间移动时，你会不断地平衡和重新平衡树。仅仅拥有一个网格可能会更有效 - 每次移动球时，您都可以计算它所在的网格单元，如果它发生变化则将其扔到那里。每次您需要进行碰撞检查时，您只需检查中心在您的网格中的球，或者如果您足够靠近边缘，则在相邻的球中。

您可以尝试使用网格大小来找到最佳值。你可能会发现这取决于你有多少球。

我在下面的评论中说过这一点，但我认为它应该成为答案的一部分：仅在某物移动时进行碰撞检测，因此您只需检查移动的物体与其网格正方形中的物体（以及上面提到的相邻物体） ）。这样，如果底部有一堆没有移动的东西，很快就不会检查这些对象是否发生碰撞，因为它们的网格内没有任何东西移动，也没有任何东西移入或移出它们的网格。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T06:52:00.843

我支持 Grid 方法。球的 2D 模拟不会受益于 QuadTree（通常在您具有复杂的几何形状，如角色和建筑物时使用）或 BSP（如果您的物体分散/集中度非常不均匀，则应该选择它，例如高浓度区域和低浓度区域，在多人游戏或策略游戏中）

# wpf - 如何绑定到可视树中较低元素的属性？

> ID：414575
> 
> 赞同：0
> 
> 时间：2009-01-05T21:21:42.833
> 
> 标签：wpf, data-binding

我不知道这是否是表达问题的正确方式。这是一个典型的数据绑定示例：

```
<UserControl x:Name="root">
   <ListView ItemsSource="{Binding MyItemsSource, ElementName=root}" />
</UserControl> 
```

但这就是我想要做的：

```
<UserControl DataContext="{Binding SelectedItem, ElementName=lstMyItems}">
   <ListView ItemsSource="{Binding MyItemsSource, ElementName=root}">
</UserControl> 
```

（请注意，我在这里所做的是将 UserControl 的 DataContext 设置为 ListView 上的当前 SelectedItem）。

任何没有事件或使用代码隐藏的干净方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:10:07.127

我通过这样做解决了我的问题：

```
<UserControl x:Name="root">   
    <ListView ItemsSource="{Binding MyItemsSource}" 
        SelectedItem="{Binding DataContext, ElementName=root, Mode=OneWayToSource}">
</UserControl> 
```

诀窍在于 Mode=OneWayToSource 设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T21:30:55.890

只要你不在这个`UserControl`级别上做，你几乎回答了你自己的问题。例如：

```
<UserControl DataContext="{Binding SelectedItem, ElementName=lstMyItems}">
   <Grid x:Name="_grid">
       <ListView ItemsSource="{Binding MyItemsSource, ElementName=_grid}">
   </Grid>
</UserControl> 
```

它在根级别不起作用的原因对我来说并不完全清楚，但我认为它与名称范围有关。

# java - Java（任何框架）中是否有 CRUD 生成器实用程序，例如 Rails 中的脚手架？

> ID：414583
> 
> 赞同：52
> 
> 时间：2009-01-05T21:26:54.320
> 
> 标签：java, ruby-on-rails, crud, scaffolding

Java 中是否有 CRUD 生成器实用程序，例如 Rails 中的脚手架？可以在任何框架甚至普通 servlet 中。必须在jsp中生成控制器+视图，而不仅仅是DAO代码...

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-01-08T10:20:13.397

[Spring Roo](http://www.springsource.org/roo)似乎正是您正在寻找的东西：CRUD 代码生成，吐出纯 Java 代码，可以使 tun 完全独立于框架运行。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-05T21:37:14.237

[Grails](http://grails.org/Scaffolding)有脚手架。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-06-24T10:43:03.140

[请参阅http://www.telosys.org/](http://www.telosys.org/)上的 Telosys Tools Eclipse 插件

该插件连接到数据库，生成轻量级存储库，让您在必要时自定义存储库并生成 Java Beans、DAO、XML 转换器、ScreenMaps (JSP) 等...

您可以在几分钟内构建以数据为中心的 Web 应用程序

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-01-19T12:10:26.193

使用[JHipster](http://jhipster.github.io/)。它建立在流行的前端脚手架工具“yeoman”之上。它不仅使用 Spring Boot 和 Spring MVC 4 生成您的后端，包括控制器、dao、安全性、用户管理、系统和 API 指标、日志记录等，而且还使用 Angular js 生成您的前端。您还可以获得诸如 grunt、karma 和 bower 之类的好东西，它们已完全设置好并可以使用！除此之外，您还可以获得数据库版本控制！

它还具有用于生成域实体的子生成器，这些域实体生成您的 java 和用于管理其数据的相应前端。

运行一个完整的 web 应用程序需要 10 分钟。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-05T23:38:13.743

JBoss Seam 有一个名为 seam-gen 的脚本实用程序，它将创建脚手架：

[http://docs.jboss.org/seam/1.1BETA2/reference/en/html/gettingstarted.html](http://docs.jboss.org/seam/1.1BETA2/reference/en/html/gettingstarted.html)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-01-08T10:09:05.290

[应用熔断器](http://appfuse.org/display/APF/Home)。

它非常强大，也许它对于所讨论的任务来说太强大了，但它做得很好。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-12-10T21:37:28.857

我遇到了这个问题并尝试了许多建议的答案。最后，我找到[了 Lightadmin](http://lightadmin.org/)。它不生成 CRUD 代码，但用很少的代码为实体类提供了一个很好的前端。要通过 Lightadmin Web 界面使`User`实体可用，它只需要在 XML 文件中进行两次更改，然后是一个`UserAdministration`类：

```
public class UserAdministration extends AdministrationConfiguration<User> {
    /* empty */
} 
```

您可以在此类中配置字段名称（可能还有更多）`Administration`，但我发现它已经非常有用，无需任何进一步的配置。[入门](http://lightadmin.org/getting-started/)指南确实显示了它是多么容易。完成这些简单的步骤后，您就可以打开管理界面了`http://localhost:8080/TestApp/admin`。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-05T21:33:54.853

Netbeans 有这样的东西。

这里有一个演示：http: [//www.netbeans.org/kb/55/persistence-demo.html](http://www.netbeans.org/kb/55/persistence-demo.html)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-03-13T14:17:51.493

Google Code 上有[krank](http://code.google.com/p/krank/)。我还没有尝试过，但它看起来很有希望。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-11-06T18:21:16.023

这可能有点断章取义，但是对于`Java EE`，有 Jboss [Forge](http://forge.jboss.org/)。有一个使用它的[例子。](http://www.jboss.org/jdf/examples/ticket-monster/tutorial/WhatIsTicketMonster/)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-11-09T17:02:17.037

看看以下工具：

MetaWidget [http://www.metawidget.org/](http://www.metawidget.org/)

ISIS [http://incubator.apache.org/isis/index.html](http://incubator.apache.org/isis/index.html)（以前是 Naked Objects）

它们会“即时”生成 UI，但允许您在必要时自定义 UI。

比代码生成好得多。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-08-29T18:11:41.630

看看[Minuteproject](http://minuteproject.wikispaces.com/)

并尝试它的[演示](http://minuteproject.wikispaces.com/Demos)。

**关于技术**

如果您只寻找 ORM + DAO，请尝试跟踪 BSLA-JPA2（BSLA 表示基本 Spring 层架构）。它促进了掩码模式以简化搜索。

如果您想要面向活动记录的持久性，请查看[JOOQ](http://www.jooq.org/)或 Roo

如果您想要 servlet，请查看[minuteproject 4 Openxava](http://minuteproject.wikispaces.com/OpenXava)或[4 Primefaces](http://minuteproject.wikispaces.com/Primefaces)

如果您想要 portlet，请查看[Liferay 服务构建器](http://www.liferay.com/fr/documentation/liferay-portal/6.0/development/-/ai/service-build-2)minuteproject 将从您的数据库生成[service.xml](http://minuteproject.wikispaces.com/Liferay)输入。

**关于你的模型**

如果您希望您的代码（java）遵循 java 约定而不是 DB 约定，请使用 minuteproject。它有浓缩设施，允许：

*   包实体（表/视图）
*   应用实体/字段命名约定
*   应用刻板印象/约束/验证
*   [如果此处](http://minuteproject.blogspot.be/2011/12/productivity-by-example-liferay-reverse.html)缺少外键，则检索关系（one2many、many2one、many2many）
*   还有[更多](http://minuteproject.wikispaces.com/Configuration)

这种扩充可以在字段/实体/包中单独应用，也可以通过约定全局应用（**因此您可以配置自己的约定**）。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-11-16T23:02:36.197

自从提出这个问题以来，已经出现了几个 Java 框架。查看 Spring Roo 和[Play Framework](http://www.playframework.org/)。还有[Skyway Builder](http://www.skywaysoftware.com/products/builder/)，我认为它早于两者。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-01-25T07:20:12.503

看看[泰纳摩](http://tynamo.org)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-03-31T19:48:27.733

NetBeans 可以为 JSF 中的现有数据库生成 CRUD。

OpenXava [http://openxava.org](http://openxava.org)怎么样？

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-01-08T10:05:20.713

[在http://www.grails.org/](http://www.grails.org/)上试用 Grails

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-05-13T07:27:48.920

请参阅 Jspresso - [http://www.jspresso.org/](http://www.jspresso.org/)
它具有多个前端（Flex、纯 HTML/Javascript、Swing 等），但在视图部分并没有给您太多自由。不过值得检查。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-08-26T13:17:16.323

不要忘记[玩](http://www.playframework.org)。非常容易使用。一旦你有 ruby​​ on rails 的经验，你也很容易适应 Java。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-02-12T08:24:59.403

试试[generjee](http://generjee.com)

它生成 CRUD 并使用 JPA、EJB、使用 primefaces 的 JSF 框架等规范为您提供后端和前端、Java 安全、身份验证、审计、excel 和 pdf 导出、用户管理、用户注册。

之后，您可以下载源代码或部署到 heroku。我已经测试过了，它给了我预期的结果

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-05T21:38:43.097

我很久以前就有这个了。

[http://mahosoft.com/docs/WhitePaper-WEB-App-Spanish.pdf](http://mahosoft.com/docs/WhitePaper-WEB-App-Spanish.pdf)

谷歌翻译成英文：

[http://translate.google.com/translate?hl=en&u=http://mahosoft.com/docs/WhitePaper-WEB-App-Spanish.pdf&sl=es&tl=en](http://translate.google.com/translate?hl=en&u=http://mahosoft.com/docs/WhitePaper-WEB-App-Spanish.pdf&sl=es&tl=en)

不过可能已经过时了。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-01-21T15:28:24.453

[reinCRUD](http://code.google.com/p/reincrud)是一个[vaadin](http://www.vaadin.com)插件，它使用带注释的休眠实体工作。您可以在几分钟内创建一个 CRUD 应用程序，并且可以重复使用列表、表单和搜索表单等组件。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-05-20T14:35:41.100

如果您有一个示例项目，其中包含您想要的那种 CRUD（或其他）架构，那么[Simple Scaffolding](http://gary-rowe.com/agilestack/2013/05/19/simple-scaffolding/)可能是一种有用的方法。

它是一个单一的类，可以扫描您现有的代码库并创建模板，然后您可以将其应用于其他实体。例如，`MongoUserDao`可以将其转换为模板，然后生成`MongoCustomerDao`. 它适用于任何代码和测试装置。

非常基本，但可以完成工作，并且它是 MIT 许可下的 FOSS。

GitHub 存储库在这里：[https ://github.com/gary-rowe/SimpleScaffolding](https://github.com/gary-rowe/SimpleScaffolding)

# javascript - Rails 控制器不接受 JSON？

> ID：414604
> 
> 赞同：8
> 
> 时间：2009-01-05T21:32:51.843
> 
> 标签：javascript, ruby-on-rails, json

我正在尝试通过 JSON 请求创建一个 ActiveRecord 对象。然而，控制器未能在新创建的对象中设置参数中传递的变量。例如，一个人对象有两个字段：名字和姓氏。

JSON.org 库的 JSON.stringify 函数生成的 JSON 生成：

```
{"firstname" : "Joe" , "lastname" : "Bloggs"} 
```

然而，控制器希望 JSON 采用以下形式：

```
{ "Person" : {"firstname" : "Joe" , "lastname" : "Bloggs"} } 
```

我知道在正常的事件过程中（对于 HTTP 请求），请求的参数嵌套在正在创建的模型的类名下。

控制器中的创建动作是：

```
def create
    @person = Person.new(params[:person])

    respond_to do |format|
      if @person.save
        flash[:notice] = 'Person was successfully created.'
        format.html { redirect_to(@person) }
        format.xml  { render :xml => @person, :status => :created, :location => @person }
        format.json  { render :json => @person, :status => :created, :location => @person }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @person.errors, :status => :unprocessable_entity }
        format.json  { render :json => @person.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

控制器处理生成的 JSON 请求的最佳方式是什么？或者，您如何从 Javascript 对象生成“正确”的 JSON 以传递给您的控制器？

TIA，亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T21:47:51.033

如果您只是传递所有人员参数的哈希（而不是以“人”为键的嵌套哈希），那么您应该能够做到`@person = Person.new(params)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-23T12:53:20.113

至于 ActiveRecord 3.0.7，你可以添加

```
self.include_root_in_json = false 
```

到您的模型 (person.rb) 以摆脱根 ({ "Person" :") 部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T23:01:53.817

> 或者，`Person.new(params.reject{|k,v| k != "firstname" || k != "lastname"})`可以在您的 Ruby 中执行。
> 
> ...
> 
> `Person.new({:firstname => params[:firstname], :lastname => params[:lastname]})`-- 这确实有效

这是一个更具前瞻性的解决方案：

```
Person.new(params.reject{|k,v| not Person.column_names.include?(k) }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-26T00:01:46.137

允许平面 JSON 输入（例如 {"firstname": "Joe", "lastname": "Bloggs"} 和使用 HTML 表单获得的嵌套类型）的一个想法是：

```
@person = Person.new(params[:person] || params)

respond_to do |format|
  ..
end 
```

# .net - 用于呈现 HTML 的流畅界面

> ID：414605
> 
> 赞同：10
> 
> 时间：2009-01-05T21:33:21.623
> 
> 标签：.net, html, render, web-controls, htmltextwriter

在我看来，使用 HtmlTextWriter 呈现 HTML 并不是非常直观，但如果您在 Web 表单中实现 Web 控件，则必须使用它。我认为有可能为此创建一个流畅的界面，该界面看起来更像它输出的 HTML。我想知道人们对我迄今为止提出的语法的看法。

```
 public void Render(HtmlTextWriter writer)
    {
        writer
            .Tag(HtmlTextWriterTag.Div, e => e[HtmlTextWriterAttribute.Id, "id"][HtmlTextWriterAttribute.Name,"name"][HtmlTextWriterAttribute.Class,"class"])
                .Tag(HtmlTextWriterTag.Span)
                    .Text("Lorem")
                .EndTag()
                .Tag(HtmlTextWriterTag.Span)
                    .Text("ipsum")
                .EndTag()
            .EndTag();        
    } 
```

“Tag”、“Text”和“EndTag”是 HtmlTextWriter 类的扩展方法，它们返回它接收的实例，以便可以链接调用。第一次调用“Tag”使用的重载中使用的传递给 lambda 的参数是一个“HtmlAttributeManager”，它是一个简单的类，它包装了一个 HtmlTextWriter 以提供一个索引器，该索引器接受一个 HtmlTextWriterAttribute 和一个字符串值并返回实例，所以可以链接调用。我还为这个类提供了最常见属性的方法，例如“Name”、“Class”和“Id”，这样您就可以将上面的第一个调用编写如下：

```
.Tag(HtmlTextWriterTag.Div, e => e.Id("id").Name("name").Class("class")) 
```

再长一点的例子：

```
public void Render(HtmlTextWriter writer)
{
    writer
        .Tag(HtmlTextWriterTag.Div, a => a.Class("someClass", "someOtherClass"))
            .Tag(HtmlTextWriterTag.H1).Text("Lorem").EndTag()
            .Tag(HtmlTextWriterTag.Select, t => t.Id("fooSelect").Name("fooSelect").Class("selectClass"))
                .Tag(HtmlTextWriterTag.Option, t => t[HtmlTextWriterAttribute.Value, "1"][HtmlTextWriterAttribute.Title, "Selects the number 1."])
                    .Text("1")
                .EndTag(HtmlTextWriterTag.Option)
                .Tag(HtmlTextWriterTag.Option, t => t[HtmlTextWriterAttribute.Value, "2"][HtmlTextWriterAttribute.Title, "Selects the number 2."])
                    .Text("2")
                .EndTag(HtmlTextWriterTag.Option)
                .Tag(HtmlTextWriterTag.Option, t => t[HtmlTextWriterAttribute.Value, "3"][HtmlTextWriterAttribute.Title, "Selects the number 3."])
                    .Text("3")
                .EndTag(HtmlTextWriterTag.Option)
            .EndTag(HtmlTextWriterTag.Select)
        .EndTag(HtmlTextWriterTag.Div);
} 
```

希望您能够“破译”此代码段输出的 HTML，至少是这样的想法。

请给我任何关于如何改进语法的想法，也许是更好的方法名称，也许是其他一些方法。

编辑：我认为在不使用流畅界面的情况下查看相同的代码段可能会很有趣，以进行比较：

```
public void RenderUsingHtmlTextWriterStandardMethods(HtmlTextWriter writer)
{
    writer.AddAttribute(HtmlTextWriterAttribute.Class, "someClass someOtherClass");
    writer.RenderBeginTag(HtmlTextWriterTag.Div);

    writer.RenderBeginTag(HtmlTextWriterTag.H1);
    writer.Write("Lorem");
    writer.RenderEndTag();

    writer.AddAttribute(HtmlTextWriterAttribute.Id, "fooSelect");
    writer.AddAttribute(HtmlTextWriterAttribute.Name, "fooSelect");
    writer.AddAttribute(HtmlTextWriterAttribute.Class, "selectClass");
    writer.RenderBeginTag(HtmlTextWriterTag.Select);

    writer.AddAttribute(HtmlTextWriterAttribute.Value, "1");
    writer.AddAttribute(HtmlTextWriterAttribute.Title, "Selects the number 1.");
    writer.RenderBeginTag(HtmlTextWriterTag.Option);
    writer.Write("1");
    writer.RenderEndTag();

    writer.AddAttribute(HtmlTextWriterAttribute.Value, "2");
    writer.AddAttribute(HtmlTextWriterAttribute.Title, "Selects the number 2.");
    writer.RenderBeginTag(HtmlTextWriterTag.Option);
    writer.Write("2");
    writer.RenderEndTag();

    writer.AddAttribute(HtmlTextWriterAttribute.Value, "3");
    writer.AddAttribute(HtmlTextWriterAttribute.Title, "Selects the number 3.");
    writer.RenderBeginTag(HtmlTextWriterTag.Option);
    writer.Write("3");
    writer.RenderEndTag();

    writer.RenderEndTag();

    writer.RenderEndTag();
} 
```

编辑：我可能应该更明确一点，其中一个目标是它应该产生尽可能少的开销，这就是我限制使用 lambdas 的原因。同样，起初我使用了一个表示标签的类，以便在渲染之前通过语法构建类似于 DOM 树的东西，尽管语法非常相似。我放弃了这个解决方案，因为它会产生轻微的内存开销。在使用 HtmlAttributeManager 类时仍然存在一些这种情况，我一直在考虑使用扩展方法来附加属性，但是我不能使用 indexer-syntax，而且它会使 HtmlTextWriter 的接口膨胀更。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T22:13:28.173

There are two issues that I see:

*   Repeated use of `Tag(Tagname, …)`. Why not offer extension methods for each tag name? Admittedly, this bloats the interface and is quite a lot to write (=> code generation!).
*   The compiler/IDE doesn't assist you. In particular, it doesn't check indentation (it will even destroy it when you indent your automatically).

Both problems could perhaps be solved by using a Lambda approach:

```
writer.Write(body => new Tag[] {
    new Tag(h1 => "Hello, world!"),
    new Tag(p => "Indeed. What a lovely day.", new Attr[] {
        new Attr("style", "color: red")
    })
}); 
```

This is just one basic approach. The API certainly would need a lot more work. In particular, nesting the same tag name won't work because of argument name conflicts. Also, this interface wouldn't work well (or at all) with VB. But then, the same is unfortunately true for other modern .NET APIs, even the PLINQ interface from Microsoft.

Another approach that I've thought about some time ago actually tries to emulate Markaby, like sambo's code. The main difference is that I'm using `using` blocks instead of `foreach`, thus making use of RAII:

```
using (var body = writer.body("xml:lang", "en")) {
    using (var h1 = body.h1())
        h1.AddText("Hello, World!");
    using (var p = body.p("style", "color: red"))
        p.AddText("Indeed. What a lovely day.");
} 
```

This code doesn't have the problems of the other approach. On the other hand, it provides less type safety for the attributes and a less elegant interface (for a given definition of “<em>elegant”).

I get both codes to compile and even produce some more or less meaningful output (i.e.: HTML!).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-22T17:18:03.707

我希望能够拥有这种语法：

```
using (var w = new HtmlTextWriter(sw))
        {
            w.Html()
                .Head()
                    .Script()
                        .Attributes(new { type = "text/javascript", src = "somescript.cs" })
                        .WriteContent("var foo='bar'")
                    .EndTag()
                .EndTag()
                .Body()
                    .P()
                        .WriteContent("some content")
                    .EndTag()
                .EndTag()
            .EndTag();
        } 
```

为了实现这一点，我向 HtmlTextWriter 添加了扩展方法，尽管容器可能更合适（首先我更感兴趣的是让它工作！）感觉很懒，我不想为每个可用的标签，所以我通过迭代 System.Web.UI.HtmlTextWriterTag 枚举使用 t4 模板对方法进行编码。标签属性使用匿名对象进行管理；代码基本上反映了匿名类型，提取属性并将它们转换为属性，我认为这使结果语法看起来非常干净。

代码生成结果：

```
using System;
using System.Web.UI;
using System.Collections.Generic;

/// <summary>
///  Extensions for HtmlTextWriter
/// </summary>
public static partial class HtmlWriterTextTagExtensions
{
    static Stack<Tag> tags = new Stack<Tag>();

        /// <summary>
        ///  Opens a Unknown Html tag
        /// </summary>
        public static HtmlTextWriter Unknown(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("Unknown",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a A Html tag
        /// </summary>
        public static HtmlTextWriter A(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("a",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Acronym Html tag
        /// </summary>
        public static HtmlTextWriter Acronym(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("acronym",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Address Html tag
        /// </summary>
        public static HtmlTextWriter Address(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("address",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Area Html tag
        /// </summary>
        public static HtmlTextWriter Area(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("area",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a B Html tag
        /// </summary>
        public static HtmlTextWriter B(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("b",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Base Html tag
        /// </summary>
        public static HtmlTextWriter Base(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("base",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Basefont Html tag
        /// </summary>
        public static HtmlTextWriter Basefont(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("basefont",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Bdo Html tag
        /// </summary>
        public static HtmlTextWriter Bdo(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("bdo",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Bgsound Html tag
        /// </summary>
        public static HtmlTextWriter Bgsound(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("bgsound",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Big Html tag
        /// </summary>
        public static HtmlTextWriter Big(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("big",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Blockquote Html tag
        /// </summary>
        public static HtmlTextWriter Blockquote(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("blockquote",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Body Html tag
        /// </summary>
        public static HtmlTextWriter Body(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("body",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Br Html tag
        /// </summary>
        public static HtmlTextWriter Br(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("br",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Button Html tag
        /// </summary>
        public static HtmlTextWriter Button(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("button",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Caption Html tag
        /// </summary>
        public static HtmlTextWriter Caption(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("caption",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Center Html tag
        /// </summary>
        public static HtmlTextWriter Center(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("center",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Cite Html tag
        /// </summary>
        public static HtmlTextWriter Cite(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("cite",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Code Html tag
        /// </summary>
        public static HtmlTextWriter Code(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("code",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Col Html tag
        /// </summary>
        public static HtmlTextWriter Col(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("col",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Colgroup Html tag
        /// </summary>
        public static HtmlTextWriter Colgroup(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("colgroup",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Dd Html tag
        /// </summary>
        public static HtmlTextWriter Dd(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("dd",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Del Html tag
        /// </summary>
        public static HtmlTextWriter Del(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("del",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Dfn Html tag
        /// </summary>
        public static HtmlTextWriter Dfn(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("dfn",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Dir Html tag
        /// </summary>
        public static HtmlTextWriter Dir(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("dir",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Div Html tag
        /// </summary>
        public static HtmlTextWriter Div(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("div",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Dl Html tag
        /// </summary>
        public static HtmlTextWriter Dl(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("dl",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Dt Html tag
        /// </summary>
        public static HtmlTextWriter Dt(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("dt",  null));
            return writer;
        }

        /// <summary>
        ///  Opens a Em Html tag
        /// </summary>
        public static HtmlTextWriter Em(this HtmlTextWriter writer)
        {
            WritePreceeding(writer);
            tags.Push(new Tag("em",  null));
            return writer;
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T22:16:52.130

If you need to do lots of this kind of stuff have you considered some sort of template engine like NHaml?

In Ruby/Markaby this would look so much prettier.

```
 div :class=>"someClass someOtherClass" do 
        h1 "Lorem"
        select :id => "fooSelect", :name => "fooSelect", :class => "selectClass" do 
           option :title=>"selects the number 1", :value => 1 { "1" } 
           option :title=>"selects the number 2", :value => 2 { "2" } 
           option :title=>"selects the number 3", :value => 3 { "3" } 
        end
    end 
```

You can port a similar approach to .Net

```
 using(var d = HtmlTextWriter.Div.Class("hello"))
    {
        d.H1.InnerText("Lorem"); 
        using(var s = d.Select.Id("fooSelect").Name("fooSelect").Class("fooClass"))
        {
           s.Option.Title("select the number 1").Value("1").InnerText("1"); 
        }
    } 
```

I think it reads quite will and supports nesting.

*EDIT* I stole the using from Konrad cause it reads much better.

I have the following issues with the original proposal

1.  You must remember to call EndTag otherwise your HTML goes Foobar.
2.  Your namspace is too polluted HtmlTextWriterTag is repeated a ton of times and its hard to decipher the content from the overhead.

My suggested approach is potentially slightly less efficient, but I think it addresses these concerns and would be very easy to use.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-23T12:26:30.487

This is what I came up with, taking care of the following considerations:

1.  I save some typing with `T.Tag` after `using T = HtmlTextWriterTag;`, which you might like or not
2.  I wanted to get at least some safety for the sequence of the invocation chain (the `Debug.Assert` is just for brevity, the intention should be clear)
3.  I didn't want to wrap the myriad of methods of the HtmlTextWriter.

    ```
    using T = HtmlTextWriterTag;

    public class HtmlBuilder {
      public delegate void Statement(HtmlTextWriter htmlTextWriter);

      public HtmlBuilder(HtmlTextWriter htmlTextWriter) {
        this.writer = htmlTextWriter;
      }
      // Begin statement for tag; mandatory, 1st statement
      public HtmlBuilder B(Statement statement) {
        Debug.Assert(this.renderStatements.Count == 0);
        this.renderStatements.Add(statement);
        return this;
      }
      // Attribute statements for tag; optional, 2nd to nth statement
      public HtmlBuilder A(Statement statement) {
        Debug.Assert(this.renderStatements.Count > 0);
        this.renderStatements.Insert(this.cntBeforeStatements++, statement);
        return this;
      }
      // End statement for tag; mandatory, last statement
      // no return value, fluent block should stop here
      public void E() {
        Debug.Assert(this.renderStatements.Count > 0);
        this.renderStatements.Add(i => { i.RenderEndTag(); });
        foreach (Statement renderStatement in this.renderStatements) {
            renderStatement(this.writer);
        }
        this.renderStatements.Clear(); this.cntBeforeStatements = 0;
      }
      private int cntBeforeStatements = 0;
      private readonly List<Statement> renderStatements = new List<Statement>();
      private readonly HtmlTextWriter writer;
    }

    public class HtmlWriter {
      public delegate void BlockWithHtmlTextWriter(HtmlTextWriter htmlTextWriter);
      public delegate void BlockWithHtmlBuilder(HtmlBuilder htmlBuilder);

      public string Render(BlockWithHtmlTextWriter block) {
        StringBuilder stringBuilder              = new StringBuilder();
        using (StringWriter stringWriter         = new StringWriter(stringBuilder)) {
            using (HtmlTextWriter htmlTextWriter = new HtmlTextWriter(stringWriter)) {
                block(htmlTextWriter);
            }
        }
        return stringBuilder.ToString();
      }
      public string Render(BlockWithHtmlBuilder block) {
        return this.Render((HtmlTextWriter htmlTextWriter) => 
                block(new HtmlBuilder(htmlTextWriter)));
      }
      // small test/sample
      static void Main(string[] args) {
        HtmlWriter htmlWriter = new HtmlWriter();
        System.Console.WriteLine(htmlWriter.Render((HtmlBuilder b) => {
                b.B(h => h.RenderBeginTag(T.Div) )
                 .A(h => h.AddAttribute("foo", "bar") )
                 .A(h => h.AddAttribute("doh", "baz") )
                 .E();
            }));
      }
    } 
    ```

# sql-server - 如果您的环境中同时具有 SQL 2005 和 2008，ADO.Net 如何知道要使用哪个版本的 SQL Native Client？

> ID：414611
> 
> 赞同：1
> 
> 时间：2009-01-05T21:35:25.787
> 
> 标签：sql-server, ado.net

如果您的环境中同时具有 SQL 2005 和 2008，ADO.Net 如何知道要使用哪个版本的 SQL Native Client？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T21:41:18.317

对于基本服务，它们是向后兼容的，因此您甚至不必担心：如果安装了 2008 原生客户端，它应该透明地连接到 2005 或 2008 数据库。

您遇到的唯一问题是某些部分，例如 DTS 或 SQL-DMO，显然需要单独下载以实现向后兼容性：

[http://www.microsoft.com/downloads/details.aspx?FamilyId=C6C3E9EF-BA29-4A43-8D69-A2BED18FE73C&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6C3E9EF-BA29-4A43-8D69-A2BED18FE73C&displaylang=en)

安装这些将意味着您不必担心系统上是否存在 2005 本机客户端。

这有帮助吗？

# c# - 集合初始化

> ID：414616
> 
> 赞同：7
> 
> 时间：2009-01-05T21:39:06.387
> 
> 标签：c#, .net

你可以像这样初始化一个数组：

```
int [ ] arr = { 1, 2, 3, 4, 5 }; 
```

但`List<T>`不允许这样做：

```
List<int> list = { 1, 2, 3, 4, 5 }; 
```

这背后的原因是什么？

毕竟两者都允许这样做：

```
int [ ] arr = new int [ ] { 1, 2, 3, 4, 5 }; 

List<int> list = new List<int> { 1, 2, 3, 4, 5 }; 
```

还有为什么不能用 ? 来做到这一点`LinkedList<T>`：

```
LinkedList<int> ll = new LinkedList<int>() { 1, 2, 3 }; 
```

**更新**

多谢你们。刚看到回复。我想选择几个答案，但它没有让我这样做。

为什么 LinkedList 通过显式实现有一个 Add 方法？这可能会得到解决吗？因为当这些问题被忽视时，它们只会滚雪球成更大的问题，对吧？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-05T21:49:03.123

您的第一个示例是用于初始化整数数组的标准语言语法。左边的值计算为 int[]。在第二个示例中，您尝试将 int[] 分配给 List<int>。赋值运算符不支持这一点，因为它们是不同的类型。List<int>**不是**int 类型的数组。但是，正如您所说，List<int> 有一个构造函数，它确实将 int[] 作为参数，并且 C# 3.0 中添加的新语法糖允许您方便地使用 { } 将成员添加到定义的集合中默认构造函数。

正如@Patrik 所说，这对 LinkedList 不起作用，因为它没有将 Add() 方法定义为其接口的一部分（ICollection.Add 的显式实现），因此语法糖不起作用。

不过，LinkedList 有一个简单的解决方法。

```
public class LinkedListWithInit<T> : LinkedList<T>
{
    public void Add( T item )
    {
        ((ICollection<T>)this).Add(item);
    }
}

LinkedList<int> list = new LinkedListWithInit<int> { 1, 2, 3, 4, 5 }; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T21:54:40.520

以下是**C# 3.0 语言规范**关于该主题的内容：

> 以下是包含集合初始值设定项的对象创建表达式的示例：
> 
> ```
> List<int> digits = new List<int> { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }; 
> ```
> 
> 应用集合初始值设定项的集合对象必须是实现 System.Collections.IEnumerable 的类型，否则会发生编译时错误。对于按顺序指定的每个元素，集合初始值设定项在目标对象上调用 Add 方法，并将元素初始值设定项的表达式列表作为参数列表，对每个调用应用正常的重载决议。因此，集合对象必须包含适用于每个元素初始值设定项的 Add 方法。

当您考虑它时，这是有道理的。编译器确保您正在处理实现 Add 函数（通过它进行初始化）的可枚举类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-09T09:16:24.267

如果您想在 LinkedList 中使用集合初始化程序并且不介意效率低下，您可以这样做：

```
var linkedList = new LinkedList<int>(new[] { 1, 2, 3, 4 }); 
```

诀窍是使用集合初始化程序初始化数组，然后将其传递给 LinkedList。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T21:42:34.337

我从来没有意识到你不能使用 LinkedList(T) 的集合初始化，但这似乎是合乎逻辑的，因为它没有“Add”方法，而是有“AddFirst”和“AddLast”。集合初始化使用“添加”方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T21:43:21.370

因为制作数组是语言内置的，例如 int[]、float[]、WhateverClassHere[]。此语法用于创建数组，而不是初始化列表。

在您的示例中，您正在制作一个整数数组。使用该语法向列表添加值不应该工作，因为 List 不是数组。

# c# - T-Sql SET 参数是否会通过池化 .NET 连接重置？

> ID：414626
> 
> 赞同：4
> 
> 时间：2009-01-05T21:43:27.050
> 
> 标签：c#, .net, sql-server

我找到具体指导的唯一 SET 参数是 SET TRANSACTION ISOLATION LEVEL：

> 如果在存储过程或触发器中发出 SET TRANSACTION ISOLATION LEVEL，则当对象返回控制权时，隔离级别将重置为调用对象时有效的级别。例如，如果您在批处理中设置 REPEATABLE READ，然后批处理调用将隔离级别设置为 SERIALIZABLE 的存储过程，则当存储过程将控制权返回给批处理时，隔离级别设置将恢复为 REPEATABLE READ。

其他 SET 参数呢，比如`SET XACT_ABORT`or `SET DEADLOCK_PRIORITY`？如果您在存储过程（或从 C# 提交的批处理）期间设置这些值，它们会在下次使用连接时恢复到以前的值吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T01:53:19.993

默认情况下（即，除非您在连接字符串中包含“Connection Reset=false”），.NET`sp_reset_connection`在重用之前重置与存储过程的连接；除其他外，它撤消了自打开连接以来已发出的任何 SET 命令。

有关更多详细信息，请参阅[本文](http://www.sqldev.net/misc/sp_reset_connection.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T01:18:42.763

我相信在当前会话的剩余时间里，事务隔离级别保持不变。这意味着即使在这样的存储过程返回之后，如果客户端 cide 在同一连接（在同一会话中）调用另一个存储过程，则第二个过程将在相同的隔离级别下执行。

# c# - 您如何设置解决方案配置特定的配置文件？

> ID：414630
> 
> 赞同：8
> 
> 时间：2009-01-05T21:44:50.557
> 
> 标签：c#, visual-studio, web-services

我有一个需要针对不同环境（调试、测试、生产）进行不同设置的 Web 服务。为这些不同的环境设置单独的配置文件的最简单方法是什么？我在网上找到的所有内容都告诉我如何使用配置管理器来检索设置，但没有告诉我如何根据当前构建配置查找特定设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T21:56:26.290

我发现每个环境都有几个配置文件效果很好。IE：

*   config\local.endpoints.xml
*   配置\ dev.endpoints.xml
*   配置\ test.endpoints.xml
*   配置\ staging.endpoints.xml
*   配置\ prod.endpoints.xml

然后，我使用 web.config 或 app.config 中的内置 configSource 属性链接到它的“主”版本，例如

```
<appSettings configSource="config\endpoints.xml"/> 
```

然后，我将使用构建过程或部署过程将环境的正确配置复制到 web.config 期望的名称。

每个环境都有明确的标签和控制，不需要凌乱的占位符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T21:54:40.753

一种方法是维护 3 个不同的配置文件，并在部署时通过 MSBuild 选择它们。

```
 <Choose>
        <When Condition="$(BuildEnvironment) == 'debug'">
            <PropertyGroup>
                <ConfigFile>debug.config</ConfigFile>
            </PropertyGroup>
        </When>
        <When Condition="$(BuildEnvironment) == 'test'">
            <PropertyGroup>
                <ConfigFile>test.config</ConfigFile>
            </PropertyGroup>
        </When>
        <When Condition="$(BuildEnvironment) == 'prod'">
            <PropertyGroup>
                <ConfigFile>prod.config</ConfigFile>
            </PropertyGroup>
        </When>
    </Choose> 
```

通过利用 MSBuild 任务，您可以重命名特定配置文件并将其推送到适当的位置。

仍然有些麻烦，这具有迈向[一步构建](http://www.joelonsoftware.com/articles/fog0000000043.html)的额外优势。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T21:52:08.887

在下一个版本的 Visual Studio 中，这一功能已被宣布为一项新功能。也许您可以在预构建脚本中执行此操作；根据 configurationname env 变量替换配置文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T22:11:40.423

还有一个选择：切换到将您的应用程序配置存储在数据库中。我将类型值保存在数据库中，以便对这些设置的管理更加集中。然后我的配置文件有一个专用于 Config 的连接字符串，它只有两个键：一个唯一的应用程序 ID 值和配置版本（即“dev”、“test”等）。然后我只需将正确的配置文件部署到正确的环境。

这可能不是您正在寻找的；它是一种便于管理配置数据的替代方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T10:55:31.350

我对 Xian 的回答的问题是，如果您添加一个新的配置设置/端点，您必须记住跨多个文件执行此操作。如果您忘记这样做，那么您只会在部署到受影响的环境时才知道（不好）。

相反，您可以拥有一个主配置并使用 regex/xmlpoke(nant)/[your-favorite-text-manipulator] 在构建/部署时对文件进行按摩，以便为每个环境插入正确的值，并将所有环境的设置保留在另一个文件（但至关重要的是全部在一起）。

然后你只需要维护一个配置文件和一个环境设置文件——我认为从长远来看，这会使维护变得更容易和更清晰。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T21:48:07.960

我们使用几种不同的方法。

Environment.MachineName.config（针对用户）

```
 System.Configuration.ExeConfigurationFileMap fileMap = new System.Configuration.ExeConfigurationFileMap();

        if (System.IO.File.Exists(String.Format("./{0}.config", Environment.MachineName)))
            fileMap.ExeConfigFilename = String.Format(@"./{0}.config", Environment.MachineName);
        else
            fileMap.ExeConfigFilename = "live.config";

        System.Configuration.Configuration config = System.Configuration.ConfigurationManager.OpenMappedExeConfiguration(fileMap, System.Configuration.ConfigurationUserLevel.None); 
```

#IF 调试 debug.config

#IF 测试 test.config

#IF 产品 prod.config

```
 System.Configuration.ExeConfigurationFileMap fileMap = new System.Configuration.ExeConfigurationFileMap();

#if (DEBUG)
            fileMap.ExeConfigFilename = "./debug.config";
#elif (TEST)
            fileMap.ExeConfigFilename = "./test.config";
#else
            fileMap.ExeConfigFilename = "./production.config";
#endif

            System.Configuration.Configuration config = System.Configuration.ConfigurationManager.OpenMappedExeConfiguration(fileMap, System.Configuration.ConfigurationUserLevel.None); 
```

但它可能会变得乏味。

# xml - 您可以在 XML 中保留前导和尾随空格吗？

> ID：414631
> 
> 赞同：9
> 
> 时间：2009-01-05T21:46:17.167
> 
> 标签：xml, parsing, whitespace

如何告诉 XML 解析器尊重前导和尾随空格？

```
Dim xml: Set xml = CreateObject("MSXML2.DOMDocument")
xml.async = False
xml.loadxml "<xml>1 2</xml>"
wscript.echo len(xml.documentelement.text) 
```

上面打印出3。

```
Dim xml: Set xml = CreateObject("MSXML2.DOMDocument")
xml.async = False
xml.loadxml "<xml> 2</xml>"
wscript.echo len(xml.documentelement.text) 
```

上面打印出 1。（我希望它打印 2）。

我可以在 xml 文档本身中添加一些特别的东西来告诉解析器在文档中保持前导和尾随空格吗？

**澄清 1**：是否有一个属性可以在文档开头指定一次以应用于所有元素？

**澄清 2**：因为实体的内容可能有 unicode 数据，但 xml 文件需要是纯 ascii，所有实体都经过编码——这意味着 CDATA 很遗憾不可用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T04:50:46.873

正如我评论的那样，**所有推荐使用的答案`xml:space="preserve"`都是错误**的。

**该`xml:space`属性只能用于控制仅空白节点的处理**，即**完全**由空白字符组成的文本节点。

当前的问题根本不是这种情况。

事实上，下面提供的代码正确地获得了包含在以下内容中的文本节点的长度为 2：

```
<xml> 2</xml> 
```

**这是正确获取文本节点长度的 VB 代码**（不要忘记添加对“Microsoft XML, v 3.0”的引用）：

```
Dim xml As MSXML2.DOMDocument
Private Sub Form_Load()
Set xml = CreateObject("MSXML2.DOMDocument")
xml.async = False
xml.loadxml "<xml> 2</xml>"
Dim n
n = Len(xml.documentelement.selectSingleNode("text()").nodeValue)
wscript.echo Len(n)
End Sub 
```

如果在行上放置断点：

```
wscript.echo Len(n) 
```

您会看到，当调试器中断时， 的值为`n`2，这是必需的。

**因此，此代码是**正在寻求的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T10:04:54.370

正如 Dimitre Novatchev 所提到的，对于 XML，解析器不会随意删除空格。空格是节点值的一部分。因为我不会说 Visual Basic，所以这里有一个带有 [libxml](http://xmlsoft.org/)的 C 程序，它打印第一个文本节点的长度。绝对不需要设置 xml:space。

```
% ./whitespace "<foo> </foo>"
Length of " " is 1

% ./whitespace "<foo> 2</foo>"
Length of " 2" is 2

% ./whitespace "<foo>1 2</foo>" 
Length of "1 2" is 3 
```

这是程序：

```
#include <stdio.h>
#include <string.h>
#include <libxml/parser.h>

int
main(int argc, char **argv)
{
    char           *xml;
    xmlDoc         *doc;
    xmlNode        *first_child, *node;
    if (argc < 2) {
        fprintf(stderr, "Usage: %s XML-string\n", argv[0]);
        return 1;
    }
    xml = argv[1];
    doc = xmlReadMemory(xml, strlen(xml), "my data", NULL, 0);
    first_child = doc->children;
    first_child = first_child->children;        /* Skip the root */
    for (node = first_child; node; node = node->next) {
        if (node->type == XML_TEXT_NODE) {
            fprintf(stdout, "Length of \"%s\" is %i\n", (char *) node->content,
                    strlen((char *) node->content));
        }
    }
    return 0;
} 
```

# iphone - iPhone 开发环境（从头开始）

> ID：414636
> 
> 赞同：29
> 
> 时间：2009-01-05T21:48:19.020
> 
> 标签：iphone, cocoa-touch

我的整个职业生涯都在 Windows 和 .NET 上进行开发，所以请原谅我对这方面的无知。

从头开始设置 iPhone 开发环境的步骤是什么？

假设我只有电和互联网连接。

我需要什么硬件和软件？

我说的是这里的理想环境。如果它不能在 Windows 上完成，那很好。

谢谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-05T21:51:42.150

1.  您必须拥有 Intel mac ^([1](https://stackoverflow.com/questions/37822/is-it-just-the-iphone-simulator-that-is-restricted-to-intel-only-macs))和 iPhone（或 iPod Touch）
2.  您需要[**申请**iPhone 开发者计划](http://developer.apple.com/iPhone/program/)才能在您的 iPhone 上运行您的程序。您只需要在网站上**注册**即可下载 SDK 并在模拟器中运行。
3.  一旦接受开发者计划或注册，下载包含 XCode（mac 开发环境）的 iPhone SDK。XCode 出现在您的操作系统安装磁盘上，但它将是旧版本，并且没有 iPhone 库。
4.  [学习目标](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=poy&q=objective+c+tutorial&btnG=Search)C。
5.  遵循一些 iPhone 特定教程或[斯坦福的在线 iPhone 课程](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)。

<sarcasm> 阅读这篇[卫报文章，了解如何辞掉工作并通过 iPhone 应用每天赚 20 美元](http://www.guardian.co.uk/technology/gamesblog/2009/feb/10/gameculture-apple)</sarcasm>

脚注： 1\. [iPhone 模拟器是否仅限于 Intel 的 Mac？](https://stackoverflow.com/questions/37822/is-it-just-the-iphone-simulator-that-is-restricted-to-intel-only-macs)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T21:59:28.110

michaelpryor 说了什么，再加上一本好书。我发现没有一个就不可能接近 iphone 编程。我使用的那个来自[Pragmatic Programmers](http://pragprog.com/titles/amiphd/iphone-sdk-development)。

顺便说一句，如果你想降低成本，mac mini 或入门级 macbook 很适合开发。用最少的内存获取它，自己升级到至少2G内存，因为这比苹果内存价格便宜很多。使用其中任何一个，您都应该能够重复使用现有的屏幕、键盘、鼠标、USB 磁盘等。

如果您要走 mac mini 路线，您可能希望推迟到新型号上架，因为有传言称他们将在本周宣布重大升级。

哦，你不需要下载 XCode，它在安装盘上。只需下载 SDK。

最后但并非最不重要的一点是，这可能是显而易见的，但您需要一个 iPhone 设备进行测试。您可以在 SDK 中使用模拟器，但仍需要在设备上试用。您还可以使用“临时分发”让使用设备的朋友试用您的应用程序。

祝你好运。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T22:05:19.813

最近几个月我一直在玩，所以根据最近的经验......

您需要一台 Mac、一部 iPhone 或 iPod touch，并注册 Apple 开发计划。

Mac 将花费成本 - 最便宜的方法是 Mac Mini - 如果您正在考虑二手，则必须是 Intel 的。iPhone 或 iPod touch 也是投资——而且设备必须连接到 Mac 并指定为开发设备，因此使用订阅的 iPhone 可能存在一些风险（我畏缩并为开发带来了接触）

XCode - 开发环境和 iPhone SDK 可免费下载。该文档非常好，并且有很多示例。即使是视频教程也非常适合高级概述。

我真的开始喜欢 Objective C。过去有丰富的 C 背景，但从来没有真正通过 C++ 的基本熟练工，它对 C 的薄包装方法起初看起来很奇怪，但随着使用的增加，欣赏确实增加了。如果您了解 C，那么它只不过是通常的“学习新语言/SDK”挑战。如果您不了解 C 或对指针、内存分配等的使用不满意，那么这可能是一个巨大的学习曲线，并且会使任何硬件投资黯然失色。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-06T14:17:34.843

人们一直遗漏的一件事：如果您购买的是二手 Mac，请确保它是 Intel Mac，而不是 PPC。iPhone SDK 并未正式在 PPC 硬件上运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T23:56:57.153

只是关于“需要 Mac”这一点的旁注。我刚买了一个用于无关的开发工作，并出于好奇试图获取 iPhone SDK。不走运：我所拥有的只是 PPC Mac 上的 Tiger（OS X 10.4），而 Apple 说我需要 Intel 上的 10.5.5 才能获得当前可下载的版本。

# asp.net - 客户端上的 ASP.NET AJAX 和 DateTime 格式

> ID：414639
> 
> 赞同：2
> 
> 时间：2009-01-05T21:49:07.787
> 
> 标签：asp.net, datetime, asp.net-ajax, datetime-format

所以我终于得到了我的 WCF 服务设置并通过 ASP.NET AJAX 与浏览器对话。但是我发现当我用我的数据填充一个 html 表时......日期时间格式如下所示：

2009 年 1 月 2 日星期五 15:27:12 GMT-0500（东部标准时间）

在服务器上，我使用的是 .NET DateTime 格式。我应该使用其他东西并在服务器上完成工作吗？或者有什么简单的方法可以通过 JavaScript（ASP.NET AJAX 或 jQuery）在客户端解决这个问题？

我只喜欢 'Jan 02 2009 15:27:12' 部分。我想我可以使用 substring()，但我错过了什么吗？

**更多信息：** 我发现返回浏览器的数据是一个有效的 JavaScript Date 对象。
因此，您可以使用任何本机 JavaScript Date 函数来处理该值或...您可以使用 .toString().substring() 并修剪掉您不想要的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T07:15:42.400

由于您使用的是 ASP.NET Ajax，因此您可以在 javascript 中对 Date 对象调用 format，这与在 .NET 中的方式类似。例如：

```
var myDateString = myServiceObject.Date.format("d"); //short date pattern 
```

或自定义模式...

```
var myDateString2 = myServiceObject.Date.format("yyyy/mm/dd"); //some custom pattern.. 
```

在此处找到支持的格式字符串列表：http: [//seejoelprogram.wordpress.com/2008/08/07/supported-number-and-datetime-format-strings-in-aspnet-ajax/](http://seejoelprogram.wordpress.com/2008/08/07/supported-number-and-datetime-format-strings-in-aspnet-ajax/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T21:53:56.497

当您打印该值时，您应该能够以浏览器的本机格式打印它，

或者，如果您想在 web 服务中使用它，请返回一个字符串`return yourDatetimeVaiable.Tostring(cultureinfo);`

或类似的东西...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-19T08:00:55.407

第二个答案包含不正确的格式字符串。它会写成：

```
var myDateString2=myServiceObject.Date.format("yyyy/MM/dd"); 
```

mm 代表分钟，而不是月份。

# wpf - WPF 仅强制一个应用程序实例

> ID：414642
> 
> 赞同：35
> 
> 时间：2009-01-05T21:50:03.510
> 
> 标签：wpf, runtime, instance

如何只允许 WPF 应用程序的一个实例运行？

谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-03-30T09:11:23.320

[http://blogs.microsoft.co.il/blogs/arik/archive/2010/05/28/wpf-single-instance-application.aspx](http://blogs.microsoft.co.il/blogs/arik/archive/2010/05/28/wpf-single-instance-application.aspx)

正如其他一些示例所建议的那样，不需要 VB.DLL。有 WPF 示例代码。将任何 cmd 行参数传递给初始实例。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-05T22:37:48.733

Try this: [Single instance application](https://pietschsoft.com/post/2009/01/02/single-instance-wpf-application-in-net-3). Ive used the second method and it works fine.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-12T20:31:13.060

查看此解决方案：[仅允许 WPF 应用程序的一个实例执行](http://nikosbaxevanis.com/blog/2010/10/11/allowing-only-one-instance-of-a-wpf-application-to-execute/)

这不仅会强制执行应用程序的一个实例，而且还会在运行应用程序的其他实例时为您当前的应用程序提供焦点。我限制一个实例的互斥解决方案实际上与上面的链接不同，但我喜欢这个解决方案的“焦点”元素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-20T12:31:06.540

我使用这个辅助方法并从 application.startup 事件中调用它

```
 Public Sub ForceSingleInstanceApplication()
        'Get a reference to the current process
        Dim MyProc As Process = Process.GetCurrentProcess

        'Check how many processes have the same name as the current process
        If (Process.GetProcessesByName(MyProc.ProcessName).Length > 1) Then
            'If there is more than one, it is already running
            MsgBox("Application is already running", MsgBoxStyle.Critical, My.Application.Info.Title) 'Reflection.Assembly.GetCallingAssembly().GetName().Name)
            ' Terminate this process and give the operating system the specified exit code.
            Environment.Exit(-2)
            Exit Sub
        End If
    End Sub 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-01T11:38:54.430

用户`sobelito`链接[了此](http://blogs.microsoft.co.il/arik/2010/05/28/wpf-single-instance-application/)帖子，该帖子具有以下[更新](http://blogs.microsoft.co.il/arik/2011/04/04/wpf-single-instance-application-update/)。它说的是，对于更新的资源，您应该使用[Windows 7 Taskbar Single Instance](https://code.msdn.microsoft.com/Windows-7-Taskbar-Single-4120eafd)，如果您查看源代码，您可以做您需要的事情。

您可以使用`SingleInstance`c# 项目。它还包含 WinForms 和 WPF 的示例。

请注意，它也是在 Apache 2.0 许可下发布的，这与 Arik 在 Microsoft 博客中的 Poznanski 帖子不同，后者 (IANAL, AFAIK) 尚未商业化。

# php - 在 PHP 中应用差异

> ID：414652
> 
> 赞同：3
> 
> 时间：2009-01-05T21:52:42.723
> 
> 标签：php, diff, pear, patch

我正在使用 Text_Diff PEAR 包来区分短文本文档，其中 Text_Diff 对象是使用每个文档中以空格分隔的单词列表创建的。我希望将差异存储在数据库中，然后在再次加载文件时应用它。有没有一种简单的方法来应用这个差异，还是我需要编写一个函数来解析它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T23:16:26.813

php xdiff 扩展支持文件和字符串的修补。查看 Text_Diff 的源代码，我发现它使用 xdiff 来执行差异。您应该能够使用[xdiff_string_patch()](http://www.php.net/manual/en/function.xdiff-string-patch.php)或它的一些兄弟函数进行修补。

# c# - 从托管代码中获取安装日期

> ID：414653
> 
> 赞同：7
> 
> 时间：2009-01-05T21:53:27.107
> 
> 标签：c#, wix, windows-installer

是否有使用产品 GUID 检索应用程序安装日期的托管 API？

谢谢。斯科特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T00:41:23.570

谢谢罗伯！我在下面添加了一个完整的 C# 示例。

```
 [DllImport("msi.dll", CharSet = CharSet.Unicode)]
    static extern Int32 MsiGetProductInfo(string product, string property, [Out] StringBuilder valueBuf, ref Int32 len);

    static void Main(string[] args)
    {
        Int32 len = 512;
        var builder = new StringBuilder(len);
        MsiGetProductInfo("{0db93d2f-a9e7-417f-9425-5e61e82c0868}", "InstallDate", builder, ref len);

        var installDate = DateTime.ParseExact(builder.ToString(), "yyyyMMdd", CultureInfo.InvariantCulture);

        Console.WriteLine(installDate);
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T00:09:39.470

获取该信息的“正确”方法是使用 ::MsiGetProductInfo()。PInvoke 应该是微不足道的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T22:32:18.697

我不知道有什么 API 可以做到这一点，但您可以尝试直接从注册表中读取值。检查以下键：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{product-id}
    InstallDate = 20081004 
```

存储在卸载键下的信息显示在控制面板 -> 添加或删除程序中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T13:18:02.673

注册表中的 InstallDate 键并不总是存在，尤其是当程序尚未通过 MSI 安装时（例如*Adob​​e Flash Player Plugin、DAEMON Tools、7-ZIP、Picasa、TeamViewer、Mozilla Firefox*）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-26T23:36:55.263

另一种“正确”的方法是获取安装程序添加的“确定”某些文件的创建日期。在我的情况下，它是由 Inno setup v5 （重新）创建的“unins000.exe”。不涉及 PInvoke，只需使用 FileInfo 的 Exists 和 CreationTime 属性！

# javascript - Javascript HAML 编辑器

> ID：414660
> 
> 赞同：3
> 
> 时间：2009-01-05T21:56:19.550
> 
> 标签：javascript, haml

有人知道基于 Javascript 的[HAML](http://haml.hamptoncatlin.com/)编辑器吗？我正在寻找像[TinyMCE](http://tinymce.moxiecode.com/)这样的东西，它只理解 HAML（所以它可以正确缩进和突出显示）

我正在考虑将这样的编辑器用于我正在构建的动态网站。

**澄清** 我正在构建的站点允许用户定义布局（在 Rails 意义上）和 css。所以需要比纺织品和降价更精细的粒度控制，我知道我可以在降价中包含原始 html，但 haml 更漂亮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T18:40:51.427

HAML 被设计成一种更优雅的方式来定义页面结构；它不打算用于格式化文本，就像你要求它做的那样。

在这种情况下，您最好使用[Markdown](http://daringfireball.net/projects/markdown/)或[Textile](http://www.textism.com/tools/textile/)之类的东西。这两个都已经有所见即所得（[对于 Markdown](http://wmd-editor.com/)，[对于 Textile](http://slateinfo.blogs.wvu.edu/plugins/textile_editor_helper)（[分叉版](http://github.com/felttippin/textile-editor-helper/tree/master)）），并且 Haml 有内置的过滤器来将其转换为 HTML。

例如：

```
#content
  :markdown
    @post.body 
```

（Haml 美妙的空格缩进甚至会在输出时保留！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T17:30:19.477

我注意到这个问题已经有一段时间没有回答了。虽然这不是一个完整的答案，但您可能需要查看[MarkItUp](http://markitup.jaysalvat.com/home/)。它特别*不是*所见即所得的编辑器，而是一个可扩展且友好的标记编辑器。它不直接支持 HAML，但很容易扩展它以支持不同的语言。它还可以对服务器进行 AJAX 往返，因此您可以使用服务器端渲染器预览标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T01:56:37.817

我有一些非常基本的东西正在运行，用于[解释 javascript HAML 代码](http://jhaml.com)。或者，您可以直接访问[jHaml javascript 源代码](http://jhaml.com/scripts/jhaml-0.1.js)。

# svn - 如何设置 Continuum 以构建 svn 提交？

> ID：414662
> 
> 赞同：4
> 
> 时间：2009-01-05T21:56:28.537
> 
> 标签：svn, maven-2, continuous-integration, cruisecontrol, continuum

直到最近一个项目需要它时，我才尝试将**Continuum**作为构建服务器。我很欣赏与 Maven 构建的集成，但是我一直无法找到一种方法让 Continuum 在每次**Subversion 提交**时构建我的项目（如**CruiseControl**）。

报告了几个与从配置的 SCM**触发构建**的主题相关的问题/错误......但所有似乎都因重复问题而关闭。 ***有没有人让它工作或对如何实施它有任何建议？***

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:36:37.780

通常，我使用 svn 中的 post-commit 挂钩来调用命令或发布到 url。这几乎就是一切与 svn 集成的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T13:20:05.590

要集成 Keith 答案：您必须使用[XML-RPC](http://continuum.apache.org/docs/1.2.3/developer_guides/xmlrpc.html)接口通知 continuum。

# sql - 有没有办法用十六进制表示 Postgres 文字 int？

> ID：414664
> 
> 赞同：22
> 
> 时间：2009-01-05T21:57:22.137
> 
> 标签：sql, postgresql

我有一个很大的十六进制数字列表，我想插入到 PostgresQL 表中。我试过这样的事情：

```
INSERT INTO foo (i)
VALUES (0x1234); 
```

...但这没有用。这可能吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-05T22:28:30.703

As you've noted, you can start with a [bit-string constant](http://www.postgresql.org/docs/8.3/interactive/sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS) written in hexadecimal, and then [type-cast it](http://www.postgresql.org/docs/8.3/interactive/sql-expressions.html#SQL-SYNTAX-TYPE-CASTS) to the type you want. So,

```
INSERT INTO foo (i) VALUES (CAST(x'1234' AS int)) 
```

or

```
INSERT INTO foo (i) VALUES (x'1234'::int) -- postgres-specific syntax 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-05T22:18:17.010

This seems to work:

```
 CAST(X'3e000000' AS INT) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-08T21:31:03.583

你可以使用

```
x'1234'::int; 
```

有关更多信息，请参阅我的帖子，

*   [如何在 PostgreSQL 中编写十六进制文字？](https://dba.stackexchange.com/q/203358/2639)

# iis - IIS6 FTP 忽略 NTFS 文件权限？

> ID：414676
> 
> 赞同：0
> 
> 时间：2009-01-05T22:02:04.173
> 
> 标签：iis, ftp, ntfs

在 Intranet 环境中，我设置了一个 FTP 服务器，用于将文件发布到网站。用户连接到生产 FTP 服务器（允许）发布文件（允许），然后导航到不属于她的文件夹（允许），然后在那里写入文件（FTP 允许，但 NTFS 不允许。）

只有管​​理员和系统有权写入该文件夹，并且她不是任何组的管理员。

FTP 是否忽略 NTFS 证券？她是如何写到一个她只有读权限的网站的？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-05T22:08:19.417

IIS 应该尊重 NTFS 权限。如果无法查看您的 ACL，很容易怀疑您的权限设置错误。如果您在目录上运行 cacls 并发布结果，这可能会很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T22:18:21.470

FTP 服务以什么用户身份运行？它可能正在检查用户的权限而不是登录用户。我希望（但不确定）Microsoft FTP 服务器（或与 MS 专有的东西紧密集成的服务器）将充当登录的用户，但第三方可能会以任何用户运行的方式访问文件服务（系统或本地服务？）。

# python - 将类添加到 Django label_tag() 输出

> ID：414679
> 
> 赞同：31
> 
> 时间：2009-01-05T22:05:15.540
> 
> 标签：python, django, forms, newforms

我需要一些方法来将类属性添加到`label_tag()`表单字段的方法的输出中。

我看到可以传入`attrs`字典，并且我已经在 shell 中对其进行了测试，我可以执行以下操作：

```
for field in form:
    print field.label_tag(attrs{'class':'Foo'}) 
```

我会`class='Foo'`在我的输出中看到 ，但我看不到`attrs`从模板中添加参数的方法 - 事实上，模板是专门针对这一点设计的，不是吗？

我的表单定义中有没有办法定义要在标签中显示的类？

在表格中，我可以执行以下操作来为输入提供一个类

```
self.fields['some_field'].widget.attrs['class'] = 'Foo' 
```

我只需要让它也输出类`<label />`。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-20T17:49:31.413

**技术1**

我对另一个答案的断言提出异议，即过滤器会“不那么优雅”。如您所见，它确实非常优雅。

```
@register.filter(is_safe=True)
def label_with_classes(value, arg):

    return value.label_tag(attrs={'class': arg}) 
```

在模板中使用它同样优雅：

```
{{ form.my_field|label_with_classes:"class1 class2"}} 
```

**技巧2**

或者，我发现的一种更有趣的技术是：[将 * 添加到必填字段](https://thebitguru.com/blog/908-adding-to-required-fields)。

您为 BoundField.label_tag 创建一个装饰器，该装饰器将在适当设置*attrs的情况下调用它。*然后你猴子修补 BoundField 以便调用 BoundField.label_tag 调用装饰函数。

```
from django.forms.forms import BoundField

def add_control_label(f):
    def control_label_tag(self, contents=None, attrs=None):
        if attrs is None: attrs = {}
        attrs['class'] = 'control-label'
        return f(self, contents, attrs) 
    return control_label_tag

BoundField.label_tag = add_control_label(BoundField.label_tag) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-12-19T18:16:02.380

如何将 CSS 类添加到 forms.py 中的表单字段，例如：

```
class MyForm(forms.Form):
    title = forms.CharField(widget=forms.TextInput(attrs={'class': 'foo'})) 
```

然后我只需在模板中执行以下操作：

```
<label for="id_{{form.title.name}}" class="bar">
    {{ form.title }}
</label> 
```

当然，这可以很容易地修改为在模板中的 for 循环标记中工作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-06T08:00:00.127

自[定义模板标签](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/#howto-custom-template-tags)似乎是解决方案。自定义过滤器也可以，尽管它可能不那么优雅。但是在这两种情况下，您都需要回退到自定义表单呈现。

如果这是一项非常重要的任务；我将创建一个 Mixin，它允许我使用标签类注释表单字段并使用这些类提供表单呈现方法。以便以下代码有效：

```
{{ form.as_table_with_label_classes }} 
```

但我想问一下；你真的需要标签标签上的类吗？我的意思是 HTML 设计方面。是否绝对有必要在其中*添加*一个类？难道不能用一些 CSS 来解决，比如：

```
encapsulating_selector label {
    some-attr: some-value;
} 
```

我有时会在这种情况下使用[jQuery](http://jquery.com)；*如果它有效，它会改进页面，但如果它不起作用，它不会是一场灾难*。并保持 HTML 源代码尽可能精简。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-31T05:47:09.330

我同意第一个答案，使用 css 可以做到这一点，但是。这是在 django 源代码中的原因是什么？

在 django.forms.forms.py 中有这个定义，显示`attrs`了标签中显示的代码：

```
class BoundField(StrAndUnicode): 
    ...
    def label_tag(self, contents=None, attrs=None):
        contents = u'<label for="%s"%s>%s</label>' % (widget.id_for_label(id_), attrs, unicode(contents)) 
```

但`_html_output`在没有 attrs 的情况下调用此函数：

```
label = bf.label_tag(label) or '' 
```

因此，django 似乎已部分准备好执行此操作，但实际上并没有使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-30T11:59:59.683

有点太晚了，但遇到了类似的问题。希望这对您有所帮助。

```
class MyForm(forms.ModelForm):

    def __init__(self, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        self.fields['myfield1'].widget.attrs.update(
            {'class': 'form-control'})
        self.fields['myfield2'].widget.attrs.update(
            {'class': 'form-control'})

    def as_two_col_layout(self):

        return self._html_output(
            normal_row='<div class="form-group"><span class="col-xs-2">%(label)s</span> <div class="col-xs-10">%(field)s%(help_text)s</div></div>',
            error_row='%s',
            row_ender='</div>',
            help_text_html=' <span class="helptext">%s</span>',
            errors_on_separate_row=True)

    class Meta:

        model = mymodel
        fields = ['myfield1', 'myfield2'] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-30T11:08:07.647

```
class CustomBoundField(BoundField):
    def label_tag(self, contents=None, attrs=None):
        if self.field.required:
            attrs = {'class': 'required'}
        return super(CustomBoundField, self).label_tag(contents, attrs)

class ImportViewerForm(forms.Form):
    url = fields.URLField(widget=forms.TextInput(attrs={'class': 'vTextField'}))
    type = fields.ChoiceField(choices=[('o', 'Organisation'), ('p', 'Program')], widget=forms.RadioSelect,
                              help_text='Url contain infornation about this type')
    source = fields.ChoiceField(choices=[('h', 'hodex'), ('s', 'studyfinder')], initial='h', widget=forms.RadioSelect)

    def __getitem__(self, name):
        "Returns a BoundField with the given name."
        try:
            field = self.fields[name]
        except KeyError:
            raise KeyError('Key %r not found in Form' % name)
        return CustomBoundField(self, field, name)

class Media:
    css = {'all': [settings.STATIC_URL + 'admin/css/forms.css']} 
```

您需要更改 BoundField 类中的 label_tag 方法，并在表单中使用它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-31T18:52:51.863

```
@register.simple_tag
def advanced_label_tag(field):
    """ Return form field label html marked to fill by `*` """
    classes = []
    attrs = {}
    contents = force_unicode(escape(field.label))

    if field.field.required:
        classes.append(u'required')
        contents = force_unicode('%s <span>*</span>'%escape(field.label))

    if classes:
        attrs['class'] = u' '.join(classes)

    return field.label_tag(contents=contents, attrs=attrs) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-27T22:59:15.213

我们也可以使用 {{field.label}} 和 {{field.id_for_label}}

`<label class="your_class_name" id="{{form.link.id_for_label}}">{{form.link.label}}</label>`

以 HTML 格式呈现 -

```
<label class="your_class_name" id="id_name">Name</label> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-22T13:12:53.263

注意：希望即将到来的 Django 4.0 将使这一切变得更容易，因为它提供了[基于模板的表单渲染](https://docs.djangoproject.com/en/dev/releases/4.0/#template-based-form-rendering)。

直到那时：

OP 要求一种在表单定义中使用[BoundField.label_tag()的方法。](https://docs.djangoproject.com/en/stable/ref/forms/api/#django.forms.BoundField.label_tag)

[user240515](https://stackoverflow.com/a/11584458)和[user2732686](https://stackoverflow.com/a/18531433)的回答确实提供了一些实施建议，但没有提供任何理由。大多数其他基于自定义模板标签的解决方案都需要我们手动渲染表单字段，因此如果我们只是想使用`{{ form }}`.

因此，除了所有这些答案之外，这里还尝试提供更多背景信息。

## 关于 label_tag

表单标签由`BaseForm.as_table()`、`as_ul()`或`as_p()` [快捷方式](https://docs.djangoproject.com/en/stable/ref/forms/api/#more-granular-output)通过“私有”`BaseForm._html_output()`方法呈现，如[源代码](https://github.com/django/django/blob/stable/3.2.x/django/forms/forms.py#L270)所示。

这是通过调用来完成的`BoundField.label_tag()`，如[这里](https://github.com/django/django/blob/stable/3.2.x/django/forms/forms.py#L218)所示。label_tag [()](https://docs.djangoproject.com/en/stable/ref/forms/api/#django.forms.BoundField.label_tag)方法接受一个`attrs`带有标记的附加 HTML 属性的参数`<label>`。

但是，问题在于没有, 的`BaseForm._html_output()`调用，并且没有简单的替代方法来设置参数。`label_tag()``attrs``attrs`

## 如何扩展 label_tag？

Django通过扩展其方法`contrib.admin`解决了这个问题，从[源代码](https://github.com/django/django/blob/stable/3.2.x/django/contrib/admin/helpers.py#L141)中可以清楚地看出。`label_tag()``AdminField`

为了扩展`BoundField.label_tag()`，我们可以[创建一个自定义的 BoundField](https://docs.djangoproject.com/en/stable/ref/forms/api/#customizing-boundfield)：

```
class MyBoundField(forms.BoundField):
    def __init__(self, form, field, name, label_attrs=None):
        super().__init__(form, field, name)
        self.label_attrs = label_attrs

    def label_tag(self, contents=None, attrs=None, label_suffix=None):
        if attrs is None:
            attrs = dict()
        attrs.update(self.label_attrs or {})
        return super().label_tag(contents, attrs, label_suffix) 
```

现在我们可以创建一个带有特定标签属性的绑定字段，但是我们如何处理它呢？

## 如何使用自定义绑定字段？

绑定字段是使用[forms.Field.get_bound_field()](https://docs.djangoproject.com/en/stable/ref/forms/api/#django.forms.Field.get_bound_field)实例化的，因此，我们可以重写该方法以返回我们的自定义绑定字段：

```
class MyField(forms.Field):
    # note typically we would use any of django's forms.Field subclasses
    def __init__(self, *args, **kwargs):
        # we could also set label_attrs here, based on the field properties
        self.label_attrs = kwargs.pop('label_attrs', None)
        super().__init__(*args, **kwargs)

    def get_bound_field(self, form, field_name):
        return MyBoundField(
            form=form, field=self, name=field_name, label_attrs=self.label_attrs) 
```

然后我们可以使用我们的自定义字段`Form`：

```
class MyForm(forms.Form):
    some_field = MyField(..., label_attrs={'class': 'my-class'}) 
```

但是如果我们想对所有的表单域都这样做呢？

## 如何为所有表单字段使用自定义绑定字段？

最后，`Field.get_bound_field()`被调用`BaseForm.__getitem__()`（参见[源代码](https://github.com/django/django/blob/stable/3.2.x/django/forms/forms.py#L163)）。这意味着我们可以通过调用 eg 来获得一个绑定字段`my_form['some_field']`。

为了对所有表单字段使用我们的自定义绑定字段，我们可以为表单中的所有字段添加[猴子补丁](https://stackoverflow.com/a/395006) `field.get_bound_field`，或者我们可以覆盖表单`__getitem__()`以忽略`get_bound_field()`并直接使用`MyBoundField`。

这是一个覆盖的示例，它主要是[原始 source](https://github.com/django/django/blob/stable/3.2.x/django/forms/forms.py#L150)的副本，除了以下`MyBoundField`行：

```
class MyForm(forms.Form):
    label_attrs = {'class': 'my-class'}

    def __getitem__(self, name):
        """Return a MyBoundField with the given name."""
        try:
            field = self.fields[name]
        except KeyError:
            ...  # left out for clarity
        if name not in self._bound_fields_cache:
            self._bound_fields_cache[name] = MyBoundField(
                form=self, field=field, name=name, label_attrs=self.label_attrs)
        return self._bound_fields_cache[name] 
```

最后，这对于一些造型来说似乎*很*麻烦。

# testing - 如何测试标准 HTML 表单

> ID：414680
> 
> 赞同：7
> 
> 时间：2009-01-05T22:05:18.907
> 
> 标签：testing, forms

哪些工具最适合 HTML 表单的轻量级测试？我的特殊用途**很轻：**没有多线程问题，也没有复杂的测试脚本：只需填写一个具有特定值的表格，然后让**我**点击提交。

一个Firefox插件会很好......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T22:08:58.743

你看过[Selenium IDE](http://seleniumhq.org/)还是不适合轻量级？

它是一个 Firefox 插件，虽然它确实使用脚本，但它可以毫不费力地录制和播放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T22:10:01.987

试试[Firefox 的自动填充表单](https://addons.mozilla.org/en-US/firefox/addon/4775)。可定制并承诺一键填写每张表格:-)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:21:39.390

你可以试试 Selenium IDE ......

关注白兔：[http ://seleniumhq.org/](http://seleniumhq.org/)

# wix - 如何将整个目录或项目输出添加到 WiX 包

> ID：414685
> 
> 赞同：53
> 
> 时间：2009-01-05T22:06:46.567
> 
> 标签：wix, installation, build-automation, paraffin

我们决定从 VS 集成设置切换到 WiX。

但是，我们目前所做的是使用项目输出文件作为设置项目的输入。这使我们可以轻松地将应用程序文件添加到目录（用于图像、示例和其他资源......），并且这些文件会在我们构建时自动添加到设置中。

我在 WiX 中找不到任何类似的功能。WiX 似乎对每个目录和文件都需要一个目录条目和一个文件条目。这将要求我们在每次添加文件时更改 WiX 源，在我看来，这是令人望而却步的，因为我们有这么多的文件。

有没有使用 WiX 的集成方式，或者我必须编写自己的任务来创建 WiX 源，然后再调用蜡烛？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-05T23:18:55.437

对于 WiX 2.0，tallow 非常有限；石蜡和锦葵提供额外的功能。对于 WiX 3.0，热量提供与牛脂相同的功能，但要好一些。

就我而言，我使用了锦葵源并进行了一些修改并使用了它，因为石蜡需要 3.5 版本的 .Net。

你可以用[锦葵](http://www.infozoom.de/download/Mallow.zip)

或用于生成 WiX 片段的石蜡工具： [入门](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/10/18/wix-hints-for-new-users-part-1-of-3.aspx)、 [WiX 的痛苦](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/10/19/wix-the-pain-of-wix-part-2-of-3.aspx)、 [更好的牛油、石蜡](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/10/21/wix-a-better-tallow-paraffin.aspx)、 [下载](http://www.wintellect.com/cs/files/folders/4332/download.aspx)、 [WiX 3.0 的石蜡](http://www.wintellect.com/CS/blogs/jrobbins/archive/2008/12/22/paraffin-3-0-now-with-full-wix-3-0-support.aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-04-25T21:04:06.077

为此，我一直在 WIX 3.5 中使用 heat.exe。上次我检查时，[文档](http://wix.sourceforge.net/manual-wix3/heat.htm)不是最新的 3.5 版本，所以请记住这一点。

这是一个例子：

> "$(WIX)bin\heat.exe" 目录 "$(SourcePath)" -cg MyFiles -gg -scom -sreg -sfrag -dr INSTALLDIR -out "$(ProjectDir)Fragments\FileFragment.wxs" -var wix.InstallerPath

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T23:28:56.967

正如其他人所指出的，MapGuide 开源项目目前正在使用 John Robbins 的[Paraffin 3.0 。](http://www.wintellect.com/CS/blogs/jrobbins/archive/2008/12/22/paraffin-3-0-now-with-full-wix-3-0-support.aspx)

基本上，对于给定的发布版本，第一次运行我们的安装程序脚本时，我们将使用“[生成](http://trac.osgeo.org/mapguide/browser/trunk/Installer/build.bat#L333)”操作为源文件夹创建新的 .wxs 文件，每个文件都有特定的选项。

在同一版本的后续构建中，调用“ [regen](http://trac.osgeo.org/mapguide/browser/trunk/Installer/build.bat#L232) ”操作以确保使用已添加的任何新文件/目录更新 .wxs 文件。

[正如Brian Rogers 所写](http://icumove.spaces.live.com/blog/cns!FB93073C6534B681!461.entry)，我相信 Heat v3 现在也允许您做很多（或者可能全部？）这方面的工作。我仍然对 Paraffin 通过维护静态 GUID 更明确地执行此操作的方式感到更自在，但当前的 Heat 看起来是一个不错的选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T22:31:42.257

经过进一步研究，似乎有一个名为tallow.exe 的包含二进制文件可以做到这一点。它通过递归搜索文件从目录创建片段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T22:29:56.363

在我使用 WIX 时，我从未遇到过让您一次添加整个文件目录的功能。这是因为给定文件有多种使用方式（系统不知道您以后是否要引用该文件夹中的特定文件等......并且它需要知道它们），而且因为安装本身需要非常具体。

这不会阻止您为 WIX 编写自己的前端，该前端将在解析目录结构的内容后生成 WIX XML 文件（或其中的一部分）。这基本上就是我们在工作中使用的系统之一。这与任何代码或文本文件生成实用程序的想法相同。只需遍历树，并生成适当的文本。

编辑：这样，您可以将 WIX 视为用于定义设置的“低级语言”，并将您的实用程序视为“高级语言”。如果您需要帮助编写一个，请告诉我们。

此外，您可以通过将此实用程序添加到 VStudio 中的自定义构建步骤来生成 WIX 文件作为构建过程的一部分。这样，您实际上就没有任何人构建的“保存的 WIX 文件”，系统只是在最后构建它，并在构建后步骤自动考虑新文件。

# keyboard - 紧凑型键盘推荐？

> ID：414703
> 
> 赞同：5
> 
> 时间：2009-01-05T22:15:38.357
> 
> 标签：keyboard, peripherals

对高质量紧凑型（无数字键盘）键盘有什么建议，最好是 50 美元或更少？

标准：

*   50美元或更少
*   最好使用笔记本电脑式的按键（剪刀式开关而不是橡胶膜 ala 便宜的桌面键盘）
*   安静（我是 Model-M 类型的人，但这对于嘈​​杂的键盘来说不是一个好环境）
*   不要太在意媒体密钥、USB 端口等

我喜欢 Apple 无线键盘，也听过其他人推荐的 Happy Hacking 键盘，但它们都超出了我们的预算。

有几个关于键盘的问题（检查“外围设备”标签），但据我所知，没有关于紧凑型键盘的问题。没有人比程序员对键盘的要求更高，所以虽然这是一个有点主观的问题，但我认为这是最好的提问场所。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T22:30:46.533

这似乎与您正在寻找的内容足够接近：

[**BTC 6100C 银黑 86 普通键 9 功能键 USB 超薄多媒体键盘**](http://www.newegg.com/Product/Product.aspx?Item=N82E16823110006)

*   花费 20 美元
*   它具有带剪刀开关的笔记本电脑式按键
*   它有媒体键，这听起来对你来说不是负面的
*   它在 NewEgg 上有五个鸡蛋，有 32 条用户评论
*   不确定它是否安静，因为我没有拥有一个（评论似乎也没有提到它）

[键盘 http://www.freeimagehosting.net/uploads/9f6982eb63.jpg](http://www.freeimagehosting.net/uploads/9f6982eb63.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-31T15:44:20.200

**[TypeMatrix](http://www.typematrix.com)** （不符合您的价格要求，但为了后代）

![上面的类型矩阵键盘](https://i.stack.imgur.com/Kc08i.jpg)

*   袖珍的
*   人类工程学的
*   提供 Qwerty、Dvorak 和空白（也有各种橡胶盖）
*   笔记本电脑式按键

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T22:18:54.247

那些卷轴键盘呢？它们绝对是橡胶膜，但它们也非常安静且非常便携。如果您能找到符合您指定的所有标准的键盘，我会感到惊讶，但卷起键盘至少可以击中除其中一个之外的所有标准。

[http://www.thinkgeek.com/computing/input/5a7f/?cpg=ab](http://www.thinkgeek.com/computing/input/5a7f/?cpg=ab)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T22:25:43.593

我买了[罗技 newtouch 键盘](http://www.logitech.com/index.cfm/keyboards/keyboard/devices/3046&cl=au,en)，它的占地面积比普通键盘小，而且很棒。漂亮又安静，没有“多媒体键”，感觉很好。它作为编程键盘也很棒，因为功能键不会被其他键盘上常见的那些荒谬的“快捷方式”劫持。你按 F5 并在 Visual Studio 中构建。我是在买了感觉很好的[超平](http://www.logitech.com/index.cfm/keyboards/keyboard/devices/177&cl=au,en)之后才买的，但是按键布局很糟糕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-02T17:27:12.020

键盘布局、剪刀式开关，以及使用过 Apple 键盘但想要 Windows/Linux 键盘布局的人的好评：[GMYLE (TM) Super Slim USB 2.0 Mini Keyboard](https://rads.stackoverflow.com/amzn/click/com/B003PHJJV6)

![GMYLE 超级键盘](https://i.stack.imgur.com/6gnXk.jpg)

# console - 控制台界面教程和技巧（pdcurses）

> ID：414713
> 
> 赞同：7
> 
> 时间：2009-01-05T22:20:13.700
> 
> 标签：console, ncurses, curses, pdcurses

我正在寻找有关使用 PDCurses 库的教程。不幸的是，只有文本文档，更像是函数参考。pdcurses 是否与 ncurses 足够相似，可以使用 ncurses 教程？？？制作控制台 UI 的任何提示？？？

PS。PDCurses - mingw32。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T22:38:02.793

您始终可以将[本教程用于 Ncurses](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/)，并将 #include 从 ncurses.h 更改为 curses.h 以使用 pdcurses。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T14:06:32.070

这个[博客条目](http://cymonsgames.com/learning-curses-by-example/)不是我称之为教程的任何东西，但它看起来可能是一个有趣的起点。它还在 YouTube 上提供了一个（非常非常基本的）[视频教程。](http://cymonsgames.com/getting-started/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-14T15:50:25.813

我不知道 PDcurses 本身，但有了这样的名字，我希望它与 curses 兼容。你检查过两者之间的 API 吗？

# c++ - 使用多核使用 g++ 编译

> ID：414714
> 
> 赞同：186
> 
> 时间：2009-01-05T22:21:04.803
> 
> 标签：c++, compiler-construction, makefile, g++, multicore

快速问题：允许 g++ 生成多个自身实例以便更快地编译大型项目（例如，多核 CPU 一次 4 个源文件）的编译器标志是什么？

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2009-01-05T22:26:05.730

您可以使用 make 执行此操作 - 使用 gnu make 它是 -j 标志（这也有助于单处理器机器）。

例如，如果您想要 make 的 4 个并行作业：

```
make -j 4 
```

您还可以在管道中运行 gcc

```
gcc -pipe 
```

这将流水线化编译阶段，这也将有助于保持内核忙碌。

如果您还有其他可用的机器，您可以查看[distcc](http://distcc.samba.org/)，它也会将农场编译到这些机器上。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-01-05T22:25:57.557

没有这样的标志，并且有一个违背 Unix 的哲学，即让每个工具只执行一个功能并很好地执行它。生成编译器进程在概念上是构建系统的工作。您可能正在寻找的是 GNU make 的 -j (jobs) 标志，a la

```
使-j4
```

或者您可以使用 pmake 或类似的并行 make 系统。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-06T11:27:49.723

人们已经提到`make`但[`bjam`](http://www.boost.org/doc/tools/build/index.html)也支持类似的概念。Using`bjam -jx`指示 bjam 建立`x`并发命令。

我们在 Windows 和 Linux 上使用相同的构建脚本，使用此选项可将我们在两个平台上的构建时间减半。好的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-05T22:24:56.670

`make`会为你做这件事。研究手册页中的`-j`和`-l`开关。我不认为`g++`是可并行的。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-05-29T22:56:42.113

如果使用 make，则使用`-j`. 来自`man make`：

> ```
>  -j [jobs], --jobs[=jobs]
>        Specifies the number of jobs (commands) to run simultaneously.  
>        If there is more than one -j option, the last one is effective.
>        If the -j option is given without an argument, make will not limit the
>        number of jobs that can run simultaneously. 
> ```

最值得注意的是，如果您想编写脚本或确定可用的内核数量（取决于您的环境，并且如果您在许多环境中运行，这可能会发生很大变化），您可以使用无处不在的 Python 函数`cpu_count()`：

[https://docs.python.org/3/library/multiprocessing.html#multiprocessing.cpu_count](https://docs.python.org/3/library/multiprocessing.html#multiprocessing.cpu_count)

像这样：

```
make -j $(python3 -c 'import multiprocessing as mp; print(int(mp.cpu_count() * 1.5))') 
```

如果你问为什么`1.5`我会在上面的评论中引用用户 artless-noise：

> 1.5 数字是因为提到的 I/O 绑定问题。这是一个经验法则。大约 1/3 的作业将等待 I/O，因此剩余的作业将使用可用的内核。大于内核的数字更好，甚至可以达到 2 倍。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-08-21T15:58:17.973

distcc 也可用于分发编译，不仅在当前机器上，而且在农场中安装了 distcc 的其他机器上。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-05T22:25:31.940

我不确定 g++，但是如果您使用的是 GNU Make，那么“make -j N”（其中 N 是 make 可以创建的线程数）将允许 make 同时运行多个 g++ 作业（这么久因为文件不相互依赖）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-12-25T10:35:36.920

**GNU 并行**

我正在做[一个综合编译基准测试](https://stackoverflow.com/questions/3476093/replacing-ld-with-gold-any-experience/53921263#53921263)，懒得写一个 Makefile，所以我使用了：

```
sudo apt-get install parallel
ls | grep -E '\.c$' | parallel -t --will-cite "gcc -c -o '{.}.o' '{}'" 
```

解释：

*   `{.}`接受输入参数并删除其扩展名
*   `-t`打印出正在运行的命令，让我们了解进度
*   `--will-cite`如果您使用它发布结果，则删除引用该软件的请求...

`parallel`非常方便，我什至可以自己做一个时间戳检查：

```
ls | grep -E '\.c$' | parallel -t --will-cite "\
  if ! [ -f '{.}.o' ] || [ '{}' -nt '{.}.o' ]; then
    gcc -c -o '{.}.o' '{}'
  fi
" 
```

`xargs -P`也可以并行运行作业，但是使用它进行扩展操作或运行多个命令不太方便：[Calling multiple commands through xargs](https://stackoverflow.com/questions/6958689/calling-multiple-commands-through-xargs)

并行链接被问到：链接时[gcc 可以使用多个内核吗？](https://stackoverflow.com/questions/5142753/can-gcc-use-multiple-cores-when-linking)

TODO：我想我在某处读到编译可以简化为矩阵乘法，所以也许也可以加快大文件的单文件编译。但我现在找不到参考。

在 Ubuntu 18.10 中测试。

# batch-file - 可以搜索文件的 .bat 或 .wsh 脚本

> ID：414715
> 
> 赞同：6
> 
> 时间：2009-01-05T22:21:06.427
> 
> 标签：batch-file, scripting, wsh

我正在寻找可以执行以下操作的 .bat 或 .wsh 脚本的一些示例：

*   递归读取具有用户提供的扩展名（.dll、.exe 等）的目录中的文件名
*   在用户提供的目录中搜索上述文件名
*   生成结果的 txt 或 xls 报告，例如：x.txt was found in "C:\temp", "C:\blah"

TIA。

编辑：

糟糕，我应该澄清一下：这里有两个目录和两个搜索。

搜索 1：

*   在用户提供的目录“Dir 1”中搜索所有 *.dll。

搜索 2：

*   在不同的用户提供的目录“Dir 2”中搜索在搜索 1 中生成的文件名。此搜索还需要是递归的。

因此，如果搜索 1 在目录 1 中找到 foo.dll、foo2.dll 和 foo3.dll，则搜索 2 应在目录 2 中查找 foo.dll、foo2.dll 和 foo3.dll，并提供报告（简单列表）每个找到的文件。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-05T22:27:42.373

为什么不使用目录？

在当前目录和所有子目录中搜索 dll

> ```
> dir /S *.dll 
> ```

在所有 C 中搜索 dll

> ```
> dir /S C:\*.dll 
> ```

保存报告

> ```
> dir /S C:\*.dll > report.txt 
> ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T02:27:11.907

将以下内容放入 .bat 文件中，例如`FindAll.bat`：

```
@echo OFF

for /f %%F in ('dir %2\%1 /s /b') do (
    <nul (set /p msg=%%~nxF )
    for /f %%G in ('dir %3\%%~nxF /s /b') do (
        if exist %%G (
            @echo found at %%G
        ) 
    )
) 
```

`%1`是用户提供的文件掩码。

`%2`是用户提供的首先搜索的目录。

`%3`是用户提供的要搜索的第二个目录。

从命令行调用以生成报告：

```
FindAll *.dll d:\dir1 d:\dir2 > dll_report.txt 2>&1 
```

该`<nul (set /p)`技巧将在没有新行的情况下将文本输出到控制台（来自该线程的[Pax ：](https://stackoverflow.com/users/14860/pax)[如何为批处理文件中的等待进程编写微调器？](https://stackoverflow.com/questions/368041/how-to-code-a-spinner-for-waiting-processes-in-a-batch-file#371276)）

调用批处理文件时添加的`2>&1`内容需要捕获文件的所有输出（来自该线程的礼貌语：[Windows](https://stackoverflow.com/users/2441/aphoria)[批处理文件的未充分使用的功能](https://stackoverflow.com/questions/245395/underused-features-of-windows-batch-files#246691)）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-01-06T00:38:29.007

我会研究 Robocopy 看看这是否有帮助（/L 标志是一个线索）。

# c# - ASP.NET MVC and JQuery get info to controller

> ID：414726
> 
> 赞同：6
> 
> 时间：2009-01-05T22:27:35.323
> 
> 标签：c#, jquery, ajax, asp.net-mvc

I am totally confused on how to do ajax stuffs with jQuery and it seems the more I try the more confused I get. At this point all I want to do is get data to my controller using jQuery ajax. Some code for my jquery ajax call is.

```
$(function() {
    $('#buttonAddLink').click(function() {
        var AjaxLink = {
            title: $("#linkTitle").val(),
            url: $("#linkUrl").val()
        };

        $.ajax({
            url: '/User/AddLink',
            type: 'POST',
            data: AjaxLink,
            dataType: 'json',
            success: function(result){
                $('.added').html(result.Result).show();
            }
         });         
    });    
}); 
```

Here is my controller and Action I am using. From trying to look at several tutorials it "should" work to the best of my knowledge, but apparently I don't get it like I thought I did.

```
public ActionResult AddLink(string title, string url)
{
    return Json(new { Result = string.Format(title + " " + url)});
} 
```

All I am basically trying to do with that is do the Ajax call and return it to display just to make sure data was sent to the controller.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T23:15:55.443

It has to do with the way you're structuring your request. Your JQuery call is sending the data to the AddLink action on the User controller as POST data, which means in your C# code, you'll access it via the Request.Form object. With what you're trying to do, you'd structure the jQuery URL as

```
/User/AddLink/{Title}/{URL} 
```

This would require you to write a rule in your Global.ASAX file that handled that sort of input. In short, if you just modify your AddLink method as follows:

```
public ActionResult AddLink()
{
    return Json(new { Result = string.Format(Request.Form["title"] + " " + Request.Form["url"])});
} 
```

I believe you'll get the response you're looking for.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-16T14:24:56.937

好的，尝试使用 Ajax 将数据传递给您的操作方法的代码：

```
jQuery.ajax({
            url: '@Url.Action("AddLink", "User")',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ title: title, url: url }),
            success: function (result) { }
        }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T23:22:44.320

Have you tried writing out the full URL? I had a project running on my local IIS that had the same problem. The full url was [http://localhost/myproject/user/addlink](http://localhost/myproject/user/addlink), but using "/user/addlink" in the jQuery ajax call was submitting to [http://localhost/user/addlink](http://localhost/user/addlink) (notice that "myproject" is missing because it's not actually the base url as far as jQuery knows).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T23:54:53.803

使用诸如 firebug 之类的工具来确保正在调用您期望的 url。

调试例程 =>

1.  使用 Firbug 确定正在调用正确的 url 并在 post 中发送正确的数据
2.  在操作中中断调用并确保正确填充参数
3.  再次使用 Firebug 检查响应

如果您更喜欢 IE，也可以使用 IE 开发者工具栏代替 Firebug。如果呼叫 url 和发布数据看起来正确，并且未调用该操作，则应检查您的路由规则。即它是否有任何默认值，在这种情况下，MVC 框架将寻找包含这些默认值的方法签名（您的 url 规则中有 {id} 吗？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-13T15:44:26.830

我还没有花时间测试它，但它看起来应该可以工作，我想我会确保你装饰控制器功能，让它知道它正在寻找如下的帖子：

```
[HttpPost]
public ActionResult AddLink()
{
    return Json(new { Result = string.Format(Request.Form["title"] + " " +     Request.Form["url"])});
} 
```

如果这些解决方案都不适合您，我今天下午应该有时间测试一下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T23:36:23.357

您是否尝试过使用 jQuery.post 方法应该类似于

```
jQuery.post("/User/AddLink",AjaxLink,function(data,textStatus)
{
  if(textStatus=="success")
  {
    //do something with data which is the result from the call}
  }
  else
  {
  //failed somewhere along the line
  }
},"json"); 
```

post 值映射到 MVC 调用中的参数，因此 foxxtrot 的代码应该是不必要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-15T20:36:36.053

所以我花了一点时间试图弄清楚如何从 AJAX 调用中取回数据。我将一个 JSON 对象从视图传递到控制器，然后在完成后返回对象的 ID。

所以，我终于得到了这个工作，这就是我在视图上所做的：

```
var obj = {
   property1 : '',
   property2 : ''
};

$.ajax({
    // Returns the full url
    url: '@Url.Action("Method", "Controller")', 
    // Sends as a json object, I actually have an object that maps to my ViewModel, this is just for explaining
    data: obj, 
    // You are telling that you are receiving a json object
    dataType: 'json', 
    success: function (id) {
       // do code here with id
    }
}) 
```

对于我的控制器，我返回了一个 Json 对象并将 AllowGet 作为 JsonRequestBehavior

```
public ActionResult Method (ViewModel vm)
{
    int id = ... (do something with the vm)
    return Json(id, JsonRequestBehavior.AllowGet);
} 
```

编辑：此外，您似乎将 POST 作为对控制器的请求类型，并且您的控制器方法没有`[HttpPost]`注释。情况也可能如此。

我希望这有帮助！
干杯!

# windows - 如何在 Windows 上使用 Perl 的默认应用程序打开文件？

> ID：414731
> 
> 赞同：2
> 
> 时间：2009-01-05T22:29:16.317
> 
> 标签：windows, perl, system

我有一个文件目录，我想定期扫描并使用它们关联的默认应用程序执行。它们是不可执行的，所以 system("file.torrent"); 不起作用。您如何在 Perl 中使用相关应用程序运行文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T22:47:29.370

标准的 windows 方式是使用[ShellExecute](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)。

在 perl 中，您可以使用 ShellExecute 来完成。它在[Win32::GUI 包](http://perl-win32-gui.sourceforge.net/cgi-bin/docs.cgi?doc=reference-methods)中。

没试过。但它看起来很简单。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T22:31:49.667

开始

您可以手动解析注册表的相关部分，找到相关的应用程序，然后自己启动它：但命令提示符的内置启动命令生活更轻松。

因此，对于您的示例，您只需执行一个 system("cmd /c start file.torrent")

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T22:55:39.557

不是 Perl 特定的，但您始终可以使用“开始”命令。第一个参数将是打开的新命令提示符的标题，第二个参数是要打开的文件。

```
system('start "dummy title" "some file.doc"'); # opens the document in word 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T06:42:20.970

我们使用的另一个选项是

`system("RunDLL32.exe SHELL32.DLL,ShellExec_RunDLL file.torrent")`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T11:24:23.430

永远不要在 Windows 上使用 system() ！蹩脚的坏方法（PAS）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-07T04:09:41.037

只是为了突出上面 BeowulfOF 的评论

```
system( "test.log" ) 
```

将在它的关联应用程序中打开 test.log，就像输入一样

```
test.log 
```

在命令行上

# c# - C#: How would I get the current time into a string?

> ID：414733
> 
> 赞同：57
> 
> 时间：2009-01-05T22:30:00.793
> 
> 标签：c#

How could I get the current h/m/s AM time into a string? And maybe also the date in numeric form (01/02/09) into another one?

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-01-05T23:04:41.847

I'd just like to point out something in these answers. In a date/time format string, '/' will be replaced with *whatever the user's date separator is*, and ':' will be replaced with *whatever the user's time separator is*. That is, if I've defined my date separator to be '.' (in the Regional and Language Options control panel applet, "intl.cpl"), and my time separator to be '?' (just pretend I'm crazy like that), then

```
DateTime.Now.ToString("MM/dd/yyyy h:mm tt") 
```

would return

```
01.05.2009 6?01 PM
```

In most cases, this is what you want, because you want to respect the user's settings. If, however, you **require** the format be something specific (say, if it's going to parsed back out by somebody else down the wire), then you need to escape these special characters:

```
DateTime.Now.ToString("MM\\/dd\\/yyyy h\\:mm tt") 
```

or

```
DateTime.Now.ToString(@"MM\/dd\/yyyy h\:mm tt") 
```

which would now return

```
01/05/2009 6:01 PM
```

* * *

**EDIT**:

Then again, if you ***really*** want to respect the user's settings, you should use one of the standard date/time format strings, so that you respect not only the user's choices of separators, but also the general format of the date and/or time.

```
DateTime.Now.ToShortDateString()
DateTime.Now.ToString("d") 
```

Both would return "1/5/2009" using standard US options, or "05/01/2009" using standard UK options, for instance.

```
DateTime.Now.ToLongDateString()
DateTime.Now.ToString("D") 
```

Both would return "Monday, January 05, 2009" in US locale, or "05 January 2009" in UK.

```
DateTime.Now.ToShortTimeString()
DateTime.Now.ToString("t"); 
```

"6:01 PM" in US, "18:01" in UK.

```
DateTime.Now.ToLongTimeString()
DateTime.Now.ToString("T"); 
```

"6:01:04 PM" in US, "18:01:04" in UK.

```
DateTime.Now.ToString()
DateTime.Now.ToString("G"); 
```

"1/5/2009 6:01:04 PM" in US, "05/01/2009 18:01:04" in UK.

Many other options are available. See docs for [standard date and time format strings](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx) and [custom date and time format strings](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx).

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-05T22:34:07.463

You can use format strings as well.

```
string time = DateTime.Now.ToString("hh:mm:ss"); // includes leading zeros
string date = DateTime.Now.ToString("dd/MM/yy"); // includes leading zeros 
```

or some shortcuts if the format works for you

```
string time = DateTime.Now.ToShortTimeString();
string date = DateTime.Now.ToShortDateString(); 
```

Either should work.

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-03-16T09:59:09.120

在单个字符串中获取系统日期和时间的方法

```
public static string GetTimeDate()
{
    string DateTime = System.DateTime.Now.ToString("dd-MM-yyyy HH:mm:ss");   
    return DateTime;
} 

sample OUTPUT :-16-03-2015 07:45:15 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-05T22:31:49.510

> ```
> DateTime.Now.ToString("h:mm tt")
> DateTime.Now.ToString("MM/dd/yyyy") 
> ```

Here are some [common format strings](http://www.geekzilla.co.uk/View00FF7904-B510-468C-A2C8-F859AA20581F.htm)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-06T00:27:10.387

访问 DateTime.Now 两次时要小心，因为调用可能跨越午夜，并且在极少数情况下您会得到古怪的结果，并且会摸不着头脑。

为了安全起见，如果要多次使用它，则应首先将 DateTime.Now 分配给局部变量：

```
var now = DateTime.Now;
var time = now.ToString("hh:mm:ss tt");
var date = now.ToString("MM/dd/yy"); 
```

请注意，即使在下午，使用小写“hh”也会显示从 00 到 11 的时间，而“tt”则根据问题要求显示 AM/PM。如果您想要 24 小时制 00-23，请使用“HH”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-05T22:33:05.107

```
string t = DateTime.Now.ToString("h/m/s tt");
string t2 = DateTime.Now.ToString("hh:mm:ss tt");
string d = DateTime.Now.ToString("MM/dd/yy"); 
```

[http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

# css - 在 HTML 中使用条件注释

> ID：414738
> 
> 赞同：2
> 
> 时间：2009-01-05T22:31:44.953
> 
> 标签：css, xhtml

我一直对 Web 开发和学习比较陌生。我最近在查看不同网站的源代码时遇到了“条件注释”。我想我现在了解它们的作用，但不确定何时使用它们。

我已经看到它们主要用于在 IE 中实现不同的样式表，并且想知道这是否是好的做法？

在这种情况下，如果答案是“是”。那么在开发网站时，使用两个单独的样式表来修复错误是“常见的地方”吗？例如，为 IE 创建一个样式表，为 Firefox、Opera 等创建一个样式表？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T22:36:00.780

据我所知，条件注释仅受 IE 支持，并且它们在不支持它们的浏览器中优雅地降级（因为它们看起来像普通注释）。普遍的共识是，如果您使用它来对抗另一个非标准浏览器“功能”（即 IE 中对 CSS 的糟糕支持），则可以使用非标准浏览器功能。所以你会发现它是一个非常常见的调整 CSS 的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-05T22:47:19.387

Internet Explorer（[尤其是](http://www.google.com/search?hl=en&pwst=1&sa=X&oi=spell&resnum=0&ct=result&cd=1&q=Internet+Explorer+6+CSS+hack&spell=1)第 6 版）的特性使得一些样式表可以很好地与 IE 配合使用，而另一些则不能。对于那些不这样做的人，您可以使用条件注释来获得仅在 IE 上显示的 CSS 代码。我必须使用它，因为 Internet Explorer (mis) 如何处理 CSS 下拉菜单。

为了使我正在处理的网站正确呈现`hover`下拉菜单的功能，我必须实现 crosshover.htc 文件。这是我必须使用的代码：

```
 <!--[if IE]>
<style type="text/css" media="screen">
#menu ul li {float: left; width: 100%;}
</style>
<![endif]-->
<!--[if lt IE 7]>
<style type="text/css" media="screen">
body {
behavior: url(http://www.stannscatholicschool.com/csshover.htc);
font-size: 100%;
}
#menu ul li {float: left; width: 100%;}
#menu ul li a {height: 1%;}

#menu a, #menu h2 {
font: 100% verdana, tahoma, helvetica, arial, sans-serif;
}

</style>
<![endif]--> 
```

如果我不这样做，下拉菜单会分开，无法在 Internet Explorer 6 中导航。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T22:46:40.400

我使用条件注释来检测我网站的访问者是否使用 IE6 或更低版本。如果是这种情况，我会加载[IE7.js 脚本](http://code.google.com/p/ie7-js/)，它克服了这些旧浏览器中的一些错误。还有一个用于模拟 IE8 支持的脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T22:41:27.027

有些人还使用注释来帮助勾勒页面的某些区域，例如页脚、页眉或主要内容（通常在模板中）。

但是，如果您使用的是 div 和 CSS（听起来像），您应该能够通过 DIV id 和 CSS 样式来判断内容是什么或您所在的 HTML 区域。请记住使用清晰的名称，并尽量不要仅仅为了更容易输入而缩写它们。

如果这对您来说是个问题，那么 Intellisense 是一件很棒的事情，可以帮助我们解决此类问题。如果不是，那么 CTRL+C 和 CTRL+V 可能是下一个最好的选择 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T21:35:17.167

这是一个很好的练习！条件注释的[官方文档页面](http://msdn.microsoft.com/en-us/library/ms537512.aspx)，有很多条件注释的例子和组合，值得一读。该页面还指出：

> 条件注释使开发人员可以轻松利用 Microsoft Internet Explorer 5 和更高版本提供的增强功能，同时编写在功能较弱的浏览器中正常降级或在 Windows Internet Explorer 以外的浏览器中正确显示的页面。条件注释是区分用于特定 Internet Explorer 版本的级联样式表 (CSS) 规则的首选方法。

**现在 Internet Explorer 是功能最差的浏览器**，因此您很可能会使用条件注释来做完全相反的事情，即利用所有其他浏览器提供的增强功能，同时编写在 Microsoft 中优雅降级的页面IE浏览器。

您可以使用条件注释来修复不受支持的 CSS 样式，或隐藏 Internet Explorer 中的代码，如下所示：

```
<!--[if !IE]>-->
<script src="IE_will_never_see_this.js" type="text/javascript" charset="utf-8" ></script>
<!--<![endif]--> 
```

# c# - 如何在 C# 中将方法引用传递给不同的方法

> ID：414741
> 
> 赞同：0
> 
> 时间：2009-01-05T22:31:57.823
> 
> 标签：c#, wpf, events, reference, methods

我想将一个方法的引用传递给另一个方法并将其存储为变量。后来，我想用这个引用来定义一个事件处理程序。

制作事件处理程序时，方法引用的传递如下：

```
myButton.Click += new RoutedEventHandler(myButton_Click); 
```

如果您从 intelliSense 查看“RoutedEventHandler”的构造函数，它看起来像：

```
RoutedEventHandler(void(object, RoutedEventArgs)) 
```

我想做的是将方法“myButton_Click”传递给不同的静态方法，然后在那里创建一个事件处理程序。如何将引用传递给静态方法？我尝试了以下但它没有编译：

```
public class EventBuilder
{
    private static void(object, RoutedEventArgs) _buttonClickHandler;

    public static void EventBuilder(void(object, RoutedEventArgs) buttonClickHandler)
    {
        _buttonClickHandler = buttonClickHandler;
    }

    public static void EnableClickEvent()
    {
        myButton.Click += new RoutedEventHandler(_buttonClickHandler);
    }
} 
```

谢谢，本

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T22:35:38.893

要引用方法引用（在 .NET 中称为[委托](http://msdn.microsoft.com/en-us/library/ms173171.aspx)），请使用处理程序名称，而不是签名。

```
public class EventBuilder
{
    private static RoutedEventHandler _buttonClickHandler;

    public EventBuilder(RoutedEventHandler buttonClickHandler)
    {
        _buttonClickHandler = buttonClickHandler;
    }

    public static void EnableClickEvent()
    {
        myButton.Click += new RoutedEventHandler(_buttonClickHandler);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T22:35:32.873

尝试

```
private static delegate void(object sender, RoutedEventArgs e) _buttonClickHandler; 
```

# inversion-of-control - 如何获得温莎城堡的自动注册

> ID：414745
> 
> 赞同：3
> 
> 时间：2009-01-05T22:33:17.150
> 
> 标签：inversion-of-control, castle-windsor, auto-registration

我最近阅读了[Ayende 关于使用 XML 配置进行自动注册的博客文章](http://ayende.com/Blog/archive/2008/12/31/didja-know-merging-windsor-configuration-with-automatic-registration.aspx)。我想做他所做的，但他的代码片段对我不起作用。我的容器对象上不存在 Register 方法。

这是他的代码：

```
var container = new WindsorContainer(new XmlInterpreter());
container.Register(
    AllTypes.Of(typeof (ConsumerOf<>))
        .FromAssembly(typeof(Program).Assembly)
    ); 
```

是否有我缺少的 DLL 参考？Register() 是扩展方法并且我没有引用正确的命名空间吗？我查看了 Castle Docs，但似乎找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T00:14:02.207

呸! 没关系。我使用的是 RC-3，Register() 方法只在主干中。

# c# - 覆盖但不调用

> ID：414746
> 
> 赞同：4
> 
> 时间：2009-01-05T22:33:31.113
> 
> 标签：c#, inheritance, virtual, access-modifiers

如何在 C# 中声明一个应该被派生类覆盖（或可覆盖）的方法——甚至可能在你的程序集之外——但它应该只能从实际类中调用？

（即像 C++ 中的私有虚函数）

**[编辑]**正是我想要的：“这是一种修改我的行为的方法，但仍然不允许您直接调用此函数（因为调用它需要只有我的基类才能执行的神秘调用）”
*`private`* `virtual`

所以澄清一下：在 C# 中最好的表达是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T22:44:46.800

当您说它应该只能在“实际类中”调用时，您是指基类还是派生类？这些都不是单独可行的。最接近的是使用受保护的方法，这意味着它可以从声明类、派生类和任何进一步派生的类中调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T22:41:39.443

私有成员对子类不可见。我认为受保护的虚拟会按照您想要的方式执行？

**更新：**

这里更详细地解释了您可以在 C# 中使用继承和覆盖函数执行哪些操作。我尝试使用一个有意义的示例，但认为它理解它的类设计很差，我永远不会推荐以这种方式实现描述的类。但是，我希望这可能会为您提供一种途径，以一种可以接受的方式解决您的原始问题。没有办法阻止一个具体的类调用它的任何成员，但是如果你的结构无论如何都是这样的，也许它不是问题。

```
public abstract class Animal
{
    public void DisplayAttributes()
    {
        Console.WriteLine(Header());
        Console.WriteLine("Name: " + Name());
        Console.WriteLine("Legs: " + Legs());
        Console.WriteLine();
    }

    protected virtual int Legs()
    {
        return 4;
    }

    private string Header()
    {
        return "Displaying Animal Attributes";
    }

    protected abstract string Name();
}

public class Bird : Animal
{
    protected override string Name()
    {
        return "Bird";
    }

    protected override int Legs()
    {
        return 2;
    }
}

public class Zebra : Animal
{
    protected override string Name()
    {
        return "Zebra";
    }
}

public class Fish : Animal
{
    protected override string Name()
    {
        return "Fish";
    }

    protected override int Legs()
    {
        return 0;
    }

    private string Header()
    {
        return "Displaying Fish Attributes";
    }

    protected virtual int Gils()
    {
        return 2;
    }

    public new void DisplayAttributes()
    {
        Console.WriteLine(Header());
        Console.WriteLine("Name: " + Name());
        Console.WriteLine("Gils: " + Gils());
        Console.WriteLine();
    }
}

class Program
{
    static void Main(string[] args)
    {
        Bird bird = new Bird();
        bird.DisplayAttributes();
        //Displaying Animal Attributes
        //Name: Bird
        //Legs: 2

        Zebra zebra = new Zebra();
        zebra.DisplayAttributes();
        //Displaying Animal Attributes
        //Name: Zebra
        //Legs: 4

        Fish fish = new Fish();
        fish.DisplayAttributes();
        //Displaying Fish Attributes
        //Name: Fish
        //Gils: 2

        List<Animal> animalCollection = new List<Animal>();
        animalCollection.Add(bird);
        animalCollection.Add(zebra);
        animalCollection.Add(fish);

        foreach (Animal animal in animalCollection)
        {
            animal.DisplayAttributes();
            //Displaying Animal Attributes
            //Name: Bird
            //Legs: 2

            //Displaying Animal Attributes
            //Name: Zebra
            //Legs: 4

            //Displaying Animal Attributes
            //Name: Fish
            //Legs: 0
            //*Note the difference here
            //Inheritted member cannot override the
            //base class functionality of a non-virtual member
        }
    }
} 
```

在这个例子中，Bird、Zebra 和 Fish 都可以调用它们的 Name 和 Legs 方法，但是在这个例子的上下文中，这样做不一定有用。此外，如 Fish 所示，DisplayAttributes() 可以针对具体派生类的实例进行修改；但是当您查看动物时，就像在 foreach 循环中一样，您将获得基类 DisplayAttributes 行为，而不管动物的实际类型如何。我希望这可能有助于提供您想要复制的功能类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T23:13:27.710

C# 比 C++ 为“私有”提供了更强的保证。在 C++ 中，您确实可以覆盖私有虚拟方法。但这意味着基类中的代码可以执行派生类中的代码。打破了私有方法是真正私有的并且只能由同一类中的方法调用的承诺。

在这里没有帮助的是 C++ 不需要重复 virtual 关键字。导致像这样一个难以逆向工程的谜团：

```
#include "stdafx.h"
#include <iostream>

class Base {
private:
    virtual void Method() = 0;
public:
    void Test() {
        Method();
    }
};
class Derived : public Base {
private:
    void Method() { std::cout << "Who the heck called me?"; }
};

int _tmain(int argc, _TCHAR* argv[])
{
    Base* p = new Derived;
    p->Test();
} 
```

我同意私有继承可能发挥作用。C# 语言设计者说不！尽管。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T01:06:06.750

这是 vboctor 已经提到的示例：

```
public class Base
{
    private Func<Base, int> func;
    protected void SetFunc(Func<Base, int> func)
    {
        this.func = func;
    }

    private void CallFunc()
    {
        if (func != null)
        {
            var i = func(this);
        }
    }
}

public class Sub : Base
{
    private void DoFuncyStuff()
    {
         this.SetFunc(b => 42);
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T00:57:48.700

您是否考虑过使用委托来执行此操作？您可以允许派生类通过某些受保护的属性设置委托或将其传递给您的构造函数。您还可以将委托默认为您的内部实现，这是您的基类上的私有方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T22:42:13.250

为什么你需要它是私有的？保护应该足够了，在这里。您要求子类作者编写他们无法调用的代码。这有什么作用？无论如何，他们都可以使用该代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T22:54:24.940

当我阅读您的问题时，您可能意味着两件事。

首先，如果您想要 A 类中的一个函数，该函数可以在子类 B 中被覆盖但对任何外部类都不可见：

```
public class ClassA
{
  protected virtual ReturnType FunctionName(...) { ... }
}

public class ClassB
{
  protected override ReturnType FunctionName(...) { ... }
} 
```

其次，如果要强制实现类定义函数：

```
public abstract class ClassA
{
  protected abstract ReturnType FunctionName(...);
}

public class ClassB
{
  protected override ReturnType FunctionName(...) { ... }
} 
```

如果您只是深入研究与 C# 相关的另一个概念，您可能会看到部分类。这是在编译时组合两个源文件以创建一个类的想法，两者都来自同一个程序集：

文件 1：

```
public partial class ClassA
{
    private ReturnType FunctionName(...);
} 
```

文件 2：

```
public partial class ClassA
{
  //actual implimentation
  private ReturnType FunctionName(...){ ... }; 
} 
```

除了处理设计生成的文件（如 Linq2Sql 文件、EDM 或 WinForms 等）外，分部并未广泛使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T23:07:30.157

猜猜这不会像你想要的那样工作，但让我为你画一些伪代码：

```
public interface BaseClassFunction {
    void PleaseCallMe();
}

public class BaseClass {
    private BaseClassFunction fn;
    public BaseClass(BaseClassFunction fn) {
        this.fn = fn;
    }
    private CallMe() {
        fn.PleaseCallMe();
    }
    public PublicCallMe() {
        CallMe();
    }
}

private class DerivedClassFunction : BaseClassFunction {
    void PleaseCallMe() { ... do something important ... }
}

public class DerivedClassFunction {
    public DerivedClassFunction() : BaseClass(new DerivedClassFunction()) {
    }
} 
```

# .net - 为什么减号比mod慢？

> ID：414749
> 
> 赞同：3
> 
> 时间：2009-01-05T22:35:07.413
> 
> 标签：.net

在那种特定情况下

```
 Const debugTime As String = "hh:mm:ss.fffffff"
    Dim i As Integer

    Debug.Print("Start " & Now.ToString(debugTime))
    For i = 0 To 4000000
        j = 5 - 4
    Next
    Debug.Print("End " & Now.ToString(debugTime))

    Debug.Print("Start " & Now.ToString(debugTime))
    For i = 0 To 4000000
        j = 5 Mod 4
    Next
    Debug.Print("End " & Now.ToString(debugTime)) 
```

结果

开始时间 05:33:39.8281250

结束 05:33:39.8437500

开始时间 05:33:39.8437500

结束 05:33:39.8437500

*** 编辑 ***

修改代码使其看起来像这样

```
 Const debugTime As String = "hh:mm:ss.fffffff"
    Dim i As Long, j As Integer
    Dim r As Random

    r = New Random(1)
    Debug.Print("Start " & Now.ToString(debugTime))
    For i = 0 To 400000000
        j = 5 - r.Next(1, 5)
    Next
    Debug.Print("End " & Now.ToString(debugTime))

    r = New Random(1)
    Debug.Print("Start " & Now.ToString(debugTime))
    For i = 0 To 400000000
        j = 5 Mod r.Next(1, 5)
    Next
    Debug.Print("End " & Now.ToString(debugTime)) 
```

现在减号更快...

开始时间 05:49:25.0156250

结束 05:49:35.7031250

开始时间 05:49:35.7031250

结束 05:49:48.2187500

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T22:39:29.527

*   以如此小的时间间隔进行基准测试会让您对计时器粒度问题敞开心扉，这就是您在此处看到的。
*   您的代码实际上并没有计算任何东西，因为您两次都有一个常数。

事实上，这么小的基准测试操作非常棘手——要确保编译器和 JIT 编译器都不会优化东西，你真的想让它以某种方式使用结果，但这会显着影响结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T22:38:45.830

编译器会将它们都优化为一个赋值。非常小的差异可能是另一个因素的结果。

**更新：** 我在 Mac OS X、Intel 64 架构上编写了一个基准测试。巨大的差异：

`a.asm`: 组装`yasm -f macho64 a.asm`

```
SECTION .text
global _bmod, _bmin
_bmod:  push rdx
    push rbx
    mov rcx, 1000000000
    mov rdi, 5
    mov rsi, 4
.bmod:  mov rax, rdi
    mov rbx, rsi
    xor rdx, rdx
    div rbx             ; div instruction stores the mod in rdx.
    dec rcx
    jnz .bmod
    pop rbx
    pop rdx
    ret

_bmin:  push rdx
    push rbx
    mov rcx, 1000000000
    mov rdi, 5
    mov rsi, 4
.bmin:  mov rax, rdi
    mov rbx, rsi
    sub rax, rbx
    dec rcx
    jnz .bmin
    pop rbx
    pop rdx
    ret 
```

`a.c`: 编译`gcc -m64 a.c a.o`

```
#include <time.h>
#include <stdio.h>

void bmod();
void bmin();

main() {
    time_t timex,timex2;
    time(&timex);
    bmod();
    time(&timex2);
    printf("Mod: %d\n", timex2 - timex);
    time(&timex);
    bmin();
    time(&timex2);
    printf("Min: %d\n", timex2 - timex);
} 
```

我在 MacBook Air 上运行它时的结果：

```
Mehrdad-Air:~ Mehrdad$ yasm -f macho64 a.asm 
Mehrdad-Air:~ Mehrdad$ gcc -m64 -O0 a.c a.o
Mehrdad-Air:~ Mehrdad$ ./a.out 
Mod: 14
Min: 2 
```

如您所见，模数比减法慢一个数量级。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T22:44:57.410

除了 Jon Skeet 所说的，我通常使用 System.Diagnostics.Stopwatch() 进行基准测试，因为我发现高速计数器往往比仅引用 DateTime.Now 更可靠

```
 Dim t = new System.Diagnostics.Stopwatch()
  t.Start

  ''Do Stuff...

  Debug.Print(t.Elapsed)
  t.Stop 
```

编辑：（或根据 Jon 在评论中的建议：

```
 Dim t = System.Diagnostics.Stopwatch.StartNew

  ''Do Stuff...

  Debug.Print(t.Elapsed)
  t.Stop 
```

)

# c# - SharpZipLib 提取的文件大小

> ID：414753
> 
> 赞同：2
> 
> 时间：2009-01-05T22:35:31.360
> 
> 标签：c#, sharpziplib

有没有办法找出提取时未提取档案的总大小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T22:49:39.163

试试这个：

```
ZipFile zFile = new ZipFile(myZipFileName);
long uSize = 0;
foreach (ZipEntry e in zFile) {
    if ( e.IsFile ) {
        uSize += e.Size;
    }
} 
```

# visual-c++ - 如何在 VC++ 项目中引用 DLL

> ID：414761
> 
> 赞同：8
> 
> 时间：2009-01-05T22:37:54.163
> 
> 标签：visual-c++

我有一个我正在尝试编译的 C++ 驱动程序，它在代码中有这一行：

```
#import "msado15.dll" no_namespace rename("EOF", "EndOfFile") 
```

但是当我编译项目时，我得到了错误：

错误 1 ​​致命错误 C1083：无法打开类型库文件：'msado15.dll'：没有这样的文件或目录

我有 DLL，但我应该把它放在哪里以便编译器可以看到它？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-05T22:57:28.490

您可以将 DLL 放置在与引用文件 (.h) 相同的路径中，或者您可以修改项目的 LIB 部分的其他包含路径。在 VC++ 中，这将是：

项目 | 属性 | 配置属性 | 链接器 | 一般 | 其他图书馆目录

如果您正在集中第三方依赖项并且您不希望被迫通过同一路径保持引用文件 (.h) 和 DLL 同步，则此方法可能很有用。

有关详细信息，请参阅此[MSDN](http://msdn.microsoft.com/en-us/library/8etzzkb6(VS.80).aspx)链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-21T13:32:30.017

对于 VC++2010(VS2010)：编译器无法看到
位于 C:\Program Files\Common Files\System\ado的 msado15.dll

前往项目 | 属性 | 配置属性 | VC++ 目录并在可执行目录中添加以下内容

$(CommonProgramFiles)\系统\ado；

你应该没事

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-18T13:27:17.550

但是，对于大多数人来说，这可能有点过时了 - 对于 Visual Studio 2008，对于特定的

项目 |
配置属性 |
C/C++ |
附加包含目录 |

选择并单击省略号 (...)。

添加目录

```
C:\Program Files\Common Files\System\ado 
```

并使用箭头将其移至列表底部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T22:46:54.143

好的，通过阅读文档找到它。我只需要将它放在与引用文件相同的文件夹中（与项目源代码位于不同的位置）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T23:03:22.880

您需要有库文件和函数定义标头才能执行此操作。如果您碰巧没有它们，您可以尝试使用 LoadLibrary 和 GetProcAddress 动态加载 DLL，它们是链接函数的指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-30T11:05:58.010

尝试在 VC++ 项目的“项目属性”->“链接器”->“输入”部分设置“延迟 DLL 加载”（或类似选项）。

# c# - 如何在 Visual Studio 2008 中创建已编译的用户文件？

> ID：414788
> 
> 赞同：1
> 
> 时间：2009-01-05T22:48:36.357
> 
> 标签：c#, .net, vb.net, visual-studio-2008

在 C++ 中，您可以编译未包含在解决方案中的文件，而在 c# 中，情况并非如此。

有没有办法将文件保留在项目中，但没有标准的 SCCI 提供程序尝试继续签入文件？

本质上，我们想要做的是创建类似于我们在 c++ 中编码的“开发人员”代码能力，这允许我们让我们的开发人员使用伪代码和开发人员实用程序进行夜间签入。

```
#ifdef (TOM)
#include "Tom.h";
#endif 
```

* * *

**编辑**我也不想在解决方案文件中创建新配置，我希望这些配置尽可能特定于机器，而不需要在文件/设置上与用户进行源代码控制绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T22:55:09.917

MSBuild[有条件构造](http://msdn.microsoft.com/en-us/library/ms164307.aspx)。您所要做的就是修改解决方案文件以包含您想要的内容。最终结果看起来与您的示例代码非常相似。

```
<When Condition=" '$(Configuration)'=='TOM' ">
  <ItemGroup>
     <Compile Include="tomCode\*.cs" />     
   </ItemGroup>
</When> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T23:28:24.933

好吧，似乎在完成了这里的帖子并尝试了“奇怪”的事情之后，我有了一个想法。

本质上，我使用了 *.csproj.user 文件，声明了一个 UserConfig 属性，添加了一个新的常量（用于代码检查），并在 UserConfig 的条件下做了一个 ItemGroup。所有这些都属于 DEBUG 标志。

唯一的问题是该文件没有显示在解决方案资源管理器中，但在 c++ 中它们也没有。

**我的 *.csproj.user 文件**

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <UserConfig>Tom</UserConfig>
    <DefineConstants>DEBUG;TRACE;TOM</DefineConstants>
  </PropertyGroup>
  <ItemGroup Condition=" '$(UserConfig)' == 'Tom'">
    <Compile Include="Tom.cs" />
  </ItemGroup>
</Project> 
```

**结果代码**

```
#if (TOM)
            Tom t = new Tom();
#endif 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T23:03:34.640

我目前正在尝试这个。

```
 <ItemGroup Condition=" '$(Configuration)' == 'Tom'">
    <Compile Include="Tom.cs" />
  </ItemGroup> 
```

# ruby-on-rails - Rails：对于每个给出错误的数组？

> ID：414789
> 
> 赞同：1
> 
> 时间：2009-01-05T22:49:25.870
> 
> 标签：ruby-on-rails, ruby

在一种形式中，我正在创建一个区域并编辑多个用户。下面的“user_attributes”用于用户，“name”用于地区。所以对于每个 user_attribute 我想更新用户模型。

# 参数

```
{ "territory"=>{"name"=>"Central Canada",
  "user_attributes"=>[{"user_id"=>"30"},{"user_id"=>"30"}]}
} 
```

# 创建动作

```
@territory = @current_account.territories.new[:territory]
params[:user_attributes].each do |item|
  @user = User.find(item[:user_id])
  @user.update_attribute(:territory_id, @territory.id)
end 
```

但是 rails 正在反击 params[:user_attributes] 为 nil。但是你可以从参数中看到它不是。我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-05T23:15:46.613

根据您发布的内容，您的`user_attributes`哈希值在您的`territory`哈希值内。那应该是你的问题——要么把它移到外面，要么做`params[:territory][:user_attributes]`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-05T22:51:58.970

试试 params["user_attributes"]。

# c# - 算法：两个正则表达式的交集

> ID：414794
> 
> 赞同：3
> 
> 时间：2009-01-05T22:51:49.377
> 
> 标签：c#, algorithm

我想弄清楚（在运行时）两个正则表达式是否相交（即，如果它们确实存在一个或多个字符串，则匹配两个正则表达式）。

算法需要非常快，因为我需要遍历数据库并检查现有值。

找到了一些关于此的理论但没有实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T23:08:49.700

显而易见的解决方案是将正则表达式转换为 DFA，计算 DFA 的交集（微不足道）并查看生成的 DFA 是否可以接受（也微不足道）。唯一困难的部分是将正则表达式转换为 DFA，这需要一些工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T23:28:00.787

这是使用正则表达式的偏导数的[Haskell 实现。](http://sulzmann.blogspot.com/2008/11/playing-with-regular-expressions.html)对该帖子的评论指出了克里斯多德回答中的方法存在问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T16:40:10.130

用通过第一个的输入检查第一个然后另一个呢？

# java - 有什么方法可以进一步优化 Java 反射方法调用？

> ID：414801
> 
> 赞同：25
> 
> 时间：2009-01-05T22:54:16.330
> 
> 标签：java, performance, reflection

我想知道是否可以实施任何其他优化来提高 Java 中反射调用的速度。并不是说性能令人望而却步，但是当我想到我正在编写的库中的某些代码在某处的紧密循环中实现时，我感到很沮丧。

考虑一个反射调用的实用方法：

```
public static Object invoke(Object targetObject, String methodName, Object[] arguments, Class<?>[] signature) 
```

基本操作是

```
return method.invoke(targetObject, arguments); 
```

作为性能优化，我使用目标对象的类、方法名称和签名（其代码可能需要一些改进）的哈希来缓存方法，但除此之外，我还能做些什么吗？我听说过一些对**InvokeDynamic**早期实现的引用，听起来很有希望，但我只是假设它们可能还不适用，并且我不考虑我自己的字节码操作，因为我想保持实用程序简单（但快速）。

干杯。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-05T22:59:47.597

下面的评论与 Sun 的实现有关，尤其是 OpenJDK 6。您的经验可能会因其他 Java 平台实现而异。

`java.lang.Class`自己做一些缓存，所以实现你自己的缓存可能不会改善很多。在有和没有手动缓存的情况下进行计时测试。

实际调用机制也进行了优化。反射方法的前 15 次运行（默认情况下）是使用 JNI 调用的；之后，生成字节码，调用该反射方法的执行与直接在 Java 代码中调用该方法相同。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-09T14:47:43.383

我围绕 Chris Jester-Young 的回答进行了一些测试，并使用**详细**选项，我肯定观察到编译器在第 15 次调用前后采取了一些行动。如果没有更复杂的测试，很难说是否存在很大的性能差异，但它是有说服力的。这是输出：

```
Test# 0
Test# 1
Test# 2
Test# 3
Test# 4
Test# 5
Test# 6
Test# 7
Test# 8
Test# 9
Test# 10
Test# 11
Test# 12
Test# 13
Test# 14
[Loaded sun.reflect.ClassFileConstants from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.AccessorGenerator from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.MethodAccessorGenerator from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.ByteVectorFactory from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.ByteVector from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.ByteVectorImpl from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.ClassFileAssembler from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.UTF8 from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded java.lang.Void from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.Label from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.Label$PatchInfo from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded java.util.AbstractList$Itr from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.MethodAccessorGenerator$1 from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.ClassDefiner from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.ClassDefiner$1 from C:\jdk1.5.0_06\jre\lib\rt.jar]
[Loaded sun.reflect.GeneratedMethodAccessor1 from __JVM_DefineClass__]
Test# 15
Test# 16
Test# 17 
```

我猜**InvokeDynamic**业务在反射加速/消除的基础上并没有吸引太多的开发人员。

谢谢克里斯。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T05:53:27.340

您肯定希望只反映一次方法对象（可能作为私有静态），并将其用于调用而不是每次都反映它。除非您在编译时不知道名称，否则不要打扰缓存映射。

如果在您的上下文中是明智的，您*可能*希望保留并重用参数数组对象（不要忘记在方法退出时将数组元素清空以防止临时 GC 抑制）。

如果总是使用相同的参数调用（极不可能），您可以挂在参数上并（带有它的值的参数数组）重用它们。

由于其他答案已经给出的原因，我不会尝试任何其他事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T23:02:16.283

过早的优化通常是不好的。无论如何，您的性能仍然是动态语言的许多倍，所以除了记录它使用反射因此可能不是最佳的事实之外，我真的不会担心它。

此外，现在或将来，Java 很有可能会优化字节码，以便在循环中使用时，调用的成本不会超过方法调用。您的“优化”实际上可能会阻碍编译器执行此类操作的能力。（我知道我含糊其辞，但这已经发生了——很多）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-09T14:59:29.070

如果调用的成本低于方法中发生的成本的 10%，则几乎不值得担心。

您可以通过在循环中运行 10^6 次来确定这一点，有无例程的胆量。用秒表计时，所以秒转换为微秒。

# javascript - 如何通过 JavaScript 确定页面是否安全？

> ID：414809
> 
> 赞同：58
> 
> 时间：2009-01-05T22:55:31.413
> 
> 标签：javascript, https

我想知道该页面是通过 http 还是 https 使用 JavaScript 访问的。是否有某种 isSecure() 方法，或者我应该以某种方式将其从 URL 中解析出来？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-01-05T23:00:33.413

`location.protocol`应该为你做。

（如：

```
if (location.protocol === 'https:') {
    // page is secure
} 
```

)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-05T23:00:47.253

您应该能够检查`document.location.protocol`它是“http：”还是“https：”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T23:03:26.903

虽然 location.protocol 应该像 Peter Stone 提到的那样为你做这件事，但你不应该依赖 Javascript 来获得任何真正的安全性等。

如果您使用 SSL，我认为 location.protocol 的值为“https：”。

# java - 如何为 StringTemplate 构建自己的词法分析器？

> ID：414811
> 
> 赞同：1
> 
> 时间：2009-01-05T22:55:48.977
> 
> 标签：java, stringtemplate

嗯，听起来很简单，但是在查看了 StringTemplate 附带的那些之后，对于普通开发人员来说，这绝非易事。

从哪里开始？

从做一些更多的挖掘似乎要完成这个还必须学习 ANTLR 工具来创建语言文件？那是对的吗？或者我可以只复制 StringTemplate 附带的一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-03T20:17:17.190

StringTemplate 是由编写 ANTLR 的人构建的，因此两者的关系非常密切。事实上，StringTemplate 是作为 ANTLR 的代码生成库而构建的，因此几乎可以肯定它是正确的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-17T11:36:23.760

[从http://www.geocities.com/russlnk/mysoftware.html](http://www.geocities.com/russlank/mysoftware.html)尝试 UCDT

你可能会找到你正在寻找的东西。

鲁斯兰，

# sql - Oracle 中 varchar(max) 的等价物是什么？

> ID：414817
> 
> 赞同：45
> 
> 时间：2009-01-05T22:58:11.593
> 
> 标签：sql, sql-server, oracle

Oracle 中 varchar(max) 的等价物是什么？

克洛布？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-05T22:59:56.707

在 Oracle 中，Varchars 限制为 4000 个字符。除此之外，您必须使用 LONG 或 CLOB。首选 CLOB。LONG 是较旧的等价物。

从[这个 Oracle 文档](http://www.cs.umbc.edu/help/oracle8/server.815/a68022/lob.htm)：

> **LOB 与 LONG 和 LONG RAW**
> 
> LOB 在许多方面与旧的 LONG 和 LONG RAW 数据类型不同。
> 
> *   LOB 的最大大小为 4 GB，而 LONG 和 LONG RAW 为 2 GB。
> *   您可以在 LOB 上使用随机和顺序访问方法；您只能在 LONG 和 LONG RAW 上使用顺序访问方法。
> *   LOB（NCLOB 除外）可以是您定义的对象类型的属性。
> *   表可以有多个 LOB 列，但只能有一个 LONG 或 LONG RAW 列。
> 
> Oracle 建议将现有的 LONG 和 LONG Raw 属性迁移到 LOB。Oracle 计划在未来版本中终止对 LONG 和 LONG RAW 的支持。有关迁移的更多信息，请参阅 Oracle8 迁移。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-07T14:46:11.633

据我了解，VARCHAR(MAX) 数据类型是 SQL Server 2005 特定的指定文本字段的方式，该字段可以小（SQL Server 中最多 8000 个字符）***或***大（SQL Server 中最多 2GB）。随着内容从小范围增长到大范围，数据库在*后台处理存储的变化。*

Oracle 中没有等价物。

You either have a smallish bit of text in a VARCHAR2 - which is up to 32767 bytes in pl/sql and up to 4000 bytes in SQL (i.e. in a table definition) - or you have a potentially very big bit of text in a CLOB (which is a specialised BLOB).

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-05T23:45:10.500

在 PL/SQL 中，VARCHAR2 最多可以是 32767 字节。对于 SQL，限制为 4000 个字节（如果您使用多字节字符集，则可能少于 4000 个字符）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T21:51:41.663

AFAIK, there is no equivalent. The closest you get in ORACLE is the CLOB, which has the same limitations that TEXT had in SQL Server back in the 'bad old days'.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-17T18:42:26.123

An approach I have used in the past (MS SQL, prior to Varchar(max)):

Put two columns in the table, one smallish Varchar (255, for example), and another Text. Then build your application so that it will use the Varchar column for small data, leaving the Text null. If the data is larger than the Varchar, leave that null and store it in the Text. This way, small data doesn't take up its own page on the server. The tradeoff here is that all applications using the data have to agree to this scheme, and have logic to account for it. But it works well.

I presume the same is true in Oracle, just substiture Varchar2 for Varchar, and CLOB for Text. I don't pretend to know what the right size for the varchar should be - that's data dependent, and also depends on the rest of the columns in the table.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-14T11:33:47.577

There is **no** equivalent in Oracle up to 11g-r2. If you need it, migrate to another DMMS which supports it.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-07T15:28:11.430

The Oracle 11g Gateway translates a Varchar(Max) to LONG Not very handy and causing major problems for our loading of SQL Server data into Oracle.

See following url for more details:- [http://docs.oracle.com/cd/B28359_01/gateways.111/b31049/apa.htm](http://docs.oracle.com/cd/B28359_01/gateways.111/b31049/apa.htm)

# social-networking - Download and install Ning on other servers

> ID：414825
> 
> 赞同：1
> 
> 时间：2009-01-05T22:59:59.937
> 
> 标签：social-networking

Is it possible to download and install Ning on one's own server? Also does anyone ning's license.

My sense is that you cannot install Ning locally or on a test server. If that is the case does anyone know a good open source social networking platform?

Thanks,

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T23:34:21.397

Ning 是一个托管应用程序，您不能下载它。我会尝试[Elgg](http://www.elgg.org)：www.elgg.org - 它是开源的并且在这一点上非常成熟。

还有各种 CMS（Drupal、Plone、Joomla、WordPress 等）的各种模块/插件，您可以使用这些模块/插件将 socnet 功能添加到站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T00:04:20.613

如果您喜欢 ASP.NET 编程，Telerik 的 Sitefinity 有一个社交网络入门包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-06T20:16:22.530

这并不难。如果您支付月费以摆脱他们的谷歌广告，您可以将您的 ning 地址重定向到您希望的任何 URL（尽管它仍将托管在他们的服务器上）

# mysql - 用另一个表中的数据更新 mysql 表

> ID：414828
> 
> 赞同：40
> 
> 时间：2009-01-05T23:00:36.910
> 
> 标签：mysql, sql-update

是否可以使用子选择在 mysql 5.0 上运行 UPDATE 命令。

我想运行的命令是这样的：

```
UPDATE book_details
SET live = 1 
WHERE ISBN13 = '(SELECT ISBN13 FROM book_details_old WHERE live = 1)'; 
```

ISBN13 当前存储为字符串。

这应该更新 10k+ 行。

谢谢，

威廉

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-03-09T14:50:22.360

```
UPDATE table1 t1, table2 t2
SET t1.field_to_change = t2.field_with_data
WHERE t1.field1 = t2.field2; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-05T23:04:10.630

```
UPDATE book_details AS bd, book_details_old AS old
SET bd.live=1  
WHERE bd.isbn13=old.isbn13  
AND old.live=1; 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-05T23:11:44.500

只需稍作改动，您就明白了：

```
UPDATE book_details
SET live = 1 
WHERE ISBN13 in (SELECT ISBN13 FROM book_details_old WHERE live = 1); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-11T01:51:43.843

从其他表中的数据更新表

`UPDATE table1, table2 SET table1.field1 = table2.field1 where table1.id = table2.id`

前任。`UPDATE transaction, member SET transaction.Memberid = member.memberId WHERE transaction.CardId = member.CardId;`

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-10-03T06:44:09.743

从其他表更新数据

```
UPDATE  tab t1, tab t2
SET     t1.company_name = t2.company_name
WHERE   t1.id = t2.id 
```

# php - 在提交时避免 PHP 中的竞争条件：请不要多次单击提交！

> ID：414835
> 
> 赞同：5
> 
> 时间：2009-01-05T23:02:47.233
> 
> 标签：php

前段时间，在线应用程序曾经说过，“不要多次点击提交”。现在已经没有了，对吧？在 PHP 中，您如何防范这种情况？

我正在使用的一种解决方案涉及在会话中放置一个变量，因此您不能每 10 秒多次提交到一个页面。这样，数据库工作将完成，因此可以进行正常检查。显然，这感觉像是一种黑客行为，而且很可能是。

**编辑：**感谢大家的 Javascript 解决方案。这很好，但它有点工作。1）这是一个输入类型=图像和 2）提交必须继续触发，直到[Spry 的东西](http://labs.adobe.com/technologies/spry/)说没关系。基本上，这个编辑只是我在抱怨，因为我想在看了 Spry 的东西之后我就能弄明白。

**编辑：**并不是说任何人都会与 Spry 的东西集成，但这是我使用 Prototype 用于 document.getElementByid 的最终代码。欢迎评论！

```
function onSubmitClick() {
    var allValid = true;
    var queue = Spry.Widget.Form.onSubmitWidgetQueue; 
    for (var i=0;i<queue.length; i++) {
        if (!queue[i].validate()) {
            allValid = false;
            break;
        }
    }

    if (allValid) {
        $("theSubmitButton").disabled = true;
        $("form").submit();
    }
} 
```

出于某种原因，第二个表单提交是必要的......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-28T12:57:38.483

您应该同时进行客户端和服务器端保护。

**客户端**- 禁用按钮，例如通过 cletus 描述的 jquery。

**服务器端**- 在表单中放置一个令牌。如果有两个提交具有相同的令牌，则忽略后者。使用这种方法，您可以免受[CSRF](http://en.wikipedia.org/wiki/CSRF)的侵害。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-05T23:07:41.403

这是 jQuery 有用的一个很好的例子（你可以用任何 Javascript 来做）。添加此代码：

```
$("form").submit(function() {
  $(":submit",this).attr("disabled", "disabled");
}); 
```

一旦点击一次，它就会禁用提交按钮。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T23:17:42.723

正如其他人所指出的，您可以禁用该按钮。不过，我更喜欢服务器端检查 - JS 可能被禁用，用户可能会点击刷新（尽管如果您正确使用 POST 会生成警告）等。

您可以在表单中添加时间戳并在会话中跟踪它 - 要求 POSTed 时间戳大于跟踪的时间戳。这将防止大多数重复发布，而不会明显影响 UI。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T23:19:53.580

还需要注意的是，如果 PHP 检测到用户“取消”了请求（通过关闭浏览器、按“停止”或再次按“提交”），PHP 的默认行为是停止执行脚本。如果您正在进行某种冗长的交易，这是不可取的。更多细节[在这里](http://au2.php.net/manual/en/features.connection-handling.php)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-29T22:39:39.620

我认为最好的选择是让 PHP 脚本首先在会话数组中设置一个标志，以指示它正在处理一个表单。这样，可以将第二个请求设置为等待原始请求完成（使用休眠呼叫服务器端等待标志清除）。

重要的是不要过多地干扰提交按钮和过程，因为网络的性质是不确定性之一；如果没有答案，用户可能想再次单击，并且您不想丢失他们的数据。如果第一个请求丢失并且您禁用了他们提交（并因此存储）数据的唯一方式，则可能会发生这种情况。

一种更简洁的解决方案是提交请求，并使用 javascript 显示一条消息“处理中”，以便用户可以看到正在发生的事情，但不会阻止他们重新提交数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T23:05:57.460

一种解决方案是使用 Javascript 立即禁用单击按钮。这显然依赖于客户端浏览器上的javascript。

服务器端技巧更好，因为如果用户两次编辑同一记录，它将捕获多个浏览器窗口之间的竞争条件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T17:34:18.920

当我使用 ASP.NET AJAX 时，我使用 javascript 完成了一个简单的版本，但它应该适用于您的按钮具有实际 ID 的任何情况。

我在按钮 onclick 事件中采取以下步骤：

1.  禁用触发 onclick 事件的按钮
2.  将按钮 ID 存储在一个魔术变量`closureId`中，稍后我可以通过闭包引用该变量
3.  使用该`setTimeout`函数在指定的毫秒数（5000ms = 5 秒）后执行动态定义的回调
4.  在回调函数中，我可以引用魔法`closureId`并在超时后重新启用按钮

下面是一个简单的 HTML 按钮，您可以将其单独放入 test.html 文件中进行操作：

**<input id="btnTest" type="button" value="test" onclick="var closureId=this.id; this.disabled = true; setTimeout(function(){document.getElementById(closureId).disabled = false; }, 5000);>**

您仍然应该按照其他人的建议进行服务器端检查，但在我自己的实例中，提交还对业务逻辑进行了服务器端验证。用户将提交他们的表单，然后必须等待服务器端的业务逻辑是否真的允许该条目。在开发过程中，当我可以关闭我的服务器并且仍然让表单提交失败时，它也有所帮助。

请注意，我称该`closureId`变量为“魔术”，因为我没有牢牢掌握它的工作原理——我刚刚意识到调用`this.id`不起作用，因为`this`它是对正在执行动态回调函数的超时函数的引用，并且没有没有任何类型的 DOM id。

我找不到任何其他方法来获取对原始事件的引用（this.this.id 不起作用），但词法范围以某种方式允许我仍然访问在原始事件时定义的closureId 变量按钮单击。

如果您知道更好的方法，请随时修复/评论！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T23:07:16.537

我通常在按下提交按钮后禁用它。会话限制可以很好地抵御直接攻击，但我不想在不属于它的地方混合接口逻辑。

# outlook - Date time stamp Outlook calendar entry automatically?

> ID：414843
> 
> 赞同：0
> 
> 时间：2009-01-05T23:04:51.940
> 
> 标签：outlook

I use Outlook 2007 calendar to schedule appointments. Is there a way to automatically date time stamp each appointment card as it is created? I want to know what time I created an appointment without having to manually enter it time.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:14:17.130

我花了很长时间才弄清楚。虽然 Zoredache 有一个可行的答案，但这里有另一种方法。对于 Outlook 2007：

1.  打开展望
2.  点击左侧菜单中的“日历”
3.  在屏幕顶部，单击“查看”
4.  将指针移动到“当前视图”
5.  单击“所有约会”或“活动约会” 您的约会现在应该从日历视图更改并显示为列表。湾。您的项目将按“主题、位置、开始、结束”等进行排序。
6.  右键单击显示“主题、位置、开始、结束”等的栏。
7.  单击“自定义当前视图...”
8.  将打开一个新窗口。点击“字段”
9.  在“可用字段：”下单击“已创建”
10.  然后点击“添加->”
11.  然后点击“确定”
12.  再次单击“确定”。

你就完了！现在根据需要对项目进行排序，找到有问题的项目，您将在 Created 字段下找到创建日期。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:58:32.210

**已经是名为Created**的 Outlook 约会项目上的一个属性，它将具有创建项目时的时间戳。我面前没有 Outlook 2007，所以我无法告诉您如何轻松查看该属性。

在 Outlook 2003 中，如果您正在查看日历的文件夹视图并选择“事件”视图，则可以右键单击列标题，选择**字段选择器**，然后添加已**创建**列。

您应该能够使用表单设计器创建自定义表单，并根据约会项目表单在表单的某处添加已创建字段。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-18T12:41:41.443

1.  打开约会
2.  单击左上角的圆形按钮（文件）
3.  单击属性
4.  最后修改将为您提供进入的日期和时间

# sql - What's the best way to copy a subset of a table's rows from one database to another in Postgres?

> ID：414849
> 
> 赞同：7
> 
> 时间：2009-01-05T23:06:36.600
> 
> 标签：sql, postgresql

I've got a production DB with, say, ten million rows. I'd like to extract the 10,000 or so rows from the past hour off of production and copy them to my local box. How do I do that?

Let's say the query is:

```
SELECT * FROM mytable WHERE date > '2009-01-05 12:00:00'; 
```

How do I take the output, export it to some sort of dump file, and then import that dump file into my local development copy of the database -- as quickly and easily as possible?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-07-08T17:09:50.153

资源：

```
psql -c "COPY (SELECT * FROM mytable WHERE ...) TO STDOUT" > mytable.copy 
```

目的地：

```
psql -c "COPY mytable FROM STDIN" < mytable.copy 
```

这假设 mytable 在源和目标中具有相同的模式和列顺序。如果不是这种情况，您可以尝试`STDOUT CSV HEADER`and`STDIN CSV HEADER`而不是`STDOUT`and `STDIN`，但我还没有尝试过。

如果您在 mytable 上有任何自定义触发器，您可能需要在导入时禁用它们：

```
psql -c "ALTER TABLE mytable DISABLE TRIGGER USER; \
         COPY mytable FROM STDIN; \
         ALTER TABLE mytable ENABLE TRIGGER USER" < mytable.copy 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T09:39:54.810

源服务器：

```
BEGIN;

CREATE TEMP TABLE mmm_your_table_here AS
    SELECT * FROM your_table_here WHERE your_condition_here;

COPY mmm_your_table_here TO 'u:\\source.copy';

ROLLBACK; 
```

your local box:

```
-- your_destination_table_here must be created first on your box

COPY your_destination_table_here FROM 'u:\\source.copy'; 
```

article: [http://www.postgresql.org/docs/8.1/static/sql-copy.html](http://www.postgresql.org/docs/8.1/static/sql-copy.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T23:27:13.610

从内部`psql`，您只需使用`copy`您给我们的查询，将其导出为 CSV（或任何格式），切换数据库`\c`并导入它。

`\h copy`进去看看`psql`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T09:04:02.963

使用您添加的约束（不是超级用户），我找不到纯 SQL 解决方案。但是用你最喜欢的语言做这件事很简单。你打开一个到“旧”数据库的连接，另一个连接到新数据库，你在一个中选择，在另一个中插入。这是一个在 Python 中经过测试和工作的解决方案。

```
 #!/usr/bin/python

""" 

Copy a *part* of a database to another one. See
<http://stackoverflow.com/questions/414849/whats-the-best-way-to-copy-a-subset-of-a-tables-rows-from-one-database-to-anoth>

With PostgreSQL, the only pure-SQL solution is to use COPY, which is
not available to the ordinary user.

Stephane Bortzmeyer <bortzmeyer@nic.fr>

"""

table_name = "Tests"
# List here the columns you want to copy. Yes, "*" would be simpler
# but also more brittle.
names = ["id", "uuid", "date", "domain", "broken", "spf"]
constraint = "date > '2009-01-01'"

import psycopg2

old_db = psycopg2.connect("dbname=dnswitness-spf")
new_db = psycopg2.connect("dbname=essais")
old_cursor = old_db.cursor()
old_cursor.execute("""SET TRANSACTION READ ONLY""") # Security
new_cursor = new_db.cursor()
old_cursor.execute("""SELECT %s FROM %s WHERE %s """ % \
                       (",".join(names), table_name, constraint))
print "%i rows retrieved" % old_cursor.rowcount
new_cursor.execute("""BEGIN""")
placeholders = []
namesandvalues = {}
for name in names:
    placeholders.append("%%(%s)s" % name)
for row in old_cursor.fetchall():
    i = 0
    for name in names:
        namesandvalues[name] = row[i]
        i = i + 1
    command = "INSERT INTO %s (%s) VALUES (%s)" % \
              (table_name, ",".join(names), ",".join(placeholders))
    new_cursor.execute(command, namesandvalues)
new_cursor.execute("""COMMIT""")
old_cursor.close()
new_cursor.close()
old_db.close()
new_db.close() 
```

# c# - 读取PSD文件格式

> ID：414852
> 
> 赞同：30
> 
> 时间：2009-01-05T23:07:19.360
> 
> 标签：c#, photoshop, file-format

我想知道这是否可能。我有一个应用程序，当您右键单击文件时会添加上下文菜单。一切正常，但这是我想做的：

如果文件是 PSD，那么我希望程序提取图像。这可以在没有安装 Photoshop 的情况下完成吗？

基本上我希望用户右键单击并单击“图像”，这将为他们保存文件的 .jpg。

编辑：将使用 c# 谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-05T23:43:25.963

[ImageMagick](http://www.imagemagick.org)库（为 C# 提供[绑定](http://midimick.com/magicknet/)）也支持 PSD 格式。它们可能比进入 Paint.NET 代码更容易上手，而且还附带一个完全免费的（类似 BSD）的许可证。

使用 MagickNet的简单示例（可在[http://midimick.com/magicknet/magickDoc.html 找到）](http://midimick.com/magicknet/magickDoc.html)如下所示：

```
using System;

static void Main(string[] args)
{
    MagickNet.Magick.Init();
    MagicNet.Image img = new MagicNet.Image("file.psd");
    img.Resize(System.Drawing.Size(100,100));
    img.Write("newFile.png");
    MagickNet.Magick.Term();
} 
```

注意：MagickNet 已移至[http://www.codeproject.com/KB/dotnet/ImageMagick_in_VBNET.aspx](http://www.codeproject.com/KB/dotnet/ImageMagick_in_VBNET.aspx)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-05T23:14:35.273

嗯，有一个 Paint.NET 的 PSD 插件，我认为它是开源的，你可能想看看初学者：

[http://frankblumenberg.de/doku/doku.php?id=paintnet:psdplugin#download](http://frankblumenberg.de/doku/doku.php?id=paintnet:psdplugin#download)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-12T10:23:42.860

这家伙做起来更容易：

[http://www.codeproject.com/KB/graphics/simplepsd.aspx](http://www.codeproject.com/KB/graphics/simplepsd.aspx)

带有 C# 库和示例项目。

我已经尝试过使用 PS2 文件并且工作正常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-21T07:18:17.413

我编写了一个 PSD 解析器，它从所有版本的 PSD 和 PSB 中提取光栅格式层。[http://www.telegraphics.com.au/svn/psdparse/trunk](http://www.telegraphics.com.au/svn/psdparse/trunk)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-04-30T14:20:24.037

您可以使用[GroupDocs.Viewer for .NET](https://products.groupdocs.com/viewer/net) API 在您的应用程序中使用几行代码将您的 PSD 文件呈现为图像（JPG、PNG、BMP）。

**C＃**

```
ViewerConfig config = new ViewerConfig();
config.StoragePath = "D:\\storage\\";

// Create handler
ViewerImageHandler imageHandler = new ViewerImageHandler(config);

// Guid implies that unique document name 
string guid = "sample.psd";

// Get document pages as images
List<PageImage> pages = imageHandler.GetPages(guid);

foreach (PageImage page in pages)
{
    // Access each image using page.Stream
} 
```

有关更多详细信息和示例代码，请访问[此处](https://docs.groupdocs.com/display/viewernet/Rendering+of+the+Documents+as+Image)。 *披露：我在 GroupDocs 担任开发人员布道师。*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-02-12T14:36:32.043

这是我自己的 psd 解析器和导出器：http: [//papirosnik.info/psdsplit/](http://papirosnik.info/psdsplit/)。它允许正确解析通道的 RGB 颜色 8、16 和 32 位的 psd，处理用户掩码，将所选图层导出为 jpeg、png、jng、bmp、tiff；创建导出层和组的 xml 布局，并从给定层创建纹理图集和动画集。它完全用 C# 编写。如果您希望其来源通过应用程序中关于对话框上的支持链接通知我。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-11-18T09:14:19.373

对于现在正在阅读本文的人：已接受答案的链接似乎不再起作用（至少对我而言）。会在那里添加评论，但还不允许评论 - 因此我要添加一个新答案。

您可以在其中找到 Paint.Net 的 psdplugin 代码的工作链接：[https ://github.com/PsdPlugin/PsdPlugin](https://github.com/PsdPlugin/PsdPlugin)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-29T07:15:51.460

ImageMagick.NET - [http://imagemagick.codeplex.com/](http://imagemagick.codeplex.com/) - 是 0xA3 给出的链接的更高版本，语法略有不同。（注意，这是未经测试的）：

```
using ImageMagickNET;

public void Test() {
        MagickNet.InitializeMagick();
        ImageMagickNET.Image img = new ImageMagickNET.Image("file.psd");
        img.Resize(new Geometry(100, 100, 0, 0, false, false);
        img.Write("newFile.png");
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-05T23:40:47.007

我从 psd 工作中提取出来。在这里查看我的答案

[如何从 Photoshop 文件中提取图层？C＃](https://stackoverflow.com/questions/499597/how-to-extract-layers-from-a-photoshop-file-c-sharp/14438310#14438310)

可以帮助别人。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-12T10:07:55.837

FastStone 非常有效地做到了这一点。他们没有可用的库，但我想您可以联系他们，看看他们是否可以提供帮助。

查看他们的网站： http: [//www.faststone.org/download.htm](http://www.faststone.org/download.htm)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-02T04:10:45.670

我在 Aspose 的 Imaging 组件上取得了巨大的成功，它可以在没有 Photoshop 的情况下加载和保存 PSD 文件：[https ://products.aspose.com/imaging/net](https://products.aspose.com/imaging/net)

# iphone - 如何为 iPhone 开发可分发的 UI 控件？

> ID：414856
> 
> 赞同：6
> 
> 时间：2009-01-05T23:08:28.517
> 
> 标签：iphone, cocoa-touch

我想为 iPhone 开发一个可重用的 UI 控件。我该怎么做呢？当我说可重用时，我的意思是它被打包在一个 dll 中（或 iPhone 平台上使用的任何东西），因此它可以在多个项目中重用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T23:14:18.130

虽然动态库不允许在 iPhone App Store 上出售的 iPhone 应用程序中使用，但这里有一个[使用 iPhone SDK 构建静态库的教程。](http://www.stormyprods.com/blogger/2008/11/using-static-libraries-with-iphone-sdk.html)（假设您不想发布源代码）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T23:13:55.057

您可能想要提供[自定义 Interface Builder 对象](http://developer.apple.com/documentation/developertools/conceptual/IB_UserGuide/CustomizingInterfaceBuilder/chapter_11_section_4.html#//apple_ref/doc/uid/TP40005344-CH16-SW12)，或者可能是源代码库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T12:13:58.477

你有两个选择：

1.  提供完整的源代码。然后其他开发人员可以将其直接添加到他们的应用程序中。
2.  将代码的编译版本分发为静态库。

当您计划开发一个 UI 控件时，我建议您也开发一个 IB 插件并附带它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T23:17:10.010

好吧，Xcode 的方式是将您的代码捆绑到一个框架中并链接到该框架。但是，在 iPhone 下，您不能链接到非 Apple 认可的框架（即使它们是您自己的）

因此，您可能必须将源链接到可重用代码。[这里有一篇好文章](http://blog.omnigroup.com/2008/10/01/using-frameworks-in-iphone-applications/)

# svn - 如何从 SVN 存储库中删除文件/文件夹并添加到忽略列表

> ID：414879
> 
> 赞同：31
> 
> 时间：2009-01-05T23:17:12.087
> 
> 标签：svn

对我来说，这听起来像是一个在手册中查找的问题，但我找不到。假设我们有一个存储库，其中的文件和目录不应该在版本控制之下，而是应该在忽略列表中（例如 Eclipse 文件`.settings`、`.project`生成的文档文件——这些东西本来就不应该被添加和提交）地方）。从存储库中删除这些文件并将它们直接移动到忽略列表中的最佳方法是什么？

**更新：** 下面接受的答案详细说明了设置本地颠覆存储库以避免上述问题的好方法。但是，如果您仍然需要解决这个问题，您似乎必须手动进行一些操作才能将文件/文件夹从存储库中取出并放到忽略列表中。

例如，对于`.settings`文件夹，首先将其添加到全局忽略列表中，然后运行以下命令：

```
$REMOVE=".settings"
cp -r "$REMOVE" /tmp/ && \
svn rm "$REMOVE" && \
svn commit -m "Moving to ignore list" "$REMOVE" && \ 
mv "/tmp/$REMOVE" . 
```

这会将文件/文件夹复制到一个临时位置，然后将其从 SVN 中删除并提交删除 - 最后文件/文件夹被复制回来，但由于它现在位于忽略列表中，它将被 SVN 忽略。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-05T23:31:45.193

subversion 有两种方式，一种是特定于用户的，另一种是实际维护在存储库中，因此会影响每个人。

对于全局忽略文件的列表（每个用户/机器独有），您需要编辑 subversion 配置文件并更改*miscellany*部分中的*global-ignores*指令。配置文件记录在案，语法非常简单。例如：

 *```
global-ignores = *.o 
```

在 UNIX 系统上，配置文件位于`~/.subversion/config`. 在 Windows 系统上，配置文件位于`%APPDATA%\Subversion\config`注册表中的`HKCU\Software\Tigris.org\Subversion\Config`.

设置好后，您将永远不会意外地将这些文件添加到您的存储库中，这些文件也不会显示为**?** 在你的`svn stat`命令中。如果您的存储库已经有这些文件，那么将它们保留原样可能不会有什么坏处，但是将来对文件的更改和修改将被忽略。

要在每个项目的基础上进行设置（这将影响任何签出项目的人），您可以将 svn:ignore 属性添加到可能存储文件的项目目录中。例如，要排除`build`项目顶层命名的目录，您可以执行以下操作：

```
svn propset svn:ignore 'build' .
svn commit -m 'project ignores build directory' . 
```

从现在开始，你的项目中的 build 目录将被 subversion 忽略。有关这方面的更多信息，请参阅[http://subversion.tigris.org/](http://subversion.tigris.org/)上的文档或发出`svn help`命令以获取更多信息。

***编辑：根据评论添加了更多内容......不知道我是如何错过原始问题的那部分的！对不起 ：）***

不幸的是，从存储库中删除您现在想要忽略的文件是一个手动过程，但是，如果您确切知道它们是哪些文件，您可以编写一个小脚本，让遇到此问题的人可以运行（将来，svn：忽略属性将使他们不必重复它，并且它的优点是可以在需要时轻松修改）。

要从存储库中删除不需要的文件，但保留本地文件，请执行以下步骤：

1.  创建您的 global-ignores 条目或将 svn:ignore 属性添加到您的存储库并提交。
2.  对于要从​​存储库中删除的每个文件，发出以下命令：`svn rm --keep-local **filename**`
3.  为每个文件发出`svn rm`命令后，提交工作副本。

因为如果他们没有更新他们的配置文件，这可能会产生从人们当前工作副本中删除文件的副作用，我强烈建议在存储库目录上使用 svn:ignore 属性。这样，当人们更新时，他们不会因为尚未修改`global-ignores`参数而意外删除文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-30T10:20:22.033

[我可以通过使用TortoiseSVN](http://tortoisesvn.tigris.org)工具来做到这一点。它们提供了一个名为“删除并添加到忽略列表”的 GUI 右键单击​​选项。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-05T23:21:36.367

```
svn remove filename 
```

忽略：

```
svn propset svn:ignore filename|pattern 
```

另请参阅*[如何... 使 Subversion 忽略文件和文件夹](http://sdesmedt.wordpress.com/2006/12/10/how-to-make-subversion-ignore-files-and-folders/)*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-19T19:17:52.760

感谢这个答案正是我所需要的。关于上面概述的最终脚本的一个想法，在您的脚本中执行 svn 导出而不是 cp -R 会更好吗？这样，您将获得没有任何 .svn 文件夹的干净文件夹。

例如

```
$REMOVE=".settings"
svn export "$REMOVE" /tmp/ && \
svn rm "$REMOVE" && \
svn commit -m "Moving to ignore list" "$REMOVE" && \ 
mv "/tmp/$REMOVE" . 
```

反正只是一个念头...

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-05T23:21:45.197

如果您希望它们永远消失（或者直到您自己将它们添加回来），您`svn rm`可以提交它们并将它们添加到`.svnignore`.

# nhibernate - 如何使用 NHibernate 和 Firebird 生成 id？

> ID：414889
> 
> 赞同：1
> 
> 时间：2009-01-05T23:21:42.250
> 
> 标签：nhibernate, insert, firebird, generator

我正在尝试使用 NHibernate 将一些新对象插入到 firebird 数据库中。

我收到错误“无法获取下一个序列值 [SQL：SQL 不可用]”

这是我目前使用的映射。注意 ANML_EVNT 是我要使用的生成器的名称。

```
 <id name="Id" column="ID" type="integer">
        <generator class="sequence">
            <param name="sequence">ANML_EVNT></param>   
        </generator>

    </id> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-13T20:58:34.243

如果您仍在寻找答案，这里就是我成功使用它的方式。

我使用“本机”生成器是因为当向我们的程序添加对 SQL Server 的支持时，我在 NHibernate 中唯一需要更改的是将生成器类型更改为“本机”，因为 Firebird 和 SQL Server 以不同的方式实现它们的“自动递增标识”列。在 Firebird 中，它使用了命名生成器，而在 SQL Server 中，它忽略了“sequence”参数并使用内置的自动增量。

这是我正在谈论的示例：

```
<id name="Id" column="ID">
   <generator class="native">
      <param name="sequence">ANML_EVNT</param>
   </generator>
</id> 
```

话虽如此，正如 gcores 回答的那样，您的配置似乎有问题的是 ANML_EVNT 之后的额外“>”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T23:52:47.023

看起来没问题。问题不在于 ANML_EVNT 之后的结束括号，对吧？

```
 <id name="Id" column="ID" type="integer">
      <generator class="sequence">
          <param name="sequence">ANML_EVNT</param>       
      </generator>

</id> 
```

# html - 什么是 DOCTYPE？

> ID：414891
> 
> 赞同：179
> 
> 时间：2009-01-05T23:21:53.513
> 
> 标签：html, xhtml, doctype, dtd

*   什么是 DOCTYPE，我为什么要使用它？
*   我可以使用哪些不同的 DOCTYPE？
*   标准和怪癖模式之间有什么区别，我可能会遇到不同设置的 DOCTYPE 的一些怪癖？

最后，我应该使用什么正确的 DOCTYPE？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-06T00:06:09.163

基本上，DOCTYPE 描述了将在您的页面中使用的 HTML。

浏览器还使用 DOCTYPE 来确定如何呈现页面。不包含 DOCTYPE 或包含不正确的 DOCTYPE 可能会触发怪癖模式。

关键在于，Internet Explorer 中的 quirks 模式与 Firefox（和其他浏览器）中的 quirks 模式完全不同。这意味着如果触发 quirks 模式，尝试确保您的页面与所有浏览器一致地呈现，而不是在标准模式下呈现，您将面临更艰巨的工作*。*

[Wikipedia 对使用各种 DOCTYPE 时的渲染差异进行](http://en.wikipedia.org/wiki/Quirks_mode#Comparison_of_document_types)了更深入的总结。XHTML 是由某些 DOCTYPE 启用的，关于 XHTML 的使用存在相当多的争论，XHTML 很好地涵盖了这一点[——神话和现实](http://www.dev-archive.net/articles/xhtml.html)。

不同的“符合标准”的渲染 DOCTYPE 之间存在细微的差异，例如 HTML5 DOCTYPE（`<!DOCTYPE html>`在 HTML5 之前，仅称为“瘦 doctype”，不会在旧版浏览器中触发标准化渲染）和其他 DOCTYPE，例如这个HTML 4.01 过渡：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-05T23:39:55.817

DOCTYPE 告诉消费用户代理（网络浏览器、网络爬虫、验证工具）文件是什么类型的文档。使用它可以确保消费者按照您的预期正确解析 HTML。

HTML、XHTML 和 Framesets 有几种不同的 DOCTYPE，每一种都有 Strict 和 Transitional 两种模式。Strict 表示您的标记完全使用定义的标准。有关详细信息，请参阅[W3C DTD](http://www.w3.org/QA/2002/04/valid-dtd-list.html)页面。

Quirksmode 基本上是浏览器大战时代的布局方法，当时标准很少受到尊重和定义。通常，有效的标准模式页面将在各种浏览器中更一致地布局，但可能缺少您需要的某些功能。锚标记的目标属性就是这样的特征之一。[Quirksmode](http://www.quirksmode.org/css/quirksmode.html)网站是这些差异的绝佳资源。

最后一个想法是新的 HTML5 标准建议使用一个非常简单的 DOCTYPE：

> `<!DOCTYPE html>`

使用此 DOCTYPE 是一种向前兼容的方式来指定您的页面处于标准模式，并且是 HTML。这是 Google 使用的方法，并且相当容易记住。除非您打算使用 XHTML，否则我建议使用此 DOCTYPE。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-05T23:24:34.943

doctype 定义了您的文档使用的 HTML/XHTML 版本。您可能希望使用 doctype，以便当您通过验证器运行代码时，验证器知道要检查哪个版本的 HTML/XHTML。此页面提供了一个很好的概述：

[不要忘记添加文档类型](http://www.w3.org/QA/Tips/Doctype)

您可以使用的常见文档类型在此处列出：

[推荐的 DTD 列表](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

您应该使用哪种文档类型取决于您使用的代码，但要了解一下，请尝试通过 W3C 验证器运行您的代码，并使用“更多选项”菜单中的**文档类型**下拉菜单来尝试不同的文档类型.

[W3C 标记验证服务](http://validator.w3.org/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-01-15T15:19:59.570

在网页上使用的 HTML（包括 XHTML）中，DOCTYPE 是一个字符串，它根据 DOCTYPE 的确切拼写触发几种浏览器模式（怪癖模式、标准模式、几乎标准模式）之一。您想使用它来选择最适合您的页面的浏览器模式。

正式地，在 SGML 和 XML 中，DOCTYPE 声明是对文档类型定义 (DTD) 的引用，它指定了标记语言的正式语法规则。没有浏览器曾经将 DTD 用于任何事情，甚至没有访问过它们。但是，SGML 和 XML 标记验证器（例如[W3C 标记验证器](http://validator.w3.org)）使用它们，HTML5 模式除外。因此，DOCTYPE 的选择决定了当文档提交给它时验证器的工作方式。但是，也可以在其用户界面中选择验证器的操作模式。（SGML 和 XML 处理器也可能以不同的其他方式使用 DOCTYPE，但这个问题显然仅限于 HTML 上下文以及 Web 浏览器和密切相关的软件。）

没有权威的 DOCTYPE 列表。每个 HTML 规范或草案都定义了自己的 DOCTYPE 或 DOCTYPE。选择模式时浏览器识别的 DOCTYPE 集因浏览器而异。在实践中，没有理由使用`<DOCTYPE html>` [HTML5 中定义](http://www.w3.org/TR/html5/syntax.html#the-doctype)的 DOCTYPE ，尽管 HTML5 也列出了一些“遗留 DOCTYPE”。如果您需要标准模式（推荐用于新页面），则可以使用该 DOCTYPE；如果您需要 quirks 模式（旧页面可能需要该模式），则可以不使用 DOCTYPE。

“标准模式”通常是指浏览器尽可能遵循 HTML、CSS、DOM 和其他规范的操作模式。它通常并不意味着完全符合。“Quirks 模式”在不同的浏览器中有所不同，但通常它意味着试图模仿非常旧的浏览器（如 IE 5）的行为。目的是保持旧页面正常工作，假设它们可能依赖于旧浏览器。查看描述[Quirks 模式会发生什么？](http://www.cs.tut.fi/~jkorpela/quirks-mode.html)请注意，HTML5 中有一个相当不同、更有限的“怪癖模式”概念，它与名为[Quirks Mode Living Standard](https://quirks.spec.whatwg.org/)的文档非常相似。

一个典型的问题是元素宽度在 quirks 模式和标准模式下的计算方式不同。这意味着，如果在标准模式下查看设计为在 quirks 模式下工作的页面（反之亦然），页面的布局可能或多或少会发生变化甚至完全混乱。

因此，您应该将`<!DOCTYPE html>`其用于新页面并保留您一直用于旧页面的任何 DOCTYPE（如果有）。

然而，怪癖模式意味着，在某些浏览器中，CSS 的许多新特性不受支持。这意味着，如果您想使用一些 CSS3 功能增强旧页面，可能需要切换到触发标准模式的 DOCTYPE。在这种情况下，您需要查看和测试页面以查看它是否会在标准模式下运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T23:32:28.653

doctype 是一个文档，它描述了类似 xhtml 的文档的内容（如网页）。*注意：这仅定义了所述页面的语法，页面的呈现不是由 DTD 定义的！*

例如，一个 doctype 可以定义`<table>`-tag 的外观 - 它接受哪些属性，以及每个属性接受哪些值/值类型。将其视为您当前网页的词典。

[维基百科](http://en.wikipedia.org/wiki/Doctype)有一个关于常用的各种 Doctype 的信息页面。请注意 - 没有什么能阻止您创建自己的文档类型。然而，浏览器可能不知道如何呈现您的文档。

使用哪个 DTD 取决于您要编写的内容。例如，XHTML 具有与 HTML 完全不同的 DTD。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-05T23:34:36.717

Doctypes 告诉浏览器页面是用什么语言编写的，无论是 HTML 还是 XHTML。例如，

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"> 
```

告诉浏览器将页面呈现为`HTML4 strict`. 旧版浏览器过去常常错误地呈现页面，因此新版浏览器在找到旧版文档类型时会模拟旧版浏览器的错误。

今天你应该至少使用 HTML4 或更好的 XHTML。

一篇关于 doctypes 的博客文章是*[使用正确的 DOCTYPE 修复您的网站！](http://www.alistapart.com/stories/doctype/)*（来自[A List Apart](http://en.wikipedia.org/wiki/A_List_Apart)）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T23:32:57.623

首先，您不应该使用一种文档类型，但大多数设计人员都试图使其在 XHTML 1.0 Strict 中工作。

doctype 只不过是声明您可以在 html 中使用哪些标签（尽管浏览器可以使用更多或更少的定义）您实际上可以打开 doctype 文件并开始阅读（[XHTML 1.0 Strict](http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd)）

如果您不指定 doctype，浏览器会尽力猜测，但并不总是能找到正确的类型。

Quirks 模式只是浏览器用来向后兼容的一种技术，quirks 模式的一个很好的例子是[IE 如何呈现框](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T18:31:39.697

在 Web 上，doctype 只告诉浏览器您想要标准、几乎标准或怪癖模式。

quirks 模式中的哪些变化取决于浏览器：Firefox、Opera、Safari 和 Chrome 实现了一组有限的 quirks，例如在`<table><tr><td><img></td></tr></table>`(solution: `td img { vertical-align:bottom; }`) 之类的代码中删除文本下行的空间。另一方面，IE 在 IE5.5 中恢复为渲染引擎。这意味着您将无法使用自 2000 年以来实施的*任何*新功能。

要触发标准模式，我建议使用 HTML5 文档`<doctype html>`类型，因为它最容易记住。

# java - 谷歌地图维基百科层

> ID：414893
> 
> 赞同：2
> 
> 时间：2009-01-05T23:22:56.303
> 
> 标签：java, javascript, google-maps, geolocation, geocoding

有没有办法以编程方式列出长/纬点半径内的所有地理标记的维基百科条目？我认为这可以通过谷歌地图 API 实现，但我对任何方法都感兴趣。注意：我不想显示 googlemap。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T23:41:05.673

是的，这是可能的。困难的部分是：

（1）屏幕抓取维基百科（坏主意，除非你已经有一个（小）目标页面列表）
（2）下载和解析大量的[维基百科数据集](http://en.wikipedia.org/wiki/Wikipedia_database)（更好的主意）

一旦你有了纬度/经度坐标，我假设它是维基页面的地理标记格式，你可以使用[大圆公式](http://en.wikipedia.org/wiki/Great-circle_distance)来计算相对距离，并完全绕过谷歌的 API。

这个故事的寓意是什么？当您处理如此庞大的数据集时，您将希望尽可能多地离线处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T07:01:28.903

我通过使用[GeoNames webservices](http://www.geonames.org/export/ws-overview.html)解决了一个稍微类似的问题。

您可以使用网络服务来请求城市等。您不能超过每个 ip 的限制。

我搜索得更远了，你发现了一些有趣的东西。该网络服务称为[`findNearByWikipedia`](http://www.geonames.org/export/wikipedia-webservice.html#findNearbyWikipedia). 它可能是你正在寻找的东西......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-08T05:28:04.190

另一种选择是使用 DbPedia SPARQL 接口。例如，以下 SPARQL 查询在受坐标限制的边界框中获取 wikipedia 文章。

SPARQL 库广泛可用，例如用于[Python 的 SPARQL Endpoint 接口](http://sparql-wrapper.sourceforge.net/)

要对其进行测试，只需将以下查询粘贴到此在线查询编辑器中：

[http://dbpedia.org/sparql](http://dbpedia.org/sparql)

```
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> 
PREFIX onto: <http://dbpedia.org/ontology/> 

SELECT * WHERE {
?s a onto:Place .
?s geo:lat ?lat .
?s geo:long ?long .
FILTER ( ?long > 30.3 && ?long < 30.5 && ?lat > 50.4 && ?lat < 50.5)
} 

LIMIT 100 
```

得到以下结果：

```
"s","lat","long"
"http://dbpedia.org/resource/Kotsiubynske","50.48972320556641","30.32888793945312"
"http://dbpedia.org/resource/Akademmistechko_%28Kiev_Metro%29","50.46555709838867","30.35499954223633"
"http://dbpedia.org/resource/Zhytomyrska_%28Kiev_Metro%29","50.45583343505859","30.36416625976562"
"http://dbpedia.org/resource/Sviatoshyn_Airfield","50.47833251953125","30.38500022888184" 
```

# ubuntu - 在启动时设置 Ubuntu 音量

> ID：414894
> 
> 赞同：7
> 
> 时间：2009-01-05T23:24:34.770
> 
> 标签：ubuntu, audio, volume

Ubuntu 启动/登录声音可能非常响亮，但我确实喜欢它。我写了一个脚本，使用 amixer 将音量设置为 25%。这是我喜欢的音量，但是当我使用电视输出或耳机时，我必须调高音量。在登录声音播放之前，我似乎无法让脚本运行。我尝试了一个 cron @reboot，并在 /etc/rc3.d/ 和我的 .bash_profile 脚本中放置了一个指向脚本的符号链接。只有第三种方法实际上正确设置了音量，但是在登录声音播放之后。

理想情况下，我希望在我晚上注销时或在 ubuntu 登录屏幕显示之前运行脚本。

这是设置音量的命令：

```
`/usr/bin/amixer -c 0 sset Master,0 25% > /dev/null` 
```

其他方法尝试的建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T00:50:22.537

您可能想尝试将该行添加到您的喜欢中，`/etc/rc.local` 但这可能还不够快，因为 rc.local 将在 gdm 之后调用。

另请注意，Ubuntu 上的默认运行级别是**2**，而不是**3**。您在 rc3.d 中的链接可能无法正常工作，因为您没有使用运行级别 3。默认运行级别由 /etc/event.d/rc-default 设置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T02:59:56.067

我相信 Ubuntu 的启动脚本已经包含“alsactl restore”。您应该能够在音量已设置为 25% 的情况下运行“alsactl store”并影响所有未来的重新启动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T06:06:59.113

啊，是的，但是它们在关机时是否还包含“alsactl 商店”？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-15T19:03:41.690

抢，

我正在尝试解决同样的问题。我把你带到上面的“amixer”行并做了很多关于运行级别、/etc/rc#.d 文件夹和 update-rc.d 命令的学习。这并不完美。在重新启动期间它仍然没有按照我想要的方式运行，但它是一个开始。

欢迎提出改进它的建议。

而且，这是我下面的代码......

sudo echo "#!/bin/bash" > /etc/init.d/lowvol.sh

sudo echo "/usr/bin/amixer -c 0 sset Master,0 35% > /dev/null" >> /etc/init.d/lowvol.sh

sudo chmod +x /etc/init.d/lowvol.sh

sudo chown root:root /etc/init.d/lowvol.sh

sudo update-rc.d lowvol.sh 停止 20 0 6 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-29T15:57:07.230

创建单元配置并启用它以进行启动。

假设 ALSA 和 systemd（Ubuntu 在 14 之后使用 systemd 版本）

# `/etc/systemd/system/alsavolume.service`

在这里创建一个单元文件。可以调整命令运行`/usr/bin/amixer sset PCM -- 97%`。请记住不要使用引号（否则 systemd 会将整个内容解释为命令）。

```
[Unit]
Description="Set volume level."
After=sound.target

[Service]
Type=simple
ExecStart=/usr/bin/amixer sset PCM -- 97%

[Install]
WantedBy=multi-user.target 
```

启用它（这意味着创建一个符号链接以`/etc/systemd/system/multi-user.target.wants`在启动时运行，但以下命令会为您处理它。）

1.  重新加载守护进程

    `systemctl daemon-reload`

2.  启用服务

    `systemctl enable alsavolume.service`

    您可以添加参数`--now`以立即运行该单元。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T01:12:36.223

我以前使用过[这种](http://wiki.archlinux.org/index.php/ALSA#Restore_ALSA_Mixer_settings_at_startup)方法来实现这一点，但在 Arch Linux 上。现在，我对 Ubuntu 使用的 init 系统不太熟悉，但我想你可以尝试将其适应 Ubuntu。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T06:22:56.240

您可以做的是编写一个脚本以在您关闭计算机时降低音量。像这样的东西：

```
#!/bin/sh

amixer -- sset Master playback -40dB

exit 1 
```

然后在关机时运行此脚本。

# c# - 解析具有许多（数百万）行的大型（> 4GB）文本文件的最佳（速度）方法是什么？

> ID：414896
> 
> 赞同：6
> 
> 时间：2009-01-05T23:24:37.720
> 
> 标签：c#, .net, parsing, text, buffer

我正在尝试确定什么是读取具有多行的大型文本文件、进行一些处理并将它们写入新文件的最快方法。在 C#/.net 中，StreamReader 似乎是一种看似快速的方法，但是当我尝试使用这个文件（逐行读取）时，它的速度大约是 python 的 I/O 速度的 1/3（这让我担心因为我一直听说 Python 2.6 的 IO 比较慢）。

如果没有更快的 .Net 解决方案，是否可以比 StreamReader 更快地编写解决方案，或者它是否已经使用了我永远不希望击败的复杂缓冲区/算法/优化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T23:35:04.860

你有你在做什么的代码示例，或者你正在阅读的文件的格式吗？

另一个好问题是您一次在内存中保留了多少流？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T02:48:41.363

如果您自己的代码一次检查一个字符，您想使用*标记*来标记缓冲区的结尾或文件的结尾，这样**您的内部循环中就只有一个测试**。在您的情况下，一个测试将用于行尾，因此您需要在每个缓冲区的末尾临时粘贴一个换行符，例如。

维基百科关于哨兵的文章根本没有帮助。它没有描述这种情况。您可以在任何 Robert Sedgewick 的算法教科书中找到描述。

您可能还想查看[`re2c`](http://re2c.org/)，它可以*生成*非常快速的代码来扫描文本数据。它会生成 C 代码，但您可以修改它，您当然可以通过阅读他们关于`re2c`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T23:33:14.190

StreamReader 非常好——你是如何用 Python 阅读它的？如果您指定更简单的编码（例如 ASCII），那么这可能会加快速度。进程占用多少 CPU？

您可以通过使用适当的 StreamReader 构造函数来增加缓冲区大小，但我不知道这可能会产生多大的差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T01:22:15.423

StreamReader/FileStream 使用的默认缓冲区大小对于数据中的记录长度可能不是最佳的，因此您可以尝试调整它们。您可以覆盖 FileStream 和包装它的 StreamReader 的构造函数中的默认缓冲区长度。您可能应该使它们具有相同的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T23:39:24.303

一般注意事项：

1.  高性能流媒体并不复杂。您通常必须修改使用流数据的逻辑；**这很**复杂。

其实，就是这样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T23:46:52.417

抱歉，如果我不是 .NET 专家，但在 C/C++ 中，如果您有不错的大缓冲区，您应该能够使用 LL1 解析器对其进行解析，其速度不会比扫描字节慢很多。如果你愿意，我可以提供更多细节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T23:53:37.677

尝试使用 BufferedReader 和 BufferedWriter 来加快处理速度。

# iphone - iPhone 设备上的静态库

> ID：414897
> 
> 赞同：4
> 
> 时间：2009-01-05T23:24:57.593
> 
> 标签：iphone, xcode, static-linking

我有两个项目，一个 Cocoa iPhone 应用程序和一个它使用的静态库。

我已经在 iPhone 模拟器上成功测试了它，但是当我尝试将它部署到我的 iPhone 设备时，我得到（未找到符号）链接错误。

如果我删除库的依赖项，则项目构建/运行良好。

我确保所有构建设置都设置为 iPhoneOS 而不是模拟器。

我确定它很简单，但是有没有人在从 iPhone 模拟器转移到设备时遇到过类似的问题？

--编辑：我已经成功地创建了新项目（一个用于应用程序，一个用于静态库），并成功地让它们在 iPhone 或模拟器上运行。但我有一个非常奇怪的问题......对于每个特定的项目，我无法让它同时适用于设备和模拟器......我已经仔细检查了构建设置，确保引用的库是用于匹配的构建设置（我相信），但我无法解决这些链接错误。

我想我一定是做错了什么……所有的苹果文档都说“超级简单——一键”，但这给我带来了很多问题。

这可能与 xCode 构建设置有关，但我似乎无法理解为什么选择不同的构建平台和重建库不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T23:32:03.977

查看[我对类似问题](https://stackoverflow.com/questions/414856/how-to-develop-distributable-ui-controls-for-iphone#414868)的回答，以获得可能有帮助的文章的链接。有一篇有趣文章的[链接。](http://www.stormyprods.com/blogger/2008/11/using-static-libraries-with-iphone-sdk.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T23:33:08.690

最终我意识到问题出在哪里。

我将设备目标从模拟器更改为 iPhone 设备，然后删除旧的（模拟器）静态库并附加新的（设备）库。

一切都很好，除了库搜索路径（在构建配置中）仍然首先列出了模拟器目录，我认为这会导致它被找到并使用而不是设备。

这也解释了为什么我能够使每个设置都适用于新项目，但只是在设置之间进行更改时遇到了麻烦。

这是一个简单而愚蠢的问题，但却给我带来了一些悲伤和时间。我仍然不确定如何正确设置依赖于目标的构建设置，但至少如果有人遇到类似问题，它需要注意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-03T06:54:33.753

我已经创建了一个关于如何创建和使用静态库的完整教程，本教程涵盖了苹果公司也建议的方法，也许人们会觉得它很有用：

[http://www.sodeso.nl/?p=822](http://www.sodeso.nl/?p=822)

这种方法的优点是它会根据您的项目设置自动重新编译库（因此设备/模拟器构建没有问题）

# ruby-on-rails - 为什么我突然在 Edge Rails (2.3) 中出现 Missing Template 错误？

> ID：414900
> 
> 赞同：2
> 
> 时间：2009-01-05T23:26:31.693
> 
> 标签：ruby-on-rails

冻结边缘导轨后，我所有的控制器示例都因 MissingTemplate 错误而失败。例如，“在视图路径 app/views 中缺少模板附件/create.erb”

尝试实际呈现视图会给我同样的错误。

我注意到我可以通过使用 respond_to 来修复大部分问题，但我通常从不使用它。我几乎总是只需要在一个操作中响应一种格式，因此我省略了 respond_to 并让 Rails 找出要渲染的文件。

从 2.3 开始，Rails 是否突然需要在每个操作中使用 respond_to 块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T23:33:47.997

刚找到这个，回答了我的问题：

[http://rails.lighthouseapp.com/projects/8994/tickets/1590-xhrs-require-explicit-respond_to](http://rails.lighthouseapp.com/projects/8994/tickets/1590-xhrs-require-explicit-respond_to)

# svn - 如何更改 SVN 中旧版本的提交者？

> ID：414905
> 
> 赞同：4
> 
> 时间：2009-01-05T23:28:51.453
> 
> 标签：svn

我有一大堆遗留代码，我签入了我的 SVN 存储库。我用我的用户名签入了它。我想将该提交的作者更改为另一个用户“旧版”，以清理`svn blame`打印输出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T00:22:33.843

您需要在存储库挂钩目录中有一个 pre-revprop-change 挂钩，以允许更改 svn:author 属性。（一个只包含“exit 0”的可执行脚本就可以了。）一旦你有了这个，你就可以这样做：

```
svn propedit --revprop -r *rev* svn:作者*网址*

```

并进行必要的更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T23:32:30.277

我不确定您是否可以直接执行此操作，但可以转储存储库，`sed`在其上使用并将其重新导入为新存储库。

# php - 在PHP中按键值对对象数组的数组进行排序

> ID：414906
> 
> 赞同：6
> 
> 时间：2009-01-05T23:28:54.980
> 
> 标签：php, arrays, object, sorting, key

基本上我有如下设置：

```
Array ( 
[0] => Array ( [0] => stdClass Object ( [nid] => 1 [title] => title1 [uid] => 1 [parent] => 0 [weight] => -15 [name] => name1 [value] => 0 )
               [1] => stdClass Object ( [nid] => 2 [title] => title2 [uid] => 1 [parent] => 0 [weight] => -7 [name] => name2 [value] => 100 )
               [2] => stdClass Object ( [nid] => 3 [title] => title3 [uid] => 2 [parent] => 0 [weight] => -1 [name] => name3 [value] => 0 )
               [3] => stdClass Object ( [nid] => 4 [title] => title4 [uid] => 2 [parent] => 0 [weight] => 1 [name] => name4 [value] => 80 )
              )
  ) 
```

我需要的是一种通过对象中的 [value] 键对父数组中的所有数组进行排序的方法。我已经用 usort 和不同的方法尝试了大约 2 天，但我似乎无法理解它。[value] 键的范围从 0 到 100，我需要按降序排序的所有数组（即：100 到 0）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-05T23:36:17.850

使用[usort](http://au2.php.net/manual/en/function.usort.php)：

```
function cmp($a, $b) {
  if ($a->value == $b->value) {
    return 0;
  } else {
    return $a->value < $b->value ? 1 : -1; // reverse order
  }
}

usort($arr, 'cmp'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T22:31:54.327

100% 从本页的第一个答案中窃取。 [http://us.php.net/manual/en/function.array-multisort.php](http://us.php.net/manual/en/function.array-multisort.php)
但这就是我想要的。

对对象数组进行多排序：

```
example object [$object with array of objects]: (class: test) 
---------------------------------- 

test Object (
  [Artikel] => Array (
      [0] => test Object (
            [id] => 1
            [title] => CCCC
         )
      [1] => test Object (
            [id] => 2
            [title] => AAAA
         )
      [2] => test Object (
            [id] => 3
            [title] => DDDD
         )
      [3] => test Object (
            [id] => 4
            [title] => BBBB
         )
   )
)

---------------------------------- 

Simple PHP function: sort_arr_of_obj()

<?php 
// -------------------------------------- 

/* 
* -------- function arguments -------- 
*   $array ........ array of objects
*   $sortby ....... the object-key to sort by
*   $direction ... 'asc' = ascending
* --------
*/

function sort_arr_of_obj($array, $sortby, $direction='asc') {

    $sortedArr = array();
    $tmp_Array = array();

    foreach($array as $k => $v) {
        $tmp_Array[] = strtolower($v->$sortby);
    }

    if($direction=='asc'){
        asort($tmp_Array);
    }else{
        arsort($tmp_Array);
    }

    foreach($tmp_Array as $k=>$tmp){
        $sortedArr[] = $array[$k];
    }

    return $sortedArr;

}

// -------------------------------------- 
?>

example call: 
---------------------------------- 

<?php 

$sorted->Artikel = sort_arr_of_obj($object->Artikel,'title','asc');

?>

example result: $sorted (class: test) 
---------------------------------- 

test Object (
  [Artikel] => Array (
      [0] => test Object (
            [id] => 2
            [title] => AAAA
         )
      [1] => test Object (
            [id] => 4
            [title] => BBBB
         )
      [2] => test Object (
            [id] => 1
            [title] => CCCC
         )
      [3] => test Object (
            [id] => 3
            [title] => DDDD
         )

   )
) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T14:37:03.770

一种方法是将值数组与对象数组分开，从而创建两个数组。然后，您可以使用 array_multisort 根据另一个数组对对象数组进行排序。这是一个例子：

```
<?php
$array1 = $objectvalues
$array2 = array(ObjectWithNid1, ObjectWithNid2, ObjectWithNid3, ObjectWithNid4);
array_multisort($array1, $array2);
?> 
```

您可以使用 foreach 循环一次数组并使用相应的 [value] 键创建一个新数组：

```
<?php
foreach( $arraywithobjects as $obj )
{
    $objectvalues[] = $obj->getValue();
}
?> 
```

这将获取对象的值并将其插入到另一个数组中，您可以将其与多重排序一起使用。

最后，您的代码将如下所示：

```
<?php
foreach( $arraywithobjects as $obj )
{
    $objectvalues[] = $obj->getValue();
}
$array2 = array(ObjectWithNid1, ObjectWithNid2, ObjectWithNid3, ObjectWithNid4);
array_multisort($objectvalues, $array2);
?> 
```

array_multisort 字段中的第一个数组应该是您用来对第二个数组进行排序的数组。

您还可以为此添加其他排序方法。你可以在这里阅读它们：[链接文本](http://us.php.net/manual/en/function.array-multisort.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T23:39:52.587

```
function cmp($a, $b) {
    return $b->value - $a->value;
}

$ary[0] = usort($ary[0], "cmp"); 
```

为了根据简单值或键以外的任何内容对数组进行排序，您需要使用该`usort`函数并提供您自己的比较。比较函数必须定义为，如果`$a`出现在 之前`$b`，则返回正值，如果出现在之前，则返回负值`$b`（`$a`如果它们相等，则返回零）。当您基于数值进行比较并且想要反向排序时，最简单的方法是`$a`从 的值中减去 的“值” `$b`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T23:36:17.773

我可能是错的，但我相信我使用 asort()（或 asort()）做了类似的事情。它在一个搜索功能中，我需要对一个填充了索引和时间戳的二维数组进行排序。

我不确定它是否适用于您的情况，我很久以前就这样做了。也许它会让你开始，但祝你好运。

# java - JMenus 导致 JOGL GLCanvas 画布闪烁

> ID：414915
> 
> 赞同：4
> 
> 时间：2009-01-05T23:32:45.160
> 
> 标签：java, opengl, jogl

单击 JMenu 选项会导致我的 JOGL GLCanvas 闪烁。

JMenu 将 setDefaultLightWeightPopupEnabled 设置为 false。我不想使用 JGLPanel，因为它运行速度较慢（应用程序需要以全屏模式运行）。

有趣的是，如果我在命令行上设置 sun.java2d.opengl=true，闪烁就会停止。但是，sun 默认情况下不启用此功能的事实让我担心我会冒着让用户遇到硬件不兼容问题的风险。

其他人点击菜单时是否看到下面的代码闪烁？

我已经尝试了各种方法，例如使用 JFrame 和画布的双缓冲选项，但没有让画布不闪烁的运气。

当查看菜单选项时，任何人都可以让它不闪烁吗？

谢谢！

-担

```
import javax.media.opengl.*;
import javax.swing.*;

public class FlickerTest extends JFrame {
    private GLCapabilities m_caps = new GLCapabilities();

    public FlickerTest() {
        super("FlickerTest");

        GLCanvas canvas = new GLCanvas(m_caps);
        add( canvas );
        canvas.addGLEventListener( new MyGLEventListener() );

        setSize( 640, 480 );
        setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );

        // false lets the JMenuBar appear on top of the remote image openGL canvas
        JPopupMenu.setDefaultLightWeightPopupEnabled(false);

        setJMenuBar( getMyMenuBar() );
        setVisible( true );
    }

    public static void main(String[] args) {
        new FlickerTest();
    }

    private static JMenuBar getMyMenuBar() {
        JMenuBar menuBar = new JMenuBar();
        JMenu fileMenu = new JMenu("File");
        JMenuItem quitMenuItem = new JMenuItem( "Quit" );
        JMenuItem doSomething = new JMenuItem("Do Something");
        fileMenu.add( quitMenuItem );
        fileMenu.add( doSomething );

        menuBar.add( fileMenu );
        return menuBar;
    }

    private class MyGLEventListener implements GLEventListener {
        private MyGLEventListener() {
        }

        public void init(GLAutoDrawable drawable) {
            GL gl = drawable.getGL();
            gl.glClearColor(1,1,0,0);
            gl.glBlendFunc(GL.GL_ONE,GL.GL_ONE);
            gl.glEnable(GL.GL_BLEND);
        }

        public synchronized void display( GLAutoDrawable p_glAutoDrawable ) {
            GL gl = p_glAutoDrawable.getGL();

            gl.glClear(GL.GL_COLOR_BUFFER_BIT);

            gl.glColor3f(0,0,1);
            gl.glRectf(-.5f,-.5f,.5f,.5f);
            gl.glFlush();
        }

        public void reshape(GLAutoDrawable p_drawable, int x, int y, int w, int h) {
        }

        public void displayChanged(GLAutoDrawable drawable, boolean modeChanged, boolean deviceChanged) {
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T00:26:58.700

尝试调用[`createBufferStrategy(2);`](http://download.oracle.com/javase/1.4.2/docs/api/java/awt/Canvas.html#createBufferStrategy%28int%29)JFrame 构造函数。这应该在 JFrame 中启用双缓冲。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T10:18:05.773

这是由于 AWT 每次在 JOGL 重新绘制之前都会擦除 GLCanvas 造成的，可以通过在 main() 方法中插入以下行来解决此问题：

`System.setProperty("sun.awt.noerasebackground", "true");`

虽然这解决了给定的问题，但在应用程序的其他区域可能会出现副作用，例如调整窗口大小时的可见伪影。我在我所有的 JOGL 应用程序中都使用它，但没有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T15:14:07.943

您可能想要添加一个[animator](http://download.java.net/media/jogl/builds/nightly/javadoc_public/com/sun/opengl/util/FPSAnimator.html)。画布可能会闪烁，因为 JFrame 刷新的速度不够快。

```
FPSAnimator = new FPSAnimator(GLCanvas,int TARGET_FPS, boolean); 
```

# c# - 数组的 DeepCopy

> ID：414922
> 
> 赞同：1
> 
> 时间：2009-01-05T23:35:11.863
> 
> 标签：c#, .net

任何人都知道是否有一种简单或已知的方法来编写可以在任何类型的数组（即锯齿状、多维等）上工作的深拷贝方法？我打算把它写成一个扩展方法。

框架中没有执行此操作的默认方法，对吗？我很惊讶没有找到。

我见过一些基于序列化的实现，它们的速度非常慢，所以我想要一个不使用任何类型的序列化的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T05:20:38.547

这个问题的当前状态有点不清楚；它*可能*是[重复](https://stackoverflow.com/questions/129389)的（在已删除的回复中注明），但评论表明这不太合适。

重新序列化会减慢速度 - 不幸的是，.NET 中没有适当支持的“深度克隆”功能。有`ICloneable`，但那是 a: 很少使用，和 b: 没有说是浅的或深的。因此，唯一剩下的深度克隆数据的**可靠**方法是使用序列化。

重新“慢得要命”，你能量化吗？那使用的是哪种序列化机制？（`BinaryFormatter`？？`XmlSerializer`）。有关信息，您可能对[protobuf-net](http://code.google.com/p/protobuf-net/)感兴趣，它是一种非常快速且高效的替代二进制序列化程序（并且提供了一种非常方便的`T DeepClone<T>(T)`方法） - 但是，它仅适用于以特定方式标记的类（例如，它可以使用`[DataContract]`标记或定制`[ProtoContract]`标记）。不过，它比内置的序列化程序要[快。](http://code.google.com/p/protobuf-net/wiki/Performance)

唯一可行的选择是编写您自己的、按类型的、深拷贝例程，并可能将其传递（作为 a`Func<T,T>`或`Converter<T,T>`委托）到您的扩展方法。

如果您只想要一个**浅**拷贝，事情会更容易，因为您可以使用反射等。[这是一个](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/d9722a51b04300a/0edae91abc1c0f1a#0edae91abc1c0f1a)使用已编译（.NET 3.5）创建浅拷贝`Expression`以提高性能的选项。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-07T18:50:59.597

我会先试一试：

```
internal static class Prototype
{
  public static T DeepCopy<T>(this IPrototype<T> target)
  {
    T copy;
    using (var stream = new MemoryStream())
    {
      var formatter = new BinaryFormatter();
      formatter.Serialize(stream, (T)target);
      stream.Seek(0, SeekOrigin.Begin);
      copy = (T) formatter.Deserialize(stream);
      stream.Close();
    }
    return copy;
  }
} 
```

如果这没有你想要的那么快，*那么*我会优化。

# delphi - 有什么方法可以获取容器控件上的所有控件？

> ID：414928
> 
> 赞同：14
> 
> 时间：2009-01-05T23:37:46.023
> 
> 标签：delphi, forms, controls, iterator, vcl

我有一个带有一堆控件的表单，我想遍历某个面板上的所有控件并启用/禁用它们。

我试过这个：

```
var component: TComponent;
begin
  for component in myPanel do
    (component as TControl).Enabled := Value;
end; 
```

但这无济于事。原来所有组件都在表单的组件集合中，而不是它们的父对象。那么有谁知道是否有任何方法可以将所有控件放入控件中？（除了像这样丑陋的解决方法，这是我最终不得不做的）：

```
var component: TComponent;
begin
  for component in myPanel do
    if (component is TControl) and (TControl(component).parent = myPanel) then
      TControl(component).Enabled := Value;
end; 
```

有人请告诉我有更好的方法...

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-05T23:41:09.277

您正在寻找`TWinControl.Controls`数组和随附的`ControlCount`属性。这些是针对控件的直系子级的。要获得孙子等，请使用标准递归技术。

您并不真正想要`Components`数组（这是`for`-`in`循环迭代的内容），因为它通常与父子关系无关。组件可以拥有没有子关系的事物，而控件可以拥有不属于它们的子项。

另请注意，禁用控件也会隐式禁用其所有子项。您不能与禁用控件的子级交互；操作系统不会向他们发送输入消息。但是，要使它们*看起来*被禁用，您需要单独禁用它们。也就是说，要使按钮具有灰色文本，仅禁用其父级是不够的，即使该按钮不会响应鼠标单击。您需要禁用按钮本身以使其“禁用”自己绘制。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-05T23:44:29.957

如果禁用面板，则其上的所有控件也会被禁用。

使用匿名方法的递归解决方案：

```
type
  TControlProc = reference to procedure (const AControl: TControl);

procedure TForm6.ModifyControl(const AControl: TControl; 
  const ARef: TControlProc);
var
  i : Integer;
begin
  if AControl=nil then
    Exit;
  if AControl is TWinControl then begin
    for i := 0 to TWinControl(AControl).ControlCount-1 do
      ModifyControl(TWinControl(AControl).Controls[i], ARef);
  end;
   ARef(AControl);
end;

procedure TForm6.Button1Click(Sender: TObject);
begin
  ModifyControl(Panel1,
    procedure (const AControl: TControl)
    begin
      AControl.Enabled := not Panel1.Enabled;
    end
  );
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-24T18:46:28.713

这是Delphi 2007的方式：

```
procedure TForm6.ModifyControl(const AControl: TControl; const value: Boolean);
var
  i: Integer;
begin
  if AControl=nil then Exit;
  if AControl is TWinControl then begin
    for i := 0 to TWinControl(AControl).ControlCount-1 do
      ModifyControl(TWinControl(AControl).Controls[i], value);
  end;
  Acontrol.Enabled := value;
end;

procedure TForm6.Button1Click(Sender: TObject); 
begin 
  ModifyControl(Panel1, true);  // true or false
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T01:36:48.920

简单地

```
Panel.Enabled := Value; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-27T08:37:23.767

这个找到所有控件，也嵌套在框架等中，并通过列表指向它们。请注意之后释放列表。

```
Function AllControls(form : tForm) : tList<tControl>;
Procedure Add(Control : tControl );
var i : integer;
begin
  if Control is TWinControl then
  with TWinControl(Control) do
  for i := 0 to Controlcount-1 do
    Add(Controls[i]);

    if Control <> form  then
    result.Add(Control);
  end;
 begin
   result := tlist<tControl>.create;
   add(form);
 end;

 var contrls : tlist<tcontrol>;
     c : tcontrol;
 begin
    try
      contrls := AllControls(form1);
      for c in ctrls do Visit(c);  // Do something
    finally
      contrls.free;
    end;
 end; 
```

如果你想要一个通用版本，你可以要求一个特定的控件类型，你可以使用这个：

```
Procedure TForm1.Addcontrols( control : tcontrol; list : tlist<tcontrol>);
var i : integer;
begin
  if control is twincontrol then
  with twincontrol(control) do
    for i := 0 to controlcount-1 do
    addControl(controls[i], list);
    list.Add(control)
end;

Function TForm1.GetControls<T>(f : tform) : tlist<T>;
var list : tlist<tcontrol>;
    c : tcontrol;
begin
  list := tlist<tcontrol>.Create;
  addControls(f, list);
  result := tlist<t>.create;
  for c in list do
  if c <> f  then
  if c is t then
  result.Add(c);
  list.free;
end;

procedure TForm1.FormCreate(Sender: TObject);
VAR List : TList<TRadioButton>;
begin
  List := GetControls<TRadioButton>(self);
end;

end. 
```

采用

```
 List := GetControls<TControl>(self); 
```

获得所有控制..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-04T16:43:44.330

我知道这篇文章有点旧，但我是基于对相同信息的搜索来到这里的。这是我为任何感兴趣的人编写的一些 C++ 代码。

```
// DEV-NOTE:  GUIForm flattens the VCL controls
// VCL controls are nested.  I.E. Controls on a
// Panel would have the Panel as a parent and if
// that Panel is on a TForm, TForm's control count
// does not account for the nested controls on the
// Panel.
//
// GUIControl is passed a Form pointer and an index
// value, the index value will walk the controls on the
// form and any child controls counting up to the idx
// value passed in.  In this way, every control has a
// unique index value
//
// You can use this to iterate over every single control
// on a form.  Here is example code:
//
// int count = 0;
// TForm *pTForm = some_form
// TControl *pCtrl = 0;
// do
// {
//      pCtrl = GUIControl(pTForm, count++);
//
// }while(pCtrl);

TControl *GUIControl(TForm *F, int idx)
{
    TControl *rval = 0;
    int RunCount = 0;

    for(int i=0; i<F->ControlCount && !rval; i++)
    {
        TControl *pCtl = F->Controls[i];

        if(RunCount == idx )
            rval = pCtl;
        else
            rval = GUIChildControl( pCtl, RunCount, idx);

        RunCount++;
    }

    return(rval);
}

TControl *GUIChildControl(TControl *C, int &runcount, int idx)
{
    TControl *rval = 0;
    TWinControl *pC = dynamic_cast<TWinControl *>(C);
    if(pC)
    {
        for(int i=0; i<pC->ControlCount && !rval; i++)
        {
            TControl *pCtrl = pC->Controls[i];
            runcount++;

            if( runcount == idx)
                rval = pCtrl;
            else
            {
                TWinControl *pCC = dynamic_cast<TWinControl *>(pCtrl);

                if(pCC)
                {
                    if( pCC->ControlCount )
                        rval = GUIChildControl(pCtrl, runcount, idx);
                }
            }
        }
    }

    return(rval);
} 
```

# c# - ASP.Net Mvc - 视图调用可能导致数据检索的函数是否可以接受？

> ID：414931
> 
> 赞同：8
> 
> 时间：2009-01-05T23:38:50.403
> 
> 标签：c#, asp.net-mvc, model-view-controller

我目前正在使用 Asp.Net mvc 框架，并且与经典的 asp.net 方式相比，我喜欢它。我正在讨论的一件事是视图是否可以接受（间接）访问数据库？

例如，我使用控制器来填充自定义数据类，其中包含我认为视图需要完成其工作的所有信息，但是当我将对象传递给视图时，它也可能导致数据库读取。

一个快速的伪示例。

```
public interface IProduct
{
    /* Some Members */

    /* Some Methods */
    decimal GetDiscount();
}

public class Product : IProduct
{
    public decimal GetDiscount(){ ... /* causes database access */ }
} 
```

如果 View 可以访问 Product 类（它被传递一个 IProduct 对象），它可以调用 GetDiscount() 并导致数据库访问。

我正在想办法防止这种情况发生。目前我只是想出`Product`类的多接口继承。而不是只实现 IProduct 它现在将实现`IProduct`and `IProductView`。IProductView 将列出类的成员，IProduct 将包含可能导致数据库访问的方法调用。

“视图”只知道`IProductView`类的接口，无法调用导致数据访问的方法。

关于在将对象传递到视图之前“锁定”对象，我还有其他模糊的想法，但我可以预见到这种方法会产生巨大的副作用。

所以，我的问题：

*   有没有关于这个问题的最佳实践？
*   使用 MVC 的其他人如何阻止 View 变得顽皮并对对象做更多的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T00:14:44.123

您的视图并没有真正导致数据访问。视图只是在模型接口中调用 GetDiscount() 方法。这是导致数据访问的**模型。**实际上，您可以创建另一个不会导致数据访问的 IProduct 实现，但视图不会发生变化。

当视图试图提取数据进行显示时，执行延迟加载的模型对象总是会导致数据访问。

好不好就看个人口味和喜好了。

但是，除非您有充分的理由进行延迟加载，否则我更愿意将数据加载到模型对象中，然后传递“准备就绪”以供视图显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T23:54:56.457

> 我正在讨论的一件事是视图是否可以接受（间接）访问数据库？

我经常问同样的问题。我们在 Stack Overflow Views 中访问模型的很多东西都可能导致隐式数据库访问。这几乎是不可避免的。很想听听其他人对此的看法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T00:18:24.303

如果你让你的域对象“持续无知”，那么你就不会有这个问题。也就是说，与其在 Product 类中使用 getDiscount，不如只使用一个名为 Discount 的简单属性？然后，这将由您的 ORM 在从数据库加载 Product 类的实例时设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T00:09:11.607

模型不应包含由数据访问组成的方法（“动作”）。这是 DAL 的担忧。您可以将折扣百分比属性存储在产品类中，并让 GetDiscount 方法返回一个简单的计算，例如价格 * (100 - discountPercent) 或类似的东西。

我将我的业务实体（您的示例中的产品）与数据访问断开连接。这是存储库（在我的情况下）的关注点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T00:19:47.717

在此之前，我在 MonoRail 中构建了一个站点，有时有一些方法可以触发视图中的数据访问。我尽量避免它，因为当它失败时，它可能会以不寻常且无法修复的方式失败（例如，我不能真正尝试/捕获 NVelocity 模板）。这完全不是世界末日——多年来，我编写了抽象的 PHP 站点，这些站点从视图访问数据库，它们仍然运行良好，因为大多数情况下，如果出现问题，你只是重定向到“无论如何，有些东西不起作用”类型的错误页面。

但是，是的，我尽量避免它。从更大的意义上说，我的域模型通常不会一直渗透到视图中。取而代之的是，视图正在渲染`Document`对象，这些对象毫不掩饰地只是强类型的数据转储，所有内容都经过预先格式化、搅打、压碎和搅成糊状，以至于视图只需要用一些循环和 if/ 吐出一些字符串else's，将数字“4”转换为 4 星图像等。该文档通常由位于漂亮域模型前面的 Web 服务返回，或者它只是在控制器中构造并传递为的简单结构的一部分`ViewData`. 如果直接使用域对象，那么它通常不会做任何事情来显式触发数据访问；这由视图无权访问且域对象通常也无权访问的类似集合的存储库处理。

但你不必那样做。您可能会受到足够的训练，以至于不会从视图中调用那些触及数据库的方法。

# powershell - 交换 powershell：在默认范围之外获取邮箱

> ID：414932
> 
> 赞同：2
> 
> 时间：2009-01-05T23:39:20.997
> 
> 标签：powershell, exchange-server

如何在当前域的当前默认范围之外运行 cmdlet“get-mailbox”？

当我运行 get-mailbox -OrganizationalUnit bob.com/bobsage 时，我收到一条错误消息：Get-mailbox: The requested search root 'rss.com/rsstoilet' is not in the current default scope 'ens.com'。无法在当前默认范围之外执行搜索。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T09:14:23.707

尝试设置这个全局变量：

`$AdminSessionADSettings.ViewEntireForest = $True`

或使用`Set-ADServerSettings -ViewEntireForest $True`

或者将其设置在 cmdlet 级别：

`Get-Mailbox -IgnoreDefaultScope`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T23:52:15.447

我很确定错误消息是准确的 - 它*无法*在当前默认范围之外执行搜索。您需要更改运行命令的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-24T11:10:56.920

如果使用第二个选项 (-ignoredefaultscope)，请确保将对象的 DN 作为参数传递给 -Identity。

例如：Get-Mailbox -IgnoreDefaultScope -Identity "cn=username,ou=ouname,dc=domainname,dc=com"

谢谢， 西塔拉姆帕玛蒂

[www.techibee.com](http://techibee.com)

# javascript - 在 ajax.load 之后访问 DOM 元素

> ID：414943
> 
> 赞同：1
> 
> 时间：2009-01-05T23:43:09.117
> 
> 标签：javascript, jquery, dom, client-side

我正在将来自 AJAX 调用的 HTML 响应插入到我的页面中，但是当我在创建这些元素后尝试访问它们时，它失败了。

这就是我检索和插入 HTML 的方式：

```
$.ajax({url: 'output.aspx',
   data: 'id=5', 
   type: 'get', 
   datatype: 'html',
   success: function(outData) {$('#my_container').html(outData);} 
}) 
```

插入`<div>`(id = `my_container`) 的结果 HTML 如下所示：

```
<div id="my_container">
   <ul>
      <li id="578" class="notselected">milk</li>
      <li id="579" class="notselected">ice cream</li>
      <li id="580" class="selected">chewing gum</li>
   </ul>
</div> 
```

...然后，当我尝试`<li>`使用以下查询访问任何元素时： `$('#my_container li:first')`或 `$('#my_container ul:first-child')`类似的，没有任何选择。

我正在使用[Listen 插件](http://plugins.jquery.com/project/Listen)来检测元素上的任何点击事件`<li>`并且它可以工作......但我无法弄清楚如何检测 div 是否填充了输出 HTML 并相应地更改其中一个`<li>`类例如...

`$(document).ready`也不起作用...

想象一下，我需要更改第二个的 css 样式`<li>`.. 解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T23:55:04.287

您如何检查您的 AJAX 调用是否已完成？`$.ajax(…)`因为它是异步的，所以在调用之后立即执行的代码当然不能使用这些元素。

尝试从`success`函数内部或从那里调用的其他代码中操作这些元素——此时，您将知道内容可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T23:50:03.533

你确定你的实际请求成功了吗？如果没有选择任何内容，最可能的原因是最初实际上没有将任何内容插入 #my_container。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T00:03:58.637

首先，尝试以下代码（代替您显示的原始 AJAX 调用）：

```
var html = $.ajax({url: 'output.aspx',
   data: 'id=5', 
   type: 'get', 
   datatype: 'html',
   async: false
}).responseText;
$('#my_container').html(html); 
```

如果这样可行，那么您的`li:first`选择器只是在 AJAX 请求完成之前被调用。如果这不起作用，请尝试以下代码：

```
$.ajax({url: 'output.aspx',
   data: 'id=5', 
   type: 'get', 
   datatype: 'html',
   success: function(outData) { $('#my_container').html(outData); }, 
   error: function(errorMsg) { alert('Error occured: ' + errorMsg); }
}); 
```

如果请求失败，这将导致弹出错误消息。如果弹出带有错误消息的错误消息，则请求不会返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-06T17:23:39.913

看起来您正在尝试在创建这些元素之前访问它们，因为您当前的 ajax 调用是异步的，请尝试将选项： **“async=false”** 放到您的 ajax 中，它应该可以工作。

# linq-to-sql - 使用 Linq 查询分层表/复合模式中的终端/叶节点

> ID：414945
> 
> 赞同：3
> 
> 时间：2009-01-05T23:43:40.393
> 
> 标签：linq-to-sql, design-patterns, composite, hierarchical

我有一个带有 Id、CategoryName 和 ParentId 的自引用表。这是类别层次结构表的典型场景，这些类别本身可以划分为数据库专家告诉我的类别，称为邻接模型。

我想要的是使用 Linq to SQL 来查询本身与其他子类别无关的子类别，即它们是某个给定类别或子类别的直接叶节点。

我得到了最简单的部分，它只是获取子类别。差点不好意思把代码放在这里。但我们确实喜欢看代码..

```
IList<Categories> subcategories = context.Where( c => c.ParentId == 1).ToList(); 
```

但是将其缩小到没有子类别的类别让我大吃一惊。任何帮助将非常感激。

谢谢你的帮助。杰夫

更新**这似乎可行，但如果有人能确认它是“正确的”，我将不胜感激。因此，如果我想要 Id = 1 的类别下的叶节点，我会这样做：

```
Categories.Where( c => !c.Children.Any ( d => d.ParentId == c.Id)).Where( e => e.ParentId == 1) 
```

“孩子”是 Linq 给自引用关联的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T00:58:37.607

您的解决方案是正确的`Any()`，因为该方法转换为 sql "EXISTS()" 函数并`!c.Children.Any ( d => d.ParentId == c.Id))`转换为类似于`NOT EXISTS (SELECT * FROM Categories WHERE ParentID = outerRef.ID)`

另一种方法是使用`Count`：

```
Categories.Where( c => c.Children.Count(d => d.ParentId == c.Id) == 0).Where( e => e.ParentId == 1) 
```

但通常 EXISTS() 在 sql 中优于 COUNT() （出于性能原因），因此 Any() 的解决方案应该是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:56:57.720

我想如果我正确理解您的问题，您正在尝试获取所有没有自己的子元素的子元素......这个查询自身加入表以测试该节点是否用作父节点，如果它是不是然后它显示在结果中。

我不确定这是否有效，因为我没有什么可以测试它...

```
 (from c in context
    join cc in context on c.id equals cc.parentid into temp
    from t in temp.DefaultIfEmpty()
    where t == null
    select c).ToList() 
```

# asp.net - 使用 OnClientClick 检查 ValidationSummary 是否有效

> ID：414946
> 
> 赞同：4
> 
> 时间：2009-01-05T23:43:53.030
> 
> 标签：asp.net, javascript, validation, upload

有没有办法在按钮的 OnClientClick 事件中使用 Javascript 来检查 ValidationSummary 控件的 IsValid 属性是否设置为 true？

我要做的是在上传页面上显示一条消息，上面写着“请稍候，您的文件正在上传”，但是如果我使用 javascript 来显示该消息，即使 ValidationSummary 有错误，它也会显示出来，所以消息与下面的错误一起显示，这使用户感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T00:30:29.397

我认为这会做你想要的。

```
var isValid = false;
if (typeof(Page_ClientValidate) == 'function') 
{
   isValid = Page_ClientValidate();
}

if(isValid)
{
   ShowMessage(...);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T00:32:16.910

如果其他人需要这样的东西，这是我的解决方案：

在按钮的 OnClientClick 事件中，我调用了一个名为 showContent() 的 JavaScript 函数。在这个函数中，我使用 setTimeout 调用第二个函数来检查页面的 IsValid 属性：

```
function showContent() 
{
    setTimeout("delayedShow()", 1);
}

function delayedShow() 
{
    if (Page_IsValid != null && Page_IsValid == true) 
    {
       document.getElementById('divUploading').style.display = "block";
    }
} 
```

在事件`Page_IsValid`中返回 true，`OnClientClick`因为 javascript 验证在此之后运行，因此 1 秒延迟允许正确设置 IsValid 属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T10:14:02.750

如果您在单个页面上有多个验证组，那么您应该只检查某个组：

```
var isValid = Page_ClientValidate('GroupName'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T23:50:11.630

我想你应该做的是[禁用上传按钮](http://blog.shkedy.com/2007/01/clickonce-button-for-aspnet-20.html)并在上传过程中显示一条消息。例如，通过使用 ajax 面板和进度模板。

# python - SQLAlchemy DateTime 时区

> ID：414952
> 
> 赞同：57
> 
> 时间：2009-01-05T23:46:02.123
> 
> 标签：python, postgresql, datetime, sqlalchemy, timezone

SQLAlchemy 的`DateTime`类型允许一个`timezone=True`参数将一个非天真的日期时间对象保存到数据库中，并按原样返回它。有什么方法可以修改`tzinfo`SQLAlchemy 传入的时区，例如，它可能是 UTC？我意识到我可以使用`default=datetime.datetime.utcnow`; 然而，这是一个天真的时间，即使我使用`timezone=True`它，它也会很乐意接受传递一个天真的基于本地时间的日期时间的人，因为它使本地或 UTC 时间变得不天真，而没有一个基准时区来规范它。我已经尝试（使用[pytz](http://pytz.sourceforge.net/)）使 datetime 对象不幼稚，但是当我将它保存到数据库时，它又变得幼稚。

请注意 datetime.datetime.utcnow 如何不能很好地工作`timezone=True`：

```
import sqlalchemy as sa
from sqlalchemy.sql import select
import datetime

metadata = sa.MetaData('postgres://user:pass@machine/db')

data_table = sa.Table('data', metadata,
    sa.Column('id',   sa.types.Integer, primary_key=True),
    sa.Column('date', sa.types.DateTime(timezone=True), default=datetime.datetime.utcnow)
)

metadata.create_all()

engine = metadata.bind
conn = engine.connect()
result = conn.execute(data_table.insert().values(id=1))

s = select([data_table])
result = conn.execute(s)
row = result.fetchone() 
```

> (1, datetime.datetime(2009, 1, 6, 0, 9, 36, 891887))

```
row[1].utcoffset() 
```

> datetime.timedelta(-1, 64800) # 那是我的本地时间偏移！！

```
datetime.datetime.now(tz=pytz.timezone("US/Central")) 
```

> datetime.timedelta(-1, 64800)

```
datetime.datetime.now(tz=pytz.timezone("UTC")) 
```

> datetime.timedelta(0) #UTC

即使我将其更改为明确使用 UTC：

...

```
data_table = sa.Table('data', metadata,
    sa.Column('id',   sa.types.Integer, primary_key=True),
    sa.Column('date', sa.types.DateTime(timezone=True), default=datetime.datetime.now(tz=pytz.timezone('UTC')))
)

row[1].utcoffset() 
```

...

> datetime.timedelta(-1, 64800) # 它没有使用我明确添加的时区

或者，如果我放弃`timezone=True`：

...

```
data_table = sa.Table('data', metadata,
    sa.Column('id',   sa.types.Integer, primary_key=True),
    sa.Column('date', sa.types.DateTime(), default=datetime.datetime.now(tz=pytz.timezone('UTC')))
)

row[1].utcoffset() is None 
```

...

> True # 这次它甚至没有将时区保存到数据库

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-20T16:24:22.457

[http://www.postgresql.org/docs/8.3/interactive/datatype-datetime.html#DATATYPE-TIMEZONES](http://www.postgresql.org/docs/8.3/interactive/datatype-datetime.html#DATATYPE-TIMEZONES)

> 所有可识别时区的日期和时间都以 UTC 格式在内部存储。在显示给客户端之前，它们会转换为 timezone 配置参数指定的区域中的本地时间。

用 postgresql 存储它的唯一方法是单独存储它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-02T17:16:57.690

[这个问题的](https://stackoverflow.com/questions/2528189/can-sqlalchemy-datetime-objects-only-be-naive)答案给出了一个解决方案：

您可以通过以 UTC 格式将所有（日期）时间对象存储在数据库中，并将生成的原始日期时间对象转换为检索时的感知对象来规避这种情况。

唯一的缺点是您会丢失时区信息，但无论如何，将您的日期时间对象存储在 UTC 中可能是个好主意。

如果您关心时区信息，我会将其单独存储，并且仅在最后一个可能的实例中将 utc 转换为本地时间（例如，在显示之前）

或者也许你根本不需要关心，并且可以使用运行程序的机器上的本地时区信息，或者如果它是一个 webapp，则可以使用用户的浏览器。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-01-27T14:16:48.203

解决此问题的一种方法是始终在数据库中使用时区感知字段。但是请注意，同一时间可以根据时区的不同来表示，即使这对计算机来说不是问题，但对我们来说非常不方便：

```
2003-04-12 23:05:06 +01:00
2003-04-13 00:05:06 +02:00 # This is the same time as above! 
```

此外，Postgresql 在内部以 UTC 存储所有时区感知日期和时间。在显示给客户端之前，它们会转换为 timezone 配置参数指定的区域中的本地时间。

**相反，我建议`UTC`在整个应用程序和数据库中的原始时区日期和时间都使用时间戳，并且仅在用户看到它们之前将它们转换为用户本地时区。**

这种策略让您拥有最干净的代码，避免任何时区转换和混淆，并使您的数据库和应用程序始终独立于“本地时区”差异而工作。例如，您的开发机器和生产服务器可能在不同时区的云上运行。

为此，请在初始化引擎之前告诉 Postgresql 您希望查看 UTC 时区。

在 SqlAlchemy 中，您可以这样做：

```
engine = create_engine(..., connect_args={"options": "-c timezone=utc"}) 
```

如果您使用的是 tornado-sqlalchemy，您可以使用：

```
factory = make_session_factory(..., connect_args={"options": "-c timezone=utc"}) 
```

由于我们在任何地方都使用所有 UTC 时区，因此我们只需在模型中使用 timezone-naive 日期和时间：

```
created_at = Column(DateTime, default=datetime.utcnow)
updated_at = Column(DateTime) 
```

如果您使用的是alembic，情况也是如此：

```
sa.Column('created_at', sa.DateTime()),
sa.Column('updated_at', sa.DateTime()), 
```

并在代码中使用 UTC 时间：

```
from datetime import datetime
...
model_object.updated_at = datetime.now(timezone.utc) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-06-23T15:32:58.633

建议使用以下结构将 UTC 日期和时间数据存储在数据库中，并防止没有此类位置信息的数据存储。

```
import datetime
from sqlalchemy import DateTime
from sqlalchemy.types import TypeDecorator

class TZDateTime(TypeDecorator):
    """
    A DateTime type which can only store tz-aware DateTimes.
    """
    impl = DateTime(timezone=True)

    def process_bind_param(self, value, dialect):
        if isinstance(value, datetime.datetime) and value.tzinfo is None:
            raise ValueError('{!r} must be TZ-aware'.format(value))
        return value

    def __repr__(self):
        return 'TZDateTime()' 
```

存储在数据库中的值应定义如下：

```
import datetime

import pytz

def tzware_datetime():
    """
    Return a timezone aware datetime.

    :return: Datetime
    """
    return datetime.datetime.now(pytz.utc) 
```

# php - 如何修复致命错误：无法重新声明仅在 Macintosh 上的类？

> ID：414954
> 
> 赞同：1
> 
> 时间：2009-01-05T23:46:27.067
> 
> 标签：php, macos, qcodo

只有当我在 Macintosh 上运行而不是在 Windows 浏览器上运行时，我才会收到这个致命错误，这没有意义，因为除了检查浏览器条件之外，条件循环运行相同的代码：

有人可以帮助我了解如何在 php 中停止此错误吗？错误发生在 QEnterKeyEvent 的第一个实例上......而不是第二个实例。这没有意义。

在代码中，第一个实例是第一次被调用，所以据我所知，该类尚未创建。

然而错误说：无法重新声明类 QEnterKeyEvent

```
// Key-Specific Events (EnterKey, EscapeKey, UpArrowKey, DownArrowKey, etc.)

if (QApplication::IsBrowser(QBrowserType::Macintosh)) {
    echo "keyspecific events - macintosh";

    class QEnterKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 13';
    }
    class QEscapeKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 27';
    }
    class QUpArrowKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 38';
    }
    class QDownArrowKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 40';
    }
} else {
    echo "key specific events - windows";

    class QEnterKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 13';
    }
    class QEscapeKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 27';
    }
    class QUpArrowKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 38';
    }
    class QDownArrowKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 40';
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T08:41:19.623

我看到这个代码示例来自 QCodo 代码库？在这种情况下，您可能应该通过他们的[“错误和问题”论坛报告问题。](http://www.qcodo.com/forums/forum.php/3)看了看那里，我看到已经有几个报告：[这个](http://www.qcodo.com/forums/topic.php/3506/1)和[这个](http://www.qcodo.com/forums/topic.php/3510/1)......

这是完整的代码块（来自 Qcodo 网站上的论坛帖子）：

```
// Key-Specific Events (EnterKey, EscapeKey, UpArrowKey, DownArrowKey, etc.)

if (QApplication::IsBrowser(QBrowserType::Macintosh)) {
    class QEnterKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 13';
    }
    class QEscapeKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 27';
    }
    class QUpArrowKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 38';
    }
    class QDownArrowKeyEvent extends QKeyPressEvent {
        protected $strCondition = 'event.keyCode == 40';
    }
} else {
    class QEnterKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 13';
    }
    class QEscapeKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 27';
    }
    class QUpArrowKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 38';
    }
    class QDownArrowKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 40';
    }
} 
```

所以在第二次阅读时，我认为问题不在于这段代码同时命中了两个类定义，而在于这段代码实际上被调用了两次。如果 Qcodo 被初始化两次，它看起来（从 Qcodo 的一瞥）会发生这种情况。

在 QApplicationBase::Initialize() 中有以下代码：

```
 // Preload Class Files
  foreach (QApplication::$PreloadedClassFile as $strClassFile)
      require($strClassFile); 
```

尝试用下面的代码替换它，看看问题是否解决？如果是这样，您可能在代码中的某处无意中初始化了 Qcodo 两次。

```
 // Preload Class Files
  foreach (QApplication::$PreloadedClassFile as $strClassFile)
      require_once($strClassFile); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:59:38.260

两个代码块都定义了同一个类：

```
class QEnterKeyEvent extends QKeyDownEvent {
            protected $strCondition = 'event.keyCode == 13';
} 
```

从您提供的示例代码中，完全在 if / else 语句之外定义该类更有意义，这将减少维护和解决错误的代码量。

但是，我怀疑您在阅读代码时可能不匹配大括号；从您粘贴的代码段中，不应该发生错误。

如果第二个类定义和第一个类定义一样发生（因为它们不是同一个条件的一部分），那么您可能会看到该错误。

如果您决定不重组代码以避免重复（您可能对当前结构有充分的理由，在您提供的代码段中未指明的结构），您可以使用 PHP 的[class_exists()](http://php.net/manual/en/function.class-exists.php)来避免尝试复制类定义：

```
} else {
  if ( !class_exists('QEnterKeyEvent') ) {
    class QEnterKeyEvent extends QKeyDownEvent {
      protected $strCondition = 'event.keyCode == 13';
    }
  }
} 
```

如果您确实使用了这种方法，那么仔细检查该类是否在所有情况下都按照您的预期定义是有意义的。

PS。此代码示例来自 QCodo 代码库吗？如果是这样，您可能应该通过他们的[“错误和问题”论坛报告该问题。](http://www.qcodo.com/forums/forum.php/3)

聚苯乙烯。哦，看。看到[这个](http://www.qcodo.com/forums/topic.php/3506/1)和[这个](http://www.qcodo.com/forums/topic.php/3510/1)...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-09T17:33:28.077

我在尝试为客户端安装 XSilva 的 Lightspeed Webstore 时遇到了同样的问题。经过一些挖掘和测试，我想我已经解决了这个问题。（仅供参考，只需将 'require' 更改为 'require_once' - 虽然是个好主意 - 对我不起作用。）我知道这是一个丑陋的 hack，但我用 class_exists() 检查包装了有问题的代码块，如下所示：

```
// Key-Specific Events (EnterKey, EscapeKey, UpArrowKey, DownArrowKey, etc.)
if (QApplication::IsBrowser(QBrowserType::Macintosh)) {
    if(!class_exists('QEnterKeyEvent') and !class_exists('QEscapeKeyEvent') and !class_exists('QUpArrowKeyEvent') and !class_exists('QDownArrowKeyEvent')) {
        class QEnterKeyEvent extends QKeyPressEvent {
            protected $strCondition = 'event.keyCode == 13';
        }   
        class QEscapeKeyEvent extends QKeyPressEvent {
            protected $strCondition = 'event.keyCode == 27';
        }   
        class QUpArrowKeyEvent extends QKeyPressEvent {
            protected $strCondition = 'event.keyCode == 38';
        }   
        class QDownArrowKeyEvent extends QKeyPressEvent {
            protected $strCondition = 'event.keyCode == 40';
        }   
    }   
} else {
    class QEnterKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 13';
    }   
    class QEscapeKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 27';
    }   
    class QUpArrowKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 38';
    }   
    class QDownArrowKeyEvent extends QKeyDownEvent {
        protected $strCondition = 'event.keyCode == 40';
    }   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-02T20:32:33.103

There's a community branch of QCodo called QCubed, and they appear to have a fix in QA right now. [http://trac.qcu.be/projects/qcubed/ticket/134](http://trac.qcu.be/projects/qcubed/ticket/134)

# .net - silverlight，如何实现 StoryBoard 类型的属性

> ID：414959
> 
> 赞同：1
> 
> 时间：2009-01-05T23:48:15.440
> 
> 标签：.net, silverlight

我有一个用户控件，我想创建一个故事板类型的属性，我可以在 xaml 中设置它，所以我尝试跟随，但是当我运行它时出现错误的属性错误：

```
private Storyboard sbTransitionIn_m;
public Storyboard TransitionIn
{
    get {return sbTransitionIn_m;}
    set {sbTransitionIn_m = value;}
} 
```

xml:

```
<MyStuff:MyUserControl x:Name="ctlTest" TransitionIn="sbShow"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T05:31:28.023

在 Resources 中定义故事板，然后将其称为 staticresource

```
<UserControl.Resources>
   <Storyboard x:Key="sbShow">
     <!--  -->
   </Storyboard>
</UserControl.Resources>

<MyStuff:MyUserControl x:Name="ctlTest" TransitionIn="{StaticResource sbShow}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T00:33:44.460

Storyboard 不能从这样的字符串属性序列化。试试这个：

```
<MyStuff:MyUserControl x:Name="ctlTest">
    <MyStuff:MyUserControl.TransitionIn>
        <Storyboard/>
    </MyStuff:MyUserControl.TransitionIn>
</MyStuff:MyUserControl> 
```

# javascript - 有没有办法确定何时使用 JS 加载了 4 张图像？

> ID：414976
> 
> 赞同：2
> 
> 时间：2009-01-05T23:57:27.030
> 
> 标签：javascript, jquery, image

我一页有 4 张图片。我想在所有 4 个图像都加载后触发一个 JS 事件。我当然不能确定图像将按哪个顺序加载，所以我无法在最后一张图像上触发事件。一个想法是有一个计数器，但我想不出检查该计数器何时等于 4 的最佳方法，因为我不喜欢每 200 毫秒检查一次 setTimeout() 的想法。

还有其他想法吗？

我在网站上使用 jQuery，所以我认为这可能会有所帮助。

这是图像的 HTML 代码：

```
<img src="/images/hp_image-1.jpg" width="553" height="180" id="featureImg1" />
<img src="/images/hp_image-2.jpg" width="553" height="180" id="featureImg2" />
<img src="/images/hp_image-3.jpg" width="553" height="180" id="featureImg3" />
<img src="/images/hp_image-4.jpg" width="553" height="180" id="featureImg4" /> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T00:05:35.577

至于[Salty 的例子](https://stackoverflow.com/a/414980/44084)，最好使用闭包来避免全局变量，例如：

```
$("img").load(function() {    
    var count = 0, numImages = $("img").size();

    return function () {
        if (++count === numImages) { 
            //All images have loaded    
        }
    };
}()); 
```

**[编辑]**

根据[jeroen 的评论](https://stackoverflow.com/users/42139/jeroen)，我将 4 () 的硬编码值替换为`count === 4`jQuery`size`函数，以便在函数中提供更大的灵活性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T00:00:06.587

```
count=0;
$("img").load(function() {
    count++;
    if(count==4) { //All images have loaded
        //Do something!
    }
}); 
```

# algorithm - 以各种组合添加值

> ID：414978
> 
> 赞同：1
> 
> 时间：2009-01-05T23:58:55.997
> 
> 标签：algorithm, optimization

不知道如何最好地解释它，除了使用一个例子......

想象一下，有一个客户有 10 张未结清的发票，有一天他们给你一张支票，但不告诉你是哪张发票。

返回可以产生所需总数的所有可能的值组合的最佳方法是什么？

* * *

我目前的想法是一种蛮力方法，它涉及使用一个运行所有可能性的自调用函数（[参见当前版本](http://www.craigfrancis.co.uk/features/code/phpAddition/)）。

例如，有 3 个数字，有 15 种方法可以将它们相加：

1.  一个
2.  甲+乙
3.  A + B + C
4.  A + C
5.  A + C + B
6.  乙
7.  乙+甲
8.  B + A + C
9.  B + C
10.  B + C + A
11.  C
12.  C + A
13.  C + A + B
14.  C + B
15.  C + B + A

其中，如果您删除重复项，则为您提供 7 种将它们添加在一起的独特方法：

1.  一个
2.  甲+乙
3.  A + B + C
4.  A + C
5.  乙
6.  B + C
7.  C

但是，在您拥有以下情况后，这种情况就会分崩离析：

*   15 个数字（32,767 种可能性/约 2 秒计算）
*   16 个数字（65,535 种可能性/约 6 秒计算）
*   17 个数字（131,071 种可能性/约 9 秒计算）
*   18 个数字（262,143 种可能性/约 20 秒计算）

在哪里，我希望这个函数处理至少 100 个数字。

那么，关于如何改进它的任何想法？（任何语言）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T01:15:56.450

这是[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)的一个很常见的变体，确实很难。链接页面上关于伪多项式时间动态规划解决方案的部分是您所追求的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T11:09:26.110

**这仅针对可能性的数量，不考虑重叠。我不确定你想要什么。**

考虑任何单个值可能同时存在的状态 - 它可以被包含或排除。那是两个不同的状态，因此所有 n 个项目的不同状态的数量将是 2^n。然而，有一种状态是不想要的；该状态是不包括任何数字的情况。

因此，对于任何 n 个数字，组合的数量等于 2^n-1。

```
def setNumbers(n): return 2**n-1

print(setNumbers(15)) 
```

这些发现与组合和排列密切相关。

* * *

不过，我认为您可能会在判断给定一组值之后，它们的任何组合是否总和为值 k。对于这个比尔，蜥蜴为你指明了正确的方向。

紧随其后，记住我还没有阅读整个 Wikipedia 文章，我在 Python 中提出了这个算法：

```
def combs(arr):
    r = set()

    for i in range(len(arr)):
        v = arr[i]
        new = set()

        new.add(v)
        for a in r: new.add(a+v)
        r |= new

    return r

def subsetSum(arr, val):
    middle = len(arr)//2

    seta = combs(arr[:middle])
    setb = combs(arr[middle:])

    for a in seta:
        if (val-a) in setb:
            return True

    return False

print(subsetSum([2, 3, 5, 8, 9], 8)) 
```

基本上该算法是这样工作的：

1.  将列表拆分为大约一半长度的 2 个列表。[上）]
2.  查找子集和的集合。[O(2 ^(n/2) n)]
3.  循环遍历第一组最多 2 个^(floor(n/2)) -1 个值，查看第二组中的另一个值是否总计为 k。[O(2 ^(n/2) n)]

所以我认为总体上它运行在 O(2 ^(n/2) n) - 仍然很慢但要好得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T00:04:13.427

听起来像是一个[装箱问题](http://en.wikipedia.org/wiki/Bin_packing_problem)。这些是 NP 完全的，即几乎不可能为大型问题集找到完美的解决方案。但是您可以使用启发式方法非常接近，即使它不是严格意义上的装箱问题，它也可能适用于您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T00:06:02.097

这是类似问题的变体。

但是你可以通过创建一个 n 位的计数器来解决这个问题。其中n是数字的数量。然后从 000 数到 111（n 个 1），对于每个数字，一个 1 相当于一个可用数字：

```
001 = A
010 = B
011 = A+B
100 = C
101 = A+C
110 = B+C
111 = A+B+C 
```

（但这不是问题，嗯，我把它作为目标）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T00:07:28.273

这不是严格意义上的装箱问题。这是价值的组合可能产生另一个价值。

它更像是变革问题，其中有一堆论文详细说明了如何解决它。谷歌在这里指出我：[http ://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.57.3243](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.57.3243)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T16:39:08.807

我不知道它在实践中多久会起作用，因为这种过于简单的情况有*很多*例外，但这里有一个想法：

在一个完美的世界中，发票将被支付到某个点。人们将支付 A、A+B 或 A+B+C，但不会支付 A+C——如果他们收到发票 C，那么他们已经收到发票 B。在完美世界中，问题不是要找到一个组合，而是要沿着一条直线找到一个点。

您可以按出具日期的顺序遍历未完成的发票，而不是强行强制发票总额的每个组合，并将每个发票金额添加到与目标数字进行比较的运行总计中。

回到现实世界，在开始繁重的数字运算或追逐它们之前，您可以做一个简单的快速检查。它获得的任何点击都是奖励:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-06T21:10:08.337

Here is an optimized Object-Oriented version of the exact integer solution to the Subset Sums problem(Horowitz, Sahni 1974). On my laptop (which is nothing special) this vb.net Class solves 1900 subset sums a second (for 20 items):

```
Option Explicit On

Public Class SubsetSum
    'Class to solve exact integer Subset Sum problems'
    ''
    ' 06-sep-09 RBarryYoung Created.'
    Dim Power2() As Integer = {1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32764}
    Public ForceMatch As Boolean
    Public watch As New Stopwatch
    Public w0 As Integer, w1 As Integer, w1a As Integer, w2 As Integer, w3 As Integer, w4 As Integer

    Public Function SolveMany(ByVal ItemCount As Integer, ByVal Range As Integer, ByVal Iterations As Integer) As Integer
        ' Solve many subset sum problems in sequence.'
        ''
        ' 06-sep-09 RBarryYoung Created.'
        Dim TotalFound As Integer
        Dim Items() As Integer
        ReDim Items(ItemCount - 1)

        'First create our list of selectable items:'
        Randomize()
        For item As Integer = 0 To Items.GetUpperBound(0)
            Items(item) = Rnd() * Range
        Next

        For iteration As Integer = 1 To Iterations
            Dim TargetSum As Integer
            If ForceMatch Then
                'Use a random value but make sure that it can be matched:'

                ' First, make a random bitmask to use:'
                Dim bits As Integer = Rnd() * (2 ^ (Items.GetUpperBound(0) + 1) - 1)

                ' Now enumerate the bits and match them to the Items:'
                Dim sum As Integer = 0
                For b As Integer = 0 To Items.GetUpperBound(0)
                    'build the sum from the corresponding items:'
                    If b < 16 Then
                        If Power2(b) = (bits And Power2(b)) Then
                            sum = sum + Items(b)
                        End If
                    Else
                        If Power2(b - 15) * Power2(15) = (bits And (Power2(b - 15) * Power2(15))) Then
                            sum = sum + Items(b)
                        End If
                    End If
                Next
                TargetSum = sum

            Else
                'Use a completely random Target Sum (low chance of matching): (Range / 2^ItemCount)'
                TargetSum = ((Rnd() * Range / 4) + Range * (3.0 / 8.0)) * ItemCount
            End If

            'Now see if there is a match'
            If SolveOne(TargetSum, ItemCount, Range, Items) Then TotalFound += 1
        Next

        Return TotalFound
    End Function

    Public Function SolveOne(ByVal TargetSum As Integer, ByVal ItemCount As Integer _
                            , ByVal Range As Integer, ByRef Items() As Integer) As Boolean
        ' Solve a single Subset Sum problem:  determine if the TargetSum can be made from'
        'the integer items.'

        'first split the items into two half-lists: [O(n)]'
        Dim H1() As Integer, H2() As Integer
        Dim hu1 As Integer, hu2 As Integer
        If ItemCount Mod 2 = 0 Then
            'even is easy:'
            hu1 = (ItemCount / 2) - 1 : hu2 = (ItemCount / 2) - 1
            ReDim H1((ItemCount / 2) - 1), H2((ItemCount / 2) - 1)
        Else
            'odd is a little harder, give the first half the extra item:'
            hu1 = ((ItemCount + 1) / 2) - 1 : hu2 = ((ItemCount - 1) / 2) - 1
            ReDim H1(hu1), H2(hu2)
        End If

        For i As Integer = 0 To ItemCount - 1 Step 2
            H1(i / 2) = Items(i)
            'make sure that H2 doesnt run over on the last item of an odd-numbered list:'
            If (i + 1) <= ItemCount - 1 Then
                H2(i / 2) = Items(i + 1)
            End If
        Next

        'Now generate all of the sums for each half-list:   [O( 2^(n/2) * n )]  **(this is the slowest step)'
        Dim S1() As Integer, S2() As Integer
        Dim sum1 As Integer, sum2 As Integer
        Dim su1 As Integer = 2 ^ (hu1 + 1) - 1, su2 As Integer = 2 ^ (hu2 + 1) - 1
        ReDim S1(su1), S2(su2)

        For i As Integer = 0 To su1
            ' Use the binary bitmask of our enumerator(i) to select items to use in our candidate sums:'
            sum1 = 0 : sum2 = 0
            For b As Integer = 0 To hu1
                If 0 < (i And Power2(b)) Then
                    sum1 += H1(b)
                    If i <= su2 Then sum2 += H2(b)
                End If
            Next
            S1(i) = sum1
            If i <= su2 Then S2(i) = sum2
        Next

        'Sort both lists:   [O( 2^(n/2) * n )]  **(this is the 2nd slowest step)'
        Array.Sort(S1)
        Array.Sort(S2)

        ' Start the first half-sums from lowest to highest,'
        'and the second half sums from highest to lowest.'
        Dim i1 As Integer = 0, i2 As Integer = su2

        ' Now do a merge-match on the lists (but reversing S2) and looking to '
        'match their sum to the target sum:     [O( 2^(n/2) )]'
        Dim sum As Integer
        Do While i1 <= su1 And i2 >= 0
            sum = S1(i1) + S2(i2)
            If sum < TargetSum Then
                'if the Sum is too low, then we need to increase the ascending side (S1):'
                i1 += 1
            ElseIf sum > TargetSum Then
                'if the Sum is too high, then we need to decrease the descending side (S2):'
                i2 -= 1
            Else
                'Sums match:'
                Return True
            End If
        Loop

        'if we got here, then there are no matches to the TargetSum'
        Return False
    End Function

End Class 
```

Here is the Forms code to go along with it:

```
Public Class frmSubsetSum

    Dim ssm As New SubsetSum

    Private Sub btnGo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGo.Click
        Dim Total As Integer
        Dim datStart As Date, datEnd As Date
        Dim Iterations As Integer, Range As Integer, NumberCount As Integer

        Iterations = CInt(txtIterations.Text)
        Range = CInt(txtRange.Text)
        NumberCount = CInt(txtNumberCount.Text)

        ssm.ForceMatch = chkForceMatch.Checked

        datStart = Now

        Total = ssm.SolveMany(NumberCount, Range, Iterations)

        datEnd = Now()

        lblStart.Text = datStart.TimeOfDay.ToString
        lblEnd.Text = datEnd.TimeOfDay.ToString
        lblRate.Text = Format(Iterations / (datEnd - datStart).TotalMilliseconds * 1000, "####0.0")

        ListBox1.Items.Insert(0, "Found " & Total.ToString & " Matches out of " & Iterations.ToString & " tries.")
        ListBox1.Items.Insert(1, "Tics 0:" & ssm.w0 _
                                & " 1:" & Format(ssm.w1 - ssm.w0, "###,###,##0") _
                                & " 1a:" & Format(ssm.w1a - ssm.w1, "###,###,##0") _
                                & " 2:" & Format(ssm.w2 - ssm.w1a, "###,###,##0") _
                                & " 3:" & Format(ssm.w3 - ssm.w2, "###,###,##0") _
                                & " 4:" & Format(ssm.w4 - ssm.w3, "###,###,##0") _
                                & ", tics/sec = " & Stopwatch.Frequency)
    End Sub
End Class 
```

Let me know if you have any questions.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-26T14:05:46.263

作为记录，这里有一些相当简单的 Java 代码，它使用递归来解决这个问题。它针对简单性而不是性能进行了优化，尽管有 100 个元素它似乎相当快。使用 1000 个元素需要更长的时间，因此如果您要处理大量数据，您最好使用更复杂的算法。

```
public static List<Double> getMatchingAmounts(Double goal, List<Double> amounts) {
    List<Double> remaining = new ArrayList<Double>(amounts);

    for (final Double amount : amounts) {
        if (amount > goal) {
            continue;
        } else if (amount.equals(goal)) {
            return new ArrayList<Double>(){{ add(amount); }};
        }

        remaining.remove(amount);

        List<Double> matchingAmounts = getMatchingAmounts(goal - amount, remaining);
        if (matchingAmounts != null) {
            matchingAmounts.add(amount);
            return matchingAmounts;
        }
    }

    return null;
} 
```

# c# - 直接修改List 元素

> ID：414981
> 
> 赞同：36
> 
> 时间：2009-01-06T00:00:53.217
> 
> 标签：c#, .net

我有这个结构：

```
struct Map
{
    public int Size;

    public Map ( int size )
    {
        this.Size = size;
    }

    public override string ToString ( )
    {
        return String.Format ( "Size: {0}", this.Size );
    }
} 
```

使用数组时，它可以工作：

```
Map [ ] arr = new Map [ 4 ] {
    new Map(10),
    new Map(20),
    new Map(30),
    new Map(40)};

arr [ 2 ].Size = 0; 
```

但是当使用 List 时，它不会编译：

```
List<Map> list = new List<Map> ( ) {
    new Map(10),
    new Map(20),
    new Map(30),
    new Map(40)};

list [ 2 ].Size = 0; 
```

为什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-06T00:05:41.943

C# 编译器会给你以下错误：

> 无法修改“System.Collections.Generic.List.this[int]”的返回值，因为它不是变量

原因是结构是值类型，因此当您访问列表元素时，您实际上将访问列表索引器返回的元素的中间副本。

来自[MSDN](http://msdn.microsoft.com/en-us/library/wydkhw2c(VS.71).aspx)：

> **错误信息**
> 
> 无法修改“表达式”的返回值，因为它不是变量
> 
> 尝试修改作为中间表达式结果的值类型。因为该值没有被持久化，所以该值将保持不变。
> 
> 要解决此错误，请将表达式的结果存储在中间值中，或对中间表达式使用引用类型。

解决方案：

1.  使用数组。这使您可以直接访问元素（您没有访问副本）
2.  当您使 Map 成为一个类时，您仍然可以使用 List 来存储您的元素。然后，您将获得对 Map 对象的引用而不是中间副本，并且您将能够修改该对象。
3.  如果您无法将 Map 从 struct 更改为 class，则必须将列表项保存在临时变量中：

```
List<Map> list = new List<Map>() { 
    new Map(10), 
    new Map(20), 
    new Map(30), 
    new Map(40)
};

Map map = list[2];
map.Size = 42;
list[2] = map; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-06T00:06:05.373

因为它是`struct`，所以在使用 List<T> 时，您正在创建副本。

使用结构时，最好使它们不可变。这将避免这样的影响。

使用数组时，您可以直接访问内存结构。使用 List<T>.get_Item 您可以处理返回值，即结构的副本。

如果它是一个类，您将获得指向该类的指针的副本，但您不会注意到这一点，因为指针隐藏在 C# 中。

也使用 List<T>.ToArray 不能解决它，因为它会创建内部数组的副本，并返回它。

这并不是使用结构体时唯一会获得这种效果的地方。

Divo 提供的解决方案是一个非常好的解决方法。但是您必须记住以这种方式工作，不仅在使用 List<T> 时，而且在任何您想要更改结构内的字段的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T13:39:45.450

我不是 XNA 开发人员，所以我无法评论为 XNA 使用结构与类的要求有多严格。但这似乎是一个更自然的地方，可以使用一个类来获得您正在寻找的 pass-by-ref 语义。

我的一个想法是你可以使用拳击。通过在您的情况下创建一个接口，例如“IMap”，由您的“Map”结构植入，然后使用 a `List<IMap>`，列表将保存 System.Object 对象，这些对象通过引用传递。例如：

```
interface IMap
{
    int Size { get; set; }
}

struct Map: IMap
{
    public Map(int size)
    {
        _size = size;
    }

    private int _size;

    public int Size
    {
        get { return _size; }
        set { _size = value; }
    }

    public override string ToString()
    {
        return String.Format("Size: {0}", this.Size);
    }

} 
```

然后可以通过以下方式调用：

```
List<IMap> list = new List<IMap>() { 
    new Map(10), 
    new Map(20), 
    new Map(30), 
    new Map(40)};

    list[2].Size = 4;
    Console.WriteLine("list[2].Size = " + list[2].Size.ToString()); 
```

请注意，这些结构在首先传递到列表时只会被装箱一次，而不是在使用诸如'list [2].Size = 4'之类的代码调用时，所以它应该是相当有效的，除非你正在采取这些 IMap 对象并`List<IMap>`在代码的其他部分中转换回 Map（将其复制出）。

尽管这将实现您对 List<> 中的结构进行直接读写访问的目标，但将结构装箱实际上是将结构填充到一个类（System.Object）中，因此我认为它可能会使首先让你的“地图”成为一个班级更有意义？

麦克风

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-30T06:02:33.730

在尝试计算 XNA 中顶点缓冲区的法线时，我不断回到这个问题。

我想出的最好的 XNA 解决方案是将数据复制（或存储）到一个数组中。

```
private void SomeFunction()
{
    List<VertexBasicTerrain> vertexList = GenerateVertices();
    short[] indexArray = GenerateIndices();

    CalculateNormals(vertexList, ref indexArray); // Will not work

    var vertexArray = vertexList.ToArray();
    CalculateNormals(ref vertexArray, ref indexArray);
}

// This works (algorithm from Reimers.net)
private void CalculateNormals(ref VertexBasicTerrain[] vertices, ref short[] indices)
{
    for (int i = 0; i < vertices.Length; i++)
        vertices[i].Normal = new Vector3(0, 0, 0);

    for (int i = 0; i < indices.Length / 3; i++)
    {
        Vector3 firstvec = vertices[indices[i * 3 + 1]].Position - vertices[indices[i * 3]].Position;
        Vector3 secondvec = vertices[indices[i * 3]].Position - vertices[indices[i * 3 + 2]].Position;
        Vector3 normal = Vector3.Cross(firstvec, secondvec);
        normal.Normalize();
        vertices[indices[i * 3]].Normal += normal;
        vertices[indices[i * 3 + 1]].Normal += normal;
        vertices[indices[i * 3 + 2]].Normal += normal;
    }
    for (int i = 0; i < vertices.Length; i++)
        vertices[i].Normal.Normalize();
}

// This does NOT work and throws a compiler error because of the List<T>
private void CalculateNormals(List<VertexBasicTerrain> vertices, ref short[] indices)
{
    for (int i = 0; i < vertices.Length; i++)
        vertices[i].Normal = new Vector3(0, 0, 0);

    for (int i = 0; i < indices.Length / 3; i++)
    {
        Vector3 firstvec = vertices[indices[i * 3 + 1]].Position - vertices[indices[i * 3]].Position;
        Vector3 secondvec = vertices[indices[i * 3]].Position - vertices[indices[i * 3 + 2]].Position;
        Vector3 normal = Vector3.Cross(firstvec, secondvec);
        normal.Normalize();
        vertices[indices[i * 3]].Normal += normal;
        vertices[indices[i * 3 + 1]].Normal += normal;
        vertices[indices[i * 3 + 2]].Normal += normal;
    }
    for (int i = 0; i < vertices.Length; i++)
        vertices[i].Normal.Normalize();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T00:57:56.330

```
list [ 2 ].Size = 0; 
```

实际上是：

```
//Copy of object
Map map = list[2];
map.Size = 2; 
```

`class`代替`struct`. _

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T16:11:47.763

我决定直接替换副本上的结果并重新分配结果，例如：

```
Map map = arr [ 2 ];
map.Size = 0;
arr [ 2 ] = map; 
```

# asp.net - 如何阻止 .NET 使用 XML.Serialization 对 XML 字符串进行编码

> ID：414982
> 
> 赞同：3
> 
> 时间：2009-01-06T00:01:23.120
> 
> 标签：asp.net, xml, web-services, serialization

我正在使用 Web 服务中的 ASP.NET 2.0 中的一些 Xml 序列化。问题是我有一个定义如下的元素：

```
<System.Xml.Serialization.XmlElementAttribute(Form:=System.Xml.Schema.XmlSchemaForm.Unqualified, IsNullable:=True)> _
Public Property COMMENTFIELD() As String
    Get
        Return CommentField ' This is a string
    End Get
    Set(ByVal value as String)
        CommentField = value
    End Set
End Property 
```

在代码的其他地方，我正在构建一个注释并在每个“注释”之间附加一个换行符（根据我们提交的 Web 服务的规则），如下所示：（请记住，这是一个有效的 XML 实体表示字符 10（我相信换行）。

```
XmlObject.COMMENTFIELD = sComment1 & "&#xA;" & sComment2 
```

问题是 .NET 试图帮我们一个忙，并在注释字符串中对 & 进行编码，最终发送目标 Web 服务 this: `&amp;#xA;`，这显然不是我们想要的。

以下是目前发生的情况：

```
XmlObject.COMMENTFIELD = sComment1 & "&#xA;" & sComment2 
```

输出：

```
<COMMENTFIELD>comment1 &amp;#xA comment2</COMMENTFIELD> 
```

我需要的输出：

```
<COMMENTFIELD>comment1 &#xA; comment2</COMMENTFIELD> 
```

**问题是：**我如何强制 .NET 运行时不要尝试对我已经知道符合 XML 并且已经转义的数据进行编码（顺便说一句 sComment1 和 sComment2 已经被转义）。我习惯于处理我的 XML，而不是依赖于某种神奇的东西来逃避我背后的所有数据！

我需要能够将有效的 XML 传递到 COMMENTFIELD 属性，而无需对我提供的数据进行 .NET 编码（因为它已经是 XML）。我需要知道如何告诉 .NET 它接收的数据是 XML 字符串，而不是需要转义的普通字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T02:13:25.583

如果您查看[XML 规范](http://www.w3.org/TR/REC-xml/)第 2.4 节，您会看到元素文本中的 & 字符始终用于指示转义的内容，因此如果您想发送 & 字符，则需要对其进行转义，例如 & 所以 .Net正在将您提供的文字字符串转换为有效的 XML。

如果您真的希望 Web 服务接收文字文本 &，那么 .NET 正在做正确的事情。当 Web 服务处理 XML 时，它会将其转换回您最终提供的相同文字字符串。

另一方面，如果你想向远程 Web 服务发送一个带有换行符的字符串，你应该只用换行符构造字符串：

XmlObject.COMMENTFIELD = sComment1 & "\n" & sComment2

.Net 将做正确的事情以确保在网络上正确传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:23:39.970

在同一个字符串中混合两种不同的编码约定可能很危险。由于您有自己的约定，我建议在准备发送时显式编码整个字符串并在接收端显式解码它。

尝试[HttpServerUtility.HtmlEncode](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmlencode.aspx)方法 (System.Web) 。

+汤姆

# c# - 从 Grouping Linq Query 生成字符串

> ID：414984
> 
> 赞同：2
> 
> 时间：2009-01-06T00:03:48.980
> 
> 标签：c#, linq, string

给定以下代码：

```
var people = new List<person>(){ new person { Name = "John", FamilyName = "Pendray" },
             new person { FamilyName = "Emery", Name = "Jake"},
             new person { FamilyName = "Pendray", Name = "Richard" } };

var q = from p in people
                 orderby p.Name
                 group p by p.FamilyName into fam
                 orderby fam.Key
                 select new { fam.Key, members = from p in fam select p }; 
```

是否可以将最后一行替换为将输出`<string`包含以下两个字符串的 IEnumerable > 的选择：“Pendray John Richard”“Emery Jake”？是否可以将 linq 查询投影到这样的字符串中？

编辑：我知道这可以通过进一步的代码实现，但我感兴趣的是这是否可以从 linq 查询本身以类似于 VB 能够从[http://www 中的查询中投影 xml 的方式完成。 thinqlinq.com/default/Projecting-XML-from-LINQ-to-SQL.aspx](http://www.thinqlinq.com/default/Projecting-XML-from-LINQ-to-SQL.aspx)（尤其是本页的最后一个代码块）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T04:06:59.600

```
var q = from p in people
        orderby p.Name
        group p by p.FamilyName into fam
        orderby fam.Key
        select fam.Key + " " + string.Join(" ", (from fm in fam select fm.Name).ToArray()); 
```

退货

`Emery Jake`
`Pendray John Richard`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T01:43:51.870

确实。

您将不得不更改选择部分。最简单的方法是定义一个函数，该函数将采用 IEnumerable 并生成该字符串，然后调用该函数

```
people = new List<person>(){ new person { Name = "John", FamilyName = "Pendray" },
         new person { FamilyName = "Emery", Name = "Jake"},
         new person { FamilyName = "Pendray", Name = "Richard" } };

var q = from p in people
        orderby p.Name
        group p by p.FamilyName into fam
        orderby fam.Key
        select new { Key = fam.Key, Text = GetText(fam) };

// and elsewhere...
private string GetText(IEnumerable<person> family) {
    string result = "Whatever"; // build the result string here
    return result;
} 
```

此外，如果您只想要文本，您可以将查询的最后一行更改为简单

```
 select GetText(fam); 
```

# c# - 退出预处理器块时整数值更改

> ID：414986
> 
> 赞同：1
> 
> 时间：2009-01-06T00:04:04.737
> 
> 标签：c#, c-preprocessor, variable-assignment

我有一段代码，其中似乎变量在预处理器代码块的末尾发生了变化。

```
int initialKeyCount;
#if(DEBUG)
//          int initialKeyCount = _root.CountAllKeys();
      initialKeyCount = 20000;
#endif
      currNode = currNode.EnsureDegreeKeysPresent(parent); //initialKeyCount = 19969 here
#if(DEBUG)
      int currentKeyCount = _root.CountAllKeys();
      Debug.Assert(initialKeyCount == currentKeyCount,
               string.Format("EnsureDegreeNodesPresent changed the node count from {0} to {1}.", initialKeyCount, currentKeyCount));
#endif 
```

在应该分配 20000 之后在调试器中执行此操作时，initialKeyCount = 19969。我已经玩了一点，发现在第一个预处理器块内分配给 initialKeyCount 是正确的，但是一旦代码离开第一个预处理器阻止值神奇地更改为 19969。

无论变量是在第一个预处理器块内部还是外部声明，此行为都是相同的。该值在第二个预处理器块内保持为 19969。

预处理器块中的分配是否在该块之外未定义？这似乎是错误的，但似乎就是这里发生的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T00:18:36.220

这种行为听起来很像调试器正在运行的代码与您正在编辑的源代码不匹配。您是否绝对确定您的源代码更改一直到您正在运行的代码？

预处理器块与语言语法无关。因此，您说预处理器块不会影响变量定义的范围是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T00:25:08.767

我同意 Greg Hewgill 的观点——我以前见过这种事情。

此外，找到调试器正在使用的程序集并使用 Reflector 打开它。反汇编应该让您更好地了解实际发生的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T00:29:53.623

当遇到这样的事情时，请从装配级别来看。

虽然汇编是你现在几乎永远不会编码的东西，但*需要*知道它才能追查这样的谜团。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T01:40:29.847

事情变得越来越陌生。我接受了上述建议，并使用 Reflector 和调试器提供的反汇编检查了代码，两者看起来都如您所愿。我稍微修改了代码以清楚地显示变量中的“神奇”变化。

新代码是

```
int initialKeyCount;
#if(DEBUG)
//          int initialKeyCount = _root.CountAllKeys();
      initialKeyCount = 20000;
      initialKeyCount++;
      initialKeyCount = initialKeyCount;
#endif
      currNode = currNode.EnsureDegreeKeysPresent(parent);
#if(DEBUG)
      int currentKeyCount = _root.CountAllKeys();
      Debug.Assert(initialKeyCount == currentKeyCount,
               string.Format("EnsureDegreeNodesPresent changed the node count from {0} to {1}.", initialKeyCount, currentKeyCount));
#endif 
```

上面的拆解是

```
int initialKeyCount;
#if(DEBUG)
//          int initialKeyCount = _root.CountAllKeys();
      initialKeyCount = 20000;
00000094  mov         dword ptr [ebp-50h],4E20h 
      initialKeyCount++;
0000009b  inc         dword ptr [ebp-50h] 
      initialKeyCount = initialKeyCount;
0000009e  nop              
#endif
      currNode = currNode.EnsureDegreeKeysPresent(parent);
0000009f  mov         edx,dword ptr [ebp-48h] 
... 
```

使用内存窗口我观察了 ebp-0x50 当 IP 为

在 00000094 处的值为 0x0
在 0000009b 处的值为 0x4e20
在 0000009e 处的值为 0x4e21
在 0000009f 处的值为 0x4e01

我承认自从我编写任何汇编代码以来已经很久了，但我非常有信心 nop 不应该写入内存。:)

显然，一些代码正在执行，但调试器没有显示。有谁知道我是如何使用导致这种情况的预处理器的，或者这只是一个错误？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T02:48:31.083

听起来 Visual Studio 很困惑。按顺序尝试这些步骤

1.  使用清理命令
2.  重新启动 Visual Studio
3.  删除所有看起来像你的程序的 DLL 和 EXE
4.  仔细检查每个 BIN 和 OBJ 文件夹，看看是否遗漏了任何内容。
5.  在您的整个硬盘驱动器中搜索任何看起来像您的程序的 DLL 和 EXE，并将它们也删除

我曾经在我工作的一家 IT 公司每周看到一次。当您拥有同一个项目的多个副本时，通常会发生这种情况，但即使没有这个，我也见过。*********