# StackOverflow 问答 11347000-11347999

# visual-studio - 如何在 .vsprops 文件中指定相对路径

> ID：11347000
> 
> 赞同：4
> 
> 时间：2012-07-05T14:57:27.253
> 
> 标签：visual-studio, visual-studio-2008

有没有办法在 .vsprops 文件中指定相对于 .vsprops 文件目录的路径？

例如，我有以下目录结构：

```
largesolution.sln
a/a.vcproj
b/c/c.vcproj
common/common.vsprops 
```

`a.vcproj`和`c.vcproj`include `common.vsprops`，我想添加一些宏或设置相对于文件夹的包含目录，无论`common`两个项目都包含在解决方案目录中。我试过`$(InputDir)`在 .vsprops 文件中使用，但似乎这个宏被扩展为包含 .vcproj 的目录，而不是 .vsprops 文件。

在 Visual C++ 目录中设置绝对路径或设置全局包含路径不是解决方案，因为不同的开发人员有不同的源树根位置。设置相对于的路径`$(SolutionDir)`不适合，因为在主源树之外的某处包含一些子集 ob 项目（例如，仅 a.vcproj）的较小解决方案很有用。

当然，将包含目录设置`a.vcproj`为`$(ProjectDir)..\common`工作正常，但要实现的结果仅包括 .vsprops 并正确设置路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T06:58:09.113

您可以使用 MSBuildThisFileDirectory 宏。例如：您在 common.props 中将 Include Directories 设置为“$(MSBuildThisFileDirectory)\include;$(IncludePath)”。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/vstudio/ms164309.aspx](http://msdn.microsoft.com/en-us/library/vstudio/ms164309.aspx)。

使用 MSVS2012 和 MSVS2013 测试。

# android - 我能知道 X dp 宽度的 TextView 可以容纳多少个字符吗？

> ID：11347007
> 
> 赞同：7
> 
> 时间：2012-07-05T14:57:42.593
> 
> 标签：android, textview

有没有办法知道有多少字体大小为 10sp 的字符可以放入固定宽度的 TextView（比如说 100dp）？

我需要跟踪整个字符串是否适合（可见）到预定义宽度的 TextView 中。

我一直无法找到一种方法来跟踪或计算这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T15:16:47.840

由于 Android 使用[比例字体](http://pc.net/helpcenter/answers/fixed_fonts_vs_proportional_fonts)，每个字符占据不同的宽度。此外，如果您考虑[字距调整](http://en.wikipedia.org/wiki/Kerning)，则字符串的宽度可能比单个字符的宽度之和短。

因此，最简单的方法是通过一次添加一个字符来测量整个字符串，直到 (a) 如果发现整个字符串符合限制，或者 (b) 字符串的宽度超过限制。

下面的代码展示了如何找出多少个大小为 11px 的字符适合 100px 宽的 TextView。（您可以在 Web 上找到在 px 和 dp 之间转换的公式）。

我们将通过[`measureText(String text, int start, int end)`](http://developer.android.com/reference/android/graphics/Paint.html#measureText%28java.lang.String,%20int,%20int%29)在循环中使用递增的值来完成它，`end`直到它不再适合`TextView`' 的宽度。

```
String text = "This is my string";
int textViewWidth = 100;
int numChars;

Paint paint = textView.getPaint();
for (numChars = 1; numChars <= text.length; ++numChars) {
    if (paint.measureText(text, 0, numChars) > textViewWidth) {
        break;
    }
}

Log.d("tag", "Number of characters that fit = " + (numChars - 1)); 
```

如果性能较差，您可以尝试使用二分搜索方法而不是线性循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:00:53.700

确定这一点的最佳方法就是对其进行测试。由于您使用的是 DP，它将相对独立于设备。除非您使用的是固定宽度的字体，否则实际上没有办法在理论上确定它，除非您想实际尝试测量每个字母的宽度、字距调整等并与 TextView 的宽度进行比较

# php - 当隐私选项设置为中等及以上时，无法登录 IE。

> ID：11347008
> 
> 赞同：0
> 
> 时间：2012-07-05T14:57:43.507
> 
> 标签：php, internet-explorer, session

我已经完成了一个登录表单，其中变量通过会话传递。它在 Mozilla 中运行良好，但在 Internet Explorer (IE) 的情况下，当隐私选项设置为中等及以上时，登录将无法正常工作。

我通过传递他们的用户名和管理员用户通过传递他们的用户类型来维护普通用户的会话。如果没有人登录，那么他们可以看到没有为登录用户提供的设施的网页。

所以我陷入了必须维护会话变量以区分用户的情况，没有它我无法重定向。

现在，对于启用了中等或以上隐私的 IE 用户，会话变量无法传递，因此他们将无法登录，我什至无法将他们重定向到另一个页面，这会要求他们降低隐私政策让他们登录，因为如果没有维护会话，我就是我的代码，那么必须显示一个正常的页面。

PHP 中是否有任何方法可以要求用户降低 Internet Explorer 中的隐私选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:05:00.523

尝试让用户在每次需要时都访问数据库。只需保留一个带有会话 ID 的会话变量，并将其分配给数据库中的用户。这样，您不必维护或通过每个网站部分的用户。

# java - 防止 JAR 被导入 Eclipse Java 项目

> ID：11347011
> 
> 赞同：0
> 
> 时间：2012-07-05T14:57:53.447
> 
> 标签：java, eclipse

我有一个 Java 项目，它被各种其他 Java 和 Android 项目大量使用。该项目包含一些 JAR 库，所有项目都应使用这些 JAR 库，但 Android 除外（实际上，Android 项目准确地说是一个 Android 库项目）。

我在 Java 项目的 Eclipse 构建路径首选项中将 JAR 标记为“导出”。但是，Android 项目不应该导入这些库（因为它们是 Java 库，它使用了一些在 Android 上不可用的类），但它应该导入其余代码（实际上并不使用这些库，但出于方便的原因，它们存储在那里并确保所有其他项目使用相同的库。

如何防止 JAR 被导出到 Android 项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:27:15.333

您可以阻止导出所有 jar，以便只有公共项目是每个需要它的项目的依赖项。

然后，您可以通过构建属性中的添加 jar.. 对话框将每个项目的构建路径更改为仅包含其必要的 jar。

这是最简单的方法。

更极端的方法是迁移到 maven，然后 eclipse 将只包含您在 pom 中指定的 jar - 尽管这是一项额外的工作，但收益不大。

或者，您可以将 android 特定代码拆分为一个 android-common 单独的项目，然后让您的 common 项目依赖它并导出它 - 然后您的 android 项目可以依赖这个 android-common 项目而不是现有的 common 项目。

# php - PHP获取进程创建时间？

> ID：11347015
> 
> 赞同：0
> 
> 时间：2012-07-05T14:57:59.190
> 
> 标签：php, process, count, win32com

我有一个（示例）php代码如下：

```
$name_Proc = "chrome.exe";
$wmi = new COM('winmgmts://'); 
$processes = $wmi->ExecQuery("SELECT * FROM Win32_Process WHERE Name ='".$name_Proc."'"); 
```

我用它来计算以下代码的过程，

```
 $array = array();
foreach($processes as $process){ 
         array_push($array,$process->ProcessId);
}
$count_Process = count($array);
return $count_Process; 
```

现在，真正的事情，我现在需要进程创建时间，可以使用带有以下代码的 VBScript：

```
 strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

Set colProcessList = objWMIService.ExecQuery _
    ("Select * from Win32_Process Where Name = 'notepad.exe'")

For Each objProcess in colProcessList
    Wscript.Echo objProcess.CreationDate
Next 
```

现在，如果我想知道如何在我的 PHP 脚本中实现它！

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:02:00.017

好的，对不起大家，刚刚看了，现在明白了！我想到了。这是代码，希望它可以帮助将来的人:)

```
foreach ($processes as $process) {
print $process->CreationDate;
} 
```

使用了这段代码，完整代码如下：

```
function processMade($pid) {
$name_Proc = "9052";
$wmi = new COM('winmgmts://'); 
$processes = $wmi->ExecQuery("SELECT * FROM Win32_Process WHERE ProcessId ='".$name_Proc."'"); 
$array = array();
foreach ($processes as $process) {
array_push($array,print $process->CreationDate);
}
return $array;
} 
```

或者干脆使用这个：

```
 $name_Proc = "9052"; //this is the PID, if you want it by name than change the ProcessId = '".$name_Proc."'" in the 4th line.
    $wmi = new COM('winmgmts://'); 
    $processes = $wmi->ExecQuery("SELECT * FROM Win32_Process WHERE ProcessId ='".$name_Proc."'"); 
    $array = array();
    foreach ($processes as $process) {
    array_push($array,print $process->CreationDate);
    } 
```

最好的，

阿山

# objective-c - 通过 segues 传递数据

> ID：11347021
> 
> 赞同：0
> 
> 时间：2012-07-05T14:58:07.457
> 
> 标签：objective-c, ios, cocoa-touch

我正在尝试使用一个 Web 视图并使用三个不同的按钮将您带到此 Web 视图。每个人都会将您带到不同的网站。我创建了一个新的 webview 类，在这个类中我有一个方法来设置它将去哪个 url。

在原始视图控制器中，我尝试向此方法发送不同的数字，但它说没有已知的实例方法。

代码如下：

设置网址的方法

```
-(void)setUrlNo:(int)urlNo
{

    if (urlNo == 0) {

        url = @"http://www.twitter.com/ac3112";
    } else if (urlNo == 1) {
        url = @"http://www.facebook.com/ac3112";
    } else if (urlNo == 2) {
        url = @"http://www.adamcarlin.co.uk";

    }
} 
```

准备segue方法

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"Twitter"])
    {
        [segue.destinationViewController setUrlNo:1];

    }else if ([segue.identifier isEqualToString:@"FB"]) {
        [segue.destinationViewController setUrlNo:2];
    } else {
        [segue.destinationViewController setUrlNo:3];
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:04:52.760

`segue.destinationViewController`返回一个类型的对象`id`。您需要将其转换为您的视图控制器类型以在没有警告的情况下发送消息：

```
[(YourViewController *)segue.destinationViewController setUrlNo:1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T09:46:19.163

要打开不同的网站并通过 segue 发送 url，您可以使用基于主视图控制器的此方法。您从每个表格单元格或按钮创建一个 push segue 并拖动到 UIViewController，然后将下面的 segue 值放在那里以确保您获得正确的站点/值。

FollowViewController.h

```
@interface FollowViewController : UIViewController

@end 
```

FollowViewController.m segue 方法

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
     FollowDetailViewController *webController = [[FollowDetailViewController alloc] init];

    if ([[segue identifier] isEqualToString:@"Facebook"]) { // Facebook
    NSString *urlstr=@"https://www.facebook.com/";
    webController = [segue destinationViewController];
    webController.urlstr = urlstr;
    webController.title = @"Facebook"; // this sets the title of the next page

    }
    else if ([[segue identifier] isEqualToString:@"Instagram"]) { // Instagram
    NSString *urlstr=@"http://instagram.com/";
    webController = [segue destinationViewController];
    webController.urlstr = urlstr;
    webController.title = @"Instagram"; // this sets the title of the next page
    }
    else if ([[segue identifier] isEqualToString:@"Twitter"]) { // Twitter
    NSString *urlstr=@"https://twitter.com/";
    webController = [segue destinationViewController];
    webController.urlstr = urlstr;
    webController.title = @"Twitter"; // this sets the title of the next page
    }
    else if ([[segue identifier] isEqualToString:@"YouTube"]) { // YouTube
    NSString *urlstr=@"http://www.youtube.com/";
    webController = [segue destinationViewController];
    webController.urlstr = urlstr;
    webController.title = @"YouTube"; // this sets the title of the next page
    }
    self.title = @"Follow"; // This sets the title of the back button, and the title of this page
} 
```

FollowDetailViewController.h

```
@interface FollowDetailViewController : UIViewController {
    NSString *urlstr;
}

@property (strong, nonatomic) IBOutlet UIWebView *WebView;
@property (strong, nonatomic) NSString *urlstr;

@end 
```

FollowDetailViewController.m

```
@implementation FollowDetailViewController

@synthesize WebView;
@synthesize urlstr;

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURL *url = [NSURL URLWithString:urlstr];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [self.WebView loadRequest:requestObj];
}

@end 
```

祝你好运！

# xml - 解析 Google 搜索结果

> ID：11347025
> 
> 赞同：2
> 
> 时间：2012-07-05T14:58:39.050
> 
> 标签：xml, json, parsing, search

有什么方法可以解析 Google 搜索的结果或在 XML 或 JSON 上检索它们？我尝试使用 Google 的 API，但没有找到解决方案！提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:03:55.640

Google 的官方 API 是 Google Custom Search。[在此处](https://developers.google.com/custom-search/v1/overview)查找更多详细信息

# testing - Linux设备驱动功能测试

> ID：11347027
> 
> 赞同：2
> 
> 时间：2012-07-05T14:58:41.590
> 
> 标签：testing, linux-device-driver, functional-testing

对于 linux 内核中设备驱动程序的开发，是否有任何通用和自动化测试套件来涵盖特定类型设备驱动程序的基本/最小功能？例如，如果我们测试网卡驱动程序，我们可以确保可以正确处理发送/接收数据包和网络配置等基本功能。对于特定设备驱动程序的一些独特功能，我们无需过多关注，只需保证其最小功能是正确的即可。我认为这种测试套件应该利用高级应用程序来验证设备驱动程序的功能正确性，而不是低级单元测试。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T03:30:55.093

除其他外，[Autotest](http://autotest.github.com/)值得一看。前段时间我使用它提供的测试来检查与无线网络相关的驱动程序。

除此之外，来自[Linux 测试项目](http://ltp.sourceforge.net/)的测试在这里也很有用。

# jquery - 为孩子添加类 - jquery

> ID：11347033
> 
> 赞同：6
> 
> 时间：2012-07-05T14:59:06.343
> 
> 标签：jquery, html

我有这个 html 代码：

```
<div class="rotation">
  <ul>
    <li><img src="..." alt="" /></li>
    <li><img src="..." alt="" /></li>
    <li><img src="..." alt="" /></li>
  </ul>
</div> 
```

我需要向 ul 添加类，我想使用 jquery 来完成，因为 ul、li 是在没有任何类的情况下生成的。
假设 ul 标签需要是`<ul class="image_rotation">`. 我该怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-05T15:00:12.493

[在此处阅读有关 jQuery 的`addClass`方法。](http://api.jquery.com/addClass/)

```
$('.rotation ul').addClass('image_rotation'); 
```

上面的代码将为`image_rotation`每个`ul`元素的后代添加一个类`rotation`。

如果您只想定位作为类的元素的*直接子*`ul`元素的 s ，请使用[子选择器 (](http://api.jquery.com/child-selector/) [)](http://api.jquery.com/child-selector/)：*`rotation`[`>`](http://api.jquery.com/child-selector/)*

 *```
$('.rotation > ul').addClass('image_rotation'); 
```

如果您只想在一个`.rotation`元素上执行此操作，您应该给它一个 id 并以这种方式选择它。例如：

```
$('#rotation ul'); 
```

和

```
<div id="rotation" class="rotation">
    <ul>
        <li><img src="..." alt="" /></li>
        <li><img src="..." alt="" /></li>
        <li><img src="..." alt="" /></li>
    </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-05T15:00:27.380

我建议保持简单：

```
$('div.rotation ul').addClass('image_rotation'); 
```

或者，如果`ul`元素中有多个元素`div.rotation`，则可以指定第一个`ul`：

```
$('div.rotation ul:first').addClass('image_rotation'); 
```

最后一个`ul`：

```
$('div.rotation ul:last').addClass('image_rotation'); 
```

或任意一个`ul`从零开始的索引，例如第三个`ul`（索引为`2`）：

```
$('div.rotation ul:eq(2)').addClass('image_rotation'); 
```

或者：

```
$('div.rotation ul').eq(2).addClass('image_rotation'); 
```

或直接子元素（因此没有`ul`元素嵌套在任何其他元素中）：

```
$('div.rotation > ul').addClass('image_rotation'); 
```

参考：

*   [`addClass()`](http://api.jquery.com/addClass/).
*   [`eq()`](http://api.jquery.com/eq/).
*   [`:eq`选择器](http://api.jquery.com/eq-selector/)。
*   [`:first`选择器](http://api.jquery.com/first-selector/)。
*   [`:last`选择器](http://api.jquery.com/last-selector/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-05T15:03:26.780

您只需要在 div 中找到 UL 并将其分配给您的班级。您可以在此[演示](http://jsfiddle.net/ZXmr8/)中看到它，但您的 HTML 代码如下

```
$(document).ready(function(){
    $('ul','div.rotation').each(function(index){
        $(this).addClass('image_rotation');
    });
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:07:04.227

```
$(".rotation ul").attr("class","image_rotation"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-05T15:00:26.227

这很容易，只需执行以下操作：

```
$(document).ready(function(){
    $('div.rotation ul').addClass('image_rotation');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T15:00:26.007

```
$(".rotation").children("ul").addClass( "MyClass"); 
```*

# php - 替代查询字符串格式

> ID：11347036
> 
> 赞同：1
> 
> 时间：2012-07-05T14:59:11.437
> 
> 标签：php, .htaccess, codeigniter

我目前正在使用 Codeigniter 构建一个 Web 应用程序。我注意到他们的文档更喜欢分段 URL 而不是查询字符串，这是有道理的，因为它们更容易阅读并且看起来更好。前几天我也在浏览 threadless.com，非常喜欢他们格式化查询的方式：

通常，查询如下所示：

```
http://www.threadless.com/catalog/index.php?type=guys&view=25&size=3xl 
```

但是 Threadless 使用这种格式：

```
http://www.threadless.com/catalog/type,guys/view,25/size,3xl 
```

他们如何获得这种格式？它是否涉及.htaccess？该格式是否与 Codeigniter 配合得很好，还是会涉及自定义功能？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:11:14.847

您可以在可以拥有的地方做类似的事情。

```
http://www.threadless.com/catalog/type/guys/view/25/size/3x1 
```

为此，您将拥有一个控制器功能，例如：

```
class Catalog extends CI_Controller {
    function catalog()
    {
        $params = $this->uri->uri_to_assoc(3);
    }
} 
```

这将输出如下内容：

```
Array
(
    [type] => 'guys'
    [view] => 25
    [size] => '3x1'
) 
```

如果你想要逗号，你会想要触摸 .htaccess 将所有“，”重写为“/”。

```
RewriteCond %{REQUEST_URI} ^([^\,]*)\,(.*)$
RewriteRule .* %1/%2 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:03:27.513

它是你的 .htaccess 中的 mod_rewrite

[http://statichtml.com/2010/mod-rewrite-baseon-on-query-string.html](http://statichtml.com/2010/mod-rewrite-baseon-on-query-string.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:06:27.470

如果您使用的是 Apache，那么它将涉及 .htaccess、.htdocs 或 httpd.conf（有多种方法）。关键是设置它，以便将名为“catalog”的文件解析为 .php 文件。然后，文件名 ( `/type,guys/view,25/size,3xl`) 之后的所有内容都作为 传递给脚本`$_SERVER['PATH_INFO']`，您将自己解析。

不确定 CodeIgniter 是如何工作的，或者它是否具有以不同方式执行此操作的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:07:32.100

这不是 CodeIgniter 通常做事的方式，但在[http://codeigniter.com/user_guide/general/routing.html中有帮助](http://codeigniter.com/user_guide/general/routing.html)

你需要编辑`/application/config/routing.php`

# android - IntentService 未触发

> ID：11347038
> 
> 赞同：6
> 
> 时间：2012-07-05T14:59:27.990
> 
> 标签：android, service, intentservice

我的应用程序通过 Web 服务调用将数据与远程数据库同步。我在 IntentService 中进行这些调用，以便它们可以在后台运行（我称之为 SyncService）。

启动我的 IntentService 的代码如下所示：

```
Intent intent = new Intent();
intent.setClass(appContext, SyncService.class);

// place additional values in intent
intent.putExtra("data_type", SyncService.ITEM_TRACKING);
intent.putExtra("user_id", intUserId);

// call SyncService
appContext.startService(intent); 
```

这通常看起来很棒。但是，我的一位朋友也是我的应用程序的用户，他经常告诉我他的数据没有同步并显示在我们的网站上。当我在附近时，他的设备恰好显示了这些症状。我将他的设备插入我的电脑，这是我发现的：

*   启动 SyncService 的代码（即：上面的代码）被命中。
*   我的 IntentService 的 onHandleIntent 方法中有一个断点，它**永远不会**被击中。
*   我检查了他设备的运行服务列表，SyncService 在那里并且正在运行。有趣的是，它已经运行了大约 20 分钟。我的印象是，当 IntentService 完全无法处理时，IntentService 会自行杀死。
*   我强行停止了 SyncService（而不是应用程序），突然之间，onHandleIntent 开始一遍又一遍地受到打击。就像所有的 Intent 都在设备上的某个地方排队，然后刚刚被扔到 SyncService 上。

有没有人对可能是什么问题有任何想法？你认为这是我的应用程序的问题吗？用安卓？

同样，我正在向 Android 发送一条消息，说“启动这个 IntentService 或将消息发送到已经运行的 IntentService。” 那个时候，我无法控制。消息永远不会到达 IntentService。一旦我强制退出应用程序，消息就会发送到 IntentService 并完成它的工作。

更新：我认为这段代码很好，但我会把它放上来，因为你们很多人可能想看它。

进入 IntentService 的每个 Intent 都有一个 Extra 表示对我进行的调用的“类型”（即：我调用*这个*Web 服务还是*那个*Web 服务等）。当 Intent 进入 IntentService 时，我会检查“类型”，如果队列中已经有该类型的 Intent，我会在其中添加一个名为“skip”的 Extra，因此，当它到达时，我不会t 执行搜索（基本上 IntentService 可以建立很多 Intent，当这个 web 服务在 20 秒前被调用时调用这个 web 服务是没有*意义*的*）*。它基本上可以保护应用程序免于向网站发送垃圾邮件。

 ***重要的是要注意，无论如何都不会命中此代码（一旦问题开始发生）。在应用程序被杀死之前不会调用 onStartCommand**

```
 @Override
    public int onStartCommand (Intent intent, int flags, int startId) {
        // here be dragons
        // overriding this method and adding your own code is dangerous. i've wrapped
        // my code in a try/catch because it is essential that the super method be called
        // every time this method is entered. any errors in my code should not prevent this
        // or the app will explode.
        try {
            if (flags == 0 && intent != null && intent.hasExtra("data_type")) {
                Integer intDataType = intent.getExtras().getInt("data_type");

                    if (!mCurrentTypes.containsKey(intDataType)
                            || !mCurrentTypes.get(intDataType)) {
                        mCurrentTypes.put(intDataType, true);  // put this type in the list and move on
                    }
                    else {
                        intent.putExtra("skip", true);  // mark this Intent to be skipped
                    }
            }
        }
        catch (Exception e) {
            // Log.e("Error onStartCommand", "error: " + e);
        }

        return super.onStartCommand(intent, flags, startId);
    }

private void processIntent(Intent intent) {
        // do stuff if no "skip" Extra
        mCurrentTypes.put(intDataType, false);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T10:31:37.600

肯定有一些东西可以让您的服务在您朋友的设备上运行。如果是这样，则对该意图服务的所有后续调用都将排队，直到当前调用完成。如果它没有完成，那么你将得到你所拥有的：下一个服务将不会启动。

您应该仔细检查：

*   你给网络操作适当的超时
*   您为网络连接操作提供适当的超时
*   线程之间没有竞争条件。
*   您记录服务内部可能发生的任何异常，您不想丢失此类信息。

之后，如果您认为一切都是绿色的：只需记录服务所做的事情并使用一些错误报告机制从您的朋友设备自动发送。一个简单的解决方案可能是使用 bugsense 或等效的。

接下来，放置某种看门狗：一个将继续运行直到您的服务停止的线程（您只需告诉您的线程在服务停止时停止）。经过一段时间后，线程将不得不停止您的服务。

这个看门狗线程可以放在服务本身内部，也可以放在外部，尽管这可能更复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T00:56:13.817

这个答案提出了一个在类似情况下对我有用的解决方案。它不会修复您当前的代码，而是建议另一个可能更简单（且更易于调试）的选项：

1.  `BroadcastReceiver`在您的呼叫中添加一个`Activity`监听 SUCCESS`Intents`的`IntentService`.

2.  在您的调用`Activity`中，包括何时启动的逻辑`IntentService`（并且不要将其包括在 IntentService 中）。逻辑是：

    *   在调用CANNOT_CALL时调用`startService()`并设置一个标志。`Activity`
    *   如果`Activity's` `BroadcastReceiver`没有收到来自 的 SUCCESS 广播`IntentService`，则`startService()`不能再次调用。
    *   当`Activity`确实收到成功意图时，将标志设置为 CAN_CALL，并且`startService()`可以在计时器再次命中时调用。
3.  在您的中，像这样`IntentService`写：`onStartCommand()`

    ```
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        super.onStartCommand(intent, flags, startId);
        return START_STICKY;
    } 
    ```

4.  在 you`IntentService`中，当您接收、解析和存储 Web 服务响应时，`sendBroadcast()`使用带有自定义操作 SUCCESS 的 Intent 调用。

这个逻辑只是一个大纲，必须针对来自 web 服务的错​​误消息进行微调，这些错误消息必须从`IntentService`监听器广播`Activity`。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T20:29:07.670

再来一条评论。这不是你问题的答案。但是，它可能会影响服务的整体行为。

您执行以下操作：

```
 return super.onStartCommand(intent, flags, startId); 
```

内部 Service.onStartCommand() 如下所示

```
public int onStartCommand(Intent intent, int flags, int startId) {
        onStart(intent, startId); 
        return mStartCompatibility ? START_STICKY_COMPATIBILITY : START_STICKY;
} 
```

如果您的应用以 SDK API 7 或更高版本为目标（很可能是这种情况），则 mStartCompatibility 为 false。

因此，您的服务将以 START_STICKY 启动。

这是文档中的一部分：

> 对于已启动的服务，它们可以决定运行另外两种主要的操作模式，具体取决于它们从 onStartCommand() 返回的值：START_STICKY 用于根据需要显式启动和停止的服务，而 START_NOT_STICKY 或 START_REDELIVER_INTENT 用于适用于只应在处理发送给它们的任何命令时保持运行的服务。有关语义的更多详细信息，请参阅链接文档。

根据您所描述的，我建议替换“return super.onStartCommand(intent, flags, startId);” “返回 START_NOT_STICKY；”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T05:11:48.367

在我看来，为您的 Intent 设置一组标志可能会解决问题。

```
Intent intent = new Intent();
intent.setClass(appContext, SyncService.class);
// This way    
intent.setFlags(Intent.FLAG_ACTIVITY_MULTIPLE_TASK|Intent.FLAG_ACTIVITY_NEW_TASK|Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS); 
```

您可以在全新任务中使用上述标志使您的服务以全新方式启动。*

# ios - 应用程序运行时播放音频

> ID：11347039
> 
> 赞同：0
> 
> 时间：2012-07-05T14:59:31.823
> 
> 标签：ios, audio, xcode4, xcode4.3

我最近一直在尝试让我的应用程序从打开到关闭时播放声音，但我遇到了困难。当我按下按钮时，我有一些关于播放声音的代码，这很好并制作我玩游戏的声音循环。

。H

```
#import <AudioToolbox/AudioToolbox.h>

    - (IBAction)t1:(id)sender; 
```

.m

```
- (IBAction)t1:(id)sender {

    CFBundleRef mainbundle = CFBundleGetMainBundle();
    CFURLRef soundFileUrlRef;
    soundFileUrlRef = CFBundleCopyResourceURL(mainbundle, (CFStringRef) @"t1", CFSTR ("wav"), NULL); 
    UInt32 soundID;
    AudioServicesCreateSystemSoundID(soundFileUrlRef, &soundID);
    AudioServicesPlaySystemSound(soundID);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T17:43:48.013

如何尝试 AVAudioPlayer 并通过将循环数设置为 -1 来打开连续播放：

```
 myPlayer.numberOfLoops = -1

    [myPlayer prepareToPlay];

    [myPlayer play];

    //when application did enter background or something
    [myPlayer stop]; 
```

[http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)

还要确保为后台播放正确设置了音频会话：http: [//developer.apple.com/library/ios/#DOCUMENTATION/Audio/Conceptual/AudioSessionProgrammingGuide/Basics/Basics.html#//apple_ref/doc/uid/ TP40007875-CH2-SW2](http://developer.apple.com/library/ios/#DOCUMENTATION/Audio/Conceptual/AudioSessionProgrammingGuide/Basics/Basics.html#//apple_ref/doc/uid/TP40007875-CH2-SW2)

# javascript - 不带括号的构造函数调用

> ID：11347046
> 
> 赞同：6
> 
> 时间：2012-07-05T14:59:54.740
> 
> 标签：javascript, constructor, new-operator

有没有区别

```
var obj1 = new Constructor; 
```

和

```
var obj2 = new Constructor(); 
```

鉴于这`Constructor`是一个构造函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T14:59:56.660

根据[MDN 文档](https://developer.mozilla.org/en/JavaScript/Reference/Operators/new)：

> [...] "new foo" 等价于 "new foo()"，即如果没有指定参数列表，则调用 "foo" 时不带参数。

# sql - 内部联接枢轴 SQL

> ID：11347047
> 
> 赞同：0
> 
> 时间：2012-07-05T14:59:55.743
> 
> 标签：sql, sql-server-2008

我有 2 个表，tblClient 和 tblDB。

```
CREATE TABLE tblBD(
[ID] INT PRIMARY KEY,
[DataBase] nVARCHAR (30) NOT NULL,
[ClientID] INT NOT NULL,
FOREIGN KEY ([ClientID]) REFERENCES tblClient(ID)
)

CREATE TABLE tblClient(
[ID] INT PRIMARY KEY,
[Name] nVARCHAR(30),
[Status] BIT,
[Number] INT,
) 
```

我想要一种方法来为每个客户获取他的所有数据库。

像这样的东西：

```
Client1 Client2 ClientX
BD1     BD1     BD1 
BD2     BD2     BD2
BDX     BDX     BDX 
```

我可以通过执行此脚本轻松地为一个客户做到这一点：

```
Select tblBD.[DataBase] from tblBD
inner join tblCLient on tblBD.ClientID = tblClient.ID Where tblClient.ID = 1234 
```

但是，我不知道如何在一张表中获得所有客户的结果。

对于枢轴，如果不使用聚合函数，我将无法获得结果。

例子 ：

```
WITH T
AS (Select tblBD.[DataBase] as BD, tblClient.ID as ClientID from
tblBD inner join tblCLient on tblBD.ClientID = tblClient.ID)
SELECT *
FROM   T PIVOT ( 
max (BD) FOR ClientID IN ([1],[2],[3], [4])
) AS pvt 
```

我想在不使用聚合函数的情况下获取所有数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T12:20:43.760

首先，我从中得到了启发：

[http://www.sqlmag.com/article/tsql3/pivoting-without-aggregation](http://www.sqlmag.com/article/tsql3/pivoting-without-aggregation)

执行此脚本以获取客户端数量：

```
SELECT COUNT( DISTINCT tblBD.ClientID) FROM tblBD 
```

在创建任意数量的客户之后。

以我为例，有 4 个客户：

```
SELECT [1] AS Client1, [2] AS Client2, [3] AS Client3, [4] AS Client4
FROM
(
    Select tblBD.[DataBase] AS BD,
    tblBD.ClientID AS ClientID ,
    ROW_NUMBER() OVER (PARTITION BY ClientID ORDER BY ClientID) AS RowNum 
    FROM tblBD
) Piv
PIVOT (MAX(BD) FOR ClientID IN ([1],[2],[3], [4])) AS pvt 
```

您可以在代码中构建一个查询字符串，该字符串将包含您想要的任意数量的客户端。

# java - 是否有机会安装尚未发布的插件损坏的 Eclipse 安装

> ID：11347049
> 
> 赞同：3
> 
> 时间：2012-07-05T15:00:05.447
> 
> 标签：java, eclipse, scala, eclipse-indigo

我使用 Eclipse Indigo 进行 java 开发，但我想尝试使用 scala。因为我必须下载一个夜间构建才能在 Eclipse 上运行：[http](http://scala-ide.org/download/nightly.html) ://scala-ide.org/download/nightly.html这安全吗？

由于该插件尚未完全发布，该插件是否有可能破坏我的 Eclipse 安装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:05:00.327

我现在运行最新的 Scala[里程碑](http://scala-ide.org/download/milestone.html)，没有任何问题，这可能比 nightly 更安全，并且具有更好的突出显示功能。如果您确实遇到了麻烦，您总是可以[在 Eclipse 中恢复到以前的安装状态](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.platform.doc.user/tasks/tasks-123.htm)，所以我认为它是安全的

插件架构的设计是为了保护 Eclipse 免受不稳定的影响，除非它们恶意删除您安装的文件，否则我怀疑它们会永久破坏 Eclipse。要格外小心，您可以备份 eclipse 目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:08:41.063

Nighly builds gives developers a chance to use latest features (not certified to be working on all environments) of the plugin which are not yet made available to end users. In general they work fine but there may be few undiscovered issues. You can always rollback your installation if something goes wrong or if you find any bugs.

If your aim is to learn or develop using scala, better to use stable build. A stable scala-ide plugin is available for Eclipse Indigo. Please visit 'http://scala-ide.org/download/current.html' for more details.

# c# - 如何确定数组的基础类型

> ID：11347053
> 
> 赞同：7
> 
> 时间：2012-07-05T15:00:20.397
> 
> 标签：c#, .net, arrays, reflection

> **可能重复：**
> [如何从 .net 中的数组类型获取数组项类型](https://stackoverflow.com/questions/4129831/how-do-i-get-the-array-item-type-from-array-type-in-net)

如果我有一个特定类型的数组，有没有办法知道该类型到底是什么？

```
 var arr = new []{ "string1", "string2" };
 var t = arr.GetType();
 t.IsArray //Evaluates to true

 //How do I determine it's an array of strings?
 t.ArrayType == typeof(string) //obviously doesn't work 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T15:02:29.467

[`Type.GetElementType`](http://msdn.microsoft.com/en-us/library/system.type.getelementtype.aspx)- 在派生类中重写时，返回当前数组、指针或引用类型包含或引用的对象的类型。

```
var arr = new []{ "string1", "string2" };
Type type = array.GetType().GetElementType(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:07:14.470

由于您的类型在编译时已知，因此您只需以 C++ 方式进行检查。像这样：

```
using System;

public class Test
{
    public static void Main()
    {
        var a = new[] { "s" }; 
        var b = new[] { 1 }; 
        Console.WriteLine(IsStringArray(a));
        Console.WriteLine(IsStringArray(b));
    }
    static bool IsStringArray<T>(T[] t)
    {
        return typeof(T) == typeof(string);
    }
} 
```

（产生`True`, `False`）

# google-bigquery - 在实时 XML 数据中进行大查询是否值得？

> ID：11347061
> 
> 赞同：0
> 
> 时间：2012-07-05T15:00:43.493
> 
> 标签：google-bigquery

我有一个大约 2 MB 的 xml 文件（是的 !! 2MB 小文件），我想以某种预定格式对文件进行排序，并显示格式化的结果，因为整个过程需要 2-3 秒，我们想要减少时间。

我的问题是（a）直接将 XML 推送到大查询而不是 CSV 的任何方式。(b) 我想做实时的，所以我如何从我的网站推送数据，并将数据取回我的网站。（你认为命令行可以解决问题吗？（c）我正在研究 .NET。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T18:17:52.217

我认为您不能将 XML 直接推送到 BigQuery。[文档](https://developers.google.com/bigquery/docs/developers_guide#importingatable)没有说“您不能导入 XML”。但它只解释了如何使用 CSV 的事实使它非常清楚。

这听起来不像是 BigQuery 的完美用例。BigQuery 非常适合处理大量数据，但您的数据量很小（如您所述）。在内存中对 XML 进行排序而不将其推送到其他地方不是更快吗？

# iphone - EKAlarm absoluteDate 为空

> ID：11347063
> 
> 赞同：0
> 
> 时间：2012-07-05T15:00:47.723
> 
> 标签：iphone, ios, alarm, eventkit, ekevent

对于我的项目，我使用 EventKit 访问 iPhone (iOS 5.1.1) 上的日历并从默认日历中获取所有事件。这很好用。对于我检查 hasAlarms 的每个事件，如果为真，我想知道警报的时间。所以，像这样：

```
for (EKEvent *ev in allEventsArray){
            if ([ev hasAlarms]){
                NSArray *alarms = ev.alarms;
                for (EKAlarm *alarm in alarms){
                    NSLog(@"%@",alarm.absoluteDate);
                }
            }
} 
```

问题是我得到了 NSLog 的“（null）”。我不知道我做错了什么......

有人可以帮忙吗？提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T00:25:25.457

EKAlarm will have an `absoluteDate` OR a `relativeOffset`. If absoluteDate is null then relativeOffset will have a value.

```
EKAlarm *alarmA = [EKAlarm alarmWithAbsoluteDate:[NSDate date]];
EKAlarm *alarmB = [EKAlarm alarmWithRelativeOffset: -300.0f];

NSLog(@"Absolute alarmA = %@", alarmA.absoluteDate);
NSLog(@"Absolute alarmB = %@", alarmB.absoluteDate);
NSLog(@"Relative alarmA = %f", alarmA.relativeOffset);
NSLog(@"Relative alarmB = %f", alarmB.relativeOffset); 
```

NSLog resuts:

```
Absolute alarmA = 2012-07-27 00:19:06 +0000
Absolute alarmB = (null)
Relative alarmA = 0.000000
Relative alarmB = -300.000000 
```

# google-maps - 下载当前渲染地图的图像

> ID：11347064
> 
> 赞同：0
> 
> 时间：2012-07-05T15:00:50.157
> 
> 标签：google-maps, google-maps-api-3

我正在开发一个使用 google maps javascript API 的应用程序，并且能够在我们的应用程序中下载当前呈现的地图的屏幕截图似乎会很好。

我似乎在 api 中找不到任何描述如何执行此操作的选项。

无论如何要下载当前渲染地图的图像吗？目前我们正在使用`HYBRID`地图类型

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:05:42.790

这不是 Javascript API 中的选项。但是，您可能能够使用静态地图 API 实现相同的地图，该 API 只生成一个 PNG 图像：[https ://developers.google.com/maps/documentation/staticmaps/](https://developers.google.com/maps/documentation/staticmaps/)

# c# - C# - 如何使用 SqlDependency 检测对 SQL Server 的更改？

> ID：11347070
> 
> 赞同：1
> 
> 时间：2012-07-05T15:01:02.217
> 
> 标签：c#, sqldependency

我有一个应该等待数据库更改的 Windows 服务。

它查看的数据库表如下所示：

> 编号 [指南]
> 
> 名称[文字]
> 
> MatchId [Guid] => 这是一个外键
> 
> 比赛日期时间 [日期时间]

我希望我的服务能够检测到何时有人“清除”了“MatchId”字段（为其分配了 NULL），

然后对于在其“MatchId”字段中具有“NULL”的所有行 - 执行一些算法，为它们找到匹配项并分配“MatchId”字段。

问题是 - 如果我使用“SqlDependency”类，并等待它在“MatchId”字段上触发 - 我只会在**新**行受到影响时收到通知，但任何现有的“MatchId = NULL”行 - 我不会知道关于。

这意味着如果 Windows 服务加载，并且表中已经有 20 行“MatchId = NULL”，并且在接下来的 5 小时内没有人会“清除”“MatchId”行 - 这意味着我不会知道关于现有的 20 行，不会处理它们。

一种解决方案可能是在我设置“SqlDependency”之前 - 我应该执行快速“选择”以查看是否存在任何**现有**的“MatchId = NULL”行，如果有的话 - 处理它们，然后才设置依赖关系。

问题是 - 在完成处理这些行和设置 SqlDependency 之间的短暂间隔内 - 可能会发生一个事件，其中有人将行更改为“MatchId = NULL”，然后再一次 - 我不会在Sql依赖。

知道如何解决这个问题吗？

（如果最坏的情况发生，我就不会使用SqlDependency，我只需要每XXX分钟轮询一次数据库......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T16:31:24.703

我明白，我迟到了这个答案，但你没有更新，你选择哪种方法:)

您可以先启动 SQLDependency，然后运行选择查询来检查现有记录。换句话说，您将在 SQLDependency 启动后（最初或更改后）每次轮询空记录

问题[的答案](https://stackoverflow.com/a/10700057/52277)中建议了相同的方法[如何弄清楚哪个 SQLDependency 触发了更改函数？](https://stackoverflow.com/questions/10655458/how-to-figure-out-which-sqldependency-triggered-change-function?rq=1)

> 首先也是最重要的：必须在执行命令之前设置处理程序。否则，当通知可能丢失并且您的回调从未被调用时，您会有一个窗口

.

# c#-4.0 - 具有类型化数据集的 TransactionScope

> ID：11347073
> 
> 赞同：0
> 
> 时间：2012-07-05T15:01:08.997
> 
> 标签：c#-4.0, transactions, transactionscope, strongly-typed-dataset

是否可以将 TransactionScope 与类型化数据集一起使用？

如：

```
using (var transaction = new TransactionScope())
{
    typedDataSet.DeleteStuff(id);

    typedDataSet2.DeleteSomeOtherStuff(id2);

    transaction.Complete();
} 
```

如果抛出错误，与 DeleteStuff(id) 和 DeleteSomeOtherStuff(id) 相关的 sql 查询实际上是事务性的吗？

我已经阅读了 Bogdan Chernyachuk 的这篇关于[使用具有强类型数据集的事务的](http://bogdandotnet.blogspot.co.uk/2008/03/using-transactions-with-strongly-typed.html)文章，我希望我不必这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:41:49.083

简短的回答：是的，这是交易性的。

也不是太难测试。我在 transaction.Complete() 之前抛出了一个异常，并且数据没有从数据库中删除。

```
using (var transaction = new TransactionScope())
{
    typedDataSet.DeleteStuff(id);

    typedDataSet2.DeleteSomeOtherStuff(id2);
    throw new NullReferenceException();
    transaction.Complete();
} 
```

奇怪的是，尽管我使用 SQL SERVER Profiler 分析了数据库中发生的事情，并且通过类型化数据集引用的存储过程在服务器上执行。然而，数据以某种方式回滚。

# perl - 如何在 Perl 中重新分配非核心模块？

> ID：11347079
> 
> 赞同：4
> 
> 时间：2012-07-05T15:01:26.927
> 
> 标签：perl

我对 Perl 比较陌生，我需要一些帮助来重新分发非核心模块。这是整个故事。

Perl 脚本中使用了两个非核心模块：**XML::Simple**和**SOAP::Lite**。我正在使用的版本（目前在 Windows 上）是 Strawberry Perl，因此这两个模块已经包含在内。但是，我们不知道最终用户（Unix/Linux 系统）是否拥有这两个模块，因为他们可能只有标准版本，因此只有核心模块。我的目标是让最终用户尽可能少地进行配置/安装。

首先，我尝试查看是否有任何类似于**XML::Simple**和**SOAP::Lite**的核心模块。不幸的是，我没有找到任何（如果我错了，请纠正我）。

所以我想现在唯一的选择是重新分配这两个模块。我检查了这两个模块允许重新分发。我现在的问题是如何去做。我尝试使用关键字“perl redistribute”进行谷歌搜索，但没有发现任何有用的东西。我的猜测是我们使用导出器工具来实现这一点。但这两个模块是相当复杂的模块，它们有几个嵌套的文件夹/pm 文件（以及一大堆其他文件，如 MAKE、pod、ini 文件），所以我不确定我应该做什么。我使用 exporter 找到的示例非常简单：它们只有 1 个 pm 文件和 1 个 pl 文件，它们被放置在一个文件夹中。

此外，我愿意接受任何其他更好的方法来处理这个问题。目标只是确保所有最终用户都能以最少的配置/安装工作使用我的脚本，因为我们不希望他们遇到一大堆兼容性问题。

任何帮助，将不胜感激。谢谢！=D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T16:33:15.197

我想详细说明@ikegami 说的。

[SOAP::Lite](https://metacpan.org/module/SOAP%3a%3aLite)有[大量的 CPAN 依赖项](http://deps.cpantesters.org/?module=SOAP%3a%3aLite&perl=5.14.2&os=any%20OS)，因此安装您的模块的人将需要 CPAN 访问权限才能构建它，无论您是为他们提供它，还是将其列为依赖项。否则，您将需要提供整个依赖关系树，此时您最终会使用 perlbrew、可能是 carton，可能还可能是 local::lib，然后您可能会决定需要下一个更高级别并生成 RPM 和 DEB。

最好只提供您的脚本，打包为 CPAN 模块，列出您的依赖项，然后让芯片落在可能的位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T15:37:42.800

只需在 Makefile.PL 或 Build.PL 中声明对模块的依赖关系，然后为它们提供以下安装说明：

```
cpanm script.tar.gz 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-05T16:34:26.350

Perl 最棒的地方之一是 The CPAN，即综合 Perl 归档网络。这是一个镜像服务，大约在 Perl 5 最初出现的时候，人们就可以共享有用的附加模块，比如`XML::Simple`或`SOAP::Lite`通过标准的通用工具，`cpan`即 Perl 附带的客户端。几乎所有的 Perl 发行版（例如 Strawberry Perl 和大多数 Linux 附带的 Perl 发行版）都配置并包含了 CPAN 客户端。这个客户端让人们只需知道模块的名称就可以从 CPAN 下载和安装模块。

CPAN 上几乎所有的模块分布都遵循完全相同的布局。它们通常有一个`Makefile.PL`文件（如果它使用 ExtUtils::MakeMaker 生成安装脚本）、`Build.PL`文件（如果它使用 Module::Build 生成安装脚本）或两者兼有。这些 Perl 脚本一旦运行，就会创建一个“Makefile”或“Build”文件，可以让您安装模块并验证是否满足所有先决条件。

如果您以前从未制作过 Perl 发行版，您可以从 CPAN 下载您想要的任何发行版并查看其布局。一旦您看到文件夹和文件位置，就会非常直观。它们通常与根目录中的安装脚本和支持文件（如自述文件）一起布局，目录中包含自定义模块（您制作的模块），`lib`目录中包含单元测试`t`。

`Build.PL`如果您是新手，我建议您查看基于基础的；这些是纯粹的基于 Perl 的安装脚本。如果您决定制作基于 Module.PL 的发行版，则很容易指定您的模块发行版需要`XML::Simple`和`SOAP::Lite`. 首先，创建一个基于 Module::Build 的基本安装脚本。这看起来像：

```
use Module::Build;
my $build = Module::Build->new(
    module_name => 'Foo::Bar',
    license  => 'perl',
    requires => {
        'perl'          => '5.6.1',
        'Some::Module'  => '1.23',
        'Other::Module' => '>= 1.2, != 1.5, < 2.0',
    },
);
$build->create_build_script; 
```

（这取自[Module::Build::Authoring](http://search.cpan.org/perldoc?Module::Build::Authoring)文档）。

然后，指定您需要的库和它们的最低版本。如果您不在乎，零 (0) 是可接受的版本，但这意味着“任何东西”都很好。我建议至少指定您正在测试的机器上安装的库的版本。

（简洁的捷径：您可以通过以下方式找到任何具有 $VERSION 包变量的库的版本：

```
perl -MSome::Lib -E "say Some::Lib->VERSION()" 
```

.)

要安装模块，步骤如下所示：

```
cd folder\where\my\lib\is
perl Build.PL
Build
Build test
Build install 
```

这将创建安装工具，准备用于测试的文件夹（通常只是将内容复制到简单模块的构建库区域），运行`t`文件夹中的所有 .t 脚本（“测试”，通常[`Test::More`](http://search.cpan.org/perldoc?Test::More)用于模块的单元测试在安装之前），最后，将您的模块安装到您 PC 的 Perl 站点库中。

作为“设置”阶段的一部分，该`Build`脚本将查看您的先决条件，并在您还没有它们时警告您。

[然后，正如ikegami的回答](https://stackoverflow.com/a/11347793/18097)中指出的那样，如果您使用cpanm客户端安装您的库，cpan客户端会自动为您下载，测试和安装您的依赖项！或者，`Build.PL`基于安装程序也有“installdeps”选项，它会做同样的事情。然后自动下载、测试和安装任何和所有依赖项（以及潜在的递归依赖项），即使它们将来发生变化。

# r - XTS to.weekly 返回不同的每周端点

> ID：11347081
> 
> 赞同：3
> 
> 时间：2012-07-05T15:01:29.187
> 
> 标签：r, xts, zoo

我有一个问题，其中的`endpoints()`函数`xts`（以及`to.weekly`使用端点的函数）有时返回星期五作为周末，有时返回星期一。

我的数据集称为`sp2`.

```
> head(sp2)
           [,1]
2012-01-09 1.78
2012-01-10 1.78
2012-01-11 1.77
2012-01-12 1.80
2012-01-13 1.77
2012-01-16 1.77

> tail(sp2)
           [,1]
2012-06-28 1.94
2012-06-29 1.92
2012-07-02 1.92
2012-07-03 1.90
2012-07-04 1.89
2012-07-05 1.89

> class(sp2)
[1] "xts" "zoo"

> weekdays(index(sp2))
  [1] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [11] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [21] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [31] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [41] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [51] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [61] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [71] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [81] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
 [91] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
[101] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
[111] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"   
[121] "Monday"    "Tuesday"   "Wednesday" "Thursday"  "Friday"    "Monday"    "Tuesday"   "Wednesday" "Thursday" 
```

如您所见，数据系列中没有缺少工作日。

然而.....

```
> weekdays(index(to.weekly(sp2)))
 [1] "Friday"   "Friday"   "Friday"   "Friday"   "Friday"   "Friday"   "Friday"   "Friday"   "Friday"   "Friday"   "Monday"  
[12] "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"  
[23] "Monday"   "Monday"   "Monday"   "Thursday" 
```

当然这应该总是星期五（除了今天，星期四的最后一点）？

我在这里做错了什么，有解决方法吗？

我希望计算这个数据系列从周五到周五的每周变化。

......................................可重复的例子...... .....................

```
i <- as.Date((as.numeric(Sys.Date())-200):as.numeric(Sys.Date()))
x <- xts(rep(1, length(i)), order.by = i)
weekdays(index(to.weekly(x)))
#  [1] "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"  
# [14] "Sunday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"   "Monday"  
# [27] "Monday"   "Monday"   "Monday"   "Thursday"
y <- xts(rep(1, length(i)), order.by = as.POSIXct(i))
weekdays(index(to.weekly(y)))
# [1] "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"  
# [14] "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"   "Sunday"  
# [27] "Sunday"   "Sunday"   "Sunday"   "Thursday" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:54:39.837

这是 CRAN 版本中的一个错误，已在 R-Forge 上修复。基本上，索引的时间部分并没有被删除，并且您遇到了一些带有时区和夏令时的时髦业务。

[从 R-Forge 安装](https://stackoverflow.com/q/11105131/271616)以使用更正的功能。

```
require(xts)
i <- Sys.Date()+200:0
x <- xts(rep(1, length(i)), order.by = i)
y <- xts(rep(1, length(i)), order.by = as.POSIXct(i))
all.equal(weekdays(index(to.weekly(x))), weekdays(index(to.weekly(y)))) 
```

# iphone - 我必须在这里释放物体吗？

> ID：11347084
> 
> 赞同：-1
> 
> 时间：2012-07-05T15:01:35.567
> 
> 标签：iphone, ios, memory

我对 Objective-C 的内存管理感到困惑。例子：

```
.h file
@property(nonatomic,retain) NSString *myString;

.m file
@synthesize myString
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [arrayString count];
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

  //in this case,i have to check 
  if(self.myString != nil)
        [myString release],self.myString = nil;
  //and assign 
  self.myString = [arrayString objectAtIndex:indexPath.row];
  //or i need only assign 
  self.myString = [arrayString objectAtIndex:indexPath.row];
} 
```

谁能给我解释一下？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:04:30.017

您只需要分配字符串 .. 并`nil`在`dealloc`and`viewDidUnload`方法中释放/分配它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:06:11.483

```
 if(self.myString != nil){
        [myString release],self.myString = nil;
 } 
```

This is enough:

```
 if(self.myString != nil){
            self.myString = nil;
     } 
```

As for your question, you only need this:

```
 self.myString = [arrayString objectAtIndex:indexPath.row]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:06:20.113

You don't need to release, because the property is defined as "retain", that means it retains the passed object after it releases the previous one.

If, instead of accessing the property you use directly the variable then you need to manually manage the release/retain..

BTW: you can send a message to a nil object...(so without checking it is nil to release it)

# android - 下载 2.3.3 的 android 源代码并将其作为 eclipse 项目打开

> ID：11347088
> 
> 赞同：1
> 
> 时间：2012-07-05T15:01:59.220
> 
> 标签：android, eclipse, svn, android-source

我找到了这个[http://source.android.com/source/downloading.html](http://source.android.com/source/downloading.html)但它似乎有很多步骤要做。

是否有另一种方法可以从 zip 文件或 svn 下载我们需要的 android 源版本并将其构建为 eclipse 项目？

[我将源代码下载为 jar 并从http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/2.3.3_r1](http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/2.3.3_r1)提取源文件，但无法将其作为 eclipse 项目打开。

我需要的是构建我自己的定制 android 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:09:52.503

最好按照 [http://source.android.com/source/downloading.html](http://source.android.com/source/downloading.html)中的说明进行操作。这非常简单：您只需要创建一个新文件夹，初始化它并下载源代码。

之后，您可以按照说明[http://source.android.com/source/using-eclipse.html](http://source.android.com/source/using-eclipse.html)将您的项目添加到 eclipse 中。您将面临一些错误（错误和我的解决方法[在这里](https://stackoverflow.com/questions/10369741/error-android-source-build-in-eclipse/10383282#10383282)）。

# iphone - 如何设计自定义视图并将其附加到 UIButton 视图？

> ID：11347093
> 
> 赞同：0
> 
> 时间：2012-07-05T15:02:13.570
> 
> 标签：iphone, objective-c, uibutton

有什么方法可以使用自定义视图（UIImage 占位符和 UILabel 占位符）创建 xib，然后加载 xib，获取其 UIView 并将其传递给 UIButton 视图？问题是我需要从设计中实现菜单图标，其中按钮标签位于菜单图标的最底部。默认情况下，UIButton 中的标签显示在中心。听说可以在xib中设计自定义视图，加载使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T17:46:17.697

假设笔尖连接了一个`IBOutlet`命名的`subView`，

```
subView = [[NSBundle mainBundle] loadNibNamed:@"mySubview" 
                                           owner:self options:nil]; 
```

现在您可以使用子视图来构建您的按钮。

# forms - CakePHP 2.1：以流畅的方式验证来自元素的表单？

> ID：11347098
> 
> 赞同：2
> 
> 时间：2012-07-05T15:02:30.517
> 
> 标签：forms, validation, cakephp, cakephp-2.1

我有以下情况。帖子有很多评论

评论属于帖子

在我的 /Views/Posts/view 中，我显示带有评论的帖子。此外，每个帖子都应显示评论表。因此，我必须在视图中使用元素 add_comment.ctp（如果我错了，请纠正我，但请[在此处查看此问题](https://stackoverflow.com/questions/9721091/adding-a-comment-to-an-article-in-cakephp)）。

/视图/帖子/view.ctp：

```
// add comments
echo $this -> element('add_comment',array('post_id' => $entry['Post']['id']), array('cache' => array('config' => 'long'))); 
```

元素：

```
/**
 * Element for adding comments
 *
 */
echo $this -> Form -> create('Comment', array('url' => array(
        'controller' => 'comments',
        'action' => 'add',
        $post_id
    )));
?>
    <fieldset>
        <legend><?php echo 'Add Comment'; ?></legend>
    <?php
    echo $this -> Form -> input('author_name');
    echo $this -> Form -> input('author_email', array('type' => 'email required'));
    echo $this -> Form -> input('author_website');
    //echo $this->Form->input('date_published');
    echo $this -> Form -> input('text');
    //echo $this->Form->input('is_archived');
    ?>
    </fieldset>
<?php echo $this -> Form -> end(array('label' => 'Post!')); ?> 
```

如您所见，表单被提交到 CommentsController 的 add 操作。现在，最大的问题是：添加操作如何将验证结果等数据实际传递回表单？我的意思是，表单数据也应该被持久化，所以万一有人输入了无效数据，它不会丢失。

通常，添加操作会呈现 /View/Comments/add，但我既不需要这个视图，也没有定义一个视图。

到目前为止，我已经使用 $this->redirect 在保存评论后返回到 /Views/Posts/view ——但重定向只是调用 /Views/Posts/view 而不传递任何内容。那么如何使用 Elements in Combination 以及平滑和自动的表单处理呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:21:21.283

我认为如果您在提交后重定向，它将丢失任何`$this->invalidFields()`基本上触发验证错误等的内容。有几种方法可以解决这个问题......

**1**：您无法*在*视图中再次重定向和呈现表单，`comments/add.ctp`因此表单将自动显示验证错误。然后，一旦保存成功并且验证通过，为了使过程顺利再次重定向回您的帖子（您应该以某种方式拥有帖子 ID）。

**2**：您也可以将评论保存逻辑放在评论模型中，然后在您的 Post View 操作中检查评论 POST（更新表单以指向此操作）并调用您在那里创建的保存函数`$this->Post->Comment->saveMethodDefinedInModel($this->request->data['Post']);`。

**3：**或者....您可以采用选项一并将其与 ajax 结合使用，这将是相当粗糙的。

# c - glibc的源码结构是怎样的

> ID：11347103
> 
> 赞同：3
> 
> 时间：2012-07-05T15:02:46.187
> 
> 标签：c, linux

我试图寻找一个特定的函数，例如 fstatfs，但我找到了以下代码，它几乎什么也没做，我检查了 __set_errno 宏，它只是设置错误号。

```
int
__fstatfs (int fd, struct statfs *buf)
{
  __set_errno (ENOSYS);
  return -1;
} 
```

所以在 ASM 中实现了一组核心库，但是它是如何工作的，如果是这样，为什么这些弱功能甚至存在？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:15:40.377

我猜这个调用是依赖于操作系统的，所以你看到的只是一个存根。[io/sys/statfs.h](http://sourceware.org/git/?p=glibc.git;a=blob;f=io/sys/statfs.h;h=9e9f0944dbfc35fec2db35099ad33dcaae739d09;hb=ee9247c38a8def24a59eb5cfb7196a98bef8cfdc)中似乎有某种别名，Linux 实现的候选者在[sysdeps/unix/sysv/linux/fstatfs64.c](http://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/fstatfs64.c;h=eed58cb5c26c4a22e878bf1ab3b11e3ea56aaee9;hb=ee9247c38a8def24a59eb5cfb7196a98bef8cfdc)文件中。

# android - 使用不使用 id 从列表视图中检索值

> ID：11347105
> 
> 赞同：0
> 
> 时间：2012-07-05T15:02:51.293
> 
> 标签：android, listview

我的应用程序有一个列表视图.....我怎样才能检索指定的字段值....（在我的情况下是昵称和正文。查看数据库）???????我的意思是我会弹出昵称和正文listView 中的文本....怎么可能

我的代码 ListView.java

```
public class ListView extends ListActivity {

SQLiteDatabase messagedb;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.my_list);

    messagedb=ListView.this.openOrCreateDatabase("message",0, null);
    messagedb.execSQL(
            "CREATE TABLE IF NOT EXISTS tab2(" +
            " _id INTEGER PRIMARY KEY," +
            " nickname varchar,sender INT(13),body varchar)");

    Cursor cur = messagedb.rawQuery("select rowid as _id, nickname, body from tab2", null);
    String[] from = new String[] { "nickname", "body" };
    int[] to = new int[] { R.id.sender_entry, R.id.body_entry};

    SimpleCursorAdapter mAdapter = new SimpleCursorAdapter(this, R.layout.my_list_entry, cur, from, to);

    this.setListAdapter(mAdapter);

    messagedb.close();

}

} 
```

我的演示列表视图如下

![在此处输入图像描述](../Images/12361d20393046e888d6a697344ea580.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:34:59.977

如果我理解正确的话。这将是您的解决方案。

```
 @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        // TODO Auto-generated method stub
        super.onListItemClick(l, v, position, id);
        String nickName = ((TextView) v.findViewById(R.id.sender_entry))
                .getText().toString();
        String BODY = ((TextView) v.findViewById(R.id.body_entry)).getText()
                .toString();
    } 
```

# codeigniter - 无法在 cezpdf codeigniter 中加载图像

> ID：11347107
> 
> 赞同：0
> 
> 时间：2012-07-05T15:02:56.783
> 
> 标签：codeigniter, pdf, pdf-generation

这是我在控制器中的代码

```
function exportPDF() 
{
    $this->load->library('cezpdf');
    $this->load->helper('pdf');
    $this->cezpdf->cezpdf('a4','portrait');
    $data['unit_kerja']= $this->admin_model->getUnitKerjaPDF();
    $titlecolumn = array(
                        'id_indeks' => 'Nomor Indeks',
                        'nama_unit' => 'Nama Unit Kerja'
    );
    $this->cezpdf->ezTable($data['unit_kerja'],$titlecolumn,'Master Unit Kerja');
    $image=base_url().'images/bps.png';
    $this->cezpdf->ezImage($image);
    $this->cezpdf->ezSetMargins(50,50,50,50);
    $this->cezpdf->addText(50,32,8,'Printed on ' . date('m/d/Y h:i:s a'). ' copyright cmail system BPS');
    $this->cezpdf->ezStream();
} 
```

当我调用控制器时，数据显示良好，但我无法加载图像...谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:19:54.373

它没有正确加载您在图像中加载的图像。

你有：

```
$image=base_url().'images/bps.png'; 
```

您应该在内部引用它，例如：

```
$image=BASEPATH.'images/bps.png'; 
```

# android - 如何在自定义列表视图行中为android中的分隔符膨胀两个布局

> ID：11347109
> 
> 赞同：0
> 
> 时间：2012-07-05T15:03:10.390
> 
> 标签：android

如何在自定义列表视图行中为android中的分隔符膨胀两个布局。任何人都可以提供示例

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:05:51.773

与`divider`和`dividerHeight`属性。例如：

```
<ListView
  android:id="@android:id/list"
  android:divider="@android:color/black"
  android:dividerHeight="5dip" /> 
```

# c++ - 通过引用传递时取消引用指针

> ID：11347111
> 
> 赞同：54
> 
> 时间：2012-07-05T15:03:24.087
> 
> 标签：c++, pointers, reference

通过引用传递函数时取消引用指针会发生什么？

这是一个简单的例子

```
int& returnSame( int &example ) { return example; }

int main()
{
  int inum = 3;
  int *pinum = & inum;

  std::cout << "inum: " <<  returnSame(*pinum) << std::endl;

  return 0;          

} 
```

是否产生了临时对象？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-05T16:29:24.053

取消引用指针不会创建副本；它创建一个指向指针目标的*左值。*这可以绑定到*左值*引用参数，因此函数接收对指针指向的对象的引用，并返回对该对象的引用。这种行为是明确定义的，并且不涉及临时对象。

如果它按值获取参数，那么这将创建一个本地副本，并且返回对它的引用将是不好的，如果访问它会给出未定义的行为。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-07-05T16:06:24.040

**书面问题的答案**

不，此行为已定义。当指针类型被取消引用或使用引用类型时，不会调用构造函数，除非程序员明确指定，如以下代码片段所示，其中`new`运算符调用该`int`类型的默认构造函数。

```
int* variable = new int; 
```

至于真正发生的事情，正如所写，`returnSame(*pinum)`与`inum`. 如果您想自己验证这一点，可以使用以下代码段：

```
returnSame(*pinum) = 10;
std::cout << "inum: " << inum << std::endl; 
```

**进一步的分析**

我将从更正您提供的代码开始，它看起来不像您在发布之前尝试编译的代码。编辑后，剩下的一个错误在第一行：

```
int& returnSame( int &example ) { return example; } // semi instead of colon 
```

**指针和引用**

编译器以相同的方式处理指针和引用，它们的使用不同，而不是它们的实现。指针类型和引用类型将其他东西的*位置作为它们的值存储。*指针解引用（使用`*`or`->`运算符）指示编译器生成代码以跟随指针并在它所引用的位置而不是值本身上执行操作。取消引用指针时不会分配新数据（不调用构造函数）。

使用引用的工作方式几乎相同，除了编译器自动假定您需要该位置的值而不是该位置本身。事实上，不可能以与指针允许您相同的方式引用引用指定的位置：一旦分配，引用就不能重新安装（更改）（即，不依赖于未定义的行为），但是您仍然可以通过对其使用`&`运算符来获取它的值。甚至可以有一个 NULL 引用，尽管处理这些特别棘手，我不建议使用它们。

**片段分析**

```
int *pinum = & inum; 
```

创建一个指向现有变量 inum 的指针。指针的值是存储 inum 的内存地址。创建和使用指针不会隐式调用指向对象的构造函数，永远不会。这个任务留给程序员。

```
*pinum 
```

取消引用指针有效地产生了一个常规变量。这个变量在概念上可能占用另一个命名变量使用的相同空间，也可能不占用。在这种情况下，`*pinum`和`inum`是相同的变量。当我说“产生”时，重要的是要注意没有调用构造函数。这就是为什么你必须在使用它们之前初始化指针：指针解引用永远不会分配存储空间。

```
returnSame(*pinum) 
```

此函数接受一个引用并返回相同的引用。意识到这个函数也可以用指针编写是有帮助的，并且行为方式完全相同。引用也不执行任何初始化，因为它们不调用构造函数。但是，未初始化的引用是非法的，因此通过它们进入未初始化的内存并不像使用指针那样常见。可以通过以下方式重写您的函数以使用指针：

```
int* returnSamePointer( int *example ) { return example; } 
```

在这种情况下，您不需要在传递指针之前取消引用它，但您需要在打印之前取消引用函数的返回值：

```
std::cout << "inum: " <<  *(returnSamePointer(pinum)) << std::endl; 
```

**空引用**

声明 NULL 引用是危险的，因为尝试使用它会自动尝试取消引用它，这将导致分段错误。但是，您可以安全地检查引用是否为空引用。同样，我强烈建议不要使用这些。

```
int& nullRef = *((int *) NULL);      // creates a reference to nothing
bool isRefNull = (&nullRef == NULL); // true 
```

**概括**

*   指针和引用类型是完成同一件事的两种不同方式
*   适用于一个的大多数陷阱适用于另一个
*   在任何情况下，指针和引用都不会隐式调用被引用值的构造函数或析构函数
*   只要正确初始化指针，声明对取消引用指针的引用是完全合法的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T15:06:44.973

A compiler doesn't "call" anything. It just generates code. Dereferencing a pointer would at the most basic level correspond to some sort of load instruction, but in the present code the compiler can easily optimize this away and just print the value directly, or perhaps shortcut directly to loading `inum`.

Concerning your "temporary object": Dereferencing a pointer always gives an lvalue.

Perhaps there's a more interesting question hidden in your question, though: How does the compiler implement passing function arguments as references?

# wordpress - 如何删除数据库中的所有插件引用？

> ID：11347120
> 
> 赞同：0
> 
> 时间：2012-07-05T15:03:43.577
> 
> 标签：wordpress, plugins

如何从 WordPress 中完全删除插件？

我已经通过 WordPress 管理员删除了插件，然后重新安装，问题仍然存在。

我在 cmsoptions 表中看到 8 条记录引用了有问题的插件。由于 WP Admin 在插件处于活动状态的情况下拖入了爬行状态，并且该插件在几周内运行良好，因此我不得不得出结论，由于数据库中的插件引用而存在问题。

如果有人对完全从 WP 中删除插件有内幕消息，请分享。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T19:49:37.690

选项 API (http://codex.wordpress.org/Options_API) 对插件开放以存储它想要的任何数据（以它想要的任何名称）。您必须搜索插件代码以查看它存储的内容（以及如何存储），以消除有问题的数据。

问题不在于 WordPress，而在于插件。WordPress 是一个框架，不能对在它之上构建的任何东西（即插件）负责。这就像责备一栋建得不好的房子的锤子一样。

# zend-framework - 不同表中的身份和凭据。如何登录用户？

> ID：11347121
> 
> 赞同：1
> 
> 时间：2012-07-05T15:03:43.653
> 
> 标签：zend-framework, authentication, zend-db

我正在使用 Zend 框架。

我将用户信息保存在两个表中。我有一张他的基本信息和密码的表格，在另一张表格中我保存他的电子邮件。他可以使用任何电子邮件登录。

我的问题是我应该如何扩展 Zend_Auth_Adapter_DbTable 以便我可以允许这样做？

我不喜欢使用表格视图。

**[编辑]**

我找到了解决方案。什么对我有用：

```
class My_Auth_Adapter_DbTable extends Zend_Auth_Adapter_DbTable
{
protected function _authenticateCreateSelect()
{
    // build credential expression
    if (empty($this->_credentialTreatment) || (strpos($this->_credentialTreatment, '?') === false)) {
        $this->_credentialTreatment = '?';
    }

    $credentialExpression = new Zend_Db_Expr(
        '(CASE WHEN ' .
        $this->_zendDb->quoteInto(
            $this->_zendDb->quoteIdentifier($this->_credentialColumn, true)
            . ' = ' . $this->_credentialTreatment, $this->_credential
            )
        . ' THEN 1 ELSE 0 END) AS '
        . $this->_zendDb->quoteIdentifier(
            $this->_zendDb->foldCase('zend_auth_credential_match')
            )
        );

    // get select

   //$dbSelect = clone $this->getDbSelect();
   $mdl = new My_Model_Db_Table_Users();
   $dbSelect = $mdl->select();
   $dbSelect = $dbSelect->setIntegrityCheck(false);
   $dbSelect = $dbSelect->from(array('u' => $this->_tableName), array('*', $credentialExpression));
   $dbSelect = $dbSelect->joinInner(array('ue' => 'users_emails'), 'ue.id_user = u.user_id', array('user_email'));
   $dbSelect = $dbSelect->where('ue.' .  $this->_zendDb->quoteIdentifier($this->_identityColumn, true) . ' = ?', $this->_identity);

   return $dbSelect;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:39:35.017

有一个名为`Zend_Auth_Adapter_DbTable::getDbSelect`返回`Zend_Db_Select`对象的方法。调用它，然后您可以加入这两个表。

希望这有帮助。

问候，艾哈迈德 B.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T07:18:07.163

我在问题中解释了它为我做了什么。

但是，重复一遍，对我来说最简单的就是改变`Zend_Auth_Adapter_DbTable::_authenticateCreateSelect()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-19T17:06:36.270

这是另一种方法。

扩展 Zend_Auth_Adapter_DbTable 类。

```
class My_Auth_Adapter_DbTable extends Zend_Auth_Adapter_DbTable {
    public function setDbSelect($select) {
        $this->_dbSelect = $select;
        return $this;
    }
} 
```

创建新适配器的实例

```
$authAdapter = new My_Auth_Adapter_DbTable(
    $this->dbTable->getAdapter()
    , 'Users'
    , 'Users.username'
    , 'Users.password'
); 
```

在 Application_Model_DbTable_Users 类中，创建一个方法，该方法返回带有连接表的选择对象。

```
public function getSelectAuth() {
    $select = $this
        ->select()
    ->setIntegrityCheck(false)
    ->from(array('SystemPeopleJoined' => $this->_name)
        , array(
            'id'
            , 'person_id'
            , 'system_role_id'
            , 'created_on'
            , 'expires_on'
        )
    )
    ->joinInner(
        'People'
        , 'People.id = SystemPeopleJoined.person_id'
        , array(
            'first_name' => 'first_name'
            , 'last_name' => 'last_name'
            , 'name' => "CONCAT_WS(' ', `People`.`first_name`, `People`.`last_name`)"
    )
    return $select;
} 
```

在适配器中设置选择对象

```
$select = $this->dbTable->getSelectAuth();

$authAdapter
    ->setDbSelect($select)
    ->setIdentity($params['username'])
    ->setCredential($params['password'])
    ->setCredentialTreatment("SHA1(?)")
; 
```

# php - 获取 POST 请求的域

> ID：11347129
> 
> 赞同：3
> 
> 时间：2012-07-05T15:04:11.373
> 
> 标签：php, ajax, post

我有一个脚本可以从其他网站（不同的域）向我的网站发出***POST***请求，我需要知道是否有可能获取其他域。

喜欢：**helloworld.com使用我的脚本，并使用****mywebsite.com**执行***POST***请求。**mywebsite.com**如何知道请求来自**helloworld.com**？

 ******我试过了，`$_SERVER['REMOTE_HOST']`但这不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:06:57.587

您需要检查[HTTP 引荐来源网址](http://en.wikipedia.org/wiki/HTTP_referer)。

在 PHP 中，这将是`$_SERVER['HTTP_REFERER'];`.

在 JavaScript 中，这将是`document.referrer`.

请注意，它可能不准确并且很容易被欺骗，所以它的价值应该用少许盐来衡量。

* * *

*要提供有关如何可靠地*执行此操作的更多详细信息（尽管需要远程服务器的合作）：

1.  设`secret`为任意字符串 ( `abc123`)。
2.  让`key`是每个请求唯一的随机字符串（例如当前时间）
3.  `token`由生成`md5(secret + key)`。
4.  让远程服务器在 POST 请求中包含`key`和`token`（但**不包含）。** `secret`
5.  在您的服务器上，确保`md5(secret + key) === token`

因为没有人知道秘密，所以可以保证请求来自远程服务器。当然，有人可能*会*从远程服务器请求表单，窃取`key`and `token`，然后将请求转发给自己......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:07:10.940

你应该使用`HTTP_REFERER`. 但不能完全信任

```
$_SERVER['HTTP_REFERER'] 
```

看看这里，它记录在哪里：http: [//php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:07:44.027

采用

```
$_SERVER['HTTP_REFERRER'] 
```

获取发出请求的页面

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:08:05.017

你可以保存IP。`gethostbyaddr($ip)` 如果脚本自动执行，`$_SERVER['HTTP_REFERRER']`将不起作用。******

# iphone - 如何在目标中添加确认弹出窗口？

> ID：11347131
> 
> 赞同：0
> 
> 时间：2012-07-05T15:04:22.177
> 
> 标签：iphone, objective-c, xcode, ios5

就像 java 中的 JOptionPane 一样，当用户做某事时。我要求确认，你确定要删除文件吗？或无论如何。用户确认它然后我检测用户在两个按钮之间选择了什么然后我根据用户选择做一些事情

目标c中有这样的东西吗？链接请和一些指导方针

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:07:23.647

You are looking for UIAlertView controller.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T18:44:52.263

你想要做的是检查哪个按钮被点击`otherButtonTitles:`

像这样的东西：

```
UIAlertView *yourAlert = [[UIAlertView alloc] initWithTitle:@"Your title" message:@"Some String" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:@"Confirm",nil];  

 [yourAlert show]; 
```

并记住将委托设置为自我。

然后：

> ```
> - (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex {
> 
> if (buttonIndex == 0){
> 
>     //'Dismissing' code here
> 
> }
> 
> if (buttonIndex == 1){
> 
>     //Detecting whatever was under otherButtonTitles:
>     //Right now it's checking if the user clicked "Confirm" -> So here you can put whatever you need
>    NSLog(@"You clicked Confirm");
> 
>       } 
> ```
> 
> }

在条件下，您正在检查用户正在单击哪个按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:10:57.373

我相信你想要[`UIActionSheet`](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html)的，这是 Apple 推荐给用户的选择：

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Some Message" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:@"button To Destroy or nil" otherButtonTitles:@"Choice 1", @"Choice 2", @"Choice 3", nil]; 
```

# sql - 如何计算日期范围内的数据库元素？

> ID：11347133
> 
> 赞同：2
> 
> 时间：2012-07-05T15:04:24.663
> 
> 标签：sql, sql-server, reporting-services, group-by

在 SQL Server 过程中，我需要获取与某些约束匹配的所有行（简单的 where 条件），然后按月对它们进行分组。

目标是创建一个图表（在 Sql server 报告服务中），它显示所有数据。

我已经有这样的事情了：

```
Select Count(*) AS Count, Month(a.issueDate) AS Month, Year(a.issueDate) AS Year
FROM MyTable a
WHERE
....
GROUP BY YEAR(a.issueDate), MONTH(a.issueDate) 
```

我得到了我的数据，我得到了我的图表，但问题是如果我在“ `MyTable`”中没有任何符合我的`Where`条件的行，我将没有任何行。

结果是我有一个图表，从一月开始，跳过二月，然后显示三月。

我无法对数据进行后处理，因为它直接连接到 SQL Server Reporting Services 报表。

由于我对〜20个存储过程有这个问题，我会很感激有最简单的方法来做这件事。

非常感谢您的建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:10:42.943

假设您想要一个特定的年份：

```
DECLARE @year INT;
SET @year = 2012;

DECLARE @start SMALLDATETIME;
SET @start = DATEADD(YEAR, @year-1900, 0);

;WITH y AS (SELECT TOP (12) rn = ROW_NUMBER() OVER (ORDER BY [object_id])-1
  FROM sys.all_objects ORDER BY [object_id])
SELECT DATEADD(MONTH, y.rn, @start), COUNT(t.issueDate)
  FROM y
  LEFT OUTER JOIN dbo.MyTable AS t
  ON t.issueDate >= DATEADD(MONTH, y.rn, @start)
  AND t.issueDate < DATEADD(MONTH, y.rn + 1, @start)
GROUP BY DATEADD(MONTH, y.rn, @start); 
```

如果它不是特定年份，那么您可以稍微不同地覆盖任何日期范围，只要您提供第一个月的第一天和上个月的第一天（或传递 4 个整数并手动构建日期):

```
DECLARE @startdate SMALLDATETIME, @enddate SMALLDATETIME;
SELECT @startdate = '20111201', @enddate = '20120201';

;WITH y AS (SELECT TOP (DATEDIFF(MONTH, @startdate, @enddate)+1)
    rn = ROW_NUMBER() OVER (ORDER BY [object_id])-1
    FROM sys.all_objects ORDER BY [object_id]
)
SELECT DATEADD(MONTH, y.rn, @startdate), COUNT(t.issueDate)
  FROM y
  LEFT OUTER JOIN dbo.MyTable AS t
  ON t.issueDate >= DATEADD(MONTH, y.rn, @startdate)
  AND t.issueDate < DATEADD(MONTH, y.rn + 1, @startdate)
GROUP BY DATEADD(MONTH, y.rn, @startdate); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:11:17.543

在报表生成器中，右键单击日期轴，选择属性，然后将轴设置为日期范围，它将为您添加空列，您无需更改 SQL

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:11:30.023

您需要构建一个表格（一个表格变量在这里效果最好），其中包含从最小值到最大值的所有年/月组合。

然后，您需要将其与您的主查询交叉加入，以获得所有年份/月份的结果，以便为图表做好准备。

# ms-access - 我在哪里放置 Access vba 代码以仅在物理打印时触发？

> ID：11347139
> 
> 赞同：3
> 
> 时间：2012-07-05T15:04:39.373
> 
> 标签：ms-access, vba, ms-access-2003

我有一些代码要在用户实际打印报告时触发。不是在打印预览等时，而是仅在发送到打印机时。用户需要能够拉出报告并查看它，然后如果他们决定打印，vba 代码将接管并将一些信息写入与用于生成报告不同的表中。我希望不必在实际报告上放置一个打印按钮（即使我知道我可以隐藏它以进行打印），所以我想知道我是否可以以某种方式捕获打印对话框。

有没有人有幸这样做过？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T19:14:43.123

经过深思熟虑，我认为最好的方法是在报告页面事件期间识别活动窗口文本。在打印预览期间，此文本将是数据库本身的名称，例如“Microsoft Access - DatabaseName : Database (Access 2003)。在实际打印操作期间，活动窗口将为“打印”

我相信大部分代码来自[这个来源](http://msdn.microsoft.com/en-us/library/aa141354%28v=office.10%29.aspx)。

```
Declare Function GetActiveWindow Lib "user32" () As Long
Declare Function GetWindowText Lib "user32" Alias "GetWindowTextA" _
   (ByVal Hwnd As Long, ByVal lpString As String, ByVal cch As Long) As Long

Private Sub Report_Page()
On Error GoTo PrintError

    Dim strCaption As String
       Dim lngLen   As Long

       ' Create string filled with null characters.
       strCaption = String$(255, vbNullChar)
       ' Return length of string.
       lngLen = Len(strCaption)

       ' Call GetActiveWindow to return handle to active window,
       ' and pass handle to GetWindowText, along with string and its length.
       If (GetWindowText(GetActiveWindow, strCaption, lngLen) > 0) Then
          ' Return value that Windows has written to string.
          ActiveWindowCaption = strCaption
       End If

    If ActiveWindowCaption = "Printing" Then

        '
        ' Special activity goes here.
        '

    End If

    Exit Sub

PrintError:
    ' Just in case

End Sub 
```

# dns - 指向站点的 DNS 服务器说“所有者知道站点已关闭”？

> ID：11347140
> 
> 赞同：0
> 
> 时间：2012-07-05T15:04:44.287
> 
> 标签：dns

当我的网站出现故障时，我想更改我的注册商 DNS 设置以指向（例如）：

```
ns1.this_site_is_down.com
ns2.this_site_is_down.com
ns3.this_site_is_down.com
ns4.this_site_is_down.com 
```

这些名称服务器将为所有查询（甚至是 CNAME）返回一个具有低 TTL 的固定 IP，并且该 IP 地址上的网页将显示如下内容：

该网站的所有者知道它已关闭并正在努力修复它。修复网站后，您将不再看到此消息。

要使用此服务，请将您的 DNS 服务器设置为 ... [如上]

有这样的服务吗？

我意识到这个系统并不完美，但它会很有用。

[DNS 和“站点离线”消息](https://stackoverflow.com/questions/5872908/dns-and-site-is-offline-messages) 讨论了创建您自己的第二个名称服务器来执行此操作，但我希望使用现有的服务/服务器来执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:09:06.057

A 记录或 CNAME 记录不存在（您可以在此处获得的最接近的是使用循环，但这不能解决您的问题）。

您正在寻找一个优先级标签，该标签仅存在于 MX 记录中。

恐怕您最好的选择只是在服务器上发送一个带有 HTML 页面的 503 错误作为 ErrorDocument。

# javascript - facebook分享链接计数

> ID：11347144
> 
> 赞同：1
> 
> 时间：2012-07-05T15:04:56.390
> 
> 标签：javascript, facebook, twitter, count, share

有什么方法可以让用户数量在 facebook 和 twitter 上分享一些链接

示例：某个链接被分享到 facebook 和 twitter 的次数以计算某些内容的受欢迎程度

有一些 api 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:16:39.063

对于 facebook： http://graph.facebook.com/http: [//google.com](http://graph.facebook.com/http://google.com)和 twitter，您可以破解推文按钮的计数器，但它不是官方 API。

# jquery - 无法将焦点设置为 Chrome 扩展中的输入

> ID：11347149
> 
> 赞同：3
> 
> 时间：2012-07-05T15:05:09.087
> 
> 标签：jquery, google-chrome-extension

出于某种原因，我无法将焦点放在 popup.html 中的 texbox 上。这是我到目前为止所尝试的：

popup.html：

```
<input type="text" id="textbox" name="aName" value="" placeholder="blah" /> 
```

popup.js：

```
//Attempt 1
$(function() {      
    $('#textbox').focus();
});

//Attempt 2
setTimeout(function() { $('#textbox').focus(); }, 1000); 
```

我也尝试过不使用 javascript，只使用 autofocus 属性：

```
<input type="text" id="textbox" name="aName" value="" placeholder="blah" autofocus /> 
```

[但这些都不起作用......有](https://stackoverflow.com/questions/9646772/chrome-extension-popup-textarea-focus%22asas%22)什么想法吗？

笔记：

*   *popup.js 被调用，如果我把 console.log() 我得到输出*
*   *弹出窗口由我们在omnibar（default_icon）旁边的图标触发*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T21:39:51.007

我有同样的问题。我相信我可以通过在输入上设置一个明确的 tabindex 来让它工作，比如`tabindex=1`

请试一试，让我知道它是否有效。

**更新**

我有一个非常简单的例子对我有用。我在 Linux 上使用 Chrome 19。

*manifest.js*

```
{
"name": "Auto 'focus'",
    "version": "1.0",
    "manifest_version": 2,
    "description": "An extension to test setting focus",
    "browser_action": {
        "default_icon": "icon.png",
        "default_popup": "popup.html"
    }
} 
```

*popup.html*

```
<!doctype html>
<html>
  <head>
  </head>
  <body>
    <a href="#">Link</a>
    <input type="text" id="foo" tabindex="1" />
  </body>
</html> 
```

没有`tabindex="1"`焦点最初是在链接上。`tabindex="1"`焦点在输入元素上

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T18:10:24.367

最后我用的是这个：

popup.html：

```
<input type="text" id="textbox" name="aName" value="" placeholder="blah" autofocus /> 
```

popup.js：

```
$(function() {              
    if (location.search != "?focusHack") location.search = "?focusHack";
}); 
```

感谢**Tarek El-Mallah**和**PAEz**！！！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-05T16:07:14.317

这段代码适用于我，试试吧，这是一种解决方法

```
<!DOCTYPE >
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Sample Extens</title>
</head>
<body style="padding: 0px; margin: 0px;" >
    <script type="text/javascript" language="javascript">
        if (location.search !== "?foo") {
            location.search = "?foo";
            throw new Error;  // load everything on the next page;
            // stop execution on this page
        }
    </script>

    <div id="Def">
        <input type="text" id="textbox" name="aName" value="" placeholder="blah" />
        <script type="text/javascript" language="javascript">
            document.getElementById("textbox").focus();
        </script>
    </div>
</body>
</html> 
```

![在此处输入图像描述](../Images/bd0b6cd9c3c7d7212ba14c329ca4cccd.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T13:22:12.250

Tarek El-Mallah 重新加载弹出窗口的方法确实有效，但它对您不起作用，因为您使用 manifest_version : 2 并且不允许使用内联脚本...
[http://code.google.com/chrome/extensions/manifestVersion。 html](http://code.google.com/chrome/extensions/manifestVersion.html)
另外，这是一个已知问题....
[http://code.google.com/p/chromium/issues/detail?id=111660](http://code.google.com/p/chromium/issues/detail?id=111660)
以下是适用于 manifest_version 的版本：2.....

**清单.json**

```
{
  "name": "Browser Action PopUp focus/tab test",
  "version": "1.0",
  "description": "A test to show that on opening a popup you cant set focus and the tab index is not honored on the first select.  See, http://stackoverflow.com/questions/9070727/tab-key-not-working-in-popup-in-chrome-extension.",
  "browser_action": {
      "default_title": "Browser Action PopUp focus/tab test.",
      "default_icon": "icon.png",
      "default_popup": "popup.html"
  },
  "manifest_version" :2
} 
```

**popup.html**

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="popup.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Sample Extens</title>
</head>
<body style="padding: 0px; margin: 0px;" >
    <div id="Def">
        <input type="text" id="textbox" name="aName" value="" placeholder="blah" />
    </div>
</body>
</html> 
```

**popup.js**

```
if (location.search !== "?foo") {
    location.search = "?foo";
    throw new Error; // load everything on the next page;
    // stop execution on this page
}

function onLoad() {
    document.getElementById("textbox").focus();
}

window.onload = onLoad; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:07:59.480

Try this:

```
 autofocus="autofocus" 
```

You can also try this instead:

```
setTimeout(
    function() { 
        if(location.search !== "?aName") {
           location.search = "?aName";
           throw new Error; 
        }
    }, 1000); 
```

# nhibernate - SimpleInjector：注入不适用于 MVC 4 ASP.NET Web API

> ID：11347152
> 
> 赞同：3
> 
> 时间：2012-07-05T15:05:12.353
> 
> 标签：nhibernate, session, dependency-injection, registration, simple-injector

我有这个设置：

```
public static void Initialize(ISessionFactory factory)
{
    var container = new Container();
    InitializeContainer(container, factory);
    container.RegisterMvcControllers(
        Assembly.GetExecutingAssembly());
    container.RegisterMvcAttributeFilterProvider();
    container.Verify();
    DependencyResolver.SetResolver(
        new SimpleInjectorDependencyResolver(container));
}

private static void InitializeContainer(
    Container container, ISessionFactory factory)
{
    container.RegisterPerWebRequest<ISession>(
        () => factory.OpenSession(), true);
} 
```

Initialize 方法在以下位置调用`Application_Start`：

```
public class WebApiApplication : HttpApplication
{
    protected void Application_Start()
    {
        SimpleInjectorInitializer.Initialize(
            new NHibernateHelper(
                Assembly.GetCallingAssembly(), 
                this.Server.MapPath("/"))
                .SessionFactory);

        AreaRegistration.RegisterAllAreas();
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
    }
} 
```

但是当我尝试调用控制器操作时，我得到一个`ArgumentException`：

> 类型“PositionReportApi.Controllers.PositionsController”没有默认构造函数

堆栈跟踪：

> 在 System.Linq.Expressions.Expression.New(Type type) 在 System.Web.Http.Internal.TypeActivator.Create[TBase](Type instanceType) 在 System.Web.Http.Dispatcher.DefaultHttpControllerActivator.Create(HttpRequestMessage request, HttpControllerDescriptor控制器描述符，类型控制器类型）

我无法注册`ISession`.

如何注册由工厂创建的 ISession？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T17:02:36.477

从堆栈跟踪中，我可以看到您正在使用新的 .NET 4.5 ASP.NET Web API，并且 Simple Injector 不在显示的调用图中。这可能意味着您尚未将 Simple Injector 配置为与新的 Web API 一起使用，这与 MVC 所需的注册不同（出于某种奇怪的原因，我真诚地希望他们在最终版本中解决此问题）。由于您没有`System.Web.Http.Dependencies.IDependencyResolver`向 Web API 注册 Simple Injector 特定实现，因此`GlobalConfiguration.Configuration.DependencyResolver`您将获得默认行为，该行为仅适用于默认构造函数。

看看这个 Stackoverflow 答案[Simple Injector 是否支持 MVC 4 ASP.NET Web API？](https://stackoverflow.com/questions/11254292/does-simple-injector-supports-mvc-4-asp-net-web-api)了解如何使用新的 ASP.NET Web API 配置 Simple Injector。

**更新**

Note that you can get this exception *even* if you configured the `DependencyResolver` correctly, but when you didn't register register your Web API Controllers explicitly. This is caused by the way Web API is designed.

**Always register your Controllers explicitly.**

# android - 确保android服务执行

> ID：11347154
> 
> 赞同：2
> 
> 时间：2012-07-05T15:05:23.973
> 
> 标签：android, service, execution

我有一个从主要活动开始的 Android 服务。该服务非常简单，它有一个简单的时间任务，每 10-15 分钟检查一次有关某些信息的更新。

当 android 设备连接到 USB 时，任务完美执行，一切都很好。如果我拔下 USB 电缆，则不会执行任务。

为什么这仅在连接 USB 电缆时才有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:08:36.613

不建议为此任务使用服务，因为即使无事可做，服务也会在后台继续运行。最好的方法是使用 AlarmManager 来调用服务。以下是关于如何使用 AlarmManager 的教程：

[http://justcallmebrian.com/?p=129](http://justcallmebrian.com/?p=129)

当服务完成其任务时，您可以再次调度 AlarmManager。

# android - android-maven-plugin，仪器测试和 testSize

> ID：11347158
> 
> 赞同：4
> 
> 时间：2012-07-05T15:05:46.293
> 
> 标签：android, maven, integration-testing, instrumentation, android-maven-plugin

我正在使用 Maven 来构建、运行和测试我的 Android 应用程序。Android 测试框架具有三个不同的测试范围[@SmallTest](http://developer.android.com/reference/android/test/suitebuilder/annotation/SmallTest.html)、[@MediumTest](http://developer.android.com/reference/android/test/suitebuilder/annotation/MediumTest.html)和[@LargeTest](http://developer.android.com/reference/android/test/suitebuilder/annotation/LargeTest.html)，并且 android-maven-plugin 可以通过[testTestSize](http://maven-android-plugin-m2site.googlecode.com/svn/instrument-mojo.html#testTestSize)或[test/testSize](http://maven-android-plugin-m2site.googlecode.com/svn/instrument-mojo.html#test)参数选择测试范围。此参数可以是其中之一，`small|medium|large`并且可以从相关范围运行您的测试。

但是，如果我想同时运行小型和中型测试，不仅是小型测试还是中型测试，我该怎么办？这个问题的任何解决方案存在吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T11:01:16.437

[根据InstrumentationTestRunner API doc](http://developer.android.com/reference/android/test/InstrumentationTestRunner.html)，这就是 Android SDK 的设计方式和目前的工作方式：

> **运行所有小测试：** adb shell am instrument -w -e size small com.android.foo/android.test.InstrumentationTestRunner
> 
> **运行所有中等测试：** adb shell am instrument -w -e size medium com.android.foo/android.test.InstrumentationTestRunner
> 
> **运行所有大型测试：** adb shell am instrument -w -e size large com.android.foo/android.test.InstrumentationTestRunner

即使你使用普通的 adb 命令运行你的测试，你也必须使用两个进程分别运行中小型测试，一个接一个。Android Maven 插件只是 adb 命令的另一个包装器，因此无法通过 android-maven-plugin 配置 AFAIK 更改默认行为。

* * *

如果您更仔细地阅读[InstrumentationTestRunner API 文档](http://developer.android.com/reference/android/test/InstrumentationTestRunner.html)，您会注意到有一个有趣的命令用法：

> **过滤测试运行到带有给定注释的测试：** adb shell am instrument -w -e annotation com.android.foo.MyAnnotation com.android.foo/android.test.InstrumentationTestRunner
> 
> 如果与其他选项一起使用，生成的测试运行将包含两个选项的并集。例如，“-e size large -e annotation com.android.foo.MyAnnotation”将只运行带有 LargeTest 和“com.android.foo.MyAnnotation”注释的测试。

注释配置作为实验性 API 添加（标记为 @hide，有关更多详细信息，请查看[此版本历史记录](https://github.com/android/platform_frameworks_base/commit/88e03a97366d08fc69d852cf2219f9d0b1916af4)），并且尚未在[am instrument options list 中](http://developer.android.com/tools/testing/testing_otheride.html#AMOptionsSyntax)记录。从理论上讲，您可以创建自己的注释类（参见[SmallTest.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/1.6_r2/android/test/suitebuilder/annotation/SmallTest.java)示例），标记所有 @MediumTest 以及您的 @CustomizedTest 并使用 -e size 和 -e 注释来实现您想要的：同时从两个注释运行联合测试，全部在一个命令中。

不幸的是，android-maven-plugin 不支持注解配置，请参阅[插件文档](http://maven-android-plugin-m2site.googlecode.com/svn/instrument-mojo.html#test)和[最新源代码](http://grepcode.com/file/repo1.maven.org/maven2/com.jayway.maven.plugins.android.generation2/android-maven-plugin/3.2.0/com/jayway/maven/plugins/android/configuration/Test.java?av=f)。一种可能的解决方法是使用 exec-maven-plugin 运行普通`adb shell am instrument`命令。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T13:52:34.507

为了使用 maven-android 的测试大小，我在 pom.xml 中创建了一个变量：

```
...
<properties>
  <config.build.testSize>medium</config.build.testSize>
</properties>
... 
```

并在构建中执行以下操作：

```
<build>  
 <pluginManagement>
  <plugins>
   <plugin>
    <groupId>com.jayway.maven.plugins.android.generation2</groupId>
    <artifactId>android-maven-plugin</artifactId>
    ...
    <configuration>
     <test>
      <testSize>${config.build.testSize}</testSize>
     </test>
    </configuration>
    ...
   </plugin>
  </plugins>
 </pluginManagement> 
</build> 
```

我假设，您也可以通过将 android.test.testSize 参数提供给 maven 来实现这一点（如 mvn install -Dandroid.test.testSize=medium）

如果我错了，请更正这个 Maven 变量，在文档中还没有找到。BR，M。

# android - 如果有意导航返回，则始终调用 onCreate

> ID：11347161
> 
> 赞同：8
> 
> 时间：2012-07-05T15:05:54.210
> 
> 标签：android, back-stack, activity-stack

我有一个名为 HomeActivity 的活动，它有一个 SurfaceView 并显示一个相机预览图片。如果您正在启动/重新启动此活动，它会很安静并且感觉很慢。

因此，我进行了一些调查并发现，总是以某种方式调用 onCreate 方法。在我看来，如果活动已经开始，这不应该发生？

[文档](http://developer.android.com/reference/android/app/Activity.html)说：首次创建活动时调用。这是您应该进行所有常规静态设置的地方：创建视图、将数据绑定到列表等。此方法还为您提供了一个包含活动先前冻结状态的 Bundle（如果有的话）。始终跟在 onStart() 之后。

这是处理返回的方法：

```
protected void gotoHome() {
    final Intent intent = new Intent(SomeOtherActivity.this, HomeActivity.class);
    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    startActivity(intent);
} 
```

编辑：

这是我离开 HomeActivity 的方式......没什么特别的：

```
final Intent i = new Intent(HomeActivity.this, SomeOtherActivity.class);
startActivity(i); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-05T15:28:31.787

是的，当你想返回 HomeActivity 时，你需要使用这些标志：

```
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP|Intent.FLAG_ACTIVITY_SINGLE_TOP); 
```

这是 Intent.FLAG_ACTIVITY_CLEAR_TOP 文档中的相关部分：

> 上面示例中当前运行的活动 B 实例将在其 onNewIntent() 方法中接收您在此处启动的新意图，或者自身完成并使用新意图重新启动。如果它已声明其启动模式为“多重”（默认）并且您没有在同一意图中设置 FLAG_ACTIVITY_SINGLE_TOP，那么它将完成并重新创建；对于所有其他启动模式，或者如果设置了 FLAG_ACTIVITY_SINGLE_TOP，则此 Intent 将被传递到当前实例的 onNewIntent()。

# wordpress - 如何删除列表项目符号？

> ID：11347167
> 
> 赞同：0
> 
> 时间：2012-07-05T15:06:15.530
> 
> 标签：wordpress, css

我在删除在线简历上的列表项目符号时遇到问题。我尝试了以下方法：

```
.nobull {
  list-style: none; 
  list-style-type: none;
} 
```

并清除我的浏览器缓存。[这里是简历的链接。](http://smithdesign.us/tims-resume/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:34:45.830

您正在尝试在`p`标签上设置属性，您需要明确地在`ul`元素上设置类，或者将`ul`元素嵌入`p`标签内（我认为这是无效的标记，但我可能错了）。

```
ul.no-bull,
.no-bull ul
{
    list-style: none;
} 
```

或者，您可以对项目符号采用“选择加入”方法，这是大多数人倾向于做的；这使您不必添加`no-bull`到每个`ul`. 像这样的东西：

```
ul
{
    list-style: none;
    margin: 0;
}
ul.has-bullets
{
    list-style: none outside disc;
    margin-left: 18px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:08:15.033

```
ul {
  list-style-type:none !important;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:30:34.977

只是`list-style: none;`工作，但我看不到你在哪里使用课程`.nobull`

# iphone - What are my options for linking to a podcast from my iPhone app?

> ID：11347172
> 
> 赞同：2
> 
> 时间：2012-07-05T15:06:32.203
> 
> 标签：iphone, ios, itunes

Using the [iTunes Link Maker](http://itunes.apple.com/linkmaker?), and with reference to [this answer](https://stackoverflow.com/a/8709719/11575), I've created a test app that can launch the iTunes app and list the episodes of a given podcast:

```
NSString *address = @"itms://itunes.apple.com/<country code>/podcast/<podcast name>/id<numeric ID>?uo=4";
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:address]]; 
```

But what else is possible?

1.  From my app, can I launch the iTunes app to start downloading a particular podcast episode?
2.  From my app, can I launch the iTunes app to start streaming a particular podcast episode?
3.  From my app, can I launch Apple's new [Podcasts app](http://itunes.apple.com/us/app/podcasts/id525463029?mt=8) if the user has it installed?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T16:34:59.237

[3]。是的你可以。只是改变

```
itms://[url] 
```

对于以下任何一种形式：

```
itms-pcast://[url]
itms-pcasts://[url]
itms-podcast://[url]
itms-podcasts://[url] 
```

# windows - 打开应用程序时指向表格的特定部分

> ID：11347181
> 
> 赞同：0
> 
> 时间：2012-07-05T15:06:54.083
> 
> 标签：windows, qt, visual-c++, qtablewidget, qmainwindow

我正在使用 Qt 在 Windows 中开发应用程序。此应用程序显示一个包含一些数据的表格。根据特定行突出显示的时间。应用程序的窗口大小是固定的。行数超过了窗口的高度，所以我们必须向下滚动才能看到整个表格。我想实现这一点：当我打开应用程序时，它应该向我显示突出显示的行可见的表格部分。我不应该需要向上或向下滚动来搜索突出显示的行。但是行的顺序必须保持不变。你是怎样做的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:12:05.933

您需要做的就是从突出显示的行中获取任何项目，例如使用

```
QTableWidgetItem * QTableWidget::item ( int row, int column ) const 
```

然后你需要调用 QTableWidget 插槽

```
void QTableWidget::scrollToItem ( const QTableWidgetItem * item, 
                             QAbstractItemView::ScrollHint hint = EnsureVisible ) 
```

对于您之前获得的项目。

# regex - Regular expression in Python 2.7

> ID：11347186
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:03.960
> 
> 标签：regex, python-2.7

Another question :

I'm trying to search for a specific pattern in a fiel , but I have to deal with the following case :

This line returns a correct interpretation

```
f27 = re.findall( b'\x03\x00\x00\x27''(.*?)''\xF7\x00\xF0', s) 
```

but this one got badly interpreted as x28 is related to the '()' parenthesis

```
f28 = re.findall( b'\x03\x00\x00\x28''(.*?)''\xF7\x00\xF0', s) 
```

Traceback (most recent call last): File "", line 1, in File "D:\Portable Python 2.7.2.1\App\lib\re.py", line 177, in findall return _compile(pattern, flags).findall(string) File "D:\Portable Python 2.7.2.1\App\lib\re.py", line 244, in _compile raise error, v # invalid expression error: unbalanced parenthesis

I tried with several escapes '\' and '/' but no way !

Any solution ?

Thx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:29:52.493

尝试使用原始字节串。re 模块本身理解转义序列。

```
f28 = re.findall(br'\x03\x00\x00\x28(.*?)\xF7\x00\xF0', s) 
```

# php - Pluggable switch statements

> ID：11347188
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:05.767
> 
> 标签：php, wordpress-theming, switch-statement

I have the following switch statement:

```
switch($post->post_type) {

    default:

        echo 'default';

<?php } 
```

which in essence is about as basic as you can get. The `post->post_type` is simply a variable that will return a string depending on the post type of an item (WordPress).

What I'd like to be able to do is plug into the switch statement very similarly as someone would an array - like so:

```
function add_extra_fruits($fruits) {

$extra_fruits = array(
    'plums',
    'kiwis',
    'tangerines',
    'pepino melons'
);

// combine the two arrays
$fruits = array_merge($extra_fruits, $fruits);

return $fruits;
}
add_filter('add_fruits', 'add_extra_fruits'); 
```

using the `array_merge()` function.

I was given the following example to try:

```
switch ( true /* we're comparing a boolean, not the post type! */ ) {
    case has_action( "basey_loop_single_$post->post_type" ) :
        do_action( "basey_loop_single_$post->post_type" );
        break;

    default :
        // default post layout
} 
```

but I'm not sure if this accomplishes what I'm after as passing an example action, like so:

```
function basey_loop_single_page_output() {
    echo 'test';
}
add_action('basey_loop_single_page', 'basey_loop_single_page_output'); 
```

does not return anything when the `$post->post_type` condition is met as it is specified. Anyone have an idea of how this could be approached? At its simplest, this is a core PHP question (about plugging into a switch statement), but obviously some of the lingo here is more geared towards WordPress.

Thanks!

# jsf-2 - 不能在同一页面上使用复合组件与 ui:include 依赖于 ui:params

> ID：11347189
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:06.987
> 
> 标签：jsf-2

我有一个使用 ui:include 包含另一个页面的基本页面。ui:include 使用 ui:param 将参数传递给包含的页面。该参数在包含页面控制器的 PostConstruct 方法中读取。

在我将复合组件添加到基本页面之前，此设计工作正常；添加后，包含的页面控制器会报告 ui:param 的值为 null。一旦我从页面中删除复合组件， ui:param 就可以被包含页面的控制器读取（即不为空）。请帮忙！

* * *

**重现问题的文件：**

**我的页面.xhtml**

```
<html xmlns:ui="http://java.sun.com/jsf/facelets"   
      xmlns:mycomponents="http://java.sun.com/jsf/composite/mycomponents">

    <ui:include src="includePage.xhtml">
        <ui:param name="myParam" value="myValue"/>
    </ui:include>

    <p/>

    <mycomponents:myComponent/>

</html> 
```

**myIncludedPage.xhtml**

```
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets">

    The value of the param is: #{includedPageController.myParam}

</ui:composition> 
```

**myComponent.xhtml**（放置在“resources/mycomponents”中）

```
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:composite="http://java.sun.com/jsf/composite">

      <composite:interface/>

      <composite:implementation>
        I am the composite component
      </composite:implementation>

</html> 
```

**IncludedPageController.java**

```
@ManagedBean
public class IncludePageController
{
    String myParam;

    @PostConstruct
    private void init()
    {
        FaceletContext faceletContext = (FaceletContext)FacesContext.getCurrentInstance().
                getAttributes().get(FaceletContext.FACELET_CONTEXT_KEY);
        myParam = (String)faceletContext.getAttribute("myParam");               
    }   

    public String getMyParam()
    {       
        return myParam;
    }

    public void setMyParam(String myParam)
    {
        this.myParam = myParam;
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T20:01:19.477

请参阅：[如何将托管 Bean 字段设置为 ui:param 的值？](https://stackoverflow.com/questions/10982987/how-do-i-set-managed-bean-field-to-the-value-of-a-uiparam). 在 JSF API 中没有做这种事情的标准。应使用复合或自定义组件，而不是包含/参数标记组合。

# java - Nesting arbitrary objects in Java

> ID：11347192
> 
> 赞同：3
> 
> 时间：2012-07-05T15:07:12.223
> 
> 标签：java

I am having trouble solving a particular problem in Java (which I did not find by search). I do not know how to create a nested lists of objects - with a different type of object/primitive type at the end. For example:

**Note: only an example. I am actually doing this below with something other than Employee, but it serves as simple example.*

I have an array of an object Employee. It contains information on the Employee.

```
public class Employee {
    int age
    int salary
    int yearsWorking
    public Employee () {
        // constructor...
    }
    // Accessors
} 
```

What I need to do is organize the Employees by quantiles/percentiles. I have done so by the following:

```
import org.apache.commons.math.stat.descriptive.rank.Percentile;
public class EmployeeSort {
    public void main(String args[]) {
        Percentile p = new Percentile();
        Employee[] employeeArray = new Employee[100];
        // filled employeeArray
        double[] ageArray = new double[100];
        // filled ageArray with ages from employeeArray
        int q = 25; // Percentile cutoff
        for (int i = 1; i*q < 100; i++) {
            // assign percentile cutoff to some array to contain the values
        }
    }
} 
```

Now, the problem I have is that I need to organize the Employees first by the percentiles of age, then percentiles of yearsWorking, and finally by percentiles of salary. My Java knowledge is inadequate right now to solve this problem, but the project I was handed was in Java. I am primarily a python guy, so this problem would have been a lot easier in that language. No such luck.

Edit: So I notice some confusion on whether I need ordering, and some people suggesting use of Comparator. I use Comparator because percentiles requires an ordered list. The problem I am having is how to store the binning of the Employee into their appropriate percentile. To clarify, I need the Employee object binned together into their appropriate percentile by age. Then, within that bin of age, I need to bin all those Employee objects within percentiles for Employee.yearsWorking. Following that, within a given percentile bin of yearsWorking which is within a given percentile bin of Employee.age, I need to create percentile bins of Employee.salary.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:31:06.517

您应该使用[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html) 代替 Arrays。

```
ArrayList<Employee> employeeList= new ArrayList<Employee>();

for (int i = 0, i <= employeeArray.length; i++)
    employeeList.add(employeeArray[i]); 
```

现在写下自定义[比较器](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Comparator.html)

```
public class EmployeeComparatorByAge<Employee>
{
    public int compare(Object o1, Object o2)
    {
        if (o1 != null && o2!= null && o1 instanceof Employee && o2 instanceof Employee )
            return ((Employee)o1).age - ((Employee)o2).age;
        else
            return -1;
    }
} 
```

同样，您可以编写其他比较。

现在要对它们进行排序，请使用：

```
Collections.sort(employeeList, new EmployeeComparatorByAge<Employee>()); 
```

这将解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:13:43.837

您可能想阅读此链接以了解[Java 中的对象排序](http://docs.oracle.com/javase/tutorial/collections/interfaces/order.html)

您要做的下一件事是使用 ArrayList 并将您的所有员工添加到其中。然后你会想做这样的事情：

```
ArrayList<Employee> employeeList= new ArrayList<Employee>();
/**
  * Add your employee objects to the list
  */

Collections.sort(contacts, new Comparator<Employee>() {
    public int compare(Employee emp1, Employee emp2) {
        int returnValue;
        /**
         * Your comparison logic
         */

        return returnValue;
    }
}); 
```

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T17:20:18.930

如上所述，将 Arrays.sort() 与不同的 Comparator 实现一起使用。请记住，此方法（以及 Collections.sort()）对数据进行操作。因此，如果您需要不断获取数据的不同视图，您可能需要复制数组并以不同方式对其进行排序，并保留每个视图。

这将比不断重新排序数组更有效（CPU 方面）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:11:44.033

查看 java.util.Comparator<T> （在这种情况下， T 将是您的 Employee 类型）

您可以创建不同的比较器并使用 Collections.sortList 或 Arrays.sort(...) （这些方法是伪方法 - 从文档中查找确切版本）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:12:35.777

代替数组使用 an`ArrayList`来保存您的员工。然后，您可以使用`Collections.sort()`对该列表进行排序。sort() 有两个版本，其中一个采用`Comparator`允许您按所需顺序排序的版本。

# c++ - 在用 C++ 创建目录之前检查它是 windows 还是 unix

> ID：11347194
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:20.887
> 
> 标签：c++, operating-system

我写了这段代码来检查一个目录是否在 Windows 和 Unix 中都存在，但我不确定它是否正确：

```
int writeFiles(std::string location)
{

        // USED TO FILE SYSTEM OPERATION
        struct stat st;
        // DEFINE THE mode WHICH THE FILE WILL BE CREATED
        const char * mode = "w+b";
        /* local curl variable */

        // CHECK IF THE DIRECTORY TO WHERE THE FILE ARE GOING EXIST
        // IF NOT, CREATE IT
        if(stat(location.c_str(), &st) != 0){
                #ifndef (defined  _WIN32 || defined __WIN64)    /* WIN32 SYSTEM */
                if (!CreateDirectory(location.c_str(), NULL)){
                        std::string msg("The location directory did not exists, can't be created\n");
                        throw std::runtime_error(msg);
                }
                #elif defined __unix__          /* in the case of unix system */
                if(mkdir(location.c_str(), S_IRWXU) != 0){
                        std::string msg("The dest_loc directory did not exist, can't be created\n");
                        throw std::runtime_error(msg);
                }
                #endif

 ... more code down here. 
```

`location`是应该复制文件的路径。但是，在开始复制文件之前，我必须检查目录是否存在，无论是 Windows 还是 Linux。有人可以就这个问题给我一些意见吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:14:59.680

预处理器指令（参见[Microsoft Predefined Macros](http://msdn.microsoft.com/en-us/library/b0084kay%28v=vs.80%29.aspx)列表）我会写成：

```
#ifdef _WIN32

#else

// Assume UNIX system,
// depending on what you are compiling your code on,
// by that I mean you only building on Windows or UNIX
// (Linux, Solaris, etc) and not on Mac or other.
#endif 
```

如果目录已经存在，[`CreateDirectory()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363855%28v=vs.85%29.aspx)则将失败（返回`FALSE`），但会将最后一个错误设置为`ERROR_ALREADY_EXISTS`. 更改您的使用`CreateDirectory()`以正确处理此问题：

```
if (!CreateDirectory(location.c_str(), NULL) &&
    ERROR_ALREADY_EXISTS != GetLastError())
{
    // Error message more useful if you include last error code.
    std::ostringstream err;
    err << "CreateDirectory() failure on "
        << location
        << ", last-error="
        << GetLastError();

    throw std::runtime_exception(err.str());
} 
```

话虽如此，如果您可以访问 boost 考虑使用该[`boost::filesystem`](http://www.boost.org/doc/libs/1_50_0/libs/filesystem/doc/index.htm)库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T16:19:56.173

你需要改变：

```
 #ifndef (defined  _WIN32 || defined __WIN64)    /* WIN32 SYSTEM */ 
```

到：

```
 #if (defined _WIN32 || defined __WIN64)    /* WIN32 SYSTEM */ 
```

这将测试是否定义了`_WIN32`或`__WIN64`，如果是则使用 WINAPI 代码。

您可能还可以更改：

```
 #elif defined __unix__          /* in the case of unix system */ 
```

只是：

```
 #else          /* in the case of non-Windows system */ 
```

因为大多数非 Windows 操作系统可能有 POSIX-ish API`mkdir`等，而您目前没有任何其他操作系统特定的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:12:45.033

如果我必须编写与文件系统交互的跨平台代码，我会使用跨平台文件系统 API，例如[Boost FileSystem](http://boost.sourceforge.net/libs/filesystem/doc/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:18:19.727

如果你可以假设 Windows 有`stat()`，为什么你不能也只是使用`mkdir()`呢？

但实际上，在 Windows 上，您可以`CreateDirectory`无条件调用（没有前面的`stat`调用）并检查是否`GetLastError()`返回`ERROR_ALREADY_EXISTS`.

此外，`std::string`是 ANSI 函数的匹配项，`CreateDirectoryA`. 使用`CreateDirectory`宏会使您面临 Unicode 不匹配的问题。

# python - __iter__() 实现为生成器

> ID：11347196
> 
> 赞同：11
> 
> 时间：2012-07-05T15:07:23.583
> 
> 标签：python, iterator, generator, dispatch

我有一个对象子类，它`__ iter __`使用缓存生成器实现动态调度（我还有一个使 iter 缓存无效的方法），如下所示：

```
def __iter__(self):
    print("iter called")
    if self.__iter_cache is None:
        iter_seen = {}
        iter_cache = []
        for name in self.__slots:
            value = self.__slots[name]
            iter_seen[name] = True
            item = (name, value)
            iter_cache.append(item)
            yield item           
        for d in self.__dc_list:
            for name, value in iter(d):
                if name not in iter_seen:
                    iter_seen[name] = True
                    item = (name, value)
                    iter_cache.append(item)
                    yield item
        self.__iter_cache = iter_cache
    else:
        print("iter cache hit")
        for item in self.__iter_cache:
            yield item 
```

它似乎正在工作......有什么我可能不知道的陷阱吗？我在做一些可笑的事情吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T15:31:05.533

`container.__iter__()`返回一个迭代器对象。迭代器对象本身需要支持以下两种方法，它们共同构成了迭代器协议：

```
iterator.__iter__() 
```

返回迭代器对象本身。

```
iterator.next() 
```

从容器中返回下一个项目。

这正是每台发电机所拥有的。所以不要害怕任何副作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:26:57.147

这似乎是一种非常脆弱的方法。在活动迭代期间更改任何 __slots、__dc_list、__iter_cache 足以使对象进入不一致状态。

您需要在迭代期间禁止更改对象或一次生成所有缓存项并返回列表的副本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T16:09:44.193

将对象的迭代与其返回的值的缓存分开可能会更好。例如，这将简化迭代过程并允许您轻松控制缓存的完成方式以及是否启用缓存。

另一个*可能*重要的考虑因素是，您的代码无法预测性地处理被迭代的对象在对方法的连续调用之间发生变化的情况。处理这个问题的一个简单方法是在第一次调用时完全填充缓存的内容，然后`yield`为每次调用填充缓存的内容——并记录行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T16:37:19.120

你在做什么是有效的，尽管很奇怪。什么是a`__slots`或a `__dc_list`？？通常最好用属性名称而不是类型来描述对象的内容（例如：self.users 而不是 self.u_list）。

你可以使用我的[LazyProperty](https://github.com/bukzor/RefactorLib/blob/41a71c/refactorlib/util.py)装饰器来大大简化它。

只需使用 @LazyProperty 装饰您的方法。它将被第一次调用，然后装饰器将用结果替换属性。唯一的要求是该值是可重复的；它不依赖于可变状态。您在当前代码中也有这个要求，您的 self.__iter_cache。

```
def __iter__(self)
    return self.__iter

@LazyProperty
def __iter(self)
    def my_generator():
        yield whatever
    return tuple(my_generator()) 
```

# matlab - 缺少/可选值的 xml2struct

> ID：11347198
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:26.843
> 
> 标签：matlab

我正在使用 xml2struct 将 xml 文件转换为结构。可能是某些可选节点在 xml 文件中不存在。我想检测到这一点并将“NULL”字段插入到结构中。我知道 MATLAB 中没有 NULL 。所以我想知道有经验的用户倾向于用什么来表示缺失/可选值。

我正在使用这些数据类型：

```
char
logical
double 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T17:42:09.600

我倾向于偏爱`NaN`或留白`''`。现在允许使用`NaN`for a logical 您将数据类型更改为 double 并创建一个需要测试`1`or`0`而不是`True`or的场景`False`。

# plone - 设置最大值 原型文件字段的上传大小

> ID：11347200
> 
> 赞同：1
> 
> 时间：2012-07-05T15:07:30.900
> 
> 标签：plone

如何限制上传到 Archetypes FileField 的文件的大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T16:12:46.690

ATContentTypes 注册一个`checkFileMaxSize`验证器：

```
from Products.validation.config import validation
from Products.validation.validators.SupplValidators import MaxSizeValidator

validation.register(MaxSizeValidator('checkFileMaxSize',
                                     maxsize=zconf.ATFile.max_file_size)) 
```

`zconf.ATFile.max_file_size`默认为“无限制”，但您可以通过复制并设置参数`Products/ATContentTypes/etc/atcontenttypes.conf.in`来更改它：`$INSTANCE_HOME/etc/atcontentypes.conf``max_file_size`

```
<archetype ATFile>
   # maximum file size in byte, kb or mb
   max_file_size 10mb
</archetype> 
```

（格式`gb`也支持，但默认文件不包括在列表中）。

如果您有自定义文件字段（以上仅适用于默认的 Archetypes ATFile 架构），您可以重新使用该验证器或创建自己的验证器。要重用上述验证器，只需将其添加到`validators`属性中：

```
from Products.validation import V_REQUIRED

FileField('yourfilefield',
    # ...
    validators = (
        ('isNonEmptyFile', V_REQUIRED),
        ('checkFileMaxSize', V_REQUIRED)
    ),
) 
```

要使用您独立配置的不同最大大小，请使用`MaxSizeValidator`ATContentTypes 使用的相同大小并以新名称注册它，然后使用该验证器而不是`'checkFileMaxSize'`验证器；您指定的值是[兆](https://en.wikipedia.org/wiki/Mebibytes)字节数（1024 ²个字节）：

```
from Products.validation.config import validation
from Products.validation.validators.SupplValidators import MaxSizeValidator

validation.register(MaxSizeValidator('checkFileMax50mb', 50)) 
```

# ios - ios更改导航栏高度导致leftBarButtonItem不居中

> ID：11347202
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:33.763
> 
> 标签：ios, height, center, uibarbuttonitem, navigationbar

我正在开发一个需要导航栏高度大于默认值的项目。

这就是我设置导航栏高度的方式：

```
- (CGSize)sizeThatFits:(CGSize)size {
if (iPad) {
    CGSize newSize = CGSizeMake(768,86);
    return newSize;
}
return CGSizeMake(320, 44);} 
```

我为导航栏设置了一个背景图像，这工作正常。

问题是后退按钮和右键项目没有居中。

有谁知道如何使它们居中？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:15:46.327

操纵导航栏的高度通常是不好的做法。我尝试为一个项目采用多种不同的方法，每种方法都有一个“陷阱”。也就是说，导航按钮总是对齐到导航栏的底部，因此调整它的高度会使按钮看起来像是在向导航栏的底部渲染。当您按下和弹出其他控制器时，按钮会出现奇怪的动画。我建议不要调整导航栏的高度。

# javascript - 来自变量的 Javascript 属性

> ID：11347203
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:33.510
> 
> 标签：javascript, variables, object, properties

我的 JavaScript 代码有问题。我现在从一些更复杂的事情开始，似乎在网上找到了一些答案，但不幸的是我无法修复它。问题是：

我想要变量`sGetMobileField`并`ValMob`获取参数，但是像这样它不起作用：

```
var oFieldValues = { sGetMobileField:) { Value: ValMob } }; 
```

变量似乎不能用作对象属性。任何人都可以帮我解决它吗？

谢谢，戴恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:09:20.727

试试这个

```
var oFieldValues = { };
oFieldValues[ sGetMobileField ] = { Value: ValMob }; 
```

您可以将变量用作属性标识符，但不能在对象文字中使用。您必须先创建对象，然后可以使用添加动态属性

```
obj[ varToHoldPropertyName ] = someValue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:24:42.597

首先语法看起来不正确。我猜后面的“）”`sGetMobileField:`是一个错字。但是，您在这里所做的是设置一个名为“sGetMobileField”的属性：

```
var oFieldValues = { sGetMobileField: { Value: ValMob } }; 
```

正是出于同样的原因，`Value`您设置了一个名为“Value”的属性，而不是从`Value`变量中获取其名称的属性。这是一致的，对吧？所以你将拥有：

```
console.log(oFieldValues.sGetMobileFields.Value) // the content of ValMob. 
```

幸运的是，在 JS 中，您可以使用方括号表示法而不是点表示法。这意味着，您可以使用字符串访问属性。因此，例如：

```
console.log("Hello"); 
```

是相同的：

```
console["log"]("Hello"); 
```

因此，您可以使用变量的值来指定要访问的对象的属性。在你的情况下：

```
var oFieldValues = {};

oFieldValues[sGetMobileField] = { Value: ValMob }; 
```

请注意，遵循 JS 中通常使用的命名约定，`Value`应该是`value`并且`ValMob`应该是`valMob`.

# asp.net - Combining data from two SQL queries

> ID：11347208
> 
> 赞同：0
> 
> 时间：2012-07-05T15:07:59.083
> 
> 标签：asp.net, sql, sql-server, webforms

I'm porting my app from Django to ASP.NET Webforms (against my will, but what can we do with the corporate world..), and I'm used to Django generating all my SQL queries so now I need help. I have 3 tables: `proceso`,`marcador`,`marcador_progreso`

Every `proceso` has many `marcador_progreso`, which in turn is the foreign key table to `marcador`.

So basically the tables look like:

```
proceso
    id

marcador
    id
    text

marcador_progreso
    id
    marcador_id
    proceso_id
    state 
```

For all the `marcador_progreso` where its `proceso_id` is the current proceso (from a QueryField in the URL), I need to list its `state` and it's respective `marcador.text`. I've been working with EntityFramework but this is like a double query so I'm not sure how to do it.

I guess it is something that combines the following two statements, but I'm not sure how to do it.

```
SELECT [state] FROM [marcador_progreso]
SELECT [text] FROM [marcador] WHERE ([id] = marcador_id) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:11:23.813

You want to do a JOIN:

```
SELECT mp.state, m.text
FROM marcador_progreso as mp
INNER JOIN marcador as m
ON mp.marcador_id = m.id 
```

This is an [excellent post](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html) that goes over the various join types.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:15:22.630

You'll want to know about `JOIN`s to call more than one table in your `FROM` clause. `JOIN` combines records from two or more tables in a database by using values common to each. There are different types - the SQL example below is an `INNER` join, which gets only records where both of the tables have a match on the common value. You may want to consider a `LEFT` join which would get any records that exist for the `LEFT` table (in this case marcador), even if there are not any matching record in the `RIGHT`(marcador_progreso ) table. Pop the below in Management Studio, Play with different joins. Replace the `INNER` with `LEFT`, run it without the `WHERE`. Read about `JOIN's.

In general, for your new venture of writing your own queries, they all start with the same basic structure: *SELECT (UPDATE,WHATEVER DML statement, etc) (COLUMNS)* what you want to display (update,etc)
*FROM (TABLE)* where those records live *WHERE (FILTER/LIMIT)* conditions that must be met by the data Happy fetching!

SQL:

```
DECLARE @ProcessoId int
SET @ProcessoId = --1

SELECT m.[STATE],mp.[TEXT] 
FROM marcador M
INNER JOIN marcador_progreso MP ON MP.marcador_id = m.id
WHERE proceso_id =  @ProcessoId 
```

EF INNER example

```
var marc = from m in yourcontext.marcador
           join mp in yourcontext.marcador_progreso on m.id equals mp.marcador_id
           where proceso_id ==  processoIdvariable 
```

EF LEFT example

```
 var marc = from m in yourcontext.marcador
           join mp in yourcontext.marcador_progreso on m.id equals mp.marcador_id into details
           from d in details.DefaultIfEmpty()
           where proceso_id ==  processoIdvariable 
```

# java - Where can I find the Java source code for the Vigenere cipher?

> ID：11347211
> 
> 赞同：6
> 
> 时间：2012-07-05T15:08:07.337
> 
> 标签：java, android, encryption, vigenere

in my app I wanted to implement some enciphering. Therefore I need the code for the Vigenere cipher. Does anyone know where I can find that source code for Java?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T15:23:31.047

这是 Vigenere cipher Class，你可以使用它，只需调用加密和解密函数：代码来自[Rosetta Code](http://rosettacode.org/wiki/Vigen%C3%A8re_cipher#Java)。

```
public class VigenereCipher {
    public static void main(String[] args) {
        String key = "VIGENERECIPHER";
        String ori = "Beware the Jabberwock, my son! The jaws that bite, the claws that catch!";
        String enc = encrypt(ori, key);
        System.out.println(enc);
        System.out.println(decrypt(enc, key));
    }

    static String encrypt(String text, final String key) {
        String res = "";
        text = text.toUpperCase();
        for (int i = 0, j = 0; i < text.length(); i++) {
            char c = text.charAt(i);
            if (c < 'A' || c > 'Z') continue;
            res += (char)((c + key.charAt(j) - 2 * 'A') % 26 + 'A');
            j = ++j % key.length();
        }
        return res;
    }

    static String decrypt(String text, final String key) {
        String res = "";
        text = text.toUpperCase();
        for (int i = 0, j = 0; i < text.length(); i++) {
            char c = text.charAt(i);
            if (c < 'A' || c > 'Z') continue;
            res += (char)((c - key.charAt(j) + 26) % 26 + 'A');
            j = ++j % key.length();
        }
        return res;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:18:49.607

这是一个 Vigenere Cipher Code implementation [Sample Java Code to Encrypt and Decrypt using Vigenere Cipher](http://silabsoft.org/programming/java-implementation-of-the-vigenere-cipher/)的链接，此外我不建议使用 Vigenere Cipher 作为加密。

我推荐[jBCrypt](http://www.mindrot.org/projects/jBCrypt/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-21T16:57:04.420

[这篇](http://www.cipherbase.co.in/2014/02/breaking-vigenere-cipher-java.html)文章将为您提供帮助。提供了完整的解密代码。您可以使用它来编写加密代码

# excel - the if formulae

> ID：11347216
> 
> 赞同：0
> 
> 时间：2012-07-05T15:08:29.813
> 
> 标签：excel, excel-formula

creating a excel template for poker. in it i will have say a cell (which represents my hand) that has say 98o which represents a nine and eight off suit.

In another table will show the potential hands that my opponent could have.

there are 6 ways of having a pair of nines and 6 ways of having a pair of eights. But since i am holding an 8 and 9, now there only 4 ways of holding a pair of nines and four ways of holding a pair of eights.

Thus i want a logical formulae that asks

```
=if((there is a 9 in cell a1), 4, 6) 
```

cheers

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:10:19.490

很容易找出 A1 是否为 9：

```
=IF(A1 = 9, 4, 6) 
```

如果您的意思是要查看 in 中的值是否`A1` *包含*9，那么您需要：

```
=IF(FIND(A1,"9"), 4, 6) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:56:39.537

这个公式可以帮助你：

```
=IF(COUNTIF(A1,"*9*")>0,4,6) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:53:22.967

我环顾四周，这似乎有效。

=IF(ISERROR(FIND("9", H2))=TRUE, 6, 3)

任何人都知道更简单的事情

# c# - Reading Data from a File as it grows

> ID：11347219
> 
> 赞同：1
> 
> 时间：2012-07-05T15:08:40.340
> 
> 标签：c#

I have a binary data file that is written to from a live data stream, so it keeps on growing as stream comes. In the meanwhile, I need to open it at the same time in read-only mode to display data on my application (time series chart).

Opening the whole file takes a few minutes as it is pretty large (a few 100' MBytes).
What I would like to do is, rather than re-opening/reading the whole file every x seconds, read only the last data that was added to the file and append it to the data that was already read.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:16:57.533

我建议使用**FileSystemWatcher**来通知文件的更改。从那里缓存事件之间的文件大小等信息，并添加一些逻辑以仅响应整行等。您可以使用 FileStream 类的 Seek() 方法跳转到文件中的特定点并读取只有从那里。我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:15:36.820

如果您控制此文件的写入，我会将其拆分为多个预定义大小的文件。

当作者确定当前文件大于 50MB 时，关闭它并立即创建一个新文件来写入数据。写入此数据的进程应该始终知道要将接收到的数据写入的*当前文件。*

读取器线程/进程将按顺序读取所有这些文件，当当前文件被完全读取时跳转到下一个文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:18:55.537

您可能可以使用 FileSystemWatcher 来监视文件中的更改，例如此处给出的示例：[Reading changes in a file in real-time using .NET](https://stackoverflow.com/questions/86534/reading-changes-in-a-file-in-real-time-using-net)。

但我建议您评估另一种解决方案，包括队列，如 RabbitMQ 或 Redis - 任何具有订阅者-发布者模型的队列。然后，您只需将实时数据推送到队列中，并且将有 2 个不同的侦听器（订阅者） - 一个用于保存在文件中，另一个用于处理最后附加的数据。通过这种方式，您可以更灵活地分配应用程序的负载。

# java - 如何将字符串转换为int数组

> ID：11347228
> 
> 赞同：1
> 
> 时间：2012-07-05T15:08:47.913
> 
> 标签：java

您好如何将 String 转换为 int 数组。我需要它来进行一些加密。只是一个转换为 32 位值的字符串。

我试过了，但没有用。也许将 String 转换为 BigInteger 然后将其转换为原始 String 然后转换为 int 数组会起作用吗？

```
String s = "Alice";
int[] tab = s.getBytes(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:13:29.760

如果您要将 String 转换为 int 数组，请阅读[Joel 关于 String encoding 的文章](http://www.joelonsoftware.com/articles/Unicode.html)，它并不像您想象的那么明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:27:55.360

我认为这样的事情对你有用：在这里找到它：http: [//pro-programmers.blogspot.com/2011/05/java-byte-array-into-int-array.html](http://pro-programmers.blogspot.com/2011/05/java-byte-array-into-int-array.html)

```
public int[] toIntArray(byte[] barr) { 
        //Pad the size to multiple of 4 
        int size = (barr.length / 4) + ((barr.length % 4 == 0) ? 0 : 1);       

        ByteBuffer bb = ByteBuffer.allocate(size *4); 
        bb.put(barr); 

        //Java uses Big Endian. Network program uses Little Endian. 
        bb.order(ByteOrder.BIG_ENDIAN); 
        bb.rewind(); 
        IntBuffer ib =  bb.asIntBuffer();         
        int [] result = new int [size]; 
        ib.get(result); 

        return result; 
} 
```

调用它：

```
String s = "Alice";     
int[] tab = toIntArray(s.getBytes()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:11:26.320

尝试 ：

```
String s = "1234";
int[] intArray = new int[s.length()];

for (int i = 0; i < s.length(); i++) {
    intArray[i] = Character.digit(s.charAt(i), 10);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:12:08.793

更改为字节：`byte[] tab = s.getBytes();`

```
final String s = "54321";
final byte[] b = s.getBytes();
for (final byte element : b) {
    System.out.print(element+" ");
} 
```

输出 ：

> 53 52 51 50 49

**编辑**

`(int)`cast 被 Eclipse 删除`System.out.print((int) element+" ");`

除非你想投`int myInteger = (int) tab[n]`，否则你必须复制`byte[]`一个新的 `int[]`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:26:01.417

```
 String s = "Alice";
        byte[] derp = s.getBytes();

        int[] tab = new int[derp.length];

        for (int i=0; i< derp.length; i++)
            tab[i] = (int)derp[i]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T15:27:24.090

没有编码就不能将字符串转换为字节。
您需要使用这个已经存在的方法：

```
public static final byte[] getBytesUtf8( String string )
  {
      if ( string == null )
      {
          return new byte[0];
      }

      try
      {
          return string.getBytes( "UTF-8" );
      }
      catch ( UnsupportedEncodingException uee )
      {
          return new byte[]
              {};
      }
  }
} 
```

然后将其更改为 int 数组，如下所示： `byte[] bAlice`

```
int[] iAlice = new int[bAlice.length];

for (int index = 0; index < bAlice.length; ++index) {
     iAlice [index] = (int)bAlice[index];
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-05T15:48:37.853

[扩大原始转换](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.2)的规则不适用于原始类型的数组。例如，在 Java 中将一个字节分配给一个整数是有效的：

```
byte b = 10;
int i = b; //b is automatically promoted (widened) to int 
```

但是，原始数组的行为方式不同，因此，您不能假设数组 of`byte[]`会自动提升为 数组`int[]`。

但是，您可以手动强制提升字节数组中的每个项目：

```
String text = "Alice";
byte[] source = text.getBytes();
int[] destiny = new int[source.length];
for(int i = 0; i < source.length; i++){
    destiny[i] = source[i]; //automatically promotes byte to int.
} 
```

对我来说，这将是最简单的方法。

# jquery - YouTube JSON 分页 (jQuery)

> ID：11347230
> 
> 赞同：0
> 
> 时间：2012-07-05T15:08:49.527
> 
> 标签：jquery, youtube, pagination

我正在尝试创建一个函数来加载 15 个新结果并将它们附加到之前使用 jQuery 加载的结果下方，有没有办法？

Javascript：

```
$(document).ready(function() {
    startindex = 1;
    loadmore = 15;

    src = "https://gdata.youtube.com/feeds/api/videos?category=games&alt=json-in-script&max-results=12&start-index=" + startindex;

    $.ajax({
        dataType: "jsonp",
        url: src,
        success: function(data, textStatus, jqXHR) {
            if (data.feed && data.feed.entry) {
                var list = [];

                $.each(data.feed.entry, function(i, e) {
                    list.push([
                        '<li class="video">',
                        '<img src="http://img.youtube.com/vi/' + e.id.$t + '/default.jpg" />',
                        '<a href="' + e.link[1].href + '">',
                        '<span>' + e.title.$t + '</span>',
                        '</a>',
                        '<span>' + e.author[0].name.$t + '</span>',
                        '</li>'
                    ].join(""));
                });

                $("#list").html(list.join(""));
            }
        }
    });

    function loadMore() {
        var startindex = parseInt(startindex) + parseInt(loadmore);
    }

}); 
```

HTML：

```
<ol id="list"></ol> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:21:15.863

您要做的是将您内部的大部分代码转换`$(document).ready()`为一个独立的函数，然后您可以在内部调用它`$(document).ready()`。该函数将采用两个参数，即开始位置和记录总数。

开始位置很容易通过计算您的 中已有项目的数量来获得`<ol>`，并且正在获取的记录总数将（大概）永远不会改变。

```
$(document).ready(function() {
  startindex = 1;
  loadmore = 15;
  addMore(startindex, loadmore);

  $('#addmore').on('click', function(e) {
    e.preventDefault();
    addMore($('#list li').length, 15);
  });
});

function addMore(startindex, loadmore) {
  src = "https://gdata.youtube.com/feeds/api/videos?category=games&alt=json-in-script&max-results=" + loadmore + "&start-index=" + startindex;

  $.ajax({
    dataType: "jsonp",
    url: src,
    success: function(data, textStatus, jqXHR) {
      if (data.feed && data.feed.entry) {
        var $list = $('#list');

        $.each(data.feed.entry, function(i, e) {
          $list.append('<li class="video"><a href="' + e.link[1].href + '"><span>' + e.title.$t + '</span></a><span>' + e.author[0].name.$t + '</span></li>');
        });
      }
    }
  });
}
```

```
ol {
    list-style: decimal;
    margin-left: 2em;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<ol id="list"></ol>
<a href="#" id="addmore">Add more</a>
```

[http://jsfiddle.net/mblase75/PC6dn/1/](http://jsfiddle.net/mblase75/PC6dn/1/)

# mongodb - 用于分析或趋势仪表板的 MongoDB 模式设计

> ID：11347232
> 
> 赞同：2
> 
> 时间：2012-07-05T15:08:59.477
> 
> 标签：mongodb

目前正在开发 POC 以从 RDBMS 迁移并评估 MongoDB，在做模式的过程中，并希望确保它满足我们的需求。

一些背景 - 我们每天处理 +-100,000 个文件 - 大约 10 种不同的文件类型（将进入不同的集合） - 每天 +1 亿条记录 - 文件是管道分隔文本 - 将使用 python 加载数据 - 每个文件包含 100-250 个字段

当前设置 - 每个文件类型都加载到它自己的表中（按天分区），即文件类型 A 将在 FileA 中（分区 20120701）文件类型 B 将在 FileB 中（分区 20120701）等。

*   我们每 5-10 分钟运行一次数据汇总（每小时趋势）
*   我们每天运行一项工作来汇总数据（用于每日趋势）
*   没有对数据进行连接等

我已经包含了源数据的修剪文件（删除的字段和记录），以及 4 个不同的数据结构选项。我目前的设计是：

1.  每天收集每种文件类型（详细记录）即 FileA_20120701 FileB_20120701

2.  每月收集每小时汇总数据，将包括所有文件类型记录，即 Hourly_usage_201207

3.  每年收集的每日汇总数据，将包括所有文件类型记录，即 Daily_usage_2012

所以：每小时地图减少>每天地图减少

现在我主要关注如何存储详细记录，请看一下文件中提供的原始数据：

```
SERIAL  TIMESTAMP   CUSTOMER_ID RESERVED01  PRODUCT_ID  CUSTOMER_TYPE   CUSTOMER_STATE  ChargeAmount_OF_UNITS   ChargeAmount_OF_FUND    ChargeAmount_FROM_ACCOUNT1  ACCOUNT1_BALANCE    ChargeAmount_FROM_ACCOUNT2  ACCOUNT2_BALANCE    WalletType1 UnitType1   ChargeAmount1   WalletBalance1  WalletType2 UnitType2   ChargeAmount2   WalletBalance2  WalletType3 UnitType3   ChargeAmount3   WalletBalance3  Bonus1  Bonus2  Bonus3  AddtionaInfo 
379120186   20120701235122  1345567 0   555 0   1000000 0   0   5   664 0   0   200 1   5   664 0   0   0   0   0   0   0   0               1234
379120190   20120701235124  1345568 0   1   0   1000000 0   0   4   108 0   0   200 1   4   108 0   0   0   0   0   0   0   0               
379120197   20120701235132  1345569 0   4   0   1000000 0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0               
379120203   20120701235136  1345570 0   1   0   1000000 0   0   0   346 0   0   0   0   0   0   0   0   0   0   0   0   0   0               XXX
379120207   20120701235138  1345571 0   10  0   1000000 0   0   0   0   3   100 200 1   3   100 500 2   10  0   610 2   20  80  10          
379120208   20120701235138  1345571 0   1   0   1000000 0   0   3   306 0   0   200 1   3   306 0   0   0   0   0   0   0   0               
379120211   20120701235141  1345573 0   1   0   1000000 0   0   0   181 0   0   0   0   0   0   0   0   0   0   0   0   0   0               
379120213   20120701235143  3101015742206   0   349 1   1000001 0   0   0   274 0   0   0   0   0   0   0   0   0   0   0   0   0   0               
379120214   20120701235144  3101015742206   0   349 1   1000001 0   0   0   0   120 680 210 1   37  0   200 18  120 680 0   0   0   0               
379120215   20120701235147  3101015742206   0   349 1   1000001 0   0   0   992 0   0   0   0   0   0   0   0   0   0   0   0   0   0               
379120217   20120701235147  3101015742206   0   349 1   1000001 0   2   0   1   0   0   400 3   2   1766    0   0   0   0   0   0   0   0               
379120223   20120701235149  3101015742206   0   349 1   1000001 0   0   11  196 0   0   200 1   11  196 0   0   0   0   0   0   0   0               
379120229   20120701235153  1345579 0   349 3   1000000 0   0   40  707 0   0   200 1   40  707 0   0   0   0   0   0   0   0   20  5       XXX
379120230   20120701235153  3101015742206   0   349 1   1000001 0   0   9   1702    0   0   200 1   9   1702    0   0   0   0   0   0   0   0               
379120232   20120701235153  1345581 0   349 2   1000000 0   0   150 59  0   0   200 1   150 59  0   0   0   0   0   0   0   0               
379120237   20120701235158  1345582 0   1   2   1000000 0   0   3   303 0   0   200 1   3   303 0   0   0   0   0   0   0   0               
379120241   20120701235202  538552582   0   14  0   1000000 0   0   0   779 10  777 210 1   150 200 0   0   0   0   0   0   0   0               YYY
379120245   20120701235206  538552582   0   14  0   1000000 0   0   3   300 0   0   200 1   3   300 0   0   0   0   0   0   0   0               
379120248   20120701235206  538552582   0   14  0   1000000 0   0   155 202 0   0   200 1   155 202 0   0   0   0   0   0   0   0               
379120250   20120701235208  538552582   0   14  0   1000000 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 
```

**data1.json 结构：**仅从 CSV 加载数据，无需任何转换、删除空值等。这并不理想，但处理时间最快

```
[
    {
        'SERIAL': 379120186,
        'TIMESTAMP': 20120701235122,
        'CUSTOMER_ID': 1345567,
        'RESERVED01': 0,
        'PRODUCT_ID': 555,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 5,
        'ACCOUNT1_BALANCE': 664,
        'ChargeAmount_FROM_ACCOUNT2': 0,
        'ACCOUNT2_BALANCE': 0,
        'WalletType1': 200,
        'UnitType1': 1,
        'ChargeAmount1': 5,
        'WalletBalance1': 664,
        'WalletType2': 0,
        'UnitType2': 0,
        'ChargeAmount2': 0,
        'WalletBalance2': 0,
        'WalletType3': 0,
        'UnitType3': 0,
        'ChargeAmount3': 0,
        'WalletBalance3': 0,
        'Bonus1': '',
        'Bonus2': '',
        'Bonus3': '',
        'AddtionaInfo': '1234'
    },
    {
        'SERIAL': 379120203,
        'TIMESTAMP': 20120701235136,
        'CUSTOMER_ID': 1345570,
        'RESERVED01': 0,
        'PRODUCT_ID': 1,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 0,
        'ACCOUNT1_BALANCE': 346,
        'ChargeAmount_FROM_ACCOUNT2': 0,
        'ACCOUNT2_BALANCE': 0,
        'WalletType1': 0,
        'UnitType1': 0,
        'ChargeAmount1': 0,
        'WalletBalance1': 0,
        'WalletType2': 0,
        'UnitType2': 0,
        'ChargeAmount2': 0,
        'WalletBalance2': 0,
        'WalletType3': 0,
        'UnitType3': 0,
        'ChargeAmount3': 0,
        'WalletBalance3': 0,
        'Bonus1': '',
        'Bonus2': '',
        'Bonus3': '',
        'AddtionaInfo': XXX
    },
    {
        'SERIAL': 379120207,
        'TIMESTAMP': 20120701235138,
        'CUSTOMER_ID': 1345571,
        'RESERVED01': 0,
        'PRODUCT_ID': 10,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 0,
        'ACCOUNT1_BALANCE': 0,
        'ChargeAmount_FROM_ACCOUNT2': 3,
        'ACCOUNT2_BALANCE': 100,
        'WalletType1': 200,
        'UnitType1': 1,
        'ChargeAmount1': 3,
        'WalletBalance1': 100,
        'WalletType2': 500,
        'UnitType2': 2,
        'ChargeAmount2': 10,
        'WalletBalance2': 0,
        'WalletType3': 610,
        'UnitType3': 2,
        'ChargeAmount3': 20,
        'WalletBalance3': 80,
        'Bonus1': 10,
        'Bonus2': '',
        'Bonus3': '',
        'AddtionaInfo': ''
    }
] 
```

**data2.json 结构：** 删除空值。未发生收费 (Wallet ID = 0) 的收费字段 (WalletType1-3) 中的值将被删除。只保留受影响的钱包。

```
 [
        {
            'SERIAL': 379120186,
            'TIMESTAMP': 20120701235122,
            'CUSTOMER_ID': 1345567,
            'PRODUCT_ID': 555,
            'CUSTOMER_TYPE': 0,
            'CUSTOMER_STATE': 1000000,
            'ChargeAmount_OF_UNITS': 0,
            'ChargeAmount_OF_FUND': 0,
            'ChargeAmount_FROM_ACCOUNT1': 5,
            'ACCOUNT1_BALANCE': 664,
            'ChargeAmount_FROM_ACCOUNT2': 0,
            'ACCOUNT2_BALANCE': 0,
            'WalletType1': 200,
            'UnitType1': 1,
            'ChargeAmount1': 5,
            'WalletBalance1': 664,
            'AddtionaInfo': 1234
        },
        {
            'SERIAL': 379120203,
            'TIMESTAMP': 20120701235136,
            'CUSTOMER_ID': 1345570,
            'RESERVED01': 0,
            'PRODUCT_ID': 1,
            'CUSTOMER_TYPE': 0,
            'CUSTOMER_STATE': 1000000,
            'ChargeAmount_OF_UNITS': 0,
            'ChargeAmount_OF_FUND': 0,
            'ChargeAmount_FROM_ACCOUNT1': 0,
            'ACCOUNT1_BALANCE': 346,
            'ChargeAmount_FROM_ACCOUNT2': 0,
            'ACCOUNT2_BALANCE': 0,
            'AddtionaInfo': 'XXX'
        },
        {
            'SERIAL': 379120207,
            'TIMESTAMP': 20120701235138,
            'CUSTOMER_ID': 1345571,
            'RESERVED01': 0,
            'PRODUCT_ID': 10,
            'CUSTOMER_TYPE': 0,
            'CUSTOMER_STATE': 1000000,
            'ChargeAmount_OF_UNITS': 0,
            'ChargeAmount_OF_FUND': 0,
            'ChargeAmount_FROM_ACCOUNT1': 0,
            'ACCOUNT1_BALANCE': 0,
            'ChargeAmount_FROM_ACCOUNT2': 3,
            'ACCOUNT2_BALANCE': 100,
            'WalletType1': 200,
            'UnitType1': 1,
            'ChargeAmount1': 3,
            'WalletBalance1': 100,
            'WalletType2': 500,
            'UnitType2': 2,
            'ChargeAmount2': 10,
            'WalletBalance2': 0,
            'WalletType3': 610,
            'UnitType3': 2,
            'ChargeAmount3': 20,
            'WalletBalance3': 80,
            'Bonus1': 10,
        }
    ] 
```

**data3.json 结构：**删除空字符串，将来自充电的值插入到键“Charging”中，并带有一个列表。钱包类型用作密钥，该钱包类型的链接信息更进一步。只有受影响的钱包被插入。

```
[
    {
        'SERIAL': 379120186,
        'TIMESTAMP': 20120701235122,
        'CUSTOMER_ID': 1345567,
        'PRODUCT_ID': 555,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 5,
        'ACCOUNT1_BALANCE': 664,
        'ChargeAmount_FROM_ACCOUNT2': 0,
        'ACCOUNT2_BALANCE': 0,
        'CHARGING': 
            [
                {
                    '200': 
                        {
                            'UnitType': 1,
                            'ChargeAmount': 5,
                            'WalletBalance': 664
                        }
                }
            ] , 

        'AddtionaInfo': '1234'
    },
    {
        'SERIAL': 379120203,
        'TIMESTAMP': 20120701235136,
        'CUSTOMER_ID': 1345570,
        'RESERVED01': 0,
        'PRODUCT_ID': 1,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 0,
        'ACCOUNT1_BALANCE': 346,
        'ChargeAmount_FROM_ACCOUNT2': 0,
        'ACCOUNT2_BALANCE': 0,
        'CHARGING' : [],
        'AddtionaInfo': 'XXX'
    },
    {
        'SERIAL': 379120207,
        'TIMESTAMP': 20120701235138,
        'CUSTOMER_ID': 1345571,
        'RESERVED01': 0,
        'PRODUCT_ID': 10,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 0,
        'ACCOUNT1_BALANCE': 0,
        'ChargeAmount_FROM_ACCOUNT2': 3,
        'ACCOUNT2_BALANCE': 100,
        'CHARGING': 
            [
                {
                    '200': 
                        {               
                            'UnitType': 1,
                            'ChargeAmount': 3,
                            'WalletBalance': 100,
                        }
                },
                {
                    '500':
                        {
                            'UnitType': 2,
                            'ChargeAmount': 10,
                            'WalletBalance': 0,
                        }
                },
                {
                    '610':
                        {
                            'UnitType': 2,
                            'ChargeAmount': 20,
                            'WalletBalance': 80
                        }
                }
            ],
        'Bonus1': 10,
    }
] 
```

**data4.json**删除空字符串，Charging 值被放入“Charging”，但是我们将其保持在这个级别，现在使用键“WalletType”，再次只保留那些受影响的钱包。该列表为您提供了收费的顺序。

```
[
    {
        'SERIAL': 379120186,
        'TIMESTAMP': 20120701235122,
        'CUSTOMER_ID': 1345567,
        'PRODUCT_ID': 555,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 5,
        'ACCOUNT1_BALANCE': 664,
        'ChargeAmount_FROM_ACCOUNT2': 0,
        'ACCOUNT2_BALANCE': 0,
        'CHARGING': 
            [
                {
                    'WalletType': '200',
                    'UnitType': 1,
                    'ChargeAmount': 5,
                    'WalletBalance': 664
                }
            ] , 

        'AddtionaInfo': '1234'
    },
    {
        'SERIAL': 379120203,
        'TIMESTAMP': 20120701235136,
        'CUSTOMER_ID': 1345570,
        'RESERVED01': 0,
        'PRODUCT_ID': 1,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 0,
        'ACCOUNT1_BALANCE': 346,
        'ChargeAmount_FROM_ACCOUNT2': 0,
        'ACCOUNT2_BALANCE': 0,
        'CHARGING' : [],
        'AddtionaInfo': 'XXX'
    },
    {
        'SERIAL': 379120207,
        'TIMESTAMP': 20120701235138,
        'CUSTOMER_ID': 1345571,
        'RESERVED01': 0,
        'PRODUCT_ID': 10,
        'CUSTOMER_TYPE': 0,
        'CUSTOMER_STATE': 1000000,
        'ChargeAmount_OF_UNITS': 0,
        'ChargeAmount_OF_FUND': 0,
        'ChargeAmount_FROM_ACCOUNT1': 0,
        'ACCOUNT1_BALANCE': 0,
        'ChargeAmount_FROM_ACCOUNT2': 3,
        'ACCOUNT2_BALANCE': 100,
        'CHARGING': 
            [
                {
                    'WalletType': '200',    
                    'UnitType': 1,
                    'ChargeAmount': 3,
                    'WalletBalance': 100,
                },
                {
                    'WalletType': 500,
                    'UnitType': 2,
                    'ChargeAmount': 10,
                    'WalletBalance': 0,
                },
                {
                    'WalletType': 610,
                    'UnitType': 2,
                    'ChargeAmount': 20,
                    'WalletBalance': 80
                }
            ],
        'Bonus1': 10,
    }
] 
```

**注意：** - 当我们汇总数据时希望看到类似于

```
Date | Hour | Wallet  200 Total Charge| Wallet 500 Total Charge | Wallet 610 Total Charge 
```

*   我已经修剪了这个，但实际文件有 WalletType1-20

*   字段名称 WalletType(1) 中的数字，指的是钱包的收费顺序（由 Wallet ID 指示），即 WalletType1 = 200，表示第一个钱包 200 被收费等。

*   查看详细记录（也不是摘要）时，他们的收费顺序是相关的

*   任何 WalletType id 都可以出现在钱包字段中的任何位置。ie Wallet ID =200 可以填入 WalletType1 或 WalletTyp2 等，这取决于优先级规则。

**问题：**

*   您会推荐哪种文档结构，为什么？

*   所提供的结构会有什么缺陷？

*   您有任何进一步的建议/其他可能的结构吗？

*   有任何分片/分区建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T17:25:50.973

最终的模式对我来说看起来最紧凑和可查询。

避免长键名——键名存储在每个文档中，并且它们的存储大小可以累加。如果 SERIAL 字段是唯一的，您可以将 _id 设置为该值，而不是单独存储 SERIAL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T21:18:06.730

每天处理 +-100,000 个文件可能不需要分片。

# visual-studio-2010 - Visual Studio 2010 构建排除的文件

> ID：11347236
> 
> 赞同：0
> 
> 时间：2012-07-05T15:09:11.630
> 
> 标签：visual-studio-2010

我们在 Web 应用程序项目中有一些排除的文件。

一位开发人员的机器可以很好地构建项目。

另一台开发人员的机器看到排除的文件并决定编译它们，因此引发与这些文件相关的编译错误。

两者都使用 VS2010 SP1。

我不知道任何可能导致这种差异的编译选项。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:12:11.307

他们都共享相同的`.sln`文件`.csproj`吗？（假设它的 ac# 项目）。

有一个`cs`可以在文件上设置的编译内容标志（右键单击文件并选择属性）。可能一个人在一台机器上设置了一组，而另一个开发人员在另一台机器上设置了不同的设置。

另一个问题（假设它不仅仅是标准`.cs`代码）是有一个用于编译的自定义工具。例如 DevArt`Entity Designer`使用`.edml`扩展。如果未安装该工具，它只会将这些文件视为内容，如果已安装该工具，则将它们视为可编译/可生成的。

# android - 使用回调显示方向错误的视频捕获已更改

> ID：11347240
> 
> 赞同：0
> 
> 时间：2012-07-05T15:09:16.680
> 
> 标签：android

我创建了一个像这样工作的应用程序，它要求用户选择一个视频，他可以通过从图库中选择或仅在当时捕获视频来完成。

为此，我编写了这样的代码：-

```
public class VideoQuestionActivity extends Activity implements View.OnClickListener, Callback
{
 / Here I have declared my object like Button etc so omitting this from code / 

 private Dialog myDialog;
 private Dialog videoDialog;

 private File videoFolder;
 private String videoFileName;
 private String selectedVideoPath;
 private Uri selectedVideoURI;
 private Bitmap bMap;  

 private SurfaceView surfaceView;
 private SurfaceHolder surfaceHolder;
 private MediaPlayer mediaPlayer;

 @Override
protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.question);

    mCurrentSurvey =(Survey)getIntent().getSerializableExtra("CurrentSurvey");
    mCurrentQuestion =(Question)getIntent().getSerializableExtra("CurrentQuestion");

    Initialize();
}

public void Initialize()
  {
    // This function initializes the objects like buttons, surface view media player so also omitting this just to keep the code simple
  }

@Override
public void onClick(View v) 
{
    // TODO Auto-generated method stub

    switch(v.getId())
    {

        case R.id.btnQuestionTypeAction:
            getVideo();
            break;

        case R.id.btn_live:
            Intent liveIntent= new Intent(  android.provider.MediaStore.ACTION_VIDEO_CAPTURE);
                    startActivityForResult(liveIntent,RESULT_CAPTURE_VIDEO);
            myDialog.dismiss();
            break;

        case R.id.btn_gallery:
            Intent galIntent = new Intent(Intent.ACTION_GET_CONTENT);
            galIntent.setType("video/*");
            startActivityForResult(galIntent,RESULT_LOAD_VIDEO);
            myDialog.dismiss();
            break;
        case R.id.btnCancel:
            videoDialog.dismiss();
            break;

        case R.id.btnOk:
            videoDialog.dismiss();
            boolean sdcardAvailable = sdcardState();
            if(sdcardAvailable)
            {

            videoFolder =new File(userFolderPath+"/Videos");
            if(!videoFolder.exists())
            {
                videoFolder.mkdir();
            }

            CopyFile(selectedVideoPath,videoFolder.toString());

            try {
                mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
                mediaPlayer.setDisplay(surfaceHolder);
                mediaPlayer.setDataSource(getApplicationContext(), selectedVideoURI);
                mediaPlayer.prepare(); 
                mediaPlayer.start();

            } 
            catch (IllegalArgumentException e)
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
            catch (SecurityException e) 
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
            catch (IllegalStateException e) 
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            catch (IOException e) 
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            Toast.makeText(getApplicationContext(),selectedVideoPath , Toast.LENGTH_LONG).show();
            }
            else
            {
                Toast.makeText(getApplicationContext(),"SD Card not available", Toast.LENGTH_LONG).show();
            }
            break;
    }
}

public void startIntentForController()
{
    // this function calls another activity so omitting this from code. 
}

@Override
public void onBackPressed() {

}

private void getVideo() 
{
    boolean sdcardAvailable = sdcardState();
    if(sdcardAvailable)
    {
        extStorageDirectory= Environment.getExternalStorageDirectory().getAbsolutePath().toString();
        userFolderPath=extStorageDirectory+"/User";
        File userFolder=new File(userFolderPath);
        if(!(userFolder.exists()))
            userFolder.mkdir();
        dialogShow();
    }
    else
    {
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setMessage("SD Card unavailable.....")
               .setCancelable(false)
               .setPositiveButton("OK", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {
                   }
               });
        AlertDialog alert = builder.create();
        alert.show();
    }
}

public boolean sdcardState()
{
    sdcardState = Environment.getExternalStorageState();

    if (Environment.MEDIA_MOUNTED.equals(sdcardState)) 
    {
        // We can read and write the media
        return true;
    } 
    else    
    {
        // We can't read and write the media
        return false;
    }  
}
public void dialogShow()
{
    myDialog = new Dialog(VideoQuestionActivity.this);
    myDialog.setContentView(R.layout.picturecustomdialog);

    //Initializing the UI component of custom dialog 
    TextView title = (TextView) myDialog.findViewById(R.id.lbl_photo);
    TextView subTitle = (TextView) myDialog.findViewById(R.id.lbl_source);
    Button gallery=(Button) myDialog.findViewById(R.id.btn_gallery);
    Button live=(Button) myDialog.findViewById(R.id.btn_live);

    //Setting the value to each UI component of custom dialog
    title.setText("Attach a Video");
    subTitle.setText("Choose a source");
    gallery.setText("Gallery");
    live.setText("Capture");

    myDialog.show();
    gallery.setOnClickListener(this);
    live.setOnClickListener(this);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) 
{ 
    super.onActivityResult(requestCode, resultCode, data);

    if (requestCode == RESULT_LOAD_VIDEO && resultCode == RESULT_OK && data != null) 
    {

        myDialog.dismiss();
        Uri myVideo;
        myVideo= data.getData();    
        selectedVideoURI=myVideo;
        selectedVideoPath= getRealPathFromURI(myVideo);
        videoDialogshow();

    }

    if (requestCode == RESULT_LOAD_VIDEO && resultCode == RESULT_CANCELED && data!= null) 
    {
        finish();
    }

    if (requestCode == RESULT_CAPTURE_VIDEO && resultCode == RESULT_OK) 
    {

        myDialog.dismiss();
        Uri myVideo;
        myVideo= data.getData();
        selectedVideoURI=myVideo;   
        selectedVideoPath= (getRealPathFromURI(myVideo));
        videoDialogshow();
    }

    if (requestCode == RESULT_CAPTURE_VIDEO && resultCode == RESULT_CANCELED ) 
    {
        finish();
    }
    if(resultCode==RESULT_CANCELED)
    {
        mCurrentSurvey.setSurveyQuestionIndex(mCurrentSurvey.getSurveyQuestionIndex());
        startIntentForController();
    }
}

public String getRealPathFromURI(Uri contentUri) 
{
    String imgAbsolutePath;
    String[] proj = { MediaStore.Video.Media.DATA };
    Cursor cursor = managedQuery(contentUri, proj, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
    cursor.moveToFirst();
    imgAbsolutePath=cursor.getString(column_index);
    return imgAbsolutePath;
}

public void videoDialogshow()
{
    videoDialog = new Dialog(VideoQuestionActivity.this);
    videoDialog.setContentView(R.layout.mediacontaincustomdialog);

    //Initializing the UI component of custom dialog 
    Button btnVideoCancel = (Button) videoDialog.findViewById(R.id.btnCancel);
    Button btnVideoOk = (Button) videoDialog.findViewById(R.id.btnOk);
    btnVideoCancel.setBackgroundResource(R.drawable.img_wrong);
    btnVideoOk.setBackgroundResource(R.drawable.img_right);

    //Setting the value to each UI component of custom dialog
    LinearLayout llMediaView =(LinearLayout) videoDialog.findViewById(R.id.llMediaView);
    final VideoView mediaVideoView=new VideoView(this);

    mediaVideoView.setVideoURI(selectedVideoURI);
    mediaVideoView.setMediaController(new MediaController(this));
    mediaVideoView.requestFocus();
    llMediaView.addView(mediaVideoView);
    videoDialog.show();

    bMap = ThumbnailUtils.createVideoThumbnail(selectedVideoPath, MediaStore.Video.Thumbnails.MICRO_KIND);
    mediaVideoView.setBackgroundDrawable(new BitmapDrawable(getResources(), bMap));
    mediaVideoView.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            mediaVideoView.start();
        }
    }); 

    btnVideoCancel.setOnClickListener(this);
    btnVideoOk.setOnClickListener(this);
}

public boolean CopyFile(String srcPath,String destPath)
{
    //this function copies the file to a custom location in my sd card so also omitting this
}

@Override
public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
    // TODO Auto-generated method stub
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    // TODO Auto-generated method stub

}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    mediaPlayer.reset();
}

@Override
protected void onDestroy() 
{
    // TODO Auto-generated method stub
    super.onDestroy();
    mediaPlayer.release();
}
} 
```

现在这段代码在我的手机上运行良好，但是每当我改变方向时，我的应用程序就会崩溃。

另外在我的清单中，我添加了配置更改属性，即：-

```
android:configChanges="keyboardHidden|orientation" 
```

，我把我的logcat，

```
07-05 20:26:09.203: E/AndroidRuntime(1907): FATAL EXCEPTION: main
07-05 20:26:09.203: E/AndroidRuntime(1907): java.lang.IllegalStateException
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.media.MediaPlayer._reset(Native Method)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.media.MediaPlayer.reset(MediaPlayer.java:1066)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at com.optimus.mobile.question.VideoQuestionActivity.surfaceDestroyed(VideoQuestionActivity.java:475)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.SurfaceView.reportSurfaceDestroyed(SurfaceView.java:568)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.SurfaceView.updateWindow(SurfaceView.java:472)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.SurfaceView.onWindowVisibilityChanged(SurfaceView.java:206)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.View.dispatchDetachedFromWindow(View.java:6173)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewGroup.dispatchDetachedFromWindow(ViewGroup.java:1156)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewGroup.dispatchDetachedFromWindow(ViewGroup.java:1156)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewGroup.dispatchDetachedFromWindow(ViewGroup.java:1156)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewGroup.dispatchDetachedFromWindow(ViewGroup.java:1156)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewGroup.dispatchDetachedFromWindow(ViewGroup.java:1156)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewGroup.dispatchDetachedFromWindow(ViewGroup.java:1156)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewRoot.dispatchDetachedFromWindow(ViewRoot.java:1630)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewRoot.doDie(ViewRoot.java:2671)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.ViewRoot.die(ViewRoot.java:2641)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.WindowManagerImpl.removeViewImmediate(WindowManagerImpl.java:218)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.view.Window$LocalWindowManager.removeViewImmediate(Window.java:436)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.app.ActivityThread.handleDestroyActivity(ActivityThread.java:3684)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3789)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.app.ActivityThread.access$2400(ActivityThread.java:125)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2037)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.os.Looper.loop(Looper.java:123)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at android.app.ActivityThread.main(ActivityThread.java:4627)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at java.lang.reflect.Method.invokeNative(Native Method)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at java.lang.reflect.Method.invoke(Method.java:521)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
07-05 20:26:09.203: E/AndroidRuntime(1907):     at dalvik.system.NativeStart.main(Native Method) 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:36:17.580

您需要添加一个 onConfigurationChanged() 方法。这样它会自动保存到应用程序的当前进度并在方向之间切换时保持运行。

此链接可能会对您的问题有所帮助。当我遇到同样的问题时，它对我有用。

[http://developer.android.com/guide/topics/manifest/activity-element.html](http://developer.android.com/guide/topics/manifest/activity-element.html)

# php - 尝试使用 PDO 对象时出错

> ID：11347242
> 
> 赞同：1
> 
> 时间：2012-07-05T15:09:22.390
> 
> 标签：php, mysql, pdo

我是一个没有经验的 php 程序员，几天前才发现 PDO。我现在正在尝试将我的网站代码移植到使用 PDO，但是当我尝试使用我创建的 PDO 对象时出现错误。

我得到的错误是：

```
Fatal error: Call to a member function prepare() on a non-object in ... file2.php ... 
```

代码如下所示：

**索引.php**

```
class myClass
{
        ... variables ...

        ... functions ...

        public function myFunction() // gets called on page load, outputs content to page
        {
            ... stuff ...

            require('file1.php');

            ... stuff ...
        }
} 
```

**文件1.php**

```
require_once('mysql_connect.php'); // create pdo object if not created

... stuff ...

require_once('file2.php');

// I can use the PDO object in here to make queries

$output = function2(); // function2 is in file2.php

... stuff ... 
```

**文件2.php**

```
require_once('mysql_connect.php'); // create pdo object if not created

function function2()
{
    ... stuff ...

    // PDO error occurs here
    $stmt = $db->prepare(...);
    makeQuery($stmt, array(...));

    return $something;
} 
```

**mysql_connect.php**

```
try 
{
    $db = new PDO("mysql:$dbhost=localhost;dbname=$dbname;charset=utf8", $dbuser, $dbpass, array(PDO::ATTR_EMULATE_PREPARES => false, PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION));
}
catch (PDOException $e) 
{
    print "Error!: " . $e->getMessage() . "<br/>";
    die();
}

function makeQuery($stmt, $array = array())
{
    try 
    {
        $stmt->execute($array);
    }
    catch (PDOException $e) 
    {
        print "Error!: " . $e->getMessage() . "<br/>";
        die();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:19:35.713

如果我理解您的逻辑正确，您正在尝试使用 myFunction2 中的 PDO 对象 - 您是将 PDO 对象作为参数传递，还是将其声明为全局变量？因为如果您不这样做，它将超出范围，您将无法使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:14:23.147

您不需要再次包含 mysql_coonect。只包含一次。

```
 index.php
-class myClass defined
--method myFunction defined (it get's called on pageload & returns the page output)
---include file1.php
----require_once('mysql_connect.php') (creates pdo object)
----*I can use the pdo object here successfully*
----require_once('file2.php')
-----function myFunction2 defined 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:14:30.093

DSN、用户名和密码是否正确？如果是这样，你做这样的事情：

```
$pdo = new PDO("dsn");
/* Some code... at the moment something changes $pdo value */
$pdo->prepare("QUERY"); 
```

# iphone - 核心数据：保存前排序

> ID：11347244
> 
> 赞同：1
> 
> 时间：2012-07-05T15:09:27.347
> 
> 标签：iphone, ios, xcode, ios5

我正在向一个简单的实体添加一个名称列表（来自一个数组）。但在保存实体之前，我希望对它们进行排序。请问有人能告诉我怎么做吗？

我已经看到如何对一些获取的数据进行排序，但我不知道该怎么做。一个书面的例子将不胜感激。非常感谢。

```
NSManagedObjectContext *context = [self managedObjectContext];
NSString *myTempString;

for (databaseMakerVC *aName in peoplesNames.theArray) {
    myTempString = [[NSString alloc] initWithFormat:@"%@", aName];

    peoplesNamesObject *newObject = [NSEntityDescription
                                     insertNewObjectForEntityForName:@"peoplesNamesObject"
                                     inManagedObjectContext:context];
    newObject.aName = myTempString;
}

    // *** Do the sorting here!? ***

// Save the context
NSError *error = nil;
if (![context save:&error]) {
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T07:55:28.413

```
 NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription 
                                   entityForName:@"peoplesNamesObject" inManagedObjectContext:context];

 [fetchRequest setEntity:entity];

     NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"aName" ascending:YES]; 

        NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor]; 

        [fetchRequest setSortDescriptors:sortDescriptors]; 

        NSError *error;

       NSArray *array=[context executeFetchRequest:fetchRequest error:&error]; 
```

这将起作用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:31:21.920

**编辑**

插入对象后只需添加一个排序描述符

查找数组中的`sortDescriptorWithKey`键。在我创建的数组中，我为“createdDate”分配了一个键，并以此对其进行排序。因此，您将分配一个“名称”键并使用下面的代码

```
NSSortDescriptor *sort=[NSSortDescriptor sortDescriptorWithKey:@"name" ascending:NO];
[peoplesNames.theArray sortUsingDescriptors:[NSArray arrayWithObject:sort]]; 
```

# tfs - TFS 2010 - 使字段成为必填项

> ID：11347246
> 
> 赞同：0
> 
> 时间：2012-07-05T15:09:37.617
> 
> 标签：tfs, comments, required

我是这个网站的第一次用户。如果我没有很好地搜索我的问题，请提前道歉。

我正在考虑稍微调整 TFS 2010 的错误创建能力。我想强制链接到历史的“评论”字段。基本上，在某人进行了一系列更改之后，我想强制该人在提交更改之前输入一些细节。

有人对这个有经验么？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:17:24.353

您必须右键单击您的团队项目，选择“团队项目设置”，然后选择“源代码管理”。这将启动带有三个选项卡的“源代码管理设置”窗口。

```
1\. Check out Parameters

2\. Check in policy <- your target (Select “Changeset Comments Policy”)

3\. Check in Note 
```

当你选择你的规则时，你点击 OK et 你可以测试

![在此处输入图像描述](../Images/d31ec58b4d09e4fad1d3b5a5c269b063.png)

# php - 在php中散列（带盐）用户名和密码

> ID：11347261
> 
> 赞同：2
> 
> 时间：2012-07-05T15:10:53.237
> 
> 标签：php, security, hash, salt, saltedhash

我正在创建一个用户登录功能，但我看到了关于最佳方式的不同看法。

这就是我想做的事情......

*   使用基于用户名子字符串的 2 个散列盐对用户名进行散列。
*   使用 2 个随机生成的散列盐对密码进行散列，这些盐与密码和用户名一起保存在一个表中。

这是矫枉过正，错误，甚至不够安全吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:17:19.050

加盐可防止彩虹表，因此拥有 2 个盐不会比 1 个更好。黑客需要知道盐才能使用彩虹表破解您的密码，他们能做到这一点的唯一方法是如果他们有访问数据库表。如果他们有，无论如何他们都有两种盐。

密码越长，使用蛮力就越难，因此更长的密码将比额外的盐更好。

每次从数据库中读取用户名时，对用户名进行加盐和散列处理都会增加不必要的开销。使用密码，您只需要在登录时加盐和散列。

理想情况下使用[BCrypt之类的东西，随着](http://en.wikipedia.org/wiki/Bcrypt)[摩尔定律](http://en.wikipedia.org/wiki/Moore%27s_law)的继续，加密散列函数可以随着时间的推移自适应地减慢。这将减少暴力攻击的机会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:13:13.923

我会说散列用户名是多余的，密码的两个盐也是如此。一种盐就足够了。

请务必使用安全散列算法，例如 SHA-512。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:20:36.833

就像其他人说的，散列用户名是多余的，一个盐就足够了。使用**数学上很慢**的算法- 对饼干来说也​​很慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:30:12.837

给你的密码加盐一次就足够了。拥有两种盐基本上相当于生成更长的盐。

散列用户名将使您更难管理用户，而不是使登录更安全。考虑列出您当前的用户，但您所拥有的只是散列版本？请记住，散列的目的是对您的数据进行不可逆的“加密”。

考虑使用[crypt()](http://php.net/crypt)对您的密码进行哈希处理。特别注意 Blowfish 方法，因为这被认为是目前最安全的散列方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:20:44.270

我刚刚回答了另一个关于如何处理登录名和密码安全的详细信息的[SO 问题。](https://stackoverflow.com/questions/11303258/is-this-an-appropriate-login-and-registration-encryption-system/11303737#11303737)它可能值得一读。（一些花絮：用户名不需要加盐。密码肯定应该加盐，但你只需要一次。我使用SHA-256。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T15:32:31.777

确实没有必要对您的用户名字段进行哈希处理，这应该是您愿意在网页上显示的内容，同时保证您的系统安全。话虽如此，虽然它是不必要的，但如果你愿意忍受它就不会受到伤害。

如果它们都来自并存储在同一个地方，那么添加两种盐是毫无意义的。我不会这样做，而是使用用户名的排列作为盐，以及随机生成并存储在数据库中的长随机字符串。如果您仍然偏执，（我猜您是整个“散列用户名”的事情）我会考虑添加您在整个应用程序中使用的第三种盐。

另外，非常重要：

**确保使用强哈希函数**

确保使用安全的散列函数。whirlpool、sha256 及以上、tiger 或任何其他您可以使用的东西（检查[hash_algos()](http://ca3.php.net/manual/en/function.hash-algos.php)）。另外，看看实现 bcrypt，它非常慢（[如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)）。

# ruby - Selenium RC 与 safari 问题 - Selenium::WebDriver::Error::UnknownError: Executor has not been started yet

> ID：11347264
> 
> 赞同：4
> 
> 时间：2012-07-05T15:11:00.543
> 
> 标签：ruby, selenium, selenium-rc, safari-extension

我正在尝试使用 Selenium RC 打开 safari。但是，Safari 实例已创建并保持在请求连接模式（SafariDriver 在 ws://localhost:3078/wd 请求连接）。

```
require "selenium-webdriver"
caps = Selenium::WebDriver::Remote::Capabilities.safari
browser = Selenium::WebDriver.for :remote, :url=>"http://localhost:4444/wd/hub",    :desired_capabilities=>caps 
```

上面的东西挂断并失败 - Selenium::WebDriver::Error::UnknownError: Executor has not been started yet (java.lang.IllegalStateException) from [remote server] com.google.common.base.Preconditions(Preconditions.java ):145:in `checkState' from [remote server] org.openqa.selenium.safari.SafariDriverCommandExecutor(SafariDriverCommandExecutor.java):123:in`execute' from [remote server] org.openqa.selenium.remote.RemoteWebDriver(RemoteWebDriver.java):432:in `execute' from [remote server] org.openqa.selenium.remote.RemoteWebDriver(RemoteWebDriver.java):140:in`startSession' from [remote server] org.openqa.selenium.remote.RemoteWebDriver(RemoteWebDriver.java ):95:in `<init>' from [remote server] org.openqa.selenium.safari.SafariDriver(SafariDriver.java):33:in`'来自 [远程服务器] sun.reflect.NativeConstructorAccessorImpl(NativeConstructorAccessorImpl.java):-2:in `newInstance0' from [remote server] sun.reflect.NativeConstructorAccessorImpl(NativeConstructorAccessorImpl.java):39:in`newInstance' 来自 [远程服务器] sun.reflect.DelegatingConstructorAccessorImpl(DelegatingConstructorAccessorImpl.java):27:in `newInstance' from [remote server] java.lang.reflect.Constructor(Constructor.java):513:in`newInstance' 来自[远程服务器] java.lang.Class(Class.java):355:in`newInstance0' from [remote server] java.lang.Class(Class.java):308:in`newInstance' 来自 [远程服务器] org.openqa.selenium.remote.server.DefaultDriverFactory(DefaultDriverFactory.java):61:in `callConstructor' from [remote server] org.openqa.selenium.remote.server.DefaultDriverFactory(DefaultDriverFactory.java):52:in`newInstance' 来自 [远程服务器] org.openqa.selenium.remote.server.DefaultSession$BrowserCreator(DefaultSession. java):197:in `call' from [remote server] org.openqa.selenium.remote.server.DefaultSession$BrowserCreator(DefaultSession.java):1:in`call' ... 4 个级别...来自 [远程服务器] java.util.concurrent.ThreadPoolExecutor$Worker(ThreadPoolExecutor.java):908:in `run' from [remote server] java.lang.Thread(Thread.java):680:in`run' 来自 /Users/demo/.rvm/ gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/response.rb:52:in `assert_ok' from /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/response.rb:15:in`initialize' 来自 /Users/demo/.rvm/gems/ruby- 1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/http/common.rb:59:in`new' from /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/http/common.rb:59:in`来自/Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/http/default.rb:59:in `request' from /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/http/common.rb:40:in`call 的 create_response'来自 /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute' from /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/bridge.rb:92:in`create_session' 来自 /Users/ demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/remote/bridge.rb:68:in `initialize' from /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/common/driver.rb:33:in`new' 来自 /Users/demo/.rvm /gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver/common/driver.rb:33:in `for' from /Users/demo/.rvm/gems/ruby-1.9.2-p180/gems/selenium-webdriver-2.24.0/lib/selenium/webdriver.rb:65:in`for' from (irb):7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-08T04:39:37.490

在使用 Ruby 中的 Selenium Webdriver 时，我一直遇到这个问题。我解决了几次，但错误又回来了。所以我编写了我的 rspec 测试，以供 Windows 上的 jRuby 加载，并在 Java 中运行 Selenium 调用。Safari 现在可以工作了。

# c# - 单击 LiveTile 不显示/运行我的应用程序

> ID：11347266
> 
> 赞同：1
> 
> 时间：2012-07-05T15:11:06.167
> 
> 标签：c#, windows-phone-7, live-tile

在后台代理中，我创建（或更新）其中一个应用程序动态图块，并且按预期工作。
问题是，当我单击此实时磁贴屏幕闪烁但我的应用程序未“重新启动”或“显示”时。
怎么了？
我附上了一小部分代码，但你需要更多。

**主页**

```
public partial class MainPage : PhoneApplicationPage
{
    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        base.OnNavigatedTo(e);
    }
    public MainPage()
    {
        InitializeComponent();

        // Runs background agent: code is simplified
        StartAgent();
    }
} 
```

**背景代理**

```
public class TileAgent : ScheduledTaskAgent
{
    protected override void OnInvoke(ScheduledTask task)
    {
        Deployment.Current.Dispatcher.BeginInvoke(() =>
        {
            Vars.UpdateTiles();
        });

        NotifyComplete();
    }
} 
```

**静态类**

```
public class Vars
{
    private static Uri uri = new Uri(
        "/MainPage.xaml?tile",
        UriKind.RelativeOrAbsolute);
    private static RadExtendedTileData ExtendedData
    {
        get
        {
            return new RadExtendedTileData()
            {
                VisualElement = frontTile,
                BackVisualElement = backTile,                    
            };
        }
    }

    public static void UpdateTiles()
    {
        // I perform some task here

        // Then I create/update live tile
        Telerik.Windows.Controls.LiveTileHelper.CreateOrUpdateTile(
            ExtendedData, uri);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T16:02:48.997

尝试`/MainPage.xaml?tile=true`而不是`/MainPage.xaml?tile`...

并`NotifyComplete()`进入调度员呼叫。否则会在操作完成前被调用...

# html - 如果 unicode 字符以 Web 安全字体显示，使用起来是否安全？

> ID：11347270
> 
> 赞同：0
> 
> 时间：2012-07-05T15:11:18.393
> 
> 标签：html, unicode, html-entities

抱歉，如果这是一个愚蠢的问题，但四处搜索伤害了我的大脑，所以我希望有人能解决这个问题。

假设我想使用 unicode 字符（例如箭头之一）。我使用的字体是网络安全的，因此将在 99% 的计算机上使用（例如 Arial、Georgia 等）。我将符号复制并粘贴到我的编辑器中，在浏览器上按保存和预览，它就会显示出来。是这样吗？只要每个人都有相同的字体，这会安全吗？

我应该粘贴字符实体以确保它不会与代码混淆吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:17:37.490

好吧，是的，如果可以肯定地说 99% 的访问者都有可以显示该字符的字体，那很好。

使用实体不会使其更安全。这只是意味着您不必考虑编码，这很糟糕。您应该考虑您要声明您的网站的编码是什么以及它实际上是什么，并且两者都是正确的。

像“→”这样的箭头与“a”、“ä”、“あ”、“Д”等字符或任何其他字符完全相同。您不希望所有这些都作为实体，因为使用起来很痛苦，因此您应该确保您的工具链正确处理编码，以便您可以按原样使用它们。

# c++ - 将字符串从 R 传递到 C++

> ID：11347271
> 
> 赞同：0
> 
> 时间：2012-07-05T15:11:19.387
> 
> 标签：c++, r

我正在尝试在 R 中使用一些 C++ 函数。我已将所有 C++ 函数放在一个 DLL 中。我的 R 代码是

```
#load the c++ DLL
dyn.load("PathToDLL\\MyCPlusPlus.dll")    
#call the C++ function from R
a <- .C("MyFunc",as.character("Hello world")) 
```

我的 C++ DLL 函数是

```
char ** _stdcall MyFunc(char ** strInput)
{
 //display the string received from R
 MessageBox(NULL, LPCWSTR(*strInput), L"C++ program", NULL);
 return strInput;
} 
```

我遇到的问题是我从 R 传递到 C++ 的字符串在显示在消息框中时被破坏了。有没有人有将字符串从 R 传递给 C++ 的经验，如果是这样，你能指出我正确的方向吗？

谢谢

编辑：我也尝试过使用 char * 而不是 char** 如下所示，但没有运气

```
char * _stdcall MyFunc(char * strInput)
    {
     //display the string received from R
     MessageBox(NULL, LPCWSTR(strInput), L"C++ program", NULL);
     return strInput;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:17:42.783

看起来您在 DLL 中的字符串是宽字符（16 位），并且传递的字符串是简单的 ASCII 字符。尝试将字符串显示为 ASCII 字符。

# c# - 这个错误是什么意思：成员修饰符'public'必须在成员类型和名称之前

> ID：11347278
> 
> 赞同：6
> 
> 时间：2012-07-05T15:11:47.387
> 
> 标签：c#, access-modifiers

我的索引页的查看结果有问题。我已经在这里和谷歌上搜索了解决方案。所以这是我的代码。

```
public class UserController : Controller
{
    private ProjectsDB db = new ProjectsDB();
    //
    // GET: /User/
    EnvironmentVariableTarget 

    public ViewResult Index()
    {
        var model = from p in db.Projects where p.UserName == User.Identity.Name select p;
        return View(model);
    } 
```

这是我的错误：

> 成员修饰符“public”必须在成员类型和名称之前。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-05T15:23:48.177

那`EnvironmentVariableTarget`部分是错误的。它不应该在那里，这就是为什么你在下一句中得到错误

# mod-rewrite - FB PHP SDK 和 mod_rewrite：getUser 返回 0

> ID：11347282
> 
> 赞同：1
> 
> 时间：2012-07-05T15:11:54.707
> 
> 标签：mod-rewrite, facebook-php-sdk

我正在使用 Facebook PHP SDK 以允许用户使用 Facebook 登录我的网站。
在我下面的测试中（假设 URL 是[http://mysite.com/test/fbtest.php](http://mysite.com/test/fbtest.php)），

```
<?php
    require_once("facebook.php");
    $fb = new Facebook(array('appId' => 'APP_ID', 'secret' => 'APP_SECRET'));
    $fbuser = false;
    $fbuserid = $fb->getUser();
    $fblogin = $fb->getLoginUrl(array(
        'redirect_uri' => "http://{$_SERVER['HTTP_HOST']}/test/fbtest.php"));

if($fbuserid)
{
    try
    {
        $fbuser = $fb->api("/me");
        print_r($fbuser);
        echo "<br/>\n";
    }
    catch (FacebookApiException $e)
    {
        $fbuser = false;
        $fbuserid = 0;
    }
}
if(!$fbuser)
    echo "<a href=\"$fblogin\">FB Login</a>\n";
?> 
```

这似乎按预期工作。但是，当我添加以下重写规则时，

```
RewriteRule ^/FBtest/(.*)$ http://%{HTTP_HOST}/test/fbtest.php$1 
```

然后将我的登录重定向更改为以下内容，

```
$fblogin = $fb->getLoginUrl(array(
        'redirect_uri' => "http://{$_SERVER['HTTP_HOST']}/FBtest/")); 
```

然后`$fb->getUser()`总是返回 0。我觉得我错过了一些重要的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T08:42:06.250

在服务器端流程中，您的 redirect_uri get 使用必要的值作为查询字符串中的 GET 参数调用。

> `'redirect_uri' => "http://{$_SERVER['HTTP_HOST']}/FBtest/"`

所以有了这个redirect_uri，就像

```
http://example.com/FBtest/?state=foo&code=bar 
```

将在您的服务器上调用。

> `RewriteRule ^/FBtest/(.*)$ http://%{HTTP_HOST}/test/fbtest.php$1`

RewriteRules 不检查查询字符串，它们只查看 URL 的*路径*部分。在您的情况下，它`/FBtest/`背后没有任何东西 - 因此内部重定向转到`/test/fbtest.php`，并且查询字符串参数会丢失，因为您没有说要传递它们。

将标志`[QSA]`- 用于“查询字符串附加” - 添加到您的 RewriteRule （并删除不必要的`(.*)`） - 然后事情应该按预期工作，因为您的 fbtest.php 将获得身份验证过程所需的查询字符串参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-12T15:44:59.210

终于想通了这个问题。这是我需要的 RewriteRule：

```
RewriteRule ^/FBtest/$ http://%{HTTP_HOST}/test/fbtest.php [QSA,NE] 
```

事实证明，我需要在此规则中添加 QSA 和 NE 标志。

就像在 CBroe 的回答中一样，添加到 redirect_uri 的状态/代码参数需要 QSA 标志（`(.*)`在 RewriteRule 中使用不会捕获这些附加参数）。

我还需要添加 NE 标志，因为 Facebook 身份验证添加到 redirect_uri 的状态/代码正在被转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T22:57:45.047

除了您在应用程序设置中设置的域之外，您将无法使用任何其他域。

“确保您使用的是根域，而不是 sample.com/test/ 作为您的 url 设置。”

# java - 如何在 Synth LaF 中自定义 jScrollbar 的几种外观？

> ID：11347285
> 
> 赞同：0
> 
> 时间：2012-07-05T15:12:11.057
> 
> 标签：java, css, swing, synth

在我们的应用程序中，我们必须使用 css 来自定义 Swing 组件的外观。现在我们有一些手动编写的 css 引擎，但是速度很慢并且需要大量额外的代码来应用一个 css 文件。所以现在我们尝试使用 Synth 的外观来让 ui 的变化更加*原生*。

对于大多数组件，我们设置名称并将它们用于绑定到样式。但也有几个滚动条，它们有不同的 css 和不同的外观。影响滚动条拇指的唯一方法是用户区域 ScrollBarThumb，我们无法为其设置名称，因为它不是 JComponent。由于使用区域而不是名称，因此不可能有不同的拇指。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:21:31.203

*   从 Synt L&F 的实例中我只会使用，关于[Nimbus L&F](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/nimbus.html)`Nimbus`的疯狂示例，其余方法在[Nimbus Defaults中](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/_nimbusDefaults.html#primary)

![在此处输入图像描述](../Images/f67f329b245512f5cea6def3abb56932.png) ![在此处输入图像描述](../Images/df8caffab284bb78e445ac26a18918fc.png)

从代码（Java6）

```
import com.sun.java.swing.Painter;
import java.awt.Color;
import java.awt.Graphics2D;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;

public class ScrollDemo extends JFrame {

    private static final long serialVersionUID = 1L;

    public ScrollDemo() {
        JTextField field = new JTextField();
        String[] columnNames = {"Column"};
        Object[][] data = {
            {"A"}, {"B"}, {"C"}, {"D"}, {"E"}, {"F"},
            {"A"}, {"B"}, {"C"}, {"D"}, {"E"}, {"F"},
            {"A"}, {"B"}, {"C"}, {"D"}, {"E"}, {"F"},
            {"A"}, {"B"}, {"C"}, {"D"}, {"E"}, {"F"},
            {"A"}, {"B"}, {"C"}, {"D"}, {"E"}, {"F"},};

        add(new JScrollPane(new JTable(data, columnNames)));
        pack();
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setVisible(true);
    }

    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel("com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel");
        } catch (Exception fail) {
        }
        UIManager.getLookAndFeelDefaults().put("ScrollBar:ScrollBarThumb[Enabled].backgroundPainter",
                new FillPainter(new Color(255, 169, 191)));
        UIManager.getLookAndFeelDefaults().put("ScrollBar:ScrollBarThumb[MouseOver].backgroundPainter",
                new FillPainter(new Color(127, 255, 191)));
        UIManager.getLookAndFeelDefaults().put("ScrollBar:ScrollBarTrack[Enabled].backgroundPainter",
                new FillPainter(new Color(0, 212, 255)));
        UIManager.getLookAndFeelDefaults().put("ScrollBar:\"ScrollBar.button\".size", 20);
        //UIManager.getLookAndFeelDefaults().put("ScrollBar.decrementButtonGap", 10);
        //UIManager.getLookAndFeelDefaults().put("ScrollBar.incrementButtonGap", 10);
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                ScrollDemo scrollDemo = new ScrollDemo();
            }
        });
    }
}

class FillPainter implements Painter<JComponent> {

    private final Color color;

    public FillPainter(Color c) {
        color = c;
    }

    @Override
    public void paint(Graphics2D g, JComponent object, int width, int height) {
        g.setColor(color);
        g.fillRect(0, 0, width - 1, height - 1);
    }
} 
```

# php - 如果文件存在，IIS 7如何调 用脚本

> ID：11347297
> 
> 赞同：0
> 
> 时间：2012-07-05T15:12:53.263
> 
> 标签：php, iis-7, windows-server-2008-r2

不确定这是否可能。每次运行我网站上的页面时，我都想运行一个 php 脚本。因此，如果我到达 example.com/test/runme.php，我想运行 checkme.php，然后继续运行 runme.php。有点像当出现 404 错误时，您可以告诉它运行脚本，我希望它在成功的文件上运行脚本。基本上检查机器是否有权查看它。我正在运行 2008 r2 服务器 iis7。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:15:10.590

您可以为 IIS 创建一个自定义 HTTP 模块，我怀疑只是在每个 php 脚本中放置一个 require() 以首先调用另一个会更容易。

# java - Hotmail SMTP 不适用于 javamail

> ID：11347298
> 
> 赞同：0
> 
> 时间：2012-07-05T15:12:56.190
> 
> 标签：java, smtp, jakarta-mail, hotmail

我正在尝试编写一个简单的 Java 程序来使用 JavaMail API 从我的 hotmail 帐户发送电子邮件。这是我的代码：

```
import java.util.Properties;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class HotMailSend {
public static void main(String args[])
{
    final String username = HOTMAIL.username;
    final String password = HOTMAIL.password;

    Properties props = new Properties();
    props.setProperty("mail.smtp.auth", "true");
    props.setProperty("mail.smtp.starttls.enable", "true");
    props.setProperty("mail.smtp.host", "smtp.live.com");
    props.setProperty("mail.smtp.port", "587");

    Session session = Session.getInstance(props,
      new javax.mail.Authenticator() {
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(username, password);
        }
      });

    try {

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress(HOTMAIL.username));
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(GMAIL.username));
        message.setSubject("Testing Subject");
        message.setText("Hey Buddy..!!!,"
            + "\n\n No spam to my email, please!");

        Transport.send(message);

        System.out.println("Done");

    } catch (MessagingException e) {
        throw new RuntimeException(e);
    }
} 
```

}

这是我得到的错误：

> 线程“main”中的异常 java.lang.RuntimeException: javax.mail.MessagingException: Can't send command to SMTP host; 嵌套异常是：java.net.SocketException：连接由远程主机在 HotMailSend.main(HotMailSend.java:45) 引起：javax.mail.MessagingException：无法向 SMTP 主机发送命令；嵌套异常是： java.net.SocketException: Connection closed by remote host at com.sun.mail.smtp.SMTPTransport.sendCommand(SMTPTransport.java:2163) at com.sun.mail.smtp.SMTPTransport.sendCommand(SMTPTransport.java :2150) 在 com.sun.mail.smtp.SMTPTransport.close(SMTPTransport.java:1220) 在 javax.mail.Transport.send0(Transport.java:197) 在 javax.mail.Transport.send(Transport.java: 124) 在 HotMailSend.main(HotMailSend.java:40) 引起：java.net。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-04T17:40:07.743

我以前用过 Hotmail 的 SMTP/Javamail，所以它确实有效。您是否在短时间内发送了大量电子邮件？（我认为当您这样做作为垃圾邮件预防措施时，他们可能会阻止您的邮件或将其发送到垃圾文件夹。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-06T17:00:19.977

检查您当前使用的电子邮件是否收到了来自 Microsoft 的消息。

我遇到了这个问题，当我查找它时，我收到一封包含以下主题的电子邮件：验证您的帐户以在 Outlook.com 上做更多事情。

他们让我确认我真的是一个人，这样我就可以继续发送自动消息。他们向我的手机发送了一条消息，我设法继续使用 Java Mail 发送电子邮件。

# jquery - Jquery clickevent检查url

> ID：11347299
> 
> 赞同：0
> 
> 时间：2012-07-05T15:12:56.343
> 
> 标签：jquery

我正在尝试实现一种方法来检查当前页面上的链接使用点击是否相同，什么都不会发生。否则转到链接用户单击的位置。我知道

```
var pathname = window.location.pathname; 
```

获取当前链接。但不确定当用户点击时如何获取链接...

非常感谢 ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:16:14.077

将点击事件绑定到所有链接。我会`location.href`用来获取相同的页面，而不是`.pathname`太。

```
​$("a").click(function() {
    var pathname = window.location.href;
    console.log(pathname);
    if (this.href == pathname) {
        alert ("Same site. no go");
        return false;
    }
})​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:16:18.480

假设您使用的是 1.7 及更高版本，这将更新页面上的所有链接和未来链接。

```
$("a").on("click", function(){
   var linkAddress = $(this).attr('href');
   if(linkAddress==pathname){
      return false;
   }
   return true;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:21:59.073

你可以用这个变量剥离锚点

```
var anchor = document.location.hash; 
```

并检查留下了什么。例子

```
$(".button").click(function(){
   var anchor = document.location.hash;
   if ( anchor === '#myLink1' ) {//u can set ( if same page do nothing here)
     alert('ok');
   }else{ alert('not ok');}
}); 
```

html

```
<a class="button" href="#myLink1">1</a> 
```

# encryption - 安全与认证：SSL 与 SASL

> ID：11347304
> 
> 赞同：69
> 
> 时间：2012-07-05T15:13:24.963
> 
> 标签：encryption, ssl, md5, kerberos, sasl

我的理解是 SSL 将加密算法（如 AES、DES 等）与密钥交换方法（如 Diffie-Hellman）相结合，在不安全的网络（如 Internet）上的两个端点之间提供安全加密和识别服务.

我的理解是 SASL 是一个 MD5/Kerberos 协议，它几乎做同样的事情。

所以我的问题是：选择两者的优点/缺点是什么，哪些情况更可取？基本上，我正在寻找一些在选择 SSL 或改用 SASL 时要遵循的准则。提前致谢！

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2012-07-08T18:41:12.923

SSL/TLS 和 SASL 很难比较，因为 SSL/TLS 是一种通信协议，而 SASL 是一个框架，与其他协议集成。（事实上​​，在某些情况下，您可以同时使用两者。）

此外，您提到了 Kerberos，它确实是一种身份验证协议（可以与 SSL/TLS 或 SASL 一起使用，或者两者都独立使用）。您的问题似乎表明是否使用 Kerberos 作为您应该首先选择的主要子问题之一。

SASL 本质上是一个间接层，允许在现有应用程序协议（例如 LDAP、SMTP、Subversion 等）中实现可插入的身份验证系统和数据安全性，尽管这些协议需要了解此扩展（例如[SMTP auth](https://www.rfc-editor.org/rfc/rfc4954)）。它是否以及如何提供安全身份验证和数据加密在很大程度上取决于该框架内使用的[底层机制。](http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer#SASL_mechanisms)这是[`svnserve`文档](http://svnbook.red-bean.com/nightly/en/svn.serverconfig.svnserve.html#svn.serverconfig.svnserve.sasl.encryption)中的一个示例：“*内置的 CRAM-MD5 机制不支持加密，但 DIGEST-MD5 支持*”。如果您想将 Kerberos 与 SASL 一起使用，您将需要另一个级别的间接：[GSS-API](http://docs.oracle.com/cd/E19683-01/816-1331/overview-6/index.html)（它最常与 Kerberos 一起使用，但也可以允许其他机制）。（注意`GSSAPI`无论如何，在 SASL 的上下文中似乎暗示了 Kerberos，不像它的[`GS2`继任者](https://www.rfc-editor.org/rfc/rfc5801#section-1)。）

SSL/TLS 的总体目标是保护客户端和服务器之间的通信（完整性和机密性）。客户端应始终检查 SSL/TLS 服务器的身份，它也为服务器提供了检查客户端身份的机制。它可以做什么也取决于它的配置方式。SSL/TLS 最常与 X.509 证书一起使用：这就是浏览器检查 HTTPS 服务器身份的方式。服务器还可以配置为请求客户端使用证书来标识自己（客户端证书身份验证）。然而，如果你想使用 Kerberos，你可以使用 TLS [Kerberos cipher suites](https://www.rfc-editor.org/rfc/rfc2712)。这不太常见，但它们[在 JSSE 中实现](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html#KRB)。

它的实现通常提供类似于普通 TCP 连接的 API：在 Java 中，一旦配置好，您就可以或多或少地使用 an `SSLSocket`，就像使用普通的`Socket`. [尽管某些协议具有从普通连接（隐式与显式 SSL/TLS](https://serverfault.com/a/368574/47187)）切换到 SSL/TLS 的显式命令，但这不需要套接字顶部的协议的特定意识。它还可以提供身份验证。在 Java 中，[JSSE](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html)是默认的 SSL/TLS 实现，它可以让你访问`SSLSocket`（或者`SSLEngine`如果你足够勇敢的话）。

您可能想阅读“[*何时使用 Java GSS-API 与 JSSE*](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jgss/tutorials/JGSSvsJSSE.html) ”，它类似于“SASL 与 SSL/TLS”（尽管它似乎有一段时间没有更新，因为 JSSE*确实*支持现在 Kerberos 密码套件，至少从 Oracle Java 6 开始）。

我承认我对 SASL 的了解比对 SSL/TLS 的了解要少，但是通过 SASL 进行数据加密听起来会更费力。它似乎没有某些 SSL/TLS 功能，例如[EDH 密码套件提供的 Perfect Forward Secrecy](https://security.stackexchange.com/a/14083/2435)。JGSS 教程中有一个[将 SASL 与 GSSAPI（此处为 Kerberos）一起使用的示例](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jgss/lab/part2.html#SASL)：您需要显式地包装/解包数据，而使用`SSLSocket`s.

我认为您主要关心的应该是首先决定要使用哪种身份验证机制：Kerberos、X.509 证书或其他。这将对您的整体架构产生更大的影响，并且两者都可以与 SASL 和 SSL/TLS 一起使用（如果您`EXTERNAL`在 SSL/TLS 连接之上使用带有机制的 SASL，则更是如此）。

*   Kerberos 非常集中。除了能够联系您的应用程序服务器之外，客户端还需要能够联系 KDC 以进行身份​​验证。还需要将客户端配置为使用该 KDC。从用户的角度来看，他们可以使用密码。
*   X.509 更加分散。但是，您可能需要为您的用户证书部署证书颁发机构（或使用商业证书颁发机构）。用户需要获得证书和私钥，有些人可能会觉得这太复杂了。

JAAS 之所以出现，是因为它是用于处理身份验证和授权的通用 Java 框架。它与安全管理器的概念密切相关。它为您提供了[`Subject`和`Principal`](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jaas/JAASRefGuide.html#Subject)的概念。这与协议或通信没有直接关系，而是与您在应用程序中对身份验证和授权建模的方式有关。（它为您提供了一组标准的类来执行此操作。）

（我通常建议阅读[Java 参考文档](http://docs.oracle.com/javase/7/docs/technotes/guides/security/)，其中提到了您所追求的词：JGSS、SASL、...，尽管它们不一定容易阅读。）

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-07-07T23:44:44.660

**SSL 与 SASL**

确实，SASL 不是协议，而是抽象层。SSL 和 SASL 也确实提供了类似的功能。它们都提供身份验证、数据签名和加密。

SSL 在传输层完成，*通常*对底层协议是透明的。例如，您可以在 LDAP 或 HTTP 上使用 SSL。但是，在某些情况下，需要修改现有协议才能切换到安全模式。例如，POP3 和 IMAP 扩展为具有命令[STARTTLS](http://en.wikipedia.org/wiki/STARTTLS)来启动 SSL 的使用。从这个角度来看，这有点类似于 SASL 所做的事情。

另一方面，许多协议也被扩展以提供 SASL 能力。 [这](http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer)是协议列表。同样，POP3 和 IMAP 是其中的两个，它们使用不同的命令来启动身份验证。

那么，什么时候应该使用 SSL，什么时候应该使用 SASL？

SSL 和 SASL 之间的一个明显区别是 SASL 允许您选择不同的机制来对客户端进行身份验证，而 SSL 则被绑定为基于证书进行身份验证。在 SASL 中，您可以选择使用 GSSAPI、Kerberos、NTLM 等。

由于这种差异，在某些情况下，使用 SASL 而不是 SSL 更直观。例如，您的客户端应用程序正在使用 Kerberos 对最终用户进行身份验证。您的服务器需要对客户端进行身份验证。由于您的客户端应用程序已经有一个 Kerberos 凭据（在 Kerberos 术语中是票证），因此使用 Kerberos 凭据向服务器进行身份验证是有意义的。当然，您始终可以设置 SSL 来做同样的事情。但是，这意味着在现有 Kerberos 基础设施之上，您需要设置证书颁发机构基础设施，并以某种方式将客户端证书与 Kerberos 凭据相关联。这是可行的，但工作量很大。

此外，有时，您需要使用一些仅在 SASL 机制中可用但在 SSL 中不可用的功能。例如，Kerberos 允许您将票据从客户端转发到服务器，以便服务器可以使用票据代表客户端查询一些资源。一个常见的例子是你有一个应用服务器和一个数据库。客户端应用程序向应用程序服务器进行身份验证，并且应用程序服务器需要使用客户端的凭据代表客户端查询数据库。SSL 无法为您提供此功能，但 Kerberos 支持此功能。因此，在这种情况下，您必须选择使用 SASL。

在某些情况下，您确实想使用 SSL 而不是 SASL。例如，扩展协议不是一种选择，或者您想加密使用底层协议交换的每个数据包。

**GSSAPI 与 Kerberos 和 SASL 有何关系**

根据这个[wiki 页面](http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer)，SASL 中支持 GSSAPI 和 Kerberos 的机制。GSSAPI 是一个通用的编程接口。这个想法是让应用程序编写者使用一个通用 API 来进行身份验证、加密等，而不管下面使用什么协议。GSSAPI 实现 Kerberos。因此，您可以使用 GSSAPI 进行 Kerberos 身份验证。

**JAAS 与 SASL 有何关系**

老实说，我不是 Java 专家。根据我的阅读，听起来 JAAS 只是一个可插入的身份验证框架。我相信这个想法类似于 GSSAPI。无论使用什么身份验证方法，它都提供一个单一的编程接口。GSSAPI 专注于身份验证和安全消息交换，而 JAAS 专注于身份验证和授权。我没有找到任何证据表明 JAAS 也是 SASL 机制之一。我相信 Java 库中应该有一些帮助类可以帮助您实现自定义 SASL 机制。在实现自定义 SASL 机制时，只使用 JAAS 可能是有意义的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-07T21:20:11.777

SASL 不是协议，而是某些身份验证机制的抽象层。如果您使用 Digest-MD5 或 GS​​S-API 作为您的 SASL 机制，您可以请求 SASL 来完全加密您的数据流量。例如，这就是我与您的 Active Directory 服务器对话的方式。您将不需要 SSL。你的用例是什么？请详细说明！

# aptana - 使用 Aptana 创建新项目的库不兼容

> ID：11347306
> 
> 赞同：1
> 
> 时间：2012-07-05T15:13:31.710
> 
> 标签：aptana

我是一个 ruby​​ 和 rails 新手，所以我的调试能力有些有限。

我刚刚添加了失败的eclipse插件，然后下载了最新的aptana studio，但也失败了。两种情况下的失败都是一样的。

失败的本质是，当我创建一个新的 rails 项目时，我收到一条关于库版本不兼容的错误消息“C:/Ruby193/lib/ruby/gems/1.9.1/gems/mongrel-1.1.5-x86 -mswin32-60/lib/http11.so”。该项目实际上是与目录和文件一起创建的。

围绕此错误消息的 Google 搜索只返回了几次点击，这不是很有帮助

我想知道这是否是关于 64 位库。

我的软件堆栈是：

*   Windows 7 家庭高级版 64 位
*   Aptana RadRails，构建：2.0.5.1278709071
*   Ruby1.9.3 宝石 1.8.24

控制台显示：

```
"4320"
C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': iconv will be deprecated in the future, use String#encode instead.
C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': incompatible library version - C:/Ruby193/lib/ruby/gems/1.9.1/gems/mongrel-1.1.5-x86-mswin32-60/lib/http11.so (LoadError)
    from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-2.3.4/lib/active_support/dependencies.rb:156:in `block in require'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-2.3.4/lib/active_support/dependencies.rb:521:in `new_constants_in'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-2.3.4/lib/active_support/dependencies.rb:156:in `require'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mongrel-1.1.5-x86-mswin32-60/lib/mongrel.rb:12:in `<top (required)>'
    from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'
    from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'
    from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-2.3.4/lib/active_support/dependencies.rb:156:in `block in require'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-2.3.4/lib/active_support/dependencies.rb:521:in `new_constants_in'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-2.3.4/lib/active_support/dependencies.rb:156:in `require'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.0.0/lib/rack/handler/mongrel.rb:1:in `<top (required)>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.0.0/lib/rack/handler.rb:17:in `const_get'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.0.0/lib/rack/handler.rb:17:in `block in get'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.0.0/lib/rack/handler.rb:17:in `each'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.0.0/lib/rack/handler.rb:17:in `get'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/rails-2.3.4/lib/commands/server.rb:45:in `<top (required)>'
    from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from script/server:3:in `<top (required)>'
    from -e:2:in `load'
    from -e:2:in `<main>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T07:26:07.363

如上所述，这是关于 mongrel 的一个版本。请参阅[http://en.wikipedia.org/wiki/Mongrel_(web_server](http://en.wikipedia.org/wiki/Mongrel_(web_server) )。

一个重要的部分是：

*在原作者 Zed Shaw 离开 Ruby on Rails-scene[4] 之后，Mongrel 的发布停止了。当前版本 1.1.5 不再能够安装在高于 1.9.2 的 Ruby 版本中，这是为 Rails 3 推荐的，修复方法是使用不稳定的 Mongrel 更旧的 1.2.0-pre2 版本。*

由于我是一个天真的 ruby​​ 用户，我想我会通过这些步骤来使 Aptana 工作。

```
1: run the command line interpreter, ensuring ruby is on the path
2: gem install -v 1.2.0-pre2 mongrel
3: Run aptana
4: open windows/preferences/rails
5: set the mongrel_rails path 
```

我在 <ruby_home>/lib/ruby/gems/1.9.1/mongrel-1.2.0.pre2-x86-mingw32/bin/mongrel_rails 中找到了我的 mongrel_rails 路径

希望这对其他人有帮助

# html - css中的行间文本

> ID：11347307
> 
> 赞同：2
> 
> 时间：2012-07-05T15:13:35.357
> 
> 标签：html, css

在 CSS 中，我该怎么做：

```
---Item--- 
```

破折号像线一样连接？

我想到了：

```
border-bottom: 3px solid #000; 
```

但是我不能向上移动线加上线将在文本后面，而不是围绕文本

我的 HTML

```
<ul>
    <li class="sub-menu-item" ><a href="#">FACULTY&STAFF</a></li>
</ul> 
```

（如果可能，我想避免接触 HTML）

以上所有内容都可以通过css实现还是我应该只使用图像？

我的目标是 ie8 及更高版本（当然还有所有新的浏览器）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T15:24:08.700

`&mdash;`使用 CSS`:before`和选择器在您的内容之前和之后注入`:after`。您需要使用转义的 unicode，如此[处所述](https://stackoverflow.com/questions/190396/adding-html-entities-using-css-content)：

```
li.sub-menu-item:before,  li.sub-menu-item:after {
    content: "\2014"
}​ 
```

请参阅[JSFiddle](http://jsfiddle.net/EXCU8/)。对于较短的行，您可以使用 ndash。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:23:20.560

这是一个开始：

```
.sub-menu-item
{
    border-bottom:1px solid black;
    height:0.6em;
    width:200px;
    text-align:center;
    margin-bottom:1em;

}
.sub-menu-item > a
{
    text-decoration:none;
    background:white;
} 
```

[​http://jsfiddle.net/NpP5F/3/](http://jsfiddle.net/NpP5F/3/) **（更新为可处理多个项目）**

经测试可在 Firefox、IE 和 Chrome 中运行。现在请记住，这在小提琴中是孤立的。可能需要进行一些调整才能使其在其他 html 元素和样式等中工作。无论如何，概念证明。可以办到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T14:29:53.060

您可以创建一个带有border-top 和border-bottom, line-height: 0 的div，其中有一个定义了背景颜色的span：

```
<div class="test">
   <span>BLA BLA BLA </span>
</div> 
```

和CSS：

```
.test {
border-bottom: 1px solid #D7D7D7;
border-top: 1px solid #A1A1A1;
line-height: 0;
text-align: center; }

.test span { 
background-color: #BABABA;
padding: 0 10px; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:16:33.120

从理论上讲，您可以使用`<hr/>`然后设置它的长度并强制它显示内联。或者，如果您的编码支持，请使用一些特殊的 unicode 字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:27:46.773

尝试这个。:) 它使用图像，这是一个优点，因为它允许您根据需要设置破折号的样式，并且不会处理任何奇怪的边距或任何可能弄乱其余布局的东西。

```
li.sub-menu-item
{
    background-image: url('http://i.imgur.com/JIa6C.png'); /* Just a transparent PNG with a line in the middle */
}

li.sub-menu-item a
{
    background-color: #FFF;
    padding: 0 10px;
    margin-left: 200px /* So you can see the left side of the line too */
} 
```

[http://jsfiddle.net/wAb8C](http://jsfiddle.net/wAb8C)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-05T15:24:03.310

在不更改代码的情况下：

```
ul li{
position: relative;
border-bottom: 1px solid #000;
}

ul li a{

position: relative;
background: #fff;
left: 0;
bottom: -10px;
margin-left: 10px;
color: orange;
text-decoration: none;
}​ 
```

[这里的例子](http://jsfiddle.net/wVKKv/)

# drupal - drupal同一页面中的2个表单

> ID：11347312
> 
> 赞同：0
> 
> 时间：2012-07-05T15:14:02.167
> 
> 标签：drupal, drupal-6

我需要知道是否有办法在同一页面中显示 2 个表单，原因是我希望在表单中有一个搜索字段，当提交时，form2 显示数据列表，在 form2 中有当您可以为列表选择项目并为所选项目设置评论时的文本字段，因此当 form2 提交时保存有关每个所选项目的信息。

那么有办法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T18:21:22.317

您可以使用一个带有两个提交按钮的表单而不是两个表单，这两个提交按钮可以具有单独的提交功能

# objective-c - 故事板编辑器布局混乱

> ID：11347314
> 
> 赞同：0
> 
> 时间：2012-07-05T15:14:14.293
> 
> 标签：objective-c, ios, uikit, storyboard

我在使用相当简单的屏幕的故事板编辑器时遇到了布局问题。我有一个 UIViewController，我在 0,0 处添加了一个 320x440 UIScrollView，然后在 0,440 处添加了一个 320x20 UIProgressBar。它在 Storyboard 编辑器中看起来不错。鉴于 Storyboard 计算的 CGRect 框架坐标，我不完全确定屏幕顶部的 20 像素状态栏是如何容纳的。

在加载（in `-(void)viewDidLoad`）时，UIScrollView 框架似乎在 0,0 处设置为**320x460** 像素，但 UIProgressBar 在 0,440 处仍然是 320x20。

当我向 UIScrollView 添加子视图（尤其是 UIImageViews）时，它们会在屏幕上被拉伸并被剪裁，因为尽管 UIScrollView 认为它的高度为 460 像素，但它只有 440 像素的屏幕可以显示。

谁能指出我的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:53:02.230

好的 - 我已经确定了发生了什么 - 存在许多问题，几乎都与各种视图控制器上的故事板属性中的相互不兼容的设置有关。

总之，包含 UIScrollView 的主视图控制器勾选了“想要全屏”复选框 - 天知道怎么做，但似乎我已经通过其他视图尝试通过剪辑、调整大小、设置布局约束来补偿初始错误等等，这导致了相当混乱的结果。

我的建议是不要在故事板编辑器中触摸任何东西，除非你知道它会产生什么影响——这是一个危险的地方。我通过回到基础并创建我的应用程序的简单复制然后观察该应用程序与我自己的应用程序之间的差异来发现问题。抱歉，如果我浪费了任何人的时间来研究答案。

谢谢

# regex - 如何使用正则表达式从 SSIS 中的一列中提取邮政编码

> ID：11347316
> 
> 赞同：1
> 
> 时间：2012-07-05T15:14:22.930
> 
> 标签：regex, ssis

我正在尝试使用自定义正则表达式清理转换（在[此处](http://www.sqlis.com/post/RegexClean-Transformation.aspx)找到信息）从混合地址列（Address3）中提取邮政编码并将其移动到新列（邮政编码）

传入数据示例：

```
Address3: "London W12 9LZ" 
```

传入的数据可以是地名与开头、中间或结尾（或根本没有）的邮政编码的任意组合。

期望的结果：

```
Address3: "London"
Post Code: "W12 9LZ" 
```

本质上，用简单的英语，“移动（而不是复制）从 address3 找到的任何邮政编码到邮政编码”。

我的正则表达式技能并不出色，但我已经设法使用以下正则表达式提取邮政编码并将其放入自己的列中，从 Address3 匹配并替换为邮政编码：

匹配表达式：

```
(?<stringOUT>([A-PR-UWYZa-pr-uwyz]([0-9]{1,2}|([A-HK-Ya-hk-y][0-9]|[A-HK-Ya-hk-y][0-9]     ([0-9]|[ABEHMNPRV-Yabehmnprv-y]))|[0-9][A-HJKS-UWa-hjks-uw])\ {0,1}[0-9][ABD-HJLNP-UW-Zabd-hjlnp-uw-z]{2}|([Gg][Ii][Rr]\ 0[Aa][Aa])|([Ss][Aa][Nn]\ {0,1}[Tt][Aa]1)|([Bb][Ff][Pp][Oo]\ {0,1}([Cc]\/[Oo]\ )?[0-9]{1,4})|(([Aa][Ss][Cc][Nn]|[Bb][Bb][Nn][Dd]|[BFSbfs][Ii][Qq][Qq]|[Pp][Cc][Rr][Nn]|[Ss][Tt][Hh][Ll]|[Tt][Dd][Cc][Uu]|[Tt][Kk][Cc][Aa])\ {0,1}1[Zz][Zz]))) 
```

替换表达式：

```
${stringOUT} 
```

所以这给我留下了：

```
Address3: "London W12 9LZ"
Post Code: "W12 9LZ" 
```

我的下一个想法是保留上述匹配/替换，然后添加另一个以匹配与上述正则表达式不匹配的任何内容。我认为这可能是一个负面的前瞻性，但我似乎无法让它发挥作用。

我正在使用 SSIS 2008 R2，我认为正则表达式清理转换使用 .net 正则表达式实现。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:29:00.123

刚刚解决了这个。像往常一样，它的逻辑比我想象的要简单。我没有尝试匹配非邮政编码字符串并将其替换为自己，而是添加了另一行再次匹配邮政编码并将其替换为“”。

所以总的来说，我有：

1.  使用上述正则表达式匹配邮政编码并将其移动到邮政编码列
2.  使用上述正则表达式匹配邮政编码，并在 Address3 列中将其替换为“”

# html - HTML 在预期时没有中断

> ID：11347319
> 
> 赞同：0
> 
> 时间：2012-07-05T15:14:29.903
> 
> 标签：html

我正在制作的网站中有一个奇怪的拆分错误。网站上的任何地方都以正确的方式拆分文本。但在一个街区它不是。

[http://www.spanjevakantiewinkel.nl/](http://www.spanjevakantiewinkel.nl/)

在底部：“aankomende evenementen”。布诺尔，最后一句话在下一个街区的话下！但是这些块的所有 CSS 都是一样的。

我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:18:56.483

该段落的文本内容`&nbsp;`（可能`\u00A0`在原始数据中）在最后一个单词之间而不是普通空格。摆脱那些，它会正确换行。

# progress-4gl - 远程测试 AppServer/数据库可用性 4GL

> ID：11347327
> 
> 赞同：1
> 
> 时间：2012-07-05T15:15:07.550
> 
> 标签：progress-4gl, openedge

我们有在 AIX UNIX 上运行的 Progress 应用程序服务器 (OE 10.0B05)，我想编写一些代码来检查它们是否启动并运行。检查应用服务器的代码将从 WIN2008 服务器运行。我可以在 WIN2008 服务器上打开 Progress Explorer 来检查应用服务器的状态，但我需要编写一些代码来以编程方式检查它们的状态。

有没有办法以编程方式检查我的 AIX UNIX Progress 应用服务器是否已启动并从远程 WIN2008 服务器运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T21:34:38.857

要获取应用服务器状态信息，您可以使用“asbman”。

要远程获取它，您需要一些方法来调用远程进程并返回一个值。我是一个 unix 人，所以我通常使用“ssh”来处理这类事情。

有 Windows 版本的 SSH（查看 PuTTY 套件以获得非常好的免费选项）。如果您将其设置为使用预共享密钥或“代理”，则不会出现混乱的登录提示。类似（未经测试）：

plink -i sshkey.ppk user@server.name "asbman -name appServer -query"

“asbman”还支持 -host 和 -port 参数，如果你碰巧让它运行在你想要从中进行查询的 windows 框上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:36:26.297

如果您有一个可以打开套接字连接的小程序，那就可以了。如果程序可以打开一个套接字，那么您可以相当确信应用服务器正在运行。

您可能可以使用 ABL SOCKET 功能来执行此操作。如果做不到这一点，任何其他可以在远程机器上打开套接字然后关闭它的程序都可以工作。b

# shell - TAR'ing 不同目录中的文件

> ID：11347331
> 
> 赞同：-1
> 
> 时间：2012-07-05T15:15:13.357
> 
> 标签：shell

以前从未在 Shell 中编码，需要 TAR 7 个文件，5 个位于一个目录中，两个位于另一个目录中。听起来很简单，对吧？应该。我猜我们将变量分配给每个文件，然后将它们 TAR。这个语法是如何工作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:29:08.823

```
tar -zcvf -T <file_name> abc.tar.gz 
```

where`<file_name>`包含要包含在 .tar.gz 中的文件列表

# php - 为什么 mysqli_fetch_array 将数组分开？

> ID：11347335
> 
> 赞同：0
> 
> 时间：2012-07-05T15:15:26.233
> 
> 标签：php

我正在从 MySQL 数据库中检索值，并将它们填充到单选按钮中供用户选择。这些都包含在一个 div 中，其中的问题也是动态填充的。出于某种原因，它用问题填充了所有相关的答案，但是第二到第四个答案似乎与第一个答案分开，只有第一个问题有一个中断，知道什么会导致这种情况吗？以下是生成我正在做的事情的代码：

```
// Connect to the Database
require_once('mysqli_connect.php');

//create the query for the question
$q = "SELECT `Question` FROM tbl_Question WHERE QuestionID = 1";

//Create the query for the Answers
$q2 = "SELECT `Answer`,`AnswerStatusID` FROM tbl_Answer WHERE QuestionID = 1";

//Run the query
$r = mysqli_query($conn,$q);

//run the answer quert
$r2 = mysqli_query($conn,$q2);

//Assign the AnswerStatusID to a var
$AnswerStatusID[] = $row2['AnswerStatusID'];

while($row = mysqli_fetch_array($r,MYSQLI_ASSOC)){
echo '<div id="Question1"><p>1)' . $row['Question'] . '</p>';
}

while($row2 = mysqli_fetch_array($r2,MYSQLI_ASSOC)){
echo '<input name="q1" type="radio"value="'.$AnswerStatusID.'"/>' . $row2['Answer'] . '</div><br/>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:43:14.270

好的，问题在于问题回声中的开始 div 和答案回声中的结束 div 标签。我关闭了问题回声中的 div 并在答案部分添加了一个打开的 div 标签，这清除了疯狂的样式和答案的分离

# spring - RedirectAttributes 在 Spring 3.1 中给出 IllegalStateException

> ID：11347337
> 
> 赞同：5
> 
> 时间：2012-07-05T15:15:33.507
> 
> 标签：spring, spring-mvc

我想使用Spring 3.1 中出现的[RedirectAttibutes](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/index.html)属性，我的控制器中有以下处理程序方法用于发布

```
 @RequestMapping(value = "/register", method = RequestMethod.POST)
public String register(@ModelAttribute("admin") Admin admin, BindingResult bindingResult, SessionStatus sessionStatus, RedirectAttributes redirectAttributes) {
    redirectAttributes.addAttribute("admin", admin);
    if (bindingResult.hasErrors()) {
        return REGISTRATION_VIEW;

    }
    sessionStatus.setComplete();
    return "redirect:list";
} 
```

但是当我提交表单时，出现以下异常：

```
java.lang.IllegalStateException: Argument [RedirectAttributes] is of type Model or Map but is not assignable from the actual model. You may need to switch newer MVC infrastructure classes to use this argument.
org.springframework.web.bind.annotation.support.HandlerMethodInvoker.resolveHandlerArguments(HandlerMethodInvoker.java:322) 
```

我遇到了一些重定向属性的问题，你不能使用 ModelAndView 作为返回类型。所以我只返回了字符串视图。

任何人都可以请。告诉我哪里出错了？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-05T15:45:58.027

Spring 3.1 引入了新版本的 Spring MVC 后端实现 ( `RequestMappingHandlerMapping`/ `RequestMappingHandlerAdapter`) 来替换旧版本 ( `DefaultAnnotationHandlerMapping`/ `AnnotationMethodHandlerAdapter`)。

Spring MVC 3.1 的一些新特性，例如`RedirectAttributes`，仅由新实现支持。

如果您使用`<mvc:annotation-driven>`或`@EnableWebMvc`启用 Spring MVC，则默认情况下应启用新实现。但是，如果您声明`HandlerMapping`和/或`HandlerAdapter`手动或使用默认实现，则需要显式切换到新实现（例如，通过切换到`<mvc:annotation-driven>`，如果它不会破坏您的配置）。

# mysql - MySQL 插入失败

> ID：11347342
> 
> 赞同：-3
> 
> 时间：2012-07-05T15:15:45.457
> 
> 标签：mysql, derby

我的代码是

```
connect 'jdbc:derby:sampleclient';
    set schema SYMMETRIC;
    insert into "sale_transaction" ("tran_id", "store", "workstation", "day", "seq") values (1000, '1', '3', '2007-11-01', 100);
    insert into "sale_return_line_item"("tran_id", "item_id"," price", "quantity") values (1000, 110000055, 0.65, 1); 
    select * from "sale_transaction";
    select * from "sale_return_line_item"; 
```

我试图从 derby 将数据插入 mysql，即我正在复制数据，但是当我输入下面的命令时，我得到如下所示的错误，并且 push-derby2mysql 是包含代码的文件

```
 C:\symmetric-ds-3.0.1-server\symmetric-ds-3.0.1\samples>sh ij.sh push-derby2my
    l.sql
    ij version 10.5
    ij> connect 'jdbc:derby:sampleclient';
    ij> set schema SYMMETRIC;
    0 rows inserted/updated/deleted
    ij> insert into "sale_transaction" ("tran_id", "store", "workstation", "day",
    eq") values (1000, '1', '3', '2007-11-01', 100);
    ERROR 42X51: The class 'org.jumpmind.symmetric.db.derby.DerbyFunctions' does n
     exist or is inaccessible. This can happen if the class is not public.
    ERROR XJ001: Java exception: 'org.jumpmind.symmetric.db.derby.DerbyFunctions:
    va.lang.ClassNotFoundException'.
    ij> insert into "sale_return_line_item"("tran_id", "item_id"," price", "quanti
    ") values (1000, 110000055, 0.65, 1);
    ERROR 42X14: ' price' is not a column in table or VTI 'SYMMETRIC.sale_return_l
    e_item'.
    ij> select * from "sale_transaction";
    tran_id    |store|wo&|day       |seq
    --------------------------------------------

    0 rows selected
    ij> select * from "sale_return_line_item";
    tran_id    |item_id    |price       |quantity   |returned_q&
    ------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:21:33.013

如果您阅读错误..

> 'org.jumpmind.symmetric.db.derby.DerbyFunctions' 类不存在或不可访问。

那是防止任何插入发生，因此您的后选择不会得到任何东西。

如错误所示，检查：

1.  如果对**org.jumpmind.symmetric.db.derby.DerbyFunctions**的引用存在
2.  如果**org.jumpmind.symmetric.db.derby.DerbyFunctions**的文件存在（可能是这里的问题）
3.  如果课程是公开的（可能是）

**看起来您没有安装 SymmetricDS 包**。你可以从[这里](http://symmetricds.org/download)下载。

# c# - 在 Gridview 中绑定没有 SqlDataSource 的 DropDownList

> ID：11347343
> 
> 赞同：2
> 
> 时间：2012-07-05T15:15:49.250
> 
> 标签：c#, asp.net, gridview, binding, drop-down-menu

我意识到您可以使用 SqlDataSource 在 gridview 中轻松设置下拉列表，但是仅包含列表项的有限列表呢？如果没有 DataSource，将 Bind 放入所选值似乎不起作用。这是我到目前为止所得到的一个例子。

```
<EditItemTemplate>
   <asp:DropDownList ID="Fund"  runat="server" SelectedValue='<%# Bind("Fund") %>' >
      <asp:ListItem  Value="">---</asp:ListItem>
      <asp:ListItem Value="Test1">Test</asp:ListItem>
      <asp:ListItem Value="Test2">Test2</asp:ListItem>
   </asp:DropDownList>
</EditItemTemplate> 
```

这似乎是一个愚蠢的小问题，以至于我要在我的数据库中创建一个静态的 10 行表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:20:36.137

最简单的解决方案是在代码中创建 a`Dictionary<TKey,TValue>`并将其绑定到`DropDownList`or 如您提到的将其绑定到静态表...

示例代码：

```
Dictionary<string, string> list = new Dictionary<string, string>();
list.Add("item 1", "Item 1");
list.Add("item 2", "Item 2");
list.Add("item 3", "Item 3");
list.Add("item 4", "Item 4");

ddl.DataSource = list;
ddl.DataTextField = "Value";
ddl.DataValueField = "Key";
ddl.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:24:36.120

尝试这个：

```
Dictionary<string, string> items= new Dictionary<string, string>();
items.Add("-1","-Select-");
items.Add("Test1", "Test1");
items.Add("Test2", "Test2");
ddl.DataSource = items;
ddl.DataValueField = "Key";
ddl.DataTextField = "Value";
ddl.DataBind(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:48:07.860

您想以`DropDownList`编程方式设置。我真的建议避免使用`SqlDataSource`控件的用户。它非常笨重，在重用方面不是很好。

以下代码使用实体框架通过用户名从数据库中检索数据。使用此函数，您可以将所需的数据绑定到 ，`DropDownList`而无需在`SqlDataSource`每次需要调用此过程时创建一个。

```
public List<Record> GetAllRecordsByUserName(string credentials)
{
    List<Record> recordList;
    using (CustomEntities context = new CustomEntities())
    {

        IQueryable<Section> recordQuery = from records in context.Records
                                              where records.UserName == credentials
                                              select records; 
        recordList = recordQuery.ToList<Record>();
    }
    return recordList;
}

public void BindDropDown()
{
    DropDownList1.DataSource = GetAllRecordsByUserName("test.user");
    DropDownList1.DataBind();
} 
```

# sql-server - SQL Server 锁释放

> ID：11347344
> 
> 赞同：0
> 
> 时间：2012-07-05T15:15:58.360
> 
> 标签：sql-server, locking

假设我有一个正在更新记录并遇到记录锁的进程，阻止它继续。我假设该过程通常会阻塞（而不是失败并要求应用程序实现自己的重试逻辑）。

假设是这样，这个块/锁究竟是如何被释放的？我看到了两种通用的选择：（1）驱动程序每 N 毫秒轮询一次 SQL Server；(2) SQL Server 在释放锁时向驱动程序发出信号。

我确信驱动程序和配置等之间存在一些可变性，我正在寻找一个总体思路。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:18:21.140

两者都不。驱动程序不参与阻塞过程——执行查询的内部 SQL Server 线程（或纤程）是被阻塞的，并且可能涉及多种机制（一些旋转等待、一些轮询、一些阻塞等）。司机只是在等待结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:20:39.160

客户端“驱动程序”通常不参与，也不通知 SQL Server 的锁定。当他们的命令请求（通常是批处理）完成执行和/或准备好将数据传输回客户端时，SQL Server*会通知客户端。*

# linux - tcp connect 在高负载下随机失败

> ID：11347345
> 
> 赞同：5
> 
> 时间：2012-07-05T15:16:00.073
> 
> 标签：linux, tcp, linux-kernel, suse

我们的应用程序使用非阻塞套接字使用连接和选择操作（c 代码）。pusdo代码如下：

```
unsigned int ConnectToServer(struct sockaddr_in *pSelfAddr,struct sockaddr_in *pDestAddr)
    {
         int sktConnect = -1;
         sktConnect = socket(AF_INET,SOCK_STREAM,0);
         if(sktConnect == INVALID_SOCKET)
             return -1;
         fcntl(sktConnect,F_SETFL,fcntl(sktConnect,F_GETFL) | O_NONBLOCK);
         if(pSelfAddr != 0)
         {
             if(bind(sktConnect,(const struct sockaddr*)(void *)pSelfAddr,sizeof(*pSelfAddr)) != 0)
             {
                 closesocket(sktConnect);
                 return -1;
             }
         }
         errno = 0;
         int nRc = connect(sktConnect,(const struct sockaddr*)(void *)pDestAddr, sizeof(*pDestAddr));
         if(nrC != -1)
         {
             return sktConnect;
         }
         if(errno != EINPROGRESS)
         {
             int savedError = errno;
             closesocket(sktConnect);
             return -1;
         }
         fd_set scanSet;
         FD_ZERO(&scanSet);
         FD_SET(sktConnect,&scanSet);
         struct timeval waitTime;
         waitTime.tv_sec = 2;
         waitTime.tv_usec = 0;
         int tmp;
         tmp = select(sktConnect +1, (fd_set*)0, &scanSet, (fd_set*)0,&waitTime);
         if(tmp == -1 || !FD_ISSET(sktConnect,&scanSet))
         {
             int savedErrorNo = errno;
             writeLog("Connect %s failed after select, cause %d, error %s",inet_ntoa(pDestAddr->sin_addr),savedErrorNo,strerror(savedErrorNo));
             closesocket(sktConnect);
             return -1;
         } 
    .        .        .     .     .} 
```

有 80 个这样的节点，应用程序以循环方式连接到其所有对等节点。在这个阶段，一些节点无法连接（api – connect + select），错误号为 115。

> 在以下成功场景的日志（tcpdump 输出）中，我们可以看到 (SYN, SYN+ACK, ACK)，但 tcpdump 日志中的失败节点甚至没有 SYN 条目。

tcpdump 日志是：

```
387937 2012-07-05 07:45:30.646514 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [SYN] Seq=0 Ack=0 Win=5792 Len=0 MSS=1460 TSV=1414450402 TSER=912308224 WS=8 
387947 2012-07-05 07:45:30.780762 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [SYN, ACK] Seq=0 Ack=1 Win=5792 Len=0 MSS=1460 TSV=912309754 TSER=1414450402 WS=8 
387948 2012-07-05 07:45:30.780773 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [ACK] Seq=1 Ack=1 Win=5888 Len=0 TSV=1414450435 TSER=912309754 
All the above three events indicate the success information.
387949 2012-07-05 07:45:30.782652 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [PSH, ACK] Seq=1 Ack=1 Win=5888 Len=320 TSV=1414450436 TSER=912309754 
387967 2012-07-05 07:45:30.915615 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [ACK] Seq=1 Ack=321 Win=6912 Len=0 TSV=912309788 TSER=1414450436 
388011 2012-07-05 07:45:31.362712 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [PSH, ACK] Seq=321 Ack=1 Win=5888 Len=320 TSV=1414450581 TSER=912309788 
388055 2012-07-05 07:45:31.495558 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [ACK] Seq=1 Ack=641 Win=7936 Len=0 TSV=912309933 TSER=1414450581 
388080 2012-07-05 07:45:31.702336 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [PSH, ACK] Seq=1 Ack=641 Win=7936 Len=712 TSV=912309985 TSER=1414450581 
388081 2012-07-05 07:45:31.702350 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [ACK] Seq=641 Ack=713 Win=7424 Len=0 TSV=1414450666 TSER=912309985 
388142 2012-07-05 07:45:32.185612 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [PSH, ACK] Seq=713 Ack=641 Win=7936 Len=320 TSV=912310106 TSER=1414450666 
388143 2012-07-05 07:45:32.185629 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [ACK] Seq=641 Ack=1033 Win=8704 Len=0 TSV=1414450786 TSER=912310106 
388169 2012-07-05 07:45:32.362622 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [PSH, ACK] Seq=641 Ack=1033 Win=8704 Len=320 TSV=1414450831 TSER=912310106 
388212 2012-07-05 07:45:32.494833 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [ACK] Seq=1033 Ack=961 Win=9216 Len=0 TSV=912310183 TSER=1414450831 
388219 2012-07-05 07:45:32.501613 10.137.165.136        10.18.92.173          TCP      8441 > 33728 [PSH, ACK] Seq=1033 Ack=961 Win=9216 Len=356 TSV=912310185 TSER=1414450831 
388220 2012-07-05 07:45:32.501624 10.18.92.173          10.137.165.136        TCP      33728 > 8441 [ACK] Seq=961 Ack=1389 Win=10240 Len=0 TSV=1414450865 TSER=912310185 
```

应用程序日志在连接时通知错误（即 api - 连接 + 选择）

```
[5258: 2012-07-05 07:45:30]Connect [10.137.165.136 <- 10.18.92.173] success. 
[5258: 2012-07-05 07:45:32]Connect 10.137.165.137 fail after select, cause:115, error Operation now in progress. Check whether remote machine exist and the network is normal or not. 
[5258: 2012-07-05 07:45:32]Connect to server([10.137.165.137 <- 10.18.92.173], port=8441) Failed! 
```

与 tcpdump 的前 3 个条目对应的成功日志。以及 tcpdump 中没有事件的故障日志

> 我的问题是：当客户端为失败的情况启动“连接”api时，我无法在客户端的 tcpdump 中看到任何事件（甚至是初始 SYN）。这种随机性的原因可能是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T16:12:37.547

你打了`EINPROGRESS`。从`connect`手册页：

> 套接字是非阻塞的，连接不能立即完成。可以通过选择要写入的套接字来选择（2）或轮询（2）来完成。在 select(2) 指示可写后，使用 getsockopt(2) 读取 SOL_SOCKET 级别的 SO_ERROR 选项，以确定 connect() 是成功完成（SO_ERROR 为零）还是未成功完成（SO_ERROR 是此处列出的常见错误代码之一，解释了失败的原因）。

这表示`EINPROGRESS`内核现在无法完成连接，即使有可用的本地端口和路由缓存条目。当套接字状态尚未转换为“ESTABLISHED”时，似乎会发生这种情况。只需再次等待套接字`select`，但`getsockopt`稍后再调用以查看您`connect`是否已完成。

至于为什么，套接字在连接期间转换为 SYN_SENT 状态，但数据包可能仍在输出队列中，尚未真正到达网络设备缓冲区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T13:22:21.607

返回后`select()`，您实际上并没有获取套接字的当前状态 - 您看到的是一个陈旧的值`errno`（调用遗留下来的`connect()`）。很可能您`select()`只是在超时后返回。

返回后，您需要调用`getsockopt(sktConnect, SOL_SOCKET, SO_ERROR, &err, ...)`以获取套接字的实际状态`select()`。

# c - ALSA 相当于 /dev/audio 转储？

> ID：11347346
> 
> 赞同：15
> 
> 时间：2012-07-05T15:16:03.293
> 
> 标签：c, alsa

这将是我有史以来最糟糕的问题......

在一台旧上网本上，我安装了一个更旧版本的 Debian，并玩弄了一下。其中一个相当令人满意的结果是一个非常基本的 MP3 播放器（使用 libmpg123），它集成用于将背景音乐添加到一个小应用程序中，做一些完全不同的事情。我越来越喜欢这个小解决方案。

在那个程序中，我`mpg123_decode()`通过`/dev/audio`一个简单的`fwrite()`.

这很好用 - 在上网本上。

现在，我开始明白这`/dev/audio`是 OSS 所做的事情，并且不再支持较新的 (ALSA) 机器。果然，我的笔记本电脑（运行当前的 Linux Mint）没有这个设备。

所以显然我必须改用ALSA。在网上搜索，我找到了一些教程，它们几乎让我大吃一惊。模式、参数、功能、访问类型、采样格式、采样率、通道数、周期数、周期大小……我知道 ALSA 是一个功能强大的 API，适用于雄心勃勃的人，但这不是我想要的（或有时间去摸索）。我正在寻找的只是如何播放`mpg123_decode`（我什至不知道的格式，而不是远距离的音频极客）的输出。

任何人都可以给我一些关于需要做什么的提示吗？

**tl;博士**

如何让 ALSA 播放原始音频数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T18:39:54.780

在 alsa-oss 包中有一个 ALSA 的 OSS 兼容层。安装它并在“aoss”程序中运行您的程序。或者，modprobe 此处列出的模块：

[http://wiki.debian.org/SoundFAQ/#line-105](http://wiki.debian.org/SoundFAQ/#line-105)

然后，您需要更改您的程序以使用“/dev/dsp”或“/dev/dsp0”而不是“/dev/audio”。它应该按照你的记忆方式工作......但你可能想交叉手指以防万一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T05:38:52.113

直接使用 ALSA 过于复杂，所以我希望 Gstreamer 解决方案也适合您。Gstreamer 为 ALSA/OSS/Pulseaudio/您命名它提供了一个很好的抽象——并且在 Linux 世界中无处不在。

我写了一个小库，它将打开一个`FILE`对象，您可以在其中将 PCM 数据写入： **[Gstreamer 文件](https://github.com/Kijewski/gstreamer_file)**。实际代码不到 100 行。

像这样使用它：

```
FILE *output = fopen_gst(rate, channels, bit_depth); // open audio output file
while (have_more_data) fwrite(data, amount, 1, output); // output audio data
fclose(output); // close the output file 
```

我也添加了一个[mpg123 示例](https://github.com/Kijewski/gstreamer_file/blob/master/mpg123_example.c)。

这是整个文件（以防 Github 停业;-)）：

```
/**
 * gstreamer_file.c
 * Copyright  2012  René Kijewski  <rene.SURNAME@fu-berlin.de>
 * License: LGPL 3.0  (http://www.gnu.org/licenses/lgpl-3.0)
 */

#include "gstreamer_file.h"

#include <stdbool.h>
#include <stdlib.h>
#include <unistd.h>

#include <glib.h>
#include <gst/gst.h>

#ifndef _GNU_SOURCE
#   error "You need to add -D_GNU_SOURCE to the GCC parameters!"
#endif

/**
 * Cookie passed to the callbacks.
 */
typedef struct {
    /** { file descriptor to read from, fd to write to } */
    int pipefd[2];
    /** Gstreamer pipeline */
    GstElement *pipeline;
} cookie_t;

static ssize_t write_gst(void *cookie_, const char *buf, size_t size) {
    cookie_t *cookie = cookie_;
    return write(cookie->pipefd[1], buf, size);
}

static int close_gst(void *cookie_) {
    cookie_t *cookie = cookie_;
    gst_element_set_state(cookie->pipeline, GST_STATE_NULL); /* we are finished */
    gst_object_unref(GST_OBJECT(cookie->pipeline)); /* we won't access the pipeline anymore */
    close(cookie->pipefd[0]); /* we won't write anymore */
    close(cookie->pipefd[1]); /* we won't read anymore */
    free(cookie); /* dispose the cookie */
    return 0;
}

FILE *fopen_gst(long rate, int channels, int depth) {
    /* initialize Gstreamer */
    if (!gst_is_initialized()) {
        GError *error;
        if (!gst_init_check(NULL, NULL, &error)) {
            g_error_free(error);
            return NULL;
        }
    }

    /* get a cookie */
    cookie_t *cookie = malloc(sizeof(*cookie));
    if (!cookie) {
        return NULL;
    }

    /* open a pipe to be used between the caller and the Gstreamer pipeline */
    if (pipe(cookie->pipefd) != 0) {
        close(cookie->pipefd[0]);
        close(cookie->pipefd[1]);
        free(cookie);
        return NULL;
    }

    /* set up the pipeline */
    char description[256];
    snprintf(description, sizeof(description),
            "fdsrc fd=%d ! " /* read from a file descriptor */
            "audio/x-raw-int, rate=%ld, channels=%d, " /* get PCM data */
                "endianness=1234, width=%d, depth=%d, signed=true ! "
            "audioconvert ! audioresample ! " /* convert/resample if needed */
            "autoaudiosink", /* output to speakers (using ALSA, OSS, Pulseaudio ...) */
            cookie->pipefd[0], rate, channels, depth, depth);
    cookie->pipeline = gst_parse_launch_full(description, NULL,
            GST_PARSE_FLAG_FATAL_ERRORS, NULL);
    if (!cookie->pipeline) {
        close(cookie->pipefd[0]);
        close(cookie->pipefd[1]);
        free(cookie);
        return NULL;
    }

    /* open a FILE with specialized write and close functions */
    cookie_io_functions_t io_funcs = { NULL, write_gst, NULL, close_gst };
    FILE *result = fopencookie(cookie, "w", io_funcs);
    if (!result) {
        close_gst(cookie);
        return NULL;
    }

    /* start the pipeline (of cause it will wait for some data first) */
    gst_element_set_state(cookie->pipeline, GST_STATE_PLAYING);
    return result;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T18:45:54.577

您可以安装[sox](http://sox.sourceforge.net)`play`并使用正确的采样率和样本大小参数打开命令的管道。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T10:39:47.867

结合 Artefact2 的评论（`aplay`用于输出）和 kay 的答案（使用`pipe()`，我以前没有接触过），我想出了这个“最小”的例子。对于 ALSA 版本，它创建一个管道，`aplay`使用适当的参数分叉一个进程，并将解码的音频提供给它。

使用很多`assert()`来显示与各个函数调用相关的错误代码。当然，下一步不会是添加`-DNDEBUG`（这将使该程序*非常*快速且*非常*无用），而是用适当的错误处理（包括人类可读的错误消息）替换断言。

```
// A small example program showing how to decode an MP3 file.

#include <assert.h>
#include <stdlib.h>

#include <mpg123.h>
#include <unistd.h>
#include <fcntl.h>

int main( int argc, char * argv[] )
{
    // buffer and counter for decoded audio data
    size_t OUTSIZE = 65536;
    unsigned char outmem[OUTSIZE];
    size_t outbytes;

    // output file descriptor
    int outfile;

    // handle, return code for mpg123
    mpg123_handle * handle;
    int rc;

    // one command line parameter, being the MP3 filename
    assert( argc == 2 );

#ifdef OSS
    assert( ( outfile = open( "/dev/audio", O_WRONLY ) ) != -1 );
#else // ALSA
    // pipe file descriptors
    int piped[2];

    assert( pipe( piped ) != -1 );

    // fork into decoder (parent) and player (child)
    if ( fork() )
    {
        // player (child)
        assert( dup2( piped[0], 0 ) != -1 ); // make pipe-in the new stdin
        assert( close( piped[1] ) == 0 ); // pipe-out, not needed
        assert( execlp( "aplay", "aplay", "-q", "-r44100", "-c2", "-fS16_LE", "-traw", NULL ) != -1 ); // should not return
    }
    else
    {
        // decoder (parent)
        close( piped[0] ); // pipe-in, not needed
        outfile = piped[1];
    }
#endif

    // initializing
    assert( mpg123_init() == MPG123_OK );
    assert( atexit( mpg123_exit ) == 0 );

    // setting up handle
    assert( ( handle = mpg123_new( NULL, NULL ) ) != NULL );

    // clearing the format list, and setting the one preferred format
    assert( mpg123_format_none( handle ) == MPG123_OK );
    assert( mpg123_format( handle, 44100, MPG123_STEREO, MPG123_ENC_SIGNED_16 ) == MPG123_OK );

    // open input MP3 file
    assert( mpg123_open( handle, argv[1] ) == MPG123_OK );

    // loop over input
    while ( rc != MPG123_DONE )
    {
        rc = mpg123_read( handle, outmem, OUTSIZE, &outbytes );
        assert( rc != MPG123_ERR && rc != MPG123_NEED_MORE );
        assert( write( outfile, outmem, outbytes ) != -1 );
    }

    // cleanup
    assert( close( outfile ) == 0 );
    mpg123_delete( handle );
    return EXIT_SUCCESS;
} 
```

我希望这可以帮助其他有类似问题的人，作为一个模板。

# gradle - 在 gradle 中添加源文件扩展名

> ID：11347349
> 
> 赞同：0
> 
> 时间：2012-07-05T15:16:10.207
> 
> 标签：gradle

我试图告诉 gradle 带有`*.dsl`扩展名的文件应该被编译为 groovy 文件，所以我添加了一个包含模式的源集并更改了编译任务包含属性：

```
sourceSets {
   ...
   dsl_scripts {
      groovy {
         include '**/*.dsl'
      }
   }
}

compileDsl_scriptsGroovy.includes = ['**/*.dsl'] 
```

但是当我在调试模式下运行构建时，它会跳过所有`*.dsl`文件并显示以下消息：

```
Skipping task ':compileDsl_scriptsGroovy' as it has no source files 
```

以下行成功输出了我尝试编译的所有文件：

```
println sourceSets.dsl_scripts.allSource.matching({include '**/*.dsl'}).getFiles() 
```

我做错了什么？

**编辑**：我在 gradle 源代码中找到了以下代码段：

```
FileCollection groovyJavaOnly = spec.getSource().filter(new Spec<File>() {
    public boolean isSatisfiedBy(File element) {
       return element.getName().endsWith(".groovy") || element.getName().endsWith(".java");
    }
});

spec.setSource(new SimpleFileCollection(groovyJavaOnly.getFiles())); 
```

是否可以覆盖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T00:15:11.523

这似乎是一个 gradle 错误[http://issues.gradle.org/browse/GRADLE-2372](http://issues.gradle.org/browse/GRADLE-2372)

# c# - 当前上下文中不存在名称“安装程序”

> ID：11347353
> 
> 赞同：2
> 
> 时间：2012-07-05T15:16:15.857
> 
> 标签：c#, windows-services, installation

我完全是开发 Windows 服务的菜鸟，我找到了一个关于实现标准 Windows 服务的教程。这是我找到的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel;
using System.Configuration.Install;
using System.ServiceProcess;

namespace ReviewsSvc
{
[RunInstaller(true)]
public class ReviewsSvcInstaller
{
    private ServiceProcessInstaller processInstaller;
    private ServiceInstaller serviceInstaller;

    public ReviewsSvcInstaller()
    {
        processInstaller = new ServiceProcessInstaller();
        serviceInstaller = new ServiceInstaller();

        processInstaller.Account = ServiceAccount.LocalSystem;
        serviceInstaller.StartType = ServiceStartMode.Manual;
        serviceInstaller.ServiceName = "Reviews Updater";
        Installers.Add(serviceInstaller);
        Installers.Add(processInstaller);
    }
}
} 
```

我已经添加了必要的参考资料，但我仍然收到有关未找到“安装程序”的错误。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T15:20:27.003

您忘记指定基类

```
namespace ReviewsSvc 
{ 
    [RunInstaller(true)] 
    public class ReviewsSvcInstaller : Installer
    { 
        .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:26:41.217

确保主可执行文件 (EXE) 中的类**ReviewSvcInstaller**。安装程序在主入口程序集中查找此类。我希望它有所帮助。

# sql - 确定 DB2 文本字符串长度

> ID：11347363
> 
> 赞同：18
> 
> 时间：2012-07-05T15:16:53.543
> 
> 标签：sql, db2

我试图找出如何编写一个 SQL 语句来获取字符串不是 12 个字符长的字段。如果它们是 10 个字符，我只想获取字符串。

DB2 中有什么功能可以做到这一点？

我想它会是这样的，但我在上面找不到任何东西。
`select * from table where not length(fieldName, 12)`

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-05-12T19:56:16.553

从类似的问题[DB2 - find and compare the value of the value in a table field](https://stackoverflow.com/questions/9726724/db2-find-and-compare-the-lentgh-of-the-value-in-a-table-field) - 添加 RTRIM 因为 LENGTH 将返回列定义的长度。这应该是正确的：

```
select * from table where length(RTRIM(fieldName))=10 
```

更新 27.5.2019：可能在较旧的 db2 版本上，LENGTH 函数返回列定义的长度。在 db2 10.5 上，我尝试了该函数，它返回数据长度，而不是列定义长度：

```
select fieldname
, length(fieldName) len_only
, length(RTRIM(fieldName)) len_rtrim
from (values (cast('1234567890  ' as varchar(30)) )) 
as tab(fieldName)

FIELDNAME                      LEN_ONLY    LEN_RTRIM
------------------------------ ----------- -----------
1234567890                              12          10 
```

可以通过使用这个术语来测试这一点：

```
where length(fieldName)!=length(rtrim(fieldName)) 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-05T15:19:02.830

这将获取长度为 10 个字符的字符串（在 fieldName 列中）的记录：

```
 select * from table where length(fieldName)=10 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-04-03T11:20:54.220

通常我们在下面写语句 select * from table where length(ltrim(rtrim(field)))=10;

# sql-server - 为什么我的 Visual Studio 10 停止将 App.Config 用于我的 SQL 连接字符串？

> ID：11347365
> 
> 赞同：0
> 
> 时间：2012-07-05T15:16:58.613
> 
> 标签：sql-server, visual-studio, connection-string, app-config, settings.settings

我有一个使用 WPF 和 SQL Server 2008 R2 的工作数据库应用程序，两年来一直从 App.Config 文件中获取其 SQL Server 连接字符串。几天前，在一台开发机器上，它开始忽略 App.Config 文件的 connectionString，现在使用来自其他地方的字符串（看起来像 settings.settings 或 DBML 文件）。

为什么会发生这种情况，我怎样才能让它停止这样做？

app.config 的开头是这样的：

```
<configuration>
  <configSections>
    <section name="log4net" type="System.Configuration.IgnoreSectionHandler"/>
  </configSections>
  <connectionStrings>
    <add name="DronzApp.Properties.Settings.DronzAppConnectionString"
     connectionString="Server=dronz.db.123.dronzdbserver.com;Database=dronzdb;User ID=dronz;Password=secretsauce;"
     providerName="System.Data.SqlClient" />
 </connectionStrings> 
```

编辑：感谢你们俩的建议，以获取更多信息和在哪里寻找。我不知道 WPF 应用程序从哪里获取它应该在 App.Config 或其他任何地方查看的信息，但在我了解到这一点之前，这里还有一些内容：

我的程序做的第一件事就是测试数据库（现在失败了）。在此之前，它调用自动生成的函数 InitializeComponent()，其自动生成的代码是：

```
 /// <summary>
    /// InitializeComponent
    /// </summary>
    [System.Diagnostics.DebuggerNonUserCodeAttribute()]
    public void InitializeComponent() {
        if (_contentLoaded) {
            return;
        }
        _contentLoaded = true;
        System.Uri resourceLocater = new System.Uri("/DronzApp;component/ui/startwindow.xaml", System.UriKind.Relative);

        #line 1 "..\..\..\UI\StartWindow.xaml"
        System.Windows.Application.LoadComponent(this, resourceLocater);

        #line default
        #line hidden
    } 
```

我的启动窗口构造函数调用 InitializeComponent(); 然后使用以下行测试数据库：

int hmm = App.db.Dronz_FooTable.Count();

其中 App.db 是在 app.xaml.cs 文件中定义的数据上下文：

公共静态 DronzDataDataContext db = new DronzDataDataContext();

其中 DronzDataDataContext 由 LINQ-to-SQL 在自动生成的代码中定义，例如：

公共部分类 DronzDataDataContext : System.Data.Linq.DataContext ...

```
 public DronzDataDataContext() : 
            base(global::DronzApp.Properties.Settings.Default.DronzConnectionString, mappingSource)
    {
        OnCreated();
    } 
```

以前会注意 app.config 文件，现在不注意了。当我捕获数据库异常（这是关于数据库版本问题，因为它试图使用错误的 SQL 服务器）并查看连接字符串时，它正在向错误的 SQL Server 询问文件而不是正确的连接字符串。它使用的连接字符串似乎与导入数据库架构时 Linq-to=SQL 创建的 DBML 文件或 settings.settings 中的字符串匹配（这是一个我不太明白它来自哪里的文件或我应该做什么或不做什么）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T20:18:25.477

好的，我似乎已经找到并解决了问题，但我不知道究竟是什么原因造成的。

引用 Config 文件的内容实际上是在 .proj 文件中，并且以某种方式更改为在项目根目录而不是在 App 子文件夹中添加对 app.config 的引用。通过阅读 app.config 的其他讨论，我认为 VS2010 可能是在我查看 GUI 中的项目设置时自动完成的。从 .proj 文件中手动删除该 XML 行使其能够找到并使用指向 app.config 文件实际位置的先前版本。由于我在项目根目录中没有 app.config 文件，在该文件中新的第一行被编辑为在 .proj 文件中，因此似乎已经转向查看 settings.settings，它在其中找到了 connectionString 值当我使用 Linq to SQL 导入数据库文件时文件在哪里。

# java - 如何避免 JDBC 驱动程序断开连接时出现异常？

> ID：11347366
> 
> 赞同：1
> 
> 时间：2012-07-05T15:17:01.313
> 
> 标签：java, oracle, exception, jdbc, disconnect

我使用 JDBC 连接到 Oracle 数据库。有时当我尝试断开连接时，我收到错误：

```
Io exception Broken pipe 
```

这是因为网络连接中断。如何更好地处理这个异常？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:19:31.653

但是你无论如何都想断开连接，那么问题出在哪里？

您可以使用相对温和的日志级别记录它，或者完全吞下异常（我推荐前者）

# cocoa - UIButton 的图像在状态更改后不更新

> ID：11347367
> 
> 赞同：0
> 
> 时间：2012-07-05T15:17:04.103
> 
> 标签：cocoa, uiimage, uibutton, selected

我已经创建了 UIButton 并以这种方式设置了它的图像：

```
 [_filterButton setImage:[UIImage imageNamed:@"filter-button"] forState:UIControlStateNormal];
    [_filterButton setImage:[UIImage imageNamed:@"tag"] forState:UIControlStateSelected]; 
```

后来我改变了它的状态：（我点击不同的按钮后这样做）

```
[_filterButton setSelected:YES]; 
```

但是，按钮的图像在我单击它之前不会更新。

似乎按钮的图像在触摸事件后更新，而不是在手动更改状态后更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T08:00:06.677

固定的。我正在更新不在主线程中的按钮状态，这导致了问题。

# c# - Metro C#中的虚拟异步方法

> ID：11347368
> 
> 赞同：1
> 
> 时间：2012-07-05T15:17:06.683
> 
> 标签：c#, asynchronous, windows-runtime, task-parallel-library, async-await

我想定义一个虚拟方法，它在基类中不是异步的，但在派生类中是异步的，调用者使用委托调用它（实际上它是由屏幕上的按钮激活的 ICommand）我该怎么做呢？

```
public class BaseClass
{
    BIONESSBindingCommand mLogoffCommand;

    public ICommand LogoffCommand
    {
        get
        {
            if (mLogoffCommand == null)
            {
                mLogoffCommand = new BIONESSBindingCommand(
                    Param => Logoff(), //Command DoWork
                    Param => true); //Always can execute
            }

            return mLogoffCommand;
        }
    }

    public virtual Task Logoff()
    {
        DoLogoff();
        return null; //???
    }
}

public class DerivedClass : BaseClass
{
    public override async Task Logoff()
    {
        await SomeWoAsyncWork();
        base.Logoff(); //Has warninngs
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T15:29:47.533

调用`Task.FromResult`以获得完整的`Task`. 此外，`await`它在派生类中（这将启用错误传播）。

```
public class BaseClass
{
  public virtual Task Logoff()
  {
    DoLogoff();
    return Task.FromResult(false);
  }
}

public class DerivedClass : BaseClass
{
  public override async Task Logoff()
  {
    await SomeWoAsyncWork();
    await base.Logoff();
  }
} 
```

# c++ - C++中的删除结构

> ID：11347371
> 
> 赞同：0
> 
> 时间：2012-07-05T15:17:24.587
> 
> 标签：c++, structure, delete-operator

假设如下定义的结构在数组中动态分配。为了安全地删除分配的结构，类型、标签和描述是否需要空终止？

```
struct operation_data
{
    int number;             
    char* type;             
    char* label;                
    char* description;
}

operation *data=new operation_data[5];  
for (int i=0; i<5; i++)
{
    data[i].type=new char[250];
    data[i].label=new char[250];
    data[i].description=new char[250];
}    
for (int i=0; i<5; i++)
{
    if (data[i].type) delete[] data[i].type;
    if (data[i].label) delete[] data[i].label;
    if (data[i].description) delete[] data[i].description;    
} 
```

我的代码代表上面的代码片段。这导致在第二个删除语句中检测到堆损坏错误。请帮我纠正这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:19:52.470

如果它们真的是数组，那么它们一定是用`new[]`.

在这种情况下，您必须使用 删除它们`delete[]`，这应该会正确释放数组。

所以，你应该有某个地方：

```
char* description = new [someSize]; 
```

并删除它，你应该这样做：

```
delete [] description; 
```

此外，如果您使用的是 c++，则可以`std::string`使用`char*`. 这样，当字符串被销毁时，底层内存会自动释放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:20:53.080

不，当你删除结构时，你只删除了结构本身的大约 16 个字节的内存（一个 int 和三个指针）。您实际上并没有删除指针指向的内存。您必须单独执行此操作，并且不需要空终止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T15:20:41.860

不，删除数组不需要空终止。如果它们是用 分配的，那么无论它们的内容如何，`new char[size]`​​都可以用 删除它们。`delete []`

如果它们已被分配，那么您需要在删除结构本身之前删除它们中的每一个；成员指针不会自动删除。

空终止对于将它们与诸如 C 库中处理空终止字符串的函数一起使用是必要的。在 C++ 中，使用标准类通常更方便`std::string`，它为您管理内存分配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:32:02.733

不，它们不需要以空值终止。空终止只是 char 数组内的字符串结束的指示符。

我建议在您的结构中添加一个 ctor 和 dtor 以安全地删除它。

```
struct operation {
  int number;
  char* type;
  char* label;
  char* description;

  operation() : type(0), label(0), description(0) {}
  ~operation() {
    if( type )
          delete[] type;
    if( label )
      delete[] label;
    if( description )
      delete[] description;
  }
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:21:04.133

类型、标签和描述不需要以 null 结尾

# dreamweaver - 仅在 Dreamweaver 的设计器中启用 HTML 代码

> ID：11347372
> 
> 赞同：0
> 
> 时间：2012-07-05T15:17:33.090
> 
> 标签：dreamweaver

我需要一些 HTML 代码只能由 Dreamweaver 的设计器处理。更准确地说，我需要smth。像这样：

```
<html>
  ...
  <link rel="stylesheet" type="text/css" media="screen" href="styles_print.css" title="printer_friendly_css" />
  <!-- FOR_DREAMWEAVER_DESIGNER_ONLY
  <link rel="stylesheet" type="text/css" media="screen" href="styles.css" title="normal_css" />
  -->
  ...
</html> 
```

因此，当在 Dreamweaver 的 Designer 中查看此页面时，**有效**的HTML 如下所示（第二个标记为“未注释”）：

```
<html>
  ...
  <link rel="stylesheet" type="text/css" media="screen" href="styles_print.css" title="printer_friendly_css" />
  <link rel="stylesheet" type="text/css" media="screen" href="styles.css" title="normal_css" />
  ...
</html> 
```

并且当在其他地方（例如在常规浏览器中）查看同一页面时，它会按原样处理（第二个标签被忽略，因为它被评论了）。

这可能吗？Dreamweaver 有这种功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:07:26.087

Dreamweaver 有一个称为设计时样式表的功能来处理这种类型的功能。它允许您仅在 Dreamweaver 中而不是在活动页面上应用样式。您甚至可以在设计时隐藏将实时呈现的样式。格式 -> CSS 样式 -> 设计时

Adobe 设计时样式表帮助：http: [//help.adobe.com/en_US/dreamweaver/cs/using/WScbb6b82af5544594822510a94ae8d65-7e17a.html](http://help.adobe.com/en_US/dreamweaver/cs/using/WScbb6b82af5544594822510a94ae8d65-7e17a.html)

您甚至可以使用设计时样式表来帮助您跟踪 CSS 的潜在问题。这是我写了一段时间关于该主题的文章： [http ://www.webassist.com/free-downloads/tutorials-and-training/roadmaps/roadmap_07.php](http://www.webassist.com/free-downloads/tutorials-and-training/roadmaps/roadmap_07.php)

如果您使用的是 PHP，并且您想在整个站点范围内应用并且您在每个页面中都有一个包含，请查看：http: [//james.revillini.com/2008/01/24/solved-dreamweaver-site -wide-design-time-style-sheets-using-templates/](http://james.revillini.com/2008/01/24/solved-dreamweaver-site-wide-design-time-style-sheets-using-templates/)

可以在站点范围内应用它们的 Dreamweaver 扩展（商业，但仅 5 美元，尚未在 Dreamweaver 的多个版本中尝试过，但我认为它应该仍然有效）： [http ://www.communitymx.com/abstract.cfm?cid =61265](http://www.communitymx.com/abstract.cfm?cid=61265)

# c++ - 类型名称拆解问题

> ID：11347373
> 
> 赞同：8
> 
> 时间：2012-07-05T15:17:33.797
> 
> 标签：c++, c++11, typeinfo

我正在创建一个将类型转换为描述它的字符串的模板类，例如`typeinfo<int(*)()>::name()`返回字符串`"int(*)()"`（最多为空格）。最初我有大量的特殊情况来解决`typeid(...).name()`剥离引用限定符和顶级 cv 限定符的事实，但后来我记得将类型作为模板参数传递将保留这些。因此，使用 ABI 标头，我最终得到了这样的结果：

```
#include <iostream>
#include <typeinfo>
#include <string>
#include <cxxabi.h>

using namespace std;

string demangle(const char* mangledName) {
    int status;
    char* result = abi::__cxa_demangle(mangledName, nullptr, nullptr, &status);
    switch(status) {
    case -1:
        cerr << "Out of memory!" << endl;
        exit(1);
    case -2:
        return mangledName;
    case -3: // Should never happen, but just in case?
        return mangledName;
    }
    string name = result;
    free(result);
    return name;
}

template<typename T> struct preserve_qualifiers {};

template<typename T> class typeinfo {
    using wrap = preserve_qualifiers<T>;
public:
    static const string name() {
        string name = demangle(typeid(wrap).name());
        int i = name.find_first_of('<');
        if(i == string::npos) return name;
        int j = name.length() - i - 2;
        return name.substr(i + 1, j);
    }
};

#define TypeOut(...) cout \
    << "Type " #__VA_ARGS__ ": " << endl \
    << "  Mangled: " << typeid(__VA_ARGS__).name() << endl \
    << "  Demangled: " << demangle(typeid(__VA_ARGS__).name()) << endl \
    << "  typeinfo<>: " << typeinfo<__VA_ARGS__>::name() << endl
class A {};
template<typename T> class F {};
template<int T> class G {};
template<template<typename> class T> class H {};
template<template<int> class T> class I {};
template<typename... T> class J {};
template<int... T> class K {};
template<template<typename> class... T> class L {};
template<template<int> class... T> class M {};
template<template<typename> class... T> class N {};
template<template<template<typename> class...> class... T> class O {};
struct bits {int i : 4, j : 2;};
template<typename T, int n> struct bits2 {T val : n;};

int main(int argc, char* argv[]) {
    TypeOut(void(*volatile)(void(*const)()));
    TypeOut(int (A::*)());
    TypeOut(int (A::*)()const);
    TypeOut(int (A::*const)());
#ifdef __clang__
    TypeOut(int (A::*)()&);
    TypeOut(int (A::*)()&&);
#endif
    TypeOut(F<int>);
    TypeOut(G<3>);
    TypeOut(H<F>);
    TypeOut(I<G>);
    TypeOut(J<int>);
    TypeOut(K<3>);
    TypeOut(L<F>);
    TypeOut(M<G>);
    TypeOut(N<F,F,F>);
    TypeOut(O<N,N>);
} 
```

这在 GCC（4.8）中编译和工作（几乎）完美。但是，GCC 不支持成员函数上的 ref-qualifiers，所以也在 Clang (3.2) 中尝试了它，看看它是否可以工作。它没有。它编译得很好，并且运行没有问题，但是大多数模板名称都没有被拆解，也没有 ref 限定的成员函数。

[这](http://ideone.com/05yxL)是 ideone 的 GCC 输出（代码稍作调整，因为 ideone 的 GCC 版本不支持 nullptr 或别名声明）。请注意函数参数中缺少的 const 限定符。这是唯一没有像我在 GCC 中所希望的那样工作的事情。在 Clang 中也是如此，我想这并不特别令人惊讶。（令人惊讶的是它根本没有，并不是 GCC 和 Clang 在它上面是一致的。）

不幸的是，当使用 Clang 编译和运行时，可变参数模板类无法解组。例如， J 被`1JIJiEE`替换为`1JIIiEE`GCC 选择的。

从 clang 中选择的输出（仅显示那些不起作用的输出）

```
Type int (A::*)()&: 
  Mangled: M1AFivRE
  Demangled: M1AFivRE
  typeinfo<>: 19preserve_qualifiersIM1AFivREE
Type int (A::*)()&&: 
  Mangled: M1AFivOE
  Demangled: M1AFivOE
  typeinfo<>: 19preserve_qualifiersIM1AFivOEE
Type J<int>: 
  Mangled: 1JIJiEE
  Demangled: 1JIJiEE
  typeinfo<>: 19preserve_qualifiersI1JIJiEEE
Type K<3>: 
  Mangled: 1KIJLi3EEE
  Demangled: 1KIJLi3EEE
  typeinfo<>: 19preserve_qualifiersI1KIJLi3EEEE
Type L<F>: 
  Mangled: 1LIJ1FEE
  Demangled: 1LIJ1FEE
  typeinfo<>: 19preserve_qualifiersI1LIJ1FEEE
Type M<G>: 
  Mangled: 1MIJ1GEE
  Demangled: 1MIJ1GEE
  typeinfo<>: 19preserve_qualifiersI1MIJ1GEEE
Type N<F,F,F>: 
  Mangled: 1NIJ1FS0_S0_EE
  Demangled: 1NIJ1FS0_S0_EE
  typeinfo<>: 19preserve_qualifiersI1NIJ1FS1_S1_EEE
Type O<N,N>: 
  Mangled: 1OIJ1NS0_EE
  Demangled: 1OIJ1NS0_EE
  typeinfo<>: 19preserve_qualifiersI1OIJ1NS1_EEE 
```

有谁知道如何解决这个问题？它是clang中的错误吗？（或者可能是 GCC 中的错误？）我的第一个怀疑是与我的代码链接的 C++ ABI 与 clang 正在使用的 C++ ABI 之间的版本不兼容。这个问题只发生在新的 C++11 特性（成员函数引用限定符和可变参数模板）上，这一事实似乎支持了这种怀疑……尽管 r 值引用（例如）没有问题。

如果它是相关的，我在 Mac OSX Lion 上，并且 GCC 4.8 和 clang 3.2 是从 MacPorts 安装的。我正在使用以下命令进行编译：

```
clang++-mp-3.2 -isystem/usr/local/include/c++/v1 -stdlib=libc++ -std=gnu++11 typeinfo-min.cpp -o typeinfofun-clang
G++-mp-4.8 -std=gnu++11 typeinfo-min.cpp -o typeinfofun-gcc 
```

似乎需要 isystem 标志才能让 clang 找到 libc++ 标头（当我使用`<type_traits>`更复杂的版本时，这是必需的）。没有它，它甚至找不到`<iostream>`。

（作为附加说明，这个问题也确实影响了更复杂的版本，因为类名——可能不出所料——不在复杂类型的特化中，因此只使用了 ABI demangle 调用。）

（顺便说一句，我很好奇它的可移植性。我知道在 MSVC 中没有必要，因为它会从 中返回未损坏的名称`typeid(...).name()`，但除此之外......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T00:32:51.153

我检查了 gcc4.8 mingw3.0 你的例子：

> gcc 版本 4.8.1 20130324（预发布）（rubenvb-4.8-stdthread）

```
c++.exe -ggdb -Os -frtti -fexceptions -fpic -std=gnu++11 
```

我得到了这个结果

```
Type void(*volatile)(void(*const)()):
  Mangled: PFvPFvvEE
  Demangled: void (*)(void (*)())
  typeinfo<>: void (* volatile)(void (*)())
Type int (A::*)():
  Mangled: M1AFivE
  Demangled: int (A::*)()
  typeinfo<>: int (A::*)()
Type int (A::*)()const:
  Mangled: M1AKFivE
  Demangled: int (A::*)() const
  typeinfo<>: int (A::*)() const
Type int (A::*const)():
  Mangled: M1AFivE
  Demangled: int (A::*)()
  typeinfo<>: int (A::* const)()
Type F<int>:
  Mangled: 1FIiE
  Demangled: F<int>
  typeinfo<>: F<int>
Type G<3>:
  Mangled: 1GILi3EE
  Demangled: G<3>
  typeinfo<>: G<3>
Type H<F>:
  Mangled: 1HI1FE
  Demangled: H<F>
  typeinfo<>: H<F>
Type I<G>:
  Mangled: 1II1GE
  Demangled: I<G>
  typeinfo<>: I<G>
Type J<int>:
  Mangled: 1JIIiEE
  Demangled: J<int>
  typeinfo<>: J<int>
Type K<3>:
  Mangled: 1KIILi3EEE
  Demangled: K<3>
  typeinfo<>: K<3>
Type L<F>:
  Mangled: 1LII1FEE
  Demangled: L<F>
  typeinfo<>: L<F>
Type M<G>:
  Mangled: 1MII1GEE
  Demangled: M<G>
  typeinfo<>: M<G>
Type N<F,F,F>:
  Mangled: 1NII1FS0_S0_EE
  Demangled: N<F, F, F>
  typeinfo<>: N<F, F, F>
Type O<N,N>:
  Mangled: 1OII1NS0_EE
  Demangled: O<N, N>
  typeinfo<>: O<N, N> 
```

# java - JAVA RESTful Web 服务和 XML 文件传输

> ID：11347376
> 
> 赞同：2
> 
> 时间：2012-07-05T15:17:45.863
> 
> 标签：java, web-services, rest, file-transfer

首先，对不起我的英语。其次，我知道有很多关于我要谈论的内容的现有帖子，但据我搜索，我发现没有（真正）与我的“特定”问题相关。所以我们开始吧。

我目前正在开发一个 JAVA RESTful Web 服务。此 Web 服务的目标是将一些 XML 文件（更准确地说，一些 OVAL 定义）发送到连接的客户端。我已经看到了 4 个“解决方案”：

*   将所有 XML 文件内容放在一个字符串中（如果需要，将此字符串编码为 base64）并将该字符串发送到客户端
*   将所有 XML 文件内容放入 Byte[] 并将 Byte[] 发送到客户端
*   使用 FTP 辅助服务器
*   通过在套接字上流式传输（InputStream/OutputStream）发送/接收文件

目前，我决定选择第 4 号解决方案。您可以在下面看到有关文件传输的代码的某些部分。

* * *

服务器端：

```
@Path("/sendXML")
@Produces(MediaType.TEXT_PLAIN)
@GET
@Path("/sendXML")
@Produces(MediaType.TEXT_PLAIN)
public String getHtml(@Context HttpServletResponse  serv) throws IOException {
    ServletOutputStream o =serv.getOutputStream();
    try {
        FileInputStream fis = new FileInputStream(new File("xml file to send"));
        int c;

        while ((c = fis.read()) != -1) {
           o.write(c);
        }

        fis.close();
        o.close();
    } catch (Exception e) {
        System.err.println("e");
    } 

    return "OK" ;
} 
```

* * *

客户端：

```
try {
        URL u = new URL("http://localhost:8080/ws.example.filetransfer/rest/sendXML");
        HttpURLConnection uc = (HttpURLConnection) u.openConnection();

        InputStream is = uc.getInputStream();

        try {
            FileOutputStream fos = new FileOutputStream(new File("path where the file will be saved"));
            int c;

            while ((c = is.read()) != -1) {
               fos.write(c);
            }

            is.close();
            fos.close();
        } catch (Exception e) {
            System.err.println("FileStreamsTest: " + e);
        } 

    } catch (Exception e) {
        e.printStackTrace();
    } 
```

* * *

我正在 Eclipse 下开发和测试我的程序。一切似乎都很好，XML 文件很好地从服务器发送到客户端，并将其保存在磁盘上。这是我启动客户端程序时的控制台输出（服务器已经启动）：

```
<?xml version="1.0"?><hello> Hello Jersey</hello>
<html> <title>Hello Jersey</title><body><h1>Hello Jersey</body></h1></html> 
<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-  definitions-5 oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#hpux hpux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
<generator>
<oval:product_name>The OVAL Repository</oval:product_name>
<oval:schema_version>5.10.1</oval:schema_version>
<oval:timestamp>2012-06-29T05:09:57.714-04:00</oval:timestamp>
</generator>
[...] 
```

如您所见，当客户端接收 XML 文件时，除了将内容写入磁盘（在代码中指定的文件中）之外，它还将内容写入标准输出。在标准输出上写是一个小问题，因为内容也写在磁盘上，但这是正常的，还是一种 Eclipse 错误，或者我的错误..？

最后，这是我的问题：

*   根据您的说法，使用 JAVA REST Web 服务传输 XML 文件的最佳方法是什么？
*   您认为流媒体解决方案是一个好方法吗？
*   我是否很好地实现了这个解决方案（我对一些代码有疑问，比如使用 @Contex 属性）？

感谢大家的关注和回答！海森89

# linux - 为一个来源的数据文件创建多个 Debian 软件包

> ID：11347377
> 
> 赞同：2
> 
> 时间：2012-07-05T15:17:46.573
> 
> 标签：linux, debian, packaging, apt, deb

我有一堆用于 dictd 字典程序的字典文件。每个字典有 2 个文件（一个 dict.dz 和一个 .index 文件），总共有 8 个字典。

字典的安装非常简单，这就是我目前在我的脚本中的内容：

```
install -o root -g root -m 644 /path/to/dictd_dictionaries/* /usr/share/dictd
/usr/sbin/dictdconfig --write
service dictd restart 
```

现在我想将这么多文件打包成 .deb 包，每个字典一个 .deb 包。我真的很想有一个源 .deb 包，然后创建所有单独的包，而不是必须创建和维护 8 个单独的包（这个数字可能会随着时间的推移而增长）。

但是我不明白*debian/packagename.dirs*文件与*debian/rules*文件中的内容有何关系。我尝试下载并查看freedict的源包，这与我想要做的非常相似，但它的规则文件非常复杂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T16:21:05.967

您可以使用 dh-make 包并指定“多个二进制文件”。它有点像创建骨架 debian/ 目录的向导。

例如

```
# dh_make --packagename=skeleton_1.0
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
    LANGUAGE = "en_GB:en",
    LC_ALL = (unset),
    LANG = "en_GB.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").

Type of package: single binary, indep binary, multiple binary, library, kernel module, kernel patch or cdbs?
 [s/i/m/l/k/n/b] 
```

此时键入“m”将设置它，以便单个源包构建多个包。

在 dh_make 向导设置好之后，您需要维护 debian/[packagename].dirs 和 debian/[packagename].install 以便打包程序知道哪些文件在哪个 .deb 中。

例如
**骨架.dirs**

```
usr/bin 
```

**骨架安装**

```
usr/bin/skeleton* 
```

# regex - 正则表达式从行中删除 [?]？

> ID：11347379
> 
> 赞同：0
> 
> 时间：2012-07-05T15:17:48.400
> 
> 标签：regex

从该行中删除所有 [?] 的适当正则表达式是什么：

```
/Hello[1]/World[2]/Foo[3]
/Bar[3]/Foo[2] 
```

等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:23:31.200

如果数字可以是负数，那么`\[-?\d+\]`或`\[-?[0-9]+\]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:24:59.103

对于任何符号 beetwin用空字符串`[]`替换正则表达式作为数字`\[.+?\]``\[\d+?\]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:34:53.383

我注意到你提到`"/hello[4]/world[2]".replace("[\\d+?]"`. 除了缺少的盾牌符号，如果你想应用正则表达式，你必须使用 String.replaceAll() 或 String.replaceFirst()。

# ruby - Rails 3嵌套属性 - 关联作为选择

> ID：11347380
> 
> 赞同：1
> 
> 时间：2012-07-05T15:17:49.127
> 
> 标签：ruby, ruby-on-rails-3, forms, associations, nested-attributes

我正在为我的网站构建一个问卷调查，并且我的模型设置如下：

```
Question - has_many :answers
Answer - belongs_to :question
Response - belongs_to :answer, :user_application
UserApplication - has_many :responses 
```

`Answers`是设置的答案，它们可以是 Yes、No 或一个句子，`Responses`是一个嵌套资源，`UserApplication`因此当我在`UserApplicationsController`我构建响应中的新操作时，根据问题的数量，我可以`f.fields_for`在新表单中使用。当它呈现时，我希望嵌套响应具有单选按钮，这些按钮具有答案的 id。因此，当提交表单时，嵌套响应会收到所选答案的 id。我只是想不出最好的方法来做到这一点。目前我正在这样做：

用户应用控制器

```
 def new
    @user_application = UserApplication.new
    @questions = Question.all

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @user_application }
    end
  end 
```

新形式

```
= form_for @user_application do |f|
  - @questions.each_with_index do |question, idx|
    = question.content
    .control-group
      .controls
        = select_tag "user_application[responses_attributes][#{idx}][answer_id]", options_for_select(question.answers.map {|u| [u.content,u.id]}) 
```

这感觉有点 hacky，因为当用户编辑应用程序时，之前答案的选择框没有被选中。我试图尽可能地解释我的问题。如果有人能理解我想要做什么，那么任何帮助都将不胜感激！如果您需要知道什么，请询问！

谢谢

托尼

# mysql - mysqli 数据库连接范围？

> ID：11347381
> 
> 赞同：0
> 
> 时间：2012-07-05T15:17:50.740
> 
> 标签：mysql, mysqli

我正在尝试使用准备好的语句从函数中将数据插入数据库。

从文件外部调用以下内容时效果很好：

```
function insert($value1, $value2)
{
$mysqli = new mysqli("localhost", "***", "***", "***");
    if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}
    if ($stmt = $mysqli->prepare("INSERT INTO table (col1, col2) values (?, ?)")) {
    $stmt->bind_param('ss', $value1, $value2);
    $stmt->execute();
}
} 
```

但是我想将连接字符串移到函数之外，这会导致范围问题。我已经读到我需要一门课来做到这一点，有人可以解释一个例子吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:35:22.957

最简单的方法是将连接线移到函数外部（进入全局范围），并在开始时将以下内容放入函数内部：

```
global $mysqli; 
```

见： http: [//php.net/global](http://php.net/global)

如果您愿意，您也可以使用一个类，并让一个类变量存储稍微复杂的连接。同样，PHP 文档中的所有内容都通过创建类、方法和变量以及使用它的示例进行了清楚的解释。

[http://php.net/class](http://php.net/class)

# javascript - Javascript：无论我的表达是什么，RegExp 都不起作用

> ID：11347384
> 
> 赞同：1
> 
> 时间：2012-07-05T15:17:57.043
> 
> 标签：javascript, regex

好的，我已经多次使用 RegExp，但由于某种原因，这次我无法让它工作。我正在尝试测试纬度（0 到 +/- 90 度）。无论我使用什么表达式，它总是返回 false。这是我的代码：

```
var regexLatitude = new RegExp("^-?([1-8]?[0-9]\.{1}\d{1,6}$|90\.{1}0{1,6}$)");
var status = regexLatitude.test("89.5"); 
```

我也试过不带引号：

```
var status = regexLatitude.test(89.5); 
```

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:19:08.520

`\`Javascript 字符串文字正在解析您的字符。

您需要使用正则表达式文字：

```
var regexLatitude = /^-?([1-8]?[0-9]\.{1}\d{1,6}$|90\.{1}0{1,6}$)/; 
```

# java - 用于“索引”属性文件的 Java API

> ID：11347385
> 
> 赞同：1
> 
> 时间：2012-07-05T15:18:00.017
> 
> 标签：java, api, properties

我正在寻找一个 Java API，它允许以以下格式写入和读取属性文件：

```
<prefix>.<index>.<suffix>=<value> 
```

例如：

```
launcher.1.id=23
launcher.1.name=abc
launcher.1.date=123123
launcher.2.id=sdfsdf
launcher.2.name=Asdfdsf
launcher.2.date=ghfgh
cec.1.id=sdfsdf
cec.1.name=Asdfdsf
cec.1.date=ghfgh
cec.2.id=sdfsdf
cec.2.name=Asdfdsf
cec.2.date=ghfgh
#... 
```

log4j 使用非常相似的格式来配置 appenders：

```
log4j.rootLogger=debug, stdout, R
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%5p 
log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=example.log
log4j.appender.R.MaxFileSize=100KB
log4j.appender.R.MaxBackupIndex=1
log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n 
```

任何人都知道是否有适用于这种情况的 Java 库？

谢谢，伊利亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:09:16.783

你看过[Apache commons-configuration](http://commons.apache.org/configuration/)吗？它们提供类似 xpath 的支持来查询此类属性文件，并且如果您决定更改格式，将进一步让您在 xml、ini 等之间来回迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T19:30:57.793

正确的解决方案是重新考虑格式并为此使用 JSON。谢谢@ControlAltDel 的想法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-05T15:28:56.367

有两种可能：

1.  您添加一个定义存在多少编号项目的属性 - 例如`launcher.count = 2`
2.  您枚举所有键并寻找合适的模式：

    ```
    for (Object o : properties.keySet()) {
        String key = (String) o;
        if (key.startsWith("launcher")) {
            ...
        } else if (key.startsWith("cec")) {
            ...
        } 
    } 
    ```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-05T15:21:03.277

```
java.util.Properties

String string = properties.getProperty("launcher.1.name");
properties.setProperty("launcher.1.name", "abc"); 
```

如果您需要枚举中的所有属性，

```
public Enumeration<?> propertyNames()

Returns an enumeration of all the keys in this property list, 
including distinct keys in the default property list if a key of 
the same name has not already been found from the main properties list. 
```

# php - 我的 URL 中的 PHP 查询

> ID：11347386
> 
> 赞同：2
> 
> 时间：2012-07-05T15:18:04.760
> 
> 标签：php

我正在尝试编写一段代码，它将根据 url 查询中的内容更改页面的标题......

```
?page_id=62&action=register 
```

所以

```
if(action='register'){
  do this
}else{
  do this
} 
```

我怎么写这个？我以前从来没有处理过这个

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T15:20:17.003

```
if(isset($_GET['action']) AND $_GET['action'] == "register")
{
    // your code
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T15:19:12.543

使用以下方式访问 URL 参数`$_GET`：

```
$page_id = (int)$_GET['page_id'];
$action = htmlspecialchars($_GET['action']);

if($action == 'register') {
    echo 'action: '. $action .', page_id: '. $page_id;
} 
```

[在此处](http://php.net/manual/en/language.variables.external.php)阅读更多关于`GET`&的信息。如果要检查是否设置了这些变量，请使用[isset](http://www.php.net/manual/en/function.isset.php)例如。`POST` `isset($_GET['page_id'])`

不过要小心，以这种方式很容易创建一系列漏洞，转义/验证这些变量（例如[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)在我的代码中使用了它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:26:11.123

要读出“动作”，您需要 $_GET 变量。您可以将它与`$_GET['action']`.

您应该使用 isset 来询问变量是否已设置。有了这个，您可以防止错误。

```
if(isset($_GET['action']) && $_GET['action'] == 'register'){ 
    do this 
}else{ 
    do this 
} 
```

另一个例子：当您询问是否设置了操作，然后您可以询问是否操作 == 注册或操作 == 登录或其他

```
if(isset($_GET['action'])){ 
    switch($_GET['action']) {
        case 'register':
            //do this
            break;
        case 'login':
            //do this 
            break;
    } 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:24:38.693

像这样的东西：

```
$action = $_GET['action'];

if ($action == "register") {
    echo("<title>Register</title>");
} 
```

放置在 php 脚本中的 和 标签之间

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:29:50.993

尝试类似：

```
$title = (isset($_GET['action']) && $_GET['action'] == 'register') ? 'Register' : 'Login'; 
```

在您的 HTML 中：

```
<title><?=$title?></title> 
```

# neo4j - 插入节点时的 neo4j 性能问题

> ID：11347388
> 
> 赞同：0
> 
> 时间：2012-07-05T15:18:09.150
> 
> 标签：neo4j

插入 2000 个节点消耗 10000ms。这是我正在尝试的代码：

```
package org.demo.neo4j;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Semaphore;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.neo4j.graphdb.Direction;
import org.neo4j.graphdb.DynamicRelationshipType;
import org.neo4j.graphdb.GraphDatabaseService;
import org.neo4j.graphdb.Node;
import org.neo4j.graphdb.Relationship;
import org.neo4j.graphdb.RelationshipType;
import org.neo4j.graphdb.Transaction;

public class Main {

    private GraphDatabaseService neo = Noe4jUtils.getInstance();
    private static ExecutorService pool = Executors.newFixedThreadPool(4);
    private static Semaphore semaphore = new Semaphore(4);

    public static void main(String[] args) {
        Main main = new Main();
        main.insert();
    }

    private void insert() {
        for (int i = 0; i < 1000; i++) {
            try {
                semaphore.acquire();
                String refName = "REF-" + i;
                pool.execute(new InsertTask(refName, 100000));
            } catch (InterruptedException ex) {
                Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

    private void insertRef(String refName, int num) {
        Node rootNode = neo.getReferenceNode();
        RelationshipType rt = DynamicRelationshipType.withName(refName);
        Relationship r = rootNode.getSingleRelationship(rt, Direction.OUTGOING);
        Node refNode;
        if (null == r) {
            refNode = createRef(rootNode, rt);
        } else {
            refNode = r.getOtherNode(rootNode);
        }
        int size = 2000;
        int cnt = num / size;
        if ((num % size) != 0) {
            cnt = cnt + 1;
        }
        int index = 0;
        for (int i = 0; i < cnt; i++) {
            long l1 = System.currentTimeMillis();
            Transaction tx = neo.beginTx();
            try {
                int tmpNum = 0;
                for (int j = 0; j < size; j++) {
                    index++;
                    if (index > num) {
                        break;
                    }
                    tmpNum++;
                    createNode(refNode);
                }
                tx.success();
                System.out.println("insert " + tmpNum + " node.");
            } finally {
                tx.finish();
                l1 = System.currentTimeMillis() - l1;
                System.out.println("consume " + l1 + " ms.");
            }
        }
    }

    private Node createRef(Node node, RelationshipType rt) {
        Transaction tx = neo.beginTx();
        try {
            Node tmpNode = node.getGraphDatabase().createNode();
            node.createRelationshipTo(tmpNode, rt);
            tx.success();
            return tmpNode;
        } finally {
            tx.finish();
        }
    }

    private Node createNode(Node node) {
        RelationshipType rt = DynamicRelationshipType.withName("LINK");
        Node tmpNode = node.getGraphDatabase().createNode();
        node.createRelationshipTo(tmpNode, rt);
        for (int i = 0; i < 100; i++) {
            tmpNode.setProperty("key" + i, i);
        }
        return node;
    }

    class InsertTask implements Runnable {

        public InsertTask(String refName, int num) {
            this.refName = refName;
            this.num = num;
        }
        private String refName;
        private int num;

        @Override
        public void run() {
            try {
                insertRef(refName, num);
            } finally {
                semaphore.release();
            }
        }
    } } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T19:24:18.290

创建这些小交易的目的是什么？neo4j 中的每个事务都会强制将逻辑日志写入磁盘，因此基本上所有时间都在等待磁盘刷新。因此，多线程并没有太大帮助，相反它可能会更慢。尝试在每个事务中将许多操作组合在一起并拥有一个线程。

顺便说一句，您的用例是什么？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-11T00:46:52.310

你是在 Linux 下的 ext4 文件系统上运行它吗？

如果您想用一点事务安全性换取 10-15 倍更好的写入性能，请尝试使用 barrier=0 选项，如下所述：http: [//structr.org/blog/neo4j-performance-on-ext4](http://structr.org/blog/neo4j-performance-on-ext4)

# sql-server-2008 - 在条件下通过电子邮件发送查询结果

> ID：11347389
> 
> 赞同：1
> 
> 时间：2012-07-05T15:18:09.300
> 
> 标签：sql-server-2008, email

我想通过电子邮件发送查询结果，它工作正常，但如果结果不为空，我只需要执行电子邮件。

```
EXEC msdb.dbo.sp_send_dbmail @profile_name='GDB Admin',
    @recipients = 'joe@mail.com',
    @subject = 'GDB Warning - THIS IS A TEST',
    @body ='Key',
    @query =  'select clientkey as apikey, ImportDate from 
 QueryDData.dbo.QueryData   where clientkey not in(''blablablabla'')' 
```

因此，如果 clientkey 为空，请不要发送电子邮件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T18:24:07.270

好的，首先执行查询并将结果分配给变量，如果变量不为空，则执行上述电子邮件过程。

# ios - 将字符串设置为空 (@"") 后 NSString.length 崩溃；

> ID：11347390
> 
> 赞同：0
> 
> 时间：2012-07-05T15:18:14.953
> 
> 标签：ios

我在 iOs 中创建了一个计算器，包括每个数字键作为单独的 UIButton。

我有一个`NSString`叫做 calcNumberString 的东西，它保存着输入到计算器中的数字。这样我可以检查是否已超过最大位数并阻止用户再输入。

在我的`viewDidLoad`事件中，我像这样初始化 calcNumberString：

```
calcNumberString = [[NSString alloc] init]; 
```

当我按下数字键（例如 5）时，会触发以下方法：

```
-(IBAction)buttonPressed5 : (id) sender
{
    if(calcNumberString.length < 10)
    {
        calcNumberString = [calcNumberString stringByAppendingFormat:@"5"];
        calcLabel.text = calcNumberString;
    }
} 
```

这很好用（我最多可以输入 10 位数字）......直到我按下 CLEAR 键：

```
-(IBAction)buttonPressedClear : (id) sender
{
    calcNumberString = @"";
    calcLabel.text = @"0"
} 
```

它按预期清除，但是当我尝试按另一个数字键之后，我得到`EXC_BAD_ACCESS`或以下内容`NSInvalidArgumentException`：

```
[__NSCFSet length]: unrecognized selector sent to instance 0x16c110 
```

方法中有什么`buttonPressClear`我做错了吗？这显然是问题所在，因为在我清除并尝试输入新数字之前一切正常。

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:34:34.563

在您的清除按钮操作中，您将 calcNumberString 分配给您没有保留的另一个内存位置。一旦该方法超出范围，该字符串内存位置就消失了。

如果你想继续使用 NSString，正确的代码如下：

```
[calcNumberString release];
calcNumberString = [@"" retain]; 
```

这样你就没有任何内存泄漏。

正如@CodaFi 在评论中提到的，您应该使用[NSMutableString](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsmutablestring_Class/Reference/Reference.html)。

# c# - 无法为 webservice.asmx 创建类型

> ID：11347392
> 
> 赞同：2
> 
> 时间：2012-07-05T15:18:17.597
> 
> 标签：c#, visual-studio-2010, web-services, asmx

我有一个网络服务，它使用一些其他项目的 dll 文件。当它在我的本地服务器上运行时一切正常。但是当我部署到服务器时，我有这个错误。

“/”应用程序中的服务器错误。

解析器错误

说明：解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：无法创建类型“Dos.Service.Web.WS.DosMainWebService”。

源错误：

第 1 行：<%@ WebService Language="C#" CodeBehind="DosMainWebService.asmx.cs" Class="Dos.Service.Web.WS.DosMainWebService" %>

源文件：/ws/WS/DosMainWebService.asmx 行：1

版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-09-25T12:57:56.227

我有同样的错误......

我通过更改`Xzy.asmx`文件的属性来解决它：

*   设置`Build Action`为`Content`
*   设置`Copy to Output Directory`为`Copy if newer`（在我的情况下，它设置为“不复制”）

我希望这对任何人都有帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:23:18.470

请确保将 WebService bin 文件夹部署到服务器。我相信它缺少您的网络服务 dll。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T06:42:26.453

我相信您有一个包含 web 服务和其他类库的解决方案文件，并且 web 服务应用程序使用这些类库中的 dll。我可以看到一个问题可能是您将项目类型用作 Web 服务的网站，这在解决 Web 服务命名空间的类型问题时会产生问题。因此解决方案将创建一个新的解决方案作为 Web 应用程序项目类型，然后添加项目库，它应该可以解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-13T05:20:13.910

在网上测试了许多建议的解决方案后，所有问题都是：

每次我只发布 web service.asmx 文件

但是在重新发布所有解决方案后它可以工作..因为 webservice.asmx 有自己的 dll 文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-09T13:02:09.520

我想你首先检查命名空间 asmx.cs 相同的 asmx

# .net - 使用 .NET 调试“Application.exe 已停止工作”

> ID：11347394
> 
> 赞同：1
> 
> 时间：2012-07-05T15:18:20.650
> 
> 标签：.net, windows, debugging

在客户的计算机上，我的应用程序立即崩溃并显示“Application.exe 已停止工作”消息。

我正在使用 .NET Framework 2.0。

我在 Main 方法中使用了一个包罗万象的异常处理程序。main 方法不使用任何项目程序集。因此，如果它是缺少程序集，则应调用此异常处理程序。

我无权访问客户端计算机。我该如何调试这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:21:42.870

在调试模式下编译您的应用程序，将其提供给客户端，希望下次发生这种情况时，JIT 调试器将启动并为您提供堆栈跟踪。

您还可以查看增加日志记录的详细程度。使用 Nlog 之类的东西和一些日志记录对检测问题有很大帮助。看看[nlog 教程](http://nlog-project.org/wiki/Tutorial)。日志记录是当今大多数开发任务中大量未充分使用的东西:(

# ms-access - Access 2010 Web 数据库如何从组合框中提取特定列

> ID：11347399
> 
> 赞同：1
> 
> 时间：2012-07-05T15:18:49.300
> 
> 标签：ms-access, ms-access-2010

我正在访问 2010 中创建一个 Web 数据库

我有一个组合框，我在其中设置了列数 = 2

我还设置了查询以填充组合框

从表 1 中选择 id、值

现在我有第二个组合框，我想为其编写查询

选择 id、值、从 table2 查找其中 table2.lookup = [Forms]![Form1]![Combo1]

但这不起作用，因为它是一个多列组合

我也试过

```
select id, value, lookup from table2 where table2.lookup = [Forms]![Form1]![Combo1].Column(1) 
```

但这是无效的语法

# ms-access - 有人可以解释Access中“AND”和“&”之间的区别吗

> ID：11347406
> 
> 赞同：2
> 
> 时间：2012-07-05T15:19:03.907
> 
> 标签：ms-access

我对 Access 开发非常陌生。昨天，我开发了一个查询，在 WHERE 部分中，我使用了“&”，如下所示：

```
WHERE ((condition A Is Null) & (condition B Is Null)) 
```

它返回了 53 次点击。

然后我把它改成

```
WHERE ((condition A Is Null) AND (condition B Is Null)) 
```

并获得 71 次点击。

我知道这与“按位与”与“逻辑与”有关，但有人可以花点时间用 noobish（英语）向我解释这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T18:44:54.587

`AND`是一个逻辑运算符。 `&`是一个连接运算符。查看[运算符表以](http://office.microsoft.com/en-us/access-help/table-of-operators-HA010235862.aspx)获取有关 Access 2007 中可用的各种运算符的更多详细信息。

要查看操作上的差异，请从 table 开始`WeinerDog`。

```
id field1 field2
 1 a
 2        y
 3 
```

`field1`和列中的空白`field2`表示 Null 值。

接下来运行此查询：

```
SELECT
    WeinerDog.id,
    WeinerDog.field1,
    WeinerDog.field2,
    (WeinerDog.field1 Is Null)
        & (WeinerDog.field2 Is Null) AS concat_result
FROM WeinerDog
WHERE
    (WeinerDog.field1 Is Null) & (WeinerDog.field2 Is Null); 
```

该查询应该给你这个结果集：

```
id field1 field2 concat_result
 1 a             0-1
 2        y      -10
 3               -1-1 
```

检查`concat_result`列。它包含的字符串是连接在一起的 2 个表达式的真值。这些真值是真 (-1) 或假 (0)。但是，由于连接的结果必须是字符串，因此在将它们连接在一起之前，首先将数值真值转换为字符串。

然后检查`WHERE`子句。db 引擎将为您提供`WHERE`子句评估为的所有行`True`。实际上，不只是 -1，除零以外的任何非 Null 值都可以代表`True`. 正如您从该`concat_result`列中看到的那样，这些行都不会被子句评估为零 ( `False`) `WHERE`... 因此表中的所有行都将包含在查询结果集中。

If you change the `WHERE` clause to substitute `AND` for `&`, the query will return only the `WeinerDog` row (id=3) which has Null for both `field1` and `field2`.

```
WHERE
    (WeinerDog.field1 Is Null) AND (WeinerDog.field2 Is Null); 
```

# iphone - 自定义表格单元格滚动

> ID：11347408
> 
> 赞同：0
> 
> 时间：2012-07-05T15:19:11.513
> 
> 标签：iphone, objective-c, ios

我有一个显示自定义单元格的表格视图，这些单元格包含我从文档文件夹加载的图像。我注意到，当我滚动表格时，会有一些滞后，我假设这是从磁盘加载图像。但是，图像已经加载，所以我有点困惑。

有关优化此代码的建议，将不胜感激。我已阅读有关延迟加载的信息，但我不确定这是否适用于我。

我确实检查过以确保表格正在重用单元格。

编辑：

```
- (void)configureCell:(BeerCell *)cell 
          atIndexPath:(NSIndexPath *)indexPath 
{
    Beer *beer = (Beer *) [self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.displayBeerName.text = beer.name;

    // check to see if there is a cached image already.  Use a dictionary.
    // make sure this is one of your ivars
    __block UIImage *theImage = [self.imagesCache objectForKey: beer.imagePath];

    // If the image is not in your cache, you need to retrieve it.
    if (!theImage){
        // The image doesn't exist, we need to load it from disk, web or render it

        // First put a placeholder image in place.  Shouldn't be any penalties after the 
        // first load because it is cached.
        cell.beerImage.image = [UIImage imageNamed:@"beer-pic.png"];

        // check to see if your image cache dictionary has been created, if not do so now
        if (_imagesCache == nil) {
            _imagesCache= [[NSMutableDictionary alloc] initWithCapacity:1];
        }

        // get a weak reference to UITableViewController subclass for use in the block
        // we do this to avoid retain cycles
        __weak BeerListViewController *weakSelf = self;

        // do the heavy lifting on a background queue so the UI looks fast
        dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);
        dispatch_async(queue, ^ {

            theImage = [UIImage imageWithContentsOfFile:beer.imagePath];

            // I added this in because I create the new core data object in this class, and pass
            // it to the class where I fill out the information about the beer
            if (theImage) {

                // Add the image to the cache
                [weakSelf.imagesCache setObject:theImage forKey:beer.imagePath];
                //[weakSelf.imagesCache addObject:theImage forKey:beer.imagePath];

                // Check to see if the cell for the specified index path is still being used
                BeerCell *theCell = (BeerCell *)[weakSelf.tableView cellForRowAtIndexPath:indexPath];
                // Per the docs. An object representing a cell of the table
                //  or nil if the cell is not visible or indexPath is out of range.
                if (theCell){
                    // dispatch onto the main queue because we are doing work on the UI
                    dispatch_async(dispatch_get_main_queue(), ^ {
                        theCell.beerImage.image = theImage;
                        [theCell setNeedsLayout];
                    });
                }
            }
        });
    }        
    else
    {
        // Image already exists, use it.
        cell.beerImage.image = theImage;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T23:34:00.357

每当您从磁盘、服务器加载或为 tableview 渲染图像时，您都希望将其放在后台队列中。这样做很简单，即使在 3GS 上也能获得出色的性能。

我使用类似的方法从非常大的图像中生成表格视图和滚动视图的缩略图，并且性能非常好。

试试这个：

```
- (void)configureCell:(CustomCell *)cell 
          atIndexPath:(NSIndexPath *)indexPath 
{
    CoreDateObject *object = (CoreDateObject *)[self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.displayName.text = object.name;

    // check to see if there is a cached image already.  Use a dictionary.
    // make sure this is one of your ivars
    UIImage *theImage=[self.imagesCache objectForKey: object.imagePath];

    // If the image is not in your cache, you need to retrieve it.
    if (!theImage){
       // The image doesn't exist, we need to load it from disk, web or render it

       // First put a placeholder image in place.  Shouldn't be any penalties after the 
       // first load because it is cached.
       cell.selectedImage.image=[UIImage imageNamed:@"yourPlaceHolderImage"];

       // check to see if your image cache dictionary has been created, if not do so now
       if (_imagesCache==nil){
          _imagesCache=[NSMutableDictionary alloc] initWithCapacity:1];
       }

       // get a weak reference to UITableViewController subclass for use in the block
       // we do this to avoid retain cycles
       __weak YourTableViewControllerSubclass *weakSelf=self;

      // do the heavy lifting on a background queue so the UI looks fast
      dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);
      dispatch_async(queue, ^{

              theImage=[UIImage imageWithContentOfFile:object.imagePath];

              // Add the image to the cache
              [weakSelf.imagesCache addObject:theImage forKey:object.imagePath];

              // Check to see if the cell for the specified index path is still being used
              CustomCell *theCell=(CustomCell *)[weakSelf.tableView cellForRowAtIndexPath:indexPath];
              // Per the docs. An object representing a cell of the table
              //  or nil if the cell is not visible or indexPath is out of range.
              if (theCell){
                 // dispatch onto the main queue because we are doing work on the UI
                 dispatch_async(dispatch_get_main_queue(), ^{
                     theCell.selectedImage.image=theImage
                     [theCell setNeedsLayout];
                 });
              }

    }else{
          // Image already exists, use it.
          cell.selectedImage.image=theImage;
    }

    cell.rating.rate = object.rating.doubleValue;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:41:04.387

这两个链接之一将更好地解释这是如何正确完成的..

[https://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html](https://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html)（苹果官方）

[https://github.com/rs/SDWebImage](https://github.com/rs/SDWebImage) （使用不错的库）..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:45:21.227

`cellForRowAtIndexPath:`每次滚动表格视图时都会调用...因此，如果您在此方法中编写大型处理代码，它可能会挂起您的滚动。因此，如果可能的话，为此制作一个图像数组，然后使用缩略图图像......然后将这些图像添加到数组中的单元格中。我相信你的滚动会很流畅。

# c++ - 在通过引用传递函数时取消引用指针时是否调用了复制构造函数

> ID：11347409
> 
> 赞同：5
> 
> 时间：2012-07-05T15:19:12.343
> 
> 标签：c++

> **可能重复：**
> [通过引用传递时取消引用指针](https://stackoverflow.com/questions/11347111/dereferencing-a-pointer-when-passing-by-reference)

在通过引用传递函数时取消引用指针时是否调用了复制构造函数？

这是一个简单的例子

```
int& returnSame( int &example ) { return example: }

int main()
{
  int inum = 3;
  int *pinum = & inum;

  std::cout << "pinum: " <<  returnSame(*pinum) << std::endl;

  return 0;          

} 
```

我猜怎么回事：

当我们取消引用 pinum 时，我们希望调用复制构造函数，但是由于函数是按值传递的，所以不会调用它？

如果调用 pinum 复制构造函数，则将生成一个临时对象并使用该对象的引用，这将是一个非常糟糕的未定义行为形式的消息......

那么会发生什么......未定义的行为？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-05T15:20:43.407

不，不会调用复制构造函数。

解引用运算符创建一个引用现有对象的左值。引用参数绑定到这个现有对象。

# svn - http://127.0.0.1:9890/ubersvn 没有响应

> ID：11347414
> 
> 赞同：0
> 
> 时间：2012-07-05T15:19:22.557
> 
> 标签：svn, ubersvn

`http://127.0.0.1:9890/ubersvn`尽管我能够通过 RAD 提交更改，但没有响应。我可以通过具有相同 IP 的 IE 访问存储库页面。`http://127.0.0.1:9890/reporitory`

2 周前，我在我的机器上安装了 SVN 并创建了用户和存储库。当我尝试访问服务器以`http://127.0.0.1:9890/ubersvn`使用相同的 URL 添加更多用户时，页面显示消息*“Internet Explorer 无法显示网页”*。

我不知道该怎么办？如何添加用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:01:14.697

我重新启动了服务器，但它显示错误消息，因为它已经在运行。但我再次尝试使用相同的 URl 它工作正常。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T20:39:07.533

uberSVN 管理界面默认运行在 9890 端口，但 SVN 服务器实际上默认运行在 9880。

你确定你打对了端口吗？

我问的原因是因为不可能在同一端口上同时运行 uberSVN 管理界面和 SVN Apache 服务器，您最初的帖子建议您尝试这样做。

# java - JSF 货币在数据库上映射为 NUMBER

> ID：11347417
> 
> 赞同：2
> 
> 时间：2012-07-05T15:19:31.590
> 
> 标签：java, jsf, seam

我正在使用 Seam 2.2.2、JSF Mojarra 1.2_13-b01-FCS、JBoss 5.1.0 服务器。

我有一个 Oracle 表，其中三列指定为 NUMBER 类型。生成的休眠映射已将实体类中的这些列映射为 java.math.BigDecimal。这些是货币值，BigDecimal 似乎是在 Java 中存储和计算这些值的首选方式。

我正在尝试使用数字转换器将屏幕上的值用作 h:inputText 和 h:outputText 中的货币。工作正常，直到我尝试更新其中一个值，当java抛出异常时：

EquipItemEdit.xhtml value="#{equipItemHome.instance.cost}": java.lang.IllegalArgumentException: 参数类型不匹配

我的实体映射如下：

```
@Entity
@Table(name = "EQUIP_ITEM")
public class EquipItem implements java.io.Serializable {
  ...

    private BigDecimal cost;
  ...

        @Column(name = "COST", precision = 22, scale = 0)
    public BigDecimal getCost() {
        return this.cost;
    }

    public void setCost(BigDecimal cost) {
        this.cost = cost;
    }

  ...
} 
```

数据库中的表定义

```
CREATE TABLE EQUIP_ITEM
(
  EQUIP_ID      NUMBER,
  COUNTER       NUMBER,
  ITEM          VARCHAR2(6 BYTE),
  ACQADC        VARCHAR2(1 BYTE),
  COG           VARCHAR2(2 BYTE),
  COST          NUMBER,
  NOMENC        VARCHAR2(40 BYTE),
  QUA_AUTH      NUMBER,
    ...
) 
```

以及字段在 JSP 上的映射方式：

```
...
<h:inputText id="cost"
 styleClass="value"
          value="#{equipItemHome.instance.cost}"
           size="15">
    <f:convertNumber type="currency" currencySymbol="$" locale="en_US"/>                                        
</h:inputText>
... 
```

有什么建议，或者有人可以指出我处理这种数据类型的正确方法吗？

* * *

现在为了让事情正常工作，我编写了自己的转换器。还没有做太多的测试，希望有人能告诉我如何让 JSF 内置转换器为此工作。

```
import java.io.Serializable;
import java.math.BigDecimal;
import java.text.NumberFormat;
import java.text.ParseException;
import java.util.Locale;

import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;

import org.jboss.seam.annotations.Name;
import org.jboss.seam.annotations.intercept.BypassInterceptors;

@Name("usDollarsConverter")
@BypassInterceptors
@org.jboss.seam.annotations.faces.Converter
public class UsDollarsConverter implements javax.faces.convert.Converter, Serializable {

    public Object getAsObject(FacesContext context, UIComponent component, String     string) {
        if(string == null) {
            return null;
        }       

        try {
            NumberFormat nf = NumberFormat.getCurrencyInstance(Locale.US);          
            nf.setMinimumFractionDigits(2);
            nf.setMaximumFractionDigits(2);         
            Object value = nf.parse(string);
            if(value instanceof Double) {
                value = new BigDecimal((Double)value);
            } else if(value instanceof Long) {
                value = new BigDecimal((Long) value);
            }
            return value;
        } catch (ParseException e) {
            return null;
        }           

    }

    public String getAsString(FacesContext context, UIComponent component, Object value) {
        if(value == null) {
            return null;
        }

        if(value instanceof Double) {
            value = new BigDecimal((Double)value);
        } else if(value instanceof Long) {
            value = new BigDecimal((Long) value);
        }

        if(value instanceof BigDecimal) {
            NumberFormat nf = NumberFormat.getCurrencyInstance(Locale.US);          
            nf.setMinimumFractionDigits(2);
            nf.setMaximumFractionDigits(2);         
            return nf.format(((BigDecimal)value).doubleValue());            
        }

        throw new java.lang.IllegalArgumentException("UsDollarsConverter requires a type java.math.BigDecimal, will not work with " +     value.getClass().getCanonicalName());
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:47:57.640

尽管它的名字，`<f:convertNumber/>`不会转换`BigDecimal`...如果您检查 Javadoc 中的`javax.faces.convert.NumberConverter`，它会告诉您它将生成 a `Long`（用于整数）或 a `Double`。这是因为，要使用 NumberFormat 解析 BigDecimals，您需要设置一个标志`setParseBigDecimal(true)`，否则 NumberFormat 对象只会产生双精度数。

`javax.faces.BigDecimal`JSF 确实为 BigDecimals （恰当地命名）提供了一个单独的转换器，而不是`<f:convertNumber/>`使用：

`<f:converter converterId="javax.faces.BigDecimal" />`

并且转换将起作用。但是，此转换器不如 灵活`<f:convertNumber/>`，您不能设置模式或使用不同的语言环境等。因此，大多数人只是编写自己的转换器实现。

# sql-server-2008 - 如何插入一个表中的记录并将其与第二个表中的现有记录相关联？

> ID：11347422
> 
> 赞同：0
> 
> 时间：2012-07-05T15:19:50.280
> 
> 标签：sql-server-2008, tsql

我有两个共享一对一关系的表（实际上是一对多，但我将其用作一对一）。具有外键的表具有外键设置为 NULL 的现有记录。我想编写一个 TSQL 脚本，它将为第一个记录中的每个记录添加一个默认记录到第二个表中，并更新第一个的外键以与新记录相关？知道我该怎么做吗？

我想创建一个脚本，这样当发布我的新版本时，我不仅可以更新我的开发数据库，​​还可以更新实时数据库。

谢谢。

**编辑：**

![在此处输入图像描述](../Images/d85475e67937ec81d3960b26fbc5fa91.png)

**进一步编辑：**

我将使用文字插入默认值。我不能更具体。这是一个非常简单的场景，涉及两个表之间的一对多关系。

**进一步编辑：**

我处于各种 NDA 之下。我可以花时间模拟一个示例情况。我需要在上面的表 1 中创建记录，表 2 中的每个记录一个，然后将表 1 中的键设置为表 2 中关联记录中的外键。这似乎是一件常见的事情。

我认为解决方案是创建一个临时表，但我不确定如何做细节。有没有办法插入一个临时表并将插入表的标识保存到临时表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:05:33.547

做一些假设，下面的代码可以做到这一点：

```
insert into t2(keyval)
    select keyval
    from t1
    where t1.t2id is null and
          t1.keyval not in (select keyval from t2)

update t1
    set t2id = t2.t2id
    from t2
    where t1.keyval = t2.keyval 
```

假设是：

1.  在此过程中，两个表都没有被修改。
2.  t2.t2id 是一个标识列，因此在插入时会自动分配 id
3.  第一个表同时包含 id 和要匹配的值

# android - onTouch event.getX 或 Y 在不同屏幕尺寸上的一致性 - Android

> ID：11347428
> 
> 赞同：1
> 
> 时间：2012-07-05T15:20:12.200
> 
> 标签：android, android-layout, android-view, android-event, android-screen-support

我正在`OnTouchListener`自定义视图上实现。在这个视图中，我正在绘制一个基本上沿 x 和 y 轴移动的对象，我分别得到了形式`event.getX();`和`event.getY();`。

`draw`当触摸事件发生在屏幕的特定位置时，我想执行一些更改。问题是，*不同屏幕尺寸的值不同*。例如，**WVGA**设备上某个点的**X值是****60**，**平板电脑**上是**100**。由于这不一致，我无法编写适当的条件。********`if`********

 ******请问有人可以根据您以前的经验提出解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:24:53.880

您可以将要接收触摸事件的基本屏幕尺寸设置为 800 x 600。然后您可以获得设备的实际分辨率，并以此来缩放您的基本数量。即 X 大小将是（800/ 设备宽度），然后您将设备屏幕触摸坐标乘以该比例因子以获得“翻译”版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:36:08.610

您可以获得任何设备的分辨率。您可以执行诸如获取屏幕的 getWidth() 和 getHeigth() 之类的操作。然后您可以设置宽度/2 和高度/2 的逻辑 -> 为您提供屏幕的左上部分。做这样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T14:38:05.213

我基本上对这两个答案都有好主意，（我的尊重）但对我有用的解决方案如下。这个想法来自Chintan Raghwani的线索。

因此，假设`position x`设备屏幕上的值等于总`view`宽度乘以`percentage`

示例：`posX = getMeasuredWidth() * 0.5`将为您提供在中心处理的触摸事件。通过这种方式定位对象将使其在所有设备中保持一致。

希望它对某人有帮助:)

**编辑 ：**

很幸运能找到这篇文章。上面的这个过程也被称为**黄金比例** [，这](http://blog.coh.io/post/7760821984/golden-ratio)真的是一篇很棒的文章。******

# iphone - 从 iOS 连接到 MSSQL DB

> ID：11347440
> 
> 赞同：0
> 
> 时间：2012-07-05T15:20:42.883
> 
> 标签：iphone, objective-c, ios, c, sql-server

我知道直接连接数据库不是好主意，但我需要它（MS SQL）。所以问题是：是否有一些库，最好用 Objective-C/C 编写并编译为静态库，从而提供所需的结果？

我知道 FreeTDS，但我不知道如何构建它。是否有 xcode 项目，或者我该如何制作？

非常感谢。

# objective-c - Cocoa 命令行工具方法声明

> ID：11347442
> 
> 赞同：1
> 
> 时间：2012-07-05T15:20:43.700
> 
> 标签：objective-c, cocoa, command-line-tool

所以这个问题是为了帮助我更好地理解 Cocoa-touch 框架的内部工作原理，这似乎是一个非常简单的问题。

如果您要使用 Xcode 创建命令行工具，例如，使用 Core Data，Xcode 会在“main.m”文件中生成方法，这些方法在括号中接收参数，而不是指示 Objective-C 的冒号。例如下面是生成的方法声明

```
static NSManagedObjectContext *managedObjectContext() 
```

但是，仍然在方法内部发送了 Objective-C 消息。例如，

```
NSString *path = [[[NSProcessInfo processInfo] arguments] objectAtIndex:0];
path = [path stringByDeletingPathExtension];
NSURL *modelURL = [NSURL fileURLWithPath:[path stringByAppendingPathExtension:@"momd"]];
model = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL]; 
```

这是因为 main.m 文件是 C/C++ 文件而不是 Objective-C 文件，即使它们共享相同的文件扩展名？感谢您的任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:32:03.130

声明：

```
static NSManagedObjectContext *managedObjectContext(); 
```

是一个 C 函数，可以在 Objective-C 源文件中毫无问题地声明和定义。但是，您不能与在 C 源文件中声明 Objective-C 类和方法相反；例如这是非法的：

我的文件.c：

```
@interface MyObject

- (int)nothing:(int)value
{
    return value;
}

@end 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T17:11:15.187

基本上，虽然 Objective-C 具有可以被视为 C++ 静态方法的扩展版本的“类方法”，但与普通 C 函数相比，使用这些方法通常没有任何好处。

如果您仍然没有课程，那就更不用说了（在这种情况下，您只是添加了 Objective-C 开销）。

Objective-C 被称为 Objective-C 是有原因的：它由“Objective-”和“C”组成。没有必要忽略“C”部分。用不同的方式做同样的事情而几乎没有甚至没有“真正的”差异的情况并不少见。

# gnuplot - 在 gnuplot 的条形图上添加误差线

> ID：11347444
> 
> 赞同：9
> 
> 时间：2012-07-05T15:20:44.853
> 
> 标签：gnuplot

我想使用 gnuplot 条形图绘制以下文件：

```
Function X X-ERROR Y Y-ERROR
A 1.311539 0.066268 1.000000 0.000000
(a1,b0)  1.325429 0.083437 1.010926 0.016710
(a.9,.b1)  1.134640 0.040017 1.276168 0.060281
(a.8,.b2)  1.078336 0.058529 1.346358 0.054645
(a.7,.b3)  1.035866 0.060660 1.318395 0.018087
(a.6,.b4)  0.982717 0.047363 1.196714 0.047427
(a.5,.b5)  0.962423 0.051994 1.127991 0.044731
(a.4,.b6)  0.953673 0.046014 1.139608 0.044726
(a.3,.b7)  0.948948 0.050462 1.169209 0.044333
(a.2,.b8)  0.941013 0.047166 1.198138 0.045844
(a.1,.b9)  0.929961 0.057801 1.328111 0.088813
(a0,b1)  0.966331 0.036079 3.289381 0.213192
B  1.000000 0.000000 3.321802 0.121290 
```

我可以使用以下方法完美地绘制图表：

```
plot 'file.dat' using 4:xtic(1) title col, \\
        '' using 2:xtic(1) title col; 
```

但是，我想使用第 3 列和第 5 列来表示我一直计算的置信区间。有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-09T10:47:49.703

假设您要绘制带有关联误差线的并排条形图，我将使用以下内容：

```
set xrange [-0.5:12.75]
set xtic rotate by -45
set boxwidth 0.25
plot 'file.dat' using ($0-.05):4:5:xtic(1) with boxerrorbars title col, \\
     '' using ($0+0.25):2:3 with boxerrorbars title col 
```

这个想法只是抵消 x 轴上的两个度量之一。

![在此处输入图像描述](../Images/25a35fa162fc13a9536a8ae1a3893e75.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T03:53:02.527

我认为这应该做你想做的（如果我正确理解你的情节......）

```
plot 'test.dat' using (column(0)):4:3:xtic(1) w errorbars title col, \
     '' using (column(0)):2:5:xtic(1) w errorbars title col; 
```

# php - PHP Mail 突然停止工作

> ID：11347454
> 
> 赞同：3
> 
> 时间：2012-07-05T15:21:22.870
> 
> 标签：php, email

我已经有一段时间在我网站的联系表单中使用 php 邮件功能来发送电子邮件。最近，我发现它只是停止工作。当我在我的联系表格中发送查询时，它说成功发送但我所做的测试都没有进入我的收件箱..

有人在这里遇到同样的问题吗？我怎么可能解决这个问题？

我检查了cpanel中的MX条目，数据是正确的。我想尝试 SMTP，但我没有访问信息。

在这件事上有什么帮助吗？

我发现的其他信息：Web 服务器托管在其中一家托管公司中。邮件服务器托管在 google 中。

这里的问题可能出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:23:13.617

问题可能出在您的托管服务提供商上，它“发现”您的表单正在产生大量流量并且被阻止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:26:44.757

或者出了什么问题。看`/var/log/mail.*`问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:26:45.740

您是否正确验证了 mail() 函数返回的内容？

检查您的 error_log 可能是个好主意，以确保它在 PHP 中没有任何内容。如果可以的话，尝试将您的代码放在另一台服务器上以查看邮件是否发送（使用邮件功能制作一个小程序）。如果是这样，那么它很可能是您的 ISP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:36:01.483

以下是直接连接到 SMTP 的方法：

```
$smtp = fsockopen("localhost", 25, $errno, $errstr, 15);
if(!$smtp) { 
    echo "failed";
}
else {
    stream_set_timeout($smtp, 0, 80000);
    fwrite($smtp, "HELO domainname.com\r\n");
    stream_set_blocking($smtp, 0);
    fwrite($smtp, "MAIL FROM:<".$from.">\r\n");
    fwrite($smtp, "RCPT TO:<$to>\r\n");
    fwrite($smtp, "DATA\r\n");
    fwrite($smtp, "Date: ".date("r")."\r\n");
    fwrite($smtp, "From: <".$from_address.">\r\n");
    fwrite($smtp, "Reply-to: $replyto\r\n");
    fwrite($smtp, "Subject: Test\r\n");
    fwrite($smtp, "To: $to\r\n");
    $outMsg .= "Whatever your email body is, then end it with a period on a new line\r\n.\r\n";
    $bitesWritten = fwrite($smtp, $outMsg);
    echo "Wrote $bitesWritten of " strlen($outMsg);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T19:43:55.857

好吧，这里的问题是托管服务器的邮件 exim 被破坏了。因此，托管支持必须对其进行更新，从而解决问题。

# ios - Pushwoosh PhoneGap 通知仅发送给部分订阅者

> ID：11347460
> 
> 赞同：4
> 
> 时间：2012-07-05T15:21:35.760
> 
> 标签：ios, cordova, phonegap-plugins

好的，所以我一直在为 IOS 应用程序使用 phonegap 一段时间。我开始将 Pushwoosh 集成到一个新的应用程序中，这样我就可以发送推送通知并且它工作正常。

现在我需要知道 Pushwoosh 是否具有扩展功能。

这将是：我的应用程序将有 50 个用户和 5 个组。任何用户都可以属于多个组。现在我的应用程序连接到外部数据库，因此我能够确定用户所在的组。这意味着当 Pushwoosh 注册设备时，我还可以获取设备 ID 并将其保存到数据库中。

现在 Pushwoosh 是否有一个我可以调用的 api，所以我可以只向某些用户发送通知。IE。用户 1 在组 2 中。因此我只想向组 2 中的用户发送通知？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T20:54:16.880

您可以使用 Pushwoosh Remote API 将通知发送到特定设备。您只需要将推送令牌传递给 API 调用。

即将到来的更新将带来标签和过滤器功能，使服务器端逻辑不那么复杂和容易。

# c++ - C++ 使用智能指针

> ID：11347462
> 
> 赞同：0
> 
> 时间：2012-07-05T15:21:38.860
> 
> 标签：c++, smart-pointers

在我的代码中，我有函数原型

```
void AddBenchNode(ref_ptr<Group> root ,ref_ptr<Node> benches, bool setAttitude = false, float scale_x =.15, float scale_y =15, float scale_z = 15, int position_x = 250, int position_y = 100, int position_z =0 ); 
```

其中 ref_ptr 是一个智能指针。

在我的主函数中，我定义了 2 个 ref_ptr 和 ref_ptr 类型的智能指针，并将它们传递给对我的函数 AddBenchNode 的调用。

```
ref_ptr<Group> root = new Group();
ref_ptr<Node> benches = readNodeFile("Models/test.ive");
AddBenchNode(root, benches, true); 
```

当调用执行时，什么也没有发生。因为没有对根指针进行任何更改。我想知道的是我是否正确地拨打了这个电话？或者我是否必须重新定义我的函数以获取指向这些智能指针的指针？

现在我确实尝试通过引用传递

```
void AddBenchNode(osg::ref_ptr<osg::Group>& root ,osg::ref_ptr<osg::Node>& benches, bool setAttitude = false, float scale_x =.15, float scale_y =15, float scale_z = 15, int position_x = 250, int position_y = 100, int position_z =0 ); 
```

这导致了一些链接器错误。

**错误 2 错误 LNK2001: 无法解析的外部符号 "void __cdecl AddBenchNode(class osg::ref_ptr &,class osg::ref_ptr &,bool,float,float,float,int,int,int)" (?AddBenchNode@@YAXAAV?$ ref_ptr@VGroup@osg@@@osg@@AAV?$ref_ptr@VNode@osg@@@2@_NMMMHHH@Z) Error 3 error LNK1120: 1 unresolved externals**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:24:57.880

您正在按值传递（智能）指针。这意味着调用者和被调用者将共享同一个对象，但具有单独的指针副本。函数对对象所做的更改将对调用者可见。但是如果函数创建一个指向一个全新对象的指针，它不会影响调用者的指针，它仍然指向旧对象。

如果要重新绑定调用者的指针，需要通过指针或引用来传递指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:24:44.810

看起来您正确使用了智能指针，但很难说错误在哪里，因为我们不知道是什么`ref_ptr`或做什么`AddBenchNode`。

`ref_ptr`来自[openscenegraph](http://www.openscenegraph.org/documentation/OpenSceneGraphReferenceDocs/a00581.html)？_

# c++ - QT Creator 中的部署和静态打包将 QT 和 OpenCV 链接到单个可执行文件中

> ID：11347465
> 
> 赞同：1
> 
> 时间：2012-07-05T15:21:48.867
> 
> 标签：c++, qt, opencv, qt-creator, static-linking

有没有人使用 QT 和 OpenCV 的组合，并且有一个很好的方法来打包你的软件并部署给你的用户？我们开发的 QT Creator 有一个发布和部署按钮，但它似乎与生成的二进制文件没有什么不同，而不是常规构建和使用路径中库的动态链接。

我们主要对 Linux 和 Mac 感兴趣，但也想了解适用于 Windows 的好方法。

我们已经做了一些关于必须静态编译 QT 版本的研究，但这是否意味着每次在通用测试中构建项目时，我们都必须重新编译所有 QT？

* * *

更新！在此处的帮助下，我得到了 QT 静态编译并将其自身捆绑到 Ubuntu 上的二进制文件中。我现在的问题是出现错误，例如

```
":-1: error: error: avformat: No such file or directory" 
```

当我尝试使用静态版本的 opencv 2.4.2 进行编译时

这是我所做的：

对我来说，诀窍是弄清楚“path/to/qt”是什么意思，以及在“-prefix”之后放什么。Suslik 的链接将我引向了这个：[github.com/refuge/whitesheep/wiki/Compiling-Qt-statically](http://www.formortals.com/how-to-statically-link-qt-4/)，这大致相同，但帮助我找出了正确的语法以使一切顺利进行。最后我发现你需要下载[库的 qt-everywhere tar](http://qt.nokia.com/downloads/downloads#qt-lib)，解压缩，进入它然后运行命令，使用“path/to/qt”作为这个文件夹。因此我的命令看起来像这样

```
cd /home/biotracking/qt-everywhere-opensource-src-4.8.2
./configure -static -prefix /home/biotracking/qt-everywhere-opensource-src-4.8.2 
```

接下来在 QtCreator 中，我选择“Projects>BuildSettings>Add”，我将这个新的构建设置称为“staticrelease”。在“Qt 版本：”下，我选择管理，找到包含全新 qmake 文件的“qt-everywhere-opensource-src-4.8.2”内的 bin 文件夹并选择它。现在 QT 将使用这个静态版本的 QT 并制作一个不错的胖二进制文件（不过似乎不需要更长的时间，这很好！）

然后我必须进入我的 Qt-OpenCv 项目中的 .pro 文件并添加一些静态命令，所以现在它看起来像这样：

```
QT       += core gui

TARGET = AntennateSRC
TEMPLATE = app

CONFIG+=static
QMAKE_LFLAGS += -static
QMAKE_LFLAGS += -static-libgcc

static{
DEFINES += STATIC

}

unix {
        CONFIG += link_pkgconfig
        PKGCONFIG += opencv
        PKGCONFIG += pcl_io-1.6
#PKGCONFIG += pcl_libraries

}
SOURCES += main.cpp\
        antennate.cpp \
    Track.cpp \
    ICPTracker.cpp

HEADERS  += antennate.h \
    Track.h \
    ICPTracker.h

FORMS    += antennate.ui

RESOURCES += antennate.qrc \ 
```

这就是我卡住的地方。我编译了一个静态版本的opencv 2.4.2（在cmake-gui中关闭了BUILD_SHARED_LIBS），成功了，卸载了旧的opencv，安装了这个版本。现在我得到了 9 个奇怪的错误，比如

```
:-1: error: error: swscale: No such file or directory 
```

PS. 604kb 与 13.9 mb 的可分发文件大小的差异，就我们而言，这仍然不是那么大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T17:38:46.123

1.  Qt 是 LGPL 的，因此静态链接它需要您公开源代码。这对你来说可能是也可能不是问题，但在你走这条路之前要确保。

2.  在 Linux 上打包和发布取决于目标发行版是什么。看看这个：[构建 Qt 应用程序 Linux](https://stackoverflow.com/questions/10776170/building-qt-application-linux/10787919#10787919)。Shell 脚本是您的朋友。

3.  对于 Mac，您需要遵循本指南：http: [//doc.qt.io/archives/qt-4.7/deployment-mac.html](http://doc.qt.io/archives/qt-4.7/deployment-mac.html)

# ios - 捆绑标识符在 iOS 项目中意味着什么？

> ID：11347470
> 
> 赞同：42
> 
> 时间：2012-07-05T15:21:53.603
> 
> 标签：ios

当我使用命令行工具模板时，它在向导中有一个包标识符。捆绑标识符是什么意思？这类似于命名空间吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-05T15:31:48.440

根据[苹果文档](https://developer.apple.com/go/?id=bundle-structure)：

包标识符让 iOS 和 macOS 识别您的应用程序的任何更新。您的捆绑包 ID 必须在 Apple 注册，并且对于您的应用程序是唯一的。Bundle ID 是特定于应用程序类型的（iOS 或 macOS）。iOS 和 macOS 应用程序不能使用相同的捆绑包 ID。

# 编辑

从 Xcode 11.4 开始，如果您想支持通用购买功能，您可以为 iOS 和 macOS 应用程序使用相同的包标识符。

来自[发行说明](https://developer.apple.com/documentation/xcode_release_notes/xcode_11_4_beta_release_notes)

> Xcode 11.4 支持构建和分发 macOS 应用程序作为通用购买。要将您的 macOS 应用程序作为通用购买分发，请在创建新项目时在 Xcode 模板助手中指定与您的 iOS 应用程序相同的包标识符。如果您有一个现有项目，请在项目编辑器中编辑其包标识符。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-07-05T15:26:33.520

包标识符是向系统标识您的应用程序的唯一字符串。这与*显示名称*（命名空间通常是框架中的前缀）相比，这是 iOS 用来在跳板上显示应用程序名称的名称。

捆绑标识符通常（并非总是）以反向 DNS 表示法（即 com.myCompany.myApp）写出。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-01-24T14:13:07.333

为上述答案添加更多要点：配置文件，应用程序的捆绑 ID 必须是唯一的，并且项目分配给团队。此 id 可以在应用程序的目标常规选项卡中设置。为了创建默认的 bundle ID，Xcode 将公司标识符与您在从模板创建项目时输入的产品名称连接起来。字符串格式应为统一类型标识符（UTI），即字母数字字符（AZ、az、0-9）、连字符（-）和句点（.）

# jsp - 未捕获到异常时屏幕上变量的输出值

> ID：11347471
> 
> 赞同：0
> 
> 时间：2012-07-05T15:21:56.037
> 
> 标签：jsp, spring-mvc, jstl, tiles

在我的 Web 应用程序中，我必须给出这一行来检查对象是否具有字段

```
<c:catch var="itemException">${item.masterOrderId}</c:catch> 
```

但是，似乎当抛出异常时，页面按预期工作，但是当货币项目有一个字段时`masterOrderId`，页面会得到一行所有主订单 ID 的丑陋输出，像这样

```
 7876288237088001859330060608701482416601260870751365393358087099973546544808785323837468560876664746049371087079881351783808767780494694690870295666366152083001 
```

当我尝试检查页面源时，有趣的是我找不到字符串。所以请让我知道我能做些什么来找出诀窍，这样我就可以做一些事情来避免讨厌的输出。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T14:21:42.197

实际上，只需再次查看您的问题：

*在我的 Web 应用程序中，我必须给出这一行来检查对象是否具有字段*

```
<c:catch var="itemException">${item.masterOrderId}</c:catch> 
```

如果您在 JSP 中将此作为一行，并且 c:catch 标记没有出现异常，则它正在执行 EL 标记并将 ID 打印到页面。相反，您应该在将要使用它的位置捕获 ID。例如：

```
<table>
<c:forEach var="${item}" items="${items}">
    <c:catch var="itemException">
        <tr>
            <td>${item.a}</td>
            <td>${item.b}</td>
            <td>${item.masterOrderId}</td>
        </tr>
    </c:catch>
</c:forEach>
</table> 
```

这样，如果出现异常，该行就会被抑制，如果没有，则 ID 会在适当的位置输出。

# java - Android 错误：您必须指定有效的布局参考。布局 ID。在椭圆形

> ID：11347477
> 
> 赞同：2
> 
> 时间：2012-07-05T15:22:23.963
> 
> 标签：java, android, xml, eclipse

我已经和 elcipse 合作了几个星期了。我的代码运行正常，但突然停止工作。我得到这个错误，

main.xml：您必须指定一个有效的布局引用。布局 ID @layout/required 无效。

我的 XML 代码

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <!--  select between BIN or auction -->
    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:orientation="horizontal" >

    <Button
        android:id="@+id/AuctionButton"
        android:layout_marginLeft="82dp"
        android:layout_width="119dp"
        android:layout_height="wrap_content"
        android:onClick="showAuctionOptions"
        android:text="Auction" />

    <Button
        android:id="@+id/BINButton"
        android:layout_marginLeft="-2dp"
        android:layout_width="119dp"
        android:layout_height="wrap_content"
        android:onClick="showAuctionOptions"
        android:text="Buy it now" />

    </LinearLayout>

        <include android:id="@+id/cell1" layout="@layout/required"/>

        <include android:id="@+id/cell2"  layout="@layout/gray_line" />

        <!--**  Show if Buy it now is selected **-->
        <include android:id="@+id/cell3" layout="@layout/buyitnow" />
        <!-- ** End Buy it now display ** -->

        <!--** Show if auction selected ** -->
        <include android:id="@+id/cell4" layout="@layout/auction" />

        <include android:id="@+id/cell5"  layout="@layout/gray_line" />

        <include android:id="@+id/cell6" layout="@layout/addons" />

        <include android:id="@+id/cell7" layout="@layout/calculate" />      

</LinearLayout>

</ScrollView> 
```

错误在于第一个包含，但是如果我删除它，我只会收到第二个包含的错误。如果我删除所有包含，我的 java 代码中会出现“无法解析 R”错误。

我尝试过的，

*   清理项目
*   重新启动日食
*   重新启动我的电脑

这是我的 AndroidManifest XML 文件，

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="toggler.state"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name">
        <activity
            android:name=".TogglerActivity"
            android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

没有一个有效。有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:26:59.653

该错误可能是在布局的其他地方引起的。去掉多余的两个`xmlns:android="http://schemas.android.com/apk/res/android"`

`xmlns`用于定义命名空间。在大多数情况下，只有顶部元素可以拥有它。

看看[XML 中的“xmlns”是什么意思？](https://stackoverflow.com/questions/1181888/what-does-xmlns-in-xml-mean)如果有人想阅读`xmlns`解释。

还要检查以确保您的 XML 文件都是小写的。

还要尝试查看清单中是否指定了正确的包。取自[https://stackoverflow.com/a/7496766/935779](https://stackoverflow.com/a/7496766/935779)

> 值得一试`AndroidManifest.xml`。属性包具有正确的值。
> 
> 那是，`<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="your.correct.package.name" ...`
> 
> 更改后，将重新生成 R.java。

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">

        <!--  select between BIN or auction -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:orientation="horizontal" >

        <Button
            android:id="@+id/AuctionButton"
            android:layout_marginLeft="82dp"
            android:layout_width="119dp"
            android:layout_height="wrap_content"
            android:onClick="showAuctionOptions"
            android:text="Auction" />

        <Button
            android:id="@+id/BINButton"
            android:layout_marginLeft="-2dp"
            android:layout_width="119dp"
            android:layout_height="wrap_content"
            android:onClick="showAuctionOptions"
            android:text="Buy it now" />

        </LinearLayout>

        <include android:id="@+id/cell1" layout="@layout/required"/>

        <include android:id="@+id/cell2"  layout="@layout/gray_line" />

        <!--**  Show if Buy it now is selected **-->
        <include android:id="@+id/cell3" layout="@layout/buyitnow" />
        <!-- ** End Buy it now display ** -->

        <!--** Show if auction selected ** -->
        <include android:id="@+id/cell4" layout="@layout/auction" />

        <include android:id="@+id/cell5"  layout="@layout/gray_line" />

        <include android:id="@+id/cell6" layout="@layout/addons" />

        <include android:id="@+id/cell7" layout="@layout/calculate" />      

    </LinearLayout>

</ScrollView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T01:32:12.390

我遇到了类似的问题，并且能够通过为 include 标签提供 layout_width 和 layout_height 来解决它。

# c# - 如何在不使用集合索引的情况下绑定到集合？

> ID：11347480
> 
> 赞同：0
> 
> 时间：2012-07-05T15:22:28.647
> 
> 标签：c#, wpf, binding, collections

我正在尝试学习 WPF 中的 MVVM 模式，并且遇到了绑定和集合的一些问题。我不喜欢绑定到集合的索引，因为集合发生了变化。

我有`MyModelClass : ObservableCollection<MyData>`

该类`MyData`有一个调用属性`DataValue`来保存我的自定义信息。`MyModelClass`我用`MyData`对象填充。在视图模型类 ( `MyViewModel`) 我有一个`CurrentData`类型的属性`MyModelClass`。

现在在这种情况下，我的绑定是一个组合框。这是绑定的样子：

```
<ComboBox Name="cmbxData" 
  ItemsSource="{Binding Path=CurrentData}"
  DisplayMemberPath="DataValue"
  SelectedValuePath="DataValue"
  SelectedValue="{Binding Path=CurrentData[0].DataValue}"/> 
```

这一切都很好，并且`MyViewModel`该类具有 PropertyChanged 通知的接口设置。我需要每隔几秒钟刷新一次保存的信息。

我正在通过在以下内容中执行以下操作来刷新集合`MyModelClass`：

```
public Class MyModelClass : ObservableCollection<MyData>
{
    private static MyModelClass current = null;
    public static MyModelClass Current
    {
        get
        {
             if(current == null)
                 current = new MyModelClass();

             return current;
        }
    }

    private void UpdateModel(MyData newData)
    {
         MyModelClass newModel = new MyModelClass();
         newModel.Add(newData);
         current = newModel;

    }
} 
```

里面`MyViewModel`是这样的：

```
MyModelClass CurrentData = MyModelClass.Current; 
```

我尽我所能提供尽可能多的代码并保持简单。请让我知道是否需要进一步澄清。感谢您就如何解决我的问题提出任何建议。

如果您错过了： 问题：如何绑定到集合，或者我想在集合中显示的值，而不使用上面显示的索引（`SelectedValue="{Binding Path=CurrentData[0].DataValue}"`）？我该如何解决这个问题或将我的实现更改为正确？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:27:31.427

在 MyModelClass 上添加一个名为“SelectedData”或类似的属性。然后将该属性绑定到 ComboBox 的 SelectedItem 属性

# google-sheets - 谷歌表格数组公式问题

> ID：11347482
> 
> 赞同：0
> 
> 时间：2012-07-05T15:22:36.230
> 
> 标签：google-sheets, google-sheets-formula, array-formulas

在过去的几个月里，我一直在谷歌文档电子表格中使用以下公式。大约 4 周前它停止工作。我不知道为什么 - 没有发现任何说明公式的工作方式发生变化的东西，并且没有对我的数据进行更改。

我得到的错误是：

> “错误：参数为空白”，不是很有帮助。

这是公式：

```
=arrayformula(
        sum(
            (Sheet1!$B$2:$B$100458=$A3)
            *
            (arrayformula(
                month(Sheet1!$A$2:$A$100458)
                )
                = month(C$1)
            )
            *
            (arrayformula(
                year(Sheet1!$A$2:$A$100458)
                )
                =year(C$1)
            )
        )
    ) 
```

它在第一列有一个唯一的 ID，在顶行有一个日期（每个月的第一天）。然后，它遍历工作表 1，查找在月份和年份中有多少记录与该 ID 匹配并返回计数。有一阵子还好好的，不知道怎么回事。我什至尝试回到修订历史并没有发现任何差异。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:12:48.997

不知道为什么它之前有效，但在完成每一步之后，这是我必须做的才能让它工作。

```
=arrayformula(
    sum(
        iferror(
            arrayformula(Sheet1!$B$2:$B$100458=$A3)
            , FALSE
        )
        *
        iferror(
            arrayformula(
                month(Sheet1!$A$2:$A$100458)
                = month(C$1)
            )
            ,FALSE
        )
        *
        iferror(
            arrayformula(
                year(Sheet1!$A$2:$A$100458)  
                =year(C$1)
            )
            ,FALSE
        )   
    )
) 
```

基本上重新排序一些数组公式并添加 iferror() 函数。似乎数组公式在通过记录末尾时抛出错误而不是错误，因此 sum 也抛出错误。Iferror() 解决了这个问题。

# javascript - 在按钮单击时从 javascript 中的 usercontrol 获取值

> ID：11347492
> 
> 赞同：0
> 
> 时间：2012-07-05T15:23:10.340
> 
> 标签：javascript, asp.net

我有以下情况。我的页面中有一个用户控件，它有一个单选按钮。该控件放置在页面中，单击页面中的按钮时，我需要知道是否选择了单选按钮。这是按钮的客户端事件单击事件，因为我必须显示一个确认消息框，即如果用户单击“是”，那么我必须执行剩余的操作。如果选择了 userControl 中的单选按钮，您能否指导我找到最好的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:25:53.597

如果页面需要知道，给 UC 添加一个公共属性：

```
public bool IsRadioSelected { get { return Radio.Checked; } } 
```

您还可以通过将 AutoPostBack 属性设置为 true 来让 RadioButton 回发更改检查。

编辑：对于客户端脚本，您还可以向 RadioButton 添加公共属性：

```
public string RadioClientID { get { return Radio.ClientID; } } 
```

然后在javascript中，你可以这样做：

```
var radioButtonObject = document.getElementById('<%= RadioClientID %>'); 
if (radioButtonObject.checked) { /* do this */} else { /* do that*/ } 
```

问题是客户端脚本中单选按钮的 ID 看起来像“ct100_Body_somecontainer_RadioID”，不能轻易直接引用。上面的方法更安全。

# sql - SQL select：一个表中的随机顺序值用于另一个表中的每一行

> ID：11347496
> 
> 赞同：3
> 
> 时间：2012-07-05T15:23:17.113
> 
> 标签：sql, postgresql, stored-procedures, stored-functions

我的数据库中有两个表：

**(1) 短语：**

```
t_phrase
========
I like
They prefer
...
Somebody else wants 
```

和

**(2) 地点：**

```
n_id   t_place
====   =======
1      London
2      Paris
...
N      New York 
```

表`PHRASES`的行数至少与`PLACES`. 我需要以这样一种方式加入这两个表，以便为每个表选择所有`place`s `phrase`- 但短语需要随机分布在不同的地方。整个`places`表并不太大：可能大约有 3-4 千行，但是上面会有一个附加`WHERE`子句，最多将输出限制为大约 200 个位置。

理想情况下，我希望它包含在一个 SQL 语句中，但到目前为止，我还无法理解这一点。因此，第二个选项是返回一行的存储函数`(int, varchar, varchar)`。为此，我正在考虑以下内容：

1.  以随机顺序将所有短语选择到 varchar 数组中
2.  循环遍历一次取一个的位置并将其与数组中的下一个短语一起返回

不知何故，这在我看来效率很低，但我想不出更好的办法。

你能提出更好的主意吗？或者，甚至更好，一个语句 SQL，也许？

提前致谢。

**编辑：**请注意，这些短语不应在结果集中重复。短语的数量总是至少与地方的数量一样多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T23:24:19.480

```
WITH p AS (
    SELECT place, row_number() OVER () AS rn
    FROM   t_place
    WHERE  <some condition>
    )
    , ph AS (
    SELECT phrase, row_number() OVER (ORDER BY random()) AS rn
    FROM   t_phrase
    )
SELECT ph.phrase, p.place
FROM   p
JOIN   ph USING (rn); 
```

它不会再随机化了，如果你对两个表都施加真正的随机顺序，它只会变得更慢。我对短语施加随机顺序，因为：

> 短语的数量总是至少与地方的数量一样多。

它需要用更大的集合来完成，以免一些非随机部分可能被切断。另一方面，对于较小的集合（位置），*任何*没有间隙的数字序列都是好的，所以我选择最快的方法。

我的示例使用 CTE，但也可以使用子查询来完成。[CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)和[窗口函数](http://www.postgresql.org/docs/current/interactive/functions-window.html)都需要 PostgreSQL 8.4 或更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:32:46.040

我认为以下将起作用：

```
select (select phrase from phrases order by random() limit 1),
       place
from places 
```

应为每一行调用选择中的选择，因此每次都应返回不同的值。

如果您只想随机排列短语和地点，可以使用 windows 功能：

```
select ph.phrase, p.place
from (select place, row_number() over (order by place) as seqnum
      from places p
     ) p join
     (select phrase, row_number() over (order by random()) as seqnum
      from phrases
     ) ph 
     on p.seqnum = ph.seqnum 
```

这会按地点（或任何领域都可以）对地点进行排序。它随机化短语，并加入结果行号。

# python - Tkinter.Tk() 和线程

> ID：11347499
> 
> 赞同：0
> 
> 时间：2012-07-05T15:23:21.337
> 
> 标签：python, user-interface, thread-safety, tkinter, python-multithreading

Tkinter 和线程有一个有趣的问题：我有一个基于 Tkinter 的 GUI 和一些与 mainloop 一起执行的代码。如果我只做一次，它就像魅力一样。但是如果我这样做两次，Tkinter.Tk() 会阻塞两个线程：GUI 和 MainThread。

这是代码（受[另一个 Tkinter vs threading 主题](https://stackoverflow.com/questions/459083/how-do-you-run-your-own-code-alongside-tkinters-event-loop)的启发）：

```
import Tkinter 
import threading
import logging

logging.basicConfig(level=logging.DEBUG, format="%(asctime)s  %(levelname)s: %(message)s")

def gui():
    logging.info("Starting GUI")
    root = Tkinter.Tk() 
    logging.info("Setup GUI")
    root.after(500, root.destroy)
    root.mainloop()
    logging.info("Mainloop is over")

def start_gui_thread():
    gui_thread =  threading.Thread(None, gui, None)
    gui_thread.setDaemon(True)
    gui_thread.start()    
    return gui_thread

def test():
    gui_thread = start_gui_thread()    
    logging.info("Do something alongside gui")

    logging.info("Wait for gui to terminate")
    gui_thread.join()
    logging.info("thread terminated")

logging.info("--------- 1 ---------")
test()
logging.info("--------- 2 ---------")
test() 
```

结果：winxp + python 2.7.1（默认安装）

```
INFO: --------- 1 ---------
INFO: Do something alongside gui
INFO: Starting GUI
INFO: Wait for gui to terminate
INFO: Setup GUI
INFO: Mainloop is over
INFO: thread terminated
INFO: --------- 2 ---------
INFO: Starting GUI
INFO: Do something alongside gui 
```

OS X 10.6.7 + python 2.7.1 的 UPD 结果

```
MacBook-Pro:~ igann$ python test.py 
2012-07-05 21:01:52,939  INFO: --------- 1 ---------
2012-07-05 21:01:52,940  INFO: Starting GUI
2012-07-05 21:01:54,835  INFO: Do something alongside gui
2012-07-05 21:01:54,835  INFO: Wait for gui to terminate
2012-07-05 21:01:54,835  INFO: Setup GUI
2012-07-05 21:01:55,337  INFO: Mainloop is over
2012-07-05 21:01:55,339  INFO: thread terminated
2012-07-05 21:01:55,339  INFO: --------- 2 ---------
2012-07-05 21:01:55,339  INFO: Starting GUI
2012-07-05 21:01:55,366  INFO: Do something alongside gui
2012-07-05 21:01:55,366  INFO: Wait for gui to terminate
2012-07-05 21:01:55,367  INFO: Setup GUI
Tcl_WaitForEvent: CFRunLoop finished
Abort trap
MacBook-Pro:~ igann$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:25:00.627

它对我来说很好（OS X 10.7，Python 2.7.1），所以它可能与您的安装有关：

```
pu@pumbair:~/Downloads$ python test.py 
2012-07-05 19:22:19,673  INFO: --------- 1 ---------
2012-07-05 19:22:19,673  INFO: Starting GUI
2012-07-05 19:22:19,674  INFO: Do something alongside guy
2012-07-05 19:22:19,918  INFO: Wait for gui to terminate
2012-07-05 19:22:19,918  INFO: Setup GUI
2012-07-05 19:22:20,422  INFO: Mainloop is over
2012-07-05 19:22:20,424  INFO: thread terminated
2012-07-05 19:22:20,424  INFO: --------- 2 ---------
2012-07-05 19:22:20,425  INFO: Starting GUI
2012-07-05 19:22:20,459  INFO: Do something alongside gui
2012-07-05 19:22:20,459  INFO: Setup GUI
2012-07-05 19:22:20,459  INFO: Wait for gui to terminate
2012-07-05 19:22:20,962  INFO: Mainloop is over
2012-07-05 19:22:20,965  INFO: thread terminated

pu@pumbair:~/Downloads$ python
Python 2.7.1 (r271:86832, Jun 25 2011, 05:09:01) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

但是当然，操作并不总是以相同的顺序执行（与上面的比较）：

```
pu@pumbair:~/Downloads$ python test.py 
2012-07-05 19:27:17,827  INFO: --------- 1 ---------
2012-07-05 19:27:17,827  INFO: Starting GUI
2012-07-05 19:27:17,827  INFO: Do something alongside gui
2012-07-05 19:27:17,937  INFO: Setup GUI
2012-07-05 19:27:17,938  INFO: Wait for gui to terminate
2012-07-05 19:27:18,440  INFO: Mainloop is over
2012-07-05 19:27:18,442  INFO: thread terminated
2012-07-05 19:27:18,443  INFO: --------- 2 ---------
2012-07-05 19:27:18,443  INFO: Starting GUI
2012-07-05 19:27:18,478  INFO: Do something alongside gui
2012-07-05 19:27:18,478  INFO: Setup GUI
2012-07-05 19:27:18,479  INFO: Wait for gui to terminate
2012-07-05 19:27:18,981  INFO: Mainloop is over
2012-07-05 19:27:18,982  INFO: thread terminated 
```

在带有 Python 2.6.1 的 10.6.8 上，它也可以工作，但会出现奇怪的消息：

```
symacbook:Downloads putest$ python test.py 
2012-07-05 21:33:49,844  INFO: --------- 1 ---------
2012-07-05 21:33:49,844  INFO: Starting GUI
2012-07-05 21:33:49,844  INFO: Do something alongside gui
2012-07-05 21:33:52,356  INFO: Wait for gui to terminate
2012-07-05 21:33:52,356  INFO: Setup GUI
2012-07-05 21:33:52,858  INFO: Mainloop is over
2012-07-05 21:33:52,859  INFO: thread terminated
2012-07-05 21:33:52,860  INFO: --------- 2 ---------
2012-07-05 21:33:52,860  INFO: Starting GUI
2012-07-05 21:33:52,892  INFO: Setup GUI
2012-07-05 21:33:52,892  INFO: Do something alongside gui
2012-07-05 21:33:52,894  INFO: Wait for gui to terminate
2012-07-05 21:33:52.894 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d9d90 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.896 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d51e0 of class NSFont autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.897 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x7fff70737588 of class NSCFString autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.897 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101233b40 of class _NSThemeCloseWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.898 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e0ef0 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.898 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d51e0 of class NSFont autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.899 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x7fff70737588 of class NSCFString autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.899 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1170 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.899 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x10120e9c0 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.900 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d51e0 of class NSFont autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.900 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x7fff70737588 of class NSCFString autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.901 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1710 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.901 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e18e0 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.902 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1012343e0 of class NSTrackingArea autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.902 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101234010 of class NSTrackingArea autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.903 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1910 of class NSView autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.904 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d3550 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.905 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1910 of class NSView autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.905 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101234840 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.906 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1d90 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.906 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101234870 of class __NSFastEnumerationEnumerator autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.907 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101233b40 of class _NSThemeCloseWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.907 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101233b40 of class _NSThemeCloseWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.908 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1710 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.908 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1710 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.908 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1170 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.909 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1170 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.909 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e22e0 of class NSTrackingArea autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.910 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e24d0 of class NSConcreteAttributedString autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.911 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x7fff70737588 of class NSCFString autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.911 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d51e0 of class NSFont autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.911 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002d91f0 of class NSFont autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.912 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x7fff70737588 of class NSCFString autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.912 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e28b0 of class NSTrackingArea autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.913 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e3ab0 of class NSConcreteMapTable autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.914 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e3e30 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.915 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1dc0 of class NSObject autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.915 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e4120 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.916 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101234a60 of class NSMenuItem autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.916 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002ac2e0 of class NSCFNumber autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.916 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e4180 of class NSCFDictionary autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.917 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x10120e770 of class NSCFNumber autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.917 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1012031d0 of class NSCFDictionary autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.918 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101233b40 of class _NSThemeCloseWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.919 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101233b40 of class _NSThemeCloseWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.919 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1710 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.919 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1710 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.920 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1170 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:52.920 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e1170 of class _NSThemeWidget autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.393 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101236910 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.393 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x10120e770 of class NSCFNumber autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.394 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101236ce0 of class NSCFDictionary autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.394 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002e24b0 of class NSCFString autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.395 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x1002ac2e0 of class NSCFNumber autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.395 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101236d20 of class NSCFDictionary autoreleased with no pool in place - just leaking
2012-07-05 21:33:53.396 Python[1281:3407] *** __NSAutoreleaseNoPool(): Object 0x101236e70 of class NSCFArray autoreleased with no pool in place - just leaking
2012-07-05 21:33:53,398  INFO: Mainloop is over
2012-07-05 21:33:53,400  INFO: thread terminated 
```

# c# - 如何让 .net 3.5 根据 RSS 提要自动生成 JSON 数据？

> ID：11347503
> 
> 赞同：1
> 
> 时间：2012-07-05T15:23:32.873
> 
> 标签：c#, json, rss, c#-3.0, asp.net-3.5

目前，我正在使用以下代码生成 xml 和 json 数据：

```
public class App
{
    public string app_name;
    public string app_path;

    public App(string m_app_name, string m_app_path)
    {
        app_name = m_app_name;
        app_path = m_app_path;
    }

    public App() { }
}

[ScriptService]
public class Apps : WebService {
    List<App> App = new List<App>();

    SqlConnection connection;
    SqlCommand command;
    SqlDataReader reader;

    [WebMethod()]
    public List<App> GetUserApps()
    {
        var apps = new List<App>();

        using (connection = new SqlConnection(ConfigurationManager.AppSettings["connString"]))
        {

                using (command = new SqlCommand(@"some query here", connection))
                {
                    connection.Open();
                    using (reader = command.ExecuteReader())
                    {
                        int AppNameIndex = reader.GetOrdinal("application_name");
                        int AppPathIndex = reader.GetOrdinal("application_path");

                        while (reader.Read())
                        {
                            apps.Add(new App(reader.GetString(AppNameIndex), reader.GetString(AppPathIndex)));
                        }
                    }
                }

        }

        return apps;
    }
} 
```

如果我随后在 javascript 中使用 请求这个`application/json; charset=utf-8`，我会自动获取 json 数据。

我的问题是我需要从外部 RSS 提要而不是本地数据库获取数据，并将其转换为 json 数据，这样我就可以使用 javascript 以同样的方式调用它。

任何人都知道如何`http://www.hotukdeals.com/rss/hot`使用与上述类似的代码来捕获 RSS 提要？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T22:01:30.667

添加对 System.ServiceModel.Web 的引用并使用以下代码：

```
 [WebMethod()]     
    public List<Deal> GetDeals()
    {
        var deals = new List<Deal>();

        XmlReader xr = XmlReader.Create("http://www.hotukdeals.com/rss/hot");
        SyndicationFeed feed = SyndicationFeed.Load(xr);

        foreach (var item in feed.Items)
        {
            deals.Add(new Deal { Title = item.Title.Text, Summary = item.Summary.Text });
        }

        return deals;
    } 
```

将上面的 Deal 类替换为您的应用所需的任何类，并添加一些错误处理:)

有关详细信息，请查看[SyndicationFeed](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed%28v=vs.90%29.aspx)文档。

* * *

要读取`dc:date`属性，请添加

```
using System.Xml.Linq; 
```

然后在 foreach 循环中添加它（转换第一个日期）

```
 var dates = item.ElementExtensions.Where(x => x.OuterName == "date");

        if(dates.Count() > 0) 
        {
            var element = dates.First().GetObject<XElement>();
            var d = DateTime.Parse(element.Value);
        } 
```

我在这篇文章中找到了它：[Reading non-standard elements in a SyndicationItem with SyndicationFeed](https://stackoverflow.com/q/319591/1045728)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T07:13:05.843

Web 提要是一种数据格式，用于为用户提供经常更新的内容。假设您正在设计任何网站的主页，并且想要显示来自某个流行或有用网站的提要。在这种情况下，以下示例可能会有所帮助。

在此示例中，使用的提要显示在列表视图中。但是您可以使用任何控件并相应地显示提要。

listview 的脚本是：

```
<div>
    <asp:ListView ID="FeedList" runat="server" 
            onitemdatabound="FeedList_ItemDataBound" DataKeyNames="Title,Link" >
        <LayoutTemplate > 
           <div runat="server" id="ItemPlaceHolder">
           </div>
        </LayoutTemplate>
        <ItemTemplate>
            <asp:Label ID="title" runat="server"></asp:Label>
            <br />
            <asp:HyperLink ID="link" runat="server"></asp:HyperLink>
            <br />
        </ItemTemplate>
    </asp:ListView>
</div> 
```

该示例的文件背后的代码是：

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Xml;
using System.Data;
using System.ServiceModel.Syndication; // used for feed implementation

public partial class FeedConsume : System.Web.UI.Page
{
    /// <summary>
    /// databind function of listview is called from this function.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void Page_Load(object sender, EventArgs e)
    {
        // See if feed data is in the cache
        IEnumerable<SyndicationItem> items = Cache["Feeds"] as IEnumerable<SyndicationItem>;
        if (items == null)
        {
            // If not present in cache then get it from sender's website
            try
            {
                SyndicationFeed sfFeed = SyndicationFeed.Load(XmlReader.Create("FEED URL OF senders website"));

                // every website has a static url which contains their feed and we can get the feed from that url. 
                items = sfFeed.Items;
                }
            catch
            {
                items = new List<SyndicationItem>();
            }
            // Add the items to the cache
            Cache.Insert("Feeds", items, null, DateTime.Now.AddHours(1.0),TimeSpan.Zero);
        }

        // Creating the datatable to bind it to the listview. This datatable will contain all the feeds from the senders website.
        DataTable dtItems = new DataTable();
        dtItems.Columns.Add("Title", typeof(string));
        dtItems.Columns.Add("Link", typeof(string));
        foreach (SyndicationItem synItem in items)
        {
            dtItems.Rows.Add(synItem.Title.Text, synItem.Links[0].Uri.ToString());
        }
        FeedList.DataSource = dtItems;
        FeedList.DataBind(); 
    }

    /// <summary>
    /// Controls in listView are assigned proper value
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void FeedList_ItemDataBound(object sender, ListViewItemEventArgs e)
    {
        ListViewDataItem lvDataItem = (ListViewDataItem)e.Item;
        DataRowView drvItem = (DataRowView)lvDataItem.DataItem;
        Label title = (Label)e.Item.FindControl("title");
        title.Text = drvItem["Title"].ToString();
        HyperLink link = (HyperLink)e.Item.FindControl("link");
        link.Text = drvItem["Link"].ToString();
        link.NavigateUrl = drvItem["Link"].ToString();
    }
} 
```

注意：我们应该始终关心从其他网站获得的数据。

# html - 如何在 CSS3 中制作与此类似的对话框？

> ID：11347504
> 
> 赞同：0
> 
> 时间：2012-07-05T15:23:42.513
> 
> 标签：html, css

我想在 css3 中制作一个与此类似的对话框（减去文本框和按钮，并忘记密码链接）： ![在此处输入图像描述](../Images/1f87588f4f60911aefefd53633f08535.png)

我想我可以做类似的事情：

```
<div id="mydialoguebox">
<h1>Authorization Required</h1>
<div id="text">
Please review your account before continuing.
<div>
</div> 
```

我遇到的问题是 div 的顶部和 h1 标签之间似乎总是存在间隙。我也不确定如何用 x 添加“关闭”图像。将所需的授权和图像推入自己的 div 会更好吗？我正在寻找没有 JQuery UI 或任何 javascript 的最佳方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:37:40.693

用小提琴：

[http://jsfiddle.net/insertusernamehere/t6f5v/](http://jsfiddle.net/insertusernamehere/t6f5v/)

这是我关于如何构建它的基本想法。它需要进一步改进，但目前，您可以从它开始。

CSS：

```
<style>

    div.box {
        width:          400px;
        height:         200px;
        margin:         20px;
        border:         1px solid #ccc;
        border-radius:  6px;
    }

    div.box > header {
        height:         30px;
        padding:        10px;
        background:     #777;
        color:          #333;
    }
    div.box > header > h1 {
        float:          left;
        font-size:      14px;
        font-weight:    normal;
    }
    div.box > header > a {
        display:        inline-block;
        float:          right;
        width:          11px;
        height:         11px;
        margin-top:     10px;
        background:     url(http://www.geocaching.com/images/stockholm/mini/close.gif) no-repeat 0 0;
    }

    div.box > section {
        padding:        10px;
    }
    div.box > section form, div.box > section fieldset {
        margin:         0;
        padding:        0;
        border:         0;
    }

</style> 
```

HTML

```
<div class="box">
    <header>
        <h1>Authorisation Required</h1>
        <a href=""></a>
    </header>
    <section>
        <p>Please verify your …
        <form>
            <fieldset>
                <label>Username:</label>
                <input type="text">
            </fieldset>
        </form>
    </section>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:27:48.603

您可以使用一些 div - 将它们一个接一个地放置。有一种颜色，另一种颜色。然后你可以使用一些花哨的 css 边框半径样式。

[http://border-radius.com/](http://border-radius.com/)

# python - 将 Python 数据结构输出到 reStructuredText 有哪些方法

> ID：11347505
> 
> 赞同：8
> 
> 时间：2012-07-05T15:23:48.027
> 
> 标签：python, restructuredtext

我有一个 Python 中的元组列表，我想将其输出到 reStructuredText 中的表中。

docutils库对将reStructuredText转换为其他格式有很好的支持，但我想直接从内存中的数据结构写入reStructuredText。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-03-04T13:36:10.770

查看[表格](https://pypi.python.org/pypi/tabulate)包。它可以通过以下方式输出 RST 格式：

```
print tabulate(table, headers, tablefmt="rst") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-21T22:44:27.973

```
>> print make_table([['Name', 'Favorite Food', 'Favorite Subject'],
                     ['Joe', 'Hamburgers', 'Cars'],
                     ['Jill', 'Salads', 'American Idol'],
                     ['Sally', 'Tofu', 'Math']])

+------------------+------------------+------------------+
| Name             | Favorite Food    | Favorite Subject |
+==================+==================+==================+
| Joe              | Hamburgers       | Cars             |
+------------------+------------------+------------------+
| Jill             | Salads           | American Idol    |
+------------------+------------------+------------------+
| Sally            | Tofu             | Math             |
+------------------+------------------+------------------+ 
```

这是我用于快速和肮脏的 reStructuredText 表的代码：

```
def make_table(grid):
    cell_width = 2 + max(reduce(lambda x,y: x+y, [[len(item) for item in row] for row in grid], []))
    num_cols = len(grid[0])
    rst = table_div(num_cols, cell_width, 0)
    header_flag = 1
    for row in grid:
        rst = rst + '| ' + '| '.join([normalize_cell(x, cell_width-1) for x in row]) + '|\n'
        rst = rst + table_div(num_cols, cell_width, header_flag)
        header_flag = 0
    return rst

def table_div(num_cols, col_width, header_flag):
    if header_flag == 1:
        return num_cols*('+' + (col_width)*'=') + '+\n'
    else:
        return num_cols*('+' + (col_width)*'-') + '+\n'

def normalize_cell(string, length):
    return string + ((length - len(string)) * ' ') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-05T18:49:11.287

我不知道有任何库可以从 python 数据结构输出 RST，但是自己格式化很容易。这是将 python 元组列表格式化为 RST 表的示例：

```
>>> data = [('hey', 'stuff', '3'),
            ('table', 'row', 'something'),
            ('xy', 'z', 'abc')]
>>> numcolumns = len(data[0])
>>> colsizes = [max(len(r[i]) for r in data) for i in range(numcolumns)]
>>> formatter = ' '.join('{:<%d}' % c for c in colsizes)
>>> rowsformatted = [formatter.format(*row) for row in data]
>>> header = formatter.format(*['=' * c for c in colsizes])
>>> output = header + '\n' + '\n'.join(rowsformatted) + '\n' + header
>>> print output
===== ===== =========
hey   stuff 3        
table row   something
xy    z     abc      
===== ===== ========= 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-20T01:14:53.573

@cieplak 的回答很棒。我对其进行了一些改进，以便独立调整列的大小

```
 print make_table( [      ['Name', 'Favorite Food', 'Favorite Subject'],
                             ['Joe', 'Hamburgrs', 'I like things with really long names'],
                             ['Jill', 'Salads', 'American Idol'],
                             ['Sally', 'Tofu', 'Math']])

    ===== ============= ==================================== 
    Name  Favorite Food Favorite Subject                     
    ===== ============= ==================================== 
    Joe   Hamburgrs     I like things with really long names 
    ----- ------------- ------------------------------------ 
    Jill  Salads        American Idol                        
    ----- ------------- ------------------------------------ 
    Sally Tofu          Math                                 
    ===== ============= ==================================== 
```

这是代码

```
def make_table(grid):
    max_cols = [max(out) for out in map(list, zip(*[[len(item) for item in row] for row in grid]))]
    rst = table_div(max_cols, 1)

    for i, row in enumerate(grid):
        header_flag = False
        if i == 0 or i == len(grid)-1: header_flag = True
        rst += normalize_row(row,max_cols)
        rst += table_div(max_cols, header_flag )
    return rst

def table_div(max_cols, header_flag=1):
    out = ""
    if header_flag == 1:
        style = "="
    else:
        style = "-"

    for max_col in max_cols:
        out += max_col * style + " "

    out += "\n"
    return out

def normalize_row(row, max_cols):
    r = ""
    for i, max_col in enumerate(max_cols):
        r += row[i] + (max_col  - len(row[i]) + 1) * " "

    return r + "\n" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-25T15:55:42.603

您可以选择从 Python 转储到 CSV，然后使用 RST 的 csv-table 功能，如[http://docutils.sourceforge.net/docs/ref/rst/directives.html#csv-table](http://docutils.sourceforge.net/docs/ref/rst/directives.html#csv-table) 它有：文件：指令简单地包含一个带有数据的 csv 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-04T02:08:23.657

这是@cieplak 的代码，添加了对字符串和多行支持的转换。也许它会对某人有用。

```
def make_table(grid):
    cell_width = 2 + max(reduce(lambda x,y: x+y, [[max(map(len, str(item).split('\n'))) for item in row] for row in grid], []))
    num_cols = len(grid[0])
    rst = table_div(num_cols, cell_width, 0)
    header_flag = 1
    for row in grid:
        split_row = [str(cell).split('\n') for cell in row]
        lines_remaining = 1

        while lines_remaining>0:
            normalized_cells = []
            lines_remaining = 0
            for cell in split_row:
                lines_remaining += len(cell)

                if len(cell) > 0:
                    normalized_cell = normalize_cell(str(cell.pop(0)), cell_width - 1)
                else:
                    normalized_cell = normalize_cell('', cell_width - 1)

                normalized_cells.append(normalized_cell)

            rst = rst + '| ' + '| '.join(normalized_cells) + '|\n'

        rst = rst + table_div(num_cols, cell_width, header_flag)
        header_flag = 0
    return rst 
```

# javascript - 查找在对象上调用了哪个方法

> ID：11347510
> 
> 赞同：1
> 
> 时间：2012-07-05T15:24:07.223
> 
> 标签：javascript

**是否可以找到在对象上调用了哪个方法而不将它放在对象的主体中？**

我是说 ：

```
 function foo() {
   if(! (this instanceof foo) ) return new foo();
   alert(this.find_which_method_was_called()); // output 'myMethod'
 }

 foo().myMethod(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:35:37.563

`myMethod()`在构造函数返回后调用`foo()`，所以你不可能知道它是否在构造函数中被调用。

但是，您可以将对象包装在代理中，并将所有调用函数的名称保存在数组中：

```
function Proxy(object) {

    this.calledFunctions = [];

    for (var name in object) {
        if (typeof object[name] != 'function') {
            continue;
        }
        this[name] = (function (name, fun) {
            return function() {
                this.calledFunctions.push(name);
                return fun.apply(object, arguments);
            };
        }(name, object[name]));
    }
} 
```

现在你可以这样做：

```
var f = new Proxy(new foo());
f.myMethod();
alert(f.calledFunctions); 
```

# wcf - “此服务的安全设置需要 Windows 身份验证”客户端证书 WCF 项目的 IIS 错误

> ID：11347512
> 
> 赞同：1
> 
> 时间：2012-07-05T15:24:11.033
> 
> 标签：wcf, iis-7, wcf-security

我已经在互联网（和 SO）上搜索了解决方案。截至今天，RHS 中出现的所有问题都没有解决我的问题，所以就这样吧。

**TLDR：**我正在尝试构建一个需要客户端证书的 WCF 服务，但我遇到了这个错误：

> 此服务的安全设置需要 Windows 身份验证，但托管此服务的 IIS 应用程序未启用它。

我在让服务识别我为测试生成的自签名证书时遇到了几个问题。它现在似乎正在工作，因为没有证书的客户端向我显示 403（禁止）的 IIS 错误，而不是这个异常。

我的服务 web.config 的相关片段：

```
<wsHttpBinding>
    <binding name="clientCertificateBinding">
        <security mode="Message">
            <message clientCredentialType="Certificate" />
        </security>
    </binding>
</wsHttpBinding> 
```

我定义了两个端点：一个用于“mex”（尝试删除它，并不能解决我的问题），一个用于实际服务。服务绑定`binding="wsHttpBinding" bindingConfiguration="clientCertificateBinding"`用作规范。

后来，我告诉我的行为使用服务证书：

```
<behavior name="AwesomeBehaviour">
    <serviceMetadata httpsGetEnabled="true"/>
    <serviceCredentials>
        <serviceCertificate
        storeLocation="LocalMachine"
        storeName="My"
        findValue = 'CN=...' />
    </serviceCredentials>
    <serviceDebug includeExceptionDetailInFaults="true"/>
</behavior> 
```

此外，IIS 设置为**Rquire SSL 并需要客户端证书。**不仅接受它们，而且要求它们。

我已经尝试（正如一些人建议的那样）将安全模式从 更改`Transport`为`Message`and `TransportWithMessageCredential`; 这没有任何作用。

还有[这个线程](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/021babc6-2009-4ed9-81f4-ac48cc300c94/)讨论 NTLM 和协商作为传输凭证类型。这不能解决我的问题。

还有[这篇 KB 文章](http://support.microsoft.com/kb/215383)讨论了`cscript.exe`. 我安装了兼容性工具并添加了 NTLM 身份验证提供程序，但无济于事。

我不确定我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:59:28.833

啊。解决方案有两个：

*   将配置添加到我的安全标签中`<transport clientCredentialType="Certificate" />`
*   移除`mex`绑定

然后一切正常！\o/

# c# - 棱镜 4 API 文档

> ID：11347513
> 
> 赞同：0
> 
> 时间：2012-07-05T15:24:12.777
> 
> 标签：c#, prism

我正在寻找 Prism 框架（prism 4）的在线 API 文档。它 A) 存在吗？B）如果是这样，它在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:37:15.700

*   **桌面类库**
    [http://msdn.microsoft.com/en-us/library/microsoft.practices.prism(v=pandp.40)](http://msdn.microsoft.com/en-us/library/microsoft.practices.prism%28v=pandp.40%29)
*   **电话**
    [http://msdn.microsoft.com/en-us/library/jj569715(v=pandp.39).aspx](http://msdn.microsoft.com/en-us/library/jj569715%28v=pandp.39%29.aspx)
*   **Silverlight**
    [http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.mefextensions.modularity(v=pandp.38)](http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.mefextensions.modularity%28v=pandp.38%29)

全部在[Prism 4.1 - Microsoft Prism 开发人员指南](http://msdn.microsoft.com/en-us/library/gg406140)（导航上的最后 3 个链接）下。

[经过审查，与Prism 2](http://msdn.microsoft.com/en-us/library/ff921203)文档相比，所有 API 文档看起来都有些不完整，但我相信这些是可用的 API 文档的唯一来源。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-05T15:25:36.083

[http://compositewpf.codeplex.com/releases/view/55580](http://compositewpf.codeplex.com/releases/view/55580)

# paypal - PayPal Permissions API GetAccessToken API 调用不起作用

> ID：11347517
> 
> 赞同：0
> 
> 时间：2012-07-05T15:24:36.833
> 
> 标签：paypal

API调用返回的错误如下：

```
{error(0).message=Internal+Error, error(0).errorId=520002, error(0).subdomain=Application, error(0).category=Application, responseEnvelope.correlationId=46cac792dc1a4, error(0).domain=PLATFORM, responseEnvelope.ack=Failure, error(0).severity=Error} 
```

我该如何调试呢？错误中没有任何内容可以帮助我调试它，一切似乎都很好，代码都是针对沙盒的，而且似乎没有任何可疑之处。任何有关调试的建议都会很棒！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T03:20:36.240

PayPal 需要更好的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T11:43:12.763

请发布代码，以便它帮助我/其他人了解问题所在..

确保您使用的是正确的 URL。

对于沙盒，GetAccessToken URL 是[https://svcs.sandbox.paypal.com/Permissions/GetAccessToken](https://svcs.sandbox.paypal.com/Permissions/GetAccessToken)

调用“GetAccessToken”URL 时需要传递以下参数

*   requestEnvelope.errorLanguage
*   令牌（请求令牌）
*   验证者（验证码）

# android - 如何在 onClick 适配器上保持 DialogFragment 可见？

> ID：11347521
> 
> 赞同：1
> 
> 时间：2012-07-05T15:24:40.500
> 
> 标签：android

我有一个`DialogFragment`与之关联`SimpleAdapter`的监听点击。当我单击解雇本身中`ListView`的任何项目时。`DialogFragment`如何保持可见？

```
public Dialog onCreateDialog(Bundle savedInstanceState) {
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(getResources().getString(R.string.choose_file_for_import));
        mAdapter = new MAdapter(getActivity(), R.id.file_explorer_tv_filename, itemsList);

        builder.setAdapter(mAdapter, new DialogInterface.OnClickListener() {

            @Override
            public void onClick(DialogInterface dialogInterface, int position) {
                File file = new File(pathList.get(position));

                        getDir(pathList.get(position));
                        mAdapter.notifyDataSetChanged();
    }
    return builder.create();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T16:42:01.353

您有两个选择：
不要使用 AlertDialog.Builder 或设置`OnClickListener`after `builder.create()`。

## 设置监听器后`builder.create()`

将适配器设置`OnClickListener`为`null`

```
builder.setAdapter(mAdapter, null); 
```

在 builder.create() 分配之后`OnItemClickListener`。

```
AlertDialog dialog = builder.create();
dialog.getListView().setOnItemClickListener(...); 
```

我必须承认我没有测试过它，我只是查看了 Android 资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T11:38:08.473

您可以尝试使用[`setSingleChoiceItems()`](http://developer.android.com/reference/android/app/AlertDialog.Builder.html#setSingleChoiceItems%28android.widget.ListAdapter,%20int,%20android.content.DialogInterface.OnClickListener%29)而不是`setAdapter()`. 从文件：

> *   `adapter`
>     
>     
>     
>     ListAdapter 提供项目列表
>     
>     
> *   `checkedItem`
>     
>     
>     
>     指定检查哪个项目。如果 -1 则不检查任何项目。
>     
>     
> *   `listener`
>     
>     
>     
>     单击列表中的项目时通知。单击项目时不会关闭对话框。只有在单击按钮时才会关闭它，如果没有提供按钮，则由用户决定关闭对话框。

所以它应该按照你想要的方式工作，只需使用 -1 作为`checkedItem`参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T07:14:23.740

您需要覆盖 addapter 的 getView 并侦听 View onClick 侦听器，并且在此侦听器内部返回 false，这样它会告诉系统没有人处理此触摸事件。

看看这个[样本](http://www.vogella.com/articles/AndroidListView/article.html)。

# batch-file - 批处理文件循环在 if 语句后结束

> ID：11347524
> 
> 赞同：0
> 
> 时间：2012-07-05T15:24:44.943
> 
> 标签：batch-file

我正在尝试创建一个批处理文件，该文件根据变量在循环中运行其他批处理文件，但是在第一个批处理文件执行后，“主”批处理文件也结束了。我错过了什么？

```
:loop
if %variable% == 5 (bat1.bat) else (bat2.bat) 
goto loop 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:33:50.527

这是因为您正在将控制权转移到另一个批处理文件，这意味着它永远不会回到“主”文件。

你需要`call`像这样使用

```
:loop
if %variable% == 5 (call bat1.bat) else (call bat2.bat) 
goto loop 
```

它将在它调用的文件完成后将控制权返回给主批处理文件，以便它可以继续循环。

希望这可以帮助

# c - Matlab MEX C++ 不同文件夹中的两个同名文件

> ID：11347527
> 
> 赞同：1
> 
> 时间：2012-07-05T15:24:49.927
> 
> 标签：c, matlab, mex

我正在尝试编译一些具有相同名称（fileA）但位于不同文件夹（文件夹 1 和文件夹 2）中的 C++ 文件，可以说：

```
folder1/fileA.cpp
folder1/fileB.cpp 
```

和

```
folder2/fileA.cpp
folder2/fileC.cpp 
```

这些文件包含不同的类。

但是`mex`会在同一文件夹中为 folder1/fileA.cpp 和 folder2/fileA.cpp 创建对象，因此当它尝试生成最终的 W32 文件时，一些类会丢失。

有没有办法告诉 mex 不要“展平”文件夹结构，然后不要用另一个 fileA.obj 覆盖一个 fileA.obj？

* * *

所有提出的解决方案最终都具有相同的基本思想：**准备我自己的编译过程**（即*Makefiles*或类似的）。*我*对这个解决方案的问题是它们对于 Linux、Windows、32 或 64 位不一样，......并且不容易维护。这就是为什么我更希望有一个基于`mex`但似乎不受支持的解决方案，所以......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:37:36.017

您可以手动指定输出目录：

```
mex folder1/filleA.cpp -output folder1/fileA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T13:20:50.960

如果您需要这种灵活性，您将需要遵循传统的基于 UNIX Makefile 的策略，即分别编译每个目标文件。

例如，对于每个源文件，您可以使用在 Oli 的答案中指定`mex -c`的`-output`目录选项来创建目标文件 - 然后是使用这些目标文件的输出函数的单个最终 mex。

我想不出任何其他方法来实现你想要的（只需调用一次 mex 函数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T16:15:25.603

您实际上可以在不运行 matlab 的情况下编译和构建 mex 文件。它背后的过程是一个正常的编译（创建目标文件并链接它们）。对于正常的编译，拥有相同名称的对象文件（在不同的目录中）是没有问题的。我同意 robince 的观点，即制作 makefile 可以帮助您实现所需的目标，但如果 makefile 不是您的一杯茶，那么只需一个简单的 shell/batch 脚本就可以完成一系列编译命令（见下文）。

您可能将几个文件作为参数提供给 mex。要了解 matlab 真正在做什么，您可以使用 -v 标志运行它

```
 mex -v folder1/file1.cpp folder1/file2.cpp 
```

查看出现在 Matlab 的命令窗口“-> gcc etc.”中的编译命令。您可以在命令提示符下运行它们。对于每个文件，Matlab 只需使用（相当）一些标志和包含路径调用编译器。如您所知，这会生成对象文件，最后，所有内容都链接在一起。此阶段失败，因为 matlab 调用编译器时未指定输出，因此默认情况下编译器将对象文件放在当前目录中。

为避免这种情况，您必须像这样指定输出文件（参见 -o 标志）：

```
 gcc -c MATLABFLAGS folder1/File.cpp -o folder1/File.o 
```

如果您有很多文件，那么 Makefile 会派上用场：

```
 %Folder/.o: %.c
     $(CC) -I$(MATINC)  $(CCFLAGS) -c $< 
```

最后，对于链接阶段，您必须输入对象文件的真实位置：

```
 gcc MATLAB_LINK_FLAGS -o Final_MexFile.mex* Folder1/File.o Folder2/File.o   etc... 
```

并且mex被编译。也许有一个 gcc 选项可以避免您可以放入 mexoptions 文件中的所有内容。我很高兴知道！否则，我建议使用 Makefile。我希望它有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T19:23:03.583

怎么样

```
mymex(list_of_files); 
```

mymex.m 是：

```
function mymex(list_of_files)
  for n = 1:length(list_of_files),
    mex list_of_files(n) -output % do some string manipulation on list_of_files(n) here to get the right output file location
  end
end 
```

# tableview - JavaFX TableView 复制到剪贴板

> ID：11347535
> 
> 赞同：13
> 
> 时间：2012-07-05T15:25:23.380
> 
> 标签：tableview, javafx-2

是否可以允许用户从 TableView 中选择行和复制？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-01T09:11:50.543

```
tableView.getSelectionModel().setCellSelectionEnabled(true);
tableView.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);

MenuItem item = new MenuItem("Copy");
item.setOnAction(new EventHandler<ActionEvent>() {
    @Override
    public void handle(ActionEvent event) {
        ObservableList<TablePosition> posList = tableView.getSelectionModel().getSelectedCells();
        int old_r = -1;
        StringBuilder clipboardString = new StringBuilder();
        for (TablePosition p : posList) {
            int r = p.getRow();
            int c = p.getColumn();
            Object cell = tableView.getColumns().get(c).getCellData(r);
            if (cell == null)
                cell = "";
            if (old_r == r)
                clipboardString.append('\t');
            else if (old_r != -1)
                clipboardString.append('\n');
            clipboardString.append(cell);
            old_r = r;
        }
        final ClipboardContent content = new ClipboardContent();
        content.putString(clipboardString.toString());
        Clipboard.getSystemClipboard().setContent(content);
    }
});
ContextMenu menu = new ContextMenu();
menu.getItems().add(item);
tableView.setContextMenu(menu); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-01-06T09:38:43.563

耶利弗的解决方案只复制选定单元格的内容，但显然只有明确点击的单元格才被认为是选定的。罗伯托的解决方案仅在表中包含的对象是可迭代的情况下才有效。这是一个通用解决方案，它从所有选定行的所有单元格中复制数据：

```
@SuppressWarnings("rawtypes")
public void copySelectionToClipboard(final TableView<?> table) {
    final Set<Integer> rows = new TreeSet<>();
    for (final TablePosition tablePosition : table.getSelectionModel().getSelectedCells()) {
        rows.add(tablePosition.getRow());
    }
    final StringBuilder strb = new StringBuilder();
    boolean firstRow = true;
    for (final Integer row : rows) {
        if (!firstRow) {
            strb.append('\n');
        }
        firstRow = false;
        boolean firstCol = true;
        for (final TableColumn<?, ?> column : table.getColumns()) {
            if (!firstCol) {
                strb.append('\t');
            }
            firstCol = false;
            final Object cellData = column.getCellData(row);
            strb.append(cellData == null ? "" : cellData.toString());
        }
    }
    final ClipboardContent clipboardContent = new ClipboardContent();
    clipboardContent.putString(strb.toString());
    Clipboard.getSystemClipboard().setContent(clipboardContent);
} 
```

要使用 Ctrl+C 启用复制，请添加

```
 final KeyCodeCombination keyCodeCopy = new KeyCodeCombination(KeyCode.C, KeyCombination.CONTROL_ANY);
    table.setOnKeyPressed(event -> {
        if (keyCodeCopy.match(event)) {
            copySelectionToClipboard(table);
        }
    }); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-05T18:50:58.087

我无法实现 Yelliver 的答案，它不会为我编译，但我找到了另一种非常清晰的方法来提取到剪贴板的 TableView 的多个选定数据，它如下所示

```
TableView tableView = new TableView();
tableView.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);
MenuItem item = new MenuItem("Copy");
    item.setOnAction(new EventHandler<ActionEvent>() {
        @Override
        public void handle(ActionEvent event) {

            ObservableList rowList = (ObservableList) tableView.getSelectionModel().getSelectedItems();

            StringBuilder clipboardString = new StringBuilder();

            for (Iterator it = rowList.iterator(); it.hasNext();) {
                ObservableList<Object> row = (ObservableList<Object>) it.next();

                for (Object cell : row) {
                    if (cell == null) {
                        cell = "";
                    }
                    clipboardString.append(cell);
                    clipboardString.append('\t');
                }
                clipboardString.append('\n');

            }
            final ClipboardContent content = new ClipboardContent();

            content.putString(clipboardString.toString());
            Clipboard.getSystemClipboard().setContent(content);
        }
    });
    ContextMenu menu = new ContextMenu();
    menu.getItems().add(item);
    tableView.setContextMenu(menu);
} 
```

希望它可以帮助你，或者任何试图轻松复制 TableView 数据的人

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-07T23:31:44.133

我不确定，但我想 javafx.scene.input.Clipboard 可以在这里为您提供帮助。

# java - 如何将文件发送到 eclipse java 插件中以便在部署插件后重用它们

> ID：11347536
> 
> 赞同：0
> 
> 时间：2012-07-05T15:25:31.107
> 
> 标签：java, eclipse, plugins

我正在开发一个使用外部 jar 和图像的 eclipse 插件。我想将它们发送到我的插件 jar 中，以便在 eclipse 中部署插件时我可以使用它们。我的问题是：我应该将这些外部文件放在我的插件项目中的什么位置，以及我应该如何引用它们才能访问它们。我已经尝试像这样引用我的文件（我的文件所在的文件夹是 CESSAOAuthInterceptors）： Bundle bundle = Platform.getBundle(Activator.PLUGIN_ID); 路径 path = new Path("CESSAOAuthInterceptors"); URL fileURL = FileLocator.find(bundle, path, null); 但是当插件安装在 eclipse 的 dropin 文件夹中时，我无法再访问我的目录了。

任何关于如何以我可以在安装插件的任何地方找到它的方式引用我的文件夹的建议都会非常有帮助，谢谢

扬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:48:03.847

查看 JavaCore.setClasspathVariable() 作为一种将变量名称与从插件安装目录（您可以从 Activator 查询）派生的路径值相关联的方法。然后，您可以在 Eclipse 类路径中使用该变量名来引用安装目录。

这种关联可以在您的 Activator 类的 startup() 方法中进行。

# python - 获取 SciPy 分位数以匹配 Stata xtile 函数

> ID：11347539
> 
> 赞同：2
> 
> 时间：2012-07-05T15:25:36.603
> 
> 标签：python, scipy, stata, quantile

我继承了一些旧的 Stata 代码 (Stata11)，它使用该`xtile`函数按分位数对向量中的观察值进行分类（在这种情况下，只是标准的 5 个五分位数，20%、40%、60%、80%、100%） .

我正在尝试在 Python 中复制一段代码，并且我正在使用 SciPy.stats.mstats 函数`mquantiles()`进行计算。

据我从 Stata 文档和在线搜索中可以看出，Stata`xtile`方法试图反转数据的经验 CDF，并使用 CDF 平坦的所有观察值的等加权平均值来制作切点。这似乎是对分位数进行分类的一种非常糟糕的方法，但事实就是如此，我相信在某些情况下这是正确的做法。

我的问题是如何`mquantiles()`产生同样的打破惯例。我注意到这个函数有两个参数，`alphap`并且`betap`（文档调用它们`alpha`，`beta`但是你需要额外的'p'才能让它工作，至少我这样做......如果我只使用'alpha'和' beta' 与 Python 2.7.1 和 SciPy 0.10.0）。但即使在 SciPy 文档中，我也看不出这些参数的组合是否会在平坦的 CDF 范围内产生平均值。

我看到了看起来像计算为这个范围的中位数或众数的选项，但不是平均值（也不清楚这些具有 alpha 和 beta 的 SciPy 中位数/众数选项是否被计算为*观测*值的中位数/众数或产生平坦 CDF 值的范围。）

任何有助于消除这些不同选项的歧义并找到一些帮助我在 Python 中重新创建 Stata 约定的文档都会很棒。请不要回答只是说“编写自己的分位数函数”。首先，这无助于我理解 Stata 或 SciPy 的约定，其次，鉴于这些数值库，编写我自己的分位数函数应该是最后的手段。我当然可以做到，但如果我需要，那就不好了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T05:17:27.453

scipy.stats.mquantiles 文档在某些地方很差且*错误*，现在已修复，因此可能会有所帮助... [http://docs.scipy.org/scipy/docs/scipy.stats.mstats_basic.mquantiles/](http://docs.scipy.org/scipy/docs/scipy.stats.mstats_basic.mquantiles/)。当您指出 alpha/beta、alphap/betap 差异时，该过程就开始了。谢谢你。

mquantiles 的实现遵循 R。

最大的区别在于 R 有 9 种离散类型，因为 scipy.stats.mquantiles 从 'alphap' 和 'betap' 计算 'm'，所以 scipy 具有连续范围的“类型”（因为没有更好的词）。

我承认我不了解所涉及的所有统计数据的来龙去脉，所以我决定进行蛮力评估。[我在http://www.biostat.sdu.dk/~biostat/StataReferenceManual/StataRef.pdf](http://www.biostat.sdu.dk/~biostat/StataReferenceManual/StataRef.pdf)找到了一个 xtile 示例，并且能够将结果与 alphap=0.5 和 betap=0.5（分段线性）相匹配。不是确定的，也不是详尽的，但我现在拥有的一切。

```
In [1]: import scipy.stats as st

In [9]: st.mstats.mquantiles([23,56,67,123,99,17],prob=[0.5],alphap=0.5,betap=.5)
Out[9]: array([ 61.5])

In [10]: st.mstats.mquantiles([23,56,67,123,99,17],prob=[0.33,0.66],alphap=0.5,betap=.5)
Out[10]: array([ 38.84,  81.72])

In [11]: st.mstats.mquantiles([23,56,67,123,99,17],prob=[0.25,0.5,0.75],alphap=0.5,betap=.5)
Out[11]: array([ 23\. ,  61.5,  99\. ]) 
```

最后一个有点问题，因为其中两个分割点正好在数据集中的值上。Stata/xtile（至少在我发现的示例中）没有给出分位数的分割点，而是给出了分位数本身。给定排序后的数据集 [17,23,56,67,99,123]，Stata/xtile 将分类为 [1,1,2,3,3,4]，这意味着 scipy.stat.mquantiles 匹配上分位数的界限大于或等于该分位数中的所有值。

# java - HashMap keySet 更改未反映在地图中

> ID：11347541
> 
> 赞同：2
> 
> 时间：2012-07-05T15:25:47.143
> 
> 标签：java, hashmap

我正在尝试迭代`HashMap`并将一些元素重写到另一个地图，但我有以下问题：

```
@Test
public void test() {
    Map<SubClass, String> map = new HashMap<SubClass,String>();
    Map<SubClass, String> anotherMap = new HashMap<SubClass,String>();
    map.put(new SubClass(), "10");

    for(SubClass i : map.keySet()) {
        System.out.println(i); // initial (because toString is implemented)
        System.out.println(map.get(i)); // 10
        // here it's ok...

        i.name="another";

        System.out.println(i); // another
        System.out.println(map.get(i)); // null!
        // but here it occurs that  map.get(i) returns null!

        anotherMap.put(i, map.get(i));
    }
    for(SubClass i : anotherMap.keySet()) {
        System.out.println(i); // another
        System.out.println(map.get(i)); // null!
    }
}
// SubClass has String name; and hashCode and equals implemented 
```

根据javadoc：

> `java.util.Map.keySet()`
> 
> 返回此映射中包含的键的 Set 视图。集合由地图支持，因此对地图的更改会反映在集合中，反之亦然。如果在对集合进行迭代时修改了映射（通过迭代器自己的删除操作除外），则迭代的结果是不确定的。该集合支持元素移除，即通过 Iterator.remove、Set.remove、removeAll、retainAll 和 clear 操作从映射中移除相应的映射。它不支持 add 或 addAll 操作。

它说“对地图的更改会反映在集合中，反之亦然”。那么为什么它会以这种方式表现并且最重要的是：如何克服它以使两个映射都只包含修改后的键和非空值？

更新：我的朋友在 java 1.5.0.19 上做了这个测试（我有 1.7.0_03，同样发生在 1.5.0_21）并得到正确的输出：

```
initial
10
another
10 
```

UPDATE2：哦，他没有实现hashCode/equals，所以第一次更新无关紧要

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T15:32:38.300

您正在修改*key*，而不是*map*。无法`Map<K,V>`检测到您更改了其中的对象。要使地图“看到”您需要调用的`remove(originalKey)`更改，更改键，然后调用`put(modifiedKey,object)`。

修改地图将调用`clear`、`put`、`putAll`或`remove`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T18:19:41.967

根据[java.util.Map javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Map.html)：

> 注意：如果将可变对象用作映射键，则必须非常小心。如果对象的值以影响等于比较的方式更改，而对象是映射中的键，则不指定映射的行为。

换句话说，如果您更改键对象的方式会影响键在映射中的索引方式，则映射不需要正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:33:13.110

我相信`i.name = "another"`正在改变`SubClass i`对象的哈希码，这就是你取回一个`null`值的原因。如果不使用的`hashcode`功能，代码将起作用。`Subclass``name`

所以当你打电话时，`anotherMap.put(i, map.get(i));`你真的在​​打电话`anotherMap.put(i, null);`

的目的`HashMap`是在 O(1) 时间内执行查找。这就是为什么它从哈希码中获取`SubClass i`而不更新它的原因。您的建议需要一个 lazy `HashMap`，但这会花费 O(n) 时间并破坏目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:33:42.520

尝试类似：

```
for(SubClass i : map.keySet()) {
    Object old = map.get(i);

    i.name="another";

    anotherMap.put(i, old);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-05T15:44:10.583

我在回答自己，因为我的朋友比以前的任何人都得到了更好的解决方案：

```
for (Map.Entry<SubClass, String> entry: map.entrySet()) {
    System.out.println(entry.getKey().name);
    System.out.println(entry.getValue());

    entry.getKey().name = "another";

    System.out.println(entry.getKey().name);
    System.out.println(entry.getValue());
} 
```

这将工作:)

# sql-server - SSIS包模板在2012年有用吗

> ID：11347545
> 
> 赞同：0
> 
> 时间：2012-07-05T15:25:59.250
> 
> 标签：sql-server, ssis

我在 2005 年和 2008 年使用 SSIS 包模板来执行一些标准并在我的包中提供一些重用。但是随着 2012 年的改进（项目部署模型、连接管理器、参数和配置），包模板真的不再有用了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:25:53.003

老实说，您的问题没有多大意义。如果您计划迁移到 SQL 2012，除非您也迁移它们，否则您的模板将毫无用处。

如果您想知道 2012 年的模板如何有用，那是另一个问题。我不能真正回答这个问题，因为我对 2012 年的了解不多，我可以说的是，在我看来，出于大多数原因，您将在 2005 年和 2008 年创建模板（您在问题中列出的那些) 你不需要为 2012 年创建。

# ajax - 使用 mootools 将 curl 查询转换为 ajax 查询

> ID：11347548
> 
> 赞同：0
> 
> 时间：2012-07-05T15:26:03.607
> 
> 标签：ajax, curl, mootools, nuxeo

我正在使用 curl 从 nuxeo 获取 json 数据，这是我的 curl 函数

```
curl -X POST -H "Content-Type:application/json+nxrequest" -d 
"{ params:
        {
            query:'SELECT * FROM Document'
        }
}" -u Administrator:Administrator http://localhost:8080/nuxeo/site/automation/Document.Query 
```

此功能运行良好，但现在（使用 ajax 版本）我有错误 http 500。这是 ajax 版本的代码

```
function getData(){
        var uri = "http://localhost:8080/nuxeo/site/automation/Document.Query" ;
        var options = {  method : 'post', data : 'query=SELECT * FROM Document' };
        var myCall = new Ajax(uri,options);
        myCall.request();

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:36:59.087

数据需要是一个对象。尽管在 mootools 1.12 中不确定-您似乎正在使用它。

理论上：

```
new Ajax(uri, {
    method: 'post',
    data: {
        query: 'select * from Document'
    }
}).request(); 
```

[http://jsfiddle.net/dimitar/z5QzL/](http://jsfiddle.net/dimitar/z5QzL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T14:37:24.110

为了让 Nuxeo 正常工作，您需要确保在 AJAX 调用中完成这两件事（就像在 curl 调用中所做的那样）。

1.  设置`Content-Type:application/json+nxrequest`为标题。
2.  传入完整的 json 作为数据`{"params":{"query":"SELECT * from Document"}}`

如果您没有做这些事情，您将获得 500 的回报。

查看 Nuxeo 上的服务器日志 (server.log) 可能会帮助您准确解读使用 AJAX 发送的内容并帮助调试问题。

# c# - WMI 是收集应用程序特定指标的好选择吗？

> ID：11347554
> 
> 赞同：0
> 
> 时间：2012-07-05T15:26:14.633
> 
> 标签：c#, wmi

我们需要收集和分析几个指标。其中一些相当通用 - 内存和处理器使用情况。其他指标是特定于应用程序的。例如，我们收到论文的价格变化，并想收集每秒变化的数量，等等。因此使用 WMI 来收集内存和 cpu 利用率信息似乎是合理的。特定于应用程序的指标呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:29:23.710

我建议使用 System.Diagnostics.PerformanceCounter 来收集内存和 CPU 利用率。请访问[http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx)了解更多信息。希望能帮助到你。

# php - PDO 中大数据的内存

> ID：11347555
> 
> 赞同：0
> 
> 时间：2012-07-05T15:26:16.440
> 
> 标签：php, mysql, pdo, large-data

PDO 似乎有点棘手，但我有一个大型数据库并且我收到了这个错误，

```
Fatal error: Allowed memory size of 100663296 bytes exhausted (tried to allocate 256 bytes) 
```

使用时，

```
fetchAll() 
```

解决它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:29:49.813

您可以使用以下方法临时分配额外的内存：

```
ini_set('memory_limit', '750M'); 
```

实际的问题是 PHP 本身不是 PDO 本身...它创建的 PHP 数组太大...试试上面...显然 750M 很多但是你明白了！

默认情况下，您可能会在 php.ini memory_limit 为 128M ...

**或者**：

（根据我的评论） - 只获取您可以为用户显示的内容，即实现某种形式的分页。

一个很好的组合是使用 jQuery 数据表和服务器端数据管道。即它将根据请求从数据库中获取每个页面。

**还**：

确保您的架构已正确设计和规范化，而不仅仅是有 100 列！

# objective-c - Objective C - 将 EAAccessory 存储到 NSUserDefaults

> ID：11347559
> 
> 赞同：1
> 
> 时间：2012-07-05T15:26:42.357
> 
> 标签：objective-c, nsuserdefaults, external-accessory, eaaccessory

在我必须制作的项目中，我正在使用外部附件和框架 ExternalAccessory。

（我只能连接**一个**附件）。

连接很容易，发送数据并不难。

我想做的一件事是将最后连接的设备存储在内存中，以在应用程序重新启动时尝试自动重新连接。（离开之后，所以在第一次发射之后。）

所以，我的问题是 EAAccessory 是一个自定义类对象，不能存储到 NSUserDefaults 中。

我看到这个问题来存储自定义对象：

[如何在 NSUserDefaults 中存储自定义对象](https://stackoverflow.com/questions/2315948/how-to-store-custom-objects-in-nsuserdefaults)

所以我会用它创建一个 NSData ，但没有成功，因为 EAAccessory 没有实现 encodeWithCoder 和 initWithCoder 方法......

任何想法 ？对于这种方式或另一种方式来处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:49:39.063

我认为您可以将缺少的方法实现到自定义 EAAccessory 类别中。也许是这样的：

```
*** interface
@interface EAAccessory (CodecAdditions)
- (void)encodeWithCoder:(NSCoder *)aCoder;
- (id)initWithCoder:(NSCoder *)aDecoder;
@end

*** implementation 
- (void)encodeWithCoder:(NSCoder *)aCoder
{
    [aCoder encodeInt:[self name] forKey:@"name"];
    [aCoder encodeInt:[self manufacturer] forKey:@"manufacturer"];
    ...
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self.name = [aDecoder decodeIntForKey:@"name"];
    self.manufacturer = [aDecoder decodeIntForKey:@"manufacturer";
    ...

    return self;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:39:42.307

您应该在逻辑上/以有意义的方式存储 EAAcessory 实例的所有重要和持久属性在 NSDictionary 中，并将此字典存储在 NSUserDefaults 中。然后你必须读回这个字典并执行逆转换（分配初始化 EAAccessory 实例，设置它的属性等）

# android - 在 Adreno 200 (AMD Z430) 上使用 OpenGLES 2.0 而不是 OpenGLES 1.1 是否有性能优势？

> ID：11347560
> 
> 赞同：0
> 
> 时间：2012-07-05T15:26:44.193
> 
> 标签：android, opengl-es, 3d, opengl-es-2.0

由于除了直接克隆 OpenGLES 1.x 固定管道功能的两行程序之外，Adreno 200 不能处理太多（或几乎任何事情）片段着色器，有什么理由使用它们吗？

在旧手机上（HTC Desire with Adreno 200）：

1.  使用 GLES 2.0 超过 1.1（最重要的是多纹理）是否有性能优势/劣势？

2.  如果我使用 OpenGLES 1.1，顶点变换 CPU 还是 GPU？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:10:02.750

OpenGL ES 1.1 还是 2.0 是硬件加速的取决于目标平台（软件和硬件）。

无论如何，从 1.1 迁移到 2.0 无助于提高性能。如果 2.0 是硬件加速的，那么你可以打赌 1.1 也是。

我建议使用 OpenGL ES 2.0，它不向后兼容

# android - 最新的 ADT 不允许输入宽度和高度值

> ID：11347564
> 
> 赞同：2
> 
> 时间：2012-07-05T15:26:47.833
> 
> 标签：android, eclipse, android-layout, adt

我刚拿到最新的 ADT，发现我不能再为布局输入宽度和高度值。它有一个下拉菜单，可以让我选择填充、匹配和换行，但我不能输入数字来表示倾角值等。

这是 Google 为鼓励使用替代方法而有意做出的改变吗？如果是，那是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:34:46.560

这是ADT 插件中[公认的错误](http://code.google.com/p/android/issues/detail?id=33978)。解决方法是直接编辑 XML 中的值。

# sharepoint - 如何在 javascript 函数中访问 SharePoint 列表属性的日期时间字段？

> ID：11347568
> 
> 赞同：0
> 
> 时间：2012-07-05T15:26:57.303
> 
> 标签：sharepoint, sharepoint-2010

如何在 javascript 函数中访问 SharePoint 列表属性的日期时间字段？

我有一个日期时间字段“StartedOn”，如何访问 javascript 中的共享点数据字段？

我这样尝试过

var ppe = document.getElementById(').value; （这是在 Default.aspx 页面内）

但不起作用，任何替代方法都会有很大帮助。

维努

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T16:07:17.910

我想出了一个替代方案

1.  我将“StartedOn”日期时间值呈现为隐藏字段

    “”

2.  访问 JavaScript 函数中的值，以所需格式处理值，然后使用“设置为 InnerHtml”显示它

    "var hdnDate=document.getElementById("hdnDateValueID0EAAA");"

维努

# c# - linq to entity 无法识别方法 int32 toint32

> ID：11347570
> 
> 赞同：3
> 
> 时间：2012-07-05T15:26:57.683
> 
> 标签：c#, visual-studio-2010, linq, entity-framework, int

当我尝试将 int 与 int 进行比较时出现此错误（在比较字符串时它有效）

```
IEnumerable<Commune> myCommunes = from d in db.Communes
                                  where d.CodePostal == Convert.ToInt32(CodePostal.Text)
                                  select d;

foreach (Commune c in myCommunes)
{
    CommunesList.Add(c);
} 
```

![在此处输入图像描述](../Images/7581e46495ca0745c519b366a6081d1f.png)

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T15:31:46.100

它看起来像是`CodePostal.Text`在您现有的上下文中的东西 - 所以您所要做的就是从查询中提取它：

```
int code = Convert.ToInt32(CodePostal.Text); // Or use int.Parse...

// Not using a query expression here as it just adds extra cruft
IEnumerable<Commune> myCommunes = db.Communes.Where(d => d.CodePostal == code); 
```

目前尚不清楚`CommunesList`来自哪里 - 但如果在此之前它是空的，你可以使用：

```
CommunesList = db.Communes.Where(d => d.CodePostal == code).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T07:15:18.763

使用这个：db.Communes.Where(d => d.CodePostal == (int)CodePostal.Text)

# css - IE8问题点击按钮后禁用按钮

> ID：11347572
> 
> 赞同：0
> 
> 时间：2012-07-05T15:27:02.460
> 
> 标签：css, jquery, internet-explorer-8

我想在单击后禁用提交按钮..让我解释如下

1.  使用 ajax 调用完成表单提交验证，并使用禁用提交按钮 `.attr("disabled",true);`

2.  如果响应为“失败”（即验证失败），则可以 `.attr("disabled",false)`在 ajax 响应中再次单击按钮

这项工作在 FF 和 chrome 中绝对正常，但在 IE8 中，每当按下按钮时，启用禁用的效果是可见的（单击时按钮是正常的，像禁用一样可见）。不希望在 IE8 上出现这种暂时的外观变化。

我什至尝试了一些建议，例如使用`.attr("disabled","disabled");`并`.removeAttr("disabled");`使其禁用和启用。代码片段：-

```
$("#submitBtn").click(function(event) {
    event.preventDefault();
    $("#submitBtn").attr('disabled',true);
    dataToPost = $("#Form").serialize();
    $.ajax({
        type: "POST",
        url: 'FormValidation',
        data: dataToPost ,
        success: function(response){
            if(response.status=='FAIL')
            {
                $("#submitBtn").attr('disabled',false);
                 //Some code
          }
             else{
        /* submit the form to if validation is successful */
                saveData(dataToPost);
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:34:41.227

为什么不阻止点击行为，而不是禁用按钮？一种方法是执行以下操作：

```
var waitingForAjax = false;

$('yourButton').click(function(e){
    if (waitingForAjax) {
        return false;
    }

    waitingForAjax = true;
    // ajax call
}); 
```

然后在ajax失败`waitingForAjax`再次设置`false`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T06:21:11.130

不幸的是，如果您使用 disabled 属性，无论您尝试什么，IE 都会将文本的颜色默认为灰色，并带有一个奇怪的白色阴影......但是所有其他样式仍然有效。[:-/ 在这里](https://stackoverflow.com/questions/1411044/how-to-change-color-of-disabled-html-controls-in-ie8-using-css)回答。

# ruby - 从 Ruby Watir 读取动态 PDF

> ID：11347573
> 
> 赞同：1
> 
> 时间：2012-07-05T15:27:07.990
> 
> 标签：ruby, pdf, watir

我正在使用 Watir 登录应用程序，按下一些按钮等......基本上是人们使用 Watir 的普通东西。

但是，我的问题是我需要测试一个特定的页面。它实际上是一个动态生成的 PDF，我需要从中获取实际的二进制数据，以便我可以使用我们正在使用的某个 gem 加载它。这通常适用于静态 PDF 文件，因为我们可以使用：

```
 open("http://site.com/something.pdf") 
```

这适用于静态 PDF。但是，对于动态生成的，它不起作用，因为我们使用 Ruby 发送 HTTP 请求，并且它不知道 Watir 正在使用的 headers/cookies/session。因此，我们没有获得实际的 PDF，而是获得了一个登录页面。

我们尝试的另一件事是使用 Watir 获取 PDF：

```
 @browser.goto "http://site.com/dynamic/thepdffile"
    @browser.text
    @browser.html 
```

我们尝试从页面中获取文本或 html，但没有成功，因为 firefox 在加载 pdf 时创建了一个 DOM，因此文本是一个空字符串，而 html 是 firefox 在查看 pdf 页面时创建的 DOM。我们需要原始的 HTTP 响应，但似乎没有办法提取它。

所以我们需要一个解决方案，我认为我们有以下选择：

1.  使用来自 Watir 的会话找出在 Ruby 中使用“open”或类似方法的方法。
2.  弄清楚如何使用 watir 从 PDF 页面获取二进制 http 响应。
3.  禁用 pdf 插件（这似乎不可能），以便出现“另存为”对话框。

或者如果您有其他想法，请分享！提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T19:43:36.483

我想出了一个解决办法。

在 firefox 的配置文件中，您可以将 plugin.scan.Acrobat 设置为“999”，这将有效地禁用 PDF 插件。

```
 profile = Selenium::WebDriver::Firefox::Profile.new
    profile['plugin.scan.Acrobat'] = "999"
    b = Watir::Browser.new :firefox, :profile => profile 
```

# c# - 如何在窗口窗体中制作圆形标签？

> ID：11347576
> 
> 赞同：9
> 
> 时间：2012-07-05T15:27:16.140
> 
> 标签：c#, .net, winforms

众所周知，标签通常是正方形或长方形。我真的需要制作圆形标签。谁能告诉我这是否可能或至少指出我正确的方向？

对不起，只是为了说明清楚。我想要一个圆形标签。不只是在屏幕上画一个圆圈。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T13:39:25.607

您可以设置 Label 的 Region 属性：

```
var path = new System.Drawing.Drawing2D.GraphicsPath();
path.AddEllipse(0, 0, label1.Width, label1.Height);

this.label1.Region = new Region(path); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-05T15:30:50.843

```
System.Drawing.Graphics graphics = this.CreateGraphics();
System.Drawing.Rectangle rectangle = new System.Drawing.Rectangle(100, 100, 200, 200);
graphics.DrawEllipse(System.Drawing.Pens.Black, rectangle); 
```

# c++ - 线程访问各种缓冲区

> ID：11347578
> 
> 赞同：1
> 
> 时间：2012-07-05T15:27:21.470
> 
> 标签：c++, multithreading, thread-safety

我正在尝试找出最好的方法来做到这一点，但我有点卡在弄清楚我正在尝试做什么，所以我要解释它是什么，我是什么'我在想我想做的事，我在哪里卡住了。

我正在开发一个具有单个数组（实际上是图像）的程序，每帧可以在图像数组上放置大量对象。每个对象完全独立于所有其他对象。唯一的依赖是输出，理论上可以将这些对象中的 2 个放置在数组的相同位置。我正在尝试提高在图像上放置对象的效率，以便可以放置更多对象。为了做到这一点，我想解决这个问题。

我为线程化它所采取的第一步只是简单地保护数组的互斥锁。所有在数组上放置对象的操作都会调用同一个函数，所以我只需要将互斥锁放在一个地方。到目前为止，它正在工作，但它没有看到我希望的改进。我假设这是因为大多数时候，限制因素是图像写入语句。

我想我接下来需要做的是拥有多个要写入的图像缓冲区，并在所有操作完成后将它们组合起来。我应该说遮蔽不是问题，所需要做的就是简单地将像素数相加。但是，我正在努力弄清楚我需要使用什么机制才能做到这一点。我看过信号量，但虽然我可以看到它们会限制缓冲区的数量，但我可以设想两个或多个程序会尝试同时写入同一个缓冲区的情况，这可能会导致不准确。

我需要一个不涉及任何新的非标准库的解决方案。我非常愿意构建解决方案，但我非常感谢一些正确方向的指示，因为我目前只是在黑暗中徘徊......

为了帮助可视化这一点，假设我被告知在图像阵列的不同位置放置球。我被告知在每一帧中放置球，具有给定的亮度、位置和大小。球的确切位置取决于前一帧的物理特性。所有的球都必须尽可能快地放置在最终的图像阵列上。就本例而言，如果两个球彼此重叠，则可以简单地将亮度相加，因此无需判断一个球是否阻挡了另一个球。此外，不使用 GPU 卡；-)

伪代码如下所示：（假设为位置、亮度和大小给出了一些逻辑对象）。此外，假设 isValidPoint 只是在给定所述圆的位置和半径的情况下查找该点是否应该在圆上。

```
global output_array[x_arrLimit*y_arrLimit)
void update_ball(int ball_num)
{
  calc_ball_location(ball_num, *location, *brightness, *size); // location, brightness, size all set inside function
  place_ball(location,brightness,size)
}

void place_ball(location,brighness,size)
{
  get_bounds(location,size,*xlims,*ylims)
  for (int x=xlims.min;x<xlims.max;y++)
  {
    for (int y=ylims.min;y<ylims.max;y++)
    {
      if (isValidPoint(location,size,x,y))
      {
        output_array(x,y)+=brightness;
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:45:19.150

您没有看到当前设计的任何加速的原因是，对于整个缓冲区使用单个互斥锁，您最好不要打扰线程，因为无论如何都必须串行添加所有对象（除非有重要的处理正在确定要添加的内容，但听起来并非如此）。根据“将对象添加到缓冲区”所需的内容（您是否使用扫描线算法、洪水填充或其他方法），您可能会考虑每行或一系列行有一个互斥锁，或者将图像划分为每个区域一个互斥锁或其他东西的矩形图块。这将允许多个线程同时添加到图像中，只要它们不尝试更新相同的区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:46:41.647

好的，您在某个对象中有一个图像成员。添加无疑是复杂的代码以向其中添加其他图像/对象。处理它，无论如何。聚合可能涉及的所有其他对象，添加一些命令 enun 来告诉线程执行什么操作，并在完成时调用一个“OnCompletion”事件。

将其排队到挂在生产者-消费者队列末尾的线程池中。一些线程将获取 *object，对图像/集执行操作，然后调用事件，（将完成的 *object 作为参数传递）。在这种情况下，您可以根据您的应用程序的需要做您喜欢的事情。也许您会将处理后的图像添加到（线程安全的！！）、向量或其他容器中，或者将它们排队到其他线程 - 无论如何。

如果必须保留处理图像的顺序（例如视频流），您可以为提交到池的每个对象添加一个递增的序列号，以便让您的“OnComplete”处理程序将“稍后”图像排队直到所有较早的人都进来。

由于没有两个线程在同一个图像上工作，因此在处理时不需要锁定。您应该（可能）需要的唯一锁是队列内部的那些锁，并且它们仅锁定将对象指针推入/弹出队列所需的时间 - 争用将非常罕见。

# android - 使用 SimpleAdapter 和 Mono for Android

> ID：11347582
> 
> 赞同：2
> 
> 时间：2012-07-05T15:27:25.167
> 
> 标签：android, mono, xamarin.android

我在 Mono for Android 中创建了一个 FileDialog 活动。但是，在我看来，在使用 ListView simpleadapter 时，某些 MonoObject 到 JavaObject 的转换存在问题。在我离开 onCreate 后，VM 崩溃并出现以下堆栈跟踪：

```
07-05 15:04:46.493 D/FileDialogActivity( 3430): Left OnCreate
07-05 15:04:46.503 D/AndroidRuntime( 3430): Shutting down VM
07-05 15:04:46.503 W/dalvikvm( 3430): threadid=1: thread exiting with uncaught exception (group=0xb4127180)
07-05 15:04:46.523 D/dalvikvm( 3430): GC_CONCURRENT freed 115K, 3% free 9634K/9863K, paused 0ms+2ms
07-05 15:04:46.523 E/AndroidRuntime( 3430): FATAL EXCEPTION: main
07-05 15:04:46.523 E/AndroidRuntime( 3430): java.lang.ClassCastException: mono.android.runtime.JavaObject cannot be cast to java.util.Map
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.SimpleAdapter.bindView(SimpleAdapter.java:147)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.SimpleAdapter.createViewFromResource(SimpleAdapter.java:126)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.SimpleAdapter.getView(SimpleAdapter.java:114)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.AbsListView.obtainView(AbsListView.java:2033)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.ListView.makeAndAddView(ListView.java:1772)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.ListView.fillDown(ListView.java:672)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.ListView.fillFromTop(ListView.java:732)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.ListView.layoutChildren(ListView.java:1625)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.AbsListView.onLayout(AbsListView.java:1863)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.RelativeLayout.onLayout(RelativeLayout.java:925)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.View.layout(View.java:11278)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewGroup.layout(ViewGroup.java:4224)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1489)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.os.Looper.loop(Looper.java:137)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at android.app.ActivityThread.main(ActivityThread.java:4424)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at java.lang.reflect.Method.invokeNative(Native Method)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at java.lang.reflect.Method.invoke(Method.java:511)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-05 15:04:46.523 E/AndroidRuntime( 3430):     at dalvik.system.NativeStart.main(Native Method) 
```

一些代码：

```
IList<IDictionary<string, object>> mData = new List<IDictionary<string, object>>();
AddFiles(files, mData); // Which just new Dictionary with filedata and icon from a list of files.
SimpleAdapter fileAdapter = new SimpleAdapter(this, mData,
            Resource.Layout.FileDialogRow,
            new string[] { FileKey, FileImage },
            new int[] { Resource.Id.fdrowname, Resource.Id.fdrowimage }
        );
ListAdapter = fileAdapter;
Log.Debug("Left OnCreate"); 
```

在 Mono for Android 上使用 SimpleAdapter 时，还有其他人遇到问题吗？或者对这里发生的事情有任何线索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T18:39:52.137

而不是使用`List`我认为你将需要使用`JavaList`. 喜欢：

```
var mData = new JavaList<IDictionary<string, object>>(); 
```

这个线程有一个很长的解释：http: [//mono-for-android.1047100.n5.nabble.com/SimpleAdapter-break-in-4-2-1-td5709793.html](http://mono-for-android.1047100.n5.nabble.com/SimpleAdapter-break-in-4-2-1-td5709793.html)

如果您将在列表中使用更复杂的东西，我建议您实现自己的适配器，这最终更容易维护和调试。

# jquery - jquery .get() 似乎失败但无法回复消息

> ID：11347586
> 
> 赞同：1
> 
> 时间：2012-07-05T15:27:33.673
> 
> 标签：jquery

我有这个`.get()`从 URL 中返回的数据很好，但是当它循环通过并且该 URL 上没有所需的数据时，它不会返回警报，`.error();`甚至`.fail();` 如果它找不到它要查找的内容，它甚至不希望发生动作，什么我做错了吗？

```
$.get('/jsp/landing.jsp?id=FiresContent', function(data){

           var DataReturned = $(data).find('#' + topNavliID +' > div').each(function(index){

              SkuDetail = "<li id='" + index + "'><article><ul><li class='sku-" + index + "'>" + $(this).find('.sku').text() + "</li>";
              SkuDetail = SkuDetail + "<li class='prodName-" + index + "'><h2>" + $(this).find('.prodName').text() + "</h2></li>";
              SkuDetail = SkuDetail + "<li class='prodDesc-" + index + "'>" + $(this).find('.prodDesc').text() + "</li>";
              SkuDetail = SkuDetail + "<li class='action-" + index + "'><a href='" + $(this).find('.actionLink').text() + "' title='" + $(this).find('.action').text() + "'>" + $(this).find('.action').text() + "</a></li></ul></article></li>";

              ThumbNail = "<li class='thumbImage-" + index + "'><img src='/images/CAT110/FireSurrounds/thumbnail_" + $(this).find('.sku').text() + ".jpg' alt='" + $(this).find('.prodNameShort').text() + "' title='" + $(this).find('.prodNameShort').text() + "'>";
              ThumbNail = ThumbNail + "<span class='prodNameShort-" + index + "'>" + $(this).find('.prodNameShort').text() + "</span></li>";

              $('#largeSlides').css('width','+=1000');
              $('#largeSlides').append(SkuDetail);
              $('#thumbSlides').append(ThumbNail);

              // remove loading image once loaded.
              $('.loadingmessage').fadeOut(800, function(){
                    $(this).remove();
                  });

           });
        }).fail(function(){ alert("$.get failed!"); });

        //.error(function() { alert("error"); }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T22:10:14.110

我建议改用 $.ajax。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

与使用 $.get 相比，您可以更轻松地处理错误。

该页面上有很多代码片段。

# c++ - 将 decltype 与虚拟成员函数指针一起使用

> ID：11347587
> 
> 赞同：6
> 
> 时间：2012-07-05T15:27:42.643
> 
> 标签：c++, visual-studio, visual-c++, c++11

`decltype`与虚拟成员函数指针一起使用是否合法？

以下使用 VS2012 生成内部错误 (C1001)。

```
struct C
{
    virtual void Foo() {}

    typedef decltype(&C::Foo) type;   //pointer
} 
```

但这编译得很好：

```
struct C
{
    virtual void Foo() {}

    typedef decltype(C::Foo) type;   //not pointer
} 
```

它是一个错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T17:18:01.787

`decltype`MSVC对成员函数指针有多个已知问题；另请参阅[将 decltype 与成员函数指针一起使用](https://stackoverflow.com/questions/6557565/using-decltype-with-member-function-pointers)

这是合法的语法；g++ 对此非常满意（[http://ideone.com/sTZi6](http://ideone.com/sTZi6)）。标准中没有限制`decltype`成员函数的操作。

# jquery-mobile - jQuery mobile：没有为对话框小部件实例“打开”这样的方法

> ID：11347594
> 
> 赞同：1
> 
> 时间：2012-07-05T15:27:54.433
> 
> 标签：jquery-mobile

这是我的代码`<head></head>`：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script> <script type="text/javascript" src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
<script type="text/javascript">
// <![CDATA[
$(function() {
});

$(document).ready(function () {
    $('#dialog1')
        .dialog({
          position: 'center',
          modal: true,
          autoOpen: false
        })
        ;
    $('.panier')
        .unbind('click')
        .click(function(event) {
            event.preventDefault();
            $('#dialog1').dialog('open');
        });
});

// ]]>
</script> 
```

和html代码：

```
 <div data-role="page">
        <div data-role="header">
            <h1>Choisissez vos pizzas&nbsp;!</h1>
        </div>
        <div data-role="content">
            <div data-role="footer">
                <div data-role="navbar">
                    <ul>
                        <li><a class="panier" href="/" data-role="button" data-icon="search">Voir panier</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div data-role="dialog" id="dialog1" class="app-dialog">
        <div data-role="header">
            <h3>A dialog</h3>
        </div>
        <div id="content" data-role="content">
            <p>I am a dialog....!</p>
        </div>
    </div> 
```

当我启动我的页面时，一切都很好，直到我点击“panier”按钮：引发的错误是：

```
Uncaught no such method 'open' for dialog widget instance 
```

我真的不知道为什么这不起作用，因为对话框小部件实例*应该有*一个`open()`方法。

任何的想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T19:55:31.647

我认为您将[jquery 移动对话框](http://jquerymobile.com/demos/1.1.0/docs/pages/page-dialogs.html)与[jquery UI 对话框](http://jqueryui.com/demos/dialog/)混淆了。jquery 移动对话框实际上是另一个 JQM 页面，其样式看起来更像一个对话框（覆盖、圆角）。要显示 JQM，您只需使用该`$.mobile.changePage('#yourDialog', optionalTranistion)`方法。也就是说，JQM 对话框确实有一个 close 方法（我不确定，但在某些时候可能也有一个 open 方法）。

所以对于你的代码，

```
 $(document).ready(function () {
        /*  $('#dialog1')  this is JQUI code
        .dialog({
        position: 'center',
        modal: true,
        autoOpen: false
        })
        ;*/
        $('.panier')
        .unbind('click')
        .click(function (event) {
            event.preventDefault();
            //$('#dialog1').dialog('open');
            $.mobile.changePage('#dialog1');
        });
    }); 
```

还有一个用于 JQM 的[弹出小部件](http://jquerymobile.com/test/docs/pages/popup/index.html)正在开发中（现在已经有一段时间了）。

您可能还对 JQM 的[简单对话框](http://dev.jtsage.com/jQM-SimpleDialog/demos2/popup.html)插件感兴趣。

# python - 使用 15000 行数据集查找最小列值的 Python 代码

> ID：11347598
> 
> 赞同：2
> 
> 时间：2012-07-05T15:27:58.560
> 
> 标签：python, csv

我有一个 .csv 数据集（如 15000 个项目），我想找到最小值。

当我一直在寻找答案时，我找到了很多答案，但是人们总是有他们想要在括号中找到最小值的数据集

```
ex. [0.0, 1.3, 37.7] 
```

然后让 Python 找出最小值。有了这么大的数据集，我不可能将数据单独放入括号中，我如何在 .csv 文件中调用*特定列*然后找到最小值？

（请解释一下你在做什么，我对使用 python 很陌生）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:32:52.360

*   15,000 项不是“大”；我已经在内存中处理了大约 1200 万行 .csv 文件（尽管我必须使用 64 位 Python 来获得足够的空间！）

*   `min()`将对生成器起作用-也就是说，一次一个项目，而不是一次全部

.

```
import csv

with open('myfile.csv', 'rb') as inf:
    incsv = csv.reader(inf)
    column = 1                # the second column (Python counts from 0, per @MRAB's comment)
    datatype = float          # or int, as appropriate (per MvG)
    data = (datatype(row[column]) for row in incsv)    # NB: a generator expression, not a list
    least_value = min(data) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:45:16.553

我同意@HughBothwell 的观点，即数据的大小不会成为问题。但是，如果出于某种原因 OP 更喜欢逐行（即逐行）处理数据，则这提供了一种替代方法。

```
import csv, sys

with open('data.txt', 'rb') as inf:
    min_val = sys.maxint
    col = 0 # column we are searching (this is the 1st column, zero-based index)
    for line in csv.reader(inf):
        val = int(line[col])  # or float() as needed
        if val < min_val:
            min_val = val

    print min_val 
```

OP：如果不清楚，很高兴澄清代码的任何部分。

# c++ - 如何在 C++ 中的头文件之外定义赋值运算符？

> ID：11347599
> 
> 赞同：9
> 
> 时间：2012-07-05T15:28:05.680
> 
> 标签：c++, variable-assignment

我有一个头文件，其中包含一个带有赋值运算符的类。现在我想在我的 .cpp 文件中定义我的函数。

我的头文件包含：`Car &operator=(const Car &other);` 现在在我的 cpp 文件中，我想做类似的事情：`Car::Car &operator=(const Car &other) { }`

不幸的是，这似乎不是正确的语法。那么，当我将函数声明和函数定义分开时，如何定义我的赋值运算符呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T15:30:28.270

您快到了; 您需要限定函数名称以表明它是成员：

```
Car &Car::operator=(const Car &other) { }
     ^^^^^ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T15:31:14.337

我写我的运营商如下

```
in.h
Car& operator=(const Car &other);
in cpp
Car& Car::operator=(const Car &other) { } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T15:30:47.510

```
Car& Car::operator=(const Car &other) { } 
```

是要走的路。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T15:30:21.707

正确的语法是

```
Car& Car::operator=(const Car& other) { } 
```

因为`operator=()`具有适当参数的是成员函数。

# sql - 插入触发器防止重复

> ID：11347602
> 
> 赞同：0
> 
> 时间：2012-07-05T15:28:13.667
> 
> 标签：sql, triggers, insert

我有一个表，其中一个 AutoIdentity 列作为它的 PK 和一个名为“IdentificationCode”的 nvarchar 列。我想要的只是在插入新行时，它会在表中搜索任何预先存在的 IdentificationCode，如果找到，则回滚事务。

我写了以下触发器：

```
ALTER trigger [dbo].[Disallow_Duplicate_Ids] 
on [dbo].[tbl1]
for insert
as
if ((select COUNT(*) from dbo.tbl1 e , inserted i where e.IdentificationNo = i.IdentificationNo ) > 0)
begin
RAISERROR('Multiple Ids detected',16,1)
ROLLBACK TRANSACTION
end 
```

但是在插入新行时，即使没有这样的IdentificationCode，它总是会触发回滚。

任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:51:56.087

正如@Qpirate 提到的，您可能应该对列施加某种`UNIQUE`约束。这*可能*比使用触发器“更强”，因为有办法禁用它们。
此外，隐式连接语法（逗号分隔`FROM`子句）被视为 SQL 反模式 - 如果可能，请始终明确声明您的连接。

我怀疑您的错误是因为您的触发器似乎是一个`AFTER`触发器，并且您检查表中是否有*任何*（非零）行；换句话说，触发器（可能）“失败”了，`INSERT` *因为*它被`INSERT`编辑了。将其更改为`BEFORE`（或`INSTEAD OF`）触发器，或将计数更改为`>= 2`可以解决问题。

如果没有看到您的插入语句，就不可能确定，但​​是（特别是如果您使用的是 SP），您可以检查`INSERT`语句本身是否存在，如果未插入行。
例如，以下内容：

```
INSERT INTO tbl1 (identificationCode, *otherColumns*)
VALUES (@identificationCode, *otherColumns)
WHERE NOT EXISTS (SELECT '1'
                  FROM tbl1
                  WHERE identificationCode = @identificationCode) 
```

`SQLCODE = 100`如果`identificationCode`已经存在，将返回一个指示“未找到行”的代码（插入等；在几乎每个系统上都是这样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:35:20.293

**使用 EXISTS 检查 IdentificationCode 是否已经存在。**

```
If EXISTS (Select * from tbl1 where IdentificationCode = @IdentificationCode )
BEGIN
//do something
END
Else
BEGIN
//do something
END 
```

# ruby-on-rails - 如何使用 RSpec 在 Rails 中测试 i18n

> ID：11347606
> 
> 赞同：8
> 
> 时间：2012-07-05T15:28:29.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3, internationalization, rspec-rails

**问题上下文：**

假设**config/locales/en.yml**中有一些非常重要的行对存在至关重要。

```
en:
  foo:
    bar: "bubla!" 
```

*   我不想测试每一行但是
*   我不希望测试太脆弱（所以没有 I18n.t('foo.bar').should =~ /bubla/）

所以我目前正在测试的方式是这样的

```
#spec/locals_spec.rb

require 'spec_helper'
describe I18n do
  it do
    I18n.t('date.datepicker').should be_kind_of(String)
  end
end 
```

这样我只是确保翻译存在并且它不会继续（例如'foo.bar.car.lol'

但我仍然不满意

**问题：**使用 RSpec 测试 I18n 翻译的最佳实践是什么？我应该将它们放在 spec 文件夹的什么位置？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T20:22:36.857

检查[这个 StackOverflow 问题](https://stackoverflow.com/q/5415158/567863)以获得一些想法。我的首选方式是对同一问题的[这个答案。](https://stackoverflow.com/a/10671020/567863)

**更新**：这些天我倾向于使用[i18n-tasks](https://github.com/glebm/i18n-tasks) gem 来处理与 i18n 相关的测试，而不是我上面写的或者之前在 StackOverflow 上回答过的内容。

我想在我的 RSpec 测试中使用 i18n 主要是为了确保我对所有内容都有翻译，即没有翻译遗漏。i18n-tasks 可以通过对我的代码进行静态分析来做到这一点以及更多，因此我不再需要为所有人运行测试`I18n.available_locales`（除了在测试非常特定于语言环境的功能时，例如，从任何语言环境切换到任何其他语言环境）系统中的语言环境）。

这样做意味着我可以确认系统中的所有 i18n 键实际上都有值（并且没有一个是未使用或过时的），同时保持重复测试的数量，从而降低套件运行时间。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T15:44:41.460

我想我会为这样一个“关键”的事情写一个验收测试。

在大多数情况下，您需要在某些特定上下文中进行翻译，即。在日期选择器中显示某些内容。我会使用 capybara 或任何适用于 javascript 驱动程序的东西来测试该上下文。

如果您没有使用它的上下文，那么仅测试该翻译是否存在是没有用的。

# c# - 我如何才能从我的视图中删除这个 if 条件？

> ID：11347610
> 
> 赞同：0
> 
> 时间：2012-07-05T15:28:43.100
> 
> 标签：c#, asp.net-mvc-3, model

这是视图：

```
 @if (stream.StreamSourceId == 1)
    {
        <img class="source" src="@Url.Content("~/Public/assets/images/own3dlogo.png")" alt="" />    
    }
    else if (stream.StreamSourceId == 2)
    {
        <img class="source" src="@Url.Content("~/Public/assets/images/twitchlogo.png")" alt="" />
    } 
```

基本上，我使用 Model 属性来确定要渲染的图像。

我**知道**正确的解决方案是在名为的模型上创建一个属性`SourceImageUrl (string)`并将该属性用作图像的源 URL。

然后我会将这个条件操作转移到模型中。

我的问题是，如果我使用 DataAnnotations 进行验证，我该怎么做？有什么建议么？

```
public class StreamModel
{
    // This is the ID that has the value of either 1 or 2.
    public int StreamSourceId { get; set; }

    // How can I move the logic from the view, to here, and set the value accordingly?
    public string SourceImageUrl { get; set; }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:35:15.003

你不能做这样的事情吗？

```
public string SourceImageUrl
{
    get
    {
        switch (StreamSourceId)
        {
            case 1: return "~/Public/assets/images/own3dlogo.png";
            case 2: return "~/Public/assets/images/twitchlogo.png";
            default: return null;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:42:30.463

我建议您将逻辑移动到模型中，以便您的视图与此类似

```
 <img class="source" src="@Url.Content(stream.SourceImageUrl)" alt="" /> 
```

你的模型将是

```
public class Model
{
    private string[] m_images;

    public Model()
    {
        m_images = new[] { 
               "~/Public/assets/images/own3dlogo.png", 
               "~/Public/assets/images/twitchlogo.png" 
               };
    }

    public string SourceImageUrl
    {

        get { return m_images[StreamSourceId]; }
    }
} 
```

如果你不喜欢数组，你可以用更智能的集合替换它：Dictionary、HashSet、ecc

# css - 模仿 HTML5 表单验证默认样式

> ID：11347612
> 
> 赞同：1
> 
> 时间：2012-07-05T15:28:48.873
> 
> 标签：css, forms, html, validation

我有一个带有所需文件的简单 HTML5 表单。当页面加载时，字段没有样式。当我单击必填字段时，输入一些内容，然后删除我刚刚输入的文本并退出该字段，它会在 Firefox 中的无效字段之外显示粉红色的框阴影。

现在我需要黄色框阴影，同时保持相同的行为。我就是这样做的：

**在 HTML 中**

```
<input name="email_address" id="email_address_uuid_479823574" type="email"
       placeholder="ex. example@domain.com" title="Email address" required />

       -------
       -------

<input name="model_number" id="model_number_uuid_479823574" type="text"
       placeholder="ex. oxpd-983s" title="Equipment model number" required /> 
```

**在 CSS 中**

```
input:required:invalid {box-shadow: 1px 2px 9px yellow}; 
```

结果：页面加载了所有带有黄色框阴影的字段！而是等待用户像默认行为一样在 onblur 和 onsubmit 上犯错误。

如何在**不改变行为**的情况下覆盖无效字段的默认框阴影？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:34:20.360

尝试：

```
input:required:-moz-ui-invalid {box-shadow: 1px 2px 9px yellow}; 
```

见[https://developer.mozilla.org/en/CSS/:invalid](https://developer.mozilla.org/en/CSS/:invalid)

# python - 在Python中实现deb preinst，postint等脚本是否实用，而不是在sh中

> ID：11347613
> 
> 赞同：9
> 
> 时间：2012-07-05T15:28:55.453
> 
> 标签：python, debian, packaging, deb

我对将 Python 用于 deb 包流控制脚本（preinst、postinst 等）时可能存在的缺陷（目标系统中未安装 Python 除外）感兴趣。在 Python 中而不是 sh 中实现这些脚本是否实用？

据我了解，这至少是可能的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T18:46:35.070

这不常见的唯一原因，afaik，是它不是惯例，对于维护者脚本所做的事情，Python 通常并不比普通的 shell 脚本更有用或更直接。当它更有用时，您通常可以将需要 Python 的功能分解为单独的 Python 脚本，由维护者脚本调用。

在这种情况下遵循惯例会有所帮助，因为有很多有用的工具和脚本（例如，Lintian、Debhelper）通常假定维护者脚本使用 bash。如果他们不这样做，那没关系，但这些工具可能不如其他工具有用。我认为您需要注意的唯一另一个问题是，如果您的`preinst`或`postrm`脚本需要 Python，那么 Python 需要成为您的包的预依赖项 ( `Pre-Depends`) 而不仅仅是`Depends`.

也就是说，我发现以前在维护者脚本中使用 Python 很有用。

# asp.net-mvc-3 - ViewBag 内容不可用于部分视图？

> ID：11347618
> 
> 赞同：-1
> 
> 时间：2012-07-05T15:29:18.810
> 
> 标签：asp.net-mvc-3, razor, viewbag

我有一个名为 TopPanel 的 PartialView。该面板负责显示在我的应用程序的任何页面上生成的错误消息。为了处理这个问题，当页面上发生任何异常时，我让它在 TopPanel 控制器中调用“ErrorHandler”操作。ErrorHandler 使用错误消息更新 ViewBag 并调用仅返回部分视图的 Index 操作（现在，因为我正在测试。稍后我将让它调用 Main Controllers Index Action 以显示整个页面）。我的理解是调用 Index 操作将重新加载视图，并且我在 TopPanels PartilaView 上的 ErrorDiv 将能够在 ViewBag 中显示新的错误消息。但是，什么都没有显示，我不知道为什么。

这是一些代码 -

ErrorHandler 动作 -

```
public ActionResult ErrorHandler(string message)
{
        ViewBag.ErrorMsg = message;
        return RedirectToAction("Index");
} 
```

我已经检查了调试器，“消息”确实有一个有效值。ViewBag.ErrorMsg 也确实被填充了。

TopPanel 的索引操作 -

```
 public ActionResult Index()
 {           
        return PartialView();
 } 
```

TopPanels PartialView 包含这个单独的显示错误 -

```
<div id="errorMsgBox">@ViewBag.ErrorMsg</div> 
```

谁能指出问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:33:53.800

由于您正在执行重定向，因此您实际上最终会得到一个完全独立的请求/响应，它不知道先前的 ViewBag 属性值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:36:08.200

RedirectToAction 类似于浏览器重定向。它实际上将重定向代码发送到浏览器，并且操作名称是要请求的新 URL。因此，您实际上是在向服务器发送一个新请求以获取一个新页面，该页面将具有自己的 ViewBag。

您可能只想返回 View 并指定 PartialView 名称，而不是 RedirectToAction。

# php - 静态方法或函数的 PHP 对象数组？

> ID：11347619
> 
> 赞同：2
> 
> 时间：2012-07-05T15:29:19.477
> 
> 标签：php, arrays, function, object, static

假设我有以下数据：

```
// Users Table

+----+-------+----------+
| ID | first | last     |
+----+-------+----------+
|  1 | Al    | Anderson |
|  2 | Bob   | Blakely  |
|  3 | Cal   | Cambel   |
+----+-------+----------+ 
```

和以下课程：

```
// Users.php

class Users {

    public $first;
    public $last;

    ...

} 
```

我需要从查询结果中实例化用户对象并返回一个对象数组。我不知道哪种方法更好：

**静态方法**

在类文件中封装如下伪代码：

```
public static function getAll() {
    $myUsers = array();
    ...
    foreach ($results as $row) {
        $user = new User();
        ...
        $myUsers[] = $user;
    }
    return $myUsers;
} 
```

并这样称呼它：

```
$allUsers = Users::getAll(); 
```

**常规功能**

像静态方法一样工作，但也许我可以重构以与其他对象一起工作......

```
function getAll($objType='Users') {
    $myArray = new array();
    ...
    return $myArray;
} 
```

**哪种方法更好？**

我喜欢将它封装在一个类函数中，但处理静态数据库连接对象更痛苦。我喜欢简单的“帮助”功能，但这只会将 OOP 抛诸脑后。我该怎么办？

***更新：这不是 MySQLi 或 PDO 的事情。我在问（仅从 OOP 最佳实践的角度）是在类中放置一个静态的“getAllOfMyself()”方法更好，还是更好地使用像“getAllSomethings()”这样的简单函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:16:28.607

我的意见是你应该将工厂模式与 Singleton 结合起来（无论如何这在工厂中很常见）。您对静态方法的建议本质上是一个工厂，但您可以/应该在这个方向上进一步考虑它。使用 getUserByID() 和 getAllActiveUsers()... 等方法创建一个名为 UserFactory 的类。这些可以（并且应该是）静态方法；但是，您可以将其设为单例，并且这些方法中的每一个都可以在实例上调用类似名称的私有方法（_getUserByID()、_getAllActiveUsers()）。该实例可以管理您的数据库连接，然后您可以在将来扩展它以处理缓存等。

然后，如果您愿意，您可以将您的模型分解为一个干净的“接口”（即应用程序的其余部分只知道用户的“公共”接口），并且您的工厂可以决定实例化哪个实际类，只要因为它符合用户界面。这是非常灵活的，因为您的模型细节会随着时间而变化。

# ant - 如何在命令行上从属性文件加载 Ant 属性？

> ID：11347623
> 
> 赞同：13
> 
> 时间：2012-07-05T15:29:41.783
> 
> 标签：ant, properties, build

我有两个属性文件 [`one.properties`和`two.properties`]。我想从命令行将属性文件动态加载到我的 Ant 项目中。

我的构建文件名为 build.xml。

命令行：

```
> ant build [How do I pass the property file names here?] 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-05T19:18:34.820

# [从命令行加载属性文件](http://ant.apache.org/manual/running.html)

```
ant -propertyfile one.properties -propertyfile two.properties 
```

`-D`可以使用以下标志在命令行上定义各个属性：

```
ant -Dmy.property=42 
```

# 从 Ant 项目中加载属性文件

## [LoadProperties Ant 任务](http://ant.apache.org/manual/Tasks/loadproperties.html)

```
<loadproperties srcfile="one.properties" />
<loadproperties srcfile="two.properties" /> 
```

## [属性 Ant 任务](http://ant.apache.org/manual/Tasks/property.html)

```
<property file="one.properties" />
<property file="two.properties" /> 
```

## [使用模式匹配属性文件](https://stackoverflow.com/questions/4983439/ant-load-properties-from-pattern)

[JB Nizet 的](https://stackoverflow.com/users/571407/jb-nizet)解决方案结合了[concat](http://ant.apache.org/manual/Tasks/concat.html)和[fileset](http://ant.apache.org/manual/Types/fileset.html)：

```
<target name="init" description="Initialize the project.">
  <mkdir dir="temp" />
  <concat destfile="temp/combined.properties" fixlastline="true">
    <fileset dir="." includes="*.properties" />
  </concat>
  <property file="temp/combined.properties" />
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-17T15:00:10.633

制作一个构建[条件](https://ant.apache.org/manual/Tasks/condition.html)，如果为构建提供了必需的系统参数，那么只允许下一个目标，否则构建会失败。

```
 Pass CMD: ant -DclientName=Name1 -Dtarget.profile.evn=dev
 Fail CMD: ant 
```

```
<project name="MyProject" default="myTarget" basedir=".">
    <target name="checkParams">
        <condition property="isReqParamsProvided">
            <and>
                <isset property="clientName" /> <!-- if provide read latest else read form property tag -->
                <length string="${clientName}" when="greater" length="0" />
                <isset property="target.profile.evn" /> <!-- mvn clean install -Pdev -->
                <length string="${target.profile.evn}" when="greater" length="0" />
            </and>
        </condition>
        <echo>Runtime Sytem Properties:</echo>
        <echo>client              = ${clientName}</echo>
        <echo>target.profile.evn  = ${target.profile.evn}</echo>
        <echo>isReqParamsProvided = ${isReqParamsProvided}</echo>
        <echo>Java/JVM version: ${ant.java.version}</echo> 
    </target>

    <target name="failOn_InSufficentParams" depends="checkParams" unless="isReqParamsProvided">
        <fail>Invalid params for provided for Build.</fail>
    </target>

    <target name="myTarget" depends="failOn_InSufficentParams">
        <echo>Build Success.</echo>
    </target>
</project> 
```

@另见：[替换所有令牌表单文件](https://stackoverflow.com/a/60264842/5081877)

# php - 强制浏览器缓存一个 .php

> ID：11347624
> 
> 赞同：3
> 
> 时间：2012-07-05T15:29:42.817
> 
> 标签：php, http-headers

我需要浏览器缓存一个大的、主要是静态的 .php 文件。我通过 ajax 打开它并想将它添加到当前页面。

经过一番研究，如果发现[这个](http://www.electrictoolbox.com/php-caching-headers/)

```
$seconds_to_cache = 3600;
$ts = gmdate("D, d M Y H:i:s", time() + $seconds_to_cache) . " GMT";
header("Expires: $ts");
header("Pragma: cache");
header("Cache-Control: max-age=$seconds_to_cache"); 
```

这适用于 IE，但不适用于 chrome 和 firefox。

这是请求

```
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language de-de,de;q=0.8,en-us;q=0.5,en;q=0.3
Cache-Control   max-age=0
Connection  keep-alive
Content-Type    application/x-www-form-urlencoded
Cookie  PHPSESSID=5dkvr42f4it8pnnnqpesj6l413
Host    localhost
Referer http://localhost/mifa/Suche.php
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1
charset utf-8 
```

这里是响应头

```
Cache-Control   max-age=3600
Connection  Keep-Alive
Content-Type    text/html
Date    Thu, 05 Jul 2012 15:28:22 GMT
Expires Thu, 05 Jul 2012 16:28:22 GMT
Keep-Alive  timeout=5, max=91
Pragma  cache
Server  Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1
Transfer-Encoding   chunked
X-Powered-By    PHP/5.3.8 
```

我需要改变什么？

**编辑**

显然，只有 IE 不会将 Cache-Control max-age=0 附加到请求中。

这是请求的JS函数

```
url = "includes/Orte.php";
obj.onreadystatechange = rState;
obj.open("GET", url, true);
obj.setRequestHeader("Pragma", "");
obj.setRequestHeader("Cache-Control", "");
obj.setRequestHeader("charset", "utf-8");
obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
obj.setRequestHeader("Connection", "close");
obj.send();

function rState(){
    if(obj.readyState == 4){
        if (obj.status == 200){
            //alert("Response Text Ajax:\n" + obj.responseText + "\nEnd Response Text");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:41:38.403

请求中的`Cache-Control: max-age=0`标头意味着您要求浏览器刷新页面，因此他只是忽略了缓存。

在不点击刷新的情况下访问页面（例如，聚焦地址栏并点击回车）以避免这种情况。

此外，如果页面位于 HTTPS URL 上，您可能必须添加`public`到 Cache-Control 标头，否则某些浏览器不会缓存它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:39:26.000

想到的两件事是最后修改的标头和使用 .htaccess 缓存控制。后者适用于广泛的类型，但您可以将其仅用于一个文件夹，该文件本身位于一个文件夹中。

```
header("Last-Modified: ... "); 
```

# c# - NHibernate 类映射 代码不执行

> ID：11347626
> 
> 赞同：2
> 
> 时间：2012-07-05T15:29:48.753
> 
> 标签：c#, nhibernate, nhibernate-mapping, structuremap

我正在建立一个新项目，并让 NHibernate 使用结构映射...排序。我正在使用带有 ClassMaps 的 NHibernate.Mapping.ByCode.Conformist 设置。没有错误发生，但是当我查询会话并且数据库中存在特定类型的记录时，什么也没有返回。经过进一步检查，我为这些类型设置的映射似乎没有执行。这是我的代码，用于连接结构图。我可以确认它正在执行。

```
public class OrmRegistry : Registry
{
    public OrmRegistry()
    {
        var sessionFactory = BuildSessionFactory();
        For<ISessionFactory>().Singleton().Use(sessionFactory);
        For<ISession>().HybridHttpOrThreadLocalScoped().Use(s => sessionFactory.OpenSession());            

    }

    public ISessionFactory BuildSessionFactory()
    {
        var cfg = new Configuration().DataBaseIntegration(db =>
                                                              {
                                                                  db.ConnectionStringName = "LocalSqlServer";
                                                                  db.Dialect<MsSql2008Dialect>();
                                                                  db.Driver<SqlClientDriver>();
                                                                  db.KeywordsAutoImport = Hbm2DDLKeyWords.AutoQuote;
                                                                  db.IsolationLevel = IsolationLevel.ReadUncommitted;
                                                                  db.BatchSize = 500;
                                                              }).AddAssembly(Assembly.GetExecutingAssembly());

        if(HttpContext.Current != null)
        {
            cfg.CurrentSessionContext<WebSessionContext>();
        }
        else
        {
            cfg.CurrentSessionContext<ThreadStaticSessionContext>();
        }
        return cfg.BuildSessionFactory();
    }
} 
```

我几乎可以肯定我只是在这里遗漏了一些非常明显的东西，但是我已经看了几个小时并且没有取得任何成功。前几天我也变小了，所以我周围没有同事看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:54:29.127

看起来你已经初始化了你的配置，但是映射呢？您需要像这样初始化映射（如果您使用约定）：

```
var mapper = new ConventionModelMapper();

// TODO: define conventions here using mapper instance

// just an example on how I have been using it
var entities = ... // get all entity types here
cfg.AddDeserializedMapping(mapper.CompileMappingFor(entities), "MyMappings");

return cfg.BuildSessionFactory(); 
```

如果您正在使用映射类（来自这篇[文章](http://x-driven.blogspot.com/2011/12/nhibernate-mapping-by-code.html)），还有另一个例子：

```
var mapper = new ModelMapper();
var mappingTypes = typeof (InvoiceMapping).Assembly.GetExportedTypes()
    .Where(t => t.Name.EndsWith("Mapping")).ToArray();
mapper.AddMappings(mappingTypes);

cfg.AddMapping(mapper.CompileMappingForAllExplicitlyAddedEntities());

return cfg.BuildSessionFactory(); 
```

# java - 记录类的 JAVA_HOME 问题

> ID：11347631
> 
> 赞同：2
> 
> 时间：2012-07-05T15:30:09.683
> 
> 标签：java, logging, java-home

即使我的 JAVA_HOME 设置正确，我也会收到以下错误。

C:\workspace-sts-2.8.0.RELEASE\JBClient\target>echo %JAVA_HOME%

C:\jdk1.6.0_31

我没有做任何日志记录我只是在我的类路径上有以下依赖项（连同 JRE）

```
 - concurrent.jar 
 - hornetq-core-client-java5.jar
 - hornetq-jms-client-java5.jar 
 - jboss-aop-client.jar
 - jboss-aspect-jdk50-client.jar jboss-client.jar jboss-common-core.jar
 - jboss-ejb3-common-client.jar jboss-ejb3-core-client.jar
 - jboss-ejb3-proxy-impl-client.jar jboss-ejb3-proxy-spi-client.jar
 - jboss-ejb3-security-client.jar jboss-integration.jar jboss-javaee.jar
 - jboss-logging.jar jboss-remoting.jar jboss-security-spi.jar
 - jbossall-client.jar jbosssx-client.jar jnp-client.jar

Exception in thread "main" java.lang.Error: Can't find java.home ??
    at java.util.logging.LogManager.readConfiguration(Unknown Source)
    at java.util.logging.LogManager$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.logging.LogManager.readPrimordialConfiguration(Unknown Source)
    at java.util.logging.LogManager.getLogManager(Unknown Source)
    at java.util.logging.Logger.<init>(Unknown Source)
    at java.util.logging.LogManager$RootLogger.<init>(Unknown Source)
    at java.util.logging.LogManager$RootLogger.<init>(Unknown Source)
    at java.util.logging.LogManager$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.logging.LogManager.<clinit>(Unknown Source)
    at java.util.logging.Logger.getLogger(Unknown Source)
    at com.sun.jmx.remote.util.ClassLogger.<init>(Unknown Source)
    at javax.management.remote.JMXServiceURL.<clinit>(Unknown Source)
    at main.java.JBClient.main(Unknown Source)
Exception in thread "Thread-0" java.lang.NoClassDefFoundError: Could not initialize class java.util.logging.LogManager
    at java.util.logging.LogManager$Cleaner.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:45:42.397

您不是在代码中较早的地方清理/设置系统属性吗？`java.util.logging.LogManager.readConfiguration`如果找不到`java.home`系统属性，则会引发此错误。

检查这个[答案](https://stackoverflow.com/questions/5359774/log4j-email-error-cannot-find-java-home)- 虽然不是完全重复（类不同），但它似乎是同一种问题。

# java - 是否有适用于 Maven 的 Java 持续测试插件？

> ID：11347633
> 
> 赞同：18
> 
> 时间：2012-07-05T15:30:12.840
> 
> 标签：java, maven, continuous-testing

我正在寻找一个可以在控制台中连续运行以扫描 Maven 项目的测试源目录的插件，并且当它检测到更改时会启动测试周期。类似于`mvn scala:cc`Scala Build Tool 的东西，但用于 Java。谁能指点我一个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T15:47:26.043

我个人甚至将 sbt 用于仅用于持续测试功能的仅 java 项目。

我在基于 maven 的项目中添加了一个 sbt 构建文件，并在开发时使用 sbt，但在构建最终包、启动嵌入式码头等时使用 maven，效果很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T12:47:35.823

我刚刚发现[scala-maven-plugin](http://davidb.github.com/scala-maven-plugin/index.html)支持持续编译和测试，以及交叉编译（Java + Scala）。因此，可以在纯 Java 构建上使用它并获得所有持续构建的优点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-20T20:18:25.093

最近，我需要一个解决方案。一直在学习 scala 并发现 sbt ~test 的优点，我想将它应用到**没有持续测试的 Java 项目中**。

使用您提到的 scala-maven-plugin，我创建了一个 github 种子，**每次保存 Java 源代码或 Java 测试时都会运行 Java Junit 测试**。

看看： [https ://github.com/ailveen/maven-scala-java-continuous-test](https://github.com/ailveen/maven-scala-java-continuous-test)

该项目现在非常简单（仅包含 Java 文件，因为这是我当前的需要），但将来我希望添加 scala 测试（或 specs2 或 scalacheck），以便它与混合的 java 和 scala 文件一起使用。

希望你觉得它有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-15T22:40:53.700

它不完全适用于 Maven，但[JUnit Max](http://junitmax.com/)会进行持续测试，如果您使用的是 Eclipse，它可能是您想要查看的工具

# java - Android Sprite Animation Move To position X（应该很简单，但我卡住了）

> ID：11347634
> 
> 赞同：0
> 
> 时间：2012-07-05T15:30:15.217
> 
> 标签：java, android, animation, view, sprite

当在屏幕上向右或向左按下时，我正在尝试移动精灵以将帧停止在中心（或将它们移动到某个 x 位置）。视图中有 3 个使用 box.java 创建的精灵，一个接一个地放置，带有填充，存储在 arraylist 中。

**问题：**没有平滑的移动，并且在移动开始后不会在每个帧的中心停止，有时所有的框都在彼此之上移动，填充完全丢失。请让我知道我做错了什么，非常感谢！

```
//BEGINING OF BOX.JAVA >> The problem is in this class!

//This goes in Update();
private void boxMove()
{
           int get_moved_pos = getMovedPos();   //get moved pos
           int sprite_size = view.getSpriteSize(); //get sprite arraylist size
           currentDirection = view.getDirection(); //get direction "left" or "right" from view

                if(currentDirection == "right" && isMoving == false)
                {
                        setSpriteMovedNext();
                }else
                if(currentDirection == "left" && isMoving == false)
                {
                        setSpriteMovedPrev();
                }

                if(currentDirection != lastDirection)
                {
                            lastDirection = currentDirection;

                            //MOVE RIGHT
                            if(currentDirection == "right" && get_moved_pos > 0)    //move left and make sure that moved pos isn't overlapping / or moving to empty space
                            {

                                //Animate left until it reaches the new x position                  
                                if(x > get_new_pos_left)
                                {
                                    x -= pSpeedX;
                                }

                                Log.d("RIGHT","POS: " + get_moved_pos);

                            }else

                            //MOVE LEFT
                            if(currentDirection == "left" && get_moved_pos < sprite_size-1) //move left and make sure that moved pos isn't overlapping / or moving to empty space
                            {
                                //Animate right until it reaches the new x position                 
                                if(x < get_new_pos_right)
                                {
                                    x += pSpeedX;
                                }

                            }
                }

}

        //Call when screen is touched (in View.java), to set a new position to move to.
       public void resetMoving()
       {
           isMoving = false;
            this.lastDirection      = "";
           Log.d("RESET", "MOVING RESET");
       }

       public int getMovedPos()
       {
           return this.smoved_pos;
       }

       private void setSpriteMovedNext()
       {
           int get_max_moved = getMovedPos();
           int s_size = view.getSpriteSize();

           if (isMoving == false) //take a break between movements
           {
                if(get_max_moved < s_size-1)
                {
                    Log.d("NEXT", "CALLED");
                    this.get_new_pos_right  = x + view.getNextPosX();   //current x and next stop position
                    this.smoved_pos     += 1;
                    this.isMoving       = true; //set to avoid double touch
                    Log.d("NEXT", "X POS SET: " + get_max_moved);
                }
           }
       }

       private void setSpriteMovedPrev()
       {
           int get_max_moved = getMovedPos();

           if (isMoving == false) //take a break between movements
           {
               if(get_max_moved > 0)
               {
                   Log.d("PREV", "CALLED");
                   this.get_new_pos_left    = x - view.getNextPosX(); //get current x pos and prev stop position
                   this.smoved_pos          -= 1;   //to limit the movements
                   this.isMoving            = true; //set to avoid double touch
                   Log.d("PREV", "X POS SET: " + get_max_moved);
               }
           }
       } 
```

//BOX.JAVA结束

//看法

```
 //Add boxes
   public void addBox()
   {
       int TOTAL_BOXES = 3;
       int padding_left = 200;
       int padding_tmp =  this.getWidth()/2;

       box.clear(); //clear old

       //Box 1
       box.add(new Boxes(box, this, "box1", 
               padding_tmp,
               this.getHeight()/2, 
               boxSpriteImage, 1, 2, 0, 0));       

       padding_tmp += boxSpriteImage.getWidth()/TOTAL_BOXES + padding_left;

       //Box 2
       box.add(new Boxes(box, this, "box2", 
               padding_tmp, 
               this.getHeight()/2, 
               boxSpriteImage, 1, 2, 1, 1));       

       padding_tmp += boxSpriteImage.getWidth()/TOTAL_BOXES + padding_left;

       //Box 3
       box.add(new Boxes(box, this, "box3", 
               padding_tmp, 
               this.getHeight()/2, 
               boxSpriteImage, 1, 2, 2, 1));       

   }

public boolean onTouchEvent(MotionEvent event){
     if (System.currentTimeMillis() - lastClick > 100){
            lastClick = System.currentTimeMillis();
            float x = event.getX();
            float y = event.getY();
            synchronized (getHolder()) 
            {

            if(isBoxWindow() == true)
            {

                if(x >= this.getWidth()/2)
                {
                    Direction = "right";
                }else
                {
                    Direction = "left";
                } 
    }
        }
 }

//called in box.java to get next x pos to move
public float getNextPosX()
{
       int PADDING = 200; //padding between frames
       next_pos_x = boxSprite.getWidth()/TOTAL_COLUMNS + PADDING;
       return next_pos_x;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:46:54.363

我认为您的错误出在`if`语句中，您使用运算符将`currentDirection`​​ and `lastDirection`（我假设`lastDirection`是 a `String`）与其他`String`s 进行比较`==`。当`==`您想比较`Object`s 是否相等时，几乎运算符永远不会起作用。您应该使用该`equals()`方法。

例如。

```
if(currentDirection != lastDirection) 
```

应该写成：

```
if(!currentDirection.equals(lastDirection) 
```

在您的代码中进行此类更改（很多地方都需要它们！）我认为您的问题应该得到解决。

一个好的调试实践是从每个 if 块中记录有关您的应用程序的数据，以查看它们是否都已执行。您可能已经发现您的`if`语句是否正在执行。

**编辑：**你为什么放这个代码？

```
if (System.currentTimeMillis() - lastClick > 100) 
```

这意味着`onTouchEvent`s 仅在 100 毫秒后被解释。删除它并检查，可能这就是导致问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T21:59:20.053

Alrite 决定使用 onFling() 方法并通过 View 调用而不是将动画单独添加到类本身中，当在所有添加的框的循环中调用 box.get(i).update() 时效果非常好，所有这些框动画一样。谢谢 udiboy。

# java - Apache HttpComponents：org.apache.http.client.ClientProtocolException

> ID：11347635
> 
> 赞同：2
> 
> 时间：2012-07-05T15:30:15.533
> 
> 标签：java, http, apache-httpcomponents

所以我使用 apache HttpComponents 来处理 java 中的 http 请求。现在我想重用`DefaultHttpClient`，根据这个例子应该有什么可能：[http](http://wiki.apache.org/HttpComponents/QuickStart) ://wiki.apache.org/HttpComponents/QuickStart 。该示例本身给出了一个 ssl 错误，因此我对其进行了一些修改和简化。现在我总是得到一个`org.apache.http.client.ClientProtocolException`

这是我的示例程序，基本上我只是请求 2 个网页使用相同的`DefaultHttpClient`.

```
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

public class ClientFormLogin {

    public static void main(String[] args) throws Exception {

        DefaultHttpClient httpclient = new DefaultHttpClient();

        //Handle first request.
        HttpGet httpget = new HttpGet("http://tweakers.net/nieuws/82969/amazon-nederland-opent-digitale-deuren-in-september.html");
        HttpResponse response = httpclient.execute(httpget);
        System.out.println("Execute finished");
        HttpEntity entity = response.getEntity();
        String page = readInput(entity.getContent());
        System.out.println("Request one finished without problems!");

        //Handle second request
        HttpGet httpost = new HttpGet("http://gathering.tweakers.net/forum/list_messages/1506977/last");
        response = httpclient.execute(httpost);
        entity = response.getEntity();
        page = readInput(entity.getContent());
        System.out.println("Request two finished without problems!");
    }

    private static String readInput(InputStream in) throws IOException {
        ByteArrayOutputStream out = new ByteArrayOutputStream();
        byte bytes[] = new byte[1024];

        int n = in.read(bytes);

        while (n != -1) {
            out.write(bytes, 0, n);
            n = in.read(bytes);
        }

        return new String(out.toString());
    }
} 
```

运行我的示例时，出现以下错误

```
Request one finished without problems!
Exception in thread "main" org.apache.http.client.ClientProtocolException
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:909)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:805)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:784)
    at ClientFormLogin.main(ClientFormLogin.java:29)
Caused by: org.apache.http.HttpException: Unable to establish route: planned = {}->http://gathering.tweakers.net; current = {}->http://tweakers.net
    at org.apache.http.impl.client.DefaultRequestDirector.establishRoute(DefaultRequestDirector.java:842)
    at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:645)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:480)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:906)
    ... 3 more 
```

任何人都可以给我一些指示如何解决这个问题，除了`DefaultHttpClient`为每个请求使用一个新的。

* * *

**编辑**

我刚刚发现如果我留在同一个域上我没有问题，所以：

```
page1: 'http://tweakers.net/nieuws/82969/amazon-nederland-opent-digitale-deuren-in-september.html'
page2: 'http://tweakers.net/nieuws/82973/website-nujij-belandt-op-zwarte-lijst-google-door-malware.html' 
```

如果我必须这样做，我没有问题：

```
page1: 'http://tweakers.net/nieuws/82969/amazon-nederland-opent-digitale-deuren-in-september.html'
page2: 'http://gathering.tweakers.net/forum/list_messages/1506076/last' 
```

我得到了错误。

Ofc 我在发布我的问题后一分钟看到了这个。除非有人能告诉我如何去 2 个具有相同问题的独立域，否则`DefaultHttpClient`我的问题已经得到解答。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T17:25:59.723

这可能是由于最近 v4.2 BasicClientConnectionManager 中的一个错误影响了跨站点重定向。请参阅[http://issues.apache.org/jira/browse/HTTPCLIENT-1193](http://issues.apache.org/jira/browse/HTTPCLIENT-1193)。

根据维护者的说法，一种临时解决方法是使用 SingleClientConnManager 或 PoolingClientConnectionManager。也许是这样的：

```
ClientConnectionManager connManager = new PoolingClientConnectionManager();
DefaultHttpClient httpclient = new DefaultHttpClient(connManager);
... 
```

# c# - 实体框架在使用 Find() 时生成效率低下的选择

> ID：11347637
> 
> 赞同：3
> 
> 时间：2012-07-05T15:30:25.197
> 
> 标签：c#, sql-server, entity-framework

我注意到实体框架在使用该`Find()`方法时会生成一些低效的查询。例如，这是我的 C# 代码。

```
Model model = unit.Repository.DbSet.Find(model.ID); 
```

**生成 Find() 查询**

```
DECLARE @p0 int = 1

SELECT 
[Limit1].[ID] AS [ID], 
[Limit1].[UserID] AS [UserID], 
[Limit1].[Started] AS [Started], 
[Limit1].[Updated] AS [Updated], 
[Limit1].[Completed] AS [Completed]
FROM ( SELECT TOP (2) 
        [Extent1].[ID] AS [ID], 
        [Extent1].[UserID] AS [UserID], 
        [Extent1].[Started] AS [Started], 
        [Extent1].[Updated] AS [Updated], 
        [Extent1].[Completed] AS [Completed]
        FROM [dbo].[Table] AS [Extent1]
        WHERE [Extent1].[ID] = @p0
)  AS [Limit1] 
```

它似乎正在运行另一个不必要的选择查询。这是使用该`SingleOrDefault()`方法的输出。

**生成 SingleOrDefault() 查询**

```
DECLARE @p__linq__0 int = 1

SELECT TOP (2) 
[Extent1].[ID] AS [ID], 
[Extent1].[UserID] AS [UserID], 
[Extent1].[Started] AS [Started], 
[Extent1].[Updated] AS [Updated], 
[Extent1].[Completed] AS [Completed]
FROM [dbo].[Table] AS [Extent1]
WHERE [Extent1].[ID] = @p__linq__0 
```

`Find()`生成两个选择是否有原因？是否应该`Find()`避免该方法以支持该`SingleOrDefault()`方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T16:36:20.543

我怀疑两者之间有任何性能差异，至少对于 sql server。看起来第一个在选择周围有一个额外的包装器。在我已经生成完全相同的计划的数据库上运行类似的查询，所以我可以想象外部选择在执行计划中得到优化。

# jboss - JBoss 6.1.0.Final 和 ActiveMQ 5.6.0 - 任何解决 AMQ-3868 的方法？

> ID：11347638
> 
> 赞同：1
> 
> 时间：2012-07-05T15:30:26.320
> 
> 标签：jboss, activemq

理想情况下，我想将 ActiveMQ 5.6.0 添加到我的 JBoss 6.1.0.Final 中。

但是你当然会点击：[https ://issues.apache.org/jira/browse/AMQ-3868](https://issues.apache.org/jira/browse/AMQ-3868)

由于一些库冲突。

有没有办法使用类加载隔离来解决这个问题？或任何其他解决此问题的方法？

# ruby-on-rails - 如何在 Rails3 中将隐藏参数传递给控制器

> ID：11347646
> 
> 赞同：0
> 
> 时间：2012-07-05T15:30:46.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3, view, parameter-passing

我想将参数传递`recipient`给控制器​​。我可以像这样在我的视图中显示它：

```
@recipient.username 
```

如何将此值传递给`params[:message][:recipient]`？请注意，我没有名为“消息”的模型。

控制器/messages_controller.rb

```
def deliver
  recipient = User.find_by_username(params[:recipient])
  subject = params[:subject]
  body = params[:body]

  current_user.send_message(recipient, body, subject)
  redirect_to :controller => 'messages', :action => 'received' 
  flash[:notice] = "message sent!"
end 
```

意见/消息/new.html.erb

```
<td><%= @recipient.username if @recipient %></td>

<%=form_for :messages, url: url_for( :controller => :messages, :action => :deliver ) do |f| %>
  <div class="field">
    <%= f.label :subject %><br />
    <%= f.text_field :subject %>
  </div> 

  <div class="field">
    <%= f.label :body %><br />
    <%= f.text_field :body %>
  </div>

  <div class="actions">
    <%= f.submit %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:38:50.717

您可以通过为您的收件人分配一个 attr_accessible 密钥并将其分配给表单来完成此操作。

```
form_for :message do |f|
  f.hidden_field :recipient_id, :value => @recipient.id.to_i
  f.text_field :message
  f.submit
end 
```

一旦你将它传递给你的创建操作，你就可以检查 params[:message][:recipient_id]

并将其传递给数据库。

玩得开心

# c# - 如何将 MenuItem 从一个 ContextMenu 复制到另一个 ContextMenu

> ID：11347647
> 
> 赞同：4
> 
> 时间：2012-07-05T15:30:46.710
> 
> 标签：c#, wpf, contextmenu, menuitem

如何复制我在一个 ContextMenu 中创建的 MenuItem 并复制它以便我可以在第二个 ContextMenu 中使用它？

我试图直接复制它并删除它，但我得到*Element 已经有一个逻辑父级。在附加到新的父级之前，它必须与旧的父级分离。*

```
foreach(MenuItem mi in menuOptions.Items) { 
    entityRightClick.Items.Add(mi);
    menuOptions.Items.Remove(mi);
} 
```

我尝试使用 ItemContainerGenerator 抓取 MenuItem，它给了我一个空白的 MenuItem（调试器说它是空的）

```
for(int i = 0; i < menuOptions.Items.Count; i++) {
    MenuItem temp = new MenuItem();
    temp = menuOptions.ItemContainerGenerator.ContainerFromIndex(i) as MenuItem;
    entityRightClick.Items.Add(temp);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:33:38.237

根据您的错误消息，我希望这可以工作（尽管我还没有测试过）：

```
foreach(MenuItem mi in menuOptions.Items) 
{      
     menuOptions.Items.Remove(mi);
     entityRightClick.Items.Add(mi);
 } 
```

# winapi - 有没有办法防止 TaskDialog 包装 pszContent？

> ID：11347651
> 
> 赞同：3
> 
> 时间：2012-07-05T15:30:51.800
> 
> 标签：winapi, taskdialog

很多时候，当我们的应用程序使用 TaskDialog 来显示一个简单的对话框时，Windows 会将 pszContent 的最后一个单词换行到第二行。在这些情况下，我们更希望将对话框稍微加宽，并将 pszContent 保持在一行。

任何人都知道这是否可以在不向对话框添加其他按钮的情况下实现？（这是我在网上搜索后发现的唯一解决方法。对我来说不是一个可接受的解决方法。）

![我想避免的愚蠢包装的例子。](../Images/e66aa726af301ff95d9cb72b3138aaec.png)

# asp.net-mvc-3 - 视图未更新

> ID：11347652
> 
> 赞同：0
> 
> 时间：2012-07-05T15:30:57.607
> 
> 标签：asp.net-mvc-3, razor

在我的应用程序中，主视图加载了 _Layout.vbhtml 母版页。我渲染了几个部分，默认值`contractNumber`被正确打印出来。当我更改模型时`contractNumber`，视图不会反映更改并显示默认值。这是我`Index.vbhtml`文件中调用模型的部分的代码：

```
 @Section  CUInfo 
Contract Number: @Model.contractNumber

 End Section 
```

在我的 _Layout.vbhtml 页面中，我有：

```
@RenderSection("CUInfo", required:=True) 
```

我知道其中`contractNumber`有正确的值，当我单步执行代码时，它会越过这`@Model.contractNumber`条线。

# c# - 对用户控件执行操作后，如何调用 Web 服务？

> ID：11347654
> 
> 赞同：0
> 
> 时间：2012-07-05T15:30:58.173
> 
> 标签：c#, javascript, .net, web-services, user-controls

当用户单击由 .NET (WEbForms) 用户控件生成的复选框时，我想调用 Web 服务函数 (.asmx)：

```
CheckBox chb = new CheckBox();
chb.InputAttributes.Add("value", "my_id_00");
chb.Text = "Title 00";
myPanel.Controls.Add(chb); 
```

并传递参数“值”（so, `my_id_00`）。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T00:36:56.030

您可以通过多种方式做到这一点：

1) 为每个复选框添加一个 JavaScript onClick 事件。JavaScript 函数可以调用 web 服务。

```
chb.Attributes.Add("onclick", String.Format("CallMyWebService({0});", "my_id_00");

<script type="text/javascript">
    function CallMyWebService(value){
        //Code to Call Web Service passing value
    }
</script> 
```

2）为复选框添加服务器端事件处理程序。事件处理程序提取值并调用 web 服务

```
chb.CheckedChanged += new EventHandler(chkBox_CheckedChanged); 
```

3) 如果 JQuery 是一个选项，则将 Javascript onClick 函数附加到页面就绪事件上的每个复选框。

# haskell - 正确的混叠控制单子

> ID：11347655
> 
> 赞同：1
> 
> 时间：2012-07-05T15:30:59.393
> 
> 标签：haskell, monads, monad-transformers

我有一个返回用户 ID 的单子函数：

```
do
 id <- getUserId 
```

我需要能够在 getUserId 上“叠加”一个函数，该函数查找并返回 getUserId 返回的值的别名

显然，我可以编写一个特定的函数 getAlias 并重写 monad 本身：

```
do
 id <- getAlias getUserId 
```

但是我觉得这可以通过将 getAlias 隐藏在 monad 的绑定函数中来更普遍、可重用和不可见地完成。

Monad Transformers 是否执行此功能，即将内部 monad 的绑定函数与外部 monad 的绑定函数组合在一起？或者我需要一些其他的控制结构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T17:01:28.630

我真的不认为你可以在这里得到比函数应用程序更轻的重量。要回答您的直接问题：

1.  是的，monad 转换器结合了转换器和底层 monad 的绑定功能。
2.  不，一般来说，你不能结合两个 monad 的绑定函数并产生另一个 monad 的绑定函数。

但我认为这两个直接答案中的任何一个都不重要，因为`getAlias`不太可能成为任何守法单子的约束。（至少，绑定函数必须是非常多态的，这`getAlias`不是！）。

# php - 在php中将参数传递给bat（或vbs）

> ID：11347661
> 
> 赞同：1
> 
> 时间：2012-07-05T15:31:08.207
> 
> 标签：php, vbscript, batch-file

**Objective:**使用 PHP 调用 vbs 将 xls/xlsx 文件转换为 csv。

**问题：**如何将源文件路径和目标文件路径传递给将 xls/xlsx 转换为 csv 并在 PHP Web 应用程序中运行该 vbs 的 vbs？

**详细信息：**我有一个工作 vbs，它采用源文件路径和目标文件路径，并将源文件路径中的 xls/xlsx 转换为 csv。我可以从 Windows cmd 行执行它，它完全符合我的要求。我也可以把执行命令放到一个bat文件中，运行bat文件也可以达到同样的效果。但是，当我在 PHP 中使用 exec()/shell_exec()/system() 执行相同的命令时，不会创建 csv。（如果我尝试使用 system() 从 PHP 运行 bat，bat 文件的内容会显示在页面上，实际上，echo Conversion complete！打印“echo Conversion complete！ Conversion complete。”）我还没有看到任何内容错误呢。

**注意：**我知道 PHPExcel，我不想使用它。

**excelToCsv.vbs**

```
On Error Resume Next
if WScript.Arguments.Count < 2 Then WScript.Echo "Please specify the source and the destination files. Usage: ExcelToCsv <xls/xlsx source file> <csv destination file>"
Wscript.Quit
End If
csv_format = 6
Set objFSO = CreateObject("Scripting.FileSystemObject")
src_file = objFSO.GetAbsolutePathName(Wscript.Arguments.Item(0))
dest_file = objFSO.GetAbsolutePathName(WScript.Arguments.Item(1))
Dim oExcel
Set oExcel = CreateObject("Excel.Application")
Dim oBook
Set oBook = oExcel.Workbooks.Open(src_file)
oBook.SaveAs dest_file, csv_format
oBook.Close False
oExcel.Quit 
```

**batConverter.bat**

```
excelToCsv.vbs conversionTestSourceMS2003.xls batTest.csv
echo Conversion Complete! 
```

**索引.phtml**

```
<?php
system("cmd /c batConvert.bat")
?> 
```

**注意：**以上所有文件（连同conversionTestSourceMS2003.xls）都在同一个目录中。我还没有实现任何传递参数的方法（因为即使它都是硬编码的，我也无法让它工作......）

**设置：** PHP5、Zend 框架、WAMP、Windows 7（本地主机）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T16:49:07.437

为简单起见，我将所有内容合并到一个 ASP 页面中。这将使我有希望在 IIS 中看到类似的问题，并且由于它在单个 ASP 脚本中，我将能够更直接地看到错误。我的测试机器在 IIS7 上的 Windows Vista SP2 和 Excel 2007 SP3 上运行。

**excelToCsv.asp**

```
<%

Option Explicit

Dim csv_format, src_file, dest_file, strPath, objFSO

csv_format = 6
src_file = "conversionTestSourceMS2003.xls"
dest_file = "testbat.csv"

strPath = "[HARDCODED PATH HERE]\"
src_file = strPath & src_file
dest_file = strPath & dest_file

Dim objExcel, objBook
Set objExcel = CreateObject("Excel.Application")

Set objBook = objExcel.Workbooks.Open(src_file)
objBook.SaveAs dest_file, csv_format
objBook.Close False

Response.Write "Conversion Complete!"
objExcel.Quit

%> 
```

运行此代码时，我得到一个通用的 ASP 错误。所以，我[在 ASP 中启用了详细的错误消息](http://blogs.iis.net/thomad/archive/2007/02/06/security-is-painful.aspx)，我收到以下错误...

> Microsoft Office Excel 错误“800a03ec”
> 
> Microsoft Office Excel 无法访问文件“[HARDCODED PATH HERE]\conversionTestSourceMS2003.xls”。有几个可能的原因： • 文件名或路径不存在。• 该文件正被另一个程序使用。• 您尝试保存的工作簿与当前打开的工作簿同名。
> 
> /temp/ExcelToCsv.asp，第 18 行

现在，这不是 Apache，但我相信这个问题与你的有关。此错误意味着存在安全/权限问题，Excel 无法执行访问或读取文件所需的操作。事实上，当我从 PHP（在 IIS 中）执行 VBScript（并将错误向上传递）时，我遇到了类似的错误。

我相信可以通过更改用于创建进程的 Windows 用户来解决它。这可以通过编辑 Apache 服务并将“[登录”](http://msdn.microsoft.com/en-us/library/ms677948%28v=vs.85%29.aspx)选项卡更改为实际的 Windows 用户而不是服务帐户来在 Services.msc 中进行配置。不过，我还没有对其进行测试，因为我现在无法设置 Apache。

# c# - 证券交易所指数应该是双数还是小数？

> ID：11347663
> 
> 赞同：3
> 
> 时间：2012-07-05T15:31:11.933
> 
> 标签：c#, real-time, hft

我在计算，比如说，纳斯达克指数。

所有股票价格都是十进制的，我可以将重量设为十进制或双倍 - 没关系。

纳斯达克 = weight1 * stock1 + weight2 * stock2 + .... + weightn * stockn。

由于股票价格是十进制的，因此将纳斯达克指数设为十进制似乎是有意义的。但我不想每次更新某些股票时都重新计算纳斯达克指数。相反，我想“缓存”以前的值，然后只计算差异。例如，如果 stock2 更改，则：

```
stock2OldPrice = stocks[2];
diff = stock2 - stock2OldPrice
nasdaq += diff * weight2     // need to synchronize
stocks[2] = stock2 
```

现在我需要同步纳斯达克指数，因为股票可以同时更新。例如，我可以在并行线程中收到 MSFT 和 INTC 的新价格。所以我必须写`Interlocked.Add(ref nasdaq, diff * weight2);`参考我之前的问题[如何使用无锁代码同步来自不同线程的添加？](https://stackoverflow.com/questions/11345634/how-to-synchronize-addition-from-different-threads-using-lock-free-code) 但是我不能这样做，`decimal`因为不支持小数。

好的，让我们尝试将`nasdaq`索引声明为`double`? 使用双打我可以做到`Interlocked.Add`，但现在有另一个问题：因为每一步我都会从十进制转换为双精度，我会失去精度。然后我的“智能缓存算法”不会绝对“精确”。这意味着在我的索引的 100 000 000 次更新值变得完全错误之后，我无法处理。

所以不可能使用也`double`不可能`decimal`。

我确实只看到了一种可能的解决方案——我必须声明 nasdaq 索引，`decimal`这样我才能继续使用我的“智能缓存算法”，所以我必须使用更复杂的“同步”机制，可能我必须使用自旋锁。

可能您可以看到更简单的解决方案？

# php - 使用 strip_tags() 和 preg_replace() 显示在 WYSIWYG/TinyMCE 文本编辑器中输入的文本

> ID：11347669
> 
> 赞同：1
> 
> 时间：2012-07-05T15:31:18.827
> 
> 标签：php, javascript, html

早上好，

这是问题所在：我通过文本编辑器（WYSIWYG/TinyMCE）输入了一些文本，并在其他地方显示为张贴。我们遇到的问题是文本在显示为帖子时会丢失其格式。深入研究代码后，我发现这是通过 strip_tags() + echo preg_replace() 组合完成的。我还是 PHP 新手，但我能够弄清楚：

*   strip_tags() 正在取出格式（b/c 这就是它的滚动方式）
*   我可以添加并让粗体和斜体文本显示
*   带下划线和删除线的文本是 CSS 样式，将代码（因为它保存在 db 表中）添加到 strip_tags() 列表并没有解决问题

我的问题是：我可以修改现有代码来解决这个问题，还是应该使用其他东西（也许是 htmlentities() ）？

编辑：我尝试了 htmlentities，但失败了。编辑：我只添加了标签，问题解决了 50%。我的文本带有下划线，但它显示的低于后面的非下划线文本。好像带下划线的文本被视为潜台词或其他东西。

代码片段：

```
 <div class="display_text_area">
        <?php $text = strip_tags(str_ireplace("</p>", "</p><br/>", 
              $text_detail->description),
              '<font><ul><li><br/><strong><em><span style="text-decoration: underline;">'); ?>
        <?php echo preg_replace('/(<br[^>]*>\s*){2,}/', '<br/>', $text); ?>
    </div> 
```

我把标签留在这里是为了表明（a）我试过了，（b）它没有用。所以 (c) 我知道它需要删除或修改。

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:45:34.790

关键是 TinyMCE 返回*名义上*有效的富 HTML，在用于 HTML 页面之前不需要剥离或转义。 *但是*，您不能假设 TinyMCE 编辑器正在客户端上运行，因为您可能会被直接发布包含 XSS 攻击的响应的人利用。

IIRC，TinyMCE 默认返回 XHTML。您需要使用诸如 HTML Purifier 之类的库来确保任何返回的 HTML 都是正确的。

# java - Weblogic卡住的线程 - ArrayList

> ID：11347672
> 
> 赞同：0
> 
> 时间：2012-07-05T15:31:21.783
> 
> 标签：java, jsf-2, weblogic-10.x

我们在 weblogic10.3.4 中部署了 JSF2.1 应用程序，在我们的一个支持 bean 中，当我们尝试将引用 ArrayList 分配给 List 实例时，weblogic 最终在 Struck 线程中，在我们应用程序的流量高峰期间。

```
java.util.ArrayList.indexOf(ArrayList.java:210)
java.util.ArrayList.contains(ArrayList.java:199) 
```

任何人以前都面临过这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:05:56.723

您的意思并不完全清楚，因此我假设您的意思是“卡住的线程”，并且该线程在某种意义上被卡住了，因为它在那一点上不断执行。

我能想到三个可能的原因。

*   正在搜索的对象有一个错误的`equals(Object)`方法，在某些情况下会进入无限循环。

*   有两个（或更多）线程大致同时访问和/或更新列表，并且您没有正确同步。如果您没有正确同步，则线程可能会看到数据结构的不一致视图，这将导致它以看似不可能的方式运行。

*   您以某种方式设置了一种病态情况，导致一个线程在（不正确的）认为它具有两个不同列表的情况下读取和更新列表。

我敢打赌，这是第二个问题，因为当您的服务器负载过重时，更有可能发生类似的“heisenbugs”。

* * *

最后，线程可能没有处于无限循环中，而只是需要很长时间才能完成某件事。并且循环可能涉及其他代码，但每次你看它都是在那个时候。

# asp.net - 正则表达式前瞻在 IE6 中不起作用

> ID：11347675
> 
> 赞同：0
> 
> 时间：2012-07-05T15:31:23.840
> 
> 标签：asp.net, regex, internet-explorer-6, password-protection

我有一个正则表达式，它在除 IE6 之外的所有浏览器中都能正常工作。从研究 IE6 不支持前瞻断言。无论如何我可以将以下表达式重写为跨浏览器吗？

密码必须介于 8 到 20 个字符之间，并且至少包含 1 个大写字母、1 个小写字母和 1 个数字

我正在使用 .Net 和正则表达式验证器。

```
^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,20}$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:40:04.090

坦率地说，如果您被迫为 IE6 编写代码，那么我会避免在这方面过于聪明。做你需要做的，让它可用​​。

我会考虑的选项：

1.  将正则表达式拆分为三个单独的查询。不再需要前瞻。它会更慢更混乱，我知道你宁愿正确编码，但如果我们想要支持 IE6，这些是我们做出的牺牲。它会起作用，并且它不应该对用户产生任何明显的影响。

2.  忘记尝试在 Javascript 中执行此操作，只需在服务器端进行验证即可。鉴于这显然是一个仅供内部使用的网站（没有人会写一个支持 IE6 的外部使用网站），你可能会放弃像响应式 UI 这样的细节，特别是对于像这样的边缘功能密码管理。

最后，请向贵公司强调 IE6 已过时。Microsoft 将在 2014 年初停止对它的所有支持：此时，发现的任何安全问题（并且会有很多）都将无法解决。因此，您可以确定它们将成为恶意软件的攻击目标：在您的网络中安装 IE6 将成为您无法想象的安全噩梦。你有一年的时间升级。如果您现在还没有开始计划，您很可能会错过目标，并且您**将**被黑客入侵。

假设您的公司有一点点意义，并且升级确实发生了，那么值得记住的是，您现在编写的任何 IE6 特定代码都只有有限的保质期。所以我将重复我一开始所说的：做你需要做的，让它对 IE6 用户*可用*；但不要花太多精力让它对他们*有好处*。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T15:34:44.767

你有错误的正则表达式，使用这个：

```
^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,20}$ 
```

# php - K-NET Paymanet 网关与 OpenCart 的集成

> ID：11347676
> 
> 赞同：0
> 
> 时间：2012-07-05T15:31:34.280
> 
> 标签：php, payment-gateway, opencart

我想将 KNET 支付网关集成到我的 OpenCart 1.5.3.1 网站中，但我找不到任何关于此的帮助。任何人都可以指导我或帮助我解决我的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:49:01.943

您基本上需要从 opencart 复制现有的支付网关，然后从那里传递任何信息到您的支付网关请求的文档中。我建议您将 PayPal Pro 用于大多数网关，但这实际上取决于它是什么类型的支付网关（iframe、重定向到处理器等）

# objective-c - NSString stringByAppendingPathComponent 上的内存泄漏：

> ID：11347677
> 
> 赞同：1
> 
> 时间：2012-07-05T15:31:43.543
> 
> 标签：objective-c, ios

分析显示内存泄漏，我在以下代码片段中为 fileB 分配了 filePath 值：

```
NSString *docsDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES) objectAtIndex:0];

NSString *filePath = [docsDir stringByAppendingPathComponent:@"/fileA"];

if ([[NSFileManager defaultManager] fileExistsAtPath:filePath]){
    self.propertyA = [[NSMutableArray alloc] initWithContentsOfFile:filePath];
} else {
    //  initialize array with default values and write to data file fileA   
    [self populatePropertyAForFile:filePath];       
}

filePath = [docsDir stringByAppendingPathComponent:@"/fileB"];

if ([[NSFileManager defaultManager] fileExistsAtPath:filePath]){
    self.propertyB = [[NSMutableArray alloc] initWithContentsOfFile:filePath];
} else {
    // initialize array with default values and write to data file fileB

    [self populatePropertyBForFile:filePath];

} 
```

我理解这是因为之前的值（对于 fileA）尚未发布。但我不知道如何阻止这种泄漏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:37:24.883

不，filePath 没有任何问题。几乎可以肯定，问题出在您的两个属性`propertyA`和`propertyB`. 如果它们是保留属性，那么您分配给它们的数组*及其内容*将会泄漏，因为您拥有您分配的数组并且您没有释放它们。像这样更改行：

```
self.propertyA = [[[NSMutableArray alloc] initWithContentsOfFile:filePath] autorelease];
                                                                        // ^^^^^^^^^^^ will release ownership of the array 
```

# ruby-on-rails - 在 url rails 3 中隐藏或加密表单参数

> ID：11347679
> 
> 赞同：0
> 
> 时间：2012-07-05T15:31:47.680
> 
> 标签：ruby-on-rails, ruby-on-rails-3, pagination, sunspot

我有这个表格：

```
<%= form_tag posts_path, :method => :get, :class => "search_nav" do %>
    <%= text_field_tag :search, params[:search], :class => "input-long search-query", :placeholder => "#{t('.search_nav')}"  %>
     <%= hidden_field_tag('ip', "#{request.ip}") %>
     <%= hidden_field_tag('city', "#{request.location.city}") %>
     <%= hidden_field_tag('country', "#{request.location.country}") %>
     <%= content_tag(:div, "",:class => "icon-search") %>
<% end %> 
```

我得到一个类似的网址：

```
http://localhost:3000/en/posts?utf8=%E2%9C%93&search=check+params&ip=127.0.0.1&city=&country=Reserved 
```

我的问题是：

**我可以隐藏或加密 url 参数`ip, city and country`吗？**

我不能使用`POST`，因为我有分页结果：

```
<a rel="2" href="/en/posts?city=&country=Reserved&ip=127.0.0.1&page=2&search=check+params&utf8=%E2%9C%93">2</a> 
<a rel="3" href="/en/posts?city=&country=Reserved&ip=127.0.0.1&page=3&search=check+params&utf8=%E2%9C%93">3/a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:38:03.753

加密 URL 参数是毫无意义的。为什么不希望用户看到这些值？当然，您可以在将它们添加到表单之前对其进行加密，但这真的有必要吗？

此外，也许更重要的是，如果这些值是基于请求的，那么您很有可能一开始就不需要提交它们。`#{request.xxx}`结果页面上的内容与表单页面上的内容相同。有什么好的理由传递这些吗？通过将这些作为 GET 参数提交，您实际上是在向服务器发送冗余信息。Ruby/Rails 已经在加载下一页时根据 IP 地址自动计算这些值。

这里的问题不在于表单，而在于您应用于设计它的逻辑。我认为您可能过度分析了自己的情况，需要退后一步重新思考问题。

# sql - 在访问报告中隐藏不必要的字段

> ID：11347689
> 
> 赞同：0
> 
> 时间：2012-07-05T15:32:07.603
> 
> 标签：sql, ms-access, report, ms-query

在我的工作场所有一个“每日反馈”数据库，其中输入了客户服务官 (CSO) 所犯任何错误的详细信息，例如谁犯了错误、何时犯了错误，以及它的目的是什么。这样我们就可以收集数据，这些数据将显示 CSO 反复犯错的领域，以便我们可以将其反馈给他们，并在需要时对他们进行培训。
我目前有一份报告，其中输入了 CSO 名称和日期范围，它生成的报告显示了该日期范围内每个服务的错误数量。
每个服务使用的代码是 -
=Sum(IIf([Service]="Housing",1,0))
=Sum(IIf([Service]="Environmental Health",1,0))
等等。
我遇到的问题是，并非每个 CSO 都提供每项服务，因此通常有一些结果显示为“0”。我不能确定那是因为他们不提供服务，还是他们只是非常擅长这项服务。
在 SQL 上绝对没用（或任何其他可能的解决方法）我无法弄清楚如何隐藏产生零值的条目。
在这里的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:03:36.240

假设您有一个包含字段`CSO`,的表`Service`，`FeedbackComments`您可以将报告记录源修改为

```
SELECT [CSO], [Service], Count([FeedbackComments]) 
FROM [FeedbackTable] 
GROUP BY [CSO], [Service]; 
```

那么没有记录的服务将不会出现在报告中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T19:50:38.003

我不明白你到底想要什么。但我想提一下，您可以将该`COUNT()`功能与`SUM()`. 计数`>0`将显示是否`0`意味着“0”个实例或“0”个错误。

# silverlight - 高亮字段内容 onFocus

> ID：11347690
> 
> 赞同：1
> 
> 时间：2012-07-05T15:32:22.000
> 
> 标签：silverlight, xaml, controls, expression-blend

谁能启发我一种方法，我可以仅通过 XAML 突出显示输入字段 OnFocus 的内容？

因此，如果用户将焦点放在某个字段上，它将突出显示字符串或其中的任何内容，以便他们可以例如只使用 tab 键，并在他们开始输入时立即替换现有字符串，而不必手动突出显示和删除它第一的？

我已经看到需要代码的答案，但想知道是否只有 XAML 路由？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T08:46:30.897

您可以为此目的使用 AutoCompleteBox，而无需编写任何代码来实现此功能。它已经具有此功能，并且它也可以作为文本框为您工作..

如果您需要任何进一步的信息，请告诉我。

干杯! 维诺德

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T04:30:59.180

我非常怀疑是否会有与 TextBox.SelectAll() 方法等效的 XAML 代码。

它应该像将每个 TextBox 的 GotKeyboardFocus 事件附加到这样的单个事件处理程序一样简单。

```
private void TextBox_GotKeyboardFocus(object sender, KeyboardFocusChangedEventArgs e)
{
    if (sender is TextBox)
        ((TextBox)sender).SelectAll();
} 
```

```
<TextBox GotKeyboardFocus="TextBox_GotKeyboardFocus" /> 
```

# c# - 使用 C# 从 NHibernate 连接到 AS400 (iSeries) 时出现错误 RROR [08001] [IBM] SQL30081N

> ID：11347692
> 
> 赞同：3
> 
> 时间：2012-07-05T15:32:37.040
> 
> 标签：c#, database, nhibernate, ibm-midrange

我完全没有使用 AS400 DB2 的经验，所以请原谅我在学习过程中出现的任何明显错误。我有 2 个可以连接到运行**v5r3**或**v4r3 的盒子。** 我正在使用**NHibernate 3**。但是，当我尝试连接时，我不断收到以下异常：-

```
ERROR [08001] [IBM] SQL30081N  A communication error has been detected. 
Communication protocol being used: "TCP/IP".  Communication API being used: "SOCKETS".  
Location where the error was detected: "192.168.1.11".  Communication function detecting the error: "connect".  Protocol specific error code(s): "10061", "*", "*".  SQLSTATE=08001 
```

下面是我的 NHibernate 配置文件：-

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
        <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
        <property name="dialect">NHibernate.Dialect.DB2400Dialect</property>
        <property name="connection.driver_class">NHibernate.Driver.DB2Driver</property>
        <property name="connection.connection_string">Server=192.168.1.11;Database=TESTDB;UID=XXX;PWD=XXX;          </property>
        <property name="proxyfactory.factory_class">NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>
        <property name="command_timeout">15000</property>
        <property name="current_session_context_class">thread_static</property>
    </session-factory>
</hibernate-configuration> 
```

不知道是不是因为AS400的版本太早了？我的休眠配置不正确？或者我在 AS400 本身上设置不正确。

任何建议将不胜感激。

提前谢谢了

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T15:42:50.783

**IBM i- DRDA**和**DDM**上有两种类型的数据库连接可用。 **DRDA**用于本机连接（DB2.Net.iSeries），**DDM**用于 DB/2 LUW（DB2.Net、DB/2 Connect）连接。

## DRDA

验证正在运行的数据库主机服务器：

```
WRKACTJOB SBS(QSERVER) JOB(QZDASRVSD) 
```

检查端口状态：

`NETSTAT OPTION(*CNN)`，点击`F2`并验证端口 449、8470、8471 和 8476 处于**Listen**状态。

使用以下命令启动数据库主机服务器：

```
STRHOSTSVR SERVER(*DATABASE) 
```

## DDM

验证 ddm tcp 服务器是否正在运行：

```
WRKACTJOB SBS(QSYSWRK) JOB(QRWTLSTN) 
```

检查端口状态：

NETSTAT *CNN，点击`F2`并验证端口 446 处于**Listen**状态。

使用以下命令启动 ddm tcp 服务器：

```
STRTCPSVR SERVER(*DDM) 
```

在连接字符串中包含 ddm 端口号：

```
Server=192.168.1.11:446;Database=TESTDB;UID=XXX;PWD=XXX; 
```

* * *

此 IBM 红皮书应提供更多信息：

[将 DB2 Universal Database for iSeries 与 Microsoft ADO .NET 集成](http://www.redbooks.ibm.com/abstracts/sg246440.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:39:14.567

真正的潜在错误是这个：

*TCP错误代码10061：无法建立连接，因为目标机器主动拒绝它*

所以显然端点没有监听，或者有一些防火墙阻止了你，或者你弄错了地址。如果在 as/400 中配置某些东西以启用该 TCP 地址来侦听连接，则可能未正确启用。

# javascript - .focus() 事件不起作用

> ID：11347693
> 
> 赞同：0
> 
> 时间：2012-07-05T15:32:38.147
> 
> 标签：javascript, jquery, web

当我的 php 页面加载一些 jQuery 时，应该将焦点设置到我的输入文本框，但它没有

我尝试过类似的css选择器`input[tabindex=1]`，`#31`但无济于事......

这是 jQuery（版本 1.7.1）

```
$(function() {
$('input[tabindex=1]').focus(); // also tried   $('#31').focus(); 
}); 
```

这是HTML

```
<input tabindex='1' type='text' class='tablefilter' id='31' style='width:80px;border:inset 2px grey;background-color:white;font-size:12px;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;'/> 
```

关于为什么这不起作用的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:37:37.293

看看这个，我刚试过你的代码，它有效。您使用的是哪个版本的 jquery？您使用的是哪个浏览器，请尝试打开控制台查看是否有异常。

这是演示：[DEMO](http://jsfiddle.net/jaiwo99/PCm9s/)

# sockets - 在 Python 中向 Minecraft 服务器发送登录数据包时出错

> ID：11347697
> 
> 赞同：0
> 
> 时间：2012-07-05T15:32:46.557
> 
> 标签：sockets, minecraft, python-2.x

我有以下脚本，我在网上找到了 Python。它所做的是尝试连接到 MineCraft 服务器，首先通过发送“握手”，然后发送登录请求。协议规范可以在这里找到：[http ://wiki.vg/Protocol](http://wiki.vg/Protocol)

无论如何，python脚本工作正常。但是，我认为第二个数据包编码错误，因为当它发送时，服务器控制台上什么也没有出现。播放器未连接或任何东西。由于“客户端”没有及时登录，它最终会超时并关闭连接。

基本上，无论如何，有 struct.pack() 经验的人应该能够在这里帮助我。我已经评论了我不确定我是否编码正确的行。有关打包数据的详细信息显示在上面的链接中。

任何帮助将不胜感激，我对编码/打包数据一无所知。:(

这是代码

```
import struct

import socket

import time

import urllib

import urllib2

host = str(raw_input('What is the host ip: '))

port = int(raw_input('What is the server port: '))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect((host, port))

usrnm = str(raw_input('What is your username: '))

psswrd = str(raw_input('What is your password: '))

logindata = {'user':usrnm, 'password':psswrd, 'version':'12'}

data = urllib.urlencode(logindata)

print('Sending data to login.minecraft.net...')

req = urllib2.Request('https://login.minecraft.net', data)

response = urllib2.urlopen(req)

returndata = response.read() 

returndata = returndata.split(":")

mcsessionid = returndata[3]

del req

del returndata

print("Session ID: " + mcsessionid)

data = {'user':usrnm,'host':host,'port':port}

enc_user = data['user'].encode('utf-16BE')

packfmt = '>bih{}shiibBB'.format(len(enc_user))

packetbytes = struct.pack(packfmt, 1, 23, len(data['user']), enc_user, 0, 0, 0, 0, 0, 0)

stringfmt = u'%(user)s;%(host)s:%(port)d'

string = stringfmt % data

structfmt = '>bh'

packetbytes = struct.pack(structfmt, 2, len(string))+string.encode('utf-16BE')

s.send(packetbytes)

connhash = s.recv(1024)

print("Connection Hash: " + connhash)

print('Sending data to http://session.minecraft.net/game/joinserver.jsp?user=' + usrnm + '&sessionId=' + mcsessionid + '&serverId=' + connhash + '...')

req = urllib.urlopen('http://session.minecraft.net/game/joinserver.jsp?user=' + usrnm + '&sessionId=' + mcsessionid + '&serverId=' + connhash)

returndata = req.read()

if(returndata == 'OK'):

    print('session.minecraft.net says everything is okay, proceeding to send data to server.')

else:

    print('Oops, something went wrong.')

time.sleep(5)

# All above here works perfectly.

enc_user = data['user'].encode('utf-16BE')

packfmt = '>bih{}shiibBB'.format(len(enc_user))

packetbytes = struct.pack(packfmt, 1, 23, len(data['user']), enc_user, 0, 0, 0, 0, 0, 0)

#This line is probably where something's going wrong:

packetbytes = struct.pack('>bih', 1, 23, len(data['user'])) + data['user'].encode('utf-16BE') + struct.pack('>hiibBB', 2,0,0,0,0,0)

print(len(packetbytes))

print('Sending ' + packetbytes + ' to server.')

s.send(packetbytes)

while True:

    data = s.recv(1024)

    if data:

        print(data) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T20:26:49.307

是的，您正在发送字符串的长度，即字符数。相反，您应该发送编码字符串中的字节数。此外，您应该使用“！” 为了清楚起见，而不是“>”，作为“！” 用来表示“网络秩序”，就是这个。所以这...

```
structfmt = '>bh'

packetbytes = struct.pack(structfmt, 2, len(string))+string.encode('utf-16BE') 
```

……改成这个……

```
structfmt = '!bh'

encoded = string.encode('utf-16BE')

packetbytes = struct.pack(structfmt, 2, len(encoded))+encoded 
```

# php - 根据类或值合并相邻的 html 表格单元格

> ID：11347698
> 
> 赞同：1
> 
> 时间：2012-07-05T15:32:46.963
> 
> 标签：php, javascript, jquery, html

我有一个包含可变数量单元格的 html 表。为了这个例子，我会说 20x20（虽然它更大）。

这是通过 php 生成的，用于填充表的数据集已从 mysql 中提取。这些单元格中的每一个都有一个数值，并且需要专门将其放在 is 所在的位置。因此，如果单元格 A(10,15) 的值为 100，则该 100 需要专门在 10,15 上-在生成表格时，我无法分析定位。

现在，这些单元格中的许多单元格都有其他具有相同值的相邻单元格。无论是水平的还是垂直的。

我需要做的是合并此表中具有相同值的相邻单元格。这可以是水平的，垂直的，或两者兼而有之，但仍然保持它是一个矩形 - 没什么太时髦的。

例如，如果我有

0 1 1 1 0
2 2 5 0 4
5 5 5 1 4

我需要根据值修改 colspan 和/或 rowspan - 需要注意的是，在生成时，我实际上可以为这些单元中的每一个定义类或 id。同样在生成过程中，我可以确定是否会有一个以上的系列连续出现，但我无法知道下面的行中是否会有一个。

ps：我确实做了一些研究，发现了这个线程。 [复杂的表合并 javascript & jquery 算法](https://stackoverflow.com/questions/9181596/complex-table-merging-javascript-jquery-algorithm)

修改了 jsfiddle 示例以影响单元格的 colspan 和 rowspan 但是当它需要合并两个以上的单元格时它似乎会翻转 -

对此事有什么建议的方法？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T13:26:20.390

分两次执行（O（n2）），首先在宽度上遍历您的数组并检测相邻单元格的数量（并将同一单元格之后的单元格设置为零）：

```
0(1) 1(3) 1(0) 1(0) 0(1)
2(2) 2(0) 5(1) 0(1) 4(1)
5(3) 5(0) 5(0) 1(1) 4(1) 
```

然后，垂直遍历它，找到两个数字相同（并且计数> 0）的单元格，你会得到：

```
0(1,1) 1(3,1) 1(0,0) 1(0,0) 0(1,1)
2(2,1) 2(0,0) 5(1,0) 0(1,1) 4(1,2)
5(3,1) 5(0,0) 5(0,0) 1(1,1) 4(1,0) 
```

现在，这对的第一个数字是 colspan，第二个是 rowspan。如果其中一个数字为 0，则不输出。

```
0 1---- 0
2-- 5 0 4
5---- 1 | 
```

# hadoop - 简单 Hive 查询为空

> ID：11347699
> 
> 赞同：0
> 
> 时间：2012-07-05T15:32:48.827
> 
> 标签：hadoop, hive

我有一个 csv 日志文件。使用这句话将其加载到 Hive 后：

```
CREATE EXTERNAL TABLE iprange(id STRING, ip STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\,' STORED AS TEXTFILE LOCATION '/user/hadoop/expandediprange/'; 
```

我想执行一个简单的查询，例如：

```
select * from iprange where ip="0.0.0.2"; 
```

但我得到一个空的结果。

我在 HDFS 上运行 Hive，我应该使用 HBase 吗？我的结论是它与桌子的大小有关。日志文件为 160 MB，在 Hive 中生成的表有 800 万行。如果我尝试为自己创建一个较小的文件并将其加载到 Hive，它将起作用。

知道出了什么问题吗？

编辑：我忘了说它使用小型实例在 Amazon Elastic MapReduce 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T09:43:36.323

我发现了问题。这真的不是 Hive 问题。我使用 Hadoop 作业的输出作为输入，在该作业中，我将输出写入键中，将值保留为空字符串：

```
context.write(new Text(id + "," + ip), new Text("")); 
```

问题是Hadoop默认在键和值之间插入一个制表符，并且由于字段是一个字符串，它也采用了制表符，所以我在每一行都有一个尾随制表符。我使用 Pig 发现了它，因为它包含带有 () 的输出。

我的解决方案是将分隔符设置为另一个字符，因为我只有两个字段，我在键中写入一个，在值中写入另一个，并将分隔符设置为“，”：

```
conf.set("mapred.textoutputformat.separator", ","); 
```

也许可以在 Hive 中修剪这些东西。

# excel - 在excel中使用VBA截断双精度

> ID：11347704
> 
> 赞同：15
> 
> 时间：2012-07-05T15:33:04.873
> 
> 标签：excel, double, decimal-point, vba

我需要截断双精度值的小数位数以显示在文本框中。如何使用 vba 实现这一目标？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-11-20T09:52:37.207

如果要对值进行*四舍五入*，则可以使用 Round 函数（但请注意，VBA 的 Round 函数使用 Banker 的舍入，也称为舍入到偶数，它将向上或向下舍入 5；使用传统的舍入四舍五入，使用格式）。

如果您想在不四舍五入的情况下*截断*值，则无需像接受的答案那样使用字符串 - 只需使用数学：

```
Dim lDecimalPlaces As Long: lDecimalPlaces = 2
Dim dblValue As Double: dblValue = 2.345

Dim lScale = 10 ^ lDecimalPlaces
Dim dblTruncated As Double: dblTruncated = Fix(dblValue * lScale) / lScale 
```

这产生“2.34”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-05T15:37:56.317

您可以`ROUND`在`FORMAT`VBA中使用

例如显示 2 个小数位

```
Dval = 1.56789

Debug.Print Round(dVal,2)

Debug.Print Format(dVal,"0.00") 
```

**注**：以上将给您`1.57`。因此，如果您正在寻找，`1.56`那么您可以将 Dval 存储在一个字符串中，然后执行此操作

```
Dim strVal As String

dVal = 1.56789
strVal = dVal

If InStr(1, strVal, ".") Then
    Debug.Print Split(strVal, ".")(0) & "." & Left(Split(strVal, ".")(1), 2)
Else
    Debug.Print dVal
End If 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-03-23T17:17:58.820

您可以使用 Int() 函数。`Debug.print Int(1.99543)`

或更好：

```
Public Function Trunc(ByVal value As Double, ByVal num As Integer) As Double
  Trunc = Int(value * (10 ^ num)) / (10 ^ num)
End Function 
```

所以你可以使用`Trunc(1.99543, 4)`==>`result: 1.9954`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-21T08:55:33.047

这是我的尝试：

```
Function TruncateNumber(decimalNum As Double, decPlaces As Integer) As Double
'decimalNum: the input number to be truncated
'decPlaces: how many decimal places to round to. Use 0 for no decimal places.
    decimalLocation = InStr(decimalNum, ".")
    TruncateNumber = Left(decimalNum, decimalLocation + decPlaces)
End Function 
```

它使用字符串来避免由不同舍入方法引起的任何数学错误。它将作为双精度类型输出，因此您仍然可以对其进行自己的数学运算。

*如果将没有*小数位的数字传递给上述函数，这将导致错误。如果这是一个问题，您可以使用以下代码：

```
Function TruncateNumber(decimalNum As Double, decPlaces As Integer) As Double
'decimalNum: the input number to be truncated
'decPlaces: how many decimal places to round to. Use 0 for no decimal places.
    If InStr(decimalNum, ".") = 0 Then 'if there was no decimal:
        'then return the number that was given
        TruncateNumber = decimalNum
    Else 'if there is a decimal:
        'then return the truncated value as a type double
        decimalLocation = InStr(decimalNum, ".")
        TruncateNumber = Left(decimalNum, decimalLocation + decPlaces)
    End If
End Function 
```

希望这些功能对某人有用。我没有进行广泛的测试，但它们对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-19T00:49:00.487

这是我做的一个小实验......（第一次发布和回答，如果我不遵守约定，请告诉我。

```
Sub Truncate()

Dim dblNum  As Double
Dim intDecimal  As Integer

dblNum = 1578.56789
intDecimal = 2  '0 returns 1578
                '2 returns 1578.56
                '-2 returns 1500

Debug.Print (Int(dblNum * 10 ^ intDecimal) / 10 ^ intDecimal)

End Sub 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-11-21T13:06:53.370

**已编辑**

较新版本的 Excel (VBA) 有一个 TRUNC 函数，它已经可以正常工作。

**对于旧版本的 EXCEL**

我想将双精度截断为整数。

```
value = Int(83.768)
value == 83 
```

太棒了，它奏效了。

根据您的 Excel (VB) 版本，这可能不适用于负数。

```
value = Int(-83.768)
value == -84 
```

VB 使用银行家四舍五入。

```
Public Function Trunc1(ByVal value As Double) As Integer
  ' Truncate by calling Int on the Absolute value then multiply by the sign of the value.
  ' Int cannot truncate doubles that are negative
  Trunc1 = Sgn(value) * Int(Abs(value))
End Function 
```

如果您想要特定的小数位，请执行 Makah 仅在值周围使用 Abs 所做的操作，以便 Int 可以正确截断。

```
Public Function Trunc2(ByVal value As Double, Optional ByVal num As Integer = 1) As Double
    ' Truncate by calling Int on the Absolute value then multiply by the sign of the value.
    ' Int cannot truncate doubles that are negative
    Trunc2 = Sgn(value) * (Int(Abs(value) * (10 ^ num)) / (10 ^ num))
End Function 
```

# c# - 如果数据模板中的 TextBox 获得焦点，则自动选择 TreeViewItem（不使用代码）

> ID：11347707
> 
> 赞同：2
> 
> 时间：2012-07-05T15:33:11.660
> 
> 标签：c#, wpf, xaml, triggers, treeview

我有一个 2 级 TreeView。Level-2 TreeViewItems 通过数据模板包含 TextBox 控件。

我想要什么：如果 TextBox 控件获得焦点，则选择相应的 TreeViewItem。我做了一些研究，发现了这一点：

```
<Style TargetType="ListViewItem">
<Style.Triggers>
    <Trigger Property="IsKeyboardFocusWithin" Value="true">
        <Setter Property="IsSelected" Value="true" />
    </Trigger>
</Style.Triggers> 
```

[关联](https://stackoverflow.com/questions/653524/selecting-a-textbox-item-in-a-listbox-does-not-change-the-selected-item-of-the-l?lq=1)

如果我用 TreeViewItem 替换 ListViewItem，这几乎可以完美地工作。

但是：第一个子项总是选择它的父项而不是它自己。（其他子项按预期工作）。

所以就像

```
<TreeView>
<TreeViewItem>
  <TreeViewItem>  <-- this doesn't work
  <TreeViewItem>  <-- this works
</TreeViewItem>
<TreeViewItem>
  <TreeViewItem>  <-- this doesn't work
  <TreeViewItem>  <-- this works
  <TreeViewItem>  <-- this works
</TreeViewItem>
<TreeViewItem>
  <TreeViewItem>  <-- this doesn't work
  <TreeViewItem>  <-- this works
  <TreeViewItem>  <-- this works
</TreeViewItem>
...
</TreeView> 
```

任何想法我做错了什么或如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T08:02:05.410

我找到了解决方案。事实证明，问题是由应用到 1 级 TreeViewItems 的样式引起的（这些只包含一个 TextBlock）。所以如果我改变风格

```
 <Style TargetType="{x:Type TreeViewItem}">
                <Style.Triggers>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="IsKeyboardFocusWithin" Value="True"></Condition>
                            <Condition Property="HasItems" Value="False"></Condition>
                        </MultiTrigger.Conditions>
                        <MultiTrigger.Setters>
                            <Setter Property="IsSelected" Value="True"></Setter>
                        </MultiTrigger.Setters>
                    </MultiTrigger>
                </Style.Triggers>
            </Style> 
```

并将此样式设置为`<TreeView.ItemContainerStyle>`，一切都按预期工作。

# java - 试图在 Java 中的所有页面中保持会话

> ID：11347709
> 
> 赞同：0
> 
> 时间：2012-07-05T15:33:14.680
> 
> 标签：java, html, jsp, session, tags

当直接访问者访问我们的网站时，我们无法维护 cookie 和会话。例如，当访问者第一次访问我们的站点时，我们会得到一个空指针异常。当有回访者访问我们的网站时，不会发生这种情况。知道为什么会发生这种情况吗？

每个页面都有一个正文标签。在加载 body 标签时，我们没有得到会话值。我们只得到一个空指针异常（这仅发生在第一次访问者身上）。当同一个访问者返回我们的站点时，我们没有收到空指针异常，而且它似乎工作正常。

正文 bgcolor="#778899" onload="change(),zipValid('<%=session.getAttribute("zip").toString() %>')"

我正在尝试在 www.unocardealers.com 网站上执行此操作。基本上，每当访问者回到我们的网站时，我们都会尝试使用他们上次搜索的邮政编码预先填写邮政编码字段。如果他们在同一会话期间进行搜索，那么我们正在尝试预先填写他们之前搜索的邮政编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:45:41.377

```
 '<%=session.getAttribute("zip").toString() %>' 
```

如果 session 为 null 或 session.getAttribute("zip") 为 null，您将在此处获得 nullPointerException。只需添加一些空检查

# html - 带有图像和文本的 HTML 超链接

> ID：11347710
> 
> 赞同：7
> 
> 时间：2012-07-05T15:33:17.370
> 
> 标签：html, image, button, text, hyperlink

是否可以使超链接看起来像带有文本的按钮？

我们可以用代码制作超链接按钮：

```
<a href="..."> <img src="button.png" width="100" height="50" alt="Some text"></img> </a> 
```

但我还需要按钮中心的文本。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:40:24.630

我建议，在不确切知道您想要什么的情况下，并假设以下标记：

```
<a href="#"><img src="path/to/image.png" /><span>Some text</span></a>

a {
    position: relative;
    display: inline-block;
}

a span {
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -1em;
    margin-left: -50%;
    width: 100%;
    height: 2em;
    color: #f90;
    background-color: rgba(0,0,0,0.5);
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/6trKv/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:37:32.740

可以通过将按钮设置为背景：

```
<a href="..." style="text-align:center; background: url('button.png'); width: 100px; height: 50px;">Your text</a> 
```

但我会尽量避免带有背景图像的按钮（除非它们是奇怪的形状）。相反，我会尝试使用 CSS3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-05T17:19:34.603

您可以使用一些 UI 框架，例如 bootstrap 或 Flat ui 。

```
<a href="#" class="btn btn-primary"> Click Me</a> 
```

# git - git fetch 仅用于当前分支

> ID：11347712
> 
> 赞同：13
> 
> 时间：2012-07-05T15:33:24.700
> 
> 标签：git, fetch

我知道我可以将[任何远程分支获取到任何本地分支](https://stackoverflow.com/questions/6368987/how-do-i-fetch-only-one-branch-of-a-remote-git-repository)，但是是否还有某种快捷方式可以仅从被跟踪的远程分支获取到当前的跟踪本地分支（无需明确指定本地和远程分支名称） ?

动机：我只想获取当前分支的远程更改，以避免从当前不相关的分支获取（可能很大）更改。稍后我将在单独的步骤中合并/重新设置基准。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T15:55:00.343

让我们假设您有***master***远程***源***，***开发***分支。你想同步***master***但不***开发***。

 ***您可以执行以下步骤：

```
git fetch origin
git merge origin/master 
```

更新：如果只需要获取分支：

```
git fetch origin master
git merge FETCH_HEAD 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-07T14:16:58.377

```
git fetch $(git rev-parse --symbolic-full-name --abbrev-ref @{upstream} | sed 's!/! !') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-03-05T16:25:52.807

将现有答案中的一些东西结合在一起......

获取签出分支的名称：

```
git rev-parse --abbrev-ref HEAD 
```

要回答您的问题，您如何仅获取当前分支？给你，作为一个名为`fetchthis`. 使用喜欢`git fetchthis`。

```
git config --global alias.fetchthis '!bname=$(git rev-parse --abbrev-ref HEAD); git fetch origin $bname' 
```

在 Git for Windows 中测试：

```
$ git --version
git version 2.25.1.windows.1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-23T21:44:08.907

根据[https://stackoverflow.com/a/12142066/25192](https://stackoverflow.com/a/12142066/25192) - 您可以使用它来查找当前分支的名称：

`git rev-parse --abbrev-ref HEAD`

...然后将其替换为 fetch 命令作为 refspec。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-07-05T15:39:50.573

Git 是一个**去中心化**的VCS。当您进行提取时，您将完全同步两个存储库。分支只不过是附加在特定提交上的标签。我猜你的意思是`git fetch`它不会对任何特定的分支进行任何合并或类似的事情。

[http://www.kernel.org/pub/software/scm/git/docs/git-fetch.html](http://www.kernel.org/pub/software/scm/git/docs/git-fetch.html)***

# javascript - 如何修改它以使用数组中的所有项目？

> ID：11347715
> 
> 赞同：0
> 
> 时间：2012-07-05T15:33:32.843
> 
> 标签：javascript, jquery

这是我要修改的函数中的代码。此示例适用于名为“stream”的现有数组中的单个项目：

```
list = [
    {
        service: 'service1',
        user: stream [0],
        template: {
            posted:HTML1 +  stream[0] + HTML2
        }
    }
], 
```

该代码最初要求手动输入该`user`值，因此我切换到一个数组，因为我在其他地方使用与 $.each 相同的值（用于 HTML 内容）。

数组的`stream`长度可能会有所不同，所以我想避免在下面手动编写类似这样的内容，因为我怀疑它需要匹配项目的数量`stream`（可能是 1 到 50 或更多）：

```
list = [
    {
        service: 'service1', 
        user: stream [0], 
        template: { 
            posted:HTML1 +  stream[0] + HTML2
        }
    }, 
    { 
        service: 'service1', 
        user: stream [1], 
        template: { 
            posted:HTML1 +  stream[1] + HTML2
        }
    } 
], 
```

感谢您的帮助和指导！

PS这是对这个问题的另一种尝试，希望这次更清楚。仍然在学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:38:57.673

我相信，你想要这个：

```
var SERVICE = 'service1';

list = jQuery.map(stream, function (item) { 
  return {
    service: SERVICE, 
    user: item, 
    template: { 
        posted:HTML1 +  item + HTML2
    }
  }; 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:47:05.310

仅使用 javascript 的解决方案：请参阅工程师的帖子了解（更简单的）jQuery 解决方案

```
var list = [];

for (var i = 0; i < stream.length; i++) {
    list.push({
        service: 'service1',
        user: stream[i],
        template: {
            posted: HTML1 + stream[i] + HTML2
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:44:42.823

看看这个：http: [//jsfiddle.net/xHfDb/](http://jsfiddle.net/xHfDb/)

```
$.map(stream, function(item, index) {
        return {
            service: 'service' + index,
            user: item,
            template: {
                posted: HTML1 + item + HTML2
            }
        }
    }) 
```

# objective-c - NSLog 在设备上被忽略

> ID：11347718
> 
> 赞同：3
> 
> 时间：2012-07-05T15:33:46.640
> 
> 标签：objective-c, ios, device, nslog

我正在尝试重定向所有 NSLog 输出，以便能够在应用程序内的 UITextView 中查看我的所有日​​志（出于调试目的，可能稍后使用 TestFlight 记录所有内容）。我不能使用众所周知的 DLog，因为我想从我不拥有的框架中捕获日志。

我通过将标准错误“重定向”到管道并从该管道读取来做到这一点。无论如何，当从 Xcode 中启动应用程序时，这在模拟器和设备上运行良好。但是，当应用程序在设备上“手动”启动时，这不起作用。

似乎 NSLog 调用对设备没有影响：我没有从管道中读取任何内容。但是，如果我在 stderr 上手动写入：`fprintf(stderr, "test")`我可以从管道中读取它，所以问题不在于 stderr 而在于 NSLog 函数。

为什么它在设备上什么也不做？有没有办法让它甚至在设备上写在 stderr 上？

如果无法在设备上使用 NSLog，是否有另一种方法可以从外部框架收集日志？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T16:24:37.633

NSLog 转到设备上的系统日志。您可以使用 C API [asl (Apple System Log)](https://developer.apple.com/library/ios/#documentation/System/Conceptual/ManPages_iPhoneOS/man3/asl.3.html)访问系统日志；另请查看[此博客文章](http://www.cocoanetics.com/2011/03/accessing-the-ios-system-log/)。

但是，如果您使用的是 TestFlight，则只需使用 TFLog 语句替换/附加那些 NSLog 语句就容易得多。

```
TFLog(@"This comment is live on TestFlight."); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:07:05.143

如果你想要一些 UILogging，你可以考虑使用 ULog，一个**基于 UIAlertView 的**Logging #define 指令。

```
// ULog will show the UIAlertView only when the DEBUG variable is set 

#ifdef DEBUG
#   define ULog(fmt, ...)  { UIAlertView *alert = [[UIAlertView alloc] initWithTitle:[NSString stringWithFormat:@"%s\n [Line %d] ", __PRETTY_FUNCTION__, __LINE__] message:[NSString stringWithFormat:fmt, ##__VA_ARGS__]  delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil]; [alert show]; }
#else
#   define ULog(...)
#endif 
```

（来源： http: [//overbythere.co.uk/blog/2012/01/alternatives-nslog](http://overbythere.co.uk/blog/2012/01/alternatives-nslog)）

# c++ - 从系统调用执行时 setxkbmap 返回 65280

> ID：11347723
> 
> 赞同：1
> 
> 时间：2012-07-05T15:33:55.820
> 
> 标签：c++, c

我正在发送

```
std::string cmdStr = "setxkbmap us";
int res = system( cmdStr.c_str() ); 
```

结果是

```
res: 65280 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:45:27.963

该值表示子进程正常退出，值为 255。

在以下情况下可能会发生这种情况：

*   `/bin/sh`找不到`setxkbmap`。（*注意*：我可能错了。在我的电脑上，`/bin/sh`在这种情况下返回 127。）
*   `setxkbmap`无法打开 X 服务器`$DISPLAY`，包括未设置 DISPLAY

我相信还有很多其他的可能性。检查标准输出以获取错误消息。

`system`在 Linux 上解释返回值时，请执行以下操作：

```
#include <sys/wait.h>

int res = system(foo);
if(WIFEXITED(res)) {
  std::cout << "Normal exit: " << WEXITSTATUS(res) << "\n";
} else {
  if(WIFSIGNALED(res)) {
    std::cout << "Killed by signal #" << WTERMSIG(status);
    if(WCOREDUMP(res)) {
      std::cout << " Core dumped";
    }
    std::cout << "\n";
  } else {
    std::cout << "Unknown failure\n";
  }
} 
```

# c# - 显示DICOM图像的VALUE参数

> ID：11347725
> 
> 赞同：1
> 
> 时间：2012-07-05T15:33:58.457
> 
> 标签：c#, dicom, evil-dicom

我正在使用 Evil Dicom dll。目前，对于其中一个标签，Counts Accumulated，我可以提取并显示 VR 参数、LENGTH 参数和 TAG DESCRIPTION 参数。

但是，我还没有找到一种方法来提取和显示 VALUE 参数，即累积计数的物理数量。我试图知道的一切都在不断地给我错误。

有人可以告诉我如何提取这些信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:48:02.460

根据 EvilDicom [Getting Started page](http://evildicom.rexcardan.com/getting-started)，应该很简单：

```
DICOMFile df = new DICOMFile("test.dcm");  
int[] countsDataArray = df.COUNTS_ACCUMULATED.Data;
int countsAccumulated = countsArray[0]; 
```

`COUNTS_ACCUMULATED`是[IntegerString](http://evildicom.rexcardan.com/API/html/class_evil_dicom_1_1_v_r_1_1_integer_string.html)类型，它有一个`Data`返回整数数组的成员。*累计计数*的*值多重性*为1 *，*因此您只需要访问数组中的第一个值。**`Data`**

# iphone - 在 UITableViewCell 中的 UITextView 上启用 dataDetectorTypes 的问题

> ID：11347727
> 
> 赞同：1
> 
> 时间：2012-07-05T15:34:10.820
> 
> 标签：iphone, uitableview, uitextview, datadetectortypes

我在表的 UITableViewCell 中有一个 UITextView。UITextView 的“可编辑”已关闭，这允许我将 dataDetectorTypes 设置为 UIDataDetectorTypeAll，这正是我想要的。该应用程序现在检测用户何时触摸 UITextView 中的链接，并执行适当的操作。

当用户触摸没有链接的部分 UITextView 时，就会出现问题。我希望调用 UITableView 委托中的 didSelectRowAtIndexPath 。但事实并非如此，因为 UITextView 会捕获触摸，即使未检测到链接也是如此。

我的第一个猜测是将 UITextView 上的 userInteractionEnabled 设置为 NO。这意味着 didSelectRowAtIndexPath 将被调用，但是 UITextView 无法检测到链接。这是第 22 条规则。

有想法该怎么解决这个吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T17:40:17.400

也许您可以尝试将修饰传递给响应者链。

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
   [super touchesBegan:touches withEvent:event];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-14T19:35:21.800

覆盖所有四个`UIResponder`触摸处理程序以转发到文本视图的超级视图。

头文件指出“通常，所有进行自定义触摸处理的响应者都应该覆盖所有这四种方法。......您必须处理取消的触摸以确保应用程序中的正确行为。不这样做很可能导致不正确的行为或崩溃。”

```
class MyTextView: UITextView {

    override func touchesBegan(touches: Set<UITouch>, withEvent event: UIEvent?) {
        self.superview?.touchesBegan(touches, withEvent: event)
    }

    override func touchesMoved(touches: Set<UITouch>, withEvent event: UIEvent?) {
        self.superview?.touchesMoved(touches, withEvent: event)
    }

    override func touchesEnded(touches: Set<UITouch>, withEvent event: UIEvent?) {
        self.superview?.touchesEnded(touches, withEvent: event)
    }

    override func touchesCancelled(touches: Set<UITouch>?, withEvent event: UIEvent?) {
        self.superview?.touchesCancelled(touches, withEvent: event)
    }

} 
```

# c++ - std::bind 占位符的重载运算符

> ID：11347730
> 
> 赞同：3
> 
> 时间：2012-07-05T15:34:21.453
> 
> 标签：c++, boost, stl, operator-overloading, bind

`boost::bind`为其占位符重载了几个运算符：

> 为方便起见，通过`bind`重载逻辑非运算符`!`以及关系和逻辑运算符`==`, `!=`, `<`, `<=`, `>`, `>=`, `&&`,生成的函数对象`||`。

例如，这允许我`_1 == desired_value`作为谓词传递给 STL 算法。

不幸的是，`std::bind`似乎并没有使这些运算符重载:(

1.  这是为什么？

2.  什么是模拟的好解决`_1 == desired_value`方法`std::bind`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:52:52.497

IIRC，Boost.Bind 仅重载了占位符的那些运算符，因为 Boost.Bind 是改进的原始 Boost Lambda 库确实（由于 Boost.Phoenix，Boost.Bind 已过时，顺便说一句）。`std::bind`的占位符仅用于该目的，作为参数的占位符`std::bind`。

作为一种解决方法，使用多态函子：

```
struct compare_equal{
  template<class LHS, class RHS>
  bool operator()(LHS&& lhs, RHS&& rhs){ // assume bool return
    return std::forward<LHS>(lhs) == std::forward<RHS>(rhs);
  }
};

// ...
auto bound = std::bind(compare_equal(), _1, desired_value); 
```

[Ideone 上的实时示例。](http://ideone.com/fmhlE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T08:25:44.270

您始终可以自己为占位符重载这些运算符，例如`operator<`：

```
struct less12
{
    template<typename T, typename U>
    bool operator()(const T& a, const U& b) const
    {
        return a < b;
    }
};

less12 operator<(decltype(_1), decltype(_2))
{
    return less12();
}

struct less21
{
    template<typename U, typename T>
    bool operator()(const U& b, const T& a) const
    {
        return a < b;
    }
};

less21 operator<(decltype(_2), decltype(_1))
{
    return less21();
}

template<typename T>
struct lessa1
{
    const T& a;

    template<typename U>
    bool operator()(const U& b) const
    {
        return a < b;
    }
};

template<typename T>
lessa1<T> operator<(const T& a, decltype(_1))
{
    lessa1<T> result = {a};
    return result;
}

template<typename U>
struct less1b
{
    const U& b;

    template<typename T>
    bool operator()(const T& a) const
    {
        return a < b;
    }
};

template<typename U>
less1b<U> operator<(decltype(_1), const U& b)
{
    less1b<U> result = {b};
    return result;
} 
```

这是一个使用示例，与活页夹（自定义`less12`vs `std::less`）和 lambda 语法相比：

```
template<typename Iterator>
void quicksort(Iterator begin, Iterator end)
{
    // ...
    auto m = std::partition(begin + 1, end, _1 < *begin);

    auto m = std::partition(begin + 1, end, std::bind(less12(), _1, *begin));

    auto m = std::partition(begin + 1, end, std::bind(std::less<typename std::iterator_traits<Iterator>::value_type>(), _1, *begin));

    auto m = std::partition(begin + 1, end, [begin](const typename std::iterator_traits<Iterator>::value_type& x) { return x < *begin; } );
    // ...
} 
```

真的很期待这里的[N3421](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3421.htm)和多态 lambdas :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-21T17:27:12.470

> std::bind 似乎没有重载这些运算符？这是为什么？

因为 C++11 添加了 lambda，它们提供了相同的（如果不是更好的话）方便来生成匿名函子对象。

> 用 std::bind 模拟 _1 == desired_value 的好方法是什么？

std::bind 不用于模拟行为。使用 C++11 lambda 实现您问题的答案：

```
std::vector<int>::iterator it = std::find_if (myvector.begin(), myvector.end(), [](int i) -> bool { return i == desired_value; }); 
```

请注意，如果您使用的是可以派生返回类型的相当新的编译器，则不需要“-> bool”语法。

如果您不想或不能使用 C++11 lambda，那么您可以像这样创建一个非匿名仿函数：

```
bool IsDesiredValue (int i) {
    return (i == desired_value);
}
std::vector<int>::iterator i = std::find_if (myvector.begin(), myvector.end(), IsDesiredValue); 
```

再举一个例子，这里是使用 C++11 lambdas 来创建匿名函子，以按类型的值对向量进行排序：

```
std::sort(myVector.begin(), myVector.end(), [](const Foo& i, const Foo& j) -> bool { return i.myValue < j.myValue; }); 
```

另一种非 lambda 版本是：

```
struct myclass {
  bool operator() (const Foo& i, const Foo& j) { return (i.myValue < j.myValue); }
} myobject;
std::sort(myVector.begin(), myVector.end(), myobject); 
```

以下是使用 boost 的运算符重载进行相同排序的方法：

```
std::sort(myVector.begin(), myVector.end(), boost::bind(&MyClass::myValue, _1) < boost::bind(&MyClass::myValue, _2)) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-05T15:43:12.403

我认为这是因为 C++11 有 lambda，因此我不明白为什么你需要这样的运算符。

# printing - 打印 iframe 内容

> ID：11347731
> 
> 赞同：0
> 
> 时间：2012-07-05T15:34:22.677
> 
> 标签：printing, frame

我有一个 html 页面。页面内容包含 2 个框架的框架集。1 表示菜单，1 表示内容。

```
<frameset border="4" cols="260, *">
    <frame id="menu" name="menu" marginwidth="5" marginheight="5" src="Menu.html" onload="LoadPage();" >
    <frame id="Main" name="Main" marginwidth="5" marginheight="5" src="" >
</frameset> 
```

我想强制浏览器（主要是 IE）打印框架“主”的内容，而不是所有内容（菜单和主）

保护你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:47:40.203

您可以在 menu.html 页面或您要在 iframe 中显示的任何其他页面中使用以下代码。

```
<a href="#" onClick="print(); return false;">Print Report</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T13:47:56.390

```
 document.getElementById("ifrmeSummary").contentWindow.focus();
         document.getElementById("ifrmeSummary").contentWindow.print(); 
```

这将只打印 iframe 内容而不是整个屏幕/窗口

# events - Magento - 为属性添加选项的观察者/事件

> ID：11347733
> 
> 赞同：2
> 
> 时间：2012-07-05T15:34:31.223
> 
> 标签：events, magento, attributes, option, observers

我正在寻找一个观察者/事件，它将在保存属性时触发。

示例：当将新颜色 fe black 添加到属性颜色时，我想检查我的自定义表中是否已经有此选项。

有谁知道这样的事件？

搜索了一天多... :(

（这个[http://www.nicksays.co.uk/magento_events_cheat_sheet/](http://www.nicksays.co.uk/magento_events_cheat_sheet/)也是）

谢谢和问候，

马蒂亚斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T15:43:13.567

也许这会有所帮助`catalog_entity_attribute_save_before` `catalog_entity_attribute_save_after`。

# mysql - 在使用 UNION 和 ORDER BY 的 mysql 查询中避免重复

> ID：11347742
> 
> 赞同：0
> 
> 时间：2012-07-05T15:34:50.553
> 
> 标签：mysql, duplicate-removal

我有两个表，假设 table1 和 table2 有公共列，id 和 update_date。我希望根据最新的 update_date 按降序获取 id 和 update_date。我一起使用了'union'和'order by'，结果按update_date的降序排列，但有重复的id，我不知道如何摆脱。

我的查询就像，

```
(select id,update_date from table1 where [condition])
UNION
(select id,update_date from table2 where [condition])
order by update_date desc; 
```

我可以通过将 select distinct id from (above query) 添加为 temp 来摆脱重复的 id；但问题是我也需要 update_date 。

任何人都可以建议如何摆脱重复并仍然获得 id 和 update_date 信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:53:53.853

假设您想要重复的最新更新，这个应该可以工作：

```
SELECT id, max(update_date) AS last_update
FROM
  ( (select id,update_date from table1 where [conditions])
     UNION
    (select id,update_date from table2 where [conditions]) ) both_tables
GROUP BY id
ORDER by last_update DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:40:36.917

将查询包装在一个`DISTINCT`块中：

```
SELECT DISTINCT * FROM (
  select id,update_date from table1 where [condition]
  UNION
  select id,update_date from table2 where [condition]
)
order by update_date desc; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:40:45.983

限制第二个查询的结果：

```
select id, update_date
  from table1
 where [conditions]
union
select id, update_date
  from table2
 where [conditions]
   and id not in (select id from table1 where [conditions]) 
```

# mysql - MySQL 表名以下划线开头。特殊意义？

> ID：11347744
> 
> 赞同：2
> 
> 时间：2012-07-05T15:34:55.697
> 
> 标签：mysql, replication

我有一个以下划线开头的表名，这会给表带来任何特殊状态吗？

我之所以问，是因为在某些情况下，该表似乎没有被复制占用。在 MySQL 查询浏览器中，也无法在该表上使用“编辑”功能，但它在所有其他表上。

我们正在使用 MySQL 5.0.37

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:37:38.020

不，它没有什么特别的^^

# jquery - jQuery 图像回旋处仅用于链接正面图像

> ID：11347745
> 
> 赞同：0
> 
> 时间：2012-07-05T15:34:57.973
> 
> 标签：jquery, image

我一直在研究以下链接[http://fredhq.com/projects/roundabout/](http://fredhq.com/projects/roundabout/)中提供的图像回旋处插件，除了我点击哪个链接之外，一切都工作正常；无论是前面还是后面，环形交叉路口确实会滑到前面，但随后会将您带到您刚刚单击的图像的链接......因此使环形交叉路口几乎毫无用处。

我不久前才刚刚开始学习 jQuery，而且经验不足，觉得我可能在这里遗漏了一些简单的东西。我只希望环形交叉路口前面的图像链接到其必要的页面。当我单击前面的任何其他图像时，我只希望环形交叉路口将该图像摆动到前面，然后当该图像位于前面时启用单击链接

以下是我到目前为止所拥有的

**HTML**

```
<section id="carousel">
<ol class="next">
    <li><a href="http://bandonthewall.org/"><img src="assets/images/carousel-item-1.png"></a></li>
    <li><a href="http://google.com"><img src="assets/images/carousel-item-2.png"></a></li>
    <li><a href="http://bandonthewall.org/"><img src="assets/images/carousel-item-3.png"></a></li>
    <li><a href="http://google.com"><img src="assets/images/carousel-item-4.png"></a></li>
    <li><a href="http://bandonthewall.org/"><img src="assets/images/carousel-item-5.png"></a></li>
    <li><a href="http://google.com"><img src="assets/images/carousel-item-6.png"></a></li>
    <li><a href="http://bandonthewall.org/"><img src="assets/images/carousel-item-7.png"></a></li>
    <li><a href="http://google.com"><img src="assets/images/carousel-item-8.png"></a></li>
    <li><a href="http://bandonthewall.org/"><img src="assets/images/carousel-item-9.png"></a></li>
    <li><a href="http://google.com"><img src="assets/images/carousel-item-10.png"></a></li>
    <li><a href="http://bandonthewall.org/"><img src="assets/images/carousel-item-11.png"></a></li>
</ol>
</section> 
```

**查询**

```
$(document).ready(function() {
      $('ol').roundabout({
         btnNext: ".next",
        enableDrag: true,
      });

   $('a').click(function(e){
        link = $(this).attr("href");
        location.href=link;
    });  }); 
```

我真的很感激这方面的帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:01:53.310

而不是这个块：

```
$('a').click(function(e){
    link = $(this).attr("href");
    location.href=link;
}); 
```

尝试这个：

```
$('.roundabout-moveable-item a').click(function(e){
    if($(this).parent('li').hasClass('roundabout-in-focus')) {
        link = $(this).attr("href");
        location.href=link;
    }
    else {
        e.preventDefault();
    }
}); 
```

我所做的是测试`a`的父`li`元素是否是前面的当前元素（这是由插件的 class 指定的`.roundabout-in-focus`）。如果是，则允许链接通过。如果不是（如果它是后面的任何一个），则阻止链接激活。

让我知道这个是否奏效。我对插件不是很熟悉，这是基于快速研究。如果它确实有效，这是上面块的一个更苗条的替代版本：

```
$('.roundabout-moveable-item a').click(function(e){
    if(!$(this).parent('li').hasClass('roundabout-in-focus')) {
        e.preventDefault();
}); 
```

# javascript - 无法实现 JavaScript 代码

> ID：11347753
> 
> 赞同：1
> 
> 时间：2012-07-05T15:35:24.953
> 
> 标签：javascript

我找到了这段代码

```
$(window).scroll(function(){
    $('#header').css({
        //Why this 15, because in the CSS, we have set left 15, so as we scroll, we would want this to  remain at 15px left
        'left': $(this).scrollLeft() + 15  
    });
}); 
```

它完全符合我的需要，但我不知道如何在我的 HTML 或 CSS 中实现它。谁能帮我吗？我真的很感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:39:31.297

该代码使用 jQuery，因此您需要在页面中包含 jQuery。

因为是 JavaScript，所以需要使用`<script />`标签。您可以添加内联代码（我会这样做，因为它更容易解释），但您应该考虑将其添加到单独的 JS 文件中并包含它。

将此添加到您的 HTML 中的任何位置；

```
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script> <!-- Include jQuery -->
<script type="text/javascript">
    $(window).scroll(function(){
        $('#header').css({
            //Why this 15, because in the CSS, we have set left 15, so as we scroll, we would want this to  remain at 15px left
            'left': $(this).scrollLeft() + 15  
        });
    });
</script> 
```

通常你必须添加一个准备好的处理程序，但如果你附加到窗口，你不需要，因为它总是存在的。

# android - 如何在不使用异步任务的情况下避免 networkonmainthread 异常

> ID：11347754
> 
> 赞同：1
> 
> 时间：2012-07-05T15:35:35.173
> 
> 标签：android

我遇到了网络速度非常慢的问题。出于测试目的，我尝试使用 Android 4.0.4 完全删除 asynctask，当然我需要避免在主线程上进行网络调用，否则会出现 networkNotOnMainThread 异常。所以我将我的电话包裹在一个线程中，但我仍然收到此错误。这到底是怎么回事？？

```
public class DrupalTestActivity extends Activity {

    private Context mCtx;

    final static String URL = "http://www.mytestsite.com/";
    final static String ENDPOINT = "rest/";
    String mResponse = null;
    TextView textView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        textView = (TextView) findViewById(R.id.textView);
                //retrieves the user account JSON object.
        JSONObject mUserAccount = UserAccount.getJSONUserAccount(this);
                //login using the JSON
        userLogin(mUserAccount);
    }

    public void userLogin(final JSONObject mUserAccount) {
        Thread t = new Thread() {
            public void run() {
                String uri = URL + ENDPOINT + "user/login";
                HttpPost httppost = new HttpPost(uri);
                httppost.setHeader("Content-type", "application/json");
                StringEntity se;
                try {
                    HttpClient mHttpClient = new DefaultHttpClient();
                    HttpParams mHttpParams = new BasicHttpParams();
                    HttpConnectionParams.setConnectionTimeout(mHttpParams,
                            10000);
                    HttpConnectionParams.setSoTimeout(mHttpParams, 10000);

                    se = new StringEntity(mUserAccount.toString());
                    se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE,
                            "application/json"));
                    httppost.setEntity(se);
                    Log.d("STATUS", "CALLING DRUPAL");
                    ResponseHandler<String> handler = new BasicResponseHandler();
                    mResponse = mHttpClient.execute(httppost, handler);
                    mHttpClient.getConnectionManager().shutdown();

                    Log.d("STATUS", "LOGIN COMPLETE");
                    Log.d("RESPONSE", mResponse);

                } catch (UnsupportedEncodingException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (ClientProtocolException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        };
        t.run();
    }
} 
```

用户帐户方法..我认为这甚至不是问题的一部分。

```
public static JSONObject getJSONUserAccount(Context ctx) {
        SharedPreferences accountSettings = PreferenceManager
                .getDefaultSharedPreferences(ctx);
        String nUsername = accountSettings.getString("username", "tester");
        String nPassword = accountSettings.getString("password", "password");
        JSONObject JSONUser = new JSONObject();
        try {
            JSONUser.put("password", nPassword);
            JSONUser.put("username", nUsername);
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return JSONUser;
    } 
```

日志是..

```
07-05 10:34:58.377: E/AndroidRuntime(32538): FATAL EXCEPTION: main
07-05 10:34:58.377: E/AndroidRuntime(32538): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.seine.drupal/com.seine.drupal.DrupalTestActivity}: android.os.NetworkOnMainThreadException
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2049)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2083)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.ActivityThread.access$600(ActivityThread.java:134)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1233)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.os.Looper.loop(Looper.java:137)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.ActivityThread.main(ActivityThread.java:4697)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at java.lang.reflect.Method.invokeNative(Native Method)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at java.lang.reflect.Method.invoke(Method.java:511)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at dalvik.system.NativeStart.main(Native Method)
07-05 10:34:58.377: E/AndroidRuntime(32538): Caused by: android.os.NetworkOnMainThreadException
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1119)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at java.net.InetAddress.lookupHostByName(InetAddress.java:441)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:243)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at java.net.InetAddress.getAllByName(InetAddress.java:220)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:137)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:653)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:627)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:616)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at com.seine.drupal.DrupalTestActivity.userLogin(DrupalTestActivity.java:90)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at com.seine.drupal.DrupalTestActivity$1.run(DrupalTestActivity.java:65)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at com.seine.drupal.DrupalTestActivity.onCreate(DrupalTestActivity.java:69)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.Activity.performCreate(Activity.java:4539)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
07-05 10:34:58.377: E/AndroidRuntime(32538):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2013)
07-05 10:34:58.377: E/AndroidRuntime(32538):    ... 11 more 
```

我很困惑，这在 ICS 中一定是新事物，因为这一切都适用于早期版本的 android。我真的被迫使用 AsyncTask 吗？我简直不敢相信。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:43:08.910

您正在调用`run()`线程对象而不是`start()`. 调用`run()`只是在主线程上执行你的线程过程。

这条线走

```
t.run(); 
```

in the very end. Should be

```
t.start(); 
```

# c# - 将 C# 自动属性重构为字段和 getter/setter 属性？

> ID：11347756
> 
> 赞同：5
> 
> 时间：2012-07-05T15:35:42.007
> 
> 标签：c#, refactoring

我有一堆带有自动属性的商务舱：

```
public class A {

    public int Id { get; set; }
    public string Title { get; set;}

} 
```

由于应用程序不断发展，因此需要启用跟踪属性更改的新要求，以便仅将更改的数据发送到后备存储。

为了达到这个目标，我必须将所有属性转换为字段 + 属性，如下所示：

```
public class A {

    private int m_Id;
    public int Id {
        get { return m_Id; }
        set {
            if(m_Id != value){
                SetChanged("Id");
                m_Id = value;
            }
        }
    }
    private string m_Title;
    public string Title 
    { 
        get { return m_Title; }
        set {
            if(m_Title != value){
                SetChanged("Title");
                m_Title = value;
            }
        }
    }

    protecte void SetChanged(string propertyName) { 
        // Not important here
    }
} 
```

有没有办法快速重构我的代码以避免手动更改属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:48:09.177

在 IDE 中没有办法做到这一点，但如果您需要替换所有 X 属性，我会编写一个简短的控制台应用程序来做到这一点。

该过程将是：

*   遍历目录中匹配 *.cs 的所有文件
*   Foreach 文件，正则表达式查找并替换旧属性以获得新属性语法

使用正则表达式进行匹配非常强大。正则表达式可以在 VS2010 中用于执行查找/替换操作。如果您尝试找到这个（启用正则表达式）

```
{(public|private|internal|protected)}:b{[a-zA-Z0-9]+}
:b{[a-zA-Z0-9]+}:b\{ get; set; \} 
```

它将匹配这样的属性

```
public Type Foo { get; set; } 
```

在您的控制台应用程序中找到与上述匹配的所有代码行，然后开始将它们拆分为修饰符、类型、属性名称，最后用类似这样的内容替换整个块

```
// PS: this is pseudocode ;-) or could be your new property template
private [Type] m_[PropertyName].ToPascaleCase
public [Type] PropertyName
{
    get { return m_[PropertyName].ToPascaleCase; }
    set
    {
        if(m_[PropertyName].ToPascaleCase != value){
            SetChanged([PropertyName]);
            m_[PropertyName].ToPascaleCase = value;
        }
    }
} 
```

最后，我建议您备份您的代码或离线运行此测试并在签入前进行测试！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:45:15.023

您始终可以创建一个通用方法来执行分配和调用`SetChange`

```
void SetChangeIfNeeded<T>(ref T field, T value, string propertyName)
{
    if (!EqualityComparer<T>.Default.Equals(field, value))
    {
        field = value;
        SetChanged(property);
    }
} 
```

您仍然需要有一个私人后场。你的课程看起来像：

```
public class A {  

    private int m_id
    public int Id 
    { 
        get { return m_id };
        set { SetChangeIfNeeded<int>(ref m_id, value, "Id"); }
    }  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:40:28.247

ReSharper 可以做到这一点，但不会修改 setter。

```
public string Title {
    get { return m_title; }
    set { m_title = value; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T15:51:57.863

折射可能没有直接的方法。如果这是我的问题。我会编写代码来生成这个：

```
public string MakePropertyBigger(string varName, string propName, string dataType)
{
    string output = "";
    output += string.Format("private {0} {1};", dataType, varName) + Environment.NewLine;
    output += string.Format("public {0} {1}", dataType, propName) + Environment.NewLine;
    output += "{" + Environment.NewLine;
    output += string.Format("get { return {0}; }", varName) + Environment.NewLine;
    output += string.Format("set { if({0} != value){ SetChanged(\"{1}\");", varName, propName) + Environment.NewLine;
    output += string.Format("{0} = value; }", varName) + Environment.NewLine;
    output + "}" + Environment.NewLine + "}"; 
```

现在只需将其插入并拔出即可。

# php - CodeIgniter where value in (Field1,Field2)

> ID：11347758
> 
> 赞同：1
> 
> 时间：2012-07-05T15:35:49.057
> 
> 标签：php, mysql, codeigniter

我需要在我的身份验证脚本中设置查询，我想在 WHERE 子句中使用`'_MY_POST_VALUE' IN (Field1, Field2)`

最终查询将是这样的：

`SELECT * FROM 'myprefix_users' WHERE 'myemail@email.com' IN ('EMAIL','LOGIN') AND PASSWORD=SHA1('mypassword')`

我试过这样做：

```
$this->db->where("'" . mysql_escape_string($_POST['login']) . "' IN (EMAIL,LOGIN)", NULL, FALSE);
$this->db->where("PASSWORD=SHA1('" . mysql_real_escape_string($_POST['password']) . "')");
$userdb = $this->db->get('users'); 
```

..但是 CodeIgniter 将前缀设置为我的登录/电子邮件值并发送错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''test@test.com' IN (EMAIL,LOGIN) AND PASSWORD=SHA1('123')' at line 3

SELECT * FROM (`myprefix_users`) WHERE myprefix_'test@test.com' IN (EMAIL,LOGIN) AND PASSWORD=SHA1('123') 
```

我需要在表名中使用 db_prefix，但我的 WHERE 子句中不需要它，即使 ->where() 中的第三个参数（FALSE）对我也不起作用:(

我该如何解决我的问题？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:52:29.340

尝试使用 Codeigniter 的 Input 类。它将简化您的代码：

```
$login = $this->input->post('login', TRUE);
$password = $this->input->post('password', TRUE);
$this->db->where("'$login' IN ", "('EMAIL','LOGIN')", FALSE);
$this->db->where("PASSWORD", "SHA1('$password')", FALSE);
$userdb = $this->db->get('users'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:43:12.397

首先，您不需要数据库语句中的所有不必要的函数。

为什么不这样做：

```
$user = $_POST['user'];
$pass = sha1($pass);

$this->db->where("(email = '$user' OR username = '$user') AND password = '$pass'");
$query = $this->db->get('users'); 
```

您无需担心 mysql 转义，因为 CodeIgniter 类会自动为您转义它们。

# ios - AVAudioRecorder - 正确的 MPEG4 AAC 录制设置

> ID：11347760
> 
> 赞同：8
> 
> 时间：2012-07-05T15:35:57.013
> 
> 标签：ios, ios5, avaudioplayer, avaudiorecorder, avaudiosession

我有一个实时应用程序，估计有 15% 的用户报告说记录功能不起作用。这在我们的测试设备上没有发生，但报告显示问题是 prepareToRecord 返回 NO。我很难找到 AAC 格式的示例设置。我的任何设置都关闭了吗？应用需要 iOS5 并使用 ARC。

```
 AVAudioSession *audioSession = [AVAudioSession sharedInstance];
[audioSession setCategory:AVAudioSessionCategoryRecord error:nil];

NSDictionary *recordSettings = [NSDictionary dictionaryWithObjectsAndKeys:
 [NSNumber numberWithInt:kAudioFormatMPEG4AAC], AVFormatIDKey,
 [NSNumber numberWithFloat:44100.0], AVSampleRateKey,
 [NSNumber numberWithInt:1], AVNumberOfChannelsKey,
 [NSNumber numberWithInt:AVAudioQualityHigh], AVSampleRateConverterAudioQualityKey,
 [NSNumber numberWithInt:128000], AVEncoderBitRateKey,
 [NSNumber numberWithInt:16], AVEncoderBitDepthHintKey,
 nil];

NSString *fileName = [NSString stringWithFormat:@"%@%@.caf", verseGUID, bRecordingReference ? @"_ref" : @""];
NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/%@", [[Utilities sharedInstance] documentsDirectoryPath], fileName]];
NSError *error = nil;
audioRecorder = [[AVAudioRecorder alloc] initWithURL:url settings:recordSettings error:&error];
if([audioRecorder prepareToRecord]){
    [audioRecorder record];
}else{
    int errorCode = CFSwapInt32HostToBig([error code]);
    NSLog(@"Error: %@ [%4.4s])", [error localizedDescription], (char*)&errorCode);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:29:31.157

可能很多事情都与录制设置无关。

您想要回答的真正问题似乎是：什么会导致录制不发生？

audioRecorder 可能为 nil 或 audioRecorder prepareToPlay 可能返回 NO。前者似乎更有可能。

传递给 initWithURL 的 url 可能格式不正确： - 您是否通过使用 verseGUID、bRecordReference 值进行了测试？也许您的设备永远不会有错误的 verseGUID，但是没有发生录制的设备的 verseGUID 为零/空。这可能导致文件名只是“.caf”。

您似乎有自己的类方法 [Utilities sharedInstance] 。由于某种原因，这可以在您的设备上工作，但不能在故障设备上工作吗？如果是这样，您可能会要求在您无意中记录在顶级目录中。

你能让你拥有的测试人员进入“测试版”列表吗？注册 TestFlight 或 Hockey Kit 之类的东西，让一个或多个录制失败的用户也注册，然后上传您的应用程序的测试版，其中包含诊断程序，在屏幕上显示一个对话框并显示“错误”。这可能是最明显的。我使用 testflightapp.com 只是因为它是我第一次尝试，它对我来说很容易管理并且对我的 beta 测试人员来说非常轻松。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:13:21.567

试试这个我用来录制 MPEG 4 AAC 格式的设置......它工作得很好......

```
NSString *tempDir = NSTemporaryDirectory();
NSString *soundFilePath = [tempDir stringByAppendingPathComponent:@"sound.m4a"];

NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];
NSDictionary *recordSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                  [NSNumber numberWithInt:kAudioFormatMPEG4AAC], AVFormatIDKey,
                                  [NSNumber numberWithInt:AVAudioQualityMin], AVEncoderAudioQualityKey,
                                  [NSNumber numberWithInt: 1], AVNumberOfChannelsKey,
                                  [NSNumber numberWithFloat:8000.0], AVSampleRateKey,
                                  nil]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-05T21:13:03.873

抱歉，这有点切题，但我刚刚遇到了一个非常相似的问题，许多用户无法录制，我认为这与音频设置有关。

但是对我来说，事实证明他们拒绝了访问麦克风的权限。这意味着它`prepareToRecord`正在工作（并截断文件）并`record`报告它正在工作，但实际上它没有记录任何内容。

当我想录制时，我使用了这个：

```
AVAudioSession.sharedInstance().requestRecordPermission({(granted: Bool)-> Void in
    if granted {
        // can record - create AVAudioRecorder here

    } else {
        // can't record - update UI (or react accordingly)
    }
}) 
```

希望如果他们遇到类似的问题，它可以节省一些时间。

# amazon-ec2 - 成为 EC2 上的根设备意味着什么？

> ID：11347768
> 
> 赞同：9
> 
> 时间：2012-07-05T15:36:16.687
> 
> 标签：amazon-ec2, amazon-ebs

我在 EC2 文档中找不到答案。它是干什么用的？如果我启动了一个 EBS 支持的实例，该实例的根设备将是一个 EBS 卷。如果我在实例上安装了一些工具/软件，它们会默认安装在根实例上吗？不过我猜这个问题真的来自对根设备的了解。有这方面的详细信息吗？

此外，如果我需要启动另一个 EBS 支持的实例，并且还希望在早期实例上安装相同的工具/软件副本，该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T16:19:57.667

[EC2 实例有两种类型的存储——临时存储和基于 EBS 的存储——默认情况下](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/InstanceStorage.html)，每个实例都有特定数量的磁盘空间。每个实例都有自己可以使用的磁盘空间分配，独立于您启动的任何其他实例磁盘空间。您还可以将 EBS 卷添加到您的驱动器以获得额外的存储空间，但是这些卷一次只能附加到一个特定的主机。

如果您有两个 EBS 实例，并且希望确保它们都使用相同的工具和软件，则需要使用配置管理工具（例如 puppet、chef 或 cfengine）来强制执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T20:52:47.613

我同意伊恩写的。我要补充一点，EC2 中的“根设备”类似于个人计算机中的操作系统分区。它是您操作系统的文件系统所在的位置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-04T17:18:37.790

这是迄今为止关于“根设备”的最佳答案！AWS 仍然是新事物。大多数时候，答案只是直接从 AWS 文档中“剪切和粘贴”，这并没有多大帮助！

[https://web.archive.org/web/20140601070714/https://skeddly.desk.com/customer/portal/articles/1346918-ebs-backed-versus-instance-store](https://web.archive.org/web/20140601070714/https://skeddly.desk.com/customer/portal/articles/1346918-ebs-backed-versus-instance-store)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-14T21:09:20.680

自从您询问以来，这可能已添加，但我相信这可以回答问题：

[http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html)

# vb.net - 返回 vb.net 中的前一个索引？

> ID：11347770
> 
> 赞同：2
> 
> 时间：2012-07-05T15:36:20.803
> 
> 标签：vb.net, arrays, foreach

我有一个 For Each 循环，它遍历字符串数组以查找长度为三个字符的第一个字符串。例如，在遍历数组时，如果前 3 个字符串是数组的第 4 个索引，我希望它返回数组的第 3 个（前一个）索引。任何帮助，将不胜感激。

```
For Each piece As String In p
        If piece.Length = 3 Then
            'Return previous index
        End If
Next 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:41:31.833

你有几个选择。

如果`p`是可通过索引访问的集合（即：）`IList(Of T)`，则可以切换到 For 循环，并返回当前索引 -1 处的元素。

否则，您可以将前一项保存在单独的变量中，并在满足您的条件时返回它。

```
Dim lastItem as String
For Each piece As String In p
    If piece.Length = 3 Then
        Return lastItem ' Will return Nothing if this is the first item...
    End If
    lastItem = piece ' Store this for next time
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:43:49.133

像这样的东西怎么样：

```
 For i As Integer = 1 To p.Count - 1
        If p(i).Length = 3 Then
            'Return previous index
            Return p(i - 1)
        End If
    Next 
```

请注意，循环必须从 1（不是零）开始，否则您可以返回不存在的数组的第 (0-1) 个元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T16:17:15.907

我会使用`.FindIndex`，如果你有`List(Of T)`：

```
Dim i As Integer = p.FindIndex(Function(x) x.Length = 3)

If i > 0 Then
    Dim previous As String = p(i - 1)

    'Do something
End If 
```

如果您有`String()`，您还可以使用以下`Array`版本：

```
Array.FindIndex(Of String)(p, Function(x) x.Length = 3) 
```

# binary-decision-diagram - 可以从 CUDD 管理器中删除变量吗？

> ID：11347774
> 
> 赞同：2
> 
> 时间：2012-07-05T15:36:35.390
> 
> 标签：binary-decision-diagram, cudd

谁能告诉我是否可以安全地从 CUDD 的经理中删除变量？例如：我通过`v1 = Cudd_bddNewVar(manager)`;注册了两个变量 和`v2 = Cudd_bddNewVar(manager)`。我可以`v2`从管理员中删除吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T11:09:44.307

我认为不可能删除创建的变量。

# email - 无法在 PowerShell 2.0 中使用 send-mailmessage 向外部域发送电子邮件

> ID：11347775
> 
> 赞同：1
> 
> 时间：2012-07-05T15:36:36.067
> 
> 标签：email, powershell

我正在尝试从 powershell 2.0 脚本发送电子邮件。发送给我域中其他收件人的邮件已正确传递，但外部域无法接收邮件。我尝试将外部电子邮件地址作为字符串、数组和明确地作为该类收件人的唯一参数传递给 send-mailmessage，并且消息不会发出。我正在中继添加到我的 Exchange 2007 服务器的 SMTP 连接器。有任何想法吗？我收到一条错误消息，上面写着“无法发送给收件人”

> Send-Mailmessage <<<< -To $testto -From $Mailfrom -Cc $testcc -Subject "..." -Body "..." -SmtpServer "xxxx" +CategoryInfo : InvalidOperation: (System.Net.Mail. SmtpClient:SmtpClient) [Send-Mailmessage], SmtpFailedRecipientsException +FullyQualifiedErrorID : SmtpFailedRecipientsException,Microsoft.PowerShell.Commands.SendMailmessage

这是分辨率错误吗？我正在使用 gmail 帐户作为测试收件人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T18:54:14.083

感谢您提供的信息 - 我开始研究 Exchange 2007，并且我已经开始进行中继以正常工作。您需要做的是编辑用于中继 SMTP 邮件的接收连接器上的属性。将权限组设置为 Exchange 服务器和匿名用户，并将身份验证设置为外部安全。这使脚本能够在外部和内部发送消息。与往常一样，请记住在尝试之前彻底遵循此类安全和研究主题的最佳实践。

# javascript - jQuery：从 .text() 中排除子级

> ID：11347779
> 
> 赞同：50
> 
> 时间：2012-07-05T15:37:01.083
> 
> 标签：javascript, jquery

鉴于此 HTML：

```
<a href="#" class="artist">Soulive<span class="create-play">Play</span></a> 
```

我想在没有 的文本内容的情况下获取`a`（`this`在我的函数的上下文中）*的*文本内容`span`，所以我只剩下：

```
Soulive 
```

如果我做：

```
$(this).text(); 
```

我得到：

```
SoulivePlay 
```

如何排除的文本内容`span`？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-07-05T16:11:56.190

一个微插件：

```
$.fn.ignore = function(sel) {
  return this.clone().find(sel || ">*").remove().end();
}; 
```

...拥有这个 HTML：

```
<div id="test"><b>Hello</b><span> World</span>!!!</div> 
```

将导致：

```
var text = $('#test').ignore("span").text(); // "Hello!!!"
var html = $('#test').ignore("span").html(); // "<b>Hello</b>!!!" 
```

* * *

^(if you want it faster and you need only to exclude the immediate children... use `.children(` instead of `.find(`)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-07-05T15:46:40.693

[http://jsfiddle.net/r8kNL/](http://jsfiddle.net/r8kNL/)

```
$(this).contents().filter(function() {
  return this.nodeType == 3;
}).text() 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-05T15:41:50.087

```
$(this).clone().find('span').remove().end().text(); 
```

否则，用不同的方法，如果你确定你的`span`元素最后总是包含“play”这个词，只需使用一个`replace()`或一个`substring()`函数，例如

```
var text = $(this).text();
text = text.substring(0, text.length-4); 
```

后一个示例肯定是一种过于本地化且不是防弹的方法，但我提到只是为了从不同的角度提出解决方案

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T15:41:43.363

```
$( this.childNodes ).map( function(){
    return this.nodeType === 3 && this.nodeValue || "";
}).get().join(""); 
```

# image - jquery touchmove 事件和非常大的内容

> ID：11347785
> 
> 赞同：0
> 
> 时间：2012-07-05T15:37:24.167
> 
> 标签：image, mobile, touch-event

我有非常大的内容（很多图片）。我想使用 css3 转换转换。我绑定到 touchmove 事件，并计算新的 x 位置。

但我有问题：x 的位置在移动设备上变化不顺畅（在桌面上一切正常）。Event Touch 带有延迟。

我尝试隐藏不使用的内容（可见性：隐藏）它没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:48:33.427

尝试限制事件处理程序进行更改的速度。这是违反直觉的，但通过放慢速度，你会让它们看起来更快。touchmove 事件的触发速度非常快，远远快于屏幕的刷新率。

理想情况下，您会使用[requestAnimationFrame](https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame)来做到这一点。

或者，如果这对您的口味来说太实验性了，只需确保您执行事件处理程序操作的速度不超过每秒 60 帧（每 1000/60 毫秒 1 个事件处理程序操作，屏幕的刷新率）。如果在 1000/60 毫秒时仍有问题，请尝试更慢的速率。视频的帧速率为每秒 30 帧。30 到 60 帧之间的内容应该看起来不错。

所以看起来像这样：

```
var lastFrameTime;
var myTouchMoveHandler = function (e) {
    var now = Date.now();
    if (now < lastFrameTime + 1000/60) {
        return;
    }
    // your event handler code afterward
    // ...
    // then update the lastFrameTime 
    lastFrameTime = now;
} 
```

# android - 如何避免在 Android 中加载图像视图后重置整个视图？

> ID：11347791
> 
> 赞同：0
> 
> 时间：2012-07-05T15:37:41.490
> 
> 标签：android, imageview

我正在开发一个从远程服务器加载大量图像的 Android 项目。

我正在使用此实用程序下载图像：

[http://code.google.com/p/android-imagedownloader/](http://code.google.com/p/android-imagedownloader/)

主要问题是当任何图像下载完成时，整个屏幕似乎都会重置。

随着视图的重置，动画 UI 控件的位置也会重置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:58:34.183

该代码基于两年前的一篇文章，此后 Android 开发人员提供了更好的信息和方法来处理 ListView Adaptewr 中的异步图像。

理想情况下，您应该实现一个 ImageDownload 类或某种类型，并使用`notifyDataSetChanged();`您的调用`ListViewAdpater`来正确更新视图。

**创建一个 ImageLoadedCallback：**

```
// Interfaces
public interface ImageLoadedCallback {
  public void imageLoaded(Drawable imageDrawable, String imageUrl);
} 
```

**在您的 ListAdapter 上实现它：**

这段代码所做的就是让下一个项目显示在列表中，然后查看我们是否有可用的图像，如果有的话 - 设置它。如果没有，发送我们的异步请求来加载它，然后让适配器知道它已经准备好了。

```
public class ArticleAdapter extends SimpleCursorAdapter implements ImageLoadedCallback {
  @Override
  public View getView(int position, View convertView, ViewGroup parent) {
    if(getCursor().moveToPosition(position)) {
      ViewHolder viewHolder;

      if(convertView == null) {
        convertView = inflater.inflate(R.layout.article_list_item, null);
        viewHolder = new ViewHolder();
        viewHolder.image = (ImageView) convertView.findViewById(R.id.imgArticleImage);
        convertView.setTag(viewHolder);
      } else {
        viewHolder = (ViewHolder) convertView.getTag();
      }
      String image = getCursor().getString(getCursor().getColumnIndex("thumbURL"));
      if(imgCache.hasImage(image)) {
        viewHolder.image.setImageDrawable(imgCache.loadDrawable(image, this));
      } else {
       imgCache.loadDrawable(image, this);
      }
    }
    return convertView;
  }

  public void imageLoaded(Drawable imageDrawable, String imageUrl) {
    this.notifyDataSetChanged();
  }
} 
```

# sql - 尝试在 PIVOT 中使用 CONVERT 时出现语法错误

> ID：11347794
> 
> 赞同：2
> 
> 时间：2012-07-05T15:37:43.783
> 
> 标签：sql, sql-server-2005

当我尝试执行下面的查询时，出现错误

> 关键字“convert”附近的语法不正确

而且我不确定我在哪里犯了错误。qty 字段的数据类型是 nchar，所以我使用转换函数来查找总计。

```
select column_date, [red] as red, [blue] as blue, [green] as green, [yellow] as yellow 
from
(select * from table1) as t1
pivot
(
sum(convert(int,qty)) 
For color in 
([red], [blue], [green], [yellow])
) as SumofQuantityforeachcolor 
```

这是桌子

```
column_date | color | qty | supplier
1 June 2012 | red   | 2   | XY
1 June 2012 | red   | 1   | AB
1 June 2012 | blue  | 4   | CD
1 June 2012 | blue  | 1   | XY
2 June 2012 | yellow| 13  | CD
2 June 2012 | green | 45  | CD
2 June 2012 | blue  | 32  | AB
2 June 2012 | red   | 37  | XY
2 June 2012 | red   | 2   | XY
2 June 2012 | red   | 1   | AB
2 June 2012 | blue  | 4   | CD
3 June 2012 | red   | 1   | AB
3 June 2012 | blue  | 4   | CD
3 June 2012 | blue  | 1   | XY
3 June 2012 | yellow| 13  | CD
3 June 2012 | green | 45  | CD
3 June 2012 | blue  | 32  | AB 
```

等等...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T18:02:11.843

不要`select *`在您的子查询中使用。列出您需要的所有列，并在字段列表中而不是在`sum()`函数中进行类型转换。

枢轴中的聚合函数不将表达式作为参数。您必须指定一列。

```
<pivot_clause> ::=
        ( aggregate_function ( value_column [ [ , ]...n ]) 
        FOR pivot_column 
        IN ( <column_list> ) 
    ) 
```

您可能正在寻找类似的东西。

```
select column_date, [red] as red, [blue] as blue, [green] as green, [yellow] as yellow 
from (
     select column_date,
            color,
            cast(qty as int) as qty
     from table1
     ) as T
pivot
     (
     sum(qty) 
     for color in ([red], [blue], [green], [yellow])
     ) as SumofQuantityforeachcolor 
```

[SE-数据](https://data.stackexchange.com/stackoverflow/query/74708)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T15:39:42.877

你试过`cast(gty as int)`吗？

# android - 从 Android 设备使用 Google OpenID，无需用户名/密码

> ID：11347801
> 
> 赞同：3
> 
> 时间：2012-07-05T15:38:25.313
> 
> 标签：android, authentication, openid

目前，我可以使用 OpenID（以 Google 作为提供者）对我的 webapp 进行身份验证。我的 Android 应用程序通过通常的 OpenID 身份验证流程。但是，我想使用与 Android 设备关联的 Google 帐户，而不是要求用户输入他们的用户名/密码。这可能吗？

我一直在玩 AccountManager，但它似乎只允许对 Google 服务进行身份验证。可能是我没有找到合适的身份验证令牌类型。

# java - JAR 创建问题

> ID：11347803
> 
> 赞同：-1
> 
> 时间：2012-07-05T15:38:42.980
> 
> 标签：java, eclipse, jar

抱歉，如果这是一个简单的问题，但我无法将我的 java 项目导出到 JAR 文件中。我收到以下错误：

```
JAR creation failed. See details for additional information.
  com/appiancorp/plugins/capitalize/theFunction [in Capitalize] is not on its project's build path
  Unable to get package fragment root: Capitalize/com/appiancorp/plugins/capitalize/theFunction/Capitalize.java
    com/appiancorp/plugins/capitalize/theFunction [in Capitalize] is not on its project's build path 
```

我想我需要将“theFunction”类添加到我的构建路径中？但我不明白该怎么做......谢谢你的帮助

编辑：我在我的项目中使用来自 StringTokenizer 类的文件，因此从 java.util.StringTokenizer 导入东西。问题可能是我没有将该类添加到 JAR 文件中吗？

达比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:09:41.043

缺少的类属于公司（3d 方） [http://www.appian.com/](http://www.appian.com/)的一个 jar， 您需要找到该缺少的 jar 并将其添加到类路径

# objective-c - Objective-c：将纹理加载到 OpenGL 的最有效方法

> ID：11347804
> 
> 赞同：2
> 
> 时间：2012-07-05T15:38:43.040
> 
> 标签：objective-c, ios, opengl-es, core-graphics

目前，我使用 Image I/O 在 iOS 中加载纹理，并使用 Core Graphics 提取其图像数据。然后我可以像这样将图像数据发送到OpenGL：

```
 glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, texture->width, texture->height, 0, GL_RGBA, GL_UNSIGNED_BYTE, texture->imageData); 
```

问题是核心图形部分真的很慢，我需要设置和绘制核心图形只是为了提取图像数据......我不想在屏幕上显示它。iOS中一定有更高效的方法来提取图像数据？...

这是我的代码：

```
...
myTexRef = CGImageSourceCreateWithURL((__bridge CFURLRef)url, myOptions);
...
MyTexture2D* texture;

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

void *imageData = malloc( tileSize.width * tileSize.height * 4 );

CGContextRef imgContext = CGBitmapContextCreate( imageData, tileSize.width, tileSize.height, 8, 4 * tileSize.width, colorSpace, kCGImageAlphaNoneSkipLast | kCGBitmapByteOrder32Big);
CGColorSpaceRelease( colorSpace );
CGContextClearRect( imgContext, CGRectMake( 0, 0, tileSize.width, tileSize.height ) );
CGContextTranslateCTM( imgContext, 0, 0 );
...
CGImageRef tiledImage = CGImageCreateWithImageInRect (imageRef, tileArea);
CGRect drawRect = CGRectMake(0, 0, tileSize.width, tileSize.height);

// *** THIS CALL IS REALLY EXPENSIVE!
CGContextDrawImage(imgContext, drawRect, tiledImage);

CGImageRelease(tiledImage);

// TamTexture2D takes the ownership of imageData and will be responsible to free it
texture = new MyTexture2D(tileSize.width, tileSize.height, imageData);

CGContextRelease(imgContext); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:31:24.370

如果您正在为 iOS 5 及更高版本进行开发，[`GLKTextureLoader`](http://developer.apple.com/library/ios/#documentation/GLkit/Reference/GLKTextureLoader_ClassRef/Reference/Reference.html#//apple_ref/doc/uid/TP40010922)那么您正在寻找的是：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-02T20:25:38.107

GLKTextureLoader 比使用 CG 慢几个数量级。

我已将此记录为 Apple DTS 的错误，并将其退回为“是的，我们知道，不在乎，不会修复它。如果您希望快速加载纹理，则应该使用 CoreGraphics 代替” （几乎是那个措辞）

如果您将 CGContext* 方法为您创建/允许您传入的原始缓冲区提供给它，glTexImage2D 会非常快。当然，假设您获得了正确的 RGBA/ARGB/etc 色彩空间。

cgcontextDrawImage 也超级快。我的猜测是通过网络加载数据需要时间......

# c# - HttpSelfHostServer 和 HttpContext.Current

> ID：11347807
> 
> 赞同：18
> 
> 时间：2012-07-05T15:38:54.797
> 
> 标签：c#, asp.net-web-api, httpcontext, self-hosting

我正在开发一个自托管的 ASP.NET Web api 应用程序。一切正常，但现在我正在努力`HttpContext`：

我需要保存来自客户端的会话信息。但`HttpContext.Current`始终为空。所以很明显，我`HttpSelfHostServer`不使用静态 HttpContext-Class。

我不明白的是：为什么..？而且我想不出一种既不告诉`HtttpSelfHostServer`也不`HttpSelfHostConfiguration`使用的方法`HttpContext`。

这就是我正在做的事情：

1.  创建一个`HttpSelfHostConfiguration`

    *   1.1 添加`Service-Resolvers`&`Routes`
    *   1.2 添加自定义`UserNamePassword-Validator`
2.  使用配置创建新的 HttpSelfHostServer 实例

    *   2.1`server.OpenAsync().Wait()`

`HttpContext.Current`非常感谢我如何告诉我的服务器使用的任何帮助！干杯!

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-15T22:22:05.107

您将无法在自托管环境中使用 HttpContext。HttpContext 是由 ASP.Net 管道设置的，如果你不在 IIS/ASP.Net 下运行，你就不会拥有它。

HttpContext 仅在 Web-Hosting 模式下可用，其中 HttpControllerHandler 创建请求。

仅供参考-我邀请您阅读 Pedro Felix 的以下精彩文章，以更好地了解不同的托管模型：

*   [HTTP 处理架构概述](http://pfelix.wordpress.com/2012/03/05/asp-net-web-api-processing-architecture/)
*   [虚拟主机](http://pfelix.wordpress.com/2012/03/07/asp-net-web-api-web-hosting/)
*   [自托管](http://pfelix.wordpress.com/2012/03/08/asp-net-web-api-self-hosting/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-28T01:10:53.650

为了解决这个问题（我发现我现在使用了很多需要在 Web API 和 MVC 中同样工作的组件），你可以试试我写的这个旧 shim 给你一个类似 HttpContext 的接口两种口味。它也在 NuGet 上，这里是来源： [github 上的链接](https://github.com/danielcrenna/graveyard/tree/master/httpcontext-shim) （或[Nuget 上](https://www.nuget.org/packages/HttpContextShim)的链接）

# iphone - xcodebuild 错误

> ID：11347809
> 
> 赞同：1
> 
> 时间：2012-07-05T15:39:06.583
> 
> 标签：iphone, ios, xcode, ipad, jenkins

尝试使用 xcodebuild 时遇到一个非常奇怪的错误。以下是正在记录的错误。

> xcodebuild clean build -configuration Release -target WhiteLabelLibrary -sdk iphoneos 2012-07-05 10:27 xcodebuild[83795] (CarbonCore.framework) FSEventStreamStart: ERROR: FSEvents_connect() => (ipc/send) invalid destination port (268435459) 2012 -07-05 10:27 xcodebuild[83795]（CarbonCore.framework）FSEventStreamInvalidate（）：断言失败'streamRef！= NULL'
> 
> 2012-07-05 10:27 xcodebuild[83795]（CarbonCore.framework）FSEventStreamRelease（）：断言失败'streamRef！= NULL'
> 
> 2012-07-05 10:27:38.570 xcodebuild[83795:1603] [?T] 无法启动 fs 事件流。xcodebuild：错误：初始化失败。原因：扫描插件失败。

有没有人经历过这个错误？我不知道如何解决这个错误。

谢谢

# iphone - 适应多种对象类型的方法？

> ID：11347810
> 
> 赞同：1
> 
> 时间：2012-07-05T15:39:09.900
> 
> 标签：iphone, objective-c, ipad

我有这个方法可以让我翻译一个对象的位置，在我的 iPhone 应用程序中动画它的移动：

```
-(void)translatePositionForLabel:(UILabel *)label toFrame:(CGRect)newFrame
{
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    label.frame = newFrame;
    [UIView commitAnimations];
} 
```

您可以看到这适用于`UILabels`，但是没有此方法的副本（只是将对象交换为 say `UIButton`），无论如何我可以调整此方法，以便可以通过框架传递任何对象吗？而不是每个对象类型都需要一个单独的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:44:34.577

两者`UILabel`都有`UIButton`共同的祖先`UIView`；尝试传递它来代替`label`（您似乎只修改了标签的`frame`属性，该属性在 中定义`UIView`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T16:00:04.243

您还可以为`UIView`使用动画移动的方法创建一个类别：

**UIView+Additions.h**

```
@interface UIView (Additions)

- (void)setFrame:(CGRect)frame animated:(BOOL)animated;

- (void)translateToPoint:(CGPoint)point animated:(BOOL)animated;

@end 
```

**UIView+Additions.m**

```
@implementation UIView (Additions)

- (void)setFrame:(CGRect)newFrame animated:(BOOL)animated {
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    self.frame = newFrame;
    [UIView commitAnimations];
}

- (void)translateToPoint:(CGPoint)point animated:(BOOL)animated {
    CGRect newFrame = self.frame;
    newFrame.origin = point;
    [self setFrame:newFrame animated:animated];
}

@end 
```

现在您可以调用`[button setFrame:newFrame animated:YES]`或`[label setFrame:newFrame animated:YES]`。

# iphone - 如何在自身内部获取自己的视图控制器？

> ID：11347812
> 
> 赞同：0
> 
> 时间：2012-07-05T15:39:14.910
> 
> 标签：iphone, objective-c, xcode, delegates, cs193p

```
@interface RecentPhotosViewController () <PhotoViewControllerDelegate>

- (void)viewDidLoad
{
    [super viewDidLoad];
    [[self.tabBarController.viewControllers objectAtIndex:1] setDelegate:self];
} 
```

RecentPhotosViewController 是一个实现委托的 tableviewcontroller。

我想在 vieDidLoad() 中将 self(RecentPhotosViewController) 设置为委托，但是当我尝试输入：self.setDelegate 时发现 self 没有这个 setDelegate 方法，然后我尝试了这个：[[self.tabBarController.viewControllers objectAtIndex:1] setDelegate:self];(这个tableview是tabBarControllers的viewcontrollers之一。

然后我得到一个错误：[RecentPhotosViewController setDelegate:]: unrecognized selector sent to instance 0xc939960\. 我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T02:18:26.553

做这个：

```
@interface RecentPhotosViewController

//etc.

@property (nonatomic, assign) id delegate;

@end

@implementation RecentPhotosViewController

// etc.

@synthesize delegate;

@end 
```

# java - android以编程方式重绘布局

> ID：11347823
> 
> 赞同：6
> 
> 时间：2012-07-05T15:39:59.663
> 
> 标签：java, android, eclipse

我的布局有时无法正确定位元素。我尝试了很多解决方案，但独特的工作方式是从纵向旋转到横向，然后从横向返回到纵向。然后布局会自动重绘并完美契合。我设置了方向|键盘，所以内容不会重新加载，只会重绘。如何像风景肖像一样以编程方式重绘内容？谢谢你。

编辑：我尝试了以下但没有效果

```
getWindow().getDecorView().findViewById(android.R.id.content).invalidate();
getWindow().getDecorView().findViewById(android.R.id.content).requestLayout(); 
```

Activity 在 onCreate 上设置了主布局`setContentView(R.layout.main);`

布局“main”包含 TabHost 和 Admob。布局“视图”包含一个显示在 tab1 上的 web 视图（“id:myWebview”）。

并且还试图使它们无效！webview，布局主和布局视图和崩溃

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T15:58:44.507

你试过[`invalidate()`](http://developer.android.com/reference/android/view/View.html#invalidate%28%29)根[视图](https://stackoverflow.com/q/4486034/559745)吗？

```
findViewById(android.R.id.content).invalidate(); 
```

这应该重绘整个布局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T16:01:44.270

当屏幕方向改变时，Android 会重新创建当前的 Activity。

尝试调用[measure(int, int)](http://developer.android.com/reference/android/view/View.html#measure%28int,%20int%29)或[requestLayout()](http://developer.android.com/reference/android/view/View.html#requestLayout%28%29)。否则就没有机会以编程方式重新布局视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T16:04:59.703

仅调用[requestLayout()](http://developer.android.com/reference/android/view/View.html#requestLayout%28%29)并阅读[View](http://developer.android.com/reference/android/view/View.html)类描述以获取更多信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-10T14:31:08.033

如果这是不安全或不好的做法，请纠正我。我也尝试了所有这些方法，出于绝望决定再次尝试调用我的 onCreate 并且它起作用了。所以现在我将在`onCreate(null)`更新数据时使用它来刷新我的视图。再次，请让我知道这是否不安全或不好的做法，如果可能的话，还有一个可行的替代方案。

# jquery - 为什么这个 jQuery .each 不能正确循环 json 数据？

> ID：11347825
> 
> 赞同：4
> 
> 时间：2012-07-05T15:40:14.047
> 
> 标签：jquery, json, loops

这是我的ajax调用：

```
$.ajax({ 
    url: 'url-to-json',
    type: 'POST',
    dataType: 'json',
    cache: 'false',
    data: { lat: lat, lng: lng }
}).done(function(data) {
    $.each(data, function(a) {
        alert(data[a]);
    });
}); 
```

这是它正在迭代的json：

```
[
{"Id":"4c75bd5666be6dcb9f70c10f","Name":"BXtra","EnglishName":null,"Lat":35.7515869140625,"Lng":139.33872985839844},

{"Id":"4c5160a1d2a7c9b655d51211","Name":"セブンイレブン 武蔵野台店","EnglishName":null,"Lat":35.750205993652344,"Lng":139.33448791503906},

...
] 
```

但实际上并没有让我访问 json 数组中每个项目的属性，而是逐个循环遍历数组中的每个字符。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T15:49:06.400

您可以通过`$.each`两种方式修改函数：

```
$.each(data, function(index,el) {
    // el = object in array
    // access attributes: el.Id, el.Name, etc
}); 
```

或者，

```
$.each(data, function() {
    // this = object in array
    // access attributes: this.Id, this.Name, etc
}); 
```

如果`data`是`done`函数中的字符串而不是对象，那么您需要运行

```
data = $.parseJSON(data) 
```

在你的`$.each`循环之前

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T15:43:58.940

用于`this`引用内部的当前元素`.each`：

```
$.ajax({ 
    url: 'url-to-json',
    type: 'POST',
    dataType: 'json',
    cache: 'false',
    data: { lat: lat, lng: lng }
}).done(function(data) {
    $.each(data, function() {
        alert(this.Id);
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T16:00:59.137

也许您的服务器没有为 JSON ('application/json') 返回正确的 MIME 类型，而 JQuery 将它解释为只是一个字符串？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T16:13:36.017

使用成功总是对我有用：

```
$.ajax({ 
  url: 'url-to-json',
  type: 'POST',
  dataType: 'json',
  cache: 'false',
  data: { lat: lat, lng: lng },
  success: function(data) {
    $.each(data, function() {
      alert(this.Id);
    });
  }
}); 
```

强制解析 JSON 将是：`jQuery.parseJSON( json )`如果 dataType 正在播放，则作为临时修复...

# c# - 在 C# 中使用委托作为属性是否正确？

> ID：11347830
> 
> 赞同：4
> 
> 时间：2012-07-05T15:40:25.157
> 
> 标签：c#, properties, delegates

我需要创建一个具有两个属性的类：

1.  日志输出
2.  异常输出

这些属性 (Actions<>) 根据目标函数发送消息或异常。这个目标函数是通过属性设置的。

目前，我有这个功能代码：

```
 public class Output
    {
        private Action<string> logOutput;
        private Action<Exception, string> exceptionOutput;

        public Action<string> LogOutput { set { this.logOutput = value; } get { return this.logOutput; } }
        public Action<Exception, string> ExceptionOutput { set { this.exceptionOutput = value; } get { return this.exceptionOutput; } }

        public Output() : this(null, null) { }

        public Output(Action<string> logAction, Action<Exception, string> exceptionAction) 
        {
            this.logOutput = logAction;
            this.exceptionOutput = exceptionAction;
        }

        public void WriteLogMessage(string format, params object[] args) 
        {
            if (this.logOutput != null)
                logOutput(string.Format(format, args));
        }

        public void WriteExceptionMessage(Exception ex, string format, params object[] args) 
        {
            if (this.exceptionOutput != null)
                exceptionOutput(ex, string.Format(format, args));
        }
    } 
```

这是我的表单代码：

```
 private void MainForm_Load(object sender, EventArgs e)
    {
        // my Output object
        Output myOutput = new Output();

        // set properties
        myOutput.ExceptionOutput = this.WriteExceptionMessageToTextBox;
        myOutput.LogOutput = this.WriteLogMessageToTextBox;

        // test
        myOutput.WriteLogMessage("this is my log message to text box");
        myOutput.WriteExceptionMessage(new Exception("this is my exception"), "this is my exception message to text box");
    }

    private void WriteLogMessageToTextBox(string message)
    {
        // nothing to do here
        if (this.txtBox.IsDisposed)
            return;

        if (this.InvokeRequired)
        {
            BeginInvoke(new MethodInvoker(delegate() { WriteLogMessageToTextBox(message); }));
        }
        else 
        {
            // write to text box
            this.txtBox.AppendText(message + Environment.NewLine);
        }
    }

    private void WriteExceptionMessageToTextBox(Exception ex, string message)
    {
        // nothing to do here
        if (this.txtBox.IsDisposed)
            return;

        if (this.InvokeRequired)
        {
            BeginInvoke(new MethodInvoker(delegate() { WriteExceptionMessageToTextBox(ex, message); }));
        }
        else
        {
            string msg = "";
            msg += string.Format("Program:{0}", message);
            msg += string.Format("Message{0}", ex.Message);
            msg += string.Format("StackTrace:{0}", ex.StackTrace);
            msg += string.Format("Source:{0}", ex.Source);

            // write to text box
            this.txtBox.AppendText(msg + Environment.NewLine);
        }
    } 
```

这个模型对吗？还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T15:43:31.037

> 这个模型对吗？还有另一种方法可以做到这一点吗？

这没有什么错，必然。但是，[事件](http://msdn.microsoft.com/en-us/library/awbftdfh.aspx) *可能*是一种更常见的处理方法，因为您在这种情况下有效地将委托用作事件。

使用事件确实有一个显着的优势（可能），因为您还可以轻松地拥有多个订阅者，这将使允许多个项目“侦听”异常或记录消息变得简单。（*虽然这也适用于代表，但它不是使用代表的标准方式..）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:45:55.397

对不起题外话，但`StringBuilder` `string`不喜欢使用编辑

```
 string msg = "";
            msg += string.Format("Program:{0}", message);
            msg += string.Format("Message{0}", ex.Message);
            msg += string.Format("StackTrace:{0}", ex.StackTrace);
            msg += string.Format("Source:{0}", ex.Source);

            StringBuilder sb = new StringBuilder();
            sb.Append(string.Format("Program:{0}", message));
            sb.Append(string.Format("Message{0}", ex.Message));
            sb.Append(string.Format("StackTrace:{0}", ex.StackTrace));
            sb.Append(string.Format("Source:{0}", ex.Source));
            string result = sb.ToString(); 
```

# c# - StyleCop 抑制不起作用

> ID：11347832
> 
> 赞同：2
> 
> 时间：2012-07-05T15:40:33.690
> 
> 标签：c#, .net, stylecop

我一直试图压制一些 StyleCop 警告，但我没有任何运气。这是一些可能有用的信息。

*   StyleCop 版本：4.4.0.9
*   要抑制的警告：SA1600、SA1633、SA1634

## 我试过的

*   局部压制
*   GlobalSupressions.cs 文件
*   项目级 .StyleCop 文件抑制
*   解决方案级别 .StyleCop 文件抑制
*   上述两者同时
*   解决方案级别 .StyleCop 文件与项目级别 .StyleCop 文件的合并
*   与父文件合并并删除项目级别的 .StyleCop 文件
*   抬起一条腿，一只手放在脑后，闭上一只眼睛，重新构建解决方案……

无论如何，我已经没有办法压制这些消息了，我希望有人能提供帮助！

### 局部抑制示例

```
[SuppressMessage("Microsoft.StyleCop.CSharp.DocumentationRules", "SA1600:ElementsMustBeDocumented", Justification = "Reviewed. Suppression is OK here.")] 
```

### 全局抑制示例

```
[assembly: System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.StyleCop.CSharp.DocumentationRules", "SA1600:ElementsMustBeDocumented", Justification = "Reviewed. Suppression is OK here.")] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T11:40:27.103

好的，所以我找到了问题所在。在我的开发盒上，我安装了两个版本的 ReSharper，其中一个不受 StyleCop 支持。每次我升级 StyleCop 时，它都会警告我，但表示我可以继续。有趣的是，缺乏对一个版本的支持会影响对另一个完全支持的版本的支持。

所以，我做的是这个。

1.  卸载不受支持的 ReSharper 版本。
2.  挖掘注册表，删除我能找到的那个版本的 ReSharper 的每个条目，以便安装程序看到它已经消失了。这是一个有趣的过程，因为卸载不受支持的版本确实不能很好地清理自身——尽管我想这应该不足为奇。

第二个选项确实是一个错误的尝试 - 我会删除一些条目并运行安装程序，看看它是否抛出了警告 - 一旦警告不再显示，我继续安装，我现在可以抑制类级别的文档规则！

非常感谢（不是）StyleCop 允许不受支持的 ReSharper 版本破坏受支持的版本 - 这很有帮助 - 虽然比听起来要少！

# css - CSS - 除了背景重复

> ID：11347835
> 
> 赞同：0
> 
> 时间：2012-07-05T15:40:39.447
> 
> 标签：css

我在 CSS 中设置了一些图像是背景，当它结束时我想重复或者我想继续使用其他图像

像这样的东西：

```
ul.smenu .menu_tlacidlo:hover {   
        background:url(images/sluzby_menu_btn_hover_2.png);   
        background-repeat: "url(images/sluzby_menu_btn_line.png)";  
        width:142px;  
        height: 22px;  
} 
```

有办法吗？

# php - align decimals in array of currency values

> ID：11347838
> 
> 赞同：2
> 
> 时间：2012-07-05T15:40:42.913
> 
> 标签：php

I've tried to write a function that will take an array of different amounts and align the decimal places, by adding the appropriate amount of `&nbsp;` to each number with a lesser length than the number with longest length.

It seems pretty long though, and I wonder if anyone has some insight on how I could make is shorter and more efficient.

```
$arr = array(12, 34.233, .23, 44, 24334, 234);

function align_decimal ($arr) {
    $long = 0;
    $len = 0;

    foreach ( $arr as &$i ){
        //change array elements to string
        (string)$i;

        //if there is no decimal, add '.00'
        //if there is a decimal, add '00'
        //ensures that there are always at least two zeros after the decimal
        if ( strrpos( $i, "." ) === false  ) {
            $i .= ".00";
        } else {
            $i .= "00";
        }

        //find the decimal
        $dec = strrpos( $i, "." );

        //ensure there are only two decimals
        //$dec+3 is the decimal plus two characters
        $i = substr_replace($i, "", $dec+3);

        //if $i is longer than $long, set $long to $i
        if ( strlen($i) >= strlen($long) ) {
            $long = $i;
        }

    }

    //locate the decimal in the longest string
    $long_dec = strrpos( $long, "." );

    foreach ( $arr as &$i ) {

        //difference between $i and $long position of the decimal
        $z = ( $long_dec - strrpos( $i, "." ) );
        $c = 0;
        while ( $c <= $z  )  {
            //add a &nbsp; for each number of characters 
            //between the two decimal locations
            $i = "&nbsp;" . $i;
            $c++;
        }

    }

    return $arr;
} 
```

it works okkaaay... just seems really verbose. I'm sure there are a million ways to make it much shorter and more professional. Thanks for any ideas!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:49:12.447

Code:

```
$array = array(12, 34.233, .23, 44, 24334, 234);;
foreach($array as $value) $formatted[] = number_format($value, 2, '.', '');
$length = max(array_map('strlen', $formatted));
foreach($formatted as $value)
{
    echo str_repeat("&nbsp;",$length-strlen($value)).$value."<br>";
} 
```

Output:

```
&nbsp;&nbsp;&nbsp;12.00<br>
&nbsp;&nbsp;&nbsp;34.23<br>
&nbsp;&nbsp;&nbsp;&nbsp;0.23<br>
&nbsp;&nbsp;&nbsp;44.00<br>
24334.00<br>
&nbsp;&nbsp;234.00<br> 
```

Rendered by browser:

```
 12.00
   34.23
    0.23
   44.00
24334.00
  234.00 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:49:19.587

Is using a space a requirement for the display? If you don't mind having "30" coming out as "30.000" you could use the [number_format](http://php.net/number_format) to do most of the work for you, after you figured out the max number of decimal places to use.

```
$item = "40";
$len = 10;
$temp = number_format($item,$len);
echo $temp; 
```

Another would be to use [sprintf](http://www.php.net/manual/en/function.sprintf.php) to format:

```
$item = "40";
$len = 10;
$temp = sprintf("%-{$len}s", $item);
$temp = str_replace(' ', '&nbsp;',$temp);
echo $temp; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:48:48.413

Have you considered using HTML elements alongside CSS alignment to do this for you?

For instance:

`<div style="display:inline-block; text-align:right;">$10.00<br />$1234.56<div>`

This would ease the issue of using spaces to manually adjust the alignment. Since you're aligning to the right and there are two decimal places, the decimals will line up as you wish. You could also do this using a `<table>` and in both scenarios, you're able to simply retrieve the full value through JS if need be.

Lastly, using spaces assumes you're using a fixed-width font which may not necessarily be the case. CSS alignment allows you to handle this much more eloquently.

# c# - Json 成功未在有效 Json 上触发

> ID：11347840
> 
> 赞同：0
> 
> 时间：2012-07-05T15:40:44.590
> 
> 标签：c#, jquery, json

我正在尝试将 json 消息从自定义应用程序发送到网页。正在返回 json 消息，并且似乎是有效的，但它不会导致成功函数触发。我目前正在使用 jquery-1.4.4.js，之前我使用的是 jquery.com 上托管的 jquery-latest.js。使用该版本我收到“parseerror”错误，但在 1.4.4 中我没有收到成功或失败。

我的代码如下：

在网页上：

```
<script>
$(document).ready(function () {
    $.ajax({url: "http://localhost:8080/callback=?",

            dataType: "json",
            success: function(data) 
            {
                alert("reply received");
            },
            error: function(data, error) 
            {
                alert("error: " + error);
            }
        });
});
</script> 
```

我收到的 json 消息（在 Chrome 的网络面板中查看）

```
[{"name":"John"},{"name":"Mike"}] 
```

在我的 C# 应用程序中，代码是：

```
string response = "[{\"name\":\"John\"},{\"name\":\"Mike\"}]";

request.ContentType = "application/json";
webserver.SendToBrowser(response, request); 
```

和 ..

```
public void SendToBrowser(string data, Classes.HTTPRequest request)
    {
        int numBytes = 0;
        byte[] bData = Encoding.ASCII.GetBytes(data); 
        try
        {
            string header = "";
            header += "HTTP/1.1 200 OK\r\n";
            header += "Server: MyServer\r\n";
            header += "Content-Length: " + bData.Length.ToString() + "\r\n";
            header += "Content-Language: en\n\r";
            header += "Content-Type: " + request.ContentType + "\r\n";
            header += "Connection: close\r\n\r\n";

            Byte[] headerBytes = Encoding.ASCII.GetBytes(header);

            if (request.Socket.Connected)
            {

                request.Socket.Send(headerBytes, headerBytes.Length, 0);

                if ((numBytes = request.Socket.Send(bData, bData.Length, 0)) == -1)
                    Console.WriteLine("Socket Error cannot Send Packet");
                else
                {
                    Console.WriteLine("No. of bytes sent {0}", numBytes);
                }
            }
            else
                Console.WriteLine("Connection Dropped....");
        }
        catch (Exception  e)
        {
            Console.WriteLine("Error Occurred : {0} ", e );
        }
        request.Socket.Close();
    } 
```

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:43:13.437

JSONP 并不神奇。

您的服务器需要遵循 JSONP 协议并读取`callback=`参数。

# objective-c - Objective-C：尝试使用 Apple 的 MultipleDetailView

> ID：11347844
> 
> 赞同：0
> 
> 时间：2012-07-05T15:40:53.640
> 
> 标签：objective-c

我正在尝试制作基于拆分视图的应用程序。我正在尝试使用 Apple 的 MultipleDetailView 示例代码

[http://developer.apple.com/library/ios/#samplecode/MultipleDetailViews/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/MultipleDetailViews/Introduction/Intro.html)

我从来没有真正使用过这样的示例代码（我通常只是从头开始）。我所做的只是将代码复制到我的应用程序的正确类中，但是当我尝试在模拟器上运行它时，应用程序无法打开。

我觉得我可能忘记了一些明显的东西，因为我自己没有编码。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:49:00.653

通常的调试技术适用。在程序的早期放置一个断点——例如第一行`main()`，然后从那里调试。你打断点了吗？如果是，请继续执行代码，直到找到导致问题的行。如果不是，请尽可能进一步备份，并寻找任何有关问题所在的线索。如果应用程序正在运行，控制台输出中应该有某种错误消息。

“......应用程序无法打开”并不能告诉我们足以帮助您的信息。诸如“应用程序委托已实例化，但它的`window`和`splitViewController`属性为零”之类的内容更有助于找到问题的根源。

# generator - 如何自动生成 asn.1 编码数据包？

> ID：11347845
> 
> 赞同：1
> 
> 时间：2012-07-05T15:40:58.793
> 
> 标签：generator, packet, asn.1

我想测试我的应用程序，我需要生成不同的负载。应用程序是`SUPL RRLP`协议解析器，我有`ASN.1`这个协议的规范。数据包有很多可选字段，变量的数量可能超过十亿——我无法手动完成所有选项。我想自动化它。
第一种自动生成数据包的方法，另一种方法是创建许多不同的赋值集并将每个赋值集编码为二进制格式。
我找到了一些工具，例如[`libtasn`](https://launchpad.net/libtasn1)and [`Asn1Editor`](http://lipingshare.com/Asn1Editor/)，但第一个无法解析现有的`ASN.1`规范文件；第二个不能按规范对数据包进行编码。

我害怕创建千分之一`ASN.1`解析器，因为我可以在测试过程中引入错误。我希望很容易找到现有的东西，但是......我投降了。
也许，有人在 stackowerflow 上遇到了同样的问题并找到了解决方案？或者知道有什么可以推荐的。我会感谢你的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T20:49:34.663

请尝试访问[https://asn1.io/asn1playground/](https://asn1.io/asn1playground/)并在那里尝试您的规范。您可以要求它为给定的 ASN.1 类型生成样本值。您可以对其进行编码并编辑编码（十六进制）数据或解码值以创建其他值。

您还可以从[http://www.oss.com/asn1/products/asn1-download.html](http://www.oss.com/asn1/products/asn1-download.html)下载 OSS ASN.1 工具的免费试用版，其中包括 OSS ASN.1 Studio。这也允许您为给定的 ASN.1 类型生成（和修改）样本值。

请注意，这些不会自动为您生成数千个不同的测试值，但如果您能够生成有效的 ASN.1 值表示法，它们会解析有效的值表示法并为您编码值。

# python - 从大字符串中读取行

> ID：11347849
> 
> 赞同：0
> 
> 时间：2012-07-05T15:41:22.047
> 
> 标签：python, python-2.7

我正在从文件中切出一大块文本。现在块存储在一个变量中。喜欢，

```
str="from child hood days i liked sweet and savoir. in the early days my mother cooked great deal of sweet meats in home and all my relatives had a nice taste for good sweets. even in remote assam town we thronged miles to procure good sweets. and my sweet eating habit was pretty known. in my childhood i could had as good as 30 to 40 rosgollas at one seating after a full course of lunch. though i was not among the best in my family." 
```

但是我现在想以与我们编写时相同的方式读取每一行

```
for line in file:
     print line 
```

我的问题是我们可以这样做，还是应该写回文件然后执行操作？如果有人可以提供帮助。

问候， Subhabrata Banerjee Gurgaon India

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:57:48.407

```
for line in str.split('\n'):
    doit(line) 
```

虽然这不是懒惰地~~阅读~~解析。对于**非常**大的块，懒惰地~~读取~~解析：

```
for match in re.finditer(r'(.*)\n', str):
    print match.group(1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:44:27.730

将字符串转储到 a 中`StringIO.StringIO`，然后您可以对其使用文件操作。请注意，您的示例文本中只有一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:51:38.420

也许使用字符串标记器通过将其拆分为“较小的字符串”来处理“大字符串”。这将使该过程变得容易得多。顺便说一句，你在编码什么？

# c++ - C++ 的另一个 typedef 错误

> ID：11347852
> 
> 赞同：1
> 
> 时间：2012-07-05T15:41:25.993
> 
> 标签：c++

```
#ifndef C_H
#define C_H
#include <memory>
class C
{
public:
    C(){};
    ~C() {};
};
typedef auto_ptr<C> CPtr;

#endif 
```

上面的代码对我来说似乎很好，但是当我用 VC10 编译它们时，我得到了以下错误：“错误 C2143：语法错误：缺少';' 在'<'”之前。任何关于它的想法将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T15:43:32.503

`#include <memory>``auto_ptr`在`std`-namespace中为您提供，因此您可以通过将您的替换`typedef`为：

```
typedef std::auto_ptr<C> CPtr; 
```

或者，您可以`auto_ptr`使用语句将其引入当前命名空间`using`，尽管您实际上不应该在标题中执行此操作。为此，您需要添加类似`using std::auto_ptr;`or的语句`using namespace std;`。

# r - 根据区域设置国家信息检索时区（独立于操作系统）

> ID：11347854
> 
> 赞同：4
> 
> 时间：2012-07-05T15:41:34.300
> 
> 标签：r, datetime, date, timezone, locale

另一个与日期/时间相关的问题;-)

## 在你瞄准和射击之前

**德国 + MS Windows + R**组合有点搞砸了，因为以下会产生无效的时区：

```
> Sys.timezone()
[1] "MST"
Warning message:
In as.POSIXlt.POSIXct(Sys.time()) : unknown timezone 'MET-1MST' 
```

这绝对不是 R 的错，而是 Windows。因此首先是问题;-)

## 问题

是否有一种简单/替代**且独立于操作系统的**方法来通过语言环境信息查询您当前的国家/地区，然后查找相应的时区（格式`"<country>/<city>"`，例如`"Europe/Berlin"`德国）？

我还应该补充一点，我希望解决方案独立于互联网资源，例如本文[/答案](https://stackoverflow.com/questions/863672/how-to-get-time-zone-information-from-country)中所述。

## 问题上下文

假设您**还不**知道如何指定您的时区。您可能听说过有关**CET/CEST**等的信息，但 AFAIK 在使用基本 R 功能时并不能真正让您获得任何帮助（至少位于德国 ;-)）。

您可以从RHOME 目录中的文件中获取可用 `"<country>/<city>"`对的列表。`/share/zoneinfo/zone.tab`然而，为了找到与您所在的当前国家相对应的时区，您需要知道 ISO 国家代码。

当然，我们通常会为我们的祖国这样做，但假设我们不这样做（我想以一种通用的方法结束）。下一步你要怎么做？

以下是我的“四步”解决方案，但我对此并不满意，因为

1.  它依赖于另一个 contrib 包（[ISOcodes](https://www.google.com/url?q=http://cran.r-project.org/package=ISOcodes&sa=U&ei=2qr1T_yFAuTV4QSlrcSMBw&ved=0CAYQFjAA&client=internal-uds-cse&usg=AFQjCNGsWU3s6m1QmYz6hVYPDNEah8YfeA)）
2.  我无法测试它是否适用于其他地区，因为我不知道如果您在印度、俄罗斯、澳大利亚等地，信息实际上会是什么样子。

有人有更好的主意吗？此外，如果你们中的一些人在德国以外的国家/地区可以通过此操作并发布他们的语言环境信息，那就太好了`Sys.getlocale()`。

## 第 1 步：获取语言环境信息

```
loc <- strsplit(unlist(strsplit(Sys.getlocale(), split=";")), split="=")
foo <- function(x) {
    out <- list(x[2])
    names(out) <- x[1]
    out
}
loc <- sapply(loc, foo)

> loc
$LC_COLLATE
[1] "German_Germany.1252"

$LC_CTYPE
[1] "German_Germany.1252"

$LC_MONETARY
[1] "German_Germany.1252"

$LC_NUMERIC
[1] "C"

$LC_TIME
[1] "German_Germany.1252" 
```

## 第 2 步：从语言环境信息中获取国家/地区名称

```
country.this <- unlist(strsplit(loc$LC_TIME, split="_|\\."))[2]

> country.this 
[1] "Germany" 
```

## 第三步：获取 ISO 国家代码

用于在包[ISOcodes](https://www.google.com/url?q=http://cran.r-project.org/package=ISOcodes&sa=U&ei=2qr1T_yFAuTV4QSlrcSMBw&ved=0CAYQFjAA&client=internal-uds-cse&usg=AFQjCNGsWU3s6m1QmYz6hVYPDNEah8YfeA)`country.this`的数据集中查找相关的国家代码`ISO_3166_1`

```
require("ISOcodes")
data("ISO_3166_1")
iso  <- ISO_3166_1
idx  <- which(iso$Name %in% country.this)
code <- iso[idx, "Alpha_2"]

> code
[1] "DE" 
```

## 第四步：获取时区

用于`code`查找可从文件导出的数据框中的时区`RHOME/share/zoneinfo/zone.tab`

```
path <- file.path(Sys.getenv("R_HOME"), "share/zoneinfo/zone.tab")    
tzones <- read.delim(
    path, 
    row.names=NULL, 
    header=FALSE,
    col.names=c("country", "coords", "name", "comments"),
    as.is=TRUE, 
    fill=TRUE, 
    comment.char = "#"
)

> tzones[which(tzones$country == code), "name"]
[4] "Europe/Berlin" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-09T19:10:04.837

特别是关于你的问题：

> 是否有一种简单/替代且独立于操作系统的方法可以通过语言环境信息查询您当前的国家/地区，然后查找相应的时区？

不，那里没有。这是因为有几个国家有多个时区。仅凭一个国家是无法知道时区的。

这就是为什么 TZDB 标识符采用 的形式`Area/Location`，而不仅仅是国家代码列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T14:45:37.093

对您的工作流程进行了一些简化。

您可以使用仅检索语言环境的时间部分

```
Sys.getlocale("LC_TIME") 
```

这避免了拆分字符串的需要。

lubridate 包包含一个检索 Olson 风格的时区名称的函数，因此您不必担心读取和解析`zone.tab`.

```
library(lubridate)
olson_time_zones() 
```

# php - 从 MySQL CSV 导出中排除列

> ID：11347857
> 
> 赞同：0
> 
> 时间：2012-07-05T15:41:44.053
> 
> 标签：php, mysql, csv

我正在尝试添加一个函数，该函数将创建一个 csv 以从数据库中的某个表下载。我已经让它部分工作，但无法弄清楚如何从 csv 的行部分中排除某些列。到目前为止，这是我的代码，

```
$host = 'xxx';
$user = 'xxxx';
$pass = 'xxxx';
$db = 'xxxx';
$table = 'headers';
$file = 'export';

$filename = $file."_".date("Y-m-d_H-i",time());
header("Content-type: application/vnd.ms-excel");
header("Content-disposition: csv" . date("Y-m-d") . ".csv");
header( "Content-disposition: filename=".$filename.".csv");

$link = mysql_connect($host, $user, $pass) or die("Can not connect." . mysql_error());
mysql_select_db($db) or die("Can not connect.");

$result = mysql_query("SHOW COLUMNS FROM ".$table." WHERE Field NOT IN ('invhead_id', 'note');");
$i = 0;
if (mysql_num_rows($result) > 0) 
{
   while ($row = mysql_fetch_assoc($result)) 
   {
      $csv_output .= $row['Field'].", ";
      $i++;
   }
}
$csv_output .= "\n";

$values = mysql_query("SELECT * FROM ".$table."");
while ($rowr = mysql_fetch_row($values)) 
{
   for ($j=0;$j<$i;$j++) 
   {
      $csv_output .= $rowr[$j].", ";
   }

   $csv_output .= "\n";
}

print $csv_output;
exit; 
```

我已经从 $result 输出中排除了列 invhead_id 和 note，但也需要从 $values 输出中排除它们，但是这是我无法开始工作的地方。谁能指出我正确的方向？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:44:35.137

最简单的方法是按名称选择列而不是 select *

没有更简单的方法，但您也可以编写一个 php 函数来比较您的两个数组并根据第一个数组丢弃您不想要的数组，并且......您应该使用我的第一个想法。

```
SELECT field1, field2, field7 FROM table 
```

# maven - SLF4J 绑定错误

> ID：11347859
> 
> 赞同：8
> 
> 时间：2012-07-05T15:41:50.917
> 
> 标签：maven, m2eclipse, slf4j

我是 maven 的新手，最近两天我尝试将 maven 集成到一个小型 Web 项目中。（我使用 Eclipse Juno 作为 IDE）。首先，我使用“mvn-archetype-webapp”命令生成了一个新项目（结构），并将项目中的源代码复制到这个结构中。然后我将所有依赖项添加到 pom.xml 中，以便我可以使用 tomcat7 插件编译和启动项目。到目前为止，除了每个 maven 命令开头的 SLF4J 错误消息外，一切正常：

```
 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder". 
    SLF4J: Defaulting to no-operation (NOP) logger implementation SLF4J:
    See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details. 
```

我的 pom.xml 依赖项如下所示：

```
 <!-- properties -->
    <properties>
        <spring.version>3.1.1.RELEASE</spring.version>
    </properties>

    <!-- dependencies -->   
    <dependencies>

        <!-- logging -->
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>1.0.6</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.6.6</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>1.6.6</version>
            <scope>runtime</scope>
        </dependency>

        <!-- junit -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>

        <!-- Spring 3 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>   
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>                       
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${spring.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>               
        </dependency>

        <!-- jee -->
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-web-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>

        <!-- tiles -->
        <dependency>
            <groupId>org.apache.tiles</groupId>
            <artifactId>tiles-core</artifactId>
            <version>2.2.2</version>
        </dependency>

        <dependency>
            <groupId>org.apache.tiles</groupId>
            <artifactId>tiles-api</artifactId>
            <version>2.2.2</version>
        </dependency>

        <dependency>
            <groupId>org.apache.tiles</groupId>
            <artifactId>tiles-jsp</artifactId>
            <version>2.2.2</version>
        </dependency>

        <!-- jstl -->
        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
    </dependencies> 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T11:10:15.020

Eclipse Juno 和 Indigo 在使用捆绑的 maven 版本 (m2e) 时不会抑制消息 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder"。此行为从 m2e 版本 1.1.0.20120530-0009 及更高版本开始存在。

虽然，这被指示为错误，您的日志将正常保存。在修复此错误之前，突出显示的错误仍将存在。[在m2e 支持站点](https://bugs.eclipse.org/bugs/show_bug.cgi?id=387064)中了解更多信息。

当前可用的解决方案是使用外部 maven 版本而不是 Eclipse 的捆绑版本。您可以在下面的问题中找到有关此解决方案和有关此错误的更多详细信息，这与您面临的问题完全相同。

[SLF4J：无法加载类“org.slf4j.impl.StaticLoggerBinder”。错误](https://stackoverflow.com/questions/11916706/slf4j-failed-to-load-class-org-slf4j-impl-staticloggerbinder-error)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T19:47:31.300

我遇到了同样的问题：我已将我的 POM 复制到一个空项目中，并将其缩减为几乎没有（见下文）——但仍然看到错误。我可以通过将 SLF4J 绑定（logback 等）添加到 POM 来验证它不会消失——消息显然来自 Maven 本身，而不是正在编译和测试的项目软件。（我现在从一个完全空的项目中得到它。）

我能想到的最好的事情是我认为它与 Eclipse 有关：当我从命令行手动运行 Maven 时，不会出现错误——仅在 Eclipse 下调用时。（我在 MacOSX 上使用 Eclipse Helios Release 2，仅供参考，所以我们知道问题不仅限于您的版本，Juno。）

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

  <modelVersion>4.0.0</modelVersion>
  <groupId>testing</groupId>
  <artifactId>testing</artifactId>
  <version>0.0.1-SNAPSHOT</version>

</project> 
```

仅供参考，响应 Ceki 的建议，这里是 maven 的依赖树目标的结果：

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building testing 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ testing ---
[INFO] testing:testing:jar:0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.496s
[INFO] Finished at: Thu Oct 04 10:05:41 MDT 2012
[INFO] Final Memory: 9M/81M
[INFO] ------------------------------------------------------------------------ 
```

信息量不大，但确实有。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-14T09:30:23.293

此错误来自运行 maven 的 eclipse，而不是来自您的项目，因此它不应影响您的构建过程或生成的文件。

我认为这是与使用 slf4j 或其他日志记录工具的 maven 相关的问题，但 eclipse 或 maven 插件尝试这样做。

摆脱错误的最简单方法是使用外部 maven 而不是 eclipse 中的运行时，您可以在 Preferences -> Maven -> Installations 中配置它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T07:52:22.627

依赖声明看起来不错。Logback 和 slf4j 将在您的网络应用程序中发布。但是，我怀疑 slf4j-api.jar 以某种方式包含在 Tomcat 中（但不是 logback）。

顺便说一句，`mvn dependency:tree`命令是你的朋友。它说什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T18:19:33.127

尝试添加 logback-core 的依赖项。

```
 <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-core</artifactId>
        <version>1.0.6</version>
        <scope>runtime</scope>
    </dependency> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-01T21:39:02.543

> “使用 tomcat7 插件”

tomcat7 插件具有 SLF4J 依赖项。*在我将依赖项直接*分配给 tomcat7 插件之前，我遇到了同样的问题。

```
<pluginManagement>
<plugins>
   <plugin>
        <groupId>org.apache.tomcat.maven</groupId>
        <artifactId>tomcat7-maven-plugin</artifactId>
        <version>2.2</version>
        <dependencies>
            <dependency>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-simple</artifactId>
                <version>1.7.5</version>
            </dependency>                    
        </dependencies>
        <configuration>
            <!-- ...snip... -->
        </configuration>
    </plugin>
</plugins>
</pluginManagement> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-07-23T04:17:06.743

您可以将其添加到您的 pom 属性中。

```
 <org.slf4j-version>1.7.5</org.slf4j-version> 
```

# python - Mac OS X 的系统范围快捷方式

> ID：11347862
> 
> 赞同：3
> 
> 时间：2012-07-05T15:41:57.437
> 
> 标签：python, objective-c, macos, qt, pyqt

所以我被要求将一些内部帮助应用程序移植到 Mac OS X 10.7。

工作得很好，因为平台相关的代码无论如何都是最少的，但是一个应用程序需要一个系统范围的快捷方式来运行（即[RegisterHotkey](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646309%28v=vs.85%29.aspx)功能），我找不到任何关于如何在 Mac 上执行此操作的文档。

该程序使用 Python 3.2 的 PyQt gui。而windows对应的代码基本上是：

```
def register_hotkey(self):
    hwnd = int(self.winId())
    modifiers, key = self._get_hotkey()
    user32.RegisterHotKey(hwnd, self._MESSAGE_ID, modifiers, key) 
```

然后接收热键事件：

```
def winEvent(self, msg):
    if msg.message == w32.WM_HOTKEY:
        self.handle_hotkey()
        return True, id(msg)
    return False, id(msg) 
```

请注意，我不需要 python 变体，我可以轻松编写一个简单的 c 扩展 - 因此也欢迎 C/objective-c 解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T16:55:49.167

我最近编写了一个[quodlibet的](https://code.google.com/p/quodlibet/)[扩展](https://github.com/mjpieters/quodlibet_plugins/blob/master/events/osxmmkey.py)来捕获多媒体键（因为被 quodlibet 本身所吸引）；对于您的设置，同样的过程适用。

我使用 Quartz[`CGEventTapCreate`钩子](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html)和事件循环以及 Cocoa AppKit 框架来破译关键代码来实现这一点。

以下代码注册了一个传递全局按键的python回调，并启动事件循环：

```
import Quartz
from AppKit import NSKeyUp, NSSystemDefined, NSEvent

# Set up a tap, with type of tap, location, options and event mask
tap = Quartz.CGEventTapCreate(
    Quartz.kCGSessionEventTap, # Session level is enough for our needs
    Quartz.kCGHeadInsertEventTap, # Insert wherever, we do not filter
    Quartz.kCGEventTapOptionListenOnly, # Listening is enough
    Quartz.CGEventMaskBit(NSSystemDefined), # NSSystemDefined for media keys
    keyboardTapCallback,
    None
)

runLoopSource = Quartz.CFMachPortCreateRunLoopSource(None, tap, 0)
Quartz.CFRunLoopAddSource(
    Quartz.CFRunLoopGetCurrent(),
    runLoopSource,
    Quartz.kCFRunLoopDefaultMode
)
# Enable the tap
Quartz.CGEventTapEnable(tap, True)
# and run! This won't return until we exit or are terminated.
Quartz.CFRunLoopRun() 
```

我只为系统定义的键（媒体键）定义了一个水龙头；您必须指定不同的事件掩码（`CGEventMaskBit`具有一个或多个[事件类型](https://developer.apple.com/library/mac/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/doc/uid/TP40003550-CH3g-C016985)）；例如`Quartz.CGEventMaskBit(Quartz.kCGEventKeyUp)`按键事件。

回调应该具有以下签名（它实现[`CGEventTapCallBack`了 Quartz API 中的方法](https://developer.apple.com/library/mac/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/doc/uid/TP40003550-CH1g-BBCHIIJJ)：

```
def keyboardTapCallback(proxy, type_, event, refcon):
    # Convert the Quartz CGEvent into something more useful
    keyEvent = NSEvent.eventWithCGEvent_(event) 
```

我将 Quartz 事件转换为[`NSEvent`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSEvent_Class/Reference/Reference.html)，因为我可以在 Mac 多媒体键上找到的所有信息都与该类有关。

原则上，您也可以使用 AppKit API 实现相同的功能，但是您的 Python 应用程序被视为 Mac 应用程序（在 Dock 中可见，带有图标和所有内容），而我希望它完全保留在后台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:56:17.283

借助谷歌的力量，我找到[了这段代码](http://snippets.aktagon.com/snippets/361-Registering-global-hot-keys-with-Cocoa-and-Objective-C)，它允许注册 Mac OS X 的全局热键

在将 Objective-C 自指针传递给 C 函数时，您需要添加`Carbon`框架，并且可能需要添加桥接转换。`ARC`

至少，您还需要：

```
#import <Carbon/Carbon.h> 
```

键码可以[在这个页面上看到，解释虚拟键码](http://boredzo.org/blog/archives/2007-05-22/virtual-key-codes)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-17T15:41:50.243

为什么从来没有人提到过**hammerspoon**，它支持自定义全局系统快捷方式，可以调用shell命令或启动像Safari、PHOTOSHOP这样的UI应用程序。

以下是我编写的示例，演示如何使用全局热键调用 shell 函数。 [https://gist.github.com/BigSully/0e59ab97f148bc167ea19dbd42ebef4b](https://gist.github.com/BigSully/0e59ab97f148bc167ea19dbd42ebef4b)

使用**hs.execute**来执行 shell 命令，可以是非交互的，也可以是交互的。

```
hs.hotkey.bind({"cmd", "alt", "ctrl"}, "P", function()
  local output = hs.execute("toggleProxy", true)
  hs.alert.show(output)
end) 
```

或使用**hs.application.launchOrFocus**启动应用程序 hs.application.launchOrFocus("Safari")

# objective-c - 无法在 iOS SDK 中自定义 UINavigationBar 的外观：

> ID：11347865
> 
> 赞同：0
> 
> 时间：2012-07-05T15:42:00.927
> 
> 标签：objective-c, ios, image, background, uinavigationbar

我正在尝试自定义导航 var 的外观，它通过我的应用程序出现了几次（仅供参考：我正在使用情节提要）。出于某种原因，Th 应用程序不起作用（它卡在了一行中：

```
return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); 
```

在 main.m 文件中，说“线程 1：信号 SIGABRT”。

我写的代码是这样的：

```
UIImage * TabBarBG = [UIImage imageNamed:@"TabBarBG.png"];
[[UITabBar appearance] setBackgroundImage:TabBarBG];
[[UINavigationBar appearance] setBackgroundImage:TabBarBG]; 
```

顺便说一下，选项卡栏的自定义效果很好，我已经尝试过为 NavBar 使用不同的图片，但为了简单起见，它不在这里！

上面的代码是在appDelegate类的一个名为“customizeInterface”的方法中找到的，它是从同一个类(appDelegate)的didFinishLaunchingWithOptions方法中调用的。

关于为什么会发生这种情况以及我该怎么做才能让它发挥作用的任何想法？

任何意见表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:04:29.320

UINavigationBar 的外观 API 不支持名为`setBackgroundImage:`. 但是它确实支持名为`setBackgroundImage:forBarMetrics:`. 所以试试：

```
[[UINavigationBar appearance] setBackgroundImage:TabBarBG forBarMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T17:08:52.083

此外，您可以通过以下方式更改导航栏标题和阴影颜色（如果它与您的新背景图像冲突）：

[https://stackoverflow.com/a/11005059/215845](https://stackoverflow.com/a/11005059/215845)

# android - Android - 将膨胀视图添加到 viewflipper

> ID：11347867
> 
> 赞同：0
> 
> 时间：2012-07-05T15:42:09.183
> 
> 标签：android, viewflipper, layout-inflater

首先，如果这是一个愚蠢的问题，我深表歉意，因为我也是 Android 和 StackOverflow 的菜鸟......

我正在尝试阅读 twitter json 提要，然后将各种推文推送到 ViewFlipper 中，以便在它们之间水平循环......我只需要日期（格式化）和推文的文本......我已经有了提要工作，我可以在推文之间循环，我的问题是如何将它们注入到 viewflipper 中？现在我正在膨胀一个布局 xml 并使用 addView 将它们放在那里，这是可行的，但我不知道如何在膨胀视图中设置两个文本视图......

还有另一种方法可能更容易吗？

提前致谢！

编辑：一些源代码

```
 ViewFlipper flipper = (ViewFlipper) findViewById(R.id.twitterFlipper);
LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
```

和for循环：

```
for (int i = 0; i < jsonArray.length(); i++) {
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            flipper.addView(inflater.inflate(R.layout.twitter_item, flipper, false));
            Log.i("first", jsonObject.getString("text"));
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:57:27.443

试试这个：

```
for (int i = 0; i < jsonArray.length(); i++) {
        JSONObject jsonObject = jsonArray.getJSONObject(i);
        View view = inflater.inflate(R.layout.twitter_item, flipper, false);

        TextView textView1 = view.findViewById(R.id.text1);
        TextView textView2 = view.findViewById(R.id.text2);
        textView1.setText("Some text 1");            
        textView2.setText("Some text 2");

        flipper.addView(view);
        Log.i("first", jsonObject.getString("text"));
    } 
```

当然，根据你的布局替换TextView资源id。

# regex - 正则表达式从以“/”分隔的单词的句子中获取最后一个单词？

> ID：11347868
> 
> 赞同：1
> 
> 时间：2012-07-05T15:42:14.627
> 
> 标签：regex

在这些句子中获得最后一个词的适当正则表达式是什么：

```
/hello/world        -> world
/foo/bar/good       -> good
/one/two/three/four -> four 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T15:45:57.367

您可以使用

```
[^/]+$ 
```

这将匹配字符串中最后一次运行的非斜线字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:48:39.040

例如在 python 中：

```
import re
gg = re.compile("[^/]+$")
gg.findall("/hello/world") 
```

或者你可以只使用一些更标准的字符串库函数，再次以 python 为例：

```
("/hello/world").split("/")[-1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T15:46:14.727

```
[^/]+$ 
```

`[^/]`任何不是的字符`/`

`+`一个或多个

`$`锚定到输入的末尾

# jpa - 将 elasticSearch 与 EclipseLink 集成

> ID：11347871
> 
> 赞同：2
> 
> 时间：2012-07-05T15:42:41.583
> 
> 标签：jpa, eclipselink, elasticsearch

我必须实现一个允许我在我的数据库中搜索的工具。所以，我一直在寻找一些东西，并遇到了 elasticSearch。它认为这个工具可以很好地与 eclipselink 配合使用，但我找不到任何关于如何集成这些工具的好的教程或文档。

请，如果你能帮助我。我会很感激。谢谢

萨朗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T00:51:16.240

可能没有将 EclipseLink 与 ElasticSearch 集成的教程。你需要自己开发。

从[ElasticSearch Java API](http://www.elasticsearch.org/guide/reference/java-api/)开始。

有些人会使用[Elastic 作为数据库](https://stackoverflow.com/questions/6636508/elasticsearch-as-a-database)。如果您仍有数据库，则需要使 ES 索引与数据库保持同步。您需要挂钩插入/更新命令（如果可能）并根据需要重新索引对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-13T20:03:59.457

如果可能的话，我建议您使用 Hibernate 而不是 eclipselink 作为 JPA 实现。

> 为什么不直接使用 Elasticsearch：#1 原因是 Hibernate Search 与 Hibernate ORM 完美集成。对对象所做的所有更改都将透明地触发必要的索引更改。 [https://docs.jboss.org/hibernate/search/5.6/reference/en-US/html/ch11.html](https://docs.jboss.org/hibernate/search/5.6/reference/en-US/html/ch11.html)

我还发现本教程内容丰富： [https ://www.youtube.com/watch?v=ufaI51o_7WI](https://www.youtube.com/watch?v=ufaI51o_7WI)

# php - php中的有线多维数组问题

> ID：11347876
> 
> 赞同：1
> 
> 时间：2012-07-05T15:42:52.537
> 
> 标签：php, rss

我正在尝试获取 rss 提要并将节点值推送到数组中。我虽然我的以下 php 代码将创建单个数组而不是多维数组。

```
 //parse rss
    $contents= file_get_contents('http://rss..');
    $xmlStr= simplexml_load_string($contents); 

    $array=array();
          foreach ($xmlStr->item as $node):

                  $array[]=$node->title;

                 echo '<pre>';
                    print_r($array);
                 echo '<pre>';

           endforeach; 
```

但结果我的数组输出是

```
Array
(
    [0] => SimpleXMLElement Object
        (
            [0] => App Store Bug Corrupts Binaries; Angry Birds Crash
        )

    [1] => SimpleXMLElement Object
        (
            [0] => In UK, HTC Defeats Apple's "Obvious" Slide Unlock Patent
        )

    [2] => SimpleXMLElement Object
        (
            [0] => WikiLeaks Begins Release of 2.5m Syrian Emails
        )

    [3] => SimpleXMLElement Object
        (
            [0] => A Critical Examination of Bill Gates' Philanthropic Record
        )

    [4] => SimpleXMLElement Object
        (
            [0] => Ask Slashdot: How Does Your Company Evaluate Your Performance?
        )

    [5] => SimpleXMLElement Object
        (
            [0] => UAV Cameras an Eye In the Sky For Adventurous Filmmakers
        )

    [6] => SimpleXMLElement Object
        (
            [0] => Copyrights To Reach Deep Space
        )

    [7] => SimpleXMLElement Object
        (
            [0] => FDA Approves HIV Home-Use Test Kit
        )

    [8] => SimpleXMLElement Object
        (
            [0] => Texas Scientists Regret Loss of Higgs Boson Quest
        )

    [9] => SimpleXMLElement Object
        (
            [0] => Icelandic MP Claims US Vendetta Against WikiLeaks
        )

    [10] => SimpleXMLElement Object
        (
            [0] => Microsoft's 'Cannibalistic Culture'
        )

    [11] => SimpleXMLElement Object
        (
            [0] => Android 4.1 Jelly Bean Review
        )

) 
```

知道如何改变这个吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:45:12.573

您需要将每个节点转换为一个字符串（它目前是一个 SimpleXMLElement），以便在一个简单数组中取回一个纯字符串，并从`title[]`数组中检索第一项。

SimpleXML`__toString()`在其对象上实现了魔法方法，这就是为什么它会以它对 的方式进行响应`print_r()`，但是要将其作为字符串使用，您需要将其转换为这样。

```
foreach ($xmlStr->item as $node):
   // Cast the first array value to a string
   $array[] = (string)$node->title[0];
   echo '<pre>';
     print_r($array);
   echo '<pre>';
endforeach; 
```

# c - 如何以及在何处将 stdint.h 类型定义包含在头文件中？

> ID：11347879
> 
> 赞同：6
> 
> 时间：2012-07-05T15:43:02.473
> 
> 标签：c, header

如果我希望使用包含 proto.h 的所有 *.c 文件，`int32_t`而不是将`int`其写入名为的头文件中是否正确`proto.h`：

```
#ifndef PROTO_H_INCLUDED
#define PROTO_H_INCLUDED
#ifndef STDINT_H_INCLUDED
#define STDINT_H_INCLUDED
typedef int int32_t;
typedef unsigned int uint32_t;
typedef size_t uint32_t;
#endif 
```

然后将 proto.h 包含到所有需要它的 *.c 文件中`typedef`？

或者我应该将 stdint.h 包含到我的所有 *.c 文件中吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-05T16:11:44.183

这是*正确*的，但由于多种原因不是最佳解决方案。

1.  整理这个 typedef 列表需要额外的工作。他们已经在`stdint.h`。
2.  您的 typedef 在某些架构上不正确，并且您没有对此进行任何检查。如果有人看到`uint32_t`，他们希望它在任何架构上都是 32 位无符号整数；这将是一个令人讨厌的错误。
3.  您的文件的用户不清楚`proto.h`它是否包含 stdint.h。有人会说你应该包含尽可能少的文件；在我看来，更重要的是要清楚。删除`proto.h`用户的 C 文件中的包含应该只需要删除对其中声明的函数的引用，而不是添加 stdint.h 的包含。为清楚起见，您应该将其添加到`.c`文件中，他们也希望这样做。
4.  您在 typedef 周围添加了额外的包含保护，这些不是必需的 - stdint.h（以及您将使用的所有其他标头）已经包含包含保护。

由于这些原因，我建议在任何需要来自另一个头文件的定义的头文件中（例如，在函数原型中使用宏或 typedef），您应该按如下方式构建文件：

## `proto.h`

```
#ifndef PROTO_H_INCLUDED
#define PROTO_H_INCLUDED

// Typedefs for prototypes
#include <stdint.h>

unit32_t proto(int32_t *value, size_t length);

#endif 
```

## `proto.c`

```
#include <stdint.h>
#include "proto.h"  // Forward declare functions in this file

unit32_t proto(uint32_t *value, size_t length)
{
    // Do something
} 
```

## `main.c`

```
#include <stdint.h>
#include "proto.h"

int main(int argc, char *argv[])
{
    uint32_t values[] = { 1, 2, 3 };
    uint32_t result;
    // Could do 'uint32_t result, values[] = { 1, 2, 3 };' (one line)
    // but this is better for clarity
    size_t len = sizeof(values) / sizeof(values[0]);

    proto(values, len);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:45:43.457

不，您最好`#incldue <stdint.h>`在此文件中使用，而不是在每个使用此标头的文件中使用。

# arrays - 一次添加多个数组perl

> ID：11347884
> 
> 赞同：2
> 
> 时间：2012-07-05T15:43:11.500
> 
> 标签：arrays, perl, sum

我有大约 50 个充满数字的数组，我必须为每个数组报告所有这些元素的总和，因此最终结果有 50 个单个数组的总和。

有没有更短的方法来做到这一点，而不是为每个数组编写不同的 for 循环？

我是 perl 的初学者。任何有用的评论/建议将不胜感激。

到目前为止，这是我的代码：

```
for( $j = 1 ; $j <= 50 ; $j++ ) {
  for ( @arr[$j] ) {
    $sum[$j] += $_;
  }
  print $sum[$j];
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T15:57:10.690

您可以使用[List::Util](http://search.cpan.org/perldoc?List::Util)和[`map`](http://perldoc.perl.org/functions/map.html)，假设您有一个数组数组：

```
use strict;
use warnings;
use Data::Dumper; 
use List::Util qw(sum);

my @arrays = (
    [1,2,3],
    [4,5,6],
    [7,8,9]
); 
my @sums   = map sum(@$_), @arrays;   # sum each array
print Dumper \@sums; 
```

**输出：**

```
$VAR1 = [
          '6',       # sum of $arrays[0]
          '15',      #                1
          '24'       #                2
        ]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T15:59:55.257

```
use strict; use warnings;

use List::Util qw ( sum );

my %data = (
   cats => [ map +(rand 100), 1 .. 10 ],
   dogs => [ map +(100 - rand 100), 1 .. 20 ],
);

my %sums = map { $_ => sum(@{ $data{$_} }) } keys %data;

use YAML;
print Dump \%data, \%sums; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T16:04:02.347

为了蒂姆托迪！

```
# You cannot store arrays within arrays just with ((...), (...)) syntax, 
# as this list will be flattened.
# Instead you should store _references_ to arrays, like this:
my @array_of_arrays = ([1..3], [4..6], [8..10]); 
my @sums_of_arrays;

# ... then iterate over it, arrayref by arrayref
# (if `map` is somehow not for you) :)
for my $ref_arr (@array_of_arrays) {
   my $arr_sum;
   for my $el (@$ref_arr) {
     $arr_sum += $el;
   }
   push @sums_of_arrays, $arr_sum;
} 
```

但请注意，我认为这个解决方案不如@TLP 和@SinanÜnür 给出的解决方案。)`For`当您需要对数组的每个元素（或数组的数组，如本例中）执行某些操作（例如转换）时，构造是好的。但是在这里，您只需要为每个元素提供一些东西——换句话说，就是一张地图。)

# ruby-on-rails - 说服 IT 部门继续使用 Ruby on Rails 而不是 Kohana

> ID：11347891
> 
> 赞同：3
> 
> 时间：2012-07-05T15:43:19.110
> 
> 标签：ruby-on-rails, kohana

我必须做一个 30 分钟的演示，说明为什么我们的 IT 部门应该继续使用 Ruby on Rails，而不是使用 Kohana 框架（用于 PHP）。

我从过去的 Ruby on Rails 应用程序中获得了 3 年的稳固成功，但是整个“人人都知道 PHP”的论点似乎比其他任何事情都更重要。

我不是最伟大的演讲者，而且我真的没有时间做演讲。

是否有任何像样的演示幻灯片或其他值得演示的材料可以帮助我说服 IT 部门继续使用 Rails？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-09T13:56:41.363

**这远不是关于语言与语言的关系，而是更多关于影响人的问题。** 什么？

如果我观察到“这种语言”与“那种语言”的一个主题是它们永远循环下去。是的，您会在那里找到很多资料，包括 @thisfeller 发布的[quora.com](http://www.quora.com/What-advantages-does-Ruby-programming-language-have-over-PHP-OOP-for-web-applications)链接。看看这个 - 显然[COBOL 仍然是“女王”](http://nerds-central.blogspot.co.uk/2010/04/cobol-vs-java-for-financial.html)（无论这意味着什么）。更有可能以你的方式摇摆它是理解如何影响人们（朝着你的观点）。

如果 IT 部门正在推动改变语言/框架，通常会有一两个原因。 **了解这些原因**（真的只是“每个人都知道 php”吗？）对于您能够捍卫继续使用 Rails 至关重要。了解这些原因，然后解释为什么坚持使用 Rails 仍然可以（最好更好）。

**当然，我假设**您对 Rails 对您的组织更好的看法是正确的。我无法对此发表评论。回顾过去的 Rails 项目并**突出其成功之处**，尤其是在您使用 gem 在几小时而不是几天或几周内完成某些特性或功能的地方。

考虑一下当您从 Rails 转移到 Kohana 时集成和迁移会是什么样子。实际上它可能会比其他方式更平滑，但是嘿。尝试亲自了解如何采取行动是有益的。如果你不能说服自己这是正确的做法，那么就以这种信念作为你演讲的基础。如果您采用其他人的 Ruby 与 PHP 或 Rails 与 Kohana 的演示**，它很可能不会触及您组织的相关要点**。

确保您的演示文稿包含**针对您的听众的**内容。如果他们都是开发人员，那很好，进入你喜欢的所有技术细节。如果他们是没有技术背景的管理类型，请不要对他们理解所有行话。他们会想‘*这家伙是谁*’和‘*我们不要照他说的去做——我什么都不懂*’。

**最重要**的是，确定谁是关键决策者。然后确定谁是这些决策者的关键影响者。然后出去和他们谈谈。了解他们的观点，如果他们有的话。寻找支持你观点的人并让他们参与进来。让他们与影响者和决策者交谈。您绝对要避免的情况是，这些决策者和影响者第一次听到“*为什么我们应该保留 Rails* ”是在您的演讲中。你必须事先接近他们，让他们熟悉你的观点。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T19:45:10.667

因为这是针对 IT 部门的，所以有一点是使用 Rails，您将拥有了解 Ruby 的开发人员，并且 Ruby 在 Rails 框架之外有大量用途。php人可能会知道phython，但它不是给定的。

但是，如果您需要证明某些事情，我会做一个演示。毕竟让语言自己说话。

找一个也不知道的人，也许和他们一起做 15 分钟的博客练习，在 Rails 和 php 中。我认为事情不言自明。我知道我开始使用 Ruby 的那一刻（在我看来）比 php 更好。这并不是说 php 本身就不好。

此外，IMO 社区也是 Rails 和 Ruby 项目的优势所在。一般来说，我们有很好的人愿意提供帮助，并且文档现在非常好。代码库维护良好，并且有良好的响应记录。

祝你好运！

# android - android app webservice从ms sql server 2008中提取数据

> ID：11347892
> 
> 赞同：0
> 
> 时间：2012-07-05T15:43:22.620
> 
> 标签：android, asp.net, web-services

我试图找出让我的 android 应用程序从我的 ms sql server 2008 数据库中提取数据的最佳方法。我知道这有两个部分，android 应用程序（用 java 编写）必须调用 web 服务（用 .net 编写）然后调用数据库并提取数据，但我发现的所有示例都是比较零碎。它们似乎只显示应用程序端而不是 Web 服务端或仅显示 Web 服务端而不是相反。我需要一个可以看到双方并了解它们如何协同工作的产品。有人有什么好的例子吗？

我见过的一些示例使用的 ksoap 设计似乎不是最好的，因为它看起来并没有得到很好的支持。[http://ksoap2.sourceforge.net/](http://ksoap2.sourceforge.net/)

我见过的另一个是基于 Jersey 的设计[http://jersey.java.net/](http://jersey.java.net/)，看起来会更容易，但我不知道如何将它与 .net Web 服务接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T05:45:50.323

对于 MS SQL Server，我假设您将使用 ASP.NET？如果是这样，请查看 WCF Web HTTP 编程模型 (http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)。它基本上是微软在 WCF 中的 REST 实现。

例如，假设我想从 SQL 数据库中检索用户信息。为此，我可以发出一个普通的 HTTP GET 请求：

```
GET http://server/service/userinfo/id/5 
```

上面将请求主 ID 为 5 的用户信息，然后 WCF 层会将其转换为适当的 SQL 查询并以 JSON 字符串的形式返回：

```
{ name : "john doe", email : "john@doe.com", phone : "111-111-1111" } 
```

您的应用程序基本上会解析此 JSON 字符串并将其转换为 POJO。

我认为这种 RESTful 方法比传统的 SOAP 方法更容易实现。

# android - 我正在寻找制作自定义音量监视器

> ID：11347899
> 
> 赞同：-3
> 
> 时间：2012-07-05T15:43:36.530
> 
> 标签：android

我正在寻找一个简单的音量管理器应用程序。我知道它以前已经做过，但我只是想制作一个看看它是什么样的，并更熟悉代码并用它做某些事情。

我希望它可以包含一个 if 语句，如果音量降至零以下，它会发出“Toast”通知，说明“您已降至零以下”

尽管听起来我要求有人为我做这件事，但我只是要求一个基本的想法/框架可以使用。

-谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:22:43.760

我假设您想要的不仅仅是如何制作吐司的更多信息。所以这里有一些其他的指针。

要访问音量级别，请使用[AudioManager](http://developer.android.com/reference/android/media/AudioManager.html)：

```
AudioManager audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
int currentVolume = audio.getStreamVolume(AudioManager.STREAM_MUSIC); 
```

抓住音量按钮很简单：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    super.onKeyUp(keyCode, event);
    if ((keyCode == KeyEvent.KEYCODE_VOLUME_DOWN)) {
        // Do something if currentVolume is low enough
        // return true;
    }
    // Check if Up is pushed too
    return false;
} 
```

Toast 也很简单：

```
Toast.makeText(context, "Message", Toast.LENGTH_LONG).show(); 
```

如果您希望您的应用程序/服务使用当前音量做更多事情，您可能会意识到这并不像听起来那么简单......

此方法告诉系统在您的应用程序处于活动状态时使用音量按钮调整哪个音频流：

```
setVolumeControlStream(AudioManager.STREAM_MUSIC); 
```

阅读这方面的[文档](http://developer.android.com/reference/android/app/Activity.html#setVolumeControlStream%28int%29)，您将了解自己跟踪音量是多么不可预测。这是关于同一主题的一个问题：[如何在我的 Android 应用程序中合理地管理音量？](https://stackoverflow.com/q/628659/1267661)

# ruby-on-rails - Rails Scopes - 我不希望在某些情况下添加任何范围

> ID：11347900
> 
> 赞同：0
> 
> 时间：2012-07-05T15:43:40.083
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我对 Rails 有点陌生，并且一直在使用 Rails 3.2 中的范围。我喜欢范围如何将代码与控制器分开。但是，当我使用范围构建查询时，我无法弄清楚在某些情况下如何*不*添加范围。请参阅下面的示例...

在我的 CarsController 类中

```
 if !params[:make_name].blank?  
        @cars = Car.by_make(params[:make_name]).find(:all, :group => "name")
    else      
        @cars = Car.all 
```

在我的汽车模型课上。代码试图说“如果 make_name 字符串是 'all'，则***不要***在其上添加任何条件，否则添加条件。”

```
def self.by_make(make_name_str)
    if make_name_str == "all"
        where("cars.id > ?", 0)
    else
        make_id = Make.where(:name => make_name_str).first.id
        where(:make_id => make_id)
    end
end 
```

显然，字符串为“all”的情况看起来很黑，这就是我的问题所在。我如何编写它以不返回任何内容 - 基本上，在这种情况下不要添加任何范围？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T17:12:24.877

`Car`在你的模型中试试这个：

```
class Car < ActiveRecord::Base
  ...
  scope :by_make, lambda do |make|
    make == :all ? scoped : where(:make_id => Make.where(:name => make).first.id)
  end
end 
```

**注意**如果模型中有默认范围，`Car`您可能需要考虑`unscoped`在上面的代码中使用，具体取决于您在选择所有汽车时是否要包括默认范围。

# php - 匹配一个没有后跟另一个的字符串（preg_match 否定前瞻）

> ID：11347901
> 
> 赞同：1
> 
> 时间：2012-07-05T15:43:40.827
> 
> 标签：php, preg-match

我必须选择包含单词`one`而不是`another`. 这些行来自一些 json 字符串，例如：

```
{"Name" : "one", "LastError" : "No error", "ID" : 1000 , "Comment" : "no comment"} //YES
{"Name" : "one", "LastError" : "No error", "ID" : 1000 , "Comment" : "another"} //NO because there is 'one' and 'another' 
```

我正在使用 php 和 preg_match。

我正在尝试使用类似的东西：

```
if (preg_match('/one.*(?!another)/i',$row_string) > 0)
{
  //no draw
}
else
{
  //Draw something
} 
```

看起来向前看并没有做任何事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T16:14:11.353

你的正则表达式

```
/one.*(?!another)/ 
```

表示*匹配`one`后面的任意个字符的字符串，后面的字符串`.*`一定不能匹配`another`*。

`.*`基本上会匹配到字符串的末尾，所以后面不跟`another`.

您真正想要的是匹配`one`后跟任意数量字符的字符串，并且每个字符后面都不能跟`another`.

**这个有效：**

```
/one(.(?!another))*$/ 
```

`$`确保针对后面的每个字符测试断言`one`。

为了确保即使`one`它本身也不在前面`another`，我们也必须在后面添加断言`one`：

```
/one(?!another)(.(?!another))*$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T16:47:44.690

`one`仅在`Name`? 如果是这样，`json_decode($json, true)`.

# iphone - 适用于 ios 的 Spotify API：从 ios spotify api 下载、保存、访问曲目

> ID：11347903
> 
> 赞同：1
> 
> 时间：2012-07-05T15:43:44.237
> 
> 标签：iphone, ios, api, spotify

我想知道是否可以使用 spotify ios api（CocoaLibSpotify IOS 库）将曲目下载到 iphone / ipod / ipad 设备。如果是这样，我还需要访问它们并随时播放。稍后我将在我的应用程序中使用它们。

我想我们可以使用 sp_track_offline_status 检查正在播放的曲目的离线状态。但我无法度过难关。

任何示例代码片段都会有很大帮助。

**简化要求**：下载Spotify曲目并将其保存到iOS设备中

作为更新，为了响应 iKenndac 的回答，offlineStatus 属性已变为“1”，这意味着播放器已同步用于本地存储。

SP_PLAYLIST_OFFLINE_STATUS_YES = 1, ///< 播放列表同步到本地存储

1.是说播放列表里的曲目都下载完了吗？

我不这么认为。因为还有其他状态如下：

```
typedef enum sp_playlist_offline_status {
  SP_PLAYLIST_OFFLINE_STATUS_NO          = 0, ///< Playlist is not offline enabled
  SP_PLAYLIST_OFFLINE_STATUS_YES         = 1, ///< Playlist is synchronized to local storage
  SP_PLAYLIST_OFFLINE_STATUS_DOWNLOADING = 2, ///< This playlist is currently downloading. Only one playlist can be in this state any given time
  SP_PLAYLIST_OFFLINE_STATUS_WAITING     = 3, ///< Playlist is queued for download
} sp_playlist_offline_status; 
```

我从来没有得到离线状态 2 或 3。

1.  此外，我的 offlineDownloadProgress 属性始终显示“0”。
    如果我没记错的话，它必须从“0”增加到“1”。

**代码片段：**

```
[SPAsyncLoading waitUntilLoaded:playList 
                        timeout:kSPAsyncLoadingDefaultTimeout 
                           then:^(NSArray *loadedItems, NSArray *notLoadedItems) {    
    playList.markedForOfflinePlayback = YES;
    currentPlaylist = playList;
    statusTimer = [NSTimer scheduledTimerWithTimeInterval:0.3 target:self selector:@selector(checkOfflineStatus) userInfo:nil repeats:YES]; 
```

**我正在检查状态如下：**

```
-(void)checkOfflineStatus {

  NSLog(@"playlist offline progress is: %f",currentPlaylist.offlineDownloadProgress);

  NSLog(@"offline status: %d",currentPlaylist.offlineStatus);

} 
```

**输出如下所示：**

2012-07-06 20:34:05.891 简单播放器[6571:10703] 播放列表离线进度为：0.000000

2012-07-06 20:34:05.892 简单播放器[6571:10703] 离线状态：1

2012-07-06 20:34:06.039 简单播放器[6571:10703] 播放列表离线进度为：0.000000

2012-07-06 20:34:06.039 简单播放器[6571:10703] 离线状态：1

接下来我能做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T16:14:38.887

您不能简单地将 Spotify 曲目下载为 MP3 文件或任何独立播放的文件。

但是，您可以让库缓存曲目以供以后离线播放，只要用户保持登录到 CocoaLibSpotify，就像 iOS Spotify 客户端一样。

`SPPlaylist`具有`markedForOfflinePlayback`启用离线访问的属性，然后播放列表的`offlineDownloadProgress`和`offlineStatus`属性提供更多信息。

CocoaLibSpotify 附带一个 Mac 示例应用程序，该应用程序缓存播放列表以供离线播放以查看其工作原理。该 API 在 Mac OS X 和 iOS 版本的 CocoaLibSpotify 上均可用且相同。

# jquery - JQuery 从中心缩小 div

> ID：11347909
> 
> 赞同：0
> 
> 时间：2012-07-05T15:44:04.510
> 
> 标签：jquery, css, shrink

我创建了一些 JQuery，它将在悬停时扩展一个 div 'popup'，然后在鼠标移出时将其缩小。但是，这种效果似乎是从左上角发生的，我需要它从中心发生。我在 Stack Overflow 上看到了类似的主题，解决方案似乎是在 JQuery 和 CSS 中获得正确的“顶部”和“左侧”值，但是，尽管我尽了最大努力，但我还是无法做到这一点。

这是我到目前为止所取得的成就的 JS Fiddle：http: [//jsfiddle.net/MaverickJohnosn/m7q3H/](http://jsfiddle.net/MaverickJohnosn/m7q3H/)

这是无法访问 JS Fiddle 的任何人的代码。
HTML

```
<div class="productborder">
    <p>Section Title</p>
<div class="popup"><a href="#"></a></div>
<div class="productimg"><a href="#"></a></div>
</div>

<div class="productborder">
    <p>Section Title</p>
<div class="popup"><a href="#"></a></div>
<div class="productimg"><a href="#"></a></div>
</div> 
```

CSS：

```
.productimg{
margin-left: auto;
margin-right: auto;
text-align: center;
z-index: 0;
width: 135px;   
height: 147px;
outline: 1px solid green;
}

.popup{
margin-top: 25px;
margin-left: 120px;
outline: 1px red solid;
position: absolute;
float: left;
z-index: 1;
}

.productborder{
border: 2px dashed #ccc;
padding: 5px 10px;
width: 210px;
float:left;
margin: 5px 11px;
position: relative;
} 
```

查询：

```
$(document).ready(function() {
  $('.productborder', this).hover(

    function() {
      $('.popup', this).stop(true, true);
      $('.popup', this).animate({
          width: '100px',
          height: '100px',
          top: '25px',
          left: '55px'
      }, 500);
    }, function() {
      $('.popup', this).animate({
          width: '0px',
          height: '0px',
          top: '0px',
          left: '0px'
      }, 500);
  });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:53:15.357

在动画打开之前将左侧/顶部设置为正确的“中心”位置，即

```
$(document).ready(function() {
    $('.productborder', this).hover(

    function() {
        $('.popup', this).stop(true, true);
        $('.popup', this).css({
            left: '110px',
            top: '75px'
        });
        $('.popup', this).animate({
            width: '100px',
            height: '100px',
            top: '25px',
            left: '55px'
        }, 500);
    }, function() {
        $('.popup', this).animate({
            width: '0px',
            height: '0px',
            top: '110px',
            left: '75px'
        }, 500);
    });

});​ 
```

# asp.net - Linq、asp.net 和gridview 或listview 类型控制单条记录？

> ID：11347910
> 
> 赞同：0
> 
> 时间：2012-07-05T15:44:09.980
> 
> 标签：asp.net, linq, entity-framework, listview, gridview

我有一份服务申请表。一系列文本框（单行和多行）、单选按钮、复选框和下拉列表用于收集有关请求的信息。在提交时，通过实体框架创建数据库记录，并且表单重定向到需要显示请求的摘要页面。这个相同的摘要页面将用于请求批准者查看和可能编辑请求的部分（取决于他们的角色）。我在代码隐藏中使用 linq to Entity Framework 来提取记录，并使用 asp.net DataSourceControl 来保存返回的记录。到目前为止一切都很好。现在，显示记录和允许编辑的最佳方式是什么？DataGridView 和 ListView 非常适合在网格类型视图中对多个记录提供编辑/更新，但是有什么方法可以使用它们，或者类似的东西，编辑/更新此记录的全部或部分？水平而不是垂直？如果没有，关于处理此问题的最佳方法的任何建议？这是我的第一个 asp.net c# 项目，我很挣扎！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:59:10.343

对于一个对象的单一编辑，我永远不会使用任何使用 ObjectDataSource 的“数据控件”......我通常做的，例如，如果我有一个`employee-list.aspx`页面，是创建另一个页面`employee-edit.aspx?employeeid=1`，从我添加的位置命名并还手动将每个字段一一绑定，并自己完成。我更喜欢这三个原因：

*   给了我更多的灵活性
*   请允许我没有一个具有巨大视图状态的网页，这可能会降低页面速度
*   也大大减少了页面后端的代码行数。

# java - 从 excel 单元格中获取字符串并将它们输入到网站上的文本框中

> ID：11347917
> 
> 赞同：0
> 
> 时间：2012-07-05T15:44:28.310
> 
> 标签：java, jexcelapi

嗨，我正在尝试用 java 编写一个程序，使用 jexcel api 获取 excel 电子表格第一列中每个单元格中的文本，然后将其输入到在线文本框中（例如，谷歌翻译），和然后自动处理（或者为了这个例子，翻译）它，获取结果，并将它们放入相应的单元格

这可能吗？如果是这样，人们将如何做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:57:23.427

您不必在任何文本字段中输入任何文本，因为最后，当您按下*翻译*按钮时，您只需向 Google 翻译发送一个 GET 请求。只需向以下 URL 发送 GET HTTP 请求，您就会得到结果：

```
http://translate.google.fr/#en|fr|hello%20world 
```

# javascript - 单击时，将变量从 Javascript 传递到 Rails/Ruby

> ID：11347921
> 
> 赞同：0
> 
> 时间：2012-07-05T15:44:40.040
> 
> 标签：javascript, ruby-on-rails, ruby, highcharts

我有一个 Javascript Highchart 正在显示并试图从中获取更多信息。我目前已经设置好了，所以当我单击条形图中的一列时，它会提醒我列的名称和值。

我试图通过在下表中呈现图表中该列的内容来更进一步。我已经完成了 HTML，但我试图将单击的值（`this.category`包含一个字符串）传递给 @show_me 实例变量，该变量将在它不为零时立即呈现图表。

我下面的代码破坏了我的图表，导致它无法呈现。我不完全确定`this.category`在点击时将值传递给@show_me 的正确方法。

任何帮助都是巨大的。非常感谢！

> 点击：function() { this.category == <%= @show_me %>; }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:49:32.387

不完全确定您要做什么，但看起来您只需要更改它

```
this.category == <%= @show_me %>; 
```

对此

```
this.category = "<%= @show_me %>"; 
```

尽管您应该知道，任何带有`<%= %>`标签的东西都会在页面加载之前进行预渲染。

**更新：**

看起来你想要做的可能涉及一些 AJAX。您可能会考虑查看[本教程](http://net.tutsplus.com/tutorials/javascript-ajax/using-unobtrusive-javascript-and-ajax-with-rails-3/)，因为这是一个半复杂的主题，如果您没有相关经验，可能会感到困惑。

# graphviz - 带点的graphviz：将节点放在最顶部

> ID：11347925
> 
> 赞同：1
> 
> 时间：2012-07-05T15:44:51.170
> 
> 标签：graphviz, dot

TODO：在具有自上而下等级的图中，指定节点“START”应放在顶部。

该图很大（100 个节点）并且有一些子图（大约 10 个）。在使用子图之前，“START”节点位于顶部。对于子图，“START”节点放置在中心附近的某处。

我试着用

```
Start [root=true]

Start [rank=min]

Start [rank=1]

root=Start;

{rank=min; Start;} 
```

但他们都没有工作。你有什么想法（我不想使用“pos”，因为图形大小不具体）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:04:13.860

首先，使用`{rank=same; subgraph_1; subgraph_n;}`确保所有子图的排名低于根节点。然后检查它对你的布局做了什么，然后从那里继续对子图进行分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-19T06:07:12.810

我喜欢这里给出的答案：

[如何在graphviz的点中控制级别节点顺序？](https://stackoverflow.com/questions/44274518/how-can-i-control-within-level-node-order-in-graphvizs-dot) 通过汤姆伺服

摘要 - 创建一些虚拟的“隐藏”节点，并使用不可见的边来强制排名和排序。

# java - 无法从 QuickAction 打开 AlertDialog

> ID：11347926
> 
> 赞同：1
> 
> 时间：2012-07-05T15:44:54.887
> 
> 标签：java, android, android-alertdialog

当按下 QuickAction 中的按钮时，我尝试显示 AlertDialog。但是我的应用程序在尝试完成此任务时崩溃。我不知道是什么导致了错误。我还尝试使用 Thread.sleep 给 QuickAction 时间关闭正确并显示 AlertDialog 但它不起作用。

我做了研究，发现了一个问题：[从 QuickAction Button 开始对话框](https://stackoverflow.com/questions/4708098/starting-dialog-from-quickaction-button)

这个问题与我的有点相似，但是当我尝试用 MyClass.class 替换 getApplicationContext() 时，我收到一条错误消息，指出构造函数 AlertDialog.builder(Class) 未定义。

下面是一段代码 QuickAction 和 AlertDialog：

```
ActionItem editQItem = new ActionItem(ID_EDIT_Q, "Edit", getResources()
            .getDrawable(R.drawable.qa_edit));
    ActionItem deleteQItem = new ActionItem(ID_DELETE_Q, "Delete",
            getResources().getDrawable(R.drawable.qa_delete_answer));
    System.out.println("Blah 1");

    mQuickActionQ = new QuickAction(this);
    mQuickActionQ.addActionItem(editQItem);
    mQuickActionQ.addActionItem(deleteQItem);
    System.out.println("Blah 2");

    // setup the action item click listener
    mQuickActionQ
            .setOnActionItemClickListener(new QuickAction.OnActionItemClickListener() {
                public void onItemClick(QuickAction quickAction, int pos,
                        int actionId) {
                    ActionItem actionItem = quickAction.getActionItem(pos);
                    System.out.println("Blah 3");
                    if (actionId == ID_EDIT_Q) {
//Here im getting error from here onwards when trying to display AlertDialog
                        et_question = new EditText(getApplicationContext());
                        et_tag1 = new EditText(getApplicationContext());
                        et_tag2 = new EditText(getApplicationContext());
                        et_tag3 = new EditText(getApplicationContext());
                        et_question.setText(question);
                        et_tag1.setText(q_tag1);
                        et_tag2.setText(q_tag2);
                        et_tag3.setText(q_tag3);
                        tv_question = new TextView(getApplicationContext());
                        tv_question.setText("Question:");
                        tv_question.setTextSize(15);
                        tv_tags = new TextView(getApplicationContext());
                        tv_tags.setText("Tags:");
                        tv_tags.setTextSize(15);
                        ll_edit = new LinearLayout(getApplicationContext());
                        ll_edit.setOrientation(1);
                        ll_edit.addView(tv_question);
                        ll_edit.addView(et_question);
                        ll_edit.addView(tv_tags);
                        ll_edit.addView(et_tag1);
                        ll_edit.addView(et_tag2);
                        ll_edit.addView(et_tag3);
                        AlertDialog.Builder builder = new AlertDialog.Builder(getApplicationContext());
                        builder.setMessage("Edit");
                        builder.setCancelable(true);
                        builder.setView(ll_edit);
                        builder.setPositiveButton("Save Changes",
                                new DialogInterface.OnClickListener() {
                                    public void onClick(DialogInterface dialog, int id) {
                                        boolean Success = true;
                                        Editable ttv = et_question.getText();
                                        final String answer = new StringBuilder().append(
                                                ttv).toString();
                                        if (answer.equals("")) {
                                            Dialog mTag = new Dialog(
                                                    getApplicationContext());
                                            mTag.setTitle("One of the field is empty!");
                                            TextView tv2 = new TextView(
                                                    getApplicationContext());
                                            tv2.setText("Blank fields are not allowed.");
                                            mTag.setContentView(tv2);
                                            mTag.setCancelable(true);
                                            mTag.show();
                                        } else {
                                            String uname = qun.getText().toString();
                                            String question = qu.getText().toString();
                                            String question_time = qpo.getText().toString();
                                            String new_question = et_question.getText()
                                                    .toString();
                                            String new_tag1 = et_tag1.getText().toString();
                                            String new_tag2 = et_tag2.getText().toString();
                                            String new_tag3 = et_tag3.getText().toString();
                                            uf = new UserFunctions();
                                            HashMap<String, String> hm = new HashMap<String, String>();
                                            db = new DatabaseHandler(
                                                    getApplicationContext());
                                            db.getReadableDatabase();
                                            hm = db.getUserDetails();
                                            db.close();
                                            String username = hm.get("username");
                                            JSONObject json = uf.updateQuestion(username,
                                                    question, question_time, new_question,
                                                    new_tag1, new_tag2, new_tag3);
                                            dialog.dismiss();
                                            pd = ProgressDialog.show(ViewMyQuestion.this,
                                                    "Please wait...",
                                                    "Updating your question!", true, false);
                                            Thread thread = new Thread(ViewMyQuestion.this);
                                            thread.start();
                                            tagcombo = new_tag1 + "," + new_tag2 + ","
                                                    + new_tag3;
                                            qun.setText(username);
                                            qtag.setText(tagcombo);
                                            qu.setText(new_question);
                                        }// end of if else
                                    }
                                });

                        builder.setNegativeButton("Cancel",
                                new DialogInterface.OnClickListener() {
                                    public void onClick(DialogInterface dialog, int id) {
                                        dialog.cancel();
                                    }
                                });
                        AlertDialog alert = builder.create();
                        alert.show();
                    } else {
                        System.out.println("Blah 4");
                        Toast.makeText(getApplicationContext(),
                                actionItem.getTitle() + " selected",
                                Toast.LENGTH_SHORT).show();
                    }
                }
            });

    mQuickActionQ.setOnDismissListener(new QuickAction.OnDismissListener() {
        public void onDismiss() {
            Toast.makeText(getApplicationContext(), "Ups..dismissed",
                    Toast.LENGTH_SHORT).show();
        }
    }); 
```

以下是 Logcat 消息：

```
07-05 18:01:27.158: E/AndroidRuntime(389): FATAL EXCEPTION: main
07-05 18:01:27.158: E/AndroidRuntime(389): android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.view.ViewRoot.setView(ViewRoot.java:509)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.app.Dialog.show(Dialog.java:241)
07-05 18:01:27.158: E/AndroidRuntime(389):  at com.vervecoders.cuqu.ViewMyQuestion$3.onItemClick(ViewMyQuestion.java:222)
07-05 18:01:27.158: E/AndroidRuntime(389):  at com.vervecoders.cuqu.QuickAction$2.onClick(QuickAction.java:162)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.view.View.performClick(View.java:2408)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.view.View$PerformClick.run(View.java:8816)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.os.Handler.handleCallback(Handler.java:587)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.os.Handler.dispatchMessage(Handler.java:92)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.os.Looper.loop(Looper.java:123)
07-05 18:01:27.158: E/AndroidRuntime(389):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-05 18:01:27.158: E/AndroidRuntime(389):  at java.lang.reflect.Method.invokeNative(Native Method)
07-05 18:01:27.158: E/AndroidRuntime(389):  at java.lang.reflect.Method.invoke(Method.java:521)
07-05 18:01:27.158: E/AndroidRuntime(389):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-05 18:01:27.158: E/AndroidRuntime(389):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-05 18:01:27.158: E/AndroidRuntime(389):  at dalvik.system.NativeStart.main(Native Method) 
```

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T16:39:29.250

尝试`AlertDialog.Builder builder = new AlertDialog.Builder(yourActivityName.this);`代替`AlertDialog.Builder builder = new AlertDialog.Builder(getApplicationContext());`

# c++ - Visual Studio C++ 是否可以在不链接的情况下编译对象

> ID：11347927
> 
> 赞同：9
> 
> 时间：2012-07-05T15:44:56.497
> 
> 标签：c++, visual-studio-2010, linker

我正在运行 VS 2010 SP1，并且我有一个每周运行一次的特殊分析配置（因为构建服务器需要很长时间才能分析所有内容）。

我希望此配置无需链接即可运行。如果分析通过了项目中的所有代码，那么我希望构建继续到下一个项目而不进行链接。

我看不到一种方法来告诉 VS 只运行 C++ 编译器而不进行链接。有谁知道在现有的 vcxproj 中执行此操作的方法？

[编辑] 澄清：我希望这可以在 IDE 中工作。

我的下一步行动是手动编辑 vcxproj，看看我是否无法摆脱构建的链接阶段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T15:47:57.293

C++ 编译器`cl.exe`当然可以，这就是`/c`开关（只编译，不链接）。不过，不确定`msbuild`IDE 使用的系统以及可以处理`.vcxproj`文件的系统。

根据[文档](http://msdn.microsoft.com/en-us/library/ms164311)，这应该有效：

```
msbuild /target:Compile projectfile 
```

或者

```
msbuild /target:projectname:Compile solutionfile 
```

您可能还对`/filelogger`和`/fileloggerparameters`选项感兴趣，它们可以让您捕获构建消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-12T22:24:11.700

就在这种情况下；在使用 IDE 时尝试在不链接的情况下进行构建。

为了在我的配置中实现这一点，我更改了我的应用程序的配置类型：

```
General -> Project Defaults -> Configuration Type 
```

具体来说，从 更改`Application (.exe)`为`Static library (.lib)`。这将允许您构建所有项目，但不需要进行任何链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-15T17:10:41.030

好的，我的问题并不完全具体，我应该问的是：“我可以在没有链接的情况下对 C++ 项目运行静态代码分析吗？”。

最近的回答是“是的，在 VS 2017 中使用 msbuild 属性 RunCodeAnalysisOnce=true”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-21T18:25:03.447

Microsoft[文档](https://docs.microsoft.com/en-us/cpp/build/reference/c-compile-without-linking?view=msvc-160#to-set-this-compiler-option-in-the-visual-studio-development-environment)声称此选项在开发环境中不可用。

# xml - XSLT 选择不匹配的元素？

> ID：11347934
> 
> 赞同：4
> 
> 时间：2012-07-05T15:45:26.743
> 
> 标签：xml, xslt

我有以下 XML：-

```
<inventory>
  <item>
    <name_element>
      <!--some structure-->
    </name_element>
    <some_element1>val1</some_element1>
    <some_element2>val2</some_element2>
    <!-- some more elements -->
  </item>
  <!-- lots of items -->
</inventory> 
```

现在我想将其转换为：-

```
<inventory>
  <item some_element1="val1" some_element2="val2" ... >
    <name_element>
      <!-- as it is -->
    </name_element>
</inventory> 
```

基本上我对 some_elements 的名称/类型一无所知，任何项目都可以有任意数量的这些元素。我确实知道它们都是简单的类型并且可以转换为属性。

我已经阅读[了使用 XSLT 将 XML 元素转换为 XML 属性](https://stackoverflow.com/questions/655411/converting-xml-elements-to-xml-attributes-using-xslt/655463#655463)，它告诉我如何将所有子元素转换为属性，但不清楚如何排除特定的“name_element”被转换为属性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T15:57:46.367

```
<?xml version="1.0" encoding="UTF-8"?> 
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
    <xsl:output indent="yes" method="xml"/>

    <xsl:template match="@*|node()">
     <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
     </xsl:copy>
    </xsl:template>

    <xsl:template match="item">
        <xsl:copy>
            <!--apply templates for any attributes and convert 
                elements(except for name_element) in order to create all 
                attributes before creating child nodes for item element -->
            <xsl:apply-templates select="@* 
                                         | *[not(self::name_element)]"/>
            <!--apply templates to name_element and any comments or processing instructions -->
            <xsl:apply-templates select="name_element 
                                         | comment() 
                                         | processing-instruction()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="item/*[not(self::name_element)]">
        <xsl:attribute name="{local-name()}">
            <xsl:value-of select="."/>
        </xsl:attribute>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:57:37.673

首先，使用身份模板按原样复制所有内容：

```
<xsl:template match="@* | node()">
  <xsl:copy>
    <xsl:apply-templates select="@* | node()"/>
  </xsl:copy>
</xsl:template> 
```

然后，为项目定义一个模板。您可以迭代孩子，并排除您不希望转换为属性的内容。这是一个示例模板：

```
<xsl:template match="item">
 <xsl:copy>
   <!-- this will set children as attributes, but name_element -->
   <xsl:for-each select="*[not(local-name()='name_element')]">
        <xsl:attribute name="{local-name()}">
          <xsl:value-of select="text()"/>
        </xsl:attribute>
   </xsl:for-each>

   <!-- this preserves name_element as it is -->
   <xsl:apply-templates select="name_element"/>
 </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:57:54.023

尝试

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="item">
        <xsl:copy>
            <xsl:apply-templates select="*[not(self::name_element)]"/>
            <xsl:apply-templates select="name_element"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="item/*[not(self::name_element)]">
        <xsl:attribute name="{name()}">
            <xsl:value-of select="."/>
        </xsl:attribute>
    </xsl:template>
</xsl:stylesheet> 
```

# android - 当我添加一个新字段时，我得到一个空指针

> ID：11347939
> 
> 赞同：7
> 
> 时间：2012-07-05T15:45:36.540
> 
> 标签：android, ormlite

我的 ORMlite 服务运行良好。所有 CRUD 操作都可以正常工作。但是，当我向我的实体添加一个新的可为空字段时，整个事情都失败了。我得到空指针并且应用程序死亡。

这是我添加的字段：

```
@DatabaseField( canBeNull = true  )
private String newField; 
```

如果我删除我的数据库并重新创建它，那么一切都很好。我想知道的是为什么一个简单的模式更改会导致这种情况？我正在考虑数据库充满数据的地方，我不希望新的可为空字段破坏它，或者这是可以预期的？

这是一个例外：

```
W/System.err(16955): java.sql.SQLException: Unknown field 'newField' from the Android sqlite cursor, not in:[desc, name, id]
W/System.err(16955):    at com.j256.ormlite.android.AndroidDatabaseResults.findColumn(AndroidDatabaseResults.java:97)
W/System.err(16955):    at com.j256.ormlite.field.FieldType.resultToJava(FieldType.java:793)
W/System.err(16955):    at com.j256.ormlite.stmt.mapped.BaseMappedQuery.mapRow(BaseMappedQuery.java:60)
W/System.err(16955):    at com.j256.ormlite.stmt.SelectIterator.getCurrent(SelectIterator.java:270) 
```

* * *

这是我在更新实体类以包含以下新字段时遇到的异常。

```
@DatabaseField( canBeNull = true  )
private String newField; 
```

现在看到，如果我删除新字段，我的测试用例/应用程序工作正常，那么正是这段代码破坏了事情。

```
[2012-07-05 22:42:00 - WishListManager] Success!
[2012-07-05 22:42:00 - WishListManagerTest] Launching instrumentation android.test.InstrumentationTestRunner on device emulator-5554
[2012-07-05 22:42:00 - WishListManagerTest] Collecting test information
[2012-07-05 22:42:02 - WishListManagerTest] Sending test information to Eclipse
[2012-07-05 22:42:02 - WishListManagerTest] Running tests...
[2012-07-05 22:42:04 - WishListManagerTest] Test run failed: Instrumentation run failed due to 'java.lang.NullPointerException'
[2012-07-05 22:42:04 - WishListManagerTest] Test run finished

07-05 21:42:02.084: I/TestRunner(16955): started: testAddDuplicateWishLists(com.tests.WishListServiceTest)
07-05 21:42:02.504: I/global(16955): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
07-05 21:42:02.524: I/global(16955): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
07-05 21:42:02.654: D/dalvikvm(16955): GC_FOR_MALLOC freed 4623 objects / 361912 bytes in 63ms
07-05 21:42:02.754: I/global(16955): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
07-05 21:42:02.764: I/global(16955): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
07-05 21:42:02.774: W/System.err(16955): java.sql.SQLException: Unknown field 'newField' from the Android sqlite cursor, not in:[desc, name, id]
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.android.AndroidDatabaseResults.findColumn(AndroidDatabaseResults.java:97)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.field.FieldType.resultToJava(FieldType.java:793)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.stmt.mapped.BaseMappedQuery.mapRow(BaseMappedQuery.java:60)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.stmt.SelectIterator.getCurrent(SelectIterator.java:270)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.stmt.SelectIterator.nextThrow(SelectIterator.java:161)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.stmt.StatementExecutor.query(StatementExecutor.java:161)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.stmt.StatementExecutor.queryForAll(StatementExecutor.java:113)
07-05 21:42:02.784: W/System.err(16955):    at com.j256.ormlite.dao.BaseDaoImpl.queryForAll(BaseDaoImpl.java:237)
07-05 21:42:02.784: W/System.err(16955):    at com.test.db.WishListService.getAllWishLists(WishListService.java:42)
07-05 21:42:02.784: W/System.err(16955):    at com.test.WishListManagerActivity.setupListView(WishListManagerActivity.java:48)
07-05 21:42:02.784: W/System.err(16955):    at com.test.WishListManagerActivity.onStart(WishListManagerActivity.java:44)
07-05 21:42:02.784: W/System.err(16955):    at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1129)
07-05 21:42:02.784: W/System.err(16955):    at android.app.Activity.performStart(Activity.java:3781)
07-05 21:42:02.784: W/System.err(16955):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2636)
07-05 21:42:02.784: W/System.err(16955):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-05 21:42:02.794: W/System.err(16955):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-05 21:42:02.794: W/System.err(16955):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-05 21:42:02.794: W/System.err(16955):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-05 21:42:02.794: W/System.err(16955):    at android.os.Looper.loop(Looper.java:123)
07-05 21:42:02.794: W/System.err(16955):    at android.app.ActivityThread.main(ActivityThread.java:4627)
07-05 21:42:02.794: W/System.err(16955):    at java.lang.reflect.Method.invokeNative(Native Method)
07-05 21:42:02.794: W/System.err(16955):    at java.lang.reflect.Method.invoke(Method.java:521)
07-05 21:42:02.794: W/System.err(16955):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-05 21:42:02.794: W/System.err(16955):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-05 21:42:02.794: W/System.err(16955):    at dalvik.system.NativeStart.main(Native Method)
07-05 21:42:02.804: D/AndroidRuntime(16955): Shutting down VM
07-05 21:42:02.804: W/dalvikvm(16955): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
07-05 21:42:02.814: E/AndroidRuntime(16955): FATAL EXCEPTION: main
07-05 21:42:02.814: E/AndroidRuntime(16955): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.test/com.test.WishListManagerActivity}: java.lang.NullPointerException
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.os.Looper.loop(Looper.java:123)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.ActivityThread.main(ActivityThread.java:4627)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at java.lang.reflect.Method.invokeNative(Native Method)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at java.lang.reflect.Method.invoke(Method.java:521)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at dalvik.system.NativeStart.main(Native Method)
07-05 21:42:02.814: E/AndroidRuntime(16955): Caused by: java.lang.NullPointerException
07-05 21:42:02.814: E/AndroidRuntime(16955):    at com.test.WishListManagerActivity.setupListView(WishListManagerActivity.java:51)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at com.test.WishListManagerActivity.onStart(WishListManagerActivity.java:44)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1129)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.Activity.performStart(Activity.java:3781)
07-05 21:42:02.814: E/AndroidRuntime(16955):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2636)
07-05 21:42:02.814: E/AndroidRuntime(16955):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T13:34:13.093

> 我的 ORMlite 服务运行良好。所有 CRUD 操作都可以正常工作。但是，当我向我的实体添加一个新的可为空字段时，整个事情都失败了。

所以[ORMLite](http://ormlite.com/)例外对我来说似乎很有帮助：

```
java.sql.SQLException: Unknown field 'newField' from the Android sqlite cursor,
    not in:[desc, name, id] 
```

您正在尝试提取该`newField`字段，但它不在数据库表中。这向我表明您没有*更新*数据库的架构。它在表中的唯一字段是`desc`、`name`和`id`。

升级数据库表的代码尚未运行，或者无法正常工作。我会看一下我写的关于[如何在 Android 下升级架构](http://ormlite.com/docs/upgrade-schema)的文档页面。

不幸的是，Sqlite 只支持少数`ALTER TABLE`命令，但`ADD COLUMN` *它就是*其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-20T07:36:55.400

**我用升级数据库版本**解决了这个问题！您应该知道在数据库中添加或删除..时应该升级数据库版本！

**例子：**

```
if the current version is = 2 after the change should be 3 ; 
```

# r - GLMM 上的 allEffects() 给出错误消息

> ID：11347940
> 
> 赞同：2
> 
> 时间：2012-07-05T15:45:36.927
> 
> 标签：r, effects

当我尝试在使用 lme4 中的 glmer() 创建的 GLMM (mpc7j) 上使用效果包中的 allEffects() 时，我在 R 中收到以下错误消息：

```
> mpc7j<- glmer(correct_response ~ pc * Stim.cond + sess:pc + sess:Stim.cond +
                (1|item.no) + (1|id), data=d7nowl, family=binomial)

> allEffects(mpc7j)
Error in eval(expr, envir, enclos) : Object 'sess' not found 
```

当我在不同模型（“虚拟”）上对相同数据使用 allEffects() 时，在固定效果中没有包含“sess”的术语，它工作得很好。

```
> dummy<- glmer(correct_response ~ pc * Stim.cond + (1|item.no) + (1|id),
                data=d7nowl, family=binomial) 
```

我使用 str(mpc7j) 检查我的模型，看起来“sess”作为对比处理组中的一个因素。

```
.. .. ..$ pc       : chr "contr.treatment"
.. .. ..$ Stim.cond: chr "contr.treatment"
.. .. ..$ sess     : chr "contr.treatment" 
```

“sess”是一个有 2 个级别的因子，指的是测试的时间（重复测量，会话 1 和会话 2）。我测试的科目之一只测试了一次，而不是像所有其他科目一样两次。这可能与错误有关吗？

对于我在这里做错了什么或我应该在哪里寻找解决方案的任何指示，我将不胜感激。我已经用谷歌搜索了错误消息但没有成功。关于 allEffects() 函数的 R 文档也没有帮助我。请帮忙？

编辑：当我尝试使用 languageR 中的 plotLMER.fnc() 时，我收到此错误：

```
> plotmpc7j<-plotLMER.fnc(mpc7j)
log odds are back-transformed to probabilities
Fehler: Indizierung außerhalb der Grenzen 
```

最后一行翻译成类似“错误：超出范围的索引”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T18:14:50.427

即使这不完整，我还是将其作为答案而不是评论发布，因为它很长并且包含很多代码......（我可以稍后返回并删除它......

到目前为止，底线是这不是/ GLMM`glmer`特定的问题，而是包含交互项（在本例中为`sess:pc`和`sess:Stim.cond`）但没有主效应（`sess`，但并非总是错误的......这可能是为什么他们没有被`effects`包裹处理）。我会考虑联系包维护者 ( `maintainer("effects")`) ...

创建具有正确结构的虚拟数据集：

```
d7nowl <- expand.grid(pc=factor(LETTERS[1:2]),
                      Stim.cond=factor(letters[1:2]),
                      sess=factor(1:2),
                      item.no=factor(1:10),id=factor(1:10))
d7nowl$correct_response <- rbinom(nrow(d7nowl),size=1,prob=0.5) 
```

安装 GLMM：

```
g1 <- glmer(correct_response ~ pc * Stim.cond + sess:pc + sess:Stim.cond +
            (1|item.no) + (1|id), data=d7nowl, family=binomial)

## reproduce error
try(allEffects(g1)) 
## Error in eval(expr, envir, enclos) : object 'sess' not found 
```

现在尝试使用 GLM 的类似模型。

```
g2 <- glm(correct_response ~ pc * Stim.cond + sess:pc + sess:Stim.cond,
            data=d7nowl, family=binomial)    
try(allEffects(g2)) ## same error 
```

`allEffects`给我们一个答案（我还没有检查它是否有意义）如果我们添加的主要效果*或*`sess` *（*如原始问题中所指出的）取出与`sess`.

```
g3 <- update(g2,.~.+sess)
try(allEffects(g3)) ## OK

g4 <- update(g2,.~.-sess:pc-sess:Stim.cond)
try(allEffects(g4)) ## OK 
```

如果我尝试进一步简化仍然`allEffects`会中断，但会出现不同的错误消息：

```
g5 <- glm(correct_response ~ pc + sess:pc, data=d7nowl, family=binomial)
try(allEffects(g5))
## Error in mod.matrix[, components] : subscript out of bounds 
```

准确了解哪里出了问题需要深入研究`effects:::analyze.model`（内部效用函数）的内容，以查看逻辑哪里出了问题。

# .net - 将对象转换为字符串的最佳实践

> ID：11347953
> 
> 赞同：7
> 
> 时间：2012-07-05T15:46:15.857
> 
> 标签：.net, vb.net

我在 .NET 中看到了许多将 an 转换`Object`为 a的方法`String`，通常用于在对象类型未知时向用户显示对象的值。

这些包括：

```
Dim x as Object = 3
Dim y as Object = Nothing
Dim z as Object = DBNull.Value
Dim l_displayString As String

l_displayString = "" & x & "" & y & "" & z
l_displayString = If(x, "").ToString() & If(y, "").ToString() & If(z, "").ToString()
l_displayString = Convert.ToString(x) & Convert.ToString(y) & Convert.ToString(z) 
```

是否有微软推荐的方法，或者这些方法都编译成相同的字节码？

编辑：

让我稍微扩展一下这个问题，包括：

这些方法之间有什么区别？我看不到引擎盖下发生了什么，所以很高兴知道其中一个是否比其他的有任何性能优势。在某些情况下，这些调用可能会进行数千次（例如从大表中读取），并且减少几秒钟可能会对用户体验产生重大影响。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T15:49:44.483

`Convert.ToString(x)`即使 x 为空，也可以正常工作。 一般来说，在处理来自数据库的东西时，我认为 Convert 是最好的方法。另一个建议是，在使用浮点数/十进制数时，请留意 CultureInfo，即不要相信 . 作为十进制符号，如果你想假设使用`CultureInfo.InvariantCulture`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T16:00:28.147

他们做不同的事情。它们编译为不同的 MSIL 代码，但在大多数情况下，它们可能具有相同的结果。

`ToString`是由 定义的方法`Object`，它是所有对象的固有基类型。默认情况下，它返回对象的类型名称，但它可以（并且经常）被每种类型覆盖，以便返回更有意义的字符串。例如，在您的示例中，`x`是一个`Int32`对象，并且`Int32`会覆盖`ToString`，因此它返回`"3"`而不是默认的“System.Int32”。

我不是很肯定，但我怀疑当您进行连接时`"" & x`，它会转换`x`为 a `String`，在这种情况下，它是输入`"" & CType(x, String)`or的快捷方式`"" & CStr(x)`。每种类型都可以重载强制转换运算符，因此它假定类型（在这种情况下`Int32`）已经重载了运算符，因此可以强制转换为字符串。事实上，它已经并且可以。

`Convert.ToString`根据你调用的重载做不同的事情。如果你给它传递一个`Int32`，它只会调用对象的`ToString()`方法。但是，如果你给它传递一个`Object`，例如，它首先检查对象是否实现了`IConvertible`或`IFormattable`。如果是，则使用其中之一，否则使用该`ToString`方法。因此，它会根据您发送给它的对象类型来尝试确定它认为最有可能将该类型转换为字符串的最佳方式。

至于首选方法`x.ToString()`是什么，我想说的是您一直最想使用的方法，除非您有其他问题（这完全取决于您对对象所做的事情）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T17:23:05.103

我决定使用 1,000,000 个对象的集合来测试每种方法的性能。对象是以下之一：整数、类、Nothing 或 DBNull.Value。每次测试都使用相同的集合，我测试了每种方法 50 次。

`"" & x`
这实际上不适用于所有对象。它适用于 DBNull.Value 和 Nothing，但尝试将此方法与任何 ol' 对象一起使用将导致 InvalidCastException。有趣的是，CStr(DBNull.Value) 会抛出 InvalidCastException，所以我不确定它为什么会起作用。

使用自定义对象的结果：不适用 没有自定义对象**的**
结果：平均**126.7 毫秒**，中位数**126 毫秒**

`If(x, "").ToString()`
使用自定义对象的结果：平均**140.46 毫秒**，中位数**138 毫秒**
没有 自定义对象的结果：平均**69.32 毫秒**，中位数**69 毫秒**

`Convert.ToString()`
使用自定义对象的结果：平均**171.54 毫秒**，中位数**171 毫秒**
没有 自定义对象的结果：平均**112.14 毫秒**，中位数**112 毫秒**

因此，对于非常大的记录集来说，这似乎`If(x, "").ToString()`有点快，但这需要与`Convert.ToString()`'s 更强大的转换选项相平衡。感谢您的回答。

这是我用于测试的代码：

```
Option Strict Off

Module Module1

    Sub Main()
        Dim l_objectArray = Enumerable.Range(0, 1000000).Select(Function(x) GetObject(x)).ToArray()

        Dim l_stopWatch As New Stopwatch()
        Dim l_testResults As New List(Of Long)
        Dim l_testIterations As Integer = 50
        Dim l_displayValue As String

        Do

            ' --------------------

            'Console.WriteLine()
            'Console.WriteLine("Conversion using string concatenation")
            'l_testResults.Clear()

            'For iteration = 0 To l_testIterations - 1
            '    l_stopWatch.Start()
            '    For Each o In l_objectArray
            '        l_displayValue = "" & o
            '    Next
            '    l_stopWatch.Stop()
            '    l_testResults.Add(l_stopWatch.ElapsedMilliseconds)
            '    l_stopWatch.Reset()
            'Next

            'Console.WriteLine()
            'Console.WriteLine("Average: " & l_testResults.Average())
            'Console.WriteLine("Median: " & GetMedian(l_testResults.ToArray()))

            ' --------------------

            Console.WriteLine()
            Console.WriteLine("Conversion using Object.ToString()")
            l_testResults.Clear()

            For iteration = 0 To l_testIterations - 1
                l_stopWatch.Start()
                For Each o In l_objectArray
                    l_displayValue = If(o, "").ToString()
                Next
                l_stopWatch.Stop()
                l_testResults.Add(l_stopWatch.ElapsedMilliseconds)
                l_stopWatch.Reset()
            Next

            Console.WriteLine()
            Console.WriteLine("Average: " & l_testResults.Average())
            Console.WriteLine("Median: " & GetMedian(l_testResults.ToArray()))

            ' --------------------

            Console.WriteLine()
            Console.WriteLine("Conversion using Convert.ToString(x)")
            l_testResults.Clear()

            For iteration = 0 To l_testIterations - 1
                l_stopWatch.Start()
                For Each o In l_objectArray
                    l_displayValue = Convert.ToString(o)
                Next
                l_stopWatch.Stop()
                l_testResults.Add(l_stopWatch.ElapsedMilliseconds)
                l_stopWatch.Reset()
            Next

            Console.WriteLine()
            Console.WriteLine("Average: " & l_testResults.Average())
            Console.WriteLine("Median: " & GetMedian(l_testResults.ToArray()))

            ' --------------------

            Console.WriteLine()
            Console.Write("Exit? (y/n): ")
            Dim l_key = Console.ReadKey(False)
            If l_key.Key = ConsoleKey.Y Then
                Exit Sub
            End If

        Loop

    End Sub

    Private Function GetMedian(ByVal values As Long()) As Long
        Array.Sort(values)
        If values.Length Mod 2 = 0 Then
            Return (values(values.Length / 2) + values(values.Length / 2 - 1)) / 2
        Else
            Return values(CInt(Math.Floor(values.Length / 2)))
        End If
    End Function

    Private Function GetObject(ByVal someNumber As Integer) As Object
        Select Case someNumber Mod 4
            Case 0
                Return someNumber
            Case 1
                Return New SomeClass(someNumber)
                'Return Nothing
            Case 2
                Return DBNull.Value
            Case Else
                Return Nothing
        End Select
    End Function

    Private Class SomeClass

        Private _seed As Integer

        Public Sub New(ByVal seed As Integer)
            _seed = seed
        End Sub

        Public Overrides Function ToString() As String
            Return _seed.ToString()
        End Function

    End Class

End Module 
```

# python - 如何简化大量类似的 if

> ID：11347954
> 
> 赞同：6
> 
> 时间：2012-07-05T15:46:17.223
> 
> 标签：python

我试图弄清楚如何简化这段代码。每个 if 条件的逻辑基本相同，所以我想摆脱重复的 if：

```
 if "video_codec" in profile:
          self.video_codec = profile["video_codec"]
      if "resolution_width" in profile:
          self.resolution_width = profile["resolution_width"]
      if "resolution_height" in profile:
          self.resolution_height = profile["resolution_height"]
      if "ratio" in profile:
          self.ratio = profile["ratio"]
      if "video_bitrate" in profile:
          self.video_bitrate = profile["video_bitrate"]
      if "profile" in profile:
          self.profile = profile["profile"]
      if "audio_codec" in profile:
          self.audio_codec = profile["audio_codec"]
      if "audio_channels" in profile:
          self.audio_channels = profile["audio_channels"]
      if "audio_bitrate" in profile:
          self.audio_bitrate = profile["audio_bitrate"] 
```

我希望这可以用 3-4 行而不是我的 18 行来完成。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-05T15:48:05.677

```
for key, value in profile.iteritems():
    setattr(self, key, value) 
```

应该做你想做的

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-05T15:50:23.450

如果您只想将所有键/值对从 复制`profile`到 中的属性`self`，则可以使用以下内容：

```
self.__dict__.update(profile) 
```

如果`profile`您不想复制某些项目，则可以使用以下内容：

```
for attr in ("video_codec", "resolution_width", "resolution_height", "video_bitrate", 
             "ratio", "profile", "audio_codec", "audio_channels", "audio_bitrate"):
    if attr in profile: 
        setattr(self, attr, profile[attr]) 
```

# ruby-on-rails - 当 PayPal 发布到“返回”网址时，如何阻止 Devise 注销我的用户？

> ID：11347956
> 
> 赞同：0
> 
> 时间：2012-07-05T15:46:28.097
> 
> 标签：ruby-on-rails, authentication, devise, paypal

当 PayPal 发布到“返回”网址时，Devise 正在注销我的用户。有没有办法让贝宝发布到“返回”网址并让用户保持登录状态？

我认为这是因为会话标识符不存在于贝宝帖子中。但是不应该有一种方法让用户保持登录状态吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T17:50:27.427

如果 paypal 不包含您的应用程序所需的正确 CSRF 元参数，也会发生这种情况。如果您在没有提供正确 CSRF 参数的情况下发布到 rails 应用程序，您的会话将被删除。这听起来像是正在发生的事情。解决此问题的一种方法是禁用贝宝发布操作的 CSRF 元保护

如果确实发生这种情况，请在此处查看如何禁用

[https://stackoverflow.com/a/5669377/68393](https://stackoverflow.com/a/5669377/68393)

# excel - Excel根据匹配条件获取多个值？

> ID：11347958
> 
> 赞同：-1
> 
> 时间：2012-07-05T15:46:31.553
> 
> 标签：excel, excel-2007, vba

我有一个包含 1000 条记录的电子表格。列如下所示：

```
> Path            Year-Month    Timestamp         # SN  Filename                Match
> D:\ABC\trt21.mrk  2012-04     4/17/2012 10:57      2  trt21.mrk              abcd.mrk
> D:\DEF\pty09.mrk  2012-05     5/17/2012 10:57      1  pty09.mrk              zzz12.mrk
> D:\ABC\abcd.mrk   2012-06     6/17/2012 10:55      1  abcd.mrk               ddy1.mrk
> D:\ABC\abcd.mrk   2012-07    7/2/2012 10:34        3  abcd.mrk 
```

Path、year-Month、Timestamp、#SN 列都是 Filename 列的相关信息。匹配列包含一些我感兴趣的文件。我希望能够找到匹配列中的文件名是否在文件名列中，然后给我它的所有相关信息，例如路径、年月、时间戳、#SN、文件名。

所以它会让我回到这个：

```
> Path            Year-Month    Timestamp         # SN  Filename                Match

> D:\ABC\abcd.mrk   2012-06     6/17/2012 10:55      1  abcd.mrk               abcd.mrk
> D:\ABC\abcd.mrk   2012-07    7/2/2012 10:34        3  abcd.mrk 
```

关于如何获得它的任何想法？TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:55:59.780

你需要使用[vlookup](http://office.microsoft.com/en-us/excel-help/vlookup-HP005209335.aspx)

在您的特定情况下，它将是这样的：`=VLOOKUP(A1,A1:D25,1,FALSE)`

A1 是您要查找的值，A1:D25 是您的数据源（包含源数据的表），1 是您希望返回的与源数据相关的列号

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T15:57:41.263

使用排序和过滤不是一个选项吗？使用排序和过滤器，如果您突出显示所有数据，然后从数据功能区选择过滤器中，它将允许您突出显示要根据该列查看的数据。因此，如果您只想查看包含“abcd.mrk”的文件，您可以点击“文件名”列上的下拉菜单，然后只在“abcd.mrk”旁边打勾。如果您想查看多个匹配项，例如“abcd.mrk”和“pty09.mrk”，您只需在下拉列表中的两个旁边放置复选框。

# javascript - VLC 在 JS api 中使用 :input-slave 参数

> ID：11347959
> 
> 赞同：2
> 
> 时间：2012-07-05T15:46:33.717
> 
> 标签：javascript, vlc

我正在尝试使用以下代码使用 :input-slave 选项同时使用 VLC JS api 播放两个文件（视频 + 音频），但运气不佳。

另外，他们玩得很好。

有人有想法吗？

谢谢！

```
function doGo(){

    var vlc = getVLC("vlc");

    var options = [":rtsp-tcp",":input-slave=file://place/audio.WAV"];

      var itemId = vlc.playlist.add("file://place/video.AVI","",options);
      options = [];
       vlc.playlist.playItem(itemId);
    }
} 
```

# docx4j - 获取 docx4j 比较的详细信息

> ID：11347961
> 
> 赞同：0
> 
> 时间：2012-07-05T15:46:35.937
> 
> 标签：docx4j

我从这里接受了比较 docx 文件的建议：[OutOfMemoryError while doing docx comparison using docx4j](https://stackoverflow.com/questions/7308299/outofmemoryerror-while-doing-docx-comparison-using-docx4j)

但是，这一行：

```
Body newBody = (Body) org.docx4j.XmlUtils.unmarshalString(contentStr); 
```

触发许多 JAXB 警告，例如：

```
WARN org.docx4j.jaxb.JaxbValidationEventHandler .handleEvent line 80 - [ERROR] : unexpected element (uri:"", local:"ins"). Expected elements are <{[?]}text>
INFO org.docx4j.jaxb.JaxbValidationEventHandler .handleEvent line 106 - continuing (with possible element/attribute loss) 
```

这是可以理解的，因为`org.docx4j.wml.Text`它不表示对任何嵌套标签的处理，*并且*包含编写的字符串`Docx4jDriver.diff()`：

```
<w:t dfx:insert="true" xml:space="preserve"><ins>This</ins><ins> </ins><ins>first</ins><ins> </ins><ins>line</ins><ins> </ins><ins>has</ins><ins> </ins><ins>a</ins><ins> </ins></w:t> 
```

因此，`Text.getValue()`包含`<ins>`标签的调用返回一个空字符串。

我正在尝试使用建议的方法和以下代码以编程方式确定两个 docx 文件之间的差异（原始 + 往返 docx 转换过程的结果）：

```
Body newBody = (Body) org.docx4j.XmlUtils.unmarshalString(contentStr);

for ( Object bodyPart : newBody.getContent() ) {
  if ( bodyPart instanceof P ) {
    P bodyPartInCast = (P)bodyPart;
    for ( Object currentPContent : bodyPartInCast.getContent() ) {
      if ( currentPContent instanceof R ) {
        R pContentCast = (R)currentPContent;
        for( Object currentRContent : pContentCast.getContent() ) {
          if ( currentRContent instanceof JAXBElement ) {
            JAXBElement rContentCast = (JAXBElement)currentRContent;
            Object jaxbValue = rContentCast.getValue();
            if ( jaxbValue instanceof Text ) {
              Text textValue = (Text)jaxbValue;
              System.out.println( "Text: --> " + textValue.getValue() );
            } 
          }
        }
      } 
    }
  } 
} 
```

所以，问题是：如果这不是处理两个文件之间差异细节的正确方法，那是什么？

我正在使用 docx4j 2.8.0 版，正在比较的两个 docx 文件是：

1.  [文件 1（输入）](https://docs.google.com/open?id=0B6_h2TfqvEdebnlsUVd1NXJHTXc)
2.  [文件 2（输出）](https://docs.google.com/open?id=0B6_h2TfqvEdeZ0pGamNiY3FNX2s)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-05T22:23:39.073

**披露：我在 docx4j 上工作**

查看使用[Differencer](https://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/diff/Differencer.java)将差异结果转换回有效 WordML 内容的[CompareDocuments 。](https://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/samples/CompareDocuments.java)

# django - 如何在 Django 中的请求之间保存对象？

> ID：11347967
> 
> 赞同：1
> 
> 时间：2012-07-05T15:47:01.490
> 
> 标签：django, ssh

我正在 Django 中开发一个内部服务器监控/管理工具，我不太熟悉。应用程序经常需要通过 SSH 连接到其他服务器，发出命令并读取响应。目前我用 paramiko 做这个，它工作正常。

但是，现在我正在为每个请求重新连接到每个服务器。这感觉像是糟糕的设计，我宁愿让所有 SSH 连接（很少）在整个应用程序的生命周期中保持不变。我知道这在例如 NodeJS 中是可能的。

即我想要做的是能够访问某种“全局”变量“ssh_connection1”并通过它发出命令，而不是每次请求都创建一个新的局部变量。

这在 Django 中可能吗？您对此有更好的解决方案吗？

注意：我看到了类似的问题，但它们主要涉及在请求而不是*连接之间保存**数据*。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:54:25.200

我认为最好的办法是使用单独的进程，例如保持持久连接的扭曲客户端。您的 django 线程可以检查客户端进程是否处于活动状态，如果是，它可以通过套接字或其他一些快速的本地方法与该进程通信。这类似于依赖于像 PgBouncer 这样的单独守护进程的池化数据库连接策略。

这是一种相当复杂的方法，但我不知道有任何替代方法，即一种将连接对象直接从一个请求传递到另一个请求的方法。即使可以像这样传递连接对象，您也会遇到并发请求尝试使用相同连接对象的问题。如果你用twisted 编写一个单独的进程，你可以建立一个连接池系统来管理这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T17:10:34.973

正如 Andrew Gorcester 建议的那样，您可以实现另一个进程/守护进程，它将与您的服务器对话并获取信息。它还将推送数据库中的信息，您的 django 应用程序将使用这些信息来显示。这样，您可以分离出您的实现以在单独的模块中检索数据。

此外，您可以在 django 中将守护进程实现为您自己的自定义管理命令，以利用 django 的优势（相同的模型、方法等），请参阅[编写管理命令](https://docs.djangoproject.com/en/dev/howto/custom-management-commands/)。您可以通过 cron 或 init 脚本运行此命令。*

# ruby-on-rails - Ruby - 不确定调用函数的语法

> ID：11347969
> 
> 赞同：0
> 
> 时间：2012-07-05T15:47:08.913
> 
> 标签：ruby-on-rails, ruby

我在 ruby​​ 控制台中，我试图调用一个方法，但语法不正确。

这是文件的结构：

```
module App
  module Tools
    module Pollers
      class Kpi
        attr_reader :start_time,:stop_time

        def initialize(start_time,stop_time)
          @start_time = start_time
          @stop_time = stop_time
        end
        ..... 
```

我试图在控制台中调用它，如下所示：

```
?> kpi = App::Tools::Pollers::Kpi.initialize(start,end_date)
SyntaxError: compile error
(irb):17: syntax error, unexpected tCONSTANT, expecting kDO or '{' or '(' 
```

有人能指出我调用初始化的正确语法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T15:51:52.330

`initialize`是类的实例方法`Kpi`。`App::Tools::Pollers::Kpi`是一个类，并且只能在其上运行类方法。Ruby 为每个类免费提供了一个类方法来初始化。这种方法是`new`。Call `new`，它采用与 your 相同的参数`initialize`，并返回一个实例：

```
kpi = App::Tools::Pollers::Kpi.new(start,end_date) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T15:51:52.050

从错误消息来看，问题出在其他地方，但您可能想要`Kpi.new`，而不是`Kpi.initialize`。

好吧，显然它不在其他地方:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-05T15:53:35.817

这将是

```
App::Tools::Pollers::Kpi.new(start,end_date) 
```

在您的 irb 会话中似乎还存在语法错误。

# php - PHP 变量不在查询中求值

> ID：11347971
> 
> 赞同：14
> 
> 时间：2012-07-05T15:47:31.130
> 
> 标签：php, search, mysqli

我对 PHP 和 MySQL 还很陌生，我只是想不通。我在论坛上搜索了所有内容，但没有找到我能理解的答案。我最初使用的是 mysql_fetch_assoc() 但我只能搜索数字，并且在搜索字母时也收到错误。我希望我在这里走在正确的轨道上。预先感谢您的所有帮助！

```
$con = mysqli_connect($hostname,$username,$password) or die ("<script language='javascript'>alert('Unable to connect to database')</script>");
mysqli_select_db($con, $dbname);

if (isset($_GET['part'])){
    $partid = $_GET['part'];
    $sql = 'SELECT * 
        FROM $usertable 
        WHERE PartNumber = $partid';

    $result = mysqli_query($con, $sql);
    $row = mysqli_fetch_assoc($result);

    $partnumber = $partid;
    $nsn = $row["NSN"];
    $description = $row["Description"];
    $quantity = $row["Quantity"];
    $condition = $row["Conditio"];
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-05T15:50:54.047

当您的结果不是结果（而是“假”）时，就会发生这种情况。你应该改变这一行

```
$sql = 'SELECT * FROM $usertable WHERE PartNumber = $partid'; 
```

对此：

```
$sql = "SELECT * FROM $usertable WHERE PartNumber = $partid"; 
```

因为 " 可以解释 $variables 而 ' 不能。

适用于整数（数字），对于需要将 $variable 放在单引号中的字符串，例如

```
$sql = "SELECT * FROM $usertable WHERE PartNumber = '$partid' "; 
```

如果你想/必须使用单引号，那么 php 不能解释变量，你必须这样做：

```
 $sql = 'SELECT * FROM '.$usertable.' WHERE string_column = "'.$string.'" AND integer_column = '.$number.'; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-05T15:51:17.527

```
mysqli_fetch_assoc() expects parameter 1 to be mysqli_result, boolean given 
```

这意味着您传递的第一个参数是布尔值（真或假）。

第一个参数是`$result`, 是`false`因为查询中有语法错误。

```
" ... WHERE PartNumber = $partid';" 
```

您永远不应该在 SQL 查询中直接包含请求变量，否则用户可以在您的查询中注入 SQL。（请参阅[**SQL 注入**](https://en.wikipedia.org/wiki/SQL_injection)。）

您应该转义变量：

```
" ... WHERE PartNumber = '" . mysqli_escape_string($conn,$partid) . "';" 
```

或者更好的是，使用[`Prepared Statements`](http://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-05T15:50:35.987

您正在单引号引用使变量变为文本而不是变量的 SQL 语句。

```
$sql = "SELECT * 
    FROM $usertable 
    WHERE PartNumber = $partid"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T15:56:49.363

Mysqli 使用面向对象的编程。尝试改用这种方法：

```
function dbCon() {
        if($mysqli = new mysqli('$hostname','$username','$password','$databasename')) return $mysqli; else return false;
}

if(!dbCon())
exit("<script language='javascript'>alert('Unable to connect to database')</script>");
else $con=dbCon();

if (isset($_GET['part'])){
    $partid = $_GET['part'];
    $sql = "SELECT * 
        FROM $usertable 
        WHERE PartNumber = $partid";

    $result=$con->query($sql_query);
    $row = $result->fetch_assoc();

    $partnumber = $partid;
    $nsn = $row["NSN"];
    $description = $row["Description"];
    $quantity = $row["Quantity"];
    $condition = $row["Conditio"];
} 
```

如果您有任何问题，请告诉我，我无法测试此代码，因此您可能需要对其进行三次检查！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T15:51:40.280

如果`$usertable`不是有效表或不包含列 PartNumber 或 part 不是数字，代码中会发生什么。

您必须转义 $partid 并阅读 mysql_fetch_assoc() 的文档，因为它可以返回布尔值

# java - 为什么 Android 在套接字末尾发送奇怪的符号？(�)

> ID：11347972
> 
> 赞同：2
> 
> 时间：2012-07-05T15:47:44.180
> 
> 标签：java, android, sockets, udp, multicast

为什么 Android 会发送这个符号？(�)

我正在做的是，获取一些变量，将它们放在一起，然后使用多播发送。这些符号只出现在字符串的末尾，并且重复很多。

```
byte[] buffer;

String temp1 = "temp1=" + "37";
String weight1 = "weight1=" + "68";
String bpm = "bpm=" + "128";
String angBack = "angback=" + "90";
String angLeg = "angleg=" + "90";
String angBed = "angbed=" + "91";

String msg = "status:teste," + temp1 + "," + weight1 + "," + bpm + "," + angBack + 
              "," + angLeg + "," + angBed;

buffer = msg.getBytes();

InetAddress group = InetAddress.getByName("230.0.0.1");

DatagramPacket packet = new DatagramPacket(buffer, buffer.length, group, 5556);
socket.send(packet); 
```

然后在另一边，我得到了字符串，这些符号出现在字符串的末尾。

```
byte[] buffer = new byte[256];

DatagramPacket packet = new DatagramPacket(buffer, buffer.length);

multicastSocket.receive(packet);

String msg = new String(packet.getData()); 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:52:44.143

这不是一个奇怪的符号，它只是`0x00`.
您正在写入整个缓冲区，请检查数据长度。

```
String msg = new String(packet.getData(), packet.getOffset(), packet.getLength()); 
```

# python - 设置发布数据 python apache

> ID：11347973
> 
> 赞同：0
> 
> 时间：2012-07-05T15:47:49.197
> 
> 标签：python, apache, post, mod-python

对于登录脚本，我正在尝试在 apache 上的 python 中使用 POST 设置会话 ID。但是，据我所知，除了进行重定向之外，似乎没有任何方法可以做到这一点。此外，现在我有了会话 ID，我可以使用任何方法来设置会话 ID（POST 似乎是最明显的）。我也想让它在标签之间工作。Cookies 似乎是一个更好的选择，尽管实施起来可能需要更多的努力。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T02:39:57.100

原来apache有一个cookie模块。

```
from mod_python import Cookie
ID = Cookie.get_cookie(req, 'ID')
if ID:
    ID.expires = time.time() + 60*120
    Cookie.add_cookie(req, ID)
    ID = ID.value
else:
    ID = None 
```

# c# - 如何在 asp.net 中将 Page_load 重命名为 PageName_load

> ID：11347979
> 
> 赞同：1
> 
> 时间：2012-07-05T15:48:06.137
> 
> 标签：c#, asp.net

```
 Instead of page_load i want to write PageName_Load, how can i do 
```

最近这个问题被问到我面试的公司之一

问候普拉文

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T15:51:24.607

在构造函数中附加一个事件处理程序：

```
public class MyPage : System.Web.UI.Page
{
   public MyPage()
   {
      this.Load += new EventHandler(MyPage_Load);
   }

   void MyPage_Load(object sender, EventArgs e)
   {

   }
} 
```

我不相信更改默认约定有任何支持；可能是错的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T15:59:40.437

很久以前在 StackOverflow 上对它进行了很好的描述：[什么调用 Page_Load 以及它是如何做到的？](https://stackoverflow.com/a/1494561/166584)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T18:11:51.997

```
public class BasePage : System.Web.UI.Page
{
    public BasePage()
    {
        var myPageLoadDelegate = (EventHandler)Delegate.CreateDelegate(typeof(EventHandler), this, this.GetType().BaseType.Name + "_Load", true, false);
        if (myPageLoadDelegate != null)
        {
            this.Load += myPageLoadDelegate;
        }
    }
}

public partial class WebForm1 : BasePage
{
    protected void WebForm1_Load(object sender, EventArgs e)
    {

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T16:11:05.473

为了补充 Brian 和 invisible 的帖子，您还可以更改 Web 模板以按照您想要的方式创建页面。

导航到您的 ASP 模板目录：

> C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\ItemTemplates\CSharp\Web\1033

*这可能会根据您的环境而改变，但这应该让您在附近）。*

找到并提取`WebForm.zip` ^(（始终保持备份！）)。您会注意到此模板中的一些文件：

*   `Default.aspx`
    ASPX 页面模板
*   `Default.aspx.cs`
    代码隐藏模板（您通常会在其中添加自己的代码）
*   `Default.aspx.designer.cs`
    IDE 生成的文件（管理页面上的控件列表）。
*   `WebForm.vstemplate` 描述模板所需库等的元数据。

从那里，一些编辑使其成为默认行为：

1.  编辑**Default.aspx**并`AutoEventWireup="true"`从标题中删除。
2.  编辑**Default.aspx.cs**并更改`Page_Load`为`PageName_Load`（或者您可以使用`Page$classname$_Load`我想...）
3.  编辑**Default.aspx.designer.cs**并添加一个绑定的构造函数`this.Load += new EventHandler(PageName_Load)`

保存所有更改，重新压缩回 zip 文件并确保它在您的模板目录中。现在所有新页面都将使用该模板。

# jquery - jQuery - 方法链接不起作用

> ID：11347982
> 
> 赞同：0
> 
> 时间：2012-07-05T15:48:11.060
> 
> 标签：jquery, jquery-selectors

我无法让一组链式方法起作用。

目标是隐藏一个正常工作的对话框面板，然后更改`#nomoreIE`div 的类。

我尝试了许多组合来链接这些`.addClass('masked').removeClass('poped')`方法，而没有任何错误或成功的迹象。

此外，我想提供在需要时重新打开对话框的能力，这就是 append() 方法的意图。

```
$('.lt-ie9 #nomoreIE a.ui-dialog-titlebar-close').live('click', function(e4){

    $('#nomoreIE').addClass('masked').removeClass('poped').animate({
    left: '-148px' }, {
        duration: '80',
        easing: 'easeInExpo'
    }).append('<div id="alert-ie"></div>');

    return false;

}); 
```

任何帮助表示赞赏

谢谢

这是回答“DarkKing”的完整代码列表：

```
 // --------------- ienomore ------------------------------
// faire apparaitre au chargement
$('.lt-ie9 #nomoreIE').css({right: '-140px'}).delay(2000).animate({
       left: '0' }, {
                     duration: '80',
                      easing: 'easeOutBounce'
                     }).removeClass('masked').addClass('poped');

// gestion du close
$('.lt-ie9 #nomoreIE a.ui-dialog-titlebar-close').live('click', function(e3){

    $('#nomoreIE').addClass('masked').removeClass('poped').animate({
       left: '-148px' }, {
                     duration: '80',
                      easing: 'easeInExpo'
                     }).append('<div id="alert-ie"></div>');

return false;

});

//gestion du open
$('.lt-ie9 #nomoreIE #alert-ie').live('click', function(e4){
    $('#nomoreIE').remove('#alert-ie').animate({
       left: '0' }, {
                     duration: '80',
                      easing: 'easeOutBounce'
                     }).removeClass('masked').addClass('poped');

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T08:35:50.213

我已经更新了 jiddle 代码以反映新方法。（[http://jsfiddle.net/elz64/UdmWx/2/](http://jsfiddle.net/elz64/UdmWx/2/)）但是在 Jiddle 中没有任何功能。

我删除了“.lt-ie9”的条件注释和 css 目标来处理 FF 中的 Firebug。

以前的代码在 FF 中工作，但在 IE 中没有，我仍然不知道为什么。

**一件可以肯定的事情：F12 控制台没有被 jQuery dom 操作（！？）刷新，所以它不会实时反映动作。**

我猜有一些特定的 IE 问题，但也有一些工作的东西（如类操作）是控制台未实现的不可见原因！

由于附加的 div（一个小的 6x6 图标）有一些故障，我设法改变了定位等等。现在新代码在 IE 中也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T17:29:53.907

请检查此列表：

*   您选择确保点击处理程序被触发。
*   尝试使用`$(this).parent()`而不是`$('#nomoreIE')`.
*   检查`poped`类以确保存在。

这个问题可以通过这些案例来解决。

# java - 如何实现服务器关闭

> ID：11347988
> 
> 赞同：1
> 
> 时间：2012-07-05T15:48:22.503
> 
> 标签：java, client-server

我一直在寻找一种干净的方式来为我正在开发的服务器实现关闭逻辑。

我可以采取两种方法：

*   使用 Runtime.addShutdownHook() 在发出 Ctrl-C 时优雅地处理关闭。
*   监听指定的关闭端口（类似于 Tomcat 所做的）并在通过该端口接收到适当的命令时关闭。

第一种方法实现起来很简单，但是使用 Ctrl-C 作为关闭机制似乎并不优雅。第二种方法看起来更简洁，但需要配置和侦听另一个端口的开销。

我会很感激这方面的建议，特别是如果你能提出更好的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T15:50:10.083

大概，您的应用程序已经在接收命令，对吧？我的意思是，它必须以某种方式输入！为什么不添加一个额外的关机命令呢？

显然，您在发出命令时需要一些安全性，但是如果您已经拥有执行关闭的代码（无论您将在挂钩中放入什么），您就可以放入命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T15:51:02.120

我不确定你有选择;)

根据您的服务器运行的方式和位置，以及您使用的资源类型，您将需要为有人实际去的奇怪情况实施关闭挂钩，而 ctrl+c 就是整个事情（不管它是否在用户手册或不是）

另一方面，对于常规使用，有一种方法来推送关闭命令似乎是最好的方法。不过，您可能不需要专用端口或命令集；您也许可以将其包含到您的正常现有界面中。

# objective-c - 从 Core Audio 获取内置输出

> ID：11347989
> 
> 赞同：4
> 
> 时间：2012-07-05T15:48:27.993
> 
> 标签：objective-c, macos, core-audio

是否有可能可靠地获得`AudioDeviceID`Mac 的内置输出？我尝试使用`kAudioHardwarePropertyDefaultOutputDevice`来获取当前选择的输出设备，但这可以是任何旧设备，具体取决于用户在系统首选项中选择的内容——我只想要内置扬声器的 ID。

```
AudioObjectPropertyAddress theAddress = { kAudioHardwarePropertyDefaultInputDevice,
                                          kAudioObjectPropertyScopeGlobal,
                                          kAudioObjectPropertyElementMaster };

verify_noerr (AudioObjectGetPropertyData(kAudioObjectSystemObject,
                                         &theAddress,
                                         0,
                                         NULL,
                                         &propsize,
                                         &inputDevice)); 
```

目前我正在获取所有设备的列表并通过执行检查设备的名称字符串`name == "Built-in Output"`。这适用于我的机器，但似乎不是一个非常强大的解决方案！有没有类似的东西`kAudioHardwarePropertyBuiltInOutputDevice`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T13:12:22.190

经过几天的研究，我能想出的最佳答案是寻找您提到的内置输出，但还添加了制造商检查，如下所示...

```
- (NSString *)getBuiltInOutputDeviceUID
{
    NSString *deviceUID = @"";

    AudioObjectPropertyAddress aopa;
    aopa.mSelector = kAudioHardwarePropertyDevices;
    aopa.mScope = kAudioObjectPropertyScopeGlobal;
    aopa.mElement = kAudioObjectPropertyElementMaster;

    UInt32 propSize;
    OSStatus error = AudioObjectGetPropertyDataSize(kAudioObjectSystemObject, &aopa, 0, NULL, &propSize);
    if (error == noErr) {
        int deviceCount = propSize / sizeof(AudioDeviceID);
        AudioDeviceID *audioDevices = (AudioDeviceID *)malloc(propSize);
        error = AudioObjectGetPropertyData(kAudioObjectSystemObject, &aopa, 0, NULL, &propSize, audioDevices);
        if (error == noErr) {
            UInt32 propSize = sizeof(CFStringRef);
            for(int i = 1; i <= deviceCount; i++) {
                NSString *result;
                aopa.mSelector = kAudioDevicePropertyDeviceManufacturerCFString;
                error = AudioObjectGetPropertyData(audioDevices[i], &aopa, 0, NULL, &propSize, &result);
                if (error != noErr || ![result isEqualToString:@"Apple Inc."]) {
                    continue;
                }
                aopa.mSelector = kAudioDevicePropertyDeviceNameCFString;
                error = AudioObjectGetPropertyData(audioDevices[i], &aopa, 0, NULL, &propSize, &result);
                if (error != noErr || ![result isEqualToString:@"Built-in Output"]) {
                    continue;
                }
                aopa.mSelector = kAudioDevicePropertyDeviceUID;
                error = AudioObjectGetPropertyData(audioDevices[i], &aopa, 0, NULL, &propSize, &result);
                if (error == noErr) {
                    deviceUID = result;
                    break;
                }
            }
        }
        free(audioDevices);
    }
    return deviceUID;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-20T11:02:59.493

@Equinox2000 的答案是有效的，但是有一种方法可以避免繁重的字符串比较。只需`AudioObject`使用`kAudioDevicePropertyTransportType`.

```
aopa.mSelector = kAudioDevicePropertyTransportType;
aopa.mScope = kAudioObjectPropertyScopeGlobal;
UInt32 size = sizeof(UInt32);
UInt32 transportType = 0;
OSStatus status = AudioObjectGetPropertyData(device.deviceId, &address, 0, NULL, &size, & transportType);
if (transportType == kAudioDeviceTransportTypeBuiltIn) // that's all the checks
    // do something 
```

# javascript - jquery - 双括号内的对象数组

> ID：11347996
> 
> 赞同：0
> 
> 时间：2012-07-05T15:48:51.363
> 
> 标签：javascript, jquery

我正在尝试创建一个 node.js 聊天应用程序，当有人加入聊天室时，我想将最后 100 条消息推送到他们的浏览器。我有 node.js 将每个聊天消息作为一个对象添加到一个数组中，其中包含消息的用户名和文本。当 node.js 推送对象数组时，它看起来像这样。

```
[
    [
        {
            "username": "Warren2",
            "text": "test1"
        },
        {
            "username": "Warren2",
            "text": "test2"
        },
        {
            "username": "Warren2",
            "text": "test3"
        },
        {
            "username": "Warren2",
            "text": "hello"
        }
    ]
] 
```

我在用 jquery 解析它时遇到了麻烦，我认为 jquery 会抛出错误，因为对象位于一组额外的括号内。我用来创建对象数组的代码如下：

```
// chat history
var history = [];

// when the client emits 'sendchat', this listens and executes
socket.on('sendchat', function (data) {
    // we tell the client to execute 'updatechat' with 2 parameters
    io.sockets.emit('updatechat', socket.username, data);
    // we add the message to the chat history
    var obj = {username:socket.username,text:data};
    history.push(obj);
    history = history.slice(-100);
}); 
```

我做错了什么还是有办法删除额外的括号集或用 jquery 解析它？当我记录历史数据 node.js 发送到浏览器到控制台时，它看起来像这样：

```
[Object { username="Warren2", text="test1"}, Object { username="Warren2", text="test2"}, Object { username="Warren2", text="test3"}, Object { username="Warren2", text="hello"}, Object { username="Warren", text="test"}, Object { username="Warren", text="test again"}, Object { username="Warren", text="test"}, Object { username="Warren", text="Hey"}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:42:55.903

```
$.each(data, function(index,el) {
    // el = object in array
    // access attributes: el.Id, el.Name, etc
}); 
```

在另一个 stackoverflow 帖子中找到它。之前没有看到这个被使用过，但是在解析传入的数据之后

```
var json = $.parseJSON(data); 
```

上面的代码完美运行。