# StackOverflow 问答 11278000-11278999

# mysql - 如何将查询存储在 MySQL 列中，然后使用该查询？

> ID：11278009
> 
> 赞同：2
> 
> 时间：2012-06-30T21:59:41.580
> 
> 标签：mysql, sql, database-design

例如，假设我正在创建一个存储运输站点促销代码的表。我想让表格与代码的验证器匹配促销代码，例如

```
PROMO1: Order must have 3 items
PROMO2: Order subtotal must be greater than $50 
```

我想将查询和/或例程存储在表的列中，并且能够使用内容进行验证，在某种意义上

```
SELECT * FROM Orders 
WHERE Promo.ID = 2 AND Promo.Validation = True 
```

或者类似的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:10:22.620

我不会将查询保存在数据库中，还有更好的可能性。

您必须决定哪个最适合您的需求（根据您的问题，我不清楚）。您可以使用

[意见](http://dev.mysql.com/doc/refman/5.1/en/create-view.html)

或者

[准备好的报表](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)

或者

[存储过程](http://dev.mysql.com/doc/refman/5.0/en/stored-routines-syntax.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:23:58.343

可能有更好的方法来解决这个问题，但你的问题的答案是编写返回你想要的结果的存储过程。在我工作的地方（我讨厌这种设计），它们实际上将应用程序使用的所有查询和 dml 存储在存储过程中。

您还可以使用动态 sql 动态构建查询。对于 MySql，请参阅下面的帖子，这可能对您有所帮助。

[如何在 MySQL 存储过程中使用动态 SQL](https://stackoverflow.com/questions/190776/how-to-have-dynamic-sql-in-mysql-stored-procedure)

否则，您还可以将查询以字符串格式存储在数据库中，并使用 EXECUTE 语句检索它们并执行它们，例如该帖子指出的。

不过，我个人会远离这样的设计。将查询存储在 XML 中并不是一个糟糕的选择，并且可以将您的应用程序编写为可从 XML 扩展和配置，因此您无需更改代码即可添加新的验证逻辑，而只需在 XML 中进行配置.

# php - PHP - 有没有一种安全的方法来执行深度递归？

> ID：11278010
> 
> 赞同：1
> 
> 时间：2012-06-30T21:59:43.467
> 
> 标签：php, recursion, web-crawler

我正在谈论执行大约 5 分钟以上的深度递归，您可能需要爬虫来执行此操作。为了提取页面的url链接和子url链接

PHP 中的深度递归似乎不太现实

例如

```
getInfo("www.example.com");

function getInfo($link){
   $content = file_get_content($link)

   if($con = $content->find('.subCategories',0)){
      echo "go deeper<br>";
      getInfo($con->find('a',0)->href);
   }

   else{
      echo "reached deepest<br>";
   }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-30T22:02:58.550

用递归做这样的事情在任何语言中实际上都是一个坏主意。你不知道爬虫会走多深，所以它可能会导致堆栈溢出。如果不是这样，它仍然会为巨大的堆栈浪费大量内存，因为 PHP 没有尾调用（除非必要，否则不会保留任何堆栈信息）。

将找到的 URL 推送到迭代检查的“to crawl”队列中：

```
$queue = array('www.example.com');
$done = array();
while($queue) {
    $link = array_shift($queue);
    $done[] = $link;
    $content = file_get_contents($link);
    if($con = $content->find('.subCategories', 0)) {
        $sublink = $con->find('a', 0)->href;
        if(!in_array($sublink, $done) && !in_array($sublink, $queue)) {
            $queue[] = $sublink;
        }
    }
} 
```

# php - 用php进行逻辑计算

> ID：11278011
> 
> 赞同：-1
> 
> 时间：2012-06-30T21:59:56.070
> 
> 标签：php, mysql, sql

我有一个关于 php 计算的问题。我正在重组一个基于文本的游戏。游戏现在有两个“本地玩家”。它们由 cron 文件定期插入。插入是：

**//玩家 1 登录 id = 54**

```
mysql_query("INSERT INTO {$game}_ships (ship_name,login_name,shipclass,class_name,class_name_abbr,fighters,max_fighters,max_shields,cargo_bays,mine_rate_metal,mine_rate_fuel,config,size,upgrades,move_turn_cost,point_value,location,login_id
    ) values(   'Three 7','A','8','name','WM','4773','4773','8353','2003','5','45','bs:dt:ot','6','99','19','10',FLOOR(RAND() * 298 + 2),'54')"); 
```

播放器二具有相同的插入，只有播放器 ID 不同。**让我们说 44**。

它们被插入随机位置**FLOOR(RAND() * 298 + 2)**，从 2 到 300 不等。

我想通过从同一系统中的这两个玩家中选择舰船，比较战斗机数量并从数据库中删除最弱的舰船，在游戏中创建一个*AI 。*

到目前为止，我有：

```
mysql_query("SELECT * FROM `{$game}_ships` WHERE `login_id` = 54 AND 54 AND `location` = 234"); 
```

但我在其他方面有一些问题。

任何意见或帮助将不胜感激。

PS：我随意选择了**`location`= 234“ 。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:35:37.007

您可以遍历所有位置并检查每个位置，以查看每个玩家是否至少有一艘船；如果是这样，那么你就摧毁了弱者。看：

```
for ($i = 2; $i < 300; $i++) {
  $p1 = mysql_fetch_array(mysql_query("SELECT count(*) AS 'q' FROM `{$game}_ships` WHERE `login_id` = 54 AND `location` = " . $i));
  $p2 = mysql_fetch_array(mysql_query("SELECT count(*) AS 'q' FROM `{$game}_ships` WHERE `login_id` = 44 AND `location` = " . $i));
  if ($p1['q'] > 0 && $p2['q'] > 0) {
    //Get the first ship; if you want, can select a ship randomly
    $p1s = mysql_fetch_array(mysql_query("SELECT * FROM `{$game}_ships` WHERE `login_id` = 54 AND `location` = ".i));
    $p2s = mysql_fetch_array(mysql_query("SELECT * FROM `{$game}_ships` WHERE `login_id` = 44 AND `location` = ".i));
    //Here you compare $p1s and $p2s, and check which one is stronger. I am using the 'fighters' value, but you can change it if I misunderstood you
    if ($p1s['fighters'] > $ps2['fighters'])
      mysql_query ("DELETE FROM `{$game}_ships` WHERE `ship_name` = " + $ps2['ship_name']);
    else //Not checking for ties here, you can add it too
      mysql_query ("DELETE FROM `{$game}_ships` WHERE `ship_name` = " + $ps1['ship_name']);
  }
} 
```

我不确定我是否完全理解你，但我希望这至少是你想要的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:05:51.203

此查询将为您提供玩家 54 和 44 都有船只的位置列表：

```
SELECT distinct p1s.location
FROM `{$game}_ships` p1s JOIN `{$game}_ships` p2s ON p1s.location=p2s.location
WHERE p1s.login_id=54 AND p2s.login_id=44; 
```

此查询将删除位置 234 中玩家 54 或 44 中最弱的船：

```
DELETE from `{$game}_ships`
WHERE login_id IN (54, 44) AND location=234
ORDER BY fighters LIMIT 1; 
```

# javascript - 如何仅在多个其他功能完成后才执行 Javascript 功能？

> ID：11278018
> 
> 赞同：20
> 
> 时间：2012-06-30T22:01:04.077
> 
> 标签：javascript, node.js, design-patterns, asynchronous

我的具体问题是我需要执行（可能）大量的 Javascript 函数来准备批处理文件之类的东西（每个函数调用都会将一些信息添加到同一个批处理文件中），然后在所有这些调用完成后，执行发送批处理文件的最终函数（例如，将其作为 HTML 响应发送）。我正在为此寻找通用的 Javascript 编程模式。

概括问题：给定 Javascript 函数 funcA()、funcB() 和 funcC()，我想找出排序执行的最佳方法，以便 funcC 仅在 funcA 和 funcB 执行后执行。我知道我可以使用这样的嵌套回调函数：

```
funcA = function() {
    //Does funcA stuff
    funcB();
}
funcB = function() {
    //Does funcB stuff
    funcC();
}

funcA(); 
```

我什至可以通过传入回调参数使这个模式更通用一些，但是，这个解决方案变得非常冗长。

我也熟悉 Javascript 函数链接，其中的解决方案可能如下所示：

```
myObj = {}
myObj.answer = ""
myObj.funcA = function() {
    //Do some work on this.answer
    return this;
}
myObj.funcB = function() {
    //Do some more work on this.answer
    return this;
}
myObj.funcC = function() {
    //Use the value of this.answer now that funcA and funcB have made their modifications
    return this;
}
myObj.funcA().funcB().funcC(); 
```

虽然这个解决方案对我来说似乎更简洁一些，但随着您向计算中添加更多步骤，函数执行链会变得越来越长。

对于我的具体问题，funcA、funcB 等的执行顺序并不重要。因此，在我上面的解决方案中，我在技术上做的工作比需要的要多，因为我将所有功能都按顺序排列。对我来说重要的是 funcC （一些用于发送结果或触发请求的函数）仅在 funcA 和 funcB 完成执行后才被调用。理想情况下，funcC 可以以某种方式侦听所有要完成的中间函数调用，然后执行？我希望学习一个通用的 Javascript 模式来解决这样的问题。

谢谢你的帮助。

另一个想法：也许将共享对象传递给 funcA 和 funcB 并在它们完成执行时标记共享对象，如 sharedThing.funcA = "complete" 或 sharedThing.funcB = "complete" 然后以某种方式？当共享对象达到所有字段都标记为完成的状态时，执行 funcC。我不确定你如何让 funcC 等待这个。

编辑：我应该注意我正在使用服务器端 Javascript（Node.js），我想学习一种模式来解决它，只需使用普通的旧 Javascript（不使用 jQuery 或其他库）。当然，这个问题足够普遍，以至于有一个干净的纯 JavaScript 解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-30T22:20:14.253

如果你想保持简单，你可以使用基于计数器的回调系统。这是一个允许`when(A, B).then(C)`语法的系统草案。（`when`/`then`实际上只是糖，但整个系统也可以说是。）

```
var when = function() {
  var args = arguments;  // the functions to execute first
  return {
    then: function(done) {
      var counter = 0;
      for(var i = 0; i < args.length; i++) {
        // call each function with a function to call on done
        args[i](function() {
          counter++;
          if(counter === args.length) {  // all functions have notified they're done
            done();
          }
        });
      }
    }
  };
}; 
```

用法：

```
when(
  function(done) {
    // do things
    done();
  },
  function(done) {
    // do things
    setTimeout(done, 1000);
  },
  ...
).then(function() {
  // all are done
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T22:55:10.563

如果您不使用任何异步函数并且您的脚本没有破坏执行顺序，那么最简单的解决方案是，如 Pointy 和其他人所述：

```
funcA(); 
funcB();
funcC(); 
```

但是，由于您使用的是 node.js，我相信您将使用异步函数并希望`funcC`在异步 IO 请求完成后执行，因此您必须使用某种计数机制，例如：

```
var call_after_completion = function(callback){
    this._callback = callback;
    this._args = [].slice.call(arguments,1);
    this._queue = {};
    this._count = 0;
    this._run = false;
}

call_after_completion.prototype.add_condition = function(str){
    if(this._queue[str] !== undefined)
        throw new TypeError("Identifier '"+str+"' used twice");
    else if(typeof str !== "String" && str.toString === undefined)
        throw new TypeError("Identifier has to be a string or needs a toString method");

    this._queue[str] = 1;
    this._count++;
    return str;
}

call_after_completion.prototype.remove_condition = function(str){
    if(this._queue[str] === undefined){
        console.log("Removal of condition '"+str+"' has no effect");
        return;
    }
    else if(typeof str !== "String" && str.toString === undefined)
        throw new TypeError("Identifier has to be a string or needs a toString method");

    delete this._queue[str];

    if(--this._count === 0 && this._run === false){
        this._run = true;
        this._callback.apply(null,this._args);
    }
} 
```

您可以通过忽略标识符`str`并仅增加/减少来简化此对象`this._count`，但是此系统可能对调试有用。

为了使用`call_after_completion`，您只需使用`new call_after_completion`所需的函数`func`作为参数和`add_condition`s 创建一个。`func`只有在所有条件都被删除后才会被调用。

### 例子：

```
var foo = function(){console.log("foo");}
var bar = new call_after_completion(foo);
var i;

bar.add_condition("foo:3-Second-Timer");
bar.add_condition("foo:additional function");
bar.add_condition("foo:for-loop-finished");

function additional_stuff(cond){
    console.log("additional things");
    cond.remove_condition("foo:additional function");
}

for(i = 0; i < 1000; ++i){

}
console.log("for loop finished");
bar.remove_condition("foo:for-loop-finished");
additional_stuff(bar);

setTimeout(function(){
    console.log("3 second timeout");
    bar.remove_condition("foo:3-Second-Timer");
},3000); 
```

[**JSFiddle 演示**](http://jsfiddle.net/a7wXy/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T19:18:05.783

如果您不想使用任何帮助程序库，而需要自己编写一些帮助程序，则没有简单的单行解决方案。

如果您想以看起来像在同步情况下一样可读的东西结束，请尝试一些延迟/承诺概念实现（它仍然是纯 JavaScript），例如使用`deferred`包您可能会得到一些简单的东西：

```
// Invoke one after another:
funcA()(funcB)(funcC);

// Invoke funcA and funcB simultaneously and afterwards funcC:
funcA()(funcB())(funcC);

// If want result of both funcA and funcB to be passed to funcC:
deferred(funcA(), funcB())(funcC); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T22:05:16.727

看看 jQuery 的延迟对象。这提供了一种复杂的方法来控制在异步环境中发生的事情。

明显的用例是 AJAX，但不限于此。

资源：

*   [jQuery 文档：延迟对象](http://api.jquery.com/category/deferred-object/)
*   [延迟对象模式的好介绍](http://www.erichynds.com/jquery/using-deferreds-in-jquery/)
*   [非 AJAX 用于 jQuery 的延迟对象](http://www.mitya.co.uk/blog/2012/Apr/Non-AJAX-use-for-jQuerys-deferred-objects-207)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-29T14:59:19.503

我一直在寻找相同的模式。我正在使用查询多个远程数据源的 API。每个 API 都要求我向它们传递一个回调函数。这意味着我不能只触发一组我自己的函数并等待它们返回。相反，我需要一个与一组回调一起工作的解决方案，这些回调可能以任何顺序调用，具体取决于不同数据源的响应速度。

我想出了以下解决方案。JS 在我最熟悉的语言列表中排名靠后，所以这可能不是一个非常 JS 的习惯用法。

```
function getCallbackCreator( number_of_data_callbacks, final_callback ) {

    var all_data = {}

    return function ( data_key ) {

        return function( data_value ) {
            all_data[data_key] = data_value;

            if ( Object.keys(all_data).length == number_of_data_callbacks ) {
                final_callback( all_data );
            }
        }
    }
}

var getCallback = getCallbackCreator( 2, inflatePage );

myGoogleDataFetcher( getCallback( 'google' ) );
myCartoDataFetcher( getCallback( 'cartodb' ) ); 
```

编辑：这个问题被标记为 node.js 但 OP 说，“我正在为此寻找一个通用的 Javascript 编程模式”，所以即使我没有使用 node，我也已经发布了这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-05T15:08:55.403

如今，人们可以这样做：

## 假设我们同时拥有 funcA、funcB 和 funcC：

### 如果希望将 funcA 和 funcB 结果传递给 funcC：

```
var promiseA = new Promise((resolve, reject) => {
  resolve(await funcA());
});
var promiseB = new Promise((resolve, reject) => {
  resolve(await funcB());
});
var promise = Promise.all([ promiseA, promiseB ]).then(results => {
  // results = [result from funcA, result from funcB]
  return funcC(results);
}); 
```

### 如果一个人想要 funcA，然后是 funcB，然后是 funcC：

```
var promise = (
  new Promise(async resolve => resolve( await funcA() ))
).then(result_a => funcB(result_a)).then(result_b => funcC(result_b)); 
```

## 最后：

```
promise.then(result_c => console.log('done.')); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-10-20T16:07:39.123

```
how about:
funcC(funcB(funcA))); 
```

我认为这些问题是因为某些函数运行时间更长，并且当 funcA 或 funcB 没有完成执行时，我们运行 funcC 时可能会出现这种情况。

# javascript - 如何在 qx.ui.table.model.Remote 中为每个项目使用自定义模型类？

> ID：11278022
> 
> 赞同：0
> 
> 时间：2012-06-30T22:01:24.633
> 
> 标签：javascript, qooxdoo

我有一个有 2 个表的应用程序（都使用远程模型，一个表中的数据不与另一个表重叠）：

*   一个有新工作的人
*   一个具有（当前）/停止/暂停的作业

* * *

然后我有一个主查看器，它显示信息并让您对当前选定的工作“采取行动”。

* * *

目前这是这样工作的：

1.  单击新作业表中的作业
2.  在事件中调度的作业对象被发送到主查看器。

* * *

我希望能够实现一个自定义 Job 类，该类将为每个已加载的作业实例化。通过这种方式，我可以完成一些简单的任务，例如：`job.pause()`或`job.start(worker.id);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T08:01:28.557

远程表模型只能处理纯数据，不支持任何类似结构的模型。因此，编写这些模型类并将它们连接到您用于工作数据的唯一标识符将由您负责。

# svn - 颠覆：当修订号是连续的时，为什么“混合修订”？

> ID：11278023
> 
> 赞同：3
> 
> 时间：2012-06-30T22:01:46.053
> 
> 标签：svn

一个例子：假设`svn update`我在修订版本 10 之后。如果我现在添加一个文件并执行提交，svnversion 将报告我处于混合修订状态；即10:11。但由于这些数字是按顺序排列的，显然在这两者之间没有任何其他提交。不能 subversion 从中推断出我的版本是最新的 (=HEAD) 所以我不需要运行另一个 svn update 来删除这个混合修订状态？

我意识到这没什么大不了的。我只是想知道我是否遗漏了一些特殊情况，上述推理可能不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T08:18:21.843

如果我正确理解了您的问题，我可以告诉您，您的工作副本几乎总是会有混合修订。这是因为不同的文件已在不同的修订版中提交并在那时发生了更改。您是否注意到某些文件（例如）显示修订版 10 和其他 25，但您仍处于 HEAD 修订版中。这是因为您的工作区包含文件和修订的附加元数据。

一般来说，这根本不应该是一个问题，就我而言，它是 SVN 工作流程的一部分。我记得这在 SVN 文档的某处有解释，但我现在似乎找不到它。如果我这样做，我会相应地编辑我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T06:49:21.697

Subversion 声称您修改的文件是版本 11，实际上我有点惊讶，因为它们可能不是。如果其他人在您之前提交了版本 11，那么您的文件最终将是版本 12 或更高版本。

我猜原因是您的本地颠覆不能声称您的添加文件的版本是完整的版本 11，因为它还不确定。

# mongodb - MongoDB C# 驱动程序 database.GetCollection 和魔术字符串

> ID：11278031
> 
> 赞同：4
> 
> 时间：2012-06-30T22:04:20.813
> 
> 标签：mongodb, mongodb-.net-driver

刚刚进入 NoSQL 的东西，如果这是一个简单的问题，请原谅我。我正在尝试使用通用存储库来实现存储库类型模式，以进行更常见的操作。

我遇到的一件事就是扼杀这个想法是，为了获得您计划使用的集合，您必须为集合的名称传递一个字符串值。

```
var collection = database.GetCollection<Entity>("entities"); 
```

这意味着我必须硬编码我的集合名称或在某处编写字典以充当查找，以便我可以将对象类型映射到集合名称。

其他人是如何处理这个问题的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-12T07:24:03.860

我写了一个类来管理数据库事务

首先，您需要所有实体的基类：

```
public abstract class Entity
{
    public ObjectId Id { set; get; }
} 
```

然后是一个静态类来管理所有：

```
public static class MongoDB
{
    private static string connectionString = "mongodb://localhost";
    public static string DatabaseName { get { return "test"; } }

    private static MongoServer _server;
    private static MongoDatabase _database;

    public static MongoServer Server
    {
        get
        {
            if (_server == null)
            {
                var client = new MongoClient(connectionString);
                _server = client.GetServer();
            }

            return _server;
        }
    }

    public static MongoDatabase DB
    {
        get
        {
            if(_database == null)
                _database = Server.GetDatabase(MongoDB.DatabaseName);

            return _database;
        }
    }

    public static MongoCollection<T> GetCollection<T>() where T : Entity
    {
        return DB.GetCollection<T>(typeof(T).FullName);
    }

    public static List<T> GetEntityList<T>() where T : Entity
    {
        var collection = MongoDB.DB.GetCollection<T>(typeof(T).FullName);
        return collection.FindAll().ToList<T>();
    }

    public static void InsertEntity<T>(T entity) where T : Entity
    {
        GetCollection<T>().Save(entity);
    }
} 
```

然后像这样使用它：

```
 public class SomeEntity : Entity { public string Name {set;get;} }

 MongoDB.InsertEntity<SomeEntity>(new SomeEntity(){ Name = "ashkan" });

 List<SomeEntity> someEntities = MongoDB.GetEntityList<SomeEntity>(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-30T23:13:55.697

你可以做的是“半硬编码”。您可以将集合的名称放在类名中并引用它：

```
public class Entity {
  public static readonly string Name = "entities";
}

var collection = database.GetCollection<Entity>(Entity.Name); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-24T09:31:34.167

我终于找到了一种对我非常有用的方法，因为我所有的 mongo 集合都遵循驼峰式下划线命名约定，所以我做了一个简单的字符串扩展来将 POCO 命名约定转换为我的 mongo 约定。

```
private readonly IMongoDatabase _db;
public IMongoCollection<TCollection> GetCollection<TCollection>() =>
        _db.GetCollection<TCollection>(typeof(TCollection).ToString().MongifyToCollection()); 
```

此方法位于使用依赖注入处理 mongo 的类中，它还包装了默认的 GetCollection 以使其更加面向对象

```
public class MongoContext : IMongoContext
{
    private readonly IMongoDatabase _db;

    public MongoContext()
    {
        var connectionString = MongoUrl.Create(ConfigurationManager.ConnectionStrings["mongo"].ConnectionString);
        var client = new MongoClient(connectionString);
        _db = client.GetDatabase(connectionString.DatabaseName);
        RegisterConventions();
    }

    public IMongoCollection<TCollection> GetCollection<TCollection>() =>
        _db.GetCollection<TCollection>(typeof(TCollection).Name.MongifyToCollection());
... 
```

和扩展：

```
// It may require some improvements, but enough simple for my needs at the moment
public static string MongifyToCollection(this string source)
    {
        var result = source.Mongify().Pluralize(); //simple extension to replace upper letters to lower, etc

        return result;
    } 
```

# android - 应用程序崩溃后的 Android 错误日志

> ID：11278035
> 
> 赞同：1
> 
> 时间：2012-06-30T22:04:36.977
> 
> 标签：android

我从客户端收到**>>> [THIS](http://pastebin.com/HFZKi4bJ) <<<**错误日志。我将应用名称替换为：APP_NAME。**你能帮我确定这是否是我的应用程序的错吗？**在我看来，我的应用程序之外出现了问题并导致服务出错：

> 06-30 15:54:51.059 W/ActivityManager（427）：计划重启崩溃的服务 com..android/.services.periodic.GpsLoggerService

但我不确定这是否是错误消息的真正原因。**是吗？**

日志由**外部工具**获取和发送。**日志收集器**。所以它不仅仅是来自我的应用程序的日志，而是来自整个系统的日志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:37:10.487

看看 pastebin，我可以肯定地说，你的应用似乎已经 b0rk3d 了。查看第 457-465 行，它显示了

java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:693)
06-30 15:54:51.049 D/Process (11724): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:690)
06-30 15:54: 51.049 D/进程（11724）：dalvik.system.NativeStart.main（本机方法）

那里的线程中发生了一些事情，也许是线程管理处理不当，同样在第 804 行，您的广播接收器可能收到了一些意图，这导致您的应用程序整体崩溃。

我知道它没有多大帮助，但希望它可以帮助您朝着正确的方向前进。

# php - 定位多维数组中的键

> ID：11278036
> 
> 赞同：0
> 
> 时间：2012-06-30T22:04:40.190
> 
> 标签：php

我有一个像这样的数组。

```
Array
(
[162 D Dr.] => Array
    (
        [smi_discover] => 0
        [smi_totalmonthccsales] => 12568
        [smi_amex] => 0
        [smi_visamc] => 12568
        [smi_ebt] => 0
        [smi_includeindeal] => 0
        [smi_debit] => 0
        [smi_batches] => 7
    )
 [16ee22 D Dr.] => Array
    (
        [smi_discover] => 0
        [smi_totalmonthccsales] => 125368
        [smi_amex] => 0
        [smi_visamc] => 12568
        [smi_ebt] => 0
        [smi_includeindeal] => 0
        [smi_debit] => 0
        [smi_batches] => 7
    )
) 
```

这把钥匙 [162 D Dr.] 可以是任何东西。[16e2 D Dree]，[332 D44 Drdds]。

我如何循环遍历并添加 smi_totalmonthccsales 并将其添加到父数组中，所以我最终会得到这样的结果

```
['total'] = sum of smi_totalmonthccsales in both address arrays
[162 D Dr.] => Array
    (
        [smi_discover] => 0
        [smi_totalmonthccsales] => 12568
        [smi_amex] => 0
        [smi_visamc] => 12568
        [smi_ebt] => 0
        [smi_includeindeal] => 0
        [smi_debit] => 0
        [smi_batches] => 7
    ) 
```

我试过了

```
foreach($newnewArr as $key) {
    if(isset($key['smi_totalmonthccsales']) && isset($key)){
        $ccArray[$key]['total'] +=$key['smi_totalmonthccsales'];
    } else {
        $ccArray[$key]['total'] = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:08:46.443

之后就设置好了。

```
$total = 0;

foreach($arr as $key => $value) {
    $total += $value['smi_totalmonthccsales'];
}

$arr['total'] = $total; 
```

你想要一个运行总数？好的...

```
$total = 0;

foreach($arr as &$value) {
    $total += $value['smi_totalmonthccsales'];
    $value['total'] = $total;
} 
```

# android - File Observer 在调试模式下工作，但没有调试器就不会触发事件

> ID：11278037
> 
> 赞同：1
> 
> 时间：2012-06-30T22:04:55.940
> 
> 标签：android, debugging, fileobserver

我有一个作为递归文件观察器的类。它的作用是为父目录中的所有目录创建一个文件观察器，然后开始观察它们。我知道它可以工作，因为在调试模式下，它会在 logcat 中记录所有文件更改。但是，当我断开与调试器的连接并重新启动应用程序时，它会生成 Started 和 Set Up 日志，但它不会捕获任何文件更改。垃圾收集器是否有可能因为调试器不在现场观看而正在清理？我不认为这是真的，因为运行它的 Intentservice 永远不会消亡。

**编辑：**我将意图服务更改为不间断服务，同样的事情仍在发生。所以服务不会被破坏。

你怎么看？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T22:42:20.583

事实证明，即使调试器将 Intent 服务列为仍然存在，但实际上并非如此，并且文件观察器正在最终确定。所以我写了一个线程来欺骗垃圾收集器让对象存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T14:05:54.077

我已经尝试过服务和另一个线程。但没有一个奏效。我认为问题是 FileObserver 是垃圾收集。

警告：如果 FileObserver 被垃圾回收，它将停止发送事件。为确保您继续接收事件，您必须保留对其他活动对象的 FileObserver 实例的引用

[http://developer.android.com/reference/android/os/FileObserver.html](http://developer.android.com/reference/android/os/FileObserver.html)

# android - Android GCC Makefile，想要在静态库中构建共享库和链接，没有“ndk-build”

> ID：11278039
> 
> 赞同：0
> 
> 时间：2012-06-30T22:05:24.147
> 
> 标签：android, gcc, makefile, shared

我有一些 android 的经验，但对 GCC Makefile 几乎一无所知。这是我需要的，在mac osx或linux上工作，使用android ndk工具链，构建一个android共享库.so（一个jni lib），链接到一个预建的静态库（已经为android构建）。在静态库中，我需要 logcat 函数和 C 函数，例如 sprintf。所以在这个过程中没有“ndk-build”。我之所以要这样做，是因为在静态库中链接的时候，需要一个特殊的链接器来代替标准的arm-eabi-gcc，而标准的链接器后面会回滚。

我知道我需要设置以下环境变量，例如：

```
ANDROID_NDK, 
PATH=$PATH:"$ANDROID_NDK/build/prebuilt/darwin-x86/toolchain/arm-eabi-4.4.0/bin"
MACHINE=armv7l
SYSTEM=android
ARCH=arm
CROSS_COMPILE="arm-eabi-"
ANDROID_DEV="$ANDROID_NDK/platforms/android-8/arch-arm/usr" 
HOSTCC=gcc 
```

我只需要一个示例 Makefile，这样我就可以运行“make”来通过链接 .a 和其他必要的 android 和 c 库来构建 .so。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T00:10:59.863

尝试运行 ndk_build V=1 并以详细模式记录它发出的命令。然后向您的自定义链接器发出类似的命令。

请注意，命令可能会因不同的 ndk 版本而改变。

# sql - 在 SQLClient 中访问 Hive 表，但不能从 Putty 访问

> ID：11278040
> 
> 赞同：1
> 
> 时间：2012-06-30T22:05:43.600
> 
> 标签：sql, hadoop, mapreduce, hive, putty

我是 Hive、MapReduce 和 Hadoop 的新手。我正在使用 Putty 连接到 hive 表并访问表中的记录。所以我所做的是 - 我打开了 Putty 并在我输入的主机名中 -`vip.name.com`然后我单击`Open`。然后我输入了我的用户名和密码，然后输入了几个命令来访问 Hive sql。以下是我所做的清单

```
$ bash
bash-3.00$ hive
Hive history file=/tmp/rkost/hive_job_log_rkost_201207010451_1212680168.txt
hive> set mapred.job.queue.name=mdhi-technology;
hive> select * from table LIMIT 1; 
```

所以我的问题是——

**有没有其他方法可以在任何 Sql 客户端（如 Sql Developer 或 Squirel SQL 客户端）中执行相同的操作，而不是从命令提示符处执行。如果它在那里，那么考虑到我`vip.name.com`从 Putty 登录的示例，执行此操作的分步过程是什么。**

如果我需要通过 Windows 机器中的 JDBC 程序来做同样的事情，那么我该怎么做。使用 JDBC 程序意味着我如何访问 Hive 表并获取结果。据我所知，我可以如何使用 oracle 表来做到这一点。但我唯一的困惑是，因为我使用这个主机名`vip.name.com`登录到 Putty。我希望这个问题很清楚。任何建议将不胜感激。

**简而言之，我的问题是——我可以在任何 SQLClient 中做同样的事情而不是从 Putty 登录吗？**

更新-

我试着按照马克建议我的方式去做。但我总是得到-`Hive: Could not establish connection to vip.host.com:10000/default: java.net.ConnectionException: Connection timed out: connect`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T16:19:31.697

你用 Putty 做什么是通过 SSH 连接到安装和设置 Hive 的机器。然后，您将从 Hive 命令行发出 Hive 查询。这是发出 Hive 查询的一种方式。还有其他不需要 SSH 的方法，您可能需要的一种方法是通过 JDBC 连接。

[这](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/UsingEMR_Hive.html#HiveJDBCDriver)是一篇文章，描述了如何使用 SQuirreL 通过 JDBC 连接到 Amazon EMR 集群上的 Hive 安装。这篇文章可能看起来是亚马逊特有的，但事实并非如此。只要您在集群的一个节点上运行 Hive 服务器，并且没有防火墙阻碍客户端计算机和一台运行 Hive 之间的连接，您就应该能够连接。

您可能需要记住与上述链接相关的几件事：

*   您可以忽略步骤 3，它要求您创建 SSH 隧道，除非您使用 EMR。
*   您在连接 URI 中输入的端口可能与您的情况不同。将 localhost 替换为运行 Hive 的机器的完全限定域名。要找出 Hive 服务器正在侦听的端口，您可以查看日志目录中存在的 Hive 服务器保姆日志文件（其位置取决于您的安装）或运行一个简单的`netstat -a`命令。我相信 10000 是默认端口号，因此直接尝试 10000 可能有意义。

# java - 如果你想用 Java 开发，OpenCV 和 ImageJ 选择哪一个？

> ID：11278042
> 
> 赞同：3
> 
> 时间：2012-06-30T22:05:56.083
> 
> 标签：java, opencv, imagej

我想使用库来检测图像中的对象，例如椅子、床……您会推荐哪个库`OpenCV`或`ImageJ`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T10:17:46.850

ImageJ 似乎只适用于图像处理，而不是实际识别任何东西。

# jquery - 如何使用选择器调用此 JQuery 插件？

> ID：11278045
> 
> 赞同：0
> 
> 时间：2012-06-30T22:07:17.253
> 
> 标签：jquery, jquery-plugins

我找到了一个显示弹出气球的简洁插件。似乎它打算通过悬停或单击控件来触发。我可以让这个插件像这样工作，但我希望能够在我的代码中执行一些逻辑之后手动调用它。

这个插件的网址是：http: [//file.urin.take-uma.net/jquery.balloon.js-Demo.html](http://file.urin.take-uma.net/jquery.balloon.js-Demo.html)

文档似乎非常有限，所有示例都证明了它是使用选择器和悬停/单击的。

有没有办法在我的代码中执行一些逻辑后有条件地调用这个插件？抱歉...我对 JQuery/Javascript 很陌生。

下面是演示如何展示它的用法：

(1) 在 jQuery 之后下载并加载这个插件的 javascript 文件。

```
<script type="text/javascript" src="js/jquery.balloon.js"></script> 
```

(2) 在jQuery的文档就绪事件中调用$().balloon(options)。

```
$(function() {
    $('selectors').balloon(options);
}); 

$('.sample7-2').balloon({
    tipSize: 0, offsetY: -100, offsetX: -100,
    showDuration: 0, hideDuration: 0
}); 
```

我做了几次尝试都没有成功

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:18:04.713

快速查看他们的代码，有一个函数 showBalloon 当你想要气球出现时你应该调用它。他们甚至向你展示了一个例子

```
$(function() {
  $('#knight').showBalloon({ ... }).toggle(
    function(){ $(this).hideBalloon(); },
    function(){ $(this).showBalloon(); }
 ); 
```

});

# php - 类变量的范围解析运算符

> ID：11278047
> 
> 赞同：4
> 
> 时间：2012-06-30T22:07:24.793
> 
> 标签：php, oop

我很好奇为什么在类变量上使用范围解析运算符会导致致命的 php 错误，以及是否有解决方法。

例如：

```
<?php
class StaticTest
{
    public static function output()
    {
        echo "Output called<br />";
    }
}
Class Test
{
    public $reference;

    public function __construct()
    {
        $this -> reference = new StaticTest;
    }

}

$static_test = new StaticTest;
$static_test::output(); //works as intended

$test = new Test;
$test -> reference::output(); //Unexpcted T_PAAMAYIM_NEKUDOTAYIM

$direct_reference = $test -> reference;
$direct_reference::output(); //works, closest solution i have found, but requires the extra line of code / variable
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:25:16.263

如果您唯一关心的是代码行数和额外变量，那么您可以在一行中执行此操作，而无需创建任何变量：

```
call_user_func(array(get_class($test->reference), 'output')); 
```

我相信，这相当于：

```
$direct_reference = $test->reference;
$direct_reference::output(); 
```

# python - 带有python返回错误的Google URL Shortener API

> ID：11278049
> 
> 赞同：1
> 
> 时间：2012-06-30T22:08:45.113
> 
> 标签：python

我正在尝试在我的 python 代码中调用 Google URL Shortener API：

```
def shorternUrl():
        API_KEY = "AIzaSyCvhcU63u5OTnUsdYaCFtDkcutNm6lIEpw"
        apiUrl = 'https://www.googleapis.com/urlshortener/v1/url'
        longUrl = "http://www.cnn.com"
        headers = {"Content-type": "application/json"}
        data = {"longUrl": longUrl}
        h = httplib2.Http('.cache')
        try:
            headers, response = h.request(apiUrl, "POST", urllib.urlencode(data), headers)
            print response

        except Exception, e:
            print "unexpected error %s" % e 
```

但我不断收到此错误：

```
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "parseError",
    "message": "Parse Error"
   }
  ],
  "code": 400,
  "message": "Parse Error"
 }
} 
```

我没有使用适用于 Python 的 Google API。我哪里错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:12:05.573

You need to send JSON in a POST, not URL encoded data:

```
import json

# Rest of your code

headers, response = h.request(apiUrl, "POST", json.dumps(data), headers) 
```

# android - Is there a more efficient way to present lots of data than having it all in separate files and activities?

> ID：11278058
> 
> 赞同：0
> 
> 时间：2012-06-30T22:09:13.930
> 
> 标签：android, android-layout

I am making an app in android. It is a reference guide with about 400 items in it. At the minute we have a layout and activity for each item. Is there a more efficient way of presenting this huge amount of data? Each item has different properties to show. There is a list with all the 400 items and each one links to its own activity and layout. Each layout has two scroll views to present the info

# python - Undefined variable from import when using protocol buffers in PyDev

> ID：11278062
> 
> 赞同：6
> 
> 时间：2012-06-30T22:09:35.753
> 
> 标签：python, eclipse, pydev, protocol-buffers

I've got a PyDev project that uses protocol buffers. The protocol buffer files are located in a zip file generated by the protoc compiler. Everything works when I run the program, however PyDev reports "Undefined variable from import" for every enumeration constant. So for example:

```
import model_pb2

value = model_pb2.Expression(type = model_pb2.Expression.PARAMETER) 
```

It reports the enum constant "PARAMETER" as being an undefined variable. There are several dozen similar errors in my program, and I'd like to fix them "properly" (i.e. not simply suppressing the warning.)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T20:31:28.797

我发现使用 for builtins as 可以工作，但前提是所有 proto 文件都位于一个单独的外部库中（请参阅[http://pydev.org/manual_101_project_conf2.html](http://pydev.org/manual_101_project_conf2.html)）。

这应该有效：

1.  将包括 model_pb2.py 在内的编译后的 proto 文件移动（或解压缩）到 pydev 项目之外的目录中。
2.  将一个空的 __init__.py 文件添加到与 model_pb2.py 相同的目录中，以确保它可以作为库导入。
3.  在 Eclipse 中，转到 Windows -> Preferences -> pydev -> Interpreter
4.  将带有 model_pb2.py 的目录添加到库中。
5.  将 model_pb2 添加到强制构建。

如果您不沉迷于自动完成功能，则可以使用 ctrl+1 来忽略这些错误[，如本答案中所述](https://stackoverflow.com/questions/2112715/how-do-i-fix-pydev-undefined-variable-from-import-errors)。这是用 Eclipse Kepler 和 pydev 2.8 测试的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-07T23:04:28.883

我在 protobuf 2.6.1 和 PyDev 4.5.5 中遇到了这个问题。我尝试了上面的建议，但对我的情况都没有帮助。使用 protobuf 枚举时最终摆脱“未定义变量”错误的方法很简单：

**在实例化的 protobuf 对象上而不是在 protobuf 模块上访问枚举。**

我不确定这是否可以应用于 OP 的用例，但在我的用例中，它很简单：

```
from myprotobuf_module import SomeProtobufMessage

some_protobuf_object = SomeProtobufMessage()
some_enum = some_protobuf_object.SOME_ENUM 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T10:42:14.457

您是否尝试将“model_pb2”添加到您的强制内置？有关详细信息，请参见：[http](http://pydev.org/manual_101_project_conf2.html) ://pydev.org/manual_101_project_conf2.html 。

# c++ - 哪种图像处理技术？

> ID：11278063
> 
> 赞同：0
> 
> 时间：2012-06-30T22:09:58.923
> 
> 标签：c++, image-processing, opencv, computer-vision

有没有一种图像处理算法可以填补图像中的这些空白？间隙始终是线条，并且在所有情况下都会跨越图像的宽度。这些线条大多是一个像素厚。

![红线表示间隙](../Images/32b8b636de1885eaaba39feed79adaac.png).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:24:17.100

填补这些空白的难易程度取决于您是否愿意容忍图像其他部分的一些伪影。最简单的解决方案通常是使用形态学运算。

如果您想要一种快速而肮脏的方法，请考虑使用`cvMorphologyEx`开放操作，使用 1 像素宽且高到足以跨越您想要覆盖的间隙的矩形结构元素。

如果这引入了不需要的伪影，一些额外的背景信息会有所帮助。例如，最大垂直间隙是多少？不需要的黑线总是完全水平的，还是垂直的？他们曾经彼此亲近吗？您可以在图像的其他部分承受哪些类型的伪影？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T22:26:55.250

通过对类似于以下的矩阵进行与运算来完成图像膨胀：111 000 111 应该可以消除该问题。如果与图像的所有 AND 为 TRUE，则结果也为 TRUE（1/WHITE），否则为 FALSE（0/BLACK）。

# python - 使用 shutil.copyfile 我得到一个 Python IOError: [Errno 13] Permission denied:

> ID：11278066
> 
> 赞同：22
> 
> 时间：2012-06-30T22:10:51.600
> 
> 标签：python, permission-denied, shutil

我有一些使用 shutil.copyfile 的 python 代码：

```
import os
import shutil

src='C:\Documents and Settings\user\Desktop\FilesPy'
des='C:\Documents and Settings\user\Desktop\\tryPy\Output'

x=os.listdir(src)
a=os.path.join(src,x[1])

shutil.copyfile(a,des)
print a 
```

它给了我一个错误：

```
IOError: [Errno 13] Permission denied: 'C:\\Documents and Settings\\user\\Desktop\\tryPy\\Output' 
```

为什么我没有复制文件的权限？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-30T22:22:05.463

从以下[文档](http://docs.python.org/library/shutil.html#shutil.copyfile)：`shutil.copyfile`

> 将名为 src 的文件的内容（无元数据）复制到名为 dst 的文件中。dst 必须是完整的目标文件名；查看 shutil.copy() 以获取接受目标目录路径的副本。如果 src 和 dst 是相同的文件，则会引发错误。目标位置必须是可写的；否则，将引发 IOError 异常。如果 dst 已经存在，它将被替换。无法使用此功能复制字符或块设备和管道等特殊文件。src 和 dst 是以字符串形式给出的路径名。

所以我猜你需要使用[`shutil.copy`](http://docs.python.org/library/shutil.html#shutil.copy)或添加文件名`des`：

```
des = os.path.join(des, x[1]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-17T14:47:55.630

如果可以的话，我建议你宁愿使用 shutil.copyfile 而不是 shutil.copy。

使用 shutil.copyfile，您必须考虑写入权限等元数据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-04-02T07:14:09.517

我在这里尝试了所有的东西，但我的代码的问题是关于目标文件夹的权限。我创建了自己的函数来创建目录，

```
def mkdirs(newdir,mode=777):
    try:
        os.makedirs(newdir, mode)
    except OSError as err:
        return err 
```

而不是 777，后来我使用了八进制值 '0o777'，后来使用`shutil.copyfile(target_file,dest_file)`它并且它起作用了！

希望这对首先创建目录然后将文件复制到其中的人有所帮助。

# android - 想要Actionbar，但不是holo主题皮肤

> ID：11278067
> 
> 赞同：1
> 
> 时间：2012-06-30T22:10:58.253
> 
> 标签：android, android-layout, themes, actionbarsherlock

`Theme.Holo`不适合我目前的背景，`Theme.Black`看起来好多了。是否可以仅使用`Theme.Holo`标题（操作栏）并具有正常的黑色布局？我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T16:20:18.250

仅`android:theme="@style/Theme.Sherlock"`用于您的应用程序。

这就是它的外观：

![默认夏洛克主题](../Images/ac1f1d70fb423ecedc8100a8e08b6d68.png)

# python - 如何使用 unicode_literals 引用 pygame 颜色？

> ID：11278068
> 
> 赞同：1
> 
> 时间：2012-06-30T22:11:12.183
> 
> 标签：python, unicode, pygame

使用时使用 pygame.Color 名称的正确方法是什么`unicode_literals`？

```
Python 2.7.3 (v2.7.3:70274d53c1dd, Apr  9 2012, 20:52:43) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pygame
>>> pygame.ver
'1.9.2pre'
>>> pygame.Color('red')
(255, 0, 0, 255)
>>> from __future__ import unicode_literals
>>> pygame.Color('red')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid argument 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:27:45.290

```
>>> type('red')
str

>>> from __future__ import unicode_literals

>>> type('red')
unicode

>>> type(str('red'))
str

>>> import pygame

>>> pygame.ver
'1.9.1release'

>>> pygame.Color(str('red'))
(255, 0, 0, 255) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T03:03:34.737

启用后`unicode_literals`，Python 2 解释字符串文字的方式与 Python 3 相同。也就是说，`'red'`它是一个 Unicode 字符串（`unicode`在 Python 2 中，在 3 中调用） ，`str`并且`b'red'`是一个字节字符串（在 Python 2 中，在 Python 3 中调用）。`str``bytes``bytes`

由于`pygame.Color`只接受一个字节串，传递它`b'red'`：

```
>>> 从 __future__ 导入 unicode_literals
>>> pygame.Color('红色')
回溯（最近一次通话最后）：
  文件“”，第 1 行，在
ValueError：无效的参数
>>> pygame.Color(b'red')
(255, 0, 0, 255)

```

# ruby-on-rails - 如何改进 Rails 日志？

> ID：11278071
> 
> 赞同：0
> 
> 时间：2012-06-30T22:12:01.150
> 
> 标签：ruby-on-rails, logging

即使请求量适中，3.2.x 中的 rails log 也会盲目地写入日志，最终导致多个请求相互重叠，使得解析和分析变得非常困难。

有什么技术可以解决这个问题？我的目标是分析基本性能和异常以及其他调试。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:18:35.487

见：[http ://railscasts.com/episodes/318-upgrading-to-rails-3-2](http://railscasts.com/episodes/318-upgrading-to-rails-3-2)

```
config.log_tags = [:uuid, :remote_ip] 
```

将为每个请求提供一个唯一的 ID，您可以对其进行解析和分组

但如果你真的想要性能和异常通知

*   [新遗物： http](http://newrelic.com/) ://newrelic.com/
*   airbrake：[https](https://airbrake.io/account/new?dev=true) ://airbrake.io/account/new?dev=true （注意：免费开发“注册”链接很适合开始使用 - 在底部找到它）

# python - How do I display Django model choice list in a template?

> ID：11278074
> 
> 赞同：0
> 
> 时间：2012-06-30T22:12:40.730
> 
> 标签：python, django

I've looked everywhere and can't seem to find the answer for this problem I'm having and was wondering if anyone would be kind enough to help.

I am trying to display the choices itself (Q_TYPE) as a list of radio buttons in a template. I've tried "get_FOO_display", but it seems that it only displays something if attached to another value.

Below is my best attempt out of many and what I am looking for. If anyone could help me with the problem I would really appreciate it. Even the keywords I should be looking for I would appreciate. Thanks!

Models.py

```
Q_TYPE = (
('T', 'Text Question'),
('M', 'Multiple Choice'),
)

class Question(models.Model):
   form = models.ForeignKey(Form)
   textquestion = models.CharField(max_length=200, null=True, blank=True)
   questiontype = models.CharField(('question type'), max_length=1, choices=Q_TYPE)

   def __unicode__(self):
       return self.textquestion 
```

Template

```
{% for questiontype in q_type %}
    {{ questiontype }} <input type="radio" name="{{ questiontype }}" id="" value="" /><br />
{% endfor %} 
```

What I'm trying to get (< > is a radio button)

```
 < > Text Question
 < > Multiple Choice 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:26:59.257

您可以将 in 传递`Q_TYPE`到您的模板上下文中，然后执行以下操作：

### 视图.py

```
context = {'Q_TYPE': Q_TYPE}
return render(request, 'mytemplate.html', context) 
```

### 模板

```
{% for id, value in Q_TYPE %}
    {{ value }} <input type="radio" name="{{ id }}" id="" value="" /><br />
{% endfor %} 
```

或对循环变量使用索引

```
{% for item in Q_TYPE %}
    {{ item.1 }} <input type="radio" name="{{ item.0 }}" id="" value="" /><br />
{% endfor %} 
```

但是，正如我在评论中提到的，您应该尝试使用内置`ModelForm`系统。

# javascript - Loading an external .htm with javascript into a div

> ID：11278078
> 
> 赞同：0
> 
> 时间：2012-06-30T22:13:11.263
> 
> 标签：javascript, jquery, ajax

I am trying to load an external .htm file to a div on my main page, and I have used the following code:

```
<a href="#file.htm" onclick="$('#content').load('file.htm')">Link</a> 
```

It works in firefox, but not in chrome and IE. Can anyone help me?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:19:29.370

为什么不

**html**

```
<a href="file.htm" class="ajax">Link</a> 
```

并添加一个**脚本**

```
<script type="text/javascript">
$(function(){
    $('.ajax').click(function(e){
        e.preventDefault();
        $('#content').load( this.href );
    });
});
</script> 
```

这样，您可以`ajax`为该区域内加载的所有链接设置一个类，`#content`并处理所有这些链接。

* * *

可能是它不起作用的原因是您单击得太快并且尚未加载 jquery 吗？

# c++ - 使用 scanf 进行输入过滤

> ID：11278080
> 
> 赞同：0
> 
> 时间：2012-06-30T22:14:04.063
> 
> 标签：c++, c, scanf

我想过滤输入。我不知道什么是最好的方法。我希望阅读以 alpha-bates 开头的单词。例如，如果输入是：

```
This is 1 EXAMPLE1 input. 
```

字符串应该是这样的：

```
This is  EXAMPLE1 input 
```

像这样过滤输入的最简单方法是什么？

我尝试使用`"%[a-zA-Z]s"`，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:30:31.937

您的扫描字符串`"%[a-zA-Z]s"`可能不希望您认为它是。去掉那个尾随`s`。

`"%[a-zA-Z]"`将扫描一个完全由大小写字母组成的字符串。所以数字会打折。但是，您希望扫描以小写或大写字母开头的字母数字字符串。`scanf`不提供以这种方式查找字符串的工具。相反，您可以使用 扫描字母数字字符串`"%[a-zA-Z0-9]"`，如果字符串的第一个字符是数字，则删除扫描的输入。

`scanf`由于各种原因，使用起来很棘手。该字符串可能比您预期的要长，并导致缓冲区溢出。如果输入不是您期望的格式，则`scanf`可能无法超越意外输入。通常将输入无条件地读入缓冲区并解析缓冲区会更可靠。例如：

```
const char *wants
    = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
std::string word;
while (std::cin >> word) {
    if (!isalpha(word[0])) continue;
    std::string::size_type p = word.find_first_not_of(wants);
    word = word.substr(0, p);
    //... do something with word
} 
```

# c# - 将单词（字符串）转换为 Int

> ID：11278081
> 
> 赞同：11
> 
> 时间：2012-06-30T22:14:13.500
> 
> 标签：c#

我确信这已经完成了一百次，但我希望有一个非常简单的方法来完成这个。我想将单词更改为int。

像下面的例子

```
一 = 1
二 = 2
三 = 3

```

所以基本上，如果我有字符串“One”，它会被转换为 1，即使我可以取回字符串“1”，我也可以转换它。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-30T23:20:36.583

这样做是为了好玩...可能有很多边缘情况会失败...

```
private static Dictionary<string,long> numberTable=
    new Dictionary<string,long>
        {{"zero",0},{"one",1},{"two",2},{"three",3},{"four",4},
        {"five",5},{"six",6},{"seven",7},{"eight",8},{"nine",9},
        {"ten",10},{"eleven",11},{"twelve",12},{"thirteen",13},
        {"fourteen",14},{"fifteen",15},{"sixteen",16},
        {"seventeen",17},{"eighteen",18},{"nineteen",19},{"twenty",20},
        {"thirty",30},{"forty",40},{"fifty",50},{"sixty",60},
        {"seventy",70},{"eighty",80},{"ninety",90},{"hundred",100},
        {"thousand",1000},{"million",1000000},{"billion",1000000000},
        {"trillion",1000000000000},{"quadrillion",1000000000000000},
        {"quintillion",1000000000000000000}};
public static long ToLong(string numberString)
{
    var numbers = Regex.Matches(numberString, @"\w+").Cast<Match>()
         .Select(m => m.Value.ToLowerInvariant())
         .Where(v => numberTable.ContainsKey(v))
         .Select(v => numberTable[v]);
    long acc = 0,total = 0L;
    foreach(var n in numbers)
    {
        if(n >= 1000)
        {
            total += (acc * n);
            acc = 0;
        }
        else if(n >= 100){
            acc *= n;
        }
        else acc += n;          
    }
    return (total + acc)  * ( numberString.StartsWith("minus",
          StringComparison.InvariantCultureIgnoreCase) ? -1 : 1);
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-30T22:49:54.287

这是一种方法。如果您需要更广泛的范围，它很容易扩展；只需使用 a `long`， a `ulong`，甚至 a `BigInt`，然后将更多项目添加到`modifiers`字典中。

```
static int ParseEnglish(string number) {
    string[] words = number.ToLower().Split(new char[] {' ', '-', ','}, StringSplitOptions.RemoveEmptyEntries);
    string[] ones = {"one", "two", "three", "four", "five", "six", "seven", "eight", "nine"};
    string[] teens = {"eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"};
    string[] tens = {"ten", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"};
    Dictionary<string, int> modifiers = new Dictionary<string, int>() {
        {"billion", 1000000000},
        {"million", 1000000},
        {"thousand", 1000},
        {"hundred", 100}
    };

    if(number == "eleventy billion")
        return int.MaxValue; // 110,000,000,000 is out of range for an int!

    int result = 0;
    int currentResult = 0;
    int lastModifier = 1;

    foreach(string word in words) {
        if(modifiers.ContainsKey(word)) {
            lastModifier *= modifiers[word];
        } else {
            int n;

            if(lastModifier > 1) {
                result += currentResult * lastModifier;
                lastModifier = 1;
                currentResult = 0;
            }

            if((n = Array.IndexOf(ones, word) + 1) > 0) {
                currentResult += n;
            } else if((n = Array.IndexOf(teens, word) + 1) > 0) {
                currentResult += n + 10;
            } else if((n = Array.IndexOf(tens, word) + 1) > 0) {
                currentResult += n * 10;
            } else if(word != "and") {
                throw new ApplicationException("Unrecognized word: " + word);
            }
        }
    }

    return result + currentResult * lastModifier;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-03T20:10:57.970

这是上述算法的 C# 版本。为了清晰起见，我重命名并重写了一些代码，并添加了对负数、连字符数、零以及文本单词和数字组合（如“100 和 5”）的支持。感谢 Ry- 的良好开端。

```
 /// <summary>
  /// Convert text number strings to integer numbers. Credit to stackoverflow
  /// for the main algorithm.
  /// </summary>
  public static int
    WordNumberToInt (string number) {
    // define arrays of keywords to translate text words to integer positions
    // in the arrays. Thus, ordering of words in the array is important.
    string[] ones = {
      "one", "two", "three", "four", "five", "six",
      "seven", "eight", "nine"
    };
    string[] teens = {
      "eleven", "twelve", "thirteen", "fourteen", "fifteen",
      "sixteen", "seventeen", "eighteen", "nineteen"
    };
    string[] tens = {
      "ten", "twenty", "thirty", "forty", "fifty", "sixty",
      "seventy", "eighty", "ninety"
    };
    var bigscales = new Dictionary<string, int> () {
      {"hundred", 100}, {"hundreds", 100}, {"thousand", 1000},
      {"million", 1000000}, {"billion", 1000000000},
    };
    string[] minusWords = {"minus", "negative"};
    var splitchars = new char[] {' ', '-', ','};

    // flip all words to lowercase for proper matching
    var lowercase = number.ToLower ();
    var inputwords = lowercase.Split (splitchars, StringSplitOptions.RemoveEmptyEntries);

    // initalize loop variables and flags
    int result = 0;
    int currentResult = 0;
    int bigMultiplierValue = 1;
    bool bigMultiplierIsActive = false;
    bool minusFlag = false;

    foreach (string curword in inputwords) {
      // input words are either bigMultipler words or little words
      //
      if (bigscales.ContainsKey (curword)) {
        bigMultiplierValue *= bigscales[curword];
        bigMultiplierIsActive = true;
      }

      else {
        // multiply the current result by the previous word bigMultiplier
        // and disable the big multiplier until next time
        if (bigMultiplierIsActive) {
          result += currentResult * bigMultiplierValue;
          currentResult = 0;
          bigMultiplierValue = 1; // reset the multiplier value
          bigMultiplierIsActive = false; // turn it off until next time
        }

        // translate the incoming text word to an integer
        int n;
        if ((n = Array.IndexOf (ones, curword) + 1) > 0) {
          currentResult += n;
        }
        else if ((n = Array.IndexOf (teens, curword) + 1) > 0) {
          currentResult += n + 10;
        }
        else if ((n = Array.IndexOf (tens, curword) + 1) > 0) {
          currentResult += n * 10;
        }
        // allow for negative words (like "minus") 
        else if (minusWords.Contains (curword)) {
          minusFlag = true;
        }
        // allow for phrases like "zero 500" hours military time
        else if (curword == "zero") {
          continue;
        }
        // allow for text digits too, like "100 and 5"
        else if (int.TryParse (curword, out int tmp)) {
          currentResult += tmp;
        }
        else if (curword != "and") {
          throw new ApplicationException ("Expected a number: " + curword);
        }
      }
    }

    var final = result + currentResult * bigMultiplierValue;
    if (minusFlag)
      final *= -1;
    return final;
  } 
```

这是我运行的一些测试用例。

```
 -20 = minus twenty
 -261 = minus two hundred sixty one
 1965 = nineteen hundred and sixty five
   45 = forty five
   55 = fifty-five
   21 = twenty-one
   55 = fifty five
    0 = zero
  105 = one hundred 5
  105 = 100 and 5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-08T17:59:53.643

我对错误处理采取了稍微不同的方法……</p>

```
 public static bool ParseEnglishNumberPhrase(string pNumberPhrase, out int pValue) {
     pValue = 0;
     string[]
        temporaryWords = pNumberPhrase.ToLower().Split(new char[] { '_', ' ', '-', ',' }, StringSplitOptions.RemoveEmptyEntries),
        ones = { "one", "two", "three", "four", "five", "six", "seven", "eight", "nine" },
        teens = { "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen" },
        tens = { "ten", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety" },
        minusWords = { "minus", "negative", "hyphen" };
     List<string> words = temporaryWords.ToList();
     bool minusFlag = false;
     Dictionary<string, int> modifiers = new Dictionary<string, int>() {
        { "billion", 1000000000 },
        { "million", 1000000 },
        { "thousand", 1000 },
        { "hundred", 100 } };
     int result = 0, currentResult = 0, lastModifier = 1;

     if (pNumberPhrase.Equals("eleventy billion")) {
        pValue = int.MaxValue; // 110,000,000,000 is out of range for an int!
        return false;
     }
     if (words[0].Equals("zero") && (words.Count == 1)) {
        pValue = 0;
        return true;
     }
     else if (words[0].Equals("zero"))
        words.RemoveAt(0);
     if (pNumberPhrase.StartsWith("-"))
        minusFlag = true;
     foreach (string word in minusWords) {
        if (pNumberPhrase.Contains(word)) {
           minusFlag = true;
           words.Remove(word);
        }
     }
     if (words.Count == 1) {
        if (int.TryParse(words[0], out int pOutValue)) {
           pValue = pOutValue;
           if (minusFlag)
              pValue *= -1;
           return true;
        }
     }
     foreach (string word in words) {
        if (modifiers.ContainsKey(word))
           lastModifier *= modifiers[word];
        else {
           int n;

           if (lastModifier > 1) {
              result += currentResult * lastModifier;
              lastModifier = 1;
              currentResult = 0;
           }
           if ((n = Array.IndexOf(ones, word) + 1) > 0)
              currentResult += n;
           else if ((n = Array.IndexOf(teens, word) + 1) > 0)
              currentResult += n + 10;
           else if ((n = Array.IndexOf(tens, word) + 1) > 0)
              currentResult += n * 10;
           else if (word != "and") {
              pValue = -1;
              return false;
           }
        }
     }
     pValue = result + currentResult * lastModifier;
     if (minusFlag)
        pValue *= -1;
     return true;
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-10T23:40:49.340

我认为一个更容易理解的解决方案如下：

```
public static int ParseInt(string s)
{
  var wordArray = s.Split(' ', '-');
  int finalNumber = 0;

  Dictionary<string, int> additionWords = new Dictionary<string, int>{
    {"one" , 1}, {"two", 2},{"three", 3},{"four", 4},{"five", 5},{"six", 6},
    {"seven", 7},{"eight", 8},{"nine", 9},{"ten", 10},{"eleven", 11},{"twelve", 12},
    {"thirteen", 13},{"fourteen", 14},{"fifteen", 15},{"sixteen", 16},{"seventeen", 17},
    {"eighteen", 18},{"nineteen", 19},{"twenty", 20},{"thirty", 30},{"forty", 40},
    {"fifty", 50},{"sixty", 60},{"seventy", 70},{"eighty", 80},{"ninety", 90}  
  };

  Dictionary<string, int> multiplicationWords = new Dictionary<string, int>{
    {"hundred", 100},{"thousand", 1000},{"million", 1000000}
  };

  int multiplier = 1;

  for (int i = wordArray.Length - 1; i >= 0; i--){
    if (additionWords.ContainsKey(wordArray[i])){
      finalNumber += additionWords[wordArray[i]] * multiplier;
    }
    if (multiplicationWords.ContainsKey(wordArray[i])){          
      if (multiplicationWords[wordArray[i]] < multiplier){
        multiplier *= multiplicationWords[wordArray[i]];
      }else{
        multiplier = multiplicationWords[wordArray[i]];
      }
    }
  }    
  return finalNumber;
} 
```

# node.js - 升级节点后 Meteor 失败

> ID：11278083
> 
> 赞同：3
> 
> 时间：2012-06-30T22:14:30.620
> 
> 标签：node.js, meteor

将节点升级到 v0.8.1 后，捆绑的 Meteor 应用程序现在会抛出错误：

```
node: symbol lookup error: ~/bundle/server/node_modules/fibers/src/fibers.node:
undefined symbol: _ZNK2v85Value11IsUndefinedEv 
```

升级节点的正确方法是什么？Meteor 与 v0.8.1 兼容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:15:46.050

我能够通过更换使其工作

```
~/bundle/server/node_modules/fibers/src/fibers.node 
```

和

```
~/.npm/fibers/0.6.8/package/bin/linux-x64-v8-3.11/fibers.node 
```

正确的升级方法是什么？

# c - 尝试在 C 中打印值时出现分段错误

> ID：11278085
> 
> 赞同：7
> 
> 时间：2012-06-30T22:15:03.560
> 
> 标签：c, pointers, segmentation-fault

以下 C 代码返回“分段错误”错误。我不明白为什么它不返回值 20。我的错误是什么？

```
#include <stdio.h>

int main() 
{
    int* n;
    *n = 20;

    printf("%i\n",*n);

    return 0;

} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-30T22:17:20.400

你还没有分配内存`n`，所以

```
*n = 20; 
```

尝试写入未指定的内存。

尝试

```
#include <stdlib.h>

int *n = malloc(sizeof *n);
/* use n */
free(n); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-30T22:17:17.460

您还没有为您的 分配空间`int`，您只声明了一个*指向*`int`.

指针未初始化，因此写入内存中的未知空间是未定义的行为并会导致问题。这通常会导致段错误。

您可以使用以下方法为整数分配一个槽`malloc`：

```
n = malloc(sizeof(int)); 
```

并在以后使用相应的调用来`free`释放内存：

```
free(n); 
```

但是为整数分配一个槽是非常不寻常的，通常你会`int`在堆栈上分配：

```
int n;
n = 20; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T22:19:19.043

您正在尝试写入`20`垃圾值。您必须通过使用其中一个`*alloc()`函数或在堆栈上创建一个 int 并获取它的地址来为其分配空间（正如 Richard J. Ross III 在评论中提到的那样）。

**动态分配：**

```
int n*; 
n = malloc(sizeof(int));  /* allocate space for an int */
if(n != NULL) {
 /* do something.. */ 
 free(n); /* free 'n' */
} else {
  /*No space available. */
} 
```

或在**堆栈上：**

```
int int_on_stack;
int *n = &int_on_stack;
*n = 20;
printf("%i\n", *n); // 20 
```

# java - 在 Java 中使用泛型类型实现树

> ID：11278090
> 
> 赞同：2
> 
> 时间：2012-06-30T22:16:33.430
> 
> 标签：java, generics, binary-tree, implementation

首先，我搜索了 java 中泛型类型的用法，但是我发现的答案太简单或太复杂了。所以这是我的确切问题。

我有三个类，分别是 PerfectTreeControl、Tree 和 Entry。

树有

> ```
> public class Tree<K> {
>   public Entry <K> root; 
> ```

条目有

```
public class Entry<K> {
    public K element;
    public Entry<K> parent, left_child, right_child;

    public Entry(K element) {
        this.element = element;
    }
    public Entry(K element, Entry<K> left, Entry<K> right) {
        left_child = left;
        right_child = right;
        this.element = element;
    } 
```

我想了解 Entry 父级和 Entry <K> 父级之间的区别是什么？我知道它`K element` 可以用作整数、字符串或我想要的任何东西，但是对象也一样吗？我尝试使用不带参数的 Entry 变量，它只说 Entry 是原始类型，应该进行参数化，并且它仍然可以正常工作。

我的第二个问题是关于检查一棵树是否完美。以下是我到目前为止尝试过的一些代码：

```
public class PerfectTreeControl {

    public static boolean isPerfect(Tree<String> tree) {
        Tree t1 = new Tree();
        if( t1.isFull( tree.root ) ) {  
            int depth = t1.height(tree.root);
            return t1.everyLeafHasSameDepth(tree.root, depth);
        } 
        else 
            return false;
    }   
    }

public class Tree<K> {
    public Entry <K> root;

    public boolean isLeaf(Entry e) {
        return e.left_child == null &&
                e.right_child == null;
    }

    public int height(Entry  e) {
        if( e == null ||
                e.left_child == null &&
                e.right_child == null ) 
            return  0;
        int left = height( e.left_child );
        int right = height( e.right_child );

        return 1 + Math.max(left, right);
    }

    public boolean isFull(Entry base) {
        if( isLeaf(base) )
            return true;
        else
            if( base.left_child != null && base.right_child != null ) {
                return isFull(base.left_child) &&
                        isFull(base.right_child);
            } else {
                return false;
            }
    }

    public  int depth(Entry e) {
        if( e == root ) {
            return 0;
        } else {
            return 1 + depth(e.parent);
        }
    }

    public  boolean everyLeafHasSameDepth(Entry base, int depth) {
        if( base == null ) 
            return false;
        else if(isLeaf(base) ) 
            return depth( base ) == depth;
        else {
            return 
                    everyLeafHasSameDepth(base.left_child, depth) &&
                    everyLeafHasSameDepth(base.right_child, depth);
        }
    } 
```

*   入口类（我写在页首） 如您所见，PerfectTreeControl 类中的 isPerfect 方法使用 Tree -String-tree 作为参数，我不知道它是什么。在 Tree 类中，我尝试了 Entry 并且一次又一次没有区别。代码不能正常工作，我完全糊涂了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:43:21.107

Java 中的泛型从根本上说是一种在对象中命名特定类的方法，在声明该对象之前知道哪个类。这很有用，因为它允许编译器在对该类的引用之间强制执行一致性。

更具体地说，在你的 class`Entry<K>`中，任何时候你引用`K`，Java 编译器都会强制 type 的所有引用`K`实际上都被视为 type `K`。例如，如果您创建一个类型为 的对象，则该对象的成员必须为 类型`Entry<String>`，该成员必须为 类型等。如果您有一个返回 a 的方法，编译器将识别出返回值为。如果编译器在这里看到不一致的地方——比如说，如果你尝试将' 的值设置为an——它会抱怨。 `element``String``parent``Entry<String>``K``String``member``Integer`

请记住，我在上面的示例中描述的品质都是针对`Entry<String>`您定义的特定对象的。如果您改为定义一个`Entry<Integer>`，而不更新您的`Entry`类，则在该新对象中强制执行一致性 - 除非这次是`K`有意义`Integer`的。

如果您创建一个对象而不为 指定类型参数`K`，则您使用的是“原始类型”。这可以防止编译器强制执行一致性规则，它会假定类型`K`是`Object`。这意味着您将不得不开始担心演员阵容，这可能会很乏味。

要检查一棵树是否已满（或“完美”），最直观的方法是递归方法。在这种情况下使用的递归规则是“如果一棵树的孩子是完美的并且具有相同的深度，那么这棵树就是完美的。”

# ms-access - MS Access 删除查询

> ID：11278100
> 
> 赞同：1
> 
> 时间：2012-06-30T22:19:25.287
> 
> 标签：ms-access, ms-access-2007, sql-delete

我在 MS Access 中有查询产生正确的记录结果，但 Access 拒绝将查询作为删除查询运行？
谁能帮我重写这个查询以在访问中运行。

```
Delete Table_A.*
FROM (SELECT Table_A.Main_RecID, Table_A.Fld_Unique_ID, Table_A.Actiontaken FROM Table_A 
WHERE Table_A.Actiontaken="MainRecord deleted")  AS Tmp_B 
LEFT JOIN Table_A ON Tmp_B.Main_RecID=Table_A.Main_Recid
WHERE (((Table_A.Actiontaken)<>"MainRecord deleted")); 
```

如果“删除”被选择替换，或者我要求查看数据表，则查询会产生我所期望的结果。这是表中具有相同 Main_RecID 与 Actiontaken 字段 =“MainRecord deleted”但其 Actiontaken 字段不等于“MainRecord deleted”的记录的列表。

Access 响应消息“无法从指定的表中删除”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T04:12:46.337

我从这些数据开始`Table_A`...

```
Fld_Unique_ID Main_RecID Actiontaken
            1          1 MainRecord deleted
            2          1 
            3          2 MainRecord deleted
            4          2 something else
            5          3 something else 
```

注意`Actiontaken`第二行为 Null（其中`Fld_Unique_ID`= 2）。

执行`DELETE`下面的语句会将该数据保留在表中。

```
Fld_Unique_ID Main_RecID Actiontaken
            1          1 MainRecord deleted
            3          2 MainRecord deleted
            5          3 something else 
```

```
DELETE
FROM Table_A
WHERE
    (
           Actiontaken<>'MainRecord deleted'
        OR Actiontaken Is Null
    )
    AND
    (
        DCount("*", "Table_A",
            "Main_RecID = " & Main_RecID
            & " AND Actiontaken='MainRecord deleted'") > 0
    ); 
```

如果这不是您所追求的，请向我们展示之前和之后的示例数据`DELETE`。

# facebook-graph-api - 可以从 Facebook Graph API 在 Place 对象上查询哪些字段/属性？

> ID：11278106
> 
> 赞同：0
> 
> 时间：2012-06-30T22:20:30.777
> 
> 标签：facebook-graph-api

我正在做这种形式的查询：

```
https://graph.facebook.com/search?q=Beshoff&fields=likes,checkins,products,name,talking_about_count,description,category&type=place&center=37.327453,-121.813102&distance=400 
```

我有兴趣找出可以为 Place 对象选择的详尽字段列表。

特别是，在特定地点的 facebook 页面上，通常会列出多个类别，我无法确定是否可以使用 Graph API 进行检索。

例如，在[https://www.facebook.com/BeshoffInfiniti](https://www.facebook.com/BeshoffInfiniti)上，有一个条目“Car Dealership”，但上面的图形 api 调用返回“Local business”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:36:36.267

If you leave out the "fields" attribute in your query you will get all the fields. The number of fields depends on the object type (for example owned pages vs. wiki pages)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:20:45.093

One thing to try is the Facebook Open Graph schema entry for [Page](http://graph.facebook.com/schema/page) and [Place](http://graph.facebook.com/schema/place).

You'll find all the additional fields for Pages. You can think of places as a subclass of pages.

If you're curious about the types of page that might be returned, try having a look through the [create a page](https://www.facebook.com/pages/create.php) flow.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T01:03:46.660

不要只看 Graph API。看看[FQL](https://developers.facebook.com/docs/reference/fql/)。FQL 与 API 中有不同的可用字段。是的，使用该`distance`功能，您可以查找某个区域的地点。

[图形 API](http://graph.facebook.com/beshoffinfiniti?fields=category) != [FQL](http://graph.facebook.com/fql?q=SELECT+categories+FROM+page+WHERE+username+=+%22BeshoffInfiniti%22)

# c# - 从 .NET 2.0 应用程序打印 HTML 文件

> ID：11278109
> 
> 赞同：0
> 
> 时间：2012-06-30T22:20:53.527
> 
> 标签：c#, .net, html, printing

横向打印 HTML 文件目录的最佳方法是什么？我不介意显示打印对话框。我尝试了几种解决方案（用尽 Google 和 StackOverflow），它们要么将 HTML 打印为字符串，要么无法横向打印。

我正在使用 .NET 2.0 Win Forms 项目来创建 HTML 报告。现在我需要将它们发送到打印机假脱机。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:49:29.847

更新 ：

正确理解需求后即可实现

```
//The example is using WebBrowser Control Version 4.0.0.0  .NET Component
//MSDN : http://msdn.microsoft.com/en-us/library/2te2y1x6(v=vs.80).aspx

//Example 1 : You can print html string using the Web Browser Control

    string htmlString = "<html><head><title>Printing from Win forms - Web Browser Control</title></head><body><h1>Hello World....</h1></body></html>";
    webBrowser1.DocumentText = htmlString;

//Example 2 : Print file or URL using the Web Browser Control

    webBrowser1.Url = new Uri("http://www.stackoverflow.com/faq");

//Call Print function or Print Dialog

    webBrowser1.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(PrintFile);

    private void PrintFile(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
        //You can setup page e.g. Orientation to Landscape and choose one of the Print options below
        (WebBrowser)sender).ShowPageSetupDialog();

        // Print the document now that it is fully loaded.
        ((WebBrowser)sender).Print();

        //OR
        (WebBrowser)sender).ShowPrintDialog();

        //OR Even better setup print options and then Print
        (WebBrowser)sender).ShowPrintPreviewDialog();

        // Dispose the WebBrowser now that the task is complete. 
        ((WebBrowser)sender).Dispose();
    } 
```

# javascript - keyup 函数的 Javascript 问题 - 尝试在页面上多次使用相同的表单域，但只有第一个表单域有效

> ID：11278111
> 
> 赞同：1
> 
> 时间：2012-06-30T22:21:23.477
> 
> 标签：javascript, jquery, css, forms, keyup

1.  我在同一个 html 页面上有多个词汇表。
2.  在每个词汇表上方，我想让用户在字段中输入单词或短语，以仅查看包含输入单词或短语的表行。例如，如果输入“orde”，则不包含字符串“orde”的表格行将消失。[如果您访问http://www.amanado.com/idioma-colombiano/](http://www.amanado.com/idioma-colombiano/) ，这已经可以使用，单击“Vocabulario (oficial y de jerga) - palabras y frases comunes”以展开手风琴部分，然后输入“orde”在“Ingresa palabra o frase en el siguiente campo para filtrar la información de la tabla”字样下方的字段中。输入“orde”后，词汇表中除了 2 行之外的所有行都应该消失（保留 2 行）。
3.  我有2个问题。我遇到的第一个问题是我无法在页面上的每个词汇表上方重复表单域，因为当我这样做时，只有第一次出现的表单域是有效的。我遇到的第二个问题是我希望表单字段仅适用于其正下方表格的所有行。目前，表单字段适用于页面上具有“myTable”类的所有表的所有行。也许我可以以某种方式为每个表指定一个表 id，然后让表上方的表单字段仅适用于表单字段正下方的表的表 id。而且，无需添加太多 javascript 或额外的 css 类就可以实现这一点（最好避免添加更多的 css 类）。
4.  以下是（a）出现在我的html中的表单字段；(b) 出现在我的 html 中的打开表格标记的示例；(c) 我正在使用的 javascript。
5.  我不是软件工程师，但如果有人告诉我具体要做什么，我确实知道如何实施更改（例如，进行准确的更改，然后进行准确的更改，然后进行准确的更改）。我感谢任何人可以提供的任何帮助，特别感谢文字说明。

**(a) 表单域从这里开始**

```
<form class="live-search" action="" method="post">
<p>Ingresa palabra o frase en el siguiente campo para filtrar la información de la tabla</p>
<input id="filter" class="text-input" type="text" value="Mostrar sólo filas que contengan..." onFocus="clearText(this)" onBlur="clearText(this)" />
</form> 
```

**(a) 表单域到此结束**

**(b) open table 标签从这里开始**

```
<table class="myTable" summary="Palabras y frases (oficiales y de jerga)"> 
```

**(b) open table 标签到此结束**

**(c) javascript 从这里开始（来源： http: [//www.designchemical.com/blog/index.php/jquery/live-text-search-function-using-jquery/](http://www.designchemical.com/blog/index.php/jquery/live-text-search-function-using-jquery/)；我对这个 javascript 做了 1 处修改以使它仅适用于带有 class="myTable" 的表格行）**

```
$(document).ready(function(){
$("#filter").keyup(function(){

// Retrieve the input field text and reset the count to zero
var filter = $(this).val(), count = 0;

// Loop through the comment list
$('table[class="myTable"] tr').each(function(){

// If the list item does not contain the text phrase fade it out
if ($(this).text().search(new RegExp(filter, "i")) < 0) {
$(this).fadeOut();

// Show the list item if the phrase matches and increase the count by 1
} else {
$(this).show();
count++;
}
});

// Update the count
var numberItems = count;
$("#filter-count").text(" Total = "+count);
});
}); 
```

**(c) javascript 到此结束**

甜菜根建议的变化分析从这里开始

**甜菜根，谢谢。**我实施了您建议的更改。结果，我发现了 4 个小 bug，我相信它们都比你已经解决的更容易解决。＃1 和＃2 是showstoppers 和＃3 和＃4 我可以管理。如果您或其他人可以指导我如何消除下面 #1 和 #2 的错误，那就太好了。我非常感谢您已经提供的亲切帮助。

**1)**当找到 1 或匹配时，过滤器计数是正确的。但是，清空输入字段后，显示的是表格总行数，这个数字是不正确的。显示的数字是“1”到高。例如，转到此问题顶部 #2 中提供的同一 Amanado.com 链接（Stackoverflow 不允许我添加另一个链接到此问题 b/c 我是新用户），展开“Vocabulario (oficial y de jerga) - abreviaturas comunes" 手风琴，在 "Ingresa palabra o frase en el siguiente campo para filtrar la informationación de la tabla" 字样下方的输入字段中输入 "ap" ，结果是 "2" 行，其中是正确的。然后通过删除“ap”来清除输入字段，结果是“19”行，这是不正确的（正确的行数是“ 请注意，我对 Beetroot 的建议更改做了 1 处更改，即出于外观/美学原因，我将 $count.text(" Total = " + count) 更改为 ("(" + count + ")")。我希望这与这个不正确的过滤器计数问题无关。请注意，我对 Beetroot 的建议更改做了 1 处更改，即出于外观/美学原因，我将 $count.text(" Total = " + count) 更改为 ("(" + count + ")")。我希望这与这个不正确的过滤器计数问题无关。

**2)**在输入字段中输入值时，表头行丢失。但是，表格标题行应始终可见。请注意上面的#1，当表头行消失时，行数是正确的，当表头行存在时，行数不正确（“1”太多）。

**3）**删除标签后，输入字段的css丢失/不正确。下面是我正在使用的 css。我尝试在javascript中用“live-search”替换“input-text”，并在输入字段中将class =“input-text”更改为“live-search”，但这并没有恢复css，所以我消除了这些更改并返回到您提供的javascript和输入字段。所以，就目前而言，我继续拥有无关标签，因为当标签被删除时，我还没有成功地让 css 工作。

**4)**当“0”出现在以下标签中时，“0”出现在页面上至少第一次出现输入字段。但是，当没有输入任何内容时，不应出现“0”。如果在未输入任何内容时出现“0”，则“0”是不正确/具有误导性的，因为所有表行都是可见的，并且正确的过滤器计数应该是可见表行的总和减去表头行的“1”。为了解决这个问题，我从 中删除了“0”，这消除了表行可见时“0”的出现，这似乎没有引起任何新问题。

```
Changed from:   <span class="filter-count">0</span>
Changed to:     <span class="filter-count"></span> 
```

**5)**下面是我在进行 Beetroot 建议的更改后使用的当前 (a) 输入字段、(b) 表打开标记、(c) css 和 (d) javascript。

**(a) 输入字段从这里开始**

```
<form class="live-search" action="" method="post">
<p>Ingresa palabra o frase en el siguiente campo para    filtrar la información de la tabla</p>
<input class="input-text" type="text" value="Mostrar sólo    filas que contengan..." />
<span class="filter-count"></span>
</form> 
```

**(a) 输入字段到此结束**

**(b) 表打开标签从这里开始**

```
<table class="myTable" summary="Palabras y frases (oficiales y de jerga)"> 
```

**(b) 表格打开标签到此结束**

**(c) css 从这里开始**

```
.live-search {
overflow: hidden; 
width: 100%; 
padding: 8px 0; 
border: 0px solid #e3e3e3; 
margin-bottom: 10px;
font-size: 12px;
color: rgb(61, 61, 61) !important;
}

.live-search input {
border:1px solid #ddd;
padding:5px 8px;
width:300px; 
font-size: 12px;
color: rgb(61, 61, 61) !important;
-moz-border-radius:4px;
-webkit-border-radius:4px;
}

.live-search input:focus {
border-color: #c3c3c3;
-moz-box-shadow: 0 0 3px rgba(0,0,0,.2);
-webkit-box-shadow: 0 0 3px rgba(0,0,0,.2);
box-shadow: 0 0 3px rgba(0,0,0,.2);     
} 
```

**(c) css 到此结束**

**(d) javascript 从这里开始**

```
$(function() {
$(".input-text").keyup(function() {
var $this = $(this),
count = 0,
pattern = new RegExp($this.val(), "i"),
$group = $this.closest(".group"),
$count = $group.find(".filter-count");
$group.find(".myTable tr").each(function() {
$tr = $(this);
if ($tr.text().search(pattern) < 0) {
$tr.fadeOut();
} else {
$tr.show();
count++;
}
$count.text("(" + count + ")")
});
}).on('focus blur', function() {
if (this.defaultValue == this.value) this.value = '';
else if (this.value == '') this.value = this.defaultValue;
});
}); 
```

**(d) javascript 到此结束**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:16:38.980

这里的技巧是相对于当前正在接收文本的输入元素工作。

指示：

*   修改文本输入字段以读取`<input class="text-input" type="text" value="Mostrar sólo filas que contengan..." />`并添加到所有其他相关组。这些字段不需要包含在`<form></form>`标签中，除非表单用于其他用途。
*   添加`<span class="filter-count">0</span>`（或类似）到所有相关组。该元素将接收`count`统计信息。
*   删除函数 clearText。
*   将javascript修改为如下：

：

```
$(function() {
    $(".text-input").keyup(function() {
        var $this = $(this),
            count = 0,
            pattern = new RegExp($this.val(), "i"),
            $group = $this.closest(".group"),
            $count = $group.find(".filter-count");
        $group.find(".myTable tr").each(function() {
            $tr = $(this);
            if ($tr.text().search(pattern) < 0) {
                $tr.fadeOut();
            } else {
                $tr.show();
                count++;
            }
        });
        $count.text(" Total = " + count);
    }).on('focus blur', function() {
        if (this.defaultValue == this.value) this.value = '';
        else if (this.value == '') this.value = this.defaultValue;
    });
}); 
```

未经测试，因此可能需要调试。当它工作时，它应该比当前代码快得多。

## 编辑

这是一个新版本，它修复了以前的错误并进一步提高了性能。

```
$(function() {
    $(".text-input").on('keyup', function(e) {
        var disallow = [37, 38, 39, 40];//ignore arrow keys
        if($.inArray(e.which, disallow) > -1) {
            return true;
        }
        var inputField = this,
            val = this.value,
            pattern = new RegExp(val, "i"),
            $group = $(this).closest(".group"),
            $trs = $group.find(".myTable tbody tr"),
            $s;
        if(val === '') {
            $s = $trs;
        }
        else {
            $s = $();
            $trs.stop(true,true).each(function(i, tr) {
                if(val !== inputField.value) {//if user has made another keystroke
                    return false;//break out of .each() and hence out of the event handler
                }
                $tr = $(tr);
                if ($tr.text().match(pattern)) {
                    $s = $s.add(tr);
                }
            });
            //$trs.not($s).fadeOut();
            $trs.not($s).hide();
        }
        $group.find(".filter-count").text("(" + $s.show().length + ")");
    }).on('focus blur', function() {
        if (this.defaultValue == this.value) this.value = '';
        else if (this.value == '') this.value = this.defaultValue;
    });

    $(".group").each(function() {
        $this = $(this);
        $this.find(".filter-count").text("(" + $this.find("tbody tr").length + ")");
    });
}); 
```

您可以尝试`.fadeOut()`，但我个人更喜欢使用`.hide()`.

# sql-server-2012 - 为 SQL Server Express 2012 启用远程连接

> ID：11278114
> 
> 赞同：406
> 
> 时间：2012-06-30T22:21:33.927
> 
> 标签：sql-server-2012, remote-connection, sql-server-2012-express

我刚刚在我的家庭服务器上安装了 SQL Server Express 2012。我试图从我的台式电脑从 Visual Studio 2012 连接到它，并反复收到众所周知的错误：

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）

我为解决此问题所做的工作：

*   在服务器上运行 SQL Server 配置管理器并启用 SQL Server Browser
*   在服务器上为本地子网上的 TCP、端口 1433 和 1434 添加 Windows 防火墙例外。
*   验证我在桌面上登录的用户是否在 SQL Server 实例上登录。
*   验证我是否在 SQL Server 实例上使用 Windows 身份验证。
*   反复重启 SQL Server 和整个 dang 服务器。
*   把我所有的头发都拉出来。

**如何让 SQL Server 2012 Express 允许远程连接！？**

* * *

## 回答 #1

> 赞同：738
> 
> 时间：2012-06-30T22:21:34.707

好吧，[很高兴我问了](https://stackoverflow.blog/2012/05/22/encyclopedia-stack-exchange/)。我最终发现的解决方案在这里：

[如何配置 SQL Server Express 以允许端口 1433 上的远程 tcp/ip 连接？](http://support.webecs.com/KB/a868/how-do-i-configure-sql-server-express-to-allow-remote.aspx)

1.  运行 SQL Server 配置管理器。
2.  转到 SQL Server 网络配置 > SQLEXPRESS 的协议。
3.  确保 TCP/IP 已启用。

到目前为止，一切都很好，完全符合预期。但是之后：

1.  右键单击 TCP/IP 并选择**Properties**。
2.  确认在 IP2 下，IP 地址设置为本地子网上的计算机 IP 地址。
3.  向下滚动到 IPAll。
4.  确保**TCP 动态端口**为**空白**。（我的设置为一些 5 位数的端口号。）
5.  确保**TCP 端口**设置为**1433**。（我的是空白的。）

（另外，如果您按照这些步骤操作，则*无需*启用 SQL Server Browser，您只需要允许端口 1433，而不是 1434。）

这些额外的五个步骤是我不记得在以前版本的 SQL Server、Express 或其他版本中必须做的事情。它们似乎是必要的，因为我在服务器上使用命名实例 (myservername\SQLEXPRESS) 而不是默认实例。看这里：

[将服务器配置为侦听特定 TCP 端口（SQL Server 配置管理器）](https://msdn.microsoft.com/en-us/library/ms177440.aspx)

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2013-06-04T17:02:25.773

连接到远程 SQL Server *（不打开 UDP 端口 1434 并启用 SQL Server Browser）*的正确方法是使用**ip 和端口**而不是**命名实例**。

使用 ip 和端口而不是命名实例也更安全，因为它减少了攻击面。

也许 2 张图片说 2000 字...

**此方法使用指定的端口（我相信这是大多数人想要的）..**

![在此处输入图像描述](../Images/1b8465b84e4048fc850dc28daaa72217.png)

**此方法需要打开 UDP 端口 1434 并运行 SQL Server Browser。**

![在此处输入图像描述](../Images/855bc8f6bd134edd0ba8b2560474b1a9.png)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2014-05-08T19:57:43.973

**还有一件事...**

Kyralessa 提供了很好的信息，但即使在这篇文章之后，我还有一件事要补充。

在 SQL Server 网络配置 > 服务器协议 > 启用 TCP/IP 下。右键单击 TCP/IP 并选择属性。在 IP 地址下，您需要为您使用的每种连接类型将启用设置为是。

![在此处输入图像描述](../Images/5cfaba4e1cf42a77249603ed24672dfb.png)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-05-20T04:22:21.643

您可以使用它来解决此问题：

转到开始 > 执行，然后运行**​​CLICONFG.EXE。**

Named Pipes 协议将在列表中排在第一位。将其降级，并提升 TCP/IP。

彻底测试应用程序。

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-11-26T11:52:24.923

您还可以设置

> 全部听NO

在协议对话框中，然后在 IP 地址 IP1 中（比如说）

> 将启用设置为是，
> 
> 定义您的 IP 地址，
> 
> 将 TCP 动态设置为空白和
> 
> TCP端口到1433（或其他）

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2015-08-20T16:42:14.487

我最近遇到了这个问题。**2015 年 8 月**

通过打开**SQL Server 配置管理器解决**

*   SQL Server 网络配置 -> SQLEXPRESS 的协议
*   TCP/IP 上的属性 -> IP 地址选项卡
*   一切都保持默认，只设置 IPALL: TCP Port to **1433**

可以使用**SQL Server Manager**连接到机器：*[hostaddress], 1433*

例子：

[![在此处输入图像描述](../Images/8161309e0e2877bb951fbbf7498a02e0.png)](https://i.stack.imgur.com/yaJZx.png)

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-08-14T20:28:02.740

这篇文章帮助了我...

[如何在 SQL Server 中启用远程连接](http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server-2008.aspx)

SQL Server 中的所有内容都已配置，我的问题是防火墙阻止了端口 1433

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-01-04T14:27:25.877

在使用默认设置安装 SQL Server 2012 Developer Edition 时，我只需加载 SQL Server 配置管理器 -> SQL Server 网络配置 -> MSSQLSERVER 的协议并将 TCP/IP 从禁用更改为启用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-07-10T13:28:52.180

我必须添加防火墙入站端口规则才能打开 UDP 端口 1434。这是 Sql Server Browser 监听的一个。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-03-03T16:46:35.317

我更喜欢“Rosdi Kasim”的方式，因为它不需要对 IP 进行详细配置。

当我再次尝试启动另一台服务器时，我肯定会再次忘记它。

Keep It Simple Stupid (KISS) 只需启用 Sql Server Browser 服务，然后在连接服务器时在 IP 后面添加 \SQLEXPRESS。

直接使用没有“\SQLEXPRESS”的 IP 是我的失败点，因为它不使用默认端口。

谢谢。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-04-30T21:43:56.863

我必须通过配置管理器添加端口并在我的 sql 连接**[host]\[db instance name],1433中添加端口号**

**注意 instancename 和 port 之间的 ,（逗号）**

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-10-20T18:08:45.353

我在本地安装的 SQL Server 2014 命名实例中遇到了同样的问题。使用连接`FQDN\InstanceName`会失败，而仅使用我的`hostname\InstanceName`工作连接。例如：使用连接`mycomputername\sql2014`工作，但使用`mycomputername.mydomain.org\sql2014`没有。DNS 正确解析，在 SQL 配置管理器中启用了 TCP/IP，添加了 Windows 防火墙规则（然后关闭防火墙进行测试以确保它没有阻止任何内容），但这些都没有解决问题。

最后，我不得不在 SQL Server 上启动“ **SQL Server Browser** ”服务，从而解决了连接问题。

我从来没有意识到 SQL Server Browser 服务实际上是在帮助 SQL Server 建立连接；我的印象是，当您单击“浏览更多”服务器以连接到时，它只是帮助填充下拉列表，但它实际上有助于将客户端请求与要使用的正确端口 # 对齐，如果端口 # 未明确分配（类似网站绑定如何帮助缓解托管多个网站的 IIS Web 服务器上的相同问题）。

这个连接项目给了我关于 SQL Server Browser 服务的线索：[https ://connect.microsoft.com/SQLServer/feedback/details/589901/unable-to-connect-on-localhost-using-fqdn-machine-姓名](https://connect.microsoft.com/SQLServer/feedback/details/589901/unable-to-connect-on-localhost-using-fqdn-machine-name)

> *   当您使用 wstst05\sqlexpress 作为服务器名称时，客户端代码将机器名称与实例名称分开，并将 wstst05 与 netbios 名称进行比较。我认为他们匹配没有问题，并且连接被认为是本地的。*从那里，我们在不*联系 SQL 浏览器的情况下检索所需的信息，并通过共享内存毫无问题地连接到 SQL 实例。
> *   当您使用 wstst05.capatest.local\sqlexpress 时，客户端代码无法将名称 (wstst05.capatest.local) 与 netbios 名称 (wstst05) 进行比较，并认为连接“远程”。这是设计使然，我们肯定会考虑在未来改进这一点。无论如何，由于考虑到远程连接和它是一个命名实例的事实，客户端决定它需要使用 SQLBrowser 进行名称解析。它尝试在 wstst05.capatest.local（UDP 端口 1434）上联系 SQL Browser，显然该部分失败了。因此你得到的错误。

TechNet 提供“SQL Server Browser”服务的原因（重点由我添加）：[https ://technet.microsoft.com/en-us/library/ms181087(v=sql.120).aspx](https://technet.microsoft.com/en-us/library/ms181087(v=sql.120).aspx)

从“使用 SQL Server 浏览器”部分：

> 如果 SQL Server Browser 服务未运行，如果您提供正确的端口号或命名管道，您仍然可以连接到 SQL Server。例如，如果 SQL Server 在端口 1433 上运行，您可以使用 TCP/IP 连接到默认实例。但是，**如果 SQL Server Browser 服务未运行，则以下连接不起作用**：
> 
> *   **任何在未完全指定所有参数（例如 TCP/IP 端口或命名管道）的情况下尝试连接到命名实例的组件**。
> *   生成或传递服务器\实例信息的任何组件，稍后其他组件可以使用这些信息重新连接。
> *   **在不提供端口号或管道**的情况下连接到命名实例。****
> ***   DAC 到命名实例或默认实例（如果不使用 TCP/IP 端口 1433）。*   OLAP 重定向器服务。*   在 SQL Server Management Studio、企业管理器或查询分析器中枚举服务器。**
> 
>  **如果您在客户端-服务器方案中使用 SQL Server（例如，当您的应用程序通过网络访问 SQL Server 时），**如果您停止或禁用 SQL Server Browser 服务，则必须为每个实例分配一个特定的端口号，并且编写您的客户端应用程序代码以始终使用该端口号。这种方法存在以下问题**：
> 
> *   您必须更新和维护客户端应用程序代码，以确保它连接到正确的端口。
> *   您为每个实例选择的端口可能被服务器上的另一个服务或应用程序使用，从而导致 SQL Server 实例不可用。**

 **以及来自“SQL Server Browser 的工作原理”部分的同一篇文章的更多信息：

> 因为**只有一个 SQL Server 实例可以使用端口或管道**，为命名实例分配不同的端口号和管道名称，包括 SQL Server Express。默认情况下，启用后，命名实例和 SQL Server Express 都配置为使用动态端口，即在 SQL Server 启动时分配一个可用端口。如果需要，可以将特定端口分配给 SQL Server 实例。连接时，客户端可以指定特定的端口；但是如果端口是动态分配的，则端口号可以在 SQL Server 重新启动时随时更改，因此客户端不知道正确的端口号。...当 SQL Server 客户端请求 SQL Server 资源时，客户端网络库使用端口 1434 向服务器发送一条 UDP 消息。SQL Server 浏览器使用所请求实例的 TCP/IP 端口或命名管道进行响应。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-01-24T12:20:41.417

**到目前为止，我遇到的所有答案都存在不同的问题！**

我应该首先说我在 Visual Studio 中拥有它，而不是在 SQL Server Express 中，但解决方案应该完全相同。

好吧，上帝，这实际上很简单，也许有点愚蠢。当我尝试创建数据库并且 Visual Studio 建议 SQL Server 的名称时，它给了我我的 Windows 用户名，因为它实际上是我选择的服务器的名称。

实际上，它实际上是我的 Windows 用户名 + `\SQLEXPRESS`。如果您没有更改任何设置，这可能也是您的。如果有效，请停止阅读；这是我的回答。如果它不起作用，可能名称不同。

如果像我一样，您只在 Visual Studio 中遇到此问题，请按照以下步骤检查您的问题：

1.  打开*SQL Server Management Studio*^([图标](http://www.iamthefrenchblog.com/wp-content/uploads/2010/12/SQL-Management-Studio.png))。
2.  如果您没有看到您的服务器（默认停靠在左侧），请按`**F8**`或转到**View -> Object Explorer**。
3.  右键单击服务器名称并选择**属性**（最后一项）
4.  在左下角，您可以在“**服务器**”下看到您的服务器的实际名称（不是连接，而是在其上方）。

这是服务器的名称，这是您应该尝试连接的名称！不是 Visual Studio 所建议的！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-06-19T10:35:44.473

要检查的另一件事是您是否正确拼写了命名实例！

本文对解决连接问题非常有帮助：[如何排除连接到 SQL Server 数据库引擎的故障](http://social.technet.microsoft.com/wiki/contents/articles/2102.how-to-troubleshoot-connecting-to-the-sql-server-database-engine.aspx)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-09-02T19:22:05.410

就我而言，数据库在非标准端口上运行。检查您正在连接的端口是否与数据库正在运行的端口相同。如果有更多 SQL Server 实例，请检查正确的实例。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-01-10T21:43:38.167

您需要做的就是打开服务器防火墙上的相关端口。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-01-08T10:00:15.373

连接到 SQL Server 时遇到问题？

尝试断开防火墙。

如果您可以在防火墙断开连接的情况下连接，可能是您错过了一些输入规则，例如“sql service broker”，将此输入规则添加到您的防火墙：

“SQL 管理员连接”TCP 端口 1434

“SQL 管理员连接”UDP 端口 1434

“SQL 分析服务” TCP 端口 2383

“SQL 浏览分析服务”TCP 端口 2382

“SQL 调试器/RPC” TCP 端口 135

"SQL SERVER" TCP PORT 1433 和其他，如果你有动态端口

“SQL 服务代理” TCP 端口 4022**

# php - php需要和javascript

> ID：11278118
> 
> 赞同：-3
> 
> 时间：2012-06-30T22:22:21.617
> 
> 标签：php, javascript, echo, require

我使用此代码连接到数据库：

```
@mysql_connect("localhost","root","") or die(mysql_error());
@mysql_select_db("ECOLE") or die (mysql_error());
@mysql_set_charset('utf8');

if(isset($_POST['profname_in'])){
   $querycheck = "SELECT prof_som FROM prof_table 
                  WHERE prof_som=$_POST[profsom_in];";
   $_querycheck=mysql_fetch_array(mysql_query($querycheck));
   if(isset($_querycheck['prof_som'])){
     echo "0";
   }else{
     $query="INSERT INTO prof_table 
             VALUES('$_POST[profname_in]',
                    '$_POST[profcin_in]',
                    '$_POST[profsom_in]',
                    '$_POST[profville_in]',
                    '$_POST[profecole_in]',
                    '$_POST[profmat_in]',
                    '$_POST[profpass_in]');";
     if(mysql_query($query)){
           echo "1";
         }
   }
} 
```

回声由 javascript 函数 (ajax) 恢复：

```
function adding_prof_Reply() {

if(http.readyState == 4){ 
        var response = http.responseText;

     if(response==0){
            document.getElementById('prof_validation').innerHTML = '<font color="red">'+response+'</font>';
        }else if (response==1){
            document.location.href="dir_paneau.php";        
        }else{
            document.getElementById('prof_validation').innerHTML = '<font color="red">'+response+'</font>';
        }
}
} 
```

一切正常，问题是当我`require('anyfile')`在 php 代码中使用时，`if(response==0)`即使 respose==0 测试也总是错误的；如果我删除`require`一切正常工作的行。我需要要求不要重复连接信息，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:29:34.343

“我需要要求不要重复连接信息”

要仅连接一次，请将“连接信息”放在单独的文件中，也许并在需要数据库连接的文件中`dbConnect.php`使用该功能。`require_once('dbConnect.php')`

这可确保您只连接一次数据库，这可能会解决您的问题。

# php - PHP如何判断一个字符串是否包含某个值

> ID：11278121
> 
> 赞同：0
> 
> 时间：2012-06-30T22:22:53.217
> 
> 标签：php

在我的 SQL 数据库中，我有一个查询，它将多行中的值转换为单个连接字符串。

```
id    |    image_filename    |    slides    |    languages    |    types
-------------------------------------------------------------------------
10    |    filename.jpg      |    55,4     |        1         |    TN,CQ 
```

在 PHP 中，我试图检查该图像与哪些幻灯片相关联。如果它是关联的，则该复选框将被选中。

```
$isChecked = (strpos($slide,"5") !== false) ? " checked=\"checked\"" : ""; 
```

问题是上面的语句将返回 true，因为其中包含 5。需要发生的是它将返回**false**，因为 5 不等于 55。

如何在 PHP 中创建一些东西来检查每个逗号之前的值，并查看它是否与我可以指定的某个字符串匹配。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:26:15.530

然后你应该`explode($slide)`转换为整数

```
$parts = explode(',', $slide);
if(intval($parts[0]) == 55) {
    // Do stuff
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T22:25:58.847

比较用逗号连接的实际值！

```
$isChecked = in_array("5",explode(",",$slide))!=false?" checked=\"checked\"":""; 
```

见[爆炸](http://www.php.net/manual-lookup.php?pattern=explode&lang=en&scope=quickref)。

编辑：刚刚注意到您只想检查逗号之前的值。这实际上比从字符串创建数组要快：

```
$isChecked = "5"==strstr($slide,',',true)?" checked=\"checked\"":""; 
```

假设你有 PHP 5.3+。见[strstr](http://php.net/manual/en/function.strstr.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T22:56:54.543

您实际上应该使用 MySQL`FIND_IN_SET()`函数在 RDBMS 级别可靠地执行此操作。请参阅[此 SO question](https://stackoverflow.com/questions/4155873/find-in-set-vs-in)，其答案说明了您的目标。

# python - 使用 Python 对冗长的 Hex 和 ascii 字符串进行按位运算

> ID：11278124
> 
> 赞同：0
> 
> 时间：2012-06-30T22:23:01.477
> 
> 标签：python, hex, bit-manipulation, xor

我正在寻找一种方法，可以对十六进制字符串进行按位运算（对于加密，所以主要是异或），这可能比我想要的长。例如，我可能有一个冗长的十六进制文字，我想与其他数据进行异或。下面是我想要做什么以及我现在如何做的一个例子，但我相信在某些限制下，计算机会达到它可以放入 Long 的限制，所以我怎样才能更稳健地做到这一点？

```
#assuming lengths of messages are correct and key length as well
old_hex = "top secret ascii message".encode('hex')
encoded = "09e1c5f70a65ac56e55ac519458e7e53f36" #a literal hex encoded string
key_hex = int(old_hex,16) ^ int(encoded,16) #this currently works because this fits in Long
new_hex = "my new message to send 2".encode('hex')
ans_hex = key_hex ^ int(new_hex,16)

print 'old message in hex: 0x'+old_hex
print 'found a key in hex: '+str(hex(key_hex))
print 'new message in hex: 0x'+new_hex
print 'new message encode: '+str(hex(ans_hex)) 
```

所以我想对更长的字符串进行异或运算，我担心它们不适合 Long 变量，所以我该如何解决这个问题？我是否必须将字符串分解成更小的块并通过操作完成每个部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:25:54.023

> 我相信在某些限制下，计算机会达到它可以放入 Long 的限制

是的，有一个限制，但这个限制是**巨大的**。最终你会耗尽内存，但同样的情况也可能发生在字符串上。Python 的整数类型可以正常工作。

# c# - 如何在特定表单上获取 x、y。

> ID：11278127
> 
> 赞同：0
> 
> 时间：2012-06-30T22:24:12.670
> 
> 标签：c#, drawing

我一直在制作一个用户点击的程序，无论他们在哪里拖动鼠标，它都会画一条线。它有效，但它在错误的地方画线。我认为这是因为我得到了整个表格的 xy，而不是我的面板。继承人的代码：

```
 private void panel2_MouseDown(object sender, MouseEventArgs e)
    {
        vars.x = MousePosition.X;
        vars.y = MousePosition.Y;
        label1.Text = vars.x + ", " + vars.y;
        vars.isDrawing = true;
    }
    private void panel2_MouseMove(object sender, MouseEventArgs e)
    {
        if (vars.isDrawing == true)
        {
            if (e.Button == MouseButtons.Left)
            {
                int x2 = MousePosition.X;
                int y2 = MousePosition.Y;

                Random randomGen = new Random();
                Color randomColor = Color.FromArgb(randomGen.Next(255), randomGen.Next(255), randomGen.Next(255));
                Pen line = new Pen(randomColor, 1);
                System.Drawing.Graphics formGraphics = panel2.CreateGraphics();
                formGraphics.DrawLine(line, vars.x, vars.y, x2, y2);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:26:18.483

使用`e.X`and`e.Y`代替`MousePosition.X`and`MousePosition.Y`

# html - 显示空间间隙的 HTML 电子邮件，经过代码测试和验证，我哪里出错了？

> ID：11278128
> 
> 赞同：1
> 
> 时间：2012-06-30T22:24:16.797
> 
> 标签：html, html-email

我为客户设计了一份电子邀请函。然后我用PS把它切片了。图片中间有一个链接。而已。

当我在 Safari、IE、Chrome 和 FF 上测试 DW 中的代码时，它看起来很棒。我什至用 W3C Validator 和 jsfiddle 检查了 HTML 文件。但是，当我在 Outlook 中插入文件以使用 Gmail、Yahoo、Hotmail 等电子邮件运营商进行测试时，图像似乎被分割成碎片；空间间隙。在移动浏览器上查看时，图像看起来不错。我尝试插入推荐的修复程序，例如`style="display:block"`或`style="vertical-align-bottom"`没有成功。我编码错了吗？

在 Outlook 中插入时的示例：http: [//img39.imageshack.us/img39/7581/outlooka.jpg](http://img39.imageshack.us/img39/7581/outlooka.jpg)

Safari、Chrome、IE、FF 的示例：http: [//img337.imageshack.us/img337/6137/35240520.jpg](http://img337.imageshack.us/img337/6137/35240520.jpg)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="generator" content="HTML Tidy for Linux (vers 6 November 2007), see www.w3.org"/>
    <title>e-invite</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
</head>
<body>
<table id="Table_01" width="601" border="0" cellpadding="0" cellspacing="0" align="center" bgcolor="FFFFFF">
    <tr>
        <td width="600" height="280" colspan="3" style="font-size:0">
            <img style="display:block" src="image1.jpg" alt="" width="600" height="280" border="0" vspace="0"
                 hspace="0"/>
        </td>
    </tr>
    <tr>
        <td width="227" height="130" rowspan="2" style="font-size:0">
            <img style="display:block" src="image2.jpg" alt="" width="227" height="130" border="0" vspace="0"
                 hspace="0"/>
        </td>
        <td width="128" height="33" style="font-size:0">
            <a href="mailto:clientemail.com">
                <img style="display:block" src="image3.jpg" alt="" width="128" height="33" border="0" vspace="0"
                     hspace="0"/>
            </a>
        </td>
        <td width="245" height="130" rowspan="2" style="font-size:0">
            <img style="display:block" src="image4.jpg" alt="" width="245" height="130" border="0" vspace="0"
                 hspace="0"/>
        </td>
    </tr>
    <tr>
        <td width="128" height="97" style="font-size:0">
            <img style="display:block" src="image5.jpg" alt="" width="128" height="97" border="0" vspace="0"
                 hspace="0"/>
        </td>
    </tr>
</table>
</body>
</html>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T13:42:36.470

在 Dreamweaver 中，您需要清除列宽和列高。即使它们看起来正确，这样做也将纠正 Outlook 显示问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T22:46:05.630

检查表格和单元格的宽度，

表格是 601px

顶部单元格为 600px

~~下面的单元格是 227+128+245=594~~对不起，我的错，计算器设置为十六进制

简单地说，您只能拥有一个图像，并且用户可以在任何地方单击...

# c++ - PETSc 和 MPI COMM 世界的正确用法

> ID：11278130
> 
> 赞同：1
> 
> 时间：2012-06-30T22:24:17.850
> 
> 标签：c++, c, mpi

嗨，我有一个用 C++ 编写的程序，其中有一个或两个函数使用 PETSc。

当我调用这些函数时，这将是使用 PETSc 时的正确方法

```
1) a)change all MPI_COMM_WORLD to PETSC_COMM_WORLD for my entire program
   b)change MPI_Init to PetscInitialize 
```

..

2) 为 petsc 创建一个单独的通信世界并将其传递给函数

```
 MPI_Init(&argc, &argv);
    ..
    //some many line of code
    ..

    MPI_Comm_split(MPI_COMM_WORLD, rank, 0, &PETSC_COMM_WORLD);

    petsc_function(PETSC_COMM_WORLD,.....

    //some how reverting the comm_split here to continue as normal so all the non petsc functions work 
```

..

3）或者我可以简单地通过使用 MPI_COMM_WORLD 和 Petsc 函数来获得..

4）还是有另一种我不知道的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:42:43.913

你需要先打电话`PetscInitialize`。您可以`MPI_Init`用它替换调用。

`PETSC_COMM_WORLD`除非您只想在排名的子集上使用 PETSc，否则无需设置。如果你自己不设置`PETSC_COMM_WORLD`，它会被自动设置`PetscInitialize`为`MPI_COMM_WORLD`.

然后，当您调用 PETSc 函数时，您可以使用`PETSC_COMM_WORLD`. 在程序调用结束时`PetscFinalize`，它将`MPI_Finalize`为您调用，除非您`MPI_Init`手动调用而不是`PetscInitialize`单独使用。

在程序的其余部分无需更改`MPI_COMM_WORLD`为。`PETSC_COMM_WORLD`

# r - 一种可靠的方法来判断 = 是否用于 R 代码中的赋值？

> ID：11278131
> 
> 赞同：14
> 
> 时间：2012-06-30T22:24:22.463
> 
> 标签：r

我是一个顽固的用户，`=`而不是一直使用`<-`，显然许多 R 程序员对此会皱眉头。我根据包编写了[`formatR`](https://github.com/yihui/formatR/wiki)可以替换`=`的`<-`包[`parser`](http://cran.r-project.org/package=parser)。你们有些人可能知道，`parser`几天前在 CRAN 上成为孤儿。虽然它现在又回来了，但这让我对依赖它犹豫不决。我想知道是否有另一种方法可以安全地替换`=`为`<-`，因为不是所有`=`的平均分配，例如`fun(a = 1)`. 正则表达式不太可能是可靠的（参见函数的第[18 行](https://github.com/yihui/formatR/blob/master/R/utils.R#L18)），但如果您能改进我的，我将不胜感激。也许包裹可以提供帮助？`mask.inline()``formatR``codetools`

几个测试用例：

```
# should replace
a = matrix(1, 1)
a = matrix(
  1, 1)

(a = 1)
a =
  1

function() {
  a = 1
}

# should not replace
c(
  a = 1
  )

c(
  a = c(
  1, 2)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T10:58:39.757

这个答案使用正则表达式。有一些边缘情况会失败，但对于大多数代码来说应该没问题。如果您需要完美匹配，则需要使用解析器，但如果遇到问题，可以随时调整正则表达式。

当心

```
#quoted function names
`my cr*azily*named^function!`(x = 1:10)
#Nested brackets inside functions
mean(x = (3 + 1:10))
#assignments inside if or for blocks
if((x = 10) > 3) cat("foo")
#functions running over multiple lines will currently fail
#maybe fixable with paste(original_code, collapse = "\n")
mean(
  x = 1:10
) 
```

该代码基于`?regmatches`页面上的示例。基本思想是：将函数内容交换为占位符，进行替换，然后将函数内容放回原处。

```
#Sample code.  For real case, use 
#readLines("source_file.R")
original_code <- c("a = 1", "b = mean(x = 1)")

#Function contents are considered to be a function name, 
#an open bracket, some stuff, then a close bracket.
#Here function names are considered to be a letter or
#dot or underscore followed by optional letters, numbers, dots or 
#underscores.  This matches a few non-valid names (see ?match.names
#and warning above).
function_content <- gregexpr(
  "[[:alpha:]._][[:alnum:._]*\\([^)]*\\)", 
  original_code
)

#Take a copy of the code to modify
copy <- original_code

#Replace all instances of function contents with the word PLACEHOLDER.
#If you have that word inside your code already, things will break.
copy <- mapply(
  function(pattern, replacement, x) 
  {
    if(length(pattern) > 0) 
    {
      gsub(pattern, replacement, x, fixed = TRUE) 
    } else x
  }, 
  pattern = regmatches(copy, function_content), 
  replacement = "PLACEHOLDER", 
  x = copy,
  USE.NAMES = FALSE
)

#Replace = with <-
copy <- gsub("=", "<-", copy)

#Now substitute back your function contents
(fixed_code <- mapply(
  function(pattern, replacement, x) 
  {
      if(length(replacement) > 0) 
      {
          gsub(pattern, replacement, x, fixed = TRUE) 
      } else x
  }, 
  pattern = "PLACEHOLDER", 
  replacement = regmatches(original_code, function_content), 
  x = copy,
  USE.NAMES = FALSE
))

#Write back to your source file
#writeLines(fixed_code, "source_file_fixed.R") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T02:04:35.357

Kohske 向该软件包发送了一个[拉取请求](https://github.com/kohske/formatR/commit/a2692d59f17ac9106e43f564857bc43d728fde6b)，该`formatR`软件包使用该软件包解决了问题`codetools`。基本思路是设置一个code walker来遍历代码；当它检测到`=`作为函数调用的符号时，将其替换为`<-`. 这是由于 R: 的“Lisp 本质”`x = 1`实际上是``=`(x, 1)`（我们将其替换为``<-`(x, 1)`）；当然，`=`在`fun(x = 1)`.

包`formatR`(>= 0.5.2) 已经摆脱了对`parser`包的依赖，`replace.assign`现在应该是健壮的。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-01T08:20:30.353

最安全（可能也是最快）的替换`=`方式`<-`是直接键入`<-`而不是尝试替换它。

# java - 使用多线程时的标准输出

> ID：11278133
> 
> 赞同：1
> 
> 时间：2012-06-30T22:24:48.323
> 
> 标签：java, eclipse, multithreading

我正在使用eclipse，当我正常运行它时，我在控制台中看不到打印语句，但是当我在调试模式下运行它时，我看到了。到底是怎么回事？这只发生在一些打印语句上（在服务器客户端学校项目的服务器端，两者都在本地主机上运行）。

```
private class GameDriver extends Thread { 
     private Board board; 

     public GameDriver() { 
        board = new Board(); 
     } 

     @Override 
     public void run() { 
         boolean twoActivePlayersAlreadyJoined = false; 
         while (!twoActivePlayersAlreadyJoined) { 
             twoActivePlayersAlreadyJoined = connector.activePlayers.size() >= 2; 
         } 
         System.out.println("Two players already connected, ready to start game"); 
         sendBoardStateToAll(); 
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:35:41.063

Eclipse 调试窗口显示从您的 Eclipse 实例启动的不同 JVM。

![显示线程的 Eclipse 调试窗口](../Images/dda710f6e554ff3c27fcabe2b041e2a2.png)

如果您在 Eclipse 中启动多个应用程序，那么调试窗口中也会显示多个 JVM。现在，如果您在调试窗口中选择其中一个 JVM，则输出控制台将更改为所选 JVM 的标准输出。

但是，如果没有调试模式，Eclipse 只会显示最后打印到标准输出的 JVM 控制台的标准输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T05:07:41.583

`connector.activePlayers.size()`使它看起来像`connector.activePlayers`一个集合。它是线程安全的集合吗？（即使它不是一个集合，它是线程安全的吗？）如果不是，它可能`connector.activePlayers.size()`是不断返回`0`or `1`，导致你的`while`循环永远旋转。如果发生这种情况，您可能会看到 CPU 使用率上升——是这样吗？`System.out.println("foo")`无论如何，您可以通过将 a放入`while`循环中轻松检查。

很可能是调试器正在插入同步点或以其他方式导致 CPU 寄存器、缓存等被刷新。这可以解释为什么您在`System.out.println`调试器中看到循环终止（以及输出），而不是在 JVM 更积极地优化优化的“正常”模式下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T22:51:48.293

问：我在使用eclipse，正常运行时在控制台看不到打印语句，但在debug模式下运行时，我看到了。到底是怎么回事？

从子线程写入的“printf”完全有可能保持缓冲，直到线程终止。在这种情况下，您将永远看不到它。

建议：

请改用“System.err.println()”。这使用无缓冲的 I/O。你可能会看到你所期望的*一切。*

# c++ - 如何访问由第二个结构中的 void* 指向的结构的元素

> ID：11278146
> 
> 赞同：0
> 
> 时间：2012-06-30T22:27:24.720
> 
> 标签：c++, pointers, struct, void

我在构造 void* 时遇到问题。我的 C++ 代码如下：

```
struct BUFF_TYPE {
    int a;
    int b;
};
typedef struct BUFF_TYPE BUFF_TYPE;

struct REG_TYPE {
    int c;
    void *buff;
};
typedef struct REG_TYPE REG_TYPE;

REG_TYPE regs[20];
const BUFF_TYPE b_A = {3,5};

void func_x() {
    int x,y;
    regs[4].buff = (BUFF_TYPE*)&b_A;
    x = regs[4].buff->a;
    y = regs[4].buff->b;
} 
```

它给了我：

```
error: ‘void*’ is not a pointer-to-object type 
```

在 x 和 y 作业中，您能告诉我如何访问这些 a 和 b 值吗？

顺便说一句，我需要 void* 因为有时我需要指向其他类型的缓冲区。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:31:23.733

不要使用`void*`类型，而是使用`BUFF_TYPE*`.

如果您`void*`出于其他原因需要（不太可能基于您的代码），您可以通过转换指针来解决这个问题。

```
x = ((BUFF_TYPE*)regs[4].buff)->a;
y = ((BUFF_TYPE*)regs[4].buff)->b; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T22:31:03.823

在使用 -> 之前，必须将 regs[4].buff 强制转换为 BUFF_TYPE*​​，因此需要：

((BUFF_TYPE*​​) regs[4].buff)->a

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T22:33:29.367

在取消引用之前将结构的`void* buff`成员强制转换为 a。`REG_TYPE``BUFF_TYPE*`

# chef-infra - 在厨师食谱中强制执行顺序

> ID：11278155
> 
> 赞同：2
> 
> 时间：2012-06-30T22:29:10.477
> 
> 标签：chef-infra

我有两个食谱：

1.  用我的 .bashrc 之类的东西配置我的主目录，在我使用的几乎每台机器上运行
2.  挂载一个包含我的主目录的 EBS 卷。这一次只能由一个 EC2 实例使用，但让我可以轻松迁移到新实例

对于此 EC2 实例，当它首次启动时，我需要在配方 #1 之前执行配方 #2，否则该卷将不会被挂载。如何确保明确强制执行此执行顺序？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-01T00:06:37.560

Chef*始终*按照您指定的顺序执行食谱。它不会随意对事物进行重新排序。因此，如果您希望一个配方在另一个配方之前运行，只需按该顺序加载它们（例如在`run_list`）

为了进一步加强这一点（以您的配方之间的额外耦合为代价），您还可以`include_recipe`在第二个配方的开头使用来加载第一个。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-30T22:35:08.817

如果您希望在登录时（而不是启动时）完成这两个操作...

...如果您需要按特定顺序完成它们...

...那么你应该简单地编写一个调用*它们*的脚本。以正确的顺序。

恕我直言...

# image-processing - CRF++ 或 CRFSuite

> ID：11278156
> 
> 赞同：4
> 
> 时间：2012-06-30T22:29:11.097
> 
> 标签：image-processing, android-activity, crf++, crfsuite

我开始使用 crf++ 和 crfsuite（两者都使用非常相似的文件格式）。我想做与图像相关的事情（分割、活动识别等）。我的主要问题是如何构建培训文件。有人使用 crf 和图像吗？有没有人解释我或提供一些文件来学习。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-28T19:41:25.390

CRFsuite 比 CRF++ 更快，它可以处理大量的训练数据。我尝试了他们两个。它们完美地处理了合理数量的数据，但是当我的数据集增加到超过 100,000 个句子时，CRF++ 无法处理它并突然停止工作。看下面的链接
[CRFsuite - CRF Benchmark test](http://www.chokkan.org/software/crfsuite/benchmark.html) 有很多 CRF 软件在某些标准上的比较

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:20:01.087

我以前用过 CRF++，效果很好。但我的领域是自然语言处理，我使用 CRF++ 进行命名实体识别或 POS 标记。CRF++ 很容易在 Linux 上安装，但在 Windows 上编译时有一些小问题。您可以按照其文档了解训练数据格式：每行代表一个数据样本，每列代表一个特征类型。

或者，您也可以考虑具有 CRF 组件的 Mallet。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-05T18:25:15.237

可能您应该从 DGM 库 ( [https://github.com/Project-10/DGM](https://github.com/Project-10/DGM) ) 开始，这对于以前从未使用过 CRF 的人来说是最佳选择。它包括许多现成的演示项目，它们将开箱即用地对您的图像进行分类/分割。它也有[据可查](http://research.project-10.de/dgmdoc/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T14:57:26.473

也许您还想尝试 Mallet 包中的 CRF 组件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T13:13:54.897

我刚刚在 Windows 上遇到了这个：http: [//crfsharp.codeplex.com/](http://crfsharp.codeplex.com/)

# c# - 如何根据特定对象类型实例化列表？

> ID：11278157
> 
> 赞同：0
> 
> 时间：2012-06-30T22:29:18.387
> 
> 标签：c#, oop

我有以下定义：

```
public class BaseEntity 
{
    ...
    public BaseEntity()
    {

    }
}

public class KeyValuePair
{
    public string key;
    public string value;
    public string meta;
}

public class KeyValuePairList : BaseEntity
{
    public List<KeyValuePair> List {set; get;}

    public KeyValuePairList(IEnumerable<KeyValuePair> list)
    {
        this.List = new List<KeyValuePair>();
        foreach (KeyValuePair k in list) {
            this.List.Add(k);
        }
    }
} 
```

我还有 10 个不同的类`KeyValuePair`，`KeyValuePairList`它们都实现了相同的目的——前者定义了对象，后者定义了应该放置这些对象的列表。如何将此功能合并到基类`BaseEntity`中，这样我就不必在每个单独的类中重新定义列表实例化逻辑，即我希望能够根据传递给构造函数的对象类型来实例化列表？有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T22:38:01.977

可以使用泛型吗？

```
public class BaseEntity<T> where T: class
{
    public List<T> List { set; get; }

    public BaseEntity(IEnumerable<T> list)
    {
        this.List = new List<T>();
        foreach (T k in list)
        {
            this.List.Add(k);
        }
    }
}

public class KeyValuePair
{
    public string key;
    public string value;
    public string meta;
}

public class KeyValuePairList : BaseEntity<KeyValuePair>
{
    public KeyValuePairList(IEnumerable<KeyValuePair> list) 
        : base(list) { }
} 
```

# javascript - 如何使用循环构建 json 对象？

> ID：11278161
> 
> 赞同：8
> 
> 时间：2012-06-30T22:29:54.887
> 
> 标签：javascript, jquery, json

我正在尝试遍历许多项目，并创建一个 json 对象。每个循环都应该是对象上的一个新项目，但我在做这件事时遇到了一些问题。似乎只添加了一组项目，而不是多个项目。

这是我的代码：

```
jsonObj = {}
rows.each(function (index) {
    jsonObj["id"] = $this.find('.elementOne').val();
    jsonObj["name"] = $this.find('.elementTwo').text();

}); 
```

这是我的 json 的样子：

```
{
    id: "3"
    name: "Stuff"
}, 
```

这是我正在尝试做的事情：

```
{
    id: "1"
    name: "Stuff"
},
{
    id: "2"
    name: "Stuff"
},
{
    id: "3"
    name: "Stuff"
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-30T22:34:11.093

这里没有 JSON。请不要混淆：

*   JavaScript 对象（一种数据结构）
*   JavaScript 对象字面量（创建此类数据结构的代码）
*   JSON（一种基于对象文字符号子集的数据格式）

如果您想要一个有序的对象列表（或任何其他类型的 JavaScript 数据结构），请使用数组。数组有一个`push`方法。

```
var myData = [];
rows.each(function (index) {
    var obj = { 
        id: $this.find('.elementOne').val(),
        name: $this.find('.elementTwo').text()
    };
    myData.push(obj);
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-30T22:34:03.777

您覆盖该对象，而不是每次迭代都为其添加一个新值。

**使用数组的**固定代码：****

 **```
jsonObj = [];
rows.each(function(index) {
    jsonObj.push({
        'id': $this.find('.elementOne').val(),
        'name': $this.find('.elementTwo').text()
    });
});​ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-30T22:35:08.817

你想要的是一个对象数组。当您尝试在同一个对象上多次写入相同的属性时，它会被覆盖，这就是您看到`id`并`name`包含循环最后一次迭代的值的原因。

虽然您没有使用 jQuery 标记问题，但它看起来确实像 jQuery，所以这里有一个解决方案：

我冒昧地更改`$this`为，`this`因为`$this`似乎在每次迭代中都指的是同一个对象，这就是你现在可能想要的（我认为）

```
var myArray = rows.map(function() {
    return {
        id: $(this).find('.elementOne').val(),
        name: $(this).find('.elementTwo').text()
    };
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-31T13:10:27.607

您可以使用 jquery 来执行此操作。该函数将期望输入类型的表单元素。它将遍历传递的表单，它将收集每个输入名称和值，并将创建一个 json 对象，如

示例：

HTML

```
<form action="" method="post" id="myForm">
    <input type="text" name="field1" value="I am value of field 1"/>
    <input type="text" name="field2" value="I am value of field 2"/>
</form> 
```

Javascript

```
function buildObject(form) {
            var jsonObject = [],
                tempObj = {};
            $(form).find("input:not(input[type='submit'])").each(function() {
                tempObj[$(this).attr("name")] = $(this).val();
            });

            jsonObject.push(tempObj);

            return jsonObject[0];
    }
    buildObject($("#myForm"));
    //Will produce

     jsonObj = {
        field1 : "I am value of field 1",
        field2 : "I am value of field 2"    
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-30T22:34:23.763

这是因为您只是覆盖了对象的相同属性，`id`并且`name`，每次。您需要为每个子对象创建一个子对象，然后将其推送到主对象中（我已将其转换为数组，因为它是非关联的）。

```
var jsonObj = []
rows.each(function (index) {
    var temp_obj = {};
    temp_obj["id"] = $this.find('.elementOne').val();
    temp_obj["name"] = $this.find('.elementTwo').text();
    jsonObj.push(temp_obj);
}); 
```

[编辑] - 正如 Mark Eirich 的回答所示，这`temp_obj`是不必要的 - 你可以推送一个匿名对象，但我定义`temp_obj`只是为了让发生的事情一目了然。

另请阅读 Quentin 的非常好的观点：JavaScript 对象和 JSON 之间的常见混淆。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-30T22:33:50.720

```
var jsonObj = [];
rows.each(function(index) {
    jsonObj.push({
        id: $this.find('.elementOne').val(),
        name: $this.find('.elementTwo').text()
    });
}); 
```**

# android - 覆盖两个不透明的列表视图

> ID：11278165
> 
> 赞同：0
> 
> 时间：2012-06-30T22:30:33.903
> 
> 标签：android, listview

何我在框架布局上有两个列表视图。我想要一个覆盖另一个，它没有透明背景。我有这样做

```
 <FrameLayout  
    xmlns:android="http://schemas.android.com/apk/res/android"  
    android:layout_width="fill_parent"  
    android:layout_height="fill_parent">  

     <ListView
        android:id="@+id/autocompleteCompany"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:drawSelectorOnTop="true"
        android:paddingLeft="30dip"

         >

    </ListView>
  <ListView
      android:id="@+id/list"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content" >
    </ListView>
</FrameLayout> 
```

但不能正常工作。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:38:53.743

尝试使用`<RelativeLayout>`而不是`<FrameLayout>`

**编辑：**

要摆脱透明度，您需要设置 listView 的背景颜色或 listView 适配器中的项目。这些问题将帮助您做到这一点：

[在 Android 上更改 ListView 项目的背景颜色](https://stackoverflow.com/questions/2217753/changing-background-color-of-listview-items-on-android)

[listview 项目背景颜色更改](https://stackoverflow.com/questions/9356845/listview-item-background-color-change)

# ruby-on-rails-3.2 - Rails 教程第 4 章第 2 版。没有参数没有调用 Title Helper

> ID：11278167
> 
> 赞同：1
> 
> 时间：2012-06-30T22:31:09.533
> 
> 标签：ruby-on-rails-3.2, title, helper, railstutorial.org

我正在阅读 Michael Hartl 的 Rails 教程（Screen Cast）。遇到第 4 章中关于标题助手的问题。

我一直在对代码进行自己的修改，以确保我理解了这一切。然而，在这一个上，它非常相似，我不太确定它为什么会这样。

这是代码：

应用程序.html.erb

```
<!DOCTYPE html>
<html>
  <head>
    <%- Rails.logger.info("Testing: #{yield(:title)}") %>
    <title><%= full_title(yield(:title)) %></title>
    <%= stylesheet_link_tag    "application", :media => "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
  </head>
  <body>
    <%= yield %>
  </body>
</html> 
```

Application_helper.rb

```
module ApplicationHelper
  def full_title(page_title)
    full_title = "Ruby on Rails Tutorial App"
    full_title += " | #{page_title}" unless page_title.blank?
  end
end 
```

主页.html.erb

```
<h1><%= t(:sample_app) %></h1>
<p>
  This is the home page for the <a href="http://railstutorial.org/">Ruby on Rails Tutorial</a> sample application
</p> 
```

about.html.erb

```
 <% provide(:title, t(:about_us)) %>
 <h1><%= t(:about_us) %></h1>
 <p>
   The <a href="http://railstutorial.org/">Ruby on Rails Tutorial</a> is a project to make a book and screencast to teach web development with <a href="http://railstutorial.org/">Ruby on Rails</a>. This is the sample application for the tutorial.
 </p> 
```

发生了什么：当我在 about 页面上设置提供方法时，代码工作正常。但是，当我不这样做时，它似乎甚至都没有调用助手。我假设这是因为没有标题被传回。关于我做错了什么的任何想法？

感谢大家的帮助。

编辑：这是修复。感谢 Paul 指出最后一行没有返回任何内容，这就是我的代码无法正常工作的原因。改变它，使它返回一些不重要的东西。

Application_helper.rb

```
module ApplicationHelper
  def full_title(page_title)
    full_title = "Ruby on Rails Tutorial App"
    page_title.present? ? (full_title += " | #{page_title}") : full_title
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T21:11:13.633

我似乎你的`full_title`帮助方法的最后一行有问题，因为如果它是空白的，它不会返回任何东西`page_title`（所有发生的事情就是`full_title`分配了局部变量）。试着把它改回[书中的写法，](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#code%3atitle_helper)看看它是否有效。

# python - python 3.0 pickle.load TypeError

> ID：11278168
> 
> 赞同：2
> 
> 时间：2012-06-30T22:31:10.037
> 
> 标签：python, pickle, typeerror

以下代码：

```
with open("J:\\python\\.data") as data:
    self.data=pickle.load(data) 
```

产生以下错误：

```
File "J:\python\code.py", line 50, in get_events
    self.data=pickle.load(data)
TypeError: 'str' does not support the buffer interface 
```

我读到我可能必须对其进行编码，并且我尝试了 utf-8 并且没有用。其他格式是什么？我会朝着正确的方向前进吗？

我忘了提到 .data 中的对象是一个列表，并且是使用协议 2 腌制的。var self.data 已经是一个列表

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-30T22:47:06.437

```
with open("J:\\python\\.data", "rb") as data:
    self.data=pickle.load(data) 
```

如[`pickle`文档](http://docs.python.org/release/3.1.5/library/pickle.html#pickle.Unpickler)中所述：

> 这需要一个二进制文件来读取 pickle 数据流。

因此，您需要使用`"rb"`二进制模式打开它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-19T12:49:20.330

在我的例子中，它试图打开一个在以前版本的 Python (2.7) 下腌制的对象。

一旦我重新腌制它，一切都很好。

# javascript - 有人可以举例说明何时让 switch 语句使用多个 case 语句吗？

> ID：11278171
> 
> 赞同：0
> 
> 时间：2012-06-30T22:31:57.720
> 
> 标签：javascript

我正在阅读*Javascript: the Definitive Reference*，它在第 93 页上说：

> 在极少数情况下，编写这样的从一个 case 标签到下一个 case 标签的代码很有用，但 99% 的情况下，您应该非常小心地使用 break 语句结束 switch 中的每个 case。

在什么情况下你会让一个 switch 语句落入多个 case 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T22:38:42.810

一种有用的情况是多个值应该具有相同的结果：

```
switch (value) {
  case 1:
  case 2:
    action1();
    break;
  case 3:
  case 4:
  case 5:
    action2();
    break;
} 
```

空箱子会掉到下一个。在这种情况下，混淆的风险很小。

本书作者担心的情况是当您组合操作时，例如值`2`应该同时具有`action2`和`action3`：

```
switch (value) {
  case 1:
    action1();
    break;
  case 2:
    action2();
    // continue with action3
  case 3:
    action3();
    break;
} 
```

忘记 a`break`是一个很常见的错误，你应该像上面一样添加评论，以明确它是故意遗漏的。

为了比较；在 C# 中，您不能只省略 a`break`中的 a `switch`，您必须使用 a`goto`来指定应继续执行的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T22:37:25.767

我做过的唯一一次是用户输入首选大写字母，但可接受小写字母：

```
switch(input){
    case 'a':
        print "Please use uppercase next time";
    case 'A':
        //do stuff here
        break;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T22:39:35.380

当您有多个案例都应该获得相同的代码时，这当然是可以接受的：

```
switch(val) {
    case "aa":
    case "bb":
        // do you thing here
        break;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T22:43:32.043

我认为这本书应该坚持事实而不是发布这种推荐。请记住，`case`如果前一个块没有`break`语句，则将执行下一个块。这很有用，但也可能令人困惑（即缺少`break`语句会导致错误）。*何时*使用它是主观的，但基本上你可以在你的条件就像一个`or`表达式时使用它：

```
if(myvar == x || myvar == y) {
    // do A
} else if (myvar == w || myvar == z) {
    // do B
} else {
    // do C
} 
```

可以改写为：

```
switch(myvar) {
    case x:
    case y:
        // do A
        break;
    case w:
    case z:
        // do B
        break;
    default:
        // do C
        break;
} 
```

}

# performance - 获取第 i 位 - 是 % 还是 & 更快？

> ID：11278173
> 
> 赞同：2
> 
> 时间：2012-06-30T22:32:31.407
> 
> 标签：performance, math, assembly, bit-manipulation, bit

我想知道以下哪一项对于获取整数 x 的第 i 个最右边的位更快，其中 i 从 0 开始：

```
x & (1 << i)
x >> i % 2 
```

也很好奇为什么一个更快。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-30T22:58:12.033

**笔记**

正如所评论的，这取决于许多因素。另外，你不应该在意。在任何真正的程序中，我相信您不会关心如此低级的细节。过早的优化是对时间的可怕浪费。

此外，除非您的相等概念只是零/非零的概念，否则这些不是相等的操作。

**但这是一个有趣的练习**

将 GCC 与 -O3 一起使用并反汇编我看到：

```
x & (1 << i)

The first version
Dump of assembler code for function op1:
   0x0000000000000000 <+0>:     mov    %esi,%ecx
   0x0000000000000002 <+2>:     mov    $0x1,%eax
   0x0000000000000007 <+7>:     shl    %cl,%eax
   0x0000000000000009 <+9>:     and    %edi,%eax
   0x000000000000000b <+11>:    retq   
End of assembler dump. 
```

和

```
x >> i % 2

Dump of assembler code for function op2:
   0x0000000000000010 <+0>:     mov    %esi,%ecx
   0x0000000000000012 <+2>:     sar    %cl,%edi
   0x0000000000000014 <+4>:     mov    %edi,%edx
   0x0000000000000016 <+6>:     shr    $0x1f,%edx
   0x0000000000000019 <+9>:     lea    (%rdi,%rdx,1),%eax
   0x000000000000001c <+12>:    and    $0x1,%eax
   0x000000000000001f <+15>:    sub    %edx,%eax
   0x0000000000000021 <+17>:    retq 
```

所以这是 a `shift left`and an `and`vs a `shift right`, `load effective address`, and an`and`操作。在这个硬件上似乎很明显什么会更快，但除非你在一个微控制器上，否则看起来很明显的东西通常并不那么清楚。让我们测试一下。

我对（内联）操作进行了大约一千万次调用的循环，并确保返回操作结果的总和，这样编译器就不会全部丢弃。

```
[tommd@mavlo Test]$ gcc -O3 so.c -o so
[tommd@mavlo Test]$ time ./so

real    0m0.388s
user    0m0.384s
sys     0m0.003s
[tommd@mavlo Test]$ time ./so

real    0m0.384s
user    0m0.380s
sys     0m0.003s
[tommd@mavlo Test]$ vi so.c  // I changed the function to the second one
[tommd@mavlo Test]$ gcc -O3 so.c -o so
[tommd@mavlo Test]$ time ./so

real    0m0.380s
user    0m0.377s
sys     0m0.002s
[tommd@mavlo Test]$ time ./so

real    0m0.380s
user    0m0.379s 
```

好吧，完全一样。现代超级缩放器处理器中有足够的硬件来隐藏任何差异。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-01T05:56:18.977

提取位的惯用方法是

```
(x >> i) & 1 
```

这也可以类似地工作不止一位，或者

```
x & (1 << i) 
```

如果您只想测试一个位。

请注意，在 C 中`x`不能为负数（最好声明为无符号），并且如果`x`比 an 长，`int`您需要指定 1 在第二个中也是那么长。

使用`%`会使读者感到困惑，并且性能可能会更差，具体取决于编译器。

# php - 请帮忙！我的表格缺少什么？

> ID：11278175
> 
> 赞同：0
> 
> 时间：2012-06-30T22:32:58.223
> 
> 标签：php, forms, post, submit

我正在使用从我创建的另一个站点更改的表单，该表单有效，但由于某种原因它在这里不起作用。我已经通过代码一百次了，我错过了重要的线索！

该表单包括 php 验证。如果未填写必填字段，它会再次显示表单，已填写的任何内容都会自动放入新表单中。除了它不会自动填写那些已完成的字段，也不会验证有效的提交。

我猜数据没有正确发布，但我看不出问题出在哪里！

这是初始形式：

```
<form name="userform" method="post" action="send_form_email.php">
<table>
  <tr>
<td class="form_item_name">Name:</td><td><input type="text" name="name"></td>
</tr>
<tr>
<td class="form_item_name">Company name:</td><td><input type="text" name="company">    </td>
</tr>
<tr>
<td class="form_item_name">Email:</td><td><input type="text" name="email"></td>
</tr>
<tr>
<td class="form_item_name">Phone:</td><td><input type="text" name="phone"></td>
</tr>
<tr>
<td class="form_item_name"></td>
<td>
<select name="subject">
<option value="Requesting A Quote" selected="selected">Requesting A Quote</option>
<option value="Product/Service Support">Product/Service Support</option>
<option value="General Enquiry">General Enquiry</option>
</select>
</td>
</tr>
<tr>
<td class="form_item_name">Your comments:</td><td><textarea style="resize:none; width:350px;" name="comments" rows="10" wrap="hard"></textarea><br />
<br />
<input class="button_send" type="image" value=" " src="images/transparent.gif"></form> 
```

这是操作 php (send_form_email.php)：

```
<?php
if(strlen($name) > 2 &&
strlen($email) > 2 &&
strlen($comments) > 2) {

function clean_string($string) {
  $bad = array("content-type","bcc:","to:","cc:","href");
  return str_replace($bad,"",$string);
}

$email_to = "sales@happytobevisuals.com";
$email_from = "Website: Contact Us";

if (strpos($subject,'General Enquiry') !== false) {
$email_subject = "General Enquiry";
}
elseif (strpos($subject,'Product/Service Support') !== false) {
$email_subject = "Product/Service Support";
}
elseif (strpos($subject,'Request A Quote') !== false) {
$email_subject = "Quote Request";
}
$email_message .= "Name: ".clean_string($name)."\n";
$email_message .= "Company: ".clean_string($company)."\n";
$email_message .= "Email: ".clean_string($email)."\n";
$email_message .= "Phone: ".clean_string($phone)."\n";
$email_message .= "Comments: ".clean_string($comments)."\n";

"Reply-To: ".$email."\r\n" .
"X-Mailer: PHP/" . phpversion();
@mail($email_to, $email_subject, $email_message);
?>
<font face="times new roman" color="#FFF" size="+3">Thanks for that, your message has been sent!</font><br>
<a href="http://www.happytobevisuals.co.nz" class="nav_ingredients">Click here to go back to the home page</a>

<?php
}else{
?>
<font face="times new roman" color="#FFF" size="+3">Woops! Missed something ...</font>
<br>
<br>

<form name="userform" method="post" onsubmit="return validate();" action="send_form_email.php">
<table>
  <tr>
<td class="form_item_name">Name:</td><td><input type="text" name="name" value="<?php echo $name;?>"></td>
</tr>
<tr>
<td class="form_item_name">Company name:</td><td><input type="text" name="company" value="<?php echo $company;?>"></td>
</tr>
<tr>
<td class="form_item_name">Email:</td><td><input type="text" name="email" value="<?php echo $email;?>"></td>
</tr>
<tr>
<td class="form_item_name">Phone:</td><td><input type="text" name="phone" value="<?php echo $phone;?>"></td>
</tr>
<tr>
<td class="form_item_name"></td>
<td>
//this next bit's about autofilling the dropdown to reflect their previous selection
<?php
if (strpos($subject,'General Enquiry') !== false) {
echo '<select name="subject">
<option value="General Enquiry">General Enquiry</option>
<option value="Product/Service Support">Product/Service Support</option>
<option value="Complaint">Complaint</option>
</select>';
}
if (strpos($subject,'Product/Service Support') !== false) {
echo '<select name="subject">
<option value="General Enquiry">General Enquiry</option>
<option value="Product/Service Support" selected="selected">Product/Service Support</option>
<option value="Complaint">Complaint</option>
</select>';
}
if (strpos($subject,'Complaint') !== false) {
echo '<select name="subject">
<option value="General Enquiry">General Enquiry</option>
<option value="Product/Service Support">Product/Service Support</option>
<option value="Complaint" selected="selected">Complaint</option>
</select>';
}
}
?>
</td>
</tr>
<tr>
<td class="form_item_name">Your comments:</td><td><textarea style="resize:none; width:350px;" name="comments" rows="10" wrap="hard"><?php echo $comments ?></textarea><br />
<br />
<input type="submit" value="valid"></form> 
```

所以……你能看到吗？所有帮助表示赞赏！

PS。在stackoverflow上是否有比在每行之前手动添加四个空格更快的方法将代码放入块中？干杯:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T22:36:31.953

您可能在此主机上关闭了 register_globals （从安全角度来看这是一件非常好的事情 - 请参阅[http://php.net/manual/en/security.globals.php](http://php.net/manual/en/security.globals.php)！），这解释了为什么这对您的其他主机但不在这里。如果是这种情况，则您引用的变量在全局范围内不存在。引用发布的变量时使用 $_POST 数组。

这在你的脚本顶部应该让它工作：

```
$name = $_POST['name'];
$company = $_POST['company'];
$email = $_POST['email'];
$phone = $_POST['phone'];
$comments = $_POST['comments'];
// etc... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T22:40:30.717

我看不到 $name、$email 等的来源。您是否将 $_POST 数据分配给您的变量？这边走

```
$name = $_POST['name'] 
$email = $_POST['email'] 
$phone = $_POST['phone'] 
$comments = $_POST['comments']

//etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T22:55:27.290

您需要从 $_POST 数组中提取变量以便在 PHP 中使用它们。您的 HTML 很好，但要检索表单提交，您必须使用类似于以下的代码：

```
$name = $_POST['name'];
$company = $_POST['company'];
$email = $_POST['email'];
$phone = $_POST['phone'];
$comments = $_POST['comments']; 
```

# c# - Super Web Socket 和 Nugget 有什么区别？

> ID：11278176
> 
> 赞同：0
> 
> 时间：2012-06-30T22:33:13.433
> 
> 标签：c#, asp.net, .net, websocket

我已经在 C# 中使用 Supper Web Socket 实现了我的应用程序，WebSocket 服务器的.NET 实现。我听说过 Nugget，它是另一个 .NET Web Socket 服务器。主要区别是什么？我去过“nugget.codeplex.com”网站，但找不到有用的信息。我想从有过 Nugget 经验的人那里知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T06:39:15.447

[http://nugget.codeplex.com/documentation](http://nugget.codeplex.com/documentation)

[Websocket 服务器：永远不会调用 Web 套接字上的 onopen 函数](https://stackoverflow.com/questions/2211898/c-sharp-websocket-server)

[http://www.undisciplinedbytes.com/2010/06/html-5-c-web-sockets-server-and-asp-net-client-implementation/](http://www.undisciplinedbytes.com/2010/06/html-5-c-web-sockets-server-and-asp-net-client-implementation/)

[http://jxs.me/2011/05/28/csharp-websockets-with-fleck/](http://jxs.me/2011/05/28/csharp-websockets-with-fleck/)

一个简单的谷歌搜索想出了这个。请理解，存在大量的服务和图书馆，最好的方法不是要求专业知识，而是请可能有一些知识的人，如果有的话。尝试自己实现两者并根据文档查看差异。我的猜测是，除了代码的包装方式或算法处理方式之外，几乎没有什么区别。两者，如果他们做同样的事情，应该做你想让他们做的事情。它的苹果和橘子。

# objective-c - ObjC：在以后的函数中调用阻塞 ^{} 时访问不正确？

> ID：11278179
> 
> 赞同：1
> 
> 时间：2012-06-30T22:33:44.980
> 
> 标签：objective-c, block, exc-bad-access

在这个[讨论](https://stackoverflow.com/questions/11277745/objc-put-logic-within-a-variable-and-queue-that-variable-in-an-array-daydre)之后，我遇到了一个错误的访问问题；

一个循环有几个步骤：a、b、c、... x、y、z：

```
-(void)cycle:(float)delta{
[self stepA]
[self stepB]
// etc.
[self stepZ]
} 
```

在某些时候，步骤 x 执行以下操作：

```
// IRQ is an NSMutableArray
// Self is a reference to the engine running the cycles
[IRQ addObject:^{ NSLog(@"hello! %@", self); } ]; 
```

稍后，步骤 z 是处理所有“延迟”调用：

```
 for (int i = 0; i < [IRQ count]; i++){
                void (^delayedCall)(void) = [IRQ objectAtIndex:i];
                delayedCall();
            }

            [IRQ removeAllObjects]; 
```

结果：EXEC_BAD_ACCESS

现在，如果步骤 x 只添加一个没有对象引用的纯字符串，如下所示，步骤 Z 可以正常工作：

```
[IRQ addObject:^{ NSLog(@"hello!"); } ]; 
```

最后观察，如果同一个步骤既将块添加到队列中，又遍历队列以执行块，则不会出现问题。就像对对象的引用随着步骤“丢失”：方法被留下？

我在这方面不太了解，需要更多帮助！

编辑：詹姆斯，只是尝试了以下方法来避免该参考周期：

```
NSString *userName = @"James";
[IRQ addObject:^{ NSLog(@"hello %@", userName); } ]; 
```

它也会发生。您的解决方案将如何应用于此？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T23:15:57.097

当您使用语法创建块时`^{}`，它会在堆栈上创建。要将块持久化很长一段时间（超出创建它的函数的范围），您必须将块复制到堆中：

```
void (^ myBlock)(void) = ^ {
    // your block code is here.
};
[IRQ addObject:[[myBlock copy] autorelease]]; 
```

如果使用 ARC，请跳过该`-autorelease`消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T23:17:17.987

问题是块对象是在堆栈上创建的。当您希望在声明它们的范围被销毁之后使用它们时，并且如果没有为您复制块，则需要将块复制到堆中。

在这里，您将一个对象“向下堆栈”传递给一个不知道块的方法。代替

```
[IRQ addObject:^{ NSLog(@"hello! %@", self); } ]; 
```

和

```
[IRQ addObject:[^{ NSLog(@"hello! %@", self); } copy]]; 
```

并且`EXC_BAD_ACCESS`此时将消失。

但在大多数情况下，您不需要复制块！几个例子：

1.  如果你从一个方法返回一个块（“向上堆栈”），ARC 会自动复制它。
2.  如果调用不保留块的方法，则不需要复制块，因为它保留在范围内。示例：传递给`-[NSArray sortedArrayUsingComparator:]`.
3.  如果您稍后调用使用该块的方法，则该方法应负责复制该块，否则每个调用者都需要复制该块。我知道的 Apple 库中的所有方法/函数都遵循该模式。示例：完成块传递给`+[UIView animateWithDuration:options:animations:completion:]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:06:02.223

似乎您传入的对象..在您的示例中：`self`并且`userName`被过早地释放。这不是我期望的块行为。和我之前的回答一样，我预计问题是因为保留太多！

作为测试，您可以尝试：

```
NSString *userName = [@"James" retain];
[IRQ addObject:^{ NSLog(@"hello %@", userName); } ]; 
```

这将是内存泄漏，但它有助于指示对象是否正在被释放。

~~这是由块正在保留`self`和`self`正在保留块的“保留周期”引起的。~~

尝试这个：

```
__block typeof(self) blockSafeSelfReference = self;
[IRQ addObject:^{ NSLog(@"hello! %@", blockSafeSelfReference); } ]; 
```

~~如果使用 ARC，请使用`__unsafe_unretained`而不是`__block`~~

# bash - 如何在 BASH 中获取最新的时间戳文件

> ID：11278190
> 
> 赞同：0
> 
> 时间：2012-06-30T22:34:49.457
> 
> 标签：bash

我正在编写一个将时间戳备份文件保存到备份目录的部署脚本。我想做一个回滚实现，可以回滚到最新的文件。

我的备份目录：

```
$:ls

.              1341094065_public_html_bu  1341094788_public_html_bu
..             1341094390_public_html_bu
1341093920_public_html_bu  1341094555_public_html_bu 
```

我想在备份目录中识别最新的文件（通过文件名中的时间戳），并将其名称保存到变量中，然后将其 cp 到 ../public_html，依此类推...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T22:38:14.943

`ls -t`将按 mtime 对文件进行排序。 `ls -t | head -n1`将选择最新的文件。这与您拥有的任何命名方案无关，这可能是一个加号，也可能不是一个加号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:20:31.247

...以及一种更“正确”的方式，当文件名包含换行符时不会中断，也不会在没有匹配文件时中断（未扩展的 glob 结果）

```
for newestfile in ./* ; do : ; done
if test -e "$newestfile"; then do something with "$newestfile" ; fi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T22:36:34.450

带有最新时间戳的文件名应按字母顺序排在最后。因此，您可以使用`tail -n1`它来提取它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T23:52:21.387

对于名称中没有换行符的文件：

```
shopt -s nullglob
printf '%s\n' "$buDir"/* | tail -n 1 
```

# php - 用户已经有超过 'max_user_connections' 个活动连接

> ID：11278195
> 
> 赞同：3
> 
> 时间：2012-06-30T22:36:04.730
> 
> 标签：php, mysql, database, mysqli

我的`db`课程几乎所有课程都在扩展：

```
class db {

    protected $db;

    public function __construct() {
        $this->connect();
    }

    protected function connect() {
        $this->db = new MySQLi(db_host, db_user, db_pass, db_name) or die($this->db->error); (line 22)
        $this->db->set_charset('utf8');
    }

} 
```

这是页面类

```
class page extends db {
    var $common;

    public function __construct() {
        parent::__construct();
        $this->common = new common(); 
```

和

```
class common extends db {

    public function __construct() {
       parent::__construct();
    } 
```

我越来越

> 警告：mysqli::mysqli() [mysqli.mysqli]: (42000/1203): 用户管理员在 /home/tural/public_html/incl/classes/class.db.php 中已经有超过 'max_user_connections' 的活动连接在线22

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:42:13.163

`db`从您实例化的每个类都会建立一个新的数据库连接。您应该只有一个数据库类实例。所有`page`和`common`不需要从它继承，只需传递一个`db`实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T22:48:52.457

当您扩展 db 类时，每次生成实例后都会建立一个 mysqli 连接。我认为如果将类 db 定义为单例会更好

代码如下；

```
class db {

    private static $_db; // db instance
    protected $connection;

    private function __construct() {
        $this->connection = new MySQLi(db_host, db_user, db_pass, db_name) or die($this->connection->error); 
        $this->connection->set_charset('utf8');
    }

    public function get_instance()
    {
        if( isset( self::$_db) )
        {
           return self::$_db;
        }
        else
        {
           self::$_db = new db();            
        }

        return self::$_db;
    }

} 
```

通过这种方式，您只能创建 1 个 mysql 连接。

您可以通过以下方式访问 db 类`db::get_instance()->do_something();`

普通类可以是这样的；

```
class page  {
    var $common;
    var $db;    

    public function __construct() {
        parent::__construct();
        $this->db = db::get_instance();
        $this->common = new common();
    }
} 
```

我认为这是更好的设计。

# php - Paypal Adaptive Payments PHP Soap SDK 未定义定义

> ID：11278204
> 
> 赞同：0
> 
> 时间：2012-06-30T22:37:26.007
> 
> 标签：php, codeigniter, paypal, paypal-adaptive-payments

我正在尝试将自适应支付系统集成到我的 centos 服务器上的 codeigniter 项目中。SOAP 安装在我的服务器上（我通过 ssh 执行了“yum install php-soap”并已经重新启动了服务器），当我尝试运行时出现如下错误：

```
A PHP Error was encountered
Severity: Notice
Message: Use of undefined constant XML_SERIALIZER_OPTION_INDENT - assumed 'XML_SERIALIZER_OPTION_INDENT'
Filename: SOAPEncoder/SOAPEncoder.php
Line Number: 41
A PHP Error was encountered
Severity: Notice
Message: Use of undefined constant XML_SERIALIZER_OPTION_INDENT - assumed 'XML_SERIALIZER_OPTION_INDENT'
Filename: SOAPEncoder/SOAPEncoder.php
Line Number: 41 
```

我错过了什么，我该如何解决？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:45:01.900

也许您需要安装 XML_Serializer PEAR 包：[http ://pear.php.net/package/XML_Serializer/](http://pear.php.net/package/XML_Serializer/)

```
pear install XML_Serializer 
```

# sql-server-2008 - 数据库数据迁移

> ID：11278208
> 
> 赞同：0
> 
> 时间：2012-06-30T22:38:24.183
> 
> 标签：sql-server-2008

我正在寻找这方面的知识，因为我知道一种可以获得我想要的东西的方法，但我想知道这是否是最好的方法。由于项目蔓延，曾经非常简单的应用程序的数据库变成了一个过于复杂的怪物，而且在它工作时管理并不容易。

我现在有机会从根本上重新开始，但是只是一点一点地，逐渐将功能从旧应用程序迁移到新应用程序。这要求我使新数据库与旧数据库保持同步，幸运的是，这只是一种方式，因为不会在需要迁移回的新数据库上创建任何数据。

到目前为止考虑的选项是 SSIS 和使用普通旧 C# ADO.Net 的 Quartz 触发的 Windows 服务。我认为 SSIS 可能是一个坏主意，因为它可能是 upsert 的噩梦，需要创建临时表，然后进行合并，并且架构差异非常广泛，因此 SSIS 逻辑会令人头疼。ADO.Net 方法是我倾向于的方向，因为数据读取器、批量插入和 LINQ 应该可以很好地完成这项工作。但是考虑到这在我之前必须影响多少人，我认为必须有更好的方法。你们用什么方法？

为了获得更具体的细节是：

*   SQL Server 2008 R2
*   大约 30 个表中约 200 万行 -> 约 20 个表
*   每个数据库都将位于具有不同凭据的完全独立的数据库服务器上

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T12:39:01.157

让我们假设这种情况：

```
S_old: your 'old' server
S_new: your 'new' server
db_old: your 'old' database
db_new: your 'new' database 
```

一个解决方案可能是`db_old`从 s_old 到 s_new: 的几乎所有备份和恢复`db_old_bk`。然后，`s_new`您可以访问两个数据库 (`db_old_bk`和`db_new`) 此时您可以轻松地在 t-sql 上使用 'merge' sqlcommand 进行更新插入（我们正在谈论 20 个表）。这是你要找的吗？

# java - 如何使组合框的列表更宽？

> ID：11278209
> 
> 赞同：6
> 
> 时间：2012-06-30T22:38:24.323
> 
> 标签：java, swing, jcombobox, jpopup

```
import javax.swing.*;

public class test
{   
    public static void main(String[] args) throws Exception
    {
        JFrame frame = new JFrame("Test");
        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        frame.setSize(120,80);      
        JComboBox cb = new JComboBox();
        cb.addItem("A very long combo-box item that doesn't fit no. 1");
        cb.addItem("A very long combo-box item that doesn't fit no. 2");
        frame.add(cb);
        frame.validate();
        frame.setVisible(true);
    }
} 
```

如何使组合框项目以所有文本可见的方式出现？
现在我有这样的事情：
![在此处输入图像描述](../Images/674949566f376ca364f5c71b3f002aae.png)
我不想在折叠时更改组合框的大小。
我只想增加扩展部分的宽度。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-30T22:54:31.440

我认为[这](http://tutiez.com/how-make-jcombobox-drop-down-width-as-wide-as-needed.html)可能会有所帮助。

来自链接的代码

```
public class WiderDropDownCombo extends JComboBox {

    private String type;
    private boolean layingOut = false;
    private int widestLengh = 0;
    private boolean wide = false;

    public WiderDropDownCombo(Object[] objs) {
        super(objs);
    }

    public boolean isWide() {
        return wide;
    }

    // Setting the JComboBox wide
    public void setWide(boolean wide) {
        this.wide = wide;
        widestLengh = getWidestItemWidth();

    }

    public Dimension getSize() {
        Dimension dim = super.getSize();
        if (!layingOut && isWide())
            dim.width = Math.max(widestLengh, dim.width);
        return dim;
    }

    public int getWidestItemWidth() {

        int numOfItems = this.getItemCount();
        Font font = this.getFont();
        FontMetrics metrics = this.getFontMetrics(font);
        int widest = 0;
        for (int i = 0; i < numOfItems; i++) {
            Object item = this.getItemAt(i);
            int lineWidth = metrics.stringWidth(item.toString());
            widest = Math.max(widest, lineWidth);
        }

        return widest + 5;
    }

    public void doLayout() {
        try {
            layingOut = true;
            super.doLayout();
        } finally {
            layingOut = false;
        }
    }

    public String getType() {
        return type;
    }

    public void setType(String t) {
        type = t;
    }

    public static void main(String[] args) {
        String title = "Combo Test";
        JFrame frame = new JFrame(title);

        String[] items = {
                "I need lot of width to be visible , oh am I visible now",
                "I need lot of width to be visible , oh am I visible now" };
        WiderDropDownCombo simpleCombo = new WiderDropDownCombo(items);
        simpleCombo.setPreferredSize(new Dimension(180, 20));
        simpleCombo.setWide(true);
        JLabel label = new JLabel("Wider Drop Down Demo");

        frame.getContentPane().add(simpleCombo, BorderLayout.NORTH);
        frame.getContentPane().add(label, BorderLayout.SOUTH);
        int width = 200;
        int height = 150;
        frame.setSize(width, height);
        frame.setVisible(true);

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T23:09:19.567

更复杂的解决方法是[@camickr 的 Combo Box Popup](http://tips4java.wordpress.com/2010/11/28/combo-box-popup/)，实现

*   `setScrollBarRequired`- 当为 true 时，会在必要时自动显示水平滚动条
*   `setPopupWider`– 如果为 true，则弹出窗口的宽度将基于组合框中的项目。宽度永远不会小于组合框。
*   `setMaximumWidth`- 可以控制弹出窗口的宽度，以防万一你有一个不合理的长项目要渲染。
*   `setPopupAbove`– 当为 true 时，弹出窗口将显示在组合框上方。
*   听从`PopupMenuListener`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T16:32:30.103

Pshemo 给出的代码的简化版本：

```
import javax.swing.JComboBox;
import java.awt.Dimension;

public class JComboBoxWider extends JComboBox {
    private int listWidth=0;

    public JComboBoxWider(Object[] objs) {
        super(objs);
    }

    public Dimension getSize() {
        Dimension dim = super.getSize();
        if (listWidth>0)
            dim.width = listWidth;
        return dim;
    }

    public void setListWidth(int listWidth) {
        this.listWidth = listWidth;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-15T05:26:37.910

您没有使用 Netbeans，拖放。然后只需使用：

```
JComboBox cb = new JComboBox();
cb.seBounds(10,10,200,30); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-15T05:55:48.270

您正在创建一个`JComboBox`对象，但没有固定它的宽度和长度。在创建`JComboBox`使用`setBound()`方法的对象之后。像这样：

```
JComboBox cb = new JComboBox();
cb.setBounds(10,10,200,30); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-14T20:26:58.870

Warrio的回答对我有用。我添加了一些内容来制作通用版本。

```
import java.awt.Dimension;

import javax.swing.ComboBoxModel;
import javax.swing.JComboBox;

public class JComboBoxWider<E> extends JComboBox<E> {

    private static final long serialVersionUID = 1L;
    private int listWidth=0;

    public JComboBoxWider(ComboBoxModel<E> objs) {
        super(objs);
    }

    public Dimension getSize() {
        Dimension dim = super.getSize();
        if (listWidth > 0)
            dim.width = listWidth;
        return dim;
    }

    public void setListWidth(int listWidth) {
        this.listWidth = listWidth;
    }
} 
```

# c# - 如何识别字符串是否为正则表达式？

> ID：11278214
> 
> 赞同：1
> 
> 时间：2012-06-30T22:39:28.083
> 
> 标签：c#, regex

我有一个输入，它从用户那里得到一个声明。根据我的程序的使用情况，用户可以输入一个字符或者一个正则表达式。填写此输入后，用户必须填写第二个输入，即替换文本。

问题是，用户可以键入`.`，这相当于一个正则表达式，它匹配任何字符。

下面的代码有效吗？或者，有什么解决办法？

```
Match m = Regex.Match(input, pattern);
if( m.Success )
   // it's regex
else
  // it's not regex 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T22:41:53.637

# 你无法读懂用户的想法！

如果用户输入`...?`，您无法知道他们是要匹配文字`"...?"`，还是使用它作为正则表达式匹配 2-3 个字符。

如果我搜索`hello?`，我可能不会期望匹配`"hell"`。*但我可能是故意*的。**你不问是不知道**的。

给他们一个复选框！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T22:53:46.210

你不能*。

让我们看看 Visual Studio 是如何解决这个问题的：

![在此处输入图像描述](../Images/9c2d3efa96cddf6340ecbcf3fd796dd6.png)

由于您无法判断用户是否希望内容成为正则表达式，因此设计器允许用户选择，让用户完全控制他们希望如何执行搜索。如果您希望它是纯文本（默认），只需点击查找下一个。否则，您可以使用其他选项定制您的搜索。

*好吧，你可以

解决此问题的另一种方法是假设用户打算使用您支持的每种技术进行搜索，然后过滤结果；按“纯文本”匹配和“正则表达式”匹配分组。这效率较低，但可以认为对用户更友好，因为用户不必主动选择任何选项。因此，您首先仅通过纯文本搜索，并在“纯文本匹配”标题下返回这些匹配项，然后假设字符串是正则表达式进行搜索，并在“正则表达式匹配”标题下返回这些匹配项

一旦您向用户展示了这些内容，他们就可以选择他们实际要替换的内容。

# statistics - 使用 MATLAB 的 AR 模型

> ID：11278217
> 
> 赞同：3
> 
> 时间：2012-06-30T22:39:41.797
> 
> 标签：statistics, matlab, approximation

我正在使用从 MATLAB 文档中获取的以下代码来估计 ARMA 模型的参数：

> `y = sin([1:300]') + 0.5 * randn(300, 1);`
> `y = iddata(y);`
> `mb = ar(y, 4, 'burg');`

在这一点上，如果我输入`mb`我得到的是：

> 离散时间 IDPOLY 模型：
> A(q)y(t) = e(t)
> A(q) = 1 - 0.2764 q^-1 + 0.2069 q^-2 + 0.4804 q^-3 + 0.1424 q^-4
> 估计使用来自数据集 y
> 损失函数 0.314965 和 FPE 0.323364的 AR ('burg'/'now')
> 采样间隔：1

如何使用`mb`我获得的变量来生成具有这些系数的样本？
`mb`看起来不像矢量。
特别是，我该如何处理丢失的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:49:44.403

利用：`sim(mb,input)`

更多信息[`sim`](http://www.mathworks.co.uk/help/toolbox/simulink/slref/sim.html)，也在[这里](http://www-rohan.sdsu.edu/doc/matlab/toolbox/ident/sim.html#1478484)：

> 模拟线性模型。
> 
> **句法**
> 
> y = sim(m,ue)
> 
> [y, ysd] = sim(m,ue,init)
> 
> **描述**
> 
> *m*是任意 idmodel 对象。
> 
> *ue*是一个 iddata 对象，仅包含输入。ue 中的输入通道数必须等于模型 m 的输入数，或等于输入数和噪声源数之和（= 输出数）。在后一种情况下，ue 中的最后一个输入被视为噪声源，并获得了噪声破坏的模拟。噪声根据 m.NoiseVariance in m 的性质进行缩放，因此为了根据模型获得正确的噪声水平，噪声输入应该是具有零均值和单位协方差矩阵的白噪声。如果 ue 中不包含噪声源，则获得无噪声仿真。

# vb.net - Response.ContentType，BufferOutput vs <@ Page

> ID：11278220
> 
> 赞同：0
> 
> 时间：2012-06-30T22:40:37.147
> 
> 标签：vb.net, contenttype

在 VS 2010 中，是

```
<%@ Page Language="VB" Buffer="true" ContentType="image/jpeg" %> 
```

相当于

```
<%@ Page Language="VB" %>
<%
    Response.BufferOutput = True
    Response.ContentType = "image/jpeg"
%> 
```

?

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:41:08.190

是的，它是一样的。我为 Page.Buffer 属性使用了 Resharper 的“Navigate to Decompile Sources”，它设置了 Response 属性。

# ruby-on-rails - 通过多个部署阶段维护 Rails 环境

> ID：11278230
> 
> 赞同：0
> 
> 时间：2012-06-30T22:44:10.277
> 
> 标签：ruby-on-rails, performance, capistrano, loading, environment

我一直在使用 Capistrano 将多个 Rails 应用程序部署到单个 EC2 实例。这些应用程序都由 Apache + Passenger 提供。其中大部分的部署阶段如下：

-- 获取代码，暂存于主应用程序目录的“releases/[timestamp]”子目录中。

-- 运行打包器进行分阶段发布

-- 为分阶段发布运行迁移

-- 运行资产编译 ("assets:precompile") 分阶段发布的 rake 任务

-- 重启delayed_job 任务队列处理守护进程和任何其他后台进程

-- 将分阶段发布符号链接到“当前”（乘客 Web 根目录）

-- 重启乘客（通过触摸应用目录中的“tmp/restart”）

这是一个非常标准的 Rails 部署过程。我注意到它的一个巨大瓶颈是为每个需要它的任务加载 rails 环境。对于我的一个较大的应用程序，环境加载需要大约 40 秒或更长时间，并且对于需要 rails 环境的 n 个任务（运行捆绑器、迁移、资产编译、delayed_job 守护程序）重复 n 次。如果这是一个幼稚的问题，请原谅，但我想知道是否有一种简单的方法可以为所有这些任务只加载一次环境（最好比将所有这些任务/作业的实现合并到一个加载的 rake 任务中更容易环境）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T13:14:43.303

更新：我最终为此设计了自己的解决方案，效果很好。我没有从 shell 单独运行依赖于 rails 环境的每个命令（使用 Capistrano“运行”方法），而是将它们捆绑在一起成为一个依赖于 rails 环境的单个 rake 任务。我之前运行“rake db:migrate”，然后是“rake assets:precompile”等，现在我运行一个单一的 rake 任务，其主体包括“Rake::Task['db:migrate'].invoke”和“Rake ::Task['assets:precompile'].invoke"。环境现在只加载一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:02:54.597

我建议为此调查[vagrant 。](http://vagrantup.com/)这是一种快速简便的部署方式。它利用[厨师](http://www.opscode.com/chef/)来定制流浪盒。我认为您会想要创建自己的食谱（厨师的东西..）来击中您列出的大多数物品。一旦完成，你就可以走了。

# java - 我应该使用 Thread.sleep 对其他程序友好吗？

> ID：11278232
> 
> 赞同：2
> 
> 时间：2012-06-30T22:44:58.767
> 
> 标签：java

我通常使用类似于这样的主“while”循环在 Java 中编写（小型）游戏：

```
while(running) {
    time = getTime();
    if(time - oldTime > 0.01) {
        tick(time - oldTime);
        oldTime = getTime();
    } 
} 
```

我这样做是为了使程序每秒具有最大帧数，但我听说 Thread.sleep 允许其他线程执行。我应该添加 Thread.sleep(1) （或其他一些低毫秒数）以允许计算机上的其他线程吗？这更像是一个良好的编程实践问题而不是性能问题，而且这并不是真正必要的，但我喜欢制作可靠且不贪心的程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T22:48:37.747

不，你不需要这样做。

所有现代的抢先式多任务系统都将时间分配给其他线程以允许它们执行。您不需要`sleep()`适应这一点，除非您想在一段时间内强制放弃对其他线程的控制。

您唯一可能想要这样做的情况是，如果您在多核系统上占用所有内核，并且您希望在后台安静地完成一个长时间运行的计算密集型任务，而不会明显影响正在发生的其他操作同时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-30T22:53:39.113

我已经成功构建了使用[Timer](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Timer.html)更新图形的游戏。阅读[这里](http://www.javapractices.com/topic/TopicAction.do?Id=160)的好处。但总的来说，[罗伯特](https://stackoverflow.com/a/11278242/104950)是正确的，您*不需*要这样做。我发现这通常归结为找到游戏动画 FPS 的最佳点，而不是对其他进程友好。

# android - 右耳机比左耳机响

> ID：11278234
> 
> 赞同：2
> 
> 时间：2012-06-30T22:45:10.717
> 
> 标签：android, audio, alsa

在我的三星 Galaxy Nexus 上，我遇到了问题，我的右耳机比左耳机响亮得多。

因为我正在手机上使用 ALSA 进行开发，所以我不确定我是否可能意外更改了一个值（并且在重新启动后它不会重新设置？）。

任何人的想法？这不是耳机也不是我的耳朵:)

啊，这不是音频插孔。蓝牙也有同样的问题。

这是“tinymix”的输出：

```
su -c "./tinymix"
Number of controls: 79
ctl     type    num     name                                     value
0       ENUM    1       DL1 Equalizer                            Flat response
1       ENUM    1       DL2 Left Equalizer                       450Hz High-pass
2       ENUM    1       DL2 Right Equalizer                      450Hz High-pass
3       ENUM    1       Sidetone Equalizer                       Flat response
4       ENUM    1       AMIC Equalizer                           High-pass 0dB
5       ENUM    1       DMIC Equalizer                           High-pass 0dB
6       INT     1       DL1 Media Playback Volume                120
7       INT     1       DL1 Tones Playback Volume                0
8       INT     1       DL1 Voice Playback Volume                120
9       INT     1       DL1 Capture Playback Volume              0
10      INT     1       DL2 Media Playback Volume                120
11      INT     1       DL2 Tones Playback Volume                0
12      INT     1       DL2 Voice Playback Volume                120
13      INT     1       DL2 Capture Playback Volume              0
14      INT     1       VXREC Media Volume                       0
15      INT     1       VXREC Tones Volume                       0
16      INT     1       VXREC Voice DL Volume                    0
17      INT     1       VXREC Voice UL Volume                    0
18      INT     1       AUDUL Media Volume                       0
19      INT     1       AUDUL Tones Volume                       0
20      INT     1       AUDUL Voice UL Volume                    0
21      INT     1       AUDUL Voice DL Volume                    0
22      INT     1       SDT UL Volume                            103
23      INT     1       SDT DL Volume                            120
24      INT     2       DMIC1 UL Volume                          120 120
25      INT     2       DMIC2 UL Volume                          120 120
26      INT     2       DMIC3 UL Volume                          120 120
27      INT     2       AMIC UL Volume                           120 120
28      INT     2       BT UL Volume                             120 120
29      BOOL    1       DL1 Mono Mixer                           Off
30      BOOL    1       DL2 Mono Mixer                           On
31      BOOL    1       AUDUL Mono Mixer                         Off
32      BOOL    1       DL1 MM_EXT Switch                        Off
33      BOOL    1       DL1 BT_VX Switch                         Off
34      BOOL    1       DL1 PDM Switch                           Off
35      BOOL    1       Sidetone Mixer Capture                   Off
36      BOOL    1       Sidetone Mixer Playback                  On
37      BOOL    1       Capture Mixer Tones                      Off
38      BOOL    1       Capture Mixer Voice Playback             Off
39      BOOL    1       Capture Mixer Voice Capture              Off
40      BOOL    1       Capture Mixer Media Playback             Off
41      BOOL    1       Voice Capture Mixer Tones Playback       Off
42      BOOL    1       Voice Capture Mixer Media Playback       Off
43      BOOL    1       Voice Capture Mixer Capture              On
44      BOOL    1       DL2 Mixer Tones                          Off
45      BOOL    1       DL2 Mixer Voice                          Off
46      BOOL    1       DL2 Mixer Capture                        Off
47      BOOL    1       DL2 Mixer Multimedia                     On
48      BOOL    1       DL1 Mixer Tones                          Off
49      BOOL    1       DL1 Mixer Voice                          Off
50      BOOL    1       DL1 Mixer Capture                        Off
51      BOOL    1       DL1 Mixer Multimedia                     Off
52      ENUM    1       MUX_VX1                                  AMic0
53      ENUM    1       MUX_VX0                                  AMic0
54      ENUM    1       MUX_UL11                                 AMic0
55      ENUM    1       MUX_UL10                                 AMic0
56      ENUM    1       MUX_UL07                                 None
57      ENUM    1       MUX_UL06                                 None
58      ENUM    1       MUX_UL05                                 None
59      ENUM    1       MUX_UL04                                 None
60      ENUM    1       MUX_UL03                                 None
61      ENUM    1       MUX_UL02                                 None
62      ENUM    1       MUX_UL01                                 None
63      ENUM    1       MUX_UL00                                 None
64      INT     2       Capture Preamplifier Volume              1 1
65      INT     2       Capture Volume                           4 4
66      INT     2       Aux FM Volume                            3 3
67      INT     2       Headset Playback Volume                  9 9
68      INT     2       Handsfree Playback Volume                27 27
69      INT     1       Earphone Playback Volume                 11
70      ENUM    1       Headset Power Mode                       High-Performance
71      BOOL    1       Earphone Enable Switch                   Off
72      ENUM    1       HS Right Playback                        Off
73      ENUM    1       HS Left Playback                         Off
74      ENUM    1       HF Right Playback                        HF DAC
75      ENUM    1       HF Left Playback                         HF DAC
76      ENUM    1       Analog Right Capture Route               Off
77      ENUM    1       Analog Left Capture Route                Main Mic
78      ENUM    1       TWL6040 Power Mode                       Low-Power 
```

# css - 删除填充或边距的问题

> ID：11278236
> 
> 赞同：-1
> 
> 时间：2012-06-30T22:45:43.743
> 
> 标签：css

[http://www.coffeeproteindrink.com/method-athlete/](http://www.coffeeproteindrink.com/method-athlete/)

我正在尝试删除主包装器下方的开放空间，在 Firefox 中它显示大约 20px 的开放区域，主页上有一个垂直滚动条以便查看它。

在 IE 中有一个可见的 115px 区域，没有滚动条。

我的目标是让 main_wrap + 页脚与页面底部齐平，但我尝试的一切似乎都没有帮助。

```
#main_wrap {height: 390px;
background: url(images/content_back.png) repeat-y top left; 
margin: 0 0 0 240px;
opacity: .8;
position:absolute;
top:325px;
overflow: hidden;
}

#main
{position: relative;
width: 680px;
padding: 0 40px 5px 40px;
font: normal 12px Verdana, Arial, sans-serif;
line-height: 20px;
display: inline-block;
z-index: 2;
}

#footer
{ 
width: 680px;
padding: 25px 40px 0 0px;
font-size: 12px;
position: relative;
height: auto;
clear: both;
bottom:50px;} 
```

我要完成的示例：http: [//www.bio-genix.com/](http://www.bio-genix.com/)

感谢您的帮助，肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:28:28.640

事实证明，您不需要粘页脚技术，因为您的背景图像会拉伸到屏幕上，这意味着您可以使用`height: 100%`它并且可靠地将其设置为全高。

所以，看到这一点，`bottom: 0`将继续工作`#main_wrap`。下一个难题是底部边缘的幻影`60px`左右是从哪里来的；最后，经过调整，确定`overflow: hidden`将隐藏由`#main_wrap`元素内的边距和填充产生的额外高度。

这就是最终的工作（`h2`修复修复的部分）：

```
#main_wrap {
    position: absolute;
    height: 390px;
    bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden;
}
#main {
    padding-bottom: 0;
}
#main_wrap #main h2.section_title {
    margin: 20px 0 40px
} 
```

[http://jfcoder.com/test/methodsite.html](http://jfcoder.com/test/methodsite.html)

# java - Java extras 包返回空值

> ID：11278243
> 
> 赞同：1
> 
> 时间：2012-06-30T22:48:46.900
> 
> 标签：java, android, android-intent, bundle

我的包正在为包含的附加内容返回空字符串。不是 NPE，而是实际的“空”值。关于为什么会发生这种情况的任何想法？

**新捆绑**

```
 String u = null;
                        Bundle b = new Bundle();
                        Intent i = new Intent(view.getContext(), ******.class);
                        u = api.companyData.link.get(position);
                        Log.d("URL++++++++++++++++++++", u);
                        b.putString("graphic", api.companyData.graphic);
                        b.putString("name", api.companyData.name);
                        b.putString("url", u);
                        i.putExtras(b); 
                        startActivity(i); 
```

日志语句返回的 url 很好。

**收货人**

```
 Bundle extras = getIntent().getExtras();
    if(extras !=null) {
         Log.d("EXTRAS", extras.getString("name")+extras.getString("graphic")+extras.getString("link")); 
```

***D/EXTRAS（4698）：nullnullnull***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T22:59:35.583

将对象直接放入意图中，例如

```
Intent i = new Intent(view.getContext(), ******.class);
i.putExtra("graphic", ...);
i.putExtra("name", ...);
i.putExtra("url", ....); 
```

然后在接收器活动中：

```
getIntent().getStringExtra("graphic");
getIntent().getStringExtra("name");
getIntent().getStringExtra("url"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:02:30.190

我总是这样做：

```
Intent i = new Intent(view.getContext(), ******.class);
i.putExtra("url", u); 
```

进而

```
String url = getIntent().getStringExtra("url"); 
```

我从来没有按照你的方式尝试过，但是如果你[查看 Android 文档](http://developer.android.com/reference/android/content/Intent.html#putExtras%28android.os.Bundle%29)，`putExtras(Bundle)`它会说：

> 向意图添加一组扩展数据。键必须包含包前缀，例如应用程序 com.android.contacts 将使用类似“com.android.contacts.ShowAll”的名称。

你不这样做可能是失败的原因。

# android - 在android中将相机预览拉伸到全屏

> ID：11278253
> 
> 赞同：2
> 
> 时间：2012-06-30T22:50:14.483
> 
> 标签：android, android-layout, android-camera

我正在将此[相机预览](https://github.com/commonsguy/cw-advandroid/tree/master/Camera/Preview/)应用程序用于我的 Android 应用程序。

我想要全屏预览相机。因此，我使用 Android API 中的示例尝试将预览设置为全屏。这就是我尝试这样做的方式：

```
if (!cameraConfigured) {
    Camera.Parameters parameters=camera.getParameters();
    Camera.Size size = getOptimalPreviewSize(mSupportedPreviewSizes, width, height);
    if (size != null) {
        parameters.setPreviewSize(size.width, size.height);

      camera.setParameters(parameters);
      cameraConfigured=true;
    } 
```

我使用相对布局作为我的布局。我的布局设置如下：

```
<android.view.SurfaceView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/preview"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
> 
```

我仍然无法在整个屏幕上预览我的相机。我想知道如何在整个屏幕上预览。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T05:11:31.777

我发现了问题。我在 Android Manifest 文件中添加了以下设置

```
<supports-screens android:largeScreens="true"
                    android:normalScreens="true"
                    android:smallScreens="true" android:xlargeScreens="true"/> 
```

我可以全屏查看相机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T03:49:09.513

我假设您的代码位于扩展 SurfaceView 的类中，并且您将把 surfaceView 放置在与显示器一样大的 FrameLayout 中。

您在代码中没有做的是将 SurfaceView 设置为与以下代码块中的显示相同的大小，这是通过获取布局并设置宽度和高度来完成的。

我使用以下代码拉伸到屏幕的尺寸：

```
public class CameraPreview extends SurfaceView implements SurfaceHolder.Callback {

    ...

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {

      ...

      final DisplayMetrics dm = this.getResources().getDisplayMetrics();
      Camera.Parameters parameters = mCamera.getParameters();
      parameters.setPreviewSize(cameraSize.width, cameraSize.height);
      mCamera.setParameters(parameters);
      //Here you get the SurfaceView layout and subsequently set its width and height
      FrameLayout.LayoutParams frameParams = (FrameLayout.LayoutParams) this.getLayoutParams();
      frameParams.width = LayoutParams.MATCH_PARENT;// dm.widthPixels should also work
      frameParams.height = LayoutParams.MATCH_PARENT;//dm.heightPixels should also work
      this.setLayoutParams(frameParams);
      //And we should have things set now...

      ....

    }

    ...
} 
```

我希望这有帮助。整合的关键部分在那些内部评论之间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-13T08:06:26.963

获取屏幕尺寸

```
DisplayMetrics displayMetrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
int height = displayMetrics.heightPixels;
int width = displayMetrics.widthPixels; 
```

使用这个宽度和高度来获得预览大小。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-02T03:16:00.790

首先，获取显示宽度和高度：

```
 int dw = currentDisplay.getWidth();    // dw == display width
   int dh = currentDisplay.getHeight();   // dh == display height 
```

然后遍历支持的预览尺寸，并在 if (size.width <= dw && size.height <= dh) 中选择最大的那个。当您遇到此 if 语句失败的情况时，请使用先前的值（您可以设置 prevWidth 和 prevHeight 之类的值作为一种快速/简单的方法来退一步……只要记住在测试它们之后设置它们；之后达到大于屏幕尺寸的预览尺寸，只需跳出循环即可。

后来，
--jim

# r - 在多面图中省略没有数据的 x 轴水平并更改条形的宽度

> ID：11278255
> 
> 赞同：5
> 
> 时间：2012-06-30T22:50:42.517
> 
> 标签：r, ggplot2

正如您在下面的数据中看到的，某些刻面变量“items”缺少某些级别的 x 轴变量“type”。例如，“items = 32”没有“type = A”。

我想摆脱与不存在的“类型”相对应的 x 轴上的*空白空间（例如，类型 A 用于 32 个项目的情况）。*

一些数据（“温度”）：

```
 type   items     value
    A      16       6.3
    B      16       8.3
    C      16       7.9
    B      32       7.7
    C      32       8.3
    C      64       7.9 
```

绘图代码：

```
library(ggplot2)
ggplot(temp, aes(x = type, y = value, fill = type)) + 
  geom_bar(stat = "identity") + 
  facet_grid( . ~ items) 
```

[![在此处输入图像描述](../Images/7fa7c7fb2b561a266664bdd64a8e8757.png)](https://i.stack.imgur.com/oYXNm.png)

========================

**编辑：**

根据 Joran 的解决方案，设置`scales = "free_x"`就是做我想做的事。但是，在项目编号 32 和 64 下，条的宽度变得非常大。请帮助我使所有条的宽度均等。

```
ggplot(temp, aes(x = type, y = value, fill = type)) + 
  geom_bar(stat = "identity") + 
  facet_grid( . ~ items, scales = "free_x") 
```

[![在此处输入图像描述](../Images/a1a8d377068bec99f001dc86dbf59344.png)](https://i.stack.imgur.com/ItCIj.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T18:31:09.917

只需按照[joran](https://stackoverflow.com/users/324364/joran)和[Etienne Low-Décarie](https://stackoverflow.com/users/742447/etienne-low-decarie)的指示来结束这个未回答的*老问题。*请为[joran](https://stackoverflow.com/users/324364/joran)和[Etienne Low-Décarie](https://stackoverflow.com/users/742447/etienne-low-decarie)投票。

另外，请注意上面[Roman Luštrik](https://stackoverflow.com/users/322912/roman-lustrik)的宝贵评论“*我希望你有充分的理由这样做。空白空间非常丰富，它让读者知道这些级别的值是 0（这仍然是一个值）*。”

```
# data
temp <- structure(list(type = structure(c(1L, 2L, 3L, 2L, 3L, 3L), .Label = c("A", 
"B", "C"), class = "factor"), items = c(16L, 16L, 16L, 32L, 32L, 
64L), value = c(6.3, 8.3, 7.9, 7.7, 8.3, 7.9)), .Names = c("type", 
"items", "value"), class = "data.frame", row.names = c(NA, -6L
))

# plot
library(ggplot2)
ggplot(temp, aes(type, value, fill = type)) + 
  geom_bar(stat = "identity") + 
  facet_grid( . ~ items, scales = "free_x", space = "free") 
```

[![在此处输入图像描述](../Images/8a2334cf53069143e128b57f2eae8660.png)](https://i.stack.imgur.com/1MhUR.png)

# javascript - jquery窗口宽度条件

> ID：11278267
> 
> 赞同：-1
> 
> 时间：2012-06-30T22:53:31.507
> 
> 标签：javascript, jquery, css

稍后编辑：我试过这个：

```
$(document).ready(function() {
if ( $(window).width() > 800 ) {
    $("#header").hide();
}
else {
$("#header").show();
}

}); 
```

如果我将窗口大小调整到 800 以下，标题仍然不可见。问题是什么 ？我不能使用 css 媒体查询，因为我想在窗口大于 800 时执行其他功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:36:53.687

If you want to do this in Javascript with JQuery, you'll probably want to know a couple things: what's the width right now, and what's the width after the user resizes? You'll probably have code that looks something like this:

```
function checkSize(){
  if ( $(window).width() > 1200 ){
    //do whatever
  }
}

//When the page is loaded
$(document).ready(function(){
  //Add a listener to check the size of the document when you load
  $(document).resize(checkSize);

  //Check the size now.
  checkSize();
}); 
```

Alternatively, you can use CSS Media queries to adjust the CSS when the page is a certain size, but it won't execute any Javascript. Here's an example:

```
@media all and (max-width: 1199px) {
  #header{
    display:none;
  }
} 
```

This has some more helpful examples and explanations: [http://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

# http - 适当的用户代理标头值

> ID：11278286
> 
> 赞同：0
> 
> 时间：2012-06-30T22:57:03.277
> 
> 标签：http, last.fm

我正在使用 HttpBuilder（基于 apache 的 httpclient 构建的 Groovy HTTP 库）向 last.fm API 发送请求。此 API 的文档说您应该将`user-agent`标头设置为“适当的”，以减少被阻止的机会。

知道什么样的价值观会被认为是合适的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-23T10:48:28.907

我为 Last.fm 工作。“适当”是指在我们查看日志时能够以对我们有用的方式识别您的应用的内容。我们何时使用此信息的示例：

*   调查错误或奇怪的行为；例如，如果您发现了我们无法处理的边缘情况，或者意外导致系统负载异常
*   调查我们认为不恰当的行为；我们可能希望与您取得联系，以帮助您的应用程序更好地使用我们的服务
*   我们可能会使用这些信息来判断使用了哪些 API 方法、使用频率以及由谁使用，以便进行容量规划或获取 API 生态系统的一般统计数据。

一个有用的（适当的）用户代理：

*   告诉我们您的应用程序的名称和版本（最好是独特且易于在 Google 上找到的内容！）
*   告诉我们您的应用程序的具体版本
*   还可能包含一个 URL 以了解更多信息，例如您的应用程序的主页

无用（不适当）用户代理的示例：

*   与任何流行的网络浏览器相同
*   您的 HTTP 客户端库的默认用户代理（例如`curl/7.10.6`或`PEAR HTTP_Request`）

我们知道，当您的应用程序基于浏览器（例如 Javascript 或 Flash）时，无法更改发送的 User-Agent，并且不希望您这样做。（在您的情况下，这应该不是问题。）

如果您使用的是第 3 方 Last.fm API 库，例如[http://www.last.fm/api/downloads](http://www.last.fm/api/downloads)中列出的库之一，那么如果您向用户添加额外信息，我们将更喜欢它 -识别您的应用程序的代理，但也将库名称和版本留在那里。这在跟踪错误（在我们的服务或客户端库中）时非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:02:17.300

您的应用程序的名称，包括版本号？

# python - SQLAlchemy 按分钟分组

> ID：11278287
> 
> 赞同：3
> 
> 时间：2012-06-30T22:57:15.100
> 
> 标签：python, mysql, sql, orm, sqlalchemy

该任务是将日期时间值（使用 SQLAlchemy）分组到每分钟点（按分钟分组）。

我有一个自定义 SQL 查询：

```
SELECT COUNT(*) AS point_value, MAX(time) as time
  FROM `Downloads` 
  LEFT JOIN Mirror ON Downloads.mirror = Mirror.id 
 WHERE Mirror.domain_name = 'localhost.local' 
   AND `time` BETWEEN '2012-06-30 00:29:00' AND '2012-07-01 00:29:00'
 GROUP BY DAYOFYEAR( time ) , ( 60 * HOUR( time ) + MINUTE(time ))
 ORDER BY time ASC 
```

它工作得很好，但现在我已经在 SQLAlchemy 中做到了。这就是我现在所拥有的（按年份分组只是一个例子）：

```
rows = (DBSession.query(func.count(Download.id), func.max(Download.time)).
    filter(Download.time >= fromInterval).
    filter(Download.time <= untilInterval).
    join(Mirror,Download.mirror==Mirror.id).
    group_by(func.year(Download.time)).
    order_by(Download.time)
) 
```

它给了我这个 SQL：

```
SELECT count("Downloads".id) AS count_1, max("Downloads".time) AS max_1 
FROM "Downloads" JOIN "Mirror" ON "Downloads".mirror = "Mirror".id 
WHERE "Downloads".time >= :time_1 AND "Downloads".time <= :time_2 
GROUP BY year("Downloads".time) 
ORDER BY "Downloads".time 
```

如您所见，它只缺少正确的分组：

```
GROUP BY DAYOFYEAR( time ) , ( 60 * HOUR( time ) + MINUTE(time )) 
```

SQLAlchemy 有按分钟分组的功能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T10:48:44.007

您可以通过[Functions](http://docs.sqlalchemy.org/en/rel_0_7/core/tutorial.html#functions)使用 SA 中的任何 SQL 端函数，您已经在该`YEAR`部分中使用了该函数。我认为在您的情况下，您只需要添加（*未测试*）：

```
from sqlalchemy.sql import func
...
# add another group_by to your existing query:
rows = ...
group_by(func.year(Download.time), 
         60 * func.HOUR(Download.time) + func.MINUTE(Download.time)
) 
```

# ios - FB 应用程序和 FB Messenger 之间的连接

> ID：11278288
> 
> 赞同：0
> 
> 时间：2012-06-30T22:57:28.907
> 
> 标签：ios, facebook, sandbox

我的问题很简单，FB messenger 如何知道谁与另一个 FB 应用程序连接，我的意思是在 ios 中，应用程序使用 sandBox，但是当您在“普通”应用程序中连接为“xy”并打开它询问的信使时如果你是xy，你呢？如果您断开与“正常”应用程序的连接并再次打开另一个应用程序，它会要求您连接。这些应用程序是如何连接在一起的？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T18:06:52.633

来自同一个开发者的两个应用可以访问同一个钥匙串组。

> 共享钥匙串访问的主要先决条件是所有应用程序都有一个共同的捆绑种子 ID。

例如，可以在[此处](http://useyourloaf.com/blog/2010/04/03/keychain-group-access.html)找到更多信息。

# php - 突然，我收到一个致命错误：无法重新声明

> ID：11278289
> 
> 赞同：0
> 
> 时间：2012-06-30T22:57:46.667
> 
> 标签：php

我在一段以前可以完美运行的代码上遇到一个奇怪的错误，但突然开始推出错误......

这是相关的代码：

```
function cmp($a, $b) {
if ($a == $b) {
    return 0;
}
return ($a < $b) ? -1 : 1;
}

function getFileList($dir)
{
   // array to hold return value
$retval = array();

// add trailing slash if missing
if(substr($dir, -1) != "/") $dir .= "/";

// open pointer to directory and read list of files
$d = @dir($dir) or die("getFileList: Failed opening directory $dir for reading");
while(false !== ($entry = $d->read())) {
  // skip hidden files
  if($entry[0] == ".") continue;
  if(is_dir("$dir$entry")) {
    $retval[] = array(
      "name" => "$dir$entry/",
      "type" => filetype("$dir$entry"),
      "size" => 0,
      "lastmod" => filemtime("$dir$entry")
    );
  } elseif(is_readable("$dir$entry")) {
    $retval[] = array(
      "name" => "$dir$entry",
      "type" => mime_content_type("$dir$entry"),
      "size" => filesize("$dir$entry"),
      "lastmod" => filemtime("$dir$entry")
    );
  }
}
$d->close();

uasort($retval, 'cmp');
return $retval;
} 
```

我得到的错误是：

致命错误：无法在 /store/cpanel/home/martinak/public_html/modules/mod_supersized/mod_supersized 中重新声明 cmp()（之前在 /store/cpanel/home/martinak/public_html/modules/mod_supersized/mod_supersized.php:3 中声明） .php 在第 8 行

现在，如错误中所述，上面的代码确实从第 3 行开始，但第 8 行仅包含“}”。

如前所述，代码过去可以工作，它没有改变，几个月后才停止工作。会不会是服务器配置问题？有任何想法吗？

谢谢！S。

更新：

我很抱歉，伙计们。我刚刚意识到我的客户弄乱了我的代码。我讨厌人们在没有知识的情况下试图解决问题，然后当他们把事情搞砸时哭着求助。

很抱歉浪费了你的时间，希望你能原谅我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:01:38.760

看起来你已经包含了这个文件两次。只需从`require()`/切换`include()`到`require_once()`/ `include_once()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:00:27.477

您正在定义 cmp() 函数两次（或更多）次。也许你不止一次地包含了这段代码......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T23:01:04.007

也许您`require`在其他文件中使用并且已经存在 cmp 功能

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-30T23:01:36.947

唯一可能的解释是您多次包含同一个文件。将您的 include 或 require 更改为 include_once 和 require_once。

# php - 直接在浏览器中使用 jquery/flash 从网络摄像头录制视频？

> ID：11278293
> 
> 赞同：5
> 
> 时间：2012-06-30T22:58:29.163
> 
> 标签：php, jquery, flash, video, webcam

我想让用户通过网络摄像头录制视频，然后通过浏览器将录制的视频上传到网站。

这是一个完全符合我希望我的网站工作的示例，除了它似乎不捕获视频，只是图像。

[http://www.xarg.org/project/jquery-webcam-plugin/](http://www.xarg.org/project/jquery-webcam-plugin/)

请让我知道是否有一种方法可以自定义它，或者是否有其他东西可以使用。

我想要一些独立的东西，不想依赖另一个服务来完成这个。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T18:13:05.767

我们一直在寻找同样的东西，但根据我的研究，如果没有后端帮助，似乎没有办法严格通过 jquery 和 Flash 来完成。

我发现了三个选项：

1.  Adobe Flash 媒体服务器
2.  Wowza 媒体服务器
3.  Red5 媒体服务器

三者各有优劣。Flash 和 Wowza 不是免费的，但有很好的文档和支持。Red5 是免费的，但可能缺少文档，具体取决于您在做什么。

我们刚刚为 Wowza 注册了一个 180 天的免费开发者许可证，目前正在评估它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:46:45.293

[HaxeVideo](http://code.google.com/p/haxevideo/)是一个完全使用 Haxe 编程语言编写的多线程 FLV 流媒体服务器。

和这个链接获取[Haxe 编程语言](http://haxe.org/)的信息。

但我为我找到了一个简单的出路。我有 2 个选项供您选择。

1.  youtube api（免费）[https://developers.google.com/youtube/youtube_upload_widget](https://developers.google.com/youtube/youtube_upload_widget)

2.  [http://nimbb.com/](http://nimbb.com/)（不是免费的）

但是如果你想试试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-15T10:19:25.320

查看[http://hdfvr.com](http://hdfvr.com)。它是用 Flash 开发的商业视频录制解决方案。它可以录制到 .flv 和 .mp4 文件，当与 Wowza 和 Wowza 转码器一起使用时，它可以录制带有 AAC 音频和 H.264 视频的 MP4 文件。

它适用于最佳答案中的所有 3 个媒体服务器：Adobe Media Server、Wowza Media Server 和 Red5 Media Server。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-28T11:49:42.420

您最好使用第三方工具，如 red5 或 wowza。我已经用 php 实现了 wowza。您可以查看[http://www.wowza.com/streaming/record](http://www.wowza.com/streaming/record)。它很容易实现，视频录制又好又快。但它不是免费的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-26T11:38:15.950

对于更多读者来说，这可能是一个很好的有用资源。[点击这里](https://github.com/streamproc/MediaStreamRecorder)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-29T11:39:39.643

考虑到价格/文档和可靠性比，Wowza 似乎是一个很好的录音解决方案。许多用户在尝试使用 Red5 录制时报告了损坏的视频。

Wowza Streaming Engine 论坛中提到的这个解决方案适用于最新的 Wowza 服务器。 [http://www.wowza.com/forums/showthread.php?35683-Webcam-Video-Recorder-for-PHP-scripts](http://www.wowza.com/forums/showthread.php?35683-Webcam-Video-Recorder-for-PHP-scripts)

它是免费下载和试用的，因此它可能是测试您的设置和启动此类项目的好方法。

# jquery-mobile - JQuery Mobile，整个网站的一个页脚片段

> ID：11278306
> 
> 赞同：2
> 
> 时间：2012-06-30T23:01:38.320
> 
> 标签：jquery-mobile, footer, reusability

我**不是**在问如何获得固定的页脚。

我有一个多页和单页的结构。我想知道如何为整个网站只使用一个 html 片段。我真的在寻找解决方案，因为我只想在一个地方编辑页脚并在所有页面中查看修改。

谢谢。

编辑：我正在开发一个用PhoneGap 包装的移动应用程序，所以我正在寻找客户端解决方案。

解决方案（将@maco 的解决方案汇总并根据我的情况进行调整）：

```
$(function() {
// load the templates
$('body').append('<div id="module"></div>');
$('#module').load('templates/module.html :jqmData(role="page")',function() {

    // save the actual footer and header
    var hdhtml = $('#module :jqmData(role="header")').clone();
    var fthtml = $('#module :jqmData(role="footer")').clone();

    // removes the header/footer
    $(':jqmData(role="header")').remove();
    $(':jqmData(role="footer")').remove();

    // load at the correct place the header/footer
    $(':jqmData(role="page")').prepend(hdhtml).append(fthtml).page().trigger('pagecreate');

    // delete the temporary div
    $($(this).html()).replaceAll(this).attr('id', 'module');
});

// set the class "ui-btn-active" for the active page
$(document).live('pagecreate', function() {
    // get the current page
    var currentPage = window.location.pathname;
    currentPage = currentPage.substring(currentPage.lastIndexOf("/") + 1, currentPage.length).split("&")[0];

    // remove the class from the footer
    $($.mobile.activePage + ':jqmData(role="footer") li a')
            .removeClass('ui-btn-active ui-state-persist');

    // add the class to the link that points to the particular href
     $($.mobile.activePage + ':jqmData(role="footer") li a[href="' + currentPage + '"]').addClass('ui-btn-active ui-state-persist');

});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T14:52:53.910

模块.html

```
<!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
        <div data-role="page">
            <div data-role="header">
                <h1>module header</h1>
            </div>
            <div data-role="footer" class="ui-bar">
                <h3>module footer</h3>
            </div>
        </div>
    </body>
</html> 
```

module.js（在所有页面中加载）

```
function module() {
    var fthtml = $('#module :jqmData(role="footer")').clone();
    $(':jqmData(role="footer")').remove();
    $(':jqmData(role="page")').append(fthtml).page().trigger('pagecreate');
}

$(function(){
    $('body').append('<div id="module"></div>');
    $('#module').load('YOUR_module.html_PATH :jqmData(role="page")',function(){
        $($(this).html()).replaceAll(this).attr('id','module');
        module();
    });
    $(':jqmData(role="page")').live('pageinit',module);
}); 
```

**YOUR_module.html_PATH** （例如“../module.html”、“../module/module.html”）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T06:21:35.277

如果您在服务器端生成 HTML 页面，您可以使用您的服务器语言（php、java、node）模板功能从通用文件中插入 HTML。

即对于jsp

```
 </div>
    <jsp:include page="scripts/footer.jsp" />
    .....
</body> 
```

如果你在 javascript 中做繁重的工作，而不是使用任何 javascript 模板引擎。即[http://handlebarsjs.com/](http://handlebarsjs.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T15:46:49.913

我通过创建部分页脚视图并在需要的地方调用它来解决这个问题：`@Html.Partial("Footer")`

# javascript - Javascript中的@符号是什么？

> ID：11278308
> 
> 赞同：10
> 
> 时间：2012-06-30T23:01:44.823
> 
> 标签：javascript

我偶然发现了[https://codereview.stackexchange.com/questions/10610/refactoring-javascript-into-pure-functions-to-make-code-more-readable-and-mainta](https://codereview.stackexchange.com/questions/10610/refactoring-javascript-into-pure-functions-to-make-code-more-readable-and-mainta)，我不明白答案，因为用户以我从未见过的方式使用 @ 符号。当附加到 if 关键字时它会做什么？你能把它附加到其他关键字上吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-30T23:03:02.270

这不是 JavaScript 的东西。这是答案所指的任何模板系统使用的符号。请注意，该`<script>`元素具有 type `text/html`，这将阻止浏览器注意其内容。

其他一些 JavaScript 代码会找到该脚本并获取它`innerHTML`，以便将模板与一些数据合并以创建......无论该模板做什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T23:08:54.513

@: Razor 中的语法

@StriplingWarrior 在[在 JavaScript 中使用 Razor时说](https://stackoverflow.com/questions/4599169/using-razor-within-javascript)

这是 razor 代码，而不是 javascript，如果您对 razor 检查感兴趣： [http ://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx](http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx)

# php - 查询 SQL 并格式化为 CSV 的有效方法

> ID：11278309
> 
> 赞同：0
> 
> 时间：2012-06-30T23:01:49.537
> 
> 标签：php, mysql

我有一个 MySQL 数据库，我正在保存来自几个不同传感器的温度读数。我最初考虑使用三个不同的表来存储我的数据：

```
mysql> select * from sensor_info;
+----+------------------+------+--------+
| id | address          | name | active |
+----+------------------+------+--------+
|  1 | 28D684CD02000057 | NULL |      1 |
|  2 | 28099B49030000D8 | NULL |      1 |
|  3 | 28339ACD0200004B | NULL |      1 |
+----+------------------+------+--------+

mysql> select * from data_period limit 4;
+----+---------------------+
| id | ts                  |
+----+---------------------+
|  1 | 2012-06-30 09:35:02 |
|  2 | 2012-06-30 09:36:22 |
|  3 | 2012-06-30 09:37:46 |
|  4 | 2012-06-30 09:40:36 |
+----+---------------------+

mysql> select * from data_points limit 4;
+----+-------------+-----------+-------+
| id | data_period | sensor_id | data  |
+----+-------------+-----------+-------+
|  1 |           1 |         1 | 77.90 |
|  2 |           1 |         2 | 77.34 |
|  3 |           1 |         3 | 77.56 |
|  4 |           2 |         1 | 78.01 |
+----+-------------+-----------+-------+ 
```

我正在尝试做的是获取我存储的数据并将其放入 CSV 文件中，以便我可以使用[dygraphs Javascript library](http://dygraphs.com/index.html)显示它。我需要把我的数据变成这样的格式：

```
date,temp1,temp2,temp3
2012-06-30 09:35:02,77.90,77.34,77.56
2012-06-30 09:36:22,78.01,77.36,77.59
.... 
```

我开始执行此操作的每一种方式（使用 PHP），我似乎都让这变得过于复杂，并且必须将查询放在循环内的循环内。我是否让自己变得比我需要的更难？

大部分工作是使用查询还是使用 PHP 完成？以后，如果特定时间戳中缺少温度读数，我还想添加将 NULL 放入 CSV 的代码。

我不是在寻找一个非常具体的答案，我只是想知道我应该往哪个方向走。我什至不知道如何开始格式化数据库中的数据，或者我是否应该尝试使用不同的格式将我的信息存储在数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:13:48.237

我会运行一个单一的选择查询来将很多东西连接在一起。您可以在可能没有数据的地方使用外连接。

```
SELECT data_period.ts AS date, dp1.data AS temp1, dp2.data AS temp2, dp3.data AS temp3
FROM data_period
LEFT OUTER JOIN data_points AS dp1 ON dp1.data_period=data_period.id AND dp1.sensor_id=1
LEFT OUTER JOIN data_points AS dp2 ON dp2.data_period=data_period.id AND dp2.sensor_id=2
LEFT OUTER JOIN data_points AS dp3 ON dp3.data_period=data_period.id AND dp3.sensor_id=3 
```

（参见：[SQL Fiddle 示例](http://sqlfiddle.com/#!3/eb21f/1)）

这应该为您提供一组结果，您可以循环访问这些结果。

如果您真的希望 MySQL 完成大部分工作，您可以将第一行更改为（我认为） SELECT data_period.ts +','+ IFNULL(dp1.data,'NULL') +','+ IFNULL(dp2 .data,'NULL') +','+ IFNULL(dp3.data,'NULL')

综合评论和答案并将其保存到文件中：

```
SELECT data_period.ts AS date, dp1.data AS temp1, dp2.data AS temp2, dp3.data AS temp3
INTO OUTFILE '/home/user/output.csv'
FIELDS TERMINATED BY ','
OPTIONALLY ENCLOSED BY '"'
ESCAPED BY '\\'
LINES TERMINATED BY '\n'
FROM data_period LEFT OUTER JOIN data_points AS dp1 ON dp1.data_period=data_period.id      
AND dp1.sensor_id=1 LEFT OUTER JOIN data_points AS dp2 ON  
dp2.data_period=data_period.id   AND dp2.sensor_id=2 LEFT OUTER JOIN data_points AS dp3 
ON dp3.data_period=data_period.id AND dp3.sensor_id=3; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:43:28.177

为此，您可以使用两个 SQL 语句，给出一个外循环和一个内循环。第一个声明

```
select  ts from data_points as point 
inner join data_period on data_period = data_period.id 
group by ts 
order by ts 
```

将获得您有数据的日期列表。

内部循环中的第二个将获得按传感器 ID 排序的数据值列表 - 如果您在 data_points 中有缺失值，那么该列表将是错误的并且有间隙；因此，如果您确实有差距，您可能需要执行额外的步骤来获取传感器列表，然后从查询返回的数据中填充此列表。

以下示例说明了如何继续此操作。

```
// get the outer list
$sql = "select  ts from data_points as point 
        inner join data_period on data_period=data_period.id 
        group by ts 
        order by ts";

$result = mysql_query($sql);

$result || die(mysql_error());

while($row = mysql_fetch_row($result))
{
    // get the date for the second query
    $date = $row[0];

    $sql = "select  data from data_points as point
            inner join data_period on data_period=data_period.id
            inner join sensor_info on sensor_id = sensor_info .id
            where ts = '$date'
            order by sensor_id";

    $result_1 = mysql_query($sql);

    // now create an array from the values - we could use mysql_fetch_array to do this
    // but this way allows us the possibility of extending the processing to 
    // take into account missing values.
    $vals = array();
    while($row_1 = mysql_fetch_row($result_1)) {
        $vals[]=$row_1[0];
    }
    print "$date,".join(",",$vals)."\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:45:18.850

我建议事后只在 php 中进行 csv 格式设置。

这是我在网上找到并且非常喜欢使用的一个方便的功能。如果您将 SQL 调用包装在一个类中，那么您可以在查询后使用此方法。:)

注意我将它修改为我的 MSSQL，但很容易用 mysql 替换它。

```
 public final function SQL2CSV() {
        // set initial .csv file contents
        $CSV = array();
        $rowid = 0;
        //This would be your query.
        $res = $this->fetchQuery();

        // get column captions and enclose them in doublequotes (") if $print_captions is not set to false
            for ($i = 0; $i < mssql_num_fields($res); $i++) {
                $fld = mssql_fetch_field($res, $i);
                $colnames[] = $fld->name;
            }
            // insert column captions at the beginning of .csv file
            $CSV[$rowid] = implode(",", $colnames);

        // iterate through each row
        // replace single double-quotes with double double-quotes
        // and add values to .csv file contents
        if (mssql_num_rows($res) > 0) {
            while ($row = mssql_fetch_array($res, MSSQL_NUM)) {
                $rowid++;
                for ($i = 0; $i < sizeof($row); $i++)
                    //$row[$i] = '"'.str_replace('"', '""', $row[$i]).'"';
                    $row = str_replace (',', '', $row);

                $CSV[$rowid] = "\n".implode(",", $row);

            }
        }

        RETURN $CSV;
    } 
```

# php - 对于每个结果，添加/组合一个结果 MySql

> ID：11278317
> 
> 赞同：0
> 
> 时间：2012-06-30T23:03:08.820
> 
> 标签：php, mysql, arrays, add

我可以使用此工作查询获得以下结果：

```
$query = "SELECT tt.time_start, tt.time_end
FROM track_time as tt, project_track as pt, project_clients as pc, clients as cl
WHERE tt.track_id = pt.track_id
AND pt.project_id = pc.project_id
AND pc.client_id = cl.client_id
AND cl.client_id =".$db->prep($client_id);
$res = $db->query($query,'assoc');

**RESULTS**
time_start  time_end    client_id
1340927940  1340928420  1
1341066240  1341077040  1
1341086400  1341088560  1
1340954400  1340986800  7 
```

我要**为每个客户**实现的目标是将它们的所有**time_start**值相加得到一个结果，将它们的所有**time_end**值相加得到一个结果，然后得到这两个结果之间的差异。这将使我能够确定每个客户的总数。

我正在使用 PHP 并尝试所有的 foreach 方式，但没有运气和不正确的数组返回。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:21:54.387

试试这个：

```
$query = "SELECT pc.client_id, 
                 (SUM(tt.time_start) - SUM(tt.time_end)) as `Difference`
          FROM  track_time as tt, project_track as pt, 
                project_clients as pc, clients as cl
          WHERE tt.track_id = pt.track_id
                    AND pt.project_id = pc.project_id
                    AND pc.client_id = cl.client_id
                    AND cl.client_id =" . $db->prep($client_id) . " 
          GROUP BY client_id"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:14:45.227

`time_start`并且`time_end`似乎是时间戳值。所以 ;

```
$total = 0;
foreach( $array as $item)
{
     $total += strtotime( $item['time_start']);
} 
```

在那之后，如果你`date()`以有意的格式运行一个函数，我认为它应该可以正常工作。

# haskell - Haskell 比较所有列表项

> ID：11278318
> 
> 赞同：0
> 
> 时间：2012-06-30T23:03:14.310
> 
> 标签：haskell, functional-programming

编辑：很难描述我想要做什么，但这里有一个尝试（来自评论）：

我正在构建一个 wordfeud 求解器，所以我有一个单词和一些字母（都是字符列表）。我将此（[如何在 Haskell 中查找字符串中字符的频率？](https://stackoverflow.com/questions/7108559/how-to-find-the-frequency-of-characters-in-a-string-in-haskell)）应用于两个列表以获取所有字母的频率。我现在正在做的是遍历“单词”字符列表，并检查所有字符是否在“字母”字符列表中充分出现。

我编写了一个 Haskell 函数，它通过将函数应用于两个列表的项目并比较结果来比较两个列表。

比较是这样进行的：

```
hasLetters' :: [Char] -> [Char] -> Bool
hasLetters' word letters = (getCharOccurrence (head word) (getCharOccurrences word)) <= (getCharOccurrence (head word) (getCharOccurrences letters)) 
```

这仅比较单词第一个字母的出现次数。但是应该比较所有单词（并且所有单词的结果都应该是 TRUE）。

我真的不知道如何做到这一点。我找到了让我定义谓词的“全部”方法，这非常好。它看起来像这样：

```
all (<= (getCharOccurrence (head word) (getCharOccurrences letters))) 
```

（我认为这是正确的）它确保进入列表的每个项目都小于或等于提供的函数的结果。

但是：'all' 方法需要另一个参数。这将是定义应该与谓词进行比较的“源”参数。当这只是一个列表时，这很容易，然后我会做这样的事情：

```
all (<= (getCharOccurrence (head word) (getCharOccurrences letters))) [0..10] 
```

但问题是：我没有这样的结果列表，我需要将其与以下结果进行比较：

```
(getCharOccurrence (head word) (getCharOccurrences letters)) 
```

我想我可以使用“map”函数将此函数应用于“word”字符列表中的每个字符，但我不知道如何使用它。我是这样开始的：

```
map (getCharOccurrence (head word) (getCharOccurrences word)) word 
```

但这是错误的。

所以我（认为我）需要的是：将上述函数应用于“单词”字符列表的所有字符，并将其与谓词进行比较。

但也许我只是想错了。我是一个绝对的 Haskell/函数式编程新手。请帮帮我:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T03:01:36.137

使用[多集](http://hackage.haskell.org/packages/archive/multiset/0.2.1/doc/html/Data-MultiSet.html)包：

```
import Data.MultiSet
compareAll as bs = fromList as `isSubsetOf` fromList bs 
```

或者：

```
import Data.Function
import Data.MultiSet
compareAll = isSubsetOf `on` fromList 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:15:10.850

因此，据我了解，您有一个`word`包含您想要形成的单词的字符串和一个`letters`代表您可以使用的瓷砖的字符列表。您想检查单词是否由瓷砖组成。

在这里，我假设您提到的功能具有类型

```
getCharOccurrence :: Char -> [(Char, Integer)] -> Integer
getCharOccurrences :: [Char] -> [(Char, Integer)] 
```

首先，您需要修改`hasLetters'`以采用 Char 参数而不是使用`head word`：

```
hasLetters' :: Char -> [Char] -> [Char] -> Bool
hasLetters' c word letters = (getCharOccurrence c (getCharOccurrences word)) <= (getCharOccurrence c (getCharOccurrences letters)) 
```

然后你可以将上面的内容结合到一个主函数（让我们称之为`sufficientTiles`）

```
sufficientTiles :: [Char] -> [Char] -> Bool
sufficientTiles word letters = and $ map (\c -> hasLetters' c word letters) word 
```

我们在这里所做的是将`hasLetter'`函数映射到`word`. 这将为我们提供一个布尔列表。然后我们使用`and`来检查该列表的所有元素是否为`True`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-30T23:49:56.223

所以我想我理解你想比较两个列表。如果第二个列表的每个元素至少与第一个列表一样多，则测试通过。因此，您需要一个至少相等的约束，但顺序会有所帮助。

有很多解决方案，首先想到的是对每个列表进行排序，对唯一元素进行分组和计数，并确保所有结果都是`<=`：

```
someCompare a b = let op :: String -> [(Char,Int)]
                      op = map (head &&& length) . group . sort
                  in [c <= k | (x,c) <- op a, k <- maybeToList (lookup x (op b))] 
```

或者您可以使用计数器映射并将两个映射合并：

```
someCompare2 a b =
        let op = foldl' (\m c -> Map.insertWith (+) c 1 m) Map.empty
        in all (<= 0) . Map.elems $ Map.unionWith (+) (op a) (Map.map negate $ op b) 
```

等等等等。

# android - 导入项目给 Unable to resolve target 'android-7'

> ID：11278319
> 
> 赞同：9
> 
> 时间：2012-06-30T23:03:17.177
> 
> 标签：android, eclipse, api, sdk

这个应用程序是我大约一年前完成的（！），但从未在市场上推出过。我现在正在尝试在 Eclipse 中打开它，以进行一些小的修改并稍微处理代码。所以我导入了它，然后发现这个奇怪的“无法解析目标”错误。它突出显示了我所有“src”文件中的每个类红色。

我看过一个类似的问题，说要将该行添加到 default.properties 文件中。我的项目有一个 project.properties 文件，其中包含以下内容：

```
target=android-7 
```

任何建议如何让它工作？我总是可以开始一个新项目并复制所有的 src 文件，但这会很蹩脚且浪费时间。

还有一条评论 - 我正在一台新计算机上开发，但我认为我没有 API 级别 7。这可能是问题吗？我进入了 Window --> Android SDK Manager，它显示的最旧的可用 API 是第 8 级。但第 7 级意味着我可以针对更多设备，所以我想使用它。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-30T23:19:26.517

嗯，是的，那是你的问题。您没有下载 API 级别 7。您可以右键单击该项目并转到属性-> android 并选择另一个可用的 API。只要您不更改清单中的 min sdk 版本，您仍然可以像以前一样定位尽可能多的设备。

```
<uses-sdk android:minSdkVersion="7"/> 
```

**更新**

您不必这样做，但您可以在[SDK 存档页面上获取较旧的 API](http://developer.android.com/sdk/older_releases.html)

我不知道下一个声明是否有任何官方来源，但这是我在工作时发现的。如果有人可以用更好的答案完成此任务，我将不胜感激。

只要您不使用任何与之前版本不兼容的代码，您就可以使用更新的 SDK 版本编译代码。

例子：

我希望我的应用可用于 API 级别 7。但我只安装了 API 级别 15。只要我在 Manifest 中保留 minSdkVersion="7" 并且不使用以前 API 中不可用的任何资源，该应用程序就可以在我的目标设备上正常运行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-14T16:36:32.290

对于任何想要针对不是最新的 API 级别测试他们的项目的人，您可以使用 SDK 管理器来安装旧的 SDK：

在 Eclipse 中（安装了 adt）：

![在此处输入图像描述](../Images/4b4b8e4e0d41b080addf56977d19d258.png)

SDK 管理器：

![在此处输入图像描述](../Images/69a3253c06daffb3e65e88b0aa76cc10.png)

只需选中要用于测试项目的 SDK 框，然后单击安装。您还可以删除不使用的 API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-02T12:14:06.777

然后右键单击您的项目：

**属性 -> Android -> 项目构建目标 -> 检查 Android 4.1.2**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T10:54:24.977

在应用程序的 manifest.xml 文件中添加此标记

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="8" /> 
```

它对我有用。尝试一下。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-12T13:32:38.900

我通过将我的 project.properties 文件
从：编辑`target=android-7`
到：解决了这个问题`target=android-19`。

我还更改了清单文件中的目标 sdk 版本：
`android:targetSdkVersion="19"`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-14T13:34:25.503

是的。我在自己的项目中将android support v7项目作为库项目导入时看到同样的问题，eclipse说无法解析android16，我发现是eclipse的问题，你可以右键单击你的项目有这个问题，然后选择属性，Android窗格，那里有一个Project Build Target窗格，你可以很容易地看到它，选择一个标准的android平台，如Android4.3，而不是其他以Google API开头的平台，我希望这会帮你！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-09T05:04:17.720

1.  检查 AndroidManifest.xml 中的 android:minSdkVersion=

2.  如果您使用 Eclipse IDE，请更新 project.properties 中的 target=android-

# ruby-on-rails - RSpec Capybara have_selector 测试不工作

> ID：11278320
> 
> 赞同：0
> 
> 时间：2012-06-30T23:03:40.820
> 
> 标签：ruby-on-rails, rspec, capybara

我有一个非常简单的 RSpec Capybara have_selector() 似乎没有工作，我不知道为什么......但可能很简单。

这是 RSpec 请求测试：

```
describe 'with valid information'
  let(:user) { FactoryGirl.create(:user) }
  before do
    fill_in 'Email', with: user.email
    fill_in 'Password, with: user.password
    click_button 'Login'
  end
  it { should have_selector('p', text: user.first_name) }
  ...
end 
```

在`new.html.erb`会话中，我只有这样的东西：

```
<% if logged_in? %>
  <p><%= current_user.first_name %></p>
<% else %>
  <%= form_for(:session, url: sessions_path) do |f| %>
  ...
<% end %> 
```

登录表单`session#new`在浏览器中完美运行。我可以很好地登录，并且能够查看`p`标签中的名字。问题似乎是水豚部分，因为`it`检查`h1`页面上标签的其他测试（无论是否登录都存在）工作正常。

有谁知道是什么问题？

提前感谢您的帮助！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T10:41:54.890

您的登录很可能由于某种原因而失败。

将您的测试更改为如下所示：

```
it "should show me my first name" do
  save_and_open_page
  should have_selector('p', text: user.first_name)
end 
```

这将打开您的浏览器并向您显示测试浏览器当前看到的页面。（您可能需要将`launchy`gem 添加到您的 Gemfile 中。）

还有一些其他的诊断可以帮助，例如，添加一个测试或一个`puts`检查你登陆的页面，例如：

```
it "redirects to the home page after log in" do
  current_path.should == root_path
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T10:48:08.000

```
fill_in 'Password, with: user.password 
```

not like that. You should use this line,

```
fill_in 'Password', with: user.password 
```

# jquery - 如何用单击的对象的父对象定义条件？

> ID：11278326
> 
> 赞同：0
> 
> 时间：2012-06-30T23:05:29.753
> 
> 标签：jquery, click, parent

我无法访问单击的对象（此）父类..单击相同的元素和不同的返回？

[这是演示](http://jsfiddle.net/Aw39W/10/)

HTML

```
<div class="rows row1">
  <div class="ele">1</div>
  <div class="ele">1</div>
  <div class="ele">1</div>
</div>

<div class="rows row2">
  <div class="ele">2</div>
  <div class="ele">2</div>
  <div class="ele">2</div>
</div> 
```

jQuery

```
$('.ele').click(function() {

  if ( $(this).parent().hasClass('r1') ) {//way1
    alert('you clicked 1st row element');
  }

  else if ( $(this).parent().hasClass('r2') === true ) {//both way wont work
    alert('you clicked 2nd row element');
  }

}); 
```

​</p>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T23:07:07.993

因为父母双方都没有`r1`or`r2`班级，所以应该是`row1`and `row2`：

```
$('.ele').click(function() {

  if ( $(this).parent().hasClass('row1') ) {
    alert('you clicked 1st row element');
  }

  else if ( $(this).parent().hasClass('row2')) {
    alert('you clicked 2nd row element');
  }

}); 
```

[**演示在这里**](http://jsfiddle.net/Aw39W/18/)

# android - 在文本视图中添加链接并在导航器上打开此链接

> ID：11278327
> 
> 赞同：-1
> 
> 时间：2012-06-30T23:05:46.523
> 
> 标签：android, hyperlink, textview

我从我的 ressource strings.xml 中获取一个字符串并将该字符串放入 TextView 中。

在 strings.xml 中：

```
<string name="description">Hello please look into <a href="http://www.webtour.dk">www.webtour.dk</a></string> 
```

在 main.xml 中：

```
<TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/description"
                android:textSize="12dp"
                android:textStyle="bold" /> 
```

我得到了这个结果很好的结果，www.webtour.dk 显示为链接。但是当我点击链接时，我什么也没有！！！没有导航器启动？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:10:16.977

只需使用[Linkify](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3aautoLink)自动查找网站：

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:autoLink="web"
    android:text="@string/description"
    android:textSize="12dp"
    android:textStyle="bold" /> 
```

然后从文本中取出 html：

```
<string name="description">Hello please look into www.webtour.dk</string> 
```

# java - （在 Eclipse 中）servlet 中的 JDBC 数据库访问出错

> ID：11278333
> 
> 赞同：0
> 
> 时间：2012-06-30T23:06:39.910
> 
> 标签：java, database, servlets

我对使用 Java 进行 Web 应用程序编程非常陌生。我有两个问题。

首先：我有一个 postgresql 数据库。在 servlet 之外进行操作时（作为 JUnit4 测试），我可以很好地访问数据库。但是，当我尝试通过 servlet 访问它时，我得到：

```
java.sql.SQLException: No suitable driver found for jdbc:postgresql://localhost:5432/comic_store
at java.sql.DriverManager.getConnection(DriverManager.java:602)
at java.sql.DriverManager.getConnection(DriverManager.java:185)
at ilya.database.DBService.<clinit>(DBService.java:15)
at ilya.database.UserGateway.getUserByEmail(UserGateway.java:29)
at ilya.controller.Login.<init>(Login.java:12) 
```

等等。为什么在从 servlet 访问时会抛出此异常，但否则不会。

第二：在 servlet 中初始化数据库连接的首选方式是什么？我应该使用 web.xml 创建数据源吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T03:30:07.433

[在这里](https://stackoverflow.com/q/5556664/844620)找到我的答案。[Apache 的 JNDI Datasources HOW-TO](http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html)也提供了帮助。这是有效的：将驱动程序 jar 添加到 %CATALINA_HOME%/lib 而不是 WEB-INF/lib，然后使用 Class.forName() 加载驱动程序。我尝试排除 Class.forName() 并得到相同的异常。我还尝试了仅在 WEB-INF/lib 中使用驱动程序的 Class.forName()，但这也不起作用。正如我上面所说，我正在运行 Tomcat 7 和 jdk 1.6.0。

# c++ - 在 MinGW 32 和 64 中包含来自 objcopy 的二进制 blob

> ID：11278334
> 
> 赞同：3
> 
> 时间：2012-06-30T23:06:54.063
> 
> 标签：c++, mingw, objcopy, mingw-w64

我正在使用 objcopy 将文本文件转换为目标文件，以便使用 MinGW 和 MinGW-64 与我的 DLL 链接。使用 MinGW，一切正常，但使用 MinGW-64，我收到“未定义对 `binary_src_glsl_RGBtoHSV_glsl_end' 的引用”形式的错误。原始文件名为 RGBtoHSV.glsl，位于 binary\src\glsl 文件夹中。在 objcopy 的输出中，变量名称是 _binary_src_glsl_RGBtoHSV_glsl_end。我访问该文件变量的代码如下：

```
extern "C" const char binary_src_glsl_RGBtoHSV_glsl_start;
extern "C" const char binary_src_glsl_RGBtoHSV_glsl_end;
const std::string RGBtoHSV = std::string(&binary_src_glsl_RGBtoHSV_glsl_start, &binary_src_glsl_RGBtoHSV_glsl_end-&binary_src_glsl_RGBtoHSV_glsl_start); 
```

如果我更改变量名称以便它们在前面有一个下划线，例如：

```
extern "C" const char _binary_src_glsl_RGBtoHSV_glsl_start; 
```

然后在 MinGW-64 中找到该符号，但在 MinGW（32 位）中找不到。我确实尝试了 objcopy 的 --remove-remove-leading-char 选项，但这没有效果。据我所见，我的选择是在为 MinGW 32 位构建时使用“--prefix-symbol _”为 objcopy 生成的变量名称添加下划线，在这种情况下，上述变量名称将在 32和 64 位。

这个问题还有其他解决方案吗？理想情况下，我想要一些类似的东西

```
extern "C" fix_underscore_problem const char binary_src_glsl_RGBtoHSV_glsl_start; 
```

其中 fix_underscore_problem 是修复前导下划线问题的神奇命令。

更新 (2012-07-01)：使用[在 Win32 上使用 GCC 将前导下划线添加到程序集符号中给出的建议？](https://stackoverflow.com/questions/1034852/adding-leading-underscores-to-assembly-symbols-with-gcc-on-win32)我通过头文件更改为使用

```
extern "C" const char binary_src_glsl_RGBtoHSV_glsl_start asm("_binary_src_glsl_RGBtoHSV_glsl_start"); 
```

这似乎解决了问题，但现在我想知道它的便携性如何。MSVC 或 C++ 标准方法中是否有等效的语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T18:09:07.800

好吧，我已经解决了这个问题，有点像，通过定义一个宏来创建一个带有前导下划线的变量，如果需要的话。然后它创建一个函数，该函数返回一个指向变量的指针。函数名将始终是传递给宏的名称，因此我的其余代码可以只使用该函数名。宏是：

```
#define GPUFW_STR(x) #x

#if defined(__GNUC__) | defined(__MINGW32__) | defined(__MINGW64__)
    //GCC and MinGW allow one to use the asm keyword to give a variable a
    //specific label, overriding the label used at compile time.
    #define GPUFW_BINARY_BLOB_EXTERN(T,x) extern "C" const T x asm(GPUFW_STR(_ ## x)); static const T* at_ ## x = &x;
#else
    #if defined(_MSC_VER)
        #if defined(_WIN32)
            //Visual C++ does not seem to have a method to specify a different
            //label for a variable at link time, but in 32-bit Windows
            //extern "C" variables have a leading underscore anyway.
            #define GPUFW_BINARY_BLOB_EXTERN(T,x) extern "C" const T x; static const T* at_ ## x = &x;
        #else
            //64-bit Visual C++ does not prepend an underscore to extern "C"
            //variable names, causing many problems here.  Hence define the
            //external variable as _x.
            #define GPUFW_BINARY_BLOB_EXTERN(T,x) extern "C" const T _##x; static const T* at_ ## x = &_ ## x;
        #endif
    #else
        //Unknown compiler.
        #warning Your compiler was not recognised by GPUFW.  Binary blob inclusion may produce linker errors.
        #if defined(_WIN64)
            //On 64-bit Windows most compilers seem to stick to the Visual C++
            //naming conventions.
            #define GPUFW_BINARY_BLOB_EXTERN(T,x) extern "C" const T _##x; static const T* at_ ## x = &_ ## x;
        #else
            //If all else fails, hope that the compiler uses a leading underscore.
            #define GPUFW_BINARY_BLOB_EXTERN(T,x) extern "C" const T x; static const T* at_ ## x = &x;
        #endif
    #endif
#endif 
```

对于改进此解决方案的任何建议，我将不胜感激。尤其是我可以添加到处理除 GCC 和 MSVC 之外的编译器的分支中的任何内容，因为我没有使用它们的经验。

作为旁注，我还尝试使用 ld 来制作包含我的文本的目标文件，但是遇到了同样的问题，无论我使用什么选项，我都无法删除前导下划线。

# java - Java REST Web 服务

> ID：11278335
> 
> 赞同：0
> 
> 时间：2012-06-30T23:06:57.523
> 
> 标签：java, rest, netbeans

我正在尝试构建一个 Java REST Web 服务，它将对获取请求进行一些处理（例如，发送带有信息的获取请求，进行一些计算，然后发回一个带有结果的对象）。有什么想法可以在 Netbeans 中轻松设置吗？我一直在玩 New->RESTful web service... 功能，但似乎无法让它返回一个对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:12:00.673

AFAIK，您应该返回结果的字符串表示形式。例如实现该`getXml()`方法：

```
/**
 * Retrieves representation of an instance of services.GenericResource
 * @return an instance of java.lang.String
 */
@GET
@Produces("application/xml")
public String getXml() {
    return "<entry></entry>";
} 
```

您可以使用 XML API 将您的对象转换为 XML 字符串并返回它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-30T15:53:03.163

你想归还什么样的对象……？在 java rest webservice 中，您可以返回多种对象，例如 json、xml。

您可以按照这些教程创建任何类型的 java rest webservice - [http://www.mkyong.com/webservices/jax-rs/json-example-with-jersey-jackson/](http://www.mkyong.com/webservices/jax-rs/json-example-with-jersey-jackson/)

此链接显示了返回 json 对象的 get 请求示例。您可以浏览那里的教程以了解任何其他要求。

# iphone - 我收到 Apple Mach-O 链接器错误

> ID：11278336
> 
> 赞同：0
> 
> 时间：2012-06-30T23:06:59.790
> 
> 标签：iphone, three20

我已将 Three20 导入现有项目，但出现此错误。

请帮忙！

```
Ld /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/iDesignWindows.app/iDesignWindows normal i386
    cd "/Dimitrios Tragas/iPhone/iPhone Apps/iDesignWindows/Final/iDesignWindows"
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -L/Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator -F/Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator -filelist /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Intermediates/iDesignWindows.build/Debug-iphonesimulator/iDesignWindows.build/Objects-normal/i386/iDesignWindows.LinkFileList -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -ObjC -all_load -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=30000 /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20.a /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20Core.a /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20Network.a /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20Style.a /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20UI.a /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20UICommon.a /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20UINavigator.a -framework Foundation -framework CoreGraphics -framework QuartzCore -framework UIKit -o /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/iDesignWindows.app/iDesignWindows

ld: duplicate symbol _TTCreateNonRetainingArray in /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20Core.a(TTGlobalCore.o) and /Users/Dimfiniti/Library/Developer/Xcode/DerivedData/iDesignWindows-errlwvtfnegyctbuftipdkdvyiut/Build/Products/Debug-iphonesimulator/libThree20.a(TTGlobalCore.o) for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:09:33.560

当您导入 .m 文件而不是 .h 时，经常会出现此错误。

例如：

```
#import "Class.m" 
```

当你应该这样做时：

```
#import "Class.h" 
```

希望这可以帮助！

# asp.net-mvc - 如何映射在 ASP.NET MVC3 中实际不存在的 axd

> ID：11278338
> 
> 赞同：0
> 
> 时间：2012-06-30T23:07:02.767
> 
> 标签：asp.net-mvc, url-rewriting, url-routing, asp.net-mvc-routing

我正在开发一个博客站点，将其升级到 MVC3。

我在 web.config 中有这个：

```
<add name="RssHandler" verb="*" path="rss.axd" type="Blog.Web.RSSHandler, Blog.Web"/> 
```

因此，如果我直接从 url 访问 rss.axd，它可以工作：

```
http://mydomain/rss.axd 
```

现在我想用来`http://mydomain/RSS`映射 rss.axd，所以在 global.asax 中，我尝试了

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.MapPageRoute("RSS-View", "RSS", "~/rss.axd", false);
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    ...
} 
```

但我收到 404 错误，因为 rss.axd 不是网站文件夹中存在的物理文件。

过去，我使用 UrlRewrite 来执行此操作，它可以正常工作，如下所示：

```
<LookFor>~/RSS<LookFor>
<SendTo>~/rss.axd</SendTo> 
```

那么，在 MVC3 中是否有这样做的“重写”，而不是“路由”？我不想使用重定向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T06:32:41.370

没有可用于路由到 http 处理程序的内置支持。

一种可能性是编写一个自定义路由处理程序（[`IRouteHandler`](http://msdn.microsoft.com/en-us/library/system.web.routing.iroutehandler.aspx)），它将返回您的一个实例`RSSHandler`：

```
public class RssRouteHandler : IRouteHandler
{
    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        return new Blog.Web.RSSHandler();
    }
} 
```

最后你可以注册这条路线：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.Add("RSS-View", new Route("rss", new RssRouteHandler()));

    routes.MapRoute(
        "Default",
        "{controller}/{action}/{id}",
        new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    );
} 
```

现在我们不再通过虚拟`rss.axd`地址。当向我们发出请求时，`/rss`我们直接通过我们的自定义路由处理程序处理此请求，就好像我们在 web.config 中有以下内容一样：

```
<add name="RssHandler" verb="*" path="rss" type="Blog.Web.RSSHandler, Blog.Web"/> 
```

# mysql - 无法创建外键（错误 1072）

> ID：11278343
> 
> 赞同：6
> 
> 时间：2012-06-30T23:07:59.007
> 
> 标签：mysql, sql, foreign-keys, primary-key

我有一个看起来像这样的表：

```
mysql>  SHOW COLUMNS FROM Users;
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| user_id    | int(10)      | NO   | PRI | NULL    | auto_increment |
| username   | varchar(50)  | YES  |     | NULL    |                |
| password   | varchar(255) | YES  |     | NULL    |                |
| email      | varchar(255) | YES  |     | NULL    |                |
| phone      | varchar(255) | YES  |     | NULL    |                | 
```

我正在尝试创建一个这样的新表：

```
create table jobs (id int,  FOREIGN KEY (user_id) REFERENCES Users(user_id)) ENGINE=INNODB; 
```

但我收到此错误：

`ERROR 1072 (42000): Key column 'user_id' doesn't exist in table`

我确信我错过了一些非常基本的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T23:18:09.157

试试这个：

```
create table jobs (
    id int,  
    user_id int,
    FOREIGN KEY (user_id) REFERENCES Users(user_id)
) ENGINE=INNODB; 
```

外键约束中的第一个`user_id`是指定义约束的表，第二个是指它指向的表。因此，您的工作表中也需要一个字段`user_id`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T23:18:02.183

这是您需要的脚本：

```
CREATE TABLE jobs
(
    id int NOT NULL,
    user_id int NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY (user_id) REFERENCES Users(user_id)
) 
```

这是学习有关设置关系的基础知识的一个很好的参考：[SQL FOREIGN KEY Constraint](http://www.w3schools.com/sql/sql_foreignkey.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-11T20:05:22.313

> 您正在尝试将其定义为 FOREIGN KEY，即查询中不存在的列。

这就是你收到的原因`Key column 'user_id' doesn't exist in table`

观察您的查询：

```
 create table jobs (
 id int,
 FOREIGN KEY (user_id) REFERENCES Users(user_id)
) ENGINE=INNODB; 
```

正如其他答案所示：

> 您必须定义新表列的创建，这将是另一个表中 PK 的 FK

```
 create table jobs (
 id int,
 user_id int NOT NULL
 FOREIGN KEY (user_id) REFERENCES Users(user_id)
 ) ENGINE=INNODB; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-29T14:52:05.173

创建表考勤：

```
CREATE TABLE tbl_attendance
(
attendence_id INT(100) NOT NULL,
presence varchar(100) NOT NULL,
reason_id varchar(100) NULL,
PRIMARY KEY (attendance_id)
); 
```

# symfony - 如何在 Symfony 2 中更改事件处理程序的优先级

> ID：11278345
> 
> 赞同：9
> 
> 时间：2012-06-30T23:08:11.190
> 
> 标签：symfony, event-handling

我为“名称：kernel.event_listener，事件：kernel.request”定义了2个事件监听器，但我可以做我想做的事，我不能改变调用这个监听器的顺序。我尝试使用“优先级”号码，但没有任何帮助。

这个事件总是调用@first：

```
 MyBundle.Foo.Listener.RequestListener:
    class: %MyBundle.Foo.Listener.request.class%
    arguments: [ @session, @liip_theme.active_theme, @Need.some.infos.service ]
    tags:
      - { name: kernel.event_listener, event: kernel.request, method: onRequest, priority: 100 } 
```

并且此事件永远不会调用，因为第一个事件使用依赖于此事件信息的服务，因此它在触发此事件之前崩溃：

```
 MyBundle.Bar.Listener.RequestListener:
    class: %MyBundle.Bar.Listener.request.class%
    arguments: [ @session ]
    tags:
      - { name: kernel.event_listener, event: kernel.request, method: onRequest, priority: 200 } 
```

我也改变了“优先级”，但没有任何改变:(

也许有人给我一个提示，我可以确保侦听器“MyBundle.Bar.Listener.RequestListener”会在其他事件之前调用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-01T11:59:03.633

问题是事件监听器类将在 Symfony 启动时初始化，在任何事件触发之前。

我不得不将我的 DI 更改为：

```
 MyBundle.Foo.Listener.RequestListener:
    class: %MyBundle.Foo.Listener.request.class%
    arguments: [ @session, @liip_theme.active_theme, @service_container ]
    tags:
      - { name: kernel.event_listener, event: kernel.request, method: onRequest, priority: 0 } 
```

我使用了这个“@service_container”服务，并在事件内部调用目标服务“@Need.some.infos.service”，一切正常。

# actionscript-3 - 将多个孩子添加到舞台

> ID：11278346
> 
> 赞同：1
> 
> 时间：2012-06-30T23:08:36.060
> 
> 标签：actionscript-3, flash

我是一名新的 Flash 开发人员。我在这里读过[http://www.flashandmath.com/intermediate/children/stage.html](http://www.flashandmath.com/intermediate/children/stage.html)我应该避免将子级添加到舞台本身，而只将它们添加到我的 MainTimeLine 派生的主文档类中（它本身就是舞台的子级）。但是，作者没有为这种方法提供解释/理由。

我正在开发一个项目，我正在考虑将 UI 弹出窗口直接添加到舞台上，而不是将它们包含在我的 MainTimeline 中（它可以更容易地将它们置于其他一切之上，也让我更容易知道我需要坚持什么，并且保存时我不这样做）。

这有什么缺点？它是 Flash 中的“坏习惯”吗？为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T23:42:22.300

对于快速演示和演示，我经常使用 Flash IDE 的时间线来管理我的深度。我创建了空的movieClips 并将它们放在不同的层上。例如，我的顶层是我的弹出层，下面是我的主要内容层，下面是我的背景层。我的主要文档类管理弹出窗口、内容和背景实例的添加和删除。

我认为将孩子直接添加到舞台是不好的做法。[这是一个不错的线程，解释了MainTimeLine 与 stage](http://www.actionscript.org/forums/showthread.php3?t=213491)之间的一些差异。

# chef-infra - 厨师食谱位置的配置？

> ID：11278351
> 
> 赞同：0
> 
> 时间：2012-06-30T23:09:02.547
> 
> 标签：chef-infra

据我了解，它从[http://community.opscode.com](http://community.opscode.com)`knife cookbook site install XYZ`搜索并安装说明书。

根据[http://wiki.opscode.com/display/chef/Managing+Cookbooks+With+Knife](http://wiki.opscode.com/display/chef/Managing+Cookbooks+With+Knife)：

> 食谱网站
> 
> 食谱站点子命令用于与社区食谱站点交互：community.opscode.com。

这个来源是否“硬编码”到 Chef 中？我可以配置这个`knife.rb`吗？（我想要吗？）

（我在系统上`ack`的`~/.rvm/gems/ruby-1.9.3-p194/gems/chef-10.12.0`目录中运行，没有看到任何提到的代码`community.opscode.com`，所以我不确定如何`knife`知道去哪里看。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T04:50:19.013

你有正确的认识。目前没有其他厨师食谱的社区站点，因此您很可能不想更改该 URL。但是，您可以使用[刀插件](https://stackoverflow.com/questions/11113224/adding-chef-cookbooks-from-github)从其他位置（例如 github）下载食谱。

# jsp - 在哪里为 Netbeans 中的 JSP 创建文本文件

> ID：11278355
> 
> 赞同：0
> 
> 时间：2012-06-30T23:09:48.290
> 
> 标签：jsp, text, web

为了写入 JSP 中的文本文件，该文件应在 NETBEANS Web 应用程序项目中创建的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:19:10.373

将其存储在 IDE/server/webapp 之外的固定路径中。例如`C:\var\webapp\data`。你可以`FileOutputStream`这样写

```
File file = new File("C:/var/webapp/data", "filename.txt");
OutputStream output = new FileOutputStream(file); 
```

固定路径又可以通过配置/[属性](http://docs.oracle.com/javase/tutorial/essential/environment/properties.html)文件进行配置，该文件又放置在类路径中。另请参阅[在哪里放置以及如何在基于 servlet 的应用程序中读取配置资源文件？](https://stackoverflow.com/questions/2161054/where-to-place-configuration-properties-files-in-a-jsp-servlet-web-application)

```
String dataPath = properties.getProperty("data.path");
File file = new File(dataPath, "filename.txt");
OutputStream output = new FileOutputStream(file); 
```

不要将它存储在 Netbeans 的文件夹结构中，因为在生产环境中部署和运行时，甚至在移动到不同的 IDE 时，它根本不存在。它使您的 webapp 完全不可移植。不要将它存储在扩展的 webapp 的文件夹结构中（使用 WEB-INF 和所有在 em 上，人们会使用[`ServletContext#getRealPath()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath%28java.lang.String%29)它来将其转换为磁盘文件系统路径），因为该文件夹结构中的每次更改都会完全消失一次WAR 被重新部署，或者在某些配置中，即使服务器重新启动，仅仅是因为创建/编辑的文本文件不是原始 WAR 的一部分。

一个完全不同的替代方案是使用（嵌入式）SQL 数据库。当您经常需要操作数据或需要在其中搜索时，这可能是一个更好的选择。SQL 数据库绝对针对这项工作进行了高度优化。

# php - 如何根据 PHP 中的字符数拆分字符串？

> ID：11278356
> 
> 赞同：-3
> 
> 时间：2012-06-30T23:09:53.983
> 
> 标签：php, string, split

如何根据字母字符数和/或数字数拆分字符串，使它们成为单独的字符串？

希望这是有道理的。谢谢你的帮助 （：

例如：用户输入：

1.  亨利·史密斯 ID：123456

我想将用户输入排序为单独的字符串，结果为：

```
$name = 'Henry, Smith';
$ID = '123456'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:24:29.887

您可以使用正则表达式仅匹配数字和除数字之外的所有内容。

```
$number = preg_replace("/[^0-9]/", '', $str);
$name = preg_replace("/[0-9]/", '', $str); 
```

请注意，对于`name`，这`Henry, Smith ID:`将从您的问题示例中返回。这只是取出数字......它不知道“ID：”不是人名的一部分。

插入符号 ( `^`) 的解释：

在括号内，它意味着匹配不在括号内的所有内容。所以`[^0-9]`匹配除数字之外的所有内容。在此示例中，它将用空白（第二个参数）替换不是数字的所有内容。对于`$name`，我们做相反的事情。我们将所有 IS 数字替换为空白，以获取非数字字符。

有关正则表达式的更多信息，请参见[此处](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp)。

# javascript - 咖啡脚本数组寻找下一个位置

> ID：11278361
> 
> 赞同：0
> 
> 时间：2012-06-30T23:10:38.113
> 
> 标签：javascript, arrays, coffeescript

我有一个如下的数组设置：

```
services = ['times', 'food', 'messages', 'share'] 
```

我希望能够将“时间”传递给服务并让它返回数组中的下一个位置，即“食物”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:13:34.103

基于**Utkanos**的回答，但在 CS 中：

```
getNext = (arr, key) ->
    arr[arr.indexOf(key) + 1]
console.log getNext services, 'times' # food 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:13:52.233

```
nextPos = services.indexOf('times'); 
```

这是 JS，但在 CoffeeScript 中也有效。但是请注意，如果在 CofeeScript 之外使用，它是 ECMA5 的补充，因此在旧版浏览器中不起作用（编辑 - 正如评论所说，这当然意味着 IE <= 8）。

# iphone - 多视图 Xcode

> ID：11278363
> 
> 赞同：0
> 
> 时间：2012-06-30T23:12:24.740
> 
> 标签：iphone, xcode, views

我正在设计一个 iphone 应用程序，我需要帮助构建程序。我是 xcode 的新手，但我仍在使用 xcode 3，因为我没有狮子。我的问题与使用视图控制器有关。我的第一个问题是，如果我不知道屏幕上的视图是什么，我该如何摆脱屏幕上的视图？我的下一个问题是如何添加我想要的视图？我知道我问了很多，但我尝试了很多东西，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T02:24:54.667

您可以像这样获取当前显示在视图上的子视图列表：

```
NSArray *subArray = [self.view subviews]; 
```

或者，如果您在添加时为每个视图分配一个标签，则可以通过其标签获取特定的子视图，即。

```
UIView *someView = [self.view viewWithTag:100]; 
```

为要使用的视图创建对象后，只需调用 removeFromSuperview：

```
[someView removeFromSuperview]; 
```

你是这个意思吗？喜欢从屏幕上删除按钮和图像？或者你真的是说你想要推送/弹出视图控制器（比如从游戏返回主菜单等）

# mysql - 在 mySQL 中查找每个组中的成员总数

> ID：11278367
> 
> 赞同：0
> 
> 时间：2012-06-30T23:12:54.510
> 
> 标签：mysql

我有一个组表和一个成员表，它们链接回组表。
有没有办法运行一个查询来返回每个组以及该组中的成员数量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:14:59.047

```
select group_id, count(group_id) as group_count
from members
group by group_id
order by group_count desc 
```

# php - PHP：在数组中添加缺失的日期

> ID：11278372
> 
> 赞同：3
> 
> 时间：2012-06-30T23:14:00.063
> 
> 标签：php, mysql

我在我的表上运行以下查询：

```
SELECT DISTINCT(date(dateAdded)) AS dateAdded, count(*) AS count FROM clients WHERE (dateAdded BETWEEN '2012-06-15' AND '2012-06-30') GROUP BY dateAdded ORDER BY dateAdded ASC 
```

这将返回如下内容：

```
2012-06-17 ¦ 5 
2012-06-19 ¦ 2 
2012-06-26 ¦ 3 
2012-06-30 ¦ 2 
```

我需要能够填写日期范围内的任何缺失日期，如下所示：

```
2012-06-15 ¦ 0 
2012-06-16 ¦ 0 
2012-06-17 ¦ 5 <--
2012-06-18 ¦ 0 
2012-06-19 ¦ 2 <--
2012-06-20 ¦ 0 
2012-06-21 ¦ 0 
2012-06-22 ¦ 0 
2012-06-23 ¦ 0 
2012-06-24 ¦ 0 
2012-06-25 ¦ 0 
2012-06-26 ¦ 3 <--
2012-06-27 ¦ 0
2012-06-28 ¦ 0 
2012-06-29 ¦ 0 
2012-06-30 ¦ 2 <-- 
```

如果可能的话，我想使用某种 PHP 循环来做到这一点。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T03:37:41.727

我喜欢使用日期迭代器来解决这类问题：

```
class DateRangeIterator implements Iterator
{
      private $from;
      private $to;
      private $format;
      private $interval;

      private $current;
      private $key;

      function __construct($from, $to, $format = 'Y-m-d', $interval = '+1 days')
      {
            if (false === ($this->from = strtotime($from))) {
                  throw new Exception("Could not parse $from");
            }
            if (false === ($this->to = strtotime($to))) {
                  throw new Exception("Could not parse $to");
            }
            $this->format = $format;
            $this->interval = $interval;
      }

      function rewind()
      {
            $this->current = $this->from;
            $this->key = 0;
      }

      function valid()
      {
            return $this->current <= $this->to;
      }

      function next()
      {
            $this->current = strtotime($this->interval, $this->current);
            ++$this->key;
      }

      function key()
      {
            return $this->key;
      }

      function current()
      {
            return date($this->format, $this->current);
      }
} 
```

要使用它：

```
foreach (new DateRangeIterator('2012-04-01', '2012-04-30') as $date) {
    echo "$date\n";
} 
```

您可以自定义日期应显示的格式以及应增加的间隔。

在您的情况下，您需要使用键作为数组索引来存储 MySQL 结果，例如

```
[ '2012-04-01' => 'some event', '2012-04-06' => 'some other event' ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:18:57.033

[您可以使用此答案](https://stackoverflow.com/a/4897881/210547)中的方法在两个提供的日期之间创建一个包含所有日期的数组，然后`array_merge`使用结果覆盖任何设置的值。

```
$empty_array = array_fill_keys(makeDateRange("2012-06-15","2012-06-30"), 0);
$result = array_merge($empty_array, $result); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:22:46.893

嗯..不确定在 PHP 中执行循环是否是最佳实践。为什么不修改查询以提供所需的内容？

如果您在一组日期和您的表格之间进行左外连接，您应该得到您需要的东西（除了您将使用空值而不是 0，但这很容易处理。

我的 SQL 有点生疏了，但大概是这样的

```
SELECT dateAdded
FROM clients
WHERE  (dateAdded BETWEEN '2012-06-15' AND '2012-06-30') 
LEFT OUTER JOIN 
(
    SELECT DISTINCT(date(dateAdded)) AS dateAdded, count(*) AS count 
    FROM clients 
    WHERE (dateAdded BETWEEN '2012-06-15' AND '2012-06-30') 
    GROUP BY dateAdded ORDER BY dateAdded ASC
) AS mytable ON clients.dateAdded = mytable.dateAdded 
```

# .net - 如何确定类型是否是 CLI 元数据中的值类型？

> ID：11278373
> 
> 赞同：1
> 
> 时间：2012-06-30T23:14:29.393
> 
> 标签：.net, metadata, value-type

我正在使用`IMetaDataImport`API，并且我需要确定我的程序集中的类型定义是值类型还是引用类型。我没有在 API 中找到任何明确提供此信息的方法。但是，我可以很容易地获得基本类型并检查它是否是`System.ValueType`.

我的问题是：基类是 CLI 元数据对类型是值类型这一事实进行编码的唯一方法，还是在某处有一些标志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:43:42.623

没有直接标识值类型的标志。看起来检查基本类型以及其他一些事情是执行此操作的规范方法。

[ECMA CLI 规范](http://www.ecma-international.org/publications/standards/Ecma-335.htm)的第 II.10.1.3 节描述了这样的类型定义：

> 类型语义属性指定是否应定义接口、类或值类型。**interface**属性指定一个接口。如果此属性不存在并且定义扩展（直接或间接）`System.ValueType`，并且定义不是 for `System.Enum`，则应定义值类型。否则，应定义一个类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:45:57.320

[`Type.IsValueType`房产](http://msdn.microsoft.com/library/system.type.isvaluetype)是你要找的吗？

# python - Python 正则表达式搜索总是错误的？

> ID：11278375
> 
> 赞同：1
> 
> 时间：2012-06-30T23:14:41.283
> 
> 标签：python, regex

我很确定我在这里遗漏了一些非常基本的东西，因为我通常可以使用 Python 和 Regex。我正在查看提供的字符串是否至少包含一个数字，这是我正在经历的命令行，但总是出错......

```
>>> import re
>>> test_string = "123567890"
>>> pat = re.compile("[0-9]")
>>> pat.search(test_string) == True
False 
```

在发布此之前，我尝试了其他一些排列并且没有走得很远，我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T23:16:33.663

`pat.search`不返回布尔值，而是返回[MatchObject](http://docs.python.org/library/re.html#re.MatchObject)，因此您的比较将失败：

```
In [9]: p = pat.search(test_string)

In [10]: p
Out[10]: <_sre.SRE_Match at 0x3cfa608>

In [11]: type(p)
Out[11]: _sre.SRE_Match 
```

请参阅[re.search](http://docs.python.org/library/re.html?highlight=re.search#re.search)文档：

> re.search（模式，字符串，标志=0）
> 
> 扫描字符串以查找正则表达式模式产生匹配的位置，*并返回相应的 MatchObject 实例*。如果字符串中没有位置与模式匹配，则返回 None；请注意，这与在字符串中的某个点找到零长度匹配不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:17:39.393

问题是该`re.search()`方法实际上并没有返回 a `bool`，它返回一个专门的正则[表达式。匹配对象](http://docs.python.org/library/re.html#match-objects)。`bool(pat.search(test_string))`应该返回`True`，即：

```
>>> import re
>>> test_string = "123567890"
>>> pat = re.compile("[0-9]")
>>> bool(pat.search(test_string))
True 
```

检查成功匹配的正常方法是简单地使用`if`构造，即：

```
>>> if pat.search(test_string): True
... 
True 
```

您可以对任何实现 the`__nonzero__`或 `__len__`special 方法之一的对象使用这种缩写形式的真值测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:18:44.807

[re.search](http://docs.python.org/library/re.html#re.search)在找到匹配项时返回[MatchObject](http://docs.python.org/library/re.html#re.MatchObject)，而不是布尔值。当它不匹配时它确实返回 None ，所以这会做你想做的事情：

```
pat.search(test_string)!=None 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-30T23:19:29.213

这是您应该如何使用匹配对象的方法。我通常需要一个匹配对象的多个`True`/ `False`，所以我总是把它保存起来。

```
>>> m = pat.search(test_string)
>>> bool(m) == True
True
>>> if m:
        print "true"
true 
```

# css - 修复了不会超过内容底部的页脚

> ID：11278377
> 
> 赞同：2
> 
> 时间：2012-06-30T23:14:55.647
> 
> 标签：css, positioning

如果内容比视口长，我正在尝试获得一个始终位于视口底部的页脚。如果内容没有延伸到视口的底部，则页脚将停留在内容的底部。

这是我的 HTML：

```
<div id="wrapper">
    <!-- variable content and other divs in here -->
    <div id="footersurround">
        <div id="footerparent"> 
            <div id="footer"></div>
            <div id="linkshome"><!-- links in here --></div>
        </div>
    </div>
</div> 
```

和 CSS：

```
#wrapper {
    position: absolute;
    left: 50%;
    width: 1024px;
    margin: -512px;
    margin-top: 8px;
}

#footersurround {
    position: fixed;
    top: 0;
    max-width: 1024px;
    width: 100%;
    height: 100%;
    max-height: inherit; /* I want this to take the same value as the wrappers height if I set it to a value(e.g 768px) it works perfectly but when setting it to inherit it will stretch the whole viewport even if the wrapper does not*/
}

#footerparent {
    position: absolute;
    bottom: 0;
    width: 100%;
    z-index: 30;
}

#footer {
    position: absolute;
    bottom: 0;
    margin: 0 auto;
    min-height: 60px;
    width: 1024px;
    background-color: black;
    opacity: 0.50;
    filter: alpha(opacity=50); /* For IE8 and earlier */
    z-index: 16;
}

#linkshome {
    position: absolute;
    bottom: 0;
    margin: 0 auto;
    margin-top: -47px;
    min-height: 47px;
    width: 100%;
    max-width: 1074px;
    z-index: 17;
    text-align: center;
    font-size: 24px;
    font-family: Verdana;
    color: white;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:30:29.900

您的页脚 ( `#footersurround`) 已经有了`position: fixed`，只需给它`bottom: 0`而不是`top: 0`. 无需设置`width`,`height`和`max-height`. [**演示**](http://jsfiddle.net/vcG8Y/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:35:28.993

The key would be to compare viewport height with document scroll height and set the footer's position (absolute or fixed) accordingly. Here's something I knocked up (jQuery assumed).

```
<head>
    <script src='jquery.js'></script>
    <script>
    $(function() {
        var footer = $('footer'), doc = document.documentElement || document.body;
        footer.css('position', doc.scrollHeight <= $(window).height() ? 'absolute' : 'fixed');
    });
    </script>
    <style>
    body { margin: 0; }
    section { height: 600px; margin-top: 50px; border: solid 1px; position: relative; padding: 10px 10px 40px 10px; }
    footer { bottom: 0; width: 100%; height: 30px; background: red; left: 0; }
    </style>
</head>
<body>
    <section>
        <h1>main content here</h1>
        <footer></footer>
    </section>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:20:32.197

这应该这样做：[http ://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

# c# - 避免重复的按钮点击代码的有效方法

> ID：11278385
> 
> 赞同：0
> 
> 时间：2012-06-30T23:16:43.710
> 
> 标签：c#, winforms, methods, code-duplication

假设我有 2 个按钮女巫应该执行相同的操作，但在不同的对象上。

目前我正在将所有需要的引用传递给这样的方法：

```
 private void sub1_add_to_db_btn_Click(object sender, EventArgs e)
    {
        Add_Substance_To_Database(
            substanse1, sub1_add_to_db_btn, sub2_add_to_db_btn, sub1_found_in_db_list,
            sub2_found_in_db_list, false, sub1_listBox, sub2_listBox);
    }

    private void sub2_add_to_db_btn_Click(object sender, EventArgs e)
    {
        Add_Substance_To_Database(
            substanse2, sub2_add_to_db_btn, sub1_add_to_db_btn, sub2_found_in_db_list,
            sub1_found_in_db_list, false, sub2_listBox, sub1_listBox);
    } 
```

我想知道是否有其他更有效的方法来做到这一点。谢谢。

编辑：

这就是我的一些代码的样子，它让我抓狂！！！

```
private void sub1_add_to_db_btn_Click(object sender, EventArgs e)
    {
        Add_Substance_To_Database(substanse1, sub1_add_to_db_btn, sub2_add_to_db_btn,
            sub1_found_in_db_list, sub2_found_in_db_list, false, sub1_listBox, sub2_listBox);
    }

    private void sub2_add_to_db_btn_Click(object sender, EventArgs e)
    {
        Add_Substance_To_Database(substanse2, sub2_add_to_db_btn, sub1_add_to_db_btn,
            sub2_found_in_db_list, sub1_found_in_db_list, false, sub2_listBox, sub1_listBox);
    }

    private void sub1_edit_name_btn_Click(object sender, EventArgs e)
    {
        Add_Substance_To_Database(substanse1, sub1_add_to_db_btn, sub2_add_to_db_btn,
            sub1_found_in_db_list, sub2_found_in_db_list, true, sub1_listBox, sub2_listBox);
    }

    private void sub2_edit_name_btn_Click(object sender, EventArgs e)
    {
        Add_Substance_To_Database(substanse2, sub2_add_to_db_btn, sub1_add_to_db_btn,
            sub2_found_in_db_list, sub1_found_in_db_list, true, sub2_listBox, sub1_listBox);
    }

    private void sub1_delete_from_db_btn_Click(object sender, EventArgs e)
    {
        Delete_Substance_From_DB(sub1_listBox,
            sub2_listBox,sub2_list_is_from_file,sub1_delete_from_db_btn,
            sub2_delete_from_db_btn);
    }

    private void sub2_delete_from_db_btn_Click(object sender, EventArgs e)
    {
        Delete_Substance_From_DB(sub2_listBox,
            sub1_listBox,sub1_list_is_from_file,sub2_delete_from_db_btn,
            sub1_delete_from_db_btn);
    } 
```

例如：如果我想删除一种物质，我需要从两个列表中删除它并从其他列表中删除它，将选择更改为下一个物质等...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-30T23:20:48.153

鉴于您将不同的值传递给`Add_Substance_To_Database`您现在拥有的可能是您所希望的最可维护的代码。

您可以将一个事件处理程序附加到两个按钮，但您必须确定按下了哪个按钮并传递相关参数：

```
if (sender == button1)
{
    Add_Substance_To_Database(
        substanse1, sub1_add_to_db_btn, sub2_add_to_db_btn, sub1_found_in_db_list,
        sub2_found_in_db_list, false, sub1_listBox, sub2_listBox);
}
else
{
    Add_Substance_To_Database(
        substanse2, sub2_add_to_db_btn, sub1_add_to_db_btn, sub2_found_in_db_list,
        sub1_found_in_db_list, false, sub2_listBox, sub1_listBox);
} 
```

这让你无处可去。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T23:21:57.500

这根本不是代码重复的情况。重构这样的案例只会使它：

*   更复杂
*   不可读

请参阅：[代码重复的任何正当理由？](https://stackoverflow.com/questions/1360673/any-valid-reason-for-code-duplication/1360910#1360910)

编辑：

如果您在重复的事件处理程序中有更多“肉”，我会建议可能有所不同。但是您将所有内容都拉入其中`Add_Substance_To_Database`，因此您已经成功地对代码进行了重复数据删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:30:08.537

事件处理程序可能是少数控件之一，在发送者中您有按钮控件，它调用事件，将其转换为 Button 类并使用 tham 作为方法的参数

var **button** = 作为按钮的发送者；

Add_Substance_To_Database（substanse2，**按钮**，sub1_add_to_db_btn，sub2_found_in_db_list，sub1_found_in_db_list，假，sub2_listBox，sub1_listBox）；

对于其他参数，您可以使用属性标签，它是开发人员目的的对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T13:29:49.573

最终我遵循了我自己的建议......我创建了一个包含所有控制器的对象数组，并向控制器事件处理程序添加了相同的方法。在该方法中，我只是根据发送者选择正确的控制器。

```
substance1_controllers = new object[]{
            sub1_main_listbox, sub1_peaks_list,sub1_found_in_db_list,
            sub1_similar_in_db_list, sub1_eigenvector_list,
            sub1_sourse_switch_btn, sub1_folder_btn,sub1_add_to_db_btn,
            sub1_edit_name_btn,sub1_delete_btn, sub1_picture_box,
            chart_peaks.Series[0], chart_compare.Series[0], true, -1};
substance2_controllers = new object[]{
            sub2_main_listbox, sub2_peaks_list, sub2_found_in_db_list,
            sub2_similar_in_db_list,sub2_eigenvector_list,
            sub2_sourse_switch_btn, sub2_folder_btn, sub2_add_to_db_btn,
            sub2_edit_name_btn,sub2_delete_btn, sub2_picture_box, 
            chart_peaks.Series[1],chart_compare.Series[1], true, -1}; 
```

以这种方式维护可能看起来更难，但我个人发现在这张表的帮助下维护和使用它非常舒适（而且看起来很棒）：

```
 // [0]  - Main Listbox
        // [1]  - Peaks Listbox
        // [2]  - Found in Database Listbox
        // [3]  - Found similar Listbox
        // [4]  - Eigenvectors Listbox
        // [5]  - Switch sourse Button
        // [6]  - Change Folder Button
        // [7]  - Add to Database Button
        // [8]  - Edit Name Button
        // [9]  - Delete Button
        // [10] - Picture Box
        // [11] - Peaks Chart Series
        // [12] - Compare Chart Series
        // [13] - List is from File Boolean
        // [14] - Previous Selected Index 
```

方法示例：

```
void Delete_Substance_From_DB(object sender, EventArgs e)
    {
        object[] controller;
        object[] other_controller;
        if (((Button)sender).Name == "sub1_delete_btn")
        {
            controller = substance1_controllers;
            other_controller = substance2_controllers;
        }
        else
        {
            controller = substance2_controllers;
            other_controller = substance1_controllers;
        }
    } 
```

使用示例：

```
if (((ListBox)other_controller[0]).Items.Count != 0)
        {
            if (((ListBox)other_controller[0]).Items.Count == index2)
            {
                ((ListBox)other_controller[0]).SelectedIndex = index2 - 1;
            }
            else
            {
               ((ListBox)other_controller[0]).SelectedIndex = index2;
            }
            Main_Listbox_Index_Changed(((ListBox)other_controller[0]), null);
        } 
```

# android - 是否可以从 Google Play 为我的应用下载旧 APK？

> ID：11278387
> 
> 赞同：113
> 
> 时间：2012-06-30T23:17:10.480
> 
> 标签：android, google-play

在过去的几个月里，我发布了我的应用程序的几个修订版。不幸的是，我没有保留所有旧 APK 的副本，现在我想测试从旧版本升级到新版本。有没有办法下载我的旧版本的谷歌副本？Google Play 开发者控制台显示了我的旧 APK，但没有下载链接。我尝试了“Real APK Leecher”，但这并不能让您选择要下载的 APK 版本。而且我什至无法在开发者控制台中临时重新激活旧版本，因为它抱怨它是早期版本。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2016-10-14T07:55:49.573

现在是可能的。他们在 Google Play 开发者控制台中添加了“管理发布”标签。从`Artifact Library`该`Release Management`选项卡下，您可以下载应用的 APK。

您需要拥有必要的权限才能查看工件旁边的下载按钮。如有疑问，请尝试 root 帐户。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2012-06-30T23:35:15.643

**THE ANSWER IS OUTDATED. NOW THIS IS POSSIBLE, CHECK [@tesla's](https://stackoverflow.com/a/40037886/944070) AND [@olleh's](https://stackoverflow.com/a/40759979/944070) ANSWERS.**

**FOR THE NEW 2020 GOOGLE PLAY CONSOLE, SEE ANSWER FROM [@IonicBurger](https://stackoverflow.com/questions/11278387/is-it-possible-to-download-an-old-apk-for-my-app-from-google-play/63599659#63599659)**

No, unfortunately.

The Android Developer Console is a real disaster, everywhere you look there is something that needs to be fixed or improved, being this issue you mention one of them. Unfortunately for the time being you're out of luck. Unless Google enables this, you cannot download old APKS's. I suppose you could recompile the old code, but I guess you don't have that either and that's why you are here :-)

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2016-11-23T09:03:14.580

**最近更新：**

去

> 开发者控制台 => 应用发布 => 生产（管理生产） => 发布历史 => 选择您想要的版本 => 点击下载按钮。

您的帐户应该被授予完全权限，否则下载按钮将被隐藏。

**原始答案**

去

> 开发者控制台 => 管理发布 => 工件库 => 存档工件

您可以选择下载以前的版本。

**更新：**

去

> 开发者控制台 => 应用发布 => 工件库 => 检查您要下载的版本代码/名称，然后单击右侧的下载按钮。

** 更新： **

> 开发者控制台 => 应用发布 => 生产（管理生产） => 下载箭头。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2020-08-26T14:18:45.137

再一次 - 这个问题需要一个更新的答案，2020 年 Google Play 控制台的最新更新。

现在要遵循的步骤是，在控制台中，转到：App bundle explorer

[![在此处输入图像描述](../Images/ed046741116fc4955d78b92ada64a734.png)](https://i.gyazo.com/aff932525e617386b230a16c6cefc63f.png)

在右上角，选择您要下载的工件，然后转到“下载”选项卡。向下滚动到 Assets，然后在表 Original file 中查找第一个条目。单击右侧的下载图标以下载您的 APK 或 AAB 文件

[![在此处输入图像描述](../Images/1df31cb4e1df4de58dd0c03f40b206ce.png)](https://i.stack.imgur.com/bVkoU.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-03-15T06:50:06.207

现在是**可能**的。

**请参阅下面的屏幕截图以获得清晰的图片。**

Google 在 Google Play 开发者控制台的“应用发布”中添加了“管理”选项。在管理选项卡中，您可以查看发布历史记录并下载您应用的 APK。

***视觉解释:: 请参阅下面的 2 步过程。***

第1步：转到管理 [![第 1 步：转到管理](../Images/273824dde2fed66f050e52baf59f645f.png)](https://i.stack.imgur.com/2KKB6.jpg) 第2步：转到发布历史部分->选择版本->下载Apk

[![第 2 步：转到发布历史记录部分 -> 选择版本 -> 下载 Apk](../Images/84db0fe04ce55b020e27e5bbd577cea8.png)](https://i.stack.imgur.com/Z8m2W.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-08-04T11:07:20.880

我将逐步向您展示屏幕截图：

1.  进入生产： [![生产科](../Images/9c5bcefad313ad845d320f5293b51a87.png)](https://i.stack.imgur.com/aSuXl.png)

2.  转到发布选项卡，然后单击“查看发布详细信息” [![查看发布详情](../Images/ba67727902a49107e71fb43f8ef6d5d3.png)](https://i.stack.imgur.com/TXn6Y.png)

3.  在“App bundles”部分，点击箭头： [![应用程序包部分](../Images/88ad735674d16d776fa3b0b8e2cb0686.png)](https://i.stack.imgur.com/mmBwu.png)

4.  进入APK，点击“Explore Apk” [![探索 Apk](../Images/61a4e7f3c97d20e645b46cb8781a3afb.png)](https://i.stack.imgur.com/RhA6x.png)

5.  在“下载”选项卡中，单击“下载”图标： [![在此处输入图像描述](../Images/f15cef7d8cf6605b3869ffb1f00bd35a.png)](https://i.stack.imgur.com/U5op6.png)

而已。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-11T18:32:21.303

可以通过 Google Play Console 中的链接安装旧 APK。这样您就可以直接从 Play 商店安装，而不是下载 APK。这也适用于 app bundle，它允许您为您的设备获得优化的 APK。

1.  在 Google Play 控制台中，转到开发工具 > 内部应用共享 > 管理测试人员
2.  添加您希望允许访问以安装旧版本应用程序的所有测试人员
3.  如果您上传应用程序包，您可以转到发布管理 > 工件库 > 探索您想要的版本。
4.  该链接应列在内部应用程序共享部分。如果找不到链接，请使用以下格式（请务必替换为您的 applicationId 和您的应用 的**versionCode** **）**[https://play.google.com/apps/test/applicationId/versionCode](https://play.google.com/apps/test/)
*****   当您第一次单击设备上的链接时，Play 商店会显示内部应用共享未启用。*   要启用内部应用共享，请打开 Play 商店 > 设置*   一直向下滚动并继续单击 Play Store 版本以启用开发者模式*   启用开发者模式后，您将在设置中看到内部应用共享开关，启用后，您将能够从链接安装您的应用。****

 ****仅供参考：如果没有发布到生产轨道，我已经看到某些版本无法正常工作。我可以安装我所有的制作曲目，也可以安装 Google Play 控制台中工件库中列出的任何活动工件。如果您尝试测试升级方案，这应该足够了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-24T13:22:51.240

**特斯拉正确答案截图。我在找到下载图标时遇到了一些麻烦：**

[![在哪里点击下载apk](../Images/5dd19c427e811f9e6f7d66694562779a.png)](https://i.stack.imgur.com/UdcUy.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-20T17:47:51.757

这很简单：

1- 点击 App bundle explorer，然后选择您想要的版本，如图所示：

[![在此处输入图像描述](../Images/5104be18cc944fd4c20e58639e830a9f.png)](https://i.stack.imgur.com/3pIPO.jpg)

2- 单击您要下载的版本前面的蓝色箭头： [![在此处输入图像描述](../Images/abda27ae38d7348a533efd1b4a84e322.png)](https://i.stack.imgur.com/0NoNP.jpg)

3-选择下载选项卡，然后单击apk的下载图标： [![在此处输入图像描述](../Images/6c6c1c628b99171a7542cf8fd963648c.png)](https://i.stack.imgur.com/6nfVc.jpg)****

# ruby-on-rails - 出问题了。Heroku 应用程序问题

> ID：11278390
> 
> 赞同：2
> 
> 时间：2012-06-30T23:17:30.140
> 
> 标签：ruby-on-rails, heroku, hosting

所以 Heroku 一整天都在停机，当然，直到我对我的应用程序进行了大量更改后，我才意识到这一点。现在 Heroku 已备份，我的应用程序已损坏。

这是一个随机文本块，让 stackoverflow 认为我已经更好地解释了我的代码块，因为他们不会让我发布其他内容。

这是我的heroku日志：

```
2012-06-30T22:58:31+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `landing_photo'
2012-06-30T22:58:31+00:00 app[web.1]:   app/views/pages/home.html.erb:3:in `_app_views_pages_home_html_erb__3529485503375966156_14193960'
2012-06-30T22:58:31+00:00 app[web.1]: 
2012-06-30T22:58:31+00:00 app[web.1]: 
2012-06-30T22:58:31+00:00 heroku[router]: GET jasonmccarthy.ie/ dyno=web.1 queue=0 wait=0ms service=195ms status=500 bytes=643
2012-06-30T22:58:31+00:00 heroku[nginx]: 194.46.182.60 - - [30/Jun/2012:22:58:31 +0000] "GET / HTTP/1.1" 500 643 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.47 Safari/536.11" jasonmccarthy.ie
2012-06-30T22:58:48+00:00 heroku[run.1]: Awaiting client
2012-06-30T22:58:48+00:00 heroku[run.1]: Starting process with command `bundle exec rake db:migrate`
2012-06-30T22:58:48+00:00 heroku[run.1]: State changed from starting to up
2012-06-30T22:58:54+00:00 heroku[run.1]: Process exited with status 0
2012-06-30T22:58:54+00:00 heroku[run.1]: State changed from up to complete
2012-06-30T22:58:57+00:00 app[web.1]: 
2012-06-30T22:58:57+00:00 app[web.1]: 
2012-06-30T22:58:57+00:00 app[web.1]: Started GET "/" for 194.46.182.60 at 2012-06-30 22:58:57 +0000
2012-06-30T22:58:57+00:00 app[web.1]: Processing by PagesController#home as HTML
2012-06-30T22:58:57+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (0.7ms)
2012-06-30T22:58:57+00:00 app[web.1]: Completed 500 Internal Server Error in 1ms
2012-06-30T22:58:57+00:00 heroku[router]: GET jasonmccarthy.ie/ dyno=web.1 queue=0 wait=0ms service=15ms status=500 bytes=643
2012-06-30T22:58:57+00:00 app[web.1]: 
2012-06-30T22:58:57+00:00 app[web.1]: ActionView::Template::Error (can't convert Range into Integer):
2012-06-30T22:58:57+00:00 app[web.1]:     1: <% provide(:title, 'Jason Mc Carthy | Fashion Photography Wedding Photography') %>
2012-06-30T22:58:57+00:00 app[web.1]:     2: 
2012-06-30T22:58:57+00:00 app[web.1]:     3: <%= landing_photo %>
2012-06-30T22:58:57+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `landing_photo'
2012-06-30T22:58:57+00:00 app[web.1]:     4: 
2012-06-30T22:58:57+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `rand'
2012-06-30T22:58:57+00:00 app[web.1]:     5: <span id="tagline">Endeavouring to build a creative &amp; inspiring 2D world</span>
2012-06-30T22:58:57+00:00 app[web.1]:   app/views/pages/home.html.erb:3:in `_app_views_pages_home_html_erb__3529485503375966156_14193960'
2012-06-30T22:58:57+00:00 app[web.1]: 
2012-06-30T22:58:57+00:00 app[web.1]: 
2012-06-30T22:58:57+00:00 heroku[nginx]: 194.46.182.60 - - [30/Jun/2012:22:58:57 +0000] "GET / HTTP/1.1" 500 643 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.47 Safari/536.11" jasonmccarthy.ie
2012-06-30T23:04:47+00:00 heroku[slugc]: Slug compilation started
2012-06-30T23:05:24+00:00 heroku[api]: Release v30 created by colmtuite@gmail.com
2012-06-30T23:05:24+00:00 heroku[api]: Deploy b7f77bc by colmtuite@gmail.com
2012-06-30T23:05:24+00:00 heroku[web.1]: State changed from up to starting
2012-06-30T23:05:25+00:00 heroku[slugc]: Slug compilation finished
2012-06-30T23:05:26+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 18620`
2012-06-30T23:05:27+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-06-30T23:05:28+00:00 app[web.1]: [2012-06-30 23:05:28] ERROR SignalException: SIGTERM
2012-06-30T23:05:28+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'
2012-06-30T23:05:29+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-06-30T23:05:29+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-06-30T23:05:34+00:00 app[web.1]: [2012-06-30 23:05:34] INFO  WEBrick 1.3.1
2012-06-30T23:05:34+00:00 app[web.1]: [2012-06-30 23:05:34] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2012-06-30T23:05:34+00:00 app[web.1]: [2012-06-30 23:05:34] INFO  WEBrick::HTTPServer#start: pid=1 port=18620
2012-06-30T23:05:35+00:00 heroku[web.1]: State changed from starting to up
2012-06-30T23:05:36+00:00 app[web.1]: => Booting WEBrick
2012-06-30T23:05:36+00:00 app[web.1]: => Rails 3.2.3 application starting in production on http://0.0.0.0:18620
2012-06-30T23:05:36+00:00 app[web.1]: => Call with -d to detach
2012-06-30T23:05:36+00:00 app[web.1]: => Ctrl-C to shutdown server
2012-06-30T23:05:36+00:00 app[web.1]: 
2012-06-30T23:05:36+00:00 app[web.1]: 
2012-06-30T23:05:36+00:00 app[web.1]: Started GET "/" for 194.46.182.60 at 2012-06-30 23:05:36 +0000
2012-06-30T23:05:36+00:00 app[web.1]: Processing by PagesController#home as HTML
2012-06-30T23:05:36+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (79.1ms)
2012-06-30T23:05:36+00:00 app[web.1]: Completed 500 Internal Server Error in 108ms
2012-06-30T23:05:36+00:00 app[web.1]: ActionView::Template::Error (can't convert Range into Integer):
2012-06-30T23:05:36+00:00 app[web.1]: 
2012-06-30T23:05:36+00:00 app[web.1]:     1: <% provide(:title, 'Jason Mc Carthy | Fashion Photography Wedding Photography') %>
2012-06-30T23:05:36+00:00 app[web.1]:     2: 
2012-06-30T23:05:36+00:00 app[web.1]:     3: <%= l
anding_photo %>
2012-06-30T23:05:36+00:00 app[web.1]:     4: 
2012-06-30T23:05:36+00:00 app[web.1]:     5: <span id="tagline">Endeavouring to build a creative &amp; inspiring 2D world</span>
2012-06-30T23:05:36+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `rand'
2012-06-30T23:05:36+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `landing_photo'
2012-06-30T23:05:36+00:00 app[web.1]:   app/views/pages/home.html.erb:3:in `_app_views_pages_home_html_erb__3704543374435589796_23990640'
2012-06-30T23:05:36+00:00 app[web.1]: 
2012-06-30T23:05:36+00:00 app[web.1]: 
2012-06-30T23:05:36+00:00 heroku[router]: GET jasonmccarthy.ie/ dyno=web.1 queue=0 wait=0ms service=238ms status=500 bytes=643
2012-06-30T23:05:36+00:00 heroku[nginx]: 194.46.182.60 - - [30/Jun/2012:23:05:36 +0000] "GET / HTTP/1.1" 500 643 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.47 Safari/536.11" jasonmccarthy.ie
2012-06-30T23:05:37+00:00 heroku[web.1]: Error R12 (Exit timeout) -> At least one process failed to exit within 10 seconds of SIGTERM
2012-06-30T23:05:37+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL
2012-06-30T23:05:38+00:00 heroku[web.1]: Process exited with status 137
2012-06-30T23:05:49+00:00 heroku[web.1]: State changed from up to starting
2012-06-30T23:05:51+00:00 app[web.1]: 
2012-06-30T23:05:51+00:00 app[web.1]: 
2012-06-30T23:05:51+00:00 app[web.1]: Started GET "/" for 194.46.182.60 at 2012-06-30 23:05:51 +0000
2012-06-30T23:05:51+00:00 app[web.1]: Processing by PagesController#home as HTML
2012-06-30T23:05:51+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (0.6ms)
2012-06-30T23:05:51+00:00 app[web.1]: Completed 500 Internal Server Error in 1ms
2012-06-30T23:05:51+00:00 app[web.1]: 
2012-06-30T23:05:51+00:00 app[web.1]: ActionView::Template::Error (can't convert Range into Integer):
2012-06-30T23:05:51+00:00 app[web.1]:     2: 
2012-06-30T23:05:51+00:00 app[web.1]:     1: <% provide(:title, 'Jason Mc Carthy | Fashion Photography Wedding Photography') %>
2012-06-30T23:05:51+00:00 app[web.1]:     3: <%= landing_photo %>
2012-06-30T23:05:51+00:00 app[web.1]:     4: 
2012-06-30T23:05:51+00:00 app[web.1]:     5: <span id="tagline">Endeavouring to build a creative &amp; inspiring 2D world</span>
2012-06-30T23:05:51+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `rand'
2012-06-30T23:05:51+00:00 app[web.1]:   app/helpers/application_helper.rb:23:in `landing_photo'
2012-06-30T23:05:51+00:00 app[web.1]:   app/views/pages/home.html.erb:3:in `_app_views_pages_home_html_erb__3704543374435589796_23990640'
2012-06-30T23:05:51+00:00 app[web.1]: 
2012-06-30T23:05:51+00:00 app[web.1]: 
2012-06-30T23:05:51+00:00 heroku[nginx]: 194.46.182.60 - - [30/Jun/2012:23:05:51 +0000] "GET / HTTP/1.1" 500 643 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.47 Safari/536.11" jasonmccarthy.ie
2012-06-30T23:05:51+00:00 heroku[router]: GET jasonmccarthy.ie/ dyno=web.1 queue=0 wait=0ms service=13ms status=500 bytes=643
2012-06-30T23:05:52+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 23782`
2012-06-30T23:05:52+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-06-30T23:05:53+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'
2012-06-30T23:05:53+00:00 app[web.1]: [2012-06-30 23:05:53] ERROR SignalException: SIGTERM
2012-06-30T23:05:57+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-06-30T23:05:57+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5) 
```

应用助手：

```
def landing_photo
   random = Random.rand(1..4)
   image_tag "home-#{random}.png", {:class => 'bg'}
end 
```

页面/主页：

```
<%= landing_photo %> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T00:26:20.593

这可能是一个 Ruby 版本问题，因为`random = Random.rand(1..4)`在我运行 MRI-1.9.3 的系统上运行良好。也许电风暴导致 Heroku 改变了你的 Ruby。也许你依赖于现在已经失效的 1.9.3 实验室插件。

检查您正在运行的版本`heroku run ruby -v`，您可以通过将以下内容放在 gemfile 的顶部来强制他们使用 1.9.3：

```
source 'https://rubygems.org'
ruby '1.9.3' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:12:55.403

您为 rand 方法使用了错误的参数，它只接受一个整数，而不是它们的范围。

你正在寻找

```
random = Random.rand(4) 
```

您的另一个选择不是使用 Random，而是使用[Array#sample](http://api.rubyonrails.org/classes/Array.html#method-i-sample)

```
random = (1..4).to_a.sample 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:56:50.980

假设您没有向 Heroku 推送任何引入了一些错误代码的新代码。

我会检查您是否可以在本地重现该错误。如果一切正常，我会尝试再次将您的最新代码重新部署到heroku。

# c++ - C++ 中的模板和高阶种类

> ID：11278393
> 
> 赞同：3
> 
> 时间：2012-06-30T23:17:48.610
> 
> 标签：c++, templates, higher-kinded-types

我正在尝试编写一个函数，该函数采用两个具有相同包含类型的容器，例如两个`std::vector<int>`s 或 a`std::list<int>`和 a `std::vector<int>`。（但不是 a`std::vector<int>`和 a `std::vector<double>`！）

由于我不太确定应该如何完成，所以我决定先编写一个测试程序：

```
#include <iostream>
#include <vector>
#include <list>
#include <algorithm>

struct vector_wrapper
{
  template <typename T>
  struct instance_wrapper
  {
    typedef typename std::vector<T> instance;
  };
};

struct list_wrapper
{
  template <typename T>
  struct instance_wrapper
  {
    typedef typename std::list<T> instance;
  };
};

template <typename T, typename C1, typename C2>
void move(typename C1::instance_wrapper<T>::instance& c1, typename C2::instance_wrapper<T>::instance& c2) // line 29
{
  while (c1.size() > 0)
  {
    c2.push_front(c1.back());
    c1.pop_back();
  }
}

int main()
{
  std::vector<int> v;
  std::list  <int> l;

  v.reserve(10);
  for (int i = 0; i < 10; ++i)
    v.push_back(i);

  move<int, vector_wrapper, list_wrapper>(v, l);

  std::for_each(l.begin(), l.end(),
    [] (int i) { std::cout << i << " "; }
  );

  std::cout << std::endl;

  return 0;
} 
```

* * *

`-std=c++11`这段代码使用标志给了我以下 g++ 4.7 的编译时错误：

```
metaclass.cpp:29:24: error: non-template 'instance_wrapper' used as template
... more ... 
```

为什么编译器不能正确识别`instance_wrapper`为模板？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T23:25:59.363

编译器已经告诉你出了什么问题（来自[ideone](http://ideone.com/RHJsp)的错误）：

> prog.cpp:25:24: error: non-template 'instance_wrapper' used as template
> prog.cpp:25:24: note: use 'C1::template instance_wrapper' 表示它是一个模板

使用`C1::template instance_wrapper`而不是`C1::instance_wrapper`- 并且类似地，对 执行相同的操作`C2::instance_wrapper`：

```
template <typename T, typename C1, typename C2>
void move(typename C1::template instance_wrapper<T>::instance& c1, 
    typename C2::template instance_wrapper<T>::instance& c2)
{
    // ... 
```

这是因为`C1`是模板，编译器无法推断出它`instance_wrapper`是模板并将其视为非模板类​​型。

**请，请，阅读编译器输出的*所有内容。***不只是逐行。编译器通常会在前面或后面的一行中说明问题所在，在这种情况下，当它已经给你答案时！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T23:44:15.900

这是一个更好的解决方案，它不需要任何禁用参数推导并让客户端指定它们的奇怪包装器，只需在 C++03 中工作的干净简单的 SFINAE：

```
#include <type_traits> // or Boost equivalent

// a little helper struct to keep the 
// function as clutter-free as possible
template<class C1, class C2, class T = void>
struct enable_if_same_value_type
  : std::enable_if<std::is_same<typename C1::value_type,
        typename C2::value_type>::value, T>
{
};

template<class C1, class C2>
typename enable_if_same_value_type<C1, C2>::type
move(C1& source, C2& target){
  /* ... */
} 
```

请注意，顺便说一句，您的代码不是很通用，因为`push_front`不受 支持`std::vector`，因此您永远无法传递其中两个。另外，我不会调用 function `move`，因为您将第一个容器的内容添加到第二个容器中。

也就是说，`std::move`C++11 中有一个重载，它采用三个迭代器，并将第一个标记的内容也移动到作为第三个参数传递的输出迭代器中。因此，您`main`可以重写如下：

```
#include <algorithm> // algorithmic move
#include <vector>
#include <list>
#include <iterator> // front_inserter
#include <iostream>

int main(){
  std::vector<int> v;
  std::list<int> l;

  v.reserve(10);
  for (unsigned i = 0; i < 10; ++i)
    v.push_back(i);

  // I used 'rbegin'  and 'rend' so the order stays the same
  std::move(v.rbegin(), v.rend(), std::front_inserter(l));

  std::copy(l.begin(), l.end(), std::ostream_iterator<int>(std::cout, " "));
} 
```

[Ideone 上的实时示例。](http://ideone.com/Jfs0C)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T23:45:10.677

为了将来参考，您可以更简单地执行此操作：

```
#include <type_traits>

template<typename T, typename A1, typename A2, template <typename, typename> class Cont1, template<typename, typename> class Cont2>
void move(Cont1<T, A1>& from, Cont2<T, A2>& to) {
    while (!from.empty()) { // use !empty(), not size()
        to.push_front(from.back());
        from.pop_back();
    }
}

std::vector<int> v;
std::list<int> l;

move(v, l); // and no need to specify types 
```

# arrays - Qt 数组的 GLSL 统一始终为零

> ID：11278394
> 
> 赞同：2
> 
> 时间：2012-06-30T23:17:55.020
> 
> 标签：arrays, qt, opengl, glsl

我正在使用 Qt。我有多个着色器在工作，但是传递统一数组似乎总是将全部设置为零。预期的结果是在纹理顶部绘制随机圆圈（或者由于圆圈太多而只是透明纹理）。我得到的是右下角的单个粒子圆圈。

```
if (program->isLinked()) {
    QVector3D hitPoints[40];

    for (int k = 0; k < 40; k++) {
        hitPoints[k] = QVector3D((float)rand()/(float)RAND_MAX, (float)rand()/(float)RAND_MAX, (float)rand()/(float)RAND_MAX);
    }

    program->setUniformValueArray("hitPoints", hitPoints, 40);
    program->bind();
} 
```

片段着色器：

```
uniform sampler2D color_texture;
uniform vec3 hitPoints[40];

void main()
{
    float dist = 0.3;
   vec2 texcoord = vec2(gl_TexCoord[0]);
   for (int i = 0; i < 40; i++) {
       float close = sqrt(pow(hitPoints[i].y - texcoord.y, 2) + pow(hitPoints[i].x - texcoord.x, 2));
       if (close < dist) {
            gl_FragColor = vec4(0,0,0,texture2D(color_texture, texcoord).a);
            return;
       } 
   }
   gl_FragColor = texture2D(color_texture, texcoord);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T10:37:57.453

`glUniform`当使用普通的 OpenGL（没有 Qt）时，只有在相应的程序处于活动状态（使用）时调用才有效`glUseProgram`。并且由于`QGLShaderProgram`'s`setUniform`和`bind`functions 应该分别是简单的包装器`glUniform`和`glUseProgram`，您应该将函数调用的顺序更改为：

```
program->bind();
program->setUniformValueArray("hitPoints", hitPoints, 40); 
```

因此在程序绑定时总是设置程序的制服。但另一方面，uniforms 的值在程序的绑定和解除绑定上是持久的，因此如果它们不更改，则不必在每次绑定程序时都设置它们。

令人遗憾的是，文档没有说明这个问题。但由于它命名了由相应 Qt 函数包装的 GL 函数，我猜他们只是假设任何使用 OpenGL 的人无论如何都知道这些事实（实际上它们只是轻量级包装器，本身没有新接口）。

# mysql - 在此查询中使用 SQL UNION 的替代方法？

> ID：11278404
> 
> 赞同：1
> 
> 时间：2012-06-30T23:19:23.633
> 
> 标签：mysql, sql

我有一个包含 user1 和 user2 列的 Friends 表和一个包含登录字段的 users 表。

朋友“对”可以以任何一种方式存储，例如 user1=Joe 和 user2=Dave，或者它可以是 user1=Dave 和 user2=Joe，同样的事情。

我想找到在过去 30 天内登录的用户（比如“Joe”）的所有朋友（我不关心日期格式，只是希望能够在 1 个查询中完成）。

使用 UNION 是唯一的解决方案，它是否具有最佳性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:22:44.020

`UNION`这里不需要A。只需选择`where user1='Joe' OR user2='Joe'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:25:38.137

联合不是唯一的选择，例如，您可以这样做：

```
select u.user
from users u
inner join friends f on u.user = case f.user1 when 'Joe' then f.user2 else f.user1 end
where f.user1 = 'Joe' or f.user2 = 'Joe' 
```

这是否比联合更快取决于几件事，主要取决于您拥有的索引。

# google-maps-api-3 - 双击多边形时禁用缩放

> ID：11278409
> 
> 赞同：1
> 
> 时间：2012-06-30T23:20:24.503
> 
> 标签：google-maps-api-3

我在地图上有一些多边形，当用户双击它们时，我不希望发生缩放。但是，我希望在地图的其他部分启用双击缩放。有什么办法可以实现吗？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T07:42:07.280

观察多边形的 dblclick 事件并在事件发生时调用事件的 stop() 方法：

```
google.maps.event.addListener(polygonObject,'dblclick',function(e){e.stop();}) 
```

# windows-phone-7 - 需要帮助来修复异常

> ID：11278416
> 
> 赞同：0
> 
> 时间：2012-06-30T23:21:45.713
> 
> 标签：windows-phone-7, exception, app-hub

有人可以解释以下 2 个崩溃异常！我无法理解如何修复它们 -

帧图像函数偏移
量 0 coredll.dll xxx_RaiseException 19
1 mscoree3_7.dll 436488
2 mscoree3_7.dll 386545
3 mscoree3_7.dll 540936
4 TransitionStub 0
5 MS.Internal.XcpImports.CheckHResult 100
6 MS.Internal.XcpImports.MessageBox_ShowCore 112
7 System.Windows.MessageBox.ShowCore 272
8 PhotoRotator.TransformedImage.SaveButton_Click 504
9 Microsoft.Phone.Shell.ApplicationBarItemContainer.FireEventHandler 292
10 Microsoft.Phone.Shell.ApplicationBarIconButton.ClickEvent 88
11 Microsoft. Phone.Shell.ApplicationBarIconButtonContainer.ClickEvent 60
12 Microsoft.Phone.Shell.ApplicationBar.OnCommand 160
13 Microsoft.Phone.Shell.Interop.NativeCallbackInteropWrapper.OnCommand 72
14 mscoree3_7.dll 429164
15 mscoree3_7.dll 430528
16 mscoree3_7.dll 610803
17 mscoree3_7.dll 393257
18 0
19 corex.dll ApplicationBarInterop::ApplicationBarCallback::On

具体的代码如下 -

```
private void SaveButton_Click(object sender, EventArgs e)
        {
            WriteableBitmap wb = new WriteableBitmap(SelectedImage.TransformedImage);
            MemoryStream targetStream = new MemoryStream();  

            wb.SaveJpeg(targetStream, wb.PixelWidth, wb.PixelHeight, 0, 100);

            if (targetStream != null)
            {
                targetStream.Seek(0, 0); // necessary to initiate the stream correctly before save

                try
                {
                    MediaLibrary ml = new MediaLibrary();
                    Picture p = ml.SavePicture(Guid.NewGuid().ToString(), targetStream);
                    MessageBox.Show("Saved Successfully to your Media Library!");
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Error - " + ex.Message);
                }
            }
            else
            {
                MessageBox.Show("Unexpected error!");
            }
        } 
```

第二个->

帧图像函数偏移
量 0 coredll.dll xxx_RaiseException 19
1 mscoree3_7.dll 436488
2 mscoree3_7.dll 386545
3 mscoree3_7.dll 540936
4 TransitionStub 0
5 Microsoft.Xna.Framework.Helpers.ThrowExceptionFromErrorCode 80
6 Microsoft.Xna.Framework.Media.MediaLibrary.GetPictureFromToken 280
7 PhotoRotator.MainPage.OnNavigatedTo 216
8 Microsoft.Phone.Controls.PhoneApplicationPage.InternalOnNavigatedTo 288
9 System.Windows.Navigation.NavigationService .RaiseNavigated 488
10 System.Windows.Navigation.NavigationService.CompleteNavigation 812
11 System.Windows.Navigation.NavigationService.ContentLoader_BeginLoad_Callback 968
12 System.Windows.Navigation.PageResourceContentLoader.BeginLoad_OnUIThread 1108
13 ._ *c* _DisplayClass4._BeginLoad_b__0 64
14 mscoree3_7.dll 429164
15 mscoree3_7.dll 185803
_78.dll 146mscoree331
17 System.Reflection.RuntimeMethodInfo.InternalInvoke 112
18 System.Reflection.RuntimeMethodInfo.InternalInvoke 1560
19 System.Reflection.MethodBase.Invoke 104

这段代码是->

```
protected override void OnNavigatedTo(NavigationEventArgs e)
        {
            base.OnNavigatedTo(e);

            if (e.NavigationMode == NavigationMode.New)
            {
                // Get a dictionary of query string keys and values.
                IDictionary<string, string> queryStrings = this.NavigationContext.QueryString;

                // Ensure that there is at least one key in the query string, and check whether the "token" key is present.
                if (queryStrings.ContainsKey("token"))
                {
                    // Retrieve the picture from the media library using the token passed to the application.
                    MediaLibrary library = new MediaLibrary();
                    Picture picture = library.GetPictureFromToken(queryStrings["token"]);

                    // Create a WriteableBitmap object and add it to the Image control Source property.
                    BitmapImage bitmap = new BitmapImage();
                    bitmap.CreateOptions = BitmapCreateOptions.None;
                    bitmap.SetSource(picture.GetImage());

                    //WriteableBitmap picLibraryImage = new WriteableBitmap(bitmap);
                    //retrievePic.Source = picLibraryImage;

                    SelectedImage.OriginalImage = bitmap;

                    navigateCompleted(null, null);
                    //NavigationService.Navigate(HelperClass.Constants.TransformPageUri);
                    //NavigationService.Navigated -= new NavigatedEventHandler(navigateCompleted);
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T11:12:04.660

请添加一些代码，但第一个异常看起来像保存按钮的单击事件中存在错误：

```
8 PhotoRotator.TransformedImage.SaveButton_Click 504 
```

尝试逐步调试它。给我们一些代码

# android - 无法在 Eclipse 4.2 上安装 ADT

> ID：11278421
> 
> 赞同：3
> 
> 时间：2012-06-30T23:22:06.720
> 
> 标签：android, eclipse, eclipse-plugin

我查看了许多类似的线程，这些线程似乎范围从更改设置到将 https 更改为 http 到尝试手动安装。

尝试在 Eclipse 4.2 Juno 上安装 ADT 20.0.0 时出现[此](http://www.hawnutor.org/image/8AMSuhD.png)错误。

除了 Android 开发人员工具之外的所有项目都可以正常安装，尽管在软件站点上包含 download.eclipse.org/releases/juno/ 时，我在[这个](http://www.hawnutor.org/image/qKnB2CQ.png)阶段冻结了一段时间（注意：目前它已经卡在那里大约 5 分钟)，然后继续给出较早的错误。

无论使用归档/本地/链接并提取项目并使用 -clean 运行都没有改变任何东西，问题都是相同的。

还有什么我可以尝试解决的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:32:16.247

你有什么操作系统？该错误表明您缺少核心的 Java 开发。[http://www.eclipse.org/jdt/core/](http://www.eclipse.org/jdt/core/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T03:17:11.200

我遇到了同样的问题，我最终不得不恢复到早期版本的 eclipse 才能让事情正常工作。我做了一个全新的安装和一切，但直到我切换回来才能让 ADT 插件工作。

# android - Droid Razr - 它是高、中还是低 dpi 设备？

> ID：11278422
> 
> 赞同：1
> 
> 时间：2012-06-30T23:22:10.247
> 
> 标签：android

我正在为自己的手机开发，无意推销我的应用程序。有谁知道 Razr 是 ah、m 还是 l 设备？我是从部署到我的实际手机的一种方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:25:46.580

Droid Razr 的分辨率为 960 x 540 对吧？如果是这样，它应该是一个 hdpi 设备。

# iphone - 如何控制 UIWebView 的输入元素滚动位置？

> ID：11278425
> 
> 赞同：2
> 
> 时间：2012-06-30T23:22:40.290
> 
> 标签：iphone, uiwebview

当用户点击网页上的输入文本框时，UIWebView 会自动调整其边界以为设备键盘腾出空间，然后滚动和缩放以使文本框位于屏幕中央。

虽然这在大多数情况下都很好，但我在输入元素的正上方有一些文本告诉用户要输入什么，例如“请输入密码的第一个、第七个和第九个字母”。当点击文本框时，该文本会部分滚动到屏幕外，而文本框下方有很多空白，因为 UIWebView 将所有内容整齐地居中。

我尝试使用 HTML 标签告诉 UIWebView 文本已附加到文本框，但这不起作用。我正在考虑在激活键盘时直接访问底层的滚动视图，但这似乎是一个肮脏的黑客，所以我想先看看是否有更好的解决方案！

提前致谢！

# javascript - 无法让 Meteor 与轻量级 JS 触摸库hammer.js 一起工作

> ID：11278426
> 
> 赞同：2
> 
> 时间：2012-06-30T23:22:43.727
> 
> 标签：javascript, meteor, touch, hammer.js

我已经阅读[了有关在 Meteor 中集成触摸事件的现有帖子](https://stackoverflow.com/questions/10139425/jquery-mobile-meteor-sample-integration-and-or-integration-guidelines?lq=1)。

智慧似乎是，虽然 API 仍在不断发展，但最好避免使用基于包的方法，而只使用轻量级库来处理您在客户端上明确包含的触摸事件。

我想我会试试[hammer.js](http://eightmedia.github.com/hammer.js/)。（我不想要大部分 JQuery 移动设备。）

我可以让它在 Meteor 之外正常工作。

在 Meteor 内部，我只是在尝试他们的演示代码的简单版本：

```
var $sw = $('#swipeme');
$sw.on('hold tap swipe doubletap transformstart transform transformend dragstart drag dragend swipe release', function (event) {
event.preventDefault();
console.log("Type: " + event.type + ", Fingers: " + event.touches.length + ", Direction: " + event.direction + "<br/>");
}); 
```

这两个我都试过了：

-inside`$(document).ready`在主 application.js 文件中，以及

- 定义为相关模板的 template.js 文件中的一个函数，然后我在该模板的事件对象中调用：

```
Template.myTemplate.events = {
'click #myElement': function(){
myTouchFunction();
}
} 
```

两种方法都没有奏效。

我究竟做错了什么？

有没有其他人在 Meteor 中成功集成了一个 JS 触摸库？我注意到[jquery.fingers](https://github.com/chetan51/jquery.fingers)在其他帖子之一中被引用，但我也无法使其正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T01:52:19.990

添加`{{swipeme}}`到 myTemplate 并尝试使用`Meteor.defer`which 将在模板呈现后运行代码，确保它可以运行：

```
Template.myTemplate.swipeme = function () {
  Meteor.defer(function() {
    var $sw = $('#swipeme');
    $sw.on('hold tap swipe doubletap transformstart transform transformend dragstart drag dragend swipe release', function (event) {
      event.preventDefault();
      console.log("Type: " + event.type + ", Fingers: " + event.touches.length + ", Direction: " + event.direction + "<br/>");
    });
  });
}; 
```

或者，您也可以使用它`Meteor.startup`，但由于它只运行一次（不知道它是否必须在添加第一个 DOM 元素后运行），因此可能无法保证每次都能正常工作，一旦任何 DOM 元素获取，它将无法工作更新或添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-17T05:04:31.210

因为我在搜索如何将hammer.js 与meteor.js 一起使用时遇到了这个问题，所以我觉得我应该贡献我发现对我有用的东西。

在我的项目中，每个模板都有一个 javascript 文件，因此我可以组织我的助手和事件。

我在 template_name.js 里面有这个

```
Template.templatename.events({});
Template.templatename.helpers({});

if (Meteor.isClient) {

  $(function () {
    var hammertime = $('body').hammer({
      swipe_velocity: 0.45
    });

    hammertime.on('doubletap', '.listItem', function() {
      alert('yay');
    })
  });

} 
```

`'.listItem'`我的模板的一部分在哪里。刚刚在我的使用流星 0.7.0.1 运行 ios7 的手机上对其进行了测试，并且可以确认它的工作。显然我正在使用hammer.js 的jquery 插件，并将其加载到/client/js/ 中。但我看到这样做的唯一缺点是丢失“this”的数据上下文。如果我使用流星自己的事件，情况就不一样了。但我真的只需要上下文来访问 _id 'this' 我可以通过模板放入数据属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-14T16:21:35.560

我也一直试图让hammer.js 与Meteor 一起工作一段时间，但直到现在都没有成功。我刚刚发现你是如何让它工作的。事实证明这真的很容易。注意我在这里使用的是 jquery 版本的锤子。

```
Template.name.events({
    'swipe .article': function() {
        //your functions
    }
})

Template.name.rendered = function () {
    this.$('.article').hammer();
} 
```

# javascript - 一键生成2个事件

> ID：11278434
> 
> 赞同：0
> 
> 时间：2012-06-30T23:24:09.460
> 
> 标签：javascript, html, redirect, hyperlink, anchor

我正在做一个网站。我有一个带有按钮的页面。当用户单击按钮时，我希望发生以下两件事：

(1)。当前页面（带有按钮）重定向到新页面

(2)。链接的外部网页（比如 google）在新窗口中打开

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:28:14.857

先做2，再做1。

我的意思是，首先打开一个新窗口并更改页面而不是相反的顺序。

重定向检查：[如何在 JavaScript/jQuery 中重定向到另一个网页？](https://stackoverflow.com/questions/503093/how-can-i-make-a-redirect-page-in-jquery-javascript)

打开一个新窗口：[http ://www.w3schools.com/jsref/met_win_open.asp](http://www.w3schools.com/jsref/met_win_open.asp)

顺便说一句，您仍然只有一个事件，鼠标事件，您想要的是在同一代码块中将两个动作附加到同一事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:51:44.150

这是一个示例 HTML 页面，它将`yahoo`在当前窗口（您可以替换为您自己的页面）和`google`新窗口中打开。对于选项卡式浏览器，它将打开一个新选项卡而不是新窗口。您可以按任何顺序调用它。

```
<html>
<head>

<script type="text/javascript">
function openwindows()
{
window.open("http://www.yahoo.com", "_self")
window.open("http://www.google.com")
}
</script>

</head>
<body>
<input type="button" value="open" onclick="openwindows()"
</body>
</html> 
```

# html - html：为什么高度会因 doctype 而失败？

> ID：11278437
> 
> 赞同：2
> 
> 时间：2012-06-30T23:25:30.370
> 
> 标签：html, html-table, doctype

当我删除 DOCTYPE 行时，此代码按我想要的方式工作。当将鼠标悬停在“单元格”单元格上并单击单元格内的任意位置时，“A”链接会填充“单元格”单元格的整个单元格高度。注意：我需要使用 A，而不是 TD onclick javascript。我不明白为什么添加 DOCTYPE 会破坏它，或者我能做些什么来正确修复它，这让我发疯了。我正在使用 IE9，但希望它可以在所有浏览器中运行。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>X</title>
<style type="text/css">
table,td, th {border: 1px solid #000}
td a {display: block; height:100%; width:100%;}
td a:hover {background-color: yellow;}
</style>
</head>
<body>
<table>
<tr>
 <td>
    <a href="http://www.google.com/">Cell</a>
  </td>
  <td>
    <a href="http://www.google.com/"><img alt="x" src="http://www.google.com/intl/en_ALL/images/srpr/logo1w.png"></a>
  </td>
</tr>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:58:59.553

由于`<td>`未定义的高度（它在布局中确定），`height: 100%;`其子级的 被忽略。

设置的`height`和：`line-height``<td>`

```
td { height: 100px; line-height: 100px; } 
```

演示：http: [//jsfiddle.net/ThinkingStiff/twVar/](http://jsfiddle.net/ThinkingStiff/twVar/)

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>X</title>
    <style type="text/css">
        table,td, th {border: 1px solid #000}
        td a {display: block; height:100%; width:100%;}
        td a:hover {background-color: yellow;}
        td { height: 100px; line-height: 100px; }
        img { display: block; }
    </style>
</head>
<body>
<table>
    <tr>
    <td>
        <a href="http://www.google.com/">Cell</a>
    </td>
    <td>
        <a href="http://www.google.com/"><img alt="x" src="http://www.google.com/intl/en_ALL/images/srpr/logo1w.png"></a>
    </td>
    </tr>
</table>
</body>
</html> 
```

​</p>

# c++ - 链接对象和静态库

> ID：11278438
> 
> 赞同：5
> 
> 时间：2012-06-30T23:25:30.620
> 
> 标签：c++, linker, makefile, g++, gmp

我很难弄清楚在执行链接时要传递给 g++ 的标志。基本上，我用这些“标准”标志编译了一些代码：

```
CXXFLAGS = -Wall -Wextra -Wconversion -pedantic -std=c++0x -O2 
```

然后，我将生成的 .o 文件合并到几个静态库中，如下所示：

```
libxxx.a: xxx1.o xxx2.o ...
    ar rcs $@ $^
libyyy.a: yyy1.o yyy2.o ...
    ar rcs $@ $^
... 
```

问题：

*   `-static`编译 .o 文件时是否需要在 CXXFLAGS 中使用该标志？

创建静态库后，我想将一些已编译的 .o 文件与其中一些库链接在一起，以构建可执行文件，因此我使用它：

```
LINKER = g++
LIB_DIR = lib/linux
SYSTEM_LIBS = -lgmp
LDFLAGS = -Wall -L $(OUTPUT_DIR) -L $(LIB_DIR) $(SYSTEM_LIBS)
$(LINKER) $^ $(LDFLAGS) -lsvm -lUtils -lKinderedSpirits -o $@

exe:
    $(LINKER) o1.o o2.o $(LDFLAGS) -lxxx -lyyy -lzzz -o $@ 
```

问题：

~~- 我应该在这里使用`-static`旗帜吗？~~ -`-Wall`这里有什么意义还是只对编译有用？- 是否有任何其他“标准”标志需要传递给链接器，类似于为编译器推荐的标志？

此外，在链接期间，它给了我关于 GMP 库中未定义引用的例外情况。据我所知，-lgmp 被发送到链接器并安装在系统上（我能够从命令行编译一个使用 GMP 的简单 hello world）和 libxxx.a libyyy.a libzzz.a位于 $(LIB_DIR)。也许我应该提到在 libxxx.a 中使用了 GMP 符号。

* * *

**更新**：

我设法修复了 GMP 符号的未定义引用。这个问题是由我放置库的顺序引起的。基本上，如此处所指定[，](https://stackoverflow.com/a/492498/1174378)我需要在 -lgmp 之前引用依赖于 GMP 的库。无论如何，我仍在寻找上述~~3 个~~问题的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:02:13.753

问：我是否也应该在这里使用 -static 标志？答：可能没有必要。这个标志只是使得不可能意外链接到动态库中。

问：-Wall 在这里有意义还是仅对编译有用？A：我相信它只是为了编译。（仅供参考，大写的 W 后跟单词“all”你想要编译期间的所有警告）

问：是否有任何其他“标准”标志需要传递给链接器，类似于为编译器推荐的标志？答：我不知道。您可以在此处找到常用选项：http: [//gcc.gnu.org/onlinedocs/gcc/Link-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)

您是否遇到任何您想粘贴的特定错​​误？

# python - 组织 Python 应用程序

> ID：11278449
> 
> 赞同：1
> 
> 时间：2012-06-30T23:27:03.440
> 
> 标签：python

我有一个 Python 应用程序，我有一个关于打包的问题，​​这实际上不是一个 distutils 问题，而是一个关于如何组织和设置应用程序以便从命令行轻松使用它的问题。

假设应用程序包含一个包，并暂时假设我不一定想将其设为 distutils 包（尽管我可能会被劝阻。）

程序本身作为 SNMP 子代理，由 Net-SNMP 使用 pass_persist 运行。这对于这个问题并不是特别重要，它只是意味着整个程序是 exec'd，并读取 stdin 并在 stdout 上做出响应。

进一步假设代理以或多或少的规范 Python 方式构建

```
 agent
      __init__.py
      main.py
      <other modules at the same level> 
```

`main.py`是一个简单的程序，比如

```
#!/usr/bin/env python
import sys
def main(argv):
    <initialize the environment, input output, logging and so on>
    while <not done>:
         <process an input>
    <clean up and terminate>

if __name__ == '__main__':
    main(sys.argv) 
```

似乎只有几种方法可以组织它来运行：

将包放在站点包中的某个位置，并在 PATH 中有一个顶级程序，例如

```
#!/usr/bin/env python
from agent import main
main(sys.argv) 
```

将包目录放在某处并使用运行它

```
/path/to/directory/agent/main.py 
```

（凹凸版本是将代理目录放在路径中的某个位置，以便您可以运行`main.py`）

或者第三种，更 Pythonic 和更酷的方法，让我可以安装代码并将一些我不知道的东西直接放入路径中。

谷歌搜索没有太大帮助，我怀疑这是那些“太愚蠢而无法回答”的问题之一。不幸的是，我太笨了，不知道这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T02:26:11.883

您列出的第一个选项是执行此操作的常用“Pythonic 和酷”方法。您也可以使用[Distribute](http://packages.python.org/distribute/)来管理它，这样可以更方便地开发它。完成后打包或安装。Distribute 系统可用于管理您的开发以及用作打包工具。它还为您生成启动器脚本。您在您的中定义[入口点](http://packages.python.org/distribute/setuptools.html#automatic-script-creation)`setup.py`，它将为您创建顶级启动器脚本。

开发时，您可以设置[开发模式](http://packages.python.org/distribute/setuptools.html#development-mode)来设置 Python 环境以在工作区中查找您的包。因此，下次运行时，任何更改都会立即可见。然后，在它开发完成后，您可以将其打包为一个鸡蛋，甚至可以从同一源构建一个 RPM 或 Windows 安装程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T01:06:10.087

“将包目录放在某处”是其中的大部分内容。剩下的就是编写一个`exec`在 python 解释器上使用的 shell`main.py`脚本。

```
#!/bin/sh
exec python /usr/share/myapp/main.py "$@" 
```

# php - 登录表单不会获取登录信息

> ID：11278453
> 
> 赞同：0
> 
> 时间：2012-06-30T23:28:04.637
> 
> 标签：php

我有一个使用电子邮件和密码设置的数据库，我正在尝试使用下面的代码检查用户名（电子邮件）和密码，以确保它们正确，如果它们不正确则将它们发送到 /cms匹配，弹出框出现。我只是开始工作。你能看到任何会导致这种情况的问题吗？

```
session_start();

require_once("../mydbpassword.php");
if($_POST['username']) {

$username = $_POST['username'];
$password = $_POST['password'];

$sql = "SELECT * FROM agents WHERE email = '$username' AND pword = '$password'";
$result = mysqli_query($mysqli,$sql);

$email = $row['email'];
$pword = $row['pword'];

if(($username != $email) || ($password != $pword)) {
echo'<script type="text/javascript">
    window.alert("Your login information is wrong, try again!");
    window.location="/cms/login"
    </script>';
}
else {
$row = mysqli_fetch_assoc($result);
$_SESSION['admin'] = $row['$email'];
header("Location: /cmsS");
exit();

}
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:57:19.590

转变

```
$result = mysqli_query($mysqli,$sql); 
```

到

```
$result = mysqli_fetch_assoc(mysqli_query($mysqli,$sql)); 
```

此外，您还有很多事情需要修复。像散列密码、安全查询、更好的重定向/错误系统（js 可能被禁用或容易被黑客入侵/更改）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:05:52.963

## 该变量可以设置但为空。

```
if($_POST['username']) 
```

经过

```
if (!empty($_POST['username'])) 
```

## 防止 MySQL 注入，只获取密码。

```
$sql = "SELECT * FROM agents WHERE email = '$username' AND pword = '$password'"; 
```

经过

```
$sql = 'SELECT password FROM agents WHERE email = "'.mysql_real_escape_string($username).'"'; 
```

## 正确的 MySQL 字符串关联

```
$result = mysqli_query($mysqli,$sql); 
```

经过

```
$result = mysqli_fetch_assoc(mysqli_query($mysqli,$sql)); 
```

## 还有一张真正有意义的支票

```
if ($password != $pword || empty($pword)) {
    echo'<script type="text/javascript">
    window.alert("Your login information is wrong, try again!");
    window.location="/cms/login"
    </script>';
} 
```

# ios - 在 iPhone 上学习图形/游戏

> ID：11278456
> 
> 赞同：-1
> 
> 时间：2012-06-30T23:29:38.857
> 
> 标签：ios, iphone, cocoa-touch, opengl-es, core-graphics

我想学习一些图形，从而在 iPhone 中进行游戏编码。我在基于导航/选项卡/视图的应用程序方面有经验，但从未在 OpenGL 或 Quartz 上工作过。

谁能引导我踏上这一激动人心的新图形之旅。请推荐教程、会议视频、示例视频......基本上任何可以帮助我理解相关概念的东西。

PS：我有一个开发者账号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:49:07.443

这里有几个很好的**免费**资源：

*   [WWDC 2012 视频](https://developer.apple.com/videos/wwdc/2012/)- 特别是：“OpenGL 和 OpenGL ES 的进步”和“OpenGL ES 工具和技术”
*   [Core Animation - Mac 和 iPhone 开发的简化动画技术](https://rads.stackoverflow.com/amzn/click/com/0321617754)- 关于 Core Animation 和 Quartz 2D 的书籍
*   [iPhone 3D 编程](http://ofps.oreilly.com/titles/9780596804824/)- OpenGL 书籍
*   [OpenGL ES Programming Guide for iOS](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html) - 关于 OpenGL 及其与 iOS 集成的完整 Apple 文档
*   [All About OpenGL 2.x](http://db-in.com/blog/2011/01/all-about-opengl-es-2-x-part-13/) - 三部分系列（初级、中级、高级），非常透彻
*   [Quartz 2D Programming Guide](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/Introduction/Introduction.html) - Apple 自己的 Quartz 文档
*   [你必须知道的 18 个 OpenGL ES 资源！](http://maniacdev.com/2009/10/18-opengl-es-resources-that-you-must-know/)- 不仅包含 OpenGL 资源，还包含 3D 图形的数学知识
*   [The Categorized OpenGL ES Tutorial Collection](http://maniacdev.com/2009/09/the-categorized-opengl-es-tutorial-collection/) - 超过 50 个教程和指南的集合
*   [OpenGL ES from the Ground Up](http://iphonedevelopment.blogspot.com/2009/05/opengl-es-from-ground-up-table-of.html) - 很棒的初学者教程
*   [gamedev.net](http://www.gamedev.net/) - 一个很棒的网站，拥有很棒的社区和许多资源

这些都是好书和视频。还要确保查看[Ray Wenderlich 的网站](http://www.raywenderlich.com/)；它包含许多优秀的、完整的初学者教程。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:55:39.883

我建议你也考虑使用 Cocos2d、Box2d 或类似的东西。这是一本好书。

[http://www.amazon.com/Learning-Cocos2D-Hands-On-Building-Chipmunk/dp/0321735625/ref=sr_1_2?ie=UTF8&qid=1341100387&sr=8-2&keywords=cocos2d](https://rads.stackoverflow.com/amzn/click/com/0321735625)

Ray Wenderlich 在他们的网站上还有一个游戏编程入门工具包，您可以考虑购买 - [http://www.raywenderlich.com/store/space-game-starter-kit](http://www.raywenderlich.com/store/space-game-starter-kit)

# sql - 名为“order”的字段的教义语法错误

> ID：11278457
> 
> 赞同：25
> 
> 时间：2012-06-30T23:30:02.477
> 
> 标签：sql, ajax, jquery, symfony

我有以下ajax调用

```
var prev_sibling = $(this).prev().attr("value");
var next_sibling = $(this).next().attr("value");
var order = (prev_sibling + next_sibling)/2; 
var data = {PID:element_id, TGID:parent_id, ORD:order};
$.ajax({
        type: "POST",
        data: data,
        url:"{{ path('v2_pm_patents_dragpatents') }}",
        cache: false
}); 
```

在我的行动中，我得到了订单并像这样设置它

```
$order = $request->get('ORD');
$patent->setOrder($order); 
```

但是ajax调用给了我以下错误

```
Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#039;order = &#039;750&#039; WHERE id = &#039;0d0c0810-bc75-11e1-96a5-9787dec335c2&#039;&#039; at line 1 (500 Internal Server Error) 
```

我正确地获取了发布数据，并且为我提供这些记录的查询也可以正常工作。

问题出在哪里？

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-06-30T23:55:40.713

问题是`order`MySQL 中的保留字。如果您正在使用学说，您可以告诉它在映射中转义保留字，如下所示：

```
/** @Column(name="`order`", type="integer") */
private $order; 
```

[http://docs.doctrine-project.org/en/latest/reference/basic-mapping.html#quoting-reserved-words](http://docs.doctrine-project.org/en/latest/reference/basic-mapping.html#quoting-reserved-words)

# javascript - Javascript Regex - 假装后视的意外行为

> ID：11278459
> 
> 赞同：3
> 
> 时间：2012-06-30T23:30:17.333
> 
> 标签：javascript, regex, lookbehind, negative-lookbehind

我正在尝试编写一个小部件来整理来自多个来源的推文作为练习（类似的东西存在[这里](https://twitter.com/about/resources/widgets)，但是a）那里提供的列表选项没有加载我的任何列表，并且b）这是一个有用的学习练习！）。作为其中的一部分，我想编写一个正则表达式，用指向用户 Twitter 页面的链接替换 ​​Twitter 句柄（'@' 后跟字符）。但是，我不希望出现误报，例如，推文中的电子邮件地址。

因此，例如，替换应该发送

```
Hey there @twitteruser, my email address is address@gmail.com 
```

到

```
Hey there <a href="http://twitter.com/twitteruser">@twitteruser</a>, my email address is address@gmail.com 
```

[在这个问题](https://stackoverflow.com/questions/641407/javascript-negative-lookbehind-equivalent)的指导下，这表明我需要某种方式在 Javascript 中复制负面的后视，我编写了以下代码：

```
tweetText = tweetText.replace(/(\S)?@([^\s,.;:]*)/ig, function($0, $1){
    return $1 ? $0 + '@' + $1 : '<a href="http://www.twitter.com/' + $0 + '">@' + $0 + '</a>'
}); 
```

但是，在触发三元运算符的最后部分的情况下，$0 包含“@”符号。这出乎我的意料——因为 '@' 没有括在括号中，我希望 $0 匹配 '([^\s,.;:]*)' - 即 Twitter 用户的用户名（之后，和没有，'@'）。我可以通过使用 $0.substring(1) 获得所需的功能，但我想进一步了解。

有人可以指出我误解了什么吗？我对正则表达式很陌生，从来没有用 Javascript 编写过它们，也没有使用过负面的后视。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T00:02:45.063

在任何情况下，与其尝试在 之前匹配可选的非空格`@`，并在找到匹配时拒绝匹配，为什么不在 ? 之前只需要一个空格（或字符串的开头）`@`？

```
tweetText = tweetText.replace(
    /(^|\s)@([^\s,.;:]*)/g,
    '$1<a href="http://www.twitter.com/$2">@$2</a>'
); 
```

这不仅更简单，而且速度也可能更快，因为正则表达式需要考虑的潜在匹配项要少得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T23:50:46.770

与大多数 REGEX 实现中的标准行为一样，匹配零是整个匹配（包括作为其中一部分的任何子匹配 - 甚至任何标记为非捕获的），然后任何后续匹配都是捕获的子匹配。查看 www.regular-expressions.info。例如：

```
console.log('hello, there'.match(/\w+(?:,) ?(\w+)/)); 
```

给你数组

```
["hello, there", "there"] //the first sub-match is non-capturing 
```

JavaScript 不支持后视，但对此有模拟，但并不完美，[就像我写的那样](http://www.mitya.co.uk/blog/2011/Feb/Simulating+REGEX+look-behinds+in+JavaScript-153?highlight=regexp)。JavaScript 的 REGEXP 实现总体上比其他一些语言要弱。一些遗漏的例子包括：

*   回顾
*   命名原子团
*   大多数修饰符（尽管关键的修饰符在那里 - 全局，不区分大小写和多行）
*   至关重要的是，能够在全局匹配的同时捕获子组

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-30T23:52:44.020

我想你可能把事情复杂化了。试试这个来检索用户名，然后创建自己的辅助函数来创建标记。

```
var getTwitter = function (str) {
  var re = /[^\w](@\w+)/g,
      matches = [],
      tweets = []
  while (matches = re.exec(str))
    tweets.push(matches[1])
  return tweets
} 
```

**演示：http:** [//jsfiddle.net/elclanrs/gLvX4/](http://jsfiddle.net/elclanrs/gLvX4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T03:06:01.897

你太复杂了，没那么复杂。您可以在一行代码中完成所有操作，只需执行此操作`\W@(\w+)`

现场演示[http://jsfiddle.net/Victornpb/Wugvd/](http://jsfiddle.net/Victornpb/Wugvd/)

```
//make twitter username links
function linkTwitterNames(elm){
    elm.innerHTML = elm.innerHTML.replace(/\W@(\w+)/g, ' <a class="twitter" href="http://twitter.com/$1" target="_blank">@$1</a>');
} 
```

# jquery - 警报 jquery 帮助，需要其文本进入 div/span

> ID：11278460
> 
> 赞同：-1
> 
> 时间：2012-06-30T23:30:28.597
> 
> 标签：jquery, json

我有这个脚本，想把它添加到一个特定的 div 中。现在它只是通过弹出窗口发出警报。

```
function getTime(zone, success) {
    var url = 'http://json-time.appspot.com/time.json?tz=' + zone,
        ud = 'json' + (+new Date());
    window[ud]= function(o){
        success && success(new Date(o.datetime));
    };
    document.getElementsByTagName('head')[0].appendChild((function(){
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = url + '&callback=' + ud;
        return s;
    })());
}

getTime('US\/Hawaii', function(time){
    // This is where you do whatever you want with the time:
    alert(time);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:36:53.817

javascript:

```
$("div#specific_id").append(time); 
```

html:

```
<div id="specific_id">the time will be added after this text</div> 
```

I think you should see the documentation

**EDIT:** @Blender have make this helping snippet, to make everything clear: [http://jsfiddle.net/eytkU/2/](http://jsfiddle.net/eytkU/2/)

# android - 调用 GCMRegistrar.register() 时泄漏 IntentReceiver 错误

> ID：11278464
> 
> 赞同：5
> 
> 时间：2012-06-30T23:31:28.930
> 
> 标签：android, google-cloud-messaging

我正在尝试从谷歌的 Android 开发者网站完成[谷歌 GCM](http://developer.android.com/guide/google/gcm/gs.html)的入门步骤。

当我的设备尝试注册时，它失败了，原因如下：

> Activity 已从最初在此处注册的 com.google.android.gcm.GCMBroadcastReceiver 泄露了 IntentReceiver。您是否错过了对 unregisterReceiver 的呼叫？

这是代码：

```
GCMRegistrar.checkDevice(this);
GCMRegistrar.checkManifest(this);
final String regId = GCMRegistrar.getRegistrationId(this);
if (regId.equals("")) {
    GCMRegistrar.register(this, senderId); // <-- It fails here
} else {
    Log.v("GCM", "Already registered");
} 
```

任何想法？

我究竟做错了什么？

**更新**

这是我的清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.sample"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <permission android:name="com.sample.permission.C2D_MESSAGE" android:protectionLevel="signature" />

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="com.sample.permission.C2D_MESSAGE" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

        <activity
            android:name=".sample"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:theme="@android:style/Theme.NoTitleBar" android:name=".Main" android:screenOrientation="portrait" />
        <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
          <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
            <category android:name="com.sample" />
          </intent-filter>
        </receiver>               
        <service android:name="com.sample.GCMIntentService" />
        <uses-library android:name="com.google.android.maps" />
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-03T09:53:32.170

最后它起作用了。

我需要做的就是`GCMRegistrar.onDestroy(this)`在`onDestroy()`我正在调用的同一上下文中调用方法`GCMRegistrar.register()`

在这里找到：[Google Cloud Messaging 中泄露的 IntentReceiver](https://stackoverflow.com/questions/11299312/leaked-intentreceiver-in-google-cloud-messaging)

谢谢你的支持 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T12:04:24.813

您应该使用应用程序上下文，而不是像下面这样的活动上下文：

```
public String registerPushAccount()
{
    GCMRegistrar.checkDevice(getApplicationContext());
    GCMRegistrar.checkManifest(getApplicationContext());
    if (GCMRegistrar.isRegistered(getApplicationContext()))
    {
        Log.d("info", GCMRegistrar.getRegistrationId(getApplicationContext()));
    }
    String regId = GCMRegistrar.getRegistrationId(getApplicationContext());
    if (regId.equals(""))
    {
        regId = GCMRegistrar.getRegistrationId(getApplicationContext());
    }
    else
    {
        Log.d("info", "already registered as" + regId);
    }
    Log.d("info", regId);
    return regId;
} 
```

这解决了我的问题。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T09:02:09.227

我已经让它与这个清单一起工作：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="PACKAGENAME"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <permission android:name="PACKAGENAME.permission.C2D_MESSAGE" android:protectionLevel="signature" />
    <uses-permission android:name="PACKAGENAME.permission.C2D_MESSAGE" /> 
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <permission android:name="android.permission.WAKE_LOCK" android:protectionLevel="signatureOrSystem"/>
    <uses-permission android:name="android.permission.WAKE_LOCK"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <service android:name="PACKAGENAME.GCMIntentService" />
        <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >

  <intent-filter>
    <action android:name="com.google.android.c2dm.intent.RECEIVE" />
    <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
    <category android:name="PACKAGENAME" />
  </intent-filter>
</receiver> 
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

还要向您的类添加一个空构造函数，该构造函数从 GCMBaseIntentService 扩展。在我的例子中命名为：GCMIntentService。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T10:52:56.340

当我没有正确设置权限时，这发生在我身上。我通过在清单中添加来解决它：

```
<permission android:name="PACKAGE.permission.C2D_MESSAGE" android:protectionLevel="signature" />
<uses-permission android:name="PACKAGE.permission.C2D_MESSAGE" /> 
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
<uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

# boost-gil - 如何使用 boost::gil 加载任何典型的 png 文件

> ID：11278465
> 
> 赞同：1
> 
> 时间：2012-06-30T23:32:03.517
> 
> 标签：boost-gil

我已经配置了我的环境，以便可以将适当制作的 .png 文件加载到如下定义的图像中：

```
 boost::gil::rgb8_image_t input; 
```

但是如何加载任何典型类型的 png 文件（例如由 GIMP 或 MS Paint 生成）。我认为它需要 boost::gil::any_image 但我不知道我需要配置它的类型。

我试过了：

```
 typedef boost::mpl::vector<
            boost::mpl::rgba8_planar_image_t,
            boost::mpl::rgba8_image_t,
            boost::mpl::rgb8_planar_image_t,
            boost::mpl::rgb8_image_t,
            boost::mpl::gray8_image_t
        > my_img_types;
        boost::mpl::any_image<my_img_types> input;
        boost::gil::png_read_image(ipath, input); 
```

但这不会加载由 MS Paint 或 GIMP 创建的文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T23:09:39.810

您是否尝试过使用函数族 png_read_and_convert_*

例如：

```
boost::gil::rgb8_image_t input;
boost::gil::png_read_and_convert_image(ipath, input); 
```

这样你会丢失图像的原始类型，但是如果你想要一个固定的类型让你的代码来操作这可能是一个好方法。

# c# - 尝试使用 Entity Framework 4 删除对象时出错

> ID：11278468
> 
> 赞同：0
> 
> 时间：2012-06-30T23:32:28.887
> 
> 标签：c#, entity-framework-4

在使用 Entity Framework 4 时尝试删除数据库中的对象时出现以下错误。

> “无法更新 EntitySet 'SampleDetails'，因为它有一个 DefiningQuery 并且元素中不存在支持当前操作的元素。”

这似乎是谷歌上有很多解决方案的常见问题，但似乎对我没有任何帮助。受影响的表有一个由三个字段组成的复合主键。

我曾尝试删除`<DefiningQuery>`元素，但一开始我无法从数据库中读取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:50:09.550

您需要将主键添加为**单独的列**，例如添加`SampleDetailsID`到 SampleDetails。

# python - 下载直到在 Python 中达到某个点

> ID：11278469
> 
> 赞同：0
> 
> 时间：2012-06-30T23:32:47.783
> 
> 标签：python, sockets, urllib2

我正在制作一个 Python 脚本来验证 Wikipedia 链接链是否有效。例如，链

```
List of jōyō kanji > Elementary schools in Japan > Education > Knowledge 
```

是有效的，因为您只能通过单击链接访问每个页面。

这里的问题是这些页面真的很长并且下载整个页面，检查链接是否在页面中并重复所有步骤将需要很长时间。链条也可能更长。

所以我想知道的是我是否可以使用`urllib2`（或任何其他库）下载每个页面并告诉它在需要时停止，或者这只会给 CPU 增加更多负载并使事情变得更糟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:21:23.867

为什么要重复这些步骤。您应该能够并行执行它们，因为每个步骤都应该彼此独立。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T17:36:26.250

我找不到使用 urllib2 执行此操作的方法，但是使用原始套接字有一个明显的解决方案：

```
import urlparse

def found(text, data):
     # return True if text was found in data

def get_title(url):
    parsed_url = urlparse(url)
    host = parsed_url.netloc
    path = parsed_url.path
    port = 80

    web = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        web.connect((host, port))
    except Exception:
        return

    web.send('GET %s HTTP/1.1\n' % path)
    web.send('Host: %s\n' % host)
    web.send('\n')

    done = False
    while not done:
        data = web.recv(2048)
        if len(data) > 0 and found("text", data):
            web.shutdown(socket.SHUT_RDWR)
            web.close()
            title = title_match.group(1)
            done = True

    # Do something 
```

这样一来，您就可以在找到相关数据后停止下载，并避免从大型网页下载不必要的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T23:34:23.947

您最好使用来自 Wikipedia的[静态快照。](http://en.wikipedia.org/wiki/Wikipedia%3aDatabase_download)

# java - 获取 Java EE 项目中的相对路径

> ID：11278474
> 
> 赞同：0
> 
> 时间：2012-06-30T23:33:49.193
> 
> 标签：java, jsp, jakarta-ee

我有一个普通的 Java 类（既不是 JSP 也不是 Servlet），它对文件执行一些处理，例如读取、写入和执行一些可执行文件。如何知道每个文件的相对路径？

我知道`getClass().getResourceStream()`，但这仅对读取文件有用。我知道，`getServletContext().getRealPath()`但我的代码在普通的 Java 类中，而不是 servlet。

我想做以下

```
String relativePath = "path/to/exe";
Runtime.getRuntime.exec(relativePath); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:56:22.297

> *我知道，`getServletContext().getRealPath()`但我的代码在普通的 Java 类中，而不是 servlet*

只需将其结果传递给 Java 类。

```
String desiredPath = calculateItSomehowBasedOn(getServletContext().getRealPath("/"));
yourJavaClass.executeExe(desiredPath); 
```

请注意，当部署的 WAR 不是在本地磁盘文件系统中展开，而是在内存中展开时，`getRealPath()`将会返回。`null`一些生产服务器配置可以做到这一点。

更好的是将exe文件的位置设置为配置文件。例如

```
path.to.exe = /absolute/path/to/exe 
```

该配置文件可以依次放置在类路径中，或者可以将其路径添加到类路径中。另请参阅[在哪里放置以及如何在基于 servlet 的应用程序中读取配置资源文件？](https://stackoverflow.com/questions/2161054/where-to-place-configuration-properties-files-in-a-jsp-servlet-web-application/2161583#2161583)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:01:05.127

您的问题似乎针对 Java SE 而不是 Java EE。我假设您的“exe”文件相对于您的 java 项目？要获取绝对路径，您可以使用：

```
File f = new File("path/to/exe");
String exePath = f.getAbsolutePath(); 
```

然后你可以使用绝对路径来发出你的命令。另请参阅：[File 的 JavaDoc](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)。

# java - 同步块：其他变量“内部”的变量是否已更新

> ID：11278476
> 
> 赞同：4
> 
> 时间：2012-06-30T23:34:28.123
> 
> 标签：java, android, synchronized-block

很抱歉这个非技术性的标题，但我认为它很好地总结了我的问题。如果我正确解释了我读过的内容，同步块（除了其他后果）将使所有变量更新到主内存/从主内存更新（即使是那些在同步块内没有显式访问的变量，只有它们的“父”？） . 例如引用[这个](https://stackoverflow.com/questions/8324064/java-arrays-synchronized-atomic-or-synchronized-suffices)stackoverflow问题的答案（我把它断章取意，我稍后会回到它）：

> 内存屏障适用于所有内存引用，甚至是不相关的内存引用。

我需要确认我是否正确解释了这一点。我有 2 个线程（线程 A、线程 B）。考虑以下代码：

```
public class SomeClass {

private final Object mLock = new Object();
private int[] anArray;

public void initA() {
  synchronized(mLock) {
     ...
     anArray = new int[...];
     operationA();
  }
}

public void operationA() {
  synchronized(mLock) {
      // Manipulating the ELEMENTS of anArray,
      // e.g. in loops, etc.
      anArray[i] = ...
  }
}

public int[] getterB() {
   synchronized(mLock) {
      return anArray;   
   }
}
} 
```

`getterB()`从*ThreadB*调用，从`initA()`ThreadA*调用*。（请注意，甚至在创建*ThreadB*之前调用它，因此只有和是并发的。）还要注意，我有充分的理由不返回数组的*副本*（不，*threadB*不想*更改*其元素；原因是我的软件的外部要求，现在不相关）。`operationA()`*`initA()`*`getterB()``operationA()`*`getterB()`***

 ***线程B这样做：

```
int[] anArray = aSomeClass.getterB(); // aSomeClass is an instance of SomeClass
if (anArray[i] == n) { ....... } // various operations
...
//  various other operations that read the elements of anArray 
```

如您所见，在内存屏障中`getterB()`仅`anArray`访问引用，而不是数组值本身。我的问题：

1.  threadB 会*看到*最新的数组元素值吗？（即元素本身是否也从主内存更新`getterB()`？）

2.  引用的声明提到**不相关**的缓存副本也从主内存更新。我不是 100% 如何解释这个不相关的（与用于锁定的变量无关？或与整个同步块无关？）。我知道我把引用断章取义了，因为这是一个不同的 stackoverflow 问题，所以我在[那里](https://stackoverflow.com/questions/8324064/java-arrays-synchronized-atomic-or-synchronized-suffices)添加了评论。所以我很感激我的这个问题是否在那里（或这里——我不在乎）得到了回答。

3.  `anArray`如果是*对象数组*（而不是原始类型），答案有什么不同吗？更进一步，如果它不是一个数组，而是一个包含对其他类的引用的类怎么办？（即引用其他对象的对象，*我*通过返回的对象访问包含的对象`getterB()`）。threadB 会*使用* **这些包含引用的最新副本**，还是使用它自己的本地缓存副本（因为`getterB()`只更新了它们的容器对象，而不是包含的引用本身）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T01:45:47.680

按顺序回答您的问题：

1.  是的：您可以放心地假设从任何先前调用的任何修改的所有值`operationA()`都将在`getterB()`.

2.  我会在另一个链接中回答这个问题；我承认我还没有阅读那个链接。但我的理解是，当您进入和退出同步块时，*所有*挂起的内存写回都将“有效”发生（尽管这是如何发生的细节 - 即效率，以及是否有更多的缓存/流水线让它*看起来*那样的“技巧”——将取决于硬件和编译器）。如果您想了解更多详细信息，我曾经发现此链接很有用：http: [//www.infoq.com/articles/memory_barriers_jvm_concurrency](http://www.infoq.com/articles/memory_barriers_jvm_concurrency)

3.  不，没有区别（鉴于我在答案 2 中写的）。

最后，只是一个评论，我会对上面总结的代码非常警惕，因为`getterB()`它不会返回数组的副本。我了解您以上述方式这样做是有原因的（并且您不想要这种反馈！），但是您应该确保了解线程中的所有“各种操作”都`B`发生`anArray`在之后`getterB()`已返回将不受保护。（换句话说，`A`在此期间对线程上的数组所做的任何更改都会有风险。）避免低效的深度数组复制的一种替代方法是将这些“各种操作”移动到新方法中的同步块中。`SomeClass`并摆脱`getterB()`完全。当然，我意识到代码中的“正确解决方案”取决于此处未显示的许多内容，因此请随意忽略这一点。***

# asp.net-mvc - MVC 3 验证不同类中的 2 个字段

> ID：11278478
> 
> 赞同：1
> 
> 时间：2012-06-30T23:34:52.803
> 
> 标签：asp.net-mvc, validation, viewmodel

我有一个视图模型，里面有 2 个对象

```
class trip
{
    public DateTime returnedDate {get;set;}
    ....
}

class personData
{
   public DateTime PassportExpDate {get;set;}
    ....
} 
```

ViewModel 包含这两个对象

如何实现验证，以便 PassportExpDate > returnedDate

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T06:05:16.500

[使用FluentValidation.NET](http://fluentvalidation.codeplex.com/)和带有数据注释的 PITA呈现完全微不足道的场景。

所以这里是简单的步骤：

1.  安装`FluentValidation.MVC3`NuGet 包
2.  在以下位置注册 FV 提供者`Application_Start`：

    ```
    FluentValidationModelValidatorProvider.Configure(); 
    ```

3.  设计你的视图模型（备注：这不是一个纯视图模型，纯视图模型不应该对领域模型进行任何引用，但出于本演示的目的，我将保留它）：

    ```
    [Validator(typeof(MyViewModelValidator))]
    public class MyViewModel
    {
        public Trip Trip { get; set; }
        public PersonData PersonData { get; set; }
    } 
    ```

4.  现在为视图模型定义相应的 FV 验证器：

    ```
    public class MyViewModelValidator : AbstractValidator<MyViewModel>
    {
        public MyViewModelValidator()
        {
            RuleFor(x => x.Trip.ReturnDate)
                .LessThan(x => x.PersonData.PassportExpDate)
                .WithMessage("You wanna get arrested?");
        }
    } 
    ```

5.  控制器：

    ```
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            var model = new MyViewModel
            {
                Trip = new Trip
                {
                    ReturnDate = new DateTime(2012, 8, 13)
                },
                PersonData = new PersonData
                {
                    PassportExpDate = new DateTime(2012, 8, 12)
                }
            };
            return View(model);
        }

        [HttpPost]
        public ActionResult Index(MyViewModel model)
        {
            return View(model);
        }
    } 
    ```

6.  看法：

    ```
    @model MyViewModel

    @using (Html.BeginForm())
    {
        <div>
            @Html.LabelFor(x => x.Trip.ReturnDate)
            @Html.EditorFor(x => x.Trip.ReturnDate)
            @Html.ValidationMessageFor(x => x.Trip.ReturnDate)
        </div>
        <div>
            @Html.LabelFor(x => x.PersonData.PassportExpDate)
            @Html.EditorFor(x => x.PersonData.PassportExpDate)
            @Html.ValidationMessageFor(x => x.PersonData.PassportExpDate)
        </div>

        <button type="submit">OK</button>
    } 
    ```

# ruby-on-rails - rspec with dynamic conditions

> ID：11278479
> 
> 赞同：2
> 
> 时间：2012-06-30T23:34:57.687
> 
> 标签：ruby-on-rails, ruby, rspec

I would like to include some dynamic data in my test output.

if I write a test like this then it prints out "it should have '' things"

I figure I'm getting confused with rspec's magic and ruby's blocks as closures.

I can stick at count in a method outside the block but that seems hack-ish.

Any pointers?

```
describe 'things' do
  before :all do
    @count = 3
  end

  it "should have #{@count} things" do
    #....
    page.should have_content("entries: #{@count}")
  end

end 
```

if I write a test like the above then it prints out "it should have '' things"

Edit: Another, more specific example

```
describe 'things' do
  before :all do
    @thing = FactoryGirl.create(:thing)
  end

  it "should display a thing with name #{@thing.name} " do
    #....
    page.should have_css("h1", text: @thing.name)
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T23:46:24.260

**实例变量在it**方法中不起作用，但常量可以。我喜欢根据**描述**块来命名它。

```
describe 'things' do
  THINGS_COUNT = 3

  it "should have #{THINGS_COUNT} things" do
    #....
    page.should have_content("entries: #{THINGS_COUNT}")
  end
end 
```

**编辑**：使用常量可确保您无法更改该值。

**编辑 2**：动态变量应该更通用，绝不应该使用活动记录对象。

我使用*动态变量*的一个常见模式是用于具有不同输入/输出的类似测试。

```
[ 
  [1, true],
  [2, false],
  [3, true]
].each do |number, result|
  it "should return #{result} for #{number}" do
    number.odd?.should == result
  end
 end 
```

在这种情况下，您可以干燥您的测试，并且更容易测试不同的变化。

最好使用`let(:person) { Factory.create(:person) }`或`before(:each)`用于特定的活动记录对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-30T23:44:23.330

```
it "should have #{@count} things" do 
```

在定义实例变量之前进行评估，因此它将是`nil`.

但是，您可以在块之外定义变量`before`，它将起作用。

```
describe 'things' do
  count = 3

  it "should have #{count} things" do
    #....
    page.should have_content("entries: #{count}")
  end

end 
```

***编辑：***您可以访问块中的顶级变量。

# android - Android set ringtone works only first time

> ID：11278481
> 
> 赞同：2
> 
> 时间：2012-06-30T23:35:23.973
> 
> 标签：android, file, ringtone

i am having a small problem with my android application. I have some mp3 files in my app which i want to be able to set as default ringtone or notification. I followed the instructions on this post [Setting Ringtone in Android](https://stackoverflow.com/questions/1986756/setting-ringtone-in-android) and it kind of works.

here is my code:

Creating the file to set as ringtone:

```
public static String createFile(String raw, int choice){
    File newSoundFile = null;
    String path = (choice == 0) ? "/mnt/sdcard/media/mySoundsRingtone.mp3" : "/mnt/sdcard/media/mySoundsNotification.mp3";
    newSoundFile = new File(path);
    if(newSoundFile.exists()){
        try {
            newSoundFile.delete();
        } catch (Exception e) {
            Toast.makeText(cont, "delete failed", Toast.LENGTH_SHORT).show();
            return null;
        }

    }

    try {
        newSoundFile.createNewFile();
    } catch (IOException e) {
        Toast.makeText(cont, "file creation failed", Toast.LENGTH_SHORT).show();
        return null;
    }
    //Toast.makeText(cont, "file created", Toast.LENGTH_SHORT).show();

    Uri mUri = Uri.parse("android.resource://my.package.name/"+raw);

    ContentResolver mCr = cont.getContentResolver();
    AssetFileDescriptor soundFile;
    try {
           soundFile= mCr.openAssetFileDescriptor(mUri, "r");
       } catch (FileNotFoundException e) {
           Toast.makeText(cont, "AssetFileDescriptor failed", Toast.LENGTH_SHORT).show();
           soundFile=null; 
           return null;
       }

       try {
          byte[] readData = new byte[1024];
          FileInputStream fis = soundFile.createInputStream();
          FileOutputStream fos = new FileOutputStream(newSoundFile);
          int i = fis.read(readData);

          while (i != -1) {
            fos.write(readData, 0, i);
            i = fis.read(readData);
          }

          fos.close();
       } catch (Exception io) {
           Toast.makeText(cont, "copy failed", Toast.LENGTH_SHORT).show();
           return null;
       }

    return path;
} 
```

Setting the file as ringtone:

```
public static void setValues(String path, int choice){
    File newSoundFile = new File(path);

    ContentValues values = new ContentValues();
       values.put(MediaStore.MediaColumns.DATA, newSoundFile.getAbsolutePath());
       values.put(MediaStore.MediaColumns.TITLE, "my ringtone");
       values.put(MediaStore.MediaColumns.MIME_TYPE, "audio/mp3");
       values.put(MediaStore.MediaColumns.SIZE, newSoundFile.length());
       values.put(MediaStore.Audio.Media.ARTIST, R.string.app_name);
       if(choice == 0){
           values.put(MediaStore.Audio.Media.IS_RINGTONE, true);
           values.put(MediaStore.Audio.Media.IS_NOTIFICATION, false);
       }
       else{
           values.put(MediaStore.Audio.Media.IS_RINGTONE, false);
           values.put(MediaStore.Audio.Media.IS_NOTIFICATION, true);
       }
       values.put(MediaStore.Audio.Media.IS_ALARM, false);
       values.put(MediaStore.Audio.Media.IS_MUSIC, false);

       Uri uri = MediaStore.Audio.Media.getContentUriForPath(newSoundFile.getAbsolutePath());
       Uri newUri = mCr.insert(uri, values);

       try {
           if(choice == 0)RingtoneManager.setActualDefaultRingtoneUri(cont, RingtoneManager.TYPE_RINGTONE, newUri);
           else RingtoneManager.setActualDefaultRingtoneUri(cont, RingtoneManager.TYPE_NOTIFICATION, newUri);
       } catch (Throwable t) {
           Log.d("LOG", "catch exception");
       }

} 
```

Calling both:

```
public static void setRingTone(String raw, int choice){
    setValues(createFile(raw, choice), choice);

} 
```

so what happens is: the first time that i select a ringtone the new file is created, and the sound is assigned properly as the ringtone. If I click again to select a ringtone the old ringtone file is deleted and recreated properly, but it in not set as a ringtone (when i get called i get only vibration). BUT if I delete the .mp3 file manually and go to my app and select ringtone again it works.. Why does it behave differently when i delete the file from my code than when it is deleted manually from a file browser?

Any ideas what might be the problem?

Thanks in advance!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T11:33:51.673

好的，经过几个小时的搜索，我在这篇文章中找到了答案： [将音频文件设置为铃声](https://stackoverflow.com/questions/4603941/problem-in-setting-audio-file-as-ringtone)

（我不知道如何将我的问题标记为重复）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T04:37:20.653

对我来说，它第一次不起作用，但从第二次开始就起作用

```
Uri ruri = Uri.parse("content://media/internal/audio/media/37");

try 

{

RingtoneManager.setActualDefaultRingtoneUri(context,RingtoneManager.TYPE_RINGTONE,     
ruri);

}

catch (Throwable t) 

{

// error handling goes here -- also, use something other than Throwable

}

AudioManager audio = (AudioManager)getSystemService(Context.AUDIO_SERVICE);

audio.setRingerMode(AudioManager.RINGER_MODE_NORMAL);

for (int volumeType: (new int[] { AudioManager.STREAM_SYSTEM,

AudioManager.STREAM_RING, AudioManager.STREAM_NOTIFICATION, AudioManager.STREAM_ALARM   
}))

{

int maxVolume = audio.getStreamMaxVolume(volumeType);

audio.setStreamVolume(volumeType, maxVolume,AudioManager.FLAG_PLAY_SOUND |     
AudioManager.FLAG_VIBRATE);

audio.setStreamMute(volumeType, false);

 audio.setVibrateSetting(volumeType,AudioManager.VIBRATE_SETTING_ON);

 }

 }

 catch (Exception e) 
 {

 // TODO: handle exception

 }

 } 
```

# arrays - Saving cells from MATLAB

> ID：11278482
> 
> 赞同：1
> 
> 时间：2012-06-30T23:35:27.270
> 
> 标签：arrays, matlab, file-io, save, cell

I have a cell array which contains 7 matrices of varying column and length size. I have tried using the function ['dlmcell'](http://www.mathworks.com/matlabcentral/fileexchange/25387-write-cell-array-to-text-file) which is downloadable from the MATLAB website but is says "Text exceeds maximum line length of 25000 characters for Command Window Display".

I have looked at a few other examples of saving the arrays but none of them seem to be able to deal with the structure of the cell or the size of the file.

The main aim for me is to save the cell so that I may later import it. Is there no specific format that MATLAB uses (like .mat for example) to store the cell arrays?

Thanks in advance!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T23:44:00.873

对我来说就像`save`正常工作一样：

```
>> cellarray = {1:1000; 'my cell array'}

cellarray = 

    [1x1000 double]
    'my cell array'

>> save('cellarray','cellarray')
   %# filename---^   ^--- variable name
>> clear all
>> load('cellarray')
>> cellarray

cellarray = 

    [1x1000 double]
    'my cell array' 
```

`cellarray.mat`在当前目录中保存为 matfile。您可以使用`load`. 我错过了什么吗？它比这更复杂吗？

# visual-studio - Can I build a commercial Internet Explorer BHO using VISUAL C++ 2010 EXPRESS?

> ID：11278484
> 
> 赞同：-1
> 
> 时间：2012-06-30T23:36:10.703
> 
> 标签：visual-studio, internet-explorer

I don't have any experience building software for Windows but I have experience with C++ and with software development in general.

I now need to develop a commercial Internet Explorer BHO and I wanted to do it using freeware - can I use Visual C++ 2010 Express for this or do I need the pay-for edition?

Thanks.

P.S.: I am aware it is not going to be an easy task.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T04:58:46.860

撇开许可问题不谈，没有技术原因不能使用它构建 BHO。最终，您将需要购买代码签名证书，但除此之外，您可以免费完成所有操作。

# django-forms - Django retrieving value from model

> ID：11278491
> 
> 赞同：0
> 
> 时间：2012-06-30T23:36:58.827
> 
> 标签：django-forms, djangoappengine

I have this model.py:

```
from google.appengine.ext import db

class Poem(db.Model):
    title = db.StringProperty()
    words = db.StringListProperty()
    created_on = db.DateTimeProperty(auto_now_add = 1)
    created_by = db.UserProperty()

    def __str__(self):
        return str(self.words)

    def get_absolute_url(self):
        return '/poem/%s/' % self.key() 
```

And the following views:

```
def index(request):
    poems = models.Poem.all().order('-created_on').fetch(20)
    payload = dict(poems = poems)
    return render('index.html', payload)

def create(request):
    if request.method == 'GET': 
        poemform = bforms.PoemForm()

    if request.method == 'POST':
        poemform = bforms.PoemForm(request.POST)
        if poemform.is_valid():
            poem = poemform.save()
            return HttpResponseRedirect(poem.get_absolute_url())

def poem(request, poem_key):
    poem = models.Poem.get(poem_key)
    payload = dict(title = poem.title, words = poem.words)
    return render('poem.html', payload) 
```

When I save a new poem via a creation form, the poem gets shown in the sidebar, among the recent poems, and among all poems on the index page. However, when I click one of the links, neither title nor words seem to have been filled into the template.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T23:55:41.383

我找到了答案......我将单独的标题和单词传递给模板，它只需要一首诗。

# mysql - MySQL 原子操作和表锁定

> ID：11278494
> 
> 赞同：7
> 
> 时间：2012-06-30T23:37:46.507
> 
> 标签：mysql, locking, innodb, atomic, escrow

我有一个网站，用户可以在其中购买门票，但门票数量通常有限，而且去得很快。我正在尝试实现一个托管系统，以便用户可以单击他们想要 x 数量的票证，此时我会将它们置于托管状态。这让他们有几分钟的时间来输入他们的信用卡信息并完成购买。

我有三个相关的表：事件、门票和托管。事件表中的一行描述了事件本身，包括可用门票的最大数量。

门票表包含以下内容：

**user_id** : 购买门票的用户

**number_of_tickets** : 他们购买了多少张门票

**event_id** : 相关事件

托管表包含以下内容：

**user_id** : 购票过程中的用户

**number_of_tickets** : 他们想要多少张票

**event_id** : 相关事件

目前，我做了三个 MySQL 查询，一个查询最大票数，一个查询已售票数，一个查询已经托管的票数。然后我计算：

```
$remaining_tickets = $max_tickets - $tickets_sold - $tickets_in_escrow;
if ($remaining_tickets >= $tickets_desired)
{
    beginEscrow($user_id, $event_id, $tickets_desired);
}
else
{
    echo "Error:  not enough ticket remain.";
} 
```

我的问题是多个用户可能同时执行此代码。如果一个用户`beginEscrow` *在*另一个用户已经阅读了托管中的门票数量后打电话，我可能会超卖这个节目。

我正在为我的表使用 InnoDB 引擎，并且我已经阅读了如何使用 锁定单行`SELECT .... FOR UPDATE`，但我没有更新单行。该`beginEscrow`函数只会在托管表中插入一个新行。我`$tickets_in_escrow`通过读取具有正确事件 ID 的所有行并将每行中的票数相加来计算。

也许我做错了？

我需要锁定整个表吗？

我不能成为第一个编写票务托管系统的人。我已经用谷歌搜索了自己，试图找到一些关于这种事情的教程，但被淘汰了。任何想法都会有所帮助。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T00:07:22.480

你非常接近你的设计，但并不完全在那里。

首先，您的活动表需要保存您的活动仍然可用的门票数量（除了您想要的其他任何东西）。

其次，您的托管表需要有一个 DATETIME 列来指示托管何时到期。每当门票进入托管时，您都需要设置该值。

三、票据托管交易需要

1.  锁定事件行。
2.  阅读可用票列。（如果没有足够的可用则中止）
3.  在托管表中插入一行
4.  更新事件行以减少可用门票列。
5.  解锁事件行。

第四，完成销售的动作需要删除escrow行，插入sold-ticket行。这并不难。

第五，您需要进行托管清理操作。这需要查找所有已过期的托管行（过去有过期日期），并且对于每一个：

1.  锁定相应的事件行。
2.  从托管表中读取托管票的数量
3.  删除托管表行。
4.  更新事件行以增加可用门票列。
5.  解锁事件行。

诀窍是以正确联锁的方式维护*可用*门票的数量，因此用户之间的竞争条件不会过度销售您的活动。

# iphone - ios parsing json containing array?

> ID：11278496
> 
> 赞同：1
> 
> 时间：2012-06-30T23:38:31.027
> 
> 标签：iphone, ios, json, ios5

This is the json coming from the server:

```
{
    "name":"channelname",   
    "args":
    [
        {           
            "username":"myusername",
            "message":"mymessage"
        }
    ]
} 
```

Using ios5 built-in json methods I try to parse out the args's username/message.

```
NSDictionary *JSON = [NSJSONSerialization JSONObjectWithData: [packet.data dataUsingEncoding:NSUTF8StringEncoding] options: NSJSONReadingMutableContainers error: nil];
NSDictionary *argsValues = [[NSDictionary alloc] initWithDictionary:[JSON objectForKey:@"args"]]; 
```

Second line throws an error:

```
dictionary argument is not an NSDictionary 
```

When I NSlog [JSON objectForKey@"args"] I get:

```
(
    {
        message = mymessage;
        username = myusername;
    }
) 
```

I think the parenthesis are breaking it, don't know where they came from, help appreciated.

**EDIT:**

Thanks to chosen answer, here's the code I used to get the args keys.

```
NSDictionary *JSON = [NSJSONSerialization JSONObjectWithData: [packet.data dataUsingEncoding:NSUTF8StringEncoding] options: NSJSONReadingMutableLeaves error: nil];
NSArray *argsArray = [[NSArray alloc] initWithArray:[JSON objectForKey:@"args"]];
NSDictionary *argsDict = [[NSDictionary alloc] initWithDictionary:[argsArray objectAtIndex:0]];
NSLog(@"keys = %@", [argsDict allKeys]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-30T23:42:32.627

```
[json objectForKey:@"args"] 
```

是一个 NSArray。您不能直接使用数组初始化 NSDictionary。

（在 JSON 中，{ 和 } 表示键值对，如 NSDictionary，而 [ 和 ] 分隔有序列表，如 NSArray，这就是映射按原样完成的原因......）

# git - Update a local branch with the changes from a tracked remote branch

> ID：11278497
> 
> 赞同：137
> 
> 时间：2012-06-30T23:38:35.727
> 
> 标签：git, branch, git-branch, remote-branch

I have a local branch named '`my_local_branch`', which tracks a remote branch `origin/my_remote_branch`.

Now, the remote branch has been updated, and I am on the '`my_local_branch`' and want to pull in those changes. Should I just do:

```
git pull origin my_remote_branch:my_local_branch 
```

Is this the correct way?

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-07-01T00:01:26.560

您不使用`:`语法 -`pull`始终修改当前签出的分支。因此：

```
git pull origin my_remote_branch 
```

当你`my_local_branch`签出时，你会做你想做的事。

由于您已经设置了跟踪分支，因此您甚至不需要指定 - 您可以这样做...

```
git pull 
```

当您`my_local_branch`签出时，它将从跟踪的分支更新。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2012-06-30T23:58:03.150

您已设置该分支的上游

（看：

*   “[如何让现有的 git 分支跟踪远程分支？](https://stackoverflow.com/questions/520650/how-do-you-make-an-existing-git-branch-track-a-remote-branch) ”和
*   “ [Git：为什么我需要一直做`--set-upstream-to`？](https://stackoverflow.com/questions/6089294/git-why-do-i-need-to-do-set-upstream-all-the-time) ”
    ）

```
git branch -f --track my_local_branch origin/my_remote_branch
# 或者（如果 my_local_branch 当前已签出）：
$ git branch --set-upstream-to my_local_branch origin/my_remote_branch

```

（`git branch -f --track`如果分支被签出则不起作用：使用第二个命令`git branch --set-upstream-to` ，否则你会得到“ `fatal: Cannot force update the current branch.`”）

这意味着您的分支[已经配置](http://git-scm.com/docs/git-config)了：

```
branch.my_local_branch.remote origin
branch.my_local_branch.merge my_remote_branch 
```

Git 已经拥有所有必要的信息。
在这种情况下：

```
# if you weren't already on my_local_branch branch:
git checkout my_local_branch 
# then:
git pull 
```

足够的。

* * *

如果你在推送' `my_local_branch`'时没有建立上游分支关系，那么一个简单的推送*和*设置上游分支`git push -u origin my_local_branch:my_remote_branch`就足够了。 在那之后，对于随后的拉/推，或者再次，已经足够了。 *`git pull``git push`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-24T07:49:04.870

因为有人不小心弄乱了本地提交。

删除本地脏分支

`git branch -D master`

然后从远程重建一个分支

`git checkout -b master origin/master`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-19T16:20:04.303

注意：我是一个 git 新手。

当我执行“git pull”时，我通常会看到“错误：您对以下文件的本地更改将被合并覆盖：”“请在合并之前提交您的更改或存储它们。” （因为我做了一些我并不真正关心的细微的临时更改。）

如果我从远程拉动，我通常不关心我的更改。我只想要团队推送的最新消息。（我有时会使用“stash”来保留一些更改。）

**因此，我如何从远程获取最新信息并清除我的任何本地更改：**

*git reset --hard* (对于当前分支)

或者

*git reset --hard origin/master*（用于返回 master）

然后：

*git pull* （将当前远程文件拉到我的本地）*

# asp.net - How do I output a string instead of a HTML page?

> ID：11278502
> 
> 赞同：1
> 
> 时间：2012-06-30T23:40:56.203
> 
> 标签：asp.net, .net, html, vb.net

I want to be able to output a simple string as text rather than the HTML page when a set of criteria are met. I am currently using:

```
Protected Sub OutputString(ByVal Str As String)
    Dim bytes() As Byte
    bytes = System.Text.Encoding.UTF8.GetBytes(Str)
    Response.ContentType = "text/plain"
    Response.OutputStream.Write(bytes, 0, bytes.Length)
    Response.End()
End Sub 
```

This works great and does exactly what I want, however, the Response.End() generates exceptions and (I believe) should be avoided where possible.

I suppose I could use a separate "empty" page for this code but its more of a work around than a solution. Also, someone said something about over riding the HTML output behaviour (can't remember where now).

I would be very grateful if someone could tell me the best method.

**UPDATE:** I found this link : [Response.Redirect(url) ThreadAbortException Solution](http://web.archive.org/web/20101224113858/http://www.c6software.com/codesolutions/dotnet/threadabortexception.aspx)

It recommends using HttpContext.Current.ApplicationInstance.CompleteRequest() and over riding the functions that render the page:

```
Dim DoNotOutputHTML As Boolean = False

Protected Overrides Sub RaisePostBackEvent(sourceControl As IPostBackEventHandler, eventArgument As String)
    If DoNotOutputHTML = False Then
        MyBase.RaisePostBackEvent(sourceControl, eventArgument)
    End If
End Sub

Protected Overrides Sub Render(writer As HtmlTextWriter)
    If DoNotOutputHTML = False Then
        MyBase.Render(writer)
    End If
End Sub 
```

You can then choose whether or not to output your html page by setting the variable DoNotOutputHTML.

The only problem I have with this is that any code after the CompleteRequest() still executes. I can work around this by restructuring my code although it would be neater (less if/else blocks) if I didn't have to, like I don't with response.end()

Any suggestions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:53:12.473

Basically you need to set the response type to text, and remove all HTML from the page.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T17:08:07.370

最后，我只是使用了 Response.End() 并忽略了异常。似乎工作正常。

# video - What video file format and codec uses the least processing power?

> ID：11278505
> 
> 赞同：2
> 
> 时间：2012-06-30T23:41:32.587
> 
> 标签：video, format, resolution, codec

I just would like to know what format and codec would use the least processing power when the file is being played back, but still maintain a good quality, in my specific case it needs to have at least a 720p resolution. Don't worry about the file size, it can be as big as it needs to be. Does anyone know?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T23:50:21.887

每个人都知道，您可以在没有压缩的情况下获得最少的处理能力。但是，您将杀死您的存储设备、总线和/或网络。

尝试为问题提供一些限制...

编辑：

每个像素至少有 2 个字节（例如 YUY2 格式）。计算视频的数据速率：

```
width * height * 2 * frames_per_second 
```

并估计您的设备是否可以处理这样的吞吐量。

此外，使用未压缩的视频，您将获得最高质量。

进一步阅读：

[http://en.wikipedia.org/wiki/Comparison_of_video_codecs](http://en.wikipedia.org/wiki/Comparison_of_video_codecs)

进一步编辑：

由于有些人对答案不满意，请尝试回答这个问题：什么数据压缩方法使用最少的 CPU 功率。

答案是一样的：STORE。

如果 op 要添加一些约束会更好，例如，“什么视频压缩在解压缩时使用最少的 CPU，同时在大约 1mbit 上以 25fps 处理 FULL PAL 视频帧？”

除此之外，op 还应提供有关他所做的尝试、获得的结果等的信息。

# android - android.widget.Switch - on/off event listener?

> ID：11278507
> 
> 赞同：282
> 
> 时间：2012-06-30T23:41:48.213
> 
> 标签：android

I would like to implement a switch button, android.widget.Switch (available from API v.14).

```
<Switch
    android:id="@+id/switch1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Switch" /> 
```

But I'm not sure how to add an event listener for the button. Should it be an "onClick" listener? And how would I know if it is toggled "on" or not?

* * *

## 回答 #1

> 赞同：574
> 
> 时间：2012-06-30T23:45:25.857

Switch 继承`CompoundButton`的属性，所以我会推荐[OnCheckedChangeListener](http://developer.android.com/reference/android/widget/CompoundButton.OnCheckedChangeListener.html)

```
mySwitch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        // do something, the isChecked will be
        // true if the switch is in the On position
    }
}); 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2013-01-28T06:42:36.900

使用以下代码段通过 XML 将 Switch 添加到您的布局中：

```
<Switch
     android:id="@+id/on_off_switch"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:textOff="OFF"
     android:textOn="ON"/> 
```

然后在 Activity 的 onCreate 方法中，获取对 Switch 的引用并设置其 OnCheckedChangeListener：

```
Switch onOffSwitch = (Switch)  findViewById(R.id.on_off_switch); 
onOffSwitch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

@Override
public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
    Log.v("Switch State=", ""+isChecked);
}       

}); 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2017-12-19T19:35:41.067

对于使用 Kotlin 的用户，您可以为开关（在本例中为 ID `mySwitch`）设置监听器，如下所示：

```
 mySwitch.setOnCheckedChangeListener { _, isChecked ->
         // do whatever you need to do when the switch is toggled here
    } 
```

`isChecked`如果当前检查开关 (ON)，则为 true，否则为 false。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-06-21T10:56:30.757

定义您的 XML 布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context="com.neoecosystem.samplex.SwitchActivity">

    <Switch
        android:id="@+id/myswitch"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content" />

</RelativeLayout> 
```

然后创建一个Activity

```
public class SwitchActivity extends ActionBarActivity implements CompoundButton.OnCheckedChangeListener {

    Switch mySwitch = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_switch);

        mySwitch = (Switch) findViewById(R.id.myswitch);
        mySwitch.setOnCheckedChangeListener(this);
    }

    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if (isChecked) {
            // do something when check is selected
        } else {
            //do something when unchecked
        }
    }

    ****
} 
```

======== 对于**API 14 以下，**请使用 SwitchCompat =========

XML

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context="com.neoecosystem.samplex.SwitchActivity">

    <android.support.v7.widget.SwitchCompat
        android:id="@+id/myswitch"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content" />

</RelativeLayout> 
```

活动

```
public class SwitchActivity extends ActionBarActivity implements CompoundButton.OnCheckedChangeListener {

    SwitchCompat mySwitch = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_switch);

        mySwitch = (SwitchCompat) findViewById(R.id.myswitch);
        mySwitch.setOnCheckedChangeListener(this);
    }

    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if (isChecked) {
            // do something when checked is selected
        } else {
            //do something when unchecked
        }
    }
   *****
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-06-19T06:49:11.620

在科特林：

```
 switch_button.setOnCheckedChangeListener { buttonView, isChecked ->
        if (isChecked) {
            // The switch enabled
            text_view.text = "Switch on"

        } else {
            // The switch disabled
            text_view.text = "Switch off"

        }
    } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-03-02T12:13:37.850

Switch 小部件的布局是这样的。

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">
    <Switch
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="20dp"
        android:gravity="right"
        android:text="All"
        android:textStyle="bold"
        android:textColor="@color/black"
        android:textSize="20dp"
        android:id="@+id/list_toggle" />
</LinearLayout> 
```

在 Activity 类中，您可以通过两种方式进行编码。取决于您可以编码的用途。

第一种方式

```
public class ActivityClass extends Activity implements CompoundButton.OnCheckedChangeListener {
Switch list_toggle;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.return_vehicle);

    list_toggle=(Switch)findViewById(R.id.list_toggle);
    list_toggle.setOnCheckedChangeListener(this);
    }
}

public void onCheckedChanged(CompoundButton buttonView,boolean isChecked) {
    if(isChecked) {
        list_toggle.setText("Only Today's");  //To change the text near to switch
        Log.d("You are :", "Checked");
    }
    else {
        list_toggle.setText("All List");   //To change the text near to switch
        Log.d("You are :", " Not Checked");
    }
} 
```

第二种方式

```
public class ActivityClass extends Activity {
Switch list_toggle;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.return_vehicle);

    list_toggle=(Switch)findViewById(R.id.list_toggle);
    list_toggle.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
       @Override
       public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
          if(isChecked) {
             list_toggle.setText("Only Today's");  //To change the text near to switch
             Log.d("You are :", "Checked");
          }
          else {
             list_toggle.setText("All List");  //To change the text near to switch
             Log.d("You are :", " Not Checked");
          }
       }       
     });
   }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-09-15T15:18:27.383

**2020 年 9 月 - 以编程方式回答**

您可以通过编程方式为 Switch Widget 和 Material Design 执行此操作：

```
Switch yourSwitchButton = findViewById(R.id.switch_id);

yourSwitchButton.setChecked(true); // true is open, false is close.

yourSwitchButton.setOnCheckedChangeListener((compoundButton, b) -> {
        if (b){
          //open job.
        }  
        else  {
          //close job.
        }
    }); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-11-18T16:32:59.127

您可以将 DataBinding 和 ViewModel 用于 Switch Checked Change 事件

```
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

    <data>

        <variable
                name="viewModel"
                type="com.example.ui.ViewModel" />
    </data>
    <Switch
            android:id="@+id/on_off_switch"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:onCheckedChanged="@{(button, on) -> viewModel.onCheckedChange(on)}"
     /> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-04-16T19:18:44.100

有两种方法，

1.  使用 xml onclick view 在 XML 中添加 Switch，如下所示：

    ```
    <Switch
    android:id="@+id/switch1"
    android:onClick="toggle"/> 
    ```

在 YourActivity 类中（例如 MainActivity.java）

```
 Switch toggle; //outside oncreate
    toggle =(Switch) findViewById(R.id.switch1); // inside oncreate

    public void toggle(View view) //outside oncreate
    {
        if( toggle.isChecked() ){
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                start.setBackgroundColor(getColor(R.color.gold));
                stop.setBackgroundColor(getColor(R.color.white));
            }
        }
        else
        {
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                stop.setBackgroundColor(getColor(R.color.gold));
                start.setBackgroundColor(getColor(R.color.white));
            }
        }
    } 
```

2.  使用点击监听器

在 XML 中添加 Switch，如下所示：

在 YourActivity 类中（例如 MainActivity.java）

```
 Switch toggle; // outside oncreate
    toggle =(Switch) findViewById(R.id.switch1);  // inside oncreate

    toggle.setOnClickListener(new View.OnClickListener() {   // inside oncreate
        @Override
        public void onClick(View view) {

            if( toggle.isChecked() ){
                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                    start.setBackgroundColor(getColor(R.color.gold));
                }
            }
            else
            {
                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                    stop.setBackgroundColor(getColor(R.color.gold));
                }
            }

        }

    }); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-03-18T19:02:14.033

我的解决方案，使用 a`SwitchCompat`和 Kotlin。在我的情况下，只有当用户通过 UI 触发更改时，我才需要对更改做出反应。事实上，我的开关对 a 做出反应`LiveData`，这使得两者都`setOnClickListener`无法`setOnCheckedChangeListener`使用。`setOnClickListener`事实上，对用户交互的反应是正确的，但如果用户将拇指拖过开关，它就不会被触发。`setOnCheckedChangeListener`如果以编程方式切换开关（例如通过观察者），另一端也会触发。现在在我的情况下，开关存在于两个片段上，因此 onRestoreInstanceState 在某些情况下会触发开关，旧值覆盖正确的值。

因此，我查看了 SwitchCompat 的代码，并且能够成功地模仿它在区分单击和拖动方面的行为，并使用它来构建一个可以正常工作的自定义触摸监听器。开始了：

```
/**
 * This function calls the lambda function passed with the right value of isChecked
 * when the switch is tapped with single click isChecked is relative to the current position so we pass !isChecked
 * when the switch is dragged instead, the position of the thumb centre where the user leaves the
 * thumb is compared to the middle of the switch, and we assume that left means false, right means true
 * (there is no rtl or vertical switch management)
 * The behaviour is extrapolated from the SwitchCompat source code
 */
class SwitchCompatTouchListener(private val v: SwitchCompat, private val lambda: (Boolean)->Unit) :  View.OnTouchListener {
    companion object {
        private const val TOUCH_MODE_IDLE = 0
        private const val TOUCH_MODE_DOWN = 1
        private const val TOUCH_MODE_DRAGGING = 2
    }

    private val vc = ViewConfiguration.get(v.context)
    private val mScaledTouchSlop = vc.scaledTouchSlop
    private var mTouchMode = 0
    private var mTouchX = 0f
    private var mTouchY = 0f

    /**
     * @return true if (x, y) is within the target area of the switch thumb
     * x,y and rect are in view coordinates, 0,0 is top left of the view
     */
    private fun hitThumb(x: Float, y: Float): Boolean {
        val rect = v.thumbDrawable.bounds
        return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom
    }

    override fun onTouch(view: View, event: MotionEvent): Boolean {
        if (view == v) {
            when (MotionEventCompat.getActionMasked(event)) {
                MotionEvent.ACTION_DOWN -> {
                    val x = event.x
                    val y = event.y
                    if (v.isEnabled && hitThumb(x, y)) {
                        mTouchMode = TOUCH_MODE_DOWN;
                        mTouchX = x;
                        mTouchY = y;
                    }
                }
                MotionEvent.ACTION_MOVE -> {
                    val x = event.x
                    val y = event.y
                    if (mTouchMode == TOUCH_MODE_DOWN &&
                        (abs(x - mTouchX) > mScaledTouchSlop || abs(y - mTouchY) > mScaledTouchSlop)
                    )
                        mTouchMode = TOUCH_MODE_DRAGGING;
                }
                MotionEvent.ACTION_UP,
                MotionEvent.ACTION_CANCEL -> {
                    if (mTouchMode == TOUCH_MODE_DRAGGING) {
                        val r = v.thumbDrawable.bounds
                        if (r.left + r.right < v.width) lambda(false)
                        else lambda(true)
                    } else lambda(!v.isChecked)
                    mTouchMode = TOUCH_MODE_IDLE;
                }
            }
        }
        return v.onTouchEvent(event)
    }
} 
```

如何使用它：

接受带有要执行的代码的 lambda 的实际触摸侦听器：

```
myswitch.setOnTouchListener(
    SwitchCompatTouchListener(myswitch) {
        // here goes all the code for your callback, in my case
        // i called a service which, when successful, in turn would 
        // update my liveData 
        viewModel.sendCommandToMyService(it) 
    }
) 
```

为了完整起见，状态观察者`switchstate`（如果有的话）如下所示：

```
switchstate.observe(this, Observer {
    myswitch.isChecked = it
}) 
```

# spotify - 是什么导致 Spotify App 意外重启？

> ID：11278508
> 
> 赞同：0
> 
> 时间：2012-06-30T23:42:01.270
> 
> 标签：spotify

我一直在开发 Spotify 应用程序，而且进展顺利；然而，就在最近，有一个代码路径，当我执行它时，它会导致 Spotify 应用程序的行为就像它已重新加载一样。控制台被清除，所有本地状态都消失了，等等。我似乎无法找到导致它刷新的原因。是否存在已知错误在触发时会导致刷新？

谢谢。

-戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:26:05.687

原来问题是在我的表单的 onChange 方法被调用后我没有返回 False ；这导致表单提交和页面重新加载。

# asp.net - 在 ASP.NET Web 应用程序之间传递会话数据

> ID：11278512
> 
> 赞同：7
> 
> 时间：2012-06-30T23:42:37.070
> 
> 标签：asp.net, sql-server, session, vb.net-2010

我正在尝试帮助一个朋友 - 他们有一个相当大的 Web 应用程序（ASP.NET 4.0，Visual Basic），它有许多子文件夹，它们都充当准子应用程序（但它们只是主应用程序的子文件夹）。该应用程序将被拆分为多个独立的 Web 应用程序，因为在其当前形式下，很难进一步维护和开发。

问题是当前的单体应用程序使用许多会话变量来存储用户信息（登录后等）会话）。会话状态存储在 SQL Server 中。当前 Web 应用程序的用户都是外部用户，并非所有用户都可以访问所有“子应用程序”。

我正在寻找关于这两件事的一些建议：

1\. 我已经做了一些搜索，发现单点登录 - 这似乎解决了跨这些应用程序的身份验证问题，但我不熟悉它，我不明白如果“会话”如何删除身份验证信息过期，因为不同的 Web 应用程序将有不同的会话。一旦会话在其中一个中过期，是否可以从所有 Web 应用程序中注销用户？

2.我怀疑（但不确定）在拆分后可能需要共享的身份验证信息之上可能还有一些其他会话数据。最好的方法是什么（再次可靠和安全）？

我发现[这篇关于传递 ID](https://stackoverflow.com/questions/3246361/passing-ids-between-web-applications)的文章（传递给将保存共享数据的数据库记录）并想知道它是否好。

所有建议将不胜感激。

PS：我在 SO 上找到了许多关于此的主题，但我不相信他们中的任何一个都回答了这些具体问题。我发现最有帮助的是这个：

[在 ASP.NET 应用程序之间共享数据](https://stackoverflow.com/questions/616046/passing-session-data-between-asp-net-applications)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-29T13:41:24.960

最终我找到了解决这个问题的方法，我把它留在这里作为其他人的参考：

StateServer 使用 Windows 服务（ASP.NET 状态服务）来处理内存中的会话。这使用 MachineKey、AppDomainAppID 以及 SessionID 来唯一标识应用程序。

*   在 web.config 中将相同的 MachineKey 设置为站点下的所有应用程序都相同。
*   在 Global.asax Init() 中添加代码以将所有应用程序的 AppDomainAppID 设置为相同。
*   实现 ISessionIDManager 并返回自定义 Session ID 以在子应用程序中重复使用。

以下链接为我所做的实际实现提供了信息：

*   [在多个应用程序上共享会话状态](http://weblogs.asp.net/lichen/archive/2011/10/05/sharing-session-state-over-multiple-asp-net-applications-with-asp-net-state-server.aspx)
*   [使用状态服务器在多个应用程序上保持相同的会话 ID](https://stackoverflow.com/questions/3215737/how-to-maintain-the-same-session-id-across-multiple-web-applications-in-asp-net)
*   [通过应用程序共享会话](http://www.codeproject.com/Articles/27090/Sharing-Session-Across-Applications)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-30T23:50:07.847

可以在不同的应用程序之间共享 ASP.NET 会话。显然，共享相同会话状态数据库的所有应用程序都需要在相同版本的 ASP.NET 上（或者在会话状态数据库兼容的版本上）。此外，所有共享应用程序都需要在如何维护会话状态中的信息方面保持协调。例如，会话变量需要在应用程序之间维护兼容的信息和含义。

# php - array_unique 导致未定义的偏移错误

> ID：11278514
> 
> 赞同：1
> 
> 时间：2012-06-30T23:43:06.250
> 
> 标签：php

我一直在尝试使用 array_unique 从我填充的搜索结果中删除重复项。但是，我收到未定义的偏移错误。我想知道是否有人知道导致此错误的原因以及我能做些什么来解决它？正如您在下面看到的，我正在从两个不同的地方填充搜索结果并尝试将所有匹配项合并到一个数组中。

在array_unique 之前：Array（[0] => Bob Marley Footwear [1] => Bob Marley Footwear [2] => DVS Shoe Co.）

在array_unique 之后：Array（[0] => Bob Marley Footwear [2] => DVS Shoe Co.）

**注意：**这会导致在遍历数组时尝试访问数组插槽 1 时出现错误消息，以打印出结果。

```
 $results = mysql_query("SELECT keywords,name FROM files WHERE MATCH (keywords,name) AGAINST ('$searchfor')") or die(mysql_error());

    $matches=Array();
    $matches_final=Array();

    while($row = mysql_fetch_array($results)){
        $matches[] = $row['name'];
    }
    $matches_final = array_unique($matches);

    $results1 = mysql_query("SELECT name FROM files");
    while($row1 = mysql_fetch_array($results1)){
        $temp = explode(" ", $row1['name']);

        for($z=0; $z < sizeof($search_words); $z++){
            for($i=0; $i < sizeof($temp); $i++){
                if(((strcmp(strtolower($search_words[$z]), strtolower($temp[$i])))==0) and strlen($search_words[$z])<=5){
                    $matches_final[] = $row1['name'];
                }
            }
        }
    }

return $matches_final; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-30T23:53:22.227

我想首先建议您`DISTINCT(name)`在查询中使用以消除对`array_unique`.

该错误是由于 array_unique 删除了一个元素而不是重新键入数组。您可以`array_values`在将阵列返回到重新设置密钥之前对其执行。

# javascript - 如何使用 Javascript 在 createElement 输入上设置表单属性

> ID：11278526
> 
> 赞同：2
> 
> 时间：2012-06-30T23:45:21.970
> 
> 标签：javascript, html, createelement

有人可以帮帮我吗？我正在尝试使用此函数动态创建输入，但未设置“表单”**属性**。

```
function addInput(parentID,inputNAME) {
    var padre = document.getElementById(parentID);
    var container = document.createElement("input");
    container.type = "text";
    container.name = inputNAME;
    container.value = "";
    container.form = 'extra';
    var enter = document.createElement("br");
    padre.appendChild(container);
    padre.appendChild(enter);
} 
```

我也试过这个：

```
container.formName = 'extra';
container['form'] = 'extra';
container.attributes['form'] = 'extra';
container.createAttribute('form','extra') 
```

编辑：
答案：
`container.setAttribute("Form",'extra');`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T22:58:55.113

我用过

```
container.setAttribute("Form",'extra'); 
```

它似乎在 FF、Chrome 和 Opera 中工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T02:07:28.253

不知道为什么“我不是”删除他/她的答案，这大多是正确的。[form](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-63239895) **属性**在DOM 2 HTML 规范中指定为只读，并引用表单控件所在的表单。如果它不在表单中，它将是未定义的。

form[**属性**](http://dev.w3.org/html5/spec/single-page.html#attr-fae-form)是 HTML5 中的新属性，旨在将控件与与其所在的表单不同的表单相关联。这旨在用于嵌套表单。

在输入元素上设置表单属性可能会产生不可预知的结果。在符合 HTML5 的浏览器中，如果 form 属性的值是文档中另一个表单的 ID，则控件将与该表单关联，因此其 form 属性是对表单的引用，其 form 属性将是一个字符串 (关联表单的 ID）。否则，属性值将不会反映在控件的表单 DOM 属性中，但可能会保持属性值不变。

IE总是把属性和属性搞乱了，IE 6不管怎样都用属性值替换了表单属性。也许更高版本的行为有所不同，也许其中一个支持 HTML5。

以下可能会有所帮助：

```
<form id="form0">
  <div>
    <input type="button" form="form1" onclick=
      "alert('form property is: ' + this.form + ' ' + this.form.id + 
             '\nform attribute: ' + (typeof this.getAttribute('form')) +
             ' ' + this.getAttribute('form'))
      " value="Show form property  and attribute">
  </div>
</form>
<form id="form1"><div></div></form> 
```

# php - MySQL INSERT 自动添加重复行

> ID：11278529
> 
> 赞同：0
> 
> 时间：2012-06-30T23:45:26.733
> 
> 标签：php, jquery, mysql

我正在尝试使用 html 表单 + jquery + php 更新数据库

当我单击表单上的提交按钮时，它可以工作，但每次单击都会在数据库中添加**两条相同的记录。**

我不知道出了什么问题，因此我在这里发布了我正在使用的整个脚本。如果有人能找到问题，请指出。

这是我正在使用的脚本

**HTML**

```
<div id="result" class="results"></div>
<form id="person-form" class="person-form" method="post">
 <fieldset>
  <legend><strong>Add a new member</strong></legend>
  <table>
  <tr><td><label for="Name" >Name</label></td>
  <td colspan="2"><input type="text" name="name" value="Enter the Name, 55 char max." /></td></tr>
  <tr><td><label for="email">Email</label></td>
  <td colspan="2"><input type="text" name="email" value="Enter the email" /></td></tr>
  <tr><td><label for="subscribe">Subscribe</label></td>
  <td><input type="checkbox" name="subscribe" value="Yes" /></td>
  <td><input type="submit" value="Add member" id="add-member" class="add-member"/></td></tr>
  </table>
  <div style="clear:both;"></div>
 </fieldset>
</form> 
```

**jQuery**

```
$("#add-url").live("click", function() {
    var name = $('input[name=name]').val();
    var email = $('input[name=email]').val();
    var subs = $('input[name=subscribe]:checkbox:checked').val();
    var data = 'name='+name+'&email='+email+'&subs='+subs;

    $.post(add_member_script.ajaxurl, data,  function(data) {
   $('#results').html(data);

});
  return false;
}); 
```

**和 PHP**

```
$connect = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);

if (!$connect){
    die('Could not connect: ' . mysql_error());
}
mysql_select_db(DB_NAME, $connect);

if (empty($_POST['name']) || empty($_POST['email'])){
    echo 'enter some value';
}  else {

      if($_POST['subs']== 'yes') {
        $sql="INSERT INTO $table (name, email, subs) VALUES ('$_POST[name]','$_POST[email]','$_POST[subs]')";
      } else {
        $sql="INSERT INTO $table (name, email) VALUES ('$_POST[name]','$_POST[email]')";
      }

    if (!mysql_query($sql,$con)){
        mysql_error();
    } else {
        list_links_table ();
    }
    mysql_close($con);
    die();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T00:03:49.523

看起来表单可能会通过 AJAX 和“正常”方式提交。为了确保，添加`onsubmit="return false"`到表单标签：

```
<form id="person-form" class="person-form" method="post" onsubmit="return false"> 
```

或者，您可以删除所有 JS 并允许表单正常提交，并查看重复是否仍然存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:11:45.420

正如评论中所说，我建议您使用`<input type="button" value="Add member" id="add-member" class="add-member"/>`而不是“type=submit”，以确保表单永远不会通过 HTML 上传，而只能使用 Javascript 代码:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T00:55:02.613

最后我找到了，在我上面发布的脚本中完全没有错误。问题出在我注册了两次的 WordPress 钩子上，因此每次点击它都会发送 2 个请求。我删除了它，问题解决了。感谢@Erenor Paz、@Mark Eirich 和@slugonamission 的善意努力。至此，我完成了我的第一个 WordPress 插件 :)

# sql-server - SQL Server 多个 INNER JOIN 非常慢

> ID：11278530
> 
> 赞同：1
> 
> 时间：2012-06-30T23:46:17.773
> 
> 标签：sql-server, query-optimization

说到数据库，我几乎是个白痴，我可以编写查询来做我想做的事而不会出现太多问题，但是当我遇到性能问题时，我真的不知道该怎么做，所以任何帮助都将不胜感激已收到。

我有三张桌子：

**账单**

*   Bill_Id - BIGINT - 主键
*   账单日期 - 日期

**账单详情**

*   BillDetail_Id - BIGINT - 主键
*   Bill_Id - BIGINT - 比尔的外键，索引
*   BillDetailType_Id - INT - BillDetailType 的外键，索引
*   收费 - 钱

**账单明细类型**

*   BillDetailType_Id - INT - 主键
*   类型名称 - NVARCHAR(20)

每个账单都有多个 BillDetails，它们基本上是账单上的各个项目。每个BillDetail 都有一个BillDetailType，它是什么类型的账单项目（例如电费、互联网、税收）。

我还创建了这样的视图：

```
CREATE VIEW BillSubtotal
AS
SELECT b.*,
        (SELECT SUM(bd.Charge) FROM BillDetail AS bd INNER JOIN BillDetailType AS bdt ON bd.BillDetailType_Id = bdt.BillDetailType_Id
            WHERE (bdt.TypeName = 'Tax') AND (bd.Bill_Id = b.Bill_id)) AS Tax,
        (SELECT SUM(bd.Charge) FROM BillDetail AS bd INNER JOIN BillDetailType AS bdt ON bd.BillDetailType_Id = bdt.BillDetailType_Id
            WHERE (bdt.TypeName <> 'Tax') AND (bd.Bill_Id = b.Bill_id)) AS NonTaxTotal
        FROM Bill AS b 
```

使用当前的开发数据库运行该视图大约需要 14 秒，其中大约有 60000 个账单和 700000 个账单详细信息。有 26 种不同的 BillDetailType。一旦我得到这个工作，我想添加更多的小计，但现在这就是我所拥有的。

现在我正在尝试进行这样的加入：

```
SELECT bs.BillDate, bs.Tax, bs.NonTaxTotal, bd.Charge, bdt.TypeName FROM
BillDetail bd
INNER JOIN BillSubtotal bs ON bs.Bill_Id = bd.Bill_Id
INNER JOIN BillDetailType bdt ON bdt.BillDetailType_Id = bd.BillDetailType_Id 
```

我想计算一个特定的 BillDetail 占税前账单的百分比以及其他一些东西，所以我最终会得到类似 bd.Charge/bs.NonTaxTotal*100 的东西，但目前这个查询需要 14**小时**才能运行我真的不明白为什么。

如果我删除任何一个 INNER JOIN，查询会大大加快：

```
SELECT bs.BillDate, bs.Tax, bs.NonTaxTotal, bd.Charge FROM
BillDetail bd
INNER JOIN BillSubtotal bs ON bs.Bill_Id = bd.Bill_Id 
```

运行大约需要 1.5 分钟。

```
SELECT bd.Charge, bdt.TypeName FROM
BillDetail bd
INNER JOIN BillDetailType bdt ON bdt.BillDetailType_Id = bd.BillDetailType_Id 
```

大约需要 12 秒。

我不明白为什么任何一个连接都可以在这么短的时间内运行，但是当我一起连接时需要几个小时。也许这是非常明显的事情，但是因为我并不真正了解如何评估查询，所以我错过了它。我查看了执行计划，但我无法从中收集到任何有用的信息，我有点走投无路了。我尝试了各种切换方式，将其中一个连接移动到子查询以及我认为可能有帮助的其他事情，但我所做的一切都没有改变性能。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:10:59.207

我建议根本不使用视图。几年前我做了很多这样的事情，但他们在很长一段时间内都变得难以管理。如果向其中一个表添加列，则应更新视图。只是变得太费力了。话虽如此，您可以向视图添加索引。

我还建议使用**Group By**策略。根据我的经验，这可能会快很多。我在几个案例中使用过它，发现速度有了显着的提高。像这样的东西：

```
 SELECT Bill_Id, 
     SUM(BillDetail.Charge), 
     CASE
         WHEN BillDetailType.TypeName = 'Tax'
             THEN 'Tax'
             ELSE 'Not Tax'
     END AS TypeName            
 FROM BillDetail
     INNER JOIN BillDetailType 
         ON BillDetail.BillDetailType_Id = BillDetailType.BillDetailType_Id
 GROUP BY Bill_Id, TypeName 
```

您可以只使用此查询并加入该查询，而不是创建视图。这将利用表本身的索引。

最后，您可能想尝试通过 Sql Server Profiler 工具运行最终得到的任何查询。

我有一篇关于[SQL 查询优化](http://www.foliotek.com/devblog/sql-server-database-optimization-a-beginners-guide/)的博客文章，其中讲述了我在过去 7 年中学到的各种技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:07:48.997

没有看到确切的执行计划就很难知道，但是很有可能您需要在视图上创建一些索引。查询优化器不一定会使用基础表上的索引，您可能需要专门在视图本身上创建索引。

执行计划的屏幕截图将使分析更容易。

来自[MSDN 文章](http://msdn.microsoft.com/en-us/library/dd171921%28v=sql.100%29.aspx)：（`It is possible to create a unique clustered index on a view, as well as nonclustered indexes, to improve data access performance on the most complex queries by precomputing and materializing the view. **This is often particularly effective for aggregate views** in decision support or data warehouse environments.`强调我的）。

# android - Android 如何安装较旧的 API 版本？

> ID：11278534
> 
> 赞同：1
> 
> 时间：2012-06-30T23:47:15.953
> 
> 标签：android, eclipse

在 Eclipse 中，我的 Android SDK 管理器没有显示到我想要安装的 API 级别 7。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:20:34.340

旧版本的 Android SDK 可在[http://developer.android.com/sdk/older_releases.html 获得](http://developer.android.com/sdk/older_releases.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T22:18:26.257

我也遇到了这个问题。我在这里尝试了另一个答案，但没有任何效果。我进入工具/选项（在 Android SDK 管理器中）并选中“强制使用 http:// 获取 https:// 源”并重新加载，旧的 API 神奇地出现了。

# iphone - 如何让用户先按下按钮然后摇动？

> ID：11278536
> 
> 赞同：-3
> 
> 时间：2012-06-30T23:47:47.990
> 
> 标签：iphone, ios, uibutton, shake

> **可能重复：**
> [我如何在 IBAction（按钮）内放置一个 void（摇动手势）？](https://stackoverflow.com/questions/11264989/how-do-i-put-a-voidshake-gesture-inside-a-ibactionbutton)

嗨，我之前已经多次发布过这个问题，我已经很累了。我是一个完全的初学者，我会准确说明我需要什么，但如果你回答并想要投票和其他类似的东西，那么请解释你的答案并指导我该怎么做，正如我之前所说的，我是一个完全的初学者。
所以我准备好了一个动画，但我需要一个代码，我将解释代码现在需要做什么：所以它们应该是一个按钮，说播放，当按钮按下播放时，按钮消失，标签显示“摇一摇” START' 一旦用户摇动 iPhone，标签就会消失，动画播放一次并结束。这就是我要问的所有问题，所以请用代码回答和解释，我会投票以及您需要的任何其他内容，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T00:00:35.860

我不会为你写出代码（这不是这个网站的目的），但我会告诉你应该做什么：

1.  按钮出现在屏幕上
2.  用户点击按钮，使用 UIView 动画块或 Core Animation 动画按钮淡出和标签淡入（或其他动画）。
3.  使用加速度计检测摇晃（有关更多信息，请参阅此问题：[如何检测何时有人摇晃 iPhone？](https://stackoverflow.com/questions/150446/how-do-i-detect-when-someone-shakes-an-iphone)）。
4.  标签随着 UIView 动画或核心动画再次消失，并且您的动画播放

希望这为您提供了一个开始！

# asp.net-mvc - 如何使用 1 个解决方案实现对 2 个网站的支持

> ID：11278539
> 
> 赞同：3
> 
> 时间：2012-06-30T23:48:16.833
> 
> 标签：asp.net-mvc, asp.net-mvc-3, visual-studio-2010, razor

平台：ASP.NET 4.0、MVC 4 RC、VS 2012

**更新：我自己回答了我的问题。请看下面我的回复帖**

**我想做的事：**

我目前有一个名为 www.a.com 的网站，它针对特定的客户群。我想创建一个名为 www.b.com 的变体，它针对不同的细分市场。

但是，在后台，a 和 b 的技术和代码对于大多数部分来说是相同的，只有一些页面/内容不同，具体取决于用户是使用域 a 还是 b 浏览。为此目的创建一个新项目对我来说绝对没有意义。

但是，我完全不清楚我应该如何实现 www.b.com 以及它在 MVC 中的流程。当某人来自 www.b.com 时，如何呈现不同的主页，浏览许多与 www.a.com 相同的页面，但根据 URL 是针对 a 还是针对 b，呈现不同的页面。

非常感谢一些指针，提示，示例。

**更新：我自己回答了我的问题。请看下面我的回复帖**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T01:44:42.023

如果您依赖域名，那么您将硬编码可能会更改的信息。与其这样做，不如根据子域来做。您仍在对一些信息进行硬编码，但子域方式更加灵活，并且在开发中更容易处理。

然后，您可以从每个域重定向到正确的子域。

例如

```
www.a.com # => redirects to site_a.somedomain.com
www.b.com # => redirects to site_b.somedomain.com 
```

然后，您可以构建一个依赖子域（site_a 或 site_b）的网站来确定要呈现的布局。

这样，即使域名更改您的网站仍然有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T01:58:34.523

前段时间，我在经典 ASP 中实现了与此类似的解决方案。我所做的有点难看，但有效：

*   我创建了一个名为 sites 的表，其中包含域（是的，每个站点不止一个）、背景、主颜色等。

*   向内容表添加了一个列站点，FK 为站点 ID。

*   创建了一个管理面板来更改此信息。

*   创建了一个在每个请求上运行的函数（在我的情况下，它通过包含文件在每个页面上运行）获取域名`Request.ServerVariables["SERVER_NAME"]`并查看我的表。如果找到匹配项，id 将站点配置信息存储在具有站点 id 的域的 cookie 中，并使用此值加载会话变量，因此我可以使用它来查询正确的内容并显示“不同”布局。下次访问时，它会检查 cookie，如果存在，则在会话中加载此信息；如果没有，请再次从数据库加载。

*   如果函数找不到匹配项，它会重定向到“正在建设的页面”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T12:55:27.980

**这就是我最终所做的**

首先，感谢那些回复我帖子的人，你们帮助我思考了我能做些什么。最后，我所做的只是一系列相当简单的事情。就是这样：

1.  我将我的新域 www.b.com 指向我的网络主机，因此键入 www.b.com 将指向 www.a.com (CNAME) 的根

2.  在我的解决方案中，我做了以下

我有一个所有控制器都派生自的 BaseController，并在其中声明了 IsPageB

```
public class BaseController : Controller
    {
        //
        // GET: /Base/
...
        protected bool IsPageB = false;
....
    } 
```

在 BaseController 中，我根据主机设置它的值

```
 protected override void OnActionExecuting(ActionExecutingContext ctx)
 {           
       ...
       IsPageB =  Request.Url.Host.Contains("b.com");
       ... 
  } 
```

所以在每个控制器中，我检查 IsPageB

例如，在主页中，我只是根据此变量切换视图

```
public ActionResult Index()
{
    if (IsPageB)
        return View("B_Home");

    return View();
} 
```

在视图内部，我要么使用在控制器中设置的 ViewBag.IsPageB，要么如果没有生成视图的控制器，我只需设置一个局部变量

```
@{
    bool isPageB = Request.Url.Host.Contains("b.com");
} 
```

然后根据这个值生成标记。

到目前为止一切都很好，也许有更聪明的方法可以做到这一点，但就我的目的而言，90% 的底层代码与 a 或 b 相同，并且一些输出发生变化，这很好。但我一直在寻找更清洁的方法。例如，有什么方法可以在不使用 ViewBag 或将其附加到模型的情况下访问视图中的 IsPageB 变量？

# javascript - 如何从其他域获取 ajax 响应？

> ID：11278545
> 
> 赞同：1
> 
> 时间：2012-06-30T23:50:00.323
> 
> 标签：javascript, ajax, http, cross-domain, yql

除了 YQL 之外，有没有什么方法可以在不修改服务器端代码的情况下从其他域获取 ajax 的响应和数据？

YQL 对免费用户有限制（每小时 1000 次呼叫），但大多数人说实际上更少。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T00:05:35.280

如果您所说的*“不修改服务器端代码”*不是修改数据源的服务器，那么您可以拥有自己的代理服务器（基本上是自己制作YQL服务器）来读取远程数据。这是可能的，因为服务器端没有绑定到同源策略。

因此，您可以 AJAX 您的服务器，然后让您的服务器使用某种形式的`wget`,`curl`或读取远程服务器`fopen`，并返回检索到的内容：

```
Remote server <- fopen, curl or wget -> your server <- AJAX -> browser 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T00:36:35.077

您可以使用 iframe 接收器模式。这是一项古老的技术。请参阅Danny Thorpe 在 MSDN 上[的浏览​​器中的安全跨域通信。](http://msdn.microsoft.com/en-us/library/bb735305.aspx)您不必使用 JSONP 但仍然可以进行跨域调用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T00:43:22.500

您可以使用 HTML 5 功能 postMessage 进行跨域调用。同样，并非所有浏览器都支持它。看下面的链接实现： [Cross domain call using postMessage](http://somethingcliche.com/2010/05/12/cross-domain-messages-with-postmessage/)

# cocoa - 使用 webView 找不到 pdf 文件

> ID：11278548
> 
> 赞同：0
> 
> 时间：2012-06-30T23:50:12.527
> 
> 标签：cocoa

我正在尝试使用以下代码为 Cocoa 项目（不是 iOS 项目）加载本地 pdf 文件。

```
NSString* filePath = [[NSBundle mainBundle] pathForResource:@"testPDFFile" 
                                                     ofType:@"pdf"
                                                inDirectory:@""];
NSURL* fileURL = [NSURL fileURLWithPath:filePath];
NSURLRequest* request = [NSURLRequest requestWithURL:fileURL];
[[webView mainFrame] loadRequest:request]; 
```

我可以看到 WebView 对象正在加载，但未显示文档。看起来插座连接正确。

我尝试将文件移动到不同的目录位置，并尝试在 inDirectory 参数中指定一个目录。

目前，该文件位于“Supporting Files”目录中。如果我将 inDirectory 更改为读取... inDirectory:@”Supporting Files”]; 我收到一条错误消息……“[NSURL initFileURLWithPath:]: nil string parameter”</p>

如何获取此语句以查找并显示我的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:03:03.520

尝试：

```
NSString* filePath = [[NSBundle mainBundle] pathForResource:@"testPDFFile" 
                                                     ofType:@"pdf"]; 
```

只要您在自己的包中访问资源，就不必设置（外部）包目录。

# maven-2 - Maven2 AAR Eclipse 插件未将 services.xml 添加到 aar

> ID：11278550
> 
> 赞同：1
> 
> 时间：2012-06-30T23:50:43.010
> 
> 标签：maven-2, eclipse-plugin, axis2

Maven大师，请在这里帮助新手：

我的 POM 看起来像这样：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.pidac.webservices</groupId>
  <artifactId>axis2test</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>war</packaging>
  <name>Axis2-test</name>

   <build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.axis2</groupId>
                <artifactId>axis2-aar-maven-plugin</artifactId>
                <version>1.6.2</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>axis2-aar:aar</goal>
                        </goals>
                        <configuration>                             
                            <fileSets>
                                <fileSet>
                                     <directory>${project.build.directory}/aar</directory>
                                     <outputDirectory>/</outputDirectory>
                                </fileSet>
                                <fileSet>
                                    <directory>$(basedir)/src/main/webapp/META-INF</directory>
                                    <outputDirectory>META-INF</outputDirectory>
                                </fileSet>                                  
                            </fileSets>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>

    </pluginManagement>
   </build>   
</project> 
```

我的文件夹结构如下所示：

![在此处输入图像描述](../Images/0c49ce60e1e1faaa433870902e4d60cb.png)

我的调试配置具有以下目标列表：

> 干净安装axis2-aar：aar

在 Eclipse 中，当我从 Debug As 上下文菜单运行 Maven Build 时，右键单击项目时会出现，我将 aar 放入我的目标文件夹，如下面的输出所示：

```
DEBUG] Exploding aar...
[DEBUG] Assembling aar axis2test in C:\Users\nji\workspace\axis2test\target\aar
[INFO] Generating aar C:\Users\nji\workspace\axis2test\target\axis2test-0.0.1-SNAPSHOT.aar
[INFO] Building jar: C:\Users\nji\workspace\axis2test\target\axis2test-0.0.1-SNAPSHOT.aar
[DEBUG] adding directory META-INF/
[DEBUG] adding entry META-INF/MANIFEST.MF
[DEBUG] adding directory com/
[DEBUG] adding directory com/pidac/
[DEBUG] adding directory com/pidac/axis2test/
[DEBUG] adding directory com/pidac/axis2test/api/
[DEBUG] adding directory com/pidac/axis2test/lib/
[DEBUG] adding entry com/pidac/axis2test/api/Hello.class
[DEBUG] adding entry com/pidac/axis2test/api/Weather.class
[DEBUG] adding entry com/pidac/axis2test/lib/HelloImpl.class
[DEBUG] adding entry com/pidac/axis2test/lib/WeatherService.class
[DEBUG] adding directory META-INF/maven/
[DEBUG] adding directory META-INF/maven/org.pidac.webservices/
[DEBUG] adding directory META-INF/maven/org.pidac.webservices/axis2test/
[DEBUG] adding entry META-INF/maven/org.pidac.webservices/axis2test/pom.xml
[DEBUG] adding entry META-INF/maven/org.pidac.webservices/axis2test/pom.properties
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------ 
```

但是，当我使用 7-Zip 手动分解此 AAR 时，在任何地方都找不到 services.xml。
此处的文档[Maven2 AAR Plug-in Guide](http://axis.apache.org/axis2/java/core/tools/maven-plugins/maven-aar-plugin.html)说

> services.xml 文件的位置。默认情况下，假定文件已经存在于 classesDirectory/META-INF 中，不需要特殊处理

但是当我在构建完成后查看 classesDirectory 时，没有 META-INF 文件夹。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T15:57:30.217

需要尝试更多的东西并在字里行间阅读：

此处的文档[Maven2 AAR 插件指南](http://axis.apache.org/axis2/java/core/tools/maven-plugins/maven-aar-plugin.html)需要澄清此插件的 servicesXmlFile 配置参数，但对我没有帮助。如果您在 Eclipse 中编辑 POM.xml 时幸运地获得了 Intellisense，您将获得对该配置参数的更好描述：

应该有三种方法来解决这个问题：

1.  在 src/main/resources 下创建一个 META-INF 文件夹并添加您的 services.xml。

2.  在 POM 的项目设置下输入以下配置。

    META-INF false ${basedir}/src/main/webapp/META-INF services.xml

3.  在插件的配置设置中输入 services.xml 的路径，如下所示：

    org.apache.axis2 axis2-aar-maven-plugin 1.6.2 axis2-aar:aar
    ${baseDir}/src/main/webapp/META-INF
    ${project.build.directory}/aar /

可能是由不正确的路径引起的，我无法使这种替代方法起作用。也许有人可以发表评论。

# java - Breakout（游戏项目）-让球使球板居中-Java

> ID：11278552
> 
> 赞同：0
> 
> 时间：2012-06-30T23:50:59.093
> 
> 标签：java, graphics, project, breakout

我的目标是让球以桨为中心，即使球半径的值在未来的游戏版本中发生变化。我唯一的问题是为游戏球的 x 坐标实现正确的数学公式。我让 y 坐标公式完美运行。

我不需要正确答案。我只需要指导和建议即可获得答案。

这是java程序的图片：

[http://i33.photobucket.com/albums/d86/warnexus/ball.png](http://i33.photobucket.com/albums/d86/warnexus/ball.png)

您可以在注释“// 此处无法计算数学”下方找到代码。

```
 /** Radius of the ball in pixels */
private static final int BALL_RADIUS = 500;

private void setup_Paddle()
{
    // TODO Auto-generated method stub

    // x coordinate of the upper left corner
    // y coordinate of the upper left corner

    paddle = new GRect(20,20,PADDLE_WIDTH,PADDLE_HEIGHT);
    paddle.setFilled(true);
    paddle.setColor(Color.PINK);
    add(paddle,paddleInitialLocationX,paddleInitialLocationY);

}

private void setup_Ball()
{

    // Trouble figuring the math here
    int ballSetUpCoordX = (int) (paddle.getX());
    // Good Code!
    int ballSetUpCoordY = (int) (paddle.getY()-BALL_RADIUS);

    gameBall = new GOval(BALL_RADIUS,BALL_RADIUS);
    gameBall.setFilled(true);
    gameBall.setColor(Color.BLUE);

    add(gameBall,ballSetUpCoordX,ballSetUpCoordY);
}

    private GOval gameBall;
    private GRect paddle;
    private int paddleInitialLocationX = 200;
    private int paddleInitialLocationY = 500; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:10:07.590

坐标通常用于对象的左上角。因此，要获得任意两个对象`o1`并`o2`在同一个位置居中，您必须根据大小进行偏移。

在这里，我们将`o1`' 中心移动到`o2`' 中心。

```
int o2CenterX = o2.x - (o2.width/2);
//If we just used o2CenterX, it would put the corner of o1 into the center of o2
o1.x = o2CenterX - (o1.width/2); 
```

对 y 重复，您似乎已经完成了（半径用作宽度/2）。除非您希望桨和球在屏幕上相交，否则您可能需要稍微调整此公式。

# c++ - 在 VS10 中制作静态库：如何包含整个目录

> ID：11278556
> 
> 赞同：1
> 
> 时间：2012-06-30T23:51:44.630
> 
> 标签：c++, visual-studio-2010, dll, compilation

我第一次制作静态库，我需要在stdafx.h中输入所有.h依赖项，但是有这么多我不得不问是否有一些命令可以单独输入每个h文件，包括整个目录一次，如下所示：

```
#include "lib\behaviors\ *"
#include "lib\automaticProcessing\ *" 
```

感谢您的反馈。

PS我忘了提到我知道“制作巨人”技术，您将所有依赖项放在一个 .h 文件中，然后仅在需要的地方包含 .h （就像在这种情况下一样）但我忘记应用该技术当我在建立我的图书馆时，所以我现在在没有帮助的情况下被困住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:06:16.130

`dir *.h > all_headers.h`然后对输出进行一些编辑。然后就`#include "all_headers.h"`在您的每个来源中。没有任何通配符可以应用于#include。

# java - JSP 文件无法识别 ArrayList？

> ID：11278561
> 
> 赞同：2
> 
> 时间：2012-06-30T23:53:13.570
> 
> 标签：java, jsp, servlets

鉴于我的项目中我的 JSP 文件的以下预览：

```
<%@ page contentType="text/html; charset=utf-8" language="java"%>
<%@ page import="java.util.ArrayList"%>
<%@ page import="beans.UserBean"%>
<jsp:useBean id="userBean" class="beans.UserBean" scope="session" />
<jsp:useBean id="students" type="ArrayList<beans.UserBean>" scope="session" />
<jsp:useBean id="teachers" type="ArrayList<beans.UserBean>" scope="session" />
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head> 
```

我在 Eclipse 中收到以下错误：

```
Undefined type: ArrayList 
```

它出什么问题了 ？即使我正在导入`ArrayList`，Eclipse 也无法识别它，并在以下两行中显示上述消息：

```
<jsp:useBean id="students" type="ArrayList<beans.UserBean>" scope="session" />
<jsp:useBean id="teachers" type="ArrayList<beans.UserBean>" scope="session" /> 
```

![为了更清晰的图片：](../Images/b8c4502cd0710ab092648e3b6a8aa702.png)

知道我哪里出错了吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-30T23:58:44.457

该`type`属性应该代表类的完全限定名称，而不是通用声明等。更重要的是，JSP/EL 不知道任何方式的泛型类型。

改用`java.util.ArrayList`：

```
<jsp:useBean id="students" type="java.util.ArrayList" scope="session" />
<jsp:useBean id="teachers" type="java.util.ArrayList" scope="session" /> 
```

所有这些`@page import`都是不必要的。它们仅在使用*scriptlet*时使用（那些自 JSP 2.0 以来`<% %>`一直[不鼓励使用的老派东西）。](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)

顺便说一句，如果这些数组列表是事先准备好的并由 servlet 放入作用域中，而您只需要在 EL 中访问它们，那么您根本**不需要**这些`<jsp:useBean>`标签。使用`type`属性而不是`class`属性暗示您*实际上*正在使用 servlet。`<jsp:useBean>`没有这些标签，它也能正常工作。另请参阅[我们的 servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)。

# iphone - 是否需要 Mac 来使用 Rhodes / frameworks 开发 ios 应用程序

> ID：11278566
> 
> 赞同：1
> 
> 时间：2012-06-30T23:54:22.883
> 
> 标签：iphone, ios, rhomobile, rhodes

我知道你需要一台 Mac 来开发原生 iOS 应用程序。但是，我目前正在尝试使用 Rhodes 框架来开发应用程序，并且想知道我是否需要最终购买 Mac 才能为 iOS 等进行编译？

或者可能用于测试等，因为我相信 iOS 没有模拟器

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:31:16.117

您不需要带有 OSX 的 mac 来为 iOS 编译 Rhodes 应用程序，您可以使用[RhoHub](https://app.rhohub.com)。

您可以将您的 Apple 开发人员密钥上传到此服务，它将为您生成二进制文件。

但最后，为了测试和调试你的应用程序，最好有一台 OSX 机器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T23:59:38.607

你实际上必须运行macos。您不必购买 mac，但如果您可以在您的机器上安装 osx 或者如果您购买了 hackintosh，那么您应该没有任何问题。据我所知，有一个模拟器，很可能让它在 Windows 上运行并编译东西。

我在某处读到，你可以在 Windows 上完成大部分工作，但你最终会在 osx 上唱你的包。虽然很有趣。有人提出在 vm 中运行 osx 的想法。如果你真的需要，你可能会这样做。

无论如何，最简单的方法是购买 Mac，但如果您真的拒绝在 Mac 上花钱的想法，您可以找到一种无需 Mac 即可完成所有需要的方法。但是你几乎肯定需要安装 osx。

# frame - 如何从 Frame 的历史记录中删除页面？

> ID：11278569
> 
> 赞同：3
> 
> 时间：2012-06-30T23:55:41.120
> 
> 标签：frame, windows-runtime, winrt-xaml

如何在 WinRT XAML 应用程序中操作 Frame 的历史记录？

用户将从我的中心页面开始，在那里他们可以选择现有项目以进入其编辑屏幕，或者他们可以选择“新项目”。“新建项目”将引导他们通过一个简短的向导，然后将他们带到“编辑项目”屏幕。

向导页面只是我在框架中导航到的页面是有意义的；这样，如果用户改变主意，就可以退出向导。（它只有两页，所以“返回”可以代替“取消”。）但是一旦向导完成并提交了更改，这些向导页面就没有任何理由出现在历史记录中了。如果用户从“编辑项目”页面单击返回，我希望他们直接返回中心。

为了说明，我希望流程看起来像这样：

*   帧历史：集线器。*用户单击“新建项目”。*
*   帧历史：Hub -> 向导页面 1.*用户单击“下一步”。*
*   帧历史：Hub -> Wizard Page 1 -> Wizard Page 2。*用户单击“完成”。*
*   帧历史：集线器 -> 编辑项目。

[Frame](http://msdn.microsoft.com/en-us/library/windows.ui.xaml.controls.frame.aspx)似乎没有任何“从历史中删除”的方法。文档确实暗示可能有某种方法可以覆盖历史记录，因为[GoBack的文档说“](http://msdn.microsoft.com/en-us/library/windows.ui.xaml.controls.frame.goback.aspx)*如果 Frame 管理自己的导航历史*记录，则导航到后退导航历史记录中的最新项目”（强调我的），但那是关于该主题的所有内容-没有提及其他人如何为它管理历史。所以我不知道这是否有用。

用户完成向导后，如何从 Frame 的历史记录中删除我的向导页面？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T11:11:08.140

您可以通过在框架上调用 SetNavigationState(string navigationState) 从历史记录中删除页面。不幸的是，序列化的 navigationState 的格式是“仅供内部使用”，因此仅更改字符串可能会在将来的版本中破坏您的代码。

我只能想到一种未来证明方法来***完全清除***导航堆栈：

1.  在程序启动时，通过调用 GetNavigationState 保存空的导航状态。
2.  在为您的编辑项目页面调用 Navigate 之前，使用空导航状态调用 SetNavigationState。

现在，您的 Edit Project 页面将成为堆栈的第一页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-23T14:34:44.180

从 Windows 8.1 开始，您可以访问 Frame 的 BackStack 属性。您可以轻松删除一些内容或清除整个后台堆栈。

这是我正在使用的清除后台堆栈：

```
var rootFrame   = (Window.Current.Content as Frame);
rootFrame.Navigate(typeof(MyPage));
rootFrame.BackStack.Clear(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-24T20:54:01.773

它对我来说是一个解决方案：

```
while (ContentFrame.BackStack.Count > 1)
            {
              ContentFrame.BackStack.Remove(ContentFrame.BackStack.ElementAt(ContentFrame.BackStack.Count-1));

            } 
```

# html-parsing - BeautifulSoup：仅解析页面的一部分

> ID：11278571
> 
> 赞同：2
> 
> 时间：2012-06-30T23:56:47.363
> 
> 标签：html-parsing, beautifulsoup

我想解析html页面的一部分，比如说

```
my_string = """
<p>Some text. Some text. Some text. Some text. Some text. Some text.
   <a href="#">Link1</a>
   <a href="#">Link2</a>
</p>
<img src="image.png" />
<p>One more paragraph</p>
""" 
```

我将此字符串传递给 BeautifulSoup：

```
soup = BeautifulSoup(my_string)
# add rel="nofollow" to <a> tags
# return comment to the template 
```

但是在解析 BeautifulSoup 的过程中会添加`<html>`,`<head>`和`<body>`标签（如果使用 lxml 或 html5lib 解析器），我的代码中不需要这些。到目前为止，我发现避免这种情况的唯一方法是使用`html.parser`.

我想知道是否有一种方法可以使用最快的解析器 lxml 摆脱冗余标签。

**更新**

最初我的问题被错误地问到了。现在我`<div>`从示例中删除了包装器，因为普通用户不使用此标签。出于这个原因，我们不能使用`.extract()`方法来摆脱`<html>`,`<head>`和`<body>`标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T09:22:00.170

利用

```
soup.body.renderContents() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T15:19:50.470

lxml 将始终添加这些标签，但您可以使用从其中[`Tag.extract()`](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#extract)删除`<div>`标签：

```
comment = soup.body.div.extract() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T22:39:52.137

[我可以使用.contents](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#contents-and-children)属性解决问题：

```
try:
    children = soup.body.contents
    string = ''
    for child in children:
        string += str(item)
    return string
except AttributeError:
    return str(soup) 
```

我认为这`''.join(soup.body.contents)`将是更简洁的字符串转换列表，但这不起作用，我得到了

> 类型错误：序列项 0：预期字符串，找到标记

# c# - Linq ThenBy 可能为空

> ID：11278575
> 
> 赞同：4
> 
> 时间：2012-06-30T23:57:55.407
> 
> 标签：c#, linq

我正在尝试对多个属性上的视图模型绑定进行排序。问题是第二个属性可能为空，我得到一个空引用异常。

```
return this.People
  .OrderBy(x => x.Car.Name)
  .ThenBy(x => x.Pet.Name); 
```

如果 Pet 为空怎么办？我如何仍然按 Pet.Name 进行 ThenBy 排序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T00:01:31.757

这应该在非 null Pets 之前返回 null Pets。

```
return this.People
  .OrderBy(x => x.Car.Name)
  .ThenBy(x => x.Pet != null ? x.Pet.Name : ""); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T00:01:30.230

如果你想让没有宠物的人排在有宠物的人之上，你可以使用这个：

```
return this.People
  .OrderBy(x => x.Car.Name)
  .ThenBy(x => x.Pet == null ? string.Empty : x.Pet.Name); 
```

如果您要进行许多涉及宠物的排序操作，您可以创建自己的`PetComparer`继承自 的类`Comparer<Pet>`，如下所示：

```
public class Pet
{
    public string Name { get; set; }
    // other properties
}

public class PetComparer : Comparer<Pet> // 
{
    public override int Compare(Pet x, Pet y)
    {
        if (x == null) return -1; // y is considered greater than x
        if (y == null) return 1; // x is considered greater than y
        return x.Name.CompareTo(y.Name);
    }
} 
```

现在，您的查询将如下所示：

```
return this.People
  .OrderBy(x => x.Car.Name)
  .ThenBy(x => x.Pet, new PetComparer()); 
```

注意：这将与此答案顶部的查询相反 - 它将没有宠物的人排序到底部（在汽车名称内）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T00:10:27.923

您可以对宠物和汽车使用[Null 对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)，以避免在这种情况下对 null 进行任何额外检查，并将可能的`NullReferenceException`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-07T10:21:27.273

一起使用 null 条件 ( `?.`) 和 null 合并 ( `??`) 运算符，您可以做到这一点 -

```
return this.People
  .OrderBy(x => x.Car.Name)
  .ThenBy(x => x.Pet?.Name ?? string.Empty); 
```

# ruby-on-rails-3 - Rails 3：使用 has_many 进行对象链接：通过关联

> ID：11278577
> 
> 赞同：1
> 
> 时间：2012-06-30T23:58:25.180
> 
> 标签：ruby-on-rails-3, associations

我试图掌握如何在 Rails 中使用关联，特别是何时以及何时不编写显式 SQL 代码。

在我的应用程序中，我有四个模型，定义如下：

```
class User < ActiveRecord::Base
    has_many :comments
    has_many :geographies
    has_many :communities, through: :geographies

class Comment < ActiveRecord::Base
    belongs_to :user

class Community < ActiveRecord::Base
    has_many :geographies
    has_many :users

class Geography < ActiveRecord::Base
    belongs_to :user
    belongs_to :community 
```

用户可以发表评论，并通过地理表关联到一个或多个社区（地理表存储`user_id`和`community_id`）。

我有一个列出所有评论的索引操作，我想按社区过滤。给定一个评论对象，我可以通过 获取用户对象`comment.user`，但我不能超越它（即，类似的东西`comment.user.geography(0).community`不起作用）。

似乎这个对象链接是 rails 的一个关键特性，但它是否适用于 has_many :through 关联？给定我的示例，是否可以通过使用对象链接从评论对象中获取社区对象，或者在给定评论对象时，我是否需要编写 SQL 来获取用户以外的任何内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T05:42:15.997

我认为您不需要地理表。

尝试

```
class Community < ActiveRecord::Base
    has_many :users
end

class User < ActiveRecord::Base
    belongs_to :community
    has_many :comments
end

class Comment < ActiveRecord::Base
    belongs_to :user
end 
```

然后您可以访问评论的用户社区，例如 `@comment.user.community`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T16:16:20.803

由于用户与多个社区相关联，因此您需要告诉 ActiveRecord（或原始 SQL）您想要哪个社区：

```
comment.user.communities #=> should give you all the communities 
```

如果您不是特别关心获得所有社区而只想获得任何社区

```
comment.user.communities.first #=> should give you the first community 
```

但是，通常您会根据条件对某个特定社区感兴趣。

```
comment.user.communities.where(name: 'Europe') #=> should give you the European community. 
```

# ruby-on-rails - 如何找到 id 与任何数组不匹配的位置？

> ID：11278582
> 
> 赞同：1
> 
> 时间：2012-06-30T23:59:28.373
> 
> 标签：ruby-on-rails, ruby

我有一个`Workout`模型，它拥有并属于许多`Equipment`模型。`Equipment`我有一些ID的数组。我想找到所有`Workouts`没有与任何ID`Equipment`数组匹配的分配。`Equipment`

因此，如果我`array = [2,3,5]`想查找分配的设备 ID 不包括的所有锻炼`2`，`3`或`5`.

编辑：

```
Workout.joins(:equipment).where("equipment.id not in(?)",[2,3,5]).uniq 
```

假设有 5 个实例，上面的代码返回带有s和(good) 的`Equipment`锻炼，但也返回部分匹配，例如带有= , 。`equipment.id``1``4``Workouts``equipment.id``[1,2]``[1,2,3]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:05:21.500

```
Workout.joins(:equipment).merge(Equipment.where("id not in(?)",[2,3,5])).uniq 
```

或者

```
Workout.joins(:equipment).where("equipments.id not in(?)",[2,3,5]).uniq 
```

你也可以试试这个，它应该找到所有没有任何设备的锻炼

```
Workout.includes(:equipment).where("equipments.id not in(?)",[2,3,5]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T09:12:00.850

考虑查询返回的结果集会有所帮助。

```
Workout.joins(:equipment).where("equipment.id not in(?)",[2,3,5]).uniq 
```

将所有相关设备加入到他们的锻炼中。如果锻炼与 4 台设备相关联，那么您将获得 4 行用于该锻炼。where 子句只是将 4 过滤到一个较小的数字 - 它不能仅仅因为一个匹配就将它们全部清除。

您需要做的是向联接本身添加条件。就像是

```
select workouts.*
left join equipments_workouts on workout_id = workouts.id and equipment_id in (2,3,5)
where equipment_id is null 
```

应该返回正确的锻炼（它也应该返回一个带有 0 个设备的锻炼，但我不知道这是否是一个考虑因素。）

这是通过尝试加入“坏”设备来实现的。因为它是左连接，所以如果找不到这样的行，那么结果集仍将包含该锻炼的行，但equimnts_workouts 的列都设置为空。作为奖励，您不再需要消除重复项。

Activerecord 没有很好的方式来编写这样的查询。joins 方法将接受任意 SQL 片段：

```
Workout.joins("left join equipment_workouts on workout_id = workouts.id and equipment_id in (2,3,5)").
        where("equipment_id is null") 
```

您可能会发现该`sanitize_sql`方法对生成该 sql 片段很有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T04:49:10.950

这可以改进，但应该工作：

```
class Workout < ActiveRecord::Base
  scope :without_equipments, lambda{|ids| joins(:equipment).where("equipments.id not in (?)", ids.repeated_permutation(ids.size).map(&:uniq).uniq)}
end
Workout.without_equipments 2,3,5 
```

# python - App Engine 的用户名和密码登录？

> ID：11278586
> 
> 赞同：3
> 
> 时间：2012-06-30T23:59:52.910
> 
> 标签：python, google-app-engine, login, openid, authorization

是否有任何库为 Google AppEngine 提供用户名和密码登录？

虽然我可以尝试从头开始滚动一个，但如果可能的话，我宁愿不尝试重新发明轮子。

如果没有，是否可以将我的应用程序转换为 OpenId 提供程序，然后使用它来登录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T00:05:33.000

试试[EngineAuth](http://code.scotchmedia.com/engineauth/docs/index.html)。它有许多不同的身份验证系统选项，包括电子邮件+密码身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T23:48:41.400

GAE 通过其[用户 API](https://developers.google.com/appengine/docs/python/users/)支持三种类型的登录（Google 帐户、Google Apps 帐户和 OpenId）。有关后者的示例，请参见[本文](https://developers.google.com/appengine/articles/openid)。

使用的登录类型是在创建应用程序时定义的，有关详细信息，请参阅[此](https://developers.google.com/appengine/docs/python/users/overview#Authentication_Options)内容。

# android - Eclipse 3.7.2 不会创建 android 项目

> ID：11278587
> 
> 赞同：3
> 
> 时间：2012-07-01T00:00:19.647
> 
> 标签：android, eclipse

我在为 android 创建项目时遇到问题。我已将 SDK 升级到 Jelly Bean 和 eclipse，但现在我看到了一个新的创建项目模板，该模板在安装依赖项处停止。我想要 Android 支持库版本 8，但我安装了版本 9。如果有人知道如何进行，请告知。

谢谢，唐

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T06:52:15.370

东西坏了，这里有同样的问题。从 Android SDK Manager 卸载 Android Support Library 然后在创建新项目并提示安装库时，单击安装，这些步骤似乎有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T13:31:50.900

我有同样的问题，但对我来说卸载/重新安装库方法不起作用。但是我找到了一种制作新项目的方法：

*   找一个 HelloWorld 项目（也许你已经有了，或者找人发给你或者从网上下载）

*   将其导入 Eclipse。

*   将其用作模板，只需复制/粘贴即可创建新项目。

这不是最好的解决方案，但由于我找不到另一个解决方案，所以现在可以这样做，直到他们解决问题。

# android - requestFocus 不适用于 EditText

> ID：11278589
> 
> 赞同：13
> 
> 时间：2012-07-01T00:00:34.377
> 
> 标签：android, android-layout, android-edittext, focus, text-cursor

花了很多时间解决这个问题，看起来很容易，但我真的很累，找不到解决方案。我有一个活动，活动有 4 个 EditText 组件，其中 2 个有弹出菜单（AlertDialog），其中包含列表，下一个 - 禁用编辑，最后一个 - 可编辑，并且应该显示软键盘，当用户是点击它。

另外，我的根 LinearLayout 有 LinearLayout 包含在 RelativeLayout 中。最后一个是需要 AdvBanner。最后一个 LinearLayout(RelativeLayout) 与根布局的底部对齐。

XML 中描述它的部分：

```
 <LinearLayout
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:layout_gravity="bottom"
      android:focusable="false"
      android:focusableInTouchMode="false" 
      android:gravity="bottom">
  <RelativeLayout 
      android:id="@+id/AdvLayoutReserveArea" 
      android:layout_width="fill_parent" 
      android:layout_height="50dp" 
      android:background="#FFFFFF"
      android:focusable="false"
      android:focusableInTouchMode="false" 
      android:gravity="bottom" /> 
  </LinearLayout> 
```

活动开始时，可​​编辑的 EditText 以**绿色**边框为焦点，光标闪烁。几秒钟后，AdvBanner 被加载并显示。当它发生时，可编辑的 EditText 失去了焦点。从这一刻开始，我的生活就像一场噩梦。

让我们一步一步看。

**问题 1.** 如果在**这个**时刻（当 Adv 加载并出现时）用户正在通过软键盘编辑 EditText 字段，焦点丢失，边框采用**灰色**，如果用户继续输入文本没有结果 - 符号是未打印（EditText 中的 CURSOR 太丢失）。

我认为任何用户都会感到恼火 - 当您输入文本时，光标处于非活动状态，因为在后台加载了一些广告并且它会专注于自己。

为了解决这个问题，在加载 Adv 的方法中（如图所示），我尝试通过 requestFocus 方法手动将焦点返回到 EditText。

```
public void onAdLoaded() 
    {
// TODO Auto-generated method stub
// add app specific code for this event here...
// called when an ad is successfully displayed on device            
    CountEdit1.requestFocus();
} 
```

是的，光标返回到 EditText 字段，如果软键盘处于活动状态，用户仍然可以输入文本，但 EditText 字段的边框保持灰色...

**注意：**实际上我不确定重点 EditText 的绿色和灰色边框之间的区别。绿色通常是用户点击它时，而灰色，可能是当我们想要手动请求焦点时（使用 requestFocus() 等)

**问题 2。**（作为解决问题 #1 的结果）。软键盘关闭后，如果用户点击可编辑的 EditText 字段，它会获得焦点并且光标出现在里面，但再次显示软键盘没有反应！点击它不会显示软键盘，但看起来像复制模式下的编辑字段 - 当用户可以选择文本并将其剪切/复制到剪贴板时。

我的目标很容易看一眼。我只想在显示软键盘和用户输入一些文本时保存光标并聚焦到可编辑的 EditText 字段（CountEdit1）。用户点击 EditText 时的正常反应 - 像往常一样，只给我看软键盘！

我在这里阅读了所有问题，我结合了不同的方法（clearFocus、requestFocusFromTouch 等），只是没有足够的时间和空间来描述我为解决这个问题而尝试做的所有事情。主要问题如上所述。

希望得到帮助并解决问题...在此先感谢..

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-02T00:47:06.287

目标解决了，解决方法比我想象的要容易。问题 #2 通过使用 onClick () 方法得到解决。使用 clearFocus() 和 requestFocus() 方法的软键盘出现的充分条件。

> ```
>  CountEdit1.setOnClickListener(new OnClickListener() {
> 
>       @Override
>       public void onClick(View v)
>       {
>               CountEdit1.clearFocus();
>         CountEdit1.requestFocus();
>       }
>     }); 
> ```

当用户点击 EditText 字段时会出现软键盘。固定的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-02T11:14:56.067

为我工作：

```
InputMethodManager mgr = (InputMethodManager) context.getSystemService(Context.INPUT_METHOD_SERVICE);
editField.requestFocus();
mgr.showSoftInput(editField, InputMethodManager.SHOW_IMPLICIT); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-01T12:23:26.470

```
userInput.post(new Runnable() {
            public void run() {
                userIdInput.requestFocus();

            }
        }); 
```

试一试，看看您的问题是否仍未解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-30T12:38:05.723

在片段或活动中创建视图后，您应该请求焦点：

```
@Override
public void onViewCreated(View view, Bundle savedInstanceState) {
    CountEdit1.requestFocus();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-15T11:50:32.973

尝试这个：

```
public void onAdLoaded() 
    {  
  final Handler handler = new Handler();
             handler.postDelayed(new Runnable() {
                 @Override
                 public void run() {
                     CountEdit1.requestFocus();
                     InputMethodManager mgr = (InputMethodManager) base.getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
                     mgr.showSoftInput(CountEdit1, InputMethodManager.SHOW_IMPLICIT);
                     CountEdit1.setSelection(CountEdit1.getText().length());
                 }
             },0);
} 
```

# arrays - Autoit - 嵌套数组

> ID：11278600
> 
> 赞同：1
> 
> 时间：2012-07-01T00:02:32.237
> 
> 标签：arrays, variable-assignment, autoit

我正在尝试访问 Autoit 中嵌套数组中的值，但我收到超出范围的错误消息。这是我的代码：

```
Func ThisFunction()
  local $one[6] = [1, 2, 3, 4, 5, 6]
  local $two[6] = [7, 8, 9, 10, 11, 12]

  local $combined[2] = [$one, $two]

  For $i = 0 to UBound($combined)-1
    $result = SomeFunction ( $combined[$i] )
    If $result Then
      return $combined[$i][0]
    EndIf
  Next
EndFunc 
```

有没有办法从嵌套的 $combined 数组中访问/返回特定索引？

编辑：我找到了一个可行的解决方案，我不知道这是否是一个好习惯

```
 For $i = 0 to UBound($combined)-1
    $result = SomeFunction ( $combined[$i] )
    If $result Then
      local $temp = $combined[$i]
      If IsArray($temp) Then
        return $temp[0]
      EndIf
    EndIf
  Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T11:31:29.540

```
For $i = 0 to UBound($combined)-1
    $result = SomeFunction ( $combined[$i] )
    If $result Then
      local $temp = $combined[$i]
      If IsArray($temp) Then
        return $temp[0]
      EndIf
    EndIf
  Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:27:05.533

您的问题是您将 $combined 视为二维数组。但它是一个一维数组。（在你的回报）。

试试 $one[$combined[$i]]

# c# - .NET 中的可移植对象格式 (POF) 序列化

> ID：11278602
> 
> 赞同：1
> 
> 时间：2012-07-01T00:02:57.327
> 
> 标签：c#, serialization, deserialization, oracle-coherence

我有一个名为 MyClass 的类和这种类型的 pof 配置（my-pof-config.xml）。我需要序列化 ​​MyType 的一个实例，然后通过 JMS 发送它。

在 Coherence Java API 中，有 ExternalizableHelper.toByteArray/fromByteArray。如何在 C# 中进行 POF（[便携式对象格式](http://coherence.oracle.com/display/COH35UG/The+Portable+Object+Format)）序列化和反序列化？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T22:39:56.057

在 .Net 中，您拥有`Tangosol.Util.SerializationHelper`与 Java 相同的`ExternalizableHelper`; 像这样的东西......序列化：

```
ConfigrablePofContext serializer = new ConfigurablePofContext("...config file name...");
Binary binary = SerializationHelper.ToBinary(objectToSerialize, serializer);
byte[] bytes = binary.ToByteArray(); 
```

反序列化

```
ConfigrablePofContext serializer = new ConfigurablePofContext("...config file name...");
Binary binary = new Binary(byteArray);
Object deserializedValue = SerializationHelper.FromBinary(binary, serializer); 
```

# jquery - Jquery 事件作为副作用被触发。如何阻止它

> ID：11278606
> 
> 赞同：2
> 
> 时间：2012-07-01T00:05:05.973
> 
> 标签：jquery, show-hide

我有一个切换表的特定要求。切换我的意思是一个表格，它会在点击超链接的事件时展开和折叠。

我如何制作表格的片段是：

```
 <table class=".table" border="1">
     <tr id="1">
        <td><a href="#" class="action" id="a-1">+</a></td>
        <td>Superman</td>
     </tr>
     <tr id="version" class="child 1">
        <td></td>
        <td>Weight</td>
     </tr>
     <tr id="type" class="child 1">
        <td></td>
        <td>Height</td>
     </tr>
     <tr id="pl-id" class="child 1">
        <td><a href="#" class="action" id="a-1-101">+</a></td>
        <td>Planet</td>
     </tr>
     <tr id="KP" class="child 1-101">
        <td></td>
        <td>KP</td>
     </tr>
     <tr id="MN" class="child 1-101">
        <td></td>
        <td>MN</td>
     </tr>
     ..
     .. 
```

表可以想象有一个排序的结构

```
1)  - Superman
        Weight
        Height
        - Planet
            KP
            MN

2)  + Superman

3)   - Superman
          - Planet
              KP
              MN 
```

在第一个状态下点击`-`超人应该进入第二个状态而不是第三个状态。

JQuery 我写过这样做：

```
$().ready(function() {
            $('.child').hide();
            $('.action').click(function(){

                var id = $(this).attr('id');
                var idarray=id.split("-");
                var len = idarray.length;

                if(len==2)
                    {
                        id = id.substring(2);

                        if($(this).parent().parent().next().attr('style')=="display: none; "){
                            $('tr[class^=child '+id+'-1]').hide();
                            $('tr[class=child '+id+']').show();
                        }
                        if($(this).parent().parent().next().attr('style')=="display: table-row; "){
                            $('tr[class^=child '+id+'-1]').hide();
                            $('tr[class=child '+id+']').hide();
                        }

                    }
                else if(len==3)
                    {
                        //HAVEN'T REACHED TILL RESOLVING FOR 3 :(
                        /*id = id.substring(2);
                        alert(id);
                        $("."+id).toggle();
                        $('tr[class^=child '+id+']').hide();
                        $('tr[class=child '+id+']').show();*/

                    }
            });
        }); 
```

在单击超链接时使用此 JQuery`id=a-1` `display:none block`会执行，但`display:table-row`由于其中的显示/隐藏功能，它会自行触发块。没有发生重新单击，那么为什么再次模拟单击事件。我不希望 display:table-row 块被执行。当前，当 html 页面加载时，表处于第二状态，即使在单击`+`Superman 后，它仍保持在相同状态，因为 if 和 else 条件都被评估，这使其恢复到原始状态。

如何以简单的方式实现这一要求。我是 JQuery 的新手，尝试了很多事情，我完全糊涂了。有人可以告诉我一种可以做到这一点的方法。请给出一个可行的或接近可行的解决方案。请不要提供文档链接。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:29:37.800

问题在于您的参考。请注意，JQuery 使用 Sizzle 选择器，它基本上为您提供 CSS 样式的元素引用。

这种引用不起作用：

```
$('tr[class=child '+id+']').show(); 
```

您需要使用属性列表选择器：

```
$('tr[class~=child][class~='+id+']').show(); 
```

或者，更好的是，因为您正在处理 CSS 类（除非您需要模糊匹配，否则不要对 ID 或类使用属性选择器）：

```
$('tr.child.'+id).show(); 
```

说了这么多……我强烈建议你看看你的实现。不要使用具有半隐藏行的表，而是使用容器对象。它将大大简化您的代码并使更新更容易。正如你所拥有的......好吧，我很同情下一个必须介入并试图维持它的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T08:07:26.577

将我的脚本修改为

```
 $('.action').click(function(){

            var id = $(this).attr('id');    
            var idarray=id.split("-");
            var len = idarray.length;
            id = id.substring(2);

    if($(this).parent().parent().next().attr('style')=="display: none; "){
            $('tr[class=child '+id+']').show();
            $('tr[class^=child '+id+'-]').show();
            return false;
    }
    if($(this).parent().parent().next().attr('style')=="display: table-row; "){
            $('tr[class=child '+id+']').hide();
            $('tr[class^=child '+id+'-]').hide();
            return false;
    } 
```

现在这工作正常。解决我的问题的行是`return false;`. 它停止了副作用 JQuery 事件。

在[John Green](https://stackoverflow.com/questions/11278606/jquery-event-getting-triggered-as-a-side-effect-how-to-stop-that/11278706#11278706)的投入之后，对它进行了更多的思考，并使其工作并且不那么笨拙。

# iphone - UINavigationBar 更改默认字体颜色

> ID：11278607
> 
> 赞同：0
> 
> 时间：2012-07-01T00:05:16.323
> 
> 标签：iphone, objective-c, ios, hook

我正在尝试编写一个移动基板调整来修改 UINavigationBar 标题和按钮中的应用程序使用的默认字体颜色，例如，而不是导航栏中的默认白色标题，所有白色导航栏文本都会变成红色，

希望这是有道理的。

目前我正在尝试：

```
%hood UINavigationBar
-(void)setTitleView:(id)arg1 {
    %orig
    UILabel *titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 320, 30)];
    titleLabel.textColor = [UIColor redColor]
}
%end 
```

我觉得它是因为我试图设置一个新的 UILabel 而不是替换被拉出的默认 setTitleView。

任何帮助将不胜感激 ：）

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T00:45:51.047

在 iOS 5+ 中，有一种使用[UIAppearance](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)协议的新方法。[这里](http://www.raywenderlich.com/4344/user-interface-customization-in-ios-5)有一个关于如何使用它的好教程。

如果你仍然需要支持 iOS 4，你可以创建一个子类，`UIViewController`并在创建类时重写各种`init*`方法来设置属性`viewDidLoad`等`viewWillAppear`。然后你的所有控制器都可以从这里继承而不是`UIViewController`直接继承。

还有其他方法可以做到这一点，例如在其上添加类别方法`UIViewController`或混合其方法 - 但我认为上述方法是最简单的。

# android - 从源代码自定义 Android MMS/SMS 应用程序？

> ID：11278614
> 
> 赞同：3
> 
> 时间：2012-07-01T00:06:36.217
> 
> 标签：android, sms, mms

好的，这是交易：

我想下载 Android 手机附带的 MMS/SMS 应用程序的完整源代码。我希望能够对其进行修改，并为其添加一些自定义功能。

我正在使用 Eclipse 进行开发，并且使用的是 Windows 7。我注意到现在有一​​个适用于 Windows 的 Git，但我很迷茫，不知道如何将所有东西与 Eclipse 集成。

基本上，我只想让它在 Eclipse 中可见所有源代码，并且能够看到应用程序运行，就像我手机上已有的内置短信/彩信应用程序一样。然后我会知道我可以修改它并继续。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:11:33.810

[这里](https://github.com/android/platform_packages_apps_mms)有 GitHub 上 SMS/MMS 应用程序的镜像。只需将其导入 Eclipse 并自定义即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T05:10:46.090

除非您只想在自己的手机上自定义和使用它（不发布），否则这不是一个好主意。这是因为它使用了对 sdk 隐藏的类。默认情况下，您甚至无法通过 eclipse 构建 apk，但有一种[方法](http://devmaze.wordpress.com/2011/01/18/using-com-android-internal-part-1-introduction/). 这是一个坏主意的原因是隐藏的 api 不能保证通过不同的 api 级别保持不变，并且您的应用程序可能会停止使用下一个 android 更新，并且可能也无法在以前的 api 级别上运行。事实上，您的应用程序甚至可能无法在运行相同 api 级别的选定手机上运行。

# objective-c - 使用字符串变量更新 UIButton 标题

> ID：11278617
> 
> 赞同：-1
> 
> 时间：2012-07-01T00:06:51.583
> 
> 标签：objective-c, ios, cocoa-touch, ipad

我正在尝试使用已转换为字符串并遇到问题的整数以编程方式更新按钮的标题。这是我所拥有的...

```
NSString *buttonText = [NSString stringWithFormat:@"%i", clickUp];
[myButton setTitle:@"%i" forState:UIControlStateNormal, buttonText]; 
```

这样做会给我“方法调用的参数太多，预期 2 有 3”的错误。如果我手动设置标题，它工作正常。

您能否将字符串传递给按钮标题，如果可以，有人可以与我分享如何吗？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T00:09:34.147

在您的第二行代码中，执行以下操作：

```
[myButton setTitle:buttonText forState:UIControlStateNormal]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:09:44.187

```
[myButton setTitle:@"%i" forState:UIControlStateNormal, buttonText]; 
```

应该

```
[myButton setTitle:buttonText forState:UIControlStateNormal]; 
```

您已经声明`buttonText`为`NSString*`，因此不需要字符串文字。此外，它是整数的文字。一个对象，如果你想获得技术，使用文字 %@，它看起来像这样：

```
[myButton setTitle:[NSString stringWithFormat:@"%@", buttonText] forState:UIControlStateNormal]; 
```

# javascript - 寻找 Javascript Typed Arrays 仿真库

> ID：11278619
> 
> 赞同：13
> 
> 时间：2012-07-01T00:07:26.170
> 
> 标签：javascript, internet-explorer-8, typed-arrays

我正在寻找一个允许在旧 JS 引擎中模拟类型化数组的库。

至少，我想支持 IE8（因为 WinXP）和 Android 2.x（因为 Android 设备碎片化，不太可能升级）

是的，性能将是一个问题，但正如它所说，“让它工作，然后让它快速工作......”

单一代码库现在对我来说更重要。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-01T00:18:24.247

我相信这就是你要找的东西：http: [//www.calormen.com/polyfill/typedarray.js](http://www.calormen.com/polyfill/typedarray.js)

它是由 Linden Research 制造的 polyfill。我通过[这个页面](http://www.calormen.com/polyfill/)找到了它。不过，它已经很老了（2010 年）。

# c++ - MSVS 2010 C++ 编译器和堆栈对齐问题？

> ID：11278620
> 
> 赞同：0
> 
> 时间：2012-07-01T00:07:31.890
> 
> 标签：c++, visual-studio, assembly, calling-convention

我的问题是 MSVS 2010 C++ 编译器在从另一个 dll 在运行时解析的函数调用（GetProcAddress+GetModuleHandle）返回后以某种方式生成代码，然后编译器尝试以这种方式对齐堆栈：

```
 CALL DWORD PTR DS:[2000367C]             ;  apiresolvedinruntime.dll
   ADD ESP,12                               ;  <- this is the stack alignment 
```

这当然会覆盖返回地址并且我的程序崩溃，有人可以解释一下为什么编译器在不应该这样做时对齐堆栈吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T00:11:33.150

您没有使用正确的调用约定调用运行时加载的函数。调用约定指定堆栈发生的默认处理。最有可能的是，DLL 是使用`__stdcall`调用约定（例如，Windows DLL 使用的）编译的，它指定被调用的函数应该清理堆栈，但调用代码是使用`__cdecl`调用约定用函数指针声明的（这是默认设置）。下`__cdecl`，函数支持可变参数，所以调用者需要做堆栈的清理，因为被调用的函数不知道传递了多少参数。

您需要验证 DLL 和调用代码是否使用相同的调用约定进行编译。

# mysql - 如何按字段分组并返回其他字段的列表？

> ID：11278625
> 
> 赞同：0
> 
> 时间：2012-07-01T00:10:09.397
> 
> 标签：mysql, sql

我有一个包含 id 列的表，用户我想按列 id 分组并显示每个 id 的用户列表（逗号分隔）。

在最终输出中，我需要显示：

```
user joe - id 1
users jim, mark, john - id 2
user dave - id 3
.... 
```

如果我尝试这个，我会收到错误“违反基数：1242 子查询返回超过 1 行”：

```
SELECT id, (SELECT distinct(user) FROM mytable b where a.id = b.id)
FROM mytable a
GROUP BY id 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T00:15:02.113

由于您使用的是 MySQL，因此有一个内置函数，即**[GROUP_CONCAT](http://mahmudahsan.wordpress.com/2008/08/27/mysql-the-group_concat-function/)**函数。例如，您有这样的记录：

```
ID      User
1       Joe
2       Jim
2       Mark
2       John
3       Dave 
```

如果您尝试运行此查询：

```
SELECT ID, GROUP_CONCAT(User) Users
FROM tableName
GROUP BY ID 
```

然后你会得到这样的结果：

```
ID         Users
1          Joe
2          Jim, Mark, John
3          Dave 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:13:28.303

您正在寻找的是`GROUP_CONCAT`聚合函数：

```
SELECT id, GROUP_CONCAT(user) FROM table GROUP BY id 
```

# php - setCookie 的问题

> ID：11278626
> 
> 赞同：0
> 
> 时间：2012-07-01T00:10:19.890
> 
> 标签：php, session, login, logout, setcookie

我相信我这样做是正确的，但它没有获取存储的 cookie 信息

登录.php

```
session_start(); 
      $_SESSION['username'] = $user;
      $_SESSION['password'] = $pass;
          if(isset($_POST['remmemberme'])) 
    { ob_start();
        setcookie("kitbusername", $_SESSION['username'], time()+60*60*24*100); 
        setcookie("kitbpassword", $_SESSION['password'], time()+60*60*24*100); 
        echo '<script>
      window.top.location.href = "index.php";
      </script>';
    } 
```

索引.php

```
 <p class="welcome">Hello 
        <?php 
session_start();
 if($_COOKIE['kitbusername']){echo $_SESSION['username'];} 
                 elseif($_SESSION['username']){
                         echo $_COOKIE['kitbusername'];
                 } else{
                   echo 'Guest';
                                  }?>
</p> 
```

头文件.php

```
<?php session_start(); 
if(isset($_SESSION['username']) || isset($_COOKIE['kitbusername'])){
//Log Out Button// ?> 
```

在所有页面上设置会话开始

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:11:56.573

您没有`session_start()`在 index.php 上使用

打完电话后`ob_start()`你打[`ob_end_clean()`](http://us2.php.net/manual/en/function.ob-end-clean.php), [`ob_end_flush()`](http://us2.php.net/manual/en/function.ob-end-flush.php), [`ob_clean()`](http://us2.php.net/manual/en/function.ob-clean.php), 还是[`ob_flush()`](http://us2.php.net/manual/en/function.ob-flush.php)?

# iphone - 具有最小错误/漂移的 iPhone 计时器

> ID：11278630
> 
> 赞同：2
> 
> 时间：2012-07-01T00:10:56.020
> 
> 标签：iphone, timer, nstimer

我正在寻找能够快速重复的功能——大约 50 毫秒。但是，我需要在通话中尽可能保持一致性，并且我发现 NSTimer 有点不稳定。看来我可能会在保持时间方面找到一些帮助[mach_absolute_time](https://stackoverflow.com/questions/1450737/what-is-mach-absolute-time-based-on-on-iphone)。关于使用它来创建一个非常准确的计时器的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:24:45.473

你有没有看过GCD，特别是`dispatch_source_create()`？

[http://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_source_create](http://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_source_create)

# php - jQuery .load() 中断加载到 html 正文中的 PHP 变量

> ID：11278633
> 
> 赞同：2
> 
> 时间：2012-07-01T00:11:08.807
> 
> 标签：php, jquery, html

所以我有一个有趣的问题

我在使用 jquery .load() 函数时遇到问题。我有一个文件结构如下

```
index.php  
|  
|---header.html  
|---body.html  
|---footer.html 
```

index.php 设置三个变量`$variable_one = new Database('passedQuery');`

然后将 header.html、body.html 和 footer.html 包含在 index.php 中

在 body.html 我有类似的东西

```
<div class="span4 well">
        <h3>Current Statistics</h3>
        <hr>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Users</th>
                    <th>Event One</th>
                    <th>Event Two</th>
                    <th>Event Three</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><?php echo $var1->result[0][0]; ?></td>
                    <td><?php echo $var2->result[0][0]; ?></td>
                    <td><?php echo $var3->result[0][0]; ?></td>
                </tr>
            </tbody>
        </table>
    </div> 
```

我在 body.html 中还有一个表单，它是通过通用 jquery 函数提交的

```
 $(document).ready(function(){
    $('.btn').bind('click', function(e){
        e.preventDefault();
        var form = $(this).parents('form');
        var vals = $(form).serialize();
        var form_id = $(form).attr('id');
        $.ajax({
            url: $(form).attr('action'),
            type: $(form).attr('method'),
            data: vals,
            dataType: 'json',
            success: function(data){
                console.log("Success");
                $('#information').html('<div class="alert alert-success">Great Success! :)</div>');
                setTimeout(function() {
                    $('#content').load('views/partials/body.html');
                }, 5000);
            },
            error: function(a, b, c){
                console.log("Error");
                $('#information').html('<div class="alert alert-error">Epic Failure</div>');
                setTimeout(function() {
                    $('#content').load('views/partials/body.html');
                }, 5000);
            }
        });
    });
 }); 
```

当我提交表单并重新加载正文时，在 html 中回显的 PHP 变量现在消失了，我收到类似于以下内容的 apache 错误

```
[dateTime] [error] [client IP] PHP Notice:  Undefined variable: variable in /path/to/body.html on line 133, referer: myReferrer 
```

我问了我的几个朋友，他们都被难住了，Freenode 的#jquery 也是如此。有人有想法么？

**更新 - 表格代码和 index.php 代码** *表格*

```
<div class="span4 well">
        <form class="form-horizontal" id="admin_add" name="admin_add" method="post" action="routes/to/add_admin.php">
            <fieldset>
                <legend>Add Administrator</legend>
                <div class="control-group">
                    <label class="control-label" for="select03">Select a user</label>
                    <div class="controls">
                        <select id="select03" name="user">
                            <?php
                                foreach($var1->result as $key => $value)
                                    echo "<option>".$value[0]."</option>";
                            ?>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary form-submit-button">Submit</button>
                </div>
            </fieldset>
        </form>
    </div> 
```

*指数*

```
$var2 = new Database('query', 'SELECT COUNT(uid) FROM attendees WHERE eid = 1');
$var3 = new Database('query', 'SELECT COUNT(uid) FROM attendees WHERE eid = 2');

/**
 * List users to add to database
 */
$var1 = new Database('query', 'SELECT name FROM users WHERE admin=0');

/**
 * Include all the visuals
 */
include('views/partials/header.html');
require_once('views/partials/body.html');
include('views/partials/footer.html'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T00:22:27.907

当您第一次加载 body.html 时，我猜您正在使用 php 的`include()`函数加载它。好吧，它的作用是“连接” php，因此在服务器端它就像一个长 php 文件。这适用于您的变量，因为它好像代码中没有中断。

当您使用 jQuery 的`load()`函数时，这会发生在客户端。正在发生的事情是您正在获取 JUST 的 html 输出，`body.html`并且您正在动态地（在客户端）将该内容放入客户端页面。

您遇到的问题是 PHP 不再连接。`load()`接受`body.html`它的奇点并将其放入页面中。

另一种看待它的方式是，当有人去`index.php`解析 php 时，所有被回显的变量都会变成沼泽标准 text/html 并传送到浏览器。一旦它们不再是 php 变量，它们只是 text/html。通过 javascript发出新请求`body.html`意味着您引用的那些变量不再可用。它们已经被转换为 HTML 并发送到浏览器，然后 php 停止了，这是一个新请求。

老实说，我不知道你想如何解决这个问题。你可能想研究一个像 smarty 这样的模板系统。或者您可能希望将您的函数放入一个名为`functions.php`include it into your的文件`body.html`中，然后在您的文件中引用这些函数，`body.html`而不是依赖索引页面中的代码。

即你的`body.html`会是这样的：

```
<?php include "functions.php"; ?>
<div ...>
<?php 
    $var1 = getVar1(); // function in functions.php
    echo $var1->result[0][0];
    // ... etc
?>
</div> 
```

然后当它从 javascript 调用时，在它被传递到浏览器之前，php 将被评估并且一切都会工作。

希望我已经很好地解释了这个家伙。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:21:56.473

当您的 jQuery 请求到达服务器时，它将返回 body.html，它没有任何 PHP 处理，因此您在 index.php 中设置的变量不存在。

# mysql - “搜索”mysql 查询问题

> ID：11278635
> 
> 赞同：1
> 
> 时间：2012-07-01T00:11:16.763
> 
> 标签：mysql, sql

我有这个查询，我可以在其中搜索 TABLE_GLOBAL_PRODUCTS

```
$catglobal_sql = "
 select p.*, 
   case when 
     p.specials_new_products_price >= 0.0000 
     and p.expires_date > Now() 
     and p.status != 0 
   then p.specials_new_products_price 
   else p.products_price 
   end price 
 from ".TABLE_GLOBAL_PRODUCTS." p 
   INNER JOIN ".TABLE_STORES." s ON s.blog_id = p.blog_id 
 where 
   MATCH (p.products_name,p.products_description) AGAINST ('%".$search_key."%') 
   OR p.products_name like '%".$search_key."%' 
   order by p.products_date_added DESC, p.products_name"; 
```

这里的问题是，当我使用类似的短语进行搜索时，`Cotton Shirts`它会显示正确的结果。但是，当我只输入一个单词 like`Cotton`时，它​​不会显示任何结果，而不是显示与输入短语 like 时相同的结果`Cotton Shirts`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:40:47.877

使用 MATCH ... AGAINST ... 时使用 * 而不是 % 作为通配符...因此，您的代码的匹配部分应如下所示：

> ...
> 
> MATCH (p.products_name,p.products_description) 反对 ('*".$search_key."*')
> 
> ...

在 MATCH 中，通配符略有不同

### 要匹配零个或多个字符，请使用

*   在 MATCH '*'
*   在 LIKE '%'

### 要匹配任何单个字符，请使用

*   在 MATCH '?'
*   在喜欢'_'

# ruby-on-rails - 为什么我在 Rails 中收到方法未定义错误？

> ID：11278639
> 
> 赞同：0
> 
> 时间：2012-07-01T00:11:34.087
> 
> 标签：ruby-on-rails, methods

我正在努力让用户登录和退出我的 rails 应用程序。我得到的错误如下

> 未定义的方法“find_by_remember_token”

有问题的方法是这样写的：

```
def current_user
@current_user ||= User.find_by_remember_token(cookies[:remember_token])
end 
```

非常感谢您在修复此错误时提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T12:08:58.847

您可以重置数据库并在一行中迁移：

```
rake db:migrate:reset && rake db:migrate && annotate 
```

在您的项目中使用 gem 注释来更好地查看您的数据库列

在您的 Gemfile 中添加：

```
gem 'annotate' 
```

并在控制台运行：

```
bundle update && bundle install 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T08:35:39.070

我知道这是一个老问题，但我有同样的问题，想包括我是如何解决它的。

首先，我确保在迁移中添加了所需的信息：

```
class AddRememberTokenToUsers < ActiveRecord::Migration
  def change
    add_column :users, :remember_token, :string
    add_index  :users, :remember_token
  end
end 
```

然后我只是转储了我的数据库并重新迁移：

```
rake db:drop
rake db:create
rake db:migrate 
```

之后为我工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T00:13:28.870

`users`您的表中没有一个名为 的字段`remember_token`？

# ejbql - 如何在 EJBQL 中将整数转换为字符串

> ID：11278645
> 
> 赞同：3
> 
> 时间：2012-07-01T00:12:48.483
> 
> 标签：ejbql

我有一个带有整数的实体

```
@Entity(name=customer)
public Customer {
    ...
    @Column
    private int number;
    ...
    //getter,setter
} 
```

现在我想在查询中转换这个 Integer 以将它与其他值进行比较。

我试过这个查询：

```
"SELECT c FROM customer c WHERE CAST(c.number AS TEXT) LIKE '1%'" 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T11:07:42.910

这适用于我使用 Hibernate 的一些代码：

```
SELECT c FROM customer c WHERE STR(c.number) LIKE '1%' 
```

一般来说，这就是[Hibernate 文档](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/queryhql.html)（14.10 Expressions）在强制转换时所说的：

> str() 用于将数字或时间值转换为可读字符串
> 
> cast(... as ...)，其中第二个参数是 Hibernate 类型的名称，如果底层数据库支持 ANSI cast() 和 extract()，则 extract(... from ...)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T20:36:12.197

自 EJB3 以来，EJBQL 已经（几乎）被 JPQL 取代。在 EJBQL 中，根据JPQL 中的[http://docs.oracle.com/cd/E11035_01/kodo41/full/html/ejb3_langref.html](http://docs.oracle.com/cd/E11035_01/kodo41/full/html/ejb3_langref.html)，也没有 CAST 实体属性的功能。

所以就像我已经说过的，还有两个选择：

1.  使用本机查询。
2.  向实体添加特殊的转换方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T00:41:44.483

您需要指定从表别名 c 中选择的列，并且由于 EJBQL 不支持强制转换函数，因此将字符串而不是文本传递到查询中。（这有效地允许您的程序在到达 EJBQL 之前进行强制转换。）

下面的示例是在 SQL Server 中，但应该会给您一个想法：

```
 declare @numberText as varchar(50)
 set @numberText = '1'

 SELECT c.CustomerNumber FROM customer c 
 WHERE c.CustomerNumber  LIKE @numbertext + '%' 
```

所以而不是`private int number`使用`private string numberText`.

**注意：**在 OP 确认 EJBQL 不支持 CAST 函数后，我编辑了这个答案。

# iphone - 使用 CIImage 添加纯色边框

> ID：11278647
> 
> 赞同：6
> 
> 时间：2012-07-01T00:12:59.110
> 
> 标签：iphone, objective-c, ios

我正在寻找一种使用 Core Image 为现有图像添加纯色边框的方法。我找到了过滤器列表参考，但没有人可以做到。

帮助 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-23T05:01:32.133

我们需要有 CIImage 范围或要在其中创建实心边框的 CGRect。比，我们可以在指定区域绘制一个形成实线的CIImage，并针对不同的位置重复以上步骤3次，绘制一个完整的实心矩形。以下是一段代码，它将在指定区域上方绘制一条直线。

```
CIImage *overlay1 = [CIImage imageWithColor:[CIColor colorWithRed:255/255.f green:0/255.f blue:0/255.f alpha:1.00f]];
    overlay1 = [overlay1 imageByCroppingToRect:image.extent];
    overlay1 = [overlay1 imageByApplyingFilter:@"CIPerspectiveTransformWithExtent" withInputParameters:@{@"inputExtent":[CIVector vectorWithCGRect:image.extent],@"inputTopLeft":[CIVector vectorWithCGPoint:CGPointMake(topLeft.x - 5, topLeft.y + 5)],@"inputTopRight":[CIVector vectorWithCGPoint:CGPointMake(topRight.x + 5, topRight.y + 5)],@"inputBottomLeft":[CIVector vectorWithCGPoint:CGPointMake(topLeft.x - 5, topLeft.y )],@"inputBottomRight":[CIVector vectorWithCGPoint:CGPointMake(topRight.x + 5, topRight.y ) ]}];
    overlay = [ overlay1 imageByCompositingOverImage:overlay]; 
```

我将宽度保持为 5 个像素。topLeft , topRight.... 是相应位置的 CGPoint。对于一个完整的矩形，您还需要bottomLeft 和bottomRight。

Overlay 是原始的 CIImage 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T00:57:07.680

This isn't exactly what you asked about, but it might be better if you just want to display the image with a border (rather than actually drawing a border onto it)...

You can use `CALayer` to add borders (and rounded corners, shadows, etc.) to any `UIView`...

```
// imgView is an instance of UIImageView, but this works with any UIView
imgView.layer.borderWidth = 2.0f;
imgView.layer.borderColor = [[UIColor blackColor] CGColor]; 
```

You also need to `#import <QuartzCore/QuartzCore.h>` and link to the QuartzCore framework for this to work.

# visual-studio-2010 - MS VS 2010 srand() 没有编译？

> ID：11278652
> 
> 赞同：0
> 
> 时间：2012-07-01T00:14:17.710
> 
> 标签：visual-studio-2010, compiler-errors, srand

我有一段代码（我是学生）理论上“应该”工作，但微软的 Visual Studio 2010 似乎对 srand 有问题，因为它没有像其他保留名称那样突出显示。

如果我从中删除 srand ，`Auto_Complete_Matrix`那么代码将毫无问题地编译。

函数 Auto_Complete_Matrix

错误 2 错误 C2143：错误 de sintaxis：缺少“；” 在“类型”c:\users\jorgee!\desktop\uade\program 之前。1\proyectos\tp3-矩阵\ejercicio 2\main.c 46 1 Ejercicio 2

我已经包含了标准库和时间库。

非常感谢您的帮助。

```
/* 2\.   Realizar una función que determine si una matriz cuadrada de dimensión N 
es simétrica con respecto a su diagonal principal. */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <stdlib.h>

#define FIL 5
#define COL 5

int True_False( char *message );
int Auto_Complete_Matrix( int matrix[ FIL ][ COL ] );
int Manual_Complete_Matrix( int matrix[ FIL ][ COL ] );
void Print_Matrix( int matrix[ FIL ][ COL ] );

int main () {
    int matrix[ FIL ][ COL ];
    if( True_False( "Desea autocompletar la Matriz con números al azar? <Si / No> \n\n" ) ) {
        Auto_Complete_Matrix( matrix );
    }
    else {
        Manual_Complete_Matrix( matrix );
    }
    Print_Matrix( matrix );
    system( "pause" );
}

int True_False( char *message ) {
    char Answer[3];
    fputs( message, stdout );
    fgets( Answer, 3, stdin );
    if ( Answer[0] == 1 ) {
        return 1;
    }
    if ( strncmp( Answer, "Si", 2 ) == 0 || strncmp( Answer, "si", 2 ) ) {
        return 1;
    }
    return 0;
}

int Auto_Complete_Matrix ( int matrix[ FIL ][ COL ] ) {

    srand(time(0));
    int i, j;

    for ( i = 0; i < FIL; i ++ ) {
        for ( j = 0; j < COL; j ++ ) {
            matrix[i][j] = rand() % (100 - 0 + 1) + 0;
        }
    }
    return 0;
}

int Manual_Complete_Matrix( int matrix[ FIL ][ COL ] ) {

    int i, j;

    for ( i = 0; i < FIL; i++ ) {
        for ( j = 0; j < COL; j++ ) {
            while( fscanf( stdin, "%d", matrix[i][j] ) != 1 ) {
                fflush( stdin );
                continue;
            }
        }
    }
}

void Print_Matrix( int matrix[ FIL ][ COL ] ) {
    int i, j;
    for( i = 0; i < FIL; i++) {
        for( j = 0; j < COL; j++ ) {
            printf( "%5d", matrix[i][j] );
        }
        puts("\n");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:18:13.253

在编译为 C（而不是 C++）的文件中，您必须在封闭范围的顶部声明所有变量（即，在这种情况下，周围的花括号）。在这里，您在 'int i, j' 声明语句之前调用了一个函数 (srand)。

# ruby-on-rails - Ruby：用第二个数组中的值替换散列数组的键值对中的值

> ID：11278653
> 
> 赞同：0
> 
> 时间：2012-07-01T00:14:49.270
> 
> 标签：ruby-on-rails, ruby, arrays, ruby-on-rails-3, hash

在 Ruby 中，我有一个哈希数组和一个数组。在我的哈希数组中，我想用我的第二个数组中的值替换其中一个键值对中的值。实现此目的最干净的方法是什么？

示例（我想用我的第二个数组中的值替换“total”的值）：

**哈希数组：**

```
 [{"date":"2012-05-27","total":1},{"date":"2012-05-28","total":9}] 
```

**大批：**

```
 [1, 10] 
```

**所需的哈希数组：**

```
 [{"date":"2012-05-27","total":1},{"date":"2012-05-28","total":10}] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T00:27:54.290

```
array.each_with_index {|e,i| hash_array[i]["total"] = e} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T11:30:18.727

```
hashes = [{date: "2012-05-27", total: 1},{date: "2012-05-28", total: 9}] #unquoted keys
values = [1,10]

hashes.zip(values){|h,v| h[:total] = v}
p hashes #=>[{:date=>"2012-05-27", :total=>1}, {:date=>"2012-05-28", :total=>10}] 
```

# javascript - 这种“ajax 上传器”方法如何绕过同源策略？

> ID：11278658
> 
> 赞同：0
> 
> 时间：2012-07-01T00:16:58.603
> 
> 标签：javascript, same-origin-policy

此页面上的方法：[http](http://www.ajaxf1.com/demo/ajaxupload/) ://www.ajaxf1.com/demo/ajaxupload/使用带有 iframe 目标的表单和返回以原始页面为目标的 JS 函数的页面操作。这是如何运作的？

所以 orginal->target: iframe, action: post page; 然后 iframe 得到一个 JS 函数 that->targets: original。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:20:05.310

您没有使用 ajax，它实际上是在不重新加载页面的情况下发布表单的老技巧。

实际重新加载的是 iframe，然后您可以通过 JS 从中获取响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:21:39.650

iFrame 就像您可以嵌入到其他页面中的页面元素。他们的浏览网址与父页面不同。因此 iframe 的 url 将是您的跨域 url，并且由于 iframe 在同一页面上，您可以访问 iframe 的响应，请参阅这个[http://ajaxpatterns.org/IFrame_Call](http://ajaxpatterns.org/IFrame_Call)

# jquery - 在 wordpress 主题中使用 jQuery

> ID：11278665
> 
> 赞同：0
> 
> 时间：2012-07-01T00:19:18.407
> 
> 标签：jquery, wordpress, jquery-plugins, wordpress-theming

我想在 wordpress 主题中使用 jquery 插件，但无法让它工作。

在functions.php中我有：

```
<?php wp_enqueue_script('jquery'); ?> 
<?php wp_enqueue_script('jquerycountdownpackjs', '/wp-content/themes/mytheme/jquery.countdown.pack.js', array('jquery'),'1.2.6'); ?> 
```

这就是我需要告诉 wordpress 加载 jQuery 然后加载我的插件的全部内容吗？

在 header.php 中，我开始使用 jquery：

```
jQuery(document).ready(function($) { 
```

我还缺少什么？应该显示插件结果的 div 没有显示任何内容。我是否正确加载了 jQuery？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T12:56:11.020

如果它只是 jQuery，你需要，你需要把你的标题。

```
<?php wp_enqueue_script("jquery"); ?>
<?php wp_head(); ?> 
```

**注意**：如果从 wp_head 或 wp_print_scripts 操作调用此函数，则该函数将不起作用，因为在运行这些操作之前需要将文件排入队列。

实际的 jQuery 脚本需要在 document.ready 包装器中或在自调用匿名函数中：

```
jQuery(document).ready(function($) {
// $() will work as an alias for jQuery() inside of this function
}); 
```

或SIAF

```
(function($) {
// $() will work as an alias for jQuery() inside of this function
})(jQuery); 
```

# c# - 如何使用相同的依赖属性设置和获取数据？

> ID：11278670
> 
> 赞同：0
> 
> 时间：2012-07-01T00:20:46.330
> 
> 标签：c#, wpf, xaml, data-binding, dependency-properties

我正在开发一个 WPF 项目。我刚刚创建了一个依赖属性。此依赖属性旨在使`RichTextBox.Selection.Text`属性**可绑定**。

但我不能做的是`RichTextBox.Selection.Text`使用相同的 DP 获取和设置数据。

**如果我只想**从我的`RichTextBox.Selection.Text`using 绑定中获取数据，这是我使用的代码：

```
public class MyRichTextBox: RichTextBox
{

   public static readonly DependencyProperty TextProperty = DependencyProperty.Register(
            "Text",
            typeof(string),
            typeof(MyRichTextBox),
            new PropertyMetadata(
                TextPropertyCallback));

    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    public MyRichTextBox()
    {         
        this.TextChanged += new TextChangedEventHandler(MyRichTextBox_TextChanged);
    }

    void MyRichTextBox_TextChanged(object sender, TextChangedEventArgs e)
    {
        Text = this.Selection.Text;
    } 
```

它工作得很好，但是使用这段代码我无法从我的 ViewModel 类中发送任何数据。

所以，如果我**只想**`RichTextBox.Selection.Text`从我的 ViewModel将数据设置为属性，我使用以下代码：

```
public class MyRichTextBox: RichTextBox
{
    public static readonly DependencyProperty TextProperty = DependencyProperty.Register(
        "Text",
        typeof(string),
        typeof(MyRichTextBox),
        new PropertyMetadata(
            TextPropertyCallback));

    public string Text
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    private static void TextPropertyCallback(DependencyObject controlInstance, DependencyPropertyChangedEventArgs args)
    {
        MyRichTextBox instance = (MyRichTextBox)controlInstance;
        instance.Selection.Text = (String)args.NewValue;
    } 
```

那么，**如果我希望能够使用相同的依赖属性获取和设置数据，我该怎么办？？？**

希望有人可以帮助我，提前tahnk你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:27:03.507

您没有将输入控件的文本绑定到 VM 的属性，而是将附加属性绑定到它，并且在该附加属性的值发生更改时，您设置了输入控件的文本。

换句话说 - 没有监控输入控件文本的更改。

编辑：

你还在做：

```
instance.Selection.Text = (String)args.NewValue; 
```

但是，没有通知更改为`instance.Selection.Text`。

# python - 有没有一种简单的方法可以用状态码 429 中止？

> ID：11278671
> 
> 赞同：1
> 
> 时间：2012-07-01T00:21:13.623
> 
> 标签：python, flask

尝试使用该代码从“before_request”处理程序（在 Flask 中）中止会产生以下错误`LookupError: no exception for 429`：有没有办法解决这个问题？

这是触发错误的代码：

```
key = "ip:{}:account-requests".format(request.remote_addr)

# Determine how many requests have been made in the past day
# by this API.
requests_made = r.get(key) or 0

if requests_made >= max_requests:
    abort(429) #HTTP Too Many Requests 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T00:51:35.080

你可以在 Flask 中这样做

```
if requests_made >= max_requests:
    return '429 error', 429 
```

# python - python mahotas.imread 将 2d 图像读取为 3d

> ID：11278672
> 
> 赞同：2
> 
> 时间：2012-07-01T00:21:14.713
> 
> 标签：python, image-processing, mahotas

我有一张由我的另一个代码保存的图像。图像是一个普通的 JPG 文件。我用imsave保存了它。

现在当我在另一个代码中阅读它时，它似乎是 3d ：S

图片在[这里](https://dl.dropbox.com/u/18284302/normal.jpg)。

和一个简单的代码来阅读它是这样的：

```
import mahotas

img = mahotas.imread('d:/normal.jpg')
print img.shape, img.dtype 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:25:29.843

尝试像这样将 jpg 读取为灰度：

```
mahotas.imread('d:/normal.jpg', as_grey = True) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T10:42:26.340

（这里是 mahotas 的作者）。

Junuxx 的建议是正确的：

```
mahotas.imread('file.jpg', as_grey=True) 
```

这会读取 RGB 文件并通过分量的加权平均值将其转换为灰度（它们的权重不同，但使用试图在感知上更准确的典型系数）。

另一种选择（我更喜欢）是：

```
im = mahotas.imread('file.jpg')
im = im[:,:,0] 
```

我假设所有通道都具有相同的值，并且只使用第一个。

# macos - 可可：如何知道另一个应用程序是否抓住了鼠标

> ID：11278674
> 
> 赞同：1
> 
> 时间：2012-07-01T00:21:34.520
> 
> 标签：macos, cocoa, events, notifications, mouse

我一直在寻找这个，但我无法在任何地方找到答案。:-(

**如何检查其他应用程序是否抓取了鼠标输入以进行独占访问？** 是否有某种通知或事件？

谢谢！

# c - 我的 C 代码中的错误以反转字符串中的单词

> ID：11278675
> 
> 赞同：3
> 
> 时间：2012-07-01T00:21:39.483
> 
> 标签：c, string, algorithm

我正在练习一些编程问题，并尝试编写流行的“字符串中的反向单词”问题。

我试图用 C 编写我自己的代码。我能够部分正确。也就是说，“hello world”变成了“world olleh”。我想知道这里的错误是什么。我想在某个地方我正在创建一个 1 错误。

尽可能地，我想在不使用库函数的情况下做到这一点。我在这里搜索了这个问题并找到了很多解决方案，但我想知道为什么我的解决方案不起作用。

这是代码：

```
#include <stdio.h>
#include <string.h>

void reverse(char*, int);

int main(int argc, char **argv)
{
    char st[]= "hello world";
    int len = strlen(st);
    int i=0,j=0;

    reverse(st,len-1); // Reverse the entire string. hello world => dlrow olleh

    while(st[j]){ //Loop till end of the string
        if ( *(st+j) == ' ' || *(st+j) == '\0' ) { //if you hit a blank space or the end of the string
            reverse(st+i,j-1); // reverse the string starting at position i till position before the blank space i.e j-1
            i=++j; //new i & j are 1 position to the right of old j
        }
        else {
            j++; //if a chacacter is found, move to next position
        }               
    }       

    printf("%s",st);
    return 0;
}

void reverse(char *s, int n)
{
    char *end = s+n; //end is a pointer to an address which is n addresses from the starting address
    char tmp;
    while (end>s)  //perform swap
    {
        tmp = *end;
        *end = *s;
        *s = tmp;
        end--;
        s++;
    }
} 
```

谢谢！

**更新**：根据@Daniel Fischer 的回答，这里是正确的实现：http: [//ideone.com/TYw1k](http://ideone.com/TYw1k)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T00:35:36.387

问题是

```
while(st[j]){ //Loop till end of the string
    if ( *(st+j) == ' ' || *(st+j) == '\0' ) 
```

该`while`条件防止在字符串末尾输入循环，因此最后一个单词不会再次反转。

你可以让它成为一个无限循环，然后添加一个

```
if (st[j] == '\0') break; 
```

在反转之后，或者在 while 循环离开后反转最后一个单词。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T00:40:23.810

你确实有一个错误：调用

```
reverse(st+i,j-1); 
```

应该

```
reverse(st+i,j-i-1); 
```

您的代码传递`j-1`的是从字符串开头到最后一个空格位置的长度；它应该是最后一个单词的长度，因此您需要减去第一个字符的索引（即`i`）。

您也没有颠倒最后一个词（有关详细信息，请参见[其他答案](https://stackoverflow.com/a/11278724/335858)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T01:07:54.277

我认为您想反转字符串中的单词，而不是反转整个字符串然后反转单个单词。因此，首先删除反向，然后应用上面建议的更改。

```
#include <stdio.h>
#include <string.h>

void reverse(char*, int);

int main(int argc, char **argv)
{
  char st[]= "hello world";
  int i=0, j=0;

  while(st[j]){ //Loop till end of the string
    if ( st[j] == ' ') { //if you hit a blank space or the end of the string
      reverse(&st[i], j - i - 1); // reverse the string starting at position i till position before the blank space i.e j-1
      i = ++j; //new i & j are 1 position to the right of old j
    }
    else {
      j++; //if a chacacter is found, move to next position
    }               
  }
  reverse(&st[i], j - i - 1);

  printf("%s\n",st);
  return 0;
}

void reverse(char *s, int n)
{
  char *end = s + n; //end is a pointer to an address which is n addresses from the    starting address
  char tmp;

  while (end > s)  //perform swap
  {
    tmp = *end;
    *end = *s;
    *s = tmp;
    end--;
    s++;
  }
} 
```

当输入字符串是 '\0' 或类似 'Hello world' 时要小心。上面的代码没有处理这种情况。想想吧！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T05:44:46.323

@RBK：您首先取一个字符串，将其反转，然后根据特定单词再次反转它们。我采用了稍微不同的方法来做到这一点。如果需要，我取字符串然后反转，否则我复制相同的单词。

```
int main(int argc, char*argv[])
{
    char *p,st[]= "hello world";
    char buf[12]={0};
    char fstr[12]={0};
    int i=0,j=0,k=0,l=0;

    for(p=st;*p!='\0';p++){

        //Get the Word
        buf[i++] = *p;

        //Parse the Word    
        if(*p == ' ' || *(p+1) == '\0'){

            buf[i]='\0';
            j=i-1;
            i=0;        //reset counter

            if(k){      //reverse word and copy

                while(j>=i){

                    fstr[l++]=buf[j--];

                }               

                k=0;        

            }
            else{       //copy same word

                while(i<=j){

                    fstr[l++]=buf[i++];                     

                }

                i=0;    //reset counter
                k=1;

            }

        }

    }   

    fstr[l]='\0';
    printf("%s\n",fstr);
    return 0;
} 
```

# ruby-on-rails - Windows 上的回形针 - nil:NilClass 的未定义方法“split”

> ID：11278679
> 
> 赞同：0
> 
> 时间：2012-07-01T00:22:10.183
> 
> 标签：ruby-on-rails, ruby, imagemagick, paperclip

当我尝试保存上传的文件时，我得到了 nil:NilClass 的未定义方法`split'

```
@user.avatar=params[:user][:avatar] 
```

这是来自服务器日志的错误：

```
[32mCommand[0m :: identify -format %wx%h "C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn.jpg[0]"
[32mCommand[0m :: identify -format %m "C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn.jpg[0]"
[32mCommand[0m :: identify -format %m "C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn.jpg[0]"
[32mCommand[0m :: convert "C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn.jpg[0]" -resize "300x300>" "C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn20120701-4976-a9j1sh"
[32mCommand[0m :: file -b --mime "C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn20120701-4976-a9j1sh20120701-4976-tm6qoj"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
Completed 500 Internal Server Error in 406ms

NoMethodError (undefined method `split' for nil:NilClass):
  app/controllers/users_controller.rb:94:in `block in update'
  app/controllers/users_controller.rb:93:in `update' 
```

我猜问题在于文件名太长（C:/progs/web/ror_site_1/tmp/Rus220120701-4976-1sky1nn20120701-4976-a9j1sh20120701-4976-tm6qoj）并且无法在 Windows 中读取。如果是这样，如何更改文件名生成规则？

如果不是，那是问题的原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:47:15.330

这是几个最新版本的回形针的问题（[在此处解释](https://github.com/thoughtbot/paperclip/issues/938)）。我也遇到了这个问题，直到我将回形针设置回版本 3.0.4 才再次起作用。

所以只要把它放在你的 Gemfile 中，直到修复发布：

```
gem 'paperclip', '3.0.4' 
```

# jquery - 浮动左div中的相对定位元素

> ID：11278685
> 
> 赞同：0
> 
> 时间：2012-07-01T00:24:06.677
> 
> 标签：jquery, css, offset, css-position

我有以下CSS：

```
.contents{
    width: 70%;
    float: right;
}

.sidebar{
    width: 25%;
    float: right;
}

div.area {
    position: relative;
    border: 1px solid;
}

span.letter {
    position: absolute;
    font-family: mono;
    font-size: 14;
} 
```

和以下html结构：

```
<div class="sidebar">

</div>
<div class="content">
    <button id="button">>>></button>
    <div id="area">
        <span class="letter"></span>
        <span class="letter"></span>
        <span class="letter"></span>
        ...
    </div>
</div> 
```

但是，稍后使用 jquery.animate({left: ?px, top: ?px}) 函数定位的字母会显示在侧边栏中。

我应该提到，我最初在他们自己的页面上有按钮和 area-div，我没有遇到问题。

如何在区域 div 中找回字母？

**编辑：**这是一个 jsfiddle 版本：http: [//jsfiddle.net/herrturtur/mPBgg/](http://jsfiddle.net/herrturtur/mPBgg/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T02:05:38.097

[**我想我设法制作了你想要的东西。**](http://jsfiddle.net/N9KU3/)

布赖恩是对的。这些字母出现在那里是因为您将它们放在 javascript 中的绝对定位中，并且您无法在不弄乱 JS 的情况下修复它。您之前通过 JQuery 的 .offset 绝对定位了该字母，但是完全删除该定位并让它们去往常使用的位置似乎要简单得多，它就在彼此*之上*`position: block`，所以这就是我所做的：

CSS：

```
div#area {   //<--- you had a '.' instead of '#' here. Irrelevant, but I thought I'd mention it
    position: relative;
    border: 1px solid;
}

span.letter {
    display: block;   //<--- added this
    font-family: mono;
    font-size: 14;
} 
```

JS：

```
/*
 * Draws one letter to the screen at the specified position.
 */
function createLetter(letter){    //removed extraneous parameter
    var letter = $('<span class="letter">' + letter + '</span>');
    $("#area").append(letter);
    //  letter.offset(position);  Commented this out to leave letters where they are
    return letter;
} 
```

由于我删除了方法的`position`参数，因此`createLetter`我还更新了在方法中调用它的一行代码`createWord`。您似乎在传递一个名为`position`很多的参数，如果您应用我建议的更改，我相信您将能够将其从多种方法中提取出来，以使您的代码更加简洁。

如果您需要它们再次水平移动，您可能只需删除`position: block`with JS 并添加一些填充来调整它。正如我所说，您的问题似乎更适合正常定位，我认为这是要走的路。

您可能还注意到有一个以前没有的额外 J。之前实际上有 2 个 J，只是完美地堆叠在一起，因此您看不到它们，但是对正常文档流的这种更改使第一个 J 重新出现。如果您需要帮助摆脱它，我可以再次查看您的代码，但您可能应该在另一个问题中这样做，因为到目前为止它与您在这个问题中的原始问题相去甚远。:D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:52:34.027

I THINK that the problem is that the CSS for span.letter has a position absolute, which positions it against the whole page, and not the local block.

I modified span.letter to be:

```
span.letter {
    font-family: mono;
    display: block;
} 
```

This positioned them in the area block, which is what I think you're looking for.

# c# - 无法创建表 SQLite Windows 8

> ID：11278692
> 
> 赞同：0
> 
> 时间：2012-07-01T00:26:03.757
> 
> 标签：c#, sqlite, windows-8

我无法使用 SQLite Metro 和 Windows 8 创建表“IF NOT EXISTS”。如果我将“db”复制到 application.local 文件夹，我可以添加、编辑删除记录。它将创建数据库，但没有创建表。我用外部工具检查了我的 DDL，它看起来是正确的。
下面是我的代码：

```
private void InitData()
    {
        ListBox1.Items.Clear();

        Database db = new Database(Path.Combine(Windows.Storage.ApplicationData.Current.LocalFolder.Path, "bppro.db"));

        Statement stm;
        stm = db.PrepareStatement("CREATE TABLE IF NOT EXISTS vitals (_id integer primary key autoincrement, creationdate text,weight text,pulse text,sys text,dia text");
        stm.Execute();
        stm.Dispose();

        string temp = System.DateTime.Now.Ticks.ToString();

        byte[] binaryData = new byte[100];
        stm = db.PrepareStatement("INSERT INTO vitals (creationdate,weight,pulse) VALUES (?,?,?)");
        stm.BindParamText(1, System.DateTime.Now.ToString());
        stm.BindParamInt(2, 35);
        stm.BindParamInt(3, 60);
        stm.Execute();
        stm.Dispose();

        long insertedRowId = db.LastInsertRowId;

        stm = db.PrepareStatement("SELECT * from vitals");
        while (stm.GetNextRow())
        {
            string createdate=stm.GetTextAt(1);
            string weight = stm.GetTextAt(2);
            string pulse = stm.GetTextAt(3);
            ListBox1.Items.Add(createdate.ToString()+"  "+weight.ToString()+"  "+pulse);
        }
        stm.Dispose();
   } 
```

谢谢，任何帮助或指针表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:42:40.230

这是 Windows 应用商店应用程序吗？如果是这样，您需要使用 SQLite 的 WinRT 版本，因为文件 IO API 已更改。

在此处查看我对类似问题的回答：[https ://stackoverflow.com/a/14469080/68230](https://stackoverflow.com/a/14469080/68230)

# c - Win32 API - 试图读取文件，它被截断 - 为什么？

> ID：11278694
> 
> 赞同：3
> 
> 时间：2012-07-01T00:26:33.447
> 
> 标签：c, winapi, executable, readfile

我正在尝试读取文件，然后以 ASCII 或 HEX 格式将文件显示到 hEdit 中。最终我将对文件信息运行其他计算，但现在我只想看到这一切。

目前代码显示第一位 - “MZ” - 但就是这样。不知何故，我不小心截断了 pszFileText 变量，我希望能够在我的窗口中查看整个可执行文件。

```
BOOL ReadInEXEFile(HWND hEdit, LPCTSTR pszFileName)
{
HANDLE hFile;
BOOL bSuccess = FALSE;

hFile = CreateFile(pszFileName, GENERIC_READ, FILE_SHARE_READ, NULL,
    OPEN_EXISTING, 0, NULL);
if(hFile != INVALID_HANDLE_VALUE)
{
    DWORD dwFileSize;

    dwFileSize = GetFileSize(hFile, NULL);
    if(dwFileSize != 0xFFFFFFFF)
    {
        LPSTR pszFileText;

        pszFileText = GlobalAlloc(GPTR, dwFileSize + 1);
        if(pszFileText != NULL)
        {
            DWORD dwRead;
            if(ReadFile(hFile, pszFileText, dwFileSize, &dwRead, NULL))
            {
                pszFileText[dwFileSize] = 0; // Add null terminator
                if(SetWindowText(hEdit, pszFileText))
                {
                    bSuccess = TRUE; // It worked!
                }
            }
            GlobalFree(pszFileText);
        }
    }
    CloseHandle(hFile);
}
return bSuccess; 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T00:42:41.300

EXE 文件是二进制文件，但您试图按原样显示原始二进制数据，这是行不通的。您在正确的轨道上认为您需要在显示之前将二进制数据编码为十六进制。二进制数据不可显示，但十六进制数据可显示。

试试这个：

```
static const TCHAR Hex[] = TEXT("0123456789ABCDEF");

BOOL ReadInEXEFile(HWND hEdit, LPCTSTR pszFileName) 
{ 
    BOOL bSuccess = FALSE; 

    HANDLE hFile = CreateFile(pszFileName, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL); 
    if (hFile != INVALID_HANDLE_VALUE) 
    { 
        DWORD dwFileSize = GetFileSize(hFile, NULL); 
        if (dwFileSize != INVALID_FILE_SIZE)
        { 
            LPTSTR pszFileText = (LPTSTR) LocalAlloc(LMEM_FIXED, ((dwFileSize * 3) + 1) * sizeof(TCHAR)); 
            if (pszFileText != NULL)
            {
                BYTE buffer[1024];
                DWORD dwOffset = 0;
                DWORD dwRead; 

                for (DWORD dwFilePos = 0; dwFilePos < dwFileSize; dwFilePos += dwRead)
                {
                    if (!ReadFile(hFile, buffer, sizeof(buffer), &dwRead, NULL)) 
                    {
                        CloseHandle(hFile);
                        return FALSE;
                    }

                    if (dwRead == 0)
                        break;

                    for (DWORD idx = 0; idx < dwRead; ++idx)
                    {
                        pszFileText[dwOffset++] = Hex[(buffer[idx] & 0xF0) >> 4];
                        pszFileText[dwOffset++] = Hex[buffer[idx] & 0x0F];
                        pszFileText[dwOffset++] = TEXT(' ');
                    }
                }

                pszFileText[dwOffset] = 0; // Add null terminator 

                bSuccess = SetWindowText(hEdit, pszFileText);
                LocalFree(pszFileText);
            } 
        } 

        CloseHandle(hFile); 
    } 

    return bSuccess; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:33:50.240

两个原因：

1) 如果您正在读取可执行文件，则第三个字节可能为零，这可能会终止字符串，即使您将长度传递给 SetWindowText。

2）这条线是错误的：`pszFileText[dwFileSize + 1] = 0;`。应该是`pszFileText[dwFileSize] = 0;`。你在某个地方写错了一个零字节，不知道那可能在做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T00:30:29.577

您显示它的方式可能取决于数据是以 NUL 结尾的字符串，并且二进制数据中嵌入了 NUL，因此您只显示第一个 NUL 之前的数据。

您需要自己打印它并使用数据的长度来知道要打印多少，而不是依赖于它是一个以 NUL 结尾的 C 字符串。

# php - ajax请求隐藏字段

> ID：11278703
> 
> 赞同：0
> 
> 时间：2012-07-01T00:28:28.840
> 
> 标签：php, jquery

我正在开发一个网站（仅供娱乐和学习使用 jquery 编程），我想知道这有什么问题：

```
$(window).unload(function(){
 var myid = $('input#v1').attr('value');   // hidden
 var playauth = $('input#v2').attr('value');   // hidden
 var srvid = $('input#v3').attr('value');      // hidden
 var result = 'myid='+ myid +'&auth='+ playauth +'&srvid='+ srvid;
    $.ajax({
            type: "GET",
            data: result,
            url: "closing.php",
            complete: function(data) {
            alert(data.responseText);
            }
           });
}); 
```

我正在尝试更新数据库表。当我关闭窗口时，没有任何反应。使用此功能的先前版本：

```
window.onunload = function () {
  var xhReq = new XMLHttpRequest();
  var n = document.getElementById("v1").InnerHTML;
  var o = document.getElementById("v2").InnerHTML;
  var p = document.getElementById("v3").InnerHTML;
  xhReq.open("GET", ("closing.php?myid=" + n + "&auth=" + o + "&srvid=" + p) , false);
  xhReq.send(null);
  var serverResponse = xhReq.responseText;
  alert(serverResponse); 
}; 
```

.. 我看到了响应警报，但 GET 值是“未定义”。....可能是因为输入的类型是隐藏的..？这是我的表格......也许我错过了什么？？我真的是 jquery/ajax 的新手 .. 请帮忙！！

```
<form method="get">
<input id="v1" type="hidden" name="val1" class="aget" value="<?php echo $_GET['myid']; ?>" />
<input id="v2" type="hidden" name="val2" class="bget" value="<?php echo $_GET['playauth']; ?>" />
<input id="v3" type="hidden" name="val3" class="cget" value="<?php echo $_SESSION['srvid']; ?>" />
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:31:15.060

改变

```
 var myid = $('input#v1').attr('value');   // hidden
 var playauth = $('input#v2').attr('value');   // hidden
 var srvid = $('input#v3').attr('value');      // hidden 
```

至

```
 var myid = $('input#v1').val();   // hidden
 var playauth = $('input#v2').val();   // hidden
 var srvid = $('input#v3').val();      // hidden 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:31:56.907

你必须使用

`.val();`代替`.attr('value');`

# c# - Windows 8 中的壁纸注册表项在哪里？

> ID：11278707
> 
> 赞同：7
> 
> 时间：2012-07-01T00:29:39.063
> 
> 标签：c#, .net

我正在开发一个需要获取当前用户的壁纸路径的工具。

在 Windows 7 上，我可以通过阅读

`HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Desktop\General\WallpaperSource`.

在我的 Windows 8 安装中，该密钥始终具有值

`C:\Users\Peter\AppData\Roaming\Microsoft\Windows Photo Viewer\Windows Photo Viewer Wallpaper.jpg`

这甚至不是当前设置的壁纸。

还有其他我可以依赖的密钥吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-01T15:10:29.680

最好使用 SPI_SETDESKWALLPAPER 选项调用[SystemParametersInfo来设置桌面墙纸。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724947%28v=vs.85%29.aspx#Desktop)据我所知，您使用的注册表项未记录在案，因此可以随时更改而不会发出警告。

有关如何使用 SPI_SETDESKWALLPAPER 调用 SystemParametersInfo 的示例，请参阅[此堆栈溢出问题。](https://stackoverflow.com/questions/4750372/can-i-change-my-windows-desktop-wallpaper-programmatically-in-java-groovy)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-02T08:08:37.833

很大程度上基于[pinvoke.net](http://pinvoke.net/default.aspx/user32/SystemParametersInfo.html)上可用的代码，检索当前用户桌面壁纸的正确方法是使用该[`SystemParametersInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724947%28v=vs.85%29.aspx#Desktop)函数。执行此操作的示例如下：

```
using System;
using System.Runtime.InteropServices;

namespace WallpaperPathRetrieval
{
    class Program
    {
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern Int32 SystemParametersInfo(UInt32 action, 
            UInt32 uParam, string vParam, UInt32 winIni);
        private static readonly UInt32 SPI_GETDESKWALLPAPER = 0x73;
        private static uint MAX_PATH = 260;

        static void Main(string[] args)
        {
            string wallpaper = new string('\0', (int)MAX_PATH);
            SystemParametersInfo(SPI_GETDESKWALLPAPER, MAX_PATH, wallpaper, 0);

            wallpaper = wallpaper.Substring(0, wallpaper.IndexOf('\0'));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-01T01:14:55.653

您提到的密钥不是正确的。听起来你已经从 Internet Explorer 中放置了一个图像作为桌面背景，并且打开了那个键来注册它。

**获取桌面背景位置的正确键为：** ^(Confirmed on: XP, CE, Vista, 7, 8)

```
HKEY_CURRENT_USER\Control Panel\Desktop\Wallpaper 
```

**细节：**

*   主键：HKEY_CURRENT_USER
*   子键：控制面板\桌面
*   值名称：WallPaper
*   值类型：REG_SZ
*   值数据：*用作桌面背景的图像的完整路径*

* * *

此外，`HKEY_CURRENT_USER\Control Panel\Desktop\`您还会在下面找到其他与壁纸相关的选项以应用不同的样式：中心、平铺和拉伸。

```
HKEY_CURRENT_USER\Control Panel\Desktop\WallpaperStyle
HKEY_CURRENT_USER\Control Panel\Desktop\TileWallpaper 
```

**为了应用样式，请使用以下指南：**

1.  中心

    ```
    WallpaperStyle = 0
    TileWallpaper = 0 
    ```

2.  瓦

    ```
    WallpaperStyle = 0
    TileWallpaper = 1 
    ```

3.  拉紧

    ```
    WallpaperStyle = 2
    TileWallpaper = 0 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-25T06:53:55.707

它存储在名为 TranscodedImageCache (REG_BINARY) 的值中。这是一个读取/转换为纯文本并输出值的 VBScript。

[如何在 Windows 8 中确定当前壁纸文件名和路径 - Winhelponline 博客](http://www.winhelponline.com/blog/find-current-wallpaper-file-path-windows-8/)

# terminal - 主题卸妆脚本

> ID：11278710
> 
> 赞同：0
> 
> 时间：2012-07-01T00:31:08.273
> 
> 标签：terminal

这是我的脚本。其权限设置为 755。

```
#!bin/bash

echo "Deleting the themes you don't want!"

sleep 2

echo  "                 by D3@TH from Deaths Repo"

##### root test #####
# won't go any farther unless you're uid=0
[ `id -u` != 0 ] && exec echo "Oops, you need to be root to run this script"

echo ".....removing WinterBoard Default Themes!"

echo "…..now deleting themes!"

cd /Library/Themes/
rm -rf Black Navigation Bars.theme Dim Icons.theme Dim Wallpaper.theme No Docked Icon Labels.theme No Undocked Icon Labels.theme Solid Status Bar.theme Transparent Dock.theme User Lock Background.theme User Wallpaper.theme White Icon Labels.theme
sleep 2

echo ".....moving themes to var"

mv /Library/Themes /private/var/ && ln -s /private/var/WinterBoard /Library/Themes
echo "Finished deleting the themes you didn't want feel free to delete me I don't mind."

sleep 3

apt-get remove net.death.themeremover

killall WinterBoard

exit 0 
```

每次我尝试在我的 iPhone 或 iPod 上运行它时，我都会得到：

> -sh：/usr/bin/winterboard：bin/bash：错误的解释器：没有这样的文件或目录

有没有办法解决这个问题，我想让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:33:21.427

第一行应为：

```
#！/ bin/bash
```

注意前面的正斜杠，这将使它相对于文件系统的根目录而不是当前目录。

# cuda - CUDA 共享内存寻址

> ID：11278712
> 
> 赞同：0
> 
> 时间：2012-07-01T00:31:36.877
> 
> 标签：cuda, gpu, shared-memory, addressing

我知道当我在内核中声明一个共享内存数组时，所有线程都声明了相同大小的数组。像这样的代码

```
__shared__ int s[5]; 
```

将在每个线程中创建一个 20 字节的数组。我理解解决共享内存的方式是它在所有线程中都是通用的。所以，如果我按如下方式处理下标 10

```
s[10] = 1900; 
```

它是所有线程中完全相同的内存位置。不同的线程不会为下标10访问不同的共享内存地址。这是正确的吗？编译器当然会抛出下标超出范围的警告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T01:22:48.143

实际上，它将为**每个块**创建一个 20 字节的数组，而不是每个线程。

块内的每个线程都可以访问这 20 个字节。因此，如果您需要每个线程有 N 个字节，并且需要一个具有 M 个线程的块，则需要为每个块创建一个 N*M 缓冲区。

在您的情况下，如果有 128 个线程，您将拥有

```
__shared__ int array[5*128]; 
```

并且 array[10] 将是块内任何线程的有效地址。

# php - 如何在不下载整个目录路径的情况下下载 zip 文件？(PHP)

> ID：11278715
> 
> 赞同：0
> 
> 时间：2012-07-01T00:32:16.050
> 
> 标签：php, download, zip, document-root

我有以下 zip 下载功能：

```
$file='myStuff.zip';
function downloadZip($file){
  $file=$_SERVER["DOCUMENT_ROOT"].'/uploads/'.$file;
   if (headers_sent()) {
    echo 'HTTP header already sent';
   } 
       else {
        if (!is_file($file)) {
            header($_SERVER['SERVER_PROTOCOL'].' 404 Not Found');
            echo 'File not found';
        } else if (!is_readable($file)) {
            header($_SERVER['SERVER_PROTOCOL'].' 403 Forbidden');
            echo 'File not readable';
        } else {
            header($_SERVER['SERVER_PROTOCOL'].' 200 OK');
            header("Content-Type: application/zip");
            header("Content-Transfer-Encoding: Binary");
            header("Content-Length: ".filesize($file));
            header("Content-Disposition: attachment; filename=\"".basename($file)."\"");
            readfile($file);
            exit;
        }
    }
} 
```

问题是当我调用这个函数时，我最终不仅下载了 myStuff.zip，还下载了包含所有文件夹的完整目录路径。我在使用 XAMPP 的 Mac 上，所以这意味着我得到以下信息：

```
/applications/xampp/htdocs/uploads/myStuff.zip 
```

这意味着我得到一个名为应用程序的文件夹，其中包含所有子文件夹，然后在所有子文件夹中我得到 myStuff.zip。

我怎样才能在`myStuff.zip`没有目录的情况下下载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:37:33.687

试试这个。

```
readfile(basename($file)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:27:25.663

好的，我使用此链接中的代码回答了我自己的问题：[http ://www.travisberry.com/2010/09/use-php-to-zip-folders-for-download/](http://www.travisberry.com/2010/09/use-php-to-zip-folders-for-download/)

这是PHP：

```
<?php
//Get the directory to zip
$filename_no_ext= $_GET['directtozip'];

// we deliver a zip file
header("Content-Type: archive/zip");

// filename for the browser to save the zip file
header("Content-Disposition: attachment; filename=$filename_no_ext".".zip");

// get a tmp name for the .zip
$tmp_zip = tempnam ("tmp", "tempname") . ".zip";

//change directory so the zip file doesnt have a tree structure in it.
chdir('user_uploads/'.$_GET['directtozip']);

// zip the stuff (dir and all in there) into the tmp_zip file
exec('zip '.$tmp_zip.' *');

// calc the length of the zip. it is needed for the progress bar of the browser
$filesize = filesize($tmp_zip);
header("Content-Length: $filesize");

// deliver the zip file
$fp = fopen("$tmp_zip","r");
echo fpassthru($fp);

// clean up the tmp zip file
unlink($tmp_zip);
?> 
```

和 HTML：

```
<a href="zip_folders.php?directtozip=THE USERS DIRECTORY">Download All As Zip</a> 
```

摆脱目录结构的关键步骤似乎是`chdir()`. 还值得注意的是，此答​​案中的脚本会即时生成 zip 文件，而不是像我在问题中所做的那样尝试检索以前压缩的文件。

# regex - 如何查找名称列表中的任何名称是否出现在带有 ColdFusion 的段落中？

> ID：11278716
> 
> 赞同：4
> 
> 时间：2012-07-01T00:32:30.773
> 
> 标签：regex, parsing, coldfusion

假设我有一个来自数据库的员工姓名列表（数千个，在不久的将来可能会有数万个）。为了使问题更简单，假设每个名字/姓氏组合都是唯一的（一个很大的 if，但是一个切线）。

我还有一个与业务相关的新闻内容的 RSS 流（同样，每天可能有数百个项目）。

我想做的是检测员工姓名是否出现在几段新闻项目中，如果是，则用它谈论的人“标记”该项目。

一条新闻中可能有不止一个员工的名字，因此在第一次正面匹配后打破循环是不可能的。

我当然可以暴力破解：对于每个新闻项目，循环遍历每个员工姓名，如果正则表达式返回匹配项，请记下它。

ColdFusion 中是否有更简单的方法，还是我应该继续使用嵌套循环？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T00:41:00.883

只是把它扔在那里作为你*可以*做的事情......

听起来您几乎一致认为每个职位的员工姓名要比字数多得多。以下是我可能会如何处理它：

拥有一个始终运行的 CF 应用程序，该应用程序将拉入提要和 onAppStart

1.  从您的数据库中获取所有员工
2.  创建一个应用范围的查找结构，其中名字作为键，姓氏结构作为值（如果需要，您还可以将中间名同级添加到具有第 3 层的姓氏）。

因此，查找中的一个键可能是“Vanessa”，其结构具有 2 个键（“Johnson”和“Forta”）作为其值。

然后，您解析的每篇文章，只需使用空格作为分隔符的 listToArray 并循环遍历数组，并对每个标记执行简单的 structKeyExists 。对于匹配项，检查数组中的下一项作为姓氏。

我*猜*这将比进行许多搜索具有更高的处理性能，并且几乎不需要时间进行编码，并且您可以非常简单地输入任何未来的资源（您的检查器接受一个参数，地球上的任何文本）。

有兴趣了解您走的路线以及您的实验是否揭示了有关 CF 性能的任何新信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:01:00.747

马修，你的要求很高，挑战/解决方案确实有多个部分。但是，仅将值列表与给定的文本集进行比较以查看其中是否出现其中一个，您会发现没有人可以使用 CF 函数。因此，我在 cflib 中创建了一个新的 findList：

[http://cflib.org/index.cfm?event=page.udfbyid&udfid=1908](http://cflib.org/index.cfm?event=page.udfbyid&udfid=1908)

它不是完美的，也不是最理想的，但它可能是有用的第一步，或者你，或者给你一些想法。也就是说，它适合我的需要（确定给定的博客评论是否引用了任何列入黑名单的词）。我显示它比较 URL 列表，但它可以是任何单词。希望这有点帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T02:23:49.693

另一个值得探索的选择是利用现在随 CF 一起提供的 Solr 引擎。它将为您完成字符串搜索繁重的工作，您可能可以专注于动态地保持您的集合是最新的并随着新的提要项的出现而优化。

祝你好运！

# css - 一列有两个 div，另一列有一个

> ID：11278723
> 
> 赞同：0
> 
> 时间：2012-07-01T00:34:15.253
> 
> 标签：css, html

我会在css中放什么让一个div在另一个div之上（两个正方形都是10x10）并有另一个div是10x20的列？

让我换个说法，让它更简单一点，我想要一个 20x20 的大正方形。在该形状的左半边，它需要两个 10x10 的正方形，一个在另一个上面。在右侧，我需要一个 10x20 的 div。

请帮忙上课

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:40:59.587

您可以使用 css 的[`position`](https://developer.mozilla.org/en/CSS/position)属性来绝对定位元素以设置顶部和左侧坐标。您还需要使用`height`和`width`属性来调整框的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:39:50.457

也许是这样的？

```
<div id="bigBox">
     <div class="leftBox"></div>
     <div class="leftBox"></div>
     <div id="rightbox">
</div>

<style>
    #bigBox { position: relative; width: 20px; height: 20px;}
    .leftBox {position: absolute; left: 0; height: 10px; width: 10px; }
    .rightBox {position: absolute; right: 0; width: 10px; height: 20px;}
</style> 
```

# iphone - 区分应用程序启动和应用程序唤醒

> ID：11278725
> 
> 赞同：2
> 
> 时间：2012-07-01T00:35:54.673
> 
> 标签：iphone, objective-c, ios, nsnotifications, uiapplication

我需要能够区分应用程序 didFinishLaunching 和应用程序进入后台并加载回前台。我注意到，如果我注册 UIApplicationDidBecomeActiveNotification，它在两个实例中都会被调用。我如何区分两者？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T00:44:24.107

使用`didFinishLaunchingWithOptions`vs`applicationWillEnterForeground`来区分应用是冷启动还是从后台返回。

我尝试在我的一个应用程序中收听 UINotification，但通知传递得太晚了，所以我采取了直接收听这些方法调用的方法。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // only call when app is freshly launched
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    // Only called when app is returning from background
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:44:34.873

> 我需要能够区分应用程序 didFinishLaunching

```
UIApplicationDidFinishLaunchingNotification 
```

> 应用进入后台

```
UIApplicationDidEnterBackgroundNotification 
```

> 被加载回前台

```
UIApplicationWillEnterForegroundNotification 
```

# python - 如何在 uwsgi 中使用 nginx UWSGI_SETENV 获取 env_vars

> ID：11278726
> 
> 赞同：3
> 
> 时间：2012-07-01T00:36:02.990
> 
> 标签：python, nginx, uwsgi

我的 nginx 配置：

```
location / {
    include uwsgi_params;
    uwsgi_param UWSGI_PYHOME /usr;
    uwsgi_pass unix:/var/run/uwsgi-python/uwsgi/socket;
    uwsgi_param UWSGI_CHDIR /var/www/my_site;
    uwsgi_param UWSGI_SCRIPT my_site:app;
    uwsgi_param SERVER_NAME my_site;
    uwsgi_param UWSGI_SETENV DEPLOY_VERSION=Development;
} 
```

我的 uwsgi 段：

```
/usr/local/bin/uwsgi --master --processes 2 --logdate --chmod-socket=666 --uid www --gid www --limit-as 512 --harakiri 60 --max-requests 1000 --no-orphans —-reload-os-env --daemonize /var/log/uwsgi-python/uwsgi.log --pidfile /var/run/uwsgi-python/uwsgi/pid --socket /var/run/uwsgi-python/uwsgi/socket --xmlconfig /etc/uwsgi-python/apps-enabled/uwsgi.xml 
```

uwsgi xml:

```
<uwsgi>
<master/>
<vhost/>
<memory-report/>
<no-site/>
</uwsgi> 
```

在我的烧瓶应用中

```
print os.environ.get('DEPLOY_VERSION', 'NONE')  #pring NONE 
```

我怎样才能得到 env_vars？

也许我无法在 <vhost/><no-site/> 模式下通过 UWSGI_SETENV 获取 env_vars 设置？

顺便说一句：您如何在一台没有虚拟环境的机器上部署应用程序的多版本（开发/测试版/发布）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T12:14:50.727

代替：

> uwsgi_param UWSGI_SETENV DEPLOY_VERSION=开发；

您可以将其设置为 nginx 中的每个请求变量：`uwsgi_param DEPLOY_VERSION 'Development';`

然后在 Flask 中，通过 request.environ 访问变量：`request.environ['DEPLOY_VERSION']`

（我遇到了类似的问题，并在 uwsgi 邮件列表中指出了上述解决方案）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-14T14:35:30.673

我在为 django Mezzanine CMS 部署定义环境配置时遇到了类似的问题。

由于 DEPLOY_VERSION 似乎针对的是底层应用程序而不是 uWSGI 服务，因此我认为将其放置在 uWSGI 配置文件而不是 Nginx 配置文件的正确位置。

尝试将 .xml 文件更改为：

```
<uwsgi>
<master/>
<vhost/>
<memory-report/>
<env>DEPLOY_VERSION=Development</env> <!-- this -->
<no-site/>
</uwsgi> 
```

# linux - 用 sed 将模式替换到文件末尾

> ID：11278729
> 
> 赞同：4
> 
> 时间：2012-07-01T00:37:06.323
> 
> 标签：linux, unix, sed

使用 sed，如果文件中的一行上有空格字符，我需要打印带有空格字符的输出以及删除后的任何内容。代码示例：

```
sed "s/"something here I think"//g' file 
```

所以，假设一个文件在一行上说：

```
 Chuck Norris is the man 
```

我只需要它打印：

```
 Chuck 
```

多行也适用：

```
Chuck Norris is the man
So is Arnold 
```

替换：

```
Chuck
So 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:41:56.353

这应该为你做：

```
sed 's/ .*//g'  file 
```

要从行首删除到第一个空格，请使用以下命令：

```
sed 's/^[^ ]* //g' 
```

# c# - 如何使用 linq to sql 概念知道在 wpf 中更新、删除或插入了哪些记录

> ID：11278732
> 
> 赞同：1
> 
> 时间：2012-07-01T00:38:55.793
> 
> 标签：c#, wpf, linq-to-sql

```
 MydatabaseDataContext MyDB = new MydatabaseDataContext();

 Employee MyEmp = new Employee();
 MyEmp.EmpID = 5039;
 MyEmp.EmpName = "XXX";
 MyDB.Employees.InsertOnSubmit(MyEmp);
 MyDB.SubmitChanges();

 IQueryable<Employee> _DeleteQuery = from dq in MyDB.Employees where dq.EmpID == 5039 select dq;
 foreach (Employee delete in _DeleteQuery)
 {
      MyDB.Employees.DeleteOnSubmit(delete);
 }
 MyDB.SubmitChanges();

 IQueryable<Employee> _UpdateQuery = from uq in MyDB.Employees where uq.EmpID == 5039 select uq;

 foreach (Employee Update in _UpdateQuery)
 {
     Update.EmpName = "yyy";
 }
 MyDB.SubmitChanges(); 
```

使用上面的代码，我可以插入、删除和更新记录。如果插入、删除和更新成功完成，我必须显示一些消息，如“插入、删除和更新成功完成”。

在 ADO.NET 中它会返回一些 int 值（1）。但我不知道如何在 linq to sql 概念中获得这样的值。

如果我得到那个值，我可以显示一些上面提到的消息。那我该怎么办

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T08:55:57.427

看看[DataContext.GetChangeSet 方法](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.getchangeset.aspx)。`ChangeSet.ToString()`会给你一条消息，比如

> {插入：x，删除：x，更新：x}

您也可以直接访问[属性](http://msdn.microsoft.com/en-us/library/system.data.linq.changeset_properties)

```
int itemsToAddBeforeSubmitChanges = MyDB.GetChangeSet().Inserts.Count;
MyDB.SubmitChanges();
int itemsToAddAfterSubmitChanges = MyDB.GetChangeSet().Inserts.Count; 
```

# haskell - 如果在本地编译 Haskell，EC2 Ubuntu 12.04 会有所不同吗？

> ID：11278733
> 
> 赞同：7
> 
> 时间：2012-07-01T00:39:08.057
> 
> 标签：haskell, amazon-ec2

所以我想在本地编译一个Haskell程序，然后上传到我的EC2 Ubuntu 12.04（免费试用）实例。

我的问题是，如果我在官方 Ubuntu 12.04 发行版（比如在 virtualbox 中）编译我的 haskell 程序，它会在 EC2 上运行吗？还是我需要与亚马逊运行的完全相同版本的 Ubuntu？它必须具有完全相同的更新集等吗？

PS 如果是 - 我在哪里可以获得亚马逊版本的 Ubuntu？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T04:49:40.240

我定期这样做，它应该工作得很好。只要确保您使用的是相同的架构（32 位或 64 位）。

您可以在以下位置获取不同 Ubuntu AMI 的列表：

[https://help.ubuntu.com/community/EC2StartersGuide](https://help.ubuntu.com/community/EC2StartersGuide)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T19:07:49.973

如果您使用来自[https://cloud-images.ubuntu.com/releases/](https://cloud-images.ubuntu.com/releases/)的官方 Ubuntu AMI ，则您拥有与官方 Ubuntu 发行版完全相同的二进制文件（只要架构相同：32 位或 64 -少量）。唯一的区别应该是默认安装了哪些软件包（因此您可能需要安装一些额外的软件包）。只要两者都保持更新，它们也将具有完全相同的更新集。

即使您使用的是其他人创建的 AMI，它也应该是相同的；我相信大多数 Ubuntu AMI 都是通过安装官方 Ubuntu 发行版来创建的。

# jsp - 从 JSP 设置 HTTP 响应标头（内容类型）

> ID：11278736
> 
> 赞同：1
> 
> 时间：2012-07-01T00:39:25.637
> 
> 标签：jsp, http-headers

这应该是世界上最简单的事情，但我从来没有尝试过这样做。我需要（嗯，我*想*）设置来自 JSP 的 HTTP 响应的 Content-Type。我已经用谷歌搜索了，但是从大量无用的废话中找到有价值的 JSP 信息是一件很痛苦的事情。

我知道我可以通过页面上下文中的响应对象以及从无数其他地方获得响应，但是是否有一些“标准”JSP 非脚本方式来设置标题？

现在我可能只是编写一个 EL 函数作为 hack，但我更愿意以正确的方式来做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:44:39.657

您可以使用`<%@page contentType="text/html" %>`

# c - const 字符串加布尔值在 C 中复数

> ID：11278737
> 
> 赞同：6
> 
> 时间：2012-07-01T00:39:46.213
> 
> 标签：c, string, boolean, plural

我很惊讶字符串加布尔值具有类似的三元运算效果：

```
int apple = 2;                                                                      
printf("apple%s\n", "s" + (apple <= 1)); 
```

如果`apple <= 1`，它将打印苹果。为什么这行得通？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-01T00:42:41.887

因为条件计算结果为 0 或 1，并且字符串`"s"`在 0 终止符之前正好包含一个字符。因此，`"s" + bool`将评估`"s"`if的地址`bool`为 false，以及后面的一个字符，如果为 true，则评估 0 终止符的地址。

这是一个很酷的 hack，但永远不要认真使用这样的代码。

# python - 如何在 Python 中使用 open 函数创建文件？

> ID：11278738
> 
> 赞同：4
> 
> 时间：2012-07-01T00:39:48.103
> 
> 标签：python, linux, file

在 Linux 环境中，我想创建一个文件并将文本写入其中：

```
HTMLFILE: "$MYUSER/OUTPUT/myfolder/mytext.html"
f = open(HTMLFILE, 'w')

IOError: [Errno 2] No such file or directory: "$MYUSER/OUTPUT/myfolder/mytext.html" 
```

我对“$MYUSER/OUTPUT/myfolder/”目录有读/写权限。

为什么我会收到此错误？为什么不创建 mytext.html 文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T00:44:07.993

`os.path.expandvars()`可以帮忙：

```
f = open(os.path.expandvars(HTMLFILE), 'w') 
```

`open`只处理实际的文件名。 `expandvars`可以扩展字符串中的环境变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-01T00:50:10.650

有两种方法。使用 os.environ() 获取变量值

```
HTML_PATH = "/OUTPUT/myfolder/mytext.html"
f = open(os.environ('MYUSER') + HTMLFILE, 'w') 
```

并使用 os.path.expandvars()：

```
HTMLFILE = "$MYUSER/OUTPUT/myfolder/mytext.html"
f = open(os.path.expandvars(HTMLFILE), 'w') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T00:42:20.313

`$MYUSER`指的是一个shell变量。Python 无法解决这些问题。使用`os`包获取用户主目录通过`os.getenv('MYUSER')`

# mysql - 从同一张桌子分组

> ID：11278740
> 
> 赞同：0
> 
> 时间：2012-07-01T00:39:59.227
> 
> 标签：mysql, sql

是否可以`group by`从多个列中使用？

这是`members`表格：

```
Id | CateogryId | Value
1  | 1          | 10
2  | 2          | 20
1  | 1          | 10 
```

目前，我能够返回`(A,B)`使用：

```
( SELECT GROUP_CONCAT(DISTINCT members.Category) 
    FROM members 
    JOIN categories on members.CategoryId = category.Id
         ) as "Categories" 
```

但我也想要每个类别旁边的总数，例如`(A:20, B:20)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T02:19:11.413

从一个具有 Category Total 的虚拟表（子查询）开始，如下所示：

```
SELECT m.Category, SUM(m.Value) as Total
  FROM members m
 GROUP BY m.Category
 ORDER BY m.Category 
```

然后像这样使用你的虚拟表做你的 concat 。

```
SELECT GROUP_CONCAT(CONCAT(Category, ': ', Total) SEPARATOR ' ')
  FROM (
    SELECT m.Category, SUM(m.Value) as Total
      FROM members m
     GROUP BY m.Category
     ORDER BY m.Category
  )A 
```

# python - Nonetype 对象没有属性 '__getitem__'

> ID：11278741
> 
> 赞同：0
> 
> 时间：2012-07-01T00:40:00.910
> 
> 标签：python

我正在尝试使用从网上下载的 API 包装器从新的 azure Bing API 中获取结果。我正在尝试按照说明实现它，但出现运行时错误：

```
Traceback (most recent call last):
  File "bingwrapper.py", line 4, in <module>
    bingsearch.request("affirmative action")
  File "/usr/local/lib/python2.7/dist-packages/bingsearch-0.1-py2.7.egg/bingsearch.py", line 8, in request
    return r.json['d']['results']
TypeError: 'NoneType' object has no attribute '__getitem__' 
```

这是包装代码：

```
import requests

URL = 'https://api.datamarket.azure.com/Data.ashx/Bing/SearchWeb/Web?Query=%(query)s&$top=50&$format=json'
API_KEY = 'SECRET_API_KEY'

def request(query, **params):
    r = requests.get(URL % {'query': query}, auth=('', API_KEY))
    return r.json['d']['results'] 
```

指令是：

```
>>> import bingsearch
>>> bingsearch.API_KEY='Your-Api-Key-Here'
>>> r = bingsearch.request("Python Software Foundation")
>>> r.status_code
200
>>> r[0]['Description']
u'Python Software Foundation Home Page. The mission of the Python Software Foundation is to promote, protect, and advance the Python programming language, and to ...'
>>> r[0]['Url']
u'http://www.python.org/psf/ 
```

这是我使用包装器的代码（根据说明）：

```
import bingsearch
bingsearch.API_KEY='abcdefghijklmnopqrstuv'
r = bingsearch.request("affirmative+action") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T03:10:00.690

我自己对此进行了测试，看来您缺少的是正确对查询进行 url 编码。没有它，我得到一个 400 代码。

```
import urllib2
import requests

# note the single quotes surrounding the query 
URL = "https://api.datamarket.azure.com/Data.ashx/Bing/SearchWeb/Web?Query='%(query)s'&$top=50&$format=json"

query = 'affirmative+action'

# query == 'affirmative%2Baction'
r = requests.get(URL % {'query': urllib2.quote(query)}, auth=('', API_KEY))
print r.json['d']['results'] 
```

您的示例没有多大意义，因为您的`request`包装器返回 a `list`of 结果，但在您的主要用法示例中，您正在调用它，然后检查`status_code`返回值（即列表）上的属性。该属性将出现在响应对象上，但您不会从包装器中返回它。

# java - Java nullSocket

> ID：11278744
> 
> 赞同：0
> 
> 时间：2012-07-01T00:40:36.450
> 
> 标签：java, sockets

当我尝试打印套接字对象时，我看到了类似的东西

```
nullSocket[addr=/127.0.0.1,port=45720,localport=8182] 
```

这是什么意思？什么是空套接字？我有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T00:49:10.517

我怀疑你`null`在你的对象之前打印一个`Socket`对象。

# php - PHP 闭包给出了奇怪的性能行为

> ID：11278748
> 
> 赞同：4
> 
> 时间：2012-07-01T00:41:24.513
> 
> 标签：php, performance, closures, anonymous-function

今天早些时候，我正在开发一个 PHP 5.3+ 应用程序，这意味着我可以自由地使用 PHP 闭包。太好了，我想！然后我遇到了一段代码，其中使用函数式 PHP 代码会使事情变得更容易，但是，虽然我有一个合乎逻辑的答案，但它让我想知道直接调用闭包`array_map()`和传递闭包之间的性能影响是什么向下作为变量。即以下两个：

```
$test_array = array('test', 'test', 'test', 'test', 'test' );
array_map( function ( $item ) { return $item; }, $test_array ); 
```

和

```
$test_array = array('test', 'test', 'test', 'test', 'test' );
$fn = function ( $item ) { return $item; };
array_map( $fn, $test_array ); 
```

和我想的一样，后者确实更快，但差别并没有那么大。事实上，重复这些相同的测试 10000 次并取平均值的差异是 0.05 秒。甚至可能是侥幸。

这让我更加好奇了。什么`create_function()`和关闭？同样，经验告诉我，当它创建一个函数、评估它，然后也存储它`create_function()`时，应该更慢一些。`array_map()`再一次，正如我所想的那样，`create_function()`确实慢了。这一切都与`array_map()`.

然后，我不确定我为什么这样做，但我做到了，我检查了`create_function()`和闭包之间的区别，同时保存它并只调用它一次。没有处理，什么都没有，只是简单地传递一个字符串，然后返回该字符串。

测试变成了：

```
$fn = function($item) { return $item; };
$fn('test'); 
```

和

```
$fn = create_function( '$item', 'return $item;' );
$fn('test'); 
```

我分别运行了这两个测试 10000 次，并查看了结果并得到了平均值。我对结果感到非常惊讶。

事实证明，这次关闭速度慢了大约 4 倍。这不可能是我想的。我的意思是，运行闭包`array_map()`要快得多，而通过变量运行相同的函数`array_map()`要快得多，这实际上与这个测试相同。

结果是

```
array
  0 => 
    array
      'test' => string 'Closure test' (length=12)
      'iterations' => int 10000
      'time' => float 5.1327705383301E-6
  1 => 
    array
      'test' => string 'Anonymous test' (length=14)
      'iterations' => int 10000
      'time' => float 1.6745710372925E-5 
```

很好奇为什么会这样，我检查了 CPU 使用率和其他系统资源，并确保没有运行任何不必要的东西，现在一切都很好，所以我再次运行测试，但我得到了类似的结果。

所以我只尝试了一次相同的测试，并运行了多次（当然每次都计时）。事实证明，关闭确实慢了 4 倍，除了偶尔会比 快两到三倍`create_function()`，我猜这只是侥幸，但这似乎足以将时间缩短一半我做了1000次测试。

下面是我用来进行这些测试的代码。谁能告诉我这里到底发生了什么？是我的代码还是只是 PHP 在起作用？

```
<?php

/**
 * Simple class to benchmark code
 */
class Benchmark
{
    /**
     * This will contain the results of the benchmarks.
     * There is no distinction between averages and just one runs
     */
    private $_results = array();

    /**
     * Disable PHP's time limit and PHP's memory limit!
     * These benchmarks may take some resources
     */
    public function __construct() {
        set_time_limit( 0 );
        ini_set('memory_limit', '1024M');
    }

    /**
     * The function that times a piece of code
     * @param string $name Name of the test. Must not have been used before
     * @param callable|closure $callback A callback for the code to run.
     * @param boolean|integer $multiple optional How many times should the code be run,
     * if false, only once, else run it $multiple times, and store the average as the benchmark
     * @return Benchmark $this
     */
    public function time( $name, $callback, $multiple = false )
    {
        if($multiple === false) {
            // run and time the test
            $start = microtime( true );
            $callback();
            $end = microtime( true );

            // add the results to the results array
            $this->_results[] = array(
                'test' => $name,
                'iterations' => 1,
                'time' => $end - $start
            );
        } else {
            // set a default if $multiple is set to true
            if($multiple === true) {
                $multiple = 10000;
            }

            // run the test $multiple times and time it every time
            $total_time = 0;
            for($i=1;$i<=$multiple;$i++) {
                $start = microtime( true );
                $callback();
                $end = microtime( true );
                $total_time += $end - $start;
            }
            // calculate the average and add it to the results
            $this->_results[] = array(
                'test' => $name,
                'iterations' => $multiple,
                'time' => $total_time/$multiple
            );
        }
        return $this; //chainability
    }

    /**
     * Returns all the results
     * @return array $results
     */
    public function get_results()
    {
        return $this->_results;
    }
}

$benchmark = new Benchmark();

$benchmark->time( 'Closure test', function () {
    $fn = function($item) { return $item; };
    $fn('test');
}, true);

$benchmark->time( 'Anonymous test', function () {
    $fn = create_function( '$item', 'return $item;' );
    $fn('test');
}, true);

$benchmark->time( 'Closure direct', function () {
    $test_array = array('test', 'test', 'test', 'test', 'test' );
    $test_array = array_map( function ( $item ) { return $item; }, $test_array );
}, true);

$benchmark->time( 'Closure stored', function () {
    $test_array = array('test', 'test', 'test', 'test', 'test' );
    $fn = function ( $item ) { return $item; };
    $test_array = array_map( $fn, $test_array );
}, true);

$benchmark->time( 'Anonymous direct', function () {
    $test_array = array('test', 'test', 'test', 'test', 'test' );
    $test_array = array_map( create_function( '$item', 'return $item;' ), $test_array );
}, true);

$benchmark->time( 'Anonymous stored', function () {
    $test_array = array('test', 'test', 'test', 'test', 'test' );
    $fn = create_function( '$item', 'return $item;' );
    $test_array = array_map( $fn, $test_array );
}, true);

var_dump($benchmark->get_results()); 
```

这段代码的结果：

```
array
  0 => 
    array
      'test' => string 'Closure test' (length=12)
      'iterations' => int 10000
      'time' => float 5.4110765457153E-6
  1 => 
    array
      'test' => string 'Anonymous test' (length=14)
      'iterations' => int 10000
      'time' => float 1.6784238815308E-5
  2 => 
    array
      'test' => string 'Closure direct' (length=14)
      'iterations' => int 10000
      'time' => float 1.5178990364075E-5
  3 => 
    array
      'test' => string 'Closure stored' (length=14)
      'iterations' => int 10000
      'time' => float 1.5463256835938E-5
  4 => 
    array
      'test' => string 'Anonymous direct' (length=16)
      'iterations' => int 10000
      'time' => float 2.7537250518799E-5
  5 => 
    array
      'test' => string 'Anonymous stored' (length=16)
      'iterations' => int 10000
      'time' => float 2.8293371200562E-5 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-01T21:14:15.097

5.1327705383301E-6 is not 4 times slower than 1.6745710372925E-5; it is about 3 times faster. You are reading the numbers wrong. It seems that in all of your results, the closure is consistently faster than the `create_function`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T01:03:02.260

请参阅此基准：

```
<?php
$iter = 100000;

$start = microtime(true);
for ($i = 0; $i < $iter; $i++) {}
$end = microtime(true) - $start;
echo "Loop overhead: ".PHP_EOL;
echo "$end seconds".PHP_EOL;

$start = microtime(true);
for ($i = 0; $i < $iter; $i++) {
    $fn = function($item) { return $item; };
    $fn('test');
}
$end = microtime(true) - $start;
echo "Lambda function: ".PHP_EOL;
echo "$end seconds".PHP_EOL;

$start = microtime(true);
for ($i = 0; $i < $iter; $i++) {
    $fn = create_function( '$item', 'return $item;' );
    $fn('test');
}
$end = microtime(true) - $start;
echo "Eval create function: ".PHP_EOL;
echo "$end seconds".PHP_EOL; 
```

结果：

```
Loop overhead: 
0.011878967285156 seconds
Lambda function: 
0.067019939422607 seconds
Eval create function: 
1.5625419616699 seconds 
```

现在，有趣的是，如果将函数声明*放在*for 循环之外：

```
Loop overhead: 
0.0057950019836426 seconds
Lambda function: 
0.030204057693481 seconds
Eval create function: 
0.040947198867798 seconds 
```

为了回答您最初的问题，将 lambda 函数分配给变量和简单地使用它没有区别。除非您多次使用它，否则在这种情况下使用变量会更好地提高代码清晰度

# algorithm - 如何实现无间隙块布局算法？

> ID：11278754
> 
> 赞同：3
> 
> 时间：2012-07-01T00:42:07.017
> 
> 标签：algorithm

我正在尝试以 4 单位宽、任意单位高的网格布局显示图像。

网格中的每个图像可能是 1x1、1x2、2x1 或 2x2 单位。我也在使用 jQuery masonry 来尝试消除布局中的一些空白。

图像显示的尺寸（1x1、2x2 等）是基于其尺寸的“首选”尺寸。

我认为消除布局间隙的最简单方法是在布局中以不同于其首选尺寸的尺寸显示某些图像。我怎样才能在算法上做到这一点，保持以首选尺寸显示的最大照片数量，同时覆盖那些确定为无间隙布局所必需的照片。

视觉示例；我想转这个：

![在此处输入图像描述](../Images/1e0b8f0b28e4946973bb4da6aa61b78b.png)

变成他们在这个网站上的东西：http: [//500px.com/](http://500px.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T04:59:59.987

您可以做的最简单的事情是将成对的 1x2 组合在一起，将成对的 2x1 组合在一起，并将四组 1x1 组合在一起。布置大量 2x2 的图像很容易，只有奇数图像需要调整大小。这（或类似的东西）几乎肯定是 500px.com 所做的。

我怀疑此解决方案与您的“从左到右，从上到下”的限制并没有真正兼容。但我不确定这个限制到底意味着什么。也许如果您能清楚说明这意味着什么，我们可以为您提供更好的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:52:05.487

Just a start: I think this is an instance of [**bin packing**](http://en.wikipedia.org/wiki/Bin_packing_problem) which is [NP-complete](http://en.wikipedia.org/wiki/Np_complete) in the general case (see [this pdf](http://www2.informatik.hu-berlin.de/alkox/lehre/lvws1011/coalg/bin_packing.pdf)). Might be helpful to start searching for things in those terms... this is not a complete answer by any means.

# java - 使用 StringTokenizer 计算字符

> ID：11278756
> 
> 赞同：1
> 
> 时间：2012-07-01T00:42:09.613
> 
> 标签：java, string

我需要编写一个函数来计算字符串中每个字母的频率。

这是一个例子：

我收到文件：notes.txt 消息包括：“你好，这是来自内布拉斯加州的杰克”

当我阅读文件时，结果如下：

a: 3 H: 1 e: 2 l: 2 等

有人告诉我可以使用 Stringtokeizer，这是真的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:24:14.990

You could use a Multiset/Bag data structure approach. Using Guava it would look like:

```
public static void main(String... a) {
    final String str = "Hello this is Jack from Nebraska";

    final Builder<Character> b = ImmutableMultiset.builder();           
    for (char c : str.toCharArray())
        b.add(c);

    System.out.println(b.build());
} 
```

Results in:

`[H, e x 2, l x 2, o x 2, x 5, t, h, i x 2, s x 3, J, a x 3, c, k x 2, f, r x 2, m, N, b]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:53:36.873

```
public static void main(String... args) {

    String str = "Hello this is Jack from Nebraska";

    Map<Character, Integer> frequencies = new HashMap<Character, Integer>();
    for (char c : str.toCharArray()) {
        if (!frequencies.containsKey(c))
            frequencies.put(c, 1);
        else
            frequencies.put(c, frequencies.get(c) + 1);
    }

    System.out.println(frequencies);
} 
```

Output:

```
{f=1,  =5, e=2, b=1, c=1, a=3, o=2, N=1, l=2, m=1, H=1, k=2, h=1, J=1, i=2, t=1, s=3, r=2} 
```

# android - 找不到错误 PHP MYSQL JSON ANDROID

> ID：11278758
> 
> 赞同：-1
> 
> 时间：2012-07-01T00:42:36.697
> 
> 标签：android, mysql, json, logcat

谁能帮我剖析这个错误日志？抛出这个的类几乎与在同一程序中运行良好的另一个类相同。唯一的区别是我添加了一个列表并将参数传递给 json 请求的 url

```
 protected String doInBackground(String... args) {
            // Building Parameters
            List<NameValuePair> params = new ArrayList<NameValuePair>();
            // getting JSON string from URL
            //params.add(new BasicNameValuePair("category","cat")); 
```

第 74 行： JSONObject json = jParser.makeHttpRequest(url_get_channels, "GET", params);

```
 // Check your log cat for JSON reponse
            Log.d("All Products: ", json.toString());

07-01 00:17:21.573: D/dalvikvm(1009): GC_FOR_MALLOC freed 2585 objects / 167744 bytes in 78ms
07-01 00:17:28.133: W/dalvikvm(1009): threadid=9: thread exiting with uncaught exception (group=0x4001d800)
07-01 00:17:28.253: E/AndroidRuntime(1009): FATAL EXCEPTION: AsyncTask #2
07-01 00:17:28.253: E/AndroidRuntime(1009): java.lang.RuntimeException: An error occured while executing doInBackground()
07-01 00:17:28.253: E/AndroidRuntime(1009):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.lang.Thread.run(Thread.java:1096)
07-01 00:17:28.253: E/AndroidRuntime(1009): Caused by: java.lang.NullPointerException
07-01 00:17:28.253: E/AndroidRuntime(1009):     at com.example.video.unlimited.ListChannels$LoadAllChannels.doInBackground(ListChannels.java:74)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at com.example.video.unlimited.ListChannels$LoadAllChannels.doInBackground(ListChannels.java:1)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
07-01 00:17:28.253: E/AndroidRuntime(1009):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
07-01 00:17:28.253: E/AndroidRuntime(1009):     ... 4 more
07-01 00:17:29.762: E/WindowManager(1009): Activity com.example.video.unlimited.ListChannels has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@44ef2968 that was originally added here
07-01 00:17:29.762: E/WindowManager(1009): android.view.WindowLeaked: Activity com.example.video.unlimited.ListChannels has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@44ef2968 that was originally added here
07-01 00:17:29.762: E/WindowManager(1009):  at android.view.ViewRoot.<init>(ViewRoot.java:247)
07-01 00:17:29.762: E/WindowManager(1009):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:148)
07-01 00:17:29.762: E/WindowManager(1009):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
07-01 00:17:29.762: E/WindowManager(1009):  at android.view.Window$LocalWindowManager.addView(Window.java:424)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.Dialog.show(Dialog.java:241)
07-01 00:17:29.762: E/WindowManager(1009):  at com.example.video.unlimited.ListChannels$LoadAllChannels.onPreExecute(ListChannels.java:63)
07-01 00:17:29.762: E/WindowManager(1009):  at android.os.AsyncTask.execute(AsyncTask.java:391)
07-01 00:17:29.762: E/WindowManager(1009):  at com.example.video.unlimited.ListChannels.onCreate(ListChannels.java:45)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-01 00:17:29.762: E/WindowManager(1009):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-01 00:17:29.762: E/WindowManager(1009):  at android.os.Looper.loop(Looper.java:123)
07-01 00:17:29.762: E/WindowManager(1009):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-01 00:17:29.762: E/WindowManager(1009):  at java.lang.reflect.Method.invokeNative(Native Method)
07-01 00:17:29.762: E/WindowManager(1009):  at java.lang.reflect.Method.invoke(Method.java:521)
07-01 00:17:29.762: E/WindowManager(1009):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-01 00:17:29.762: E/WindowManager(1009):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-01 00:17:29.762: E/WindowManager(1009):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T14:39:34.930

“android.view.WindowLeaked”异常呢？这意味着您正试图从“关闭”活动中显示一个对话框。

希望这会有所帮助/Yaron

# jquery - Fancybox iframe 中未显示链接

> ID：11278770
> 
> 赞同：1
> 
> 时间：2012-07-01T00:44:40.300
> 
> 标签：jquery, fancybox

我无法让 fancybox 在 iframe 中打开我的链接。我的代码如下。谢谢！

```
<link href="./fancybox/jquery.fancybox-1.3.4.css" type="text/css" rel="stylesheet"/>
<script src="_js/jquery-1.7.2.min.js"></script>
<script src="fancybox/jquery.fancybox-1.3.4.js"></script>
<script>
$(document).ready(function() {
$('.iframe').fancybox({
'width': '85%', 
'height': '75%',
'transitionIn' : 'none',
'transitionOut' : 'none',
'type' : 'iframe'
}); // end fancybox
}); // end ready
</script> 
```

以及我试图从我的页面打开的链接

```
<a href="http://www.nytimes.com/2010/07/18/books/review/Boyd-t.html" class="iframe">
<div class="linkcontainer"><h1>Review</h1></div></a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T00:14:51.040

您的代码没有任何问题，但问题与fancybox无关。

很可能该页面`X-Frame-Options response header`用于禁止在一个`iframe`（使用 html`iframe`标签的 fancybox 的情况下）中打开该页面

检查此链接以获取更多信息[https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header](https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header)

您的代码可以与来自同一域的任何其他页面一起正常工作，或者不受 clickJacking 保护。

# java - Java 数组初始化保证

> ID：11278771
> 
> 赞同：11
> 
> 时间：2012-07-01T00:44:52.140
> 
> 标签：java, arrays, initialization

Java 是否保证数组初始化？

假设我使用代码`char[] uuid = new char[36];`，是否可以保证每个元素都被初始化为 0？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-01T00:48:03.230

是的。[JLS §10.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.3)确保数组的所有元素都设置为其初始值，[JLS §4.12.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)保证其为`0`、`false`或`null`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:47:32.850

是的，它确实保证了初始化。[JLS 第 10.3 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.3)

# php - Magento：如何获取 Paypal 交易 ID？

> ID：11278773
> 
> 赞同：2
> 
> 时间：2012-07-01T00:45:14.083
> 
> 标签：php, magento

我正在尝试在我们的发票 PDF 文件上打印 Paypal 交易 ID。`$order`您可以从Sales_Order 的一个实例中提取此信息吗？

我确实找到了一些带有 paypal_ 前缀的数据库表，但它们都是空的，即使我们在安装中有一个真正的 Paypal 交易订单。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T01:19:35.287

试试： $transaction_id = $order->getPayment()->getLastTransId();

# javascript - 原型对象

> ID：11278774
> 
> 赞同：0
> 
> 时间：2012-07-01T00:45:14.840
> 
> 标签：javascript, prototype

我对原型不太熟悉，我确信这是不正确的实现，但我已经整理了一个我想要实现的小例子。

我可以使原型成为文字对象而不是函数，但是遇到了无法访问我正在创建原型（在本例中为人）的对象中的变量/属性的问题。

```
Person = function() {
  this.name = 'mike';
  this.departureSaying = 'Adios amigo!';
}

Person.prototype.say = function() {
  var self = this;
  function hello() { alert('hello my name is ' + self.name); }
  function goodbye() { alert(self.departureSaying); }
}

var mike = new Person();
mike.say.hello();
mike.say.goodbye(); 
```

如果你运行它，你会得到 Object has no method hello and goodbye。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T00:48:18.427

您的两个函数是该方法的本地函数；你不会退回它们。

```
Person.prototype.say = function() {
    var self = this;

    return {
        hello: function() { alert('hello my name is ' + self.name); },
        goodbye: function() { alert(self.departureSaying); }
    };
}; 
```

然后你会想要：

```
mike.say().hello();
mike.say().goodbye(); 
```

但是，我不认为使用原型适合这种情况。在构造函数中分配它，而不是：

```
function Person() {
    var self = this;

    this.name = 'mike';
    this.departureSaying = 'Adios amigo!';

    this.say = {
        hello: function() { alert('hello my name is ' + self.name); },
        goodbye: function() { alert(self.departureSaying); }
    };
} 
```

[这是一个演示。](http://jsfiddle.net/minitech/TGSTL/)

# websocket - 与两台服务器交互的网页

> ID：11278779
> 
> 赞同：1
> 
> 时间：2012-07-01T00:45:52.240
> 
> 标签：websocket, comet

我有一个由动态和静态内容混合组成的网页。

我所说的**static**是指布局、标签、按钮、文本字段、表格等。换句话说，就是页面的可视化组件。

通过**动态**，我的意思是显示为标签和表格中的值通过 websockets 连接自动更新。更具体地说，与服务器的这种交互由实现 websockets 协议的 Javascript 库处理。

在这种情况下，一个逻辑设置是让两台服务器为页面提供服务：一台返回上述所有静态部分，另一台返回变化的值。

问题是，我应该如何实现这个设置/设计？它是纯粹在前端代码中完成的（例如 HTML 加 Javascript），还是需要在前端和后端都设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T08:00:58.690

不确定您在寻找什么，但这是现代 Web 应用程序的一种选择：

**通过 WebSocket 连接后端的单网页应用程序**。

所有静态内容（HTML、CSS、JS、Imgs、..）都可以从普通的旧 Web 服务器、CDN 提供，甚至可以打包到 ZIP 中作为 Web 小部件。

与后端的所有交互都是通过 WebSocket 进行的。交互可能会使用更高级别的消息传递模式，例如 RPC 和 PubSub。

这种应用程序的设计方法可以是 Model-View-Presenter，在客户端前端使用 View 和 Presenter，在后端使用模型。

# android - 如何使用 adb intent 解除 android keyguard

> ID：11278781
> 
> 赞同：1
> 
> 时间：2012-07-01T00:46:43.493
> 
> 标签：android, android-intent, adb, keyguard

我正在寻找一种方法来使用 ADB 解除键盘保护以自动化某些任务。

我想启动一个 ACTIVITY （可能在 android.app.KeyguardManager.KeyguardLock 中调用公共方法 disableKeyguard），因为我认为它可以在所有（或大多数）Android 设备上运行，但我不确定语法。

我不想使用 MonkeyRunner，因为它在所有设备上都不存在（或者可能是可调用的）。我也无法发送 MENU 键码（adb shell 输入键码 82），因为这不会解除所有设备上的键盘保护。

目前我正在发送事件（低级触摸事件），但这需要为每个设备定制，所以这是一项耗时的任务。

有人有建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T04:44:24.200

“活动测试”文章有一个名为[解锁模拟器或设备](http://developer.android.com/tools/testing/activity_testing.html#UnlockDevice)的部分来解决这种情况。

简而言之，没有办法直接使用，`adb`但使用`disableKeyguard()`并不复杂（请参阅上面链接的文章中的三行示例代码）。您可以轻松地组合一个小应用程序，该应用程序除了禁用键盘保护之外什么都不做。那么这只是一个问题

```
adb install <apk>
adb shell am start <package>/.<activity>
# Whatever you need to automate
adb uninstall <package> 
```

（其中`<apk>`,`<package>`和`<activity>`all 指的是刚刚禁用键盘保护的小应用程序。）

# java - Android SimpleCursorAdapter.ViewBinder 不更新绑定的 TextView

> ID：11278782
> 
> 赞同：1
> 
> 时间：2012-07-01T00:46:45.487
> 
> 标签：java, android, sqlite

我有一个 SimpleCursorAdapter，我正在尝试将 SimpleCursorAdapter.ViewBinder 绑定到它。下面是我正在使用的代码。

```
// Setup Cursor and SimpleCursorAdapter, called in Activity onResume()
Cursor userCursor = getUserProfile(userEmail);
mAdapter = new SimpleCursorAdapter(this, 
                R.layout.user_profile,
                userCursor, 
                new String[] { 
                    StackOverFlow.Users.FULL_NAME,
                    StackOverFlow.Users.EMAIL }, 
                new int[] {
                    R.id.txtvwProfileUserFullName,
                    R.id.txtvwProfileOtherUserInfo } ); 
mAdapter.setViewBinder(new UserProfileViewBinder()); 
```

我的 UserProfileViewBinder 类：

```
private class UserProfileViewBinder implements SimpleCursorAdapter.ViewBinder {
    @Override
    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
        TextView tv;
        switch (columnIndex) {
        case 1: // TODO: Magic Numbers, bad!
            tv = (TextView) view.findViewById(R.id.txtvwProfileUserFullName);
            String userFullName = cursor.getString(columnIndex);
            tv.setText(userFullName);
            break;
        case 2: // TODO: Magic Numbers, bad!
            tv = (TextView) view.findViewById(R.id.txtvwProfileOtherUserInfo);
            String userEmail = cursor.getString(columnIndex);
            tv.setText(userEmail);
            break;
        }
        return true;

    }
} 
```

# **问题**

当我加载活动时，TextView 不会使用来自`userCursor`. 我可以确认它`userCursor`实际上指向支持 SQLite 数据库中的有效行，并且有数据，但其中的`setViewValue`方法`UserProfileViewBinder`似乎从未执行。我不确定我做错了什么，或者忽略了包括在内。

作为替代方案，我正在执行以下操作来设置 TextView 的文本：

```
if (mAdapter.getCursor().moveToFirst()) {
    mUserFullName.setText(mAdapter.getCursor().getString(
            StackOverFlow.USER_FULL_NAME));
    mUserOtherInfo.setText(mAdapter.getCursor().getString(
            StackOverFlow.USER_EMAIL));
} 
```

但我认为这不会在光标数据更改时自动更新 TextView。当执行查询后`ContentProvider`调用`setNotificationUri`，REST 服务器调用返回并且线程更新光标指向的行时。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:37:34.900

除了在这两个上设置文本之外，您还打算做其他事情`TextViews`吗？如果答案是否定的，那么您没有理由使用`ViewBinder`，`SimpleCursorAdapter`默认情况下，它将为您设置文本。

无论如何，我不明白您为什么使用`columnIndex`参数来识别视图而不是传入的视图的 id。看看这是否有帮助：

```
public boolean setViewValue(View view, Cursor cursor, int columnIndex) {        
        if (view.getId() == R.id.txtvwProfileUserFullName) {
            String userFullName = cursor.getString(columnIndex);
            ((TextView) view).setText(userFullName);
            return true;
        } else if (view.getId() == R.id.txtvwProfileOtherUserInfo) {
            String userEmail = cursor.getString(columnIndex);
            ((TextView) view).setText(userEmail);
            return true;
        } else {
            return false;
        }
} 
```

# javascript - 圆形碰撞检测 HTML5 Canvas

> ID：11278783
> 
> 赞同：4
> 
> 时间：2012-07-01T00:46:53.983
> 
> 标签：javascript, jquery, html, canvas

我想检查圆圈是否相互碰撞。

我知道我可以通过获取两个圆心之间的距离并从该距离中减去每个圆的半径并查看“距离”是否大于 1 来做到这一点。

我怎样才能有效地做到这一点，虽然有 1000 个圈子？也许我可以以某种方式获得最近的 20 个圆圈或类似的东西并检查这些？我也不知道我将如何开始有效地解决这个问题。

有任何想法吗？

这是一个例子：

[http://experiments.lionel.me/blocs/](http://experiments.lionel.me/blocs/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T00:58:03.763

在开始计算距离的精确差异之前，您至少可以比较中心的 x/y 位置与半径。该信息隐含在圆圈中，只需要一些简单的比较和加法/减法。

这将让您比较所有圆对之间 x/y 中的简单距离，并丢弃任何显然不是碰撞候选者的距离，例如

```
abs(x2 - x1) > (r2 + r1)
abs(y2 - y1) > (r2 + r1) 
```

...如果圆心之间的 X 或 Y 距离大于半径之和，则它们不会发生碰撞。

一旦你减少了可能的对撞机，那么你就可以进行正式的精确笛卡尔距离，这就是“重”乘法/除法的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T00:58:35.093

考虑将圆心的坐标存储在四叉树中，然后您只需要检查该圆是否与该象限或相邻象限中的其他圆相交。

需要注意的是，您需要确保四叉树的叶节点具有最大圆半径的最小直径，否则您将不得不检查的不仅仅是相邻节点的交叉点。

[http://en.wikipedia.org/wiki/Quadtree](http://en.wikipedia.org/wiki/Quadtree)

如果你的圆圈很分散，那么你可以做的一个简单的优化是将你的圆圈存储在 x 或 y 轴上，然后你只需要检查 x 或 y 坐标在圆圈半径内的圆圈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T00:58:57.300

效率将与*您使用的算法的速度有关*，例如计算距离的平方根算法的速度，除了算法之外，*您的数据结构*将决定内存的效率。加快计算速度的另一种方法是降低距离计算的精度。

如您所说，检测圆是否发生碰撞的最佳方法是将圆的中心坐标和半径存储在变量中，并在减去半径时计算中心之间的距离是否等于 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T14:50:37.160

我强烈推荐 Keith Peter 的***AdvancED ActionScript 3.0 Animation***一书，您可以在其中找到四叉树算法在 Actionscript 中的具体实现。

以下是基本步骤：

*   首先创建一个二维网格并将所有球随机散布在场地上。

    ```
    private function createGrids():void {
        _grids = new Array();
        for (var i:int = 0; i< stage.stageWidth / GRID_SIZE; i++) {
            _grids[i] = new Array();
            for (var j:int = 0; j< stage.stageHeight / GRID_SIZE; j++) {
                _grids[i][j] = new Array();
            }
        }
    } 
    ```

*   将球分配给网格单元

    ```
    private function assignBallsToGrid():void {
        for (var i:int = 0; i< numBalls; i++) {
            var ball:Ball = Ball(_balls[i]);
            var xpos:int = Math.floor(ball.x / GRID_SIZE);
            var ypos:int = Math.floor(ball.y / GRID_SIZE);
            _grids[xpos][ypos].push(ball);
        }
    } 
    ```

*   检查两个球是否在一个单元格中碰撞，然后检查相邻单元格中的球。正如 Charles Ma 提到的，这里唯一考虑的是网格单元尺寸必须大于或等于最大球直径。

    ```
    private function checkOneCell(x1:Number, y1:Number):void {
        var _cell:Array = _grids[x1][y1] as Array;
        for (var i:int = 0; i< _cell.length-1; i++) {
            var ballA:Ball = _cell[i] as Ball;
            for (var j:int = i+1; j< _cell.length; j++) {
                var ballB:Ball = _cell[j] as Ball;
                checkCollision(ballA, ballB);
            }
        }
    }

    private function checkTwoCell(x1:Number, y1:Number, x2:Number, y2:Number):void {
        if (x2 < 0) { return } 
        if (x2 >= _grids.length) { return }
        if (y2 >= _grids[x2].length) { return }

        var _cell0:Array = _grids[x1][y1] as Array;
        var _cell1:Array = _grids[x2][y2] as Array;

        for (var i:int = 0; i< _cell0.length; i++) {
            var ballA:Ball = _cell0[i] as Ball;
            for (var j:int = 0; j< _cell1.length; j++) {
                var ballB:Ball = _cell1[j] as Ball;
                checkCollision(ballA, ballB);
            }
        }
    }

    private function checkCollision(ballA:Ball, ballB:Ball):void {
        var dx:Number = ballB.x - ballA.x;
        var dy:Number = ballB.y - ballA.y;
        var dist:Number = Math.sqrt(dx*dx + dy*dy);
        if (dist < ballB.radius + ballA.radius) {
                         // do something
        }
    } 
    ```

*   这是主要方法的样子：

    ```
    private function checkBallsCollision():void {
        for (var i:int = 0; i< _grids.length; i++) {
            for (var j:int = 0; j< _grids[i].length; j++) {
                checkOneCell(i, j);

                checkTwoCell(i, j, i+1, j);
                checkTwoCell(i, j, i, j+1);
                checkTwoCell(i, j, i-1, j);
                checkTwoCell(i, j, i+1, j+1);
            }
        }
    } 
    ```

**笔记：**

代码是用 Actionscript 编写的，但可以很容易地用 Javascript 实现。

# objective-c - Cocoa iOS 用碰撞将矩形变成圆形

> ID：11278790
> 
> 赞同：3
> 
> 时间：2012-07-01T00:48:53.193
> 
> 标签：objective-c, ios, cocoa-touch, collision-detection, quartz-2d

所以我有一个 UIView `fallingBall`，它目前与我的 UIView 很好地碰撞`theBlockView`。我`CGRectIntersectsRect(theBlockView.frame, fallingBall.frame)`用来检测这种碰撞。

这一切都很好，所以现在我希望我 `fallingBall`的实际上是圆的，我也希望我的顶角`theBlockView`是圆的。为此，我使用了以下代码：

```
//round top right-hand corner of theBlockView
UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:theBlockView.bounds 
                                           byRoundingCorners:UIRectCornerTopRight
                                           cornerRadii:CGSizeMake(10.0, 10.0)];
CAShapeLayer *maskLayer = [CAShapeLayer layer];
maskLayer.frame = theBlockView.bounds;
maskLayer.path = maskPath.CGPath;
theBlockView.layer.mask = maskLayer;

//round the fallingBall view
[[fallingBall layer] setCornerRadius:30]; 
```

但是，有趣的是，尽管它们看起来又漂亮又圆润，但视图仍然是矩形。所以我的问题是：我怎样才能`CGRectIntersectsRect`将它们视为它们看起来的形状？是否有一个功能相同但使用视图的 alpha 来检测碰撞的功能？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T11:50:08.983

其实，让我回答我自己的问题！

好的，所以我在过去 10 个小时的大部分时间里都在环顾四周，发现了这篇文章：[圆形-矩形碰撞检测（交叉点）](https://stackoverflow.com/questions/401847/circle-rectangle-collision-detection-intersection) ——看看 e.James 怎么说！

我写了一个函数来帮助解决这个问题：首先，声明以下`struct`s：

```
typedef struct
{
    CGFloat x; //center.x
    CGFloat y; //center.y
    CGFloat r; //radius
} Circle;
typedef struct
{
    CGFloat x; //center.x
    CGFloat y; //center.y
    CGFloat width;
    CGFloat height;
} MCRect; 
```

然后添加以下函数：

```
-(BOOL)circle:(Circle)circle intersectsRect:(MCRect)rect
{

    CGPoint circleDistance = CGPointMake(abs(circle.x - rect.x), abs(circle.y - rect.y) );

    if (circleDistance.x > (rect.width/2 + circle.r)) { return false; }
    if (circleDistance.y > (rect.height/2 + circle.r)) { return false; }

    if (circleDistance.x <= (rect.width/2)) { return true; } 
    if (circleDistance.y <= (rect.height/2)) { return true; }

    CGFloat cornerDistance_sq = pow((circleDistance.x - rect.width/2), 2) + pow((circleDistance.y - rect.height/2), 2);

    return (cornerDistance_sq <= (pow(circle.r, 2)));
} 
```

我希望这可以帮助别人！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T01:34:12.533

CGRectIntersectsRect 将始终使用矩形，视图的框架也将始终是矩形。您将不得不编写自己的函数。您可以使用视图的中心来使用角半径计算圆，并测试矩形和圆是否以某种方式相交。

# java - SwingWorker 挂在 Unsafe.park()

> ID：11278791
> 
> 赞同：6
> 
> 时间：2012-07-01T00:48:54.093
> 
> 标签：java, swing, swingworker

我有一个`SwingWorker`在后台与服务器通信，然后更新一个`JFrame`. 我正在调试我的应用程序，并注意到即使在`SwingWorker`完成它的工作之后，它的线程仍然存在。它挂在`Unsafe.park(java.lang.Object)`哪个本地方法上。我进一步研究了这一点，发现`SwingWorker`我的应用程序中的所有其他 s 在完成后都会做同样的事情。如果有人需要，我可以提供源代码，但我认为没有必要，因为问题似乎很普遍。

### 更新

我在没有调试器的情况下运行了应用程序，但问题仍然存在。这是`SwingWorker`线程的转储：

```
"SwingWorker-pool-2-thread-1" daemon prio=6 tid=0x03219800 nid=0xd74 waiting on
condition [0x04b7f000]
   java.lang.Thread.State: WAITING (parking)
        at sun.misc.Unsafe.park(Native Method)
        - parking to wait for  <0x22ec63d8> (a java.util.concurrent.locks.Abstra
ctQueuedSynchronizer$ConditionObject)
        at java.util.concurrent.locks.LockSupport.park(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject
.await(Unknown Source)
        at java.util.concurrent.LinkedBlockingQueue.take(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor.getTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source) 
```

我制作了一个示例程序，它使用`SwingWorker`通常在应用程序中使用的方式。这个程序也有同样的问题。这是代码：

```
package swingworkerlocktest;

import java.util.List;
import javax.swing.JFrame;
import javax.swing.JTextArea;
import javax.swing.SwingWorker;

public class SwingWorkerLockTest {

    public static void main(String[] args) {
        final JFrame frame = new JFrame("Frame");
        final JTextArea outputArea = new JTextArea(4, 20);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(outputArea);
        frame.pack();
        frame.setVisible(true);
        (new SwingWorker<Object, String>() {
            @Override
            protected Object doInBackground() throws Exception {
                publish("Background task.");
                return null;
            }

            @Override
            protected void process(List<String> chunks) {
                for (String str : chunks) {
                    outputArea.append(str + "\n");
                }
            }

            @Override
            protected void done() {
                outputArea.append("Background task finished.");
            }
        }).execute();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-05T14:10:05.587

这是 SwingWorker 的正常行为，如果 Thread 处于空闲状态，则应在 10 分钟后终止。[这里](https://stackoverflow.com/questions/5156898/why-do-my-swingworker-threads-keep-running-even-though-they-are-done-executing)解释了

# javascript - 亚洲语言字符通过转移被搞砸了

> ID：11278795
> 
> 赞同：0
> 
> 时间：2012-07-01T00:51:03.287
> 
> 标签：javascript, html, encoding

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T00:53:08.893

> My charset encoding on my webpage is iso-8859-1

That won't work. You need to upgrade to UTF-8 for non-European languages.

# c# - Is there any way to implicitly construct a type in C#?

> ID：11278798
> 
> 赞同：11
> 
> 时间：2012-07-01T00:51:53.987
> 
> 标签：c#, .net, types

I read of a useful trick about how you can avoid using the wrong domain data in your code by creating a data type for each domain type you're using. By doing this the compiler will prevent you from accidentally mixing your types.

For example, defining these:

```
public struct Meter
{
    public int Value;

    public Meter(int value)
    {
        this.Value = value;
    }
}

public struct Second
{
    public int Value;

    public Second(int value)
    {
        this.Value = value;
    }
} 
```

allows me to not mix up meters and seconds because they're separate data types. This is great and I can see how useful it can be. I'm aware you'd still need to define operator overloads to handle any kind of arithmetic with these types, but I'm leaving that out for simplicity.

The problem I'm having with this approach is that in order to use these types I need to use the full constructor every time, like this:

```
Meter distance = new Meter(5); 
```

Is there any way in C# I can use the same mode of construction that a `System.Int32` uses, like this:

```
Meter distance = 5; 
```

I tried creating an implicit conversion but it seems this would need to be part of the Int32 type, not my custom types. I can't add an Extension Method to Int32 because it would need to be static, so is there any way to do this?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-01T00:55:49.147

You can specify an [implicit conversion](http://msdn.microsoft.com/en-us/library/85w54y0a.aspx) directly in the structs themselves.

```
public struct Meter
{
    public int Value;

    public Meter(int value)
    {
        this.Value = value;
    }

    public static implicit operator Meter(int a)
    {
         return new Meter(a);
    }
}

public struct Second
{
    public int Value;

    public Second(int value)
    {
        this.Value = value;
    }

    public static implicit operator Second(int a)
    {
         return new Second(a);
    }
} 
```

# php - Magento：是否有可能获得信用卡处理 AVS 和 CSC？

> ID：11278801
> 
> 赞同：2
> 
> 时间：2012-07-01T00:52:04.753
> 
> 标签：php, magento

我想在我们的发票 PDF 上打印信用卡处理 AVS 和 CSC 结果（通过/否通过、是/否等），但我不知道 Magento 是否提供它们。我在销售订单下的后端管理部分没有看到它。

我正在为 PDF 发票处理此文件：

`/var/www/html/app/code/local/Mage/Sales/Model/Order/Pdf/Abstract.php`

是否符合`$order->getPayment()->...`?

*** 更新： ***

支付网关：Payflow Pro（由 Paypal 提供） - 这与 Paypal Express Checkout 不同，后者是买家前往 paypal.com 进行付款。

Magento 企业版 1.11.2.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T01:46:39.357

我认为这应该可行，我在 magento paypal 模块中使用搜索字符串 AVS 发现它

```
 $avs_response=$order->getPayment()->getAdditionalInformation('paypal_avs_code'); 
```

和 paypal_cvv2_match / CSC？

```
 $csc_response=$order->getPayment()->getAdditionalInformation('paypal_cvv2_match'); 
```

# php - 执行类似 DROP 的查询时触发创建 PHP 函数

> ID：11278810
> 
> 赞同：-1
> 
> 时间：2012-07-01T00:53:44.847
> 
> 标签：php, security, warnings

我正在尝试编写“如果（查询包含任何常见的攻击术语，超过 80 个字符等）{执行函数}”

我知道 preg_replace 允许字符，但是否有一个函数来禁止设置字符串或如何构建类似的东西：

`if(isset( contains['DROP, OR, 1-1, etc]) ) {`

 ````
$message = $_SERVER["REMOTE_ADDR"]; 
$message = $_SERVER[""];
mail('admins@website.com', 'Shady Query Going on', $message); 
```` 

`}`

我知道各种插件会发送多次登录尝试和锁定等警告。我希望对 SQLi 尝试做同样的事情

更新：事实证明，这实际上是一个有用的插件 -当登录错误和其他可疑业务继续时，[Better WP Security会向您发送电子邮件。](http://bit51.com/software/better-wp-security/)也没有人回答我的问题，似乎是一群精英咆哮......感谢@Rook和@Thawab tho！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T04:56:34.087

我建议在您的脚本中使用[http://phpids.org/](http://phpids.org/)，因为它可以检测到更多攻击。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-01T00:56:19.167

如果您正确保护您的站点免受 SQL 注入，您绝对不需要这个。但是，要实现它...

```
function checkForBlacklistedTerms($string)
{
    $blacklisted = array('DROP', '--', 'KILL', 'BLAH', 'BLIH');
    foreach($blacklisted as $bl) { 
        if( strpos($string, $bl) !== FALSE ) { 
            return true;
        }
    }
    return false;
}

if( checkForBlacklistedTerms($searchquery) || strlen($searchquery) > 80 )
{
   // warning code goes here
} 
```

# .htaccess - rewrite www. to non www without specifying the domain?

> ID：11278811
> 
> 赞同：2
> 
> 时间：2012-07-01T00:54:12.983
> 
> 标签：.htaccess

I was using this code to remove www from my domain:

```
# remove www
RewriteCond %{HTTP_HOST} ^www.example.com$ [NC]
RewriteRule ^(.*)$ http://example.com/$1 [R=301,L] 
```

My problem is that I usually use subdomains and it doesn't work for them. (www.sub.example.com).

How do I rewrite to remove www whatever the domain is and even if it has subdomains?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T12:05:49.413

尝试这个：

```
#********** Remove www from address **********
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,NC] 
```

这比其他解决方案更正确。

编辑：我删除了 [L] 因为它在这里不适用。
尽管在大多数情况下，建议使用不区分大小写的 [NC]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:02:57.267

您可能可以使用捕获组并结合重写......（完全未经测试的猜测）

```
# remove www
RewriteCond %{HTTP_HOST} ^www.(.*) [NC]
RewriteRule ^(.*)$ http://$1 [R=301,L] 
```

# java - Error messages are not displayed in showForm() while using the Validator interface

> ID：11278813
> 
> 赞同：0
> 
> 时间：2012-07-01T00:55:45.600
> 
> 标签：java, spring, hibernate, jsp

I'm validating a form using the `Validator` interface with Spring MVC 3.0.2 using `SimpleFormController`. The following is the controller class which extends `SimpleFormController`.

```
@SuppressWarnings("deprecation")
final public class Temp extends SimpleFormController
{        
    public Temp()
    {
        setCommandClass(ValidationForm.class);
        setCommandName("validationForm");
    }

    @Override
    protected ModelAndView onSubmit(HttpServletRequest request, HttpServletResponse response, Object command, BindException errors) throws Exception
    {
        ValidationBean validationBean=(ValidationBean) command;
        ModelAndView mv=new ModelAndView("Temp", "validationForm", validationBean);
        if(errors.hasErrors())
        {
            System.out.println("error");
        }
        else
        {
            System.out.println("name = "+validationBean.getUserName());
        }
        return mv;
    }        

    @Override
    protected ModelAndView showForm(HttpServletRequest request, HttpServletResponse response, BindException errors) throws Exception
    {
        ModelAndView mv=new ModelAndView("Temp", "validationForm", errors.getTarget());
        return mv;
    }
} 
```

There is no question about form-validation. It works fine. The only question here is that when I use the `showForm(...){...}` method as shown above, the error messages are not displayed because this method calls when the JSP page is loaded and also, after the `onSubmit()` method completes (In case, the page is submitted by clicking the submit button on the JSP page).

When the page is submitted by clicking the submit button, the command object which is `errors.getTarget()` (or `getCommand(request)`) in the `showForm()` method (which is called after the `onSubmit()` method) contains no error messages to be displayed on the page. The command object (or domain object) is different from the command object in the `onSubmit()` method. (and therefore, when the `showForm()` method is commented out, it displays error messages)

I need to use the `showForm()` method to display a list of data from the database when the page is either submitted or loaded.

Of course, the `referenceData()` method as shown below does the trick.

```
protected Map referenceData(HttpServletRequest request, Object command, Errors errors) throws Exception
{    
    Map map=new HashMap();
    return map;
} 
```

but I want to stick at the `showForm()` method. Is there a fair way to display error messages while using the `showForm()` method while validating a form?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T02:57:18.520

在您的客户端，您可以使用错误对象的内容以及表单来显示错误。请注意 onSubmit() 和 showForm() 在 spring 3.0 中已弃用。

```
@SuppressWarnings("deprecation") 
final public class Temp extends SimpleFormController 
{         
    public Temp() 
    { 
        setCommandClass(ValidationForm.class); 
        setCommandName("validationForm"); 
    } 

    @Override 
    protected ModelAndView onSubmit(HttpServletRequest request, HttpServletResponse response, Object command, BindException errors) throws Exception 
    { 
        ValidationBean validationBean=(ValidationBean) command; 
        ModelAndView mv=new ModelAndView("Temp", "validationForm", validationBean); 
        if(errors.hasErrors()) 
        { 
            System.out.println("error"); 
            errors.reject("error.server.error");
            return showForm(request, response, errors);
        } 
        else 
        { 
            System.out.println("name = "+validationBean.getUserName()); 
        } 
        return mv; 
    }         

    @Override 
    protected ModelAndView showForm(HttpServletRequest request, HttpServletResponse response, BindException errors) throws Exception 
    { 
        ModelAndView mv=new ModelAndView("Temp", "validationForm", errors.getTarget()); 
        return mv; 
    } 
} 
```

**示例 JSP 代码：**

例如在 jsp 中，如果您需要显示错误消息，您可以使用如下：

```
<span class="error">${error}</span> 
```

error 是我们需要在 spring 中设置的属性。

# php - PHP Issue with deleting from MySQL

> ID：11278820
> 
> 赞同：0
> 
> 时间：2012-07-01T00:56:48.773
> 
> 标签：php

I do have programming experience, but new to php. I do have an issue with an example I was doing from this tutorial. I looked over it millions of times, googled, ect ect. I don't have an idea why my code isnt working.

The purpose is to basically just test inserting and deleting in sql from php, using a button for Add Record and Delete Record. The Add record button works perfectly, but delete doesnt do a thing other than reload the page. Heres the code...

```
<?php // sqltest.php

require_once 'login.php';

$db_server = mysql_connect($db_hostname, $db_username, $db_password);

if (!$db_server) die("Unable to connect to MySQL: " . mysql_error());

mysql_select_db($db_database, $db_server)
     or die("Unable to select database: " . mysql_error());

if (isset($_POST['author'])   &&
    isset($_POST['title'])    &&
    isset($_POST['type'])     &&
    isset($_POST['year'])      &&
    isset($_POST['isbn']))
{
    $author = get_post('author');
    $title = get_post('title');
    $type = get_post('type');
    $year = get_post('year');
    $isbn = get_post('isbn');

    if (isset($_POST['delete']) && $isbn != "")
    {
        echo "worked!!!!!!!!!!!!!!"; 
        $query = "DELETE FROM classics WHERE isbn='$isbn'";
        $result = mysql_query($query) or die(mysql_error());
        if(mysql_affected_rows($result) > 0) echo 'user deleted';

        //if (!mysql_query($query, $db_server))
        //echo "DELETE failed: $query" . mysql_error();
    }
    else
    {
        echo "nooooooooooooooooooo";
        $query = "INSERT INTO classics VALUES" .
        "('$author', '$title', '$type', '$year', '$isbn')";
        if (!mysql_query($query, $db_server)) 
        {
            echo "INSERT failed: $query" . mysql_error();
        }
    }
}

echo <<<_END
<form action="sqltest.php" method="post"><pre>
Author <input type="text" name="author" />
Title  <input type="text" name="title" />
Type   <input type="text" name="type" />
Year   <input type="text" name="year" />
ISBN   <input type="text" name="isbn" />
<input type='submit' value='ADD RECORD' />
</pre></form>
_END;

$query = "SELECT * FROM classics";

$result = mysql_query($query);

if (!$result) die ("Database access failed: " . mysql_error());

$rows = mysql_num_rows($result);

for ($j = 0 ; $j < $rows ; ++$j)
{
        $row = mysql_fetch_row($result);

echo <<<_END
<pre>
Author $row[0]
Title $row[1]
Type $row[2]
Year $row[3]
ISBN $row[4]
<form action="sqltest.php" method="post">
<input type="hidden" name="delete" value="yes" />
<input type="hidden" name='isbn' value="$row[4]" />
<input type='submit' value='DELETE RECORD' />
</form>
</pre>
_END;
}

mysql_close($db_server);

function get_post($var)
{
    return mysql_real_escape_string($_POST[$var]);
}

?> 
```

I have looked over this many times, still no idea why this won't work. Is it the for loop that is making this button not work? Note, you will see echo "worked!!!"; and in the else echo "noooooooo"; that was for me to test whether the button was being tested, yet nothing prints. So maybe i missed something in the button code itself? Also, no errors are printed, and my editor (and myself) have missed the syntax error (if thats the case).

The code for the delete button is at the end, before I closed the DB.

Thanks for your help in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T01:03:24.707

你的问题是你的第一个`if`障碍。

您正在检查是否存在已发布的变量`author` `title` `type` `year` `isbn`。而在您的删除代码中，发送的唯一变量是`delete`和`isbn`。因此第一个`if`块完全丢失（包括删除代码）。

您需要将您的第一个修改`if`为`if(isset($_POST)) { // a form has been posted`. 然后它应该工作。

另一种方法：

```
if(isset($_POST['delete']) && isset($_POST['isbn']) && !empty($_POST['isbn'])){
    //delete code here
}

if(isset($_POST['author']) && isset($_POST['title']) && isset....){
    // insert code here
} 
```

编辑：重写代码：

```
<?php // sqltest.php

// I don't know what's in here, so I've left it
require_once 'login.php';

$db_server = mysql_connect($db_hostname, $db_username, $db_password);

if (!$db_server) die("Unable to connect to MySQL: " . mysql_error());

mysql_select_db($db_database, $db_server)
     or die("Unable to select database: " . mysql_error());

if (isset($_POST))
{

    if (isset($_POST['delete']) && !empty($_POST['isbn']))
    {
        echo "Deleting"; 
        $query = "DELETE FROM classics WHERE isbn='".mysql_real_escape_string($_POST['isbn'])."'";
        $result = mysql_query($query) or die(mysql_error());
        if(mysql_affected_rows($result) > 0) echo 'user deleted';
    }
    else
    {
        echo "Inserting";
        $query = "INSERT INTO classics VALUES ('".mysql_real_escape_string($_POST['author'])."', '".mysql_real_escape_string($_POST['title'])."', '".mysql_real_escape_string($_POST['type'])."', '".mysql_real_escape_string($_POST['year'])."', '".mysql_real_escape_string($_POST['isbn'])."')";
        if (!mysql_query($query)) 
        {
            echo "INSERT failed: $query" . mysql_error();
        }
    }
}

// you don't need echo's here... just html
?>

<form action="sqltest.php" method="post">
    <pre>
        Author <input type="text" name="author" />
        Title  <input type="text" name="title" />
        Type   <input type="text" name="type" />
        Year   <input type="text" name="year" />
        ISBN   <input type="text" name="isbn" />
        <input type='submit' value='ADD RECORD' />
    </pre>
</form>

<?php

$query = "SELECT * FROM classics";

$result = mysql_query($query);

if (!$result) die ("Database access failed: " . mysql_error());

// a better way to do this:
while($row = mysql_fetch_array($result)){
?>

<pre>
    Author <?php echo $row[0]; ?>
    Title <?php echo $row[1]; ?>
    Type <?php echo $row[2]; ?>
    Year <?php echo $row[3]; ?>
    ISBN <?php echo $row[4]; ?>
    <form action="sqltest.php" method="post">
        <input type="hidden" name="delete" value="yes" />
        <input type="hidden" name='isbn' value="<?php echo $row[4]; ?>" />
        <input type='submit' value='DELETE RECORD' />
    </form>
</pre>

<?php
}

mysql_close($db_server);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-12T17:51:56.510

验证您在表单中使用的方法。确保它是这样的 POST：

形式`action="yourpage.php" method="POST"`

在上面的代码中，替换以下内容：

```
$author = get_post('author');
    $title = get_post('title');
    $type = get_post('type');
    $year = get_post('year');
    $isbn = get_post('isbn'); 
```

和

```
$author = $_POST['author'];
$title = $_POST['title'];
$type = $_POST['type'];
$year = $_POST['year'];
$isbn = $_POST['isbn']; 
```

最后，没有必要再次检查是否`$isbn`不为空，就像您在`isset()`方法中所做的那样。`$isbn!=""`所以在下面的 if 中删除：

```
if (isset($_POST['delete']) && $isbn != "")
    {
} 
```

变成：

```
if (isset($_POST['delete']))
    {
} 
```

由于您正在测试，因此检查用户是否单击了删除按钮并不那么重要。因此，您也可以暂时删除它，稍后再添加，因为您确信在单击删除按钮后可以访问该代码。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-01T01:01:43.370

您没有名为 的表单字段`delete`，因此永远不可能采用您的删除代码路径。

我猜您正在尝试使用提交按钮的值来决定要做什么？在这种情况下，您还缺少`name`提交按钮上的属性 - 没有它，它无法使用表单提交任何值。你可能想要：

```
<input type="submit" name="submit" value="DELETE RECORD" /> 
```

然后有

```
if (isset($_POST['submit']) && ($_POST['submit'] == 'DELETE RECORD')) {
   ...
} 
```

# python - 我在谷歌应用引擎中找不到使用他们的注册 api 从 facebook 发送的签名请求

> ID：11278831
> 
> 赞同：-1
> 
> 时间：2012-07-01T00:59:39.330
> 
> 标签：python, facebook, google-app-engine, request, signed

我真的很困惑，因为文档指出，当用户使用 facebook 注册表单从我的网站注册时，我应该收到签名的请求。我不知道在哪里寻找它。任何答复将不胜感激。我在 Google App Engine 中使用 Python，我只是想用 facebook 设置用户身份验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:45:30.350

我正在使用 AppEngine+python 和 Facebook 身份验证。我想我的代码会对你有所帮助。

[https://github.com/hanasoo/vis-asq/tree/master/apps/auth](https://github.com/hanasoo/vis-asq/tree/master/apps/auth)

# php - 如何重定向到启动页面并允许图像在 .htacess 规则中显示？

> ID：11278834
> 
> 赞同：0
> 
> 时间：2012-07-01T01:01:05.830
> 
> 标签：php, wordpress, apache, .htaccess

我正在使用以下 .htaccess 规则将我网站的所有页面重定向到启动页面。但是，应该在启动页面上的图像没有显示。如何添加到此规则以允许显示图像？如果这不是在这种情况下使用的最佳方法，请更正以下规则。

```
RewriteEngine On

# temp redirect
Options +FollowSymLinks
RewriteCond %{REQUEST_URI} !/index.html$ [NC]
RewriteRule .* /index.html [R,L]` 
```

那么这是正确的方法吗？

```
RewriteEngine On
# temp redirect
Options +FollowSymLinks  
RewriteCond %{REQUEST_URI} !/coming-soon.html$ [NC]
RewriteCond %{REQUEST_URI} !\.(gif|jpg|png)$
RewriteRule .* /coming-soon.html [R,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:26:12.933

您可以忽略以 .gif .jpg .png 结尾的文件

```
RewriteCond %{REQUEST_URI} !\.(gif|jpg|png)$ 
```

# ruby-on-rails - 使用 Ruby on Rails 的大型电子商务工作量？

> ID：11278835
> 
> 赞同：0
> 
> 时间：2012-07-01T01:01:18.897
> 
> 标签：ruby-on-rails, ruby, e-commerce

我的任务是为零售商建立一个大型电子商务网站。我们正在为此使用打包软件。该包难以定制且不灵活，但它可以在经过可靠测试的 Java 应用程序上扩展。

不过，在后台，我一直在考虑尝试将其用作参考工作负载来构建自定义 Ruby on Rails 电子商务应用程序 - 只是为了兴趣和学习框架。但在我开始走得太远之前，我想我正在寻找一个高水平的决心，即是否有可能使用 ROR 达到这种类型的工作负载。

该应用程序必须每小时捕获大约 2000 个订单，但每个订单都很大，因此每小时将处理大约 140,000 个订单项。并发客户相对简单，每小时约有 5,000 名活跃客户。但是浏览到商店的比例很高，大约 45% 的客户到该网站购物，因此大部分处理是订单捕获，而不是大多数网站的搜索和浏览。

所以我的问题是，对于 ROR，什么是“大工作量”？这是满足 ROR 应用程序的可行 NFR 吗？我应该考虑什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T01:34:53.693

实际上，作为一个 Web 框架，RoR 并没有对工作负载限制施加任何限制。

工作负载限制取决于：

1.  服务请求的机器数量
2.  业务逻辑的复杂性，决定了单机的工作负载限制
3.  带宽或数据库磁盘 I/O 是否存在瓶颈？

# python - 通过 Scipy 和 Numpy 使用 Python 将数据拟合到 ODE 系统

> ID：11278836
> 
> 赞同：10
> 
> 时间：2012-07-01T01:01:28.403
> 
> 标签：python, numpy, scipy, differential-equations, data-fitting

我在通过 Scipy 和 Numpy 将我的 MATLAB 代码翻译成 Python 时遇到了一些麻烦。我被困在如何为我的 ODE 系统找到最佳参数值（k0 和 k1）以适应我观察到的十个数据点。我目前对 k0 和 k1 有一个初步的猜测。在 MATLAB 中，我可以使用名为“fminsearch”的函数，该函数采用 ODE 系统、观察到的数据点和 ODE 系统的初始值。然后它将计算一对新的参数 k0 和 k1 将适合观察到的数据。我已经包含了我的代码，看看您是否可以帮助我实现某种“fminsearch”来找到适合我的数据的最佳参数值 k0 和 k1。我想将任何代码添加到我的 lsqtest.py 文件中。

我有三个 .py 文件 - ode.py、lsq.py 和 lsqtest.py

ode.py：

```
def f(y, t, k): 
return (-k[0]*y[0],
      k[0]*y[0]-k[1]*y[1],
      k[1]*y[1]) 
```

lsq.py：

```
import pylab as py
import numpy as np
from scipy import integrate
from scipy import optimize
import ode
def lsq(teta,y0,data):
    #INPUT teta, the unknowns k0,k1
    # data, observed 
    # y0 initial values needed by the ODE
    #OUTPUT lsq value

    t = np.linspace(0,9,10)
    y_obs = data #data points
    k = [0,0]
    k[0] = teta[0]
    k[1] = teta[1]

    #call the ODE solver to get the states:
    r = integrate.odeint(ode.f,y0,t,args=(k,))

    #the ODE system in ode.py
    #at each row (time point), y_cal has
    #the values of the components [A,B,C]
    y_cal = r[:,1] #separate the measured B
    #compute the expression to be minimized:
    return sum((y_obs-y_cal)**2) 
```

lsqtest.py：

```
import pylab as py
import numpy as np
from scipy import integrate
from scipy import optimize
import lsq

if __name__ == '__main__':

    teta = [0.2,0.3] #guess for parameter values k0 and k1
    y0 = [1,0,0] #initial conditions for system
    y = [0.000,0.416,0.489,0.595,0.506,0.493,0.458,0.394,0.335,0.309] #observed data points
    data = y
    resid = lsq.lsq(teta,y0,data)
    print resid 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-03-28T15:31:53.350

对于这些类型的拟合任务，您可以使用 package [`lmfit`](https://lmfit.github.io/lmfit-py/)。拟合的结果如下所示；如您所见，数据复制得非常好：

[![在此处输入图像描述](../Images/8c34b909d1c56be7191e99b5002231b9.png)](https://i.stack.imgur.com/gtU4w.png)

现在，我固定了初始浓度，如果你愿意，你也可以将它们设置为变量（只需删除`vary=False`下面代码中的）。你得到的参数是：

```
[[Variables]]
    x10:   5 (fixed)
    x20:   0 (fixed)
    x30:   0 (fixed)
    k0:    0.12183301 +/- 0.005909 (4.85%) (init= 0.2)
    k1:    0.77583946 +/- 0.026639 (3.43%) (init= 0.3)
[[Correlations]] (unreported correlations are <  0.100)
    C(k0, k1)                    =  0.809 
```

重现情节的代码如下所示（一些解释可以在内联注释中找到）：

```
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint
from lmfit import minimize, Parameters, Parameter, report_fit
from scipy.integrate import odeint

def f(y, t, paras):
    """
    Your system of differential equations
    """

    x1 = y[0]
    x2 = y[1]
    x3 = y[2]

    try:
        k0 = paras['k0'].value
        k1 = paras['k1'].value

    except KeyError:
        k0, k1 = paras
    # the model equations
    f0 = -k0 * x1
    f1 = k0 * x1 - k1 * x2
    f2 = k1 * x2
    return [f0, f1, f2]

def g(t, x0, paras):
    """
    Solution to the ODE x'(t) = f(t,x,k) with initial condition x(0) = x0
    """
    x = odeint(f, x0, t, args=(paras,))
    return x

def residual(paras, t, data):

    """
    compute the residual between actual data and fitted data
    """

    x0 = paras['x10'].value, paras['x20'].value, paras['x30'].value
    model = g(t, x0, paras)

    # you only have data for one of your variables
    x2_model = model[:, 1]
    return (x2_model - data).ravel()

# initial conditions
x10 = 5.
x20 = 0
x30 = 0
y0 = [x10, x20, x30]

# measured data
t_measured = np.linspace(0, 9, 10)
x2_measured = np.array([0.000, 0.416, 0.489, 0.595, 0.506, 0.493, 0.458, 0.394, 0.335, 0.309])

plt.figure()
plt.scatter(t_measured, x2_measured, marker='o', color='b', label='measured data', s=75)

# set parameters including bounds; you can also fix parameters (use vary=False)
params = Parameters()
params.add('x10', value=x10, vary=False)
params.add('x20', value=x20, vary=False)
params.add('x30', value=x30, vary=False)
params.add('k0', value=0.2, min=0.0001, max=2.)
params.add('k1', value=0.3, min=0.0001, max=2.)

# fit model
result = minimize(residual, params, args=(t_measured, x2_measured), method='leastsq')  # leastsq nelder
# check results of the fit
data_fitted = g(np.linspace(0., 9., 100), y0, result.params)

# plot fitted data
plt.plot(np.linspace(0., 9., 100), data_fitted[:, 1], '-', linewidth=2, color='red', label='fitted data')
plt.legend()
plt.xlim([0, max(t_measured)])
plt.ylim([0, 1.1 * max(data_fitted[:, 1])])
# display fitted statistics
report_fit(result)

plt.show() 
```

如果您有其他变量的数据，您可以简单地更新函数`residual`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T14:42:04.830

以下对我有用：

```
import pylab as pp
import numpy as np
from scipy import integrate, interpolate
from scipy import optimize

##initialize the data
x_data = np.linspace(0,9,10)
y_data = np.array([0.000,0.416,0.489,0.595,0.506,0.493,0.458,0.394,0.335,0.309])

def f(y, t, k): 
    """define the ODE system in terms of 
        dependent variable y,
        independent variable t, and
        optinal parmaeters, in this case a single variable k """
    return (-k[0]*y[0],
          k[0]*y[0]-k[1]*y[1],
          k[1]*y[1])

def my_ls_func(x,teta):
    """definition of function for LS fit
        x gives evaluation points,
        teta is an array of parameters to be varied for fit"""
    # create an alias to f which passes the optional params    
    f2 = lambda y,t: f(y, t, teta)
    # calculate ode solution, retuen values for each entry of "x"
    r = integrate.odeint(f2,y0,x)
    #in this case, we only need one of the dependent variable values
    return r[:,1]

def f_resid(p):
    """ function to pass to optimize.leastsq
        The routine will square and sum the values returned by 
        this function""" 
    return y_data-my_ls_func(x_data,p)
#solve the system - the solution is in variable c
guess = [0.2,0.3] #initial guess for params
y0 = [1,0,0] #inital conditions for ODEs
(c,kvg) = optimize.leastsq(f_resid, guess) #get params

print "parameter values are ",c

# fit ODE results to interpolating spline just for fun
xeval=np.linspace(min(x_data), max(x_data),30) 
gls = interpolate.UnivariateSpline(xeval, my_ls_func(xeval,c), k=3, s=0)

#pick a few more points for a very smooth curve, then plot 
#   data and curve fit
xeval=np.linspace(min(x_data), max(x_data),200)
#Plot of the data as red dots and fit as blue line
pp.plot(x_data, y_data,'.r',xeval,gls(xeval),'-b')
pp.xlabel('xlabel',{"fontsize":16})
pp.ylabel("ylabel",{"fontsize":16})
pp.legend(('data','fit'),loc=0)
pp.show() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-05T10:39:34.987

```
 # cleaned up a bit to get my head around it - thanks for sharing 
    import pylab as pp
    import numpy as np
    from scipy import integrate, optimize

    class Parameterize_ODE():
        def __init__(self):
            self.X = np.linspace(0,9,10)
            self.y = np.array([0.000,0.416,0.489,0.595,0.506,0.493,0.458,0.394,0.335,0.309])
            self.y0 = [1,0,0] # inital conditions ODEs
        def ode(self, y, X, p):
            return (-p[0]*y[0],
                     p[0]*y[0]-p[1]*y[1],
                               p[1]*y[1])
        def model(self, X, p):
            return integrate.odeint(self.ode, self.y0, X, args=(p,))
        def f_resid(self, p):
            return self.y - self.model(self.X, p)[:,1]
        def optim(self, p_quess):
            return optimize.leastsq(self.f_resid, p_guess) # fit params

    po = Parameterize_ODE(); p_guess = [0.2, 0.3] 
    c, kvg = po.optim(p_guess)

    # --- show ---
    print "parameter values are ", c, kvg
    x = np.linspace(min(po.X), max(po.X), 2000)
    pp.plot(po.X, po.y,'.r',x, po.model(x, c)[:,1],'-b')
    pp.xlabel('X',{"fontsize":16}); pp.ylabel("y",{"fontsize":16}); pp.legend(('data','fit'),loc=0); pp.show() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T01:12:04.127

看看`scipy.optimize` [模块](http://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html)。该`minimize`函数看起来与 非常相似`fminsearch`，我相信两者基本上都使用单纯形算法进行优化。

# jquery - 检查单击的元素是否没有特定的类

> ID：11278837
> 
> 赞同：10
> 
> 时间：2012-07-01T01:01:30.803
> 
> 标签：jquery

如果单击的 li 元素没有照片类别，我正在尝试创建一个运行代码的 if 语句。

```
$('div.menu li').click(function(){
    var content = $(this).attr('class');
    if (/* I can't figure out the correct syntax that goes here? */){
        $("div.content_wrapper, div.content").hide();
        $('div.content_wrapper').animate({width: 'toggle'});
        $('div.content_wrapper, div.' + content).show();
        $('div.menu li').removeClass('menuactive');
        $(this).addClass('menuactive');
    }
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-01T01:04:03.537

只需使用 jQuery 的`.is`：

```
if(!$(this).is('.some-class')) { // ... 
```

或者，如果您愿意，可以`.hasClass`：

```
if(!$(this).hasClass('some-class')) { // ... 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-01T01:03:59.423

使用[`:not`选择器](http://api.jquery.com/not-selector/)：

```
$("div.menu li:not(.photo)").click(function(){
    $("div.content_wrapper, div.content").hide();
    $("div.content_wrapper").animate({width: "toggle"});
    $("div.content_wrapper, div." + content).show();
    $("div.menu li").removeClass("menuactive");
    $(this).addClass("menuactive");
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T01:04:57.030

```
if(!$(this).hasClass('className')) {
    // clicked element does not have the class
} 
```

# php - XMLHttpRequest 在 FireFox 中工作，而不是 Safari

> ID：11278838
> 
> 赞同：1
> 
> 时间：2012-07-01T01:01:39.363
> 
> 标签：php, javascript, html, xmlhttprequest

我的 Mac 上有一个帐户数据库，在单击删除按钮后使用 HTML、Javascript 和 PHP 删除帐户。它在 FireFox 中每次都有效，在 Safari 中每次都失败（失败意味着删除请求被完全忽略）。

本质上，这就是我的代码正在做的事情......

1.  表单内的按钮`onclick`调用一个 js 函数`verifyDelete()`，要求我验证我选择删除
2.  接下来，`onsubmit`from同一个表单调用一个js func`delAccount()`
3.  最后，`delAccount()`使用`XMLHttpRequest`调用php页面删除账号

我`XMLHttpRequest`从查看 AJAX 中得到了使用的想法。我不需要 AJAX 使用的所有 ReadyState、Response 等，所以我只使用了我需要的东西。做我在`delAccount()`函数中所做的事情是否“合法”？也许这就是 Safari 失败的原因？

任何帮助表示赞赏，这是我的代码...

文件 - View.php

```
<?php
    // some code
?>
        <form method="get" onsubmit="return delAccount('<?php echo $acctNum; ?>')">
            <input type="hidden" name="acctName" value="Blah” />
            <button onclick="return verifyDelete()" >Delete</button>
        </form>
<?php
    // some code
?> 
```

文件-common.js

```
function verifyDelete() {
    var r=confirm("Are you sure you want to Delete this?\r\n\n" +
        "A)  'Cancel' delete request\r\n" +
        "B)  'OK', delete\r\n");
    if (r == false) {
        return false;
    }
    else {
        return true;
    }
}

function delAccount (acctNum) {
    if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
        var xmlDelete = new XMLHttpRequest();
    }
    xmlDelete.open("GET", "delAcct.php?q=" + acctNum, true);
    xmlDelete.send(null);
    return false;
} 
```

文件 - delAcct.php

```
<?php
    // code to delete account
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:52:19.313

您没有取消表单的发送，因此可能会在发送 AJAX 请求之前提交表单（将卸载当前页面）。

修改调用`delAccount()`：

```
<form method="get" onsubmit="return delAccount('<?php echo $acctNum; ?>')"> 
```

并将其添加到末尾`delAccount()`

```
return false; 
```

...什么可以避免发送表格

还有什么：使用 GET 时，发送方法需要`null`作为参数

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-01T03:27:44.107

我忽略了一些东西。我只需要换成`true`...`false``XMLHttpRequest`

```
xmlDelete.open("GET", "delAcct.php?q=" + acctNum, false); 
```

我知道它使事件同步，但我真的不知道为什么这个工作而另一个没有。

# cordova - 电话间隙。应用更新时 Web SQL 数据库会发生什么情况？

> ID：11278841
> 
> 赞同：3
> 
> 时间：2012-07-01T01:01:53.043
> 
> 标签：cordova, web-sql

请原谅这个非常新手的问题，但我即将开始使用 Phonegap 进行我的第一个移动应用程序项目。我的项目将严重依赖 Web SQL 数据库。当我将来对应用程序进行更新时，我需要用户建立的数据库保持不变。我假设数据库包含在应用程序包中，当它们更新时，数据库会发生什么？新应用程序是否完全重置？

（我花了很长时间在谷歌上搜索，但没有找到我的查询的答案）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T14:54:25.130

它将保持原样（除了已经解决的 iOS 5.1 错误 - [https://issues.apache.org/jira/browse/CB-347](https://issues.apache.org/jira/browse/CB-347)）

您还可以通过升级模拟器或设备中的应用程序来测试和生成相同的场景并查看结果。

在这篇文章中查看更多详细信息 - [https://groups.google.com/forum/?fromgroups#!topic/phonegap/NhPTwzi4KnU](https://groups.google.com/forum/?fromgroups#!topic/phonegap/NhPTwzi4KnU)

# visual-studio-2010 - VS 2010 和 2012 的 TFS 工作区？

> ID：11278842
> 
> 赞同：38
> 
> 时间：2012-07-01T01:02:00.447
> 
> 标签：visual-studio-2010, tfs, visual-studio-2012, workspace

我目前正在使用 TFS 预览版在 Visual Studio 2012 RC 上进行源代码控制开发。我想创建一个 SSIS 集成项目，这需要我使用 Visual Studio 2010。但是，当我从 VS 2010 连接到 TFS 时，它会自动创建一个新工作区并且不会列出 VS 2012 工作区。

如果我`tf workspaces`从 VS 2010 命令提示符发出命令，我只会看到 VS 2010 工作区，如果我从 VS 2012 命令提示符发出命令，我只会看到 VS 2012 工作区（两者都表示正在使用相同的集合） .

有什么方法可以让 VS 2010 查看 VS 2012 工作区吗？我宁愿不必为了能够将 VS 2010 用于 SSIS 项目而拥有两份源代码副本。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-07-02T01:55:40.433

TFS 2012 引入了一个名为*local workspaces*的新概念，它与以前版本的 TFS 中的工作区行为略有不同（旧的默认行为现在称为*服务器工作区*。）本地工作区不需要只读文件，而是允许文件无需从服务器签出即可进行编辑，它们旨在更适合中小型工作空间。因此，本地工作区是TFS 2012*中的默认设置。*

但是，本地工作区与 TFS 2010*不*兼容，并且 TFS 2010 客户端将无法使用新的本地工作区。

您可以将使用 VS 2012 客户端创建的工作区转换为服务器工作区。在 Edit Workspace 对话框中，选择 Advanced，您可以将类型从 Local 更改为 Server 工作区。

此时，您应该能够连接 VS 2010 并选择该 TFS 工作区。

（请注意，使用它是不够的，`tf workspaces`因为它会返回工作区列表的缓存副本 - 您需要使用 Visual Studio 2010 或使用与`tf.exe`服务器对话的命令连接到服务器。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-14T17:19:05.080

除了其他答案/评论中提到的 Location="Server" 属性外，File Time 属性必须为“Current”，如下所示。

在 Visual Studio 2012/2013 中**使用**Location="Local"**或**File Time="Checkin" 创建的工作区在 Visual Studio 2010 中不可见/不可用。

![在此处输入图像描述](../Images/166ed0e69778f478790ed2eac57a5b69.png)

# java - Eclipse RCP - 如何灰显依赖首选项？

> ID：11278843
> 
> 赞同：0
> 
> 时间：2012-07-01T01:02:11.577
> 
> 标签：java, eclipse-rcp, preferences

如何在 Eclipse RCP 中灰显依赖首选项？
偏好是否可以以某种方式定义为依赖于另一个偏好，以便它们显示为灰色，如果它依赖的偏好 - 被禁用？ ![优先](../Images/c778bb92e069c3108c44a3ffda3d80f5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T16:22:44.317

由于首选项只是您可以调用的 SWT 控件

```
setEnabled(false) 
```

方法来禁用（灰显）它们。在 FieldEditorPreferencePage 的情况下，您可能应该调用

```
***FieldEditor.setEnabled(false, getFieldEditorParent()); 
```

# android - 试图显示 ListFragment

> ID：11278852
> 
> 赞同：0
> 
> 时间：2012-07-01T01:03:57.630
> 
> 标签：android, android-listfragment

我正在尝试显示一个 ListFragment。我想我已经正确设置了一切，但无论我尝试什么，我都会得到一个 RuntimeException：无法启动 Activity。我已经搜索和调试了几天，还没有想出答案。这是我到目前为止的代码。任何帮助将不胜感激。

下面是启动 Activity 的方法：

```
private void populateList(ArrayList<String> list) {
    Intent intent = new Intent(this, TipListActivity.class);
    intent.putStringArrayListExtra(INTENT_KEY, list);
    startActivity(intent);
} 
```

这是上一个方法启动的Activity：

```
public class TipListActivity extends FragmentActivity {

    /*************** FIELDS ***************************/

    ArrayList<String> arrayList;

    /*************** OVERRIDDEN METHODS ***************/

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tip_list_fragment_activity);

        Intent intent = getIntent();
        arrayList = intent.getStringArrayListExtra(TipActivity.INTENT_KEY);
    }
} 
```

这是tip_list_fragment_activity.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <fragment
        android:name=".TipListFragment"
        android:id="@+id/fragment_activity"
        android:layout_weight="1"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
```

这是提示列表片段：

```
public class TipListFragment extends ListFragment {
    @Override
    public void onCreate (Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        ArrayAdapter<String> myListAdapter = new ArrayAdapter<String>(getActivity(),
            android.R.layout.simple_list_item_1, new TipListActivity().arrayList);

        setListAdapter(myListAdapter);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle 
        savedInstanceState) {

    return inflater.inflate(R.layout.list_fragment, container, false);
    }
} 
```

最后是 list_fragment.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:orientation="vertical"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:paddingLeft="8dp"
     android:paddingRight="8dp">

 <ListView android:id="@+id/list"
           android:layout_width="match_parent"
           android:layout_height="match_parent"
           android:layout_weight="1"
           android:drawSelectorOnTop="false"/>

 <TextView android:id="@+id/textv"
           android:layout_width="match_parent"
           android:layout_height="match_parent"
           android:text="@string/app_name"/>
</LinearLayout> 
```

这是堆栈跟踪：

07-01 00:41:37.932: E/AndroidRuntime(6083): 致命异常: main 07-01 00:41:37.932: E/AndroidRuntime(6083): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com. app.tipcalculator/com.app.tipcalculator.TipListActivity}：android.view.InflateException：二进制 XML 文件第 7 行：膨胀类片段时出错

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.ActivityThread.access$600(ActivityThread.java:123)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.os.Handler.dispatchMessage(Handler.java:99)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.os.Looper.loop(Looper.java:137) 07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android. app.ActivityThread.main(ActivityThread.java:4424)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 java.lang.reflect.Method.invokeNative(Native Method)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 java.lang.reflect.Method.invoke(Method.java:511)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)

07-01 00:41:37.932: E/AndroidRuntime(6083): at dalvik.system.NativeStart.main(Native Method)

07-01 00:41:37.932：E/AndroidRuntime(6083)：原因：android.view.InflateException：二进制 XML 文件第 7 行：膨胀类片段时出错

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:697)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.view.LayoutInflater.rInflate(LayoutInflater.java:739)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.view.LayoutInflater.inflate(LayoutInflater.java:489)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.view.LayoutInflater.inflate(LayoutInflater.java:396)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.view.LayoutInflater.inflate(LayoutInflater.java:352)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:251)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.Activity.setContentView(Activity.java:1835)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 com.app.tipcalculator.TipListActivity.onCreate(TipListActivity.java:28)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.Activity.performCreate(Activity.java:4465)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)

07-01 00:41:37.932: E/AndroidRuntime(6083): ... 11 更多 07-01 00:41:37.932: E/AndroidRuntime(6083): 由: android.support.v4.app.Fragment$ InstantiationException：无法实例化片段。TipListFragment：确保类名存在，是公共的，并且有一个公共的空构造函数

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.support.v4.app.Fragment.instantiate(Fragment.java:391)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.support.v4.app.Fragment.instantiate(Fragment.java:359)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:262)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:669)

07-01 00:41:37.932: E/AndroidRuntime(6083): ... 21 更多 07-01 00:41:37.932: E/AndroidRuntime(6083): 由: java.lang.ClassNotFoundException: .TipListFragment

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:501)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:461)

07-01 00:41:37.932: E/AndroidRuntime(6083): 在 android.support.v4.app.Fragment.instantiate(Fragment.java:381)

07-01 00:41:37.932: E/AndroidRuntime(6083): ... 24 更多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:48:45.043

您没有为您的列表使用正确的 ID。你有`android:id="@+id/list"`.

ListFragment 正在寻找一个非常具体的 id。

```
android:id="@android:id/list" 
```

进行更改，您应该会看到应用程序行为的改进。

您也可以将您的代码移动到`onCreate`中。`TipListFragment``onActivityCreated`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T20:23:31.213

以前没做过，刚刚注册，我的两便士值是你似乎不能在 xml 布局中使用“.NAME”，错误指出你在 xml 中的第 7 行：

```
07-01 00:41:37.932: E/AndroidRuntime(6083): Caused by: android.view.InflateException: Binary XML file line #7: Error inflating class fragment 
```

大约在这条线上：

```
android:name=".TipListFragment" 
```

无论您的包裹是什么，它都应该是完整的：

```
android:name="com.all.bits.required.TipListFragment" 
```

Android Dev 使用全命名，以[http://developer.android.com/guide/components/fragments.html#Adding](http://developer.android.com/guide/components/fragments.html#Adding)为例：

```
<fragment android:name="com.example.news.ArticleListFragment"... 
```

不确定这对您有多大帮助，但至少会进入下一个错误，如果有的话:)

干杯

杰克

# erlang - 使用 make 编译 LFE 文件

> ID：11278857
> 
> 赞同：2
> 
> 时间：2012-07-01T01:04:27.700
> 
> 标签：erlang, makefile, lfe

是否有从OTP 项目中`.lfe`的规则编译源文件的标准方法？`make`

根据文档，我应该使用`lfe_comp:file/1`，如果我想在 OTP 应用程序中编译多个此类文件（我应该将源文件保存在 中`src`，但二进制文件保存在 中`ebin`），这并没有多大帮助。

理想情况下，我可以做类似的事情

```
erlc -Wf -o ebin src/*lfe 
```

但是好像没有`lfe`支持`erlc`。我能想到的最佳解决方案是

```
find src/*lfe -exec erl -s lfe_comp file {} -s init stop \;
mv src/*beam ebin/ 
```

但这似乎不优雅。有更好的想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T05:12:41.260

根据 rvirding 的建议，这`lfec`是我在上面想要做的第一次尝试（几乎没有别的）。我会从`Makefile`with调用它`./lfec -o ebin src/*lfe`。

```
#!/usr/bin/env escript
%% -*- erlang -*-
%%! -smp enable -sname lfec -mnesia debug verbose
main(Arguments) ->
    try
        {Opts, Args} = parse_opts(Arguments),
        case get_opt("-o", Opts) of
            false ->
               lists:map(fun lfe_comp:file/1, Args);
            Path ->
               lists:map(fun (Arg) -> lfe_comp:file(Arg, [{outdir, Path}]) end,
                         Args)
        end
    catch
        _:_ -> usage()
    end;
main(_) -> usage().

get_opt(Target, Opts) -> 
    case lists:keyfind(Target, 1, Opts) of
        false -> false;
        {_} -> true;
        {_, Setting} -> Setting
    end.

parse_opts(Args) -> parse_opts(Args, []).
parse_opts(["-o", TargetDir | Rest], Opts) ->
    parse_opts(Rest, [{"-o", TargetDir} | Opts]);
parse_opts(Args, Opts) -> {Opts, Args}.

usage() ->
    io:format("usage:\n"),
    io:format("-o [TargetDir] -- output files to specified directory\n"),
    halt(1). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T01:23:30.247

并不真地。OTP 不支持 LFE，因此`erlc`不了解`.lfe`文件。据我所知，没有办法“打开” erlc 并动态添加如何处理文件的信息。另一种方法是为此编写`lfec`脚本。我会考虑的。

就像一个有趣的问题一样，使用 LFE 是为了什么？

# php - mysql显示数据库数据

> ID：11278862
> 
> 赞同：-1
> 
> 时间：2012-07-01T01:05:15.753
> 
> 标签：php, mysql, arrays, comments

我正在尝试从我的数据库中在我的网站上显示评论。我知道我的连接正常，如 $test 所示（显示“Array”）。

如何将数组转换为可用信息？这是我最好的镜头，但它没有显示任何内容：

```
<?php
$connect;

$sql_get_topic_info = "SELECT * FROM wall ORDER BY time ASC"; 
$res_get_comments_info = mysql_query($sql_get_comments_info); 
$num_get_comments_info = mysql_numrows($res_get_comments_info); 
$test = mysql_fetch_array(mysql_query($sql_get_topic_info)); //just to make sure the connection is working
echo $test; //displays "Array"

//Runs comment loop 
$i=0; 
while ($i < $num_get_comments_info) { 

$sel_comments_info_time = mysql_result($res_get_comments_info,$i,"time"); 
$sel_comments_info_message = mysql_result($res_get_comments_info,$i,"message"); 
$sel_comments_info_company = mysql_result($res_get_comments_info,$i,"company"); 

echo "<li>Company: $sel_comments_info_company<br/>"; 
echo "Comment: $sel_comments_info_message <br/>";
echo "$sel_comments_info_time"; 
echo "</li>"; 

$i++; 
} 
?> 
```

更新的脚本：（来自下面的答案）

```
$result = mysql_query("SELECT company, message FROM wall");

while ($row = mysql_fetch_array($result, MYSQL_BOTH)) {
printf ("company: %s  message: %s", $row["company"], $row["message"]);
}

mysql_free_result($result); 
```

打印：

```
company: company 1 message: message 1company: company 2 message: message 2company: company 3 message: message 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:07:29.807

不鼓励使用 of `mysql_`，您应该改用[`mysqli_`](http://www.php.net/manual/en/book.mysqli.php)函数。

从[`mysql_fetch_array`](http://php.net/manual/en/function.mysql-fetch-array.php)文档：

```
$result = mysql_query("SELECT id, name FROM mytable");

while ($row = mysql_fetch_array($result, MYSQL_NUM)) {
    printf("ID: %s  Name: %s", $row[0], $row[1]);  
} 
```

用于`print_r($test)`查看数组以查看其格式。然后您可以使用上面的循环以您想要的任何顺序显示它的各个部分。数据库中的每一列都在结果行中

```
row = [col1, col2, col3...] 
```

您可以使用数组索引访问它们`$row[0], $row[1]...`。您可以通过查看数据库中列的顺序或查看它在`print_r`. 然后你可以按照你想要的顺序回显它。

# language-agnostic - 通过语音识别从预先存在的成绩单中生成字幕

> ID：11278863
> 
> 赞同：1
> 
> 时间：2012-07-01T01:05:20.090
> 
> 标签：language-agnostic, voice-recognition, speech-to-text, transcription

假设我有该音频的音频和纯文本副本，我如何使用语音识别以编程方式从两者生成字幕？

这与 YouTube 在编辑视频时在其字幕/字幕页面上提供的内容非常相似。

有哪些 API 可用于执行此操作？它有哪些挑战？

我最精通 Java/C#，但这与语言无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T17:38:47.053

这称为时间戳或对齐。[CMUSphinx](http://cmusphinx.sourceforge.net)项目项目有一个特定的工具。您可以从 subversion 中查看它。

[http://cmusphinx.svn.sourceforge.net/viewvc/cmusphinx/branches/long-audio-aligner/](http://cmusphinx.svn.sourceforge.net/viewvc/cmusphinx/branches/long-audio-aligner/)

有关使用的一些信息，请参阅

[http://cmusphinx.sourceforge.net/?s=long+audio+aligner](http://cmusphinx.sourceforge.net/?s=long+audio+aligner)

# android - event.stopImmediatePropagation() 在 Chrome for Android 上不起作用

> ID：11278864
> 
> 赞同：7
> 
> 时间：2012-07-01T01:05:36.187
> 
> 标签：android, jquery

我相信`event.stopImmediatePropagation()`不适用于 Android 版 Chrome。有人可以解决它吗？（替代代码）？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-20T14:11:40.307

尝试

```
event.callNonExistingMethode(); 
```

或者

请勿`event.stopImmediatePropagation();`使用，仅使用`stopImmediatePropagation();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T17:19:34.607

希望你不是在寻找 `event.preventDefault()`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-05T10:38:38.480

`event.stopImmediatePropagation()`隐式调用`event.stopPropagation()`

你能试试`event.stopPropagation()`吗？

# c++ - 如何在大型项目中使用#include？

> ID：11278866
> 
> 赞同：5
> 
> 时间：2012-07-01T01:06:13.160
> 
> 标签：c++, include

我应该在每个头文件/cpp 文件中#include 我需要的所有内容吗？我正在开发一个 2d 游戏引擎 atm（主要用于练习），在查看我的代码时，我意识到我在几乎每个文件中都重复了字符串和向量。这是一个问题，我该如何处理？

我一直认为，您编写的每个课程或模块都应该有自己的两条腿，可以这么说。我真的很喜欢通用编程（我在引擎中包含了我自己的脚本语言，以及我自己起草的脚本引擎），但我也意识到这可能会导致很多开销和混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T01:14:20.800

我会坚持只在必要时才包括`<string>`在内。`<vector>`

至于确保各个头文件独立存在，我喜欢 Google C++ 样式指南如何处理[include order](https://google-styleguide.googlecode.com/svn/trunk/cppguide.xml?showone=Names_and_Order_of_Includes#Names_and_Order_of_Includes)。`foo.hpp`基本上，总是在所有其他包含之前列出相应的包含`foo.cpp`。这样，我们知道`foo.hpp`不会期望在它之前包含某些东西，如果它不存在则失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T01:11:59.650

这不是问题。您应该在每个文件中包含绝对最小的依赖项——不多也不少。

# javascript - html 5 函数未执行？

> ID：11278867
> 
> 赞同：1
> 
> 时间：2012-07-01T01:06:35.500
> 
> 标签：javascript, html

我正在阅读一本名为“Beginning Facebook Game Apps Dev”的书，在第 3 章中，他们向我们介绍了如何为 html 文档创建代码。

我在 Mac 上，我使用 TextEdit 创建页面。起初，这本书给出了绘制矩形和三角形的代码。两者都很好，但后来我尝试了代码轮换，它只显示了这个框。

我已经用 C++ 编程了一段时间，但我并不是专家，但我对互联网的工作原理一无所知。无论如何，我能看到的唯一区别是有效的代码和无效的代码是旋转的事实，我调用函数，而矩形我没有。谁能告诉我发生了什么事吗？

ps：我试图谷歌 html 5 功能不起作用，但老实说，我对如何搜索这个特定问题一无所知。

谢谢你

***代码工作（绘制矩形）***

```
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8" />
    <meta    name="viewport"    content="width=device-width,initial-scale=1">

    <title>A simple Canvas Square</title>
    <style type="text/css"    media="screen">
    #canvas
    {
        border: 1px solid #c0c0c0;
    }
    </style>

</head>
<body>
    <canvas id="canvas" width="270" height="270"></canvas>

    <script type="text/javascript"    charset="utf-8">

        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');

        context.fillStyle = "gray";
        context.fillRect(30, 30, 200, 200);
    </script>
</body>
</html> 
```

***代码不工作（轮换）***

```
<!DOCTYPE HTML>
<html>
<head>
    <meta   http-equiv="content-type"   content="text/html;  charset=utf-8">

    <title>overlapping box</title>
    <style type="text/css"    media="screen">
    #canvas
    {
        border: 1px solid #c0c0c0;
    }
    </style>

</head>
<body>
    <canvas id="canvas" width="500" height="400"></canvas>

    <script type="text/javascript"    charset="utf-8">
        function draw(canvas Id)
        {
        "use strict";
        var canvas = document.getElementById(canvasId);
        var context = canvas.getContext("2d");

        context.fillStyle = "#091F5D";
        context.fillRect(10, 10, 160, 150);

        context.fillStyle = "rgba(255, 78, 0, 0.5)";
        context.fillRect(90, 90, 160, 150);

        context.fillStyle = "rgb(255, 78, 0)";
        context.fillRect(170, 160, 160, 150);
        }

        draw('canvas');
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T01:15:02.470

在这一行：

```
function draw(canvas Id) 
```

'canvas' 和 'Id' 之间不应有空格。将其更改为：

```
function draw(canvasId) 
```

`canvasId`是参数的名称（传递的值是要在其中绘制矩形的画布元素的 id）。

# objective-c - uiwebview 实时字节继续上升？

> ID：11278868
> 
> 赞同：1
> 
> 时间：2012-07-01T01:06:39.650
> 
> 标签：objective-c, ios, memory-leaks, uiwebview, profiler

我有一个通过分析器运行的 RSS 提要阅读器应用程序，我注意到每当我加载一个 uiwebview 并从我的导航控制器中弹出它时，我的 Live Bytes 都会增加少量（.10-.40MB） . 我希望 Live Bytes 保持在 uiwebview 启动之前的位置。这是否表明我正在泄漏某些东西，或者这对于 uiwebview 对象是否正常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T04:26:24.543

根据您的评论，我回去检查了我的 webview，看看是否有任何泄漏。Profiler 没有报告任何泄漏，但每次我展示并随后关闭 webview 时，Live Bytes 的数量肯定会增加少量。在我的例子中，Live Bytes 每次增加 40-50kb，而不是 100-400kb，但无论如何，它肯定在增长。我之前的评论是基于 Profiler 的 Leaks 工具识别的泄漏（例如 Twitter.framework 肯定有一个已知的识别泄漏，但它是几十字节，而不是千字节）。我通常不跟踪 Live Bytes，所以如果我误导了您，我深表歉意。

因此，在回答您的问题时，我想在您呈现和关闭 webview 控件时消耗内存并不少见。不过，我不会倾向于将 Live Bytes 的增长视为泄漏，除非 Profiler 也在 Leaks 工具中报告了泄漏。

# javascript - Google Closure Compiler 中的“危险使用全局 this 对象”警告

> ID：11278870
> 
> 赞同：3
> 
> 时间：2012-07-01T01:07:19.103
> 
> 标签：javascript, google-closure-compiler

我有一些看起来像这样的代码：

```
var MyObject = function () {
  this.Prop1 = "";
  this.Prop2 = [];
  this.Prop3 = {};
  this.Prop4 = 0;
} 
```

然后我后来有这个：

```
var SomeObject = new MyObject(); 
```

当我在高级模式下通过闭包编译器运行我的代码时，我`dangerous use of the global this object`在我拥有的每一行都收到警告`this.Prop =`

我在做什么是“危险的”，我应该如何重写我的代码？

感谢您的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T01:14:47.557

我*建议*这样写：

```
function MyObject() {
  this.Prop1 = "";
  this.Prop2 = [];
  this.Prop3 = {};
  this.Prop4 = 0;
} 
```

但是，真正的解决方法是`@constructor`在构造函数之前的行上使用 JSDoc 表示法：

```
/** @constructor */ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T02:10:32.343

[Closure Compiler Error and Warning Reference](https://developers.google.com/closure/compiler/docs/error-ref)提供了与危险使用相关的警告的详细解释`this`：

*   JSC_UNSAFE_THIS
*   JSC_USED_GLOBAL_THIS

关于使用全局`this`对象的警告有助于防止意外调用没有`new`关键字的构造函数，这会导致构造函数属性泄漏到全局范围内。然而，为了让编译器知道哪些函数打算成为构造函数，注释`/** @constructor */`是必需的。

# php - Python - Facebook 全球登录

> ID：11278874
> 
> 赞同：0
> 
> 时间：2012-07-01T01:08:53.113
> 
> 标签：php, python, facebook, login, oauth

我想在我的 Flask/Python 应用程序中执行的操作与我在 PHP 中执行的操作类似。在 PHP 中，我能够创建一个新的 facebook 对象，如果用户已经授权该应用程序并且已经登录到他们的 Facebook 帐户，他们的信息将被加载到该对象中，他们不必单击“登录”在网站上使用 Facebook”——它会自动意识到他们已经登录并获得授权。

使用我的 Python 应用程序，我正在使用[https://github.com/pythonforfacebook/facebook-sdk/](https://github.com/pythonforfacebook/facebook-sdk/)

```
@app.route('/login')
def login():
    return facebook.authorize(callback=url_for('facebook_authorized',
        next=request.args.get('next') or request.referrer or None,
        _external=True))

@app.route('/login/authorized')
@facebook.authorized_handler
def facebook_authorized(resp):
    if resp is None:
        return 'Access denied: reason=%s error=%s' % (
            request.args['error_reason'],
            request.args['error_description']
        )
    session['oauth_token'] = (resp['access_token'], '')
    me = facebook.get('/me')

    usr = Users.query.filter_by(fb_id=me.data['id']).first()

    if (hasattr(usr, 'fb_id'))==False:
        # Find them in our database and log them in
    else:
        # Sign them up

    return redirect(url_for('home')) 
```

有没有一种方法可以设置它，以便可以在整个应用程序中使用 me 对象，从而允许自动登录，因为我可以在页面加载时执行此步骤而无需用户访问登录 URL？

目前，用户必须访问 /login 才能检索他们的 Facebook 信息。是否可以像在 PHP 中那样执行此操作，它可以是整个脚本中使用的变量？- 抱歉听起来多余，我不知道如何解释清楚。

在 PHP 中，一些示例代码如下所示 - 这将在每次页面加载时调用，而不需要用户访问 /login URL 以使用他们的 Facebook 登录。

```
<?php
if(!$this->getUser()){

    $facebook = new Facebook(array(
      'appId'  => '',
      'secret' => '',
    ));

    $this->fbuser = $facebook->getUser();

    if ($this->fbuser) {
# etc..
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:28:37.873

Not too familiar with Flask, but it seems to me that logically, your unauthorized access handler could first attempt to log in the user using Facebook before rejecting their page load request.

# android - Android 中的处理程序和内存泄漏

> ID：11278875
> 
> 赞同：48
> 
> 时间：2012-07-01T01:09:11.350
> 
> 标签：android, handler

请看下面的代码：

```
public class MyGridFragment extends Fragment{

    Handler myhandler = new Handler() {
        @Override
        public void handleMessage(Message message) {
            switch (message.what) {
                case 2:   
                    ArrayList<HashMap<String,String>> theurls = (ArrayList<HashMap<String,String>>) message.obj;
                    urls.addAll(theurls);
                    theimageAdapter.notifyDataSetChanged();
                    dismissBusyDialog();
                    break;
            }
        }
    }
} 
```

当我像这样使用处理程序时，我收到一个警告“处理程序应该是静态的，否则它很容易出现内存泄漏。” 有人能告诉我最好的方法是什么吗？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-07-05T01:12:00.243

我最近在自己的代码中更新了类似的内容。我刚刚将匿名 Handler 类设置为受保护的内部类，并且 Lint 警告消失了。看看下面的代码是否适合你：

```
public class MyGridFragment extends Fragment{

    static class MyInnerHandler extends Handler{
        WeakReference<MyGridFragment> mFrag;

        MyInnerHandler(MyGridFragment aFragment) {
            mFrag = new WeakReference<MyGridFragment>(aFragment);
        }

        @Override
        public void handleMessage(Message message) {
            MyGridFragment theFrag = mFrag.get();
            switch (message.what) {
            case 2:
                ArrayList<HashMap<String,String>> theurls = (ArrayList<HashMap<String,String>>) message.obj;
                theFrag.urls.addAll(theurls);
                theFrag.theimageAdapter.notifyDataSetChanged();
                theFrag.dismissBusyDialog();
                break;
            }//end switch
        }
    }
    MyInnerHandler myHandler = new MyInnerHandler(this);
} 
```

您可能需要更改我放置“theFrag”的位置。因为我只能猜测那些引用的内容。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-21T12:52:59.517

这是我制作的一个有用的小类，你可以使用。遗憾的是它仍然很冗长，因为你不能有匿名的静态内部类。

```
import java.lang.ref.WeakReference;
import android.os.Handler;
import android.os.Message;

/** A handler which keeps a weak reference to a fragment. According to
 * Android's lint, references to Handlers can be kept around for a long
 * time - longer than Fragments for example. So we should use handlers
 * that don't have strong references to the things they are handling for.
 * 
 * You can use this class to more or less forget about that requirement.
 * Unfortunately you can have anonymous static inner classes, so it is a
 * little more verbose.
 * 
 * Example use:
 * 
 *  private static class MsgHandler extends WeakReferenceHandler<MyFragment>
 *  {
 *      public MsgHandler(MyFragment fragment) { super(fragment); }
 * 
 *      @Override
 *      public void handleMessage(MyFragment fragment, Message msg)
 *      {
 *          fragment.doStuff(msg.arg1);
 *      }
 *  }
 * 
 *  // ...
 *  MsgHandler handler = new MsgHandler(this);
 */
public abstract class WeakReferenceHandler<T> extends Handler
{
    private WeakReference<T> mReference;

    public WeakReferenceHandler(T reference)
    {
        mReference = new WeakReference<T>(reference);
    }

    @Override
    public void handleMessage(Message msg)
    {
        if (mReference.get() == null)
            return;
        handleMessage(mReference.get(), msg);
    }

    protected abstract void handleMessage(T reference, Message msg);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-03T05:12:53.790

根据[ADT 20 Changes](http://tools.android.com/download/adt-20-preview)，看起来您应该将其设为静态。

> 新的皮棉检查：
> 
> 检查以确保 Fragment 类是可实例化的。如果您不小心使片段内部类成为非静态的，或者忘记了默认构造函数，则当系统在配置更改后尝试重新实例化片段时，您可能会遇到运行时错误。
> 
> 查找处理程序泄漏：此检查确保处理程序内部类不包含对其外部类的隐式引用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-03T12:10:43.420

如果您阅读有关 AccountManager 或 PendingIntent 的文档，您会看到某些方法将 Handler 作为参数之一。

[例如](http://developer.android.com/reference/android/app/PendingIntent.html#send%28android.content.Context,%20int,%20android.content.Intent,%20android.app.PendingIntent.OnFinished,%20android.os.Handler%29)：

*   onFinished - 发送完成时回调的对象，或 null 表示没有回调。
*   handler -**处理程序，标识应该发生回调的线程**。如果为 null，则回调将从进程的线程池中发生。

想象一下情况。有的Activity调用PendingIntent.send(...)，放入Handler的非静态内部子类。然后活动被破坏。但是内部阶级生活。

内部类仍然拥有指向已销毁活动的链接，它不能被垃圾收集。

如果您不打算将处理程序发送到此类方法，则无需担心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T10:27:26.233

我遇到了同样的问题，我发现它是这个主题之一，有很多问题和很少的答案。我的解决方案很简单，我希望它可以帮助某人：

```
/* BEFORE */
private Handler mHandler= new Handler() {
        @Override public void handleMessage(Message msg) {
        this.doSomething();
    };
}; 
```

我们可以创建一个简单地运行 Runnable 的静态 Handler 子类。实际的处理程序实例将通过可以访问实例变量的可运行程序知道要做什么。

```
/* AFTER */
static class RunnableHandler extends Handler {
    private Runnable mRunnable;
    public RunnableHandler(Runnable runnable) { 
        mRunnable = runnable;
    }
    @Override public void handleMessage(Message msg) {
        mRunnable.run();
    };
}
private RunnableHandler mHandler = new RunnableHandler(new Runnable() {
    @Override public void run() {
        this.doSomething();
    } }); 
```

在功能相同的情况下，警告消失了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-13T07:50:02.870

这种情况的一个简单解决方案可能是：

```
Handler handler=new Handler(new Handler.Callback() {
    @Override
    public boolean handleMessage(Message message) {
        //do your stuff here
        return false;
    } }); 
```

# f# - 在单声道（mac）上运行 F# exe

> ID：11278876
> 
> 赞同：0
> 
> 时间：2012-07-01T01:09:13.830
> 
> 标签：f#, mono

我已经使用[mac 安装程序](http://www.go-mono.com/mono-downloads/download.html)（包括 F#）成功安装了 Mono，并且一直在使用交互式 shell。我也可以很好地编译 F# 源文件以生成 .NET EXE，但是当我尝试使用 Mono 运行它时，出现错误：

```
Unhandled Exception: System.TypeLoadException: Could not load type '<StartupCode$HelloWorld>.$HelloWorld' from assembly 'HelloWorld, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'.
[ERROR] FATAL UNHANDLED EXCEPTION: System.TypeLoadException: Could not load type '<StartupCode$HelloWorld>.$HelloWorld' from assembly 'HelloWorld, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'. 
```

文件的内容——HelloWorld.fs——很简单

```
printfn "Hello world" 
```

我也读过[这个问题](https://stackoverflow.com/questions/3898650/running-f-code-with-mono)，但解决方案不能解决我的问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T03:37:18.067

事实证明，我在两个不同的位置安装了 2 个不同的单声道版本—— 2.10.6 in`/opt/local/lib/mono`和 2.10.9 in `/Library/Frameworks/Mono.framework`。该`fsi`命令是`fsi.exe`后者附带的符号链接，而`mono`命令本身是指向前者的另一个符号链接。

经验教训：确保您没有安装同一软件的两个版本

# android - Eclipse中的间歇性RequestFactory错误

> ID：11278877
> 
> 赞同：4
> 
> 时间：2012-07-01T01:09:19.230
> 
> 标签：android, google-app-engine, requestfactory

在我的 AppEngine 连接的 Android 项目中，我已经成功使用 RequestFactory 好几个月了。不过，有时我在子类 RequestFactory 的文件中遇到问题

```
public interface MyRequestFactory extends RequestFactory {
    ...
} 
```

**Eclipse 在“公共接口...”行上给了我一个红色的 X**，我得到的错误如下所示。（注意这不是运行时，它只是在我编辑时在 Eclipse 窗口中）

奇怪的是，我通常可以做几次 Project->Clean 并编辑几次代码，从不进行任何实际的代码更改，然后“保存”并且问题总是消失。不过这次卡住了。

有任何想法吗？

> java.lang.NullPointerException at
> org.eclipse.jdt.apt.core.internal.AptCompilationParticipant.addJava6GeneratedFile(AptCompilationParticipant.java:272) at
> org.eclipse.jdt.internal.apt.pluggable.core.dispatch.IdeProcessingEnvImpl.addNewUnit(IdeProcessingEnvImpl .java:132) 在
> org.eclipse.jdt.internal.apt.pluggable.core.filer.IdeJavaSourceOutputStream.close(IdeJavaSourceOutputStream.java:72) 在 sun.nio.cs.StreamEncoder.implClose(StreamEncoder.java:319) 在sun.nio.cs.StreamEncoder.close(StreamEncoder.java:148) at
> java.io.OutputStreamWriter.close(OutputStreamWriter.java:233) at java.io.BufferedWriter.close(BufferedWriter.java:265) at
> java.io .PrintWriter.close(PrintWriter.java:312) 在
> com.google.web.bindery.requestfactory.apt.DeobfuscatorBuilder.visitType(DeobfuscatorBuilder.java:146) 在
> com.google.web.bindery.requestfactory.apt.DeobfuscatorBuilder.visitType(DeobfuscatorBuilder.java:43) 在
> org.eclipse。 jdt.internal.compiler.apt.model.TypeElementImpl.accept(TypeElementImpl.java:60)
> 位于 com.google.web.bindery.requestfactory 的 javax.lang.model.util.ElementScanner6.scan(ElementScanner6.java:139)
> 。 apt.ScannerBase.scan(ScannerBase.java:63) 位于
> com.google.web.bindery.requestfactory.apt.State.executeJobs(State.java:248) 位于
> com.google.web.bindery.requestfactory.apt.RfValidator。处理（RfValidator.java:83）在
> org.eclipse.jdt.internal.compiler.apt.dispatch.RoundDispatcher.handleProcessor(RoundDispatcher.java:139) 在
> org.eclipse.jdt.internal.compiler.apt.dispatch.RoundDispatcher.round(RoundDispatcher.java:121) 在
> org.eclipse.jdt.internal.apt.pluggable.core.dispatch.IdeAnnotationProcessorManager.processAnnotations(IdeAnnotationProcessorManager.java 的
> org.eclipse.jdt.internal.compiler.apt.dispatch.BaseAnnotationProcessorManager.processAnnotations(BaseAnnotationProcessorManager.java:159 ) :134) 在 org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:432) 的
> org.eclipse.jdt.internal.compiler.Compiler.processAnnotations(Compiler.java:813)
> 。 jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:364) 在
> org.eclipse.jdt.internal.core.builder.IncrementalImageBuilder.compile(IncrementalImageBuilder.java:329) 在
> org.eclipse.jdt.internal.core.builder.AbstractImageBuilder.compile(AbstractImageBuilder.java:301) 在
> org.eclipse。 jdt.internal.core.builder.IncrementalImageBuilder.build(IncrementalImageBuilder.java:134) 在
> org.eclipse.jdt.internal.core.builder.JavaBuilder.buildDeltas(JavaBuilder.java:265) 在
> org.eclipse.jdt.internal。 core.builder.JavaBuilder.build(JavaBuilder.java:193) at org.eclipse.core.internal.events.BuildManager $2.run(BuildManager.java:728) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner .java:42) 在
> org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199) 在
> org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:239) 在 org.eclipse.core.internal.events.BuildManager $1.run(BuildManager.java:292) 在 org.eclipse.core.runtime .SafeRunner.run(SafeRunner.java:42) 在
> org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:295) 在
> org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java :351)
> org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:374)
> org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143)
> org.eclipse。 core.internal.events.AutoBuildJob.run(AutoBuildJob.java:241) 在 org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T15:55:07.367

这是一个已知的 Eclipse 错误。我找到的唯一解决方案是重新启动 eclipse。有时我必须在没有注释的情况下编译然后重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T12:21:29.770

在我的情况下，仅重新启动或禁用注释处理不起作用。我有两个请求工厂（在不同的项目中！）有这个错误。

*   myReqFacA 扩展 RequestFactory
*   myReqFacB 扩展 RequestFactory

我通过删除请求工厂接口之一解决了这个问题。幸运的是，不再需要该界面。

但是一天后我又遇到了同样的问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-20T21:42:48.270

我遇到了同样的问题。我使用的解决方法是重命名 RequestFactory 子类名称（Refactor->Rename）。我更改了子类的另一部分，它不起作用。编译成功后，只需将其重命名回原来的名称即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-31T10:16:22.887

我从 GWT 的 RequestFactory 遇到了同样的问题，我解决了它删除文件夹“gwt-unitCache”，然后再次编译项目（项目 - >清理......）

很可能对于 android，有必要删除某种生成的文件夹并再次编译项目。

# jquery - Jquery - 将 .each() 与变量和 IF 语句一起使用

> ID：11278879
> 
> 赞同：1
> 
> 时间：2012-07-01T01:10:15.447
> 
> 标签：jquery, variables, if-statement, each

现在花了好几个小时在这上面，似乎没有得到任何地方！

我在页面底部有 5 个相关产品。目前，无论是否打折，这些产品都会显示“原价”。上面是实际价格，显然如果产品不打折，价格看起来会一样，这并不酷。

所以我编写了一个脚本来检查“实际”价格是否与“原价”价格相同，如果为真，它只会删除“原价”Div 元素。工作正常。

现在我遇到的问题是使此规则适用于页面中具有相同类的多个元素。出于某种原因，当我尝试在“.each”函数中传递一个变量时，它返回一个字符串，其中包含每个“.each”元素的所有 Div 值，而不是只返回其相对父元素的值。例如“£674£1999.99£674”而不是“£674”。

**检查实际价格是否与原价相同：**

```
 $('.floatleft').each(function() {
    var wasprice = $('.was').text();
    var ourprice = $('.now').text();

    if (wasprice == ourprice) {

    $('div.price-extras').remove();
    $('.productdetails-view .product-price .PricesalesPrice').css('line-height','40px');

};
}); 
```

**HTML 代码示例：**

```
<div class="vmproduct-featured">
  <div class=" width20 floatleft">
    <div class="spacer">
      <a href="/store/powertools/tacx-i-magic-t1900-trainer-info" title="Tacx I-Magic T1900 Trainer" class="img-link">
        <img src="/store/product/resized/123_150x150.jpg" alt="123" class="featuredProductImage" border="0">
      </a>
      <div class="clear"></div>     
      <a class="text-link" href="/store/powertools/tacx-i-magic-t1900-trainer-info">Tacx I-Magic T1900 Trainer</a>      
      <div class="clear"></div>
      <div class="was">£674.00</div>
      <div class="now">£674.00</div> 
    </div>
  </div>
  <div class=" width20 floatleft">
    <div class="spacer">
      <a href="/store/powertools/2012-cube-agree-gtc-di2-info" title="2012 Cube Agree GTC DI2" class="img-link">
        <img src="/store/product/resized/12cubeagreegtcdi2_150x150.jpg" alt="12cubeagreegtcdi2" class="featuredProductImage" border="0">
      </a>
      <div class="clear"></div>     
      <a class="text-link" href="/store/powertools/2012-cube-agree-gtc-di2-info">2012 Cube Agree GTC DI2
      </a>      
      <div class="clear"></div>
      <div class="was">£1,999.99</div>
      <div class="now">£2,499.99</div> 
    </div>
  </div>
 </div> 
```

所以基本上我在 .each() 上失败了，需要一些帮助，请 <3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T01:17:16.917

那是因为一次`$('.was').text();`选择了类的所有文本`was`，试试这个：

```
$('.was').each(function() {
    var wasprice = $(this).text();
    var ourprice = $(this).siblings('.now').text(); // or "$(this).next('.now').text();"

    if (wasprice == ourprice) { 
        $('div.price-extras').remove();
        $('.productdetails-view .product-price .PricesalesPrice').css('line-height','40px');
    }
}); 
```

# android - 在 Eclipse 中自动导出资源较少的 APK

> ID：11278880
> 
> 赞同：0
> 
> 时间：2012-07-01T01:11:00.243
> 
> 标签：android, eclipse, apk

我有一个为两种语言构建的 Android 应用程序（不使用内置语言支持）。

我想快速导出每种语言的 APK 文件。

我需要更改单例类中的一个变量来指示语言（这很容易），但我还需要从`res`文件夹中排除图形。

我怎样才能自动执行此操作而不必每次都删除/添加图形？

# fancybox - 无法控制花式框中视频的宽度和高度

> ID：11278886
> 
> 赞同：0
> 
> 时间：2012-07-01T01:12:15.797
> 
> 标签：fancybox

我最终想创建一个照片库...单击图片将启动一个 You Tube 视频。我正在使用fancybox 2.0。

我有视频打开内联，但我无法控制它的尺寸。你能帮我看看这个页面，看看我在哪里犯规。

[http://www.bytebrothers.com/bb_tester/Video_lightbox_test.htm](http://www.bytebrothers.com/bb_tester/Video_lightbox_test.htm)

谢谢你，darrell@bytebrothers.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T08:46:51.083

这就是你的脚本现在的样子

```
$(document).ready(function() {
 $('.fancyYouTube').fancybox({
   width  : 400,
   height : 300,
   autoSize : false,
   type   : 'swf'
 }) 
```

这就是它的样子

```
$(document).ready(function() {
 $('.fancyYouTube').fancybox({
   width  : 400,
   height : 300,
   autoSize : false
 });
}); 
```

您缺少一些右括号。

另一方面，如果您使用的是 fancybox-media，则无需指定`type:'swf'`

**更新**：在`embed`（youtube`iframe`模式）模式下定位 youtube 视频时，将类添加`fancybox.iframe`到您的锚点，这样

```
<a class="fancyYouTube" href="http://www.youtube.com/embed/dx6TZgUSquY"> 
```

应该是这个

```
<a class="fancyYouTube fancybox.iframe" href="http://www.youtube.com/embed/dx6TZgUSquY"> 
```

# iphone - 一个类的数组

> ID：11278888
> 
> 赞同：0
> 
> 时间：2012-07-01T01:13:10.227
> 
> 标签：iphone, objective-c

我正在使用objective-c开发一个iphone应用程序，我无法从类变量中创建一个数组，例如......

我有一个名为的类`Cube`，我正在尝试创建一个名为 map 的类的实例，它是一个数组

```
Cube map[10][10]; 
```

Xcode 然后说这是一个错误并建议我这样做

```
Cube *map[10][10]; 
```

当我这样做时^我无法访问我在类中定义的方法之一`Cube`，现在这不是我的所有方法，它只是一种在我尝试调用它时不起作用的方法。这个方法与其他方法唯一不同的是我向它传递了一个参数。类`Cube`声明和定义都可以完美编译。

谁能向我解释如何在不将其转换为指针的情况下创建具有 2 维的类。另外，为什么 xcode 建议我将其设为指针，为什么当我这样做时该方法不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T01:18:48.770

您可能想要使用 Cocoa 样式数组，即`NSArray`或`NSMutableArray`代替 C 样式数组。它更加灵活，旨在与 Objective-c 对象一起使用。看看这个关于使用 Cocoa 数组的简单教程：http: [//iphonelearning.wordpress.com/2011/08/24/nsarray-and-nsmutablearray/](http://iphonelearning.wordpress.com/2011/08/24/nsarray-and-nsmutablearray/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T02:47:04.497

Objective-C 中的标准方法是创建`NSArray(or NSMutableArray)`一个`NSArray`(or `NSMutableArray`)。假设您希望在创建数组对象后能够操作数组，您的代码将如下所示：

```
NSMutableArray* cubeGrid = [NSMutableArray new]; // Note that this code assumes you are using ARC.

// add row 1
NSMutableArray* cubeRow1 = [NSMutableArray arrayWithObjects:cube1,cube2,cube3,nil]; // you will need to add cube 4 to 10 in the real code
[cubeGrid addObject:cubeRow1];

// add row 2
NSMutableArray* cubeRow2 = [NSMutableArray arrayWithObjects:cube11,cube12,cube13,nil]; // you will need to add cube 14 to 20 in the real code
[cubeGrid addObject:cubeRow2];

// and you will create the rest of the rows and add to the cubeGrid array 
```

要访问元素，您将执行以下操作：

```
for (id cubeRow in cubeGrid) {
    if ([cubeRow isKindOfClass:[NSArray class]]) {
        for (id cube in (NSArray*)cubeRow) {
            if ([cube isKindOfClass:[Cube class]]) {
                // Do things with cube
            }
        }
    }
} 
```

您可能还需要仔细检查您尝试访问的方法是否在头文件中声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T01:32:48.913

您可能想看看[这个](https://stackoverflow.com/a/1114693/1477887)答案。

# stack - 什么是堆栈随机化以及它如何防止缓冲区溢出攻击？

> ID：11278889
> 
> 赞同：5
> 
> 时间：2012-07-01T01:13:12.410
> 
> 标签：stack, buffer-overflow, aslr

我从一本书中读到**缓冲区溢出**可能被用作注入攻击系统的漏洞代码的一种方式。**堆栈随机化**是防止此类攻击的有效方法之一。

我不明白什么是**堆栈随机化**以及它如何防止这些攻击？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T01:52:27.493

代替**堆栈随机化**，消除（或更难）堆栈或缓冲区溢出的技术称为[地址空间布局随机化（ASLR）](http://en.wikipedia.org/wiki/Address_space_layout_randomization)。这背后的理论是尝试随机化项目在内存中的位置，以使注入恶意代码的任务更加困难。一些缓冲区溢出和堆栈溢出攻击依赖于知道项目在内存中的位置，以便能够注入可以进行有效内存引用的代码。

所有这一切的困难在于，即使有了这样的机制，仍然有可能注入自包含代码，这些代码可以在运行时进行有效的相对内存引用，从而允许恶意代码执行。

查看[stackoverflow 上的此帖子，](https://stackoverflow.com/questions/2543725/how-to-write-a-buffer-overflow-exploit-in-gcc-windows-xp-x86?rq=1)其中包含指向有关缓冲区溢出的更多信息的链接。

# mediaelement.js - 使用 jquery 和 mediaelement.js 在点击时播放声音

> ID：11278890
> 
> 赞同：2
> 
> 时间：2012-07-01T01:13:32.047
> 
> 标签：mediaelement.js

我有一个使用 3 种音频和视频类型的页面设计：

1.  几个视频。
2.  触发 onclick 的音频声音。
3.  在后台播放的音频循环，可以关闭该选项。

MeidaElement.js 看起来非常适合视频，让它们都可以在跨浏览器上播放，而无需大惊小怪。

它似乎也可以很好地播放音频。我只是不确定我是否可以从 jQuery 触发一点音频 - 即只需单击任何旧 div。如果是这样，我可以预加载音频，以便在点击时立即发出声音。

在此先感谢您的任何指点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T01:51:34.007

这个 jQuery 函数似乎对我有用：

```
$('.button').click(function(){
    $('audio')[0].player.play();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:34:41.517

您应该能够将它绑定到 div，就像在 jQuery 中将任何其他内容绑定到 div 一样。[http://mediaelementjs.com/#installation](http://mediaelementjs.com/#installation)上的示例将为您创建音频播放器的方法提供一个良好的开端。具体来说，

```
<script>
// JavaScript object for later use
var player = new MediaElementPlayer('#player',/* Options */);
// ... more code ...
player.pause();
player.setSrc('mynewfile.mp4');
// I'm removing the following play call so we can do it elsewhere
//player.play();
</script> 
```

在上面，我删除了对 play() 的调用，以便可以将其绑定到其他地方。在 jQuery 中，我认为应该如下所示：

```
$('#divWhatever').on('click', function() { $('#player').play() } ) 
```

请对此进行测试并报告成功或您遇到的失败。无论如何，on 函数是您在 jQuery 中寻找的功能：http: [//api.jquery.com/on/](http://api.jquery.com/on/)

# android - 嵌入在 ScrollView 中的 LinearLayout 中的顶视图只有一半可见

> ID：11278891
> 
> 赞同：0
> 
> 时间：2012-07-01T01:14:10.007
> 
> 标签：android, android-layout

在我的应用程序中，我将成对的微调器插入到滚动视图内的线性布局中。问题是，当我添加足够多的微调器时，前两个会被部分遮挡。这就是我要说的。

![:(](../Images/ef005e3e0285219a6d5e9905e9ac4744.png)

```
<LinearLayout
android:id="@+id/ChordHeader"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_gravity="center"
android:background="@android:drawable/bottom_bar"
android:orientation="horizontal" >

<Button
    android:id="@+id/addChordButton"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_weight="1"
    android:text="Add Chord" />

<TextView
    android:id="@+id/spacetext1"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:text="  "
    android:textAppearance="?android:attr/textAppearanceLarge" />

<Button
    android:id="@+id/removeChordButton"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_weight="1"
    android:text="Remove Chord" />
 </LinearLayout>

 <ScrollView
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:fillViewport="true" >

<LinearLayout
    android:id="@+id/ChordList"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:isScrollContainer="true"
    android:orientation="vertical"
    android:weightSum="100" > 
```

（微调器在这里插入）

```
</LinearLayout>
 </ScrollView>
 </LinearLayout> 
```

如果有问题，这里是将微调器插入列表的代码。

```
 Spinner chordName = new Spinner(this);
    Spinner chordType = new Spinner(this);

    LinearLayout container = new LinearLayout(this);
    container.setOrientation(LinearLayout.HORIZONTAL);
    LinearLayout chordList = (LinearLayout) findViewById(R.id.ChordList);

    chordName.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 80, 50));
    chordName.setAdapter(nameAdapter);
    container.addView(chordName); //add name spinner to container

    chordType.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 80, 50));
    chordType.setAdapter(typeAdapter);
    container.addView(chordType); //add type spinner to container
    container.setBackgroundResource(android.R.drawable.bottom_bar);
    container.setPadding(10, 0, 10, 0);

    chordList.addView(container); //add container to list layout 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T02:38:10.030

这是我的布局..试试看:)

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="match_parent">

    <RelativeLayout
        android:id="@+id/ChordHeader"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@android:drawable/bottom_bar">

        <Button
            android:id="@+id/addChordButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerVertical="true"
            android:text="Add Chord" />

        <Button
            android:id="@+id/removeChordButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"
            android:ellipsize="middle"
            android:text="Remove Chord" />

    </RelativeLayout>

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@id/ChordHeader"
        >

        <LinearLayout
            android:id="@+id/ChordList"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

        </LinearLayout>
    </ScrollView>

</RelativeLayout> 
```

现在对于按钮，如果您真的希望它们具有相同的大小，您可能需要设置一个尺寸。以下是如何在 Android 中存储维度：[更多资源类型：维度](http://developer.android.com/guide/topics/resources/more-resources.html#Dimension)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T02:06:23.373

添加完微调器后，尝试获取对列表中顶部项目的引用，然后请求关注它。

```
chordList.getChildAt(0).requestFocus(); 
```

# mamp - 如何使用 MAMP Pro 创建 pre url 子域

> ID：11278892
> 
> 赞同：0
> 
> 时间：2012-07-01T01:14:18.490
> 
> 标签：mamp

我正在使用 MAMP 开发一个站点，我想知道是否有一种方法可以从软件本身创建预 url 子域。IE [http://subdomain.mywebsite.com](http://subdomain.mywebsite.com)

如果可能的话，我想远离弄乱 apache 配置的所有复杂性，但如果没有其他方法也可以。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T12:58:40.840

MAMP 不提供创建主机的可能性。但是您可以使用[MAMP PRO](http://www.mamp.info/en/mamp-pro/index.html)创建具有您想要的任何名称的主机。您还可以使用您想要的任何名称为主机添加别名。

# ios - CALAyer 与 CGLayer 混淆：在后台操作和保存图像

> ID：11278894
> 
> 赞同：0
> 
> 时间：2012-07-01T01:14:35.887
> 
> 标签：ios, ios5, calayer, quartz-2d

我从网上提取图像，并希望对其进行一些操作，例如使用 CATransform3D 添加透视图，并将一对组合在一起。完成后，我想将文件保存在内存中，以便在需要时将其拉出（例如在 tableview 单元格中）。我设法从网上提取图像，并通过制作 CALayer 来操作它们。经过一番阅读，我对如何正确执行此操作有点困惑，因为这些图像直到需要时才会显示，我显然想在工作线程上完成我的工作，这样系统就不会滞后。最好的程序是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T02:50:15.427

Apple 建议您几乎永远不要尝试自己缓存图像，因为它们会在内部缓存它们，并且您可以保证即使在高内存压力下缓存也能正常工作。

`setName:`您可以通过and方法使用 Apple 的内部缓存来缓存图像`imageNamed:`。此外，您应该将图像的本地副本保存到磁盘的缓存目录中，这样如果缓存被清除，您就不需要再次下载它。

所以，总而言之，使用`imageNamed:`，如果是 nil 检查磁盘缓存目录，如果是 nil 下载图像。缓存一个 CALayer 会造成太多脏内存，

# c++ - 函数重载的类似模 板的声明

> ID：11278900
> 
> 赞同：0
> 
> 时间：2012-07-01T01:15:31.427
> 
> 标签：c++, overloading

我可以在头文件的开头进行通用函数声明吗？

然后我可以`template<class t> t func(t);`专门化它，但是
[模板专门化 VS 函数重载](https://stackoverflow.com/questions/7108033/template-specialization-vs-function-overloading)
说不要那样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T03:34:35.770

首先，您当然可以声明一个模板函数，然后定义它，和/或定义特化。但...

函数特化必须是*完全*特化，即不能部分特化模板函数。现在，虽然您实际上可以专门化函数模板，但提供重载可能有优点（和缺点），但在大多数情况下，这将是一个更好的选择。

您可能想阅读以下内容：[http ://www.gotw.ca/publications/mill17.htm](http://www.gotw.ca/publications/mill17.htm)

# google-app-engine - GAE Golang - 如何正确地将任务队列安排到后端？

> ID：11278901
> 
> 赞同：2
> 
> 时间：2012-07-01T01:15:44.657
> 
> 标签：google-app-engine, scheduled-tasks, go, backend

关于如何在 Go 中的 Google App Engine 中将任务队列安排到后端的信息很少。在[TQ 的参考资料](https://developers.google.com/appengine/docs/go/taskqueue/reference)中，我们可以阅读：

```
// Additional HTTP headers to pass at the task's execution time.
// To schedule the task to be run with an alternate app version
// or backend, set the "Host" header.
Header http.Header 
```

但是没有解释真正将“主机”设置为什么。在后端的概述中，我们可以类似地阅读：

> 应用程序管理员、应用程序实例以及 App Engine API 和服务（例如任务队列任务和 Cron 作业）无需任何特殊配置即可访问私有后端。

但同样，没有给出任何解释。

我尝试将“主机”值设置为后端的名称，但任务由普通应用程序执行。

```
t := taskqueue.NewPOSTTask("/", map[string][]string{"key": {key}})
t.Header.Add("Host", "backend")
if _, err := taskqueue.Add(c, t, ""); err != nil {
    return
} 
```

在 GAE Go 中安排后端调用的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T21:17:11.377

使用命名队列最容易定位后端。例如：

```
_, err = taskqueue.Add(c, &taskqueue.Task{
    Path:    "/myProcessorPath",
    Payload: myPayload,
}, "myQueueName") 
```

您的队列定义指定了后端。例如对于`myQueueName`，您可能有一个`queue.yaml`如下所示的条目：

```
- name: myQueueName
  target: myBackendName
  rate: 400/s
  max_concurrent_requests: 64
  bucket_size: 25
  retry_parameters:
    task_age_limit: 7d 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T06:57:17.560

使用该`appengine.BackendHostname`函数获取后端的主机名。这应该可以用作任务的主机头。

# java - 在 Mahout 中序列化 RandomAccessSparseVector

> ID：11278907
> 
> 赞同：2
> 
> 时间：2012-07-01T01:17:59.253
> 
> 标签：java, serialization, hadoop, mahout

我正在将数据加载到`RandomAccessSparseVector`Mahout 0.7 中，但我不知道如何对其进行序列化。如果我使用 a`VectorWritable`我可以这样使用`SequenceFile.Writer`：

```
writer = new SequenceFile.Writer(
    fs, conf, new Path("filename"), LongWritable.class,
    VectorWritable.class); 
```

不幸的是，没有`RandomAccessSparseVectorWritable`。

一种选择是完全忘记稀疏向量并将数据加载到 a 中`VectorWritable`并对其进行序列化。我想避免这种情况，因为手动输入大量零到 a 中`VectorWritable`然后在序列化时占用磁盘上的一堆空间是草率的。`RandomAccessSparseVector`也不能转换为`VectorWritable`.

如果它有任何用处，我已经设置

```
Configuration conf = new Configuration();
conf.set("io.serializations",
    "org.apache.hadoop.io.serializer.WritableSerialization"); 
```

以便 Hadoop 知道如何序列化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T01:45:17.107

解决方案非常简单。在对 API 文档进行了一段时间毫无结果的挖掘之后，我偶然发现了一篇有用的论坛帖子。`VectorWritable`不是向量类型，而是用于序列化的向量包装器。之前，我试图写一个`RandomAccessSparseVector`像这样生成的

```
RandomAccessSparseVector vect = new RandomAccessSparseVector(columns); 
```

通过调用

```
key = new LongWritable(foo)
RandomAccessSparseVector vect = new RandomAccessSparseVector(columns);
writer.append(key, vect) 
```

我只需要打电话

```
writer.append(key, new VectorWritable(vect)) 
```

# orchardcms - Orchard 自定义用户部分未存储在数据库中

> ID：11278910
> 
> 赞同：2
> 
> 时间：2012-07-01T01:19:11.813
> 
> 标签：orchardcms

我似乎无法将附加数据存储在附加到用户的单独内容部分中。我做了以下事情：

*   创建了一个模块
*   在模块中，我为 ProfilePart 和 ProfilePartRecord 创建了一个模型
*   在迁移中，我为 ProfilePartRecord 创建了一个表（来自 ContentPartRecord 类型）
*   在迁移中，我通过设置 WithPart ProfilePart 更改了 User 的类型定义
*   我创建了一个驱动程序类，它有 2 种编辑方法，一种用于获取，一种用于发布（代码片段如下
*   我还创建了一个处理程序，为 ProfilePartRecord 类型的 profilePartRepository 添加存储过滤器

模块结构

*   驱动程序/ProfilePartDriver.cs
*   处理程序/ProfileHandler.cs
*   模型/ProfilePart.cs
*   模型/ProfilePartRecord.cs
*   视图/EditorTemplates/Parts/profile.cshtml
*   迁移.cs
*   安置信息

因为我认为问题出在驱动程序中。这是我的代码：

是否因为部件附加到用户而出错？还是我错过了其他东西。

公共类 ProfilePartDriver:ContentPartDriver {

```
protected override string Prefix
{
    get { return "Profile"; }
}

//GET
protected override DriverResult Editor(ProfilePart part, dynamic shapeHelper)
{
    return ContentShape("Parts_Profile_Edit", () => 
                    shapeHelper.EditorTemplate(TemplateName: "Parts/Profile", Model: part, Prefix: Prefix));
}

//POST
protected override DriverResult Editor(ProfilePart part, IUpdateModel updater, dynamic shapeHelper)
{
    updater.TryUpdateModel(part, Prefix, null, null);
    return Editor(part, shapeHelper);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T18:19:36.437

我用过[天行者的博客](http://skywalkersoftwaredevelopment.net/blog/writing-an-orchard-webshop-module-from-scratch-part-1)。有一章是关于使用用户注册客户并向其中添加您自己的内容部分。对我很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T13:07:55.397

**首先**- 当您转到仪表板并编辑给定用户时，您的 ProfilePart 编辑器是否完全显示？我注意到您正在`Parts_Profile_Edit`用作形状键，但实际上`EditorTemplates/Parts/Profile.cshtml`用作模板。这是完全正确的，但请注意 Placement.info 文件使用形状键，因此您必须在`Parts_Profile_Edit`其中用作形状名称。否则不会显示。

**第二**- 您是否尝试过调试以查看是否`Editor`调用了第二种驱动程序方法（用于处理 POST 的方法）？

就像 Bertrand 建议的那样，我会研究其中一个可用的现有模块（afaik 有一个用于库中的用户配置文件）并查看差异。它可能很小，例如。一个错字。

# jsp - 登录页面刷新时会话超时

> ID：11278913
> 
> 赞同：3
> 
> 时间：2012-07-01T01:20:05.227
> 
> 标签：jsp, servlets, servlet-filters, web.xml, session-timeout

我制作了一个非常简单的*登录和会话*结构，以便在我未来的基于 JSP 的应用程序中重用。就像这样：

**web.xml**（1分钟超时是为了测试我的问题）：

```
<session-config>
 <session-timeout>1</session-timeout>
</session-config>

<filter>
 <filter-name>Access</filter-name>
 <filter-class>com.app.Access</filter-class>
</filter>

<filter-mapping>
 <filter-name>Access</filter-name>
 <url-pattern>*</url-pattern>
</filter-mapping>

<servlet>
 <servlet-name>Login</servlet-name>
 <servlet-class>com.app.Login</servlet-class>
</servlet>

<servlet-mapping>
 <servlet-name>Login</servlet-name>
 <url-pattern>/login</url-pattern>
</servlet-mapping> 
```

**Access.java**过滤器：

```
// Check if the page's the login or if the user logged, else asks login
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException {
    HttpServletRequest httpRequest = (HttpServletRequest) request;
    boolean logged = httpRequest.getSession(false) != null && httpRequest.getSession().getAttribute("user") != null;
    if (httpRequest.getServletPath().equals("/login") || logged)
        chain.doFilter(request, response);
    else
        ((HttpServletResponse) response).sendRedirect(httpRequest.getContextPath() + "/login");
} 
```

**Login.java** servlet（为测试缩短了身份验证）：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    if (request.getRequestedSessionId() != null && !request.isRequestedSessionIdValid())
        request.setAttribute("failure", "session timeout");
    request.getSession().setAttribute("user", null);
    request.getRequestDispatcher("login.jsp").forward(request, response);
}

protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    request.getSession().setAttribute("user", new User());
    response.sendRedirect("");
} 
```

而位于WebContent 根目录的**login.jsp**`<form action="login" method="post">`页面有一个表单，其中包含用于身份验证的适当的 innerHTML 和一个用于接收*会话超时*或*登录失败*消息的**${failure}字段。**

 **这种结构非常适合我。它拦截、请求登录、检查会话和身份验证等，但有一个小缺陷：**如果您在登录页面并在超时后刷新它（F5 或在 URL 处按 Enter），页面接收并在 ${failure} 中显示“会话超时”消息。**

我还没有找到真正的工作方法来让它知道上一页是登录页面。尝试了大约五种不同的方法但没有成功，包括`request.getHeader("Referer")`标签`lastWish`库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:27:26.603

一种方法是让您的可公开访问的 JSP（例如登录页面）**根本不**创建会话。默认情况下，请求 JSP 页面即隐式创建会话。这可以通过在 JSP 顶部添加以下行来实现：

```
<%@page session="false" %> 
```

这种方式`request.getRequestedSessionId()`将返回`null`，因此将绕过超时检查。只有在您实际登录用户时才会以这种方式创建会话。我只会从 servlet 中删除以下行，因为这没有任何意义并且仍然会创建会话：

```
request.getSession().setAttribute("user", null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:31:37.370

我只是这样做：

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
    HttpServletRequest httpReq = (HttpServletRequest)request;
    String servletPath = httpReq.getServletPath();
    HttpSession session = httpReq.getSession();
    String redirectUrl = "/login.jsp";
    if (
            (servletPath.endsWith("login.jsp")) ||
            (servletPath.endsWith("rss.html")) ||
            (servletPath.endsWith("httperror403.html")) ||
            (servletPath.endsWith("httperror500.html")) ||
            (servletPath.endsWith("imageMark.do"))||
            (servletPath.indexOf("/api.do") != -1) ||
            (servletPath.indexOf("/help/") != -1)){
        chain.doFilter(request, response);
    }  else if (session == null) {
        httpReq.getRequestDispatcher(redirectUrl).forward(request, response);
    } else {
        SystemUser user = (SystemUser)session.getAttribute("user");
        if (user == null){
            if (session != null){
                session.invalidate();
            }
            httpReq.getRequestDispatcher(redirectUrl).forward(request, response);
        } else {
            chain.doFilter(request, response);
        }
    }
} 
```**

# java - Returns empty data structure (entity) instead of null, is it good?

> ID：11278914
> 
> 赞同：1
> 
> 时间：2012-07-01T01:20:10.767
> 
> 标签：java, entity

I've been working on a project which has been developed by other developers. In this project, any method that returns an entity or object is designed to return a special value called `EMPTY_VALUE`.

```
public Customer getCustomer() {
    if (everythingFine) {
        return realCustomer();
    } else {
        Customer.EMPTY_VALUE;
    }
} 
```

And the Customer class:

```
public class Customer {
    public static final Customer EMPTY_VALUE = new Customer();

    private String firstName;
    private STring lastName;

    public Customer() {
        this.firstName = "";
        this.lastName = "";
    }
} 
```

In other places that use the getCustomer() method:

```
Customer customer = getCustomer();
if (customer != Customer.EMPTY_VALUE) {
    doSomething(customer);
} 
```

Does the above way has any advantages over the `null`-checking? Does it buy us anything?

```
Customer customer = getCustomer();
if (customer != null) {
    doSomething(customer);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T01:28:55.100

This is an example of the [Null Object Pattern](http://en.wikipedia.org/wiki/Null_Object_pattern). The advantage is that you can remove explicit null checks by instead just using an object that does a default behavior. In this case, the null object returns empty strings when its fields are queried, so if that's what you want in the case of no result anyway, you just saved yourself a check for null. Obviously like all design patterns, its usefulness depends on the particular situation.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T01:29:45.047

I would say **neither**. Don't return `null` or a return special "error-object" from a method. Let them throw an exception instead. That way you don't need to "check" every time you you call it.

```
public Customer getCustomer() {

    if (everythingFine) {
        return realCustomer();

    throw new NoCustomerException();
} 
```

And the code using the method would be a lot simpler:

```
doSomething(getCustomer()); 
```

*It could be (like the example above) an runtime exception or a checked exception.*

* * *

**If you have to** choose between the two I would choose the non-null variant, just like I would choose to return an empty list from a method instead of `null`. I would however urge you not to write any special code to handle that special object, it should be handled like any other customer.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-01T01:36:11.260

我不喜欢创建一个虚拟的空客户对象的想法。它的语义是什么？是不是真正的客户？

在这种情况下，我更愿意使用来自 Guava 的[Optional](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Optional.html)`null`之类的东西，或者可能只是根据客户端代码使用。阅读链接中的描述以查看常见用途和可选的 API。

# eclipse - 将我的开发平台切换到 VIM 有什么好处，我会失去什么？

> ID：11278917
> 
> 赞同：-2
> 
> 时间：2012-07-01T01:21:20.313
> 
> 标签：eclipse, vim, ubuntu, ide, qt-creator

当我第一次学习编程时，我学会了使用 IDE 来做这件事，直到最近我都坚持了这一点。在过去的几个月里，我一直在将 gedit 用于基于 Web 的项目，虽然项目结果非常好（[在这里查看](http://peizo.selfip.org/signage)），但我觉得 gedit 并没有提供任何特别有用的东西。到目前为止，我最喜欢的两个 IDE 是 Eclipse 和 Qt Creator。在我的笔记本电脑（运行 Ubuntu 的 Zenbook）上，Qt Creator 在一秒钟内启动，Eclipse 在五秒钟内启动，因此性能不是问题。那么切换到 VIM 会失去什么，我能得到什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T06:02:29.687

这与它启动的速度无关，尽管它确实启动得更快。这是关于您可以编辑的速度。通过从不将手从键盘上移开，您将获得巨大的速度和无价的内心平静。你也踏入了命令行幸福的美妙世界。事情实际上是黑白的（好吧，如果你想要的话）。它让生活变得简单……高效……有趣。一旦你没有鼠标，你就再也不会回去了。

# google-app-engine - get_serving_url 返回 'Key' 类型的对象没有 len()

> ID：11278918
> 
> 赞同：0
> 
> 时间：2012-07-01T01:21:21.343
> 
> 标签：google-app-engine

我正在尝试从 blobstore 返回缩略图。对于完整的图像，我通常会写出

```
<img src='img?img_id=%s'></img>" % greeting.key() 
```

（其中问候在循环中从数据库中获取图像的选择）具有处理程序`('/img', ImageHandler)`和函数

```
class ImageHandler(webapp.RequestHandler):
def get(self):
    greeting = db.get(self.request.get("img_id"))
    if greeting.picture:
        self.response.headers['Content-Type'] = "image/png"
        self.response.out.write(greeting.picture)
    else:
        self.error(404) 
```

这很好用。但是，当使用 get_serving_url 时，调用

```
<img src='img?img_id=%s'></img>" % (images.get_serving_url(greeting.key(), 32)) 
```

我得到一个`TypeError: object of type 'Key' has no len()`. 我只能假设我使用的 blob 密钥不正确，但据我所知，那*是*blob 密钥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:36:29.567

您可能希望`str()`在将密钥对象传递给`get_serving_url()`. 它最有可能期待密钥的字符串形式。

它在您的原始版本中起作用的原因是因为使用`%`带有`%s`格式说明符的运算符会自动要求`str()`您确定要插入的字符串。

# node.js - How to share code between node.js apps?

> ID：11278921
> 
> 赞同：87
> 
> 时间：2012-07-01T01:22:28.173
> 
> 标签：node.js, npm

I have several apps in node that all share a few modules that I've written. These modules are not available via npm. I would like to be able to share freely between apps, but I don't want to copy directories around, nor rely on Git to do so. And I'm not really big on using symlinks to do this either.

I would like to arrange directories something like this:

```
app1
 server.js
 node_modules
  (public modules from npm needed for app1)
 lib
  (my own modules specific to app1)

app2
 server.js
 node_modules
  (public modules from npm needed for app2)
 lib
  (my own modules specific to app2)

shared_lib
 (my own modules that are used in both app1 and app2) 
```

The problem I'm seeing is that the modules in shared_lib seem to get confused as to where to find the modules that will be in the node_modules directory of whichever app they are running in. At least I think that is the problem.

So....what is a good way to do this that avoids having duplicates of files? (note that I don't care about duplicates of things in node_modules, since those aren't my code, I don't check them into Git, etc)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-01T03:20:21.000

npm 文档建议使用[npm-link](https://docs.npmjs.com/cli/link)在本地创建您自己的 Node.js 包，然后将它们提供给其他 Node.js 应用程序。这是一个简单的四步过程。

一个典型的过程是首先创建一个具有以下结构的包：

```
 hello
  | index.js
  | package.json 
```

这些文件的典型实现是：

index.js

```
 exports.world = function() {
     return('Hello World');
  } 
```

包.json

```
 {
    "name": "hello",
    "version": "0.0.1",
    "private": true,
    "main": "index.js",
    "dependencies": {
    },
    "engines": {
    "node": "v0.6.x"
    }
  } 
```

"private:true" 确保 npm 将拒绝发布包。这是一种防止意外发布私有包的方法。

接下来，导航到 Node.js 包文件夹的根目录并运行`npm link`以全局链接包，以便它可以在其他应用程序中使用。

要在另一个应用程序中使用这个包，例如“hello-world”，具有以下目录结构：

```
 hello-world
 | app.js 
```

导航到 hello-world 文件夹并运行：

```
 npm link hello 
```

现在您可以像使用任何其他 npm 包一样使用它，如下所示：

应用程序.js

```
 var http = require('http');
  var hello = require('hello');

  var server = http.createServer(function(req, res) {
     res.writeHead(200);
     res.end(hello.world());
  });
  server.listen(8080); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-07-01T13:04:08.317

我通过在不同级别设置**node_modules**文件夹来完成这项工作 - 节点然后自动向上遍历，直到找到模块。

请注意，您不必发布到 npm 就可以在 node_modules 中有一个模块 - 只需使用：

```
"private": true 
```

在您的每个私有**package.json**文件中 - 对于您的项目，我将拥有以下内容：

```
app1
 server.js
 node_modules
  (public modules from npm needed for app1)
  (private modules locally needed for app1)

app2
 server.js
 node_modules
  (public modules from npm needed for app2)
  (private modules locally needed for app2)

node_modules
  (public modules from npm needed for app1 & app2)
  (private modules locally for app1 & app2) 
```

关键是 node.js 已经有一种机制来处理这个问题，而且非常棒。只需将它与“private not on NPM”技巧结合起来，你就可以开始了。

简而言之：

```
require('somemodule') 
```

从应用程序 A 或 B 将向上级联，直到找到模块 - 无论它是生活在低处还是高处。确实 - 这使您可以在不更改任何**require(...)**语句的情况下热交换位置。

[node.js 模块文档](http://nodejs.org/api/modules.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-01T01:47:34.353

只需在 require 调用中使用正确的路径

例如在 server.js 中是：

> var moduleName = require('../shared_lib/moduleName/module.js');

重要的是要知道，只要您的路径以“/”、“../”或“./”为前缀，路径就相对于调用文件。

有关节点模块加载的更多信息，请访问： [http ://nodejs.org/docs/latest/api/modules.html](http://nodejs.org/docs/latest/api/modules.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-13T10:45:36.047

是的，您可以从 app1 引用 shared_lib，但是如果您想将 app1 打包并部署到其他环境（例如 AWS 上的 Web 服务器），则会遇到问题。

在这种情况下，您最好使用“npm install shared_lib/module”将 shared_lib 中的模块安装到 app1 和 app2。它还将在 app1 和 app2 中安装 shared_lib 模块的所有依赖项并处理冲突/重复。

请参阅： [如何在没有我自己的注册表的情况下安装私有 NPM 模块？](https://stackoverflow.com/questions/10386310/how-to-install-a-private-npm-module-without-my-own-registry)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-01T01:39:37.107

如果您查看[node.js 文档](http://nodejs.org/docs)，您会发现 Node.js 也理解`package.json`文件格式，至少粗略理解。

基本上，如果您有一个名为 的目录`foo`，并且该目录中有一个`package.json`带有键值对的文件：`"main": "myCode.js"`，那么如果您尝试`require("foo")`找到该目录并在其中找到一个`package.json`文件，那么它将`foo/myCode.js`用于`foo`模块。

因此，对于您的目录结构，如果每个共享库都有自己的目录，其中包含这样一个简单的`package.json`文件，那么您的应用程序可以通过以下方式获取共享库：

```
var lib1 = require('../shared_lib/lib1');
var lib2 = require('../shared_lib/lib2'); 
```

这应该适用于这两个应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-18T05:41:41.850

另一种解决方案是将其他地方的文件克隆到这个 repo 中：

**克隆.js**：

```
const path = require('path')
const fs = require('fs')

const shared = [
  {
    type: 'file',
    source: '../app1',
    files: [
      'src/file1',
      'src/file2',
      '...'
    ],
  },
]

function cloneFiles(source, files) {
  const Reset = '\x1b[0m'
  const FgGreen = '\x1b[32m'
  console.log(`---------- Cloning ${files.length} files from ${source} ----------`)

  for (const file of files) {
    const sourceFile = path.join(__dirname, '..', source, file)
    const targetFile = path.join(__dirname, '..', file)

    process.stdout.write(` ${file} ... `)
    fs.copyFileSync(sourceFile, targetFile)
    console.log(`${FgGreen}Done!${Reset}`)
  }

  console.log(`---------- All done successfully ----------\n`)
}

;(() => {
  for (const item of shared) {
    switch (item.type) {
      case 'file':
        cloneFiles(item.source, item.files)
        break
    }
  }
})() 
```

然后，在**package.json**中，您可以添加此脚本并在您想要克隆/同步文件时调用它：

```
"clone": "node clone.js" 
```

# perl - trying to parse text and html from email over IMAP using MAIL::IMAPClient but text is hidden in parts and multi-parts

> ID：11278922
> 
> 赞同：3
> 
> 时间：2012-07-01T01:22:39.233
> 
> 标签：perl, imap

I can connect to the IMAP mail server easy enough:

```
 use Mail::IMAPClient;
 use MIME::Base64;
 use MIME::Parser;

  my $imap = Mail::IMAPClient->new(
    Server   => '192.168.2.2',
    User     => 'xxxxxx',
    Password => 'yyyyyy',
    Ssl      => 1,
    Uid      => 1,
  );

  my $folders = $imap->folders
    or die "List folders error: ", $imap->LastError, "\n";
  print "Folders: @$folders\n";

$sfolder="INBOX.2012";

$imap->select( $sfolder )
    or die "Select '$Opt{sfolder}' error: ", $imap->LastError, "\n";

my @msgs = $imap->messages or die "Could not messages: $@\n"; 
```

However, the text and html I want is not easily parsed due to codes like this:

```
Content-Transfer-Encoding:base64
Content-Type:text/html; charset=utf-8
Content-Transfer-Encoding:base64
Content-Type:text/html; charset=utf-8
Content-Transfer-Encoding:
Content-Type:multipart/mixed; boundary="----------=_4F0F4830.7079357A"
Multipart
Content-Transfer-Encoding:
Content-Type:multipart/mixed;   boundary="----=_Part_4487195_1184536749.1326753403034"
Multipart
Content-Transfer-Encoding:
Content-Type:multipart/alternative; boundary=--boundary_164442_d184e417-739f-
46d6-824a-6ea1846e79de
Multipart
Content-Transfer-Encoding:
Content-Type:multipart/mixed;   boundary="----=_Part_3882878_23916831.1326509484032"
Multipart
Content-Transfer-Encoding: 
```

I tried this but it only works on a tiny number of different encodings.

```
if  ($imap->get_header($msg,"Content-Transfer-Encoding")=~ /base64/i) {
print "\nMatch base64";
        if    ($imap->get_header($msg,"Content-Type")=~m/text/i )   {
         push(@mail,decode_base64($imap->body_string($msg)));
        }
        elsif ($imap->get_header($msg,"Content-Type")=~m/image/i )
        { print "\nImage detected"; }
        elsif ($imap->get_header($msg,"Content-Type")=~m/application/i )
        { print "\nApplication detected"; } 
```

There are 7bit and 8bit variants and other encoding methods that contain the **html or text** I want for later use. I successfully use decode_base64() to decode base64\. The worse ones to decode are the ones that contain multi-part codes. I feel like I am re-inventing the wheel and there must be a library or module that can do all the heavy lifting for me. Other content types such as .jpg,.gif, and .pdf should simply be ignored. The multi-part emails contain at least 1 part that I an interested but many that are useless to me.

After further research this structure has some of the information I need but don't know how to get it out efficiently is another matter.

```
Dumping:$VAR1 = bless( {
                 'bodyparms' => {
                                  'boundary' =>     '----=_NextPart_002_BC64_7D688C1F.A2FF9BE0'
                                },
                 'bodyextra' => undef,
                 '_top' => 1,
             'bodydisp' => 'NIL',
             '_id' => 'HEAD',
             'bodysubtype' => 'mixed',
             'PartsIndex' => {
                               '1.3' => bless( {
                                                 'bodyparms' => 'NIL',
                                                 'bodyid' => '<d9e26cc0-019c-4ac0-9b1e-9c9ac8424f52>',
                                                 'bodyextra' => 'NIL',
                                                 'bodydisp' => 'NIL',
                                                 '_id' => '1.3',
                                                 'bodysubtype' => 'jpeg',
                                                 '_prefix' => '1.3',
                                                 'bodysize' => '4808',
                                                 'bodytype' => 'image',
                                                 'bodyMD5' => 'NIL',
                                                 'bodylang' => 'NIL',
                                                 'bodydesc' => 'NIL',
                                                 'bodyenc' => 'base64'
                                               }, 'Mail::IMAPClient::BodyStructure' ),
                               '1.1' => bless( {
                                                 'bodyparms' => {
                                                                  'boundary' => '----=_NextPart_000_36AE_880DDD08.0A776E35'
                                                                },
                                                 'bodyextra' => undef,
                                                 'bodydisp' => 'NIL',
                                                 '_id' => '1.1',
                                                 'bodysubtype' => 'alternative',
                                                 '_prefix' => '1.1',
                                                 'bodytype' => 'MULTIPART',
                                                 'bodystructure' => [
                                                                      bless( {
                                                                               'bodyparms' => {
                                                                                                'charset' => 'utf-8'
                                                                                              },
                                                                               'bodyextra' => 'NIL',
                                                                               'bodyid' => 'NIL',
                                                                               'bodydisp' => 'NIL',
                                                                               '_id' => '1.1.1',
                                                                               'bodysubtype' => 'PLAIN',
                                                                               '_prefix' => '1.1.1',
                                                                               'bodysize' => '1971',
                                                                               'bodytype' => 'TEXT',
                                                                               'bodyMD5' => 'NIL',
                                                                               'textlines' => '74',
                                                                               'bodylang' => 'NIL',
                                                                               'bodydesc' => 'NIL',
                                                                               'bodyenc' => 'quoted-printable'
                                                                             }, 'Mail::IMAPClient::BodyStructure' ),
                                                                      bless( {
                                                                               'bodyparms' => {
                                                                                                'charset' => 'utf-8'
                                                                                              },
                                                                               'bodyextra' => 'NIL',
                                                                               'bodyid' => 'NIL',
                                                                               'bodydisp' => 'NIL',
                                                                               '_id' => '1.1.2',
                                                                               'bodysubtype' => 'HTML',
                                                                               '_prefix' => '1.1.2',
                                                                               'bodysize' => '23364',
                                                                               'bodytype' => 'TEXT',
                                                                               'bodyMD5' => 'NIL',
                                                                               'textlines' => '331',
                                                                               'bodylang' => 'NIL',
                                                                               'bodydesc' => 'NIL',
                                                                               'bodyenc' => 'quoted-printable'
                                                                             }, 'Mail::IMAPClient::BodyStructure' )
                                                                    ],
                                                 'bodyloc' => 'NIL',
                                                 'bodylang' => 'NIL'
                                               }, 'Mail::IMAPClient::BodyStructure' ),
                               '1' => bless( {
                                               'bodyparms' => {
                                                                'boundary' => '----=_NextPart_001_EA96_2BF8DEDE.32622D51'
                                                              },
                                               'bodyextra' => undef,
                                               'bodydisp' => 'NIL',
                                               '_id' => 1,
                                               'bodysubtype' => 'related',
                                               '_prefix' => 1,
                                               'bodytype' => 'MULTIPART',
                                               'bodystructure' => [
                                                                    $VAR1->{'PartsIndex'}{'1.1'},
                                                                    bless( {
                                                                             'bodyparms' => 'NIL',
                                                                             'bodyid' => '<5dff39db-e81c-4410-be75-8662564fd328>',
                                                                             'bodyextra' => 'NIL',
                                                                             'bodydisp' => 'NIL',
                                                                             '_id' => '1.2',
                                                                             'bodysubtype' => 'jpeg',
                                                                             '_prefix' => '1.2',
                                                                             'bodysize' => '14406',
                                                                             'bodytype' => 'image',
                                                                             'bodyMD5' => 'NIL',
                                                                             'bodylang' => 'NIL',
                                                                             'bodydesc' => 'NIL',
                                                                             'bodyenc' => 'base64'
                                                                           }, 'Mail::IMAPClient::BodyStructure' ),
                                                                    $VAR1->{'PartsIndex'}{'1.3'},
                                                                    bless( {
                                                                             'bodyparms' => 'NIL',
                                                                             'bodyid' => '<717f2ef4-f795-4d1c-87cc-283c9b0a59b0>',
                                                                             'bodyextra' => 'NIL',
                                                                             'bodydisp' => 'NIL',
                                                                             '_id' => '1.4',
                                                                             'bodysubtype' => 'gif',
                                                                             '_prefix' => '1.4',
                                                                             'bodysize' => '2912',
                                                                             'bodytype' => 'image',
                                                                             'bodyMD5' => 'NIL',
                                                                             'bodylang' => 'NIL',
                                                                             'bodydesc' => 'NIL',
                                                                             'bodyenc' => 'base64'
                                                                           }, 'Mail::IMAPClient::BodyStructure' )
                                                                  ],
                                               'bodyloc' => 'NIL',
                                               'bodylang' => 'NIL'
                                             }, 'Mail::IMAPClient::BodyStructure' ),
                               '1.2' => $VAR1->{'PartsIndex'}{'1'}{'bodystructure'}[1],
                               '1.1.2' => $VAR1->{'PartsIndex'}{'1.1'}{'bodystructure'}[1],
                               '2' => bless( {
                                               'bodyparms' => {
                                                                'name' => 'BKD-7361945220.pdf'
                                                              },
                                               'bodyid' => 'NIL',
                                               'bodyextra' => 'NIL',
                                               'bodydisp' => {
                                                               'attachment' => {
                                                                                 'filename' => 'BKD-7361945220.pdf'
                                                                               }
                                                             },
                                               '_id' => 2,
                                               'bodysubtype' => 'octetstream',
                                               '_prefix' => 2,
                                               'bodysize' => '47540',
                                               'bodytype' => 'application',
                                               'bodyMD5' => 'NIL',
                                               'bodystructure' => [],
                                               'bodylang' => 'NIL',
                                               'bodydesc' => 'NIL',
                                               'bodyenc' => 'base64'
                                             }, 'Mail::IMAPClient::BodyStructure' ),
                               '1.4' => $VAR1->{'PartsIndex'}{'1'}{'bodystructure'}[3],
                               '1.1.1' => $VAR1->{'PartsIndex'}{'1.1'}{'bodystructure'}[0]
                             },
             '_prefix' => 'HEAD',
             'PartsList' => [
                              1,
                              '1.1',
                              '1.1.1',
                              '1.1.2',
                              '1.2',
                              '1.3',
                              '1.4',
                              2
                            ],
             'bodytype' => 'MULTIPART',
             'bodystructure' => [
                                  $VAR1->{'PartsIndex'}{'1'},
                                  $VAR1->{'PartsIndex'}{'2'}
                                ],
             'bodyloc' => 'NIL',
             'bodylang' => 'NIL'
           }, 'Mail::IMAPClient::BodyStructure' ); 
```

As you can see none of the values are guaranteed to be part of every part on the PartsIndex and some them are nested.

variable of interest for each PartsIndex item: bodytype bodysubtype bodyenc

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T22:04:23.413

[使用Couriel](http://p3rl.org/Courriel)解析邮件消息：

```
use strictures;
use Mail::IMAPClient qw();
use Courriel qw();

sub walk_parts {
    my ($obj, $callback) = @_;
    if ($obj->is_multipart) {
        for my $part ($obj->parts) {
            walk_parts($part, $callback);
        }
    } else {
        $callback->($obj);
    }
}

my $imap = Mail::IMAPClient->new(
    …
) or die $@;

my $folders = $imap->folders
    or die $imap->LastError;

$imap->select('INBOX')
    or die $imap->LastError;

my @messages = $imap->messages
    or die $imap->LastError;

for my $id (@messages) {
    my $raw = $imap->message_string($id)
        or die $imap->LastError;
    my $email = Courriel->parse(text => $raw);
    walk_parts $email, sub {
        my ($part) = @_;
        my $content = $part->content;
        my $type = $part->mime_type;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T04:02:23.587

我尝试使用几个预构建的模块，但它们有太多的依赖项并且很难使用。此解决方案在原始解决方案之外不添加任何依赖项。我也遇到了 libMagic 依赖项的问题，见上文，我不希望任何使用我的程序的人也必须处理这个问题。

您必须为主要父母调用两次 decode ，然后为每个孩子调用一次。由于这个 $imap->get_bodystructure($msg); 包含您需要的所有信息，为什么要在不需要的地方添加依赖项。花了好几个小时才弄清楚如何手动解码，但这是值得的。

您可以将所需的任何解码器添加到 decode() 子例程。我只需要解码其中的 text/html 和 base64 编码版本。IMAPClient 函数为您提供所有父母和孩子的列表，因此您不必自己制作列表。棘手的部分是你可以有任意数量的父母，每个父母都有任意数量的孩子，但只有孩子包含有用的数据。可以忽略父母，因为它们的许多值是空白、undef 或“NIL”（字面意思）。事实上，大量变量的值为“NIL”。即使是电子邮件客户端可以为用户回答的问题，例如 bodyMD5 和 bodylang，通常也等于“NIL”。由于大量使用“NIL”解析和使用其他字段可能是徒劳的。

如果您还有其他问题，请发表评论。

```
 use Mail::IMAPClient;
 use MIME::Base64;
 use MIME::Parser;

sub decode  {
($process, $imap) =@_;
if ($process->bodytype eq "TEXT") {
   print "\n Text SubType:".$process->bodysubtype;
   if ($process->bodyenc eq "base64") {
        return decode_base64($imap->bodypart_string($msg,$process->id));
        }
   elsif (index(" -7bit- -8bit- -quoted-printable- ",lc($process->bodyenc)) !=-1  ) {
        return $imap->bodypart_string($msg,$process->id);
        }
print "\n==========Insert new decoder here============";
print "\n".$imap->bodypart_string($msg,$process->id);
print "\n=================================================";

}

return "";
}

#insert your login code with credentials here

$imap->select( $sfolder )
or die "Select '$Opt{sfolder}' error: ", $imap->LastError, "\n";

my @msgs = $imap->messages or die "Could not messages: $@\n";

foreach $msg (@msgs) {

my $raw = $imap->message_string($msg)
    or die $imap->LastError;

$struct = $imap->get_bodystructure($msg);

#MULTIPART is a container designation and does not contain anything useful by itself.
#However it will still process all of the children that have content
if ($struct->bodytype ne "MULTIPART") { print "\n BodyEnc:".$struct->bodyenc();}

$rDecode=decode($struct,$imap);
#do not insert blanks.
if ($rDecode ne "" && (length($rDecode)>2)) {push(@mail,$rDecode); }

foreach $dumpme ($struct->bodystructure()) {
if ($dumpme->bodytype() eq "MULTIPART") {next;}

$rDecode="";
$rDecode=decode($dumpme,$imap);
#do not insert blanks.
if (($rDecode ne "") && (length($rDecode)>2) ) {
push(@mail,$rDecode); }

}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T07:15:54.593

您需要一个 MIME 解析器。不幸的是，即使那样，您也需要自己进行一些规范化，因为在 MIME 中有多种表示相同数据的方法。

# php - implode to fix update sql

> ID：11278924
> 
> 赞同：0
> 
> 时间：2012-07-01T01:22:53.187
> 
> 标签：php, mysql, implode

I have this function

```
function updateDbRecord($db, $table, $carry, $carryUrl) {   
    mysql_select_db($db) or die("Could not select database. " . mysql_error());
    $resultInsert = mysql_query("SHOW COLUMNS FROM " . $table . " WHERE Field NOT IN ('id')");
    $fieldnames=array();
      if (mysql_num_rows($resultInsert) > 0) {
        while ($row = mysql_fetch_array($resultInsert)) {
            $fieldnames[] = $row['Field'];
            $arr = array_intersect_key( $_POST, array_flip($fieldnames) ); #check if value is null otherwise do not INSERT
        }
      }

      $set = "";
      foreach($arr as $key => $v) {
        $val = is_numeric($v) ? $v : "'" . $v . "'";

        $set .= $key . '=' . $val . ', ';
      }
      $sql = sprintf("UPDATE %s SET %s WHERE id='%s'", $table, $set, $_POST['id']);
      mysql_query($sql);
      if ($carry == 'yes') {
        redirect($carryUrl.'?id='.$_REQUEST['id']);
      } else { echo "Done!"; }
      echo $sql;

} 
```

It outputs for example: UPDATE projects SET project_name='123', project_bold='123', project_content='123', WHERE id='12'

The last comma before where is preventing it from working. Is there a way of avoiding this? Im aware of the function implode, however I am not sure how to employ it in this situation.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:25:07.987

Yes,

```
$sql = substr($sql,'',-1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:26:26.073

I would use

```
$sql = rtrim($sql, ','); 
```

Either that or instead of appending to a string, append to an array and use `implode`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T01:46:37.133

```
function updateDbRecord($db, $table, $carry, $carryUrl) {   
    mysql_select_db($db) or die("Could not select database. " . mysql_error());
    $resultInsert = mysql_query("SHOW COLUMNS FROM " . $table . " WHERE Field NOT IN ('id')");
    $fieldnames=array();
      if (mysql_num_rows($resultInsert) > 0) {
        while ($row = mysql_fetch_array($resultInsert)) {
            $fieldnames[] = $row['Field'];
            $array = array_intersect_key( $_POST, array_flip($fieldnames) ); #check if value is null otherwise do not INSERT
        }
      }
      foreach ($array as $key => $value) {

                $value = mysql_real_escape_string($value); // this is dedicated to @Jon
                $value = "'$value'";
                $updates[] = "$key = $value";
            }
      $implodeArray = implode(', ', $updates);
      $sql = sprintf("UPDATE %s SET %s WHERE id='%s'", $table, $implodeArray, $_POST['id']);
      mysql_query($sql); 
```

# opengl - OpenGL 2 Texture Internal Formats GL_RGB8I, GL_RGB32UI, etc

> ID：11278928
> 
> 赞同：6
> 
> 时间：2012-07-01T01:24:16.500
> 
> 标签：opengl, textures

I'm rewriting a large part of my texturing code. I would like to be able to specify certain internal formats: GL_RGB8I, GL_RGB8UI, GL_RGB16I, GL_RGB16UI, GL_RGB32I, and GL_RGB32UI. These tokens do not exist in OpenGL 2.

When specifying these internal formats as arguments to glTexImage2D, the texturing fails (the texture appears as white). When checking for errors, I get [EDIT:] 1282 ("invalid operation"). I take this to mean that the OpenGL is still using OpenGL 2 for glTexImage2D, and so the call is failing. Obviously, it will need to use a newer version to succeed. Enums like GL_RGB, GL_RGBA, and (oddly) GL_RGB32F, GL_RGBA32F work as expected.

I configure to use GLEW or GLee for extensions. I can use OpenGL 4 calls with no problem elsewhere (e.g., glPatchParameteri, glBindFramebuffer, etc.), and the enums in question certainly exist. For completeness, glGetString(GL_VERSION) returns "4.2.0". My question: can I force one of these extension libraries to use the OpenGL 4.2 version? If so, how?

EDIT: The code is too complicated to post, but here is a simple, self-contained example using GLee that also demonstrates the problem:

```
#include <GLee5_4/GLee.h>
#include <GL/gl.h>
#include <GL/glu.h>
#include <gl/glut.h>
//For Windows
#pragma comment(lib,"GLee.lib")
#pragma comment(lib,"opengl32.lib")
#pragma comment(lib,"glu32.lib")
#pragma comment(lib,"glut32.lib")

#include <stdlib.h>
#include <stdio.h>

const int screen_size[2] = {512,512};
#define TEXTURE_SIZE 64

//Choose a selection.  If you see black, then texturing is working.  If you see red, then the quad isn't drawing.  If you see white, texturing has failed.
#define TYPE 1

void error_check(void) {
    GLenum error_code = glGetError();
    const GLubyte* error_string = gluErrorString(error_code);
    (error_string==NULL) ? printf("%d = (unrecognized error--an extension error?)\n",error_code) : printf("%d = \"%s\"\n",error_code,error_string);
}

#if   TYPE==1 //############ 8-BIT TESTS ############
    inline GLenum get_type(int which) { return (which==1)?    GL_RGB8: GL_RGB; } //works
#elif TYPE==2
    inline GLenum get_type(int which) { return (which==1)?   GL_RGBA8:GL_RGBA; } //works
#elif TYPE==3
    inline GLenum get_type(int which) { return (which==1)?  GL_RGB8UI: GL_RGB; } //doesn't work (invalid op)
#elif TYPE==4
    inline GLenum get_type(int which) { return (which==1)?   GL_RGB8I: GL_RGB; } //doesn't work (invalid op)
#elif TYPE==5
    inline GLenum get_type(int which) { return (which==1)? GL_RGBA8UI:GL_RGBA; } //doesn't work (invalid op)
#elif TYPE==6
    inline GLenum get_type(int which) { return (which==1)?  GL_RGBA8I:GL_RGBA; } //doesn't work (invalid op)
#elif TYPE==7 //############ 16-BIT TESTS ############
    inline GLenum get_type(int which) { return (which==1)?   GL_RGB16: GL_RGB; } //works
#elif TYPE==8
    inline GLenum get_type(int which) { return (which==1)?  GL_RGBA16:GL_RGBA; } //works
#elif TYPE==9
    inline GLenum get_type(int which) { return (which==1)? GL_RGB16UI: GL_RGB; } //doesn't work (invalid op)
#elif TYPE==10
    inline GLenum get_type(int which) { return (which==1)?  GL_RGB16I: GL_RGB; } //doesn't work (invalid op)
#elif TYPE==11
    inline GLenum get_type(int which) { return (which==1)?GL_RGBA16UI:GL_RGBA; } //doesn't work (invalid op)
#elif TYPE==12
    inline GLenum get_type(int which) { return (which==1)? GL_RGBA16I:GL_RGBA; } //doesn't work (invalid op)
#elif TYPE==13 //############ 32-BIT TESTS ############
    inline GLenum get_type(int which) { return (which==1)?   GL_RGB32: GL_RGB; } //token doesn't exist
#elif TYPE==14
    inline GLenum get_type(int which) { return (which==1)?  GL_RGBA32:GL_RGBA; } //token doesn't exist
#elif TYPE==15
    inline GLenum get_type(int which) { return (which==1)? GL_RGB32UI: GL_RGB; } //doesn't work (invalid op)
#elif TYPE==16
    inline GLenum get_type(int which) { return (which==1)?  GL_RGB32I: GL_RGB; } //doesn't work (invalid op)
#elif TYPE==17
    inline GLenum get_type(int which) { return (which==1)?GL_RGBA32UI:GL_RGBA; } //doesn't work (invalid op)
#elif TYPE==18
    inline GLenum get_type(int which) { return (which==1)? GL_RGBA32I:GL_RGBA; } //doesn't work (invalid op)
#elif TYPE==19 //############ 32-BIT FLOAT ############
    inline GLenum get_type(int which) { return (which==1)?  GL_RGB32F: GL_RGB; } //works
#elif TYPE==20
    inline GLenum get_type(int which) { return (which==1)? GL_RGBA32F:GL_RGBA; } //works
#endif

GLuint texture;
void create_texture(void) {
    printf("    Status before texture setup: "); error_check();

    glGenTextures(1,&texture);
    glBindTexture(GL_TEXTURE_2D,texture);

    printf("    Status after texture created: "); error_check();

    GLenum data_type = GL_UNSIGNED_BYTE;
    int data_length = TEXTURE_SIZE*TEXTURE_SIZE*4; //maximum number of channels, so it will work for everything
    unsigned char* data = new unsigned char[data_length];
    for (int i=0;i<data_length;++i) {
        data[i] = (unsigned char)(0);
    };

    glTexImage2D(GL_TEXTURE_2D,0,get_type(1), TEXTURE_SIZE,TEXTURE_SIZE, 0,get_type(2),data_type,data);

    printf("    Status after glTexImage2D: "); error_check();

    delete [] data;

    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

    printf("    Status after texture filters defined: "); error_check();
}

void keyboard(unsigned char key, int x, int y) {
    switch (key) {
        case 27: //esc
            exit(0);
            break;
    }
}

void draw(void) {
    glClearColor(1.0,0.0,0.0,1.0); //in case the quad doesn't draw
    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);

    glViewport(0,0,screen_size[0],screen_size[1]);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0,screen_size[0],0,screen_size[1]);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glBegin(GL_QUADS);
    glTexCoord2f(0,0); glVertex2f(0,0);
    glTexCoord2f(2,0); glVertex2f(screen_size[0],0);
    glTexCoord2f(2,2); glVertex2f(screen_size[0],screen_size[1]);
    glTexCoord2f(0,2); glVertex2f(0,screen_size[1]);
    glEnd();

    glutSwapBuffers();
}

int main(int argc, char* argv[]) {
    glutInit(&argc,argv);
    glutInitWindowSize(screen_size[0],screen_size[1]);
    glutInitDisplayMode(GLUT_RGB|GLUT_DOUBLE|GLUT_DEPTH);
    glutCreateWindow("Texture Types - Ian Mallett");

    glEnable(GL_DEPTH_TEST);
    glEnable(GL_TEXTURE_2D);

    printf("Status after OpenGL setup: "); error_check();

    create_texture();

    printf("Status after texture setup: "); error_check();

    glutDisplayFunc(draw);
    glutIdleFunc(draw);
    glutKeyboardFunc(keyboard);

    glutMainLoop();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-02T05:41:45.233

> 检查错误时，我得到 [EDIT:] 1282（“无效操作”）。我认为这意味着 OpenGL 仍在为 glTexImage2D 使用 OpenGL 2，因此调用失败。

[OpenGL 错误](http://www.opengl.org/wiki/GL_Error_Codes)理解起来并不复杂。`GL_INVALID_ENUM/VALUE`当您传递意外、不受支持或超出范围的枚举或值时抛出。如果您将“17”作为内部格式传递给`glTexImage2D`，您将得到`GL_INVALID_ENUM`，因为 17 不是内部格式的有效枚举数。如果您将 103,422 作为宽度传递给`glTexImage2D`，您将得到`GL_INVALID_VALUE`，因为 103,422 几乎可以肯定大于`GL_MAX_TEXTURE_2D`' 的大小。

`GL_INVALID_OPERATION`总是用于出错的状态*组合。*之前设置的某些上下文状态与您正在调用的函数不匹配，或者两个或多个参数组合导致问题。后者就是你这里的情况。

如果您的实现根本不支持整数纹理，那么您会得到`INVALID_ENUM`（因为内部格式不是有效格式）。得到`INVALID_OPERATION`意味着其他事情是错误的。

即，这个：

```
glTexImage2D(GL_TEXTURE_2D,0,get_type(1), TEXTURE_SIZE,TEXTURE_SIZE, 0,get_type(2),data_type,data); 
```

您的`get_type(2)`电话返回`GL_RGB`或`GL_RGBA`在所有情况下。但是，当使用整数[图像格式](http://www.opengl.org/wiki/Image_Format#Color_formats)时，您***必须***使用[末尾](http://www.opengl.org/wiki/Pixel_Transfer#Pixel_format)[带有`_INTEGER`](http://www.opengl.org/wiki/Pixel_Transfer#Pixel_format).

所以你`get_type(2)`需要是这样的：

```
inline GLenum get_type(int which) { return (which==1)? GL_RGB16UI: GL_RGB_INTEGER; } 
```

对于其他完整的图像格式也是如此。

# opa - How do I make a client side http request in opa?

> ID：11278929
> 
> 赞同：0
> 
> 时间：2012-07-01T01:24:32.877
> 
> 标签：opa

I need to make a client side http request to receive a string. I am struggling to find a method that works on the client.

I found WebClient.Get. But this one only works on the server. Threading it through opa's client/server communication is not an option because I need this to work, even if the server is down.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T20:51:03.510

出于安全原因，浏览器不允许跨域请求。见[http://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)

在 HTML5 中计划了一些东西来克服这个问题（并且 Chrome 的 beta 版本支持网络客户端），但目前您需要使用服务器端功能。希望使用 Opa 很容易做到。

# oop - Good examples of object-oriented vs. procedural design

> ID：11278933
> 
> 赞同：0
> 
> 时间：2012-07-01T01:26:13.723
> 
> 标签：oop, procedural-programming

I keep reading that object-oriented programming can basically be done in any programming language, and that in order to do so, explicit language support is not required. I.e. one can write object-oriented programs in, say, plain C.

What good examples of OO design using a procedural language are there, apart from GTK+?

Which open source projects are good examples of procedural design, on the other hand? (preferably C)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:34:58.170

在 C 中，OO 编程通常采用在结构指针上调用特定初始化和清理函数的形式，对于多态性，传递函数指针的结构。我能想到的一个例子是 KVM。

# python - Adding convenience static / class methods without removing or breaking existing implementation

> ID：11278938
> 
> 赞同：0
> 
> 时间：2012-07-01T01:27:32.917
> 
> 标签：python, static, class-method

I am getting the hang of the OOP paradigm, and the art of making expandable and reusable code is something I want to improve at. Let's say in theory that I have a Python library of utility classes that has been widely used. I want to add some convenience static methods with the same code to a particular class for ease of use, but I don't want to break my existing use of the library. What is the recommended way to implement and name the new class methods? I have a couple of guesses as follows:

1) With an overloaded method name to maintain clarity? Python's not really a good example, but in other languages such as Java? For example:

```
class Cat(object):
    def __init__(self, name):
        self.name = name

    def meow(self):
        meow(self.name)

    @staticmethod
    def meow(name): # <-- Granted, Python doesn't overload method names
        print "{} meowed cutely!".format(name) 
```

2) With a different, perhaps less semantic static method name? The old name cannot be changed, so... This seems to me this could get out of hand for huge projects, with a bunch of non semantic names for just a static version of the same method. Example:

```
class Cat(object):
    def __init__(self, name):
        self.name = name

    def meow(self):
        meowFrom(self.name)

    @staticmethod
    def meowFrom(name): # Different, possibly less semantic name
        print "{} meowed cutely!".format(name) 
```

I assume duplicating the code outright is a bad idea. Which is the way to go? Or is there some better design pattern? Something specific for Python I am unaware of? I want to make sure my code isn't worthless in the future; and make some personal libraries that are expansive for future projects.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:38:31.587

您可以向函数添加可选参数和关键字参数，而不会破坏它的现有用途。例如，您可以在末尾添加一个 protocol=old 参数来选择要使用的行为，在没有显式参数的情况下，旧行为是默认的。如果您想保持相同的函数名称，这是最好的选择，但如果您多次这样做，它很快就会变得笨拙。

# android - Andengine (GLES 2), code compiled into .JAR instead of .APK

> ID：11278939
> 
> 赞同：1
> 
> 时间：2012-07-01T01:27:37.557
> 
> 标签：android, andengine

I am trying to build my first Android application project in Eclipse IDE with Andengine as library. It's compiled OK, but when I try to run there is an error that says:

`[2012-07-01 07:18:08 - Android] Could not find Android.apk!`.

I'm following this tutorial : [http://perle-development.com/tutorials/andengine-tutorial-01-creating-a-scene/](http://perle-development.com/tutorials/andengine-tutorial-01-creating-a-scene/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-14T08:55:54.380

想办法。只需确保未选中“IsLibrary”即可。

# javascript - Chars in Javascripts function returing false even though charcters do not satisify if condition

> ID：11278940
> 
> 赞同：1
> 
> 时间：2012-07-01T01:28:20.590
> 
> 标签：javascript, function, dom

I am trying to learn JavaScript... I have function like, I take the format user id field... which is an email address and try to check if it matches below condition. However even thought I give the user name >3 and domain as gmail.com, I still get false return...Can someone please check and let me know why it is going into the if loop, do I have to trim the text or something.

Also if you can tell me how to write this effectively using jQuery that would help me learn. But if you think I am mixing two thing here... My priority is first question above.

```
function isValidate(eltt) {

    var flag      = true;
    var upos      = eltt.indexOf("@");
    var uendpos   = eltt.indexOf(".com");
    var totlength = eltt.length;
    var domain    = eltt.slice(upos,totlength);

    if ( upos < 3 | domain!="gmail.com" | uendpos=== -1) {
        flag=false;
    }

    return flag;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:33:15.503

首先，问题是您使用`|`的是`||`. （这`|`是一个按位或，在这种情况下，它将通过组合条件的二进制表示的位来产生一个基本随机的结果。很有可能，你永远不需要`|`；所以使用`||`并忘记它`|`甚至可以自己做任何事情。）

其次，使用正则表达式进行验证会更容易：

```
if (!eltt.match(/^.{3,}@gmail\.com$/)) {
  return false;
} 
```

也就是说，它必须以 ( `^`) 开头，至少三个字符`.{3,}`，然后是文字文本`@gmail.com`，后面没有任何内容 ( `$`)。

# javascript - 选择具有由 data() 设置的某些值的 JQuery 元素

> ID：11278944
> 
> 赞同：-1
> 
> 时间：2012-07-01T01:29:13.840
> 
> 标签：javascript, jquery

> **可能重复：**
> [jquery 数据选择器](https://stackoverflow.com/questions/2891452/jquery-data-selector)

我有几个带有“connection_name”类的元素。这些元素中的每一个都有一个使用 data() JQuery 函数绑定到它的唯一 id。我正在尝试查询以查找具有给定 id 的元素，但我似乎无法让它工作。

为了这个测试，我创建了一个只有 1 个元素的页面，并设置了元素的 id。

我可以验证是否正在设置 id，因为当我在控制台中查询元素时，它会显示返回的 id：

```
$('.connection_name').data()
  Object
  id: "4fea76bd99ea080d19000002"
  __proto__: Object 
```

我已经阅读了其他问题/帖子，该元素应由 $('selector[data-attribute=value]') 选择，但这似乎不起作用：

```
$('.connection_name[data-id="4fea76bd99ea080d19000002"]')
[] 
```

更糟糕的是，即使我尝试不带任何值（仅通过属性）选择它，我仍然什么也不返回：

```
$('.connection_name[data-id]')
[] 
```

我不确定问题是什么，或者如何去做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T01:31:52.393

这是一种方法：

```
var theItem = $('.connection_name').filter(function() {
    return($(this).data("id") === "4fea76bd99ea080d19000002");
}); 
```

# jquery - 允许用户向自动完成列表添加选项（预先输入引导程序）

> ID：11278947
> 
> 赞同：2
> 
> 时间：2012-07-01T01:30:49.477
> 
> 标签：jquery, autocomplete, twitter-bootstrap, typeahead

有很多关于[预输入](http://twitter.github.com/bootstrap/javascript.html#typeahead)（[https://gist.github.com/1866739](https://gist.github.com/1866739)）的线程和示例以及分叉版本，但我根本找不到任何关于允许用户“添加”他/她所写内容的内容，如果它不在列表中。如果用户在有 0 个结果时继续输入，则结果`ul`被隐藏...

![预输入](../Images/8da77d7cc83a03e4c2cce34ef23829f5.png) ![在此处输入图像描述](../Images/87c560dd58b97c9fe18fa12ed78a0977.png)

我想添加一个`<li>`input 的值（我知道该怎么做），但是**如果用户继续输入 input 并且有 0 个匹配项，下拉菜单就会消失**。

当我归结为 1 匹配 "count li" for amount: "1" 有效，但计数 0 不起作用时，如果没有匹配项，就好像整个列表再次“重新填充”。

链接、提示或示例将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T02:15:18.450

我真的不明白是什么问题，但我假设那是因为它很容易而且你只是看不到它。

而不是有一个按钮让用户添加自己的兴趣（而不是从列表中选择它 - 你的`source`），你可以简单地接受用户价值使用`$('.typeahead').val();`

这是一个[现场演示](http://jsbin.com/ixefam/2)，您可以随意添加您自己的项目并按下`Enter`以有效地将它们作为`typehead`来源。

在您的页面中，您实际上可以使用`$.ajax()`一次将新项目添加到您的数据库中，或者等到用户提交表单并添加它。

# c# - TcpClient 连接

> ID：11278953
> 
> 赞同：1
> 
> 时间：2012-07-01T01:32:28.937
> 
> 标签：c#, networking, tcpclient

我正在编写一个应用程序来向服务器发送/接收一些数据。我需要在发送一些数据之前建立连接，并且需要保持打开状态，以便用户可以连续发送数据。用户可以随时通过单击断开连接按钮来关闭连接。我创建了 2 个按钮，一个用于连接，一个用于断开连接。断开连接按钮后面的代码如下：-

```
 private void button1_Click(object sender, EventArgs e)
    {
        if (tcpclnt.Connected)
        {
            tcpclnt.Client.Disconnect(false);
            stm.Close();
        }
        else
        {
            MessageBox.Show("Not Connected");
        }
    } 
```

连接按钮后面的代码如下：-

```
 public ASCIIEncoding asen = new ASCIIEncoding();
    public TcpClient tcpclnt = new TcpClient();
    public NetworkStream stm;

    private void Connect_Click(object sender, EventArgs e)
    {
        if (!tcpclnt.Connected)
        {                
            tcpclnt.Connect("XX.XX.XX.XX", 5500);
            MessageBox.Show("Connected to server");

            stm = tcpclnt.GetStream();

            string sysname = "000B0000" + SystemName.Text.ToString();
            byte[] sys1 = asen.GetBytes(sysname);
            sys1[0] = 0; sys1[1] = 0;
            sys1[2] = 0; sys1[3] = 0xB;
            sys1[4] = 0; sys1[5] = 0;
            sys1[6] = 0; sys1[7] = 0;
            try
            {
                stm.Write(sys1, 0, sys1.Length);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
                MessageBox.Show("Error in Sending data");
            }
            if (stm.DataAvailable)
            {
                try
                {
                    byte[] bb = new byte[600];
                    int k = 8;                        
                    k = stm.Read(bb, 0, bb.Length);
                    string value = ASCIIEncoding.ASCII.GetString(bb, 8, k - 8);
                    MessageBox.Show(value.ToString());
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                    MessageBox.Show("Error in Reading data");
                }
            }                
         }
         else {
                MessageBox.Show("Already Connected");
        }
    } 
```

现在，当我单击断开连接按钮并再次单击连接按钮时，它会在 tcpclient.connect 行上引发异常。我不明白为什么或如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T05:50:34.900

不是该主题的专家，但我认为可能的解决方案是使用 tcpclnt.Close() 优雅地关闭连接。如果您不这样做或让垃圾收集器不优雅地这样做，那么您将无法重新连接（我认为）。关闭流，然后关闭 tcpclnt 而不是断开连接。

```
tcpclnt.GetStream().Close();
tcpclnt.Close(); 
```

另外，不要使用 tcpclnt.Connected 检查是否有连接。只需简单地关闭它。

**编辑**

以上不起作用。我不知道如何重用套接字。这就是我让它工作的方式......

```
private void DisconnectButton_Click(object sender, EventArgs e)
{
    tcpclnt.Close();
    tcpclnt = new TcpClient();
} 
```

您提到重新实例化对象会创建额外的线程。这可能是真的，因为我不确定如何对此进行测试。我打开了 Windows 资源监视器并观察了应用程序的线程数，但每次都没有显示额外的线程打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:54:43.200

您的 .Disconnect() 调用需要将 true 作为参数以允许重用。您当前正在告诉套接字不允许重新连接。[有关文档，请参见此处](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.disconnect.aspx)。

# php - 从特定行开始通过php将csv转换为mysql？

> ID：11278956
> 
> 赞同：0
> 
> 时间：2012-07-01T01:33:17.103
> 
> 标签：php, mysql, csv

我有下面的代码可以工作，但我想从我的 csv 文件的第二行将值插入到我的数据库中。请任何指针都会很棒。

```
$con = @mysql_connect($databasehost,$databaseusername,$databasepassword) or die(mysql_error());
@mysql_select_db($databasename) or die(mysql_error());

$row = 1; 
if (($handle = fopen($csvfile, "r")) !== FALSE) { 
while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) { 
$num = count($data); 
echo "<p> $num fields in line $row: <br /></p>\n"; 
$row++; 

for ($c=0; $c < $num; $c++) { 
echo $data[$c] . "<br />\n"; 
           } 

$query = "INSERT into $databasetable(email,emailSource,espBanner,firstName,lastName,Address,City,
State,zip,home,mobile,card,ethnicity,language,gender,filename,is_uploaded)
                values('$data[0]','$data[1]','$data[2]','$data[3]','$data[4]','$data[5]','$data[6]'
,'$data[7]','$data[8]','$data[9]','$data[10]','$data[11]','$data[12]','$data[13]',
'$data[14]','$data[15]','$data[16]')";

 mysql_query($query) or die(mysql_error());

     } 
 fclose($handle); 

 } 
```

结果将插入 csv 的每一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:41:29.260

```
$con = @mysql_connect($databasehost,$databaseusername,$databasepassword) or die(mysql_error());
@mysql_select_db($databasename) or die(mysql_error());

$start_from_row = 2;
$row = 0;
if (($handle = fopen($csvfile, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $num = count($data);
        echo "<p> $num fields in line $row: <br></p>\n";
        $row++;
        if($row < $start_from_row)
            continue;

        for ($c=0; $c < $num; $c++) {
            echo $data[$c] . "<br>\n";
        }

        $query = "INSERT into $databasetable(email,emailSource,espBanner,firstName,lastName,Address,City,
        State,zip,home,mobile,card,ethnicity,language,gender,filename,is_uploaded)
        values('$data[0]','$data[1]','$data[2]','$data[3]','$data[4]','$data[5]','$data[6]'
        ,'$data[7]','$data[8]','$data[9]','$data[10]','$data[11]','$data[12]','$data[13]',
        '$data[14]','$data[15]','$data[16]')";

        mysql_query($query) or die(mysql_error());

    }
    fclose($handle);

} 
```

# jquery - 如何在 ASP.Net 中打开 jQuery UI 模式对话框？

> ID：11278959
> 
> 赞同：0
> 
> 时间：2012-07-01T01:33:57.303
> 
> 标签：jquery, asp.net, jquery-ui

我一直在疯狂地试图在 ASP.Net (C#) 中打开一个模式对话框！我已经进行了两次演练，但没有得到任何结果。我得到的只是没有对话框的完整网页，但现在右上角有一个“X”。谁能告诉我如何做一个简单的对话框？

这是我的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>

    <link rel="Stylesheet" type="text/javascript" href="Styles/jquery-ui.css" />
    <script type="text/javascript" language="javascript" src="jquery-1.5.2.min.js"></script>
    <script type="text/javascript" language="javascript" src="jquery-ui.js"></script>

    <script type="text/javascript" language="javascript">
            $(document).ready(function () {
                $("#dialog").dialog();
            });
    </script>
</head>
<body style="font-size:62.5%;">
    <div id="dialog" title="Dialog Title">I'm in a dialog.. Really!</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T01:51:41.080

我看不出你的代码有什么问题。jquery 脚本文件和 css 文件是否正确并正确链接？[这](http://jsfiddle.net/67kME/)是显示您的代码工作的演示。

**编辑**：其实我只是注意到了一些东西。就像 undefined 提到的那样，您的 css 链接似乎不正确。`text/javascript`您应该将链接类型设置为`text/css`.

您的 css 文件的链接很可能如下所示：

```
<link rel="Stylesheet" type="text/css" href="Styles/jquery-ui.css" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T01:53:22.930

如果您使用的是严格的文档类型，请尝试将链接标记更改为`<link rel="stylesheet" type="text/css" href="styles/jquery-ui.css" />`，这听起来样式表未正确加载。

# tcl - 如何编辑从期望脚本中删除过多的精确行？

> ID：11278960
> 
> 赞同：0
> 
> 时间：2012-07-01T01:34:06.383
> 
> 标签：tcl, expect

我使用expect创建了一个expect脚本，并且我意识到expect -exact的构造是为了匹配包含大量不必要输出的行。例如，当我执行 postgresql restore 命令时，所有 psql 输出都包含在 expect -exact 行中。

可以使用哪些其他语法来修剪 expect -exact 行？在某些情况下可以删除它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T12:49:28.357

通过观察会话中的活动来生成脚本的工具肯定容易认为过于重要。他们根本不明白什么是重要的。通常，摆脱不必要的预期片段的方法是使用文本编辑器将它们删除。需要注意的地方是您即将到达的地方`send`（或`exp_send`；有一些变化）；在 a之前总是有 a`expect`的*东西*`send`是个好主意，但是应该是什么需要你的一些聪明才智。

* * *

稍后，您可能想要编写脚本来处理多个条件，在这些条件下通过`expect`一次 ing 几件事来采取行动。那是你写这样的东西的时候：

```
expect {
   "abc" {
      send "foo\r"
   }
   "def" {
      send "bar\r"
   }
} 
```

自动化访问应用程序的复杂性比最初看起来要复杂得多，因为应用程序通常*比*最初看起来要复杂得多。

# javascript - Firefox drawImage 将图像着色为蓝色

> ID：11278963
> 
> 赞同：1
> 
> 时间：2012-07-01T01:34:52.843
> 
> 标签：javascript, fancybox

我的客户在 Windows 上的 Firefox 12 中遇到了一个奇怪的错误：画布中绘制的图像周围出现了一个蓝色的框。画布位于fancybox div 内的iframe 内。您可以通过单击本网站主图像下的图像缩略图来查看此操作： [http ://mattmatthias.com/a/index.php?route=product/product&path=20&product_id=80](http://mattmatthias.com/a/index.php?route=product/product&path=20&product_id=80)

起初，我认为这是一个选择问题，尽管绘制的图像本身而不是整个画布似乎反驳了这一点。我一次又一次地尝试`blur`画布、容器 div、iframe ......一切都无济于事。

更糟糕的是，我无法重现此错误。在我的 Mac 上，一切都在 Safari、Firefox、Chrome 和 Opera 中正常运行。

![蓝色阴影](../Images/e4a3d7883cfe668f84b01c6661db7795.png)

这可能是有问题的代码，因为它是代码中唯一可以绘制任何内容的部分：

```
 if(imageWidth == 0) return;

    context.clearRect(0, 0, canvasWidth, canvasHeight);

    var x_adjust = -x-(ratio*canvasWidth    -canvasWidth        )/2;
    var y_adjust = -y-(ratio*canvasHeight   -canvasHeight       )/2;

    var width   = scaledWidth*ratio;
    var height  = scaledHeight*ratio;

    if(x_adjust < canvasWidth - width)
        x_adjust = canvasWidth - width;

    if(x_adjust > 0)
        x_adjust = 0;

    if(y_adjust < canvasHeight - height)
        y_adjust = canvasHeight - height;

    if(y_adjust > 0)
        y_adjust = 0;

    if(width < canvasWidth) {
        x_adjust += (canvasWidth - width) / 2;
    }
    if(height < canvasHeight) {
        y_adjust += (canvasHeight - height) / 2;
    }

    context.drawImage(image, 0, 0,
                      imageWidth, imageHeight,
                      x_adjust, y_adjust,
                      width, height); 
```

有任何想法吗？当我得到更多细节时，我会在这里发布它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:17:47.473

这与画布无关；只是在 Firefox 中打开[图像显示同样的事情。](http://mattmatthias.com/a/image/data/rota/Sesheta/Sesheta_1.jpg)所以这是读取/渲染图像的问题。

[这个 Mozilla 支持问题](http://support.mozilla.org/de/questions/766707)听起来正是这里发生的事情，它与颜色管理问题有关。

事实上，从图像文件中删除颜色配置文件会使图像看起来正确。

根据具体情况，您可能想要进行一些转换，而不是仅仅剥离配置文件；这是否有必要取决于特定的图像、配置文件，以及色彩管理甚至远程有机会在访问者的显示器上产生有意义的东西的可能性有多大（除非你迎合平面设计师：可能不是很大）。

# php - 如何使用 php cURL 传递嵌套数组

> ID：11278967
> 
> 赞同：0
> 
> 时间：2012-07-01T01:35:22.737
> 
> 标签：php, jquery, curl, salesforce

我正在通过 jQuery 通过 .val() 方法收集表单帖子，验证这些帖子并将错误传递回表单输入，或者将 true 传递给调用 PHP cURL 脚本的 .$post 方法。

典型的 var 如下所示：

```
var industs_servedVal = $('#industs_served').val(); 
```

在这种情况下，它是一个选择多个表单字段。我知道 jQuery 中的 .val() 方法传递了一个数组，所以这看起来很合理，我说 var 也会收集数组是对的。

然后我像这样将 var industs_servedVal 传递给 $.post 方法（然后向上滑动感谢信）：

```
$.post('../inc/form_sendsf_modified.php', {
            othervars: othervarsVal;
            industs_served: industs_servedVal,              

        }, function(data) {
            $('#sendEmail').slideUp('slow', 'swing', function() {
                $('#sendEmail').replaceWith('<h3>Thank you!</h3><p>Your message was sent to us. We\'ll get back to you as soon as we can.</p>');
            });
        });
    }
    return false;
}); 
```

文件“form_sendSF_modified.php”处理这些帖子并使用 cURL 发送到 Sales Force Cloud。这行得通；但是，**问题在于销售人员将“数组”显示为接收到的多字段数组的值，而不是数组值本身**。我收集阵列并将其传递给销售人员的方式是否存在问题。如代码所示，foreach 循环是否能够将多个字段数组值以及其他值作为数组发送。

```
$post_data['00N70000002U2fA'] = $_POST['industs_served']; //Array

//$otherpost data

//cURL CODE for post
//traverse array and prepare data for posting (key1=value1) 
foreach ( $post_data as $key => $value) {
    $post_items[] = $key . '=' . $value;
}
//create the final string to be posted using implode()
$post_string = implode ('&', $post_items);
//create cURL connection to SFDC
$curl_connection = curl_init('https://www.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8');
//set options
curl_setopt($curl_connection, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($curl_connection, CURLOPT_USERAGENT,
"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
curl_setopt($curl_connection, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl_connection, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl_connection, CURLOPT_FOLLOWLOCATION, 1);
//set data to be posted
curl_setopt($curl_connection, CURLOPT_POSTFIELDS, $post_string);
//perform our request
$result = curl_exec($curl_connection);
//show information regarding the request
//print_r(curl_getinfo($curl_connection));
//echo curl_errno($curl_connection) . '-' .
curl_error($curl_connection);
//close the connection
curl_close($curl_connection);
//End cURL 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T11:18:34.057

用这个

```
$post = "ac=on&p=1&pr[]=0&pr[]=1&a[]=3&a[]=4&pl=on&sp[]=3&ct[]=3&s=1&o=0&pp=3&sortBy=date";
parse_str($post,$fields); 

$url = 'http://example.com/';

//open connection
$ch = curl_init();

//set the url, number of POST vars, POST data
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, true);
curl_setopt($ch,CURLOPT_POSTFIELDS, $fields);
curl_setopt($ch,CURLOPT_RETURNTRANSFER, true);

//execute post
$result = curl_exec($ch);

//close connection
curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T05:42:01.537

您可以使用数组本身（但它会将 Content-Type 标头更改为 multipart/form-data）。

```
curl_setopt($curl_connection, CURLOPT_POSTFIELDS, $post_data); 
```

[或者您可以使用带有http_build_query](http://www.php.net/manual/en/function.http-build-query.php)函数的构建字符串，参见示例 #3。

# wordpress - 如何从 WordPress 插件中的类调用函数？

> ID：11278971
> 
> 赞同：3
> 
> 时间：2012-07-01T01:36:29.433
> 
> 标签：wordpress

我正在使用一个名为“Cartpauj PM”的 WordPress 插件来发送私人消息，我想在我的网站主页上显示新消息的数量。

该插件有一个文件`pm-class.php`，其中有一个类`cartpaujPM`，里面有一个获取新消息的函数，如下所示：

```
function getNewMsgs()
    {
        global $wpdb, $user_ID;

        $get_pms = $wpdb->get_results($wpdb->prepare("SELECT id FROM $this->tableMsgs WHERE (to_user='$user_ID' AND parent_id=0 AND to_del<>1 AND message_read=0 AND last_sender<>'$user_ID') OR (from_user='$user_ID' AND parent_id=0 AND from_del<>1 AND message_read=0 AND last_sender<>'$user_ID')"));
        return $wpdb->num_rows;
    } 
```

我怎么能在我的主题模板文件中调用这个函数？在插件文件中它调用就像`$example_variable=this->getNewMsgs();`做一个`echo $example_variable`之后。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-01T08:35:15.837

```
$some_variable = new cartpaujPM();

$some_variable->getNewMsgs(); 
```

# javascript - 用于将 wiki 文本转换为 HTML 的 Jquery/Javascript 解决方案，反之亦然？

> ID：11278973
> 
> 赞同：7
> 
> 时间：2012-07-01T01:37:17.057
> 
> 标签：javascript, jquery, html, translation, wiki

对于我的 Web 前端，我必须在我的系统中实现 wiki 语法的子集。我是否需要手动指定规则并重新发明轮子？是否有现有的 javascript 库或 jquery 插件可以提供帮助？

例如，用户输入`== Header ==`因为这需要转换为例如媒体标头（假设媒体在此上下文中定义为如下所示的跨度）

```
<span class="mediumHeader" id = "Header">Header</span> 
```

现在，当用户编辑上面的文本时，我猜它会涉及替换

`<span...> ... </span>`和`==...==`

现在，对于我设计的每个系统，这都将按照“我的规则”，并且几乎总是必须重新发明轮子。有什么东西可以让我使用 Jquery/Javascript 来简化这个 wiki 与 HTML 之间的转换吗？我确定这是已知解决方案的问题。

我更愿意自定义什么是可接受的，什么不是，即我不会将所有内容都翻译成 wiki 语法（或 HTML），只是它的子集。我应该为我的应用程序自己滚动吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T18:05:39.450

它已经足够长了，你可能不需要这个，但是当我开始研究它时，你的就是最热门的。

有几个 javascript 选项 - 您可能正在查看[`instaview`](https://github.com/cscott/instaview)（查看 test/test.js），或者可能正在查看[`Wiky.js`](https://github.com/tanin47/wiky.js)（文档不太完整）。

如果您不限于 Javascript，请查看[http://www.mediawiki.org/wiki/Alternative_parsers](http://www.mediawiki.org/wiki/Alternative_parsers)上的 MediaWiki 解析器的详尽列表- 大量用于 C++、Java、Perl、ruby 等的工具。这是关注新发展的链接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-20T15:40:41.413

在撰写本文时，[Parsoid](http://www.mediawiki.org/wiki/Parsoid)似乎是唯一一个双向翻译的。这也为 Wikipedia 上的可视化编辑器提供支持。但这不是包含在您的应用程序中的方便的客户端库，而是一个成熟的解析和转换服务器套件。可以在[http://parsoid-lb.eqiad.wikimedia.org/](http://parsoid-lb.eqiad.wikimedia.org/)访问 Wikimedia 集群上的 Parsoid 生产版本。

其他仅从 WikiText 翻译成 HTML（按受欢迎程度排序）的 JavaScript 库有：

*   [Wiki.js](https://github.com/tanin47/wiky.js) - 不支持完整的 WikiText 语法。（由 tanin47 提供，不要与 Requarks 的 Wiki.js 混淆——完全不同的项目）
*   [wtf_wikipedia](https://github.com/spencermountain/wtf_wikipedia/) - 不是直接转换为 HTML 而是 JSON，这会产生更强大的可能性（例如作为键值对的信息框）。这是最新的库，“*它结合了 instaview、txtwiki，并使用来自 Parsoid javascript 解析器的跨语言数据。* ”
*   [instaview](https://github.com/cscott/instaview) - 过去 2 年没有更新。

[还可以查看替代 MediaWiki 解析器](http://www.mediawiki.org/wiki/Alternative_parsers)的当前和完整列表。

# java - 使用 List 并同时导入 java.awt.*

> ID：11278974
> 
> 赞同：-1
> 
> 时间：2012-07-01T01:37:34.707
> 
> 标签：java, arraylist

每当我导入 java.awt.* 并尝试使用 List 时，都会出现错误。

有什么方法可以导入 java.awt.* 并使用 List 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T09:26:36.273

awt 和 util 类中 List 的命名约定存在歧义，因此我们可以通过两种方式处理：

1.  使用导入

    `import java.awt.*;`

    `import java.util.List;`

    `import java.util.*;`

2.  使用完整路径，如 Head First Java 中所述，“使用导入或全名”

    `java.util.List<String> list = new java.util.ArrayList<String>();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T01:42:29.053

通过Google[快速搜索](http://www.horstmann.com/articles/BetterCleaner.html)

类名 List 现在是不明确的，因为有两个类 java.awt.List 和 java.util.List。您可以通过添加类名的特定导入来解决歧义：

```
import java.awt.*;
import java.util.*;
import java.util.List; 
```

但是，如果您需要在同一个源文件中同时引用 java.awt.List 和 java.util.List，那么您已经越过了导入机制的限制。您可以使用 import 语句将其中一个名称缩短为 List，但只要在源文本中出现另一个名称，您就需要通过其全名来引用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T01:43:03.540

问题是 java.awt 里面也有一个 List，所以当你调用 List 时编译器不知道你使用的是哪一个。

我想你会这样称呼你的名单：

```
java.util.List list = new java.util.List(); 
```

所以这样编译器就知道你指的是哪个“列表”。

# php - 可以在 PHP 脚本中“撤消”发送 HTTP 标头和此类中间执行吗？

> ID：11278975
> 
> 赞同：1
> 
> 时间：2012-07-01T01:37:56.757
> 
> 标签：php, http, buffer

我正在编写一个小的 PHP 身份验证库（请推迟“不要自己编写”。我以前做过）。作为我的库的一部分，我希望能够在某些情况下“中止”执行。

例如，举这个例子：

```
<html>
<head></head>
<body>
<?php
  $auth=... 
  $auth.RequiresInGroup("admin");
?>
</body>
</html> 
```

我想要`RequiresInGroup`做的基本上是检查用户是否已登录（通过查看 cookie 等）.. 如果他们没有登录或未在该组中，那么它需要发回 401 错误并做一个服务器-side 重定向到未经授权的页面。

我知道我可以将我的`<?php..`声明移到上面`<html>`来完成这项工作，但我试图涵盖所有可能的用例（包括糟糕的代码设计）。

PHP中是否有一种方法可以基本上推迟向客户端发送内容直到请求结束，或者在执行过程中发送不同的HTTP标头然后退出脚本的类似方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T02:33:58.053

您需要阅读手册[http://www.php.net/manual/en/ref.outcontrol.php的“控制输出缓冲部分”](http://www.php.net/manual/en/ref.outcontrol.php)

直到您的第一个输出位才发送标头本身 - 然后发送响应代码，然后是您设置的客户标头。您可以使用 headers_sent() 函数查看它们是否已发送。但是一旦你设置了标题，你就不能真正取消它们。

所以缓冲你需要发送的内容，然后在应用程序结束时吐出缓冲区。

* * *

编辑：另一种方法（也是我更喜欢的方式，虽然它依赖于全局或单例类，但都可能不赞成）是创建自己的“输出”类。将其设置为全局（或单例）并将输出附加到它。然后，您可以随意发送标头，并在执行结束时抽出您的输出。不像 ob_functions 那样“单元测试友好”，但更易于调试和控制。

# php - 在 CakePHP 中，为什么使用 HTML->link 而不是手动编写锚文本？

> ID：11278978
> 
> 赞同：1
> 
> 时间：2012-07-01T01:38:34.240
> 
> 标签：php, cakephp, hyperlink

开发时间不会慢很多吗？

HTML->link 的优点是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T01:49:18.833

这只是您是否要生成自己的 URL 并对其进行硬编码，或者您是否希望 Cake 为您完成工作的问题。对于通向您网站主页的简单 url，使用 cake 可能看起来更慢，但它实际上对动态 url 很有用，例如：

假设您正在打印一个项目表，并且每个项目都有一个删除该项目的链接。您可以使用以下方法轻松创建它：

```
 <?php
    echo $this->Html->link(
    'Delete',
    array('controller' => 'recipes', 'action' => 'delete', $id),
    array(),
    "Are you sure you wish to delete this recipe?"
); 
```

请注意使用数组指定控制器和操作作为 URL 是如何允许您不知道任何自定义路由的。这可以有它的优点。

没有 HTML 帮助器的相应方法是：

```
<a href="/recipes/delete/<?php echo $id; ?>" onclick="return confirm('Are you sure you wish to delete this recipe?');">Delete</a> 
```

* * *

它对于自动构建 URL 查询字符串也非常有用。例如，您可以以数组格式执行此操作：

```
<?php
echo $this->Html->link('View image', array(
    'controller' => 'images',
    'action' => 'view',
    1,
    '?' => array('height' => 400, 'width' => 500))
); 
```

然后输出这行 HTML：

```
<a href="/images/view/1?height=400&width=500">View image</a> 
```

手动生成该 URL 可能会很痛苦。

* * *

总而言之，虽然对于简单的链接来说它可能看起来很尴尬，但 HTML 帮助器肯定有它的用途。如需进一步使用，请参阅[cakePHP 书籍中关于 HTML 帮助程序的链接功能](http://book.cakephp.org/2.0/en/core-libraries/helpers/html.html#HtmlHelper%3a%3alink)。

# visual-studio - .master 在 DreamWeaver 解决方案中？

> ID：11278979
> 
> 赞同：2
> 
> 时间：2012-07-01T01:38:43.360
> 
> 标签：visual-studio, dreamweaver

我同时拥有 Dreamweaver CS5.5 和 Visual Studio Ultimate 2010。这两个程序我都很喜欢，但我真的想要一种方法来完成我在 Dreamweaver 中的所有前端编码，然后在 VS.Net 中使用数据库。

我通过在 VS.Net 中制作所有页面，然后单击“使用 Dreamweaver 打开”来完成此操作。尽管每次我使用 Dreamweaver 打开 .master 文件时，它都会折叠成空白编码，可能是因为它无法识别它。我之前对此进行了研究，并尝试通过将内容添加到 documentType 文件夹来解决问题，但没有任何反应。我真的需要 Dreamweaver 中的一些支持，因为我总是在更改页面的设计，并且每个页面都使用一个母版文件。

另一个问题是母版页使用 .swf 文件和大量 javascript，这在 VS.Net 中使用起来很痛苦，因为代码提示无法正常工作。

有没有人可以解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T03:47:23.203

我还没有测试过，但看看这个：[http ://alexle.net/archives/119](http://alexle.net/archives/119)

> *   转到**[Your_Drive_Here]:\Program Files\Macromedia\Dreamweaver MX 2004\Configuration**
> *   打开文件**Extensions.txt**并将您的自定义扩展名添加到列表中。
>     ...
>     
>     
> *   转到**DocumentTypes文件****夹**（仍然在同一路径中），使用文本编辑器（即记事本或记事本++）。不建议使用 Dreamweaver 编辑这个特定的 xml 文件，因为该软件可能会因为它被用于编辑自身而变得疯狂。
>     
>     
> *   转到 l* *ine 67* *，将 THTML 扩展添加到**winfileextension**和**macfileextensionlist**属性。这是代码摘录

此说明适用于 Dreamweaver MX 2004，但可能适用于更改`Macromedia\Dreamweaver MX 2004`（`Adobe\Adobe Dreamweaver CS5.5`我没有 CS5.5，但假设这在 CS4（我的版本）之前没有更改，它将在那里。

# arrays - 如何在 j2me 中显示或转换整数数组？

> ID：11278982
> 
> 赞同：1
> 
> 时间：2012-07-01T01:39:15.757
> 
> 标签：arrays, java-me, integer

这个问题很简单，但我找不到答案。

我正在使用 j2me。我有一个包含 9 个元素的整数数组。经过所有的计算，现在我想打印它或以表格形式显示它。

它类似于 Integer.toString(); 与数组一起使用？我知道我可以使用循环，但我想知道它是否是一种更快的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T05:13:17.840

使用循环，但不要使用 String + 运算符。使用 StringBuffer.append()。

# objective-c - 来自 mapView 的屏幕截图/快照存储空白地图

> ID：11278983
> 
> 赞同：1
> 
> 时间：2012-07-01T01:39:20.873
> 
> 标签：objective-c, ios, xcode, uiimage, mkmapview

我想截取 MapView 的屏幕截图并保存到照片中

这是使用的来源：

```
- (IBAction)screenshot:(id)sender {

if ([[UIScreen mainScreen] respondsToSelector:@selector(scale)])
    UIGraphicsBeginImageContextWithOptions(mapView.frame.size, NO, [UIScreen mainScreen].scale);

else

UIGraphicsBeginImageContext(mapView.frame.size);
[mapView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage * viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil); 
```

}

动作成功了，但是这里的照片是这样的 [MapView 截图](http://tweak-apps.de/FOTO.JPG)

我不知道出了什么问题。我已经尝试了一些代码。所有的结果都是一样的。如果我对整个视图进行截图，地图也看起来像上图。

有没有人有任何想法或可以帮助我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T02:33:41.727

**编辑：**

```
 - (UIImage*) ImageFromMapView
{
  UIGraphicsBeginImageContext(self.frame.size);
  [self.layer renderInContext:UIGraphicsGetCurrentContext()];
  //[[[yourmapView.layer sublayers] objectAtIndex:1] renderInContext:UIGraphicsGetCurrentContext()];  try this upper fails
  UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
  UIGraphicsEndImageContext();  
  return image;
} 
```

* * *

尝试使用 UIGraphicsBeginImageContextWithOptions 而不是 UIGraphicsBeginImageContext：

```
 UIGraphicsBeginImageContextWithOptions(self.frame.size, NO, 0.0); 
```

注意：从 iOS 4 开始，UIGraphicsBeginImageContextWithOptions 允许您提供比例因子。零比例因子将其设置为设备主屏幕的比例因子。这使您能够获得最清晰、分辨率最高的显示器快照，包​​括 Retina 显示器。

# c# - 如何在网格视图中的一行上添加 onclick 事件（Windows 窗体应用程序）

> ID：11278985
> 
> 赞同：0
> 
> 时间：2012-07-01T01:39:42.887
> 
> 标签：c#, .net, winforms

有一个后台工作人员，一个 tableLayoutPanel，以及我添加（动态 - 以编程方式）到 tablelayoutpanel 的一堆网格视图和标签。

上面的代码工作正常，但我需要在每次将添加到 gridview 的行上添加一个 onclick 事件。我怎样才能做到这一点？

```
 var lbltotalcount = tableLayoutPanel1.Controls.Find("lbltotalcount_" + GridId, true);
            ((Label)lbltotalcount[0]).Invoke((MethodInvoker)delegate
            {
                ((Label)lbltotalcount[0]).Text = (Convert.ToInt32(((Label)lbltotalcount[0]).Text) + NumOfMatch).ToString();
            });    

            var obj = tableLayoutPanel1.Controls.Find("dgv_" + GridId, true);

            ((DataGridView)obj[0]).Invoke((MethodInvoker)delegate
            {
                string[] row = new string[] { Word, txturl.Text, Url, NumOfMatch.ToString() };

                DataGridViewRow dgvRow = new DataGridViewRow();
                DataGridViewCell dgvCell;

                dgvCell = new DataGridViewTextBoxCell();                
                dgvCell.Value = Word;
                dgvRow.Cells.Add(dgvCell);                

                dgvCell = new DataGridViewTextBoxCell();
                dgvCell.Value = txturl.Text;
                dgvRow.Cells.Add(dgvCell);

                dgvCell = new DataGridViewTextBoxCell();
                dgvCell.Value = Url;
                dgvRow.Cells.Add(dgvCell);

                dgvCell = new DataGridViewTextBoxCell();
                dgvCell.Value = NumOfMatch.ToString();
                dgvRow.Cells.Add(dgvCell);                                              

                ((DataGridView)obj[0]).Rows.Add(dgvRow);
                ((DataGridView)obj[0]).Refresh();
                ((DataGridView)obj[0]).Update();
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T02:03:14.907

我不确定那是你想要的..让我们试试吧..

```
 void yourMethod()
 {
  var lbltotalcount = tableLayoutPanel1.Controls.Find("lbltotalcount_" + GridId, true);
          ((Label)lbltotalcount[0]).Invoke((MethodInvoker)delegate
        {
            ((Label)lbltotalcount[0]).Text =     (Convert.ToInt32(((Label)lbltotalcount[0]).Text) + NumOfMatch).ToString();
        });    

        var obj = tableLayoutPanel1.Controls.Find("dgv_" + GridId, true);

       ((DataGridView)obj[0]).SelectionChanged += new EventHandler(My_SelectionChanged);

        ((DataGridView)obj[0]).Invoke((MethodInvoker)delegate
        {
            string[] row = new string[] { Word, txturl.Text, Url, NumOfMatch.ToString() };

            DataGridViewRow dgvRow = new DataGridViewRow();
            DataGridViewCell dgvCell;

            dgvCell = new DataGridViewTextBoxCell();                
            dgvCell.Value = Word;
            dgvRow.Cells.Add(dgvCell);                

            dgvCell = new DataGridViewTextBoxCell();
            dgvCell.Value = txturl.Text;
            dgvRow.Cells.Add(dgvCell);

            dgvCell = new DataGridViewTextBoxCell();
            dgvCell.Value = Url;
            dgvRow.Cells.Add(dgvCell);

            dgvCell = new DataGridViewTextBoxCell();
            dgvCell.Value = NumOfMatch.ToString();
            dgvRow.Cells.Add(dgvCell);                                              

            ((DataGridView)obj[0]).Rows.Add(dgvRow);
            ((DataGridView)obj[0]).Refresh();
            ((DataGridView)obj[0]).Update();
          var index = ((DataGridView) obj[0]).RowCount;
          ((DataGridView) obj[0]).SelectedRows[index - 1].Selected = true;
        });  
  }

   void My_SelectionChanged(object sender, EventArgs e)
    {
      // bla bla ...

    } 
```

# python - 使用 Twitter 的 Streaming API 时更改 POST 请求参数

> ID：11278988
> 
> 赞同：1
> 
> 时间：2012-07-01T01:40:41.280
> 
> 标签：python, post, twitter, httprequest, python-requests

我正在使用 Python 和[Requests](http://docs.python-requests.org/en/latest/index.html)从[Twitter 的流 API](https://dev.twitter.com/docs/api/1/post/statuses/filter)请求数据。我想用一组参数请求数据，一段时间后，用一组新的参数改变请求。

在以下简单、有效的示例中，我向 Twitter 流式 API 询问带有关键字“python”的推文。一个小时后，我向 API 询问关键字“ruby”。但是，为此，我正在创建一个新的请求对象；我没有改变原始对象。

```
import requests
import json
import time

USER = 'user'
PW = 'pw'

def make_request(keyword):
    r = requests.post('https://stream.twitter.com/1/statuses/filter.json',
    data={'track': keyword}, auth=(USER,PW))

    for line in r.iter_lines():
        if line:
            print json.loads(line)

        if time.time() > start_of_last_request + 3600:
            break

count = 0

keywords = ['python', 'ruby']

while count < 2:
    start_of_last_request = time.time()

    make_request(keywords[count])

    count = count + 1 
```

最终，我需要每小时创建一个新查询，我担心会创建太多连接。

我的问题是：有没有更好的方法来更改对 Twitter API 的请求？我实际上是在创建多个连接吗？如果是这样，我该如何避免这种情况？（有一个关于如何[关闭以前的连接](https://stackoverflow.com/questions/10115126/python-requests-close-http-connection)的建议，但这个解决方案对我来说不太有意义。）

我将不胜感激任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T02:04:52.970

当您链接时，为了在完成请求后关闭连接，请将`keep-alive`值设置为`False`而不是默认值`True`：

```
r = requests.post('https://stream.twitter.com/1/statuses/filter.json',
               data={'track': keyword}, auth=(USER,PW),
               config={'keep_alive':False}) 
```

这将确保连接完成后关闭。

# iphone - 手势识别器会覆盖滚动视图的滚动能力吗？

> ID：11278989
> 
> 赞同：-1
> 
> 时间：2012-07-01T01:40:45.337
> 
> 标签：iphone, objective-c, ios, scrollview, uigesturerecognizer

在我的应用程序中，顶视图具有平移手势识别器，可将视图向左和向右移动以显示其下方的其他两个视图。我正在尝试将滚动视图放入顶视图，但我似乎无法让它滚动。我正在为滚动视图使用故事板，但手势识别器是以编程方式实现的。我将滚动条插图设置为超出大小。

我在想也许手势识别器优先于滚动视图的滚动能力，但我找不到任何检查方法。除非我正在查看一些愚蠢的东西，否则有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T01:53:30.927

UIScrollView 实现了一个私有的 UISwipeGestureRecognizer，它确实比任何其他手势都具有优先级。但是，许多人已经重写了它（这很容易，只需一个或两个 for-in 循环）挂钩它的事件或提供他们自己的子类，这是让其他手势同时识别的唯一方法。实际上，这就是您需要实现的委托方法的名称，`- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer`

# ruby - 访问 DSL 时的嵌套方法

> ID：11278993
> 
> 赞同：0
> 
> 时间：2012-07-01T01:41:42.090
> 
> 标签：ruby, dsl

```
class Warcraft 

  def initialize &block
    instance_eval &block
  end

  def method_missing name, *args, &block
    instance_variable_set("@#{name}".to_sym, args[0])
    self.class.send(:define_method, name, proc { instance_variable_get("@#{name}")})
  end

  def game &block
    @game = Game.new &block
  end

  class Game 
    def initialize &block
      instance_eval &block
    end

    def method_missing name, *args, &block
      instance_variable_set("@#{name}".to_sym, args[0])
      self.class.send(:define_method, name, proc { instance_variable_get("@#{name}")})
    end   
  end

end

warcraft = Warcraft.new do
  name "Warcraft III"
  battle_net :iccup

  game do
    side :sentinels
    hero "Furion"
    rune_appear_every 2
  end
end

puts warcraft.inspect # => #<Warcraft:0x00000000be3e80 @name="Warcraft III", @battle_net=:iccup, @game=#<Warcraft::Game:0x000000009c6c38 @side=:sentinels, @hero="Furion", @rune_appear_every=2>> 
```

如何访问嵌套方法？

```
puts warcraft.battle_net # => iccup
puts warcraft.side #=> #<Proc:0x000000010de6d8@dsl.rb:9 (lambda)>
puts warcraft.game #=> dsl.rb:18:in `instance_eval': block not supplied (ArgumentError)
puts warcraft.game.side #=> dsl.rb:18:in `instance_eval': block not supplied (ArgumentError) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T09:11:18.760

`puts warcraft.game`引发错误，因为您的`Warcraft#game`方法需要一个块，并且您像属性访问器一样调用它。

我不确定您在这里需要什么，但是如果您想使用该`Warcraft#game`方法获取当前游戏并设置新游戏，那么如果没有给出块，您可以返回当前游戏，如下所示：

```
def game &block
  if block_given?
    @game = Game.new &block
  else
    @game
  end
end 
```

# objective-c - 为什么 NSOrderedSet 不继承自 NSSet？

> ID：11278995
> 
> 赞同：51
> 
> 时间：2012-07-01T01:41:53.430
> 
> 标签：objective-c, ios, nsset, nsorderedset

当然，有序集合是集合的更具体的情况，那么为什么`NSOrderedSet`继承 from`NSObject`而不是`NSSet`呢？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-07-01T02:48:19.093

我通过了界面，`NSSet`你是对的，有序集似乎满足[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，因此可以继承自`NSSet`.

有一个小方法可以解决这个问题：`mutableCopy`. 的返回值`mutableCopy`必须是`NSMutableSet`，但`NSMutableOrderedSet`应该继承自`NSOrderedSet`。你不能两者兼得。

让我用一些代码解释一下。首先，让我们看看`NSSet`and的正确行为`NSMutableSet`：

```
NSSet* immutable = [NSSet set];
NSMutableSet* mutable = [immutable mutableCopy];

[mutable isKindOfClass:[NSSet class]]; // YES
[mutable isKindOfClass:[NSMutableSet class]]; // YES 
```

现在，让我们假设`NSOrderedSet`继承自`NSSet`，并`NSMutableOrderedSet`继承自`NSOrderedSet`：

```
//Example 1
NSOrderedSet* immutable = [NSOrderedSet orderedSet];
NSMutableOrderedSet* mutable = [immutable mutableCopy];

[mutable isKindOfClass:[NSSet class]]; // YES
[mutable isKindOfClass:[NSMutableSet class]]; // NO (this is the problem) 
```

如果`NSMutableOrderedSet`从那里继承`NSMutableSet`呢？然后我们得到一个不同的问题：

```
//Example 2
NSOrderedSet* immutable = [NSOrderedSet orderedSet];
NSMutableOrderedSet* mutable = [immutable mutableCopy];

[mutable isKindOfClass:[NSSet class]]; // YES
[mutable isKindOfClass:[NSMutableSet class]]; // YES
[mutable isKindOfClass:[NSOrderedSet class]]; // NO (this is a problem) 
```

在示例 1 中，您将无法将 an 传递`NSOrderedSet`给期望 an 的函数，`NSSet`因为行为不同。基本上，这是一个向后兼容性问题。

在示例 2 中，您不能将 an 传递`NSMutableOrderedSet`给期望 an 的函数，`NSOrderedSet`因为前者不会从后者继承。

所有这一切都是因为`NSMutableOrderedSet`不能从两者继承，`NSMutableSet`并且`NSOrderedSet`因为 Objective-C 没有多重继承。解决这个问题的方法是为`NSMutableSet`and制定协议`NSOrderedSet`，因为 then`NSMutableOrderedSet`可以实现这两种协议。我猜苹果开发人员只是在没有额外协议的情况下更简单。