# StackOverflow 问答 000188000-000188999

# c# - Xml 数据到 WPF TreeView 的双向绑定

> ID：188001
> 
> 赞同：4
> 
> 时间：2008-10-09T16:13:28.670
> 
> 标签：c#, wpf, xml, data-binding, treeview

我正在尝试使用 WPF 作为表示层重写我的[ForestPad应用程序。](http://ForestPad.com)在 WinForms 中，我以编程方式填充每个节点，但如果可能的话，我想利用 WPF 的数据绑定功能。

一般来说，将 WPF TreeView 双向数据绑定到 Xml 文档的最佳方法是什么？

通用解决方案很好，但作为参考，我尝试绑定的 Xml 文档的结构如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<forestPad
    guid="6c9325de-dfbe-4878-9d91-1a9f1a7696b0"
    created="5/14/2004 1:05:10 AM"
    updated="5/14/2004 1:07:41 AM">
<forest 
    name="A forest node"
    guid="b441a196-7468-47c8-a010-7ff83429a37b"
    created="01/01/2003 1:00:00 AM"
    updated="5/14/2004 1:06:15 AM">
    <data>
    <![CDATA[A forest node
        This is the text of the forest node.]]>
    </data>
    <tree
        name="A tree node"
        guid="768eae66-e9df-4999-b950-01fa9be1a5cf"
        created="5/14/2004 1:05:38 AM"
        updated="5/14/2004 1:06:11 AM">
        <data>
        <![CDATA[A tree node
            This is the text of the tree node.]]>
        </data>
        <branch
            name="A branch node"
            guid="be4b0993-d4e4-4249-8aa5-fa9c940ae2be"
            created="5/14/2004 1:06:00 AM"
            updated="5/14/2004 1:06:24 AM">
            <data>
            <![CDATA[A branch node
                This is the text of the branch node.]]></data>
                <leaf
                name="A leaf node"
                guid="9c76ff4e-3ae2-450e-b1d2-232b687214aa"
                created="5/14/2004 1:06:26 AM"
                updated="5/14/2004 1:06:38 AM">
                <data>
                <![CDATA[A leaf node
                    This is the text of the leaf node.]]>
                </data>
            </leaf>
        </branch>
    </tree>
</forest>
</forestPad> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T16:33:40.270

好吧，如果您的元素层次结构更像......

```
<node type="forest">
    <node type="tree">
        ... 
```

...而不是您当前的架构。

按原样，您将需要 4 个`HierarchicalDataTemplate`，一个用于包括根在内的每个分层元素，一个`DataTemplate`用于`leaf`元素：

```
<Window.Resources>
    <HierarchicalDataTemplate
        DataType="forestPad"
        ItemsSource="{Binding XPath=forest}">
        <TextBlock
            Text="a forestpad" />
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate
        DataType="forest"
        ItemsSource="{Binding XPath=tree}">
        <TextBox
            Text="{Binding XPath=data}" />
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate
        DataType="tree"
        ItemsSource="{Binding XPath=branch}">
        <TextBox
            Text="{Binding XPath=data}" />
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate
        DataType="branch"
        ItemsSource="{Binding XPath=leaf}">
        <TextBox
            Text="{Binding XPath=data}" />
    </HierarchicalDataTemplate>
    <DataTemplate
        DataType="leaf">
        <TextBox
            Text="{Binding XPath=data}" />
    </DataTemplate>

    <XmlDataProvider
        x:Key="dataxml"
        XPath="forestPad" Source="D:\fp.xml">
    </XmlDataProvider>
</Window.Resources> 
```

您可以改为`Source`以`XmlDataProvider`编程方式设置 ：

```
dp = this.FindResource( "dataxml" ) as XmlDataProvider;
dp.Source = new Uri( @"D:\fp.xml" ); 
```

此外，重新保存您的编辑就像这样简单：

```
dp.Document.Save( dp.Source.LocalPath ); 
```

`TreeView`本身需要 a和`Name`a`ItemsSource`绑定到`XmlDataProvider`：

```
<TreeView
    Name="treeview"
    ItemsSource="{Binding Source={StaticResource dataxml}, XPath=.}"> 
```

在此示例中，我在每个节点上都`TwoWay`使用 es 进行了绑定`TextBox`，但是当在单独的、单个`TextBox`或其他控件中一次仅编辑一个节点时，您会将其绑定到`TreeView`. 您还可以将上述`TextBox`es 更改为`TextBlock`s，因为单击`TextBox`并不会实际选择相应的`TreeViewItem`.

```
<TextBox
    DataContext="{Binding ElementName=treeview, Path=SelectedItem}"
    Text="{Binding XPath=data, UpdateSourceTrigger=PropertyChanged}"/> 
```

你必须使用两个`Binding`s 的原因是你不能一起使用`Path`and `XPath`。

**编辑：**

Timothy Lee Russell 询问有关将 CDATA 保存到数据元素的问题。首先，关于`InnerXml`和`InnerText`。

在幕后，`XmlDataProvider`使用`XmlDocument`, 和它的树`XmlNodes`。当将诸如“stuff”之类的字符串分配给`InnerXml`an 的属性时`XmlNode`，这些标签就是真正的标签。获取或设置时不进行转义`InnerXml`，解析为XML。

但是，如果将其分配给`InnerText`属性，则尖括号将使用实体 < 进行转义。和>。取回值时会发生相反的情况。实体（如 <）被解析回字符（如 <）。

因此，如果我们存储在数据元素中的字符串包含 XML，实体已被转义，我们需要`InnerText`在添加 CDATA 部分作为节点的子节点之前通过检索来撤消它......

```
XmlDocument doc = dp.Document;

XmlNodeList nodes = doc.SelectNodes( "//data" );

foreach ( XmlNode node in nodes ) {
    string data = node.InnerText;
    node.InnerText = "";
    XmlCDataSection cdata = doc.CreateCDataSection( data );
    node.AppendChild( cdata );
}

doc.Save( dp.Source.LocalPath ); 
```

如果节点已经有一个 CDATA 部分并且值没有以任何方式更改，那么它仍然有一个 CDATA 部分，我们基本上将其替换为相同的部分。但是，通过我们的绑定，如果我们更改数据元素内容的值，它会替换 CDATA 以支持转义字符串。然后我们必须修复它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T16:36:52.743

我们有一个类似的问题。您可能会发现阅读[这篇文章](http://www.codeproject.com/KB/WPF/TreeViewWithViewModel.aspx)很有帮助。我们使用了所描述的 ViewModel 模式，它简化了一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-03-03T21:05:40.710

我知道这是一个旧帖子，但有一个更优雅的解决方案。`HierarchicalDataTemplate`如果您使用选择您希望模板使用的所有节点的 XPath 表达式，您确实可以使用单个: `XPath=tree|branch|leaf`。

```
<HierarchicalDataTemplate x:Key="forestTemplate"
        ItemsSource="{Binding XPath=tree|branch|leaf}">
    <TextBlock Text="{Binding XPath=data}" />
</HierarchicalDataTemplate> 
```

`Page`这是嵌入 XData的完整示例`XmlDataProvider1`：

```
<Page 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Page.Resources>
    <XmlDataProvider x:Key="sampleForestPad" XPath="forestPad/forest">
        <x:XData>
            <forestPad xmlns=""
                guid="6c9325de-dfbe-4878-9d91-1a9f1a7696b0"
                created="5/14/2004 1:05:10 AM"
                updated="5/14/2004 1:07:41 AM">
                <forest 
                    name="A forest node"
                    guid="b441a196-7468-47c8-a010-7ff83429a37b"
                    created="01/01/2003 1:00:00 AM"
                    updated="5/14/2004 1:06:15 AM">
                    <data>
                    <![CDATA[A forest node
                        This is the text of the forest node.]]>
                    </data>
                    <tree
                        name="A tree node"
                        guid="768eae66-e9df-4999-b950-01fa9be1a5cf"
                        created="5/14/2004 1:05:38 AM"
                        updated="5/14/2004 1:06:11 AM">
                        <data>
                        <![CDATA[A tree node
                            This is the text of the tree node.]]>
                        </data>
                        <branch
                            name="A branch node"
                            guid="be4b0993-d4e4-4249-8aa5-fa9c940ae2be"
                            created="5/14/2004 1:06:00 AM"
                            updated="5/14/2004 1:06:24 AM">
                            <data>
                            <![CDATA[A branch node
                                This is the text of the branch node.]]></data>
                                <leaf
                                name="A leaf node"
                                guid="9c76ff4e-3ae2-450e-b1d2-232b687214aa"
                                created="5/14/2004 1:06:26 AM"
                                updated="5/14/2004 1:06:38 AM">
                                <data>
                                <![CDATA[A leaf node
                                    This is the text of the leaf node.]]>
                                </data>
                            </leaf>
                        </branch>
                    </tree>
                </forest>
            </forestPad>
        </x:XData>
    </XmlDataProvider>

    <HierarchicalDataTemplate x:Key="forestTemplate"
        ItemsSource="{Binding XPath=tree|branch|leaf}">
      <TextBlock Text="{Binding XPath=data}" />
    </HierarchicalDataTemplate>

    <Style TargetType="TreeViewItem">
      <Setter Property="IsExpanded" Value="True"/>
    </Style>
  </Page.Resources>

    <TreeView ItemsSource="{Binding Source={StaticResource sampleForestPad}}"
      ItemTemplate="{StaticResource forestTemplate}"/>
</Page> 
```

这将呈现为：

[![森林树视图](https://i.stack.imgur.com/gjfgJ.png)](https://i.stack.imgur.com/gjfgJ.png)

# c# - 以编程方式创建 asp:Button？

> ID：188007
> 
> 赞同：7
> 
> 时间：2008-10-09T16:14:52.240
> 
> 标签：c#, asp.net, .net, servercontrols

我正在使用我的代码隐藏页面以编程方式创建一个保存按钮：

```
 Button btnSave = new Button();
    btnSave.ID = "btnSave";
    btnSave.Text = "Save"; 
```

但是我认为这必须创建一个 html 按钮或者可能需要其他东西，因为我似乎无法在下一行中设置 OnClick 属性，我可以指定 OnClientClick 但这不是我想要设置的那个。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-09T16:26:32.607

```
Button btnSave = new Button();    
btnSave.ID = "btnSave";    
btnSave.Text = "Save";  
btnSave.Click += new System.EventHandler(btnSave_Click);

protected void btnSave_Click(object sender, EventArgs e)
{
    //do something when button clicked. 
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-09T16:31:46.887

还要记住，当用户单击按钮时，它将强制回发，这会创建页面类的*新实例*。您创建按钮的旧实例已经消失。您需要确保该类的这个新实例还在*加载阶段之前*添加了您的按钮——它是事件处理程序，否则事件处理程序将不会运行（但是页面的加载事件仍然会运行）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T16:18:53.247

如果您想在后面的代码中为 OnClick 事件注册一个处理程序，您将使用 += 语法向 OnClick 添加一个处理程序。

```
//Add the handler to your button, passing the name of the handling method    
btnSave.Click += new System.EventHandler(btnSave_Click);

protected void btnSave_Click(object sender, EventArgs e)
{
    //Your custom code goes here
} 
```

# math - 数学和游戏编程

> ID：188030
> 
> 赞同：16
> 
> 时间：2008-10-09T16:20:49.437
> 
> 标签：math, 2d

我想编写比我已经知道的基本 2D 东西更复杂的图形 2D 游戏。我不想做 3D 编程。只是更复杂的 2D 东西。我还没来得及学很多东西就辍学了，所以我带着足够的代数知识离开了，以平衡我的支票簿并做一些简单的二维笛卡尔编程。

有没有什么好的资源可以让注意力有限的人（比如我非常感兴趣的主题每人 20 分钟）逐渐学习如何在编程中用数学做一些更有用的事情？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-09T16:37:26.097

你需要精通三角学：[维基百科](http://en.wikipedia.org/wiki/Trigonometry)和[数学世界](http://mathworld.wolfram.com/topics/Trigonometry.html)

即使您不希望进行 3D 编程，2D 游戏也使用向量和矩阵。（来自线性代数）

线性代数资源：[维基百科](http://en.wikipedia.org/wiki/Linear_algebra)和 [数学世界](http://mathworld.wolfram.com/LinearAlgebra.html)

在 Trig 编程中可以节省大量精力的一点是意识到需要[atan2()](http://en.wikipedia.org/wiki/Atan2)函数，而不是 atan() 函数。这在确定两点之间的方向时很重要。

能够在各种坐标系之间移动是一大优势。这将伴随着经验而来。两个常见的绊倒人的事情是：

a) 大多数屏幕系统将原点 (0,0) 放在左上角，正 x 轴向右延伸，正 y 轴向下延伸。标准笛卡尔坐标假设象限 1 的原点（其中 x 和 y 始终为正或零）位于左下方。这需要程序员在某个阶段“翻转”y 方向。

b) 典型的地理将 0 度放置为北，正度顺时针扫过。所有 Trig 函数都将 0 度放置为东，正度逆时针扫过。

最后，即使我们倾向于用度数来思考，真正的库也会使用弧度。最佳实践是将角度存储为弧度（以“数学”方向而不是“地理”方向）并在显示调试信息时进行转换。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T16:24:31.550

我目前正在阅读David M. Bourg 的“[游戏开发者物理学”。](https://rads.stackoverflow.com/amzn/click/com/0596000065)到目前为止，我会推荐它。

它提供了物理背后的数学概念，可以轻松应用于 2D 领域，为您的游戏增添趣味。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T16:51:22.823

GameDev.net 有一段关于数学和物理编码的文章。值得快速浏览一下，看看是否有任何事情与您正在尝试做的事情有关。

[http://www.gamedev.net/reference/list.asp?categoryid=28](http://www.gamedev.net/reference/list.asp?categoryid=28)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-27T17:18:02.843

如果你住在美国，那么在当地的社区大学就读你错过的数学课怎么样？他们将提供资源来帮助需要补习技能课程并且可能有学习障碍的学生。你有学习的动力，你现在意识到教育的价值。想学习没有什么可耻的。去看学术顾问，他们会帮助你。去吧。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-23T21:19:50.813

我非常相信从视频系列中学习是有史以来最快的学习方式，也就是说，如果你想快速学习你愿意学习的东西。您可能会花很多时间阅读一个页面，只是为了获得一小段视频可以在一两分钟内为您提供的信息！

为此，我找到了这个数学频道： https: [//www.youtube.com/user/patrickJMT](https://www.youtube.com/user/patrickJMT)

另外： [https ://www.youtube.com/playlist?list=PL233FC7AA6FE11E0E](https://www.youtube.com/playlist?list=PL233FC7AA6FE11E0E)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-27T17:04:29.797

如果你想要一个通用的数学网站，我推荐[planetmath.org](http://planetmath.org)。那里的文章往往比维基百科具有更高的标准（根据我的经验，它在数学方面可能会令人震惊）并且比数学世界更加用户友好。如果您是一名数学家并且需要某个术语的完整正确定义，那么 Mathworld 是不错的选择，但对于日常使用而言，它往往与理论和钝度相去甚远。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T16:48:26.167

我不得不不同意 Physics for Game Developers 的建议。

我觉得那本书很无聊，我不会把自己的注意力说得*那么*短。

我想说最擅长的事情是向量，使用三角函数来操纵它们，然后在此基础上应用任何特定于当前项目的物理。

我只是启动 google/wikipedia 并开始在网络上弹跳吸收随机的东西，当你有限的注意力变得焦躁时，再次弹跳。

读那本书可能不会吸引你并激励你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-27T04:28:25.743

您可以从学习[处理开始！](http://www.processing.org/)

然后继续阅读 Daniel Shiffman 的这本令人惊叹的书，名为“[代码的本质](http://natureofcode.com)”。这本书也可以在线获得，其中包含用 Processing.js 编写的交互式示例

[http://natureofcode.com/book/](http://natureofcode.com/book/)

本书涵盖

```
1\. VECTORS
2\. FORCES
3\. OSCILLATION
4\. PARTICLE SYSTEMS
5\. PHYSICS LIBRARIES
6\. AUTONOMOUS AGENTS
7\. CELLULAR AUTOMATA
8\. FRACTALS
9\. THE EVOLUTION OF CODE
10\. NEURAL NETWORKS 
```

他还将视频上传到 Vimeo，解释每章的概念！ [http://vimeo.com/shiffman/videos/sort:date/format:detail](http://vimeo.com/shiffman/videos/sort:date/format:detail)

> 我们如何才能在软件中捕捉到自然界不可预测的进化和涌现属性？理解物理世界背后的数学原理如何帮助我们创造数字世界？本书重点介绍使用 Processing 对自然系统进行计算机模拟背后的编程策略和技术。

他还写了一本书来教你[学习处理的基础知识](http://www.learningprocessing.com/)

[http://www.learningprocessing.com/](http://www.learningprocessing.com/)

> 这本书讲述了一个故事。这是一个解放的故事，是迈出理解计算基础、编写自己的代码和创建自己的媒体的第一步，而无需现有软件工具的束缚。这个故事不是留给计算机科学家和工程师的。这个故事是给你的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T16:35:49.610

奇怪的是，我在 Wikipedia 中发现了很多关于线性代数的有用内容：[http ://en.wikipedia.org/wiki/Portal:Mathematics](http://en.wikipedia.org/wiki/Portal:Mathematics)

一般来说，这不是最好的知识来源，但数学还可以。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T16:42:09.050

我推荐 Wolfram 的资源： http: [//mathworld.wolfram.com](http://mathworld.wolfram.com)

它们很厚，但我知道没有更好的在线资源。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-28T00:50:02.007

您可能想查看有关该主题的任何 OReilly 文本。他们有很好的例子，你可以通过。这将使您更好地了解编程是否适合您。如果你想进入游戏编程，最好的方法是真正开始[游戏编程](http://www.gameshastra.com/Video-Game-Testing.html)。只需查看它并在出现问题时查找问题的答案（此处其他回复中的链接）。

# winforms - Xtragrid 存储库组合框

> ID：188032
> 
> 赞同：4
> 
> 时间：2008-10-09T16:20:57.143
> 
> 标签：winforms, devexpress, xtragrid

1.  我的存储库组合框默认显示空白选项。如何使组合框的选项 1 成为默认值。

2.  我想让这个存储库组合框像没有编辑功能的下拉菜单一样。但是，如果我使它不可编辑，则下拉菜单将不起作用。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T19:06:24.813

1.  将 nulltext 属性设置为 repositorycombobox[0]
2.  将 repositorycombobox 的 TextEditStyle 属性设置为 DisableTextEditor。

# security - 安全、密码学：愚蠢的挑战 - 响应协议？

> ID：188043
> 
> 赞同：2
> 
> 时间：2008-10-09T16:23:09.370
> 
> 标签：security, cryptography, challenge-response

好吧，伙计们只是一个小游戏：

我有一个项目的一些规范。在某些时候，他们要求以下内容通过网络加密密码，称这是一个质询响应协议：

```
客户端服务器

(1)要求挑战-------------->

(2) <---------------------------- 发送 SHA1 取自时间
                                       （这是挑战）
(3) make SHA1 xor PASSWORD --------> 如果它等于 SHA1 xor 存储的密码

(4) <---------------------------- 授予访问权限

```

对于那些不知道它的人来说，SHA 代表 Secure Hashing Algorithm，一种加密的标准算法。

我希望这很清楚。问题是：如果我嗅探数据包 2 和 3（“挑战”和“挑战异或密码”，我确实有实际密码，只是它们之间有另一个异或！？！？还有其他方法可以实现这种协议??

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T16:26:51.657

您将能够对密码进行逆向工程。您要发送密码的 SHA，而不是密码本身。滚动您自己的安全协议几乎从来都不是一个好主意。你不能使用 SSL 或类似的东西吗？

[http://en.wikipedia.org/wiki/Cryptographic_nonce](http://en.wikipedia.org/wiki/Cryptographic_nonce)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T16:40:08.947

以下情况如何：

1.  服务器发送随机挑战
2.  客户端发送（挑战+密码）的 SHA1 校验和
3.  服务器与（挑战+存储的密码）的 SHA1 校验和进行比较

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T16:37:14.397

这是一个非常可怕的协议。如果这是某人希望您实施的事情，请拒绝。这类事情有现有的、经过审查的协议。如果这是一个你指出所有缺陷的游戏 - 好吧。

*   任何听到第 2 步和第 3 步的人都知道密码
*   任何听到第 3 步并记下时间的人，如果他知道服务器上时间的精度，就可以暴力破解密码
*   我可以伪装成服务器（arp 中毒、dns 重定向等），然后获取您的密码，永远不会完成第 4 步并假装超时
*   容易受到中间人攻击，因为客户端/服务器之间没有共享秘密或服务器上的证书
*   依赖于存储 SHA1（时间）并等待响应的服务器，因此我可以用挑战请求使服务器过载而从不回复。

而且我肯定还想念更多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T16:27:04.213

你是对的——如果你捕获了挑战和（挑战 XOR 密码），那么提取密码很容易。

您需要在步骤 3 中使用正确的加密，而不是 XOR。使用密码加密挑战。

为了使攻击者的生活更加困难，您可以将随机数据添加到您加密的内容中：例如加密填充CHALLENGEpadding。服务器不关心填充是什么，它知道在哪里寻找挑战，但这意味着攻击者不会知道整个明文是什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T16:39:18.963

正如其他人指出的那样，您是对的。还要记住，有人可能会拦截通信 (3) 并可能在真实用户遇到网络问题（例如：DDOS）时重新发送它，然后冒名顶替者将登录并且通常足以更改密码（即，许多系统不要求您提供密码以便在您登录后进行更改）。

您可能需要考虑 HMAC（keyed-Hash Message Authentication Code）。我在这里详细介绍了它：http: [//blog.ciscavate.org/2007/09/creating-a-secure-webauth-system-part-1-hmac.html](http://blog.ciscavate.org/2007/09/creating-a-secure-webauth-system-part-1-hmac.html)我将在下面给出一个快速总结.

HMAC 是一种确保消息是由有权访问共享机密的人生成的方法。HMAC 使用某种单向散列函数（如 MD5 或 SHA-1）将密钥与消息一起加密。这会生成一个 16-20 字节的简短摘要，作为消息+秘密组合的指纹。当摘要与消息一起发送时，接收方（我们的服务器）可以使用相同的 HMAC 计算重新生成散列，并将本地生成的摘要与消息随附的摘要进行比较。记住：服务器也有秘密，所以它有足够的信息来确认摘要。（这仅考虑验证消息来源的问题，但您可以使用相同的方法来加密整个消息，如果您使用不同的秘密，例如一组公钥。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T16:43:03.540

我会这样做的方式如下：

1.  挑战服务器。
2.  服务器使用数字签名的公钥（例如 RSA 加密）进行响应。

3.  客户端验证 PK，并用密钥对密码进行加密，然后对加密后的密码进行数字签名。

4.  服务器验证签名并解密密码以存储/检查它。

数字签名在这里很重要，因为它是防止中间人攻击的开始。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T11:14:03.860

正如其他人指出的那样，是的，这是一个糟糕的挑战响应算法。

您可能想查看HTTP 使用的[Digest Authentication](http://en.wikipedia.org/wiki/Digest_access_authentication)。事实上，如果您的协议是基于 HTTP 的，您可以跳过自己编写的协议，直接使用或实现它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T11:32:15.290

公钥加密？使用服务器的公钥加密密码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T11:33:32.060

虽然推出自己的加密协议从来都不是一个好的解决方案，但我不建议这样做......

为了克服您面临的问题... F - 一个函数，它接收密码和一个伪随机单调递增的值并返回一个数字。例如哈希（哈希（密码）^时间戳）

1.  服务器：请求挑战，发送（时间戳）。记住上次发送的时间戳。
2.  客户端，发送响应（发送 F（密码，时间戳）和时间戳）
3.  服务器：使用客户端发送的哈希（密码）和时间戳（>挑战中发送的时间戳）检查客户端。
4.  如果客户端正确，则授予访问权限。
5.  确保当前时间戳大于下一次质询之前所有客户端发送的时间戳，以防止重放攻击。

亲切的问候， Ashish Sharma

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-18T18:07:12.563

我相信 Diffie-hellman 是一种众所周知且可靠的密钥交换协议？

# java - Java GUI 分辨率独立缩放

> ID：188046
> 
> 赞同：1
> 
> 时间：2008-10-09T16:23:39.587
> 
> 标签：java, user-interface, scaling

我正在开发一个大型遗留 Java 应用程序，该应用程序的一个重要功能是基于监视器分辨率自动缩放 GUI 组件。我们正在将运行它的 JVM 从 1.4.2 升级到 1.6，但由于 java.awt.Container.getPreferredSize() 的实现发生了变化，现在缩放被破坏了。

getPreferredSize 用于返回您使用 setPreferredSize() 提供的相同对象（一切也适用于最小/最大尺寸），所以我们要做的是在每个具有特定子类 java.awt.Dimension 的缩放组件上调用 setPRefferedSize，然后我们将遍历组件层次结构并在分辨率更改时更新每个缩放组件。

但是在 Java 1.6 中 getPreferredSize 返回您传递给它的 Dimension 对象的副本，因此它不再是正确的类型，并且没有任何内容可以缩放。

我通过将组件类放在类路径上的 JRE 前面，用我自己的实现（感谢开源 JRE）覆盖组件类，很快就破解了一个解决方案。然而，这个解决方案显然是不可维护的。

有没有人知道这个问题的任何其他解决方案，你将如何在 java 1.5/1.6 中实现 GUI 缩放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T18:19:06.857

听起来他们在 1.6 中比以前更好地保护了组件的内部状态。也许他们在上面运行了[FindBugs](http://findbugs.sourceforge.net/)并修复了这个[错误](http://findbugs.sourceforge.net/bugDescriptions.html#EI_EXPOSE_REP)。

当我第一次看到这个问题时，我想到了 Java 1.6u10。[它包括一个名为Nimbus](http://java.sun.com/javase/downloads/ea/6u10/nimbus.jsp)的新外观，它通过使用矢量图形绘制所有界面组件来支持高 DPI 显示。

但是，在稍微慢一点地阅读问题并尝试理解您在说什么之后，我建议您使用将为您管理内部组件大小的布局管理器重写用户界面。我的感觉是，按照您的建议手动管理组件大小确实不是一个好主意。正如[jjnguy](https://stackoverflow.com/questions/188046/java-gui-resolution-independant-scaling#188261)所建议的，您可以使用 GridBagLayout。布局管理器还有许多其他选择。如果您正在寻找与 GridBagLayout 不同的东西，则[发布](https://stackoverflow.com/questions/116957/which-layout-manager-do-you-use)了一个问题，该问题提供了对每个人最喜欢的布局管理器的调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T18:49:51.523

更改布局管理器似乎是不错的解决方案，但在这种情况下，需要对 UI 进行完全重新设计（其中包括数千个组件），因此对于此应用程序来说，这并不是一个实际的解决方案。

# css - Internet Explorer 8 和 CSS

> ID：188057
> 
> 赞同：1
> 
> 时间：2008-10-09T16:26:36.460
> 
> 标签：css, internet-explorer-8

快速提问。你怎么看，我有一些网站使用 3 级下拉菜单，如果 IE8 在 IE8 beta2 中使用其当前的 CSS 标准发布，它们将被破坏。那么我现在需要花时间重做那些下拉菜单吗？我意识到他们渲染 CSS 的方式在 beta 1 和 2 之间完全改变了，但是 2 是/应该是一个通用的 beta 并且看到它是最终的 beta 你会认为像 CSS 渲染一样重要的东西会被修改正常工作。

那么您怎么看，您是否会等到 80%（随机统计）的 ie7 用户自动更新到 IE8，然后担心导航菜单是否仍然存在损坏。还是你现在浪费时间。

...如果我按照自己的方式进行操作，所有 Web 开发人员都会确保他们的页面无法在 IE8 中运行，然后 Microsoft 将被迫正确处理 CSS。...但我通常不会按照自己的方式行事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T16:28:36.817

您可以添加元标记以强制 IE7 兼容呈现。您的网站继续工作，网站没有任何更改，每个人的生活都很愉快。

也就是说，我很好奇“被迫正确处理 CSS”位；IE8 在 CSS 标准方面已经取得了相当大的胜利，但我可能会错过这个潮流。;)

强制模拟 IE7 呈现所需的 HTML 更改涉及在头节点之后立即添加元标记。

```
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
    ...
</head> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T16:29:03.787

就我个人而言，我发现这真的取决于观众，以及解决问题所需的努力程度。

如果我可以快速进行几个小时的修复以使其合规，即使它是针对一小部分用户，太好了！但是，如果涉及更多，那么我开始平衡潜在的采用率，微软再次改变行为的可能性等。

MS会改变CSS吗？我认为没有人真正知道这个答案......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T16:29:24.863

我会等到他们发布 - 也许制作一个更简单的版本，以防万一，你可以快速切换到 IE8，但不要相信你在 beta 版本中看到的任何东西。

# performance - 在 Web 2.0 站点中，新添加的标签需要多长时间（以秒为单位）才能显示并被索引以供搜索？

> ID：188067
> 
> 赞同：1
> 
> 时间：2008-10-09T16:28:44.100
> 
> 标签：performance, optimization, search, tagging

我正在构建一个具有标记功能的 web 2.0 站点，并希望从任何有经验的人那里了解系统可以花费多长时间（以秒为单位）a）在给定记录上显示新标签和 b）索引标签以供搜索. 例如，新添加的标签是否必须在 1 秒内可供搜索，但在 0.1 秒内显示在用户屏幕上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T16:31:37.263

我认为这实际上取决于站点的类型、站点的大小、整体复杂性和用户期望。

您必须平衡一切以满足您的需求，我不相信有任何事实上的标准说它必须是 X 秒。

响应能力很重要，但某些受众比其他受众更宽容，某些系统需要一定的性能水平。

此外，用于添加的用户界面是决定它应该向用户显示多长时间以及如何进行的重要因素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T16:34:42.047

这取决于您如何处理更改。这应该是一致的。

但是任何遭受这种延迟的东西都应该可以在 UI 中检测到：添加但尚不可用的标签应以将其标识为已添加但尚不可用的方式显示，因此用户不会相信他们遇到了错误他们没有的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T16:34:58.237

我希望它立即出现在记录中 - 如果我在刷新时没有看到它，我会假设我添加它时出现问题并尝试再次添加它。

立即出现在全局标签云和搜索结果中的重要性要小得多。很大程度上取决于网站，但在大多数情况下，一两个小时可能就可以了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T16:39:39.367

@workmad，我希望它在两者上都是即时的（0.1 秒），但是索引更新（我们正在使用 FAST）需要权衡，所以我真的在这里寻找最佳实践，而不是我的理想。

@Mitchel，谢谢。我同意我们需要考虑整个网站的响应能力，但是，例如，如果标签系统既提供按标签搜索，又不启用我添加的标签的可搜索性，您是否认为用户会认为它已损坏？ ，在最后一分钟内？这里有一个平衡，我认为用户通常可以在索引方面接受分钟和秒之间的平衡，我想知道这种平衡在哪里。再次感谢周到的回复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T03:39:49.317

正如其他人所说，这取决于网站的设计，但要小心不要让延迟看起来像错误。

您是否考虑过可用性测试以了解您的网站的合理性？要得到这个问题的答案，没有比看看用户的实际期望更好的方法了。

# .net - 在 Visual Studio 2008 中更改目标框架

> ID：188091
> 
> 赞同：3
> 
> 时间：2008-10-09T16:35:04.930
> 
> 标签：.net, visual-studio, target-framework

与 Visual Studio 有什么关系？

我尝试导入缓存应用程序块并收到此消息：

> 您尝试导入的程序集或其依赖项之一需要更高版本的 .NET Framework。

我在 Visual Studio 中访问了我的应用程序的属性，但找不到下拉菜单来切换....这是怎么回事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T16:38:27.420

找到它....进入编译选项卡上的“高级编译选项”......很奇怪！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-24T01:45:06.690

我认为它们使 C# 项目和 VB 项目有所不同。

**C# 项目**

解决方案资源管理器 --> 项目 --> 属性，在应用程序选项卡上，您将看到目标框架。

**VB项目**

项目属性 --> 编译 --> 高级编译选项

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T16:40:08.103

它应该位于项目属性的“应用程序”选项卡上。*[VS 2008 Multi-Targeting Support](http://weblogs.asp.net/scottgu/archive/2007/06/20/vs-2008-multi-targeting-support.aspx)*是一篇关于 Visual Studio 2008 如何处理框架定位的好文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-06T00:15:23.343

在 Visual Studio 2008 中，Targeted Framework 选项对我来说是灰色的。我必须按照文章*[如何：修改目标框架和平台工具](http://msdn.microsoft.com/en-us/library/vstudio/ff770576.aspx "如何：修改目标框架和平台工具集")*集中的说明​​更改目标框架，以便两个相关项目可以一起工作。

基本上，您使用错误的框架卸载项目，在 Visual Studio 中将项目文件作为文本文件打开，在 XML 中找到指定目标框架的行并将其更改为所需的框架。保存文件并重新加载项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T16:42:05.900

转到项目的属性（解决方案资源管理器 --> 项目 --> 属性或菜单栏 --> 项目 --> 属性），然后在应用程序选项卡上，您将看到目标框架。

# c# - Visual Studio 2008 - 发生未处理的异常时应用程序关闭

> ID：188098
> 
> 赞同：2
> 
> 时间：2008-10-09T16:35:59.313
> 
> 标签：c#, vb.net, visual-studio-2008, debugging

在调试 WinForm VB.NET 项目时发生 unhandeld 异常时，我遇到了问题。

问题是我的应用程序终止了，我必须重新启动应用程序，而不是像 VS2003 那样重试操作

unhandeld 异常在 ApplicationEvents.vb 中的新 My.MyApplication 类中实现

```
Private Sub MyApplication_UnhandledException(ByVal sender As Object, ByVal e As Microsoft.VisualBasic.ApplicationServices.UnhandledExceptionEventArgs) Handles Me.UnhandledException
    Dim handler As New GlobalErrorHandler()
    handler.HandleError(e.Exception)

    e.ExitApplication = False
End Sub 
```

注意：handler.HandleError 只是显示一个对话框并将错误记录到日志文件中。

我还尝试了以下曾经在 VS2003 中工作的代码，但在 VS2008 中运行时会产生相同的行为：

```
 AddHandler System.Windows.Forms.Application.ThreadException, AddressOf OnApplicationErrorHandler
    AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf OnUnhandledExceptionHandler 
```

OnApplicationErrorHandler 和 OnUnhandledExceptionHandler 的作用与 handle.HandleError 相同

在 VS2008 之外运行应用程序会产生预期的行为（应用程序不会终止），但它会在调试期间增加我们的测试周期。

**更新：**我在答案中添加了示例代码以在 C# 中演示此问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T05:36:35.400

好的，我在这方面做了更多的工作，但仍然没有答案。我发现这个问题不仅与VB.NET有关，而且与C#有关

这是一个演示问题的简单 C# 程序：

```
using System;
using System.Windows.Forms;
namespace TestCSharpUnhandledException
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException);
            AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
        }

        void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
        {
            MessageBox.Show("Oops an unhandled exception, terminating:" + e.IsTerminating);                
        }

        void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
        {
            MessageBox.Show("Oops an unhandled thread exception");
        }

        private void button1_Click(object sender, EventArgs e)
        {
            throw new Exception("Dummy unhandled exception");
        }
    }
} 
```

我发现有趣的是在 VS 中调试抛出**UnhandledException事件，但在 VS 之外运行应用程序会导致****ThreadException**触发。

同样在 VS 内部，e.IsTerminating 设置为 true，最终我希望它为 false。（这是一个只读属性）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T05:47:51.087

好的，我在这篇博文中找到了这个问题的答案：[Handling "Unhandled Exceptions" in .NET 2.0](http://www.julmar.com/blog/mark/PermaLink,guid,f733e261-5d39-4ca1-be1a-c422f3cf1f1b.aspx)

谢谢马克！

简短的回答是：

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException); 
```

这会在调试和运行模式下导致相同的行为。导致VS在调试时不关闭

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T19:28:41.680

我不确定VS2008，但我在VS2005中有一段时间遇到同样的问题。事实证明，我只需要转到 Debug->Exceptions（或 Crtl + Alt + E）并确保所有 Thrown 框都未选中，但所有 User-unhandled 框都已选中。

您的代码可能会发生一些不同且时髦的事情，但它可能会解决此问题。

# oracle - PL/SQL 评估顺序

> ID：188099
> 
> 赞同：5
> 
> 时间：2008-10-09T16:36:11.013
> 
> 标签：oracle, plsql

你好。考虑以下：

```
SQL> DECLARE
  2     b1   BOOLEAN;
  3     b2   BOOLEAN;
  4     FUNCTION checkit RETURN BOOLEAN IS
  5     BEGIN
  6        dbms_output.put_line('inside checkit');
  7        RETURN TRUE;
  8     END checkit;
  9  
 10     PROCEDURE outp(n VARCHAR2, p BOOLEAN) IS
 11     BEGIN
 12        IF p THEN
 13           dbms_output.put_line(n||' is true');
 14        ELSE
 15           dbms_output.put_line(n||' is false');
 16        END IF;
 17     END;
 18  BEGIN
 19     b1 := TRUE OR checkit;
 20     outp('b1',b1);
 21     b2 := checkit OR TRUE;
 22     outp('b2',b2);
 23  END;
 24  /

b1 is true
inside checkit
b2 is true

PL/SQL procedure successfully completed

SQL> 
```

请注意，OR 语句的结果取决于顺序。如果我先调用函数，则无论其他项的值如何，都会执行该函数。似乎从左到右评估 OR 语句，直到获得 TRUE，此时处理停止并且结果为 TRUE。

我的问题是，这是我可以依靠的东西吗？或者这种行为会在未来的 PL/SQL 版本中改变吗？如果它可以改变，有没有办法强制评估我可以依赖的函数（不创建另一个变量并使用单独的赋值语句）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T16:39:07.480

是的。PL/SQL从左到右执行逻辑表达式的[短路求值。](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14261/fundamentals.htm#sthref481)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T16:58:58.393

> 如果它可以改变，有没有办法强制评估我可以依赖的函数（不创建另一个变量并使用单独的赋值语句）？

如果您要求即使在逻辑上多余的情况下也必须评估该函数，这意味着它执行的操作不是简单地返回 TRUE 或 FALSE，例如它可能会更新表。PL/SQL 函数具有这样的“副作用”并不是一种好的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:01:45.510

在文档中，它指出短路评估适用于 IF、CASE 和 CASE 表达式：我敢打赌，它也适用于您引用的示例，但从技术上讲并没有记录它这样做。可能值得向 Oracle 提出关于这种行为的罚单以确认它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T16:41:45.777

这称为“短路评估”，它是大多数语言的规范，[包括 PL/SQL](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14261/fundamentals.htm#CIHGJBFD)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-28T20:10:59.847

它从左到右评估 OR 语句，从右到左评估 AND 语句。我没有找到任何关于它的文档。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-05T08:17:45.970

“..and AND statements from right to left”到底是什么意思？
这是来自 oracle 文档=>

**在下面的示例中，请注意当 valid 的值为 FALSE 时，无论 done 的值如何，整个表达式都会产生 FALSE：**

**有效并完成**

您可以在以下示例中检查订单：

声明
b1 布尔值；
b2 布尔值；

FUNCTION checkit (v NUMBER)
RETURN BOOLEAN
IS
BEGIN
DBMS_OUTPUT.put_line ('inside checkit:' || v);
返回真；
结束检查；

PROCEDURE outp (n VARCHAR2, p BOOLEAN)
IS
BEGIN
IF p
THEN
DBMS_OUTPUT.put_line (n || 'is true');
ELSE
DBMS_OUTPUT.put_line (n || '为假');
万一;
结尾;
BEGIN
b1 := checkit (1) AND checkit (2);
输出（'b1'，b1）；
b2 := checkit (3) AND checkit (4);
输出（'b2'，b2）；
结尾;

* * *

内部 checkit:1
内部 checkit:2
b1 为真
内部 checkit:3
内部 checkit:4
b2 为真

# asp.net - IIS7 的 UnauthorizedAccessException

> ID：188114
> 
> 赞同：3
> 
> 时间：2008-10-09T16:40:33.047
> 
> 标签：asp.net, security, iis-7

我正在尝试从 IIS7 下的 ASP.NET 应用程序写入日志文件，但不断收到以下异常：

> UnauthorizedAccessException “对路径 'C:\Users\Brady\Exports' 的访问被拒绝。”

根据 Google 找到的各种建议，我已授予 iis_iusrs、iis_wpg 和 aspnet 用户的写入权限，但仍然出现错误。有人可以解释一下我如何在该目录中创建一个日志文件，或者，在 Web 应用程序本身下创建一个日志目录是否会自动允许写入该文件，这可能不是一个更好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T16:42:32.170

您需要向以下帐户之一授予权限

```
ASPNET - Win XP and Win 2000
NETWORK SERVICE - Win Vista and 2003 
```

这些是默认值，如果应用程序池已配置为不同的进程帐户，那么您将需要使用该特定帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T16:44:13.337

我认为 Mitchel 明白了，但我要补充一点，使用 SysInternals 的[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)（用于遗留系统的[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)）排除这些猜测/试错会变得非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T10:55:33.260

如果您在 ASP.NET 中模拟其他用户，则该用户帐户必须具有写入该目录的权限。我强烈建议*不要*将用户的个人文件夹路径设置为存储 Web 应用程序日志或数据的位置。这要求 ASP.NET 工作进程帐户有权访问该用户的私有文件夹（如果它们不是同一个帐户）。

鼓励分配公共区域，例如 D:\webapps\logapp\logfiles。当然，有了适当的权限。

# oracle - 如何格式化我的 oracle 查询以使列不换行？

> ID：188118
> 
> 赞同：29
> 
> 时间：2008-10-09T16:41:23.483
> 
> 标签：oracle, sqlplus

我试过这个，但它不起作用：

```
col * format a20000 
```

我真的必须专门列出每一列吗？这是一个巨大的痛苦。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-09T16:44:32.493

没关系，想通了：

```
set wrap off
set linesize 3000 -- (or to a sufficiently large value to hold your results page) 
```

我通过以下方式找到的：

```
show all 
```

并寻找一些似乎相关的选项。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-09T16:48:28.243

我使用了一个我称之为“转储”的通用查询（为什么？我不知道），它看起来像这样：

```
SET NEWPAGE NONE
SET PAGESIZE 0
SET SPACE 0
SET LINESIZE 16000
SET ECHO OFF
SET FEEDBACK OFF
SET VERIFY OFF
SET HEADING OFF
SET TERMOUT OFF
SET TRIMOUT ON
SET TRIMSPOOL ON
SET COLSEP |

spool &1..txt

@@&1

spool off
exit 
```

然后我调用 SQL*Plus 传递我想要作为参数运行的实际 SQL 脚本：

```
sqlplus -S user/password@database @dump.sql my_real_query.sql 
```

结果写入文件

> `my_real_query.sql.txt`

.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-28T12:24:55.957

```
set linesize 3000

set wrap off

set termout off

set pagesize 0 embedded on

set trimspool on 
```

尝试使用上述所有值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-30T14:09:06.470

```
set WRAP OFF
set PAGESIZE 0 
```

尝试使用这些设置。

# c# - 我可以内联指定我的显式类型比较器吗？

> ID：188120
> 
> 赞同：67
> 
> 时间：2008-10-09T16:41:57.740
> 
> 标签：c#, .net, linq, lambda

因此，.NET 3.0/3.5 为我们提供了许多查询、排序和操作数据的新方法，这要归功于 LINQ 提供的所有简洁功能。有时，我需要比较没有内置比较运算符的用户定义类型。在许多情况下，比较非常简单——比如 foo1.key ?= foo2.key。我可以使用匿名委托/lambda 函数简单地指定内联比较，而不是为该类型创建一个新的 IEqualityComparer 吗？就像是：

```
var f1 = ...,
    f2 = ...;
var f3 = f1.Except(
           f2, new IEqualityComparer(
             (Foo a, Foo b) => a.key.CompareTo(b.key)
           ) ); 
```

我很确定上述方法实际上不起作用。我只是不想为了告诉程序如何将苹果与苹果进行比较而使整个班级变得“沉重”。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-09T16:43:50.827

我的[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)库包含一个 ProjectionComparer，用于从投影委托构建 IComparer<T>。让 ProjectionEqualityComparer 做同样的事情需要 10 分钟。

编辑：这是 ProjectionEqualityComparer 的代码：

```
using System;
using System.Collections.Generic;

/// <summary>
/// Non-generic class to produce instances of the generic class,
/// optionally using type inference.
/// </summary>
public static class ProjectionEqualityComparer
{
    /// <summary>
    /// Creates an instance of ProjectionEqualityComparer using the specified projection.
    /// </summary>
    /// <typeparam name="TSource">Type parameter for the elements to be compared</typeparam>
    /// <typeparam name="TKey">Type parameter for the keys to be compared,
    /// after being projected from the elements</typeparam>
    /// <param name="projection">Projection to use when determining the key of an element</param>
    /// <returns>A comparer which will compare elements by projecting 
    /// each element to its key, and comparing keys</returns>
    public static ProjectionEqualityComparer<TSource, TKey> Create<TSource, TKey>(Func<TSource, TKey> projection)
    {
        return new ProjectionEqualityComparer<TSource, TKey>(projection);
    }

    /// <summary>
    /// Creates an instance of ProjectionEqualityComparer using the specified projection.
    /// The ignored parameter is solely present to aid type inference.
    /// </summary>
    /// <typeparam name="TSource">Type parameter for the elements to be compared</typeparam>
    /// <typeparam name="TKey">Type parameter for the keys to be compared,
    /// after being projected from the elements</typeparam>
    /// <param name="ignored">Value is ignored - type may be used by type inference</param>
    /// <param name="projection">Projection to use when determining the key of an element</param>
    /// <returns>A comparer which will compare elements by projecting
    /// each element to its key, and comparing keys</returns>
    public static ProjectionEqualityComparer<TSource, TKey> Create<TSource, TKey>
        (TSource ignored,
         Func<TSource, TKey> projection)
    {
        return new ProjectionEqualityComparer<TSource, TKey>(projection);
    }

}

/// <summary>
/// Class generic in the source only to produce instances of the 
/// doubly generic class, optionally using type inference.
/// </summary>
public static class ProjectionEqualityComparer<TSource>
{
    /// <summary>
    /// Creates an instance of ProjectionEqualityComparer using the specified projection.
    /// </summary>
    /// <typeparam name="TKey">Type parameter for the keys to be compared,
    /// after being projected from the elements</typeparam>
    /// <param name="projection">Projection to use when determining the key of an element</param>
    /// <returns>A comparer which will compare elements by projecting each element to its key,
    /// and comparing keys</returns>        
    public static ProjectionEqualityComparer<TSource, TKey> Create<TKey>(Func<TSource, TKey> projection)
    {
        return new ProjectionEqualityComparer<TSource, TKey>(projection);
    }
}

/// <summary>
/// Comparer which projects each element of the comparison to a key, and then compares
/// those keys using the specified (or default) comparer for the key type.
/// </summary>
/// <typeparam name="TSource">Type of elements which this comparer 
/// will be asked to compare</typeparam>
/// <typeparam name="TKey">Type of the key projected
/// from the element</typeparam>
public class ProjectionEqualityComparer<TSource, TKey> : IEqualityComparer<TSource>
{
    readonly Func<TSource, TKey> projection;
    readonly IEqualityComparer<TKey> comparer;

    /// <summary>
    /// Creates a new instance using the specified projection, which must not be null.
    /// The default comparer for the projected type is used.
    /// </summary>
    /// <param name="projection">Projection to use during comparisons</param>
    public ProjectionEqualityComparer(Func<TSource, TKey> projection)
        : this(projection, null)
    {
    }

    /// <summary>
    /// Creates a new instance using the specified projection, which must not be null.
    /// </summary>
    /// <param name="projection">Projection to use during comparisons</param>
    /// <param name="comparer">The comparer to use on the keys. May be null, in
    /// which case the default comparer will be used.</param>
    public ProjectionEqualityComparer(Func<TSource, TKey> projection, IEqualityComparer<TKey> comparer)
    {
        if (projection == null)
        {
            throw new ArgumentNullException("projection");
        }
        this.comparer = comparer ?? EqualityComparer<TKey>.Default;
        this.projection = projection;
    }

    /// <summary>
    /// Compares the two specified values for equality by applying the projection
    /// to each value and then using the equality comparer on the resulting keys. Null
    /// references are never passed to the projection.
    /// </summary>
    public bool Equals(TSource x, TSource y)
    {
        if (x == null && y == null)
        {
            return true;
        }
        if (x == null || y == null)
        {
            return false;
        }
        return comparer.Equals(projection(x), projection(y));
    }

    /// <summary>
    /// Produces a hash code for the given value by projecting it and
    /// then asking the equality comparer to find the hash code of
    /// the resulting key.
    /// </summary>
    public int GetHashCode(TSource obj)
    {
        if (obj == null)
        {
            throw new ArgumentNullException("obj");
        }
        return comparer.GetHashCode(projection(obj));
    }
} 
```

这是一个示例使用：

```
var f3 = f1.Except(f2, ProjectionEqualityComparer<Foo>.Create(a => a.key)); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-23T12:46:04.883

这是一个简单的辅助类，应该做你想做的

```
public class EqualityComparer<T> : IEqualityComparer<T>
{
    public EqualityComparer(Func<T, T, bool> cmp)
    {
        this.cmp = cmp;
    }
    public bool Equals(T x, T y)
    {
        return cmp(x, y);
    }

    public int GetHashCode(T obj)
    {
        return obj.GetHashCode();
    }

    public Func<T, T, bool> cmp { get; set; }
} 
```

你可以像这样使用它：

```
processed.Union(suburbs, new EqualityComparer<Suburb>((s1, s2)
    => s1.SuburbId == s2.SuburbId)); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-13T07:06:01.300

我发现在 IEnumerable 上提供额外的帮助是一种更简洁的方法。

见：[这个问题](https://stackoverflow.com/questions/742682/distinct-list-of-objects-based-on-an-arbitrary-key-in-linq/742784#742784)

所以你可以有：

```
var f3 = f1.Except(
           f2, 
             (a, b) => a.key.CompareTo(b.key)
            ); 
```

如果您正确定义了扩展方法

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-04-01T14:24:19.310

为什么不这样：

```
 public class Comparer<T> : IEqualityComparer<T>
    {
        private readonly Func<T, T, bool> _equalityComparer;

        public Comparer(Func<T, T, bool> equalityComparer)
        {
            _equalityComparer = equalityComparer;
        }

        public bool Equals(T first, T second)
        {
            return _equalityComparer(first, second);
        }

        public int GetHashCode(T value)
        {
            return value.GetHashCode();
        }
    } 
```

然后你可以做一些类似的事情（例如在 in 的情况下`Intersect`）`IEnumerable<T>`：

```
list.Intersect(otherList, new Comparer<T>( (x, y) => x.Property == y.Property)); 
```

该类`Comparer`可以放在实用程序项目中并在需要的地方使用。

我现在才看到 Sam Saffron 的答案（与这个非常相似）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-01-23T22:18:37.640

这个项目做了类似的事情：[AnonymousComparer - Linq 的 lambda 比较选择器](http://linqcomparer.codeplex.com)，它也有 LINQ 标准查询运算符的扩展。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-02-18T14:53:50.470

所以我知道这是您问题的解决方法，但是当我发现我遇到了您在这里遇到的情况（组合列表和过滤重复项），并且 Distinct 需要一个我没有的 IEquityComparer 时，我通常会去使用 Concat -> Group -> Select。

原来的

```
var f1 = ...,
    f2 = ...;
var f3 = f1.Except(
           f2, new IEqualityComparer(
             (Foo a, Foo b) => a.key.CompareTo(b.key)
           ) ); 
```

新的

```
var f1 = ...,
    f2 = ...;
var distinctF = f1
    .Concat(f2)                       // Combine the lists
    .GroupBy(x => x.key)              // Group them up by our equity comparison key
    .Select(x => x.FirstOrDefault()); // Just grab one of them. 
```

请注意，在 GroupBy() 中，您有机会添加逻辑来创建混合键，例如：

```
.GroupBy(f => new Uri(f.Url).PathAndQuery) 
```

以及在 Select() 中，如果您想指定结果项目来自哪个列表，您可以说：

```
.Select(x => x.FirstOrDefault(y => f1.Contains(y)) 
```

希望有帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-23T13:25:12.733

对于小型套装，您可以执行以下操作：

```
f3 = f1.Where(x1 => f2.All(x2 => x2.key != x1.key)); 
```

对于大型集，您将需要更高效的搜索，例如：

```
var tmp = new HashSet<string>(f2.Select(f => f.key));
f3 = f1.Where(f => tmp.Add(f.key)); 
```

但是，在这里，`Type`of*键*必须实现`IEqualityComparer`（上面我假设它是 a `string`）。因此，这并不能真正回答您关于在这种情况下使用 lambda 的问题，但它使用的代码确实比一些答案要少。

您可能会依赖优化器并将第二个解决方案缩短为：

```
f3 = f1.Where(x1 => (new HashSet<string>(f2.Select(x2 => x2.key))).Add(x1.key)); 
```

但是，我还没有运行测试以知道它是否以相同的速度运行。而那一个班轮可能太聪明了，无法维护。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-06-12T11:35:26.140

在其他答案的基础上，创建通用比较器是我最喜欢的。但是我遇到了 Linq `Enumerable.Union`（[msdn .Net 参考](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.union)）的问题，即它直接使用 GetHashCode 而不考虑 Equals 覆盖。

这使我将比较器实现为：

```
public class Comparer<T> : IEqualityComparer<T>
{
    private readonly Func<T, int> _hashFunction;

    public Comparer(Func<T, int> hashFunction)
    {
        _hashFunction = hashFunction;
    }

    public bool Equals(T first, T second)
    {
        return _hashFunction(first) == _hashFunction(second);
    }

    public int GetHashCode(T value)
    {
        return _hashFunction(value);
    }
} 
```

像这样使用它：

```
list.Union(otherList, new Comparer<T>( x => x.StringValue.GetHashCode())); 
```

请注意，比较可能会产生一些误报，因为被比较的信息被映射到一个`int`值。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-07-26T23:15:48.067

像其他答案一样，但更简洁的 c# 7：

```
public class LambdaComparer<T> : IEqualityComparer<T> {
  private readonly Func<T, T, bool> lambdaComparer;
  private readonly Func<T, int> lambdaHash;
  public LambdaComparer(Func<T, T, bool> lambdaComparer) : this(lambdaComparer, o => o.GetHashCode()) {}
  public LambdaComparer(Func<T, T, bool> lambdaComparer, Func<T, int> lambdaHash) { this.lambdaComparer = lambdaComparer; this.lambdaHash = lambdaHash; }
  public bool Equals(T x, T y) => lambdaComparer is null ? false : lambdaComparer(x, y);
  public int GetHashCode(T obj) => lambdaHash is null ? 0 : lambdaHash(obj);
} 
```

然后：

```
var a=List<string> { "a", "b" };
var b=List<string> { "a", "*" };
return a.SequenceEquals(b, new LambdaComparer<string>((s1, s2) => s1 is null ? s2 is null : s1 == s2 || s2 == "*"); 
```

# asp.net - 更改导航 ID 以突出显示当前页面 ASP.NET 的编程解决方案

> ID：188124
> 
> 赞同：10
> 
> 时间：2008-10-09T16:42:26.147
> 
> 标签：asp.net, css, navigation

我正在用 Visual Studio 2008 和 ASP.NET 3.5 编写一个网站。我设置了一个母版页来简化布局并保留内容页面而不是内容和布局。

导航是列表，CSS'd 所以它看起来像一个栏。为了突出显示栏上的页面，列表项需要看起来像这样`<li id="current">`。`<asp:ContentPlaceHolder>`如果可以避免，我不想使用它。是否有一些代码可以添加到我的每个页面（或仅添加到母版页？）来完成此操作，还是我坚持使用`<asp:ContentPlaceHolder>`'s？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T15:40:37.787

您是否考虑过使用 Web.sitemap 文件？它使它变得非常容易。如果您的站点地图文件如下所示...

```
<?xml version="1.0" encoding="utf-8" ?>
<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0" >
  <siteMapNode>
    <siteMapNode url="~/Default.aspx" title="Home"  description="" />
    <siteMapNode url="~/Blog.aspx" title="Blog"  description="" />
    <siteMapNode url="~/AboutUs.aspx" title="AboutUs"  description="" />
  </siteMapNode>
</siteMap> 
```

...然后您可以在母版页中执行此操作以获得所需的结果：

```
<asp:SiteMapDataSource ID="sitemapdata" runat="server" ShowStartingNode="false"  />
<ul id="navigation">
    <asp:Repeater runat="server" ID="navrepeater" DataSourceID="sitemapdata">
        <ItemTemplate>
            <li class="<%# SiteMap.CurrentNode.Equals(Container.DataItem) ? "activenav" : "inactivenav" %>"><a href="<%# DataBinder.Eval(Container.DataItem, "url") %>"><%# DataBinder.Eval(Container.DataItem, "title") %></a></li>
        </ItemTemplate>
    </asp:Repeater>
</ul> 
```

当前页面的 LI 将有一个“activenav”类（或您决定使用的任何内容），而其他页面的 LI 将有一个“inactivenav”类。您可以相应地编写 CSS。这是我在我的网站上使用的技术，效果很好。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-09T16:54:20.727

向母版页添加一个名为 Page Section 的属性

```
public string PageSection { get; set; } 
```

将 MasterType 页面指令添加到内容页面的顶部

```
<%@ MasterType VirtualPath="~/foo.master" %> 
```

在您的内容页面代码后面，设置母版页的 PageSection 属性

```
Master.PageSection = "home"; 
```

在您的母版页中，将 body 标记设为服务器标记

```
<body ID="bodyTag" runat="server"> 
```

在后面的母版页代码中，使用该属性在 body 标记上设置一个类

```
bodyTag.Attributes.Add("class", this.PageSection); 
```

为您的每个导航项目提供一个唯一的 ID 属性。

在您的 css 中，根据当前页面类更改导航项的显示

```
.home #homeNavItem,
.contact #contactNavItem
{ 
    color: #f00; 
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T20:28:17.847

这是一个更好的语义匹配，并且可能是一个更容易设置的变量，以保持导航在任何地方使用相同的类或 id，并且只更改 body 元素的 id 以匹配：

```
<li id="homeNav">home</li>
<li id="blogNav">blog</li> 
```

然后在每一页上......

```
<body id="home">
<body id="blog"> 
```

在CSS中：

```
#home #homeNav {background-image:url(homeNav-on.jpg);}
#blog #blogNav {background-image:url(blogNav-on.jpg);} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T16:48:15.763

使用或不使用 ContentPlaceHolder 不会影响设置了 id="current" 的元素。

您将不得不查看一些方法，无论是在母版页的代码隐藏中、javascript 函数还是在渲染菜单组件时，以便在创建时将 id="current" 正确添加到列表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-21T22:11:24.097

在您的母版页代码类中创建一个受保护的字符串属性怎么样？覆盖 OnLoad：

```
protected string _bodyId;

protected override void OnLoad(EventArgs e)
{
    _bodyId = "your css id name";
} 
```

然后在您的母版页 aspx 中：

```
<body id="<%= _bodyId %>"> 
```

这样您就不必弄乱您的 CSS，如果 CSS 来自设计机构，这尤其有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-05T10:36:54.453

下面是我们如何使用 JQuery 通过附加 css 类来更改背景来实现它。

```
$("ul.nav > li > a:contains('<%= SiteMap.CurrentNode.ParentNode.Title %>')").addClass("navselected"); 
```

（在 Jquery 中）中的“ `.nav`”`ul.nav`是应用于 UL 标记的 css 类。

`:contains`帮助检查 ul->li->a 中所有“a”标签/元素的内容，其中包含打印在菜单中的 ParentNode 标题...

如果找到，则将名为 navselected 的 css 类应用于特定的 ul->li->a 标记/元素。

问候， Minesh Shah

系统加列兵。有限公司

www.systems-plus.com

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-09T16:49:19.800

我会使用 javascript 来实现这一点。在 css 中，将您的 #current 更改为一个类 (.current)，然后在您创建的每个 ListItems 上都有 id。然后使用 RegisterStartupScript，调用获取适当 ListItem 并为其分配当前样式的 javascript 方法。使用 Prototype，这看起来像 $('MyPageLi').className = 'current'。

# mysql - 在 MySQL 中，十进制和双精度之间有什么区别（性能方面）？

> ID：188127
> 
> 赞同：3
> 
> 时间：2008-10-09T16:42:35.837
> 
> 标签：mysql, types

在我的数据库中，我想存储一个十进制分数。分数可以具有从 0 到 10 的值，以及介于两者之间的值，例如 2.3 或 9.4。

我最近了解到**int**只存储整数而不存储小数。我发现您可以使用**double**或**decimal**，但我想知道是否有任何区别？

我目前正在使用十进制。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T16:48:29.567

小数更精确，双精度通常更有效。

~~使用小数，您可以设置小数点前后要使用的位数。~~
**编辑：你可以设置十进制****和**双精度数，我的错。

对于绝对需要精确性的货币计算等事情，小数更好。双打更适合您的特定情况，即分数的准确性并不重要。

有关更多信息，请参阅MySQL 文档中[的数字类型概述。](http://dev.mysql.com/doc/refman/5.0/en/numeric-type-overview.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T16:52:58.140

为什么不使用 INT 让分数从 0 到 100？让应用程序显示除以十的分数。

这使您摆脱了小数位/舍入错误的问题。

# c# - C# 2.0 中是否有匿名的、类型安全的、通用的委托签名？

> ID：188134
> 
> 赞同：5
> 
> 时间：2008-10-09T16:44:25.503
> 
> 标签：c#, generics, delegates

考虑一个泛型函数的`A`委托：`B`

```
public delegate B Fun<A, B>(A x); 
```

然后我可以编写一个接受和调用`Fun`委托的函数：

```
public static B invokeFun<A, B>(A x, Fun<A, B> f)
{ return f(x); } 
```

（不管写是否明智`invokeFun`。）

我可以在`invokeFun`不*命名*`Fun`代表的情况下写作吗？我希望这样的事情能够奏效，但它不会：

```
public static B invokeFun<A, B>(A x, B (A) f)
{ return f(x); } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T16:48:37.680

不，没有。

您可以获得的最接近的是 .NET 3.5 中的两个通用委托系列：`Func`和`Action`. 显然它们实际上并不存在于 .NET 2.0 中（除了`Action<T>`），但它们编写起来很简单——事实上我已经[为你这样做了](http://csharpindepth.com/Articles/Chapter1/Versions.aspx):)

就我个人而言，我很高兴“uber-short”语法是无效的——我发现它比参数的普通“这里是类型，这里是名称”语法更难理解。

# php - 如何链接到 html 文档中的 gzipped javascript？

> ID：188138
> 
> 赞同：6
> 
> 时间：2008-10-09T16:46:00.197
> 
> 标签：php, javascript, compression

我已经看到许多关于 gzip 压缩 javascript 以节省下载时间的参考资料。 *但*我也看到一些警告说某些浏览器不支持这个。

我有两种不同的方法可供使用：

1.  用于`mod_deflate`使 Apache 通过 htaccess 压缩给定目录中的 JS/CSS 文件
2.  用于`ob_start('gzhandler')`压缩文件并将其以正确的标题返回给浏览器。

方法 1 的问题在于，并非所有浏览器都支持 mod_deflate，而且我不知道如何编写`.htaccess`足够聪明的文件来对此进行调整。

方法 2 的问题在于，对于如何判断浏览器是否支持 gzipped 脚本或样式表，以及如果支持，则必须将什么 mime-type 作为标题中的内容类型给出明确的答案。

我需要一些建议。首先，哪种方法更被浏览器普遍接受？其次，我如何使用任何一种方法衰减来提供未压缩的备份脚本？第三，会`<script src="js/lib.js.gz" type="text/javascript"></script>`自己工作吗？（它显然不会衰减。）

作为记录，我正在使用具有 mod_deflate 和完整 gzip 创建功能的 PHP5，并且我的 doctype 是 xhtml strict。此外，javascript 本身是用 YUI 压缩的。 **编辑：** 我刚回去看了看，但我只有 Apache 1.3；我以为我有 2 个，所以很抱歉在我可能没有 mod_deflate 时提到它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T17:04:53.590

mod_deflate 和 php 的 gzhandler 都基于 zlib，因此从这个意义上说，浏览器的内容压缩方式几乎没有区别。

针对您的第一个问题，您可以像这样设置模块特定的 .htaccess 信息：

```
<IfModule mod_deflate.c>
  # stuff
</IfModule> 
```

针对您的第二个问题，您可以检测 PHP 中的浏览器支持：

```
if (strstr($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip') ) {
  ob_start('ob_gzhandler');
  header("Content-Encoding: gzip");
// etc...
} 
```

这里有一些未经测试的 .htaccess 应该能够处理压缩与未压缩 .js 文件的协商：([来源](http://zuble.blogspot.com/2007/02/compressed-js-and-modrewrite.html))

```
<FilesMatch "\\.js.gz$">
  ForceType text/javascript
  Header set Content-Encoding: gzip
</FilesMatch>
<FilesMatch "\\.js$">
  RewriteEngine On
  RewriteCond %{HTTP_USER_AGENT} !".*Safari.*"
  RewriteCond %{HTTP:Accept-Encoding} gzip
  RewriteCond %{REQUEST_FILENAME}.gz -f
  RewriteRule (.*)\.js$ $1\.js.gz [L]
  ForceType text/javascript
</FilesMatch> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T17:18:11.117

如果浏览器正确设置了`Accept-Encoding`标题，您应该能够判断浏览器是否支持 gzip：

```
Accept-Encoding: gzip,deflate 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T17:01:22.287

实现这一点的最佳方法是让您的服务器支持内联 gzip。您将从脚本标签的 src 属性中删除“.gz”，并将文件未压缩地存储在服务器上。如果客户端支持它，服务器会自动将脚本作为 gzip 编码结果发送。这确实会花费您的服务器一些额外的 CPU，但是对于那些支持它的客户端，文件会被压缩，而旧客户端仍然会获得扩展版本。

查看 apache2 的 mod_deflate。mod_gzip 相当于 Apache 1.x。

# c# - 列表 按字母顺序排序

> ID：188141
> 
> 赞同：473
> 
> 时间：2008-10-09T16:48:03.313
> 
> 标签：c#, generics, list, lambda, sorting

我在 Framework 3.5 上使用 C#。我正在寻找快速排序 Generic `List<T>`。为了这个例子，假设我有一个`Person`类型为姓氏的列表。我将如何使用 lambda 表达式对该列表进行排序？

```
List<Person> people = PopulateList();
people.OrderBy(???? => ?????) 
```

* * *

## 回答 #1

> 赞同：727
> 
> 时间：2008-10-09T16:49:55.587

如果您的意思是就地排序（即更新列表）：

```
people.Sort((x, y) => string.Compare(x.LastName, y.LastName)); 
```

如果您的意思是新列表：

```
var newList = people.OrderBy(x=>x.LastName).ToList(); // ToList optional 
```

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2008-10-09T16:49:50.267

您是否需要对列表进行就地排序，或者只是列表内容的有序序列？后者更容易：

```
var peopleInOrder = people.OrderBy(person => person.LastName); 
```

要就地排序，您需要一个`IComparer<Person>`或一个`Comparison<Person>`. 为此，您不妨考虑`ProjectionComparer`在[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)中。

（我知道我一直在提出 MiscUtil - 它只是一直相关......）

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-09T16:48:44.153

```
people.OrderBy(person => person.lastname).ToList(); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2011-07-28T21:11:17.067

您可以使用 linq :) 使用：

```
System.linq;
var newList = people.OrderBy(x=>x.Name).ToList(); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-12-08T13:12:34.767

```
private void SortGridGenerico< T >(
          ref List< T > lista       
    , SortDirection sort
    , string propriedadeAOrdenar)
{

    if (!string.IsNullOrEmpty(propriedadeAOrdenar)
    && lista != null
    && lista.Count > 0)
    {

        Type t = lista[0].GetType();

        if (sort == SortDirection.Ascending)
        {

            lista = lista.OrderBy(
                a => t.InvokeMember(
                    propriedadeAOrdenar
                    , System.Reflection.BindingFlags.GetProperty
                    , null
                    , a
                    , null
                )
            ).ToList();
        }
        else
        {
            lista = lista.OrderByDescending(
                a => t.InvokeMember(
                    propriedadeAOrdenar
                    , System.Reflection.BindingFlags.GetProperty
                    , null
                    , a
                    , null
                )
            ).ToList();
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-01-29T07:27:47.477

对我来说，[这个有用的虚拟指南 - 在通用列表中排序 -](http://www.codedigest.com/Articles/CSHARP/84_Sorting_in_Generic_List.aspx) 有效。它通过非常完整和清晰的解释和简单的示例帮助您了解完成这项工作的 4 种方法（重载）

*   列表.排序()
*   List.Sort（通用比较）
*   List.Sort（通用 IComparer）
*   List.Sort (Int32, Int32, Generic IComparer)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-04-01T13:28:19.160

您可以使用此代码段：

```
var New1 = EmpList.OrderBy(z => z.Age).ToList(); 
```

哪里`New1`是`List<Employee>`。

`EmpList`是 a 的变量`List<Employee>`。

`z`是`Employee`类型变量。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-02-02T08:59:43.747

你也可以使用

```
model.People = model.People.OrderBy(x => x.Name).ToList(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-01T20:15:13.210

这是一个通用的分拣机。用下面的开关调用。

dvm.PagePermissions 是我的 ViewModel 上的 List T 类型的一个属性，在这种情况下，T 是一个名为 page_permission 的 EF6 模型类。

dvm.UserNameSortDir 是视图模型上的一个字符串属性，用于保存下一个排序方向。在视图中实际使用的那个。

```
switch (sortColumn)
{
    case "user_name":
        dvm.PagePermissions = Sort(dvm.PagePermissions, p => p.user_name, ref sortDir);
        dvm.UserNameSortDir = sortDir;
        break;
    case "role_name":
        dvm.PagePermissions = Sort(dvm.PagePermissions, p => p.role_name, ref sortDir);
        dvm.RoleNameSortDir = sortDir;
        break;
    case "page_name":
        dvm.PagePermissions = Sort(dvm.PagePermissions, p => p.page_name, ref sortDir);
        dvm.PageNameSortDir = sortDir;
        break;
}                 

public List<T> Sort<T,TKey>(List<T> list, Func<T, TKey> sorter, ref string direction)
    {
        if (direction == "asc")
        {
            list = list.OrderBy(sorter).ToList();
            direction = "desc";
        }
        else
        {
            list = list.OrderByDescending(sorter).ToList();
            direction = "asc";
        }
        return list;
    } 
```

# ruby-on-rails - Rake 因错误而中止

> ID：188147
> 
> 赞同：0
> 
> 时间：2008-10-09T16:48:36.837
> 
> 标签：ruby-on-rails, rake

尝试在生产服务器上设置 exception_logger 插件。在开发机器上一切正常。尝试 rake db:migrate 在产品服务器上，我收到此错误：

```
rake aborted!
no such file to load -- pagination 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T19:39:47.073

2.1 不支持经典分页 - 或者至少它是一个死库

[http://workingwithrails.com/railsplugin/5289-classic-pagination](http://workingwithrails.com/railsplugin/5289-classic-pagination)

看看 will_paginate -

[http://github.com/mislav/will_paginate/wikis](http://github.com/mislav/will_paginate/wikis)

这就是所有酷孩子都在使用的东西:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T17:07:35.397

显然该错误与分页插件有关。这意味着该错误可能根本与 exception_logger 无关......

尝试`rake db:migrate --trace`将附加输出添加到您的问题中！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T17:17:18.387

```
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
no such file to load -- pagination
/home/12348/data/rubygems/lib/rubygems/custom_require.rb:27:in `gem_original_require'
/home/12348/data/rubygems/lib/rubygems/custom_require.rb:27:in `require'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:354:in `new_constants_in'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require'
/nfs/c01/h06/mnt/12348/containers/rails/mpg_prod/vendor/plugins/classic_pagination/init.rb:24:in `evaluate_init_rb'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/rails/plugin.rb:95:in `evaluate_init_rb'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/core_ext/kernel/reporting.rb:11:in `silence_warnings'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/rails/plugin.rb:91:in `evaluate_init_rb'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/rails/plugin.rb:44:in `load'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/rails/plugin/loader.rb:33:in `load_plugins'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/rails/plugin/loader.rb:32:in `each'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/rails/plugin/loader.rb:32:in `load_plugins'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/initializer.rb:283:in `load_plugins'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/initializer.rb:138:in `process'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/initializer.rb:93:in `send'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/initializer.rb:93:in `run'
/nfs/c01/h06/mnt/12348/containers/rails/mpg_prod/config/environment.rb:13
/home/12348/data/rubygems/lib/rubygems/custom_require.rb:27:in `gem_original_require'
/home/12348/data/rubygems/lib/rubygems/custom_require.rb:27:in `require'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:354:in `new_constants_in'
/home/12348/data/rubygems/gems/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require'
/home/12348/data/rubygems/gems/gems/rails-2.1.0/lib/tasks/misc.rake:3
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:546:in `call'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:546:in `execute'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:541:in `each'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:541:in `execute'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:508:in `invoke_with_call_chain'
/usr/lib/ruby/1.8/thread.rb:135:in `synchronize'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:501:in `invoke_with_call_chain'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:518:in `invoke_prerequisites'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1183:in `each'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1183:in `send'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1183:in `each'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:515:in `invoke_prerequisites'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:507:in `invoke_with_call_chain'
/usr/lib/ruby/1.8/thread.rb:135:in `synchronize'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:501:in `invoke_with_call_chain'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:494:in `invoke'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1931:in `invoke_task'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1909:in `top_level'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1909:in `each'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1909:in `top_level'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1948:in `standard_exception_handling'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1903:in `top_level'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1881:in `run'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1948:in `standard_exception_handling'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/lib/rake.rb:1878:in `run'
/home/12348/data/rubygems/gems/gems/rake-0.8.1/bin/rake:31
/home/12348/data/rubygems/gems/bin/rake:19:in `load'
/home/12348/data/rubygems/gems/bin/rake:19 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-10T03:37:17.963

1.  **加载environment.rb**时，您的 rake 被中止。
2.  检查您的生产机器中声明的任何**丢失的宝石。**
3.  “ **sudo gem install”**那些缺失的
4.  通过在您的终端上发出**“脚本/控制台”来检查 environment.rb 是否正确加载**

# printing - 在 IE7 中打印时有没有办法设置默认页面大小？

> ID：188156
> 
> 赞同：0
> 
> 时间：2008-10-09T16:50:03.310
> 
> 标签：printing, internet-explorer-7

我最近说服了一位客户升级到 Internet Explorer 7，但现在她遇到了打印问题。当在 IE6 中从她的 webmail 打印电子邮件时，它们会以 75% 的速度打印并放在一个页面上。现在有了 IE7，他们添加了默认的“Shirnk to Fit”选项。这没有按预期工作，并使她以前的 1 页电子邮件变成 2 页。她宁愿不必对每封电子邮件进行打印预览并调整打印分辨率，所以我想知道是否有人知道设置默认值的方法“缩小以适应”以外的缩放值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T23:34:20.697

您可以使用“打印”媒体类型的 CSS 设置（也许，仅针对这一客户）将整个 HTML 的大小调整 75% 或其他东西。

[（“css print”的第一个谷歌结果是A List Apart](http://www.alistapart.com/articles/goingtoprint/)中的一个不太糟糕的例子。）

# silverlight - 您如何处理 Silverlight 中的验证？

> ID：188160
> 
> 赞同：4
> 
> 时间：2008-10-09T16:50:56.507
> 
> 标签：silverlight, silverlight-2.0

您是如何决定在 Silverlight 应用程序中处理数据/控制验证的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T19:25:01.343

您可以抛出和捕获数据验证异常。

要管理这两种类型的错误，需要采取 3 个步骤：

1.  识别控件中的错误处理程序或可见性层次结构中更高的错误处理程序（例如，容器；在本例中为包含文本框的网格）
2.  将 NotifyOnValidationError 和 ValidateOnException 设置为 true。后者告诉绑定引擎在发生异常时创建验证错误事件。前者告诉绑定引擎在发生验证错误时引发 BindingValidationError 事件。
3.  创建在步骤 1 中命名的事件处理程序。

取自[这里](http://silverlight.net/blogs/jesseliberty/archive/2008/10/13/data-binding-data-validation.aspx)。

示例代码：

```
// page.xaml.cs

private bool clean = true;

private void LayoutRoot_BindingValidationError( 
   object sender, ValidationErrorEventArgs e )
{
   if ( e.Action == ValidationErrorEventAction.Added )
   {
      QuantityOnHand.Background = new SolidColorBrush( Colors.Red );
      clean = false;
   }
   else if ( e.Action == ValidationErrorEventAction.Removed )
   {
      QuantityOnHand.Background = new SolidColorBrush( Colors.White );
      clean = true;
   }
}

// page.xaml

<Grid x:Name="LayoutRoot" Background="White" BindingValidationError="LayoutRoot_BindingValidationError" >

<TextBox x:Name="QuantityOnHand"   
    Text="{Binding Mode=TwoWay, Path=QuantityOnHand, 
        NotifyOnValidationError=true,  ValidatesOnExceptions=true }"
    VerticalAlignment="Bottom"
    HorizontalAlignment="Left"
    Height="30" Width="90"red
    Grid.Row="4" Grid.Column="1" />

// book.cs

public int QuantityOnHand
{
   get { return quantityOnHand; }
   set
   {
      if ( value < 0 )
      {
         throw new Exception( "Quantity on hand cannot be negative!" );
      }
      quantityOnHand = value;
      NotifyPropertyChanged( "QuantityOnHand" );
   }       // end set
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T00:21:05.550

如果您在尝试实现此功能时遇到问题，这不是因为您的代码已损坏，而是因为 DataGrid 中的功能已损坏。[在这里](http://jesseliberty.com/2008/10/22/it-aint-you-babe%E2%80%A6-a-not-a-bug-bug-in-datagrid/)查看 Jesse Liberty 的文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T18:10:42.133

个人还没有做太多这件事，但[这里](http://weblogs.asp.net/manishdalal/archive/2008/09/10/silverlight-business-application-part-5-validation-refactored.aspx)有一些很好的起点。我想这些将作为未来版本的一部分出现，但现在我们可能不得不使用 ASP.NET 验证器作为起点推出我们自己的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-10T04:08:41.267

此位置提供了一个非常简单的验证控制源代码：

[http://silverlightvalidator.codeplex.com/SourceControl/changeset/view/20754#](http://silverlightvalidator.codeplex.com/SourceControl/changeset/view/20754#)

以下是它的工作条件。1\. 显示无效值的指示器假定要验证的控件的位置，因此控件应紧密排列在行和列中，以便指示与控件相邻。2\. 对 ChildWindow 的验证不起作用。

我不得不修改代码以在validatorbase类中包含childwindow的条件，如下所示：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-10T04:16:54.350

```
using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using Silverlight.Validators.Controls;

namespace Silverlight.Validators
{
    public enum ValidationType
    {
        Validator,
        OnDemand
    }

    public abstract class ValidatorBase : DependencyObject
    {
        protected ValidatorManager Manager { get; set; }

        public string ManagerName { get; set; }
        public ValidationType ValidationType { get; set; }
        public IIndicator Indicator { get; set; }
        public FrameworkElement ElementToValidate { get; set; }
        public bool IsRequired { get; set; }
        public bool IsValid { get; set; }
        public Brush InvalidBackground { get; set; }
        public Brush InvalidBorder { get; set; }
        public Thickness InvalidBorderThickness { get; set; }
        public string ErrorMessage { get; set; }

        private Brush OrigBackground = null;
        private Brush OrigBorder = null;
        private Thickness OrigBorderThickness = new Thickness(1);
        private object OrigTooltip = null;

        public ValidatorBase()
        {
            IsRequired = false;
            IsValid = true;
            ManagerName = "";
            this.ValidationType = ValidationType.Validator;
        }

        public void Initialize(FrameworkElement element)
        {
            ElementToValidate = element;
            element.Loaded += new RoutedEventHandler(element_Loaded);
        }

        private bool loaded = false;
        public UserControl UserControl { get; set; }
        public ChildWindow ChildUserControl { get; set; }
        private void element_Loaded(object sender, RoutedEventArgs e)
        {
            if (!loaded)
            {

                this.UserControl = FindUserControl(ElementToValidate);
                //UserControl o = FindUserControl(ElementToValidate);
                this.ChildUserControl = FindChildUserControl(ElementToValidate);
                //MessageBox.Show(o.GetType().BaseType.ToString());
                //no usercontrol.  throw error?
                if ((this.UserControl == null) && (this.ChildUserControl==null)) return;

                if (this.UserControl != null)
                    this.Manager = FindManager(this.UserControl, ManagerName);
                else if (this.ChildUserControl != null)
                    this.Manager = FindManager(this.ChildUserControl, ManagerName);

                if (this.Manager == null)
                {
                    System.Diagnostics.Debug.WriteLine(String.Format("No ValidatorManager found named '{0}'", ManagerName));
                    throw new Exception(String.Format("No ValidatorManager found named '{0}'", ManagerName));
                }

                this.Manager.Register(ElementToValidate, this);

                if (ValidationType == ValidationType.Validator)
                {
                    ActivateValidationRoutine();
                }

                //Use the properties from the manager if they are not set at the control level
                if (this.InvalidBackground == null)
                {
                    this.InvalidBackground = this.Manager.InvalidBackground;
                }

                if (this.InvalidBorder == null)
                {
                    this.InvalidBorder = this.Manager.InvalidBorder;

                    if (InvalidBorderThickness.Bottom == 0)
                    {
                        this.InvalidBorderThickness = this.Manager.InvalidBorderThickness;
                    }
                }

                if (this.Indicator ==null)
                {
                    Type x = this.Manager.Indicator.GetType();
                    this.Indicator = x.GetConstructor(System.Type.EmptyTypes).Invoke(null) as IIndicator;
                    foreach (var param in x.GetProperties())
                    {
                        var val = param.GetValue(this.Manager.Indicator, null);
                        if (param.CanWrite && val!= null && val.GetType().IsPrimitive)
                        {
                            param.SetValue(this.Indicator, val, null);
                        }
                    }
                }
                loaded = true;
            }
            ElementToValidate.Loaded -= new RoutedEventHandler(element_Loaded);
        }

        public void SetManagerAndControl(ValidatorManager manager, FrameworkElement element)
        {
            this.Manager = manager;
            this.ElementToValidate = element;
        }

        public bool Validate(bool checkControl)
        {
            bool newIsValid;
            if (checkControl)
            {
                newIsValid= ValidateControl() && ValidateRequired();
            }
            else
            {
                newIsValid = ValidateRequired();
            }

            if (newIsValid && !IsValid)
            {
                ControlValid();
            }
            if (!newIsValid && IsValid)
            {
                ControlNotValid();
            }
            IsValid=newIsValid;
            return IsValid;
        }

        public virtual void ActivateValidationRoutine()
        {
            ElementToValidate.LostFocus += new RoutedEventHandler(ElementToValidate_LostFocus);
            ElementToValidate.KeyUp += new KeyEventHandler(ElementToValidate_KeyUp);
        }

        /// <summary>
        /// Find the nearest UserControl up the control tree for the FrameworkElement passed in
        /// </summary>
        /// <param name="element">Control to validate</param>
        protected static UserControl FindUserControl(FrameworkElement element)
        {
            if (element == null)
            {
                return null;
            }
            if (element.Parent != null)
            {
                //MessageBox.Show(element.Parent.GetType().BaseType.ToString());
                if (element.Parent is UserControl)
                {
                    return element.Parent as UserControl;
                }
                return FindUserControl(element.Parent as FrameworkElement);
            }
            return null;
        }
        protected static ChildWindow FindChildUserControl(FrameworkElement element)
        {
            if (element == null)
            {
                return null;
            }
            if (element.Parent != null)
            {
                //MessageBox.Show(element.Parent.GetType().BaseType.ToString());
                if (element.Parent is ChildWindow)
                {
                    return element.Parent as ChildWindow;
                }
                return FindChildUserControl(element.Parent as FrameworkElement);
            }
            return null;
        }

        protected virtual void ElementToValidate_KeyUp(object sender, RoutedEventArgs e)
        {
            Dispatcher.BeginInvoke(delegate() { Validate(false); });
        }

        protected virtual void ElementToValidate_LostFocus(object sender, RoutedEventArgs e)
        {
            Dispatcher.BeginInvoke(delegate() { Validate(true); });
        }

        protected abstract bool ValidateControl();

        protected bool ValidateRequired()
        {
            if (IsRequired && ElementToValidate is TextBox)
            {
                TextBox box = ElementToValidate as TextBox;
                return !String.IsNullOrEmpty(box.Text);
            }
            return true;
        }

        protected void ControlNotValid()
        {
            GoToInvalidStyle();
        }

        protected void ControlValid()
        {
            GoToValidStyle();
        }

        protected virtual void GoToInvalidStyle()
        {
            if (!string.IsNullOrEmpty(this.ErrorMessage))
            {
                object tooltip = ToolTipService.GetToolTip(ElementToValidate);

                if (tooltip != null)
                {
                    OrigTooltip = tooltip;
                }

                //causing a onownermouseleave error currently...
                this.ElementToValidate.ClearValue(ToolTipService.ToolTipProperty);

                SetToolTip(this.ElementToValidate, this.ErrorMessage);
            }

            if (Indicator != null)
            {
                Indicator.ShowIndicator(this);
            }

            if (ElementToValidate is TextBox)
            {
                TextBox box = ElementToValidate as TextBox;

                if (InvalidBackground != null)
                {
                    if (OrigBackground == null)
                    {
                    OrigBackground = box.Background;
                    }
                    box.Background = InvalidBackground;
                }

                if (InvalidBorder != null)
                {
                    if (OrigBorder == null)
                    {
                    OrigBorder = box.BorderBrush;
                        OrigBorderThickness = box.BorderThickness;
                    }
                    box.BorderBrush = InvalidBorder;

                    if (InvalidBorderThickness != null)
                    {
                        box.BorderThickness = InvalidBorderThickness;
                    }
                }
            }   
        }

        protected virtual void GoToValidStyle()
        {
            if (!string.IsNullOrEmpty(this.ErrorMessage))
            {
                this.ElementToValidate.ClearValue(ToolTipService.ToolTipProperty);

                if (this.OrigTooltip != null)
                {
                    SetToolTip(this.ElementToValidate, this.OrigTooltip);
                }
            }

            if (Indicator != null)
            {
                Indicator.HideIndicator();
            }

            if (ElementToValidate is TextBox)
            {
                TextBox box = ElementToValidate as TextBox;
                if (OrigBackground != null)
                {
                    box.Background = OrigBackground;
                }

                if (OrigBorder != null)
                {
                    box.BorderBrush = OrigBorder;

                    if (OrigBorderThickness != null)
                    {
                        box.BorderThickness = OrigBorderThickness;
                    }
                }
            }
        }

        protected void SetToolTip(FrameworkElement element, object tooltip)
        {
            Dispatcher.BeginInvoke(() =>
                        ToolTipService.SetToolTip(element, tooltip));
        }

        private ValidatorManager FindManager(UserControl c, string groupName)
        {
            string defaultName = "_DefaultValidatorManager";
            var mgr = this.UserControl.FindName(ManagerName);
            if (mgr == null)
            {
                mgr = this.UserControl.FindName(defaultName);
            }
            if (mgr == null)
            {
                mgr = new ValidatorManager()
                {
                    Name = defaultName
                };
                Panel g = c.FindName("LayoutRoot") as Panel;
                g.Children.Add(mgr as ValidatorManager);
            }
            return mgr as ValidatorManager;
        }

        private ValidatorManager FindManager(ChildWindow c, string groupName)
        {
            string defaultName = "_DefaultValidatorManager";
            var mgr = this.ChildUserControl.FindName(ManagerName);
            if (mgr == null)
            {
                mgr = this.ChildUserControl.FindName(defaultName);
            }
            if (mgr == null)
            {
                mgr = new ValidatorManager()
                {
                    Name = defaultName
                };
                Panel g = c.FindName("LayoutRoot") as Panel;
                g.Children.Add(mgr as ValidatorManager);
            }
            return mgr as ValidatorManager;
        }

    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-19T21:05:10.547

您可能想查看[PostSharp](http://www.postsharp.org/)，它使您的客户端数据模型的归属变得非常简单。

# scripting - 您为日常生活编写的最有用的脚本是什么？

> ID：188162
> 
> 赞同：132
> 
> 时间：2008-10-09T16:51:40.343
> 
> 标签：scripting

只是想知道这里的人们写了哪些小脚本/程序来帮助他或她的日常生活（也就是与工作无关）。

任何事情都会发生，无论是否具有开创性。现在对我来说，这是一个小的 Python 脚本，可以根据经过的距离和时间计算跑步速度。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2008-10-09T16:56:12.393

我的`o`钥匙掉在了笔记本电脑上；所以我编写了一个程序，将`0`彼此相距 200 毫秒内的两次击键替换为，将彼此相距 700 毫秒内的两次击键替换为 a`o`并忽略其余部分；所以我可以在更换键盘之前使用我的笔记本电脑。`0``0`

哇; 我不知道这会如此受欢迎：p

至于如何 - Microsoft 公开了一个名为[Hooks](http://msdn.microsoft.com/en-us/library/ms644959(VS.85).aspx#wh_keyboard_llhook)的漂亮的小 API 功能。

使用那个钩子；我能够编写一个“过滤器”来完成我需要它做的事情（提示：如果你用你的回调窗口返回 1 将不会处理击键）。

我知道这件事的原因实际上并不是因为我正在编写一个键盘记录器——而是因为我不久前为[Synergy](http://synergy2.sourceforge.net/)编写了一个微笑程序。

是的。我确实编写了另一个程序，用随机的字母数字键交换字母数字键，是的；这真的很有趣：D

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2008-10-22T08:38:47.853

我没有代码了，但不管你信不信，我写的最有用的脚本可能是在 VBA 中。我有一个恼人的同事，他的导火索很短，我称他为樱桃炸弹。当客户打电话然后站起来开始隔着隔间墙对我咆哮时，他经常会生气，这会扼杀我的生产力和士气。

我总是打开 Microsoft Excel。当他这样做时，我会用 alt-tab 键切换到 Excel，工具栏上有一个带有樱桃炸弹图像的新图标。我会小心翼翼地点击它……什么都不会发生。

然而，不久之后，我接到一个电话，会说“是啊，是啊，听起来很糟糕。我最好看看。” 然后我会站起来，向樱桃炸弹道歉，然后走开。

发生的事情是我们使用了 NetWare，它内置了一个原始的消息传递系统。当我点击按钮时，一个小的 VBA 脚本会向我的朋友发送一条 NetWare 消息，告诉他们樱桃炸弹又来了，他们会不会请给我打电话。他从来没想过：）

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2008-10-29T03:44:45.660

**调用了**一个 bash 脚本，因此如果我在`/a/very/deeply/nested/path/somewhere`其中并且想要“向上” *N 个*目录，我可以键入：`up *N*`

```
#!/bin/bash
LIMIT=$1
P=$PWD
for ((i=1; i <= LIMIT; i++))
do
    P=$P/..
done
cd $P 
```

例如：

```
/a/very/deeply/nested/path/somewhere> up 4
/a/very> 
```

由 gmatt 注意：

完成上述出色工作后，可以通过将以下内容放入 bashrc 将其扩展为后退功能：

```
function up( )
{
LIMIT=$1
P=$PWD
for ((i=1; i <= LIMIT; i++))
do
    P=$P/..
done
cd $P
export MPWD=$P
}

function back( )
{
LIMIT=$1
P=$MPWD
for ((i=1; i <= LIMIT; i++))
do
    P=${P%/..}
done
cd $P
export MPWD=$P
} 
```

* * *

## 回答 #4

> 赞同：67
> 
> 时间：2008-10-09T18:27:19.930

超级遥控复位按钮。*一个超级特殊*
的模拟硬件机架（在那个满屋子的 VME 板条箱比你的 GPU 还少的时候），世界另一端的用户会在凌晨崩溃。进入实验室并通过安检花了一个小时。

 *但是我们不允许连接*超级专用*控制器或修改硬件。解决方案是使用带有 epson 点阵打印机的旧 DEC 工作站，将塑料尺子粘在进纸旋钮上，将打印机放在重置按钮附近。
以普通用户身份登录 WS（不允许 root，所有外部端口都已锁定），打印包含 24 行空白行的文档 - 旋转进纸旋钮并将标尺压在*超级特殊*硬件上的重置上。

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2008-10-09T21:53:39.607

在 Windows XP 上，我设置了一个 AT 作业，每天在 C:\

```
dir /s /b * > dirlist.txt 
```

这列出了 C 驱动器上所有文件的完整路径。然后每当我需要查找文件时，我可以使用`findstr`. 这优于使用 Windows 资源管理器搜索，因为它允许在整个路径上进行正则表达式匹配。例如：

```
findstr ".jpg" dirlist.txt
findstr /i /r "windows.*system32.*png$" dirlist.txt 
```

这是一个非常快速的设置解决方案，如果您发现自己安装了全新的 Windows 并且没有互联网连接，那就太好了。

如果您需要在某些文件类型中搜索某些模式，请首先列出您需要检查的所有文件，然后在其中搜索。例如，要查找翻转图像的 Java 或 Python 程序，您可以这样做：

```
findstr "\.java \.py" dirlist.txt > narrowlist.txt
findstr /i /r /f:narrowlist.txt "flip.*image" 
```

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2008-10-09T17:43:25.760

我有一个 Python 脚本，当我插入数码相机时它会自动运行。

它会从相机上的卡上复制所有照片，备份它们，然后将它们上传到 Flickr。

* * *

上传到 Flickr 的部分来自[uploadr.py](http://berserk.org/uploadr/uploadr.txt)（我不能相信）。

这是用于卸载相机的 Python 代码。它通过 SRCDIR 递归，并在将图像复制到 DESTDIR 之前用日期和时间命名每个图像。

```
#!/usr/bin/python

import os
import string
import time
import shutil

###################################################
__SRCDIR__ = "/mnt/camera"
__DESTDIR__ = "/home/pictures/recent"
###################################################
def cbwalk(arg, dirname, names):
    sdatetime = time.strftime("%y%m%d%H%M")
    for name in names:
        if string.lower(name[-3:]) in ("jpg", "mov"):
            srcfile = "%s/%s" % (dirname, name)
            destfile = "%s/%s_%s" % (__DESTDIR__, sdatetime, name)
                    print destfile
            shutil.copyfile( srcfile, destfile)
###################################################
if __name__ == "__main__":
    os.path.walk(__SRCDIR__, cbwalk, None) 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2008-10-10T06:37:19.083

几年前，我在一些 win32 api 的帮助下编写了一个 winforms 应用程序，将自己完全锁在我的电脑之外一个小时，这样它就会迫使我去锻炼。因为我懒？不……因为我有个人健身目标。有时你只需要一点点就可以开始了:)

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2009-03-17T20:52:26.273

我编写了一个 Python 脚本，它可以访问我阅读的所有网络漫画，并下载任何新漫画。我每天只运行一次，无需单独访问每个站点，只需访问 /Comics/ 文件夹即可。;)

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2008-10-09T16:53:58.573

我的 .cmd 备份脚本。它每晚在我的服务器上运行，并根据工作日命名备份文件。一整周的备份多次拯救了我（和我的家人）：

```
:: 备份参数：
:: /V 验证？（是/否）
:: /R 限制对所有者的访问？（是/否）
:: /RS 可移动存储？（是/否）
:: /HC 硬件压缩（开/关）
:: /M 备份类型（正常/复制/差异/增量/每日）
:: /L 日志文件类型 (f/s/n)
:: /D“描述”
:: /J“工作名称”
:: /F "文件名"

本地化

:: 确保已安装网络驱动器
调用 C:\bat\configs\MapShares-home.cmd
回声

设置今天=%DATE:~0,3%
如果 %today%==Mon set 昨天=0Sunday
如果 %today%==Tue set 昨天=1Monday
如果 %today%==周三设置昨天=2Tuesday
如果 %today%==Thu set 昨天=3Wednesday
if %today%==Fri set Friday=4Thursday
如果 %today%==昨天周六设置=5Friday
如果 %today%==昨天太阳落山=6Saturday

设置 configsDir=%~dp0
设置 storePath=C:\mybackups

::（例如：星期一 C 文件）
set title=%yesterday% 备份集

echo %DATE% %TIME% %title% > "%storePath%\%yesterday%_backup.log"

调用 BackupConfigs.bat

:: 创建新的 BKF 文件
调用 C:\WINDOWS\system32\ntbackup.exe 备份 ^
    "@%configsDir%\daily.bks" ^
    /V：是 /R：否 /RS：否 /HC：关闭 /M 正常 /L：s ^
    /D "%title%" ^
    /J "%title%.job" ^
    /F "%storePath%\%昨天%.bkf" ^
    >> "%storePath%\%昨天%_backup.log"

echo %DATE% %TIME% 已完成 >> "%storePath%\%yesterday%_backup.log"

复制 "%storePath%\%yesterday%.bkf" "V:\Backups\NEPTUNE"

调用 C:\bat\clean-temps.bat

defrag -v C:> "%storePath%\%yesterday%_defrag.log"

:: 显示备份目录
开始 /D"C:\bat\Backups\" checkbkf.bat

本地化

：：暂停

```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2008-10-09T16:55:20.850

“backup.sh” 压缩目录内容并将其发送到我的 gmail 帐户。

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2010-06-18T00:27:32.517

我编写了一个脚本，最终在我的团队中每天都在使用。当我以前在英特尔工作时，我们有一个应用程序可以与访问数据库对话以获取寄存器信息的转储（我负责验证芯片组）。它将获取此信息（来自 SQL 查询）并将其转储到 CSV 文件、HTML 文件和 Excel 文件中。整个过程花了将近2个小时。不是开玩笑。不知道为什么花了这么长时间。我们会在午餐前一个小时启动它，去吃午餐，然后再回来。

我认为必须有更好的方法来做到这一点。我与维护注册表数据库的团队进行了交谈，并从他们那里获得了 SQL 代码。然后我编写了一个 perl 脚本来抓取数据并将其输出为 CSV、HTML 和 Excel 格式。运行？大约1-2秒。极大的速度提升。

2006 年在伊拉克部署期间，我还写了一些剧本（我在国民警卫队服役了 9 年——12 月离开）。我们使用了这个名为 ULLS-G（Unit Level Logistics System - Ground）的旧应用程序，它是用 ADA 编写的，最初在 DOS 上运行。他们将它破解到可以在 Windows XP 的命令 shell 中运行的位置。该系统没有鼠标界面。一切都是通过键盘，它没有批处理功能。假设您想为所有车辆运营商打印许可证？嗯……我们部队有 150 名士兵，所以花了很长时间。假设每个人都获得了新车的资格，而您想将其添加到每个人的操作员资格中？你必须一件一件地去做。

我能够找到 SAGE 数据库的 ODBC 驱动程序（ULLS-G 使用的），因此我编写了能够与 SAGE 数据库通信的 perl 脚本。因此，需要一个多小时的事情，现在只需要几秒钟。我还使用我的脚本和驱动程序进行报告。我们必须每天早上向营报告所有信息。其他单位每天早上都会手写信息。我创建了一个 Excel 宏，它使用相同的驱动程序并与 SAGE 数据库通信，并以这种方式更新了 Excel 电子表格。这是我写过的最复杂也是*唯一的 Excel 宏。*它得到了回报，因为他们授予我陆军表彰奖章。所以，是的，我因编写 perl 脚本而获得了军事奖章 :) 有多少人能这么说？;)

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2008-10-09T17:43:59.427

我是私人飞行员。我编写了几个脚本，从 Aviationweather.gov 获取当地机场的天气信息。它们对于快速回答“今天是飞行的好日子吗？”这个问题很有用。

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2008-10-10T07:23:00.817

一个 Greasemonkey 脚本，它从游戏网站 Kotaku.com中[删除明显愚蠢的 [*] 评论。](http://lkm.tumblr.com/post/49437457/kotaku-com-comment-filter)

[*] 由常见的拼写错误、全大写、过度使用“LOL”和类似的启发式方法确定。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2008-10-09T16:53:02.913

*alias dir='ls -al'*是我最喜欢的脚本。

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2008-10-09T16:54:44.907

一个线程化的 HTML 抓取工具，用于从一个使用起来很痛苦的网站下载系列/电影的所有可用字幕（您必须在搜索后点击 4 次才能进入下载页面，以显示更多广告）。现在我只需输入搜索条件并按下载。

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2008-10-09T18:49:26.640

一个 perl 脚本，它按选定的类别将我的本地 Craigslist 刮到一个 SQL DB 中，然后我可以对其进行查询。

此版本的 V2 使用计时器更新数据库，并在我匹配任何查询时提醒我，基本上为我提供了 CL 的后台代理。

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2008-10-09T16:59:07.690

通过拖放重命名海量文件。

很久以前，我制作了一个小的 VBScript，它接受 RegEx 并相应地替换文件名。您只需将一堆文件或文件夹放在上面即可。这些年来，我发现这非常有用。

[gist.github.com/15824](http://gist.github.com/15824)（注意，评论是德语）

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2008-10-13T13:52:41.047

一个 Quick and Dirty Python 脚本，它每 5 秒查找一次 google.com 的 DNS，如果成功则发出一次哔声，如果失败则发出两次哔声。

我写这篇文章是在我不得不忍受高度不稳定的家庭网络的时候写的。它让我可以立即知道网络的状态，即使我头朝下坐在房间对面的桌子下面，双手都塞满了网线，嘴里还叼着手电筒。

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2008-10-23T23:22:51.017

这，从几个月前在我的[博客上发布的一个帖子，已经从一个我认为很酷的想法变成了我最近记忆中最好的小技巧之一。](http://www.foodini.org/fingerme.cgi)我在这里全文引用：

===================

我花了很多时间在 bash 上。对于初学者来说，bash 是一个可以在大多数 unix 机器上找到的系统，幸运的是，在一些 Windows 和每台 Mac 上都可以找到它。乍一看，它只不过是一个命令行界面，因此大多数用户都没有注意到，他们认为这些东西是他们宁愿忘记的不合时宜的东西。

我几乎用 bash 做所有事情。我从命令行阅读我的电子邮件，这就是我避开标记电子邮件的原因。我浏览目录、编辑文件、参与我的日常源代码检查和交付、搜索文件、搜索内部文件、重新启动我的机器，甚至偶尔从命令行浏览网页。bash 是我数字化存在的核心和灵魂。

问题是我倾向于一次打开大约 6 个 bash 窗口。在今天的工作中，我有一个运行 Web 服务器，另一个在摆弄我的数据库，第三个、第四个和第五个编辑不同的文件，而第六个则在我的机器上磨磨蹭蹭，试图记录系统上每个文件的名称。为什么？因为如果您想知道在哪里可以通过文件名找到对象，那么能够搜索这样的档案非常方便。

当你这样做时，你的控制栏中会出现很多窗口，简单地命名为“bash”。如果您只有其中一个，这很好，但是当您有 6 个或更多时，它会很痛苦......以及其他两打其他事情。我在一对键盘/鼠标的同时控制下拥有三台显示器，但我仍然觉得需要更多。这些窗口中的每一个都打开了几个 bash 终端。

所以我把这个放在一起了。首先，将这些行放在您的 .bash_profile 中：

```
 export PROMPT_COMMAND='export TRIM=`~/bin/trim.pl`'
  export PS1="\[\e]0;\$TRIM\a\]\$TRIM> "
  trap 'CMD=`history|~/bin/hist.pl`;echo -en "\e]0;$TRIM> $CMD\007"' DEBUG 
```

我浏览并写了几十段关于这一切是如何工作的，以及为什么它是这样设置的，但你并不真正感兴趣。相信我。为什么我`...`在第三行做了“CMD = ; echo ...”一本书的一整章。许多人（包括我的另一个域所在的 bluehost）仍在使用旧版本的 bash，但它在处理陷阱的方式上存在重大错误，所以我们被困住了。如果您正在使用 bash 版本并且想要进行研究，则可以删除 CMD 并将其替换为 $BASH_COMMAND。

无论如何，我使用的第一个脚本就在这里。它会创建一个很好的提示，其中包含您的机器名称和目录，并将其缩减为合理的长度：

```
 ============trim.pl===========
  #!/usr/bin/perl

  #It seems that my cygwin box doesn't have HOSTNAME available in the 
  #environment - at least not to scripts - so I'm getting it elsewhere.
  open (IN, "/usr/bin/hostname|");
  $hostname = <IN>;
  close (IN);
  $hostname =~ /^([A-Za-z0-9-]*)/;
  $host_short = $1;

  $preamble = "..." if (length($ENV{"PWD"})>37);

  $ENV{"PWD"} =~ /(.{1,37}$)/;
  $path_short = $1;

  print "$host_short: $preamble$path_short";

                        ============================== 
```

这篇博文的顶部有一条警告，您现在应该先阅读一下，然后再开始提出愚蠢的问题，例如“为什么不直接通过 @ENV 使用 HOSTNAME 环境变量？” 很简单：因为这不适用于我尝试过的所有系统。

现在是真正酷的一点。还记得 .bash_profile 添加的第 3 行吗？

```
 trap 'CMD=`history|~/bin/hist.pl`;echo -en "\e]0;$TRIM> $CMD\007"' DEBUG 
```

它将 trim.pl 脚本输出转储到与之前相同的容器中，同时打印到命令提示符和窗口标题，但这次它添加了您刚刚键入的命令！这就是您不想在 .bashrc 中执行所有这些操作的原因：您运行的任何脚本（在我的机器上，man 就是其中之一）将在每一行触发此操作。man 的输出被我们在这里所做的事情严重混淆了。我们在终端上玩得并不好。

为了获取您刚刚键入的命令，我们将 bash 的历史记录并稍微细分一下：

```
 ===========hist.pl============
#!/usr/bin/perl

while (<STDIN>)
{
        $line = $_
}

chomp $line;
$line =~ /^.{27}(.*)/;
print $1;
                        ============================== 
```

所以现在，我有无数个窗户在运行，它们会说：

```
 castro: /home/ronb blog
  Ron-D630: /C/ronb/rails/depot script/server
  Ron-D630: /C/ronb/rails/depot mysql -u ron -p
  Ron-D630: /C/ronb/rails/depot find . > /C/ronb/system.map
  Ron-D630: /C/ronb/rails/depot vi app/views/cart.html.erb
  Ron-D630: /C/perforce/depot/ p4 protect
  Ron-D630: /C/perforce/depot/ p4 sync -f
  Ron-D630: /C/perforce/depot/ 
```

从屏幕底部的快乐小酒吧，我现在一眼就能分辨出哪个是哪个。并且因为我们已经设置了 PS1，一旦命令完成执行，命令名称就会再次被 trim.pl 的输出替换。

更新（同一天）：当我在我的 .bashrc 中尝试它时，这些东西（.bash_profile 条目）给我带来了各种各样的地狱。每当您将 bash 作为一种语言调用时，您的 .bashrc 都会由非交互式脚本执行。当我尝试使用 man 时，我遇到了这个问题。各种垃圾（我的 .bashrc 的完整文本，加上转义字符）出现在手册页的顶部。一旦你把它放在一起，我会建议在命令行上用一个快速的“man man”调用来测试这个gem。

我想是时候把自定义垃圾从我的 .bashrc 中拉出来，放到它所属的地方了……

顺便说一句，我发现自己在这个过程中的某个时刻输入了“man trap”。

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2009-06-11T01:49:35.247

在我以前的工作地点，办公时间很荒谬。那是一家软件公司，我的老板很糟糕。他会在下午 5:30 左右（正好是该回家的时间）给我们工作，并让我们在晚上 11:00 之前完成工作（远远超过我们理想的工作时间）。或者他会在仍在进行中的代码中发现恼人的问题。

所以我制作了一个批处理文件和一个脚本，它会在晚上 7:00 到晚上 8:00 之间的随机时间**关闭我的计算机。**它有一个 1 分钟的计时器，以防我下班后需要中止关机过程。

但是我会在下午 5:00 之前离开我的办公桌，所以如果他想在结账时间扔垃圾，他就找不到我留下我。如果他来到我的办公桌前看到我的电脑开着，他会认为我还在食品储藏室附近或附近的小超市买些薯条之类的东西。但如果那个时候没电，他会打电话给我，让我回办公室。

**我还安排了我机器上的 BIOS 以**在上午 8:00 或上午 9:00 左右打开机器，以防我感到懒惰并想在上午 10:00 或上午 11:00 左右闲逛。如果我走到办公桌前被抓到，他会问“你整个上午都去哪儿了？” 我会说“我正在与营销团队开会。” 或“我出去吃早餐了。”

笨狗

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2008-10-09T17:41:06.903

一个 Greasemonkey 脚本，用于向在线游戏中添加“多次按下该按钮”控制框。

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2008-12-19T09:17:46.800

我曾经在一个技术夏令营工作，我们必须在周末为小组中的每个孩子撰写这些文章，然后他们会收到并带回家作为纪念品。通常，这些由一堆通用句子和一到两个个性化句子组成。我编写了一个 Python 脚本，它从一组固定句子中构建了其中的一个，并允许用户在中间添加几个个性化的句子。这为我和我透露秘密的其他顾问节省了大量时间。尽管其中大部分是自动化的，但我们的文章看起来仍然比许多“诚实”的文章好，因为我们可以将更多时间投入到个性化部分。

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2008-10-09T16:56:57.040

```
#! /bin/bash
# check to see if site is up
#   if it is, don't worry
#   if it's down, restart apache after get a process listing
#
# v.1 Warren M Myers - initial stab
#     31 Aug 06
#

ERRCOD='7'
WHEN=`date +%d%b%y`
REPT="~/psaux.$WHEN.txt"
STARS='********************'

curl -I http://www.shodor.org > /var/tmp/curlret.txt

if [ "$?" = "$ERRCOD" ]; then
    # return was unable to connect to host: save ps -aux; mail report
    ps -aux > $REPT
    echo $STARS
    echo 'curl return results'
    echo
    cat curlret.txt
    echo
    echo $STARS
    echo 'ps -aux results'
    cat $REPT
    echo
    echo $STARS
    echo 'restarting apache'
    /etc/init.d/apache2 restart
    echo 'apache restarted'
    echo
    echo "ps -aux results saved in $REPT"
fi

rm -f /var/tmp/curlret.txt 
```

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2008-10-28T04:35:36.163

一个小脚本，用于监控一些受欢迎的网站以查找与我的技能相匹配的广告并向我发送电子邮件。

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2008-10-29T04:19:25.090

我将其用作自动加载的功能。我只需键入“mycd”，就会出现一个我经常 cd 到的目录列表。如果我碰巧知道那个号码，我可以说“mycd 2”之类的东西。要将目录添加到列表中，您只需键入“mycd /tmp/foo/somedirectory”。

```
function mycd {

MYCD=/tmp/mycd.txt
touch ${MYCD}

typeset -i x
typeset -i ITEM_NO
typeset -i i
x=0

if [[ -n "${1}" ]]; then
   if [[ -d "${1}" ]]; then
      print "${1}" >> ${MYCD}
      sort -u ${MYCD} > ${MYCD}.tmp
      mv ${MYCD}.tmp ${MYCD}
      FOLDER=${1}
   else
      i=${1}
      FOLDER=$(sed -n "${i}p" ${MYCD})
   fi
fi

if [[ -z "${1}" ]]; then
   print ""
   cat ${MYCD} | while read f; do
      x=$(expr ${x} + 1)
      print "${x}. ${f}"
   done
   print "\nSelect #"
   read ITEM_NO
   FOLDER=$(sed -n "${ITEM_NO}p" ${MYCD})
fi

if [[ -d "${FOLDER}" ]]; then
   cd ${FOLDER}
fi

} 
```

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2008-10-09T16:58:23.277

“net start”和“net stop”命令的各种快捷方式，因此我可以启动和停止服务，而无需进入服务 MMC

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2008-12-19T09:04:32.740

我喜欢根据照片的拍摄日期将照片存储在一个目录中。因此，我编写了一个程序，它可以扫描存储卡中的图片，根据图片的日期在我的硬盘上创建所需的文件夹，然后将它们复制进去。

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2009-11-20T06:49:18.370

写了一个脚本来点击我的开始按钮，然后在半秒后再次点击，每 30 秒重复一次。

让我在工作时保持在线标记，我可以在旁边的个人笔记本电脑上完成真正的工作。不受工作软件的束缚。

不要告诉老板：）

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2008-10-09T17:01:18.637

使用 rsync 执行旋转备份的 shell 脚本。它还支持执行任意子程序以支持其他预备份活动（例如下载美味的书签）。

[http://gist.github.com/6806](http://gist.github.com/6806)

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2008-10-09T19:04:23.973

一个小应用程序，每“X”毫秒左键单击（或双击）“Y”时间。不再需要那只喝水的鸟在核电站工作！;)

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2008-10-13T14:16:20.063

MySQL 备份。我制作了一个 Windows 批处理脚本，它将创建 MySQL 数据库的增量备份，每天创建一个新的转储，并每 10 分钟在远程服务器上备份一次。它无数次地拯救了我的屁股，特别是在无数次客户打电话的情况下，大喊大叫，一条记录刚刚从数据库中“消失”。我去了“没问题，让我们看看发生了什么”，因为我还编写了一个二进制搜索脚本，该脚本将查找数据库中存在记录的最后时刻。从那里很容易理解谁“偷”了它以及为什么。
你不会想象这些有多么有用，我已经使用它们将近 5 年了。我不会仅仅因为它们已经过粗略测试并且它们是定制的，就切换到其他任何东西，这意味着它们完全符合我的需要，仅此而已，但我已经对它们进行了如此多的调整，以至于添加额外的东西会很容易功能。
所以，我的“杰作”是Windows的MySQL增量备份+远程备份+日志搜索系统。我还为 Linux 编写了一个版本，但我在某个地方丢失了它，可能是因为它只有大约 15 行 + 一个 cron 作业，而不是 Windows 的大约 1,200 行 + 两个计划任务。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2008-10-09T17:48:20.680

我编写了一个简单的 VB 应用程序，用于跟踪我玩过并成功完成的 Freecell 游戏编号，并且总是使用不同的种子启动它。

....从 1....

最大游戏数为 65k。可悲的是，经过 5 年多之后，我仍然只有数百人。但至少我知道我从来没有玩过同一手牌两次！

** Postscript - 这是我写过的*唯一VB 应用程序。*我尖叫着回到 C++....

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2008-10-09T21:22:58.047

我得到了一个提取id3标签的脚本，以某种格式对新歌曲进行编码，然后根据标签将它们添加到我的音乐库中。

300行python。主要是因为 lame 不能很好地处理标签。

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2009-01-29T12:55:10.737

VBS 脚本在我的照片文件夹中创建 YYYY/YYYY-MM/YYYY-MM-DD 文件结构并将照片从我的相机移动到相应的文件夹。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2008-10-09T16:54:07.543

一个小型任务栏程序，它从第三方 JavaDoc 中提取每个错误代码常量，并让我查找给定错误代码的常量名称。另外，添加从十六进制到十进制的任何转换等。

在调试器中工作时会经常出现这种情况——您会返回错误代码，但随后将代码跟踪回文本是一个巨大的痛苦。在使用包装本机方法、操作系统调用或 COM 的软件时，这种情况更为常见……通常，常量直接从错误头文件中复制出来，没有额外的上下文、重复值和枚举。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2008-10-09T17:10:58.837

一个每小时运行一次的脚本，用于重新训练我的垃圾邮件过滤器，它基于放置 span 和 ham 的两个 IMAP 文件夹。

```
#!/bin/sh
FNDIR="train-as-spam"
FPDIR="train-as-ham"

for dir in /home/*/.maildir
do
    cd "${dir}"
    USER=`stat -c %U .`

    SRCDIR="${dir}/.${FNDIR}"
    if [ ! -d ${SRCDIR} ]; then
        echo no "${SRCDIR}" directory
    else
        cd "${SRCDIR}/cur"
        ls -tr | while read file
        do
            if grep -q "^X-DSPAM" "${file}"; then
                SOURCE="error"
            else
                SOURCE="corpus"
            fi

            dspam --user "${USER}" --class=spam --source="${SOURCE}" --deliver=innocent,spam --stdout < "${file}" > "../tmp/${file}"
            mv "../tmp/${file}" "${dir}/new/${file%%:*}" && rm "${file}"
        done
    fi

    SRCDIR="${dir}/.${FPDIR}"
    if [ ! -d ${SRCDIR} ]; then
        echo no "${SRCDIR}" directory
    else
        cd "${SRCDIR}/cur"
        ls -tr | while read file
        do
            if grep -q "^X-DSPAM" "${file}"; then
                SOURCE="error"
            else
                SOURCE="corpus"
            fi

            dspam --user "${USER}" --class=innocent --source="${SOURCE}" --deliver=innocent,spam --stdout < "${file}" > "../tmp/${file}"
            mv "../tmp/${file}" "${dir}/new/${file%%:*}" && rm "${file}"
        done
    fi

done 
```

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2008-10-09T17:41:35.763

我使用[procmail](http://www.procmail.org/)将收到的电子邮件分类到不同的文件夹。因为我记不住 procmailrc 语法，所以我使用[m4](http://www.gnu.org/software/m4/)作为预处理器。这是我的 procmailrc 的开始方式（这还不是脚本）：

```
divert(-1)
changequote(<<, >>)
define(mailinglistrule, 
<<:0:
* $2
Lists/$1
>>)
define(listdt, <<mailinglistrule($1,^Delivered-To:.*$2)>>)
define(listid, <<mailinglistrule($1,^List-Id:.*<$2>)>>)
divert# Generated from .procmailrc.m4 -- DO NOT EDIT 
```

这为邮件列表定义了两个宏，因此例如 listdt(foo, foo@example.com) 扩展为

```
:0:
* ^Delivered-To:.*foo@example.com
Lists/foo 
```

这意味着包含 foo@example.com 的 Delivered-To 标头的电子邮件应放在 Lists/foo 文件夹中。它还安排处理后的文件以警告我不要直接编辑该文件的注释开头。

现在，坦率地说，m4 吓到我了：如果我不小心重新定义了一个宏并且 procmail 开始丢弃我所有的电子邮件，或者类似的东西怎么办？这就是为什么我有一个脚本，我称之为 update-procmailrc，它以 diff 格式显示我的 procmailrc 将如何变化。如果更改只是几行并且看起来与我的意图大致相同，我可以很高兴地批准它，但如果文件有巨大的更改，我知道要更仔细地查看我的编辑。

```
#! /bin/sh

PROCMAILRC=.procmailrc
TMPNAM=.procmailrc.tmp.$$
cd $HOME
umask 077
trap "rm -f $TMPNAM" 0

m4 < .procmailrc.m4 > $TMPNAM
diff -u $PROCMAILRC $TMPNAM

echo -n 'Is this acceptable? (y/N) '
read accept

if [ -z "$accept" ]; then
    accept=n
fi

if [ $accept = 'y' -o $accept = 'Y' ]; then
    mv -f $TMPNAM $PROCMAILRC && \
    chmod 400 $PROCMAILRC && \
    echo "Created new $PROCMAILRC"
    if [ "$?" -ne 0 ]; then
        echo "*** FAILED creating $PROCMAILRC"
    fi
else
    echo "Didn't update $PROCMAILRC"
fi 
```

该脚本还没有阻止任何电子邮件灾难，但它让我不再担心更改我的 procmailrc。

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2008-10-09T17:45:45.223

一个脚本，它读取当前目录中的配置文件，登录到 FTP 帐户，并上传自上次运行以来已更改的所有文件。对于使用共享主机的客户来说真的很方便，而 FTP 是我访问文件的唯一选择。

[http://lucasoman.com/code/updater](http://lucasoman.com/code/updater)

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2008-10-09T22:10:28.653

我编写了一个用于格式化 C 源文件的脚本，该脚本使用适当的制表符和空格字符组合自动缩进代码，这样无论编辑器上的制表符设置是什么，文件都会显示正确。

源代码在[这里](http://www.soulsphere.org/tools/smart-indent)。

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2008-10-10T06:16:50.217

最有用的？但是有这么多...

1.  d.cmd 包含：@dir /ad /on
2.  dd.cmd 包含：@dir /ad /on
3.  x.cmd 包含：@exit
4.  s.cmd 包含：@start。
5.  sx.cmd 包含：@start。＆ 出口
6.  ts.cmd 包含以下内容，无论我是否在 Vista SP1 上，它都允许我通过 RDP 正确连接到另一台机器的控制台会话。

    @echo 关闭

    版本 | 找到“6.0.6001”

    如果 ERRORLEVEL 0 如果不是错误级别 1（设置 TSCONS=admin） ELSE 设置 TSCONS=console

    echo 发出命令：mstsc /%TSCONS% /v %1

    启动 mstsc /%TSCONS% /v %1

（抱歉，奇怪的格式，显然每个答案不能有多个代码示例？）

从命令提示符中，我将导航到我的 VS 解决方案文件所在的位置，然后我想打开它，但我懒得输入 blah.sln 并按 Enter。所以我写了sln.cmd：

```
@echo off
if not exist *.sln goto csproj
for %%f in (*.sln) do start /max %%f
goto end

:csproj
for %%f in (*.csproj) do start /max %%f
goto end

:end 
```

所以我只需键入 sln 并按 Enter 键，它会在当前目录中打开解决方案文件（如果有）。我将 pushd 和 popd 之类的东西包装在 pd.cmd 和 pop.cmd 中。

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2008-12-17T22:40:56.243

不是*每天*，但我确实使用 XSLT 脚本来创建我的婚礼请柬（一个用于插入邀请卡的 Pages 文件，以及一个用于地址标签的 HTML 文件）。

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2009-01-30T21:56:06.133

我写了几行代码来自动调整 powertop 在我拔下笔记本电脑时建议的所有内容，如果我重新插入笔记本电脑，则撤消它。最大功率，最大效率，最大便利。

* * *

## 回答 #43

> 赞同：2
> 
> 时间：2009-03-17T20:16:14.800

我想这取决于你如何定义有用，但我最喜欢的小脚本是 *nix`fortune`程序的变体。见下文，您将了解它的作用：

```
telemachus ~ $ haiku 

   January--
in other provinces,
   plums blooming.
    Issa 
```

它并没有真正完成任何事情，但是一个好的俳句有很长的路要走。（我喜欢着色器决定如何解释这首诗。）（**编辑**：如果我真的必须有用，我会说一个允许用户输入美国邮政编码并获取当前天气和 0-3 天预报的脚本来自谷歌。）

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2008-10-09T17:00:03.227

每个项目都有一个类似的 backup.sh，它只对源进行 tar 和 gzip 压缩，将其移动到快照目录并用时间戳标记它：project-mmddyy-hhmmss。对于提交之间的编码很有用。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2008-10-09T17:00:35.847

我有一个版本控制脚本，它将一个目录作为参数，并递归地将所有文件复制到 ../dirname/DATE/TIME/

显然这是一种糟糕的做事方式，但在安装真正的版本控制包之前它很方便。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2008-10-09T17:02:43.267

调用 assignIisSite_ToAppPool.js

当您想确保正确映射某些资源时非常有用。

:)

```
SetAppPool("W3SVC/1059997624/Root", "MyAppPool");

function SetAppPool(webId, appPoolName)
{
var providerObj=GetObject("winmgmts:/root/MicrosoftIISv2");
var vdirObj=providerObj.get("IIsWebVirtualDirSetting='" + webId + "'");
vdirObj.AppPoolId=appPoolName;
vdirObj.Put_();
} 
```

* * *

## 回答 #47

> 赞同：1
> 
> 时间：2008-10-09T17:21:12.700

```
#!/usr/bin/perl
use strict;
use utf8;
use Encode;
use File::Find;
binmode STDOUT, ':utf8';
sub orderly {
    my ($x, $y) = @_{$a, $b};
    if (my $z = $x <=> $y) {return $z}
    $x = length $a;
    $y = length $b;
    my $z = $x < $y ? $x : $y;
    if (substr($a, 0, $z) eq substr($b, 0, $z)) {
        return $y <=> $x;
    }
    else {
        return $a cmp $b;
    }
}
my %conf = map +($_ => 0), split //, 'acsxL';
sub Stat {$conf{L} ? lstat : stat}
my @dirs = ();
while (defined ($_ = shift)) {
    if ($_ eq "--") {push @dirs, @ARGV; last}
    elsif (/^-(.*)$/s) {
        for (split //, $1) {
            if (!exists $conf{$_} or $conf{$_} = 1 and $conf{a} and $conf{s}) {
                print STDERR "$0 [-a] [-c] [-s] [-x] [-L] [--] ...\n";
                exit 1;
            }
        }
    }
    else {push @dirs, $_}
}
s/\/*$//s for @dirs;  # */ SO has crappy syntax highlighting
@dirs = qw(.) unless @dirs;
my %spec = (follow => $conf{L}, no_chdir => 1);
if ($conf{a}) {
    $spec{wanted} = sub {
        Stat;
        my $s = -f _ ? -s _ : 0;
        decode(utf8 => $File::Find::name) =~ /^\Q$dirs[0]\E\/?(.*)$/s;
        my @a = split /\//, $1;
        for (unshift @a, $dirs[0]; @a; pop @a) {
            $_{join "/", @a} += $s;
        }
    };
}
elsif ($conf{s}) {
    $spec{wanted} = sub {
        Stat;
        $_{$dirs[0]} += -f _ ? -s _ : 0;
    };
}
else {
    $spec{wanted} = sub {
        Stat;
        my $s = -f _ ? -s _ : 0;
        decode(utf8 => $File::Find::name) =~ /^\Q$dirs[0]\E\/?(.*)$/s;
        my @a = split /\//, $1;
        ! -d _ and pop @a;
        for (unshift @a, $dirs[0]; @a; pop @a) {
            $_{join "/", @a} += $s;
        }
    };
}
if ($conf{x}) {
    $spec{preprocess} = sub {
        my $dev = (Stat $File::Find::dir)[0];
        grep {$dev == (Stat "$File::Find::dir/$_")[0]} @_;
    };
}
while (@dirs) {
    find(\%spec, $dirs[0] eq "" ? "/" : $dirs[0]);
    $_{""} += $_{$dirs[0]} if $conf{c};
    shift @dirs;
}
$_{$_} < 1024 ** 1 ? printf "%s «%-6.6sB» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 0), $_ :
$_{$_} < 1024 ** 2 ? printf "%s «%-6.6sK» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 1), $_ :
$_{$_} < 1024 ** 3 ? printf "%s «%-6.6sM» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 2), $_ :
$_{$_} < 1024 ** 4 ? printf "%s «%-6.6sG» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 3), $_ :
$_{$_} < 1024 ** 5 ? printf "%s «%-6.6sT» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 4), $_ :
$_{$_} < 1024 ** 6 ? printf "%s «%-6.6sP» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 5), $_ :
$_{$_} < 1024 ** 7 ? printf "%s «%-6.6sE» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 6), $_ :
$_{$_} < 1024 ** 8 ? printf "%s «%-6.6sZ» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 7), $_ :
                     printf "%s «%-6.6sY» %s\n", $_{$_}, sprintf("%6.6f", "$_{$_}" / 1024 ** 8), $_
    for grep {$_{$_} > 0} sort orderly keys %_; 
```

我将它保存在 中`~/bin/dush`，它充当一种`du -h`/`du | sort -n`混合：一次排序*并*提供人类可读的大小。对于查找占用磁盘空间的内容非常有用。

与此相类似，

```
#!/usr/bin/perl
$t = 1;
%p = map {$_ => ($t *= 1024)} qw(K M G T P E Z Y);
$t = 4707319808;
if (@ARGV) {
    if (($_ = shift) =~ /^-*dvd/i) {$t = 4707319808}
    elsif (/^-*cd[^w]*$/i) {$t = 737280000}
    elsif (/^-*cd/i) {$t = 681984000}
    elsif (/^-*([\d.]+)([kmgtpezy])/i) {$t = $1 * ($p{"\U$2"} || 1)}
    elsif (/^-*([\d.]+)/) {$t = $1}
    else {unshift @ARGV, $_}
}
($q, $r, $s) = (0, ($ENV{COLUMNS} || 80) - 13, $t);
while (<>) {
    chomp, stat;
    unless (-e _) {
        print STDERR "$_ does not exist\n";
        next;
    }
    if (($s += -s _) > $t) {
        $s && $s < $t && printf "-%7s %s\n",
            sprintf("%2.3f%%", 100 * ($t - $s) / $t), $t - $s;
        printf "-----------%d%*s\n", ++$q, $r, "-" x $r;
        $s = -s _;
    }
    printf "%8s %s\n",
        sprintf("%3.3f%%", $s * 100 / $t),
        /.{4}(.{$r})$/s ? "...$1" : $_;
}
$s && $s < $t && printf "-%7s %s\n",
    sprintf("%2.3f%%", 100 * ($t - $s) / $t), $t - $s; 
```

我将此保存为`~/bin/fit`. 当我归档一堆文件时，我会运行`ls | fit`or`ls | fit -cdrw`来帮助确定它是否适合 DVD/CD/CDRW，以及如果不适合在哪里拆分它们。

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2008-10-09T18:07:05.917

我使用了一个 DOS 程序，如果它超过了某个日期，它就会出错。我只是查看了它用于启动的批处理文件并对其进行了更改，因此它首先将日期更改为 2000，然后运行该程序。在程序退出时，它将日期更改回更改之前的状态。

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2008-10-09T18:19:57.607

我写了一个 cron 作业来获取我父亲路由器的 IP 地址并将其 ftp 到一个安全的位置，这样当他需要帮助时，我可以远程桌面并修复他的计算机。

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2008-10-09T19:00:02.237

作为计划任务，将任何修改/新文件从整个驱动器 d: 复制到备份驱动器 g:，并记录复制的文件。它还可以帮助我跟踪我在什么时候做了什么。

justdate 是一个将日期和时间打印到屏幕上的小程序

G：

光盘 \drive_d

d:

光盘\

键入 g:\backup_d.log >> g:\logs\backup_d.log

echo ===========================================> g:\backup_d.log

d:\mu\bmutil\justdate >> g:\backup_d.log

xcopy /s /d /y /c *。*g:\drive_d >> g:\backup_d.log

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2008-10-09T23:28:16.627

早在 2005 年，我就使用过 Gentoo Linux，并且使用了很多名为 genlop 的小程序来向我展示我在 gentoo 机器上出现（安装）的历史。好吧，为了简化我的工作，我写的不是一个小的 Python 脚本，而是一个大的，但那时我刚刚开始使用 Python：

```
 #!/usr/bin/python
##############################################
# Gentoo emerge status              #   
# This script requires genlop,           #   
# you can install it using `emerge genlop`.  #
# Milot Shala <milot@mymyah.com>        #
##############################################

import sys
import os
import time

#colors
color={}
color["r"]="\x1b[31;01m"
color["g"]="\x1b[32;01m"
color["b"]="\x1b[34;01m"
color["0"]="\x1b[0m"

def r(txt):
   return color["r"]+txt+color["0"]
def g(txt):
   return color["g"]+txt+color["0"]
def b(txt):
   return color["b"]+txt+color["0"]

# View Options
def view_opt():   

   print
   print
   print g("full-info - View full information for emerged package")
   print g("cur - View current emerge")
   print g("hist - View history of emerged packages by day")
   print g("hist-all - View full list of history of emerged packages")
   print g("rsync - View rsync history")
   print g("time - View time for compiling a package")
   print g("time-unmerged - View time of unmerged packages")
   print
   command = raw_input(r("Press Enter to return to main "))
   if command == '':
      c()
      program()
   else:
      c()
      program()

# system command 'clear'
def c():
   os.system('clear')

# Base program
def program():
   c()
   print g("Gentoo emerge status script")
   print ("---------------------------")
   print

   print ("1]") + g(" Enter options")
   print ("2]") + g(" View options")
   print ("3]") + g(" Exit")
   print
   command = input("[]> ")

   if command == 1:   
      print
      print r("""First of all  you must view options to know what to use, you can enter option name ( if you know any ) or type `view-opt` to view options.""")
      print
      time.sleep(2)
      command = raw_input(b("Option name: "))
      if (command == 'view-opt' or command == 'VIEW-OPT'):
         view_opt()

      elif command == 'full-info':
         c()
         print g("Full information for a single package")
         print ("-------------------------------------")
         print
         print b("Enter package name")
         command=raw_input("> ")
         c()
         print g("Full information for package"), b(command)
         print ("-----------------------------------")
         print
         pack=['genlop -i '+command]
         pack_=" ".join(pack)
         os.system(pack_)
         print
         print r("Press Enter to return to main.")
         command=raw_input()
         if command == '':
            c()
            program()

         else:
            c()
            program()

      elif command == 'cur':
         if command == 'cur':
            c()
            print g("Current emerge session(s)")
            print ("-------------------------")
            print
            print b("Listing current emerge session(s)")
            print
            time.sleep(1)
            os.system('genlop -c')
            print
            print r("Press Enter to return to main.")
            command = raw_input()
            if (command == ''):
               c()
               program()

            else:
               c()
               program()

      elif command == 'hist':
         if command == 'hist':
            c()
            print g("History of merged packages")
            print ("---------------------------")
            print
            time.sleep(1)
            print b("Enter number of how many days ago you want to see the packages")
            command = raw_input("> ")
            c()
            print g("Packages merged "+b(command)+ g(" day(s) before"))
            print ("------------------------------------")
            pkg=['genlop --list --date '+command+' days ago']
            pkg_=" ".join(pkg)
            os.system(pkg_)
            print
            print r("Press Enter to return to main.")
            command = raw_input()
            if command == '':
               c()
               program()

            else:
               c()
               program()

      elif command == 'hist-all':
            c()
            print g("Full history of merged individual packages")
            print ("--------------------------------------")
            print
            print b("Do you want to view individual package?")
            print r("YES/NO?")
            command = raw_input("> ")
            print
            if (command == 'yes' or command == 'YES'):
               print g("Enter package name")
               command = raw_input("> ")
               print
               pkg=['genlop -l | grep '+command+ ' | less']
               pkg_=" ".join(pkg)
               os.system(pkg_)
               print
               print r("Press Enter to return to main")
               command = raw_input()
               if command == '':
                  c()
                  program()
               else:
                  c()
                  program()

            elif (command == 'no' or command == 'NO'):
               pkg=['genlop -l | less']
               pkg_=" ".join(pkg)
               os.system(pkg_)
               print
               print r("Press Enter to return to main")
               command = raw_input()
               if command == '':
                  c()
                  program()

               else:
                  c()
                  program()

            else:
               c()
               program()

      elif command == 'rsync':
         print g("RSYNC updates")
         print
         print
         print
         print b("You can view rsynced time by year!")
         print r("Do you want this script to do it for you? (yes/no)")
         command = raw_input("> ")
         if (command == 'yes' or command == 'YES'):
            print
            print g("Enter year i.e"), b("2005")
            print
            command = raw_input("> ")
            rsync=['genlop -r | grep '+command+' | less']
            rsync_=" ".join(rsync)
            os.system(rsync_)
            print
            print r("Press Enter to return to main.")
            c()
            program()
         elif (command == 'no' or command == 'NO'):
            os.system('genlop -r | less')
            print
            print r("Press Enter to return to main.")
            command = raw_input()
            if command == '':
               c()
               program()

            else:
               c()
               program()

      elif command == 'time':
         c()
         print g("Time of package compilation")
         print ("---------------------------")
         print
         print

         print b("Enter package name")
         pkg_name = raw_input("> ")
         pkg=['emerge '+pkg_name+' -p | genlop -p | less']
         pkg_=" ".join(pkg)
         os.system(pkg_)
         print
         print r("Press Enter to return to main")
         time.sleep(2)
         command = raw_input()
         if command == '':
            c()
            program()

         else:
            c()
            program()

      elif command == 'time-unmerged':
         c()
         print g("Show when package(s) is/when is unmerged")
         print ("----------------------------------------")
         print

         print b("Enter package name: ")
         name = raw_input("> ")
         pkg=['genlop -u '+name]
         pkg_=" ".join(pkg)
         os.system(pkg_)
         print
         print r("Press Enter to return to main")
         time.sleep(2)
         command = raw_input()
         if command == '':
            c()
            program()

         else:
            c()
            program()

      else:
         print
         print r("Wrong Selection!")
         time.sleep(2)
         c()
         program()

   elif command == 2:
      view_opt()
      command = raw_input(r("Press Enter to return to main "))
      if command == '':
         c()
         program()
      else:
         c()
         program()

   elif command == 3:
      print
      print b("Thank you for using this script")
      print
      time.sleep(1)
      sys.exit()

   else:
      print
      print r("Wrong Selection!")
      time.sleep(2)
      c()
      program()
      command = ("")

program() 
```

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2008-10-10T05:38:29.873

一个执行文件遍历并打印按磁盘使用情况排序的目录树的 python 脚本。

* * *

## 回答 #53

> 赞同：1
> 
> 时间：2008-10-13T11:59:20.293

动漫 CRC32 校验和：

```
#!/usr/bin/python                                                                                                                                                                                  

import sys, re, zlib

c_null="^[[00;00m"
c_red="^[[31;01m"
c_green="^[[32;01m"

def crc_checksum(filename):
    filedata = open(filename, "rb").read()
    sum = zlib.crc32(filedata)
    if sum < 0:
        sum &= 16**8-1
    return "%.8X" %(sum)

for file in sys.argv[1:]:
    sum = crc_checksum(file)
    try:
        dest_sum = re.split('[\[\]]', file)[-2]
        if sum == dest_sum:
            c_in = c_green
        else:
            c_in = c_red
        sfile = file.split(dest_sum)
        print "%s%s%s   %s%s%s%s%s" % (c_in, sum, c_null, sfile[0], c_in, dest_sum, c_null, sfile[1])
    except IndexError:
        print "%s   %s" %(sum, file) 
```

* * *

## 回答 #54

> 赞同：1
> 
> 时间：2008-10-13T12:18:29.070

```
alias snoot='find . ! -path "*/.svn*" -print0 | xargs -0 egrep ' 
```

* * *

## 回答 #55

> 赞同：1
> 
> 时间：2008-10-24T00:35:08.717

我有一个批处理文件，它建立了一个 VPN 连接，然后进入一个无限循环，每五分钟 ping 一次连接另一端的机器，这样如果我不生成，VPN 服务器就不会因为不活动而断开连接一段时间内通过该连接的任何流量。

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2008-10-29T03:33:12.390

最好的现实生活剧本？

**我：（** *进入房间）* “老板，我要加薪。”

**老板：（** *从桌子后面把椅子递过来）* “加薪？请接受我的工作！”

话又说回来，这可能是*最糟糕*的剧本！

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2008-11-01T01:26:41.877

我经常使用 MS Word 宏，它获取源代码文件，在横向页面上将其格式化为两列等宽类型，为行编号，并添加公司页眉和页脚信息，如文件名、打印日期、页码和保密声明。

打印页面的两面使用大约 1/4 的纸张作为等效`lpr`命令。（还有人用吗`lpr`？？？）

* * *

## 回答 #58

> 赞同：1
> 
> 时间：2008-11-01T01:31:18.870

我为基于 Debian 的系统编写了一个小的 shell 脚本 tapt。尤其是 Ubuntu。它的基本作用是将所有“apt-get”活动发布到您的 Twitter 帐户。它可以帮助我跟踪在我的 Ubuntu 系统中安装/删除程序的内容和时间。我为此创建了一个新的 Twitter 帐户并将其保密。真的很有用。更多信息在这里：[http ://www.quicktweaks.com/tapt/](http://www.quicktweaks.com/tapt/)

* * *

## 回答 #59

> 赞同：1
> 
> 时间：2008-12-11T20:10:07.280

一个简单的 Python 脚本，将行尾从 Unix 转换为 Windows，我停留在我的 system32 目录中。它已经被遗忘了几个月，但基本上它会将已知的基于文本的文件类型列表转换为 Windows 行结尾，并且您可以指定要转换的文件或所有文件，以获得通配符列表.

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2008-12-19T08:27:49.117

我的下载目录中的 Rakefile 包含将文件从所述目录复制到外部驱动器上各自媒体档案的任务。考虑到我的互联网速度和存储容量，我每周要花几个小时来复制并适当地重新命名由 helanzb 下载的每条媒体（完全合法，我可能会补充）。

同一文件中的另一个非常有用的任务登录并在 IMDB 中抓取我拥有的所有媒体的剧集列表/唱片集，然后检查 NewzBin 以获取可以填补我所拥有的任何漏洞的报告。

结合起来，这意味着我绝对不需要做任何事情，作为交换，我每天早上醒来时所拥有的媒体比我那天坐在外置硬盘上可能消耗的还要多。

我有没有提到这完全是光明正大和合法的？d-：

我可能会将这一切合并为一种命令行媒体管理器/播放器（将内容移植到 mplayer），并在有时间时将其发布在 GitHub 上。

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2008-12-19T08:41:29.447

Work@Home.ps1 和 Work@Work.ps1 => 修改 hosts 文件，通过 LAN 或 WAN 地址。

* * *

## 回答 #62

> 赞同：1
> 
> 时间：2008-12-24T15:15:33.247

我有一个每天早上运行的批处理文件，它启动一个浏览器，其中的选项卡加载到我每天要检查的所有网站（Woot、Dilbert、Doonesbury、UserFriendly；季节性、纽约大都会队得分和选举投票网站，以及一些需要定期访问以保持会员活跃的网站）

* * *

## 回答 #63

> 赞同：1
> 
> 时间：2008-12-29T20:45:36.587

我写了一个用于 Linux 的文件提取工具，它可以提取大约 20 种不同的文件格式并使用文件内容，而不是文件名。

这个工具很受欢迎，我经常有很多人从我的博客下载它。在这里获取：

*   [E - 提取任何档案](http://martin.ankerl.com/2006/08/11/program-e-extract-any-archive/)

* * *

## 回答 #64

> 赞同：1
> 
> 时间：2008-12-29T20:57:55.190

有时我会忘记我刚刚在目录中创建的最新文件是什么，但是 ls 命令只会显示目录中的每个文件，我只想要一些最近的文件，所以我把它放在我的 .cshrc

```
 ls -l -t | awk 'NR<15{print $0}' 
```

（实际上它在一个名为 lt 的文件中，在 .cshrc 中设置为：alias lt '~/lt'）

所以现在它只会显示几个文件。

* * *

## 回答 #65

> 赞同：1
> 
> 时间：2009-02-19T03:04:26.860

运行 WinXP，我似乎从来没有时间启动碎片整理并等待它完成。所以我编写了自己的脚本来启动 XP 的内置 defrag.exe 并安排它运行。结果将保存到 C:\Temp 中的日志文件以供以后查看。

```
@echo off

GOTO :MAIN
###########################################################
#
#  Reason: 
#     This script runs the defrag utility.
#
#  Suggestion:
#     Schedule this script to run daily (via schtasks)
#
#     Example:
#        SCHTASKS /Create /SC DAILY /ST 03:00:00 
#                 /TR \"C:\path\to\DAILY_DEFRAG.BAT" /TN "Daily Defrag of C Drive\"
#
#     Example:
#        AT 03:00 /every:Su,M,T,W,Th,F,Sa C:\path\to\DAILY_DEFRAG.BAT
#
#  Required OS: 
#     Windows XP or Windows Server 2003
#
#  Required files:
#     DEFRAG.EXE
#
#
###########################################################

:MAIN

   :: Output a listing of scheduled tasks
   SCHTASKS /QUERY /V > C:\temp\schtasks.out

   :: *****************************************************
   :: * SITE SPECIFIC Program Parameters                  *
   :: *****************************************************
   :: * Drive to defrag
        SET TARGET=C:

   :: * Log file
        SET LOGFILE=C:\temp\defrag.log

   :: *****************************************************
   :: * No editable parameters below this line            *
   :: *****************************************************

   SETLOCAL

   :: Announce intentions
   echo.
   echo Beginning defragmentation of disk %TARGET%
   echo ----------------------------------------------

   echo.
   for /f "tokens=1 delims=_" %%a in ('date /t') do set NOW=%%a
   for /f "tokens=1 delims=_" %%a in ('time /t') do set NOW=%NOW% %%a
   echo  Start time: %NOW%

   :: Run the defrag utility
   C:\WINNT\SYSTEM32\defrag.exe %TARGET% -f -v > %LOGFILE%

   echo.
   for /f "tokens=1 delims=_" %%a in ('date /t') do set NOW=%%a
   for /f "tokens=1 delims=_" %%a in ('time /t') do set NOW=%NOW% %%a
   echo    End time: %NOW%

   echo.
   echo ----------------------------------------------
   echo Defrag complete. 
   echo.

:END 
```

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2009-02-19T04:25:21.920

一个[AutoHotkey](http://www.autohotkey.com "自动热键")脚本，让我的生活触手可及，只有一个键盘：

1.  一个win+组合中常用的应用程序、文件夹等。这通常意味着如果已经启动则激活应用程序，否则启动应用程序
2.  “双击” ctrl 以启动 Launchy - 这会导致我不常用的应用程序中的一些按键
3.  在 Windows 资源管理器 (XP) 中添加一堆缺少的键盘快捷键，例如创建新文件夹、切换隐藏文件/显示文件扩展名、Ctrl-Enter 在 emacs 中以文本文件形式打开任何文件、打开命令行窗口（cmd 和 cygwin shell）使用当前路径集等。
4.  Windows 操作：移动、调整大小、发送到下一个显示器、最大化/最小化、始终在顶部切换、更改透明度等，只需组合键即可
5.  诸如休眠、弹出外部驱动器、谷歌任何选定的单词（在任何应用 ctrl-c 作为复制工作的应用程序中）、关机计时器等等等。只需一个组合键即可完成所有操作

这个键盘脚本让我成为一个快乐的露营者；这实际上是我仍然使用 windows 而不是 linux 作为我的主要平台的主要原因，因为 autohotkey 仅适用于 windows。

* * *

## 回答 #67

> 赞同：1
> 
> 时间：2009-02-26T23:12:17.507

为了完整起见，我想我应该包括我自己的答案。

我写了一个简单的脚本，将两个人住在一起的费用计算在内，并在月底计算出谁欠对方的钱，这样每个人都平分秋色。我计划将其扩展为存储每个费用的类别并将它们存储在数据库中。当然，我可以只使用现有的软件……但那有什么乐趣呢？

不是很复杂，当然，但就我在家里经常使用的与工作无关的脚本而言，这个是当前的领导者。

* * *

## 回答 #68

> 赞同：1
> 
> 时间：2009-02-26T23:29:06.797

在很久以前的某个时候，我决定将我的网络主机的 public_html 目录的所有文件放入一个颠覆存储库。然后我写了一个脚本：

1.  创建、挂载和格式化 RAM 磁盘。
2.  将存储库的主干导出到 RAM 磁盘。
3.  调用`rsync`将任何更改的文件从 RAM 磁盘上传到我的托管服务提供商。我使用公钥/私钥对来避免每次都输入登录信息。
4.  卸载 RAM 磁盘。

因此，将更新从存储库推送到服务器实际上是“一键式”操作。

该脚本最令人满意的是，最初，它更像是一个 shell 脚本练习，而不是一个大项目。但是，它可能为我节省了无数小时的工作时间，并使更新网站的前景几乎没有压力，可能比我电脑上的任何其他软件都要多。

* * *

## 回答 #69

> 赞同：1
> 
> 时间：2009-03-17T20:19:22.733

我编写了一个 Python 程序来计算我公寓的共享支出，并输出一个整洁的小网格，列是室友，行是费用类别，在调整了每个室友对共享费用的贡献后，他还欠了多少租金。我们以这种方式分享了一段时间，但只是在月底将原始总数相加。我需要更精细的控制。每个行项最多 8 次击键，这比 excel 要好得多。我有点绝望地想要阻止一个室友每月花费我们预算的 25% 购买饮料的趋势……

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2009-03-17T20:46:49.937

当我们为第一个孩子考虑名字时，我写了一个简单的 Ruby 脚本来帮助我和我的妻子。它生成了所有的姓名组合，并根据我想要避免的姓名首字母黑名单检查了姓名首字母，不包括任何不符合我的标准的姓名。对于一个书呆子的爸爸来说，这感觉是一件合适的事情，实际上证明是非常值得和有用的。

除此之外，我还编写了几个 Python 脚本，它们充当我每天使用的 IRC 机器人。一个人通过正则表达式匹配将 URL 保存到[美味](http://delicious.com)的 . 另一个用作简单的 IRC [Twitter](http://twitter.com)界面，允许我检查我的提要和发布更新。

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2009-03-26T00:36:23.553

一个允许轻松 greping ps 结果的脚本：

`#!/usr/bin/php -f <?php $process = $argv[1]; echo shell_exec("ps -ef | grep $process | grep -v grep"); exit(0);`

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2009-03-26T00:49:45.207

编写了一个小 bash 脚本，该脚本对字体了解得足够多，可以搜索大约 10k 字体并查找某些关键词，尽管它们的文件名无用，但不会返回很多误报。运行了一段时间，在极小的 iMac 上运行了大约一分钟，但在过去几年中它为我节省了大约 50 个小时。

* * *

## 回答 #73

> 赞同：1
> 
> 时间：2009-03-26T01:11:35.543

这样可以保留 20 天的差异备份，而无需使用大量空间。根据需要使用链接来复制和 rsync 副本

```
 #!/bin/bash                                                                                                                                                                                                                            

BACKUPDIR=/media/proxy/store/backups/                                                                                                                                                                                                  

[ ! -d $BACKUPDIR ] && { echo "BACKUP DIRECTORY NOT AVAILABLE!"; exit; }                                                                                                                                                               

dobackup() {                                                                                                                                                                                                                           
        SDIR=$2                                                                                                                                                                                                                        
        PARENTDIR=$1                                                                                                                                                                                                                   
        echo "BACKING UP $PARENTDIR/$SDIR to $BACKUPDIR"                                                                                                                                                                               
        bnum=20
        count=$bnum
        [ -d ${BACKUPDIR}${SDIR}.$bnum ] && {  mv ${BACKUPDIR}${SDIR}.$bnum ${BACKUPDIR}${SDIR}.tmp; }
        until [ $count -eq 1 ]; do
                let lastdir=$count-1
                [ -d ${BACKUPDIR}${SDIR}.$lastdir ] && { mv ${BACKUPDIR}${SDIR}.$lastdir ${BACKUPDIR}${SDIR}.$count; }
                let count-=1
        done
        cp -al  ${BACKUPDIR}${SDIR}.0  ${BACKUPDIR}${SDIR}.1
        rsync -a --delete --bwlimit=2000  $PARENTDIR/$SDIR ${BACKUPDIR}${SDIR}.0
}

for backup in $(cat /sbin/backup.directories); do
        PDIR=$(echo $backup | awk -F '::' {'print$1'})
        DIR=$(echo $backup | awk -F '::' {'print$2'})
        dobackup $PDIR $DIR
done

exit;

cat /sbin/backup.directories
/media/warehouse::Archive
/media/warehouse::concept 
```

* * *

## 回答 #74

> 赞同：1
> 
> 时间：2009-06-11T02:18:37.933

一个随机计时器上的警报框保证至少每小时弹出一次，提醒我做一些俯卧撑。

我在军队的时候用过。

我还为我和其他任何人编写了架构规则 ( [http://architecturerules.org )。](http://architecturerules.org)

* * *

## 回答 #75

> 赞同：1
> 
> 时间：2009-06-24T18:19:26.357

我喜欢 git 如何确定何时使用 less，subversion 没有该功能，所以我想在寻呼机中轻松获得彩色输出。cgrep 别名让我可以快速选择。没有它，有时我会得到原始颜色输出。

我也，在浏览代码时，不喜欢看到某些结果，比如 .svn ctags 二进制文件

```
grep -R sourcecodetext sourcedir | nosvn 
```

以下是我的配置文件中的内容

猫 .bash_profile

```
alias nosvn="grep -v \"\.svn\|tags\|cscope\|Binary\""
alias less="less -R"
alias diff="colordiff -u"
alias cgrep="grep --color=always"

export GREP_OPTIONS='--color=auto' 
```

猫箱/gitdiffwrapper

```
#!/bin/bash

old_file=$1
tmp_file=$2
old_hex=$3
old_mode=$4
new_file=$5
new_mode=$6

colordiff -u $old_file $tmp_file 
```

猫.gitconfig

```
[diff]
    external = $HOME/bin/gitdiffwrapper 
```

猫 .subversion_config | grep ^diff-cmd

```
diff-cmd = /usr/bin/colordiff 
```

* * *

## 回答 #76

> 赞同：1
> 
> 时间：2011-04-12T02:22:49.660

一个简单的全方位外壳功能。就在我懒得去想我要做什么的时候。

当我只是浏览一些随机目录时真的很有用，我必须不断地从 ls 切换到 cd 到 less。

```
en() {
if [[ -z $1 ]] ; then
ls '.'

elif [[ -d $1 ]] ; then
cd $1

elif [[ -f $1 ]] ; then
less <$1
fi
} 
```

* * *

## 回答 #77

> 赞同：0
> 
> 时间：2008-10-09T19:06:48.430

对于我们这些不记得我们在 unix 上的位置或我们正在使用的 SID 的人。
在你的 .profile 中弹出这个。

```
<br>function CD
<br>{
<br>   unalias cd
<br>   command cd "$@" && PS1="\${ORACLE_SID}:$(hostname):$PWD> "
<br>   alias cd=CD
<br>}
<br>
alias cd=CD 
```

* * *

## 回答 #78

> 赞同：0
> 
> 时间：2009-11-20T06:51:28.070

```
copy con c.bat
c:
cd\
cls
^Z 
```

# visual-studio - Team Foundation Server (TFS) 文件差异查看器 - 使用其他工具进行自定义

> ID：188166
> 
> 赞同：19
> 
> 时间：2008-10-09T16:52:37.047
> 
> 标签：visual-studio, tfs, merge, diff

我正在为 Visual Studio 2005 使用 Team Foundation Server (TFS)。

每当我想比较两个文件的版本时，TFS 都会显示一个带有差异的窗口。

**问题是它总是垂直分割。**

实际上，几乎每次，**我都希望将其水平拆分。** 我已经查看了 TFS 选项并进行了谷歌搜索，但我一无所获。我很震惊地认为这样的选项不可用！

有什么方法可以配置 TFS 以水平拆分它？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-10T10:20:51.237

我发现 TFS 中内置的差异化工具严重缺乏，因此我在工具 -> 选项 -> 源控制 -> Visual Studio Team Foundation 的环境中设置了 WinMerge ( [http://www.winmerge.org/ )。](http://www.winmerge.org/)

下面有一篇不错的博文：

[http://www.vitalygorn.com/blog/post/2007/12/Better-DiffMerge-tool-for-TFS.aspx](http://www.vitalygorn.com/blog/post/2007/12/Better-DiffMerge-tool-for-TFS.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-10T14:40:09.207

无法更改内置 diff/merge 实用程序的方向。有很多第三方工具（有些是免费的，有些不是）可供选择。查看 James Manning 的这篇[文章](http://blogs.msdn.com/jmanning/pages/diff-merge-configuration-in-team-foundation-common-command-and-argument-values.aspx)，他在其中跟踪了在配置各种工具以供 Team Foundation 的比较和（内容）合并操作使用时使用的正确命令/参数值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-15T22:24:23.967

这似乎是对如何在 TFS 中使用 Winmerge 的更全面的描述 - [http://www.neovolve.com/post/2007/06/19/using-winmerge-with-tfs.aspx](http://www.neovolve.com/post/2007/06/19/using-winmerge-with-tfs.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-25T05:53:29.033

我有 Visual Studio 2012，我可以在并排选项和内联模式之间进行选择。使用内联模式，前后出现在另一个下方，这样我就有了完整的编辑窗口。

[StackOverflow 上的相关帖子](https://stackoverflow.com/questions/18316799/visual-studio-2012-code-review-difference-window)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-31T21:08:02.170

要使用[WinMerge](http://winmerge.org/)（[也在 SourceForge 上](http://sourceforge.net/projects/winmerge/)），您必须导航到**工具 > 选项 > 源代码管理 > Visual Studio Team Foundation Server**（Visual Studio 2015；其他版本可能在稍微不同的地方有这个选项）。在该选项页面上，选择**配置用户工具...**，然后在该对话框中，选择**添加...**为您的差异工具添加信息。

在“配置工具”对话框中，我设置了以下信息：

*   延期：`.*`
*   操作：（`Compare`或者`Merge`如果你愿意）
*   命令：路径`WinMergeU.exe`
*   [论据](http://manual.winmerge.org/Command_line.html)：`/x /e /u /wl /wr /dl %6 /dr %7 %1 %2`

# java - Java 的命名实体识别库

> ID：188176
> 
> 赞同：27
> 
> 时间：2008-10-09T16:54:54.080
> 
> 标签：java, nlp, named-entity-recognition

我正在为 java 寻找一个简单但“足够好”的命名实体识别库（和字典），我正在寻找处理电子邮件和文档并提取一些“基本信息”，例如：姓名、地点、地址和日期

我一直在环顾四周，大多数似乎都偏重于 NLP 类项目。

有什么建议吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-09T19:28:34.410

您可能想看看[我之前对](https://stackoverflow.com/questions/163923/methods-for-geotagging-or-geolabelling-text-content#164722)类似问题的回答之一。

除此之外，大多数较轻的 NER 系统在很大程度上取决于所使用的域。例如，您会发现很多关于生物医学 NER 系统的工具和论文。除了我之前的帖子（如果你想做 NER，它已经包含了我的主要建议），这里还有一些你可能想要研究的工具：

*   斯坦福[CER-NER](http://nlp.stanford.edu/software/CRF-NER.shtml)
*   [Postech Biomedical NER System](http://isoft.postech.ac.kr/Research/BioNER/POSBIOTM/NER/main.html)如果您对此特定领域感兴趣
*   [OpenCalais](http://www.opencalais.com/tools)似乎是一个商业系统。OpenCalais有[UIMA 包装器，](http://incubator.apache.org/uima/sandbox.html#concept.mapper.annotator)但它们似乎过时了。UIMA 还有一个基于字典的 Context-Mapper 注释器，可以帮助您。请注意，UIMA 意味着学习曲线的大量开销；-)
*   [OpenNLP](http://opennlp.sourceforge.net/projects.html)也有一个 NER 工具。
*   [除其他外， Balie](http://balie.sourceforge.net/)也进行 NER。
*   [ABNER](http://pages.cs.wisc.edu/~bsettles/abner/)做了 NER，但它再次专注于生物医学领域。
*   德国耶拿大学的JULIE [Lab Tools也做 NER。](http://www.julielab.de/content/view/117/174/)他们有独立版本和 UIMA 分析引擎。

补充一点：如果不对输入进行标记化，您将无法逃脱。自然语言的标记化有点不重要，这就是为什么我建议你使用一个为你做这两件事的工具箱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T21:15:22.443

顺便说一句，我最近遇到了[OpenCalais](http://www.opencalais.com/)，它似乎具有我一直在关注的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-27T20:42:32.750

您可能还想尝试[Alchemy API](http://www.alchemyapi.com/)。它类似于 Open Calais。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-28T07:06:17.593

对于 NLP 语法，您可以查看[http://code.google.com/p/graph-expression/](http://code.google.com/p/graph-expression/)和[http://gate.ac.uk/](http://gate.ac.uk/)

# c# - 如何将 ArrayList 转换为结构数组？

> ID：188184
> 
> 赞同：5
> 
> 时间：2008-10-09T16:56:38.647
> 
> 标签：c#, .net, vb.net, arrays, arraylist

在这里我有：

```
Public Structure MyStruct
   Public Name as String
   Public Content as String
End Structure

Dim oStruct as MyStruct = New MyStruct()
oStruct.Name = ...
oStruct.Content = ...

Dim alList as ArrayList = new ArrayList()
alList.Add(oStruct) 
```

我想将 ArrayList 转换为 MyStruct 类型的静态强类型数组。我怎样才能做到这一点？我对 ToArray 没有运气。

我正在使用 .NET Framework 2.0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T16:59:50.683

你必须转换结果`ToArray`

```
MyStruct[] structs = (MyStruct[]) alList.ToArray(typeof(MyStruct)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T16:59:58.047

我假设由于您使用的是 ArrayList，所以您使用的是 1.1？

在这种情况下，我怀疑以下方法会起作用：

```
ArrayList list = new ArrayList();
MyStruct[] array = new MyStruct[list.Count];
list.CopyTo(array); 
```

（编辑 - Bill 的 ToArray 使用更方便 - 我不知道那个，但是，我很少 [如果有的话] 使用 ArrayList）

但是，如果 MyStruct 真的是一个结构，那么我不能足够强烈地说可变结构是一个坏主意 - 即您可以在创建后设置 .Name 和 .Content 的位置。结构应该几乎总是不可变的。实际上，您的 MyStruct 看起来应该是一个类。另外 - 我对 VB 没有“了解”，但它们是公共领域吗？再次 - 不推荐 - 属性会更可取。我不了解 VB，但 C# 3.0 对此有一些非常简洁的语法：

```
public class SomeType
{
    public string Name {get;set;}
    public string Content {get;set;}
} 
```

如果您使用的是 2.0 或更高版本，请考虑使用 List<T> 而不是 ArrayList。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T17:00:54.550

ToArray 是正确的方法。在 C# 中它将是：

```
MyStruct[] array = (MyStruct[]) alList.ToArray(typeof(MyStruct)); 
```

顺便说一句，您是否坚持使用 1.1？如果您使用的是 2.0，您可以改用 List<T> 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T17:04:50.487

这对我有用

```
Dim array As MyStruct() = alList.ToArray(GetType(MyStruct)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T17:05:57.410

如果您正在运行 Visual Studio 2008，则可以使用 List 对象。

```
 Dim alList As New List(Of MyStruct)
  alList.Add(oStruct) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T17:07:31.213

如果您使用的是 2.0 或更高版本，您可能希望像这样定义您的数组列表：

```
Dim alList as New List(Of MyStruct)()
alList.Add(oStruct) 
```

这将为您提供与数组相同的语义（按索引查找、强类型、IEnumerable 支持等）。

在 .Net 2.0 及更高版本中使用数组而不是通用列表只有两个原因：

1.  您可以绝对确定地知道您拥有的物品数量，并且知道数量不会改变。这是非常罕见的。
2.  您需要调用一个需要数组的函数。在 BCL 中仍然有相当多的这些，但是您自己的代码应该要求`IEnumerable<T>, IList<T>, or ICollection<T>`，而且很少是数组。

最后，这有点挑剔，但我想在您发布的代码中解决两个风格点。首先，请注意我用来创建`New List<MyStruct>`. 没有 = 符号，您不必输入类型名称两次。这也是 1.1 中的支持，所以没有任何借口。其次，Microsoft 在 MSDN 上发布的[.Net 样式指南（请参阅](http://msdn.microsoft.com/en-us/library/ms229042.aspx)[一般命名约定](http://msdn.microsoft.com/en-us/library/ms229045.aspx)部分）特别建议不要使用诸如“o”或“a”之类的匈牙利疣。这对 VB6/VBScript 来说很好，它们是松散类型的，但 .Net 是强类型的，这使得疣，嗯，丑陋。

# .net - 使用 WSE 2.0 将 ASP.NET 1.1 Web 服务升级到 .NET 3.5

> ID：188188
> 
> 赞同：1
> 
> 时间：2008-10-09T16:57:31.890
> 
> 标签：.net, web-services

我们最近将包含使用 WSE 2.0 的 Web 服务的应用程序升级到 .NET 3.5。当我们在 Visual Studio 2008 中转换项目时，它没有提到任何关于删除和/或修改 WSE 2.0 命名空间的内容。这是 .NET 1.1 项目中 Web 服务的基本架构。

网络服务源代码：

```
[WebService(Namespace="http://tempuri.org")]
public class MyWebService : BaseWebService
{
    //Do some stuff
} 
```

BaseWebService 源代码：

```
using Microsoft.Web.Services2;
using Microsoft.Web.Services2.Security;
using Microsoft.Web.Services2.Security.Tokens;

namespace MyNameSpace
{
    public class BaseWebService : System.Web.Services.WebService
    {
        public BaseWebService()
        {
            if(RequestSoapContext.Current == null)
                throw new ApplicationExcpetion("Only SOAP requests are permitted.");
        }
    }
} 
```

在转换过程中，BaseWebService.cs 类已从项目中排除，WSE2.0 命名空间已从该类中删除。

是否有其他人在尝试使用 WSE 将 Web 服务从 .NET 1.1 升级到 .NET 3.5 时遇到任何问题？

这与我之前关于使用升级后的 Web 服务的客户端的问题有关：

[堆栈溢出问题](https://stackoverflow.com/questions/185420/issues-with-client-consuming-a-net-web-service-upgraded-from-net-11-to-35)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T20:07:34.923

正如我对原始问题的回答[：](https://stackoverflow.com/questions/185420/issues-with-client-consuming-a-net-web-service-upgraded-from-net-11-to-35#198806)

据说 WCF (.net 3.5) 与 WSE3 (.net 2.0+) 兼容，但与 WSE2 (.net 1.1+) 不兼容。

所以如果你不想更改客户端，但希望它与服务兼容，你可以保留旧的服务源代码，并保留对 VS2008 解决方案下的 WSE2 程序集的引用。因此，客户端和服务都将兼容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T17:19:32.643

这是服务的 web.config 中的设置：

```
<system.web>
    <webServices>
        <soapExtensionTypes>
            <add type="Microsoft.Web.Services2.WebServicesExtension, Microsoft.Web.Services2, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" priority="1" group="0" />
            <!--<add type="Microsoft.Web.Services2.Configuration.WebServicesConfiguration, Microsoft.Web.Services2, Version=2.0.3.0, Culture=neutral,  PublicKeyToken=31bf3856ad364e35"/>-->
        </soapExtensionTypes>
   </webServices>  
</system.web> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:53:21.193

我发现的最大问题是在 Javascript 中硬编码了我的一些服务器控件的名称。在带有母版页的 ASP.NET 2.0 中，id 更改为类似 ctrl$_gridview1_checkbox1... 因此，需要使用控件的 ClientID 属性从服务器端更改和生成任何硬编码引用。

我还发现 .NET 2.0 对未捕获的异常更加严格，在升级并仅更改最小代码以便我们能够成功编译之后，我们开始出现大量崩溃和未处理的异常。我们一开始就有很多错误和写得很糟糕的代码，但有趣的是 .net 1.1 从来没有抱怨或愉快地吞下这些错误......

# c# - 将 CheckBox 列添加到具有持久性的 GridView

> ID：188191
> 
> 赞同：2
> 
> 时间：2008-10-09T16:58:55.070
> 
> 标签：c#, asp.net, ado.net, webforms

我有一个 ASP.NET 应用程序，可以将各种视图显示到一个大型蛋白质序列数据库中。当访问者浏览数据时，我希望他们能够在 GridView 行中选择一个 CheckBox 来标记序列，以便以后下载为压缩文本文件。我不想存储选择，因此它们应该对会话有效。

我现在的想法是向 GridView 添加一个 TemplateField，然后向其中添加一个 CheckBox。我打算处理检查事件并将序列 ID 存储在会话状态中。当用户前往下载页面时，我将获取会话数据，显示他们将要下载的序列列表，然后将文件一起发送。显然，我还必须在每次表单加载/页面切换时重新解析会话数据。

所以我实际上对此有几个问题：

1）我做的工作太多了吗？有没有更简单的方法来实现这个？

2）会话状态的所有往返服务器是否可能是性能问题？我可以在页面上放置一个“保存下载”按钮来批量处理它以帮助解决问题。处理检查事件似乎更具容错性，因为如果您离开，您不会意外丢失您的状态。

3) 是否可以按复选框列对 GridView 进行排序？我想先按复选框列排序，然后是当前排序的列（例如，如果 GridView 按姓氏排序，则按复选框列排序，然后按姓氏排序）。

万一这很重要，我正在使用 C#、.NET 3.5、VS2008，并且我正在使用从 SQLServerExpress 表创建 GridView 的简单拖放方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T23:33:49.423

通过页面方法使用 AJAX 来跟踪会话状态中的复选框状态。这将最大限度地降低往返成本。

我认为您无法通过 GridView 中的复选框进行排序，因为您需要指定排序列。您可以通过创建一个合成数据源来做到这一点，该数据源基本上将您保存的会话信息与表中的数据连接起来，但不能使用直接连接到表的 SQLDataSource。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T17:15:51.433

我不确定是否有更简单的方法，但至于您的其他问题：

2.) 您需要自己决定稳健性和网络流量之间的平衡。如果您使用 check 事件，您将返回到服务器相当多的时间。如果您使用不同的事件（失去对网格的关注、明确的“更新/保存”按钮单击或导航到另一个页面），您会以可能丢失信息为代价来减少流量。这是一个没有“正确”答案的 UI 设计决策。

3.) 这是可能的，尽管它可能不是自动的。我知道 DataGridViews 将生成处理程序以自动按复选框列排序。我不确定使用常规 GridView 是否那么容易。您使用 GV 而不是 DGV 有什么原因吗？

# bash - “&> foo”和“> foo 2>&1”有什么区别？

> ID：188208
> 
> 赞同：10
> 
> 时间：2008-10-09T17:01:48.200
> 
> 标签：bash

似乎有两个 bash 习惯用于将 STDOUT 和 STDERR 重定向到文件：

```
fooscript &> foo 
```

... 和 ...

```
fooscript > foo 2>&1 
```

有什么不同？在我看来，第一个只是第二个的捷径，但我的同事认为，即使初始重定向出现错误，第二个也不会产生输出，而第一个会将重定向错误吐出到 STDOUT。

**编辑**：好的......似乎人们不明白我在问什么，所以我会尽量澄清：

谁能给我一个例子，上面写的两条*特定行*会产生不同的行为？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T17:33:39.023

从[bash 手册](http://www.gnu.org/software/bash/manual/bashref.html#Redirections)：

> 重定向标准输出和标准错误有两种格式：
> 
> ```
> &>word 
> ```
> 
> 和
> 
> ```
> >&word 
> ```
> 
> 在这两种形式中，首选第一种。这在语义上等价于
> 
> ```
>  >word 2>&1 
> ```

“语义等价”这个短语应该与您的同事解决问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T17:57:59.163

这两行具有不同行为的情况是当您的脚本不是在 bash 中运行，而是在 sh 系列中运行一些更简单的 shell，例如[dash](http://en.wikipedia.org/wiki/Debian_Almquist_shell)（我相信它在某些 Linux 发行版中用作 /bin/sh，因为它比巴什）。在这种情况下，

```
fooscript &> foo 
```

被解释为两个命令：第一个在后台运行 fooscript，第二个截断文件 foo. 命令

```
fooscript > foo 2>&1 
```

在前台运行 fooscript 并将其输出和标准错误重定向到文件 foo. 在 bash 中，我认为这些行总是会做同样的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T17:32:22.037

根据我的经验，使用 的主要原因`2>&1`是当您想将所有输出附加到文件而不是覆盖文件时。使用`&>`语法，您不能追加。因此`2>&1`，您可以编写类似的内容`program >> alloutput.log 2>&1`并将 stdout 和 stderr 输出附加到日志文件中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T17:28:34.387

`&>foo`比 少打字`>foo 2>&1`，更不容易出错（你不能以错误的顺序得到它），但达到了相同的结果。

`2>&1`令人困惑，因为您需要将它放在`1>`重定向之后，除非标准输出被重定向到`|`管道，在这种情况下它会在...

```
$ some-command 2>&1 >foo # 出乎意料
$ some-command >foo 2>&1 # 和
$ some-command &>foo # 这个和
$ some-command >&foo # 与其他 shell 兼容，但如果文件名是数字则麻烦
$ 一些命令 2>&1 | less # 但重定向会在 *before* 此处的管道之前进行...
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T17:04:56.680

```
&> foo # Will take all and redirect all output to foo.

2>&1 # will redirect stderr to stdout. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T17:20:35.883

2>&1 取决于在命令行中指定的顺序。where &> 将 stdout 和 stderr 都发送到任何地方， 2>&1 将 stderr 发送到 stdout**当前**在命令行中的那个位置。因此：

命令 > 文件 2>&1

不同于：

命令 2>&1 > 文件

前者将 stdout 和 stderr 都重定向到文件，后者将 stderr 重定向到 stdout 在重定向到文件之前要去的地方（在这种情况下，可能是终端。）如果你想做类似的事情，这很有用：

命令 2>&1 > 文件 | 较少的

您想在哪里使用 less 来翻阅 stderr 的输出并将 stdout 的输出存储到文件中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T17:07:59.793

`2>&1`对于您不将 stdout 重定向到其他地方的情况可能很有用，而是您只想将 stderr 发送到与 stdout 相同的位置（例如控制台）（也许如果您正在运行的命令已经在某处发送 stderr控制台以外的其他）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-07T20:36:05.940

我知道这是一个很老的帖子..但是分享什么可以回答这个问题：* ..会产生不同的行为吗？

场景：当您尝试使用“tee”并希望使用 bash 中的进程替换来保留退出代码时... someScript.sh 2>&1 >( tee "toALog") # 这无法捕获输出到日志

然而 ：

someScript.sh >& >( tee "toALog") # 工作正常！

# asp.net - .ASPX 页面如何获取其文件系统路径？

> ID：188209
> 
> 赞同：6
> 
> 时间：2008-10-09T17:02:38.290
> 
> 标签：asp.net

我有一个页面something.aspx，关联的代码隐藏在something.aspx.cs。在那个代码隐藏中，我想知道 something.aspx 的文件系统位置。有什么方便的获取方式吗？

更新：我得到了几个很好的答案，不幸的是因为我在做其他疯狂的事情而没有奏效。我在我传入的 URL 上编码了一些附加信息，所以它看起来像这样：

[http://server/path/something.aspx/info1/info2/info3.xml](http://server/path/something.aspx/info1/info2/info3.xml)

服务器处理这个问题（我没有使用查询字符串参数来解决我没有编写的其他代码）。但是当我调用 Server.MapPath(Request.Url.ToString()) 时，我收到一个错误，即带有“信息”段的完整 URL 不是有效的虚拟路径。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T17:05:06.697

```
// File path
string absoluteSystemPath = Server.MapPath("~/relative/path.aspx");
// Directory path
string dir = System.IO.Path.GetDirectoryName(absoluteSystemPath);
// Or simply
string dir2 = Server.MapPath("~/relative"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-09T17:37:00.577

[Request.PhysicalPath](http://msdn.microsoft.com/en-us/library/system.web.httprequest.physicalpath.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T17:05:49.300

[Server.MapPath](http://msdn.microsoft.com/en-us/library/ms524632.aspx)是最常用的方法之一。

```
string physicalPath = Server.MapPath(Request.Url); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T17:38:35.253

`Server.MapPath( Request.AppRelativeCurrentExecutionFilePath )`

# sql-server - 早于 1900 年 1 月 1 日的 MS SQL 日期时间

> ID：188214
> 
> 赞同：4
> 
> 时间：2008-10-09T17:04:37.087
> 
> 标签：sql-server, date

当然有一种方法可以将 1-1-1900 之前的日期值存储在除 varchar 之外的列中吗？还是我真的必须打破这个，并执行我自己的日期时间库来处理日期差异、排序等？

是的，我了解日期时间的实际存储方式（来自特定日期的整数值），但我记得几年前还有另一种解决方法。它现在只是让我失望。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T17:07:23.273

smalldatetime 与日期时间！

[http://msdn.microsoft.com/en-us/library/ms187819.aspx](http://msdn.microsoft.com/en-us/library/ms187819.aspx)

[http://msdn.microsoft.com/en-us/library/ms182418.aspx](http://msdn.microsoft.com/en-us/library/ms182418.aspx)

！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T17:12:03.110

是的，SQL Server DateTime 类型可以存储从 1753 年 1 月 1 日开始的日期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T17:29:18.097

SQL Server 2008 具有 DATE 数据类型，范围从 0001-01-01 到 9999-12-31。

对于以前的版本，如果您需要 1753-01-01 之前的日期（DATETIME 的最小值），请提供您的 SOL。

# visual-studio - 如何在 Visual Studio 2008 中为源代码管理命令分配键盘快捷键？

> ID：188225
> 
> 赞同：2
> 
> 时间：2008-10-09T17:06:57.940
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, visual-studio-2005, perforce

我在 Visual Studio 2008 中使用 Visual C++ 2008。我经常使用以下命令将打开的文件与最近签入的版本进行比较：

```
File | Source Control | Compare... 
```

我也可以通过单击源代码管理工具栏中的图标来执行相同的操作。

我不确定，但我相信这个命令对于任何源代码控制插件都是一样的（我碰巧使用了 Perforce 插件。）

我想分配一个键盘快捷键来执行此命令，但我似乎无法在通常进行此类分配的对话框中的任何位置找到它：

```
Tools | Customize... | Commands 
```

我只是没有在自定义对话框中看到命令吗？是否有另一种方法来分配这样的键盘快捷键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T17:14:09.767

工具 -> 选项 -> 键盘 -> 包含“比较”的命令

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T18:22:27.803

Nescio 的[答案](https://stackoverflow.com/questions/188225/how-to-assign-keyboard-shortcut-to-source-control-commands-in-visual-studio-2008#188256)是钱。这是更多信息：

*   快捷方式分配可以在`Tools | Options | Environment | Keyboard`
*   该命令称为`File.Compare`

# java - 使用 tomcat 和 servlet 捕获异常

> ID：188233
> 
> 赞同：4
> 
> 时间：2008-10-09T17:08:28.967
> 
> 标签：java, tomcat, servlets, error-handling

我已经设置了 tomcat 来捕获我的所有异常并将它们传递给 web.xml 中具有以下内容的 servlet。

```
<servlet-mapping>
    <servlet-name>exception</servlet-name>
    <url-pattern>/exception</url-pattern>
</servlet-mapping>
<error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/exception</location>
</error-page> 
```

这工作正常，我让 servlet 记录一些信息并转发到 jsp。但是，我想记录导致引发异常的 URI，当我调用 request.getRequestURI() 时，我得到 /exception ，这是我处理记录异常的 servlet 路径。如何获取导致异常的原始 URI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T17:36:41.187

你可以得到原始的uri

```
request.getAttribute("javax.servlet.forward.request_uri") 
```

# tfs - TFS 获取特定版本插件

> ID：188236
> 
> 赞同：0
> 
> 时间：2008-10-09T17:09:08.420
> 
> 标签：tfs, visual-studio-addins, vsx

我正在寻找一个插件，它允许我单击 VS 工具栏上的按钮，并且应该发生以下操作。

1.  在源代码管理资源管理器或解决方案资源管理器中突出显示的项目/文件夹/项目上，执行“获取特定版本”
2.  单击这两个复选框，单击该对话框上的“获取”按钮

[替代文字 http://img367.imageshack.us/img367/9162/getspecificversionyp9.jpg](http://img367.imageshack.us/img367/9162/getspecificversionyp9.jpg)

由于我发现自己经常这样做（我比通常的“获取最新版本”更信任它），我想看看其他人已经考虑过这个问题。如果没有，我将不得不自己编写一个 VS 插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T06:43:06.370

我假设您只是想确保开发人员在最新版本上开始他们的更改？

如果是这种情况，并且您使用的是 VSTS 2008 和 TFS 2008，那么使用两者的“[在结帐时获取最新版本](http://www.vitalygorn.com/blog/post/2007/12/TFS-Get-Latest-Version-on-Check-Out-in-VS2008.aspx)”设置可能是您的答案，如果您不是，那么“结帐[并获取最新版本](http://www.codeplex.com/TfsAddInCheckOut)”就是什么你调查。（注意，如果您使用的是 VSTS 2008 和 TFS 2005，则需要自己编译，请参阅主页底部的注释）

Buck Hodges 有[一个帖子](http://blogs.msdn.com/buckh/archive/2005/08/20/454140.aspx)为什么这不是 2005 年内置的，也不是 2008 年的默认操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T21:22:57.550

不是你的问题的答案，但你为什么发现你需要一直做一个获取具体？您是否在没有先签出文件的情况下在 Visual Studio 之外本地编辑或删除文件？

如果您同时选中了这两个选项，那么每次获取最新版本时，您都将下载所有最新版本的文件——这不会为您提供最佳性能。

# c# - 使用哪个版本的 StringComparer

> ID：188241
> 
> 赞同：21
> 
> 时间：2008-10-09T17:10:30.240
> 
> 标签：c#, .net, string, internationalization

如果我想要一个不区分大小写的字符串键字典，那么在给定这些约束的情况下，我应该使用哪个版本的 StringComparer：

*   字典中的键来自仅以英语语言环境（美国或英国）编写的 C# 代码或配置文件
*   该软件是国际化的，将在不同的语言环境中运行

我通常使用 StringComparer.InvariantCultureIgnoreCase 但不确定这是否正确。这是示例代码：

```
Dictionary< string, object> stuff = new Dictionary< string, object>(StringComparer.InvariantCultureIgnoreCase); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-09T20:28:39.670

比较器分为三种：

*   文化意识
*   文化不变
*   序数

每个比较器都有**区分大小写**和**不区分大小写的**版本。

**序数**比较器使用字符的序数值。这是最快的比较器，它应该用于内部目的。

**文化感知**比较器考虑特定于当前线程文化的方面。它知道“土耳其语 i”、“西班牙语 LL”等问题。它应该用于 UI 字符串。

**文化不变**比较器实际上没有定义，并且会产生不可预测的结果，因此根本不应该使用。

*参考*

1.  [在 Microsoft .NET 2.0 中使用字符串的新建议](http://msdn.microsoft.com/en-us/library/ms973919.aspx)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-09T20:33:29.207

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms973919.aspx#stringsinnet20_topic4)涵盖了您可能想深入了解的所有内容，包括土耳其语-I 问题。

已经有一段时间没有读了，所以我要再读一次。一个小时后见！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T17:18:52.643

“不区分大小写”的概念是一种语言概念，因此没有文化就没有意义。

有关更多信息，请参阅此[博客](http://www.siao2.com/2004/12/29/344136.aspx)。

也就是说，如果您只是在谈论使用拉丁字母的字符串，那么您可能会摆脱 InvariantCulture。

不过，最好使用 StringComparer.CurrentCulture 创建字典。例如，这将允许“ß”在您的字典中匹配德国文化下的“ss”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T17:16:07.220

由于键是您已知的固定值，因此 InvariantCultureIgnoreCase 或 OrdinalIgnoreCase 应该可以工作。避免特定于文化的问题，否则您可能会遇到一些更“有趣”的事情，例如“土耳其语 i”问题。显然，如果您要比较文化价值，您会使用文化比较器……但听起来您不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T17:20:49.410

StringComparer.OrdinalIgnoreCase 比 InvariantCultureIgnoreCase FWIW 稍快（根据[MSDN](http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx) ，“序数比较很快，但对文化不敏感” 。

当然，您必须进行大量比较才能注意到差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T17:27:58.163

Invariant Culture 专门用于处理程序内部的字符串，与用户数据或 UI 无关。听起来这种情况就是这种情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T04:08:42.253

System.Collections.Specialized 包括 StringDictionary。MSDN 的备注部分指出“键不能为空，但值可以。

密钥以不区分大小写的方式处理；它在与字符串字典一起使用之前被翻译为小写。

在 .NET Framework 1.0 版中，此类使用区分区域性的字符串比较。但是，在 .NET Framework 1.1 版及更高版本中，此类在比较字符串时使用 CultureInfo.InvariantCulture。有关区域性如何影响比较和排序的详细信息，请参阅比较和排序特定区域性的数据和执行不区分区域性的字符串操作。

# sql-server - Visual Studio 2008 支持的数据类型

> ID：188242
> 
> 赞同：2
> 
> 时间：2008-10-09T17:10:43.657
> 
> 标签：sql-server, visual-studio, visual-studio-2008, linq, types

[我刚刚从http://www.codeplex.com/MSFTDBProdSamples/Release/ProjectReleases.aspx?ReleaseId=16040](http://www.codeplex.com/MSFTDBProdSamples/Release/ProjectReleases.aspx?ReleaseId=16040)下载并安装了最新的 Adventure Works 数据库，以使用 LINQ 进行更多操作，发现有一些数据类型是Visual Studio 2008 本身不支持。我得到“一个或多个选定的项目包含设计器不支持的数据类型。” 错误信息。

我发现空间数据类型是这种情况下的问题。

我的问题是：

*   SQL Serve 2008 中的 Visual Studio 本身不支持哪些其他数据类型？
*   为什么不支持这些类型？

第二个问题是我想最让我困惑的问题。我可以理解为什么 MySQL、Oracle、Postgre SQL 等不支持所有数据类型。我认为 SQLServer 开发组可能会给 Visual Studio 开发组一个提示，你知道在大厅里大喊大叫什么的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T07:46:48.167

根据这篇[博客文章](http://www.sqlskills.com/blogs/bobb/post/SQL-Server-2008-data-types-in-LINQ-to-SQL-and-EF-they-(mostly)-did-it.aspx)，除了空间类型（几何和地理）和 HierarchyID 数据类型之外，它是所有内容。

至于为什么？[好吧，根据 ADO.NET 团队的博客](http://blogs.msdn.com/adonet/archive/2008/02/21/coming-soon-to-linq-to-sql.aspx)，他们在更新中发布了对大多数类型的支持，但这是最后一个 LINQ to SQL 条目。他们现在似乎只担心实体框架。谁知道我们是否会看到 LINQ to SQL v2？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-18T07:22:53.007

SqlGeography 和 LINQ to SQL

问题：当我们在 LINQ to SQL 中使用 SQL Server 2008 支持的空间数据类型 ( `Geometry`, ) 时。`Geography`

解决方案：第 1 步：创建一个基于所需表且不包含不受支持的数据类型的视图（只需将列包含为：`CAST(geography_column AS VARBINARY(MAX))`

第 2 步：将视图从`Server Explorer`/`Database Explorer`拖到设计器上。

# web-hosting - mosso 和 gogrid 哪个更好？

> ID：188245
> 
> 赞同：3
> 
> 时间：2008-10-09T17:11:25.107
> 
> 标签：web-hosting, mosso, gogrid

我有管理自己服务器的合理经验，所以 gogrid 样式管理不是问题。但似乎 mosso 是一个更便宜的标签——除了非常难以访问的计算周期术语。任何人都可以分享这一点将非常受欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-21T12:11:18.007

好吧，即使目前正确答案被标记为 GoGrid 选择，我想我也需要分享我使用 GoGrid 的经验。在我们违背与他们的承诺之后已经有几个星期了，我想我现在很冷静，可以为他们写下缺点。

1）图像。我们尝试使用 Windows 2008 映像，这些映像已经很老了。要保持最新状态，您需要安装 80 多个更新，这需要一段时间。但这还不是最糟糕的事情。最糟糕的是，默认图像硬盘大小为 20gb，这不足以完成 Windows 更新，至少以自动方式（不涉及安装其他软件）。没有办法增加映像大小，因此您需要做出各种解决方法（例如，在安装时禁用虚拟内存）。

2) 支持。这不是狂热的。我会称之为机器人。虽然在线聊天是有效的，但至少我们无法通过在线聊天解决大部分问题，因为在线聊天支持人员总是将请求转发给上级，这是通过在线聊天无法访问的。另一件事是，据我了解，拥有真正知识和访问基础设施的工程师不会在晚上和周末工作（我在欧洲工作，所以我的时区完全不同）。

3) 服务水平协议。您需要小心小字（例如，我错过了规则 1 小时不工作得到补偿 100 倍仅工作一个月账单），但有些事情没有提到 - 例如有人告诉我， SLA 条款不适用于云存储，尽管我认为您不会在 SLA 中找到这一点。

4) 反应时间。尽管在 SLA 中他们说这将在两个小时内解决任何问题，但我们无法在 10 天内得到解决方案。问题很明显：gogrid 服务器实例之间的网络速度，以及实例和云存储之间的网络速度是 10-15kbps（使用几个工具测量，例如 netio 等，测试了几个实例等）。那不是因为他们忘记了或者是什么，我们每天都在检查各个级别的状态。我的管理层与技术副总裁或其他人谈过，他承诺会在最近的时间解决问题，几天过去了，但没有提出解决方案。一些关于他们如何调查问题的电子邮件让我发笑。

5) 网速。有时它们真的很好（我测量了 550mbps 的下载速度），但有时它们很糟糕（上传速度高达 0.05mbps）。

如果有人认为这是某种竞争对手的帖子，我有关于上述问题的聊天和电子邮件日志，还有互联网速度测试的屏幕截图，可以根据要求提供。

好的，关于他们的服务的一件好事 - 您可以在一个实例上使用多个 IP 地址（我们当前的托管服务提供商 - Amazon EC2 无法做到这一点）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-11T06:12:54.400

远离 GoGrid！

我对 Mosso 没有任何经验，但我确实（不幸地）对 GoGrid 有非常糟糕的经验。

正如其他人提到的，他们的支持是可怕的。大多数情况下，您会遇到一个完全没有帮助的实时聊天人员 - 并不真正了解他们的系统或它是如何工作的，因此除了重新启动您的服务器之外，他无法真正帮助解决任何问题。

另一个问题是他们的表现，充其量是不可靠的，最坏的情况是不存在。从可以降至 < 1mb/s（由一些工具测量）的 I/O 开始 - 到非常慢的网络连接 - 不分散负载的负载均衡器（RoundRobin 上的 2 个服务器获得 70/30）

更不用说一个非常有问题的门户 - 新服务器选择了一个免费 ip，然后我被告知正在使用中......而不是我 - 即使我已经“分配”了整个范围 - 新案例被保存而没有文本 - 显示“升级到新计划”但什么也不做的按钮……等等……等等……

他们的计费部门没有响应，您必须为所有事情争论（为什么我要支付 0.5 美元/gb 的流量，而网站显示为 0.29 美元？？？？？？）

我已经使用它们大约一年了——那只是因为我没有时间搬家。希望我能在一个月内摆脱地狱。

如您所知，我对他们感到非常沮丧。我知道我没有早点逃跑是我的错，但我真的没想到服务和质量水平如此之低。

谨防....

约夫。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T13:09:55.307

不过，莫索的服务要好得多，客户也很满意。我遇到过的唯一问题是安装 DNN（这是一个痛苦的时期），并且一台客户端计算机拒绝允许 FTP 访问他们的站点……但同样，Mosso 技术人员尽其所能让它继续运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-25T06:17:57.153

很简单，Mosso 就像一个“经销商”托管。他们为您提供从计费到控制面板的所有白标，然后您将其卖给客户。

如果您是开发人员，我建议您选择 GoGrid。首先，Mosso 不提供 SSH 访问。其次，如果您是 RoR/Mongrel 用户，则您只能使用有限的 RAM（除非您在 100 美元之外支付额外费用）。此外，GoGrid 允许您选择服务器映像（CentOS、Redhat、Windows），并对 RoR 和 LAMP 提供一些开箱即用的支持。

此外，GoGrid 为您提供初始积分（如果您使用 MS-WEBFWRD，则为 50 美元或 95 美元）供您在实际付款之前试用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-19T21:07:26.183

Mosso 不再让您对“服务器”进行管理员控制......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-10T22:46:46.280

披露：我是 GoGrid 的技术布道者。

我想通过@Giedrius 和@Yoav 解决上面的一些问题。如果您的体验低于预期，我很抱歉。我们已经并将继续对我们的产品功能和服务进行重大改进和升级。话虽如此，我想回答你上面列出的几点，具体来说：

1)**图像**- 请注意 HD 大小（持久存储）与 RAM 分配有关。我们最低 RAM 分配 (512 MB) 的基本映像现在是 30 GB。此外，由于某些用户在 Windows 服务器上的 RAM 分配不足时遇到了一些性能问题，因此我们为大多数 Windows 实例设置了 1 GB 或更高的最小分配。此外，我们所有的 Windows 2008 实例现在都有 SP2：wiki.gogrid.com/wiki/index.php/Server_Images#Windows_2008_Server

2)**支持**- 我们一直致力于使我们的支持团队和流程变得更好。请记住，有几个公共云会收取支持费用，这是我们不做的。是的，它是 24/7/365 可用的，您说得对，在工作时间通常有更多的支持人员可用（这是许多公司的常态）。我们全天候 24 小时为您提供帮助。此外，每个 GoGrid 帐户都有一个专门的服务团队，该团队由我们组织的各种人员组成（帐户管理、技术支持、计费等）

3) **SLA** - 我们提供市场上最强大的 SLA 之一。此外，云存储实际上已包含在我们的 SLA 第六节中：www.gogrid.com/legal/sla.php。

4)**反应时间**——我不相信我们曾在 SLA 中声明任何问题都会在 2 小时内“解决”。我怀疑任何托管服务提供商都可以提供这种服务，仅仅是因为托管的性质和其中的复杂性。我们将根据票证的性质在 2 小时或 30 分钟内确认并回复票证（如 SLA 中所述）。很抱歉，如果不清楚，请告诉我在哪里可以更好地解释。

5)**互联网速度**——我们的数据中心有多个带宽提供商。延迟、抖动或传输速度慢的情况并不典型。如果遇到速度不是您期望的情况，我鼓励您打开支持票，以便我们进行调查。

6) **I/O** - 最近我们被独立的第 3 方 CloudHarmony.com 标为拥有云提供商中最好的 I/O：http: [//blog.cloudharmony.com/2010/06/disk-io-基准测试-in-cloud.html](http://blog.cloudharmony.com/2010/06/disk-io-benchmarking-in-cloud.html)

7)**网络连接**- 见上面的#5

8)**负载平衡器**- 如果您遇到平衡问题，我们鼓励您报告它。可以在 wiki 上找到我们的 LB 的详细信息：wiki.gogrid.com/wiki/index.php/(F5)_Load_Balancer

9)**门户**——我们继续对门户网站进行优化，包括最近为拥有更大环境的客户推出了“列表视图”。如果门户“行为不端”，我建议您清除缓存并使用最新的浏览器版本（我个人经常在门户上使用 Chrome 和 Firefox，但没有问题）。或者，您可以使用 API 来管理您的 GoGrid 基础架构。

10)**转移计划**- 几个月前，我们发布了一些新的 RAM 和转移计划。如果您有 0.50 美元/GB 而不是 0.29 美元，您似乎仍在使用旧的传输计划。未经客户许可，我们不会自动更改客户的计划。因此，我建议您升级您的计划以享受新的定价。

希望这有助于回答问题/疑虑。我并不是说它是推销员（因为我不是推销员），但我想确保其他读者也有“故事的另一面”。

如果您有任何问题，请联系我：michael[at]gogrid.com

谢谢！-迈克尔

# c# - C# 自定义列表视图

> ID：188248
> 
> 赞同：4
> 
> 时间：2008-10-09T17:12:02.907
> 
> 标签：c#, listview

有没有人有任何关于创建/绘制自定义 ListView 对象的信息？

目前我正在处理一个需要在应用程序中自定义外观的项目。我使用的是标准的 (Windows.Forms) ListView，它与 GUI 的其余部分的风格不同。我们没有使用自定义控件的工具箱，所有控件都是内部“蒙皮”的，因为它是通过覆盖每个控件的 hte OnPaint() 方法。

我正在寻找的是： - 有关如何处理滚动条绘制的信息。- 如何使用自定义绘图例程来处理列标题。- 如何仍然处理显示的数据并正确绘制。

任何和所有的帮助都会受到极大的欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T20:43:32.073

子类`ListBox`。在 ctor 中，将绘制模式设置为`OwnerDrawVariable`and override `OnDrawItem`and `OnMeasureItem`。我喜欢有一个特殊的 Item 类，它允许用户为该项目指定任何自定义绘图以及`object`将作为数据的哪一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T19:30:20.647

据我所知，您需要实际进行一些 Win32 调用，`NM_CUSTOMDRAW`以实际更改控件的绘制行为。[这是](https://web.archive.org/web/20061221082010/http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic34342.aspx)我找到的一篇文章。你将不得不做更多的挖掘工作。

# c# - 如何使用 Castle ActiveRecord 执行存储过程？

> ID：188250
> 
> 赞同：8
> 
> 时间：2008-10-09T17:12:08.537
> 
> 标签：c#, .net, stored-procedures, castle-activerecord

我相信网上某处有关于这个话题的讨论，但我丢失了网址，我无法通过谷歌搜索找到它。

我现在可能会尝试的是：

```
ISessionFactoryHolder factoryHolder = ActiveRecordMediator<EntityClass>.GetSessionFactoryHolder();
ISession session = factoryHolder.CreateSession(typeof(EntityClass));
try
{
    IDbCommand cmd = session.Connection.CreateCommand();
    cmd.CommandText = "spName";
    cmd.ExecuteNonQuery();
}
catch(Exception ex)
{

}
finally
{
    factoryHolder.ReleaseSession(session);
} 
```

但是，我不太确定这是否是正确的方法，或者是否存在更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-22T14:43:15.790

这对我有用（带有参数和动态结果表的存储过程）：

```
// get Connection
System.Data.IDbConnection con = ActiveRecordMediator.GetSessionFactoryHolder()
                                                    .GetSessionFactory(typeof(Autocomplete))
                                                    .ConnectionProvider.GetConnection();

// set Command
System.Data.IDbCommand cmd = con.CreateCommand();
cmd.CommandText = "name_of_stored_procedure";
cmd.CommandType = System.Data.CommandType.StoredProcedure;

// set Parameter of Stored Procedure
System.Data.SqlClient.SqlParameter param = new System.Data.SqlClient.SqlParameter("@parameter_name", System.Data.SqlDbType.NVarChar);
param.Value = "value_of_parameter";
((System.Data.SqlClient.SqlParameterCollection)cmd.Parameters).Add(param);

// call Stored Procedure (without getting result)
cmd.ExecuteNonQuery();

// ... or read results
System.Data.SqlClient.SqlDataReader r = (System.Data.SqlClientSqlDataReader)cmd.ExecuteReader();
while(r.Read()) {
    System.Console.WriteLine("result first col: " + r.GetString(0));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T05:35:40.893

我在 ActiveRecord 代码中实现存储过程时使用的博客是 Rodj 的这篇文章（[http://blog.rodj.org/archive/2008/05/23/activerecord-nhibernate-and-sql-stored-procedures.aspx](http://blog.rodj.org/archive/2008/05/23/activerecord-nhibernate-and-sql-stored-procedures.aspx)） . 使用他的帖子和评论，我能够做到这一点。我还没有决定这是否是最好的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T12:22:32.863

您还可以通过以下方式获得 IDbConnection：

```
ActiveRecordMediator.GetSessionFactoryHolder()
    .GetSessionFactory(typeof(ActiveRecordBase))
    .ConnectionProvider.GetConnection(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-21T20:24:04.430

对于 ActiveRecord 版本 1，这有效：

```
IDbConnection connection = ActiveRecordMediator.GetSessionFactoryHolder()
                          .GetSessionFactory(typeof(ActiveRecordBase))
                          .OpenSession().Connection; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-29T13:22:36.170

```
public ArrayList DevolverCamposDeObjetoSTP(T Objeto, List<Consulta> Consultas, string StoredProcedureName)
    {
        ArrayList results;
        try
        {
            var queryString = @"EXEC " + StoredProcedureName;
            foreach (var consulta in Consultas)
            {
                switch (consulta.tipoCampo)
                {
                    case Consulta.TipoCampo.dato:
                        queryString = queryString + " " + consulta.Campo + " = " + "'" + consulta.Valor + "'";
                        break;
                    case Consulta.TipoCampo.numero:
                        queryString = queryString + " " + consulta.Campo + " = " + consulta.Valor;
                        break;
                }   
                queryString = queryString + ",";
            }
            queryString = queryString.Remove(queryString.Count() - 1, 1);
            var query = new HqlBasedQuery(typeof(T),QueryLanguage.Sql, queryString);
            results = (ArrayList)ActiveRecordMediator.ExecuteQuery(query);
        }
        catch (Exception exception)
        {
            throw new Exception(exception.Message);
        }
        return results;
    }
public class Consulta
{
    public enum TipoCampo
    {
        dato,
        numero
    }
    public string Campo { get; set; }
    public TipoCampo tipoCampo { get; set; }
    public string Valor { get; set; }
    public string Indicador { get; set; }
}
public void _Pruebastp()
    {
        var p = new Recurso().DevolverCamposDeObjetoSTP(
                                                         new Recurso(),
                                                         new List<Consulta> { new Consulta { Campo = "@nombre", tipoCampo = Consulta.TipoCampo.dato, Valor = "chr" }, new Consulta { Campo = "@perfil", tipoCampo = Consulta.TipoCampo.numero, Valor = "1" } },
                                                         "Ejemplo");
    } 
```

# asp.net - ASP.NET Web 开发：将一个目录映射到另一个目录？

> ID：188258
> 
> 赞同：0
> 
> 时间：2008-10-09T17:15:30.963
> 
> 标签：asp.net, iis

我们正在考虑重命名我们的 Web 目录架构，以使其更加用户友好。但是，我们需要对旧目录结构的任何 URL 请求转发到新目录结构。所以....

如何转发所有这些请求：

[http://mydomain.com/OLDdirname/](http://mydomain.com/OLDdirname/)

[http://mydomain.com/OLDdirname/samesubdir/](http://mydomain.com/OLDdirname/samesubdir/)

[http://mydomain.com/OLDdirname/samesubdir/samescript.aspx](http://mydomain.com/OLDdirname/samesubdir/samescript.aspx)

分别对其中的每一个：

[http://mydomain.com/NEWdirname/](http://mydomain.com/NEWdirname/)

[http://mydomain.com/NEWdirname/samesubdir/](http://mydomain.com/NEWdirname/samesubdir/)

[http://mydomain.com/NEWdirname/samesubdir/samescript.aspx](http://mydomain.com/NEWdirname/samesubdir/samescript.aspx)

就问题而言，有什么建议，也许还有一些一般性指导？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T17:23:40.963

你可以使用很多东西来做这样的事情。基本上，您正在执行 URL 重写。这些产品之一应该可以帮助您完成工作：

*   [ISAPI 重写](http://www.isapirewrite.com/)
*   [IIS 重写](http://www.qwerksoft.com/products/iisrewrite/)
*   [网址](http://www.opcode.co.uk/components/rewrite.asp)
*   [IIRF](http://cheeso.members.winisp.net/IIRF.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T17:39:57.513

我在我的许多网站上都使用了 IIRF，它一直都能正常工作而不会失败。您使用正则表达式来定义规则，其余的由它来处理。使用 IIRF 设置一些重定向非常容易。

[http://cheeso.members.winisp.net/IIRF.aspx](http://cheeso.members.winisp.net/IIRF.aspx)

# algorithm - 如何验证 SSL 证书？

> ID：188266
> 
> 赞同：265
> 
> 时间：2008-10-09T17:16:29.793
> 
> 标签：algorithm, security, ssl, certificate

安全验证 ssl 证书所需的一系列步骤是什么？我（非常有限）的理解是，当您访问 https 站点时，服务器会向客户端（浏览器）发送证书，浏览器从该证书中获取证书的颁发者信息，然后使用该信息联系颁发者，并以某种方式进行比较有效性证书。

*   这究竟是如何完成的？
*   该过程如何使其免受中间人攻击？
*   是什么阻止了一些随机的人设置自己的验证服务以用于中间人攻击，所以一切“看起来”都是安全的？

* * *

## 回答 #1

> 赞同：357
> 
> 时间：2008-10-09T17:28:36.913

这是一个非常简化的解释：

1.  您的 Web 浏览器会下载 Web 服务器的证书，其中包含 Web 服务器的公钥。此证书使用受信任的证书颁发机构的私钥签名。

2.  您的 Web 浏览器随附所有主要证书颁发机构的公钥。它使用此公钥来验证 Web 服务器的证书是否确实由受信任的证书颁发机构签名。

3.  证书包含 Web 服务器的域名和/或 IP 地址。您的 Web 浏览器与证书颁发机构确认证书中列出的地址是它与之建立连接的地址。

4.  您的 Web 浏览器会生成一个共享对称密钥，该密钥将用于加密此连接上的 HTTP 流量；这比对所有内容使用公钥/私钥加密要有效得多。您的浏览器使用 Web 服务器的公钥加密对称密钥，然后将其发回，从而确保只有 Web 服务器可以解密它，因为只有 Web 服务器拥有它的私钥。

请注意，证书颁发机构 (CA) 对于防止中间人攻击至关重要。但是，即使是未签名的证书也会阻止某人被动地监听您的加密流量，因为他们无法访问您的共享对称密钥。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-02-05T02:16:53.953

值得注意的是，除了购买证书（如上所述）之外，您还可以免费创建自己的证书；这被称为“自签名证书”。自签名证书和购买的证书之间的区别很简单：购买的证书已由您的浏览器已经知道的证书颁发机构签名。换句话说，您的浏览器可以轻松验证所购买证书的真实性。

不幸的是，这导致了一个普遍的误解，即自签名证书本质上不如 GoDaddy 和 Verisign 等商业 CA 出售的证书安全，并且如果您使用它们，您必须忍受浏览器警告/异常；**这是不正确的**。

*如果您安全地分发自签名证书（或 CA 证书，如 bobince 建议的那样）并将其安装在将使用您的站点的浏览器中，则*它与购买的证书一样安全，并且不易受中间人攻击攻击和证书伪造。显然，这意味着只有少数人需要安全访问您的站点（例如，内部应用程序、个人博客等）才可行。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2016-05-30T16:06:06.837

你之前这么说

> 浏览器从该证书中获取证书的颁发者信息，然后使用该信息联系颁发者，并以某种方式比较证书的有效性。

客户不必与发行人核实，因为有两件事：

1.  所有浏览器都预装了所有主要 CA 公钥的列表
2.  证书已签名，并且该签名本身足以证明证书有效，因为客户端可以自行确保该证书是真实的，而无需联系颁发者的服务器。这就是非对称加密的美妙之处。

请注意，2\. 没有 1 就无法完成。

这在我前段时间制作的这张[大图中得到了更好的解释](https://imgur.com/gallery/5T2fJsG/)

（跳到底部的“什么是签名？”）

![斑点](https://i.imgur.com/F4Zzecf.png)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2020-07-19T09:47:16.417

## 我知道下面的内容很长，但很详细，但足够简单。仔细阅读，我保证你会开始发现这个话题并不那么复杂。

首先，任何人都可以创建 2 个密钥。一个用于加密数据，另一个用于解密数据。前者可以是私钥，后者可以是公钥，以及 VICERZA。

其次，简单来说，证书颁发机构 (CA) 提供为您创建证书的服务。如何？他们使用某些值（CA 的发行者名称、您的服务器的公钥、公司名称、域等），并使用他们的 SUPER DUPER ULTRA SECURE SECRET 私钥并加密此数据。此加密数据的结果是签名。

所以现在 CA 给你一个证书。证书基本上是一个文件，其中包含前面提到的值（CA 的颁发者名称、公司名称、域、服务器的公钥等），包括签名（即后者值的加密版本）。

现在，说了这么多，这里有一个非常**重要**的部分要记住：您的设备/操作系统（Windows、Android 等）几乎保留了所有主要/受信任 CA 及其**公钥**的列表（如果您正在考虑这些公钥用于解密证书中的签名，**你是对的！**）。

好的，如果您阅读了上面的内容，这个顺序示例现在将变得轻而易举：

1.  Example-Company 要求 Example-CA 为他们创建证书。
2.  Example-CA 使用他们的超级私钥签署此证书并将证书提供给 Example-Company。
3.  明天，internet-user-Bob 使用 Chrome/Firefox/etc。浏览到[https://example-company.com](https://example-company.com)。大多数（如果不是全部）现在的浏览器都希望从服务器返回证书。
4.  浏览器从 example-company.com 获取证书。证书说它是由 Example-CA 颁发的。碰巧 Bob 的操作系统已经在其受信任的 CA 列表中包含了 Example-CA，因此浏览器获取了 Example-CA 的公钥。请记住：这一切都发生在 Bob 的计算机/手机/等中，而不是通过网络。
5.  所以现在浏览器解密证书中的签名。最后，浏览器将解密的值与证书本身的内容进行比较。**如果内容匹配，则表示签名有效！**

为什么？想想看，只有这个公钥才能解密签名，使内容看起来像私钥加密之前的内容。

## 中间人攻击怎么样？

这是创建上述标准的主要原因之一（如果不是主要原因）。

假设黑客简拦截了互联网用户鲍勃的请求，并用她自己的证书进行了回复。但是，hacker-Jane 仍然非常小心地在证书中声明颁发者是 Example-CA。最后，黑客简记得她必须在证书上包含一个签名。但是 Jane 使用什么密钥来签署（即创建证书主要内容的加密值）证书？？？？？？

因此，即使黑客 Jane 使用她自己的密钥签署了证书，您也可以看到接下来会发生什么。浏览器会说：“好的，这个证书是由 Example-CA 颁发的，让我们用 Example-CA 的公钥解密签名”。解密后，浏览器发现证书内容完全不匹配。因此，浏览器会向用户发出非常明确的警告，并表示它不信任该连接。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-09T17:24:35.627

客户端具有 SSL 证书颁发机构的公钥的预种子存储。必须有一个信任链，从服务器的证书到中间机构，再到所谓的“根”证书之一，才能使服务器受到信任。

您可以检查和/或更改受信任机构的列表。通常，您这样做是为了为您知道自己信任的地方当局添加证书 - 例如您工作的公司或您就读的学校或其他什么不。

预播种列表可能因您使用的客户端而异。大型 SSL 证书供应商确保他们的根证书存在于所有主要浏览器中 ($$$)。

除非攻击者拥有可信根证书的私钥，否则中间人攻击是“不可能的”。由于相应的证书被广泛部署，这种私钥的暴露通常会对电子商务的安全产生严重影响。因此，这些私钥受到非常非常严密的保护。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-06-22T19:27:16.883

如果你更注重技术，这个网站可能是你想要的：[http ://www.zytrax.com/tech/survival/ssl.html](http://www.zytrax.com/tech/survival/ssl.html)

警告：兔子洞很深:)。

# c# - 你认为最好的 C# 注释结构是什么？特别是使用 Visual Studio

> ID：188269
> 
> 赞同：-1
> 
> 时间：2008-10-09T17:17:30.117
> 
> 标签：c#, visual-studio, comments

多年来，当我完成学业并在该行业工作时，我经常向人们征求有关评论的建议。可悲的是，众所周知，与许多开发人员发表评论只是一种旁注，而不是其他东西。话虽如此，我通常会得到一个相当笼统的答案。确实，随着时间的推移，这对了解真正有帮助的东西并没有多大帮助。

那么，您认为使用 Visual Studio 构建 C# 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T17:29:47.050

至少，我会使用[三斜杠 XML 注释块](http://www.winnershtriangle.com/w/Articles.XMLCommentsInCSharp.asp)来注释您的公共 API 的所有部分。如果时机成熟，这将使自动生成文档变得容易。

除此之外，我会评论任何在六个月内将难以破译的特定算法或代码片段。这种“自私”的评论方法（即假设您以后必须维护此代码）通常会在不过度杀伤的情况下实现充足文档的最佳平衡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T17:50:15.060

在撰写评论时，我尝试遵循一些基本准则。

*   注释应该很简单
*   评论应提供清晰
*   在编写实现之前编写文档
*   记录你**为什么**做某事，而不是**你**在做什么。
*   对接口、方法、属性和类使用内置（XML 样式）注释。
*   在每个文件（例如，Something.cs）的顶部提供一个摘要，包括文件名、描述、开发历史和版权信息
*   为错误修复添加注释（如果合适，带有错误编号）
*   使用有用的注释，例如 //TODO //BUG 和 //BUGFIX
*   不要注释掉代码，除非你打算使用它
*   在它们适用的代码行上方添加注释，而不是在行尾
*   尝试将评论限制在一行
*   使用 // 而不是 /* */ 用于多行注释
*   要清楚——不要使用“foo”、“bar”等。
*   在适当的情况下遵循大小写规则（即，camelCasing 和 PascalCasing）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T17:20:17.210

“很多而且经常”——比尔博，霍比特人。

更严重的是，评论不明显的东西，并告诉读者代码的目标是什么，也许你选择它的原因。

这不会因语言而改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T18:17:39.920

对于更复杂的部分，我个人使用三斜杠、SandCastle XML 注释和内联注释的组合。经常评论，但要保持简洁，没有人需要阅读大量的绒毛，然后才能弄清楚某些东西的作用:-)

# computer-science - 在线计算机科学文章存储库？

> ID：188276
> 
> 赞同：16
> 
> 时间：2008-10-09T17:20:10.800
> 
> 标签：computer-science

当我需要一些复杂的算法时，我首先检查互联网上是否已经发布了任何相关内容。10 次中有 10 次我会发现有人已经想出了一个比我想象的更聪明的解决方案。

除了通用的谷歌搜索，我使用：

*   **[Citeseer](http://citeseerx.ist.psu.edu/)** 有很多来自大学的优秀理论报告
*   **[Dobb 博士的门户网站](http://www.ddj.com)**比 Citeseer 更实用，但通常过于针对特定技术或语言
*   **[Arxiv](http://arxiv.org/)**更理论上包含草稿和预印本（以防万一我绝望:)）

我还发现**[J.UCS](http://www.jucs.org/)**（通用计算机科学杂志）包含一些有趣的文章（但我并没有真正使用我在那里找到的任何信息）。

你知道还有什么地方可以免费搜索和阅读好的 CS 文章吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T17:28:40.157

如果您在 ACM 上发现付费墙后面的内容，您通常可以在作者的网站之一或 Citeseer 缓存中免费找到它。此外，很多 CS 文章都是由 Springer 发布的，并且可能只出现在[他们的网站上](http://springerlink.com/computer-science/)（在付费墙后面）。

[如果您想查看特定作者或会议， DBLP](http://www.informatik.uni-trier.de/~ley/db/)很有用。不过，他们与论文的链接是“官方”付费版本。

顺便说一句，ACM 的个人会员费[并不太繁重](http://www.acm.org/membership/dues)，您有权访问他们的图书馆。IIRC，他们还为会员提供团体健康保险，如果您是个体经营者，这可能会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T19:11:33.493

谷歌的[CS 课程搜索](http://code.google.com/edu/curriculumsearch/)可能很有用。这是仅限于大学计算机科学系的谷歌网络搜索。它将结果分为“讲座”、“作业”和“参考”。

还有[Scholarpedia](http://www.scholarpedia.org/)，它类似于 Wikipedia，但有标准。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T17:21:55.990

我检查了[http://mathworld.wolfram.com](http://mathworld.wolfram.com)的数学知识。

如果您是 ACM 的正式成员，文章 [通常] 是免费的：这很容易让您（或您的雇主）付出的会员费用值得。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T17:22:27.910

谷歌学术。

除此之外，我不确定。大多数教授都会在他们的大学主页上的某个地方有他们文章的 PDF，因此您可以查找做过研究的人并在那里获得一些文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T17:31:52.617

您通常可以在大学图书馆（现场）查阅期刊和会议记录的纸质（有时是电子）副本。

您也可以找到特定领域的资源。例如，在计算机视觉方面，有很多知识在[http://homepages.inf.ed.ac.uk/rbf/CVonline/](http://homepages.inf.ed.ac.uk/rbf/CVonline/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-25T08:02:06.690

我正在使用一个很好的搜索引擎：[http](http://www.readbook.ir) ://www.readbook.ir它可以帮助您分别查找 ISI、IEEE 和 ACM 以及...论文。尝试一下

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T20:31:19.200

有一些很棒的数学库，您只需支付适当的费用，就可以将*整个*库以可执行的形式移植到您的平台上。NAG - 数值算法组，是迄今为止最著名的，但还有其他的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T18:51:07.683

Microsoft Research 可能也有一些有趣的文章。[微软研究院](http://research.microsoft.com/)

# delphi - Delphi TThread.CurrentThread 和 EAccessViolation - 这是一个错误还是我的无能..？

> ID：188281
> 
> 赞同：11
> 
> 时间：2008-10-09T17:20:59.363
> 
> 标签：delphi, delphi-2009, tthread

在 Delphi 2009 中，我发现每当我在应用程序中使用 TThread.CurrentThread 时，应用程序关闭时都会收到如下错误消息：

```
Exception EAccessViolation in module ntdll.dll at 0003DBBA.
Access violation at address 7799DBBA in module 'ntdll.dll'.  Write of
address 00000014. 
```

除非它只是我的机器，否则您可以在几秒钟内复制它：创建一个新的 Delphi Forms 应用程序，向表单添加一个按钮，并为按钮的事件处理程序使用如下内容：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  TThread.CurrentThread;
end; 
```

在我的 Vista 机器和 XP 机器上，我发现如果我*不*点击按钮一切都很好，但如果我*点击*按钮，当我关闭应用程序时会收到上述错误消息。

所以......我想知道这是否是一个错误，但同时我认为我很可能只是不了解关于你应该如何在 Delphi 中使用 TThreads 的一些非常基本的东西。恐怕我有点像德尔福新手。

像这样使用 TThread.CurrentThread 有什么明显的问题吗？

如果没有，并且你有 Delphi 2009，如果你实现我的简单示例项目，你会遇到同样的问题吗？

* * *

## **更新：正如弗朗索瓦在下面指出的，这实际上是 Delphi 2009 中的一个错误 - 你可以[在这里投票](http://qc.codegear.com/wc/qcmain.aspx?d=67726)。**

* * *

## **更新：此错误已在 Delphi 2010 中修复。**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-09T18:07:34.633

不幸的是，这似乎是一个与类单元中终结部分的调用顺序相关的错误：

`DoneThreadSynchronization`清除`ThreadLock`结构，然后
`FreeExternalThreads`想要销毁刚刚在调用时创建的 Thread 对象`CurrentThread`，
这需要 ThreadLock 在对 in 的调用中已经
`EnterCriticalSection(ThreadLock)`初始化`TThread.RemoveQueuedEvents`...

**更新**：[**QC 报告**](http://qc.codegear.com/wc/qcmain.aspx?d=67726)中
现在有一个**解决方法补丁**。[](http://qc.codegear.com/wc/qcmain.aspx?d=67726)

 *** * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-10T15:58:09.673

在 CodeGear 发布修复程序之前，您可以使用下面的补丁。将它保存到一个独立的单元中，并在程序中的任何地方使用它。我也会尝试将其添加到 QC 中。

此版本适用于 D2009（原始）、更新 1 和更新 2。

```
{ Fix Delphi 2009's invalid finalization order in Classes.pas.
  Written by Primoz Gabrijelcic, http://gp.17slon.com.
  No rights reserved - released to public domain.
}
unit FixD2009Classes;

interface

implementation

uses
  Windows,
  SysUtils,
  Classes;

type
  TCode = array [0..109] of byte;

{$WARN SYMBOL_PLATFORM OFF}

procedure PatchClasses;
{$IFDEF ConditionalExpressions}
{$IF RTLVersion = 20}
var
  i         : integer;
  oldProtect: cardinal;
  pCode     : ^TCode;
  tmp       : DWORD;
const
  COffsets_Call: array [1..12] of integer = (0, 15, 24, 34, 49, 59, 69, 79, 89, 94, 99, 109);
  COffset_UnRegisterModuleClasses = 106;
  COffset_DoneThreadSynchronization = 94;
  COffset_FreeExternalThreads = 99;
  CCallDelta = COffset_FreeExternalThreads - COffset_DoneThreadSynchronization;
{$IFEND}
{$ENDIF}
begin
{$IFDEF ConditionalExpressions}
{$IF RTLVersion = 20}
  pCode := pointer(cardinal(@TStreamReader.ReadToEnd) + COffset_UnRegisterModuleClasses);
  Win32Check(VirtualProtect(pCode, COffsets_Call[High(COffsets_Call)], PAGE_READWRITE, oldProtect));
  try
    for i := Low(COffsets_Call) to High(COffsets_Call) do
      if pCode^[COffsets_Call[i]] <> $E8 then
        raise Exception.Create('Unexpected version of Classes - cannot patch');
    tmp := PDword(@pCode^[COffset_DoneThreadSynchronization+1])^;
    PDword(@pCode^[COffset_DoneThreadSynchronization+1])^ :=
      PDword(@pCode^[COffset_FreeExternalThreads+1])^ + CCallDelta;
    PDword(@pCode^[COffset_FreeExternalThreads+1])^ := tmp - CCallDelta;
  finally VirtualProtect(pCode, COffsets_Call[High(COffsets_Call)], oldProtect, oldProtect); end;
{$IFEND}
{$ENDIF}
end;

initialization
  PatchClasses;
end. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-11T16:04:28.943

Delphi 2009 Update 3 的补丁单元。

```
{ Fix Delphi 2009's invalid finalization order in Classes.pas.
  Written by Primoz Gabrijelcic, http://gp.17slon.com.
  No rights reserved - released to public domain.

  D2009 update 3 only.
}
unit FixD2009Classes;

interface

implementation

uses
  Windows,
  SysUtils,
  Classes;

type
  TCode = array [0..144] of byte;

{$WARN SYMBOL_PLATFORM OFF}

procedure PatchClasses;
{$IFDEF ConditionalExpressions}
{$IF RTLVersion = 20}
var
  i         : integer;
  oldProtect: cardinal;
  pCode     : ^TCode;
  tmp       : DWORD;
const
  COffsets_Call: array [1..12] of integer = (0, 15, 24, 42, 47, 58, 73, 91, 101, 111, 134, 139);
  COffset_UnRegisterModuleClasses = 107;
  COffset_DoneThreadSynchronization = 134;
  COffset_FreeExternalThreads = 139;
  CCallDelta = COffset_FreeExternalThreads - COffset_DoneThreadSynchronization;
{$IFEND}
{$ENDIF}
begin
{$IFDEF ConditionalExpressions}
{$IF RTLVersion = 20}
  pCode := pointer(cardinal(@TStreamReader.ReadToEnd) + COffset_UnRegisterModuleClasses);
  Win32Check(VirtualProtect(pCode, COffsets_Call[High(COffsets_Call)], PAGE_READWRITE, oldProtect));
  try
    for i := Low(COffsets_Call) to High(COffsets_Call) do
      if pCode^[COffsets_Call[i]] <> $E8 then
        raise Exception.Create('Unexpected version of Classes - cannot patch');
    tmp := PDword(@pCode^[COffset_DoneThreadSynchronization+1])^;
    PDword(@pCode^[COffset_DoneThreadSynchronization+1])^ :=
      PDword(@pCode^[COffset_FreeExternalThreads+1])^ + CCallDelta;
    PDword(@pCode^[COffset_FreeExternalThreads+1])^ := tmp - CCallDelta;
  finally VirtualProtect(pCode, COffsets_Call[High(COffsets_Call)], oldProtect, oldProtect); end;
{$IFEND}
{$ENDIF}
end;

initialization
  PatchClasses;
end. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T17:59:56.290

我认为 CurrentThread 是在 2009 年（或 2007 年）添加的。我家有2006。但是你确定它是一个类属性吗？

# c# - 将 C++ 结构数组编组为 C#

> ID：188299
> 
> 赞同：28
> 
> 时间：2008-10-09T17:27:02.937
> 
> 标签：c#, c++, interop, struct, marshalling

我在 C++ 中有以下结构：

```
#define MAXCHARS 15

typedef struct 
{
    char data[MAXCHARS];
    int prob[MAXCHARS];
} LPRData; 
```

以及我正在调用/调用的函数以获取其中 3 个结构的数组：

```
void GetData(LPRData *data); 
```

在 C++ 中，我会做这样的事情：

```
LPRData *Results;
Results = (LPRData *)malloc(MAXRESULTS*sizeof(LPRData));
GetData( Results ); 
```

它会工作得很好，但在 C# 中我似乎无法让它工作。我创建了一个这样的 C# 结构：

```
public struct LPRData
{

    /// char[15]
    [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 15)]
    public string data;

    /// int[15]
    [MarshalAsAttribute(UnmanagedType.ByValArray, SizeConst = 15)]
    public int[] prob;
} 
```

如果我初始化其中 3 个数组（以及它们的所有子数组）并将其传递给它：

```
GetData(LPRData[] data); 
```

它返回成功，但 LPRData 数组中的数据没有改变。

我什至尝试创建一个大小为 3 个 LPRData 的原始字节数组，并将其传递给这样的函数原型：

获取数据（字节 [] 数据）；

但在这种情况下，我将从第一个 LPRData 结构中获取“数据”字符串，但之后没有任何内容，包括来自同一 LPRData 的“prob”数组。

关于如何正确处理这个问题的任何想法？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-09T17:54:03.180

我会尝试为您的结构装饰添加一些属性

```
[StructLayout(LayoutKind.Sequential, Size=TotalBytesInStruct),Serializable]
public struct LPRData
{
/// char[15]
[MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 15)]
public string data;

/// int[15]
[MarshalAsAttribute(UnmanagedType.ByValArray, SizeConst = 15)]
public int[] prob;
} 
```

*注意 TotalBytesInStruct 不代表变量

JaredPar 也是正确的，使用 IntPtr 类可能会有所帮助，但是自从我使用 PInvoke 以来已经有一段时间了，所以我生疏了。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-09T17:50:38.740

处理指针时的一个技巧是只使用 IntPtr。然后，您可以在指针上使用 Marshal.PtrToStructure 并根据结构的大小递增以获得结果。

```
static extern void GetData([Out] out IntPtr ptr);

LPRData[] GetData()
{
    IntPtr value;
    LPRData[] array = new LPRData[3];
    GetData(out value);
    for (int i = 0; i < array.Length; i++)
    {
        array[i] = Marshal.PtrToStructure(value, typeof(LPRData));
        value += Marshal.SizeOf(typeof(LPRData));
    }
    return array;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-08T07:20:29.230

[在这个问题](https://stackoverflow.com/questions/9188523/marshaling-c-structures-in-c-sharp)上讨论了一个类似的主题，其中一个结论是`CharSet`命名参数必须设置为`CharSet.Ansi`。否则，我们将创建一个`wchar_t`数组而不是`char`数组。因此，正确的代码如下：

```
[Serializable]
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public struct LPRData
{
    [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 15)]
    public string data;

    [MarshalAsAttribute(UnmanagedType.ByValArray, SizeConst = 15)]
    public int[] prob;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T02:37:45.057

PInvoke 互操作助手可能会有所帮助。[http://clrinterop.codeplex.com/releases/view/14120](http://clrinterop.codeplex.com/releases/view/14120)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T21:42:40.797

[您是否使用OutAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.outattribute.aspx)标记了 GetData 参数？

> 将 InAttribute 和 OutAttribute 结合起来在应用于数组和格式化的非 blittable 类型时特别有用。只有当您同时应用这两个属性时，调用者才能看到被调用者对这些类型所做的更改。

# sql-server - 分析服务 - 主动缓存失败

> ID：188303
> 
> 赞同：2
> 
> 时间：2008-10-09T17:27:43.093
> 
> 标签：sql-server, caching, proactive

有一段时间，主动缓存过程成功同步了 OLAP 数据库，然后开始给出以下错误“OLAP 存储引擎中的错误：找不到属性键：”，然后是特定的数据相关信息。但是，如果我手动处理数据库并将“事务部署”选项设置为 True，我不会遇到问题。我已将数据源隔离模式设置为快照，并将连接字符串上的 MARS 连接设置设置为 True，并且在数据库端，我们已将数据库属性 ALLOW SNAPSHOT_ISOLATION 设置为 ON 并对其进行了验证。任何人都可以帮助或提供一些建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T23:31:02.530

正在重建您的度量，并且在您的维度表中找不到一个键值（这基本上是一个竞争条件）。

如果数据完整性至关重要，那么您将需要对多维数据集进行完整处理。

如果您可以暂时关闭某些聚合（或分配给维度中的“未知”），那么您可以自定义错误配置以忽略错误或将未知键分配给未知。下次重建措施时，它应该会自行解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T20:43:31.903

听起来好像添加了一个新的维度键 - 并由您的事实表使用。维度键尚未在多维数据集中，因此在事实引用时找不到它...

这很容易发生，并且只能通过完整的重新处理来解决（或者如果你幸运的话，对维度和事实进行主动缓存的好时机）。

# svn - 将 SVN 存储库复制到外部硬盘是否安全？

> ID：188306
> 
> 赞同：8
> 
> 时间：2008-10-09T17:28:13.873
> 
> 标签：svn, version-control, backup

现在，我的 SVN 存储库位于笔记本电脑的 HDD 上（尽管我将代码托管服务用于更“关键”的个人项目），我只是每周复制一次目录（最终将被脚本化，或者我可能会制作一个应用程序的地狱）。我是否有损坏我的 SVN 存储库的风险？到目前为止，我对原件或副本都没有任何问题，但这并不意味着我将来没有风险。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-09T17:32:20.150

考虑使用[热拷贝](http://svnbook.red-bean.com/en/1.2/svn.ref.svnadmin.c.hotcopy.html)：

> svnadmin hotcopy — 制作存储库的热副本...
> 
> 此子命令对存储库进行完整的“热”备份，包括所有挂钩、配置文件，当然还有数据库文件。如果您通过`--clean-logs`切换，`svnadmin`将对您的存储库执行热拷贝，然后从原始存储库中删除未使用的 Berkeley DB 日志。您可以随时运行此命令并制作存储库的安全副本，无论其他进程是否正在使用该存储库...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T17:30:33.010

AFAIK 它是安全的，但为什么不导出备份呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T17:42:06.403

您可能是安全的，但这只是因为您知道没有人在访问您笔记本电脑上的存储库。但是，svn (svnadmin) 提供了热复制和转储命令，它们与您的复制命令一样容易运行，并且它们是“保证安全的”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T17:34:53.797

您不应该冒着破坏主存储库的风险，只是做一个副本。但是，如果在复制时某些内容被锁定，则副本可能会损坏。

您可以使用诸如[SyncBackSE](http://www.2brightsparks.com/syncback/sbse.html)之类的应用程序，它可以安排备份并在锁定的情况下使用卷影副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T19:38:19.473

你写了：

> 现在，我的 SVN 存储库位于笔记本电脑的硬盘上，我只需每周复制一次目录

给你一个问题：为什么？

> 我是否有损坏我的 SVN 存储库的风险？

如果您的副本只是这样，则根本不是：副本。如果您的“副本”打开了一些*锁定*的文件以供写入，您可能会处于危险之中（您在评论中说它看起来像是在 Windows 下，并且可能发生在 Windows 上） - 如果有另一个进程试图将某些内容写入同时回购。

> 到目前为止，我对原件或副本都没有任何问题，但这并不意味着我将来没有风险。

真正的一点是：您是否出于备份目的进行复制？如果是这样，则副本可能没用（取决于还原过程的详细信息）。请参阅： [http ://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)

所以最后： **使用 svnadmin dump**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T19:42:21.587

我曾经使用闪存盘，只是在上面创建了一个基于文件的存储库。唯一的缺点（除了忘记它！）是闪存盘必须在每台 PC 上具有相同的驱动器号，而且速度感觉就像互联网连接速度很慢。

否则，它工作得很好。

# java - 将 Java 类公开为 SOAP WebService - 如何？

> ID：188310
> 
> 赞同：2
> 
> 时间：2008-10-09T17:28:54.370
> 
> 标签：java, web-services, soap

我正在寻找一个框架来将给定的 Java 类转换为 WebService（可能对方法参数等有一些限制）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T17:56:03.380

您可以使用[axis2](http://ws.apache.org/axis2/)或[xfi​​re](http://xfire.codehaus.org/)。我敢肯定还有其他方法，但这是我用过的两种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T17:50:43.653

事实上的标准是 Apache Axis：[http](http://ws.apache.org/axis/) ://ws.apache.org/axis/和[http://ws.apache.org/axis2/](http://ws.apache.org/axis2/)

# java - 一个单元应该如何测试 hashCode-equals 合约？

> ID：188311
> 
> 赞同：80
> 
> 时间：2008-10-09T17:29:04.290
> 
> 标签：java, unit-testing, oop

简而言之，hashCode合约，根据Java的object.hashCode()：

1.  除非影响 equals() 的东西发生变化，否则哈希码不应更改
2.  equals() 意味着哈希码是 ==

让我们假设主要对不可变数据对象感兴趣——它们的信息在构造后永远不会改变，因此假设 #1 成立。剩下的＃2：问题只是确认equals意味着哈希码==之一。

显然，我们无法测试所有可能的数据对象，除非该集合非常小。那么，编写可能捕获常见情况的单元测试的最佳方法是什么？

由于此类的实例是不可变的，因此构造此类对象的方法有限；如果可能，此单元测试应涵盖所有这些。在我的脑海中，入口点是子类的构造函数、反序列化和构造函数（这应该可以归结为构造函数调用问题）。

[我将尝试通过研究来回答我自己的问题。来自其他 StackOverflowers 的输入是此过程的一个受欢迎的安全机制。]

[这可能适用于其他 OO 语言，所以我添加了该标签。]

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-09-11T07:36:34.613

[EqualsVerifier](http://www.jqno.nl/equalsverifier/)是一个相对较新的开源项目，它在测试 equals 合约方面做得非常好。它没有来自 GSBase 的 EqualsTester的[问题。](https://stackoverflow.com/questions/188311#188681)我肯定会推荐它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-09T17:38:18.733

我的建议是考虑为什么/如何这可能不成立，然后编写一些针对这些情况的单元测试。

例如，假设您有一个自定义`Set`类。如果两个集合包含相同的元素，则它们是相等的，但是如果这些元素以不同的顺序存储，则两个相等集合的底层数据结构可能会有所不同。例如：

```
MySet s1 = new MySet( new String[]{"Hello", "World"} );
MySet s2 = new MySet( new String[]{"World", "Hello"} );
assertEquals(s1, s2);
assertTrue( s1.hashCode()==s2.hashCode() ); 
```

在这种情况下，集合中元素的顺序可能会影响它们的散列，具体取决于您实现的散列算法。所以这是我要写的那种测试，因为它测试了我知道某些散列算法可能为我定义为相等的两个对象产生不同结果的情况。

无论是什么，您都应该对自己的自定义类使用类似的标准。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-10T17:02:16.040

It's worth using the junit addons for this. Check out the class EqualsHashCodeTestCase [http://junit-addons.sourceforge.net/](http://junit-addons.sourceforge.net/) you can extend this and implement createInstance and createNotEqualInstance, this will check the equals and hashCode methods are correct.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T18:58:57.777

我会推荐 GSBase 的[EqualsTester](http://gsbase.sourceforge.net/apidocs/com/gargoylesoftware/base/testing/EqualsTester.html)。它基本上可以满足您的需求。我有两个（小）问题：

*   构造函数完成所有工作，我认为这不是好的做法。
*   当类 A 的实例等于类 A 的子类的实例时，它会失败。这不一定违反 equals 契约。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T22:56:56.223

[在撰写本文时，发布了其他三个答案。]

重申一下，我的问题的目的是找到标准的测试案例来证实这一点`hashCode`并`equals`相互同意。我解决这个问题的方法是想象程序员在编写所讨论的类时所采用的常见路径，即不可变数据。例如：

1.  *不写`equals()`就写`hashCode()`。*这通常意味着相等被定义为两个实例的字段相等。
2.  *不写`hashCode()`就写`equals()`。*这可能意味着程序员正在寻求一种更有效的散列算法。

在＃2的情况下，这个问题对我来说似乎不存在。没有创建额外的实例`equals()`，因此不需要额外的实例具有相同的哈希码。在最坏的情况下，哈希算法可能会为哈希映射产生较差的性能，这超出了这个问题的范围。

在 #1 的情况下，标准单元测试需要使用传递给构造函数的相同数据创建同一对象的两个实例，并验证相等的哈希码。假阳性怎么办？可以选择恰好在一个仍然不健全的算法上产生相同哈希码的构造函数参数。倾向于避免此类参数的单元测试将满足这个问题的精神。这里的捷径是检查源代码`equals()`，认真思考，并在此基础上编写一个测试，虽然在某些情况下这可能是必要的，但也可能有一些常见的测试来捕捉常见的问题——这样的测试也符合精神这个问题的。

例如，如果要测试的类（称为 Data）有一个接受 String 的构造函数，以及从 Strings 构造的实例，这些实例是`equals()`产生的实例`equals()`，那么一个好的测试可能会测试：

*   `new Data("foo")`
*   其他`new Data("foo")`

我们甚至可以检查 , 的哈希码`new Data(new String("foo"))`，以强制不保留字符串，尽管`Data.equals()`在我看来，这更有可能产生正确的哈希码而不是产生正确的结果。

Eli Courtwright 的回答是一个基于`equals`规范知识努力思考破坏哈希算法的方法的示例。一个特殊集合的例子是一个很好的例子，因为用户制作`Collection`的集合有时会出现，并且很容易在哈希算法中出现错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T18:53:17.523

这是我在测试中会有多个断言的唯一情况之一。由于您需要测试 equals 方法，因此您还应该同时检查 hashCode 方法。因此，在您的每个 equals 方法测试用例上，也要检查 hashCode 合同。

```
A one = new A(...);
A two = new A(...);
assertEquals("These should be equal", one, two);
int oneCode = one.hashCode();
assertEquals("HashCodes should be equal", oneCode, two.hashCode());
assertEquals("HashCode should not change", oneCode, one.hashCode()); 
```

当然，检查一个好的 hashCode 是另一个练习。老实说，我不会费心做双重检查以确保 hashCode 在同一次运行中没有改变，通过在代码审查中捕获它并帮助开发人员理解为什么这不是一个好方法来更好地处理这种问题编写 hashCode 方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-21T17:37:47.110

您还可以使用类似于[http://code.google.com/p/guava-libraries/source/browse/guava-testlib/src/com/google/common/testing/EqualsTester.java](http://code.google.com/p/guava-libraries/source/browse/guava-testlib/src/com/google/common/testing/EqualsTester.java)的东西 来测试 equals 和 hashCode。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-21T23:03:15.757

如果我有一个 class `Thing`，就像大多数其他人一样，我会编写一个 class `ThingTest`，其中包含该类的所有单元测试。每个`ThingTest`人都有方法

```
 public static void checkInvariants(final Thing thing) {
    ...
 } 
```

如果`Thing`该类覆盖 hashCode 并等于它有一个方法

```
 public static void checkInvariants(final Thing thing1, Thing thing2) {
    ObjectTest.checkInvariants(thing1, thing2);
    ... invariants that are specific to Thing
 } 
```

该方法负责检查旨在保持在任何一对对象之间的*所有不变量。*`Thing`它委托给的`ObjectTest`方法负责检查任何一对对象之间必须保持的所有不变量。作为所有对象的方法，该方法检查`equals`并且是一致的。`hashCode``hashCode``equals`

然后我有一些创建`Thing`对象对的测试方法，并将它们传递给成对`checkInvariants`方法。我使用等价分区来决定哪些对值得测试。我通常将每一对创建为仅在一个属性上有所不同，再加上一个测试两个等效对象的测试。

我有时也有一个 3 参数`checkInvariants`方法，虽然我发现它在 findinf 缺陷中不太有用，所以我不经常这样做

# asp.net - ASP.NET GridView CommandField 更新/取消不换行

> ID：188327
> 
> 赞同：1
> 
> 时间：2008-10-09T17:33:52.083
> 
> 标签：asp.net, gridview, hyperlink, commandfield

我的问题是关于 ASP.NET GridView 控件。我在 Columns 标记中使用 CommandField，如下所示。

```
<asp:CommandField ShowEditButton="True" HeaderStyle-Width="40px" UpdateText="Save" ButtonType="Link" HeaderStyle-Wrap="true" ItemStyle-Wrap="true" ItemStyle-Width="40px"/> 
```

如下图所示（单击编辑按钮后）。

[![替代文字](https://i.stack.imgur.com/BUGrY.jpg)](https://i.stack.imgur.com/BUGrY.jpg)

正如你所看到**的，我试图让取消链接显示一个新行，我的问题是你是怎么做的？**如果我将 更改`ButtonType="Link"`为`ButtonType="Button"`，我会正确渲染，如下所示。

[替代文字 http://i38.tinypic.com/2pqopxi.jpg](http://i38.tinypic.com/2pqopxi.jpg)

我已经尝试过谷歌，也许我没有在正确的标签上搜索，但我之前看不到这个标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T18:53:01.843

如果您使用模板字段，它将让您完全控制页面的外观，但它要求您使用 CommandName 和可能的 CommandArgument 属性，以及使用 GridView 的 OnRowCommand。

aspx 页面：

```
<asp:GridView id="gvGrid" runat="server" OnRowCommand="gvGrid_Command">
 <Columns>
  <asp:TemplateField>
   <ItemTemplate>
    Some Stuff random content
    <br />
    <asp:LinkButton id="lbDoIt" runat="server" CommandName="Cancel"  CommandArgument="SomeIdentifierIfNecessary" />
   </ItemTemplate>
  </asp:TemplateField>
 </Columns>
</asp:GridView> 
```

后面的代码：

```
protected void gvGrid_Command(object sender, GridViewCommandEventArgs e)
{
 if(e.CommandName=="Cancel")
 {
   // Do your cancel stuff here.
 } 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T17:37:18.143

不要使用命令字段，请使用[TemplateField](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.templatefield.aspx)并将命令按钮放在其中，并在它之前添加一个换行符 (br)，就像你想要的那样。

# c# - 从 ASP.NET Web 控件继承：“元素 不是已知元素”

> ID：188334
> 
> 赞同：5
> 
> 时间：2008-10-09T17:35:00.270
> 
> 标签：c#, asp.net, inheritance, user-controls

我正在尝试创建一个继承自 ASP.Net 的内置日历用户控件的自定义日历控件。

我的控件的代码隐藏文件如下所示：

```
public partial class WeeklyEventsCalendar : Calendar
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

并编译得很好。

但是，当我尝试将自定义控件放在 aspx 页面上时：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="testbed.aspx.cs" Inherits="testbed" %>
<%@ Register Src="UserControls/WeeklyEventsCalendar.ascx" TagName="WeeklyEventsCalendar"
    TagPrefix="mvs" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title>Untitled Page</title>
    <link href="~/css/VitalSignsStyleSheet.css" type="text/css" rel="stylesheet" />
</head>
<body>
    <div>
        <mvs:WeeklyEventsCalendar runat="server" />
    </div>
</body>
</html> 
```

我收到警告**“元素 WeeklyEventsCalendar 不是已知元素。如果网站中存在编译错误，或者 web.config 文件丢失，则可能会发生这种情况。**尝试

当我输入错误的文件位置时，我没有像过去那样收到任何类型的“找不到文件”错误。

当我尝试在浏览器中加载 aspx 页面时，出现错误 CS0115: **'ASP.usercontrols_weeklyeventscalendar_ascx.FrameworkInitialize()': no proper method found to override**

这更令人困惑，因为我的代码中没有任何地方尝试定义这样的函数。

这应该很简单。我哪里错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T17:52:03.217

我认为问题在于您试图从用户控件（基于您的 ASCX 扩展）继承日历控件（这是一个服务器控件）。你不能这样做。如果要从 Calendar 控件继承，则需要创建一个服务器控件。

如果您需要一些示例代码，请告诉我。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T18:04:23.563

Bryant hit on it. One thing you might consider if all you're doing is customizing the existing control is embedding an instance of the calendar on your user control and exposing the properties you need from it. This way your user control can handle all of the requisite customizations, and also provide only a limited interface back out to the consuming application. (This is composition instead of inheritance.)

If you really do need to fully derive from asp:Calendar, then you need to create a standard class which derives from the Calendar control, and then perform your customizations. You'll have no UI design for that, however -- everything you do will need to be custom code. (And if you need to change the HTML being emitted, you'll need to write those custom streams out as well -- which, with a calendar control, could be painful.)

# caching-application-block - 缓存应用程序块错误

> ID：188344
> 
> 赞同：1
> 
> 时间：2008-10-09T17:37:55.287
> 
> 标签：caching-application-block

有没有人见过这个错误？

创建缓存配置的配置节处理程序时出错：无法加载文件或程序集“Microsoft.Practices.EnterpriseLibrary.Caching，版本=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）（C:\WorkingDir\Projects\ReportCentral\ReportCentral\bin\Debug\ReportCentral.vshost.exe.config 第 5 行）

我正在使用 Ent Lib 4.0。我将 App Traget Framework 从 2.0 更改为 3.5。

编辑~

我在垃圾桶里有以下

Caching.dll Common.dll ObjectBuilder2.dll

编辑〜“解决方案”

这是交易，当引用 C:\EntLib4Src\bin 中的 dll 时，它们已签名并且只能由同一文件夹中的 EntLibConfig.exe 配置，而不是“开始>程序>Microsoft Patterns... >Ent 那不是很棘手吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T17:39:09.793

这意味着它无法找到该文件。因此，您需要将其放入 GAC 或 bin 文件夹中，以便加载程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-13T14:17:03.330

这是交易，当引用 C:\EntLib4Src\bin 中的 dll 时，它们已签名并且只能由同一文件夹中的 EntLibConfig.exe 配置，而不是“开始>程序>Microsoft Patterns... >Ent 那不是很棘手吗？

# language-agnostic - 你个人认同你的代码吗？

> ID：188346
> 
> 赞同：2
> 
> 时间：2008-10-09T17:38:24.787
> 
> 标签：language-agnostic

在 Stack Overflow 播客的最新一集（[第 25 集](https://blog.stackoverflow.com/2008/10/podcast-25/)）中，[Steve Yegge](http://steve-yegge.blogspot.com/)提到对你最喜欢的框架、语言、技术等产生情绪是多么糟糕。

您称自己为 <*在此处插入您的语言*> 开发人员吗？这是一件好事吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-09T17:43:44.683

我称自己为*软件*开发人员。我碰巧用一种语言工作比我知道的任何其他语言都多，但那是偶然的。如果必须的话，我可以用几种语言来谋生。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T18:23:02.653

我称自己为顾问、开发人员、教练和发明家。工具的选择取决于问题和客户。

对于一个自称为“菲利普斯”机械师而不是“平头”机械师的机械师，你会怎么看？从工具中获取您的身份不仅是自我限制，而且有点愚蠢。;-)

[对于那些可能不知道的人，菲利普斯和平头是螺丝刀的类型]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T17:42:25.373

我认为每个人都在一定程度上认同他们的代码。

至于称自己为“`<`在这里插入`>`开发者”，唯一的好词是“实用”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T17:42:59.567

我称自己为 C++ Windows 程序员，因为这是我目前所做的并且拥有最新的经验。我在日常工作中使用了很多其他工具，过去我曾使用过各种其他语言、平台和技术，但我通常称自己为我目前的专长。

我从来没有真正考虑过它是否有任何负面影响，但到目前为止似乎还不错。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T17:59:10.300

我被这个咬住了。不管技术如何，我认为工作交付物，最终的对象都应该被考虑。

我曾经非常坚持在企业中使用 Sharepoint，而事实是，在某些情况下，野兽不起作用。

我同意比尔所说的。

现在我相信，一个人应该投资并学习如何更好地实现，如何为常见问题找到好的设计模式，而不是必须识别一组语言和产品。我认为这永远不会过时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T17:50:46.337

是的。我叫它托比。

但说真的，我已经知道过分依赖我的代码，这只会造成麻烦。当我在过去三个晚上花费的那个功能从构建中删除时，我越“专业”，我就越能保持正视。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T19:41:24.680

代码越新，我就越喜欢它。特别是如果它特别优雅或解决了一个复杂的问题。如果它是对别人代码的修改，我就不会关心它了。随着年龄的增长（特别是如果其他人对此做过任何工作），我的依恋就会减弱。

我的一些旧代码 - 我只是感到抱歉，就像你对一只老狗的感觉一样，它总是闻起来像她湿了，偶尔在新地板上发生事故。糟糕的代码，它无能为力，它只是每天都在努力。这实际上是老年痴呆症。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T17:46:39.170

我想另一种看待这个问题的方式是“如果我需要更改我的开发语言，那将是一个简单的过渡吗？

我通常尝试将自己与我的代码分开，并（尝试）实践 XP 的整个团队和集体代码所有权实践，以帮助项目/产品发展成最大的潜力。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T17:53:16.613

不确定我是否喜欢只掌握一种语言的想法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T17:54:46.393

举一个极端的例子，假设您有三个孩子：Thomas、Meagan 和 Stephen。说你是一个 [insertLangHere] 程序员就像说你是一个有点像斯蒂芬的父亲。你爱你所有的孩子，而不仅仅是一个。

每种语言都有它的用途、美丽和丑陋的结构。我认为，如果您没有以某种方式附加到您的代码，那它怎么能好呢？我们不仅仅是工程师；在工程中，通常有一个正确的答案和许多错误的答案。我们是艺术家。有N种不同的方法来解决任何问题；有些比其他更好，但其中大部分是见仁见智的问题。个人的依恋和信念是必须的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T18:02:32.273

我尝试按照[无自我编程的十诫](http://www.codinghorror.com/blog/archives/000584.html)生活。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-09T18:09:50.027

好吧，我们都是程序员，我们的语言、平台、框架、工具包等只是我们构建软件的工具，但我们的逻辑是将我们的工具“粘合”在一起，帮助我们构建伟大的软件，就像一把锤子而施工人员，他会根据自己的需要来选择他的锤子，有时更大更重，有时更小，这取决于他的工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-09T18:14:49.113

我受制于我的代码，而不受制于我的工具或框架。

我为自己的代码感到非常自豪，并且当有人没有按照我喜欢的方式保持我的代码格式时会非常生气，但我对他们如何格式化自己的代码无动于衷。

将自己与别人的工作联系起来对我来说似乎是愚蠢的，因为它可能会朝着您不赞成的方向发展，但由于您将自己与它联系在一起，因此您被迫捍卫。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T02:11:33.223

我称自己为问题解决者。好吧，软件问题解决者。:-)

在[The Psychology of Computer Programming](https://rads.stackoverflow.com/amzn/click/com/0932633420)中，Gerald Weinberg 谈到了[无我的编程](http://en.wikipedia.org/wiki/Egoless_programming)。你不是你的代码。此外，语言、框架、库、实践等只是工具。作为软件开发人员，我们必须学习它们才能扩展我们的工具集并知道何时使用每个工具。

亲切的问候

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-10T02:21:02.190

我是一名计算机科学家、一名软件工程师和很多其他的东西。当我与人交谈时，我从不称自己为“Java 编码器”（或任何类型的编码器）：有太多人听到“编码器”或“程序员”并认为“哦，代码猴子。只要给他一根香蕉，他就会开心。给你，猴子！好香蕉！”

也就是说，Java 和相关技术已经支付了我很多年的抵押贷款。我绝对认同我的抵押贷款，因此，通过传递属性，我想我确实非常认同 Java。

只是不要称我为“编码器......”。

# c# - 使用 C#/Windows 窗体的简单动画

> ID：188349
> 
> 赞同：60
> 
> 时间：2008-10-09T17:39:11.463
> 
> 标签：c#, .net, winforms, animation

我需要在 C#/Windows 窗体中为万圣节显示制作一个快速动画。只是一些 2D 形状在纯色背景上移动。由于这只是一个快速的一次性项目，我***真的***不想为此安装和学习一套全新的工具。（DirectX 开发工具包、Silverlight、Flash 等。）我还必须在多台计算机上安装它，所以任何超出基本 .Net 框架（2.0）的东西都会让人头疼。

对于工具，我有 VS2k8，25 年的开发经验，独轮车，大屠杀斗篷，大约需要 2 天时间才能完成。自从在我的 Atari 130XE 上使用汇编程序后，我还没有做过动画（翻页和播放器/导弹图形万岁！）

建议？以下是我想知道的一些事情：

*   我可以通过摆弄它的 OnPaint 处理程序来绘制任何空的小部件（如面板），对吗？这就是我绘制自定义小部件的方式。还有比这更好的技术吗？
*   Windows 窗体中是否有针对此类事情的翻页技术？我不是在寻找高帧速率，而是尽可能少地闪烁/绘图。

谢谢。

**事后编辑......“几天后编码”**

好了，项目完成了。下面的链接派上了用场，尽管其中有几个是 404。（我希望 SO 允许将多个回复标记为“正确”）。我必须克服的最大问题是闪烁，以及当我尝试直接在表单上绘图时出现的持续错误。

*   对表单使用 OnPaint 事件：坏主意。我从来没有让它工作。许多神秘的错误（堆栈溢出或 ArgumentNullExceptions）。我最后使用了一个大小来填写表格的面板，效果很好。
*   无论如何，使用 OnPaint 方法很慢。我在网上的某个地方读到构建 PaintEventArgs 很慢，而且他们不是在开玩笑。当我放弃这个时，很多闪烁消失了。跳过 OnPaint/Invalidate() 并自己绘制。
*   在表单上设置所有“双缓冲”选项仍然会留下一些必须修复的闪烁。（而且我发现有冲突的文档说“将它们设置在控件上”和“将它们设置在表单上”。控件没有 .SetStyle() 方法。）没有它们我没有测试过，所以它们可能是做某事（`this`是形式）：

    ```
     this.SetStyle(ControlStyles.UserPaint, true);
        this.SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
        this.SetStyle(ControlStyles.AllPaintingInWmPaint, true); 
    ```

所以代码的主力看起来像（`pf`是面板控件）：

```
 void PaintPlayField()
    {
        Bitmap bufl = new Bitmap(pf.Width, pf.Height);
        using (Graphics g = Graphics.FromImage(bufl))
        {
            g.FillRectangle(Brushes.Black, new Rectangle(0, 0, pf.Width, pf.Height));
            DrawItems(g);
            DrawMoreItems(g);
            pf.CreateGraphics().DrawImageUnscaled(bufl, 0, 0);
        }
    } 
```

我刚刚从我的 Timer 循环内部调用了 PaintPlayField。完全没有闪烁。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-09T17:44:54.977

以所需的帧速率设置计时器。在每个计时器上，根据您想要实现的动画动作，旋转屏幕（您的模型）上形状的内部表示，然后调用`Invalidate(true)`. 在 OnPaint 中，只需在屏幕上绘制模型。

哦，是的，你可能想打开双缓冲（这就像自动翻页）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T18:18:34.660

[2d 游戏入门](https://channel9.msdn.com/coding4fun/articles/2D-Game-Primer-Visual-C)

[基于定时器的动画](http://www.java2s.com/Code/CSharp/2D-Graphics/Timerbasedanimation.htm)

这两个都给出了很好的动画例子。代码相当简单。当我需要为我的儿子做一个快速动画时，我使用了这些。

# .net - DataGridView 鼠标选择

> ID：188351
> 
> 赞同：4
> 
> 时间：2008-10-09T17:39:25.377
> 
> 标签：.net, winforms, datagridview

我在 Windows 窗体应用程序中使用 DataGridView 控件。当用户按住控件选择多个项目时，它可以正常工作。现在，当用户释放控制并单击（并按住鼠标左键）开始拖动操作时，选择会发生变化。当用户按住鼠标左键时，如何停止清除选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-12T03:58:02.760

[我在Microsoft 论坛](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3197591&SiteID=1)中找到了这个答案

“为了拖放多行，请将 DataGridView.MultiSelect 设置为 true，并在 DataGridView.DragDrop 事件中，删除并插入 DataGridView.SelectedRows 集合中的所有行。”

这篇[博文](http://windowsclient.net/blogs/faqs/archive/2006/07/10/how-do-i-perform-drag-and-drop-reorder-of-rows.aspx)还展示了如何在 DataGridView 上实现拖放

* * *

但在我看来，您将不得不从 DataGridView 继承并覆盖这些鼠标事件，因为否则总是会调用选择更改。

*   受保护的虚拟 void OnCellMouseDown(DataGridViewCellMouseEventArgs e);
*   受保护的虚拟 void OnCellMouseUp(DataGridViewCellMouseEventArgs e);

然后您可以拦截 OnMouseDown 中的 SelectionChanged 事件，并改为在 OnMouseUp 中进行选择。您必须保留向下位置点，以便在不是拖放的情况下选择正确的项目。

您还必须在鼠标按下事件中维护选定行的列表，如果它变成拖放事件，则拖动所有这些选定行并在鼠标上选择它们。

并且不要忘记在鼠标向上事件中清除所选行的列表/副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T00:32:09.773

好问题。尽管这可能不像您希望的那样简单，但它应该让您对如何解决您的问题有一些很好的了解：http: [//www.codeproject.com/KB/cpp/DataGridView_Drag- n-Drop.aspx](http://www.codeproject.com/KB/cpp/DataGridView_Drag-n-Drop.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T17:06:32.723

我发现了一种有效的技术。选择最后一个单元格（使用 ctrl 或 shift）后，您在释放鼠标按钮之前开始拖动，选择不会改变。然后在 drop 上，您可以使用以下方法获取选定单元格的列表：

```
 private SC.ArrayList selectedCells()
   {
      SC.ArrayList cellsList = new SC.ArrayList();
      Int32 selectedCellCount = dataViewImages.GetCellCount(DataGridViewElementStates.Selected);
      if (selectedCellCount > 0)
      {
         for (int i = 0;i < selectedCellCount; i++) {
            int cell = dataViewImages.SelectedCells[i].RowIndex*ShowImages.NumColumnsForWidth() + dataViewImages.SelectedCells[i].ColumnIndex;
            cellsList.Add(cell);
         }
         cellsList.Sort();
         return cellsList;
      }
      else
         return null;
   } 
```

# php - 在网站上创建各种语言包的最佳实践？PHP

> ID：188364
> 
> 赞同：1
> 
> 时间：2008-10-09T17:41:49.757
> 
> 标签：php, language-agnostic, language-packs

我之前为一个网站创建了一个语言包，但我不确定我正在做的是否是最好的方法。

基本上，我所拥有的只是一个包含定义字符串常量的变量的文件。通常是一组数组，其中一个数组通常指的是网站的特定元素。

然后站点代码仅包含基于标志的适当文件，然后回显适当的数组元素。

有哪些方法可以减少维护问题和性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T18:07:11.127

使用 PHP，您可以拥有的最佳选择是[GetText](http://be.php.net/manual/en/book.gettext.php)，但并非所有服务器都内置了它，因此如果您正在管理服务器，它可能是一个显示停止器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T18:31:02.903

我建议使用[Zend_Translate](http://framework.zend.com/manual/en/zend.translate.html)。它在某种程度上是人们留下的其他建议的组合，只是更易于维护和设计更好。

您可以根据自己的喜好切换适配器（支持 gettext、csv 和许多其他适配器），您不需要定义或全局变量来污染您的全局范围，并且有据可查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T17:52:01.203

几种最常见的方法是：

1）使用`define('SOME_STRING', 'Some string');`- 只需为每种语言填充一个不同的文件，其中包含这些定义。这很容易，您不必到处使用“全局”。

2）在函数中包装字符串：`translate('My String')`- 这更灵活，因为您可以解析代码以创建要翻译的字符串列表，并添加变量等功能，例如`translate('I can count to [number]', 10);`（当然，您通常选择较短的函数名称，例如“_ ")

# sql - 从计算中删除重复项的 SQL 表达式

> ID：188366
> 
> 赞同：0
> 
> 时间：2008-10-09T17:42:24.437
> 
> 标签：sql

我正在尝试运行一个会给出时间平均值的查询，但是当我这样做时......一些重复的记录在计算中。如何删除重复项？

前任。

第 1 栏 / 07-5794 / 07-5794 / 07-5766 / 07-8423 / 07-4259

第 2 栏 / 00:59:59 / 00:48:22 / 00:42:48/ 00:51:47 / 00:52:12

我可以获得第 2 列的平均值，但我不希望第 1 列中的相同值被计算两次（07-5794）？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T17:45:42.340

要获得每个 incnum 的最小值的平均值，您可以编写此 SQL

```
select avg(min_time) as avg_time from
    (select incnum, min(col2) as min_time from inc group by incnum) 
```

为您的 SQL 品牌使用正确的平均函数。

如果您在 Access 中执行此操作，则需要将其粘贴到 SQL 视图中；当您使用子查询时，您不能直接在设计视图中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T17:47:25.800

选择不同的（）

或者

通过...分组 （）

或者

选择唯一（）

...但通常平均值*包含*重复项。告诉我这不是针对财务软件的，我不会支持[再次滥用统计数据](http://scienceblogs.com/goodmath/2008/09/bad_probability_and_economic_d.php)！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T17:48:06.077

我相信您正在寻找 DISTINCT。

[http://www.sql-tutorial.com/sql-distinct-sql-tutorial](http://www.sql-tutorial.com/sql-distinct-sql-tutorial) && [http://www.w3schools.com/SQL/sql_distinct.asp](http://www.w3schools.com/SQL/sql_distinct.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T17:50:05.153

您想消除所有重复的条目吗？也就是说，计算中不应包含“07-5794”的行。如果是这样的话，我认为这会起作用（至少在 Oracle 中）：

```
SELECT AVG(col2)
  FROM (
    SELECT col1, MAX(col2) AS col2
      FROM table
      GROUP BY col1
      HAVING COUNT(*) = 1
  ) 
```

但是，如果要保留其中一个副本，则需要指定如何选择要保留的副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T18:04:27.090

阿纳斯塔西娅，

假设您计算了平均值和表中的唯一键，您可以执行以下操作来获取每个唯一 07-xxx 结果的最新发生时间：

```
select Column1, Avg(Convert(decimal,Column2)) 
from Table1
where TableId in
(
select Max(TableId)
from Table1
group by Column1
)
group by column1 
```

这是假设 MS SQL 中的以下表结构：

```
CREATE TABLE [dbo].[Table1] (
[TableId] [int] IDENTITY (1, 1) NOT NULL ,
[Column1] [varchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
[Column2] [int] NULL ) ON [PRIMARY] 
```

祝你好运！

# reporting-services - Reporting Services 2008 中的自定义错误页面

> ID：188373
> 
> 赞同：3
> 
> 时间：2008-10-09T17:43:49.737
> 
> 标签：reporting-services, error-handling

当您通过 /ReportServer/ 访问报告时，我想为所有 SSRS 默认错误页面（下图）重新命名（并发送错误电子邮件）。我已经在处理 ASP OnError 事件，并且*一些*默认的 SSRS 错误似乎捕获了它们自己的异常，然后呈现此页面在 OnError 事件被触发之前取消响应。

关于如何处理 SSRS 以标记所有错误页面的任何想法？

![报告服务错误](https://www.jazz2online.com/junk/reporting_error.gif)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T07:49:55.547

不幸的是，在使用 SSRS 的视觉方面时你不能。如果您直接通过 SOAP 和 Web 服务使用报告，则可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-21T01:40:58.170

我遇到了类似的问题，并提出了以下解决方案。如果 Microsoft 更改此特定方法，则很容易出现问题。下面的代码将被添加到页面的标题中，以确保它在加载 ReportViewer javascript 之后但在创建 RSClientController 的实例之前运行。

```
// This replaces a method in the ReportViewer javascript. If Microsoft updates 
// this particular method, it may cause problems, but that is unlikely to 
// happen.The purpose of this is to redirect the user to the error page when 
// an error occurs. The ReportViewer.ReportError event is not (always?) raised 
// for Remote Async reports
function OnReportFrameLoaded() {
    this.m_reportLoaded = true;
    this.ShowWaitFrame(false);

    if (this.IsAsync)
    {
        if(this.m_reportObject == null)
        {
            window.location = 
                '<%= HttpRuntime.AppDomainAppVirtualPath %>/Error.aspx';
        }
        else
        {
            this.m_reportObject.OnFrameVisible();
        }
    }
}
RSClientController.prototype.OnReportFrameLoaded = OnReportFrameLoaded; 
```

Microsoft ReportViewer 脚本文件（在 Microsoft.ReportViewer.WebForms、8.0.0.0、.Net Framework 3.5 SP1 内）的原始代码是：

```
function OnReportFrameLoaded()
{
    this.m_reportLoaded = true;
    this.ShowWaitFrame(false);

    if (this.IsAsync && this.m_reportObject != null)
        this.m_reportObject.OnFrameVisible();
}
RSClientController.prototype.OnReportFrameLoaded = OnReportFrameLoaded; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-20T16:25:45.320

我为 SSRS2005 和 2008 创建了这个解决方案。下面是 2008r2 版本

在 reportviewer.aspx 中，在前面添加`</form>`

```
<script type="text/javascript">
var rptDivString=document.getElementById('ReportViewerControl_ctl10_NonReportContent').innerHTML;
//alert( rptDivString );
var numPermError = rptDivString.search(/permissions/i);
if (numPermError>0)
{
var docTitle = document.title;
var reportName = docTitle.substr(0,docTitle.length-16);
alert('Reporting Services permissions error in report: ' +  reportName );
}
</script> 
```

# java - Eclipse 和 Netbeans 共存的情况如何？

> ID：188388
> 
> 赞同：14
> 
> 时间：2008-10-09T17:48:27.373
> 
> 标签：java, eclipse, netbeans, junit

我想在一个系统上同时安装 Eclipse 和 Netbeans（带有 JUnit），所以我对两者都比较熟悉。

除了 GUI 开发（请参阅“[同时使用 Eclipse 和 Netbeans](https://stackoverflow.com/questions/174308/using-both-eclipse-and-netbeans) ”）之外，在同一个系统甚至同一个项目上使用两个 IDE 是否还有其他问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-09T18:26:26.203

我们经常使用 Netbeans 和 Eclipse。我们在 Vista、WinXP 和 32 位和 64 位的多个版本的 Fedora 之间来回切换，没有任何问题。将项目文件保存在版本控制中会使它们保持同步变得更加容易。我们甚至还将启动文件保存在项目目录中。我发布了[另一个多个 IDE 问题](https://stackoverflow.com/questions/81567/how-do-you-handle-different-java-ides-and-svn)的答案，该问题描述了我们的项目目录是什么样的。

基本上，我同意蜥蜴比尔关于没有问题的观点，但不同意无缝性质和保持项目文件分开。我们唯一要做的就是确保在添加新库时更新每个项目中的构建类路径，因为 Netbeans 和 Eclipse 使用不同的文件来描述类路径。

使用 IDE 版本控制系统集成有助于鼓励让其他人的项目保持最新。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-09T19:25:16.350

在 NetBeans 和 Eclipse 中开发单个项目的一件事是使用[maven](http://maven.apache.org/)将依赖关系保持在一起。Maven 将生成包含所有类路径信息、构建路径等的 IDE 特定文件。

Maven 的学习曲线相当陡峭，但值得学习。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T17:51:03.623

将它们放在同一个系统上完全没有问题。但是，每个都有自己的项目特定文件，因此在同一个项目中使用它们并不是无缝的。如果您使用源代码控制并将（非源代码）项目文件分开，这会变得容易得多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T15:07:50.753

Netbeans 6.5 有一个改进的 Eclipse 项目导入，它应该将来自 Netbeans 的更改同步回 Eclipse：[http ://wiki.netbeans.org/NewAndNoteWorthyNB65#section-NewAndNoteWorthyNB65-EclipseProjectImportAndSynchronization](http://wiki.netbeans.org/NewAndNoteWorthyNB65#section-NewAndNoteWorthyNB65-EclipseProjectImportAndSynchronization)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T19:29:00.820

Maven 是保持两个 IDE 同步的好方法（如建议的那样）。不过，根据我的经验，为了开发人员不使用 IDE，您必须为任何给定项目创建 Ant 构建。由于 NetBeans 的构建系统是基于 Ant 的，因此将整个 NetBeans 项目建立在该基本构建系统之上是非常简单的。稍作调整`project.xml`可确保编辑器类路径与 Ant 构建类路径保持同步。

# xsd - 具有相同名称但不同子结构的元素的 XML 模式，具体取决于上下文

> ID：188389
> 
> 赞同：6
> 
> 时间：2008-10-09T17:48:30.133
> 
> 标签：xsd

我尝试为收到的 XML 文档定义模式。

文件看起来像：

```
<root>
    <items>
        <group name="G-1">
            <item name="I-1"/>
            <item name="I-2"/>
            <item name="I-3"/>
            <item name="I-4"/>
        </group>
    </items>
    <data>
        <group name="G-1" place="here">
            <customer name="C-1">
                <item name="I-1" count="3"/>
                <item name="I-2" count="4"/>
            </customer>
            <customer name="C-2">
                <item name="I-3" count="7"/>
            </customer>
        </group>
    </data>
</root> 
```

我尝试了 .NET 2.0 中的 XmlSpy 和 xsd.exe。两者都创建了允许以下`<group>`任意数量的`<item>`和`<customer>`元素的模式定义。但是我正在寻找的应该限制`<group>`在元素之下，并且限制`<items>`在元素之下。`<item>``<group>``<data>``<customer>`

这是 xml 模式根本没有能力的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-24T11:05:04.390

关键点（参见[XML Schema Runtime Polymorphism via xsi:type 和 Abstract Types](http://msdn.microsoft.com/en-us/library/aa468563.aspx#xmlschmachng_topic04)以获得完整和正确的上下文/放置/使用）是：

1.  创建一个带有 (abstract="true" 的基类型以防止它被直接使用)

    注意： ref 属性替换了其他地方定义的元素的 name 属性

    ```
    <xs:complexType name="CustomerType" abstract="true" > 
      <xs:sequence> 
        <xs:element ref="cust:FirstName" /> 
        <xs:element ref="cust:LastName" /> 
        <xs:element ref="cust:PhoneNumber" minOccurs="0"/> 
      </xs:sequence> 
      <xs:attribute name="customerID" type="xs:integer" /> 
    </xs:complexType> 
    ```

2.  通过扩展或限制基类型创建两个或多个派生类型

    ```
    <xs:complexType name="MandatoryPhoneCustomerType" > 
      <xs:complexContent> 
        <xs:restriction base="cust:CustomerType"> 
          <xs:sequence> 
            <xs:element ref="cust:FirstName" /> 
            <xs:element ref="cust:LastName" /> 
            <xs:element ref="cust:PhoneNumber" minOccurs="1" /> 
          </xs:sequence> 
        </xs:restriction> 
      </xs:complexContent> 
    </xs:complexType> 
    ```

    和

    ```
    <xs:complexType name="AddressableCustomerType" > 
      <xs:complexContent> 
        <xs:extension base="cust:CustomerType"> 
          <xs:sequence> 
            <xs:element ref="cust:Address" /> 
            <xs:element ref="cust:City" /> 
            <xs:element ref="cust:State" /> 
            <xs:element ref="cust:Zip" /> 
          </xs:sequence> 
        </xs:extension> 
      </xs:complexContent> 
    </xs:complexType> 
    ```

3.  引用元素中的基本类型

    ```
    <xs:element name="Customer" type="cust:CustomerType" /> 
    ```

4.  在您的实例 XML 文档中，将特定派生类型指定为 xsi:type 属性

    ```
    <cust:Customer customerID="12345" xsi:type="cust:MandatoryPhoneCustomerType" > 
      <cust:FirstName>Dare</cust:FirstName> 
      <cust:LastName>Obasanjo</cust:LastName> 
      <cust:PhoneNumber>425-555-1234</cust:PhoneNumber> 
    </cust:Customer> 
    ```

    或者：

    ```
    <cust:Customer customerID="67890" xsi:type="cust:AddressableCustomerType" > 
      <cust:FirstName>John</cust:FirstName> 
      <cust:LastName>Smith</cust:LastName> 
      <cust:Address>2001</cust:Address> 
      <cust:City>Redmond</cust:City> 
      <cust:State>WA</cust:State> 
      <cust:Zip>98052</cust:Zip> 
    </cust:Customer> 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:03:01.213

是的，XSD 可以处理这个问题。我从 Visual Studio 2008 生成了这个模式（比手动生成要快得多），它会做你想要的：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="root">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="items">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="group">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" name="item">
                      <xs:complexType>
                        <xs:attribute name="name" type="xs:string" use="required" />
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                  <xs:attribute name="name" type="xs:string" use="required" />
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="data">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="group">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element maxOccurs="unbounded" name="customer">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element maxOccurs="unbounded" name="item">
                            <xs:complexType>
                              <xs:attribute name="name" type="xs:string" use="required" />
                              <xs:attribute name="count" type="xs:unsignedByte" use="required" />
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                        <xs:attribute name="name" type="xs:string" use="optional" />
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                  <xs:attribute name="name" type="xs:string" use="required" />
                  <xs:attribute name="place" type="xs:string" use="required" />
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

# ajax - 如何将基于 Spring + Hibernate 的应用程序后端与基于纯 HTML 和 AJAX 的客户端连接？

> ID：188392
> 
> 赞同：2
> 
> 时间：2008-10-09T17:49:04.173
> 
> 标签：ajax, web-services, hibernate, spring

我想通过 AJAX 调用我的 DAO 的方法。我对此很陌生，所以我想问一下最好的方法是什么。是否可以将我的 bean 发布为 Web 服务并使用例如 jQuery 调用它们？我认为这是不可能的 :) 我也读过 Direct Web Remoting 但我不知道该走哪条路……

如我所见，这里有很多有经验的人，所以我想你可以给我指路..提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T05:05:02.343

与其直接公开 DAO bean，不如创建一些 Spring MVC 控制器 bean，并从客户端调用它们（使用 AJAX）。理想情况下，控制器不应该直接调用 DAO，而应该调用服务 bean（并且服务 bean 应该调用 DAO）。这种方法的一个优点是您可以将您的服务方法定义为事务性的，即，只要服务方法开始，事务就会启动，并且只要服务方法返回（无异常），事务就会提交。如果事务的边界是 DAO 方法，那么不可能在单个事务中包装多个数据库调用。

当然，没有理由需要使用 Spring MVC——任何 Web 框架都足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T16:10:12.017

您必须通过 http 公开您的 DAO 或 bean。通常，您在 DAO 层之上创建一个层以通过 HTTP 公开您的服务，这些服务可用于任何 AJAX 框架，例如 jQuery。jQuery 和其他框架最终做的是使用称为 XMLHttpRequest 的特殊异步请求，然后解析服务器响应（可以是任何东西，纯 HTML、JSON、XML 等）并处理它。

这是我发现的一个链接，显示了带有 AJAX 的 Spring 和 DWR：[Bram Smeets 博客](http://bram.jteam.nl/index.php/2007/01/31/spring-dwr-ajax-made-easy/)。

# c++ - 防止视图窃取焦点/将焦点设置到视图

> ID：188393
> 
> 赞同：0
> 
> 时间：2008-10-09T17:49:14.577
> 
> 标签：c++, windows, mfc

我有一个 MFC sdi 应用程序，它使用拆分器窗口在显示数据的主视图旁边包含一个树控件。

当用户在树中选择某些内容时，该视图会保持焦点，直到用户故意单击主数据窗口。这意味着与主视图关联的任何工具栏按钮都被禁用。

用户单击树控件后，有没有办法以编程方式将焦点切换回主视图？还是我使用 CSplitterWnd 和 2 个视图做一些根本错误的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T18:26:38.467

您不想在有人单击树后立即将焦点带回另一个视图：这会使您的应用程序无法使用。例如，它会阻止用户使用键盘在树中导航，因为树永远不会让焦点保持足够长的时间。

我真的希望工具栏不断反映您的第二个视图的状态（我不确定这是一个好主意），您有几个选择。做你的选择。2 想到：

1.  您的树视图不应该是`CView`. 使用简单的`CTreeCtrl`. 不是很好，因为它有点打破了文档/视图范式（例如`OnUpdate()`，每当调用 an 时就不再调用树`UpdateAllViews()`）。

2.  防止树成为活动视图。为此：

    2.a. 当您查看获得焦点 ( `OnSetFocus()`) 时：

    ```
    STATIC_DOWNCAST(CFrameWnd, AfxGetMainWnd())->SetActiveView(pTheOtherView); 
    ```

    2.b。从派生一个`CMySplitterWnd`类`CSplitterWnd`，然后覆盖`CMySplitterWnd::SetActivePane()`以防止将树视图设置为活动视图。

在所有情况下，欢迎来到 MFC 内部的精彩世界，深入研究源代码是每天的必修课；-)

# java - 如何添加 maven-jxr-plugin 将使用的额外源目录？

> ID：188400
> 
> 赞同：0
> 
> 时间：2008-10-09T17:51:47.210
> 
> 标签：java, maven-2, maven-plugin

我正在使用 build-helper-maven-plugin 将它添加到我的构建中，但我也想查看这个额外源目录的 XREF 源。

供参考：

[maven-jxr-plugin](http://maven.apache.org/plugins/maven-jxr-plugin/index.html) - JXR 插件生成项目源代码的交叉引用。生成的报告使用户更容易参考或查找特定的代码行。当与 PMD 插件一起使用以引用代码中发现的错误时，它也很方便。

[build-helper-maven-plugin](http://mojo.codehaus.org/build-helper-maven-plugin/index.html) - 这个插件包含各种小的独立目标，以协助 Maven 构建生命周期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-19T22:11:31.707

您可以按照 Ant 指南使用文件模式告诉 JXR 要索引哪些文件。例如，要将所有 java 文件包含在 src/main/java 中，并将所有源代码包含在 src/main/java2 中，文件中的以下配置应该有效：

```
<project>
  ...
  <reporting>
    <plugins>
      ...
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jxr-plugin</artifactId>
        <configuration>
          ...
          <includes>
            <include>src/main/java/**/*.java</include>
            <include>src/main/java2/**/*.java</include>
          <includes>
          ...
        </configuration>
      </plugin>
    </plugins>
  ...
  </reporting>
  ...
</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T21:46:02.567

我遇到的问题与 pom.xml 中插件的顺序有关。当我将 jxr 插件移到插件列表的顶部时，一切都开始工作了。

疯狂的事情。

# c# - 用于显示数据库项目的最佳控件是什么？

> ID：188408
> 
> 赞同：2
> 
> 时间：2008-10-09T17:54:38.203
> 
> 标签：c#, asp.net

我正在编写一个网站，该网站将出售我的一个课程中的物品。它将链接到一个 SQL Server 数据库，我将在其中提取价格、项目名称、数量和描述。如果我想以 thinkgeek 方式显示数据库中的项目，最好使用什么控件，以便我可以自定义显示以使其看起来正常？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T17:58:07.133

使用 asp:Repeater，您将获得最佳的灵活性。这意味着您将不得不进行更多编程，但它会给您更多的灵活性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:00:36.007

不确定您是否有任何技术要求，但 ASP.Net 有一种名为[Dynamic Data project](http://msdn.microsoft.com/en-us/library/cc488546.aspx)的新型 ASP.NET 项目。使用该项目，您可以指向您的 SQL Server 并生成页面来显示和编辑数据。使用它很容易快速启动和运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:04:45.607

我是 ASP.NET GridView 和 DataGrid 的粉丝，为您的图像和链接添加一些模板字段等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T18:04:53.143

@rslite 和 @Bryant 都有很好的建议。我最初解决这个问题可能涉及创建一个“Thinkeek-esque”用户控件，并将其放入中继器中进行显示。但是，DDP 也是一个不错的选择。真的取决于比你提到的更深层次的要求。

# php - PHP 的最佳 XML 解析器

> ID：188414
> 
> 赞同：149
> 
> 时间：2008-10-09T17:57:06.810
> 
> 标签：php, xml, parsing, xml-parsing

我以前使用过 XML Parser，尽管它工作正常，但我对它总体上并不满意，感觉就像我在为应该是基本功能的事情使用变通方法。

我最近看到了 SimpleXML，但我还没有尝试过。是不是更简单了？两者都有什么优点和缺点？您使用过任何其他解析器吗？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-10-09T18:06:53.497

我不得不说[SimpleXML](http://php.net/manual/simplexml.examples.php)很受欢迎，因为它首先是一个扩展，用 C 语言编写，而且速度非常快。但其次，解析后的文档采用 PHP 对象的形式。所以你可以像“查询”一样`$root->myElement`。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2010-09-01T07:59:28.530

查看 PHP 的[可用 XML 扩展](http://php.net/manual/en/book.xml.php)。

XML Parser 和 SimpleXML 之间的主要区别在于后者不是拉式解析器。SimpleXML 构建在 DOM 扩展之上，并将整个 XML 文件加载到内存中。像 XMLReader 这样的 XML Parser 只会将当前节点加载到内存中。您为特定节点定义处理程序，当 Parser 遇到它时将触发这些处理程序。这样更快并且节省内存。您为此付出了无法使用 XPath 的代价。

就我个人而言，我发现 SimpleXml 在它通过 DOM 提供的功能方面非常有限（因此很简单）。您可以轻松地在 DOM 和 SimpleXml 之间切换，但我通常不会打扰，直接走 DOM 路线。DOM 是 W3C DOM API 的实现，因此您可能从其他语言（例如 JavaScript）熟悉它。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2011-02-09T08:38:01.520

这是一个有用的功能，可以在扩展不可用时快速轻松地解析 xml：

```
<?php
/**
 * Convert XML to an Array
 *
 * @param string  $XML
 * @return array
 */
function XMLtoArray($XML)
{
    $xml_parser = xml_parser_create();
    xml_parse_into_struct($xml_parser, $XML, $vals);
    xml_parser_free($xml_parser);
    // wyznaczamy tablice z powtarzajacymi sie tagami na tym samym poziomie
    $_tmp='';
    foreach ($vals as $xml_elem) {
        $x_tag=$xml_elem['tag'];
        $x_level=$xml_elem['level'];
        $x_type=$xml_elem['type'];
        if ($x_level!=1 && $x_type == 'close') {
            if (isset($multi_key[$x_tag][$x_level]))
                $multi_key[$x_tag][$x_level]=1;
            else
                $multi_key[$x_tag][$x_level]=0;
        }
        if ($x_level!=1 && $x_type == 'complete') {
            if ($_tmp==$x_tag)
                $multi_key[$x_tag][$x_level]=1;
            $_tmp=$x_tag;
        }
    }
    // jedziemy po tablicy
    foreach ($vals as $xml_elem) {
        $x_tag=$xml_elem['tag'];
        $x_level=$xml_elem['level'];
        $x_type=$xml_elem['type'];
        if ($x_type == 'open')
            $level[$x_level] = $x_tag;
        $start_level = 1;
        $php_stmt = '$xml_array';
        if ($x_type=='close' && $x_level!=1)
            $multi_key[$x_tag][$x_level]++;
        while ($start_level < $x_level) {
            $php_stmt .= '[$level['.$start_level.']]';
            if (isset($multi_key[$level[$start_level]][$start_level]) && $multi_key[$level[$start_level]][$start_level])
                $php_stmt .= '['.($multi_key[$level[$start_level]][$start_level]-1).']';
            $start_level++;
        }
        $add='';
        if (isset($multi_key[$x_tag][$x_level]) && $multi_key[$x_tag][$x_level] && ($x_type=='open' || $x_type=='complete')) {
            if (!isset($multi_key2[$x_tag][$x_level]))
                $multi_key2[$x_tag][$x_level]=0;
            else
                $multi_key2[$x_tag][$x_level]++;
            $add='['.$multi_key2[$x_tag][$x_level].']';
        }
        if (isset($xml_elem['value']) && trim($xml_elem['value'])!='' && !array_key_exists('attributes', $xml_elem)) {
            if ($x_type == 'open')
                $php_stmt_main=$php_stmt.'[$x_type]'.$add.'[\'content\'] = $xml_elem[\'value\'];';
            else
                $php_stmt_main=$php_stmt.'[$x_tag]'.$add.' = $xml_elem[\'value\'];';
            eval($php_stmt_main);
        }
        if (array_key_exists('attributes', $xml_elem)) {
            if (isset($xml_elem['value'])) {
                $php_stmt_main=$php_stmt.'[$x_tag]'.$add.'[\'content\'] = $xml_elem[\'value\'];';
                eval($php_stmt_main);
            }
            foreach ($xml_elem['attributes'] as $key=>$value) {
                $php_stmt_att=$php_stmt.'[$x_tag]'.$add.'[$key] = $value;';
                eval($php_stmt_att);
            }
        }
    }
    return $xml_array;
}
?> 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-03-22T20:19:17.340

嗨，我认为 SimpleXml 非常有用。有了它，我正在使用[xpath](http://www.w3schools.com/xpath/)；

```
$xml = simplexml_load_file("som_xml.xml");

$blocks  = $xml->xpath('//block'); //gets all <block/> tags
$blocks2 = $xml->xpath('//layout/block'); //gets all <block/> which parent are   <layout/>  tags 
```

我使用了许多 xml 配置，这有助于我非常快速地解析它们。 `SimpleXml`写在上面，`C`所以速度非常快。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-10T07:34:04.880

这取决于您尝试对 XML 文件执行的操作。如果您只是想读取 XML 文件（如配置文件），The Wicked Flea 建议 SimpleXML 是正确的，因为它创建了相当于嵌套 ArrayObjects 的内容。例如，值可以通过 $xml->root->child 访问。

如果您正在寻找操作 XML 文件，您可能最好使用[DOM XML](http://php.net/domxml)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-11T16:01:51.410

crxml 解析器是一个真正易于解析的解析器。

这个类有一个搜索功能，它接受一个带有任何命名空间的节点名称作为参数。它在 xml 中搜索节点并打印出访问语句以使用此类访问该节点。这个类还使生成 xml 变得非常容易。

你可以下载这个课程

[http://freshmeat.net/projects/crxml](http://freshmeat.net/projects/crxml)

或来自 phpclasses.org

[http://www.phpclasses.org/package/6769-PHP-Manipulate-XML-documents-as-array.html](http://www.phpclasses.org/package/6769-PHP-Manipulate-XML-documents-as-array.html)

# python - 如何在已部署的 pylons 应用程序上运行包含的测试

> ID：188417
> 
> 赞同：0
> 
> 时间：2008-10-09T17:58:56.307
> 
> 标签：python, unit-testing, pylons, nose, paster

我已经从 egg 安装了基于 pylons 的应用程序，所以它位于 /usr/lib/python2.5/site-packages 下的某个位置。我看到测试也被打包了，我想运行它们（以发现在已部署的应用程序上出现但在开发版本上没有出现的问题）。

那么我该如何运行它们呢？从仅包含 test.ini 和 development.ini 的目录中执行“nosetests”会导致站点包下不​​存在 test.ini 的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T01:22:31.467

直接从[马嘴里说](http://wiki.pylonshq.com/display/pylonsdocs/Unit+Testing)：

安装鼻子：easy_install -W 鼻子。

跑鼻子：nosetests --with-pylons=test.ini 或 python setup.py nosetests

要运行“python setup.py nosetests”，您需要在 setup.cfg 中有一个 [nosetests] 块，如下所示：

> [鼻子测试]
> 
> 详细=真
> 
> 详细度=2
> 
> with-pylons=test.ini
> 
> 详细错误=1
> 
> with-doctest=真

# asp.net - ASP.NET 多语言网站？

> ID：188422
> 
> 赞同：6
> 
> 时间：2008-10-09T18:00:17.863
> 
> 标签：asp.net, .net-2.0, multilingual

如何将网站转换为能够处理多语言（例如：英语、法语、西班牙语）？

我不喜欢资源文件，因为我觉得有限，而且构建列表很长。你有什么建议吗？

## 更新

目前我们发现的最好方法是使用 XML 文件并使用一些 Xpath 和获取值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T19:18:00.390

隐式本地化（在 Visual Studio - 工具菜单 - 生成本地资源）非常简单。用您的默认语言编写您的页面，选择菜单选项，然后您的资源文件被创建并可以发送给某人进行翻译。

resx 文件只是 xml，因此如果翻译公司需要，您可以轻松地将其转换为（或转换为）电子表格。

使用数据库而不是 resx 作为后备存储并不困难。[Rick Strahl在这里](http://www.west-wind.com/presentations/wwDbResourceProvider/default.aspx)为数据库驱动的本地化提供程序提供了一个很好的解释和示例代码——还有一个很好的内置本地化编辑器，带有谷歌翻译和 Babelfish 的接口。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T18:14:11.330

我们将多语言网站的资源存储在数据库中。我们已经创建了几个工具来轻松创建和访问这些工具。有一个自定义的 ExpressionBuilder 允许我们使用这种语法：

```
 <asp:linkbutton runat='server' text='<%$ LanguageStrings:ClickMe%>' /> 
```

以及一个包含默认文本的自定义标签，如果还没有，则将一行添加到数据库中。

```
 <r:languagelabel runat="server" name="AboutUs">About Us</r:languagelabel> 
```

包含字符串的表每种语言都有一列。这使得用英语（或任何默认语言）创建网站变得非常容易，然后将表格（自行填充）交给翻译。也很容易看到你需要翻译什么语言。有了资源，每次需要添加新字符串的时候，都得停下手头的事情，然后去每种语言的资源文件，添加资源。

这是语言标签的代码：

```
''' <summary>
''' Retrieves a language-specific string.
''' </summary>
Public Class LanguageLabel
    Inherits Label

    Private _Name As String
    Public Property Name() As String
        Get
            Return _Name
        End Get
        Set(ByVal value As String)
            _Name = value
        End Set
    End Property

    Private Sub Populate()
        If Len(Me.Name) > 0 Then
            Dim LanguageString As String = GetLanguageString(Me.Name, Me.Text)
            If Len(LanguageString) > 0 Then Me.Text = LanguageString
        End If
    End Sub

    Private Sub LanguageLabel_PreRender(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreRender
        Populate()
    End Sub

    Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)
        ' By default a label wraps the text in a <span>, which we don't want in some situations
        writer.Write(Me.Text)
    End Sub

End Class 
```

和效用函数：

```
 Public Function GetLanguageString(ByVal Name As String, Optional ByVal DefaultText As String = "") As String
        Dim DefaultLanguage As Language = Languages.GetById(1)
        Name = StripPunctuation(Name).Trim.Replace(" ", "") ' Remove punctuation, spaces from name
        Dim SelectSql As String = String.Format("Select {0},{1} from LanguageStrings where Name=@Name", Languages.CurrentLanguage.Code, DefaultLanguage.Code)
        Dim LanguageStringTable As DataTable = ExecuteDataset(cs, CommandType.Text, SelectSql, New SqlParameter("@Name", Name)).Tables(0)
        If LanguageStringTable IsNot Nothing AndAlso LanguageStringTable.Rows.Count > 0 Then
            Dim LanguageText As String = LanguageStringTable.Rows(0)(Languages.CurrentLanguage.Code).ToString
            Dim DefaultLanguageText As String = LanguageStringTable.Rows(0)(DefaultLanguage.Code).ToString
            If Len(LanguageText) > 0 Then
                ' We have a string in this language
                Return LanguageText
            Else
                ' Nothing in this language - return default language value
                Return DefaultLanguageText
            End If
        Else
            ' No record with this name - create a dummy one
            If DefaultText = "" Then DefaultText = Name
            Dim InsertSql As String = String.Format("Insert into LanguageStrings (Name, {0}) values (@Name, @Text)", DefaultLanguage.Code)
            ExecuteNonQuery(cs, CommandType.Text, InsertSql, New SqlParameter("@Name", Name), New SqlParameter("@Text", DefaultText))
            Return Name
        End If
    End Function 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:04:13.113

资源文件是要走的路。我们以 12 种语言发布我们的产品。我们将所有字符串提取到资源文件中并将它们发送给翻译公司。有时这很痛苦，但这是事实上的方式。

当 4 个字母的英语单词被翻译成 17 个字母的短语并且你必须调整你的 UI 时，它也会变得有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T18:02:41.790

你在设计过程中有多晚？如果还不算太晚，而且如果预算允许，可以考虑移植到[Ektron CMS300.net](http://www.ektron.com)等多语言 CMS （具有内置翻译工具）。如果没有，那么你有一项艰巨的任务摆在你面前。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T18:04:44.220

我正在使用的另一个解决方案是创建包含 aspx 页面的语言文件夹，其中包含该特定语言的所有必需文本。

这里唯一的问题是如何将尽可能少的代码注入到那些复制页面中。我在这里使用控制器模式来执行此操作，然后使用对象数据源来获取数据并将其绑定到所有页面中的控件。

通过这种方式，我实现了摆脱资源文件的目标，并且可以将代码保留在一个地方而无需复制它（除非必要）。

编辑：我也会推荐一个好的 CMS 框架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T20:41:53.330

我开发的其中一个网络应用程序也有这个 NLS 要求。

我发现至少有 3 个位置有本地化文本：

*   用户界面
*   数据库表（“目录”或任何您想称呼它们的名称）
*   后端代码（服务等）

我的解决方案有一个表格用于页面、表格等（“容器”），一个表格用于该容器中的每个项目（例如标签、按 ID 的按钮、记录标识符），以及一个用于翻译项目的表格（加上语言标识符） .

翻译应用程序帮助我保持翻译的最新状态，并以 XML 格式导出所有翻译。

该产品附带翻译，但客户可以调整翻译，更改立即生效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-14T11:03:18.837

我使用资源文件添加 global.asax 完成的示例代码

```
 void Application_BeginRequest(Object sender, EventArgs e)
    {
        // Code that runs on application startup
        HttpCookie cookie = HttpContext.Current.Request.Cookies["CultureInfo"];
        if (cookie != null &amp;&amp; cookie.Value != null)
        {
            System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo(cookie.Value);
            System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(cookie.Value);
        }
        else
        {
            System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo("en");
            System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo("en");
        }
    } 
```

[http://satindersinght.blogspot.in/2012/06/create-website-for-multilanguage.html](http://satindersinght.blogspot.in/2012/06/create-website-for-multilanguage.html)

[http://satindersinght.wordpress.com/2012/06/14/create-website-for-multilanguage-support/](http://satindersinght.wordpress.com/2012/06/14/create-website-for-multilanguage-support/)

# algorithm - 是否有一个简单的算法可以确定 X 是否为素数？

> ID：188425
> 
> 赞同：29
> 
> 时间：2008-10-09T18:01:44.880
> 
> 标签：algorithm, primes

我一直在尝试通过 Project Euler 进行工作，并且注意到一些问题要求您确定素数作为其中的一部分。

1.  我知道我可以将 x 除以 2, 3, 4, 5, ..., X 的平方根，如果我得到平方根，我可以（安全地）假设这个数字是素数。不幸的是，这个解决方案似乎很笨拙。

2.  我已经研究过更好的算法来确定一个数字是否是素数，但很快就会感到困惑。

有没有一种简单的算法可以确定 X 是否为素数，并且不会让普通程序员感到困惑？

非常感谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-09T18:05:32.503

第一个算法非常好，在 Project Euler 中使用了很多。如果你知道你想要的最大数量，你也可以研究 Eratosthenes 的筛子。

如果您维护素数列表，您还可以改进第一个算法以仅与素数相除，直到数字的平方根。

使用这两种算法（除法和筛子），您应该能够解决问题。

**编辑**：固定名称，如评论中所述

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-11T02:13:19.680

生成小于[Eratosthenes 限制的](http://rosettacode.org/wiki/Sieve_of_Eratosthenes#Using_generator)所有素数（该页面包含 20 种编程语言的变体）是最古老和最简单的解决方案。

在 Python 中：

```
def iprimes_upto(limit):
    is_prime = [True] * limit
    for n in range(2, limit):
        if is_prime[n]:
           yield n
           for i in range(n*n, limit, n): # start at ``n`` squared
               is_prime[i] = False 
```

例子：

```
>>> list(iprimes_upto(15))
[2, 3, 5, 7, 11, 13] 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-09T20:17:56.917

我看到已经提出了 Fermat 的素性检验，但我一直在[研究计算机程序的结构和解释](http://mitpress.mit.edu/sicp/full-text/book/book.html)，他们还给出了[Miller-Rabin 检验](http://en.wikipedia.org/wiki/Miller-Rabin_test)（参见第 1.2.6 节，问题 1.28）作为另一种选择。我一直在成功地使用它来解决欧拉问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-09T18:25:47.670

这是您的方法的简单优化，它不是埃拉托色尼筛法，但很容易实现：首先尝试将 X 除以 2 和 3，然后循环 j=1..sqrt(X)/6，尝试除乘以 6*j-1 和 6*j+1。这会自动跳过所有可被 2 或 3 整除的数字，从而获得相当不错的常数因子加速。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-25T22:50:45.940

请记住以下事实（来自[MathsChallenge.net](http://mathschallenge.net/index.php?section=faq&ref=number/primes)）：

*   除 2 以外的所有素数都是奇数。
*   所有大于 3 的素数都可以写成 6k - 1 或 6k + 1 的形式。
*   您不需要检查 n 的平方根

这是我用于相对较小的 n 的 C++ 函数：

```
bool isPrime(unsigned long n)
{
    if (n == 1) return false; // 1 is not prime
    if (n < 4) return true; // 2 and 3 are both prime
    if ((n % 2) == 0) return false; // exclude even numbers
    if (n < 9) return true; //we have already excluded 4, 6, and 8.
    if ((n % 3) == 0) return false; // exclude remaining multiples of 3

    unsigned long r = floor( sqrt(n) );
    unsigned long f = 5;
    while (f <= r)
    {
        if ((n % f) == 0)  return false;
        if ((n % (f + 2)) == 0) return false;
        f = f + 6;
    }
    return true; // (in all other cases)
} 
```

您可能会想到自己的更多优化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-09T18:22:59.503

我推荐[费马的素数检验](http://en.wikipedia.org/wiki/Fermat_primality_test)。这是一个概率测试，但它经常是正确的。与筛子相比，它的速度非常快。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-01T04:36:16.360

对于相当小的数字，最多为 sqrt(x) 的 x%n 非常快速且易于编码。

简单的改进：

仅测试 2 和奇数。

测试 2、3 和 6 + 或 - 1 的倍数（除 2 或 3 之外的所有素数都是 6 +/- 1 的倍数，因此您基本上只是跳过所有偶数和所有 3 的倍数

仅测试素数（需要计算或存储直到 sqrt(x) 的所有素数）

您可以使用 sieve 方法快速生成所有素数的列表，直到某个任意限制，但它往往会占用大量内存。您可以使用 6 的倍数技巧将内存使用量减少到每个数字的 1/3 位。

我写了一个简单的素数类（C#），它使用两个位域来表示 6+1 的倍数和 6-1 的倍数，然后进行简单的查找......如果我正在测试的数字超出了筛子的范围，然后它依靠 2、3 和 6 +/- 1 的倍数进行测试。我发现，对于我迄今为止解决的大多数欧拉问题，生成一个大筛子实际上比动态计算素数需要更多时间。KISS原则再次来袭！

我编写了一个素数类，它使用筛子预先计算较小的素数，然后依靠 2、3 和 6 的倍数 +/- 1 来测试筛子范围之外的素数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T18:10:20.510

对于欧拉计划来说，拥有一个素数列表真的很重要。我建议维护一个用于每个问题的列表。

我想你要找的是[埃拉托色尼筛](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T18:27:43.470

你的权利是最慢的。您可以对其进行一些优化。

研究使用模数而不是平方根。跟踪你的素数。您只需要将 7 除以 2、3 和 5，因为 6 是 2 和 3 的倍数，而 4 是 2 的倍数。

Rslite 提到了[eranthenos 筛子](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)。这是相当直截了当的。我有它家的几种语言。如果您希望我稍后发布该代码，请添加评论。

* * *

这是我的 C++ 之一。它有很大的改进空间，但与动态语言版本相比，它的速度更快。

```
// Author: James J. Carman
// Project: Sieve of Eratosthenes
// Description: I take an array of 2 ... max values. Instead of removeing the non prime numbers,
// I mark them as 0, and ignoring them.
// More info: http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes
#include <iostream>

int main(void) {
        // using unsigned short.
        // maximum value is around 65000
        const unsigned short max = 50000;
        unsigned short x[max];
        for(unsigned short i = 0; i < max; i++)
                x[i] = i + 2;

        for(unsigned short outer = 0; outer < max; outer++) {
                if( x[outer] == 0)
                        continue;
                unsigned short item = x[outer];
                for(unsigned short multiplier = 2; (multiplier * item) < x[max - 1]; multiplier++) {
                        unsigned int searchvalue = item * multiplier;
                        unsigned int maxValue = max + 1;
                        for( unsigned short maxIndex = max - 1; maxIndex > 0; maxIndex--) {
                                if(x[maxIndex] != 0) {
                                        maxValue = x[maxIndex];
                                        break;
                                }
                        }
                        for(unsigned short searchindex = multiplier; searchindex < max; searchindex++) {
                                if( searchvalue > maxValue )
                                        break;
                                if( x[searchindex] == searchvalue ) {
                                        x[searchindex] = 0;
                                        break;
                                }
                        }
                }
        }
        for(unsigned short printindex = 0; printindex < max; printindex++) {
                if(x[printindex] != 0)
                        std::cout << x[printindex] << "\t";
        }
        return 0;
} 
```

我一找到 Perl 和 python 代码，我就会扔掉它。它们的风格相似，只是线条较少。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-11T01:56:39.217

这是 D（数字火星）中的简单素数测试：

```
/** 
 * to compile:
 * $ dmd -run prime_trial.d
 * to optimize:
 * $ dmd -O -inline -release prime_trial.d 
 */
module prime_trial;

import std.conv : to;  
import std.stdio : w = writeln;

/// Adapted from: http://www.devx.com/vb2themax/Tip/19051 
bool 
isprime(Integer)(in Integer number) 
{
  /* manually test 1, 2, 3 and multiples of 2 and 3 */
  if (number == 2 || number == 3)
    return true;
  else if (number < 2 || number % 2 == 0 || number % 3 == 0)
    return false;

  /* we can now avoid to consider multiples 
   * of 2 and 3\. This can be done really simply 
   * by starting at 5 and incrementing by 2 and 4 
   * alternatively, that is: 
   *    5, 7, 11, 13, 17, 19, 23, 25, 29, 31, 35, 37, ...    
   * we don't need to go higher than the square root of the number */
  for (Integer divisor = 5, increment = 2; divisor*divisor <= number; 
       divisor += increment, increment = 6 - increment) 
    if (number % divisor == 0)
      return false;

  return true;  // if we get here, the number is prime
}

/// print all prime numbers less then a given limit
void main(char[][] args) 
{
  const limit = (args.length == 2) ? to!(uint)(args[1]) : 100;
  for (uint i = 0; i < limit; ++i) 
    if (isprime(i))
      w(i);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-23T14:36:04.730

我也在解决 Project Euler 问题，实际上刚刚完成了#3（按 id），这是对合数的最高质因数的搜索（? 中的数字是 600851475143）。

我查看了所有关于素数的信息（这里已经提到过筛技术），以及关于 wikipedia 上的整数分解的信息，并提出了一个我决定要做的蛮力试验除法算法。

因此，当我在做欧拉问题来学习 ruby​​ 时，我正在研究我的算法并偶然发现了 mathn 库，它有一个[Prime 类](http://www.ruby-doc.org/stdlib/libdoc/mathn/rdoc/classes/Prime.html)和一个[带有 prime_division](http://www.ruby-doc.org/stdlib/libdoc/mathn/rdoc/classes/Integer.html#)方法的 Integer 类。多么酷啊。我能够通过这个红宝石片段得到问题的正确答案：

```
require "mathn.rb"
puts 600851475143.prime_division.last.first 
```

此代码段将正确答案输出到控制台。当然，在我偶然发现这个小美女之前，我最终做了很多阅读和学习，我只是想我会与大家分享...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-18T17:41:51.127

我喜欢这个 python 代码。

```
def primes(limit) :
    limit += 1
    x = range(limit)
    for i in xrange(2,limit) :
        if x[i] ==  i:
            x[i] = 1
            for j in xrange(i*i, limit, i) :
                x[j] = i
    return [j for j in xrange(2, limit) if x[j] == 1] 
```

它的一个变体可用于生成数字的因数。

```
def factors(limit) :
    limit += 1
    x = range(limit)
    for i in xrange(2,limit) :
        if x[i] == i:
            x[i] = 1
            for j in xrange(i*i, limit, i) :
                x[j] = i
    result = []
    y = limit-1
    while x[y] != 1 :
        divisor = x[y]
        result.append(divisor)
        y /= divisor
    result.append(y)
    return result 
```

当然，如果我分解一批数字，我不会重新计算缓存；我会做一次并在其中进行查找。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-05T10:40:04.717

没有优化，但它是一个非常简单的功能。

```
 function isprime(number){

    if (number == 1)
        return false;

    var times = 0;

    for (var i = 1; i <= number; i++){
        if(number % i == 0){
            times ++;
        }
    }
        if (times > 2){
            return false;
        }

    return true;
    } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-08-13T00:00:03.277

也许这个 Java 实现会有所帮助：

```
public class SieveOfEratosthenes {

    /**
     * Calling this method with argument 7 will return: true true false false true false true false
     * which must be interpreted as : 0 is NOT prime, 1 is NOT prime, 2 IS prime, 3 IS prime, 4 is NOT prime
     * 5 is prime, 6 is NOT prime, 7 is prime.
     * Caller may either revert the array for easier reading, count the number of primes or extract the prime values
     * by looping.
     * @param upTo Find prime numbers up to this value. Must be a positive integer.
     * @return a boolean array where index represents the integer value and value at index returns
     * if the number is NOT prime or not.
     */
    public static boolean[] isIndexNotPrime(int upTo) {
        if (upTo < 2) {
            return new boolean[0];
        }

        // 0-index array, upper limit must be upTo + 1
        final boolean[] isIndexNotPrime = new boolean[upTo + 1];

        isIndexNotPrime[0] = true; // 0 is not a prime number.
        isIndexNotPrime[1] = true; // 1 is not a prime number.

        // Find all non primes starting from 2 by finding 2 * 2, 2 * 3, 2 * 4 until 2 * multiplier > isIndexNotPrime.len
        // Find next by 3 * 3 (since 2 * 3 was found before), 3 * 4, 3 * 5 until 3 * multiplier > isIndexNotPrime.len
        // Move to 4, since isIndexNotPrime[4] is already True (not prime) no need to loop..
        // Move to 5, 5 * 5, (2 * 5 and 3 * 5 was already set to True..) until 5 * multiplier > isIndexNotPrime.len
        // Repeat process until i * i > isIndexNotPrime.len.
        // Assume we are looking up to 100\. Break once you reach 11 since 11 * 11 == 121 and we are not interested in
        // primes above 121..
        for (int i = 2; i < isIndexNotPrime.length; i++) {
            if (i * i >= isIndexNotPrime.length) {
                break;
            }
            if (isIndexNotPrime[i]) {
                continue;
            }
            int multiplier = i;
            while (i * multiplier < isIndexNotPrime.length) {
                isIndexNotPrime[i * multiplier] = true;
                multiplier++;
            }
        }

        return isIndexNotPrime;
    }

    public static void main(String[] args) {
        final boolean[] indexNotPrime = SieveOfEratosthenes.isIndexNotPrime(7);
        assert !indexNotPrime[2]; // Not (not prime)
        assert !indexNotPrime[3]; // Not (not prime)
        assert indexNotPrime[4]; // (not prime)
        assert !indexNotPrime[5]; // Not (not prime)
        assert indexNotPrime[6]; // (not prime)
        assert !indexNotPrime[7]; // Not (not prime)
    }
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-09T18:13:27.867

AKS 主要测试算法：

```
Input: Integer n > 1  

if (n is has the form ab with b > 1) then output COMPOSITE  

r := 2  
while (r < n) {  
    if (gcd(n,r) is not 1) then output COMPOSITE  
    if (r is prime greater than 2) then {  
        let q be the largest factor of r-1  
        if (q > 4sqrt(r)log n) and (n(r-1)/q is not 1 (mod r)) then break  
    }  
    r := r+1  
}  

for a = 1 to 2sqrt(r)log n {  
    if ( (x-a)n is not (xn-a) (mod xr-1,n) ) then output COMPOSITE  
}  

output PRIME; 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-02-25T21:55:25.017

python中的另一种方式是：

```
import math

def main():
    count = 1
    while True:
        isprime = True

        for x in range(2, int(math.sqrt(count) + 1)):
            if count % x == 0: 
                isprime = False
                break

        if isprime:
            print count

        count += 2

if __name__ == '__main__':
    main() 
```

# python - 在 Python 中读/写 MS Word 文件

> ID：188444
> 
> 赞同：19
> 
> 时间：2008-10-09T18:06:51.750
> 
> 标签：python, ms-word, read-write

是否可以在不使用 COM 对象的情况下在 Python 中读取和写入 Word（2003 和 2007）文件？
我知道我可以：

```
f = open('c:\file.doc', "w")
f.write(text)
f.close() 
```

但 Word 会将其读取为 HTML 文件而不是本机 .doc 文件。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-10-21T10:45:37.500

请参阅[python-docx](https://github.com/python-openxml/python-docx)，其官方文档可[在此处](https://python-docx.readthedocs.org/en/latest/)获得。

这对我来说效果很好。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-05-08T11:11:58.643

如果你只是看什么，[最简单](https://stackoverflow.com/questions/16516044/is-it-possible-to-read-word-files-doc-docx-in-python/30122239#30122239)的方法是使用 linux soffice 命令将其转换为文本，然后将文本加载到 python 中：

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-09T18:39:55.380

我会研究[IronPython](http://ironpython.net/)，它本质上可以访问 Windows/Office API，因为它在 .NET 运行时上运行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T18:36:25.123

doc（本例中为 Word 2003）和 docx（Word 2007）是不同的格式，后者通常只是 xml 和图像文件的存档。我想通过操作这些 xml 文件的内容来写入 docx 文件是很有可能的。但是，我看不出在没有某种类型的 COM 组件接口的情况下如何读取和写入 doc 文件。

# c++ - 有哪些技术可以限制 C++ 项目中的编译依赖关系？

> ID：188449
> 
> 赞同：6
> 
> 时间：2008-10-09T18:07:53.947
> 
> 标签：c++, dependencies

在 C++ 项目中，编译依赖性会使软件项目难以维护。限制模块内部和模块之间的依赖关系的一些最佳实践是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-09T18:09:49.343

*   [前向声明](http://en.wikipedia.org/wiki/Forward_declaration)
*   [抽象接口](http://en.wikipedia.org/wiki/Abstract_interface)
*   [Pimpl 成语](http://en.wikipedia.org/wiki/Opaque_pointer)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T19:17:32.793

*Herb Sutter 在他的优秀著作Exceptional C++* , ISBN: 0201615622的第 26、27 和 28 条“最小化编译时依赖，第 1、2 和 3 部分”中对这个确切的主题进行了很好的处理。

[替代文字 http://ak.buy.com/db_assets/prod_images/489/30611489.jpg](http://ak.buy.com/db_assets/prod_images/489/30611489.jpg)

恕我直言，这是最好的 C++ 编程书籍之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:17:26.753

我认为你需要非常小心和体谅这一点。通常，您可以通过分离代码和使用抽象接口（例如：函数指针或对象等价物）来限制依赖关系，但分离通常会增加脆弱性。例如，您可以通过通用抽象接口调用模块以减少对实际对象实现的依赖，但您必须与对象本身同步更新接口，否则代码将在运行时失败。

我会说在具有明确定义的层次结构的模块中构建大型项目很重要，但在每个模块中不要过度分解代码以限制依赖关系。如果您要改进维护，则必须在减少依赖关系和减少代码脆弱性之间取得平衡。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-11T00:48:17.950

也看看：

[大规模 C++ 软件设计（Addison-Wesley 专业计算系列）](https://rads.stackoverflow.com/amzn/click/com/0201633620)

# python - Django 管理界面内联放置

> ID：188451
> 
> 赞同：6
> 
> 时间：2008-10-09T18:08:53.913
> 
> 标签：python, django, django-admin

我希望能够在字段集中的两个不同字段之间放置内联。你已经可以用外键来做到这一点，我认为内联我想要的类并定义它以获得额外的形式会做到这一点，但显然我得到了一个：
“class x” has no ForeignKey to “class y”
错误。这不是 Django 1.0 支持的吗？如果是这样，如果没有预先存在的解决方案，我将如何解决问题？

在模型.py

```
class Place(models.Model):
    name = models.CharField(max_length=50)
    address = models.CharField(max_length=80)

class Owner(models.Model):
    name = models.CharField(max_length=100)
    place = models.ForeignKey(Place)
    background = models.TextField()
    license_expiration = models.DateTimeField('license expiration') 
```

在 admin.py

```
class PlaceInline(admin.TabularInline):  
    model = Place  
    extra = 5  

class OwnerAdmin(admin.ModelAdmin):  
    fieldsets = [  
        (None,    {'fields': ['background','place', 'license_expiration']}),  
    ]  
    inlines = [PlaceInline] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:36:56.920

在 Django 管理站点本身中似乎是不可能的（你根本不应该在“字段”中包含内联字段），但你可以使用 JS 将内联字段移动到任何你想要的地方。

# php - 用 PHP 读/写 MS Word 文件

> ID：188452
> 
> 赞同：32
> 
> 时间：2008-10-09T18:09:15.740
> 
> 标签：php, ms-word, read-write

是否可以在不使用 COM 对象的情况下在 PHP 中读取和写入 Word（2003 和 2007）文件？我知道我可以：

```
$file = fopen('c:\file.doc', 'w+');
fwrite($file, $text);
fclose(); 
```

但 Word 会将其读取为 HTML 文件而不是本机 .doc 文件。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-05T13:04:35.333

读取二进制 Word 文档将涉及根据已发布的 DOC 格式文件格式规范创建解析器。我认为这不是真正可行的解决方案。

您可以使用[Microsoft Office XML 格式](http://en.wikipedia.org/wiki/Microsoft_Office_XML_formats#Word_XML_Format_example)来读取和写入 Word 文件 - 这与 2003 和 2007 版本的 Word 兼容。为了阅读，您必须确保以正确的格式保存 Word 文档（在 Word 2007 中称为 Word 2003 XML-Document）。对于编写，您只需遵循公开可用的 XML 模式。我从未使用这种格式从 PHP 写出 Office 文档，但我使用它来读取 Excel 工作表（自然保存为 XML-Spreadsheet 2003）并在网页上显示其数据。由于这些文件显然是 XML 数据，因此在其中导航并弄清楚如何提取所需的数据是没有问题的。

另一个选项 - 仅 Word 2007 选项（如果您的 Word 2003 中未安装 OpenXML 文件格式） - 将求助于[OpenXML](http://en.wikipedia.org/wiki/Office_Open_XML)。正如[databyss在](https://stackoverflow.com/users/9094/databyss)[这里](https://stackoverflow.com/questions/188452/readingwriting-a-ms-word-file-in-php#191849)指出的那样，DOCX 文件格式只是一个包含 XML 文件的 ZIP 存档。[MSDN](http://msdn.microsoft.com/en-us/office/default.aspx)上有很多关于 OpenXML 文件格式的资源，因此您应该能够弄清楚如何读取所需的数据。我认为写作会复杂得多——这取决于你要投入多少时间。

**也许您可以看看[PHPExcel](http://www.codeplex.com/PHPExcel/)，它是一个能够使用 OpenXML 标准写入 Excel 2007 文件和读取 Excel 2007 文件的库。在尝试读写 OpenXML Word 文档时，您可以了解所涉及的工作。**

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-05T12:35:22.663

这适用于 vs < office 2007 及其纯 PHP，没有 COM 废话，仍在尝试计算 2007

```
<?php

/*****************************************************************
This approach uses detection of NUL (chr(00)) and end line (chr(13))
to decide where the text is:
- divide the file contents up by chr(13)
- reject any slices containing a NUL
- stitch the rest together again
- clean up with a regular expression
*****************************************************************/

function parseWord($userDoc) 
{
    $fileHandle = fopen($userDoc, "r");
    $line = @fread($fileHandle, filesize($userDoc));   
    $lines = explode(chr(0x0D),$line);
    $outtext = "";
    foreach($lines as $thisline)
      {
        $pos = strpos($thisline, chr(0x00));
        if (($pos !== FALSE)||(strlen($thisline)==0))
          {
          } else {
            $outtext .= $thisline." ";
          }
      }
     $outtext = preg_replace("/[^a-zA-Z0-9\s\,\.\-\n\r\t@\/\_\(\)]/","",$outtext);
    return $outtext;
} 

$userDoc = "cv.doc";

$text = parseWord($userDoc);
echo $text;

?> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-23T00:57:12.330

您可以使用 Antiword，它是适用于 Linux 和最流行操作系统的免费 MS Word 阅读器。

```
$document_file = 'c:\file.doc';
$text_from_doc = shell_exec('/usr/local/bin/antiword '.$document_file); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-10T00:23:47.277

我不知道用 PHP 阅读原生 Word 文档，但如果你想用 PHP 编写 Word 文档，[WordprocessingML（又名 WordML）](http://en.wikipedia.org/wiki/Microsoft_Office_XML_formats#Word_XML_Format_example)可能是一个不错的解决方案。您所要做的就是以正确的格式创建一个 XML 文档。我相信 Word 2003 和 2007 都支持 WordML。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-04-04T02:43:44.457

只是更新代码

```
<?php

/*****************************************************************
This approach uses detection of NUL (chr(00)) and end line (chr(13))
to decide where the text is:
- divide the file contents up by chr(13)
- reject any slices containing a NUL
- stitch the rest together again
- clean up with a regular expression
*****************************************************************/

function parseWord($userDoc) 
{
    $fileHandle = fopen($userDoc, "r");
    $word_text = @fread($fileHandle, filesize($userDoc));
    $line = "";
    $tam = filesize($userDoc);
    $nulos = 0;
    $caracteres = 0;
    for($i=1536; $i<$tam; $i++)
    {
        $line .= $word_text[$i];

        if( $word_text[$i] == 0)
        {
            $nulos++;
        }
        else
        {
            $nulos=0;
            $caracteres++;
        }

        if( $nulos>1996)
        {   
            break;  
        }
    }

    //echo $caracteres;

    $lines = explode(chr(0x0D),$line);
    //$outtext = "<pre>";

    $outtext = "";
    foreach($lines as $thisline)
    {
        $tam = strlen($thisline);
        if( !$tam )
        {
            continue;
        }

        $new_line = ""; 
        for($i=0; $i<$tam; $i++)
        {
            $onechar = $thisline[$i];
            if( $onechar > chr(240) )
            {
                continue;
            }

            if( $onechar >= chr(0x20) )
            {
                $caracteres++;
                $new_line .= $onechar;
            }

            if( $onechar == chr(0x14) )
            {
                $new_line .= "</a>";
            }

            if( $onechar == chr(0x07) )
            {
                $new_line .= "\t";
                if( isset($thisline[$i+1]) )
                {
                    if( $thisline[$i+1] == chr(0x07) )
                    {
                        $new_line .= "\n";
                    }
                }
            }
        }
        //troca por hiperlink
        $new_line = str_replace("HYPERLINK" ,"<a href=",$new_line); 
        $new_line = str_replace("\o" ,">",$new_line); 
        $new_line .= "\n";

        //link de imagens
        $new_line = str_replace("INCLUDEPICTURE" ,"<br><img src=",$new_line); 
        $new_line = str_replace("\*" ,"><br>",$new_line); 
        $new_line = str_replace("MERGEFORMATINET" ,"",$new_line); 

        $outtext .= nl2br($new_line);
    }

 return $outtext;
} 

$userDoc = "custo.doc";
$userDoc = "Cultura.doc";
$text = parseWord($userDoc);

echo $text;

?> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-10T02:17:08.297

如果没有 COM，您很可能无法阅读 Word 文档。

[本主题](https://stackoverflow.com/questions/124959/create-word-document-using-php-in-linux)涵盖了写作

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-10T15:24:10.413

2007 年也可能有点复杂。

.docx 格式是一个 zip 文件，其中包含一些文件夹，其中包含用于格式化和其他内容的其他文件。

将 .docx 文件重命名为 .zip，您就会明白我的意思了。

因此，如果您可以在 PHP 中使用 zip 文件，那么您应该走在正确的道路上。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-09-13T17:45:58.103

www.phplivedocx.org 是一个基于 SOAP 的服务，这意味着您始终需要在线测试文件，也没有足够的示例供其使用。奇怪的是，我在下载 2 天后才发现（也需要额外的 zend 框架）它是一个基于 SOAP 的程序（诅咒我！！！）......我认为没有 COM 它在 Linux 服务器上是不可能的，唯一的想法是将 doc 文件更改为 PHP 可以解析的另一个可用文件...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-10T02:45:48.160

Office 2007 .docx 应该是可能的，因为它是 XML 标准。Word 2003 很可能需要 COM 才能读取，即使使用 MS 现在发布的标准也是如此，因为这些标准非常庞大。我还没有看到为匹配它们而编写的许多库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-10T15:25:06.043

我不知道你打算用它做什么，但我需要 .doc 支持搜索索引；我所做的是使用一个名为“catdoc”的小命令行工具；这会将 Word 文档的内容转换为纯文本，以便对其进行索引。如果你需要保持格式和东西，这不是你的工具。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-14T07:03:23.423

**phpLiveDocx**是一个 Zend Framework 组件，可以在 Linux、Windows 和 Mac 上用 PHP 读写 DOC 和 DOCX 文件。

请参阅项目网站：

[http://www.phplivedocx.org](http://www.phplivedocx.org)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-09-28T16:44:16.420

使用 PHP 操作 Word 文件的一种方法是您可能会感兴趣的，那就是借助 PHPDocX。看看它的[在线教程](http://www.phpdocx.com/documentation/tutorial)，您可能会了解它是如何工作的。您可以插入或提取内容，甚至可以将多个 Word 文件合并为一个文件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-24T05:09:28.680

.rtf 格式是否适合您的目的？.rtf 可以轻松地与 .doc 格式相互转换，但它是以纯文本形式编写的（嵌入了控制命令）。这就是我计划将我的应用程序与 Word 文档集成的方式。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-09-05T14:17:51.237

即使我在做同样的项目 [An Onlinw Word Processor]！但我选择了 c#.net 和 ASP.net。但是通过我所做的调查；我知道了

> 通过使用 Open XML SDK 和 VSTO [Visual Studio Tools For Office]

我们可以轻松地使用 word 文件来操作它们，甚至可以在内部将它们转换为不同的格式，例如 .odt、.pdf、.docx 等。

> **因此，转到 msdn.microsoft.com 并彻底了解 Office 开发选项卡。这是最简单的方法，因为我们需要实现的所有功能都已在 .net 中可用！**

但是当你想用 PHP 做你的项目时，你可以在 Visual Studio 和 .net 中做，因为 PHP 也是 .net 兼容语言之一！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-10-11T19:12:09.240

我有同样的情况，我想我将使用一个便宜的 50 大型 Windows 主机和免费域来使用它来转换我的文件，用于 PHP 服务器。链接它们很容易。您所需要的只是创建一个 ASP.NET 页面，该页面通过 post 接收 doc 文件并通过 HTTP 回复它，所以简单的 CURL 就可以完成。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-07-03T10:25:55.013

[来源获取自](https://www.quora.com/How-can-I-read-docx-file-in-PHP-with-it-s-orignal-table-format)

> 直接使用下面的类来阅读word文档

```
class DocxConversion{
    private $filename;

    public function __construct($filePath) {
        $this->filename = $filePath;
    }

    private function read_doc() {
        $fileHandle = fopen($this->filename, "r");
        $line = @fread($fileHandle, filesize($this->filename));   
        $lines = explode(chr(0x0D),$line);
        $outtext = "";
        foreach($lines as $thisline)
          {
            $pos = strpos($thisline, chr(0x00));
            if (($pos !== FALSE)||(strlen($thisline)==0))
              {
              } else {
                $outtext .= $thisline." ";
              }
          }
         $outtext = preg_replace("/[^a-zA-Z0-9\s\,\.\-\n\r\t@\/\_\(\)]/","",$outtext);
        return $outtext;
    }

    private function read_docx(){

        $striped_content = '';
        $content = '';

        $zip = zip_open($this->filename);

        if (!$zip || is_numeric($zip)) return false;

        while ($zip_entry = zip_read($zip)) {

            if (zip_entry_open($zip, $zip_entry) == FALSE) continue;

            if (zip_entry_name($zip_entry) != "word/document.xml") continue;

            $content .= zip_entry_read($zip_entry, zip_entry_filesize($zip_entry));

            zip_entry_close($zip_entry);
        }// end while

        zip_close($zip);

        $content = str_replace('</w:r></w:p></w:tc><w:tc>', " ", $content);
        $content = str_replace('</w:r></w:p>', "\r\n", $content);
        $striped_content = strip_tags($content);

        return $striped_content;
    }

 /************************excel sheet************************************/

function xlsx_to_text($input_file){
    $xml_filename = "xl/sharedStrings.xml"; //content file name
    $zip_handle = new ZipArchive;
    $output_text = "";
    if(true === $zip_handle->open($input_file)){
        if(($xml_index = $zip_handle->locateName($xml_filename)) !== false){
            $xml_datas = $zip_handle->getFromIndex($xml_index);
            $xml_handle = DOMDocument::loadXML($xml_datas, LIBXML_NOENT | LIBXML_XINCLUDE | LIBXML_NOERROR | LIBXML_NOWARNING);
            $output_text = strip_tags($xml_handle->saveXML());
        }else{
            $output_text .="";
        }
        $zip_handle->close();
    }else{
    $output_text .="";
    }
    return $output_text;
}

/*************************power point files*****************************/
function pptx_to_text($input_file){
    $zip_handle = new ZipArchive;
    $output_text = "";
    if(true === $zip_handle->open($input_file)){
        $slide_number = 1; //loop through slide files
        while(($xml_index = $zip_handle->locateName("ppt/slides/slide".$slide_number.".xml")) !== false){
            $xml_datas = $zip_handle->getFromIndex($xml_index);
            $xml_handle = DOMDocument::loadXML($xml_datas, LIBXML_NOENT | LIBXML_XINCLUDE | LIBXML_NOERROR | LIBXML_NOWARNING);
            $output_text .= strip_tags($xml_handle->saveXML());
            $slide_number++;
        }
        if($slide_number == 1){
            $output_text .="";
        }
        $zip_handle->close();
    }else{
    $output_text .="";
    }
    return $output_text;
}

    public function convertToText() {

        if(isset($this->filename) && !file_exists($this->filename)) {
            return "File Not exists";
        }

        $fileArray = pathinfo($this->filename);
        $file_ext  = $fileArray['extension'];
        if($file_ext == "doc" || $file_ext == "docx" || $file_ext == "xlsx" || $file_ext == "pptx")
        {
            if($file_ext == "doc") {
                return $this->read_doc();
            } elseif($file_ext == "docx") {
                return $this->read_docx();
            } elseif($file_ext == "xlsx") {
                return $this->xlsx_to_text();
            }elseif($file_ext == "pptx") {
                return $this->pptx_to_text();
            }
        } else {
            return "Invalid File Type";
        }
    }

}

$docObj = new DocxConversion("test.docx"); //replace your document name with correct extension doc or docx 
echo $docText= $docObj->convertToText(); 
```

# coding-style - 切换语句失败...应该允许吗？

> ID：188461
> 
> 赞同：143
> 
> 时间：2008-10-09T18:11:08.903
> 
> 标签：coding-style, switch-statement

从我记事起，我就一直避免使用 switch 语句。实际上，我不记得它曾经作为一种可能的做事方式进入我的意识，因为它很早就被钻进我的脑海，它只不过是 switch 语句中的一个错误。然而，今天我遇到了一些设计使用它的代码，这让我立刻想知道社区中的每个人都对 switch 语句失败的看法。

它是编程语言明确不允许的（就像 C# 一样，尽管它提供了一种解决方法）还是任何语言的功能强大到足以留在程序员手中？

**编辑：** 我对失败的意思不够具体。我经常使用这种类型：

```
 switch(m_loadAnimSubCt){
        case 0:
        case 1:
            // Do something
            break;
        case 2:
        case 3:
        case 4:
            // Do something
            break;
   } 
```

但是，我担心这样的事情。

```
 switch(m_loadAnimSubCt){
        case 0:
        case 1:
            // Do something, but fall through to the other cases
            // after doing it.

        case 2:
        case 3:
        case 4:
            // Do something else.
            break;
   } 
```

这样，只要 case 为 0, 1，它就会在 switch 语句中执行所有操作。我在设计上看到了这一点，我只是不知道我是否同意应该以这种方式使用 switch 语句。我认为第一个代码示例非常有用且安全。第二种似乎有点危险。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-10-09T18:18:45.440

这可能取决于您认为失败的原因。我对这种事情没意见：

```
switch (value)
{
  case 0:
    result = ZERO_DIGIT;
    break;

  case 1:
  case 3:
  case 5:
  case 7:
  case 9:
     result = ODD_DIGIT;
     break;

  case 2:
  case 4:
  case 6:
  case 8:
     result = EVEN_DIGIT;
     break;
} 
```

但是，如果您有一个 case 标签，然后是另一个 case 标签的代码，我几乎总是认为这是邪恶的。也许将公共代码移动到一个函数并从两个地方调用会是一个更好的主意。

请注意，我使用[“邪恶”的](https://isocpp.org/wiki/faq/big-picture#defn-evil)[C++ FAQ](https://isocpp.org/wiki/faq)定义

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-10-09T18:17:18.360

这是一把双刃剑。它有时非常有用，但通常很危险。

什么时候好 当你想要 10 个案例都以相同的方式处理时......

```
switch (c) {
  case 1:
  case 2:
            ... Do some of the work ...
            /* FALLTHROUGH */
  case 17:
            ... Do something ...
            break;
  case 5:
  case 43:
            ... Do something else ...
            break;
} 
```

我喜欢的一条规则是，如果您在排除中断的地方做了任何花哨的事情，您需要一个明确的注释 /* FALLTHROUGH */ 来表明这是您的意图。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-09T18:16:11.827

你听说过[达夫的设备](http://en.wikipedia.org/wiki/Duff%27s_device)吗？这是使用 switch fallthrough 的一个很好的例子。

就像几乎所有语言功能一样，它是一个可以使用并且可以被滥用的功能。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-09T18:14:40.207

跌倒确实是一件方便的事情，具体取决于您在做什么。考虑这种安排选项的简洁易懂的方式：

```
switch ($someoption) {
  case 'a':
  case 'b':
  case 'c':
    // Do something
    break;

  case 'd':
  case 'e':
    // Do something else
    break;
} 
```

想象一下用 if/else 来做这件事。这将是一团糟。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-09T19:36:00.197

几次它可能非常有用，但一般来说，没有失败是期望的行为。应该允许掉线，但不是隐含的。

例如，更新某些数据的旧版本：

```
switch (version) {
    case 1:
        // Update some stuff
    case 2:
        // Update more stuff
    case 3:
        // Update even more stuff
    case 4:
        // And so on
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-10T00:02:25.350

我希望开关中的后备使用不同的语法，例如，errr..

```
switch(myParam)
{
  case 0 or 1 or 2:
    // Do something;
    break;
  case 3 or 4:
    // Do something else;
    break;
} 
```

**注意：如果您使用标志在枚举上声明所有情况，那么枚举已经可以实现，对吗？听起来也不错。这些案例可能（应该？）已经成为您枚举的一部分。**

对于使用扩展方法的流畅接口来说，这可能是一个很好的案例（没有双关语）？有点像，呃……

```
int value = 10;
value.Switch()
  .Case(() => { /* Do something; */ }, new {0, 1, 2})
  .Case(() => { /* Do something else */ } new {3, 4})
  .Default(() => { /* Do the default case; */ }); 
```

虽然这可能更不可读：P

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-09T18:15:52.030

它强大而危险。失败的最大问题是它不明确。例如，如果您遇到频繁编辑的代码，其中有一个带有故障的开关，您怎么知道这是故意的而不是错误？

在我使用它的任何地方，我都会确保对其进行正确评论：

```
switch($var) {
    case 'first':
        // Fall-through
    case 'second':
        i++;
        break;
 } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-09T18:17:16.440

与任何东西一样：如果小心使用，它可以成为一个优雅的工具。

但是，我认为缺点不仅仅是*不*使用它的理由，而且最终不再允许它（C#）。其中的问题是：

*   很容易“忘记”休息
*   对于代码维护者*来说，*省略的 break 是故意的并不总是很明显

很好地使用开关/外壳脱落：

```
switch (x)
{
case 1:
case 2:
case 3:
 Do something
 break;
} 
```

*Baaaaad*使用开关/外壳直通：

```
switch (x)
{
case 1:
    Some code
case 2:
    Some more code
case 3:
    Even more code
    break;
} 
```

在我看来，这可以使用 if/else 构造重写，而不会造成任何损失。

我的最后一句话：远离*坏*例子中的失败案例标签，除非你在维护使用这种风格并很好理解的遗留代码。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-10T21:07:43.357

像在你的第一个例子中那样使用 fall-through 显然是可以的，我不会认为它是一个真正的 fall-through。

第二个例子是危险的并且（如果没有广泛评论）不明显。我教我的学生不要使用这样的结构*，除非*他们认为值得为它投入一个评论块，它描述了这是一个故意的失败，以及为什么这个解决方案比替代方案更好。这不鼓励草率使用，但在使用它的情况下仍然允许使用它。

这或多或少等同于我们在太空项目中有人想要违反编码标准时所做的事情：他们必须申请豁免（我被要求就裁决提出建议）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-09T18:17:58.157

我不喜欢我的`switch`陈述落空——它太容易出错并且难以阅读。唯一的例外是当多个`case`语句都做*完全相同*的事情时。

如果某个 switch 语句的多个分支想要使用某些公共代码，我会将其提取到一个单独的公共函数中，该函数可以在任何分支中调用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-09T18:16:54.350

在某些情况下，使用 fall-throughs 是程序员的一种懒惰行为——他们可以使用一系列 || 例如，语句，而是使用一系列“包罗万象”的开关案例。

话虽如此，当我知道*最终*无论如何我都将需要这些选项（例如在菜单响应中）但尚未实现所有选项时，我发现它们特别有用。同样，如果您同时对“a”和“A”进行直通，我发现使用 switch 直通比使用复合 if 语句要干净得多。

这可能是风格问题和程序员的想法，但我通常不喜欢以“安全”的名义删除语言的组件——这就是为什么我更倾向于 C 及其变体/后代，而不是说，爪哇。即使我没有“理由”，我也喜欢能够用指针之类的东西到处乱跑。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-09T23:07:12.220

只有当它用作代码块的跳转表时才应使用fall-through。如果代码的任何部分在更多案例之前有无条件中断，则所有案例组都应该以这种方式结束。

其他任何东西都是“邪恶的”。

# ms-access - Access 2003 查询中的最大列数是多少？

> ID：188462
> 
> 赞同：4
> 
> 时间：2008-10-09T18:11:15.360
> 
> 标签：ms-access

access 2003 中查询中允许的最大列数是多少？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T18:13:56.527

255 我相信。您可以通过在 Access 中转到*帮助 > 规范 > 查询来进行检查。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:12:43.533

作为一般规则，如果您发现自己询问有关技术的最大硬编码限制的问题，那么是时候退后一步并验证您是否采用了正确的方法。可能对访问数百或数千列的查询不是正确的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T18:31:49.283

## 从访问帮助文件

谢谢你本

强制关系数：每个表 32 减去关系中未涉及的字段或字段组合的表上的索引
数 查询中的表数：32记录集中
的字段数：255
记录集大小：1千兆字节
排序限制：一个或多个字段中的 255 个字符
嵌套查询的级别数：50 查询设计网格中单元格中的
字符数：1,024 参数查询中参数的字符数：255
WHERE 中的 AND 数或 HAVING 子句：99
SQL 语句中的字符数：大约 64,000

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-30T09:57:50.620

您可以在 ms 访问查询中添加的最大列数为 255，但让我告诉我一件事：在访问中，您可以通过两种方式进行查询

1.  在设计视图中创建查询
2.  使用向导创建查询。

对于第一个选项，您最多只能在查询中添加 16 列，但使用第二个选项，您最多可以在查询中添加 255 列。

:)

# ruby-on-rails - 我可以从同一个 Apache 实例运行 LAMP 和 Rails 吗？

> ID：188463
> 
> 赞同：6
> 
> 时间：2008-10-09T18:11:21.663
> 
> 标签：ruby-on-rails, apache, apache2, lamp

我们有一个带有 Apache2、PHP5 和 MySQL 5 的 RedHat 盒子，用于我们的大部分开发工作。现在，我们有一个 Rails 客户端，我们需要在同一台服务器上设置一个 Rails 应用程序。我们可以使用同一个 Apache 安装 Ruby 和 Rails 框架，还是应该避免这种情况？为什么或者为什么不？是否可以在单个 V 主机定义中将子域定向到 PHP 或 Ruby？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:27:35.690

是的，您可以通过适当的配置将您的虚拟主机配置为 Rails、PHP 或其他任何东西。细节很大程度上取决于你如何连接到 Rails，但通常你会配置一个单一用途的 Apache 服务器应该为虚拟主机工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T10:27:23.127

是的 - 安装[乘客](http://www.modrails.com/)，然后您可以通过您的 apache conf 文件配置您的站点。乘客文档包含您需要知道的一切！

# c# - 如何在 C# 中管理确定性终结？

> ID：188473
> 
> 赞同：9
> 
> 时间：2008-10-09T18:13:57.507
> 
> 标签：c#, garbage-collection

我有一个 C# 对象，它的关键资源需要在非常特定的时间点刷新，这使得它不适合让垃圾收集器随时处理它，我应该如何处理这个问题？是否有类似 C++ 的 delete 运算符之类的东西可以让我在需要时手动终止该对象的实例？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-09T18:30:06.510

您正在寻找[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx). 这是一个实现这一点的示例类。

```
class MyDisposableObject : IDisposable
{
   public MyDisposableObject()
   {
   }

   ~MyDisposableObject()
   {
      Dispose(false);
   }

   private bool disposed;
   private void Dispose(bool disposing)
   {
      if (!this.disposed)
      {
          if (disposing)
          {
             // Dispose of your managed resources here.
          }

          // Dispose of your unmanaged resources here.

          this.disposed = true;
       }
   }

   void IDisposable.Dispose()
   {
      Dispose(true);
      GC.SuppressFinalize(this);
   }
} 
```

要使用它，您可以执行以下操作：

```
public void DoingMyThing()
{
   using (MyDisposableObject obj = new MyDisposableObject())
   {
      // Use obj here.
   }
} 
```

[`using`](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)关键字确保[`Dispose()`](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)方法 on在其[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)作用域结束时被调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:18:05.550

这正是[`IDiposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)接口的用途。您在方法中释放关键资源`Dispose()`，然后将对象留给垃圾处理器处理释放内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:23:34.790

IDisposable 接口用于确定性销毁。[在MSDN](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx "MSDN")上有一个正确实现它的模式。

同时，当您的对象的生命周期不跨越多个范围时，您还应该考虑使用[using 语句。](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T18:19:11.023

谷歌的 IDisposable 接口。这是您唯一可用的机制。如果您的关键资源不受管理，它是量身定制的。如果它是托管资源，您能否更具体地说明需要“刷新”的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T18:20:11.613

添加了 IDisposable 接口以支持 C++/CLI 中的确定性销毁，您可以从任何 .NET 语言中使用它。这就是你想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T18:20:39.913

如果您谈论的是您认为“必须”在特定时间释放的特定托管资源，则可以在取消引用对象后专门调用垃圾收集器的收集方法，但需要考虑性能注意事项，通常垃圾收集器知道何时收集项目。总的来说，这是一个坏主意。

正如其他人在上面提到的，IDisposable 模式有助于在需要时释放非托管资源。

**注意：**我要重复一遍，您可以调用 GC.Collect() 但这不是一件好事，而是该问题的有效答案！

# string - 比较两个字符串产生一个数字增量

> ID：188476
> 
> 赞同：4
> 
> 时间：2008-10-09T18:14:24.123
> 
> 标签：string, comparison

有谁知道一种简单的方法来比较两个字符串以生成两者之间的“差异量”？（以数值表示）我一直在爬谷歌，但运气不佳。在做了一些编码之后，它并不像我想象的那么简单。有什么线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T18:16:10.250

你说的是“编辑距离”吗？在 SO 或 Google 上搜索“Levenshtein Distance”。我使用发布在[Stephen Toub 博客上的版本](http://blogs.msdn.com/toub/archive/2006/05/05/590814.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:16:20.233

您正在寻找[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T18:18:05.673

您可能想查看[Levenshtein](http://en.wikipedia.org/wiki/Levenshtein_distance)和[Hamming](http://en.wikipedia.org/wiki/Hamming_distance)距离。一个计算编辑距离（插入、删除、修改），另一个位翻转。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T18:17:58.577

您需要非常清楚地定义“差异量”。里面有很大的回旋余地。

例如，旧的 C/C++ 函数`strcmp()`函数逐个字符进行比较，并在第一次不匹配时返回差异。

另一方面，diff 程序提供了两个文件之间差异的综合列表（从某种意义上说，这也是字符串）。你将如何量化它？

# emacs - 在 Emacs 中如何切换到其他缓冲区？

> ID：188488
> 
> 赞同：1
> 
> 时间：2008-10-09T18:16:37.160
> 
> 标签：emacs, dot-emacs

问题如下：我想自动化我的emacs启动方式。它必须分成两个缓冲区，并且 slime-repl 必须在最小（底部）缓冲区中启动。另外，我希望我的文件在更大（上）缓冲区中打开。在我的 .emacs 中有几行：

```
(slime)
...
(split-window-vertically -6)
(switch-to-buffer (other-buffer))
(find-file "g:/Private/pa/pa2.lsp") 
```

SLIME 在底部缓冲区中打开正常，但文件在后台缓冲区之一中打开，而我希望它在前面。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T08:45:42.753

您可以查看功能 set-window-configuration ...

但是对于粘液，您可以使用以下功能 - slime-complete-maybe-save-window-configuration & slime-complete-restore-window-configuration

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T12:32:55.083

而不是`switch-to-buffer`，使用函数`pop-to-buffer`。

> `(pop-to-buffer BUFFER-OR-NAME &optional OTHER-WINDOW NORECORD)`
> 
> 在某个窗口中选择缓冲区`BUFFER-OR-NAME`，最好是另一个窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T18:45:07.883

尝试：

```
(other-window 1)
(find-file "g:/Private/pa/pa2.lsp") 
```

而不是你的最后两行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-31T19:58:02.790

尝试添加

```
(ido-mode 1) 
```

到您的 .emacs，并享受结果:)

# php - 小组协作开源 php 应用程序

> ID：188489
> 
> 赞同：0
> 
> 时间：2008-10-09T18:16:54.320
> 
> 标签：php, collaboration

我在一个委员会中，该委员会将受益于允许成员与成员合作的在线应用程序。

我希望能够发布消息和上传文档。

您是否建议在您的服务器应用程序上安装任何免费且易于安装的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T07:30:48.477

如果你真的想要类似于 BaseCamp 的东西，你应该试试[ProjectPier](http://www.projectpier.org/)。

如果您认为您需要的社区功能比项目管理工具所能提供的更多，我建议您使用[Drupal](http://drupal.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T18:46:56.630

有了如此广泛的要求，将有 1000 种软件包可供选择。像[TikiWiki](http://info.tikiwiki.org/tiki-index.php)这样的东西可能会完成这项工作（根据您的需要，它甚至可能是矫枉过正）。

# security - 防止程序员知道运行时使用的密码

> ID：188491
> 
> 赞同：11
> 
> 时间：2008-10-09T18:17:15.647
> 
> 标签：security, passwords

我的应用程序使用用户名和密码连接到 FTP 服务器。我可以创建一个加密例程来加密和解密密码，但是任何有权访问源代码和加密密码的人都可以解密密码。

有没有一种简单的方法可以防止每个人都知道应用程序使用的整个密码？（我认为如果多个人知道部分密码是可以的。）

编辑：我知道 FTP 不安全。理想情况下，我想要一种可以在需要用户名和密码的任何情况下工作的技术（例如数据库连接）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T18:24:13.383

不需要。应用程序用户所要做的就是嗅探他们自己的网络流量（使用 Wireshark 等很容易做到）。

您确实需要一种方法来为每个用户提供某种独特的令牌。

编辑 - 更多信息：

任何依赖于每个应用程序副本都相同的“秘密”登录信息的系统在设计上存在缺陷。为了保证安全，您的应用程序的每次安装都必须有一个唯一的秘密，用于向服务器进行身份验证。您如何实现这一点取决于您如何许可/分发您的应用程序。这是我将如何做到的。（通过 SSL 连接执行所有通信）。

1.  应用程序首次启动 - 它看到它没有保存任何身份验证信息。
2.  应用程序会提示您输入注册码、电子邮件地址和/或您想要识别用户的任何方式。
3.  应用程序生成一个公钥/私钥对，并将公钥和您的 ID 信息从第 2 步提交到服务器。
4.  服务器会记住您的密钥并从现在开始使用它来识别您的应用程序。

替代步骤 3 是：应用程序从步骤 2 提交信息，服务器发回 info + salt 的哈希签名。哈希签名现在是您应用程序的密钥。

重要的是所有用户之间没有共享“秘密”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:22:17.973

您可以在此处参考我的旧问题和答案。[如何在 Winforms 应用程序中存储密码？](https://stackoverflow.com/questions/40853/how-to-store-passwords-in-winforms-application). 但是，也期待其他一些想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:24:27.050

不应该至少有一个人可以访问密码或密钥吗？我们的开发人员无权访问生产服务器。这允许知道密码的系统人员在部署软件时设置密码。

将软件编码为可配置的，然后将您的开发人员拒之门外。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T18:35:24.563

不，没有简单的方法：您可以随心所欲地混淆事物，但是如果应用程序在任何时候都可以使用明文密码，而无需访问其自己的源代码以外的任何资源，则可以通过以下方式提取它任何可以访问相同源代码的人。

当使用像 FTP 这样的协议时，无论如何，整个练习有点毫无意义：任何能够下载[Wireshark](http://www.wireshark.org/)的人都可以在几秒钟内从网络线路上嗅出凭据，如果不是更短的话。

正确解决问题的步骤：

*   切换到安全协议，例如 SFTP 或 FTP+SSL
*   使用公钥认证而不是密码（SFTP 和 FTP+SSL 都支持这一点，尽管方式略有不同）
*   为软件的每个部署提供（最好是唯一的，以便您可以检测凭证共享并禁用被盗帐户）登录所需的私钥/证书副本
*   在您运行的平台上以最安全的方式存储私钥/证书。在 Windows 上，这意味着使用证书存储 - 请参阅[此 MSDN 杂志文章](http://msdn.microsoft.com/en-us/magazine/cc163454.aspx)以获得很好的介绍

编辑（修改原始问题后）：我的回复的第一段同样适用于数据库密码等。这些情况的解决方案变得更加特定于平台。如果您的特定数据库/任何东西/操作系统组合不支持安全登录，那么您无能为力。

例如：在 Windows 上，SQL Server 支持 NTLM 身份验证，允许您根据现有的 Windows 帐户设置数据库访问权限，让您自动安全存储和传输相对难以绕过的密码。如果不能使用 NTLM 身份验证，您可以做的最好的事情（如 .NET Framework 上的推荐做法）是将密码存储在配置文件中，并使用特定于计算机的密钥进行加密。但是，使用调试器可以轻松绕过“保护”，因为在某些时候需要明文密码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T18:23:08.643

我尝试了很多方法，我认为加密不是这种情况下的方法。相反，将密码存储在配置文件中，例如 web.config/app.config/etc 或 Windows 注册表，或 /etc 中的文件或开发人员无权访问的任何其他位置（在生产环境中） ， 但你做了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-14T13:00:25.347

他的所作所为是偏执狂的主要原因，无用的偏执狂。如果您不信任您的雇员来保护您的数据安全，请找其他人。

这里的问题不是您可以使用软件解决的问题，而是人力资源问题。例如，每个拥有部分密码的两个人一定会及时找到彼此，在这种情况下，现在两个人将知道整个密码。

正如您自己指出的那样，即使您要做到这一点，所以没有一个人拥有密码（当然，首先实际上将密码设置到服务器的人除外......）仍然很容易通过网络拦截.

这是“我不想让任何人访问计算机”的老问题，只能通过将计算机从所有东西上拔下，将其焊接到钢盒中，在上面浇注混凝土，然后将东西射入深空来完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T18:22:33.543

本质上，没有。你可以让它变得困难，但是任何在其他人的计算机上运行代码的方案都可能受到攻击。FTP 服务器如何知道它是在与*您的*应用程序通信，而不是与从您的应用程序中窃取他们需要的东西的人通信。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T18:22:39.377

不，没有办法安全地做到这一点。ftp 无论如何都不是一个安全协议，因此人们不需要源代码来查看您的用户名和密码，只需一个本地网络嗅探器即可。您可以通过使用 ssh 隧道来避免该问题，但是如果您发送源代码，那么对于有权访问它的人来说，从中获取用户名和密码总是微不足道的。即使没有源代码，甚至使用安全协议，具有反汇编器/调试器和一些空闲时间的专用攻击者仍然能够从可执行文件中获取此信息。如果用户名和密码必须是安全的，即使被混淆，也不要将其包含在代码中！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T18:23:36.117

实际答案是否定的。标准的 FTP 客户端服务器通信实际上以未加密的形式通过网络传递用户名和密码。因此，即使您尝试使用某种方案来加密应用程序中的实际数据，任何拥有 Ethereal 副本的人都能够嗅出它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T18:38:49.750

无论您使用哪种加密方式，都需要先对密码进行加密，然后您的应用才能连接到 ftp。*任何*用户都可以在调试器中运行您的应用程序，跟踪到该点，然后从内存中选择密码。这样一来，您的方案的完全安全性是不可能的。

话虽如此，您可以将加密的密码放在运行时读取的配置文件中。让开发人员连接到不同的 ftp（或使用稍后被删除的不同帐户），并在部署应用程序时将要保护的加密密码放在配置文件中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T18:39:26.707

一种方法是将应用程序托管在服务器上。如果密码存储在服务器的受限区域中，那么使用该应用程序的人将无法访问它。事实上，除了通过提供的接口外，他们将无法访问应用程序。这就是网络应用程序如此受欢迎的原因之一。

在这种特殊情况下，他们仍然可以使用源代码，您只需要确保密码不与源代码一起存储，而是仅存储在安全服务器上，并且只能由托管应用程序的帐户访问服务器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-09T19:21:44.033

只是为了抛出想法：

1.  将密码存储在二进制文件中，在您为其分配的位置。
2.  密码可以根据时间（日期）或其他内容更改，但如果他们运行您的代码，他们也可以获得它。
3.  也许用公钥/私钥做一些事情。（加密中的签名可以识别用户。这个信息可以在运行时检索，我认为从他/她的密钥中。这就像一个挑战，但你需要构建/编程另一个服务器仅用于此身份验证部分。也许有更多已知的工业接受方式..

顺便说一句，ftp 并不安全。您需要 sftp 或 ftps 以避免传输明文。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-09T19:23:25.137

我猜你已经看到足够多的“不”答案了。我想指出（不直接回答您的问题）类似的问题已经（几乎）通过 Web-/应用程序服务器中的 jdbc-datasources 解决了：这些资源，基本上是连接工厂，提供已连接的数据库应用程序无需担心任何连接设置，包括名称和密码。连接是由 appserver 建立的，appserver 也会读取配置文件并知道密码。

我不知道在其他环境（或适用性）中的词汇，但正如你所问的语言不可知论者并且我没有直接回答你的问题，我认为将示例限制为 Java 是可以的。

如果您找到/编写提供 ftp 连接的类似抽象，您可能会阻止具有源代码的程序员知道密码（因为仅使用某些“容器”提供的连接对象）。但是，它无助于防止窃听或对正在运行的应用程序具有调试访问权限的人。

希望这会有所帮助，即使它没有直接回答并且不是严格的“是”；-)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-14T00:46:07.530

也许这个答案会根据您的环境有所帮助。但最终，因为人们参与了这个过程，所以答案是“不太可能”。

*   将用户名/密码组合保存在配置文件中。
*   使用一个用户名/密码设置登台服务器，使用另一个用户名/密码设置测试服务器，以及使用另一个用户名/密码设置产品服务器。
*   配置文件中的密码（程序员都知道）用于登台服务器。提供给测试组的用户名/密码用于测试服务器。
*   确保生产/测试服务器具有不同的用户名/密码。
*   使用产品的正确生产用户名/密码分发配置文件。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-14T01:04:32.003

不确定您需要什么...如果您正在寻找一种硬编码私人密码的方法，请忽略我的评论。

但是，如果您正在寻找一种存储密码的方法...

我认为，您正在寻找的是保存密码的哈希而不是密码本身。这样，即使程序员有你的密码检查算法和数据库中的密码哈希，他也无法解密密码。

# .net - 检测处理器数量

> ID：188503
> 
> 赞同：28
> 
> 时间：2008-10-09T18:18:24.427
> 
> 标签：.net, wmi, cpu, environment

您如何检测 .net 中的物理处理器/内核的数量？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-09T18:22:14.340

```
System.Environment.ProcessorCount 
```

返回逻辑处理器的数量

> [http://msdn.microsoft.com/en-us/library/system.environment.processorcount.aspx](http://msdn.microsoft.com/en-us/library/system.environment.processorcount.aspx)

对于物理处理器数量，您可能需要使用 WMI - XP/Win2k3 以上支持以下元数据（在 Vista/Win2k8 之前的 SP 中启用了功能）。

> **Win32_ComputerSystem.NumberOfProcessors**返回物理计数
> 
> **Win32_ComputerSystem.NumberOfLogicalProcessors**返回逻辑（呃！）

请注意，超线程 CPU 看起来与多核 CPU 相同，但性能特征却*大不相同*。

要检查启用了 HT 的 CPU，请检查 Win32_Processor 的每个实例并比较这两个属性。

> **Win32_Processor.NumberOfLogicalProcessors**
> 
> **Win32_Processor.NumberOfCores**

在多核系统上，这些值通常是相同的。

此外，请注意可能具有多个**处理器组**的系统，这在具有大量处理器的计算机上很常见。默认情况下， [.Net 将仅使用第一个处理器组](https://stackoverflow.com/questions/27965962/c-sharp-environment-processorcount-does-not-always-return-the-full-number-of-log)- 这意味着默认情况下，线程将仅使用第一个处理器组中的 CPU，并且`Environment.ProcessorCount`仅返回该组中的 CPU 数量。根据[Alastair Maw 的回答](https://stackoverflow.com/questions/27965962/c-sharp-environment-processorcount-does-not-always-return-the-full-number-of-log/30456753#30456753)，可以通过如下更改 app.config 来更改此行为：

```
<configuration>
   <runtime>
      <Thread_UseAllCpuGroups enabled="true"/>
      <GCCpuGroup enabled="true"/>
      <gcServer enabled="true"/>
   </runtime>
</configuration> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-09T22:00:51.153

虽然`Environment.ProcessorCount`确实会为您提供系统中虚拟处理器的数量，但这可能不是您的进程可用的处理器数量。我快速创建了一个小的静态类/属性来得到它​​：

```
using System;
using System.Diagnostics;

/// <summary>
/// Provides a single property which gets the number of processor threads
/// available to the currently executing process.
/// </summary>
internal static class ProcessInfo
{
    /// <summary>
    /// Gets the number of processors.
    /// </summary>
    /// <value>The number of processors.</value>
    internal static uint NumberOfProcessorThreads
    {
        get
        {
            uint processAffinityMask;

            using (var currentProcess = Process.GetCurrentProcess())
            {
                processAffinityMask = (uint)currentProcess.ProcessorAffinity;
            }

            const uint BitsPerByte = 8;
            var loop = BitsPerByte * sizeof(uint);
            uint result = 0;

            while (--loop > 0)
            {
                result += processAffinityMask & 1;
                processAffinityMask >>= 1;
            }

            return (result == 0) ? 1 : result;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T20:13:03.930

这实际上因目标平台而异。Stephbu 的回答将在 XP SP3 和更新版本上运行良好。

如果您的目标是较旧的平台，您可能需要查看[这篇文章](http://www.atalasoft.com/cs/blogs/rickm/archive/2008/04/01/counting-processors-in-net-the-pros-and-cons-of-five-different-methods.aspx)。我大约半年前写了它，在其中我讨论了几种不同的方法来做到这一点，以及每种方法的优缺点。

如果您对区分影子内核和超线程和真实内核感兴趣，您可能还想查看[这篇代码项目文章。](http://www.codeproject.com/KB/system/countingprocessors.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T18:26:21.850

Environment.ProcessorCount 还将包括任何超线程处理器。

没有办法（至少在 Windows 2003 之前）将超线程处理器与具有两个内核的处理器区分开来。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T18:20:15.687

System.Environment.ProcessorCount 是你需要的

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-09T18:20:53.827

Environment.ProcessorCount

编辑：在 .NET 2.0 中可用，在 .NET 1.1 中不可用

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-11T13:06:05.177

没有足够的 wiki 代表，但请注意，除了 XPSP2，Windows 2003 Server SP1 和 SP2 还需要一个修补程序来启用此功能：

[http://support.microsoft.com/kb/932370](http://support.microsoft.com/kb/932370)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-20T13:18:58.710

您可以使用 PowerShell 访问全面的处理器信息。例如，您可以运行以下命令来获取 CPU 核心数：

```
Get-WmiObject -namespace root\CIMV2 -class Win32_Processor -Property NumberOfCores 
```

使用某种资源管理器工具时，研究 WMI 会容易得多。因此，我可以建议使用 WMI 浏览工具（例如[WMIExplorer](http://www.ks-soft.net/hostmon.eng/wmi/)或[WMI CIM Studio](http://www.microsoft.com/en-us/download/details.aspx?id=24045)）来探索 WMI 类、属性和方法。

# visual-studio-2008 - 如何在 VS 2008 中追踪过时的构建配置？

> ID：188509
> 
> 赞同：1
> 
> 时间：2008-10-09T18:19:11.617
> 
> 标签：visual-studio-2008, configuration, build, x86, release

我有一个包含许多 C# 项目的大型解决方案。当我第一次打开解决方案并按 F5 时，出现如下编译错误：

> 错误 3 找不到元数据文件“C:\Users\david\Documents\VS.Projects\CeoTrunk\Ceoimage\bin\x86\Release\Ceoimage.dll”。

我正在编译解决方案和产生“调试（任何 CPU）”错误的项目，并且很长时间没有选择“发布（x86）”。也许几个月。在我第一次为“调试（任何 CPU）”构建解决方案后，这些错误就消失了。如果我关闭解决方案并再次按 F5，问题会再次出现。

这个“Release (x86)”的残余藏在哪里？我该如何摆脱它？为什么它总是回来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T18:43:12.677

在没有看到您的解决方案和项目文件的情况下，这是我的建议。

1.  清除所有 obj 和 bin 目录（最好删除您的源并获取新副本）。
2.  尝试完整的构建，看看它是否仍然失败。如果确实...
3.  重复步骤 1。
4.  检查您对每个项目的引用，并确保它们将其他项目作为项目引用而不是对其输出程序集的直接引用。
5.  尝试卸载项目并重建以查看是否可以识别有问题的项目。

不幸的是，它可能归结为循环依赖或其他一些复杂的依赖树，这意味着 Visual Studio 正在努力确定有效的构建顺序，因此需要多次构建才能完成该过程。

# c# - 如何在 C# 中将字符串格式化为电话号码

> ID：188510
> 
> 赞同：178
> 
> 时间：2008-10-09T18:19:37.327
> 
> 标签：c#, string, formatting, phone-number

我有一个字符串“1112224444”，它是一个电话号码。我想在将其存储在文件中之前将其格式化为 111-222-4444。它位于数据记录中，我希望能够在不分配新的情况下执行此操作多变的。

我刚在想：

```
String.Format("{0:###-###-####}", i["MyPhone"].ToString() ); 
```

但这似乎不起作用。

** 更新 **

好的。我选择了这个解决方案

```
Convert.ToInt64(i["Customer Phone"]).ToString("###-###-#### ####") 
```

现在，当扩展名小于 4 位时，它会变得混乱。它将从右侧填写数字。所以

```
1112224444 333  becomes

11-221-244 3334 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-10-09T18:39:15.243

请注意，此答案适用于数字数据类型（int、long）。如果您以字符串开头，则需要先将其转换为数字。另外，请注意您需要验证初始字符串的长度是否至少为 10 个字符。

从一个充满示例的[好页面：](http://blog.stevex.net/index.php/string-formatting-in-csharp/)

```
String.Format("{0:(###) ###-####}", 8005551212);

    This will output "(800) 555-1212". 
```

尽管正则表达式可能会更好地工作，但请记住旧的编程报价：

> 有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。
> --Jamie Zawinski，在 comp.lang.emacs 中

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2008-10-09T18:36:07.947

我更喜欢使用正则表达式：

```
Regex.Replace("1112224444", @"(\d{3})(\d{3})(\d{4})", "$1-$2-$3"); 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2008-10-09T18:24:34.897

您需要将其分解为子字符串。虽然你*可以*在没有任何额外变量的情况下做到这一点，但这并不是特别好。这是一个潜在的解决方案：

```
string phone = i["MyPhone"].ToString();
string area = phone.Substring(0, 3);
string major = phone.Substring(3, 3);
string minor = phone.Substring(6);
string formatted = string.Format("{0}-{1}-{2}", area, major, minor); 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2011-12-06T16:09:18.487

我建议将此作为美国数字的干净解决方案。

```
public static string PhoneNumber(string value)
{ 
    if (string.IsNullOrEmpty(value)) return string.Empty;
    value = new System.Text.RegularExpressions.Regex(@"\D")
        .Replace(value, string.Empty);
    value = value.TrimStart('1');
    if (value.Length == 7)
        return Convert.ToInt64(value).ToString("###-####");
    if (value.Length == 10)
        return Convert.ToInt64(value).ToString("###-###-####");
    if (value.Length > 10)
        return Convert.ToInt64(value)
            .ToString("###-###-#### " + new String('#', (value.Length - 10)));
    return value;
} 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2008-10-09T18:24:30.933

据我所知，您无法使用 string.Format 执行此操作……您必须自己处理。您可以删除所有非数字字符，然后执行以下操作：

```
string.Format("({0}) {1}-{2}",
     phoneNumber.Substring(0, 3),
     phoneNumber.Substring(3, 3),
     phoneNumber.Substring(6)); 
```

这假设数据已正确输入，您可以使用正则表达式进行验证。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2010-10-05T21:04:48.003

这应该有效：

```
String.Format("{0:(###)###-####}", Convert.ToInt64("1112224444")); 
```

或者在你的情况下：

```
String.Format("{0:###-###-####}", Convert.ToInt64("1112224444")); 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-10-09T18:26:09.590

如果你能得到`i["MyPhone"]`as `long`，你可以使用`long.ToString()`方法来格式化它：

```
Convert.ToLong(i["MyPhone"]).ToString("###-###-####"); 
```

请参阅有关[数字格式字符串](http://msdn.microsoft.com/en-us/library/427bttx3.aspx)的 MSDN 页面。

小心使用 long 而不是 int：int 可能会溢出。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-03-20T16:45:06.247

```
static string FormatPhoneNumber( string phoneNumber ) {

   if ( String.IsNullOrEmpty(phoneNumber) )
      return phoneNumber;

   Regex phoneParser = null;
   string format     = "";

   switch( phoneNumber.Length ) {

      case 5 :
         phoneParser = new Regex(@"(\d{3})(\d{2})");
         format      = "$1 $2";
       break;

      case 6 :
         phoneParser = new Regex(@"(\d{2})(\d{2})(\d{2})");
         format      = "$1 $2 $3";
       break;

      case 7 :
         phoneParser = new Regex(@"(\d{3})(\d{2})(\d{2})");
         format      = "$1 $2 $3";
       break;

      case 8 :
         phoneParser = new Regex(@"(\d{4})(\d{2})(\d{2})");
         format      = "$1 $2 $3";
       break;

      case 9 :
         phoneParser = new Regex(@"(\d{4})(\d{3})(\d{2})(\d{2})");
         format      = "$1 $2 $3 $4";
       break;

      case 10 :
         phoneParser = new Regex(@"(\d{3})(\d{3})(\d{2})(\d{2})");
         format      = "$1 $2 $3 $4";
       break;

      case 11 :
         phoneParser = new Regex(@"(\d{4})(\d{3})(\d{2})(\d{2})");
         format      = "$1 $2 $3 $4";
       break;

      default:
        return phoneNumber;

   }//switch

   return phoneParser.Replace( phoneNumber, format );

}//FormatPhoneNumber

    enter code here 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-03-22T22:10:20.273

如果您正在寻找要实时转换的（美国）电话号码。我建议使用这个扩展。这种方法可以完美地工作，无需向后填写数字。该`String.Format`解决方案似乎倒退。只需将此扩展名应用于您的字符串。

```
public static string PhoneNumberFormatter(this string value)
{
    value = new Regex(@"\D").Replace(value, string.Empty);
    value = value.TrimStart('1');

    if (value.Length == 0)
        value = string.Empty;
    else if (value.Length < 3)
        value = string.Format("({0})", value.Substring(0, value.Length));
    else if (value.Length < 7)
        value = string.Format("({0}) {1}", value.Substring(0, 3), value.Substring(3, value.Length - 3));
    else if (value.Length < 11)
        value = string.Format("({0}) {1}-{2}", value.Substring(0, 3), value.Substring(3, 3), value.Substring(6));
    else if (value.Length > 10)
    {
        value = value.Remove(value.Length - 1, 1);
        value = string.Format("({0}) {1}-{2}", value.Substring(0, 3), value.Substring(3, 3), value.Substring(6));
    }
    return value;
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-12-30T00:47:55.417

使用字符串插值和新的数组[索引/范围](https://docs.microsoft.com/en-us/dotnet/csharp/tutorials/ranges-indexes)

```
var p = "1234567890";
var formatted = $"({p[0..3]}) {p[3..6]}-{p[6..10]}" 
```

输出：(123) 456-7890

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2020-04-17T05:20:46.483

```
 string phoneNum;
        string phoneFormat = "0#-###-###-####";
        phoneNum = Convert.ToInt64("011234567891").ToString(phoneFormat); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-08-09T10:04:32.517

你也可以试试这个：

```
 public string GetFormattedPhoneNumber(string phone)
        {
            if (phone != null && phone.Trim().Length == 10)
                return string.Format("({0}) {1}-{2}", phone.Substring(0, 3), phone.Substring(3, 3), phone.Substring(6, 4));
                return phone;
        } 
```

输出：

[![在此处输入图像描述](https://i.stack.imgur.com/fg3BP.png)](https://i.stack.imgur.com/fg3BP.png)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-12-05T16:32:17.427

您可能会遇到这样的情况：用户尝试输入电话号码，在区号和主号码块之间使用各种分隔符（例如，空格、破折号、句点等......）所以你会想要去掉所有不是数字的字符的输入，这样您就可以对正在使用的输入进行消毒。最简单的方法是使用 RegEx 表达式。

```
string formattedPhoneNumber = new System.Text.RegularExpressions.Regex(@"\D")
    .Replace(originalPhoneNumber, string.Empty); 
```

那么您列出的答案在大多数情况下都应该有效。

要回答您对分机问题的看法，您可以剥离任何长于预期长度 10 的内容（对于普通电话号码），然后使用

```
formattedPhoneNumber = Convert.ToInt64(formattedPhoneNumber)
     .ToString("###-###-#### " + new String('#', (value.Length - 10))); 
```

在执行此操作之前，您需要进行“if”检查以确定输入的长度是否大于 10，如果不是，请使用：

```
formattedPhoneNumber = Convert.ToInt64(value).ToString("###-###-####"); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-09-15T17:40:05.387

```
Function FormatPhoneNumber(ByVal myNumber As String)
    Dim mynewNumber As String
    mynewNumber = ""
    myNumber = myNumber.Replace("(", "").Replace(")", "").Replace("-", "")
    If myNumber.Length < 10 Then
        mynewNumber = myNumber
    ElseIf myNumber.Length = 10 Then
        mynewNumber = "(" & myNumber.Substring(0, 3) & ") " &
                myNumber.Substring(3, 3) & "-" & myNumber.Substring(6, 3)
    ElseIf myNumber.Length > 10 Then
        mynewNumber = "(" & myNumber.Substring(0, 3) & ") " &
                myNumber.Substring(3, 3) & "-" & myNumber.Substring(6, 3) & " " &
                myNumber.Substring(10)
    End If
    Return mynewNumber
End Function 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-10-31T10:15:41.150

尝试这个

```
string result;
if ( (!string.IsNullOrEmpty(phoneNumber)) && (phoneNumber.Length >= 10 ) )
    result = string.Format("{0:(###)###-"+new string('#',phoneNumber.Length-6)+"}",
    Convert.ToInt64(phoneNumber)
    );
else
    result = phoneNumber;
return result; 
```

干杯。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-11-19T18:32:17.533

在 Regex 中使用 Match 进行拆分，然后使用 match.groups 输出格式化字符串

```
Regex regex = new Regex(@"(?<first3chr>\d{3})(?<next3chr>\d{3})(?<next4chr>\d{4})");
Match match = regex.Match(phone);
if (match.Success) return "(" + match.Groups["first3chr"].ToString() + ")" + " " + 
  match.Groups["next3chr"].ToString() + "-" + match.Groups["next4chr"].ToString(); 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-12-14T18:00:05.523

以下将在不使用正则表达式的情况下工作

```
string primaryContactNumber = !string.IsNullOrEmpty(formData.Profile.Phone) ? String.Format("{0:###-###-####}", long.Parse(formData.Profile.Phone)) : ""; 
```

如果我们不使用 long.Parse ， string.format 将不起作用。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-09-14T13:21:34.727

```
public string phoneformat(string phnumber)
{
String phone=phnumber;
string countrycode = phone.Substring(0, 3); 
string Areacode = phone.Substring(3, 3); 
string number = phone.Substring(6,phone.Length); 

phnumber="("+countrycode+")" +Areacode+"-" +number ;

return phnumber;
} 
```

Output will be :001-568-895623

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-11-29T18:26:51.670

这是另一种方法。

```
public string formatPhoneNumber(string _phoneNum)
{
    string phoneNum = _phoneNum;
    if (phoneNum == null)
        phoneNum = "";
    phoneNum = phoneNum.PadRight(10 - phoneNum.Length);
    phoneNum = phoneNum.Insert(0, "(").Insert(4,") ").Insert(9,"-");
    return phoneNum;
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-05-14T20:37:54.960

请使用以下 C# 链接 [http://www.beansoftware.com/NET-Tutorials/format-string-phone-number.aspx](http://www.beansoftware.com/NET-Tutorials/format-string-phone-number.aspx)

最简单的格式化方法是使用正则表达式。

```
private string FormatPhoneNumber(string phoneNum)
{
  string phoneFormat = "(###) ###-#### x####";

  Regex regexObj = new Regex(@"[^\d]");
  phoneNum = regexObj.Replace(phoneNum, "");
  if (phoneNum.Length > 0)
  {
    phoneNum = Convert.ToInt64(phoneNum).ToString(phoneFormat);
  }
  return phoneNum;
} 
```

将您的 phoneNum 作为字符串 2021231234 传递，最多 15 个字符。

```
FormatPhoneNumber(string phoneNum) 
```

另一种方法是使用 Substring

```
private string PhoneFormat(string phoneNum)
    {
      int max = 15, min = 10;
      string areaCode = phoneNum.Substring(0, 3);
      string mid = phoneNum.Substring(3, 3);
      string lastFour = phoneNum.Substring(6, 4);
      string extension = phoneNum.Substring(10, phoneNum.Length - min);
      if (phoneNum.Length == min)
      {
        return $"({areaCode}) {mid}-{lastFour}";
      }
      else if (phoneNum.Length > min && phoneNum.Length <= max)
      {
        return $"({areaCode}) {mid}-{lastFour} x{extension}";
      }
      return phoneNum;
    } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-09-24T21:11:12.790

要解决您的扩展问题，如何：

```
string formatString = "###-###-#### ####";
returnValue = Convert.ToInt64(phoneNumber)
                     .ToString(formatString.Substring(0,phoneNumber.Length+3))
                     .Trim(); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-05-16T03:47:46.093

不是要复活一个老问题，而是想如果设置稍微复杂一点，我可能至少会提供一种更容易使用的方法。

因此，如果我们创建一个新的自定义格式化程序，我们可以使用更简单的格式化，`string.Format`而无需将我们的电话号码转换为`long`

所以首先让我们创建自定义格式化程序：

```
using System;
using System.Globalization;
using System.Text;

namespace System
{
    /// <summary>
    ///     A formatter that will apply a format to a string of numeric values.
    /// </summary>
    /// <example>
    ///     The following example converts a string of numbers and inserts dashes between them.
    ///     <code>
    /// public class Example
    /// {
    ///      public static void Main()
    ///      {          
    ///          string stringValue = "123456789";
    ///  
    ///          Console.WriteLine(String.Format(new NumericStringFormatter(),
    ///                                          "{0} (formatted: {0:###-##-####})",stringValue));
    ///      }
    ///  }
    ///  //  The example displays the following output:
    ///  //      123456789 (formatted: 123-45-6789)
    ///  </code>
    /// </example>
    public class NumericStringFormatter : IFormatProvider, ICustomFormatter
    {
        /// <summary>
        ///     Converts the value of a specified object to an equivalent string representation using specified format and
        ///     culture-specific formatting information.
        /// </summary>
        /// <param name="format">A format string containing formatting specifications.</param>
        /// <param name="arg">An object to format.</param>
        /// <param name="formatProvider">An object that supplies format information about the current instance.</param>
        /// <returns>
        ///     The string representation of the value of <paramref name="arg" />, formatted as specified by
        ///     <paramref name="format" /> and <paramref name="formatProvider" />.
        /// </returns>
        /// <exception cref="System.NotImplementedException"></exception>
        public string Format(string format, object arg, IFormatProvider formatProvider)
        {
            var strArg = arg as string;

            //  If the arg is not a string then determine if it can be handled by another formatter
            if (strArg == null)
            {
                try
                {
                    return HandleOtherFormats(format, arg);
                }
                catch (FormatException e)
                {
                    throw new FormatException(string.Format("The format of '{0}' is invalid.", format), e);
                }
            }

            // If the format is not set then determine if it can be handled by another formatter
            if (string.IsNullOrEmpty(format))
            {
                try
                {
                    return HandleOtherFormats(format, arg);
                }
                catch (FormatException e)
                {
                    throw new FormatException(string.Format("The format of '{0}' is invalid.", format), e);
                }
            }
            var sb = new StringBuilder();
            var i = 0;

            foreach (var c in format)
            {
                if (c == '#')
                {
                    if (i < strArg.Length)
                    {
                        sb.Append(strArg[i]);
                    }
                    i++;
                }
                else
                {
                    sb.Append(c);
                }
            }

            return sb.ToString();
        }

        /// <summary>
        ///     Returns an object that provides formatting services for the specified type.
        /// </summary>
        /// <param name="formatType">An object that specifies the type of format object to return.</param>
        /// <returns>
        ///     An instance of the object specified by <paramref name="formatType" />, if the
        ///     <see cref="T:System.IFormatProvider" /> implementation can supply that type of object; otherwise, null.
        /// </returns>
        public object GetFormat(Type formatType)
        {
            // Determine whether custom formatting object is requested. 
            return formatType == typeof(ICustomFormatter) ? this : null;
        }

        private string HandleOtherFormats(string format, object arg)
        {
            if (arg is IFormattable)
                return ((IFormattable)arg).ToString(format, CultureInfo.CurrentCulture);
            else if (arg != null)
                return arg.ToString();
            else
                return string.Empty;
        }
    }
} 
```

因此，如果您想使用它，您将执行以下操作：

```
String.Format(new NumericStringFormatter(),"{0:###-###-####}", i["MyPhone"].ToString()); 
```

**其他一些需要考虑的事情：**

现在，如果您指定的格式化程序比格式化字符串的时间长，它将忽略额外的 # 符号。例如，这`String.Format(new NumericStringFormatter(),"{0:###-###-####}", "12345");`将导致 123-45- 因此您可能希望它在构造函数中采用某种可能的填充字符。

此外，我没有提供转义 # 符号的方法，因此如果您想将其包含在输出字符串中，您将无法按照现在的方式进行操作。

我更喜欢这种方法而不是正则表达式的原因是我经常要求允许用户自己指定格式，而且我解释如何使用这种格式比尝试教用户正则表达式要容易得多。

此外，类名有点用词不当，因为它实际上可以格式化任何字符串，只要您想保持相同的顺序并在其中注入字符即可。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-08-13T15:57:52.013

如果您的目标编号以 0 开头，您可以尝试 {0: (000) 000-####}。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-09-19T13:20:01.803

```
static void Main(string[] args)
    {
        Regex phonenumber = new(@"([0-9]{11})$");
        Console.WriteLine("Enter a Number: ");
        var number = Console.ReadLine();
        if(number.Length == 11)
        {
            if (phonenumber.IsMatch(number))
            {
                Console.WriteLine("Your Number is: "+number);
            }
            else
                Console.WriteLine("Nooob...");
        }
        else
            Console.WriteLine("Nooob...");
    } 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-08-04T17:52:24.147

```
 Label12.Text = Convert.ToInt64(reader[6]).ToString("(###) ###-#### "); 
```

这是我的例子！我希望能帮助你。问候

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2021-06-07T20:31:03.937

这是带有空检查的@Jon Skeet 答案的改进版本，并具有扩展方法。

```
public static string ToTelephoneNumberFormat(this string value, string format = "({0}) {1}-{2}") {
  if (string.IsNullOrWhiteSpace(value)) 
  {
    return value;
  } 
  else 
  {
    string area = value.Substring(0, 3) ?? "";
    string major = value.Substring(3, 3) ?? "";
    string minor = value.Substring(6) ?? "";
    return string.Format(format, area, major, minor);
  }
} 
```

# sql-server - 如何将 Excel 2007 xlsx 文件中的数据导入 SQL Server 2000 数据库？

> ID：188518
> 
> 赞同：1
> 
> 时间：2008-10-09T18:20:26.980
> 
> 标签：sql-server, windows, sql-server-2000, excel-2007

SQL Server 2000 似乎不支持基于 xml 的 .xlsx 文件类型。除了将文件转换为 97-2003 文件类型之外，我还能如何实现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T18:40:17.797

我最终这样做[了](http://chikachika.wordpress.com/2008/09/08/import-data-from-excel-2007-to-sql-server-2000/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T18:31:17.363

如果您有 Excel 2007，则可能还具有 Access 2007。

您可以创建 Access 2007 Access 数据项目 (.adp) 文件。将此连接到您的 SQL 2000 数据库。然后使用 Access 2007 导入表格功能获取 Excel 2007 数据。

# c - 如何在 C 中的一组函数声明上强制执行函数签名？

> ID：188532
> 
> 赞同：4
> 
> 时间：2008-10-09T18:22:52.153
> 
> 标签：c

我想确保一组函数在某些 C 代码中具有相同的签名。理想情况下，我将能够定义一个描述函数的返回值和参数的新类型，然后使用这个新类型声明我的函数集。

此外，有没有办法为此函数 typedef 的参数指定默认值？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-09T18:26:53.223

```
/* define a typedef for function_t - functions that return void */
/*      and take an  int and char parameter */

typedef void function_t( int param1, char param2);

/* declare some functions that use that signature */

function_t foo;
function_t bar; 
```

现在，当您定义函数时，如果它们不使用与 typedef 中相同的签名，则会出现错误。

```
void foo( int x, char c)
{
    /* do some stuff */

    return;
}

/* this will result in a compiler error */
int bar( int x, char c)
{
    /* do some stuff */

    return 1;
} 
```

* * *

至于您的新问题（2008 年 10 月 20 日添加）：“另外，有没有办法为此函数 typedef 的参数指定默认值？”

不，没有办法将默认参数添加到 typedef。当然不是在 C 中，它根本不支持默认参数。即使在 C++ 中你也不能这样做，因为参数的默认值不是类型的一部分。实际上，从基类覆盖虚拟方法的类可以为默认参数指定不同的值（甚至完全删除默认值）——但是，这通常不应该这样做，因为它只会引起混淆（[http://www.gotw.ca/gotw/005.htm](http://www.gotw.ca/gotw/005.htm)）。

如果您使用的是 C++，您可能能够使用以下之一（或组合）获得您想要的行为：

*   抽象基类
*   重载
*   模板函数
*   宏

但是，如果不了解您正在尝试完成的更多细节，就很难提出建议。而且我认为结果很可能很糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T18:28:30.753

这类似于函数指针的工作方式：

```
 // Declaration of function with int arg returning int
 typedef int (*CALLBACK)(int);

 //Definition
 int myFunc(int arg)
 {
     return 0;
 }

 // Function pointer usage
 CALLBACK pFunc = myFunc; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T18:29:37.647

我认为您不能直接执行此操作，但您可以声明一个函数指针类型，然后将所有函数收集到一个数组中。编译器会让你知道哪些不匹配。

```
typedef void (*MethodSig)(int, int);

static MethodSig x[] = { fnA, fnB, ... }; 
```

或者使用宏来声明函数签名

```
#define MyFunc(X)  void X(int a, int b) 
```

这样他们都将是一样的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T18:34:08.450

您不能真正阻止任何人使函数具有任何签名。但是你可以控制你会调用什么。所以我认为这就是你想要的。

让将调用任意函数的函数将指向函数的指针作为参数。既然您提到了 typedef，您可以在程序的前面定义一个 typedef，如下所示：

**假设您只需要签名“unsigned short id_for_allowed_functions (int x, char* y)”的函数：**

```
typedef unsigned short (*id_for_allowed_functions)(int, char*); 
```

然后，您的调用函数：

```
void calling_function (id_for_allowed_function x) { (*x)(3, "bla"); } 
```

并为其提供功能 foo ：

```
unsigned short foo(int x, char* y) { /* ... */ }
calling_function(&foo); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-12T11:27:16.773

这是一个创建映射到简单字符串的函数列表的示例。

首先是typedef：

```
typedef GenList *(*DBLISTLOADER)(Database *pDB, char *quellCD, char *profilName);
typedef ObjDescription *(*DBCOLUMNLOADER)();

typedef struct dbinfo
{
    char *dbName;
    DBLISTLOADER dbListLoader;
    DBCOLUMNLOADER dbColumnLoader;
    char *options;
} DBINFO; 
```

然后映射表：

```
DBINFO dbInfoList[] =
{
   { "SRCDOC",   loadSRCDOC,      colSRCDOC,      "q"  },
   { "PRF_CD",   loadPRF_CD,      colPRF_CD,      ""   },
   { "MEDIA",    loadMEDIA,       colMEDIA,       ""   },

   { NULL,       NULL,            NULL }
}; 
```

现在从该表中查找一个函数并调用它：

```
while (dbInfoList[i].dbName != NULL)
{
    if (strcmp(dbInfoList[i].dbName, szDatabase) == 0)
    {
        return (dbInfoList[i].dbListLoader)(pDB, quellCD, profilName);
    }

    i++;
} 
```

对不起，如果它有点“原始”。直接从我们的代码粘贴；-)

# regex - 用于从 RTF 字符串中提取文本的正则表达式

> ID：188545
> 
> 赞同：44
> 
> 时间：2008-10-09T18:24:41.607
> 
> 标签：regex, rtf

我正在寻找一种从 RTF 字符串中删除文本的方法，我发现了以下正则表达式：

```
({\\)(.+?)(})|(\\)(.+?)(\b) 
```

然而，结果字符串有两个直角括号“}”

**前：** `{\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fnil\fcharset0 MS Shell Dlg 2;}{\f1\fnil MS Shell Dlg 2;}} {\colortbl ;\red0\green0\blue0;} {\*\generator Msftedit 5.41.15.1507;}\viewkind4\uc1\pard\tx720\cf1\f0\fs20 can u send me info for the call pls\f1\par }`

**后：** `} can u send me info for the call pls }`

关于如何改进正则表达式的任何想法？

**编辑：** 一个更复杂的字符串，比如这个不起作用： `{\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fnil\fcharset0 MS Shell Dlg 2;}} {\colortbl ;\red0\green0\blue0;} {\*\generator Msftedit 5.41.15.1507;}\viewkind4\uc1\pard\tx720\cf1\f0\fs20 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\test\\myapp\\Apps\\\{3423234-283B-43d2-BCE6-A324B84CC70E\}\par }`

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-10-09T19:42:06.363

在 RTF 中，{ 和 } 标记一个组。组可以嵌套。\ 标记控制字的开始。控制字以空格或非字母字符结尾。控制字可以有一个数字参数，其间没有任何分隔符。一些控制字也带有文本参数，用';'分隔。这些控制词通常在它们自己的组中。

我想我已经设法制作了一个可以处理大多数情况的模式。

```
\{\*?\\[^{}]+}|[{}]|\\\n?[A-Za-z]+\n?(?:-?\d+)?[ ]? 
```

但是，在您的模式上运行时，它会留下一些空格。

* * *

通过[RTF 规范](http://www.microsoft.com/downloads/details.aspx?FamilyId=DD422B8D-FF06-4207-B476-6B5396A18A2B&displaylang=en)（其中一些），我发现纯正则表达式的剥离器存在很多陷阱。最明显的一个是应该忽略某些组（页眉、页脚等），而应该呈现其他组（格式化）。

我编写了一个 Python 脚本，它应该比我上面的正则表达式工作得更好：

```
def striprtf(text):
   pattern = re.compile(r"\\([a-z]{1,32})(-?\d{1,10})?[ ]?|\\'([0-9a-f]{2})|\\([^a-z])|([{}])|[\r\n]+|(.)", re.I)
   # control words which specify a "destionation".
   destinations = frozenset((
      'aftncn','aftnsep','aftnsepc','annotation','atnauthor','atndate','atnicn','atnid',
      'atnparent','atnref','atntime','atrfend','atrfstart','author','background',
      'bkmkend','bkmkstart','blipuid','buptim','category','colorschememapping',
      'colortbl','comment','company','creatim','datafield','datastore','defchp','defpap',
      'do','doccomm','docvar','dptxbxtext','ebcend','ebcstart','factoidname','falt',
      'fchars','ffdeftext','ffentrymcr','ffexitmcr','ffformat','ffhelptext','ffl',
      'ffname','ffstattext','field','file','filetbl','fldinst','fldrslt','fldtype',
      'fname','fontemb','fontfile','fonttbl','footer','footerf','footerl','footerr',
      'footnote','formfield','ftncn','ftnsep','ftnsepc','g','generator','gridtbl',
      'header','headerf','headerl','headerr','hl','hlfr','hlinkbase','hlloc','hlsrc',
      'hsv','htmltag','info','keycode','keywords','latentstyles','lchars','levelnumbers',
      'leveltext','lfolevel','linkval','list','listlevel','listname','listoverride',
      'listoverridetable','listpicture','liststylename','listtable','listtext',
      'lsdlockedexcept','macc','maccPr','mailmerge','maln','malnScr','manager','margPr',
      'mbar','mbarPr','mbaseJc','mbegChr','mborderBox','mborderBoxPr','mbox','mboxPr',
      'mchr','mcount','mctrlPr','md','mdeg','mdegHide','mden','mdiff','mdPr','me',
      'mendChr','meqArr','meqArrPr','mf','mfName','mfPr','mfunc','mfuncPr','mgroupChr',
      'mgroupChrPr','mgrow','mhideBot','mhideLeft','mhideRight','mhideTop','mhtmltag',
      'mlim','mlimloc','mlimlow','mlimlowPr','mlimupp','mlimuppPr','mm','mmaddfieldname',
      'mmath','mmathPict','mmathPr','mmaxdist','mmc','mmcJc','mmconnectstr',
      'mmconnectstrdata','mmcPr','mmcs','mmdatasource','mmheadersource','mmmailsubject',
      'mmodso','mmodsofilter','mmodsofldmpdata','mmodsomappedname','mmodsoname',
      'mmodsorecipdata','mmodsosort','mmodsosrc','mmodsotable','mmodsoudl',
      'mmodsoudldata','mmodsouniquetag','mmPr','mmquery','mmr','mnary','mnaryPr',
      'mnoBreak','mnum','mobjDist','moMath','moMathPara','moMathParaPr','mopEmu',
      'mphant','mphantPr','mplcHide','mpos','mr','mrad','mradPr','mrPr','msepChr',
      'mshow','mshp','msPre','msPrePr','msSub','msSubPr','msSubSup','msSubSupPr','msSup',
      'msSupPr','mstrikeBLTR','mstrikeH','mstrikeTLBR','mstrikeV','msub','msubHide',
      'msup','msupHide','mtransp','mtype','mvertJc','mvfmf','mvfml','mvtof','mvtol',
      'mzeroAsc','mzeroDesc','mzeroWid','nesttableprops','nextfile','nonesttables',
      'objalias','objclass','objdata','object','objname','objsect','objtime','oldcprops',
      'oldpprops','oldsprops','oldtprops','oleclsid','operator','panose','password',
      'passwordhash','pgp','pgptbl','picprop','pict','pn','pnseclvl','pntext','pntxta',
      'pntxtb','printim','private','propname','protend','protstart','protusertbl','pxe',
      'result','revtbl','revtim','rsidtbl','rxe','shp','shpgrp','shpinst',
      'shppict','shprslt','shptxt','sn','sp','staticval','stylesheet','subject','sv',
      'svb','tc','template','themedata','title','txe','ud','upr','userprops',
      'wgrffmtfilter','windowcaption','writereservation','writereservhash','xe','xform',
      'xmlattrname','xmlattrvalue','xmlclose','xmlname','xmlnstbl',
      'xmlopen',
   ))
   # Translation of some special characters.
   specialchars = {
      'par': '\n',
      'sect': '\n\n',
      'page': '\n\n',
      'line': '\n',
      'tab': '\t',
      'emdash': u'\u2014',
      'endash': u'\u2013',
      'emspace': u'\u2003',
      'enspace': u'\u2002',
      'qmspace': u'\u2005',
      'bullet': u'\u2022',
      'lquote': u'\u2018',
      'rquote': u'\u2019',
      'ldblquote': u'\201C',
      'rdblquote': u'\u201D', 
   }
   stack = []
   ignorable = False       # Whether this group (and all inside it) are "ignorable".
   ucskip = 1              # Number of ASCII characters to skip after a unicode character.
   curskip = 0             # Number of ASCII characters left to skip
   out = []                # Output buffer.
   for match in pattern.finditer(text):
      word,arg,hex,char,brace,tchar = match.groups()
      if brace:
         curskip = 0
         if brace == '{':
            # Push state
            stack.append((ucskip,ignorable))
         elif brace == '}':
            # Pop state
            ucskip,ignorable = stack.pop()
      elif char: # \x (not a letter)
         curskip = 0
         if char == '~':
            if not ignorable:
                out.append(u'\xA0')
         elif char in '{}\\':
            if not ignorable:
               out.append(char)
         elif char == '*':
            ignorable = True
      elif word: # \foo
         curskip = 0
         if word in destinations:
            ignorable = True
         elif ignorable:
            pass
         elif word in specialchars:
            out.append(specialchars[word])
         elif word == 'uc':
            ucskip = int(arg)
         elif word == 'u':
            c = int(arg)
            if c < 0: c += 0x10000
            if c > 127: out.append(unichr(c))
            else: out.append(chr(c))
            curskip = ucskip
      elif hex: # \'xx
         if curskip > 0:
            curskip -= 1
         elif not ignorable:
            c = int(hex,16)
            if c > 127: out.append(unichr(c))
            else: out.append(chr(c))
      elif tchar:
         if curskip > 0:
            curskip -= 1
         elif not ignorable:
            out.append(tchar)
   return ''.join(out) 
```

它通过解析 RTF 代码并跳过指定了“目的地”的任何组以及所有“可忽略”组 ( `{\*`... `}`) 来工作。我还添加了一些特殊字符的处理。

缺少许多功能使其成为完整的解析器，但对于简单的文档来说应该足够了。

**更新：**此 url 已更新此脚本以在 Python 3.x 上运行：

[https://gist.github.com/gilsondev/7c1d2d753ddb522e7bc22511cfb08676](https://gist.github.com/gilsondev/7c1d2d753ddb522e7bc22511cfb08676)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T19:08:01.753

我以前用过这个，它对我有用：

```
\\\w+|\{.*?\}|} 
```

您可能希望修剪结果的末端以去除剩余的多余空格。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-26T16:17:45.223

到目前为止，除了使用 RichTextBox 控件外，我们还没有找到一个好的答案：

```
 /// <summary>
    /// Strip RichTextFormat from the string
    /// </summary>
    /// <param name="rtfString">The string to strip RTF from</param>
    /// <returns>The string without RTF</returns>
    public static string StripRTF(string rtfString)
    {
        string result = rtfString;

        try
        {
            if (IsRichText(rtfString))
            {
                // Put body into a RichTextBox so we can strip RTF
                using (System.Windows.Forms.RichTextBox rtfTemp = new System.Windows.Forms.RichTextBox())
                {
                    rtfTemp.Rtf = rtfString;
                    result = rtfTemp.Text;
                }
            }
            else
            {
                result = rtfString;
            }
        }
        catch
        {
            throw;
        }

        return result;
    }

    /// <summary>
    /// Checks testString for RichTextFormat
    /// </summary>
    /// <param name="testString">The string to check</param>
    /// <returns>True if testString is in RichTextFormat</returns>
    public static bool IsRichText(string testString)
    {
        if ((testString != null) &&
            (testString.Trim().StartsWith("{\\rtf")))
        {
            return true;
        }
        else
        {
            return false;
        }
    } 
```

编辑：添加了 IsRichText 方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-16T04:02:11.410

我制作了这个辅助函数来在 JavaScript 中执行此操作。到目前为止，这对我来说对于简单的 RTF 格式删除效果很好。

```
function stripRtf(str){
    var basicRtfPattern = /\{\*?\\[^{}]+;}|[{}]|\\[A-Za-z]+\n?(?:-?\d+)?[ ]?/g;
    var newLineSlashesPattern = /\\\n/g;
    var ctrlCharPattern = /\n\\f[0-9]\s/g;

    //Remove RTF Formatting, replace RTF new lines with real line breaks, and remove whitespace
    return str
        .replace(ctrlCharPattern, "")
        .replace(basicRtfPattern, "")
        .replace(newLineSlashesPattern, "\n")
        .trim();
} 
```

* * *

**注意：**

*   我稍微修改了上面*@Markus Jarderot*编写的正则表达式。它现在分两步删除新行末尾的斜杠，以避免更复杂的正则表达式。
*   `.trim()`仅在较新的浏览器中受支持。如果您需要支持这些，请参阅：[Trim string in JavaScript?](https://stackoverflow.com/questions/498970/how-do-i-trim-a-string-in-javascript)

* * *

编辑：我已经更新了正则表达式来解决我最初发布后发现的一些问题。我在一个项目中使用它，在这里的上下文中查看它：[https ://github.com/chrismbarr/LyricConverter/blob/865f17613ee8f43fbeedeba900009051c0aa2826/scripts/parser.js#L26-L37](https://github.com/chrismbarr/LyricConverter/blob/865f17613ee8f43fbeedeba900009051c0aa2826/scripts/parser.js#L26-L37)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-15T10:00:49.663

正则表达式永远不会 100% 解决这个问题，你需要一个解析器。在 CodeProject 中检查这个实现（虽然它在 C# 中）： http: [//www.codeproject.com/Articles/27431/Writing-Your-Own-RTF-Converter](http://www.codeproject.com/Articles/27431/Writing-Your-Own-RTF-Converter)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-09T18:53:34.557

根据[RegexPal](http://regexpal.com)，这两个 } 是下面加粗的：

> {\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fnil\fcharset0 MS Shell Dlg 2;}{\f1\fnil MS Shell Dlg 2;} **}** {\colortbl ;\red0\green0\blue0; } {\generator Msftedit 5.41.15.1507;}\viewkind4\uc1\pard\tx720\cf1\f0\fs20 可以给我发送通话信息吗 pls\f1\par **}**

我能够通过在正则表达式中添加一个加号来修复第一个花括号：

```
({\\)(.+?)(}+)|(\\)(.+?)(\b)
            ^
     plus sign added here 
```

为了在最后修复花括号，我这样做了：

```
({\\)(.+?)(})|(\\)(.+?)(\b)|}$
                            ^
         this checks if there is a curly brace at the end 
```

我不太了解 RTF 格式，所以这可能不适用于所有情况，但它适用于您的示例......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-24T11:54:15.640

后期贡献者，但下面的正则表达式帮助我们处理了我们在数据库中找到的 RTF 代码（我们通过 SSRS 在 RDL 中使用它）。

这个表达式为我们的团队删除了它。虽然它可能只是解决我们特定的 RTF，但它可能对某人有帮助。虽然这个 webby 对于现场测试来说非常方便。

[http://regexpal.com/](http://regexpal.com/)

```
{\*?\\.+(;})|\s?\\[A-Za-z0-9]+|\s?{\s?\\[A-Za-z0-9]+\s?|\s?}\s? 
```

希望这有帮助，K

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-09T13:44:38.220

以下解决方案允许您从 RTF 字符串中提取文本：

```
FareRule = Encoding.ASCII.GetString(FareRuleInfoRS.Data);
    System.Windows.Forms.RichTextBox rtf = new System.Windows.Forms.RichTextBox();
    rtf.Rtf = FareRule;
    FareRule = rtf.Text; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-09T21:10:29.603

没有一个答案是足够的，所以我的解决方案是使用 RichTextBox 控件（是的，即使在非 Winform 应用程序中）从 RTF 中提取文本

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-03T06:54:53.927

下面是一个可以从 Oracle 字段中去除 RTF 的 Oracle SQL 语句：

```
SELECT REGEXP_REPLACE(
    REGEXP_REPLACE(
        CONTENT,
        '\\(fcharset|colortbl)[^;]+;', ''
    ),
    '(\\[^ ]+ ?)|[{}]', ''
) TEXT
FROM EXAMPLE WHERE CONTENT LIKE '{\rtf%'; 
```

这是为来自 Windows 富文本控件的数据设计的，而不是 RTF 文件。限制是：

*   `\{``\}`不替换`{`为and`}`
*   页眉和页脚没有特别处理
*   图像和其他嵌入对象没有经过特殊处理（不知道如果遇到其中之一会发生什么！）

它的工作原理是首先删除`\fcharset`and`\colourtbl`标记，这是特殊的，因为数据跟随它们直到`;`到达。然后它删除所有`\xxx`标签（包括一个可选的尾随空格），然后是所有的`{`和`}`字符。这可以处理最简单的 RTF，例如从富文本控件中获得的内容。

# java - Eclipse 从文件中读取标准输入（System.in）

> ID：188547
> 
> 赞同：68
> 
> 时间：2008-10-09T18:25:03.103
> 
> 标签：java, eclipse, file, stdin, system.in

Eclipse 是否可以从文件中读取标准输入？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-09T18:49:46.767

### 纯Java

您可以使用一行代码重定向 System.in：

```
System.setIn(new FileInputStream(filename)); 
```

请参阅[System.setIn()](http://docs.oracle.com/javase/8/docs/api/java/lang/System.html#setIn-java.io.InputStream-)。

### Eclipse 配置

在 Eclipse 4.5 或更高版本中，启动配置对话框可以将 System.in 设置为从文件中读取。请参阅[此处的公告](http://www.eclipse.org/mars/noteworthy/#_assigning_stdin_to_a_file)。

[![启动配置对话框的常用选项卡](https://i.stack.imgur.com/63POd.png)](https://i.stack.imgur.com/63POd.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-05-14T19:44:50.407

**[更新]**正如评论中指出的那样，这个答案具有误导性，因此我对其进行了更新以纠正错误。**[/更新]**

在 bash 或命令提示符下，您可以执行以下操作： `C:\myprogramm < file.txt`(Windows) 或`./myprogramm < file.txt` (Linux)

不幸的是，在 Eclipse 中无法获得相同的结果，因为没有选项可以将标准输入绑定到 Eclipse 中的文件。相反，您必须在代码中手动打开文件流，然后从中读取。一种方法是使用程序参数来启用它，另一种方法是使用文件参数。请参阅 Scott 关于需要添加哪种代码来解析程序参数数组中的 -d 选项的答案。

当您想指向 Eclipse 项目中的某个文件时，您需要小心获取正确的位置并使用 ${resource_loc:} 变量：

```
-d ${resource_loc:/MyProject/file} 
```

当然你也可以放一个绝对路径：

```
-d path/to/file or -d C:\path\to\file 
```

resource_loc 参数指的是您的工作区。那是您存储所有 Eclipse 项目的文件夹。从那里您仍然必须引用您的项目文件夹，然后是您要加载的文件。

您可能需要调整斜线方向，具体取决于您使用的是 Linux 还是 Winodws。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-07-08T08:50:18.237

# 2015 年更新

有一个新的 Eclipse 版本，Eclipse 4.5 (Mars) 已经解决[了这个问题](https://bugs.eclipse.org/bugs/show_bug.cgi?id=155411)！

这是该功能的公告和描述：http: [//eclipse.org/mars/noteworthy/#_assigning_stdin_to_a_file](http://eclipse.org/mars/noteworthy/#_assigning_stdin_to_a_file)

> 现在可以将标准输入分配给启动配置对话框 的**通用选项卡中的文件。**![在此处输入图像描述](https://i.stack.imgur.com/WCWSD.png)

正如预期的那样，这是刚刚发布的 eclipse 4.5 的一项新功能，因此在旧版本中将无法使用。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-09T19:39:49.923

在运行对话框的“通用”选项卡上，在“标准输入和输出”下有一个“文件”复选框。但它似乎只用于输出......

我希望在那里看到 2 个文件字段，一个用于标准输入，一个用于带有附加选项的标准输出。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-06-08T23:26:50.343

您需要对代码进行一些调整以使其在 eclipse 中工作。当我尝试时，上面的其他答案不起作用。另一个我看到说要更改 Run..>Common tab>Standard Input and Output>File 仅将 stdout 行为更改为文件，而不是输入。

解决方案是将“-d”选项作为一个可行的解决方案。如果你在程序参数中放入任何东西，它只会被传递到你的 main.js 中。所以你可以在 main 开头做的是这样的：

```
 Scanner in;
    if (args!=null && args.length>0 && args[0].equals("-d")){
        in = new Scanner(new File(args[1]));
    } else {
        in = new Scanner(System.in);
    } 
```

您仍然需要在 Run.. 菜单中设置程序参数，如[本](https://stackoverflow.com/a/6004393/311525)答案中所述。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-05-18T08:37:37.643

我的解决方案（在 Mac 上运行，对 C 应用程序使用 Eclipse CDT）是在“运行配置”对话框的“参数”选项卡中的其他参数末尾添加“< path/to/somefile”。

还要检查this [other question](https://stackoverflow.com/questions/1580758/javaeclipse-how-do-you-debug-a-java-program-that-is-receiving-piped-redirected)以获取涉及在挂起状态下启动Java程序然后使用Eclipse附加调试器的答案。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-09T19:17:09.970

我没有看到使用标准 Eclipse 运行对话框的好方法。但是，您可以使用外部工具启动器来执行此操作，并使用标准的“< infile”语法或调用 .bat/.sh 脚本为您执行此操作。

它不是自动化的，这正是我猜你想要的，但你可以在启动程序时将 infile 的内容复制并粘贴到 Eclipse 控制台。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-03T17:52:24.380

```
< ${workspace_loc:/MyProject/file} 
```

在调试配置/参数/程序参数中：

很适合我。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-11-04T12:45:14.067

对于 linux：我认为，最简单的方法是编写一个 sh-script。

1）像这样写run.sh：

*你的程序带有 params* < input.txt

2) 在 Eclipse 配置文件中指定

[选项卡主] C++ 运行应用程序 = /bin/sh

[选项卡参数] 程序参数 = run.sh

而已。当您将运行您的项目时，您将在 Eclipse 控制台中看到脚本的输出。您可以在 Windows 中执行类似的操作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-03-09T21:24:44.520

令人惊讶的是，Eclipse 不支持它，而且目前似乎没有添加它的计划。请参阅[https://bugs.eclipse.org/bugs/show_bug.cgi?id=155411](https://bugs.eclipse.org/bugs/show_bug.cgi?id=155411)关注并投票。

如果他们确实实施了，我会在这里更新。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-25T23:33:38.157

我所做的是创建一个 Ant 目标并从 Eclipse 以“Run External”的形式启动它，步骤如下：

*   我有一个要读取的输入文件：`res\in.txt`和一个用于输出的文件：`res\out.txt`
*   使用您需要的目标创建一个`build.xml`（这只是一个示例）：

    ```
    <project basedir="." default="run" name="Tests">
    <target name="clean">
    <delete dir="bin"/>
    </target>

    <target name="compile">
    <mkdir dir="bin"/>
    <javac srcdir="src" destdir="bin" includeantruntime="false"/>
    </target>

    <target name="build" depends="clean,compile"/>

    <target name="run" depends="build">
    <java classname="Main" input="res\in.txt" output="res\out.txt" classpath="bin" />
    </target>
    </project> 
    ```

*   在 Eclipse 中转到：`Run->External Tools->External Tools Configurations->Ant Build-> New Launch Configuration`使用以下配置：

`Section Main`

构建文件：`${workspace_loc:/Tests/build.xml}`

基本目录：`${workspace_loc:/Tests}`

*注意：Tests 是我的 Eclipse 项目的名称

现在您可以通过单击 Run Extenal 工具栏按钮来运行您的项目，并根据需要更改输入或输出文件

# agile - 您（开发人员）如何处理不明确的需求和多个代理 PO？

> ID：188549
> 
> 赞同：9
> 
> 时间：2008-10-09T18:25:43.087
> 
> 标签：agile, scrum

这是另一个试图弄清楚 Scrum 在现实生活中如何/应该如何工作的问题。这是我遇到的一个典型场景：

注意：下面不使用术语“产品所有者”。那是因为真正的“产品负责人”——在这种情况下是产品经理——不会做出最终决定。DB Lead 在决定应用程序如何与 DB 交互时对许多事情有最终决定权。QA 对事物的外观/工作方式有自己的想法 - 并且他们的想法作为错误输入，并且通常（每个人）都希望被这样对待。

1.  产品经理写了这样一个故事“X 用户需要一个页面来做 Y”。
2.  在 sprint 计划会议上，故事被添加到 sprint backlog 中。
3.  一些可怜的开发人员抓住（或分配）了这个故事。
4.  开发人员询问产品经理“您希望页面是什么样的”。
5.  产品经理（如果有的话）说：“嗯，好吧，它需要收集 A、B 和 C。”
6.  开发人员开始对它应该是什么样子进行最佳猜测。
7.  开发人员尝试将页面连接到存储过程并询问数据库领导一些问题。DB 负责人说“Page 也需要 D 和 E。不应该需要 B”。
8.  开发人员进行更改并提交。
9.  QA 说“我认为 E 令人困惑”。
10.  开发人员必须努力让 QA、DB 负责人和产品经理就最终页面的内容达成一致。

我的理解（根据我们对 scrum 的学习方式）是开发人员有责任充实页面的需求。在我们的环境中，如上所示，这给开发人员带来了令人沮丧的体验，并且在等待获得所有权力以就需求做出统一决定时浪费了大量时间。

有时可能需要数小时才能确定 2 小时任务的要求！与 1 人相处已经够难的了 - 3 人就更难了！

我知道这是反 Scrum，但在我看来，产品经理、数据库主管和 QA 团队应该在计划会议之前开会，并讨论要添加到 sprint 的任务的细节。（开发人员很少考虑任何输入，当我们在会议中尝试这样做时，可能需要一整天 - 不是开玩笑 - 才能为积压中的所有项目列出所有细节。）

有没有人处理过这个？有什么建议么？我不想啰嗦太久，所以如果您需要更多详细信息，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T21:41:58.603

> 那是因为真正的“产品负责人”——在这种情况下是产品经理——不会做出最终决定。

这正是你的问题。Scrum 说

> 产品负责人不是一个人，而是一个角色。每个人都可以成为产品负责人。

如果您的产品经理无法做出这些决定，恕我直言，他不是产品负责人。在这种情况下，找到**可以**做出这些决定的人，因为这是您*真正的*产品所有者。

作为开发人员（scrum 中的“团队”角色），我只需要了解产品负责人对这个功能的期望。他是所有者，他向我解释了页面的外观，我将根据他的描述进行制作。数据库负责人不是产品所有者。QA 不是产品所有者。我按照产品负责人的要求制作了页面，如果数据库负责人或 QA 对此有疑问，他们应该与产品负责人交谈。或者实际上产品负责人应该提前与他们交谈。

另外，如果 DB 负责人和 QA 也以某种方式为产品负责人服务，为什么他们没有参加 sprint 计划会议？在那种情况下，当产品经理说 A、B 和 C 时，他们可能会立即喊出“反对”。DB 负责人可能会说他需要 D 和 E，而 B 不应该在那里。QA 可以说，他们认为 E 令人困惑。只要在冲刺之后最终必须批准我的实施的人甚至不同意他们想要拥有的东西，我根本不会碰这个东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T18:44:23.797

我注意到的一些事情...

1）您提到开发人员提取用户故事

确实应该在计划期间将其分解为任务。

2）您提到要花一整天的时间才能解决问题。

Sprint 计划*可能*需要一整天的时间。你最好一次性花费这些时间并获得足够的信息以朝着正确的方向前进，而不是花费大量时间重新散列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T17:26:24.690

几个建议：

**上下文**：“X 用户需要一个页面来执行 Y”缺少上下文。我喜欢这样的框架“作为一个 XI 想要做 Y，所以我可以 Z”。它略有不同，但 Z 部分添加了用户尝试完成的内容的上下文。

**验收标准**：你没有提到验收标准。故事应该包括一个验收标准列表，以表明故事何时完成。我喜欢这样的措辞“给定 X，当 Y，然后是 Z”（例如，“**假设**X 用户已登录并且银行余额为正，**当**他导航到 Y 页面时，**他**会在余额旁边看到一个笑脸”。通常，会有这些验收标准的清单。

我想你会发现，当产品经理被迫定义验收标准时，他/她会更好地了解他/她想要通过故事完成什么，并且可以更详细地传达它。*另外：我还发现测试人员审查可测试性*问题的验收标准很有帮助。

**What vs. How**：听起来你在迭代过程中仍在争论需要完成什么*。*INVEST* 故事标准中的可协商性概念更适用于故事的实施*方式。*在故事添加到迭代之前应该已经定义的内容*。*

*INVEST - 独立、可协商、有价值、可评估、小型、可测试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T19:02:45.723

我的建议是让 PO 在决定什么是预期行为方面成为任务的所有者。这可能意味着要经历十几个或更多奇怪的情况，其中构建的系统允许 Y 也必须做一些事情，以防 Z 关闭或 W 没有及时响应等。

虽然充实细节可能是开发人员的工作，但这只是向适当的人提出问题。PO 应该说“哦，对不起，我现在确实想要 D 和 E”，因为流程的一部分是处理不断变化的需求，因此关键在于结果而不是 101 步骤已完成以使产品的新版本为冲刺结束做好准备。

另一种选择是让团队负责人或小组经理，如果在一家大公司，开发人员的经理应该与项目分开，成为你可以说的资源，“我想做 D，但需要更多细节并且似乎无法安排与 PO 的会面，”并希望此人好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T22:18:30.400

问题不在于“Scrum 与现实世界的冲突”。问题是“尽管存在其他问题，但我希望 Scrum 能带来好的东西”。

您的问题的根本原因是有人不想等待利益相关者。其他一切都是解决此问题的方法。让开发人员早早地从一个不完整的故事开始会导致开发人员、DBA 和 QA 之间的不愉快的舞蹈。早点开始是 - 嗯 - 没有帮助。

如果你有一个可靠、一致的用户故事，DBA 和 QA 就无法发号施令。只要你有细节，你就可以胜过他们的意见。

您不能责怪您当前的流程（或一般的 Scrum），因为您没有来自利益相关者的可靠用户故事。

> 有时可能需要数小时才能确定 2 小时任务的要求！与 1 人相处已经够难的了 - 3 人就更难了！

你让这听起来像是一件坏事。2 天的谈话确定要求，然后是 2 小时的技术工作是一个很好的比例。这表明，关心和思考。这表明你在做正确的事。

小心强加旨在让开发人员忙碌的临时任务，以免他开始用剪刀跑。

如果要花几天时间才能把故事讲好，那么，我能说什么呢？这需要几天时间。度过这些日子。这就是它所需要的。

不要因为开发人员不编码而责骂他们。第一个开始编码的人输了。

**解决方案**

当 PO 无法设想由软件赋能的未来状态时，您需要在流程中引入具有技术远见的人。有时他们称这个角色为“业务分析师”。一些业务分析师是壁橱设计师和建筑师。解雇他们。一些业务分析师可以帮助 PO 明确由新软件支持的新工作方式的愿景。奖励他们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T04:43:48.970

听起来您在混淆 Scrum 和 XP 的[Planning Game](http://extremeprogramming.org/rules/planninggame.html)。当然，您可以根据组织的需要调整方法，但即使作为 XP 规划游戏，我认为它也没有抓住重点。

规划游戏或 Sprint 规划的基本前提是开发人员或“猪”（包括 DB Lead 和 QA）正在放弃权利，将产品的“什么”和“何时”指定给利益相关者或“鸡”（产品经理）。因此，那些能够指定“什么”的人事先开会讨论要提交的细节或优先事项，这当然不是“反 Scrum”。

正如[我在这里回答](https://stackoverflow.com/questions/126369/in-scrum-where-does-the-detail-sit#126400)的那样，详细信息在 Sprint backlog 中填写。这可能是用户故事的形式，但 Sprint Backlog 更多地切入设计和任务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T18:29:35.277

你可能不需要在所有事情的计划会议之前开会，但只有在发现冲突时才开会。与所有利益相关者快速开会并做出每个人都同意的决定可能是最简单的。

仅仅因为你进行了 scrum，并不意味着你不应该在之后举行更小、更有针对性的会议。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T18:36:40.007

开发人员有责任确保他完全理解在 givrn 任务中他需要做什么。如果某些要求不清楚，您必须要求澄清，直到开发人员和他的同事/经理都完全了解需要做什么。

您应该提出诸如“我们如何定义此任务的成功执行”或“客户如何期望它”等问题。

开发人员应确保在迭代计划会议结束之前，他完全了解下一个周期需要做什么。如果某些要求仍不清楚，则应在 SCRUM 会议中将其作为阻碍您实现目标的事情来解决。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T19:20:50.837

*呃，首先与所有利益相关者交谈*，然后设计/实施故事不是更简单吗？

编辑：根据评论和对原始问题的更仔细阅读，我认为您可能一直在称您的流程为“敏捷”或“Scrum”，但实际上并非如此。根据您的原始观点，这就是我认为出了问题的地方 [警告：我对 scrum 不是很熟悉，但我已经使用 XP 好几年了]：

1.  产品经理写了这样一个故事“X 用户需要一个页面来做 Y”。

    *   产品经理不是客户，他也不是开发人员。用户故事应该由*客户和开发人员*编写。所以，这一步不是 XP/Agile，这是瀑布。如果“用户X”需要一个页面来做“Y”，那么*你和用户X*必须写关于Y的故事。只有这样，开发者和用户才能对故事有一个共同的理解，这就是用户的全部意义。故事。PM 说“去写一个页面让用户 X 做 Y”不是一个故事，而是一个任务。所以，看起来你的团队从一开始就掉队了。
2.  在 sprint 计划会议上，故事被添加到 sprint backlog 中。

    *   所以现在 sprint backlog 实际上只是 PM 创建的任务列表。你已经被我的朋友吓坏了，这不是敏捷方法，这是伪装成敏捷方法的传统项目管理。
3.  一些可怜的开发人员抓住（或分配）了这个故事。

    *   让我们看看，因为故事是对话的占位符，而让开发人员和客户一起编写故事的目的是提供对话基础的相互理解，然后随机分配一个故事（这实际上是一个 PM任务）给没有进行过这种对话的开发人员同样不敏捷 - 这只是任务分配，在所有程序员都是可互换的机器中的齿轮假设下，这当然是荒谬的
4.  开发人员询问产品经理“您希望页面是什么样的”。

5.  产品经理（如果有的话）说：“嗯，好吧，它需要收集 A、B 和 C。”

    *   再一次，PM 不是客户；谁在乎 PM 对页面的看法？重要的是用户 X 对页面的看法。
6.  开发人员开始对它应该是什么样子进行最佳猜测。

我现在要停下来，因为我越来越沮丧。这不是敏捷，这很荒谬：

*   客户不参与故事
*   开发者不参与故事
*   没有发生开发人员与客户的对话
*   总理正在编造事情
*   随机的开发人员被交给了由 PM 组成的任务

这应该以何种方式成为敏捷方法？称它为敏捷并不能做到这一点——这完全是关于方法的原则，而不是术语。难怪这个过程失败了！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T19:34:48.313

我还没有做过 scrum（尽管我已经研究过它并且喜欢它），但在我看来，如果用户故事真的像你所说的那样准系统，那么 PM 就没有做好他们的工作。至于度过一天的实用性：召集一次与所有 3 方的会议并一起讨论，而不是试图成为中间人。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T19:45:43.157

> 我的理解（根据我们对 scrum 的学习方式）是开发人员有责任充实页面的需求。

是和否。

是的，如果您可以自己从头到尾执行任务。

不，如果您的代码与其他人的代码交互，或者用户的 I/O 是面对面的，那么您需要就代码/用户界面的规范达成一致。最重要的是，什么不能做，以及如何在必要时解决它。

> 在我们的环境中，如上所示，这给开发人员带来了令人沮丧的体验，并且在等待获得所有权力以就需求做出统一决定时浪费了大量时间。

我完全知道那是什么感觉！你不是碰巧在我这里工作吗？:)

这是我必须经历的一个真实世界的例子：

*   设计师预先设计了一个 UI 页面。它是关于显示分层的 HTML 页面，并在顶部和右侧有按钮，有点像选项卡式对话框，但两侧都有选项卡。样机看起来不错，看起来很合理，没有什么大问题。伴随着一些关于这个对话框可以做什么等的详细描述。似乎一切都已经完成并说完了。
*   设计师实际上给了我在我们的数据库中实现数据结构的任务。这是不寻常的，但已通知 Scrum Master。尽管如此，由于人类语言的语言障碍以及他是设计师而我是来自不同领域的程序员这一事实，我们俩的交流还是有点困难。
*   我致力于实现数据库中的表并将其 UI 添加到我们的数据库前端应用程序中。我对小问题做了一些假设，这通常是我得到的大多数任务的情况。我还调整（尽我所能标准化）给我的数据，并告诉它如何在对话框中使用，以便它最适合 DB 前端应用程序的设计。出现了一些我试图解决的问题，因为如果我进行了常规的非规范化，其中一个设计要求要么呈指数级增长（数据库），要么在前端变得不可用。所以我选择为此买单，我得到了，但不幸的是，这后来证明是一个严重的误解，让我们陷入困境。
*   接下来，导出数据库的程序员有一些问题。我回答他们。我重新设计了一些东西，以便他可以更轻松地导出内容，我们分别正在解决他工作环境的一些限制。其他问题只需要澄清设计师使用的“不寻常和令人困惑的术语”。
*   第三个程序员开始着手实现设计师的 UI 模型。随即提出了一些问题。正在对数据库表进行更多调整。突然间，我承诺了一些我在 DB 前端应用程序中难以实现的事情，但我能够解决它。但是，DB 导出器程序员也必须重写一些代码，而且他对新的数据布局不满意。
*   现在我们发现在第 1 部分中存在重大误解。我得到了另一个返工任务来重做 50% 的工作。幸运的是，还没有人将生产数据输入数据库，所以我可以废弃大部分。尽管如此，这项任务已经花费了最初设想的 3 倍。
*   同样，这需要导出器和 UI 程序员添加更多时间。
*   最后，有人开始将生产数据输入数据库前端并且不知道如何使用它。他发现自己在两个程序员之间进行交流：UI 程序员和 DB 前端程序员（我），他们对任务有不同的看法。正在进行更多的返工，但大部分时间都花在解释事情是如何工作的。

这只是故事中非常浓缩的一小部分。我认为这不是一本有趣的书，我不能提供太多细节，也不想记住发生的一切。这个例子中的主要问题是什么？

*   不熟悉数据库和前端的设计师
*   不熟悉 UI 设计的 DB Programmer
*   设计师和DB程序员有误会，各自根据经验做出自己的假设
*   在技​​术设计上做出让步，以适应 DB 前端和 DB 导出器的限制
*   避免在数据库前端和导出器中编写成本代码，因为这会浪费最初的任务估计时间
*   由于不断的需求和实施变化，一直存在混乱。我们没有同时合作，而是一次一个，间隔几天甚至几周。

但最大的问题是：Pod 间通信。每个人都习惯于在自己的吊舱内工作，而且由于人们彼此了解以及他们在做什么，因此并非所有事情都需要解释或写下令人痛苦的细节。然而，一旦与其他 pod 成员开始交谈，没有人会想到沟通会如此困难。人们想非常详细地了解看似显而易见的事情。有些问题只是没有“坚持”并且一遍又一遍地出现。这让所有相关人员感到沮丧，这进一步限制了沟通的有效性。

我的意思是：通信是关键，一旦涉及到其他通常不能一起工作的 pod，通信开销可能会翻两番。如果你没有为此做好准备，它可能会导致挫败感、士气低落、执行乏力等等。

人们越习惯于彼此合作，他们就越不需要交流。反过来也是如此。请注意这一点并提前计划。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-10T04:24:26.997

我的团队一直面临这个问题。我们得到了一个非常广泛的用户故事，并被要求在 2 周的迭代中交付其中的几个。我们花了一周时间与 PO 交谈（我们跨站点工作）充实一个用户故事的细节（如果幸运的话，我们可以做两个），并编写我们自己的用户故事，以便可以针对功能/验收测试进行编写他们。然后我们开始估计每一个的复杂性，并承诺我们可以在剩下的一周内实际完成多少。

一个广泛的用户故事总是被分解成至少 6 或 7 个更精细的用户故事。这让我们了解了更广泛的用户故事到底有多复杂，并且通过反复这样做，我们希望与我们的 PO 沟通，他们需要为我们提供更好的用户故事，但到目前为止我们还没有取得太大的成功。

[正如 S.Lott 在他的回答中所说](https://stackoverflow.com/questions/188549/scrum-how-do-you-developer-deal-with-unclear-requirements-and-multiple-acting-p#189416)，如果您的用户故事不清楚或过于高级，您必须扮演业务分析师的角色，以弥合 PO 和开发团队之间的差距。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-23T14:10:44.820

> 我知道这是反scrum，

我建议你（和你的队友）不要过分关注“Scrum”、“反 Scrum”、“XP”之类的。

您是软件创建者，因此，我鼓励您相信自己是最优秀的人和专业人士，可以创建您付费创建的软件，无论有关敏捷（或任何其他方法）的书籍或顾问怎么说

> 但在我看来，产品经理、DB Lead 和 QA 团队应该在计划会议之前开会，并讨论要添加到 sprint 的任务的详细信息

同意你。

这就是我在参与的许多（敏捷）团队中成功完成的。这种做法有助于更好地了解要完成的工作，并估计复杂性。这不是要在几周内编写规范文档，而是要更好地了解故事背后的内容，包括功能和技术方面。维基页面（或类似工具）通常足以收集此类信息。

> 当我们在会议中尝试这样做时，可能需要一整天 - 不是开玩笑 - 才能为积压的所有项目列出所有细节。

是的，散列所有细节可能需要很多时间，而这在大多数情况下是不必要的。这是在获取不到信息和获取太多信息之间取得平衡的问题。填充一个 wiki 页面（屏幕大小）通常就足够了。获取此信息可能需要 10 分钟到 2 小时。

如果这需要更多时间，这可能是因为故事相当大和/或不确定，您可能需要考虑如何拆分它。

希望这有帮助。

# asp.net - Login.aspx 总是想成为我的主页！

> ID：188569
> 
> 赞同：2
> 
> 时间：2008-10-09T18:29:07.930
> 
> 标签：asp.net, forms-authentication

刚开始在asp.net。刚刚在我的站点中创建了一个 login.aspx 页面并停留在一个 asp 登录控件上——这就是我所做的一切。现在，当我调试时，我的 Welcome.aspx 页面不会显示为我网站的起始页面 - 即使它设置为这样。另外，我什至编辑了我的 web.config - （见下文） - 它仍然做同样的事情。如何使其正常工作，以便我的 Welcome.aspx 页面默认启动？

```
<authentication mode="Forms">
      <forms defaultUrl="~/Welcome.aspx" loginUrl="~/login.aspx" timeout="1440" ></forms>
</authentication> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T18:30:28.880

那是因为您正在使用未经身份验证的用户访问该站点 - 因此框架会将您重定向到 loginurl。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T18:39:04.853

如果您希望用户无需经过身份验证即可访问welcome.aspx，请将welcome.aspx 放在一个单独的文件夹中，并在该子文件夹中设置一个新的web.config。填写该 web.config 中的授权部分，以便匿名用户可以访问该文件夹和子文件夹中的文件，如下所示：

```
<authorization><allow users="?" /></authorization> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:39:24.150

您的问题有两个潜在原因。

1.) 用户未通过身份验证，因此他们必须先登录。如果是这种情况，用户将被带到 login.aspx，并且将存在一个 returnurl 参数，在登录后将其返回到欢迎页面。

2.) 当您单击“调试”启动 Visual Studio 时，您正在查看 login.aspx 页面，如果它是一个 aspx 页面，这通常会启动当前可见的页面。

如果您不希望用户登录作为查看welcome.aspx 页面的要求，要绕过第1 项，您可以在web.config 中修改您的身份验证设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T18:30:34.463

您已经在 web.config 中设置了登录 URL。你会被发送到welcome.aspx，但是这表明你没有登录——所以它会让你重新登录。如果您的登录页面有一个“记住我”复选框，请尝试将其选中并登录——后续运行应该让您直接进入welcome.aspx

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T18:30:54.760

好吧，如果用户未通过身份验证，他们将自动被重定向到“loginUrl”——一旦您登录，您应该被重定向到 Welcome.aspx，只要凭据有效，它将是默认页面。

# c# - ASP.NET：检查 page_load 中的点击事件

> ID：188584
> 
> 赞同：14
> 
> 时间：2008-10-09T18:31:29.843
> 
> 标签：c#, asp.net, .net, pageload

在c#中，如何检查页面加载方法中是否单击了链接按钮？

我需要知道它是否在触发点击事件之前被点击。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-09T18:35:52.300

```
if( IsPostBack ) 
{
    // get the target of the post-back, will be the name of the control
    // that issued the post-back
    string eTarget = Request.Params["__EVENTTARGET"].ToString();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-28T04:07:24.307

如果那不起作用。尝试`UseSubmitBehavior="false"`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T18:35:21.270

检查请求参数 __EVENTTARGET 的值，看看它是否是相关链接按钮的 id。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T18:36:56.323

按钮的 UniqueID 将在 Request.Form["__EVENTTARGET"]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-04T17:35:22.680

根据接受的答案和 RealSteel 的答案，这可能是一个更完整的答案。

首先在 .aspx 中添加一个像这样的按钮：

```
<asp:Button id="btnExport" runat="server" Text="Export" UseSubmitBehavior="false"/> 
```

然后在 Page_Load 方法上：

```
if(IsPostBack){
   var eventTarget = Request.Params["__EVENTTARGET"]
   // Then check for the id but keep in mind that the name could be 
   // something like ctl00$ContainerName$btnExport 
   // if the button was clicked or null so take precautions against null
   // ... so it could be something like this
   var buttonClicked = eventTarget.Substring(eventTarget.LastIndexOf("$") + 1).Equals("btnExport")

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-20T00:19:14.260

我也遇到了同样的问题，必须在 Page_Load 方法中做一些逻辑判断来处理不同的事件（点击了哪个按钮）。

我实现手臂得到如下示例。

前端 aspx 源代码（我有许多 ID 为 F2、F3、F6、F12 的按钮。

```
 <Button Style="display: none" ID="F2" runat="server" Text="F2:Cancel" OnClientClick="SeiGyo(this)" OnClick="F2_Click" />
    <Button Style="display: none" ID="F3" runat="server" Text="F3:Return" OnClientClick="SeiGyo(this)" OnClick="F3_Click" />
    <Button Style="display: none" ID="F6" runat="server" Text="F6:Run" OnClientClick="SeiGyo(this)" OnClick="F6_Click" />
    <Button Style="display: none" ID="F12" runat="server" Text="F12:Finish" OnClientClick="SeiGyo(this)" OnClick="F12_Click" /> 
```

后端aspx.cs源码，我需要做的是判断触发Page_Load时点击了哪个按钮。这似乎有点愚蠢，但有效。我希望这对其他人有帮助

```
Dictionary<string, string> dic = new Dictionary<string, string>();
foreach(var id in new string[]{"F2","F3","F6","F12"})
{
       foreach (var key in Request.Params.AllKeys)
                    {
                        if (key != null && key.ToString().Contains(id))
                            dic.Add(id, Request[key.ToString()].ToString()); 
                    }
} 
```

# c++ - getpwnam 中的内存泄漏是否有修复或解决方法？

> ID：188591
> 
> 赞同：1
> 
> 时间：2008-10-09T18:32:50.997
> 
> 标签：c++, linux

getpwnam 中的内存泄漏是否有修复或解决方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T21:32:32.843

`getpwnam()` **不会**遭受内存泄漏。实际上，后续调用将覆盖其静态内部缓冲区。

这种函数是*不可重入的*，因此*是非线程安全的*。Paul 建议使用`getpwnam_r()`可重入版本，在多线程上下文中使用是安全的。

也就是说，内存泄漏是由那些分配内存的系统调用引起的，一旦返回的数据被使用`malloc()`，应用程序就会对内存负责。`free()`

在这些情况下，建议使用 RAII 习惯用法，以免忘记释放分配的内存——请参阅异常安全。`std::tr1::shared_ptr<>`也是一种可行的方法：对于 shared_ptr，`free()`当 shared_ptr 超出范围时，必须为原始指针提供自定义删除器。

在这个观点下，一些危险的函数是`scandir()`,等等。`asprintf()``vasprintf()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T18:34:52.990

使用 getpwnam_r。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T10:04:12.807

我认为没有解决方法。上面的答案没有帮助，请参阅：

```
daniel@senap:~/dev/tryouts$ uname -a
Linux senap 3.2.0-24-generic #39-Ubuntu SMP Mon May 21 16:52:17 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
daniel@senap:~/dev/tryouts$ cat getpwnam-leak.c 
#include <sys/types.h>
#include <pwd.h>

extern void __libc_freeres(void);

int main()
{
  char buf[1024];
  struct passwd pw, *result;
  getpwnam_r("root", &pw, buf, sizeof(buf), &result);
  __libc_freeres();
}
daniel@senap:~/dev/tryouts$ valgrind --leak-check=full ./getpwnam-leak
==6951== Memcheck, a memory error detector
==6951== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==6951== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==6951== Command: ./getpwnam-leak
==6951== 
==6951== 
==6951== HEAP SUMMARY:
==6951==     in use at exit: 300 bytes in 11 blocks
==6951==   total heap usage: 69 allocs, 58 frees, 9,234 bytes allocated
==6951== 
==6951== 300 (60 direct, 240 indirect) bytes in 1 blocks are definitely lost in loss record 11 of 11
==6951==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so) 
==6951==    by 0x4F35D94: nss_parse_service_list (nsswitch.c:678)
==6951==    by 0x4F36855: __nss_database_lookup (nsswitch.c:175)
==6951==    by 0x55F32A4: ???
==6951==    by 0x4EEF1AC: getpwnam_r@@GLIBC_2.2.5 (getXXbyYY_r.c:256)
==6951==    by 0x400607: main (in /home/daniel/dev/tryouts/getpwnam-leak)
==6951== 
==6951== LEAK SUMMARY:
==6951==    definitely lost: 60 bytes in 1 blocks
==6951==    indirectly lost: 240 bytes in 10 blocks
==6951==      possibly lost: 0 bytes in 0 blocks
==6951==    still reachable: 0 bytes in 0 blocks
==6951==         suppressed: 0 bytes in 0 blocks
==6951== 
==6951== For counts of detected and suppressed errors, rerun with: -v
==6951== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 2 from 2)
daniel@senap:~/dev/tryouts$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T03:05:10.383

要解决此问题，只需执行以下操作：

```
sudo sed -i s/compat/files/g /etc/nsswitch.conf 
```

这似乎是由于 libnss_compat 中的错误引起的。更多信息请访问[bugs.debian.org](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=273051)。

# java - Java 中的 HTTP 帖子和多线程

> ID：188592
> 
> 赞同：1
> 
> 时间：2008-10-09T18:33:28.467
> 
> 标签：java, multithreading, timeout, httpclient, clienthttprequest

我正在编写一个内部 Java Applet 来通过 HTTP 上传文件。我开始使用内置的 ClientHttpRequest，如果我想一个接一个地发布，它会很好用。当我尝试同时发布多个线程时，服务器端的某些东西会出现问题，并且对于大文件，连接会挂起，同时仍会上传较小的文件。（大的似乎在 10 兆左右）经过大量查找，我无法找到可以设置为从该错误中恢复的超时，但最终从 Apache 中找到了 ClientHttp，它确实提供了设置超时的机制。它的问题在于，虽然它声称能够在多线程程序中工作，但实际上它只执行一个又一个请求。

虽然发布确实不需要多个线程（HttpClient 似乎确实比 ClientHttpRequest 快一点），但获得额外的速度提升会非常好，因为可以同时发送很多较小的文件。

这些文件是通过 HTTP 发送的，因为我们希望使用他们的会话 cookie 对已经登录的用户使用相同的身份验证。

因此，我正在寻找一种方法来设置 ClientHttpRequest 超时或 HttpClient 的代码，该代码实际上将按照承诺同时发送多个请求。

我在线程之间共享相同的 HttpClient 实例并使用多线程连接管理器（没有它甚至无法工作）就像文档说的那样，它没有帮助。

任何帮助将不胜感激，如果您需要任何澄清，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T21:16:06.050

查看您的代码示例可能会有所帮助。

也许问题出在小程序环境上。您是在 appletviewer、IDE 还是在浏览器中测试它？浏览器通常设置为将与同一 Web 服务器的连接数限制为 2。您可以尝试添加一个 main() 并独立运行它以查看是否可以解决问题。

# odbc - 从 SPSS，从 SQL Server Analysis Services 导入数据

> ID：188599
> 
> 赞同：1
> 
> 时间：2008-10-09T18:35:06.390
> 
> 标签：odbc, oledb, ssas, spss

我想知道是否有一种简单的方法可以将数据从分析服务 (SSAS) 加载到 SPSS 中。

SPSS 提供了一个将 SPSS 功能放在分析服务器上的产品，但对我来说这是倒退的。我不想了解 SPSS 或让办公室的 SPSS 用户学习其他内容。

我只想将分析服务数据提供给 SPSS 中的 SPSS 用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T03:17:01.777

您最好将 SSPS 指向 SSAS 正在使用的关系数据源。SSAS 不是为批量导出数据而设计的。即使我们确实找出了一系列查询，它也会比仅查询原始源慢很多倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T21:34:44.060

SSAS 有行动。您可以触发调用 VB.net 或 c# 代码的操作来格式化数据并将其导入 SPSS。

# java - 第一次失败测试后如何使junit测试停止

> ID：188606
> 
> 赞同：5
> 
> 时间：2008-10-09T18:35:54.750
> 
> 标签：java, testing, tdd, junit

有没有办法让运行 junit 测试在测试失败后停止？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T18:57:05.393

我知道在 Ant 中，junit 任务具有控制此行为的选项“haltonerror”和“haltonfailure”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T19:35:16.017

是的......这种能力（或缺乏它）内置于各种 TestRunners（控制台、AWT、Swing、Ant、Maven 或内置于 Eclipse 等）中。您必须在您使用的特定平台的文档中查找此控件。

# javascript - 使用 Javascript 在 MS CRM 4.0 中的 IFrame 中加载页面上的访问控件

> ID：188621
> 
> 赞同：2
> 
> 时间：2008-10-09T18:39:55.957
> 
> 标签：javascript, asp.net, iframe, dynamics-crm, dynamics-crm-4

我在 MS CRM 4.0 的一个模块中的 IFrame 中加载了一个自定义 aspx 页面。这个页面基本上有 6 个文本框（txtValue1、txtValue2 等等..），其中包含值。我想通过加载事件或保存事件上的 javascript 代码访问这些值。有人知道怎么做吗？我尝试了从网上获得的几个代码，但似乎没有任何效果。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T19:18:31.980

试试下面的片段...

```
var textBox1Value = document.frames.IFRAME_NAME.document.all.txtValue1.value; 
```

其中 IFRAME_NAME 是您在表单自定义项中定义的 IFRAME 的名称，而 txtValue1 是 IFRAME 上文本框的 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-28T23:37:28.303

一个值得注意的小问题是，通过文档的框架集合访问 iframe 不会让您读取或写入我发现自己不时动态更改的 src 或 url 属性。要访问和更改属性，您需要通过 访问 iframe `getElementById`。

```
var yourIframe = document.getElementById('IFRAME_NAME'); 
```

请注意，如果您按上述方式访问 iframe，并且想要调用 iframe 脚本可用的函数，则必须通过 contentWindow 属性调用它：

```
yourIframe.contentWindow.someFuncOnIframePage(); 
```

# c# - 我的类应该实现什么接口或方法来在 Console.WriteLine 中打印我想要的内容？

> ID：188625
> 
> 赞同：1
> 
> 时间：2008-10-09T18:40:48.890
> 
> 标签：c#, .net, console-application, console.writeline

我有一个 F 类的对象。我想使用 Console.WriteLine 输出对象的内容，以便像这样进行快速和肮脏的状态更新：

Console.WriteLine(objectF);

这仅将类的名称打印到控制台：

```
F 
```

我想以某种方式重载它，以便我可以打印出一些关于对象及其属性的有用信息。

我已经有一个解决方法：在我的类中重载 ToString 方法，然后调用： Console.WriteLine(objectF.ToString());

但我宁愿使用更简单的语法。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T18:42:35.563

Console.WriteLine(objectF)

应该可以工作，如果你超载`ToString`. 当框架需要将对象转换为字符串表示时，它会调用`ToString`.

```
public override string ToString()
{
    // replace the line below with your code
    return base.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T21:34:02.097

您应该覆盖 ToString() 尽管在某些情况下您可能会发现以下代码很有用：

```
public static class ObjectUtility
{
    public static string ToDebug(this object obj)
    {
        if (obj == null)
            return "<null>";

        var type = obj.GetType();
        var props = type.GetProperties();

        var sb = new StringBuilder(props.Length * 20 + type.Name.Length);
        sb.Append(type.Name);
        sb.Append("\r\n");

        foreach (var property in props)
        {
            if (!property.CanRead)
                continue;
            // AppendFormat defeats the point
            sb.Append(property.Name);
            sb.Append(": ");
            sb.Append(property.GetValue(obj, null));
            sb.Append("\r\n");
        }

        return sb.ToString();
    }
} 
```

用法是简单地包含包含 ObjectUtility 的命名空间，然后...

```
var f = new F();
Console.WriteLine(f.ToDebug()); 
```

上面的反射用法对于高性能代码不是很好，所以不要在需要高性能的生产场景中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T18:43:22.783

我会继续使用 ToString()。这就是它存在的目的。此外，除非您有格式字符串，否则您可以只写：

```
Console.WriteLine(objectF) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T18:50:16.843

我找到了我的问题的原因。我忽略了将 ToString() 的实现定义为**override**。正确的语法是：

```
public override string ToString()
{
   ///Do stuff...
   return string;
} 
```

感谢下面的海报让我走上正轨

# .net - System.IO.Directory.Exists 给出间歇性假阴性

> ID：188628
> 
> 赞同：1
> 
> 时间：2008-10-09T18:41:48.043
> 
> 标签：.net, asp.net

我在 ASP.NET 2[网站](http://www.BugTracker.net)的以下代码行中遇到间歇性误报：

```
if (!System.IO.Directory.Exists(folder)) 
```

该文件夹显然存在，甚至包含一个日志文件，当 CLR 没有谎报该文件夹的存在时写入该日志文件。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T18:48:18.937

如果发生任何类型的 IO 错误，Exists() 将返回 false，而不是抛出错误。需要注意的一件事是安全错误。Exists 不执行网络身份验证，因此如果您访问网络共享，则需要预先进行身份验证，至少根据文档。我自己没试过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T18:49:04.630

是否可以在 asp.net 工作进程上执行[proc mon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)并验证它是否实际上正在检查该特定文件夹的存在？检查结果代码以解决任何访问被拒绝错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T18:51:19.493

变量“文件夹”的调试时间值是多少？它是存在于网站目录之外的文件夹吗？

# assemblies - 如何确定一个程序集是否正在使用？

> ID：188631
> 
> 赞同：1
> 
> 时间：2008-10-09T18:42:59.010
> 
> 标签：assemblies

我如何判断一个程序集是否正在被任何进程使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-06T20:21:08.997

这是PowerShell中的答案

```
if ( Get-Process | ? { $_.Modules | ? {$_.ModuleName -eq "AssemblyName.dll" } })
{
    "in use"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T18:44:47.523

如果您想知道您的应用程序是否已加载程序集，您可以检查 AppDomain 以查找已加载的程序集。如果您想知道程序集是否由机器上的*任何*进程加载，它会变得有点棘手。您需要以上哪一项？

# windows - 如何使用 VBScript 强制重启 Windows 机器？

> ID：188636
> 
> 赞同：8
> 
> 时间：2008-10-09T18:43:58.900
> 
> 标签：windows, vbscript, reboot

我正在尝试找到一种强制 Windows 重新启动的方法，但我遇到了问题。我试过了

```
`Set OpSysSet = GetObject("winmgmts:{authenticationlevel=Pkt," _
     & "(Shutdown)}").ExecQuery("select * from Win32_OperatingSystem where "_
     & "Primary=true")
for each OpSys in OpSysSet
    retVal = OpSys.Reboot()
next`
```

我也尝试过使用该`shutdown -f -r`命令，在这两种情况下，我有时都没有得到响应，如果我再试一次，我会收到一条错误消息，说“操作无法完成，因为系统正在关闭”，即使我离开它多久它不会关闭，它仍然允许我启动新程序，并且执行`shutdown -a`同样的错误。如何使用脚本强制 Windows 重新启动？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T19:32:47.070

尝试更换：

```
retVal = OpSys.Reboot() 
```

和：

```
retVal = OpSys.Win32Shutdown(6) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T19:23:31.987

好吧，这使用了 VBScript——尽管它确实调用了与您尝试执行的相同的命令行关闭。我已经对其进行了测试，并且可以正常工作。

```
Dim oShell 
Set oShell = CreateObject("WScript.Shell")

'restart, wait 5 seconds, force running apps to close
oShell.Run "%comspec% /c shutdown /r /t 5 /f", , TRUE 
```

你运行的是什么操作系统？这个测试是针对 XP 的。我想知道服务器操作系统是否需要关闭代码...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T03:45:59.193

您还可以尝试 Sysinternals now Microsoft 的 psShutdown 命令行实用程序。 [http://technet.microsoft.com/en-us/sysinternals/bb897541.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897541.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-08T02:29:16.953

```
'*********************************************************

Option Explicit

Dim objShell

Set objShell = WScript.CreateObject("WScript.Shell")

objShell.Run "C:\WINDOWS\system32\shutdown.exe -r -t 0"

'********************************************************* 
```

这个小脚本会在 0 秒后重新启动本地计算机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-11T10:28:34.867

```
Set Reset= WScript.CreateObject ("WScript.Shell")

Reset.run "shutdown -r -t 00", 0, True 
```

或者..

```
Shell "shutdown -r -t 00"   ' for restart

Shell "shutdown -s -t 00"  ' for Shutdown

Shell "shutdown -l -t 00"   ' for log off

Shell "shutdown -a -t 00"  ' for abort 
```

# windows - 剥离 Windows DLL 调试信息？

> ID：188639
> 
> 赞同：7
> 
> 时间：2008-10-09T18:44:27.617
> 
> 标签：windows, dll

我通常不从事 Windows 开发工作，对工具链和构建系统完全不熟悉。我的嵌入式产品在其文件系统中包含一些来自第三方的 Windows DLL（由安装文件系统的 Windows 机器使用）。

我有一个问题：与以前的版本相比，这些 DLL 的最新版本的大小增加了两倍，并且它们不再适合文件系统。DLL 的功能没有太多变化，所以我怀疑开发人员只是忘记在这个 drop 中去除调试符号。我会问他们，但由于时区和语言差异，通常需要几天时间才能得到答案。

有人可以为不熟悉 VisualC 的人使用简单的步骤来解释如何确定 DLL 是否仍然包含调试信息以及如何将其删除？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T19:07:39.427

通常，调试信息本身是作为单独的`*.pdb`文件（程序数据库）构建的，而不是像在 unix 中那样附加到二进制文件中。如果开发人员确实构建了库的调试版本，那么更严重的问题可能是依赖关系。如果二进制文件的发布版本链接到`MSVCRT.DLL`，那么调试版本将链接到`MSVCRTD.DLL`（其他运行时库的名称类似地以 D 后缀命名）。要查找特定二进制文件的依赖项，请尝试：

```
dumpbin /imports whatever.dll 
```

这将显示库的所有运行时依赖项`whatever.dll`（请注意，列出了这些库中的库名称和符号）。如果您没有看到您期望的依赖项列表，则可能存在只能通过让原始开发人员以正确的构建模式重新构建库来解决的问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T08:29:29.887

Rebase 是微软工具集的一部分。除了设置 dll 的基地址外，它还可以将任何附加的调试信息剥离到单独的 .dbg 文件中。

变基 -i 0x10000000 -a -x .\ -p

从理论上讲，您应该尝试确定 dll 是否已经构建到唯一的基地址并使用它。或者，选择一个基地址以最大限度地减少与您的应用程序使用的任何其他 dll 冲突的机会，以便 Windows 在加载它时不必修补 dll。在一个加载程序经常随机化模块的加载地址作为安全功能的时代，我不确定是否值得再专门设置基地址。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T19:13:51.130

您将希望从开发人员那里获得发布版本，即使这很痛苦，因为默认情况下调试版本是在禁用代码优化的情况下编译的。因此，即使您以某种方式剥离了调试信息，您也会留下没有尽可能高效的代码。（更不用说那里可能存在任何调试陷阱和消息。）

至于确定您拥有哪种 DLL，您可以使用[Dependency Walker](http://www.dependencywalker.com)查看您的 DLL 是否链接到 VC 运行时库的调试或发布版本（假设这些库不是静态链接的。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-21T02:51:51.193

Dependency walker 确实显示了依赖关系，但不显示调试信息是否已被剥离。使用 [PeStudio](http://www.winitor.net/en/pestudio.html)查看两者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T23:16:52.783

暂时忽略其他建议，例如获取有效的发布版本。开发人员正在寻找的工具实际上`link.exe`来自 Visual Studio（或 SDK 或 WDK）。

如果他们希望您能够将调试器与他们的代码一起使用，他们可以为您创建公共 PDB 文件。他们想要使用的选项是：

```
 /PDB:filename
  /PDBSTRIPPED:filename 
```

但是，恐怕您自己对此无能为力。PDB 文件本身是单独的文件，**调试信息通常不会包含在现代 MS 编译器的二进制文件中**（尽管可能包含一些 RTTI 内容，更不用说文件名和字符串`ASSERT`以及类似的宏和“函数” - 这是最有可能解释感知到的膨胀）。

注意：`binplace.exe`来自 WDK 提供与上述标志相同的功能，但语法更复杂（尽管适合 WDK 构建过程）。

# orm - 你会为你的 ASP.NET webapp 选择什么？nHibernate、Linq 或 SubSonic

> ID：188647
> 
> 赞同：4
> 
> 时间：2008-10-09T18:48:18.593
> 
> 标签：orm

或许还有别的？我已经在使用 nHibernate，但我偶尔会遇到延迟初始化的代理对象实际上不会初始化的问题。我正在考虑尝试别的东西。该站点具有用户帐户、用户帖子和照片，并将这些过滤到某些位置名称和标题/描述匹配。更不用说投票、评级和标记为收藏。所有这些都会导致不同数量的数据库负载。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T19:28:14.847

SubSonic 目前在我们所有的网络表单应用程序中都取得了巨大的成功。在几分钟内，您的整个数据库就可以从头开始生成并准备在您的应用程序中使用。SubSonic 的创建者 Rob Conery 有一些很棒的网络广播，详细介绍了在 Web 应用程序中设置 SubSonic 位的过程，以及一些很酷的演示来帮助您入门。查看[SubSonic 项目](http://subsonicproject.com/download/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T19:38:30.100

我已经为我的 ORM 使用[LLBLGen Pro](http://www.llblgen.com)大约一年了，而且效果还不错。虽然我没有使用过 SubSonic，但有人告诉我它们是相似的。从头开始，它可以从您的数据库创建一个数据访问层，并在几分钟内准备好使用。有一点学习曲线，至少对我来说是这样，但是帮助文件提供了足够的信息来帮助你完成几乎所有遇到的事情。该应用程序可以按原样安装使用，但也支持大量自定义（可能太多了？）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T13:42:06.187

我会使用 NHibernate。Persistence Ignorance 是我的主要卖点之一，不绑定到数据库是另一个。实体框架存在严重缺陷，不仅仅是缺少延迟加载。EF 和 LINQ2SQL 都是新技术，而 NHibernate 已经非常成熟并且已经看到了更多的行动。

NHibernate 的另一个好处是能够在不编辑数据库的情况下切换数据库。我将它用于在本地运行的集成测试，[针对 SQLite 运行它们，然后在 CI 服务器上运行 SQL Server](http://blog.e4ums.co.uk/archive/2008/10/10/blisteringly-fast-integration-tests-with-nhibernate-and-sqlite.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T19:00:01.690

我们在一个相当活跃的站点（每天 10,000 次访问）上使用 ADO.NET Entity Framework。这对我们来说很稳固。缺少延迟加载很烦人，但它会让你考虑去数据库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T20:03:07.507

如果您在数据库中的继承模型与 Linq 非常有限的继承支持一起工作，那么我说去 Linq。如果您需要更复杂的继承场景，那么我会说您应该坚持使用 NHibernate 并克服您遇到的任何痛苦。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-09T20:45:14.300

另一种选择是[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)。它在 NHibernate 之上实现了[Active Record 设计模式](http://martinfowler.com/eaaCatalog/activeRecord.html)，并且还消除了配置（例如它的“isWeb”设置）和映射的大部分痛苦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T20:14:54.050

如果您在延迟初始化代理方面遇到特定问题，为什么不放弃呢？或仅延迟加载袋子。我认为在你用一个没有延迟加载的框架重写你的应用程序之前，值得一试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T20:58:18.207

我在微软生态系统中的经验：

我在几个项目中使用了 Linq2Sql，并且遇到了 azamsharp 提到的“分层”问题。

如果您一心想要将 POCO 发送回您的逻辑或 UI 层，这并没有多大帮助，但是存储库模式的实现对解决令人讨厌的分层和关注点分离问题有一点帮助。

[一个好的基本存储库实现](http://aspalliance.com/1672_Implementing_the_Repository_Pattern_with_LINQtoSQL.3)

对于任何使用复杂语义的事物，例如投票或统计信息（基本上任何需要以不同于数据库中表示的方式显示或操作的域对象），ADO.Net 实体框架都会为您提供一些优势。它可以通过包含复杂的数据检索来简化您的业务逻辑/数据访问层。

[ADO.Net 实体框架概述](http://msdn.microsoft.com/en-us/library/bb399572.aspx)

希望有帮助！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-20T21:59:27.130

我喜欢 SubSonic，因为它很容易配置和生成 DAL。该实现不是一个成熟的 ORM，因为它只为每个表创建一个类。当您需要组合作为连接结果的对象时，能够使用存储过程进行补偿。同样，SubSonic 旨在发挥作用，因此它将帮助您快速实现项目目标。

也就是说，您不能使用 SubSonic 来“组合对象”——没有描述类之间关系的配置文件。数据库仍然决定了您如何塑造您的解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-01T07:15:19.217

我真的不喜欢 SubSonic。对我来说，它似乎是一个非常薄的 DAL 工具。使用 SubSonic，我仍然在输入很多字符串文字，这似乎对我来说有点失败。就个人而言，我更喜欢 LLBLGen：

[http://www.llblgen.com/defaultgeneric.aspx](http://www.llblgen.com/defaultgeneric.aspx)

创建者 Frans Bouma 有一个非常好的博客，其中讨论了有关 DAL 和 ORM 技术的许多问题。

[http://weblogs.asp.net/FBouma/](http://weblogs.asp.net/FBouma/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T19:01:22.903

LINQ 是一个不错的选择。它在 Stackoverflow 上使用，在我当前的项目中，我们使用 LINQ 进行数据访问。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-09T19:39:41.500

用于 Java 项目的 Hibernate，但毫无疑问，用于 .Net 的 LINQ。为什么在内置 LINQ 时添加外部依赖项？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-09T19:42:57.970

尽管我必须承认 LINQ to SQL 存在分层问题，但我也会使用 LINQ。我读过很多关于 LINQ to SQL 的文章，所有文章都认为它基本上是为 RAD 应用程序创建的。

# javascript - JQuery JavaScript 设计：自执行函数还是对象字面量？

> ID：188663
> 
> 赞同：9
> 
> 时间：2008-10-09T18:53:05.277
> 
> 标签：javascript, jquery

我很好奇在构建封装代码块时是否有任何与 JQuery 相关的最佳实践。

通常，当我构建一个页面时，我喜欢将该页面中使用的函数封装在一个对象中。这允许我在构建应用程序时进行一些封装。没有什么比看到包含一堆这样的 JavaScript 文件更让我讨厌的了

```
function doSomethingOnlyRelevantOnThisPage() {
    // do some stuff
} 
```

这会导致设计混乱，并不能很好地封装功能。

通常在许多框架中，都有一个标准用于执行这种封装。

在 Mootools 中，他们偏爱 Object Literal Notation：

```
var Site = {        
    // properties and methods
} 
```

在 YUI 中，他们支持自执行函数符号：

```
(function() { // properties and methods })() 
```

第二个示例的好处是创建了一个闭包，因此允许您定义私有属性和方法。

我的问题是：是否有任何 JQuery 爱好者有任何最佳实践来创建这些干净封装的结构？使用它们的理由是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-11-10T18:09:23.213

由于我使用 jQuery 已经有一段时间了，所以我决定采用一种适合我的标准模式。

~~它是 YUI 模块模式和一些 jQuery 插件模式的组合~~。我们最终使用了自执行闭包模式。这在几个方面是有益的：

1.  它将代码保持在最低限度
2.  它强制将行为与表示分离
3.  它提供了一个防止命名冲突的闭包

这是它的样子：

```
;(function($) {        
    var myPrivateFunction = function() {
    };

    var init = function() {
        myPrivateFunction();
    };

    $(init);
})(jQuery); 
```

我们意识到分配函数执行的结果，类似于 YUI 模块模式，暴露了可能从演示代码中调用的代码。我们想防止这种情况发生，所以这种模式适合。

当然，我们可以内联编写 init 方法，而无需为函数定义变量。我们同意明确定义 init 函数可以使代码对读者更清晰。

如果我们想在页面/外部 js 文件之间共享函数会发生什么？我们只是简单地挂钩到 jQuery 提供的用于扩展 jQuery 对象本身的现有机制 - 扩展函数。

如果函数是静态的，我们使用 $.extend，如果它们在一个包装集上运行，我们使用 $.fn.extend 函数。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T19:16:19.113

我在开发时使用 YUI 和 jQuery（YUI 小部件和一些便利功能，jQuery 选择器和 javascript“扩展”），我使用的通用 javascript 模板是这样的：

```
/*global YAHOO, $ */

// Create the public-scope accessable namespace for this page
YAHOO.namespace('Project');

YAHOO.Project.page = function() {
    // Private members

    var self = {};

    // Public members
    var pub = {};

    pub.init = function() {

    };

    return pub;
} ();

// When the DOM is loaded, initialize this module
$(document).ready(YAHOO.Project.page.init); 
```

现在很明显，如果您不想使用 YUI，可以删除 YAHOO.namespace() 调用，但这是基本大纲。它使用对象文字表示法，但也允许您定义私有属性和方法。

请记住，在调用私有成员或引用私有变量时将它们引用为`self.funcName()`. 您可以在对象之外定义它们`self`，但随后在对象中的任何地方都会出现错误，您试图确定`size_of()`是私有方法还是在其他地方全局定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:04:54.783

我通常遵循原型模式：

```
MyFunction = function(param1, param2)
{
   this.property1 = param1;
   // etc.
}

MyFunction.prototype =
{
    memberOne: function(param1)
    {
       // ...
    },

    memberTwo: function(param2)
    {
    }
} 
```

你会得到一个“构造函数”（函数本身）和封装的“方法”和“字段”。

对于习惯于基于类的 OO 语言的人来说更容易:)

# javascript - 你有任何与 jQuery 一起使用的 Ajax 加载图像的想法吗？

> ID：188669
> 
> 赞同：4
> 
> 时间：2008-10-09T18:54:23.637
> 
> 标签：javascript, jquery, ajax

我有一个页面正在加载 jQuery。初始加载包括 100 条记录，每条记录有 6 个图标。不用说，加载需要几秒钟，我想给用户一个“加载”提示/动画。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T18:57:58.557

[http://www.ajaxload.info/](http://www.ajaxload.info/)是为这类事情生成动画 GIF 的绝佳资源。

获得动画后，将其渲染为页面的一部分；在动画的 onload() 事件上触发 jQuery 加载机制（因此您确定动画已首先加载），并在加载序列结束时使用回调来禁用/隐藏动画 GIF。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T19:14:54.157

Matt Berseth 有[**一个很好的基于 jQuery 的方法来做这件事**](http://mattberseth.com/blog/2007/10/yui_style_ajax_progress_indica.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-22T13:30:58.597

加载图像的另一个资源：[http ://www.loadinfo.net/](http://www.loadinfo.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T18:56:07.923

您可以显示带有动画 GIF 图像的 div 作为加载提示。这就是我过去的做法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T18:57:51.570

任何时候我需要这样的东西时，我都会用一个简单的、居中的、动画的 gif 替换将要加载的元素，上面写着“正在加载，请稍候”或类似的消息。如果它只有几秒钟，进度指示器可能有点过头了，但是一个简单的动画可以让大多数人确信，是的，您的网站仍在运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T22:44:51.470

您可能想要设置一个全局 ajax 事件来显示/隐藏加载图标。看看：[http ://docs.jquery.com/Ajax_Events](http://docs.jquery.com/Ajax_Events)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-27T21:50:12.557

您可以在 CCS3 中制作动画，例如，如果您想要一个脉冲：

html标记：

```
<div class="pulse"></div> 
```

的CSS：

```
.pulse {
    width: 32px;
    height: 32px;
    margin: 25% auto;
    background-color: #303030;
    -webkit-border-radius: 16px;
    -moz-border-radius: 16px;
    -ms-border-radius: 16px;
    -o-border-radius: 16px;
    border-radius: 16px;
    -webkit-animation: scaleout 1.0s infinite ease-in-out;
    animation: scaleout 1.0s infinite ease-in-out;
}
@-webkit-keyframes scaleout{
    0%{
        -webkit-transform:scale(0)
    }
    100%{
        -webkit-transform:scale(1);
        opacity:0
    }
}
@-moz-keyframes scaleout{
    0%{
        -moz-transform:scale(0)
    }
    100%{
        -moz-transform:scale(1);
        opacity:0
    }
}
@-ms-keyframes scaleout{
    0%{
        -ms-transform:scale(0)
    }
    100%{
        -ms-transform:scale(1);
        opacity:0
    }
}
@-o-keyframes scaleout{
    0%{
        -o-transform:scale(0)
    }
    100%{
        -o-transform:scale(1);
        opacity:0
    }
}
@keyframes scaleout{
    0%{
        transform:scale(0);
        -webkit-transform:scale(0)
    }
    100%{
        transform:scale(1);
        -webkit-transform:scale(1);
        opacity:0
    }
} 
```

或者你可以创建一个带有内部图像或背景图像的 div，你有[一些](http://tympanus.net/codrops/2014/04/25/freebie-flat-style-squared-preloaders/)关于动画的想法，它有一个可免费下载的集合，尽情享受吧。

# regex - Apache - mod_rewrite RewriteRule 问题

> ID：188673
> 
> 赞同：0
> 
> 时间：2008-10-09T18:56:16.783
> 
> 标签：regex, apache, mod-rewrite

我的 mod_rewrite 规则有一些问题。我想处理三种不同的 url 模式。

1.  [http://example.com/%module%/%view%-%args%.html](http://example.com/%module%/%view%-%args%.html)
2.  [http://example.com/%module%/%view%.html](http://example.com/%module%/%view%.html)
3.  [http://example.com/%module%](http://example.com/%module%)

~~以下 mod_rewrite 规则并不真正起作用~~。另外我的问题是查询（例如：user.html?foo=bar）没有效果。

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^([0-9A-Za-z_-]*)/?([0-9A-Za-z_]+)-?([0-9A-Za-z_,]*)\.html$ index.php?__module=$1&__view=$2&__argv=$3

    RewriteRule ^([0-9A-Za-z_-]*)/?$ index.php?__module=$1&__view=&__argv=
</IfModule> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:43:04.053

对于查询字符串，使用 QSA（追加查询字符串）标记您的规则。

您尝试配置的称为“前端控制器”，其中已经有很多现成的。也许你应该看看一些流行的 PHP 框架并采用一个适合你的。

# html - 是否有任何 HTML 样式指南？

> ID：188679
> 
> 赞同：1
> 
> 时间：2008-10-09T18:58:04.173
> 
> 标签：html, xhtml, coding-style

老实说，我发现我的 HTML 非常笨拙。小而简单的页面是可以的。但是，在缩进和我拥有的各种标签之间，有一点是不可能的。是否有用于干净、可维护的 HTML 的 W3C（或其他“官方”或广为接受的）格式指南？如果没有，社区可以提供什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T19:02:00.687

我的建议是不要担心。与大多数语言不同，HTML 和 XML 几乎可以轻松地重新缩进为程序员想要的任何样式。在 HTML 中，我使用宽度为 2 的选项卡，并且经常有部分超出编辑器窗口的边缘。除非您只是跳过文档的缩进部分，否则实际上没有任何方法可以避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:04:01.323

我通常将每个“块”类型的元素放在一个新行上，并且每次都缩进它。即使有少量代码，它也有助于元素的变化。当我格式化一小段代码时，我保留在同一行的唯一项目是粗体和斜体标签以及偶尔的 div 和 span 标签，所以你会看到如下内容：

```
<p>
   This is my <b>fancy</b> code block of text here. This will
   typically wrap forever and <div class="SarcasticStyle">EVER</div> until
   I run out of things to say.
   <br/>
   Yeah, I think that's it.
</p> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:29:57.370

我曾经对我的 HTML 中的空白非常严格（每个缩进级别有 2 个空格，没有制表符，组部分之间有一个空格等）。不过，在进入更多服务器端编程之后，我发现保持格式看起来恰到好处越来越难。Dreamweaver 在这方面臭名昭著。我似乎无法通过使用制表符来获取应用程序，这最终导致源代码在其他文本编辑器中看起来不同。

我已经不再担心了，只是尝试改进我目前正在处理的一些标记。在编程语言中，缩进似乎比 HTML 更重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T05:01:26.127

我不得不不同意你选择的答案。你*应该*担心你的 html 是什么样子的。有了所有花哨的 ide，似乎开发人员对 html 并没有像他们应该做的那样谨慎。输出到浏览器的生成的 html 对您网站的可访问性和搜索引擎优化都有重大影响。有多少人在那里建立网站甚至知道`<label>`标签的作用？它将标签与表单元素联系起来，这对于通过屏幕阅读器“查看”网络的视障人士来说非常重要。

如果您的 html 嵌套得如此之深以至于您的缩进级别超过十级，那么您真的需要考虑重构您的设计——就像您的程序代码采用这种方式一样。

回到真正的问题，如果你记住一条规则，让你的 html 看起来很漂亮是很容易的；将标签分成多行。以`<a>`标签为例。虽然您确实不能对 url 本身做太多事情，但除了使用像[bit.ly](http://bit.ly)这样的缩短服务之外，将标签分成多行，如下所示：

```
<a href="https://rads.stackoverflow.com/amzn/click/com/1430209879" rel="nofollow noreferrer"More Joel on Software: Further Thoughts on Diverse and
          Occasionally Related Matters That Will Prove of Interest to
          Software Developers, Designers, and ... Luck, Work with Them
          in Some Capacity (Pro) (Paperback)">Another Joel on Software book</a> 
```

您还可以查看自动进行 html 格式化的方法。[像tidy ui](http://users.rcn.com/creitzel/tidy.html#tidyui)和[htmltrim](http://dev.int64.org/htmltrim.html)这样的独立应用程序可以做到这一点，或者您可以获得可以与您的应用程序集成的[htmltidy库。](http://tidy.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T19:03:13.320

我只是正确缩进，不用担心行长。

如果您使用的是模板系统，那么视图中无论如何都没有任何内容，因此这些行将只有变量和标签。

基本上尽可能多地远离 HTML，这不是问题。

# vector-graphics - 将光栅图像转换为矢量图形的建议

> ID：188680
> 
> 赞同：3
> 
> 时间：2008-10-09T18:58:23.520
> 
> 标签：vector-graphics

如果有人希望将大量光栅图像批量转换为矢量图形，是否有任何工具可以做到这一点？

例如，想想任何具有标准形状（椭圆、矩形）和文本的图表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T19:19:23.960

[Inkscape 使用](http://www.inkscape.org/doc/tracing/tutorial-tracing.html)Potrace 引擎来跟踪光栅图形。您通常需要稍微尝试一下才能获得有用的输出，但它的效果出奇的好并且易于使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T19:03:57.487

也许 Vector Magic 的桌面版（不是免费的）可以帮助您。

链接：http: [//vectormagic.com/](http://vectormagic.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T12:04:15.840

我会热情地支持 Vector Magic 的提名。

我最近使用 Adob​​e Live Trace (Photoshop CS2) 做了一些光栅到矢量的转换工作。它需要相当多的调整才能让从可怕到可以接受。

我用 Vector Magic 进行了完全相同的转换（使用的是在线版本，前两个是免费的），配置问题很简单，调色板编辑简单直观，结果非常好，非常干净，第一次尝试。显然，他们已经解决了去噪和去抗锯齿的问题，以产生干净的矢量。（与 Adob​​e 相比，它采用噪声音调和别名音调，并决定从中制作出许多微调的小向量。）

另一种选择是 Corel PowerTRACE，虽然我没有使用它的经验。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-10T07:56:42.027

Imagetracer 是一个免费的开源（公共领域）库和应用程序，可能对批量转换文件很有用。免责声明：我做了这些。

获取**ImageTracer.jar**从

[https://github.com/jankovicsandras/imagetracerjava](https://github.com/jankovicsandras/imagetracerjava)

然后基本用法是：

`java -jar ImageTracer.jar smiley.png`

这可以通过标准 CLI 批处理自动执行，例如使用 bash：

`for file in *.png; do java -jar ImageTracer.jar "$file" outfilename "${file/%ext/svg}"; done`

这应该从当前文件夹中的所有 PNG 创建 SVG。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-01-12T17:35:06.897

截至今天2021.1.13，

我认为 Vector Magic 仍然是市场上最好的工具，他们很自豪地在他们的网站上声明：

[“简直就是世界上最好的自动追踪器”](https://i.stack.imgur.com/Dkz7w.png)
您可以免费测试他们的在线光栅到矢量转换。 [https://vectormagic.com/](https://vectormagic.com/)

但是，确实，Lab 中的很多技术似乎都出现了，比如这个：
[Perception-Driven Semi-Structured Boundary Vectorization](https://i.stack.imgur.com/01cu8.jpg)

你可以在这里获得他们的技术细节和演示软件： [http ://www.cs.ubc.ca/labs/imager/tr/2018/PerceptionDrivenVectorization/](http://www.cs.ubc.ca/labs/imager/tr/2018/PerceptionDrivenVectorization/)

结果非常好，令人印象深刻，但转换速度也令人印象深刻，太慢了。

该论文的作者来自：
1 英属哥伦比亚大学，2 Adob​​e，3 国立台湾大学

我不知道他们为什么不做一些速度优化，构建一个更好的用户界面，并从这项工作中制作一个很棒的工具。

# asp.net - 更改 ASP.NET 为 ASP.NET Web 服务生成的 WSDL

> ID：188687
> 
> 赞同：3
> 
> 时间：2008-10-09T19:00:25.807
> 
> 标签：asp.net, .net, xml, web-services, wsdl

有没有办法改变 asp.net 在从 .asmx 文件生成的 WSDL 中生成元素的方式？具体来说，它似乎标记了所有元素 minoccurs="0" 并且有些元素我想成为 minoccurs="1" （又名必填字段）。

其中一个是 Web 服务的参数（例如 foo(arg1, arg2)，我希望 arg2 在 WSDL 中生成为 minoccurs="1"），另一个是类中对应于 arg1 的特定字段。我是否必须放弃自动生成 WSDL 并采取“合同优先”的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T20:50:42.323

我认为该`XmlElement(IsNullable = true)`属性将完成这项工作：

```
using System.Xml.Serialization;

[WebMethod]
public string MyService([XmlElement(IsNullable = true)] string arg)
{
  return "1";
} 
```

* * *

编辑[VB版]

```
Imports System.Xml.Serialization

Public Function MyService(<XmlElement(IsNullable:=True)> ByVal arg As String) As String
  Return ("1")
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:46:05.210

使用 XMLElement(IsNullable=true) 会生成 minOccurs=1，但它也会在 WSDL 中生成 nillable="true"，这是不可取的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T20:57:09.177

我知道的唯一方法（没有升级到 WCF）是使用 [XmlSchemaProvider] 属性。这允许您指定一个方法，该方法将返回将作为 WSDL 的一部分发出的模式。

到了这一步，您可能会发现最好还是手动编写自己的 WSDL，这样您就不必担心如何强制 .NET 为您编写它。然后，您只需将 WSDL 放在网站上的已知位置（可能与服务相同的站点），然后告诉您的客户使用[http://url/service.wsdl](http://url/service.wsdl)而不是 service.asmx?wsdl。

# c# - 在 C# 中函数名前的波浪号是什么意思？

> ID：188688
> 
> 赞同：180
> 
> 时间：2008-10-09T19:00:38.723
> 
> 标签：c#, syntax, tilde

我正在查看一些代码，它有这样的声明：

```
~ConnectionManager()
{
    Dispose(false);
} 
```

该类实现了`IDisposable`接口，但我不知道这是否是波浪号（~）用于的一部分。

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2008-10-09T19:05:46.577

**~ 是析构函数**

1.  析构函数是自动调用的，不能显式调用。
2.  析构函数不能重载。因此，一个类最多可以有一个析构函数。
3.  析构函数不是继承的。因此，一个类除了可以在其中声明的析构函数之外没有其他析构函数。
4.  析构函数不能与结构一起使用。它们仅与类一起使用。当任何代码不再可能使用该实例时，该实例就有资格被销毁。
5.  实例的析构函数可以在实例符合销毁条件后的任何时间执行。
6.  当一个实例被析构时，它的继承链中的析构函数被调用，顺序是从派生最多到派生最少。

**敲定**

在 C# 中，Finalize 方法执行标准 C++ 析构函数会执行的操作。在 C# 中，您不将其命名为 Finalize - 您使用 C++ 析构函数语法，即在类名称之前放置一个波浪号 (~) 符号。

**处置**

最好在类的用户可以显式调用的`Close()`或方法中处理对象。`Dispose()`Finalize（析构函数）由 GC 调用。

*IDisposable*接口告诉世界您的类持有需要释放的资源，并为用户提供释放它们的方法。如果确实需要在类中实现终结器，则 Dispose 方法*应*使用该`GC.SuppressFinalize()`方法来确保抑制实例的终结。

**用什么？**

显式调用析构函数是不合法的。垃圾收集器将调用您的析构函数。如果您确实要处理想要尽快关闭和处置的宝贵非托管资源（例如文件句柄），则应该实现 IDisposable 接口。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-09T19:04:29.527

这是一个[终结](http://msdn.microsoft.com/en-us/library/system.object.finalize.aspx)器。老实说，您应该很少需要编写终结器。你真的只需要写一个，如果：

*   您可以直接访问非托管资源（例如通过`IntPtr`）并且您不能使用`SafeHandle`这使得它更容易
*   您正在`IDisposable`一个未密封的类中实现。（我的偏好是密封类，除非它们是为继承而设计的。）在这种情况下，终结器是规范 Dispose 模式的一部分。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-09T19:02:12.013

它用于指示类的析构函数。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-09T19:02:35.460

和C++一样，都是析构函数；但是在 C# 中，您不会显式调用它，而是在垃圾收集器收集对象时调用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T19:10:15.413

请参阅[析构函数（C# 编程指南）](http://msdn.microsoft.com/library/66x5fx1b.aspx)。但是请注意，与 C++ 不同，程序员无法控制何时调用析构函数，因为这是由垃圾收集器决定的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T19:02:44.803

~ 通常代表一个解构器。它在对象死亡之前运行。

[这是我发现的 C# 解构器的描述](http://www.ondotnet.com/pub/a/dotnet/2002/02/11/csharp_traps.html)

# javascript - 如何在 javascript 中编写自己的确认对话框？

> ID：188691
> 
> 赞同：3
> 
> 时间：2008-10-09T19:00:57.243
> 
> 标签：javascript, modal-dialog

我想在javascript中写一些类似于confirm()的东西，但我想自己写，这样我就可以给对话框设置皮肤了。在思考我如何基本上强制javascript线程等到用户响应然后返回true或false时遇到了麻烦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T19:03:34.350

如果我是你，我会看一个流行的 javascript 库。大多数都包含某种模式对话框。

我为 JQuery 找到的一对是[jqModal](http://dev.iceburg.net/jquery/jqModal/)和[SimpleModal](http://www.ericmmartin.com/projects/simplemodal/)。

当您构建模态对话框时，您必须将事件绑定到按钮，因此您可以执行以下操作：

```
function askUserYesOrNo() {
  var myDialog = $('<div class="mydialog"><p>Yes or No?</p><input type="button" id="yes" value="Yes"/><input type="button" id="no" value="No"/></div>');
  $("#yes").click(handleYes);
  $("#no").click(handleNo);
  myDialog.modal(); //This would have to be replaced by whatever syntax the modal framework uses
}

function handleYes() {
  //handle yes...
}

function handleNo() {
  //handle no...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T19:10:08.970

您真的想为此使用一个框架，因为您在尝试自己构建它时会遇到许多奇怪的跨浏览器问题。

我使用[jqModal](http://dev.iceburg.net/jquery/jqModal/)取得了不错的效果，这是一个用于 jQuery 框架的插件，可让您定义模式对话框，但这绝不是唯一的选择；尝试谷歌搜索[jquery modal](http://www.google.com/search?q=jquery+modal)或[yui modal](http://www.google.com/search?q=yui+modal)以获得一些替代方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T01:06:24.603

对于 Mootools，有[moo.rd 的 Custom.Confirm](http://www.moord.it/examples/custom_confirm)和[Windoo.Confirm](http://windoo.110mb.com/template/windoo.html)供大家参考。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T19:51:45.003

你可以使用窗口。[showModalDialog](http://msdn.microsoft.com/en-us/library/ms536759(VS.85).aspx) ( [mozilla](http://developer.mozilla.org/en/DOM/window.showModalDialog) )，但它是 Internet Explorer 引入的非标准功能。现在 Firefox 3 和 Safari 也支持它（我不确定哪个版本，但至少 3.1 和更高版本，但不是 iPhone）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T00:37:19.763

一个简单的 YUI 模态灯箱（[示例](http://bravo9.com/journal/c5b048f5-b278-46d1-9a7e-0d3035094f52/assets/example.html#)）：

[http://bravo9.com/journal/a-simple-lightbox-modal-dialog-with-yui-c5b048f5-b278-46d1-9a7e-0d3035094f52/](http://bravo9.com/journal/a-simple-lightbox-modal-dialog-with-yui-c5b048f5-b278-46d1-9a7e-0d3035094f52/)

# c# - 为什么使用 EventArgs.Empty 而不是 null？

> ID：188692
> 
> 赞同：69
> 
> 时间：2008-10-09T19:01:04.807
> 
> 标签：c#, events, eventargs

我记得在多个场合和多个地点读到，在触发典型事件时：

```
protected virtual OnSomethingHappened()
{
    this.SomethingHappened(this, EventArgs.Empty);
} 
```

如果没有有趣的事件参数，则 e 应该是 EventArgs.Empty，而不是 null。

我遵循了我的代码中的指导，但我意识到我不清楚为什么这是首选技术。为什么规定的合同更喜欢 EventArgs.Empty 而不是 null？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-09T19:07:58.757

我相信 NOT NULL 背后的原因是，当作为参数传递时，该方法不需要潜在地处理空引用异常。

如果您传递 null，并且该方法尝试使用 e 执行某些操作，它将获得 null 引用异常，而使用 EventArgs.Empty 则不会。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-03T22:45:43.800

`EventArgs.Empty`是[Null 对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)的一个实例。

基本上，有一个表示“无值”的对象，以避免在使用它时检查 null。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-09T19:12:14.130

我相信`EventArgs.Empty`它用于维护通过事件传递参数的约定，即使不需要。

Mitchel Sellers 在我的帖子中途发布了我的另一半理由：如果方法尝试使用该参数执行某些操作（除了检查它是否为空），它会防止空引用异常。

`EventArgs.Empty` 基本上完成了全局定义的事件参数的工作，没有额外的信息。

举一个维护约定的类似示例，我们的团队使用`string.Empty`初始化字符串，否则不同的编码人员可能会使用`newString = ""; or newString = " "; or newString = null;`，所有这些都可能针对不同的检查条件产生不同的结果。

使用`EventArgs.Empty`vs的一个（有点迂腐的）原因`new EventArgs()`是前者不会初始化一个 new `EventArgs`，从而节省了少量内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T19:10:27.067

如果您使用的通用方法具有`EventHandler`从任何事件处理程序调用的签名并同时传递*`object sender`*and *`EventArgs e`*，则它可以调用`e.ToString()`，例如用于记录事件，而不必担心空指针异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T19:20:38.153

我使用了很长时间的“new EventArgs()”而不是“EventArgs.Empty”......我认为重要的是传递不会导致 Null 异常的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-17T13:20:38.697

来自阿尔巴哈里的书：`"in order to avoid unnecessarily instantiating an instance of EventArgs."`

# c# - 如果构造函数抛出异常，是否调用析构函数？

> ID：188693
> 
> 赞同：49
> 
> 时间：2008-10-09T19:01:05.527
> 
> 标签：c#, c++, destructor, finalizer

寻找 C# 和 C++ 的答案。（在 C# 中，将“析构函数”替换为“终结器”）

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-09T19:07:53.407

它适用于 C#（参见下面的代码），但不适用于 C++。

```
using System;

class Test
{
    Test()
    {
        throw new Exception();
    }

    ~Test()
    {
        Console.WriteLine("Finalized");
    }

    static void Main()
    {
        try
        {
            new Test();
        }
        catch {}
        GC.Collect();
        GC.WaitForPendingFinalizers();
    }
} 
```

这将打印“Finalized”

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-09T19:43:40.573

序言：Herb Sutter 有一篇关于这个主题的精彩文章：

[http://herbsutter.wordpress.com/2008/07/25/constructor-exceptions-in-cc-and-java/](http://herbsutter.wordpress.com/2008/07/25/constructor-exceptions-in-c-c-and-java/)

## C++：是和否

如果对象的构造函数抛出（对象“从未存在”），则不会调用对象析构函数，但可以调用其内部对象的析构函数。

总而言之，对象的每个内部部分（即成员对象）都会以与构造相反的顺序调用其析构函数。除非以某种方式使用 RAII，否则在构造函数中构建的每个东西都不会调用其析构函数。

例如：

```
struct Class
{
   Class() ;
   ~Class() ;

   Thing *    m_pThing ;
   Object     m_aObject ;
   Gizmo *    m_pGizmo ;
   Data       m_aData ;
}

Class::Class()
{
   this->m_pThing = new Thing() ;
   this->m_pGizmo = new Gizmo() ;
} 
```

创建顺序将是：

1.  m_aObject 将调用其构造函数。
2.  m_aData 将调用其构造函数。
3.  类构造函数被调用
4.  在 Class 构造函数中，m_pThing 将调用其 new 构造函数。
5.  在 Class 构造函数中，m_pGizmo 将调用其 new 构造函数。

假设我们正在使用以下代码：

```
Class pClass = new Class() ; 
```

一些可能的情况：

*   如果 m_aData 在构造时抛出，m_aObject 将调用其析构函数。然后，由“new Class”分配的内存被释放。

*   如果 m_pThing 抛出新事物（内存不足），m_aData，然后 m_aObject 将调用它们的析构函数。然后，由 new Class 分配的内存被释放。

*   如果 m_pThing 在构造时抛出，“new Thing”分配的内存将被释放。然后是 m_aData，然后是 m_aObject 将调用它们的析构函数。然后，由 new Class 分配的内存被释放。

*   如果 m_pGizmo 在构建时抛出，“new Gizmo”分配的内存将被释放。然后是 m_aData，然后是 m_aObject 将调用它们的析构函数。然后，由 new Class 分配的内存被释放。**请注意，m_pThing 泄露了**

如果您想提供基本异常保证，则不得泄漏，即使在构造函数中也是如此。因此，您必须以这种方式编写（使用 STL，甚至 Boost）：

```
struct Class
{
   Class() ;
   ~Class() ;

   std::auto_ptr<Thing>   m_pThing ;
   Object                 m_aObject ;
   std::auto_ptr<Gizmo>   m_pGizmo ;
   Data                   m_aData ;
}

Class::Class()
   : m_pThing(new Thing())
   , m_pGizmo(new Gizmo())
{
} 
```

甚至：

```
Class::Class()
{
   this->m_pThing.reset(new Thing()) ;
   this->m_pGizmo.reset(new Gizmo()) ;
} 
```

如果您想/需要在构造函数中创建这些对象。

这样，无论构造函数在哪里抛出，都不会泄漏。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-09T20:06:34.847

仍在构造的类的析构函数未被调用，因为该对象从未完全构造。

然而，它的基类（如果有的话）的析构函数被调用，因为该对象被构造为一个基类对象。

此外，任何成员变量都将调用其析构函数（正如其他人所指出的那样）。

注意：这适用于 C++

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T19:14:03.800

在 C++ 中，答案是否定的——*不*调用对象的析构函数。

*但是，将*调用对象上任何成员数据的析构函数，除非在构造其中一个时抛出*异常*。

C++ 中的成员数据按照其声明的顺序进行初始化（即构造），因此当构造函数抛出时，所有已初始化的成员数据——无论是在成员初始化列表 (MIL) 中显式地还是以其他方式——都将被拆除再次以相反的顺序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T19:08:19.083

如果构造函数没有完成执行，则该对象不存在，因此没有什么可破坏的。这是在 C++ 中，我不知道 C#。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T21:26:47.760

对于 C++，这在上一个问题中得到了解决： [以下代码是否会导致 c++ 中的内存泄漏](https://stackoverflow.com/questions/147572/will-the-below-code-cause-memory-leak-in-c)

由于在 C++ 中，当构造函数中抛出异常时，不会调用析构函数，但会调用对象成员（已构造的）的 dtor，这是在原始指针上使用智能指针对象的主要原因 - 它们是在这种情况下防止内存泄漏的好方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T19:13:48.370

C++ -

没有。部分构造的对象不调用析构函数。一个警告：析构函数将被调用为其完全构造的成员对象。（包括自动对象和本机类型）

顺便说一句 - 你真正要找的是“堆栈展开”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T19:16:20.143

不要做导致构造函数异常的事情。

在可以抛出异常的构造函数之后调用 Initialize()。

# c# - C#中的颜色相干向量

> ID：188719
> 
> 赞同：4
> 
> 时间：2008-10-09T19:07:09.087
> 
> 标签：c#, image, histogram

我和一个朋友即将着手创建一台机器，它可以执行一些图像比较以进行排序。我知道直方图比较，并且通常相信，预先计算并存储在数据库表中的列中的每个图像的小直方图网格通常会在第一次通过时为我们提供很好的匹配，因为我们正在匹配类似的东西。

我们要执行的第二个比较是使用从我们的主题图像到候选图像通过直方图匹配测试的图像的[颜色相干向量(CCV)。](http://tinyurl.com/4lo8nl)我知道这种比较更精确。

我的朋友相信他可以使用[C# 包装器](http://www.codeproject.com/KB/cs/Intel_OpenCV.aspx)在 C# 中开发 CCV到[OpenCV](http://sourceforge.net/projects/opencvlibrary/)。我很确定他也可以。不过我想知道：

1.  有没有人已经在 C# 中完成了这项工作并发布了源代码？还是 C# 包装器？
2.  我们是在找错树了吗？（我们应该只使用 CCV 并在数据库级别放弃直方图比较？还是 CCV 太多了？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T03:58:44.147

OpenCV 站点提到了与 VB 的兼容性，因此如果它公开了 COM 接口，我不会感到惊讶。如果是这样，只需添加对它的引用并让 Visual Studio 为您构建 PIA（包装器）。

不幸的是，我不知道你提到的图像处理算法的细节，所以我不能就你的第二个问题提供建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-29T23:14:57.597

好吧，我认为仅使用颜色相干矢量将在您的应用程序中取得良好的效果。我试过了，效果很好。[（此链接提供了Color Coherence Vector](http://tarekmamdouh.hubpages.com/hub/Image-Retrieval-Color-Coherence-Vector)的逐步实现，也许您会发现它使用

我还找到了一个 matlab 实现，你可以看看（[github 链接](https://github.com/TarekVito/ColorCoherenceVector)）

# sql - 有什么方法可以将价值从一个单元格转移到另一个单元格？

> ID：188720
> 
> 赞同：0
> 
> 时间：2008-10-09T19:07:10.177
> 
> 标签：sql, mysql, database

SQL 语言或 MySQL（或其他 DBMA）中是否有任何方法可以将值从一个单元格传输到另一个单元格？例如，假设有一个名为 user_cars 的表，其结构如下：

```
|id| |user_name| |num_cars| 
```

Bob 有 5 辆车，John 有 3 辆车。有没有办法在一个查询中从 Bob 中减去 2 辆汽车并将 2 到 John 中？我知道这可以通过两个更新查询来完成，但我只想知道是否有更有效的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T19:15:21.223

对于 Oracle，您可以这样做。不知道mysql中有没有等价的。显然，这个特定的陈述非常具体到你所说的例子。

```
 UPDATE user_cars
   SET num_cars = num_cars +
                     CASE WHEN user_name='Bob' THEN -2
                          WHEN user_name='John' THEN +2
                     END
   WHERE user_name IN ( 'Bob', 'John' ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:16:48.753

这会起作用，但并不令人愉快：

```
UPDATE USER_CARS UC
SET
  NUM_CARS = NUM_CARS + CASE WHEN UC.USER_NAME = 'Bob'
                             THEN -2  --take from bob
                             WHEN UC.USER_NAME = 'John'
                             THEN 2  --give to John
                             ELSE 0  --no change for anybody else
                        END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:12:35.410

这就是交易的目的......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T10:57:22.213

正如其他人所解释的，您可以使用 CASE 语句来做到这一点。
但是，这样做可能是不明智的，因为它使代码的意图更难看出。这将使后续程序员更难理解代码的用途。

除非您有特定原因需要在一个语句中执行此操作，否则最好的做法是使用 2 个更新语句，如果需要，将它们包装在事务中。

我经常想起这句话（尽管我不得不在[wikiquote](http://en.wikiquote.org/wiki/Programming)上查找出处）：

“必须编写程序供人们阅读，并且只是偶然地供机器执行。” - Abelson & Sussman，SICP，第一版前言

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T19:12:45.703

如果您真的想在一个查询中执行此操作，您可以对表的自连接进行更新，但它的可读性较差并且可能效率较低。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-12T12:15:28.247

我同意 Jonas Klemming 的观点，没有任何有意义的方法可以做到这一点。这正是交易被发明的目的。

# svg - 在网站上动态生成 SVG 图像是否明智？

> ID：188731
> 
> 赞同：4
> 
> 时间：2008-10-09T19:09:07.693
> 
> 标签：svg

我只是在学习 SVG，它看起来很棒，但我不确定浏览器是否支持——人们成功地解决了这个问题，还是现在还为时过早？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-26T03:14:08.997

[Raphael](http://raphaeljs.com/)是一个跨浏览器的矢量图形库，值得一看。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T19:17:37.910

您可以使用 John Resig 的[processing.js](http://ejohn.org/blog/processingjs/)库来获得跨浏览器兼容性。

还有[Walter Zorn 的（大量 DIV）](http://jsfiddle.net/stodolaj/UbB3K/)技术，它不使用 SVG。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-11T05:23:55.023

有一种新方法可以绕过 Internet Explorer 缺乏 svg 功能：

谷歌项目[svgweb](http://code.google.com/p/svgweb/)：使用 Flash 的 Web 浏览器的可缩放矢量图形。它是一个 JavaScript 库，在许多浏览器上提供 SVG 支持，包括 Internet Explorer、Firefox 和 Safari。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-09T10:51:45.287

我认为值得更新此对话框，因为在 SVG 跨浏览器中事情变得越来越“可行”。作为为组织实施了一些（相当重要的）系统的人，我一直在“涉足”“跨浏览器”SVG 的世界。我在 11 个月前开始的对话中看到“还为时过早”的字样，我正在添加它。

请访问我的网站，该网站展示了 Raphael 的一些功能。进站后，您可以轻松地链接到 Raphael 的主要站点。

我的网站是用 Raphael 0.8.6 实现的，但是“Rap”的创建者刚刚从 beta 版带来了 1.0 版，并且（另外）完全支持 SVG“路径”

如果您想以当前状态访问 CROSS-BROWSER 交互式/SVG 世界，请通过以下方式访问这些不断更新的网站：

[http://www.irunmywebsite.com/raphael/raphaelsource.html](http://www.irunmywebsite.com/raphael/raphaelsource.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T19:16:15.573

我想说您最好的选择是以您最喜欢的任何格式创建图像，然后使用 ImageMagick 之类的东西将其转换为 SVG。您可以手动或使用库编写 PostScript，或者使用 ImageMagick API 从简单的文本/形状图元直接创建图像。有很好的文档，您可以将 ImageMagick 作为 COM 对象调用（假设您的语言具有良好的 COM 支持）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T19:34:14.290

[Adobe 还制作了一个 SVG 查看器插件，您可以在您的网站上链接到该插件，](http://www.adobe.com/svg/viewer/install/)以便人们获得您网站的全部功能。不幸的是，他们将停止对该插件的支持，但到那时，预计将会有更多的浏览器支持（希望如此）。几年前，我在一家使用 SVG 编写整个 Web 应用程序的公司工作，我们在这个插件上取得了巨大的成功。

# perl - 为什么我应该在 Perl 中使用 Carp 而不是警告？

> ID：188738
> 
> 赞同：26
> 
> 时间：2008-10-09T19:10:48.610
> 
> 标签：perl, module, carp

人们不断给我举鲤鱼的例子而不是警告。为什么？是什么让鲤鱼比警告更好？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-09T19:16:43.327

carp 为您提供有关消息来自何处的更多信息（上下文）

```
#!/usr/bin/perl

use Carp;

foo();
bar();
baz();

sub foo {
  warn "foo";
}

sub bar {
  carp "bar";
}

sub baz {
  foo();
  bar(); 
} 
```

生产

```
foo at ./foo.pl line 9.
bar at ./foo.pl line 13
        main::bar() called at ./foo.pl line 6
foo at ./foo.pl line 10.
bar at ./foo.pl line 14
        main::bar() called at ./foo.pl line 19
        main::baz() called at ./foo.pl line 7 
```

这个小程序有点傻，但是当你想知道是谁调用了这个正在吹毛求疵的方法时，它会派上用场。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-09T19:35:40.870

我`warn`用于脚本和简单程序，以及`Carp`在任何模块中。子例程使用调用当前`Carp`子例程的文件名和行号，因此更容易找到导致问题的原因（不仅仅是问题出现的位置）。

Damian 建议`Carp`不要在*Perl Best Practices*`warn`中的“报告失败”中推荐，但没有区分作为顶级代码结构的脚本和作为程序使用的组件的模块。

 *我最近几乎不关心这个，因为我一直在使用[Log::Log4perl](http://search.cpan.org/dist/Log-Log4perl)来处理所有这些。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-09T19:14:02.393

carp 更适合在模块内进行调试。如果您只是编写一个简单的脚本，则没有任何好处。来自[鲤鱼文档](http://perldoc.perl.org/Carp.html)：

> Carp 例程在您自己的模块中很有用，因为它们的行为类似于 die() 或 warn()，但带有更可能对您的模块用户有用的消息。在 cluck、confes 和 longmess 的情况下，上下文是调用堆栈中每个调用的摘要。对于较短的消息，您可以使用 carp 或 croak 将错误报告为来自调用模块的位置。不能保证这就是错误所在，但这是一个有根据的猜测。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-09T19:51:56.967

`Carp`从调用者的角度报告错误。这对于您通常想要警告错误使用（例如缺少参数）并识别错误*发生*的位置而不是*检测到的位置的模块很有用。*这对于可能在许多地方使用的实用功能尤其重要。

大多数作者`warn`在脚本和`carp`模块中使用。有时，`warn`当我希望错误消息反映模块实现中的问题（例如，它应该支持但不支持的情况）时，我会在模块内部使用。可以说，`cluck`在这种情况下会更好，因为它提供了完整的堆栈回溯.

# .net - 有没有办法将通用列表转换为接口/基类类型列表？

> ID：188769
> 
> 赞同：3
> 
> 时间：2008-10-09T19:17:57.567
> 
> 标签：.net, generics, covariance

我试图向某人展示在他们创造的疯狂情况下使用接口。它们在列表中有几个不相关的对象，并且需要对每个对象中的两个字符串属性执行操作。我要指出的是，如果他们将属性定义为接口的一部分，他们可以使用接口对象作为作用于它的方法参数的类型；例如：

```
void PrintProperties(IEnumerable<ISpecialProperties> list)
{
    foreach (var item in list)
    {
        Console.WriteLine("{0} {1}", item.Prop1, item.Prop2);
    }
}
```

这似乎一切都很好，但是需要处理的列表没有（也不应该）使用接口作为类型参数声明。但是，您似乎无法转换为不同的类型参数。例如，这失败了，我不明白为什么：

```
using System;
using System.Collections.Generic;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            List<Test> myList = new List<Test>();
            for (int i = 0; i < 5; i++)
            {
                myList.Add(new Test());
            }

            PrintList((IEnumerable<IDoSomething>)myList);
        }

        static void PrintList(IEnumerable<IDoSomething> list)
        {
            foreach (IDoSomething item in list)
            {
                item.DoSomething();
            }
        }
    }

    interface IDoSomething
    {
        void DoSomething();
    }

    public class Test : IDoSomething
    {
        public void DoSomething()
        {
            Console.WriteLine("Test did it!");
        }
    }
}
```

我*可以*使用该`Enumerable.Cast<T>`成员来执行此操作，但我一直在寻找一种可能也适用于 .NET 2.0 的方法。看起来这应该是可能的；我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T19:23:35.027

问题在于方法，而不是如何调用......

```
void PrintProperties<SP>(IEnumerable<SP> list) where SP: ISpecialProperties
{
    foreach (var item in list)
    {
        Console.WriteLine("{0} {1}", item.Prop1, item.Prop2);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T19:26:02.573

它失败的原因是泛型在 C# 中还没有表现出差异。

但是，对于 IEnumerable<T> 的修复，请尝试以下操作：

```
public static IEnumerable<TBase> SafeConvert<TBase, TDerived>(IEnumerable<TDerived> source)
    where TDerived : TBase
{
    foreach (TDerived element in source)
    {
        yield return element; // Implicit conversion to TBase
    }
} 
```

编辑：对于这种特殊情况，另一个现有的答案比上面的要好，但是如果您确实需要“转换”序列，我会把它留在这里作为一个普遍有用的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:28:09.917

您可以`foreach`在您拥有的列表上使用 a 。`foreach`做了一个内置的演员表。因此，如果您将循环从函数中取出，您可以编写类似的内容

```
List<Test> myList = new List<Test>();
for (int i = 0; i < 5; i++)
{
   myList.Add(new Test());
}

foreach (IDoSomething item in myList)
{
   item.DoSomething();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T20:34:25.430

您想要的称为“接口协方差”，目前 C# 不支持。[您可以在Eric Lippert 的博客](http://blogs.msdn.com/ericlippert/archive/tags/Covariance+and+Contravariance/default.aspx)上了解它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-09T19:29:22.660

这并不能回答您的问题（或者我猜是练习的重点：），但在这种情况下，我只是通过将特殊属性附加到感兴趣的属性来使用反射。

# windows-xp - 如何在windows xp中将进程分配给核心

> ID：188776
> 
> 赞同：3
> 
> 时间：2008-10-09T19:19:11.090
> 
> 标签：windows-xp, multicore

有没有办法在运行 Windows XP 的多核系统上将进程分配给一个核心（或多个核心）？

使用 GUI 的答案是可以接受的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T19:22:25.217

您可以使用任务管理器设置进程的亲和性。右键单击“进程”选项卡中的进程，然后选择“设置关联...”。取消选中您不希望它运行的所有处理器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:26:24.413

如果您正在谈论在代码中执行此操作（ala 编程），您可以利用[SetThreadAffinityMask](http://msdn.microsoft.com/en-us/library/ms686247(VS.85).aspx)函数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:21:22.333

您需要在应用程序上设置关联。 [这里有一篇文章告诉你如何](http://windows.pradeep.net.in/2007/05/configuring-windows-xp-applications-for.html)！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-10T20:47:15.700

Curtisk，SetThreadAffinityMask是针对一个线程的，他想针对一个进程。但是对于一个进程，它是类似的：SetProcessAffinityMask。

请注意，线程的亲和性必须位于其进程的亲和性范围内，否则根本不会设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T19:21:13.317

肯定的事。打开 Windows 任务管理器，右键单击该进程，然后选择“设置关联”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T19:21:18.357

任务管理器 > 应用程序 > Rt 单击 - 转到进程 > Rt 单击 - 设置亲和力

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T19:21:38.917

在任务管理器中，右键单击进程（在“进程”视图中）并选择“设置关联...”

# regex - grep：匹配文字“+”

> ID：188787
> 
> 赞同：2
> 
> 时间：2008-10-09T19:22:00.647
> 
> 标签：regex, cygwin, grep

我需要在我的 sql 脚本（即 Oracle 外连接表达式）中找到出现的“(+)”。意识到“+”、“（”和“）”都是特殊的正则表达式字符，我尝试了：

```
grep "\(\+\)" *

```

现在这确实返回了“（+）”的出现，但也返回了其他行。（似乎任何在同一行上带有打开和关闭括号的东西。）回想一下，括号仅对扩展的 grep 是特殊的，我试过：

```
grep "(\+)" *
grep "(\\+)" *

```

这两个都只返回包含“()”的行。所以假设“+”不能被转义，我尝试了一个老把戏：

```
grep "([+])" *

```

这样可行。我使用非正则表达式工具交叉检查了结果。

**问题**：有人能解释一下“+”字符到底是怎么回事吗？是否有一种不那么笨拙的方式来匹配“（+）”？

（我正在使用 cygwin grep 命令。）

**编辑**：感谢您的解决方案。-- 现在我看到，根据 Bruno 引用的 GNU grep 手册，“ `\+`”在*基本*表达式中使用时赋予“+”其*扩展*含义，因此匹配一个或多个“（”后跟一个“） ”。在我的文件中总是“（）”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T19:33:07.707

GNU grep（包含在 Cygwin 中）支持正则表达式的两种语法：基本和扩展。`grep`使用基本正则表达式和`egrep`/或`grep -E`使用扩展正则表达式。[grep 手册](http://www.gnu.org/software/grep/doc/grep_12.html#SEC12)中的基本区别如下：

> 在基本的正则表达式中，元字符`?`, `+`, `{`, `|`, `(`, 和`)`失去了它们的特殊含义；而是使用反斜杠版本`\?`, `\+`, `\{`, `\|`, `\(`, 和`\)`.

由于您想要字符的*普通*含义，`(` `+` `)`因此以下两种形式中的任何一种都应该适合您的目的：

```
grep "(+)" *       # Basic
egrep "\(\+\)" *   # Extended 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T19:23:27.837

您可能需要添加一些反斜杠，因为 shell 正在吞噬它们。

ETA：实际上，我刚刚尝试了我的 Cygwin，`grep "(+)"`似乎可以满足您的需求。

# php - 如何使用 PHP 的 GD 库对图像执行接缝雕刻？

> ID：188789
> 
> 赞同：4
> 
> 时间：2008-10-09T19:22:09.493
> 
> 标签：php, image, gd, resize, seam-carving

我正在开发一个使用[PHP 的 GD](http://us.php.net/gd)库调整图像大小的项目。我希望能够添加使用[接缝雕刻](http://en.wikipedia.org/wiki/Seam_carving)来调整图像大小的选项，但不希望需要像[ImageMagick](http://www.imagemagick.org/script/index.php)（它可以使用[其液体重新缩放功能](http://www.imagemagick.org/Usage/resize/#liquid-rescale)进行接缝雕刻）之类的东西来完成此操作。

由于 GD 中没有内置的接缝雕刻功能，**有没有办法使用 PHP 的 GD 库**或其他内置的 PHP 函数对图像执行接缝雕刻？或者，你知道缝雕最终会不会被烤成GD吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T07:28:38.277

虽然您可以使用 GD 实现这一点，但如果您可以控制服务器环境，最好的办法是创建一个外部脚本/程序来雕刻图像。PHP 将成为进行此类计算的巨大瓶颈。即使是基本的矩阵转换也存在达到 PHP 配置中设置的最大执行时间的严重风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T19:57:58.157

我不明白为什么 GD 不可能，但我可以告诉你它会很慢。

Imagemagick 是开源的，所以我想你可以把这个函数翻译成 PHP。

# image - 我可以使用 VBScript 对 gif 进行 base64 编码吗？

> ID：188793
> 
> 赞同：0
> 
> 时间：2008-10-09T19:23:17.930
> 
> 标签：image, vbscript, base64

我想要做的是编码一个 gif 文件，以包含在 XML 文档中。这就是我现在所拥有的，但它似乎不起作用。

```
Function gifToBase64(strGifFilename)
 On Error Resume Next
 Dim strBase64
 Set inputStream = WScript.CreateObject("ADODB.Stream")
 inputStream.LoadFromFile strGifFilename
 strBase64 = inputStream.Text
 Set inputStream = Nothing
 gifToBase64 = strBase64
End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-02T06:48:50.380

[我最近为JScript](http://cwestblog.com/2013/09/18/jscript-convert-image-to-base64/)和[VBScript](http://cwestblog.com/2013/09/23/vbscript-convert-image-to-base-64/)的实现写了一篇关于这个主题的文章。这是我为 VBScript 提供的解决方案：

```
Public Function convertImageToBase64(filePath)
  Dim inputStream
  Set inputStream = CreateObject("ADODB.Stream")
  inputStream.Open
  inputStream.Type = 1  ' adTypeBinary
  inputStream.LoadFromFile filePath
  Dim bytes: bytes = inputStream.Read
  Dim dom: Set dom = CreateObject("Microsoft.XMLDOM")
  Dim elem: Set elem = dom.createElement("tmp")
  elem.dataType = "bin.base64"
  elem.nodeTypedValue = bytes
  convertImageToBase64 = "data:image/png;base64," & Replace(elem.text, vbLf, "")
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T21:49:58.010

在您对 Tomalak 的评论中，您声明您不想使用外部 dll，但在您尝试的示例中，您尝试使用 ADODB。因此，我怀疑您的意思是您不想安装在 vanilia windows 平台上本身不存在的 dll。

如果是这样，那么 MSXML 可能是您的答案：-

```
Function Base64Encode(rabyt)

    Dim dom: Set dom = CreateObject("MSXML2.DOMDocument.3.0")
    Dim elem: Set elem = dom.appendChild(dom.createElement("root"))
    elem.dataType = "bin.base64"
    elem.nodeTypedValue = rabyt

    Base64Encode = elem.Text

End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:26:39.937

看看这里：[Base64 Encode & Decode Files with VBScript](http://www.robvanderwoude.com/vbstech_files_encode_base64.html)。此示例依赖于免费的[XBase64 组件](http://www.xstandard.com/en/documentation/xbase64/)，并且仅提供了一个用于文件处理的包装器。

您也可以使用[纯 VBScript 实现](http://www.motobit.com/tips/detpg_Base64Encode/)，但在这里您必须自己处理文件。应该不会太难，但编码性能不会那么好。不过，对于一些小图像文件就足够了。

谷歌会出现更多。

# .net - 为什么我在调试时 Word 会冻结？

> ID：188802
> 
> 赞同：3
> 
> 时间：2008-10-09T19:26:11.573
> 
> 标签：.net, debugging, ms-word

每当我在 Visual Studio 2008 中的某个 C#.NET 应用程序中处于断点并启动 Microsoft Word 2007 时，word 将无法打开，直到我重新启动 C# 应用程序。我有一些关于为什么的理论，但有人确定吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T19:30:28.617

这可能是因为 Word 正在向顶级窗口发送 DDE 消息，而您的应用程序无法处理它，因为它挂在调试器中。Raymond Chen 对此有[一篇博文](http://blogs.msdn.com/oldnewthing/archive/2006/02/10/529525.aspx)（虽然与调试器没有直接关系，但效果相同）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:30:28.087

这种挂起的一个常见原因是（或曾经是）一个应用程序在启动时发送了一个广播 Windows 消息并期望每个窗口都有响应。如果您在调试器中打开了 GUI 应用程序，那么它将不会回复 Windows 消息，因此发送应用程序将挂起等待响应。我记得使用这种技术的最常见的程序类型是安装程序。

我不知道 Word 2007 是否发送任何广播消息，但这只是可能发生这种情况的一种方式。COM/OLE 的东西可以通过多种方式挂起，这对于 Word 来说似乎更有可能。

# c# - 文本框多行和空行消失

> ID：188808
> 
> 赞同：1
> 
> 时间：2008-10-09T19:26:40.433
> 
> 标签：c#, .net, .net-2.0, textbox

我有一个用 C# 和 .Net 2.0 构建的 Winform 应用程序。我有一个带有 MultiLine 属性的文本框。

问题是当有人写多行文本（按几个输入），按保存按钮，然后关闭并再次加载表单时，所有新行都消失了（文本至少在那里）。

例如，如果文本框里面有这个：

```
Line1

Line3 
```

保存并加载后它看起来像这样：

```
Line1 Line3 
```

知道为什么吗？

**更新**

数据库是 PostGres，当我使用 PGAdmin 时，我可以看到所有行和“输入”。所以持久性似乎已经保存了所有行......问题似乎出在我将字符串放回文本框中时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:33:23.777

如果我没记错的话，文本框实际上是一个字符串数组。

我认为你可以这样做：

```
textBox1.Lines = foo.Split(new String[] {"\n"},StringSplitOptions.RemoveEmptyEntries); 
```

再次编辑：如果要保留空白行，请更改为 StringSplitOptions.None

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T20:22:36.530

在 Windows 窗体中，所有回车都保存在多行文本框中，因此问题可能出在从数据库中检索数据的方式上。我从未使用过 PostGres，但我猜测您从数据库中检索文本的方式是用单个空格替换所有空格。

# sql - SQL - 表别名范围

> ID：188828
> 
> 赞同：4
> 
> 时间：2008-10-09T19:30:41.333
> 
> 标签：sql, scope, table-alias

我刚刚（昨天）学会了使用“exists”而不是“in”。

```
 BAD
 select * from table where nameid in ( 
          select nameid from othertable where otherdesc =  'SomeDesc' )      
 GOOD
 select * from table t where exists ( 
          select nameid from othertable o where t.nameid = o.nameid and otherdesc =  'SomeDesc' ) 
```

我对此有一些疑问：

1）我理解的解释是：*“这样做更好的原因是因为只会返回匹配的值，而不是构建大量可能的结果列表”*。这是否意味着虽然第一个子查询可能返回 900 个结果，但第二个子查询将只返回 1（是或否）？

2）过去我曾抱怨过RDBMS：“只能检索前1000行”，第二种方法可以解决这个问题吗？

3）第二个子查询中别名的范围是什么？...别名是否只存在于括号中？

例如

```
 select * from table t where exists ( 
          select nameid from othertable o where t.nameid = o.nameid and otherdesc =  'SomeDesc' )      
 AND 
          select nameid from othertable o where t.nameid = o.nameid and otherdesc =  'SomeOtherDesc' ) 
```

也就是说，如果我在第二个“存在”中使用相同的别名（ o 代表其他表），它会与第一个存在有什么问题吗？还是他们完全独立？

这是 Oracle 唯一相关的东西还是对大多数 RDBMS 有效？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T19:36:03.113

它特定于每个 DBMS，并取决于查询优化器。一些优化器检测 IN 子句并翻译它。

在我测试的所有 DBMS 中，别名仅在 ( ) 内有效

顺便说一句，您可以将查询重写为：

```
select t.* 
from table t 
join othertable o on t.nameid = o.nameid 
    and o.otherdesc in ('SomeDesc','SomeOtherDesc'); 
```

并且，回答您的问题：

1.  是的
2.  是的
3.  是的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T21:20:30.767

您正在涉足复杂的领域，称为“相关子查询”。由于我们没有关于您的表格和关键结构的详细信息，因此某些答案只能是“可能”。

在您的初始 IN 查询中，无论 OtherTable 是否包含列 NameID （实际上，OtherDesc 是否作为 Table 或 OtherTable 中的列存在 - 这在您的任何示例中都不清楚，但可能是列其他表）。这种行为是使相关子查询成为相关子查询的原因。当人们第一次遇到它时，它也是一种常规的焦虑来源——总是偶然的。由于 SQL 标准要求将子查询中的名称解释为引用外部查询中的列，如果子查询中提到的表中没有具有相关名称的列，但存在具有外部（主）查询中提到的表中的相关名称，

您的 Q1 的答案是“取决于情况”，但给出合理的假设（NameID 作为两个表中的列存在；OtherDesc 仅存在于 OtherTable 中），就返回的数据集而言，结果应该是相同的，但可能不是在性能方面相当。

Q2 的答案是，在过去，如果没有缺陷，您使用的是劣质的 DBMS。如果它支持 EXISTS，那么 DBMS 可能仍然会抱怨结果的基数。

应用于第一个 EXISTS 查询的 Q3 的答案是“t 在整个语句中可用作别名，但 o 仅可用作括号内的别名”。应用于您的第二个示例框 - 使用 AND 连接两个子选择（当我查看第二个子选择时，其中第二个缺少左括号），然后 "t 在整个语句中可用作别名并引用相同表，但有两个不同的别名都标记为“o”，每个子查询一个”。请注意，如果 OtherDesc 对于 OtherTable 中的给定 NameID 值是唯一的，则查询可能不会返回任何数据；否则，它需要 OtherTable 中具有相同 NameID 的两行以及 Table 中具有该 NameID 值的每一行的两个 OtherDesc 值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T19:47:22.343

1.  特定于 Oracle：当您使用 IN 子句编写查询时，您是在告诉基于规则的优化器您希望内部查询驱动外部查询。当您在 where 子句中编写 EXISTS 时，您是在告诉优化器您希望首先运行外部查询，并使用每个值从内部查询中获取一个值。请参阅 [“子查询中 IN 和 EXISTS 之间的区别”](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5297080.html)。
2.  大概。
3.  在子查询中声明的别名存在于子查询中。顺便说一句，我认为您的带有 2 个 AND 子查询的示例不是有效的 SQL。您的意思是 UNION 而不是 AND？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T19:36:27.577

就个人而言，我会为此使用联接，而不是子查询。

```
SELECT t.*
FROM yourTable t
    INNER JOIN otherTable ot
        ON (t.nameid = ot.nameid AND ot.otherdesc = 'SomeDesc') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-21T05:13:46.977

很难概括 EXISTS 总是比 IN 好。从逻辑上讲，如果是这样的话，那么 SQL 社区会用 EXISTS 代替 IN ......另外，请注意 IN 和 EXISTS 是不一样的，当你使用两者时结果可能会不同......

使用 IN，通常它会在不删除 NULL 的情况下对内部表进行一次全表扫描（因此，如果您的内部表中有 NULL，IN 默认情况下不会删除 NULLS）......而 EXISTS 删除 NULL 并且在相关子查询的情况下，它对来自外部查询的每一行运行内部查询。

假设没有 NULLS 并且它是一个简单的查询（没有相关性），如果您找到的行不是最后一行，则 EXIST 可能会执行得更好。如果它恰好是最后一行，EXISTS 可能需要像 IN 一样扫描到最后......所以类似的性能......

但是 IN 和 EXISTS 不可互换...

# c# - 为什么我的 ASP.NET AutoCompleteExtender 返回未定义？

> ID：188833
> 
> 赞同：3
> 
> 时间：2008-10-09T19:32:14.683
> 
> 标签：c#, linq, web-services, autocomplete

为什么我得到一个返回未定义变量列表的文本框？

当我运行此代码时：

```
var query = (from tisa in db.TA_Info_Step_Archives
                 where tisa.ta_Serial.ToString().StartsWith(prefixText)
                 select tisa.TA_Serial.ToString()).Distinct().Take(Convert.ToInt32(count));

return query.ToList<string>().ToArray(); 
```

我得到这个 XML 文件：

```
<string>200700160</string> 
  <string>200700161</string> 
  <string>200700162</string> 
  <string>200700163</string> 
  <string>200700164</string> 
  <string>200700170</string> 
  <string>200700171</string> 
  <string>200700172</string> 
  <string>200700173</string> 
  <string>200700174</string> 
  <string>200700175</string> 
  <string>200700176</string> 
  <string>200700177</string> 
  <string>200700178</string> 
  <string>200700179</string> 
  <string>200700180</string> 
  <string>200700181</string> 
  <string>200700182</string> 
  <string>200700183</string> 
  <string>200700184</string> 
```

但是，文本框返回一个列表`undefined`......

请帮忙？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T16:56:31.687

将我的 ajax 工具包更新到版本 1.0.10920 然后将我的代码更改为以下内容：

```
 foreach (DataRow dr in dt.Rows)
        {
            items.SetValue("\"" + dr["somenumber"].ToString() + "\"", i);
            i++;
        } 
```

.net 的周五深夜并不好玩。我没有生命。:-P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T07:49:52.327

我尝试了下面的代码，它对我有用：

```
items.SetValue("'"+dr["somenumber"]+"'", i); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T19:49:13.430

听起来问题不在于方法，而在于您将自动完成连接到方法的方式...您的扩展器是否类似于以下内容：

```
<cc1:AutoCompleteExtender ID="Result" runat="server" TargetControlID="txtSearch" ServiceMethod="YourMethodHere"
    ServicePath="~/Service/YourWebServiceHere.asmx"     CompletionInterval="500"
    EnableCaching="false" CompletionListCssClass="AutoComplete_List"  CompletionSetCount="10">
</cc1:AutoCompleteExtender> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T20:33:04.590

我看到的问题是 AJAX 库将数字视为整数。它需要将它们视为字符串。

我已将其转换为字符串，但仍然一无所获。我必须在数字中添加某种字符，以使它们的值现在被视为字符串。这是一件可怕的事情。但是在自动完成扩展器 .js 文件的 AJAX 库中的某处，它们不查找整数。他们只寻找需要查看的字符串，因为他们的构建方式有缺陷......

斯科特。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T22:28:06.697

我遇到了同样的问题。我同意这个问题肯定是围绕我们在这里使用数字而产生的。只要我将一个 alpha 附加到数组项的末尾，它就可以工作。我相信我们发现了一个错误。

这踢出了未定义的....

```
...
da.Fill(dt);
        string[] items = new string[dt.Rows.Count];
        int i = 0;
        foreach (DataRow dr in dt.Rows)
        {
            items.SetValue(Convert.ToString(dr["somenumber"]), i);
            i++;
        }
... 
```

在哪里加载列表就好了

```
...
da.Fill(dt);
        string[] items = new string[dt.Rows.Count];
        int i = 0;
        foreach (DataRow dr in dt.Rows)
        {
            items.SetValue(Convert.ToString(dr["somenumber"]+"foo"), i);
            i++;
        }
... 
```

对我来说似乎是一个错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-07T07:01:38.500

工具包 dll 版本之间存在差异。

在更新版本中，不需要插入“'”++“'”，并且可以正常工作。在 1.0.10920 版本中，它是必需的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-25T08:04:23.700

[http://www.asp.net/ajax](http://www.asp.net/ajax) 在上面的链接中，您会发现 AjaxControllToolkit 只需下载它并在您的应用程序中添加参考，我相信它会正常工作。问题是您使用非常旧的 AjaxControllToolkit，因此它无法正常工作，请使用 AjaxControllToolkit 3.5 或 4.0。

# php - 清理/清理 xpath 属性

> ID：188834
> 
> 赞同：6
> 
> 时间：2008-10-09T19:32:27.180
> 
> 标签：php, xml, xpath, code-injection

我需要为元素属性动态构造一个 XPath 查询，其中属性值由用户提供。我不确定如何清理或清理此值以防止 XPath 等效于 SQL 注入攻击。例如（在 PHP 中）：

```
<?php
function xPathQuery($attr) {
    $xml = simplexml_load_file('example.xml');
    return $xml->xpath("//myElement[@content='{$attr}']");
}

xPathQuery('This should work fine');
# //myElement[@content='This should work fine']

xPathQuery('As should "this"');
# //myElement[@content='As should "this"']

xPathQuery('This\'ll cause problems');
# //myElement[@content='This'll cause problems']

xPathQuery('\']/../privateElement[@content=\'private data');
# //myElement[@content='']/../privateElement[@content='private data'] 
```

最后一个特别让人想起以前的 SQL 注入攻击。

现在，我知道事实上会有包含单引号的属性和包含双引号的属性。由于这些是作为函数的参数提供的，那么清理这些输入的理想方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T13:31:57.813

XPath 实际上确实包含一种安全地执行此操作的方法，因为它允许以表达式的形式[引用变量。](http://www.w3.org/TR/xpath#section-Expressions)`$varname`PHP 的 SimpleXML 所基于的库[提供了一个接口来提供 variables](http://xmlsoft.org/html/libxml-xpathInternals.html#xmlXPathRegisterVariable)，但是您的示例中[的 xpath 函数并未公开该接口。](http://php.net/manual/en/function.simplexml-element-xpath.php)

作为一个真正多么简单的演示：

```
>>> from lxml import etree
>>> n = etree.fromstring('<n a=\'He said "I&apos;m here"\'/>')
>>> n.xpath("@a=$maybeunsafe", maybeunsafe='He said "I\'m here"')
True 
```

那是使用[lxml](http://codespeak.net/lxml/)，它是与 SimpleXML 相同的底层库的 python 包装器，具有类似的[xpath 函数](http://codespeak.net/lxml/xpathxslt.html#the-xpath-method)。布尔值、数字和节点集也可以直接传递。

如果切换到功能更强大的 XPath 接口不是一种选择，那么当给定外部字符串时，一种解决方法将是（随意适应 PHP），如下所示：

```
def safe_xpath_string(strvar):
    if "'" in strvar:
        return "',\"'\",'".join(strvar.split("'")).join(("concat('","')"))
    return strvar.join("''") 
```

返回值可以直接插入到您的表达式字符串中。由于这实际上不是很可读，因此它的行为方式如下：

```
>>> print safe_xpath_string("basic")
'basic'
>>> print safe_xpath_string('He said "I\'m here"')
concat('He said "I',"'",'m here"') 
```

请注意，您不能在`&apos;`XML 文档之外的表单中使用转义，通用 XML 序列化例程也不适用。但是，XPath concat 函数可用于在任何上下文中创建具有两种引号类型的字符串。

PHP 变体：

```
function safe_xpath_string($value)
{
    $quote = "'";
    if (FALSE === strpos($value, $quote))
        return $quote.$value.$quote;
    else
        return sprintf("concat('%s')", implode("', \"'\", '", explode($quote, $value)));
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-09T20:07:59.603

我将使用 DOM 创建一个单元素 XML 文档，使用 DOM 将元素的文本设置为提供的值，然后从 DOM 的 XML 字符串表示中获取文本。这将保证所有角色转义都正确完成，而不仅仅是我碰巧想到的角色转义。

编辑：我会在这种情况下使用 DOM 的原因是编写 DOM 的人已经阅读了 XML 推荐，而我没有（至少，没有他们所拥有的关心程度）。举一个简单的例子，如果文本包含 XML 不允许的字符（如 #x8），DOM 将报告解析错误，因为 DOM 的作者已经实现了 XML 推荐的第 2.2 节。

现在，我可能会说，“好吧，我将只从 XML 推荐中获取无效字符列表，然后将它们从输入中删除。” 当然。让我们看看 XML 推荐，然后……嗯，Unicode 代理块到底是什么？我必须编写什么样的代码才能摆脱它们？他们甚至可以首先进入我的文本吗？

让我们假设我想通了。XML 建议如何指定我不知道的字符表示的其他方面？大概。这些会对我尝试实施的内容产生影响吗？也许。

如果我让 DOM 为我进行字符编码，我就不必担心这些事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-09T19:38:23.407

```
function xPathQuery($attr) {
    $xml = simplexml_load_file('example.xml');
    $to_encode = array('&', '"');
    $to_replace = array('&amp;','&quot;');
    $attr = replace($to_encode, $to_replace, $attr);
    return $xml->xpath("//myElement[@content=\"{$attr}\"]");
} 
```

好的，它有什么作用？

它将字符串中所有出现的 & 和 " 编码为 & 和 "，这应该为您提供特定用途的安全选择器。请注意，我还将 xpath 中的内部 ' 替换为 "。编辑：后来有人指出'可以转义为'，因此您可以使用您喜欢的任何字符串引用方法。

# algorithm - 可发音的密码？

> ID：188835
> 
> 赞同：4
> 
> 时间：2008-10-09T19:32:35.867
> 
> 标签：algorithm, passwords

生成英语发音密码的模块或软件解决方案？

其他语言有类似的模块吗？

-亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T19:36:36.140

您需要研究[马尔可夫链法](http://www.google.com/search?q=pronounceable+markov)。这是一个例子：

*   [http://www.multicians.org/thvv/gpw.html](http://www.multicians.org/thvv/gpw.html)

以下是一些自动生成的密码：

*   [http://www.manic.org/new/pw/pron.html](http://www.manic.org/new/pw/pron.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:41:13.293

您应该寻找[polygen](http://polygen.org/)，不幸的是我不知道该软件是否也有英文版。它使用您选择的确定规则生成随机单词/句子（该站点包含非常有趣的内容，但仅限意大利语：\ 规则可以用任何语言编写。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T19:54:09.177

曾几何时，我组装了自己的极其简单的生成器。它只是一本包含几千个 3-5 个字母的英文单词的字典。要制作密码，我会将其中 2 个组合在一起并附加一个（伪）随机两位数。

2000 * 2000 * 90 = 3.6 亿个可能的组合（当然，取决于用于选择单词的伪随机机制）。不如“专业”产品好，但可能足够好，具体取决于您要使用它的目的。

# c - 函数指针转换为不同的签名

> ID：188839
> 
> 赞同：18
> 
> 时间：2008-10-09T19:33:47.783
> 
> 标签：c, pointers

我使用函数指针的结构来实现不同后端的接口。签名非常不同，但返回值几乎都是 void、void * 或 int。

```
 struct my_interface {
    void  (*func_a)(int i);
    void *(*func_b)(const char *bla);
    ...
    int   (*func_z)(char foo);
}; 
```

但并不要求后端支持每个接口函数的函数。所以我有两种可能性，第一种选择是在每次调用之前检查指针是否不等于 NULL。我不太喜欢这样，因为它的可读性和我担心性能影响（但是我没有测量它）。另一种选择是有一个虚拟函数，在极少数情况下接口函数不存在。

因此，每个签名都需要一个虚拟函数，我想知道是否有可能只有一个用于不同的返回值。并将其转换为给定的签名。

```
 #include <stdio.h>

int nothing(void) {return 0;}

typedef int (*cb_t)(int);

int main(void)
{
    cb_t func;
    int i;

    func = (cb_t) nothing;
    i = func(1);

    printf("%d\n", i);

    return 0;
} 
```

我用 gcc 测试了这段代码，它可以工作。但它是理智的吗？或者它会破坏堆栈还是会导致其他问题？

编辑：感谢所有答案，经过进一步阅读，我现在学到了很多关于调用约定的知识。现在对幕后发生的事情有了更好的了解。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T20:42:45.960

根据 C 规范，转换函数指针会导致未定义的行为。事实上，有一段时间，GCC 4.3 的预发布版本会在你转换函数指针时返回 NULL，这在规范中完全有效，但他们在发布前取消了该更改，因为它破坏了很多程序。

假设 GCC 继续做它现在所做的事情，它将在默认的 x86 调用约定（以及大多数架构上的大多数调用约定）下正常工作，但我不会依赖它。在每个调用点针对 NULL 测试函数指针并不比函数调用贵多少。如果你真的想要，你可以写一个宏：

```
#define CALL_MAYBE(func, args...) do {if (func) (func)(## args);} while (0)
```

或者您可以为每个签名使用不同的虚拟函数，但我可以理解您希望避免这种情况。

## 编辑

查尔斯·贝利（Charles Bailey）为此打电话给我，所以我去查找了细节（而不是依靠我的空洞记忆）。C[规范](http://c0x.coding-guidelines.com/6.3.2.3.html)说

> 766 指向一种类型的函数的指针可以转换为指向另一种类型的函数的指针，然后再返回；
> 767 结果应与原始指针比较。
> 768 如果转换后的指针用于调用类型与指向的类型不兼容的函数，则行为未定义。

和 GCC 4.2 预发行版（这是在 4.3 之前解决的）遵循这些规则：函数指针的强制转换不会导致 NULL，正如我所写的，而是试图通过不兼容的类型调用函数，即

```
func = (cb_t)nothing;
func(1); 
```

从您的示例中，将导致`abort`. 他们改回了 4.1 的行为（允许但警告），部分原因是此更改破坏了 OpenSSL，但同时 OpenSSL 已得到修复，这是编译器可以随时自由更改的未定义行为。

OpenSSL 只是将函数指针转换为其他函数类型，获取并返回相同数量的相同大小的值，而这（假设您不处理浮点数）恰好在所有平台和调用约定中都是安全的了解。但是，其他任何事情都可能不安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T19:48:34.417

我怀疑你会得到一个未定义的行为。

您可以（使用正确的强制转换）将一个指向函数的指针分配给另一个指向具有不同签名的函数的指针，但是当您调用它时，可能会发生奇怪的事情。

您的`nothing()`函数不带参数，对于编译器来说，这可能意味着他可以优化堆栈的使用，因为那里没有参数。但是在这里你用一个参数来调用它，这是一个意想不到的情况，它可能会崩溃。

我在标准中找不到合适的点，但我记得它说你可以转换函数指针，但是当你调用结果函数时，你必须使用正确的原型，否则行为是未定义的。

作为旁注，您不应该将函数指针与数据指针（如 NULL）进行比较，因为它们可能属于不同的地址空间。C99 标准中有一个附录允许这种特定情况，但我认为它没有得到广泛实施。也就是说，在只有一个地址空间的架构上，将函数指针转换为数据指针或将其与 NULL 进行比较，通常会起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:39:06.680

您确实冒着导致堆栈损坏的风险。话虽如此，如果您声明带有`extern "C"`链接的函数（和/或`__cdecl`取决于您的编译器），您*可能*能够摆脱这种情况。这将类似于函数的方式，例如`printf()`可以根据调用者的判断采用可变数量的参数。

这在您当前的情况下是否有效也可能取决于您使用的确切编译器选项。如果您使用的是 MSVC，那么调试与发布编译选项可能会产生很大的不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T19:37:13.143

应该没问题。由于调用者负责在调用后清理堆栈，因此不应在堆栈上留下任何额外内容。被调用者（在这种情况下为nothing（））是可以的，因为它不会尝试使用堆栈上的任何参数。

编辑：这确实假设 cdecl 调用约定，这通常是 C 的默认值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T19:49:51.073

只要您可以保证您正在使用使调用者平衡堆栈而不是被调用者 (__cdecl) 的方法进行调用。如果您没有指定调用约定，则可以将全局约定设置为其他内容。（__stdcall 或 __fastcall）这两者都可能导致堆栈损坏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T21:00:06.223

除非您使用特定于实现/特定于平台的东西来强制正确的调用约定，否则这将不起作用。对于某些调用约定，被调用函数负责清理堆栈，因此它们必须知道推送了什么。

我会去检查 NULL 然后打电话 - 我无法想象它会对性能产生任何影响。

计算机检查 NULL 的速度与它们所做的任何事情一样快。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-06T01:20:43.227

C 标准明确不支持将函数指针强制转换为 NULL。你受编译器作者的摆布。它在很多编译器上都可以正常工作。

C 语言最大的烦恼之一是函数指针没有 NULL 或 void* 等价物。

如果你真的希望你的代码是防弹的，你可以声明你自己的空值，但你需要为每个函数类型一个。例如，

```
void void_int_NULL(int n) { (void)n; abort(); } 
```

然后你可以测试

```
if (my_thing->func_a != void_int_NULL) my_thing->func_a(99); 
```

丑陋，尼特？

# oop - 当您单独设计对象模型时，您使用了哪些技术？

> ID：188843
> 
> 赞同：2
> 
> 时间：2008-10-09T19:34:56.237
> 
> 标签：oop, tdd

因此，毫无疑问，构建领域模型是我认为当你作为团队来处理它时最好的事情。甚至让非技术人员和“业务”成员参与建模会议。当你把合适的人放在一个房间里并在白板上敲定东西时，可以快速完成很多事情。但是你没有那种奢侈的时候呢？当您必须单独构建复杂的域模型时怎么办？在过去的一个月左右，我一直在这样做，并做了以下事情：

1.  从名词识别开始，然后使用 Class-Role-Collaborations 分析关系
2.  寻找可用于细化模型、Party 等的分析模式。
3.  一旦我掌握了基础知识，我就会搞定一个 IDE 并开始编写 XUnit 测试以表明该模型让我可以做我想做的事情

虽然这些技术运作良好，但我不确定它们是否像真正的协作努力一样有效。我认为很容易被一个概念冲昏头脑，后来才意识到它违反了 x 或 y 要求。在隔离工作时，您使用了哪些技术来确保您的对象/域模型符合目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:48:10.050

我认为每个人的做法都不一样，但是...

我几乎总是从类图（通常类似于 UML 并且在纸上）开始，特别注意类之间的关系及其数量。此阶段的验证主要是试图了解实体的高级语义是否一起有意义。

然后开始勾画关键功能，尤其是那些涉及协作的功能。确保协作中的对象可以通过关系相互联系。在这个阶段，我将使用绘图工具 (StarUML)。

然后是 gedanken 实验。我在脑海中遍历了我能想到的最棘手的用例，看看我是否可以设想一种方法来用给定的设计来解决它们。这不是伪代码，只是逐步完成每个主要任务/功能并按照图表的线条来确保我没有错过回调、循环依赖等。

我认为一个关键是在你对设计的任何特定方面感到满意之前，不要过于拘泥于设计的任何特定方面，它可能会工作得相当好。在我看来，如果您无法在心理上逐步完成设计以评估/验证它，那么您要么对问题缺乏了解，要么纸上的设计还不够完整……

然后，如果时间允许，把那个放在一边，看看你能不能想出一些真正不同的东西……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T20:20:41.200

如果您自己构建它，请确保它具有适应性，因为您不可能在第一时间想到所有东西。

拿一些大纸。把所有的东西都画出来，弄得一团糟。不要担心让它变得完美。把你想到的所有东西都放下，划掉那些证明没用的东西。这篇论文看起来就像你的脑海里到处都是对象模型的碎片。当你想到已经写下来的东西时，让这些东西脱颖而出。在这个过程结束时，你会一团糟，但肯定会有很多好主意。在这一点上，我建议向人们展示这个，但既然你说这是不可能的，我们会继续前进。

现在坐在带有 UML 工具的计算机前，绘制出类似于大脑转储亮点的东西。考虑对象模型的主要部分，然后考虑使这些部分协同工作的更次要的东西。一旦你确定了一些东西，把那个 UML 变成代码，然后开始编写一些测试来看看它是否有效。冲洗并重复。

# wpf - 如何在 WPF 中突出显示/概述 Visual 对象？

> ID：188844
> 
> 赞同：5
> 
> 时间：2008-10-09T19:35:07.627
> 
> 标签：wpf

如果我有一个包含 n 个任意形状或大小的 Visual 对象的 Canvas，我将如何以编程方式突出显示/勾勒 Visual 对象？

WPF 中有内置的东西可以帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T20:26:55.213

阅读了另一个答案中的评论——您在其中声明您希望轮廓符合视觉的形状——我只能建议您看一下`BitmapEffects`. 有一个用于外发光效果。

复制视觉效果本身可能效率较低，并且由于这些项目的其他方面（例如任何绑定）可能会产生大量复杂情况。

**编辑：**在 .NET 4.0 中，`BitmapEffects`属性和`BitmapEffect`类已过时。你会抛出一个异常。相反，您现在拥有`System.Windows.Media.Effects.Effect`该类及其派生类，以及诸如`Visual.VisualEffect`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T20:36:55.583

Joel 对使用 BitmapEffects 有一个很好的建议。

但是，如果您可以使用 .NET 3.5 SP1，我会引导您使用**GPU 渲染效果**。因此，您将使用 UIElement.Effect，而不是使用 UIElement.BitmapEffect。.NET 3.5 SP1 内置了两个 GPU 效果：BlurEffect 和 DropShadowEffect。您还可以创建自己的 GPU 效果......这就是您将使用 ShaderEffect 的地方。

查看 Greg Schechter 的博客文章[系列](http://blogs.msdn.com/greg_schechter/archive/2008/05/12/a-series-on-gpu-based-effects-for-wpf.aspx)了解更多信息。

这是我几天前刚刚实现的鼠标悬停效果的一段代码（由于 ShadowDepth 为 0，它实际上显示出有点像外发光位图效果，但不完全是）：

```
<Path
    x:Name="mouseOverEffect"
    Width="80"
    Height="43.916"
    Stretch="None"
    Fill="#FFFFFFFF"
    Opacity="0"
>
    <Path.Data>
        <PathGeometry FillRule="Nonzero">
            <PathFigure IsClosed="True" StartPoint="39.9592899612151,25.9913931634531">
                <LineSegment Point="80.0000001464848,43.9159987905149"/>
                <LineSegment Point="39.9513899394755,4.97379893856246E-14"/>
                <LineSegment Point="1.77635636294422E-15,43.9159987905149"/>
                <LineSegment Point="39.9592899612151,25.9913931634531"/>
            </PathFigure>
        </PathGeometry>
    </Path.Data>
    <Path.Effect>
        <DropShadowEffect
            Color="#FFFFFFFF"
            BlurRadius="10"
            ShadowDepth="0"
        />
    </Path.Effect>
</Path> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:54:48.710

如果您将这些 Visual 对象包装在 Border 中......并且默认情况下将 Opacity 设为 0 ...那么您可以在需要时以编程方式将 Opacity 设置为 1。

这有帮助吗？

# internet-explorer - 如何从批处理文件启动多个 Internet Explorer 窗口/选项卡？

> ID：188850
> 
> 赞同：21
> 
> 时间：2008-10-09T19:36:22.147
> 
> 标签：internet-explorer, batch-file

我想要一个批处理文件来启动两个单独的程序，然后关闭命令行窗口。实际上，为了澄清，我正在使用两个不同的 URL 启动 Internet Explorer。

到目前为止，我有这样的事情：

```
start "~\iexplore.exe" "url1"
start "~\iexplore.exe" "url2" 
```

我得到的是一个仅加载了第二个 URL 的 Internet Explorer 实例。似乎第二个正在取代第二个。我似乎记得一种语法，我会加载一个新的命令行窗口并传递命令以在加载时执行，但找不到参考。

作为问题的第二部分：在您需要编写快速批处理文件的时候，什么是一个好的参考 URL？

编辑：我已经标记了一个答案，因为它确实有效。我现在打开了两个窗口，每个 URL 一个。（谢谢！）有趣的是，如果没有使用我的原始语法的 /d 方法，我会根据我是否打开了预先存在的 Internet Explorer 实例而得到不同的结果。

*   如果我这样做，我会为我的两个 URL 添加两个新选项卡（真棒！）
*   如果没有，我将只获得我传入的第二个 URL 的最后一个选项卡。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-09T19:54:31.080

在你的批处理文件中试试这个：

```
@echo off
start /d "C:\Program Files\Internet Explorer" IEXPLORE.EXE www.google.com
start /d "C:\Program Files\Internet Explorer" IEXPLORE.EXE www.yahoo.com 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-06T19:58:33.853

您可以使用这两个脚本中的任何一个在（单个）新 IE 窗口中的单独选项卡中打开 URL。您可以从批处理脚本中（或在命令提示符处）调用这些脚本中的任何一个：

**JavaScript**
创建一个名称如下的文件：**“urls.js”**：

```
var navOpenInNewWindow = 0x1;
var navOpenInNewTab = 0x800;
var navOpenInBackgroundTab = 0x1000;

var intLoop = 0;
var intArrUBound = 0;
var navFlags = navOpenInBackgroundTab;
var arrstrUrl = new Array(3);
var objIE;

    intArrUBound = arrstrUrl.length;

    arrstrUrl[0] = "http://bing.com/";
    arrstrUrl[1] = "http://google.com/";
    arrstrUrl[2] = "http://msn.com/";
    arrstrUrl[3] = "http://yahoo.com/";

    objIE = new ActiveXObject("InternetExplorer.Application");
    objIE.Navigate2(arrstrUrl[0]);

    for (intLoop=1;intLoop<=intArrUBound;intLoop++) {

        objIE.Navigate2(arrstrUrl[intLoop], navFlags);

    }

    objIE.Visible = true;
    objIE = null; 
```

**VB 脚本**
创建一个名称如下的文件：**“urls.vbs”**：

```
Option Explicit

Const navOpenInNewWindow = &h1
Const navOpenInNewTab = &h800
Const navOpenInBackgroundTab = &h1000

Dim intLoop       : intLoop = 0
Dim intArrUBound  : intArrUBound = 0
Dim navFlags      : navFlags = navOpenInBackgroundTab

Dim arrstrUrl(3)
Dim objIE

    intArrUBound = UBound(arrstrUrl)

    arrstrUrl(0) = "http://bing.com/"
    arrstrUrl(1) = "http://google.com/"
    arrstrUrl(2) = "http://msn.com/"
    arrstrUrl(3) = "http://yahoo.com/"

    set objIE = CreateObject("InternetExplorer.Application")
    objIE.Navigate2 arrstrUrl(0)

    For intLoop = 1 to intArrUBound

        objIE.Navigate2 arrstrUrl(intLoop), navFlags

    Next

    objIE.Visible = True
    set objIE = Nothing 
```

一旦你决定了**"JavaScript"**或**"VB Script"**，你有几个选择：

如果您的网址是静态的：

1）您可以编写**“JS/VBS”**脚本文件（上图），然后从批处理脚本中调用它。

从批处理脚本（或命令提示符）中，调用**“JS/VBS”**脚本，如下所示：

```
cscript //nologo urls.vbs
cscript //nologo urls.js 
```

如果 URL 不经常更改：

2）您可以让批处理脚本即时编写**“JS/VBS”**脚本，然后调用它。

如果 URL 每次都不同：

3) 使用**“JS/VBS”**脚本（如下）并传递要打开的页面的 URL 作为命令行参数：

**JavaScript**
创建一个名称如下的文件：**“urls.js”**：

```
var navOpenInNewWindow = 0x1;
var navOpenInNewTab = 0x800;
var navOpenInBackgroundTab = 0x1000;

var intLoop = 0;
var navFlags = navOpenInBackgroundTab;
var objIE;
var intArgsLength = WScript.Arguments.Length;

    if (intArgsLength == 0) {

        WScript.Echo("Missing parameters");
        WScript.Quit(1);

    }

    objIE = new ActiveXObject("InternetExplorer.Application");
    objIE.Navigate2(WScript.Arguments(0));

    for (intLoop=1;intLoop<intArgsLength;intLoop++) {

        objIE.Navigate2(WScript.Arguments(intLoop), navFlags);

    }

    objIE.Visible = true;
    objIE = null; 
```

**VB 脚本**
创建一个名称如下的文件：**“urls.vbs”**：

```
Option Explicit

Const navOpenInNewWindow = &h1
Const navOpenInNewTab = &h800
Const navOpenInBackgroundTab = &h1000

Dim intLoop
Dim navFlags      : navFlags = navOpenInBackgroundTab
Dim objIE

    If WScript.Arguments.Count = 0 Then

        WScript.Echo "Missing parameters"
        WScript.Quit(1)

    End If

    set objIE = CreateObject("InternetExplorer.Application")
    objIE.Navigate2 WScript.Arguments(0)

    For intLoop = 1 to (WScript.Arguments.Count-1)

        objIE.Navigate2 WScript.Arguments(intLoop), navFlags

    Next

    objIE.Visible = True
    set objIE = Nothing 
```

如果脚本在没有任何参数的情况下被调用，这些将返回**`%errorlevel%=1`**，否则它们将返回**`%errorlevel%=0`**。不对任何 URL 的“有效性”或“可用性”进行检查。

从批处理脚本（或命令提示符）中，调用**“JS/VBS”**脚本，如下所示：

```
cscript //nologo urls.js "http://bing.com/" "http://google.com/" "http://msn.com/" "http://yahoo.com/"
cscript //nologo urls.vbs "http://bing.com/" "http://google.com/" "http://msn.com/" "http://yahoo.com/" 
```

甚至：

```
cscript //nologo urls.js "bing.com" "google.com" "msn.com" "yahoo.com"
cscript //nologo urls.vbs "bing.com" "google.com" "msn.com" "yahoo.com" 
```

如果出于某种原因，您想使用“wscript”来运行它们，请记住使用“start /w”，这样退出代码 (%errorlevel%) 将返回到您的批处理脚本：

```
start /w "" wscript //nologo urls.js "url1" "url2" ...
start /w "" wscript //nologo urls.vbs "url1" "url2" ... 
```

* * *

**编辑：** 2016 年 9 月 21 日

有评论说我的解决方案太复杂了。我不同意。您选择`JavaScript`解决方案，***或***解决`VB Script`方案（不是两者），每个只有大约 10 行实际代码（如果您消除错误检查/报告，则更少），加上几行来初始化常量和变量。

一旦你决定（JS 或 VB），你写**一次**那个脚本，然后你从 调用那个脚本`batch`，传递`URLs`，任何时候你想使用它，比如：

```
cscript //nologo urls.vbs "bing.com" "google.com" "msn.com" "yahoo.com" 
```

我写这个答案的原因是因为所有其他对某些人有用的答案对其他人无效，具体取决于：

1.  当前 Internet Explorer 设置“在新选项卡中打开弹出窗口”、“在当前/新窗口/选项卡中打开”等...假设您已经将这些设置设置为您喜欢的一般浏览方式，大多数人会发现它不希望来回更改这些设置以使脚本正常工作。
2.  它们的行为（可能）不一致，具体取决于在打开“新”链接之前是否已经打开了 IE 窗口。如果已经打开了一个 IE 窗口（可能有许多打开的选项卡），那么所有新选项卡也会添加到那里。这可能不是所希望的。

我提供的解决方案不存在这些问题，并且无论任何 IE 设置或任何现有的 IE 窗口如何，其行为都应该相同。（如果我对此有误，请告诉我，我会尽力解决。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-21T23:57:57.697

感谢罗杰的提示。

对我来说，它的工作方式如下：

```
@echo off

start /d "" IEXPLORE.EXE www.google.com

start /d "" IEXPLORE.EXE www.yahoo.com 
```

使用 Internet Explorer 8 中的设置：

*   总是在新标签页中打开弹出窗口
*   当前窗口中的新选项卡

marcelo_linhares@hotmail.com

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-12T10:47:59.203

当然，这是一个旧帖子，但仅适用于通过搜索引擎找到它的人。

另一种解决方案是为 IE9 及更高版本运行它

```
iexplore.exe" -noframemerging http://google.com
iexplore.exe" -noframemerging http://gmail.com 
```

`-noframemerging`意味着独立运行IE。例如，如果您想运行 2 个浏览器并以不同的用户名登录，那么如果您只运行 2 个 IE，它将无法正常工作。但有了`-noframemerging`它就可以了。

`-noframemerging`适用于 IE9 及更高版本，对于 IE8 等早期版本`-nomerge`

通常我会创建 1 个像这样 run_ie.bat 的 bat 文件

```
"c:\Program Files (x86)\Internet Explorer\iexplore.exe" -noframemerging %1 
```

我创建了另一个像这样 run_2_ie.bat 的 bat 文件

```
start run_ie.bat http://google.com
start run_ie.bat http://yahoo.com 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-21T13:34:28.420

这对我有用：

```
start /d IEXPLORE.EXE www.google.com
start /d IEXPLORE.EXE www.yahoo.com 
```

但由于某种原因，他们改为在 Firefox 中打开它们？！？

我试过了，但它只是在两个不同的窗口中打开了站点：

```
start /d "C:\Program Files\Internet Explorer" IEXPLORE.EXE www.google.com
start /d "C:\Program Files\Internet Explorer" IEXPLORE.EXE www.yahoo.com 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T19:51:35.610

IE 选项中有一个设置，用于控制是否应在现有窗口或新窗口中打开新链接。我不确定您是否可以从命令行控制它，但也许更改此选项对您来说就足够了。

在 IE7 中，看起来选项是“重用窗口以启动快捷方式（禁用选项卡式浏览时）”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-11T04:06:40.307

试试这个，这样你就有足够的时间来启动第一个进程。否则它将产生 2 个进程，因为当你运行第二个进程时第一个进程还没有运行……如果你的计算机速度太快，可能会发生这种情况。

```
@echo off
start /d iexplore.exe http://google.com
PING 1.1.1.1 -n 1 -w 2000 >NUL
START /d iexplore.exe blablabla 
```

用另一个地址替换 blablabla

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-21T18:18:57.013

谢谢马塞洛。这对我有用。我想打开一个新的 IE 窗口并在其中打开两个选项卡，所以我修改了代码：

```
start iexplore.exe website
PING 1.1.1.1 -n 1 -w 2000 >NUL 
START /d iexplore.exe website 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-09T18:56:22.910

最佳答案几乎是正确的，但您还需要在每行末尾添加一个 & 符号。例如编写批处理文件：

```
start /d "~\iexplore.exe" "www.google.com" & 
start /d "~\iexplore.exe" "www.yahoo.com" &
start /d "~\iexplore.exe" "www.blackholesurfer.com" & 
```

& 符号允许提示返回到 shell 并启动另一个选项卡。这只是一个 Windows 解决方案，但与符号在 linux shell 中具有相同的效果。

# php - 为什么 IIS 不执行我的站点根 index.php 文件的 PHP 代码？

> ID：188853
> 
> 赞同：3
> 
> 时间：2008-10-09T19:36:55.577
> 
> 标签：php, iis

IIS 实际上是向`<?php ... ?>`浏览器发送代码，而不是执行它。

但是，仅适用于根`http://domain.com/index.php`文件。

该文件夹中的所有其他 .php 文件和子文件夹中的 index.php 文件按预期执行。

如何让我的根 index.php 代码执行？

* * *

更新：“index.php”是我网站的默认文档...

[替代文字 http://img412.imageshack.us/img412/4130/defaultdocumentmt9.gif](http://img412.imageshack.us/img412/4130/defaultdocumentmt9.gif)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T19:50:14.520

看来您已经正确配置了您的处理程序。如果您正在使用，请`<? ... ?>`确保您 `short_open_tag = On` 的 php.ini 中有。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-07T03:40:27.253

我遇到了这个问题，最终找到了 PHP 文件编码的来源。显然，我已将编辑器设置为使用 Unicode（2 字节 unicode，而不是 UTF-8）作为编码。这会导致 PHP 看不到`<?`标签，但浏览器似乎能够很好地读取 Unicode 文件，因此查看源代码会显示实际的 PHP 代码。（即使该文件有一个 content-type=utf-8 元标记！）将 PHP 文件保存为 ANSI 或 UTF-8 编码解决了这个问题。

为了找到这个简单的解决方案，进行了大量的调试，所以我想我会在这里为遇到这个问题的其他人添加它。

这个问题的一个有趣的副作用是 Firefox 和 Chrome 似乎没有加载 CSS 文件。经过进一步检查，我发现浏览器应该假定 CSS 的编码与 HTML 相同，除非在 CSS 文件中明确指定。在 Chrome 或 Firefox 中查看 CSS 会显示中文字符！实际上，这帮助我找到了解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T11:18:02.637

*   [IIS 5.1 不能在根目录下正确运行 PHP，但在所有其他文件夹中都可以](http://forums.devshed.com/iis-97/iis-5-1-does-not-run-php-properly-under-root-163070.html)
*   [使用 IIS 在站点根目录中运行 WordPress 博客](http://www.simmonsconsulting.com/2008/04/21/running-a-wordpress-blog-in-site-root-using-iis/)

更新：我发现了一些 PHP 5 和 IIS 7 的可能解决方法。如果这些解决方案不起作用，请提供有关您的`index.php`IIS 设置的更多详细信息，或尝试使用 IIS 6 兼容性。

*   [IIS7 上的 PHP 包含问题](http://codingforums.com/showthread.php?t=148637)
*   [PHP5 设置 - 包含和其他文件引用的相对路径](http://www.webmasterworld.com/php/3685216.htm)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T22:05:53.763

您是否尝试过弹跳（停止/重新启动）IIS？也许甚至重新启动机器？我知道曾经做过一些 IIS 配置更改，我发誓应该只需要一个反弹就可以生效，直到整个机器重新启动才开始。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-01T20:21:50.800

尽管这是一个老问题，但 11 年后，这仍然是一个问题。我的工作是创建 default.aspx 文件并在其中执行重定向。将文件保存到您网站的根目录，并将 default.aspx 添加到 IIS 中的默认文档中。确保将其移至列表顶部以优先处理它。下面的代码是我使用的。

```
<%@ Page Language="C#" %>

<!DOCTYPE html>

<script runat="server">
    protected override void OnLoad(EventArgs e) {
    Response.Redirect("index.php");
  }
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Title Of Your Website Here</title>
</head> 
```

# embedded - 裸机系统的软件测试

> ID：188862
> 
> 赞同：4
> 
> 时间：2008-10-09T19:39:20.910
> 
> 标签：embedded, bare-metal, tightly-coupled-code

我正在用 C++ 为不支持操作系统的嵌入式系统编写一个项目；几乎没有库支持。非常裸机。因此，我的相当多的代码是紧密耦合的（例如，软件触发的中断和它们正上方的层）。

我正在做的部分工作涉及更改串行端口配置，从而驱动 PC 端（UI 端）和微处理器（活动端）的并发更改。到目前为止，我在一个非常小心的增量类型开发中做得很好（一块一块地安装它）。但是，我希望对我的代码在工程意义上的工作更有信心。

对于这种情况，您会推荐什么样的方法/框架？

**编辑：**

我在 Tern, Inc. 制造的 ACore86 板上使用 AMD186 ES。编译器：Paradigm，免费版（随板提供）。不幸的是，我没有选择改变我正在做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T19:58:56.110

在裸机环境中缺乏基础设施是相当具有挑战性的。我建议您专注于调试工具。即使非常小心和出色的方法，您也需要调试事物的能力。

你应该让 gdbagent 工作。您需要自己实现它，但它是一个简单的基于文本的协议。您在外部机器上运行 gdb 并与目标上的 gdbagent 通信。您当然可以通过串行端口运行 gdbagent 协议，但是当需要检查大量数据时，这很快就会变得乏味。如果您有更快的界面可用，请利用它。

我不知道你的预算是多少，但你也应该计划一个 JTAG 调试器。只要目标上的 gdbagent 能够运行，gdbagent 就很棒。如果一切都崩溃了，你就完蛋了。JTAG 调试器非常昂贵，但可以租用。我过去使用过[Corelis](http://www.corelis.com)产品，并且听说过关于[Abatron](http://www.abatron.com/)的好消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T19:43:34.130

我认为最好的办法是与编译器供应商合作以获得设备模拟器。

Tessy 应该可以使用该芯片。查看：[http ://www.hitex.us/products.html?con_186.html~content](http://www.hitex.us/products.html?con_186.html~content)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T19:58:56.813

当时间很重要时，我喜欢使用一个或两个空闲 I/O 引脚和一个示波器来检测代码。我也是用于源代码级调试的 JTAG 端口的粉丝。您还可以让微处理器存储数据向量，并通过第二个 uart（如果有的话）将其发送回 PC 进行分析。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-12T06:21:06.293

我在这类领域看到的一些事情是单元测试。

不，我不是在开玩笑。

单元测试在主机 PC 的控制下在设备上运行。

您编写了一个包装器，以便在单元测试控制下将程序加载到 SRAM 中。

然后你的电脑可以发送一个程序，运行它并检查输出。

如果您需要锻炼您的电路板，请使用 labjack 或类似的 USB 接口卡。

现在这是测试夹具中的硬件，全部从您的主机 PC 运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-01T17:23:04.647

我取得了一些成功的一件事是设计了一个 PC 环境，其中代码可以用 C++ 为 PC 编译和测试，然后用“直接”C 编译以在嵌入式系统上运行。I/O 端口引用被#定义为对 I/O 对象的属性访问，然后通过套接字将其发送到“硬件仿真”程序。系统的某些部分最终变得比我想要的更笨重，但我预计后续版本会不那么笨重。

# c# - 我应该使用 default(Foo)、Foo.Empty 还是 null？

> ID：188864
> 
> 赞同：3
> 
> 时间：2008-10-09T19:39:25.027
> 
> 标签：c#, constructor, conventions

因此，C# 现在允许您用于`default(Foo)`获取已识别的“尚未填充”/空的类实例——我不确定它是否完全相同`new Foo()`。许多库类还实现了一个`Foo.Empty`属性，该属性返回一个类似的实例。当然，任何引用类型都可以指向`null`. 所以真的，有什么区别？什么时候是对还是错？什么更一致，或者表现更好？在检查一个对象在概念上是否“尚未准备好迎接黄金时段”时，我应该使用哪些测试？不是每个人都有`Foo.IsNullOrEmpty()`。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T19:54:38.803

`default(Foo)``Foo`当是类类型时将返回 null，当是`Foo`值类型（例如 int）时将返回零，并且`Foo`所有字段都初始化*为其*各自`default()`值的实例，其中`Foo`是结构。它被添加到语言中，以便泛型可以同时支持值和引用类型 - [MSDN 上的更多信息](http://msdn.microsoft.com/en-us/library/xwth0h0d.aspx)

`default(Foo)`当您在`SomeClass<T>`or的上下文中测试 T`MyMethod<T>`并且您不知道 T 是值类型、类类型还是结构时使用。

否则，null 应该表示“未知”，而 empty 应该表示“我知道这是空的”。如果你真的需要一个空但非空的类实例，请使用 Foo.Empty 模式；例如，如果您需要将某些变量初始化为空字符串，则可以`String.Empty`作为替代方案。`""`

如果您知道您正在使用引用类型（类），则使用 null，不涉及泛型，并且您正在显式测试未初始化的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:45:51.503

`default(Foo)`适用于值类型和引用类型。 `New Foo(), null`并且`Foo.Empty()`不要。这使它成为与泛型类型一起使用的好选择，例如，当您可能不知道您正在处理的是哪个时。但在大多数引用类型的情况下，`null`可能就足够了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T20:11:10.050

当您知道所涉及的实际类型时，或者如果您有一个类型参数受“：类”约束，使用已知值（null、0 等）是最简单的。

当您刚刚获得一个不受约束或受约束而不是引用类型的类型参数时，您需要使用 default(T)。

# c# - 如何使用 C# 清理 html 页面上的输入？

> ID：188870
> 
> 赞同：45
> 
> 时间：2008-10-09T19:41:05.397
> 
> 标签：c#, html-sanitizing, antixsslibrary

是否有一个库或可接受的方法来清理 html 页面的输入？

在这种情况下，我有一个只有姓名、电话号码和电子邮件地址的表格。

代码必须是 C#。

例如：

`"<script src='bobs.js'>John Doe</script>"`应该成为`"John Doe"`

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2016-10-03T18:56:54.950

我们正在使用[HtmlSanitizer](https://github.com/mganss/HtmlSanitizer) .Net 库，它：

*   是开源的 (MIT) - [GitHub 链接](https://github.com/mganss/HtmlSanitizer)
*   完全可定制，例如配置应删除哪些元素。[见维基](https://github.com/mganss/HtmlSanitizer/wiki)
*   [被积极维护](https://github.com/mganss/HtmlSanitizer/graphs/contributors)
*   没有[Microsoft Anti-XSS 库之类的问题](https://eksith.wordpress.com/2012/02/13/antixss-4-2-breaks-everything/)
*   [是否使用OWASP XSS Filter Evasion Cheat Sheet](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)进行单元测试
*   专门为此而构建（与*HTML Agility Pack*相比，它是一个解析器 - 而不是一个消毒剂）
*   不使用正则表达式（HTML 不是正则语言！）

同样在[NuGet上](https://www.nuget.org/packages/HtmlSanitizer/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-09T20:05:37.860

根据您对此答案的评论，您可能会在此问题中找到一些有用的信息：
[https ://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-网站](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)

这是一个参数化查询示例。而不是这个：

```
string sql = "UPDATE UserRecord SET FirstName='" + txtFirstName.Text + "' WHERE UserID=" + UserID; 
```

做这个：

```
SqlCommand cmd = new SqlCommand("UPDATE UserRecord SET FirstName= @FirstName WHERE UserID= @UserID");
cmd.Parameters.Add("@FirstName", SqlDbType.VarChar, 50).Value = txtFirstName.Text;
cmd.Parameters.Add("@UserID", SqlDbType.Integer).Value = UserID; 
```

* * *

编辑：由于没有注入，我删除了处理该问题的答案部分。我留下了基本的参数化查询示例，因为这可能对其他阅读该问题的人仍然有用。
——乔尔

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-09T20:03:11.640

如果通过清理您的意思是完全删除标签，那么 Bryant 引用的 RegEx 示例就是您想要的解决方案类型。

如果您只想确保代码不会弄乱您的设计并呈现给用户。您可以使用 HttpUtility.HtmlEncode 方法来防止这种情况！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-11-10T12:53:18.763

使用[Microsoft Anti-Cross Site Scripting Library](http://msdn.microsoft.com/en-us/security/aa973814)怎么样？

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-10-04T18:16:59.273

听起来您有用户提交内容，但您不能完全信任他们，但您仍然希望将他们提供的内容呈现为超级安全的 HTML。这里有三种技术：HTML 对所有内容进行编码，HTML 编码和/或仅删除有害部分，或者使用编译为您熟悉的 HTML 的 DSL。

1.  它应该变成“John Doe”吗？我会对该字符串[进行 HTML 编码](http://msdn.microsoft.com/en-us/library/vstudio/system.web.httputility.htmlencode%28v=vs.110%29.aspx)，并让用户“John Doe”（如果这确实是他的真名......）拥有看起来很愚蠢的 name `<script src='bobs.js'>John Doe</script>`。他一开始就不应该将他的名字包裹在脚本标签或任何标签中。这是我在所有情况下都使用的方法，除非其他技术之一有一个非常好的商业案例。

2.  接受来自用户的 HTML，然后使用白名单方法（如@Bryant 提到的[清理方法）对其进行清理（在输出上）。](http://web.archive.org/web/20120606051450/http://refactormycode.com/codes/333-sanitize-html)做到这一点（非常）困难，我将把它推迟到更伟大的头脑。请注意，某些消毒剂会 HTML 编码邪恶，而其他人会完全删除有问题的位。

3.  另一种方法是使用“编译”为 HTML 的 DSL。确保[白帽](http://en.wikipedia.org/wiki/Whitehat)你的 DSL 编译器，因为一些（如[MarkdownSharp](http://code.google.com/p/markdownsharp/)）将允许通过未编码的任意 HTML （如`<script>`标签和邪恶属性）（顺便说一句，这是完全合理的，但可能不是*你*需要或期望的）。如果是这种情况，您将需要使用技术 #2 并清理编译器输出的内容。

结束思想：

*   如果技术#2 或#3 没有强有力的商业案例，那么请降低风险并省去自己的精力和担心的使用，请使用技术#1。
*   不要因为你使用了 DSL 而认为你是安全的。例如：Markdown 的原始实现允许 HTML 通过，未编码。[“对于 Markdown 语法未涵盖的任何标记，您只需使用 HTML 本身即可。无需为其添加前缀或定界以表明您正在从 Markdown 切换到 HTML；您只需使用标签即可。”](http://daringfireball.net/projects/markdown/syntax)
*   输出时编码。您也可以对输入进行编码，但这样做会使您陷入困境。如果您编码错误并保存了它，您将如何取回原始输入，以便在修复错误编码器后重新编码？

# java - 哪些工具可用于在 Java 中创建进程内 COM 服务器？

> ID：188878
> 
> 赞同：3
> 
> 时间：2008-10-09T19:42:31.247
> 
> 标签：java, com

哪些工具可用于在 Java 中创建进程内 COM 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T21:12:16.557

[J-Integra](http://j-integra.intrinsyc.com/)是您可能会找到的最全面、最完整的解决方案，可以同时使用 COM 和 Java。该软件已被许多大大小小的商业产品用于集成 COM 和 Java（双向）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T21:26:31.037

jacob-*-x86.dll 和随附的 jacob.jar

[使用它](http://td2jira.sourceforge.net)成功连接到 TestDirector（使用 DCOM）。内存管理有点棘手，但即使是调用 COM 的 .NET 人员也很难做到。链接文本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T18:04:08.000

任何用于从 Java（或其他平台）访问 COM 的软件都称为“COM 桥”。

sourceforge 上的 j-Interop 项目可能值得一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T02:10:08.593

另一种选择是[JNI Wrapper/ComfyJ](http://www.teamdev.com/comfyj/index.jsf) - 它允许您生成 Java 代理类或使用 IDispatch。您还可以捕获和广播事件 (IConnectionPoint) 并实现 COM 服务器。

# visual-studio-2008 - 从 VS Professional 迁移到 VS Team System

> ID：188884
> 
> 赞同：3
> 
> 时间：2008-10-09T19:44:08.200
> 
> 标签：visual-studio-2008

我们正在考虑从 Visual Studio 2008 Professional 迁移到 Visual Studio Team System。我相信我已经读过客户端开发版是专业版拥有/所做的超集。我想先轻松过渡到客户端，然后让 Team Foundation Server 启动并运行，我想确保不会丢失任何功能。如果一切顺利，我团队的其他成员将跟随升级。让我知道这听起来是否是正确的方向，或者您是否在向这个方向迁移时遇到了问题。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:52:20.680

Team System (Developer / Suite) 是 Professional 的超集，因此，您只能通过升级获得功能。Tester 是一个稍微不同的功能集，尽管它包含在 Suite 中。

最常见的过渡方式是一次升级所有开发站。没有理由不这样做。

就 Team Foundation Server 而言，这需要更多的规划，具体取决于您的源代码控制和项目管理需求；这本身就是一场对话。

# django - 将错误注入已验证的表单？

> ID：188886
> 
> 赞同：109
> 
> 时间：2008-10-09T19:45:22.690
> 
> 标签：django, django-forms

在我`form.Form`验证用户输入值后，我将它们传递给单独的（外部）进程以进行进一步处理。此外部过程可能会在值中发现更多错误。

有没有办法将这些错误注入已经验证的表单中，以便可以通过通常的表单错误显示方法显示它们（或者有更好的替代方法）？

一个建议是在表单验证中包含外部处理，这并不理想，因为外部处理不仅仅是验证。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2015-01-21T01:45:47.490

对于 Django 1.7+，您应该使用`form.add_error()`而不是直接访问`form._errors`。

文档：[https ://docs.djangoproject.com/en/stable/ref/forms/api/#django.forms.Form.add_error](https://docs.djangoproject.com/en/stable/ref/forms/api/#django.forms.Form.add_error)

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2008-10-09T19:49:08.800

`Form._errors`可以像标准字典一样对待。`ErrorList`使用该类并将错误附加到现有列表中被认为是一种很好的形式：

```
from django.forms.utils import ErrorList
errors = form._errors.setdefault("myfield", ErrorList())
errors.append(u"My error here") 
```

如果要添加非字段错误，请使用`django.forms.forms.NON_FIELD_ERRORS`(默认为`"__all__"`) 而不是`"myfield"`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-09T19:48:31.437

`_errors`您可以直接向表单的属性添加其他错误详细信息：

[https://docs.djangoproject.com/en/1.5/ref/forms/validation/# describe-later](https://docs.djangoproject.com/en/1.5/ref/forms/validation/#described-later) [https://docs.djangoproject.com/en/1.6/ref/forms/validation/#modifying-field-errors](https://docs.djangoproject.com/en/1.6/ref/forms/validation/#modifying-field-errors)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-02-17T08:14:05.170

**将错误添加到特定字段：**

```
form.add_error('fieldName', 'error description') 
```

**向非字段添加错误**

```
form.add_error(None, 'error description')
#Only pass None instead of field name 
```

# actionscript - 如何访问 IOErrorEvent 上的 AS3 URLLoader 返回数据

> ID：188887
> 
> 赞同：3
> 
> 时间：2008-10-09T19:45:24.377
> 
> 标签：actionscript, urlloader

我正在为 api 编写一个动作脚本库。我使用 URLLoader 对象从 api 加载数据。我遇到的问题是，每当 api 在 400 秒内返回 http 状态时，actionscript 都会将此视为 io 错误。这一切都很好，但是，如果是这种情况，似乎无法访问返回的任何数据。因此，任何有关返回的错误原因的有用 xml 都会丢失。有没有办法解决？如果 api 返回错误时无法为开发人员提供任何有用的信息，这会使库有点痛苦。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T22:38:21.800

您无法访问 400 事件中的数据。但是，您可以通过添加 HTTP 状态事件的侦听器来获取状态代码。

如果您控制后端代码，则有两种解决方法：

一种选择是让后端响应 200，即使在与 flash 客户端通信时出现错误情况，但使用特殊的错误代码，以便客户端知道 200 响应实际上是错误。

另一种选择是在包含错误消息的客户端上设置一个 cookie。Flash 无法本地访问 cookie，但您可以使用 ExternalInterface 调用 javascript 来读取 cookie，或者客户端可以选择对读取 cookie 并以错误消息响应的特殊后端控制器进行另一次点击。

# asp.net - ASP.NET 中的 AutoCompleteExtender 附加信息

> ID：188889
> 
> 赞同：2
> 
> 时间：2008-10-09T19:45:35.593
> 
> 标签：asp.net, ajaxcontroltoolkit, autocompleteextender

如何将附加信息传递给返回项目集合的服务方法？我将尝试解释我的意思，我在表单上有 2 个文本框，我需要根据数据库中的特定帐户 ID 填写名称。所以，我需要将一个整数传递给 getNamesForDropDown 方法。我不知道该怎么做，所以我做错了，并使用 CompletionSetCount 来实际传递我需要的信息：

```
[System.Web.Services.WebMethod]
[System.Web.Script.Services.ScriptMethod]
public string[] getNamesForDropDown(string prefixText, int count) 
{
   String sql = "Select fldName From idAccountReps Where idAccount = " + count.ToString();
   //... rest of the method removed, this should be enough code to understand
   //... the evil wrongness I did. 
} 
```

在我的前端 aspx 文件中，我根据用户当前在该页面上查看的帐户 ID 设置 CompletionSetCount。

```
<ajaxtk:AutoCompleteExtender 
    runat="server" 
    ID="AC1" 
    TargetControlID="txtAccName"
    ServiceMethod="getNamesForDropDown"
    ServicePath="AccountInfo.asmx"
    MinimumPrefixLength="1" 
    EnableCaching="true"
    CompletionSetCount='<%# Eval("idAccount") %>'
/> 
```

所以，这绝对是一个错误的方式......什么是正确的方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T19:53:54.187

azam 有正确的想法——但自动完成方法的签名也可以有第三个参数：

public string[] yourmethod(string prefixText, int count, string **contextKey** )

您可以使用 Azam 的方法拆分 contextKey 字符串的结果 - 但这样您就不必担心用户输入的 .Split() 分隔符 (:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T19:52:51.647

天哪，我想这就是我需要的，我发誓在我开始编程之前我从未见过这个选项。这是自动完成扩展器的新属性吗？

[文档摘录](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)：

ContextKey - 提供给 ServiceMethod/ServicePath 描述的 Web 方法的可选重载的用户/页面特定上下文。如果使用上下文密钥，它应该具有相同的签名，并带有一个名为 contextKey 的字符串类型的附加参数：

[System.Web.Services.WebMethod] [System.Web.Script.Services.ScriptMethod] public string[] GetCompletionList(string prefixText, int count, string contextKey) { ... }

请注意，您可以将“GetCompletionList”替换为您选择的名称，但返回类型和参数名称和类型必须完全匹配，包括大小写。

编辑：不管它是否是新的，或者我是否完全忽略了它。它有效，我很高兴。我花了大约 10 分钟从困惑到找出自己的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T19:48:25.430

如果您愿意，可以使用带有前缀文本的分隔符。因此，您可以传递“1:bcd”，并在服务端拆分这两项：

```
string[] arguments = prefixText.Split(':'); 
int id = Int32.Parse(arguments[0]);
string text = arguments[1]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-27T14:47:50.567

参考这里 [http://www.aspsnippets.com/Articles/ASPNet-AJAX-AutoCompleteExtender-Pass-Additional-Parameter-to-WebMethod-using-ContextKey.aspx](http://www.aspsnippets.com/Articles/ASPNet-AJAX-AutoCompleteExtender-Pass-Additional-Parameter-to-WebMethod-using-ContextKey.aspx)

# c# - .NET 中的全局模式匹配

> ID：188892
> 
> 赞同：56
> 
> 时间：2008-10-09T19:45:51.130
> 
> 标签：c#, .net, glob

.NET 中是否有内置机制来匹配正则表达式以外的模式？我想使用 UNIX 样式（glob）通配符（* = 任意数量的任意字符）进行匹配。

我想将其用于面向最终用户的控件。我担心允许所有 RegEx 功能会非常混乱。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2010-11-10T15:56:14.477

我喜欢我的代码更语义化，所以我写了这个扩展方法：

```
using System.Text.RegularExpressions;

namespace Whatever
{
    public static class StringExtensions
    {
        /// <summary>
        /// Compares the string against a given pattern.
        /// </summary>
        /// <param name="str">The string.</param>
        /// <param name="pattern">The pattern to match, where "*" means any sequence of characters, and "?" means any single character.</param>
        /// <returns><c>true</c> if the string matches the given pattern; otherwise <c>false</c>.</returns>
        public static bool Like(this string str, string pattern)
        {
            return new Regex(
                "^" + Regex.Escape(pattern).Replace(@"\*", ".*").Replace(@"\?", ".") + "$",
                RegexOptions.IgnoreCase | RegexOptions.Singleline
            ).IsMatch(str);
        }
    }
} 
```

（更改命名空间和/或将扩展方法复制到您自己的字符串扩展类）

使用此扩展，您可以编写如下语句：

```
if (File.Name.Like("*.jpg"))
{
   ....
} 
```

只是糖让你的代码更易读:-)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2016-06-03T09:56:24.443

只是为了完整性。自 2016 年以来，`dotnet core`有一个名为`Microsoft.Extensions.FileSystemGlobbing`支持高级全局路径的新 nuget 包。（[Nuget 包](https://www.nuget.org/packages/Microsoft.Extensions.FileSystemGlobbing)）

一些示例可能是，搜索通配符嵌套的文件夹结构和文件，这在 Web 开发场景中非常常见。

*   `wwwroot/app/**/*.module.js`
*   `wwwroot/app/**/*.js`

这与使用哪些`.gitignore`文件来确定要从源代码管理中排除哪些文件有点类似。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-10-10T06:04:16.467

我为您找到了实际代码：

```
Regex.Escape( wildcardExpression ).Replace( @"\*", ".*" ).Replace( @"\?", "." ); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-08-25T00:35:35.047

列表方法的 2 和 3 参数变体像`GetFiles()`和`EnumerateDirectories()`将搜索字符串作为支持文件名通配符的第二个参数，同时使用`*`和`?`。

```
class GlobTestMain
{
    static void Main(string[] args)
    {
        string[] exes = Directory.GetFiles(Environment.CurrentDirectory, "*.exe");
        foreach (string file in exes)
        {
            Console.WriteLine(Path.GetFileName(file));
        }
    }
} 
```

会产生

```
GlobTest.exe
GlobTest.vshost.exe 
```

[文档](http://msdn.microsoft.com/en-us/library/wz42302f.aspx)指出，有一些与匹配扩展名有关的警告。它还指出 8.3 文件名是匹配的（可能在幕后自动生成），这可能导致给定某些模式中的“重复”匹配。

支持这一点的方法是`GetFiles()`、`GetDirectories()`和`GetFileSystemEntries()`。`Enumerate`变体也支持这一点。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-09T19:54:23.810

如果你使用 VB.Net，你可以使用 Like 语句，它有类似 Glob 的语法。

[http://www.getdotnetcode.com/gdncstore/free/Articles/Intoduction%20to%20the%20VB%20NET%20Like%20Operator.htm](http://www.getdotnetcode.com/gdncstore/free/Articles/Intoduction%20to%20the%20VB%20NET%20Like%20Operator.htm)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-05T06:54:13.183

我写了一个[FileSelector](http://dotnetzip.codeplex.com/SourceControl/changeset/view/29860#442559)类，它根据文件名选择文件。它还根据时间、大小和属性选择文件。如果您只想要文件名通配符，那么您可以用“*.txt”等形式表达名称。如果您需要其他参数，那么您可以指定一个布尔逻辑语句，例如“name = *.xls and ctime < 2009-01-01” - 暗示在 2009 年 1 月 1 日之前创建的 .xls 文件。您还可以根据否定选择： "name != *.xls" 表示所有不是 xls 的文件。

看看这个。开源。自由许可证。在其他地方免费使用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-09-11T18:12:43.353

我为 .NETStandard 编写了一个包含测试和基准的全局库。我的目标是为 .NET 生成一个库，它具有最小的依赖关系，不使用 Regex，并且优于 Regex。

你可以在这里找到它：

*   [github.com/dazinator/DotNet.Glob](http://github.com/dazinator/DotNet.Glob)
*   [https://www.nuget.org/packages/DotNet.Glob/](https://www.nuget.org/packages/DotNet.Glob/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-11-11T13:00:41.920

如果你想避免使用正则表达式，这是一个基本的 glob 实现：

```
public static class Globber
{
    public static bool Glob(this string value, string pattern)
    {
        int pos = 0;

        while (pattern.Length != pos)
        {
            switch (pattern[pos])
            {
                case '?':
                    break;

                case '*':
                    for (int i = value.Length; i >= pos; i--)
                    {
                        if (Glob(value.Substring(i), pattern.Substring(pos + 1)))
                        {
                            return true;
                        }
                    }
                    return false;

                default:
                    if (value.Length == pos || char.ToUpper(pattern[pos]) != char.ToUpper(value[pos]))
                    {
                        return false;
                    }
                    break;
            }

            pos++;
        }

        return value.Length == pos;
    }
} 
```

像这样使用它：

```
Assert.IsTrue("text.txt".Glob("*.txt")); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-04T17:49:21.183

根据之前的帖子，我整理了一个 C# 类：

```
using System;
using System.Text.RegularExpressions;

public class FileWildcard
{
    Regex mRegex;

    public FileWildcard(string wildcard)
    {
        string pattern = string.Format("^{0}$", Regex.Escape(wildcard)
            .Replace(@"\*", ".*").Replace(@"\?", "."));
        mRegex = new Regex(pattern, RegexOptions.IgnoreCase | RegexOptions.Singleline);
    }
    public bool IsMatch(string filenameToCompare)
    {
        return mRegex.IsMatch(filenameToCompare);
    }
} 
```

使用它会是这样的：

```
FileWildcard w = new FileWildcard("*.txt");
if (w.IsMatch("Doug.Txt"))
   Console.WriteLine("We have a match"); 
```

匹配与 System.IO.Directory.GetFiles() 方法不同，所以不要一起使用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-08-18T18:06:21.500

在 C# 中，您可以使用 .NET 的[LikeOperator.LikeString](https://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compilerservices.likeoperator.likestring.aspx)方法。[这是 VB 的LIKE 运算符](https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx)的支持实现。它支持使用 *、?、#、[charlist] 和 [!charlist] 的模式。

您可以通过添加对 Microsoft.VisualBasic.dll 程序集的引用来使用 C# 中的 LikeString 方法，该程序集包含在每个版本的 .NET Framework 中。然后像任何其他静态 .NET 方法一样调用 LikeString 方法：

```
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
...
bool isMatch = LikeOperator.LikeString("I love .NET!", "I love *", CompareMethod.Text);
// isMatch should be true. 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-08-06T13:18:25.107

[https://www.nuget.org/packages/Glob.cs](https://www.nuget.org/packages/Glob.cs)

[https://github.com/mgans/Glob.cs](https://github.com/mganss/Glob.cs)

.NET 的 GNU Glob。

您可以在安装后摆脱包引用，只需编译单个 Glob.cs 源文件。

由于它是 GNU Glob 的实现，因此一旦您找到另一个类似的实现，它就可以跨平台和跨语言享受！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-09T19:52:55.140

我不知道 .NET 框架是否有 glob 匹配，但你不能用 .* 替换 * 吗？并使用正则表达式？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-05T13:45:31.693

只是出于好奇，我浏览了 Microsoft.Extensions.FileSystemGlobbing - 它拖累了对很多库的巨大依赖 - 我已经决定为什么我不能尝试编写类似的东西？

嗯 - 说起来容易做起来难，我很快注意到它毕竟不是那么微不足道的功能 - 例如“*.txt”应该只匹配当前文件，而“**.txt”也应该收获子文件夹。

Microsoft 还测试了一些奇怪的匹配模式序列，例如“./*.txt”——我不确定谁真正需要“./”类型的字符串——因为它们在处理时无论如何都会被删除。（[https://github.com/aspnet/FileSystem/blob/dev/test/Microsoft.Extensions.FileSystemGlobbing.Tests/PatternMatchingTests.cs](https://github.com/aspnet/FileSystem/blob/dev/test/Microsoft.Extensions.FileSystemGlobbing.Tests/PatternMatchingTests.cs)）

无论如何，我已经编写了自己的函数 - 并且将有两个副本 - 一个在 svn 中（我可能稍后会修复它） - 我也会在此处复制一个示例以用于演示目的。我建议从 svn 链接复制粘贴。

SVN 链接：

[https://sourceforge.net/p/syncproj/code/HEAD/tree/SolutionProjectBuilder.cs#l800](https://sourceforge.net/p/syncproj/code/HEAD/tree/SolutionProjectBuilder.cs#l800) （如果没有正确跳转，请搜索 matchFiles 函数）。

这里也是本地函数副本：

```
/// <summary>
/// Matches files from folder _dir using glob file pattern.
/// In glob file pattern matching * reflects to any file or folder name, ** refers to any path (including sub-folders).
/// ? refers to any character.
/// 
/// There exists also 3-rd party library for performing similar matching - 'Microsoft.Extensions.FileSystemGlobbing'
/// but it was dragging a lot of dependencies, I've decided to survive without it.
/// </summary>
/// <returns>List of files matches your selection</returns>
static public String[] matchFiles( String _dir, String filePattern )
{
    if (filePattern.IndexOfAny(new char[] { '*', '?' }) == -1)      // Speed up matching, if no asterisk / widlcard, then it can be simply file path.
    {
        String path = Path.Combine(_dir, filePattern);
        if (File.Exists(path))
            return new String[] { filePattern };
        return new String[] { };
    }

    String dir = Path.GetFullPath(_dir);        // Make it absolute, just so we can extract relative path'es later on.
    String[] pattParts = filePattern.Replace("/", "\\").Split('\\');
    List<String> scanDirs = new List<string>();
    scanDirs.Add(dir);

    //
    //  By default glob pattern matching specifies "*" to any file / folder name, 
    //  which corresponds to any character except folder separator - in regex that's "[^\\]*"
    //  glob matching also allow double astrisk "**" which also recurses into subfolders. 
    //  We split here each part of match pattern and match it separately.
    //
    for (int iPatt = 0; iPatt < pattParts.Length; iPatt++)
    {
        bool bIsLast = iPatt == (pattParts.Length - 1);
        bool bRecurse = false;

        String regex1 = Regex.Escape(pattParts[iPatt]);         // Escape special regex control characters ("*" => "\*", "." => "\.")
        String pattern = Regex.Replace(regex1, @"\\\*(\\\*)?", delegate (Match m)
            {
                if (m.ToString().Length == 4)   // "**" => "\*\*" (escaped) - we need to recurse into sub-folders.
                {
                    bRecurse = true;
                    return ".*";
                }
                else
                    return @"[^\\]*";
            }).Replace(@"\?", ".");

        if (pattParts[iPatt] == "..")                           // Special kind of control, just to scan upper folder.
        {
            for (int i = 0; i < scanDirs.Count; i++)
                scanDirs[i] = scanDirs[i] + "\\..";

            continue;
        }

        Regex re = new Regex(pattern, RegexOptions.Compiled | RegexOptions.IgnoreCase);
        int nScanItems = scanDirs.Count;
        for (int i = 0; i < nScanItems; i++)
        {
            String[] items;
            if (!bIsLast)
                items = Directory.GetDirectories(scanDirs[i], "*", (bRecurse) ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly);
            else
                items = Directory.GetFiles(scanDirs[i], "*", (bRecurse) ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly);

            foreach (String path in items)
            {
                String matchSubPath = path.Substring(scanDirs[i].Length + 1);
                if (re.Match(matchSubPath).Success)
                    scanDirs.Add(path);
            }
        }
        scanDirs.RemoveRange(0, nScanItems);    // Remove items what we have just scanned.
    } //for

    //  Make relative and return.
    return scanDirs.Select( x => x.Substring(dir.Length + 1) ).ToArray();
} //matchFiles 
```

如果你发现任何错误，我会毕业来修复它们。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-04-04T14:16:41.467

我写了一个解决方案。它不依赖于任何库，也不支持“！” 或“[]”运算符。它支持以下搜索模式：

C:\Logs\*.txt

C:\Logs\**\*P1?\**\asd*.pdf

```
 /// <summary>
    /// Finds files for the given glob path. It supports ** * and ? operators. It does not support !, [] or ![] operators
    /// </summary>
    /// <param name="path">the path</param>
    /// <returns>The files that match de glob</returns>
    private ICollection<FileInfo> FindFiles(string path)
    {
        List<FileInfo> result = new List<FileInfo>();
        //The name of the file can be any but the following chars '<','>',':','/','\','|','?','*','"'
        const string folderNameCharRegExp = @"[^\<\>:/\\\|\?\*" + "\"]";
        const string folderNameRegExp = folderNameCharRegExp + "+";
        //We obtain the file pattern
        string filePattern = Path.GetFileName(path);
        List<string> pathTokens = new List<string>(Path.GetDirectoryName(path).Split('\\', '/'));
        //We obtain the root path from where the rest of files will obtained 
        string rootPath = null;
        bool containsWildcardsInDirectories = false;
        for (int i = 0; i < pathTokens.Count; i++)
        {
            if (!pathTokens[i].Contains("*")
                && !pathTokens[i].Contains("?"))
            {
                if (rootPath != null)
                    rootPath += "\\" + pathTokens[i];
                else
                    rootPath = pathTokens[i];
                pathTokens.RemoveAt(0);
                i--;
            }
            else
            {
                containsWildcardsInDirectories = true;
                break;
            }
        }
        if (Directory.Exists(rootPath))
        {
            //We build the regular expression that the folders should match
            string regularExpression = rootPath.Replace("\\", "\\\\").Replace(":", "\\:").Replace(" ", "\\s");
            foreach (string pathToken in pathTokens)
            {
                if (pathToken == "**")
                {
                    regularExpression += string.Format(CultureInfo.InvariantCulture, @"(\\{0})*", folderNameRegExp);
                }
                else
                {
                    regularExpression += @"\\" + pathToken.Replace("*", folderNameCharRegExp + "*").Replace(" ", "\\s").Replace("?", folderNameCharRegExp);
                }
            }
            Regex globRegEx = new Regex(regularExpression, RegexOptions.Compiled | RegexOptions.CultureInvariant | RegexOptions.IgnoreCase);
            string[] directories = Directory.GetDirectories(rootPath, "*", containsWildcardsInDirectories ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly);
            foreach (string directory in directories)
            {
                if (globRegEx.Matches(directory).Count > 0)
                {
                    DirectoryInfo directoryInfo = new DirectoryInfo(directory);
                    result.AddRange(directoryInfo.GetFiles(filePattern));
                }
            }

        }
        return result;
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-26T00:58:41.047

不幸的是，接受的答案将无法正确处理转义输入，因为字符串`.Replace("\*", ".*")`无法区分“*”和“\*” - 它会很乐意替换这两个字符串中的“*”，从而导致不正确的结果。

相反，可以使用基本标记器将 glob 路径转换为正则表达式模式，然后可以使用`Regex.Match`. 这是一个更加健壮和灵活的解决方案。

这是一种方法。它处理`?`, `*`, 和`**`, 并用捕获组围绕这些 glob 中的每一个，因此可以在匹配 Regex 后检查每个 glob 的值。

```
static string GlobbedPathToRegex(ReadOnlySpan<char> pattern, ReadOnlySpan<char> dirSeparatorChars)
{
    StringBuilder builder = new StringBuilder();
    builder.Append('^');

    ReadOnlySpan<char> remainder = pattern;

    while (remainder.Length > 0)
    {
        int specialCharIndex = remainder.IndexOfAny('*', '?');

        if (specialCharIndex >= 0)
        {
            ReadOnlySpan<char> segment = remainder.Slice(0, specialCharIndex);

            if (segment.Length > 0)
            {
                string escapedSegment = Regex.Escape(segment.ToString());
                builder.Append(escapedSegment);
            }

            char currentCharacter = remainder[specialCharIndex];
            char nextCharacter = specialCharIndex < remainder.Length - 1 ? remainder[specialCharIndex + 1] : '\0';

            switch (currentCharacter)
            {
                case '*':
                    if (nextCharacter == '*')
                    {
                        // We have a ** glob expression
                        // Match any character, 0 or more times.
                        builder.Append("(.*)");

                        // Skip over **
                        remainder = remainder.Slice(specialCharIndex + 2);
                    }
                    else
                    {
                        // We have a * glob expression
                        // Match any character that isn't a dirSeparatorChar, 0 or more times.
                        if(dirSeparatorChars.Length > 0) {
                            builder.Append($"([^{Regex.Escape(dirSeparatorChars.ToString())}]*)");
                        }
                        else {
                            builder.Append("(.*)");
                        }

                        // Skip over *
                        remainder = remainder.Slice(specialCharIndex + 1);
                    }
                    break;
                case '?':
                    builder.Append("(.)"); // Regex equivalent of ?

                    // Skip over ?
                    remainder = remainder.Slice(specialCharIndex + 1);
                    break;
            }
        }
        else
        {
            // No more special characters, append the rest of the string
            string escapedSegment = Regex.Escape(remainder.ToString());
            builder.Append(escapedSegment);
            remainder = ReadOnlySpan<char>.Empty;
        }
    }

    builder.Append('$');

    return builder.ToString();
} 
```

使用它：

```
string testGlobPathInput = "/Hello/Test/Blah/**/test*123.fil?";
string globPathRegex = GlobbedPathToRegex(testGlobPathInput, "/"); // Could use "\\/" directory separator chars on Windows

Console.WriteLine($"Globbed path: {testGlobPathInput}");
Console.WriteLine($"Regex conversion: {globPathRegex}");

string testPath = "/Hello/Test/Blah/All/Hail/The/Hypnotoad/test_somestuff_123.file";
Console.WriteLine($"Test Path: {testPath}");
var regexGlobPathMatch = Regex.Match(testPath, globPathRegex);

Console.WriteLine($"Match: {regexGlobPathMatch.Success}");

for(int i = 0; i < regexGlobPathMatch.Groups.Count; i++) {
    Console.WriteLine($"Group [{i}]: {regexGlobPathMatch.Groups[i]}");
} 
```

输出：

```
Globbed path: /Hello/Test/Blah/**/test*123.fil?
Regex conversion: ^/Hello/Test/Blah/(.*)/test([^/]*)123\.fil(.)$
Test Path: /Hello/Test/Blah/All/Hail/The/Hypnotoad/test_somestuff_123.file
Match: True
Group [0]: /Hello/Test/Blah/All/Hail/The/Hypnotoad/test_somestuff_123.file
Group [1]: All/Hail/The/Hypnotoad
Group [2]: _somestuff_
Group [3]: e 
```

我在这里创建了一个要点作为此方法的规范版本：

[https://gist.github.com/crozone/9a10156a37c978e098e43d800c6141ad](https://gist.github.com/crozone/9a10156a37c978e098e43d800c6141ad)

# c# - 电话号码格式，OnBlur

> ID：188894
> 
> 赞同：0
> 
> 时间：2008-10-09T19:45:53.390
> 
> 标签：c#, .net, winforms, textbox

我有一个用于电话号码字段的 .NET WinForms 文本框。允许自由格式文本后，我想在用户离开文本框后将文本格式化为“更易读”的电话号码。（当您创建/编辑联系人时，Outlook 具有电话字段的此功能）

*   1234567 变为 123-4567
*   1234567890 变为 (123) 456-7890
*   (123)456.7890 变为 (123) 456-7890
*   123.4567x123 变为 123-4567 x123
*   ETC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T20:00:35.640

一个相当简单的方法是使用正则表达式。根据您接受的电话号码类型，您可以编写一个查找数字的正则表达式（仅限美国，您知道总共可以有 7 或 10 个 - 可能带有前导“1”）和潜在的分隔符它们之间（句点、破折号、括号、空格等）。

对正则表达式运行匹配后，您需要编写逻辑以确定您实际得到的内容并从那里格式化。

编辑：只是想添加一个非常基本的示例（这绝不适用于您上面发布的所有示例）。杰夫关于去除非数字字符的建议可能会有所帮助，具体取决于您编写正则表达式的方式。

```
Regex regex = new Regex(@"(?<areaCode>([\d]{3}))?[\s.-]?(?<leadingThree>([\d]{3}))[\s.-]?(?<lastFour>([\d]{4}))[x]?(?<extension>[\d]{1,})?");
string phoneNumber = "701 123-4567x324";

Match phoneNumberMatch = regex.Match(phoneNumber);
if(phoneNumberMatch.Success)
{
   if (phoneNumberMatch.Groups["areaCode"].Success)
   {
      Console.WriteLine(phoneNumberMatch.Groups["areaCode"].Value);
   }
   if (phoneNumberMatch.Groups["leadingThree"].Success)
   {
      Console.WriteLine(phoneNumberMatch.Groups["leadingThree"].Value);
   }
   if (phoneNumberMatch.Groups["lastFour"].Success)
   {
      Console.WriteLine(phoneNumberMatch.Groups["lastFour"].Value);
   }
   if (phoneNumberMatch.Groups["extension"].Success)
   {
      Console.WriteLine(phoneNumberMatch.Groups["extension"].Value);
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T20:03:46.477

我认为最简单的方法是首先从字符串中删除任何非数字字符，这样你就只有一个数字，然后按照这个[问题中提到的格式进行格式化](https://stackoverflow.com/questions/188510/how-to-format-a-string-as-a-telephone-number-in-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T21:51:53.730

我考虑过剥离任何非数字字符然后进行格式化，但我认为这对于扩展案例 (123.4567x123) 不太适用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T05:04:18.460

删除扩展名，然后从其余部分中删除非数字字符。格式化它，然后重新添加扩展名。

```
Start: 123.4567x123
Lop: 123.4567
Strip: 1234567
Format: 123-4567
Add: 123-4567 x123 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-13T02:02:01.313

这对我有用。如果您在紧密循环中执行此操作，则值得检查性能......

```
public static string FormatPhoneNumber(string phone)
{
    phone = Regex.Replace(phone, @"[^\d]", "");
    if (phone.Length == 10)
        return Regex.Replace(phone,
                             "(?<ac>\\d{3})(?<pref>\\d{3})(?<num>\\d{4})",
                             "(${ac}) ${pref}-${num}");
    else if ((phone.Length < 16) && (phone.Length > 10))
        return Regex.Replace(phone,
                             "(?<ac>\\d{3})(?<pref>\\d{3})(?<num>\\d{4})(?<ext>\\d{1,5})", 
                             "(${ac}) ${pref}-${num} x${ext}");
    else
        return string.Empty; 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T19:55:55.120

除了自己做一些面具并检查它匹配哪个面具并根据具体情况做每个面具之外，我不知道任何其他方法。不要觉得太难，就是费时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T19:55:58.783

我的猜测是，您可以使用条件语句来查看输入，然后将其解析为特定格式来完成此操作。但我猜将会有大量的逻辑来调查输入和格式化输出。

# perl - 为什么当我在 Perl 中打印到 stderr 时 IIS 会崩溃？

> ID：188896
> 
> 赞同：2
> 
> 时间：2008-10-09T19:46:50.957
> 
> 标签：perl, iis

这一直让我发疯。我们有 IIS (6) 和 windows 2008 和 ActiveState Perl 5.10。出于某种原因，每当我们发出警告或鲤鱼时，它最终都会破坏应用程序池。当然，这很重要，因为这意味着我们的错误实际上会导致问题。

以前版本的 Perl (5.8) 和 Windows (2003) 和 IIS (5.) 都会发生这种情况。无论如何，基本上我输入了 a`carp`或 a `warn`，然后我收到一条错误消息，然后是一些垃圾文本。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-12T15:19:03.027

检查以确保 IIS 和 perl DLL 与相同版本的 C 运行时库链接。（使用depends.exe 或dumpbin /dependents）。

扩展：问题可能是 IIS 将其 FILE* 表放在一个位置，而 perl DLL 认为它将位于一个稍微不同的位置。当 perl 去寻找 stderr 句柄时，它把随机内存当作一个文件句柄，结果是可预测的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T18:19:02.383

更新：我发现只有在警告中有变量时才会发生此错误。如果警告只是常规文本，则没有问题。此外，该变量不能为空，看起来您必须有两个非空变量警告才能解决该错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T00:54:14.630

尝试将以下内容添加到脚本的顶部：

```
BEGIN {
    open STDERR, '>> c:/iisError.log'
        or  die "Can't write to c:/issError.log: $!\n";
    binmode STDERR;
} 
```

我不确定你为什么会遇到这个问题。但是上面的代码可以解决关于此类问题来源的几个“疯狂”猜测。

（我已经有一段时间没有阅读在 Win32 中附加到文件的源代码了，但是，我记得，>> 模式加上 binmode 意味着从不同进程写入文件不太可能发生冲突，从而防止在日志。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T12:47:43.253

几个建议：

1.  确保工作进程的 id 对您正在写入的目录/文件具有写入权限。不过，我可能不会让它完全控制 C:。最好做一个子目录。
2.  使用 Win32::EventLog 写入事件日志而不是文件

# vba - VBA 中是否有办法了解未使用的变量？

> ID：188913
> 
> 赞同：18
> 
> 时间：2008-10-09T19:51:27.157
> 
> 标签：vba, excel, variables, vbe

标准 VBA 编辑器中是否有工具、方法或设置来警告已`Dim`使用但未使用的变量？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-09T20:10:10.160

[MZ-Tools](http://www.mztools.com/index.aspx)将搜索您的代码并告诉您没有使用的内容。VBA 的版本可以在[这里](http://www.mztools.com/v3/mztools3.aspx)找到。

MZ-Tools 中执行您询问的特定功能是[Review Source Code](http://www.mztools.com/v3/onlinehelp/index.html?html_review_source_code.htm)：

> 查看源代码功能允许您查看源代码以检测一些未使用的声明（常量、变量、参数、过程等）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-04-05T12:34:29.103

另一种方法（因为我没有安装该软件的管理员权限）是放在`Option Explicit`模块的顶部。然后注释掉所有的'med 变量，并使用++`Dim`调试代码`F8`或重新 编译`Alt``d``l`

取消注释`Dim`s 直到`Option Explicit`不返回编译器错误，此时仍然注释掉的任何变量都可以忽略，因为它们没有在您的代码中使用

* * *

与 MZ-Tools 类似，[RubberDuck](https://github.com/rubberduck-vba/Rubberduck/releases/latest)有一个[VariableNotUsed 检查](https://rubberduckvba.com/Inspections/Details/VariableNotUsed)（以及许多其他东西），它应该准确地显示你所追求的。它是免费的，从 v2.2.0.3086 开始，它支持非管理员安装。

# c# - 如何在技术规范中记录 WCF Web 服务？

> ID：188919
> 
> 赞同：4
> 
> 时间：2008-10-09T19:51:56.640
> 
> 标签：c#, wcf, web-services

除了在技术规范中粘贴 WDSL 之外，在开始编码之前记录 WCF Web 服务的推荐方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T20:43:37.193

我们最近发布了一个基于 WCF 的 SOAP 接口，供第三方集成。对于每种方法，我们提供了以下内容：

*   方法名称
*   请求示例（有线格式转储）
*   请求参数说明
*   响应示例（有线格式转储）
*   请求参数说明
*   注意事项（陷阱）
*   历史

我们还提供 WSDL。您可能需要使用 Microsoft 的[Disco.exe](http://msdn.microsoft.com/en-us/library/cy2a3ybs.aspx)来执行此操作。另请参阅有关[获取 WSDL](https://stackoverflow.com/questions/286657/what-is-the-best-way-to-download-all-of-the-wsdl-files-exposed-by-a-wcf-service)的相关问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T19:56:33.900

像记录任何其他界面一样记录合同界面。描述操作、前置条件、后置条件、引发故障的原因等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:58:43.507

此外，如果您使用 MessageContracts 记录您使用它们的原因......相信我，您会想知道为什么这样做 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T20:08:00.180

*   描述服务端点和可用的协议/绑定。例如 Https、RESTful？
*   安全功能、身份验证、授权和加密。
*   解释操作合约中参数的用例。
*   托管、IIS、WindowsService 或控制台应用程序。
*   服务的实例化。

# paradigms - 哪种编程语言范式适合哪种工作？

> ID：188934
> 
> 赞同：12
> 
> 时间：2008-10-09T19:55:51.563
> 
> 标签：paradigms

据我所知（我承认不多），目前流行的编程范式是面向对象（Java、C#、Ruby）与函数式（F#）。作为最熟悉第一范式的人，我有几个问题：

*   程序员可以一生都坚持一种范式吗？或者换句话说，所有问题都可以归结为一把锤子的钉子吗？
*   如果不是，哪种工具适合哪种类型的任务？例如：基于 Web 与桌面，创建美观且响应迅速的界面，能够快速处理数据等。
*   人们是否曾经需要学习新的范式？对于我过去的两份工作，我的工作场所需要 Java 和 C#。是否有专门使用非面向对象语言的工作场所？

显然，没有“最好”的语言，但我想知道是否值得投入时间和精力来学习新的范式。提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-10T13:09:07.830

“或者换句话说，所有问题都可以归结为一把锤子的钉子吗？” 是的。时期。您可能遇到的任何编程语言都将与其他所有编程语言一样完整。实际上，编程语言的“完整性”有一个正式的定义。

“人们曾经需要学习新的范式吗？” 总是。

跟随“范式转变”的起起落落实际上有一个技巧。在我职业生涯的最后 30 年中，我看到编程已经从一个相对简单的命令式/过程模型发展为许多更丰富的模型，包括在过程和数据之间实现更好的平衡。

我注意到以下...

部分驱动力是人工智能社区。这些“新模型”中有许多是作为 AI 知识表示方案开始的。他们在那里获得了牵引力，然后他们逐渐进入了更主流的应用程序。

实体关系模型最初是用于知识表示，而不是业务交易。类似地，对象模型用于知识表示。然后模拟人发现了它。现在我们其他人拥有它。

这是我的结论。

**软件是知识表示。**

您对范式或模型或方法或风格的选择基于对以下问题的回答：

“我怎样才能最好地代表这个问题？”

如果问题有对象和关系，OO。如果问题有算法和转换、映射、过滤器和归约，函数式。如果问题是动态的、变化的和灵活的，动态的。如果问题是静态的并且会迅速扩大，静态。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-09T19:59:02.600

值得学习替代范式（OO、功能、程序、动态等），因为它将帮助您以不同的方式思考问题。

例如，考虑以线性方式（我曾经做过的第一种方式）解决树遍历与使用递归的区别。或者 Google 结合 Map 和 Reduce 来帮助他们索引互联网。

应用于旧问题的新思维方式可以帮助解决一些最棘手的问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-09T20:10:48.800

范式独立于语言。您可以在 C 中以 OO 风格进行开发（看看 GTK）。当我用 Java 编程时，我主要使用函数式风格。

尽可能多地了解范式是值得的。有些问题在一种范式中是微不足道的，而在另一种范式中则需要精心设计。

作为一个（简单的）示例，在此页面上比较 Java 和 Ocaml 中的快速排序实现，或者更好的是 Haskell：[http ://www.rosettacode.org/rosettacode/w/index.php?title=Quicksort](http://www.rosettacode.org/rosettacode/w/index.php?title=Quicksort)

（这并不意味着功能更好。OO更好地解决了一些问题）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-09T20:40:58.943

> 所有问题都可以归结为一把锤子的钉子吗？

是的。你可以用一把锤子解决问题。它只是将那扇门锯成两半需要更长的时间。

> 人们是否曾经需要学习新的范式？对于我过去的两份工作，我的工作场所需要 Java 和 C#。是否有专门使用非面向对象语言的工作场所？

开发人员必须每 15-20 年左右进行一次。

肯定有整个行业的小公司都拥有使用过程 VBA 编写的基于 Access 的系统。（我认为我为他们中的大多数人工作过）。经典的 ASP 开发人员必须学习 ASP.NET。Perl 开发人员正在学习 Python。批处理驱动开发让位于事件驱动开发。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T19:57:57.313

我认为你会在所有方面找到答案。我工作得越多，我就越发现了解其他一些人是“有帮助的”。作为 C#/VB/SQL Server 开发人员，我发现了解 F# 和其他一些语言对我更有帮助，以便获得广泛的接触，真正找出合适的工具......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T21:52:16.990

动态的东西把我吓坏了，但是 Ruby on Rails 是迄今为止我见过的最好的 web 开发系统。不过，我对将它用于一个非常大、需要大量维护的项目感到不舒服，因为它太容易改变现有、已编译、已完成代码的含义。对于一个人的编码风格来说，也太容易将其变成一种新的语言。

动态/脚本对于系统管理员和任何运行 Linux 系统的人来说也很重要。用 BASH 或 Ruby 编写一个快速的脚本比尝试在 Java 或 C++ 中实现相同的功能更胜一筹。

OO 使理解大量代码变得更加容易。如果您有一个大型团队或多个大型团队并且需要快速提供概述，那么 OO 可以更轻松地描述和隔离给定的功能。我应该说正确编码 OO！

我理解函数式对于多线程编程很有好处，因为一切都趋于不可变。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T20:04:45.943

在考虑 OOP 的情况下开发设计和架构技能是出色的语言无关职业最理想的技能组合。

在 Oops 中编写代码的好处是对其他团队成员和整个组织都有好处。因为代码对所有人来说都是可以理解的，如果开发人员辞职了，公司不需要太担心。在另一种情况下，如果您遵循功能样式，其他人将很难理解您所做的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T19:01:56.353

正如大多数其他人所说，您通常可以使用任何语言来解决任何问题，并且您通常可以以一种范式的风格编写另一种范式。

如果您花时间学习按预期使用不同的范式，那么您确实会学习有关知识表示和解决问题的不同知识，这对您将来使用的任何范式都有帮助。

虽然范例和领域之间存在一定的一致性，但通常最好根据您的软件需要在其中运行的环境的细节来选择一种语言。

*   它是否需要在多个桌面平台上运行？
*   如果它是一个桌面应用程序，它是否需要具有原生的外观和感觉？
*   设计的快速迭代重要吗
*   它是如何保养的？
*   它需要与哪些第三方系统一起运行？
*   现有的程序员知识/技能/偏好。

# linq-to-sql - 截断表的正确 LINQtoSQL 方式是什么？

> ID：188940
> 
> 赞同：3
> 
> 时间：2008-10-09T19:56:46.740
> 
> 标签：linq-to-sql, tsql, data-access-layer, truncate

我有一个带有强大数据访问层的项目，它使用 LinqtoSQL 来处理任何涉及我们数据库的事情。我需要构建一个帮助类，将一些常见的 crud 操作从 CLSA 对象连接到 LinqToSql 对象。一切都在顺利运行，直到我需要在桌子上进行截断，而我所拥有的只是“删除”方法。

哦哦。快速搜索显示有些人正在使用 YourContext.ExecuteCommand()，这很好，但这些天我正在尝试尽可能多地使用“t-sql-less”。

是否有一种 LINQ 方法可以[对表执行截断](http://msdn.microsoft.com/en-us/library/aa260621(SQL.80).aspx)？还是我只是[一无所知](http://en.wikipedia.org/wiki/Clueless_(film))？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T20:04:48.440

如果不执行自定义 T-SQL 查询，这是不可能的。正如您可能已经知道的那样，执行 .Delete() 和 SubmitChanges 后缀会导致 DELETE 语句。

当然，您可以创建一个截断表的存储过程，然后从 LINQ 调用该过程，但我相信这并不是您真正想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T20:15:14.800

你可以这样做：

```
yourDataContext.ExecuteCommand("TRUNCATE TABLE YourTable"); 
```

# c++ - 您如何通过 STL 列表向后迭代？

> ID：188942
> 
> 赞同：37
> 
> 时间：2008-10-09T19:57:10.343
> 
> 标签：c++, list, stl, iterator, traversal

我正在编写一些 Windows 和 Mac 之间的跨平台代码。

如果 list::end() “返回一个迭代器，该迭代器指向列表中最后一个元素之后的位置”并且可以在向前遍历列表时检查，那么向后遍历的最佳方法是什么？

此代码适用于 Mac，但不适用于 Windows（不能递减超过第一个元素）：

```
list<DVFGfxObj*>::iterator iter = m_Objs.end();
for (iter--; iter!=m_Objs.end(); iter--)// By accident discovered that the iterator is circular ?
{
} 
```

这适用于 Windows：

```
list<DVFGfxObj*>::iterator iter = m_Objs.end();
    do{
        iter--;
    } while (*iter != *m_Objs.begin()); 
```

是否有另一种可以在 for 循环中实现的向后遍历方法？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-09T19:58:08.233

使用`reverse_iterator`而不是`iterator`. 使用`rbegin()`&`rend()`代替`begin()`& `end()`。

如果您喜欢使用[`BOOST_FOREACH`](http://www.boost.org/doc/libs/1_36_0/doc/html/foreach.html)宏，另一种可能性是使用`BOOST_REVERSE_FOREACH`Boost 1.36.0 中引入的宏。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-21T20:33:18.520

反向迭代列表的最佳/最简单方法是（如前所述）使用反向迭代器 rbegin/rend。

但是，我确实想提一下，反向迭代器的实现是将“当前”迭代器位置逐一存储（至少在标准库的 GNU 实现中）。

这样做是为了简化实现，以便反向范围与正向范围 [begin, end) 和 [rbegin, rend) 具有相同的语义

这意味着取消引用迭代器涉及创建一个新的临时对象，然后*每次*递减它：

```
 reference
  operator*() const
  {
_Iterator __tmp = current;
return *--__tmp;
  } 
```

因此，*取消引用 reverse_iterator 比普通迭代器慢。*

但是，您可以改为使用常规双向迭代器自己模拟反向迭代，避免这种开销：

```
for ( iterator current = end() ; current != begin() ; /* Do nothing */ )
{
    --current; // Unfortunately, you now need this here
    /* Do work */
    cout << *current << endl;
} 
```

测试表明，对于循环主体中使用的*每个取消引用*，该解决方案的速度提高了约 5 倍。

注意：上面的代码没有进行测试，因为 std::cout 会成为瓶颈。

另请注意：“挂钟时间”差异约为 5 秒，std::list 大小为 1000 万个元素。因此，实际上，除非您的数据量很大，否则请坚持使用 rbegin() rend()！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-09T19:59:55.640

您可能需要反向迭代器。从记忆里：

```
list<DVFGfxObj*>::reverse_iterator iter = m_Objs.rbegin();
for( ; iter != m_Objs.rend(); ++iter)
{
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-09T20:05:24.240

正如 Ferruccio 已经提到的，使用 reverse_iterator：

```
for (std::list<int>::reverse_iterator i = s.rbegin(); i != s.rend(); ++i) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-09T20:05:42.603

这应该有效：

```
list<DVFGfxObj*>::reverse_iterator iter = m_Objs.rbegin();
for (; iter!= m_Objs.rend(); iter++)
{
} 
```

# java - Java/Swing：如何在 JLabel 的自定义渲染器中绘制简单的条形图

> ID：188944
> 
> 赞同：0
> 
> 时间：2008-10-09T19:57:44.147
> 
> 标签：java, swing, custom-renderer

我想动态创建一个最小的透明条形图以显示在画布上。

我正在考虑为 JButton 或 JLabel 使用自定义渲染器；但是如何在这个渲染器中绘制我的条形图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T20:00:57.683

标准方法是创建 JLabel 或 JPanel 的子类（如果您愿意，可能是匿名的）并重载[paintComponent(Graphics g)](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#paintComponent(java.awt.Graphics))方法。然后，您可以使用传递的 Graphics 对象来绘制您需要的任何矩形（等等）。有关该部分的更多信息，请参阅[Java 2D Graphics Trail](http://java.sun.com/docs/books/tutorial/2d/index.html)。

编辑：这能回答问题吗？我只是重新阅读它，现在我不确定。

# c# - 使用 Visual Studio Express Edition 连接到 SQL Server

> ID：188963
> 
> 赞同：49
> 
> 时间：2008-10-09T20:00:36.623
> 
> 标签：c#, visual-studio-2008, visual-web-developer

我觉得奇怪的是，在 Visual C# 2008 Express 版本中，当您使用数据库资源管理器时，您的选项是：

1.  微软访问
2.  SQL Server Compact 3.5 和
3.  SQL Server 数据库文件。

但是，如果您使用 Visual Web Developer 2008 Express，您可以连接到常规的 SQL Server、Oracle、ODBC 等。

对于开发需要与 SQL Server 数据库通信的命令行或其他 C# 应用程序的人来说，您真的需要使用一个 IDE（Visual Web Developer）和另一个（Visual C#）中的程序来构建您的 LINQ/数据访问代码吗？

这不是一个困难的解决方法，但它看起来很奇怪。如果 Microsoft 想要强制您升级到 Visual Studio 以连接到 SQL Server，为什么他们会在他们的一个免费 IDE 中包含该功能，而不是另一个？我觉得我可能会遗漏一些东西（比如如何在 Visual C# 中完成这一切）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-09T20:24:38.650

您应该能够选择 SQL Server 数据库文件选项来获取正确类型的数据库（`system.data.SqlClient`提供程序），然后手动更正连接字符串以指向您的数据库。

我认为这些数据库选择背后的原因可能是这样的：

*   如果您使用的是 Express Edition，而您*没有*使用 Visual Web Developer，那么您可能正在构建一个桌面程序。
*   如果您正在构建一个桌面程序，并且您使用的是 express 版本，那么您可能是在家工作而不是为公司进行开发的业余爱好者或 uISV-er。
*   如果您不是为公司开发，您的应用程序可能是为最终用户而设计的，并且您的数据存储可能在他们的本地计算机上。
*   您真的不应该将*服务器级*数据库部署到最终用户桌面。像 Sql Server Compact 或 MS Access 这样的*进程内*数据库更合适。

然而，这个逻辑并不完全成立。即使这 4 点中的每一个在 90% 的情况下都是正确的，但当你应用所有这四个点时，它也只适用于大约 65% 的受众，这意味着多达 35% 的快递市场可能会合法地想说话到服务器级数据库，这是一个重要的群体。因此，简化（贪婪）版本：

*   一个真正的数据库服务器（以及运行它的硬件）需要真金白银。如果您可以使用它，您应该至少能够负担得起 Visual Studio 的标准版。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-01-16T23:22:07.087

解决方法：

1.  在 Visual Web Developer Express 中打开您的解决方案。它不会加载解决方案中的某些项目，但没关系。
2.  在数据库资源管理器中与 SQL Server 所需的数据库建立新连接。
3.  添加一个新的类库项目。
4.  添加一个 LINQ to SQL Classes 项并将其链接到您的数据库。
5.  关闭解决方案。
6.  在 Visual C# Express 中打开解决方案。

现在您有一个 LINQ to SQL 类库，它链接到 Visual C# Express 中的 SQL Server 数据库。

**更新**

该解决方案适用于 Visual Studio Express 2010。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T20:05:09.297

我的猜测是，使用 VWD，您的解决方案更有可能部署到第三方服务器，其中许多服务器不允许动态附加 SQL Server 数据库文件。因此允许其他连接类型。

IDE 行为的这种差异是升级到完整版本的关键原因之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-11T23:17:53.177

如果您使用它来获取我为 Visual Developer 做的并想要的 LINQ to SQL，1) 获取免费的 Visual WEB Developer，使用它连接到 SQL Server 实例，创建您的 LINQ 接口，然后将生成的文件复制到你的 Vis-Dev 项目（我不使用 VD，因为它听起来很有趣）。仅包括 *.dbml 文件。Vis-Dev 环境将需要一两秒钟来识别支持文件。这是一个额外的步骤，但肯定比手工完成或完全放弃或更糟糕的是，为它付费。呜呜哈哈哈。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-17T20:49:44.660

我能够让 C# Express 2008 工作的唯一方法是移动数据库文件。因此，我打开了 SQL Server Management Studio，并在删除数据库后，将文件复制到我的项目文件夹中。然后我将数据库重新附加到管理工作室。现在，当我尝试附加到本地副本时，它可以工作。显然，您不能多次使用同一个数据库文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-08-15T15:14:07.683

为了方便起见，我只是碰巧在 Windows 窗体中启动了我的家庭业务应用程序。我目前正在使用 Visual C# Express 2010 / SQL Server 2008 R2 Express 来开发它。我遇到了与需要连接到 SQL 服务器实例的 OP 相同的问题。我在这里跳过细节，但该数据库将是在 2-3 台计算机之间同步的合并数据库，这些计算机也将使用我现在正在开发的应用程序。

我找到了一个快速的解决方法，至少，我认为我做到了，因为我现在能够在 tableadapter 中使用我的存储过程，到目前为止没有任何问题。

我在 app.config 中复制粘贴了我在另一个工作项目（VS2010 Premium）中使用的 SQL 连接，并在那里更改了我需要的所有内容。当我回到我的 Settings.settings 时，我只需要确认我想要 app.config 文件中的内容。我能看到的唯一缺点是你不能“测试”连接，因为当你进入连接字符串的配置时，你不能去任何地方，因为“SQL Server”不是一个选项。另一个缺点是您需要手动输入所有内容，因为您无法使用任何向导来使其工作。

我不知道我是否应该这样做，但至少我现在可以连接到我的 SQL 服务器 :)。

**编辑 ：**

它仅适用于 SQL Server 2008 R2 Express 实例。如果您尝试使用 SQL Server 2008 R2 Workgroup 及更高版本，您将收到来自 Visual C# 2010 Express 的令人讨厌的警告，告诉您“您不能在当前版本的 Visual Studio 中使用该连接”。当我试图修改我的一些表格适配器时，我得到了这个。我切换回 SQL Express 实例进行开发，它再次正常工作。

# sql-server - 如何确定一个列是否是 MSSQL 2000 中的标识列？

> ID：188967
> 
> 赞同：37
> 
> 时间：2008-10-09T20:01:36.027
> 
> 标签：sql-server, tsql, metadata

我想在代码中执行此操作，而不是使用 ALT+F1。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-10-09T20:16:59.117

你也可以这样做：

```
select columnproperty(object_id('mytable'),'mycolumn','IsIdentity') 
```

如果是身份则返回 1，否则返回 0。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-09T20:05:05.880

```
sp_help tablename 
```

在输出中寻找这样的东西：

```
 Identity     Seed     Increment     Not For Replication    
 -----------  -------  ------------  ---------------------- 
 userid       15500    1             0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T20:15:46.687

调整`WHERE`条款以适应：

```
select
    a.name as TableName,
    b.name as IdentityColumn
from
    sysobjects a inner join syscolumns b on a.id = b.id
where
    columnproperty(a.id, b.name, 'isIdentity') = 1
    and objectproperty(a.id, 'isTable') = 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-26T13:51:27.537

作为@Blogbeard 答案的扩展

如果您喜欢纯查询而不是内置函数

```
select col_name(sys.all_objects.object_id, column_id) as id from sys.identity_columns 
join sys.all_objects on sys.identity_columns.object_id = sys.all_objects.object_id
where sys.all_objects.name = 'system_files' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-03T20:15:05.367

标识是用于加载到表中的第一行的值。

有一篇微软文章可以提供有关身份的良好知识：

> [https://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql-identity-property?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql-identity-property?view=sql-server-2017)

现在，有几种方法可以识别表中的哪一列是标识列：

*   我们可以使用sql查询：select *columnproperty(object_id('mytable'),'mycolumn','IsIdentity')*
*   sp_help*表名*

# sql-server - SQL Server 2000 约束涉及不同表上的列

> ID：188968
> 
> 赞同：0
> 
> 时间：2008-10-09T20:01:51.627
> 
> 标签：sql-server, database, constraints

我想要一个 SQL Server 2000 表列的约束，它是外键和检查约束的组合。我的列的值必须存在于另一个表中，但我只关心另一个表中的一个列等于指定值的值。简化表如下：

```
导入表：
零件编号 varchar(30)
数量 int

库存主：
零件编号 varchar(30)
输入字符（1）

```

所以我想确保`part_number`存在于 中`inventory_master`，但前提是类型为“C”。这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T20:09:15.060

您可以在 INSERT 和 UPDATE 语句上使用触发器，以确保完整性

创建触发器语法：http: [//msdn.microsoft.com/en-us/library/ms189799.aspx](http://msdn.microsoft.com/en-us/library/ms189799.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T20:11:32.310

您可以使用 INSTEAD OF INSERT 触发器来模拟该行为。

当插入即将发生时检查值是否存在。

# c# - 从另一个线程捕获异常

> ID：188977
> 
> 赞同：13
> 
> 时间：2008-10-09T20:04:33.290
> 
> 标签：c#, .net, multithreading, exception, exception-handling

我有一个在单独的线程中运行的方法。线程是从 Windows 应用程序中的窗体创建和启动的。如果从线程内部抛出异常，将其传递回主应用程序的最佳方法是什么。现在，我将对主窗体的引用传递到线程中，然后从线程中调用该方法，并导致该方法被主应用程序线程调用。是否有最佳实践方法来做到这一点，因为我对我现在的做法感到不舒服。

我的表格示例：

```
public class frmMyForm : System.Windows.Forms.Form
{
    /// <summary>
    /// Create a thread
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void btnTest_Click(object sender, EventArgs e)
    {
        try
        {
            //Create and start the thread
           ThreadExample pThreadExample = new ThreadExample(this);
           pThreadExample.Start();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, Application.ProductName);
        }
    }

    /// <summary>
    /// Called from inside the thread 
    /// </summary>
    /// <param name="ex"></param>
    public void HandleError(Exception ex)
    {
        //Invoke a method in the GUI's main thread
        this.Invoke(new ThreadExample.delThreadSafeTriggerScript(HandleError), new Object[] { ex });
    }

    private void __HandleError(Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
} 
```

我的线程类的示例：

```
public class ThreadExample
{
    public delegate void delThreadSafeHandleException(System.Exception ex);

    private Thread thExample_m;

    frmMyForm pForm_m;
    private frmMyForm Form
    {
        get
        {
            return pForm_m;
        }
    }

    public ThreadExample(frmMyForm pForm)
    {
        pForm_m = pForm;

        thExample_m = new Thread(new ThreadStart(Main));
        thExample_m.Name = "Example Thread";
    }

    public void Start()
    {
        thExample_m.Start();
    }

    private void Main()
    {
        try
        {
            throw new Exception("Test");
        }
        catch (Exception ex)
        {
            Form.HandleException(ex);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-09T20:08:42.237

因此，从外观上看，您正在使用 Invoke 编组回 UI 线程 - 这正是您需要做的。为简单起见，我个人会使用 Action<Exception>，并且可能会使用 BeginInvoke 而不是 Invoke，但基本上你在做正确的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-20T21:20:02.577

请改用 .NET 框架中的 BackgroundWorker 类。这是在不同线程上执行 UI 工作的最佳实践。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T20:09:48.880

可能更好的方法是将委托传递给线程而不是对表单本身的引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T20:08:16.920

在线程之间抛出异常并不容易，也可能是不希望的。相反，您可以使用共享数据结构或变量传递异常，并使用 waitHandle 在第一个线程上等待。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-16T11:10:45.050

我完全同意 Dror。在正式的方式中，我们可以将此结构称为 FaultContract。从根本上说，当另一个线程中发生异常时，客户端线程此时几乎不能做任何事情，除了收集该信息并在它自己的读取中采取相应的行动。如果 thereads 在不同的 AppPool 中，那么序列化会更加复杂（这可以完全是一个单独的主题）。****