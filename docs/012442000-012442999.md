# StackOverflow 问答 12442000-12442999

# string - 将括号的子集映射到字符

> ID：12442615
> 
> 赞同：4
> 
> 时间：2012-09-15T21:09:17.773
> 
> 标签：string, scala, recursion, map

我正在尝试创建一个 Scala 方法，该方法将采用一组父括号，表示为字符串，然后将每个括号子组映射到不同的字母。然后它应该把它们放在它返回的地图中，所以基本上我这样调用以下方法：

```
val s = "((2((x+3)+6)))"
val map = mapParentheses(s) 
```

其中**s**可以包含任意数量的括号集，并且返回的 Map 应包含：

```
"(x+3)" -> 'a'

"(a+6)" -> 'b'

"(2b)" -> 'c'

"(c)" -> 'd' 
```

所以在我的程序的其他地方我可以回忆起**'d'**并得到**“（c）”**，它将变成**“（（2b））”**，然后**是（（2（a + 6）））**，最后是**（（2（（x + 3 )+6)))**。发送到方法*mapParentheses*的字符串永远不会有不匹配的括号，或者主父括号之外的额外字符，因此永远不会发送以下项目：

*   **"(fsf)a"**因为在`a`括号外
*   **“（a（aa））（a）”**因为`(a)`在父括号之外
*   **"((a)"**因为括号不匹配
*   **")a("**因为括号不匹配

所以我想知道是否有人知道创建此*mapParentheses*方法的简单（或不容易）方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T23:34:11.583

使用 Scala 的解析器组合器可以很容易地做到这一点。首先是导入和一些简单的数据结构：

```
import scala.collection.mutable.Queue
import scala.util.parsing.combinator._

sealed trait Block {
  def text: String
}

case class Stuff(text: String) extends Block

case class Paren(m: List[(String, Char)]) extends Block {
  val text = m.head._2.toString
  def toMap = m.map { case (k, v) => "(" + k + ")" -> v }.toMap
} 
```

即，块表示输入的子字符串，该子字符串要么是一些非括号内容，要么是括号。

现在对于解析器本身：

```
class ParenParser(fresh: Queue[Char]) extends RegexParsers {
  val stuff: Parser[Stuff] = "[^\\(\\)]+".r ^^ (Stuff(_))

  def paren: Parser[Paren] = ("(" ~> insides <~ ")") ^^ {
    case (s, m) => Paren((s -> fresh.dequeue) :: m)
  }

  def insides: Parser[(String, List[(String, Char)])] =
    rep1(paren | stuff) ^^ { blocks =>
      val s = blocks.flatMap(_.text)(collection.breakOut)
      val m = blocks.collect {
        case Paren(n) => n
      }.foldLeft(List.empty[(String, Char)])(_ ++ _)
      (s, m)
    }

  def parse(input: String) = this.parseAll(paren, input).get.toMap
} 
```

在最后一行中使用`get`非常不理想，但您断言我们可以期待格式良好的输入是合理的。

现在我们可以创建一个新的解析器并传入一个带有一些新变量的可变队列：

```
val parser = new ParenParser(Queue('a', 'b', 'c', 'd', 'e', 'f')) 
```

现在试试你的测试字符串：

```
scala> println(parser parse "((2((x+3)+6)))")
Map((c) -> d, (2b) -> c, (a+6) -> b, (x+3) -> a) 
```

如预期的。一个更有趣的练习（留给读者）是通过解析器线程化一些状态以避免可变队列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:21:52.483

经典的递归解析问题。保存不同的位可能很方便。稍后我们将添加一些实用方法来帮助我们。

```
trait Part {
  def text: String
  override def toString = text
}
class Text(val text: String) extends Part {}
class Parens(val contents: Seq[Part]) extends Part {
  val text = "(" + contents.mkString + ")"
  def mapText(m: Map[Parens, Char]) = {
    val inside = contents.collect{
      case p: Parens => m(p).toString
      case x => x.toString
    }
    "(" + inside.mkString + ")"
  }
  override def equals(a: Any) = a match {
    case p: Parens => text == p.text
    case _ => false
  }
  override def hashCode = text.hashCode
} 
```

现在你需要解析成这些东西：

```
def str2parens(s: String): (Parens, String) = {
  def fail = throw new Exception("Wait, you told me the input would be perfect.")
  if (s(0) != '(') fail
  def parts(s: String, found: Seq[Part] = Vector.empty): (Seq[Part], String) = {
    if (s(0)==')') (found,s)
    else if (s(0)=='(') {
      val (p,s2) = str2parens(s)
      parts(s2, found :+ p)
    }
    else {
      val (tx,s2) = s.span(c => c != '(' && c != ')')
      parts(s2, found :+ new Text(tx))
    }
  }
  val (inside, more) = parts(s.tail)
  if (more(0)!=')') fail
  (new Parens(inside), more.tail)
} 
```

现在我们已经解析了整个内容。所以让我们找到所有的位。

```
def findParens(p: Parens): Set[Parens] = {
  val inside = p.contents.collect{ case q: Parens => findParens(q) }
  inside.foldLeft(Set(p)){_ | _}
} 
```

现在我们可以构建您想要的地图。

```
def mapParentheses(s: String) = {
  val (p,_) = str2parens(s)
  val pmap = findParens(p).toSeq.sortBy(_.text.length).zipWithIndex.toMap
  val p2c = pmap.mapValues(i => ('a'+i).toChar)
  p2c.map{ case(p,c) => (p.mapText(p2c), c) }.toMap
} 
```

它有效的证据：

```
scala> val s = "((2((x+3)+6)))"
s: java.lang.String = ((2((x+3)+6)))

scala> val map = mapParentheses(s)
map: scala.collection.immutable.Map[java.lang.String,Char] =
  Map((x+3) -> a, (a+6) -> b, (2b) -> c, (c) -> d) 
```

我将把它作为练习留给读者来弄清楚它是如何工作的，并暗示递归是解析递归结构的一种非常强大的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T00:06:27.710

```
def parse(s: String, 
  c: Char = 'a', out: Map[Char, String] = Map() ): Option[Map[Char, String]] =
  """\([^\(\)]*\)""".r.findFirstIn(s) match {
    case Some(m) => parse(s.replace(m, c.toString), (c + 1).toChar , out + (c -> m))
    case None if s.length == 1 => Some(out)
    case _ => None
  } 
```

如果它解析，这会输出一个`Option`包含 a 的`Map`内容，这比不解析时抛出异常要好。我怀疑你真的想要一张从`Char`到 的地图`String`，所以这就是它的输出。`c`和`out`是默认参数，所以你不需要自己输入。正则表达式仅表示“任意数量的不是括号的字符，用括号括起来”（括号字符需要用“\”转义）。`findFirstIn`找到第一个匹配项并返回一个`Option[String]`，我们可以对其进行模式匹配，用相关字符替换该字符串。

```
val s = "((2((x+3)+6)))"
parse(s)  //Some(Map(a -> (x+3), b -> (a+6), c -> (2b), d -> (c)))
parse("(a(aa))(a)") //None 
```

# c# - 异步友好的 DispatcherTimer 包装器/子类

> ID：12442622
> 
> 赞同：5
> 
> 时间：2012-09-15T21:11:03.950
> 
> 标签：c#, wpf, asynchronous, .net-4.5, dispatchertimer

我的代码中有一个`DispatcherTimer`运行，每 30 秒触发一次以从服务器更新系统状态。即使我正在调试我的服务器代码，计时器也会在客户端触发，所以如果我已经调试了 5 分钟，我最终可能会在客户端出现十几个超时。最后决定我需要解决这个问题，所以希望制作一个更`async`/`await`友好的 DispatcherTimer。

*   运行的代码`DispatcherTimer`无论是否可重入都必须是可配置的（即，如果任务已经在运行，则不应尝试再次运行它）
*   应该是基于任务的（这是否需要我实际上在根处公开任务是一个灰色区域）
*   应该能够运行异步代码并`await`完成任务
*   是否包装或扩展 DispatcherTimer 可能并不重要，但如果您不知道如何使用它，包装它可能会稍微不那么含糊
*   `IsRunning`可能为 UI公开可绑定属性

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-15T21:28:07.870

这就是我想出的。

*   `SmartDispatcherTimer`扩展`DispatcherTimer`（这是启动和运行它的最简单方法）
*   有一个`TickTask`属性来提供一个`Task`处理逻辑
*   有一个`IsReentrant`属性（当然，重点是我希望它不能重入，所以通常这是错误的）
*   它假定您调用的任何内容都是完全可等待的 - 否则您最终将失去重入保护权益

用法：

```
 var timer = new SmartDispatcherTimer();
        timer.IsReentrant = false;
        timer.Interval = TimeSpan.FromSeconds(30);
        timer.TickTask = async () =>
        {
            StatusMessage = "Updating...";  // MVVM property
            await UpdateSystemStatus(false);
            StatusMessage = "Updated at " + DateTime.Now;
        };
        timer.Start(); 
```

这是代码。很想听听对此的任何想法

```
public class SmartDispatcherTimer : DispatcherTimer
{
    public SmartDispatcherTimer()
    {
        base.Tick += SmartDispatcherTimer_Tick;
    }

    async void SmartDispatcherTimer_Tick(object sender, EventArgs e)
    {
        if (TickTask == null)
        {
            Debug.WriteLine("No task set!");
            return;
        }

        if (IsRunning && !IsReentrant)
        {
            // previous task hasn't completed
            Debug.WriteLine("Task already running");
            return;
        }

        try
        {
            // we're running it now
            IsRunning = true;

            Debug.WriteLine("Running Task");
            await TickTask.Invoke();
            Debug.WriteLine("Task Completed");
        }
        catch (Exception)
        {
            Debug.WriteLine("Task Failed");
        }
        finally
        {
            // allow it to run again
            IsRunning = false;
        }
    }

    public bool IsReentrant { get; set; }
    public bool IsRunning { get; private set; }

    public Func<Task> TickTask { get; set; }
} 
```

# regex - 正则表达式匹配 perl 变量

> ID：12442623
> 
> 赞同：2
> 
> 时间：2012-09-15T21:11:14.150
> 
> 标签：regex, perl, variables

我目前正在学习正则表达式，并且正在尝试创建一个正则表达式来匹配 Perl 中的任何合法变量名。

**这是我到目前为止写的：**

```
^\$[A-Za-z_][a-zA-Z0-9_]* 
```

唯一的问题是正则表达式对特殊符号返回 true，例如字符串***$a&***将返回 true。

我做错了什么？

谢谢！罗腾

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-15T21:30:06.200

解析 Perl 很困难，关于什么是变量和什么不是变量的规则也很复杂。如果您尝试解析 Perl，请考虑改用[PPI](https://metacpan.org/module/PPI)。它可以解析 Perl 程序并执行诸如查找所有变量之类的操作。PPI 是[perlcritic](https://metacpan.org/module/perlcritic)用来完成工作的。

如果你想尝试去做，这里有一些边缘情况需要考虑......

```
$^F
$/
${^ENCODING}
$1
$élite           # with utf8 on
${foo}
*{foo} = \42;
*{$name} = \42;  # with strict off
${$name} = 42;   # with strict off 
```

当然还有其他的印记`@%*`。并检测是否在单引号字符串中。这是我强烈鼓励您使用 PPI 而不是自己尝试的方式。

如果您想练习，实际的练习是将变量从更大的字符串中提取出来，而不是进行精确匹配。

```
# Match the various sigils.
my $sigils         = qr{ [\$\@\%*] }x;

# Match $1 and @1 and so on
my $digit_var      = qr{ $sigils \d+ }x;

# Match normal variables
my $named_var      = qr{ $sigils [\w^0-9] \w* }x;

# Combine all the various variable matches
my $match_variable = qr{ ( $named_var | $digit_var ) }x; 
```

这使用`()`捕获操作符来抓取变量。它还使用`/x`修饰符使正则表达式更易于阅读，并使用替代分隔符来避免[倾斜牙签综合症](http://en.wikipedia.org/wiki/Leaning_toothpick_syndrome)。使用`\w`而不是确保在[utf8](https://metacpan.org/module/utf8)`A-Z`开启时会拾取 Unicode 字符，而在关闭时不会。最后，用于分段构建正则表达式。填补空白留作练习。`qr`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T21:15:19.000

最后你需要 a `$`，否则它只是尽可能匹配并忽略其余部分。所以应该是：

```
^\$[A-Za-z_][A-Za-z0-9]*$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-09T00:33:48.547

我需要解决这个问题来创建一个简单的源代码分析器。
此子例程从代码的输入部分提取 Perl 用户变量

```
sub extractVars {
    my $line = shift;
    chomp $line;
    $line =~ s/#.*//;       # Remove comments
    $line =~ s/\s*;\s*$//;  # Remove trailing ;
    my @vars = ();
    my $match = 'junk';
    while ($match ne '') {
        push @vars, $match if $match ne 'junk';
        $match = ''; 
        if ($line =~ s/(
                [\@\$\%]            # $@%
                {?                  # optional brace
                \$?                 # optional $
                [\w^0-9]            # begin var name
                [\w\-\>\${}\[\]'"]* # var name
                [\w}\]]             # end var name
                |
                [\@\$\%]            # $@%
                {?                  # optional brace
                \$?                 # optional $
                [\w^0-9]            # one letter var name
                [}\]]?              # optional brace or bracket
                )//x) {
            $match = $1;
            next;
        }
    }
    return @vars;
} 
```

使用以下代码对其进行测试：

`my @variables = extractVars('$a $a{b} $a[c] $scalar @list %hash $list[0][1] $list[-1] $hash{foo}{bar} $aref->{foo} $href->{foo}->{bar} @$aref %$hash_ref %{$aref->{foo}} $hash{\'foo\'} "$a" "$var{abc}"');`

如果变量名包含空格，则它不起作用，例如：

*   `$hash{"baz qux"}`
*   `${ $var->{foo} }[0]`

# postgresql - PostgreSQL - 删除名称中带有正斜杠的数据库

> ID：12442625
> 
> 赞同：2
> 
> 时间：2012-09-15T21:11:21.277
> 
> 标签：postgresql

在我的 Ruby-on-Rails`database.yml`文件中，我不小心创建了一个名称中带有正斜杠 ( `/`) 的 PostgreSQL 数据库。

我无法通过 psql 命令删除此数据库，尝试使用各种转义序列。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-15T21:15:07.747

用引号将您的数据库名称括起来：

```
DROP DATABASE "database/withslash"; 
```

从[标识符和关键字](http://www.postgresql.org/docs/9.2/static/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)文档中：

> 还有第二种标识符：分隔标识符或引用标识符。它是通过将任意字符序列括在双引号 (") 中而形成的。分隔标识符始终是标识符，而不是关键字。因此“select”可用于引用名为“select”的列或表，而不带引号的选择将被视为关键字，因此在需要表名或列名的地方使用时会引发解析错误。示例可以使用带引号的标识符编写，如下所示：
> 
> ```
> UPDATE "my_table" SET "a" = 5; 
> ```
> 
> 带引号的标识符可以包含任何字符，但代码为零的字符除外。

请注意，带引号的标识符区分大小写。

但是，您不能在连接*到*该数据库时删除数据库，因此您可能想使用命令行[`dropdb`命令](http://www.postgresql.org/docs/8.2/static/app-dropdb.html)。你的 shell 会解析引号，所以你想转义引号：

```
dropdb \"database/withslash\" 
```

# c# - 在 XNA 中重用游戏对象有什么意义吗？

> ID：12442630
> 
> 赞同：1
> 
> 时间：2012-09-15T21:12:08.500
> 
> 标签：c#, object, xna, reusability

人们经常说我应该在一般情况下重用短期对象，但我不知道 XNA 就是这种情况。有物品、粒子和 NPC 是最常见的游戏对象，它们应该在某种池中重复使用还是从更新列表中删除并替换为新实例？这对性能有影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T23:21:01.310

以我的经验，这取决于它是否是一个 xbox 360 项目。如今，Xbox 360 将无法像通常的 PC 那样处理。当垃圾收集开始时尤其如此。

[http://zfs.fzi.de/attachments/article/160/XNA_Optimization.pdf](http://zfs.fzi.de/attachments/article/160/XNA_Optimization.pdf)

请注意，此 pdf 中的第一个“要考虑的事情”是 xbox 360 垃圾收集。xbox 360 垃圾收集时间将随着每个对象的创建而线性增加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:16:24.133

在特定情况下，池化非常重要。也就是说，在您需要大量创建和处理常见对象（如子弹或体素实例）的情况下，它几乎总是有益的。

垃圾收集器很好，但它并不总是你的朋友。如果你像我一样构建一个使用数千个立方体来渲染地形和物体的游戏，你会很快注意到这一点（尽管我们花了几个星期才意识到确实是 GC 导致了我们的减速）。作为托管语言的程序员，我们习惯于简单地取消引用一个对象并让它被 GC 神奇地扫走。但事实是，当这些对象达到数千个时，GC 会超时工作。您会注意到每分钟左右都会显着放缓，具体取决于。

因此，与其不断地实例化和取消引用您的公共对象，不如使用静态的、大小稳定的对象池对 GC 造成的压力要小得多。

*   静态：所有对象都被一次实例化，并且在运行时不会被取消引用以被 GC 拾取
*   稳定大小：池中对象实例的数量不会经常变化（防止实例化性能下降）

这一切背后的原因是，在基本意义上，GC 必须在您之后清理您在游戏期间取消引用的每个对象中包含的所有引用。因此，如果您的块引用了相邻块，则必须检查它是否是对另一个块的唯一引用，因为如果是这样，那么另一个块现在也被代理取消引用（再次，非常简单的观点，但这是我学到的）。

通过创建一个池并简单地重用实例而不是丢弃它们，当您处理完其中一个对象时，您永远不会从 GC 触发此行为，因此您不必担心它会对数千或数百个对象进行大量检查随意创建和销毁对象。

我想说，基本上，你会知道什么时候需要汇集。您会定期遇到无法解释的减速，这似乎与您在游戏中执行的操作无关。这是 GC 在幕后为你做的清理工作。

# arrays - 将数组和结构传递给 C 函数

> ID：12442632
> 
> 赞同：3
> 
> 时间：2012-09-15T21:12:27.737
> 
> 标签：arrays, function, structure, memory-address

我想知道为什么我们可以通过值将结构传递给 C 函数，但我们不能对数组（通过地址传递）做同样的事情。

当我学习 C 时，他们告诉我数组会消耗很多堆栈，因此不建议按值传递它们。

但似乎结构通常（如果不总是）大于数组并且是更复杂的数据结构，所以这种解释现在对我来说毫无意义！

任何人都可以提供尽可能多的细节吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T21:25:27.373

在 C 中，数组总是被定义为指向数组第一个位置的指针，因此根据定义，当您将数组传递给函数时，您正在传递它的内存地址，因此是它的引用。

当您定义 struct 类型的变量时，您将分配包含该结构所需的所有内存空间，并且如果您执行以下操作：

```
struct a, b;
...
a = b; 
```

您正在将所有值从 b 复制到 a，同样，当您将其传递给函数时，您正在将原始结构的值复制到堆栈中。这称为按值传递参数。

你在问题中所说的是真的。struct 可能比数组更复杂，但完全可以将其作为值传递，并且可能效率低下，但不能按值传递数组的原因是因为它默认定义为指针。

# c# - 如何以“名称”格式解析字符串 "

> ID：12442635
> 
> 赞同：5
> 
> 时间：2012-09-15T21:12:50.703
> 
> 标签：c#, string, parsing

我有一种方法可以接收以下格式之一的联系人：

1 - “email@domain.com”

2 - “名称<email@domain.com>”或“名称<email@domain.com>”（可以存在空格）

如果是格式 (1)，我什么也不做。在 (2) 的情况下，我需要解析名称和电子邮件。

我永远不知道我会以哪种格式收到电子邮件。但这将是两者之一。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-15T22:33:50.290

实际上已经有一个名为[MailAddress](http://msdn.microsoft.com/en-us/library/system.net.mail.mailaddress.aspx)的 .NET 类可以非常简单地为您完成此任务。
**更新：它不仅可以获取显示名称，还可以获取电子邮件地址、用户名和主机。**

首先包括`using System.Net.Mail`，然后您可以通过以下方式获取信息：

```
MailAddress email = new MailAddress("Johnny <johnny@example.com>");
string displayName = email.DisplayName;
string address = email.Address;
string user = email.User;
string host = email.Host; 
```

`"Name <email@domain.com>"`这将适用于您所描述的两种情况，并且`"Name<email@domain.com>"`都可以为您提供`Name`. 我继续创建了一个可以在[此处](http://ideone.com/5IHkG)找到的测试，它将为您提供以下示例输出：

```
'email@domain.com' =
   DisplayName = ''
   Address = 'email@domain.com'
   User = 'email'
   Host = 'domain.com'
'Name<email@domain.com>' =
   DisplayName = 'Name'
   Address = 'email@domain.com'
   User = 'email'
   Host = 'domain.com'
'Name <email@domain.com>' =
   DisplayName = 'Name'
   Address = 'email@domain.com'
   User = 'email'
   Host = 'domain.com' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-14T00:18:18.063

`MailAddress`是一个很好的解决方案，但遗憾的`System.Net.Mail`是尚未移植到 .NET Core。

我发现以下正则表达式解决方案适用于格式合理的输入：

```
var re = new Regex(@"""?((?<name>.*?)""?\s*<)?(?<email>[^>]*)");
var match = re.match(input);

var name = match.Groups["name"].Value;
var email = match.Groups["email"].Value; 
```

我已经使用以下类型的输入对此进行了测试：

```
bob@example.com
<bob@example.com>
Bob Example <bob@example.com>
Bob Example<bob@example.com>
"Bob Example" <bob@example.com>
"Example, Bob J." <bob@example.com> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T21:18:16.743

有几种方法可以做到这一点，但发生的第一个是

```
String[] parts = someValue.Trim().Split(new char[] {' '},false);

if (parts.Length > 1) then
{
// in format "Name OR Name" or more correctly not in format someone@domain.com
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-15T21:59:09.830

您可以设计一个简单的正则表达式（在我看来，在这种情况下，这将是一个优雅的解决方案）或调用`Split()`with`'<'`作为分隔符，`Trim()`第一个字符串并`'>'`从第二个字符串中删除关闭。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-15T22:02:59.630

您可以使用正则表达式：

```
 var str = "Name<email@domain.com>";

        var r = new Regex("(?<name>.*?)<(?<email>.*?)>");

        if(r.IsMatch(str))
        {
            var m = r.Match(str);
            Console.WriteLine(m.Groups["name"].Trim());
            Console.WriteLine(m.Groups["email"]);
        } 
```

在这里，我假设您不需要验证电子邮件格式并且名称没有 < 或 > 字符

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-15T22:12:27.960

你可以使用正则表达式。

```
^((.*?)\s*?<)(.*?)>?$ 
```

名称（如果可用）将在第二个捕获组中，而电子邮件将在第三个中。

例子：

```
var match = Regex.Match("Name <email@domain.com>", @"^((.*?)\s*?<)(.*?)>?$");
string name = math.Groups[2].Value;
string email = match.Groups[3].Value; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-30T14:11:56.987

MimeKit[有一个方法](http://www.mimekit.net/docs/html/M_MimeKit_MailboxAddress_Parse_7.htm)：

```
MailboxAddress addr = MailboxAddress.Parse("Mr. Curious <mrcurious@example.com>"); 
```

它也适用于 .NET、Mono 和 .NET Core。

# mysql - mysql - 您不能在 FROM 子句中指定要更新的目标表（我的查询有效，但不是等效更新）

> ID：12442639
> 
> 赞同：3
> 
> 时间：2012-09-15T21:13:25.290
> 
> 标签：mysql, mysql-error-1093

我已经看到有关此特定错误消息的几个问题，但找不到与我的问题匹配的任何问题。

只是对我的问题的快速解释。

我有一张包含一些游戏结果的表格。

当有人缺席时，我们将这个人在之前游戏中的平均值存储为游戏结果，并将属性 f_present 设置为 0。

对于那部分没有问题。

当我们修改旧游戏时会出现问题，我必须更新以下所有有人缺席的游戏以存储新值（该玩家缺席的游戏的新平均值。）

我可以进行查询，但由于“您无法在 FROM 表中指定要更新的目标表”错误消息，我无法进行更新。

这是我的查询（有效）

```
 select t1.f_subgame_id,
    t1.F_PLAYER_ID, 
    (SELECT avg(t2.f_result) 
     from t_subgames_results t2 
     join t_subgames t2s on t2s.f_subgame_id = t2.f_subgame_id
     join t_seasons_games t2ss on t2ss.f_game_id = t2s.f_game_id
     where F_RESULT > -1 
       and F_PLAYER_ID = t1.F_PLAYER_ID
       and t2ss.F_SEASON_ID = t1ss.F_SEASON_ID
       and t2ss.F_DATE < t1ss.F_DATE
     )
    from t_subgames_results t1
    join t_subgames t1s on t1s.f_subgame_id = t1.f_subgame_id
    join t_seasons_games t1ss on t1ss.f_game_id = t1s.f_game_id
    where t1ss.f_date>'2012-09-07' and t1.F_PRESENT = 0; 
```

这是我的更新尝试：

```
 update t_subgames_results t1
   join t_subgames t1s on t1s.f_subgame_id = t1.f_subgame_id
   join t_seasons_games t1ss on t1ss.f_game_id = t1s.f_game_id
   set f_result = 
    (SELECT avg(t2.f_result) as result
     from t_subgames_results t2 
     join t_subgames t2s on t2s.f_subgame_id = t2.f_subgame_id
     join t_seasons_games t2ss on t2ss.f_game_id = t2s.f_game_id
     where F_RESULT > -1 
       and F_PLAYER_ID = t1.F_PLAYER_ID
       and t2ss.F_SEASON_ID = t1ss.F_SEASON_ID
       and t2ss.F_DATE < t1ss.F_DATE
     )
   where t1ss.f_date>'2012-09-07' and t1.F_PRESENT = 0; 
```

同样，我知道有几个关于这个问题的话题，但似乎找不到与我的问题相关的话题......

再次感谢您帮助我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T22:58:37.250

我最终解决了这个问题，非常感谢！

```
create temporary table t_results_temp SELECT * from t_subgames_results;

update t_subgames_results t1
join t_subgames t1s on t1s.f_subgame_id = t1.f_subgame_id
join t_seasons_games t1ss on t1ss.f_game_id = t1s.f_game_id
set f_result = 
(SELECT COALESCE(avg(t2.f_result),0) as result
 from t_results_temp t2 
 join t_subgames t2s on t2s.f_subgame_id = t2.f_subgame_id
 join t_seasons_games t2ss on t2ss.f_game_id = t2s.f_game_id
 where t2.F_RESULT > -1 
   and F_PLAYER_ID = t1.F_PLAYER_ID
   and t2ss.F_SEASON_ID = t1ss.F_SEASON_ID
   and t2ss.F_DATE < t1ss.F_DATE
 )
where t1ss.f_date>'2012-09-07' and t1.F_PRESENT = 0;

drop table t_results_temp; 
```

# vb.net - vb.net 通过 TCP 发送文件

> ID：12442641
> 
> 赞同：1
> 
> 时间：2012-09-15T21:13:59.017
> 
> 标签：vb.net, tcp

我知道在各种论坛上都问过类似的问题，但是没有一个给定的解决方案对我有用，并且想知道是否有人可以提供任何其他指示。我基本上是在尝试通过 TCP 在同一网络上的两台计算机之间发送文件（图像）。我一直在尝试将图像转换为字节数组，然后在发送字符串之前转换为字符串。另一方面，我收到了字符串，转换为字节数组，然后再转换回图像。但是，在接收端，字符串为空，因此当我将其转换为字节数组时出现错误。

发送方的代码是：

```
Private Sub startSending()
    Dim ScreenShot As Image = sc.CaptureScreen
    Dim path As String = My.Computer.FileSystem.SpecialDirectories.CurrentUserApplicationData + "\redsquirimgtest"
    sc.CaptureScreenToFile(path, System.Drawing.Imaging.ImageFormat.Jpeg)
    MsgBox("printscreen saved")

    Dim abyt() As Byte = ConvertImageFiletoBytes(path)
    MsgBox("image converted to byte array")

    Dim str As String = byteArrToString(abyt)
    MsgBox(str)

    client.Connect("192.168.1.10", 55000)
    Dim Writer As New StreamWriter(client.GetStream())
    Writer.Write(str)
    Writer.Flush()

    MsgBox("sent")

    Form2.PictureBox1.Image = ScreenShot
    Form2.Show()

    MsgBox("done")
End Sub

Public Function ConvertImageFiletoBytes(ByVal ImageFilePath As String) As Byte()
    Dim _tempByte() As Byte = Nothing
    If String.IsNullOrEmpty(ImageFilePath) = True Then
        Throw New ArgumentNullException("Image File Name Cannot be Null or Empty", "ImageFilePath")
        Return Nothing
    End If
    Try
        Dim _fileInfo As New IO.FileInfo(ImageFilePath)
        Dim _NumBytes As Long = _fileInfo.Length
        Dim _FStream As New IO.FileStream(ImageFilePath, IO.FileMode.Open, IO.FileAccess.Read)
        Dim _BinaryReader As New IO.BinaryReader(_FStream)
        _tempByte = _BinaryReader.ReadBytes(Convert.ToInt32(_NumBytes))
        _fileInfo = Nothing
        _NumBytes = 0
        _FStream.Close()
        _FStream.Dispose()
        _BinaryReader.Close()
        Return _tempByte
    Catch ex As Exception
        Return Nothing
    End Try
End Function

Public Function byteArrToString(ByVal arr() As Byte) As String

    Return System.Text.Encoding.Unicode.GetString(arr)

End Function 
```

然后是接收方：

```
Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
    ' Check the TcpListner Pending Property 
    If TcpListener.Pending = True Then

        Dim Message As String = ""
        ConnectClient = TcpListener.AcceptTcpClient()
        MsgBox("accepting")

        Dim Reader As New StreamReader(ConnectClient.GetStream())
        While Reader.Peek > -1
            Message = Message + Reader.Read().ToString
        End While
        MsgBox(Message)

        Dim abyt() As Byte = StrToByteArray(Message)
        MsgBox("string converted to byte array")

        Dim img As Image = ConvertBytesToImageFile(abyt)
        MsgBox("byte array converted to image")

        PictureBox1.Image = img
        MsgBox("picture loaded in form")
    End If

End Sub

Private Sub Form1_Load(sender As Object, e As EventArgs) Handles Me.Load
    TcpListener.Start()
End Sub

Public Function ConvertBytesToImageFile(ByVal ImageData As Byte()) As Image

    Dim myImage As Image
    Dim ms As System.IO.Stream = New System.IO.MemoryStream(ImageData)
    myImage = System.Drawing.Image.FromStream(ms)
    Return myImage

End Function

Public Shared Function StrToByteArray(str As String) As Byte()

    Return System.Text.Encoding.Unicode.GetBytes(str)

End Function 
```

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T19:34:59.843

不确定这里是否必然存在问题，但我建议使用 System.Convert.ToBase64String(byte_array) 将字节转换为字符串，这将始终提供一个安全的字符串，没有可以以各种方式传输的尴尬字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-04T13:14:46.727

```
Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
    ' Check the TcpListner Pending Property 
    If TcpListener.Pending = True Then

        Dim Message As String = ""
        ConnectClient = TcpListener.AcceptTcpClient()
        MsgBox("accepting")

        Dim Reader As New StreamReader(ConnectClient.GetStream())
        While Reader.Peek > -1
            Message = Message + Reader.Read().ToString
        End While
        MsgBox(Message)

        Dim abyt() As Byte = StrToByteArray(Message)
        MsgBox("string converted to byte array")

        Dim img As Image = ConvertBytesToImageFile(abyt)
        MsgBox("byte array converted to image")

        PictureBox1.Image = img
        MsgBox("picture loaded in form")
    End If

End Sub

Private Sub Form1_Load(sender As Object, e As EventArgs) Handles Me.Load
    TcpListener.Start()
End Sub

Public Function ConvertBytesToImageFile(ByVal ImageData As Byte()) As Image

    Dim myImage As Image
    Dim ms As System.IO.Stream = New System.IO.MemoryStream(ImageData)
    myImage = System.Drawing.Image.FromStream(ms)
    Return myImage

End Function

Public Shared Function StrToByteArray(str As String) As Byte()

    Return System.Text.Encoding.Unicode.GetBytes(str)

End Function
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-29T19:58:19.620

sc.CaptureScreen sc.CaptureScreenToFile（路径，System.Drawing.Imaging.ImageFormat.Jpeg）

sc。<-- ist nicht deklariert 错误

# jquery - “查找父母”和 if 语句的更好方法

> ID：12442644
> 
> 赞同：4
> 
> 时间：2012-09-15T21:14:12.193
> 
> 标签：jquery

我不知道为什么这不起作用：

```
$(document).ready(function() {
    if ($('.checkarea.unchecked').length) {
       $(this).parent().parent().parent().parent().parent().parent().parent().removeClass('checked').addClass('unchecked');
}
else {
    $(this).parent().parent().parent().parent().parent().parent().parent().removeClass('unchecked').addClass('checked');
}
}); 
```

这是 HTML 结构的屏幕截图：http: [//cloud.lukeabell.com/JV9N](http://cloud.lukeabell.com/JV9N)（更新为正确的屏幕截图）

此外，必须有一种更好的方法来查找项目的父项（页面上有多个这些元素，所以我需要它只影响未选中的元素）

这是涉及的其他一些可能很重要的代码：

```
$('.toggle-open-area').click(function() {
        if($(this).parent().parent().parent().parent().parent().parent().parent().hasClass('open')) {
              $(this).parent().parent().parent().parent().parent().parent().parent().removeClass('open').addClass('closed');
          }
          else {
              $(this).parent().parent().parent().parent().parent().parent().parent().removeClass('closed').addClass('open');
          }
    });

    $('.checkarea').click(function() {
        if($(this).hasClass('unchecked')) {
              $(this).removeClass('unchecked').addClass('checked');
              $(this).parent().parent().parent().parent().parent().parent().parent().removeClass('open').addClass('closed');
          }
          else {
              $(this).removeClass('checked').addClass('unchecked');
              $(this).parent().parent().parent().parent().parent().parent().parent().removeClass('closed').addClass('open');
          }
    }); 
```

（对该部分的改进也非常开放）

非常感谢！

这是发生这一切的链接：http: [//linkedin.guidemytech.com/sign-up-for-linkedin-step-2-set-up-linkedin-student/](http://linkedin.guidemytech.com/sign-up-for-linkedin-step-2-set-up-linkedin-student/)

* * *

## 更新：

我已经从评论中改进了代码，但仍然存在第一部分无法正常工作的问题。

```
$(document).ready(function() {
if ($('.checkarea.unchecked').length) {
    $(this).parents('.whole-step').removeClass('checked').addClass('unchecked');
}
else {
    $(this).parents('.whole-step').removeClass('unchecked').addClass('checked');
}
}); 
```

--

```
 $('.toggle-open-area').click(function() {
        if($(this).parents('.whole-step').hasClass('open')) {
              $(this).parents('.whole-step').removeClass('open').addClass('closed');
          }
          else {
              $(this).parents('.whole-step').removeClass('closed').addClass('open');
          }
    });

    $('.toggle-open-area').click(function() {
        $(this).toggleClass('unchecked checked');
        $(this).closest(selector).toggleClass('open closed');
    });

    $('.checkarea').click(function() {
        if($(this).hasClass('unchecked')) {
              $(this).removeClass('unchecked').addClass('checked');
              $(this).parents('.whole-step').removeClass('open').addClass('closed');
          }
          else {
              $(this).removeClass('checked').addClass('unchecked');
              $(this).parents('.whole-step').removeClass('closed').addClass('open');
          }
    }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-15T21:17:43.577

*哇*，你可以使用[`closest`](http://api.jquery.com/closest/)或[`parents()`](http://api.jquery.com/parents/)方法。

> `closest( selector )`获取与选择器匹配的第一个元素，从当前元素开始，向上遍历 DOM 树。
> 
> `parents( [selector] )`获取当前匹配元素集中每个元素的祖先，可选地由选择器过滤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T21:21:51.160

我建议：

```
$('.toggle-open-area').click(function() {
    $(this).toggleClass('unchecked checked');
    $(this).closest(appropriateSelector).toggleClass('open closed');
}); 
```

顺便说一句，我无法提供一个*实际*的选择器来代替，`appropriateSelector`因为您发布的图片¹没有（似乎）包含该特定元素。

参考：

*   [`closest()`](http://api.jquery.com/closest/).
*   [`toggleClass()`](http://api.jquery.com/toggleClass/).

* * *

**1.**你意识到你可以在问题中包含实际的标记吗？这种方式更方便，并且更容易使用（创建演示，纠正错别字，在外部站点崩溃、死亡或重新组织其内容的情况下保持有用性......）。

# expression-web - 表达式 Web 4 SP2 错误

> ID：12442654
> 
> 赞同：0
> 
> 时间：2012-09-15T21:15:52.353
> 
> 标签：expression-web, microsoft-expression-web

我在**MS Expression Web 4 SP2**中有这个烦人的错误，奇怪的 GUI 怪癖：你可以在图片中看到：就像显示器的某些部分没有被绘制。我以前也有这个，通过卸载一些东西解决了，但问题是我不记得它是什么......（我在新的Win7 PC上安装了Exp.Web，并逐步安装所有东西，直到出现这个问题向上。）

有人遇到过这个问题吗？

![MS 表达式 Web 4 SP2 错误](../Images/b95d86440aff5e879a435a98c42df52b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T15:39:23.940

问题是一个名为[FileBox eXtender](http://www.hyperionics.com/files/index.asp)的程序。这是我用来固定窗口以使其始终位于顶部（永远不会被其他窗口隐藏）的出色程序，因为它可以完成工作并且是免费的。不幸的是，MS-Expression（Web、Blend 等）无法与之相处，所以我将它排除在外（在 FileBox-eXtender 的选项中），现在没关系

# subquery - 如何在 Firebird 中优化 DELETE .. NOT IN .. SUBQUERY

> ID：12442659
> 
> 赞同：7
> 
> 时间：2012-09-15T21:16:43.600
> 
> 标签：subquery, firebird, sql-delete

我有这种删除查询：

```
DELETE 
FROM SLAVE_TABLE
WHERE ITEM_ID NOT IN (SELECT ITEM_ID FROM MASTER_TABLE) 
```

有没有办法优化这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T08:00:16.703

`(NOT) IN`通常可以通过使用`(NOT) EXISTS`来优化。

```
DELETE 
FROM SLAVE_TABLE
WHERE NOT EXISTS (SELECT 1 FROM MASTER_TABLE M WHERE M.ITEM_ID = ITEM_ID) 
```

我不确定你在这里要做什么，但对我来说，这个查询表明你应该使用外键来强制执行这些约束，而不是运行查询来清理之后的混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T08:22:35.223

您可以使用 EXECUTE BLOCK 顺序扫描明细表并删除没有匹配主记录的记录。

```
EXECUTE BLOCK
AS
  DECLARE VARIABLE C CURSOR FOR
    (SELECT d.id
     FROM detail d LEFT JOIN master m
       ON d.master_id = m.id
     WHERE m.id IS NULL);
  DECLARE VARIABLE I INTEGER;
BEGIN
  OPEN C;
  WHILE (1 = 1) DO
  BEGIN
    FETCH C INTO :I;
    IF(ROW_COUNT = 0)THEN
      LEAVE;
    DELETE FROM detail WHERE id = :I;
  END
  CLOSE C;
END 
```

# android - 如何在 Android Emulator 上运行新的 Chrome for Android 4？

> ID：12442667
> 
> 赞同：8
> 
> 时间：2012-09-15T21:18:14.817
> 
> 标签：android, google-chrome, android-emulator, google-play, chrome-for-android

我希望能够测试我在新的 Chrome for Android 中开发的基于 Web 的应用程序。我确实安装了 Chrome Beta apk，但每次我尝试在地址栏中输入 URL 时，浏览器都会崩溃并显示“不幸的是 Chrome 已停止运行”。

我没有智能手机，但我需要测试，因为我的客户将使用运行 Android 4+ 的设备

我在 OSX Lion 10.7.4 上运行 Android 模拟器。我的模拟器规格：

```
Model #: sdk
Android version: 4.1.1
Kernel version: 2.6.29-gc497e41
Build #: sdk-eng 4.1.1 JRO03E 403059 test-keys 
```

显然，获得新 Chrome 的唯一方法是通过 Google Play 应用程序，它不是模拟器附带的默认应用程序，所以我按照这篇文章的说明安装并运行了 Google Play 应用程序：[Google Play在 Android 4.0 模拟器上](https://stackoverflow.com/questions/11154222/google-play-in-android-4-0-emulator)

我必须从 Play 商店应用程序中搜索 Chrome。找到后，它说与我的设备不兼容，并且没有下载按钮。

[来自 Play 网站的有关 Android 版 Chrome 浏览器的](https://play.google.com/store/apps/details?id=com.android.chrome&hl=en)信息：

```
CURRENT VERSION:
18.0.1025308
REQUIRES ANDROID:
4.0 and up 
```

无论如何要让最新的 Chrome 在我的模拟器上运行？Android Emulator 开发人员何时能够在新发布的 Chrome for Android 中进行测试和开发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T22:16:57.367

**deejoy**在[http://blog.apkudo.com/2012/08/08/run-google-play-on-an-emulator-and-pretend-to-be-any-device/](http://blog.apkudo.com/2012/08/08/run-google-play-on-an-emulator-and-pretend-to-be-any-device/)的回应

...我确实设法在我的模拟器上下载并安装了最新的 chrome。但是，当我在模拟器上运行 Chrome 时，遇到以下错误：

```
[ERROR:context_group.cc(83)] ContextGroup::Initialize failed 
because too few vertex attributes supported. 
```

那么，这意味着什么？长话短说，我的模拟器（即使有 OpenGL 加速）不支持运行 Chrome 所需的顶点属性数量。您可以在这里查看 Chrome 的源代码：[http ://code.google.com/p/chromium/source/search?q=context_group.cc&origq=context_group.cc&btnG=Search+Trunk](http://code.google.com/p/chromium/source/search?q=context_group.cc&origq=context_group.cc&btnG=Search+Trunk)

在 context_group.cc 的某个地方（不一定是第 83 行），您会看到对可用顶点属性数量和有问题的错误消息的显式检查。据我所知，您无能为力（如果有的话）来克服这个错误。

# checkbox - 维克斯。选中复选框时运行自定义操作

> ID：12442670
> 
> 赞同：2
> 
> 时间：2012-09-15T21:18:22.210
> 
> 标签：checkbox, wix, custom-action

我在那里写了两个文件 Product.wxc

```
<Property Id="CheckBoxProp"> 
```

和自定义操作

```
<InstallExecuteSequence>
      <Custom Action="MyCustomAction" After="InstallInitialize">
        CheckBoxProp=1 
      </Custom>
</InstallExecuteSequence> 
```

在另一个文件 MyCheckBoxDlg.wxc 中，我在那里写了 UI 对话框，我描述了复选框

```
<Control Type="CheckBox" Id="MyCheckBoxID" Width="125" Height="26" X="26" Y="124" Text="My text" Property="CheckBoxProp" CheckBoxValue="1" /> 
```

我在另一个文件中编写的所有发布，其中我有一个 DialogRef 到 MyCheckBoxDlg

当我开始安装时，customaction 没有看到 CheckBoxProp 值的变化。

请帮忙！我等待你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T00:29:06.180

CheckBoxProp 是私有而不是安全（公共）属性。将其更改为 CHECKBOXPROP 并使用 Secure 属性将其列在[SecureCustomProperties 属性](http://msdn.microsoft.com/en-us/library/windows/desktop/aa371571%28v=vs.85%29.aspx)中。

# haskell - Haskell 中的闭包是如何工作的？

> ID：12442671
> 
> 赞同：9
> 
> 时间：2012-09-15T21:18:32.303
> 
> 标签：haskell

我正在阅读 Haskell 背后的数学基础——我已经了解了如何使用闭包来保存函数中的状态。

我想知道 Haskell 是否允许闭包，以及它们是如何工作的，因为它们不是纯函数？

如果一个函数修改了它的关闭状态，它将能够在相同的输入上给出不同的输出。

这在 Haskell 中怎么不是问题？是因为在最初为变量赋值后无法重新分配变量吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-16T00:30:36.843

你实际上可以在 Haskell 中模拟闭包，但不是你想象的那样。首先，我将定义一个闭包类型：

```
data Closure i o = Respond (i -> (o, Closure i o )) 
```

这定义了一个类型，在每个“步骤”中都采用一个 type 的值，`i`用于计算 type 的响应`o`。

所以，让我们定义一个“闭包”，它接受空输入和整数回答，即：

```
incrementer :: Closure () Int 
```

这个闭包的行为会因请求而异。我将保持简单并使其以 0 响应第一个响应，然后为每个连续的请求增加其响应：

```
incrementer = go 0 where
    go n = Respond $ \() -> (n, go (n + 1)) 
```

然后我们可以重复查询闭包，这会产生一个结果和一个新的闭包：

```
query :: i -> Closure i o -> (o, Closure i o)
query i (Respond f) = f i 
```

请注意，上述类型的后半部分类似于 Haskell 中的常见模式，即`State`monad：

```
newtype State s a = State { runState :: s -> (a, s) } 
```

它可以从`Control.Monad.State`. 所以我们可以包装`query`在这个`State`monad 中：

```
query :: i -> State (Closure i o) o
query i = state $ \(Respond f) -> f i 
```

...现在我们有了一种通用的方法来使用`State`monad 查询任何闭包：

```
someQuery :: State (Closure () Int) (Int, Int)
someQuery = do
    n1 <- query ()
    n2 <- query ()
    return (n1, n2) 
```

让我们将闭包传递给它，看看会发生什么：

```
>>> evalState someQuery incrementer
(0, 1) 
```

让我们编写一个不同的闭包，它返回一些任意模式：

```
weirdClosure :: Closure () Int
weirdClosure = Respond (\() -> (42, Respond (\() -> (666, weirdClosure)))) 
```

...并测试它：

```
>>> evalState someQuery weirdClosure
(42, 666) 
```

现在，手动编写闭包似乎很尴尬。如果我们可以使用`do`符号来编写闭包不是很好吗？好吧，我们可以！我们只需要对我们的闭包类型进行一次更改：

```
data Closure i o r = Done r | Respond (i -> (o, Closure i o r)) 
```

现在我们可以为 定义一个`Monad`实例（来自`Control.Monad`）`Closure i o`：

```
instance Monad (Closure i o) where
    return = Done
    (Done r) >>= f = f r
    (Respond k) >>= f = Respond $ \i -> let (o, c) = k i in (o, c >>= f) 
```

我们可以编写一个对应于服务单个请求的便利函数：

```
answer :: (i -> o) -> Closure i o ()
answer f = Respond $ \i -> (f i, Done ()) 
```

...我们可以用它来重写我们所有的旧闭包：

```
incrementer :: Closure () Int ()
incrementer = forM_ [1..] $ \n -> answer (\() -> n)

weirdClosure :: Closure () Int r
weirdClosure = forever $ do
    answer (\() -> 42)
    answer (\() -> 666) 
```

现在我们只需将查询函数更改为：

```
query :: i -> StateT (Closure i o r) (Either r) o
query i = StateT $ \x -> case x of
    Respond f -> Right (f i)
    Done    r -> Left  r 
```

...并使用它来编写查询：

```
someQuery :: StateT (Closure () Int ()) (Either ()) (Int, Int)
someQuery = do
    n1 <- query ()
    n2 <- query ()
    return (n1, n2) 
```

现在测试一下！

```
>>> evalStateT someQuery incrementer
Right (1, 2)
>>> evalStateT someQuery weirdClosure
Right (42, 666)
>>> evalStateT someQuery (return ())
Left () 
```

但是，我仍然不认为这是一种真正优雅的方法，因此我将无耻地将我的代理类型插入我的[Proxy](http://hackage.haskell.org/packages/archive/pipes/2.3.0/doc/html/Control-Proxy-Tutorial.html)类型`pipes`作为编写闭包及其消费者的更通用和更结构化的方式来结束。`Server`类型表示一个广义闭包，而表示`Client`一个闭包的广义使用者。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-15T21:28:53.143

闭包只是为函数“添加”了额外的变量，因此与使用“正常”变量相比，您对它们无能为力，也就是说，当然不会修改状态。

阅读更多： [闭包（在 Haskell 中）](https://stackoverflow.com/questions/9088295/closures-in-haskell)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:25:42.987

正如其他人所说，Haskell 不允许更改闭包中的“状态”。这可以防止你做任何可能破坏函数纯度的事情。

# ruby-on-rails - 未定义的方法“电子邮件”#

> ID：12442674
> 
> 赞同：4
> 
> 时间：2012-09-15T21:19:22.373
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

无法弄清楚这里出了什么问题。按照设计设置说明，谷歌搜索了我能想到的一切，仍然没有运气。

```
undefined method `email' for #<User id: nil, created_at: nil, updated_at: nil>
Extracted source (around line #7):

4:   <%= devise_error_messages! %>
5: 
6:   <div><%= f.label :email %><br />
7:   <%= f.email_field :email %></div>
8: 
9:   <div><%= f.label :password %><br />
10:   <%= f.password_field :password %></div> 
```

这是我的用户模型：

```
class User < ActiveRecord::Base
  rolify
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me

  validates_presence_of :email
  validates_uniqueness_of :email, :case_sensitive => false

end 
```

我已经运行 rake db:migrate，重置服务器，你有什么。仍然无法弄清楚我哪里出错了。我什至还有另一个具有相同设置的基本应用程序，梳理源代码似乎我已经正确完成了所有操作，只是看不到问题所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T21:24:22.910

基本上，您的错误意味着您的用户模型中没有`email`列（或 attr_accessor）。

我猜您使用的是 Devise < 2.0，现在您使用的是最新版本。

自 2.0 起，Devise 不再将列自动包含到您的模型中，[请参阅此页面了解更多信息](https://github.com/plataformatec/devise/wiki/How-To%3a-Upgrade-to-Devise-2.0-migration-schema-style)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-08T06:44:35.810

显然你没有表格中的`username`列。`users`所以首先创建这个。

> rails g 迁移 add_username_to_users 用户名：字符串：uniq

然后运行`rake db:migrate`。现在您有一个用户名列，但它不允许作为强参数，因此在应用程序控制器中包含以下行。

```
class ApplicationController < ActionController::Base
before_action :configure_permitted_parameters, if: :devise_controller?

protected

def configure_permitted_parameters
 added_attrs = [:username, :email, :password, :password_confirmation, :remember_me]
 devise_parameter_sanitizer.permit :sign_up, keys: added_attrs
 devise_parameter_sanitizer.permit :account_update, keys: added_attrs
 end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T16:46:24.710

*在您的用户*模型中提及*电子邮件*列作为 attr_accessor

# c# - Windows Phone 7 - 如何从 while 循环更新 UI？

> ID：12442680
> 
> 赞同：1
> 
> 时间：2012-09-15T21:20:09.520
> 
> 标签：c#, windows-phone-7, user-interface, windows-phone

如何从 while、foreach、for 等循环中更新我的 Windows Phone 应用程序中的 UI？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T22:24:42.363

您是否考虑过为此使用额外的线程？

```
public MainPage()
        {
            InitializeComponent();
            Thread thread = new Thread(() => ReadFile(/*params*/));
            thread.Start();
        }

        private void ReadFile(/*params*/)
        {   
            while(/*condition*/)
            {
                /* READ FILE */

                //send task to UI thread to add object to list box
                Dispatcher.BeginInvoke(() => listBox1.Items.Add("YOUR OBJECT"));
            }
        } 
```

长期动作发生在非 UI 线程中，是什么使 UI 线程不会被冻结。在每次循环迭代中，非 UI 线程通过 Dispatcher.BeginInvoke 向 UI 线程发送操作以将新对象添加到列表框。

# objective-c - 如何让我的应用程序为 iPhone 5 做好准备

> ID：12442681
> 
> 赞同：4
> 
> 时间：2012-09-15T21:20:19.847
> 
> 标签：objective-c, ios

> **可能重复：**
> [如何处理 iPhone 5 的屏幕尺寸？](https://stackoverflow.com/questions/12396545/how-to-deal-with-iphone-5-screen-size)

Apple 刚刚发布了具有 4 英寸屏幕和 16:9 纵横比的 iPhone 5。当然，他们只给开发者两周的时间在无法测试的情况下争先恐后地更新他们的应用程序。

我想为 iPhone 5 的新大屏幕更新我的应用程序，但 Apple 的开发者网站上没有关于 iPhone 5 或让您的应用程序为更大屏幕做好准备的信息。必须编写自己的逻辑来测试设备是否是 iPhone 5，然后为其显示自定义情节提要文件，这将是一件痛苦的事情。

有谁知道新的尺寸是如何工作的，或者是否有任何隐藏的 Xcode？

# math - IEEE 754 实数能否“覆盖”其范围内的所有整数？

> ID：12442685
> 
> 赞同：20
> 
> 时间：2012-09-15T21:21:12.350
> 
> 标签：math

*对原始问题进行了编辑（缩短），以关注精度问题，而不是范围问题。*

单精度或双精度，实数的每种表示形式都限于 (-range,+range)。在这个范围内有一些整数（1、2、3、4...，等等；负数也是如此）。

是否保证 IEEE 754 实数（浮点数、双精度数等）可以“覆盖”其范围内的**所有整数？**通过“覆盖”，我的意思是实数将准确地表示整数，而不是（例如）“5.000001”。

*提醒一下：[http](http://www3.ntu.edu.sg/home/ehchua/programming/java/DataRepresentation.html) ://www3.ntu.edu.sg/home/ehchua/programming/java/DataRepresentation.html很好地解释了各种数字表示格式。*

**更新：**

因为问题是针对“可以”的，所以我也在寻找无法做到这一点的事实——因为引用一个数字就足够了。例如“不，它不能完成，例如数字 1748574 不完全由浮点数表示”（这个数字当然是凭空得出的）。

**对于好奇的读者**

如果您想使用 IEEE 754 表示 - 在线计算器：[http ://www.ajdesigner.com/fl_ieee_754_word/ieee_32_bit_word.php](http://www.ajdesigner.com/fl_ieee_754_word/ieee_32_bit_word.php)

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-09-16T09:13:28.543

不，不是全部，但存在一个可以准确表示所有整数的范围。

## 32位浮点数的结构

32bit 浮点类型使用

*   1 位符号
*   8 位为指数
*   23 位小数（隐含前导 1）

**代表数字**

基本上，您的表格中有一个数字

```
(-)1.xxxx_xxxx_xxxx_xxxx_xxxx_xxx (binary) 
```

然后你用（无偏的）指数向左/向右移动。

要让它代表一个需要`n`位的整数，您需要将其`n-1`向左移动一位。（所有`x`超出浮点数的 es 都为零）

**用 24 位表示整数**

很容易看出，我们可以表示所有需要 24 位（甚至更少）的整数

```
1xxx_xxxx_xxxx_xxxx_xxxx_xxxx.0 (unbiased exponent = 23) 
```

因为我们可以随意将`x`es设置为`1`or 或`0`.

我们可以用这种方式表示的最高数字是：

```
1111_1111_1111_1111_1111_1111.0 
```

或者`2^24 - 1 = 16777215`

下一个更高的整数是`1_0000_0000_0000_0000_0000_0000`。因此，我们需要 25 位。

**用 25 位表示整数**

如果您尝试表示 25 位整数（无偏指数 = 24），则数字具有以下形式：

```
1_xxxx_xxxx_xxxx_xxxx_xxxx_xxx0.0 
```

您可以使用的 23 位数字都已移过浮点数。前导数字始终是 1。总共有 24 位数字。但是因为我们需要 25，所以附加了一个零。

**找到最大值**

我们可以表示``1_0000_0000_0000_0000_0000_0000 `with the form`1_xxxx_xxxx_xxxx_xxxx_xxxx_xxx0.0 `, by simply assigning` 1 `to all`x `es. The next higher integer from that is:` 1_0000_0000_0000_0000_0000_0001 `. It's easy to see that this number cannot be represented accurately, because the form does not allow us to set the last digit to` 1 0` `: It is always` 。

因此，`1`后面跟 24 个零是我们可以准确表示的整数的上限。下限只是将其符号位翻转。

**可以表示所有整数的范围（包括边界）**

*   2 ^(24)作为上限
*   -2 ^(24)作为下限

## 64位浮点数的结构

*   1 位符号
*   11个指数位
*   52 个小数位

**可以表示所有整数的范围（包括边界）**

*   2 ^(53)作为上限
*   -2 ^(53)作为下限

通过将相同的论证应用于 64 位浮点数的结构，这很容易实现。

**注意**：这并不是说这些都是*我们*可以表示的整数，但它为您提供了一个可以表示*所有*整数的范围。超出该范围，我们只能表示 2 乘以来自该范围的整数的幂。

## 组合论证

简单地说服自己 32 位浮点数不可能代表 32 位整数可以表示的所有整数，我们甚至不需要看浮点数的结构。

1.  使用 32 位，我们可以表示 2 ^(32)种不同的事物。不多也不少。
2.  一个 32 位整数使用所有这些“事物”来表示数字（成对不同）。
3.  一个 32 位浮点数可以表示至少一个带有小数部分的数字。

^(因此，除了所有 2 32 个)整数之外，32 位浮点数不可能表示这个小数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-16T14:12:23.433

macias，添加到 phant0m 已经很好的答案（赞成；我建议你接受它），我会用你自己的话。

“不，不能这样做，例如数字 16777217 不能用浮点数精确表示。”

此外，“例如数字 9223372036854775809 不完全由双数表示”。

这是假设您的计算机使用的是 IEEE 浮点格式，这是一个相当不错的选择。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-15T21:32:02.597

不。

例如，在我的系统上，该类型`float`最多可以表示大约`3.40282e+38`. 作为一个整数，这将是大约2 128`340282000000000000000000000000000000000`或大约 2 ^(128)。

的大小`float`为 32 位，因此它最多可以精确表示 2 ^(32 个)不同的数字。

整数对象通常使用其所有位来表示值（其中 1 位专用于有符号类型的符号位）。浮点对象使用它的一些位来表示指数（IEEE 32 位为 8 位`float`）；*这以损失精度*为代价增加了它的*范围*。

 *一个具体的例子（`1267650600228229401496703205376.0`是 2 ^(100)，并且完全可以表示为 a `float`）：

```
#include <stdio.h>
#include <float.h>
#include <math.h>
int main(void) {
    float x = 1267650600228229401496703205376.0;
    float y = nextafterf(x, FLT_MAX);
    printf("x = %.1f\n", x);
    printf("y = %.1f\n", y);

    return 0;
} 
```

我的系统上的输出是：

```
x = 1267650600228229401496703205376.0
y = 1267650751343956853325350043648.0 
```

另一种看待它的方式：

一个 32 位对象最多可以表示 2 ^(32 个)不同的值。

一个 32 位有符号整数可以表示`-2147483648`.. `2147483647`(-2 ^(31) .. +2 ^(31) -1) 范围内的所有整数值。

32 位`float`可以表示许多 32 位有符号整数不能表示的值，因为它们是小数 (0.5) 或因为它们太大 (2.0 ^(100) )。由于存在可以用 32-bit 表示`float`但不能用 32-bit`int`表示的值，因此必须有其他值可以用 32-bit 表示`int`但不能用 32-bit表示`float`。这些值是具有比 a`float`可以处理的更多有效数字的整数，因为`int`有 31 个值位，但`float`只有大约 24 个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-15T21:58:42.310

显然，您是在询问 Real 数据类型是否可以表示其范围内的所有整数值（C 中的绝对值不超过 FLT_MAX 或 DBL_MAX，或其他语言中的类似常量）。

存储在 K 位中的浮点数可表示的最大数字通常远大于 K 位可以表示的 2^K 个整数，因此通常答案是否定的。32 位 C 浮点数超过 10^37，32 位 C 整数小于 10^10。要找出某个数字之后的下一个可表示数字，请使用[nextafter()](http://www.mkssoftware.com/docs/man3/nextafter.3.asp)或 nextafterf()。例如，代码

```
printf ("%20.4f %20.4f\n", nextafterf(1e5,1e9), nextafterf(1e6,1e9));
printf ("%20.4f %20.4f\n", nextafterf(1e7,1e9), nextafterf(1e8,1e9)); 
```

打印出来

```
 100000.0078         1000000.0625
   10000001.0000       100000008.0000 
```

您可能对是否可以精确表示介于两个相邻小数浮点值 R 和 S 之间的整数 J 感兴趣，假设 SR < 1 和 R < J < S。是的，这样的 J 可以精确表示。每个浮点值都是某个整数和某个 2 的幂的比。（或者是某个整数和某个 2 的幂的乘积。）设 2 的幂为 P，假设 R = U/P，S = V/ P。现在 U/P < J < V/P 所以 U < J*P < V。J*P 的低位比 U、V 的低位更多为零（因为 VU < P，由于 SR < 1），所以 J 可以精确表示。

我没有填写所有细节来证明 J*PU < P 和 VJ*P < P，但在假设 SR < 1 的情况下，这很简单。下面是一个 R,J,S,P,U,V 值计算的例子： 设 R=99999.9921875 = 12799999/128，（即 P=128）；让 S=100000.0078125 = 12800001/128；我们有 U=0xc34fff 和 V=0xc35001 并且它们之间有一个数字，其低阶零比任何一个都多；也就是说，J = 0xc35000/128 = 12800000/128 = 100000.0。对于此示例中的数字，请注意 U 和 V 需要 24 位来表示它们的精确表示（6 位 4 位十六进制数字）。请注意，24 位是 IEEE 754 单精度[浮点数](http://en.wikipedia.org/wiki/Floating_point#Internal_representation)中的精度位数。（参见维基百科文章中的表格。）

每个浮点数是某个整数和某个 2 的幂的乘积或比率（如上面的两段所述）也在该[浮点](http://en.wikipedia.org/wiki/Floating_point#Representable_numbers.2C_conversion_and_rounding)文章中讨论，在一段开头的段落中：

> 就其性质而言，所有以浮点格式表示的数字都是有理数，并在相关基数中具有终止扩展（例如，...以 2 为基数的终止二进制扩展）。无理数，例如 π 或 √2，或非终止有理数，必须近似。精度的位数（或位数）也限制了可以精确表示的有理数集。*

# user-interface - Acceleo 创建 UI 启动器未找到

> ID：12442690
> 
> 赞同：-1
> 
> 时间：2012-09-15T21:21:59.260
> 
> 标签：user-interface, acceleo

我将 acceleo 3 与 eclipse 建模工具 3.7 一起使用。我在最后一步“创建 UI 启动器”中点击此链接[http://wiki.eclipse.org/Acceleo/Getting_Started](http://wiki.eclipse.org/Acceleo/Getting_Started) - 我没有 Acceleo 模型文本。

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T07:58:46.917

您需要启动一个安装了此插件的新 Eclipse，以便菜单显示自己。入门的最后一个屏幕截图是显示安装此插件的结果。

使用 Run > Run Configurations... 然后在弹出窗口中双击“Eclipse application”并单击“Run”。将启动一个新的 Eclipse，其中安装了您工作区中的所有插件。在这个新的 Eclipse 中，您应该有“Acceleo Model-To-Text”菜单。

# spring - Spring i18n 与 Spring 安全性

> ID：12442691
> 
> 赞同：0
> 
> 时间：2012-09-15T21:22:19.387
> 
> 标签：spring, internationalization, spring-security

我将我的项目配置为国际，但现在我试图更改 spring 安全自定义消息但没有成功......我已经阅读并尝试了一些东西但没有成功。我可以看到通常的消息，但不能看到弹簧安全消息。

这是我的 servlet-context.xml：

```
<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" />

<!-- Tiles -->
<beans:bean  id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <beans:property name="definitions">
        <beans:list>
            <beans:value>/WEB-INF/tiles.xml</beans:value>
        </beans:list>
    </beans:property>
</beans:bean>

<beans:bean   class="org.springframework.web.servlet.view.tiles2.TilesViewResolver">      
    <beans:property 
        name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView"/>                
</beans:bean>

<context:component-scan base-package="com.company.projectMvc" />

<!-- default locale  -->
<beans:bean class="org.springframework.web.servlet.i18n.SessionLocaleResolver" id="localeResolver"> 
    <beans:property name="defaultLocale" value="es"/> 
 </beans:bean> 

 <interceptors> 
    <beans:bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
         <beans:property name="paramName" value="language"/> 
    </beans:bean> 
 </interceptors> 

<!-- Messages files -->
<beans:bean id="messageSource"  name="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
    <beans:property name="basename" value="/resources/messages/messages" />
</beans:bean> 
```

这是我的spring-security.xml：

```
<http auto-config="true" use-expressions="true" >
    <intercept-url pattern="/test" access="isAuthenticated()" />
    <intercept-url pattern="/**" access="isAuthenticated()" />
    <intercept-url pattern="/home" access="permitAll" />

    <form-login  default-target-url="/home"/>
    <logout logout-success-url="/test" />
</http>

<authentication-manager>
   <authentication-provider>
    <jdbc-user-service data-source-ref="dataSource"

       users-by-username-query="
          select username,password,enabled,fullname
          from users where username=?" 

       authorities-by-username-query="
          select u.username, ur.authority from users u, user_roles ur 
          where u.user_id = ur.user_id and u.username =?  " 

    />
   </authentication-provider>
</authentication-manager> 
```

**更新 1** 我尝试了您的解决方案，复制了 spring 安全文件并没有成功地更改它们。在我阅读[了带有 AcceptHeaderLocaleResolver 和 i18n 的这个线程 Spring Security 之后，](https://stackoverflow.com/questions/6572377/spring-security-with-acceptheaderlocaleresolver-and-i18n) 我也尝试了该解决方案但没有成功这里是我更新的 servlet-context.xml 文件：

```
 <!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" />

<!-- Tiles -->
<beans:bean  id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <beans:property name="definitions">
        <beans:list>
            <beans:value>/WEB-INF/tiles.xml</beans:value>
        </beans:list>
    </beans:property>
</beans:bean>

<beans:bean   class="org.springframework.web.servlet.view.tiles2.TilesViewResolver">      
    <beans:property 
        name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView"/>                
</beans:bean>

<context:component-scan base-package="com.company.projectMvc" />

 <!-- default locale pt_PT -->
<beans:bean class="org.springframework.web.servlet.i18n.SessionLocaleResolver" id="localeResolver"> 
    <beans:property name="defaultLocale" value="pt_PT"/> 
 </beans:bean> 

<!-- Messages files -->
<beans:bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <beans:property name="basenames">
    <beans:list>
        <beans:value>/resources/messages/messages</beans:value>
        <beans:value>/resources/messages/securityMessages</beans:value>
    </beans:list>
 </beans:property>

</beans:bean>

<!-- com o parametro locale no URL conseguimos definir o locale que quisermos -->
 <interceptors> 
    <beans:bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
         <beans:property name="paramName" value="lang"/> 
    </beans:bean> 
 </interceptors> 
```

这是我更新的 web.xml

[第1部分](http://imageshack.us/photo/my-images/812/80760783.png)

[第2部分](http://imageshack.us/photo/my-images/515/17151547.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-14T21:01:54.180

答案可能有点晚，但面临类似问题的其他人可能会发现它很有用：

您的问题是安全 bean 在根 Web 应用程序上下文中，但`messageSource`在 servlet 应用程序上下文源中。这意味着安全 bean 不知道您的消息源。**只需将您的消息源定义移动到根 Web 应用程序上下文。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T22:57:43.960

不知道你有没有试过这个

1.  从中复制消息文件`org.springframework.security`并更改
    它们。
2.  使用这些文件配置您的消息源。

默认情况下 Spring 安全使用`org.springframework.security.core.SpringSecurityMessageSource`This is from javadocs

> 默认情况下，所有需要消息本地化的 Spring Security 类都将使用此类。但是，所有此类类也将实现 MessageSourceAware，以便应用程序上下文可以注入替代消息源。因此，此类仅在部署环境未指定备用消息源时使用。

# c++ - Cocos2D + Box2D：在设备上运行时出现很多解析问题

> ID：12442694
> 
> 赞同：0
> 
> 时间：2012-09-15T21:23:27.417
> 
> 标签：c++, objective-c, cocos2d-iphone, box2d-iphone

我正在使用 Cocos2D 框架和 Box2D 引擎构建游戏。

当我在模拟器中运行游戏时，它工作得很好。然而，当我尝试在我的设备上运行它时，我遇到了大约 20 个问题，其中大多数是“解析”问题和“语义”问题。

这是其中的一些问题：

```
ccMacros.h
(!)Parse Issue
    Unknown type name 'NSUInteger'

CFDictionary.h
(!)Parse Issue
    Expected identifier or '('

(!)Semantic Issue
    Function cannot return function type 'int(const void*)'

(!)Parse Issue
    Unknown type name 'CF_EXPORT' 
```

老实说，我不知道是什么原因造成的，谷歌也帮不了我。

值得一提的是，我使用的是 cocos2d 2.0，我的设备是 iPod Touch 第 4 代。

任何关于如何解决这个问题的建议将不胜感激！

编辑：根据要求，一些导致问题的行：

```
typedef const void *    (*CFDictionaryRetainCallBack)(CFAllocatorRef allocator, const void *value);
typedef void        (*CFDictionaryReleaseCallBack)(CFAllocatorRef allocator, const void *value);
typedef CFStringRef (*CFDictionaryCopyDescriptionCallBack)(const void *value);
typedef Boolean     (*CFDictionaryEqualCallBack)(const void *value1, const void *value2);
typedef CFHashCode  (*CFDictionaryHashCallBack)(const void *value); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T19:41:12.030

当我在我的项目中创建一个名为“Block”的类（因此，“Block.h”和“Block.mm”）时，我已经看到了这个问题。这导致了您面临的完全相同的问题。

检查您最近添加的头文件是否会影响某些系统文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T04:43:27.697

尝试将与 box2d 一起使用的类的文件名更改为以 .mm 而不是 .m 结尾

# android - 将文本（例如正在编辑的字段）放在 Android 软键盘上的选项（全屏/提取模式）

> ID：12442695
> 
> 赞同：1
> 
> 时间：2012-09-15T21:23:32.647
> 
> 标签：android, android-edittext, android-softkeyboard

有什么方法可以将文本（例如当前正在编辑的 EditText 字段的名称）放在全屏 Android 软键盘上，即使在用户在该字段中输入文本后它仍然存在？我注意到在 EditorInfo 中有一个标签属性

> public CharSequence label - 显示给用户的标签，描述他们正在编写的文本。

但我似乎找不到从 EditText 字段设置其值的任何方法。有谁知道怎么做？我也知道可以使用提示，但这不是我之前所说的选项，我不希望描述当前正在编辑的字段的文本在他们开始输入后消失。

谢谢您的帮助。

# php - 需要帮助设置 json 数组

> ID：12442697
> 
> 赞同：1
> 
> 时间：2012-09-15T21:24:02.907
> 
> 标签：php, javascript, arrays, json, jsonp

数据库查询返回几行，我循环如下：

```
 foreach ($query->result() as $row) {

        $data[$row->post_id]['post_id']         = $row->post_id;
        $data[$row->post_id]['post_type']       = $row->post_type;
        $data[$row->post_id]['post_text']       = $row->post_text;
    } 
```

如果我`json_encode`得到的数组 ( `$a['stream']`) 我得到

```
{
    "stream": {
        "1029": {
            "post_id": "1029",
            "post_type": "1",
            "post_text": "bla1",
        },
        "1029": {
            "post_id": "1030",
            "post_type": "3",
            "post_text": "bla2",
        },
        "1029": {
            "post_id": "1031",
            "post_type": "2",
            "post_text": "bla3",            
        }
    }
} 
```

但`json`实际上应该是这样的：

```
{
    "stream": {
        "posts": [{
            "post_id": "1029",
            "post_type": "1",
            "post_text": "bla1",
        },
        {
            "post_id": "1030",
            "post_type": "3",
            "post_text": "bla2",
        },
        {
            "post_id": "1031",
            "post_type": "2",
            "post_text": "bla3",            
        }]
    }
} 
```

我应该如何构建我的阵列才能做到这一点`json`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T21:28:12.037

无论如何，这是你应该做的：

```
...
$posts = array();
foreach ($query->result() as $row) {
    $post = array();
    $post['post_id']         = $row->post_id;
    $post['post_type']       = $row->post_type;
    $post['post_text']       = $row->post_text;
    $posts[] = $post;
}
$data['posts'] = $posts;
... 
```

一点解释：您必须根据从数据库中获取的信息构建一个对象，即`$post`. 这些对象中的每一个都需要一起添加到一个数组中，即`$posts`. 这个来自数据库的帖子数组被设置为 的键`posts`，`$data`即`$data['posts']`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T21:38:33.657

这个怎么样？

[http://codepad.viper-7.com/zPHCm0](http://codepad.viper-7.com/zPHCm0)

```
<?php
$myData = array();
$myData['posts'][] = array('post_id' => 3, 'post_type' => 343, 'post_text' => 'sky muffin pie');
$myData['posts'][] = array('post_id' => 4, 'post_type' => 111, 'post_text' => 'Mushroom chocolate banana');
$myData['posts'][] = array('post_id' => 231, 'post_type' => 888, 'post_text' => 'Cucumber strawberry in the sky');

$theStream['stream'] = $myData;

$json = json_encode($theStream);

echo 'JSON:<Br/>';
echo $json; 
```

以上给了我：

```
{
    "stream":
    {   "posts":[
            {"post_id":3,"post_type":343,"post_text":"sky muffin pie"},
            {"post_id":4,"post_type":111,"post_text":"Mushroom chocolate banana"},
            {"post_id":231,"post_type":888,"post_text":"Cucumber strawberry in the sky"}]
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T21:27:41.073

```
foreach ($query->result() as $row) {
    $data['posts']['post_id']         = $row->post_id;
    $data['posts']['post_type']       = $row->post_type;
    $data['posts']['post_text']       = $row->post_text;
} 
```

# java - 安卓开发入门

> ID：12442703
> 
> 赞同：8
> 
> 时间：2012-09-15T21:25:18.750
> 
> 标签：java, android

我从一开始就是 Windows 开发人员，现在当前的趋势表明我专注于更新的技术和平台。

我的问题是如何开始 android 开发，是否可以在装有 windows 7 的 windows pc 上完成，如果是，我需要什么工具。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-15T22:30:28.300

**设置工具：**

1.  安装[Eclipse](http://www.eclipse.org/downloads/) [注意：您可以选择任何 IDE，但这是 Android 开发中使用最广泛的一种。[IntelliJ](http://www.jetbrains.com/idea/download/)是您可以尝试的另一个 IDE。]
2.  为 Eclipse安装[ADT](http://developer.android.com/tools/sdk/eclipse-adt.html)（Android 开发工具）插件（假设您确实选择使用 Eclipse）
3.  使用 Android SDK 管理器更新您的 android 工具
4.  （可选）获取用于测试您的应用程序的 Android 设备，因为不建议完全依赖模拟器

**入门 ：**

5.  由于您是 Windows 开发人员，因此您必须精通 C#，因此赶上 Java（以防万一，您还没有）应该不是什么大问题
6.  [将Android 开发者网站](http://developer.android.com/index.html)添加为书签，如有疑问，请毫不犹豫地查看文档
7.  看看官网给出的[示例代码](http://developer.android.com/tools/samples/index.html)
8.  您可能希望按照[此处](http://developer.android.com/training/basics/firstapp/index.html)提到的步骤操作，因为它们会引导您完成整个过程

**有用的资源：**

9.  [Vogella 的教程](http://www.vogella.com/articles/Android/article.html)
10.  [thenewboston 的视频教程](http://www.youtube.com/course?list=EC2F07DBCDCC01493A&feature=plcp)[**注意：**这是我发现的最好的 Android 视频教程系列之一，所以不要犹豫，下载所有 200 个视频。他们真的很有帮助！]
11.  [mybringback 的视频教程](http://www.youtube.com/course?list=ECB03EA9545DD188C3&feature=plcp)

12.  [StackOverflow](https://stackoverflow.com/)上的答案

祝你好运！愿机器人与你同在！;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-15T21:26:56.207

观看 Lynda.com 的 Android 应用程序开发与 Java 培训，你会学到这一切......你需要 Eclipse、Android SDK 和 ADT 插件......就是这样......

快乐发展

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-15T21:27:51.417

您应该从[http://developer.android.com/index.html](http://developer.android.com/index.html)开始。

下载 SDK，阅读文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-15T21:27:03.613

访问开发者博客。下载sdk。购买 Android 设备和微型 USB 数据线。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-15T21:27:08.360

[只需从http://developer.android.com](http://developer.android.com)下载 Android SDK，您也可以在这里找到教程

您还可以下载 eclipse 和 ADT（Android 开发工具）插件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-15T21:28:57.137

你应该看看[eclipse](http://www.eclipse.org/)。它主要基于 Java 应用程序，但我相信您可以在其上进行一些 android 开发。

# animation - CSS - 动画悬停问题

> ID：12442709
> 
> 赞同：0
> 
> 时间：2012-09-15T21:27:00.213
> 
> 标签：animation, css

只有当用户将鼠标悬停在 div 上时，我才有动画工作的问题。我做了一个jsfiddle：http: [//jsfiddle.net/HBfLY/1/](http://jsfiddle.net/HBfLY/1/)

所以我希望它从左边反弹，但它正在闪烁。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T21:35:27.903

您遇到的问题是，一旦元素由于动画而改变其位置，它就不再被光标悬停，因此`:hover`选择器不再适用。

要解决这个问题，您可以将 应用于`:hover`祖先元素：

```
body:hover #animatie1 {
    border: 5px solid black;
    position:relative;
    top: 20px;
    left:100px;
    width:100px;
    height: 200px;
    animation:mymove 2s ;
    -moz-animation:mymove 2s ; /* Firefox */
    -webkit-animation:mymove 2s ; /* Safari and Chrome */
    -o-animation:mymove 2s ; /* Opera */
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/HBfLY/4/)。

或者使用前面的兄弟元素：

```
#immediatelyPrecedingSibling:hover + #animatie1 {
    border: 5px solid black;
    position:relative;
    top: 20px;
    left:100px;
    width:100px;
    height: 200px;
    animation:mymove 2s ;
    -moz-animation:mymove 2s ; /* Firefox */
    -webkit-animation:mymove 2s ; /* Safari and Chrome */
    -o-animation:mymove 2s ; /* Opera */
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/HBfLY/5/)。

在那些支持 general-sibling 组合符的浏览器中，您可以使用*任何*前面的兄弟元素（只要您可以使用 CSS 定位它，并且重申一下，这个兄弟*元素在 DOM 中要定位的元素之前*）：

```
#notAnImmediatelyPrecedingSibling:hover ~ #animatie1 {
    border: 5px solid black;
    position:relative;
    top: 20px;
    left:100px;
    width:100px;
    height: 200px;
    animation:mymove 2s ;
    -moz-animation:mymove 2s ; /* Firefox */
    -webkit-animation:mymove 2s ; /* Safari and Chrome */
    -o-animation:mymove 2s ; /* Opera */
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/HBfLY/6/)。

参考：

*   [浏览器对通用兄弟`~`组合](http://www.quirksmode.org/css/contents.html#t30)器的支持。
*   [CSS 3 级选择器](http://www.w3.org/TR/css3-selectors/#selectors)。

# multithreading - 从信号处理程序访问共享内存

> ID：12442712
> 
> 赞同：1
> 
> 时间：2012-09-15T21:27:17.403
> 
> 标签：multithreading, concurrency, multiprocessing, deadlock, semaphore

我在使用信号处理程序时遇到了这个问题。我有一个定义共享内存的父进程。它派生出两个子进程，它们具有用于某种类型信号的信号处理程序。现在，只要子进程接收到该特定信号，它们的信号处理程序就会处理该信号。

现在我需要跟踪信号处理程序处理信号的次数。我需要使用该共享内存来增加计数器的信号由任一子进程处理的次数

为此，我可能需要使用信号量。但我的问题是，每当信号由处理程序处理时，它必须检查是否正在访问共享内存，如果正在访问它不能增加计数器，那么它可能不得不阻塞。我认为我们不能阻止信号处理程序。

那么实现这一目标的最佳方法是什么。我的两个子进程都注册了相同的信号处理程序来处理类型为 1 的信号。因此，每当接收到该特定信号时，它们的两个相同的信号处理程序例程都会尝试增加计数器。

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T18:39:10.970

您可以在信号处理程序中阻塞，有点。我的意思是：你可以安全地阻止其他进程完成它正在做的事情。不寻常的死锁可能性是您自己的进程 - 如果进程中的特定线程已锁定互斥锁（或信号量），则内核劫持该线程来处理信号，并等待锁定：死锁。线程的主堆栈在信号处理程序完成之前不会释放锁，信号处理程序在主堆栈释放锁之前不会完成。

（同样的自死锁问题隐藏在各种常见的调用中，比如`malloc`. 这就是为什么有一个非常短的库函数列表可以保证“信号安全”。）

我看到了解决这个问题的几种方法：

*   不允许信号处理程序从具有锁的线程运行。至少有三种方法可以使用`pthread_sigmask`：
    1.  您可以在获取锁之前暂时屏蔽该线程中的信号，并在锁释放后取消屏蔽它。当然，额外的系统调用会产生一些成本，因此如果这是对性能敏感的代码，您可能希望避免这种方法。
    2.  您可以在所有线程中永久屏蔽它，并使用`sigwait`来自某个线程的循环来处理信号，而根本不需要传统的信号处理程序。这将使您摆脱对“信号安全”功能等的所有担忧。
    3.  您可以在该线程中永久屏蔽它，并让其他线程使用传统的信号处理程序运行，要么执行其他“实际”工作，要么只是一个`sigsuspend`循环。
*   使用原子。如果这是一个简单的计数器，您可以完全避免锁定。信号处理程序从不等待主线程。主线程也没有特别的问题——也许一个比较和交换循环会运行一个额外的迭代，因为信号处理程序在两者之间运行，但这并不是一个真正的问题。不过，我不完全确定[C++11 原子](http://en.cppreference.com/w/cpp/atomic/atomic)是否能保证在共享内存区域上正确运行。您可能需要查看平台的实现。我无法想到他们会关心其他线程与使用共享内存段的其他进程的任何原因，但我不想过度承诺。

# node.js - res.redirect('back') 带参数

> ID：12442716
> 
> 赞同：42
> 
> 时间：2012-09-15T21:27:54.890
> 
> 标签：node.js, redirect, express

我网站的每个页面上都有一个注册表单。在注册过程中可能会出现一些错误。发现错误后，我必须将用户返回到上一页，显示一些错误消息。问题是我不知道用户是从哪个页面进行注册的，所以我使用`res.redirect('back');`. 但是，我不能只是将用户重定向回来，我还必须显示错误消息，所以我必须传递一些参数。但`res.redirect('back', (reg_error:'username')})`不能直接使用，因为`res.redirect()`不支持参数。如何使用某些参数呈现上一页？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-16T01:47:16.317

使用 referer 标头来查找您的用户来自哪个页面可能会有所帮助：

```
app.get('/mobileon', function(req, res){
  backURL=req.header('Referer') || '/';
  // do your thang
  res.redirect(backURL);
}); 
```

`backURL`如果您需要它在多个路由中持久存在，您可能还希望存储在 req.session 中。请记住测试该变量是否存在，例如：`res.redirect(req.session.backURL || '/')`

* * *

*编辑：*由于我的回答得到了一些支持，我输入了我目前的方法来做到这一点。它有点长，所以你可以在[https://gist.github.com/therealplato/7997908](https://gist.github.com/therealplato/7997908)查看它。

最重要的区别是在查询字符串中使用显式的“bounce”参数来覆盖Referer url。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-10-28T05:21:35.853

实现这一点的一个非常简单的方法是使用[connect-flash](https://github.com/jaredhanson/connect-flash)，这是一种用于 express 的中间件，它利用 express 内置的会话中间件将“flash”消息传递给下一个请求。

这意味着您不需要添加字段来跟踪 url 或消息到您的视图的表单或路由模式。

[它提供了Ruby on Rails](http://guides.rubyonrails.org/action_controller_overview.html#the-flash)中相同功能的简单版本。

（显然你必须使用[Express 框架](http://expressjs.com/)才能使用它，但我也强烈推荐！）

像这样插入它：

```
var flash = require('connect-flash');
var app = express();

app.configure(function() {
  app.use(express.cookieParser('keyboard cat'));
  app.use(express.session({ cookie: { maxAge: 60000 }}));
  app.use(flash());
}); 
```

然后像这样使用它：

```
app.get('/flash', function(req, res){
  req.flash('info', 'Flashed message')
  res.redirect('/');
});

app.get('/', function(req, res){
  res.render('index', { message: req.flash('info') });
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-16T02:35:44.283

如果您正在使用会话，则可以在重定向之前`reg_error`将该对象添加到对象中。然后，当您加载上一页时`req.session`，它将在对象上可用。`req.session`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-14T09:22:54.863

您可以简单地将其重定向为`res.redirect('..?error=1')`

该`?`标签告诉浏览器它是一组可选参数，`..`它只是一个路径名相对调用（例如`cd ..`在终端上调用以移回一个目录），您的浏览器将定向到最后带有该标签的相应页面：`http://.....?error=1`

然后您可以通过执行以下操作简单地在相应页面上拉出错误：

```
if (req.param("error" == 1)) { 
// do stuff bassed off that error match
}; 
```

您可以硬编码几个不同的错误值，并根据发生的错误做出适当的响应

请注意，这会使您的网页容易受到操纵，因为用户可以输入他们自己的参数并让您的页面响应它，因此请确保您采取的操作不是您不希望人们滥用的操作。（对于简单的错误显示应该没问题）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-23T05:37:54.327

在处理请求之前使用中间件，并将成功和错误变量与 res 对象一起放置。

参考以下：-

```
// set local variables middleware
    app.use(function(req, res, next) {
         res.locals.currentUser = req.user;
           // set success flash message
           res.locals.success = req.session.success || '';
              delete req.session.success;
               // set error flash message
               res.locals.error = req.session.error || '';
            delete req.session.error;
           // continue on to next function in middleware chain
              next();
             }); 
```

在遇到错误时，使用另一个中间件来处理错误并使用 req 对象添加错误。

```
app.use(function(err, req, res, next) {

       console.log(err);
       req.session.error = err.message;
            res.redirect('back');
       }); 
```

这将重定向到上一页以及 res 对象中的错误消息

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-04T15:53:26.523

您可以使用 connect-flash 包发送错误或成功消息。

[https://www.npmjs.com/package/connect-flash](https://www.npmjs.com/package/connect-flash)

* * *

## 回答 #7

> 赞同：-17
> 
> 时间：2012-09-15T23:54:46.740

您应该将页面参数添加到表单。然后您可以在服务器上读取它并将其用于重定向。

```
res.redirect(page, {reg_error:'username'}) // page being the url to redirect to. 
```

# java - Java UnknownFormatConversionException

> ID：12442728
> 
> 赞同：29
> 
> 时间：2012-09-15T21:29:00.447
> 
> 标签：java, debugging

下面的代码抛出了这个错误，我不知道为什么。将 String.format 输出到变量显然存在问题`str`，但我不知道它有什么问题。

```
Exception in thread "main" java.util.UnknownFormatConversionException: Conversion = 'i'
    at java.util.Formatter$FormatSpecifier.conversion(Unknown Source)
    at java.util.Formatter$FormatSpecifier.<init>(Unknown Source)
    at java.util.Formatter.parse(Unknown Source)
    at java.util.Formatter.format(Unknown Source)
    at java.util.Formatter.format(Unknown Source)
    at java.lang.String.format(Unknown Source)
    at Donor.toString(Donor.java:41)
    at Donor.main(Donor.java:65) 
```

-

```
import java.util.Scanner;

public class Donor {

    public String name;
    public int age;
    public double donation;

    Donor() {

        //Initialized to these values for debugging
        name = "NoName";
        age = 0;
        donation = 0;

    }

    Donor(String nameinit, int ageinit, double donationinit) {

        name = nameinit;
        age = ageinit;
        donation = donationinit;

    }

    public String toString() {

        String str = "";

        str = String.format("%s-30%i-6$%d-20", name, age, donation);

        return str;

    }

    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);
        String nameinit = null;
        int ageinit = -1;
        double donationinit = -1;
        String outp = null;

        System.out.print("Enter the donor's name: ");
        nameinit = input.nextLine();

        System.out.print("Enter the donor's age: ");
        ageinit = input.nextInt();

        System.out.print("Enter the donation amount: ");
        donationinit = input.nextDouble();

        Donor d = new Donor(nameinit, ageinit, donationinit);
        outp = d.toString();

        System.out.printf("%s30 %s6 %s10", "Name", "Age", "Donation");
        System.out.print("\n" + outp);

        input.close();

    }

} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-09-15T21:34:52.923

在以下行中使用`d`for`int`代替`i`和`f`for`double`代替`d`

```
str = String.format("%s-30%i-6$%d-20", name, age, donation); 
```

您可以在此处阅读有关格式化语法的信息[http://docs.oracle.com/javase/6/docs/api/java/util/Formatter.html](http://docs.oracle.com/javase/6/docs/api/java/util/Formatter.html)。

# java - Java：如何将 System.err 显式重定向到控制台（即恢复默认行为）？

> ID：12442731
> 
> 赞同：4
> 
> 时间：2012-09-15T21:30:25.340
> 
> 标签：java, max-msp-jitter

我正在为一个名为[Max/MSP](http://cycling74.com/products/max/)的封闭源应用程序编写插件。要使用 Max/MSP，我的代码需要扩展供应商提供的类 (com.cycling74.max.MaxObject)。此类覆盖`System.err`, 以便将`System.err.println`消息调用定向到应用程序提供的特殊错误日志。

这种行为在部署中很好，但在测试期间会出现问题。我目前正在尝试编写一个在主机应用程序之外运行我的代码的测试套件。当我这样做时，调用`System.err`引发异常，因为应用程序的错误日志不可用。

有谁知道我如何“撤消” Max/MSP 的错误重定向，以便在测试期间调用以`System.err.println`显示在 java 控制台中？

编辑

我尝试了@MadProgrammer 的建议，即在创建我的 Max 对象之前缓存对错误 PrintStream 的引用。

```
import com.cycling74.max.*;

public class MyMaxObject extends MaxObject{

    public MyMaxObject(){}

    public static void main(String[] args){
        PrintStream oldError = System.err;
        MyMaxObject o = new MyMaxObject();
        System.setErr(oldError);
} 
```

我不能让它工作。当我在调试器中运行这段代码时，我发现在我的 main 方法的第一行`System.err`有类型`com.cycling74.io.ErrorStream`。所以看起来重定向到那时已经发生了。如果是这种情况，如何在重定向错误流之前获得对它的引用？（如果不是在顶部，我到底会把代码放在哪里`Main`？）

编辑 2

好的，想通了。我只需要将我的测试代码（例如`Main`上面的方法）移动到一个单独的类中。一旦我这样做了@MadProgrammer 的解决方案就完美了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-15T21:56:45.697

首先，您需要`System.err`在重定向之前对其进行引用。

```
PrintStream oldError = System.err; 
```

一旦你初始化`MaxObject`（或者系统的任何部分覆盖`System.err`你需要重新分配引用......

```
System.setErr(oldError); 
```

# asp.net-mvc - ASP.NET MVC 3 DropDownListFor

> ID：12442732
> 
> 赞同：3
> 
> 时间：2012-09-15T21:31:03.873
> 
> 标签：asp.net-mvc

当用户选择带有 的项目时，我如何执行一些逻辑`@Html.DropDownListFor`？

根据用户点击的内容，我想更新模型并使用新编辑的数据重新传递它。

下拉列表代码如下：

```
@Html.DropDownListFor(m => m.Categories, Model.Categories, "Select a Category") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T04:09:44.957

使用下拉列表的 onchange 事件

```
@Html.DropDownList("ddlCountry", ViewBag.Country as SelectList, "Select...", new { onchange = "FetchStates();" }) 
```

这是 Cascading dropdownlist 的链接，显示了这个 [Cascading Dropdown的示例](http://www.dotnetexpertguide.com/2012/06/cascading-dropdown-knockoutjs-aspnet.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T22:02:22.697

您可以使用 JavaScript。

查看 DropDownListFor 上的重载 - 您可以传入`new { onchange="yourJavascriptMethod" }`或给它一个 id/name 并在 javascript 中注册事件处理程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T22:10:19.733

最简单的方法是使用 jquery，例如：

```
 ```
$(document).ready(function() {
    $("#Categories").change(function() {
        var strSelected = "";
        $("#Categories option:selected").each(function() {
            strSelected += $(this)[0].value;
        });
        var url = "/Home/MyAction/" + strSelected; // or send with json

        $.post(url, function(data) {
            // do something if necessary
        });
    });
}); 
``` 
```

# foursquare - checkins/recent not returning comments or even counts of comments

> ID：12442737
> 
> 赞同：0
> 
> 时间：2012-09-15T21:33:09.470
> 
> 标签：foursquare

My application has been using the checkins/recent endpoint to show where all the current users friends are currently at and I had included a button the user could press to comment on a checkin. The button used to have the comment count on it until recently.

It seems the checkins/recent endpoint no longer returns comments or even a comment count for those checkins. I would have to query each checkin in order to get the comment count which adds to the data usage not to mention API usage counts.

Is there another way to do this that I'm not seeing? Could you please at least put the comment count back? You have the photo information, why not comments?

Thanks

EDIT: Sorry, I found an old post in the google groups where I kinda asked the same thing, so I'm mistaken, comment counts were never returned before, but like I mentioned last time, it would be nice if at least the count was returned so it can be used in our apps in the manner mentioned above without another api call for each checkin.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T14:58:55.610

checkins/recent 端点不返回评论计数。您必须单独查询每个签到以获取评论数据。

# python - Django 和 AddThis 社交登录

> ID：12442739
> 
> 赞同：1
> 
> 时间：2012-09-15T21:34:03.830
> 
> 标签：python, django, registration, django-registration, addthis

我正在开发一个 Django 网站。到目前为止，我一直在使用 django-registration 进行用户注册，但我真的很想允许用户使用他们的 Facebook、Twitter、Google 等帐户登录我的网站。

我正在使用 addthis 共享按钮。我刚刚注意到他们引入了一个社交登录解决方案。这个想法似乎很棒，您只需将身份验证系统与他们的服务集成一次，您的用户就可以通过所有流行的社交网站登录。

有没有人将 addthis 社交登录插件与 django 网站集成？您如何在 django-registration 旁边使用它？有没有类似的替代解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:09:23.707

查看Facebook、Twitter 和 Co的[Python Social auth以及](https://github.com/omab/python-social-auth)[Django Registration](https://github.com/macropin/django-registration)以通过电子邮件进行注册和密码重置。

# c# - Monotouch Binding to Linea Pro SDK

> ID：12442740
> 
> 赞同：2
> 
> 时间：2012-09-15T21:34:05.017
> 
> 标签：c#, ios, binding, xamarin.ios, linea-pro

I'm trying to create a binding to the Linea Pro (it's the barcode scanner they use in the Apple Stores, Lowes) SDK. I'm using [David Sandor's](http://blog.davidsandor.com/post/2011/01/05/iPhone-iTouch-barcode-scanning-Hello-World-application-with-MonoTouch-and-LineaSDK.aspx) bindings as a reference, but the SDK has been updated a few times since January of 2011\.

I have most everything working, except for the **playSound** call, which is used to, well, play a sound on the Linea Pro device.

The .h file from the SDK has the call as follows:

```
-(BOOL)playSound:(int)volume beepData:(int *)data length:(int)length error:(NSError **)error; 
```

I've tried using int[], NSArray, and an IntPtr to the int[], but nothing seems to work.

The last unsuccessful iteration of my binding looks like:

```
[Export ("playSound:beepData:length:")]
void PlaySound (int volume, NSArray data, int length); 
```

Now, this doesn't work at all. Also note that I have no idea what to do with the **error:(NSError **)error** part, either.

I am lacking some serious familiarity with C, so any help would be extremely appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T23:52:39.680

`NSArray`除非Objective-C 代码使用，否则您不能使用`NSArray`，即生成器允许我们将一些ObjC 构造映射到.NET 类型（例如映射`NSString`到`string`），但它不允许您重新定义ObjC 类型。

```
-(BOOL)playSound:(int)volume beepData:(int *)data length:(int)length error:(NSError **)error; 
```

应该是这样的：

```
[Export ("playSound:beepData:length:error:")]
bool PlaySound (int volume, IntPtr data, int length, out NSError error); 
```

您需要将您编组`data`为`IntPtr`.

```
IntPtr data = Marshal.AllocHGlobal (length);
Marshal.WriteInt32 (data1, 0); 
```

然后释放它。

```
Marshal.FreeHGlobal (data); 
```

最好使用调用**内部**绑定的公共辅助方法来完成。您可以通过在其定义中添加属性来创建该`PlaySound`方法。所以它变成：`internal``[Internal]`

```
[Export ("playSound:beepData:length:error:")][Internal]
bool PlaySound (int volume, IntPtr data, int length, out NSError error); 
```

并且您在绑定中包含以下代码（例如 API.cs）：

```
bool PlaySound (int volume, int[] data)
{
    // I assume length is byte-based (check the docs)
    int length = data.Length * 4; 
    IntPtr p = Marshal.AllocHGlobal (length);
    int j = 0;
    for (int i=0; i < length; i+=4)
        Marshal.WriteInt32 (p [j++], i);
    NSError error;
    bool result = PlaySound (volume, p, length, out error);
    // free memory before throwing the exception (if any)
    Marshal.FreeHGlobal (data);
    if (error != null)
       throw new Exception (error.LocalizedDescription);
    return result;
} 
```

注意：完全没有尝试过 :-) 我没有硬件、SDK 或文档。YMMV，但这应该很接近。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:41:06.700

我遇到了同样的麻烦。然而，上面 poupou 提供的帮助足以让我走上正轨。我的 linea pro 设备现在在我要求它时会发出双哔声，所以我认为我应该跟进工作测试代码。原谅任何风格的混乱，这是我在stackoverflow上的第一篇文章......

这是我使用的导出定义。它与上面建议的相同，只是想验证它是否有效。

```
 [Export ("playSound:beepData:length:error:")]
    bool PlaySound (int volume, IntPtr data, int length, out NSError error); 
```

从那里开始，我只需要学习足够多的 c# 就可以搞定编组。（我也是 c# 的新手）如您所见，这只是上面发布的内容的一个修补。非常感谢您为我指明了正确的方向！

```
 public void Beep()
    {
        int[] sound = {2730, 150, 0, 30, 2730, 150};
        PlaySound(100, sound);
    }

    public bool PlaySound(int volume, int[] data)
    {

        // length is byte-based
        int length = data.Length*4;
        IntPtr p = Marshal.AllocHGlobal(length);

        for (int i = 0; i < data.Length; i ++)
        {
            Marshal.WriteInt32(p, i*4, data[i]);
        }

        NSError error;
        bool result = dtDevice.PlaySound(volume, p, length, out error);

        // free memory before throwing the exception (if any)
        Marshal.FreeHGlobal(p);

        if (error != null)
            throw new Exception(error.LocalizedDescription);

        return result;

    } 
```

# php - Drop down select to change a second drop down select automatically

> ID：12442743
> 
> 赞同：0
> 
> 时间：2012-09-15T21:35:22.907
> 
> 标签：php, javascript, html

I have a webpage where I have a form with several areas to input text and two drop down select options countries is the first one and depending in witch country is chosen the second should display the estates for that country to choose. my page connects to my db from where it gets the countries and estates.... I have a table with the country names and one table for each country estates. so all I'm trying to do is making it change the states to choose from automatically depending witch country got selected with out summiting the form since that enters a new entry to another table in my db. I seen that using javascript is the way to go but can't get it to work in my case since I don't want to be sent to another page or summit the form. here is part of my code any help will be greatly appreciated. Thanks

```
 $paissql = "SELECT * FROM Paises_table";
 $paisresult = mysql_query($paissql);

 ?>
 <script language="text/javascript">
 function showMe(str)
 {

 <? $estadosql = "SELECT * FROM ".str."_table";
 $estadoresult = mysql_query($estadosql); ?>
 }
 </script>

 <TABLE BORDER="2" CELLPADDING="2" CELLSPACING="2" ALIGN="CENTER"> 
 <form action="<?php echo $_SERVER['PHP_SELF']?>"  method=POST>
 <TR><th> id </th> <td><?php echo $row_to_edit['id']?></td>
 </TR>
 <TR><th>Nombre:</th><td><input type="TEXT" name=Nombre value="<?php echo      $row_to_edit['Id_Nombre']?>" 
 SIZE="100"></td></TR>        
 </td></TR>
 <TR><th>Pais:</th><td>
 <select name=Pais onchange="showMe(this.value);" > 
 <?
 while($rowp = mysql_fetch_array($paisresult)) {
 $pais = $rowp['Name'];
 ?>
 <option value=<?php echo $pais; ?>
   <?php if($row_to_edit['Pais']==$pais)
 { echo ' selected="true"';} ?>
 ><?php echo $pais; ?>
 </option>
 <?
 }
 ?>
 </select></td></TR>
 <TR><th>Estado:</th><td>
 <select name=Estado >  
 <?

 while($rowe = mysql_fetch_array($estadoresult)) {
 $estado = $rowe['Estado'];
 ?>
 <option value=<?php echo $estado; ?> <?php if($row_to_edit['Estado']==$estado)
 { echo ' selected="true"';} ?>
 ><?php echo $estado; ?></option>
 <?
 }
 ?>
 <TR><th>Ciudad:</th><td><input type="TEXT"  name=Ciudad  value="<?php echo   $row_to_edit['Ciudad']?>" 
 SIZE="100"></td></TR>
 <TR><th>Website:</th><td><input type="TEXT"  name=website  value="<?php echo  $row_to_edit['website']?>" 
 SIZE="100"></td></TR>
 <TR><td> </td>
 <td>
  <input type="HIDDEN"  name="id"  value="<?php echo $edit_id?>">
  Para agregar preciona aqui:
  <input type="SUBMIT"  name="ACTION"  value="AGREGAR">

 </td>
 </TR>
</form>
</TABLE>    
 <BR>
 <BR> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:09:42.140

**我希望您知道使用纯 PHP 进行开发是 90 年代的事情。我希望您知道，使用`mysql_*`就像为黑客敞开大门一样。**

您需要的东西称为 AJAX 和*事件绑定*。基本上，您*观察*第一个下拉列表，当它的状态发生变化（即用户选择一个国家）时，您向您的服务器*发出一个异步请求*，检索该特定国家的区域列表并重建第二个下拉列表。如果您不需要支持大量国家/地区，则在每次请求时下载整个数据库可能是一个很好的权衡：这样您的用户就不必等待 ajax 调用（会有小但可察觉的延迟），但您会浪费带宽。你有选择。

关于 Javascript 部分，您可能希望使用[jQuery](http://jquery.com/)之类的库来观察事件和管理 AJAX，也许与[Knockout.js](http://knockoutjs.com/)一起使用。[这是一个级联下拉列表的教程](http://www.dotnetexpertguide.com/2012/06/cascading-dropdown-knockoutjs-aspnet.html)，即使服务器端的技术是 ASP，而不是 PHP - 但您对 JS 部分感兴趣。

我提出了一个涉及 PHP、jQuery for AJAX 和 Knockout 的快速解决方案。您不需要完全采用它，有成千上万种可能的变化。*至少，您将有一个了解学习内容*的起点。

```
<?php
$countries = array(
    "US" => array("Minnesota", "California", "Washington DC"),
    "China" => array("安徽", "福建", "江苏"),
    "France" => array("Brittany", "Normandy", "Ilé de France"),
    "UK" => array("Galles", "Scotland", "England")
);

if (isset($_REQUEST['json'])) {
    header("Content-Type: application/json; charset=utf-8");
    echo json_encode($countries[$_REQUEST['country']]);
    die();
}

?>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script src="http://github.com/downloads/SteveSanderson/knockout/knockout-2.1.0.js"></script>
<script>
var countries = <?php echo json_encode(array_keys($countries)); ?>;

$(function(){

var Model = function(countries) {
    var self = this;

    self.countries = ko.observableArray(countries);

    self.regions = ko.observableArray([]);

    self.getRegions = function() {
        $.get("?json", {"country": $("#country").val()}, function(regions){
            self.regions(regions);
        });
    }
}

var Countries = new Model(countries);

ko.applyBindings(Countries);
// Initialize the second dropdown after binding
Countries.getRegions();

});
</script>
    <title>Cascade dropdown</title>
</head>
<body>
<form>
<table>
    <tr>
        <td>Country:</td>
        <td>
            <select id="country" name="country" data-bind="options: countries,
                event: {change: getRegions}">
            </select>
        </td>
    <tr>
        <td>Region:</td>
        <td>
            <select name="region" data-bind="options: regions">
            </select>
        </td>
    </tr>
</table>
</form>
</body>
</html> 
```

# debugging - gdb + nasm debug info not being created

> ID：12442747
> 
> 赞同：9
> 
> 时间：2012-09-15T21:36:13.237
> 
> 标签：debugging, assembly, gdb, nasm

I am trying to debug a small .asm file that I wrote in Ubuntu. I am however running into an issue where my symbol table is not being loaded and was looking for some help.

I am compiling my program as follows.

```
nasm -f elf -g -F dwarf bs.asm
gcc -m32 -g bs.o -o bs 
```

which produces the executable bs when I run

```
gdb bs 
```

I get a message that says no debugging symbols and when I try to set a break point by

```
b main 
```

it says function not defined even though its in the file and I can run it using ./bs

I read a couple posts that suggested adding the -F dwarf when assembling but that didn't help if anyone has any insight I would greatly appreciated your input.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-05-29T04:46:52.430

使用以下命令组装您的文件：-

`nasm -f elf -F dwarf -g file.asm`
`ld -m elf_i386 -o file file.o`

然后使用gdb，

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-16T12:20:50.683

*cpowel2 解决了他自己的问题：*

已解决：以防万一其他人遇到同样的问题（网上似乎有很多帖子），我可以通过将文件的部分 .txt 部分更改为部分 .text 和 gdb 来解决问题马上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-09T16:00:28.570

部分 .text

; 在 nasm 中 - 文本部分必须为小写，gdb 才能获取它。

# html - CSS Zebra 对特定表进行条带化 tr:nth-child(even)

> ID：12442750
> 
> 赞同：3
> 
> 时间：2012-09-15T21:36:51.930
> 
> 标签：html, css, html-table, tablerow

我想斑马条纹只选择使用的表。我不想为此使用 jQuery。

```
tbody tr:nth-child(even) td, tbody tr.even td {background:#e5ecf9;} 
```

当我把它放在一个css文件中时，它会影响所有页面上调用相同样式表的所有表。我想做的是有选择地将它应用于特定的表。

我试过这个，但它不起作用。

```
// in stylesheet
.zebra_stripe{
    tbody tr:nth-child(even) td, tbody tr.even td {background:#e5ecf9;}    
}

// in html
<table class="zebra_even">
<colgroup>
    <col class="width_10em" />
    <col class="width_15em" />
</colgroup>
<tr>
    <td>Odd row nice and clear.</td>
    <td>Some Stuff</td>
</tr>
<tr>
    <td>Even row nice and clear but it should be shaded.</td>
    <td>Some Stuff</td>
</tr>
</table> 
```

还有这个：

```
<table>
    <colgroup>
        <col class="width_10em" />
        <col class="width_15em" />
    </colgroup>
    <tbody class="zebra_even"> 
```

样式表可以正常工作，因为它可以正确格式化 html 的其他元素。有人可以帮我解答这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T21:44:04.087

您的代码如下所示：

```
.zebra_stripe{
    tbody tr:nth-child(even) td, tbody tr.even td {background:#e5ecf9;}    
} 
```

这是错误的（显然，或者你不需要问这个问题），但也不是那么遥远。

解决方案是您只需要包含`.zebra_stripe`在现有的 CSS 选择器中。CSS 不支持大括号中的多层选择器，就像您编写它的方式一样。（还有其他方言，如 Less 和 Sass，确实支持这种语法，如果你真的需要它，但在你的情况下，解决方案不需要任何聪明的语法）

```
.zebra_stripe tbody tr:nth-child(even) td, .zebra_stripe tbody tr.even td {
    background:#e5ecf9;
} 
```

这假设您有一个带有类的表`zebra_stripe`：

```
<table class='zebra_stripe'>
    ....
</table> 
```

没有类的表不会被条带化。

顺便说一句，我已经把你的两个选择器都放在那里了，但你不应该同时需要它们。选择`nth-child()`器应该自己做这个伎俩，没有`tr.even`其他选择。`tr.even`不支持的浏览器（`nth-child()`即旧版本的 IE）`even`需要`nth-child()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T21:42:36.097

您的代码可以与 LESS 等 css 解析器引擎一起使用

```
// in stylesheet
.zebra_stripe{
    tbody tr:nth-child(even) td, tbody tr.even td {background:#e5ecf9;}    
} 
```

通常的 css 应该看起来像

```
.zebra_stripe tbody tr:nth-child(even) td,
.zebra_stripe tbody tr.even td {background:#e5ecf9;} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-15T21:44:04.333

```
.zebra-stripe tbody tr:nth-child(even) td, .zebra-stripe tbody tr.even td {background:#e5ecf9;} 
```

# php - 如何从 wamp 的其他位置运行 php？

> ID：12442751
> 
> 赞同：0
> 
> 时间：2012-09-15T21:37:04.830
> 
> 标签：php, webserver, wamp

我想从 WAMP 更改我的 php 代码在 localhost 上运行的位置。

我当前的位置在`C:\wamp`，我想将其更改为`E:\server\`

怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T21:58:38.167

你将不得不改变`httpd.conf`并`c:\wamp\bin\apache\apache-xxx.xx\`寻找`c:/wamp`路径。适当地改变它。在这种情况下`e:/server/`。保存文件，然后重新启动 apache，您应该一切顺利。

# c++ - Project Euler 138

> ID：12442754
> 
> 赞同：-1
> 
> 时间：2012-09-15T21:40:01.307
> 
> 标签：c++

**[Problem 138](http://projecteuler.net/problem=138)**

Basically, its asking for isosceles triangles where the height of the triangle is equal to base +- 1\. After doing some math on paper, I use either of the following two equations to calculate the length *L* given *b*:

L = sqrt(1.25b² + 2b + 1), substituted h with b + 1

or

L = sqrt(1.25b² - 2b + 1), substitued h with b - 1

My following code calculates *L* from *b* using both equations. I sum up all the *L* values but it keeps giving me the incorrect answer.

```
#include <iostream>
#include <cmath>

int main(int argc, char* argv[]) {
  int result = 0;
  int count = 0;

  for (int b = 1; count < 12; b++) {
    double x;
    double L = std::sqrt(1.25*b*b + 2*b + 1);

    if (std::modf(L, &x) == 0.0) {
      std::cout << count << ": b=" << b << ", L=" << (int)L << "\n";
      result = result + L;
      count++;
    } 

    L = std::sqrt(1.25*b*b - 2*b + 1);
    if (count != 12 && std::modf(L, &x) == 0.0) {
      std::cout << count << ": b=" << b << ", L=" << (int)L << "\n";
      result = result + L;
      count++;
    }
  }

  std::cout << "Solution: " << result;
  std::cin.get();
  return 0;
} 
```

What am I doing incorrectly? I would like a hint not a solution... I feel like this should be giving me the correct answer.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T22:09:46.317

这是数值精度不足的情况。我只是复制了您的代码并根据我使用的是 64 位 ( `double`) 还是 80 位 ( `long double`) 算术得到不同的答案。当然，出于同样的原因，80 位的答案可能仍然是错误的……您必须使用精确（整数）算术来 100% 确定（并避免溢出）。

# c# - Does a bindable property instantiate a popup control?

> ID：12442758
> 
> 赞同：1
> 
> 时间：2012-09-15T21:40:47.950
> 
> 标签：c#, xaml, controls, windows-runtime, inotifypropertychanged

I have got a MainPage and a DetailPage. Both of them use a static class to receive their data. This class called DataService implements INotifyPropertyChanged interface and it implements a property called "IsLoading". Whenever a method within the DataService is invoked I set IsLoading to true. The DataService itself is contained in a static class called Globals which instantiances the DataService one (I know, I'm going to implement this with a singleton pattern)

On the MainPage their is a popup:

```
<Page.Resources>
  <Common:DataService x:Key="DataService" />
</Page.Resources>

<Popup IsOpen="{Binding IsLoading}" DataContext="{StaticResource DataService}">...</PopUp> 
```

On the MainPage everything works fine. If the DataService requests something from the webservice, the popup is shown. If it is done, the popup hides.

If I change with `Frame.Navigate(typeof(DetailPage));` and the DetailPage begins to invoke some methods of the dataservice, the popup is shown too, but not on the same page on as the main page. It will be display on the left top corner.

Funny part about that is: If I go back to the MainPage and it loads data, I'll get two popups. If I go again to the DetailPage, a **third** popup will be there and so on. It seems that this popup gets instantiated?!

Next point: When setting the DataContext of the Popup in `OnNavigatingTo` and removing the DataContext in `OnNavigatingFrom` I'll stay with the popup I want and no second one gets instantiated.

What goes wrong here?

# wordpress - Allowing specific Twitter users to view Wordpress blog

> ID：12442759
> 
> 赞同：3
> 
> 时间：2012-09-15T21:40:52.700
> 
> 标签：wordpress, authentication, twitter, oauth

I've got a simple requirement, but can't for the life of me figure out how to do it: I'd like to allow specific Twitter users to view a Wordpress blog. These users are all followers of a [locked] Twitter account.

I presume I'd need to use oAuth but all plugins and tutorials I've found are generic - ie you login with Twitter, and that's it. I'd like to go an additional step and check that the user is following the locked account too.

Doable?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:36:45.650

1.  创建与您的受保护帐户关联的 Twitter 应用程序。（我会给你链接，但我没有足够的 SO 点在帖子中有超过 2 个链接。所以只需谷歌这一步）

2.  为您的受保护页面创建自定义 Wordpress 页面模板。请参阅[http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

以下步骤应放在您的页面模板代码中：

1.  一旦用户使用您提到的 Twitter OAuth 插件登录，找到当前用户的 Twitter ID，它几乎肯定会保存在 $_SESSION 全局某个地方。

2.  使用 Twitter API 的 PHP 包装器（例如[https://github.com/abraham/twitteroauth/blob/master/DOCUMENTATION](https://github.com/abraham/twitteroauth/blob/master/DOCUMENTATION)）调用 Twitter API 的`GET /friends/ids`方法，并将 screen_name 设置为*您的*Twitter 句柄。您将需要在步骤 1 中提供给您的 CONSUMER KEY 和 SECRET。这将为您提供关注者列表。

3.  检查登录用户的 id 是否在上一步返回的用户 id 列表中。如果是，则调用`the_content()`以呈现页面内容，如果不是，则不要进行该调用。

4.  牺牲 3 只以谷类喂养的雄性绵羊、2 只黑夜生物和 1 只黑色无腿昆虫。

# c# - 确定现有的路径目录

> ID：12442760
> 
> 赞同：4
> 
> 时间：2012-09-15T21:41:05.783
> 
> 标签：c#, .net, directory, fileinfo

假设我有一个不完整的路径字符串：`C:\dir\temp\f` 并且我有以下文件系统：

```
C:\dir\
c:\dir\temp\
c:\dir\temp\foobar\
c:\dir\temp\foobar2\
c:\dir\temp\bar 
```

我想确定目录的哪一部分是最匹配的。在此示例中，这是`c:\dir\temp\foobar\`因为它以路径字符串开头（并且`foobar`比 匹配更好`foobar2`）。我怎样才能有效地获得可用路径？我是否必须拆分不完整的路径字符串`/`并测试文件夹是否可用或者是否有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T21:52:05.313

基本上，您想要做的是类似`dir C:\dir\temp\f*`. 在 .Net 中，您可以使用 . 来执行此操作[`Directory.GetDirectories()`](http://msdn.microsoft.com/en-us/library/6ff71z1w.aspx)，但它需要您将完整路径拆分为路径和模式。为此，您可以使用`Path`类中的方法。因此，您的代码可能类似于：

```
Directory.GetDirectories(
    Path.GetDirectoryName(path), Path.GetFileName(path) + "*") 
```

这将返回所有匹配目录的集合，因此您必须自己找出最匹配的目录。

# hadoop - 如何强制同步hdfs复制？

> ID：12442764
> 
> 赞同：3
> 
> 时间：2012-09-15T21:42:32.707
> 
> 标签：hadoop, hdfs

我编写了一个简单的程序，将数据放入 HDFS。我通过配置对象将 dfs.replication 设置为 3，并针对伪分布式 hdfs 集群运行该程序。我希望得到一个异常，因为复制因子是 3 并且只有一个数据节点；但程序成功完成了执行。

这是一种了解我的数据处于复制不足状态的方法吗？我认为这与 dfs.replication.min 有关，但是当我也将其更改为 3 时（在程序配置对象中），写入仍然成功并且我没有得到任何异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T14:47:43.730

我已经完成了一些测试并找出了原因。

首先，当您创建文件时，其复制因子必须高于或等于 dfs.replication.min。HDFS 规定到 dfs.replication.min 节点的复制是同步的，对其余节点 (dfs.replication - dfs.replication.min) 的复制是异步处理的。

由于dfs.replication.min的默认设置是1，所以我成功将dfs.replication = 3的文件写入了一个节点的hdfs集群。

默认复制因子 (dfs.replication) 设置为 3，但可以通过配置对象根据请求进行更改。可悲的是，您无法根据请求更改 dfs.replication.min，因此如果将其设置为较低层，则无法提高可靠性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T16:41:28.927

如果要强制同步 hdfs 复制，请使用此命令。hadoop -setrep [-R] [-w] ：设置文件的复制级别。-R 标志请求整个树的复制级别的递归更改。

# django - Django 模型南 0.7.6 迁移问题：表中的任何更改与另一个字段的默认值百分比

> ID：12442768
> 
> 赞同：1
> 
> 时间：2012-09-15T21:42:58.667
> 
> 标签：django, formatting, default, django-south

在我的数据库模型中添加一个包含日期字段格式的字段后，我遇到了问题。

像这样：

```
date_format = models.CharField(max_length=32, default='%B %Y') 
```

然而，在同一次迁移中，有一些具有默认值的布尔值。深入研究问题，并重建测试数据库......

问题在于表中的任何迁移都具有带有百分比符号的默认值。所以不是这个字段本身的迁移，而是任何迁移到同一个表（见我的第二个答案）

添加这样的字段：

```
show_category_name  = models.BooleanField(default=True) 
```

with auto schememigration 给出了一个带有这一行的迁移文件：

```
 # -*- coding: utf-8 -*-
import datetime
from south.db import db
from south.v2 import SchemaMigration
from django.db import models

class Migration(SchemaMigration):

    def forwards(self, orm):
        # Adding field 'NewsItemCategory.show_category_name'
        db.add_column('iamweb_newsitemcategory', 'show_category_name',
                      self.gf('django.db.models.fields.BooleanField')(default=True),
                      keep_default=False) 
```

给出了这个问题：

```
 bin/django migrate iamwebdjango.db.backends DEBUG (0.006) SELECT "south_migrationhistory"."id", "south_migrationhistory"."app_name", "south_migrationhistory"."migration", "south_migrationhistory"."applied" FROM "south_migrationhistory" WHERE "south_migrationhistory"."applied" IS NOT NULL ORDER BY "south_migrationhistory"."applied" ASC; args=()
Running migrations for iamweb:
 - Migrating forwards to 0020_auto__add_field_newsitemcategory_show_category_name__add_field_weblink.
 > iamweb:0020_auto__add_field_newsitemcategory_show_category_name__add_field_weblink
django.db.backends DEBUG (0.277) CREATE TABLE ROLLBACK_TEST (X INT); args=()
django.db.backends DEBUG (0.008) INSERT INTO ROLLBACK_TEST (X) VALUES (8); args=()
django.db.backends DEBUG (0.001) SELECT COUNT(X) FROM ROLLBACK_TEST; args=()
django.db.backends DEBUG (0.273) DROP TABLE ROLLBACK_TEST; args=()
django.db.backends DEBUG (0.177) CREATE TABLE STDDEV_TEST (X INT); args=()
django.db.backends DEBUG (0.000) SELECT STDDEV(*) FROM STDDEV_TEST; args=()
django.db.backends DEBUG (0.160) DROP TABLE STDDEV_TEST; args=()
django.db.backends DEBUG (0.151) CREATE TABLE DDL_TRANSACTION_TEST (X INT); args=()
django.db.backends DEBUG (0.000) CREATE TABLE DDL_TRANSACTION_TEST (X INT); args=()
django.db.backends DEBUG (0.155) DROP TABLE DDL_TRANSACTION_TEST; args=()
django.db.backends DEBUG (0.000) PRAGMA table_info("iamweb_newsitemcategory"); args=()
django.db.backends DEBUG (0.000) PRAGMA index_list("iamweb_newsitemcategory"); args=()
django.db.backends DEBUG (0.000) PRAGMA index_info("sqlite_autoindex_iamweb_newsitemcategory_1"); args=()
django.db.backends DEBUG (0.000) PRAGMA index_list("iamweb_newsitemcategory"); args=()
django.db.backends DEBUG (0.000) PRAGMA index_info("sqlite_autoindex_iamweb_newsitemcategory_1"); args=()
django.db.backends DEBUG (0.000) PRAGMA table_info("iamweb_newsitemcategory"); args=()
south DEBUG execute "CREATE TABLE "_south_new_iamweb_newsitemcategory" ("date_format" varchar(32) DEFAULT '%B %Y', "show_category_name" bool NOT NULL DEFAULT 1, "id" integer PRIMARY KEY, "menu_index" integer NOT NULL UNIQUE, "name" varchar(64) NOT NULL)" with params "[]"
 ! Error found during real run of migration! Aborting.

 ! Since you have a database that does not support running
 ! schema-altering statements in transactions, we have had 
 ! to leave it in an interim state between migrations.

! You *might* be able to recover with:
 ! The South developers regret this has happened, and would
 ! like to gently persuade you to consider a slightly
 ! easier-to-deal-with DBMS (one that supports DDL transactions)
 ! NOTE: The error which caused the migration to fail is further up.
Error in migration: iamweb:0020_auto__add_field_newsitemcategory_show_category_name__add_field_weblink
Traceback (most recent call last):
  File "bin/django", line 33, in <module>
    djangorecipe.manage.main('palmrif.developmentsettings')
  File "/media/storage/django/sites/palmrif/eggs/djangorecipe-0.20-py2.7.egg/djangorecipe/manage.py", line 16, in main
    management.execute_manager(mod)
  File "/media/storage/django/sites/palmrif/parts/django/django/core/management/__init__.py", line 438, in execute_manager
    utility.execute()
  File "/media/storage/django/sites/palmrif/parts/django/django/core/management/__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/media/storage/django/sites/palmrif/parts/django/django/core/management/base.py", line 191, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/media/storage/django/sites/palmrif/parts/django/django/core/management/base.py", line 220, in execute
    output = self.handle(*args, **options)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/management/commands/migrate.py", line 108, in handle
    ignore_ghosts = ignore_ghosts,
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/__init__.py", line 213, in migrate_app
    success = migrator.migrate_many(target, workplan, database)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/migrators.py", line 235, in migrate_many
    result = migrator.__class__.migrate_many(migrator, target, migrations, database)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/migrators.py", line 310, in migrate_many
    result = self.migrate(migration, database)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/migrators.py", line 133, in migrate
    result = self.run(migration)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/migrators.py", line 107, in run
    return self.run_migration(migration)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/migrators.py", line 81, in run_migration
    migration_function()
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/migration/migrators.py", line 57, in <lambda>
    return (lambda: direction(orm))
  File "/media/storage/django/sites/palmrif/local_checkouts_dev/iamweb/iamweb/migrations/0020_auto__add_field_newsitemcategory_show_category_name__add_field_weblink.py", line 14, in forwards
    keep_default=False)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/sqlite3.py", line 31, in add_column
    field.column: self._column_sql_for_create(table_name, name, field, False),
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/generic.py", line 44, in _cache_clear
    return func(self, table, *args, **opts)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/sqlite3.py", line 103, in _remake_table
    ", ".join(["%s %s" % (self.quote_name(cname), ctype) for cname, ctype in definitions.items()]),
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/generic.py", line 273, in execute
    cursor.execute(sql, params)
  File "/media/storage/django/sites/palmrif/parts/django/django/db/backends/util.py", line 38, in execute
    sql = self.db.ops.last_executed_query(self.cursor, sql, params)
  File "/media/storage/django/sites/palmrif/parts/django/django/db/backends/__init__.py", line 505, in last_executed_query
    return smart_unicode(sql) % u_params
TypeError: not enough arguments for format string 
```

我正在使用 South 0.7.6。奇怪的是，这个版本应该已经修复了这个错误，请参阅：[Release notes 0.7.6。错误修复 sqlite 中的默认布尔值](http://south.readthedocs.org/en/latest/releasenotes/0.7.6.html)

使用sqlite3，python 2.7.2，django 1.3.1（顺便说一下，在生产中使用mySql，但是sqlite中的测试数据库很方便）

请注意，问题是指迁移文件中的第 14 行，即这一行：

```
 db.add_column('iamweb_newsitemcategory', 'show_category_name',
                  self.gf('django.db.models.fields.BooleanField')(default=True),
                  keep_default=False) 
```

没有足够的论据......对于初学者来说很好：我没有创建这条线，South 做了:)

堆栈跟踪有点混乱，因为调试行的最后一行（在堆栈跟踪之前是：

```
south DEBUG execute "CREATE TABLE "_south_new_iamweb_newsitemcategory" ("date_format" varchar(32) DEFAULT '%B %Y', "show_category_name" bool NOT NULL DEFAULT 1, "id" integer PRIMARY KEY, "menu_index" integer NOT NULL UNIQUE, "name" varchar(64) NOT NULL)" with params "[]" 
```

所以它可能与 South 仍然想要解析字符串有关，因为这个执行命令中的 '%B %Y'....

经过 4 天的努力解决这个问题（当然不是全职）我开始怀疑南方的方式....但是，没有找到更好的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T18:44:58.950

我刚刚在南方邮件列表上回答了。总结一下：布尔值是无辜的，百分比是有罪的，Sqlite 是一个玩具，因此它的南后端有点疯狂，显然有一个错误。即将推出的新版 South 应该避免在数据库中存储默认值，这可能会解决您的问题（至少对于测试而言）。

票 #317 无关紧要。就目前而言，Ticket #1192 应该由当前在 pull request 中的代码修复（或者你可以从我的 fork 中选择它，[https://bitbucket.org/shaib/south](https://bitbucket.org/shaib/south)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T13:32:57.833

啊，问题可能不在 '%B %Y' 默认值中。（因此我对问题和标题进行了编辑） sqlite 中的默认布尔值似乎存在一些问题。请参阅我在问题中的编辑。并且布尔值不支持 True 和 false 的默认值。见[南票](http://south.aeracode.org/ticket/600)

迁移文件中建议的解决方案是：

```
 if db.backend_name == "sqlite3":
   default = 1
else:
   default = True
db.add_column('node_entry', 'visible', self.gf('django.db.models.fields.BooleanField')(default=default), keep_default=False) 
```

但这不起作用，进一步阅读，它应该在我正在使用的南方版本中得到解决......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T08:59:00.497

很确定问题出在默认值“%B %Y”中。那个迁移顺利，但在此之后新的迁移出错了。我发现是因为我有 3 个布尔值字段，我希望默认为真。其中 2 个在一个表格中，这个百分比在另一个字段中。我标记了这 2 个迁移，唯一剩下的一个没问题。

问题在于用百分号重新创建表格

见曲目：

```
 File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/sqlite3.py", line 31, in add_column
    field.column: self._column_sql_for_create(table_name, name, field, False),
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/generic.py", line 44, in _cache_clear
    return func(self, table, *args, **opts)
  File "/media/storage/django/sites/palmrif/eggs/South-0.7.6-py2.7.egg/south/db/sqlite3.py", line 103, in _remake_table
    ", ".join(["%s %s" % (self.quote_name(cname), ctype) for cname, ctype in definitions.items()]), 
```

所以我想我会尝试重新打开南票并将他们推荐给这个网站。并更改这张票的标题。

我在票上添加了一条评论：http: [//south.aeracode.org/ticket/317](http://south.aeracode.org/ticket/317)

# c# - c# - MS Skydrive - 获取有关用户帐户的信息。

> ID：12442769
> 
> 赞同：0
> 
> 时间：2012-09-15T21:43:06.910
> 
> 标签：c#, onedrive

我正在创建 ac# winform 应用程序，我希望能够显示用户 MS SkyDrive 信息，特别是他们 SkyDrive 上的可用空间和已用空间。我在 Windows 7 上，我正在尝试这样做，但在用户进行身份验证后，我很难获得访问令牌。到目前为止，这就是我能够拼凑起来的所有内容：

```
public void getInfo()
    {

        var uri = "https://login.live.com/oauth20_authorize.srf";
        var authorizeUri = new StringBuilder(uri);

        authorizeUri.AppendFormat("?client_id={0}&", "<client id>");
        authorizeUri.AppendFormat("scope={0}&", "wl.signin");
        authorizeUri.AppendFormat("response_type={0}&", "token");
        authorizeUri.AppendFormat("redirect_uri={0}", HttpUtility.UrlEncode("<redirect domain>"));

        var startInfo = new ProcessStartInfo();
        startInfo.FileName = authorizeUri.ToString();
        Process.Start(startInfo);

    } 
```

这会弹出一个浏览器并允许用户授予应用程序权限。但是，它通过重定向到应用程序“redirct url”并在 url 中包含访问令牌来返回访问令牌。这真的对我没有帮助，因为我的应用程序是桌面应用程序。我一直在阅读 Microsoft 的文档，除了 Windows 8 和 Windows 手机的信息外，找不到任何其他信息。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T21:46:04.053

你可以试试：[http ://skydriveapiclient.codeplex.com/](http://skydriveapiclient.codeplex.com/)

我使用它的原因与您想使用它的原因相同。对我来说效果很好。有一个使用此[http://skydrivesync.codeplex.com/的示例应用程序](http://skydrivesync.codeplex.com/)

很抱歉我可以给你提供代码，因为我只用它来测试它被删除了

# r - How to plot grouped concurrent time line in gnuplot or R?

> ID：12442774
> 
> 赞同：0
> 
> 时间：2012-09-15T21:45:01.493
> 
> 标签：r, gnuplot

I have a dataset like:

```
 xStart  xEnd    yStart  yEnd
a   100     200     70      90  
b   40      120     60      200 
```

I need to plot a time graph grouped by "a" and "b" and show that a event starts at 100 and ends at 200 for "a", and other event starts at 70 and ends at 90 for "a". How can I do this with gnuplot or R??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T22:41:48.683

```
# I'm using the example data you gave.
# but you'd be reading in a csv file or something similar.

df <- read.table(textConnection("    xStart  xEnd    yStart  yEnd
a   100     200     70      90  
b   40      120     60      200"), header = T)

# add the row names as a column
df$cols <- rownames(df)

> df
  xStart xEnd yStart yEnd cols
a    100  200     70   90    a
b     40  120     60  200    b

library(plyr)
# instead of gnuplot (which I don't use), I'm using ggplot2
# see http://had.co.nz for more info about the package.
# below, the function ddply (in plyr) splits the data by cols (a or b)
# then plots those data and returns it to a list named plots.
# the length of plots will be equal to the number of unique groups in your data
library(ggplot2)
# change the plot type below to whatever you like.
plots <- dlply(df, .(cols), function(x){
    data <- data.frame(x1 = as.numeric(x[, 1:2]), y1 = as.numeric(x[, 3:4]))
    ggplot(data, aes(x1, y1)) + geom_point() + ggtitle(unique(x$cols))
    })

plots[1]
# to see the first plot
plots[2]
# to see the second one
length(plots) # to see how many plots were generated 
```

# php - Converting Array data to width PHP

> ID：12442777
> 
> 赞同：1
> 
> 时间：2012-09-15T21:45:33.303
> 
> 标签：php, recursion, multidimensional-array, categories, hierarchical-data

### In MySQL my table appears like this:

In MySQL my table appears like this:

[http://sqlfiddle.com/#!2/76717](http://sqlfiddle.com/#!2/76717).

```
CREATE TABLE IF NOT EXISTS `tbl_category` (
  `id` int(6) NOT NULL auto_increment,
  `parent_id` int(4) NOT NULL default '0',
  `name` varchar(255) NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `parent_id` (`parent_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8;

INSERT INTO `tbl_category` (`id`, `parent_id`, `name`) VALUES
(1, 0, 'Category 1'),
(2, 0, 'Category 2'),
(3, 0, 'Category 3'),
(4, 1, 'Category 1\. 1'),
(5, 1, 'Category 1\. 2'),
(6, 1, 'Category 1\. 3'),
(7, 4, 'Category 1\. 1\. 1'),
(8, 4, 'Category 1\. 1\. 2'),
(9, 4, 'Category 1\. 1\. 3'); 
```

### My array

My array

```
$arrCategories = array(
    array("id" => 1, "parent_id" => 0, "name" => "Category 1", "children" => array()
                array("id" => 4, "parent_id" => 1, "name" => "Category 1\. 1", "children" => array()
                         array("id" => 7, "parent_id" => 4, "name" => "Category 1\. 1\. 1", "children" => array()),
                         array("id" => 8, "parent_id" => 4, "name" => "Category 1\. 1\. 2", "children" => array()),
                         array("id" => 9, "parent_id" => 4, "name" => "Category 1\. 1\. 3", "children" => array())
                                ),
                array("id" => 5, "parent_id" => 1, "name" => "Category 1\. 2", "children" => array()),
                array("id" => 6, "parent_id" => 1, "name" => "Category 1\. 3", "children" => array())        
        ),
    array("id" => 2, "parent_id" => 0, "name" => "Category 2", "children" => array()),
    array("id" => 3, "parent_id" => 0, "name" => "Category 3", "children" => array())
); 
```

### The array output

The array output

```
Array
(
    [id] => 1
    [parent_id] => 0
    [name] => Category 1
    [children] => Array
        (
            [4] => Array
                (
                    [id] => 4
                    [parent_id] => 1
                    [name] => Category 1\. 1
                    [children] => Array
                        (
                            [7] => Array
                                (
                                    [id] => 7
                                    [parent_id] => 4
                                    [name] => Category 1\. 1\. 1
                                    [children] => Array
                                        (
                                        )

                                )

                            [8] => Array
                                (
                                    [id] => 8
                                    [parent_id] => 4
                                    [name] => Category 1\. 1\. 2
                                    [children] => Array
                                        (
                                        )

                                )

                            [9] => Array
                                (
                                    [id] => 9
                                    [parent_id] => 4
                                    [name] => Category 1\. 1\. 3
                                    [children] => Array
                                        (
                                        )

                                )

                        )

                )

            [5] => Array
                (
                    [id] => 5
                    [parent_id] => 1
                    [name] => Category 1\. 2
                    [children] => Array
                        (
                        )

                )

            [6] => Array
                (
                    [id] => 6
                    [parent_id] => 1
                    [name] => Category 1\. 3
                    [children] => Array
                        (
                        )

                )

        )

)
Array
(
    [id] => 2
    [parent_id] => 0
    [name] => Category 2
    [children] => Array
        (
        )

)
Array
(
    [id] => 3
    [parent_id] => 0
    [name] => Category 3
    [children] => Array
        (
        )

) 
```

### How do I make it width PHP ?

How do I make it width PHP ?

```
<ul>
 <li>Category 1
  <ul>
   <li>Category 1\. 1
    <ul>
     <li>Category 1\. 1\. 1</li>
     <li>Category 1\. 1\. 2</li>
     <li>Category 1\. 1\. 3</li>
    </ul>
   </li>
   <li>Category 1\. 2</li>
   <li>Category 1\. 3</li>
  </ul>
 </li>
 <li>Category 2</li>
 <li>Category 3</li>
</ul> 
```

### This is does not work correctly

This is does not work correctly

```
<?php
echo "    <ul>\n";
foreach ($categories as $category) {
echo "     <li>".$category['ad'];

if ($category['children']) {
echo "      <ul>\n";
foreach ($category['children'] as $child) {
echo "       <li>".$child['ad']."</li>\n";
}
echo "      </ul>\n";
}
echo "     </li>\n";
}
echo "    </ul>\n";
?> 
```

* * *

Thanks works now for me thats functions... [http://ideone.com/u2GNV](http://ideone.com/u2GNV)

But i think not valid ul and li tags...

[http://ideone.com/u2GNV](http://ideone.com/u2GNV) results for me

```
<ul>
 <li>Category 1
  <ul>
   <li>Category 1\. 1
    <ul>
     <li>Category 1\. 1\. 1</li>
    </ul>
    <ul>
     <li>Category 1\. 1\. 2</li>
    </ul>
    <ul>
     <li>Category 1\. 1\. 3</li>
    </ul>
   </li>
  </ul>

  <ul>
   <li>Category 1\. 2</li>
  </ul>

  <ul>
   <li>Category  1\. 3</li>
  </ul>
 </li>
</ul>

<ul>
 <li>Category 2</li>
</ul>

<ul>
 <li>Category 3</li>
</ul> 
```

i think valid w3 code

```
<ul>
 <li>Category 1
  <ul>
   <li>Category 1\. 1
    <ul>
     <li>Category 1\. 1\. 1</li>
     <li>Category 1\. 1\. 2</li>
     <li>Category 1\. 1\. 3</li>
    </ul>
   </li>
   <li>Category 1\. 2</li>
   <li>Category 1\. 3</li>
  </ul>
 </li>
 <li>Category 2</li>
 <li>Category 3</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T22:28:22.023

您可以创建一个函数来将所有数组解析为一个`menu like`块并使用递归：

对于该数组：

```
function printMenu($array){
    foreach($array as $item){
        if(is_array($item) && isset($item['name'])){
            echo "<ul>\n";

                if(is_array($item['children'])){
                    echo "<li>".$item['name'];
                    printMenu($item);
                    echo "</li>\n";
                } else {
                    echo "<li>".$item['name']."</li>\n";
                }

            echo "</ul>\n\n";
        }
    }
} 
```

来自 mysql 资源（基于您的表）：

```
$db = new PDO('mysql:host=localhost;dbname=test', 'root', '', array(PDO::ATTR_EMULATE_PREPARES => false, PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION));

function printMenu($array){
    foreach($array as $item){
        if(is_array($item) && isset($item['name'])){
            echo "<ul>\n";
                if(getChildren($item['id'], false)){
                    echo "<li>".$item['name'];
                    printMenu(getChildren($item['id'], true));
                    echo "</li>\n";
                } else {
                    echo "<li>".$item['name']."</li>\n";
                }

            echo "</ul>\n\n";
        }
    }
}

function getChildren($id, $return = false){
    global $db;
    $stmt = $db->prepare("SELECT * FROM `tbl_category` WHERE `parent_id` = :parent_id");
    $stmt->execute(array(':parent_id' => $id));
    $num = $stmt->rowCount();
    if($num){
        if($return){
            $row = $stmt->fetchAll(PDO::FETCH_ASSOC);
            return $row;
        }
        return true;
    }
    return false;
}

$query = "SELECT * FROM `tbl_category` WHERE `parent_id` = 0";
$stmt = $db->query($query);
$row = $stmt->fetchAll(PDO::FETCH_ASSOC);
printMenu($row); 
```

结果：

*   第一类
    *   类别 1\. 1
        *   类别 1\. 1\. 1
        *   类别 1\. 1\. 2
        *   类别 1\. 1\. 3
    *   类别 1\. 2
    *   类别 1\. 3

*   第 2 类

*   第 3 类

# algorithm - Algorithm of bidirectional graph

> ID：12442779
> 
> 赞同：0
> 
> 时间：2012-09-15T21:45:57.947
> 
> 标签：algorithm, graph-theory

I've got a graph (or unrooted tree) of `N nodes` and `N-1 connections`. Each connection has a `distance of 1`.

How can i find a node **v** that has the maximum distance between **v** and a set of nodes **E{}**, when **v** can be a node in **E**?

**Constraints:**

*   (N <= 50000)
*   Number of node in E <= N
*   Time limit 1 s

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:45:38.213

我会使用从节点集开始的[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)`E`。 `v`然后将是您访问的最后一个节点。

**编辑：**

```
1-2-3-4    E={1,4,5}
    |
    5 
```

好的，现在我了解您的指标了。`E`对于每条边，您想要计算从该边到该边任一侧的元素的距离总和。您可以通过计算从叶子到根的值来做到这一点（稍微挥手）。

然后，您可以为每个节点计算每个传入边上的这些值的总和。选择总和最大的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T13:13:16.197

这是一个简单的算法来计算每个节点到 的每个顶点的距离`E`。

该图是一棵树，最初是无根的。

1.  任意选择一个节点作为根
2.  遍历树，并为每个节点计算其子树中的顶点数`E`（我们可以调用此函数`e(node)`）。

    *   例如，如果您的树如下（其中括号显示 中的顶点`E={C,D,I}`），您将计算如下所示的数字：

        ```
        vertices in the graph:              e(v)

                  A                          3
                 / \                        / \
                B  (C)                     1   2
               / \   \                    / \   \
             (D)  F   G                  1   0   1
             /         \                /         \
            H          (I)             0           1 
        ```

3.  还要计算根节点与集合的距离`E`（调用此函数`d(v)`）。我们看到`d(A)=6`，并且在步骤 2 中遍历树时很容易计算出来。
4.  然后，再次遍历树，计算每个节点的距离函数，公式为`d(v) = d(parent(v)) + size(E) - 2*e(v)`。这将花费`O(n)`所有节点的时间，因为它是每个节点的恒定时间。

    该公式是通过考虑当您从父级移动到子级时得出的，与节点集的距离`E`变化如下：

    *   `E` *不在*子树的子树中的每个节点的距离增加 1
    *   每个节点的距离减少 1，`E`其中每个节点也位于子节点的子树中

    **例子：**

    *   `d(B) = d(A) + size(E) - 2*e(B) = 6 + 3 - 2 = 7`,
    *   `d(D) = d(B) + size(E) - 2*e(D) = 7 + 3 - 2 = 8`,
    *   `d(H) = d(D) + size(E) - 2*e(H) = 8 + 3 - 0 = 11`,
    *   `d(F) = d(B) + size(E) - 2*e(F) = 7 + 3 - 0 = 10`
5.  然后只需搜索`v`具有最高的节点`d(v)`，您可以通过再次遍历树来做到这一点。您也可以在步骤 4 中遍历树的同时执行此操作。

该算法只需要对树进行 2 次不同的遍历，每次都需要`O(n)`时间。因此，整体算法复杂度为`O(n)`。

请注意，该算法之所以如此高效，是因为该图是一**棵树**。大多数最短路径算法适用于一般图。树要简单得多，因为任何一对顶点之间只有一条唯一路径。因此，不需要最短路径算法中通常需要的策略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T23:33:34.577

如果图形是非循环的，您可以将边权重设为 -1 并运行 Floyd-Warshall。这将为您提供所有对最长的路径。然后对于图中的每个节点，取到 E 中节点的平均距离。

否则，我相信看一个 NP-Complete 问题，试图在任意图中找到最长的路径。

# ruby-on-rails - 在视图中显示相等的项目

> ID：12442781
> 
> 赞同：0
> 
> 时间：2012-09-15T21:46:09.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我的模型：

```
class House < ActiveRecord::Base

    has_many :category_join_table
    has_many :categories, :through => :category_join_table

end 
```

类别例如“勒克斯”、“适合两人”等。

```
class CategoryJoinTable < ActiveRecord::Base
    belongs_to :house
    belongs_to :category
end 
```

我的想法是在房屋财产展示页面上显示属于同一类别/类别的其他房屋。我可以在控制台中执行此操作：

```
a = Category.find(4)
a.houses 
```

并获得属于该类别的正确房屋。但是我怎样才能在控制器/模型逻辑中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:38:15.740

我会亲自在 House 模型中创建一个实例方法：

```
def related_houses
  House.joins(:categories).where("categories.id IN (?) AND houses.id != ?", self.categories, self.id)
end 
```

你基本上可以找到所有至少有一个共享类别的房子，除了当前的房子。

然后在视图中，只需循环您的房屋实例：

```
<% @house.related_houses.each do |related_house| %>
  <!-- OUTPUT related_house stuff HERE -->
<% end %> 
```

你应该完成了:) 如果你愿意，你也可以为相关房屋添加一个限制，如果需要，可以将其作为参数从视图中传递（这里默认为 5）：

```
def related_houses(limit = 5)
  House.joins(:categories).where("categories.id IN (?) AND houses.id != ?", self.categories, self.id).limit(limit)
end 
```

编辑的答案，没有看到你的房子首先有很多类别

# php - Mysqli 查询数组数据操作

> ID：12442782
> 
> 赞同：0
> 
> 时间：2012-09-15T21:46:15.747
> 
> 标签：php, sql, mysqli

我有一个 php 页面，它调用来自 sql 数据库的数据并将其显示在表上。

```
while($row = mysqli_fetch_array($result)) {
    echo '<tr>';
    echo "<td style='border:1px solid black;'>{$row['first_name']}</td>";
    echo "<td style='border:1px solid black;'>{$row['last_name']}</td>";
    echo "<td style='border:1px solid black;'><a href=\"javascript:win1({$row['formID']})\">Activities<a/></td>";
    echo "<td style='border:1px solid black;'><a href=\"javascript:win2({$row['formID']})\">Awards<a/></td>";
    echo "<td style='border:1px solid black;'>{$row['total']}</td>"; 
    echo "<td style='border:1px solid black;'>{$row['date']}</td>";
    echo "<td style='border:1px solid black;'>{$row['IP']}</td>";
    echo '</tr>';
}
echo '</table>'; 
```

是我当前的代码，但我想知道是否有办法获取某个数字行，例如获取结果中的第 32 行，而不是从 0 获取到末尾？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T21:48:57.310

`LIMIT`在 SQL 查询中使用像`SELECT * FROM table LIMIT x, n`这样将从第 x+1 行开始并选择 n 行...

[http://php.about.com/od/mysqlcommands/g/Limit_sql.htm](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T21:51:00.450

在您的`SELECT`声明中，添加一个[`LIMIT`](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)像这样的子句：`SELECT * FROM my_table WHERE ... LIMIT 31, 1`. 这将只选择表中的第 32 行。您可以替换`31, 1`为您想要的任何范围。

如果您添加一个`ORDER BY`子句这样行总是以相同的顺序出现，则此方法效果最佳。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T21:53:58.923

您可以在 mysqli 中使用 data_seek 来做到这一点

```
$query = "SELECT * FROM Something";
if ($result = $mysqli->query( $query)) {
    // seek to row number 32
    $result->data_seek(31);
    $row = $result->fetch_row();
    //use the $row data
    $result->close();
} 
```

# c++ - Error building a C++ program on Eclipse Indigo

> ID：12442787
> 
> 赞同：0
> 
> 时间：2012-09-15T21:48:24.460
> 
> 标签：c++, eclipse-cdt

I am a new user of eclipse indigo RS2 under win 7 32 bit I would like to execute a small program in C or C++ (Hello World).

*   I installed the CDT, MinGW, MSYS-1.0.11

*   I set the PATH variable (`c:\MinGW\bin` `C:\MinGW\1.0\bin` `C:\MinGW\mingw32\bin`)

*   I defined this variable in *window→preferences→C\C++→Build→environment*.

*   I create a new project *file→new→C + + Project→exucutable→hello world Project*.

.. gold -> Makefile Project -> hello world project." builde when the system gives me the following error:

> syntax error hello_world line 7, external location: c: \ mingw \ mingw32 \ bin \ ld.exe: c: \ mingw \ lib \ gcc \ mingw32 \ 4.6.2 \ crtend.o C / C + + Problem "

if I execute the program it gives me

> launch failed. binary not found

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T19:52:29.103

您必须**首先构建**项目。它将在二进制文件夹下生成二进制文件。执行它们。

# objective-c - What does NSString*myString =[ NSString string ] means?

> ID：12442788
> 
> 赞同：-2
> 
> 时间：2012-09-15T21:48:32.507
> 
> 标签：objective-c, nsstring

I'm reading a book for learning Objective-c but I didn't understand this code:

```
NSString* myString = [NSString string]; 
```

I know if you typed `[ object method ]` or `object.method` that the method inside the class will be called, but what does `[ Class method ]` means ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T21:52:35.827

`[Class method]` is a [class method](http://en.wikipedia.org/wiki/Method_%28computer_programming%29#Class_methods).

Read the [documentation](http://developer.apple.com/library/mac/referencelibrary/GettingStarted/Learning_Objective-C_A_Primer/_index.html#//apple_ref/doc/uid/TP40007594-CH1-SW11) for more detail.

By the way, you don't write `object.method` in Objective-C. The dot syntax is used only to access or set properties of an object.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T21:51:27.597

It's a class method - it's basically a method that is called on *the class itself* and not on a particular instance (object) of a class. See [this question](https://stackoverflow.com/questions/1053592/objective-c-class-vs-instance-methods) for further explanation.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T21:54:14.790

The first line creates a new, empty string. Length 0\. It's just @"". You can accomplish the same thing by `NSString *myString = @"";` Class vs Instances is the last question you have. Class is the "I want to make what this method gives me". If you are using `[NSString string]`, then essentially you are doing `[[NSString alloc] init]`. So, the instance gives you access to methods and variables that are for your Class instance (aka myString), so `[myString length]`. You can't do `[NSString length]`.

Class methods are the interface to getting an instance (or getting the class type), and instance methods are for the in memory instance of that class that you are actually using.

Sorry for the convoluted answer.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-15T21:54:21.457

As you might know you there aren't only methods that you can send to instances of a class. There are also methods you can send to the class object of a method. This specific method returns an empty string and gives it to "myString". For further information on class objects read the Apple Document "The Objective-C Programming Language"

# plone - 从 Plone 中的 BrowserViews 返回 HTTP 错误代码

> ID：12442790
> 
> 赞同：1
> 
> 时间：2012-09-15T21:49:23.410
> 
> 标签：plone

克隆视图支持通过突变在 HTTP 响应上设置返回码

[http://collective-docs.readthedocs.org/en/latest/serving/http_request_and_response.html#return-code](http://collective-docs.readthedocs.org/en/latest/serving/http_request_and_response.html#return-code)

...但是，是否存在任何 Pyramid/Django 样式，可以从浏览器视图返回人类可读的 HTTP 错误代码。顺带一提：

```
class View(BrowserView):

    def __call__(self):
        # Any nice classes to return here?
        return Forbidden("Sauna area is forbidden due to on-going repairement work") 
```

我也知道你可以抛出 zException 但结果是“我们很抱歉，似乎有......”用户页面。我只想将纯文本信息简短地发送到浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T21:59:41.390

不，除了引发 zException 内置异常和调用之外`self.request.response.setStatus()`，没有其他方法可以影响状态码。

# android - Pinterest 类似于 Android 中的 Grid

> ID：12442795
> 
> 赞同：12
> 
> 时间：2012-09-15T21:50:42.463
> 
> 标签：android, listview, gridview, pinterest

我想在 Android 上构建一个类似于 Pinterest 应用程序中的网格。

我开始扩展 a`AdapterView<ListAdapter>`但我不能让很多东西工作（例如过度滚动效果）所以，在放弃了扩展的想法之后`AbsListView`，现在我开始认为最好扩展 a`ListView`并覆盖该`layoutChildren()`方法。

你怎么看？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-08-19T07:37:44.320

我们不需要任何外部库，因为 Android 的原生 RecyclerView 只需更改 RecyclerView 的布局管理器即可实现 Pinterest 砌体布局

```
mRecyclerView.setLayoutManager(new StaggeredGridLayoutManager(2, StaggeredGridLayoutManager.VERTICAL));
RecyclerAdapter adapter = new RecyclerAdapter(this);
mRecyclerView.setAdapter(adapter); 
```

凉爽的。这很容易，但我的 LinearLayout 上的边距似乎不起作用。所以这里有一个快速修复。

```
SpacesItemDecoration decoration = new SpacesItemDecoration(16);
mRecyclerView.addItemDecoration(decoration); 
```

SpacesItemDecoration 类：

```
public class SpacesItemDecoration extends RecyclerView.ItemDecoration {
private final int mSpace;

public SpacesItemDecoration(int space) {
    this.mSpace = space;
}

@Override
public void getItemOffsets(Rect outRect, View view, RecyclerView parent, RecyclerView.State state) {
    outRect.left = mSpace;
    outRect.right = mSpace;
    outRect.bottom = mSpace;

    // Add top margin only for the first item to avoid double space between items
    if (parent.getChildAdapterPosition(view) == 0)
        outRect.top = mSpace;
    }
} 
```

[示例的 Github 链接](https://github.com/Suleiman19/Masonry)

[![我的最终结果](../Images/5d9a69842dea224843ad367cc7dafceb.png)](https://i.stack.imgur.com/rC4RP.jpg)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-16T06:22:56.190

我通过复制和更新 Android 的 StaggeredGridView 解决了这个问题。[https://github.com/maurycyw/StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)。似乎非常适合创建您正在寻找的效果。在此之前，我陷入了将 Android 的源代码复制到一个单独的库（我开始工作）的兔子洞，直到我看到了现在实验性的 StaggeredGridView。它比我的旧“BrickView”库项目简单得多，所以我替换了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-26T05:20:17.760

这可以通过对现有 recyclerview 及其适配器的小改动来实现

要做的改变是：1.在你的Activity / Fragment

```
uploadMediaAdapter = new UploadMediaAdapter(getActivity(),mediaArrayList);    
rv_uploaded.setAdapter(uploadMediaAdapter);
int spanCount = 2;
rv_uploaded.setLayoutManager(new StaggeredGridLayoutManager(spanCount, StaggeredGridLayoutManager.VERTICAL)); 
```

2.您的 Recyclerview 列表项是：

```
<android.support.v7.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="@dimen/dim_5"
    app:cardCornerRadius="@dimen/dim_5"
    app:cardUseCompatPadding="true"
    android:clipToPadding="true"
    >

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        >

        <android.support.v7.widget.AppCompatImageView
            android:id="@+id/img_prev_photo"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:scaleType="fitXY"
            android:adjustViewBounds="true"
            />

        <android.support.v7.widget.AppCompatTextView
            android:id="@+id/txt_progress_date"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="8th August 2019"
            android:textSize="@dimen/text_size_17"
            android:textStyle="bold"
            android:layout_gravity="bottom|center_horizontal"
            android:textColor="@color/color_white"
            />

    </FrameLayout>

</android.support.v7.widget.CardView> 
```

通过这样做，您可以实现您正在寻找的东西！

# c# - how is windows client in C# running in background using GUI controls

> ID：12442802
> 
> 赞同：0
> 
> 时间：2012-09-15T21:51:55.877
> 
> 标签：c#, windows

I am new to Windows programming and trying to understand a client written in C#. This client listens to messages from a server and handles them. In this case, it is using C# application, forms and controls that I don't understand. Following is a sample code snippet. It creates an application context that I believe gets called when form is closed. It then connects to a server which sends this client messages and the callbackInterface is used to handle those messages. It creates a form and runs the application with the context created earlier. I believe this part runs a message loop until the form is closed.

Now I am trying to understand what is the point of creating these application context and forms and how they are being used in this case. Can someone help me understand the flow of things here and what role is played by these GUI controls? The client runs entirely in the background with no GUI interface. What is the advantage of using these controls over having a typical client application without these controls that just polls for server messages in a loop?

```
void start() {
// get application context
context = new ApplicationContext();

// connect to a server
connect(name, callbackInterface,...);

// creates a form
cform = new Form();
cform.createControl();
int dummy = cform.Handle.ToInt32();

Application.run(context);

// message loop has returned
disconnect(...)

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T22:16:54.743

在设计 WinForms 时，很容易将大量代码放在代码隐藏中。有时很多业务逻辑都被埋在那里。不是推荐的做法，但它可能很常见。如果您有这样的表单并希望重用业务逻辑但不需要 GUI，您可能会采用您所看到的方法。只是一个猜测，但您的问题中没有足够的细节来做更多的事情。

# objective-c - 如何使用 ARC 使用 NSData 初始化字符串

> ID：12442807
> 
> 赞同：0
> 
> 时间：2012-09-15T21:52:37.160
> 
> 标签：objective-c, ios, automatic-ref-counting

我正在尝试这样做：

```
NSString *responseDataString = [[NSString alloc] initWithData:responseData encoding:NSASCIIStringEncoding]; 
```

但在 ARC 中，我不能使用`[NSString alloc]`. 我不想为此文件禁用 ARC，那么有没有办法在 ARC 中用其他方法做同样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T21:54:22.620

`alloc`在 ARC 下工作得很好。你写的代码应该没问题。为什么你认为它不起作用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T21:56:39.937

`[ NSString alloc ]`在 ARC 下完全有效。

# delphi - IdHTTP.Get 不等待回答

> ID：12442808
> 
> 赞同：0
> 
> 时间：2012-09-15T21:52:39.557
> 
> 标签：delphi, delphi-2010, indy, idhttp

我在使用 Idhttp.Get 方法时遇到了一些问题。我认为它默认在阻塞模式下工作（等待答案转到下一行），但我只是看到它没有等待答案转到另一行。我将它与线程一起使用，但我认为这不是问题。代码是：

```
 IdHTTP1:= TIdHttp.Create(Application);
  IdHTTP1.ConnectTimeout:= 10000;
  IdHTTP1.Request.Clear;
  IdHTTP1.Request.BasicAuthentication:= true;
  IdHTTP1.Request.Username := Username;
  IdHTTP1.Request.Password := Password;
    try
      IdHTTP1.Get(PbxURL); **//this should STOP here and wait for answer don't?**
      HttpCode:= IdHTTP1.ResponseCode;
    except
      on E: EIdHTTPProtocolException do
        HttpCode := IdHTTP1.ResponseCode;
    end;
    if HttpCode=200 then
      Memo1.Lines.Append('Valid Get!'); 
```

所以，我只是注意到我没有得到正确的 HttpCode 值，因为在“获取”方法之后，它只是继续执行而不等待“获取”完成。我怎么解决这个问题？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T02:51:21.330

您说您没有获得正确的 HttpCode，这表明您*正在*获得一个 HttpCode，这意味着 Get 方法已等待获得结果所需的时间。

如果您得到的响应代码是 301，那么您应该尝试设置 HandleRedirects 属性，以便它会使用返回的地址自动重新发出请求。否则，您将不得不自己处理响应。

Get 函数不会过早返回。你误解了你观察到的东西。

# vim - Open and execute file in SML interpreter from within Vim

> ID：12442810
> 
> 赞同：6
> 
> 时间：2012-09-15T21:52:47.190
> 
> 标签：vim, interpreter, sml

I've been using vim for editing code for some time and now I want to use it effectively for programming in Standard ML. In emacs one can use sml-mode which allows one to open the SML intepreter (Moscow ML in my case) in a buffer and load the actual file.

Is it possible to run the Moscow ML interpreter and load the actual file from within vim?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T22:10:21.277

我所做的是，我`:make`设置了在莫斯科 ML 中运行文件的命令。这可以通过将以下内容添加到您的来完成`.vimrc`：

```
" SML make code {{{
autocmd FileType sml setlocal makeprg=rlwrap\ mosml\ -P\ full\ '%'
" }}} 
```

然后，您只需`:make`在 SML 缓冲区中键入，它就会通过莫斯科 ML 为您运行代码。（`rlwrap`通过使用 readline 功能扩展它，稍微改进了 REPL。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-16T10:02:43.453

该`vim-better-sml`插件添加了内置的 REPL 和其他简洁的功能。看看：[https ://github.com/jez/vim-better-sml](https://github.com/jez/vim-better-sml)

您可以按照此处的安装说明进行操作：[https ://github.com/jez/vim-better-sml#install](https://github.com/jez/vim-better-sml#install)

# python - 如何使用 $in 只获取一个子文档

> ID：12442811
> 
> 赞同：1
> 
> 时间：2012-09-15T21:53:15.753
> 
> 标签：python, mongodb, search, pymongo

我如何获得正确的子文档？因为在这里我得到了“全部”！

```
db.users.find({"produit_up.tags":{"$in":["ddsfdsf"]}}).distinct("produit_up")
Out[1]: 
[{u'abus': 0,
 u'avctype': u'image/jpeg',
 u'date': u'2012-09-15',
 u'description': u'ddsfdsf sdfsdfsdf',
 u'id': u'alucaard134773657029',
 u'namep': u'nokia 3310',
 u'nombre': 2,
 u'orientation': u'portrait',
 u'photo': ObjectId('5054d3fa3a5f3a0598b792a2'),
 u'prix': 24,
 u'tags': [u'ddsfdsf', u'sdfsdfsdf'],
 u'vendu': False},
{u'abus': 0,
 u'avctype': u'image/jpeg',
 u'date': u'2012-09-15',
 u'description': u'dfsdfdsf dsfsdfdsfsdf dsfsdfsdf sdfsdfsdf',
 u'id': u'alucaard134773653643',
 u'namep': u'iphone 4gs',
 u'nombre': 2,
 u'orientation': u'portrait',
 u'photo': ObjectId('5054d3d83a5f3a0598b792a0'),
 u'prix': 18,
 u'tags': [u'dfsdfdsf', u'dsfsdfdsfsdf', u'dsfsdfsdf', u'sdfsdfsdf'],
 u'vendu': False}] 
```

对不起标签，我只是想添加新元素，我得到了这个:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T10:59:00.083

如果每个文档只有一个匹配的子文档（或者您很乐意只返回第一个匹配的子文档），则可以使用[位置运算符 ($)](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator)。

`mongo`在shell中使用它的示例：

> db.users.find({"produit_up.tags":{$in:["ddsfdsf"]}},{"produit_up.$":1})

```
{
    "_id" : ObjectId("5055a7abac2ec70755816f7b"),
    "produit_up" : [
        {
            "abus" : 0,
            "avctype" : "image/jpeg",
            "date" : "2012-09-15",
            "description" : "ddsfdsf sdfsdfsdf",
            "id" : "alucaard134773657029",
            "namep" : "nokia 3310",
            "nombre" : 2,
            "orientation" : "portrait",
            "photo" : ObjectId("5054d3fa3a5f3a0598b792a2"),
            "prix" : 24,
            "tags" : [
                "ddsfdsf",
                "sdfsdfsdf"
            ],
            "vend" : false
        }
    ]
} 
```

如果要为每个文档返回多个匹配的子文档，可以使用MongoDB 2.2 中的新[聚合框架：](http://docs.mongodb.org/manual/applications/aggregation/)

```
db.users.aggregate(

    // Match on indexed `tags` field to limit results
    { $match : { "produit_up.tags":"ddsfdsf" }},

    // Convert produit_up array embedded docs to a stream of documents  
    { $unwind: "$produit_up" },

    // Find all matching subdocuments
    { $match : { "produit_up.tags":"ddsfdsf" }}
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T23:41:24.287

使用限制。

```
db.users.find({"produit_up.tags":{"$in":["ddsfdsf"]}}).limit(1); 
```

# sql-server - SQL 查询中的 IF,UNION 语句

> ID：12442813
> 
> 赞同：-1
> 
> 时间：2012-09-15T21:53:40.337
> 
> 标签：sql-server, if-statement, union

我必须拥有具有 X、Y、Z 列的 XY 和 XZ 表。我可以像这样加入它们：

```
 SELECT XY.*,XZ.Z
    FROM XY
    INNER JOIN XZ
    ON XY.X = XZ.X 
```

但是如果发生某种情况（例如 X = 0），我不仅想从 XZ 表中获取数据，还想从另一个具有 X、Z 列的查询（函数、表）中获取数据。我知道 UNION，但我不知道如何使用它并在这种情况下编写 IF 语句。我的意思是这样的（请原谅我这个抽象语法，我只想正确解释问题）：

```
 SELECT XY.*,XZ.Z
    FROM XY
    INNER JOIN IF(X = 0)XZ ELSE (XZ UNION SOME_TABLE)
    ON XY.X = XZ.X 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T21:57:04.700

```
SELECT XY.*, AT.*, XZ.Z
FROM XY
INNER JOIN XZ
ON XY.X = XZ.X
LEFT JOIN another_table AT
ON AT.X = XY.X AND XY.X = 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T22:00:03.487

对 XZ 和 SOME_TABLE 内部的数据有很多假设。

```
SELECT
    XY.*,
    CASE WHEN XZ.Z = 0 THEN ST.Z
         ELSE XZ.Z
    END
FROM XY INNER JOIN XZ ON ON XY.X = XZ.X
        LEFT OUTER JOIN SOME_TABLE ST ON XY.X = ST.X 
```

# iphone - 如何从标签栏获取 indexOfObject？

> ID：12442814
> 
> 赞同：0
> 
> 时间：2012-09-15T21:53:52.460
> 
> 标签：iphone, ios, xcode, tabbar, tabindex

我有一个 iPhone 应用程序因下面的 action.tag 语句出现以下错误而终止。我在一个标签栏控制器的代表中，试图确定活动类是否应该继续到用户选择的标签或留在当前类中。如果决定去另一个班级，我试图让适当的标签栏索引传回主标签栏控制器。

'-[UITabBarController viewControllersindexOfObject:]: 无法识别的选择器

```
action.tag = [self.tabBarController viewControllersindexOfObject:viewController]; 
```

非常感谢 NJones 作为他与我分享的操作表实现的一部分，在早期对这段代码的帮助。原始示例在 tabBarController 和 viewControllersindexOfObject 之间有一段时间，但这给了我一个语法错误。我确实收到有关 UITableController 可能无法响应 viewControllersindexOfObject 的当前语法的警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:02:32.187

好吧，我以前从未见过这种方法，我不相信它存在。但是您可以像这样轻松地在选项卡栏中获取视图控制器的索引：

```
 [[self.tabBarController viewControllers] indexOfObject:viewController]; 
```

希望对您有所帮助。

约尔格。

# git - 在 Git 中更改提交的作者后是否保留原始提交？

> ID：12442820
> 
> 赞同：1
> 
> 时间：2012-09-15T21:54:55.013
> 
> 标签：git, version-control

我发现这个问题解释[了在 Git 中更改多个提交的作者和提交者姓名和电子邮件](https://stackoverflow.com/questions/750172/how-do-i-change-the-author-of-a-commit-in-git)当运行此处给出的任何脚本/命令时，原始提交是否仍存储在我的本地存储库中？有没有办法摆脱它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T22:48:22.960

是的。原始提交将保留在您的 git 存储库中。如果您查看`git reflog`，您可以看到最近更改的历史记录。只要在某处引用它们，提交就会永久保留。因此，例如，如果您有一个包含原始提交的分支，它们将永远不会被删除。但是，如果提交是孤立的（即它们不能从任何 ref 访问），那么它们最终将在`git gc`运行时被删除。但是，默认设置是 30 天内不会发生这种情况。要强制这种情况立即发生，您可以运行：

```
git reflog expire --all
git gc --prune=now --aggressive 
```

请谨慎使用，因为您不想意外丢失所需的数据。这将删除任何未引用的提交。

# php - 在 IIS7 上使用 web.config 删除 .php 扩展名

> ID：12442821
> 
> 赞同：7
> 
> 时间：2012-09-15T21:55:12.147
> 
> 标签：php, .htaccess, url-rewriting, web-config

我有一个**.htaccess**文件，它从文件中删除 .php 扩展名，例如将 so.com/question.php 转换为*so.com/question*，*并*重定向文件夹中的索引文件，例如*so.com/answer/index .php完全按照*[此答案](https://stackoverflow.com/a/9635748/310174)中的描述重定向到*so.com/answer/*

我刚刚在 IIS7 上本地设置了我的站点，需要在**web.config**中重新创建相同的行为，但不知道从哪里开始转换/重写 .htaccess 文件。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-17T18:39:35.640

我发现 IIS7 及更高版本可以使用**URL Rewrite 模块**导入 Apache .htaccess 规则。

1.  通过*Microsoft Web 平台安装程序*安装[URL 重写模块](http://www.iis.net/downloads?tabid=34&g=6&i=1691)
**   启动 IIS 管理器，然后在左侧的“连接”窗格中，选择您需要的站点（例如默认网站）*   在中心（功能视图）双击**URL Rewrite**。*   在右侧面板中单击**Import Rules...**然后将 .htaccess 文件中的规则粘贴到**Rewrite rules**框中*   单击右栏中的应用。*

 *在上面的特定问题中，以下 .htaccess 重定向规则

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [NC,L] 
```

生成以下 web.config 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="Imported Rule 1" stopProcessing="true">
                    <match url="^(.*)$" />
                    <conditions logicalGrouping="MatchAll">
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
                        <add input="{REQUEST_FILENAME}.php" matchType="IsFile" ignoreCase="false" />
                    </conditions>
                    <action type="Rewrite" url="{R:1}.php" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```*

# c# - ASP.net 自定义表单安全

> ID：12442823
> 
> 赞同：1
> 
> 时间：2012-09-15T21:56:26.467
> 
> 标签：c#, asp.net, security, forms-authentication

我不确定我想要什么，所以这是我在这里发帖的主要原因，我是 asp.net / mvc 的新手，只是 webdevelopement。但是，我得到了一个获得（自定义）安全性的 WCF 服务。（IAuthorizationPolicy、IPrincipal 和 UserNamePasswordValidator）。

但是，我找不到关于 ASP.net 安全性的好文章。我找到的所有指南都是关于 sql 成员资格提供程序的，具有自动生成的数据库，但是我不想创建新的用户表等，我想使用我的旧表（其中已经有数百个用户）。但我知道我需要添加一个新表来跟踪 cookie（这样我就可以将 GUID 与 cookie GUID 进行比较，或者我不知道我只是在这里和那里阅读的东西）。但是任何人都可以为我提供一个很好的自定义表单身份验证教程，ps我还必须能够访问角色，（我也已经得到了一个（角色）表）。那么是否可以使用具有以下属性的授权：

```
[PrincipalPermission(SecurityAction.Demand, Role = "Admin")]
public ActionResult GetUserStats(int userid)
{ 
```

PS：我知道我会被枪杀，因为这个问题太开放了等等，我做了研究，没有找到任何最新的（ASP.NET mvc 4，预装了所有 openauth 东西和 webmatrix 安全性的那个）文章如何做这一切。

编辑：[http](http://dotnetspeak.com/index.php/2011/07/asp-net-mvc-custom-authentication/) ://dotnetspeak.com/index.php/2011/07/asp-net-mvc-custom-authentication/似乎是迄今为止我发现的最好的文章，但它使用 json 和内存阅读器/作家哈哈？它不会将会话保存在数据库中吗？不确定或这是一个好方法，有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T02:18:42.057

我还没有使用它，所以这不是个人认可，但我刚刚阅读了有关 SimpleMembership 的信息，这听起来正是您所需要的。请参阅[Jon Galloway 关于该主题的出色博客文章](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T07:07:42.890

身份验证和授权在 .NET 中是完全独立的。

对于身份验证，如果没有一个标准满足您的需求，您可以考虑编写[自定义 MembershipProvider 。](http://msdn.microsoft.com/en-us/library/f1kyba5e(v=vs.100).aspx)

对于授权，您可以考虑编写[自定义 RoleProvider](http://msdn.microsoft.com/en-us/library/8fw7xh74(v=vs.100).aspx)，如果没有一个标准满足您的需求。

MembershipProvider 公开一个用于身份验证（例如ValidateUser）和管理用户（CreateUser、ChangePassword、ResetPassword，...）的API。

RoleProvider 公开一个用于授权（IsInRole、GetRolesForUser）和管理用户角色成员资格（CreateRole、AddUsersToRole，...）的 API。

如果您已经使用现有的 db 表进行了管理，则只需实现基本的身份验证和授权方法：其他人可以抛出`NotSupportedException`.

# symfony - 我如何告诉 Symfony2 始终使用 _format=json 来处理特定的 URL 模式？

> ID：12442827
> 
> 赞同：6
> 
> 时间：2012-09-15T21:57:22.417
> 
> 标签：symfony

我希望任何`/api`以 JSON 格式开头的 URL 的响应。有没有办法为我的整个应用程序配置这个？我正在使用 Symfony2 2.0 版。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-15T22:47:27.410

如果您对路由使用注释并在 中激活控制器`routing.yml`，您可以这样做：

```
Api:
    resource: "@ApiBundle/Controller"
    type: annotation
    defaults: { _format: 'json' } 
```

如果您只想为一个控制器设置它，请在控制器级别注释上设置它：

```
/**
 * @Route("/api", defaults={"_format": "json"})
 */
class ApiController 
{
} 
```

# python - sorted(dict, dict.get) 如何处理重复值

> ID：12442830
> 
> 赞同：3
> 
> 时间：2012-09-15T21:58:00.383
> 
> 标签：python, sorting, dictionary

假设我在 python 中有一个字典，我按值对键进行排序，如下所示

```
my_dict = {'a':5, 'b':4, 'c':6, 'd':3, 'e':2}
sorted_list = sorted(my_dict, key=my_dict.get)
sorted_list
['e', 'd', 'b', 'a', 'c'] 
```

这很好用，但是如果我的字典中有冲突（关于值）

```
my_dict = {'a':5, 'b':4, 'c':5, 'd':3, 'e':2, 'f':4, 'g':3}
sorted_list = sorted(my_dict, key=my_dict.get)
sorted_list
['e', 'd', 'g', 'b', 'f', 'a', 'c'] 
```

在我看来，如果出现重复，列表按字典中的顺序（数字顺序或插入顺序，而不是排序顺序）排序。我可以假设它适用于所有情况吗？

EDIT1：我的键将是整数，如果值发生冲突，我希望结果键按它们的值排序（最高优先）

EDIT2：添加以下参数有助于我的问题。但是，就我而言，我希望值按升序排序，但键按降序排序。以下将导致降序 key=lambda x: (x[1],x[0])

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-15T22:07:54.637

Python 的排序算法 ( [TimSort](https://en.wikipedia.org/wiki/Timsort) ) 是一种稳定的排序，因此任何具有相同排序“值”的项目都按照排序前的顺序保持。

`dict.keys()`对字典键进行排序时，这意味着它们的顺序与字典返回或迭代字典时的顺序相同。请注意，此排序是任意的，并且在字典更改时不稳定。

否则是的，您可以假设所有情况都是如此。

[正如Steven Rumbalski](https://stackoverflow.com/questions/12442830/how-does-sorteddict-dict-get-work-for-duplicate-values/12442866#comment16730628_12442866)所指出的，您可以将密钥与排序一起使用以稳定相同值排序顺序：

```
sorted_list = sorted(my_dict, key=lambda k: (my_dict[k], k)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T22:09:55.023

这不是真的。当值相同时，字典按键排序。这是修改后的示例。

```
my_dict = {'a':5, 'b':4, 'c':5, 'z':3, 'e':2, 'f':4, 'g':3}
sorted_list = sorted(my_dict, key=my_dict.get)
print sorted_list 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T00:37:27.983

使用 pypy，这可能接近您正在寻找的内容。treap 的东西位于[http://stromberg.dnsalias.org/~strombrg/treap/](http://stromberg.dnsalias.org/~strombrg/treap/) 请注意，我已经翻转了键和值；在某些问题中是有益的，而在您的问题中可能会或可能不会。

```
#!/usr/local/pypy-1.8/bin/pypy

import py_treap

class Thing:
    def __init__(self, number):
        self.number = number

    def __cmp__(self, other):
        return -cmp(self.number, other.number)

    def __str__(self):
        return str(self.number)

def main():
    list_ = [ ('a', 5), ('b', 4), ('c', 6), ('d', 3), ('e', 2), ('f', 4), ('g', 4), ('h', 3) ]
    t = py_treap.treap()
    for string, integer in list_:
        thing = Thing(integer)
        if not thing in t:
            print '%s not in t' % thing
            t[thing] = [ string ]
        else:
            print '%s in t' % thing
            t[thing].append(string)

    for sublist in t.values():
        sublist.sort()

    for key, value in t.items():
        print key, value

main() 
```

# ios - 未找到有效的签名身份，配置文件

> ID：12442837
> 
> 赞同：11
> 
> 时间：2012-09-15T22:00:00.817
> 
> 标签：ios, xcode4, provisioning-profile

我知道这个问题经常被使用，但我并没有真正找到我的情况：

我使用 Xcode 4.4.1，为了更新我的配置文件/证书，我只使用“LIbrary/Provisioning Profiles”下的刷新按钮，它就像一个魅力，得到更新，我检查了我的钥匙串访问。我可以看到证书。

但是我所有的配置文件状态都是：“未找到有效的签名身份”，除了一个，即“IOS团队配置”->开发人员模式。

所有发行版都是“未找到有效的签名身份”:(。

我该如何解决这个问题？

1 更多的东西。我以前在我的旧 macbook 上使用相同的证书并且没有问题。不是我尝试设置一台新机器，这就是我得到的。你认为这可能是2个MAC之间的冲突吗？如果是，请您帮我解决一下（我必须从旧机器中删除“开发人员模式”？）。

我真的很感激任何帮助。

更新：

感谢 Alan Moore，我从旧 MAC 导出了所有私钥。对于所有应用程序，状态都是有效的，但现在是另一个问题，新应用程序。

因为我撤销了分发证书，所以所有新应用程序都在新证书上，所有新应用程序都是“找不到有效的签名身份”。:(

而且因为我撤销了旧证书，所以对于所有应用程序我都必须更新证书，一旦我这样做了，在我的 XCODE 中它就会变成“找不到有效的签名身份”。

这是一个非常奇怪的问题，甚至不知道我该如何解决这个问题:(

谢谢你！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-16T00:02:27.710

您将不得不从您的旧 Mac 进行导出 - 导入。

**出口**：

1.  在 XCode Organizer 的 Teams 部分中选择您的团队。
2.  单击导出。
3.  指定文件名和密码，然后单击保存。`

生成的文件包含对应用程序进行代码签名所需的项目，包括在设备上安装开发中的应用程序所需的配置文件、证书和私钥。

**进口**：

1.  在 XCode Organizer 的 Teams 部分中选择您的团队。
2.  单击导入。
3.  选择包含您的代码签名资产的文件。
4.  输入文件的密码，然后单击打开。

（如果您在设备管理器中没有看到“团队”部分：将包含您的代码签名资产的受密码保护的文件拖到 Dock 中的 Xcode 图标。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:20:44.117

您可能需要按照 Apple 的说明迁移您的配置分发证书/密钥对。您通常可以通过在旧 Mac 上导出、复制和导入来完成此操作。

Apple 文档在此处对此进行了描述：

[https://developer.apple.com/legacy/library/technotes/tn2250/_index.html#//apple_ref/doc/uid/DTS40009933-CH1-TROUBLESHOOTING_FAQ-WHAT_DOES__VALID_SIGNING_IDENTITY_NOT_FOUND__MEAN_AND_HOW_DO_I_RESOLVE_IT_](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html#//apple_ref/doc/uid/DTS40009933-CH1-TROUBLESHOOTING_FAQ-WHAT_DOES__VALID_SIGNING_IDENTITY_NOT_FOUND__MEAN_AND_HOW_DO_I_RESOLVE_IT_)

您可能需要从与您的分发证书相关联的旧计算机上的钥匙串访问中导出钥匙串私钥。或者，您可以使用新的密钥和证书重新开始。

# javascript - 使用 jQuery 的 .on 函数如何获取事件的原始元素？

> ID：12442840
> 
> 赞同：17
> 
> 时间：2012-09-15T22:00:30.327
> 
> 标签：javascript, html, events, jquery

我有这样的代码：

```
$('.remove-group').click(function () {
    $(this).closest('tr').remove();
}); 
```

在我需要使用委托事件处理程序来捕获将来添加到页面的元素的点击之前，这工作得很好。

```
$(document).on('click', '.remove-group', function () {
    $(this).closest('tr').remove();
}); 
```

这不再有效，因为`this`关键字不引用原始元素。

有任何想法吗？

## 更新

看来，在我努力简化我的问题的代码时，我实际上使它起作用了。我实际上是在传递一个包装集，该集被分配给一个变量而不是字符串选择器。

```
var $removeGroup = $('.remove-group');
$(document).on('click', $removeGroup, function () {
    $(this).closest('tr').remove();
}); 
```

当我这样做时，这似乎不起作用。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-11-24T07:06:37.070

希望这可以帮助某人：

```
$('#container').on('click', '.remove-group', function(event) {
  $(this);          // returns $('.remove-group') equivalent
  $(event.target);  // returns $('.remove-group') equivalent

  $(event.delegateTarget);  // returns $('#container') equivalent
}); 
```

参考：[http ://api.jquery.com/event.delegateTarget/](http://api.jquery.com/event.delegateTarget/)

# 从问题作者编辑：

我只是想澄清我最初犯的一些错误。

jQuery 中的处理程序似乎`.on()`有一些特定的用法，文档中没有明确说明。

1.  您可以`.on()`直接在选择器本身上使用：

    ```
    $('button').on('click', function () { $(this).css('border', 'solid 1px red'); }); 
    ```

    它会起作用，但它**不适**用于使用相同选择器动态添加到页面的任何未来元素。这与过去的工作方式不同`.live()`。您必须绑定到文档对象以捕获未来元素以及当前元素。这是因为选择器现在是您正在侦听的元素，它将捕获冒泡到该元素的所有点击事件（文档是要侦听的最顶层元素之一）。然后将您感兴趣的元素的选择器作为事件名称之后的第二个参数传递。

    ```
    $(document).on('click', 'button', function () { $(this).css('border', 'solid 1px red'); }); 
    ```

    现在监听器将过滤掉点击事件，直到它找到一个最初在“按钮”上触发并冒泡到文档的事件。

2.  您必须提供一个字符串选择器，而不是一个包装集。这将不起作用：

    ```
    var $buttons = $('button');
    $(document).on('click', $button, function () { $(this).css('border', 'solid 1px red'); }); 
    ```

例如，请参阅[此 jsbin](http://jsbin.com/inewoc/4/edit)。

基本上你只需要在比动态元素更高的范围内收听。考虑到根据定义，您要侦听的动态元素是在代码运行并注册事件侦听器之后添加/删除的，这是有道理的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-15T22:04:58.297

要获取“*事件的原始元素*”，您将使用事件对象的[`target`属性](http://api.jquery.com/event.target/)：

```
$(document).on('click', '.remove-group', function (e) {
    $(e.target).closest('tr').remove();
}); 
```

**但是**，这种方法可能不是您真正想要的，因为原始元素实际上可能是`.remove-group`其“点击”事件简单地冒泡目标元素的后代 - 这意味着您可能会在嵌套表的情况下删除错误的行。在`.on()`处理程序的上下文中，`this`确实指的是匹配的元素`.remove-group`。要使用 绑定到此元素上的委托事件[`.on()`](http://api.jquery.com/on)，语法如下：

`$(static-parent-element).on(event, selector-string, handler)`

例如，这是正确的语法：

```
$(document).on('click', '.remove-group', function () {
    $(this).closest('tr').remove();
}); 
```

这将匹配当前和未来`.remove-group`的元素，并删除最近的`tr`祖先。您可以（*并且应该*）将`document`此处替换为在绑定时存在于 DOM 中的最接近的父元素，`.remove-group`并且在预期触发此事件时（即静态）仍然存在。这样做可以最大限度地减少事件在触发事件之前必须冒泡到 DOM 树的距离。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T22:05:55.760

`$(this)`应该可以正常工作，但`event.target`无论如何都要尝试。

```
$(document).on('click', '.remove-group', function (event) {
    $(event.target).closest('tr').remove();
}); 
```

**演示：http:** [//jsbin.com/inewoc/1/edit](http://jsbin.com/inewoc/1/edit)

# ios - iOS - 向下滚动时tableview禁用刷新

> ID：12442843
> 
> 赞同：3
> 
> 时间：2012-09-15T22:01:16.113
> 
> 标签：ios, uitableview, scroll, refresh

我正在制作一个简单的“添加到收藏夹”功能，它是一个 UITableViewController。当用户选择一个单元格时，我将其设置为`color`灰色并禁用`selectionStyle`

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    cell.textLabel.textColor = [UIColor grayColor];
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
} 
```

我的第一个问题是，每次我选择一个单元格时，其他一些单元格也在切换颜色。所以我删除了以下代码以防止这种情况发生：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier]; 
```

但是我仍然有一个奇怪的问题：在向下滚动 tableview 然后回到它的顶部后，我注意到我选择的所有单元格都恢复了默认颜色，并且最后一个选择的单元格以蓝色突出显示。

所以我可能错了，但我假设滚动时表格视图正在刷新，我想禁用此行为。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-15T22:33:41.677

您缺少对 UITableView 呈现其子视图 (UITableViewCells) 方式的基本理解。我建议阅读[UITableView 编程指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/AboutTableViewsiPhone/AboutTableViewsiPhone.html)。*永远不要*删除`dequeueReusableCellWithIdentifier`对表格视图的调用，这对性能非常重要。

对于您的问题：您需要跟踪每个单元格的状态，并在 cellForRowAtIndexPath: 中设置选择状态，UITableView 会尽可能重用单元格，并在单元格在屏幕内外滚动时刷新。

一个非常简单的实现是：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (![self.selectedRows containsObject:indexPath])
        [self.selectedRows addObject:indexPath];
    else
        [self.selectedRows removeObject:indexPath];

    [tableView reloadRowsAtIndexPaths:@[indexPath]];
} 
```

并在 cellForRow

```
if ([self.selectedRows containsObject:indexPath])
{
    cell.textLabel.textColor = [UIColor grayColor];
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
}
else
{
    //set the normal cells values
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:33:18.457

你不想禁用 UITableViewController 提供的最重要的功能，因为这个删除/创建技巧给你可能想要的快速滚动。

一旦单元格离开屏幕（取决于 tableviewcontroller 行高），它们就会被释放（从内存中删除）。如果它是一个传入单元格（从屏幕外部），它将在 cellForRowAtIndexPath (creation) 方法中相应地创建。

您可能希望使用 a`DataSource`来创建和保存状态，这样它就不会失去其属性。

或试试这个

```
UITableViewCell *cell = [tableView dequeueReusableCellWithReuseIdentifier:@"MY_CELL" forIndexPath:indexPath]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-15T22:35:14.827

为了提高效率，表格单元格在单元格滚动离开屏幕时被重复使用。这是正常的和期望的。随它去吧，不要试图打败它。

您需要跟踪在单元格本身以外的其他位置选择的行，因为当它滚动离开屏幕时，这些行会丢失。我建议在您的视图控制器中创建一个属性，例如一个 NSNumbers 数组，它们是 BOOL。当一个单元格被选中时，将 bool 设置为对应于您的行的 true，然后您可以更改单元格的文本颜色。

当一个单元格出列时，您需要根据您的数组设置其颜色。这将确保您的单元格在屏幕上下滚动时具有正确的颜色。

# javascript - 如何用动画实现纸娃娃？

> ID：12442844
> 
> 赞同：3
> 
> 时间：2012-09-15T22:01:29.817
> 
> 标签：javascript, html5-canvas

对于使用 Canvas 和 Javascript 的 2D 自上而下游戏（想想 Zelda + 一个 RPG），在允许动画的同时实现纸娃娃的最佳方式是什么？

使用 sprite-sheet 制作动画很简单，但是添加纸娃娃（也就是说，能够“装备”物品和盔甲，并在角色上显示这些物品的*视觉表示*）混合并没有看起来很容易，或者至少是一项非重复性的任务。

例如，想象一个角色挥舞剑的动画。一个带有动画的简单精灵表就可以了。但是，如果您希望动画中的实际剑在装备不同的剑时发生变化怎么办？您是否使用不同的剑创建了重复相同动画的其他精灵？对于每个项目？对于每个NPC？（假设我也想要 NPC 的纸娃娃，而不仅仅是角色）

*可以*这样做，并且只需将可穿戴物品的数量保持在最低限度，以限制所需的精灵动画帧的数量。

我认为可以将角色动画分开，然后在角色动画的顶部/下方添加剑/物品动画。这样，不同的角色可以重复使用相同的项目动画，将其与他们的角色动画相匹配。但是对于每个项目，您仍然会有很多精灵。角色必须相似。

有什么想法或建议吗？

（如果重要的话，我想我打算做的是让 NPC 没有任何纸娃娃，并且玩家有角色动画 + 每种物品的动画。对于盔甲，它将与玩家的身材和尺寸相匹配.)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T15:59:30.700

我在想，对于每组可穿戴物品，您都会有一系列可以放在播放器上的物品，例如：

```
var AwesomeDragonProofDiamondArmour =
{
    head: 'awesome-diamond-helmet.png',
    chest: 'awesome-diamond-chest.png',
    legs: 'awesome-diamond-legs.png',
    boots: 'awesome-diamond-boots.png'
}; 
```

然后在您的播放器设置中，您将拥有相同的数组；当然，在许多 RPG 游戏中，您不会从一整套令人敬畏的钻石盔甲开始，而是从皮革开始，也许还有一种好的胸甲。

```
var RubbishLeatherArmour =
{
    head:   'rubbish-leather-helmet.png',
    chest:  'rubbish-leather-chest.png',
    legs:   'rubbish-leather-legs.png',
    boots:  'rubbish-leather-boots.png'
};

var SortOfGoodSteelArmour =
{
    head:   'sort-of-good-steel-helmet.png',
    chest:  'sort-of-good-steel-chest.png',
    legs:   'sort-of-good-steel-legs.png',
    boots:  'sort-of-good-steel-boots.png'
};

var Player =
{
    head:   RubbishLeatherArmour.head,
    chest:  SortOfGoodSteelArmour.chest,
    legs:   RubbishLeatherArmour.legs,
    boots:  RubbishLeatherArmour.boots
} 
```

这些 PNG 将是透明的，想法是将它们与基本的播放器图形合成，最终得到一个纸娃娃角色。为了减少开销，将这些图形放在单个精灵表中并存储每个项目的 X、Y、宽度和高度可能是明智的，如下所示：

```
var RobustMetalArmour = 
{
    head: [120, 120, 20, 20],
    chest: [140, 120, 20, 20],
    legs: [160, 120, 20, 30],
    boots: [180, 120, 20, 10]
} 
```

其中数组是 [x, y, width, height]。这样做的缺点是只有一个大小，所以除非你的角色都是相同的大小（实际上在基于图块的 RPG 中完全可能），为每个大小的角色生成所有图形可能会很耗时。

您可以使用的另一种方法是使用画布绘图功能绘制图形，其中您可以为头盔指定 ax/y/width/height，然后以您希望的任何尺寸绘制头盔。像这样的东西：

```
function drawPlus(ctx, x, y, size, colour)
{
    ctx.lineWidth = 1;
    ctx.strokeStyle = colour;
    ctx.beginPath();
    ctx.moveTo(x + 0.5, y + 0.5 - size);
    ctx.lineTo(x + 0.5, 0.5 + y);
    ctx.lineTo(x + 0.5 + size, 0.5 + y);
    ctx.moveTo(x + 0.5 - size, y + 0.5);
    ctx.lineTo(x + 0.5, 0.5 + y);
    ctx.lineTo(x + 0.5, 0.5 + y + size);
    ctx.stroke();
    ctx.closePath();
} 
```

上面的函数在屏幕上画了一个+。对于奇数宽度的线条，0.5 是必需的 -[请参阅此线程](https://stackoverflow.com/questions/5679295/line-thickness-in-a-canvas-element)。

无论哪种方式，这将非常耗时，具体取决于您希望在每个角色上显示多少项目。

# javascript - 如何编写 HTML 输入的 JS 内联？

> ID：12442848
> 
> 赞同：0
> 
> 时间：2012-09-15T22:01:51.640
> 
> 标签：javascript

我有一个浏览器检查：

```
$(document).ready(function() {
if ($.browser.chrome) {
  //show document write input only if chrome = true else, ignore it
}
});
</script> 
```

HTML

```
<input name="name" type="text" size="30" maxlength="50" **IF CHROME == TRUE? document.write("style="position:relative; margin-top:-3px; margin-left:-1px;"");** > 
```

显然以上是不正确的..有人可以解释这样做的正确方法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T22:14:06.950

虽然我不是这种一次性 hack 的粉丝，但下面解释了如何在`$.browser.chrome`按预期评估的情况下获得它。

* * *

此时无法将文档*写入*内联，但是可以更改元素的属性。例如，在条件 if-check 中：

```
$(inputSelector).attr('style',
    'position:relative; margin-top:-3px; margin-left:-1px;'); 
```

但是，由于`style`“text”属性被合成为“stye 对象”，因此通常最好避免 text-DOM 访问。这可以使用以下`jQuery.css`方法来实现：

```
$(inputSelector).css({
    position: 'relative',
    marginTop: '-3px',
    marginLeft: '-1px'
}) 
```

哪里`inputSelector`是一个合适的选择器来匹配合适的元素。例如，`<input name="theName" ..`可以与`[name="theName"]`. 有关更多详细信息，请参阅[jQuery 选择器](http://api.jquery.com/category/selectors/)。

# javascript - javascript combine array and dictionary

> ID：12442856
> 
> 赞同：1
> 
> 时间：2012-09-15T22:03:11.003
> 
> 标签：javascript, arrays, dictionary, data-structures

> **Possible Duplicate:**
> [Is there any good JavaScript hash(code/table) implementation out there?](https://stackoverflow.com/questions/225367/is-there-any-good-javascript-hashcode-table-implementation-out-there)

I want a data structure that I can query a key from in O(1), delete an element rather quickly and random sample from in O(1).

I thought of a Dictionary (for the key query) combined with Array (for sampling). But is there a way to connect (pointer) between the 2?

for example: I want to delete an entry, given its key. so I can delete it easily from the dictionary, but how can I use the dictionary to splice it out of the Array?

edit:

```
var dict = {key1: "val1",key2:"val2"}; 
```

getting the item by key:

```
getKey = function(key){ return dict[key]; } 
```

getting the item by index (which I want to change)

```
getIndex = function(ind) { return dict.values()[ind] } 
```

the problem with the getIndex function is that .values() goes over all the dictionary and puts it in an array. and if the dictionary is large that is very expensive.

**Update:** I forgot about this question and in the meanwhile I've solved it, so here's the solution:
We can use a dictionary and an array: The array will hold all the keys of the dictionary The dictionary will hold the keys as its keys and instead of the values a tuple of where index is the index of this element's key in the array (a pointer back to the array of sort).
So this way the array points to the dictionary and the dictionary points back to the array.

Now the operations on the ds are as following:

**Insert(key,value):**
push a new key to the array create a tuple insert the tuple to the dictionary with key 'key'

**get(key):**
return dictionary.get(key)

**remove(key):**
remove elem from the dictionary switch between the last key in the array and our key (we have the pointer to our key) update the pointer in the dictionary to the key that was last and we've switched delete our key from the array

**randomSample(sampler):**
sample the array with sampler (which can be uniform sampling for example). iterate over all the samples and return the values corresponding the keys from the dictionary

The full source code of the class is available: [https://gist.github.com/shacharz/9807577](https://gist.github.com/shacharz/9807577)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T22:26:04.680

不太确定你想用随机样本实现什么。但据我了解，您基本上是在寻找一张可以让您掌握值列表的地图？

找到了这个：[https ://stackoverflow.com/a/868728/715236](https://stackoverflow.com/a/868728/715236)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T02:00:27.843

老实说，我不知道这个解决方案是否通过了您的性能标准，但它就在这里......这个想法的核心是使用同一个字典来存储这两个。有一些明显的缺点，包括删除生成的索引中的漏洞。查找应该非常快，这在使用良好的随机数据源时可以进行非常好的随机查找。

很难有你的蛋糕并吃掉它。绝对对此的其他解决方案感兴趣。

```
var dict = {key1: "val1", 0:"key1", key2:"val2", 1:"key2"};
var COUNT = 1;

// inserts
function insertValue(dictionary, key, value) {
    if (typeof dictionary[key] === 'undefined') {    
        COUNT++;
        dict[key] = value;
        dict[COUNT] = key;
    } else {
        return false;
    }
    return;
}

// return an item by index
var index = 20;
var itemByIndex = dict[dict[index]];

// updates by index
dict[dict[index]] = newValue;

// return a "random" element
function getRandomItem (dictionary, maxIndex) {
    var randomNumber = Math.floor(Math.rand() * maxIndex);
    var randomValue = dictionary[randomNumber];
    if (typeof randomValue === 'undefined') {
        return getRandomItem(dictionary, maxIndex);
    }
    return randomValue;
}

// deletes item by index
function deleteItemByIndex(dictionary, index) {
    delete dictionary[dictionary[index]];
    delete dictionary[index];
} 
```

# haskell - 我可以向类型检查器提供有关 GHC 7.6 中归纳自然的证明吗？

> ID：12442858
> 
> 赞同：19
> 
> 时间：2012-09-15T22:03:36.820
> 
> 标签：haskell, ghc, data-kinds

GHC 7.6.1 带有用于类型级别编程的新功能，包括[数据类型提升](http://www.haskell.org/ghc/docs/7.6.1/html/users_guide/promotion.html)。以那里关于类型级自然数和向量的示例为例，我希望能够在依赖于基本算术定律的向量上编写函数。

不幸的是，即使我想要的定律通常很容易通过案例分析和归纳来证明归纳自然，但我怀疑我能否说服类型检查器。举个简单的例子，对下面的朴素 reverse 函数进行类型检查需要证明`n + Su Ze ~ Su n`.

有什么方法可以提供该证明，还是我现在真的处于成熟的依赖类型领域？

```
{-# LANGUAGE DataKinds, KindSignatures, GADTs, TypeFamilies, TypeOperators #-}

data Nat = Ze | Su Nat

data Vec :: * -> Nat -> * where
  Nil  :: Vec a Ze
  Cons :: a -> Vec a n -> Vec a (Su n)

type family (m :: Nat) + (n :: Nat) :: Nat

type instance Ze + n = n
type instance (Su m + n) = Su (m + n)

append :: Vec a m -> Vec a n -> Vec a (m + n)
append Nil ys = ys
append (Cons x xs) ys = Cons x (append xs ys)

rev :: Vec a n -> Vec a n
rev Nil = Nil
rev (Cons x xs) = rev xs `append` Cons x Nil 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-16T01:33:05.003

（注意：我只对任何代码进行了类型检查（并没有实际运行）。）

**方法一**

实际上，您*可以*通过将证明存储在 GADT 中来对其进行操作。您需要打开`ScopedTypeVariables`此方法才能正常工作。

```
data Proof n where
    NilProof  :: Proof Ze
    ConsProof :: (n + Su Ze) ~ Su n => Proof n -> Proof (Su n)

class PlusOneIsSucc n where proof :: Proof n
instance PlusOneIsSucc Ze where proof = NilProof
instance PlusOneIsSucc n => PlusOneIsSucc (Su n) where
    proof = case proof :: Proof n of
        NilProof    -> ConsProof proof
        ConsProof _ -> ConsProof proof

rev :: PlusOneIsSucc n => Vec a n -> Vec a n
rev = go proof where
    go :: Proof n -> Vec a n -> Vec a n
    go NilProof Nil = Nil
    go (ConsProof p) (Cons x xs) = go p xs `append` Cons x Nil 
```

实际上，也许是上述类型的有趣动机`Proof`，我最初只是

```
data Proof n where Proof :: (n + Su Ze) ~ Su n => Proof n 
```

但是，这不起作用：GHC 正确地抱怨说，仅仅因为我们知道`(Su n)+1 = Su (Su n)`并不意味着我们知道，这是我们在这种情况下`n+1 = Su n`进行递归调用需要知道的。因此，我不得不扩展 a 的含义，以包括对自然数的所有相等性的证明，直到并包括- 本质上类似于从归纳到强归纳时的强化过程。`rev``Cons``Proof``n`

**方法二**

经过一番思考，我意识到这门课有点多余；这使得这种方法特别好，因为它不需要任何额外的扩展（甚至`ScopedTypeVariables`），并且不会对`Vec`.

```
data Proof n where
    NilProof  :: Proof Ze
    ConsProof :: (n + Su Ze) ~ Su n => Proof n -> Proof (Su n)

proofFor :: Vec a n -> Proof n
proofFor Nil = NilProof
proofFor (Cons x xs) = let rec = proofFor xs in case rec of
    NilProof    -> ConsProof rec
    ConsProof _ -> ConsProof rec

rev :: Vec a n -> Vec a n
rev xs = go (proofFor xs) xs where
    go :: Proof n -> Vec a n -> Vec a n
    go NilProof Nil = Nil
    go (ConsProof p) (Cons x xs) = go p xs `append` Cons x Nil 
```

**方法 3**

或者，如果您将`rev`位的实现转换为将最后一个元素转换为列表的反向初始段，那么代码看起来会更简单一些。（这种方法也不需要额外的扩展。）

```
class Rev n where
    initLast :: Vec a (Su n) -> (a, Vec a n)
    rev :: Vec a n -> Vec a n

instance Rev Ze where
    initLast (Cons x xs) = (x, xs)
    rev x = x

instance Rev n => Rev (Su n) where
    initLast (Cons x xs) = case initLast xs of
        (x', xs') -> (x', Cons x xs')
    rev as = case initLast as of
        (a, as') -> Cons a (rev as') 
```

**方法 4**

就像方法 3，但再次观察到类型类不是必需的。

```
initLast :: Vec a (Su n) -> (a, Vec a n)
initLast (Cons x xs) = case xs of
    Nil     -> (x, Nil)
    Cons {} -> case initLast xs of
        (x', xs') -> (x', Cons x xs')

rev :: Vec a n -> Vec a n
rev Nil = Nil
rev xs@(Cons {}) = case initLast xs of
    (x, xs') -> Cons x (rev xs') 
```

# clearcase - Clearcase：VOB 中某些目录的 UNL 扩展是什么？

> ID：12442861
> 
> 赞同：1
> 
> 时间：2012-09-15T22:04:26.783
> 
> 标签：clearcase, clearcase-remote-client

在合并到我的分支之后，一些目录现在有一个神秘的 .UNL 扩展名，这些目录似乎无法访问。换句话说，我无法从中签出文件。

我在 Linux RHEL 5.4 上使用 Clearcase 远程客户端和 Eclipse 3.7.1。我检查了 Clearcase 文档并没有发现任何东西。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T15:52:19.593

如果您在从 VOB 中删除（卸载）的文件夹中有私有/劫持资源，这些文件夹将在您的视图中标有 .unl 扩展名，并将保留您拥有的私有/劫持资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T22:19:35.940

不确定，但我看到`.unl`了引用**卸载**资源的扩展，所以在你的情况下，在 CCRC 合并之后，这些目录可能不再可见，但以某种方式保留在你的 web 视图中（使用该扩展）。

确认这一点的最简单方法是在另一个路径中重新加载您的 CCRC 视图，并检查这些目录是否仍然存在。

# javascript - Chrome WebKitGetUserMedia

> ID：12442864
> 
> 赞同：1
> 
> 时间：2012-09-15T22:05:15.093
> 
> 标签：javascript, google-chrome, webrtc

我正在尝试让网络摄像头流在我的页面上运行，并且我想使用 WebKitGetUserMedia 来实现。我用谷歌搜索了很多，感觉就像我已经尝试了所有的例子，但没有人适合我。我显然做错了什么，但我不知道是什么。

所以我的问题是，为了让 WebKitGetUserMedia 在 chrome 中工作，我必须做什么？我正在使用 Chrome v21。如果有人有一些完整的 html、js 代码示例，我会很高兴看到它！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T21:00:35.420

请详细说明您的观点，具体是什么问题，遇到了什么错误，以便可以轻松指出您的错误。

不过，我建议您好好阅读一下从 HTML5 捕获音频和视频，[http://www.html5rocks.com/en/tutorials/getusermedia/intro/](http://www.html5rocks.com/en/tutorials/getusermedia/intro/)。

但是，在阅读本文之后，我遇到了一个错误，它不允许从本地主机或 Google Chrome 上的计算机加载资源（您可能也是这种情况），并且一旦您将 HTML 页面托管在网络（尝试使用 Dropbox 免费公开上传文件或自己托管）。

以下是您可以参考的代码：

```
<html>
  <head>
    <title>HTML5 Webcam Test</title> 
    <style type="text/css">
      body{
        max-width: 300px;
        max-height: 300px;
      }
      #live_video{
        top: 0px;
        height: 100%;
        width: 100%;
        left: 0px;
      }
    </style>
  </head>
  <body>
    <video id="live_video" autoplay controls></video>
    <script type="text/javascript">
      video = document.getElementById("live_video");
      navigator.webkitGetUserMedia({video:true, audio:true},
          function(stream) {
            video.src = window.webkitURL.createObjectURL(stream);
          }
      );
    </script>
  </body>
</html> 
```

# javascript - 多个单选按钮组相互干扰

> ID：12442868
> 
> 赞同：1
> 
> 时间：2012-09-15T22:08:34.860
> 
> 标签：javascript, html, ajax

我以一种形式设置了两组单选按钮：

```
<li>1&nbsp;<Input type = 'radio' id ='part1no' Name ='part1' value= '0'>No
           <Input type = 'radio' id ='part1yes' Name ='part1'  checked="checked" value= '1'>Yes
</li>
<li>2&nbsp;<Input type = 'radio' id ='part2no' Name ='part2'  value= '0'>No
           <Input type = 'radio' id ='part2yes' Name ='part2' checked="checked" value= '1'>Yes
</li> 
```

我正在尝试通过此 javascript 函数提交这些按钮的值：

```
var dataString = 'username='+SessionVars.my_username+'&lessonid='+SessionVars.my_lesson_number;

$('#tracking_submit').click(function(){
    $.ajax({
        url: "php/tracking.php",
        type:'POST',
        data: dataString+'&p1='+$("input[@name=part1]:checked").val()+'&p2='+$("input[@name=part2]:checked").val(),
        success: function(){
            $('#tracking_message').html("Thank you for updating.").fadeIn('slow');              
            setTimeout(function(){$('#tracking_message').fadeOut('slow');},2000);
        }                   
    });
    return false;   
}); 
```

问题是当我检查数据库时，它会将两个字段都更新为第一个单选按钮的值。如果第一个设置为“是”，则两者都将设置为 1，如果第一个设置为 0，则两者都将为 0。任何人对可能导致此问题的原因有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:12:02.080

`$("input[@name=part1]:checked").val()`不应该有字符`@`。那是 XPath 语法，而不是 jQuery 选择器语法。

jQuery 可能会忽略那个“@attribute”请求（因为它是无效的），找到所有`input`的，然后`.val()`返回集合中的第一个值。

# php - RewriteRule 和 php 获取变量

> ID：12442872
> 
> 赞同：0
> 
> 时间：2012-09-15T22:09:28.597
> 
> 标签：php, .htaccess, get, rewrite

这是我的挑战。

我的 www.mysite.com/lab/brand/folder/modify.php 页面有一个 flash 应用程序，它从 url 获取变量，例如 www.mysite.com/lab/brand/folder/modify.php?id=1234 flash 应用程序将 1234 作为 id 提取，并且该应用程序附近的文件夹中有大量文件，我无法移动并保持应用程序正常工作。

我尝试了以下操作，但应用程序没有引入 get 变量。它确实重写了 url，但 flash 应用程序似乎没有获取变量。

^lab/modify/([0-9]+)/?$ lab/brand/folder/modify.php?id=$1 [QSA,L]

我很高兴重写的 url 看起来像 www.mysite.com/lab/modify.php?id=1234 如果这适用于 get get 变量，但我不知道如何写这个。我尝试了以下方法，但没有奏效，所以我知道我写错了。

^lab/modify.php?id=([0-9]+)/?$ lab/brand/folder/modify.php?id=$1 [QSA,L]

您能提供的任何帮助将不胜感激。

谢谢 LP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:36:22.383

这很简单：

```
RewriteRule ^lab/modify/$ lab/brand/folder/modify.php [QSA] 
```

`QSA`标志（查询字符串附加）将为任何 URL 添加您的 GET 变量，例如：

```
www.mysite.com/lab/modify/?id=1234 
```

您可以通过以下方式获取变量：`$_GET['id']`

# ruby - 将变量返回到 HAML

> ID：12442878
> 
> 赞同：1
> 
> 时间：2012-09-15T22:10:12.327
> 
> 标签：ruby, sinatra, haml

我想知道是否有办法使用 sinatra 将 ruby​​ 变量返回到 haml 文件中。例如

哈姆：

```
%b
  = variable 
```

红宝石

```
get '/' do
  variable = "foobar"
  haml :filename
end 
```

然后让haml文件返回

**富吧**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T22:19:31.767

只需将其设置为实例变量即可。

```
get '/' do
  @variable = "foobar"
  haml :filename
end 
```

还有你的火腿：

```
=@variable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T23:00:29.383

您可以将本地哈希值传递给您的模板：

```
get '/local' do
  haml :filename, :locals => {:variable => "foobar"}
end 
```

现在在您的模板中，`variable`将是一个值为 的变量`"foobar"`。

一种可能的替代方法可能是使用辅助方法：

```
helpers do
  def variable
    "foobar"
  end
end 
```

现在在您的模板`variable`中将有一个（名称错误的）方法返回`"foobar"`.

# iphone - 使用 NSFileWrapper 在 UIDocument 中存储 BOOL

> ID：12442882
> 
> 赞同：1
> 
> 时间：2012-09-15T22:10:57.150
> 
> 标签：iphone, objective-c, uidocument, nsfilewrapper

这可能是我太厚了，但是如何将 BOOL 存储在 UIDocument 中？我目前正在使用 NSFileWrappers 在“contentsForType:error:”方法中存储字符串和图像，但是看到没有办法将 bool 转换为 NSData，最好的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:14:29.490

您可以从 BOOL 中获取 NSData 对象：

```
NSData* data=[NSKeyedArchiver archivedDataWithRootObject: [NSNumber numberWithBool: YES]]; 
```

# codeigniter - codeigniter 上的 datamapper orm 不起作用

> ID：12442884
> 
> 赞同：1
> 
> 时间：2012-09-15T22:11:56.053
> 
> 标签：codeigniter, codeigniter-datamapper

祝大家有美好的一天。我正在 Codeigniter 上尝试 DATAMAPPER ORM（wan 向导）。示例应用程序工作正常。但是当我尝试制作自己的模型和控制器时，它不起作用。我按照说明做了每一步。这是一个代码：

```
class Blog extends DataMapper {

var $has_one = array();
var $has_many = array();
var $validation = array(
    'content' => array(
        // example is required, and cannot be more than 120 characters long.
        'rules' => array('required', 'max_length' => 255),
        'label' => 'Content'
    )
);
function __construct($id = NULL)
{
    parent::__construct($id);
}

} 
```

我在 db 中创建了表（有一行称为内容的博客）。

这是一个控制器：

```
class Blog extends CI_Controller {

    function __construct()
    {
        parent::__construct();
    }

    public function index()
    {
        $blog = new Blog;
        $blog->content = "shaa";
        $blog->save();
        echo "done";
    }

} 
```

但它总是给我一个错误：`Fatal error: Call to undefined method Blog::save() in C:\xampp\htdocs\wanwizarddatamapper\application\controllers\blog.php on line 29`

呃，这让我很沮丧！你能帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T15:47:15.327

我相信您的模型和控制器之间存在命名冲突。尝试将您的模型重命名为`BlogEntry`：

```
class BlogEntry extends DataMapper {

  var $has_one = array();
  var $has_many = array();
  var $validation = array(
    'content' => array(
      // example is required, and cannot be more than 120 characters long.
      'rules' => array('required', 'max_length' => 255),
      'label' => 'Content'
    )
  );
  function __construct($id = NULL)
  {
    parent::__construct($id);
  }

}

class Blog extends CI_Controller {

  function __construct()
  {
    parent::__construct();
  }

  public function index()
  {
    $blogentry = new BlogEntry;
    $blogentry->content = "shaa";
    $blogentry->save();
    echo "done";
  }

} 
```

# c++ - 区分 0 字符串和非 0 字符串

> ID：12442885
> 
> 赞同：0
> 
> 时间：2012-09-15T22:11:58.320
> 
> 标签：c++, string, stringstream

我们都知道如何从字符串转换为数字，即：

```
int str2num(const string& str) 
{
   stringstream is(str);
   int result;
   return is >> result ? result : 0;
}; 
```

我的问题我希望能够区分字符串何时无法转换为数字但不是 0 例如：

```
1.) "0" => 0
2.) "0dasd" => 0
3.) "" => 0
4.) "some string" => 0 but true
5.) "345" => 345 
```

我希望能够检测到案例（4）。我唯一的想法是查找字符串`!! .find()`或其他东西.. stringstream 是否有某种指示这种情况的方法？

* * *

编辑：一些澄清：`num2str()`当对话失败和/或返回时我`0`可以使用该功能，该功能也适用于`return 0`ie `(cases:1,2,3,4)`。但是然后在 中`case 4`，我希望能够在函数内部检测到它，这样就像你说的那样抛出一个`err`... 或使用 pair<> 或 out-variable 返回带外数据。

或者更清楚地说，我想检测：

如果`is >> num returns 0 (ex:"0","0.0","000", "0sad","asd0ss")`它真的是零还是字符串不能转换为数字 IE 区分 0 字符串和非 0 字符串

PS> 我的困惑可能也会出现，因为我不确定在转换时哪些情况下 0-in-a-string 会被解释为 0-num 或 just-string。我是否更加困惑:)或者现在更清楚了？我想按照 Perl 零但真实的语义来实现一些东西。

* * *

EDIT2：感谢您提供有关如何准确返回越界数据的所有示例，我非常感谢它们..我的意思是真的..（我可能会使用pair<>，不想使用boost或`C++11`语义）。但我更感兴趣的是“stringstream 的想法是什么`0-string`以及`non-0-string`如何检测差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T22:25:21.910

测试您是否成功转换了某些内容非常容易。不过，区分您的第三种和第四种情况会有点困难——尽管（对我来说）将“没有要转换的输入”视为“成功转换的东西”似乎没有多大意义。如果您可以将案例 3 和 4 视为不成功的转换而将其余的视为成功，那么这很容易：只需在尝试转换后测试流的状态：

```
#include <sstream>
#include <string>
#include <iostream>

int main(){ 
    char const *inputs[] = { "0", "0dasd", "", "some string", "345"};

    for (int i=0; i<5; i++) {
        std::istringstream buf(inputs[i]);
        int val;

        if (buf>>val) 
            std::cout << "Converted : \"" << inputs[i] << "\" To: " << val << "\n";
        else
            std::cout << "Could not convert: \"" << inputs[i] << "\" To int\n";
    }
    return 0;
} 
```

产生：

```
Converted : "0" To: 0
Converted : "0dasd" To: 0
Could not convert: "" To int
Could not convert: "some string" To int
Converted : "345" To: 345 
```

如果您真的想将案例 3 视为成功，我想为空字符串添加一些特殊处理并不需要太多，因为总是成功转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T23:16:22.883

你的字符串转换功能不好，你应该感觉不好。

```
template<typename F> int str2num(const string& str, F&& f) {
   stringstream is(str);
   int result;
   if (is >> result) return result;
   return f();
}
int str2num(const string& str) {
    return str2num(str, [] -> int {
        throw std::runtime_error("Parse failure!");
    });
}
int str2num(const string& str, int def) {
    return str2num(str, [=] {
        return def;
    });
} 
```

您选择 0 作为魔术默认值是不好的 - 对于想要尝试解析整数的人来说，也许 32 是一个合理的默认值。0 也可以是与解析失败分开的有意义的值。如果你想要一个默认值，你需要用户明确指定，因为你的随机 I/O 函数*不知道*一个有意义的默认值可能是什么。

如果用户没有以错误处理函数或有意义的默认值的形式提供明确的错误处理策略，那么抛出异常是唯一的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T23:23:21.973

您需要返回两位信息：一位带有转换结果的整数，以及一个指示成功与否的标志。错误情况也可以通过抛出异常来处理，但通常外部数据永远不会“异常”，解析错误应该被视为正常的控制流，而不是异常。

结果看起来像这样：

```
template <typename T>
boost::optional<int> parse_as(std::string const & s)
{
    if (s.empty()) { return T(); }

    T result;

    return std::istringstream(s) >> result ? result : boost::none;
} 
```

用法: `auto n = parse_as<int>(str);`, 并测试是否设置了结果。

* * *

需要整个字符串匹配的替代标记提取：

```
std::istringstream iss(s);

return iss >> result >> std::ws && iss.get() == EOF ? result : boost::none; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-16T07:24:37.980

Thanks to all who commented. Here is what I had in mind :

```
#include <iostream>
#include <string>
#include <sstream>
#include <assert.h>
using namespace std;
#define pBool std::pair<bool,int>

pBool str2num(const string& str) {
    istringstream is(str);
    pBool rv(false,0);
    if (str == "0E0") {//Zero but true
        rv = std::make_pair(true,0);
    } else {
        is >> rv.second;//convert
        //cout << "fail?:" << is.fail() << endl;
        //logical XOR : !fail != !0?
        if ( !is.fail() != (rv.second == 0) ) rv.first = true;
//      if (!is.fail() && rv.second != 0) rv.first = true;//successful conversion
//      if (is.fail() && rv.second == 0) rv.first = true;
    };
    return rv;
};

template<class T>
void dump_pair(T& p) {
    cout << "Bool:" << p.first << endl;
    cout << "Val :" << p.second << endl;
}

int main() {

    cout << ">>0E0" << endl;
    pBool rv1 = str2num("0E0");
    dump_pair(rv1);

    cout << ">>0" << endl;
    pBool rv2 = str2num("0");
    dump_pair(rv2);

    cout << ">>0.0dsad" << endl;
    pBool rv3 = str2num("0dsad");
    dump_pair(rv3);

    cout << ">>456ttt" << endl;
    pBool rv4 = str2num("456ttt");
    dump_pair(rv4);

    cout << ">>adttt" << endl;
    pBool rv5 = str2num("ad555ttt");
    dump_pair(rv5);

    return 0;
}

====OUTPUT====
>>0E0
Bool:1
Val :0
>>0
Bool:0
Val :0
>>0.0dsad
Bool:0
Val :0
>>456ttt
Bool:1
Val :456
>>adttt
Bool:1
Val :0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-15T22:27:13.447

不清楚您希望如何发出结果信号：如果提取函数未能进行转换，则它们会将流设置为错误状态。如果无法提取任何数字，则整数转换将失败。也就是说，您似乎有三种情况：

1.  字符串是`empty()`，你返回`0`。
2.  转换成功，您返回 vale。
3.  转换失败，您做一些事情来表明失败，例如，您抛出一个异常。

# android - Eclipse Android - Logcat 清除速度太快

> ID：12442892
> 
> 赞同：50
> 
> 时间：2012-09-15T22:13:05.277
> 
> 标签：android, eclipse, logcat

我一直在使用适用于 Android 的 Eclipse（最新版本），一段时间以来，Logcat 没有任何问题。由于未知原因，Logcat 不再保留调试消息。Logcat 在大约 5 秒内被清除。有什么方法可以防止 Logcat 消息的自动清除？否则我无法阅读这些消息。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-09-15T22:55:43.823

更改您的 LogCat 缓冲区长度：

Window / Preferences / Android / LogCat / 缓冲区中的最大 LogCat 消息数**_**

将其设置为 0 以获得无限大小（感谢下面的评论者）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-02T08:07:40.200

当 logcat 行太多时会发生这种情况。在达到首选项中定义的最大数量（Eclipse 中默认为 5000 行）后，它会自动删除所有已过滤和未过滤的行。

幸运的是，您可以在以下位置更改最大数量：

Window > Preferences > Android > LogCat > 缓冲区中的最大 LogCat 消息数

我有同样的问题，但仅限于 Sony Xperia C 和 Android 4.2.2。每部手机都有不同级别的日志记录。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-15T22:39:08.843

您可以在打印消息的地方使用**断点，****然后通过 F6/F8**键调试它们。**因此，您可以逐步**查看所有消息。

# android - 即使互联网不可用，Android networkinfo 也始终返回 true

> ID：12442893
> 
> 赞同：5
> 
> 时间：2012-09-15T22:13:12.237
> 
> 标签：android, networking

此代码始终返回 true。当按下登录按钮时调用它。我首先尝试连接wifi（在模拟器上）。它返回true，然后我断开wifi，然后尝试。它仍然返回 true。

```
public static boolean isNetworkAvailable( Context context) {

    ConnectivityManager cm = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo networkInfo = cm.getActiveNetworkInfo();
            // if no network is available networkInfo will be null
            // otherwise check if we are connected
            if (networkInfo != null && networkInfo.isConnected()) {
                 State network = networkInfo.getState();
                 Log.d("here", "true");
                 return (network == NetworkInfo.State.CONNECTED || network == NetworkInfo.State.CONNECTING);

            }
            Log.d("here1", "false");
            return false;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-15T22:52:01.983

此代码适用于设备，因为我在我的一个应用程序中使用了非常相似的东西。请记住，此代码将告诉您是否已**连接**到网络，而不是您所连接的网络是否具有 Internet 连接。如果您使用的是模拟器，它始终通过 3G 模拟连接，因此断开计算机的 wifi 连接不会改变这一点。您可以将模拟器置于飞行模式，这应该会为您提供您正在寻找的“错误”。

我在我的应用程序中所做的是创建一个接收网络更改广播的服务。连接网络后，它会尝试通过 Internet 下载已知（小）文件。只有成功了，它才会向所有活动广播一个互联网可用的意图，然后这些活动可以基于此改变状态。

# php - PHP 按日期按时间顺序显示

> ID：12442894
> 
> 赞同：1
> 
> 时间：2012-09-15T22:13:15.607
> 
> 标签：php, mysql, date

我创建了一个将非标准日期存储到数据库中的系统。**对于用户创建的每个帖子，都会以Month day, year**的格式存储一个日期，即**2012 年 9 月 15 日**。我认为 MySQL 没有办法组织这些数据，所以我必须手动进行。

我想不出一种方法来做到这一点。

请帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T22:22:49.687

对你拥有的东西进行分类将非常困难。月份是第一个，但它是一个 alpha 版本，不能这样排序。日为第二，年为最后。

`DATETIME`使用 MySQL或`TIMESTAMP`字段类型会更好。至少，您可以将其存储为 unix 时间戳`INT(10)`并按数字排序。

多年来我一直在使用 unix 时间戳方法，但我正在慢慢切换，`TIMESTAMP`因为您可以使用 MySQL 的本机日期格式做更多事情。作为额外的奖励，您实际上可以查看和理解 phpMyAdmin 中的日期，而无需不断编写 FROM_UNIXTIME(field)。您只需要在建立连接时告诉 MySQL 您正在操作的时区（如果使用`TIMESTAMP`）。

您应该能够使用[strtotime](http://php.net/manual/en/function.strtotime.php)轻松转换您拥有的内容。`FALSE`如果它无法弄清楚它会返回。这进展得有多顺利取决于您是否对日期进行了任何清理。如果没有，您可以使用[preg_replace](http://php.net/manual/en/function.preg-replace.php)进行一些清理。

转换数据库中的数据后，您可以使用 PHP 的[date](http://us.php.net/manual/en/function.date.php)函数或 MySQL 的[DATE_FORMAT](http://www.w3schools.com/sql/func_date_format.asp)以您想要的方式显示它。

无论您选择做什么，都要避免在 PHP 中对其进行排序。让您的数据库尽可能多地进行排序和获取。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-15T22:36:39.567

在数据库中创建一个 char(12) 字段并以这种格式 YYMMDD 存储您的数据

前。要存储**2012 年 9 月 15 日，**您应该将其转换为**20120915**

使用这种方法，您可以对其进行排序、重新格式化或重新转换。

# jquery - 页面转换与 不工作

> ID：12442897
> 
> 赞同：2
> 
> 时间：2012-09-15T22:14:22.483
> 
> 标签：jquery, html, list, menu, transition

我正在为我的页面使用此代码： [http ://askmike.org/2011/12/smooth-page-transitions-using-jquery-video/。](http://askmike.org/2011/12/smooth-page-transitions-using-jquery-video/)

以下是我修改后的 Javascript 代码：

```
$(function() {
    var request = window.location.hash;
    if(request == '#page-2') {
        $('.page.current').removeClass('current');
        $('.page').eq(1).addClass('current');
    }
        if(request == '#page-3') {
        $('.page.current').removeClass('current');
        $('.page').eq(2).addClass('current');
    }
        if(request == '#page-4') {
        $('.page.current').removeClass('current');
        $('.page').eq(3).addClass('current');
    }
    $('nav a').click(function(){
        var speed = 200;
        var i = $(this).index();
        $('.page.current').animate({opacity: 0, marginTop:0},speed,function(){
            $(this).removeClass('current');
            $('.page').eq(i).css('marginTop',30).animate({opacity:1,marginTop: 0},speed).addClass('current');
        });
    });
}); 
```

每当我将链接放在无序列表中时，它就不再知道要显示哪个 div。我不是 Javascript 方面的专家，因为我只是在借用代码，但我猜测将它放在列表中会阻止代码知道哪个是它的顺序（如果这有意义的话）。任何帮助将非常感激。这是一个 jsFiddle：http: [//jsfiddle.net/YUH6s/1/](http://jsfiddle.net/YUH6s/1/) 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:37:15.433

在你的锚链接的标记索引中`0`，你的`eq`方法只选择第一个`.page`元素。您可以找到父 li 元素的索引。

改变：

```
$(this).index() 
```

到：

```
$(this).parent().index() 
```

[http://jsfiddle.net/Xht3v/](http://jsfiddle.net/Xht3v/)

# ffmpeg - libavcodec 的官方网站是什么？

> ID：12442901
> 
> 赞同：1
> 
> 时间：2012-09-15T22:15:32.383
> 
> 标签：ffmpeg, libavcodec, libav

我想`libavcodec`用于一个项目，问题是我不明白我应该在哪里获得官方版本，这个库太受欢迎了，我不知道官方网站是什么。

例如，有 2 个主要项目，如[libav](http://libav.org/)和[ffmpeg](http://ffmpeg.org)正在使用它，但我找不到官方来源。

这个网站在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T03:17:56.420

官方网站位于[ffmpeg.org](https://ffmpeg.org/)。您可以使用 git 或使用发布 tarball 获取源代码。推荐使用 Git，因为它将提供最新的代码，并且在绝大多数情况下都是稳定的（并且修复很快）。发布 tarball 是为“需要”发布的发行版设计的。有关详细信息，请参阅[FFmpeg 下载](https://ffmpeg.org/download.html)页面。

# javascript - 无法让引导工具提示在 Rails 应用程序中工作

> ID：12442904
> 
> 赞同：0
> 
> 时间：2012-09-15T22:15:53.580
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我的rails应用程序中有以下代码：http: [//jsfiddle.net/VYeqm/2/](http://jsfiddle.net/VYeqm/2/)

它在小提琴中工作正常，但我不知道为什么它不能在我的应用程序中工作。我在浏览器中使用 web 检查器检查了加载的资源及其加载 bootstrap-tooltip.js。（引导工具提示.js v2.0.3）。我需要更新版本吗？我还尝试将脚本移动到 application.js 文件中，无论哪种方式我都会收到以下错误：

```
Uncaught SyntaxError: Unexpected token ILLEGAL 
```

知道可能是什么原因造成的吗？我难住了。谢谢！

更新：

新错误是：

```
Uncaught TypeError: Object [object Object] has no method 'tooltip' 
```

# c++ - 试图在 MS Visual Studio 2008 中调试屏幕保护程序的麻烦

> ID：12442914
> 
> 赞同：1
> 
> 时间：2012-09-15T22:19:20.730
> 
> 标签：c++, visual-studio, debugging, winapi, screensaver

我正在调试一个屏幕保护程序（用 C++ 编写并喜欢 ScrnSavw.lib），我需要通过本地 VS 2008 调试器运行它。我设法注释掉屏幕渲染部分，以便我可以看到屏幕，但我似乎无法将鼠标移出。它保持隐藏。知道如何让鼠标恢复工作状态以便我可以在 VS2008 调试器窗口中使用吗？

PS。我不能使用远程调试器，因为屏幕保护程序需要在安装了 VS2008 的本地系统上运行。

# javascript - 这是什么 ==- javascript 运算符？

> ID：12442916
> 
> 赞同：6
> 
> 时间：2012-09-15T22:19:28.227
> 
> 标签：javascript

当我发现`==-`, 或`==+`.

在 JS 控制台中，您可以编写：

```
var a = " "; 
```

那么以下是真的

```
a == " "; 
```

但这是错误的

```
a == "    "; 
```

但是，如果您说：

```
a ==- "   "; 
```

或者

```
a ==+ "   "; 
```

那么这个漂亮的`==-`运算符是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-15T22:22:52.517

他们不是不同的运营商。

写作：

```
a ==- " "; 
```

被解析为：

```
(a) == (-" "); 
```

也是如此`==+`。

`true`由于 Javascript 的奇怪类型转换规则，表达式的计算结果为。会发生以下情况：

1.  一元`-`（或`+`）运算符将其操作数转换为数字。如果它是一个空白字符串，则此转换的结果是`0`.
2.  `a == (-" ")`则等价于`" " == 0`。如果比较的类型`==`不同，一个（可能两者），被转换以获得一个共同的类型。在这种情况下，`" "`左侧的`0`也将转换为。
3.  您最终会比较`0`，`0`从而产生`true`。

（上面是 Javascript 如何得出此结果的粗略示例，[实际规则](http://es5.github.com/#x11.9.3)隐藏在[ECMAScript 规范](http://es5.github.com/)中。如果比较对象的类型不同，您可以使用`===`运算符来防止转换并获取。）`false`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-15T22:24:59.953

它只是一个`==`后跟一个`-`（或`+`）。

（下面我写`"<four spaces>"`的意思是由四个空格组成的字符串。）

也就是说，如果你这样做`" " ==- "<four spaces>"`，你将`" "`与进行比较`-"<four spaces>"`。`-"<four spaces>"`计算结果为`0`，因为应用减号会转换为整数。因此，您实际上是这样做`" " == 0`的，这是真的，因为它将 转换`" "`为整数以进行比较。

`" " == "<four spaces>"`但是，这是错误的，因为您正在比较两个不同的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T22:24:04.500

那不是运算符。你得到这些结果是因为`-`and`+`正在将字符串转换为一个数字，在这种情况下，一个空字符串转换`0`为然后被解释为的数字`false`，加上等号运算符`==`会在比较和转换时造成一些麻烦，这就是为什么建议总是使用`===`运算符，您将获得所需的结果：

```
console.log(a === ' '); // true
console.log(a === '   '); // false
console.log(a === -'   '); // false
console.log(a === +'   '); // false 
```

# html - 将 li 浮动到网格图案中会留下不需要的间距

> ID：12442919
> 
> 赞同：4
> 
> 时间：2012-09-15T22:20:41.847
> 
> 标签：html, css, layout, html-lists, floating

在非常高的层次上，这是我的 HTML：

```
<ul>
  <li>Item1</li>
  <li>Item2</li>
  ...
  <li>Item21</li>
</ul> 
```

这是我的CSS：

```
li {
  display: block;
  float: left;
  margin: 0.3em;
  padding: 2px;
  max-width: 10em;
  min-width: 10em;
  min-height: 12em;
  border: 1px solid rgb(230, 230, 230);
  background-color: rgb(250, 250, 250);
} 
```

我的意图是将列表项排列成 3x7 网格模式，但实际发生的是：前六个项目完全按照我想要的方式显示，在 3x2 网格中。然而，第七个显示在其自身的一行上，一直浮动到容器 div 的右侧，“行”的其余部分为空白。然后该模式在下一行继续。[这是它的样子](http://imageshack.us/a/img688/9953/10995065.png)

我的清单正好有 14 项，所以我可以确认这种模式至少再重复一次。我的问题是，是否有人能告诉我为什么只有第 7 项会有这种行为，以及我能做些什么来解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T20:11:18.347

出于某种原因，您提供的屏幕截图中的第五项比其他项高 1 像素。这就是导致第七项行为如此的原因。再次查看您的代码，看看您是否对第五项进行了任何操作，导致它高于其他项。

# php - 在 PHP 中创建一个嵌套的 for 循环

> ID：12442933
> 
> 赞同：0
> 
> 时间：2012-09-15T22:22:09.140
> 
> 标签：php, for-loop

我正在尝试在 PHP 中创建一个嵌套的 for 循环，但代码会产生数千个返回值。

我要做的是读取 rss 提要（数组中的两个），然后比较提要中的帖子什么在我的数据库中。如果帖子的新标题与我的数据库中的不同，它会将其添加到我的数据库中。

我并不是要放弃一堆我的代码，但我从来没有在 PHP 中创建过嵌套的 for 循环，我什至不确定这是否可能。

```
$url_feeds = array('0' => array('user_id' => '1','feed' => 'http://feeds.abcnews.com/abcnews/topstories'),
                   '1' => array('user_id' => '2','feed' => 'http://feeds.reuters.com/reuters/MostRead'));

    for($i=0;$i<sizeof($url_feeds);$i++){
            $user_id = $url_feeds[$i]['user_id'];
                    // echo $user_id;
            $feed = $url_feeds[$i]['feed'];
                    //echo $feed;

            $abc =$this->get_rss_feeds($feed); //This returns an array of all RSS feed posts.
                    //print_r($abc); 
            $post = new post_model();

                    //print_r($res);

        for($i=0;$i<sizeof($abc);$i++)

          { 
                 $link = $abc[$i]['link'];
                 $title = $abc[$i]['title'];
       // echo $title;
                 $date_published = $abc[$i]['pubDate'];
    $res = $post->get_new_user_posts($user_id); // This returns an array of posts in my database (It's sent user_id meaning, the id of the feed see top above array)
                     foreach ($res as $key => $value)
                        {
                        $new_title = $value->title;
        // echo $new_title;
         //echo $title;
                        $new_link = $value->link;
                                 if ($title != $new_title)
                                        {
                                        // echo 'NOT A MATCH'.$i;
                                        $update_new_user_posts = $post->post_to_new_user_posts($user_id,$link,$title,$date_published);
                                        }
                        }
            }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:27:35.373

您在两个循环中使用相同的变量 $i 。通常这是不正确的，会导致不受控制的行为。

# java - SparseArray，检查键是否存在

> ID：12442935
> 
> 赞同：41
> 
> 时间：2012-09-15T22:22:35.760
> 
> 标签：java, android, hashmap, sparse-array

我正在使用 a 实现位图缓存，`HashMap<Integer, Bitmap>`并在 Eclipse 中收到以下警告：

> 改用 new SparseArray(...) 以获得更好的性能。

我以前从未听说过那个类，但是检查它似乎没有`containsKey()`我在从缓存中检索位图以检查它是否存在于缓存中的方法，如果不存在，然后添加它。

关于检查密钥是否已经存在的最佳方法的任何想法？

我想我可以更改代码以使用此重载并检查是否为空？

```
Bitmap bitmap = cache.get(key, null); 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-15T22:33:42.843

你可以使用：

```
Bitmap bitmap = cache.get(key, null); 
```

但请理解这与以下内容相同[`get(key)`](http://developer.android.com/reference/android/util/SparseArray.html#get%28int%29)：

```
Bitmap bitmap = cache.get(key); 
```

最好的使用方法`get(key, default)`是提供一个通用的默认情况，当找不到密钥时，某事 to 是一个*有效的替代品。*

但是没有充分的理由不将`if(get(key) != null)`其用作`contains()`.

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-11-22T13:38:09.920

因此，您的值在各种情况下可能为空，我建议使用`indexOfKey(int key)` Here is the [indexOfKey(int key)](http://developer.android.com/reference/android/util/SparseArray.html#indexOfKey%28int%29)参考。

然后只需检查负返回值

```
if(mySparseArray.indexOfKey(int) < 0) {
   //Item does not exist. Do something relevant 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T22:31:43.057

[从文档](http://developer.android.com/reference/android/util/SparseArray.html)中引用。

> SparseArrays 将整数映射到对象。与普通的对象数组不同，索引中可能存在间隙。它旨在比使用 HashMap 将整数映射到对象更有效。

您可以使用[get(int)](http://developer.android.com/reference/android/util/SparseArray.html#get%28int%29)如果找不到密钥，它也会返回 null。像;

> 位图 bitmap = cache.get(key);

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-21T07:59:10.380

由于 SparseArray 的 get() 成员使用二进制-搜索 (O(log N)) 而 HashMap 使用数组索引 (O(1))。

为两个类提供 get() 方法实现（按原样）：

```
public V get(Object key) { // for HashMap
    if (key == null)
        return getForNullKey();
    int hash = hash(key.hashCode());
    for (Entry<K,V> e = table[indexFor(hash, table.length)];
            e != null;
            e = e.next) {
        Object k;
        if (e.hash == hash && ((k = e.key) == key || key.equals(k)))
            return e.value;
    }
    return null;
}

public E get(int key, E valueIfKeyNotFound) {  //for SparseArray
    int i = binarySearch(mKeys, 0, mSize, key);

    if (i < 0 || mValues[i] == DELETED) {
        return valueIfKeyNotFound;
    } else {
        return (E) mValues[i];
    }
} 
```

至于是否使用 indexOfKey(key) < 0 或 get(key) == null 来检查 SparseArray 中的键是否存在，任何事情都可以，因为两者都在下面使用二进制搜索。

```
public int indexOfKey(int key) {  // for SparseArray
    if (mGarbage) {
        gc();
    }

    return binarySearch(mKeys, 0, mSize, key);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-05T10:58:40.027

多种方式：

1.  如果您想使用与键关联的值，您可以使用`get()`：

    ```
    val sparseArray = SparseArray<String>()
    val someKey = 123
    val someValue: String? = sparseArray[someKey]
    if(someValue!=null){
        //do something
    } 
    ```

请注意，与 IDE 的想法相反，它可以为 null，这就是我添加`?`.

2.  如果你只想检查它是否存在，你可以使用`indexOfKey(key) >= 0`

3.  如果您不喜欢上述内容，并且想要一个更具可读性的选项，您可以使用`containsKey`ktx-collection 依赖项：

    ```
    implementation 'androidx.core:core-ktx:#'
    implementation 'androidx.collection:collection-ktx:#' 
    ```

用法：

```
 val sparseArray = SparseArray<String>()
    val someKey = 123
    if (sparseArray.containsKey(someKey)) {
        //do something
    } 
```

# python - Mayavi 不在 Spyder 内运行：抱怨“ValueError: API 'QString' ...”

> ID：12442938
> 
> 赞同：9
> 
> 时间：2012-09-15T22:23:09.217
> 
> 标签：python, mayavi, spyder

我无法在 Spyder IDE 中运行/使用 Mayavi 库。我已经在下面描述了这个问题。任何帮助都会非常有用。（非常感谢您。）

**重现问题的步骤：**

1.  只需在脚本中导入 Mayavi 库（例如使用“import mayavi.mlab as mlab”）并执行脚本就会重现此问题。
2.  我在此处包含一个测试代码（请注意，此代码是 Mayavi 网站的示例代码）以重现该问题：

# 代码

```
from numpy import sin, cos, mgrid
import mayavi.mlab as mmlab

def f(x,y):
  return sin(x + y) + sin(2*x - y) + cos(3*x + 4*y)

x,y = mgrid[-7.:7.05:0.01, -5.:5.05:0.05]
z = f(x,y)
s = mmlab.contour_surf(x,y,z)
mmlab.show() 
```

**预期输出和错误：**

预期输出：带有图形的 Mayavi 图形窗口。我看到的是：控制台窗口中的以下值错误（我包括完整的消息序列以便明确）：

*-------------------------- 错误信息的开头 ------------------*

```
Traceback (most recent call last):
  File "C:\PROGRAMSANDEXPERIMENTS\PYTHON\MayaviScripts\Learning\testMayavi.py", line 2, in <module>
    import mayavi.mlab as mmlab
  File "C:\Python27\lib\site-packages\mayavi\mlab.py", line 27, in <module>
    from mayavi.tools.camera import view, roll, yaw, pitch, move
  File "C:\Python27\lib\site-packages\mayavi\tools\camera.py", line 25, in <module>
    from engine_manager import get_engine
  File "C:\Python27\lib\site-packages\mayavi\tools\engine_manager.py", line 12, in <module>
    from mayavi.preferences.api import preference_manager
  File "C:\Python27\lib\site-packages\mayavi\preferences\api.py", line 4, in <module>
    from preference_manager import preference_manager
  File "C:\Python27\lib\site-packages\mayavi\preferences\preference_manager.py", line 29, in <module>
    from traitsui.api import View, Group, Item
  File "C:\Python27\lib\site-packages\traitsui\api.py", line 35, in <module>
    from .editors.api import (ArrayEditor, BooleanEditor, ButtonEditor,
  File "C:\Python27\lib\site-packages\traitsui\editors\__init__.py", line 22, in <module>
    from .api import (toolkit, ArrayEditor, BooleanEditor, ButtonEditor,
  File "C:\Python27\lib\site-packages\traitsui\editors\api.py", line 10, in <module>
    from .code_editor import CodeEditor
  File "C:\Python27\lib\site-packages\traitsui\editors\code_editor.py", line 36, in <module>
    class ToolkitEditorFactory ( EditorFactory ):
  File "C:\Python27\lib\site-packages\traitsui\editors\code_editor.py", line 48, in ToolkitEditorFactory
    mark_color = Color( 0xECE9D8 )
  File "C:\Python27\lib\site-packages\traits\traits.py", line 487, in __call__
    return self.maker_function( *args, **metadata )
  File "C:\Python27\lib\site-packages\traits\traits.py", line 1183, in Color
    return ColorTrait( *args, **metadata )
  File "C:\Python27\lib\site-packages\traitsui\toolkit_traits.py", line 7, in ColorTrait
    return toolkit().color_trait( *args, **traits )
  File "C:\Python27\lib\site-packages\traitsui\toolkit.py", line 109, in toolkit
    _toolkit = _import_toolkit(ETSConfig.toolkit)
  File "C:\Python27\lib\site-packages\traitsui\toolkit.py", line 51, in _import_toolkit
    return __import__( name, globals=globals(), level=1 ).toolkit
  File "C:\Python27\lib\site-packages\traitsui\qt4\__init__.py", line 18, in <module>
    import pyface.qt
  File "C:\Python27\lib\site-packages\pyface\qt\__init__.py", line 35, in <module>
    prepare_pyqt4()
  File "C:\Python27\lib\site-packages\pyface\qt\__init__.py", line 17, in prepare_pyqt4
    sip.setapi('QString', 2)
  ValueError: API 'QString' has already been set to version 1 
```

*---------------------------- 错误信息结束 ------------------ --*

**我的环境如下：**

至少在以下两种环境中已观察到此问题：

## 环境1：

描述：Spyder 和所有其他组件是使用 Pythonxy 发行版 (Py(x,y)-2.7.2.3.exe) 在 Windows 7 32 位机器上安装的。Spyder 版本：2.1.9 Python 版本：2.7.2（32 位） Qt 版本：4.7.4，Windows Mayavi 上的 PyQt4 (API v1) 4.8.6 版本：4.1.0

## 环境2：

说明：在运行 64 位 Windows 7 的单独机器上，我安装了 64 位版本的 Enthought EPD 分发版。所以它运行的是 2.7.3 (x64) 版本的 Python 发行版。由于 EPD 包不包含 Spyder，所以我在安装 PyQt GPLv4.9.4 后手动安装了 Spyder。
Spyder 版本：2.1.11 Python 版本：2.7.3（64 位） Qt 版本：4.8.2，Windows Mayavi 上的 PyQt4 (API v2) 4.9.4 版本：4.2.0

**附加信息：**

我确信代码很好，因为脚本在“外部”spyder 环境执行时会产生预期的输出。例如，使用 IPython shell。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T07:33:05.257

感谢 Avaris 的回复。

我现在有一个解决方案（我不确定它是否是“修复”）。我修改了以下设置`Tools->Preferences->Console->External Modules->Enthought Tool Suite->ETS_TOOLKIT`：从更改`Qt4`为`wx`。更改此设置后，我可以直接在 Spyder 中使用 Mayavi 库和 Mayavi 绘图执行代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-17T13:26:27.303

对于linux用户，可以参考[这个问题](https://stackoverflow.com/questions/33708292/valueerror-cannot-set-toolkit-to-wx-because-it-has-already-been-set-to-qt4)`imranal`的答案。

只需添加`export ETS_TOOLKIT=qt4`一个新行`~/.bashrc`就可以了。不要忘记`source`文件`~/.bashrc`！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T05:36:14.863

根据[this](https://groups.google.com/forum/?fromgroups=#!topic/spyderlib/NqNbrsdMoUQ)和[this](http://code.google.com/p/spyderlib/source/detail?r=4fb9a89c6320719280b87b6583823cb9e7736432)，可以通过激活中的`Ignore API change errors (sip.setapi)`复选框来修复错误`Preferences > Console > External Modules`。

我已经测试过它确实适用于 Spyder 2.1.11。

# perl - 忽略字符串中的换行符

> ID：12442940
> 
> 赞同：1
> 
> 时间：2012-09-15T22:23:20.927
> 
> 标签：perl, line-breaks

是否可以告诉 Perl 忽略字符串中的换行符？

出于格式化原因，我需要换行符，因为我的字符串很长。

例如

```
print "hello 
world" 
```

应该给

```
hello world 
```

并不是

```
hello
world 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T22:25:35.580

连接你的字符串

```
print "hello"
    . "world"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:33:37.787

您可以将多个字符串传递给[`print`](http://perldoc.perl.org/functions/print.html)而不是一个大字符串：

```
print "hello", "world"; 
```

当然，假设您没有乱用[`$,`](http://perldoc.perl.org/perlvar.html#%24%2c)并且您确实在使用`print`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T03:45:07.667

**1\. 使用串联**

> 打印“你好”。“世界”;

**2.通过向打印函数发送多个参数**

> 打印（“你好”，“世界”）；

[在键盘](http://codepad.org/CkcO3w8j)上试试。

# python - 在 AWS 上使用 starcluster 和 ipython 进行集群计算

> ID：12442946
> 
> 赞同：5
> 
> 时间：2012-09-15T22:24:31.540
> 
> 标签：python, amazon-web-services, starcluster

我正在尝试在 AWS 上尝试一些集群计算。我对此完全陌生，并且遇到了一些问题。我正在尝试遵循此处找到的教程：http: [//star.mit.edu/cluster/docs/latest/plugins/ipython.html#using-the-ipython-cluster](http://star.mit.edu/cluster/docs/latest/plugins/ipython.html#using-the-ipython-cluster)。我使用 starcluster 来启动一个集群实例：

```
starcluster start mycluster 
```

一切都按预期出现，它表明 ipython 插件已加载。然后我尝试执行以下命令，如教程中所示：

```
starcluster sshmaster mycluster -u myuser 
```

但是，连接失败，并告诉我

```
Permission denied (publickey). 
```

我可以使用登录

```
starcluster sshmaster mycluster 
```

所以我尝试继续登录到主控的教程，但是当我尝试创建客户端时，我收到错误：

```
AssertionError: Not a valid connection file or url: 
u'/root/.ipython/profile_default/security/ipcontroller-client.json' 
```

我看到的唯一不寻常的事情是在集群启动时出现：

```
>>> Running plugin ipcluster
>>> Writing IPython cluster config files
>>> Starting IPython cluster with 7 engines
>>> Waiting for JSON connector file... 
>>> Creating IPCluster cache directory: /Users/username/.starcluster/ipcluster
>>> Saving JSON connector file to '/Users/username/.starcluster/ipcluster/mycluster-us-east-1.json'
!!! ERROR - Error occurred while running plugin 'ipcluster':
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/cluster.py", line 1506, in run_plugin
    func(*args)
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/plugins/ipcluster.py", line 276, in run
    plug.run(nodes, master, user, user_shell, volumes)
  File "<string>", line 2, in run
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/utils.py", line 87, in wrap_f
    res = func(*arg, **kargs)
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/plugins/ipcluster.py", line 228, in run
    cfile = self._start_cluster(master, n, profile_dir)
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/plugins/ipcluster.py", line 173, in _start_cluster
    master.ssh.get(json, local_json)
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/sshutils/__init__.py", line 431, in get
    self.scp.get(remotepaths, localpath, recursive=recursive)
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/sshutils/scp.py", line 141, in get
    self._recv_all()
  File "/Library/Python/2.7/site-packages/StarCluster-0.93.3-py2.7.egg/starcluster/sshutils/scp.py", line 242, in _recv_all
    msg = self.channel.recv(1024)
  File "build/bdist.macosx-10.8-intel/egg/ssh/channel.py", line 611, in recv
    raise socket.timeout()
timeout 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T07:52:05.143

即使默认情况下`CLUSTER_USER = myuser`，本教程也假设`~/.starcluster/config``CLUSTER_USER = sgeadmin`

# javascript - jQuery 匹配 JSON 对象的部分文本

> ID：12442952
> 
> 赞同：4
> 
> 时间：2012-09-15T22:25:09.133
> 
> 标签：javascript, jquery, json, contains

我正在为我的网站做一个实时搜索结果功能。我有一个 JSON 对象，其中包含我想匹配输入值的关键术语。

我能想到的最佳解决方案是在循环中遍历每个术语，并使用 jQuery 选择器查找部分匹配项。我怎样才能做出这样的if语句？例如：

```
$.getJSON('jsonfile.json', function(data) {
    key = Object.keys(data);
    for(i=0;i<key.length;i++)
    {
        if($(input[value]:contains == key[i].term)
        {
            //do something
        }
    }
} 
```

编辑：我很抱歉不清楚。我正在使用 :contains 选择器对一个输入的值进行部分匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T22:28:05.373

您需要将`:contains`选择器构建为字符串：

```
if($('input[value]:contains("' + key[i].term + '")').length) {
    //do something
} 
```

选择器将返回输入中包含该术语的所有元素；添加`.length`为要评估的 if 语句提供了一个简单的“真实”值（返回的 0 个项目 ==“false”，返回的 >0 个项目 ==“true”）。

**编辑：**我不确定是否`input[value]:contains()`是有效的 jQuery 选择器，因为我不知道`:contains()`输入元素上的文本是什么样的。您可能需要自己检查每个输入的*值来帮助它。*您可以将找到的输入过滤到值包含您正在搜索的术语的输入：

```
if ($('input[value]').filter(function() {
        return $(this).val().indexOf(key[i].term) != -1;
    }).length) {
    //do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:38:16.973

如果您的项目很少（例如几十个），您可以做的一件事是创建一个匹配其中任何一个的正则表达式：

```
var match = keys.join("|")
var regexp = RegExp.new(match, 'i') // Case insensitive
if($(input).val().match(regexp)) {
    // do stuff
} 
```

是的，我知道这不会搜索与术语匹配的*任何*输入，您必须预先知道输入元素，但从您的问题来看，我假设您要检查单个输入元素。

不知道它是否比遍历所有术语并一一检查更快，但我认为它是并且它肯定更具可读性。

这可以与 jQuery 的`grep`或`each`方法一起使用：

```
var match = keys.join("|")
var regexp = RegExp.new(match, 'i')

// With grep
var matches = $('input').grep(function(elem, idx) {
    return $(input).val().match(regexp) != null;
})

// Or with each
$('input')..each(function(idx, elem) {
    if ($(input).val().match(regexp) != null) {
        // Do stuff
    }
}); 
```

`grep`选择与任何搜索词匹配的所有输入字段以供以后使用，并迭代`each`所有元素以立即对它们进行操作。

# php - CakePHP 多作用域

> ID：12442958
> 
> 赞同：0
> 
> 时间：2012-09-15T22:25:40.183
> 
> 标签：php, cakephp, tree, cakephp-1.3, cakephp-model

我`CakePHP 1.3`在表中有多个树，`moveup`并且`movedown`我设置了

```
 $this->Category->Behaviors->attach('Tree', array(
        'scope' => array(
            'Category.parent_id' => $node['Category']['parent_id'],
        ),
    )); 
```

而且记录也被分类`type`所以我也需要

```
 'Category.type' => $node['Category']['type'], 
```

像这样它没有任何区别。

这是我的数据示例：

```
id | parent_id | lft | rght | Title | type
1  | null      | 1   | 4    | Cat1  | categoory
2  | null      | 5   | 20   | Cat2  | categoory
3  | 2         | 6   | 13   |Cat2.1 | categoory
4  | 2         | 14  | 15   |Cat2.2 | categoory
5  | 2         | 16  | 17   | img1  | image
6  | 1         | 2   | 3    | img1  | image
7  | 2         | 18  | 19   | img2  | image
8  | 3         | 7   | 8    | Post1 | post
9  | 3         | 9   | 10   | Post2 | post
10 | 3         | 11  | 12   |Cat2.1.1| categoory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T07:10:07.557

您应该在“type”字段而不是“parent_id”字段上确定范围。每次都需要根据要使用的子树设置范围。

```
$this->{$this->nodeType}->Behaviors->attach('Tree', array(
    'scope' => array(
        'Category.type' => $this->nodeType,
    ),
)); 
```

# java - Java Web 应用安全理念

> ID：12442960
> 
> 赞同：0
> 
> 时间：2012-09-15T22:26:44.897
> 
> 标签：java, security, jsp, servlets, web

我在 Google 和 Stackoverflow 中搜索了很多关于 Java 中的 Web 应用程序安全性的信息，但我不明白哪一种模式最适合我的 Web 应用程序。

我想使用 JSP/Servlet 并且我的网络服务器是 Tomcat 。

Web 应用程序的安全性对我们来说非常重要，但我真的不知道我必须做什么？或最好的方法是什么？！

我研究了 Tomcat Realm、Acegi、Spring Security .....

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T02:15:47.080

好好看看 Container Managed Authentication。它是 Servlet 规范的一部分，因此不依赖于服务器。大部分繁重的工作都是由容器完成的。您只需提供一个 JAAS LoginModule 来连接您的用户数据库、验证他的身份并设置他的角色。其余的只是 web.xml 配置哪些 URL 需要哪些角色来访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T22:44:26.520

如果您使用 Spring 和 Spring Security 一起使用（Acegi 是 Spring security 的旧版本）。如果不使用[Shiro](http://shiro.apache.org/)。由于服务器依赖性和单元测试，我不赞成 tomcat 领域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T09:13:12.027

我也会投票支持 Spring 安全性。有一个最新的 Spring 3.0 版本，而不是 ACEGI 安全性及其安静的灵活性。确保你理解语义。请看一下

[Spring 安全文档](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity.html)

捆绑了一些示例应用程序。您可以下载其中任何一个，在 tomcat 中部署战争，并查看示例代码以便更好地理解。希望这会有所帮助，本

# php - Htaccess URL重写到另一个地图

> ID：12442962
> 
> 赞同：0
> 
> 时间：2012-09-15T22:27:21.833
> 
> 标签：php, .htaccess, map, url-rewriting, internal

当我转到 {url}/klanten/home/ 或 {url}/klanten/logout/ 时，会出现 500 内部服务器错误。

我的 htaccess：

```
RewriteEngine on

RewriteRule ^klanten/([^/]+)/?$ klanten/$1.php [L,QSA,NC]

RewriteRule ^error/([^/]+)/([^/]+)/([^/]+)/([^/]+)/?$ error.php?type=$1&error=$2&file=$3&from=$4 [L,QSA,NC]

RewriteRule ^email/([^/]+)/?$ email.php?id=$1 [L,QSA,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [L] 
```

地图 'klanten' 存在，文件 home.php 和 logout.php 也存在。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:34:43.220

此规则是错误的，它会导致无限期重定向：

```
RewriteRule ^klanten/([^/]+)/?$ klanten/$1.php [L,QSA,NC] 
```

`/klanten/logout/`将导致`/klanten/logout.php`其又将被一次又一次地重写。

您可以将点添加到字符类以避免这种情况，这样只有没有点的 url 会被重写：

```
RewriteRule ^klanten/([^/\.]+)/?$ klanten/$1.php [L,QSA,NC] 
```

或者您只需添加现有文件和目录不会被重写的条件（显然更好的解决方案......）：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^klanten/([^/]+)/?$ klanten/$1.php [L,QSA,NC] 
```

# css - Twitter Bootstrap 网格未按预期工作

> ID：12442963
> 
> 赞同：6
> 
> 时间：2012-09-15T22:27:33.137
> 
> 标签：css, twitter-bootstrap, grid-layout

我正在使用基于 Twitter 的 Bootstrap 的高级 Wordpress 主题。该主题称为 StrapPress。我只是开始使用网格并尝试以非常基本的方式进行设置，但是网格的行为方式很奇怪。我想要的是一个由九列组成的主要内容部分，以及三个侧边栏。在九列中，我希望能够嵌套具有不同内容区域的列：在一个页面上，第一部分将是整个九列，然后它下面的内容将分成三个相等的部分。

以下代码在 9 列中没有第一部分的情况下设置得很好：

```
<div class="row-fluid"> <!-- MAIN FLUID CONTAINER -->
    <div class="span9 redBorder" id="content"> <!-- MAIN CONTENT -->

        <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                BLOG
            </div>
        </div>

         <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                RECIPE
            </div>
        </div>

         <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                LISTING
            </div>
        </div>

    </div> <!-- END OF MAIN CONTENT -->

    <div class="span3 redBorder" id="sidebar" style="height: 450px;"> <!-- SIDEBAR -->
        SIDE
    </div> <!-- END SIDEBAR -->

</div> <!-- END OF MAIN FLUID CONTAINER --> 
```

'redBorder' 只是在所有内容周围添加了一个 1px 的红色边框以帮助可视化。 ![这就是它现在的样子。](../Images/6c7d3ce2dcedbbfc8e4c790293a14457.png)

但是，只要我添加下一部分，它就会影响它下面的内容。这是新代码：

```
 <div class="row-fluid"> <!-- MAIN FLUID CONTAINER -->
    <div class="span9 redBorder" id="content"> <!-- MAIN CONTENT -->

        <div class="searchSection redBorder" style="height: 100px;">
            SEARCH SECTION
        </div>

        <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                BLOG
            </div>
        </div>

         <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                RECIPE
            </div>
        </div>

         <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                LISTING
            </div>
        </div>

    </div> <!-- END OF MAIN CONTENT -->

    <div class="span3 redBorder" id="sidebar" style="height: 450px;"> <!-- SIDEBAR -->
        SIDE
    </div> <!-- END SIDEBAR -->

</div> <!-- END OF MAIN FLUID CONTAINER --> 
```

这是它的样子： ![第二部分](../Images/2caa77b49af540e2d2d53c6659935be3.png)

有谁知道它为什么这样做？为什么要在这九列的开头添加一些内容会导致下面的这些列以不再适合其容器的方式为其自身添加填充？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-15T22:45:05.110

这是因为网格处理行和跨度的方式，特别是 Bootstrap 的 CSS 中的这条规则：

```
.row-fluid [class*="span"]:first-child {
    margin-left: 0;
} 
```

因此，为什么在开头添加内容意味着其他 span* 元素在它们之前获得边距。searchSection 是全宽的，因此第一个 span4 换行到下一行并有边距。假设您希望搜索部分全宽，安全的方法是在 span4s 周围放置另一个 row-fluid：

```
 <div class="searchSection redBorder" style="height: 100px;">
        SEARCH SECTION
    </div>

    <div class="row-fluid">
        <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                BLOG
            </div>
        </div>

         <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                RECIPE
            </div>
        </div>

         <div class="span4 redBorder">
            <div class = "contentPlaceholder">
                LISTING
            </div>
        </div>
    </div>

</div> <!-- END OF MAIN CONTENT --> 
```

这也在文档的嵌套列部分中进行了某种解释， http: [//twitter.github.com/bootstrap/scaffolding.html#gridSystem](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)。

# python - （n）python中的诅咒垫不起作用

> ID：12442965
> 
> 赞同：7
> 
> 时间：2012-09-15T22:28:03.643
> 
> 标签：python, ncurses

我似乎无法让 ncurses 垫在 python（2.6、2.7 和 3.2）中工作。直接从[http://docs.python.org/howto/curses.html](http://docs.python.org/howto/curses.html)使用代码我什至无法让它工作。非填充代码完美运行。

```
import curses

def func(scr):
    pad = curses.newpad(100, 100)
    pad.addstr(0,0, "Testing")

    #  Displays a section of the pad in the middle of the screen
    pad.refresh( 0,0, 5,5, 10,10)

    scr.refresh()
    scr.getch()

if __name__ == '__main__':
    curses.wrapper(func) 
```

问题可能是什么？卸下焊盘（并将焊盘更改为 scr）工作正常

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-15T23:20:02.740

你正在覆盖垫。尝试`getch`从`pad`对象而不是主窗口对象调用方法`scr`并删除`scr.refresh`.

# bash - bash 脚本中的错误替换

> ID：12442968
> 
> 赞同：2
> 
> 时间：2012-09-15T22:28:37.347
> 
> 标签：bash

我继承了一个 bash 脚本（遗产不是很好！），我正试图找出问题所在。

违规行是这样的： `while [ "${\(\#\)}" -gt 0 ] ; do`

当我尝试运行它时，我收到“错误替换”错误消息。我很确定它试图询问 args 的数量是否大于零，但你也知道。

我不知道它是否曾经奏效。我想没有足够的反斜杠，或者可能太多，或者括号不属于那里。我尝试了其中的几个，但没有运气。

任何启蒙表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T22:40:35.207

尽管原始行产生了您提到的错误消息（错误替换），但仅删除括号就足以解决问题。例如，在文件中包含以下内容`while-num`

```
#!/bin/bash
while [ "${#}" -gt 0 ] ; do
    echo $1
    shift
done 
```

并用（例如）调用 `./while-num 18173.msg 18179.msg 18201.msg`产生

```
18173.msg
18179.msg
18201.msg 
```

在我的 Ubuntu-12 系统上，当第一行是`#!/bin/sh`. （在 Ubuntu 上，默认 shell 是 dash 而不是 bash。）当`while`行更改为时它也可以正常工作`while[ $# -gt 0 ] ; do`（即不需要引号和大括号，因为`$#`返回一个数字）。

# php - 隐藏 URL 时显示图像

> ID：12442969
> 
> 赞同：0
> 
> 时间：2012-09-15T22:29:03.977
> 
> 标签：php

对 PHP 来说相对较新，我需要能够做一些事情。希望这实际上是可能的:)

基本上，我有功能在关联客户端登录时创建一个唯一的 URL。该 URL 提取了一个 javascript... 的东西.. 很难解释。该对象在 Iframe 中显示得很好，但我想防止客户端能够看到附加到它的变量。

示例：site.com/example.php?secret=variable

关于如何在不暴露该 URL 的情况下包含 iframe 的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T22:42:46.503

如果您希望 $_GET 变量或多或少地在 iframe src-field 中“隐藏”，我建议使用某种 crypt 来隐藏其中的变量。

例如，如果您想`section_id=1234`在 iframe url ( example.php?section_id=1234 ) 中包含 var=value 对，您可以使用

```
<iframe src="example.php?v=c2VjdGlvbl9pZD0xMjM0Cg==" > 
```

现在你要做的是在 example.php 上`base64_decode()`加上`parse_url()`$_GET['v']，这样你就可以使用变量了。

# mysql - MySQL Join Query 错误，我做错了什么？

> ID：12442970
> 
> 赞同：2
> 
> 时间：2012-09-15T22:29:24.110
> 
> 标签：mysql, sql, database, join

我有 3 张桌子：

*   用户
*   项目
*   用户组

*   每个用户可以将多个项目发布到项目表

*   每个用户在 user_groups 中有一个记录，它定义了他所属的用户组（例如新用户、初级用户、高级用户管理员等）

我正在尝试获取满足以下条件的用户的 ID 列表：

*   属于用户组“3”
*   今天发布的项目少于 5 个

这是我的查询：

```
SELECT u.id, COUNT (i.id) as numPosted
FROM users u, items i
    JOIN user_groups on user_groups.userId = u.id
    AND user_groups.groupId = '5'
 WHERE                          
     i.userId = u.id AND
     i.datePosted = CURDATE() AND                         
     numPosted < 5 
```

*   在 JOIN 中，它确保用户属于用户组 5
*   并在 Where 中检查项目属于 userId，以及今天发布的项目，发布的项目数量小于 5。

当我运行这个查询时，我得到这个错误：

```
#1630 - FUNCTION items.COUNT does not exist. Check the 
'Function Name Parsing and Resolution' section in the Reference Manual 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T23:30:28.900

删除之后的空格`COUNT`，设置`groupId = '3'`（假设 groupId 确实是文本），并添加一个`HAVING`子句：

```
SELECT u.id, COUNT(i.id) as numPosted
  FROM users u
       JOIN user_groups g ON (g.userId = u.id AND g.groupId = '3')
       LEFT OUTER JOIN items i ON (i.userId = u.id and i.datePosted = CURDATE())
  GROUP BY u.id
  HAVING COUNT(i.id) < 5 
```

还有一个问题是捕获没有发帖的用户。直接加入，你会失去这些用户，那里需要一个外部加入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:40:57.203

首先，CURDATE() 返回当前日期，隐含时间为 00:00:00。因此，如果您说： CURDATE() == "2012-09-16 00:38:16" 它将返回 0，因为 CURDATE 是 "2012-09-16 00:00:00"。您应该使用 BETWEEN 语句：datePosted BEWEEN CURDATE() 和 NOW() （隐含表示 BETWEEN '2012-09-16 00:00:00' AND '2012-09-16 00:38:16'）。

您可以尝试：

```
SELECT u.id, COUNT(i.id) as numPosted
FROM users u, items i
JOIN user_groups on user_groups.userId = u.id
AND user_groups.groupId = '3'
WHERE i.userId = u.id
AND i.datePosted BETWEEN CURDATE() AND NOW()
AND numPosted < 5 
```

您也可以使用 > CURDATE()，这在正常情况下是完全相同的，因为如果今天（curdate）是 2012-09-16，那么它旁边的每个条目都将是今天（但使用前一个更安全查询，因为如果您使用外部服务来恢复/插入数据，它可能是将来的事情......）

```
SELECT u.id, COUNT(i.id) as numPosted
FROM users u, items i
JOIN user_groups on user_groups.userId = u.id
AND user_groups.groupId = '3'
WHERE i.userId = u.id
AND i.datePosted > CURDATE()
AND numPosted < 5 
```

# java - Java 超类扩展

> ID：12442972
> 
> 赞同：2
> 
> 时间：2012-09-15T22:29:39.340
> 
> 标签：java, android, inheritance

我对这里提出的问题有一个后续问题：

[Java 抽象类（this 关键字）](https://stackoverflow.com/questions/11884362/java-abstract-class-this-keyword)

使用以下代码：

```
public class SuperClass() {
    boolean isDoneLoading = false;
    ArrayList items;
   public SuperClass() {
        loadData();
        items = new ArrayList();
    }

    protected void loadData() {
        // loadData is a class that requests data from remote server, populates "items"
        // and then calls doneLoading when done;

    }
    protected void doneLoading() {
        isDoneLoading = true;
    }
}

public class ExtendedClass extends SuperClass {

   public ExtendedClass() {
        super();    
   }
    protected void doneLoading() {
        // how can I get THIS method to be called when the super's doneLoading is called?
    }
}

// some other class
new ExtendedClass(); 
```

`doneLoading()`调用 super 的 doneLoading 类时， 如何获取“child”（ExtendedClass）类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T22:45:03.673

如果您希望**parent** `doneLoading`后跟子版本的例程，但在**parent**中保留此功能，则它们必须以不同的方式命名。例如，

```
public abstract class SuperClass {
    public void doneLoading() {
       isDoneLoading();
    }
    abstract isDoneLoading();
} 
```

另一个选项将责任委托给孩子调用`super.doneLoading()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:35:48.017

如果你写：

```
ExtendedClass ec = new ExtendedClass(); 
```

`loadData`将在超类中调用（在 中没有这种方法`ExtendedClass`），但`doneLoading`会在 中调用`ExtendedClass`。所以超类`doneLoading`方法不会被调用，因为你已经覆盖了它。

ps：这条评论：

> loadData 是一个从远程服务器请求数据的类

让我觉得你在构造函数中做了太多的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T22:45:49.897

忽略您所做的是否是好的设计的问题，只需执行以下操作：

```
class ExtendedClass {
    protected void doneLoading() {
        super.doneLoading();
        // what needs to be called after SuperClass.doneLoading();
    }
} 
```

另一种选择是使用*观察者*模式。（或者可能*是责任链*。）基本上让添加处理步骤的子类为超类发出的“完成加载”事件注册侦听器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-15T22:45:36.390

超类中存在的完成加载功能已被覆盖。您正在尝试调用被覆盖的函数。如果调用超类的函数，重写似乎是无稽之谈。

# ant - OpenJPA 增强器或加载时编织器

> ID：12442974
> 
> 赞同：0
> 
> 时间：2012-09-15T22:29:57.480
> 
> 标签：ant, openjpa, load-time-weaving

我得到了这个例外。

```
<openjpa-1.0.5-SNAPSHOT-r420667:1227246 fatal user error> org.apache.openjpa.persistence.ArgumentException: Could not locate metadata for the class using alias "Customer". This could mean that the OpenJPA enhancer or load-time weaver was not run on the type whose alias is "Customer". Registered alias mappings: "{Customer=null}"
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.meta.MetaDataRepository.getMetaData(MetaDataRepository.java:363)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getClassMetaData(JPQLExpressionBuilder.java:169)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.resolveClassMetaData(JPQLExpressionBuilder.java:147)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateMetaData(JPQLExpressionBuilder.java:216)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateMetaData(JPQLExpressionBuilder.java:186)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateType(JPQLExpressionBuilder.java:179)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.access$500(JPQLExpressionBuilder.java:66)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder$ParsedJPQL.populate(JPQLExpressionBuilder.java:1685)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.jpql.JPQLParser.populate(JPQLParser.java:55)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.ExpressionStoreQuery.populateFromCompilation(ExpressionStoreQuery.java:148)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.QueryImpl.newCompilation(QueryImpl.java:652)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.QueryImpl.compilationFromCache(QueryImpl.java:633)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.QueryImpl.compileForCompilation(QueryImpl.java:599)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.QueryImpl.compileForExecutor(QueryImpl.java:661)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.QueryImpl.getOperation(QueryImpl.java:1487)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.kernel.DelegatingQuery.getOperation(DelegatingQuery.java:123)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:228)
[9/11/12 14:12:57:958 EDT] 0000019a SystemErr     R     at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:278) 
```

我的 Ant 脚本中有一个增强器任务。

我看到我的类得到了增强，类文件的大小增加了，但我仍然得到上述异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:00:22.737

在您的 persistence.xml 文件中列出您的持久类型。

# css - CSS版表格页面布局

> ID：12442976
> 
> 赞同：2
> 
> 时间：2012-09-15T22:30:14.757
> 
> 标签：css, layout

我正在努力学习 css。到目前为止，我一直落后并使用表格来管理我的页面布局。

我想迁移到 css，但遇到了一些问题。

我当前使用表格的页面布局：

![在此处输入图像描述](../Images/fe2cab9243b7a59ba34cc22e9e76ec63.png)

我尝试按照以下代码使用 css 重新创建此布局：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>page layout</title>
    <style type="text/css">

        html, body {
            text-align:center;
        }

        #wrapper {       
            margin: 0 auto;       
            width: 1200px; 
            text-align:left;}

        #header {
            height: 100px;
            overflow: auto;
            background: green;
        }

        #main {
            background: yellow;
            float: left;
            width: 800px;
            height: 400px
        }

        #menu {
            background: red;
            float: left;
            width: 200px;
            height: 200px
        }

        #pics {
            background: brown;
            float: left;
            width: 200px;
            height: 200px
        }
        #pics {
            background: brown;
            float: left;
            width: 200px;
            height: 200px
        }
        #adverts {
            background: pink;
            float: left;
            width: 200px;
            height: 400px
        }

        #footer {
            background: grey;
            float: left;
            width: 1200px;
            height: 100px
        }

    </style>

</head>
<body>
<div id="header">
    Header
</div>

<div id="menu">
    menu
</div>
<div id="pics">
    pics
</div>
<div id="main">
    main
</div>

<div id="adverts">
    adverts
</div>

<div id="footer">
    footer
</div>

</body>
</html> 
```

这会产生以下输出： ![在此处输入图像描述](../Images/94bdb2b54a3bb6f8bb5bfcaff4aff119.png)

如您所见，图片 div 的位置不正确，这应该在菜单 div 下而不是在页面底部？

我的问题，如何将图片 div 放在正确的位置？其次，如何使整个页面居中？

最后，这是管理我的页面布局的最佳方法吗？如果我的“主要” div 信息太多，会发生什么？它会自动调整高度以显示所有信息吗？这是溢出：自动允许的吗？

一如既往地感谢帮助，R

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:37:40.123

你的`pics`div 乱序。它需要出现在`footer`div 之前：

你有这个：

```
<div id="footer">
    footer
</div>

<div id="pics">
    pics
</div> 
```

你需要有这个：

```
<div id="pics">
    pics
</div>

<div id="footer">
    footer
</div> 
```

为了按照您想要的方式排列`menu`和`pics`div，请创建一个`div`包装（包含）它们（`menupics`在下面我的 CSS/HTML 中）。

此代码的工作原理与您在上面列出的一样：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>page layout</title>
    <style type="text/css">

        html, body {
            height: 100%;
            width:1200px;
            text-align:center;
        }

        #header {
            height: 100px;
            overflow: auto;
            background: green;
        }

        #main {
            background: yellow;
            float: left;
            width: 800px;
            height: 400px;
        }

        #menupics {
          float: left;
          width: 200px;
          height: 400px;
        }

        #menu {
            background: red;
            float: left;
            width: 200px;
            height: 200px;
        }

        #pics {
            background: brown;
            float: left;
            width: 200px;
            height: 200px;
        }

        #adverts {
            background: pink;
            float: left;
            width: 200px;
            height: 400px;
        }

        #footer {
            background: grey;
            float: left;
            width: 1200px;
            height: 100px
        }

    </style>

</head>
<body>

<div id="header">
    Header
</div>

<div id="menupics">
  <div id="menu">
    menu
  </div>
  <div id="pics">
    pics
  </div>
</div>

<div id="main">
    main
</div>

<div id="adverts">
    adverts
</div>

<div id="footer">
    footer
</div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T22:54:57.800

> **如何使整个页面居中？**

您将希望在您周围放置一个 div，其他 div 具有宽度设置和以下 css 规则： `margin: 0 auto 0 auto;`.

> **这是管理我的页面布局的最佳方法吗？**

你的 html 还不错，但你的 CSS 指定的太多了。使用基于 CSS 的布局，少即是多。尽可能避免指定宽度和高度。

在上面的部分中，我提到了添加一个包含其他 div 的 div，以便您可以使页面居中。该 div 将需要为其分配一个宽度，以便它可以居中，但是对于此包装器内的 div，如果您不分配宽度，那么它们将自动水平填充可用空间，因为它们是块级元素。此外，如果没有指定高度，它将根据其中的内容占据一个高度。因此，如果您希望它自动变大，您可以不指定高度。最后，如果您希望您的 div 占据某个最小高度并且不大于某个最大高度，则可以使用 min-height 和 max-height css 规则（注意这些规则不适用于某些旧版浏览器）。

我无法解决您的其他问题，因为我的工作阻止了该图像主机）=。

# android - Android：了解APK安装过程

> ID：12442979
> 
> 赞同：56
> 
> 时间：2012-09-15T22:30:52.817
> 
> 标签：android, installation, apk

我试图了解如何在 Android 上安装 apk 的过程，特别是通过 adb install （我正在测试的地方）安装 Android SDK 模拟器。

在搜索中，除了“apk 被简单地复制到 /data/app 并在您运行它时安装。这对我来说并不令人满意，因为它没有解释 apk 的图标如何出现在菜单上。问题。

来自 Windows 背景，运行 .exe 或安装程序来安装程序会修改注册表、文件、服务等。我需要了解在 Android 上安装 apk 时是否会发生这种情况或类似情况。

因此，如果有人可以向我解释在 Android 上安装 apk 时具体会发生什么，我将不胜感激。

在旁注中，我还想知道 Dalvik VM " `zygote`" 是否参与安装，或者它是否发生在较低的 linux 内核级别？

我的最终目标是使用 strace 来记录 apk 的安装过程，以记录系统修改、文件创建、网络活动和其他感兴趣的事件。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2015-08-18T08:46:12.997

Android应用程序主要有两类。

1.  系统应用程序：系统初始化时安装
2.  用户应用程序：从 Play 商店安装，使用 ADB 或将 .apk 文件复制到 SD 卡中。

以下是分步安装过程。

1.  解析AndroidManifest.xml，提取信息并存储到/data/system/packages.xml和/data/system/packages.list
2.  .apk 文件被复制到特定目录，并为此应用创建数据存储目录

XML 解析、资源分析和 .apk 文件复制由

> 包管理服务.java

但是，目录创建是由

> 安装d.c

PackageManageService.java 通过位于 /dev/socket/installed 的本地套接字与 installd.c 通信

.apk 文件被复制的包对于系统应用和用户应用是不同的。对于系统应用程序是

> /系统/应用程序/

至于复制到 .apk 文件中的用户应用程序 .apk 文件被复制到

> /数据/应用

从 .apk 文件中提取的 .dex 文件被复制到 /data/dalvik-cache/。

包管理器创建数据目录 /data/data// 来存储数据库、共享首选项、本机库和缓存数据

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-16T01:23:44.787

我认为，您想知道的一切都在 Android 开发者网站[http://developer.android.com/tools/building/index.html](http://developer.android.com/tools/building/index.html)中，为了了解应用程序本身的包装，这里的图片更好（不是APK安装过程，但它可以帮助您了解apk结构和安装）。您还可以通过 Google 搜索 aapt 工具和 .dex 以了解更多信息，因为 classes.dex 是您的应用程序的子结构 - 包含已编译的 java 和类。一个 dex 文件包含多个类，而 java 类文件只包含一个类。dex 文件是使用 DX 工具转换的 java 字节码，DX 工具是 Android SDK 的组成部分。因此，它允许每个应用程序作为自己的进程运行，并使用自己的 Dalvik 虚拟机实例。 ![APK](../Images/41e081a79851ba69389a9433bf05a9da.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-25T08:28:06.160

“详细APK安装流程是什么？以下流程在Package Manager Service中执行。

*   等待
*   将包添加到安装过程的队列中
*   确定包安装的合适位置
*   确定安装安装/更新新
*   将apk文件复制到给定目录
*   确定应用的UID
*   请求已安装的守护进程
*   创建应用目录并设置权限
*   提取dex代码到缓存目录
*   反映和packages.list/system/data/packages.xml的最新状态
*   广播到系统的名字伴随着安装的效果是 -complete package Intent.ACTION_PACKAGE_ADDED: If new (Intent.ACTION_PACKAGE_REPLACED): case of an update”

更多信息链接[https://dzone.com/articles/depth-android-package-manager](https://dzone.com/articles/depth-android-package-manager)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-06-23T11:35:25.807

这是在两个级别上完成的 1.) PackageInstaller(UI) 使用 PackageManagerService(System service) 将命令发送到第二部分(Installd) 2.) Installd 是一个实际安装 apk 的守护进程。Installd 和 PackageManagerService 使用套接字通信进行通信。使用的插座是自己安装的。您可以参考 init.rc 在 init 创建套接字。

# c# - c#缩小转换不会产生异常

> ID：12442981
> 
> 赞同：1
> 
> 时间：2012-09-15T22:31:12.753
> 
> 标签：c#, casting, overflow

来自 C# 类型转换表 (http://msdn.microsoft.com/en-us/library/08h86h00.aspx)：“缩小转换也可能导致其他数据类型的信息丢失。但是，溢出异常是如果正在转换的类型的值超出目标类型的 MaxValue 和 MinValue 字段指定的范围，则抛出，并且运行时检查转换以确保目标类型的值不超过其 MaxValue 或 MinValue 。”

所以我期待下面的代码生成一个异常：

```
static void Main() {
    int numb1 = 333333333;
    short numb2 = (short)numb1;

    Console.WriteLine("Value of numb1 is {0}", numb1);
    Console.WriteLine("Type of numb1 is {0}", numb1.GetType());
    Console.WriteLine("MinValue of int is {0}", int.MinValue);
    Console.WriteLine("MaxValue of int is {0}\n", int.MaxValue);

    Console.WriteLine("Value of numb2 is {0}", numb2);
    Console.WriteLine("Type of numb2 is {0}", numb2.GetType());
    Console.WriteLine("MinValue of short is {0}", short.MinValue);
    Console.WriteLine("MaxValue of short is {0}", short.MaxValue);

    Console.ReadKey();
} 
```

但是 numb2 得到的值是 17237。我不知道这个值是从哪里来的，我真的不明白为什么没有生成溢出异常。

任何建议都非常感谢！谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T22:41:27.890

默认情况下不检查数字转换。您可以通过使用`checked`块来强制执行此操作：

```
checked { short s = (short)numb1; } 
```

或者，您可以使用`Convert`检查转换的类：

```
short s = Convert.ToInt16(numb1); 
```

还有一个[选中的编译器选项](http://msdn.microsoft.com/en-us/library/h25wtyxf.aspx)

值 17237 只是 333333333 的低 16 位（即 333333333 被截断以适应短）：

```
int s = numb1 & 0x0000FFFF; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-15T22:38:42.260

缩小转换通常是使用 C# 在运行时完成的转换。强制转换是使用`explicit`运算符告诉编译器您知道要转换为什么并且不希望出现任何异常或编译错误。`Convert.ToUInt16(int)`通过异常进行的窄化转换通常是由转换方法调用的那些，例如 --*这会*抛出`OverflowException`if 传递的`int`大于`65535`。

# c# - 搜索词的一部分

> ID：12442985
> 
> 赞同：1
> 
> 时间：2012-09-15T22:32:53.237
> 
> 标签：c#, asp.net, sql, sqldatasource

所以我在 sql 2008 服务器上有一个 Customers 表，我将它绑定到我的应用程序中的 gridview。搜索按钮使用以下代码重新绑定表：

```
ControlParameter ctrlParam = new ControlParameter();
ctrlParam.ControlID = "SearchTextBox";
ctrlParam.PropertyName = "Text";
ctrlParam.Name = "Search";
QueryStringParameter ctrlParam2 = new QueryStringParameter();
ctrlParam2.DefaultValue = "Canceled";
ctrlParam2.QueryStringField = "Canceled";

ctrlParam2.Name = "CustomerStatus";
ctrlParam2.Type = TypeCode.String;
SqlDataSource1.SelectParameters.Clear();
SqlDataSource1.SelectParameters.Add(ctrlParam);
SqlDataSource1.SelectParameters.Add(ctrlParam2);
SqlDataSource1.SelectCommand = "SELECT FullText_for_Customers.RANK, [CustomerId], [CustomerStatus], [CustomerGroup], [CustomerFirstName], [CustomerLastName], [CustomerFullName], [CompanyName], [CustomerAddress], [CustomerCity], [CustomerState], [CustomerZipcode], [CustomerFullAddress], [CustomerEmail], [CustomerEmail2], [CustomerPhoneNumber], [CustomerPhoneNumberExt], [CustomerType], [CustomerSubscriptionType], [CustomerCost], [CustomerPaymentMethod], [CustomerPickUpDay], [CustomerPickUpDay2], [CustomerSignUpDate], [CustomerNotes], [CustomerDriver] FROM [Customers] INNER JOIN FREETEXTTABLE(Customers, (CustomerFirstName, CustomerLastName, CustomerFullName, CompanyName, CustomerAddress, CustomerCity, CustomerState, CustomerZipcode, CustomerFullAddress, CustomerEmail, CustomerEmail2, CustomerPhoneNumber, CustomerNotes), @Search) as FullText_for_Customers ON FullText_for_Customers.[KEY]=Customers.CustomerId WHERE ([CustomerStatus] <> @CustomerStatus) ORDER BY FullText_for_Customers.RANK DESC"; 
```

现在当`GridView`被拆分为`CustomerID, CustomerFirstName, CustomerLastName, CustomerPickUpDay, and CustomerSignUpDate`.

当我搜索时，我只搜索名字，但我必须输入完整的名字或姓氏，我不能只输入一部分；比如取我的姓，Bonilla，我必须搜索 Bonilla 才能显示结果，我不能只搜索 Bon 或 Bo 或 illa。我怎么会有这份工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:51:21.090

自由文本搜索实际上并不是这样工作的。但是，您可以得到一个近似值。使用 CONTAINSTABLE 代替 FREETEXTTABLE 并将星号 ( `*`) 附加到您的搜索词。这样，您将获得以“Bo”或“Bon”开头的名称。但是，没有办法获得以“illa”结尾的名称。

（此外，通过使用 FREETEXTTABLE，您要求数据库将您的搜索词放在同义词库中，这对于名称来说可能是个坏主意。）

# python - 排序字典python值降序，但键升序

> ID：12442986
> 
> 赞同：1
> 
> 时间：2012-09-15T22:33:14.203
> 
> 标签：python

我想从 python 中的字典中获取排序的键列表（我的字典是 int 到 int 的映射）。我希望这些值按升序排序。但是如果发生冲突（相同的值），我希望键按键的数值排序。以下代码可以做到这一点

```
key=lambda x: (dict[x],x) 
```

但是，我希望值的降序和键的排序（仅在发生冲突的情况下）是降序的。我可以应用 reverse 参数，但这将以相同的方式对键及其值起作用。

有没有办法分开做？

例子

```
>>> my_dict = {1:5, 2:4, 3:5, 26:3, 5:2, 6:4, 8:3}
>>> my_dict
{1: 5, 2: 4, 3: 5, 5: 2, 6: 4, 8: 3, 26: 3}
>>> sorted_list = sorted(my_dict, key=my_dict.get)
>>> print sorted_list
[5, 8, 26, 2, 6, 1, 3] 
```

我希望输出为 [5, 26, 8, 6, 2, 3, 1]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T22:46:14.677

你有几个选择：

```
>>> my_dict = {1:5, 2:4, 3:5, 26:3, 5:2, 6:4, 8:3}
>>> sorted(my_dict, key=lambda x: (my_dict[x], -x))
[5, 26, 8, 6, 2, 3, 1]
>>> sorted(sorted(my_dict)[::-1], key=my_dict.get)
[5, 26, 8, 6, 2, 3, 1]
>>> sorted(sorted(my_dict, reverse=True), key=my_dict.get)
[5, 26, 8, 6, 2, 3, 1] 
```

第一个取决于键是数字的（或者至少是你可以像这样否定的东西），它不如最后两个通用，后者仅使用排序稳定的事实。

# plone - 检查 HTTPRequest 是“真实的”还是我们在 Plone 中运行无头（单元测试）

> ID：12442990
> 
> 赞同：1
> 
> 时间：2012-09-15T22:33:37.353
> 
> 标签：plone

我发现了 Plone 的 RegistrationTool 和 PasswordResetTool 的问题

*   [https://dev.plone.org/ticket/13173](https://dev.plone.org/ticket/13173)

即使没有发出 HTTPRequest，也会呈现模板 mail_password_response.pt。该模板是一个依赖于 main_template 的全帧 Plone 页面。main_template 具有依赖于真实 HTTPRequest 对象的存在的 viewlet，即其 ACTUAL_URL 参数。

如何解决这种情况？显然，如果没有浏览器来显示结果，则不应呈现 mail_password_response.pt。但是如何在深层 Plone 代码中检查 HTTPRequest 是否是“真实的”，这应该屈服于 UI 响应，比如可怕的 ZMI manage_xxx hacks？

解决这个问题的正确方法是什么？是让 RegistrationTool 不呈现模板还是让 viewlet 对不完整的测试存根 HTTPRequest 对象安全？

这是在 palayout.viewlets.common 中需要 ACTUAL_URL 的 viewlets 位

```
class ContentViewsViewlet(ViewletBase):

    @memoize
    def prepareObjectTabs(self, default_tab='view', sort_first=['folderContents']):
        """Prepare the object tabs by determining their order and working
        out which tab is selected. Used in global_contentviews.pt
        """
        context = aq_inner(self.context)
        context_url = context.absolute_url()

        request_url = self.request['ACTUAL_URL']
        request_url_path = request_url[len(context_url):]

        if request_url_path.startswith('/'):
            request_url_path = request_url_path[1:] 
```

这是 CMFPlone RegistrationTool 中的违规调用，`main_template.pt`即使没有消费者，它也会触发渲染完整：

```
security.declarePublic('registeredNotify')
def registeredNotify(self, new_member_id):
    """ Wrapper around registeredNotify """
    membership = getToolByName(self, 'portal_membership')
    utils = getToolByName(self, 'plone_utils')
    member = membership.getMemberById(new_member_id)

    ...

    return self.mail_password_response(self, self.REQUEST) 
```

示例回溯：

```
 Error in test test_logout_smartcard (xxxtesting.ui.test_smartcard.TestSmartcard)
    Traceback (most recent call last):
      File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/case.py", line 318, in run
        self.setUp()
      File "/Users/mikko/code/xxx-dev/src/xxx-packages/xxxtesting/xxxtesting/ui/test_smartcard.py", line 193, in setUp
        self.xxx_helper.create_all()
      File "/Users/mikko/code/xxx-dev/src/xxx-packages/xxxtesting/xxxtesting/xxxhelper.py", line 594, in create_all
        self.create_xxx_manager("xxx_manager")
      File "/Users/mikko/code/xxx-dev/src/xxx-packages/xxxtesting/xxxtesting/xxxhelper.py", line 412, in create_xxx_manager
        mem.update(**data)
      File "/Users/mikko/code/buildout-cache/eggs/Products.remember-1.9.1-py2.7.egg/Products/remember/content/member.py", line 653, in update
        triggerAutomaticTransitions(self)
      File "/Users/mikko/code/buildout-cache/eggs/Products.remember-1.9.1-py2.7.egg/Products/remember/Extensions/workflow.py", line 34, in triggerAutomaticTransitions
        wf_tool.doActionFor(ob, 'trigger')
      File "/Users/mikko/code/buildout-cache/eggs/Products.CMFCore-2.2.6-py2.7.egg/Products/CMFCore/WorkflowTool.py", line 241, in doActionFor
        wfs, ob, action, wf.doActionFor, (ob, action) + args, kw)
      File "/Users/mikko/code/buildout-cache/eggs/Products.CMFCore-2.2.6-py2.7.egg/Products/CMFCore/WorkflowTool.py", line 552, in _invokeWithNotification
        res = func(*args, **kw)
      File "/Users/mikko/code/buildout-cache/eggs/Products.DCWorkflow-2.2.4-py2.7.egg/Products/DCWorkflow/DCWorkflow.py", line 282, in doActionFor
        self._changeStateOf(ob, tdef, kw)
      File "/Users/mikko/code/buildout-cache/eggs/Products.DCWorkflow-2.2.4-py2.7.egg/Products/DCWorkflow/DCWorkflow.py", line 421, in _changeStateOf
        sdef = self._executeTransition(ob, tdef, kwargs)
      File "/Users/mikko/code/buildout-cache/eggs/Products.DCWorkflow-2.2.4-py2.7.egg/Products/DCWorkflow/DCWorkflow.py", line 474, in _executeTransition
        script(sci)  # May throw an exception.
      File "/Users/mikko/code/buildout-cache/eggs/Products.ExternalMethod-2.13.0-py2.7.egg/Products/ExternalMethod/ExternalMethod.py", line 241, in __call__
        return f(self.aq_parent.this(), *args, **kw)
       - __traceback_info__: ((<Products.DCWorkflow.Expression.StateChangeInfo instance at 0x107492e18>,), {}, None)
      File "/Users/mikko/code/buildout-cache/eggs/Products.remember-1.9.1-py2.7.egg/Products/remember/Extensions/workflow.py", line 64, in register
        return obj.register()
      File "/Users/mikko/code/xxx-dev/src/xxx-eggs/Products.xxxHospital/Products/xxxHospital/content/xxxUser.py", line 194, in register
        BaseMember.register(self)
      File "/Users/mikko/code/buildout-cache/eggs/Products.remember-1.9.1-py2.7.egg/Products/remember/content/member.py", line 718, in register
        rtool.registeredNotify(self.getId())
      File "/Users/mikko/code/buildout-cache/eggs/Products.CMFPlone-4.1.6-py2.7.egg/Products/CMFPlone/RegistrationTool.py", line 345, in registeredNotify
        return self.mail_password_response(self, self.REQUEST)
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Shared/DC/Scripts/Bindings.py", line 322, in __call__
        return self._bindAndExec(args, kw, None)
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Shared/DC/Scripts/Bindings.py", line 359, in _bindAndExec
        return self._exec(bound_data, args, kw)
      File "/Users/mikko/code/buildout-cache/eggs/Products.CMFCore-2.2.6-py2.7.egg/Products/CMFCore/FSPageTemplate.py", line 237, in _exec
        result = self.pt_render(extra_context=bound_names)
      File "/Users/mikko/code/buildout-cache/eggs/Products.CMFCore-2.2.6-py2.7.egg/Products/CMFCore/FSPageTemplate.py", line 177, in pt_render
        self, source, extra_context
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Products/PageTemplates/PageTemplate.py", line 79, in pt_render
        showtal=showtal)
      File "/Users/mikko/code/buildout-cache/eggs/zope.pagetemplate-3.5.2-py2.7.egg/zope/pagetemplate/pagetemplate.py", line 113, in pt_render
        strictinsert=0, sourceAnnotations=sourceAnnotations)()
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 271, in __call__
        self.interpret(self.program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 888, in do_useMacro
        self.interpret(macro)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
        self.do_optTag(stuff)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
        return self.no_tag(start, program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 513, in no_tag
        self.interpret(program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 954, in do_defineSlot
        self.interpret(block)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
        self.do_optTag(stuff)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
        return self.no_tag(start, program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 513, in no_tag
        self.interpret(program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 858, in do_defineMacro
        self.interpret(macro)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 852, in do_condition
        self.interpret(block)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 742, in do_insertStructure_tal
        structure = self.engine.evaluateStructure(expr)
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Products/PageTemplates/Expressions.py", line 218, in evaluateStructure
        text = super(ZopeContext, self).evaluateStructure(expr)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tales-3.5.2-py2.7.egg/zope/tales/tales.py", line 696, in evaluate
        return expression(self)
       - file:/Users/mikko/code/xxx-dev/src/xxx-packages/plonetheme.xxxexternal/plonetheme/xxxexternal/skins/plonetheme_xxxexternal_custom_templates/main_template.pt
       - Line 83, Column 20
       - Expression: <StringExpr u'plone.contentviews'>
       - Names:
          {'container': <PloneSite at /plone>,
           'context': <RegistrationTool at /plone/portal_registration used for /plone/portal_memberdata/xxx_manager>,
           'default': <object object at 0x10204e970>,
           'here': <RegistrationTool at /plone/portal_registration used for /plone/portal_memberdata/xxx_manager>,
           'loop': {},
           'nothing': None,
           'options': {'args': (<RegistrationTool at /plone/portal_registration used for /plone/portal_memberdata/xxx_manager>,
                                <HTTPRequest, URL=http://localhost:55001>)},
           'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x107704c00>,
           'request': <HTTPRequest, URL=http://localhost:55001>,
           'root': <Application at >,
           'template': <FSPageTemplate at /plone/mail_password_response used for /plone/portal_registration>,
           'traverse_subpath': [],
           'user': <PloneUser 'admin'>}
      File "/Users/mikko/code/buildout-cache/eggs/zope.contentprovider-3.7.2-py2.7.egg/zope/contentprovider/tales.py", line 80, in __call__
        return provider.render()
      File "/Users/mikko/code/buildout-cache/eggs/plone.app.viewletmanager-2.0.2-py2.7.egg/plone/app/viewletmanager/manager.py", line 154, in render
        return BaseOrderedViewletManager.render(self)
      File "/Users/mikko/code/buildout-cache/eggs/plone.app.viewletmanager-2.0.2-py2.7.egg/plone/app/viewletmanager/manager.py", line 85, in render
        return u'\n'.join([viewlet.render() for viewlet in self.viewlets])
      File "/Users/mikko/code/buildout-cache/eggs/plone.app.layout-2.1.13-py2.7.egg/plone/app/layout/viewlets/common.py", line 48, in render
        return self.index()
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Products/Five/browser/pagetemplatefile.py", line 125, in __call__
        return self.im_func(im_self, *args, **kw)
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Products/Five/browser/pagetemplatefile.py", line 59, in __call__
        sourceAnnotations=getattr(debug_flags, 'sourceAnnotations', 0),
      File "/Users/mikko/code/buildout-cache/eggs/zope.pagetemplate-3.5.2-py2.7.egg/zope/pagetemplate/pagetemplate.py", line 113, in pt_render
        strictinsert=0, sourceAnnotations=sourceAnnotations)()
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 271, in __call__
        self.interpret(self.program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 852, in do_condition
        self.interpret(block)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 531, in do_optTag_tal
        self.no_tag(stuff[-2], stuff[-1])
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 513, in no_tag
        self.interpret(program)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 343, in interpret
        handlers[opcode](self, args)
      File "/Users/mikko/code/buildout-cache/eggs/zope.tal-3.5.2-py2.7.egg/zope/tal/talinterpreter.py", line 583, in do_setLocal_tal
        self.engine.setLocal(name, self.engine.evaluateValue(expr))
      File "/Users/mikko/code/buildout-cache/eggs/zope.tales-3.5.2-py2.7.egg/zope/tales/tales.py", line 696, in evaluate
        return expression(self)
       - /Users/mikko/code/buildout-cache/eggs/plone.app.layout-2.1.13-py2.7.egg/plone/app/layout/viewlets/contentviews.pt
       - Line 6, Column 4
       - Expression: <PathExpr standard:u'view/prepareObjectTabs'>
       - Names:
          {'args': (),
           'container': <RegistrationTool at /plone/portal_registration used for /plone/portal_memberdata/xxx_manager>,
           'context': <RegistrationTool at /plone/portal_registration used for /plone/portal_memberdata/xxx_manager>,
           'default': <object object at 0x10204e970>,
           'here': <RegistrationTool at /plone/portal_registration used for /plone/portal_memberdata/xxx_manager>,
           'loop': {},
           'nothing': None,
           'options': {},
           'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x107afe050>,
           'request': <HTTPRequest, URL=http://localhost:55001>,
           'root': <Application at >,
           'template': <Products.Five.browser.pagetemplatefile.ViewPageTemplateFile object at 0x105dfb810>,
           'traverse_subpath': [],
           'user': <PloneUser 'admin'>,
           'view': <Products.Five.viewlet.metaconfigure.ContentViewsViewlet object at 0x10868c050>,
           'views': <Products.Five.browser.pagetemplatefile.ViewMapper object at 0x107ff1f90>}
      File "/Users/mikko/code/buildout-cache/eggs/zope.tales-3.5.2-py2.7.egg/zope/tales/expressions.py", line 217, in __call__
        return self._eval(econtext)
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Products/PageTemplates/Expressions.py", line 155, in _eval
        return render(ob, econtext.vars)
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/Products/PageTemplates/Expressions.py", line 117, in render
        ob = ob()
      File "/Users/mikko/code/buildout-cache/eggs/plone.memoize-1.1.1-py2.7.egg/plone/memoize/view.py", line 47, in memogetter
        value = cache[key] = func(*args, **kwargs)
      File "/Users/mikko/code/buildout-cache/eggs/plone.app.layout-2.1.13-py2.7.egg/plone/app/layout/viewlets/common.py", line 258, in prepareObjectTabs
        request_url = self.request['ACTUAL_URL']
      File "/Users/mikko/code/buildout-cache/eggs/Zope2-2.13.15-py2.7.egg/ZPublisher/HTTPRequest.py", line 1372, in __getitem__
        raise KeyError, key
    KeyError: 'ACTUAL_URL' 
```

# sql-server - 实体框架：我可以在 SQL Server 中为从数据库生成时使用的导航属性设置自定义名称吗？

> ID：12442999
> 
> 赞同：0
> 
> 时间：2012-09-15T22:34:39.447
> 
> 标签：sql-server, entity-framework

任何人都知道我是否可以在 SQL Server 中设置实体框架在设置外键导航属性时将读取的内容？

我的问题：我有一个名为“SurveyEntry”的表和一个名为“SurveyInvite”的子表

我从 Invite 到 Entry 表有 2 个 FK 设置 - 一个用于父级（邀请是从哪个原始条目创建的），另一个用于与邀请相关的“Entry”完成的内容...

当我生成 EDMX - 它创建两个导航属性：SurveyEntry 和 SurveyEntry1

我将第二个重命名为“CompletedEntry”，以便在代码中有意义。

但是，如果我必须重新构建 EDMX（开发的早期阶段，将添加必须更多的东西，并且可能会炸毁它并完全重建它几次） - 我不想记住进入并每当我这样做时重新命名该属性 - 我相信我会在某个时候忘记它！

尝试在字段和 FK 关系中使用 SQL 中的 Description 值，但没有运气 - 如果不可能，将其作为功能肯定会很好......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:06:08.687

EF 不支持这种自定义模型生成的方式。

但是，由于您处于开发的早期阶段，请考虑在进行更改时使用不同的工作流程。当您需要更改数据库中的某些内容时，请先更改模型，然后从中生成 DDL 脚本。

请注意，可以自定义生成的脚本，请参阅[http://blogs.msdn.com/b/adonet/archive/2009/11/05/model-first-with-the-entity-framework-4.aspx](http://blogs.msdn.com/b/adonet/archive/2009/11/05/model-first-with-the-entity-framework-4.aspx)